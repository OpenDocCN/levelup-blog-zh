<html>
<head>
<title>How to Build React Apps with TypeScript with a Practical Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用TypeScript构建React应用程序并给出一个实例</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-write-react-apps-with-typescript-697f9e90cfd4?source=collection_archive---------0-----------------------#2019-11-13">https://levelup.gitconnected.com/how-to-write-react-apps-with-typescript-697f9e90cfd4?source=collection_archive---------0-----------------------#2019-11-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4928bb8de79d0b8f93b572464e14e658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JZor2WNmEzc5d4wqFvqPg.jpeg"/></div></div></figure><h2 id="8d95" class="kb kc it bd kd ke kf dn kg kh ki dp kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">概观</h2><p id="1105" class="pw-post-body-paragraph kx ky it kz b la lb lc ld le lf lg lh kk li lj lk ko ll lm ln ks lo lp lq lr im bi translated">TypeScript是JavaScript的超集，创建它是为了解决许多常见的问题，最大的问题是JavaScript变量和对象都具有动态类型。这意味着如果不将对象记录到调试器中，就无法知道它有什么属性。</p><p id="1809" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这造成了很多挫折，因为您必须亲自检查每个单独的对象，减慢了开发速度。没有静态类型，你也不能在你的编辑器中自动完成，因为没有办法100%确定地知道那些对象中有什么。</p><p id="3756" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">此外，您可以在JavaScript函数中放入任何参数，所以传入的内容没有强制性。当您传递错误的参数类型或者没有传递足够的参数时，就会产生问题，使这些参数<code class="fe lx ly lz ma b">undefined</code>。也没有什么可以阻止你传入太多的参数。</p><p id="123a" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">通过能够在编译时检测到所有这些问题，TypeScript使代码更容易理解和遵循，同时减少了发送到产品中的错误数量。当你改变代码的时候，你不必担心破坏东西，因为编译器会告诉你，你得到了那些基本的错误。</p><p id="7c94" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">创建React应用程序项目可以使用TypeScript的<code class="fe lx ly lz ma b">--typscript</code>选项启动。但是，我们需要自己为一些库安装类型定义。</p><p id="364e" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在本文中，我们将使用React和TypeScript构建一个地址簿应用程序。</p><h2 id="68d5" class="kb kc it bd kd ke kf dn kg kh ki dp kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">入门指南</h2><p id="259e" class="pw-post-body-paragraph kx ky it kz b la lb lc ld le lf lg lh kk li lj lk ko ll lm ln ks lo lp lq lr im bi translated">首先，我们需要运行Create React App来搭建应用程序。我们运行<code class="fe lx ly lz ma b">npx create-react-app address-book --typscript</code>来创建包含初始文件的应用程序项目文件夹。该应用程序将有一个主页来显示联系人，并让我们打开一个模式来添加联系人。将会有一个显示所有联系人的表格，每行都有编辑和删除按钮。</p><p id="9972" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这些联系人将被存储在一个中央MobX存储中，以便于访问。React路由器将用于路由。联系人将通过使用<a class="ae mb" href="https://github.com/typicode/json-server" rel="noopener ugc nofollow" target="_blank"> JSON服务器</a>保存在后端。我们还将使用<a class="ae mb" href="https://github.com/jaredpalmer/formik" rel="noopener ugc nofollow" target="_blank"> Formik </a>和<a class="ae mb" href="https://github.com/jquense/yup" rel="noopener ugc nofollow" target="_blank"> Yup </a>进行表单管理和验证。</p><p id="aa15" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">为了安装我们上面提到的库，我们运行<code class="fe lx ly lz ma b">npm i axios bootstrap formik react-bootstrap mobx mobx-react react-router-dom yup</code>。Axios是我们用来向后端发出HTTP请求的HTTP客户端。<code class="fe lx ly lz ma b">react-router-dom</code>是React路由器最新版本的包名。</p><p id="d8f2" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">我们还需要通过运行以下命令为我们的库安装类型定义:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="da3f" class="kb kc it ma b gy mk ml l mm mn">npm i --save-dev @types/react @types/react-router-dom @types/react-bootstrap @types/react-dom @types/yup</span></pre><p id="0489" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在<code class="fe lx ly lz ma b">tsconfig.json</code>中，我们将现有代码替换为:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="1319" class="kb kc it ma b gy mk ml l mm mn">{<br/>  "compilerOptions": {<br/>    "target": "es5",<br/>    "lib": [<br/>      "dom",<br/>      "dom.iterable",<br/>      "esnext"<br/>    ],<br/>    "allowJs": true,<br/>    "skipLibCheck": true,<br/>    "esModuleInterop": true,<br/>    "allowSyntheticDefaultImports": true,<br/>    "strict": true,<br/>    "forceConsistentCasingInFileNames": true,<br/>    "module": "esnext",<br/>    "moduleResolution": "node",<br/>    "resolveJsonModule": true,<br/>    "isolatedModules": true,<br/>    "noEmit": true,<br/>    "jsx": "react",<br/>    "noImplicitThis": false,<br/>    "experimentalDecorators": true<br/>  },<br/>  "include": [<br/>    "src"<br/>  ]<br/>}</span></pre><p id="6cf2" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这禁用了<code class="fe lx ly lz ma b">noImplicitThis</code>,因此我们可以在组件中使用<code class="fe lx ly lz ma b">bind(this)</code>,并添加<code class="fe lx ly lz ma b">experimentalDecorators</code>来使用MobX所需的装饰器。</p><h2 id="dc4f" class="kb kc it bd kd ke kf dn kg kh ki dp kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">构建React应用程序</h2><p id="bd6c" class="pw-post-body-paragraph kx ky it kz b la lb lc ld le lf lg lh kk li lj lk ko ll lm ln ks lo lp lq lr im bi translated">我们为将要编写的代码创建一些自定义类型。在<code class="fe lx ly lz ma b">src</code>文件夹中创建一个<code class="fe lx ly lz ma b">interfaces.ts</code>文件，并添加:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="4cf2" class="kb kc it ma b gy mk ml l mm mn">import { ContactsStore } from './store';</span><span id="e03a" class="kb kc it ma b gy mo ml l mm mn">export interface Contact {<br/>    firstName: string;<br/>    lastName: string;<br/>    address: string;<br/>    city: string;<br/>    region: string;<br/>    postalCode: string;<br/>    phone: string;<br/>    email: string;<br/>    age: string;<br/>    id: number;<br/>    country: string;<br/>}</span><span id="d7f1" class="kb kc it ma b gy mo ml l mm mn">export interface HomePageProps {<br/>    contactsStore: ContactsStore<br/>}</span><span id="9215" class="kb kc it ma b gy mo ml l mm mn">export interface ContactFormProps {<br/>    edit?: boolean,<br/>    onSave?: any,<br/>    contact?: Contact,<br/>    onCancelAdd?: any,<br/>    onCancelEdit?: any,<br/>    contactsStore: ContactsStore<br/>}</span></pre><p id="7958" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这将是我们的数据和道具的类型。</p><p id="3584" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">现在我们已经安装了所有的库，我们可以开始构建应用程序了。除非另有说明，否则所有文件都在<code class="fe lx ly lz ma b">src</code>文件夹中。首先我们在MobX商店上工作。我们在<code class="fe lx ly lz ma b">src</code>文件夹中创建一个名为<code class="fe lx ly lz ma b">store.tsx</code>的文件，并添加以下内容:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="6fe5" class="kb kc it ma b gy mk ml l mm mn">import { observable } from "mobx";<br/>import { Contact } from "./interfaces";</span><span id="7dea" class="kb kc it ma b gy mo ml l mm mn">class ContactsStore {<br/>    <a class="ae mb" href="http://twitter.com/observable" rel="noopener ugc nofollow" target="_blank">@observable</a> contacts: Contact[] = [];</span><span id="1c29" class="kb kc it ma b gy mo ml l mm mn">    setContacts(contacts: Contact[]) {<br/>        this.contacts = contacts;<br/>    }<br/>}</span><span id="4ddd" class="kb kc it ma b gy mo ml l mm mn">export { ContactsStore };</span></pre><p id="b191" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这是一个保存联系人的简单商店。<code class="fe lx ly lz ma b">contacts</code>数组是我们存储整个应用程序的联系人的地方。<code class="fe lx ly lz ma b">setContacts</code>函数允许我们设置来自任何组件的联系人，我们将这个store对象传递给该组件。</p><p id="1b00" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">此区块:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="4797" class="kb kc it ma b gy mk ml l mm mn">ContactsStore = decorate(ContactsStore, {<br/>  contacts: observable,<br/>  setContacts: action,<br/>});</span></pre><p id="ade2" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">将<code class="fe lx ly lz ma b">ContactsStore</code>中的<code class="fe lx ly lz ma b">contacts</code>数组指定为可由组件观察变化的实体。<code class="fe lx ly lz ma b">setContacts</code>是可用于设置存储中的<code class="fe lx ly lz ma b">contacts</code>数组的函数。</p><p id="49c4" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在<code class="fe lx ly lz ma b">App.tsx</code>中，我们用以下代码替换现有代码:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="fffb" class="kb kc it ma b gy mk ml l mm mn">import React from "react";<br/>import { Router, Route } from "react-router-dom";<br/>import HomePage from "./HomePage";<br/>import { createBrowserHistory as createHistory } from "history";<br/>import Navbar from "react-bootstrap/Navbar";<br/>import Nav from "react-bootstrap/Nav";<br/>import "./App.css";<br/>const history = createHistory();</span><span id="8fd4" class="kb kc it ma b gy mo ml l mm mn">function App({ contactsStore }: any) {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Router history={history}&gt;<br/>        &lt;Navbar bg="primary" expand="lg" variant="dark"&gt;<br/>          &lt;Navbar.Brand href="#home"&gt;Address Book App&lt;/Navbar.Brand&gt;<br/>          &lt;Navbar.Toggle aria-controls="basic-navbar-nav" /&gt;<br/>          &lt;Navbar.Collapse id="basic-navbar-nav"&gt;<br/>            &lt;Nav className="mr-auto"&gt;<br/>              &lt;Nav.Link href="/"&gt;Home&lt;/Nav.Link&gt;<br/>            &lt;/Nav&gt;<br/>          &lt;/Navbar.Collapse&gt;<br/>        &lt;/Navbar&gt;<br/>        &lt;Route<br/>          path="/"<br/>          exact<br/>          component={(props: any) =&gt; (<br/>            &lt;HomePage {...props} contactsStore={contactsStore} /&gt;<br/>          )}<br/>        /&gt;<br/>      &lt;/Router&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="b642" class="kb kc it ma b gy mo ml l mm mn">export default App;</span></pre><p id="f971" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">我们将存储传递给任何需要它的组件，比如<code class="fe lx ly lz ma b">HomePage</code>。然后，它会将组件传递给<code class="fe lx ly lz ma b">ContactForm</code>。</p><p id="1f01" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这是我们添加导航栏并显示React Router处理的路由的地方。在<code class="fe lx ly lz ma b">App.css</code>中，我们将现有代码替换为:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="0e57" class="kb kc it ma b gy mk ml l mm mn">.App {<br/>  text-align: center;<br/>}</span></pre><p id="d5bb" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">接下来，我们建立我们的联系形式。这是我们的应用程序中逻辑最强的部分。</p><p id="2a70" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在这个<code class="fe lx ly lz ma b">ContactForm.tsx</code>中，我们为<code class="fe lx ly lz ma b">ContactForm</code>组件添加了<code class="fe lx ly lz ma b">React.SFC&lt;ContactFormProps&gt;</code>注释，因此我们对组件进行了类型检查。<code class="fe lx ly lz ma b">ContactFormProps</code>让我们检查道具的数据类型。</p><p id="82b7" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">创建一个名为<code class="fe lx ly lz ma b">ContactForm.tsx</code>的文件，并添加:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="449d" class="kb kc it ma b gy mk ml l mm mn">import React from "react";<br/>import { Formik } from "formik";<br/>import Form from "react-bootstrap/Form";<br/>import Col from "react-bootstrap/Col";<br/>import InputGroup from "react-bootstrap/InputGroup";<br/>import Button from "react-bootstrap/Button";<br/>import * as yup from "yup";<br/>import { COUNTRIES } from "./exports";<br/>import { addContact, editContact, getContacts } from "./requests";<br/>import { FormControl } from "react-bootstrap";<br/>import { Contact, ContactFormProps } from "./interfaces";</span><span id="1fe2" class="kb kc it ma b gy mo ml l mm mn">const schema = yup.object({<br/>  firstName: yup.string().required("First name is required"),<br/>  lastName: yup.string().required("Last name is required"),<br/>  address: yup.string().required("Address is required"),<br/>  city: yup.string().required("City is required"),<br/>  region: yup.string().required("Region is required"),<br/>  country: yup<br/>    .string()<br/>    .required("Country is required")<br/>    .default("Afghanistan"),<br/>  postalCode: yup<br/>    .string()<br/>    .when("country", {<br/>      is: "United States",<br/>      then: yup<br/>        .string()<br/>        .matches(/^[0-9]{5}(?:-[0-9]{4})?$/, "Invalid postal code")<br/>    })<br/>    .when("country", {<br/>      is: "Canada",<br/>      then: yup<br/>        .string()<br/>        .matches(/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/, "Invalid postal code")<br/>    })<br/>    .required(),<br/>  phone: yup<br/>    .string()<br/>    .when("country", {<br/>      is: country =&gt; ["United States", "Canada"].includes(country),<br/>      then: yup<br/>        .string()<br/>        .matches(/^[2-9]\d{2}[2-9]\d{2}\d{4}$/, "Invalid phone nunber")<br/>    })<br/>    .required(),<br/>  email: yup<br/>    .string()<br/>    .email("Invalid email")<br/>    .required("Email is required"),<br/>  age: yup<br/>    .number()<br/>    .required("Age is required")<br/>    .min(0, "Minimum age is 0")<br/>    .max(200, "Maximum age is 200")<br/>});</span><span id="26a1" class="kb kc it ma b gy mo ml l mm mn">const ContactForm: React.SFC&lt;ContactFormProps&gt; = ({<br/>  edit,<br/>  onSave,<br/>  contact,<br/>  onCancelAdd,<br/>  onCancelEdit,<br/>  contactsStore<br/>}: ContactFormProps) =&gt; {<br/>  const handleSubmit = async (evt: Contact) =&gt; {<br/>    const isValid = await schema.validate(evt);<br/>    if (!isValid) {<br/>      return;<br/>    }<br/>    if (!edit) {<br/>      await addContact(evt);<br/>    } else {<br/>      await editContact(evt);<br/>    }<br/>    const response = await getContacts();<br/>    contactsStore.setContacts(response.data);<br/>    onSave();<br/>  };</span><span id="c65a" class="kb kc it ma b gy mo ml l mm mn">  return (<br/>    &lt;&gt;<br/>      &lt;Formik<br/>        validationSchema={schema}<br/>        onSubmit={handleSubmit}<br/>        initialValues={(contact || {}) as any}<br/>      &gt;<br/>        {({<br/>          handleSubmit,<br/>          handleChange,<br/>          handleBlur,<br/>          values,<br/>          touched,<br/>          isInvalid,<br/>          errors<br/>        }: any) =&gt; (<br/>          &lt;Form noValidate onSubmit={handleSubmit}&gt;<br/>            &lt;Form.Row&gt;<br/>              &lt;Form.Group as={Col} md="12" controlId="firstName"&gt;<br/>                &lt;Form.Label&gt;First name&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  name="firstName"<br/>                  placeholder="First Name"<br/>                  value={values.firstName || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.firstName &amp;&amp; errors.firstName}<br/>                /&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.firstName}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;<br/>              &lt;Form.Group as={Col} md="12" controlId="lastName"&gt;<br/>                &lt;Form.Label&gt;Last name&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  name="lastName"<br/>                  placeholder="Last Name"<br/>                  value={values.lastName || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.firstName &amp;&amp; errors.lastName}<br/>                /&gt;</span><span id="8f39" class="kb kc it ma b gy mo ml l mm mn">                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.lastName}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;<br/>              &lt;Form.Group as={Col} md="12" controlId="address"&gt;<br/>                &lt;Form.Label&gt;Address&lt;/Form.Label&gt;<br/>                &lt;InputGroup&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    placeholder="Address"<br/>                    aria-describedby="inputGroupPrepend"<br/>                    name="address"<br/>                    value={values.address || ""}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.address &amp;&amp; errors.address}<br/>                  /&gt;<br/>                  &lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.address}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/InputGroup&gt;<br/>              &lt;/Form.Group&gt;<br/>            &lt;/Form.Row&gt;<br/>            &lt;Form.Row&gt;<br/>              &lt;Form.Group as={Col} md="12" controlId="city"&gt;<br/>                &lt;Form.Label&gt;City&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  placeholder="City"<br/>                  name="city"<br/>                  value={values.city || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.city &amp;&amp; errors.city}<br/>                /&gt;</span><span id="14af" class="kb kc it ma b gy mo ml l mm mn">                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.city}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;<br/>              &lt;Form.Group as={Col} md="12" controlId="region"&gt;<br/>                &lt;Form.Label&gt;Region&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  placeholder="Region"<br/>                  name="region"<br/>                  value={values.region || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.region &amp;&amp; errors.region}<br/>                /&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.region}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="c58b" class="kb kc it ma b gy mo ml l mm mn">              &lt;Form.Group as={Col} md="12" controlId="country"&gt;<br/>                &lt;Form.Label&gt;Country&lt;/Form.Label&gt;<br/>                &lt;FormControl<br/>                  as="select"<br/>                  placeholder="Country"<br/>                  name="country"<br/>                  onChange={handleChange}<br/>                  value={values.country || ""}<br/>                  isInvalid={touched.region &amp;&amp; errors.country}<br/>                &gt;<br/>                  {COUNTRIES.map(c =&gt; (<br/>                    &lt;option key={c} value={c}&gt;<br/>                      {c}<br/>                    &lt;/option&gt;<br/>                  ))}<br/>                &lt;/FormControl&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.country}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="7a7a" class="kb kc it ma b gy mo ml l mm mn">              &lt;Form.Group as={Col} md="12" controlId="postalCode"&gt;<br/>                &lt;Form.Label&gt;Postal Code&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  placeholder="Postal Code"<br/>                  name="postalCode"<br/>                  value={values.postalCode || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.postalCode &amp;&amp; errors.postalCode}<br/>                /&gt;</span><span id="6e4a" class="kb kc it ma b gy mo ml l mm mn">                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.postalCode}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="ac63" class="kb kc it ma b gy mo ml l mm mn">              &lt;Form.Group as={Col} md="12" controlId="phone"&gt;<br/>                &lt;Form.Label&gt;Phone&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  placeholder="Phone"<br/>                  name="phone"<br/>                  value={values.phone || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.phone &amp;&amp; errors.phone}<br/>                /&gt;</span><span id="6570" class="kb kc it ma b gy mo ml l mm mn">                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.phone}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="09e9" class="kb kc it ma b gy mo ml l mm mn">              &lt;Form.Group as={Col} md="12" controlId="email"&gt;<br/>                &lt;Form.Label&gt;Email&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  placeholder="Email"<br/>                  name="email"<br/>                  value={values.email || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.email &amp;&amp; errors.email}<br/>                /&gt;</span><span id="d09a" class="kb kc it ma b gy mo ml l mm mn">                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.email}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="ae76" class="kb kc it ma b gy mo ml l mm mn">              &lt;Form.Group as={Col} md="12" controlId="age"&gt;<br/>                &lt;Form.Label&gt;Age&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  placeholder="Age"<br/>                  name="age"<br/>                  value={values.age || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.age &amp;&amp; errors.age}<br/>                /&gt;</span><span id="fc60" class="kb kc it ma b gy mo ml l mm mn">                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.age}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;<br/>            &lt;/Form.Row&gt;<br/>            &lt;Button type="submit" style={{ marginRight: "10px" }}&gt;<br/>              Save<br/>            &lt;/Button&gt;<br/>            {edit ? (<br/>              &lt;Button type="button" onClick={onCancelEdit}&gt;<br/>                Cancel<br/>              &lt;/Button&gt;<br/>            ) : (<br/>              &lt;Button type="button" onClick={onCancelAdd}&gt;<br/>                Cancel<br/>              &lt;/Button&gt;<br/>            )}<br/>          &lt;/Form&gt;<br/>        )}<br/>      &lt;/Formik&gt;<br/>    &lt;/&gt;<br/>  );<br/>};</span><span id="27b4" class="kb kc it ma b gy mo ml l mm mn">export default ContactForm;</span></pre><p id="178e" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">我们从<code class="fe lx ly lz ma b">HomePage</code>组件传入<code class="fe lx ly lz ma b">contactsStore</code>，允许我们使用<code class="fe lx ly lz ma b">contactsStore</code>中的数据和函数。</p><p id="8268" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">对于表单验证，我们使用Formik来帮助构建我们的联系表单，我们的Boostrap <code class="fe lx ly lz ma b">Form</code>组件嵌套在<code class="fe lx ly lz ma b">Formik</code>组件中，这样我们就可以使用Formik的<code class="fe lx ly lz ma b">handleChange</code>、<code class="fe lx ly lz ma b">handleSubmit</code>、<code class="fe lx ly lz ma b">values</code>、<code class="fe lx ly lz ma b">touched</code>和<code class="fe lx ly lz ma b">errors</code>参数。</p><p id="7306" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated"><code class="fe lx ly lz ma b">handleChange</code>是一个函数，让我们不用自己写代码就可以从输入中更新表单域数据。<code class="fe lx ly lz ma b">handleSubmit</code>是我们传递给<code class="fe lx ly lz ma b">Formik</code>组件的<code class="fe lx ly lz ma b">onSubmit</code>处理程序的函数。函数中的参数是我们输入的数据，字段名作为键，由每个字段的<code class="fe lx ly lz ma b">name</code>属性定义，每个字段的值作为那些键的值。注意，在每个<code class="fe lx ly lz ma b">value</code>属性中，我们有<code class="fe lx ly lz ma b">||''</code>，所以我们没有得到<code class="fe lx ly lz ma b">undefined</code>值，并防止触发不受控制的表单警告。</p><p id="4b92" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">为了显示表单验证消息，我们必须将<code class="fe lx ly lz ma b">isInvalid</code>属性传递给每个<code class="fe lx ly lz ma b">Form.Control</code>组件。<code class="fe lx ly lz ma b">schema</code>对象是<code class="fe lx ly lz ma b">Formik</code>将检查表单验证的对象。<code class="fe lx ly lz ma b">required</code>函数中的参数是验证错误消息。<code class="fe lx ly lz ma b">matches</code>、<code class="fe lx ly lz ma b">min</code>和<code class="fe lx ly lz ma b">max</code>函数的第二个参数也是验证消息。</p><p id="b6fb" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated"><code class="fe lx ly lz ma b">ContactForm</code>函数的参数是道具，我们将从稍后构建的<code class="fe lx ly lz ma b">HomePage</code>组件传入。<code class="fe lx ly lz ma b">handleSubmit</code>功能检查数据是否有效，如果有效，则根据是添加还是编辑联系人进行保存。然后，当保存成功时，我们在存储中设置联系人并调用<code class="fe lx ly lz ma b">onSave</code> prop，这是一个关闭表单所在模态的函数。模式将在主页中定义。</p><p id="9d96" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">接下来我们创建一个名为<code class="fe lx ly lz ma b">exports.ts</code>的文件，并放入:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="cf38" class="kb kc it ma b gy mk ml l mm mn">export const COUNTRIES = [<br/>  "Afghanistan",<br/>  "Albania",<br/>  "Algeria",<br/>  "Andorra",<br/>  "Angola",<br/>  "Anguilla",<br/>  "Antigua &amp;amp; Barbuda",<br/>  "Argentina",<br/>  "Armenia",<br/>  "Aruba",<br/>  "Australia",<br/>  "Austria",<br/>  "Azerbaijan",<br/>  "Bahamas",<br/>  "Bahrain",<br/>  "Bangladesh",<br/>  "Barbados",<br/>  "Belarus",<br/>  "Belgium",<br/>  "Belize",<br/>  "Benin",<br/>  "Bermuda",<br/>  "Bhutan",<br/>  "Bolivia",<br/>  "Bosnia &amp;amp; Herzegovina",<br/>  "Botswana",<br/>  "Brazil",<br/>  "British Virgin Islands",<br/>  "Brunei",<br/>  "Bulgaria",<br/>  "Burkina Faso",<br/>  "Burundi",<br/>  "Cambodia",<br/>  "Cameroon",<br/>  "Canada",<br/>  "Cape Verde",<br/>  "Cayman Islands",<br/>  "Chad",<br/>  "Chile",<br/>  "China",<br/>  "Colombia",<br/>  "Congo",<br/>  "Cook Islands",<br/>  "Costa Rica",<br/>  "Cote D Ivoire",<br/>  "Croatia",<br/>  "Cruise Ship",<br/>  "Cuba",<br/>  "Cyprus",<br/>  "Czech Republic",<br/>  "Denmark",<br/>  "Djibouti",<br/>  "Dominica",<br/>  "Dominican Republic",<br/>  "Ecuador",<br/>  "Egypt",<br/>  "El Salvador",<br/>  "Equatorial Guinea",<br/>  "Estonia",<br/>  "Ethiopia",<br/>  "Falkland Islands",<br/>  "Faroe Islands",<br/>  "Fiji",<br/>  "Finland",<br/>  "France",<br/>  "French Polynesia",<br/>  "French West Indies",<br/>  "Gabon",<br/>  "Gambia",<br/>  "Georgia",<br/>  "Germany",<br/>  "Ghana",<br/>  "Gibraltar",<br/>  "Greece",<br/>  "Greenland",<br/>  "Grenada",<br/>  "Guam",<br/>  "Guatemala",<br/>  "Guernsey",<br/>  "Guinea",<br/>  "Guinea Bissau",<br/>  "Guyana",<br/>  "Haiti",<br/>  "Honduras",<br/>  "Hong Kong",<br/>  "Hungary",<br/>  "Iceland",<br/>  "India",<br/>  "Indonesia",<br/>  "Iran",<br/>  "Iraq",<br/>  "Ireland",<br/>  "Isle of Man",<br/>  "Israel",<br/>  "Italy",<br/>  "Jamaica",<br/>  "Japan",<br/>  "Jersey",<br/>  "Jordan",<br/>  "Kazakhstan",<br/>  "Kenya",<br/>  "Kuwait",<br/>  "Kyrgyz Republic",<br/>  "Laos",<br/>  "Latvia",<br/>  "Lebanon",<br/>  "Lesotho",<br/>  "Liberia",<br/>  "Libya",<br/>  "Liechtenstein",<br/>  "Lithuania",<br/>  "Luxembourg",<br/>  "Macau",<br/>  "Macedonia",<br/>  "Madagascar",<br/>  "Malawi",<br/>  "Malaysia",<br/>  "Maldives",<br/>  "Mali",<br/>  "Malta",<br/>  "Mauritania",<br/>  "Mauritius",<br/>  "Mexico",<br/>  "Moldova",<br/>  "Monaco",<br/>  "Mongolia",<br/>  "Montenegro",<br/>  "Montserrat",<br/>  "Morocco",<br/>  "Mozambique",<br/>  "Namibia",<br/>  "Nepal",<br/>  "Netherlands",<br/>  "Netherlands Antilles",<br/>  "New Caledonia",<br/>  "New Zealand",<br/>  "Nicaragua",<br/>  "Niger",<br/>  "Nigeria",<br/>  "Norway",<br/>  "Oman",<br/>  "Pakistan",<br/>  "Palestine",<br/>  "Panama",<br/>  "Papua New Guinea",<br/>  "Paraguay",<br/>  "Peru",<br/>  "Philippines",<br/>  "Poland",<br/>  "Portugal",<br/>  "Puerto Rico",<br/>  "Qatar",<br/>  "Reunion",<br/>  "Romania",<br/>  "Russia",<br/>  "Rwanda",<br/>  "Saint Pierre &amp;amp; Miquelon",<br/>  "Samoa",<br/>  "San Marino",<br/>  "Satellite",<br/>  "Saudi Arabia",<br/>  "Senegal",<br/>  "Serbia",<br/>  "Seychelles",<br/>  "Sierra Leone",<br/>  "Singapore",<br/>  "Slovakia",<br/>  "Slovenia",<br/>  "South Africa",<br/>  "South Korea",<br/>  "Spain",<br/>  "Sri Lanka",<br/>  "St Kitts &amp;amp; Nevis",<br/>  "St Lucia",<br/>  "St Vincent",<br/>  "St. Lucia",<br/>  "Sudan",<br/>  "Suriname",<br/>  "Swaziland",<br/>  "Sweden",<br/>  "Switzerland",<br/>  "Syria",<br/>  "Taiwan",<br/>  "Tajikistan",<br/>  "Tanzania",<br/>  "Thailand",<br/>  "Timor L'Este",<br/>  "Togo",<br/>  "Tonga",<br/>  "Trinidad &amp;amp; Tobago",<br/>  "Tunisia",<br/>  "Turkey",<br/>  "Turkmenistan",<br/>  "Turks &amp;amp; Caicos",<br/>  "Uganda",<br/>  "Ukraine",<br/>  "United Arab Emirates",<br/>  "United Kingdom",<br/>  "United States",<br/>  "United States Minor Outlying Islands",<br/>  "Uruguay",<br/>  "Uzbekistan",<br/>  "Venezuela",<br/>  "Vietnam",<br/>  "Virgin Islands (US)",<br/>  "Yemen",<br/>  "Zambia",<br/>  "Zimbabwe",<br/>];</span></pre><p id="6c19" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这些是表单中国家字段的国家。</p><p id="2aa5" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在<code class="fe lx ly lz ma b">index.tsx</code>中，将现有代码替换为:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="89a6" class="kb kc it ma b gy mk ml l mm mn">import React from "react";<br/>import ReactDOM from "react-dom";<br/>import "./index.css";<br/>import App from "./App";<br/>import * as serviceWorker from "./serviceWorker";<br/>import { ContactsStore } from "./store";<br/>const contactsStore = new ContactsStore();</span><span id="a6ec" class="kb kc it ma b gy mo ml l mm mn">ReactDOM.render(<br/>  &lt;App contactsStore={contactsStore} /&gt;,<br/>  document.getElementById("root")<br/>);</span><span id="d570" class="kb kc it ma b gy mo ml l mm mn">// If you want your app to work offline and load faster, you can change<br/>// unregister() to register() below. Note this comes with some pitfalls.<br/>// Learn more about service workers: <a class="ae mb" href="https://bit.ly/CRA-PWA" rel="noopener ugc nofollow" target="_blank">https://bit.ly/CRA-PWA</a><br/>serviceWorker.unregister();</span></pre><p id="a5a9" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这将我们的MobX存储传递到我们的<code class="fe lx ly lz ma b">App</code>组件中。</p><p id="5e96" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在<code class="fe lx ly lz ma b">HomePage.tsx</code>中，我们把:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="814f" class="kb kc it ma b gy mk ml l mm mn">import React from "react";<br/>import { useState, useEffect } from "react";<br/>import Table from "react-bootstrap/Table";<br/>import ButtonToolbar from "react-bootstrap/ButtonToolbar";<br/>import Button from "react-bootstrap/Button";<br/>import Modal from "react-bootstrap/Modal";<br/>import ContactForm from "./ContactForm";<br/>import "./HomePage.css";<br/>import { getContacts, deleteContact } from "./requests";<br/>import { observer } from "mobx-react";<br/>import { Contact, HomePageProps } from "./interfaces";</span><span id="683d" class="kb kc it ma b gy mo ml l mm mn">const HomePage: React.SFC&lt;HomePageProps&gt; = ({<br/>  contactsStore<br/>}: HomePageProps) =&gt; {<br/>  const [openAddModal, setOpenAddModal] = useState(false);<br/>  const [openEditModal, setOpenEditModal] = useState(false);<br/>  const [initialized, setInitialized] = useState(false);<br/>  const [selectedContact, setSelectedContact] = useState({});</span><span id="5971" class="kb kc it ma b gy mo ml l mm mn">  const openModal = () =&gt; {<br/>    setOpenAddModal(true);<br/>  };</span><span id="e26a" class="kb kc it ma b gy mo ml l mm mn">  const closeModal = () =&gt; {<br/>    setOpenAddModal(false);<br/>    setOpenEditModal(false);<br/>    getData();<br/>  };</span><span id="46b2" class="kb kc it ma b gy mo ml l mm mn">  const cancelAddModal = () =&gt; {<br/>    setOpenAddModal(false);<br/>  };</span><span id="53ce" class="kb kc it ma b gy mo ml l mm mn">  const editContact = (contact: Contact) =&gt; {<br/>    setSelectedContact(contact);<br/>    setOpenEditModal(true);<br/>  };</span><span id="0caa" class="kb kc it ma b gy mo ml l mm mn">  const cancelEditModal = () =&gt; {<br/>    setOpenEditModal(false);<br/>  };</span><span id="b42b" class="kb kc it ma b gy mo ml l mm mn">  const getData = async () =&gt; {<br/>    const response = await getContacts();<br/>    contactsStore.setContacts(response.data);<br/>    setInitialized(true);<br/>  };</span><span id="a1cc" class="kb kc it ma b gy mo ml l mm mn">  const deleteSelectedContact = async (id: number) =&gt; {<br/>    await deleteContact(id);<br/>    getData();<br/>  };</span><span id="b4e9" class="kb kc it ma b gy mo ml l mm mn">  useEffect(() =&gt; {<br/>    if (!initialized) {<br/>      getData();<br/>    }<br/>  });</span><span id="8ee8" class="kb kc it ma b gy mo ml l mm mn">  return (<br/>    &lt;div className="home-page"&gt;<br/>      &lt;h1&gt;Contacts&lt;/h1&gt;<br/>      &lt;Modal show={openAddModal} onHide={closeModal}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Add Contact&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;<br/>        &lt;Modal.Body&gt;<br/>          &lt;ContactForm<br/>            edit={false}<br/>            onSave={closeModal.bind(this) as any}<br/>            onCancelAdd={cancelAddModal as any}<br/>            contactsStore={contactsStore}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;</span><span id="3e68" class="kb kc it ma b gy mo ml l mm mn">      &lt;Modal show={openEditModal} onHide={closeModal}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Edit Contact&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;<br/>        &lt;Modal.Body&gt;<br/>          &lt;ContactForm<br/>            edit={true}<br/>            onSave={closeModal.bind(this)}<br/>            contact={selectedContact as Contact}<br/>            onCancelEdit={cancelEditModal}<br/>            contactsStore={contactsStore}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;<br/>      &lt;ButtonToolbar onClick={openModal}&gt;<br/>        &lt;Button variant="outline-primary"&gt;Add Contact&lt;/Button&gt;<br/>      &lt;/ButtonToolbar&gt;<br/>      &lt;br /&gt;<br/>      &lt;Table striped bordered hover&gt;<br/>        &lt;thead&gt;<br/>          &lt;tr&gt;<br/>            &lt;th&gt;First Name&lt;/th&gt;<br/>            &lt;th&gt;Last Name&lt;/th&gt;<br/>            &lt;th&gt;Address&lt;/th&gt;<br/>            &lt;th&gt;City&lt;/th&gt;<br/>            &lt;th&gt;Country&lt;/th&gt;<br/>            &lt;th&gt;Postal Code&lt;/th&gt;<br/>            &lt;th&gt;Phone&lt;/th&gt;<br/>            &lt;th&gt;Email&lt;/th&gt;<br/>            &lt;th&gt;Age&lt;/th&gt;<br/>            &lt;th&gt;Edit&lt;/th&gt;<br/>            &lt;th&gt;Delete&lt;/th&gt;<br/>          &lt;/tr&gt;<br/>        &lt;/thead&gt;<br/>        &lt;tbody&gt;<br/>          {contactsStore.contacts.map((c: any) =&gt; (<br/>            &lt;tr key={c.id}&gt;<br/>              &lt;td&gt;{c.firstName}&lt;/td&gt;<br/>              &lt;td&gt;{c.lastName}&lt;/td&gt;<br/>              &lt;td&gt;{c.address}&lt;/td&gt;<br/>              &lt;td&gt;{c.city}&lt;/td&gt;<br/>              &lt;td&gt;{c.country}&lt;/td&gt;<br/>              &lt;td&gt;{c.postalCode}&lt;/td&gt;<br/>              &lt;td&gt;{c.phone}&lt;/td&gt;<br/>              &lt;td&gt;{c.email}&lt;/td&gt;<br/>              &lt;td&gt;{c.age}&lt;/td&gt;<br/>              &lt;td&gt;<br/>                &lt;Button<br/>                  variant="outline-primary"<br/>                  onClick={editContact.bind(this, c)}<br/>                &gt;<br/>                  Edit<br/>                &lt;/Button&gt;<br/>              &lt;/td&gt;<br/>              &lt;td&gt;<br/>                &lt;Button<br/>                  variant="outline-primary"<br/>                  onClick={deleteSelectedContact.bind(this, c.id)}<br/>                &gt;<br/>                  Delete<br/>                &lt;/Button&gt;<br/>              &lt;/td&gt;<br/>            &lt;/tr&gt;<br/>          ))}<br/>        &lt;/tbody&gt;<br/>      &lt;/Table&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};<br/>export default observer(HomePage);</span></pre><p id="874c" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">请注意，我们使用了<code class="fe lx ly lz ma b">export default observer(HomePage);</code>而不是<code class="fe lx ly lz ma b">export default HomePage;</code>。我们需要用<code class="fe lx ly lz ma b">observer</code>函数调用包装<code class="fe lx ly lz ma b">HomePage</code>,这样来自商店的最新数据将被传播到这个组件中。</p><p id="09ea" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">我们为<code class="fe lx ly lz ma b">HomePage</code>组件添加了<code class="fe lx ly lz ma b">React.SFC&lt;HomePageProps&gt;</code>注释，因此我们对组件进行了类型检查。<code class="fe lx ly lz ma b">HomePageProps</code>让我们检查道具的数据类型。</p><p id="9920" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">它有显示联系人的表格和添加、编辑和删除联系人的按钮。它在第一次加载时获取数据，在<code class="fe lx ly lz ma b">useEffect</code>的回调函数中调用<code class="fe lx ly lz ma b">getData</code>函数。每次渲染都会调用<code class="fe lx ly lz ma b">useEffect</code>的回调，所以我们想要设置一个<code class="fe lx ly lz ma b">initialized</code>标志，并检查它是否只在<code class="fe lx ly lz ma b">true</code>时才加载。</p><p id="9cad" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">注意，我们将这个组件的所有道具传递给了<code class="fe lx ly lz ma b">ContactForm</code>组件。要为<code class="fe lx ly lz ma b">onClick</code>处理函数传递一个参数，我们必须调用函数上的<code class="fe lx ly lz ma b">bind</code>，并将函数的参数作为第二个参数传递给<code class="fe lx ly lz ma b">bind</code>。例如，在这个文件中，我们有<code class="fe lx ly lz ma b">editContact.bind(this, c)</code>，其中<code class="fe lx ly lz ma b">c</code>是联系对象。<code class="fe lx ly lz ma b">editContact</code>功能定义如下:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="2d2b" class="kb kc it ma b gy mk ml l mm mn">const editContact = (contact) =&gt; {<br/>    setSelectedContact(contact);<br/>    setOpenEditModal(true);<br/>  }</span></pre><p id="10a3" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated"><code class="fe lx ly lz ma b">c</code>是我们传入的<code class="fe lx ly lz ma b">contact</code>参数。</p><p id="1ca3" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">接下来，我们创建一个名为<code class="fe lx ly lz ma b">HomePage.css</code>的文件，并放入:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="b8ec" class="kb kc it ma b gy mk ml l mm mn">.home-page {<br/>  padding: 20px;<br/>}</span></pre><p id="1893" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在<code class="fe lx ly lz ma b">index.tsx</code>中，我们将现有代码替换为:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="1ea9" class="kb kc it ma b gy mk ml l mm mn">import React from "react";<br/>import ReactDOM from "react-dom";<br/>import "./index.css";<br/>import App from "./App";<br/>import * as serviceWorker from "./serviceWorker";<br/>import { ContactsStore } from "./store";<br/>const contactsStore = new ContactsStore();</span><span id="fce6" class="kb kc it ma b gy mo ml l mm mn">ReactDOM.render(<br/>  &lt;App contactsStore={contactsStore} /&gt;,<br/>  document.getElementById("root")<br/>);</span><span id="aa3b" class="kb kc it ma b gy mo ml l mm mn">// If you want your app to work offline and load faster, you can change<br/>// unregister() to register() below. Note this comes with some pitfalls.<br/>// Learn more about service workers: <a class="ae mb" href="https://bit.ly/CRA-PWA" rel="noopener ugc nofollow" target="_blank">https://bit.ly/CRA-PWA</a><br/>serviceWorker.unregister();</span></pre><p id="64a6" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">然后我们创建一个名为<code class="fe lx ly lz ma b">requests.tsx</code>的文件，并添加:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="8271" class="kb kc it ma b gy mk ml l mm mn">import { Contact } from "./interfaces";</span><span id="89af" class="kb kc it ma b gy mo ml l mm mn">const APIURL = '<a class="ae mb" href="http://localhost:3000'" rel="noopener ugc nofollow" target="_blank">http://localhost:3000'</a>;<br/>const axios = require('axios');</span><span id="4c7a" class="kb kc it ma b gy mo ml l mm mn">export const getContacts = () =&gt; axios.get(`${APIURL}/contacts`);</span><span id="e43f" class="kb kc it ma b gy mo ml l mm mn">export const addContact = (data: Contact) =&gt; axios.post(`${APIURL}/contacts`, data);</span><span id="b96a" class="kb kc it ma b gy mo ml l mm mn">export const editContact = (data: Contact) =&gt; axios.put(`${APIURL}/contacts/${data.id}`, data);</span><span id="a4fc" class="kb kc it ma b gy mo ml l mm mn">export const deleteContact = (id: number) =&gt; axios.delete(`${APIURL}/contacts/${id}`);</span></pre><p id="df2a" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这些函数向后端发出HTTP请求，以保存和删除联系人。</p><p id="02be" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">最后，在<code class="fe lx ly lz ma b">public/index.html</code>中，我们将现有代码替换为:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="d95f" class="kb kc it ma b gy mk ml l mm mn">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="1b85" class="kb kc it ma b gy mo ml l mm mn">&lt;head&gt;<br/>  &lt;meta charset="utf-8" /&gt;<br/>  &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>  &lt;meta name="theme-color" content="#000000" /&gt;<br/>  &lt;meta name="description" content="Web site created using create-react-app" /&gt;<br/>  &lt;link rel="apple-touch-icon" href="logo192.png" /&gt;<br/>  &lt;link rel="manifest" crossorigin="use-credentials" href="%PUBLIC_URL%/manifest.json" /&gt;</span><span id="51a1" class="kb kc it ma b gy mo ml l mm mn">&lt;!--<br/>      manifest.json provides metadata used when your web app is installed on a<br/>      user's mobile device or desktop. See <a class="ae mb" href="https://developers.google.com/web/fundamentals/web-app-manifest/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/fundamentals/web-app-manifest/</a><br/>    --&gt;<br/>  &lt;!--<br/>      Notice the use of %PUBLIC_URL% in the tags above.<br/>      It will be replaced with the URL of the `public` folder during the build.<br/>      Only files inside the `public` folder can be referenced from the HTML.</span><span id="858e" class="kb kc it ma b gy mo ml l mm mn">Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will<br/>      work correctly both with client-side routing and a non-root public URL.<br/>      Learn how to configure a non-root public URL by running `npm run build`.<br/>    --&gt;<br/>  &lt;title&gt;React Address Book App&lt;/title&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae mb" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /&gt;<br/>&lt;/head&gt;</span><span id="c30a" class="kb kc it ma b gy mo ml l mm mn">&lt;body&gt;<br/>  &lt;noscript&gt;You need to enable JavaScript to run this app.&lt;/noscript&gt;<br/>  &lt;div id="root"&gt;&lt;/div&gt;<br/>  &lt;!--<br/>      This HTML file is a template.<br/>      If you open it directly in the browser, you will see an empty page.</span><span id="b298" class="kb kc it ma b gy mo ml l mm mn">You can add webfonts, meta tags, or analytics to this file.<br/>      The build step will place the bundled scripts into the &lt;body&gt; tag.</span><span id="2819" class="kb kc it ma b gy mo ml l mm mn">To begin the development, run `npm start` or `yarn start`.<br/>      To create a production bundle, use `npm run build` or `yarn build`.<br/>    --&gt;<br/>&lt;/body&gt;</span><span id="35e8" class="kb kc it ma b gy mo ml l mm mn">&lt;/html&gt;</span></pre><p id="8752" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">这将更改标题并添加引导样式表。</p><p id="bd48" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">现在，我们可以通过在Windows上运行<code class="fe lx ly lz ma b">set PORT=3001 &amp;&amp; react-scripts start</code>或在Linux上运行<code class="fe lx ly lz ma b">PORT=3006 react-scripts start</code>来运行应用程序。</p><p id="e4b4" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">要启动后端，我们首先通过运行<code class="fe lx ly lz ma b">npm i json-server</code>来安装<code class="fe lx ly lz ma b">json-server</code>包。然后转到我们的项目文件夹并运行:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="d3e4" class="kb kc it ma b gy mk ml l mm mn">json-server --watch db.json</span></pre><p id="f6b5" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">在<code class="fe lx ly lz ma b">db.json</code>中，将文本改为:</p><pre class="mc md me mf gt mg ma mh mi aw mj bi"><span id="94b3" class="kb kc it ma b gy mk ml l mm mn">{<br/>  "contacts": [<br/>  ]<br/>}</span></pre><p id="6e0c" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">现在我们有了在<code class="fe lx ly lz ma b">requests.js</code>中定义的<code class="fe lx ly lz ma b">contacts</code>端点。</p><p id="28e2" class="pw-post-body-paragraph kx ky it kz b la ls lc ld le lt lg lh kk lu lj lk ko lv lm ln ks lw lp lq lr im bi translated">最终，我们得到了以下结果:</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mp"><img src="../Images/f0189119955e2e23d8ca9a28cc9761f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LFb2MFrfNtkOUItdGkWZWg.png"/></div></div></figure><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mp"><img src="../Images/751d2681035b39a9bbd8da8b261ec55b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KpQnx7nTcBYOKO3CinOc8w.png"/></div></div></figure><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mp"><img src="../Images/9d3348846e2374867d8616963dcd66e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BSZB0BkJjmLplax7WILf7A.png"/></div></div></figure></div></div>    
</body>
</html>