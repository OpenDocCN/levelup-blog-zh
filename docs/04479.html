<html>
<head>
<title>Elixir, Phoenix, Typescript, and React — 2020 Edition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">灵药，凤凰，打字稿，和反应-2020年版</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/elixir-phoenix-typescript-and-react-2020-edition-32ceb753705?source=collection_archive---------5-----------------------#2020-06-29">https://levelup.gitconnected.com/elixir-phoenix-typescript-and-react-2020-edition-32ceb753705?source=collection_archive---------5-----------------------#2020-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ddc8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建现代Web应用程序堆栈的最新指南</h2></div><p id="4b1e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">这是我之前指南的更新版，发表于2019年12月</em> <a class="ae lc" href="https://dev.to/aisrael/elixir-phoenix-with-typescript-and-react-december-2019-edition-39l4" rel="noopener ugc nofollow" target="_blank"> <em class="lb">日DEV.to </em> </a> <em class="lb">。</em></p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="b69e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Github上也有代码:<a class="ae lc" href="https://github.com/aisrael/elixir-phoenix-typescript-react" rel="noopener ugc nofollow" target="_blank">aisrael/elixir-phoenix-typescript-react</a></p><p id="ba61" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然基本方法保持不变，但有人在我的回购协议上提交了一张罚单，要求将其升级到Phoenix 1.5。</p><p id="3de8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我没有采用早期的代码库并将其升级到Phoenix 1.5(我已经为其他几个项目成功地做到了这一点)，而是决定更新2020年的原始文章。</p><p id="cd3e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们回到正题。</p><h1 id="aa25" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated"><strong class="ak">先决条件</strong></h1><p id="35be" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">本指南假设您已经进行了以下设置:</p><ul class=""><li id="5073" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated"><strong class="kh ir">仙丹</strong> (1.10.3)，这意味着你还需要</li><li id="9877" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">二郎</li><li id="f904" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir"> npm </strong> (@6.14.5)</li><li id="0a07" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">git(不是真的需要，但无论如何你都会想要)</li><li id="95a5" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir"> Docker Compose </strong>(用于运行PostgreSQL)</li></ul><p id="e64f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你还没有Elixir(和Erlang)，我强烈推荐使用<a class="ae lc" href="https://asdf-vm.com/" rel="noopener ugc nofollow" target="_blank"> asdf </a>来管理Elixir/Erlang版本。</p><p id="9c43" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据您平台的说明安装<code class="fe mv mw mx my b">asdf</code>，然后使用<code class="fe mv mw mx my b">asdf</code>安装Erlang和Elixir:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="96f0" class="nh ll iq my b gy ni nj l nk nl">$ asdf plugin add erlang<br/>$ asdf install erlang 23.0.2<br/>$ asdf global erlang 23.0.2</span><span id="7532" class="nh ll iq my b gy nm nj l nk nl">$ asdf plugin add elixir<br/>$ asdf install elixir 1.10.3<br/>$ asdf global elixir 1.10.3</span></pre><h2 id="6b99" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak">凤凰</strong></h2><p id="df6b" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">(如果您已经有了使用Elixir Phoenix应用程序的经验，您可能希望直接跳到Typescript和React部分。)</p><p id="d4a8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您还没有这样做，让我们按照<a class="ae lc" href="https://hexdocs.pm/phoenix/installation.html" rel="noopener ugc nofollow" target="_blank"> Phoenix安装说明</a>安装Phoenix。</p><p id="8bfa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们需要获得十六进制软件包管理器:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="72f6" class="nh ll iq my b gy ni nj l nk nl">$ mix local.hex<br/>Are you sure you want to install "<a class="ae lc" href="https://repo.hex.pm/installs/1.10.0/hex-0.20.5.ez" rel="noopener ugc nofollow" target="_blank">https://repo.hex.pm/installs/1.10.0/hex-0.20.5.ez</a>"? [Yn] y<br/>* creating /Users/aisrael/.asdf/installs/elixir/1.10.3/.mix/archives/hex-0.20.5</span></pre><p id="0f28" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后是酏剂混合存档:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="61a4" class="nh ll iq my b gy ni nj l nk nl">$ mix archive.install hex phx_new 1.5.3<br/>Resolving Hex dependencies…<br/>Dependency resolution completed:<br/>New:<br/>phx_new 1.5.3<br/>* Getting phx_new (Hex package)<br/>All dependencies are up to date<br/>Compiling 10 files (.ex)<br/>Generated phx_new app<br/>Generated archive "phx_new-1.5.3.ez" with MIX_ENV=prod<br/>Are you sure you want to install "phx_new-1.5.3.ez"? [Yn] Y<br/>* creating /Users/aisrael/.asdf/installs/elixir/1.10.3/.mix/archives/phx_new-1.5.3</span></pre><p id="5051" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以使用<code class="fe mv mw mx my b">mix phx.new --version</code>检查Phoenix安装是否顺利:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="b956" class="nh ll iq my b gy ni nj l nk nl">$ mix phx.new --version<br/>Phoenix v1.5.3</span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="d19f" class="lk ll iq bd lm ln ny lp lq lr nz lt lu jw oa jx lw jz ob ka ly kc oc kd ma mb bi translated"><strong class="ak">生成凤凰app </strong></h1><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="5fb5" class="nh ll iq my b gy ni nj l nk nl">$ mix phx.new hello_react --umbrella</span></pre><p id="4c90" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这会在当前目录下生成名为<code class="fe mv mw mx my b">hello_react_umbrella</code>的仙丹+凤凰<a class="ae lc" href="https://elixir-lang.org/getting-started/mix-otp/dependencies-and-umbrella-projects.html" rel="noopener ugc nofollow" target="_blank">伞app </a>，目录结构如下:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="b836" class="nh ll iq my b gy ni nj l nk nl">.<br/>├── apps<br/>│ ├── hello_react<br/>│ └── hello_react_web<br/>├── config<br/>└── deps</span></pre><p id="9423" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两款灵药应用分别是<code class="fe mv mw mx my b">/apps/hello_react</code>和<code class="fe mv mw mx my b">apps/hello_react_web</code>。</p><p id="1de5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个应用程序都有自己的依赖配置，尽管整个保护伞项目将为所有应用程序提供一个共享的依赖库(在<code class="fe mv mw mx my b">/deps</code>中)。</p><p id="9a44" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有子应用程序也在<code class="fe mv mw mx my b">/config</code>文件夹中共享相同的根配置。</p><p id="736d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从伞状应用程序开始，因为随着应用程序变得越来越大和越来越复杂，它使组织代码变得更容易。此外，我们发现将一个伞状应用程序项目重构为一个单独的应用程序项目比反过来更容易。</p><h2 id="1285" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak"> PostgreSQL，MySQL，或者`</strong> <code class="fe mv mw mx my b"><strong class="ak">— no-ecto</strong></code> <strong class="ak"> ` </strong></h2><p id="792a" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">默认情况下，Phoenix的数据库使用PostgreSQL。</p><p id="9627" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想使用MySQL而不是PostgreSQL，那么您需要使用</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="37c2" class="nh ll iq my b gy ni nj l nk nl">mix phx.new hello_react --umbrella --database mysql</span></pre><p id="33bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你不需要一个数据库，或者只希望在没有数据库的情况下使用，那么使用</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="76f9" class="nh ll iq my b gy ni nj l nk nl">mix phx.new hello_react --umbrella --no-ecto</span></pre><p id="0415" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，本指南的其余部分假设缺省值为Postgres。</p><h2 id="47aa" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak"> Git </strong></h2><p id="4ff2" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">此时，我们应该开始使用Git来跟踪我们的更改。如果您不需要使用Git，请随意跳到下一节。</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="4a96" class="nh ll iq my b gy ni nj l nk nl">$ cd hello_react_umbrella<br/>~/hello_react_umbrella$</span></pre><p id="98c8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="2ee4" class="nh ll iq my b gy ni nj l nk nl">$ git init<br/>Initialized empty Git repository in ~/hello_react_umbrella/.git/<br/>$ git add -A<br/>$ git commit -m “mix phx.new hello_react --umbrella”</span></pre><h2 id="1dc2" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak"> Docker撰写</strong></h2><p id="bf91" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">由于我们将需要一个PostgreSQL服务器来运行我们的Phoenix应用程序，为了本地开发和测试的目的，我们发现使用Docker，特别是Docker Compose可以轻松处理服务依赖。</p><p id="929d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在项目根中创建下面的<code class="fe mv mw mx my b">docker-compose.yml</code>:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="25a4" class="nh ll iq my b gy ni nj l nk nl">version: "3"<br/>services:<br/>  postgres:<br/>    image: postgres:11.5<br/>    ports:<br/>      - 5432:5432<br/>    environment:<br/>      POSTGRES_USER: postgres<br/>      POSTGRES_PASSWORD: postgres<br/>      POSTGRES_DB: hello_react_dev</span></pre><p id="d9e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意，我们配置PostgreSQL(使用<code class="fe mv mw mx my b">POSTGRES_*</code>环境变量)来处理生成的Phoenix应用程序默认值。</p><p id="3c9f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，要在后台运行Postgres，您只需要:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="5c93" class="nh ll iq my b gy ni nj l nk nl">$ docker-compose up -d<br/>Creating network "hello_react_umbrella_default" with the default driver<br/>Creating hello_react_umbrella_postgres_1 ... done</span></pre><p id="9e73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于Docker编写超出了本文的范围，对于其他Docker编写命令，请访问:</p><ul class=""><li id="c99a" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated"><a class="ae lc" href="https://docs.docker.com/compose/reference/overview/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/compose/reference/overview/</a></li></ul><p id="b40f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您不能或不想使用Docker &amp; Docker Compose，您将不得不在本地工作站上手动安装PostgreSQL。确保使用由<code class="fe mv mw mx my b">mix phx.new</code>生成的相同默认值对其进行配置，或者使用适当的凭证修改各自的<code class="fe mv mw mx my b">config/*.exs</code>文件。</p><h2 id="ccec" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak">节点</strong></h2><p id="b26d" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">在运行Phoenix应用程序之前，我们需要使用<code class="fe mv mw mx my b">npm install</code>初始化生成的CSS和Javascript资产:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="ea10" class="nh ll iq my b gy ni nj l nk nl">~/hello_react_umbrella$ cd apps/hello_react_web/assets<br/>~/hello_react_umbrella/apps/hello_web/assets$ npm install</span></pre><h2 id="48e7" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak">欢迎来到凤凰城！</strong></h2><p id="5a8e" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">此时，我们应该能够运行我们的Phoenix应用程序了。从项目根目录(您可能希望在新的终端窗口或标签中运行):</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="e0e8" class="nh ll iq my b gy ni nj l nk nl">$ mix phx.server</span></pre><p id="789c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(如果你得到一个询问你是否要安装<code class="fe mv mw mx my b">rebar3</code>的提示，就直接说是。)</p><p id="9c40" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，如果我们访问http://localhost:4000 ，我们应该能够看到熟悉的“欢迎来到凤凰城！”页面:</p><figure class="mz na nb nc gt oe gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi od"><img src="../Images/f445dbfe7a98ef1cb4f67628266c056d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v10hRBGa5JAAa6vCtT0_Rw.png"/></div></div></figure><h1 id="f49a" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated"><strong class="ak">打字稿</strong></h1><p id="2a79" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">我们准备开始向前端添加Typescript。</p><p id="d3f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，确保我们回到了<code class="fe mv mw mx my b">apps/hello_react_web/assets/</code>。使用以下命令添加类型脚本库:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="b5fe" class="nh ll iq my b gy ni nj l nk nl">$ npm install --save-dev typescript ts-loader source-map-loader <a class="ae lc" href="http://twitter.com/types/phoenix" rel="noopener ugc nofollow" target="_blank">@types/phoenix</a></span></pre><h2 id="75f0" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><code class="fe mv mw mx my b"><strong class="ak">Typescript Configuration</strong></code></h2><p id="9874" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">然后，让Typescript为我们生成一个默认的<code class="fe mv mw mx my b">tsconfig.json</code>:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="2678" class="nh ll iq my b gy ni nj l nk nl">$ ./node_modules/.bin/tsc --init<br/>message TS6071: Successfully created a tsconfig.json file.</span></pre><p id="cae2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要对Typescript默认设置进行一些更改。下面是一个最小的<code class="fe mv mw mx my b">tsconfig.json</code>，做了一些必要的修改:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="6538" class="nh ll iq my b gy ni nj l nk nl">{<br/>  "compilerOptions": {<br/>    "target": "es5",<br/>    "module": "ESNext",<br/>    "allowJs": true,<br/>    "jsx": "react",<br/>    "outDir": "./dist/",<br/>    "strict": true,<br/>    "esModuleInterop": true,<br/>    "forceConsistentCasingInFileNames": true<br/>  },<br/>  "exclude": [<br/>    "/node_modules/**/*",<br/>  ]<br/>}</span></pre><h2 id="3ac7" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak">配置Webpack </strong></h2><p id="7fd9" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">接下来，我们需要告诉Webpack识别<code class="fe mv mw mx my b">.ts</code>文件和<code class="fe mv mw mx my b">.js</code>文件:</p><p id="80e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开<code class="fe mv mw mx my b">apps/hello_react_web/assets/webpack.config.js</code>，将第一个模块规则改为:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="57cc" class="nh ll iq my b gy ni nj l nk nl">    rules: [<br/>      {<br/>        test: /\.(j|t)s$/,<br/>        exclude: /node_modules/,<br/>        use: [<br/>          {<br/>            loader: "babel-loader"<br/>          },<br/>          {<br/>            loader: "ts-loader"<br/>          }<br/>        ]<br/>      },</span></pre><p id="f00f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，在<code class="fe mv mw mx my b">"module"</code>后添加一个最外面的<code class="fe mv mw mx my b">"resolve"</code>键，如下所示:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="bfa0" class="nh ll iq my b gy ni nj l nk nl">  resolve: {<br/>    extensions: [".ts", ".js"]<br/>  },</span></pre><h2 id="bbb9" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak"> app.js </strong></h2><p id="000f" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">当我们生成Phoenix应用程序时，它用一行<code class="fe mv mw mx my b">import css from "../css/app.css";</code>创建了<code class="fe mv mw mx my b">apps/hello_react_web/assets/js/app.js</code>。</p><p id="607e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当Typescript解析该文件时，这会导致问题。你可以在<a class="ae lc" href="https://stackoverflow.com/questions/41336858/how-to-import-css-modules-with-typescript-react-and-webpack" rel="noopener ugc nofollow" target="_blank">这个堆栈溢出问题</a>和这个<a class="ae lc" href="https://medium.com/@sapegin/css-modules-with-typescript-and-webpack-6b221ebe5f10" rel="noopener">页面</a>上看到一个冗长的讨论和几个解决方法。</p><p id="139f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在继续之前，解决这个问题的最简单(虽然不是最好的)方法(这样Webpack将继续处理我们的<code class="fe mv mw mx my b">app.css</code>)是将该行改为使用<code class="fe mv mw mx my b">require</code>:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="01e9" class="nh ll iq my b gy ni nj l nk nl">const _css = require("../css/app.css");</span></pre><p id="d042" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们实际上并不使用该变量(我们只需要它以便Webpack可以正确地生成我们的<code class="fe mv mw mx my b">app.css</code>文件)，我们在它的名称前加上一个下划线，以抑制Typescript否则会发出的“未使用的变量”警告。</p><h2 id="2c81" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated">欢迎来到凤凰城！</h2><p id="d782" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">为了实际演示Typescript，我们将创建一个新的Typescript模块<code class="fe mv mw mx my b">apps/hello_react_web/assets/js/hello.ts</code>:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="08ec" class="nh ll iq my b gy ni nj l nk nl">function greet(name: string): string {<br/>  return "Welcome to " + name + " with Typescript!";<br/>}</span><span id="4ccb" class="nh ll iq my b gy nm nj l nk nl">export default greet;</span></pre><p id="5b45" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，在<code class="fe mv mw mx my b">assets/js/app.js</code>的末尾添加以下几行:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="dc38" class="nh ll iq my b gy ni nj l nk nl">import greet from "./hello";</span><span id="214a" class="nh ll iq my b gy nm nj l nk nl">document.querySelector("section.phx-hero h1").innerHTML = greet("Phoenix");</span></pre><p id="1efb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mv mw mx my b">localhost:4000</code>刷新页面，您应该会看到“欢迎来到Phoenix with Typescript！”。</p><figure class="mz na nb nc gt oe gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi od"><img src="../Images/a2b401c3d868ac102cb094a1a004e59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jOX-w9Hy7aY7W4RrFrYEA.png"/></div></div></figure><h1 id="7876" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">反应</h1><p id="af49" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">让我们按照指南继续添加React roughly，网址为:<a class="ae lc" href="https://www.typescriptlang.org/docs/handbook/react-&amp;-webpack.html" rel="noopener ugc nofollow" target="_blank">https://www.typescriptlang.org/docs/handbook/react-&amp;-web pack . html</a></p><p id="96b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，添加必要的包:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="5fbd" class="nh ll iq my b gy ni nj l nk nl">$ npm install --save react react-dom<br/>$ npm install --save-dev <a class="ae lc" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank">@types/react</a> <a class="ae lc" href="http://twitter.com/types/react-dom" rel="noopener ugc nofollow" target="_blank">@types/react-dom</a></span></pre><p id="8393" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们再次需要重新配置<code class="fe mv mw mx my b">webpack.config.js</code>。</p><p id="c178" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们来认识一下<code class="fe mv mw mx my b">*.jsx</code>和<code class="fe mv mw mx my b">*.tsx</code>文件:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="d51c" class="nh ll iq my b gy ni nj l nk nl">    rules: [<br/>      {<br/>        test: /\.(j|t)sx?$/,<br/>        exclude: /node_modules/,</span></pre><p id="4566" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="01de" class="nh ll iq my b gy ni nj l nk nl">  resolve: {<br/>    extensions: [".ts", ".tsx", ".js", ".jsx"]<br/>  },</span></pre><h2 id="fd68" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak">我们的第一个组件</strong></h2><p id="e470" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">首先让我们将<code class="fe mv mw mx my b">apps/hello_react_web/assets/js/hello.ts</code>重命名为<code class="fe mv mw mx my b">apps/hello_react_web/assets/js/hello.tsx</code>(类似于如何从普通的<code class="fe mv mw mx my b">.js</code>中命名React JS文件<code class="fe mv mw mx my b">.jsx</code>):</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="4fca" class="nh ll iq my b gy ni nj l nk nl">$ mv apps/hello_react_web/assets/js/hello.ts apps/hello_react_web/assets/js/hello.tsx</span></pre><p id="0433" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，将<code class="fe mv mw mx my b">hello.tsx</code>的内容替换为:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="3e03" class="nh ll iq my b gy ni nj l nk nl">import React from "react";</span><span id="e61b" class="nh ll iq my b gy nm nj l nk nl">interface GreeterProps {<br/>  name: string;<br/>}</span><span id="997d" class="nh ll iq my b gy nm nj l nk nl">const Greeter: React.FC&lt;GreeterProps&gt; = (props: GreeterProps) =&gt; {<br/>  const name = props.name;<br/>  return (<br/>    &lt;section className="phx-hero"&gt;<br/>      &lt;h1&gt;Welcome to {name} with Typescript and React!&lt;/h1&gt;<br/>      &lt;p&gt;Peace-of-mind from prototype to production&lt;/p&gt;<br/>    &lt;/section&gt;<br/>  );<br/>};</span><span id="7366" class="nh ll iq my b gy nm nj l nk nl">export default Greeter;</span></pre><h2 id="f929" class="nh ll iq bd lm nn no dn lq np nq dp lu ko nr ns lw ks nt nu ly kw nv nw ma nx bi translated"><strong class="ak">欢迎来到Phoenix with Typescript and React</strong></h2><p id="0c10" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">接下来，在<code class="fe mv mw mx my b">apps/hello_react_web/lib/hello_react_web/templates/page/index.html.eex</code>中，移除该部分:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="1fe0" class="nh ll iq my b gy ni nj l nk nl">&lt;section class="phx-hero"&gt;<br/>  &lt;h1&gt;&lt;%= gettext "Welcome to %{name}!", name: "Phoenix" %&gt;&lt;/h1&gt;<br/>  &lt;p&gt;Peace-of-mind from prototype to production&lt;/p&gt;<br/>&lt;/section&gt;</span></pre><p id="fc34" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">替换成简单的:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="a1e6" class="nh ll iq my b gy ni nj l nk nl">&lt;div id=”greeting”&gt;&lt;/div&gt;</span></pre><p id="0ef2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，在<code class="fe mv mw mx my b">apps/hello_react_web/assets/js/app.js</code>中，将最后几行替换为:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="c2a4" class="nh ll iq my b gy ni nj l nk nl">import React from "react";<br/>import ReactDOM from "react-dom";</span><span id="ae86" class="nh ll iq my b gy nm nj l nk nl">import Greeter from "./hello";</span><span id="40da" class="nh ll iq my b gy nm nj l nk nl">const greeting = document.getElementById("greeting");<br/>ReactDOM.render(&lt;Greeter name="Phoenix" /&gt;, greeting);</span></pre><p id="24d0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后(您可能需要使用<code class="fe mv mw mx my b">mix phx.server</code>重启Phoenix，并等待几秒钟让Webpack编译所有内容)，当我们重新加载<code class="fe mv mw mx my b">localhost:4000</code>时，我们应该看到“欢迎使用Typescript和React来到Phoenix！`</p><figure class="mz na nb nc gt oe gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi od"><img src="../Images/1763d8c09443220707ba5503c136cd97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zU-aNMfqocNCOb9s2Qsz8Q.png"/></div></div></figure></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="60fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您已经准备好使用最现代、最高效的Web应用程序堆栈来构建您的下一个unicorn Web应用程序。</p><p id="86e8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在未来，我希望通过添加一个React UI框架和一篇关于如何将GraphQL添加到Phoenix + React应用程序的文章来阐述这一点。</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><div class="mz na nb nc gt ol"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">编写面试问题</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">掌握编码面试的过程</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">技术开发</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz oj ol"/></div></div></a></div></div></div>    
</body>
</html>