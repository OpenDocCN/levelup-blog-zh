# 适用于您的数据科学项目的云原生数据库

> 原文：<https://levelup.gitconnected.com/a-cloud-native-database-for-your-data-science-project-d55ed43ab9e7>

使用免费的企业级数据仓库将模型投入生产。

![](img/6bd1f16a6b6207e06a907c1ed418a76a.png)

【https://unsplash.com/photos/gpjvRZyavZc 号

# 为什么？

在现实世界的数据科学中，您永远不会收到一个漂亮干净的 CSV 文件，但它将来自数据库，或者如果您幸运的话，来自数据仓库。

在大多数数据科学课程中，没有人会谈论数据库，也没有人会教你如何使用数据库。事实上，没有数据科学家愿意花时间安装和管理数据库。幸运的是，有自主数据库，一个*“数据科学家友好”*云原生数据库。

Autonomous DB 运行在 Oracle Cloud 上，它是一项完全托管的服务，可以为您自动执行各种安装或维护操作。你只需要使用它，在本文中，我们将学习如何在数据科学项目中使用它。

在开始之前，我想告诉您，作为我们始终免费服务层的一部分，您可以免费使用 2 个 Oracle 自治数据库。 [**查看我关于 Oracle 云始终免费层的文章，了解更多信息并注册！**](https://medium.com/@roberto.di.bella/5-reasons-why-oracle-free-tier-is-better-than-your-raspberry-pie-277ac8cb37e3)

> 要注册永远免费的服务[官方文档](https://www.oracle.com/cloud/free/#GUID-94719269-9218-4FAF-870E-6F0783E209FD)。

我们现在准备通过 SQLAlchemy 连接到数据库，并使用连接查询 DataFrame 格式的完整 titanic 数据集。

这次我们将保持简单:我们将删除一些列和所有缺少值的行。当然，我们会付出精度下降的代价，但在这里我们不关心这个。

下一步包括将分类变量转换成数值变量:因此我们使用 sklearn 的" *LabelEncoder* "对象将列" *SEX* "和"*abowed*"转换成数值。

> **注意**:在**拟合/变换**之后，保存每个编码器很重要，这样我们就可以在将新数据输入模型之前，在**推理时间**重用它。为此，我们将使用 pickle 模块，如下所示。

我们继续像往常一样，使用 80/20 规则分割训练和测试数据，并创建一个简单的 *RandomForest* 分类器，然后我们向其提供训练数据(使用 fit 函数)。随后我们用评分法对模型的性能进行了评估。

# 现在呢？推理阶段。

## 好了，我们保存了我们的模型，是时候使用它了！假设我们发现了一份新的乘客名单，但我们不知道他们是否幸存。让我们用我们的模型来看看谁更有可能幸存下来！

首先，我们将重新加载我们之前保存的对象:两个*标签编码器*，一个*缩放器*，以及经过训练的*模型*。

现在，让我们像以前一样从自治数据仓库中获取新乘客的数据，然后对训练数据应用相同的转换。这一步至关重要，否则，模型不会接受它。

我们将使用刚刚加载的模型来预测他们是否能幸存。

我们将最终**将预测发送回自主数据仓库** e，这样我们就可以用我们最喜欢的分析工具构建一些漂亮的仪表板！

# 结论

在本文中，我们学习了如何使用云原生数据库来构建并在生产中使用在一个非常流行的数据集上训练的 scikit-learn 模型。

首先，我们看到了如何使用流行的 SQLAlchemy 库创建和连接自治数据仓库。然后，我们从数据库中提取数据，构建模型，并保存推理阶段所需的关键成分，如缩放器、编码器和模型。最后但同样重要的是，我们从数据库中获得新的未分类数据，并用训练好的模型对其进行分类。

## 了解自治数据库中包含的工具的更多信息，并发现它们如何帮助您[查看我们的现场活动](https://go.oracle.com/LP=105660?elqCampaignId=283506&src1=:se:lw:ie:pt:::OD&evite=WWMK210112P00135:se:lw:ie:pt:::OD)！

## 要了解永远免费的云资源[请点击这里](https://www.oracle.com/cloud/free/?source=:so:li:or:awr:ocorp:::RC_WWSA191002P00028:GjTemp&SC=:so:li:or:awr:ocorp:::RC_WWSA191002P00028:GjTemp&pcode=WWSA191002P00028)！

## 想要更多吗？加入非官方[不和谐社区](https://discord.gg/NfcvyKxrRU)！

> 我是罗伯特·迪贝拉，甲骨文公司的数据科学家顾问。帮助数据科学家、开发人员和公司在 Oracle 云上取得成功。
> 
> 在 LinkedIn 上随意联系。