<html>
<head>
<title>My og:image Bug</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的og:图像Bug</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/my-og-image-bug-5226f2fd9311?source=collection_archive---------7-----------------------#2021-08-17">https://levelup.gitconnected.com/my-og-image-bug-5226f2fd9311?source=collection_archive---------7-----------------------#2021-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="07d0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">由于社交媒体处理数据的方式不同，我网站上的一个bug在脸书(而不是Twitter)上分享时引起了一个问题。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2f6cd6aaadc998f6787c4b07811daa29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sZa7ulfv4kbL4988uR-maQ.jpeg"/></div></div></figure><p id="f526" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是我在开发我的博客时发现的一个bug的故事。这让我困惑了一段时间，直到我发现一个看似无关的问题导致了这个问题。这可能有点傻，但也可能很有趣，因为它展示了社交网络处理页面元数据的不同之处。</p><h1 id="b12b" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">问题是</h1><p id="491d" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">当在社交媒体上分享我的博客链接时，缩略图在Twitter或Linkedin上看起来没问题，但在脸书上就不一样了。Twitter卡片上有博客文章的缩略图，但脸书卡片上显示的是普通网站的缩略图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/d29b1002f0d1421751e8f8e7c5b24d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DjzutFdFnCyvun_b.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">左边的卡片来自Twitter，上面有正确的图片。右边的卡片来自脸书，它显示的是一个普通网站的缩略图。</figcaption></figure><p id="5de9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我用相同的信息填充OpenGraph和Twitter卡元数据。所以应该是同一个图像。</p><p id="6d13" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这不可能是图像不符合脸书的标准。我分享了用同样的格式和压缩方式生成的大小相似的图片。此外，脸书的文件中没有任何东西表明我做错了什么。发生了什么事？</p><h1 id="d1b6" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">根本原因</h1><p id="ddaf" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我开始挖掘代码，发现这是博客文章的元信息(代码减少了):</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="8218" class="mv lp iq mr b gy mw mx l my mz">&lt;meta property="og:title" content="The Simpsons in CSS" /&gt;<br/>&lt;meta property="og:type" content="website" /&gt;<br/>&lt;meta property="og:url" content="https://alvaromontoro.com/blog/" /&gt;<br/>&lt;meta property="og:image" content="https://alvaromontoro.com/images/blog/the-simpsons-in-css.png" /&gt;<br/>&lt;meta property="og:description" content="This is a personal project..." /&gt;<br/><br/>&lt;meta name="twitter:card" content="summary" /&gt;<br/>&lt;meta name="twitter:url" content="https://alvaromontoro.com/blog/" /&gt;<br/>&lt;meta name="twitter:title" content="The Simpsons in CSS" /&gt;<br/>&lt;meta name="twitter:description" content="This is a personal project..." /&gt;<br/>&lt;meta name="twitter:image" content="https://alvaromontoro.com/images/blog/the-simpsons-in-css.png" /&gt;</span></pre><p id="4ac3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">匹配值:<code class="fe na nb nc mr b">og:title</code>与<code class="fe na nb nc mr b">twitter:title</code>相同，<code class="fe na nb nc mr b">og:url</code>与<code class="fe na nb nc mr b">twitter:url</code>、<code class="fe na nb nc mr b">og:description</code>与<code class="fe na nb nc mr b">twitter:description</code>、<code class="fe na nb nc mr b">og:image</code>与<code class="fe na nb nc mr b">twitter:image</code>相似。OpenGraph和Twitter元数据都是如此。</p><p id="b706" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后我意识到<code class="fe na nb nc mr b">og:url</code> / <code class="fe na nb nc mr b">twitter:url</code>不是正确的那个。两者都匹配，但它指向了错误的URL:它不是博客文章，而是博客本身。但是对缩略图来说重要的是<code class="fe na nb nc mr b">og:image</code> / <code class="fe na nb nc mr b">twitter:image</code>值...对吗？</p><p id="286b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不对！我运行了一个快速测试，纠正了URL，也修复了缩略图错误！不幸的是，我陷入了与我在上一篇文章中描述的<a class="ae ln" href="https://alvaromontoro.com/blog/67844/web-confusion" rel="noopener ugc nofollow" target="_blank">相同的错误。</a></p><p id="003d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当<strong class="kt ir"> Twitter和Linkedin正在提取</strong> <code class="fe na nb nc mr b"><strong class="kt ir">og:image</strong></code> <strong class="kt ir">数据并使用它来显示缩略图时，脸书正在使用</strong> <code class="fe na nb nc mr b"><strong class="kt ir">og:url</strong></code> <strong class="kt ir">值作为索引，并从缓存/数据库</strong>中提取图像信息，而不是使用<code class="fe na nb nc mr b">og:image</code>。导致了这个问题。</p><h1 id="d6ec" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">解决方案</h1><p id="7aa4" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">知道了这个问题，解决方案很简单:<strong class="kt ir">确保</strong> <code class="fe na nb nc mr b"><strong class="kt ir">og:url</strong></code> <strong class="kt ir">与实际的页面URL </strong>匹配。不管怎样，这是正确的做法:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="c1c6" class="mv lp iq mr b gy mw mx l my mz">&lt;meta property="og:title" content="The Simpsons in CSS" /&gt;<br/>&lt;meta property="og:type" content="website" /&gt;<br/>&lt;meta property="og:url" content="https://alvaromontoro.com/blog/67971/the-simpsons-in-css" /&gt;<br/>&lt;meta property="og:image" content="https://alvaromontoro.com/images/blog/the-simpsons-in-css.png" /&gt;<br/>&lt;meta property="og:description" content="This is a personal project..." /&gt;<br/><br/>&lt;meta name="twitter:card" content="summary" /&gt;<br/>&lt;meta name="twitter:url" content="https://alvaromontoro.com/blog/67971/the-simpsons-in-css" /&gt;<br/>&lt;meta name="twitter:title" content="The Simpsons in CSS" /&gt;<br/>&lt;meta name="twitter:description" content="This is a personal project..." /&gt;<br/>&lt;meta name="twitter:image" content="https://alvaromontoro.com/images/blog/the-simpsons-in-css.png" /&gt;</span></pre><p id="7159" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，脸书卡片也显示了正确的图像:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/f739410c17b1b2c5dcc49aae10c40a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*uUDor1eoVk39oNzh.png"/></div></figure><p id="91ca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是我博客上关于<code class="fe na nb nc mr b">og:image</code> bug以及我如何解决它的故事。感谢阅读:)</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="8fc0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="nl">原载于2021年8月17日</em><a class="ae ln" href="http://alvaromontoro.com/blog/67985/my-og-image-bug" rel="noopener ugc nofollow" target="_blank"><em class="nl">https://alvaromontoro.com</em></a><em class="nl">。</em></p></div></div>    
</body>
</html>