# 如何在 Unity 中创建一个自我再生的耐力条

> 原文：<https://levelup.gitconnected.com/how-to-create-a-self-regenerating-stamina-bar-in-unity-44ab156dbad9>

![](img/396284b72337ce22172b38933dbceadf.png)

耐力条已经成为游戏中非常受欢迎的功能，这已经不是什么秘密了。耐力机制通过附加必要的动作来保持游戏的活力、吸引力和挑战性。当耐力被用来覆盖这些元素时，耗尽耐力会增加游戏的挑战性和战略性。

**目标**:在这篇文章中，你将学习如何制作一个按下一个键就会耗尽的耐力棒，并且当它不再被使用时会重新充满。

# **使用滑块**

![](img/a71f58136be7dd730029704d9daaf9bc.png)

[滑块动画](https://in.pinterest.com/pin/35254809569571045/)

[滑块](https://docs.unity3d.com/2018.3/Documentation/ScriptReference/UI.Slider.html)是一个可选的 UI 元素，通常用于需要一组最大和最小值的用户数据，如音量和屏幕亮度。然而，当通过代码进行调整时，它们可以更加通用。

在本教程中，我们的耐力栏将由一个滑块来表示

1.  通过右键单击→ UI →Slider 创建一个滑块，然后适当地命名它。

![](img/0d69c59559092cb71d4820ea65aae682.png)

2.将滑块放在您喜欢的任何位置，并确保将其固定到相应的位置。

![](img/a95eeffb4a6f235877bb83e8a759865c.png)

3.我们不会使用句柄，所以您可以在检查器中删除或停用它。

![](img/f1540569205a5a27d2539941220df358.png)

4.确保选中“使用整数”并设置最小值和最大值。

![](img/708b758cd42febb8e1fa130138f1bf9a.png)

5.现在，是时候设置颜色了。首先，我们设置背景颜色，这是当仪表用完时可以看到的颜色。您可以选择任何颜色或使其完全透明。

![](img/7f527a3c42b373ddeb454dade8709ad6.png)

6.然后，我们可以选择代表完整仪表的填充颜色。

![](img/257af81101abbfd12eeb79fad89c08e7.png)

7.确保滑块不可交互，因为我们将对其全部功能进行编程。

![](img/52cb3d39eb577faa0a672c96385fb1e0.png)

# 滑块编程

下面的例子展示了我为 2D 太空射手推力机构编写的代码，然而，同样的逻辑也适用于耐力棒。

1.  首先，我们的代码中需要 Unity UI 库。

![](img/ad770fccfa3c2ab1bc663dae4888aee7.png)

2.现在我们可以访问 UI 了，我们可以为滑块创建一个引用。这将是一个 SerializeField，以便我们可以在检查器中设置它。

![](img/c5d27ffc82a3126f1841cc647ff631b2.png)![](img/c2f3e2af3d6c1707464e57aee9555fe4.png)

3.在 Start 方法中获取 Slider 组件。

![](img/eb523212cecebc2fcca9003d87f88e01.png)

4.在试图在代码中使用组件之前，最好先检查它是否为空。

![](img/167f7f662a82f6f97b8e2ef7d7a63d31.png)

5.为最大或总燃料值创建一个全局**变量，并创建一个**布尔变量，帮助我们稍后控制推力**特性。默认情况下，推力变量将被设置为假，因为我们的球员不只是开始推力或运行。**

![](img/d8954fe7641ac402f20434f0a2e238eb.png)

5.在 Update 方法中设置滑块值。

![](img/d9a6b5e8c56286554d6184d4fd709c3f.png)

6.创建 void 方法来处理先前建立的布尔值。最佳实践是使用方法来更改此类变量的值，而不是动态更改。

请注意，每当玩家停止推进时，玩家代码中的速度变量是如何设置为默认值的，这意味着在此期间他们不会移动得更快。

![](img/b7442206b97eaed9ebbd92573483e6cd.png)

7.创建更新仪表或条形图的方法。这种方法是根据油量计减少或增加的速度来计算燃油总量的。int 参数值将在协程中设置。下面的 if 语句使用 stopThrusting 方法来确保当横杠用完时播放器的速度被设置为默认值。

![](img/4139e3c9887a177f3433c3fd53144e9d.png)

8.第一个协程用于推进或冲刺功能。只要我们之前创建的布尔值为真，while 循环就会运行，在此期间，它会每秒钟减少 20 的耐力，或者您在代码中选择的时间长度。

因为滑块值是在更新中设置的，所以这种计算会在发生时被它主动反映出来。

> **注意**:你可以在这里获得更多关于如何使用协程[的信息。](https://medium.com/codex/coroutines-with-unity-b5a2b3fc3426)

![](img/56ca5c2d20a427020e90b95269a5c45f.png)

9.第二个协程是重新填充量表，总体上遵循与前一个相同的逻辑。

![](img/bd023a674695b3701ea4fecbf569ff92.png)

10.最后，我们需要能够完成按键时的行为。这就是使用处理布尔值的方法的地方，通过在按键被按下或释放时调用它们，我们可以控制协程内的 while 循环何时激活，并且只要条件分别为真或假，就连续执行它们。

![](img/c85c4e9cfb6c7af72b73d567ac89bc83.png)

## **结果:**

![](img/6632f2e9fd671a4d37ca440f1a96d471.png)

这篇文章是我在 GameDevHQ 学徒期间正在进行的一系列编码挑战的一部分。接下来的文章将会涉及更多的内容！