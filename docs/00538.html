<html>
<head>
<title>Setup Express with TypeScript in 3 Easy Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过3个简单的步骤快速安装TypeScript</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setup-express-with-typescript-in-3-easy-steps-484772062e01?source=collection_archive---------0-----------------------#2019-04-16">https://levelup.gitconnected.com/setup-express-with-typescript-in-3-easy-steps-484772062e01?source=collection_archive---------0-----------------------#2019-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7268" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以经典的面向对象方式创建Express服务器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d5ba6d69ebde5c35826fa9e9c35b4657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*knOS0UnwOWHGvgtDXOppeg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">用类固醇表达</figcaption></figure><p id="45ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您是否被使用Express web服务器的NodeJS的易用性和快速开发所吸引，但又担心大型应用程序所需的可伸缩性和类型安全？不要害怕，TypeScript已经帮你搞定了。它仍然提供了脚本语言的优点和静态语言(如C#或Java)的健壮性。如果你已经知道JavaScript，学习TypeScript是微不足道的，配置它只需要一点额外的设置。</p><blockquote class="lr ls lt"><p id="b52a" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">只是指出，我知道有一些关于Medium的文章向您展示了如何使用Express和TypeScript，但是它们要么花了很多时间讨论为什么应该使用TypeScript，要么没有强调以面向对象的方式设置Express。本文的重点是向您展示在开发NodeJS/Express时TypeScript的最佳和最简单的配置。</p></blockquote><h2 id="0692" class="ly lz iq bd ma mb mc dn md me mf dp mg le mh mi mj li mk ml mm lm mn mo mp mq bi translated">编辑2019年6月</h2><p id="1156" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">如果你从零开始一个项目，有一个npm库可以为我们做所有这些，现在命名为<em class="lu">express-generator-typescript</em>。</p><div class="mw mx gp gr my mz"><a href="https://www.npmjs.com/package/express-generator-typescript" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">快速生成器类型脚本</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">生成类似于express-generate的新的Express应用程序，但是将其设置为使用TypeScript</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">www.npmjs.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn kp mz"/></div></div></a></div><p id="5e38" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本教程的所有源代码都可以在GitHub上找到。在阅读教程时，您应该观察相应的文件/文件夹。</p><div class="mw mx gp gr my mz"><a href="https://github.com/seanpmaxwell/ExpressTypeScript" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">seanpmaxwell/ExpressTypeScript</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">用TypeScript开发和表达JS webserver。通过创建……为seanpmaxwell/ExpressTypeScript开发做出贡献</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">github.com</p></div></div><div class="ni l"><div class="no l nk nl nm ni nn kp mz"/></div></div></a></div></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><h1 id="829c" class="nw lz iq bd ma nx ny nz md oa ob oc mg jw od jx mj jz oe ka mm kc of kd mp og bi translated">安装程序类型脚本</h1><p id="3f8b" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">在开发过程中，我们可以直接从我们创建的<code class="fe oh oi oj ok b">.ts</code>文件中运行我们的类型脚本代码。但是对于生产，我们应该将它们转换成JavaScript，这样我们的服务器就可以直接从NodeJS运行。为了配置我们的TypeScript如何被编译，并为我们的代码设置样式规则，我们需要分别创建<code class="fe oh oi oj ok b">tsconfig.json</code> <em class="lu"> </em>和<code class="fe oh oi oj ok b">tslint.json</code>文件。使用tslint不是必需的，但是对于执行编码标准来说非常方便，并且从长远来看会产生更干净的代码。</p><p id="3ce0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为您的项目创建一个新文件夹，并在根目录下添加包含以下内容的<code class="fe oh oi oj ok b">tsconfig.json</code>:</p><blockquote class="lr ls lt"><p id="005b" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">注意第23行的<code class="fe oh oi oj ok b">exclude</code>选项，显示<code class="fe oh oi oj ok b">/src/public/</code>。在本教程中，我们不打算讨论前端，但是一旦你开始添加一些前端内容，它应该就在那里了。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">tsconfig.json</figcaption></figure><p id="002f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在为<code class="fe oh oi oj ok b">tslint.json</code>文件添加以下代码。我倾向于使用推荐的设置，并做一些调整。如果你想的话，可以随意调整这些设置。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">tslint.json</figcaption></figure><p id="1f29" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了允许我们执行一些代码，让我们创建一个启动脚本来启动我们的服务器。因为我们还没有服务器，现在就让它打印出来<code class="fe oh oi oj ok b">"hello world"</code>。创建文件夹和文件<code class="fe oh oi oj ok b">src/start.ts</code>,并添加以下两行:</p><blockquote class="lr ls lt"><p id="e435" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">tslint被禁用是因为它敦促我们不要使用<code class="fe oh oi oj ok b">console.log()</code>，把它留在生产代码中也不好。</p></blockquote><pre class="kg kh ki kj gt on ok oo op aw oq bi"><span id="b919" class="ly lz iq ok b gy or os l ot ou">// tslint:disable-next-line<br/>console.log('hello world');</span></pre><p id="07d0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们修改代码时，我们不希望不得不手动重启一切，所以让我们使用<code class="fe oh oi oj ok b">nodemon</code>来观察文件中的变化，并重新执行我们的启动脚本。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="2b7a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">太好了！我们已经得到了在TypeScript中开始开发所需的一切，我们只需要安装依赖项。运行<code class="fe oh oi oj ok b">npm init</code>如果你还没有对你的npm包中的项目这样做，那么安装下面的npm库:</p><pre class="kg kh ki kj gt on ok oo op aw oq bi"><span id="c27e" class="ly lz iq ok b gy or os l ot ou">npm i -D ts-node nodemon typescript tslint</span></pre><p id="4ce8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，我们可以轻松地开始事情，而不必在每次想要开始开发时都在控制台中输入一堆长命令，让我们向<code class="fe oh oi oj ok b">package.json</code>添加一个脚本，以便使用<code class="fe oh oi oj ok b"> ts-node</code>通过nodemon运行启动脚本。</p><p id="11ab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请参见下面的第8行:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="4248" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">运行<code class="fe oh oi oj ok b">npm run start-dev</code>，您应该会看到<code class="fe oh oi oj ok b">hello world</code>输出到控制台。</p><h1 id="c984" class="nw lz iq bd ma nx ov nz md oa ow oc mg jw ox jx mj jz oy ka mm kc oz kd mp og bi translated">快速设置</h1><p id="4e12" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">既然TypeScript已经设置好并运行良好，让我们创建一个简单的ExpressJS服务器和几个路由。我们可以直接使用ExpressJS，但是这样我们就不能利用TypeScript了。用方法创建类，而不是一遍又一遍地键入<code class="fe oh oi oj ok b">let router = express.Router(), router.get/put/post, app.use(router)</code>之类的东西，这将会很好。</p><p id="dfb5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了更接近MVC模式并利用OO风格的编程，我推荐<code class="fe oh oi oj ok b">OvernightJS</code>添加控制器和路由装饰器来表达。是的，我知道你要说什么，<em class="lu">“难道没有像NestJS和ts-Express-decorator这样的框架可以装饰快捷路线吗？</em>“是的，这是真的，但是这些都是大型框架，整个网站都致力于它们的文档。Overnight只是一个简单的、小型的库集合，用于添加decorators来表达和做一些其他的事情。它不是Express之上的抽象层，如果你已经熟悉了Express，你可以在10分钟左右学会它。</p><div class="mw mx gp gr my mz"><a href="https://github.com/seanpmaxwell/overnight" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">seanpmaxwell/隔夜</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">ExpressJS服务器的TypeScript decorators。通过创建帐户为seanpmaxwell/隔夜开发做贡献…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">github.com</p></div></div><div class="ni l"><div class="pa l nk nl nm ni nn kp mz"/></div></div></a></div><p id="865a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们安装快速和过夜，并启动一个网络服务器:</p><blockquote class="lr ls lt"><p id="29e0" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><em class="iq"> body-parser </em>包是为了让我们能够以JSON的形式发送数据。</p></blockquote><ul class=""><li id="8e44" class="pb pc iq kx b ky kz lb lc le pd li pe lm pf lq pg ph pi pj bi translated"><code class="fe oh oi oj ok b">npm i -s express body-parser @overnightjs/core @overnightjs/logger</code></li><li id="8696" class="pb pc iq kx b ky pk lb pl le pm li pn lm po lq pg ph pi pj bi translated"><code class="fe oh oi oj ok b">npm i -D <a class="ae pp" href="http://twitter.com/types/node" rel="noopener ugc nofollow" target="_blank">@types/node</a> @types/express</code></li></ul><p id="976b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe oh oi oj ok b">src/</code>下，为服务器创建一个文件(我的名字是<code class="fe oh oi oj ok b">ExampleServer.ts</code>)并创建一个同名的类。然后添加另一个文件夹/文件<code class="fe oh oi oj ok b">controllers/ExampleController.ts</code>。我们将首先实现控制器，然后将其导入到我们的服务器文件中。</p><p id="a8b8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将以下内容添加到控制器文件中:</p><blockquote class="lr ls lt"><p id="4eb2" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">请注意，我们为每条路线创建了一个方法，只是为了查看每条路线的运行情况。<em class="iq"> Logger </em>类很方便，因为它可以被配置为打印到一个文件、控制台、完全关闭，或者根据您的服务器环境进行定制。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="20e5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当你使用完控制器后，确保添加一个<code class="fe oh oi oj ok b">index.ts</code>文件到<code class="fe oh oi oj ok b">controllers/</code><em class="lu"/>和<code class="fe oh oi oj ok b">export * from ‘./ExampleController’;</code>行，这样以后创建的任何新的控制器文件都可以通过额外的一行代码轻松添加。</p><p id="98e4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在服务器中，导入控制器并用隔夜的<code class="fe oh oi oj ok b">Server</code>导出来扩展类。通过扩展<code class="fe oh oi oj ok b">Server</code>，您将可以使用<code class="fe oh oi oj ok b">this.app</code>访问Express实例，您可以像使用<code class="fe oh oi oj ok b">require(‘express’)()</code>创建的任何普通Express实例一样与之交互。</p><p id="2515" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">控制器必须实例化并作为数组添加到<code class="fe oh oi oj ok b">super.addControllers(…)</code>中，以激活您的路线。确保在设置中间件之后、启动服务器之前添加控制器。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="20cb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们有了服务器和控制器，我们只需要从启动脚本启动一切。导入服务器，实例化它，调用<code class="fe oh oi oj ok b">start(portNumber)</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="d69c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦你看到<code class="fe oh oi oj ok b">"[someTimestamp]: Example server started on port: 3000"</code>打印到控制台，你可以打开一个你选择的API调用工具(如Postman)并向服务器发送请求。如果你完全按照我的例子做，你应该看到你的路线的<code class="fe oh oi oj ok b">:msg</code>部分打印到控制台上。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><h1 id="2342" class="nw lz iq bd ma nx ny nz md oa ob oc mg jw od jx mj jz oe ka mm kc of kd mp og bi translated">构建您的代码</h1><p id="65f5" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">既然我们已经有了一个全功能的开发服务器，我们需要做的就是为生产构建它。如果你在开发过程中删除了<code class="fe oh oi oj ok b">.ts</code>文件，你应该在每次传输文件时删除<code class="fe oh oi oj ok b">build/</code>文件夹，否则你会得到垃圾<code class="fe oh oi oj ok b">.js</code>文件。</p><p id="2a88" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要启动生产代码，我们需要运行<code class="fe oh oi oj ok b">build/start.js</code>而不是<code class="fe oh oi oj ok b">src/start.ts</code>。让我们给<code class="fe oh oi oj ok b">package.json</code>再添加两个脚本来构建和运行生产代码。</p><blockquote class="lr ls lt"><p id="c7ab" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><code class="fe oh oi oj ok b">tsc</code>命令转换我们的代码。请参见下面的第9行:</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="4d6d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦您的服务器启动，您的所有路由应该像以前一样工作。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="ef96" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你觉得这篇文章有帮助，请在GitHub上启动教程的repo和OvernightJS repo。祝网络设计愉快:)</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt mz"><a href="https://gitconnected.com/learn/typescript" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">学习TypeScript -最佳TypeScript教程(2019) | gitconnected</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">18大TypeScript教程-免费学习TypeScript。课程由开发人员提交并投票，从而实现…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">gitconnected.com</p></div></div><div class="ni l"><div class="pq l nk nl nm ni nn kp mz"/></div></div></a></div></div></div>    
</body>
</html>