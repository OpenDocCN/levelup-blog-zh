<html>
<head>
<title>How to extract tables from PDFs with Camelot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Camelot从pdf中提取表格</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-extract-tables-from-pdf-files-with-camelot-12ca6afd28dd?source=collection_archive---------4-----------------------#2020-08-13">https://levelup.gitconnected.com/how-to-extract-tables-from-pdf-files-with-camelot-12ca6afd28dd?source=collection_archive---------4-----------------------#2020-08-13</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="7e1d" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">数据科学</h2><div class=""/><div class=""><h2 id="fe21" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">使用Camelot库从Python中的PDF文件提取表格的快速指南</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/83858f5a9308d4507e040359ab9fc751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3ZnLYjnUQFD0KgxV"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">由<a class="ae li" href="https://unsplash.com/@mavrick" rel="noopener ugc nofollow" target="_blank"> Recardo Cruz </a>在<a class="ae li" href="https://unsplash.com/photos/P8LZaU52NME" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl lj lk hy ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="in io ip iq ir"><h1 id="4744" class="lq lr iu bd ls lt lu lv lw lx ly lz ma kj mb kk mc km md kn me kp mf kq mg mh bi translated">装置</h1><p id="6307" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">如果您使用的是Windows，请确保从这里的<a class="ae li" href="https://www.ghostscript.com/download/gsdnld.html" rel="noopener ugc nofollow" target="_blank">安装<code class="fe ne nf ng nh b">Ghostscrip</code>。在没有预先安装<code class="fe ne nf ng nh b">Ghostscript</code>的情况下，您仍然可以安装<code class="fe ne nf ng nh b">camelot </code>。但是我们在尝试使用<code class="fe ne nf ng nh b">camelot</code>时会遇到错误。</a></p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="f81e" class="nm lr iu nh b gz nn no l np nq">conda install -c conda-forge camelot-py</span></pre><p id="9730" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated">或者</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="e8c5" class="nm lr iu nh b gz nn no l np nq">pip install "camelot-py[cv]"</span></pre><p id="bd55" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated">或者</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="b581" class="nm lr iu nh b gz nn no l np nq">git clone <a class="ae li" href="https://www.github.com/camelot-dev/camelot" rel="noopener ugc nofollow" target="_blank">https://www.github.com/camelot-dev/camelot</a><br/>cd camelot<br/>pip install ".[cv]"</span></pre><h1 id="263c" class="lq lr iu bd ls lt nw lv lw lx nx lz ma kj ny kk mc km nz kn me kp oa kq mg mh bi translated">使用</h1><p id="6355" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">我们将首先导入<code class="fe ne nf ng nh b">camelot </code>，然后提供pdf文件的文件路径。<code class="fe ne nf ng nh b">read_pdf</code>带有许多我们可以探索的参数。用于以下示例的示例pdf位于<a class="ae li" href="https://trade.indiabulls.com/pdf/NSE_Holidays_Equity.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="745f" class="nm lr iu nh b gz nn no l np nq">import camelot<br/>tables = camelot.read_pdf('<a class="ae li" href="https://trade.indiabulls.com/pdf/NSE_Holidays_Equity.pdf'" rel="noopener ugc nofollow" target="_blank">https://trade.indiabulls.com/pdf/NSE_Holidays_Equity.pdf'</a>)</span></pre><p id="00af" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated"><strong class="mk je">表格数量:</strong>打印提取的表格数量。以上文章有2个表。</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="20b8" class="nm lr iu nh b gz nn no l np nq">tables.n<br/>&gt;&gt;&gt; 2</span></pre><p id="9baa" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated"><strong class="mk je">解析报告:</strong>运行下面的代码，获取每个表的解析报告。如果我们想查看每个表的报告，那么我们必须遍历所有的表。</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="426f" class="nm lr iu nh b gz nn no l np nq">print(tables[0].parsing_report)<br/>&gt;&gt;&gt; {'accuracy': 100.0, 'whitespace': 0.0, 'order': 1, 'page': 1}</span><span id="f27a" class="nm lr iu nh b gz ob no l np nq">for i in range(tables.n):<br/>    print(tables[i].parsing_report)<br/>&gt;&gt;&gt; {'accuracy': 100.0, 'whitespace': 0.0, 'order': 1, 'page': 1}<br/>&gt;&gt;&gt; {'accuracy': 100.0, 'whitespace': 0.0, 'order': 2, 'page': 1}</span></pre><p id="c905" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated"><strong class="mk je">表格形状:</strong>以下代码给出了提取的所有表格的形状。这里的形状指的是行数&amp;列数。</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="4324" class="nm lr iu nh b gz nn no l np nq">print(tables[0])<br/>&gt;&gt;&gt; &lt;Table shape=(13, 4)&gt;</span><span id="ddf2" class="nm lr iu nh b gz ob no l np nq">for i in range(tables.n):<br/>    print(tables[i])<br/>&gt;&gt;&gt; &lt;Table shape=(13, 4)&gt;<br/>&gt;&gt;&gt; &lt;Table shape=(8, 4)&gt;</span></pre><p id="e145" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated"><strong class="mk je">导出表格:</strong>我们可以将所有表格导出为CSV、Excel、JSON、HTML和SQLite格式。有关将表格导出为CSV格式的信息，请参见下面的示例。</p><p id="f7e1" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated">同样，我们可以用<code class="fe ne nf ng nh b">to_excel</code>、<code class="fe ne nf ng nh b">to_json</code>、<code class="fe ne nf ng nh b">to_html</code>、<code class="fe ne nf ng nh b">to_sqlite</code>。</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="0f58" class="nm lr iu nh b gz nn no l np nq">tables[0].to_csv(‘nse_holiday_list_table1.csv’)<br/>tables[1].to_csv(‘nse_holiday_list_table2.csv’)</span></pre><p id="29a8" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated"><strong class="mk je">转换成pandas DataFrame: </strong>我们可以将所有的表格导出到pandas DataFrame。代码<code class="fe ne nf ng nh b"><strong class="mk je">tables[0].df</strong></code>将把表格转换成DataFrame，但是从下面的截图中我们可以看到，标题显示不正确。我们需要纠正这一点，以便用正确的数据帧标题显示表格。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj oc"><img src="../Images/4b74414dc8afd0d97969764ea900898c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*YiES3RIvFbhBk_Xf_dXh_w.png"/></div></figure><p id="562f" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated">在做了下面的修改后，现在它看起来很完美，有了正确的DataFrame头。</p><pre class="kt ku kv kw gu ni nh nj nk aw nl bi"><span id="54b0" class="nm lr iu nh b gz nn no l np nq">temp_df = tables[0].df <br/>temp_df.rename(columns=temp_df.iloc[0]).drop(temp_df.index[0])</span></pre><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj od"><img src="../Images/90fbcbde584300c987806b2525b84ecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*v19gLf6qXriJrNw3PmT1yA.png"/></div></figure><p id="4cdd" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated">你可以在下面找到完整的代码-</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oe of l"/></div></figure><h2 id="6ae6" class="nm lr iu bd ls og oh dn lw oi oj dp ma mr ok ol mc mv om on me mz oo op mg ja bi translated">命令行界面</h2><p id="a78c" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated"><code class="fe ne nf ng nh b">Camelot</code>还提供CLI。可以通过<a class="ae li" href="https://camelot-py.readthedocs.io/en/master/user/cli.html" rel="noopener ugc nofollow" target="_blank">这个</a>链接获得CLI命令。</p><h2 id="9faa" class="nm lr iu bd ls og oh dn lw oi oj dp ma mr ok ol mc mv om on me mz oo op mg ja bi translated">网络界面</h2><p id="2168" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">这个神奇的库也有一个网络界面，叫做<code class="fe ne nf ng nh b"><a class="ae li" href="https://github.com/camelot-dev/excalibur" rel="noopener ugc nofollow" target="_blank"><strong class="mk je">Excalibur</strong></a></code>。</p><blockquote class="oq or os"><p id="8e60" class="mi mj ot mk b ml nr ke mn mo ns kh mq ou nt mt mu ov nu mx my ow nv nb nc nd in bi translated">听过<code class="fe ne nf ng nh b"><strong class="mk je">Camelot</strong></code> <strong class="mk je"> </strong> <code class="fe ne nf ng nh b"><strong class="mk je">&amp;</strong></code> <code class="fe ne nf ng nh b"><strong class="mk je">Excalibur</strong></code>这几个名字后我现在明白它为什么叫PDF表提取为<strong class="mk je"> <em class="iu">人类</em></strong>’:)希望你也能猜到！！</p></blockquote><p id="4ed8" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated">关于卡梅洛特的高级用法，请参考本。</p><h1 id="e3c5" class="lq lr iu bd ls lt nw lv lw lx nx lz ma kj ny kk mc km nz kn me kp oa kq mg mh bi translated">卡梅洛特的优势</h1><ul class=""><li id="074c" class="ox oy iu mk b ml mm mo mp mr oz mv pa mz pb nd pc pd pe pf bi translated">当通过参数的数量提取表时，Camelot提供了很大的灵活性。</li><li id="4e39" class="ox oy iu mk b ml pg mo ph mr pi mv pj mz pk nd pc pd pe pf bi translated">没有正确提取的表可以根据准确性和空白等指标被丢弃。这一点我们可以从解析报告方法中得到。</li><li id="2e30" class="ox oy iu mk b ml pg mo ph mr pi mv pj mz pk nd pc pd pe pf bi translated">每个表格都可以转换成pandas数据框架，用于进一步的分析和处理。</li><li id="0c2d" class="ox oy iu mk b ml pg mo ph mr pi mv pj mz pk nd pc pd pe pf bi translated">Camelot可以灵活地将表格导出为多种格式，如CSV、Excel、JSON、HTML和Sqlite。</li></ul><p id="a2c6" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated"><strong class="mk je">注意</strong> : <code class="fe ne nf ng nh b">Camelot</code>仅适用于基于文本的pdf，不适用于扫描文档。</p><h1 id="bfb4" class="lq lr iu bd ls lt nw lv lw lx nx lz ma kj ny kk mc km nz kn me kp oa kq mg mh bi translated">结论</h1><p id="10b9" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">我们知道<code class="fe ne nf ng nh b">camelot</code>库可以从PDF文件中提取表格，您可以在下一个项目中使用这些表格。</p><p id="294b" class="pw-post-body-paragraph mi mj iu mk b ml nr ke mn mo ns kh mq mr nt mt mu mv nu mx my mz nv nb nc nd in bi translated"><em class="ot">阅读更多关于Python和数据科学的此类有趣文章，</em> <a class="ae li" href="https://pythonsimplified.com/home/" rel="noopener ugc nofollow" target="_blank"> <strong class="mk je"> <em class="ot">订阅</em> </strong> </a> <em class="ot">到我的博客</em><a class="ae li" href="http://www.pythonsimplified.com/" rel="noopener ugc nofollow" target="_blank"><strong class="mk je"><em class="ot">www.pythonsimplified.com</em></strong></a><strong class="mk je"><em class="ot">。</em> </strong>你也可以在<a class="ae li" href="https://www.linkedin.com/in/chetanambi/" rel="noopener ugc nofollow" target="_blank"><strong class="mk je">LinkedIn</strong></a><strong class="mk je">上联系我。</strong></p></div><div class="ab cl lj lk hy ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="in io ip iq ir"><h1 id="cb5b" class="lq lr iu bd ls lt lu lv lw lx ly lz ma kj mb kk mc km md kn me kp mf kq mg mh bi translated">参考</h1><div class="pl pm gq gs pn po"><a href="https://github.com/camelot-dev/camelot" rel="noopener  ugc nofollow" target="_blank"><div class="pp ab fp"><div class="pq ab pr cl cj ps"><h2 class="bd je gz z fq pt fs ft pu fv fx jd bi translated">卡米洛特-德夫/卡米洛特</h2><div class="pv l"><h3 class="bd b gz z fq pt fs ft pu fv fx dk translated">Camelot是一个Python库，任何人都可以轻松地从PDF文件中提取表格！注意:您也可以检查…</h3></div><div class="pw l"><p class="bd b dl z fq pt fs ft pu fv fx dk translated">github.com</p></div></div><div class="px l"><div class="py l pz qa qb px qc lc po"/></div></div></a></div></div></div>    
</body>
</html>