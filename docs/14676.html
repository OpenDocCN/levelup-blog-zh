<html>
<head>
<title>From DynamoDB, ElasticCache, and OpenSearch to RavenDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从DynamoDB、ElasticCache、OpenSearch到RavenDB</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/from-dynamodb-elasticcache-and-opensearch-to-ravendb-7a462cd00b0?source=collection_archive---------4-----------------------#2022-12-16">https://levelup.gitconnected.com/from-dynamodb-elasticcache-and-opensearch-to-ravendb-7a462cd00b0?source=collection_archive---------4-----------------------#2022-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bfe6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何节省几千欧元，同时为开源做贡献</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/db177694ee3be016c1d7d7cf3b135499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ZgZ0YG7VdAAXdVjYCCT7g.jpeg"/></div></div></figure><p id="6c7b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">由软件架构师兼Elixer技术主管Ygor Castor撰写</em></p><p id="ee46" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">在云中扩展你的应用是一个挑战，尽管让你的服务按需扩展很简单。然而，我们经常忘记，如果你不注意使用，一些云解决方案真的会让你的预算大吃一惊，这就是AWS弹性数据库如DynamoDB、OpenSearch和ElasticCache的情况。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/1339cfc7e92b8db458282cc098665dae.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/1*URuG3sBYvpzf-95LoLZjwQ.gif"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated"><em class="lt">在创建DynamoDB索引时给比尔一个惊喜</em></figcaption></figure><h1 id="77a1" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">四个数据库，一个用例</h1><p id="1d7c" class="pw-post-body-paragraph kr ks iq kt b ku mm jr kw kx mn ju kz la mo lc ld le mp lg lh li mq lk ll lm ij bi translated">在我们的团队中，我们将这些不同的数据库用于非常具体的用例:</p><ul class=""><li id="c572" class="mr ms iq kt b ku kv kx ky la mt le mu li mv lm mw mx my mz bi translated">在Dynamo中，我们存储了用户的高分和谜题状态。</li><li id="98bd" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">在OpenSearch中，我们存储生产数据用于文本搜索。</li><li id="7a9e" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">在ElasticCache中，最常用的播放列表。</li><li id="5aed" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">关系数据的Postgres</li></ul><p id="fc23" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们已经在使用四个数据库，一个新的用例出现了。我们需要整合关系数据库中的数据，以提高API时间，这是索引或视图无法解决的问题。</p><p id="67a0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">数据很复杂，不是简单的键值，所以DynamoDB是不可能的。它不是基于文本的，所以有了OpenSearch我们需要持久化和查询数据，所以ElasticCache也不是一个选项。最终，我们需要另一个数据库。</p><p id="ff82" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是添加另一个数据库违背了我们的“简化”方法。这是另一个要维护的数据库、另一个备份和更多的管理时间。但是如果我们用一个新的代替一两个呢？</p><h1 id="bdfb" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">消除数据库</h1><p id="1883" class="pw-post-body-paragraph kr ks iq kt b ku mm jr kw kx mn ju kz la mo lc ld le mp lg lh li mq lk ll lm ij bi translated">首先，我们确定了想要丢弃的当前数据库，因此我们检查了DynamoDB，那里存储了我们的游戏状态。我们发现它不是我们用例的最佳数据库:它很贵，不支持特别查询，而且查询是一件非常头疼的事情。总而言之:一个很好的淘汰人选。</p><p id="7baa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后我们检查了我们的OpenSearch，在那里我们存储了成千上万个作品的文本数据。在我们的新用例中，我们需要这些数据，但不是以一种易于使用OpenSearch查询的方式，所以最好有一个支持全文搜索的数据库。</p><p id="5ca5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，我们希望有一个快速阅读缓存。这就是我们使用ElasticCache的原因，所以我们需要一个能提供超快的阅读速度的数据库。</p><p id="8a08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，我们需要一个速度极快的数据库，支持快速全文搜索，保证数据一致，易于实现，易于查询。我们如何解决这个难题？RavenDB为救援！</p><h1 id="bbe0" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">为RavenDB构建驱动程序</h1><p id="4960" class="pw-post-body-paragraph kr ks iq kt b ku mm jr kw kx mn ju kz la mo lc ld le mp lg lh li mq lk ll lm ij bi translated">RavenDB是一个多模型数据库，自其诞生之日起就支持无冲突复制数据类型和内置ACID。它提供了一种接近SQL的简单查询语言和全文搜索功能——看起来是一个不错的选择！但遗憾的是，它没有为我们☹️.服务的语言Elixir提供任何驱动程序但是我们不会轻易放弃。</p><p id="5d28" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过分析RavenDB文档，我们更加确定了在我们的用例中使用它的决定。所有与数据库的通信都可以通过一个记录良好的API来完成。我们最初的测试表明，在一个简单的t4g.medium EC2中，该数据库每秒钟可以容纳超过50，000个读取请求，这可以解决我们的问题！那么，为什么不构建我们自己的驱动程序，并为开源社区做出贡献呢？这就是我们所做的。我们甚至因此获得了<a class="ae nf" href="https://www.linkedin.com/pulse/ravendb-newsletter-may-2022-grafana-plugin-data-now-available-/" rel="noopener ugc nofollow" target="_blank">的好评</a>！</p><p id="c3f8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">随着新驱动程序的构建，我们实施了我们的数据库策略并逐步淘汰了三个(！idspnonenote)驱动程序。)数据库一气呵成。那么，它是如何整流罩了？我们的第一组数字非常有趣！</p><ul class=""><li id="e0da" class="mr ms iq kt b ku kv kx ky la mt le mu li mv lm mw mx my mz bi translated">我们的一个API达到了1~2秒到180毫秒的中间值！</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/809407ea5a2041f30f6b5d09a458126d.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*UGJ_KGeBK8h_ERct1n867Q.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated"><em class="lt">现在我们快了！</em></figcaption></figure><ul class=""><li id="36be" class="mr ms iq kt b ku kv kx ky la mt le mu li mv lm mw mx my mz bi translated">没有弹性数据库，我们的成本大幅下降！</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/52cf4adc83ec2ab73a6e6658cb0c86b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*o8gkjZwkWPyzxowHlDuwww.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated"><em class="lt">每月节省近2000欧元！</em></figcaption></figure><ul class=""><li id="446f" class="mr ms iq kt b ku kv kx ky la mt le mu li mv lm mw mx my mz bi translated">我们每秒钟有近1000个查询，使用了我们20%的容量，平均每个请求3毫秒！</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/3d5fd66db2280ba829bffb3c8976cbae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*rmMS5AXctrZkgB_Sp25CKQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/1d7dfc46cb5e4e0572f909d1567e6298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*oFfKrbwcMsZyPuZK3nGJlg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/4b876154c9bb43c5152ffc79c333499b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*77I-g6UJDjlzuZrEDvg8og.png"/></div></figure><p id="6141" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们对结果非常兴奋，也很想从你那里得到一些建议。把它们放在下面的评论里。</p></div></div>    
</body>
</html>