<html>
<head>
<title>The Difference Between Controlled and Uncontrolled Components in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中受控组件和非受控组件的区别</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-difference-between-controlled-and-uncontrolled-components-in-react-b76ac333db4d?source=collection_archive---------3-----------------------#2021-10-20">https://levelup.gitconnected.com/the-difference-between-controlled-and-uncontrolled-components-in-react-b76ac333db4d?source=collection_archive---------3-----------------------#2021-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2620" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么React文档推荐使用受控组件来实现表单？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/04d5b36c069b2a29d998ce230fd5472a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qbY3mMGGsZHcsKCm"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@florian_gagnepain?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Florian Gagnepain </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d670" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在React中处理表单数据时，可以使用受控组件，也可以使用非受控组件。根据React <a class="ae ky" href="https://reactjs.org/docs/uncontrolled-components.html" rel="noopener ugc nofollow" target="_blank">文档</a>，受控组件是大多数情况下的推荐方式。</p><blockquote class="lv"><p id="3b63" class="lw lx it bd ly lz ma mb mc md me lu dk translated">“在大多数情况下，我们建议使用<a class="ae ky" href="https://reactjs.org/docs/forms.html#controlled-components" rel="noopener ugc nofollow" target="_blank">受控组件</a>来实现表单。在受控组件中，表单数据由React组件处理。另一种选择是不受控制的组件，表单数据由DOM本身处理。</p></blockquote><p id="be80" class="pw-post-body-paragraph kz la it lb b lc mf ju le lf mg jx lh li mh lk ll lm mi lo lp lq mj ls lt lu im bi translated">如果你正在读这篇文章，但不知道什么是受控或不受控组件，不要担心！</p><p id="0d03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将了解React中的受控和非受控组件。到本文结束时，您应该已经理解了这两者之间的区别，以及为什么React文档建议在大多数情况下使用受控组件。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="3c1f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">非受控组件</h1><p id="189e" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">首先，让我们看看<a class="ae ky" href="https://reactjs.org/docs/uncontrolled-components.html" rel="noopener ugc nofollow" target="_blank">不受控制的组件</a>是什么样子的。</p><p id="bde9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不受控制的组件类似于传统的HTML表单输入元素。您可以通过访问对输入的引用来获取输入的值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="cacf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我有一个带有一个<code class="fe nq nr ns nt b">&lt;input&gt;</code>和一个<code class="fe nq nr ns nt b">&lt;button&gt;</code>的表单。在React中，如果我们想要引用一个DOM元素，我们可以使用<code class="fe nq nr ns nt b">useRef</code>钩子。<code class="fe nq nr ns nt b">useRef</code>钩子将创建一个具有保存该值的<code class="fe nq nr ns nt b">current</code>属性的对象。我们可以将这个引用设置为一个元素来访问这个值。</p><p id="5461" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，我将使用<code class="fe nq nr ns nt b">useRef</code>钩子创建一个引用。</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="d592" class="ny ms it nt b gy nz oa l ob oc">const inputRef = useRef(null);</span></pre><p id="7fd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我将把这个引用传递给<code class="fe nq nr ns nt b">&lt;input&gt;</code>元素。</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="96f3" class="ny ms it nt b gy nz oa l ob oc">&lt;input type="text" <strong class="nt iu">ref={inputRef}</strong> /&gt;</span></pre><p id="6b65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我提交表单时，我可以通过使用<code class="fe nq nr ns nt b">inputRef.current.value</code>获得输入的值。</p><p id="d787" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这被认为是不受控制的组件，因为输入的值不受React的控制。输入的值存储在元素的内部。我们直接从<code class="fe nq nr ns nt b">&lt;input&gt;</code>元素获取值。</p><h1 id="127b" class="mr ms it bd mt mu od mw mx my oe na nb jz of ka nd kc og kd nf kf oh kg nh ni bi translated">受控组件</h1><p id="0e6f" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">另一方面，我们有一个<a class="ae ky" href="https://reactjs.org/docs/forms.html#controlled-components" rel="noopener ugc nofollow" target="_blank">受控组件</a>。我们可以在React状态下存储值，而不是通过元素的引用来访问输入的值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="39d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样在这个例子中，我们有一个<code class="fe nq nr ns nt b">&lt;input&gt;</code>和一个<code class="fe nq nr ns nt b">&lt;button&gt;</code>。</p><p id="1816" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次，我们使用React中的<code class="fe nq nr ns nt b">useState</code>钩子来创建一个状态。</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="948d" class="ny ms it nt b gy nz oa l ob oc">const [inputText, setInputText] = useState(""):</span></pre><p id="bd1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们使用状态值<code class="fe nq nr ns nt b">inputText</code>，并将其添加为<code class="fe nq nr ns nt b">&lt;input&gt;</code>元素的值属性。我们可以通过更新<code class="fe nq nr ns nt b">inputText</code>状态来控制<code class="fe nq nr ns nt b">&lt;input&gt;</code>的值。</p><p id="6c20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了改变<code class="fe nq nr ns nt b">inputText</code>值，我们将像其他<code class="fe nq nr ns nt b">useState</code>钩子一样更新它。我们可以在每次击键时运行的<code class="fe nq nr ns nt b">&lt;input&gt;</code>元素中添加一个<code class="fe nq nr ns nt b">onChange</code>监听器。因此，只要用户键入一个字符，React状态就会更新，显示给用户的值也会更新。</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="a9b1" class="ny ms it nt b gy nz oa l ob oc">&lt;input<br/>  type="text"<br/>  <strong class="nt iu">value={inputText}<br/>  onChange={(e) =&gt; setInputText(e.target.value)}</strong><br/>/&gt;</span></pre><p id="318b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这被认为是一个受控组件，因为我们控制着<code class="fe nq nr ns nt b">&lt;input&gt;</code>的值，并且可以在React状态下访问它。这使得反应状态成为“真理的唯一来源”。</p><h1 id="2f94" class="mr ms it bd mt mu od mw mx my oe na nb jz of ka nd kc og kd nf kf oh kg nh ni bi translated">使用受控部件的好处</h1><p id="3349" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">与非受控组件相比，使用受控组件的一个主要优势在于:</p><p id="f024" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即时验证检查。</p><p id="f59e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用不受控制的组件时，您只能在提交表单时访问输入的值。然而，当使用受控组件时，我们总是可以访问该值。因此，很容易在每次击键时实现验证检查。</p><p id="a7b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我可以添加一个验证检查，要求输入值必须至少有8个字符长。我可以根据<code class="fe nq nr ns nt b">inputText</code>值的长度有条件地呈现文本。</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="8bc2" class="ny ms it nt b gy nz oa l ob oc">{inputText.length &gt;= 8 ? (<br/>  &lt;div&gt;OK&lt;/div&gt;<br/>) : (<br/>  &lt;div&gt;Must be at least 8 characters&lt;/div&gt;<br/>)}</span></pre><p id="454f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我也可以禁用按钮，直到输入值至少有8个字符长。</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="287d" class="ny ms it nt b gy nz oa l ob oc">&lt;button onClick={handleSubmit} <strong class="nt iu">disabled={inputText.length &lt; 8}</strong>&gt;<br/>  Submit<br/>&lt;/button&gt;</span></pre><p id="1fb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是添加验证的基本版本，但是您可以看到它是如何使用受控组件实现的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/63b89680a25434bb93c0fb5fc12a5583.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*U-qwd7IFc88WyFETIUKdvg.gif"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="f8d9" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="7669" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">感谢阅读！我希望这篇文章有助于您理解React中受控组件和非受控组件之间的区别。</p><p id="5928" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终，您可以使用受控或不受控的组件来处理React中的表单数据。但是，请记住，React文档建议在大多数情况下使用受控组件。</p><p id="8624" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在寻找一种更好的方法来处理表单数据和验证，请查看下面的文章，开始使用React Hook Form。</p><div class="oj ok gp gr ol om"><a href="https://blog.devgenius.io/the-easiest-way-to-deal-with-forms-in-react-ad6bc1250829" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">React中处理表单的最简单方法</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">使用React钩子形式来提高应用程序的性能</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">blog.devgenius.io</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ks om"/></div></div></a></div></div></div>    
</body>
</html>