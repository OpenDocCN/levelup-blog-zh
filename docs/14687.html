<html>
<head>
<title>Is your code safe and reliable? I will tell you how to figure this out.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的代码安全可靠吗？我会告诉你如何解决这个问题。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/is-your-code-safe-and-reliable-i-will-tell-you-how-to-figure-this-out-2c36923fecfe?source=collection_archive---------15-----------------------#2022-12-16">https://levelup.gitconnected.com/is-your-code-safe-and-reliable-i-will-tell-you-how-to-figure-this-out-2c36923fecfe?source=collection_archive---------15-----------------------#2022-12-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e24483ff60844e21756e5172a6fac803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-wsdINlNs7uZXZRy"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@homajob?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="e07f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">在寻找潜在的安全漏洞、错误和代码味道时，静态代码分析是一个强大的助手。我使用SonarQube进行了测试，SonarQube是一个流行的用于静态代码分析的开源工具，下面是您也可以这样做的方法。</em></p><h1 id="dcb1" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是静态代码分析？</h1><p id="a9ca" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">静态代码分析是这样一个过程，SonarCube这样的检查器检查源代码本身是否存在潜在的错误和陷阱。检查器在代码流中导航，并根据预定义的规则进行检查。</p><p id="1025" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">静态代码分析是构建稳定的测试金字塔的基础。有了静态代码分析，您甚至可以在为它编写测试之前就覆盖最常见的错误，只需让那些工具查看您的代码。</p><h1 id="ea78" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">为什么我应该执行静态代码分析？</h1><p id="c839" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">静态代码分析有助于确保代码的质量。这可能是在使用sonarLint或ESLint for JavaScript等Linters编写时，也可能是在特定时间执行的过程，就像运行单元测试一样。我喜欢在编写代码时使用简单的linters，如style cop和ESLint，并在合并特性之前运行更详细的分析。这将是我在下一节中描述的SonarCube的一个完美用例。</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mi"><img src="../Images/d36e1ad8f4f6e12281c3f6bf790f49f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8qVKfW4JUesvOqMt.png"/></div></div></figure><p id="bb9c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">进行静态代码分析将有助于您在黑客之前发现安全漏洞。</p><p id="824f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">静态代码分析可以通过分析您的代码及其执行流，帮助您在错误发生之前找到它们。例如，对于某些执行路径，这些值可能为空，从而触发异常。静态代码分析的另一个好处是，它可以帮助您识别代码的味道，使您的代码更具可读性，而重复代码会使维护变得更加困难。</p><h1 id="092f" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">SonarQube是什么？</h1><p id="1fd3" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">SonarCube是一个静态代码分析工具，支持24种以上的语言。它检查您的代码库，并告诉您潜在的陷阱和错误，这些陷阱和错误不会导致编译错误，但可能会在运行应用程序时导致错误。SonarQube还有一个由安全专家制作的巨大的潜在安全问题库，并内置了许多像Roslyn这样的代码质量检查器。</p><h1 id="b85e" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">我为什么要用SonarQube？</h1><p id="8e37" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">SonarCube和sonarLint可以帮助您在错误发生之前找到它们。SonarQube是一个开源程序，可以对你的代码进行静态分析。</p><p id="e889" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它可以在Docker映像中本地运行，也可以在您的配置项中托管。SonarQube为您提供了漂亮的仪表盘和报告，让您可以全面了解您的问题。他们会直接向您展示他们发现问题的代码、为什么会出现问题的描述，并给出修复问题的估计时间。</p><p id="4a61" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">sonar cube可用于分析24种以上不同的编程语言！</p><p id="169f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">JavaScript、C#、Java、Python等等，仅举几个例子，</p><p id="9632" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它可以帮助你提高你的编码技能。</p><p id="da73" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">SonarQube还支持OWASP Top 10，以查找并修复10个最常见的安全问题。因此，它可以帮助您在团队中没有安全专家的情况下发布更安全的应用程序。</p><h1 id="d40c" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">如何安装SonarQube</h1><p id="8f5a" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">要安装SonarQube，您有两种可能。</p><ol class=""><li id="fe70" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">下载压缩文件并在本地运行</li><li id="eaf5" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">在Docker内部运行我更喜欢第二种方式，因为Docker使得使用任何东西都更加容易，并且抽象出了与windows相关的问题，给了应用程序一个完美的运行环境。</li></ol><h1 id="b18b" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">安装sonarQube docker映像</h1><p id="1028" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">要获得sonarQube映像，只需在您喜欢的命令行中运行以下命令。</p><pre class="mj mk ml mm gt nb nc nd bn ne nf bi"><span id="a7e5" class="ng lg it nc b be nh ni l nj nk">docker pull sonarqube</span></pre><h1 id="d228" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">运行SonarQube docker映像</h1><p id="653e" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">要运行sonarQube docker映像，请运行以下命令:</p><pre class="mj mk ml mm gt nb nc nd bn ne nf bi"><span id="7a50" class="ng lg it nc b be nh ni l nj nk">docker run -d --name sonarqube -e SONAR_ES_BOOTSTRAP_CHECKS_DISABLE=true -p 9000:9000 sonarqube:latest</span></pre><p id="31d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后访问<a class="ae kf" href="http://localhost:9000." rel="noopener ugc nofollow" target="_blank"> http://localhost:9000。</a>确保等待几秒钟，直到前端出现。</p><h1 id="f8ae" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">如何建立一个SonarQube项目？</h1><p id="5f09" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">接下来，是关于导入您的项目。为了保持简单，我将从手动安装开始。我将为GitHub集成撰写自己的文章。要在您的应用程序上执行扫描，首先安装一个声纳扫描仪。向导将帮助您完成这项工作。一切都很简单。完成所有设置后，运行以下命令:</p><pre class="mj mk ml mm gt nb nc nd bn ne nf bi"><span id="6380" class="ng lg it nc b be nh ni l nj nk">dotnet sonarscanner begin /k:"&lt;yourProject&lt;" /d:sonar.host.url="http://localhost:9000"  /d:sonar.login="&lt;yourKey&gt;"<br/>dotnet build<br/>dotnet sonarscanner end /d:sonar.login="&lt;your key&gt;"</span></pre><p id="a12f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当一切都被执行后，你会发现自己在SonarQube仪表板。</p><h1 id="ab94" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">SonarQube仪表板</h1><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/bf40ec3a3d9e71a02a672d03c4ff0b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fWYf416j0qmKW1ik.png"/></div></div></figure><p id="f011" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">SonarQube完成后，在仪表盘上会显示一行。</p><p id="2b57" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我这样做是为了一个JavaScript项目(第一次)和我的。net API(秒)。</p><p id="2912" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在您的仪表板中，您可以清楚地看到sonarQube正在收集的数据。在下一章，我将更详细地介绍这些指标。</p><h1 id="427d" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">了解SonarQube指标</h1><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/6df7aa5d0b80aadbb1ac8c6efa6667e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cKBJIEdZKi2moCKL.png"/></div></div></figure><p id="d77d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当单击我们控制面板中的一个项目时，我们将进入其中一个项目，以进一步调查收集的数据。</p><h1 id="df78" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是bug？</h1><p id="3591" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">这个就挺自圆其说了:)。这个数字表示您的应用程序有多少潜在的错误。Bug是每一个可能导致问题的陷阱。</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/6780a0ce40e9935b6818616930396561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jiAF9afiEPLO_OvU.png"/></div></div></figure><p id="0e92" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，对于我的应用程序来说，这将是很多糟糕的评估，导致代码无法执行。当更深入地研究这个问题时，我发现所有这些都发生在重构一个特性的过程中，并且没有很好地完成这项工作。</p><p id="672f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我真正喜欢sonarQube的是，它总是解释为什么这是一个问题，所以他们对这里的问题有很好的解释，而不是仅仅说这是错误的。这样的解释也能让你成为更好的程序员。</p><p id="ff5b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我喜欢的另一件事是修复这个问题的估计时间。所有这些估计的时间加起来就是dev <strong class="ki iu">债务</strong>。</p><h1 id="7679" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是漏洞？</h1><p id="8f7b" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">SonarQube在您的代码中发现的安全问题的数量。</p><p id="20a5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，这可能是SQL注入、跨站点脚本编写的可能性，或者以不良方式存储的敏感cookies。要查看完整列表，请访问<a class="ae kf" href="https://docs.sonarqube.org/latest/user-guide/security-rules/" rel="noopener ugc nofollow" target="_blank">sonarquebes文档</a>。</p><h1 id="b9dd" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是SonarQubeSecurity热点？</h1><p id="5f04" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">sonarQube安全热点向您展示了哪些地方容易受到攻击。例如，他们会用禁用的请求大小限制来标记端点，因为这样你就是DDoS攻击的美丽目标！(所以不要那么做！).他们也标记愚蠢的(对不起，但它确实是愚蠢的)事情，如设置<strong class="ki iu">【CORS *</strong>标题。</p><h1 id="e530" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是SonarQube可维护性？</h1><p id="1b3f" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">可维护性表示不可读/错误的代码。这可能是使用了过时的语法，如下所示:</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/fc7e981828f776a7cc677173b11fcd3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cb37dPXW91oBzbWG.png"/></div></div></figure><p id="9039" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者其他罗斯林的问题。但是在使用罗斯林的时候也会发现。</p><p id="d21b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">SonarQube还检查非Roslyn问题，比如缺少分部方法的实现。</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/2055e44d9c6025fef19f65f80cd2d707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*O4uMlfZJz3ZSdXms.png"/></div></div></figure><h1 id="4f93" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">SonarQube的技术债是什么？</h1><p id="8596" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">技术债务度量是修复所有这些代码味道所花费的时间。</p><h1 id="d448" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">其他指标</h1><p id="2225" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">SonarQube还为您提供了其他有用的指标，如重复代码或测试覆盖率。</p><p id="dd49" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我只是没有设法获得C#的测试覆盖工作。如果你有，我很想在我的联系人栏里听到答案。</p><h1 id="8468" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="a184" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">SonarQube是一个执行静态代码分析的神奇工具。他们收集大量关于错误或代码味道的有用信息，并解释每一个问题，以使你成为更好的程序员，并提高你的代码质量。</p><p id="cce9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在docker中设置SonarQube是一种很好且简单的启动和运行方式，您可以轻松地将这个docker映像推送到AWS或Azure，使您的CI可以访问它。</p><p id="c525" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您还可以使用sonarLint作为IDE扩展，在编码时检查您的代码。</p><p id="7668" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总而言之，我肯定会推荐把静态代码分析作为QA的另一层，你的用户会感谢它的！</p><p id="1364" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望这篇文章能给你提供一些价值。</p><p id="2f55" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://www.the-koi.com/projects/static-code-analysis-with-sonarqube/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>最初发表在我的博客上。如果你想阅读更多这样的文章，你可以访问我的博客【https://www.the-koi.com/ T2】</p><p id="72f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">快乐分析，</p><p id="cb24" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">亚历克斯</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="6855" class="lf lg it bd lh li nw lk ll lm nx lo lp lq ny ls lt lu nz lw lx ly oa ma mb mc bi translated">参考</h1><p id="1b57" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated"><a class="ae kf" href="https://www.sonarqube.org/" rel="noopener ugc nofollow" target="_blank"> SonarCube文档</a></p><p id="a70a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://hub.docker.com/_/sonarqube" rel="noopener ugc nofollow" target="_blank"> SonarCube docker图像</a></p></div></div>    
</body>
</html>