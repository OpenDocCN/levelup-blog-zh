<html>
<head>
<title>11 Tips for Optimizing Web Application Performance (Network Section)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优化Web应用程序性能的11个技巧(网络部分)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/11-tips-for-optimizing-web-application-performance-network-section-c03968f4b744?source=collection_archive---------4-----------------------#2022-07-14">https://levelup.gitconnected.com/11-tips-for-optimizing-web-application-performance-network-section-c03968f4b744?source=collection_archive---------4-----------------------#2022-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f3ed" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">怎么做比较好？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/19af160d261b9ae9a47a2b3462334fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s1tGWTCXKNqV15E2"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Marc-Olivier Jodoin 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="7143" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">优化web应用程序的性能是一项麻烦的工作，因为其中涉及的知识很混乱。本文总结了一些可以在网络部分进行优化的技巧。</p><h1 id="33cf" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">1.DNS预取</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="22bd" class="ms lw it mo b gy mt mu l mv mw">&lt;head&gt;<br/>  &lt;link rel="dns-prefetch" href="<a class="ae ky" href="https://fonts.googleapis.com/" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/</a>" /&gt;<br/>&lt;/head&gt;</span></pre><p id="b60b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每当您的web应用程序引用跨来源域上的资源时，您应该将<code class="fe mx my mz mo b">dns-prefetch</code>提示放在<code class="fe mx my mz mo b">&lt;head&gt;</code>元素中。</p><p id="8c55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为当浏览器请求资源时，它会在发出请求之前将域名解析为IP地址。这个解析过程就是DNS解析。当您的应用程序引用许多不同的跨来源资源时，这会大大降低加载性能。而<code class="fe mx my mz mo b">dns-prefetch</code>可以帮助我们屏蔽DNS解析延迟。</p><p id="b0eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch#best_practices" rel="noopener ugc nofollow" target="_blank"> MDN </a>为我们描述了三种最佳实践:</p><ol class=""><li id="b0b3" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">仅用于跨域资源。这是因为当用户访问你的app时，你的网站背后的IP已经被解析了。</li><li id="56fd" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><code class="fe mx my mz mo b">dns-prefetch</code>(和其他资源提示)可以使用<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Link" rel="noopener ugc nofollow" target="_blank"> HTTP链接字段</a>指定为HTTP头。</li><li id="8aeb" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">考虑将<code class="fe mx my mz mo b">dns-prefetch</code>与<code class="fe mx my mz mo b">preconnect</code>提示配对。<code class="fe mx my mz mo b">preconnect</code>将帮助我们建立到服务器的连接，包括DNS解析、建立TCP连接、TLS握手(HTTPS)等。但是要小心，只为那些关键连接启用它，因为如果一个页面连接到许多第三方域，预先解析和连接它们可能会适得其反。</li></ol><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="68cf" class="ms lw it mo b gy mt mu l mv mw">&lt;link rel="preconnect" href="<a class="ae ky" href="https://fonts.googleapis.com/" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/</a>" <strong class="mo iu">crossorigin</strong> /&gt;<br/>&lt;link rel="dns-prefetch" href="<a class="ae ky" href="https://fonts.googleapis.com/" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/</a>" /&gt;</span></pre><p id="03f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些资源如字体是以匿名方式加载的。在这种情况下，您应该使用<code class="fe mx my mz mo b">preconnect</code>提示来设置<code class="fe mx my mz mo b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin" rel="noopener ugc nofollow" target="_blank">crossorigin</a></code>属性。如果忽略它，浏览器将只执行DNS查找。</p><h1 id="8daf" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">2.使用链接标签进行预处理</h1><p id="1e36" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">不仅仅是上面提到的<code class="fe mx my mz mo b">dns-prefetch</code>和<code class="fe mx my mz mo b">preconnect</code>，link标签还支持很多预处理情况:</p><h2 id="2fd3" class="ms lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated"><code class="fe mx my mz mo b">prefetch</code></h2><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="f663" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">&lt;!-- Pre-download and cache a resource, usually a non-critical resource. --&gt;<br/>&lt;!-- May be ignored when busy. --&gt;</strong><br/>&lt;link rel="prefetch" href="<a class="ae ky" href="https://www.example.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com</a>" /&gt;</span></pre><h2 id="d073" class="ms lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated"><code class="fe mx my mz mo b">preload</code></h2><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="b095" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">&lt;!-- Pre-download and cache a resource, usually for critical resources. --&gt;<br/>&lt;!-- Not ignored when busy. --&gt;</strong><br/>&lt;link rel="preload" href="<a class="ae ky" href="https://www.example.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com</a>" as="font" crossorigin /&gt;</span></pre><h2 id="88b7" class="ms lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated"><code class="fe mx my mz mo b">prerender</code></h2><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="c3a8" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">&lt;!-- Not only will the resources be downloaded, but also the execution page will be parsed and pre-rendered. --&gt;</strong><br/>&lt;link rel="prerender" href="<a class="ae ky" href="https://www.example.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com</a>" /&gt;</span></pre><h2 id="536f" class="ms lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated"><code class="fe mx my mz mo b">modulepreload</code></h2><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="f07b" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">&lt;!-- A JS module is preloaded, and it will not be executed after the download is completed. --&gt;</strong><br/>&lt;link rel="modulepreload" href="app.js"&gt;</span></pre><h1 id="bfa7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">3.脚本标记—异步和延迟</h1><p id="f7d3" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">script元素对于web应用程序非常重要，我们可以合理地使用script标签的async和defer属性来减少加载时间。我有一篇文章详述了:</p><div class="oe of gp gr og oh"><a rel="noopener  ugc nofollow" target="_blank" href="/html-script-element-attributes-async-vs-defer-vs-type-module-610b50a79dbd"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">HTML脚本元素属性:async vs. defer vs. type='module '</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">脚本元素如何影响页面加载？</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div><h1 id="7082" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">4.图像优化</h1><p id="fbad" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">如果你的应用程序大量使用图像或图标，优化图像加载可能是最有利可图的。</p><p id="7665" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">比如:用打包工具(比如Webpack)用base64内联小图；压缩图像；将多个图标文件集成到一个图像中；选择较好的图像格式，如WebP等。；使用SVG图标或使用字体图标；对不重要的图像使用延迟加载，等等。</p><h1 id="63a0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">5.加拿大</h1><p id="1493" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">CDN(内容交付网络)是分布在许多位置的一组服务器。这些服务器存储数据的副本，以便将服务器内容返回给最接近最终用户的用户。这对于高流量的情况来说是一个很好的缓冲。</p><p id="9192" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以可以合理利用CDN，比如在多个地方部署CDN服务器，地理距离会成比例影响延迟；我们还可以将这些静态资源放在CDN上，以减轻我们自己的服务器的请求负担等。</p><h1 id="fc91" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">6.请求域分割</h1><p id="b810" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">在浏览器中，来自同一来源的TCP连接的最大数量被限制为6。这意味着，如果同时发送6个以上的请求时使用HTTP1.1，第7个请求将等到前一个请求被处理后才开始。</p><p id="284e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们可以合理划分资源，拆分他们的域名。另外，结合上面提到的CDN，建议静态资源使用无cookie的域名。</p><h1 id="6a32" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">7.HTTP缓存</h1><p id="ccd8" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">使用HTTP缓存可以加快获取资源的速度，它可以分为强缓存和协商缓存。详情请看我的这篇文章:</p><div class="oe of gp gr og oh"><a href="https://blog.devgenius.io/web-application-performance-optimization-http-caching-791eeda4509e" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">Web应用程序性能优化— HTTP缓存</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">HTTP缓存的最佳实践是什么？</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">blog.devgenius.io</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov ks oh"/></div></div></a></div><p id="a9fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除此之外，我们还可以使用HTTP2支持的服务器端推送缓存。</p><h1 id="9b2d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">8.本地缓存</h1><p id="91df" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们可以将响应内容缓存在内存中，或者存储在本地。我们可以使用浏览器提供的存储API来完成所有这些工作。在下面的文章中，我将描述如何使用blobs来本地缓存资源:</p><div class="oe of gp gr og oh"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-use-blob-in-browser-to-cache-ee9577b77daa"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">如何在浏览器中使用Blob对象进行缓存</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">缓存可以大大提高应用程序的性能</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oq l"><div class="ox l os ot ou oq ov ks oh"/></div></div></a></div><h1 id="d4ec" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">9.避免重定向</h1><p id="d41f" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">及时清理资源，避免重定向，可以大大减少我们的请求时间。</p><h1 id="bc46" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">10.压缩</h1><p id="04aa" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们可以用<code class="fe mx my mz mo b">gzip</code>、<code class="fe mx my mz mo b">deflate</code>、<code class="fe mx my mz mo b">br</code>压缩。它们是相似的，存在于<code class="fe mx my mz mo b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding" rel="noopener ugc nofollow" target="_blank">content-encoding</a></code>响应头中。以<code class="fe mx my mz mo b">gzip</code>为例，一种用于文件压缩和解压缩的文件格式。这允许较小的文件进行更快的网络传输。并且在浏览器和web服务器中得到广泛支持。例如，下面是Nginx的一个简单配置:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="a275" class="ms lw it mo b gy mt mu l mv mw">gzip on;<br/>gzip_min_length 10k;<br/>gzip_types text/plain application/javascript text/css text/javascript;<br/>gzip_http_version 1.1;<br/>gzip_vary on;</span></pre><h1 id="d297" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">11.代码分割</h1><p id="09d3" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们可以利用打包工具的代码拆分来实现按需加载，比如动态导入就允许我们这么做。</p><h1 id="7510" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="adfc" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">希望今天的优化点能帮到你。如果有什么我没有提到的，请在评论里分享给我。</p></div><div class="ab cl oy oz hx pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="im in io ip iq"><p id="e042" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pf">感谢阅读。如果你喜欢这样的故事，想支持我，请考虑成为</em> <a class="ae ky" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="pf">中等会员</em> </a> <em class="pf">。每月5美元，你可以无限制地访问媒体内容。如果你通过</em> <a class="ae ky" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="pf">我的链接</em> </a> <em class="pf">报名，我会得到一点佣金。</em></p><p id="849e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的支持对我来说非常重要——谢谢。</p></div></div>    
</body>
</html>