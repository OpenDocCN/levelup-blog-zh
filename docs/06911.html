<html>
<head>
<title>How to Build a Dynamic GitHub Profile with GitHub Actions and PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用GitHub动作和PHP构建动态GitHub配置文件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-build-a-dynamic-github-profile-with-github-actions-and-php-5fbaf23cbf4f?source=collection_archive---------31-----------------------#2021-01-11">https://levelup.gitconnected.com/how-to-build-a-dynamic-github-profile-with-github-actions-and-php-5fbaf23cbf4f?source=collection_archive---------31-----------------------#2021-01-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="b89b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">去年，GitHub悄悄地发布了一个功能，很快引起了社区的注意——个人资料阅读</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/002bdc5e700bd51a95e45eff1cdac28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*piq6h9RrdO4y_OiP"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">马修·施瓦茨在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2959" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://docs.github.com/en/free-pro-team@latest/github/setting-up-and-managing-your-github-profile/managing-your-profile-readme" rel="noopener ugc nofollow" target="_blank">概要文件自述文件</a>是GitHub概要文件的一个全局<code class="fe lf lg lh li b">README</code>文件，您可以通过创建一个名称与您的GitHub用户名相同的公共存储库来设置它。例如，由于我的用户名是<code class="fe lf lg lh li b">osteel</code>，我创建了<code class="fe lf lg lh li b">osteel/osteel</code> <a class="ae le" href="https://github.com/osteel/osteel" rel="noopener ugc nofollow" target="_blank">存储库</a>。</p><p id="5600" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您添加自己的内容时，应该会出现一个像这样的小框:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/dc0cf45084c867d9bd69a3f5dcb2df32.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*cdU20yPRHGm7Idl0.png"/></div></figure><p id="642f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦创建了存储库，添加一个带有简短描述的<code class="fe lf lg lh li b">README</code>文件，解释你有多棒，你的GitHub个人资料页面将默认显示其内容:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lk"><img src="../Images/c733fd11760941d8d38916b81f0a23ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tnALI1u0XETNB9gw.png"/></div></div></figure><p id="4526" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">简洁明了。</p><p id="ff33" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我为了寻找灵感而浏览示例时，我偶然发现了西蒙·威廉森的版本，其中包含一些动态内容，如最近的工作和博客文章。他在一篇博客文章<a class="ae le" href="https://simonwillison.net/2020/Jul/10/self-updating-profile-readme/" rel="noopener ugc nofollow" target="_blank">中解释了他如何使用GitHub动作</a><a class="ae le" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank">和Python的组合来实现这一点，我决定用PHP做类似的事情。</a></p><h1 id="d360" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">占位符</h1><p id="9d2a" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated">首先要做的是在<code class="fe lf lg lh li b">README</code>文件中创建一个占位符，动态内容将放在那里。因为我想自动插入我博客的最新出版物，所以我使用了以下标签:</p><pre class="kp kq kr ks gt mo li mp mq aw mr bi"><span id="6660" class="ms lm it li b gy mt mu l mv mw">&lt;!-- posts --&gt;&lt;!-- /posts --&gt;</span></pre><p id="6313" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可能认识这种格式；由于Markdown文件也支持HTML，我使用了一些HTML评论标签来确保它们不会出现在我的个人资料页面上。</p><h1 id="0f72" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">PHP脚本</h1><p id="9162" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated">不记得上次写一些没有框架的PHP是什么时候了；结果，我不得不做一个<a class="ae le" href="https://www.frobiovox.com/posts/2016/08/16/basic-hello-world-with-composer-and-php.html" rel="noopener ugc nofollow" target="_blank">快速搜索</a>来开始一个基本的PHP脚本和一些Composer依赖项。</p><p id="b2c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">事实证明这很简单！第一步是使用以下命令初始化项目:</p><pre class="kp kq kr ks gt mo li mp mq aw mr bi"><span id="5e12" class="ms lm it li b gy mt mu l mv mw">$ composer init</span></pre><p id="97ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从那里，我安装了一个轻量级库<a class="ae le" href="https://github.com/dg/rss-php" rel="noopener ugc nofollow" target="_blank">来解析我博客的</a><a class="ae le" href="https://tech.osteel.me/feeds/rss.xml" rel="noopener ugc nofollow" target="_blank"> RSS提要</a>:</p><pre class="kp kq kr ks gt mo li mp mq aw mr bi"><span id="bd5e" class="ms lm it li b gy mt mu l mv mw">$ composer require dg/rss-php</span></pre><p id="5c31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我在项目的根目录下添加了一个<code class="fe lf lg lh li b">posts.php</code>文件，内容如下:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="3e08" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里没有什么太复杂的——顶部需要Composer的<em class="mz"> autoload </em>,允许我加载RSS解析器来生成Markdown格式的博客文章列表。</p><p id="3fb4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后将<code class="fe lf lg lh li b">README</code>文件的现有内容加载到<code class="fe lf lg lh li b">$content </code>变量中，并将Markdown字符串插入到带有<code class="fe lf lg lh li b">preg_replace</code>的<code class="fe lf lg lh li b">&lt;!-- posts --&gt;</code>和<code class="fe lf lg lh li b">&lt;!-- /posts --&gt;</code>标签之间。</p><p id="269f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，使用<code class="fe lf lg lh li b">file_put_contents</code>函数，用新内容替换文件的全部内容。</p><h1 id="1da9" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">GitHub行动</h1><p id="69d5" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated"><a class="ae le" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> GitHub Actions </a>是GitHub最近新增的功能，允许开发人员自动化各种CI/CD任务，比如运行测试套件或部署web服务。</p><p id="b1ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它们必须在项目根目录下的<code class="fe lf lg lh li b">.github/workflows</code>文件夹中使用YAML格式定义，并包含它们要执行的步骤列表。</p><p id="f805" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我的，我命名为<code class="fe lf lg lh li b">posts.yml</code>:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="de23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还是那句话，没什么太复杂的。我们首先给动作起一个名字，然后定义触发它的事件列表——将一些代码推送到存储库，从界面手动触发(<code class="fe lf lg lh li b">workflow_dispatch</code>)，或者像cron作业一样定期触发(这里是每天午夜)。</p><p id="becf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们指出该操作应该在Ubuntu映像上运行，它将:</p><ul class=""><li id="64e4" class="na nb it js b jt ju jx jy kb nc kf nd kj ne kn nf ng nh ni bi translated">克隆存储库；</li><li id="c085" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated"><a class="ae le" href="https://github.com/shivammathur/setup-php" rel="noopener ugc nofollow" target="_blank">安装PHP 7.4</a>；</li><li id="540a" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated">安装编写器依赖项；</li><li id="75e9" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated">运行PHP脚本；</li><li id="a979" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated"><a class="ae le" href="https://github.com/stefanzweifel/git-auto-commit-action" rel="noopener ugc nofollow" target="_blank">提交并推送变更</a>，如果有的话。</li></ul><p id="a88f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就是这样！我的GitHub档案现在会在我每次发表新文章时自动更新。</p><h1 id="442e" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="92a6" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated">这是一个旨在探索GitHub动作的快速实验，我希望将来会越来越多地使用它。以一种程序化的方式再次将PHP作为一种简单的脚本语言也很有趣。</p><p id="974a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了使这篇文章简短，我主动省略了一些东西——关于实现细节，请参考<a class="ae le" href="https://github.com/osteel/osteel" rel="noopener ugc nofollow" target="_blank">资源库</a>。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="91c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mz">这个故事最初发表于</em><a class="ae le" href="https://tech.osteel.me/posts/dynamic-github-profile-readme-with-github-actions-and-php" rel="noopener ugc nofollow" target="_blank"><em class="mz">tech . osteel . me</em></a><em class="mz">。</em></p><h1 id="e89c" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">资源</h1><ul class=""><li id="9cb6" class="na nb it js b jt mj jx mk kb nv kf nw kj nx kn nf ng nh ni bi translated"><a class="ae le" href="https://docs.github.com/en/free-pro-team@latest/github/setting-up-and-managing-your-github-profile/managing-your-profile-readme" rel="noopener ugc nofollow" target="_blank">管理您的个人资料自述文件</a></li><li id="5783" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated"><a class="ae le" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> GitHub动作</a></li><li id="2d05" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated"><a class="ae le" href="https://github.com/osteel/osteel" rel="noopener ugc nofollow" target="_blank">本文的知识库</a></li><li id="d9a3" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated"><a class="ae le" href="https://github.com/actions/checkout" rel="noopener ugc nofollow" target="_blank"> GitHub动作:结账V2 </a></li><li id="d477" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated"><a class="ae le" href="https://github.com/shivammathur/setup-php" rel="noopener ugc nofollow" target="_blank"> GitHub动作:设置PHP </a></li><li id="a263" class="na nb it js b jt nj jx nk kb nl kf nm kj nn kn nf ng nh ni bi translated">GitHub动作:Git自动提交</li></ul></div></div>    
</body>
</html>