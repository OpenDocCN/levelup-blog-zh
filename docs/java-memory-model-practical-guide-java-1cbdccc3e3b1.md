# Java å†…å­˜æ¨¡å‹:å®ç”¨æŒ‡å—

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/java-memory-model-practical-guide-java-1cbdccc3e3b1>

JVM çš„å®¶ä¼™ä»¬ï¼âœŒï¸:ä½ æƒ³äº†è§£æ›´å¤šå…³äº Java å†…å­˜æ¨¡å‹çš„çŸ¥è¯†(ä»è¿™é‡Œå¼€å§‹â€” **JMM** )å¹¶æŸ¥çœ‹å®ƒçš„å®ç”¨æŒ‡å—å—ï¼Ÿç„¶åæ·±å…¥ç ”ç©¶è¿™ç¯‡æ–‡ç« ğŸ˜ã€‚

> **å…è´£å£°æ˜:**æˆ‘å·²ç»æœç´¢äº†å¾ˆå¤šèµ„æºï¼Œåœ¨æ•´ç¯‡æ–‡ç« å’Œæ–‡ç« æœ«å°¾éƒ½å¯ä»¥æ‰¾åˆ°è¿™äº›èµ„æºçš„é“¾æ¥ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä¸æ˜¯å¸ƒè±æ©Â·æˆˆèŒ¨æˆ–é˜¿åˆ—å…‹è°¢Â·å¸Œçš®åˆ—å¤«é‚£æ ·çš„å¤§å¸ˆã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œå¶ç„¶å‘ç°é”™è¯¯æˆ–ä»€ä¹ˆçš„ï¼Œè¯·éšæ—¶å‘è¡¨è¯„è®ºæˆ–ç»™æˆ‘å‘ç”µå­é‚®ä»¶ã€‚

æ–‡ç« ç»“æ„ğŸ‘“ï¼š

*   ä»‹ç»
*   CS ç†è®º
*   å‡ºç‰ˆ
*   å†…å­˜æ¨¡å‹æ¦‚è¿°:å¼€å§‹
*   ç¡¬ä»¶å›¾ç‰‡
*   æ€»è®¢å•ä¸éƒ¨åˆ†è®¢å•
*   å†…å­˜æ¨¡å‹æ¦‚è¿°:è¯»å†™ç´ æ
    -æ˜“å¤±æ€§
    -åŒæ­¥
    -çº¿ç¨‹å¼€å§‹
    -æœ€ç»ˆ
*   æ›´å¤šå…³äº volatile
*   ç»“å°¾éƒ¨åˆ†

![](img/7742d7854254fcede782be42e8ab1392.png)

å¼ºå¤§è€Œå¯çˆ±çš„çˆªå“‡ğŸ‘»

## ä»‹ç»

è®¸å¤šäººä¼šå›é¿ JMM å’Œä¸å®ƒç›¸å…³çš„ä¸€åˆ‡ï¼Œå› ä¸ºåœ¨å„ç§æ–‡ç« ä¸­å¾ˆéš¾è§£é‡ŠğŸ˜¥ç„¶è€Œï¼Œå°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘ç ”ç©¶äº†å„ç§æ–‡ç« ã€ä¹¦ç±çš„ç« èŠ‚ã€è§†é¢‘ï¼Œå‘ç°â€¦â€¦ç†è§£èµ·æ¥éå¸¸å›°éš¾ï¼Œä½†å¦‚æœæˆ‘ä»¬ä»å®è·µè€…çš„è§’åº¦æ¥è¯´ï¼Œå¹¶éä¸å¯èƒ½ğŸ™Œã€‚ç”±äºå¯¹è¿™ä¸ªé—®é¢˜çš„å®é™…æ–¹é¢æ›´æ„Ÿå…´è¶£ï¼Œæˆ‘å†³å®šå¼ºè°ƒå®ƒï¼Œç„¶ååœ¨æœ¬æ–‡ä¸­çºªå¿µå®ƒï¼Œä»¥ä¾¿å…¶ä»–äººç†è§£å®ƒã€‚

## CS ç†è®º

é¦–å…ˆï¼Œå½“æˆ‘ä»¬è°ˆè®ºå¤„ç†å™¨å’Œä¸ä¹‹ç›¸å…³çš„ä¸€åˆ‡æ—¶ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬çš„ç”µè„‘ä¸­çš„æ ¸å¿ƒæ¦‚å¿µã€‚æˆ‘ä¸ä¼šåœ¨è¿™é‡Œæ·±å…¥è®¨è®ºç»†èŠ‚ï¼Œä½†æ˜¯ç»™å‡ºä¸€ä¸ªå¤§æ¦‚çš„æ¦‚è¿°ï¼Œè¿™å¯¹äºç°åœ¨æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚

æˆ‘åˆ›å»ºäº†ä¸€ä¸ªå›¾è¡¨ï¼Œéå¸¸ç®€å•æ˜äº†ğŸ¤¯ã€‚

![](img/b1cf43172cc6394b820915a8ed8bb1ff.png)

è¡¨ç¤ºæ•°æ®å’Œå¤„ç†å™¨ä¹‹é—´å…³ç³»çš„å›¾è¡¨

å› æ­¤ï¼Œå¤„ç†å™¨å°†æ•°æ®ä» RAM åŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚å®ƒä¸èƒ½ç›´æ¥å¯¹æ¥è‡ª RAM çš„æ•°æ®è¿›è¡Œæ“ä½œï¼Œå³ä½¿å¯ä»¥ï¼Œä¹Ÿå¤ªæ…¢äº†ã€‚å¤„ç†å™¨åšå‡ºæ›´æ”¹åï¼Œä¼šå°†å…¶å†™å› RAMã€‚å› æ­¤ï¼ŒJVM å°†é€šè¿‡ç»„åˆæˆ–è½¬æ¢å˜é‡æ¥ä¼˜åŒ–ä»£ç ã€‚åœ¨**å†…å­˜æ¨¡å‹æ¦‚è¿°**éƒ¨åˆ†æœ‰æ›´å¤šç›¸å…³ä¿¡æ¯ã€‚

ä½†æ˜¯ï¼Œå¦‚æœå¤šä¸ªå¤„ç†å™¨è·å–äº†åŒä¸€ä¸ªå˜é‡ï¼Œåœ¨æœ¬åœ°ç¼“å­˜ä¸­å¯¹å…¶è¿›è¡Œäº†æ›´æ”¹ï¼Œå¹¶éœ€è¦å°†å…¶å†™å›ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿå¯¹äºè¿™æ ·çš„é—®é¢˜ï¼Œæœ‰**ç¼“å­˜ä¸€è‡´æ€§**ã€‚

> å…±äº«å†…å­˜å¤šå¤„ç†å™¨ä½“ç³»ç»“æ„:æ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„ç¼“å­˜ï¼Œä¸ä¸»å†…å­˜ç›¸åè°ƒã€‚

æœ‰ 3 ç§ç±»å‹çš„**é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§** â¿:

*   ç«‹å³å†™å…¥
*   çœ‹åˆ°ä¸€ç³»åˆ—æ“ä½œæ•°
*   æ— ç²˜èšåŠ›çš„

é˜…è¯»ä¸‹é¢çš„æ–‡ç« ï¼Œäº†è§£æœ‰å…³é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§çš„æ›´å¤šä¿¡æ¯:

[](https://www.geeksforgeeks.org/cache-coherence/) [## ç¼“å­˜ä¸€è‡´æ€§- GeeksforGeeks

### å…ˆå†³æ¡ä»¶-é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ä¸€è‡´æ€§:åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œç›¸é‚»çš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ä¹‹é—´å¯èƒ½å‘ç”Ÿæ•°æ®ä¸ä¸€è‡´

www.geeksforgeeks.org](https://www.geeksforgeeks.org/cache-coherence/) 

â—ï¸ **è¯·ï¼Œéå¸¸ä»”ç»†åœ°è¯»å°è¯ç›´åˆ°ç”»é¢ã€‚æˆ‘ä¼šå‘Šè¯‰ä½ ä¸‹æ¥çº¿å›åˆ°è¿™é‡Œ** â—ï¸ **:**

å¤„ç†å™¨æ”¾æ¾å†…å­˜ä¸€è‡´æ€§=æé«˜æ€§èƒ½

å½“åœ¨å¤šä¸ªå¤„ç†å™¨ä¹‹é—´å…±äº«æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åè°ƒæ•°æ®:

*   æ¶æ„çš„å†…å­˜æ¨¡å‹æŒ‡å®šäº†*å†…å­˜å±éšœ/æ …æ *ä»¥åœ¨å…±äº«æ•°æ®æ—¶è·å¾—æ•°æ®åè°ƒ(JVM å‡å°‘äº†æˆ‘ä»¬å¯¹æ‰€æœ‰è¿™äº›ä¸œè¥¿çš„å…³å¿ƒï¼Œä½†æœ‰äº›æƒ…å†µå°†åœ¨**ç¡¬ä»¶å›¾ç‰‡**å—ä¸­æŸ¥çœ‹)
*   ***é¡ºåºä¸€è‡´æ€§*** â€”ç¨‹åºæ‰§è¡Œçš„å•ä¸€é¡ºåºã€‚æ¯æ¬¡è¯»å–éƒ½ä¼šçœ‹åˆ°æœ€åä¸€æ¬¡å†™å…¥ã€‚æ²¡æœ‰ä»€ä¹ˆ(ç”šè‡³ JMM)ä¸èƒ½ä¿è¯è¿™ä¸€ç‚¹ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¯•ç€ç”¨â€¦ **è¾¾åˆ°å®ƒçš„æŸäº›éƒ¨åˆ†ï¼Œé˜…è¯»ä¸‹ä¸€ä¸ªé¡¹ç›®ç¬¦å·**
*   å¦‚æœä¸ä½¿ç”¨*å†…å­˜å±éšœ* - >å…±äº«å†…å­˜å¤šå¤„ç†å™¨&ç¼–è¯‘å™¨å¯ä»¥åšå„ç§äº‹æƒ…ã€‚åœ¨ Java ä¸­æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨*å†…å­˜å±éšœ*ï¼Œè€Œæ˜¯è¯†åˆ«*å…±äº«çŠ¶æ€*å’Œ**æ æ†åŒæ­¥**ã€‚
*   ***æ’åº***â€”â€”æ“ä½œå¯èƒ½å»¶è¿Ÿæˆ–å‡ºç°æ— åºçš„æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸¤ä¸ªçº¿ç¨‹ï¼ŒJMM å¯ä»¥å…è®¸ä»¥ä¸åŒçš„é¡ºåºæ‰§è¡Œæ“ä½œ= >ä½¿ç”¨**åŒæ­¥**æ¥é˜²æ­¢ç¼–è¯‘å™¨ã€è¿è¡Œæ—¶ã€ç¡¬ä»¶å¯¹è¿å*å¯è§æ€§ä¿è¯*çš„æ“ä½œè¿›è¡Œé‡æ–°æ’åºã€‚

æˆ‘ä»¬å°†è¿›ä¸€æ­¥äº†è§£åŒæ­¥å…³é—­å™¨**å†…å­˜æ¨¡å‹æ¦‚è¿°:è¯»å†™å†…å®¹**

![](img/f0735bcbfcef352909ac12f926b3f387.png)

æ˜¾ç¤ºç¼“å­˜å…³ç³»çš„å›¾è¡¨

å¦‚æœä½ æƒ³æ·±å…¥äº†è§£ï¼Œè¯·é˜…è¯»ä¸‹é¢çš„æ–‡ç« :

[](https://www.geeksforgeeks.org/cache-memory-in-computer-organization/) [## è®¡ç®—æœºç»„ç»‡ä¸­çš„é«˜é€Ÿç¼“å­˜

### é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¶…é«˜é€Ÿå­˜å‚¨å™¨ã€‚å®ƒç”¨äºåŠ é€Ÿå’Œä¸é«˜é€Ÿ CPU åŒæ­¥ã€‚ç¼“å­˜â€¦

www.geeksforgeeks.org](https://www.geeksforgeeks.org/cache-memory-in-computer-organization/) 

## ğŸ› å‡ºç‰ˆç‰©

ä»€ä¹ˆæ˜¯å‡ºç‰ˆï¼Ÿè¿™æ˜¯ä¸€ä¸ªå…è®¸åœ¨å½“å‰èŒƒå›´ä¹‹å¤–è®¿é—®å¯¹è±¡çš„è¿‡ç¨‹ã€‚æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿè¯·åŠ¡å¿…è®°ä½ï¼Œå¦‚æœæ‚¨æ‰§è¡Œä»¥ä¸‹æ“ä½œ:

é‚£ä¹ˆå€¼`states`å·²ç»è¢«**è½¬ä¹‰**ã€‚è¿™æ„å‘³ç€ç”±äº`private`ä¿®é¥°ç¬¦ï¼Œå®ƒä¸åº”è¯¥åœ¨ç±»çš„èŒƒå›´ä¹‹å¤–ä½¿ç”¨ï¼Œä½†æ˜¯`public`æ–¹æ³•ä¿®é¥°ç¬¦å®Œæˆäº†å®ƒçš„è„å·¥ä½œã€‚æ‰€ä»¥ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹`states`å˜é‡ã€‚

> é˜…è¯»ç¬¬ 3.2 ç« *å‘å¸ƒå’Œè½¬ä¹‰***ã€ŠJava å¹¶å‘å®è·µã€‹ã€‚**

è®©æˆ‘ä»¬è¿›ä¸€æ­¥äº†è§£*å‡ºç‰ˆç‰©*:

è¯´åˆ°**ä¸å¯å˜å¯¹è±¡**ï¼Œæœ‰ç‰¹åˆ«çš„è¦æ±‚**(éƒ½å¿…é¡»å®Œæˆæ‰èƒ½è¾¾åˆ°çœŸæ­£çš„ä¸å¯å˜çŠ¶æ€)**:

*   ä¸å¯ä¿®æ”¹çš„çŠ¶æ€ã€‚é˜…è¯»æ­¤å¤„äº†è§£æ›´å¤šä¿¡æ¯:

[](https://www.geeksforgeeks.org/create-immutable-class-java/) [## å¦‚ä½•åœ¨ Java ä¸­åˆ›å»ºä¸å¯å˜ç±»ï¼Ÿ- GeeksforGeeks

### java ä¸­çš„ä¸å¯å˜ç±»æ„å‘³ç€ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºï¼Œæˆ‘ä»¬å°±ä¸èƒ½æ”¹å˜å®ƒçš„å†…å®¹ã€‚åœ¨ Java ä¸­ï¼Œæ‰€æœ‰çš„åŒ…è£…å™¨â€¦

www.geeksforgeeks.org](https://www.geeksforgeeks.org/create-immutable-class-java/) 

*   æ‰€æœ‰çš„é¢†åŸŸéƒ½æ˜¯`final`
*   å®‰å…¨åˆå§‹åŒ–ã€‚çœ‹çœ‹è¿™ä¸ª SO å¸–å­:

[](https://stackoverflow.com/a/11307418/16543524) [## è¯·è§£é‡Š Java å†…å­˜æ¨¡å‹ä¸­çš„åˆå§‹åŒ–å®‰å…¨

### åˆå§‹åŒ–å®‰å…¨æä¾›äº†ä¸€ä¸ªå¤–éƒ¨çº¿ç¨‹å¯ä»¥çœ‹åˆ°çš„å®Œå…¨æ„é€ (åˆå§‹åŒ–)çš„å¯¹è±¡â€¦

stackoverflow.com](https://stackoverflow.com/a/11307418/16543524) 

= >æˆ‘ä»¬å¯ä»¥åˆ›å»ºæ²¡æœ‰ä»»ä½•`synchronized`å…³é”®å­—çš„å¯¹è±¡ã€‚

ä½†æ˜¯ï¼Œæœ‰äº›äº‹æƒ…ä¼šç ´åå®‰å…¨åˆå§‹åŒ–ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨åŒæ­¥:â—ï¸

*   çŠ¶æ€æ˜¯é`final`
*   é™¤æ„é€ å‡½æ•°ä¹‹å¤–çš„ä»»ä½•æ–¹æ³•éƒ½ä¼šä¿®æ”¹å…¶å†…å®¹

= >å¦‚æœä½ å…è®¸å…¶ä»–çº¿ç¨‹(æˆ–è€…åªæ˜¯ç±»ä¹‹å¤–çš„èŒƒå›´)è®¿é—®é`final`å­—æ®µï¼Œä¸€å®šè¦ä½¿ç”¨åŒæ­¥ã€‚

*   ä¸€ä¸ªå¥½çš„åšæ³•æ˜¯è¿”å›å¯¹è±¡çš„æ·±å±‚å‰¯æœ¬ï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚æ­¤å¤–ï¼Œåœ¨è®¾ç½®æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªæ–°å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¸»æ„:

ç°åœ¨é’ˆå¯¹**å¯å˜å¯¹è±¡**ã€‚ä¸‹é¢å†™çš„å…¶ä¸­ä¸€ä¸ªä¸€å®šæ˜¯ accomplishedâ—ï¸:

*   ä»é™æ€åˆå§‹åŒ–å™¨åˆå§‹åŒ–å¯¹è±¡å¼•ç”¨:`public static Example ex = new Example(32);`
*   å°†å¯¹å¯¹è±¡çš„å¼•ç”¨å­˜å‚¨åœ¨`volatile`æˆ–`atomic`å­—æ®µå¼•ç”¨ä¸­
*   å°†å¯¹å¯¹è±¡çš„å¼•ç”¨å­˜å‚¨åˆ°ä¸€ä¸ª`final`å­—æ®µä¸­ï¼Œæˆ–è€…ç”¨é”æ¥ä¿æŠ¤å®ƒ

**ä½†æ˜¯ä¸ºä»€ä¹ˆè¦å¯¹åˆå§‹åŒ–ä¹‹ç±»çš„äº‹æƒ…å¤§æƒŠå°æ€ªå‘¢ï¼Ÿæˆ‘ä»¬å°†åœ¨** `**final**` **å­—æ®µè§£é‡Šä¸­æŸ¥çœ‹ã€‚**

å¦‚ä½•å®‰å…¨çš„åˆ†äº«å¯¹è±¡ï¼Ÿ

*   **çº¿ç¨‹å—é™:**å¯¹è±¡è¢«ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰ï¼Œå¹¶ä¸”è¢«å®ƒä¿®æ”¹
*   **å…±äº«åªè¯»:**å¯¹è±¡å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œä¸éœ€è¦é¢å¤–çš„åŒæ­¥ï¼Œä½†æ˜¯ä¸èƒ½è¢«ä»»ä½•çº¿ç¨‹ä¿®æ”¹ã€‚å®ƒé€‚ç”¨äºä¸å¯å˜çš„å’Œå®é™…ä¸Šä¸å¯å˜çš„å¯¹è±¡(æŠ€æœ¯ä¸Šä¸æ˜¯ä¸å¯å˜çš„ï¼Œä½†å®é™…ä¸Šæ˜¯ä¸å¯å˜çš„)
*   **å…±äº«çº¿ç¨‹å®‰å…¨:**å¯¹è±¡å†…éƒ¨æœ‰åŒæ­¥(å³`atomic`å˜é‡ã€‚æˆ‘ä»¬ç¨åå°†å›åˆ°ä»–ä»¬èº«ä¸Š)
*   **å—ä¿æŠ¤:**ç”±ç‰¹å®šé”ä¿æŠ¤çš„å¯¹è±¡(å³`synchronized)`

## å†…å­˜æ¨¡å‹æ¦‚è¿°ğŸ™ŒğŸ½

é¦–å…ˆï¼Œçœ‹å®Œæˆ‘çš„æ–‡ç« åï¼Œä¸€å®šè¦æŸ¥ä¸€ä¸‹ Oracle å…³äºå¹¶å‘çš„æ•™ç¨‹ã€‚å®ƒå¯èƒ½çœ‹èµ·æ¥å¾ˆé•¿ï¼Œä½†ç»å¯¹å€¼å¾—ä¸€è¯»:

 [## è¯¾ç¨‹:å¹¶å‘

### Java æ•™ç¨‹æ˜¯ä¸º JDK 8 ç¼–å†™çš„ã€‚æœ¬é¡µä¸­æè¿°çš„ç¤ºä¾‹å’Œå®è·µæ²¡æœ‰åˆ©ç”¨â€¦

docs.oracle.com](https://docs.oracle.com/javase/tutorial/essential/concurrency/index.html) 

åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„æ ¸å¿ƒæ¦‚å¿µï¼Œä»¥åŠä½ å¯ä»¥ä½¿ç”¨å“ªäº›å·¥å…·æ¥é˜²æ­¢è‡ªå·±çŠ¯ä¸‹ä¸¥é‡çš„é”™è¯¯ã€‚

ç¼–è¯‘å™¨å¯èƒ½ä¸æŒ‰ç…§ writtenâš™ï¸:çš„é¡ºåºæ‰§è¡Œä»£ç 

*   å¤„ç†å™¨å¯ä»¥å¹¶è¡Œæ‰§è¡ŒæŒ‡ä»¤(æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä¸Šé¢çš„ä¾‹å­)
*   ç¼“å­˜æ”¹å˜äº†å˜é‡å†™å…¥æäº¤åˆ°ä¸»å†…å­˜çš„é¡ºåº
*   æœ¬åœ°å¤„ç†å™¨ç¼“å­˜ä¸­çš„å˜é‡å¯èƒ½å¯¹å…¶ä»–å¤„ç†å™¨ç¼“å­˜ä¸å¯è§(å‘**ç¼“å­˜ä¸€è‡´æ€§**é—®å¥½)
*   å°†å˜é‡å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ï¼Œè€Œä¸æ˜¯å†…å­˜ä¸­(åŒæ ·ï¼Œä½ å¥½ **L1 ç¼“å­˜**

***çº¿ç¨‹å†… as-if-serial:*** å†™åœ¨é«˜çº§ç¨‹åºä¸­çš„æŒ‡ä»¤ï¼Œä¸ä¿è¯åœ¨ä½çº§ä¸­ä»¥ç›¸åŒçš„é¡ºåºè¿è¡Œã€‚ä½†æ˜¯ç»“æœæ˜¯ä¸€æ ·çš„ã€‚**å•çº¿ç¨‹ç¨‹åºä¸ºçœŸ**ã€‚å¯¹äºå¹¶å‘ç¨‹åºï¼Œ**ä¸ä¸ºçœŸ**ã€‚è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè®©æˆ‘ä»¬çœ‹å¾—æ›´è¿œ:

**æˆ‘ä»¬çš„ä»£ç æµç¨‹** ğŸª¢ **:**

1.  Java æºä»£ç 
2.  å°†å®ƒç¼–è¯‘æˆå­—èŠ‚ç 
3.  JVM ä¼˜åŒ–å­—èŠ‚ç (è½¬æ¢å®ƒç­‰ç­‰)ã€‚æˆ‘ä»¬ä»¥åä¼šçœ‹è¿™ä¸ªä¾‹å­ã€‚
4.  JVM ç”¨**è§£é‡Šå™¨**è§£é‡Šéƒ¨åˆ†ä»£ç ï¼Œå¹¶å€ŸåŠ© **JIT ç¼–è¯‘å™¨**å°†å­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç ã€‚

é˜…è¯»ä»¥ä¸‹æ–‡ç« äº†è§£æ›´å¤šä¿¡æ¯:

[](https://programmerbay.com/how-does-jvm-convert-bytecode-into-machine-code/) [## JVM å¦‚ä½•æŠŠå­—èŠ‚ç è½¬æ¢æˆæœºå™¨ç ï¼Ÿç¨‹åºå‘˜æµ·æ¹¾

### JVM å¦‚ä½•æŠŠå­—èŠ‚ç è½¬æ¢æˆæœºå™¨ç ï¼ŸJVM ( Java è™šæ‹Ÿæœº)æ¥æ”¶ç”Ÿæˆçš„å­—èŠ‚ç â€¦

programmerbay.com](https://programmerbay.com/how-does-jvm-convert-bytecode-into-machine-code/) 

æˆ‘ä¸Šé¢è°ˆåˆ°çš„è½¬å˜æ˜¯ä»€ä¹ˆï¼ŸJVM å¾ˆèªæ˜ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸åŒçš„åœ°æ–¹ä½¿ç”¨ç›¸åŒçš„å˜é‡æˆ–è€…ç±»ä¼¼çš„ä¸œè¥¿ï¼Œå®ƒå¯ä»¥å‘ç°ã€‚

**é¡ºåºä¸ä¸€è‡´**

è®©æˆ‘ä»¬å…ˆçœ‹çœ‹æˆ‘ä»¬æºä»£ç çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œç„¶åçœ‹çœ‹ä¼˜åŒ–ç‰ˆæœ¬:

å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬çš„ä»£ç è¢«ä¿®æ”¹äº†ã€‚ä½†å¬èµ·æ¥ä¸åƒæ˜¯åäº‹ï¼Œå¯¹å§ï¼Ÿå”‰ï¼Œå¦‚æœæˆ‘ä»¬è°ˆè®ºå•çº¿ç¨‹â€”â€”ä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬è°ˆè®ºå¤šçº¿ç¨‹å‘¢ï¼Ÿåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ‰è¿›é™·é˜±ï¼Œå¾—ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„ä»·å€¼ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è°ˆè®ºé«˜è´Ÿè½½æœåŠ¡ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

**æœ€ç»ˆä¸€è‡´æ€§**

è¿™ä¸æ˜¯å…³äº NoSQL æ•°æ®åº“ï¼Œè€Œæ˜¯ Javaã€‚æ˜¯çš„ï¼Œæˆ‘ä»¬çš„ä»£ç é‡Œæœ‰ä¸€äº›ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­:

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼ŒJVM ä¼˜åŒ–äº†éƒ¨åˆ†ä»£ç ï¼Œåœ¨è¿™äº›ä»£ç ä¸­ï¼Œå®ƒçœ‹ä¸åˆ°åœ¨*æ–¹æ³•*çš„ä½œç”¨åŸŸä¸­ä½¿ç”¨çš„å˜é‡(å°½ç®¡è¿™å¯èƒ½ä¸ä»…ä»…å‘ç”Ÿåœ¨æ–¹æ³•çš„ä½œç”¨åŸŸä¸­)ã€‚

ä¸ºäº†ç¡®ä¿æ²¡æœ‰ç±»ä¼¼çš„äº‹æƒ…å‘ç”Ÿï¼Œæˆ‘ä»¬éœ€è¦éµå¾ª ***å‘ç”Ÿâ€”â€”å…ˆäº*** çš„å’’è¯­ã€‚æˆ‘ä»¬å°†åœ¨**å†…å­˜æ¨¡å‹æ¦‚è¿°:è¯»å†™ææ–™**éƒ¨åˆ†ä¸­æŸ¥çœ‹å®ƒã€‚

## ç¡¬ä»¶å›¾ç‰‡ğŸ¦¾

è™½ç„¶ JVM è®©æˆ‘ä»¬ä¸ç”¨è€ƒè™‘æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿è¡Œåœ¨ä»€ä¹ˆæ¶æ„ä¸Šï¼Œå°±åƒæˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘ L1 ç¼“å­˜æˆ–ä»»ä½•ä¸ä¹‹ç›¸å…³çš„ä¸œè¥¿ï¼Œä½†æˆ‘ä»¬ä»ç„¶éœ€è¦è®°ä½æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿è¡Œåœ¨ä»€ä¹ˆæ¶æ„ä¸Šã€‚

çœ‹ä¸‹è¡¨ã€‚ARM å’Œ x86 æ˜¯ä¸¤ç§ä¸åŒçš„æ¶æ„ã€‚å®ƒå±•ç¤ºäº†**å„ç§ç³»ç»Ÿå¦‚ä½•ä¼˜åŒ–æ“ä½œ**(æˆ–è€…æ ¹æœ¬ä¸ä¼˜åŒ–)ã€‚

*   è´Ÿè½½==è¯»å–
*   å­˜å‚¨==å†™å…¥

![](img/2d99442db44fdc235623b89358aa0a0a.png)

å› æ­¤ï¼Œåœ¨ X86 ä¸Šæµç•…è¿è¡Œçš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šåœ¨ ARM ä¸Šå‡ºç°é—®é¢˜ã€‚

## æ€»è®¢å•ä¸éƒ¨åˆ†è®¢å•

æˆ‘ä¸æ˜¯ç»™ä½ æ•°å­¦å…¬å¼çš„æ•°å­¦ä¸“å®¶ï¼Œè€Œæ˜¯å¯¹é—®é¢˜çš„å®é™…æ–¹é¢æ›´æ„Ÿå…´è¶£çš„å·¥ç¨‹å¸ˆã€‚æˆ‘å°†å‘æ‚¨æ¦‚è¿°è¿™ä¸¤ä¸ªä¸œè¥¿ï¼Œå¹¶è¿›ä¸€æ­¥å‘æ‚¨å±•ç¤ºå®ƒä»¬çš„ç”¨é€”ã€‚

**æ€»é¡ºåº:**å°äºâ€”â€”*é›†åˆ()*ä¸­çš„ä»»ä½•æ•°å­—éƒ½å¯ä»¥ä¸ä¹‹ç›¸å…³

**ååº:**å¯é™¤æ•°â€”â€”ä¸èƒ½åº”ç”¨ä»»ä½•æ•°å­—

> çº¿ç¨‹ç¨‹åºâ€”éƒ¨åˆ†è®¢å•ï¼Œè€Œä¸²è¡Œç¨‹åºâ€”å…¨éƒ¨è®¢å•

çœ‹çœ‹è¿™ä¸ª SO å¸–å­ï¼Œè·å¾—æ›´å¤šçš„å­¦æœ¯è§£é‡Š:

[](https://stackoverflow.com/a/59909382/16543524) [## â€œåŒæ­¥æ“ä½œæ˜¯å®Œå…¨æœ‰åºçš„â€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

### åˆ†æâ€œåŒæ­¥åŠ¨ä½œæ˜¯å®Œå…¨æœ‰åºçš„â€è¿™å¥è¯:â€œåŒæ­¥åŠ¨ä½œâ€æ˜¯ä¸€ç»„ç¨‹åºâ€¦

stackoverflow.com](https://stackoverflow.com/a/59909382/16543524) 

JMM å®šä¹‰äº†**ååº** â€” ***å‘ç”Ÿåœ¨*** ä¹‹å‰(åœ¨ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬ä¼šæ›´ä»”ç»†åœ°ç ”ç©¶å®ƒ)ã€‚æ²¡æœ‰å®ƒâ€”â€”JVM å¯ä»¥éšæ„é‡æ–°æ’åºã€‚æ²¡æœ‰ ***æ•°æ®ç«äº‰*** â€”å³ 2 ä¸ªçº¿ç¨‹è¯»å–ï¼Œ1 ä¸ªçº¿ç¨‹å†™å…¥ã€‚

> **æ•°æ®ç«äº‰** â€”ç§°ä¸º**ç«äº‰æ¡ä»¶**(æˆ–**èºçº¹å¹²æ¶‰**)ã€‚å½“ 2 ä¸ªä»¥ä¸Šçš„çº¿ç¨‹è¯»/å†™åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œç»“æœå˜é‡å€¼å˜å¾—æ··ä¹±(å›æƒ³ä¸€ä¸‹æˆ‘è°ˆåˆ°ç¼“å­˜çš„ç¬¬ä¸€éƒ¨åˆ†)
> 
> æ­£ç¡®åŒæ­¥çš„ç¨‹åºè¡¨ç°å‡º*é¡ºåºä¸€è‡´æ€§*ã€‚
> 
> åŒæ­¥åŠ¨ä½œâ€” `lock`è·å–å’Œé‡Šæ”¾ï¼Œ`volatile`å˜é‡çš„è¯»å–å’Œå†™å…¥è¢«**å®Œå…¨æ’åº**

## å†…å­˜æ¨¡å‹æ¦‚è¿°:è¯»å†™ stuffğŸ–ŠğŸ“ƒ

Java ä¸­æœ‰ä¸€äº›ç‰¹æ®Šçš„è¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘Šè¯‰ JVM åœ¨æŸäº›é—®é¢˜å¯èƒ½å‘ç”Ÿæ—¶ä¸è¦è¿›è¡Œä¼˜åŒ–ã€‚Ta-dam:å¼•å…¥å¼•å…¥æ€»è®¢å•çš„é™„åŠ **åŒæ­¥åŠ¨ä½œ**ã€‚å¦‚æœæ²¡æœ‰è¿™æ ·çš„å…³é”®å­—ï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®ç«äº‰(å¼±è®°å¿†æ¨¡å‹)ã€‚

**åŒæ­¥åŠ¨ä½œ**ä»£è¡¨ä»€ä¹ˆï¼Œæœ‰å“ªäº›å…³é”®è¯ï¼Ÿ**çœ‹ä¸‹é¢:**

**å­—æ®µèŒƒå›´:** `final`ï¼Œ`volatile`

**æ–¹æ³•ä½œç”¨åŸŸ:** `synchronized`ï¼Œ`java.util.concurrent.*`

> è¯·æ³¨æ„ï¼Œåƒ`volatile`ã€`synchronized`è¿™æ ·çš„è¯ä¼šé™ä½æ€§èƒ½ã€‚æ˜æ™ºåœ°åº”ç”¨å®ƒä»¬

ç°åœ¨ï¼Œå›æ¥é‡è¯»ä»¥*â€œå¤„ç†å™¨æ”¾æ¾å†…å­˜â€¦â€¦â€*å¼€å¤´çš„å•è¯ã€‚

> è®°ä½ï¼ŒJMM è½¬æ¢ä»£ç æ¥ä¼˜åŒ–å®ƒã€‚å¹¶ä¸”å¯èƒ½å­˜åœ¨å¹³å°å·®å¼‚ã€‚

å…¶å®ï¼Œ ***æ˜¯æ€ä¹ˆå›äº‹â€”â€”ä¹‹å‰*** æ–‡ç« ä¸­å¤šæ¬¡æåˆ°ï¼Ÿ

> **å‘ç”Ÿåœ¨**ä¹‹å‰â€”â€”å®šä¹‰**ä¸€ä¸ªå­—æ®µ**çš„å†™å’Œè¯»æ“ä½œä¹‹é—´é¡ºåºçš„è§„åˆ™ã€‚å¦‚æœè¿™æ ·çš„è§„åˆ™é€‚ç”¨ï¼ŒJMM ä¿è¯è¿”å›ç‰¹å®šçš„/æ­£ç¡®çš„å€¼(æ²¡æœ‰å†…å­˜ä¸ä¸€è‡´çš„é—®é¢˜)

*   çº¿ç¨‹çœ‹åˆ°ç”±å®ƒ/å¦ä¸€ä¸ªçº¿ç¨‹å†™å…¥çš„å®é™…æ•°æ®
*   åªæœ‰åœ¨è¿™ä¸ª/å¦ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾äº†å¯¹è±¡ä¸Šçš„ç›‘è§†å™¨é”ä¹‹åï¼Œæ‰èƒ½è·å–è¯¥å¯¹è±¡ä¸Šçš„ç›‘è§†å™¨é”

å—¯ï¼Ÿç›‘è§†å™¨é”å®šï¼Ÿå®é™…ä¸Šï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰é”ï¼Œå®ƒä¼šå‘Šè¯‰å…¶ä»–çº¿ç¨‹è¿™ä¸ªå¯¹è±¡æ˜¯å¦ç©ºé—²ã€‚

é˜…è¯»ä»¥ä¸‹æ–‡ç« äº†è§£æ›´å¤šä¿¡æ¯:

[](https://howtodoinjava.com/java/multi-threading/multithreading-difference-between-lock-and-monitor/) [## é”å’Œç›‘è§†å™¨çš„åŒºåˆ«â€”â€”Java å¹¶å‘æ€§

### ä½ å¯èƒ½åœ¨é¢è¯•ä¸­é¢å¯¹è¿‡è¿™ä¸ªé—®é¢˜ï¼Œé”å’Œæ˜¾ç¤ºå™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå—¯ï¼Œä¸ºäº†â€¦

howtodoinjava.com](https://howtodoinjava.com/java/multi-threading/multithreading-difference-between-lock-and-monitor/) 

> åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹åšè‡ªå·±çš„äº‹æƒ…ã€‚å¦‚æœä¸éœ€è¦çš„è¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦è®©å®ƒä»¬äº’ç›¸åè°ƒï¼Œå› ä¸ºè¿™ä¼šæ˜¾è‘—é™ä½åº”ç”¨ç¨‹åºçš„é€Ÿåº¦ã€‚åªæœ‰åœ¨å…±äº«æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‰éœ€è¦é€šè¿‡ä½¿ç”¨**åŒæ­¥**æ¥åè°ƒçº¿ç¨‹
> 
> æ³¨æ„:**å¤„ç†å™¨**æœ‰ç¼“å­˜ï¼Œä½†æ˜¯**çº¿ç¨‹**æ²¡æœ‰

**æ˜“å˜**

æ‰€æœ‰å†™åœ¨`volatile`ä¹‹å‰çš„å˜é‡éƒ½è¢«æŒä¹…åŒ–ã€‚`volatile`ä¹‹åçš„æ‰€æœ‰è¯»æ•°éƒ½æ˜¯æœ€æ–°çš„ã€‚è¿™æ˜¯ä¸€ä¸ªè‘—åçš„**å‘ç”Ÿåœ¨**ä¹‹å‰çš„é¡ºåºã€‚

**åŒæ­¥é¡ºåº** â€”å†™å…¥å’Œè¯»å–ä¹‹é—´ã€‚

ç”¨**æœ€ç»ˆä¸€è‡´æ€§(ï¼ï¼ï¼ä»ä¸Šé¢å›å¿†ä¸€ä¸‹ï¼ï¼ï¼)** â€”çº¿ç¨‹åœ¨å†™å…¥æ˜“å¤±æ€§å­—æ®µæ—¶ï¼Œå°†æ‰€æœ‰æ•°æ®ä»ç¼“å­˜åˆ·æ–°åˆ°ä¸»å­˜å‚¨å™¨ã€‚è¯»å–æ˜“å¤±æ€§å­—æ®µçš„çº¿ç¨‹ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä½†é¡ºåºç›¸åã€‚

çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚æ— æŒ¥å‘ç‰©

ä¸ºä»€ä¹ˆ`volatile`ä¼šè¥æ•‘æˆ‘ä»¬ï¼Ÿå¦‚æœåº”ç”¨äº`ready`å­—æ®µï¼Œæˆ‘ä»¬å°†:

*   å‚è§`threadOne()`ä¸­çš„`ready`ï¼Œè¯»å–å®ƒï¼Œæ›´æ–°å€¼(å½“`volatile`åŸŸè¢«è¯»å–æ—¶ï¼Œæ‰€æœ‰æ•°æ®ä»ç¼“å­˜ä¸­åˆ·æ–°)
*   åœ¨`threadTwo()`ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå†™å…¥éæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼Œç„¶åå†™å…¥`volatile`ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå°†æ‰€æœ‰æ•°æ®ä»ç¼“å­˜ä¸­åˆ·æ–°åˆ°å†…å­˜ä¸­ã€‚

![](img/5032e5ba5570b16de685f52db7c00a3e.png)

**å› æ­¤ï¼Œå…ˆå†™å…¥éæ˜“å¤±æ€§ï¼Œç„¶åå†™å…¥æ˜“å¤±æ€§ï¼Œå†ä»æ˜“å¤±æ€§è¯»å–éæ˜“å¤±æ€§**

> å¦‚æœåº”ç”¨äºç›¸åŒçš„é¢†åŸŸï¼Œä»¥å‰å‘ç”Ÿçš„æƒ…å†µå°†ä¼šå‘ç”Ÿ

ä¸è¦å¿˜è®°æ€§èƒ½:

> æ˜“å¤±æ€§å­—æ®µæ»¥ç”¨é—®é¢˜â€”é™ä½å¤„ç†å™¨é€Ÿåº¦

ç„¶è€Œï¼Œå¦‚æœä½ åˆ›å»ºä¸€ä¸ªæ•°ç»„`volatile`ï¼Œå®ƒä¸ä¼šåœ¨æ•°ç»„`volatile`ä¸­åˆ›å»ºå˜é‡ã€‚è¿™æ˜¯å¾ˆå¤šäººéƒ½ä¼šçŠ¯çš„ä¸€ä¸ªå¸¸è§é”™è¯¯ã€‚ä½¿ç”¨åƒ`AtomicIntegerArray`è¿™æ ·çš„`atomic`å˜é‡ã€‚æ£€æŸ¥:

 [## åŸå­è®¿é—®

### åœ¨ç¼–ç¨‹ä¸­ï¼ŒåŸå­åŠ¨ä½œæ˜¯ä¸€æ¬¡æœ‰æ•ˆå‘ç”Ÿçš„åŠ¨ä½œã€‚åŸå­åŠ¨ä½œä¸èƒ½åœæ­¢åœ¨â€¦

docs.oracle.com](https://docs.oracle.com/javase/tutorial/essential/concurrency/atomic.html) 

**åŒæ­¥(ä¹Ÿç§°ä¸ºäº’æ–¥)**

åªéœ€å°†`synchronized`æ·»åŠ åˆ°æ–¹æ³•æˆ–ä»£ç å—ä¸­

**ï¼ï¼åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹å¿…é¡»é¦–å…ˆè·å¾—é”ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´æ­»é”ï¼ï¼**

è¯·çœ‹ä¸‹é¢çš„ä¾‹å­:

å®ƒä¹Ÿæ˜¯æœ‰ç§©åºçš„(æˆ‘ä¼šåœ¨å›¾ç‰‡ä¸Šå±•ç¤º)ã€‚å¹¶ä¸”å½“é€€å‡ºè¯¥å—æ—¶ï¼Œé«˜é€Ÿç¼“å­˜è¿˜å°†æ•°æ®åˆ·æ–°åˆ°ä¸»å­˜å‚¨å™¨ã€‚

æ•°æ®çš„ç›¸åŒè§„åˆ™:ä»…é€‚ç”¨äºç›¸åŒçš„å­—æ®µã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯åŒä¸€ç›‘è§†å™¨ä¸Šå…·æœ‰è§£é”-é”å®šå…³ç³»çš„ä¸¤ä¸ªçº¿ç¨‹ã€‚

å³ä½¿å˜é‡åœ¨ synchronized å—**ä¸­é‡æ–°æ’åºï¼Œå®ƒä»¬ä»ç„¶åœ¨ä¸€ä¸ªå—**ä¸­ã€‚æ‰€ä»¥ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸ä¼šä¸­æ–­ã€‚å› æ­¤ï¼Œå®ƒä¹Ÿè§£å†³äº†å‰é¢æè¿°çš„é‡æ–°æ’åºé—®é¢˜ã€‚

å®ƒä¹Ÿæœ‰**å‘ç”Ÿåœ¨**ä¹‹å‰ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹å›¾:

![](img/4b327bb911b92e6df33757799a0d05e7.png)

ç¡®ä¿¡å®ƒå¯èƒ½å¯¼è‡´æ­»é”ã€‚å½“ä¸¤ä¸ªçº¿ç¨‹ç›¸äº’é”å®šæ—¶ã€‚**çœ‹è¿™é‡Œ:**

 [## åƒµå±€

### Java æ•™ç¨‹æ˜¯ä¸º JDK 8 ç¼–å†™çš„ã€‚æœ¬é¡µä¸­æè¿°çš„ç¤ºä¾‹å’Œå®è·µæ²¡æœ‰åˆ©ç”¨â€¦

docs.oracle.com](https://docs.oracle.com/javase/tutorial/essential/concurrency/deadlock.html) 

**çº¿ç¨‹å¼€å§‹**

çº¿ç¨‹ 1 â€”å½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ã€‚åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥è¿è¡Œæ•´ä¸ªç¨‹åºã€‚çº¿ç¨‹ 2 æ˜¯ç”±ç¬¬ä¸€ä¸ªçº¿ç¨‹å¯åŠ¨çš„å¦ä¸€ä¸ªçº¿ç¨‹

*   çº¿ç¨‹ 1 å¯åŠ¨çº¿ç¨‹ 2 ->ä¿è¯çº¿ç¨‹ 2 çœ‹åˆ°æ¥è‡ªçº¿ç¨‹ 1 çš„æ‰€æœ‰æ•°æ®
*   çº¿ç¨‹ 1 **åŠ å…¥**çº¿ç¨‹ 2 - >çº¿ç¨‹ 1 çœ‹åˆ°æ¥è‡ªçº¿ç¨‹ 2(åŠ å…¥çš„çº¿ç¨‹)çš„æ‰€æœ‰æ•°æ®

**å†³èµ›åœºåœ°**

ç°åœ¨ï¼Œé‡è¯»å…³äº publication plz çš„å—ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨å°†éå¸¸ä¾èµ–å®ƒã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆ**åˆå§‹åŒ–è¿‡ç¨‹:**

è¿™æ˜¯ä¸€ä¸ªåˆ†ä¸ºä¸¤æ­¥çš„è¿‡ç¨‹:

*   é¦–å…ˆ:åœ¨å †ä¸­ä¸ºå¯¹è±¡åˆ†é…ä½ç½®
*   *å…¶æ¬¡:*è°ƒç”¨æ„é€ å‡½æ•°æ”¾å€¼ï¼Œç»“æŸæ–°å¯¹è±¡çš„åˆ›å»º

**å½“ä½ æœ‰ 2 ä¸ªçº¿ç¨‹å’Œå¯¹è±¡åˆå§‹åŒ–æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ:**

1.  ç¬¬ä¸€ä¸ªçº¿ç¨‹å¼€å§‹åˆå§‹åŒ–ã€‚å‘ç”Ÿåˆå§‹åŒ–çš„ç¬¬ä¸€æ­¥
2.  ç¬¬äºŒä¸ªçº¿ç¨‹æ£€æŸ¥å¯¹è±¡æ˜¯å¦ä¸æ˜¯`null`ã€‚çœ¼è§ä¸æ˜¯- >ä¸€æŠŠæŠ“ä½å®ƒã€‚ä½†æ˜¯å®ƒè¿˜æ²¡æœ‰å®Œå…¨åˆå§‹åŒ–ã€‚= >å®¹æ˜“å‡ºé”™ï¼Œå› ä¸ºç¬¬äºŒæ­¥åˆå§‹åŒ–åœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¸­å°šæœªç»“æŸã€‚

= >æˆ‘ä»¬åªæœ‰éƒ¨åˆ†çš„**å‘ç”Ÿâ€”â€”åœ¨**åœ¨è¿™é‡Œå·¥ä½œä¹‹å‰ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¾—åˆ°å®Œæ•´çš„å¯¹è±¡ã€‚

è§£ç­”â€”ä½¿ç”¨`final`å…³é”®å­—ã€‚

`final`å­—æ®µä½¿å˜é‡å†»ç»“â€”â€”åœ¨å°†è¯¥å­—æ®µè®¾ç½®ä¸ºå®ƒåœ¨æ„é€ å‡½æ•°ä¸­æ¥æ”¶çš„å€¼ä¹‹å‰ï¼ŒJVM ä¸å…è®¸**å‘å¦ä¸€ä¸ªçº¿ç¨‹å‘å¸ƒ**å®ä¾‹ã€‚

## ä»€ä¹ˆæ—¶å€™æŒ¥å‘å°±å¤Ÿäº†ï¼Ÿ

æ ¹æ® Jenkov æ•™ç¨‹:

> å¦‚æœåªæœ‰**ä¸€ä¸ªçº¿ç¨‹**è¯»å†™å¯å˜å˜é‡çš„å€¼ï¼Œè€Œå…¶ä»–**çº¿ç¨‹**åªè¯»å–è¯¥å˜é‡ï¼Œé‚£ä¹ˆä¿è¯è¯»å–çº¿ç¨‹çœ‹åˆ°å†™å…¥å¯å˜å˜é‡çš„æœ€æ–°å€¼ã€‚å¦‚æœä¸ä½¿å˜é‡å˜å¾—ä¸ç¨³å®šï¼Œè¿™æ˜¯æ— æ³•ä¿è¯çš„ã€‚

[](https://jenkov.com/tutorials/java-concurrency/volatile.html) [## Java æŒ¥å‘æ€§å…³é”®å­—

### Java volatile å…³é”®å­—ç”¨äºå°† Java å˜é‡æ ‡è®°ä¸ºâ€œå­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­â€ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œè¿™æ„å‘³ç€â€¦

jenkov.com](https://jenkov.com/tutorials/java-concurrency/volatile.html) 

æˆ‘å¯¹ Brian Goetz çš„â€œå®è·µä¸­çš„ Java å¹¶å‘æ€§â€çš„é‡æ–°è¡¨è¿°æ˜¯:

`Locking`(åˆå**åŒæ­¥**)å¯ä»¥åŒæ—¶ä¿è¯:å¯è§æ€§å’ŒåŸå­æ€§ï¼Œ`voltile`åªèƒ½ä¿è¯å¯è§æ€§ã€‚æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹æƒ…å†µä¸‹è‡ªç”±ä½¿ç”¨`volatile`:

*   åªæœ‰å•çº¿ç¨‹å†™å…¥å˜é‡æˆ–å†™å…¥å€¼ä¸ä¾èµ–äºå®ƒçš„å½“å‰å€¼
*   è®¿é—®å˜é‡æ—¶ä¸éœ€è¦é”å®š
*   å˜é‡ä¸å‚ä¸ä»»ä½•å…·æœ‰å…¶ä»–çŠ¶æ€å˜é‡çš„**ä¸å˜é‡**

é˜…è¯»è¿™é‡Œå…³äº**ä¸å˜é‡**:

[](https://www.geeksforgeeks.org/what-is-class-invariant/) [## ä»€ä¹ˆæ˜¯ç±»ä¸å˜é‡

### æ¦‚è¿°:é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ä¸å˜é‡æŒ‡çš„æ˜¯ä¸€äº›éœ€è¦ä¿æŒâ€¦

www.geeksforgeeks.org](https://www.geeksforgeeks.org/what-is-class-invariant/) 

ä¹Ÿå¯ä»¥çœ‹çœ‹ StackOverflow ä¸Šçš„è¿™ç¯‡å¥½æ–‡ç« :

[](https://stackoverflow.com/a/3519736/16543524) [## Java ä¸­ volatile å’Œ synchronized çš„åŒºåˆ«

### ç†è§£çº¿ç¨‹å®‰å…¨æœ‰ä¸¤ä¸ªæ–¹é¢å¾ˆé‡è¦ã€‚æ‰§è¡Œæ§åˆ¶å’Œå†…å­˜å¯è§æ€§â€¦

stackoverflow.com](https://stackoverflow.com/a/3519736/16543524) 

## ç»“å°¾éƒ¨åˆ†ğŸ‘‹ğŸ¼

å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼æŸ¥çœ‹æˆ‘åœ¨[åª’ä½“](https://medium.com/u/504c7870fdb6?source=post_page-----1cbdccc3e3b1--------------------------------)ä¸Šçš„å…¶ä»–æ–‡ç« 

æ¬¢è¿å‘è¡¨è¯„è®ºæˆ–è”ç³»æˆ‘ğŸ’ªï¼š

*   é¢†è‹±:[www.linkedin.com/in/sleeplesschallenger](http://www.linkedin.com/in/sleeplesschallenger)
*   GitHub:ã€https://github.com/SleeplessChallenger 
*   leet code:[https://leetcode.com/SleeplessChallenger/](https://leetcode.com/SleeplessChallenger/)
*   ç”µæŠ¥:@æ— çœ æŒ‘æˆ˜è€…

ç”¨äºåˆ›å»ºè¿™ç¯‡æ–‡ç« çš„æ‰€æœ‰èµ„æºğŸ‘¨ğŸ»â€ğŸ’»ï¼š

1.  Brian Goetz çš„â€œå®è·µä¸­çš„ Java å¹¶å‘â€
2.  https://youtu.be/XgiXKPEILoc
3.  ä¸å¯ä¿®æ”¹çŠ¶æ€:[https://www.geeksforgeeks.org/create-immutable-class-java/](https://www.geeksforgeeks.org/create-immutable-class-java/)
4.  å…³äºå®‰å…¨åˆå§‹åŒ–çš„ StackOverflow å¸–å­:ã€https://stackoverflow.com/a/11307418/16543524
5.  æå®¢å½’æå®¢:å…³äºç¼“å­˜[https://www . Geeks forgeeks . org/cache-memory-in-computer-organization/](https://www.geeksforgeeks.org/cache-memory-in-computer-organization/)
6.  å…³äºéƒ¨åˆ†å’Œå…¨éƒ¨è®¢å•çš„ StackOverflow å¸–å­:[https://stackoverflow.com/a/59909382/16543524](https://stackoverflow.com/a/59909382/16543524)
7.  é”ä¸ç›‘è§†å™¨:[https://howtodoinjava . com/Java/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹-é”ä¸ç›‘è§†å™¨ä¹‹é—´çš„å·®å¼‚/](https://howtodoinjava.com/java/multi-threading/multithreading-difference-between-lock-and-monitor/)
8.  Oracle doc:deadlock[https://docs . Oracle . com/javase/tutorial/essential/concurrency/deadlock . html](https://docs.oracle.com/javase/tutorial/essential/concurrency/deadlock.html)
9.  Oracle doc:atomic[https://docs . Oracle . com/javase/tutorial/essential/concurrency/atomic . html](https://docs.oracle.com/javase/tutorial/essential/concurrency/atomic.html)
10.  æå®¢çš„æå®¢:ç¼“å­˜ä¸€è‡´æ€§[https://www.geeksforgeeks.org/cache-coherence/](https://www.geeksforgeeks.org/cache-coherence/)
11.  StackOverflow å…³äºåŒæ­¥å’Œæ˜“å˜çš„å¸–å­:[https://stackoverflow.com/a/3519736/16543524](https://stackoverflow.com/a/3519736/16543524)
12.  Oracle å…³äºå¹¶å‘çš„æ•™ç¨‹:[https://docs . Oracle . com/javase/tutorial/essential/concurrency/index . html](https://docs.oracle.com/javase/tutorial/essential/concurrency/index.html)
13.  JVM å¦‚ä½•è§£é‡Šä»£ç :[https://programmer bay . com/how-does-JVM-convert-bytecode-into-machine-code/](https://programmerbay.com/how-does-jvm-convert-bytecode-into-machine-code/)

# åˆ†çº§ç¼–ç 

æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼åœ¨ä½ ç¦»å¼€ä¹‹å‰:

*   ğŸ‘ä¸ºæ•…äº‹é¼“æŒï¼Œè·Ÿç€ä½œè€…èµ°ğŸ‘‰
*   ğŸ“°æŸ¥çœ‹[å‡çº§ç¼–ç å‡ºç‰ˆç‰©](https://levelup.gitconnected.com/?utm_source=pub&utm_medium=post)ä¸­çš„æ›´å¤šå†…å®¹
*   ğŸ””å…³æ³¨æˆ‘ä»¬:[Twitter](https://twitter.com/gitconnected)|[LinkedIn](https://www.linkedin.com/company/gitconnected)|[æ—¶äº‹é€šè®¯](https://newsletter.levelup.dev)

ğŸš€ğŸ‘‰ [**åŠ å…¥å‡çº§è¾¾äººé›†ä½“ï¼Œæ‰¾åˆ°ä¸€ä»½æƒŠè‰³çš„å·¥ä½œ**](https://jobs.levelup.dev/talent/welcome?referral=true)