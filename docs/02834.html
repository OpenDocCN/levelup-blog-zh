<html>
<head>
<title>Flask + Docker: quick tips</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">烧瓶+ Docker:快速提示</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/flask-docker-quick-tips-285e4e360f2?source=collection_archive---------13-----------------------#2020-04-06">https://levelup.gitconnected.com/flask-docker-quick-tips-285e4e360f2?source=collection_archive---------13-----------------------#2020-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="fdfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Flask是一个众所周知的Python微框架。有人会说Python是一门容易学习的语言，我会说也许是。这取决于你想做什么。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/52277c29cd444a34a3167e34fc72b775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nesHExEge3vruJjcLWk91w.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">在<a class="ae lb" href="https://unsplash.com/s/photos/flask?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae lb" href="https://unsplash.com/@_louisreed?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">路易斯·里德</a>拍摄的照片</figcaption></figure><p id="ac86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会说Python对于初学者来说很容易调试。如果您不熟悉一些基本概念，尤其是来自*nix领域的概念，那么设置起来也不容易。</p><p id="598d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将在这里给<strong class="jp ir">带来一些快速提示，帮助初学者</strong>申请<a class="ae lb" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank">烧瓶</a>的过程。</p><h2 id="cb60" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">为什么是烧瓶？</h2><p id="a08c" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae lb" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank"> Flask </a>是一个用Python编写的微框架，极其灵活，占用空间小，轻量级。</p><blockquote class="ma mb mc"><p id="b5e0" class="jn jo md jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated"><strong class="jp ir">在我们开始</strong>之前——这里有一个很大的免责声明:<br/>有一百万种方法可以将Flask应用程序引入Docker。<strong class="jp ir">这只是其中之一</strong>。请随时带着您的解决方案过来与我们分享。也就是说，我们走吧！</p></blockquote><h1 id="3b77" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">1.选择基础图像</h1><p id="9249" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果你是初学者，我的建议是:坚持使用Ubuntu。更容易找到资源和如何的。在Ubuntu上取得成功后，你可以尝试其他风格，比如Alpine。</p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="b3e2" class="lc ld iq mz b gy nd ne l nf ng">FROM ubuntu:18.04</span></pre><h1 id="f678" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">2.更新您的信箱</h1><p id="d292" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在开始之前，最好运行一个apt更新和apt安装。注意让所有东西都在同一个RUN语句中。它会让你远离由于过时的库而导致的错误和奇怪的场景。</p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="e8be" class="lc ld iq mz b gy nd ne l nf ng">RUN apt-get update -y &amp;&amp; \<br/>    apt-get install -y python3-pip python3-dev python3-venv</span></pre><h1 id="f508" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">3.安装requirements.txt</h1><p id="cd8b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">将requirements.txt发送到容器中，然后运行PIP</p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="168c" class="lc ld iq mz b gy nd ne l nf ng">COPY ./requirements.txt /app/requirements.txt</span><span id="51cd" class="lc ld iq mz b gy nh ne l nf ng">RUN pip3 install --upgrade pip<br/>RUN pip3 install -r requirements.txt</span></pre><h1 id="04b7" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">4.复制应用程序文件</h1><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="9eea" class="lc ld iq mz b gy nd ne l nf ng">COPY ./app /app/</span></pre><h1 id="10ef" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">5.对. sh引导文件的权限被拒绝</h1><p id="4f62" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在终端中运行“ls -la”会告诉您该文件是否具有正确的权限。如果没有，请记住在构建映像时进行设置，如下所示:</p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="7196" class="lc ld iq mz b gy nd ne l nf ng">RUN chmod +x ./boot.sh</span></pre><p id="5345" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我强烈建议在这里使用正确的权限，而不是作为根用户运行，但是我想在开发阶段这是完全可以接受的。<strong class="jp ir">有时会发生权限冲突，你必须对你机器上的文件应用相同的权限。</strong></p><h1 id="4d68" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">6.暴露端口</h1><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="5fc7" class="lc ld iq mz b gy nd ne l nf ng">EXPOSE 5000</span></pre><h1 id="6cdf" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">7.定义入口点</h1><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="6d90" class="lc ld iq mz b gy nd ne l nf ng">ENTRYPOINT [ "./boot.sh" ]</span></pre><h1 id="ee7c" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated"><strong class="ak"> 8。应用程序正在运行，但浏览器没有显示任何内容</strong></h1><p id="ab3f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">发生这种情况是因为您还看不到服务器。请记住将应用程序绑定到0.0.0.0地址，以便从容器外部访问它。</p><p id="8b78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">启动应用程序时，这可以像下面这样轻松完成:</strong></p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="c080" class="lc ld iq mz b gy nd ne l nf ng">flask run --host 0.0.0.0</span></pre><h1 id="a163" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">9.烧瓶自动再装</h1><p id="97e1" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">每当你改变一个文件时，停止容器然后再启动它是很烦人的。嗯，你真的不需要这样做！</p><p id="d551" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在启动应用程序之前，将您的ENV导出为开发:</p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="4cae" class="lc ld iq mz b gy nd ne l nf ng">export FLASK_ENV=development</span></pre><h1 id="b1ab" class="mh ld iq bd le mi mj mk lh ml mm mn lk mo mp mq ln mr ms mt lq mu mv mw lt mx bi translated">10.字符和编码问题</h1><p id="df10" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">将你的应用默认编码设置为UTF-8:</p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="a089" class="lc ld iq mz b gy nd ne l nf ng">export LC_ALL=C.UTF-8<br/>export LANG=C.UTF-8</span></pre></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><h1 id="e90f" class="mh ld iq bd le mi np mk lh ml nq mn lk mo nr mq ln mr ns mt lq mu nt mw lt mx bi translated">入口点文件</h1><p id="1536" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><strong class="jp ir">在这种情况下，整个boot.sh将是:</strong></p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="b12b" class="lc ld iq mz b gy nd ne l nf ng"><strong class="mz ir">#!/bin/bash</strong><br/>export LC_ALL=C.UTF-8<br/>export LANG=C.UTF-8<br/>export FLASK_APP=app.py<br/>export FLASK_ENV=development</span><span id="50c7" class="lc ld iq mz b gy nh ne l nf ng">flask run --host 0.0.0.0</span></pre><p id="859a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">对完整的Dockerfile好奇？就是这里:</strong></p><pre class="km kn ko kp gt my mz na nb aw nc bi"><span id="467e" class="lc ld iq mz b gy nd ne l nf ng">FROM ubuntu:18.04<br/><br/>RUN apt-get update -y &amp;&amp; \<br/>    apt-get install -y python3-pip python3-dev python3-venv<br/><br/>COPY ./requirements.txt /app/requirements.txt<br/><br/>RUN pip3 install --upgrade pip &amp;&amp; \<br/>    pip3 install -r requirements.txt<br/><br/>COPY ./app /app/<br/>RUN chmod +x ./boot.sh<br/>EXPOSE 5000<br/>ENTRYPOINT [ "./boot.sh" ]</span></pre><p id="507e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这些了，希望对你有帮助！<br/>快乐编码用<a class="ae lb" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank">烧瓶</a>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><a href="https://www.buymeacoffee.com/gabrielguerra"><div class="gh gi nu"><img src="../Images/62095e5d34c9f0d8bd36b088feb508a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s8iTSyoC9luRrUlu.png"/></div></a></figure></div></div>    
</body>
</html>