<html>
<head>
<title>What You Need to Know About Unit Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于单元测试你需要知道什么</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-you-need-to-know-about-unit-testing-7b04004da8fe?source=collection_archive---------2-----------------------#2019-09-18">https://levelup.gitconnected.com/what-you-need-to-know-about-unit-testing-7b04004da8fe?source=collection_archive---------2-----------------------#2019-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/3318bf08c80394b346c9846b6b4877ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nvoexm6vOTzfF3TeYA2JDQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">单元测试和最佳实践指南</figcaption></figure><h1 id="ebca" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">什么是单元测试</h1><p id="0848" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">单元测试是一种将代码分成易于管理和测试的小块，以确保代码按预期运行的方法。通过关注代码中的特定行为，您能够确保按照预期处理正确的输入和输出。结合自动化过程和框架，单元测试可以连续运行，限制人为错误，并在编码期间向开发人员提供即时反馈。</p><h1 id="9f00" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">什么是好的单元测试</h1><h1 id="16b0" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">1.易读的</h1><p id="6290" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">将单元测试视为应用程序或文档本身的蓝图。它应该易于阅读，遵循和理解，只需要很少的外部文档或开发人员的解释。保持这种状态的最好方法就是保持简单。将您的单元测试分组为逻辑部分，并在这些部分内将您的测试限制为一个特性或行为。</p><h1 id="d661" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">2.可预言的</h1><p id="2e56" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">对于测试的每一次迭代，您都希望确保它每次都按预期运行。即使您有随机的数据，比如字符串、id或数字，输入数据也不应该改变测试，只要它符合预期的行为或要求。记住要保持简单，不要因为试图在一个领域做太多而使你的代码或单元测试过于复杂。相反，选择创建更多的单元测试来更好地关注您试图建立的行为。</p><h1 id="4d1a" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">3.速度和可扩展性</h1><p id="9b33" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">对于较大的项目，你可以进入数以万计的单元测试，测试时间可以相对快速地增加。在每次测试2秒和1万次测试的情况下(10K * 2秒= 5.5小时)，运行完整的单元测试大约需要5.5小时。在构建过程中，有多种方法可以提高单元测试的运行速度，增加服务器的容量和并行运行测试就是几个选择。然而，您的开发人员仍然需要在本地运行这些测试。缩短单元测试时间的最好方法是限制复杂性，并模仿单元测试所需的任何外部资源。</p><p id="da73" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">一个很好的例子是连接到MongoDB或AWS Elasticsearch集群。如果您为每个单元测试创建一个新的连接，那么您的测试将不得不暂停，直到建立一个连接。假设每个连接需要3秒钟，并且您有10个连接，那么连接到集群的运行时间将增加30秒。更好的选择是缓存其中一个连接并重用它们。这将带你到3秒每单元测试套件(这只是一个单元测试的集合)。</p><p id="9d03" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">最好的解决方案是模拟连接。这样，您就永远不会真正连接到数据库，而是使用一个模拟API来模拟对数据库的调用。将实际的数据完整性测试留给集成和端到端测试。</p><h1 id="fb68" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">4.了解您的工具和框架</h1><p id="e924" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">理解单元测试所使用的任何框架或工具的内部工作是很重要的。你应该能够回答下列问题。</p><ol class=""><li id="1a4a" class="mg mh it lf b lg mb lk mc lo mi ls mj lw mk ma ml mm mn mo bi translated">解决具体问题的最好方法是什么？</li><li id="b67d" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">运行单元测试最快最有效的方法是什么？</li><li id="55ba" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">您的工具允许云服务集成吗？</li><li id="5c55" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">有什么特殊的设置可以加速你的单元测试吗？</li><li id="b1d6" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">这个框架还在开发中吗？如果不是，如果它是开源的，你愿意维护它吗？</li><li id="5753" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">有没有可以提问的社区？</li></ol><p id="0236" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">花些时间阅读文档并理解您的测试框架和工具，这样您就可以编写符合您的框架标准的高效单元测试。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="61a0" class="kf kg it bd kh ki nb kk kl km nc ko kp kq nd ks kt ku ne kw kx ky nf la lb lc bi translated">单元测试的10个最佳实践</h1><h2 id="4fe3" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">1.知道要测试什么</h2><p id="c748" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">您如何确定应该测试什么以及应该覆盖多少代码？对于是否应该测试代码的一部分，一个很好的基础是更改的频率，如果它是经常更改的，或者有可能与代码的其他部分集成，您希望确保它被覆盖，如果任何东西中断或失败，您希望在开发期间立即知道。</p><h2 id="4348" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">2.单元测试或端到端测试</h2><p id="3c2e" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">一个好的经验法则是，如果你正在进行多种类型的测试，包括单元测试、端到端测试和集成测试，你要确保你覆盖的代码足够多，不会重复。如果你有一个单元测试来测试一个按钮是否可以被点击，那么就不应该有一个端到端的测试来做同样的事情。一些框架，比如Vue.js test utils，允许你直接在单元测试中进行交互测试。</p><p id="1d19" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">这可能是一种快速判断特定交互(如鼠标点击或悬停)是否有效的快速方法。因为它们是从已编译的组件中呈现的dom元素，所以它们更接近代码，并且由于不需要网页或构建过程而工作得更快。在开发会议期间进行磨合的额外好处还意味着当单元测试失败时，开发人员会立即得到通知；限制导致错误和找到其根本原因之间的延迟。</p><p id="eb79" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">当您想要直观地测试单元测试本身无法测试的元素时，应该进行端到端测试。在单元测试中，比DOM元素更容易看到的视觉反馈包括。</p><ol class=""><li id="17c7" class="mg mh it lf b lg mb lk mc lo mi ls mj lw mk ma ml mm mn mo bi translated">打开覆盖</li><li id="3f01" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">动画速度、缓动和持续时间</li><li id="bd85" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">检查多个元素是否同时出现在屏幕上。</li><li id="8755" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">颜色匹配视觉样式指南</li><li id="aa28" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">响应式网页设计布局</li></ol><p id="08a7" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">如果您的代码是由外部工作室或外包完成的，那么您将需要进行一些验证，端到端测试将允许您直观地验证可交付成果是否符合预期。</p><p id="ee00" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">根据我的经验，当你有一个可视化的工具，可以在浏览器中自动生成端到端的测试时，端到端的测试效果最好。手写Selenium代码可能会很乏味，当您的端到端测试人员与开发代码库的开发人员不同时，很难与代码库保持同步。</p><h2 id="7d23" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">3.安装和拆卸</h2><p id="aadd" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">有时候你需要设置、初始化变量、设置属性或者创建合适的条件来运行测试。这个设置阶段通常可以在一个套件中的其他单元测试中重用，同时限制重复的需要。同样重要的是拆卸阶段，您要确保在您做出任何更改后，您也否定或取消它们，以便其他单元测试不受先前测试的影响。</p><p id="cb40" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">大多数框架都包含特殊的函数，这些函数在单元测试运行之前或之后工作。使用这些计时函数来正确地构建和拆除单元测试的条件。这是您想要放置一组单元测试(suite)或者仅仅一个特定单元测试所需的任何逻辑的地方，这样它们总是可以独立于单元测试本身运行。</p><h2 id="b8de" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">4.独立的单元测试</h2><p id="86bc" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">您的单元测试不应该依赖于先前的测试状态才能通过。在运行下一个单元测试或单元测试集之前，应该重置单元测试中共享的任何变量、常量或对象。这样做将确保您的单元测试总是干净的，并且它们的状态不会在测试之间被维护或弄脏。</p><h2 id="9e14" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">5.随机化您的数据以防止误报</h2><p id="a05e" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">您有一个正在进行单元测试的函数，您希望传递的任何参数都返回一个特定的字符串。所以你硬编码这个字符串，每次你运行单元测试，它都通过了，恭喜你！</p><p id="77b1" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">当你改变输入时会发生什么，你仍然得到预期的结果吗？琴弦的长度很重要吗？你是否使用了传递给函数的参数，或者你是否也硬编码了返回值？</p><p id="4d22" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">受控随机化将允许您测试给定的输入和输出，而不会无意中创建一个完美的结果。通过随机化函数的参数，然后验证结果是否匹配。它将确保无论输入是什么，期望的输出总是期望的输出，而不是您预先确定为正确的输出。</p><h2 id="4a8f" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">6.组织单元测试</h2><p id="da16" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">当考虑单元测试结构时，要宽泛而不是具体。最上面的名称或描述应该是您正在测试的文件、类或组件的名称。第二层应该是特性或用例——它们分解行动单元，如果你有相关的行动，就把它们组合在一起。</p><p id="bd30" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">例如，如果您有一个更新按钮</p><ol class=""><li id="9de5" class="mg mh it lf b lg mb lk mc lo mi ls mj lw mk ma ml mm mn mo bi translated">触发器分析</li><li id="216a" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">请求服务呼叫</li><li id="6a86" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">更改按钮的可视状态</li></ol><p id="d13e" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">创建一个描述“更新按钮”功能的组，并为该按钮点击所产生的每个副作用创建单独的测试。</p><h2 id="c2d5" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">7.加速你的单元测试</h2><p id="7837" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">随着应用程序的增长和单元测试的创建，运行所有的单元测试自然会花费更多的时间。但是，在某些情况下，您可能会引入延迟，这会大大增加时间。有一些你想要遵循的模式，以确保你不会引入延迟或时间发生的惩罚。</p><ol class=""><li id="09a5" class="mg mh it lf b lg mb lk mc lo mi ls mj lw mk ma ml mm mn mo bi translated">不要添加延迟代码执行的计时器</li><li id="e3e8" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">模拟所有外部资源调用和服务</li><li id="a719" class="mg mh it lf b lg mp lk mq lo mr ls ms lw mt ma ml mm mn mo bi translated">不需要或导入大量数据文件</li></ol><h2 id="2bba" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">8.代码覆盖率</h2><p id="e567" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">代码覆盖率允许您编写单元测试，并对您的代码逐行运行诊断或检测，最终输出汇总了已进行单元测试的代码的百分比。更高级的设置和ide(集成开发环境)将增加定义单元测试已经覆盖或没有覆盖的代码行的亮点。这些彩色编码的行给你实时的反馈，告诉你测试了多少，以及你的代码的可测试性如何。</p><p id="c1e6" class="pw-post-body-paragraph ld le it lf b lg mb li lj lk mc lm ln lo md lq lr ls me lu lv lw mf ly lz ma im bi translated">用uni test很难达到的深层逻辑和语句可以揭示可能的糟糕的编码实践。您越接近团队可接受的覆盖率，您对代码就越有信心。大多数单元测试框架都提供了在您的代码库上运行某种代码覆盖的能力。</p><h2 id="9a2b" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">9.了解你的极限</h2><p id="33b7" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在进行单元测试的时候，了解并留意什么样的最小覆盖率被认为是通过的是很重要的。理想情况下，你想要确保你有100%的代码覆盖率，但是生活总是会发生，这个数字经常是一个移动的目标。80–90%的代码覆盖率被认为是黄金覆盖率。然而，你最好设定一个标准，这个标准是你的团队在现有资源下可以达到的，而不会精疲力竭。即使你觉得你自己可以达到这些数字，也要考虑整个团队的士气和可交付成果，否则，单元测试就不会完成。</p><h2 id="9593" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">10.单元测试风格指南</h2><p id="87a6" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">确保你和你的团队对一个好的单元测试有一致的指导方针。召开设计会议和代码评审，以确保遵循这些指导方针和最佳实践。不过要注意，习惯的形成和坚持可能需要一些时间，所以不要对自己或团队成员太苛刻。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><blockquote class="ns"><p id="335c" class="nt nu it bd nv nw nx ny nz oa ob ma dk translated">如果你喜欢这篇文章，把它拍下来，并与你的朋友分享。有问题，意见或任何反馈，请在下面的评论区留下。</p></blockquote><figure class="od oe of og oh ju gh gi paragraph-image"><a href="https://bit.ly/2kRryMy"><div class="gh gi oc"><img src="../Images/1a4978ee5957bf78a975aa1e6a388d37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pS-BdbFcQ-2bBQdFoH00Kg.png"/></div></a></figure><h2 id="7adc" class="ng kg it bd kh nh ni dn kl nj nk dp kp lo nl nm kt ls nn no kx lw np nq lb nr bi translated">进一步阅读</h2><div class="oi oj gp gr ok ol"><a rel="noopener  ugc nofollow" target="_blank" href="/10-things-you-should-know-before-writing-your-next-vuejs-component-4f97964611f4"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">在编写下一个Vue.js组件之前你应该知道的10件事</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">构建更好的Vue组件指南</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz jz ol"/></div></div></a></div></div></div>    
</body>
</html>