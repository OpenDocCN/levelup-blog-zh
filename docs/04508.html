<html>
<head>
<title>Annoy (or Impress) Your Coworkers with a Slack Bot From Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始用一个Slack Bot惹恼(或打动)你的同事</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/annoy-or-impress-your-coworkers-with-a-slack-bot-made-from-scratch-43753e33e7cc?source=collection_archive---------34-----------------------#2020-06-29">https://levelup.gitconnected.com/annoy-or-impress-your-coworkers-with-a-slack-bot-made-from-scratch-43753e33e7cc?source=collection_archive---------34-----------------------#2020-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4f87" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">亦作</em> <a class="ae kp" href="https://www.blog.karenying.com/posts/annoy-or-impress-your-coworkers-with-a-slack-bot-from-scratch" rel="noopener ugc nofollow" target="_blank"> <em class="ko">发表</em></a><em class="ko"/><a class="ae kp" href="https://www.blog.karenying.com/" rel="noopener ugc nofollow" target="_blank"><em class="ko">【blog.karenying.com】</em></a><em class="ko">。</em></p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/689665bfaf1b778c32586110f5780699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4PH9UomY67fk5sEQhVlXA.jpeg"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">照片来自<a class="ae kp" href="https://unsplash.com/photos/itSX0YT9TiU" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="be6f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我的同事阿里总是在工作的时候忘记吃午饭。因为我们是远程工作，我想要某种自动提醒信息来联系他。我没有使用Slack的原生无代码解决方案<a class="ae kp" href="https://slack.com/help/articles/208423427-Set-a-reminder" rel="noopener ugc nofollow" target="_blank"> Slack reminders </a>，而是决定从头构建并部署一个，因为# QuarantineBoredom。</p><p id="7e57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">像任何有理性的人一样，我在谷歌上搜索了“slack bot教程”，“如何从头开始构建slack bot”，并在深入研究之前阅读了大量教程。我对一个<strong class="js iu"> Node.js实现</strong>感兴趣，因为这是我最熟悉的。我还想要一个相对简单的配置，不需要我创建10个不同的帐户。</p><p id="d151" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我最终选定了这个来自<a class="ae kp" href="https://www.freecodecamp.org/news/building-a-slackbot-with-node-js-and-slackbots-js/" rel="noopener ugc nofollow" target="_blank">自由代码营</a>的教程。这篇文章本质上是关于我如何利用Bolaji Ayodeji的实现并让它为我工作。我们将编写一个在预定时间发送消息的slack机器人。与Ayodeji的文章不同，<strong class="js iu">用户无法与这个bot进行交互。</strong></p><p id="c0ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个帖子还会谈到我把它部署到Heroku。大多数Slack bot教程都错过了这最后一步。他们表现得好像你每次想用它的时候都想在本地运行它🙄</p><h2 id="c149" class="lg lh it bd li lj lk dn ll lm ln dp lo kb lp lq lr kf ls lt lu kj lv lw lx ly bi translated">先决条件</h2><p id="f592" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">本教程假设您对Javascript、Node.js、npm和GitHub有所了解。一切都好吗？我们开始吧👍🏼</p><h1 id="a4c3" class="me lh it bd li mf mg mh ll mi mj mk lo ml mm mn lr mo mp mq lu mr ms mt lx mu bi translated">松弛配准</h1><p id="a843" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">在我们开始编码之前，我们必须在Slack上注册我们的应用程序！</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mv"><img src="../Images/35b1dd8462874b51767a57d268438579.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UnsTLwbleG1fFrJSKl3MNQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">经典Slack应用</figcaption></figure><p id="8b03" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保您已登录Slack并前往<a class="ae kp" href="https://api.slack.com/apps?new_classic_app=1" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">创建Slack应用程序(经典)</strong> </a>。<strong class="js iu">创建一个“经典”应用</strong>至关重要，因为我们将要使用的npm包<a class="ae kp" href="https://www.npmjs.com/package/slackbots" rel="noopener ugc nofollow" target="_blank"> slackbots </a>只能使用旧Slack应用API生成的令牌。如果你前往<a class="ae kp" href="https://api.slack.com/apps" rel="noopener ugc nofollow" target="_blank">https://api.slack.com/apps</a>并点击“创建新应用程序”，那么<strong class="js iu">将不会</strong>工作。</p><p id="ccf8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输入你想要的应用程序名称(我称我的为“午餐机器人”)，然后选择你想要添加新应用程序的工作区。点击<strong class="js iu">创建应用</strong>。</p><p id="97b6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<strong class="js iu">基本信息</strong>页面，向下滚动到<strong class="js iu">显示信息。</strong>这是好玩的部分！自定义你的机器人的外观。您也可以在以后执行/更改此操作。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mw"><img src="../Images/e626337b257b5e5a5c1b75ef3f19a4ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qf1i2VDP83NrxYZXFe9mdA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">机器人用户与您的工作空间进行交互</figcaption></figure><p id="762f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，在<strong class="js iu">基本信息</strong>页面的顶部，在<strong class="js iu">为Slack构建应用下，</strong>展开<strong class="js iu">添加特性和功能</strong>。选择<strong class="js iu">机器人</strong>卡。我们希望我们的机器人能够发送消息，所以我们需要<strong class="js iu">添加传统机器人用户</strong>。填写两个必填字段:<strong class="js iu">显示名称</strong>和<strong class="js iu">默认用户名</strong>。切换<strong class="js iu">总是显示我的机器人在线</strong>为真。</p><p id="b5dc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">回到<strong class="js iu">基本信息&gt;构建应用</strong>对于Slack，展开<strong class="js iu">将应用安装到工作区</strong>，点击<strong class="js iu">将应用安装到工作区</strong>。点击<strong class="js iu">允许</strong>。</p><p id="710a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在转到你的Slack workspace:[your-workspace-name]. Slack . com。在左侧面板，向下滚动直到你看到<strong class="js iu">应用</strong>标题。点击右边的<strong class="js iu"> + </strong>图标，搜索刚刚创建的应用。点击你的应用程序，你应该看到它出现在<strong class="js iu">应用程序</strong>标题下，显示在线状态！</p><p id="822f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">太棒了，我们现在完成了这个松弛设置。到编码部分。</p><h1 id="01b7" class="me lh it bd li mf mg mh ll mi mj mk lo ml mm mn lr mo mp mq lu mr ms mt lx mu bi translated">编码</h1><h2 id="f080" class="lg lh it bd li lj lk dn ll lm ln dp lo kb lp lq lr kf ls lt lu kj lv lw lx ly bi translated">正在设置</h2><p id="d5d4" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">如前所述，我们将使用Node.js和npm。我们稍后还希望集成Heroku x GitHub，所以让我们从一个空目录开始</p><pre class="kr ks kt ku gt mx my mz na aw nb bi"><span id="537e" class="lg lh it my b gy nc nd l ne nf">$ git init</span></pre><p id="3546" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们必须初始化npm:</p><pre class="kr ks kt ku gt mx my mz na aw nb bi"><span id="5e9b" class="lg lh it my b gy nc nd l ne nf">$ npm init</span></pre><p id="50e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">继续按enter键，直到生成您的<code class="fe ng nh ni my b">package.json</code>。</p><p id="9834" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用三个npm包:<a class="ae kp" href="https://www.npmjs.com/package/slackbots" rel="noopener ugc nofollow" target="_blank"> slackbots </a>、<a class="ae kp" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"> dotenv </a>和<a class="ae kp" href="https://www.npmjs.com/package/node-cron" rel="noopener ugc nofollow" target="_blank"> node-cron </a>:</p><pre class="kr ks kt ku gt mx my mz na aw nb bi"><span id="3eb9" class="lg lh it my b gy nc nd l ne nf">$ npm i slackbots<br/>$ npm i dotenv<br/>$ npm i node-cron</span></pre><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/ee3bc3c268d1d5f4533f5a7c12af6f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*djKruw-GnwI50pL1w9_hEQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">复制第二个令牌(不是第一个)</figcaption></figure><p id="a9e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，创建一个文件名<code class="fe ng nh ni my b">.env</code>。在这里，我们将存储Slack应用程序的授权令牌。返回到应用程序的配置页面。点击此<a class="ae kp" href="https://api.slack.com/apps/" rel="noopener ugc nofollow" target="_blank">链接</a>并找到您的应用。然后进入<strong class="js iu">功能&gt; OAuth &amp;权限</strong>。我们想要复制<strong class="js iu"> Bot用户OAuth访问令牌</strong>。</p><p id="dfcf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe ng nh ni my b">.env</code>中，创建环境变量:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="2785" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为我们正在将这个项目推向GitHub，所以保护您的授权令牌是一个很好的做法！dotenv npm包允许我们使用我们的环境变量🙂</p><p id="55bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，让我们创建一个<code class="fe ng nh ni my b">index.js</code>并设置我们的包。这就是我们机器人所有逻辑的所在。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="c894" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将启动脚本添加到<code class="fe ng nh ni my b">"scripts"</code>下的<code class="fe ng nh ni my b">package.json</code>:</p><pre class="kr ks kt ku gt mx my mz na aw nb bi"><span id="b274" class="lg lh it my b gy nc nd l ne nf">"start": "node index.js"</span></pre><p id="81c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样就可以用<code class="fe ng nh ni my b">npm start</code>启动bot了。</p><h2 id="0452" class="lg lh it bd li lj lk dn ll lm ln dp lo kb lp lq lr kf ls lt lu kj lv lw lx ly bi translated">建造机器人</h2><p id="2738" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我们将使用npm软件包slackbots。虽然你可以通过使用<a class="ae kp" href="https://api.slack.com/" rel="noopener ugc nofollow" target="_blank"> Slack API </a>来构建一个Slack bot，但是这个包会为我们处理所有的API调用。有了slackbots，我们可以用不到30行代码编写我们的机器人。</p><p id="691e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要启动bot，请执行以下操作:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="a5cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保名称属性<strong class="js iu">与您注册的应用名称</strong>(不是bot用户名)完全匹配，包括大小写。</p><p id="64c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让机器人在启动时通知我们:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="22b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，如果你运行<code class="fe ng nh ni my b">npm start</code>，你应该得到通知，你的机器人正在启动！习惯这一点，因为你会经常看到这条消息😅</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/28e9a54bfe76f4ba90ab91c177bbd05a.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*HboNZVETE_lfJX-hhmAOfA.png"/></div></figure><p id="a570" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">耶连接成功了！</p><p id="06cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们想安排我们的机器人在特定的时间发送消息。你可以在slackbots的npm页面查看所有slack bots的方法。具体我们要的是<code class="fe ng nh ni my b">postMessageToChannel</code>。我发现为了让<code class="fe ng nh ni my b">postMessageToUser</code>工作，用户必须将应用程序添加到他们的工作区(并让它显示在<strong class="js iu">应用程序</strong>下)。因此，我们可以通过将你的同事添加到你的机器人发布的群中来给他们惊喜，而无需他们添加应用程序！</p><p id="b0a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了确保消息在正确的时间发送，我们将使用node-cron npm包。调度器语法可以在<a class="ae kp" href="https://www.npmjs.com/package/node-cron" rel="noopener ugc nofollow" target="_blank">这里</a>找到。我将这个逻辑模块化到另一个名为<code class="fe ng nh ni my b">createJob</code>的函数中。这是我最后为我的机器人添加的内容:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="949b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ng nh ni my b">'32 12 * * 1–5'</code>表示此消息将在每个工作日的下午12:32发送，正好赶上午餐时间！请确保添加您的时区，因为如果没有此配置，node-crone将以UTC运行。<a class="ae kp" href="https://raw.githubusercontent.com/node-cron/tz-offset/master/generated/offsets.json" rel="noopener ugc nofollow" target="_blank">这个</a>是节点代码接受的所有有效时区字符串的列表。</p><p id="4cfc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后一块是在bot启动时调用<code class="fe ng nh ni my b">createJob</code>:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="db8d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就是这样！您刚刚用不到30行代码创建了自己的slack bot🎉如果你愿意的话，你可以改变消息应该何时发送/发送给谁，以进行更多的测试和试验。当你准备好了，把你的代码推到GitHub repo，让我们部署到Heroku！</p><h1 id="7961" class="me lh it bd li mf mg mh ll mi mj mk lo ml mm mn lr mo mp mq lu mr ms mt lx mu bi translated">部署</h1><h2 id="2f5e" class="lg lh it bd li lj lk dn ll lm ln dp lo kb lp lq lr kf ls lt lu kj lv lw lx ly bi translated">赫罗库</h2><p id="4ed8" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">登录或创建一个<a class="ae kp" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>账户(免费)。在仪表盘上，点击<strong class="js iu">新建&gt;创建新应用</strong>。给你的应用命名，选择一个地区，点击<strong class="js iu">创建应用</strong>。在<strong class="js iu">部署方式</strong>下，选择<strong class="js iu"> GitHub </strong>。如果您还没有链接您的GitHub帐户，请链接。搜索你的机器人的回购，点击<strong class="js iu">连接</strong>。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nn"><img src="../Images/1c40b1ec1a45c4c748f6e8f068176337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2nNT0Tcki-IecgjwENQkGA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">Heroku配置变量</figcaption></figure><p id="034f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后在<strong class="js iu">设置&gt;配置变量&gt;显示配置变量</strong>下，输入<code class="fe ng nh ni my b">BOT_TOKEN</code>作为<strong class="js iu">键</strong>和来自<code class="fe ng nh ni my b">.env</code>文件的相同值作为<strong class="js iu">值</strong>。点击<strong class="js iu">添加</strong>保存。</p><p id="b459" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">前往<strong class="js iu">展开&gt;手动展开</strong>并点击<strong class="js iu">展开分支</strong>。几秒钟内，你应该得到你的机器人告诉你，你的机器人正在启动pinged！非常刺激。</p><h2 id="70de" class="lg lh it bd li lj lk dn ll lm ln dp lo kb lp lq lr kf ls lt lu kj lv lw lx ly bi translated">Heroku调度程序</h2><p id="4d23" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">如果你以前用过Heroku，你会知道他们的免费层有局限性:即你的应用程序在<a class="ae kp" href="https://devcenter.heroku.com/articles/free-dyno-hours" rel="noopener ugc nofollow" target="_blank"> 30分钟不活动</a>后“进入睡眠”。这将是很好的，除了我们的应用程序没有前端。除非您每次都手动部署应用程序，否则在最初的30分钟后，它将永远处于睡眠状态。这就是Heroku调度程序的用武之地。</p><p id="0b2b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在lunchbot的例子中，我们只希望lunchbot在每个工作日的中午12:32之前醒来，这样cron作业就可以开始工作并发送消息。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi no"><img src="../Images/1a53ba28a15c676ea5ec49642091e0fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cjXwVJsBPoWTrkcSQvYhXw.png"/></div></div></figure><p id="43a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在你应用的Heroku仪表盘上，进入<strong class="js iu">资源&gt;附加组件</strong>，搜索并选择<strong class="js iu"> Heroku调度器</strong>。点击<strong class="js iu">供应</strong>。</p><p id="beee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Heroku调度程序应出现在<strong class="js iu">附加组件</strong>下。单击名称，它应该会将您重定向到调度程序的仪表板。点击<strong class="js iu">创建工单</strong>。输入您希望应用程序启动的频率。对我来说，选择每天下午4:30 UTC的<strong class="js iu">是有意义的。我们希望调度程序运行的命令是<code class="fe ng nh ni my b">npm start</code>,所以一定要输入它。点击<strong class="js iu">保存作业</strong>，您就可以开始了！</strong></p><p id="c28b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了Heroku Scheduler，我们已经解决了应用程序休眠的自由层问题。警告是不能保证Heroku调度程序按时执行。创建作业时，有一个免责声明<em class="ko">作业在尽可能接近计划的时间窗口内运行</em>。在我使用lunchbot的经验中，有时作业直到2小时后才执行。然后，我们的cron作业不再工作，我们的机器人无法通知阿里吃午饭☹️不幸的是，这只是使用Heroku免费的后果。</p><p id="1e7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">另一个注意事项</strong>:虽然Heroku声称你的应用程序在30分钟不活动后会进入睡眠状态，但Heroku也会相当频繁地随机启动你的应用程序:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/66f9b84af34f26e2fec54935df9fdd28.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*B_87wCiSoomtkb-_4fJx8Q.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">这是怎么回事</figcaption></figure><p id="8da1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你不想被你的机器人发送垃圾邮件，你应该删除给你自己的启动信息。</p><p id="d336" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总之耶！你有一个功能正常的机器人。下面我列出了一些棘手的事情，如果你遇到了麻烦，可以检查一下。这也是我对午餐机器人的GitHub回购。</p><h1 id="020b" class="me lh it bd li mf mg mh ll mi mj mk lo ml mm mn lr mo mp mq lu mr ms mt lx mu bi translated">解决纷争</h1><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nq"><img src="../Images/96aa12ff801808b48a6679ba3c88bfee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZ15EUQWmNB4-tz6508Yew.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">我不知道node-cron默认是UTC</figcaption></figure><p id="e528" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于这些问题，✅的答案应该是肯定的</p><ul class=""><li id="549a" class="nr ns it js b jt ju jx jy kb nt kf nu kj nv kn nw nx ny nz bi translated">你确定要打造一款<a class="ae kp" href="https://api.slack.com/apps?new_classic_app=1" rel="noopener ugc nofollow" target="_blank">经典Slack app </a>了吗？</li><li id="acc6" class="nr ns it js b jt oa jx ob kb oc kf od kj oe kn nw nx ny nz bi translated">你的机器人会出现在<strong class="js iu">应用</strong>下吗？</li><li id="0010" class="nr ns it js b jt oa jx ob kb oc kf od kj oe kn nw nx ny nz bi translated">你是否在<code class="fe ng nh ni my b">cron.schedule()</code>中设置了一个<a class="ae kp" href="https://raw.githubusercontent.com/node-cron/tz-offset/master/generated/offsets.json" rel="noopener ugc nofollow" target="_blank">时区</a>？</li><li id="38d4" class="nr ns it js b jt oa jx ob kb oc kf od kj oe kn nw nx ny nz bi translated">你在<code class="fe ng nh ni my b">new SlackBot()</code>中使用了你的应用的准确名称吗？</li><li id="1867" class="nr ns it js b jt oa jx ob kb oc kf od kj oe kn nw nx ny nz bi translated">你配置你的Heroku变量了吗？</li><li id="e5cd" class="nr ns it js b jt oa jx ob kb oc kf od kj oe kn nw nx ny nz bi translated">您是否为Heroku调度程序作业设置了正确的UTC时间？</li></ul><h1 id="b370" class="me lh it bd li mf mg mh ll mi mj mk lo ml mm mn lr mo mp mq lu mr ms mt lx mu bi translated">结论</h1><p id="f954" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">在这篇文章中，我们使用了几个npm包，用不到30行代码拼凑了一个Slack bot。我们将应用程序部署到Heroku，并使用Heroku Scheduler及时唤醒机器人，以发送每日消息。我以此为基础的教程更加深入地讲述了如何让你的机器人具有交互性。如果你对此感兴趣，一定要去看看。</p><p id="b069" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我能给你的全部。去惹恼(或打动)你的同事😛</p><p id="8a2b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读。编码快乐！</p></div></div>    
</body>
</html>