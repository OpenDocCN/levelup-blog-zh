# Flutter:å¼‚æ­¥ Redux å’Œ GraphQL

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/flutter-async-redux-graphql-7c0db2e4d2be>

![](img/45753a65aed5af074c0d5cdfc7b6f619.png)

ä½¿ç”¨ Async Redux å’Œ GraphQL å¼€å‘ Flutter åº”ç”¨ç¨‹åºã€‚

![](img/3a9a50187a2bee120057dd055b78463a.png)

é¦–å…ˆï¼Œå¦‚æœæ‚¨å¸¦ç€é™è½ä¼å è½åˆ°è¿™é‡Œï¼Œè¿™é‡Œå°†æ˜¾ç¤ºçš„åªæ˜¯éªŒè¯ä¸€ä¸ªæƒ³æ³•çš„æ¦‚å¿µè¯æ˜(PoC)ã€‚å¯¹ä½ ç†è§£å’Œæç‚¼æ–°çŸ¥è¯†å¯èƒ½ä¼šæœ‰ç”¨ã€‚

> è¿™æ˜¯ä¸€ä¸ªä»è‘¡è„ç‰™è¯­ğŸ‡§ğŸ‡·ç¿»è¯‘æˆè‹±è¯­çš„ç‰ˆæœ¬ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°çš„åŸæ–‡ï¼š<https://medium.com/@oguibueno/flutter-async-redux-graphql-b581d8097b84>

# æ‘†åŠ¨

å®ƒæ˜¯ä¸€ä¸ªç”¨ Dart å¼€å‘çš„å¼€æº SDKï¼ŒDart æ˜¯ä¸€ç§ç”± Google åˆ›å»ºçš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œå…¶ç¬¬ä¸€ä¸ªç‰ˆæœ¬äº 2013 å¹´æ¨å‡ºï¼Œä¸»è¦æ„å›¾æ˜¯å–ä»£ JavaScriptã€‚2018 å¹´ï¼Œ2.0 ç‰ˆæœ¬å‘å¸ƒï¼Œå…¨é¢ä¼˜åŒ–ï¼Œå¤šæ–¹é¢æ”¹è¿›ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å®¢æˆ·ç«¯å¯¹åº”ç”¨ã€web å’Œæ¡Œé¢çš„å…³æ³¨ã€‚

Flutter ä¸ä½¿ç”¨åŸç”Ÿç»„ä»¶ï¼Œæ‰€ä»¥éƒ½æ˜¯å›¾å½¢å¼•æ“è‡ªå·±æ¸²æŸ“çš„ï¼Œæ¯”å¦‚æŒ‰é’®ã€æ–‡æœ¬ã€åª’ä½“ã€èƒŒæ™¯ç­‰ã€‚ç„¶è€Œï¼Œå®ƒçš„çµæ„Ÿæ¥è‡ª Reactï¼Œå…¶ä¸­çš„ç»„ä»¶(ä¹Ÿç§°ä¸ºå°éƒ¨ä»¶)æ˜¯å£°æ˜å¼ç¼–å†™çš„ï¼Œå½“ç„¶ï¼Œå®ƒæœ‰ä¸€ä¸ªçƒ­é‡è½½ã€‚

![](img/78666f1251c8da4d0005f09a64b276fc.png)

# çŠ¶æ€ç®¡ç†

åœ¨åº”ç”¨ç¨‹åºä¸­ï¼ŒçŠ¶æ€ç®¡ç†æ˜¯æ•°æ®(æ¥è‡ªåç«¯)æˆ–æœ¬åœ°å˜åŒ–ä¸å‰ç«¯ç”¨æˆ·ç•Œé¢å…ƒç´ çš„æ•°æ®è¡¨ç¤ºä¹‹é—´çš„æ¥å£ã€‚çŠ¶æ€å¯ä»¥ä½¿æ¥è‡ªä¸åŒç»„ä»¶çš„æ•°æ®ä¿æŒåŒæ­¥ï¼Œå› ä¸ºæ¯æ¬¡çŠ¶æ€æ›´æ–°éƒ½ä¼šå†æ¬¡å‘ˆç°æ‰€æœ‰ç›¸å…³ç»„ä»¶ã€‚çŠ¶æ€ç®¡ç†ä¹Ÿå¯ä»¥ä½œä¸ºä¸åŒç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ‰‹æ®µã€‚

![](img/4edf610548fe9c68d7ae67af920cda68.png)

åœ¨ Flutter ä¸­ï¼Œæœ‰ä¸€äº›ç®¡ç†çŠ¶æ€çš„é€‰é¡¹ï¼Œåœ¨ä¸‹é¢çš„é“¾æ¥ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ° Flutter å›¢é˜Ÿè‡ªå·±æ¨èçš„é‚£äº›ã€‚

[](https://flutter.dev/docs/development/data-and-backend/state-mgmt/options) [## çŠ¶æ€ç®¡ç†æ–¹æ³•åˆ—è¡¨

### çŠ¶æ€ç®¡ç†æ˜¯ä¸€ä¸ªå¤æ‚çš„è¯é¢˜ã€‚å¦‚æœä½ è§‰å¾—ä½ çš„ä¸€äº›é—®é¢˜æ²¡æœ‰å¾—åˆ°å›ç­”ï¼Œæˆ–è€…â€¦

é¢¤æŒ¯. dev](https://flutter.dev/docs/development/data-and-backend/state-mgmt/options) 

# å¼‚æ­¥å†—ä½™

å› ä¸ºæˆ‘å·²ç»ä½¿ç”¨è¿‡ Redux å’Œ Reactï¼Œæ‰€ä»¥æˆ‘å¯»æ‰¾ä¸€ä¸ªå…è®¸æˆ‘ä»¥åŒæ ·çš„â€œæ–¹å¼â€è¿›è¡Œå¼€å‘çš„åº“ï¼Œå› ä¸ºæˆ‘å·²ç»çŸ¥é“ Redux ä½œä¸ºçŠ¶æ€ç®¡ç†å™¨çš„å¼ºå¤§åŠŸèƒ½ã€‚æ‰€ä»¥ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªåä¸º Flutter Redux çš„åº“ï¼Œä½†å®ƒæœ‰å¾ˆå¤šæ ·æ¿æ–‡ä»¶ï¼Œæœ€ç»ˆè®©æˆ‘å¯»æ‰¾å¦ä¸€ä¸ªã€‚æˆ‘æœ€å–œæ¬¢çš„ä¸€ä¸ªå«åš Async Reduxï¼Œéå¸¸å®¹æ˜“ç†è§£å’Œå®ç°ï¼Œæœ‰å¾ˆå¤šç‰¹æ€§ï¼Œæ–‡æ¡£ä¹Ÿå¾ˆæ£’ï¼ç¥è´º Marcelo Glasberg çš„å‡ºè‰²å·¥ä½œï¼Œå¹¶æ„Ÿè°¢å¯¹è¿™ä¸ªåº”ç”¨ç¨‹åºçš„ä»£ç å®¡æŸ¥ï¼

![](img/20bfdcc008afd328e9bfe151d096010c.png)

# GraphQL

è¿™æ˜¯ä¸€ç§ç”±è„¸ä¹¦åœ¨ 2015 å¹´å¼€å‘å¹¶æ¨å‡ºçš„ API æŸ¥è¯¢è¯­è¨€ã€‚å…¶ä¸»è¦å·¥å…·æœ‰:æŸ¥è¯¢ã€å˜å¼‚å’Œè®¢é˜…ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åªä½¿ç”¨æŸ¥è¯¢å’Œçªå˜ã€‚

![](img/5bd9ffed4c4ff3deaa44cbe0aba47dbe.png)

2019 å¹´ 4 æœˆï¼Œæˆ‘åšäº†ä¸€ä¸ªå…³äºã€‚NET Architecture trailï¼Œåœ¨ FlorianÃ³polis çš„å¼€å‘è€…å¤§ä¼šä¸Šã€‚æˆ‘è°ˆåˆ°äº†å¦‚ä½•å‘å±•ç°æœ‰çš„ REST æ¶æ„ï¼Œå¹¶åœ¨ã€‚ç½‘èŠ¯ã€‚ä¸‹é¢æˆ‘ç¦»å¼€çŸ¥è¯†åº“:

[https://github.com/oguibueno/TDC2019](https://github.com/oguibueno/TDC2019)

# æŠŠæ‰‹ä¸¾èµ·æ¥ã€‚

é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼Œä¸šåŠ¡å’Œå®¢æˆ·åˆ†ç¦»ã€‚ä¸šåŠ¡æ‹¥æœ‰æˆ‘ä»¬çš„çŠ¶æ€ç®¡ç†å™¨å’Œå¯¹ API çš„è®¿é—®ï¼Œå®¢æˆ·ç«¯æ‹¥æœ‰æˆ‘ä»¬çš„å°éƒ¨ä»¶ï¼Œæ²¡æœ‰å¤ªå¤šçš„é€»è¾‘å’Œè€¦åˆã€‚

![](img/d918983d4fe68a5ffddb8b569c92e4c1.png)

ä½¿ç”¨å®ƒä»¬çš„åº“å¯ä»¥åœ¨**çš„ pubspec.yaml** æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚

> async _ redux:2 . 1 . 5
> graph QL:^2.1.0

é¦–å…ˆï¼Œæˆ‘ä»¬å°†åœ¨ main.dart åº”ç”¨ç¨‹åºçš„æ ¹ç›®å½•ä¸‹â€œæ’å…¥â€Async Reduxã€‚è¿™å°†ä½¿æˆ‘ä»¬çš„æ•´ä¸ªåº”ç”¨ç¨‹åºèƒ½å¤Ÿâ€œè®¿é—®â€æˆ‘ä»¬çŠ¶æ€çš„æ•°æ®ã€‚

![](img/b21c00f25c488a8ec6a211509fb82664.png)

ä¸»æ¡ç›®å°†æ˜¯**todo connector**ï¼Œå®ƒä½œä¸ºæˆ‘ä»¬çš„ **TodosPage** å’Œ **TodoModel** çš„ä¸€ç§â€œæ’ä»¶â€ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„**å°éƒ¨ä»¶**ä¸ä¾èµ–äºçŠ¶æ€ç®¡ç†å™¨ã€‚ä½¿æˆ‘ä»¬çš„ä»£ç æ›´åŠ å¹²å‡€å’Œæ¨¡å—åŒ–ã€‚

**AppState** æ˜¯ **Async Redux** çš„å…³é”®éƒ¨åˆ†ï¼Œå› ä¸ºåœ¨é‚£é‡Œæˆ‘ä»¬å¯ä»¥è®¿é—®å…³äºæˆ‘ä»¬çŠ¶æ€çš„ä¿¡æ¯ã€‚æ•´ä¸ªåº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ª **AppState** ã€‚

ç¬¬ 13 è¡Œå’Œç¬¬ 14 è¡Œçš„ **copy** æ–¹æ³•è´Ÿè´£ç”Ÿæˆæ–°çŠ¶æ€ï¼Œåœ¨æ–°æ—§çŠ¶æ€ä¹‹é—´è¿›è¡Œâ€œç£¨åˆâ€ã€‚ç¬¬ 16 è¡Œçš„
**todoList** ç”¨ç©ºçš„ **Todo** æ•°ç»„åˆå§‹åŒ–ã€‚

![](img/62425891e509b345b3ede8a7d14b9f7a.png)

è¿™æ˜¯ TodosPage å¯ä»¥åšçš„æ‰€æœ‰åŠ¨ä½œè¢«æ˜ å°„çš„åœ°æ–¹ï¼Œä»è€Œå°†å®ƒæ³¨å…¥åˆ°å®ƒçš„æ„é€ å‡½æ•°ä¸­ã€‚

![](img/c107ca0d38bc609d09c30d274eba5f59.png)

å¯¹äºæ‰“å¼€åº”ç”¨ç¨‹åºæ—¶åŒ…å«æ•°æ®çš„æ¸…å•ï¼Œæˆ‘ä»¬å°†åœ¨ç¬¬ä¸€æ¬¡æ„å»ºå°éƒ¨ä»¶æ—¶ä½¿ç”¨ **onInitialBuild** åœ¨ **GraphQL** API ä¸­æ‰§è¡ŒæŸ¥è¯¢ã€‚

æ­£æ˜¯åœ¨**to model**ä¸­ï¼Œæˆ‘ä»¬å°†å¿…è¦çš„åŠ¨ä½œæ˜ å°„åˆ° **dispatch** ã€‚å®ƒä¹Ÿè¢«æ˜ å°„åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­å…¬å¼€çš„æ•°æ®æ¥è‡ªæˆ‘ä»¬çš„çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º **todoList** çš„å±æ€§ï¼Œå®ƒæ˜¯ä»æ¥è‡ª Store() çš„ **state.todoList** å¡«å……çš„ã€‚**è°ƒåº¦**å’Œ**çŠ¶æ€**éƒ½æ˜¯ç”± **Async Redux** æœ¬èº«æ³¨å…¥çš„ï¼Œè¿™å¤§å¤§å‡å°‘äº†ä»£ç é‡ï¼Œä½¿å…¶æ›´åŠ å¹²å‡€æ˜“è¯»ã€‚

[](https://pub.dev/packages/async_redux#connector) [## async_redux | Flutter åŒ…

### Async Redux æ˜¯ Redux çš„ä¸€ä¸ªç‰¹æ®Šç‰ˆæœ¬ï¼Œå®ƒæ˜“äºå­¦ä¹ ï¼Œæ˜“äºä½¿ç”¨ï¼Œæ˜“äºæµ‹è¯•ï¼Œæ²¡æœ‰æ ·æ¿æ–‡ä»¶

å…¬å…±å¼€å‘](https://pub.dev/packages/async_redux#connector) ![](img/82dc608dd927151d23ec977d92158db7.png)

æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªå¼‚æ­¥çš„**ç¼©å‡å™¨**ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶å®šä¹‰ä¸º asyncã€‚æ—¢ç„¶å¯¹ **GraphQL** ç«¯ç‚¹çš„è°ƒç”¨æ˜¯ **Future** ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»**åœ¨ç¬¬ 29 è¡Œç­‰å¾…**è¿™ä¸ªå¤–éƒ¨æŸ¥è¯¢æ–¹æ³•ã€‚

[https://pub.dev/packages/async_redux#async-reducer](https://pub.dev/packages/async_redux#async-reducer)

![](img/a526f3ba9a08ff6acc0ca7f7aa4b8039.png)

**QueryOptions** æ˜¯ä¸€ä¸ªå‘é€åˆ° **GraphQL** çš„å¯¹è±¡ï¼Œåœ¨æœ¬ä¾‹ä¸­åŒ…å«ä¸€ä¸ªæŸ¥è¯¢ï¼Œä½äºç¬¬ 10 è¡Œã€‚

**GraphQLClientAPI** æ˜¯æˆ‘ä»¬ API çš„é…ç½®ï¼Œæˆ‘åœ¨ç¬¬ 7 è¡Œæ”¾äº† Android æ¨¡æ‹Ÿå™¨çš„ URLï¼Œåœ¨ç¬¬ 8 è¡Œæ”¾äº† iOS æ¨¡æ‹Ÿå™¨çš„ URLã€‚

![](img/46952f9958db1218b3e6ed83522375b9.png)

å¦‚æœè¯·æ±‚æ²¡æœ‰é”™è¯¯ï¼Œç»“æœè¢«è½¬æ¢æˆä¸€ä¸ªåˆ—è¡¨ï¼Œæ˜ å°„åˆ° **Todo** ç±»å‹ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ›´æ–°æˆ‘ä»¬çš„çŠ¶æ€ï¼Œç”Ÿæˆä¸€ä¸ª **state.copy** ã€‚

è¿™æ˜¯æˆ‘ä»¬çš„æ¨¡å‹ **Todo** ã€‚

![](img/f6143c0ecbfdb7a9fce9784f552670cb.png)

åœ¨è¯·æ±‚ API ä¹‹åï¼Œ**ç¼©å‡å™¨**å°†åˆ›å»ºä¸€ä¸ªå…·æœ‰æ–°çŠ¶æ€çš„æ–°å‰¯æœ¬ï¼Œå¹¶åœ¨å…¶ä¸­è¿›è¡Œæ›´æ”¹ã€‚å½“æˆ‘ä»¬çš„ **TodosPage** é€šè¿‡ **TodoModel** ä¸ **StoreConnector** ç›¸è¿æ¥ï¼Œå¹¶ä¸” **todoList** è¢«æ³¨å…¥åˆ° **TodosPage** çš„æ„é€ ä¸­æ—¶ï¼Œæˆ‘ä»¬ç”¨æ¥è‡ª API çš„æ•°æ®å¡«å…… ListViewï¼Œä»è€Œåœ¨ç¬¬ 31 è¡Œç»„è£…å¡ç‰‡ã€‚

> PS:å¦‚æœä¸æƒ³æ›´æ–°çŠ¶æ€ï¼Œå°±è¿”å› nullã€‚

![](img/277003e9ae2da8a87a55ee49a6e21b29.png)

æˆ‘ä»¬çš„ä¸»æ¸…å•å¦‚ä¸‹æ‰€ç¤º:

![](img/e2dab0021c1bac871d2a30e6396ad715.png)

**GraphQL** API æ˜¯ç”¨**èŠ‚ç‚¹**å’Œ **Express** æ„å»ºçš„ã€‚ä¸Šä¾‹æ‰€ç¤ºçš„ç«¯ç‚¹ï¼Œä½¿ç”¨äº†æŸ¥è¯¢æ‰€æœ‰åœ¨ ***æ¨¡å¼å†…*ä¸‹é¢çš„**ã€‚

![](img/e0c8e389c28146f549f56a7765a60e37.png)

åœ¨å®šä¹‰äº†**æ¨¡å¼**ä¹‹åï¼Œç¬¬ 45 è¡Œå®šä¹‰äº†æŸ¥è¯¢ï¼Œå®ƒæ¶ˆè€—äº† **todosMock** ï¼Œä¸€ä¸ªç”¨ 3 ä¸ªæ¡ç›®åˆå§‹åŒ–çš„æ•°ç»„ã€‚å®šä¹‰æ ¹ä¹‹åï¼Œå®ƒè¢«æ³¨å…¥åˆ° **Express** app ä¸­ï¼Œç„¶ååœ¨ç«¯å£ 4000 ä¸Šçš„ç«¯ç‚¹/graphql å¤„å…¬å¼€ã€‚

![](img/5e0ab2036754fa08cc81c9fb7debe547.png)

åœ¨ **GitHub** ä¸Šï¼Œä½ ä¼šæ‰¾åˆ°è¿™ä¸ªåº”ç”¨çš„å®Œæ•´ **CRUD** ã€‚

è°¢è°¢ï¼

ç‰¹åˆ«æ„Ÿè°¢[Marcelo Glasberg](https://medium.com/u/c2db527bc802?source=post_page-----7c0db2e4d2be--------------------------------),[**Async Redux**](https://pub.dev/packages/async_redux)çš„åˆ›é€ è€…ï¼Œä»–éå¸¸ç»†å¿ƒï¼Œå¹¶äº²è‡ªå®¡é˜…äº†æœ¬å‡ºç‰ˆç‰©ä¸­æ˜¾ç¤ºçš„é¢¤æŒ¯ä»£ç ã€‚

# å¼€æºä»£ç åº“

[é¢¤æŒ¯åº”ç”¨åº“](https://github.com/oguibueno/flutter_redux_graphql)

[å¸¦ GraphQL çš„èŠ‚ç‚¹ API åº“](https://github.com/oguibueno/node_graphql)

# è”ç³»äºº

[é¢†è‹±](https://www.linkedin.com/in/oguibueno/)

[æ¨ç‰¹](https://twitter.com/oguibueno)

# æœ‰ç”¨çš„é“¾æ¥

[](https://www.freecodecamp.org/news/an-introduction-to-flutter-the-basics-9fe541fd39e2/) [## é¢¤æŒ¯ä»‹ç»:åŸºç¡€çŸ¥è¯†

### æ–¯å¦å°¼æ–¯æ‹‰å¤«Â·ç‰¹è«è¨ã€Šé¢¤æŒ¯å…¥é—¨:åŸºç¡€çŸ¥è¯†ã€‹æˆ‘ä¸€ç›´å¬è¯´é¢¤æŒ¯æœ‰å¤šç¥å¥‡ï¼Œæˆ‘â€¦

www.freecodecamp.org](https://www.freecodecamp.org/news/an-introduction-to-flutter-the-basics-9fe541fd39e2/) [](https://flutter.dev/docs/development/data-and-backend/state-mgmt/intro) [## çŠ¶æ€ç®¡ç†

### æ–‡æ¡£å¼€å‘æ•°æ®å’Œåç«¯çŠ¶æ€ç®¡ç†çŠ¶æ€ç®¡ç†å¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰â€¦

é¢¤æŒ¯. dev](https://flutter.dev/docs/development/data-and-backend/state-mgmt/intro) [](https://flutter.dev/docs/development/data-and-backend/state-mgmt/simple) [## ç®€å•çš„åº”ç”¨çŠ¶æ€ç®¡ç†

### ç°åœ¨ï¼Œæ‚¨å·²ç»äº†è§£äº†å£°æ˜å¼ UI ç¼–ç¨‹ä»¥åŠæš‚æ—¶çŠ¶æ€å’Œåº”ç”¨ç¨‹åºçŠ¶æ€ä¹‹é—´çš„åŒºåˆ«ï¼Œæ‚¨å·²ç»å‡†å¤‡å¥½â€¦

é¢¤æŒ¯. dev](https://flutter.dev/docs/development/data-and-backend/state-mgmt/simple) [](https://medium.com/flutterando/async-redux-pt-brasil-e783ceb13c43) [## AsyncRedux para é¢¤æŒ¯:O Redux sem æ ·æ¿

### ç‰¹åˆ«æ˜¯å¯¹äºçˆ¶æ¯ã€å­©å­ã€çˆ¶æ¯æ¥è¯´ã€‚

medium.com](https://medium.com/flutterando/async-redux-pt-brasil-e783ceb13c43) [](https://graphql.org/) [## GraphQL:ä¸€ç§ API æŸ¥è¯¢è¯­è¨€ã€‚

### å­¦ä¹ å‡†åˆ™ç¤¾åŒºè§„èŒƒè¡Œä¸ºå‡†åˆ™åŸºé‡‘ä¼šæ™¯è§‚å­¦ä¹ å‡†åˆ™ç¤¾åŒºè§„èŒƒè¡Œä¸ºå‡†åˆ™åŸºé‡‘ä¼šâ€¦

graphql.org](https://graphql.org/) [](https://medium.com/codingthesmartway-com-blog/creating-a-graphql-server-with-node-js-and-express-f6dddc5320e1) [## ä½¿ç”¨ Node.js å’Œ Express åˆ›å»º GraphQL æœåŠ¡å™¨

### è¿™ç¯‡æ–‡ç« é¦–å…ˆåœ¨ CodingTheSmartWay.com ä¸Šå‘è¡¨ã€‚

medium.com](https://medium.com/codingthesmartway-com-blog/creating-a-graphql-server-with-node-js-and-express-f6dddc5320e1)