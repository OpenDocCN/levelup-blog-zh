<html>
<head>
<title>Deploying a React application in Nginx server in AWS EC2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS EC2的Nginx服务器中部署React应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploying-react-application-in-nginx-server-in-aws-ec2-6512ff71593b?source=collection_archive---------1-----------------------#2020-09-27">https://levelup.gitconnected.com/deploying-react-application-in-nginx-server-in-aws-ec2-6512ff71593b?source=collection_archive---------1-----------------------#2020-09-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/098a47e5fb8a655f9f96f1f2ec158ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*52p5uOe468JFIJiiMQXw7g.jpeg"/></div></div></figure><p id="64e6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">本教程将指导您使用Bitbucket管道在<code class="fe kz la lb lc b">AWS EC2</code>的<code class="fe kz la lb lc b">Nginx</code>服务器中部署一个React web应用程序。</p><h1 id="98a3" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">要开始，你需要以下东西:</h1><ol class=""><li id="d5b2" class="mb mc it kd b ke md ki me km mf kq mg ku mh ky mi mj mk ml bi translated">Bitbucket帐户(免费计划是可以的)</li><li id="3f85" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">AWS帐户</li><li id="4c3a" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">安装了<code class="fe kz la lb lc b">Nginx</code>的AWS EC2实例</li><li id="5d55" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">对EC2实例的SSH访问</li><li id="496c" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">很明显，Git的基础知识</li></ol><h1 id="116f" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><strong class="ak">我们开始吧。</strong></h1><ul class=""><li id="c18c" class="mb mc it kd b ke md ki me km mf kq mg ku mh ky mr mj mk ml bi translated">创建一个新的React应用程序，并通过创建一个新的存储库将代码推入Bitbucket。(或者，您可以使用现有的React应用程序存储库)</li><li id="c43b" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mr mj mk ml bi translated">转到存储库设置</li></ul><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/d92a79f2780cd24aa1df847d79e6f39e.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*a2CbYKVQ6Sq4N2EMmY2FBQ.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">比特桶菜单</figcaption></figure><ul class=""><li id="87b9" class="mb mc it kd b ke kf ki kj km nb kq nc ku nd ky mr mj mk ml bi translated">向下滚动到<strong class="kd iu">管道</strong>然后点击<code class="fe kz la lb lc b">Settings</code>和<strong class="kd iu">启用管道</strong></li></ul><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/9cc49d90f36125c85e5e8c9197776bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*t_46wRkm8u_xvIU9eCEpxw.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">位桶管道设置</figcaption></figure><ul class=""><li id="3eee" class="mb mc it kd b ke kf ki kj km nb kq nc ku nd ky mr mj mk ml bi translated">点击<code class="fe kz la lb lc b">Configure bitbucket-pipelines.yml</code></li></ul><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/18c88d78c0e2a8b7b5218be5f1cb9d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*v9TTUQ_sZTsk1lzebOr3zA.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">位桶管道配置</figcaption></figure><p id="67a4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">选择<code class="fe kz la lb lc b">JavaScript</code>。您可以暂时保留默认配置，然后单击按钮<strong class="kd iu">提交文件</strong>。这将在项目根目录下创建<code class="fe kz la lb lc b">bitbucket-pipelines.yml</code>文件。</p><ul class=""><li id="11fb" class="mb mc it kd b ke kf ki kj km nb kq nc ku nd ky mr mj mk ml bi translated">再次转到存储库设置，然后单击<code class="fe kz la lb lc b">SSH Keys</code></li></ul><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/581cb8cc1879ea133e1b32f007b65076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*WK0i7vAEFxsy4NU2-e-dOw.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">位桶管道SSH密钥</figcaption></figure><p id="e0d5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">点击<strong class="kd iu">生成密钥。你将得到一个屏蔽的私钥和公钥。</strong></p><p id="46b7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<strong class="kd iu">已知主机中，</strong>添加主机地址(您托管React应用程序的EC2实例的IP地址)并点击<strong class="kd iu">获取指纹。</strong>获取指纹后点击<strong class="kd iu">添加主机。您的最终设置应该是这样的:</strong></p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ed33022e348911437044c38cc2e5a277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*H8vLPbka5JIDJN9orOFpig.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">位桶管道SSH密钥</figcaption></figure><ul class=""><li id="432b" class="mb mc it kd b ke kf ki kj km nb kq nc ku nd ky mr mj mk ml bi translated">现在使用SSH连接到托管服务器并复制<code class="fe kz la lb lc b">~/.ssh/authorized_keys</code>中的public above密钥。如果该文件中有其他公钥，只需将公钥复制粘贴到底部并保存即可。</li><li id="5d9c" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mr mj mk ml bi translated">是时候写一些管道代码了。转到位于存储库根文件夹中的<code class="fe kz la lb lc b">bitbucket-pipelines.yml</code>文件。将该文件的内容更改为以下内容:</li></ul><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="b9e2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">上述配置代码只能用于分支<code class="fe kz la lb lc b">master</code>和<code class="fe kz la lb lc b">staging</code>。如果您想让它对所有分支都可用，您可以简单地删除分支步骤。</p><p id="fddf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有四个步骤:</p><ol class=""><li id="9fac" class="mb mc it kd b ke kf ki kj km nb kq nc ku nd ky mi mj mk ml bi translated">什么都不做-&gt;位桶管道要求第一步在提交后自动发生。由于我是手动触发每个步骤，这是必需的。如果您想在提交后自动执行所有操作，请移除该步骤，并从其他步骤中远程执行<code class="fe kz la lb lc b">trigger:manual</code>。</li><li id="472a" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">构建React应用-&gt;这一步将运行所有必要的步骤来构建React应用。它还缓存节点模块以加快构建过程(如果没有添加新的依赖项)。为构建的每一步从互联网上重新下载依赖项会花费很多时间。所以，下载并存储在Bitbucket服务器中是很好的。这是在按位存储桶自动添加缓存步骤时完成的。</li><li id="c344" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">在Staging中部署-&gt;这个步骤将复制在步骤2中生成的构建工件。到您在此步骤中指定的文件夹。确保更换<code class="fe kz la lb lc b">{{EC2-USER}}, {{EC2-IP}} and {{Build folder path}}</code>。</li><li id="5515" class="mb mc it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">在生产中部署-&gt;这个步骤将复制在步骤2中生成的构建工件。到您在此步骤中指定的文件夹。确保更换<code class="fe kz la lb lc b">{{EC2-USER}}, {{EC2-IP}} and {{Build folder path}}</code>。</li></ol><p id="3033" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">第3步和第4步类似，如果您不需要在每次提交时都部署到两个服务器，那么您可以删除最后一步。</p><p id="485f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">关于如何编写位桶管道配置的更多信息，你可以查看文档<a class="ae nh" href="https://support.atlassian.com/bitbucket-cloud/docs/configure-bitbucket-pipelinesyml/" rel="noopener ugc nofollow" target="_blank">这里</a>。您可以使用位存储库变量来存储服务器IP、用户名和其他敏感信息。</p><ul class=""><li id="9ee1" class="mb mc it kd b ke kf ki kj km nb kq nc ku nd ky mr mj mk ml bi translated">运行管道</li></ul><p id="944f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当您成功提交时，您可以在UI的右侧看到一个绿色勾号，在您单击它之后，它会将您带到部署屏幕。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/d0fc5fe7cc8ee6b7a7677034814530f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LA_ufZJ_ubHEZRm-fDz2Dg.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">Bitbucket提交UI</figcaption></figure><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/8da94c6c3ab9a6a652a4b340cfe32781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Xpl53Y5_RwWbUOBAyXjvQ.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">位桶管道UI</figcaption></figure><p id="968d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在可以手动点击<code class="fe kz la lb lc b">Run</code>和<code class="fe kz la lb lc b">Deploy</code>按钮。完成后，您可以检查您的React web应用程序是否更新。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="0920" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你使用的是免费的Bitbucket账户，你可以在这里找到一些限制<a class="ae nh" href="https://support.atlassian.com/bitbucket-cloud/docs/limitations-of-bitbucket-pipelines/" rel="noopener ugc nofollow" target="_blank"/>。您将每月获得50分钟的构建时间，这对于学习目的和不太频繁变化的应用程序来说已经足够了。</p><p id="5c20" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您想了解更多关于管道状态的信息，您可以在这里找到<a class="ae nh" href="https://support.atlassian.com/bitbucket-cloud/docs/view-your-pipeline/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="9baa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您有任何问题，请留下评论。</p></div></div>    
</body>
</html>