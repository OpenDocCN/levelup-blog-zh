<html>
<head>
<title>What’s on the News? — Web scraping and analyzing publications from Radio Okapi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新闻上有什么？—网上搜集和分析来自霍加皮电台的出版物</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/whats-on-the-news-732a275e3a3e?source=collection_archive---------9-----------------------#2022-08-30">https://levelup.gitconnected.com/whats-on-the-news-732a275e3a3e?source=collection_archive---------9-----------------------#2022-08-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8e86f0aa849a5f373cbc92d1563b3931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eG-fzTumok8fkdYn9MiGIQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">brotiN biswaS 拍摄的照片</figcaption></figure><p id="83c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新闻上有什么？如果你经常离开房间或查看早间新闻，你可以很容易地回答这个问题。一个更有趣的问题是，不要用“是”来指最近的新闻，而是用一个更宽泛的时间框架来表述这个问题。新闻里有什么？或者，更准确地说，过去10年或20年的新闻是什么？</p><p id="2aef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">媒体对我们如何看待世界有着重大影响。不仅仅是最新的新闻，对“新闻上的是什么<strong class="kf ir">”的回答也是我们成长过程中接触到的媒体。在某种程度上，你最喜欢的足球队或你的政治立场可能根植于你从年轻时就开始主动或被动参与的更广泛的连续叙事。一条条新闻叠加在一起，构成了一本完整的故事书，而故事的创作过程逐渐消失在过去，赋予了故事更多的生命，仿佛它们永远属于现在。</strong></p><p id="4f0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们能回答一个比“新闻上的是什么<strong class="kf ir">”更宽泛的问题吗。我们可以用“新闻上的<strong class="kf ir">是什么</strong>的形式来回答这个问题吗？”</strong></p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="852f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将探讨这个话题，重点关注刚果民主共和国当地媒体——联合国驻刚果(金)稳定特派团Okapi电台撰写的文章。联合国驻刚果(金)稳定特派团是一支联合国维和部队，自1999年以来一直试图在刚果民主共和国东部维持和平。虽然他们的存在值得质疑，但由于我们似乎没有在刚果民主共和国东部保持太多的和平，冲突持续了20多年，本文将重点分析他们新闻网站的内容。我们将从获取数据集的过程转向一些高层次的见解。在下一篇文章中，我们将使用NLP(自然语言处理)技术更深入地研究文章的内容。如你所料，网站是法语的；本文中的一些关键词被翻译成英文。</p><h1 id="bfa3" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak">获取数据集:网页抓取</strong></h1><p id="a922" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">霍加皮电台没有他们文章的公共数据集，更没有查询他们数据的api。我们将刮网站，但首先，我们需要分析它，并计划我们将如何去做。</p><p id="9222" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从他们的news feed <em class="li"> /actualite </em>(图1)中，他们对页面进行了分页，每页显示10篇文章(不考虑设计)。通过传递<a class="ae kc" href="https://www.w3schools.com/tags/ref_httpmethods.asp" rel="noopener ugc nofollow" target="_blank"> GET请求</a>上的页码来获取每个页面，比如:<em class="li"> /actualite？page= &lt; PAGE_NUMBER &gt; </em>，其中<em class="li"> PAGE_NUMBER </em>截止到2022年8月，范围为0到9059。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/da03c11f1a8eb7f0f022d5f96ecb7296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZHAUa0fPuAdeHDepKblvgA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图1-来自https://www.radiookapi.net/actualite?page=0<a class="ae kc" href="https://www.radiookapi.net/actualite?page=0" rel="noopener ugc nofollow" target="_blank">Okapi电台</a>的截图</figcaption></figure><p id="eef8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由此，我们知道我们看到的是9060页，每一页有10篇文章。那可是<strong class="kf ir"> 90 600 </strong>篇文章。我们知道如何形成每个页面的URL，从它们那里，我们可以得到每篇文章的URL和标题。</p><p id="64ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用<a class="ae kc" href="https://pypi.org/project/grequests/" rel="noopener ugc nofollow" target="_blank"> <em class="li"> grequests </em> </a>，这是一个用于生成异步<a class="ae kc" href="https://rapidapi.com/blog/api-glossary/http-request-methods/" rel="noopener ugc nofollow" target="_blank"> HTTP请求</a>的python包。虽然异步运行多个请求可以极大地节省时间，但是我们会受到运行任务的计算机内存以及目标网站响应多个请求的能力的限制。我们应该考虑到我们抓取的网站是为其他用户服务的，我们不应该为我们的网页抓取工作占用太多的带宽。在我们的例子中，我们将一次生成1 000个，处理结果，并重复这两个步骤，直到覆盖90 600页。那将做十次重复或十批。事实上，如果我们没有网络限制，我们可以并行运行这十个批处理，就像我们在这里对<a class="ae kc" href="https://blog.devgenius.io/brute-force-attack-can-you-guess-the-password-c7945d6973ae" rel="noopener ugc nofollow" target="_blank">密码暴力工作负载</a>所做的那样。</p><p id="e033" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管如此，在网络限制上，我们将把<a class="ae kc" href="https://urllib3.readthedocs.io/en/latest/reference/urllib3.util.html#module-urllib3.util.retry" rel="noopener ugc nofollow" target="_blank">补偿因子</a>设置为1。在与网络相关的响应失败后，backoff参数会延迟后续请求。退避因子为1时，在第一次响应失败后，将有1秒的等待时间，然后是2、4、8、16、32……遵循来自<a class="ae kc" href="https://urllib3.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> urllib3 </a>的退避策略:</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="4c8f" class="mw lk iq ms b gy mx my l mz na">{backoff factor} * (2 ** ({number of total retries} - 1))</span></pre><p id="9c09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">值得注意的是，一些网站会阻止IP地址发送过多的HTTP请求。在您自己的计算机上运行工作负载之前，您可能希望在评估目标网站时包括该详细信息。</p><p id="dcf8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">查看日志(图2)，对于每1000个页面，HTTP请求(从网站获取数据)花费大约6分钟，解析并在GCP上保存数据花费大约1分30秒。这些数字不能作为基准，因为运行环境不是孤立的。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图2 —创建时带有<a class="ae kc" href="https://flourish.studio" rel="noopener ugc nofollow" target="_blank">花饰。工作室</a></figcaption></figure><p id="e361" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总的来说，整个过程用了1小时16分钟，HTTP请求用了1小时，解析和保存数据集用了16分钟。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nd nc l"/></div></figure><p id="1916" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们有10个数据集，包含内容、链接和为90k页解析的文章数量，还有10个数据集，包含每篇文章的链接和标题。第一个数据集包含了每个页面的全部内容，所以如果有一部分网站内容需要进一步分析，我们可以返回到这个数据集。现在，我们将关注文件集，即<em class="li"> articles_{batch}。拼花地板</em>。</p><p id="0bf3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管我们预计<strong class="kf ir">会有90 600篇文章</strong>，但在探索数据集时，我发现<strong class="kf ir">有71篇</strong>文章有相同的标题和链接，还有<strong class="kf ir"> 2 871篇</strong>文章有相同的标题和发表日期。最后，我们有从2004年到2022年8月发表的<strong class="kf ir"> 87 213 </strong>篇独特的文章。</p><p id="66c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这里，我们已经可以回答这样的问题，他们每年有多少出版物？或者，从我们最初的谈话中，他们为我们宏大的故事书贡献了多少故事——假设我们一直在阅读他们的故事？</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图3 —使用<a class="ae kc" href="https://flourish.studio" rel="noopener ugc nofollow" target="_blank">花饰创建。工作室</a></figcaption></figure><p id="5425" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这里，我们可以质疑为什么我们在2008-2009年和2015-2018年有下降趋势，或者仔细看看月度出版物。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图4 —用<a class="ae kc" href="https://flourish.studio" rel="noopener ugc nofollow" target="_blank">花饰创建。工作室</a></figcaption></figure><p id="b07e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从图4中，我们可以看到随着时间的推移，发布数量有了更多的变化。抛开网站上线后的头几个月，我们可以猜测重大事件可能发生在特定的选择上。例如，2006年7月发表的文章只有5篇，恰好是选举时期。</p><p id="af6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管如此，在不分析文章内容的情况下，我们可以从URL(图5)中查看排名靠前的出版物类别。我们有我们的前5个类别:新闻、未分类、社会、政治和安全，不包括其他类别，这是几个出版物类别的集合。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图5 —创建时带有<a class="ae kc" href="https://flourish.studio" rel="noopener ugc nofollow" target="_blank">花饰。工作室</a></figcaption></figure><p id="0017" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以使用数据集上的链接来获取网站内容。同样，在这里，我们需要检查网站结构，看看在哪里可以获得具体的信息，如文章内容、标题和发表日期。图6用红色突出显示了我们要瞄准的数据点。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/f8da2c47a956b88180c73bb726436ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y56d2gDigEwhNYaNkMaR2g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图6 —来自【Okapi电台的截图</figcaption></figure><p id="a3be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在分析网站的HTML代码后，我们看到标题始终是H1，出版和修改日期部分是第一个DIV，包含类'<em class="li">窗格-内容'</em>，最后，内容是第一个DIV，包含类'<em class="li">字段</em>。除了目标数据点之外，我们还将保存每个页面的完整HTML代码，以便将来进行潜在的分析，或者作为安全备份，以防某些页面不符合我们确定的模式。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nd nc l"/></div></figure><p id="606c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个花了大约6个小时在云上运行。它无法从并行化中受益，因为网站网络的限制，它只能在多个节点上运行。这6个小时并没有太大的伤害，因为我晚上运行它，早上检查状态。</p><p id="08d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了这些内容(我们接下来将在NLP分析中使用),我们已经可以查看一些高级统计数据了。从图7中，我们可以看到他们的文章长度随着时间的推移发生了相当大的变化。我们的平均长度是275个单词，从第25百分位的164个单词到第75百分位的329个单词。</p><figure class="mn mo mp mq gt jr"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图7——用<a class="ae kc" href="https://flourish.studio" rel="noopener ugc nofollow" target="_blank">创造的繁荣。工作室</a></figcaption></figure><p id="75f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接近尾声时，我们回顾了如何废弃我们的目标网站来获取数据，并运行了一些探索性分析来深入了解我们的数据集。在这些见解的指导下，我们将进入下面的文章，以分析文章内容，探索诸如所涵盖的主要主题、语气、表达的情感等见解，并可能以文章内容和类别为特征训练一个人工智能模型。在那之前，你对媒体有什么经验？你认为这会如何影响你对世界的看法？请在评论中告诉我们！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="4512" class="lj lk iq bd ll lm nf lo lp lq ng ls lt lu nh lw lx ly ni ma mb mc nj me mf mg bi translated">分级编码</h1><p id="b9af" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="db78" class="nk nl iq kf b kg kh kk kl ko nm ks nn kw no la np nq nr ns bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="5db4" class="nk nl iq kf b kg nt kk nu ko nv ks nw kw nx la np nq nr ns bi translated">📰查看<a class="ae kc" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="59c7" class="nk nl iq kf b kg nt kk nu ko nv ks nw kw nx la np nq nr ns bi translated">🔔关注我们:<a class="ae kc" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kc" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kc" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="46e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">🚀👉<a class="ae kc" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>