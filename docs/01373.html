<html>
<head>
<title>Create an NPM module with TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用TypeScript创建NPM模块</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-a-npm-module-with-typescript-c99bd0686f69?source=collection_archive---------0-----------------------#2019-12-19">https://levelup.gitconnected.com/create-a-npm-module-with-typescript-c99bd0686f69?source=collection_archive---------0-----------------------#2019-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/297f491baa813d55553b9bfc4e482648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yMvbTrnWscTj0H_yqy4RpQ.jpeg"/></div></div></figure><p id="c405" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">创建一个NPM模块，无论是公共的还是私有的，都不是一件困难的事情，但是肯定会有点乏味。</p><p id="7b6e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这篇文章是一个快速引导NPM模块的指南，包含一组需求:</p><ul class=""><li id="7070" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">TypeScript转换到ES5和ES6:使用TypeScript和Rollup</li><li id="49a1" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">测试:使用Jest</li><li id="e3b6" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">林挺:通过标准</li><li id="64c7" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">格式:更漂亮</li></ul><h1 id="581e" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">1.创建文件夹</h1><p id="0f59" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">使用模块的名称。</p><p id="0b04" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="mq">如果您选择的名称已经被使用，您可以使用NPM范围(</em><a class="ae mr" href="https://docs.npmjs.com/about-scopes" rel="noopener ugc nofollow" target="_blank"><em class="mq">https://docs.npmjs.com/about-scopes</em></a><em class="mq">)</em></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="6e59" class="nb lo it mx b gy nc nd l ne nf">$ mkdir my-module<br/>$ cd my-module</span></pre><h1 id="3e9a" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">2.创建package.json文件</h1><p id="1472" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated"><code class="fe ng nh ni mx b">package.json</code>文件是NPM模块上的主文件。它包括所有相关信息:名称、许可证、主文件、依赖项、配置等。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="9910" class="nb lo it mx b gy nc nd l ne nf">$ npm init -y</span><span id="9683" class="nb lo it mx b gy nj nd l ne nf">{<br/>  "name": "my-module",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="e861" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于限定了作用域的模块，将作用域作为参数添加:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="ef73" class="nb lo it mx b gy nc nd l ne nf">$ npm init --scope=@my-org -y</span></pre><h1 id="6ab7" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">3.源文件夹</h1><p id="c4a7" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">创建源文件夹:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="c57d" class="nb lo it mx b gy nc nd l ne nf">$ mkdir src</span></pre><p id="57b7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">和一个保存简单的<code class="fe ng nh ni mx b">sum</code>函数的文件:</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="nk nl l"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">src/索引. ts</figcaption></figure><p id="9436" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe ng nh ni mx b">sum</code>函数是使用TypeScript键入的。</p><h1 id="8ddc" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">4.蒸腾作用</h1><p id="5f3d" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">首先，安装所有的开发依赖项。当其他人使用你的模块时，这些依赖项不会被安装。这样做的目的是支持transpilation工具将TypeScript转换为常规JavaScript。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="2168" class="nb lo it mx b gy nc nd l ne nf">$ yarn add --dev <strong class="mx iu">typescript rollup rollup-plugin-commonjs rollup-plugin-node-resolve rollup-plugin-peer-deps-external rollup-plugin-typescript2</strong></span></pre><h2 id="7667" class="nb lo it bd lp nq nr dn lt ns nt dp lx km nu nv mb kq nw nx mf ku ny nz mj oa bi translated">类型脚本配置</h2><p id="ee48" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">创建一个<code class="fe ng nh ni mx b">tsconfig.json</code>文件:该文件保存TypeScript配置。它应该位于根文件夹中。</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="nk nl l"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">tsconfig.json</figcaption></figure><h2 id="4278" class="nb lo it bd lp nq nr dn lt ns nt dp lx km nu nv mb kq nw nx mf ku ny nz mj oa bi translated">编译配置</h2><p id="aeed" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">接下来，创建一个<code class="fe ng nh ni mx b">rollup.config.js</code>文件:这个文件保存汇总配置。</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="nk nl l"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">rollup .配置. js</figcaption></figure><p id="c03a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，将<code class="fe ng nh ni mx b">package.json</code>上的构建脚本以及<code class="fe ng nh ni mx b">main</code>、<code class="fe ng nh ni mx b">module</code>和<code class="fe ng nh ni mx b">jsnext:main</code>属性添加到期望的输出中。</p><p id="15b4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="mq">这3个属性帮助应用程序在它们的构建管道上使用你的模块集成:</em> <code class="fe ng nh ni mx b"><em class="mq">build/index.js</em></code> <em class="mq">是ES5版本，</em> <code class="fe ng nh ni mx b"><em class="mq">build/index.es.js</em></code> <em class="mq">是支持导入/导出模块规范的ES6版本。</em></p><p id="6e74" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe ng nh ni mx b">files</code>属性表示当你的包作为一个依赖项安装时要包含的文件/文件夹条目(<a class="ae mr" href="https://docs.npmjs.com/files/package.json#files" rel="noopener ugc nofollow" target="_blank">https://docs.npmjs.com/files/package.json#files</a>)</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="b94a" class="nb lo it mx b gy nc nd l ne nf">{<br/>  "name": "my-module",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  <strong class="mx iu">"main"</strong>: <strong class="mx iu">"build/index.js"</strong>,<br/>  <strong class="mx iu">"module"</strong>: <strong class="mx iu">"build/index.es.js"</strong>,<br/>  <strong class="mx iu">"jsnext:main"</strong>: <strong class="mx iu">"build/index.es.js"</strong>,<br/>  "scripts": {<br/>    <strong class="mx iu">"build"</strong>: <strong class="mx iu">"rollup -c"</strong>,<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  <strong class="mx iu">"files"</strong>: [<br/>    <strong class="mx iu">"build"<br/>  </strong>],<br/>  "devDependencies": {<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "typescript": "^3.7.3"<br/>  },  <br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="5de1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此时，我们可以构建我们的模块:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="01c1" class="nb lo it mx b gy nc nd l ne nf">$ yarn build<br/>yarn run v1.17.3<br/>$ rollup -c</span><span id="2dc9" class="nb lo it mx b gy nj nd l ne nf">src/index.ts → build/index.js, build/index.es.js...<br/>created build/index.js, build/index.es.js in 828ms<br/>✨  Done in 1.32s.</span></pre><p id="72ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">检查<code class="fe ng nh ni mx b">build</code>文件夹，在那里你会有:</p><ul class=""><li id="5dc5" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated"><strong class="kd iu">index . js</strong>:ES5 trans pilation(附源图)</li><li id="3aae" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated"><strong class="kd iu">index . es . js</strong>:ES6 trans pilation(带源地图)</li><li id="165b" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated"><strong class="kd iu"> index.d.ts </strong>:打字稿打字</li></ul><h1 id="7900" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">5.试验</h1><p id="0e29" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">一个经过良好测试的模块对于可重用性是必不可少的。</p><p id="daef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请将此添加到您的所有模块中。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d304" class="nb lo it mx b gy nc nd l ne nf">$ yarn add --dev <strong class="mx iu">jest @types/jest ts-jest</strong></span></pre><p id="449c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">修改您的<code class="fe ng nh ni mx b">package.json</code>文件以包括:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="7756" class="nb lo it mx b gy nc nd l ne nf">{<br/>  "name": "my-module",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "build/index.js",<br/>  "module": "build/index.es.js",<br/>  "jsnext:main": "build/index.es.js",<br/>  "scripts": {<br/>    "build": "rollup -c",<br/>    <strong class="mx iu">"test": "jest --coverage"</strong><br/>  },<br/>  "files": [<br/>    "build"<br/>  ],<br/>  "devDependencies": {<br/>    "@types/jest": "^24.0.24",<br/>    "jest": "^24.9.0",<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "ts-jest": "^24.2.0",<br/>    "typescript": "^3.7.3"<br/>  },<br/>  <strong class="mx iu">"jest"</strong>: {<br/>    <strong class="mx iu">"preset"</strong>: <strong class="mx iu">"ts-jest"</strong>,<br/>    <strong class="mx iu">"testEnvironment"</strong>: <strong class="mx iu">"node"<br/>  </strong>},  <br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="393b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">并创建一个测试。默认情况下，我们可以在与代码放在一起的<code class="fe ng nh ni mx b">__tests__</code>文件夹中创建测试。我们将把这第一次测试放在<code class="fe ng nh ni mx b">src/__tests__/index.spec.ts</code>文件中。</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="nk nl l"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">src/__tests__/index.spec.ts</figcaption></figure><p id="bd37" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">运行测试:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="b8cc" class="nb lo it mx b gy nc nd l ne nf">$ yarn test<br/>yarn run v1.17.3<br/>$ jest --coverage<br/> PASS  src/__test__/index.spec.ts<br/>  ✓ Sum 4 + 5 = 9 (3ms)</span><span id="e5d1" class="nb lo it mx b gy nj nd l ne nf">----------|----------|----------|----------|----------|-------------------|<br/>File      |  % Stmts | % Branch |  % Funcs |  % Lines | Uncovered Line #s |<br/>----------|----------|----------|----------|----------|-------------------|<br/>All files |      100 |      100 |      100 |      100 |                   |<br/>index.ts |      100 |      100 |      100 |      100 |                   |<br/>----------|----------|----------|----------|----------|-------------------|<br/>Test Suites: 1 passed, 1 total<br/>Tests:       1 passed, 1 total<br/>Snapshots:   0 total<br/>Time:        1.53s<br/>Ran all test suites.<br/>✨  Done in 2.22s.</span></pre><p id="b50f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">耶！100%的覆盖率，在覆盖率的话题中，我会建议你做一些研究，并适应期望。</p><p id="9f9e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">通过打开在<code class="fe ng nh ni mx b">coverage/</code>文件夹中生成的覆盖率报告，您可以直观地检查代码中被覆盖和未被覆盖的部分。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="13bc" class="nb lo it mx b gy nc nd l ne nf">$ open coverage/lcov-report/index.html</span></pre><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/da6cdf0ce519475ecc7d8b444bd80924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PosoHw1ZCnQk7E9K7wDazg.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">覆盖率报告</figcaption></figure><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/bdb59ba62f40c7c4a5bdfa1b87e51b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AMiwn-QCT2YyjG5j3HkyQQ.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">测试覆盖的行</figcaption></figure><h1 id="8226" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">6.林挺</h1><p id="d020" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">林挺是运行一个程序来检查你的代码是否有潜在错误的过程。代码规则和指导方针用于保证开发人员不会意外出错。出现了几个规则集，其中大部分是基于ESLint(<a class="ae mr" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank">https://eslint.org/</a>)的</p><p id="6875" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我将使用的是standard js(<a class="ae mr" href="https://standardjs.com/" rel="noopener ugc nofollow" target="_blank">https://standardjs.com/</a>)。这是一个零配置的静态规则集。</p><p id="049b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">StandardJS上唯一有争议的规则是“无分号”规则。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="7314" class="nb lo it mx b gy nc nd l ne nf">$ yarn add --dev <strong class="mx iu">standard</strong></span></pre><p id="3da9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">修改你的<code class="fe ng nh ni mx b">package.json</code>文件，包括一个忽略某些文件夹和林挺脚本的部分。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="945c" class="nb lo it mx b gy nc nd l ne nf">{<br/>  "name": "my-module",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "build/index.js",<br/>  "module": "build/index.es.js",<br/>  "jsnext:main": "build/index.es.js",<br/>  "scripts": {<br/>    "build": "rollup -c",<br/>    <strong class="mx iu">"lint"</strong>: <strong class="mx iu">"standard"</strong>,<br/>    "test": "jest --coverage"<br/>  },<br/>  "files": [<br/>    "build"<br/>  ],<br/>  "devDependencies": {<br/>    "@types/jest": "^24.0.24",<br/>    "jest": "^24.9.0",<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "standard": "^14.3.1",<br/>    "ts-jest": "^24.2.0",<br/>    "typescript": "^3.7.3"<br/>  },<br/>  "jest": {<br/>    "preset": "ts-jest",<br/>    "testEnvironment": "node"<br/>  },<br/>  <strong class="mx iu">"standard"</strong>: {<br/>    <strong class="mx iu">"ignore"</strong>: [<br/>      <strong class="mx iu">"node_modules/"</strong>,<br/>      <strong class="mx iu">"build/"<br/>    </strong>]<br/>  },  <br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="0d2f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">检查我们的代码:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="e148" class="nb lo it mx b gy nc nd l ne nf">$ yarn lint<br/>yarn run v1.17.3<br/>$ standard<br/>✨  Done in 0.69s.</span></pre><p id="74ab" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的代码看起来不错。如果不是，我们可以尝试使用<code class="fe ng nh ni mx b">--fix</code>参数。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="a6f1" class="nb lo it mx b gy nc nd l ne nf">$ yarn lint --fix</span></pre><h1 id="8386" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">7.代码格式</h1><p id="5d56" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">代码格式化可以节省很多开发时间。不再有冗长格式化代码，不再有关于一段代码应该是什么样子的讨论。</p><p id="a561" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Prettier显然是JavaScript(以及许多其他语言，包括CSS、JSON、JSX等)的最佳选择。)</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="9653" class="nb lo it mx b gy nc nd l ne nf">$ yarn add --dev <strong class="mx iu">standard-prettier</strong> </span></pre><p id="65a6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">添加一个<strong class="kd iu">格式的</strong>脚本:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="ee82" class="nb lo it mx b gy nc nd l ne nf">{<br/>  "name": "my-module",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "build/index.js",<br/>  "module": "build/index.es.js",<br/>  "jsnext:main": "build/index.es.js",<br/>  "scripts": {<br/>    "build": "rollup -c",<br/>    <strong class="mx iu">"format"</strong>: <strong class="mx iu">"prettier-standard --format"</strong>,<br/>    "lint": "standard",    "test": "jest --coverage"<br/>  },<br/>  "files": [<br/>    "build"<br/>  ],<br/>  "devDependencies": {<br/>    "@types/jest": "^24.0.24",<br/>    "jest": "^24.9.0",<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "standard": "^14.3.1",<br/>    "ts-jest": "^24.2.0",<br/>    "typescript": "^3.7.3"<br/>  },<br/>  "jest": {<br/>    "preset": "ts-jest",<br/>    "testEnvironment": "node"<br/>  },<br/>  "standard": {<br/>    "ignore": [<br/>      "node_modules/",<br/>      "build/"<br/>    ]<br/>  },  <br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="6838" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">和一个<code class="fe ng nh ni mx b">.prettierignore</code>文件</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="nk nl l"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">。忽略不计</figcaption></figure><p id="aed2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">运行它:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="0c64" class="nb lo it mx b gy nc nd l ne nf">$ yarn format<br/>yarn run v1.17.3<br/>$ prettier-standard --format<br/>package.json 44ms<br/>rollup.config.js 21ms<br/>src/__test__/index.spec.ts 320ms<br/>src/index.ts 8ms<br/>tsconfig.json 7ms<br/>✨  Done in 0.75s.</span></pre><p id="2439" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">配置更漂亮的最好方法是每次在编辑器上保存文件时运行。检查<a class="ae mr" href="https://github.com/sheerun/prettier-standard" rel="noopener ugc nofollow" target="_blank">https://github.com/sheerun/prettier-standard</a>了解一些设置细节。</p><h1 id="6f07" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">结论</h1><ul class=""><li id="c22e" class="kz la it kd b ke ml ki mm km od kq oe ku of ky le lf lg lh bi translated">添加所有依赖项:</li></ul><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="e66f" class="nb lo it mx b gy nc nd l ne nf">$ yarn add --dev <strong class="mx iu">typescript rollup rollup-plugin-commonjs rollup-plugin-node-resolve rollup-plugin-peer-deps-external rollup-plugin-typescript2 jest @types/jest ts-jest standard standard-prettier</strong></span></pre><ul class=""><li id="83a0" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">将您的<code class="fe ng nh ni mx b">package.json</code>替换为:</li></ul><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="bd23" class="nb lo it mx b gy nc nd l ne nf">{<br/>  "name": "my-module",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "build/index.js",<br/>  "module": "build/index.es.js",<br/>  "jsnext:main": "build/index.es.js",<br/>  "scripts": {<br/>    "build": "rollup -c",<br/>    "lint": "standard",<br/>    "format": "prettier-standard --format",<br/>    "test": "jest --coverage"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "@types/jest": "^24.0.24",<br/>    "jest": "^24.9.0",<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "standard": "^14.3.1",<br/>    "standard-prettier": "^1.0.1",<br/>    "ts-jest": "^24.2.0",<br/>    "typescript": "^3.7.3"<br/>  },<br/>  "jest": {<br/>    "preset": "ts-jest",<br/>    "testEnvironment": "node"<br/>  },<br/>  "standard": {<br/>    "ignore": [<br/>      "node_modules/",<br/>      "build/"<br/>    ]<br/>  }<br/>}</span></pre><ul class=""><li id="25f5" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">添加其余文件:<code class="fe ng nh ni mx b">rollup.config.js</code>、<code class="fe ng nh ni mx b">tsconfig.json</code>、<code class="fe ng nh ni mx b">.prettierignore</code>、<code class="fe ng nh ni mx b">.gitignore</code></li><li id="d9fb" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">别忘了给<code class="fe ng nh ni mx b">.gitignore</code> : <code class="fe ng nh ni mx b">coverage/</code>和<code class="fe ng nh ni mx b">node_modules/</code>添加几个条目</li><li id="708d" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">设置你的IDE或者编辑器在每次保存时自动格式化(这样可以节省很多时间)</li><li id="5633" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">要发布NPM模块，您需要一个NPM帐户。(请激活2FA，这样您的模块更新也可以免受恶意行为者的攻击)</li></ul><p id="9ab5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">黑客快乐…</p></div></div>    
</body>
</html>