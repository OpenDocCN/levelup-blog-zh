<html>
<head>
<title>Enhancing BigQuery SEARCH features with SEARCH INDEX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用搜索索引增强BigQuery搜索特性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/enhancing-bigquery-search-features-with-search-index-771c1eec186e?source=collection_archive---------2-----------------------#2022-05-04">https://levelup.gitconnected.com/enhancing-bigquery-search-features-with-search-index-771c1eec186e?source=collection_archive---------2-----------------------#2022-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3089" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">简短介绍BigQuery的一个不错的特性</h2><div class=""/><div class=""><h2 id="66e7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在非结构化文本和半结构化JSON中查找文本的更快方法</h2></div><p id="1a83" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最近，我开始探索BigQuery的<em class="ln">搜索索引</em>特性，它大大加快了搜索功能。该特性允许我们使用SQL以更快的方式在整个表字段中查找特定的单词。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/a37c1cca076d5629b33b30732efa4328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*23S4FvlF1z0Ekv4o0D1Svg.jpeg"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">BigQuery搜索<a class="ae me" href="https://cloud.google.com/blog/products/data-analytics/pinpoint-unique-elements-with-bigquery-search-features" rel="noopener ugc nofollow" target="_blank"> GCP博客</a></figcaption></figure><p id="648f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果您熟悉BigQuery字符串函数，那么您可能已经使用CONTAINS_SUBSTR函数来查找出现在所选字段中的特定单词。然后你现在有一个更快的功能和额外的功能。</p><p id="5c1c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这个新特性使用search命令简化了文本搜索，它比CONTAINS_SUBSTR更快，因为当您可以对所有列、所有字符串或JSON数据创建搜索索引时，表将被索引。</p><blockquote class="mf"><p id="5068" class="mg mh it bd mi mj mk ml mm mn mo lm dk translated">BigQuery搜索索引使您能够使用Google标准SQL轻松找到隐藏在非结构化文本和半结构化JSON数据中的唯一数据元素，而无需事先了解表模式</p><p id="b58e" class="mg mh it bd mi mj mk ml mm mn mo lm dk translated">— GCP博客<a class="ae me" href="https://cloud.google.com/blog/products/data-analytics/pinpoint-unique-elements-with-bigquery-search-features" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></blockquote><h1 id="4e40" class="mp mq it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">我们一起试试吧…</h1><p id="9f89" class="pw-post-body-paragraph kr ks it kt b ku nh kd kw kx ni kg kz la nj lc ld le nk lg lh li nl lk ll lm im bi translated">我用的是一个小型足球数据集，包含4个表:<em class="ln">球员</em>、<em class="ln">俱乐部</em>、<em class="ln">国家、转会</em>。</p><p id="f2a1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将首先尝试使用CONTAINS_SUBSTR命令来查找一个特定的国家:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi nm"><img src="../Images/3c1eb19bf23eb9c1a003f9f462cca34c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rzIgf-NcZxqKOtjPrJeNrQ.png"/></div></div></figure><p id="7f9c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">您可以记下读取数据所消耗的时间，以及返回结果的准确性。</p><p id="d56e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">命令<strong class="kt jd">包含_SUBSTR(名字，'阿曼')</strong>在这里返回两个结果:</p><ul class=""><li id="cf75" class="nn no it kt b ku kv kx ky la np le nq li nr lm ns nt nu nv bi translated">阿曼</li><li id="94d7" class="nn no it kt b ku nw kx nx la ny le nz li oa lm ns nt nu nv bi translated">罗马尼亚</li></ul></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="3dbc" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在索引搜索之前，让我们在countries表下搜索一个国家:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oi"><img src="../Images/aa96f01dd72957f9a5c2b81376244874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TRkK9ocn0U0M6Vf6FUClMQ.png"/></div></div></figure><p id="58d1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">命令<strong class="kt jd"> SEARCH(name，' oman') </strong>在这里只返回一个结果:</p><ul class=""><li id="c6a1" class="nn no it kt b ku kv kx ky la np le nq li nr lm ns nt nu nv bi translated">阿曼</li></ul></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="08f5" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">实现搜索索引:</p><pre class="lp lq lr ls gt oj ok ol om aw on bi"><span id="9be6" class="oo mq it ok b gy op oq l or os">CREATE SEARCH INDEX</span><span id="f2cf" class="oo mq it ok b gy ot oq l or os">    countries_index</span><span id="97a4" class="oo mq it ok b gy ot oq l or os">ON</span><span id="6659" class="oo mq it ok b gy ot oq l or os">    `football.countries`(ALL COLUMNS);</span></pre></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="51db" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，让我们再次运行相同的搜索查询</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ou"><img src="../Images/8e39264c90164b0f0930ce37598be2a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*opix8FJmdSMNdUlanbPhdg.png"/></div></div></figure><p id="d9c1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如您所见，读取数据所消耗的时间显著减少。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="5317" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将使用更多更大的表进行同样的尝试，<em class="ln">传输</em>。</p><p id="dc28" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">使用<strong class="kt jd"> CONTAINS_SUBSTR </strong>命令找到玩家内马尔:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi nm"><img src="../Images/621d2b6f07f1438910eb3348acef94dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3O5aBwx4VpSgRnU5Je6pdw.png"/></div></div></figure><p id="deaa" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">使用<strong class="kt jd">搜索</strong>命令找到球员内马尔，无需索引:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ov"><img src="../Images/44d9209af27d1b3aa5f56b5297af16b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zt0oUWn1muiDAI5gflHFgg.png"/></div></div></figure><p id="6039" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">实现搜索索引</p><pre class="lp lq lr ls gt oj ok ol om aw on bi"><span id="c197" class="oo mq it ok b gy op oq l or os">CREATE SEARCH INDEX</span><span id="6395" class="oo mq it ok b gy ot oq l or os">    player_name_index</span><span id="8538" class="oo mq it ok b gy ot oq l or os">ON</span><span id="fc58" class="oo mq it ok b gy ot oq l or os">    `football.transfers_all`(ALL COLUMNS);</span></pre><p id="89bd" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">索引后使用<strong class="kt jd">搜索</strong>命令找到球员内马尔:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ow"><img src="../Images/dc036b8e6dea5456501d9b7cd01cd1cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*981sglgD11bDXqK9_VvL7Q.png"/></div></div></figure><p id="9de4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">希望这篇快速介绍能够帮助您探索可以在BigQuery查询上实现的增强功能，以加快搜索结果的速度。</p></div></div>    
</body>
</html>