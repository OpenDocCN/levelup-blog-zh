<html>
<head>
<title>Python + Pandas + Google SpreadSheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python +熊猫+谷歌电子表格</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-pandas-google-spreadsheet-476bd6a77f2b?source=collection_archive---------3-----------------------#2020-08-03">https://levelup.gitconnected.com/python-pandas-google-spreadsheet-476bd6a77f2b?source=collection_archive---------3-----------------------#2020-08-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="038b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如何阅读，更新和创建谷歌电子表格，并建立一个数据框架熊猫。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/db0581fb30d03c71e7f733e8603683f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O81a6a6SXUB34wdUR1rubg.png"/></div></div></figure><h1 id="ed29" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">索引</h1><ol class=""><li id="e3e1" class="ly lz it js b jt ma jx mb kb mc kf md kj me kn mf mg mh mi bi translated">在谷歌开发者中创建一个项目。</li><li id="1162" class="ly lz it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">主动API谷歌表和谷歌驱动。</li><li id="620d" class="ly lz it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">认证密钥:本地或服务</li><li id="636e" class="ly lz it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">创建电子表格。</li><li id="51c2" class="ly lz it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">脚本Python +熊猫。</li></ol></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mv"><img src="../Images/ddf952fbccd33d039fe8c08d04a5c519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VD4bnj-utUYPjcrPeuHS6A.png"/></div></div></figure><h1 id="e866" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">在Google开发者中创建一个项目</h1><p id="24ca" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">为了使用Google Sheets API资源，我们需要创建一个项目。</p><p id="8eb4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">没有那个项目，什么都做不了。</p><p id="bf18" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">链接:<a class="ae mz" href="https://console.developers.google.com/project" rel="noopener ugc nofollow" target="_blank">https://console.developers.google.com/project</a></p><ol class=""><li id="a172" class="ly lz it js b jt ju jx jy kb na kf nb kj nc kn mf mg mh mi bi translated">创建一个项目。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mv"><img src="../Images/ec70590cf61d21a6a938c754cdac7e86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pp0d17SHOM4ialobQsVw8Q.png"/></div></div></figure><p id="92d6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.为项目设置一个名称。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/1b1f94d03f1413bfba3814edd9017577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*NPQq8j5PNdvBlvFFYTM9vQ.png"/></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ne"><img src="../Images/ad6a0dd31f84fb80dddbd5f299d5e86c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PkSaRaiRBaCmzsjM6krWNQ.png"/></div></div></figure><h1 id="4d27" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">谷歌工作表API</h1><p id="853a" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">现在我们启动API来与项目交换工作表，然后选择一种类型的API:公共的或私有的。</p><ol class=""><li id="bc79" class="ly lz it js b jt ju jx jy kb na kf nb kj nc kn mf mg mh mi bi translated">在搜索栏中找到“Google Sheets API”。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nf"><img src="../Images/de410ab7cbbbc50d3e97d579c018efae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g0BKfUXwLWYqWPWBhAZnFg.png"/></div></div></figure><p id="a36a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.设置“启用”选项。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/4935d81800773858ce1fa53612e7936b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*jtTBUo0BZcqQHQUY4m6dyQ.png"/></div></figure><p id="3ff3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.回到主页，选择“OAuth同意屏幕”。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/0253b18f53e5c85b78cf2a9e450dc665.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*cNDT8k9gYEXDdtR0mTKjvw.png"/></div></figure><p id="0162" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.我们需要定义选择什么类型的API公共的允许任何人访问你的API，私有的只有拥有代码的用户才能访问。</p><p id="00a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本例中，选择了公共API。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/1ba92946fe85dfb1817aca56eb825145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*ARkiRzVHSQV2MBB2MeeTyw.png"/></div></figure><p id="368f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.选择类型后，必须设置API的名称。<br/> <em class="nj">还有其他选项；对于这个例子，没有必要设置它。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/fc3e7ad751c46d1aed486099b13d9ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*W8ZexEBcx9m-w7eBE16ZCg.png"/></div></figure><p id="9bea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.启用Google Drive API。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/869acf4cbc4130645d4a49b7474abc70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*4H0wbmc8Yar6ldcKGyQbag.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">创建和更新电子表格是必要的。</figcaption></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><blockquote class="np nq nr"><p id="35b0" class="jq jr nj js b jt ju jv jw jx jy jz ka ns kc kd ke nt kg kh ki nu kk kl km kn im bi translated"><strong class="js iu">到目前为止我们已经:</strong></p><p id="c013" class="jq jr nj js b jt ju jv jw jx jy jz ka ns kc kd ke nt kg kh ki nu kk kl km kn im bi translated">*在谷歌开发者中创建了一个项目。</p><p id="914a" class="jq jr nj js b jt ju jv jw jx jy jz ka ns kc kd ke nt kg kh ki nu kk kl km kn im bi translated">*激活API表并定义API类型。</p><p id="8520" class="jq jr nj js b jt ju jv jw jx jy jz ka ns kc kd ke nt kg kh ki nu kk kl km kn im bi translated">我们已经创建了项目的基础。</p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nv"><img src="../Images/17ff01ea6c4293b636296d384b605a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QAl3pZFltBMELEZmNgA9CQ.png"/></div></div></figure><h1 id="699a" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">键</h1><p id="f5fb" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">认证—我们需要生成密钥来访问电子表格。有两种钥匙。</p><p id="0ea6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 1 — OAuth客户端ID: </strong></p><blockquote class="np nq nr"><p id="d272" class="jq jr nj js b jt ju jv jw jx jy jz ka ns kc kd ke nt kg kh ki nu kk kl km kn im bi translated">需要用户的同意，所以应用程序只能访问用户的数据。</p></blockquote><p id="1092" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">推荐用于验证和开发本地应用程序。</p><p id="5ed4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 2 —服务账户:</strong></p><blockquote class="np nq nr"><p id="4a09" class="jq jr nj js b jt ju jv jw jx jy jz ka ns kc kd ke nt kg kh ki nu kk kl km kn im bi translated">启用服务器到服务器功能，即使用机器人帐户的应用程序级身份验证。</p></blockquote><p id="e054" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">建议用于自动身份验证，通常在生产应用程序中使用(身份验证不再是本地的)。我们为这些情况创建了一个特定的访问键。</p><h2 id="13b1" class="nw lb it bd lc nx ny dn lg nz oa dp lk kb ob oc lo kf od oe ls kj of og lw oh bi translated">创建本地密钥</h2><ol class=""><li id="68d7" class="ly lz it js b jt ma jx mb kb mc kf md kj me kn mf mg mh mi bi translated">在凭证中，选择“+创建凭证”和OAuth客户端Id。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oi"><img src="../Images/5f4a58a0ab614d1bc0f3e935ba07ff13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sngqyaf60s78z2pxNVtc6Q.png"/></div></div></figure><p id="794a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.选择将被认证的设备的一个选项，在我们的例子中是:桌面应用。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/190dd4ae8369988c7c130d4c00d62917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*Mp71WjYuC5eqAg59cjqtNw.png"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/feaaa8fa620b98c2153cad56668cc4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*o3vEYCGea66JZWZas_BDXA.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">生成的密钥访问令牌。</figcaption></figure><p id="10bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.下载密钥。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/0681d606c8aa26430dc5b64d2c3718dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vdIiU_MdLSSsVLJlXws64g.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">。json文件</figcaption></figure><h2 id="9bd9" class="nw lb it bd lc nx ny dn lg nz oa dp lk kb ob oc lo kf od oe ls kj of og lw oh bi translated">创建远程密钥</h2><ol class=""><li id="ccb1" class="ly lz it js b jt ma jx mb kb mc kf md kj me kn mf mg mh mi bi translated">在凭证中选择“+创建凭证”和服务帐户。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ol"><img src="../Images/7427ddcf2a04d8e65823b1479a312d78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RuuS8mzJRdKu1SohX2d0OA.png"/></div></div></figure><p id="11b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.为您的密钥设置一个名称。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi om"><img src="../Images/bfb2378d9a245402a4d5415b421b8286.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*PZ9Iz8-I1gu_I5jH8VSXFQ.png"/></div></figure><p id="2d3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">其余步骤不是强制的，所以我们可以省略。</strong></p><p id="078e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.已成功创建密钥。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi on"><img src="../Images/99b82a16b6c453cfd10e6eefbaaee686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MnSB9tMPU32UmRJPyRMIzw.png"/></div></div></figure><p id="3daf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在来生成。json文件，单击键的名称，我们到达键部分。</p><ol class=""><li id="6e39" class="ly lz it js b jt ju jx jy kb na kf nb kj nc kn mf mg mh mi bi translated">请确保使用您选择的正确密钥，并创建一个新密钥。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/cca6aa53a2659d314a523c100e24f81e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*Y9b4WfGQEVfPsbwmF9hmEw.png"/></div></figure><p id="ddff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.选择文件类型，<strong class="js iu"> .json. </strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi op"><img src="../Images/87987edcdca1c31e9ea3c1baeb3c6d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*8yy4e5RXwZAT_j8Rnp1b_g.png"/></div></figure><p id="0f3b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.密钥将保存在您的计算机上。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/fcff91a162dceab4842e426b4b8f7426.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMAJi4C-AzszifLKsIG2wg.png"/></div></div></figure><p id="ef1e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.将生成的电子邮件保存在密钥中，以便可以在电子表格中访问它。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi or"><img src="../Images/88995c45c3c1cac5cc1d78ab1a8fd9d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*6uOai1LYpPolFJeoWOe0_A.png"/></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nv"><img src="../Images/99ba926c8dcbedff1784f777e267df83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MOHEfO7Q8zGjdZwstzrc9Q.png"/></div></div></figure><h1 id="d593" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">工作表</h1><p id="4069" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">这里没有含糊之处—我们已经创建了电子表格，因此我们需要注意两点:</p><p id="aa25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">为电子表格键:<br/> </strong>该键标识代码，是代码运行所必需的。这个函数对于识别代码的操作是必要的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/e8030b30738e84ce1c7dbff04435dfce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7FkF7ywcsFY6dr48exLb4w.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">电子表格键</figcaption></figure><p id="4f98" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">访问远程邮件键:<br/> </strong>您必须使用远程键授予访问邮件键的权限。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/1782f0cd9edfb5cbfd3654eb9ad08802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LcaEwG5k72lay7iesPmIDA.png"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nv"><img src="../Images/b2cd3ff6678cdd7fce1b0b91ed45e188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXzx5NeX517an7SqwTmC0g.png"/></div></div></figure><h1 id="2c85" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">计算机编程语言</h1><p id="eb31" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">要创建Python代码，您可以通过这三个例子来了解整个过程是如何工作的。确保你的项目文件夹中有认证密钥。</p><p id="d78a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要执行这些示例，必须安装以下库:</p><pre class="kp kq kr ks gt ou ov ow ox aw oy bi"><span id="a102" class="nw lb it ov b gy oz pa l pb pc">!pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib</span><span id="1f7e" class="nw lb it ov b gy pd pa l pb pc">!pip install gspread</span><span id="4e4f" class="nw lb it ov b gy pd pa l pb pc">!pip install pandas</span></pre><p id="cf28" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第一个示例—读取电子表格本地键。基于google代码，我们修改了返回一个熊猫数据帧。<br/> <a class="ae mz" href="https://developers.google.com/sheets/api/quickstart/python" rel="noopener ugc nofollow" target="_blank">更多详情见谷歌代码</a>。</strong></p><p id="7175" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于第一次身份验证，Google服务将创建一个token.pickle文件，第二次将不再需要该文件。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pe pf l"/></div></figure><p id="06de" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第二个示例—读取电子表格遥控键。<br/> </strong>这个例子需要一个服务密钥。重写读取函数只是为了便于认证和理解该过程。</p><p id="b67f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从这一点开始，将不再需要令牌pickle文件。<br/>看看代码是如何被轻易识别的。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pe pf l"/></div></figure><p id="aaf4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第三个示例—读取、更新和创建电子表格(服务密钥)。</strong></p><p id="1c5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到目前为止，我们已经了解了身份验证模型(位置和服务)是如何工作的。</p><p id="fe0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个脚本中，代码被抽象为四个函数:<br/> <strong class="js iu">认证— </strong>认证可以用API创建。<br/> <strong class="js iu">阅读— </strong>可以阅读特定的电子表格。<br/> <strong class="js iu">更新— </strong>特定的页签已被更新。此选项卡必须已在使用中。<br/> <strong class="js iu">创建并插入数据—</strong><strong class="js iu"/>新的电子表格已创建，数据帧已插入。分享将访问新电子表格的电子邮件是很重要的。由于服务电子邮件已经过身份验证，因此不得共享。这是访问电子表格的方式。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pe pf l"/></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="a2d1" class="nw lb it bd lc nx ny dn lg nz oa dp lk kb ob oc lo kf od oe ls kj of og lw oh bi translated">感谢阅读这篇文章。</h2><h2 id="08c8" class="nw lb it bd lc nx ny dn lg nz oa dp lk kb ob oc lo kf od oe ls kj of og lw oh bi translated">作者可以接受反馈。</h2><h2 id="1f7d" class="nw lb it bd lc nx ny dn lg nz oa dp lk kb ob oc lo kf od oe ls kj of og lw oh bi translated">跟着他上<a class="ae mz" href="https://www.linkedin.com/in/lucasmbribeiro/" rel="noopener ugc nofollow" target="_blank"> LikedIn </a>或者<a class="ae mz" href="https://github.com/lucasmbribeiro" rel="noopener ugc nofollow" target="_blank"> Github </a>。</h2></div></div>    
</body>
</html>