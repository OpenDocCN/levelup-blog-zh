<html>
<head>
<title>Be A Good Service Call Citizen With RateLimiter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用费率限制器做一个好的服务电话市民</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/be-a-good-service-call-citizen-with-ratelimiter-e29e27d1a972?source=collection_archive---------21-----------------------#2020-10-06">https://levelup.gitconnected.com/be-a-good-service-call-citizen-with-ratelimiter-e29e27d1a972?source=collection_archive---------21-----------------------#2020-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f088" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何拨打节流意识服务电话</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9e972282a02c748bb701f1fd7f24564b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WrIuySgp4bmkSS5YujFf5A.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">洛根·韦弗在<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> unsplash </a>上拍摄的照片</figcaption></figure><h1 id="3aaa" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为什么要限制自己的应用呢？</h1><p id="7a97" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">你可能看着这个会想</p><blockquote class="mk ml mm"><p id="50b7" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">“我为什么要限制我的应用程序的性能？我希望我的应用程序尽可能快地加载和执行，所以我不应该限制我的API调用”</p></blockquote><p id="197e" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">嗯，你是对的，也是错的</p><p id="cce3" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">你不应该武断地限制你的API调用，这是事实。然而，有时候——对于大型应用程序来说——可能有必要限制您的API调用以避免被API抑制。</p><p id="25cd" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">节流由<a class="ae kv" href="https://helpx.adobe.com/coldfusion/api-manager/throttling-and-rate-limiting.html#:~:text=Throttling%20is%20a%20process%20that,consumers%20during%20a%20given%20period.&amp;text=For%20example%2C%20you%20can%20limit,as%20%22too%20many%20requests%22." rel="noopener ugc nofollow" target="_blank"> Adobe </a>定义为</p><blockquote class="mk ml mm"><p id="8e36" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">用于控制消费者在给定期间使用API的过程。您可以在应用程序级别和API级别定义节流。节流限制被认为是API级别的累积限制。</p></blockquote><p id="3664" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">所以你应该只在必要的时候使用限速。</p><h1 id="1e6e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">添加速率限制的案例研究</h1><p id="f2e1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">您的老板希望您创建一个函数，该函数能尽快对他喜欢的API进行100次调用🏃‍♂️💨。</p><p id="cec1" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">所以你会想，哦，我会用100个线程进行并行调用，与同步调用相比，速度可能快100倍😛！</p><p id="b5b2" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">这是我们虚拟服务调用的代码。</p><h2 id="dfc8" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">API调用</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="65cc" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">然后编写以下代码来创建100个ServiceCall实例，并并行调用它们以获得最大速度💪！</p><h2 id="4a12" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">应用程序(不限于)</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="e1dd" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">现在你运行代码，你想“这太棒了，我100倍于这个代码的性能，我肯定会加薪！”</p><p id="1323" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">相反，你看到这个…🚨🚫🚨🚫</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/698e83d3e94673110600183df290edc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gG1zRLp3nyY8R2Yjdd580w.jpeg"/></div></div></figure><p id="5dba" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">发生了什么事？你做了太多太快的调用，API因为你的贪婪而阻止了你😠。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/804ec558303229c10737dda7a5523c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*53jhKFc726JfF1vtczHsNQ.png"/></div></div></figure><p id="10fb" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">所以你联系API📞他们告诉你一次只能有10个活动连接，以避免被限制。</p><p id="49ca" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">你将如何实现这一行为😨？这就是RateLimiter发挥作用的地方😃！</p><h2 id="4392" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">应用程序(有限制)</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="304f" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">这里我们创建了10个“许可证”,每次我们想要调用服务时，我们都必须获得一个许可证。permit允许创建一个线程(即10个permit意味着我们一次可以有10个活动线程)。一旦服务调用终止，我们就释放其被获取的许可。这将导致一个较慢的过程，但我们将保持在API的调用限制内。</p><p id="3198" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">现在，您可以成为一名优秀的API公民，确保您的应用程序能够正常运行，而不会引发429错误。</p></div></div>    
</body>
</html>