<html>
<head>
<title>An overview of Apache NiFi and Toolkit CLI deployments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache NiFi和工具包CLI部署概述</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/an-overview-of-apache-nifi-and-toolkit-cli-deployments-785978dbce3b?source=collection_archive---------9-----------------------#2020-07-29">https://levelup.gitconnected.com/an-overview-of-apache-nifi-and-toolkit-cli-deployments-785978dbce3b?source=collection_archive---------9-----------------------#2020-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="4fc7" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">Apache NiFi是一个用于通过拖放界面创建数据管道的工具，旨在自动化系统之间的数据流。它属于“<em class="iq">无代码/低代码</em>”类工具，主要面向那些不喜欢编写和管理代码或构建需要大量工程工作的解决方案的公司。</p></blockquote><h1 id="db41" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">NiFi可以用来做什么？</h1><p id="c942" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">NiFi擅长在平台之间可靠地传输数据，例如Kafka到ES，并允许您在此过程中执行一些轻量级ETL。它可以丰富和准备数据，执行数据格式之间的转换，更改命名字段和过滤/路由数据到不同的位置。</p><p id="a41d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">但是，它不应该用于复杂的事件处理、分布式处理、连接、滚动窗口或聚合(它不是Apache Spark，也不自称是！😎).因此，它不应该与AWS EMR等大数据处理工具或Talend等更灵活的开源ETL工具相比较。更合理的比较应该是在<a class="ae lv" href="https://statsbot.co/blog/open-source-etl/" rel="noopener ugc nofollow" target="_blank"> Apache NiFi和StreamSets </a>之间。</p><p id="0400" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">NiFi可以集成一些AWS服务，比如S3、SNS、Lambda、SQS和DynamoDB。</p><p id="9a8c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">如果您需要与流媒体服务集成，值得注意的是，对Apache产品Kafka的支持比AWS Kinesis更多。目前没有读取Kinesis数据流的能力，但有一个<a class="ae lv" href="https://issues.apache.org/jira/browse/NIFI-2892" rel="noopener ugc nofollow" target="_blank">公开公关</a>的变化！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="b88f" class="kp kq iq bd kr ks md ku kv kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm bi translated">NiFi术语</h1><p id="4d75" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">下面是一些特定于构建NiFi流的有用术语，它们将有助于理解本文的其余部分:</p><p id="ae3f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">流文件</strong> —是数据，它由内容(数据)和属性(元数据键值对，例如“创建日期”)组成</p><p id="e580" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">处理器</strong> —将一组转换和规则应用于流文件，并生成新的流文件。Apache NiFi声称有280多种处理器可供选择！示例包括getKafta、getFTP、putKinesisStream、putHDFS、convertRecord、replaceText、validateCSV等。</p><p id="ded1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">连接器</strong> —尚未由下一个处理器处理的所有流文件的队列。它定义了关于流文件如何被优先化的规则(哪些是第一个，或者被过滤掉，例如FIFO)。连接器可用于负载平衡和重定向“失败的”流文件。</p><p id="83f0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">控制器服务</strong> —处理器使用的共享服务，例如DB连接、AWS凭证、写入器和读取器，您可以在转换处理器中使用(仅举几例)。</p><p id="4a53" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">过程组</strong>——充当抽象层，通常使用它们作为分解大型数据流的一种方式是一种良好的实践。</p><p id="0389" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">模板</strong> —如果您有一组处理器执行一些您想要重复和重用的逻辑，可以使用模板。例如，您希望与其他人分享的常用组件。</p><p id="8cd9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">输入/输出端口</strong> —允许您将数据传入或传出远程进程组。</p><h1 id="7c50" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">装置</h1><p id="c354" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">安装非常简单，你可以通过这个<a class="ae lv" href="https://nifi.apache.org/download.html" rel="noopener ugc nofollow" target="_blank">链接</a>下载nifi- <version> -bin.tar.gz或者拉取、构建并运行<a class="ae lv" href="https://hub.docker.com/r/apache/nifi/" rel="noopener ugc nofollow" target="_blank"> docker镜像</a>。</version></p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="f2d7" class="kp kq iq bd kr ks md ku kv kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm bi translated">UI和NiFi流</h1><p id="0d74" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">用户界面非常直观，使用简单。您将不同的组件从顶部横幅中拖到画布上，并相应地进行配置。你也可以在代码中写标签，有点像JavaDoc！</p><p id="c1e9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">下面是UI的图像，您可以在画布的中心看到一个处理组，您可以右键单击并“进入”它以显示其中的流程。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mi"><img src="../Images/8b9c4a942db46b00be6e77be89674ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vxUvya4JgfS0BIHwEtfB1Q.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">带有进程组的NiFi画布</figcaption></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi my"><img src="../Images/922f5095426cfbfa134bcfaca0fd0b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6e8L5tsqchlaMmZnqPVEmA.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">一个示例NiFi流:从S3读取，转换为JSON，并写入Kinesis Firehose</figcaption></figure><p id="8c25" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">在这里，您可以看到处理器如何与连接器结合使用来处理数据流。失败的文件可以被重定向到其他路径，并被相应地处理/记录。不需要任何代码，这都是通过配置完成的。这个流在一个S3桶中列出CSV文件(要实现这一点，您需要一个ListS3和fetchs 3对象处理器的组合)，通过一个LogAttribute处理器记录任何问题，将文件转换成JSON并放到一个Kinesis Firehose流中。</p><p id="4b82" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">在您的根安装NiFi目录中(例如“/Applications/nifi- <version>”)，状态存储在“/state”文件夹中(除非您作为集群运行，否则Zookeeper会存储它)。日志存储在“/logs”下，该目录由LogAttribute处理器使用。默认情况下，流保存在“/conf/flow.xml.gz”中，但是您可以通过编辑“/conf/nifi.properties”文件来覆盖此配置以及许多其他配置。</version></p><p id="a004" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">NiFi通过小书图标引导您进入文档(如果有)，例如下面的查看用法选项:</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mz"><img src="../Images/9b55094a6ae61b62af99809c8107e99b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MGcmBsZmZVmxBW0VjKzAeQ.png"/></div></div></figure><p id="89ab" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">当向进程组添加控制器服务时，这也是可用的。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="aed7" class="kp kq iq bd kr ks md ku kv kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm bi translated">AWS连接</h1><p id="ad7c" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">您可以创建一个awscrdentialsprovidercontrollerservice(在流程组级别设置),以便在流程的多个组件中重用您的AWS凭据。指定凭据文件的位置，该文件规定了AWS访问密钥和秘密访问密钥，或者直接在控制器服务的属性中设置这些密钥。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi na"><img src="../Images/4b077611aa7c56266b4d4c91acab2ee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P8wUk0GWpv_5H-UPjVxPpw.png"/></div></div></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nb"><img src="../Images/b3d2bf1224a2aa1f1731792677f9f862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4S9mAWzpjWjEzlh3RroHw.png"/></div></div></figure><p id="c639" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">然后，您可以在需要AWS连接的处理器配置中引用此控制器服务，例如PutKinesisFirehose处理器属性。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nc"><img src="../Images/5b828f46453d2096289377b0dbff0274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*74CVSIALCsRX5dH_dQvbfg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">PutKinesisFireshose处理器配置</figcaption></figure><p id="9be5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">需要停止正在运行的处理器，以应用任何更改，例如新的控制器服务或其他属性修改。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="b6cf" class="kp kq iq bd kr ks md ku kv kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm bi translated">NiFi注册表</h1><p id="eec1" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">NiFi Registry是Apache NiFi的子项目，旨在满足人们的部署和版本控制需求！它提供了一个中心位置来存储资源组流。在您的本地NiFi流中添加新的注册中心客户端之前，您必须首先使用注册中心UI创建一个“bucket ”(用于组织版本控制流)。本文:<a class="ae lv" href="https://bryanbende.com/development/2018/01/19/apache-nifi-how-do-i-deploy-my-flow" rel="noopener ugc nofollow" target="_blank">NiFi-how-do-I-deploy-my-flow？</a>有一些精心编写的步骤，详细说明了如何做到这一点。</p><blockquote class="jn jo jp"><p id="1c49" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">你可以通过<a class="ae lv" href="https://nifi.apache.org/registry.html" rel="noopener ugc nofollow" target="_blank">这个链接</a>或者使用<a class="ae lv" href="https://hub.docker.com/r/apache/nifi-registry/" rel="noopener ugc nofollow" target="_blank"> Docker </a>在本地下载注册表。</p></blockquote><h1 id="6ab9" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">NiFi工具包和部署</h1><p id="6b23" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">该工具包提供了几个命令行实用程序来帮助在单个和集群环境中设置NiFi。在研究部署选项时，我使用cli工具连接到NiFi注册表。</p><blockquote class="jn jo jp"><p id="df0b" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">你可以通过<a class="ae lv" href="https://nifi.apache.org/download.html" rel="noopener ugc nofollow" target="_blank">这个链接</a>在本地下载工具包，或者使用<a class="ae lv" href="https://hub.docker.com/r/apache/nifi-toolkit" rel="noopener ugc nofollow" target="_blank"> Docker </a>。</p></blockquote><p id="621e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">在您下载的工具包bin目录(例如/Applications/nifi-toolkit-version/bin)中，有一个“cli.sh”脚本，可用于启动交互式shell。</p><p id="f954" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">对于AWS帐户的部署，我使用terraform创建了两个EC2实例(<a class="ae lv" href="https://www.batchiq.com/nifi-selecting-an-aws-instance-type.html" rel="noopener ugc nofollow" target="_blank">使用m4.large实例类型</a>)运行在同一个VPC中，一个安装了NiFi，另一个安装了NiFi Registry。NiFi的简单user_data配置如下:</p><pre class="mj mk ml mm gt nd ne nf ng aw nh bi"><span id="639e" class="ni kq iq ne b gy nj nk l nl nm">#!/usr/bin/env bash <br/>curl -fsSL https://get.docker.com get-docker.sh | sh <br/>sudo docker pull apache/nifi:latest <br/>sudo docker build -t apache/nifi:latest . <br/>sudo docker run --name nifi -p 8080:8080 -d apache/nifi:latest</span></pre><p id="8644" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">….和NiFi注册表:</p><pre class="mj mk ml mm gt nd ne nf ng aw nh bi"><span id="0454" class="ni kq iq ne b gy nj nk l nl nm">#!/usr/bin/env bash <br/>curl -fsSL https://get.docker.com get-docker.sh | sh <br/>sudo docker pull apache/nifi-registry:latest <br/>sudo docker build -t apache/nifi-registry:latest . <br/>sudo docker run --name nifi-registry -p 18080:18080 /<br/>-d apache/nifi-registry:latest</span></pre><p id="73b5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">这两个shell脚本都安装docker，拉取、构建和运行最新的映像，并将默认的容器端口发布到实例。</p><blockquote class="jn jo jp"><p id="3068" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">对于我的ami_id，我使用了Ubuntu-focal-20.04-amd64-server的社区版——这允许您在实例上安装docker。</p></blockquote><p id="4e60" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">我已经在远程NiFi注册表中创建了一个bucket(<em class="js">“Leah ' s _ bucket”</em>)，并提交了一个流(<em class="js"> product_flow </em>)。现在，我想看看如何将它部署到远程NiFi实例…</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nn"><img src="../Images/173ac1b65543cbc64fbd528e54d183be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVOGoKIc4Sul_vvqXwLz3w.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">本地版本控制的进程组</figcaption></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi no"><img src="../Images/41ad472ecbbec685ee21586617e77807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKHFGdzbnrHNsajeZmvx4A.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">具有已提交版本化流的远程注册中心</figcaption></figure><p id="f678" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">一旦您启动了交互式shell，您就可以使用几个cli命令来部署和启动一个版本化的流:</p><p id="5fba" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">首先，您需要在远程NiFi实例中创建一个新的注册中心客户端，例如:</strong></p><pre class="mj mk ml mm gt nd ne nf ng aw nh bi"><span id="37a1" class="ni kq iq ne b gy nj nk l nl nm">nifi create-reg-client --baseUrl http://&lt;public_ip_of_nifi&gt;:8080 \<br/>--registryClientUrl http://&lt;private_ip_of_registry&gt;:18080 \<br/>--registryClientName leah's_client</span></pre><p id="9569" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">baseUrl是对其执行命令的Url(当我在本地机器上运行这些cli命令时，baseUrl是NiFi EC2实例的公共IP地址—因为我是通过互联网连接的)。</p><blockquote class="jn jo jp"><p id="109b" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">EC2实例安全组被修改为允许来自我的本地机器的流量</p></blockquote><p id="0c2b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">registryClientUrl可以引用NiFi注册中心的私有IP——因为这两个EC2实例位于AWS中的同一个VPC内，所以可以相互通信！</p><p id="bf90" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">registryClientName是您希望这个注册表在NiFi UI中被调用的任何名称。</p><p id="d46b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">接下来，我们需要通过从注册中心导入一个版本化的流程来创建一个流程组，例如:</strong></p><pre class="mj mk ml mm gt nd ne nf ng aw nh bi"><span id="1daf" class="ni kq iq ne b gy nj nk l nl nm">nifi pg-import --bucketIdentifier 0455d64e-ea40-4213-bbe4-359985de09f9 --flowIdentifier 6df2b6c1-249b-4af3-8f84-b57f32f6c5aa \<br/>--flowVersion 1 --baseUrl http://&lt;public_ip_of_nifi&gt;:8080</span></pre><p id="073f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">bucketIdentifier和flowIdentifier都可以在上面提交的版本化流的屏幕截图中找到，它们是唯一的。</p><p id="9c80" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">这个pg-import命令为进程组(processGroupId)返回一个惟一的id，您将在接下来的步骤中用到它！</p><p id="e3c6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">启用您正在使用的任何控制器服务，例如:</strong></p><pre class="mj mk ml mm gt nd ne nf ng aw nh bi"><span id="a0a4" class="ni kq iq ne b gy nj nk l nl nm">nifi pg-enable-services --processGroupId 94a93dc0-0173-1000-fee3-442454b1ecd6 --baseUrl http://&lt;public_ip_of_nifi&gt;:8080</span></pre><p id="7987" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><strong class="jt ir">然后您可以启动过程组，例如:</strong></p><pre class="mj mk ml mm gt nd ne nf ng aw nh bi"><span id="854b" class="ni kq iq ne b gy nj nk l nl nm">nifi pg-start --processGroupId 94a93dc0-0173-1000-fee3-442454b1ecd6 --baseUrl http://&lt;public_ip_of_nifi&gt;:8080</span></pre><p id="0e84" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">您应该能够在UI中看到新部署的进程组正在运行！</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi np"><img src="../Images/6efb7648be5f6a2e240cebdc3655efd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPeYEw6D6j_9x1EFQgTHBw.png"/></div></div></figure><p id="ca53" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">可以编写这些命令的脚本，以提供更加自动化的部署方式。</p><blockquote class="jn jo jp"><p id="4c79" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">如果您需要在您部署的NiFi流中设置变量，请查看<a class="ae lv" href="https://pierrevillard.com/2018/04/09/automate-workflow-deployment-in-apache-nifi-with-the-nifi-registry/" rel="noopener ugc nofollow" target="_blank">这个链接</a>了解更多细节。</p></blockquote></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="7762" class="kp kq iq bd kr ks md ku kv kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm bi translated">使用Apache NiFi时需要考虑的事项</h1><ul class=""><li id="55e2" class="nq nr iq jt b ju ln jy lo lp ns lr nt lt nu ko nv nw nx ny bi translated">单元测试——对于大多数“低代码”解决方案，单元测试从来都不容易，而且经常被忽视😢。NiFi提供了一种使用<a class="ae lv" href="https://nifi.apache.org/docs/nifi-docs/html/developer-guide.html#testing" rel="noopener ugc nofollow" target="_blank"> TestRunner类</a>测试单个处理器的方法，但是没有方法测试一个进程组。<a class="ae lv" href="https://touk.pl/blog/2019/01/10/testing-nifi-flow-the-good-the-bad-and-the-ugly/" rel="noopener ugc nofollow" target="_blank">本文</a>讨论了测试应用程序的困难，并介绍了他们为测试完整流程而创建的库。</li><li id="1f5f" class="nq nr iq jt b ju nz jy oa lp ob lr oc lt od ko nv nw nx ny bi translated">审查代码——由于流代码格式是xml，因此很难通过代码审查工具检测到对流文件的微小但有潜在影响(例如连接器负载平衡变化)的修改。这里您需要一个相当严格的审查过程，并考虑在UI中查看流配置历史(下图)。注册表提供了一种控制代码版本的方法，因此您可以在将它提升到另一个环境之前，在本地检查配置。</li></ul><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi oe"><img src="../Images/5f3232ad5186b5912e9505f86b12291d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_SP6ABlVgeQ4zdqfiarLQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">流程配置历史</figcaption></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi of"><img src="../Images/bf7837559c6e819f14469b70033c979a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jrx_y3__7cV85LEbh12TEg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">组件的流程配置活动详细资料</figcaption></figure><p id="01b3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">感谢阅读我的Apache NiFi之旅！我希望你已经发现它有用😊</p></div></div>    
</body>
</html>