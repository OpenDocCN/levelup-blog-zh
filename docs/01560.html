<html>
<head>
<title>PWA “Add Button to Home Screen” and Remote Debugging in Android Devices with Angular 8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Angular 8的Android设备中的PWA“主屏幕添加按钮”和远程调试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/pwa-add-button-to-home-screen-and-remote-debugging-in-android-devices-with-angular-8-3dbaec772a1?source=collection_archive---------3-----------------------#2020-01-13">https://levelup.gitconnected.com/pwa-add-button-to-home-screen-and-remote-debugging-in-android-devices-with-angular-8-3dbaec772a1?source=collection_archive---------3-----------------------#2020-01-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7963" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Android设备中实现带远程调试的PWA</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/98e972a4a55d0c575d43562b307b3326.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*r15a3c8WOkBywV8TcuZ0jA.jpeg"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">添加到主屏幕— PWA</figcaption></figure><p id="6017" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想了解更多，并从头开始学习如何在Angular 8中构建PWA，请先查看这个<a class="ae lq" rel="noopener ugc nofollow" target="_blank" href="/a-guide-to-building-a-pwa-in-angular-acea27ae708d">链接</a>。这是用Angular 8创建渐进式web应用程序的一步一步的教程，它解释了什么是PWA。</p><p id="d350" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这篇文章的目的是添加一个前一个环节中缺少的最后一步。通过点击“添加到主屏幕”按钮，用户将被提示将应用程序添加到他们的主屏幕，如上图所示。通常，没有按钮来触发提示消息，但是您可以根据应用程序中的需要使用相同的函数来处理提示消息。</p><p id="b111" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们先添加按钮。</p><h1 id="f852" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">添加UI按钮</h1><p id="4487" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我们将使用<a class="ae lq" href="https://github.com/aimanrahmattt/pwatest/tree/master" rel="noopener ugc nofollow" target="_blank">代码</a>从以前的链接。</p><p id="5d77" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">若要添加“添加到主屏幕”按钮，请更新以下文件。</p><p id="2f6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">【app.component.html T4】</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="0984" class="mt ls it mp b gy mu mv l mw mx">&lt;mat-toolbar color="primary"&gt;<br/>  &lt;mat-toolbar-row&gt;<br/>    &lt;span&gt;JS-jargon&lt;/span&gt;<br/>    &lt;span class="example-spacer"&gt;&lt;/span&gt;<br/>    &lt;button mat-raised-button color="accent" (click)="addToHomeScreen()"&gt;Add to home screen&lt;/button&gt;<br/>  &lt;/mat-toolbar-row&gt;<br/>&lt;/mat-toolbar&gt;</span></pre><p id="9548" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> app.component.scss </strong></p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="692b" class="mt ls it mp b gy mu mv l mw mx">.example-spacer {<br/>  flex: 1 1 auto;<br/>}</span></pre><p id="9880" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是最后的样子。该按钮被添加到工具栏的右侧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/cfd3b85458ba3a29745daa2f09fc8d22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*B0jNbVxOdhLtjsm9fl8eNg.png"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">最后外观</figcaption></figure><h1 id="e19f" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">添加到主屏幕功能</h1><p id="a471" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">接下来，我们将添加提示消息的函数。将下面的代码添加到我们的<strong class="kw iu"> app.component.ts </strong>中。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="9e17" class="mt ls it mp b gy mu mv l mw mx">deferredPrompt: any;<br/>showButton = false;</span><span id="b55b" class="mt ls it mp b gy mz mv l mw mx">@HostListener('window:beforeinstallprompt', ['$event'])<br/>onbeforeinstallprompt(e) {<br/>  console.log(e);<br/>  // Prevent Chrome 67 and earlier from automatically showing the prompt<br/>  e.preventDefault();<br/>  // Stash the event so it can be triggered later.<br/>  this.deferredPrompt = e;<br/>  this.showButton = true;<br/>}</span><span id="9d6c" class="mt ls it mp b gy mz mv l mw mx">addToHomeScreen() {<br/>  // hide our user interface that shows our A2HS button<br/>  this.showButton = false;<br/>  // Show the prompt<br/>  this.deferredPrompt.prompt();<br/>  // Wait for the user to respond to the prompt<br/>  this.deferredPrompt.userChoice<br/>  .then((choiceResult) =&gt; {<br/>  if (choiceResult.outcome === 'accepted') {<br/>    console.log('User accepted the A2HS prompt');<br/>  } else {<br/>    console.log('User dismissed the A2HS prompt');<br/>  }<br/>  this.deferredPrompt = null;<br/>});</span></pre><p id="7e20" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">查看此<a class="ae lq" href="https://github.com/aimanrahmattt/pwatest" rel="noopener ugc nofollow" target="_blank">链接</a>以获得此演示的完整代码。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="6468" class="lr ls it bd lt lu nh lw lx ly ni ma mb jz nj ka md kc nk kd mf kf nl kg mh mi bi translated">Android设备的远程调试</h1><p id="ff96" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我们将在实际的Android设备中测试PWA。正如我们在本地环境中进行的开发一样，我们将在Chrome浏览器中设置一个端口转发到我们的设备。</p><p id="8f5a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在此之前，构建用于生产的应用程序，并通过运行以下命令使用<strong class="kw iu"> http-server </strong>为其提供服务:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="169d" class="mt ls it mp b gy mu mv l mw mx">ng build --prod<br/>cd dist/pwatest<br/>http-server -o</span></pre><p id="49af" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">启用端口转发</strong></p><ol class=""><li id="a4b7" class="nm nn it kw b kx ky la lb ld no lh np ll nq lp nr ns nt nu bi translated">将您的Android设备连接到pc，并在设备中启用USB调试。</li><li id="a68d" class="nm nn it kw b kx nv la nw ld nx lh ny ll nz lp nr ns nt nu bi translated">在您的pc中，通过点击F12或右键-&gt; Inspect打开Chrome DevTools。</li><li id="2c62" class="nm nn it kw b kx nv la nw ld nx lh ny ll nz lp nr ns nt nu bi translated">点击右上角的三点-&gt;更多工具-&gt;选择远程设备。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi oa"><img src="../Images/6893215689684473329a58f4ec8eb0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*394qu-DXeRvx5JAbVJPfXw.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">Chrome DevTools中的远程设备</figcaption></figure><p id="038f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">4.确保<strong class="kw iu">发现USB设备</strong>和<strong class="kw iu">端口转发</strong>复选框已启用。添加一个新规则，如下图所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi of"><img src="../Images/1dd03e79c6b11254ff287cf457e0951b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UQHR97ZFATubjU4Kj-L2ww.png"/></div></div></figure><p id="cfe9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，在你的设备中打开Chrome，输入url <a class="ae lq" href="http://127.0.0.1:8080." rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8080。</a>这是它在设备中的样子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7b5cf5c413838366e1f68e5e07d4b981.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*H_8aMh6j3N_1zzJsugjG_w.jpeg"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">设备屏幕</figcaption></figure><p id="88bf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击“添加到主屏幕”按钮，将会提示一条消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/98e972a4a55d0c575d43562b307b3326.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*r15a3c8WOkBywV8TcuZ0jA.jpeg"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">消息提示</figcaption></figure><p id="6dab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，pwatest应用程序已添加到主屏幕。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2d7ce919a3a24db838ea39ff7a6894b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*hRo-D9K9-M72Gq7Dil88tw.png"/></div></figure><p id="914d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击pwatest应用程序。它看起来像任何其他应用程序，没有在屏幕上方的网址搜索栏。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/275fd742c9d8f1083f71071c774282c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*ZzWivTBwsJ95jwKdUibgZA.jpeg"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">Pwatest应用程序</figcaption></figure></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="ea9b" class="lr ls it bd lt lu nh lw lx ly ni ma mb jz nj ka md kc nk kd mf kf nl kg mh mi bi translated">资源</h1><ol class=""><li id="6a84" class="nm nn it kw b kx mj la mk ld oi lh oj ll ok lp nr ns nt nu bi translated"><a class="ae lq" href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/web/tools/chrome-devtools/remote-debugging</a></li><li id="7ee1" class="nm nn it kw b kx nv la nw ld nx lh ny ll nz lp nr ns nt nu bi translated"><a class="ae lq" href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging/local-server" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/web/tools/chrome-devtools/remote-debugging/local-server</a></li><li id="a486" class="nm nn it kw b kx nv la nw ld nx lh ny ll nz lp nr ns nt nu bi translated">【https://github.com/aimanrahmattt/pwatest T4】</li></ol></div></div>    
</body>
</html>