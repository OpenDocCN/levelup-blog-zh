# 亲爱的 for 循环爱好者:让我们和平地使用数组方法

> 原文：<https://levelup.gitconnected.com/dear-for-loop-fans-let-us-use-array-methods-in-peace-af851ca9e85f>

## 性能不是唯一有效的关注点

![](img/ba12c6040125d8763309e9cf61d4d9a5.png)

你有没有推过一些 JavaScript 代码，有人说:“用一个`for`循环，比`forEach`快”？真是令人失望。我总是讨厌在一个有十几个物体的阵列上移除一个`forEach`，这看起来像是浪费时间。所以，在为数组方法辩护的时候，让我们来谈谈为什么我们应该被允许使用它们而不感到内疚或羞耻。

# 问题中的方法有哪些？

数组方法有很多，但我说的是数组迭代器:`forEach`、`map`、`filter`、`every`、`reduce`之类的。我喜欢 Ruby 中的它们，当 JS 的年度修订版添加了我的最爱时，我激动不已。

## 示威游行

我很高兴现在不是这样了:

```
*const* **goodUsers** = [];
*for* (*let* **i** = 0; **i** < **users**.length; **i**++) { 
  *const* **user** = **users**[**i**];
  *if* (**user.**isGood) **goodUsers**.push(**user**);
};
```

我可以做:

```
const **goodUsers** = **users.**filter(**user** => **user.**isGood);
```

# 他们简直太棒了

如您所见，它们减少了对重复的样板代码的需求，但也增加了可读性。使用`map`告诉我我正在返回一个数组，`reduce` [意味着我正在将](/javascript-has-a-reduce-method-you-should-use-it-ff4dd29d6c9d)减少到一个值，而`filter`…嗯，这意味着我正在过滤。如果你不想做什么疯狂的事情，就在数组上捕捉一个方法，然后就到此为止。这些直观的方法可以节省你的工程时间，这样你就可以担心更重要的事情。

# 那么，有什么问题呢？

你不会免费得到任何东西；使用这些方法会降低性能速度。使用数组方法所需的开销意味着 JS 的效率会降低。在当今这个沉迷于时间的世界，这似乎是对这些方法的一个致命的标记。但事实并非如此。因为速度的差异通常停留在百分之一秒的*范围内。*

# 这是关于优先权的问题

当高级开发人员说“使用 for 循环，这样更快”时，他们是正确的。但是谁说 100%优化是我唯一在乎的？如果我必须过滤一个 100 个字符串的数组，我不在乎使用`for`循环可以节省多少毫秒。我更喜欢干净、*简洁、*易读的代码。

## 不要闻

担心数组方法的速度意味着"[过早的代码优化](http://wiki.c2.com/?PrematureOptimization)"如果你只担心性能*如果速度* 成为问题 ***你会做得更多。即使这样，它也可能是其他一些逻辑上的，而不是语法上的，低效的代码。但是不要误解我的意思，`for`循环也不是“坏”的。远非如此！***

# 什么时候使用 for 循环？

如果您需要处理庞大的列表，这时就可以感觉到性能的影响。除了速度，`for`循环还能给你定制的行为。他们可以做一些特殊的事情，比如:使用`break`或`continue`；使用数字而不是数组；使用`await`；从任何地方开始，向任何方向移动任何数量。但是要注意，在循环中使用[中断/继续](https://eslint.org/docs/rules/no-continue)和[等待也是有成本的。请注意，这些都不是很宽泛的原因，这解释了为什么更多的开发人员默认使用新奇的方法，而`for`只在必要时循环。](https://eslint.org/docs/rules/no-await-in-loop#top)

# 事情正在发生变化

多年来，`for`循环是唯一真正的选择。我认为我主要从老开发者那里听到抱怨的原因是因为改变看起来是不必要的。从技术上来说*比*更有性能，方法也没有*那么*不同，所以不继续用老方法了？相信我，我能理解。JS 开发者倾向于涌向最新的东西，仅仅因为它是**新的** *(* 看着你*苗条)*。但是使用数组迭代器并不像是为了改变而改变，而是对长期困扰的一个很好的改进。这仅仅是下一个*迭代。*

大家编码快乐，

麦克风