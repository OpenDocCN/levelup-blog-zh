<html>
<head>
<title>Generative Adversarial Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/generative-adversarial-network-c34cbd25f07f?source=collection_archive---------29-----------------------#2020-06-08">https://levelup.gitconnected.com/generative-adversarial-network-c34cbd25f07f?source=collection_archive---------29-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5ab7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2014å¹´ï¼ŒIan Goodfellowå’Œå…¶ä»–äººåœ¨Yoshua Bengioçš„å®éªŒå®¤é‡Œé¦–æ¬¡æŠ¥é“äº†â€œç”Ÿæˆæ•Œå¯¹ç½‘ç»œâ€ã€‚ä»é‚£ä»¥åï¼ŒGANså¼€å§‹æµè¡Œèµ·æ¥ã€‚è¿™é‡Œæœ‰å‡ ä¸ªä¾‹å­å¯ä¾›å‚è€ƒ:</p><ul class=""><li id="cfa5" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated"><a class="ae ko" href="https://affinelayer.com/pixsrv/" rel="noopener ugc nofollow" target="_blank"> Pix2Pix </a></li><li id="1fe6" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated"><a class="ae ko" href="https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix" rel="noopener ugc nofollow" target="_blank">æœ±ä¿Šå½¦PyTorchçš„cycle gan&amp;pix 2 pix</a></li><li id="99f3" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated"><a class="ae ko" href="https://github.com/wiseodd/generative-models" rel="noopener ugc nofollow" target="_blank">ç”Ÿæˆæ¨¡å‹åˆ—è¡¨</a></li></ul><p id="9e70" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">GANsèƒŒåçš„æƒ³æ³•æ˜¯ä¸€ä¸ªäººæœ‰ä¸¤ä¸ªç½‘ç»œï¼Œä¸€ä¸ªç”Ÿæˆå™¨<em class="ld">ğº</em>å’Œä¸€ä¸ªé‰´åˆ«å™¨<em class="ld"> ğ· </em>ï¼Œç›¸äº’ç«äº‰ã€‚ç”Ÿæˆå™¨ç”Ÿæˆâ€œå‡â€æ•°æ®ä¼ é€’ç»™é‰´åˆ«å™¨ã€‚é‰´åˆ«å™¨è¿˜å¯ä»¥çœ‹åˆ°çœŸå®çš„è®­ç»ƒæ•°æ®ï¼Œå¹¶é¢„æµ‹å®ƒæ”¶åˆ°çš„æ•°æ®æ˜¯çœŸæ˜¯å‡ã€‚</p><ul class=""><li id="b0b0" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">ç”Ÿæˆå™¨è¢«è®­ç»ƒæ¥æ¬ºéª—é‰´åˆ«å™¨ï¼Œå®ƒæƒ³è¦è¾“å‡ºçœ‹èµ·æ¥å°½å¯èƒ½æ¥è¿‘çœŸå®è®­ç»ƒæ•°æ®çš„æ•°æ®ã€‚</li><li id="d613" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">é‰´åˆ«å™¨æ˜¯ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå®ƒè¢«è®­ç»ƒæ¥æ‰¾å‡ºå“ªäº›æ•°æ®æ˜¯çœŸå®çš„ï¼Œå“ªäº›æ˜¯è™šå‡çš„ã€‚</li></ul><p id="47fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æœ€ç»ˆå‘ç”Ÿçš„æƒ…å†µæ˜¯ï¼Œç”Ÿæˆå™¨å­¦ä¹ ç”Ÿæˆä¸é‰´åˆ«å™¨çš„çœŸå®æ•°æ®æ— æ³•åŒºåˆ†çš„æ•°æ®ã€‚</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/3fada5587a1846dff949b8c6808b145c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAsh_gYDCDZ63OUmqKf19g.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">å›¾ç‰‡æ¥æº:Udacity</figcaption></figure><h2 id="1e4c" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">æ„å»ºGAN:</h2><p id="6846" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å°è¯•å»ºç«‹ä¸€ä¸ªç®€å•çš„ç”˜äº§ç”Ÿæ–°çš„æ‰‹å†™å›¾åƒçš„åŸºç¡€ä¸ŠMNISTæ•°æ®é›†ã€‚</p><p id="681a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­¥éª¤1:åŠ è½½å¿…è¦çš„åº“ï¼Œæˆ‘ä»¬å°†ä¸ºè¿™ä¸ªæ¨¡å‹ä½¿ç”¨PyTorchã€‚</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="cdc7" class="lu lv it mt b gy mx my l mz na">%matplotlib inline<br/>import numpy as np<br/>import torch<br/>import matplotlib.pyplot as plt<br/>from torchvision import datasets<br/>import torchvision.transforms as transforms<br/>import torch.nn as nn<br/>import torch.nn.functional as F<br/>import torch.optim as optim<br/>import pickle as pkl</span></pre><p id="7fa3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­¥éª¤2:ç°åœ¨æˆ‘ä»¬å°†åŠ è½½å†…ç½®çš„MNISTæ•°æ®é›†ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ‰¹é‡å¤§å°ä¸º64çš„train_loaderã€‚</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="edfa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­¥éª¤3:å¯è§†åŒ–æ•°æ®</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">å¯è§†åŒ–æ•°æ®çš„ä»£ç </figcaption></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/80d099107a6be9673c68c30d6d2c81b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*b0Jo4ZOIxr9V2tj-FraxSQ.png"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">ä¸Šè¿°ä»£ç çš„è¾“å‡º</figcaption></figure><h2 id="042a" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">å®šä¹‰æ¨¡å‹</h2><p id="731f" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">ä¸€ä¸ªGANç”±ä¸¤ä¸ªå¯¹ç«‹çš„ç½‘ç»œç»„æˆï¼Œä¸€ä¸ªé‰´åˆ«å™¨å’Œä¸€ä¸ªç”Ÿæˆå™¨ã€‚</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ne"><img src="../Images/b50c48fe5938d7e404e8b37b39324bf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBRiW5y71sSJTjhRbpIWhw.png"/></div></div></figure><h2 id="dbc2" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">é‰´åˆ«å™¨</h2><p id="83cf" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">é‰´åˆ«å™¨ç½‘ç»œå°†ä¼šæ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„çº¿æ€§åˆ†ç±»å™¨ã€‚ä¸ºäº†ä½¿è¿™ä¸ªç½‘ç»œæˆä¸ºä¸€ä¸ªé€šç”¨çš„å‡½æ•°æŒªç”¨å™¨ï¼Œæˆ‘ä»¬è‡³å°‘éœ€è¦ä¸€ä¸ªéšè—å±‚ï¼Œå¹¶ä¸”è¿™äº›éšè—å±‚åº”è¯¥æœ‰ä¸€ä¸ªå…³é”®å±æ€§ã€‚è¿™é‡Œæˆ‘ä»¬å°†å®šä¹‰3ä¸ªéšè—å±‚å’Œ1ä¸ªå…¨è¿æ¥å±‚ã€‚æ¯ä¸€å±‚éƒ½æœ‰ä¸€ä¸ªæ¼é‡æ¿€æ´»åŠŸèƒ½ã€‚æ³„æ¼çš„ReLUç±»ä¼¼äºæ™®é€šçš„ReLUï¼Œåªæ˜¯å¯¹äºè´Ÿè¾“å…¥å€¼æœ‰ä¸€ä¸ªå°çš„éé›¶è¾“å‡ºï¼Œå®ƒæ˜¯é€šè¿‡ä¹˜ä»¥ä¸€ä¸ªå°å¸¸æ•°å¾—åˆ°çš„ã€‚</p><p id="ad42" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬è¿˜å°†é‡‡ç”¨åœ¨è¾“å‡ºç«¯ä½¿ç”¨æ•°å€¼ä¸Šæ›´ç¨³å®šçš„æŸå¤±å‡½æ•°çš„æ–¹æ³•ã€‚å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›é‰´åˆ«å™¨è¾“å‡ºä¸€ä¸ª0â€“1çš„å€¼ï¼Œè¡¨ç¤ºä¸€å¹…å›¾åƒæ˜¯<em class="ld">çœŸçš„è¿˜æ˜¯å‡çš„</em>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆè¾“å‡ºå±‚ä¸åº”è¯¥æœ‰ä»»ä½•æ¿€æ´»åŠŸèƒ½åº”ç”¨äºå®ƒã€‚</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="a691" class="lu lv it mt b gy mx my l mz na">class Discriminator(nn.Module):<br/> def __init__(self, input_size, hidden_dim, output_size):<br/>  super(Discriminator, self).__init__()<br/> <br/>    # define all layers<br/> <br/>    #There are three hidden layers<br/>    self.layer1=nn.Linear(input_size,hidden_dim*4)<br/>    self.layer2=nn.Linear(hidden_dim*4,hidden_dim*2)<br/>    self.layer3=nn.Linear(hidden_dim*2,hidden_dim)<br/> <br/>    #This is the fully connected layer<br/>    self.layer4=nn.Linear(hidden_dim,output_size)<br/> <br/>    #A dropout with value 0.2 is added<br/>    self.dropout=nn.Dropout(0.2)<br/> <br/> def forward(self, x):<br/>    # flatten image<br/>    x=x.view(-1,28*28)<br/>    # pass x through all layers<br/>    # apply leaky relu activation to all hidden layers<br/>    x=F.leaky_relu(self.layer1(x),0.2)<br/>    x=self.dropout(x)<br/>    x=F.leaky_relu(self.layer2(x),0.2)<br/>    x=self.dropout(x)<br/>    x=F.leaky_relu(self.layer3(x),0.2)<br/>    x=self.dropout(x)<br/> <br/>    output=self.layer4(x)<br/>    return output</span></pre><h2 id="9c71" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">å‘ç”µæœº</h2><p id="f09f" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">å‘ç”Ÿå™¨ç½‘ç»œå°†ä¸é‰´åˆ«å™¨ç½‘ç»œå‡ ä¹å®Œå…¨ç›¸åŒï¼Œé™¤äº†æˆ‘ä»¬å°†ä¸€ä¸ª<a class="ae ko" href="https://pytorch.org/docs/stable/nn.html#tanh" rel="noopener ugc nofollow" target="_blank">åŒæ›²æ­£åˆ‡æ¿€æ´»å‡½æ•°</a>åº”ç”¨åˆ°æˆ‘ä»¬çš„è¾“å‡ºå±‚ã€‚å·²ç»å‘ç°ï¼Œå¯¹äºå‘ç”µæœºè¾“å‡ºæ¥è¯´ï¼Œå…·æœ‰<em class="ld"> ğ‘¡ğ‘ğ‘›â„ </em>çš„å‘ç”µæœºè¡¨ç°æœ€ä½³ï¼Œå…¶å°†è¾“å‡ºç¼©æ”¾åˆ°-1å’Œ1ä¹‹é—´ï¼Œè€Œä¸æ˜¯0å’Œ1ã€‚</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="7762" class="lu lv it mt b gy mx my l mz na">class Generator(nn.Module):</span><span id="2b8f" class="lu lv it mt b gy nf my l mz na">  def __init__(self, input_size, hidden_dim, output_size):<br/>   super(Generator, self).__init__()<br/> <br/>     # define all layers<br/> <br/>     #There are three hidden layers<br/>     self.layer1=nn.Linear(input_size,hidden_dim)<br/>     self.layer2=nn.Linear(hidden_dim,hidden_dim*2)<br/>     self.layer3=nn.Linear(hidden_dim*2,hidden_dim*4)<br/> <br/>     #This is the fully connected layer<br/>     self.layer4=nn.Linear(hidden_dim*4,output_size)<br/> <br/>     #A dropout with value 0.2 is added<br/>     self.dropout=nn.Dropout(0.2)</span><span id="e8e2" class="lu lv it mt b gy nf my l mz na"> def forward(self, x):<br/>     # pass x through all layers<br/> <br/>     # final layer should have tanh applied<br/>     x=F.leaky_relu(self.layer1(x),0.2)<br/>     x=self.dropout(x)<br/>     x=F.leaky_relu(self.layer2(x),0.2)<br/>     x=self.dropout(x)<br/>     x=F.leaky_relu(self.layer3(x),0.2)<br/>     x=self.dropout(x)<br/>     output=F.tanh(self.layer4(x))<br/>     return output</span></pre><p id="20ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸‹ä¸€æ­¥æ˜¯ä¸ºæˆ‘ä»¬çš„æ¨¡å‹è®¾ç½®è¶…å‚æ•°</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="c6a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç°åœ¨æˆ‘ä»¬å°†å»ºç«‹å®Œæ•´çš„æ¨¡å‹ã€‚</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="ba11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¾“å‡ºå°†æ˜¾ç¤ºæˆ‘ä»¬å®Œæ•´çš„æ¨¡å‹æ¶æ„ï¼Œ</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="b953" class="lu lv it mt b gy mx my l mz na">Discriminator(<br/>  (layer1): Linear(in_features=784, out_features=128, bias=True)<br/>  (layer2): Linear(in_features=128, out_features=64, bias=True)<br/>  (layer3): Linear(in_features=64, out_features=32, bias=True)<br/>  (layer4): Linear(in_features=32, out_features=1, bias=True)<br/>  (dropout): Dropout(p=0.2)<br/>)<br/><br/>Generator(<br/>  (layer1): Linear(in_features=100, out_features=32, bias=True)<br/>  (layer2): Linear(in_features=32, out_features=64, bias=True)<br/>  (layer3): Linear(in_features=64, out_features=128, bias=True)<br/>  (layer4): Linear(in_features=128, out_features=784, bias=True)<br/>  (dropout): Dropout(p=0.2)<br/>)</span></pre><h2 id="b9bb" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">é‰´é¢‘å™¨æŸè€—</h2><p id="6211" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">å¯¹äºé‰´åˆ«å™¨ï¼Œæ€»æŸå¤±æ˜¯çœŸå®å’Œä¼ªé€ å›¾åƒçš„æŸå¤±ä¹‹å’Œï¼Œ<code class="fe ng nh ni mt b">d_loss = d_real_loss + d_fake_loss</code>ã€‚è¯·è®°ä½ï¼Œæˆ‘ä»¬å¸Œæœ›é‰´é¢‘å™¨ä¸ºçœŸå®å›¾åƒè¾“å‡º1ï¼Œä¸ºè™šå‡å›¾åƒè¾“å‡º0ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è®¾ç½®æŸè€—æ¥åæ˜ è¿™ä¸€ç‚¹ã€‚</p><p id="9ed5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æŸå¤±å°†ç”±äºŒå…ƒäº¤å‰ç†µæŸå¤±ä¸logitsï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸<a class="ae ko" href="https://pytorch.org/docs/stable/nn.html#bcewithlogitsloss" rel="noopener ugc nofollow" target="_blank"> BCEWithLogitsLoss </a>ã€‚è¿™å°†<code class="fe ng nh ni mt b">sigmoid</code>æ¿€æ´»å‡½æ•°<strong class="js iu">å’Œ</strong>äºŒå…ƒäº¤å‰ç†µæŸå¤±ç»“åˆåœ¨ä¸€ä¸ªå‡½æ•°ä¸­ã€‚</p><h2 id="cb72" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">å‘ç”µæœºæŸè€—</h2><p id="94ed" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">åªæœ‰åœ¨æ ‡ç­¾ç¿»è½¬çš„æƒ…å†µä¸‹ï¼Œå‘ç”µæœºæŸè€—æ‰ä¼šçœ‹èµ·æ¥ç›¸ä¼¼ã€‚ç”Ÿæˆå™¨çš„ç›®æ ‡æ˜¯å¾—åˆ°<code class="fe ng nh ni mt b">D(fake_images) = 1</code>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ‡ç­¾è¢«<strong class="js iu">ç¿»è½¬</strong>ä»¥è¡¨ç¤ºç”Ÿæˆå™¨è¯•å›¾æ¬ºéª—é‰´åˆ«å™¨ï¼Œä½¿å…¶è®¤ä¸ºç”Ÿæˆçš„å›¾åƒ(èµå“)æ˜¯çœŸå®çš„ï¼</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="f449" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬å¸Œæœ›åˆ†åˆ«æ›´æ–°ç”Ÿæˆå™¨å’Œé‰´åˆ«å™¨å˜é‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸¤ä¸ªç‹¬ç«‹çš„Adamä¼˜åŒ–å™¨ã€‚</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="c7fe" class="nj lv it bd lw nk nl nm lz nn no np mc nq nr ns mf nt nu nv mi nw nx ny ml nz bi translated">åŸ¹å…»</h1><p id="9c77" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">è®­ç»ƒå°†åŒ…æ‹¬äº¤æ›¿è®­ç»ƒé‰´åˆ«å™¨å’Œå‘ç”Ÿå™¨ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å‡½æ•°<code class="fe ng nh ni mt b">real_loss</code>å’Œ<code class="fe ng nh ni mt b">fake_loss</code>æ¥å¸®åŠ©æˆ‘ä»¬è®¡ç®—ä»¥ä¸‹æ‰€æœ‰æƒ…å†µä¸‹çš„é‰´é¢‘å™¨æŸè€—ã€‚</p><h2 id="b6ec" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">ç”„åˆ«è®­ç»ƒ</h2><p id="c38d" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">åœ¨çœŸå®çš„è®­ç»ƒå›¾åƒä¸Šè®¡ç®—é‰´åˆ«å™¨æŸå¤±ï¼Œç„¶åç”Ÿæˆå‡å›¾åƒã€‚æœ€åï¼Œæ‰§è¡Œåå‘ä¼ æ’­+ä¼˜åŒ–æ¥æ›´æ–°é‰´åˆ«å™¨çš„æƒé‡ã€‚</p><h2 id="949b" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">å‘ç”µæœºåŸ¹è®­</h2><p id="626f" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">ä½¿ç”¨<strong class="js iu">ç¿»è½¬çš„</strong>æ ‡ç­¾ç”Ÿæˆå‡å›¾åƒå¹¶è®¡ç®—å‡å›¾åƒçš„é‰´åˆ«å™¨æŸè€—ã€‚æ‰§è¡Œåå‘ä¼ æ’­+ä¼˜åŒ–æ¥æ›´æ–°ç”Ÿæˆå™¨çš„æƒé‡ã€‚</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="ddb6" class="lu lv it mt b gy mx my l mz na">num_epochs = 100<br/>samples = []<br/>losses = []<br/>print_every = 400</span><span id="5443" class="lu lv it mt b gy nf my l mz na">sample_size=16<br/>fixed_z = np.random.uniform(-1, 1, size=(sample_size, z_size))<br/>fixed_z = torch.from_numpy(fixed_z).float()</span><span id="0223" class="lu lv it mt b gy nf my l mz na">D.train()<br/>G.train()<br/>for epoch in range(num_epochs):<br/>   for batch_i, (real_images, _) in enumerate(train_loader):<br/>        batch_size = real_images.size(0)<br/>        real_images = real_images*2â€“1 <br/>        d_optimizer.zero_grad()<br/>        D_real = D(real_images)<br/>        d_real_loss = real_loss(D_real, smooth=True)<br/> <br/>        z = np.random.uniform(-1, 1, size=(batch_size, z_size))<br/>        z = torch.from_numpy(z).float()<br/>        fake_images = G(z)<br/> <br/>        D_fake = D(fake_images)<br/>        d_fake_loss = fake_loss(D_fake)<br/> <br/>        d_loss = d_real_loss + d_fake_loss<br/>        d_loss.backward()<br/>        d_optimizer.step()<br/> <br/>        g_optimizer.zero_grad()<br/> <br/>        z = np.random.uniform(-1, 1, size=(batch_size, z_size))<br/>        z = torch.from_numpy(z).float()<br/>        fake_images = G(z)<br/>        D_fake = D(fake_images)<br/>        g_loss = real_loss(D_fake) <br/>        g_loss.backward()<br/>        g_optimizer.step()<br/>        if batch_i % print_every == 0:<br/>             print(â€˜Epoch [{:5d}/{:5d}] | d_loss: {:6.4f} | g_loss:  <br/>                   {:6.4f}â€™.format(epoch+1, num_epochs,  <br/>                    d_loss.item(), g_loss.item()))</span><span id="e1ad" class="lu lv it mt b gy nf my l mz na">## AFTER EACH EPOCH##<br/>   losses.append((d_loss.item(), g_loss.item()))<br/>   G.eval() <br/>   samples_z = G(fixed_z)<br/>   samples.append(samples_z)<br/>   G.train()</span><span id="a62e" class="lu lv it mt b gy nf my l mz na">with open(â€˜train_samples.pklâ€™, â€˜wbâ€™) as f:<br/>   pkl.dump(samples, f)</span></pre><h2 id="72f7" class="lu lv it bd lw lx ly dn lz ma mb dp mc kb md me mf kf mg mh mi kj mj mk ml mm bi translated">åŸ¹è®­æŸå¤±</h2><p id="a5bc" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">è¿™é‡Œæˆ‘ä»¬å°†ç»˜åˆ¶å‘ç”Ÿå™¨å’Œé‰´åˆ«å™¨çš„è®­ç»ƒæŸè€—ï¼Œåœ¨æ¯ä¸ªæ—¶æœŸåè®°å½•ã€‚</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/fedc52ee45d50603c3309a0087754d06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*ZbU-gpL9-yWZTaS_SJezNg.png"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">åŸ¹è®­æŸå¤±</figcaption></figure><p id="b34f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æœ€åï¼Œè®©æˆ‘ä»¬æµ‹è¯•ç”Ÿæˆçš„æ–°å›¾åƒã€‚</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/f5705cc05e769b1e580f9d448d2d5b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*Avp1YwUMel8xwzn8k2VlTQ.png"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">æ–°MNISTå½¢è±¡ï¼ï¼</figcaption></figure><p id="748c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Tadaï¼è¿™é‡Œä½¿ç”¨GANï¼Œç”Ÿæˆäº†æ–°çš„æ‰‹å†™å›¾åƒã€‚ç±»ä¼¼åœ°ï¼ŒGANså¯ç”¨äºä»ç°æœ‰å›¾åƒç”Ÿæˆæ–°å›¾åƒã€‚äº«å—æ¢ç´¢ç”˜æ–¯çš„ä¹è¶£ã€‚</p><p id="bd12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç¼–ç å¿«ä¹ï¼</p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><div class="lf lg lh li gt oj"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">ç¼–å†™é¢è¯•é—®é¢˜</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">ä¸€ä¸ªå®Œæ•´çš„å¹³å°ï¼Œåœ¨è¿™é‡Œæˆ‘ä¼šæ•™ä½ æ‰¾åˆ°ä¸‹ä¸€ä»½å·¥ä½œæ‰€éœ€çš„ä¸€åˆ‡ï¼Œä»¥åŠâ€¦</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">æŠ€æœ¯å¼€å‘</p></div></div><div class="os l"><div class="ot l ou ov ow os ox lo oj"/></div></div></a></div></div></div>    
</body>
</html>