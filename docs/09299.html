<html>
<head>
<title>Python Refactoring Tips to Write Code in Pythonic Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python重构技巧以python方式编写代码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-refactoring-tips-to-write-code-in-pythonic-way-6b8ff4375b3a?source=collection_archive---------6-----------------------#2021-07-25">https://levelup.gitconnected.com/python-refactoring-tips-to-write-code-in-pythonic-way-6b8ff4375b3a?source=collection_archive---------6-----------------------#2021-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2f1b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">更简洁代码的Python重构技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/63958cd7fb120dcc0fd2fdb13a953dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pHc4ms5ati7cnRzn"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">乔尔·莫特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="87b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码重构是代码中最有趣也是最重要的部分之一。重构代码不仅使代码更具可读性，还减少了不必要的行数。</p><p id="5e40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论是软件开发还是一些编码竞赛，到处都需要代码重构。你有责任让你的代码更具可读性，这样其他人就可以容易地阅读它，并且理解你实现了什么逻辑来解决任何特定的问题。</p><p id="5354" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将介绍一些代码重构技巧，这些技巧将帮助您以更Python化的方式编写Python代码，并使其可读。我们开始吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6ab1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.从循环中提取语句</h1><p id="1c71" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">很多时候，我们在一个循环中定义了一个变量，而这个变量的值永远不会改变。下面是同样的例子:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="690c" class="ne md it na b gy nf ng l nh ni">for address in addresses:<br/>    city = "New York"<br/>    location.append(address.street_address, city)</span></pre><p id="c994" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，没有必要在循环中声明变量，因为变量的值永远不会改变。</p><p id="4871" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，我们可以在循环之外声明变量。这样，我们只需要创建一次变量。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="9e3a" class="ne md it na b gy nf ng l nh ni">city = "New York"<br/>for address in addresses:<br/>    location.append(address.street_address, city)</span></pre><p id="d20a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，我们不需要在每次循环迭代时都创建变量。</p><h1 id="663b" class="mc md it bd me mf nj mh mi mj nk ml mm jz nl ka mo kc nm kd mq kf nn kg ms mt bi translated">2.合并嵌套If语句</h1><p id="3abb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们使用嵌套If来检查多个条件。下面是一个嵌套If语句的例子。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="8878" class="ne md it na b gy nf ng l nh ni">if a &gt; 5:<br/>    if b &lt; 10:<br/>        print("Checking conditions")</span></pre><p id="e03f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以重构这段代码，在一行中检查多个条件，而不是在多行中检查多个条件。下面是一个例子:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7f66" class="ne md it na b gy nf ng l nh ni">if a &gt; 5 and b &lt; 10:<br/>     print("Checking conditions")</span></pre><p id="4079" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种检查多个<code class="fe no np nq na b">if</code>条件的方式比上面的例子更具可读性。</p><h1 id="b650" class="mc md it bd me mf nj mh mi mj nk ml mm jz nl ka mo kc nm kd mq kf nn kg ms mt bi translated">3.简化序列检查</h1><p id="db3b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">很多时候，我们需要检查集合中是否有条目，比如列表、元组和字典，然后检查集合的长度是否大于零。</p><p id="e49d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个例子:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7047" class="ne md it na b gy nf ng l nh ni">if len(list_of_fruits) &gt; 0:<br/>   fruit_to_eat = choose_fruit(list_of_fruits)</span></pre><p id="217c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，我们可以写:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="78d7" class="ne md it na b gy nf ng l nh ni">if list_of_fruits:<br/>    fruit_to_eat = choose_fruit(list_of_fruits)</span></pre><p id="6323" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种重构的方式比前一种方式更具Pythonic式。这也被称为<a class="ae ky" href="https://docs.python.org/3/library/stdtypes.html" rel="noopener ugc nofollow" target="_blank">真值测试</a>。</p><h1 id="c9dd" class="mc md it bd me mf nj mh mi mj nk ml mm jz nl ka mo kc nm kd mq kf nn kg ms mt bi translated">4.使用Any而不是循环</h1><p id="0f0a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了检查列表中是否有负数，我们使用循环遍历列表，并检查当前数字是否为负数。一旦满足负数的条件，我们就打破循环。</p><p id="2458" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是检查负数的代码:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1d9b" class="ne md it na b gy nf ng l nh ni">nums = [1,5,7,9,-3, 15]<br/>flag = False</span><span id="9e9f" class="ne md it na b gy nr ng l nh ni">for num in nums:<br/>    if num &lt; 0:<br/>        flag = True<br/>        break</span></pre><p id="9b4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，我们可以对这段代码使用<code class="fe no np nq na b">Any()</code>函数。下面是一个例子:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="e40f" class="ne md it na b gy nf ng l nh ni">nums = [1,5,7,9,-3,15]<br/>flag = any(num&lt;0 for num in nums) </span></pre><p id="54c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果给定iterable中的任何一项为真，这个<code class="fe no np nq na b">Any()</code>函数返回真，否则返回假。</p><h1 id="25c8" class="mc md it bd me mf nj mh mi mj nk ml mm jz nl ka mo kc nm kd mq kf nn kg ms mt bi translated">5.删除只使用一次的内联变量</h1><p id="5326" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这种情况会发生很多次，我们在函数内部声明一个变量，然后在下一行返回它。这里有一个简单的例子:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="4dc1" class="ne md it na b gy nf ng l nh ni">def sum(a, b):<br/>    total = a + b<br/>    return total</span></pre><p id="0f1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，声明额外的变量是多余的，如果我们在下一行返回它。</p><p id="7908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是同一个示例的重构代码:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ad01" class="ne md it na b gy nf ng l nh ni">def sum(a, b):<br/>    return a+b </span></pre><p id="1e5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方式更简洁，我们不会在冗余变量上浪费内存。</p><h1 id="b954" class="mc md it bd me mf nj mh mi mj nk ml mm jz nl ka mo kc nm kd mq kf nn kg ms mt bi translated">6.用If表达式替换If语句</h1><p id="cd6a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们不用使用<code class="fe no np nq na b">if</code>和<code class="fe no np nq na b">else</code>语句来设置变量的值，而是使用if表达式在一行中设置它。</p><p id="5caa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个正常做法的例子:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="947f" class="ne md it na b gy nf ng l nh ni">if condition:<br/>    flag = True<br/>else:<br/>    flag = False</span></pre><p id="198c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是同一个示例的重构代码:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="fdf2" class="ne md it na b gy nf ng l nh ni">flag = True if condition else False</span></pre><p id="81c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上两个例子都在执行相同的任务，你可以选择哪一个。</p><h1 id="65a0" class="mc md it bd me mf nj mh mi mj nk ml mm jz nl ka mo kc nm kd mq kf nn kg ms mt bi translated">7.添加保护条款</h1><p id="b786" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当使用<code class="fe no np nq na b">if</code>和<code class="fe no np nq na b">else</code>条件时，深度嵌套的函数有时会难以理解。在许多函数中，我们看到许多嵌套的<code class="fe no np nq na b">if</code>条件，然后在最后有一个<code class="fe no np nq na b">else</code>条件。</p><p id="d8a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是这种情况的一个例子:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="74b3" class="ne md it na b gy nf ng l nh ni">def do_i_need_hat(self, hat):<br/>    if isInstance(hat, Hat):<br/>        weather_outside = getWeatherReport()<br/>        if weather_outside.is_raining:<br/>            print("Yes")<br/>            return True<br/>        else:<br/>            return False<br/>    else:<br/>        return False</span></pre><p id="ba99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以通过以下方式重构该代码:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1dc6" class="ne md it na b gy nf ng l nh ni">def do_i_need_hat(self, hat):<br/>    if not isInstance(hat, Hat):<br/>        return False</span><span id="0863" class="ne md it na b gy nr ng l nh ni">if isInstance(hat, Hat):<br/>        weather_outside = getWeatherReport()<br/>        if weather_outside.is_raining:<br/>            print("Yes")<br/>            return True<br/>        else:<br/>            return False</span></pre><p id="044c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们通过反转条件并在开始时返回它，添加了一个保护子句。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cecd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="397d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这就是这篇文章的全部内容。在本文中，我们已经讨论了如何重构我们的python代码。重构代码是开发过程中的一个重要部分。代码重构的主要目的是提高代码的可读性和可维护性。</p><p id="04d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="a371" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里免费订阅我的时事通讯:<a class="ae ky" href="https://pralabhsaxena.medium.com/subscribe" rel="noopener"> Pralabh的时事通讯</a></p></div></div>    
</body>
</html>