<html>
<head>
<title>Observer Design Pattern in Golang with an Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Golang中的观察者设计模式及实例</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/observer-design-pattern-in-golang-with-an-example-6c24898059b1?source=collection_archive---------0-----------------------#2021-11-03">https://levelup.gitconnected.com/observer-design-pattern-in-golang-with-an-example-6c24898059b1?source=collection_archive---------0-----------------------#2021-11-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6a85" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Golang中实现观察者设计模式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9e2a159b30d5d87d47f40542b9feabe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hCcO490x_pBnI85G"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@claybanks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">粘土银行</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="ff93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">观察者设计模式</strong>是一个软件设计模式，它允许你定义一个订阅机制来通知多个对象他们正在观察的对象发生的任何事件。</p><p id="87fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是最简单也是最广泛使用的模式之一。它有许多真实的用例。以下是一些最常见的。</p><ul class=""><li id="13d8" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">新闻公司与订户之间的报纸订阅。</li><li id="5779" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">手机闹钟在特定的时间醒来。</li><li id="c3c7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">移动天气应用程序不断更新温度和湿度。</li><li id="780c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">股票交易应用程序显示最新的股票价格。</li></ul><p id="0bf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对观察者模式感到有点好奇？让我们做好准备，了解更多。</p><h1 id="2172" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">主体和观察者</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/83dd4ffbfda22af7469b56c2fb279b7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*q-CkIA6Iqk7RA5xb9N2oRg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">主体和观察者的关系，由作者绘制</figcaption></figure><p id="435a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">观察者模式的两个重要概念是<strong class="lb iu">主体</strong>和<strong class="lb iu">观察者</strong>。</p><ul class=""><li id="5ef9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">观察者</strong>:对主体感兴趣的对象</li><li id="824c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">主体</strong>:是被观察的对象。</li></ul><p id="38e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们举个例子说明一下。</p><p id="6007" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设你对新闻感兴趣，并想订阅最新的新闻。这里有一个新闻聚合器。它从各种来源收集新闻，然后把新闻发布给你。</p><p id="2c79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，新闻聚合器是主题，而您是观察者之一。每次聚合器更新新闻时，都会通知所有订阅者该新闻。</p><p id="8400" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主体和观察者的关系是<strong class="lb iu">一对多</strong>。这意味着一个主体维护一个观察者列表。<strong class="lb iu">当受试者感知到一些状态变化时，它会通知所有观察者这种变化</strong>。这就是为什么我们把这种模式归为行为范畴。</p><h1 id="03aa" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">Go中的实现</h1><p id="1116" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">假设你对股票市场感兴趣。您有以下需求:</p><ul class=""><li id="e5ab" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">你想跟踪某个特定公司的股票价格(例如苹果公司)。</li><li id="9e44" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">你不想错过任何股票价格的更新，尤其是当价格下跌到某一点的时候。</li><li id="6eba" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">你希望得到所有股票价格更新的通知。</li></ul><p id="58a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以使用观察者模式来实现这一点。太棒了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/85d4f57f43381590114bc2593a4ca2dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*GYNWlZJyv1lmEth_i-OF_Q.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">UML图</figcaption></figure><p id="960d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图是观察者模式的UML。这对我们了解所有物体的全貌很有帮助。</p><p id="d312" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们先来关注一下<em class="ni">主体和观察者接口</em>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">观察者-主体-界面</figcaption></figure><ul class=""><li id="67c2" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><em class="ni">主题接口</em>定义了三个必要的方法签名。<code class="fe nl nm nn no b">attach</code>和<code class="fe nl nm nn no b">detach</code>用于将观察者与被摄对象连接和分离。<code class="fe nl nm nn no b">notify</code>用于通知该主题的所有观察者。</li><li id="de4c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><em class="ni">观察者接口</em>定义了一个方法签名<code class="fe nl nm nn no b">Update</code>。符合某个条件时会被主体触发。</li></ul><p id="aaed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们创建一个具体的观察者<em class="ni"> StockObserver </em>来实现观察者接口。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">具体观察者</figcaption></figure><p id="c121" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，我们创建一个具体的subject <em class="ni"> StockMonitor </em>来实现subject接口。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="e935" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还为S <em class="ni"> tockMonitor对象定义了一些内部字段和方法。</em></p><ul class=""><li id="652f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe nl nm nn no b">observers</code>定义一个附加到<code class="fe nl nm nn no b">stockMonitor</code>对象的观察点切片</li><li id="53ae" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nl nm nn no b">ticker</code>定义某种股票的代号(如AAPL)</li><li id="f1d8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nl nm nn no b">price</code>定义某种股票的价格</li><li id="9d1b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nl nm nn no b">setPrice</code>用于设置一只股票的价格</li><li id="bba3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nl nm nn no b">String</code>用于打印受试者的内部状态</li></ul><p id="67ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，主文件来了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">主文件</figcaption></figure><p id="f4a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一部分</p><ul class=""><li id="db08" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们创建两个观察者，<code class="fe nl nm nn no b">observerA</code>和<code class="fe nl nm nn no b"><em class="ni">observerB</em></code>。</li><li id="e7e4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将它们连接到<code class="fe nl nm nn no b">stockMonitor</code>上。</li><li id="c7b3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">改变<code class="fe nl nm nn no b">stockMonitor</code>的价格。我们看到<code class="fe nl nm nn no b">observerA</code>和<code class="fe nl nm nn no b">obsererB</code>都被通知了。</li><li id="cb38" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将<code class="fe nl nm nn no b">observerA</code>从<code class="fe nl nm nn no b">stockMonitor</code>上拆下，改变股价。我们可以看到只有<code class="fe nl nm nn no b">observerB</code>被通知。</li></ul><h1 id="a7aa" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">松散耦合考虑</h1><p id="75c3" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">在观察者模式中，主体和观察者是松散耦合的。</p><ul class=""><li id="4090" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">主体只知道观察者，反之则不然。</li><li id="57dc" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">观察者可以连接到多个主题</li><li id="7800" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">新的观察者可以在任何时候附在主题上。在附加之后，它将被通知所有的更改。</li><li id="91e6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">从主题中分离观察者不会通知观察者所做的更改。</li></ul></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="28a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">发现这篇文章很有用👏？看看我下面的其他文章吧！</p><div class="nw nx gp gr ny nz"><a rel="noopener  ugc nofollow" target="_blank" href="/solid-principles-in-golang-explained-by-examples-4a4cccf47388"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">举例说明戈兰语中的固体原理</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">对于有经验的程序员来说，这些坚实的原则并不陌生。它们为我们提供了如何安排功能和…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a rel="noopener  ugc nofollow" target="_blank" href="/how-does-golang-channel-works-6d66acd54753"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">Golang频道是如何工作的</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">了解戈朗通道的内部运作</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oi l"><div class="oo l ok ol om oi on ks nz"/></div></div></a></div></div></div>    
</body>
</html>