<html>
<head>
<title>Orchestrate data pipelines with Apache Airflow!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Apache Airflow编排数据管道！</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/orchestrate-data-pipelines-with-apache-airflow-7dae6338fe90?source=collection_archive---------3-----------------------#2022-05-04">https://levelup.gitconnected.com/orchestrate-data-pipelines-with-apache-airflow-7dae6338fe90?source=collection_archive---------3-----------------------#2022-05-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6d07" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">需要每天执行数据管道？阿帕奇气流就是你需要的。</h2><div class=""/><div class=""><h2 id="0a38" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">只需几个基本和必要的步骤，即可创建生产就绪的项目。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/19f82936617b03b859e6e16cc4872ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rPMQ55pBEcOU7lYs.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来源:阿帕奇气流官方网站</figcaption></figure><p id="c38b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">每个组织每天都执行一组活动。那么，为了执行这些活动，每天运行相同的脚本或整个过程不会令人沮丧吗？我们将这个过程自动化或者将这样的任务分配给一台机器怎么样？这肯定会节省我们很多精力和时间，对吗？感谢现代世界，我们有了气流！</p><p id="fb83" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">Apache Airflow是一个开源工具，用于创建、调度和监控称为<strong class="lg ja">工作流</strong>的流程和任务。换句话说，Apache Airflow是一个编排数据管道生命周期的工具。它有一个丰富的用户界面，可以轻松地可视化工作流、监控进度，并在需要时解决问题。我们可以将这些工作流的数据与多个数据源连接起来，并在任务完成或失败时通过电子邮件发送警报。</p><p id="59c8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">Airflow利用<strong class="lg ja">有向无环图(Dag)</strong>来管理工作流的编排。DAG由任务和任务依赖关系组成。它们涉及任务的执行、运行它们的顺序，以及超时时执行任务的重试。DAG可以在特定时间触发，也可以基于外部触发器触发。气流概念非常广泛。因此，我们将涉及某些领域，如</p><ul class=""><li id="bc74" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">存储变量和连接</li><li id="f302" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">使用多个脚本</li><li id="148e" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">DAG调度程序</li><li id="3b1a" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">生成电子邮件</li></ul><blockquote class="mo mp mq"><p id="3cd5" class="le lf mr lg b lh li ka lj lk ll kd lm ms lo lp lq mt ls lt lu mu lw lx ly lz ij bi translated">在我们开始之前，请随意访问我的GitHub库，找到下面这篇文章的源代码— <a class="ae mv" href="https://github.com/ginelledsouza/Airflow" rel="noopener ugc nofollow" target="_blank">气流</a>！</p></blockquote></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="91df" class="nd ne iq bd nf ng nh ni nj nk nl nm nn kf no kg np ki nq kj nr kl ns km nt nu bi translated"><strong class="ak">存储变量和连接</strong></h1><p id="cd9b" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">几个模块组合在一起完成一项特定的任务。每个模块都需要配置文件来连接数据库和云服务。一些模块可能还需要静态变量来设计和处理它们的活动。那么这可能吗？当然！我们现在将研究如何将安全连接凭证和静态变量存储到airflow服务器中。</p><h2 id="9b02" class="oa ne iq bd nf ob oc dn nj od oe dp nn ln of og np lr oh oi nr lv oj ok nt iw bi translated"><strong class="ak">变量</strong></h2><p id="649b" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">Airflow允许用户存储和检索多种类型的变量，如整数、字符串、列表、字典等。Airflow将变量存储为一个简单的键值对。可以直接从用户界面列出、创建、更新和删除变量。然而，这种方法有一个问题。我们丢失了每个新的airflow服务器实例的存储变量。但是，我们不必担心，因为有几种方法可以创建、更新和删除变量。我们将寻找其他方法来永久保留我们的变量。</p><p id="d042" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja"> 1。气流网络服务器用户界面</strong></p><ul class=""><li id="95e7" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">从气流用户界面选择<code class="fe ol om on oo b">Admin → Variables </code>。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi op"><img src="../Images/cd99f15dffcdfaa2398e4d6af4f41186.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*bOTc6VhbIF8B1vcy_72mjQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">管理→变量</figcaption></figure><ul class=""><li id="e708" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">点击<code class="fe ol om on oo b">Choose File</code>，从你的电脑中找到你的变量JSON。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/c30355783629038feec5f348005e9a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nbXZydY6QsipvC5ib4rV9Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">导入的变量“zelle_columns_UI”</figcaption></figure><ul class=""><li id="f0e0" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">点击<code class="fe ol om on oo b">Import Variables</code>。现在，变量存储成功。</li></ul><p id="f099" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja"> 2。命令行界面</strong></p><p id="3fd5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果您正在使用基于Linux的机器或者已经在windows机器中安装了相同的机器，那么可以使用命令行界面来创建变量。通过命令行界面，我们可以使用以下语法将变量导入到airflow web服务器。</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="f141" class="oa ne iq oo b gy ov ow l ox oy">airflow variables import &lt;filepath&gt;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oz"><img src="../Images/05112acbbee3b63efbed0f38ebd1bdcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_3G2rt6Qq-52sJVNhuLUg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Ubuntu CLI —变量</figcaption></figure><p id="c359" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">其中，Variables.json是</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="7785" class="oa ne iq oo b gy ov ow l ox oy">{"zelle_columns_CLI" : {"data_columns": ["heard","change"]}}</span></pre><p id="4918" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja"> 3。Python代码</strong></p><p id="b167" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">气流模型库提供了两种方法— <code class="fe ol om on oo b">Variable.set()</code>和<code class="fe ol om on oo b">Variable.get()</code>。顾名思义，<code class="fe ol om on oo b">Variable.set()</code>是用来在气流上创建变量的。而<code class="fe ol om on oo b">Variable.get()</code>检索变量的值。使用气流模型模块中的<code class="fe ol om on oo b">Variable.set()</code>方法，我们导入所需的变量。按照语法，我们可以导入变量</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="d3cd" class="oa ne iq oo b gy ov ow l ox oy">Variable.set(KEY,VALUE)</span></pre><p id="c3c2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">例子</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="3a85" class="oa ne iq oo b gy ov ow l ox oy">from airflow.models import Variable</span><span id="c24b" class="oa ne iq oo b gy pa ow l ox oy">import json</span><span id="942d" class="oa ne iq oo b gy pa ow l ox oy">f = open('Variables.json')</span><span id="b403" class="oa ne iq oo b gy pa ow l ox oy">data = json.load(f)</span><span id="cc8e" class="oa ne iq oo b gy pa ow l ox oy">Variable.set('zelle_columns_CODE',data)</span></pre><p id="6e95" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">变量导入成功</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/1d6a432dc0f8e9cb891a2e7df9ac298f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IogrCTVlE-0xBiOOFzLFXQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">变量</figcaption></figure><h2 id="eeec" class="oa ne iq bd nf ob oc dn nj od oe dp nn ln of og np lr oh oi nr lv oj ok nt iw bi translated">连接</h2><p id="4f1a" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">我们可以将值作为变量存储在airflow服务器中。但是，我们绝不能选择将敏感信息存储为变量。气流提供了我们可以用来存储和维护敏感信息的连接。连接值可以导入到airflow web服务器，如下所示。</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="434f" class="oa ne iq oo b gy ov ow l ox oy">airflow connections add 'my_prod_db' <strong class="oo ja">\</strong><br/>    --conn-type 'my-conn-type' <strong class="oo ja">\</strong><br/>    --conn-login 'login' <strong class="oo ja">\</strong><br/>    --conn-password 'password' <strong class="oo ja">\</strong><br/>    --conn-host 'host' <strong class="oo ja">\</strong><br/>    --conn-port 'port' <strong class="oo ja">\</strong><br/>    --conn-schema 'schema'</span></pre><p id="53ed" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">例子</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="f92e" class="oa ne iq oo b gy ov ow l ox oy">airflow connections add zelle_connection --conn-type postgresql<br/>    --conn-login postgres --conn-password &lt;password&gt;<br/>    --conn-host localhost --conn-port 5432 --conn-schema zelle</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/79b31514e1d96bdbffe763c9ad2f0462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iA-71c6ibSYR7FXxUKBgbg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Ubuntu CLI —连接</figcaption></figure><h1 id="c66f" class="nd ne iq bd nf ng pd ni nj nk pe nm nn kf pf kg np ki pg kj nr kl ph km nt nu bi translated">使用多个脚本</h1><p id="275b" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">DAG脚本从单个或多个文件导入并执行任务。为此，我们从另一个脚本中导入一个函数，并根据它们的优先级将它们排列成任务。当我们使用另一个文件中的函数/方法时，我们必须定义该函数的完整路径。我的文件结构如下。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/e19809f38d1c3dfff646fa729fffbb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*jlVKdra8eYhuTlefZhAKHg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">项目文件结构</figcaption></figure><p id="2301" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">analysis.py脚本由三种方法组成— record_analysis、table_analysis和extract_database。我们现在将通过下面的代码行从analysis.py访问record_analysis。</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="4877" class="oa ne iq oo b gy ov ow l ox oy">from github.includes.analysis import record_analysis</span></pre><p id="ca2d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">一旦我们导入了函数/方法，我们就把它分配给一个任务。</p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="5070" class="oa ne iq oo b gy ov ow l ox oy">with dag:</span><span id="008f" class="oa ne iq oo b gy pa ow l ox oy">t1 = PythonOperator(task_id='t1',python_callable=record_analysis)</span></pre><h1 id="7187" class="nd ne iq bd nf ng pd ni nj nk pe nm nn kf pf kg np ki pg kj nr kl ph km nt nu bi translated"><strong class="ak"> DAG调度器</strong></h1><p id="393b" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">DAG接受参数schedule_interval，该参数接收CRON表达式或字符串作为输入。此参数负责在指定时间执行DAG中的任务。schedule_interval接受一个字符串或CRON表达式作为输入。</p><h2 id="d9a1" class="oa ne iq bd nf ob oc dn nj od oe dp nn ln of og np lr oh oi nr lv oj ok nt iw bi translated">串表达式</h2><p id="91d7" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">Airflow提供了现成的调度表达式。我们可以使用以下任何字符串来计划我们的DAG。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pj"><img src="../Images/556f4b4cc570c70dec1a7d7e3ddf2a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eoZMcbqQQcI0nyj2mgNHeQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae mv" href="https://airflow.apache.org/docs/apache-airflow/1.10.1/scheduler.html#dag-runs" rel="noopener ugc nofollow" target="_blank"> DAG运行</a></figcaption></figure><p id="248b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">示例</strong></p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="7be7" class="oa ne iq oo b gy ov ow l ox oy">dag = DAG('demoautomation', schedule_interval='<a class="ae mv" href="http://twitter.com/daily" rel="noopener ugc nofollow" target="_blank">@daily</a>',   <br/>           default_args=default_args, catchup=False)</span></pre><h2 id="65e6" class="oa ne iq bd nf ob oc dn nj od oe dp nn ln of og np lr oh oi nr lv oj ok nt iw bi translated">CRON表达式</h2><p id="85b1" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">借助CRON表达式，我们可以根据需要设置触发时间。CRON表达式是一个由五到六个字段组成的字符串，由空格分隔，表示一组时间。以下示例将在每天凌晨4:00运行DAG。</p><p id="a730" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">举例</strong></p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="43b2" class="oa ne iq oo b gy ov ow l ox oy">dag = DAG('demoautomation', schedule_interval='0 4 * * *',   <br/>           default_args=default_args, catchup=False)</span></pre><h1 id="a70d" class="nd ne iq bd nf ng pd ni nj nk pe nm nn kf pf kg np ki pg kj nr kl ph km nt nu bi translated">生成电子邮件</h1><p id="0fab" class="pw-post-body-paragraph le lf iq lg b lh nv ka lj lk nw kd lm ln nx lp lq lr ny lt lu lv nz lx ly lz ij bi translated">气流数据管道负责执行几个过程。我们很有可能会遇到复杂情况或错误。对于这种情况，建议启用SMTP服务。当任务使用Airflows SMTP服务完成或失败时，用户可以通过电子邮件发送警报。因此，让我们将此分为两步:</p><p id="71ab" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja"> 1。在</strong> <code class="fe ol om on oo b">airflow.cfg</code>【使用Gmail代理】中设置SMTP连接</p><p id="c40b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">开始之前，我们需要生成一个16位密码。我们将使用Google帐户设置中的应用程序密码页面创建一个密码。在这里，有必要通知我们的谷歌帐户，一个外部设备将需要访问和使用我们的邮件。谷歌账户将提供一个在airflow.cfg内使用的16位密码。</p><ul class=""><li id="0c20" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">登录您的Gmail帐户并访问→ <a class="ae mv" href="https://security.google.com/settings/security/apppasswords" rel="noopener ugc nofollow" target="_blank">应用程序密码</a></li><li id="2599" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">在底部，点击<strong class="lg ja">选择应用</strong>并选择<strong class="lg ja">邮件</strong>。</li><li id="5bcd" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">点击<strong class="lg ja">选择设备</strong>并选择您的设备。</li><li id="2a59" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">选择<strong class="lg ja">生成</strong>。</li><li id="673f" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">复制并保存16位密码。</li><li id="05d2" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">选择<strong class="lg ja">完成</strong>。</li></ul><p id="2ea8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们现在可以设置<code class="fe ol om on oo b">airflow.cfg</code></p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="2cfb" class="oa ne iq oo b gy ov ow l ox oy">#<!-- -->airflow.cfg</span><span id="4b31" class="oa ne iq oo b gy pa ow l ox oy">[smtp]<br/>smtp_host = smtp.gmail.com<br/>smtp_starttls = True<br/>smtp_ssl = False<br/>smtp_user = &lt;youremailaddress&gt;<br/>smtp_password = &lt;16digitgeneratedpassword&gt;<br/>smtp_port = 587<br/>smtp_mail_from = &lt;youremailaddress&gt;</span></pre><p id="0b2b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">例子</strong></p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="3c13" class="oa ne iq oo b gy ov ow l ox oy">#<!-- -->airflow.cfg</span><span id="9d0a" class="oa ne iq oo b gy pa ow l ox oy">[smtp]<br/>smtp_host = smtp.gmail.com<br/>smtp_starttls = True<br/>smtp_ssl = False<br/>smtp_user = <a class="ae mv" href="mailto:dummysource@gmail.com" rel="noopener ugc nofollow" target="_blank">dummysource@gmail.com</a><br/>smtp_password = jfhdyetagsbfhtuf<br/>smtp_port = 587<br/>smtp_mail_from = <a class="ae mv" href="mailto:dummysource@gmail.com" rel="noopener ugc nofollow" target="_blank">dummysource@gmail.com</a></span></pre><p id="2135" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja"> 2。在DAG脚本中设置电子邮件触发器</strong></p><p id="5359" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">一旦我们在<code class="fe ol om on oo b">airflow.cfg</code>中生成并配置了SMTP服务，我们将使用<code class="fe ol om on oo b">email</code>和<code class="fe ol om on oo b">email_on_failure</code>参数。这里，参数email可以是单个电子邮件地址，也可以是由逗号或分号分隔的一系列电子邮件地址。email_on_failure指示当任务失败时是否应该发送电子邮件警报</p><p id="839e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">例子</strong></p><pre class="kp kq kr ks gt or oo os ot aw ou bi"><span id="9182" class="oa ne iq oo b gy ov ow l ox oy">default_args = {'owner': 'airflow', 'start_date': datetime(2021, 1, 1),'email': ['<a class="ae mv" href="mailto:dummysource@gmail.com" rel="noopener ugc nofollow" target="_blank">dummysource@gmail.com</a>'],'email_on_failure': True}</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pk"><img src="../Images/ddd5496e162a1ecc22f733c59188fffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNpEwfg4JJhx17gju8NjzQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">气流日志</figcaption></figure></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="c90f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">万岁！我们终于完成了这篇激动人心的文章。</p><p id="768b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">感谢您的阅读！:)</p></div></div>    
</body>
</html>