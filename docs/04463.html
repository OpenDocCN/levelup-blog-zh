<html>
<head>
<title>Building API with the Beego framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Beego框架构建API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-api-with-the-beego-framework-ffb400da4a20?source=collection_archive---------7-----------------------#2020-06-28">https://levelup.gitconnected.com/building-api-with-the-beego-framework-ffb400da4a20?source=collection_archive---------7-----------------------#2020-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4fba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每当我们创建一个应用程序时，web应用程序框架是必不可少的，因为它通过消除编写大量复杂代码的需要并提供模型、服务和其他组件等功能，大大加快并简化了我们的工作。使用应用程序框架，我们可以利用其架构设计的优势，并促进应用程序的增长。</p><p id="051f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">模型-视图-控制器是web应用程序框架的一种流行形式。MVC的工作原理是分别呈现每一个。我们将向您展示如何使用Bee框架帮助您使API变得简单快捷</p><p id="c219" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开终端，通过命令安装<strong class="js iu"><em class="ko">github.com/beego/bee</em></strong>包</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="90e2" class="ky kz it ku b gy la lb l lc ld">$ go get github.com/beego/bee</span></pre><p id="4df8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将下面几行添加到<strong class="js iu"> ~/。bashrc </strong>，还会继续。但是您可以使用其他路径作为<strong class="js iu"> GOPATH </strong>，而不是示例中的<strong class="js iu"> $HOME/go </strong>。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="92f6" class="ky kz it ku b gy la lb l lc ld">export GOPATH=$HOME/go<br/>export PATH=$PATH:$GOROOT/bin:$GOPATH/bin</span></pre><p id="2f5f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">和put命令为您的特定环境设置shell。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="fc6b" class="ky kz it ku b gy la lb l lc ld">$ source ~/.bashrc</span></pre><p id="0a7c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，你可以使用<strong class="js iu"> <em class="ko">蜂</em> </strong>命令</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="bc2f" class="ky kz it ku b gy la lb l lc ld">$ bee help</span></pre><p id="db08" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该会看到以下输出:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="a732" class="ky kz it ku b gy la lb l lc ld">Bee is a Fast and Flexible tool for managing your Beego Web Application.</span><span id="0fec" class="ky kz it ku b gy le lb l lc ld">USAGE<br/>    bee command [arguments]</span><span id="29f3" class="ky kz it ku b gy le lb l lc ld">AVAILABLE COMMANDS</span><span id="130c" class="ky kz it ku b gy le lb l lc ld">version     Prints the current Bee version<br/>    migrate     Runs database migrations<br/>    api         Creates a Beego API application<br/>    bale        Transforms non-Go files to Go source files<br/>    fix         Fixes your application by making it compatible with newer versions of Beego<br/>    dlv         Start a debugging session using Delve<br/>    dockerize   Generates a Dockerfile for your Beego application<br/>    generate    Source code generator<br/>    hprose      Creates an RPC application based on Hprose and Beego frameworks<br/>    new         Creates a Beego application<br/>    pack        Compresses a Beego application into a single file<br/>    rs          Run customized scripts<br/>    run         Run the application by starting a local development server<br/>    server      serving static content over HTTP on port</span><span id="c571" class="ky kz it ku b gy le lb l lc ld">Use bee help [command] for more information about a command.</span><span id="8dea" class="ky kz it ku b gy le lb l lc ld">ADDITIONAL HELP TOPICS</span><span id="1749" class="ky kz it ku b gy le lb l lc ld">Use bee help [topic] for more information about that topic.<br/>bee: Too many arguments.<br/>Use bee help for more information.</span></pre><p id="5167" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们想创建一个API应用程序，我们可以使用<strong class="js iu"> <em class="ko">蜜蜂</em> </strong> <strong class="js iu"> <em class="ko">帮助api </em> </strong>命令获取更多信息</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="48d3" class="ky kz it ku b gy la lb l lc ld">$ bee help api</span><span id="86fb" class="ky kz it ku b gy le lb l lc ld">USAGE<br/>  bee api [appname]</span><span id="12ff" class="ky kz it ku b gy le lb l lc ld">OPTIONS<br/>  -conn<br/>      Connection string used by the driver to connect to a database instance.</span><span id="a235" class="ky kz it ku b gy le lb l lc ld">-driver<br/>      Database driver. Either mysql, postgres or sqlite.</span><span id="8f63" class="ky kz it ku b gy le lb l lc ld">-tables<br/>      List of table names separated by a comma.</span><span id="1eaf" class="ky kz it ku b gy le lb l lc ld">DESCRIPTION<br/>  The command 'api' creates a Beego API application.</span><span id="ad19" class="ky kz it ku b gy le lb l lc ld">Example:<br/>      $ bee api [appname] [-tables=""] [-driver=mysql] [-conn="root:<a class="ae lf" href="http://twitter.com/tcp" rel="noopener ugc nofollow" target="_blank">@tcp</a>(127.0.0.1:3306)/test"]</span><span id="156c" class="ky kz it ku b gy le lb l lc ld">If 'conn' argument is empty, the command will generate an example API application. Otherwise the command<br/>  will connect to your database and generate models based on the existing tables.</span><span id="e42e" class="ky kz it ku b gy le lb l lc ld">The command 'api' creates a folder named [appname] with the following structure:</span><span id="94d2" class="ky kz it ku b gy le lb l lc ld">├── main.go<br/>     ├── conf<br/>     │     └── app.conf<br/>     ├── controllers<br/>     │     └── object.go<br/>     │     └── user.go<br/>     ├── routers<br/>     │     └── router.go<br/>     ├── tests<br/>     │     └── default_test.go<br/>     └── models<br/>           └── object.go<br/>           └── user.go</span></pre><p id="a080" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们使用<strong class="js iu"> <em class="ko"> bee api </em> </strong>命令创建一个项目</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="edca" class="ky kz it ku b gy la lb l lc ld">$ bee api my-api -driver=postgres \<br/>-conn="postgres://user:pass@localhost:5432/db?sslmode=disable" &amp;&amp; \<br/>cd my-api</span></pre><p id="cc63" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它将在控制台上创建一个新项目，如下图所示</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="f8c4" class="ky kz it ku b gy la lb l lc ld">______<br/>| ___ \<br/>| |_/ /  ___   ___<br/>| ___ \ / _ \ / _ \<br/>| |_/ /|  __/|  __/<br/>\____/  \___| \___| v1.10.0<br/>23:42:16 INFO     ▶ 0001 Creating API...<br/> create  /Users/go/src/my-api<br/> create  /Users/go/src/my-api/conf<br/> create  /Users/go/src/my-api/controllers<br/> create  /Users/go/src/my-api/tests<br/> create  /Users/go/src/my-api/conf/app.conf<br/> create  /Users/go/src/my-api/main.go<br/>23:42:16 INFO     ▶ 0002 Using 'postgres' as 'driver'<br/>23:42:16 INFO     ▶ 0003 Using 'postgres://user:pass@localhost:5432/db?sslmode=disable' as 'conn'<br/>23:42:16 INFO     ▶ 0004 Using '' as 'tables'<br/>23:42:16 INFO     ▶ 0005 Analyzing database tables...<br/>23:42:16 INFO     ▶ 0006 Creating model files...<br/> create  /Users/go/src/my-api/models/migrations.go<br/> create  /Users/go/src/my-api/models/cars.go<br/>23:42:16 INFO     ▶ 0007 Creating controller files...<br/> create  /Users/go/src/my-api/controllers/migrations.go<br/> create  /Users/go/src/my-api/controllers/cars.go<br/>23:42:16 INFO     ▶ 0008 Creating router files...<br/> create  /Users/go/src/my-api/routers/router.go<br/>23:42:16 SUCCESS  ▶ 0009 New API successfully created!</span></pre><p id="8e05" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一步我们需要通过命令设置go mod</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="fb20" class="ky kz it ku b gy la lb l lc ld">$ go mod init</span></pre><p id="47ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们通过命令运行API</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="6c41" class="ky kz it ku b gy la lb l lc ld">$ bee run</span></pre><p id="12fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦命令成功执行，如下所示</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="c827" class="ky kz it ku b gy la lb l lc ld">______<br/>| ___ \<br/>| |_/ /  ___   ___<br/>| ___ \ / _ \ / _ \<br/>| |_/ /|  __/|  __/<br/>\____/  \___| \___| v1.10.0<br/>23:50:56 INFO     ▶ 0001 Using 'my-api' as 'appname'<br/>23:50:56 INFO     ▶ 0002 Initializing watcher...<br/>my-api/routers<br/>my-api<br/>23:51:01 SUCCESS  ▶ 0003 Built Successfully!<br/>23:51:01 INFO     ▶ 0004 Restarting 'my-api'...<br/>23:51:01 SUCCESS  ▶ 0005 './my-api' is running...<br/>23:51:01.964 [I] [router.go:270]  /Users/go/src/my-api/controllers no changed<br/>23:51:01.965 [I] [router.go:270]  /Users/go/src/my-api/controllers no changed<br/>23:51:02.003 [I] [asm_amd64.s:1373]  http server Running on <a class="ae lf" href="http://:8080" rel="noopener ugc nofollow" target="_blank">http://:8080</a></span></pre><p id="4c8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用‘bee generate scaffold’命令。该命令需要三个选项:</p><ul class=""><li id="6e9a" class="lg lh it js b jt ju jx jy kb li kf lj kj lk kn ll lm ln lo bi translated">田地（复数）；场；域；字段</li><li id="27ac" class="lg lh it js b jt lp jx lq kb lr kf ls kj lt kn ll lm ln lo bi translated">驾驶员</li><li id="f209" class="lg lh it js b jt lp jx lq kb lr kf ls kj lt kn ll lm ln lo bi translated">指挥操舵</li></ul><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="e27b" class="ky kz it ku b gy la lb l lc ld">$ bee generate scaffold user -fields="first_name:string:255,last_name:string:255,email:string:255" -driver=postgres -conn="postgres://user:pass@localhost:5432/db?sslmode=disable"</span></pre><p id="acd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将要求您一步一步地遵循以下步骤</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="c88c" class="ky kz it ku b gy la lb l lc ld">______<br/>| ___ \<br/>| |_/ /  ___   ___<br/>| ___ \ / _ \ / _ \<br/>| |_/ /|  __/|  __/<br/>\____/  \___| \___| v1.10.0<br/>00:08:46 INFO     ▶ 0001 Do you want to create a 'user' model? [Yes|No]<br/>Yes<br/>00:08:52 INFO     ▶ 0002 Using 'User' as model name<br/>00:08:52 INFO     ▶ 0003 Using 'models' as package name<br/> create  /Users/go/src/my-api/models/user.go<br/>00:08:53 INFO     ▶ 0004 Do you want to create a 'user' controller? [Yes|No]<br/>Yes<br/>00:08:56 INFO     ▶ 0005 Using 'User' as controller name<br/>00:08:56 INFO     ▶ 0006 Using 'controllers' as package name<br/>00:08:56 INFO     ▶ 0007 Using matching model 'User'<br/> create  /Users/go/src/my-api/controllers/user.go<br/>00:08:56 INFO     ▶ 0008 Do you want to create views for this 'user' resource? [Yes|No]<br/>No<br/>00:08:58 INFO     ▶ 0009 Do you want to create a 'user' migration and schema for this resource? [Yes|No]<br/>Yes<br/> create  /Users/go/src/my-api/database/migrations/20200528_000901_user.go<br/>00:09:01 INFO     ▶ 0010 Do you want to migrate the database? [Yes|No]<br/>No<br/>00:09:06 SUCCESS  ▶ 0011 All done! Don't forget to add  beego.Router("/user" ,&amp;controllers.UserController{}) to routers/route.go</span><span id="2942" class="ky kz it ku b gy le lb l lc ld">00:09:06 SUCCESS  ▶ 0012 Scaffold successfully generated!</span></pre><p id="ec85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦命令成功执行，bee将创建一个文件。/models/user.go，。/controllers/user.go并。/数据库/迁移/用户. go</p><p id="e9d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开route.go，按如下方式更改代码:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="2b02" class="ky kz it ku b gy la lb l lc ld">// Package routers define version and api routes<br/>// <a class="ae lf" href="http://twitter.com/APIVersion" rel="noopener ugc nofollow" target="_blank">@APIVersion</a> 1.0.0<br/>// <a class="ae lf" href="http://twitter.com/Title" rel="noopener ugc nofollow" target="_blank">@Title</a> My API<br/>// <a class="ae lf" href="http://twitter.com/Description" rel="noopener ugc nofollow" target="_blank">@Description</a> My API<br/>package routers</span><span id="47da" class="ky kz it ku b gy le lb l lc ld">import (<br/> "my-api/controllers"</span><span id="c7e3" class="ky kz it ku b gy le lb l lc ld">"github.com/astaxie/beego"<br/>)</span><span id="668f" class="ky kz it ku b gy le lb l lc ld">func init() {<br/> ns := beego.NewNamespace("/v1",<br/>  beego.NSNamespace("/user",<br/>   beego.NSInclude(<br/>    &amp;controllers.UserController{},<br/>   ),<br/>  ),<br/> )<br/> beego.AddNamespace(ns)<br/>}</span></pre><p id="1e13" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想要生成swagger文档，请使用命令</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="3a19" class="ky kz it ku b gy la lb l lc ld">$ bee generate docs</span></pre><p id="9ef0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦命令成功执行，如下所示</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="56dd" class="ky kz it ku b gy la lb l lc ld">______<br/>| ___ \<br/>| |_/ /  ___   ___<br/>| ___ \ / _ \ / _ \<br/>| |_/ /|  __/|  __/<br/>\____/  \___| \___| v1.10.0<br/>00:14:28 SUCCESS  ▶ 0001 Docs successfully generated!</span></pre><p id="0821" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以通过以下步骤让它自动生成文档:</p><p id="5a65" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过设置<code class="fe lu lv lw ku b">conf/app.conf</code>中的<code class="fe lu lv lw ku b">EnableDocs = true</code>来启用文档。</p><p id="8a73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用下面的命令运行API应用程序并自动重建文档。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="5023" class="ky kz it ku b gy la lb l lc ld">$ bee run -downdoc=true -gendoc=true</span></pre><p id="f827" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">参观你项目中的<code class="fe lu lv lw ku b">/swagger</code></p><p id="4150" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您的API文档现在是可用的。打开你的浏览器并检查它</p><figure class="kp kq kr ks gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lx"><img src="../Images/c920837122f6342abb77af6aee7f3b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C3KYpeZTS4G5nma0dSlU0Q.png"/></div></div></figure><p id="d485" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">API将在默认的Bee端口<code class="fe lu lv lw ku b">8080</code>上运行，浏览<code class="fe lu lv lw ku b">http://localhost:8080/swagger</code>将呈现swagger UI，你可以通过使用swagger UI来尝试你的API。</p><p id="a90f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这一章中，我们展示了Bee框架，它是最流行和最常用的API MVC框架之一。这个框架帮助你生成一些代码，非常简单</p></div></div>    
</body>
</html>