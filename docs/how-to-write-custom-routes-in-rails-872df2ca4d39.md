# 如何在 Rails 中编写自定义路线

> 原文：<https://levelup.gitconnected.com/how-to-write-custom-routes-in-rails-872df2ca4d39>

![](img/517abf63724c69fcbb25b1e1b995e895.png)

我项目的大部分后端都是用 Ruby on Rails 构建的。在 Flatiron 工作期间，我学习并使用 Ruby on Rails。我喜欢 Ruby，并且发现它比我在查塔胡奇技术学院学习的 Java 和 C#更容易使用和理解。

如果您曾经使用过 Rails，您可能知道" **routes** "是我们如何在特定的"**控制器**上访问或调用特定的"**方法**"。routes 文件位于 config 文件夹中。每次更新路由文件时，请**确保**您**重启**您的服务器(如果它当前正在运行)。一个项目的普通路线可能看起来像下面的例子，我将分解每一部分的含义。

```
get “/users”, to: “users#index”
```

本例中的 **HTTP 动词**是“ **get** ”。“get”将检索信息或数据。**"/用户"**是后端将寻找的 URL 路径。所以如果你在 **http://localhost:3000/** 上为你的项目或应用，访问“用户”的 URL 是**http://localhost:3000/users**。 **"to:"** 是一个关键字，指引路线应该往哪里走。最后，我们有**“用户数量指数”**。**用户**左边的井号是控制器的名称。右边的**索引**是我们想要在**用户**控制器上调用的方法的名称。所以基本上，这条路线是检索所有用户(通常 index 是检索所有条目，show 是针对某个特定条目)。

如果我们不需要任何自定义路线，我们可以**懒惰**或**高效**并在“用户”控制器的路线文件中编写以下内容。

`resources **:users**`

上面这一行将给我们**访问**控制器上的以下方法或动作。

**索引** —显示所有项目

**显示** —显示一个项目

**创建** —创建一个新项目

**新建** —返回用于创建项目的 HTML 表单

**更新** —更新现有的项目

**编辑** —返回用于更新项目的 HTML 表单

**销毁** —删除一个项目

但是如果我们需要访问用户控制器上的一个动作，而上面的列表中没有提供**呢？我们怎样才能做到这一点？**

## 海关路线，就是这样！

我现在将逐步解释如何在 Rails 中实现一个**自定义路由**！

## 场景示例:编写一个自定义路线来为用户添加朋友

我们将假设有 **2** 关系:用户和用户朋友。一个用户**有很多**好友，用户好友**属于** o 个用户。我们将在用户控制器上编写一个自定义路由，为用户添加一个新朋友，而不是创建另一个控制器。我们**不会**实际编写代码或逻辑来给用户添加好友。我们将**仅**展示如何在控制器上写入和访问路线。让我们得到它！

## 1.写路线

访问**配置**文件夹中的路线文件。在这里，我们将编写一个自定义路由来为用户添加朋友。

我们的 **HTTP 动词**将是“ **post** ”，因为我们将**为用户创建**一个新的 UserFriend。 **/add_friend** 是我们在用户控制器上访问该操作的路径。如果我们当前使用的是 localhost，URL 可能如下所示:

**http://localhost:3000/add _ friend**

我们希望将路由"**指向:**"用户控制器，并希望在用户控制器上调用 add_friend 操作。如果对 configs 文件夹中的任何内容进行了更改，请记得**重启**您的服务器。你**不会**注意到或者看到任何更新，直到服务器**重启**。如果不小心的话，这会导致大量的挫折。**相信我**，我知道！

## 2.在控制器上编写自定义操作

剩下的工作就是**在用户控制器上创建**自定义动作。我们所要做的就是导航到用户控制器并创建“ **add_friend** ”动作。用户控制器将包含在**控制器**文件夹中，该文件夹位于**应用**文件夹中。

在上面的代码文件中，我们在用户控制器上有两个动作。第一个动作可能是对一个控制器来说最**常见的**动作，即**指标**动作。理想情况下，索引操作返回数据库或数据表的所有项目。如果您不熟悉第 6 行的“ **include** ”，它允许一个“**有** **多个**”的关系返回它的**属于**的每一项(如果存在)。如果你以前从未使用过，这是一个很棒的特性。第 10–12 行包含我们的自定义操作！如你所见，我**没有**写添加好友的逻辑，因为这不是本文的**重点**。

## 3.测试您的新定制路线！

作为程序员，我们测试一切！这是确保一切按照我们期望的方式运行的唯一方法。我喜欢在 **add_friend** 动作中丢一个“ **byebug** ”来保证路线和动作设置正确。Byebug 是我最喜欢用来测试 Rails 的工具。

我们需要访问我们当前的用户，以便为该用户添加一个朋友。我喜欢通过使用第 12 行来测试，以确定**返回的是什么。如果我们调用**前端**到**后端**的 fetch 来添加一个朋友，并且后端点击 byebug，我们就知道自定义路由被正确设置**！加好友的逻辑不一定成立，但是**至少**我们击中了 byebug。**确保**我们的自定义路线和自定义动作成功同步**。在 byebug 中，您可以四处玩耍并**探索**哪些**参数**或**参数**会返回给您，以便高效地**识别**添加好友的算法。******

**您现在知道如何编写自定义路线了！在成功地写完你的第一个之后，它们是如此的容易实现。**感谢**的阅读，希望你发现这篇文章**有益**。如果您有任何问题或想要联系我，请不要犹豫！你可以在 [**LinkedIn**](https://www.linkedin.com/in/genecampbell3/) 上联系我，或者在这里 查看我的作品集网站[！我祝你度过美好的一天！](http://www.genecampbell3.net/)**

## **来源:**

**[](https://www.tutorialspoint.com/ruby-on-rails/rails-routes.htm) [## Ruby on Rails - Routes

### 路由模块提供了本地 Ruby 中的 URL 重写。这是一种将传入请求重定向到控制器和…

www.tutorialspoint.com](https://www.tutorialspoint.com/ruby-on-rails/rails-routes.htm)**