<html>
<head>
<title>Elasticsearch: What it is, how it works, and what it’s used for</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Elasticsearch:它是什么，它是如何工作的，它有什么用途</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/elasticsearch-what-it-is-how-it-works-and-what-its-used-for-52c735fa136d?source=collection_archive---------13-----------------------#2020-03-27">https://levelup.gitconnected.com/elasticsearch-what-it-is-how-it-works-and-what-its-used-for-52c735fa136d?source=collection_archive---------13-----------------------#2020-03-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e2ea0759ed06653f54574cb3cccfc7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t55fUDFkwdhwhV6PLQTy-g.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者照片</figcaption></figure><h1 id="677f" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">介绍</h1><p id="1909" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">当人们问“什么是Elasticsearch？”，有些人可能会回答它是“一个索引”、“一个搜索引擎”、“一个分析数据库”、“一个大数据解决方案”、“它很快而且可扩展”，或者“它有点像谷歌”。根据您对这项技术的熟悉程度，这些答案可能会让您更接近啊哈时刻，也可能会让您更加困惑。事实是，所有这些答案都是正确的，这也是Elasticsearch的吸引力所在。</p><p id="8ea3" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">多年来，Elasticsearch和围绕它发展起来的组件生态系统(称为“Elastic Stack”)已被用于越来越多的用例，从网站或文档的简单搜索、收集和分析日志数据，到用于数据分析和可视化的商业智能工具。那么，Elastic联合创始人Shay Bannon为他妻子的烹饪食谱创建的一个简单的搜索引擎是如何发展成为今天最受欢迎的企业搜索引擎和十大最受欢迎的数据库管理系统之一的呢？在这篇文章中，我们将通过理解什么是Elasticsearch，它是如何工作的，以及如何使用它来回答这个问题。让我们开始吧。</p><h1 id="3dd0" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是Elasticsearch？</h1><p id="21fc" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="lc ir"> <em class="me">就其核心而言，你可以把Elasticsearch想象成一个可以处理JSON请求并返回JSON数据的服务器。</em> </strong></p><p id="9352" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">Elasticsearch是一个分布式、开源的搜索和分析引擎，构建于Apache Lucene之上，用Java开发。它最初是Lucene开源搜索框架的可扩展版本，后来增加了水平扩展Lucene索引的能力。Elasticsearch允许您快速、近乎实时地存储、搜索和分析大量数据，并在几毫秒内给出答案。它能够实现快速搜索响应，因为它不是直接搜索文本，而是搜索索引。它使用基于文档的结构，而不是表和模式，并附带了大量REST APIs来存储和搜索数据。其核心是，你可以把Elasticsearch想象成一个可以处理JSON请求并返回JSON数据的服务器。</p><h1 id="2c5c" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Elasticsearch是如何工作的？</h1><p id="3c91" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">为了更好地理解Elasticsearch是如何工作的，让我们来看看它如何组织数据及其后端组件的一些基本概念。</p><h2 id="9616" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">文档</h2><p id="ec26" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">文档是可以在以JSON表示的Elasticsearch中被索引的信息的基本单元，JSON是全球互联网数据交换格式。您可以将文档想象成关系数据库中的一行，代表一个给定的实体——您正在搜索的东西。在Elasticsearch中，文档可以不仅仅是文本，它可以是用JSON编码的任何结构化数据。这些数据可以是数字、字符串和日期。每个文档都有一个惟一的ID和一个给定的数据类型，它描述了文档是哪种实体。例如，一个文档可以代表一篇百科全书文章或来自web服务器的日志条目。</p><h2 id="cd04" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">指数</h2><p id="bcc6" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">索引是具有相似特征的文档的集合。索引是在Elasticsearch中可以查询的最高级别的实体。您可以认为索引类似于关系数据库模式中的数据库。索引中的任何文档通常都是逻辑相关的。例如，在电子商务网站的上下文中，您可以有一个客户索引，一个产品索引，一个订单索引，等等。索引由一个名称来标识，该名称用于在对其中的文档执行索引、搜索、更新和删除操作时引用索引。</p><h2 id="814f" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">倒排索引</h2><p id="0fed" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Elasticsearch中的索引实际上是所谓的倒排索引，这是所有搜索引擎工作的机制。它是一种数据结构，存储从内容(如单词或数字)到其在一个文档或一组文档中的位置的映射。基本上，它是一个类似hashmap的数据结构，将您从一个单词引导到一个文档。倒排索引不直接存储字符串，而是将每个文档拆分成单独的搜索词(即每个单词)，然后将每个搜索词映射到这些搜索词所在的文档。例如，在下图中，术语“butterfly”出现在文档1中，因此它被映射到该文档。这可以作为在给定文档中查找搜索词的快速查找。通过使用分布式倒排索引，Elasticsearch可以从非常大的数据集中快速找到全文搜索的最佳匹配。</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1fc4cc804376a97db3274ae568f77781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Icgz_VJT5tXUBdS2WhqO0w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">倒排索引的可视化表示(作者照片)</figcaption></figure><h1 id="0598" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">后端组件</h1><h2 id="e512" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">串</h2><p id="b1f0" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Elasticsearch集群是由一个或多个连接在一起的节点实例组成的组。弹性搜索集群的强大之处在于跨集群中所有节点分配任务、搜索和索引。</p><h2 id="3dcc" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">结节</h2><p id="7368" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">节点是作为群集一部分的单个服务器。节点存储数据并参与集群的索引和搜索功能。Elasticsearch节点可以不同方式配置:</p><p id="d890" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">主节点</strong> —控制Elasticsearch集群，并负责所有集群范围的操作，如创建/删除索引和添加/删除节点。</p><p id="e31b" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">数据节点</strong> —存储数据并执行数据相关操作，如搜索和聚集。<br/> <br/> <strong class="lc ir">客户端节点</strong> —向主节点转发集群请求，向数据节点转发数据相关请求。</p><h2 id="6954" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">陶瓷或玻璃碎片</h2><p id="0c35" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Elasticsearch提供了将索引细分为多个片段(称为碎片)的能力。每个碎片本身就是一个全功能的独立“索引”，可以托管在集群中的任何节点上。通过将索引中的文档分布在多个分片上，并将这些分片分布在多个节点上，Elasticsearch可以确保冗余，这既可以防止硬件故障，又可以在节点添加到集群时提高查询能力。</p><h2 id="7b76" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">复制品</h2><p id="0ea1" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Elasticsearch允许您制作一个或多个索引碎片的副本，这些碎片被称为“副本碎片”或简称为“复制品”。基本上，副本碎片是主碎片的副本。索引中的每个文档都属于一个主碎片。副本提供了数据的冗余拷贝以防止硬件故障，并增加了处理读取请求(如搜索或检索文档)的能力。</p><h1 id="8037" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">弹性堆栈(ELK)</h1><p id="6eb5" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Elasticsearch是Elastic Stack的核心组件，是一套用于数据摄取、丰富、存储、分析和可视化的开源工具。它通常被称为“ELK”堆栈，以其组件Elasticsearch、Logstash和Kibana命名，现在还包括Beats。尽管其核心是一个搜索引擎，但用户开始使用Elasticsearch来搜索日志数据，并希望有一种方法来轻松获取和可视化这些数据。</p><h1 id="40fe" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">基巴纳</h1><p id="5d66" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Kibana是一个用于弹性搜索的数据可视化和管理工具，提供实时直方图、折线图、饼图和地图。它可以让您可视化您的Elasticsearch数据并浏览Elastic堆栈。您可以从一个问题开始选择您赋予数据形状的方式，以找出交互式可视化将把您引向何处。例如，由于Kibana经常用于日志分析，它允许您回答关于您的web点击来自哪里、您的分发URL等等的问题。</p><p id="8250" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">如果您没有在Elasticsearch上构建自己的应用程序，Kibana是一个很好的方法，可以通过强大而灵活的UI来搜索和可视化您的索引。然而，一个主要的缺点是，每一个可视化只能针对单个索引/索引模式工作。因此，如果您的索引包含完全不同的数据，您必须为每个索引创建单独的可视化。对于更高级的用例，<a class="ae md" href="https://www.knowi.com/" rel="noopener ugc nofollow" target="_blank"> Knowi </a>是一个不错的选择。它允许您跨多个索引连接您的Elasticsearch数据，并将其与其他SQL/NoSQL/REST-API数据源混合，然后在一个业务用户友好的UI中创建可视化。</p><h1 id="2bad" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Logstash</h1><p id="6dbb" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Logstash用于聚合和处理数据，并发送给Elasticsearch。它是一个开源的服务器端数据处理管道，可以同时从多个来源获取数据，对其进行转换，然后将其发送到collect。它还通过识别命名字段来构建结构，转换和准备数据，而不考虑数据的格式，并将它们转换为通用格式。例如，由于数据通常以各种格式分散在不同的系统中，Logstash允许您将不同的系统连接在一起，如web服务器、数据库、Amazon服务等。并以连续流的方式将数据发布到任何需要的地方。</p><h1 id="5b49" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">搜索</h1><p id="6132" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">Beats是一个轻量级、单一用途的数据传输代理集合，用于将来自成百上千个机器和系统的数据发送到Logstash或Elasticsearch。Beats非常适合收集数据，因为它们可以放在你的服务器上，放在你的容器中，或者作为功能部署，然后在Elasticsearch中集中数据。例如，Filebeat可以安装在你的服务器上，监控日志文件，解析它们，然后近乎实时地导入到Elasticsearch。</p><h1 id="360a" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Elasticsearch是用来做什么的？</h1><p id="c573" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">现在我们已经对什么是Elasticsearch、它背后的逻辑概念以及它的架构有了大致的了解，我们对它为什么以及如何用于各种用例有了更好的理解。下面，我们将研究Elasticsearch的一些主要用例，并提供一些公司如何使用它的例子。</p><h1 id="b503" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">主要使用案例</h1><p id="7b0a" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="lc ir">应用程序搜索</strong> — —针对严重依赖搜索平台进行数据访问、检索和报告的应用程序。</p><p id="93e5" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">网站搜索</strong> — —存储大量内容的网站发现，弹性搜索是一个非常有用的工具，可以进行有效和准确的搜索。毫无疑问，Elasticsearch正在网站搜索领域稳步发展。</p><p id="6186" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">企业搜索</strong> — — Elasticsearch允许企业范围的搜索，包括文档搜索、电子商务产品搜索、博客搜索、人员搜索以及你能想到的任何形式的搜索。事实上，它已经稳步渗透并取代了我们日常使用的大多数热门网站的搜索解决方案。从更特定于企业的角度来看，Elasticsearch已经在公司内部网中取得了巨大成功。</p><p id="0728" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">日志记录和日志分析</strong> — —正如我们已经讨论过的，Elasticsearch通常用于以接近实时和可扩展的方式接收和分析日志数据。它还提供了关于日志指标的重要运营见解，以推动行动。</p><p id="1bb2" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">基础设施指标和容器监控</strong> — —许多公司使用ELK堆栈来分析各种指标。这可能涉及收集因用例而异的几个性能参数的数据。</p><p id="99df" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">安全分析——elastic search的另一个主要分析应用是安全分析。可以使用ELK stack分析访问日志和与系统安全相关的类似日志，从而更全面地实时了解系统中发生的情况。</p><p id="a8cb" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">商业分析</strong>——ELK堆栈中的许多内置功能使其成为商业分析工具的良好选择。然而，在大多数组织中，实现这一产品有一个陡峭的学习曲线。在公司除了Elasticsearch之外还有多个数据源的情况下尤其如此——因为Kibana只处理Elasticsearch数据。一个很好的替代方案是<a class="ae md" href="https://www.knowi.com/elasticsearch-analytics" rel="noopener ugc nofollow" target="_blank"> Knowi </a>，这是一个分析平台，它与Elasticsearch进行了本机集成，甚至允许非技术业务用户创建可视化并对Elasticsearch数据进行分析，而无需事先了解ELK堆栈的知识或专业技能。</p><h1 id="bcd1" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">公司使用案例</h1><h2 id="f839" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">网飞</h2><p id="e9b1" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">网飞依靠跨各种用例的ELK堆栈来监控和分析客户服务操作和安全日志。例如，Elasticsearch是他们消息系统背后的底层引擎。此外，该公司选择Elasticsearch是因为它的自动分片和复制、灵活的模式、良好的扩展模型以及带有许多插件的生态系统。网飞稳步增加了对Elasticsearch的使用，从几个孤立的部署增加到十几个包含数百个节点的集群。</p><h2 id="4bc2" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">易趣</h2><p id="5c6f" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">凭借无数利用Elasticsearch作为主干的业务关键型文本搜索和分析用例，易贝创建了一个定制的“Elasticsearch即服务”平台，允许在其内部基于OpenStack的云平台上轻松配置Elasticsearch集群。</p><h2 id="ab05" class="mf kd iq bd ke mg mh dn ki mi mj dp km ll mk ml kq lp mm mn ku lt mo mp ky mq bi translated">沃尔玛</h2><p id="51d3" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">沃尔玛利用弹性堆栈揭示其数据的隐藏潜力，以近乎实时的方式获得对客户购买模式的洞察、跟踪商店绩效指标和假日分析。它还利用ELK的安全特性来实现SSO安全、异常检测警报和DevOps监控</p><h1 id="6337" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">摘要</h1><p id="0def" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">那么什么是Elasticsearch呢？在这篇文章中，我们试图通过理解它是什么，它是如何工作的，以及它是如何被使用的来回答这个问题，而我们仍然只是对它的所有知识略知皮毛。但基于我们所涵盖的内容，我们可以简单地总结一下，Elasticsearch的核心是一个搜索引擎，其底层架构和组件使其快速且可扩展，位于互补工具生态系统的核心，这些工具可以一起用于许多用例，包括搜索、分析、数据处理和存储。</p><p id="628d" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">如果你有兴趣了解更多关于Elasticsearch的知识并亲自尝试，你可以从这里开始。对于更高级的用例，您需要跨多个索引和其他SQL/NoSQL/REST-API数据源连接和混合您的Elasticsearch数据，请查看<a class="ae md" href="https://www.knowi.com/" rel="noopener ugc nofollow" target="_blank"> Knowi </a>，这是一个与Elasticsearch原生集成的分析平台，技术和非技术用户都可以访问。寻找快乐！</p><p id="aa61" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><em class="me">本文最初发表于此:</em> <a class="ae md" href="https://www.knowi.com/blog/what-is-elastic-search/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir"> <em class="me"> Elasticsearch:它是什么，它是如何工作的，它有什么用途</em> </strong> </a></p></div></div>    
</body>
</html>