<html>
<head>
<title>Promise.all, Promise.race, and the new ES2020 Promise.allSettled</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Promise.all、Promise.race和全新es 2020 promise . all已确定</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/promise-all-promise-race-and-the-new-es2020-promise-allsettled-bc5b2d65a028?source=collection_archive---------6-----------------------#2020-03-06">https://levelup.gitconnected.com/promise-all-promise-race-and-the-new-es2020-promise-allsettled-bc5b2d65a028?source=collection_archive---------6-----------------------#2020-03-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/7cb33f80fa6462b24f1c311242499af7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9Wu8uQhAqW4Ox7udgJc0g.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/s/photos/clock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kf" href="https://unsplash.com/@chuttersnap?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> chuttersnap </a>拍摄</figcaption></figure><p id="4ae1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">承诺</em>是ES6最激动人心的创新之一。你可能以前在Bluebird或Q这样的库上使用过<em class="le"> Promises </em>，但是它们在2015年才成为一个标准的JavaScript特性。</p><blockquote class="lf lg lh"><p id="77a0" class="kg kh le ki b kj kk kl km kn ko kp kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">Promise对象表示异步操作的最终完成(或失败)及其结果值。</p></blockquote><p id="1949" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个<em class="le">承诺</em>做一些可能需要一些时间的事情，但是如果一切顺利，最终它会<em class="le">解决</em>或者如果出了问题<em class="le">拒绝</em>。带<em class="le">。然后是</em>和<em class="le">。然后你可以分别对结果或错误做些什么。</em></p><figure class="ll lm ln lo gt ju"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="ea27" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们是在大约五年前推出的，所以<em class="le">承诺</em>对你来说应该不是什么新鲜事，但是ES2020有了一个新功能:<em class="le">承诺</em>。<em class="le">全部解决</em>。它填补了ES6 <em class="le">诺言.一切</em>和<em class="le">诺言.竞赛</em>留下的空白</p><h1 id="831b" class="lr ls it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">一系列承诺</h1><p id="6421" class="pw-post-body-paragraph kg kh it ki b kj mp kl km kn mq kp kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">你经常不仅要处理一个<em class="le">承诺</em>，还要处理一系列<em class="le">承诺</em>。如果您一次发送许多服务器请求，可能就是这种情况。</p><p id="31e5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我创建了一个包含五个<em class="le">承诺</em>的数组。他们<em class="le">以50%的概率解决</em>或<em class="le">拒绝</em>，经过一段时间(100毫秒，200毫秒，…，500毫秒)。</p><figure class="ll lm ln lo gt ju"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="375a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以手动处理这个<em class="le">承诺</em>数组，在这个例子中，我将结果存储在一个响应数组中。如果半秒钟后您在控制台中显示该阵列，您将看到如下内容:</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/30a7b19ef7c3914d1a5077a4c63c37ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PJj_IPIHnPsUoSwfE7L7LA.png"/></div></div></figure><p id="932a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是你经常想在所有的<em class="le">承诺</em>解决之后，或者一旦其中一个解决了，就去做一些事情。这有点棘手，这就是为什么<em class="le">承诺</em>和<em class="le">承诺.比赛</em>为你做这件事。</p><h1 id="798a" class="lr ls it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">承诺.比赛</h1><p id="2d63" class="pw-post-body-paragraph kg kh it ki b kj mp kl km kn mq kp kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated"><em class="le"> Promise.race </em>以<em class="le">承诺</em>的数组为参数，返回一个<em class="le">承诺</em>。该<em class="le">承诺</em>将在数组的<em class="le">承诺</em>中的一个承诺解决时解决，或者在一个承诺拒绝时拒绝。</p><figure class="ll lm ln lo gt ju"><div class="bz fp l di"><div class="lp lq l"/></div></figure><h1 id="a1a6" class="lr ls it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">承诺。所有</h1><p id="1dde" class="pw-post-body-paragraph kg kh it ki b kj mp kl km kn mq kp kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated"><em class="le"> Promise.all </em>在数组的所有<em class="le">承诺</em>解析后解析。</p><figure class="ll lm ln lo gt ju"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="6c4d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，如果一个<em class="le">承诺</em>拒绝，那么<em class="le">承诺</em>也会拒绝。</p><h1 id="22a3" class="lr ls it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">ES2020 Promise.allSettled</h1><p id="a18c" class="pw-post-body-paragraph kg kh it ki b kj mp kl km kn mq kp kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">一旦所有的<em class="le">承诺</em>都解决了，不管它们是解决了还是拒绝了，你都可能想要执行一些行动。这就是<em class="le">承诺</em>的目的。</p><figure class="ll lm ln lo gt ju"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="7b99" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le"> Promise.allSettled </em>将在所有<em class="le">承诺</em>解决或拒绝时解决。返回值是一个对象数组，带有状态(拒绝或满足)和值(或错误)。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/9b5ca6ecdfaa3ac1284180589eea6bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*KKn_SgQfwA8UlbspcL39SA.png"/></div></figure><p id="65e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鉴于<em class="le">承诺. all </em>会在一个<em class="le">承诺</em>拒绝后立即拒绝，而<em class="le">承诺. race </em>会在一个<em class="le">承诺</em>解决后立即解决，而<em class="le">承诺. allSettled </em>将始终解决，并且仅在每个单个<em class="le">承诺</em>解决后。</p><p id="85be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le"> Promise.allSettled </em>是ES2020的一个特性，已经在Node v.12.9.0，Google Chrome 76，Safari 13和Firefox 71中得到支持。</p></div></div>    
</body>
</html>