<html>
<head>
<title>Google Sheets API Tutorial with Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Javascript的Google Sheets API教程</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/google-sheets-api-tutorial-with-javascript-588f581aa1d9?source=collection_archive---------1-----------------------#2019-04-15">https://levelup.gitconnected.com/google-sheets-api-tutorial-with-javascript-588f581aa1d9?source=collection_archive---------1-----------------------#2019-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b4cd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">快速、深入的教程。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6bd5980c1a4a311de064e10541c899c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tl9u0_t5tq23jbMseX7HGA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://cdn.pixabay.com/photo/2016/10/26/12/48/excel-1771393_1280.jpg" rel="noopener ugc nofollow" target="_blank">https://cdn . pix abay . com/photo/2016/10/26/12/48/excel-1771393 _ 1280 . jpg</a></figcaption></figure><p id="a30a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">作者伊格纳西奥·n·阿吉雷</em></p><p id="a276" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几个月前，我试图用我的Javascript应用程序的Sheets API V4 对一个<strong class="lb iu"> Google电子表格进行CRUD操作。我在前端使用React.js，在后端使用Node.js:这非常痛苦。我在后端有我的google令牌，把它发送到前端，但是当我试图用React/Javascript访问API时，它不工作！最后，我弄清楚了让它工作需要什么，以及如何扩展API的用法。我将直截了当地说明如何去做，稍后再详细解释。</strong></p><p id="8d1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用的是创建-反应-应用。但是它应该可以在任何使用fetch的Javascript应用程序上工作。你可以看到这个API可以为这个游戏做些什么:</p><p id="5bd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://www.snowballfinances.com/sheets" rel="noopener ugc nofollow" target="_blank">www.snowballfinances.com/sheets</a></p><p id="3350" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个用React和电子表格制作的预算游戏。尽情享受吧！</p><p id="c36b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我也正在写一本电子书来分享我从零开始学到的关于Google APIs的一切！如果您感兴趣，请告诉我:)</p><div class="lw lx gp gr ly lz"><a href="https://react-ultimate-guide-googleapis.vercel.app/" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">React &amp; Google APIs</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">从头开始学习操作谷歌API:认证，电子表格管理，谷歌日历，令牌…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">react-ultimate-guide-Google APIs . vercel . app</p></div></div></div></a></div><p id="82c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不推荐使用在线ide，你会遇到CORS问题。create-react-app(我正在使用的)上有很多教程，设置它应该不会超过5分钟。这里有一个快速设置:</p><p id="e411" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mi mj mk ml b">npm i -g create-react-app</code></p><p id="e1d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mi mj mk ml b">create-react-app my-app</code></p><p id="0c51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mi mj mk ml b">cd my-app</code></p><p id="7106" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您最喜欢的代码编辑器中打开它。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h2 id="1aeb" class="mt mu it bd mv mw mx dn my mz na dp nb li nc nd ne lm nf ng nh lq ni nj nk nl bi translated">下面是你完成这项工作所需要的:</h2><ol class=""><li id="9816" class="nm nn it lb b lc no lf np li nq lm nr lq ns lu nt nu nv nw bi translated">电子表格及其ID</li><li id="e43d" class="nm nn it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">一个<strong class="lb iu">令牌</strong>发送给具有正确作用域的工作表API</li><li id="44ef" class="nm nn it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">一个带有正确信息的<strong class="lb iu"> fetch() </strong>请求(主体、认证头)</li></ol><p id="fa48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们一步一步来。我们从简单的开始，更新单元格A1中的值<strong class="lb iu"> <em class="lv"> 10。</em> </strong></p><h1 id="0fc7" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">1.电子表格ID</h1><p id="a6d4" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">这是简单的部分。去sheets.google.com，用你的谷歌账户登录，创建一个电子表格。一旦你看到电子表格，<strong class="lb iu"> <em class="lv">电子表格ID </em> </strong>将出现在<strong class="lb iu"> URL </strong>中，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/4ebd5af2ded5328a90adb42f5f465fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-I7V_JSLZoqhvx-ImWrOQ.png"/></div></div></figure><p id="ce27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们在这种情况下的ID是:<strong class="lb iu">1 nirrhdvn 0 JX 3 abywowfvlobkvhg 7 jqvtp 5 LH 1 yri 2 ks</strong></p><p id="317d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用您自己的spreadsheetID。这个只是为了解释的目的！</p><h1 id="7fed" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">2.代币</h1><p id="995c" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">要从谷歌获得一个令牌，你需要谷歌OAuth系统。我们将从<strong class="lb iu">谷歌认证2游乐场:</strong>获得令牌</p><div class="lw lx gp gr ly lz"><a href="https://developers.google.com/oauthplayground/" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">OAuth 2.0游乐场</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">OAuth 2.0 Playground允许您使用OAuth 2.0和支持它的API。</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">developers.google.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow ks lz"/></div></div></a></div><p id="73d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请访问上面链接的网站。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/dbc85eadadd2d81536e65336693253b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QLBKpMXVpjkmXJBX_nHy8g.png"/></div></div></figure><p id="11a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，在左栏中，找到<strong class="lb iu"><em class="lv">Google Sheets API V4:</em></strong></p><p id="81b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击它，然后点击<strong class="lb iu">范围</strong>:<strong class="lb iu">h</strong><a class="ae ky" href="https://www.googleapis.com/auth/drive.file" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="lv">ttps://www . Google APIs . com/auth/</em></strong></a><strong class="lb iu"><em class="lv">电子表格</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/86d23ef380a847d7f5f0eb97b85c7efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwyE3W62Ps-JX9pEyqVzdA.png"/></div></div></figure><p id="f322" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个<strong class="lb iu"> <em class="lv">复选标记</em> </strong>应该出现在它的左边。</p><p id="32e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，点击<strong class="lb iu">授权API。它是上面的蓝色按钮。</strong></p><p id="3cd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将被要求登录Google并提供访问权限。登录，然后点击<strong class="lb iu">允许</strong>这样你就可以使用示波器了。</p><p id="78dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">登录并授权后，你会得到一个<strong class="lb iu">授权码</strong>，如下图<strong class="lb iu">所示。单击“交换令牌的授权码”。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/942e907eed1ca8cf7907e6c3428c2deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ivmIOw44h-KEPgccbxHSNQ.png"/></div></div></figure><p id="a793" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">警告:</strong>一定要上<strong class="lb iu">第二步，你DONT需要第三步。</strong></p><p id="183e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！你刚刚得到了<strong class="lb iu">一个“访问令牌”。</strong>复制到某个地方！从技术上讲，我们已经准备好更新我们的电子表格。所以，让我们继续这样做吧！</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="b902" class="oc mu it bd mv od pa of my og pb oi nb jz pc ka ne kc pd kd nh kf pe kg nk om bi translated">3.获取请求—代码</h1><p id="1fed" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">现在，让我们发送正确的<strong class="lb iu"> fetch()请求。</strong>要查看正确的获取请求参数，我们将转到工作表API V4文档。你可以不去那个网站，反正答案就在下面！但是，如果您希望扩展功能，您会希望稍后再查看它。</p><div class="lw lx gp gr ly lz"><a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/batchUpdate" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">方法:spreadsheets . batch update | Sheets API | Google Developers</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">由于电子表格的协作性质，不能保证电子表格会准确反映您的…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">developers.google.com</p></div></div><div class="or l"><div class="pf l ot ou ov or ow ks lz"/></div></div></a></div><h1 id="a8a6" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">发布请求代码</h1><p id="9a48" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">如你所见(如果你去链接)，这将是一个POST请求。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/95394978e05559be7c81c1746dc205c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GOaQ7tqDuYPtkS5WjdslaA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/batchUpdate" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/sheets/API/reference/rest/v4/spreadsheets/batch update</a></figcaption></figure><p id="7f99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我首先看到完整的代码时，我发现它很有帮助。我用的是React.js create-react-app。下面是将单元格A1更新为10的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div></figure><p id="eb5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">重要提示:这将在任何可以使用fetch()的本地环境中工作。你不限于反应！</em></p><h2 id="9a90" class="mt mu it bd mv mw mx dn my mz na dp nb li nc nd ne lm nf ng nh lq ni nj nk nl bi translated">这段代码将用单元格A1中的数字10更新您的电子表格。</h2><p id="7156" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated"><strong class="lb iu"> <em class="lv">警告:您需要用您的信息替换工作表ID和访问令牌。我的不行！</em>T49】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/1fa814d5b97936428640a2789b475591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwKil7-CvTJJ_JPHyNwwgg.png"/></div></div></figure><h1 id="7322" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">成功了！</h1><p id="7953" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">当我运行React.js应用程序时，我单击按钮，工作表就会更新！</p><p id="d3ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果它不起作用，请在评论中告诉我，我很乐意帮忙。我们将在下面更详细地看到我如何构建<strong class="lb iu">对象</strong>。</p><p id="754a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">教程的其余部分提供了更深入的解释。</p><h1 id="f3c3" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">构建对象</h1><p id="6b28" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated"><strong class="lb iu">获取请求需要一个字符串参数:</strong> <code class="fe mi mj mk ml b"><strong class="lb iu">fetch('https://sheets.googleapis.com/v4/spreadsheets/SHEET_ID_HERE/batchUpdate')</strong></code></p><p id="0d6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一部分不难理解，现在让我们看看<strong class="lb iu">授权头。在这里你将使用我们从OAuth游戏回合得到的代币。</strong></p><pre class="kj kk kl km gt pk ml pl pm aw pn bi"><span id="7b60" class="mt mu it ml b gy po pp l pq pr">fetch('https://sheets.googleapis.com/v4/spreadsheets/SHEET_ID_HERE/batchUpdate',{<br/>method: 'POST',<br/>headers:{<br/><strong class="ml iu">  Authorization: 'Bearer TOKEN_GOES_HERE',<br/>  'content-type':'application/json',<br/></strong>}</span><span id="1124" class="mt mu it ml b gy ps pp l pq pr">})</span></pre><p id="18a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">太好了！</strong></p><p id="6a0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在最重要的部分:<strong class="lb iu">身体。</strong>我们使用Google的<strong class="lb iu"> <em class="lv"> batchUpdate请求。</em> </strong>看下图的最后。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/95394978e05559be7c81c1746dc205c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GOaQ7tqDuYPtkS5WjdslaA.png"/></div></div></figure><p id="494a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">请求url(/batchUpdate) <em class="lv">决定了您的工作表中要更新的内容、位置和方式。更新谷歌电子表格的方式有几十种，我重复一下，几十种</em> </strong>。我选择batchUpdate是因为您对单元格的值、格式、对齐等有很多控制。另一个例子在后面，但首先让我们解释完这个例子。</p><h2 id="1584" class="mt mu it bd mv mw mx dn my mz na dp nb li nc nd ne lm nf ng nh lq ni nj nk nl bi translated">身体</h2><p id="91a5" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">这就对了。您已经构建了第一个对象来更新您的电子表格！</p><h1 id="e67f" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">进一步解释和使用</h1><p id="4ae4" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">您有一个<strong class="lb iu"> POST请求</strong>，带有您的<strong class="lb iu">工作表ID </strong>到Google的<strong class="lb iu"> batchUpdate url </strong>，其中包含一个<strong class="lb iu">令牌</strong>，一个<strong class="lb iu">认证头</strong>，以及一个<strong class="lb iu">主体</strong>。该请求使用Google Sheets API v4来更新您的特定电子表格。</p><p id="97dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在一个应用程序中使用所有这些！比方说你想让用户填写一个更新你的工作表的表单(/batchUpdate)，或者有一个从电子表格中提取信息的函数(/batchGet)，或者更新单元格格式，或者动态创建工作表，这都是有可能的(我都做到了！).为了学习如何用正确的参数构建正确的获取请求，Google有一种方法来测试API请求并为您构建对象。您可以转到每个请求的概述部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/339c94a67732f9e24a6e5083cc9dda59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ST__nimjzt-8atpp-O4zOQ.png"/></div></div></figure><p id="050c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每当我构建一个与API交互的方法时，我首先使用这个引用，然后在Postman上测试它们，最后编码它们。请参见下面的batchUpdate概述链接(<em class="lv">与上面的图片</em>相同的url)</p><div class="lw lx gp gr ly lz"><a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/batchUpdate" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">方法:spreadsheets . batch update | Sheets API | Google Developers</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">由于电子表格的协作性质，不能保证电子表格会准确反映您的…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">developers.google.com</p></div></div><div class="or l"><div class="pf l ot ou ov or ow ks lz"/></div></div></a></div><h1 id="bcae" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">认证-我做了什么</h1><p id="3573" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">有无数种方法可以将谷歌认证集成到你的应用程序中，我将告诉你我是如何做到的。</p><p id="4355" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在Node.js后端使用Passport.js向Google认证我的用户。我使用的<strong class="lb iu">作用域</strong>对于工作表操作非常重要，它是<strong class="lb iu"> drive.file </strong>作用域，因为它只为应用程序提供对它创建的工作表的访问，仅此而已。我们在本教程中使用了<strong class="lb iu">电子表格</strong>范围来从任何应用程序访问API。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/49ad12f8a58ff49a3c3ed5abb62d6baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GKQrsZ14_z6WxkSP48wPcg.png"/></div></div></figure><p id="0b8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户通过身份验证后，我向客户端发送了<strong class="lb iu">令牌，您应该在使用Passport</strong>进行身份验证后取回该令牌。现在，客户端React.js可以访问API，我从客户端向Google Sheets API v4发送请求。我经常使用batchUpdate <strong class="lb iu"> <em class="lv">。</em> </strong>我用过的其他方法有<em class="lv">/</em><strong class="lb iu"><em class="lv">values/batchUpdate</em></strong>(不同于batch update)，/ <strong class="lb iu"> <em class="lv"> batchClear，</em> </strong> <em class="lv">和/ </em> <strong class="lb iu"> <em class="lv"> values。</em> </strong></p><p id="18fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的应用程序在用户的谷歌账户上创建一个电子表格，然后相应地更新或检查它。</p><h1 id="db14" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">其他更简单的方法</h1><p id="9a5d" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">我推荐的另一个选择是<strong class="lb iu"> Firebase，</strong>它在谷歌这边为你做一些验证的vodoo魔术(不需要服务器)，然后返回一个你可以使用的令牌。我能找到的最有用的教程在这里:</p><p id="c35d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=zq0TuNqV0Ew&amp;t=195s" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="lv">https://www.youtube.com/watch?v=zq0TuNqV0Ew&amp;t = 195s</em></strong></a></p><p id="8912" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一点设置，但它的工作！你会得到一个你可以使用的代币。</p><h1 id="8ca5" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">再举一个例子:spreadsheet.values/get</h1><p id="9b63" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">我再给你举一个例子，告诉你如何从一个特定范围的电子表格中获取信息。</p><div class="lw lx gp gr ly lz"><a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/get" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">方法:spreadsheets . values . get | Sheets API | Google开发者</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">编辑描述</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">developers.google.com</p></div></div><div class="or l"><div class="pv l ot ou ov or ow ks lz"/></div></div></a></div><h2 id="956b" class="mt mu it bd mv mw mx dn my mz na dp nb li nc nd ne lm nf ng nh lq ni nj nk nl bi translated">假设我想获得以下列值:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/709de58899623f5bd95ad68830a13d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*BL3fZA9CTc_VoE7tcR-1Lw.png"/></div></figure><p id="c672" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我想访问范围<strong class="lb iu"> A1:B5中的所有值。嗯，谷歌有一个方法可以做到这一点！</strong></p><p id="936a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我将使用/values/{range}请求。请参见下面的请求URL的结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/7604e39aaef3dd463200b17d6d559c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_D0xT96tk6jfvbMZrXD-Q.png"/></div></div></figure><p id="4bf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将构建一个更简单的不同类型的获取(因为它是一个GET请求)，最好的部分是:在一个<strong class="lb iu"> <em class="lv">代码中。我在本地开发环境中使用React。</em></strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi py"><img src="../Images/a2f5c98ee339622eaab404b7e3a43990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S4l-zqJL_TL-a551YnkROg.png"/></div></div></figure><p id="89d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个应用程序有一个按钮，可以获取A1:B5的取值范围。现在您可以访问这些信息了！</p><p id="b521" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很棒吧？</p><p id="9a1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有任何问题，请告诉我，我非常乐意带您浏览，甚至检查您的代码！</p><h1 id="3811" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">看看我的网站！</h1><p id="9637" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">我必须学会如何为我正在创建的初创公司使用这个API。前往<a class="ae ky" href="http://www.snowballfinances.com" rel="noopener ugc nofollow" target="_blank">www.snowballfinances.com</a>(暂时不适用于移动设备)查看Google Sheets API的所有应用程序！我在用真实的工具教人们个人理财，然后把它变成游戏。如果您想了解更多，请告诉我！</p><p id="8197" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，如果你想了解更多关于Javascript Async/Await函数的知识，可以看看我的另一篇教程:</p><p id="62fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">将API调用与Javascript Async/Await结合:</strong><br/><a class="ae ky" href="https://medium.com/@inaguirre/combining-api-calls-with-javascript-try-catch-ba1b7b9303a5" rel="noopener">https://medium . com/@ inaguirre/Combining-API-Calls-with-Javascript-try-catch-ba 1 b 7b 9303 a 5</a></p><h1 id="0ace" class="oc mu it bd mv od oe of my og oh oi nb jz oj ka ne kc ok kd nh kf ol kg nk om bi translated">感谢您的参与，祝您编码愉快！</h1><p id="f3f3" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">如果你想要我们今天做的，这是回购协议:</p><div class="lw lx gp gr ly lz"><a href="https://github.com/Ignacio1996/sheetsAPI-V4-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">Ignacio 1996/sheet SAPI-V4-教程</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">在GitHub上创建一个帐户，为Ignacio 1996/sheet SAPI-V4-tutorial开发做出贡献。</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">github.com</p></div></div><div class="or l"><div class="pz l ot ou ov or ow ks lz"/></div></div></a></div></div></div>    
</body>
</html>