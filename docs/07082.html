<html>
<head>
<title>What is AWS Data Pipeline and how it can be used?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是AWS数据管道及其使用方式？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-aws-data-pipeline-and-how-it-can-be-used-810fdfe96d30?source=collection_archive---------4-----------------------#2021-01-23">https://levelup.gitconnected.com/what-is-aws-data-pipeline-and-how-it-can-be-used-810fdfe96d30?source=collection_archive---------4-----------------------#2021-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6ddd88be049ed4cd90910b8f3476bb26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OegG1bf_3BsjtmWINRNSUg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@quinten149" rel="noopener ugc nofollow" target="_blank">昆腾·德格拉夫</a>在<a class="ae kc" href="https://unsplash.com/photos/L4gN0aeaPY4" rel="noopener ugc nofollow" target="_blank">号航天飞机</a>上拍摄的照片</figcaption></figure><p id="1b3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我列出了一些我没有亲自接触过的AWS网络服务，这就是我偶然发现AWS数据管道的时候。因此，我将对我所掌握的这项服务做一个基本的介绍，并提供一个实际的场景，我这样做是为了理解它的用法。</p><h1 id="b457" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">什么是AWS数据管道</h1><p id="b510" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">摘自AWS文档本身:</p><blockquote class="me mf mg"><p id="cab4" class="kd ke mh kf b kg kh ki kj kk kl km kn mi kp kq kr mj kt ku kv mk kx ky kz la ij bi translated">AWS数据管道是一项web服务，可帮助您在指定的时间间隔内在不同的AWS计算和存储服务以及内部数据源之间可靠地处理和卸载数据。</p></blockquote><p id="d50e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇特别的文章中，我将演示如何使用AWS数据管道，将数据从DynamoDB卸载到S3。该web服务也可用于其他AWS存储服务，如RDS和红移。这些转换主要可以通过使用AWS EC2或AWS EMR来完成。</p><h1 id="2dfa" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">AWS数据管道组件</h1><ul class=""><li id="43e2" class="ml mm iq kf b kg lz kk ma ko mn ks mo kw mp la mq mr ms mt bi translated">管道定义:基本上是如何将业务逻辑传递给AWS数据管道服务。它包含以下信息:<br/> - <strong class="kf ir">数据节点:</strong>数据源的名称、位置、格式等<br/> - <strong class="kf ir">活动:</strong>应该对数据进行的转换或操作。例如，将数据从一个源移动到另一个源，对数据执行查询我们为什么需要它<br/> - <strong class="kf ir">计划:</strong>上述活动应该多长时间运行一次<br/> - <strong class="kf ir">先决条件:</strong>在计划的活动可以运行之前必须满足的条件列表。例如，如果有一项活动要将数据从某个AWS S3存储桶移动到某个其他目标，则先决条件应在允许计划运行之前验证数据在S3的可用性。<br/> - <strong class="kf ir">资源:</strong>计算资源的详细信息，例如EC2实例或EMR集群。<br/> - <strong class="kf ir">动作</strong>:通知AWS数据管道的状态。例如通过SES发送电子邮件或触发警报等。</li><li id="e2e1" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">管道:调度和运行任务以执行预定义的活动。它包含以下内容的详细信息:<br/> - <strong class="kf ir">管道组件</strong>:这是为了定义将业务逻辑传递给AWS数据管道的方式。我们为什么需要它<br/> - <strong class="kf ir">实例</strong>:当AWS数据管道运行一个管道时，它会编译所有的管道组件，以便创建一组可操作的实例。这些实例将包含与特定任务相关的所有信息。<br/> - <strong class="kf ir">尝试</strong>:这是AWS数据管道允许您重试失败操作的地方。您还可以选择指定重试失败活动的次数。</li><li id="81b5" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">Task Runner:这是一个应用程序，其中AWS数据管道将被轮询任务，然后这些任务将以有效的方式执行。任务运行器的示例工作流如下所示:</li></ul><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/2a12bdc861a198e01d6b2a80f198b1cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bC1EYNP7ANUX6RJod-WfpQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">任务运行器工作流</figcaption></figure><h1 id="1764" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">本文的使用案例:</h1><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/1b62e4c1a404352cbfc32587c272822b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G3bL90f3ft2dAzlMuyEsPg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">工作流程图</figcaption></figure><h1 id="8901" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤:</h1><p id="0f24" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">1.创建两个S3桶，我们需要用它们来保存从DynamoDB导出的数据(datapipe-data-test ),并存储管道的日志文件(datapipe-store-logs)。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/c724d1ff3d2143e593ef594fbc93a1b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*ELf9XQPD5XCEUjnxNWFC7Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">S3水桶</figcaption></figure><p id="c527" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.当管道成功或失败时，我们还需要一个SNS主题来发送通知电子邮件。如果您在此之前尚未创建主题，请访问AWS <a class="ae kc" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/US_SetupSNS.html" rel="noopener ugc nofollow" target="_blank">文档</a>来设置SNS主题并添加电子邮件订阅。对于这个用例，我已经创建了一个SNS主题和一个订阅电子邮件，它处于确认状态，如下所示。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/e16bd84d7b1a6b50c15cd11afafe5b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CnNko9NSADccLGceyXaSPA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">社交网络话题</figcaption></figure><p id="b0ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.从控制台创建数据管道。创建时，给定合适的名称后，请从“使用模板构建”列表中选择<strong class="kf ir">“将DynamoDB表导出到S3”</strong>。对于本教程，我们将坚持使用<strong class="kf ir">“将DynamoDB表导出到S3”</strong>模板<strong class="kf ir">、</strong>。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/bf06e651c1a36cf7866874c550ec69e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xJhY4qXGdcHpWSD1Y3vxQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建数据管道</figcaption></figure><p id="4c66" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的<strong class="kf ir">参数</strong>部分，您必须给出适当的DynamoDB表的名称，您将使用它导出到我们的S3桶(在步骤1中创建)。我已经用bookid、bookname和genre属性创建了一个DynamoDB表(下面提供了截图)。你可以检查AWS文档来<a class="ae kc" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SampleData.CreateTables.html" rel="noopener ugc nofollow" target="_blank">创建</a>一个表，然后添加必要的属性，最后向其中添加条目。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/007c6551682a6441c7920c6555d90b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYOwCVCkZTtZcyHJcQKDEQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">DynamoDB表</figcaption></figure><p id="105a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.一旦一切都设置好并准备好了，下一步进入在Architect 中的<strong class="kf ir">编辑选项，同时创建数据管道(在步骤3中)。</strong></p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/097b110148e12f14092d89222e10b3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HfrjyGYIsDLmWecEKeJf8Q.png"/></div></div></figure><p id="f2a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.您应该会看到如下界面:</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/bafc65c0dd037e398f57fffacbdefc88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nye571C0Cn7CQ_efTNL3Vg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在建筑师界面中编辑</figcaption></figure><p id="98a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">确保所有参数都是正确的，如迪纳摩数据库表名，地区，S3出口桶等。</p><p id="3d3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.作为下一步，应该向上述工作流添加两个新节点，以满足成功和失败SNS通知的需要。为了添加一个新的节点，您应该展开<strong class="kf ir"> DataNodes </strong>部分，并点击最后的<strong class="kf ir">添加一个可选字段</strong>(我在下面的截图中已经指出了)。单击后，您应该会在列表中看到两个选项，如成功时的<strong class="kf ir">和失败时的<strong class="kf ir"/>。</strong></p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/33f84b88e1f9e5d71f6c35d4f928980a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iwgtbc3AhKXe7dvtKaJKzQ.jpeg"/></div></div></figure><p id="2c73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选择每个选项后，您必须再次单击与其相邻的下拉菜单，以便为该节点创建一个新的<strong class="kf ir">操作</strong>。然后展开<strong class="kf ir">其他</strong>部分，依次填写SNS相关属性，如每个动作的SNS主题Arn、消息、主题等。我已经为这两个新节点定义了属性，如下图所示。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/6cdf8fbe41bb79620ff96733b250052c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rdtCI_W506x1euCNHvYBew.jpeg"/></div></div></figure><p id="a6bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我已经划掉了ARN；请务必在这两个地方输入您的SNS主题的ARN，并根据管道的状态，提供适用的主题和您希望在电子邮件中作为通知发送给订户的消息。在上面的截图中也可以看到，在界面中可以看到重命名的两个节点(失败时和成功时)。</p><p id="e4fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您有时可能会在屏幕截图中看到一条警告，位于管道界面的底部，提示<strong class="kf ir"> terminateAfter缺失。</strong>您可能需要在激活管道之前解决这个问题。事实上，在运行管道之前，请确保解决底部可能出现的所有警告和错误。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/165a88858c6dab3854fcabb7a06be33e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oVqSYMvxELp3fTJt6GVCWQ.png"/></div></div></figure><p id="c9c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我通过在<strong class="kf ir"> Resources </strong>部分下添加Terminate After选项解决了该警告。再次单击添加可选字段下拉列表，并从列表中选择终止时间。你可以设置任何你喜欢的值，但是为了安全起见，我设置了一个小时。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/cf0149a1de48839376564b589fad25ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*I_paKvt6oYd_Spp_AX9ijQ.jpeg"/></div></figure><p id="5512" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成上述更改后，您可以继续并保存更改。“保存”按钮位于“添加”按钮旁边的左上角。之后，您应该会看到警告/错误应该会消失。一旦一切都清除了，你就可以激活管道。这应该可以启动并创建EMR集群，这是执行导出工作所必需的。您应该会看到类似下面的内容:</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/88cd253b414a247985fe27a0e1afa305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgvacm3ACB3LIdozDeaNFg.png"/></div></div></figure><p id="8334" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如您所见，EMR集群正在创建，因此运行程序仍在等待依赖项完成。一旦EMR准备好并完成了这些步骤，您应该能够查看导出到S3存储桶中的DynamoDB数据。我附上下面的截屏，以显示EMR步骤的完成、完成活动的数据管道和变为<strong class="kf ir">完成</strong>状态的状态，以及相应地在S3可用的数据。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/4a01842d3dd1406871c9e91f7616da71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4nI0L-L8m6EuDmOQW83YA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">完成电子病历步骤</figcaption></figure><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/8f6a76cf0fb280ccf5065f3419850571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gy-vUjyIiHYfzPqlO6b3vg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">数据管道活动的完成</figcaption></figure><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/72d1460358aa792ef1a204b4eaba87c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nJHYdsKq2KGa8arjQ3tLEQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">DynamoDB数据正被导出到S3</figcaption></figure><p id="788b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设管道的最终状态是成功的，您应该会收到如下电子邮件，该邮件用于订阅SNS主题:</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/624baf78ee77b4b200d497bc7440769e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*thUcUdWcclOJdavqcLr_TA.jpeg"/></div></div></figure><p id="f40a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我下载数据文件并向您展示数据。它应该包含我在前面的步骤中在DynamoDB表中得到的那两行。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/d696c22cb53923f4e234251019b41f02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lJhaziz0rNTfrXOd74vEzA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">从S3下载的文件</figcaption></figure><p id="e404" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">差不多就是这样！！现在，您应该已经简单了解了什么是AWS数据管道，以及如何使用它在AWS存储服务之间导出数据。</p><h1 id="df2b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">参考:</h1><div class="nv nw gp gr nx ny"><a href="https://docs.aws.amazon.com/datapipeline/latest/DeveloperGuide/what-is-datapipeline.html" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">什么是AWS数据管道？</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">AWS数据管道是一个web服务，您可以使用它来自动移动和转换数据。使用AWS数据…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">docs.aws.amazon.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om jw ny"/></div></div></a></div></div></div>    
</body>
</html>