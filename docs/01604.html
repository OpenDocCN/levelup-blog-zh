<html>
<head>
<title>Building Your First Serverless Slack App on GCP is so Easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在GCP上构建你的第一个无服务器Slack应用是如此简单</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-your-first-serverless-slack-app-on-gcp-is-so-easy-bb812bad5bd1?source=collection_archive---------11-----------------------#2020-01-15">https://levelup.gitconnected.com/building-your-first-serverless-slack-app-on-gcp-is-so-easy-bb812bad5bd1?source=collection_archive---------11-----------------------#2020-01-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d454" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">如何为slack开发一个令人惊叹的无服务器应用</h2><div class=""/><div class=""><h2 id="a800" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">构建您的第一个Slack应用程序并在零管理下运行它的最简单、最便宜的方式。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/87c809260062f96d771495c356aae8f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swkKzDOIBvO-uHDbyWz7NQ.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@webaroo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Webaroo.com.au</a>在<a class="ae lh" href="https://unsplash.com/@webaroo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="71e5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Slack是世界上最大的平台之一。对于团队成员之间的协作来说，这是一个非常有用的工具。对于世界各地的软件团队来说，使用slack变得很正常。</p><p id="5164" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然而，在这个世界上的任何一个平台上，你总是可以添加更多的东西。Slack平台团队深知这一点！这就是为什么他们允许你开发应用程序、机器人和插件来提供更多的协作。许多软件工具都集成了slack。许多公司开发他们的软件来轻松地与Slack一起工作。不仅如此，与Slack的构建和集成也有很大的商机。</p><h1 id="9c5c" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">你喜欢咖啡吗？</h1><p id="9c10" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">咖啡是开发人员的主要燃料之一，它在大多数时候提高了他们的工作效率。你可以在这篇文章中找到关于它的详细解释:<a class="ae lh" href="https://dev.to/anastasionico/productivity-secret-of-a-web-developer-coffee-9-types-56ck" rel="noopener ugc nofollow" target="_blank">一个网站开发者的生产力秘密:咖啡【9种】</a>。</p><p id="d116" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，我们将构建一个Slack应用程序，它将在#general channel上发送通知，邀请团队在预先安排的时间喝一杯咖啡。</p><p id="5f52" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这里，我将向您展示我是如何构建并运行一个简单的Slack应用程序的。此应用程序正在根据特定计划向空闲频道发送通知。</p><ul class=""><li id="2741" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated"><em class="nb">我们将使用</em> <strong class="lk jd"> <em class="nb"> GCP调度器</em> </strong> <em class="nb">来调用</em> <strong class="lk jd"> <em class="nb"> GCP云函数</em> </strong></li><li id="04e8" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd"><em class="nb">【GCP】云功能</em> </strong> <em class="nb">会发消息给我们</em><strong class="lk jd"><em class="nb">Slack app web hooks</em></strong></li><li id="4d20" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd"><em class="nb">Slack平台</em> </strong> <em class="nb">将消息从</em><strong class="lk jd"><em class="nb">Slack app web hooks</em></strong><em class="nb">发送到</em><strong class="lk jd"><em class="nb">#通用频道</em> </strong> <em class="nb">。</em></li></ul><h1 id="751e" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">建筑</h1><p id="6c91" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">我们的建筑非常简单。我们将使用GCP调度程序来调用GCP云函数，该函数将向我们的Slack应用程序Incoming Webhook发送一个HTTP请求。Slack平台会将传入的Webhook接收到的消息重定向到目标通道。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nq"><img src="../Images/0905350d98b4ab65a2edec44dcaab5d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-tmS8op-6zQeIm5IkNUvjA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">我们简单的建筑</figcaption></figure><h1 id="291d" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">开始建造</h1><p id="0e58" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">去Slack API网站:<a class="ae lh" href="https://api.slack.com/" rel="noopener ugc nofollow" target="_blank">https://api.slack.com/</a></p><p id="5492" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">点击<strong class="lk jd">开始建造</strong>按钮</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nr"><img src="../Images/aff5ad97d188e110f0780029a5c7e020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iiQzZUiOUYmEC1vBlvoc_A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">开始构建你的第一个Slack应用</figcaption></figure><p id="269f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">输入您的应用程序名称并选择目标工作空间(如果您有多个工作空间)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/2dae013ee654f39d152ee480327a746e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6DX1enfMwBFdL_Tez9WVow.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">给你的应用取一个好听的名字</figcaption></figure><p id="481e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您将看到关于您的应用程序的<strong class="lk jd">基本信息</strong>。你的应用目前没有任何动作。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nt"><img src="../Images/f5b7100f01a21a1468a3aeec56e4bb07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oT5C5Mua9vEv0LJd7GwShA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">您的应用程序基本信息</figcaption></figure><p id="490c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">选择<strong class="lk jd">即将到来的Webhooks </strong>，这将是我们的主要关注点。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nu"><img src="../Images/d882d91e3fc92dc718e0505a7c18d0a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2B6I7SvlQobY0EWvrQkUkA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">引入的Webhooks是我们这里的工具</figcaption></figure><p id="3c8f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">激活<strong class="lk jd">进料网钩</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/a7c02acd11a957495cec60a17a8f2712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LAUzDEL4CYdD5VyrjMfBg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">活动的传入网页挂钩屏幕看起来像什么</figcaption></figure><p id="b2a4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如您所见，我们可以在这里<strong class="lk jd">向工作区添加新的Webhook。</strong>此webhook将仅映射到一个频道。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/b00c9ca22e60ad6a5ca229374cfd5bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MyWcIe-WmZWIPF34-O_f8Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">我们将使用#通用频道(您可以选择任何频道)</figcaption></figure><p id="7b1e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在您允许之后，您将被重定向到Incoming Webhooks屏幕，在这里您将找到新的<strong class="lk jd"> Webhook URL </strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/c5205b218d4d8a5882145ad115e35116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zme5EKgiNCZeY5BR-aLn1w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">每个Webhook都有一个唯一的URL</figcaption></figure><p id="2bd1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Webhook URL是您访问Slack平台的接入点。您可以将样本curl复制并粘贴到您的终端中，并对其进行测试。你应该会收到一条来自<strong class="lk jd">#通用</strong>频道内部的消息。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/a353e693680c33c80f72e5795c0b737f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*55-s4PcFf8vbvaXS47QszQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">您使用curl从终端发送的信息会出现在频道中。</figcaption></figure><p id="ab86" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们准备了备用的，我们得到了一个平台的接入点。下一步是将我们的逻辑转换成实际运行的无服务器应用程序。</p><p id="3ab1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将与GCP合作，并将使用云功能服务。我们所需要的是一个可以调用webhook并将我们的消息传递给它的函数。</p><p id="93f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在你的GCP项目中，导航到<strong class="lk jd">云功能</strong>:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/1927b8ff944b53304ee127fc21f78e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j84kbjS6objod9Z0-cztmg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">搜索并导航至云功能</figcaption></figure><p id="598c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">创建一个HTTP云函数。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/c532fcc5c793abe2df2ec46466c2965c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTi6D_DUqBk-EEJ1_3JqJQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">创建HTTP云函数</figcaption></figure><p id="5d49" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我们将使用Python 3.7</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/5dc7d21d26f642053c04847c71bce4ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5POjUrDBo0LLGR-QCORojw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">云函数简单代码</figcaption></figure><p id="4600" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们的代码将非常简单:</p><pre class="ks kt ku kv gt oc od oe of aw og bi"><span id="a3ef" class="oh mf it od b gy oi oj l ok ol">import requests<br/><br/><br/>def coffee_time(request):<br/>    request_json = request.get_json()<br/>    url = "https://hooks.slack.com/services/TEAMID/CHANNEL/WEBHOOK"<br/><br/>    payload = '{"text":"It is the coffee time!"}'<br/><br/>    headers = {<br/>        'Content-Type': 'application/json'<br/>    }<br/><br/>    response = requests.request("POST"<strong class="od jd">, </strong>url<strong class="od jd">, </strong>headers=headers<strong class="od jd">, </strong>data=payload)<br/><br/>    print(response.text.encode('utf8'))</span></pre><p id="b0b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">前面的代码只是简单地向我们之前创建的Slack webhook发送一条文本消息，Slack platform会将消息传递到附加的通道。</p><p id="821c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将您的代码部署到云功能，并测试它。您应该会在附加的频道中收到消息。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/01c66e97f028bd3dc78546ce87d29c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48X-T9kwM80v4nbIOn9JeQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">传递到#通用频道的消息</figcaption></figure><p id="cd44" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们想在每天上午10:00发送此消息，以召集最多的开发人员一起喝咖啡聊天。我们将使用<strong class="lk jd"> GCP </strong> <strong class="lk jd">云调度器</strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/ae8cdafecbe7ee1ab395170b289a8e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bL35EE8y9Ru-KsfV-bgEvg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">搜索并导航到云调度程序</figcaption></figure><p id="8dfb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用HTTP目标创建新作业。将频率设置为每天上午10:00一次。您可以在本页找到如何定义作业计划的有用指南:<a class="ae lh" href="https://cloud.google.com/scheduler/docs/configuring/cron-job-schedules?#defining_the_job_schedule" rel="noopener ugc nofollow" target="_blank">配置Cron作业计划</a></p><p id="19f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在目标URL中，插入你的<strong class="lk jd">云功能触发URL </strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/27f5fe8be622f9451bd41e6d23798fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zu7frK1SakNTTuii7cSVvQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">配置您的计划程序</figcaption></figure><p id="139b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在您的调度程序已经准备好运行了</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/6d7103132931236a501832bcfde252df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wPCU9VvmF0QbsWJ2pZfKvg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">调度程序从未运行过</figcaption></figure><p id="987e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了测试，通过点击<strong class="lk jd">立即运行</strong>按钮运行调度程序，这将调用函数。您应该看到结果更改为Success，并且显示了上次运行的日期。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/6b4bb5943960f478962558f815aba57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dlnjilY5x5pwmfgu7G5CrA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">调度程序成功运行</figcaption></figure><p id="1829" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您应该会在目标通道中收到一条新的Slack消息。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/ddb17c5c90442448e796fddf2a115eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0vwV1b8D30nHGXU1ZuSrg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">调度程序调用云功能后收到的新消息</figcaption></figure><p id="3045" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，您将在每天上午10:00收到一条新消息。无服务器的Slack应用程序将永远自动运行。</p><h1 id="4f0b" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">现在去哪里？</h1><p id="f02d" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在本文中，我们讨论了一个非常简单的无服务器架构的Slack应用程序。你可以根据你的业务逻辑来开发你的应用。</p><p id="8576" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">阅读Slack platform API，了解更多可以在该平台上使用的工具。</p><p id="c084" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">了解无服务器技术的威力以及如何优化它来构建您的应用程序也很重要。</p></div></div>    
</body>
</html>