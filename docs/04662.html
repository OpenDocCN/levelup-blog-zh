<html>
<head>
<title>Common Vue Problems — Format Currency and Showing Things When Loading</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">常见的Vue问题—货币格式和加载时显示内容</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/common-vue-problems-format-currency-and-showing-things-hen-loading-f79010fbbd02?source=collection_archive---------11-----------------------#2020-07-08">https://levelup.gitconnected.com/common-vue-problems-format-currency-and-showing-things-hen-loading-f79010fbbd02?source=collection_archive---------11-----------------------#2020-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8f6c738a5b0bcc65767b92114f6b0203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DBu8jfOnqqIYJ0Me"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@dongcheng?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">董成</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="0e65" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="89bc" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在Vue组件中格式化货币</h1><p id="2a47" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">有几种方法可以在我们的组件中转换货币。</p><p id="6e6d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一种方法是添加一个方法。例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="aaae" class="mq lf it mm b gy mr ms l mt mu">methods: {<br/>  formatPrice(value) {<br/>    <!-- -->if (typeof value !== "number") {<br/>        return value;<br/>    }<br/>    const formatter = new Intl.NumberFormat('en-US', {<br/>      style: 'currency',<br/>      currency: 'USD',<br/>      minimumFractionDigits: 0<br/>    });<br/>    return formatter.format(value);<br/>  }<br/>}</span></pre><p id="66c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用<code class="fe mv mw mx mm b">Intl.NumberFormat</code>构造函数来创建一个货币格式化程序，我们可以用它来格式化货币。</p><p id="308e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，我们可以用<code class="fe mv mw mx mm b">format</code>方法将<code class="fe mv mw mx mm b">value</code>数字格式化成一个字符串。</p><p id="03c0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们可以创建一个过滤器，如下所示:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9687" class="mq lf it mm b gy mr ms l mt mu">Vue.filter('currency', (value) =&gt; {<br/>  if (typeof value !== "number") {<br/>    return value;<br/>  }<br/>  const formatter = new Intl.NumberFormat('en-US', {<br/>    style: 'currency',<br/>    currency: 'USD',<br/>    minimumFractionDigits: 0<br/>  });<br/>  return formatter.format(value);<br/>});</span></pre><p id="a5c0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用相同的<code class="fe mv mw mx mm b">Intl.NumberFormat</code>构造函数。</p><p id="a316" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以用它来格式化货币，就像我们用方法一样，并返回格式化后的字符串。</p><p id="ea18" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的模板中，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="95d9" class="mq lf it mm b gy mr ms l mt mu">{{ fees | currency }}</span></pre><p id="e1df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将货币值显示为格式化字符串。</p><h1 id="ab30" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">加载延迟加载的路径组件时显示加载动画</h1><p id="7535" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以使用类似于<code class="fe mv mw mx mm b">nprogress</code>库的东西，当路线开始加载时开始和结束动画，当它停止时停止动画。</p><p id="69b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9f1e" class="mq lf it mm b gy mr ms l mt mu">const router = new VueRouter({<br/>  routes<br/>})</span><span id="bd9d" class="mq lf it mm b gy my ms l mt mu">router.beforeEach((to, from, next) =&gt; {<br/>  NProgress.start()<br/>  next()<br/>})<br/>router.afterEach(() =&gt; {<br/>  NProgress.done()<br/>})</span></pre><p id="a9fa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们显示由<code class="fe mv mw mx mm b">NProgress</code>提供的动画。</p><p id="bd26" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者，我们可以在根Vue实例上设置<code class="fe mv mw mx mm b">loading</code>状态，方法是:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5959" class="mq lf it mm b gy mr ms l mt mu">Vue.component('loading',{ template: '&lt;div&gt;Loading!&lt;/div&gt;'})</span><span id="610c" class="mq lf it mm b gy my ms l mt mu">const router = new VueRouter({<br/>  routes<br/>})</span><span id="737e" class="mq lf it mm b gy my ms l mt mu">const app = new Vue({<br/>  data: { loading: false },<br/>  router<br/>}).$mount('#app')</span><span id="51d1" class="mq lf it mm b gy my ms l mt mu">router.beforeEach((to, from, next) =&gt; {<br/>  app.loading = true;<br/>  next();<br/>})</span><span id="d738" class="mq lf it mm b gy my ms l mt mu">router.afterEach((to, from, next) =&gt; {<br/>  app.loading = false;<br/>  next();<br/>})</span></pre><p id="debb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的根组件的模板中，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="bf9b" class="mq lf it mm b gy mr ms l mt mu">&lt;loading v-if="$root.loading"&gt;&lt;/loading&gt;<br/>&lt;router-view v-else&gt;&lt;/router-view&gt;</span></pre><p id="5395" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用<code class="fe mv mw mx mm b">$root</code>获得根Vue实例。</p><p id="dd3f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以<code class="fe mv mw mx mm b">$root.loading</code>有我们之前设置的<code class="fe mv mw mx mm b">loading</code>状态的当前值。</p><p id="03c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样，在我们的模板中，我们可以写出我们所拥有的。</p><p id="d2fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当<code class="fe mv mw mx mm b">$root.loading</code>为<code class="fe mv mw mx mm b">false</code>时，我们加载<code class="fe mv mw mx mm b">router-view</code>。</p><h1 id="a855" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在5个项目后添加新行</h1><p id="22e4" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以创建一个嵌套数组，每个数组包含5个元素。</p><p id="ec7a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了使这变得容易，我们可以使用Lodash的<code class="fe mv mw mx mm b">chunk</code>方法。</p><p id="dc63" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="a54d" class="mq lf it mm b gy mr ms l mt mu">computed: {<br/>  itemChunks(){<br/>    return _.chunk(this.items, 5);<br/>  }<br/>},</span></pre><p id="78cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">chunk</code>方法将<code class="fe mv mw mx mm b">this.items</code>数组中的项目分成块。</p><p id="9774" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以使用<code class="fe mv mw mx mm b">v-for</code>遍历嵌套数组的所有元素:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5c1e" class="mq lf it mm b gy mr ms l mt mu">&lt;div class="row" v-for="chunk of itemChunks"&gt;<br/>  &lt;span v-for="item in chunk"&gt;<br/>     {{item}}<br/>  &lt;/span&gt;<br/>&lt;/div&gt;</span></pre><p id="4089" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用外部的<code class="fe mv mw mx mm b">v-for</code>循环遍历数组的顶层。</p><p id="35a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在内部<code class="fe mv mw mx mm b">v-for</code>中，我们遍历嵌套数组中的项目。</p><h1 id="5e75" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在渲染之前隐藏Vue模板</h1><p id="9746" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们只想在呈现之前隐藏标记，那么我们可以使用<code class="fe mv mw mx mm b">v-cloak</code>指令。</p><p id="0834" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以在<code class="fe mv mw mx mm b">v-cloak</code>指令中添加<code class="fe mv mw mx mm b">display: none</code>来隐藏它，因为<code class="fe mv mw mx mm b">v-cloak</code>属性会在元素加载前添加到元素中。</p><p id="742a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="f0df" class="mq lf it mm b gy mr ms l mt mu">&lt;div v-cloak&gt;<br/>  {{message}}<br/>&lt;/div&gt;</span></pre><p id="4988" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的CSS中，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="a7ea" class="mq lf it mm b gy mr ms l mt mu">[v-cloak] {<br/>  display: none;<br/>}</span></pre><p id="3867" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">隐藏未呈现的模板。</p><p id="90d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们想添加一个装载信息，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="c1a1" class="mq lf it mm b gy mr ms l mt mu">const vm = new Vue({<br/>  el: "#app",<br/>  created(){<br/>    this.$http.get('url')<br/>      .then(response =&gt; {     <br/>        this.loading = false;<br/>        this.message = response.message;<br/>      });<br/>  },<br/>  data: {<br/>    message: '',<br/>    loading: true<br/>  }<br/>});</span></pre><p id="85bb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的模板中，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="ea68" class="mq lf it mm b gy mr ms l mt mu">&lt;div v-if="loading"&gt;<br/>   Loading...<br/>&lt;/div&gt;<br/>&lt;div v-else&gt;<br/>  {{message}}<br/>&lt;/div&gt;</span></pre><p id="3a64" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们最初将<code class="fe mv mw mx mm b">loading</code>设置为<code class="fe mv mw mx mm b">true</code>,以显示“正在加载…”信息。</p><p id="7313" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后当<code class="fe mv mw mx mm b">loading</code>为<code class="fe mv mw mx mm b">false</code>时，我们看到消息从服务器加载。</p><p id="99d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以添加一个类，在加载东西的时候显示不同的样式。</p><p id="db73" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="b411" class="mq lf it mm b gy mr ms l mt mu">&lt;div :class="{'loading': loading}"&gt;&lt;/div&gt;</span></pre><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/59b876e0111ff1ce178b31ff47b1e328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K_OV6lNMANI8_7sB"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@shaneguymon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Shane Guymon </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="7dc1" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="6756" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用一种方法或过滤器来格式化货币。</p><p id="7d1d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们加载一个东西时，有不同的方法来显示不同的东西。</p><p id="ed1c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们可以使用Lodash的<code class="fe mv mw mx mm b">chunk</code>将数组分块，以将一个数组划分为具有相同项数的嵌套数组。</p></div></div>    
</body>
</html>