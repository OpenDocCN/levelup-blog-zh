<html>
<head>
<title>Spark Streaming with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的Spark流</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/spark-streaming-with-python-f88ff662feb0?source=collection_archive---------3-----------------------#2022-01-05">https://levelup.gitconnected.com/spark-streaming-with-python-f88ff662feb0?source=collection_archive---------3-----------------------#2022-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ea88c7130ba55b2ceff1c427893482cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6hPR_rAEeQc4a57j"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">迈克尔·泽兹奇在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="223e" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是火花流？</h2><ul class=""><li id="1b5f" class="kz la iq lb b lc ld le lf km lg kq lh ku li lj lk ll lm ln bi translated">Spark Streaming是核心Spark api的扩展，支持实时数据流的可伸缩、高吞吐量、容错流处理</li><li id="dfff" class="kz la iq lb b lc lo le lp km lq kq lr ku ls lj lk ll lm ln bi translated">数据可以从Kafka、Flume、Kinesis或TCP sockets等许多来源获取，并可以在用map、reduce、join and reduce、join and reduce和window等高级函数表示的复杂算法中进行处理。</li></ul><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/06c882769433f0b3833dd9c126d5f892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZFwYYVw7YPmLRz2_Lu-liQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">信用:spark.apache.org</figcaption></figure><ul class=""><li id="452f" class="kz la iq lb b lc ly le lz km ma kq mb ku mc lj lk ll lm ln bi translated">在内部，Spark Streaming接收实时输入数据流，并将数据分成批次，然后由Spark引擎进行处理，以批次形式生成最终的结果流。</li></ul><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/22a1bdb7d2eed797528dca907b3ec11d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gs24QdA2vsGQ2zPd3OyGUA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">火花流:信用spark.apache.org</figcaption></figure><ul class=""><li id="1209" class="kz la iq lb b lc ly le lz km ma kq mb ku mc lj lk ll lm ln bi translated">让我们通过一个简单的例子来理解Spark流(我们将构建一个非常简单的应用程序，它通过套接字连接连接到一个本地数据流(一个开放的终端)。然后<strong class="lb ir">会计算我们输入的每一行的字数</strong>。)</li></ul><h2 id="1fad" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">流式传输的步骤如下:</h2><ul class=""><li id="a4ad" class="kz la iq lb b lc ld le lf km lg kq lh ku li lj lk ll lm ln bi translated">创建SparkContext</li><li id="e548" class="kz la iq lb b lc lo le lp km lq kq lr ku ls lj lk ll lm ln bi translated">创建流上下文</li><li id="9ef1" class="kz la iq lb b lc lo le lp km lq kq lr ku ls lj lk ll lm ln bi translated">创建套接字文本流</li><li id="1c27" class="kz la iq lb b lc lo le lp km lq kq lr ku ls lj lk ll lm ln bi translated">作为“数据流”读入这些行</li></ul><h2 id="14ab" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">处理数据的步骤</strong>:</h2><ul class=""><li id="da35" class="kz la iq lb b lc ld le lf km lg kq lh ku li lj lk ll lm ln bi translated">将输入行分割成单词列表</li><li id="64cc" class="kz la iq lb b lc lo le lp km lq kq lr ku ls lj lk ll lm ln bi translated">将每个单词映射到一个元组</li><li id="8e06" class="kz la iq lb b lc lo le lp km lq kq lr ku ls lj lk ll lm ln bi translated">然后按单词(键)分组(归约)元组，并对第二个参数(第一个)求和</li></ul><p id="3ae9" class="pw-post-body-paragraph me mf iq lb b lc ly mg mh le lz mi mj km mk ml mm kq mn mo mp ku mq mr ms lj ij bi translated">注意 : RDD语法严重依赖lambda表达式</p><ul class=""><li id="4099" class="kz la iq lb b lc ly le lz km ma kq mb ku mc lj lk ll lm ln bi translated">下面是完整的代码和输出👇🏻</li></ul><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2e40" class="pw-post-body-paragraph me mf iq lb b lc ly mg mh le lz mi mj km mk ml mm kq mn mo mp ku mq mr ms lj ij bi translated">以上示例的输出:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/09b1c84aa6c8b90ded872bfa69aa34ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s-RvUV7XNw-COeO6_njSag.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">火花流</figcaption></figure><p id="6f9f" class="pw-post-body-paragraph me mf iq lb b lc ly mg mh le lz mi mj km mk ml mm kq mn mo mp ku mq mr ms lj ij bi translated"><strong class="lb ir">注:</strong>我的Python版本是<strong class="lb ir"> </strong> 3.8.12，Spark版本是3.0.1，Java版本是“1.8.0_25”。由于版本不匹配，您可能会遇到错误。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="0610" class="pw-post-body-paragraph me mf iq lb b lc ly mg mh le lz mi mj km mk ml mm kq mn mo mp ku mq mr ms lj ij bi translated"><strong class="lb ir">感谢您的阅读。感谢您的诚实反馈！</strong></p><h1 id="59ac" class="nd ke iq bd kf ne nf ng ki nh ni nj kl nk nl nm kp nn no np kt nq nr ns kx nt bi translated">参考:</h1><ul class=""><li id="a5b6" class="kz la iq lb b lc ld le lf km lg kq lh ku li lj lk ll lm ln bi translated"><a class="ae kc" href="https://www.udemy.com/course/spark-and-python-for-big-data-with-pyspark/" rel="noopener ugc nofollow" target="_blank">https://www . udemy . com/course/spark-and-python-for-big-data-with-py spark/</a></li><li id="fb8e" class="kz la iq lb b lc lo le lp km lq kq lr ku ls lj lk ll lm ln bi translated"><a class="ae kc" href="https://spark.apache.org/docs/latest/streaming-programming-guide.html" rel="noopener ugc nofollow" target="_blank">https://spark . Apache . org/docs/latest/streaming-programming-guide . html</a></li></ul></div></div>    
</body>
</html>