<html>
<head>
<title>Easy Things That Can Be Quick Wins for Refactoring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对于重构来说，简单的事情可以快速取胜</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/easy-things-that-can-be-quick-wins-for-refactoring-a3c1cd488ef1?source=collection_archive---------36-----------------------#2020-05-04">https://levelup.gitconnected.com/easy-things-that-can-be-quick-wins-for-refactoring-a3c1cd488ef1?source=collection_archive---------36-----------------------#2020-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8054be2f29dbc728134ed6e05281d77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AOmB6Qy-UUFe5tMG"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@davidclode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">大卫·克洛德</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="e0a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">JavaScript是一种简单易学的编程语言。编写运行并执行某些操作的程序很容易。然而，很难写出一段干净的JavaScript代码。</p><p id="f85b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将会看到一些简单的事情，即使是最丑陋的代码也可以轻松重构。</p><h1 id="f03b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">没有不变函数</h1><p id="7192" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">不变函数是给定任何类型的输入，总是返回相同内容的函数。</p><p id="6191" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">显然，这是没有用的，因为这个函数总是返回相同的东西。</p><p id="4b48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于不变函数，我们要么将返回值指定为常量，要么改变函数，返回不同类型的输出。</p><p id="a5a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有以下函数:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="de47" class="mq lf it mm b gy mr ms l mt mu">const foo = name =&gt; 'name';</span></pre><p id="77fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么这应该被重构，因为函数总是返回<code class="fe mv mw mx mm b">'name'</code>。我们不想要那样的函数，因为参数是无用的，返回值是常量。</p><p id="b854" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个产生副作用但总是返回相同结果的函数也是一个不变函数。</p><p id="f5ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="d6f8" class="mq lf it mm b gy mr ms l mt mu">let name;<br/>const setName = (firstName, lastName) =&gt; {<br/>  name = `${firstName}, ${lastName}`;<br/>  return 'name';<br/>}</span></pre><p id="3da5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么这也是一个不变函数，因为它返回相同的东西。在那之前它做什么并不重要。</p><p id="8a61" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个例子中，我们应该重构我们的函数，使它成为一个纯函数。</p><p id="db9f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们应该将<code class="fe mv mw mx mm b">setName</code>函数重写为一个纯函数，并如下调用它:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="28b6" class="mq lf it mm b gy mr ms l mt mu">const setName = (firstName, lastName) =&gt; `${firstName}, ${lastName}`</span></pre><p id="7bc2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们将<code class="fe mv mw mx mm b">setName</code>函数改为一个纯函数，返回组合的<code class="fe mv mw mx mm b">firstName</code>和<code class="fe mv mw mx mm b">lastName</code>参数。</p><p id="48fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们不再有不变函数了，因为它并不总是返回相同的东西。</p><p id="291e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，现在我们可以这样称呼它:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="7f3e" class="mq lf it mm b gy mr ms l mt mu">let name = setName('jane', 'smith');</span></pre><p id="f47e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这比产生不必要的副作用要好。</p><p id="ceca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">纯函数易于测试和理解，因为给定输入，输出是可预测的。</p><h1 id="bb33" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">将switch语句的Default子句放在最后</h1><p id="2e60" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated"><code class="fe mv mw mx mm b">switch</code>语句的<code class="fe mv mw mx mm b">default</code>子句应遵循公认的惯例。这使得我们的代码更容易阅读，因为它的一致性和模式是可预测的。从而减轻读者的认知负担。</p><p id="0014" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，与其写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9f06" class="mq lf it mm b gy mr ms l mt mu">const foo = (bar) =&gt; {<br/>  switch (bar) {<br/>    default: {<br/>      return 1<br/>    }<br/>    case 'foo': {<br/>      return 2<br/>    }<br/>    case 'bar': {<br/>      return 3;<br/>    }<br/>  }<br/>}</span></pre><p id="b2be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该改为写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="c1f3" class="mq lf it mm b gy mr ms l mt mu">const foo = (bar) =&gt; {<br/>  switch (bar) {<br/>    case 'foo': {<br/>      return 2;<br/>    }<br/>    case 'bar': {<br/>      return 3;<br/>    }<br/>    default: {<br/>      return 1;<br/>    }<br/>  }<br/>}</span></pre><p id="9dca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这对任何人来说都更容易阅读，因为我们坚持被大多数人接受的惯例。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/2b4118ad3d844d69dffb27b76bd841b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_83tPs1raHAl-BYr"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图片由<a class="ae kf" href="https://unsplash.com/@honest?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">诚信公司</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="7f24" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">清除冗余变量</h1><p id="9230" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">冗余变量对我们的大脑来说很难。此外，由于浏览器或Node.js必须为每个变量分配更多的资源，因此它们会占用用户计算机上更多的内存。</p><p id="da5c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码的混乱使得阅读和调试变得困难，因为它们容易引起误解。它们看起来不同，但实际上是用于同一件事。</p><p id="16ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，不写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="1e81" class="mq lf it mm b gy mr ms l mt mu">const foo = (bar) =&gt; {<br/>  switch (bar) {<br/>    case 'foo': {<br/>      const two = 2;<br/>      return two * 2;<br/>    }<br/>    case 'bar': {<br/>      const three = 3;<br/>      return three * 2;<br/>    }<br/>    default: {<br/>      const one = 3;<br/>      return one * 2;<br/>    }<br/>  }<br/>}</span></pre><p id="0347" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中有三个我们不需要的常数。我们可以改为写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="fd83" class="mq lf it mm b gy mr ms l mt mu">const foo = (bar) =&gt; {<br/>  let num;<br/>  switch (bar) {<br/>    case 'foo': {<br/>      num = 2;<br/>      return num * 2;<br/>    }<br/>    case 'bar': {<br/>      num = 3;<br/>      return num * 2;<br/>    }<br/>    default: {<br/>      num = 3;<br/>      return num * 2;<br/>    }<br/>  }<br/>}</span></pre><p id="b20c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们有<code class="fe mv mw mx mm b">num</code>变量，它被分配到每个<code class="fe mv mw mx mm b">case</code>块和<code class="fe mv mw mx mm b">default</code>块中。</p><p id="e97b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以在设置好变量后按照我们希望的方式使用<code class="fe mv mw mx mm b">num</code>。现在我们只有1个变量，而不是3个，节省了计算机内存，也减少了读者的认知负荷。</p><h1 id="7864" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="f0b9" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">说到重构，有一些立竿见影的方法。一是去除冗余变量。</p><p id="b5a3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们也不应该将<code class="fe mv mw mx mm b">switch</code>语句的<code class="fe mv mw mx mm b">default</code>块从底部移到它通常被接受的位置之外。</p><p id="dae3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们不应该写不变函数，即使它们会带来副作用。</p></div></div>    
</body>
</html>