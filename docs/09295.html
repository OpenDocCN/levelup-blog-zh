<html>
<head>
<title>E2E testing with Playwright</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">E2E测试与剧作家</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/e2e-test-with-playwright-45e2c0389bfa?source=collection_archive---------2-----------------------#2021-07-25">https://levelup.gitconnected.com/e2e-test-with-playwright-45e2c0389bfa?source=collection_archive---------2-----------------------#2021-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c241" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">剧作家开剧作家开</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/2b9fa21b65d4193aa3dc3c3091ed323d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4ReyfnsbJ0NFMuL8suV9w.png"/></div></div></figure><p id="a47f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi lr translated">laywright支持对现代web应用进行可靠的端到端测试，旨在自动化单页面应用和渐进式web应用所使用的广泛且不断增长的Web浏览器功能。</p><div class="ma mb gp gr mc md"><a href="https://playwright.dev/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd iu gy z fp mi fr fs mj fu fw is bi translated">快速可靠的现代网络应用端到端测试|剧作家</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">单一的API来自动化Chromium、Firefox和WebKit。为依赖现代的单页应用程序提供强大的自动化功能…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">剧作家dev</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr kt md"/></div></div></a></div><p id="c3b9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一些功能包括</p><ul class=""><li id="fc44" class="ms mt it kx b ky kz lb lc le mu li mv lm mw lq mx my mz na bi translated">自动等待元素准备就绪后再执行操作(如单击、填充)</li><li id="bd78" class="ms mt it kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">拦截网络活动以阻止和嘲弄网络请求</li><li id="32d2" class="ms mt it kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">模拟移动设备、地理位置、权限</li><li id="46cc" class="ms mt it kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">鼠标和键盘的本机输入事件</li><li id="f10e" class="ms mt it kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">上传和下载文件</li></ul></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="4f33" class="nn no it bd np nq nr ns nt nu nv nw nx jz ny ka nz kc oa kd ob kf oc kg od oe bi translated">我喜欢的功能</h1><h2 id="ea2f" class="of no it bd np og oh dn nt oi oj dp nx le ok ol nz li om on ob lm oo op od oq bi translated">1.Codegen💪</h2><p id="f7f9" class="pw-post-body-paragraph kv kw it kx b ky or ju la lb os jx ld le ot lg lh li ou lk ll lm ov lo lp lq im bi translated">Codegen是一个强大的工具，它将从用户与基于弹性文本的选择器的交互中生成代码。</p><pre class="kk kl km kn gt ow ox oy oz aw pa bi"><span id="db83" class="of no it ox b gy pb pc l pd pe">playwright codegen <a class="ae pf" href="https://victorious-tree-06261d500.azurestaticapps.net/" rel="noopener ugc nofollow" target="_blank">g</a>oogle.com</span></pre><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="pg ph l"/></div><figcaption class="pi pj gj gh gi pk pl bd b be z dk translated">Playright codegen正在运行</figcaption></figure><h2 id="28ac" class="of no it bd np og oh dn nt oi oj dp nx le ok ol nz li om on ob lm oo op od oq bi translated">2.自动等待元素⏱️</h2><p id="5fe9" class="pw-post-body-paragraph kv kw it kx b ky or ju la lb os jx ld le ot lg lh li ou lk ll lm ov lo lp lq im bi translated">编写、自动化和维护E2E测试是困难的。我经历过不得不写E2E测试一点也不好玩。这种剥落很难避免。在断言一个元素在页面上可见以执行点击或导航到不同页面之前，我已经摆弄过设置延迟。剧作家负责自动等待元素准备好执行，如点击，填充等。</p><blockquote class="pm pn po"><p id="762a" class="kv kw pp kx b ky kz ju la lb lc jx ld pq lf lg lh pr lj lk ll ps ln lo lp lq im bi translated">剧作家在采取行动之前对元素执行一系列的可行动性检查，以确保这些行动按预期进行。它自动等待所有相关检查通过，然后才执行所请求的操作。如果所要求的检查在给定的<code class="fe pt pu pv ox b">timeout</code>内没有通过，则<code class="fe pt pu pv ox b">TimeoutError</code>动作失败。</p></blockquote><p id="86c3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">当调用<code class="fe pt pu pv ox b">Page.ClickAsync(selector, options)</code>时，剧作家将确保一个元素是:</p><ul class=""><li id="65cd" class="ms mt it kx b ky kz lb lc le mu li mv lm mw lq mx my mz na bi translated">附属于DOM</li><li id="c37a" class="ms mt it kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">可见并已启用</li><li id="ec4d" class="ms mt it kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">不在动画或完成动画状态</li><li id="ee88" class="ms mt it kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">没有被其他元素遮蔽</li></ul><p id="4a6e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">单击下面的链接，查看针对各种操作执行的可操作性检查的完整列表。</p><div class="ma mb gp gr mc md"><a href="https://playwright.dev/dotnet/docs/actionability" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd iu gy z fp mi fr fs mj fu fw is bi translated">自动等待|剧作家。网</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">剧作家在采取行动之前对元素执行一系列可行动性检查，以确保这些行动…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">剧作家dev</p></div></div></div></a></div><h2 id="704c" class="of no it bd np og oh dn nt oi oj dp nx le ok ol nz li om on ob lm oo op od oq bi translated">3.屏幕上显示程序运行的图片📸</h2><p id="31d6" class="pw-post-body-paragraph kv kw it kx b ky or ju la lb os jx ld le ot lg lh li ou lk ll lm ov lo lp lq im bi translated">剧作家提供了在测试运行时轻松捕捉屏幕截图的选项。您可以对整个页面或页面上的特定元素进行截图。除了保存截图之外，还可以用图片获取一个缓冲区，进行后期处理。如果E2E测试失败，页面截图将有助于找出问题所在并帮助解决问题。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="pw ph l"/></div></figure><h2 id="e77a" class="of no it bd np og oh dn nt oi oj dp nx le ok ol nz li om on ob lm oo op od oq bi translated">4.网络监视🌐</h2><p id="e93e" class="pw-post-body-paragraph kv kw it kx b ky or ju la lb os jx ld le ot lg lh li ou lk ll lm ov lo lp lq im bi translated">剧作家提供API来监控和修改网络流量，包括HTTP和HTTPS。页面所做的任何请求，包括xhr和fetch请求，都可以被相应地跟踪、修改和处理。下面，我在请求和响应对象上注册了事件处理程序，当发出新请求并收到响应时，将调用这些事件处理程序。收到请求事件后，方法名和URL被写入控制台。类似地，当引发响应事件时，其状态和URL被写入控制台。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="pw ph l"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi px"><img src="../Images/72b7f8a6462d01407314718c2d495959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Ao998QXrvclUbKQUpuJew.png"/></div></div><figcaption class="pi pj gj gh gi pk pl bd b be z dk translated">API请求和响应日志</figcaption></figure><h2 id="5e7c" class="of no it bd np og oh dn nt oi oj dp nx le ok ol nz li om on ob lm oo op od oq bi translated">5.API模拟😛</h2><p id="d019" class="pw-post-body-paragraph kv kw it kx b ky or ju la lb os jx ld le ot lg lh li ou lk ll lm ov lo lp lq im bi translated">路由提供了修改页面发出的网络请求的能力。一旦启用路由，每个匹配URL模式的请求都将停止，除非它被继续、完成或中止。下面我模拟了对<code class="fe pt pu pv ox b">**/api/account/create</code> route的响应，并返回了一个模拟响应。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="pw ph l"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi py"><img src="../Images/5b93cf211625439ee516ad09d855bebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*nV72fI3cNBDpXCSbQPivJw.png"/></div><figcaption class="pi pj gj gh gi pk pl bd b be z dk translated">模拟API响应</figcaption></figure></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h2 id="f1e0" class="of no it bd np og oh dn nt oi oj dp nx le ok ol nz li om on ob lm oo op od oq bi translated">注册和登录E2E测试</h2><p id="5ec8" class="pw-post-body-paragraph kv kw it kx b ky or ju la lb os jx ld le ot lg lh li ou lk ll lm ov lo lp lq im bi translated">我有一个带有Azure静态Web应用程序的Blazor静态站点。下面的E2E测试<code class="fe pt pu pv ox b">UserRegistartionTest</code>将注册一个新用户，然后使用注册时指定的凭证登录。该测试将启动Chrome，注册一个新帐户，最后使用凭据登录。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="pw ph l"/></div></figure><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="pg ph l"/></div><figcaption class="pi pj gj gh gi pk pl bd b be z dk translated">剧作家E2E试验</figcaption></figure><h2 id="5584" class="of no it bd np og oh dn nt oi oj dp nx le ok ol nz li om on ob lm oo op od oq bi translated">结论</h2><p id="9a47" class="pw-post-body-paragraph kv kw it kx b ky or ju la lb os jx ld le ot lg lh li ou lk ll lm ov lo lp lq im bi translated">剧作家是一个伟大的工具，让您轻松地为您的应用程序编写端到端的测试。API很简单，很容易快速上手codegen特性。</p></div></div>    
</body>
</html>