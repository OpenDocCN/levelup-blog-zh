<html>
<head>
<title>React &amp; Ethereum: Getting Started With The Minimum Toolset Required — Part 2 of 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React &amp; Ethereum:从所需的最少工具集开始—第2部分，共4部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-ethereum-getting-started-with-the-minimum-toolset-required-part-2-of-4-ad4d258ebe53?source=collection_archive---------1-----------------------#2017-11-09">https://levelup.gitconnected.com/react-ethereum-getting-started-with-the-minimum-toolset-required-part-2-of-4-ad4d258ebe53?source=collection_archive---------1-----------------------#2017-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7337" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">了解如何使用所需的最少工具集创建智能合约并将其部署到以太坊区块链:Remix、Metamask和任何文本编辑器。</p><p id="8797" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"/><a class="ae km" href="https://medium.com/@zubairnahmed/https-medium-com-zubairnahmed-react-ethereum-getting-started-with-the-minimum-toolset-required-part-1-of-4-9562efa23d18" rel="noopener"><em class="kl">第1部分</em></a><strong class="jp ir"><em class="kl">第2部分</em></strong><a class="ae km" href="https://medium.com/@zubairnahmed/react-ethereum-getting-started-with-the-minimum-toolset-required-part-3-of-4-6f8c55c751f5" rel="noopener"><em class="kl">第3部分</em></a><a class="ae km" href="https://medium.com/@zubairnahmed/react-ethereum-getting-started-with-the-minimum-toolset-required-part-4-of-4-478be958c16f" rel="noopener"><em class="kl">第4部分</em></a><em class="kl"/><strong class="jp ir"/></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/17ca8487fa4df68736351a8176626c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XL_I8smdz2JylMeDOO3Xg.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">Pixabay图像，在<a class="ae km" href="https://creativecommons.org/publicdomain/zero/1.0/deed.en" rel="noopener ugc nofollow" target="_blank">知识共享CC0 </a>下发布。</figcaption></figure><p id="a31c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">更新</strong>:此博客系列不再维护。</p><p id="5316" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae km" href="https://github.com/zubairnahmed/react_ethereum_blockchain" rel="noopener ugc nofollow" target="_blank"> <em class="kl"> GitHub仓库</em> </a>:如果你愿意，你可以和仓库一起编码。我添加了一些评论作为指导。</p><h1 id="116b" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">阶段2:设置React并与之交互</h1><p id="258c" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">既然我们已经在Solidity中编写了一个智能契约，并在Remix JavaScript VM上使用了它，那么是时候添加几行代码并在以太坊Ropsten Testnet上部署一个契约了。</p><p id="8527" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个阶段的本质是连接React以从我们的智能契约中读取变量。该合同将存在于以太坊Ropsten Testnet中。React与该测试网络的连接将通过元掩码发生。</p><p id="6a5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将添加一个状态变量，然后在构造函数中初始化它，并添加一个返回该变量的函数。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mg"><img src="../Images/3165a513ae0bde9dc92f7cf6a98ce4a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-oUb-PIHG1N-T-YjjwOm0w.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">string类型的私有状态变量，称为<strong class="bd lf"> secret </strong></figcaption></figure><p id="59e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第6行</em>:声明一个<a class="ae km" href="http://solidity.readthedocs.io/en/latest/contracts.html?highlight=private#visibility-and-getters" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">私有</em> </strong> </a>状态变量。我称之为<strong class="jp ir"> <em class="kl">秘密</em> </strong>因为它将只对合同可见。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mg"><img src="../Images/41b4dc9620ee504345ba82a9422e38ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrYaMo8o0JD64YD6W2u9oQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">添加第11行，将<strong class="bd lf"> secret </strong>变量初始化为“secret data”</figcaption></figure><p id="7e1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第11行</em>:在我们的<a class="ae km" href="http://solidity.readthedocs.io/en/latest/contracts.html?highlight=constructor#creating-contracts" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">构造函数</em> </strong> </a>中初始化<strong class="jp ir"> <em class="kl"> secret </em> </strong>变量为<em class="kl">secret data】</em>。任何人都可以看到这个数据，所以在这一点上它不是私有的。我们正在初始化它，因为我们不想玩一个空字符串。如果我们编写一个函数，将<strong class="jp ir"> <em class="kl"> secret </em> </strong>变量设置为其他任何值，那么它就实现了隐私。<em class="kl">注意</em>:由于我们不知道<a class="ae km" href="http://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=msg.sender#block-and-transaction-properties" rel="noopener ugc nofollow" target="_blank"> <em class="kl"> msg.sender </em> </a>的内容，所以<strong class="jp ir"> <em class="kl"> owner </em> </strong>变量即使在初始化时也是私有的。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mh"><img src="../Images/3a87f0d34ad138559552245fcca2645d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*exUNHglXzgeDw9seYTSI2w.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">允许外部客户端读取名为<strong class="bd lf"> secret </strong>的私有状态变量的函数</figcaption></figure><p id="8404" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第14行</em>:提供了一个名为<strong class="jp ir"> <em class="kl"> getSecret </em> </strong>的函数，其可见性为<a class="ae km" href="http://solidity.readthedocs.io/en/latest/miscellaneous.html?highlight=public#function-visibility-specifiers" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="kl">public</em></strong></a>，并具有<a class="ae km" href="http://solidity.readthedocs.io/en/latest/miscellaneous.html?highlight=view#modifiers" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="kl">view</em></strong></a><strong class="jp ir"><em class="kl"/></strong>和<strong class="jp ir"> <em class="kl"> returns </em> </strong>。<strong class="jp ir"> <em class="kl">视图</em> </strong>通知Solidity编译器，该函数只读取契约的状态变量，不修改它们。<em class="kl">注</em>:截至2017年11月8日，<strong class="jp ir"> <em class="kl">以太坊虚拟机(</em></strong><em class="kl">【EVM】)</em>不强制执行这种只读能力，以太坊区块链上代码运行的地方。在编译时，编译器需要知道函数是否返回任何值，这就是<strong class="jp ir"> <em class="kl">返回</em> </strong>修饰符的原因。</p><p id="d563" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第15行</em>:将<strong class="jp ir"> <em class="kl"> secret </em> </strong>状态变量的值返回给函数的调用者，在我们的例子中会有React。</p><p id="d999" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">继续编译契约，将其部署在<strong class="jp ir"> JavaScript VM </strong> <em class="kl">环境</em>中，并使用它。完成后，我们将设置元掩码。</p><h2 id="9b2f" class="mi le iq bd lf mj mk dn lj ml mm dp ln jy mn mo lr kc mp mq lv kg mr ms lz mt bi translated">设置元掩码</h2><p id="cbb0" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">如果你还没有，请<a class="ae km" href="https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn" rel="noopener ugc nofollow" target="_blank">安装Metamask作为Chrome扩展</a>并设置你的帐户。我发现这个过程相当简单。</p><p id="cfe6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建您的帐户后，点击左上方的<em class="kl">主网络</em>菜单。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mu"><img src="../Images/778bdd53bd76c01672a29dc492e4807d.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*pArGg1-9FSh3HGoqpoioIQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">在Metamask上选择Ropsten测试网络</figcaption></figure><p id="3031" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，选择<em class="kl"> Ropsten测试网络</em>。接下来，我们将把一些假的乙醚放入我们的测试账户。但首先，先说一句。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="822d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl"> Ropsten测试网</em>就是我在这次学习经历中一直影射的以太坊Ropsten Testnet。这里部署的智能合约是实时的，对全世界都是可见的。开发人员使用这些测试网络来确保他们的合同在<em class="kl">主以太坊网络</em>中的行为符合预期，这是真正的以太坊区块链。</p><blockquote class="nc nd ne"><p id="9b52" class="jn jo kl jp b jq jr js jt ju jv jw jx nf jz ka kb ng kd ke kf nh kh ki kj kk ij bi translated">通过Metamask在<em class="iq">主以太坊网络</em>上部署智能合约就像点击一样简单。只需选择主网络，并通过Remix部署合同。</p></blockquote></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="b2c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着<em class="kl"> Ropsten测试网络</em>被选中，我们将从<a class="ae km" href="https://faucet.metamask.io/" rel="noopener ugc nofollow" target="_blank">该站点</a>请求一些假<em class="kl">乙醚</em>。点击“<em class="kl">从龙头</em>请求1以太”按钮，它将创建一个交易，向您的Metamask帐户发送一些假加密货币。我通常点击它几次，这样我就有足够的时间来测试我的应用程序。</p><h2 id="bdf5" class="mi le iq bd lf mj mk dn lj ml mm dp ln jy mn mo lr kc mp mq lv kg mr ms lz mt bi translated">在以太坊Ropsten Testnet上部署智能合约</h2><p id="708f" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">我们已经准备好将我们的合同部署到一个实时测试网络。我们将遵循我们创建第一个契约时呈现的<em class="kl">一般流程</em>，除了这次我们将使用<strong class="jp ir">注入Web3 </strong> <em class="kl">环境</em>。请记住<em class="kl">调试注释</em> : <em class="kl"> </em>请<em class="kl"> </em>确保您已登录元掩码。</p><p id="dedb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击“创建”按钮时，Metamask将显示如下屏幕:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/1a8f8801bc40e65eb7fa4474fcfb4537.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*tz7-RBwLe-m3MJoZsV83XA.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">来自元掩码的事务通知</figcaption></figure><p id="3080" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每当我们要在任何网络上花费<em class="kl">乙醚</em>时，我们会被告知我们的选择是<em class="kl">重置</em>、<em class="kl">提交</em>还是<em class="kl">拒绝</em>交易。请点击<em class="kl">提交</em>。</p><p id="f67a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦提交，我们会在Remix控制台上看到一个未决的消息。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/18bdd10628789d21bf384732adc6d785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*CjV1KPx7boCK36KyO_GxFw.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">我们的智能合同需要时间才能在实际的区块链上部署</figcaption></figure><p id="b5ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以太坊区块链和它的生态系统网络通常每15秒创造一个新的街区。所以，我们必须等待我们的合同生效。很快我们会看到如下屏幕:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nk"><img src="../Images/de84fd950da9068ec77a104bf73ef50f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uIf_cDkvzvd-6GLoWy2vNQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">以太坊Ropsten Testnet上的实时智能合约，显示在屏幕底部“0待处理交易”的正下方</figcaption></figure><p id="3245" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的智能合同现已启动并运行。接下来，我们将开始设置我们的React环境，并将我们的契约连接到前端。</p><h2 id="bce0" class="mi le iq bd lf mj mk dn lj ml mm dp ln jy mn mo lr kc mp mq lv kg mr ms lz mt bi translated">Create-React-App入门</h2><p id="feea" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">在本次学习体验中，我们将使用<em class="kl"> create-react-app </em>来启动并运行react应用程序。我选择这种方法，因为这个项目的重点不是React，而是React如何与以太坊区块链交谈。</p><p id="9655" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">注意</em>:我使用的是Mac OS，但是这里介绍的过程应该在Windows / Linux上兼容或相似。</p><p id="c30d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请打开命令行，并键入以下内容:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nl"><img src="../Images/5986e54fa41813f54f9e79ab952cd293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-VTcdKdsI_Na2w4N-FcBQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">在你的电脑上全局安装create-react-app</figcaption></figure><p id="7342" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装完成后，创建一个名为<em class="kl">React _ ether eum _ connection</em>的React应用程序，或者任何你想给它起的名字。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nm"><img src="../Images/dd5b31fc2e787c29c0038c7888fd2206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MaPNB_rFAloUVRymh9uJXg.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">创建一个React应用程序支架</figcaption></figure><p id="f85d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将<em class="kl"> cd </em>到创建的目录中。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nn"><img src="../Images/eb8275649410b77774a252e04e5337db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nhNLPjSpfOoEtgX8EtnY2w.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">输入应用程序目录</figcaption></figure><p id="9798" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们将使用npm来启动React应用程序。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi no"><img src="../Images/54fd15b8463c9fef882f3eb2fcf7d51d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WWeiFmjVO7PrZ6S0UMm7A.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">启动我们的React应用程序</figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi np"><img src="../Images/407813e0743bdc5200d61b224d616a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Adq2Gj6yJ9dHE1i4nLraow.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">创建-反应-应用程序的欢迎页面</figcaption></figure><p id="4c76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将只编辑应用程序中的一个文件，<em class="kl"> App.js </em>。请在您选择的文本编辑器中打开项目。我将使用Atom。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nq"><img src="../Images/44a8787b41a25e70150b51eb67aabb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sx_uYiedY8brwgCedCl6A.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">在Atom文本编辑器中打开<strong class="bd lf">react _ ether eum _ connection</strong>中的所有文件</figcaption></figure><p id="7cd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在准备通过Metamask将React与我们部署的智能契约连接起来，该契约位于以太坊Ropsten Testnet上。</p><h2 id="19c6" class="mi le iq bd lf mj mk dn lj ml mm dp ln jy mn mo lr kc mp mq lv kg mr ms lz mt bi translated">React和以太坊接口</h2><p id="60b6" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">为了开始React与以太坊的连接，特别是测试网络上部署的智能合约，我们将编写一个组件构造器框架，如下所示:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/754a5aae8d6142a8916a6a911c554920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*bTt6ZP7V_eGPmsSaHgy2BQ.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">准备好与以太坊互动</figcaption></figure><p id="1673" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">假设</em>:如本文开头所述，我假设对React有基本的了解。所以我将重点介绍与以太坊对话的代码。</p><p id="c590" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第9行</em>:创建一个名为<strong class="jp ir"> <em class="kl"> MyContract </em> </strong>的变量，该变量将包含我们的智能合约的<a class="ae km" href="http://solidity.readthedocs.io/en/latest/abi-spec.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">应用二进制接口</em> </strong> ( <em class="kl"> ABI </em> ) </a>，这是一个对象数组。ABI告诉外界智能合约可以进行哪些交互。它类似于一个<a class="ae km" href="https://en.wikipedia.org/wiki/Application_programming_interface" rel="noopener ugc nofollow" target="_blank">应用编程接口(API) </a>。注:我们将很快看到如何为我们的合同获得ABI。</p><p id="5905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第9行续</em>:注意浏览器<strong class="jp ir"> <em class="kl">窗口</em> </strong>对象中的<strong class="jp ir"> <em class="kl"> web3 </em> </strong>对象。在引擎盖下，<strong class="jp ir"> <em class="kl"> web3 </em> </strong>是让与以太坊对话成为可能的魔法物体。通过元掩码注入到<strong class="jp ir"> <em class="kl">窗口</em> </strong>对象中。这个<strong class="jp ir"> <em class="kl"> web3 </em> </strong>对象和它的库有足够的深度，尽管在这个体验中我们将很少使用它。探索<strong class="jp ir"> <em class="kl"> Web3 </em> </strong>需要自己的博文。</p><p id="f13b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第12行</em>:创建一个组件状态属性，它将保存我们的智能契约的<strong class="jp ir"> <em class="kl">地址</em> </strong>。就像，它将包含我们的合同在以太网Ropsten Testnet上的确切位置的十六进制字符串。</p><p id="3230" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经写好了那段代码，让我们转到Remix来获得我们的<strong class="jp ir"><em class="kl">【ABI】</em></strong>和契约<strong class="jp ir"> <em class="kl">地址</em> </strong>。</p><p id="d84b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">一般流程注释</em>:获取<strong class="jp ir"><em class="kl">【ABI】</em></strong>和<strong class="jp ir"> <em class="kl">智能合同地址</em> </strong>的过程将在我们更改或更新合同时重复。请练习一下，因为我们将在第3和第4阶段使用它。</p><p id="32a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">转到Remix上的<strong class="jp ir">运行</strong>选项卡。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ns"><img src="../Images/2dcc349664516b62fcd26ae5a9f0dc0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DoE_BQ86m6rOhW3qBJgpGQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">在<strong class="bd lf">运行</strong>选项卡中，我们可以在屏幕底部找到智能合同地址，如上面的截图所示</figcaption></figure><p id="c83e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击“<em class="kl"> x </em>”左侧的<em class="kl">复制图标</em>，将我们的智能合同地址复制到剪贴板。</p><p id="72f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后将其粘贴到第12行:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nt"><img src="../Images/48a75b0bc7b10015fd58adaa37f64a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPDperHxkauJPJM7Ff9hwQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">将合同<strong class="bd lf">地址</strong>字符串添加到React接口</figcaption></figure><p id="cb0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在回到Remix，点击<strong class="jp ir">编译</strong>标签。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nu"><img src="../Images/825ad0c776f1d0472039471473348df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pE_1gV1XO2UkrXZLIzo5Ig.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">注意<strong class="bd lf">细节</strong>按钮，在<strong class="bd lf">发布到群组</strong>按钮旁边</figcaption></figure><p id="0655" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击<em class="kl">细节</em>按钮，将弹出如下模式:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nv"><img src="../Images/901d2e8536d05c58f147d16d92c0c1e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j5eGWNiHkG_eRlpWgveQKA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">详细信息按钮显示此模态— <strong class="bd lf">界面ABI </strong>是我们的，<strong class="bd lf">你猜对了，</strong>住在哪里</figcaption></figure><p id="c2cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请点击字节码部分下面界面— ABI部分中问号图标旁边的<em class="kl">复制图标</em>。这将把我们的智能合约的ABI复制到剪贴板。</p><p id="f283" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，将其粘贴到第9行。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nw"><img src="../Images/714dcaee962f0bfaa3c837a730e15a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gq5YhNehH4ASWg9-Xl0-jQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">ABI插进React界面。请原谅小字体</figcaption></figure><p id="0a01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的React应用程序现在与我们在Ethereum Ropsten Testnet上部署的智能合约连接起来了！就这么简单。</p><p id="f79e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，让我们创建一个按钮，从我们的合同中查询秘密数据。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nx"><img src="../Images/d9358279d96313ac0fd5bd98bb58e20b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-YGhEoW4ffVcwrK9LwdXQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">React组件的render()内容。第37行添加了按钮标签</figcaption></figure><p id="8e2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第32行</em>:在<em class="kl"> &lt; h1 &gt; </em>标签内添加“<em class="kl"> React &amp;以太坊简单应用</em>”文本。</p><p id="8303" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第35–39行</em>:添加一个<em class="kl"> &lt;按钮&gt; </em>标签和一个<em class="kl"> onClick </em>事件处理程序来触发将属于我们组件的<em class="kl"> querySecret </em>函数。我将按钮“<em class="kl">查询智能合同的秘密</em>”称为描述性按钮。<em class="kl"> &lt; br / &gt; </em>标签是为了增加间距，让按钮在浏览器上看起来好看。</p><p id="e349" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们将编写<em class="kl"> querySecret </em>函数，并将其绑定到我们的组件实例。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ny"><img src="../Images/71ace3bd5fd20281fbe74962e5d64db5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRR7NSwMIpChmfRI_19EhA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">注意:绑定发生在React组件的构造函数内部</figcaption></figure><p id="7605" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第15行</em>:绑定<em class="kl">查询密件</em>。每当在基于类的React组件内的函数中使用<em class="kl"> this </em>关键字时，函数必须绑定到组件实例，这发生在构造函数中。</p><p id="485f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第19行</em>:将<em class="kl"> getSecret </em>函数从<em class="kl"> ContractInstance </em>对象中解构为自己的变量。<em class="kl"> getSecret </em>函数看起来眼熟吗？这和我们在智能合约中写的功能是一样的。我们在契约中编写的所有函数都将在<em class="kl"> ContractInstance </em>对象上可用。</p><p id="0ceb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">第21行</em>:通过回调调用<em class="kl"> getSecret </em>函数。如果没有错误，智能合约的秘密字符串将被记录在我们的浏览器中。我们将在Chrome开发者工具中看到它。</p><p id="5bb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在可以看到结果了。切换您的浏览器，找到我们新创建的按钮。它会自动出现，除非你关闭服务器。如果是这样，在命令行上运行<em class="kl"> npm start </em>。</p><p id="5819" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">调试注意事项</em>:存在竞争情况:如果React组件在Metamask将<strong class="jp ir"> <em class="kl"> web3 </em> </strong>对象注入<strong class="jp ir"> <em class="kl"> window </em> </strong>对象之前加载，就会发生崩溃。请用<em class="kl">Cmd+R</em>(Mac OS)/<em class="kl">Ctrl+R</em>(Windows/Linus)刷新你的页面。这将解决问题。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nz"><img src="../Images/bbc0464094d5b66fb74b6a330d76b5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gDNukq5D1i-MtbOqlIZYtA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">用我们的按钮查询智能合同的反应前端</figcaption></figure><p id="2b2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">注</em>:我加了一些CSS，让按钮字体变大。如果您愿意，请添加'<em class="kl">按钮，输入{ font-size:20px；} </em>在<em class="kl"> App.css </em>文件的底部。</p><p id="dd9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开Chrome Developer Tools，方法是右键单击并从菜单中选择<em class="kl"> Inspect </em>，或者按键<em class="kl">Cmd+Option+J</em>(Mac OS)/<em class="kl">Ctrl+Shift+J</em>(Windows/Linux)。</p><p id="9de5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确保选择了开发工具的<strong class="jp ir">控制台</strong>选项卡。单击按钮，见证从智能合同中检索的数据！</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/e0207638737e562c7d0033705a0912b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*5rJ4uwa6piK5YSSUMIGn2A.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">Chrome开发者工具显示了我们的'<strong class="bd lf">秘密数据</strong>，它位于以太坊Ropsten Testnet上。请注意对未来的警告，虽然在这个项目中可以忽略它</figcaption></figure><p id="313c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">回忆</em>:‘<em class="kl">秘密数据</em>在我们智能合约的构造函数中初始化。看到它显示在我们的浏览器控制台上，这清楚地表明我们已经直接从现场以太坊区块链进行了查询。</p><p id="eeef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二阶段到此为止。我们已经成功地通过Metamask连接了React，与以太坊测试网络进行对话。相当酷！在下一阶段，我们将在Remix上向我们的智能契约添加一些代码，并通过React编辑我们的契约的状态变量。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="6ae1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"/><a class="ae km" href="https://medium.com/@zubairnahmed/https-medium-com-zubairnahmed-react-ethereum-getting-started-with-the-minimum-toolset-required-part-1-of-4-9562efa23d18" rel="noopener"><em class="kl">第1部分</em></a><strong class="jp ir"><em class="kl">第2部分</em></strong><a class="ae km" href="https://medium.com/@zubairnahmed/react-ethereum-getting-started-with-the-minimum-toolset-required-part-3-of-4-6f8c55c751f5" rel="noopener"><em class="kl">第3部分</em></a><a class="ae km" href="https://medium.com/@zubairnahmed/react-ethereum-getting-started-with-the-minimum-toolset-required-part-4-of-4-478be958c16f" rel="noopener"><em class="kl">第4部分</em></a><em class="kl"/><strong class="jp ir"/></p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><figure class="ko kp kq kr gt ks gh gi paragraph-image"><a href="https://levelup.gitconnected.com/"><div class="gh gi ob"><img src="../Images/439094b9a664ef0239afbc4565c6ca49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9uYu-fFL3hIQLGVu0o-EQ.png"/></div></a></figure><div class="oc od gp gr oe of"><a href="https://gitconnected.com/learn/solidity" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">学习坚固性-最佳坚固性教程(2019) | gitconnected</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">14大坚实度教程。课程由开发者提交并投票，让你找到最好的稳定性…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">gitconnected.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot kx of"/></div></div></a></div></div></div>    
</body>
</html>