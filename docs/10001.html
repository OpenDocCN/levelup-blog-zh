<html>
<head>
<title>Tweet planner app with Azure Functions and Contentful</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有Azure功能和内容丰富的Tweet planner应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tweet-planner-app-with-azure-functions-and-contentful-5495869520b?source=collection_archive---------1-----------------------#2021-10-13">https://levelup.gitconnected.com/tweet-planner-app-with-azure-functions-and-contentful-5495869520b?source=collection_archive---------1-----------------------#2021-10-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="40e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">功能启动</em></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/5f53fc9cc8303b3875de0d71caf533f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBSrOiWn6eVl0PYBAOOAIw.png"/></div></div></figure><p id="28ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi lb translated">T2:ech Twitter是一个很棒的社区。每天都有很多有用的信息被创始人、建设者、独立黑客和其他人分享。我最近开始在推特上谈论《进来》的新功能。NET 6，C# 10和Azure。我意识到试图每天拿出不同的内容来分享是困难和繁琐的。如果能提前计划好这些推文，并根据预先设定的时间表自动发布，那就太好了。我决定使用Azure函数和Contentful构建一个简单的工作流。</p><div class="lk ll gp gr lm ln"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd iu gy z fp ls fr fs lt fu fw is bi translated">Azure函数概述</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">Azure Functions是一个无服务器解决方案，允许您编写更少的代码，维护更少的基础架构，并节省…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">docs.microsoft.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb kz ln"/></div></div></a></div><div class="lk ll gp gr lm ln"><a href="https://www.contentful.com/" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd iu gy z fp ls fr fs lt fu fw is bi translated">API-构建数字体验的首个内容平台</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">不仅仅是一个无头的CMS，Contentful是一个API优先的内容管理平台，用于创建、管理和发布内容…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">www.contentful.com</p></div></div><div class="lw l"><div class="mc l ly lz ma lw mb kz ln"/></div></div></a></div><p id="7288" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用基于定时器触发的Azure功能，可以定期在指定的时间发布新的推文。接下来的问题是，我在哪里保存我的Tweet内容？我以前用过Contentful，一个内容管理平台，他们有一个免费的社区空间，非常适合开发个人项目的开发者。所以我决定试一试。</p><p id="8720" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在<a class="ae md" href="https://www.contentful.com/sign-up/" rel="noopener ugc nofollow" target="_blank">免费注册一个免费的内容丰富的账户|内容丰富的</a></p><div class="lk ll gp gr lm ln"><a href="https://www.contentful.com/sign-up/" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd iu gy z fp ls fr fs lt fu fw is bi translated">注册一个免费的内容丰富的帐户</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">使用您最喜欢的技术栈-您选择的语言和框架功能齐全的内容平台- REST和GraphQL…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">www.contentful.com</p></div></div><div class="lw l"><div class="me l ly lz ma lw mb kz ln"/></div></div></a></div></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="2dd5" class="mm mn it bd mo mp mq dn mr ms mt dp mu kb mv mw mx kf my mz na kj nb nc nd ne bi translated">Tweetter工作流程</h2><p id="3baf" class="pw-post-body-paragraph jq jr it js b jt nf jv jw jx ng jz ka kb nh kd ke kf ni kh ki kj nj kl km kn im bi translated">下图显示了Tweetter workflow应用程序的消息流。它从一个定时器触发的Azure函数开始，<code class="fe nk nl nm nn b"><strong class="js iu">TweetterTrigger</strong></code>将在世界标准时间每天上午12点运行。该函数调用Contentful API来检查是否有任何预定的Tweet需要发布到Twitter。如果没有，函数就完成执行并停止。如果有一个新条目需要发布到Twitter，它只需将一条消息放到<code class="fe nk nl nm nn b"><strong class="js iu">post-to-twitter</strong></code>队列中，并完成它的执行。有一个队列被触发，<code class="fe nk nl nm nn b"><strong class="js iu">TweetterPoster</strong></code> Azure函数将使用队列中的消息，构建一个Tweet对象并发布到Twitter。最后，它将另一条消息排队到由<code class="fe nk nl nm nn b"><strong class="js iu">ContentfulEntryUpdater</strong></code> <strong class="js iu"> </strong> Azure函数使用的<code class="fe nk nl nm nn b"><strong class="js iu">contentful-entry-updater</strong></code> <strong class="js iu"> </strong>队列中。该函数会将条目的<code class="fe nk nl nm nn b"><strong class="js iu">IsPublished</strong></code> <strong class="js iu"> </strong>属性更新为true，以防止再次发布相同的Tweet。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi no"><img src="../Images/50c641655634c2e8c68e51920c3f6549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfO81khtSm-D_oRUdWwotg.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk translated">高音架构</figcaption></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="8694" class="mm mn it bd mo mp mq dn mr ms mt dp mu kb mv mw mx kf my mz na kj nb nc nd ne bi translated">内容丰富的内容模型</h2><p id="ea4a" class="pw-post-body-paragraph jq jr it js b jt nf jv jw jx ng jz ka kb nh kd ke kf ni kh ki kj nj kl km kn im bi translated">内容丰富的内容模型代表您创建的内容类型。内容模型有标准字段，包含关于内容类型、其字段和元数据的基本信息。<code class="fe nk nl nm nn b"><strong class="js iu">Tweetter</strong></code>内容类型有以下字段:</p><ul class=""><li id="6081" class="nt nu it js b jt ju jx jy kb nv kf nw kj nx kn ny nz oa ob bi translated"><strong class="js iu">标题</strong>:内容丰富的条目标题</li><li id="4a47" class="nt nu it js b jt oc jx od kb oe kf of kj og kn ny nz oa ob bi translated"><strong class="js iu"> TweetContent </strong>:实际Tweet内容的字段，可以嵌入链接资产，如gif和图像以及外部网站链接</li><li id="0d3f" class="nt nu it js b jt oc jx od kb oe kf of kj og kn ny nz oa ob bi translated"><strong class="js iu">发布日期时间</strong>:发布推文的日期和时间</li><li id="9e10" class="nt nu it js b jt oc jx od kb oe kf of kj og kn ny nz oa ob bi translated"><strong class="js iu">is published</strong>:布尔字段，用于跟踪条目是否已发布到高音喇叭</li></ul><div class="lk ll gp gr lm ln"><a href="https://www.contentful.com/developers/docs/concepts/data-model/?utm_source=webapp&amp;utm_medium=knowledge-base-content_model&amp;utm_campaign=in-app-help" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd iu gy z fp ls fr fs lt fu fw is bi translated">数据模型|内容丰富</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">Contentful将内容组织到空间中，允许您将一个项目的所有相关资源组合在一起…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">www.contentful.com</p></div></div></div></a></div><p id="f704" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是Tweetter内容类型的字段列表以及使用该内容类型创建的第一个条目。</p><div class="kq kr ks kt gt ab cb"><figure class="oh ku oi oj ok ol om paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/a9610237e7245fa2320c7503a5d4383c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*O5BGA7C3zAKRVqKgG580NA.png"/></div></figure><figure class="oh ku on oj ok ol om paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/eee86232f9c1988028e44a20237cbb59.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*z0vCv1E_G_AIJ2Vo524A-w.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk oo di op oq translated">Tweetter内容类型字段和使用内容类型的第一个条目</figcaption></figure></div></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="0d9f" class="mm mn it bd mo mp mq dn mr ms mt dp mu kb mv mw mx kf my mz na kj nb nc nd ne bi translated">高音触发器⏲️</h2><p id="2d84" class="pw-post-body-paragraph jq jr it js b jt nf jv jw jx ng jz ka kb nh kd ke kf ni kh ki kj nj kl km kn im bi translated">下面的代码包含一个TimerTrigger Azure函数<code class="fe nk nl nm nn b">TweetterTrigger</code> <strong class="js iu"> </strong>，它将在世界标准时间每天晚上12点运行。当该函数执行时，它调用Contentful API来检查内容类型为<code class="fe nk nl nm nn b">tweeter</code>的条目，其中条目的<code class="fe nk nl nm nn b">IsPublished</code>标志为<code class="fe nk nl nm nn b">false</code>并且<code class="fe nk nl nm nn b">PublishDateTime</code>小于或等于当前的UTC日期时间。如果没有新的预定Tweets，那么函数简单地返回null，不进行进一步的处理。如果有计划好的Tweet，那么它会选取第一个计划好的项目，从条目中提取并构建Tweet内容，最后返回<code class="fe nk nl nm nn b">TweetterTriggerResponse.</code>。response类的<code class="fe nk nl nm nn b">TweetContent</code>属性有<code class="fe nk nl nm nn b">[QueueOutput("post-to-twitter")]</code>绑定，它会将消息放到<code class="fe nk nl nm nn b">post-to-twitter</code>队列中，而不需要任何额外的代码🤯。消息被Azure函数消耗掉了。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="or os l"/></div></figure><h2 id="02ad" class="mm mn it bd mo mp mq dn mr ms mt dp mu kb mv mw mx kf my mz na kj nb nc nd ne bi translated">推特发帖者🚀</h2><p id="6e43" class="pw-post-body-paragraph jq jr it js b jt nf jv jw jx ng jz ka kb nh kd ke kf ni kh ki kj nj kl km kn im bi translated"><code class="fe nk nl nm nn b">TweetterPoster</code> QueueTrigger Azure函数监听<code class="fe nk nl nm nn b">post-to-twitter</code>队列上的传入消息。我使用的是<code class="fe nk nl nm nn b">Tweetinvi</code> NuGet包，它提供了<code class="fe nk nl nm nn b">TwitterClient</code>和其他各种类型，使得与Twitter API的交互更加容易。</p><div class="lk ll gp gr lm ln"><a href="https://linvi.github.io/tweetinvi/dist/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd iu gy z fp ls fr fs lt fu fw is bi translated">Tweetinvi 5.0 - Tweetinvi 5.0.4文档</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">Tweetinvi是一个. NET C#库，用于访问Twitter REST和STREAM APIs。它是一个. NETCore库，可以用于…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">linvi.github.io</p></div></div></div></a></div><p id="e6b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">队列中的传入消息被反序列化。如果对象包含一个有效的<code class="fe nk nl nm nn b">imageUrl</code>字符串，那么图像首先被上传到Twitter，然后Tweet被传入图像字节和媒体类别，否则它将简单地传入Tweet的内容。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="or os l"/></div></figure><h2 id="ee86" class="mm mn it bd mo mp mq dn mr ms mt dp mu kb mv mw mx kf my mz na kj nb nc nd ne bi translated">✔️内容丰富</h2><p id="856d" class="pw-post-body-paragraph jq jr it js b jt nf jv jw jx ng jz ka kb nh kd ke kf ni kh ki kj nj kl km kn im bi translated">QueueTrigger Azure函数是整个工作流程的最后一步。使用<code class="fe nk nl nm nn b">ContentfulManagementClient,</code>进行API调用，将条目的<code class="fe nk nl nm nn b">IsPublished</code>属性更新为<code class="fe nk nl nm nn b">true</code>,以防止下一次触发工作流时再次发布tweet。此外，条目的版本增加，内容的状态变为<code class="fe nk nl nm nn b">Published</code>。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="or os l"/></div></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="0ec1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是Contentful中的所有条目。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ot"><img src="../Images/ac5511584e98949749579c5c11d7e0e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZjB3c2S8Ac2fNzCATZpDQ.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk translated">内容丰富的条目列表</figcaption></figure><p id="8e1c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下面👇有些推文是用Tweetter自动发布的吗？</p><div class="kq kr ks kt gt ab cb"><figure class="oh ku ou oj ok ol om paragraph-image"><img src="../Images/ae0c37e35fb6cfc84ffcc0bbaf3ae472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hQJE6asvBNAVN02us1FfKw.png"/></figure><figure class="oh ku ov oj ok ol om paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/26925e851c07b781eba092b2155f1dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*m30Dy-v7U3yMfMIYUKVYSQ.png"/></div></figure></div><div class="ab cb"><figure class="oh ku ow oj ok ol om paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/ced82de347861ca19bc9393a084e13c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*mKBPDwP7-3E42im7tfRGGw.png"/></div></figure><figure class="oh ku ox oj ok ol om paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/c0ee52687cfea41e09e630dd9a2b8f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*OHqde1VNrWTmpewj5VaGQw.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk oy di oz oq translated">使用Tweetter自动发布的推文</figcaption></figure></div><p id="f919" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">想试试吗？在我的GitHub帐户上找到库的源代码。在Twitter上关注我，地址:<a class="ae md" href="https://twitter.com/rauniyrchandan" rel="noopener ugc nofollow" target="_blank"> @rauniyrchandan </a>。</p><div class="lk ll gp gr lm ln"><a href="https://github.com/Chandankkrr/Tweetter-App" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd iu gy z fp ls fr fs lt fu fw is bi translated">GitHub-Chandankkrr/tweeter-App</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">克隆项目git克隆https://github.com/Chandankkrr/Tweetter-App.git切换到项目目录，确保…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">github.com</p></div></div><div class="lw l"><div class="pa l ly lz ma lw mb kz ln"/></div></div></a></div></div></div>    
</body>
</html>