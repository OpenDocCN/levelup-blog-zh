<html>
<head>
<title>How to Create a Multi-Lingual Jokes API in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python创建多语言笑话API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-create-a-multi-lingual-jokes-api-in-python-c47957c39d73?source=collection_archive---------16-----------------------#2020-05-25">https://levelup.gitconnected.com/how-to-create-a-multi-lingual-jokes-api-in-python-c47957c39d73?source=collection_archive---------16-----------------------#2020-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8bd4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一天一个笑话，医生远离我</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8b1fad421028cbb55de259c60d098c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLAY6U_lJuL1S00su3z6Aw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@dan_scape?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">丹·库克</a>在<a class="ae le" href="https://unsplash.com/s/photos/laugh?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="5fcc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过阅读这篇文章，你将学会用Python构建一个多语言笑话API。在本教程结束时，您应该有一个工作的开发服务器，它会在每次API调用时为您返回一个随机笑话。您可以基于自己的用例继续在它的基础上进行构建。本教程有4个部分</p><ol class=""><li id="cfb0" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">设置</li><li id="6407" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">履行</li><li id="a0c2" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">试验</li><li id="19ab" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">结论</li></ol><p id="23dd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们进入下一节，开始编写一些Python代码。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="4ee6" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">1.设置</h1><h2 id="fd5b" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">瓶</h2><p id="3bd8" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">设置非常简单明了。在本教程中，我将使用Flask。如果您使用Django或另一个Python服务器，请相应地修改它。强烈建议您在继续之前设置一个虚拟环境。用下面的命令安装Flask。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="05e4" class="my mb it nq b gy nu nv l nw nx">pip install flask</span></pre><h2 id="1df7" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">笑话数据集</h2><p id="a74c" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">下一步是为我们的API收集一些笑话数据。您可以决定将其作为Python字典存储在Python文件中，或者作为json格式存储在文本文件中。这两种方法各有利弊。我将把它作为字典存储在一个名为<code class="fe ny nz oa nq b">api_data.py</code>的文件中。可以根据自己的喜好随意命名。</p><p id="77bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于Python 2用户，在Python文件的顶部添加以下代码。如果您使用的是Python 3，可以放心地忽略这一部分。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="2d28" class="my mb it nq b gy nu nv l nw nx"># -*- coding: utf-8 -*-</span></pre><p id="9a0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这表明我们正在为这个Python文件使用<code class="fe ny nz oa nq b">utf-8</code>编码，因为我们正在构建一个多语言笑话API。</p><p id="3f20" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，创建一个字典，并用你收集的笑话数据集填充它。每个键代表一种语言，值是一个字符串列表。强烈建议使用适当的语言代码，以便将来事情变得更容易。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="8bfb" class="my mb it nq b gy nu nv l nw nx">joke_dict = {<br/>"en": ["joke1", "joke2"],<br/>"zh_cn": ["笑话", "消化", "小花"]<br/>}</span></pre><p id="45c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你没有足够的语言数据，请随意检查以下要点。我添加了一些英语、简体中文和韩语的例子。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="7f56" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们继续下一节，开始实现Python服务器。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="9fc8" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">2.履行</h1><p id="c2eb" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">在与<code class="fe ny nz oa nq b">api_data.py</code>相同的目录下创建一个新的Python文件。</p><h2 id="9c7d" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">导入</h2><p id="9362" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">添加以下导入语句。<code class="fe ny nz oa nq b">random</code>模块将用于从笑话列表中获取一个随机元素。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="ad81" class="my mb it nq b gy nu nv l nw nx">from flask import Flask, request<br/>import api_data<br/>import random</span></pre><p id="030a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">定义以下变量。您可以根据自己的偏好使用任何端口，只要它没有被使用。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="158f" class="my mb it nq b gy nu nv l nw nx">server_port = 5000<br/>app = Flask(__name__)</span></pre><h2 id="844d" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">途径</h2><p id="cccb" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">添加以下代码来定义到API的路由。相应地修改路线的名称。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="5bdf" class="my mb it nq b gy nu nv l nw nx">@app.route('/joke-api')<br/>def joke():</span></pre><p id="846e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在函数内部，添加以下代码以从<code class="fe ny nz oa nq b">GET</code>请求中获取语言数据。如果没有指定，将默认为<code class="fe ny nz oa nq b">en</code>。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="3cbf" class="my mb it nq b gy nu nv l nw nx">language = request.args.get('language', 'en')</span></pre><p id="b85e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">话虽如此，但在我们的<code class="fe ny nz oa nq b">joke_dict</code>中可能会出现指定语言不存在的情况。如果找不到语言，我将把它设置为<code class="fe ny nz oa nq b">en</code>。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="c2a3" class="my mb it nq b gy nu nv l nw nx">if(language not in api_data.joke_dict):<br/>        language = 'en'</span></pre><p id="5c3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">函数的最后一部分是返回随机笑话。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="9386" class="my mb it nq b gy nu nv l nw nx">return random.choice(api_data.joke_dict[language])</span></pre><p id="8cd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以将它包装在一个<code class="fe ny nz oa nq b">json</code>中，API的状态根据您的用例指示为<code class="fe ny nz oa nq b">Success</code>或<code class="fe ny nz oa nq b">Failure</code>。</p><h2 id="5ecf" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">主要的</h2><p id="f9af" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">最后，添加以下代码以在启动时运行Flask应用程序。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="906d" class="my mb it nq b gy nu nv l nw nx">if __name__ == "__main__":<br/>    app.run('0.0.0.0',port=server_port)</span></pre><p id="3911" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您的Python文件中应该有以下代码</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="cc0a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦你对它感到满意，就运行Flask应用程序。在下一节中，我们将测试joke API。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="abd5" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">3.试验</h1><p id="3417" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">访问我们API的url应该如下所示</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="b72d" class="my mb it nq b gy nu nv l nw nx">localhost:5000/joke-api?language=en</span></pre><h2 id="1891" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">（构成动词）表示“使处于…状态”</h2><p id="a926" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">如果您对路由的端口或名称进行了任何更改，请对其进行相应的修改。当你调用API时，你应该得到一个随机的笑话。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/284ee05e748da759ca5c88a0d3e42482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axVFPNwBjtU-JFKSbmKUJQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><h2 id="bf17" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">字典中的其他语言</h2><p id="c126" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">让我们使用除了<code class="fe ny nz oa nq b">en</code>之外的语言再次测试API。为此，我将使用<code class="fe ny nz oa nq b">zh_cn</code>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/1df6c3de7273dc332464a93862c737af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kug1GszVtDH2ZfCCMHr1-A.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><h2 id="5a5a" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">字典中没有的其他语言</h2><p id="6375" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">如果您指定的语言在字典中找不到，它应该返回一个英语笑话。让我们用代表日语的<code class="fe ny nz oa nq b">ja</code>来试试吧。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/03e71bd96049cd061739114762041651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZanZjhmOtFR2qexdVfv1A.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><h2 id="9a4b" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">未指定语言</h2><p id="9474" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">如果没有指定语言，它应该默认为英语。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/a2610e20b465451714a10390e8ff4cdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K-sFsccl2ZSj3fq1UtZZyg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><p id="9191" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">恭喜你！您已经成功构建了自己的多语言笑话API。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="fefc" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">4.结论</h1><p id="1419" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">让我们回顾一下今天所学的内容。</p><p id="db8d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们首先通过pip install安装烧瓶模块。此外，我们还准备了一些笑话数据集，并将其作为字典存储在Python文件中，其中key代表一种语言，值是笑话列表。</p><p id="4ab2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，我们实现了一个简单的Flask应用程序，当你调用它的API时，它会返回一个随机的笑话。</p><p id="3416" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们测试了我们的多语言笑话API，并确认它正在按预期工作。</p><p id="7c61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢你阅读这篇文章。希望在下一篇文章中再见到你！</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="1dc1" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">参考</h1><ol class=""><li id="3d06" class="lf lg it js b jt nk jx nl kb oh kf oi kj oj kn lk ll lm ln bi translated"><a class="ae le" href="https://gist.github.com/wfng92/964a8f4fad7395bb93a32c66612e9183" rel="noopener ugc nofollow" target="_blank"> myapp.py要点</a></li><li id="8ce9" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><a class="ae le" href="https://gist.github.com/wfng92/dc4e5b50d4d9f9718c0c09f35092c33d" rel="noopener ugc nofollow" target="_blank"> api_data.py要点</a></li></ol></div></div>    
</body>
</html>