<html>
<head>
<title>Card Swipe View with Indicator using View Pager</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用视图寻呼机的带指示器的刷卡视图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/card-swipe-view-with-indicator-using-view-pager-ae5c01c7fe5?source=collection_archive---------4-----------------------#2020-01-29">https://levelup.gitconnected.com/card-swipe-view-with-indicator-using-view-pager-ae5c01c7fe5?source=collection_archive---------4-----------------------#2020-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jn jo jp jq"><div class="bz fp l di"><div class="jr js l"/></div></figure><p id="1f9d" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">在这篇文章中，我将向你展示如何使用Kotlin中的view pager来实现一个动态的可滑动卡片视图。我假设你对Kotlin和Android有一些基本的了解</p><p id="a999" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">我们现在将创建一个新的空项目，不再多说，让我们直接进入代码:</p><h1 id="05a9" class="kr ks iq bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">第一步:</h1><p id="74bb" class="pw-post-body-paragraph jt ju iq jv b jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km lt ko kp kq ij bi translated">首先，我们将设置activity_main.xml布局</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="b090" class="md ks iq lz b gy me mf l mg mh">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:app="http://schemas.android.com/apk/res-auto"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>    tools:context=".fragment.PetsFragment"&gt;<br/><br/><br/>    &lt;androidx.constraintlayout.widget.ConstraintLayout<br/>        android:id="@+id/layout_empty"<br/>        android:visibility="gone"<br/>        android:layout_width="match_parent"<br/>        android:layout_height="match_parent"&gt;<br/><br/>        &lt;TextView<br/>            android:id="@+id/textView5"<br/>            android:layout_width="wrap_content"<br/>            android:layout_height="wrap_content"<br/>            android:layout_marginStart="24dp"<br/>            android:layout_marginLeft="24dp"<br/>            android:layout_marginTop="24dp"<br/>            android:fontFamily="@font/gotham_bold"<br/>            android:text="@string/txt_pets"<br/>            android:textColor="@color/txt_dark_gray"<br/>            android:textSize="26sp"<br/>            app:layout_constraintEnd_toEndOf="parent"<br/>            app:layout_constraintHorizontal_bias="0.0"<br/>            app:layout_constraintStart_toStartOf="parent"<br/>            app:layout_constraintTop_toTopOf="parent" /&gt;<br/><br/>        &lt;ImageView<br/>            android:layout_width="wrap_content"<br/>            android:layout_height="wrap_content"<br/>            android:src="@drawable/ic_empty"<br/>            app:layout_constraintBottom_toBottomOf="parent"<br/>            app:layout_constraintEnd_toEndOf="parent"<br/>            app:layout_constraintStart_toStartOf="parent"<br/>            app:layout_constraintTop_toTopOf="parent" /&gt;<br/><br/>        &lt;ImageView<br/>            android:id="@+id/img_add_pets"<br/>            android:layout_width="wrap_content"<br/>            android:layout_height="wrap_content"<br/>            android:src="@drawable/ic_add"<br/>            android:scaleType="center"<br/>            app:layout_constraintBottom_toTopOf="@+id/textView6"<br/>            app:layout_constraintEnd_toEndOf="@+id/textView6"<br/>            app:layout_constraintStart_toStartOf="@+id/textView6" /&gt;<br/><br/>        &lt;TextView<br/>            android:id="@+id/textView6"<br/>            android:layout_width="wrap_content"<br/>            android:layout_height="wrap_content"<br/>            android:layout_marginBottom="24dp"<br/>            android:text="@string/add_first_pet"<br/>            android:fontFamily="@font/gotham_book"<br/>            app:layout_constraintBottom_toBottomOf="parent"<br/>            app:layout_constraintEnd_toEndOf="parent"<br/>            app:layout_constraintStart_toStartOf="parent" /&gt;<br/><br/><br/>    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;<br/><br/><br/>    &lt;androidx.constraintlayout.widget.ConstraintLayout<br/>        android:id="@+id/layout_main"<br/>        android:layout_width="match_parent"<br/>        android:layout_height="match_parent"&gt;<br/><br/><br/>        &lt;TextView<br/>            android:id="@+id/textView7"<br/>            android:layout_width="wrap_content"<br/>            android:layout_height="wrap_content"<br/>            android:layout_marginStart="24dp"<br/>            android:layout_marginTop="16dp"<br/>            android:fontFamily="@font/gotham_bold"<br/>            android:text="@string/txt_pets"<br/>            android:textColor="@color/txt_dark_gray"<br/>            android:textSize="26sp"<br/>            app:layout_constraintEnd_toEndOf="parent"<br/>            app:layout_constraintHorizontal_bias="0.0"<br/>            app:layout_constraintStart_toStartOf="parent"<br/>            app:layout_constraintTop_toTopOf="parent" /&gt;<br/><br/>        &lt;ImageView<br/>            android:layout_width="50dp"<br/>            android:layout_height="50dp"<br/>            android:layout_marginEnd="24dp"<br/>            android:src="@drawable/ic_add"<br/>            android:scaleType="fitXY"<br/>            app:layout_constraintBottom_toBottomOf="@+id/textView7"<br/>            app:layout_constraintEnd_toEndOf="parent"<br/>            app:layout_constraintTop_toTopOf="@+id/textView7" /&gt;<br/><br/>        &lt;androidx.viewpager.widget.ViewPager<br/>            android:id="@+id/view_pager"<br/>            android:layout_width="match_parent"<br/>            android:layout_height="0dp"<br/>            android:layout_marginTop="16dp"<br/>            android:layout_marginBottom="50dp"<br/>            android:clipToPadding="false"<br/>            android:foregroundGravity="center"<br/>            android:overScrollMode="never"<br/>            app:layout_constraintBottom_toBottomOf="parent"<br/>            app:layout_constraintEnd_toEndOf="parent"<br/>            app:layout_constraintStart_toStartOf="parent"<br/>            app:layout_constraintTop_toBottomOf="@+id/textView7" /&gt;<br/><br/>        &lt;LinearLayout<br/>            android:id="@+id/slider_dots"<br/>            android:layout_width="match_parent"<br/>            android:layout_height="0dp"<br/>            android:orientation="horizontal"<br/>            android:gravity="center_vertical|center_horizontal"<br/>            app:layout_constraintBottom_toBottomOf="parent"<br/>            app:layout_constraintEnd_toEndOf="parent"<br/>            app:layout_constraintStart_toStartOf="parent"<br/>            app:layout_constraintTop_toBottomOf="@+id/view_pager" /&gt;<br/><br/>    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;<br/><br/>&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span></pre><h1 id="a405" class="kr ks iq bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">第二步:</h1><p id="98b8" class="pw-post-body-paragraph jt ju iq jv b jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km lt ko kp kq ij bi translated">打开MainActivity.kt并如下所述声明这些变量:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="694e" class="md ks iq lz b gy me mf l mg mh">private lateinit var adapter: PetAdapter<br/>private lateinit var models: ArrayList&lt;PetsModel&gt;<br/>private lateinit var viewPager: ViewPager<br/>var sliderDotspanel: LinearLayout? = null<br/>private var dotscount = 0</span></pre><p id="6903" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">现在是初始化变量的时候了，我将在MainActivity上呈现的列表中添加虚拟值:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="d225" class="md ks iq lz b gy me mf l mg mh">viewPager = findViewById(R.id.<em class="mi">view_pager</em>)<br/>sliderDotspanel = findViewById(R.id.<em class="mi">slider_dots</em>)<br/><br/>models = ArrayList()<br/>models.add(PetsModel(R.drawable.<em class="mi">dummy_image</em>,"Dobby", "Dog"))<br/>models.add(PetsModel(R.drawable.<em class="mi">dummy_image</em>,"Kitto", "Cat"))<br/>models.add(PetsModel(R.drawable.<em class="mi">dummy_image</em>,"Cozmo", "Lambardor"))<br/>models.add(PetsModel(R.drawable.<em class="mi">dummy_image</em>,"Tiger", "German Shepherd"))<br/>models.add(PetsModel(R.drawable.<em class="mi">dummy_image</em>,"Husky", "Husky"))<br/>models.add(PetsModel(R.drawable.<em class="mi">dummy_image</em>,"Cat", "Unknown"))</span><span id="0fca" class="md ks iq lz b gy mj mf l mg mh">adapter = PetAdapter(models, this@MainActivity)<br/>viewPager.<em class="mi">adapter </em>= adapter</span></pre><h1 id="fca3" class="kr ks iq bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">第三步:</h1><p id="2319" class="pw-post-body-paragraph jt ju iq jv b jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km lt ko kp kq ij bi translated">让我们转到适配器部分，看看如何创建一个叫做pageAdapter的东西，它负责在屏幕上呈现片段。创建一个名为“PetAdapter”的新Java类，并扩展“PagerAdapter ”,只需将下面的代码复制粘贴到该类中，我将用简单的方式解释它。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="455a" class="md ks iq lz b gy me mf l mg mh">import android.content.Context;<br/>import android.view.LayoutInflater;<br/>import android.view.View;<br/>import android.view.ViewGroup;<br/>import android.widget.ImageView;<br/>import android.widget.TextView;<br/>import androidx.annotation.NonNull;<br/>import androidx.viewpager.widget.PagerAdapter;<br/><br/>import com.celeritassolution.cardwipeview.R;<br/>import com.celeritassolution.cardwipeview.model.PetsModel;<br/><br/>import java.util.ArrayList;<br/><br/>public class PetAdapter extends PagerAdapter {<br/><br/>    private ArrayList&lt;PetsModel&gt; models;<br/>    private LayoutInflater layoutInflater;<br/>    private Context context;<br/><br/>    public PetAdapter(ArrayList&lt;PetsModel&gt; models, Context context) {<br/>        this.models = models;<br/>        this.context = context;<br/>    }<br/><br/>    @Override<br/>    public int getCount() {<br/>        return models.size();<br/>    }<br/><br/>    @Override<br/>    public boolean isViewFromObject(@NonNull View view, @NonNull Object object) {<br/>        return view.equals(object);<br/>    }<br/><br/>    @NonNull<br/>    @Override<br/>    public Object instantiateItem(@NonNull ViewGroup container, final int position) {<br/>        layoutInflater = LayoutInflater.<em class="mi">from</em>(context);<br/>        View view = layoutInflater.inflate(R.layout.<em class="mi">item</em>, container, false);<br/><br/>        ImageView imageView;<br/>        TextView title, desc;<br/><br/>        imageView = view.findViewById(R.id.<em class="mi">image</em>);<br/>        title = view.findViewById(R.id.<em class="mi">title</em>);<br/>        desc = view.findViewById(R.id.<em class="mi">txt_des</em>);<br/><br/><br/>        imageView.setImageResource(models.get(position).getImage());<br/>        title.setText(models.get(position).getTitle());<br/>        desc.setText(models.get(position).getDesc());<br/><br/>        container.addView(view, 0);<br/>        return view;<br/>    }<br/><br/>    @Override<br/>    public void destroyItem(@NonNull ViewGroup container, int position, @NonNull Object object) {<br/>        container.removeView((View)object);<br/>    }<br/>}</span></pre><p id="e336" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">我们首先定义类的构造函数，我们将传递两个参数一个数组列表，它将保存数据以决定在主活动和上下文中创建多少项。我们更关心将为我们带来奇迹的instantiateItem()。基本上，这个方法将为给定的位置创建页面。适配器负责将视图添加到这里给出的容器中，尽管它只需要确保在从finishUpdate(ViewGroup)返回时完成这项工作</p><p id="609b" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">ref:<a class="ae mk" href="http://Official documentation for the pageAdapter" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/reference/Android/support/v4/view/pager adapter</a></p><p id="e086" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">以及返回视图数量的getCount()方法。</p><h1 id="f2de" class="kr ks iq bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">第四步:</h1><p id="ef86" class="pw-post-body-paragraph jt ju iq jv b jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km lt ko kp kq ij bi translated">让我们创建将在适配器中展开的item.xml布局:</p><figure class="lu lv lw lx gt jq gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/a2ddda1a97b93be33b10adcb4fd1893a.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*mtTjwA_Hp7A1MGkM6arQhw.png"/></div></figure><p id="820e" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">该项目的布局可以是任何东西，为简单起见，我们将去这个布局，或者你也可以有你自己的布局实现。:)<br/>所以只要把代码复制粘贴下来就行了。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="f320" class="md ks iq lz b gy me mf l mg mh">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:app="http://schemas.android.com/apk/res-auto"<br/>    android:orientation="vertical"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"&gt;<br/><br/>    &lt;androidx.cardview.widget.CardView<br/>        android:layout_width="match_parent"<br/>        android:layout_height="match_parent"<br/>        android:layout_margin="8dp"<br/>        app:cardCornerRadius="8dp"&gt;<br/><br/>        &lt;androidx.constraintlayout.widget.ConstraintLayout<br/>            android:layout_width="match_parent"<br/>            android:layout_height="match_parent"&gt;<br/><br/>            &lt;ImageView<br/>                android:id="@+id/image"<br/>                android:layout_width="match_parent"<br/>                android:layout_height="0dp"<br/>                android:cropToPadding="true"<br/>                android:scaleType="centerCrop"<br/>                android:src="@drawable/dummy_image"<br/>                app:layout_constraintBottom_toBottomOf="parent"<br/>                app:layout_constraintEnd_toEndOf="parent"<br/>                app:layout_constraintStart_toStartOf="parent"<br/>                app:layout_constraintTop_toTopOf="parent" /&gt;<br/><br/>            &lt;TextView<br/>                android:id="@+id/title"<br/>                android:layout_width="wrap_content"<br/>                android:layout_height="wrap_content"<br/>                android:layout_marginStart="32dp"<br/>                android:layout_marginTop="24dp"<br/>                android:fontFamily="@font/gotham_bold"<br/>                android:text="Dobby"<br/>                android:textColor="@color/white"<br/>                app:layout_constraintEnd_toEndOf="parent"<br/>                app:layout_constraintHorizontal_bias="0.0"<br/>                app:layout_constraintStart_toStartOf="parent"<br/>                app:layout_constraintTop_toTopOf="@+id/image" /&gt;<br/><br/>            &lt;TextView<br/>                android:id="@+id/txt_des"<br/>                android:layout_width="0dp"<br/>                android:layout_height="wrap_content"<br/>                android:layout_marginEnd="32dp"<br/>                android:fontFamily="@font/gotham_narrow_bold"<br/>                android:text="English Cocker Spaniel"<br/>                android:textColor="@color/txt_gray"<br/>                android:textSize="12sp"<br/>                app:layout_constraintEnd_toStartOf="@+id/img_edit_pet"<br/>                app:layout_constraintHorizontal_bias="0.0"<br/>                app:layout_constraintStart_toStartOf="@+id/title"<br/>                app:layout_constraintTop_toBottomOf="@+id/title" /&gt;<br/><br/>            &lt;ImageView<br/>                android:id="@+id/img_edit_pet"<br/>                android:layout_width="72dp"<br/>                android:layout_height="72dp"<br/>                android:layout_marginEnd="8dp"<br/>                android:scaleType="fitXY"<br/>                android:src="@drawable/ic_edit"<br/>                app:layout_constraintEnd_toEndOf="parent"<br/>                app:layout_constraintTop_toTopOf="parent" /&gt;<br/><br/>            &lt;Button<br/>                android:id="@+id/btn_start"<br/>                style="@style/Widget.AppCompat.Button.Borderless"<br/>                android:layout_width="0dp"<br/>                android:layout_height="wrap_content"<br/>                android:layout_marginStart="12dp"<br/>                android:layout_marginEnd="50dp"<br/>                android:layout_marginBottom="24dp"<br/>                android:background="@drawable/btn_login"<br/>                android:drawableRight="@drawable/ic_play"<br/>                android:fontFamily="@font/gotham_narrow_bold"<br/>                android:paddingStart="32sp"<br/>                android:paddingTop="18dp"<br/>                android:paddingEnd="32sp"<br/>                android:paddingBottom="18dp"<br/>                android:text="@string/start_survey"<br/>                android:textAlignment="viewStart"<br/>                android:textColor="@color/white"<br/>                app:layout_constraintBottom_toBottomOf="parent"<br/>                app:layout_constraintEnd_toEndOf="parent"<br/>                app:layout_constraintStart_toStartOf="@+id/title" /&gt;<br/><br/>        &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;<br/><br/>    &lt;/androidx.cardview.widget.CardView&gt;<br/><br/>&lt;/LinearLayout&gt;</span></pre><p id="c36e" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">我们已经完成了适配器，现在让我们回到我们的主要活动，并完成这一部分。</p><p id="51a7" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">我们现在必须在视图页下面实现指示器，所以让我们从这里开始:首先，我们将从一个适配器中获得指示器的计数，这个适配器是我们之前通过调用而创建的，如下所示。然后，我们将动态创建图像视图，并将这些图像视图添加到名为“sliderDotspanel”的线性布局中，最后，我们将为选定和未选定的指示器设置图像可绘制性</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="3a33" class="md ks iq lz b gy me mf l mg mh">dotscount = adapter.<em class="mi">count<br/><br/></em>val dots = <em class="mi">arrayOfNulls</em>&lt;ImageView&gt;(dotscount)<br/><br/>for (i in 0 <em class="mi">until </em>dotscount) {<br/>    dots[i] = ImageView(this)<br/>    dots[i]!!.setImageDrawable(<br/>           ContextCompat.getDrawable(this,<br/>           R.drawable.<em class="mi">non_active_dot</em>))<br/>    val params = LinearLayout.LayoutParams(<br/>          LinearLayout.LayoutParams.<em class="mi">WRAP_CONTENT</em>,<br/>          LinearLayout.LayoutParams.<em class="mi">WRAP_CONTENT<br/>    )<br/>    </em>params.setMargins(8, 0, 8, 0)<br/>    sliderDotspanel!!.addView(dots[i], params)<br/>}<br/>dots[0]?.setImageDrawable(<br/>           ContextCompat.getDrawable(<br/>           this, R.drawable.<em class="mi">active_dot</em>)<br/>           )</span></pre><h1 id="5c92" class="kr ks iq bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">最后一步:</h1><p id="4b1c" class="pw-post-body-paragraph jt ju iq jv b jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km lt ko kp kq ij bi translated">我们已经创建了viewpager、它的适配器、布局和所有东西，现在我们只需将指示器与View Pager连接起来，以在滑动时监听视图的变化，为此我们必须设置“setOnPageChangeListener ”,每当页面发生变化或增量滚动时都会调用它，并覆盖它的方法。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="b4d4" class="md ks iq lz b gy me mf l mg mh">viewPager.setOnPageChangeListener(object: ViewPager.OnPageChangeListener{<br/>    override fun onPageScrollStateChanged(state: Int) {}<br/><br/>    override fun onPageScrolled(<br/>            position: Int, <br/>            positionOffset: Float, <br/>            positionOffsetPixels: Int){}<br/><br/>    override fun onPageSelected(position: Int) {<br/>        for (i in 0 <em class="mi">until </em>dotscount) {<br/>            dots[i]?.setImageDrawable(<br/>            ContextCompat.getDrawable(<br/>            this@MainActivity,R.drawable.<em class="mi">non_active_dot</em>)<br/>            )<br/>        }<br/>        dots[position]?.setImageDrawable(<br/>        ContextCompat.getDrawable(<br/>        this@MainActivity,R.drawable.<em class="mi">active_dot</em>)<br/>        )<br/>    }<br/>})</span></pre><p id="1a88" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">“onPageSelected”方法将在新页面被选中时调用，并且在每个页面选择中，我们必须相对于所选位置移动我们的指示器。</p><p id="3ae8" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">答对了，现在就这样。您可以参考我的GitHub repo以获得本文中使用的资源和完整的项目。<br/><a class="ae mk" href="https://github.com/aasif1297/CardwipeView" rel="noopener ugc nofollow" target="_blank">https://github.com/aasif1297/CardwipeView</a></p></div></div>    
</body>
</html>