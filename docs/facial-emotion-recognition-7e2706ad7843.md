# é¢éƒ¨æƒ…æ„Ÿè¯†åˆ«

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/facial-emotion-recognition-7e2706ad7843>

## æ£€æµ‹äººè„¸é¢éƒ¨æƒ…ç»ªçš„ä¸¤ç§ä¸åŒæ–¹æ³•

![](img/e67c7c0002361b6a0bc71c43b65d71a7.png)

ä½œè€… GIF

> é¢éƒ¨æƒ…ç»ªå¯ä»¥ä½œä¸ºä¸€ç§éè¯­è¨€çš„äº¤æµæ–¹å¼å¼•å…¥ã€‚äººä»¬é€šè¿‡è¯­è¨€æ¥è¡¨è¾¾ä»–ä»¬çš„æ„Ÿå—å’Œè¡¨æƒ…ï¼Œä½†æ˜¯é¢éƒ¨è¡¨æƒ…å¯ä»¥ç”¨æ¥åŠ å¼ºäº¤æµã€‚é¢éƒ¨æƒ…æ„Ÿè¯†åˆ«æ˜¯è¿‘æ¥çš„ä¸€ä¸ªæ—¶é«¦è¯é¢˜ã€‚åŸºæœ¬ä¸Šå¯ä»¥è¯†åˆ«çš„é¢éƒ¨æƒ…ç»ªæœ‰**å¿«ä¹ã€æ‚²ä¼¤ã€æ„¤æ€’ã€ä¸­æ€§ã€ææƒ§ã€åŒæ¶ã€æƒŠè®¶**ï¼ŒåŠ åœ¨ä¸€èµ·å…±æœ‰ 7 ç§ã€‚
> 
> äººè„¸æƒ…æ„Ÿè¯†åˆ«å¯ä»¥å®æ—¶å®ç°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é™æ€å›¾åƒå®ç°ã€‚æœ¬æ–‡é€šè¿‡ä¸¤ç§ä¸»è¦æ–¹æ³•ä¸ºæ‚¨æä¾›äº†ä½¿ç”¨é™æ€å›¾åƒæ¥æ£€æµ‹é¢éƒ¨æƒ…ç»ªçš„æ–¹æ³•ã€‚æˆ‘ç”¨ Google Colab ç»ƒä¹ äº†ä»¥ä¸‹ä»£ç ã€‚

## [1ã€‚FER å›¾ä¹¦é¦†](https://pypi.org/project/fer/)

è¿™æ˜¯ä¸€ä¸ªåŸºäºæ·±åº¦ç¥ç»ç½‘ç»œæ„å»ºçš„ Python åº“ï¼Œä½¿ç”¨äº† *Tensorflowã€Keras åº“*ï¼Œä½¿ç”¨çš„æ•°æ®é›†æ¥è‡ª *Kaggle çš„è¡¨å¾å­¦ä¹ ç«èµ›æŒ‘æˆ˜:é¢éƒ¨è¡¨æƒ…è¯†åˆ«æŒ‘æˆ˜*ã€‚FER è¦æ±‚ä¾èµ–å…³ç³»ä¸º ***Python > 3.6ï¼ŒOpenCV > =3.2*** ï¼Œä»¥åŠ***tensor flow>= 1 . 7 . 0****ã€‚*å¦‚æœæ‚¨æ²¡æœ‰å®‰è£… OpenCV å’Œ Tensorflowï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚

```
**pip install opencv-contrib-python
pip install tensorflow**
```

ç„¶åå®‰è£… FER åº“ï¼Œ

```
**pip install fer**
```

å°è¯•éµå¾ªä»£ç ç‰‡æ–­ã€‚

```
**from fer import FER
import matplotlib.pyplot as plt
%matplotlib inline****test_image = plt.imread("/content/Merlin_1.jpg")**# Faces by default are detected using OpenCV's Haar Cascade classifier. To use the more accurate MTCNN network, add the parameter
**emo_detector = FER(mtcnn=True)**# Capture all the emotions on the image
**captured_emotions = emo_detector.detect_emotions(test_image)**# Print all captured emotions with the image
**print(captured_emotions)
plt.imshow(test_image)**
```

ä½ ä¼šå¾—åˆ°å¦‚ä¸‹ç»“æœã€‚

![](img/9b5c19c6d11e8fa3e5ea3262d8968bf6.png)

ä½œè€…å›¾ç‰‡

æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥è·å–å›¾åƒä¸­æå–çš„æƒ…æ„Ÿï¼Œ

```
**captured_emotions**
```

![](img/3e1cc5cd8783a28f0134cdd19d2c2e3a.png)

ä½œè€…æ•æ‰çš„æƒ…æ„Ÿå›¾ç‰‡

ç„¶åä½¿ç”¨ä¸‹é¢çš„ä»£ç ç‰‡æ–­ä»ä½ çš„å›¾åƒä¸­æå–å‡ºå¤§éƒ¨åˆ†æƒ…æ„Ÿ

```
**print(emo_detector.top_emotion(test_image))**
```

![](img/29b009ac09a4919cc4ad7619cda16883.png)

ä½œè€…å›¾ç‰‡-æœ€é«˜æƒ…æ„Ÿ

## [2ã€‚DeepFace](https://pypi.org/project/deepface/)

å®ƒæ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„è½»é‡çº§é¢éƒ¨è¯†åˆ«å’Œé¢éƒ¨å±æ€§åˆ†ææ¡†æ¶ï¼Œå®ƒæ˜¯ç”±è„¸ä¹¦çš„ä¸€ä¸ªç ”ç©¶å°ç»„åˆ›å»ºçš„ä¸€ä¸ªæ·±åº¦å­¦ä¹ é¢éƒ¨è¯†åˆ«ç³»ç»Ÿã€‚ä½¿ç”¨ DeepFaceï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æ*é¢éƒ¨å±æ€§ï¼Œå¦‚å¹´é¾„ã€æ€§åˆ«ã€æƒ…æ„Ÿå’Œç§æ—*ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½¿ç”¨ DeepFace å¯ä»¥è¾¾åˆ°ä¸€ä¸ª***97.35%***0.25%çš„å‡†ç¡®ç‡æ°´å¹³ã€‚ä¸‹é¢é‡ç‚¹è®²ä¸€ä¸‹å¦‚ä½•åœ¨ Python ä¸­å¤„ç† DeepFaceã€‚

```
**pip install deepface**
```

å®‰è£… deepface åï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç åŠ è½½å›¾åƒå¹¶ç»˜åˆ¶å›¾åƒã€‚

```
**from deepface import DeepFace
import cv2
import matplotlib.pyplot as plt
img_path = 'Merlin_1.jpg'
img = cv2.imread(img_path)
plt.imshow(img[:, :,::-1])**
```

![](img/64881a6c79ceabd1c2bc44c258bd248b.png)

ä½œè€…å›¾ç‰‡

ç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å›¾åƒçš„äººå£ç»Ÿè®¡ä¿¡æ¯ã€‚

```
**demography = DeepFace.analyze(img_path)
demography**
```

![](img/93695b5f4732c8264cb4f5b935266a2d.png)

æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ-å›¾åƒçš„äººå£ç»Ÿè®¡ä¿¡æ¯

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åªæå–æƒ…æ„Ÿæ•°æ®ã€‚

```
**demography['emotion']**
```

![](img/5a8f7ce1d42410dcba3870c66e6d13b4.png)

æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ-å›¾åƒçš„æƒ…æ„Ÿæ•°æ®

é‚£ä¹ˆå¦‚æœæƒ³æå–å›¾åƒæœ€çªå‡ºçš„æƒ…æ„Ÿï¼Œå°±ç”¨ä¸‹é¢çš„ä»£ç ã€‚

```
**demography['dominant_emotion']**
```

![](img/0c9d7bd80262094817f01c2a3175a6e9.png)

ä½œè€…ä¸»å¯¼æƒ…æ„Ÿçš„å›¾åƒ

å®Œæˆäº†ä¼™è®¡ä»¬â€¦ğŸ˜€

æˆ‘ä»¬å·²ç»è®¨è®ºäº†ä¸¤ç§å¯ä»¥ç”¨æ¥è¯†åˆ«äººè„¸é¢éƒ¨æƒ…ç»ªçš„æ–¹æ³•ã€‚

å¸Œæœ›ä½ èƒ½æ”¶é›†ä¸€äº›å…³äºä½¿ç”¨ Python ä¸­çš„ FER å’Œ DeepFace è¯†åˆ«é¢éƒ¨æƒ…ç»ªå’Œè¡¨æƒ…çš„é‡è¦äº‹å®ã€‚

æœªæ¥çš„æ–‡ç« å°†é‡ç‚¹å…³æ³¨å¬åŠ›å—æŸç¾¤ä½“ä¸­é¢éƒ¨æƒ…æ„Ÿè¯†åˆ«çš„å·®å¼‚ï¼Œä»¥åŠå¦‚ä½•è®­ç»ƒæ•°æ®é›†æ¥æ”¶é›†å®æ—¶é¢éƒ¨æƒ…æ„Ÿè¯†åˆ«ã€‚

æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·é¼“æŒã€‚ğŸ™Œ