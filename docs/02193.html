<html>
<head>
<title>Create a Recommendation System in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python创建推荐系统</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-a-recommendation-system-in-python-d7a95b2837ab?source=collection_archive---------14-----------------------#2020-02-25">https://levelup.gitconnected.com/create-a-recommendation-system-in-python-d7a95b2837ab?source=collection_archive---------14-----------------------#2020-02-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b4a1" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">ARM简介，后面是一个编码示例</h2><div class=""/><div class=""><h2 id="49cc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用关联规则挖掘来揭示模式</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/ebacd0d55ebce8431a867b13fa4089a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IrJj4kqeyIylbhI4.png"/></div></div></figure><h2 id="ef73" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">什么是关联规则挖掘(ARM)？</h2><p id="15d1" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg lm mh mi mj lq mk ml mm lu mn mo mp mq im bi translated">这是一种无监督的机器学习方法，旨在揭示数据集中有趣的模式和关系。例如，我们可以尝试识别哪些产品通常是顾客在杂货店一起购买的。这可以帮助我们安排商店中的产品，推荐产品，或创造出有高概率被顾客挑选的新产品。单个产品称为<strong class="ma jd"> <em class="mr">项目</em> </strong>、<em class="mr"> </em>而一组项目一起购买称为<strong class="ma jd"> <em class="mr">交易</em> </strong>。一组事务被称为一个<strong class="ma jd"> <em class="mr">数据库</em> </strong>。项目的子集称为一个<strong class="ma jd"> <em class="mr">项目集</em> </strong>。</p><h2 id="cef3" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">它是如何工作的？</h2><p id="3feb" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg lm mh mi mj lq mk ml mm lu mn mo mp mq im bi translated">顾名思义，我们试图根据交易的历史找到类似于<code class="fe ms mt mu mv b">{Milk} -&gt; {Bread}</code>或<code class="fe ms mt mu mv b">{Screwdriver, Screws} -&gt; {Butter}</code>的规则。左手边(LHS)称为<strong class="ma jd"> <em class="mr">前件</em> </strong>，右手边(RHS)称为<strong class="ma jd"> <em class="mr">后件</em> </strong>。这个规则隐含着<strong class="ma jd"><em class="mr"/></strong>而不是<strong class="ma jd"><em class="mr"/></strong>的因果关系。</p><h2 id="3b00" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">我们如何衡量趣味性？</h2><p id="c861" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg lm mh mi mj lq mk ml mm lu mn mo mp mq im bi translated">有几个有趣的衡量标准。我们将基于该数据库来解释它们，其中每行代表一个事务:</p><p id="c357" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated"># 1:{牛奶，面包，糖果}<br/># 2:{牛奶，黄油}<br/># 3:{面包，糖果}<br/># 4:{牛奶，面包}<br/># 5:{牛奶，面包}</p><p id="d07b" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated">我们试图测量这个规则<code class="fe ms mt mu mv b">X -&gt; Y</code>的有趣性，这里X和Y是项目的集合。</p><ul class=""><li id="ef10" class="nb nc it ma b mb mw me mx lm nd lq ne lu nf mq ng nh ni nj bi translated"><strong class="ma jd"> Support: </strong>它是union项集(X U Y)的出现次数除以数据库中的事务总数。它表明<em class="mr">该项目集在数据库中的传播程度。</em><br/>T3】</li><li id="edfd" class="nb nc it ma b mb nk me nl lm nm lq nn lu no mq ng nh ni nj bi translated"><strong class="ma jd">置信度:</strong>用联合项集出现的次数除以LHS出现的次数来度量。换句话说，它是联合项集的支持度，除以LHS集的支持度。它衡量规则被发现为真的频率。 <br/> <code class="fe ms mt mu mv b">Conf({Milk} -&gt; {Bread})= Supp({Milk, Bread})/Supp({Milk} = 0.6/0.8 = 0.75</code></li><li id="283c" class="nb nc it ma b mb nk me nl lm nm lq nn lu no mq ng nh ni nj bi translated"><strong class="ma jd"> Lift: </strong>它是用联合项目集的支持度除以X和y各自的支持度的乘积来度量的。它度量的是<em class="mr">这两个集合相互依赖的程度。提升值1表示独立，提升值&gt; 1给出它们一起出现的程度，提升值&lt; 1给出它们否定彼此存在的程度。<br/> </em> <code class="fe ms mt mu mv b">Lift({Milk} -&gt; {Bread})<br/> = Supp({Milk, Bread})/ ( Supp({Milk}) * Supp({Bread}) )<br/> = 0.6/(0.8 * 0.8) = 0.9375</code></li><li id="d6d1" class="nb nc it ma b mb nk me nl lm nm lq nn lu no mq ng nh ni nj bi translated"><strong class="ma jd">杠杆:</strong>其测量方法与<strong class="ma jd">提升</strong>相同，但不是除以两个单独支撑值的乘积，而是从其联合集的<em class="mr">支撑</em>中减去它们的乘积。该指示与<strong class="ma jd">提升</strong>相同，但它相对于零而不是一。<br/> <code class="fe ms mt mu mv b">Leverage({Milk} -&gt; {Bread})<br/>= Supp({Milk, Bread} — ( Supp({Milk} * Supp({Bread}) )<br/>= 0.6 — (0.8 * 0.8) = -0.04</code></li><li id="8d9f" class="nb nc it ma b mb nk me nl lm nm lq nn lu no mq ng nh ni nj bi translated"><strong class="ma jd">定罪:</strong>用RHS的缺席<code class="fe ms mt mu mv b">1-Supp(Y)</code>除以规则被发现为假的频率<br/> <code class="fe ms mt mu mv b">1-Conf(X-&gt;Y)</code>来衡量。这个衡量<em class="mr">如何</em>如何<em class="mr">频繁的规则会给出一个错误的预测。<br/> </em> <code class="fe ms mt mu mv b">Conv({Milk} -&gt; {Bread})<br/>= (1-Supp({Bread})) / (1-Conf(X-&gt;Y))<br/>= 0.8 / 0.75 = 1.066</code></li></ul><h2 id="5657" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">它有哪些可能的用例？</h2><ul class=""><li id="949a" class="nb nc it ma b mb mc me mf lm np lq nq lu nr mq ng nh ni nj bi translated">你可以解开模式，共现和行为模式。</li><li id="cca6" class="nb nc it ma b mb nk me nl lm nm lq nn lu no mq ng nh ni nj bi translated">向顾客推荐商品。比如:<br/>基于观看历史的电影。<br/>基于订单历史的产品。基于技能和经验的工作。</li><li id="b0b2" class="nb nc it ma b mb nk me nl lm nm lq nn lu no mq ng nh ni nj bi translated">找到新的物品分类方法的能力。</li></ul><h2 id="fb5c" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">整件事怎么做？</h2><p id="0e5b" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg lm mh mi mj lq mk ml mm lu mn mo mp mq im bi ns translated">幸运的是，有些算法会替你尝试规则的所有项目集组合。他们试图通过选择支持的最小阈值或项目的数量来尽可能优化它。Apriori算法是执行ARM的算法的一个例子。还有其他算法也可以做到这一点(FP-growth算法，OPUS Search)，但我们将使用Apriori进行演示。你可以在这里详细了解它<a class="ae ob" href="https://www.youtube.com/watch?v=WGlMlS_Yydk" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="2c15" class="oc le it bd lf od oe of li og oh oi ll ki oj kj lp kl ok km lt ko ol kp lx om bi translated">一个使用电影数据集的例子！</h1><p id="ede0" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg lm mh mi mj lq mk ml mm lu mn mo mp mq im bi translated">本例将使用一个由不同用户评分的电影数据集，评分范围为1-5，5表示最积极。我们试图达到的目的是根据人们喜欢的电影向他们推荐电影。我们将进行一对一的挖掘(一个项目在LHS，一个项目在RHS)。</p><h2 id="089d" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">要求:</h2><ul class=""><li id="9006" class="nb nc it ma b mb mc me mf lm np lq nq lu nr mq ng nh ni nj bi translated">数据集表格；从<a class="ae ob" href="https://drive.google.com/drive/folders/15mWLJIcwlS7Rb2MLtsUvvx5ORJ4XpKDF?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>下载。<br/>一个文件有关于电影的一般数据。<br/>另一个文件具有关于电影的分级数据。</li><li id="c8bb" class="nb nc it ma b mb nk me nl lm nm lq nn lu no mq ng nh ni nj bi translated">一个Python环境，带有:<br/> <code class="fe ms mt mu mv b">pandas==1.0.1<br/></code> <code class="fe ms mt mu mv b">mlxtend==0.17.1</code> <br/>它可能与那些包的其他版本一起工作。</li></ul><h2 id="c217" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">编码:</h2><p id="fa50" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg lm mh mi mj lq mk ml mm lu mn mo mp mq im bi translated">第一步是导入熊猫并加载两个表。然后，我们将创建电影Id和标题之间的映射。当我们用数字代替字符串时，映射将使挖掘更有效。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="7f38" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated">每个表看起来是这样的:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/acfb5b8a30a09ea57f29667abdffc83f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfEZABaCiXawWB3L9X_r_w.png"/></div></div><figcaption class="oq or gj gh gi os ot bd b be z dk translated">电影(左)和分级(右)</figcaption></figure><p id="27fb" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated">现在，就像以前一样，我们想要创建事务(项集)。以前，我们将产品作为单一交易一起购买。在本例中，单个事务是同一用户喜欢的一组电影，因此，在本例中，每个事务将代表一个用户。此外，因为我们希望获得他们喜欢的电影，但不是他们观看的所有电影，所以我们将保留评级为4或5的电影。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="02b2" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated">我们预处理的最后一步是将事务转换成二进制表示(类似于一次性编码)。如果一个项目出现在交易中，那么它被标记为1，否则，它被标记为0。为此，我们使用来自<code class="fe ms mt mu mv b">mlextend.preprocessing</code>的<code class="fe ms mt mu mv b">TransactionEncoder</code>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="24dc" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated">最后，我们将使用<code class="fe ms mt mu mv b">apriori</code>算法来最优地找到项目集的支持值，并使用<code class="fe ms mt mu mv b">association_rules</code>来计算有趣的规则。可以增加<code class="fe ms mt mu mv b">min_support</code>有更可靠的发现。您可以增加<code class="fe ms mt mu mv b">max_len</code>,使每个项目集包含1个以上的项目。此外，您可以将该指标的<code class="fe ms mt mu mv b">metric</code>和<code class="fe ms mt mu mv b">min_threshold</code>更改为您认为符合需求的任何值。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="d807" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated"><code class="fe ms mt mu mv b">rules</code>是一个数据框架，我们可以按<code class="fe ms mt mu mv b">metric</code>(在本例中为<code class="fe ms mt mu mv b">lift</code>)对其进行排序，并显示前10个结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/e2da55312dfbc68353af6b0c86f1955a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NDUlhZQu9BJlbyMfoVO-Zg.png"/></div></div></figure><p id="ffa1" class="pw-post-body-paragraph ly lz it ma b mb mw kd md me mx kg mg lm my mi mj lq mz ml mm lu na mo mp mq im bi translated">正如你所看到的，我们的发现(可以调整)表明，你可以向喜欢<strong class="ma jd">、【虎胆龙威2】、</strong>的人推荐<strong class="ma jd">、【骗子骗子】、</strong>，反之亦然。这是基本的，可以通过更深入地研究指标、阈值和确保事情不是偶然发生的来进一步改进。</p><h2 id="7312" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx iz bi translated">那都是乡亲们！</h2></div></div>    
</body>
</html>