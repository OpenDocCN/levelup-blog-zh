<html>
<head>
<title>Introduction to MongoDB using Python and PyMongo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和PyMongo介绍MongoDB</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/introduction-to-mongodb-using-python-and-pymongo-87797bbd5ad3?source=collection_archive---------10-----------------------#2020-12-19">https://levelup.gitconnected.com/introduction-to-mongodb-using-python-and-pymongo-87797bbd5ad3?source=collection_archive---------10-----------------------#2020-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ff9c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在本教程中，我们将讨论如何使用Python，特别是PyMongo来处理NoSQL数据库MongoDB。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7cf4f7f2a0338044e6b3973f5f76656d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZ1pGNvs8A8ne4WICoR8cA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="0f62" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">目录</strong></p><ul class=""><li id="48de" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">介绍</li><li id="8061" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建一个MongoDB帐户和集群</li><li id="0440" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">为Python应用程序创建到MongoDB数据库的连接</li><li id="b9fb" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用Python连接到MongoDB数据库</li><li id="b8c1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用Python从MongoDB获取文档</li><li id="aa28" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用Python更新MongoDB中的文档</li><li id="55ec" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用Python将文档插入MongoDB</li><li id="1b4f" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">结论</li></ul></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="6f25" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">介绍</h1><p id="c7a9" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">MongoDB是该领域中最流行的NoSQL数据库之一。与使用SQL的标准关系数据库不同，MongoDB有一个非关系模型，使用类似JSON的结构将数据存储为文档。</p><p id="3014" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">MongoDB有各种好处，包括高可伸缩性，允许存储任何类型的数据，高灵活性，以及存储多层信息，而不必在模式和数据库设计上做很多工作。</p><p id="3b99" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">MongoDB允许多种连接数据库的方式。因为我们在教程中主要使用Python，所以我们将利用<a class="ae nm" href="https://pymongo.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> PyMongo库</a>。那么PyMongo是什么？PyMongo是一个Python发行版，包含使用Python中的MongoDB的工具。</p><p id="3d70" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了继续完成本教程的技术部分，我们需要安装pymongo和pprint库。</p><p id="42a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您没有安装它，请打开“命令提示符”(在Windows上)并使用以下代码安装它:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="02f0" class="ns mq it no b gy nt nu l nv nw">pip install pymongo<br/>pip install pprint</span></pre></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="5dff" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">创建一个MongoDB帐户和集群</h1><p id="8de2" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">首先，我们需要创建一个MongoDB帐户并配置我们的第一个集群。它非常简单，MongoDB网站是设置初始工作空间的最用户友好的平台之一。</p><p id="9a25" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">进入<a class="ae nm" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB账户创建页面</a>，完成简单注册。您可以选择通过填写信息进行注册，也可以直接在Google上注册:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/21a7e9595c8b78198bf53b994b6c4b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/0*td0TnmWDRM4ePOim"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="b67f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注册后的下一步是填写一些关于您的组织、项目的信息，并选择首选的编程语言。我填了我的如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/bb818176fd8305c68367bd0d9fa9d9a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*Rk_SLaF8yOhHXZT4"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="360a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下一页中，您可以选择帐户的等级。我们只需继续进入“共享集群”，然后单击“<strong class="la iu">创建集群</strong>”。</p><p id="b8c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下一页，您将看到云提供商和区域选项，以及集群层、一些设置和集群名称。我们可以将它们都保留为默认值:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/9cdefb9d678d6c8a6b1206dc9f786b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gIVrtgdTHZqcUDnq"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="88b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">并点击“<strong class="la iu">创建集群</strong>”。</p><p id="8323" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，您将被重定向到项目的主页，创建一个集群需要几分钟时间。</p><p id="9b28" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">设置好一切后，您的屏幕应该显示以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/724fc5584460956e58961729ec5b8c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rxODJkcTV760WWcR"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="0d5a" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">创建一个MongoDB数据库</h1><p id="84cf" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">我们刚刚创建的集群是空的。让我们创建一个测试数据库，并在教程的后面利用它。</p><p id="3d36" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在群集页面中，单击带有群集名称的绿点正下方的“<strong class="la iu">集合</strong>”气泡。它应该带你到这里:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/980b59d3c00a4002a76205f835e3c97a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PwQD2m9Jt86HyXAe"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="a8d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所看到的，我们的集群中还没有数据。</p><p id="f9cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有两个选项，您可以加载一些示例数据，或者创建自己的数据。</p><p id="8902" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于本教程，让我们加载一个样本数据集。只需点击“<strong class="la iu">加载样本数据集</strong>并继续。加载前需要几分钟时间。然后您可以刷新页面，您将看到一些数据库出现在集群上。</p><p id="40a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">位于集群顶部的第一个数据库是“<strong class="la iu"> sample_airbnb </strong>”，在该数据库中，将有一个名为“<strong class="la iu"> listingsAndReviews </strong>”的集合。</p><p id="4386" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">单击该集合，查看一些存储的示例文档。这些记录包含一些Airbnb房产的信息，比如:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/25b68f8546c9b69fc993581d65282cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/0*wmETk6KJp5A5d1rU"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="eb4b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:MongoDB的工作方式是将数据记录存储为文档，文档被分组在一起并存储在集合中。一个数据库可以有多个集合。</p><p id="3b32" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">至此，我们已经创建了一个MongoDB集群，并向其中添加了一些样本数据。下一步是使用Python连接到MongoDB数据库。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="be1d" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">为Python应用程序创建到MongoDB数据库的连接</h1><p id="9502" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">既然我们的集群已经创建，我们希望建立到它的连接并处理数据。</p><p id="e2a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们回到我们的主群集页面:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/5aa77120b7ce70e6c890faf2eabec196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QJyvaZY5bHmLr2OE"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/dfbc39baf9f1d524d8128d96e5600656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9jm6NfHCFbhTcBt8"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="e748" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们能够连接到我们的数据库之前的一个步骤是创建用户安全许可，这包括:添加您的IP地址和创建一个数据库用户。</p><ul class=""><li id="5f92" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">首先，只需点击“<strong class="la iu">添加您当前的IP地址</strong>，一个标签将显示您的IP地址，然后点击“<strong class="la iu">添加IP地址</strong>”。</li><li id="8763" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">然后，填写您的数据库用户信息(我选择我的用户名为<strong class="la iu">用户</strong>，密码为<strong class="la iu">测试</strong>，点击<strong class="la iu">创建数据库用户</strong>)。</li><li id="6ed0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">填写完所有这些信息后，您会注意到右下角的“<strong class="la iu">选择连接方式</strong>”按钮变成了绿色。我们可以继续了，继续点击它。</li></ul><p id="0878" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个菜单将询问我们将使用什么类型的连接方法:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/5503ea328d0ec409fc6574b97daa4d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EFEPkvs_3vSCD7li"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="c3ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于我们将使用Python和PyMongo，我们选择“<strong class="la iu">连接您的应用程序</strong>”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/8515ba856046074f1882edd7d5c56ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OIzDFAwajW6vMa0b"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="e64c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在此选项卡中，我们选择Python作为“驱动程序”，您已安装的Python版本作为“版本”。</p><p id="7d86" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在连接字符串将被创建，我们需要复制它。我的看起来像这样:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="1f74" class="ns mq it no b gy nt nu l nv nw">mongodb+srv://user:&lt;password&gt;@cluster0.x7elx.mongodb.net/&lt;dbname&gt;?retryWrites=true&amp;w=majority</span></pre><p id="7128" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完美。因此，连接字符串已经准备好，我们完成了从web浏览器端需要做的一切。教程的其余部分将在IDE中。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="b1aa" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">使用Python连接到MongoDB数据库</h1><p id="af1f" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">此时，我们将开始利用Python来访问MongoDB数据库。</p><p id="2de5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，让我们建立到集群的连接:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="f982" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，我重新安排了上一节中的连接字符串，将之前定义的<strong class="la iu">用户</strong>和<strong class="la iu">密码</strong>作为字符串传递。</p><p id="2d3a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果代码没有给出任何错误，那么我们是连接的。我们还可以通过打印出存储在集群中的数据库列表来仔细检查这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="5e46" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据我们得到的测试数据:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5863" class="ns mq it no b gy nt nu l nv nw">['sample_airbnb', 'sample_analytics', 'sample_geospatial', 'sample_mflix', 'sample_restaurants', 'sample_supplies', 'sample_training', 'sample_weatherdata', 'admin', 'local']</span></pre><p id="1dfc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了继续本教程的下一部分，我们需要连接到数据库，然后连接到数据库中的一个集合。</p><p id="1299" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">回想一下之前，我们想要使用的数据库是<strong class="la iu">‘sample _ Airbnb’</strong>，我们想要使用的集合是<strong class="la iu">‘listingsAndReviews’</strong>。</p><p id="bf76" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以我们继续用Python定义它们:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="6dcc" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">使用Python从MongoDB获取文档</h1><p id="8f25" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">本节将主要关注如何使用Python和各种类型的数据查询从MongoDB中检索数据。</p><p id="f0bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“listingsAndReviews”集合中有多个条目，作为工作示例，我们将使用以下条目:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/43a60200ba6280bcc05e70010f06683e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/0*0A-ol1YZxFSjzu3i"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="7829" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">从MongoDB中检索单个文档</h1><p id="9127" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">这是最基本的查询类型之一，只检索一个与给定查询参数匹配的文档。</p><p id="c877" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可以通过使用<strong class="la iu">来完成。find_one() </strong>方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="3385" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">样本输出预览:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="ecb7" class="ns mq it no b gy nt nu l nv nw">{'_id': '10006546',<br/> 'accommodates': 8,<br/> 'address': {'country': 'Portugal',<br/>             'country_code': 'PT',<br/>             'government_area': 'Cedofeita, Ildefonso, Sé, Miragaia, Nicolau, Vitória',<br/>             'location': {'coordinates': [-8.61308, 41.1413],<br/>                          'is_location_exact': False,<br/>                          'type': 'Point'},<br/>             'market': 'Porto',<br/>             'street': 'Porto, Porto, Portugal',<br/>             'suburb': ''},<br/> 'amenities': ['TV',<br/>               'Cable TV',<br/>               'Wifi',<br/>               'Kitchen',<br/>               'Paid parking off premises',<br/>               'Smoking allowed',<br/>               'Pets allowed',<br/>               'Buzzer/wireless intercom',<br/>               'Heating',<br/>               'Family/kid friendly',<br/>               'Washer',<br/>               'First aid kit',<br/>               'Fire extinguisher',<br/>               'Essentials',<br/>               'Hangers',<br/>               'Hair dryer',<br/>               'Iron',<br/>               'Pack ’n Play/travel crib',<br/>               'Room-darkening shades',<br/>               'Hot water',<br/>               'Bed linens',<br/>               'Extra pillows and blankets',<br/>               'Microwave',<br/>               'Coffee maker',<br/>               'Refrigerator',<br/>               'Dishwasher',<br/>               'Dishes and silverware',<br/>               'Cooking basics',<br/>               'Oven',<br/>               'Stove',<br/>               'Cleaning before checkout',<br/>               'Waterfront'],<br/> 'availability': {'availability_30': 28,<br/>                  'availability_365': 239,<br/>                  'availability_60': 47,<br/>                  'availability_90': 74},<br/> 'bathrooms': Decimal128('1.0'),<br/> 'bed_type': 'Real Bed',<br/> 'bedrooms': 3,<br/> 'beds': 5}</span></pre><p id="7aed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您会注意到，即使没有任何给定的参数，这段代码也会工作，它会找到集合中的第一个文档并检索它(我没有添加输出，因为它是一个很长的文档)。</p><p id="8568" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，如果我们想要一个特定的文档，而不是第一个文档呢？我们应该给这个方法提供一些搜索参数，信息就会被检索出来。例如，我们想要查找ID = '10009999 '的列表。</p><p id="084e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">搜索参数应添加到<strong class="la iu">。字典格式的find_one() </strong>方法(键值对):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="5cbb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该查询的输出将打印出不同的文档。</p><p id="fbc7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">样本输出预览:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c76f" class="ns mq it no b gy nt nu l nv nw">{'_id': '10009999',<br/> 'access': '',<br/> 'accommodates': 4,<br/> 'address': {'country': 'Brazil',<br/>             'country_code': 'BR',<br/>             'government_area': 'Jardim Botânico',<br/>             'location': {'coordinates': [-43.23074991429229,<br/>                                          -22.966253551739655],<br/>                          'is_location_exact': True,<br/>                          'type': 'Point'},<br/>             'market': 'Rio De Janeiro',<br/>             'street': 'Rio de Janeiro, Rio de Janeiro, Brazil',<br/>             'suburb': 'Jardim Botânico'},<br/> 'amenities': ['Wifi',<br/>               'Wheelchair accessible',<br/>               'Kitchen',<br/>               'Free parking on premises',<br/>               'Smoking allowed',<br/>               'Hot tub',<br/>               'Buzzer/wireless intercom',<br/>               'Family/kid friendly',<br/>               'Washer',<br/>               'First aid kit',<br/>               'Essentials',<br/>               'Hangers',<br/>               'Hair dryer',<br/>               'Iron',<br/>               'Laptop friendly workspace'],<br/> 'availability': {'availability_30': 0,<br/>                  'availability_365': 0,<br/>                  'availability_60': 0,<br/>                  'availability_90': 0},<br/> 'bathrooms': Decimal128('1.0'),<br/> 'bed_type': 'Real Bed',<br/> 'bedrooms': 1,<br/> 'beds': 2}</span></pre><p id="d094" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用上面的代码，您可以通过文档中存在的任何键-值对来查询单个记录。例如，您可能希望提取一条记录，其中该酒店可容纳5个人:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="0786" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您将看到的输出是一个不同的属性。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="be96" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">从MongoDB中检索多个文档</h1><p id="e878" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">当您想要访问多个满足搜索条件的文档时，您很可能会遇到这种情况。</p><p id="43b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们将使用<strong class="la iu">。find() </strong>方法，因为我们试图检索多个文档。值得注意的是，输出将是一个包含多个属性的对象，要打印每个属性，我们需要循环遍历它。</p><p id="bdce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，您可能正在查找一个属性列表，这些属性:</p><ul class=""><li id="4733" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">容纳5人</li><li id="30a3" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">有三间卧室</li><li id="6a26" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">财产类型是房子</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="2091" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该会看到符合您的标准的大量属性的打印输出。</p><p id="88da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本节将主要关注如何在MongoDB中更新记录。</p><p id="34f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以使用<strong class="la iu">更新存储在MongoDB中的任何记录或文档。来自PyMongo库的update_one() </strong>。</p><p id="8308" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它需要两个参数:<strong class="la iu">。更新_一(过滤，更新)</strong>:</p><ul class=""><li id="70a5" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">过滤器:帮助我们识别要更新的特定记录的查询</li><li id="2191" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">更新:包含要应用的更改的查询</li></ul><p id="a6db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，让我们使用与上一节相同的记录(ID = '10009999 ')。如果你打印出它的内容，你会看到这个属性容纳4人(“容纳”:4)。</p><p id="d66e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们希望更改该数据，以显示该酒店可容纳6人。让我们来看看怎么做:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="22c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，查询的“update”部分有一个带有“$set”操作符的特定格式，因为它需要传递给MongoDB以显示我们正在更新当前记录。</p><p id="a64f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要查看发生的更改，只需检索该记录并将其打印出来:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="fade" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，更新方法还有更多的内容，参数越多就越复杂。在这里，我们看一些基本的例子来帮助你理解流程和过程。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="7932" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">使用Python将文档插入MongoDB</h1><p id="156d" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">到目前为止，我们学习了如何检索记录(或文档)以及如何更新它们。一个自然的问题是，我如何向MongoDB添加新条目？</p><p id="1895" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们想在AirBnB目录中添加一个新的酒店。此列表包含以下信息:它可容纳2人，有一间带两张床的卧室。</p><p id="1790" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">回想一下，MongoDB中的数据存储在JSON风格的文档中，所以我们的第一步是创建一个Python字典来表示我们的条目:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="7893" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，MongoDB中的每个文档都有一个惟一的“_id”键。这是一个特殊的键，除非指定，否则会自动添加。它在整个集合中必须是唯一的。</p><p id="202c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">没有必要添加它，因为它是自动生成的，但是对于我们来说，如果我们已经知道它的ID，检索记录将会更容易。因此，让我们为新文档添加一些ID(我选择了一个大的数字，只是为了确保它是唯一的，并且没有被其他记录使用):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="a23c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要使用PyMongo库将这个文档添加到MongoDB，我们需要使用<strong class="la iu">。insert_one() </strong>方法，并简单地将新定义的文档作为参数传递给它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="81a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">太好了！新文档已添加到我们的收藏中。让我们来看看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="5fac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们看到了我们添加的内容:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="765d" class="ns mq it no b gy nt nu l nv nw">{'_id': '9999999', 'accommodates': 2, 'bedrooms': 1, 'beds': 2}</span></pre></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="1a37" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">结论</h1><p id="8ed8" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">在本教程中，我们探讨了如何使用Python和PyMongo库来运行MongoDB。</p><p id="1d8c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于希望了解更多关于MongoDB的知识并深入了解该主题的人来说，这里展示的例子是一个很好的起点。</p><p id="caf9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我也鼓励你看看我在<a class="ae nm" href="https://pyshark.com/category/python-programming/" rel="noopener ugc nofollow" target="_blank"> Python编程</a>上的其他帖子。</p><p id="ad06" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你有任何问题或者对编辑有任何建议，请在下面留下你的评论。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="4c95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="oh">原载于2020年12月19日</em><a class="ae nm" href="https://pyshark.com/introduction-to-mongodb-using-python-and-pymongo/" rel="noopener ugc nofollow" target="_blank"><em class="oh">【https://pyshark.com】</em></a><em class="oh">。</em></p></div></div>    
</body>
</html>