<html>
<head>
<title>Lambda Cold Starts, A Language Comparison 🕵 ❄️ (2018)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">拉姆达冷启动，语言对比🕵 ❄️ (2018)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/lambda-cold-starts-language-comparison-%EF%B8%8F-a4f4b5f16a62?source=collection_archive---------0-----------------------#2018-04-19">https://levelup.gitconnected.com/lambda-cold-starts-language-comparison-%EF%B8%8F-a4f4b5f16a62?source=collection_archive---------0-----------------------#2018-04-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c1521ac8649414fe972a339a47396dae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5w6s7IPjB6BlwNXSrNMtA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/photos/-87JyMb9ZfU?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">约书亚·厄尔</a>在<a class="ae kc" href="https://unsplash.com/search/photos/comparison?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="73e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">自从写了这篇文章我还写了</em> <a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/aws-lambda-cold-start-language-comparisons-2019-edition-️-1946d32a0244"> <em class="lb">一篇2019更新</em> </a> <em class="lb">！</em></p><p id="53a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">走向无服务器比以往任何时候都更有利可图，但无服务器的警告总是越来越多。避免冷启动是拥有敏捷用户体验的一个重要部分，选择一种语言来帮助你实现这一点很重要！</p><h2 id="9d37" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">冷启动？</h2><p id="2977" class="pw-post-body-paragraph kd ke iq kf b kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">在无服务器世界中的“冷启动”,是在某个设定的时间段内第一次有请求要求执行您的代码。因为你在一个没有服务器的世界里，不需要为服务器时间付费，你的函数或“lambda代码”只在每个请求的基础上执行。</p><p id="13da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但事实并非如此，事实上你的lambda函数实际上是为你部署到一个容器中的，并且有一定的生存时间。虽然此代码是“活动的”,但它不需要重新初始化，并且响应速度快得多，因此被认为是“热的”。这是无服务器的，AWS处理管理服务器、容器和扩展的抽象。通常你的代码有30-45分钟的寿命！</p><p id="8c8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是完全相同的lambda函数运行两次的请求跟踪。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/a5ea3e69d85d61bf9a8f9e3ac51e8001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVcCUE5NlQhJSLN_SCiCxg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">请求跟踪从自动气象站X射线捕获的“冷”启动</figcaption></figure><p id="51a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在跟踪中看到，在外部函数<code class="fe mf mg mh mi b">AWS::Lambda</code>将代码移交给我的函数代码<code class="fe mf mg mh mi b">AWS::Lambda::Function</code>之前，大约需要650ms，除此之外，还需要一段初始化时间。这就是我们所说的冷启动！</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/ad2eb367e03e49202a6027ea2b8b5435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__bmBk2VCpzmGF1X1x9PPQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">请求跟踪“热”lambda函数</figcaption></figure><p id="0239" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“冷”功能比“热”功能慢50倍以上。更重要的是，这些是简单地返回“hello world”的测试函数，具有依赖性或实际执行有用计算的函数可能更糟。</p><h2 id="ac23" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated"><strong class="ak">方法论</strong></h2><p id="6d61" class="pw-post-body-paragraph kd ke iq kf b kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">我决定测试所有最新的语言，Nodejs8，c#.net2，Java8，Go1.x &amp; Python3。我从控制台创建了每个lambda函数，保留了默认的“hello world”日志。我分别使用了128mb、1024mb和3008mb的内存。然后我创建了三个<a class="ae kc" href="https://aws.amazon.com/step-functions/" rel="noopener ugc nofollow" target="_blank">步骤函数</a>来触发每个内存组的所有作业，并配置了一个cloudwatch调度来每小时触发一次。我每隔至少7个小时回到<a class="ae kc" href="https://aws.amazon.com/xray/" rel="noopener ugc nofollow" target="_blank"> AWS X射线</a>，记录它在过去6个小时观察到的平均值。</p><h2 id="2c22" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated"><strong class="ak">结果</strong></h2><blockquote class="mk ml mm"><p id="45ef" class="kd ke lb kf b kg kh ki kj kk kl km kn mn kp kq kr mo kt ku kv mp kx ky kz la ij bi translated">内存分割在这里很重要，因为分配给lambda函数的内存增加，所以它的<a class="ae kc" href="https://forums.aws.amazon.com/message.jspa?messageID=588722" rel="noopener ugc nofollow" target="_blank"> CPU时间也线性增加。</a></p></blockquote><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/0c8a547e0a5bb8f299329e831c699dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucO5VGFTt2ZYqrWHTAC0KQ.png"/></div></div></figure><p id="ef09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很明显，python是这里最强的玩家，它以128mb的内存在各个领域击败了大多数语言。</p><p id="f1d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">迁移到1024mb内存使golang、nodejs &amp; java减少了25%，而python和。净利润下降了30%。与128mb的基数相比，3008mb在python、go、node和java中减少了约42–45 %,而node仅减少了37%。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/08a915292809d6a7567686cb78aea6de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3W_RhHq2kQLIlnT58sPF3A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Lambda的语言时间轴</figcaption></figure><p id="0289" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我很惊讶地看到golang的冷启动时间，与nodejs相似。我的最佳猜测是平台上的语言成熟度开始发挥作用。由于它最近于2018年1月发布，你可以推测会看到更多的改进。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/5bc082b946cb22dadeb9a78368891400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CFAFCP69fiU9NiKpyOQSew.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">并列比较</figcaption></figure><h2 id="3afb" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated"><strong class="ak">关于定价的一句话</strong></h2><p id="69a7" class="pw-post-body-paragraph kd ke iq kf b kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">Lambda的定价完全在GB/s左右，所以它是运行时间和资源最小化的平衡。</p><p id="5227" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以<strong class="kf ir"> 70 rps </strong>或<strong class="kf ir">每天100，000 </strong>次，或<strong class="kf ir">每月300万</strong>个请求运行lambda函数，平均每个请求运行<strong class="kf ir"> 0.5 </strong>秒。等同于:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/463dfa1d67e7095cb0fbdf71e24e3180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*00kxQV6nu2gOCfQFgMiAeA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">AWS定价是线性的。1024比128贵8倍。3008比128贵24倍。</figcaption></figure><p id="e8d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对此要有所保留，因为根据您的工作负载增加内存和可用CPU，可以显著减少运行时间。正如吉姆·康宁雄辩地说的那样<a class="ae kc" href="https://medium.com/@jconning/aws-lambda-faster-is-cheaper-6bf32f58d741" rel="noopener">‘越快越便宜’</a>！</p><h2 id="45b0" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">现实世界</h2><p id="4b20" class="pw-post-body-paragraph kd ke iq kf b kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">用lambda函数构建时，冷启动是一个关键考虑因素的真实例子。下面是我在<a class="ae kc" href="https://medium.com/@nathan.malishev/going-serverless-on-aws-b6d78b43e691" rel="noopener">上一篇博文</a>中的<a class="ae kc" href="http://accents.nathanmalishev.com" rel="noopener ugc nofollow" target="_blank">演示</a>，在那里我使用配置了512mb的nodejs函数构建了一个无服务器应用。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/1a7a9b6d53056dc081c28ef886420704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*enBq6PAgINnwMn8GA8y_eg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">真实世界“冷”请求跟踪</figcaption></figure><p id="722a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">冷请求需要1.8秒，而热请求需要281毫秒，增加了6倍。想象一下，让你的服务在lambda函数上高度分解，等待2-3秒的响应并不好玩。幸好<a class="mu mv ep" href="https://medium.com/u/d00f1e6b06a2?source=post_page-----a4f4b5f16a62--------------------------------" rel="noopener" target="_blank">崔琰</a>有一篇<a class="ae kc" href="https://hackernoon.com/im-afraid-you-re-thinking-about-aws-lambda-cold-starts-all-wrong-7d907f278a4f" rel="noopener ugc nofollow" target="_blank">关于暖lambda功能的大文章</a>。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/338642b4c4588b4571f5e8eb368dc9f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MvEDEOD4Zdhi7Q_YMXU2Kg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">真实世界“热”请求跟踪</figcaption></figure><p id="35d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读我的文章，如果你喜欢它，请一定要鼓掌！</p><h2 id="52e9" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">参考</h2><div class="my mz gp gr na nb"><a href="https://blog.newrelic.com/2017/06/20/lambda-functions-xray-traces-custom-serverless-metrics/" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">如何使用AWS Lambda提高无服务器性能</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">自从我们上一次在Amazon Web Services Lambda上发布帖子以来，无服务器计算服务的使用持续增长…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">blog.newrelic.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np jw nb"/></div></div></a></div><div class="my mz gp gr na nb"><a href="https://medium.com/@jconning/aws-lambda-faster-is-cheaper-6bf32f58d741" rel="noopener follow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">AWS Lambda:更快更便宜</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">随着CPU能力的提高，CPU相关的功能执行速度更快，成本更低</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">medium.com</p></div></div><div class="nk l"><div class="nq l nm nn no nk np jw nb"/></div></div></a></div><div class="my mz gp gr na nb"><a href="https://hackernoon.com/im-afraid-you-re-thinking-about-aws-lambda-cold-starts-all-wrong-7d907f278a4f" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">恐怕你对AWS Lambda冷启动的想法完全错了</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">当我在API Gateway的上下文中与人们讨论AWS Lambda冷启动时，我经常得到这样的回答…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">hackernoon.com</p></div></div><div class="nk l"><div class="nr l nm nn no nk np jw nb"/></div></div></a></div></div></div>    
</body>
</html>