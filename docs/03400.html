<html>
<head>
<title>GraphQL or No-GraphQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GraphQL或无GraphQL</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/graphql-or-no-graphql-395c80edc3d?source=collection_archive---------6-----------------------#2020-05-06">https://levelup.gitconnected.com/graphql-or-no-graphql-395c80edc3d?source=collection_archive---------6-----------------------#2020-05-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/653484eaff1e3f7da0072e4242b8d5bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aEP2TAYO1gjMRRO3.png"/></div></div></figure><p id="d515" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在过去的几个月里，我一直致力于REST API性能的改进。这个API不拥有任何数据库，基本上依赖于其他服务来为它提供所需的信息。因此，我们必须探索尽可能快地处理或收集信息的方法。</p><p id="9546" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这个分析过程中，我探索了GraphQL帮助我们完成任务的可能性。有很多关于GraphQL解决所有问题的流行词，但我不想仅仅因为它如此流行和受欢迎就接受它。所以我围绕它做了一些研究和原型制作，并将其与我的rest端点实现进行了比较，以找出一些优缺点。</p><h1 id="f9bb" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">为什么选择GraphQL </strong></h1><h2 id="a5a9" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">赋予客户更多权力</strong></h2><p id="5a1e" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">这是GraphQL最重要的好处，客户端或前端可以完全控制数据需求。GraphQL允许客户端请求数据，而不是后端将数据推送到客户端。因此，服务器将只处理需要的内容，并且只返回需要的内容。它节省了CPU，网络呼叫，网络带宽。</p><p id="d4ea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，我正在开发的permission API对于每个视图都有不同的权限集。根据视图的复杂程度，权限从1到10不等。所以GraphQL完全符合这里的要求。而不是服务器评估所有的权限，并让用户从中选择。GQL将允许查看者请求它所需要的任何权限，服务器将只评估和提供那些权限。超过50%的视图是简单的，所以它们会变得更快。</p><h2 id="6e71" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">降低Rest端点爆炸/复杂性</strong></h2><p id="db57" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">处理上述场景的另一种方式是基于每个视图提供多个端点。或者，您可以向客户端提供过滤器，以便在查询参数中传递权限名称。老实说，我不喜欢在API中实现这些条件检查，在我看到这个之后，你可以在GraphQL中得到它，因为它使你的代码有条件和混乱。</p><h2 id="78f6" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">模式让你的领域模型非常清晰</strong></h2><p id="3479" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">当您创建一个GraphQL模式时，您需要在实体之间建立一个非常清晰的关系，因为您需要遍历这个图。而在rest API中，将所有东西放在同一个API中是如此容易。我见过很多API里面有不合适的东西，为了节省客户的额外调用。很难从API中理解它。GraphQL模式让客户很清楚在哪里可以找到他们想要的东西。</p><h2 id="8728" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">共享模式可以帮助大家</strong></h2><p id="b105" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">多少次我们努力寻找为我们提供所有正确数据的端点。可能一直都是。使用GraphQL模式，任何人都可以很容易地查看模式并弄清楚它。</p><h2 id="f240" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">启用并行处理</strong></h2><p id="de7f" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">在GraphQL中，每个类型/字段都有一个获取数据的提供者。同一级别的字段可以并行提取。例如，如果一个用户对象和您想要获取他们的工作细节和健康历史，GraphQL可以并行执行数据获取器来优化它。在我的例子中，我必须提取十个权限，我可以通过我自己的线程执行器来完成，但是使用GraphQL，它是现成的。</p><h1 id="6d0b" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">为什么没有-GRAPHQL</h1><h2 id="8eda" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">剩余端点是简单的积垢</strong></h2><p id="9b71" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">REST端点非常简单。例如，通过Id获取用户，而不需要过滤数据。那么GQL可能是一个负担，因为rest APIs启动和运行起来更快。当您的客户需要多种形状的数据时，GraphQL非常有用。</p><h2 id="af2e" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">失败的影响很大。</strong></h2><p id="d809" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">随着越来越多的人开始使用GraphQL，schema会扩展以便人们可以轻松地找到数据是非常自然的。有这么多人在一个模式下工作，任何一个人的改变都会影响到很多其他人。</p><p id="940a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您需要非常小心使用GraphQL。对于REST API，只有API和它的最终用户会受到影响。</p><h2 id="4e3d" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated"><strong class="ak">复杂到处理性能为n+1的情况。</strong></h2><p id="7f38" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">使用GraphQL，如果您需要查找关于记录列表或记录集合的信息，那么处理它就变得很棘手。例如，如果您需要用户列表及其地址的详细信息，那么它将执行n+1个查询。一个用于用户列表，然后n个查询用于每个用户的地址。</p><blockquote class="mo mp mq"><p id="996e" class="kb kc mr kd b ke kf kg kh ki kj kk kl ms kn ko kp mt kr ks kt mu kv kw kx ky im bi translated">现在，它可能会严重影响性能，因此必须小心处理。</p></blockquote><h2 id="c0a1" class="lx la it bd lb ly lz dn lf ma mb dp lj km mc md ln kq me mf lr ku mg mh lv mi bi translated">绝对控制你做什么和你如何做事</h2><p id="9118" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">虽然GraphQL为您提供了许多我们在上面看到的现成的东西，但是使用REST API，您确实可以对请求的处理进行更多的控制。无论是批量数据库请求、并行化、利用线程局部变量，Rest API都更易于管理。</p><h1 id="ef86" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">摘要</h1><p id="a1ba" class="pw-post-body-paragraph kb kc it kd b ke mj kg kh ki mk kk kl km ml ko kp kq mm ks kt ku mn kw kx ky im bi translated">我认为随着现代应用程序的复杂性和需求，GraphQL的使用为后端和前端的开发人员提供了相当大的灵活性。虽然学习和开始使用GraphQL可能需要一点时间，但这似乎是值得的。</p><p id="1403" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi">.</p></div></div>    
</body>
</html>