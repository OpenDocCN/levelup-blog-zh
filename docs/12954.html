<html>
<head>
<title>Automate and Keep Your Code Consistent Using ESLint, Prettier, Lint-Staged, and Husky</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ESLint、Prettier、Lint-Staged和Husky自动化并保持代码的一致性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/automate-and-keep-your-code-consistent-using-eslint-prettier-lint-staged-and-husky-3e186977d7eb?source=collection_archive---------5-----------------------#2022-07-26">https://levelup.gitconnected.com/automate-and-keep-your-code-consistent-using-eslint-prettier-lint-staged-and-husky-3e186977d7eb?source=collection_archive---------5-----------------------#2022-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0443" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你的代码在不同的开发者之间是一致的吗？您总是在提交之前手动修复lint错误和格式问题吗？如果是这样，这篇文章是给你的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7406d3be48fe0e0e49ed9825efecc46b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSJJ1cKQFods5dQwI67D1w.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">布莱克·康纳利在<a class="ae ky" href="https://unsplash.com/s/photos/code-formatting?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="5079" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当与几个程序员一起工作时，代码风格从不保持一致，并且总是很难保持一致的可读和可维护的代码。</p><p id="7a85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，有一种简单的方法可以通过使用linter来改进您的代码库，它不仅可以改进代码，还可以使整个团队的代码统一起来。在linter的帮助下，来自多个开发人员的不同编码风格融合在一起，最终的代码变得可读和可维护。</p><p id="3baa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将使用<a class="ae ky" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> ESLint </strong> </a>、<a class="ae ky" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">appetter</strong></a>、<a class="ae ky" href="https://typicode.github.io/husky/#/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Husky </strong> </a>和<a class="ae ky" href="https://github.com/okonet/lint-staged" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Lint-Staged </strong> </a>来自动化该过程，以确保代码被格式化并修复诸如语法错误之类的编程错误。</p><blockquote class="lv lw lx"><p id="b74e" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">注:</strong>我在一个名为“<a class="ae ky" href="https://commitizen-tools.github.io/commitizen/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Commitzen </strong> </a>”的团队工作时，发现还有一个工具很有用，它用于定义一种为提交消息设置规则的标准化方式，但这个工具是另一天用的。</p></blockquote><p id="bc60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候深入研究在您的下一个应用程序中安装和使用它们所需的包了。</p><h2 id="3282" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">1.必需的软件包安装</h2><p id="e38f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">首先我们需要安装所有需要的软件包，它们是:</p><ul class=""><li id="13c8" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><strong class="lb iu"> ESLint — </strong>是一个解析器，用于检查代码并报告bug、编码错误或打字错误。</li><li id="16e5" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><strong class="lb iu">更漂亮— </strong>是一个根据配置格式化代码的工具，我们稍后会看到。</li><li id="9ab9" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><strong class="lb iu"> Lint-Staged — </strong>用于运行linter到staged git文件，防止提交错误代码。</li><li id="537f" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><strong class="lb iu"> Husky — </strong>是一个与Git挂钩(如预提交、提交消息、后提交等)协同工作的工具。</li></ul><p id="a0e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您使用的是<code class="fe no np nq nr b">npm</code>包管理器，安装所有四个包需要运行的命令应该是这样的:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="69c6" class="mc md it nr b gy nw nx l ny nz">npm install --save-dev eslint prettier lint-staged husky</span></pre><h2 id="bdc5" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">2.<strong class="ak"> ESLint配置</strong></h2><p id="415d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">现在让我们配置已安装的包，从ESLint开始。用于初始化ESLint的命令将是:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="f62a" class="mc md it nr b gy nw nx l ny nz">npx eslint --init</span></pre><p id="bf75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将出现下面的屏幕，您需要根据自己的需要回答几个问题，配置将被相应地保存。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/d30d573e40b1603e75ccb03a59137a70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrk3Rx-vKFd0LZOvOO1tRw.png"/></div></div></figure><p id="e0f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">配置文件类似于下面的内容:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="d6eb" class="mc md it nr b gy nw nx l ny nz">{<br/>    "env": {<br/>        "browser": true,<br/>        "es2021": true<br/>    },<br/>    "extends": [<br/>        "plugin:react/recommended",<br/>        "standard"<br/>    ],<br/>    "parserOptions": {<br/>        "ecmaFeatures": {<br/>            "jsx": true<br/>        },<br/>        "ecmaVersion": "latest"<br/>    },<br/>    "plugins": [<br/>        "react"<br/>    ],<br/>    "rules": {<br/>    }<br/>}</span></pre><p id="17ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以创建一个名为<code class="fe no np nq nr b">.eslintrc.json</code>的文件，粘贴上面的配置，而不是运行<code class="fe no np nq nr b">npx</code>命令，并检查整个问题列表。</p><p id="9dae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">详细阅读关于ESLint规则的更多信息，然后查看<a class="ae ky" href="https://eslint.org/docs/latest/rules/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> ESLint规则文档</strong> </a> <strong class="lb iu">。</strong></p><h2 id="f5f8" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">3.漂亮的配置</h2><p id="5224" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">为了配置得更漂亮，您需要在应用程序的根文件夹中创建一个<code class="fe no np nq nr b">.prettierrc.json</code>文件，并粘贴以下配置:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="8f48" class="mc md it nr b gy nw nx l ny nz">{<br/>  "bracketSpacing": true,<br/>  "semi": true,<br/>  "singleQuote": true,<br/>  "trailingComma": "all",<br/>  "printWidth": 80,<br/>  "tabWidth": 2<br/>}</span></pre><p id="f621" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更漂亮的配置有多种选择，看看<a class="ae ky" href="https://prettier.io/docs/en/options.html" rel="noopener ugc nofollow" target="_blank">更漂亮的文档</a>。</p><p id="53cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想忽略一些文件格式使用漂亮，添加一个<code class="fe no np nq nr b">.prettierignore</code>文件在根应用程序文件夹和添加文件在那里。</p><p id="8631" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可以将以下文件和文件夹添加到<code class="fe no np nq nr b">.prettierignore</code>文件中，因为格式化时不需要它们:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="0247" class="mc md it nr b gy nw nx l ny nz">package-lock.json<br/>node_modules</span></pre><h2 id="1a16" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated"><strong class="ak"> 4。棉绒分级配置</strong></h2><p id="1ed0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">Lint-Staged的配置并不具有挑战性，所以打开<code class="fe no np nq nr b">package.json</code>文件，最后，在其他配置之后，添加如下配置部分:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="3b66" class="mc md it nr b gy nw nx l ny nz">{<br/>  <em class="ly">...<br/>  ...</em></span><span id="db4f" class="mc md it nr b gy ob nx l ny nz">  "lint-staged": {<br/>    "**/*.{js,jsx}": ["eslint . --fix", "prettier --write ."]<br/>  }<br/>}</span></pre><p id="65bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">"<code class="fe no np nq nr b">**/*.{js,jsx}</code>"这个脚本将在您的整个应用程序上运行，这意味着所有带有<code class="fe no np nq nr b">js</code>和<code class="fe no np nq nr b">jsx</code>扩展名的文件，但是如果您想只在src文件夹内的文件上执行<code class="fe no np nq nr b">lint-staged</code>，那么就改为编写这个脚本:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="5677" class="mc md it nr b gy nw nx l ny nz">"src/*.{js,jsx}": ["eslint . --fix", "prettier --write ."]</span></pre><p id="e5ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上述配置中，“…”表示其他配置，您不需要在您的<code class="fe no np nq nr b">package.json</code>文件中添加这些点。</p><h2 id="2b96" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">5.配置Husky</h2><p id="5124" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们整个配置的最后一节是Husky，配置Husky有几种方式，但是我们在这里会尽量保持简单。同样，您需要打开package.json文件，并在所有其他配置之后添加以下脚本，如下所示:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="0f87" class="mc md it nr b gy nw nx l ny nz">{<br/>  <em class="ly">...<br/>  ...</em></span><span id="f4a8" class="mc md it nr b gy ob nx l ny nz">  "scripts": {<br/>    <em class="ly">&lt; ---- other scripts remains here ---- &gt;</em></span><span id="db54" class="mc md it nr b gy ob nx l ny nz">    "execute-husky": "npx husky install &amp;&amp; npx husky add .husky/pre-commit \"npx --no-install lint-staged\""<br/>  },<br/>  "husky": {<br/>    "hooks": {<br/>      "pre-commit": "lint-staged"<br/>    }<br/>  }<br/>}</span></pre><p id="8d8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您已经在<code class="fe no np nq nr b">package.json</code>文件中添加了上述配置，执行将安装Husky的“<code class="fe no np nq nr b">execute-husky</code>”脚本，同时也将触发<code class="fe no np nq nr b">pre-commit</code>钩子。您可以使用<code class="fe no np nq nr b">npm</code>命令运行<code class="fe no np nq nr b">execute-husky</code>命令，例如:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="3979" class="mc md it nr b gy nw nx l ny nz">npm run execute-husky</span></pre><p id="2dd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">您已经完成了这里的所有配置，现在尝试提交您的更改并查看结果。🎉</strong></p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><p id="9601" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly">在…</em><a class="ae ky" href="https://twitter.com/m_adeel91" rel="noopener ugc nofollow" target="_blank"><em class="ly">Twitter</em></a><em class="ly">，</em><a class="ae ky" href="https://www.linkedin.com/in/muhammad-adeel-9ba19951/" rel="noopener ugc nofollow" target="_blank"><em class="ly">LinkedIn</em></a><em class="ly">，或者</em> <a class="ae ky" href="https://github.com/Adeel91" rel="noopener ugc nofollow" target="_blank"> <em class="ly"> GitHub </em> </a></p><p id="1b4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑<a class="ae ky" href="https://medium.com/@muhammad-adeel-91/membership" rel="noopener">报名成为一名媒体成员</a>。每月5美元，你可以无限制地阅读媒体上的故事。如果你注册使用我的链接，我会赚一小笔佣金。</p><div class="oj ok gp gr ol om"><a href="https://medium.com/@muhammad-adeel-91/membership" rel="noopener follow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">通过我的推荐链接加入媒体-穆罕默德·阿德勒</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">阅读默罕默德·阿德勒(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">medium.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ks om"/></div></div></a></div><p id="74e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.buymeacoffee.com/muhammadadeel" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="ly">给我买杯咖啡</em></strong></a><strong class="lb iu"><em class="ly">☕</em></strong></p></div></div>    
</body>
</html>