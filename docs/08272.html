<html>
<head>
<title>Launch Blender for 3D Printing via Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Python启动3D打印搅拌机</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/configure-blender-for-3d-printing-via-python-ecf729e4099b?source=collection_archive---------0-----------------------#2021-04-17">https://levelup.gitconnected.com/configure-blender-for-3d-printing-via-python-ecf729e4099b?source=collection_archive---------0-----------------------#2021-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3f31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">写教程很好——而且我一直没有做；事情很糟糕，我已经做得太多了。是时候开始改变这两种状况了。此外，编写这种样板有用的代码是我1000%倾向于做的事情，然后忘记我是如何做的。我想我不是唯一的一个，但即使是这样，写下这些笔记来帮助未来的吉姆仍然是值得的。</p><p id="a8be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Blender非常适合3D打印，但每次配置环境都很繁琐——在Blender和YouTube之间来回点击试图记住所有要更改的设置并没有成功。最后，事实证明这是开始学习Blender Python API的一个非常好的方法。</p><p id="7810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要完全访问Python脚本中生成的调试输出，请从命令行启动Blender。因为这将随着操作系统的不同而不同，所以请查看Blender的文档:从命令行启动。</p><p id="2144" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了方便起见，我包括的所有截图都展示了Blender脚本环境——但是任何文本编辑器都可以工作。</p><p id="5260" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样值得进入<em class="km">编辑&gt;偏好设置&gt;界面</em>并启用<em class="km"> Python工具提示</em>复选框。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/12fee4afe2ffaa2665b123fe0d4c8be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-KozvaCM_1BFTpGd338mg.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">GUI中的一切都符合Blender Python API</figcaption></figure><p id="ec1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里开始，一切都可以通过脚本工作区来完成，要么创建一个新的。py文件，或者通过文件浏览器导入一个。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/528f13affd9c1003e8f9567158a2590c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k2BcW-Ldg6nBCioCwVIXyQ.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">默认工作空间包括一个控制台和一个信息面板，信息面板反映了在GUI中采取的操作所执行的底层Python。要进行全面调试，您必须切换到启动Blender的CLI。</figcaption></figure><p id="f183" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在进行实际的编码。有5个小步骤:</p><ol class=""><li id="9e3e" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">定义导入和常量</li></ol><p id="0ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.将场景比例和单位从米更改为毫米</p><p id="b075" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.配置视口以更新的比例显示</p><p id="157a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.确保正式的3D打印工具加载项已启用</p><p id="349d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.移除默认场景对象</p><pre class="ko kp kq kr gt lm ln lo lp aw lq bi"><span id="6ea1" class="lr ls iq ln b gy lt lu l lv lw">import bpy<br/>from addon_utils import check, enable<br/>C = bpy.context<br/>D = bpy.data</span><span id="f1d9" class="lr ls iq ln b gy lx lu l lv lw">SCALE_LENGTH = 0.001<br/>LENGTH_UNIT = ‘MILLIMETERS’<br/>MASS_UNIT = 'GRAMS'<br/>CLIP_END = 100000<br/>PRINT_UTIL = “object_print3d_utils”</span></pre><p id="d1d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“导入bpy”加载Blender Python。“addon_utils”功能将用于启用3D打印工具。“C”和“D”是Blender Python标准，用来给“bpy.context”和“bpy.data”起别名，它们是经常使用的对象。</p><pre class="ko kp kq kr gt lm ln lo lp aw lq bi"><span id="73df" class="lr ls iq ln b gy lt lu l lv lw">def config_units():<br/>    C.scene.unit_settings.scale_length = SCALE_LENGTH<br/>    C.scene.unit_settings.length_unit = LENGTH_UNIT<br/>    C.scene.unit_settings.mass_unit = MASS_UNIT</span></pre><p id="9993" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">直白。相当于在“场景属性”面板上更新“单位比例”、“长度”和“质量”。例如，如果您正在对运动零件，齿轮进行建模，并计划使用动画来检查它们的平滑操作，则设置“质量”很有帮助。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/6b3db23e7a4dfe2fd9f519be61d5d2f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*zdof--S9w1rHRSbgJUzfnw.jpeg"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">场景属性-&gt;单位-&gt;下拉菜单…</figcaption></figure><pre class="ko kp kq kr gt lm ln lo lp aw lq bi"><span id="f520" class="lr ls iq ln b gy lt lu l lv lw">def config_viewports():<br/>    screens = D.screens<br/>    viewareas = [<br/>        area for screen in screens <br/>        for area in screen.areas <br/>        if area.type == ‘VIEW_3D’<br/>       ]<br/>    for area in viewareas:<br/>        area.spaces.active.overlay.grid_scale = SCALE_LENGTH<br/>        area.spaces.active.clip_end = CLIP_END</span></pre><p id="c837" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一步有点有趣:使用List Comprehension，该函数遍历每个工作空间，并过滤以仅选择3D视口编辑器。从那里，这只是一个为网格比例和剪辑结束设置新值的情况，相当于在“覆盖”下拉菜单和“查看”侧栏中进行调整。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/0a8fb78e37b148f3f14b296fbfcd8eb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*IuiF8MCXJY6jhurgfWo65Q.jpeg"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">视口覆盖-比例:1 -&gt; .001</figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/ae5a26b33d00969855627ec309f2013b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*2FsbPUyJMGMWLPyvRnuX_Q.jpeg"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">查看侧边栏:剪辑结束有单位重视。1000米-&gt; 1000毫米-&gt; 100000毫米</figcaption></figure><pre class="ko kp kq kr gt lm ln lo lp aw lq bi"><span id="e2d8" class="lr ls iq ln b gy lt lu l lv lw">def enable_print_util():<br/>    is_enabled, is_loaded = check(PRINT_UTIL)<br/>    if is_enabled and is_loaded:<br/>        return<br/>    try:<br/>        bpy.ops.preferences.addon_enable(module=PRINT_UTIL)<br/>    except:<br/>        print(f"ERR: Error loading {PRINT_UTIL}")<br/>    finally:<br/>        return</span></pre><p id="d93d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是使用“addon_utils”模块导入的地方。该函数检查官方Blender Mesh 3D-Print Toolbox附加组件是否已经加载并启用。如果是，函数返回，否则，启用模块。bpy方法被包装在一个try-catch中，以便在处理依赖关系时安全起见。</p><pre class="ko kp kq kr gt lm ln lo lp aw lq bi"><span id="6822" class="lr ls iq ln b gy lt lu l lv lw">def remove_default_objects():<br/>    bpy.ops.object.select_all(action=’SELECT’)<br/>    if len(C.selected_objects) &lt;= 3:<br/>        bpy.ops.object.delete(use_global=True)</span></pre><p id="4015" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">长期受苦的默认立方体再次得到它。这个辅助函数是可选的，但是工作起来非常简单——选择场景中的所有对象(包括默认灯光和默认相机)并删除它们。作为一种安全措施，如果在已经创建了更多对象的文件上调用这个脚本，对delete方法的调用被包装在一个条件后面，并且如果选择了3个以上的对象，将不会触发。</p><p id="323a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，剩下的就是调用函数了:</p><pre class="ko kp kq kr gt lm ln lo lp aw lq bi"><span id="8ba7" class="lr ls iq ln b gy lt lu l lv lw">config_units()<br/>config_viewports()<br/>enable_print_util()<br/>remove_default_objects()</span></pre><p id="98f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，这个脚本可以在任何项目中运行，它将设置导出到3D打印的模型。但是这仍然意味着点击进入脚本工作区，加载并执行它。幸运的是，Blender使得在启动时执行Python脚本变得很容易。从CLI运行，只需传入'-P '标志和脚本的相对路径:</p><pre class="ko kp kq kr gt lm ln lo lp aw lq bi"><span id="d231" class="lr ls iq ln b gy lt lu l lv lw">blender -P ./setup_environment_mm.py</span></pre><p id="ad33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可以作为一个单词命令的别名出现在它自己的shell脚本中，但是这似乎是一个很好的地方。以下是整个剧本的要点:</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="ma mb l"/></div></figure></div></div>    
</body>
</html>