<html>
<head>
<title>Using Web Components in a React Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React应用程序中使用Web组件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-web-components-in-a-react-application-98dcfdb6d0b1?source=collection_archive---------14-----------------------#2020-10-28">https://levelup.gitconnected.com/using-web-components-in-a-react-application-98dcfdb6d0b1?source=collection_archive---------14-----------------------#2020-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7ebb318a44f0e8157080f9a9718c8d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAk-1T0tc6ckkPD4cZRrug.png"/></div></div></figure><p id="c628" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<a class="ae kw" href="https://www.nexmo.com/blog/2020/08/13/creating-a-web-component-with-open-wc" rel="noopener ugc nofollow" target="_blank">之前的一篇文章</a>中，我们向您展示了如何构建和发布Web组件。</p><p id="f3a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是时候看看如何使用Web组件的顶级特性了:</p><blockquote class="kx ky kz"><p id="bc2f" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">基于Web组件标准构建的定制组件和小部件可以跨现代浏览器工作，并且可以与任何支持HTML的JavaScript库或框架一起使用。</p><p id="6705" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">——【WebComponents.org T2】</p></blockquote><p id="3cf3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我们将看看Web组件如何集成到一个<a class="ae kw" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>应用程序中。</p><h1 id="1cb5" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Vonage API帐户</h1><p id="fddd" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">要完成本教程，您将需要一个<a class="ae kw" href="http://developer.nexmo.com/ed?c=blog_text&amp;ct=2020-10-07-using-web-components-in-a-react-application-dr" rel="noopener ugc nofollow" target="_blank"> Vonage API帐户</a>。如果您还没有，您可以今天就<a class="ae kw" href="http://developer.nexmo.com/ed?c=blog_text&amp;ct=2020-10-07-using-web-components-in-a-react-application-dr" rel="noopener ugc nofollow" target="_blank">注册</a>并开始使用免费信用点数进行构建。一旦你有了一个帐户，你可以在<a class="ae kw" href="http://developer.nexmo.com/ed?c=blog_text&amp;ct=2020-10-07-using-web-components-in-a-react-application-dr" rel="noopener ugc nofollow" target="_blank"> Vonage API仪表板</a>的顶部找到你的API密匙和API秘密。</p><p id="3818" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本教程还使用了一个虚拟电话号码。要购买号码，请前往<em class="la">号码</em> &gt; <em class="la">购买号码</em>并搜索符合您需求的号码。</p><h1 id="c4a9" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Web组件</h1><p id="5d63" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">首先，让我们看一下将在应用程序中使用的Web组件。</p><p id="cf93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们有来自<a class="ae kw" href="https://www.nexmo.com/blog/2020/08/13/creating-a-web-component-with-open-wc" rel="noopener ugc nofollow" target="_blank">上一篇文章</a>的键盘组件和联系人列表组件。联系人列表可以从浏览器的<a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" rel="noopener ugc nofollow" target="_blank">本地存储器</a>中保存和加载被叫人的姓名和电话号码。Web组件还可以在单击时将联系人的电话号码作为自定义事件发送给应用程序。</p><p id="6183" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有一个<a class="ae kw" href="https://www.npmjs.com/package/@material/mwc-dialog" rel="noopener ugc nofollow" target="_blank"> Material Web组件对话框</a>，如果该号码不在联系人列表中，它将在通话结束后显示，因此可以保存。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/b3b6ebb513a71da60b4eab4ac09b09b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z8C2OCoJ_e0KLAjk"/></div></div></figure><h1 id="9cf4" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">问题</h1><p id="5eeb" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">为了了解我们在React应用程序中使用这些Web组件时可能会遇到什么障碍，我们将到处引用<a class="ae kw" href="https://custom-elements-everywhere.com" rel="noopener ugc nofollow" target="_blank">自定义元素</a>。</p><p id="931d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">他们承担了“确保框架和定制元素成为好朋友”的崇高责任🍻".</p><p id="15d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是通过对框架/库进行各种测试并报告它们与Web组件的集成情况来实现的。</p><p id="920a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么React的表现如何呢？截至本文发布之日，以下是结果:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/6e002e4e4066a6d522bde44afc5c6db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gsBakUS5o0sPyll0"/></div></div></figure><p id="bdb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看起来不太好，但我们可以做到。让我们来看看其中的一些问题。</p><p id="eac7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">向Web组件传递数据的一种方式是通过属性:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="d636" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当在React应用程序中这样做时，数据被字符串化。所以传递数组(即[1，2，3，4])会变成“1，2，3，4”，对象(即{“key 1”:value 1，“key 2”:value 2 })会变成可怕的“[object Object]”。</p><p id="24be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个问题是T2如何处理T3事件。</p><p id="d7d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">React有自己的<a class="ae kw" href="https://reactjs.org/docs/events.html" rel="noopener ugc nofollow" target="_blank">合成事件</a>实例，它是浏览器本地事件的包装器。Custom Elements Everywhere的调查结果显示，React的SyntheticEvent“无法侦听来自自定义元素的DOM事件”。它们还提供了一种解决方案，我们接下来将研究这种解决方案。</p><h1 id="1f1e" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">解决方法</h1><p id="d42c" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">现在我们知道了等待我们的是什么，让我们努力克服这些问题。</p><p id="289c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">计划是创建一个基本的React“App”组件，然后将我们的Web组件放入其中。</p><p id="47ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在React应用程序中有两种方式编写组件——作为<a class="ae kw" href="https://reactjs.org/docs/components-and-props.html#function-and-class-components" rel="noopener ugc nofollow" target="_blank">类或函数</a>。</p><p id="30ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以前，如果您使用一个<a class="ae kw" href="https://reactjs.org/docs/state-and-lifecycle.html" rel="noopener ugc nofollow" target="_blank">类组件而不是函数组件</a>，那么在您的组件中需要使用“状态”是一个决定性因素。</p><p id="2a9c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后在React 16.8中，引入了<a class="ae kw" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">钩子</a>。"它们让你不用写类就可以使用状态和其他React特性."</p><p id="0c77" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，为了在这篇文章中尽可能彻底，我们将在React应用程序中包含Web组件，这些组件是使用带有钩子的类组件和函数组件创建的。</p><p id="ca40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与任何时候使用Web组件一样，它们必须包含在项目中。您可以安装它们，也可以从CDN链接到它们。(这在<a class="ae kw" href="https://www.nexmo.com/blog/2020/08/13/creating-a-web-component-with-open-wc" rel="noopener ugc nofollow" target="_blank">之前的帖子</a>中有所涉及。)</p><p id="59ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于这种集成，我们将从CDN中抽取。</p><p id="9c67" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在示例代码中的<code class="fe mp mq mr ms b">public\index.html</code>文件的<code class="fe mp mq mr ms b">&lt;head&gt;</code>标签中，您会发现:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="6b1d" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">类别组件</h1><p id="8471" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">你可以在这个<a class="ae kw" href="https://glitch.com/edit/#!/amethyst-wary-wedge?path=src%2FApp.js%3A4%3A0" rel="noopener ugc nofollow" target="_blank"> Glitch项目</a>中找到样本代码。</p><blockquote class="kx ky kz"><p id="3d50" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">注意:我重新混合了<a class="ae kw" href="https://glitch.com/~starter-react-template" rel="noopener ugc nofollow" target="_blank"> Glitch React启动器模板</a>。</p></blockquote><h2 id="0ba4" class="mt lf iq bd lg mu mv dn lk mw mx dp lo kj my mz ls kn na nb lw kr nc nd ma ne bi translated">处理事件</h2><p id="7936" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">为了能够处理来自Web组件的事件，我们首先必须获得对它的引用，以便React知道它的存在，并可以添加事件侦听器。在<code class="fe mp mq mr ms b">src\App.js</code>渲染函数中，你会发现一些<code class="fe mp mq mr ms b">ref</code>标签:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="6f58" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr ms b">ref</code>标签让React知道要注意这些元素。</p><p id="ad49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe mp mq mr ms b">src\App.js</code>的<code class="fe mp mq mr ms b">componentDidMount()</code>中，事件监听器被添加到我们刚刚设置的元素引用中。代码如下:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="6e7d" class="mt lf iq bd lg mu mv dn lk mw mx dp lo kj my mz ls kn na nb lw kr nc nd ma ne bi translated">处理数据</h2><p id="91c5" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">对于我们的键盘组件，我们将字符串传递到属性中，因此在React中不需要对这些数据做任何特殊处理。</p><p id="417d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通话后保存联系人时，数据是一个对象:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="2c75" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这被传递到联系人列表Web组件中的一个方法中:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="4755" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果联系人列表组件没有使用对象来操作数据并保存到本地存储，我们可以像这样传递对象:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="c006" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这同样适用于数组。</p><blockquote class="kx ky kz"><p id="d38d" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="iq">重要提示！</em> </strong> <em class="iq">用来获取对Web组件的引用的API被认为是遗留的，并且“可能会在将来的某个版本中被删除”</em> <a class="ae kw" href="https://reactjs.org/docs/refs-and-the-dom.html#legacy-api-string-refs" rel="noopener ugc nofollow" target="_blank"> <em class="iq">文档</em> </a> <em class="iq">有更多的信息并提供替代方案。</em></p></blockquote><p id="25e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们展示一个提到的替代方案。</p><p id="f5fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您使用的是React 16.3或更高版本，下面是使用<a class="ae kw" href="https://reactjs.org/docs/refs-and-the-dom.html#creating-refs" rel="noopener ugc nofollow" target="_blank"> React.createRef() </a>的Glitch项目<a class="ae kw" href="https://glitch.com/edit/#!/ionian-jelly-nasturtium?path=src%2FApp.js%3A1%3A0" rel="noopener ugc nofollow" target="_blank">示例代码</a>。</p><p id="09c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">几乎相同的想法，只是更多的语法。在构造函数中用<code class="fe mp mq mr ms b">React.createRef()</code>创建引用:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="34dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将其连接到<code class="fe mp mq mr ms b">render</code>中的Web组件:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="5e5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe mp mq mr ms b">componentDidMount()</code>中添加一个事件监听器:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="400e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">调用Web组件的方法:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="262e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将“丰富”数据传递给Web组件:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="7228" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">带挂钩的功能组件</h1><p id="1494" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">现在是最新的方法，从React 16.8开始，可以用来创建Web组件引用。</p><p id="02ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">许多重物都是用钩子来搬运的。无论是处理状态、副作用还是DOM引用，可能都有一个钩子可以使用。</p><p id="920b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果没有，您可以创建一个自定义挂钩。</p><p id="f20e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，我们将使用的一个钩子是<a class="ae kw" href="https://reactjs.org/docs/hooks-reference.html#useref" rel="noopener ugc nofollow" target="_blank"> useRef </a>。</p><p id="5bfd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这看起来很像<code class="fe mp mq mr ms b">React.createRef()</code>的例子。</p><p id="3c5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在这个<a class="ae kw" href="https://glitch.com/edit/#!/malleable-sable-relation?path=src%2FApp.js%3A1%3A0" rel="noopener ugc nofollow" target="_blank"> Glitch项目</a>中找到带有钩子样本代码的函数组件。</p><h2 id="9971" class="mt lf iq bd lg mu mv dn lk mw mx dp lo kj my mz ls kn na nb lw kr nc nd ma ne bi translated">处理事件</h2><p id="8ba8" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">首先，我们需要初始化每个Web组件的引用。这是通过以下代码完成的:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="578a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr ms b">null</code>是给定值的初始值。</p><p id="998f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后在返回部分，我们用<code class="fe mp mq mr ms b">ref={referenceName}</code>将引用附加到Web组件上。</p><p id="f12a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码如下:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="eaa9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们添加事件侦听器。</p><p id="8d27" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，我们将把它们放在一个<a class="ae kw" href="https://reactjs.org/docs/hooks-effect.html" rel="noopener ugc nofollow" target="_blank">使用效果钩子</a>中:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="174f" class="mt lf iq bd lg mu mv dn lk mw mx dp lo kj my mz ls kn na nb lw kr nc nd ma ne bi translated">处理数据</h2><p id="28cb" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">如前所述，这将看起来非常类似于<code class="fe mp mq mr ms b">React.createRef()</code>示例代码。</p><p id="4709" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用Web组件的方法发送数据:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="b307" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要将“丰富”数据传递给Web组件:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="45dd" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">到</h1><p id="c0c4" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">我们已经连接好了我们的Web组件，为什么不用我们的React应用程序打个电话呢？</p><p id="54c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面的步骤是一个修改版本，也是我们制作应用内语音通话教程<a class="ae kw" href="https://developer.nexmo.com/client-sdk/tutorials/app-to-phone/introduction/javascript" rel="noopener ugc nofollow" target="_blank">使用我们的Web组件的快速概述。</a></p><p id="f7b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以参考那个来了解更多的细节。</p><p id="dede" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要使其发挥作用，需要:</p><p id="c217" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第一步:</strong>重新混合这个<a class="ae kw" href="https://glitch.com/edit/#!/remix/carbonated-super-girdle" rel="noopener ugc nofollow" target="_blank">小故障项目</a>。</p><p id="a521" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这不仅将设置带有Web组件的React应用程序，还将安装用于打电话的<a class="ae kw" href="https://developer.nexmo.com/client-sdk/overview" rel="noopener ugc nofollow" target="_blank"> Nexmo客户端SDK </a>。</p><p id="0c4d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤2: </strong>安装Nexmo CLI工具。</p><p id="cda2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的终端中，键入:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="8701" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从你的<a class="ae kw" href="https://dashboard.nexmo.com/settings" rel="noopener ugc nofollow" target="_blank">仪表板</a>获取你的Vonage开发者API密匙和API秘密。</p><p id="d5ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在终端中运行以下命令，同时用您自己的命令替换api_key和api_secret:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="6d47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保你已经登录到<a class="ae kw" href="https://github.com" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，然后进入<a class="ae kw" href="https://gist.github.com" rel="noopener ugc nofollow" target="_blank">https://gist.github.com</a>。</p><p id="d637" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在“包括扩展名的文件名”中输入<code class="fe mp mq mr ms b">ncco.json</code>。</p><p id="1ebe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将以下JSON对象复制并粘贴到gist中:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="5e99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用你的电话号码替换<code class="fe mp mq mr ms b">PHONE_NUMBER</code>。Nexmo编号采用E.164格式，“+”和“-”无效。请确保在输入您的号码时指定您的国家代码，例如，美国:14155550100，英国:447700900001。</p><p id="a407" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击<code class="fe mp mq mr ms b">Create secret gist</code>按钮。</p><p id="44fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击<code class="fe mp mq mr ms b">Raw</code>按钮。</p><p id="4660" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">记下浏览器中显示的URL，您将在下一步中使用它。</p><p id="210f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤4: </strong>创建一个Nexmo应用程序</p><p id="2747" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果尚未创建项目目录，请创建项目目录。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="7e23" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">切换到项目目录。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="1486" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过将下面的命令复制并粘贴到终端来创建一个Nexmo应用程序:</p><blockquote class="kx ky kz"><p id="f22f" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">确保通过用上一步中的要点URL替换<code class="fe mp mq mr ms b">GIST-URL</code>来改变<code class="fe mp mq mr ms b">--voice-answer-url</code>参数的值。</p></blockquote><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="fe84" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的项目目录中创建一个名为<code class="fe mp mq mr ms b">.nexmo-app</code>的文件，它包含新创建的Nexmo应用程序ID和私钥。还创建了一个名为<code class="fe mp mq mr ms b">private.key</code>的私钥文件。</p><p id="62c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请记下应用程序ID，因为您将来会需要它。</p><p id="3dad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第五步:</strong>创建用户</p><p id="0443" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用Nexmo CLI，使用以下命令创建名为Alice的用户:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="f054" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将返回如下所示的用户ID:</p><p id="2aa7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr ms b">User created: USR-aaaaaaaa-bbbb-cccc-dddd-0123456789ab</code></p><p id="efbd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第六步:</strong>生成JWT</p><p id="34a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过运行以下命令，使用Nexmo CLI生成一个JWT，但请记住用您自己的值替换<code class="fe mp mq mr ms b">APP_ID</code>变量:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="b1fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">生成的JWT将在接下来的6小时内有效。</p><p id="a1a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将JWT复制并粘贴到<code class="fe mp mq mr ms b">src/App.js</code> Glitch项目文件中，这里写着“将爱丽丝·JWT粘贴到这里”。</p><p id="90db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第七步:</strong>给自己打电话！</p><p id="9737" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在键盘上拨打您的号码，然后按下<em class="la">呼叫</em>。</p><p id="5326" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果一切正常，你的手机应该会收到一个电话。通话结束后，会弹出一个对话框，询问您是否要保存该号码。</p><blockquote class="kx ky kz"><p id="33c0" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">注意:由于NCCO与您的电话号码是硬编码的，无论用键盘键入什么，您的号码都会被呼叫。要动态生成NCCO，需要在后端完成。</p></blockquote><p id="a937" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗯，就这样吧！我们现在已经在React应用程序中使用了Web组件。</p><p id="b4cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">成功了吗？很酷吗？</p><p id="7636" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如编码中的任何事情一样，做事有多种方式。</p><p id="f89d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在<a class="ae kw" href="https://reactjs.org/docs/web-components.html" rel="noopener ugc nofollow" target="_blank"> React </a>和<a class="ae kw" href="https://stenciljs.com/docs/react" rel="noopener ugc nofollow" target="_blank">模板JS </a>文档中发现的另一种方法是将Web组件包装在React组件中。</p><p id="4fbf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你是用那种方式还是另一种方式做的？我真的很想在我们的<a class="ae kw" href="https://developer.nexmo.com/slack" rel="noopener ugc nofollow" target="_blank">社区休闲频道</a>中听到它或任何其他评论和问题。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="01de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="la">最初发布于</em><a class="ae kw" href="https://www.nexmo.com/blog/2020/10/07/using-web-components-in-a-react-application-dr" rel="noopener ugc nofollow" target="_blank"><em class="la">https://www . NEX mo . com/blog/2020/10/07/using-we B- components-in-a-react-application-dr</em></a></p></div></div>    
</body>
</html>