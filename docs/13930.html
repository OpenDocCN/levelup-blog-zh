<html>
<head>
<title>A Python library that makes it simple to forecast time series</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个Python库，使预测时间序列变得简单</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-python-library-that-makes-it-simple-to-forecast-time-series-6a403da71542?source=collection_archive---------0-----------------------#2022-10-18">https://levelup.gitconnected.com/a-python-library-that-makes-it-simple-to-forecast-time-series-6a403da71542?source=collection_archive---------0-----------------------#2022-10-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cf1810d808556190b5dee221914eee33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IJT_AZcFFCgx8-8h"/></div></div></figure><p id="7998" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本博客重点介绍Darts，这是目前专门为预测和操作时间序列数据而创建的最好和最简单的库之一，您可能使用过scikit-learn等其他库，但它的应用范围更广，您必须使用sklearn执行手动步骤来预测/预测任何时间序列数据。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="bc0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">飞镖库GitHub链接:</strong><a class="ae ld" href="https://github.com/unit8co/darts" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"/></a></p><p id="d68e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">文档链接:</strong><a class="ae ld" href="https://unit8co.github.io/darts/quickstart/00-quickstart.html#Training-forecasting-models-and-making-predictions" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">https://unit8co . github . io/darts/quick start/00-quick start . html # Training-forecasting-models-and-making-predictions</strong></a></p><p id="91a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">下面显示的所有代码均来自其官方文档页面。</strong></p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="1169" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们开始吧！</p><h2 id="7041" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">导入darts库</h2><p id="c469" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">使用安装darts库</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="9313" class="le lf iq mh b gy ml mm l mn mo">pip install darts</span></pre><p id="5a06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">像scikit-learn一样，darts也有一些标准数据集，不需要从一些外部网站下载任何文件。</p><h2 id="54c4" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">导入库和数据集</h2><p id="2e7d" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">安装完库后，我们将从darts.dataset导入darts以及Air passengers时间序列数据集</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/3c40224a201ee9084b40b8aa7f93a31a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rg8sBNb6s5PPVFMgDi8-qg.png"/></div></div></figure><p id="7486" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">TimeSeries是Darts中的主要数据类。时间序列代表一个单变量或多变量时间序列，具有适当的时间索引。</p><h2 id="8063" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">绘制数据集</h2><p id="56b7" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">让我们加载我们的时间序列数据集并绘制它</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/85da080d6af418bd0a1333428a8158da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8eHor_o4ttzNmQLRZxJ6ug.png"/></div></div></figure><p id="a9ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">x轴代表年份，y轴代表乘客数量。</p><p id="a292" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">TimeSeries类包含不同种类的操作，让我们看看其中的一些。</p><h2 id="f05b" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">剧烈的</h2><p id="be02" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">您可以使用这两个命令中的任何一个来分割数据集</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="83b4" class="le lf iq mh b gy ml mm l mn mo"><strong class="mh ir">split_after(split_point)</strong><br/>which Splits the series in two, after a provided split_point.</span><span id="227b" class="le lf iq mh b gy mr mm l mn mo"><strong class="mh ir">split_before(split_point) </strong><br/>that Splits the series in two, before a provided split_point.</span></pre><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/e750539b96ab90d69e298d3c38077c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ReyHLXoL-TVHQj9YFl5jQA.png"/></div></div></figure><p id="4e86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用上述两种不同的方法将系列分为两部分，即<strong class="ka ir"> 75%和</strong>25%。</p><h2 id="2801" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">限幅</h2><p id="e2d9" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">您可以使用索引方法对时间序列数据进行切片。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/bbbbc00a63e072ffdda4ad7ef72fd594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GeFnxxETd8sA_12SH-pjnw.png"/></div></div></figure><h2 id="c5f1" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated"><strong class="ak">算术运算</strong></h2><p id="7a9d" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">对我们的系列数据集执行算术运算</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/df64295c269f0ab25a8dece7985e2583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRmuC418ij6kZxIj5yzlOQ.png"/></div></div></figure><h2 id="f0e8" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">映射操作</h2><p id="f8bb" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">使用NumPy库映射值</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/03b034ea5c0dcd4f36bf6d8ce0dcc9d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bpXEq2veRexV_Bv8-Veewg.png"/></div></div></figure><h2 id="c552" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">添加一些二进制假日组件</h2><p id="8b9d" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">这就是事情变得有趣的地方！</p><p id="7c51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如他们的官方文档所述，<strong class="ka ir"> add_holidays </strong>方法将一个二元单变量组件添加到当前序列中，该组件在与所选国家/地区的假期相对应的每个指数处等于1，否则等于0。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/f414e1b0f43b19f66402cbe03ad4a28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d8PwjVivZNrKElrmOeuEmA.png"/></div></div></figure><h2 id="eb4c" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">填充缺失值</h2><p id="d5f4" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">Darts包含一个filling_missing_values函数，使您能够填充时间序列数据中的缺失值</p><p id="5dde" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是演示此功能的代码:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/0b2303a08636a149ae7088b98820c6bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XGVnFQYMxB89etzGQldmXA.png"/></div></div></figure><p id="b46b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是输出</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/a7aa3147ed53adc5caa57763d879dab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O81RaFkaETcEhjD0m_BZFg.png"/></div></div></figure><p id="3d71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以看到它完美地预测了时间序列数据的NAN值。</p><h2 id="9c04" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">创建用于预测的训练和测试数据</h2><p id="62f5" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">我们正在使用我们的航空乘客数据集，并将其分为训练和测试数据</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/89353a29973fb121100c175509ec384d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qk_Pt7rNXy_XURZt42WmHw.png"/></div></div></figure><p id="55cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">训练序列将是包含直到1958年1月(不包括)的值的时间序列，而测试序列是包含其余部分的时间序列。</p><h2 id="00ae" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">使用NaiveSeasonal预测</h2><p id="80e9" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">分割数据集后，我们将使用darts库提供的第一个预测模型。</p><p id="d834" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如他们的文档中所述，Darts中存在一组“幼稚的”基线模型，这对于了解人们所能期望的最低精确度非常有用。例如，NaiveSeasonal(K)模型总是“重复”K个时间步之前发生的值。</p><p id="e37c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在其最简单的形式中，当K=1时，该模型简单地总是重复训练序列的最后一个值:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/0b134a5c76f6701fe3acca30459decb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEYh3KcMGIwI5EmX_l8Yuw.png"/></div></div></figure><p id="dd72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是输出:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/35edafea05869ead7cd1a727076ce99b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3gTNys-QdXzmj8sPvcD7bw.png"/></div></div></figure><p id="1e4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用darts库拟合和预测时间序列数据非常容易，fit()用于训练数据集，而predict()用于预测数据。</p><h2 id="63fd" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">检查季节性</h2><p id="b0f5" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">正如你所看到的，我们的模型太天真(缺乏预测)，我们已经看到我们的数据显示每年的季节性行为，我们可以通过使用darts.utils.statistics中的check _ seasonality来确认这一点。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/ff7d3992e940e8ca3e0de749bfafd1bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LzKp7EsPTeSg_JpSrqaFTw.png"/></div></div></figure><p id="b9b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<strong class="ka ir"> x = 12 </strong>处看到一个峰值，代表年度季节性趋势(红线)。</p><p id="68e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们将重新运行我们简单的季节性模型，但是k = 12(我们之前已经确定的值)</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/1aef32f328e4ed8f42a443ab7b1714c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kw7oo_MeYzeult_Wv35bnQ.png"/></div></div></figure><p id="01b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如你所看到的，在我们的模型中实现季节变化值后，它显示了更好的预测，但仍然不准确。</p><p id="708b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如他们的官方文档中所述，还有另一个捕捉趋势的幼稚基线模型，称为NaiveDrift。此模型生成线性预测，其斜率由定型集的第一个和最后一个值决定。</p><h2 id="8a2f" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">计算误差度量</h2><p id="cd28" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">让我们来看看我们必须最小化的误差值。我们可以使用darts.metrics中的map函数来实现</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/fef90e89e2234ebc195c40f2442a329d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zn3-wEkB_avZfoTlhDvR5A.png"/></div></div></figure><p id="2d47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如你所见，在k = 12的情况下，我们的天真模型的误差约为13%。对该数据执行NaiveDrift以检查它是否减少了任何误差。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="81f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">这是一个非常简短的darts库指南，你可以从他们的文档页面中找到很多。</strong></p><h2 id="a94b" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">如果您有任何疑问，请随时问我！</h2></div></div>    
</body>
</html>