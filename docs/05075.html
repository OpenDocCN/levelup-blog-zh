<html>
<head>
<title>Custom scroll controls in iOS 14 and SwiftUI 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS 14和SwiftUI 2中的自定义滚动控件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/custom-scroll-controls-in-ios-14-and-swiftui-2-3513fbde478e?source=collection_archive---------6-----------------------#2020-08-02">https://levelup.gitconnected.com/custom-scroll-controls-in-ios-14-and-swiftui-2-3513fbde478e?source=collection_archive---------6-----------------------#2020-08-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/a990f660b4fd9b293e0efdacb086e3ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*9a78-GzNU8gIbmyPUy89Kg.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">控制文本视图滚动位置的滑块</figcaption></figure><p id="6f1f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">随着SwiftUI 2和iOS 14的发布，我们现在可以访问一个名为<a class="ae kz" href="https://developer.apple.com/documentation/swiftui/scrollviewreader" rel="noopener ugc nofollow" target="_blank"> ScrollViewReader </a>的新视图，该视图公开了一个名为<a class="ae kz" href="https://developer.apple.com/documentation/swiftui/scrollviewproxy" rel="noopener ugc nofollow" target="_blank"> ScrollViewProxy </a>的对象。这允许我们以编程方式控制用户在视图中滚动到的位置，并将用户发送到长视图中的特定位置。</p><p id="0b08" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了测试这一点，我想创建一个自定义的滚动控件，使用一个滑块来确定用户在ScrollView中的位置。用户可以拖动控制用户位置的滑块。</p><p id="2853" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">幸运的是，SwiftUI 2中的新视图允许我们这样做。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi la"><img src="../Images/d6790a5d7be3c04f3ed2161721808411.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/1*8fnApS1_lvGbzAsl_3Piag.gif"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">由滑块控制的滚动视图</figcaption></figure><p id="beec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要做到这一点，我们首先需要创建一些状态，作为当前滚动位置的真实来源。滚动位置和滑块值都使用CGFloat。</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="73a4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将用它来保持滑块和滚动位置的同步。</p><p id="7367" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，让我们添加复制示例所需的视图。</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="7f5b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们打开包装:</p><ol class=""><li id="346e" class="lh li it kd b ke kf ki kj km lj kq lk ku ll ky lm ln lo lp bi translated">在第2 行的<strong class="kd iu">上，将我们的<code class="fe lq lr ls lt b">scrollPosition</code>绑定传递给我们的滑块值。</strong></li><li id="7272" class="lh li it kd b ke lu ki lv km lw kq lx ku ly ky lm ln lo lp bi translated">在<strong class="kd iu">第3行</strong>中，添加我们的ScrollView，并将我们的其余内容嵌入其中。</li><li id="af91" class="lh li it kd b ke lu ki lv km lw kq lx ku ly ky lm ln lo lp bi translated">在<strong class="kd iu">第4行</strong>添加我们的<a class="ae kz" href="https://developer.apple.com/documentation/swiftui/scrollviewreader" rel="noopener ugc nofollow" target="_blank"> ScrollViewReader </a>。这是SwiftUI 2(在iOS 14中推出)中的一个新视图，它允许我们以编程方式滚动到ScrollView中的特定位置。这允许我们用一个<a class="ae kz" href="https://developer.apple.com/documentation/swiftui/scrollviewproxy" rel="noopener ugc nofollow" target="_blank"> ScrollViewProxy </a>来定义一个回调函数，它让我们可以访问<code class="fe lq lr ls lt b">scrollTo</code>方法。稍后会有更多相关内容…</li><li id="f0d3" class="lh li it kd b ke lu ki lv km lw kq lx ku ly ky lm ln lo lp bi translated">在<strong class="kd iu">第5行和第6行</strong>，我们正在定义文本视图，然后给它一个id。当我们使用<code class="fe lq lr ls lt b">scrollTo</code>时，我们需要这个id来识别视图。</li><li id="c1b3" class="lh li it kd b ke lu ki lv km lw kq lx ku ly ky lm ln lo lp bi translated">在第8行上，我们使用了新的<a class="ae kz" href="https://developer.apple.com/documentation/swiftui/windowgroup/onchange(of:perform:)" rel="noopener ugc nofollow" target="_blank"> onChange </a>方法，SwiftUI 2中也有介绍。这允许我们监听变化，并定义每次值变化时运行的回调。我们正在监听<code class="fe lq lr ls lt b">scrollPosition</code>的变化，正如在<strong class="kd iu">行2 </strong>中定义的那样，并由我们的滑块设置，然后滑块让我们访问回调中的新值。我将此定义为<code class="fe lq lr ls lt b">newScrollPosition</code>。</li><li id="ed5a" class="lh li it kd b ke lu ki lv km lw kq lx ku ly ky lm ln lo lp bi translated">在第9条线上，我们实际上使用的是T2方法。<code class="fe lq lr ls lt b">scrollTo</code>有两个参数，第一个是我们想要滚动到的条目的id。在这种情况下，我将id“text”传递给它，这与我们在第6行上给文本视图的id相同。如果在滚动视图中有多个项目(例如一个列表)，可以使用该参数滚动到特定的项目。第二个参数是可选的，允许您滚动到项目本身的特定位置。<br/>这在类型<code class="fe lq lr ls lt b">UnitPoint()</code>中定义，它有两个值，<code class="fe lq lr ls lt b">x</code>和<code class="fe lq lr ls lt b">y</code>。这两个值都需要一个<code class="fe lq lr ls lt b">CGFloat</code>，一个介于0.0和1.0之间的数字决定我们想要滚动到多远。在这种情况下，我们将把<code class="fe lq lr ls lt b">x</code>保留为0，因为我们不想水平滚动。然后我们将把<code class="fe lq lr ls lt b">y</code>设置为<code class="fe lq lr ls lt b">newScrollPosition</code>的值。</li></ol><p id="64b9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，每次更新<code class="fe lq lr ls lt b">scrollPosition</code>时，调用<code class="fe lq lr ls lt b">onChange</code>回调，其中<code class="fe lq lr ls lt b">newScrollPosition</code>包含新值。然后用这个新值调用<code class="fe lq lr ls lt b">scrollTo</code>，导致文本视图滚动位置移动。<code class="fe lq lr ls lt b">newScrollPosition</code>将是滑块的一个介于0.0和1.0之间的值，而<code class="fe lq lr ls lt b">UnitPoint()</code>也描述了视图滚动到相对于视图长度介于0.0和1.0之间的位置，因此它们完全匹配。</p><p id="1462" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是完整的代码:</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="60d4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意，你可以用任何东西来改变<code class="fe lq lr ls lt b">scrollPosition</code>。在我的例子中，我想做一个提词器应用程序，让文本随着时间滚动，所以我在一个定时器中调用了<code class="fe lq lr ls lt b">scrollTo</code>函数。</p><blockquote class="lz ma mb"><p id="7559" class="kb kc mc kd b ke kf kg kh ki kj kk kl md kn ko kp me kr ks kt mf kv kw kx ky im bi translated">不幸的是，没有办法从另一个方向读出<code class="fe lq lr ls lt b">scrollPosition</code>——如果它通过用户上下拖动视图而改变的话。例如，滑块不会对用户上下拖动文本视图做出响应。希望这在未来会有所改变。</p></blockquote></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="1000" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢阅读我的故事——欢迎在评论中留下任何问题，如果有用的话，请鼓掌！否则，请查看我的其他SwiftUI帖子:</p><ul class=""><li id="7586" class="lh li it kd b ke kf ki kj km lj kq lk ku ll ky mn ln lo lp bi translated"><a class="ae kz" href="https://medium.com/@samjwright/making-an-app-in-30-minutes-with-swiftui-602f15c299d4" rel="noopener">用SwiftUI在30分钟内制作一个app</a></li><li id="90ef" class="lh li it kd b ke lu ki lv km lw kq lx ku ly ky mn ln lo lp bi translated"><a class="ae kz" href="https://medium.com/@samjwright/firestore-to-swift-models-with-complex-types-enums-and-arrays-282893affb15" rel="noopener"> Firestore对象到Swift结构并返回，具有复杂的类型、枚举和数组</a></li></ul></div></div>    
</body>
</html>