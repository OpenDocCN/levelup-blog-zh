<html>
<head>
<title>Creating a PDF Viewer in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript创建PDF查看器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-a-pdf-viewer-in-javascript-9b988b5ec163?source=collection_archive---------0-----------------------#2019-11-16">https://levelup.gitconnected.com/creating-a-pdf-viewer-in-javascript-9b988b5ec163?source=collection_archive---------0-----------------------#2019-11-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="65b2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用PDF.js用Javascript创建PDF查看器</h2></div><p id="4dc3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">PDF.js是由Mozilla维护的JavaScript库，旨在用JavaScript处理PDF。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/94652fd61c02703e6f4e25492230507a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZZhQ2EZ3euxz36bmURYUA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">实施PDF js</figcaption></figure><p id="f816" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将创建一个具有以下功能的PDF查看器:</p><ol class=""><li id="3c7c" class="lr ls iq kh b ki kj kl km ko lt ks lu kw lv la lw lx ly lz bi translated">查看PDF</li><li id="4109" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la lw lx ly lz bi translated">转到下一页</li><li id="5245" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la lw lx ly lz bi translated">转到上一页</li><li id="c331" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la lw lx ly lz bi translated">转到特定页码</li></ol><p id="ee05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">先从<a class="ae mf" href="https://mozilla.github.io/pdf.js/" rel="noopener ugc nofollow" target="_blank">这里</a>下载PDF.js文件。</p><h2 id="d586" class="mg mh iq bd mi mj mk dn ml mm mn dp mo ko mp mq mr ks ms mt mu kw mv mw mx my bi translated">用于呈现PDF的HTML文件</h2><p id="13a1" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">创建一个新<code class="fe ne nf ng nh b">index.html</code>文件，在创建过程中:</p><ul class=""><li id="b863" class="lr ls iq kh b ki kj kl km ko lt ks lu kw lv la ni lx ly lz bi translated"><code class="fe ne nf ng nh b">canvas</code>→pdf将在哪里呈现。</li><li id="2606" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">上一页<code class="fe ne nf ng nh b">button</code> →转到上一页。</li><li id="92f3" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">下一页<code class="fe ne nf ng nh b">button</code> →进入下一页。</li><li id="2817" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated"><code class="fe ne nf ng nh b">input</code>框→输入页码。</li><li id="23c4" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">转到页面<code class="fe ne nf ng nh b">button</code> →按钮转到特定页面。</li><li id="4147" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">2 span元素→显示PDF的当前页码和总页数</li></ul><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h1 id="1fd2" class="nl mh iq bd mi nm nn no ml np nq nr mo jw ns jx mr jz nt ka mu kc nu kd mx nv bi translated">初始化用于呈现PDF的JavaScript文件</h1><p id="6d5a" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">除了<code class="fe ne nf ng nh b">index.html</code>文件，创建一个<code class="fe ne nf ng nh b">script.js</code>文件，我们在其中编写JavaScript代码来创建一个PDF查看器。</p><p id="8480" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先初始化变量:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="d6af" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在添加事件侦听器，以便在页面加载后处理PDF呈现器:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h1 id="09f1" class="nl mh iq bd mi nm nn no ml np nq nr mo jw ns jx mr jz nt ka mu kc nu kd mx nv bi translated">initPDFRenderer函数</h1><ul class=""><li id="af7e" class="lr ls iq kh b ki mz kl na ko nw ks nx kw ny la ni lx ly lz bi translated">我们需要用一个源PDF初始化PDF.js</li><li id="ee03" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">我们可以使用<code class="fe ne nf ng nh b">getDocument</code>方法得到一个承诺，该承诺可以分解为<code class="fe ne nf ng nh b">pdfData</code></li><li id="c90b" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">PDF数据有一个功能<code class="fe ne nf ng nh b">getPage</code></li><li id="a9b5" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated"><code class="fe ne nf ng nh b">getPage</code>将返回承诺</li><li id="e27f" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">一旦承诺得到解决，我们就得到页面数据</li><li id="58d3" class="lr ls iq kh b ki ma kl mb ko mc ks md kw me la ni lx ly lz bi translated">然后我们可以使用页面数据中的render方法在<code class="fe ne nf ng nh b">canvas</code>中对其进行渲染</li></ul><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="cf72" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在当我们调用<code class="fe ne nf ng nh b">initPdfRenderer</code>时，这会将<code class="fe ne nf ng nh b">pdfData</code>赋给<code class="fe ne nf ng nh b">pdf</code>变量。</p><h1 id="a2c1" class="nl mh iq bd mi nm nn no ml np nq nr mo jw ns jx mr jz nt ka mu kc nu kd mx nv bi translated">为分页按钮添加事件</h1><p id="64df" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">为<code class="fe ne nf ng nh b">previousButton</code>、<code class="fe ne nf ng nh b">nextButton</code>和<code class="fe ne nf ng nh b">goToPage</code>按钮添加事件。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h1 id="24f8" class="nl mh iq bd mi nm nn no ml np nq nr mo jw ns jx mr jz nt ka mu kc nu kd mx nv bi translated">renderPage函数</h1><p id="84d6" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">现在让我们创建一个<code class="fe ne nf ng nh b">renderPage</code>函数来将PDF页面呈现到画布上:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="48a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个获取<code class="fe ne nf ng nh b">pdfData</code>和渲染<code class="fe ne nf ng nh b">page</code>的方法。让我们写我们的<code class="fe ne nf ng nh b">pageRenderingQueue</code>。</p><p id="045d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果用户点击下一页/上一页，它将对<code class="fe ne nf ng nh b">currentPageNum</code>加/减1，并将其传递给<code class="fe ne nf ng nh b">renderPageQueue</code>方法。这将检查<code class="fe ne nf ng nh b">pageRenderingQueue</code>是否为<code class="fe ne nf ng nh b">null</code>。如果是<code class="fe ne nf ng nh b">null</code>，那么我们调用<code class="fe ne nf ng nh b">renderPage</code>方法，否则把要渲染的页码分配给队列。一旦页面渲染完成，它将检查<code class="fe ne nf ng nh b">pageQueue</code>是否为空，并在需要时执行相应的操作。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="2707" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创建一个<code class="fe ne nf ng nh b">renderNextPage</code>和<code class="fe ne nf ng nh b">renderPreviousPage</code>方法。<br/>如果用户点击“下一页”，做<code class="fe ne nf ng nh b">currentPageNum + 1</code>调用<code class="fe ne nf ng nh b">renderPage</code>。类似地，对于“上一页”，执行<code class="fe ne nf ng nh b">currentPageNum — 1</code>并调用<code class="fe ne nf ng nh b">renderPage</code>。我们还需要检查<code class="fe ne nf ng nh b">currentPageNum</code>是第一页还是最后一页。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="baf7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们实现“转到页码”功能。</p><p id="b3f1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从输入框中获取页码，然后检查该数字是否是有效数字，并调用<code class="fe ne nf ng nh b">renderPage</code>方法。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="49d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以最后的代码是:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="291a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读📖。我希望你喜欢这篇文章。如果你发现任何错别字或错误，给我发一封私信📝谢谢🙏 😊。</p><p id="7f57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关注我<a class="ae mf" href="https://medium.com/u/f9ffc26e7e69?source=post_page-----98efbae5e8aa----------------------" rel="noopener"> JavaScript Jeep🚙💨</a>。</p><p id="cd78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">请捐款</strong> <a class="ae mf" href="https://www.paypal.com/paypalme2/jagathishSaravanan" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">这里</strong> </a> <strong class="kh ir">。你捐款的98%都捐给了需要食物的人🥘。提前感谢。</strong></p></div></div>    
</body>
</html>