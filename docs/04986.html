<html>
<head>
<title>Baby’s First Web Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">婴儿的第一个Web组件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/babys-first-web-component-776067955342?source=collection_archive---------23-----------------------#2020-07-27">https://levelup.gitconnected.com/babys-first-web-component-776067955342?source=collection_archive---------23-----------------------#2020-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="ebf0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是我。我是宝贝。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2ee77d270d56c3d855c2b7ba8f9ea736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B1tdMdWqAC5i6HhOdS7LqQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">从<a class="ae le" href="https://icons8.com/" rel="noopener ugc nofollow" target="_blank">图标8 </a>到<a class="ae le" href="https://icons8.com/" rel="noopener ugc nofollow" target="_blank">图标8 </a>的插图</figcaption></figure><h1 id="e7f8" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">问题是</h1><p id="9e55" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在疫情实施几个月后，我们的交互设计团队创建了<a class="ae le" href="https://www.builderonline.com/coronavirus-construction-limits-state-by-state-tracker_s" rel="noopener ugc nofollow" target="_blank">冠状病毒建设限制各州跟踪器</a>:这是一个仪表板，可以跟踪各州如何对建筑和建筑材料供应商进行分类。显示该仪表板的页面没有使用我们内容管理系统(CMS)中的任何标准页面模板。因此，它需要一个自定义的分享栏，而不是我们文章页面上使用的Gigya powered分享栏。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mi"><img src="../Images/2e2bb3fa2e4ab80659f93ddc32741526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0YpWFNW3jw5htrmy2tqPgA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Builderonline.com<a class="ae le" href="https://www.builderonline.com/coronavirus-construction-limits-state-by-state-tracker_s" rel="noopener ugc nofollow" target="_blank">上的状态跟踪器</a></figcaption></figure><h1 id="69f9" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">第一种方法:创建一个即兴的社交分享吧</h1><p id="c490" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">我们的交互设计师需要一些HTML代码，她可以把这些代码放在页面上，而不需要我们进行代码部署。从头开始创建一个共享栏非常简单。</p><p id="0fc0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">所需工具:</strong></p><ul class=""><li id="4228" class="mj mk it js b jt ju jx jy kb ml kf mm kj mn kn mo mp mq mr bi translated">社交图标——我们已经在我们的网站上使用了<a class="ae le" href="https://fontawesome.com/" rel="noopener ugc nofollow" target="_blank">字体Awesome </a>,所以这只是一个将正确的CSS类应用到锚标签(即<code class="fe ms mt mu mv b">fa fa-facebook</code>)的问题</li><li id="463a" class="mj mk it js b jt mw jx mx kb my kf mz kj na kn mo mp mq mr bi translated">社交链接生成器——我指导我们的交互设计师去查看https://www.websiteplanet.com/webtools/sharelink/的<a class="ae le" href="https://www.websiteplanet.com/webtools/sharelink/" rel="noopener ugc nofollow" target="_blank">来生成合适的社交分享链接。</a></li></ul><p id="3f05" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果会是这样的:</p><pre class="kp kq kr ks gt nb mv nc nd aw ne bi"><span id="03ad" class="nf lg it mv b gy ng nh l ni nj">&lt;a href="<a class="ae le" href="https://www.facebook.com/sharer/sharer.php?u=https://www.builderonline.com/coronavirus-construction-limits-state-by-state-tracker_s" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/sharer/sharer.php?u=https://www.builderonline.com/coronavirus-construction-limits-state-by-state-tracker_s</a>"&gt;&lt;i class="fa fa-facebook"&gt;&amp;nbsp;&lt;/i&gt;&lt;/a&gt;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/0c49014998f97b5bba5a1d0b4fdf0d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*JPYGotSdGziu56WERQ9FEQ.png"/></div></figure><p id="5195" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="nl">巴达兵，巴达轰！</em> </strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nm"><img src="../Images/3ab78a4f7bb867afb2f202e5ab724e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ss1fB3dZ0enDtkt0N0Np8Q.png"/></div></div></figure><h1 id="f7f3" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">第二种方法:将共享栏创建为Web组件</h1><p id="87e9" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">嗯，我们在上面的方法中遇到了一个难题:这个页面是CMS中的一个单独的内容项，显示在<a class="ae le" href="https://www.jlconline.com/coronavirus-construction-limits-state-by-state-tracker" rel="noopener ugc nofollow" target="_blank">的多个网站上。我们如何让分享栏根据当前被浏览的站点使用适当的分享链接？</a></p><p id="93f0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">解决这个问题似乎是创建web组件的绝佳机会。</p><blockquote class="nn"><p id="32d1" class="no np it bd nq nr ns nt nu nv nw kn dk translated">Web Components是一套不同的技术，允许您创建可重用的自定义元素(将它们的功能封装在代码的其余部分之外)，并在您的Web应用程序中使用它们。<br/>-<a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components" rel="noopener ugc nofollow" target="_blank">developer.mozilla.org</a></p></blockquote><h2 id="a6b4" class="nf lg it bd lh nx ny dn ll nz oa dp lp kb ob oc lt kf od oe lx kj of og mb oh bi translated">为什么要使用Web组件？</h2><ul class=""><li id="55c6" class="mj mk it js b jt md jx me kb oi kf oj kj ok kn mo mp mq mr bi translated"><strong class="js iu">可重用性</strong> —使用一个web组件将允许我们只需要创建一次就可以在任何地方使用它。</li><li id="54b0" class="mj mk it js b jt mw jx mx kb my kf mz kj na kn mo mp mq mr bi translated"><strong class="js iu">封装</strong> —影子DOM允许我们操作web组件的标记、样式和行为，而不会影响页面上的主要代码。</li><li id="5ec0" class="mj mk it js b jt mw jx mx kb my kf mz kj na kn mo mp mq mr bi translated"><strong class="js iu">学习的机会</strong> —我将此视为学习如何创建web组件的机会，因为这将是一个简单的用例。</li></ul><h2 id="b8ee" class="nf lg it bd lh nx ol dn ll nz om dp lp kb on oc lt kf oo oe lx kj op og mb oh bi translated">我们如何实现Web组件？</h2><p id="1761" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">我首先需要定义我的元素，并让它扩展泛型<code class="fe ms mt mu mv b">HTMLElement</code>类:</p><pre class="kp kq kr ks gt nb mv nc nd aw ne bi"><span id="7353" class="nf lg it mv b gy ng nh l ni nj">&lt;script type="text/javascript"&gt;<br/>    class ShareElement extends HTMLElement {<br/>      constructor() {<br/>        super();<br/>      }<br/>}<br/>&lt;/script&gt;</span></pre><p id="ce8e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我定义了<code class="fe ms mt mu mv b">connectedCallbackMethod()</code>，它在每次组件被添加到页面时触发。</p><pre class="kp kq kr ks gt nb mv nc nd aw ne bi"><span id="63fb" class="nf lg it mv b gy ng nh l ni nj">connectedCallback() {        <br/>  // init the component        <br/>  let shadowDom = this.attachShadow({ mode: "open" });<br/>  ...<br/>}</span></pre><p id="ce61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在该方法中实现了以下内容:</p><p id="919d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">添加字体Awesome到阴影DOM </strong></p><p id="8285" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我立刻注意到字体Awesome CSS没有被带入shadow DOM。我很快就完成了这项工作，所以快速而肮脏的方法是从主DOM中检索字体Awesome <code class="fe ms mt mu mv b">link</code>元素，并将其插入到阴影DOM中。</p><pre class="kp kq kr ks gt nb mv nc nd aw ne bi"><span id="c291" class="nf lg it mv b gy ng nh l ni nj">const fontawesome = document.querySelector(‘link[href*=”fontawesome”]’); shadowDom.appendChild(fontawesome.cloneNode())</span></pre><p id="d803" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">造型锚标记颜色</strong></p><p id="96fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我只需要链接伪选择器<code class="fe ms mt mu mv b">:visited</code>和<code class="fe ms mt mu mv b">:hover</code>的几个样式，其余的样式我都懒的内联了。</p><pre class="kp kq kr ks gt nb mv nc nd aw ne bi"><span id="8d68" class="nf lg it mv b gy ng nh l ni nj">let style = document.createElement('style');<br/>style.textContent = ‘a,a:visited{color:#00aced}a:active,a:hover{color:#000}’;<br/>shadowDom.appendChild(style);</span></pre><p id="8ebb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">生成社交链接</strong></p><p id="8ac1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">记住，最大的问题是我们希望共享链接使用共享栏当前所在页面的URL。为了生成动态共享链接，我首先获取了当前的URL，</p><p id="2795" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ms mt mu mv b">const url = window.location.href;</code></p><p id="365d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后在适当的查询参数中将其添加到社交共享链接。</p><p id="ef34" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">脸书:<code class="fe ms mt mu mv b">“https://www.facebook.com/share.php?u=' + url<br/></code>推特:<code class="fe ms mt mu mv b">“https://twitter.com/intent/tweet?url='+ url</code></p><p id="3b40" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">适当调整弹出窗口的大小。</strong></p><p id="b4b6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我认为这是一个使用合理大小的弹出窗口的绝佳机会，所以我决定将大小设为500x500，并在它出现时将其置于屏幕中央:</p><pre class="kp kq kr ks gt nb mv nc nd aw ne bi"><span id="e676" class="nf lg it mv b gy ng nh l ni nj">shareLinks[i].addEventListener('click', function(e) {                  e.preventDefault();                <br/>const left = (screen.width/2)-250;                <br/>const top = (screen.height/2)-250;                <br/>window.open(<br/>this.href, <br/>'socialShareWin',                        <br/>'left=' + left + ',top=' + top + ',<br/>width=500,<br/>height=500,<br/>toolbar=1,<br/>resizable=0');                <br/>return false;              <br/>});</span></pre><p id="4791" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">最后，使用</strong>初始化组件</p><pre class="kp kq kr ks gt nb mv nc nd aw ne bi"><span id="1a74" class="nf lg it mv b gy ng nh l ni nj">customElements.define("hw-share", ShareElement);</span></pre><p id="186a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，我能够使用<br/> <code class="fe ms mt mu mv b">&lt;hw-share /&gt;</code>将我的定制元素添加到页面中。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/b541205db3092033c362f774b06438ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLKHI4HwM4vUGFr6JPXn8w.png"/></div></div></figure><p id="0077" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">完成下面的代码:</strong></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="or os l"/></div></figure></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="5d11" class="lf lg it bd lh li pa lk ll lm pb lo lp lq pc ls lt lu pd lw lx ly pe ma mb mc bi translated">结论</h1><p id="8e69" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">我在大约一个小时内完成了这个，因为交互团队尽快需要它，所以需要做一些改进。要学的东西太多了，比如<a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_templates_and_slots" rel="noopener ugc nofollow" target="_blank">模板和槽</a>以及剩下的<a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements#Using_the_lifecycle_callbacks" rel="noopener ugc nofollow" target="_blank">回调</a>，但是我很高兴我能够在这么短的时间内学到新的东西来解决一个问题。</p><p id="da1e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="nl">你对web组件的第一次体验是什么？</em> </strong></p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="7fed" class="lf lg it bd lh li pa lk ll lm pb lo lp lq pc ls lt lu pd lw lx ly pe ma mb mc bi translated">更多阅读</h1><ul class=""><li id="9f4c" class="mj mk it js b jt md jx me kb oi kf oj kj ok kn mo mp mq mr bi translated"><a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements" rel="noopener ugc nofollow" target="_blank">使用定制元素| MDN </a></li><li id="a841" class="mj mk it js b jt mw jx mx kb my kf mz kj na kn mo mp mq mr bi translated"><a class="ae le" href="https://coherent-labs.com/posts/web-components/" rel="noopener ugc nofollow" target="_blank">什么是Web组件？|连贯实验(教程)</a></li></ul></div></div>    
</body>
</html>