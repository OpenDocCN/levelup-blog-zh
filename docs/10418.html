<html>
<head>
<title>Working With Remote Docker Using Docker Context</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Docker上下文使用远程Docker</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/working-with-remote-docker-using-docker-context-4f7196c93b86?source=collection_archive---------8-----------------------#2021-12-02">https://levelup.gitconnected.com/working-with-remote-docker-using-docker-context-4f7196c93b86?source=collection_archive---------8-----------------------#2021-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4f19ecd176f5ded28ea98514e19de331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OygcXISlZmXYDKGz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Unsplash上<a class="ae kc" href="https://unsplash.com/@carrier_lost" rel="noopener ugc nofollow" target="_blank"> @carrier_lost </a>的照片</figcaption></figure><h1 id="d865" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">介绍</h1><p id="eb0c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这是一个使用docker上下文本地连接远程docker的备忘单。可能有助于您使用远程docker，而无需手动SSH到远程服务器。</p><h1 id="6028" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">添加上下文</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="83d6" class="mi ke iq me b gy mj mk l ml mm">$ docker context create my-remote-docker-machine --docker "host=ssh://username@host"</span><span id="91bd" class="mi ke iq me b gy mn mk l ml mm">my-remote-docker-machine</span><span id="c22d" class="mi ke iq me b gy mn mk l ml mm">Successfully created context "my-remote-docker-machine"</span></pre><p id="0bfb" class="pw-post-body-paragraph lb lc iq ld b le mo lg lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly ij bi translated">您也可以利用<code class="fe mt mu mv me b">SSH Config</code>文件连接到远程docker。尤其是当你需要定义你的<code class="fe mt mu mv me b">private key</code>或者<code class="fe mt mu mv me b">password</code>的时候。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="bf4d" class="mi ke iq me b gy mj mk l ml mm">$ cat ~/.ssh/config</span><span id="d021" class="mi ke iq me b gy mn mk l ml mm">Host my-remote-docker-machine</span><span id="4347" class="mi ke iq me b gy mn mk l ml mm">Hostname host</span><span id="0c53" class="mi ke iq me b gy mn mk l ml mm">User username</span><span id="7422" class="mi ke iq me b gy mn mk l ml mm">$ docker context create my-remote-docker-machine --docker "host=ssh://my-remote-docker-machine"</span></pre><p id="14bd" class="pw-post-body-paragraph lb lc iq ld b le mo lg lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly ij bi translated">除了<code class="fe mt mu mv me b">ssh</code>，如果您启用了<code class="fe mt mu mv me b">Docker API</code>，您还可以使用<code class="fe mt mu mv me b">tcp</code>协议添加您的上下文。</p><h1 id="583d" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">列出所有上下文</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="1042" class="mi ke iq me b gy mj mk l ml mm">$ docker context ls</span><span id="13c0" class="mi ke iq me b gy mn mk l ml mm">NAME                       DESCRIPTION                               DOCKER ENDPOINT               KUBERNETES ENDPOINT   ORCHESTRATOR</span><span id="2ce7" class="mi ke iq me b gy mn mk l ml mm">default *                  Current DOCKER_HOST based configuration   unix:///var/run/docker.sock                         swarm</span><span id="2d1c" class="mi ke iq me b gy mn mk l ml mm">my-remote-docker-machine                                             ssh://username@host</span></pre><h1 id="181e" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">使用上下文</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="db3e" class="mi ke iq me b gy mj mk l ml mm">$ docker --context my-remote-docker-machine images -q</span><span id="c3c3" class="mi ke iq me b gy mn mk l ml mm">65dadc9c7fe7</span><span id="eeb5" class="mi ke iq me b gy mn mk l ml mm">f814fce55133</span><span id="2d85" class="mi ke iq me b gy mn mk l ml mm">7a9b6da4328e</span><span id="8e60" class="mi ke iq me b gy mn mk l ml mm">33655f17f093</span><span id="e154" class="mi ke iq me b gy mn mk l ml mm">d120da10b040</span><span id="3d3c" class="mi ke iq me b gy mn mk l ml mm">6d6859d1a42a</span><span id="5f94" class="mi ke iq me b gy mn mk l ml mm">c19ae228f069</span></pre><h1 id="9cdd" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">将新上下文设置为默认值</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="45fd" class="mi ke iq me b gy mj mk l ml mm">$ docker context use my-remote-docker-machine</span><span id="85db" class="mi ke iq me b gy mn mk l ml mm">my-remote-docker-machine</span><span id="1fb7" class="mi ke iq me b gy mn mk l ml mm">Current context is now "my-remote-docker-machine"</span><span id="679c" class="mi ke iq me b gy mn mk l ml mm">$ docker context ls</span><span id="acfc" class="mi ke iq me b gy mn mk l ml mm">NAME                         DESCRIPTION                               DOCKER ENDPOINT               KUBERNETES ENDPOINT   ORCHESTRATOR</span><span id="8ff0" class="mi ke iq me b gy mn mk l ml mm">default                      Current DOCKER_HOST based configuration   unix:///var/run/docker.sock                         swarm</span><span id="71ff" class="mi ke iq me b gy mn mk l ml mm">my-remote-docker-machine *                                             ssh://username@host</span></pre><p id="67e0" class="pw-post-body-paragraph lb lc iq ld b le mo lg lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly ij bi translated">见<code class="fe mt mu mv me b">*</code>从<code class="fe mt mu mv me b">default</code>移动到<code class="fe mt mu mv me b">my-remote-docker-machine</code>。现在，您可以在没有<code class="fe mt mu mv me b">--context</code>标志的情况下使用docker命令。</p><h1 id="257d" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">删除上下文</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="f1f2" class="mi ke iq me b gy mj mk l ml mm">$ docker context use default # back to default</span><span id="d004" class="mi ke iq me b gy mn mk l ml mm">$ docker context rm my-remote-docker-machine</span><span id="c3bd" class="mi ke iq me b gy mn mk l ml mm">my-remote-docker-machine</span></pre><h1 id="b5f3" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结论</h1><p id="4c1b" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">使用docker上下文可能有助于避免手动SSH到远程服务器。但是，当使用远程docker在本地构建映像时，您需要考虑将上传/下载多少docker上下文。</p><p id="4f55" class="pw-post-body-paragraph lb lc iq ld b le mo lg lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly ij bi translated">感谢您的阅读！</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="73fc" class="pw-post-body-paragraph lb lc iq ld b le mo lg lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly ij bi translated"><em class="nd">最初发布于2021年12月2日</em><a class="ae kc" href="https://clavinjune.dev/en/blogs/working-with-remote-docker-using-docker-context/" rel="noopener ugc nofollow" target="_blank"><em class="nd">https://clavinjune . dev</em></a><em class="nd">。</em></p></div></div>    
</body>
</html>