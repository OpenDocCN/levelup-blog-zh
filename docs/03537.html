<html>
<head>
<title>JavaScript Best Practices for Writing More Robust Code — New Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写更健壮代码的JavaScript最佳实践—新特性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-best-practices-for-writing-more-robust-code-new-features-f5d426a93985?source=collection_archive---------12-----------------------#2020-05-14">https://levelup.gitconnected.com/javascript-best-practices-for-writing-more-robust-code-new-features-f5d426a93985?source=collection_archive---------12-----------------------#2020-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/10d25ef6bfb6d321384242daa37d2912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*76J0qPtc3EyybObZ"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@richardworks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">理查德·伯顿</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="296f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">JavaScript是一种简单易学的编程语言。编写运行并执行某些操作的程序很容易。然而，很难考虑所有的用例并编写健壮的JavaScript代码。</p><p id="5dbb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将了解如何向我们的应用程序添加填充和语言功能，以添加我们目标浏览器中没有内置的功能。</p><h1 id="f5e0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">多填充物</h1><p id="7e01" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">聚合填充对于使我们的客户端JavaScript代码健壮非常重要。聚合填充是添加浏览器可能不支持的功能的脚本。</p><p id="1e94" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它实现了浏览器可能还不支持的特定JavaScript APIs。我们针对的浏览器中没有的JavaScript标准库的一部分也需要polyfills。</p><p id="5c60" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们只是我们添加的库，就像其他库一样。例如，像Fetch API或网络信息API这样的API可能还不可用。</p><p id="8aa7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，我们希望使用它们，以便我们可以发出HTTP请求，分别添加一个额外的库或监视网络连接类型的变化。</p><p id="a950" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们需要为它们添加polyfills。如果我们需要为不支持获取API的浏览器添加对获取API的支持，那么我们需要按照<a class="ae kf" href="https://github.com/github/fetch" rel="noopener ugc nofollow" target="_blank">https://github.com/github/fetch</a>中的说明安装一个获取填充。</p><p id="00e1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果本地版本不可用，我们应该只使用polyfill版本，因为本地版本更快，因为它是内置在浏览器中的，而不是动态添加的。</p><p id="ac52" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，在https://www . npmjs . com/package/Network-Information-API-poly fill中有一个网络信息API polyfill，这样我们就可以在旧浏览器中使用网络信息API。</p><p id="9734" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">添加到浏览器全局对象的新功能，如<code class="fe mh mi mj mk b">Array</code>可能也需要多填充才能工作。</p><p id="a55c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们需要在IE中使用数组实例的<code class="fe mh mi mj mk b">find</code>方法，那么我们需要为它添加一个polyfill。它的脚本可以从<a class="ae kf" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Reference/Global _ Objects/Array/find</a>获得。</p><p id="6846" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还有<a class="ae kf" href="https://polyfill.io/v3/url-builder/" rel="noopener ugc nofollow" target="_blank">https://polyfill.io/v3/url-builder/</a>，这是一个一站式商店，提供我们需要的所有多种功能，为浏览器添加新的本地功能，这些功能可能是不可用的。</p><p id="51e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">音频和视频流访问等一些功能没有聚合填充，因为它们需要本机硬件支持。因此，如果我们的应用程序支持没有内置这些功能的旧浏览器，则需要在我们的应用程序中禁用这些功能。</p><h1 id="7f54" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">巴别塔编译器</h1><p id="fa0a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要添加许多浏览器不支持的新JavaScript功能，我们需要在浏览器中添加一个编译步骤，这样当我们在应用程序中使用新的JavaScript语言功能时，它会编译成与我们的目标浏览器兼容的代码。</p><p id="b537" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用Babel编译器来完成这项工作。除了实验性的特性之外，它还支持所有当前的特性。</p><p id="4887" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在生产应用程序中最好坚持使用当前的版本，因为实验性的版本可能会有突破性的变化。</p><p id="932f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将成为标准的更改处于第4阶段，这意味着它们肯定会作为标准添加到JavaScript语言中。</p><p id="fabf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有用的JavaScript特性将成为标准特性，如可选的链接操作符。</p><p id="7354" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有一个用Parcel编译的普通JavaScript，它已经和Babel一起提供了，那么我们可以通过运行以下命令来添加<code class="fe mh mi mj mk b">@babel/plugin-proposal-optional-chaining</code> Babel插件:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="5775" class="mt lf it mk b gy mu mv l mw mx">npm i @babel/plugin-proposal-optional-chaining</span></pre><p id="c880" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在项目的<code class="fe mh mi mj mk b">.babelrc</code>文件中，我们添加:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="b993" class="mt lf it mk b gy mu mv l mw mx">{<br/>  "plugins": [<br/>    "@babel/plugin-proposal-optional-chaining"<br/>  ]<br/>}</span></pre><p id="daba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以在JavaScript代码中使用它，添加:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="1f38" class="mt lf it mk b gy mu mv l mw mx">const foo = {};<br/>const x = foo?.bar?.baz;<br/>console.log(x);</span></pre><p id="d28d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Babel支持更多的特性，而不仅仅是可选的链接操作符。它也适用于Node.js和客户端JavaScript。</p><p id="75dc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Babel支持更多的JavaScript特性，大部分没有插件。像<code class="fe mh mi mj mk b">let</code>、<code class="fe mh mi mj mk b">const</code>、<code class="fe mh mi mj mk b">for...of</code>这样的特征，模块、地图、集合、符号、剩余和扩展运算符、析构等。都是巴别塔支持的。</p><p id="648b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以添加Babel作为遗留应用程序或原型的脚本，方法是添加:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="f6df" class="mt lf it mk b gy mu mv l mw mx">&lt;script src="https://unpkg.com/@babel/standalone/babel.min.js"&gt;&lt;/script&gt;</span></pre><p id="7750" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到我们的HTML。</p><p id="4ec7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，如果我们有一个将<code class="fe mh mi mj mk b">type</code>属性设置为<code class="fe mh mi mj mk b">text/babel</code>的脚本标签，那么我们可以添加现代的Javascript特性，而不用担心在旧浏览器中破坏应用程序。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/bacfb76401bfd46a56ca0607641da782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7fRJdjyNn6InyLzM"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">阿瑟·戈尔茨坦在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="0197" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="1833" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">聚合填充是为旧浏览器中可能不可用的功能添加支持的脚本。</p><p id="a905" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要添加我们的应用所针对的浏览器中可能没有的原生JavaScript特性，我们可以使用Babel编译器来添加对它们的支持。我们也可以添加巴别塔插件来支持更多的前沿功能。</p><p id="5597" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们可以通过使用Babel的脚本标签版本来动态编译现代JavaScript代码，并添加我们自己的脚本，将<code class="fe mh mi mj mk b">type</code>属性设置为<code class="fe mh mi mj mk b">text/babel</code>以添加对它的支持，而无需构建。</p></div></div>    
</body>
</html>