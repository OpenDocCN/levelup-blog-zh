<html>
<head>
<title>Higher Order Mapping Operators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高阶映射算子</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/higher-order-mapping-operators-62466243820a?source=collection_archive---------10-----------------------#2022-02-10">https://levelup.gitconnected.com/higher-order-mapping-operators-62466243820a?source=collection_archive---------10-----------------------#2022-02-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c376a875ca1b1f3ed07c641f62b9ae57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wYlddujMPBAlYtDDsw5QTg.gif"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">高阶算子的好处</figcaption></figure><p id="ee40" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">奇怪的是，好几年我都没有使用高阶映射运算符。因为我总是混淆“map”和“xMap ”, x可以替换为“switch”、“concat”、“flat”等等。我对RxJJ失去了兴趣，因为我不能驾驭库的许多操作者。</p><p id="0485" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在理解这个概念之前，我总是试图使用地图操作符来解决问题，我相信你们中的许多人正在经历相同的阶段。</p><p id="addc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这篇博客中，我将解释<strong class="ke ir">何时使用高阶映射操作符。这是探索RxJS </strong>原始世界的首要步骤。一旦你理解了这个概念，你将会使用更多的RxJS操作符，而不是依赖于一些操作符，比如map，distinctUntilChanged，interval，timer，filter等等。</p><p id="4c8d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以让我们开始吧。</p><p id="b785" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">假设我们正在调用一个服务，它将返回用户数据，如下所示。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi la"><img src="../Images/41c8e198a802ec2d1a0dac9639b2c29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*ZacA2pOa7DuyJ4pq5DMVbw.png"/></div></figure><p id="cc58" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这很简单，因为服务在内部调用HttpClient，我们从服务器获取数据。现在你的要求说，一旦获得用户，我们需要该用户写的博客。所以我们在这里使用映射操作符如下。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lf"><img src="../Images/ab8019425929c059500e81a4efdbd6ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ivS2_ek914K8jxP121Fgqw.png"/></div></div></figure><p id="3a17" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们在tap操作符中得不到数据。相反，我们在控制台中可以观察到。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/92a02537f95ca9dcfca4a2e1f533d5f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cWAMsFZSyylfShv1YkzvLw.png"/></div></div></figure><p id="323b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是怎么回事？在地图操作中，我们得到了用户，但在点击操作中，我们没有得到“博客”。</p><p id="51e1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">这种行为的原因是map操作符返回了你在map函数中返回的可观察值。</strong></p><p id="d24b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因此，如果你正在返回一些属性/对象的子集/另一个对象，如下图所示，那么map将返回它的可观察值。</p><pre class="lb lc ld le gt lh li lj lk aw ll bi"><span id="b9ec" class="lm ln iq li b gy lo lp l lq lr">this.data$ = this.service.getUser().pipe(<br/>map(user=&gt;user.name),// it will return observable of user.name tap(name=&gt;console.log('blog',name)));</span></pre><p id="173e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以当你在map函数中返回另一个可观测值时，它会返回那个可观测值的可观测值如下。</p><pre class="lb lc ld le gt lh li lj lk aw ll bi"><span id="6e0f" class="lm ln iq li b gy lo lp l lq lr">map(user=&gt;this.service.getBlogById(user.id)), // it will return observable of this.service.getBlogById(user.id) i.e. observable of observable</span></pre><p id="d31e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因此，当我们试图在tap操作符中记录数据时，我们得到了一个可观察的结果。因此，我们需要通过更高阶的操作符，如concatMap、switchMap、flatMap等，使其变平。如下图。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ls"><img src="../Images/00ec813ae146ffc0b973c8b27c17cc32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ItnmHoahC-jKOMw8Hd1ijw.png"/></div></div></figure><p id="5c0e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果我们看到console.log，如下所示。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/aa3eec860357f14703963fa2f637a27f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DoWrOBx8leHaTkqBIdLnOQ.png"/></div></div></figure><p id="b17b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">所以这个概念是，每当你需要在映射函数中返回可观测值时，你将不得不使用高阶算子来代替映射。</strong></p><p id="30d6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在大部分程序员都会在这里犯错。他们在getUser的subscribe中调用“getBlogById”方法。这是反模式的，因为它制造了回调地狱。什么是回调地狱以及如何避免它已经是另一个博客的一部分。可以参考这里。</p><p id="82c6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae lu" href="https://medium.com/@securepawank.kumawat/avoid-callback-hell-in-angular-code-3537890034b" rel="noopener">https://medium . com/@ securepawank . kuma wat/avoid-callback-hell-in-angular-code-3537890034 b</a></p><p id="5ff7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望这很清楚。如有任何疑问，请留下评论。</p><p id="8039" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">请一定要订阅/鼓掌/喜欢。这激励我写更多这样的博客。</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="2544" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我在Udemy上创建了一个Angular课程，涵盖了Angular中的许多实际问题和解决方案，包括这个。这可能是你职业生涯的垫脚石。 <a class="ae lu" href="https://www.udemy.com/course/angular-practicals/?couponCode=F48E50E6ECF6D99AD500" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"> <em class="mc">请看一看。</em> </strong> </a></p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/2b539648c9e52f6017ff625f8686ca95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zJn16C-dCeRj9UHE.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">角实践</figcaption></figure><p id="5e51" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">也可以观看/订阅我的免费<a class="ae lu" href="https://www.youtube.com/channel/UC30-Z9Lz8DWe_Vq93dOs-Gw" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"> YouTube频道</strong> </a> <strong class="ke ir">。</strong></p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="9b67" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">请订阅/关注/喜欢/鼓掌。</p></div></div>    
</body>
</html>