<html>
<head>
<title>Detect Your Cat’s Face with OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用OpenCV检测你的猫的脸</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/detect-your-cats-face-with-opencv-21893210737e?source=collection_archive---------2-----------------------#2022-07-30">https://levelup.gitconnected.com/detect-your-cats-face-with-opencv-21893210737e?source=collection_archive---------2-----------------------#2022-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="26f4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python中的OpenCV猫脸检测代码</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/78b12f63aa1f102647233451fbfa0cb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*bwZO4X7GU9wB3ok9UBE7Wg.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk translated">我的猫蒂姆，开放的关系，可爱的猫。</figcaption></figure><p id="db33" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用OpenCV的预训练级联分类器，可以轻松检测照片或视频中的猫脸。完成所有工作的小代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="4d87" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们一行一行地检查它:</p><ul class=""><li id="d29f" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">cv2库是<em class="ly">导入的</em>。</li></ul><p id="4812" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你还没装；</p><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="81e2" class="me mf iq ma b gy mg mh l mi mj">#install cv2<br/>pip install opencv-python<strong class="ma ir"><br/>#1</strong><br/>import cv2</span></pre><ul class=""><li id="869d" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated"><em class="ly">加载</em>级联分类器XML文件。</li></ul><p id="46b9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">OpenCV目录中有很多预先训练好的级联。还有一个(实际上是两个)是给猫的。你可以从<a class="ae mk" href="https://github.com/opencv/opencv/tree/4.x/data/haarcascades" rel="noopener ugc nofollow" target="_blank">这个地址下载文件。</a></p><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="cf4c" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#3</strong><br/>cascade = cv2.CascadeClassifier('haarcascade_frontalcatface.xml')</span></pre><h2 id="c40a" class="me mf iq bd ml mm mn dn mo mp mq dp mr la ms mt mu le mv mw mx li my mz na nb bi translated">级联分类器</h2><p id="ba7f" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">级联是一种集成学习方法，它是一种使用多个分类器来提高准确性的方法。第一个级联分类器是Viola和Jones (2001) 的面部检测器。对这种分类器的要求是快速的，以便在低功率CPU上实现，例如照相机和电话。</p><p id="2e98" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">级联是一种训练分类器的方法(分类器是一种机器学习算法，可以用来标记事物)，以便它们在一个链中一起工作。链中的第一个分类器是在数百张你试图检测的事物的“正面”图像和一堆不包含该事物的“负面”图像上训练的。然后，这个分类器可以应用于图像的一个区域，它会尝试检测这个东西。如果没有找到，它将移动到下一个区域，以此类推，直到它找到这个东西或者已经搜索了整个图像。这个过程最常用于面部检测和识别。</p><p id="93aa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该算法通过扫描图像并寻找与训练数据中匹配的Haar特征来工作。如果找到匹配，它会将该区域标记为人脸。如果没有找到匹配，它会将该区域标记为非人脸。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/4a1e5a5c84a6fdde2940270f7cd6fa58.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hbFPsfsCqV8rf1MV8b8p5w.jpeg"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk translated">哈尔特色。来源:<a class="ae mk" href="https://docs.opencv.org/3.4/db/d28/tutorial_cascade_classifier.html" rel="noopener ugc nofollow" target="_blank"> opencv </a></figcaption></figure><p id="5b22" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在整个图像中进行这种搜索是一项极其昂贵的工作。想想看，即使是24x24的图像也有160000个特征。因此，它使用积分图像，这是一种有效的方法来克服这一点。</p><p id="d1b2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">积分图像允许快速计算给定矩形下的像素总和，用于计算各种特征。这种方法比传统方法快得多，这使得它非常适合用于大型图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/6c04a6ad3db2999578260899578a47eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*eP24nmmkQ07BIe7PsHVQoQ.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk translated">长方形。</figcaption></figure><p id="6f5d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">1的值是A中像素的和.位置2的值是A和B的和.位置3: A+C .位置4 A+B+C+D . D的值是(4+1) — (2+3)。</p><p id="fda7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们得到这些特征(会有很多)后，我们需要对它们进行过滤，我们需要找出能告诉我们一些东西的特征。Adaboost是一种机器学习算法，有助于从大量特征中选择最佳特征。它通过关注与手头任务最相关的特性来做到这一点。</p><p id="15db" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将每个特征应用于训练图像，并获得正例和负例中提供的最佳阈值。选择在两个方向上误差率最低的特征。Adaboost的基本分类器很弱。但是当他们走到一起，他们就达到了一个强大的水平。通过将特征从160000个减少到6000个，实现了超级增益，但是还有更多。</p><p id="6bad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通常，与整个图像区域相比，包含人脸的区域非常小。所以，到处找还是效率不高。相反，在你的脸更可能出现在照片中的区域。</p><p id="05c6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">分类器级联是为了更有效地将所有特征应用于一个窗口而引入的概念。这些特征被分组到不同阶段的分类器中，并被逐一应用。如果窗口在第一阶段失败，则不考虑剩余的特征。如果通过，则应用特征的第二阶段，并继续该过程。通过所有阶段的窗口是面部区域。</p><ul class=""><li id="feb2" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">为了访问和读取从网络摄像头接收的数据，我们创建了一个视频捕获对象并传递了我们的设备号。VideoCapture类用于捕获视频。您可以传递视频文件的路径。</li></ul><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="d3ff" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#5</strong><br/>cap = cv2.VideoCapture(0)</span></pre><ul class=""><li id="a090" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">开始一个循环以确保连续的视频数据流。</li></ul><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="1a14" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#7</strong><br/>while True:</span></pre><ul class=""><li id="df42" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">VideoCapture对象(cap)读取、解码并返回下一帧视频。</li></ul><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="8de8" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#8</strong><br/>ret, img = cap.read()</span><span id="8662" class="me mf iq ma b gy nj mh l mi mj">#ret is True if there is a video data<br/>#img is the image</span></pre><ul class=""><li id="b88f" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">我们将接收到的图像转换为灰度，以最小化计算成本。</li></ul><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="0cbf" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#9</strong><br/>img_gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span></pre><ul class=""><li id="a499" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">现在，是时候在提供的图像帧中检测人脸了。我们将使用我们的级联。</li></ul><p id="75fa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ly"> detectMultiScale </em>方法检测给定图像中各种尺寸的物体。它接受灰度图像、比例因子、minNeighbors、minSize、maxSize。</p><p id="14f8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ly">比例因子</em>用于创建比例金字塔，这是一系列不同尺寸的图像，用于检测图像中不同尺寸的人脸。较小的比例因子会导致更彻底的人脸搜索，但速度较慢，而较大的比例因子会导致更快的搜索，但可能会错过一些人脸。</p><p id="c8be" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ly">邻居</em>参数指定每个候选矩形应该保留多少邻居。该参数将影响检测到的人脸的质量。值越高，检测次数越少，但质量越高。3~6是一个很好的值。</p><p id="df93" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ly">最小尺寸</em>确定被检测物体的阈值尺寸。而对于<em class="ly"> maxSize </em>，则反之。</p><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="25cc" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#10</strong><br/>faces = cascade.detectMultiScale(img_gray, 1.5, 5)</span></pre><ul class=""><li id="1273" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">在图像中的人脸周围绘制矩形。</li></ul><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="42c5" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#12-13-14-15</strong><br/>for (x,y,w,h) in faces: <br/>        cv2.rectangle(img,(x,y),(x+w,y+h),(255,255,0),2) <br/>        roi_gray = img_gray[y:y+h, x:x+w] <br/>        roi_color = img[y:y+h, x:x+w]</span></pre><ul class=""><li id="b14a" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">监听事件以结束程序。(在我们的例子中按下退出键)。</li></ul><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="bdd8" class="me mf iq ma b gy mg mh l mi mj"><strong class="ma ir">#19-20-21</strong><br/>k = cv2.waitKey(30) &amp; 0xff<br/>if k == 27: <br/>   break</span></pre><p id="cb0c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">结果是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/9c6f5f7c710b1c26fb69a78123d9133f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ir2bxZEHwlBEYeqcIxFpXA.png"/></div></div></figure><h2 id="9178" class="me mf iq bd ml mm mn dn mo mp mq dp mr la ms mt mu le mv mw mx li my mz na nb bi translated">阅读更多内容…</h2><div class="np nq gp gr nr ns"><a href="https://towardsdev.com/warping-an-objects-perspective-with-opencv-in-c-cbe971698ac5" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">用C++中的OpenCV扭曲对象的透视图</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">用C++中的OpenCV实现图像中物体的扭曲透视</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdev.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kl ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a href="https://medium.com/mlearning-ai/adaboost-from-scratch-f8979d961948" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">从头开始</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">AdaBoost算法的解释和实现</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kl ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a href="https://medium.com/@okanyenigun/what-is-a-voxel-and-how-to-display-them-5bc3a76521e5" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">什么是体素，如何显示它们？</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">oxels简介</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og kl ns"/></div></div></a></div><h2 id="61ee" class="me mf iq bd ml mm mn dn mo mp mq dp mr la ms mt mu le mv mw mx li my mz na nb bi translated">参考</h2><p id="7f08" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated"><a class="ae mk" href="https://docs.opencv.org/3.4/db/d28/tutorial_cascade_classifier.html" rel="noopener ugc nofollow" target="_blank">https://docs . opencv . org/3.4/db/d28/tutorial _ cascade _ classifier . html</a></p><p id="9573" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae mk" href="https://www.geeksforgeeks.org/detect-cat-faces-in-real-time-using-python-opencv/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/detect-cat-faces-in-real-time-using-python-opencv/</a></p><p id="ba32" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae mk" href="https://www.cs.cmu.edu/~efros/courses/LBMV07/Papers/viola-cvpr-01.pdf" rel="noopener ugc nofollow" target="_blank">https://www . cs . CMU . edu/~ efros/courses/lbmv 07/Papers/viola-cvpr-01 . pdf</a></p></div><div class="ab cl oj ok hu ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ij ik il im in"><h1 id="608a" class="oq mf iq bd ml or os ot mo ou ov ow mr jw ox jx mu jz oy ka mx kc oz kd na pa bi translated">分级编码</h1><p id="4198" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="574f" class="lp lq iq kt b ku kv kx ky la lr le ls li lt lm lu lv lw lx bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="0af6" class="lp lq iq kt b ku pb kx pc la pd le pe li pf lm lu lv lw lx bi translated">📰查看<a class="ae mk" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="efc9" class="lp lq iq kt b ku pb kx pc la pd le pe li pf lm lu lv lw lx bi translated">🔔关注我们:<a class="ae mk" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae mk" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae mk" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="7a91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">🚀👉<a class="ae mk" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>