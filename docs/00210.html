<html>
<head>
<title>Python — Reading and Writing Data from Files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python从文件中读取和写入数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-reading-and-writing-data-from-files-d3b70441416e?source=collection_archive---------2-----------------------#2018-09-10">https://levelup.gitconnected.com/python-reading-and-writing-data-from-files-d3b70441416e?source=collection_archive---------2-----------------------#2018-09-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7778" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">先决条件:任何编程语言和不同文件格式存储数据的基础知识。我们将探讨如何从csv、excel、JSON、html和xml等不同文件中读取数据。</em></p><p id="316a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Jupyter笔记本可以在这里找到</strong><a class="ae kp" href="https://github.com/arshren/Reading-Files/blob/master/Python%20-%20Reading%20Files%20.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="js iu"/></a></p><p id="6e8d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">作为机器学习的第一步，我们需要知道从文件中读取数据进行数据分析。我们可以接收数据的不同类型的文件格式可以是:</p><ul class=""><li id="7c60" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn kv kw kx ky bi translated">CSV —逗号分隔文件</li><li id="30ef" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">XLS — Excel文件</li><li id="702c" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">JSON —以JSON格式存储的数据</li><li id="4674" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">HTML —超文本标记语言文件</li></ul><p id="64cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将首先从Python的内置文件对象开始，然后深入研究如何使用pandas库读取不同类型的文件。</p><p id="f734" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们从创建一个文件开始，将数据写入文件，然后读取文件。此外，我们不要忘记关闭文件。</p><h1 id="def3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用Python的File对象的文件操作</h1><p id="e39b" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">我们将使用一个file对象，我们将向它传递两个参数——filename和我们希望对文件进行操作的模式——就像您希望打开文件进行读取、写入或追加一样。</p><p id="c65f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">【打开(文件名，模式)</em> </strong></p><p id="8a97" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不同的模式有</p><ul class=""><li id="8bb1" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn kv kw kx ky bi translated"><strong class="js iu"> w </strong>:文件将以只写模式打开。如果文件以“w”模式打开，并且文件已经存在，则现有文件的内容将被覆盖</li><li id="9fa4" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated"><strong class="js iu"> r </strong>:文件将以只读模式打开。这是默认模式</li><li id="1fe2" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated"><strong class="js iu"> a </strong>:文件将以追加模式打开，数据将被写入文件末尾</li><li id="30b7" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated"><strong class="js iu"> r+ </strong>:文件将以读写模式打开</li></ul><p id="9a87" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">文件类型—文本和二进制</strong></p><p id="a1ca" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">默认情况下，文件以文本模式打开，这允许您以文本字符串的形式读写数据。</p><p id="350d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想在二进制模式下打开文件，那么在模式后面加上“<strong class="js iu"> b </strong>”。</p><p id="7f74" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">以只写模式打开文件</strong></p><p id="9218" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以只写模式打开“file_1.txt”。如果文件不存在，它将创建一个，如果文件已经存在，其内容将被覆盖。总是确保关闭文件</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="09e9" class="mq lf it mm b gy mr ms l mt mu">file = open("file_1.txt", "w")<br/>file.write("This a test write\n")<br/>file.close()</span></pre><p id="53ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">既然我们已经写入了数据，我们将读取文件的内容。</p><p id="fcd5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">以只读模式读取文件</strong></p><p id="328d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">readline()从文件中读取一行</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="dc10" class="mq lf it mm b gy mr ms l mt mu">file = open("file_1.txt", "r")<br/>str1 = file.readline()<br/>print(str1)<br/>file.close()</span><span id="560e" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">This a test write</em></strong></span></pre><p id="cde9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">在追加模式下写入文件</strong></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="3c3c" class="mq lf it mm b gy mr ms l mt mu">file = open("file_1.txt", "a")<br/>file.write("This should be written at the end of the file\n")<br/>file.close()</span></pre><p id="8e62" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">以“r+”模式打开文件并读取其所有内容</strong></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="438a" class="mq lf it mm b gy mr ms l mt mu">file = open("file_1.txt", "r+")<br/>for str1 in file.readlines():<br/>    print(str1)<br/>file.close()</span><span id="1613" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">This a test write<br/><br/>This should be written at the end of the file</em></strong></span></pre><p id="99b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">用</strong> <code class="fe mw mx my mm b"><strong class="js iu">with</strong></code> <strong class="js iu">语句</strong>读取文件</p><p id="d022" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mw mx my mm b"><strong class="js iu">with</strong></code> <strong class="js iu"> </strong>是一种更简洁的处理文件对象的方式，因为它处理异常。<code class="fe mw mx my mm b"><strong class="js iu">with</strong></code> <strong class="js iu"> </strong>语句自动打开和关闭文件，因此您无需记住关闭文件。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="d89d" class="mq lf it mm b gy mr ms l mt mu">with open("file_1.txt") as file:<br/>    print(file.readlines())</span><span id="69d6" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">['This a test write\n', 'This should be written at the end of the file\n']</em></strong></span></pre><p id="7358" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们也可以使用带语句的<code class="fe mw mx my mm b">the</code>将数据写入文件。由于我们使用了“w”模式，现有文件内容将被覆盖。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="86a2" class="mq lf it mm b gy mr ms l mt mu">with open("file_1.txt", "w") as file:<br/>    file.write("This is a with statement")<br/>    <br/>with open("file_1.txt", "r") as file:    <br/>    print(file.readlines())</span><span id="0043" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">['This is a with statement']</em></strong></span></pre><p id="64fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">我们现在将使用pandas库来读取一个逗号分隔值(csv)文件。</em></p><h1 id="3afe" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">写入csv文件和从csv文件读取</h1><p id="83bc" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">我们将首先在名为data的字典中创建一些数据</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9b9f" class="mq lf it mm b gy mr ms l mt mu">data ={"Name":['Jack', 'Jill', 'Em', 'David'],<br/>           "Profession":['Manager', 'Analyst', 'Data scientist', 'VP'],<br/>           "Experience":[10,5,2,20],<br/>           "Education":['MBA', 'BS', 'MS','MBA']}<br/>data</span><span id="9e3c" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">{'Education': ['MBA', 'BS', 'MS', 'MBA'],<br/> 'Experience': [10, 5, 2, 20],<br/> 'Name': ['Jack', 'Jill', 'Em', 'David'],<br/> 'Profession': ['Manager', 'Analyst', 'Data scientist', 'VP']}</em></strong><br/></span></pre><p id="a452" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将从字典中创建一个数据帧“df”，然后将数据帧中的数据写入一个csv文件——“EMP . CSV”。</p><p id="8f30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了创建一个数据框架，我们需要首先导入pandas库。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="4f5b" class="mq lf it mm b gy mr ms l mt mu">import pandas as pd<br/>df = pd.DataFrame(data)</span><span id="7780" class="mq lf it mm b gy mv ms l mt mu">df.to_csv("emp.csv")</span></pre><p id="bc50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">csv文件将在您的默认Jupyter目录中创建。要知道默认目录，使用<strong class="js iu"> pwd </strong>(打印工作目录和)就可以找到新文件“emp.csv”</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="7e56" class="mq lf it mm b gy mr ms l mt mu">pwd</span></pre><p id="0373" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们已经将数据写入了csv文件，让我们从emp.csv文件中读取数据</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="77e1" class="mq lf it mm b gy mr ms l mt mu">csv_data = pd.read_csv("emp.csv")<br/>csv_data</span></pre><figure class="mh mi mj mk gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mz"><img src="../Images/275e355948aa66186b78a6e02e17c1af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bcr-IcKZiWbnE_zCF_i8Yg.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">CSV _ data—EMP . CSV文件中的数据</figcaption></figure><p id="42a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">csv_data的数据类型是数据帧。所以我们可以使用所有的数据帧操作。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="208a" class="mq lf it mm b gy mr ms l mt mu">type(csv_data)</span><span id="baa0" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">pandas.core.frame.DataFrame</em></strong></span></pre><p id="c460" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">了解更多关于<a class="ae kp" href="https://medium.com/@arshren/python-data-structures-dataframe-888fef6872bf" rel="noopener">数据框</a>和<a class="ae kp" href="https://medium.com/@arshren/python-data-structures-dictionary-9b746b94b421" rel="noopener">字典</a>的信息。</p><h1 id="89f4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">写入excel文件和从excel文件读取</h1><p id="9b31" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">在这里，我们将使用相同的df数据帧将数据写入excel文件中的工作表名“employee_name”</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="b2a5" class="mq lf it mm b gy mr ms l mt mu">df.to_excel("emp_1.xls",sheet_name ="employee_data")</span></pre><figure class="mh mi mj mk gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nl"><img src="../Images/8cc99c11ca942c19573feccafc04367f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eBWBPhXWpPhJz3uumrcsRQ.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">工作表名称为employee_data的Excel文件</figcaption></figure><p id="f18a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们将excel文件emp1.xls工作表名称“employee_data”中的数据读入数据框架xls_data。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="4232" class="mq lf it mm b gy mr ms l mt mu">xls_data = pd.read_excel("emp_1.xls", sheetname="employee_data")<br/>xls_data</span></pre><figure class="mh mi mj mk gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nm"><img src="../Images/00526aabb2b8a51e5d7783b5e43d495f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RLCMiiNVUr_4LBUpe4qHlg.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">数据帧xls_data</figcaption></figure><h1 id="da7c" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">将数据写入JSON文件</h1><p id="8f87" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">这里，我们将使用相同的数据帧df写入json文件</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9ff8" class="mq lf it mm b gy mr ms l mt mu">df.to_json('emp.json')</span></pre><p id="977a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">emp.json文件的内容</p><p id="04e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko"> { "学历":{"0":"MBA "，" 1":"BS "，" 2":"MS "，" 3":"MBA"}，"经历":{"0":10，" 1":5，" 2":2，" 3":20}，"姓名":{"0":"Jack "，" 1":"Jill "，" 2":"Em "，" 3":"David"}，"职业":{"0 ":"经理"，" 1 ":"分析师"，" 2 ":"数据科学家"，" 3:" " VP " }。</em></strong></p><p id="3f6e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们已经将数据写入了json文件，让我们来读取数据</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="c111" class="mq lf it mm b gy mr ms l mt mu">emp= pd.read_json("emp.json")<br/>emp</span></pre><figure class="mh mi mj mk gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nm"><img src="../Images/00526aabb2b8a51e5d7783b5e43d495f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RLCMiiNVUr_4LBUpe4qHlg.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">通过读取json文件创建的DataFrame emp</figcaption></figure><p id="7f54" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您有一个json对象，那么我们可以使用<strong class="js iu"> json.loads() </strong>将内容放入一个列表，然后使用列表的所有操作进行数据操作。</p><p id="1d85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">阅读此处以操作<a class="ae kp" href="https://medium.com/@arshren/python-data-structures-list-9131e7386c8d" rel="noopener">列表</a></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="49e2" class="mq lf it mm b gy mr ms l mt mu">area_json ="""<br/>{ "office": <br/>    {"medical": [<br/>      { "room-number": 100,<br/>        "use": "reception",<br/>        "sq-ft": 50,<br/>        "price": 75<br/>      },<br/>      { "room-number": 101,<br/>        "use": "waiting",<br/>        "sq-ft": 250,<br/>        "price": 75<br/>      },<br/>      { "room-number": 102,<br/>        "use": "examination",<br/>        "sq-ft": 125,<br/>        "price": 150<br/>      },<br/>      { "room-number": 103,<br/>        "use": "examination",<br/>        "sq-ft": 125,<br/>        "price": 150<br/>      },<br/>      { "room-number": 104,<br/>        "use": "office",<br/>        "sq-ft": 150,<br/>        "price": 100<br/>      }<br/>    ]},<br/>    "parking": {<br/>      "location": "premium",<br/>      "style": "covered",<br/>      "price": 750<br/>    }<br/>} <br/>"""<br/>home_data = json.loads(area_json)<br/>home_data</span><span id="a051" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">{'office': {'medical': [{'price': 75,<br/>    'room-number': 100,<br/>    'sq-ft': 50,<br/>    'use': 'reception'},<br/>   {'price': 75, 'room-number': 101, 'sq-ft': 250, 'use': 'waiting'},<br/>   {'price': 150, 'room-number': 102, 'sq-ft': 125, 'use': 'examination'},<br/>   {'price': 150, 'room-number': 103, 'sq-ft': 125, 'use': 'examination'},<br/>   {'price': 100, 'room-number': 104, 'sq-ft': 150, 'use': 'office'}]},<br/> 'parking': {'location': 'premium', 'price': 750, 'style': 'covered'}}</em></strong></span></pre><p id="9dc6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们也可以使用python数据并转储到json对象中。</p><p id="f7d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们将使用我们之前创建的数据字典，并作为json数据转储。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="ad55" class="mq lf it mm b gy mr ms l mt mu">json_data = json.dumps(data)<br/>json_data</span><span id="5945" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">'{"Name": ["Jack", "Jill", "Em", "David"], "Profession": ["Manager", "Analyst", "Data scientist", "VP"], "Experience": [10, 5, 2, 20], "Education": ["MBA", "BS", "MS", "MBA"]}'</em></strong></span></pre><h1 id="7948" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从URL检索数据</h1><p id="20e7" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">我们将使用两个库来从URL中检索数据— <strong class="js iu"> request </strong>和<strong class="js iu"> beautifulsoup </strong>。我们还会用<code class="fe mw mx my mm b"><strong class="js iu">re</strong></code> <strong class="js iu"> </strong>来使用正则表达式。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5fdb" class="mq lf it mm b gy mr ms l mt mu">import requests<br/>import re<br/>from bs4 import BeautifulSoup</span></pre><p id="5ce2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用我在medium上发表的一篇文章中的一个url来检索文本。我们使用<code class="fe mw mx my mm b"><strong class="js iu">get</strong></code> <strong class="js iu"> </strong>的方法请求库下载页面。<code class="fe mw mx my mm b">response</code>现在会有网页的内容。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9254" class="mq lf it mm b gy mr ms l mt mu">url = "<a class="ae kp" href="https://medium.com/@arshren/power-of-habit-how-to-accomplishing-big-goals-by-making-small-changes-5872a788fcb8" rel="noopener">https://medium.com/@arshren/power-of-habit-how-to-accomplishing-big-goals-by-making-small-changes-5872a788fcb8</a>"<br/>response = requests.get(url)</span></pre><p id="13ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mw mx my mm b">response.content</code>将包含html页面的内容。</p><p id="2766" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用<code class="fe mw mx my mm b">Beautifulsoup</code>构造函数并传递我们在response.content中的html内容</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5095" class="mq lf it mm b gy mr ms l mt mu">soup = BeautifulSoup(response.content,'html.parser')</span></pre><p id="eba8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在将使用<code class="fe mw mx my mm b">find</code>方法提取标题，然后使用<code class="fe mw mx my mm b">get_text</code>提取标题。</p><p id="49a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们在html页面中找到所有“p”标签，其class属性包含类似“graf graf — p”的文本。这里我们使用正则表达式，因为我们想找到p标签的类属性，其值类似于“graf graf-p”</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="1650" class="mq lf it mm b gy mr ms l mt mu">title  = soup.find('title').get_text()<br/>any_data = soup.find_all('p', class_=re.compile("graf graf--p"))</span></pre><p id="ab01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在将遍历<code class="fe mw mx my mm b">any_data</code>，这是bs4的结果集</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="0950" class="mq lf it mm b gy mr ms l mt mu">print(title)</span><span id="d596" class="mq lf it mm b gy mv ms l mt mu">for p in any_data:<br/>   print(p.get_text())</span><span id="1e65" class="mq lf it mm b gy mv ms l mt mu"><strong class="mm iu"><em class="ko">Power of Habit — How to accomplish big goals by making small changes<br/>Photo by Vidar Nordli-Mathisen on Unsplash<br/>You might have heard that a 1000 mile journey begins one step at a time. I also used to be temporarily inspired by such quotes. But a few days would pass, and I would find it had slipped my mind.<br/>Are you wanting to change things in your life?<br/>Are you stuck in the same old circumstances and feel a need to change?<br/>Do you want to meet a happy version of yourself in future?<br/>Then read on…</em></strong></span></pre></div></div>    
</body>
</html>