<html>
<head>
<title>Build and Deploy a Serverless GraphQL React App Using AWS Amplify</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS Amplify构建和部署一个无服务器的GraphQL React应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-and-deploy-a-serverless-graphql-react-app-using-aws-amplify-83eb8c21de27?source=collection_archive---------8-----------------------#2021-05-07">https://levelup.gitconnected.com/build-and-deploy-a-serverless-graphql-react-app-using-aws-amplify-83eb8c21de27?source=collection_archive---------8-----------------------#2021-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f85a06b0e43129e32dbc1601f8b2d7f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BaZQcBVFiV5O4OZDA6Fs5w.jpeg"/></div></div></figure><p id="4682" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最近我发现一些SaaS(软件即服务)产品使用<a class="ae kw" href="https://aws.amazon.com/amplify/" rel="noopener ugc nofollow" target="_blank"> AWS放大</a>，这有助于他们构建无服务器的全栈应用。我认为<a class="ae kw" href="https://www.cloudflare.com/learning/serverless/why-use-serverless/" rel="noopener ugc nofollow" target="_blank">无服务器计算</a>将是应用和软件的未来。因此，我想收集一些实践经验，我使用AWS Amplify构建了一个无服务器应用程序，它使用React作为前端框架，使用GraphQL作为后端API。</p><p id="d0c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我想指导您如何构建和部署这样一个Amplify应用程序。</p><h1 id="06ca" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">设置放大器</h1><p id="1268" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated"><a class="ae kw" href="https://aws.amazon.com/amplify/" rel="noopener ugc nofollow" target="_blank"> AWS Amplify </a>将自己描述为:</p><blockquote class="ma mb mc"><p id="4fa9" class="jy jz md ka b kb kc kd ke kf kg kh ki me kk kl km mf ko kp kq mg ks kt ku kv ij bi translated"><em class="iq">构建可扩展的移动和网络应用的最快、最简单的方法</em></p></blockquote><p id="a9d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Amplify提供工具和服务来构建由<a class="ae kw" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS (Amazon Web Services) </a>支持的可扩展全栈应用。有了Amplify，配置后端和部署静态web应用变得很容易。它支持web框架，如Angular、React、Vue、JavaScript、Next.js，以及移动平台，包括iOS、Android、React Native、Ionic和Flutter。</p><p id="5d9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要<a class="ae kw" href="https://portal.aws.amazon.com/billing/signup?redirect_url=https%3A%2F%2Faws.amazon.com%2Fregistration-confirmation#/start" rel="noopener ugc nofollow" target="_blank">创建一个AWS帐户</a>来执行以下步骤。不用担心，注册后，您可以访问AWS免费层，其中不包括任何前期费用或期限承诺。</p><p id="a801" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下一步是安装Amplify命令行界面(CLI)。我在macOS上使用cURL:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="f26b" class="mq ky iq mm b gy mr ms l mt mu">curl -sL https://aws-amplify.github.io/amplify-cli/install | bash &amp;&amp; $SHELL</span></pre><p id="898c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者，您可以观看此视频来了解如何安装和配置Amplify CLI。</p><p id="a1c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们可以使用CLI配置Amplify</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="bbe8" class="mq ky iq mm b gy mr ms l mt mu">amplify configure</span></pre><p id="1e34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将要求我们登录到AWS控制台。登录后，Amplify CLI将要求我们创建一个<a class="ae kw" href="https://aws.amazon.com/iam/" rel="noopener ugc nofollow" target="_blank"> AWS IAM </a>用户:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5527" class="mq ky iq mm b gy mr ms l mt mu">Specify the AWS Region <br/>? region: # Your preferred region<br/>Specify the username of the new IAM user: <br/>? user name: # User name for Amplify IAM user<br/>Complete the user creation using the AWS console</span></pre><p id="90ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将被重定向到IAM，在这里我们需要完成向导并创建一个帐户中有<code class="fe mv mw mx mm b">AdministratorAccess</code>的用户来配置AWS资源。创建用户后，Amplify CLI将要求我们提供<code class="fe mv mw mx mm b">accessKeyId</code>和<code class="fe mv mw mx mm b">secretAccessKey</code>来连接Amplify CLI和我们创建的IAM用户:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="aeb8" class="mq ky iq mm b gy mr ms l mt mu">Enter the access key of the newly created user: <br/>? accessKeyId: # YOUR_ACCESS_KEY_ID<br/>? secretAccessKey: # YOUR_SECRET_ACCESS_KEY<br/>This would update/create the AWS Profile in your local machine  <br/>? Profile Name: # (default)</span><span id="3a56" class="mq ky iq mm b gy my ms l mt mu">Successfully set up the new user.</span></pre><h1 id="be3b" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">建立全栈放大器项目</h1><p id="7d37" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">此时，我们已经准备好使用前端的<a class="ae kw" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>应用程序和后端的<a class="ae kw" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank">graph QL</a>API来设置我们的全栈项目。我们将构建一个使用该架构的Todo CRUD(创建、读取、更新、删除)应用程序:</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/0497383ba6abe56780ca7b0eae5ed74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*8IAlNEBxdHE4nXdv.jpg"/></div></figure><p id="829d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该演示的完整源代码可从<a class="ae kw" href="https://github.com/Mokkapps/amplify-react-graphql-todo-demo/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>获得。</p><p id="90f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从使用<a class="ae kw" href="https://reactjs.org/docs/create-a-new-react-app.html" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>创建一个新的React应用程序开始。从我们的项目目录中，我们运行以下命令，在名为<code class="fe mv mw mx mm b">amplify-react-graphql-demo</code>的目录中创建新的React应用程序，并导航到该新目录:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="f2d6" class="mq ky iq mm b gy mr ms l mt mu">&gt; npx create-react-app amplify-react-graphql-demo <br/>&gt; cd amplify-react-graphql-demo</span></pre><p id="7b02" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要启动React应用程序，我们可以运行</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="c3e6" class="mq ky iq mm b gy mr ms l mt mu">npm start</span></pre><p id="dc82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在<code class="fe mv mw mx mm b"><a class="ae kw" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code> <a class="ae kw" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank">启动开发服务器。</a></p><p id="6b07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是时候在我们的项目中初始化Amplify了。从我们运行的项目的根开始</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5e80" class="mq ky iq mm b gy mr ms l mt mu">amplify init</span></pre><p id="b0b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将提示一些关于应用程序的信息:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="09be" class="mq ky iq mm b gy mr ms l mt mu">▶ amplify init<br/>? Enter a name for the project amplifyreactdemo<br/>The following configuration will be applied:<br/><br/>Project information<br/>| Name: amplifyreactdemo<br/>| Environment: dev<br/>| Default editor: Visual Studio Code<br/>| App type: javascript<br/>| Javascript framework: react<br/>| Source Directory Path: src<br/>| Distribution Directory Path: build<br/>| Build Command: npm run-script build<br/>| Start Command: npm run-script start<br/><br/>? Initialize the project with the above configuration? Yes<br/>Using default provider  awscloudformation<br/>? Select the authentication method you want to use: AWS profile<br/>? Please choose the profile you want to use: default</span></pre><p id="b177" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们新的Amplify项目初始化时，CLI:</p><ul class=""><li id="6d2a" class="na nb iq ka b kb kc kf kg kj nc kn nd kr ne kv nf ng nh ni bi translated">在src目录中创建了一个名为<code class="fe mv mw mx mm b">aws-exports.js</code>的文件，保存了我们用Amplify创建的服务的所有配置</li><li id="4473" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated">创建了一个名为<code class="fe mv mw mx mm b">amplify</code>的顶级目录，其中包含我们的后端定义</li><li id="55ad" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated">修改了<code class="fe mv mw mx mm b">.gitignore</code>文件并将一些生成的文件添加到忽略列表中</li></ul><p id="5baa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，在<a class="ae kw" href="https://docs.aws.amazon.com/amplify/latest/userguide/welcome.html" rel="noopener ugc nofollow" target="_blank"> AWS Amplify控制台</a>中创建了一个新的云项目，可以通过运行<code class="fe mv mw mx mm b">amplify console</code>来访问。Amplify控制台提供两个主要服务:主机和管理用户界面。更多信息可以在<a class="ae kw" href="https://docs.aws.amazon.com/amplify/latest/userguide/welcome.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="9429" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下一步是安装一些放大器库:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="f6e3" class="mq ky iq mm b gy mr ms l mt mu">npm install aws-amplify @aws-amplify/ui-react typescript</span></pre><ul class=""><li id="48e4" class="na nb iq ka b kb kc kf kg kj nc kn nd kr ne kv nf ng nh ni bi translated"><code class="fe mv mw mx mm b">aws-amplify</code>:在应用程序中使用Amplify的主库</li><li id="ca3f" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><code class="fe mv mw mx mm b">@aws-amplify/ui-react</code>:包含React特定的UI组件</li><li id="bbd8" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><code class="fe mv mw mx mm b">typescript</code>:我们将在本演示的某些部分使用<a class="ae kw" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">类型脚本</a></li></ul><p id="82b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们需要在客户端配置Amplify。因此，我们需要在<code class="fe mv mw mx mm b">src/index.js</code>中的最后一次导入下面添加以下代码:</p><p id="f9f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，我们已经有了一个正在运行的React前端应用程序，Amplify已经配置好，现在我们可以添加我们的GraphQL API了。</p><p id="c82a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在将创建一个后端，使用AWS AppSync(一个托管的GraphQL服务)提供一个GraphQL API，它使用Amazon DynamoDB(一个NoSQL数据库)。</p><p id="3bc0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要添加新的API，我们需要在项目的根文件夹中运行以下命令:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="ce45" class="mq ky iq mm b gy mr ms l mt mu">▶ amplify add api<br/>? Please select from one of the below mentioned services: GraphQL<br/>? Provide API name: demoapi<br/>? Choose the default authorization type for the API: API key<br/>? Enter a description for the API key:<br/>? After how many days from now the API key should expire (1-365): 7<br/>? Do you want to configure advanced settings for the GraphQL API: No, I am done.<br/>? Do you have an annotated GraphQL schema? No<br/>? Choose a schema template: Single object with fields (e.g., “Todo” with ID, name, description)</span></pre><p id="37ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">流程成功完成后，我们可以在<code class="fe mv mw mx mm b">amplify/backend/api/demoapi/schema.graphql</code>检查GraphQL模式:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="3a9d" class="mq ky iq mm b gy mr ms l mt mu">type Todo @model {<br/>  id: ID!<br/>  name: String!<br/>  description: String<br/>}</span></pre><p id="3cce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">生成的Todo类型用一个<code class="fe mv mw mx mm b">@model</code>指令进行了注释，该指令是Amplify的<a class="ae kw" href="https://docs.amplify.aws/cli/graphql-transformer/model" rel="noopener ugc nofollow" target="_blank"> GraphQL转换</a>库的一部分。该库包含多个指令，可用于身份验证、定义数据模型等。添加<code class="fe mv mw mx mm b">@model</code>指令将为这个类型创建一个数据库表(在我们的例子中是一个Todo表)、CRUD(创建、读取、更新、删除)模式和相应的GraphQL解析器。</p><p id="1335" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是时候部署我们的后端了:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="3965" class="mq ky iq mm b gy mr ms l mt mu">▶ amplify push<br/>✔ Successfully pulled backend environment dev from the cloud.<br/><br/>Current Environment: dev<br/><br/>| Category | Resource name | Operation | Provider plugin   |<br/>| -------- | ------------- | --------- | ----------------- |<br/>| Api      | demoapi       | Create    | awscloudformation |<br/>? Are you sure you want to continue? Yes<br/>? Do you want to generate code for your newly created GraphQL API: Yes<br/>? Choose the code generation language target: typescript<br/>? Enter the file name pattern of graphql queries, mutations and subscriptions: src/graphql/**/*.ts<br/>? Do you want to generate/update all possible GraphQL operations - queries, mutations and subscriptions: Yes<br/>? Enter maximum statement depth [increase from default if your schema is deeply nested] 2<br/>? Enter the file name for the generated code: src/API.ts</span></pre><p id="3acd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">成功完成后，我们的GraphQL API就部署好了，我们可以与之交互。要随时在AppSync控制台中查看GraphQL API并与之交互，我们可以运行:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="2be5" class="mq ky iq mm b gy mr ms l mt mu">amplify console api</span></pre><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/5f22d4477194c0946ff67d1be2e17b9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*hbysbd403ZOKsUz6.jpg"/></div></div></figure><p id="1f73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者，我们可以运行以下命令</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="4290" class="mq ky iq mm b gy mr ms l mt mu">amplify console api</span></pre><p id="88ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Amplify控制台中查看整个应用程序。</p><p id="64f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">GraphQL的变化、查询和订阅可在<code class="fe mv mw mx mm b">src/graphql</code>获得。为了能够与它们交互，我们可以使用生成的<code class="fe mv mw mx mm b">src/API.ts</code>文件。所以我们需要扩展<code class="fe mv mw mx mm b">App.js</code>来通过我们的GraphQL API创建、编辑和删除待办事项:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="6855" class="mq ky iq mm b gy mr ms l mt mu">import React, { useEffect, useState } from 'react';<br/>import { API, graphqlOperation } from '@aws-amplify/api';<br/>import { listTodos } from './graphql/queries';<br/>import { createTodo, deleteTodo, updateTodo } from './graphql/mutations';<br/>import TodoList from './components/TodoList';<br/>import CreateTodo from './components/CreateTodo';<br/><br/>const initialState = { name: '', description: '' };<br/><br/>function App() {<br/>  const [formState, setFormState] = useState(initialState);<br/>  const [todos, setTodos] = useState([]);<br/>  const [apiError, setApiError] = useState();<br/>  const [isLoading, setIsLoading] = useState(false);<br/><br/>  useEffect(() =&gt; {<br/>    fetchTodos();<br/>  }, []);<br/><br/>  function setInput(key, value) {<br/>    setFormState({ ...formState, [key]: value });<br/>  }<br/><br/>  async function fetchTodos() {<br/>    setIsLoading(true);<br/>    try {<br/>      const todoData = await API.graphql(graphqlOperation(listTodos));      const todos = todoData.data.listTodos.items;<br/>      setTodos(todos);<br/>      setApiError(null);<br/>    } catch (error) {<br/>      console.error('Failed fetching todos:', error);<br/>      setApiError(error);<br/>    } finally {<br/>      setIsLoading(false);<br/>    }<br/>  }<br/><br/>  async function addTodo() {<br/>    try {<br/>      if (!formState.name || !formState.description) {<br/>        return;<br/>      }<br/>      const todo = { ...formState };<br/>      setTodos([...todos, todo]);<br/>      setFormState(initialState);<br/>      await API.graphql(graphqlOperation(createTodo, { input: todo }));      setApiError(null);<br/>    } catch (error) {<br/>      console.error('Failed creating todo:', error);<br/>      setApiError(error);<br/>    }<br/>  }<br/><br/>  async function removeTodo(id) {<br/>    try {<br/>      await API.graphql(graphqlOperation(deleteTodo, { input: { id } }));      setTodos(todos.filter(todo =&gt; todo.id !== id));<br/>      setApiError(null);<br/>    } catch (error) {<br/>      console.error('Failed deleting todo:', error);<br/>      setApiError(error);<br/>    }<br/>  }<br/><br/>  async function onItemUpdate(todo) {<br/>    try {<br/>      await API.graphql(        graphqlOperation(updateTodo, {          input: {            name: todo.name,            description: todo.description,            id: todo.id,          },        })      );      setApiError(null);<br/>    } catch (error) {<br/>      console.error('Failed updating todo:', error);<br/>      setApiError(error);<br/>    }<br/>  }<br/><br/>  const errorMessage = apiError &amp;&amp; (<br/>    &lt;p style={styles.errorText}&gt;<br/>      {apiError.errors.map(error =&gt; (<br/>        &lt;p&gt;{error.message}&lt;/p&gt;<br/>      ))}<br/>    &lt;/p&gt;<br/>  );<br/><br/>  if (isLoading) {<br/>    return 'Loading...';<br/>  }<br/><br/>  return (<br/>    &lt;div style={styles.container}&gt;<br/>      &lt;h1 style={styles.heading}&gt;Amplify React &amp; GraphQL Todos&lt;/h1&gt;<br/>      {errorMessage}<br/>      &lt;div style={styles.grid}&gt;<br/>        &lt;TodoList<br/>          todos={todos}<br/>          onRemoveTodo={removeTodo}<br/>          onItemUpdate={onItemUpdate}<br/>        /&gt;<br/>        &lt;CreateTodo<br/>          description={formState.description}<br/>          name={formState.name}<br/>          onCreate={addTodo}<br/>          onDescriptionChange={setInput}<br/>          onNameChange={setInput}<br/>        /&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}<br/><br/>export default App;</span></pre><p id="1207" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该演示的完整源代码可从<a class="ae kw" href="https://github.com/Mokkapps/amplify-react-graphql-todo-demo/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>获得。</p><p id="d649" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该应用程序应该显示一个可以编辑或删除的可用待办事项列表。此外，我们有可能创建新的待办事项:</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/26a8835bfd2d82738ea5540e7ba294e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*SwLAEpMsvc-_CQ7g.jpg"/></div></figure><p id="cad8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Amplify使用<a class="ae kw" href="https://aws.amazon.com/cognito/" rel="noopener ugc nofollow" target="_blank"> Amazon Cognito </a>作为主要的认证提供者。我们将使用它通过添加一个需要密码和用户名的登录来向我们的应用程序添加身份验证。</p><p id="c139" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要添加身份验证，我们需要运行</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="a016" class="mq ky iq mm b gy mr ms l mt mu">▶ amplify add auth<br/>Using service: Cognito, provided by: awscloudformation<br/> The current configured provider is Amazon Cognito.<br/><br/> Do you want to use the default authentication and security configuration? Default configuration<br/> Warning: you will not be able to edit these selections.<br/> How do you want users to be able to sign in? Username<br/> Do you want to configure advanced settings? No, I am done.</span></pre><p id="9809" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并通过运行来部署我们的服务</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="39e4" class="mq ky iq mm b gy mr ms l mt mu">amplify push</span></pre><p id="9437" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们可以将登录UI添加到我们的前端。通过使用来自<code class="fe mv mw mx mm b">@aws-amplify/ui-react</code>包的<code class="fe mv mw mx mm b">withAuthenticator</code>包装器，可以很容易地处理登录流。我们只需要调整我们的<code class="fe mv mw mx mm b">App.js</code>和导入<code class="fe mv mw mx mm b">withAuthenticator</code>:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="93eb" class="mq ky iq mm b gy mr ms l mt mu">import { withAuthenticator } from '@aws-amplify/ui-react';</span></pre><p id="9eff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们需要用<code class="fe mv mw mx mm b">withAuthenticator</code>包装器包装主要组件:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="3e5c" class="mq ky iq mm b gy mr ms l mt mu">export default withAuthenticator(App);</span></pre><p id="f30a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行<code class="fe mv mw mx mm b">npm start</code>将启动应用程序，并提供认证流程，允许用户注册并登录:</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/bb3b3fa48e98f85ef9af20e6cf960969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*s2JlTueUe3QRErNR.jpg"/></div></figure><p id="4c4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们希望部署我们的应用程序，这可以手动完成，也可以通过自动持续部署来完成。在这个演示中，我想手动部署它，并将其作为静态web应用程序托管。如果你想使用持续部署，请查看官方指南。</p><p id="1321" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们需要添加主机:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="633e" class="mq ky iq mm b gy mr ms l mt mu">▶ amplify add hosting<br/>? Select the plugin module to execute: Hosting with Amplify Console (Managed hosting with custom domains, Continuous deployment)<br/>? Choose a type: Manual deployment</span></pre><p id="8b6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我们准备发布我们的应用程序:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="a691" class="mq ky iq mm b gy mr ms l mt mu">amplify publish</span></pre><p id="86f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发布后，我们可以在终端中的一个“amplifyapp.com”域上看到我们的应用程序所在的应用程序URL。</p><h1 id="f520" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">下一步是什么</h1><p id="2dbf" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">Amplify还提供了一种在本地运行API的方法，请看这篇教程。</p><p id="ac9d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里有一些很酷的东西，你可以添加到你的放大器应用:</p><ul class=""><li id="fc46" class="na nb iq ka b kb kc kf kg kj nc kn nd kr ne kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/datastore/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank">数据存储</a></li><li id="13d6" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/storage/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank">用户文件存储</a></li><li id="100e" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/graphqlapi/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank">无服务器API</a></li><li id="7386" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/analytics/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank">分析</a></li><li id="522a" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/predictions/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank">艾/毫升</a></li><li id="ca9d" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/push-notifications/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank">推送通知</a></li><li id="40eb" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/pubsub/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank"> PubSub </a></li><li id="52b5" class="na nb iq ka b kb nj kf nk kj nl kn nm kr nn kv nf ng nh ni bi translated"><a class="ae kw" href="https://docs.amplify.aws/lib/xr/getting-started/q/platform/js" rel="noopener ugc nofollow" target="_blank"> AR/VR </a></li></ul><p id="c0d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请看一下官方的Amplify文档以获得关于这个框架的更多信息。</p><h1 id="6115" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="f250" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在本文中，我向您展示了使用AWS Amplify构建和部署全栈无服务器应用程序只需要最少的工作量。如果不使用这样的框架，事情会变得更加困难，这样你就可以更加关注最终产品，而不是内部发生的事情。</p><p id="b615" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢这篇文章，请在Twitter上关注我，从我这里获得关于新博客文章和更多内容的通知。</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="3a98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="md">原载于</em><a class="ae kw" href="https://www.mokkapps.de/blog/build-and-deploy-a-serverless-graphql-react-app-using-aws-amplify/" rel="noopener ugc nofollow" target="_blank"><em class="md">https://www . mokkapps . de</em></a><em class="md">。</em></p></div></div>    
</body>
</html>