<html>
<head>
<title>MongoDB with Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带颤振的MongoDB</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/mongodb-with-flutter-407de79f84e4?source=collection_archive---------0-----------------------#2021-07-13">https://levelup.gitconnected.com/mongodb-with-flutter-407de79f84e4?source=collection_archive---------0-----------------------#2021-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cdbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MongoDB与CRUD操作在颤振中的集成</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/43e63a7a4f6675057063184dac0e0379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDZYG3dEm9y4u-r5U_Y5LA.png"/></div></div></figure><p id="79f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MongoDB是流行的开源NoSQL数据库之一。在本文中，我们将看看如何在扑动应用程序中使用它。</p><p id="2948" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个例子中，我们将使用<a class="ae kx" href="https://pub.dev/packages/mongo_dart" rel="noopener ugc nofollow" target="_blank"> mongo_dart </a>包，这是一个用纯dart语言实现的MongoDB的服务器端驱动程序库。让我们开始吧！</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="852e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">装置</h1><ol class=""><li id="513f" class="md me iq jp b jq mf ju mg jy mh kc mi kg mj kk mk ml mm mn bi translated">将<code class="fe mo mp mq mr b">mongo_dart</code>依赖项添加到您的<code class="fe mo mp mq mr b">pubspec.yaml</code>文件中:</li></ol><pre class="km kn ko kp gt ms mr mt mu aw mv bi"><span id="5b48" class="mw lg iq mr b gy mx my l mz na">dependencies<strong class="mr ir">:<br/>  mongo_dart: ^0.4.4</strong></span></pre><p id="b29e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.在终端中运行以下命令进行安装:</p><pre class="km kn ko kp gt ms mr mt mu aw mv bi"><span id="8ca5" class="mw lg iq mr b gy mx my l mz na"><strong class="mr ir">$ flutter pub get</strong></span></pre><p id="fcbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.导入包:</p><pre class="km kn ko kp gt ms mr mt mu aw mv bi"><span id="2204" class="mw lg iq mr b gy mx my l mz na"><strong class="mr ir">import 'package:mongo_dart/mongo_dart.dart';</strong></span></pre></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="faf6" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">履行</h1><p id="828d" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">我们将创建的应用程序将拥有简单的用户群<code class="fe mo mp mq mr b">List</code>。用户模型如下:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="bdd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">需要注意的是<code class="fe mo mp mq mr b">id</code>属于<code class="fe mo mp mq mr b">ObjectId</code>型，属于蒙古型。</p><p id="7e17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建一个新的文件<code class="fe mo mp mq mr b">database.dart</code>，它将允许我们连接到Mongo数据库并保存CRUD操作。</p><p id="e8c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们在刚刚创建的文件中创建一个新的类<code class="fe mo mp mq mr b">MongoDatabase</code>。首先，让我们连接到Mongo数据库。添加以下方法连接到数据库:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="2196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们使用库提供的<code class="fe mo mp mq mr b">Db</code>类中的<code class="fe mo mp mq mr b">create()</code>作为Mongo连接URL。URL应采用以下形式:</p><pre class="km kn ko kp gt ms mr mt mu aw mv bi"><span id="d701" class="mw lg iq mr b gy mx my l mz na">"mongodb+srv://&lt;USER&gt;:&lt;PASS&gt;@&lt;DB&gt;/&lt;COLLECTION&gt;;</span></pre><p id="91d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们用<code class="fe mo mp mq mr b">open()</code>打开数据库，在<code class="fe mo mp mq mr b">userCollection</code>中获取集合。</p><h2 id="8eb9" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">创造</h2><p id="93bd" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">创建一个新文档非常简单。您只需要调用集合中的<code class="fe mo mp mq mr b">insertAll()</code>就可以一次插入多个文档。在这里，我们将只使用它来插入一个文档。这可以通过以下方式完成:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="a84c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们只需要调用方法并转换<code class="fe mo mp mq mr b">User</code>来映射并将其传递到一个列表中。</p><h2 id="6cb1" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">阅读</h2><p id="b80e" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">要阅读Mongo的所有文件，我们需要使用集合上的<code class="fe mo mp mq mr b">find()</code>。我们还需要将它们转换成列表，以便在用户界面上显示。这可以通过<code class="fe mo mp mq mr b">toList()</code>来完成，它以动态类型值返回以字符串为键的地图对象列表。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="d468" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们还使用一个简单的try-catch语句来处理空结果条件。</p><h2 id="476d" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">更新</h2><p id="9234" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">更新文档时，我们使用<code class="fe mo mp mq mr b">findOne()</code>按id查找文档，分配新值并使用<code class="fe mo mp mq mr b">save()</code>保存到集合中。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="0217" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">删除</h2><p id="6340" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">为了删除一个文档，我们调用<code class="fe mo mp mq mr b">remove()</code>进行收集，并使用where子句传递<strong class="jp ir"> ObjectId </strong>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><blockquote class="nr ns nt"><p id="c1c0" class="jn jo nu jp b jq jr js jt ju jv jw jx nv jz ka kb nw kd ke kf nx kh ki kj kk ij bi translated"><strong class="jp ir">文章保持简单，这样你可以专注于概念，你不应该在生产应用中编写这样的代码。</strong></p></blockquote><p id="2576" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了这些方法，让我们快速设置所需的页面。</p><p id="23d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将有一个用户卡中的用户列表的主页，以及一个浮动的动作按钮，这将引导我们到我们可以添加用户的页面。用户卡将有编辑和删除按钮。我们将使用<code class="fe mo mp mq mr b">FutureBuilder</code>从数据库中获取文档。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="2c44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">主屏幕如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ny"><img src="../Images/afa71bb93be579a7583433e27eca60c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aRxCmotac3GWs9zVdJGMXA.png"/></div></div></figure></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><blockquote class="nr ns nt"><p id="1dd6" class="jn jo nu jp b jq jr js jt ju jv jw jx nv jz ka kb nw kd ke kf nx kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">为简洁起见，本文仅包含必要的代码，您可以在文章末尾找到GitHub到完整源代码库的链接。</em>T12】</strong></p></blockquote><p id="1d8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们添加一个新页面<code class="fe mo mp mq mr b">add_user_page.dart</code>，它将用于添加新用户以及更新现有用户。添加或更新用户将取决于路由参数。该页面将有三个<code class="fe mo mp mq mr b">textField</code>部件，分别用于姓名、电话和年龄。添加用户的用户界面如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ny"><img src="../Images/588bccf2441c740fcbe25834c3854f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aqcDky6RB73S0QDW7wwcVw.png"/></div></div></figure><p id="af5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">插入和更新用户的方法有:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="beee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，我们在插入新用户时使用<code class="fe mo mp mq mr b">ObjectId()</code>创建一个新的id，但在更新用户时分配相同的id。我们从前面创建的类中调用相应的插入和更新方法。</p><p id="3178" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更新用户界面如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ny"><img src="../Images/0fcb3622d305870344825eae0c95310c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bPITop1pazkXAvGzXxGYgQ.png"/></div></div></figure><p id="1ef5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一步是在应用程序启动时连接到数据库。这可以通过以下方式实现:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="d346" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们将<code class="fe mo mp mq mr b">main()</code>设为<code class="fe mo mp mq mr b">async </code>，这样我们就可以调用<code class="fe mo mp mq mr b">connect()</code>来连接mongo数据库。就这样，我们有了一个使用MongoDB作为数据库的可用的flutter应用程序！</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="7fe7" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="a36c" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy nb ka kb kc nc ke kf kg nd ki kj kk ij bi translated">在本文中，我们通过一个简单的例子探索了如何在flutter中使用MongoDB并执行CRUD操作。</p><p id="c3a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的源代码可以在下面的链接中找到:</p><div class="nz oa gp gr ob oc"><a href="https://github.com/harshshinde07/MongoDB-Flutter" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">harshshinde07/MongoDB-Flutter</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">一个演示如何将mongodb连接到Flutter应用程序的应用程序</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">github.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq kv oc"/></div></div></a></div></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h2 id="d163" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">感谢您阅读这篇文章。如果你喜欢这篇文章或者学到了新的东西，尽可能多地鼓掌以示支持。👏</h2><h2 id="eedf" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">这真的激励我继续写更多！:)</h2><h2 id="ff21" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">如果有错误，请随时纠正。</h2><h2 id="d21c" class="mw lg iq bd lh ng nh dn ll ni nj dp lp jy nk nl lt kc nm nn lx kg no np mb nq bi translated">我们来连线:</h2><ul class=""><li id="344f" class="md me iq jp b jq mf ju mg jy mh kc mi kg mj kk or ml mm mn bi translated"><a class="ae kx" href="https://github.com/harshshinde07/" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="c9de" class="md me iq jp b jq os ju ot jy ou kc ov kg ow kk or ml mm mn bi translated"><a class="ae kx" href="https://www.linkedin.com/in/harshshinde07/" rel="noopener ugc nofollow" target="_blank">领英</a></li></ul></div></div>    
</body>
</html>