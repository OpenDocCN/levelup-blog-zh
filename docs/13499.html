<html>
<head>
<title>A Short Intro on Concurrency and Parallelism</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">并发和并行的简短介绍</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-short-intro-on-concurrency-and-parallelism-1417bd04e881?source=collection_archive---------0-----------------------#2022-09-09">https://levelup.gitconnected.com/a-short-intro-on-concurrency-and-parallelism-1417bd04e881?source=collection_archive---------0-----------------------#2022-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3902" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">两个明显分开的最好的朋友</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/e348c68f362c4c03ca809eb33f91f21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*vTtjb_6qfLIXMcEJZadl6Q.png"/></div></figure><p id="676d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我想感谢你停下来阅读这篇博客，而不是滚动Instagram并向右滑动。我写这篇博客的真正原因是重温我的并发和并行知识。</p><p id="214a" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我最近通过阅读关于理查德·费曼的文章发现了一种学习方法。该方法规定，</p><blockquote class="lj"><p id="8104" class="lk ll iq bd lm ln lo lp lq lr ls li dk translated">尽可能简单地写下你的想法，并考虑如何向那些对这个想法知之甚少或一无所知的人解释。</p></blockquote><p id="510e" class="pw-post-body-paragraph kn ko iq kp b kq lt jr ks kt lu ju kv kw lv ky kz la lw lc ld le lx lg lh li ij bi translated">所以我在这里全力以赴。在我们进入定义之前，考虑一些实际的例子。</p><p id="fceb" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">并发</strong>就是只有一只手，用它做某件事，停下来，开始另一件事，停下来，回到第一件事。你把一只手分开在几个活动中。</p><p id="9aab" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">平行</strong>就是用双手一只手刷牙，另一只手做发型。</p><p id="3c37" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">并发</strong>是两行顾客从一个收银台点餐(各行轮流点餐)；<strong class="kp ir">并行</strong>是两列顾客从两个收银员处点餐(每列都有自己的收银员)。</p><h2 id="3270" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated">定义:</h2><p id="fd3a" class="pw-post-body-paragraph kn ko iq kp b kq mr jr ks kt ms ju kv kw mt ky kz la mu lc ld le mv lg lh li ij bi translated">著名程序员和作家罗布·派克</p><blockquote class="lj"><p id="cabf" class="lk ll iq bd lm ln lo lp lq lr ls li dk translated"><strong class="ak">并发</strong>是<strong class="ak">同时处理</strong>多件事情，而<strong class="ak">并行</strong>是<strong class="ak">同时做</strong>多件事情。</p></blockquote><p id="4565" class="pw-post-body-paragraph kn ko iq kp b kq lt jr ks kt lu ju kv kw lv ky kz la lw lc ld le lx lg lh li ij bi translated">书中的<strong class="kp ir"> <em class="mw">务实的程序员</em> </strong></p><blockquote class="lj"><p id="8f62" class="lk ll iq bd lm ln lo lp lq lr ls li dk translated">并发是指两段或多段代码的执行就像它们同时运行一样。并行度是指它们同时运行。</p></blockquote><p id="47af" class="pw-post-body-paragraph kn ko iq kp b kq lt jr ks kt lu ju kv kw lv ky kz la lw lc ld le lx lg lh li ij bi translated">从表面上看，两者似乎很相似，我也见过一些开发人员互换使用这两个词，但两者有明显的区别。</p><p id="f815" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们通过一些图表更深入地研究一下</p><h2 id="a96b" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated"><strong class="ak">并发:</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mx"><img src="../Images/01fd93c7cddab5bbe0584d934d3ffb5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j_zj53jzmDQm91Ql8NgtfA.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk translated">单个CPU中的并发性</figcaption></figure><p id="e22b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在现代术语中，CPU和处理器或多或少是一个意思。因此，请考虑单个CPU /处理器中的上述场景。执行的<strong class="kp ir">线程</strong>是可以独立管理的最小程序指令序列。</p><p id="e3d0" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">只有一个CPU的计算机不能同时执行多个任务。当被赋予多个任务时，比如向Google、Twitter和Medium网站发出请求，它只是在它们之间切换。这种切换是如此的快速和无缝，以至于对用户来说就像是在进行多任务处理。</p><h2 id="cefe" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated">并行执行:</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi ng"><img src="../Images/d4e25a82ef053b7fc02a089f98e9a41f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*80emj62LPiqNIXTe2qYEXw.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk translated">多个CPU的并行性</figcaption></figure><p id="766b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们在并发中查看了单个CPU /处理器，但现在大多数计算机都有多个处理器，并且大多数处理器都有多个内核。当一台计算机拥有多个CPU或CPU内核，并且同时处理多个任务时，就会发生并行执行。</p><h2 id="927c" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated">让我们用go中的一些代码样本更进一步:</h2><p id="0144" class="pw-post-body-paragraph kn ko iq kp b kq mr jr ks kt ms ju kv kw mt ky kz la mu lc ld le mv lg lh li ij bi translated">Go的设计初衷是利用多个内核，它知道如何有效地利用这些内核。为了支持并发性，Golang提供了goroutines。</p><blockquote class="lj"><p id="5eba" class="lk ll iq bd lm ln lo lp lq lr ls li dk translated">goroutine是由Go运行时管理的轻量级线程。</p></blockquote><p id="2ea0" class="pw-post-body-paragraph kn ko iq kp b kq lt jr ks kt lu ju kv kw lv ky kz la lw lc ld le lx lg lh li ij bi translated">一个goroutine只需要2kB的堆栈空间来初始化。另一方面，一个标准线程可以占用1MB的内存，因此创建一千个goroutines比创建一千个线程需要的资源少得多。</p><p id="9b13" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">并发</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nh"><img src="../Images/e21e4afe4edf78eb3810acae44ed1311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ECsYlEPDBnupQ0vRiCPxDQ.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk translated">Go中的并发性</figcaption></figure><p id="c21b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">从上面的例子可以看出，通过简单地在方法调用前面加上“go”关键字，可以使Go中的方法并发运行。从<code class="fe ni nj nk nl b">main</code>方法中并发调用<code class="fe ni nj nk nl b">pingWebsite</code>方法，并将网站状态打印到控制台。在您的PC上运行并调试一次，以便更好地理解它。</p><p id="4d7a" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">并行度</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nm"><img src="../Images/76342e1d673da12f3657083542fc9ebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZO8oItODn1VZ3ezHCeNj3A.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk translated">Go中的并行执行</figcaption></figure><p id="b503" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">上面的例子与前面的例子几乎相似，但是一个主要的变化是我们引入了一个锁机制来模拟并行执行。</p><p id="ecab" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这条线</p><p id="4c87" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><code class="fe ni nj nk nl b">runtime.GOMAXPROCS(runtime.NumCPU())</code></p><p id="6b7e" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">设置可以使用的CPU数量，如果未设置，则使用所有可用的CPU</p><blockquote class="lj"><p id="d904" class="lk ll iq bd lm ln lo lp lq lr ls li dk translated">GOMAXPROCS设置可以同时执行的最大CPU数量，并返回以前的设置。它默认为runtime.NumCPU的值。</p></blockquote><p id="e3f0" class="pw-post-body-paragraph kn ko iq kp b kq lt jr ks kt lu ju kv kw lv ky kz la lw lc ld le lx lg lh li ij bi translated">这条线</p><p id="ca3a" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><code class="fe ni nj nk nl b">runtime.LockOSThread()</code></p><p id="0067" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">通过在下面一行中锁定线程并在任务完成后解锁线程，防止goroutines重用现有线程。</p><p id="d2c7" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><code class="fe ni nj nk nl b">runtime.LockOSThread()</code>。</p><p id="732c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">从<code class="fe ni nj nk nl b">main</code>方法并行调用<code class="fe ni nj nk nl b">pingWebsite</code>方法，将网站状态和执行前后的线程数打印到控制台。代码执行后的线程数量大于执行前的数量。并且记住Go可以自动动态创建所需数量的线程。</p><p id="8edb" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">为了更好地理解它，请在您的计算机上运行并调试这两个示例。</p><p id="2baf" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这就是我们如何在Go中实现并行执行。默认情况下，Go调度程序重用没有被阻塞的线程。</p><p id="05a9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">你可以在这里找到代码示例<a class="ae nn" href="https://github.com/KiranSuvarna/Medium-Blogs/tree/main/A%20short%20intro%20on%20Concurrency%20and%20Parallelism" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="aaa9" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated"><strong class="ak">最终想法</strong></h2><p id="19db" class="pw-post-body-paragraph kn ko iq kp b kq mr jr ks kt ms ju kv kw mt ky kz la mu lc ld le mv lg lh li ij bi translated">在计算机和工程领域，并发性和并行性有着截然不同的含义，我希望您非常清楚每一个的确切含义。所以如果你问哪个更好，没有单一的答案，你必须弄清楚哪个更适合你的用例。你怎么想呢?并发比并行好吗？还是并行比并发好？苹果比橘子好吃吗？</p><p id="4ae2" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">非常感谢你能走到这一步。你现在可以在网上随意浏览猫的视频了。如果你喜欢这个博客，请为它鼓掌，留下评论，关注更多。</p><h2 id="9e8b" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated">参考资料:</h2><ol class=""><li id="ac22" class="no np iq kp b kq mr kt ms kw nq la nr le ns li nt nu nv nw bi translated"><a class="ae nn" href="https://jenkov.com/tutorials/java-concurrency/concurrency-vs-parallelism.html" rel="noopener ugc nofollow" target="_blank">https://jen kov . com/tutorials/Java-concurrency/concurrency-vs-parallelism . html</a></li><li id="5671" class="no np iq kp b kq nx kt ny kw nz la oa le ob li nt nu nv nw bi translated">https://pkg.go.dev/runtime#GOMAXPROCS<a class="ae nn" href="https://pkg.go.dev/runtime#GOMAXPROCS" rel="noopener ugc nofollow" target="_blank"/></li><li id="15c9" class="no np iq kp b kq nx kt ny kw nz la oa le ob li nt nu nv nw bi translated"><a class="ae nn" rel="noopener ugc nofollow" target="_blank" href="/how-to-implement-concurrency-and-parallelism-in-go-83c9c453dd2">https://level up . git connected . com/how-to-implementation-concurrency-and-parallelism-in-go-83c 9 c 453 D2</a></li><li id="a097" class="no np iq kp b kq nx kt ny kw nz la oa le ob li nt nu nv nw bi translated"><a class="ae nn" href="https://youtu.be/oV9rvDllKEg" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=oV9rvDllKEg</a></li><li id="3674" class="no np iq kp b kq nx kt ny kw nz la oa le ob li nt nu nv nw bi translated"><a class="ae nn" href="https://stackoverflow.com/questions/1050222/what-is-the-difference-between-concurrency-and-parallelism" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/1050222/并发性和并行性的区别是什么</a></li></ol></div></div>    
</body>
</html>