<html>
<head>
<title>How to Build a Webex Chatbot in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中构建Webex聊天机器人</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-build-a-webex-chatbot-in-node-js-874cc496c5a1?source=collection_archive---------10-----------------------#2022-01-27">https://levelup.gitconnected.com/how-to-build-a-webex-chatbot-in-node-js-874cc496c5a1?source=collection_archive---------10-----------------------#2022-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ca0d28ff37640f6fa9bc9573bbbd9637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lthMWZufXfO5uy4noF9tPg.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">安迪·凯利在<a class="ae jg" href="https://unsplash.com/s/photos/robot?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="3ef6" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">为混合工作生成开发工具</h2></div><p id="2807" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">医疗保健、教育、金融、零售以及几乎所有其他领域的员工都是在家登录打卡上班。这为开发人员开发工具来支持每个行业的混合工作提供了机会，而不仅仅是他们自己的工作。其中一个机会是在ChatOps领域，使用聊天应用程序来触发运营工作流。</p><p id="4b9d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为软件开发人员，我们多年来一直在做ChatOps从聊天空间内部发送命令来部署应用程序、重启服务器和打开pull请求。然而，如今通过虚拟会议和团队平台进行协作的不仅仅是IT专业人士。2020年，其他人也开始这么做。</p><p id="56bc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Webex是主要的混合工作平台之一。我对ChatOps在Webex中的样子特别感兴趣。为它造一个聊天机器人有多难？事实证明，这一点也不难。</p><p id="09ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我们将通过Node.js和<a class="ae jg" href="https://github.com/WebexSamples/webex-node-bot-framework" rel="noopener ugc nofollow" target="_blank"> webex-node-bot-framework </a>构建一个简单的Webex聊天机器人的步骤。我们将能够将我们的聊天机器人添加到Webex团队空间或直接消息空间。只要聊天机器人的后端服务器在运行，聊天机器人就能够在Webex中对您或团队空间中的任何人做出响应。</p><p id="989b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于第一次迭代，我们将使用ngrok隧道在本地运行聊天机器人的后端，以便Webex消息可以到达我们的服务器，让聊天机器人提供正确的响应。在后续的文章中，我们将封装我们的chatbot后端服务器，并将其部署到云中。</p><p id="760a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你准备好了吗？我们走吧！</p><h1 id="231b" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">我们的演示聊天机器人会做什么？</h1><p id="031d" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我参加了很多虚拟会议。有时，会议会陷入一片混乱，首字母缩写词，流行词汇，等等等等。我患有冒名顶替综合征，当谈到为诸如此类的事情做贡献时，我并不总是觉得自己能坚持下去。</p><p id="5938" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">进入我们的公司语言生成器聊天机器人:<strong class="la jk"> Buzz </strong>。在Webex中，我可以向Buzz发送消息，请他给我一个动作或一件事情:</p><ul class=""><li id="7a0f" class="mr ms jj la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated">当我要求一个动作时，Buzz会给我回复“基准虚拟范例”或“创新动态功能”这样的短语。当被问及我们团队下一步应该做什么时，这是一个完美的回答。</li><li id="8289" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">当我要一个东西时，Buzz会用“监控移动能力”或“独立整体指令集”这样的短语来回应当我们谈论我们的2.0 MVP的特性集时，这正是我所需要的。</li></ul><h1 id="9bd3" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">设置Webex</h1><p id="dff0" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">首先，你需要建立一个<a class="ae jg" href="https://cart.webex.com/sign-up" rel="noopener ugc nofollow" target="_blank"> Webex账户</a>。从那里，你可以登录<a class="ae jg" href="https://developer.webex.com/" rel="noopener ugc nofollow" target="_blank"> Webex开发者门户</a>并进入<a class="ae jg" href="https://developer.webex.com/my-apps" rel="noopener ugc nofollow" target="_blank">我的应用</a>。点击<strong class="la jk">创建新应用</strong>。选择选项<strong class="la jk">创建一个机器人</strong>。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nf"><img src="../Images/d26c378a13c3828f842912190df7b09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXbcQiBWbG5wRlLDQmsttw.png"/></div></div></figure><p id="64af" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为您的聊天机器人选择一个显示名称和用户名。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/a19d1af6f00b40fc0ce87e3a6995e197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKRVdaHZi5F31Q70SBBgKA.png"/></div></div></figure><p id="15e8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您也可以为您的聊天机器人上传自定义图标。我决定选这个<a class="ae jg" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/353d2cf800b1a8eaa5c2998a66516d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*VRW6eWY5dg_N71rr861j1g.png"/></div></figure><p id="f7da" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您也可以为您的聊天机器人输入描述。然后，点击<strong class="la jk">添加机器人</strong>。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/d4d766173b29a1e234a288b574de6930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dPlx6J-k44AKv6RtuokJag.png"/></div></div></figure><p id="04d2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">复制你的<strong class="la jk">机器人访问令牌</strong>。我们将在后面的步骤中使用它。</p><p id="ce63" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，转到您的<a class="ae jg" href="https://web.webex.com/spaces" rel="noopener ugc nofollow" target="_blank"> Webex空间</a>。点击加号<strong class="la jk">创建一个空间</strong>。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/736056736626693ccbb709ec2d7b326d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*mYcRtmT3Vz3mgBHdjyJpng.png"/></div></figure><p id="e6f6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为您的共享空间选择一个名称。然后，通过输入您的聊天机器人的电子邮件，即您选择的聊天机器人用户名，然后按<code class="fe no np nq nr b">@webex.bot</code>，邀请Buzz加入该空间。在我们的例子中，那就是<code class="fe no np nq nr b">buzz-phrase-generator@webex.bot</code>。</p><p id="083b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首次将聊天机器人添加到您的共享空间时，Webex可能会告诉您该用户是Webex的新用户，您需要邀请他们。如果你是这种情况，那么点击<strong class="la jk">邀请</strong>。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/a85a126e2085b40955530d1a3e415786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*qnyrqQ6Zfd_zu5Nw89fbOQ.png"/></div></figure><p id="d780" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击<strong class="la jk">创建</strong>。您现在有了一个带有Buzz的Webex空间。</p><h1 id="1fbf" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">构建聊天机器人后端</h1><p id="0aa0" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">现在，让我们给我们的聊天机器人一些大脑。你可以一步一步来，或者在<a class="ae jg" href="https://bit.ly/webex-chatbot" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>查看完整的源代码。我们的chatbot后端将是一个基本的Node.js Express服务器，我们将在本地机器上构建它。</p><h2 id="c2ea" class="nt lv jj bd lw nu nv dn ma nw nx dp me lh ny nz mg ll oa ob mi lp oc od mk oe bi translated">初始化项目并添加依赖项</h2><p id="899e" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">首先，我们将使用<a class="ae jg" href="https://yarnpkg.com/" rel="noopener ugc nofollow" target="_blank"> yarn </a>为我们的服务器初始化一个新的Node.js项目。在本地计算机的终端中，执行以下操作:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="5a9b" class="nt lv jj nr b gy oj ok l ol om">~/$ mkdir buzz-server<br/><br/>~/$ cd buzz-server<br/><br/>~/buzz-server$ yarn init<br/><br/><br/>yarn init v1.22.10<br/>question name (buzz-server): buzz-server<br/>…<br/><br/>success Saved package.json<br/>Done in 9.85</span></pre><p id="a636" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将添加依赖项。</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="7af2" class="nt lv jj nr b gy oj ok l ol om">~/buzz-server$ yarn add webex-node-bot-framework express faker@5.5.3</span></pre><p id="f29d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的聊天机器人使用<a class="ae jg" href="https://github.com/WebexSamples/webex-node-bot-framework" rel="noopener ugc nofollow" target="_blank"> webex-node-bot-framework </a>，它抽象出webex机器人创建的复杂性，允许您通过Node.js <a class="ae jg" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>服务器和事件监听器来构建聊天机器人交互。</p><p id="7d5b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还使用<a class="ae jg" href="https://www.npmjs.com/package/faker/v/5.5.3" rel="noopener ugc nofollow" target="_blank"> faker </a>包(锁定到版本<code class="fe no np nq nr b">5.5.3</code>，因为最新版本不再像预期的那样工作)。这个库通常用于生成虚假的测试数据，但是它的API包括一组用于生成公司术语的调用。这就是Buzz将用来生成我们正在寻找的短语。</p><p id="77a3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的项目文件夹中，我们创建了一个名为<code class="fe no np nq nr b">index.js</code>的文件。让我们一次一节地看一下代码做了什么。</p><h2 id="b16e" class="nt lv jj bd lw nu nv dn ma nw nx dp me lh ny nz mg ll oa ob mi lp oc od mk oe bi translated"><code class="fe no np nq nr b">index.js</code>漫游</h2><p id="1985" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在需要我们所有的第三方包之后，我们初始化一个新的Express服务器(名为<code class="fe no np nq nr b">app</code>)并添加用于解析JSON的中间件。</p><p id="a331" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">框架配置和启动</strong></p><p id="1eab" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们设置框架配置选项:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="bca5" class="nt lv jj nr b gy oj ok l ol om">var config = {<br/>  webhookUrl: process.env.WEBHOOK_URL,<br/>  token: process.env.BOT_ACCESS_TOKEN,<br/>  port: 8080<br/>};</span></pre><p id="18f2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">框架需要两条信息来初始化与Webex的连接:</p><ol class=""><li id="4614" class="mr ms jj la b lb lc le lf lh mt ll mu lp mv lt on mx my mz bi translated"><code class="fe no np nq nr b">webhookUrl</code>:这是我们将部署聊天机器人后端的URL，每当涉及聊天机器人的事件发生时，Webex将在这里发送请求。对于这篇文章，我们将在本地部署并用<a class="ae jg" href="https://ngrok.com/" rel="noopener ugc nofollow" target="_blank"> ngrok </a>隧道来获取一个URL。</li><li id="aeb8" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt on mx my mz bi translated"><code class="fe no np nq nr b">token</code>:这是我们创建bot时Webex提供给我们的bot访问令牌。当我们的chatbot后端启动时，它将使用这个令牌向Webex API认证，以便注册涉及我们的chatbot的Webex团队活动。</li></ol><p id="fb1e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将在启动服务器时提供这两个值作为环境变量。</p><p id="06e6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们开始框架:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="6e00" class="nt lv jj nr b gy oj ok l ol om">var framework = new Framework(config);<br/>framework.start();</span></pre><p id="6eeb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">响应聊天机器人听到的内容</strong></p><p id="51e4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随着框架的启动，我们可以开始注册事件监听器了。虽然框架提供了几个可以监听的<a class="ae jg" href="https://github.com/WebexSamples/webex-node-bot-framework#events" rel="noopener ugc nofollow" target="_blank">事件</a>，但是我们主要关心的是<a class="ae jg" href="https://github.com/WebexSamples/webex-node-bot-framework#Framework+hears" rel="noopener ugc nofollow" target="_blank"> hears() </a>函数。通过这个功能，我们的服务器等待Buzz听到一个特定的短语(或者用正则表达式匹配一个短语)，然后它指导Buzz以某种方式做出响应。</p><p id="8e93" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是如何告诉Buzz在收到包含单词“action”的消息时进行响应的简单实现:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="bf39" class="nt lv jj nr b gy oj ok l ol om">framework.hears(/action/i, (bot) =&gt; {<br/>  bot.say("Here's an action for you...", faker.company.bs());<br/>});</span></pre><p id="f5e0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们用正则表达式调用<code class="fe no np nq nr b">hears()</code>来匹配任何包含单词“action”的消息(不区分大小写)。当Buzz收到匹配的消息时，我们调用bot的<code class="fe no np nq nr b">say()</code>函数。在这种情况下，我们通过调用faker包中的<code class="fe no np nq nr b">company.bs()</code>来获得我们的企业用语。</p><p id="d078" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于包含单词“thingy”的Buzz消息，我们会以类似的方式进行收听和响应:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="1f8c" class="nt lv jj nr b gy oj ok l ol om">framework.hears(/thingy/i, (bot) =&gt; {<br/>  bot.say("Try this thingy...", faker.company.catchPhrase());<br/>});</span></pre><p id="1767" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些是我们想要的关键侦听器，但是对于任何不符合上述情况的消息，有一个后备响应也是有帮助的。要了解完整的实现细节，请查看<a class="ae jg" href="https://bit.ly/webex-chatbot" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>。</p><p id="6d90" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">快递服务器启动</strong></p><p id="0e20" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们告诉Express让框架处理根路径上的传入请求，并启动我们的服务器:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="b303" class="nt lv jj nr b gy oj ok l ol om">app.post('/', webhook(framework));<br/><br/>var server = app.listen(config.port, () =&gt; {<br/>  console.log(`Listening on port ${config.port}...`);<br/>});</span></pre><p id="e7c4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe no np nq nr b">index.js</code>做好了，就该开机测试了！</p><h1 id="3cfa" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">测试聊天机器人后端</h1><p id="c22a" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">因为我们在本地运行后端服务器，所以我们将使用ngrok，这样Webex就可以通过隧道到达我们在端口<code class="fe no np nq nr b">8080</code>的服务器。</p><h2 id="79ec" class="nt lv jj bd lw nu nv dn ma nw nx dp me lh ny nz mg ll oa ob mi lp oc od mk oe bi translated">启动ngrok</h2><p id="8085" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在终端窗口中，运行以下命令:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="bf4e" class="nt lv jj nr b gy oj ok l ol om">~$ ngrok http 8080</span></pre><p id="b3ed" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ngrok进程将会运行，您的窗口将如下所示:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="7cae" class="nt lv jj nr b gy oj ok l ol om">ngrok by @inconshreveable (Ctrl+C to quit)<br/><br/>Session Status online<br/>Account Alvin Lee (Plan: Free)<br/>Version 2.3.40<br/>Region United States (us)<br/>Web Interface http://127.0.0.1:4040<br/>Forwarding http://98-161-186-106.ngrok.io -&gt; http://localhost:8080<br/>Forwarding https://98-161-186-106.ngrok.io -&gt; http://localhost:8080<br/><br/>Connections ttl  opn    rt1   rt5   p50   p90<br/>              0    0   0.00  0.00  0.00  0.00</span></pre><p id="bc63" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">复制ngrok提供的HTTPS转发URL。</p><h2 id="5512" class="nt lv jj bd lw nu nv dn ma nw nx dp me lh ny nz mg ll oa ob mi lp oc od mk oe bi translated">启动服务器</h2><p id="4dde" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">现在，我们准备运行<code class="fe no np nq nr b">node index.js</code>。然而，我们需要在运行时提供两个环境变量。我们需要指定我们的<code class="fe no np nq nr b">WEBHOOK_URL</code>，这是我们的ngrok转发URL，我们还需要指定我们的<code class="fe no np nq nr b">BOT_ACCESS_TOKEN</code>，这是Webex在我们注册bot时提供给我们的。</p><p id="0129" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为ngrok需要保持运行，我们将在一个新的终端窗口中工作。使用以下命令启动chatbot后端服务器:</p><pre class="ng nh ni nj gt of nr og oh aw oi bi"><span id="fe6a" class="nt lv jj nr b gy oj ok l ol om">~/buzz-server$ WEBHOOK_URL=https://98-161-186-106.ngrok.io \<br/>               BOT_ACCESS_TOKEN={ENTER-YOUR-TOKEN-HERE} \<br/>               node index.js<br/><br/>Listening on port 8080...</span></pre><h2 id="40ba" class="nt lv jj bd lw nu nv dn ma nw nx dp me lh ny nz mg ll oa ob mi lp oc od mk oe bi translated">在Webex中测试</h2><p id="4eb5" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">有了我们的服务器监听，我们可以进入我们在Webex中的空间并发送消息，确保提到@Buzz以便我们的后端服务器接收消息。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/ce4d86575dadfb6196f9bb636df11b97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*M3M_9ZyP92zHojooeQT8oQ.png"/></div></figure><p id="eead" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有用！</p><p id="2774" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">哦，巴斯，我需要你参加上周的董事会。</p><h1 id="5e1a" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">更进一步</h1><p id="c22b" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">该框架还支持来自Webex的<a class="ae jg" href="https://developer.webex.com/docs/api/guides/cards" rel="noopener ugc nofollow" target="_blank">按钮和卡片</a>。您的聊天机器人响应可以被很好地格式化，甚至包含用户可以点击的附加动作。我们可以用一个基本的<a class="ae jg" href="https://adaptivecards.io/" rel="noopener ugc nofollow" target="_blank">适配卡</a>给Buzz多一点润色:</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/83280a42eb56bd6fca3f68b497949372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDpW00Y2tTbc3l1TKqtQ4g.png"/></div></div></figure><h2 id="94bb" class="nt lv jj bd lw nu nv dn ma nw nx dp me lh ny nz mg ll oa ob mi lp oc od mk oe bi translated">更严重的用例</h2><p id="ed6b" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">当然，像Buzz这样古怪的小聊天机器人很有趣，也很容易构建。然而，该框架的简单性为构建强大且真正有用的聊天机器人提供了许多机会。聊天机器人后端的一些可能性包括:</p><ul class=""><li id="c543" class="mr ms jj la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated">联系第三方服务(如金融市场数据、航班状态API或社交媒体平台)以获取特定数据，供聊天机器人在Webex空间中返回。</li><li id="7aa4" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">与通信和生产力API集成。想象一下在Webex中能够做到这些:<em class="oq">嘿，@PagerBot，发个短信和邮件给@JPeralta告诉他“每日站立5分钟前开始。”</em></li><li id="0c22" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">触发内部组织行动，如生成财务报告或收集昨天的学校出勤数字。</li><li id="6527" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">与物联网或智能助手交互。</li></ul><p id="0637" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们只触及了Buzz的皮毛。</p><h1 id="7d3a" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">结论</h1><p id="ddd0" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在本文的演示迷你项目中，我们在本地部署了我们的聊天机器人。无论你的聊天机器人是Buzz还是下一个混合工作游戏规则改变者，当你真的想把你的聊天机器人部署到云上时，你会怎么做？在我们的后续文章中，我们将把我们的chatbot后端服务器作为一个容器映像。然后，我们将它部署到云中。做好准备。</p><p id="346d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随着各行各业越来越多的人在家工作，混合工作平台的使用正呈现爆炸式增长。随着这种使用的增加，出现了构建工具(如聊天机器人)的机会，以支持混合工作革命。如果你要为Webex构建ChatOps工具，使用<a class="ae jg" href="https://github.com/WebexSamples/webex-node-bot-framework" rel="noopener ugc nofollow" target="_blank"> webex-node-bot-framework </a>将会让你快速启动并运行。</p></div></div>    
</body>
</html>