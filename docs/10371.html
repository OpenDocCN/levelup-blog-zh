<html>
<head>
<title>Create tooling to understand AppleScript better— Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建工具以更好地理解AppleScript第1部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-tooling-to-understand-applescript-better-part-1-2727d6dbac83?source=collection_archive---------8-----------------------#2021-11-29">https://levelup.gitconnected.com/create-tooling-to-understand-applescript-better-part-1-2727d6dbac83?source=collection_archive---------8-----------------------#2021-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="9093" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://gentille.us/applescript-articles-7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank"> AppleScript课程</a></h2><div class=""/><div class=""><h2 id="9269" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">了解一些工具和一些简单的脚本后，您会发现使用AppleScript并不一定是令人沮丧的体验。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/eebda294dca59b27f2d1bfa197346edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iySfWaASdMirlnmK7Y0KCQ.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">合适的工具可以让大工程变得简单</figcaption></figure><p id="1619" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">本文显示的所有代码都可以通过</em> <a class="ae mb" href="https://github.com/Rolias/discover-applescript/tree/main/01-Tooling" rel="noopener ugc nofollow" target="_blank"> <em class="ma">关联的GitHub repo </em> </a> <em class="ma">获得。</em></p><p id="1c09" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">学习AppleScript可能会令人沮丧。我看过的大部分教程都没有解释如何<strong class="lg ja">自己探索</strong>或者<strong class="lg ja">如何寻找更多帮助</strong>，而那是我的两个主要目标。看起来你需要知道很多神奇的字符串、关键词和咒语才能完成任何事情。虽然你确实需要知道很多，但你可以采取系统的方法，用一点知识和一些工具发现你需要的很多东西。</p><p id="80ee" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">我的那些工具之一</em>s<em class="ma">the</em><a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html#//apple_ref/doc/uid/TP40000983-CH208-SW1" rel="noopener ugc nofollow" target="_blank"><em class="ma">AppleScript语言指南</em> </a> <em class="ma">。在整篇文章中，我大量地提供了该文档的链接。我的意图是</em><strong class="lg ja"><em class="ma"/></strong><em class="ma">这篇文章不需要阅读其中的任何链接就可以完全理解，但在你继续自学的过程中，它们会证明是有价值的。</em></p><h1 id="1b2d" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">脚本编辑器</h1><p id="3e46" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">让我们从<code class="fe mz na nb nc b">Script Editor</code>号开始我们的航行。它在你的<code class="fe mz na nb nc b">Applications</code>文件夹里的<code class="fe mz na nb nc b">Utilities</code>文件夹里，但是你可以点击⌘-space并输入“脚本编辑器”来启动它。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2b4d7d2c5a73b1b4d9d5b955645c8f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*et1caAkBJCTGcwjevuJ_nQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">基本脚本编辑器</figcaption></figure><p id="bb1a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这看起来像一个非常简约的编辑器，但我们可以从中学习到很多东西。</p><p id="7744" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">🔥提示——如果你想用VS代码写脚本，我强烈推荐使用</em> <code class="fe mz na nb nc b"><em class="ma">AppleScript</em></code> <em class="ma">扩展。</em></p><h1 id="01d9" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">我们的第一个剧本</h1><p id="71e9" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">让我们从一个功能完整的脚本开始。在编辑器中输入下面的代码，当你点击<code class="fe mz na nb nc b">Play</code>按钮时，系统偏好设置应用程序将会启动，然后<code class="fe mz na nb nc b">Displays</code>面板将会显示。如果没有，检查你的拼写:<code class="fe mz na nb nc b">Displays</code>是复数。AppleScript会因为你的小拼写错误而惩罚你。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/0975eae65d06775b36dd73a0dc96b965.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*QR3d26dlfyw-Fmi8eLvujg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">用于打开“系统偏好设置显示”面板的“简单”Applescript</figcaption></figure><p id="48ae" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这个脚本将命令指向顶层容器<code class="fe mz na nb nc b">application “System Preferences”</code>。它使用<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW60" rel="noopener ugc nofollow" target="_blank">命令</a> <code class="fe mz na nb nc b">activate</code>发射并将<code class="fe mz na nb nc b">System Preferences</code>带到最前面。最后，它告诉首选项应用程序打开<code class="fe mz na nb nc b">Displays</code>首选项窗格。虽然这个脚本本身并不那么有用，但是它的内部有很多值得详细研究的地方。</p><p id="1730" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">首先，我们在<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-158020" rel="noopener ugc nofollow" target="_blank">复合语句表</a>中使用<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_lexical_conventions.html#//apple_ref/doc/uid/TP40000983-CH214-SW7" rel="noopener ugc nofollow" target="_blank">保留关键字</a> <code class="fe mz na nb nc b">tell</code>将我们的命令指向所需的容器。在关键字<code class="fe mz na nb nc b">tell</code>之后，我们需要引用一个对象。在这种情况下，我们使用名为<code class="fe mz na nb nc b">application</code>的内置<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-246384" rel="noopener ugc nofollow" target="_blank">类引用</a>以及应用程序的名称。</p><h1 id="51f0" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">在字典中查找条目</h1><p id="728a" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">我是不是听到你问你怎么知道一个应用程序的名字？好问题。一种方法是使用脚本编辑器的<code class="fe mz na nb nc b">File→Open Dictionary...</code>菜单，在出现的字典窗口<a class="ae mb" href="#1c5b" rel="noopener ugc nofollow"> </a>中向下滚动，选择<code class="fe mz na nb nc b">System Preferences</code>。在这种情况下，您在浏览器中看到的名称和您在字典左上角导航窗格中看到的名称是相同的。情况并不总是这样，当有疑问时，打开应用程序的字典，快速浏览一下。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/dc245fdc074d08af9a098c3478e4626f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*NkJPxVw9w_Gy8HI8bWvs5Q.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">系统偏好设置的字典</figcaption></figure><p id="5e87" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">字典还可以帮助我们发现更多可脚本化的元素。在这种情况下，如果您点击左上方导航窗格中的<code class="fe mz na nb nc b">System Preferences</code>，您将跳过细节窗格中的<code class="fe mz na nb nc b">Standard Suite</code>。你会立即在<code class="fe mz na nb nc b">Elements</code>下面看到短语<code class="fe mz na nb nc b">contains panes</code>。这是我们的关键，当我们将窗格设置为相当直观的“显示”时，你会经常看到使用<code class="fe mz na nb nc b">ids</code>而不是名字。我试着保持简单，但是如果你在非英语版本的macOS上，id会更适合你，但是不要计划去猜测它们。</p><h1 id="e16f" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">使用AppleScript本身查找项目</h1><p id="4d45" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">让我们再写一个脚本，并利用AppleScript本身来探索。当我们在AppleScript的洞穴中探索黑暗、曲折、迷宫般的通道时，这个脚本将作为我们的灯笼，使我们免于被grue吃掉。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/dc7d288c533ad9b3915ecc2b9ed7b429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*8gjFO_4NaMko69X5y6oeCg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">获取所有窗格的名称</figcaption></figure><p id="7053" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里我们使用了<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52" rel="noopener ugc nofollow" target="_blank"> set命令</a>来使我们的脚本及其输出更容易理解。我们首先将AppleScript <strong class="lg ja">全局</strong>常量<code class="fe mz na nb nc b"><a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW38" rel="noopener ugc nofollow" target="_blank">text item delimiters</a></code>设置为<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW7" rel="noopener ugc nofollow" target="_blank">换行</a>。然后我们声明并设置变量<code class="fe mz na nb nc b">names</code>来保存每个<code class="fe mz na nb nc b">pane</code>的<code class="fe mz na nb nc b">name</code>。</p><p id="3b5a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">🔥提示——这种从集合中的每个对象中提取属性的技术是一个有价值且可重用的概念。</em></p><p id="22ef" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然后我们创建另一个变量<code class="fe mz na nb nc b">message</code>，它有一个小标题文本(后面是指定换行符的另一种方式),我们使用<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_operators.html#//apple_ref/doc/uid/TP40000983-CH5g-BAJEGEEC" rel="noopener ugc nofollow" target="_blank">文本连接操作符&amp; </a>来追加换行符分隔的窗格名称列表。然后我们使用命令<code class="fe mz na nb nc b"><a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW12" rel="noopener ugc nofollow" target="_blank">display dialog</a></code>来显示<code class="fe mz na nb nc b">message</code>和一个<code class="fe mz na nb nc b">OK</code>按钮。</p><p id="6cd8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当你运行这个脚本时，不要忘记用<code class="fe mz na nb nc b">OK</code>按钮关闭产生的模态对话框。脚本编辑器中的“停止”按钮不会为您终止脚本。</p><p id="1428" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">再看一下“系统偏好设置”面板的字典条目。窗格还有其他属性，试着用上面脚本中的<code class="fe mz na nb nc b">name</code>替换<code class="fe mz na nb nc b">id</code>。也可以试试<code class="fe mz na nb nc b">localized name.</code></p><p id="7510" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">请记住，当您将一个全局常量设置为一个新值时，您实际上是在全局范围内更改它。这可能会让其他脚本感到惊讶。默认情况下,<code class="fe mz na nb nc b">text item delimiters</code>被设置为<code class="fe mz na nb nc b">""</code>,因此如果您担心它会影响其他脚本，您可以添加一行来将其恢复到该值。</p><h1 id="3cf0" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">探索脚本编辑器</h1><p id="2251" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">最后，我想指出<code class="fe mz na nb nc b">Script Editor</code>的一些好的特性。您可以切换页脚中的<code class="fe mz na nb nc b">Show or Hide the Log</code>按钮来查看脚本的附加输出。</p><ol class=""><li id="8d6b" class="nh ni iq lg b lh li lk ll ln nj lr nk lv nl lz nm nn no np bi translated">使用<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_lexical_conventions.html#//apple_ref/doc/uid/TP40000983-CH214-DontLinkElementID_404" rel="noopener ugc nofollow" target="_blank">行尾注释</a>禁用对话框</li><li id="0768" class="nh ni iq lg b lh nq lk nr ln ns lr nt lv nu lz nm nn no np bi translated">通过单击显示的图标显示日志</li><li id="2d5e" class="nh ni iq lg b lh nq lk nr ln ns lr nt lv nu lz nm nn no np bi translated">运行脚本，结果将显示在多个窗格中，在本例中，我切换到了messages选项卡</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/71a135ed37e8edb90add54b635788001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*uGKPGfWJEQ7ZJscbiyhH0A.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">使用日志</figcaption></figure><p id="e92b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">🔥提示——苹果有一篇关于</em> <a class="ae mb" href="https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/GettoKnowScriptEditor.html#//apple_ref/doc/uid/TP40016239-CH5-SW1" rel="noopener ugc nofollow" target="_blank"> <em class="ma">了解脚本编辑</em> </a> <em class="ma">的非常可读的文章。</em></p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="bcc3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在<a class="ae mb" href="https://gentille.us/7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank">未来的文章</a>中，当我们在AppleScript的水域中航行得更深时，我们将起锚，发现UI元素，并制作日志条目。</p><p id="1c5b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><a class="ae mb" href="#1730" rel="noopener ugc nofollow"> </a>如果您对字典的布局和术语感兴趣，请参见Mac Automation Scripting Guide条目— <a class="ae mb" href="https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/NavigateaScriptingDictionary.html#//apple_ref/doc/uid/TP40016239-CH77-SW1" rel="noopener ugc nofollow" target="_blank">导航脚本字典</a>。</p></div></div>    
</body>
</html>