# 写优化代码前要知道的 5 件事

> 原文：<https://levelup.gitconnected.com/5-things-to-know-before-you-write-optimized-code-3ca424110db1>

## 这些事实有助于你用优化的代码给硬件和程序员留下深刻的印象

![](img/da773bbf86f26f1f43de93199b72cf2b.png)

奥斯卡·伊尔迪兹在 [Unsplash](https://unsplash.com/s/photos/programming?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片，由 Canva 编辑

优化代码是指在程序执行期间消耗最少所需资源的源代码。由于强大的硬件资源，编写优化的代码在现代软件开发中被低估了。几十年前，程序员总是试图通过编写优化的程序来有效地使用可用的计算资源。过去的程序员给一台 [4KB 内存的计算机](https://medium.com/swlh/impressive-sources-codes-that-every-developer-should-see-b68028b36da5)写程序，把人送上月球。但是，现在我们的计算机上至少有 4GB 的内存模块。

如今，大多数计算机用户将未优化的软件程序导致的问题归咎于计算机硬件。幸运的是，优秀的程序员仍然关心软件性能，并努力编写优化的代码。例如，一台 20 岁的电脑仍然可以完美地运行一个现代的 GNU/Linux 发行版。

编写优化的代码是有效的，并且是任何软件项目实现良好的软件质量和稳定性所必需的。编写优化的代码是一种很好的软件工程实践，也是大型科技公司代码库非常需要的。在这个故事中，我将解释在考虑代码优化之前你需要知道的几个概念。

# 堆栈与堆内存概念

操作系统的主要任务是为程序提供资源。世界上所有的程序员要么为操作系统写程序，要么为其他程序写程序。如果你正在编写一个 Nodejs 程序，你正在为运行在操作系统上的 Nodejs 程序编写一个程序。

通过使用特定的内存模型，每个通用程序在执行之前都会被加载到物理内存中。这些内存模型/布局是不同的，取决于编程语言的运行时。然而，每个内存模型通常都有两个通用元素:堆栈和堆。堆栈存储来自函数调用的临时本地数据记录。另一方面，堆在程序执行期间存储全局数据元素。

你使用这两个内存区域的方式直接影响你程序的效率。例如，如果您经常尝试在堆栈帧之间传递大型数据记录，您的程序可能会运行缓慢。另一方面，如果您不小心使用 heap，您的程序可能会因内存泄漏而降低整个操作系统的速度。由于这个原因，大多数 C++程序员通过使用下面的模式来避免传递字符串。

```
void printMsg(const string &msg) { // Instead of "string msg"

}
```

# 可用的特定于语言的数据结构

毫无疑问，使用正确的数据结构是每个高效源代码背后的关键事实之一。每种现代编程语言通常都通过标准库或内置特性提供各种数据结构实现。例如，Golang 提供地图数据结构作为内置特性。此外，C++为堆栈数据结构提供了标准库。

我们需要使用最佳的数据结构来优化源代码的可读性和效率。要为特定场景选择最佳的数据结构，您需要了解您最喜欢的编程语言所支持的数据结构。然而，C 和类 Go 语言并没有正式提供预构建的数据结构，如堆栈、队列、链表等。在这些场景中，您必须选择一个经过良好测试的库或编写自己的实现。

有时，一些第三方数据结构比原始的特定于语言的数据结构实现性能更好。然后，我们必须根据我们想要构建的内容选择一个。例如，当程序员处理很长的列表时，他们经常使用 [NumPy](https://github.com/numpy/numpy) 列表而不是内置列表。

研究通用数据结构确实有助于我们选择最佳的特定语言数据结构。下面的故事进一步解释了它。

[](/why-every-developer-should-learn-data-structures-and-algorithms-bf5cc7d9089f) [## 为什么每个开发人员都应该学习数据结构和算法

### 数据结构和算法不是程序员的必修课，而是更好的程序员的必修课。

levelup.gitconnected.com](/why-every-developer-should-learn-data-structures-and-algorithms-bf5cc7d9089f) 

# 时间复杂性和空间复杂性

程序员通常使用分析工具来分析软件程序的性能。但是，剖析动态地测量算法性能。换句话说，首先，我们需要编写一个程序来分析。作为程序员，我们通过写代码来回答软件工程问题。我们总是需要编写优化和干净的代码来保持代码库的质量。那么，如何才能检验我们即将要写的代码是否足够好呢？

渐近分析理论帮助我们分析计算算法的时间和空间复杂性。在将我们的解决方案转化为代码之前，用渐近分析来思考解决方案的性能总是很好的。

如今，每个程序员都试图更快地编写代码，因为他们通常必须根据计划的里程碑快速交付软件功能。因此，在编写每个源文件之前计算精确的时间复杂度是不现实的。但是，了解渐近分析概念，如[大 O 符号](https://en.wikipedia.org/wiki/Big_O_notation)，有助于我们减少过多的嵌套循环、函数调用和内存使用。此外，了解时间和空间的复杂性有助于我们编写对任何用户输入都有效的代码。

# 各种硬件资源的速度

软件程序通常与各种计算资源通信:寄存器、随机存取存储器块、本地存储驱动器和云计算服务。这些硬件资源具有不同的访问时间。当 CPU 和硬件资源之间的距离增加时，访问时间也会增加。寄存器是存储值最快的硬件资源，因为寄存器位于 CPU 内部。接下来，分别是 RAM、本地存储设备和云计算服务。

优化的源代码总是经常使用快速的硬件资源，而很少使用慢速的硬件组件。由于现代编程语言的抽象性，我们不直接操作 CPU 寄存器。因此，我们需要更多地使用 RAM 进行存储，因为 RAM 是我们可以直接使用的最快的内存模块。

在进行磁盘读取和网络调用之前要三思——因为这些操作会影响整个程序的性能。然而，磁盘读取和网络调用在现代软件项目中是常见且不可避免的。我们可以使用内存缓存、异步操作、并行、分治、临时文件等方法来优化耗时的磁盘和网络相关操作。

下面的故事进一步解释了用于有效处理计算资源的计算机存储器(资源)层次结构。

[](/5-computer-hardware-concepts-that-every-programmer-should-know-32711c759dc0) [## 每个程序员都应该知道的 5 个计算机硬件概念

### 多亏了这些概念，你的计算机执行了你编写的程序

levelup.gitconnected.com](/5-computer-hardware-concepts-that-every-programmer-should-know-32711c759dc0) 

# 过早优化的副作用

编写优化的代码是好的，但是我们总是需要识别哪个组件需要代码优化。我们经常可以看到一些程序员试图优化不需要优化的东西。例如，现在，一些程序员用自动扩展的微服务为简单的项目构建复杂的 web 架构，他们可以用单一的解决方案来解决这些项目。

我们确实不需要通过降低可读性来优化我们编写的每一段代码。大多数性能改进都会影响代码库的可读性和简单性。因此，可以忽略软件程序非关键部分的代码优化。

过度优化和早期优化会影响干净代码实践和整个软件开发团队的生产力。因此，记住过早优化的副作用，开始编写优化的和干净的代码。