<html>
<head>
<title>How to Convert HTML Tables into Beautiful PDFs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将HTML表格转换成漂亮的pdf</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-convert-html-tables-into-beautiful-pdfs-eac2ce4c77de?source=collection_archive---------1-----------------------#2020-11-10">https://levelup.gitconnected.com/how-to-convert-html-tables-into-beautiful-pdfs-eac2ce4c77de?source=collection_archive---------1-----------------------#2020-11-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/20e4c9e4d268dc7b1b85e9da5bb80bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w3YJN3KlcRSmKSF3PSqkhQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图片由<a class="ae kf" href="https://docraptor.com/" rel="noopener ugc nofollow" target="_blank"> DocRaptor </a>提供</figcaption></figure><p id="2a34" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">包含表格、图表和图形的Web应用程序通常包含将数据导出为PDF的选项。作为一名用户，你有没有想过，当你点击那个按钮时，在引擎盖下会发生什么？</p><p id="199d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为开发人员，如何让PDF输出看起来更专业？大多数免费的PDF在线导出程序基本上只是将HTML内容转换成PDF格式，而没有做任何额外的格式化，这会使数据难以阅读。如果您还可以添加诸如页眉和页脚、页码或重复表格列标题之类的内容，会怎么样？像这样的小改动对把一个业余爱好者看起来的文档变成一个优雅的文档大有帮助。</p><p id="284c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最近，我探索了几种生成pdf的解决方案，并制作了<a class="ae kf" href="http://tylerhawkins.info/html-to-pdf-demo/" rel="noopener ugc nofollow" target="_blank">这个演示应用</a>来展示结果。所有的代码都可以在Github 上找到。我们开始吧！</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="d22c" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">演示应用概述</h1><figure class="mk ml mm mn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mj"><img src="../Images/958c1c6b1947c37935b0e0c70a59826e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8VcIxog9T_50m8W2.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">HTML到PDF演示应用程序</figcaption></figure><p id="0a8c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的演示应用程序包含一个冗长的样式化表格和四个将表格导出为PDF的按钮。该应用程序是用基本的HTML、CSS和普通JavaScript构建的，但你可以使用你选择的UI框架或库轻松创建相同的输出。</p><p id="fbf3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个导出按钮使用不同的方法生成PDF。从右向左看，第一个使用本机<a class="ae kf" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/print" rel="noopener ugc nofollow" target="_blank">浏览器打印</a>功能。第二种使用一个名为<a class="ae kf" href="https://github.com/MrRio/jsPDF" rel="noopener ugc nofollow" target="_blank"> jsPDF </a>的开源库。第三个使用另一个名为<a class="ae kf" href="http://pdfmake.org/" rel="noopener ugc nofollow" target="_blank"> pdfmake </a>的开源库。最后，第四个使用一个叫做<a class="ae kf" href="https://docraptor.com/" rel="noopener ugc nofollow" target="_blank"> DocRaptor </a>的付费服务。</p><p id="9050" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们逐一研究每个解决方案。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="7b71" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">本机浏览器打印功能</h1><p id="7f93" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">首先，让我们考虑使用浏览器的内置工具导出PDF。当查看任何网页时，您可以通过右键单击任意位置，然后从菜单中选择打印选项来轻松打印该页面。这将打开一个对话框，供您选择打印设置。但是，您实际上不必打印文档。该对话框还为您提供了将文档保存为PDF的选项，这就是我们将要做的。在JavaScript中，<code class="fe mt mu mv mw b">window</code>对象公开了一个<code class="fe mt mu mv mw b">print</code>方法，因此我们可以编写一个简单的JavaScript函数，并将其附加到我们的一个按钮上，如下所示:</p><figure class="mk ml mm mn gt ju"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="01e5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是谷歌Chrome浏览器的输出:</p><figure class="mk ml mm mn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/368e7db801a5c6f118b669ae883cfe1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uwlXNclEV5umtHbh.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">使用内置打印功能和Chrome浏览器导出的PDF</figcaption></figure><p id="b496" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我对这里的输出感到惊喜。虽然它并不花哨——内容只是黑白的——但主要的表格样式保持不变。此外，七个页面中的每一个都包括表的列标题和表尾，我认为浏览器会智能地拾取它们，因为我在构建一个结构正确的表时选择了语义HTML。</p><p id="e5a2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，我不喜欢浏览器在PDF中包含的额外页面元数据。在顶部附近，我们可以看到日期和HTML页面标题。在这一页的底部，我们有它的印刷网站和页码。</p><p id="6161" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我保存这个文档的唯一目标是查看数据，那么Chrome做得相当好。但是，文档顶部和底部的额外文本行虽然有用，但看起来不太专业。</p><p id="c977" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一个需要注意的是，不同浏览器的原生打印功能是不同的。如果我们使用Safari浏览器打印同样的文档会怎么样？</p><p id="38d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是输出结果:</p><figure class="mk ml mm mn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/f87814d7fc84b9ee96d4c0522c2725f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BSuPKxkPkzpfIorh.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">使用内建打印功能和Safari浏览器导出的PDF</figcaption></figure><p id="5e3c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您会注意到表格看起来大致相同，页眉和页脚内容也是如此。但是，表格的列头和表尾是不重复的！这有点没用，因为当您忘记任何给定的列包含什么数据时，您都需要返回到第一页。第一页上的表格底部也被切掉了一点，因为浏览器在创建下一页之前试图挤进尽可能多的内容。</p><p id="e7f7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，浏览器输出似乎并不理想，可能会因用户选择的浏览器而异。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="7cb4" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">jsPDF</h1><p id="8016" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">接下来让我们考虑一个名为<a class="ae kf" href="https://github.com/MrRio/jsPDF" rel="noopener ugc nofollow" target="_blank"> jsPDF </a>的开源库。这个库已经存在至少五年了，并且每周从NPM下载超过20万次。可以肯定地说，这是一个受欢迎的、久经考验的库。</p><p id="0c04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">jsPDF也相当容易使用。您创建一个新的<code class="fe mt mu mv mw b">jsPDF</code>类实例，给它一个您想要导出的HTML内容的引用，然后提供任何其他附加设置，比如页面边距大小或文档标题。</p><figure class="mk ml mm mn gt ju"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="34b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在幕后，jsPDF使用了一个名为<a class="ae kf" href="https://html2canvas.hertzen.com/" rel="noopener ugc nofollow" target="_blank"> html2canvas的库。</a>顾名思义，html2canvas获取html内容，并将其转换为存储在HTML <code class="fe mt mu mv mw b">&lt;canvas&gt;</code>元素上的图像。jsPDF然后获取画布内容并保存它。</p><p id="08c3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看使用jsPDF得到的输出:</p><figure class="mk ml mm mn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/e99109b36d478ccd70e09ce71600c860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RhnSh0DfBycM6JFu.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">使用jsPDF导出的PDF</figcaption></figure><p id="7acd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">乍一看，这个挺好看的！PDF包括我们漂亮的蓝色标题和条纹表格行背景。它不包含浏览器打印方法包含的任何额外的页面元数据。</p><p id="8da2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，请注意第一页和第二页之间发生了什么。表格一直延伸到第一页的底部，然后又回到第二页的顶部。没有应用额外的边距，并且表格文本内容有可能被减半，这实际上是在第六页和第七页之间发生的事情。</p><p id="cbdc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">PDF也不包括重复的表格列标题或表格页脚，这与我们在Safari的打印功能中看到的问题相同。</p><p id="f578" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然jsPDF是一个功能强大的库，但是当导出的内容只能放在一个页面上时，这个工具可能工作得最好。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="87ce" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">pdfmake</h1><p id="a034" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">让我们来看看我们的第二个开源库，<a class="ae kf" href="http://pdfmake.org/" rel="noopener ugc nofollow" target="_blank"> pdfmake </a>。这个库每周从NPM下载超过300，000次，寿命为7年，比jsPDF更受欢迎，也更高级。</p><p id="9512" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在为我的演示应用程序构建导出功能时，pdfmake的配置比jsPDF要困难得多。原因是pdfmake使用您提供的数据从头开始构建PDF文档，而不是将页面上现有的HTML内容转换为PDF。这意味着，我必须为PDF表格的页眉、页脚、内容和布局提供数据，而不是为pdfmake提供对HTML表格的引用。这导致了我代码中的大量重复；我首先在我的HTML中编写了表格，然后用pdfmake重新构建了用于PDF导出的表格。</p><p id="68ee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下所示:</p><figure class="mk ml mm mn gt ju"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="8455" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们完全忽略pdfmake之前，让我们看一下输出:</p><figure class="mk ml mm mn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nc"><img src="../Images/c44a4ea884ed0e962b99c2353898dd7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yabcyNXZQ1-kCiux.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">使用pdfmake导出的PDF</figcaption></figure><p id="6355" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不算太寒酸！我们开始为表格添加样式，所以我们仍然可以复制蓝色的列标题和条纹状的表格行背景。我们还获得了重复表格的列标题，以便于跟踪我们在每页的每列中看到的数据。</p><p id="6590" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">pdfmake还允许我添加页眉和页脚，所以添加页码很容易。您会注意到，第一页和第二页之间的表格内容仍然没有完全分开。分页符在页面之间部分分割2002年的行。</p><p id="1757" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总的来说，pdfmake最大的优势似乎是从零开始构建pdf。例如，如果您想基于一些订单数据生成一张发票，而您实际上并没有在web应用程序的屏幕上显示发票，那么pdfmake将是一个很好的选择。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="19f0" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">DocRaptor</h1><p id="336c" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">我们将考虑的最后一个选项是<a class="ae kf" href="https://docraptor.com/" rel="noopener ugc nofollow" target="_blank"> DocRaptor </a>。DocRaptor与我们探索的前三个选项不同，它是一个付费服务。它使用Prince HTML-to-PDF引擎来生成PDF导出。这个服务也是通过API使用的，所以您的代码会遇到一个外部API端点，然后它会返回PDF文档。</p><p id="1f2f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本的DocRaptor配置相当简单。您向它提供您的文档的名称、您想要创建的文档的类型(在我们的例子中是<code class="fe mt mu mv mw b">'pdf'</code>)以及要使用的HTML内容。根据你的需要，有数百种不同配置的其他选择，但是基本配置是一个很好的起点。</p><p id="2030" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是我用过的:</p><figure class="mk ml mm mn gt ju"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="5339" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们来看看DocRaptor生成的PDF导出:</p><figure class="mk ml mm mn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/3019cfeb195f9f6da7cc2d65fc202294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KhlYTuw3ntB_P67F.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">使用DocRaptor导出的PDF</figcaption></figure><p id="7e87" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在有一个好看的文档了！我们可以保持我们漂亮的餐桌风格。表格列标题和表格页脚在每一页上都是重复的。表格行不会被截断，并且页面的所有边上都有适当大小的边距。页眉也在每一页上重复出现，每页底部的页码也是如此。</p><p id="0215" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了<a class="ae kf" href="https://help.docraptor.com/en/articles/1067094-headers-footers-for-pdfs" rel="noopener ugc nofollow" target="_blank">创建页眉和页脚文本</a>，DocRaptor建议您使用带有<code class="fe mt mu mv mw b">@page</code>选择器的CSS，如下所示:</p><figure class="mk ml mm mn gt ju"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="dc39" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">说到PDF输出，DocRaptor显然是赢家。</p><p id="41c7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ne">(作为额外的奖励，看看一个</em> <a class="ae kf" href="http://tylerhawkins.info/html-to-pdf-demo/styled-header.html" rel="noopener ugc nofollow" target="_blank"> <em class="ne">全出血样式的HTML标题</em> </a> <em class="ne">会是什么样子！)</em></p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="9806" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="c08c" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">那么，你的app选择哪个选项呢？如果您想要最简单的解决方案，并且不需要专业外观的文档，本机浏览器打印功能应该就可以了。如果您需要对PDF输出进行更多的控制，那么您将需要使用一个库。</p><p id="c901" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当涉及到基于UI中显示的HTML生成的单页内容时，jsPDF大放异彩。当从数据而不是从HTML生成PDF内容时，pdfmake效果最好。DocRaptor是其中最强大的，它有简单的API和漂亮的PDF输出。但是，与其他服务不同的是，这是一项有偿服务。但是，如果您的业务依赖于优雅、专业的文档生成，DocRaptor是非常值得的。</p></div></div>    
</body>
</html>