<html>
<head>
<title>JavaScript Tips — Base64 to Blob, JSON, Dates, and Input</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript技巧— Base64到Blob、JSON、日期和输入</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-tips-base64-to-blob-json-dates-and-input-63f45df1972e?source=collection_archive---------5-----------------------#2020-07-07">https://levelup.gitconnected.com/javascript-tips-base64-to-blob-json-dates-and-input-63f45df1972e?source=collection_archive---------5-----------------------#2020-07-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/57fa537442fb2e41c7cb6ba67d78705a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3wPFEafmj72-wshp"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@toddquackenbush?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托德·夸肯布什</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="81d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="03ba" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">JSON.stringify和JSON.parse之间的区别</h1><p id="ef1b" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated"><code class="fe mh mi mj mk b">JSON.strignify</code>和<code class="fe mh mi mj mk b">JSON.parse</code>做不同的事情。</p><p id="586c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">JSON.stringify</code>将一个对象转换成一个JSON字符串。</p><p id="6616" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">JSON.parse</code>将一个JSON字符串解析成一个对象。</p><p id="d027" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以通过书写使用<code class="fe mh mi mj mk b">JSON.stringify</code>;</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="a6af" class="mt lf it mk b gy mu mv l mw mx">const obj = { foo: 1, bar: 2 };<br/>const str = JSON.stringify(obj);</span></pre><p id="0acf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">str</code>是<code class="fe mh mi mj mk b">obj</code>的字符串版本。</p><p id="fbb3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过写来使用<code class="fe mh mi mj mk b">JSON.parse</code>:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="cbaa" class="mt lf it mk b gy mu mv l mw mx">const obj = JSON.parse(str);</span></pre><p id="c03b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果<code class="fe mh mi mj mk b">str</code>是一个有效的JSON字符串，那么它将被解析成一个对象。</p><h1 id="4f41" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">删除字符串中的重音符号或音调符号</h1><p id="9769" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们的字符串中有重音符号或音调符号，我们可以使用<code class="fe mh mi mj mk b">normalize</code>方法将其删除。</p><p id="08be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="25cb" class="mt lf it mk b gy mu mv l mw mx">const str = "garçon"<br/>const newStr = str.normalize("NFD").replace(/[\u0300-\u036f]/g, "")</span></pre><p id="24af" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么<code class="fe mh mi mj mk b">newStr</code>就是<code class="fe mh mi mj mk b">“garcon”</code>。</p><p id="e8b4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">NFD</code>表示Unicode范式。</p><p id="c745" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它将组合的字素分解成更简单的字素的组合。</p><p id="19d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此<code class="fe mh mi mj mk b">ç</code>被分解成字母和音调符号。</p><p id="1fa3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们用<code class="fe mh mi mj mk b">replace</code>去掉所有的重音字符。</p><h1 id="da10" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">解析JSON时出现“意外标记o”错误</h1><p id="57d2" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们试图解析的东西已经是一个对象，我们将得到“意外的标记o”错误。</p><p id="8af2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们应该确保我们没有解析JSON对象。</p><h1 id="4f8c" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">检测浏览器语言首选项</h1><p id="6adf" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过使用<code class="fe mh mi mj mk b">window.navigator.userLanguage</code>或<code class="fe mh mi mj mk b">window.navigator.language</code>来检测浏览器语言偏好。</p><p id="74ef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">window.navigator.userLanguage</code>仅在IE中可用。</p><p id="7a68" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">window.navigator.language</code>在其他浏览器中可用。</p><p id="1591" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它返回在Windows区域设置中设置的语言。</p><p id="e4a7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">window.navigator.language</code>返回浏览器语言，而不是首选语言。</p><h1 id="3077" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">用JavaScript从Base64字符串创建Blob</h1><p id="b7c3" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要从base64字符串创建blob，我们可以使用<code class="fe mh mi mj mk b">atob</code>函数。</p><p id="2031" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们必须从字符串的每个字符创建一个字节值数组。</p><p id="cf5a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们将字节数数组转换成一个<code class="fe mh mi mj mk b">Uint8Array</code>。</p><p id="4420" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以将它传递给<code class="fe mh mi mj mk b">Blob</code>构造函数。</p><p id="bb78" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们写道:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="e2af" class="mt lf it mk b gy mu mv l mw mx">const byteCharacters = atob(b64Data);<br/>const byteNumbers = new Array(byteCharacters.length);<br/>for (let i = 0; i &lt; byteCharacters.length; i++) {<br/>    byteNumbers[i] = byteCharacters.charCodeAt(i);<br/>}<br/>const byteArray = new Uint8Array(byteNumbers);<br/>const blob = new Blob([byteArray], {type: contentType});</span></pre><p id="333e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">去做这一切。</p><h1 id="b69f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">获取当前日期和时间</h1><p id="d16e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用JavaScript中的<code class="fe mh mi mj mk b">Date</code>实例的各种方法来获取当前的日期和时间。</p><p id="fcd4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">getDate</code>获取一个月中的某一天。</p><p id="83c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">getDay</code>获取星期几，0表示星期日，1表示星期一，依此类推。</p><p id="12eb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">getFullYear</code>返回整年的数字。</p><p id="b75c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获取一天中的小时数。</p><p id="40f7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">getMinutes</code>返回一小时中的分钟数。</p><p id="b061" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">getSeconds</code>获得秒。</p><p id="ab9c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过书写来使用它:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="d760" class="mt lf it mk b gy mu mv l mw mx">const newDate = new Date();<br/>const day = newDate.getDay();</span></pre><p id="4564" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以使用<code class="fe mh mi mj mk b">toLocaleString</code>方法以一种对地区敏感的方式格式化我们的日期字符串:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="2544" class="mt lf it mk b gy mu mv l mw mx">new Date().toLocaleString();</span></pre><h1 id="f3aa" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在我们输入内容时跟踪变化的最佳方式</h1><p id="fc69" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了跟踪我们在输入框中输入的变化，我们可以监听<code class="fe mh mi mj mk b">input</code>事件。</p><p id="4944" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="50c6" class="mt lf it mk b gy mu mv l mw mx">const input = document.getElementById('input');<br/>const result = document.getElementById('result');</span><span id="7062" class="mt lf it mk b gy my mv l mw mx">const inputHandler = (e) =&gt; {<br/>  result.innerHTML = e.target.value;<br/>}<br/><br/>source.addEventListener('input', inputHandler);</span></pre><p id="1290" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用<code class="fe mh mi mj mk b">e.target.input</code>在<code class="fe mh mi mj mk b">inputHandler</code>中获得输入值。</p><p id="55fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，我们在<code class="fe mh mi mj mk b">result</code>元素中设置输入值。</p><p id="a52e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们调用<code class="fe mh mi mj mk b">addEventListener</code>来监听输入事件。</p><h1 id="d60d" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">JavaScript中“= &gt;”的含义</h1><p id="82c5" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated"><code class="fe mh mi mj mk b">=&gt;</code>让我们创建一个箭头函数，它是一个不绑定到<code class="fe mh mi mj mk b">this</code>的更短的函数。</p><p id="727f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们不能使用箭头函数作为构造函数。</p><p id="9952" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它从外部获取<code class="fe mh mi mj mk b">this</code>的值。</p><p id="bd45" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它也没有绑定到<code class="fe mh mi mj mk b">arguments</code>对象，所以我们不能用它来获取传递给函数的参数。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/9e4fa03c29902769484c7aaa6dc6e9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CEIaBM-LLY4wJecP"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@davidvig?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> David Vig </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="e136" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="3fb4" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated"><code class="fe mh mi mj mk b">JSON.stringify</code>和<code class="fe mh mi mj mk b">JSON.parse</code>是彼此相反的。</p><p id="6a03" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">=&gt;</code>让我们创建箭头函数。</p><p id="3fc9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以监听<code class="fe mh mi mj mk b">input</code>事件来获取用户在输入框中输入的值。</p><p id="5af5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获取当前日期和时间可以用date方法来完成。</p><p id="9d4e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以将base64字符串转换为blob。</p></div></div>    
</body>
</html>