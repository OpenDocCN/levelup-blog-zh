<html>
<head>
<title>Creating a browser game with React-Three</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React-Three创建一个浏览器游戏</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-a-browser-game-with-react-three-3813c9f3664b?source=collection_archive---------5-----------------------#2022-07-21">https://levelup.gitconnected.com/creating-a-browser-game-with-react-three-3813c9f3664b?source=collection_archive---------5-----------------------#2022-07-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="addd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我一直很喜欢用three.js构建的很酷的东西，从外观整洁的网站到很酷的动画，甚至是成熟的浏览器游戏！你所能构建的唯一限制是你的想象力(以及你用普通js编码的意愿)。我也一直很欣赏React应用程序的简单和整洁，以及以html风格定义和使用自己的组件的能力。在React Three之前，没有很好的方法将这两者融合在一起(中间没有一些hacky js胶水)。现在我们有能力创建一个完整的three.js场景，只需要几个React组件！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/73c40521d1f9362faae7d4e11f67092b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vqJJBp1Vhu_3T5VzbpU71Q.png"/></div></div></figure><p id="ba4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，我们将制作一个小的浏览器游戏，类似于吃豆人，玩家是黄色的方块，将会走来走去吃掉粉红色的小球。</p><p id="681e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我将从头到尾引用的完整github回购的链接。<a class="ae kx" href="https://github.com/mattmacf98/react-xr-game" rel="noopener ugc nofollow" target="_blank">https://github.com/mattmacf98/react-xr-game</a></p><h2 id="72d3" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">设置</h2><p id="2b68" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">首先，让我们创建一个样板react项目并安装依赖项(它们非常小，只有三个和一个允许react与三个进行对话的库)。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="cf7f" class="ky kz iq lx b gy mb mc l md me">npm install three @react-three/fiber</span></pre><p id="bd5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还应该创建我们的CSS，使我们的三个画布占据整个屏幕。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="5f9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们将更新我们的index.js，不使用默认的严格模式(这使得所有东西在我们的开发环境中渲染两次，并导致balls成对加载)。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mf mg l"/></div></figure><h2 id="0348" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">网格</h2><p id="a204" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">在我们的<strong class="jp ir"> App.js </strong>文件的顶部，我们将为玩家和小球创建两个组件。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="6d29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以通过给它一些道具来创建一个网格，比如位置、旋转、缩放等等……(更多信息见https://docs.pmnd.rs/react-three-fiber/api/objects<a class="ae kx" href="https://docs.pmnd.rs/react-three-fiber/api/objects" rel="noopener ugc nofollow" target="_blank">的文档)。然后我们给出一个网格子组件来确定所用的材料和几何图形。我还使用了一个ref对象，这样我就可以在我的js中与网格进行交互。</a></p><h2 id="a010" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">应用程序组件</h2><p id="3dfd" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">现在，在同一个<strong class="jp ir"> App.js </strong>文件中，我们将像这样添加我们的应用程序组件</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mf mg l"/></div></figure><ol class=""><li id="2aad" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated">我们为将要更新的球创建一个<strong class="jp ir"> ref </strong>，为内部游戏时钟、玩家网格以及组件是否已安装创建<strong class="jp ir"> state </strong>。</li><li id="2811" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">然后我们设置我们的<strong class="jp ir">使用效果。</strong>我只想启动球生成一次，这样它就没有依赖关系了，它只在组件生命周期开始时被触发。播放器监听器需要等待组件被安装(以及播放器被实例化)。一旦被装载，我不想创建更多的侦听器，所以我将把setUpListeners()函数包装在if中，以便只在我们没有被装载时触发。我们想检查球或球员更新时是否会发生碰撞，所以我将它们都设置为依赖关系。并且游戏时钟仅仅等待一秒钟并更新(这又将再次触发该效果，因为时间是其依赖性)。</li><li id="5156" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated"><strong class="jp ir"> generateBalls() </strong>启动了一个函数，每5秒钟它将在x-y坐标中随机添加一个球(我添加了一个nonce生成，这样这些球的组件键将是唯一的)。</li><li id="5416" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated"><strong class="jp ir"> SetUpListeners() </strong>监听用户在w、a、s、d键上的输入，并相应地移动播放器网格。</li><li id="e093" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">CheckIfCollide() 是一个非常简单的碰撞检测算法，它只是在所有的球上循环，看看球员的X-Y是否等于球的X-Y，如果是，它将移除那个球。</li><li id="6aaa" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">我们<strong class="jp ir">在一个&lt; Canvas &gt;标签中返回</strong>我们所有的three.js组件。我们有灯光，我们的球员，以及当前在我们的balls ref中的所有球(请注意我之前调用的关键道具)</li></ol><p id="3fd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是它的全部，你已经拥有了一个内置在React中的很酷的小浏览器游戏的雏形！你可以在这里做更多的事情，比如允许屏幕随着用户移动，这样他们就可以探索更多的区域，或者你可以创建一些分数跟踪器，并提供影响你的球员外观的电源。你甚至可以建立一个服务器，把游戏放到网上，让人们在多人模式下玩。唯一的限制实际上是您的想象力(以及您不得不花费时间对没有按照您期望的方式更新状态变量的React大喊大叫)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/3381a386a53586552abee162202fc6d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*xK2KcWUvMxxaTTZ0YVv7pA.gif"/></div></figure></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="ff5d" class="nd kz iq bd la ne nf ng ld nh ni nj lg nk nl nm lj nn no np lm nq nr ns lp nt bi translated">分级编码</h1><p id="43ee" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="7547" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk nu mn mo mp bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="8709" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk nu mn mo mp bi translated">📰查看<a class="ae kx" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="dcc0" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk nu mn mo mp bi translated">🔔关注我们:<a class="ae kx" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kx" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kx" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li><li id="625d" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk nu mn mo mp bi translated">🚀👉<a class="ae kx" href="https://jobs.levelup.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">软件工程师的顶级工作</strong> </a></li></ul></div></div>    
</body>
</html>