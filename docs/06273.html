<html>
<head>
<title>Useful Angular Tips and Tricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有用的角度提示和技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/useful-angular-tips-and-tricks-f38df8276cc0?source=collection_archive---------3-----------------------#2020-11-10">https://levelup.gitconnected.com/useful-angular-tips-and-tricks-f38df8276cc0?source=collection_archive---------3-----------------------#2020-11-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b02ee6e79519af86fae5ebf1325a0be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bMhoKx4GnaiQ8m4UXDdfbA.jpeg"/></div></div></figure><div class=""/><p id="5eda" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">官方的Angular文档包含了一些有效开发的最佳实践，但是还有其他的技巧可以帮助你使你的应用程序更容易维护和优化。</p><p id="332a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里列出了我每天在Angular中使用的<strong class="kd jf">技巧和诀窍</strong>，它们将帮助你开发更好的应用程序。</p><h1 id="34c2" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">使用服务来处理副作用</h1><p id="c978" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">在构建你的应用程序时，<strong class="kd jf">减少诸如HTTP请求、基于时间的事件等副作用总是有用的。</strong></p><p id="a605" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将这些类型的操作从组件抽象为服务将会<strong class="kd jf">降低组件的复杂性</strong>，并且还会确保服务的可重用性<strong class="kd jf">。</strong></p><p id="15a6" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一个典型的例子是从外部服务器获取数据:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="cca8" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一种显示远程端点收到的项目列表的合理方式，我们有一个专用的方法，<strong class="kd jf"> getItems() </strong>，它将进行HTTP GET调用并将结果保存在一个本地变量中。</p><p id="c274" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就功能而言，这段代码没有任何问题，代码完成了它的工作并向用户显示了列表，但是<strong class="kd jf">获取项目所使用的方法是组件本地的，不能重用</strong> <em class="mi">，</em>，如果在其他组件中获取项目，将重复整个过程<em class="mi">。</em></p><blockquote class="mj"><p id="01b9" class="mk ml je bd mm mn mo mp mq mr ms ky dk translated"><em class="mt"> Angular给了我们一个有用的工具来避免所有这些与使用服务有关的事情。</em></p></blockquote><p id="1330" class="pw-post-body-paragraph kb kc je kd b ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku my kw kx ky im bi translated">让我们创建一个专用的Angular服务，并重构组件以用于外部请求:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="3a2c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我们将在组件中使用它:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><blockquote class="mj"><p id="bc2f" class="mk ml je bd mm mn mz na nb nc nd ky dk translated">该服务可用于获取应用程序范围内的项目。</p></blockquote><h1 id="7d0e" class="kz la je bd lb lc ld le lf lg lh li lj lk ne lm ln lo nf lq lr ls ng lu lv lw bi translated">使用ng add</h1><p id="a153" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">这个在Angular版本6中引入的工具可以用来<strong class="kd jf">将一个发布的包添加到您的工作环境</strong>中，它将在后台运行schematics来更新您的应用程序的功能。</p><p id="937b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用此命令下载软件包时，它还会安装运行所需的额外依赖项，如polyfills等。</p><p id="8b8b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Ng add为您的Angular应用程序提供了一些实用程序，例如使用服务工作将它转换为渐进式web应用程序，并提供离线功能。</p><p id="8fc5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，如果您想在应用程序中实现渐进式web应用程序功能，只需运行以下命令:</p><pre class="mc md me mf gt nh ni nj nk aw nl bi"><span id="6d7d" class="nm la je ni b gy nn no l np nq">ng add @angular/pwa</span></pre><p id="ef8b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可以很容易地用ng add安装任何类型的包</p><pre class="mc md me mf gt nh ni nj nk aw nl bi"><span id="2207" class="nm la je ni b gy nn no l np nq">ng add @angular/material</span></pre><h1 id="e3c9" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">对导入语句使用别名</h1><p id="74b7" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果你正在开发复杂的组件，使得你的代码更加难以阅读，那么导入语句可能会非常混乱。</p><p id="32f1" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当你导入一个组件、一个服务或者任何你想导入到你的组件中的东西时，<strong class="kd jf">你需要明确地写出资源所在的完整路径</strong></p><pre class="mc md me mf gt nh ni nj nk aw nl bi"><span id="c9bc" class="nm la je ni b gy nn no l np nq">import { ThatComponent } from '../../../components/this-component/child-component'</span><span id="bff3" class="nm la je ni b gy nr no l np nq">import { ThisService } from '../../../../services/this-service'</span></pre><p id="9de3" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您为<code class="fe ns nt nu ni b">components</code>和<code class="fe ns nt nu ni b">services</code>路径使用别名会更有帮助，<strong class="kd jf">这将使这些导入相对容易读取和导入</strong>。</p><p id="e621" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了在你的Angular应用中实现这一点，你需要更新<code class="fe ns nt nu ni b">tsconfig.json</code>文件:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="7add" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe ns nt nu ni b">compilerOptions</code>下，你可以找到具有默认值<code class="fe ns nt nu ni b">./</code>的<code class="fe ns nt nu ni b">baseUrl</code>属性，我们所做的是更新该值以指向<code class="fe ns nt nu ni b">src</code>目录</p><p id="fdae" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后添加一个名为<code class="fe ns nt nu ni b">paths</code>的新属性，它是一个包含键值对的对象，这些键值对表示在我们的应用程序中为路径定义的别名，在上面的例子中，我们为<code class="fe ns nt nu ni b">components</code>文件夹和<code class="fe ns nt nu ni b">services</code>文件夹定义了别名。</p><p id="ee0a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，让我们改变之前的例子</p><pre class="mc md me mf gt nh ni nj nk aw nl bi"><span id="505d" class="nm la je ni b gy nn no l np nq">import { ThatComponent } from '@components/this-component/child-component';</span><span id="3539" class="nm la je ni b gy nr no l np nq">import { ThisService } from '@services/this-service';</span></pre><p id="6ecb" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如你现在所看到的，更加清晰易读。</p><h1 id="41bb" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">字符串插值的安全导航运算符</h1><p id="deff" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">当使用角度模板中的对象时，您会遇到这样的情况:变量被声明而没有默认值— <strong class="kd jf">变量只是作为类型定义</strong>出现。</p><p id="5a50" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当试图访问变量上不可用的属性时，<strong class="kd jf"> Angular将抛出一个错误，称该变量未定义</strong>。</p><p id="3cbb" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，您的模板如下所示，您正在读取一个<code class="fe ns nt nu ni b">student</code>对象的<code class="fe ns nt nu ni b">name</code>属性:</p><pre class="mc md me mf gt nh ni nj nk aw nl bi"><span id="2981" class="nm la je ni b gy nn no l np nq">&lt;p&gt;{{ student.name }}&lt;/p&gt;</span></pre><p id="1a52" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这就是变量在组件文件中的声明方式:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><blockquote class="nv nw nx"><p id="1485" class="kb kc mi kd b ke kf kg kh ki kj kk kl ny kn ko kp nz kr ks kt oa kv kw kx ky im bi translated">Angular会在这里抛出一个错误。</p></blockquote><p id="3c2b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用<strong class="kd jf">安全导航操作符</strong>，我们可以保护<code class="fe ns nt nu ni b">name</code>属性不受任何<code class="fe ns nt nu ni b">null</code>和<code class="fe ns nt nu ni b">undefined</code>值的影响。</p><p id="1f1c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Angular中的安全导航操作符是这个语法<code class="fe ns nt nu ni b">?.</code>，我们可以更新模板来使用它:</p><pre class="mc md me mf gt nh ni nj nk aw nl bi"><span id="e5b3" class="nm la je ni b gy nn no l np nq">&lt;p&gt; {{ student?.name }} &lt;/p&gt;</span></pre><blockquote class="mj"><p id="3c04" class="mk ml je bd mm mn mz na nb nc nd ky dk translated">当你运行这个，Angular不会抛出任何错误，你的控制台是清晰的。</p></blockquote><p id="7f73" class="pw-post-body-paragraph kb kc je kd b ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku my kw kx ky im bi translated">避免这种错误的另一个有用的技术是使用and ( <code class="fe ns nt nu ni b">&amp;&amp;</code>)操作符<strong class="kd jf">在读取属性路径</strong>之前检查该值是否存在。</p><p id="9cfe" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以更新示例以使用以下语法:</p><pre class="mc md me mf gt nh ni nj nk aw nl bi"><span id="091e" class="nm la je ni b gy nn no l np nq">&lt;p&gt; {{ student &amp;&amp; student.name }} &lt;/p&gt;</span></pre><p id="d3ea" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果该值不存在，Angular将避免计算表达式，并且标记之间不会呈现任何内容。</p><h1 id="8861" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">使用错误处理程序正确处理错误</h1><blockquote class="mj"><p id="9406" class="mk ml je bd mm mn mo mp mq mr ms ky dk translated">Angular附带了一个异常处理服务，可以用来管理应用程序范围内的错误。</p></blockquote><blockquote class="nv nw nx"><p id="d1d0" class="kb kc mi kd b ke mu kg kh ki mv kk kl ny mw ko kp nz mx ks kt oa my kw kx ky im bi translated">当服务检测到错误时，它会捕获错误并将其记录到控制台。</p></blockquote><p id="f606" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该服务可以扩展，以添加我们的应用程序独有的附加功能，如使用错误监控平台记录错误或将错误发送到您的服务器进行分析。</p><p id="59a9" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这很容易扩展:我们需要创建一个<code class="fe ns nt nu ni b">class</code>来扩展<code class="fe ns nt nu ni b">ErrorHandler</code>的属性，并覆盖用于显示错误的内置<code class="fe ns nt nu ni b">handleError</code>方法。</p><p id="f103" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">创建一个名为<code class="fe ns nt nu ni b">error-handler.class.ts</code>的文件:</p><p id="f96f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在上面的代码片段中，我们使用了一个虚构的错误报告和监控库，名为<code class="fe ns nt nu ni b">@error-reporters</code>。</p><p id="bb2f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在扩展了<code class="fe ns nt nu ni b">ErrorHandler</code>服务之后，我们将在用ErrorHandler的<code class="fe ns nt nu ni b">handleError</code>方法处理错误之前，用<code class="fe ns nt nu ni b">handleError</code>方法报告来自应用程序的错误。</p><p id="551a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">之后，我们应该在<code class="fe ns nt nu ni b">app.module.ts:</code>中注册我们的自定义<code class="fe ns nt nu ni b">AppErrorHandler</code></p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="1a7d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可以通过Angular <a class="ae ob" href="https://angular.io/api/core/ErrorHandler" rel="noopener ugc nofollow" target="_blank">点击</a>阅读更多关于默认错误处理程序的信息。</p><h1 id="7a3a" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">延迟加载非重要组件</h1><p id="55ca" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果你不想有无限的负载或者UI冻结，那么使用大型应用程序需要更多的关注性能。</p><p id="5b41" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Angular应用程序由模块组成，您可以管理它们的加载，以确保应用程序初始渲染不需要的组件是延迟加载的。</p><blockquote class="mj"><p id="183c" class="mk ml je bd mm mn mo mp mq mr ms ky dk translated">惰性加载可以有效地减少你的应用程序的包大小，从而减少应用程序在浏览器上的加载时间。</p></blockquote><p id="cf37" class="pw-post-body-paragraph kb kc je kd b ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku my kw kx ky im bi translated">要开始使用延迟加载，你至少需要两个模块，一个是你的应用程序的起点，通常是<strong class="kd jf"> app.module </strong>，其他的可以代表用户可以导航的不同页面。</p><p id="b4e5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，让我们创建一个<strong class="kd jf">功能模块</strong>，当用户导航到路径…/功能时，必须加载该功能模块。</p><p id="5700" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是我的功能模块的外观</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="7fec" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它是一个基本模块，包含一个组件<code class="fe ns nt nu ni b">FeatureComponent</code>和一个与之相连的路由模块<code class="fe ns nt nu ni b">FeatureRoutingModule</code>。</p><p id="d549" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了延迟加载特性模块及其组件，<strong class="kd jf">我们将在应用程序的根模块</strong>中注册它的路由模块，在我的例子中是app.module:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="c623" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">通过这些简单的步骤，将在主应用捆绑包之外构建一个单独的捆绑包，当用户导航到<code class="fe ns nt nu ni b">/feature</code>路线时，它将被加载。</p><p id="c113" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这种体验可能会有点不愉快，因为用户需要等待<strong class="kd jf">路线的包被加载</strong>，这可能需要一段时间，具体取决于包的<strong class="kd jf">大小。</strong></p><p id="a842" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了解决这个问题，我们将在初始页面完全加载后在后台预取其他包。</p><p id="5def" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以使用Angular提供的名为<code class="fe ns nt nu ni b">preloadStrategy</code>的内置标志来做到这一点。</p><blockquote class="nv nw nx"><p id="9a77" class="kb kc mi kd b ke kf kg kh ki kj kk kl ny kn ko kp nz kr ks kt oa kv kw kx ky im bi translated">这告诉Angular在加载闲置的包时使用哪种策略。</p></blockquote><p id="0deb" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们更新当前的实现以使用<code class="fe ns nt nu ni b">PreloadAllModules</code>策略:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="027b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">通过此次更新，Angular将在后台处理功能包的预取，以便于导航。</p><h1 id="d2cb" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">结论</h1><p id="6145" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">Angular是一个框架，有它做事和产生结果的方式。</p><p id="ff25" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它有这么多流行和未知的特性，使用Angular <strong class="kd jf">发现完成困难任务的技巧的最简单方法是更多地使用Angular，并在过程中进行更多的研究</strong>。</p><p id="8bba" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">上面列出的提示和技巧并没有完全涵盖使用Angular的广泛功能可以做的事情。</p><p id="9bc7" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢阅读！</p></div></div>    
</body>
</html>