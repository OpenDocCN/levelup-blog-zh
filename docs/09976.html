<html>
<head>
<title>Deep Dive Into TLS Handshake</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入了解TLS握手</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deep-dive-into-tls-handshake-e029e28e2eb3?source=collection_archive---------4-----------------------#2021-10-11">https://levelup.gitconnected.com/deep-dive-into-tls-handshake-e029e28e2eb3?source=collection_archive---------4-----------------------#2021-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ae5c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">逐步解释TLS 1.2握手过程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/834a18be3921a445e4c53875cbae6e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xGaaSiqDTjGHdUXlMclrlA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">叶卡捷琳娜·博洛夫索娃摄于<a class="ae ky" href="https://www.pexels.com/photo/man-people-woman-business-6077239/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a></figcaption></figure><p id="5e2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前阵子我给<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-resolve-certificate-errors-in-nodejs-app-involving-ssl-calls-781ce48daded">写了一篇关于如何解决SSL证书错误</a>的文章。本文简要讨论了TLS握手。还有很多细节没有披露。</p><p id="667f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">令我惊讶的是，自从<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/what-i-learnt-from-writing-technical-blogs-d4e9163ff24c">我开始写技术博客</a>以来，这篇文章成为我的媒体文章中被浏览次数最多的一篇。我猜读者会感兴趣，因为这篇文章用简单的英语解释了SSL概念。这促使我写这篇文章。</p><p id="2c94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们深入了解一下TLS握手过程。</p><p id="deac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">向前跳:</p><ul class=""><li id="80a5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="#c43f" rel="noopener ugc nofollow">概述</a></li><li id="1084" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#4d66" rel="noopener ugc nofollow">第一步:客户问候</a></li><li id="e263" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#d84e" rel="noopener ugc nofollow">第二步:服务器Hello </a></li><li id="abb1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#80d8" rel="noopener ugc nofollow">步骤3:客户端密钥交换</a></li><li id="a0af" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#124d" rel="noopener ugc nofollow">步骤4:服务器更改密码规范</a></li><li id="60e4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#1aab" rel="noopener ugc nofollow">结论</a></li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="bf85" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">什么是TLS握手？</h2><p id="9b7f" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">TLS 握手负责在客户端和服务器之间建立安全连接。当您通过HTTPS访问网站时，TLS握手发生在您的浏览器和web服务器之间，因此您的浏览器可以通过安全连接与web服务器通信。</p><p id="48dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TLS握手的主要目的是</p><ul class=""><li id="1bfd" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">协商密码套件和TLS版本</li><li id="b4a1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">对服务器和客户端进行身份验证</li><li id="4e87" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">交换密钥</li></ul><p id="07ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TLS握手有两个常见版本:TLS 1.2和TLS 1.3。TLS 1.3于2018年被IETF发布为<a class="ae ky" href="https://datatracker.ietf.org/doc/rfc8446/" rel="noopener ugc nofollow" target="_blank"> RFC 8446 </a>。它是TLS 1.2的改进版本。</p><p id="69d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们只讨论TLS 1.2。如果你理解TLS 1.2握手过程，TLS 1.3会很容易，因为它是一个简短的版本。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="7d22" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">概观</h2><p id="ea18" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">握手过程包括客户端和服务器之间交换的大量消息。它们可以分为4个主要步骤。</p><ul class=""><li id="f533" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">客户你好</li><li id="1a12" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">服务器你好</li><li id="e99f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">客户端密钥交换和更改密码规范</li><li id="1655" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">服务器更改密码规范</li></ul><p id="0d73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的截图是<a class="ae ky" href="https://www.wireshark.org/" rel="noopener ugc nofollow" target="_blank"> Wireshark </a>捕捉到的握手过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e5a5af62cf02f7421e6232b80c4b5123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DlIIpvDyOokf5MuFBamHqQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">wireshark的握手过程</figcaption></figure><p id="8542" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们一个一个地研究它们。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="4d66" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">第一步:客户问候</h2><p id="4735" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">“<code class="fe np nq nr ns b">Client hello"</code>消息是请求服务器开始TLS握手。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/a0876ab30da829ec86ea33cd7357bdda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-i1RdVjA_9P6zBR2ZOjyA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">握手步骤1</figcaption></figure><p id="5571" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是捕获的<code class="fe np nq nr ns b">client hello</code>请求包。该消息包括客户端的TLS版本、随机值和支持的密码套件列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/b2d3790541a48de08277c4e2022dd738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HMJm2I7fOa0VICqDgxOcUw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">客户你好</figcaption></figure><p id="51d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随机值将由服务器保存，以便稍后生成预主密钥。支持的密码套件列表允许服务器选择双方可以用来通信的密码套件。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="1495" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">第二步:服务员你好</h2><p id="2c1e" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">收到<code class="fe np nq nr ns b">Client Hello</code>消息后，服务器将</p><ul class=""><li id="9165" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">确认它是否支持TLS版本</li><li id="f01f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">从<code class="fe np nq nr ns b">Client Hello</code>消息的列表中选择一个密码套件</li><li id="afb5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">生成服务器随机值</li></ul><p id="2d7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务器将通过发送一个包含TLS版本、随机值和选择的密码组的<code class="fe np nq nr ns b">Server Hello</code>消息来响应。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/484ac86a818959f0ac0a7cbcde1eb280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HdBZmzg2cD7CBqkKdwJgbw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">握手步骤2:服务器你好</figcaption></figure><p id="3fc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从下面的Wireshark数据包捕获中，我们可以看到服务器Hello消息的内容。它确认TLS版本1.2是相互支持的，并且是密码套件首选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/58a35a66b31791284a2a011e8719a741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x7fMFEynXWzs9mkOBc36OQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">服务器你好</figcaption></figure><p id="33b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的密码套件命名可能看起来令人困惑。一般规则如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/4a996c796bb2826982ca3224db9e8a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*UWmVjOi0PwaT4v4x2G0Euw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">来源:微软密码套件</figcaption></figure><p id="20e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，上面选取的密码套件:<code class="fe np nq nr ns b">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xc02f)</code>表示:</p><ul class=""><li id="c065" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman" rel="noopener ugc nofollow" target="_blank"> ECDHE </a>来交换密钥</li><li id="dce3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">RSA是身份验证算法</li><li id="79a6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">AES_128_GCM是加密算法</li><li id="782f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">SHA256是哈希算法</li></ul><p id="83bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于身份验证的目的，服务器还会将其SSL证书链发送给客户端。它还可以向客户端请求证书。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/ca95345b0edc8d2446ab6a668e8a4cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6XUA8BUsK4_RhgsyubfF4g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">服务器证书</figcaption></figure><p id="e6ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该步骤中的最后一条消息是<code class="fe np nq nr ns b">Server Hello Done</code>消息。就是告诉客户端所有的消息都已经发给你了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/e8d46d9998ba0873729fba778e9e8743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNaZ8nDtytA-0m_-kEom3w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">服务器Hello完成</figcaption></figure><p id="9c0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">客户端证书请求</strong></p><p id="ea20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可选地，服务器可能也想要验证客户端。在这个步骤中，服务器可以发送一个<code class="fe np nq nr ns b">client certificate request</code>。该请求包括支持的证书类型和ca的列表。服务器将在收到客户端的响应后验证客户端的证书。</p><p id="7c3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe np nq nr ns b">client certificate request</code>通常是服务器到服务器通信所必需的。例如，当一个内部web服务器试图与另一个web服务器通信时，它们需要相互验证。</p><h2 id="80d8" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">步骤3:客户端密钥交换</h2><p id="16da" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在客户端接收到服务器证书后，它将执行一系列验证步骤来<a class="ae ky" href="https://en.wikipedia.org/wiki/Certificate_authority" rel="noopener ugc nofollow" target="_blank">验证证书</a>。如果结果是肯定的，那么客户端将继续到<code class="fe np nq nr ns b">Client Key exchange</code>。</p><p id="a9ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe np nq nr ns b">Client Key exchange</code>消息取决于从前面步骤中选择的公钥算法。客户端使用由RSA算法加密的预主密钥或ECDHE进行密钥交换和身份验证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/59872ea0543ed579b04fb7de6a2ac261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tS-otFSNlSD_YcT6FeTWZg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">握手步骤3</figcaption></figure><p id="062e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的示例中，密钥交换是通过ECDHE完成的，如下面的数据包捕获。这意味着客户端和服务器使用ECDHE参数来生成预主密钥。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/3c5132c279281415bf294705f9e8a1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4YMD0V1ruUeTjWKOC7BnXg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">客户端密钥交换</figcaption></figure><p id="1b1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务器收到<code class="fe np nq nr ns b">Client Key exchange</code>消息后，将使用ECDHE参数和随机值计算预主密钥。</p><p id="25bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，客户端和服务器都使用预主密钥来生成会话密钥。客户端发送“更改密码规范”消息，通知另一方它正在切换到加密。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/92b60a6cf9b49d2ca737034d737d9d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7bU8cehOCj5W-uAHLLMaAg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">更改密码规格</figcaption></figure><p id="7812" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">客户端发送一个最终的“完成”消息，表示它已经完成了握手的一部分。从现在开始，所有的信息都被加密了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/aedde84dbe301c8373ac2e0152abe653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzikMUyf7pjPbK_ynaAj8Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">握手完成消息</figcaption></figure><p id="7bfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">可选客户端证书</strong></p><p id="a219" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果服务器已经向客户端请求了证书(步骤2)，则客户端会将证书发送给服务器。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="124d" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">步骤4:服务器更改密码规范</h2><p id="d4ef" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">作为最后一步，服务器做同样的事情。它发送“更改密码规范”消息以指示它更改为加密通信。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/0b90c000ac8ba677a385cd8cd7f90d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JUE6wtvzDD2Hd-mk1fUVA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">握手步骤4 —服务器密钥交换</figcaption></figure><p id="40b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe np nq nr ns b">Change Cipher Spec</code>消息之后发送完成消息。这是为了确认密钥交换和身份验证过程已成功完成。下面的数据包捕获显示了服务器“完成”消息的示例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/04ddd87766d623e0559bb0456205b248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*86wyUj50OTHfhfUkcbRuVQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">握手完成</figcaption></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="1aab" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">摘要</h2><p id="5f47" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">TLS握手在幕后悄悄地发生。对于互联网来说，这是一个必不可少的过程，就像水和电对于现代社会一样。我们可能只有在它不能正常工作时才意识到它的存在。</p><p id="a8e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为开发人员，了解内部机制可以帮助您在复杂的环境中对应用程序进行故障排除。</p><p id="dd12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这篇文章对你有用。</p><p id="a09b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="og">如果您还不是Medium的付费会员，</em> <a class="ae ky" href="https://sunnysun-5694.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="og">您可以访问此链接</em> </strong> </a> <em class="og">。你可以无限制地阅读媒体上的所有报道。我会收你一部分会员费作为介绍费。</em></p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="c307" class="oh mr it bd ms oi oj ok mv ol om on my jz oo ka nb kc op kd ne kf oq kg nh or bi translated">参考</h1><p id="11b5" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">[1]Docs.microsoft.com。2021.<em class="og">TLS/SSL(Schannel SSP)中的密码套件— Win32应用</em>。[在线]可从以下网址获取:&lt;https://docs . Microsoft . com/en-us/windows/win32/sec authn/cipher-suites-in-schannel&gt;【2021年10月10日获取】。</p><p id="8b63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]En.wikipedia.org。2021.<em class="og">椭圆曲线迪菲-赫尔曼-维基百科</em>。[在线]见:&lt;https://en . Wikipedia . org/wiki/Elliptic-curve _ Diffie % E2 % 80% 93 hellman&gt;【2021年10月10日获取】。</p><p id="7d47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3]Ibm.com。2021.<em class="og"> IBM文档</em>。【在线】可在:&lt;https://www.ibm.com/docs/en/ibm-mq/7.5?topic = SSL-overview-TLS-handshake&gt;【2021年10月10日访问】。</p></div></div>    
</body>
</html>