<html>
<head>
<title>Working Kubernetes for your personal projects for 5 Euros / Month</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为你的个人项目工作，每月5欧元</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/working-kubernetes-for-your-personal-projects-for-5-euros-month-badb0d648c2c?source=collection_archive---------1-----------------------#2021-12-16">https://levelup.gitconnected.com/working-kubernetes-for-your-personal-projects-for-5-euros-month-badb0d648c2c?source=collection_archive---------1-----------------------#2021-12-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="083e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用廉价的VPS运行单节点Kubernetes集群，为您的项目提供足够的资源。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0383d85aa77f0a0b9a2a18484819166d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzP3aAMlQrCfwmoa0eWtqw.jpeg"/></div></div></figure><p id="f068" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不要误解我，我仍然相信树莓派集群是学习Kubernetes最好玩的方式之一。我仍然推荐，如果你想<a class="ae lq" href="https://medium.com/swlh/yet-another-raspberry-pi-k8s-cluster-ea05fb48e9a8" rel="noopener">学习如何用Kubernetes创建你自己的集群，你可以点击这个链接</a>查看我的第一篇文章。</p><p id="bf9c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不过，过一会儿，您会希望将您的Kubernetes集群暴露给家庭网络之外的外部世界。</p><p id="660b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有几种方法可以允许入站连接进入您的本地网络并访问您的家庭实验室，但也有一大串为什么这不是一个好主意的理由。</p><p id="cc5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">主要的替代方案是使用云提供商管理的解决方案。AK，EKS，等等。问题是:这些服务对小项目来说太贵了。</p><p id="9825" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一段时间以来，我一直在尝试在一些廉价的虚拟处理器上运行k8s集群，今天我将在这里描述我的成功经验。</p><h2 id="7ade" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">不是所有的VP都一样。</h2><p id="d82f" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">除了价格和资源信息(很容易在提供商的页面上找到)之外，还有隐藏的配置和限制，它们可能会破坏您的集群安装。</p><p id="c37b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不幸的是，没有简单的方法来解决这个问题，这个过程更多的是在试错的层面上。</p><p id="9045" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我尝试了3个VPS服务，价格差不多，只有最后一个创建了Kubernetes集群:Contabo。</p><p id="8acc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">大约花7美元，你就可以得到一个配有4个vCPU、8GB内存和50GB NVMe磁盘的VPS(可以用同样价格的200GB固态硬盘代替)。</p><p id="91cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有一些缺点，因为服务器在德国(你可以支付额外的费用让服务器在美国)。并且以太网连接对于当前的世界标准(100MB)来说很慢</p><p id="3595" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对我来说，这种权衡行得通，也许对你也适用。</p><h2 id="1bd6" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">选择正确的Kubernetes发行版</h2><p id="a7b1" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">有几种安装k8s的方法，从通过kubeadm手动安装到一些“发行版”安装你需要的一切甚至更多。<br/>如果你看了我的文章，你可能已经知道我的选择:K3s。</p><p id="9482" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我真的很喜欢他们所做的，创建一个定制的Kubernetes安装slim，只有你需要的资源，同时足够灵活，如果你想改变部分。牧场主的人真了不起。</p><p id="59af" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我还在这个服务器上成功地测试了kubeadm和microk8s，所以不要担心，其他选项也可以在那里工作。</p><h2 id="7bf0" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">这个计划</h2><p id="2c22" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">这里的最终目标是拥有一个工作的单节点k8s集群，带有cert-manager(使用加密)，一个使用自定义持久卷(主机映射)的简单网站。</p><p id="7354" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要跟进，你只需要一个域名和一台服务器。</p><p id="1328" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们开始吧</p><h2 id="2288" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">安装K3s</h2><p id="49cc" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">琐碎的安装在这里，我们使用默认值，包括Traefik。新的K3s现在包括Traefik 2，所以，没有理由安装没有它，以后再添加。</p><p id="c73e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ssh登录到您的服务器后，您只需执行以下命令:</p><pre class="kj kk kl km gt mp mq mr ms aw mt bi"><span id="cf04" class="lr ls it mq b gy mu mv l mw mx">curl -sfL <a class="ae lq" href="https://get.k3s.io" rel="noopener ugc nofollow" target="_blank">https://get.k3s.io</a> | sh -</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/7de74de042b9621062f1cc45045d2906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCQpmM_UbevBunOYLYJxJA.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">K3s安装</figcaption></figure><p id="db18" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在离开ssh之前，我们只需要复制Kubernetes配置，然后就可以通过kubectl远程访问它</p><p id="da98" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">K3安装将配置存储在/etc/rancher/k3s文件夹中。</p><p id="5153" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们检查一下:</p><pre class="kj kk kl km gt mp mq mr ms aw mt bi"><span id="c588" class="lr ls it mq b gy mu mv l mw mx">cat /etc/rancher/k3s/k3s.yaml</span></pre><p id="9653" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您的本地机器中没有任何其他的Kubernetes配置，那么您只需要将它复制到您的~/中。kube文件夹将服务器地址从127.0.0.1更改为您的VPS IP。</p><p id="5919" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您的本地机器中已经有一个k8s配置，您需要手动将这个配置文件中的值复制到右边，或者您可以使用我在这里描述的命令<a class="ae lq" href="https://medium.com/swlh/yet-another-raspberry-pi-k8s-cluster-part-2-k3s-installation-fc93fb5313a1" rel="noopener"/>。</p><p id="8b61" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后一件事，在退出ssh终端之前，确保创建共享文件夹:/shared/demosite，并在那里放一些index.html。可能是由以下命令创建的单个文本:</p><pre class="kj kk kl km gt mp mq mr ms aw mt bi"><span id="2e55" class="lr ls it mq b gy mu mv l mw mx">sudo mkdir /shared/demosite<br/>echo "demosite, testing..." &gt; /shared/demosite/index.html</span></pre><p id="04c9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，为了测试集群配置，退出ssh连接并从本地机器上运行kubectl get nodes</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/3c01dfa81d070e94dc7e8e15bb963421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eEx0t9yLDoOup2TOQghUOQ.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">kubectl获取节点</figcaption></figure><h2 id="5f01" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">持久卷</h2><p id="4c0f" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">这在这里并不必要，但是因为您将来在任何严肃的工作中都需要它，所以让我们将其配置为“概念验证”</p><p id="5857" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要在Kubernetes中使用卷，您需要2个配置:持久卷和声明(PVC)。在更高级的情况下，您可以使用存储类来提交您的申请并自动创建PV。我在关于NFS配置的文章中解释了更多，你可以在这里看到它<a class="ae lq" rel="noopener ugc nofollow" target="_blank" href="/how-to-use-nfs-in-kubernetes-cluster-storage-class-ed1179a83817">。</a></p><p id="600b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文使用的所有YAML文件都可以在GitHub中找到:【https://github.com/fabiofernandesx/VPS-K8s】T4</p><p id="59ed" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们从名称空间开始，将所有内容隔离在特定的名称空间中总是一个好的做法，这样更有条理，而且只需一个命令就可以非常容易地删除所有内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/db778a04f53dd8ac1f210de1db101e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*j38VFdY5albWL9Dfj7DKLA.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">命名空间yaml</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/7f43b5a535499a708ef097f57b87741a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWJE18jC578QzjMPwUI2dQ.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">命名空间</figcaption></figure><p id="6bf7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后让我们创建PV</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/ba7863694cabbe414b221b669881ca82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*dB1gYLeVfuHhuLaaQwr3rw.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">演示网站pv.yaml</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/c412a3275485ba325ed87909b72abf00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OaitRswiCh9ZJr5ohi98xQ.png"/></div></div></figure><p id="494c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">聚氯乙烯呢</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/ceeffe20f62aa7a66c0bf7e7d4dea0f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YwTgC2Nea-tZkiC8tnO79A.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">演示网站-pvc.yaml</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/279c727e8e01f75603902fc0d38d303b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_C1qsRYei5LjXbT5naygg.png"/></div></div></figure><p id="6872" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">检查是否所有的东西都在那里并且在这里完成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/e535fc7be2d9cd7472f6c3a932e82751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SZVVFP4_0J37gnnYOM96Tw.png"/></div></div></figure><h2 id="174b" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">办理证件</h2><p id="03b1" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">部署我们网站前的最后一步。我想带着专业的感觉部署它，而且，现在没有理由部署任何没有安全性的东西。</p><p id="b1d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将在这里使用let's encrypt，但是我将在我们的集群中安装一个CertManager服务，而不是直接使用它。这样做有一些好处，但其中之一是您的证书作为机密存储在集群中，而不是存储在本地磁盘中。</p><p id="282e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那么，我们开始吧。</p><p id="87a8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将直接从GitHub的项目中应用YAML，这取决于您何时阅读它，版本可能会有所不同:</p><pre class="kj kk kl km gt mp mq mr ms aw mt bi"><span id="0896" class="lr ls it mq b gy mu mv l mw mx">kubectl apply -f https://github.com/jetstack/cert-manager/releases/download/v1.6.1/cert-manager.yaml</span></pre><p id="ec73" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将在我们的集群中创建一些东西，请耐心等待，等待一切完成后再继续。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/f11f75eac95df041d2192b03f41e35db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LIumrC5CMnECh_Eq-uApw.png"/></div></div></figure><p id="cc1d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以使用以下命令检查一切是否都在运行:</p><pre class="kj kk kl km gt mp mq mr ms aw mt bi"><span id="7d66" class="lr ls it mq b gy mu mv l mw mx">kubectl get all -n cert-manager</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/4b08fb8a2eb4ec0ae954c2bf10b21ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5p3jYSCXOrgVAC5DdbeSQ.png"/></div></div></figure><p id="d61f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下一步是告诉CertManager我们希望使用Let's Encrypt来生成证书。为此，我们需要在集群中创建一个不同的对象，即ClusterIssuer:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/ac831b96930accec493a63ac07a35c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wm7xI0SGiQ-KOVXwKsqGow.png"/></div></div></figure><p id="ac1c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这个文件中，您唯一需要更改的是“让我们加密”的电子邮件，其他的都准备好了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e2b64705f84efd3619407d945a47aed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l2kS97XTnZa_PJ9oGby5Xw.png"/></div></div></figure><p id="b376" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以使用以下命令验证发行者:</p><pre class="kj kk kl km gt mp mq mr ms aw mt bi"><span id="bd39" class="lr ls it mq b gy mu mv l mw mx">kubectl get clusterissuers</span></pre><p id="8d86" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们为我们的演示站点创建一个证书</p><p id="d72c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了让它工作，你需要你的域名指向你的VPS IP，理想情况下，任何子域都应该重定向到这个IP。</p><p id="f341" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将在这里使用我的开发域(ff1.dev ),并仅为这个示例创建一个子域(https://demo.ff1.dev)</p><p id="6229" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是YAML的档案:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/8b7d697fed18891c0a5d9e677ab0c8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HaK2paeIgOKMgdr-RcNeow.png"/></div></div></figure><p id="cf41" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同样，在应用此配置之前，请等待您的域/子域指向VPS IP地址。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/6cb7560fb791296369959d56dcc48b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEWkLqPXC22P7u5Nvl8bjw.png"/></div></div></figure><p id="7d9c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以使用下面的命令检查证书(就绪状态应该从False变为True):</p><pre class="kj kk kl km gt mp mq mr ms aw mt bi"><span id="bf89" class="lr ls it mq b gy mu mv l mw mx">kubectl get certificates -n demo-site</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/266af046363f87ba8ce00fe17356d934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKP80XADZ13NUcGqzM5eJw.png"/></div></div></figure><h2 id="1cf2" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">部署网站</h2><p id="118e" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">最后，准备好持久性卷和证书，让我们部署我们的网站。为此，我们需要再应用3个文件:</p><ul class=""><li id="057d" class="ns nt it kw b kx ky la lb ld nu lh nv ll nw lp nx ny nz oa bi translated">部署</li><li id="4814" class="ns nt it kw b kx ob la oc ld od lh oe ll of lp nx ny nz oa bi translated">服务</li><li id="6a2e" class="ns nt it kw b kx ob la oc ld od lh oe ll of lp nx ny nz oa bi translated">进入</li></ul><p id="6624" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们从部署文件开始</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/0ec5a1c8a427a6d7000004a32de21e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tQutjYQwFvy2q7LoUIjISA.png"/></div></div></figure><p id="b413" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里没有什么特别的，一个使用我们之前创建的持久卷声明的Nginx容器的一个副本的部署配置。</p><p id="0dcf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">服务文件，再一次，没有什么特别的，普通的和旧的TCP服务到我们的集群:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/f5fc8d154ce747275fdae8f7a440b7f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tP4PxnGz9Gv3JxiRwzn-JA.png"/></div></div></figure><p id="3e0e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后是入口文件来完成所有的工作。小心主机名中的`(反斜杠),它不是单引号</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/c4576d8ec55157c66d727471e1ddc60d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zO1jptefEQgsz46kvU1Aag.png"/></div></div></figure><p id="3497" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">应用一切并验证它是否运行无误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/245e2835655f74b7a534a5ca52125ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*btWO_LsIUld1Duf7dLtl7A.png"/></div></div></figure><p id="14dd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就是这样…您的网站应该可以通过浏览器访问:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/cf1c1da2fa709438db5d290cc83f33e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yjl7cU_4u8f8Yv9yvrasRA.png"/></div></div></figure></div></div>    
</body>
</html>