<html>
<head>
<title>React Context API: Quickest State Management Implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React上下文API:最快的状态管理实现</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-context-api-quickest-state-management-implementation-f9abd6658e66?source=collection_archive---------2-----------------------#2019-10-21">https://levelup.gitconnected.com/react-context-api-quickest-state-management-implementation-f9abd6658e66?source=collection_archive---------2-----------------------#2019-10-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8ceb6ea7720cb8f772bc89d7902c79bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GhXWYN7DOOW0uQOQFhDSMg.png"/></div></div></figure><p id="443b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Redux是在中小型应用程序中实现全局状态管理的有效方法。在本指南中，我们将会看到在你的应用中实现状态管理的最简洁、最快、最简单的方法！这些简单的步骤将花费您不到五分钟的时间，并且您将启动并运行您自己的全局状态管理系统。</p><p id="8553" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用React上下文API，它已经包含在React中，因此我们不必为这个项目安装任何额外的包。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="bb4c" class="lf lg iq lb b gy lh li l lj lk">npx create-react-app contextpractice</span></pre><p id="b1b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们首先创建一个包含初始逻辑的小文件<code class="fe ll lm ln lb b">state.js</code>。代码将在幕后为您处理一切，所以现在不要担心理解它。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="dfbd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后将这个文件导入到<code class="fe ll lm ln lb b">App.js</code>中。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="b7d9" class="lf lg iq lb b gy lh li l lj lk">import { StateProvider } from "./state"</span></pre><p id="8319" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的示例应用程序将是一个简单的计数器，可以使用我们的全局状态来增加和减少。</p><p id="6e82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在App.js中，我们将执行三个简单的步骤:</p><p id="a59e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1)创建初始状态:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="0398" class="lf lg iq lb b gy lh li l lj lk">const initialState = {<br/>   counter: 0<br/>}</span></pre><p id="37a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2)创建一个具有增减功能的减速器:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="a843" class="lf lg iq lb b gy lh li l lj lk">const reducer = (state, action) =&gt; {<br/>   switch (action.type) {<br/>      case "increaseCounter":<br/>         return {<br/>            ...state,<br/>            counter: state.counter + 1<br/>         };<br/>      case "decreaseCounter":<br/>         return {<br/>            ...state,<br/>            counter: state.counter - 1<br/>         };<br/>      default:<br/>         return state;<br/>      }<br/>};</span></pre><p id="ce9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3)用我们刚刚导入的<code class="fe ll lm ln lb b">StateProvider</code>包装我们的应用程序。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="ce89" class="lf lg iq lb b gy lh li l lj lk">return (<br/>   &lt;StateProvider initialState={initialState} reducer={reducer}&gt;<br/>      &lt;Counter /&gt;<br/>   &lt;StateProvider&gt;<br/>   )<br/>}</span></pre><p id="2a17" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您的<code class="fe ll lm ln lb b">App.js</code>文件应该如下所示:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="289b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是我们的全球状态管理！我们现在可以在应用程序中包含的任何组件中使用我们的状态。让我们看看如何访问和更新类组件中的状态。</p><p id="3798" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先创建一个<code class="fe ll lm ln lb b">Counter.js</code>文件。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="50ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从任何组件访问我们的状态只需三个简单的步骤:</p><ol class=""><li id="a320" class="lq lr iq ka b kb kc kf kg kj ls kn lt kr lu kv lv lw lx ly bi translated">导入状态上下文:<code class="fe ll lm ln lb b">import { StateContext } from ".state"</code></li><li id="073d" class="lq lr iq ka b kb lz kf ma kj mb kn mc kr md kv lv lw lx ly bi translated">渲染前功能:<code class="fe ll lm ln lb b">static contextType = StateContext</code></li><li id="d3a1" class="lq lr iq ka b kb lz kf ma kj mb kn mc kr md kv lv lw lx ly bi translated">渲染函数之后，返回之前:<code class="fe ll lm ln lb b">const [{ counter }, dispatch] = this.context</code></li></ol><p id="b4ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在可以访问<code class="fe ll lm ln lb b">counter</code>状态变量，并且我们可以使用<code class="fe ll lm ln lb b">dispatch</code>来更新状态:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="a581" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不到5分钟，我们就在应用程序中实现了全局状态管理！🎉</p><p id="82e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们练习添加另一块到我们的状态。如果我们想给我们的<code class="fe ll lm ln lb b">increaseCounter</code>函数传递一个参数呢？比如要递增的量？让我们在App.js中创建另一个计数器<code class="fe ll lm ln lb b">counter2</code>，以及一个新的<code class="fe ll lm ln lb b">increase</code> / <code class="fe ll lm ln lb b">decrease</code>计数器函数:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="9b44" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意，在<code class="fe ll lm ln lb b">increaseCounter2</code>中，我们说:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="bd0b" class="lf lg iq lb b gy lh li l lj lk">counter: state.counter + action.increment</span></pre><p id="6257" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将把一个名为<code class="fe ll lm ln lb b">increment</code>的参数传递给<code class="fe ll lm ln lb b">Counter.js</code>中的<code class="fe ll lm ln lb b">dispatch</code>函数，该函数将保存我们希望计数器增加的值。让我们看看它是如何工作的:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="cf61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的调度函数现在看起来像这样:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="e0ff" class="lf lg iq lb b gy lh li l lj lk">dispatch({type: "increaseCounter2", increment: 10})</span></pre><p id="ede3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">增量参数然后作为<code class="fe ll lm ln lb b">action.increment</code>传递给我们的缩减器。</p><p id="d04c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢阅读！如果你喜欢这篇文章，留下一点掌声，如果这个过程的任何部分让你感到困惑，留下评论🎉</p><p id="e908" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Github库:<a class="ae me" href="https://github.com/deeayeen/medium-context" rel="noopener ugc nofollow" target="_blank">https://github.com/deeayeen/mediumcontextpractice</a></p></div></div>    
</body>
</html>