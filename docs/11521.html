<html>
<head>
<title>SQL Querying for Beginners: LEFT JOINs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者的SQL查询:左连接</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/sql-querying-for-beginners-left-joins-ede3b7959873?source=collection_archive---------24-----------------------#2022-03-22">https://levelup.gitconnected.com/sql-querying-for-beginners-left-joins-ede3b7959873?source=collection_archive---------24-----------------------#2022-03-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b940" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个对初学者友好的关于左连接在SQL中如何工作的解释</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5e147b3ce1ec930ca061f719a45283fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vwjUlKJL_7WgrmdL"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">阿迪·戈尔茨坦在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。谢谢你，阿迪！</figcaption></figure><h1 id="201a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="9495" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">连接，尤其是左连接，是SQL中最常用的操作之一。在第一次学习查询时，它们也是最难概念化的。</p><p id="538a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">部分问题在于，虽然网上有大量的资源可以用来自学SQL，但其中很多资源并不适合初学者。<a class="ae kv" href="https://dev.mysql.com/doc/refman/8.0/en/join.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mp">官方文档有时会过于全面，不利于基础知识的学习。</em> </strong> </a></p><p id="2b93" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">作为一名数据分析师，我几乎每天都在从事SQL工作。我也花了相当多的时间向没有多少技术专长的人解释技术概念。对于“基础知识”，我指的是对某些SQL函数在基础层面上做什么的理解——这是任何与关系数据库交互的人都应该具备的，无论他们是否担任高度技术性的角色。</p><p id="65d6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这就是为什么我决定为初学者写一个围绕SQL查询的系列文章，从这篇关于左连接的文章开始。<strong class="lq ir"> <em class="mp">本系列的目的是使常见的SQL概念尽可能简单和具体，同时仍然是一个有用的技术参考。</em> </strong>也许有一天我会回头解释查询语法的基本构件——从中选择、<em class="mp">以及<em class="mp">WHERE</em>——但是现在，本文假设您至少理解这些基础知识。</em></p><h1 id="664f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">连接的概念</h1><h2 id="d7c2" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">什么是联接？</h2><p id="c4f0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在SQL数据库中，您最经常处理的是多个表。<strong class="lq ir"> <em class="mp">连接就是将两个或更多的表合并成一个表。</em> </strong></p><h2 id="b243" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">为什么要使用联接？</h2><p id="b8a2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">使用连接有几个原因。这些原因包括但不限于:</p><ul class=""><li id="f204" class="nc nd iq lq b lr mk lu ml lx ne mb nf mf ng mj nh ni nj nk bi translated">将列从一个表添加到另一个表</li><li id="3061" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">只查看有一些共同点的记录，比如客户列表</li><li id="29bf" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">为聚合设置一个表，否则这是不可能的</li></ul><p id="0c69" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果这些理由还不太合理，那也没关系。这里的要点是连接可以用于许多不同的目的。每当你需要查看一个表中没有组织好的数据时，你可以使用一个连接。 </p><h2 id="08f0" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">但是连接是如何工作的呢？</h2><p id="2253" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这就是联接概念化开始变得困难的地方。我将首先用非技术术语总结这个问题的答案，然后用技术术语替换那些术语。</p><p id="cb4e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在最简单的层面上，连接的工作原理是决定一个表中的一行与另一个表中的一行有什么共同点。基于这种关系，第二个表中的行的信息可以添加到第一个表中的行。T3】</p><p id="ec2d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在交换术语之前，先看一个快速分步示例:</p><ol class=""><li id="6333" class="nc nd iq lq b lr mk lu ml lx ne mb nf mf ng mj nq ni nj nk bi translated">一张桌子描述了一家餐馆的特色披萨。第一列包含比萨饼的名称。该表中的另外两列包含奶酪的类型和调味汁的类型。每行描述一个比萨饼。</li><li id="a200" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nq ni nj nk bi translated">第二个表格描述了餐馆比萨饼上的配料。第一列包含比萨饼的名称。第二列包含该比萨饼的特色配料列表。</li><li id="2bd3" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nq ni nj nk bi translated">餐馆中每种比萨饼的名称都出现在两张表中。<strong class="lq ir"> <em class="mp">通过识别这两个表的共同点，可以执行连接。</em> </strong>例如，这样做的结果可能是一个包含比萨饼名称、奶酪类型、酱料类型以及所有浇头的表，每行代表一个特色比萨饼。</li></ol><p id="06b9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">本质上就是这样。真的。</p><p id="ecdf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在来看看更专业的定义:</p><p id="1eb2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="mp">通过识别两个或多个表中的外键和主键来联接工作。这些键之间的关系决定了表的组合方式。</em>T11】</strong></p><p id="dd2b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这个技术定义可能让你的大脑有点混乱，但是相信我，它远没有听起来那么复杂。是那种<em class="mp">看到就知道</em>的东西。</p><p id="0354" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">所以，让我们一起行动起来。</p><h1 id="56e5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">左连接</h1><h2 id="82a3" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">“左”和什么有关系？</h2><p id="f398" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">左连接是数据分析师或科学家最常使用的连接类型之一。当然，这并不能说明它们是什么。</p><p id="f268" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">把下面的表格想象成并排的。第一张桌子在左边。第二个在右边。</p><p id="60c0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">表1:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="7ef0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">表2:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="17a6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在左连接中，表# 1——左边的表——可以被认为是基础。这意味着，除非在查询的不同部分另有说明，否则表#1中的所有内容在连接的表中看起来都是一样的。 </p><p id="0a3c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在是实际数据:</p><ul class=""><li id="76ca" class="nc nd iq lq b lr mk lu ml lx ne mb nf mf ng mj nh ni nj nk bi translated">表#1包含一个虚构公司的五个虚构雇员的数据，称为“雇员”。</li><li id="86ae" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">表2包含公司四个办事处的数据，称为“办事处”。</li></ul><p id="7ccb" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">当我们对这两个表执行左连接时，表#2中的数据将“左移”与表#1中的数据合并。</p><h2 id="0ef0" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">好的，但是主键和外键是怎么回事？</h2><p id="aae4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir"> <em class="mp">主键是唯一的标识符。</em> </strong>每条记录只能有一个主键。每个主键都是不同的。</p><p id="2485" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在第一个表中，主键是<em class="mp"> employee_id </em>。每个雇员都有一个ID。任何两个雇员都不能有相同的ID。</p><p id="96f0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在第二个表中，主键是<em class="mp">代码</em>。相同的交易-每个办公室都有一个代码，没有两个办公室可以有相同的代码。</p><p id="2b1a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">外键是相同的概念，但有一点需要注意。<strong class="lq ir"> <em class="mp">一个表中的外键是另一个表中的主键。</em> </strong></p><p id="bcab" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在我们的例子中，只有一个外键。它是雇员表中的<em class="mp"> office_code </em>字段。</p><ul class=""><li id="8d7d" class="nc nd iq lq b lr mk lu ml lx ne mb nf mf ng mj nh ni nj nk bi translated">请注意，虽然每个办公室只能有一个<em class="mp">代码</em>，但多个员工可以有相同的<em class="mp"> office_code </em>(因为他们在同一个办公室工作)。这种非唯一性是外键的一个定义特性。</li></ul><p id="20ed" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">执行联接时，必须在SQL查询中指定主键和外键。您还可以通过在代码中首先对表进行排序来告诉查询哪个表应该被视为基表(或左表)。我们马上就会看到如何操作，但是这两个属性决定了连接的工作方式。</p><h2 id="baf1" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">那么这在实践中是什么样子的呢？</h2><p id="1fb4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在这种情况下，非常简单。归根结底，连接只是表的组合，因此在SQL中，<strong class="lq ir"><em class="mp">JOIN子句被插入到与表名相同的位置:FROM语句中。</em> </strong>具体来说，它在下面。</p><p id="8106" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果不选择特定的列，那么在employees和offices表中执行的左连接如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="bfd4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">因为这是一个左连接，所以顺序中的第一个表被认为是“左”表或基表，并且保持不变。<strong class="lq ir"><em class="mp">JOIN语句的ON部分告诉SQL这两个表有什么共同点(它们各自的键)以及数据应该如何组合在一起。</em> </strong></p><p id="6999" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">例如，上述查询的结果是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2234" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们的第二个表，offices表，根据ON语句与employees表合并。具体来说，ON语句告诉SQL，在这个连接中，employees表中的每个<em class="mp"> office_code </em>都必须等于office表中的<em class="mp"> code </em>。</p><p id="3b77" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">无论是哪种情况，办公室的各种数据点——城市、州和电话号码——都集成到连接的表中。例如，我们现在可以看到约翰·史密斯在纳什维尔工作。</p><p id="48e0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">关于左连接表，还有一些需要注意的事项:</p><ul class=""><li id="f20a" class="nc nd iq lq b lr mk lu ml lx ne mb nf mf ng mj nh ni nj nk bi translated">在原始的employees表中，人力资源部的Paola Ferrante的记录在<em class="mp"> office_code </em>字段中没有值。因为ON语句规定employees表中的每一个<em class="mp"> office_code </em>必须等于office表中的一个<em class="mp"> code </em>，所以没有Paola的office数据可以被带过来。</li><li id="aa96" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">与纽约办事处相对应的数据在连接的表中出现了两次。这也是因为ON语句。当执行左连接时，只要它在employees表中找到一个<em class="mp"> office_code </em> = 3(纽约办事处的<em class="mp"> code </em>),就会带来相应的数据。因为有两个雇员的<em class="mp"> office_code </em> = 3，所以连接表中的纽约办公室数据位于这两行的末尾。</li><li id="fcbc" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">最初的办事处表列出了芝加哥的第四个办事处，<em class="mp">代码</em> = 4。但是，employees表中没有一个人有<em class="mp"> office_code </em> = 4。在这种情况下，连接的表中不会出现描述芝加哥办事处的数据。<strong class="lq ir"> <em class="mp">左连接在“右”表中留下在“左”表中找不到匹配的记录。</em>T13】</strong></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/8ed46a67507f9f5da885b6ddb0815112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_7HX0W5bccdnjUFb"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@napr0tiv?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">瓦西里·科洛达</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="bc70" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">有道理吗？如果是这样，好消息是:最困难的部分已经过去了。其他两种最常见的连接——内部连接和外部连接——工作方式类似。它们将是本系列下一部分的重点。</p><p id="ed51" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">感谢让尼克·拉姆洛在编辑方面的帮助，感谢Dataxp Discord社区T21支持热情的数据专业人士的发展。欢迎在LinkedIn上与我联系！</p></div></div>    
</body>
</html>