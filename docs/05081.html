<html>
<head>
<title>How I Build Scalable Modern Web Applications for Real Users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何为真实用户构建可伸缩的现代Web应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-i-build-scalable-modern-web-applications-for-real-users-3910a3e32793?source=collection_archive---------2-----------------------#2020-08-03">https://levelup.gitconnected.com/how-i-build-scalable-modern-web-applications-for-real-users-3910a3e32793?source=collection_archive---------2-----------------------#2020-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d095" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">编码更好</h2><div class=""/><div class=""><h2 id="6c9b" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">我在人们使用的应用程序中展示我做出的决定。是时候超越玩具应用教程了。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/07cbad06e7a41a496fdf154352d9787a.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*y16vsgW8KhkU_iQOXUQc-Q.jpeg"/></div></figure><p id="1b4a" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章详细介绍了我用来构建<a class="ae ls" href="https://skilled.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ja"> Skilled.dev </strong> </a>的语言、库和工具，这是一个为开发人员成功编写面试代码做准备的平台。</p><h2 id="cab7" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">TLDR</h2><p id="5c14" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">UX +性能+可扩展+可定制</p><p id="dffd" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的决定集中在自动化过程中会阻止我做我想做的事情的部分——构建一个为我的用户提供大量价值的产品。我为快速迭代速度、开发人员体验和可伸缩性进行优化，而不牺牲控制或必要时的定制。</p><p id="20f8" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ja">成本:目前总计77美元</strong>。这都是基础设施成本，可能在一段时间内不会变得更贵。将有额外的费用，如电子邮件营销和交易费。</p><p id="5455" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ja">压力测试结果</strong>:我在1分钟内发送了10000个页面请求(每秒167个)，基础设施没有退缩。总体平均响应时间为990毫秒，第95个百分点的数据库响应时间为75毫秒。我使用的7美元的dyno没有超过60%的使用率。我使用<a class="ae ls" href="https://loader.io/" rel="noopener ugc nofollow" target="_blank"> loader.io </a>来执行测试。这是10k的页面浏览量，但我还没有把它在页面内的额外调用加起来，这将会更多。</p><p id="0373" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在文章末尾的“压力测试和可伸缩性”部分找到更深入的分析。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mq"><img src="../Images/a0e02a6e42be05424081425caf051828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nQJZs1kCvQtMu_X8iKavw.png"/></div></div></figure><h2 id="570a" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">介绍</h2><p id="0d80" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">Skilled.dev是一个以用户为中心的应用程序，UX对尽可能有效地教学至关重要，我认为它与一大类产品有相似之处。我还想超越标准编程教程，向<em class="mv">展示为什么</em>我们要使用某些工具，以及如何利用它们来快速构建可扩展的应用程序，即使你是一个单独的开发人员或在一个小团队中。</p><blockquote class="mw mx my"><p id="dac7" class="kw kx mv ky b kz la ka lb lc ld kd le mz lg lh li na lk ll lm nb lo lp lq lr ij bi translated">我也开始了一个<a class="ae ls" href="https://www.youtube.com/channel/UC3v9kBR_ab4UHXXdknz8Fbg?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ja"> YouTube频道</strong> </a>，在那里我将分享对我们项目的见解(Level Up Coding，Skilled.dev，gitconnected.com ),并带你浏览代码和我们如何构建东西。我还将为面试问题编码制作视频，并提供职业发展建议。</p></blockquote><h1 id="8a20" class="nc lu iq bd lv nd ne nf ly ng nh ni mb kf nj kg me ki nk kj mh kl nl km mk nm bi translated">我的堆栈</h1><p id="827e" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我将在这里简要介绍一下这些工具，并在本文的其余部分更详细地解释我为什么选择每一种工具。</p><p id="4b0d" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在文章的最后，我还将提供我如何构建代码的截屏。</p><h2 id="aee2" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated"><strong class="ak">前端($0) </strong></h2><ul class=""><li id="7c09" class="nn no iq ky b kz ml lc mm lf np lj nq ln nr lr ns nt nu nv bi translated"><a class="ae ls" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">类型脚本</a>(通过GraphQL自动生成类型)</li><li id="d55c" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae ls" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">反应</a> ( <a class="ae ls" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>为SSR +静态站点生成)</li><li id="9561" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae ls" href="https://speakerdeck.com/vjeux/react-css-in-js" rel="noopener ugc nofollow" target="_blank"> CSS-in-JS </a>使用<a class="ae ls" href="https://styled-components.com/" rel="noopener ugc nofollow" target="_blank">样式的组件</a></li><li id="b373" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae ls" href="https://www.apollographql.com/" rel="noopener ugc nofollow" target="_blank"> Apollo </a>用于GraphQL API消费</li><li id="172f" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae ls" href="https://mdxjs.com/" rel="noopener ugc nofollow" target="_blank"> MDX </a>用于编写课程内容</li></ul><h2 id="e29e" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">后端(0美元)</h2><ul class=""><li id="ca8e" class="nn no iq ky b kz ml lc mm lf np lj nq ln nr lr ns nt nu nv bi translated">使用<a class="ae ls" href="https://hasura.io/" rel="noopener ugc nofollow" target="_blank"> Hasura </a>的GraphQL</li><li id="44e6" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">Lambda通过Next.js发挥作用</li><li id="0b3a" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">一种数据库系统</li><li id="25c4" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">身份验证最初是手工进行的，以防止供应商锁定</li></ul><h2 id="2556" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">基础设施(77美元)</h2><ul class=""><li id="972a" class="nn no iq ky b kz ml lc mm lf np lj nq ln nr lr ns nt nu nv bi translated">部署到<a class="ae ls" href="https://vercel.com/" rel="noopener ugc nofollow" target="_blank"> Vercel </a>的前端/无服务器API</li><li id="6426" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">GraphQL API部署到<a class="ae ls" href="https://heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a></li><li id="c70c" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">用于存储代码的GitHub </li><li id="e5f5" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae ls" href="https://sentry.io/" rel="noopener ugc nofollow" target="_blank">哨兵</a>寻找漏洞和应用程序崩溃</li></ul><h1 id="cba5" class="nc lu iq bd lv nd ne nf ly ng nh ni mb kf nj kg me ki nk kj mh kl nl km mk nm bi translated">开发资源</h1><p id="13e5" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">拥有正确的工作流程会让你尽可能地高效。这些不是我的代码堆栈的一部分，但我认为值得一提，因为它们节省了我大量的时间。</p><h2 id="62ea" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">每日发展</h2><p id="a2d3" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">首先是<a class="ae ls" href="https://r.daily.dev/gitconnected" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ja"> daily.dev </strong> </a>。它们将最好的开发者新闻聚集起来，并通过算法排序，作为浏览器中的一个新标签。这为我节省了大量的时间，因为我不用在不同的网站之间切换就能找到我感兴趣的内容。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ob"><img src="../Images/7999eb74c32d1b6cc6a87de0b3bd07bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pz03goJ4yrArygatbTk-5Q.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><a class="ae ls" href="https://r.daily.dev/gitconnected" rel="noopener ugc nofollow" target="_blank"> Daily.dev </a></figcaption></figure><h2 id="2979" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">泰伯宁</h2><p id="fd2b" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我最近发现的一个让我在文本编辑器中效率更高的工具是<a class="ae ls" href="https://www.tabnine.com/promotion/TreyHuffine/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ja"> TabNine </strong> </a>。这是一个由人工智能驱动的自动完成工具。在很多情况下，感觉它为我编码。例如，它已经识别了我用于写作风格的模式，我把外部的<code class="fe og oh oi oj b">div</code>称为<code class="fe og oh oi oj b">Wrapper</code>:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ok"><img src="../Images/ea034c1b3efbad5fcf711c40b2535af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2TAMrwzTj3luEoJvXqCprw.png"/></div></div></figure><p id="a190" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对我来说，一个好处是我正在使用Markdown在我的文本编辑器中编写课程内容，TabNine足够智能，可以为英语句子和代码提供单词和拼写检查。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ol"><img src="../Images/9db5c5db8d7a56785bfe3dac8a16c7cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMHXxmCLdCP7eKpORE3dJg.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">在我的文本编辑器中自动完成一个英语句子</figcaption></figure><p id="9d91" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个简短的TabNine示例，但是您也会在文章中的一些图像/屏幕记录中注意到。</p><h1 id="43be" class="nc lu iq bd lv nd ne nf ly ng nh ni mb kf nj kg me ki nk kj mh kl nl km mk nm bi translated">前端(0美元)</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi om"><img src="../Images/54041829b3e7d26187cfae8f48c2ec0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lViIaB295V8fVrhQxxn60Q.png"/></div></div></figure><h2 id="bcda" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">以打字打的文件</h2><p id="34e6" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">TypeScript改变了前端，应该在任何生产项目中大力考虑。它使我们的代码更安全(根据Airbnb的数据，至少安全了38%)，与我们的文本编辑器集成以提高生产率，并使我们的代码更具可读性。</p><p id="1733" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但这还不是最棒的部分——TypeScript与GraphQL无缝集成，为您的客户端生成类型，并对挂钩提取做出反应(稍后将详细介绍)。老实说，<strong class="ky ja">是</strong> <strong class="ky ja">就像</strong> <strong class="ky ja">用作弊码</strong>编程。只需输入几个键，自动完成功能基本上就能为您编写所有代码并构建组件。我使用<a class="ae ls" href="https://graphql-code-generator.com/" rel="noopener ugc nofollow" target="_blank"> graphql-code-generator </a>，但是还有其他选项。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ob"><img src="../Images/b525646700b75ea97fca36242eb98560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TEnJq6PCcTEmu6pz81Jktw.gif"/></div></div></figure><p id="8e46" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不可否认，学习和维护TypeScript需要一些前期成本，但是我无法想象在没有它的情况下从事一个项目。</p><h2 id="6df4" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">与Next.js反应</h2><p id="4924" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我将简要介绍反应部分，因为大多数人都知道这是什么。我知道这有待商榷，但对我来说，React仍然是构建UI的最佳库。核心团队强大，库不断完善，社区庞大。同样(如果事情进展顺利🤞)雇佣有React经验的开发者应该是最容易的。</p><p id="7d23" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">js是一个半自以为是的React框架，用于构建非常快速的应用程序。它需要一些代码库结构，并对如何访问文档和数据有严格的API，但它提供的价值是惊人的。</p><p id="8a49" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Next.js为您处理所有客户端工具链，并且针对生产应用程序进行了高度优化。只要你遵循他们的模式，你就不必担心设置应用程序的痛苦部分(即Webpack配置、代码分割、路由)并且可以把你的时间集中在构建你的用户喜欢的web应用上。此外，它真的很快，并遵循最佳做法。以下是页面的<a class="ae ls" href="https://web.dev/measure/" rel="noopener ugc nofollow" target="_blank">灯塔</a>结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi on"><img src="../Images/fa9ddadda467293de6fa32d0c58b1671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPKhgviEYx_KOpXX67xT5Q.png"/></div></div></figure><p id="117a" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Next.js提供了现成的服务器端渲染和静态站点生成，甚至会根据您如何为每个页面提供数据，以最佳方式(CSR/SSR/SSG)进行精细渲染。</p><p id="2dca" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它还优化了构建和代码分割，因此您只需下载每个页面所需的JavaScript。然后，它会急切地下载后续页面的JavaScript，这样当你的用户导航时，它已经在浏览器中了。</p><p id="014d" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你使用Vercel(next . js的创建者)作为你的前端基础设施提供者，那么部署你的应用是无缝的和自动的。您可以在下面的基础设施部分了解更多信息。</p><p id="faab" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">TLDR: Next.js提高了你的应用程序的性能，同时也减少了你配置和维护它的时间。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ob"><img src="../Images/e61ca3ccbabd06494b3b2356feacef58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAiT367ZLrX_zGaUujeJYg.png"/></div></div></figure><h2 id="f4ef" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">CSS库-无</h2><p id="f00b" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我真的想完全控制用户体验和设计，所以我决定从头开始编写整个UI。这使我能够优化我试图传递的价值。我的所有组件都是手工构建的，除了一些低级的库，以方便功能。</p><p id="d8f4" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我正在考虑添加的一个东西是<a class="ae ls" href="https://tailwindcss.com/" rel="noopener ugc nofollow" target="_blank">顺风CSS </a>。我发现自己写了很多样板风格，浪费时间。我也害怕为简单的事情构建新的组件。我认为顺风会有助于进一步提高迭代速度。</p><p id="329f" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，可访问性(a11y)对我来说非常重要，根据我的研究，没有多少框架做得很好。这也是一个机会，让我真正了解如何正确地建立一个可访问的网站，并随着时间的推移继续改进它。这是一个持续的过程，但我希望我正在构建一个每个人都可以使用的东西。</p><p id="4c43" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我学到的重要的可及性:</p><ul class=""><li id="1eda" class="nn no iq ky b kz la lc ld lf oo lj op ln oq lr ns nt nu nv bi translated">最重要的是结构良好的HTML。计算机知道如何处理这种情况。</li><li id="9b8e" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">管理光标和焦点。</li><li id="b27e" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">使用屏幕阅读器测试页面。</li><li id="15e1" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">Aria应该只需要在HTML结构不够用的少数情况下使用。</li></ul><blockquote class="mw mx my"><p id="48a9" class="kw kx mv ky b kz la ka lb lc ld kd le mz lg lh li na lk ll lm nb lo lp lq lr ij bi translated">如果<!-- -->你有a11y的经验，请评论并让我知道是否有不正确的地方或我可以添加的关键改进！</p></blockquote><h2 id="69c2" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">用于UI样式的CSS-in-JS</h2><p id="56bb" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">很长一段时间我都不愿意采用这种方法，但是现在我认为它是我的堆栈中必不可少的一部分。我使用的是风格化的组件，但我在过去也有过使用情感的美好经历。</p><p id="5de7" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">CSS-in-JS允许我将UI样式简单地视为我的应用程序中的一个组件。样式化组件可以接收道具，并根据应用程序的状态决定样式的呈现方式。</p><p id="5018" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它还允许您使用标准的<code class="fe og oh oi oj b">import</code> / <code class="fe og oh oi oj b">export</code>语法来共享样式，因此您总是只需编写JavaScript。</p><p id="9e78" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们的组件不会管理样式:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="or os l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="b4b0" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们只需将道具传递给我们的样式化组件，它会决定如何呈现:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="122c" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我曾经反对CSS-in-JS，因为我认为它打破了关注点的分离，但是在多年痛苦地管理类来决定样式之后，我意识到关注点根本不是分离的。您的应用程序的样式、状态和布局是如此紧密地耦合在一起，以至于将它们统一起来更有意义。</p><p id="f5f2" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，它对关注点的分离采取了不同的观点——不是由组件管理类名来设计组件的样式，而是由实际上正在改变其样式的组件接收数据并做出决定。</p><h2 id="8902" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">内容的降价扩展(MDX)</h2><p id="d5f9" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我在使用内容管理系统(CMS)和在代码库中编写课程之间左右为难。我想给内容添加动态功能，以改善教育体验，这意味着我可能需要将JavaScript绑定到内容上——这意味着CMS不是一个真正的选项，因为它是静态字符串。</p><p id="24fc" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这使得MDX成为完美的选择。它允许我在代码库中使用markdown编写内容，但也允许我将它与React结合起来。因此，我可以将组件导入我的markdown来添加额外的功能，而不会牺牲我编写课程的方便性。</p><p id="0052" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，我想帮助我的用户直观地理解递归生成排列意味着什么，所以我构建了一个组件来生成它们，并将其嵌入到我的文本内容中:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ot"><img src="../Images/ac28eb6e5f0b8c66871180ea8c576c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rF-D_3FXeqhHjamzMyj8JQ.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ou"><img src="../Images/7777dd87919a9ef50371fecbbdb4dd2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PdEyQlsASkmvK9EOp56oVg.gif"/></div></div></figure><h1 id="aa7e" class="nc lu iq bd lv nd ne nf ly ng nh ni mb kf nj kg me ki nk kj mh kl nl km mk nm bi translated">后端(0美元)</h1><p id="df9b" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我的后端需要很少的编码。我通过Hasura获得了一个由仪表板管理的完整的GraphQL API，它非常适合处理CRUD操作。对于更复杂的业务逻辑，我使用Next.js(从我的前端)提供的API路由，因此只需很少的额外工作。</p><p id="4b74" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我做得比较艰难的一个领域是认证。我自己编写了这些代码，因为任何提供者都需要严格的锁定，而且我还没有准备好提交。</p><h2 id="faf6" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">带Hasura的GraphQL</h2><p id="a00f" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">Hasura为我节省了数百小时的编码时间，并完全改变了我对堆栈的看法。他们的仪表板允许您通过用户界面管理数据库，并自动为您创建迁移文件。Hasura还用所有必要的CRUD操作来构建您的GraphQL API。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ob"><img src="../Images/2f55ffaf6ec295168e1c9b39783c7a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4uqNsg_QhWdovj7RFm8zhQ.png"/></div></div></figure><p id="f2d0" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它运行在Haskell上，并将GraphQL请求直接转换为SQL查询，以便在PostgreSQL上运行。正因为如此，它的速度非常快，他们声称在云基础设施提供商的最便宜的计划层上，您可以支持1000个并发用户。</p><p id="2d59" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它不仅非常简单，而且还可以扩展。您可以将它与其他服务器上的定制GraphQL模式相结合，使用可以在数据库事务生命周期的任何时候执行lambda函数的钩子，并调度cron作业。</p><p id="21e8" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Hasura还使用了其他开源技术，因此供应商锁定是最小的。它构建在PostgreSQL之上，可以与任何身份验证提供者和GraphQL客户端一起工作。您可以使用自己的工具来管理迁移或在其控制面板内工作。您可以随意控制，如果您想使用不同的东西，只需删除Hasura，您仍然有一个格式良好的Postgres数据库。</p><p id="bcea" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以通过他们的控制面板控制一切，包括自动生成的迁移、权限和关系。请查看以下内容:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ob"><img src="../Images/16cb462652bf734aa1661c8f84fd245a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s3mHaacF2D78EGN3BZo9-g.png"/></div></div></figure><p id="512b" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Hasura提供了一个安全的GraphQL API，我可以通过一个仪表板来管理它。来自GraphQL的强类型通过自动代码生成工具传播到我的前端，因此我的TypeScript中的查询和数据与数据库的预期完全匹配。<strong class="ky ja">我的整个堆栈是同步的，我不需要写任何代码来实现它</strong>。</p><p id="3b92" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有，我提到过Hasura是免费和开源的吗？</p><h2 id="4861" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">Next.js中带有Lambda函数的业务逻辑</h2><p id="12b0" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">Hasura对于CRUD操作来说非常优秀，但是对于服务器端业务逻辑来说，您仍然需要额外的工具。幸运的是，使用Next.js，您可以通过API路由轻松地添加这些内容，并且当您使用Vercel进行部署时，它们会自动工作。</p><p id="01e1" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Next.js将路由存储在一个<code class="fe og oh oi oj b">pages</code>文件夹中，您可以在一个<code class="fe og oh oi oj b">pages/api</code>文件夹中创建API路由。然后，每个文件都被视为一个独立的Lambda函数，在这个函数中，您接收一个包含请求数据的对象，允许您处理任何使用Hasura无法处理的逻辑。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/351ef3b8b046609ba134213606a5ad06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*SPwxsMbFMStOmKyXnvpKJw.png"/></div></figure><h1 id="1907" class="nc lu iq bd lv nd ne nf ly ng nh ni mb kf nj kg me ki nk kj mh kl nl km mk nm bi translated">基础设施(77美元)</h1><p id="afa1" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">基础设施的目标是尽可能自动化，并依赖那些完善了系统的公司。我还希望它的价格合理，因为人们很容易陷入支付过高的云服务费用。</p><h2 id="6625" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">前端/无服务器API托管—Vercel(20美元/月)</h2><p id="165f" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">走向Vercel为我节省了大量的时间和金钱。在维护或扩展方面，您无需进行任何管理。因为它完全基于Lambda函数，所以可伸缩性应该是无限的(或者至少远远超过大多数应用程序的需求)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ow"><img src="../Images/f7927a47e75e801119b8d02f1ad9bd11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RbRFrq-KeG5M4-WCnk9Xmg.png"/></div></div></figure><p id="3f7d" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Next.js是由Vercel创建的，所以他们让部署应用程序变得非常简单。一切要么是lambda函数(包括服务器端渲染)，要么是可以在全球范围内缓存的静态文件。</p><p id="2e56" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我设置了在Git提交时自动进行部署。当我在CLI中执行<code class="fe og oh oi oj b">now --prod</code>时，生产部署发生了。我也可以让生产自动化，但我仍然希望有一个人接触点，只是为了确保在发布之前一切都好。尽管如此，部署生产应用程序的一个CLI命令并不算什么。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ox"><img src="../Images/23efa6fb302d43267da36bc9db82043a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FP9C6yt_wkXT9nQGcVxmBA.png"/></div></div></figure><p id="6408" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">20美元包括你所有的带宽和网站接入需求。然而，如果我有一个抱怨，那就是他们对你可以使用的lambda函数的数量限制很低(免费计划12个，付费计划24个)。这似乎是一个合理的数量，但它也包括服务器端渲染的所有路线。在我第一次部署到测试服务器之前，我不知不觉地用完了免费计划。</p><h2 id="da1b" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">graph QL API——Heroku(50美元数据库+7美元dyno)</h2><p id="7209" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">Heroku使得部署API变得非常简单，而Hasura提供了一个模板，使得维护和升级他们的引擎变得非常简单。就像一个<code class="fe og oh oi oj b">git push</code>命令那么简单。Heroku还为您全面管理Postgres数据库。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi oy"><img src="../Images/24393a1452f74d05523ef53e398e70ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOzIHtuO5nnBvBCZ6G8Buw.png"/></div></div></figure><p id="a118" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我目前购买了一个64GB的Postgres数据库和一个7美元的dyno(尽管在发布后我可能需要在这里增加一层)。我认为数据库存储应该够我用一段时间了，但是如果你想多启动一点，还有更便宜的选择。您还可以在应用程序准备好投入生产(或始终用于您的临时环境)之前，使用数据库空闲层来构建您的应用程序。</p><p id="6ed0" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就定价而言，50美元可能是中间价。如果你想自己管理它，你肯定可以更便宜，或者你可以选择像AWS这样更贵的选项。对我来说，得到Heroku提供的一切是值得的。这可能会超过我一段时间的需要，但我知道它会非常快，我从来不需要考虑维护它。</p><p id="50d4" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Heroku的另一个好处是他们的度量标准。它们提供了对请求和数据库性能的一些一般性了解，因此您不需要额外的工具来获得可见性，至少在早期是这样。</p><h2 id="3248" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">用于代码存储和版本控制的GitHub(免费)</h2><p id="39c0" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">GitHub现在已经为个人或小团队提供了几乎所有免费的东西，所以使用它们对我来说是理所当然的。他们的用户体验和工具是最好的，并且可以与我使用的所有其他工具集成。</p><h2 id="ef42" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk iw bi translated">错误跟踪和应用程序崩溃的哨兵(免费)</h2><p id="2eba" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">使用Sentry对于拥有真实用户的应用程序来说是必不可少的。无论您在编码时多么小心，或者您进行了多少次测试，当您的应用程序中有真正的用户时，总会出现问题。哨兵让你发现错误，并迅速确定原因是什么。</p><p id="6e7e" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">哨兵的免费计划相当慷慨，应该持续你一段时间。如果你达到了极限，那么你的应用程序也可能获得足够的收入来支付下一步。</p><h1 id="40a1" class="nc lu iq bd lv nd ne nf ly ng nh ni mb kf nj kg me ki nk kj mh kl nl km mk nm bi translated">压力测试和可扩展性</h1><p id="3080" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我使用<a class="ae ls" href="https://loader.io/" rel="noopener ugc nofollow" target="_blank"> loader.io </a>将5000个客户端在一分钟内平均分配到两个URL(总共10000个页面请求)。这相当于每秒167个请求。</p><p id="9658" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">需要注意的一个有趣的事情是，在测试开始时有一个很大的峰值。我的假设是，要么是缓存未命中，要么是启动了一个冷lambda函数导致的。在它解决之后，所有的请求都会在600-800毫秒内得到一致的处理。</p><p id="7d5c" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">老实说，如果你的应用程序处理这么多流量，你可能有一个惊人的业务，这可能比我从这个网站收到的流量还要多。这相当于每月有数百万用户。</p><p id="fcd0" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我真的被它的出色表现惊呆了。基础设施几乎没有移动。</p><p id="197a" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果:</p><ul class=""><li id="33e2" class="nn no iq ky b kz la lc ld lf oo lj op ln oq lr ns nt nu nv bi translated">总共10000次页面请求</li><li id="b010" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">总体平均响应时间为990毫秒</li><li id="ca5f" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">75毫秒95%数据库响应时间。这意味着95%的数据库请求处理速度超过75毫秒。</li><li id="3c88" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">60%最大CPU负载</li><li id="297e" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">9959个成功的请求</li><li id="92ff" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">20次超时</li><li id="5a15" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">传输了643MB数据</li><li id="deb2" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">零错误响应(4xx或5xx)</li></ul><p id="4e1a" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">负载测试结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mq"><img src="../Images/a0e02a6e42be05424081425caf051828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nQJZs1kCvQtMu_X8iKavw.png"/></div></div></figure><p id="001c" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来自Hasura dashboard的指标:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi oz"><img src="../Images/4d9aeb52f2a9e564ebd2e6ab01218a11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*czuKnDWzA1kg5b9QKeW0nA.png"/></div></div></figure></div><div class="ab cl pa pb hu pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="ij ik il im in"><h1 id="654e" class="nc lu iq bd lv nd ph nf ly ng pi ni mb kf pj kg me ki pk kj mh kl pl km mk nm bi translated">结论</h1><p id="d88f" class="pw-post-body-paragraph kw kx iq ky b kz ml ka lb lc mm kd le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在我的堆栈中磨砺是许多痛苦的尝试和错误，我希望这能为您节省为自己的项目做决策的时间。这种设置让我觉得在构建快速、可扩展的应用程序时，能够快速移动，并且还提供了对用户体验的控制，以创建我的社区会喜欢的东西。</p></div></div>    
</body>
</html>