<html>
<head>
<title>An Introduction to VueJS Suspense Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VueJS悬念组件介绍</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/an-introduction-to-vuejs-suspense-components-4e9e361b4b44?source=collection_archive---------12-----------------------#2020-01-22">https://levelup.gitconnected.com/an-introduction-to-vuejs-suspense-components-4e9e361b4b44?source=collection_archive---------12-----------------------#2020-01-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/11e1de35e6a9ddae4afdf799cbd0bb84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7zxy_Lp1LbzBDqau.jpg"/></div></div></figure><p id="6a2b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">悬念组件是Vue3中众所周知的特性之一。</strong></p><p id="620a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它们允许我们的应用程序在等待异步组件时呈现一些后备内容——让我们创建一个流畅的用户体验。</p><p id="af4d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">令人欣慰的是，悬念组件非常容易理解并开始在你的组件中使用。他们甚至不需要任何额外的进口！</p><p id="c44b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">到本文结束时，您应该知道:</p><ul class=""><li id="11cb" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">什么是悬念成分</li><li id="158c" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">何时使用它们</li><li id="83d4" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">如何使用它们</li></ul><p id="6e31" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">说够了！让我们开始编码吧。</p><h1 id="bc6e" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">悬念成分到底是什么？</h1><p id="b5ea" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">暂停组件用于在等待某种异步组件解决时显示回退内容。</p><p id="0343" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可能想知道，<em class="kz">“我们什么时候会使用异步组件？”</em></p><p id="6d51" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">老实说，比你想象的要多。每当我们希望组件等待获取数据时(通常在异步API调用中)，我们可以使用<a class="ae mr" href="https://learnvue.co/2020/01/4-vue3-composition-api-tips-you-should-know/" rel="noopener ugc nofollow" target="_blank"> Vue3组合API </a>创建一个异步组件。</p><p id="9400" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是异步组件有用的一些例子:</p><ul class=""><li id="262e" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">在页面加载前显示加载动画</li><li id="5bd2" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">显示占位符内容</li><li id="69a8" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">处理延迟加载的图像</li></ul><p id="63fc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">以前，在Vue2中，我们必须使用条件(例如<code class="fe ms mt mu mv b">v-if </code>或<code class="fe ms mt mu mv b">v-else</code>)来检查我们的数据是否已经加载并显示回退内容。</p><p id="dd26" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">但现在，Vue3内置了悬念，所以我们不必担心数据加载时的跟踪和相应内容的呈现。</p><h1 id="4b21" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">好吧…那么我们如何实现悬念呢？</h1><p id="b486" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">在这个例子中，我们假设我们有一个异步的<code class="fe ms mt mu mv b">ArticleInfo.vue</code>组件。</p><p id="5ff1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">由于本文的重点是悬念而不是合成API，所以我不会对细节进行疯狂的描述。如果你对更完整的Composition API教程感兴趣，<a class="ae mr" href="https://learnvue.co/2020/09/setting-up-your-first-vue3-project-vue-3-0-release/" rel="noopener ugc nofollow" target="_blank">我这里有一个</a>。</p><p id="f048" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">长话短说，只要知道设置方法可以像任何其他方法一样异步。</p><p id="424d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于我们的例子，ArticleInfo将有一个异步<code class="fe ms mt mu mv b">setup</code>方法，在返回之前加载用户数据。</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="2a27" class="ne lp it mv b gy nf ng l nh ni">async function getArticleInfo() {<br/>  // some asynchronous API call<br/>  return { article }<br/>}<br/><br/>export default {<br/>  async setup () {<br/>    var { article } = await getArticleInfo()<br/><br/>    return {<br/>      article<br/>    }<br/>  }<br/>}</span></pre><p id="6b8f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，假设我们有一个包含ArticleInfo组件的<code class="fe ms mt mu mv b">ArticlePost.vue </code>组件。</p><p id="07a8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们希望在等待组件获取数据并解决问题时显示类似于<em class="kz">“Loading Profile…”</em>的内容，我们只需三个步骤就可以实现悬念。</p><ol class=""><li id="066c" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky nj lg lh li bi translated">将我们的异步组件包装在一个<code class="fe ms mt mu mv b">&lt;template #default&gt;</code>标签中</li><li id="0908" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky nj lg lh li bi translated">在标签为<code class="fe ms mt mu mv b">&lt;template #fallback&gt;</code>的异步组件旁边添加一个兄弟组件</li><li id="0364" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky nj lg lh li bi translated">将两个组件包在一个<code class="fe ms mt mu mv b">&lt;suspense&gt;</code>组件中</li></ol><p id="5c2f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用插槽，悬念将呈现回退内容，直到默认内容准备就绪。然后，它会自动切换到显示我们的异步组件。</p><p id="d6a1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它看起来有点像这样。</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="aee2" class="ne lp it mv b gy nf ng l nh ni">&lt;Suspense&gt;<br/>      &lt;template #default&gt;<br/>        &lt;article-info/&gt;<br/>      &lt;/template&gt;<br/>      &lt;template #fallback&gt;<br/>        &lt;div&gt;Loading Profile...&lt;/div&gt;<br/>      &lt;/template&gt;<br/>&lt;/Suspense&gt;</span></pre><h1 id="535f" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">您还可以捕捉组件错误</h1><p id="b259" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">Vue的另一个很酷的特性，尤其是当我们开始使用异步组件时，是我们可以捕捉错误并向用户显示一些错误消息。</p><p id="33b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">即使在Vue2中，使用<a class="ae mr" href="https://vuejs.org/v2/api/#errorCaptured" rel="noopener ugc nofollow" target="_blank"> errorCaptured </a>钩子也是可能的，但是在Vue3中，它已经被重命名为<code class="fe ms mt mu mv b">onErrorCaptured</code>。</p><p id="690a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">不管它叫什么，这个<a class="ae mr" href="https://learnvue.co/2019/12/a-beginners-guide-to-vuejs-lifecycle-hooks/" rel="noopener ugc nofollow" target="_blank">钩子</a>在捕获到来自任何后代组件的错误时运行。如果出现问题，我们可以使用这个悬念来呈现错误。</p><p id="bda3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们处理一个错误来显示一条错误消息，上面的组件看起来就是这样。</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="24f7" class="ne lp it mv b gy nf ng l nh ni">&lt;template&gt;<br/>  &lt;div v-if="errMsg"&gt; {{ errMsg }} &lt;/div&gt;<br/>  &lt;Suspense v-else&gt;<br/>      &lt;template #default&gt;<br/>        &lt;article-info/&gt;<br/>      &lt;/template&gt;<br/>      &lt;template #fallback&gt;<br/>        &lt;div&gt;Loading Profile...&lt;/div&gt;<br/>      &lt;/template&gt;<br/>  &lt;/Suspense&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import { onErrorCaptured } from 'vue'<br/><br/>setup () {<br/>  const errMsg = ref(null)<br/>  onErrorCaptured(e =&gt; {<br/>    errMsg.value = 'Uh oh. Something went wrong!'<br/>    return true<br/>  })}<br/>  return { error }<br/>&lt;/script&gt;</span></pre><h1 id="e80b" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">你有它！</h1><p id="5456" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">悬念只是Vue让开发者更容易解决常见问题的另一种方式。我们不必有条件地呈现组件，我们可以只使用悬念来为我们处理事情。</p><p id="7615" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我看来，这是对Vue3最整洁的补充之一。</p><p id="04e8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，您应该对Vue中的悬念组件有了更多的了解，并且您已经想到了一些很酷的方法来开始将它们实现到您的项目中！</p><p id="c7b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你想了解更多关于创建你的第一个Vue3项目的信息，请查看这篇<a class="ae mr" href="https://learnvue.co/2020/09/setting-up-your-first-vue3-project-vue-3-0-release/" rel="noopener ugc nofollow" target="_blank">深入教程，以设置你的项目</a>并开始运行复合API。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="6a8a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你有兴趣了解更多关于Vue 3的知识，请下载我的免费Vue 3备忘单，里面有一些基本知识，比如组合API、Vue 3模板语法和事件处理。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="53f1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="kz">原载于2020年1月22日https://learnvue.co</em><a class="ae mr" href="https://learnvue.co/2020/01/an-introduction-to-vuejs-suspense-components/" rel="noopener ugc nofollow" target="_blank"><em class="kz"/></a><em class="kz">。</em></p></div></div>    
</body>
</html>