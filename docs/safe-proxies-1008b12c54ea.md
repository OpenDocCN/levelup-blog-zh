# 安全代理

> 原文：<https://levelup.gitconnected.com/safe-proxies-1008b12c54ea>

## 保护您的内部系统

![](img/6fb49c66d79742ed96c472ea435de593.png)

杰森·登特在 [Unsplash](https://unsplash.com/s/photos/safe-proxi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

想象一个攻击者想要故意破坏你的系统。或者，一个拥有特权帐户的工程师犯了一个重大错误，关闭了整个服务器群。因为您对系统的了解非常清楚，并且它被设计为提供最小的特权，所以对环境的影响是有限的。在调查和执行事件响应时，您可以确定问题的根本原因并采取适当的措施。

也许不是所有的系统都适合这种情况，但是您需要一种方法来使运行的系统更安全，更不容易停机。安全代理是实现这一点的一种方式。

## 安全代理

一般来说，代理提供了一种解决新的可靠性和安全性需求的方法，而不需要对部署的系统进行实质性的更改。在不修改现有系统的情况下，您可以简单地使用代理来路由本来可以直接连接到系统的连接。代理还可以包含满足您新的安全性和可靠性要求的控件。

安全代理是一个框架，允许授权人员访问或修改物理服务器、虚拟机或特定应用程序的状态。谷歌使用安全代理来查看、批准和运行有风险的命令，而不必与系统建立 SSH 连接。使用这些代理，使他们能够对调试问题授予细粒度的访问权限，或者限制计算机重新启动的速度。安全代理代表网络之间的单一入口点，是实现以下操作的关键工具:

*   审核舰队的每一项行动
*   控制对资源的访问
*   保护生产免受大规模人为错误的影响

[零接触生产](https://www.usenix.org/conference/srecon19emea/presentation/czapinski)是谷歌的一个项目，它要求生产中的每一个变化都必须是自动化的(不是人为的)，由软件预先验证，或者由经过审计的*碎玻璃机制*触发。

> 在计算中，“**打破玻璃**”是指在紧急情况下，检查系统帐户密码以绕过正常访问控制**程序**的行为。这为用户提供了对他们通常无权访问的帐户的即时访问。

安全代理是谷歌用来实现这些原则的一系列工具之一。他们估计，零接触产品可以防止或减轻谷歌评估的所有中断的大约 13%。

## 安全代理模型

在下面显示的安全代理模型中，客户端与代理对话，而不是直接与目标系统对话。

![](img/bb9529dba51adb1adb5a9bdb8d96233d.png)

Google 通过限制目标系统只接受来自代理的调用来实现这种行为。此配置指定哪些客户端角色可以通过访问控制列表(ACL)执行哪些应用层远程过程调用(RPC)。检查访问权限后，代理通过 RPC 向目标系统发送要执行的请求。通常，每个目标系统都有一个应用层程序，可以接收请求并直接在系统上执行。代理记录所有由与之交互的系统发出的请求和命令。

代理提供了以下好处:

*   实施多方授权(MPA)的中心点，在这里可以对与敏感数据交互的请求做出访问决策
*   管理使用审计
*   限速
*   与闭源第三方目标系统的兼容性
*   持续改进集成，安全性和可靠性增强可以添加到中央代理点

代理也有一些缺点和潜在的陷阱:

*   维护和运营开销方面的成本增加。
*   如果系统本身或其依赖项之一不可用，则会出现单点故障。这可以通过运行多个实例来增加冗余来缓解。
*   访问控制的策略配置，它本身可能是错误的来源。
*   攻击者可以控制的中央机器。
*   抵制变更，因为用户可能希望直接连接到生产系统。

因为安全代理的主要用例是添加与访问控制相关的安全性和可靠性功能，所以代理公开的接口应该使用与目标系统相同的外部 API。因此，代理不会影响整体用户体验。假设安全代理是透明的，它可以在执行一些身份验证和记录的预处理和后处理后简单地转发流量。

## 最后的想法

使用安全代理是向系统添加日志记录和多方授权的一种方式。因此，代理可以帮助您提高系统的安全性和可靠性。对于现有系统，这种方法可能是一种经济有效的选择。