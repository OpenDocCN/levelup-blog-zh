<html>
<head>
<title>Toggle Philips Hue Depending on Your PC State</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">根据您的电脑状态切换飞利浦色调</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/toggle-philips-hue-depending-on-your-pc-state-8d7dc1e4f5b?source=collection_archive---------3-----------------------#2021-01-04">https://levelup.gitconnected.com/toggle-philips-hue-depending-on-your-pc-state-8d7dc1e4f5b?source=collection_archive---------3-----------------------#2021-01-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3c32" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用智能手机或平板电脑应用程序并不是控制智能照明的唯一方式。你也可以从你的电脑、笔记本电脑或平板电脑上完成这项工作。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2d6747f90ee35fdba1481014d158cfda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V3jnZ1pqPYdPIxsf"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">纳丁·沙巴纳在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="6a2c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="f347" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">几周前，我接触了飞利浦Hue灯。对于一个灯泡来说似乎有点贵。然而，它激起了我的好奇心，足以给它一个镜头。我买了<a class="ae ky" href="https://amzn.to/3bs2FxD" rel="noopener ugc nofollow" target="_blank">白色氛围启动包</a>——因为我真的不喜欢纯白色的辉光——连同两个<a class="ae ky" href="https://amzn.to/3jT2QGG" rel="noopener ugc nofollow" target="_blank">色调播放灯条</a>。</p><p id="f73b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你读过我的任何其他故事，你已经知道我喜欢自动化发布网站、管道调整和Instagram嵌入。当然，我也想自动控制我的智能灯。当我解锁电脑时，我希望色调播放灯条自动打开，并在锁屏时关闭。</p><p id="1228" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个故事中，我将向你解释用<strong class="lt iu"> PowerShell </strong>和<strong class="lt iu"> Windows任务调度器编程Hue Lights的基础知识。</strong></p><p id="a522" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想从我自己的网站上阅读，请点击下面的链接。</p><p id="40bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ms">原载于</em><a class="ae ky" href="https://morehue.com/philips-hue-getting-started/" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://morehue.com</em></a><em class="ms">。</em></p><blockquote class="mt"><p id="484e" class="mu mv it bd mw mx my mz na nb nc mm dk translated">自动化很容易，你只需要知道要采取哪些步骤。</p></blockquote><h1 id="2cb2" class="kz la it bd lb lc ld le lf lg lh li lj jz nd ka ll kc ne kd ln kf nf kg lp lq bi translated">阶段</h1><ol class=""><li id="bc2d" class="ng nh it lt b lu lv lx ly ma ni me nj mi nk mm nl nm nn no bi translated">找到你的网桥的IP地址</li><li id="1c28" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated">获得一个经过<strong class="lt iu">认证的</strong>用户名</li><li id="46d0" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated">找到<strong class="lt iu">灯使</strong>自动化</li><li id="5cb1" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated">创建您想要的<strong class="lt iu">脚本</strong></li><li id="3ace" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated">定义<strong class="lt iu">预定任务</strong></li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="9be5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.找到你的网桥的IP地址</h1><p id="8ba2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">幸运的是，Hue系统附带了一个API，可以通过web请求轻松控制。但是，在我们尝试使用飞利浦Hue灯之前，我们首先需要找到网桥的IP地址。该桥将接收我们所有的web请求。很好看的教程可以在<a class="ae ky" href="https://developers.meethue.com/develop/get-started-2/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。但是因为我们现在只需要我们的桥的IP，我们也可以去这个链接:<a class="ae ky" href="https://discovery.meethue.com/" rel="noopener ugc nofollow" target="_blank">https://discovery.meethue.com/</a>。</p><p id="b432" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该链接将显示一个小的JSON响应，其中包含网桥的内部IP地址。响应看起来有点像这样:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="bbfe" class="ob la it nx b gy oc od l oe of">[<br/>  {<br/>    "id": "ecbdsa5afffe1303cf",<br/>    "internalipaddress": "192.168.1.41"<br/>  }<br/>]</span></pre><p id="9b56" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">记下这个IP地址，因为我们在其他步骤中需要它。</p><h1 id="d29d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.获取经过验证的用户名</h1><p id="1be0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">与当今任何其他受保护的系统一样，Hue系统要求用户验证他或她的身份。但是在我们这样做之前，我们需要导航到下面的URL(这是我们的桥的沙盒URL):<code class="fe og oh oi nx b">https://&lt;bridge_ip_address&gt;/debug/clip.html</code></p><p id="f6cc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们需要发送一个认证请求来认证我们自己。用下面的消息体<code class="fe og oh oi nx b">{ "devicetype" : "My_amazing_computer" }</code>向URL <code class="fe og oh oi nx b">/api</code>发送post请求。然后，您将看到以下消息:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="96b8" class="ob la it nx b gy oc od l oe of">[<br/> {<br/>  "error": {<br/>   "type": 101,<br/>   "address": "",<br/>   "description": "link button not pressed"<br/>  }<br/> }<br/>]</span></pre><p id="9dd8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在去按你舰桥上的链接按钮，然后再按一次<code class="fe og oh oi nx b">POST</code>按钮。您现在应该会得到如下所示的成功响应:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="461f" class="ob la it nx b gy oc od l oe of">[<br/> {<br/>  "success": {<br/>   "username": "j5hvYCkJPN8a87daQ6a0mmxBcG6ozeLp3zXU5lgc"<br/>  }<br/> }<br/>]</span></pre><p id="f8e2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这就对了。您现在有了经过验证的用户名。把这个也写下来，我们将在下一阶段用到它。</p><h1 id="ca0e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.找到要自动化的灯</h1><p id="1922" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有了前一阶段获得的认证用户名，我们可以将所有的灯连接到我们的桥上。为此，在de API沙箱中发送一个新请求至:</p><p id="a0ff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe og oh oi nx b">https://&lt;bridge_ip_address&gt;/api/&lt;authenticated_username&gt;/lights</code></p><p id="30c2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这将给你一个JSON响应，显示你系统中所有的灯。所有这些灯将有相同的名称对应他们，因为你会看到在色调应用程序。对于我的例子，我将使用灯光1和2 —我的灯光的id—。</p><h1 id="1753" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.创建您想要的脚本</h1><p id="3397" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们已经有了桥接IP、经过验证的用户名和要自动化的灯，我们可以开始一些真正的编程了！在这一部分，我们将编写两个脚本。第一个将打开我们的色调播放栏，而第二个将关闭它们。实现这一点的代码是用PowerShell编写的，因为我们可以在Windows中用PowerShell轻松地发出web请求。下面的代码用于关灯:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj nv l"/></div></figure><p id="8189" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">变量<code class="fe og oh oi nx b">$apiconent</code>被用作我们请求的<code class="fe og oh oi nx b">POST</code>主体。在这种情况下，将执行两个<code class="fe og oh oi nx b">POST</code>请求来关灯。一个示例URL看起来像带有以下JSON主体的<code class="fe og oh oi nx b">http://192.168.1.41/api/j5hvYCkJPN8a87daQ6a0mmxBcG6ozeLp3zXU5lgc/lights/1/state</code><code class="fe og oh oi nx b">{ "on" : false }</code>。</p><p id="6a93" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除了<code class="fe og oh oi nx b">$apicontent</code>变为<code class="fe og oh oi nx b">{ "on": true}</code>之外，开灯的脚本几乎相同。将这些脚本保存到您喜欢的文件夹中。</p><h1 id="4d76" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5.定义计划任务</h1><p id="d830" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在lights自动化过程的最后一步，我们需要定义上面写的脚本何时需要运行。幸运的是，windows有一个称为任务调度器的东西，可以将任何操作与Windows中的特定操作结合起来。</p><p id="881a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们将添加关灯任务。打开Windows任务调度器，点击<strong class="lt iu">动作</strong>，随后点击<strong class="lt iu">创建任务……</strong>。转到<strong class="lt iu">触发器</strong>选项卡，定义一个新的触发器。我添加了一个触发器，将工作站上的开始任务<strong class="lt iu">锁定</strong>，并将其添加到我们的触发器中。然后我又加了一个睡眠模式。这个稍微复杂一点，我们在一个事件上添加了一个新的触发器<strong class="lt iu">，作为日志值<strong class="lt iu"> System </strong>，作为源值<strong class="lt iu"> Kernel-Power </strong>和事件ID <strong class="lt iu"> 42 </strong>(用于睡眠的事件)。这将看起来像这样:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/62ba45ddbeadf7e7ca58975b85656407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*seRtOGJNftar8O51o5yc6g.png"/></div></figure><p id="f657" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们需要将一个<strong class="lt iu">动作</strong>耦合到已定义的触发器。转到<strong class="lt iu">动作</strong>选项卡，添加一个新动作。离开动作为<strong class="lt iu">开始一个程序。</strong>在设置部分，填写<code class="fe og oh oi nx b">powershell </code>作为要运行的程序。现在添加下面的参数<code class="fe og oh oi nx b">-windowstyle hidden -File C:\Documents\HueScripts\turn_off_play.ps1</code>并点击OK。您的操作选项卡将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/1896033b8d3f262791d821058dc0645f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*70JHph7EhKMeZcGcjuPDYw.png"/></div></figure><p id="5744" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">干得好！你完成了自动关闭色调灯的脚本！在我们继续下一步之前，去检查一下。</p><h2 id="284e" class="ob la it bd lb om on dn lf oo op dp lj ma oq or ll me os ot ln mi ou ov lp ow bi translated">开灯</h2><p id="b578" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们需要做同样的事情，当你的电脑醒来时打开灯。这个过程几乎和关灯的任务一样。我现在将指出这项任务的不同之处:</p><ul class=""><li id="fba8" class="ng nh it lt b lu mn lx mo ma ox me oy mi oz mm pa nm nn no bi translated">在工作站解锁上，将锁定的触发器更改为<strong class="lt iu"/></li><li id="29fd" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm pa nm nn no bi translated">将<strong class="lt iu">事件ID </strong>更改为1(电脑唤醒事件)</li><li id="4c53" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm pa nm nn no bi translated">更改动作的<strong class="lt iu">文件名</strong></li></ul><h1 id="7748" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="b41c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">自动化很容易，你只需要知道要采取哪些步骤。在本教程中，我们找到了一种根据电脑状态自动设置色调灯条的方法。让这成为你家庭自动化之旅的开始。</p><p id="2b29" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您遇到其他简洁的自动化技术，请告诉我！</p><p id="3f9d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">编码快乐！</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/095d3d82a769bfc84cc3b54b1e73c6d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hVfgU40RCMeP9Wq-HfSUlg@2x.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://ko-fi.com/koenvanzeijl" rel="noopener ugc nofollow" target="_blank">https://ko-fi.com/koenvanzeijl</a></figcaption></figure></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><h1 id="c96f" class="kz la it bd lb lc pj le lf lg pk li lj jz pl ka ll kc pm kd ln kf pn kg lp lq bi translated">分级编码</h1><p id="e634" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">感谢您成为我们社区的一员！<a class="ae ky" href="https://www.youtube.com/channel/UC3v9kBR_ab4UHXXdknz8Fbg?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">订阅我们的YouTube频道</strong> </a>或者加入<a class="ae ky" href="https://skilled.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> Skilled.dev编码面试课程</strong> </a>。</p><div class="po pp gp gr pq pr"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="ps ab fo"><div class="pt ab pu cl cj pv"><h2 class="bd iu gy z fp pw fr fs px fu fw is bi translated">编写面试问题+获得开发工作</h2><div class="py l"><h3 class="bd b gy z fp pw fr fs px fu fw dk translated">掌握编码面试的过程</h3></div><div class="pz l"><p class="bd b dl z fp pw fr fs px fu fw dk translated">技术开发</p></div></div><div class="qa l"><div class="qb l qc qd qe qa qf ks pr"/></div></div></a></div></div></div>    
</body>
</html>