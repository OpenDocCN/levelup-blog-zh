<html>
<head>
<title>Rust Adventures: Introduction to Collections — Vector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rust Adventures:收藏简介—矢量</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/rust-adventures-introduction-to-collections-vector-ce916dc21820?source=collection_archive---------10-----------------------#2020-08-16">https://levelup.gitconnected.com/rust-adventures-introduction-to-collections-vector-ce916dc21820?source=collection_archive---------10-----------------------#2020-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/2b8403b5c6e11f4e2e3c65f63808d0bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8KBrJgmsIlYtn24AhHfSQ.jpeg"/></div></div></figure><p id="6a06" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">嗨，伙计们！让我们继续我们在生锈的T2土地上的旅程。</p><p id="fd9e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">今天我们将介绍<a class="ae kz" href="https://en.wikipedia.org/wiki/Collection_%28abstract_data_type%29" rel="noopener ugc nofollow" target="_blank">系列</a>。这是每一种编程语言的核心。</p><h1 id="71ce" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">但是什么是收藏呢？</h1><p id="1fe6" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">在之前的一篇文章中，我们讨论了Rust所有权和变量值。变量是存储我们的值的内存位置。如果你想做一个简单的程序来计算一个学生笔记的平均值。</p><p id="cd9b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">假设我们有三个学生，让我们编写一点代码:</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="a80a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这看起来不错，但是一个新学生在年中来到班上怎么办呢？我们总是可以增加一个变量，但是学生的数量会增加很多，这是不合理的。如果有人要求我们对值进行排序？随着我们对新功能需求的增加，问题也随之而来，那么现在该怎么办呢？</p><h2 id="fb4a" class="mj lb it bd lc mk ml dn lg mm mn dp lk km mo mp lo kq mq mr ls ku ms mt lw mu bi translated">拯救收藏</h2><p id="06c0" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">集合通过在内存中保留一个空间来放置值组来解决这个问题。我们可以创建一组学生，而不是为每个学生创建一个固定变量。</p><p id="6743" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Rust的基本结构是<a class="ae kz" href="https://doc.rust-lang.org/std/vec/struct.Vec.html" rel="noopener ugc nofollow" target="_blank">向量</a>。所以我们的程序会改变来创建这个结构。</p><p id="758c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你想用初始值创建它，使用<code class="fe mv mw mx my b">vec!</code> <a class="ae kz" href="https://doc.rust-lang.org/1.7.0/book/macros.html" rel="noopener ugc nofollow" target="_blank">宏</a>:</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="99c8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">或者我们可以用初始值0来做，然后再加上这些值。我们需要声明它是可变的。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="9114" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，为了计算平均值，我们可以使用<a class="ae kz" href="https://doc.rust-lang.org/std/iter/trait.Iterator.html" rel="noopener ugc nofollow" target="_blank">迭代器</a>特征。它包含处理集合中的值的各种方法。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="4de7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，我们可以随心所欲地玩弄这些价值观，而无需付出太多努力。</p><h1 id="431e" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">集合主要特征</h1><p id="24ae" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">为了有效地使用集合，你应该能够插入、更新、删除和读取其中的值。Vector有一个简单的API来解决这些问题。</p><h2 id="ef69" class="mj lb it bd lc mk ml dn lg mm mn dp lk km mo mp lo kq mq mr ls ku ms mt lw mu bi translated">从向量中读取值</h2><p id="9892" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">要读取一个值，可以使用Java array [x]这样的语法，其中x是索引。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="4417" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这种方法容易出错，因为Vector在编译时没有已知大小。你可以传递一个错误的索引，代码就会死机。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="9842" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">更安全的方法是使用返回选项的<code class="fe mv mw mx my b">get(x)</code>函数。在Rust中没有空值。您的代码中不会有任何<a class="ae kz" href="https://docs.oracle.com/javase/7/docs/api/java/lang/NullPointerException.html" rel="noopener ugc nofollow" target="_blank"> NullPointerException </a>或<a class="ae kz" href="https://docs.oracle.com/javase/7/docs/api/java/lang/ArrayIndexOutOfBoundsException.html" rel="noopener ugc nofollow" target="_blank">ArrayIndexOutOfBoundsException</a>。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="4672" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">期权告诉我们，在我们刚刚传递的索引中没有值。当它发生时，将返回<a class="ae kz" href="https://doc.rust-lang.org/std/option/enum.Option.html#variant.None" rel="noopener ugc nofollow" target="_blank"> None </a>，否则将返回<a class="ae kz" href="https://doc.rust-lang.org/std/option/enum.Option.html#variant.Some" rel="noopener ugc nofollow" target="_blank"> Some </a>。这使得我们的代码更安全、更健壮。</p><h2 id="ea60" class="mj lb it bd lc mk ml dn lg mm mn dp lk km mo mp lo kq mq mr ls ku ms mt lw mu bi translated">将值插入向量</h2><p id="4bee" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">要包含项目，您可以使用<code class="fe mv mw mx my b">push</code>方法。这将把传递的值放在向量的末尾。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="1c4a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果想要的效果是将一个值放在一个特定的索引中，你应该使用<code class="fe mv mw mx my b">insert(x,y).</code>，这将在想要的索引中插入一个值，并将所有的下一个值向右移动。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="d77a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要添加一个以上的值你可以使用<code class="fe mv mw mx my b">extend_from_slice.</code>片被在线读取包含一组值的变量。要创建一个，你可以使用语法<code class="fe mv mw mx my b">&amp;[]</code>或者在向量前面使用<code class="fe mv mw mx my b">&amp;</code>信号。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h2 id="5522" class="mj lb it bd lc mk ml dn lg mm mn dp lk km mo mp lo kq mq mr ls ku ms mt lw mu bi translated"><strong class="ak">从向量中删除值</strong></h2><p id="6a5d" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">每个集合都需要删除不再需要的值。Rust在Vector中实现了一系列功能来实现这个目标。最基本的是<code class="fe mv mw mx my b">remove</code>和<code class="fe mv mw mx my b">remove_item.</code>第一个使用值索引，第二个尝试定位值的第一个出现并删除它。<code class="fe mv mw mx my b">remove_item</code>是一个只在<a class="ae kz" href="https://github.com/rust-lang/rust/issues/40062" rel="noopener ugc nofollow" target="_blank">夜间开放的实验API </a>。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="52fe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在一些计算问题中，你可能想要统一<code class="fe mv mw mx my b">get</code>和<code class="fe mv mw mx my b">remove</code>函数。当您检索该值时，它将从集合中移除。这个函数叫做<code class="fe mv mw mx my b">pop</code>，rust也有这个函数。<code class="fe mv mw mx my b">pop</code>收集最后一件物品并移除。用于<a class="ae kz" href="https://pt.wikipedia.org/wiki/LIFO" rel="noopener ugc nofollow" target="_blank"> LIFO </a>题。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h1 id="87a5" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">收藏的容量</h1><p id="a0af" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">铁锈的收藏有长度和容量。长度是添加到集合中的值，而容量就像是集合为容纳这些值而创建的房间。让我们更多地了解他们。</p><h2 id="9f82" class="mj lb it bd lc mk ml dn lg mm mn dp lk km mo mp lo kq mq mr ls ku ms mt lw mu bi translated">关于容量和长度</h2><p id="cbfa" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">每个向量都是指针、容量和长度的三元组。当你用<code class="fe mv mw mx my b">new</code>方法创建一个向量时，你的容量为0，长度为0。当我们使用<code class="fe mv mw mx my b">vec!</code>宏时，容量和长度将等于项目数。</p><h2 id="e553" class="mj lb it bd lc mk ml dn lg mm mn dp lk km mo mp lo kq mq mr ls ku ms mt lw mu bi translated">让我们考虑一下性能</h2><p id="44f0" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">当你给向量增加更多的值，并且达到它的容量时，算法将增加它。这是有代价的，会让你的程序变慢。</p><p id="a1b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，考虑性能何时对您的系统很重要是很重要的。让我们使用<a class="ae kz" href="https://github.com/bheisler/criterion.rs" rel="noopener ugc nofollow" target="_blank">标准</a>来看看它如何影响我们代码的性能。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mz mi l"/></div></figure><p id="9804" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我在criterion中运行了上面的代码，发现了以下结果:</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi na"><img src="../Images/48b7c41d2ce6f242128d4cdd1629e639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*bC-GNdrYqM73kr8cGcSN7w.png"/></div></figure><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/52462b166ac11494a84834b2d847bd5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*U3V9M1FIZEeq8UHi3vHL7w.png"/></div></figure><p id="e218" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这需要更多的时间，但对于大多数系统来说，这似乎不会影响性能。如果您使用的是关键性能系统，那么这几毫秒的时间会产生很大的影响。</p><p id="fa89" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可以在这里找到项目<a class="ae kz" href="https://github.com/victorinno/rust_collection_example1" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="57de" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结论</h1><p id="3492" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">我们已经介绍了向量的基础，在下一篇文章中，我们将会看到更多关于<a class="ae kz" href="https://doc.rust-lang.org/std/collections/struct.HashMap.html" rel="noopener ugc nofollow" target="_blank"> HashMaps </a>的内容。</p><p id="cb0c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">集合对于计算问题很重要。在程序员的日常工作中，你会和他们打交道，rust给人留下了深刻的印象。</p><p id="73e5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我希望你们都喜欢它，下次再见！</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="062d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你喜欢我的作品，请支持！♥</p><p id="4057" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要了解claps如何工作，请单击此处的<a class="ae kz" href="https://help.medium.com/hc/en-us/articles/115011350967-Claps" rel="noopener"/>。</p><p id="0ff5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要联系我:</p><div class="nj nk gp gr nl nm"><a href="https://profile.codersrank.io/user/victorinno" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">victorinno的CodersRank简介</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">这是什么？这代表了你目前的经历。它通过分析您连接的存储库进行计算。由…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">profile.codersrank.io</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa jz nm"/></div></div></a></div></div></div>    
</body>
</html>