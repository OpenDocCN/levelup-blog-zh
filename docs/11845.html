<html>
<head>
<title>Using TensorFlow with Flask and React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TensorFlow和烧瓶进行反应</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-tensorflow-with-flask-and-react-ba52babe4bb5?source=collection_archive---------3-----------------------#2022-04-21">https://levelup.gitconnected.com/using-tensorflow-with-flask-and-react-ba52babe4bb5?source=collection_archive---------3-----------------------#2022-04-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4b8d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个全栈机器学习的例子</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/49181c87786349cf5fe85dafed03e257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DbsymE-d5tfHE_BNQhgxng.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">张量流、烧瓶和反应徽标</figcaption></figure><p id="86e1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> TensorFlow </strong>是Google Brain团队维护的一个流行的机器学习框架。TensorFlow使您能够轻松访问高级功能来训练、分析和运行机器学习模型。</p><p id="267d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> Flask </strong>是一个基于Python的web框架。因为Flask使用Python，所以它允许您使用Python的充满第三方库的惊人的PIP生态系统。</p><p id="4fca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> React </strong>是一个由脸书维护的前端JavaScript框架。React对于创建健壮和轻量级的前端客户端非常有用。</p><p id="411b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文介绍了如何将这三种技术结合到一个web应用程序中。想象一下，你有一个训练有素的机器学习模型，并希望你的用户通过web应用程序与它进行交互。由于TensorFlow有一个很棒的Python包，而Flask是一个Python框架，所以您可以很容易地将您的模型托管在用Flask编写的web服务器上。通过这样做，您可以通过Flask中的API端点公开模型。然后，您可以使用React来消费API。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="95bb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">要求</strong></p><p id="ebea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我假设你知道Flask的基本知识，有反应，并且已经有一个训练有素的机器学习模型。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="ee9d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">训练模型</strong></p><p id="2c00" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文不会使用TensorFlow来训练模型。经过训练的模型应该导出到扩展名为<strong class="la iu"> h5的文件</strong>。如果您已经有一个带有h5文件的训练模型，跳到<strong class="la iu">项目设置</strong>部分。</p><p id="301a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将通过一个简单的例子，使用一个叫做<a class="ae mb" href="https://teachablemachine.withgoogle.com/" rel="noopener ugc nofollow" target="_blank">可示教机器</a>的便利工具来创建一个模型。</p><p id="0543" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将要构建的样本模型接受狗和猫的图像，并对它们进行分类。您可以在这里获得所用的数据<a class="ae mb" href="https://www.kaggle.com/competitions/dogs-vs-cats/data?select=train.zip" rel="noopener ugc nofollow" target="_blank">。如果有必要，创建一个Kaggle帐户，下载<strong class="la iu"> train.zip </strong>文件，并将其解压缩到您的机器上。这将包含大约25，000张狗和猫的图片。如果你想更好地组织数据，为狗图片创建一个文件夹，为猫图片创建一个文件夹。请注意，25，000是一个很大的数量，将它们移动到不同的文件夹并训练模型可能需要一段时间来处理这么多照片。大部分随意删。为了这个例子，我建议总共保留2000张照片。一千只狗和一千只猫。</a></p><p id="6f06" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">前往<a class="ae mb" href="https://teachablemachine.withgoogle.com/" rel="noopener ugc nofollow" target="_blank">可示教机器</a>。在那里，点击<strong class="la iu">开始</strong>。您应该会看到一个页面，要求您选择一个项目类型。我们正在做一个<strong class="la iu">形象工程</strong>。如果提示选择图像项目的类型，选择<strong class="la iu">标准图像模式</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/e53ed4f6f665979c4a0d04d283e6b0b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SeuXmrD4HYD8GugnUvgBzQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">用于选择项目类型的可示教机器界面</figcaption></figure><p id="25d6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您现在应该会看到如下所示的页面:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi md"><img src="../Images/612d6ebfdfbc921f7b1d3a58da7b3b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CcuDCt9Q7NdgGCYraPlEqw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">可示教机器模型训练设置</figcaption></figure><p id="b8cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将<code class="fe me mf mg mh b">Class 1</code>文本改为猫，将<code class="fe me mf mg mh b">Class 2</code>改为狗。之后，在猫类中选择<code class="fe me mf mg mh b">upload</code>，然后选择<code class="fe me mf mg mh b">Choose images from your files</code>。选择你的猫图像并载入。对Dog类遵循相同的步骤。</p><p id="ad13" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完成后，你应该可以点击<code class="fe me mf mg mh b">Train Model</code>按钮。我通常将所有的高级设置保留为默认值，但是如果你愿意的话，可以尝试一下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/cc4ed251f5b6cffe02486279174ca579.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvYMlO4RSXnb4PaCHV_Ygw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">数据加载后可示教的机器</figcaption></figure><p id="a4d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦你点击<code class="fe me mf mg mh b">Train Model</code>，可教的机器将通过裁剪和调整图像大小来预处理你的图像。然后模型会训练。根据加载的图像数量，这可能需要一些时间。</p><p id="979d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦训练完毕，你应该有一个选项<code class="fe me mf mg mh b">Export Model.</code>这将允许你导出你的模型的h5文件，以及给出一个关于如何使用模型的代码片段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/dc7554236652d7567c83190e00b73cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vyJGUi1jG-bElXZUCNv36g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">可示教机器代码片段和模型导出</figcaption></figure><p id="825e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从<code class="fe me mf mg mh b">Export Model,</code>中选择<code class="fe me mf mg mh b">TensorFlow</code>选项卡并选择<code class="fe me mf mg mh b">Keras</code>选项。下载您的模型，并注意所提供的代码片段。</p><p id="e1d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当您的模型下载时，它应该是一个zip文件。解压缩后，该文件夹中应该有一个扩展名为h5的文件。这是一个文件，存储了你训练好的神经网络的所有参数。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="ffd0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">项目设置</strong></p><p id="78be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">既然您已经有了一个经过训练的模型，那么是时候设置项目了。</p><p id="09ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为项目创建一个目录，并将<code class="fe me mf mg mh b">cd</code>放入其中:</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="c320" class="mo mp it mh b gy mq mr l ms mt">mkdir flask-react-tf<br/>cd flask-react-tf</span></pre><p id="dbe8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您将使用Pipenv设置一个Python 3.9环境。如果你没有安装Pipenv，我这里有一篇关于使用Pipenv <a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/beginners-guide-to-pipenv-9340a6c35147">的文章</a>。</p><p id="4810" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行以下命令来设置Python 3.9环境。请注意，您需要在您的机器上安装Python 3.9。</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="760b" class="mo mp it mh b gy mq mr l ms mt">pipenv install --python 3.9</span></pre><p id="4537" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">设置完成后，使用以下命令激活虚拟环境Pipenv设置:</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="9b71" class="mo mp it mh b gy mq mr l ms mt">pipenv shell</span></pre><p id="bedc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在用Pipenv安装项目依赖项:</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="ec1e" class="mo mp it mh b gy mq mr l ms mt">pipenv install flask tensorflow pillow flask-cors</span></pre><p id="59f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些依赖关系是什么？</p><p id="efb9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> flask </strong>:用Python创建web应用和API的微型web框架。</p><p id="5caa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> tensorflow </strong>:官方TensorFlow python包。这将允许您与TensorFlow的API以及h5文件进行交互。</p><p id="2643" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> pillow </strong>:一个python库，为你提供了操作图像的工具。由于机器学习模型会摄取猫和狗的图片，pillow将使处理这些图像变得容易。</p><p id="0746" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> flask-cors </strong>:允许您设置cors策略以允许来自React的请求。</p><p id="6f64" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">项目结构</strong></p><p id="1763" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在您的项目目录中，您应该有一个<strong class="la iu"> Pipfile </strong>和<strong class="la iu"> Pipfile.lock </strong>文件。</p><p id="ead2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在项目根目录下，创建一个名为<strong class="la iu"> app.py </strong>的文件，并将<strong class="la iu"> keras_model.h5 </strong>文件也移动到这里。</p><p id="c970" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该有一个如下所示的文件夹结构:</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="0d86" class="mo mp it mh b gy mq mr l ms mt">- flask-react-tf<br/>-- app.py<br/>-- keras_model.h5<br/>-- Pipfile<br/>-- Pipfile.lock</span></pre><p id="6001" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在您可以将React添加到项目中。您可以使用<code class="fe me mf mg mh b">create-react-app.</code>来完成此操作</p><p id="d6a1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在项目的根目录下创建一个名为<code class="fe me mf mg mh b">client</code>的文件夹，并在其中运行<code class="fe me mf mg mh b">create-react-app</code>命令。您需要安装节点和NPM。</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="8908" class="mo mp it mh b gy mq mr l ms mt">mkdir client<br/>cd client<br/>npx create-react-app .</span></pre><p id="f994" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将在<code class="fe me mf mg mh b">client</code>目录中创建一个准系统的样板React应用程序。</p><p id="5464" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您的文件夹结构现在应该是这样的:</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="bb7e" class="mo mp it mh b gy mq mr l ms mt">- flask-react-tf/<br/>-- app.py<br/>-- keras_model.py<br/>-- Pipfile<br/>-- Pipfile.lock<br/>-- client/<br/>--- README.md<br/>--- node_modules/<br/>--- package-lock.json<br/>--- package.json<br/>--- public/<br/>---- favicon.ico<br/>---- index.html<br/>---- logo192.png<br/>---- logo512.png<br/>---- maifest.json<br/>---- robots.txt<br/>--- src/<br/>---- App.css<br/>---- App.js<br/>---- App.test.js<br/>---- index.css<br/>---- index.js<br/>---- logo.svg<br/>---- reportWebVitals.js<br/>---- setupTests.js</span></pre><p id="db19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe me mf mg mh b">create-react-app</code>船上有很多样板文件。对于这个示例应用程序，将只编辑<code class="fe me mf mg mh b">src/App.js</code>。</p><p id="bf17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在一切都已经设置好了，是时候集成这3种技术了。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="5938" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">烧瓶App和张量流</strong></p><p id="858f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打开项目根目录下的<code class="fe me mf mg mh b">app.py</code>文件。</p><p id="27b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先导入所需的库和包。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="0673" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来设置一个Flask应用程序的实例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="df80" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">声明了一个名为<code class="fe me mf mg mh b">app</code>的变量，并将其设置为Flask app的一个实例。在下面一行中，<code class="fe me mf mg mh b">flask_cors</code>用于包装Flask app实例。这将允许来自任何域的请求，包括React。</p><p id="2c0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，使用Flask实例创建一个将图像上传到的路由。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="d733" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过添加这个，您创建了一个到<code class="fe me mf mg mh b"><a class="ae mb" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:5000/upload</a> </code>的路由，它只接受POST请求。我们需要这个，因为我们将发送图像到这个端点。</p><p id="666e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，是时候使用我们训练模型时可教机器提供的代码片段了。提供的代码片段使用经过训练的TensorFlow模型，预处理传入的图像，并进行预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="cac4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有很多东西要打开。</p><p id="2495" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">经过训练的模型被加载并存储在名为<code class="fe me mf mg mh b">model.</code>的变量中</p><p id="b9f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，numpy数组描述了将存储在其中的图像的形状。这个numpy数组存储在<code class="fe me mf mg mh b">data</code>变量中。</p><p id="6cc1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当端点被点击时，<code class="fe me mf mg mh b">image</code>变量存储React传入的图像。</p><p id="6ea4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">剩下的代码是预处理图像并将其存储到定义的numpy数组中。</p><p id="2754" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe me mf mg mh b">prediction</code>变量存储预测值。</p><p id="27d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一步是分析预测，返回一些东西来反应。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="80ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你把预测变量打印出来，你会注意到它是一个列表，里面有一个包含两个十进制数的列表。如果第一个十进制数大于0.50，那么预测是一只猫。否则，就是狗。</p><p id="59b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以在终端中从项目根目录使用<code class="fe me mf mg mh b">flask run</code>运行Flask服务器，以确保Flask服务器正在运行。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="be00" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> React客户端</strong></p><p id="0b18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然<code class="fe me mf mg mh b">create-react-app</code>创建了许多样板文件，但是对于这个例子，只有<code class="fe me mf mg mh b">App.js</code>文件需要编辑。</p><p id="0a55" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe me mf mg mh b">App.js</code>中会有一些样板代码，我们将去掉它们，使文件看起来像这样。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="510d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将删除div标记之间的所有代码，并将函数组件转换为箭头函数。</p><p id="a2e9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们添加向Flask服务器发出请求的逻辑，以及一些状态。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="18d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下状态添加了<code class="fe me mf mg mh b">useState:</code></p><ul class=""><li id="d65e" class="mw mx it la b lb lc le lf lh my ll mz lp na lt nb nc nd ne bi translated"><strong class="la iu">文件</strong>:存储图像文件。它开始时是一片空白的状态。</li><li id="07b3" class="mw mx it la b lb nf le ng lh nh ll ni lp nj lt nb nc nd ne bi translated"><strong class="la iu">文件名</strong>:存储图像文件的名称。它以“选择文件”的初始状态开始，所以当一个文件没有被选择时，选择文件的按钮中有文本“选择文件”。</li><li id="b40b" class="mw mx it la b lb nf le ng lh nh ll ni lp nj lt nb nc nd ne bi translated"><strong class="la iu">预测</strong>:存储Flask服务器发回的预测。初始状态为空，因为没有初始预测。</li></ul><p id="ef88" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">新增功能描述:</p><ul class=""><li id="c9ed" class="mw mx it la b lb lc le lf lh my ll mz lp na lt nb nc nd ne bi translated"><strong class="la iu"> onChange </strong>:当表单中的数据发生变化时，调用该函数。因此，每当上传或更改文件时。它改变文件和文件名的状态。</li><li id="510e" class="mw mx it la b lb nf le ng lh nh ll ni lp nj lt nb nc nd ne bi translated"><strong class="la iu"> onSubmit: </strong>提交表单时调用。该函数处理传入的文件，并为Flask服务器创建获取请求。第二个。然后从Flask服务器获取响应，并将其保存在预测状态中。</li></ul><p id="bdf1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一步是添加表单以使用定义的函数和状态。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="1e5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">演示</strong></p><p id="589e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在是时候演示该应用程序了。</p><p id="61c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您需要同时运行Flask和React服务器，这样才能工作。您必须在两个不同的终端窗口中完成此操作。在VS代码中，应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/b57970b0402871854b7d6d3a530c7851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RpJprGJkwZaA3jRVcwWpQQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">运行Flask和React服务器的终端窗口</figcaption></figure><p id="2e03" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要运行Flask服务器，请确保Pipenv创建的Python环境正在终端窗口中运行。如果是，请在根目录下运行以下命令:</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="eb83" class="mo mp it mh b gy mq mr l ms mt">flask run</span></pre><p id="979a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要运行React服务器，您需要位于终端窗口中的客户端目录中。运行以下命令:</p><pre class="kj kk kl km gt mk mh ml mm aw mn bi"><span id="08ec" class="mo mp it mh b gy mq mr l ms mt">npm start</span></pre><p id="e2eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你访问<code class="fe me mf mg mh b"><a class="ae mb" href="http://127.0.0.1:5000/upload" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:5000/upload</a></code>，你应该会看到一个不允许方法的页面。这是因为只有POST请求可以到达这个端点。我们希望看到此错误，因为它意味着端点设置正确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/57128407855b56a6a1c05fe62c21ec77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ZshmSo60A1LZYe0P0o9LA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">不允许的方法页面</figcaption></figure><p id="1a15" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，如果您在<code class="fe me mf mg mh b"> <a class="ae mb" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>访问React服务器，您应该会看到选择您希望上传的图像的表单。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/0c71f8c10dfcaa4c62353097ac694fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmvEHhjSSvAf6msY3DnN7Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">将页面与表单反应以上传图像</figcaption></figure><p id="bff7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当两台服务器都在运行时，单击React页面上的Choose File并选择要上传的图像。</p><p id="70a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">选择图像后，单击上传提交表单。</p><p id="fc9a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">给程序一点时间，一些文本应该与预测一起显示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/3ba426376495c76a37be9ff2defa8257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7qkx0FLOvfoTN_HyQmSJOA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">做出预测后对页面做出反应</figcaption></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="30f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢这篇博文，并且觉得它很有用，可以考虑为它鼓掌，并在Medium上关注我。此外，考虑使用我的推荐链接在这里注册媒体<a class="ae mb" href="https://tarricsookdeo.medium.com/subscribe" rel="noopener"/>。只要你还是会员，我就能得到一点回扣。如果你愿意，你也可以在这里给我买杯咖啡<a class="ae mb" href="https://www.buymeacoffee.com/tarricsookdeo" rel="noopener ugc nofollow" target="_blank">！非常感谢！</a></p></div></div>    
</body>
</html>