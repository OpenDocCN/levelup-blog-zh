<html>
<head>
<title>Up and Running with Azure Kubernetes Service (AKS) and DevOps Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">启动并运行Azure Kubernetes服务(AKS)和DevOps管道</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/up-and-running-with-azure-kubernetes-aks-and-devops-pipelines-configuring-the-kubernetes-1b85608e6b0d?source=collection_archive---------20-----------------------#2021-06-07">https://levelup.gitconnected.com/up-and-running-with-azure-kubernetes-aks-and-devops-pipelines-configuring-the-kubernetes-1b85608e6b0d?source=collection_archive---------20-----------------------#2021-06-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="748c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第2部分—配置Kubernetes集群</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ddee0128faacf1bf9c965ba0108a4729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yHybiCQXT5csy0lHpapl3Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">船轮——来自<a class="ae kv" href="https://www.pexels.com/photo/close-up-photogrpahy-ship-captains-control-1416649/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae kv" href="https://www.pexels.com/@nick-demou-365778?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">尼克·德穆</a>摄影</figcaption></figure><p id="a748" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们回到AKS和DevOps管道系列的第二部分。如果你刚刚加入我们的旅程，你可能想看看这个系列的第一部分:<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/up-and-running-with-azure-kubernetes-service-aks-and-devops-pipelines-2208c24378ff"> <em class="ls">启动并运行Azure Kubernetes服务(AKS)和DevOps管道——在Azure门户中设置AKS</em></a></p><p id="6762" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经完成了AKS的部署，我们需要一些方法来与它对话。幸运的是，有一个很棒的命令行界面(CLI)可以做到这一点:kubectl。Kubectl就是<strong class="ky ir">KUBE</strong>rnetes<strong class="ky ir">C</strong>ommand-line<strong class="ky ir">T</strong>oo<strong class="ky ir">L</strong>(关于缩写的假设完全是我自己的！)，它允许您对Kubernetes集群运行命令。</p><blockquote class="lt lu lv"><p id="9c72" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">Kubernetes命令行工具kubectl允许您对Kubernetes集群运行命令。您可以使用kubectl来部署应用程序、检查和管理集群资源以及查看日志。</p></blockquote><p id="de83" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用kubectl来执行下一阶段的配置和设置，在阅读本系列后，您也可以在Visual Studio代码中使用它来代替Azure DevOps管道和扩展等工具。</p><blockquote class="lt lu lv"><p id="6087" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">为了更深入地了解kubectl</strong><br/><a class="ae kv" href="https://kubernetes.io/docs/reference/kubectl/overview/" rel="noopener ugc nofollow" target="_blank">kubectl | Kubernetes的概述</a></p></blockquote><h1 id="075c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">先决条件的安装</h1><h2 id="ca90" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">通过Docker桌面安装kubectl</h2><p id="9765" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">如果你在Mac或Windows上，你有两个选择来获得kubectl，在Linux上你只能选择一个(尽管有不同的方法)，应该跳到<strong class="ky ir"> <em class="ls">通过命令行工具</em> </strong>安装kubectl。</p><p id="3d00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你还在读这一节，我们会假设你是在Mac或Windows上！我发现目前为止获得kubectl最简单的方法是安装Docker Desktop。现在，如果您以任何方式使用Docker容器，我建议您安装Docker Desktop，即使您没有利用Kubernetes(但是为什么不呢！？).这是一种安装Docker、Kubernetes、开发者工具的快速简单的方法，现在也有来自Snyk的图像漏洞扫描。另外，它有一个漂亮的GUI来帮助管理图像和一些配置。</p><blockquote class="lt lu lv"><p id="46f3" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">Docker桌面包括Docker应用程序、开发人员工具、Kubernetes和生产Docker引擎的版本同步。Docker Desktop允许您利用经过认证的图像和模板以及您选择的语言和工具。开发工作流利用Docker Hub将您的开发环境扩展到一个安全的存储库，以实现快速自动构建、持续集成和安全协作。</p></blockquote><p id="0d2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以得到。dmg或者。exe安装程序从<a class="ae kv" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> Docker桌面为Mac和Windows | Docker </a></p><p id="4dc3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Windows上，安装就像运行。exe(你知道的，ol '双击？).</p><p id="5eb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Mac上，安装就像运行。dmg，然后常见的拖放到应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/f1eeff2c51d4bd988e96c351c85e650e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zmSFgHwgQTHaPMbajCkHvw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">在Mac上安装Docker桌面</figcaption></figure><h2 id="3d64" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">通过命令行工具安装kubectl</h2><p id="2b03" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">啊，我们的老朋友CLI。<br/>现在，根据您的操作系统，这里的步骤可能会略有不同。</p><p id="8a5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">车窗通过卷曲<br/> 1。</strong>在命令提示符下，导航到您希望kubectl二进制文件驻留的目录(例如C:\windows或D:\cool-tools等。)，然后用curl拉到那里:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="a45f" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">cd Windows</strong></span></pre><p id="b2c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="cf23" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">curl -LO https://dl.k8s.io/release/v1.20.0/bin/windows/amd64/kubectl.exe</strong></span></pre><p id="d319" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2 </strong>。将kubectl目录添加到您的路径中<br/>如果您下载了kubectl二进制文件，比如C:\windows或者您的路径中已经存在的另一个目录，那么您不需要执行这个步骤。但是，如果没有，您需要添加它。要确定这一点，用<code class="fe ns nt nu nk b"><strong class="ky ir">echo %PATH%</strong></code>检查当前在您的路径上有什么。还是为了更容易读懂<code class="fe ns nt nu nk b"><strong class="ky ir">echo %PATH:;=&amp;echo.%</strong></code>。仅对于您的登录用户，假设kubectl二进制文件在<strong class="ky ir"><em class="ls">D:\ cool-tools</em></strong>中，您将运行:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="d206" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">setx path "%PATH%;D:\cool-tools\"</strong></span></pre><p id="a75e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于所有用户(需要提升的/管理员访问权限)，假设kubectl二进制文件在<strong class="ky ir"><em class="ls">D:\ cool-tools</em></strong>中，您将运行</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="4992" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">setx /M path "%PATH%;D:\cool-tools\"</strong></span></pre><blockquote class="lt lu lv"><p id="b47a" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">抬头！</strong> <br/>要在你的%PATH%中看到这些变化，你需要打开一个新的命令提示符。</p><p id="7458" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">抬头！</strong> <br/>如果你利用另一种方法设置你的路径，比如用<br/> <strong class="ky ir">设置PATH = % PATH %D:\cool-tools\" </strong> —它将只为当前会话设置路径。一旦您注销了Windows，对您的路径的更改将不再存在！</p></blockquote><p id="5dd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Windows via PowerShell和PSGallery <br/> </strong>如果您在PowerShell中使用PSGallery包管理器，安装kubectl二进制文件的另一种方法如下(使用这种方法，您不需要手动修改路径):</p><p id="f61c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。</strong>在PowerShell提示符下</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="fd4f" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">Install-Script -Name 'install-kubectl' -Scope CurrentUser -Force</strong></span></pre><p id="7e62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="d334" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">install-kubectl.ps1 [-DownloadLocation &lt;path&gt;]</strong></span></pre><blockquote class="lt lu lv"><p id="08cc" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">在Windows上安装的其他方法</strong> <br/> <a class="ae kv" href="https://kubernetes.io/docs/tasks/tools/install-kubectl-windows/" rel="noopener ugc nofollow" target="_blank">在Windows上安装并设置kubectl | Kubernetes</a></p></blockquote><p id="c1cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> macOS via curl </strong></p><p id="4a40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在macOS(和Linux)上安装curl与在Windows上安装略有不同，因为我们在下载了kubectl二进制文件之后还需要几个步骤。</p><p id="46d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。</strong>从一个终端，拉最新稳定的kubectl二进制:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="d16f" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/darwin/amd64/kubectl"</strong></span></pre><p id="2e60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2。</strong>使其可执行:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="6f8f" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">chmod +x ./kubectl</strong></span></pre><p id="4613" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 3。</strong>将它移动到您希望它驻留的位置(假设是<strong class="ky ir"><em class="ls">/usr/local/bin/ku bectl</em></strong>):</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="fcf2" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo mv ./kubectl /usr/local/bin/kubectl</strong></span></pre><p id="154f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，让root (admin)用户拥有它:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="3765" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo chown root: /usr/local/bin/kubectl</strong></span></pre><blockquote class="lt lu lv"><p id="d677" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">抬头！</strong> <br/>尽量避免将二进制保存在下载目录中。除了最佳实践之外，在macOS Big Sur上运行驻留在下载目录中的项目(如VS代码)时会出现一些问题。</p></blockquote><p id="973b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">自制苹果电脑</strong></p><p id="5a47" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要用家酿软件包管理器安装kubectl二进制文件，只需从终端运行一个简单的命令行程序(不需要额外的步骤):</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="47d0" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">brew install kubectl</strong></span></pre><p id="0a5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Linux上安装curl与在macOS和Windows上安装略有不同，在我们下载了kubectl二进制文件后，需要运行一些不同的任务。</p><p id="40d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。</strong>从一个shell中，拉出最新稳定的kubectl二进制:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="b16c" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"</strong></span></pre><blockquote class="lt lu lv"><p id="3ac9" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">抬起头来！ <br/>执行步骤<strong class="ky ir"> 2.a. </strong> <strong class="ky ir">或步骤2.b. </strong>，<strong class="ky ir">不要两者都执行！</strong></p></blockquote><p id="3d2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.a. </strong>安装kubectl二进制文件(假设root访问):</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="ffb1" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl</strong></span></pre><p id="5eca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.b. </strong>或者没有root权限(仅限登录用户)。在您登录的用户目录中创建目录:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="a60b" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">mkdir -p ~/.local/bin/kubectl</strong></span></pre><p id="c9e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，将kubectl二进制文件移到那里:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="05c5" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">m</strong><strong class="nk ir">v ./kubectl ~/.local/bin/kubectl</strong></span></pre><p id="5d50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后加上<strong class="ky ir"> <em class="ls"> ~/。local/bin/kubectl </em> </strong>到您的$PATH(永久的，这需要编辑您的shell配置文件，如<strong class="ky ir"> <em class="ls"> ~/。bashrc ( </em> </strong>假设bash shell)但是这取决于您使用的shell)。在您喜欢的编辑器中打开它，比如vi(如果这个文件不存在，您可以简单地先运行<code class="fe ns nt nu nk b"><strong class="ky ir">touch ~/.bashrc</strong></code>):</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="5850" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">vi ~/.bashrc</strong></span></pre><p id="48a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，将该路径添加到文件的底部，如下所示:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="065e" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">export PATH=$PATH:~/.local/bin/kubectl</strong></span></pre><p id="5781" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后保存退出vi。</p><blockquote class="lt lu lv"><p id="e942" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong> <br/>对于那些不了解vi的神秘本质的人来说，保存和退出是通过以下命令序列执行的:按<code class="fe ns nt nu nk b"><strong class="ky ir">ESC</strong></code>(它应该在编辑器的底部提供一个冒号(<strong class="ky ir"> : </strong>)提示符)然后按<code class="fe ns nt nu nk b"><strong class="ky ir">s</strong></code>接着按<code class="fe ns nt nu nk b"><strong class="ky ir">ENTER</strong></code>保存，然后按<code class="fe ns nt nu nk b"><strong class="ky ir">q</strong></code>接着按<code class="fe ns nt nu nk b"><strong class="ky ir">ENTER</strong></code>退出。</p></blockquote><p id="1376" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">Linux via native package management(基于Debian)<br/></strong>在尝试通过软件包管理安装之前，我们需要确保我们的软件包管理器拥有最新的软件包索引。然后，我们可以获取kubectl二进制文件。</p><p id="cecf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。</strong>更新apt-get:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="965c" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo apt-get update</strong></span></pre><p id="ef56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="7692" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo apt-get install -y apt-transport-https ca-certificates curl</strong></span></pre><p id="aabc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2。</strong>获取谷歌云公共签名密钥(Kubernetes是谷歌维护的一个项目，如果你在Azure环境中对此有疑问！):</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="ca3d" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg</strong></span></pre><p id="2138" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 3。</strong>添加Kubernetes apt存储库:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="6605" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">echo "deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-xenial main" | sudo tee /etc/apt/sources.list.d/kubernetes.list</strong></span></pre><p id="45fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 4。</strong>再次更新apt-get:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="481e" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo apt-get update</strong></span></pre><p id="e44e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 5。</strong>最后，安装kubectl二进制文件:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="fb9f" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">sudo apt-get install -y kubectl</strong></span></pre><p id="1bec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">通过本地包管理的Linux(基于RedHat)<br/></strong>在基于red hat的系统上安装比在基于Debian的系统上安装步骤少。其实就两个！</p><p id="fd60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。</strong>添加Kubernetes yum库:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="9973" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo<br/>[kubernetes]<br/>name=Kubernetes<br/>baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64<br/>enabled=1<br/>gpgcheck=1<br/>repo_gpgcheck=1<br/>gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg<br/>EOF</strong></span></pre><p id="2e00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2。</strong>安装kubectl二进制文件:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="5f0a" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">yum install -y kubectl</strong></span></pre><h1 id="37f3" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">添加Kubernetes集群并通过kubectl连接到它</h1><p id="e64c" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">既然先决条件已经解决了，我们就可以进入正题了。我们必须做的第一件事是将新的Kubernetes集群添加到kubectl，这样我们就可以连接到它。</p><p id="c4cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。</strong>从Azure门户获取集群的API服务器地址:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/e9568d18a80d9c5c3e8df0a03249ca54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wX6iBKCjV5dxKqWxbRv0rQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Kubernetes集群API服务器地址在Azure门户中的位置</figcaption></figure><p id="28c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2。</strong>使用kubectl添加集群:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="d71c" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">kubectl config set-cluster company-kubernetes-dev-01 --server=digital-kubernetes-dns-dev-01.5a4aa441.hcp.eastus2.azmk8s.io</strong></span></pre><blockquote class="lt lu lv"><p id="cda4" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong> <br/>如果您在另一个应用程序中将上下文从这个集群中切换出来，比如在VS Code的Kubernetes扩展中，您可以通过CLI使用下面的命令<code class="fe ns nt nu nk b"><strong class="ky ir">kubectl config use-context company-kubernetes-dev-01</strong></code>轻松切换回来</p></blockquote><h1 id="004f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">设置名称空间</h1><p id="5742" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">我们已经安装了kubectl，现在已经连接到我们新的Kubernetes集群。我们需要做的下一件事是设置名称空间，以帮助组织我们的工作负载、作业、服务和pods。现在这似乎并不重要，但是等到您部署了数千个微服务，所有这些微服务都在单个集群中执行不同的任务时，就知道了！</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="3f31" class="mr ma iq nk b gy no np l nq nr"><strong class="nk ir">kubectl create namespace financial</strong></span></pre><h1 id="51bc" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">是啊！您的AKS集群现在可以接受和运行容器了！</h1><p id="5833" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">准备好继续并自动化您的容器构建和部署了吗？</p><p id="bb62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/up-and-running-with-azure-kubernetes-service-aks-and-devops-pipelines-deployment-40f054071477"> <strong class="ky ir">第3部分—使用Azure DevOps管道部署到Kubernetes</strong></a></p></div></div>    
</body>
</html>