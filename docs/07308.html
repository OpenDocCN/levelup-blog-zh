<html>
<head>
<title>Representing a Square Wave With a Fourier Series and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用傅里叶级数和Python表示方波</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442?source=collection_archive---------1-----------------------#2021-02-08">https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442?source=collection_archive---------1-----------------------#2021-02-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="c709" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设你想做一个周期波——可能是为了音乐合成器什么的。无论你需要波做什么，事实证明最容易产生的波是正弦(或余弦)波。只取以恒定角速度旋转的圆上一点的垂直分量，就可以得到正弦波。像这样。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/2f46b3293b2f4485f2583a7a375727d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/1*cjT4r0q6lj33n08vSZRbXw.gif"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">动画:瑞德·阿兰</figcaption></figure><p id="099a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是的，我用Glowscript制作了这个动画— <a class="ae la" href="https://trinket.io/glowscript/5f0003503c" rel="noopener ugc nofollow" target="_blank">这里是代码，以防你需要。</a>但是如果你想做一个不同的周期函数呢。假设你想产生一个方波。看起来是这样的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lb"><img src="../Images/93f9e7668c17e3fac9276e976fdfcef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mttmnjfUOO-_29mcpFc9Q.png"/></div></div></figure><p id="477d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好吧，这是很酷的事情。你可以用一堆正弦和余弦函数来产生这个方波。没错。这就是傅立叶级数背后的全部思想。</p><p id="ef6f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我有一个周期函数f(t)，那么下面是真的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lg"><img src="../Images/6ffca59b464cb80a8a062c8dac41457a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CpK41cmOZYUx_MxMOBNuGA@2x.png"/></div></div></figure><p id="f365" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是不同频率和不同振幅的正弦和余弦的无穷和。频率很简单，只是ω的整数倍。对于振幅，它们可以计算为:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/986c7b6ce74fa73f178639e00c32c390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*x_UQWz5yMnLcIUuW8Gr7SA@2x.png"/></div></figure><p id="4fd9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里τ是周期函数的周期，其中:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi li"><img src="../Images/95619903818f3776877548ccbdeab37d.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*41A1y7gnLbvQq5uUqb-jTA@2x.png"/></div></figure><p id="e163" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">哦，还有一件事。如果周期函数没有平均值为零(比如它没有绕t轴振荡)，那么你需要移动它。这是a0/2项，其中a0是一个周期的平均值。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/68afe5e12702420a96627f91d6ed665d.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*2lEsBYj-RS8amA8Y3Azo2g@2x.png"/></div></figure><p id="4642" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们开始吧。让我们用正弦和余弦建立一个方波模型。当然，我们不能添加无限数量的波，但我们可以做10个左右。这就是我要告诉你怎么做。首先，我要得到两个系数(a_n和b_n)的表达式。第二，我要把n项加起来，然后画出来，看看它看起来是不是方波。对于这第二部分，我将使用python ( <a class="ae la" href="https://medium.com/swlh/heres-how-to-make-a-graph-in-python-glowscript-actually-a7e06c8a3e26" rel="noopener">这里是我的python绘图教程</a>)。</p><p id="7fec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">求系数</strong></p><p id="7395" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我需要从方波的数学表达式f(t)开始。因为函数重复，我可以只定义一个周期。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/9087ba9ac137772114da3aa620f67b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*d3KkO2Zti22QQzPe2jzGkQ@2x.png"/></div></figure><p id="82fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我继续给出A和τ的值。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/b5db49bfd2e3636c4921006d55692e6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*5PU9RZOuU2ozAdVXHDSbeg@2x.png"/></div></figure><p id="6312" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我现在不需要这些值，但是稍后python绘图需要它们。好了，应该清楚了，A0等于零。我需要那样做吗？不——我们应该很乖，对吧？</p><p id="f047" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们从a_n开始(我用下划线表示下标，以防你没有注意到)。我要对函数f(t)积分，但是因为它有两个部分，我要得到两个积分。同样，我不是从-τ/2到τ/2，而是从0到τ积分。我希望那没问题。如果不行，我以后会补偿你的。于是积分变成:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lm"><img src="../Images/f3c6f2713787680d364ebfe7f519a808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emVY1A5AmXQI_efhiYD2HA@2x.png"/></div></div></figure><p id="7981" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">整合起来并不困难。只是余弦的积分。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ln"><img src="../Images/68cbd984e8316c871f70068a2cc6d25f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r1PmQiZOvx7iovlirQoB3w@2x.png"/></div></div></figure><p id="a9f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">分解出一些东西并在极限下评估:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lo"><img src="../Images/13ee3dc26e8150bc335069cbd47d3747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EMbq8UWYxzRxk1pcCgcj3w@2x.png"/></div></div></figure><p id="acd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">零的正弦值是零——就是这样。此外，我可以输入ω的表达式(如上),得到:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lp"><img src="../Images/b4e74ff1d3e7530d4c17193db154f017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5xC0XrhIde_Al4oDLT1_og@2x.png"/></div></div></figure><p id="b8fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你回想一下三角课上的单位圆，并记住<em class="lq"> n </em>是一个整数(1，2，3，…)。所以<em class="lq"> n </em> π的正弦将为零(它总是在单位圆的x轴上)。这个表达式中的每一项都是零。我希望你不会失望。</p><p id="1a2a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但这意味着所有的“a_n”项都是零。不过，真的很好。回头看看傅立叶级数。a_n项是余弦项的系数。然而，余弦是一个偶数函数，我们的方波是一个奇数函数。使用奇函数来构建一个奇函数是有意义的，所以我们不需要任何余弦项。</p><p id="86fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可能可以跳过计算a_n项的这一步，因为我们知道我们的函数是奇数——但它仍然是有用的。哦，记住不是每个函数都是奇数或偶数。有些傅里叶级数既需要a_n项又需要b_n项。</p><p id="4364" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">说到b_n，我们需要计算那些。这基本上和求解a_n的过程是一样的，我先把我们的方波函数放到b_n系数的定义中。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lp"><img src="../Images/29b6d944b77ef0050f345ea51d37a825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9jgJ2h37nacdBqxx90isbg@2x.png"/></div></div></figure><p id="85f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正弦的积分是负余弦。在极限下积分和评估，我得到:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lr"><img src="../Images/b6a6990fd02bdcb2d74ea8fb50bbfb7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0CKn7OP88zIdmGY5TUQPug@2x.png"/></div></div></figure><p id="0693" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，所有值都在单位圆的x轴上(在0、π或2π处，或其倍数处)。在0处，余弦为1，但在π处，余弦为-1。这意味着这些项要么是1，要么是-1。让我简化一下，因为我可以组合一些术语。还有，我要用前面的项代替ω。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ls"><img src="../Images/9b4de3150b48ee6fbd339380157fb8a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lC1HjQabiEicIrPKNbf_iw@2x.png"/></div></div></figure><p id="4396" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好吧，让我们想想这个。cos(2nπ)项始终为1。不管n的值是多少，它都会在x轴的正方向上余弦值为+1的位置。这里有两个+1项。让我重写。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/42f4737f4f430e58187e477d07582110.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*_QU4CEUIXqV2i8V1SzybyQ@2x.png"/></div></figure><p id="dd49" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当n = 1时会发生什么？在这种情况下，cos(π) = -1，所以括号中的值是1-(-1)=2。n = 2的时候呢，那么cos(2π) = 1，东西就为零了。当n是奇数时，括号将是2。当n是偶数时，它将是零。你可以就此打住——但是有一个技巧。你可以这样写:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/8b05b2833d1fd4bc66e7cb36f9780b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*TpjYVbx99qAeSAlHvGDRRQ@2x.png"/></div></figure><p id="edb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者你可以这样写:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/170efa9ca4958580dea87c95e623a623.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*JFzBDHjvWPAqwV-wlmlz5w@2x.png"/></div></figure><p id="94e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但不管怎样，我们都有自己的系数。</p><p id="67f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">用Python绘制傅立叶级数</strong></p><p id="947d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我给你们看一下，n = 5时傅里叶级数的曲线图。这就是了。这里是代码——但是别担心，我会解释的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lu"><img src="../Images/7d4d104755d9ab562631b3d54ba5cd9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMuADytSQyWNEGds41uogg.png"/></div></div></figure><p id="fda5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">除了你正常的制图材料之外，还有两个关键部分。第一个是计算b_n系数的函数。看起来是这样的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lv"><img src="../Images/0a34022a9e695a864116f57f522f24a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yw-VypbQAfuwD3ZLtKf8pA.png"/></div></div></figure><p id="b395" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">python中的函数是什么？哦，<a class="ae la" href="https://rjallain.medium.com/a-physicists-guide-to-functions-in-python-9aec73cc4dcb" rel="noopener">我有这方面的教程——给你。</a>但基本上，这只是返回某个值为n的系数的数值，是的，这取决于A的值，但那是上面列出的。请注意，我将(-1)提升到n次方——就像我们讨论过的那样。</p><p id="62d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是你如何策划整件事呢？这是代码的一部分。别担心，我会检查重要的细节。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lw"><img src="../Images/5b60733bad2a36750695c17d360d0e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ka2y3yOx3TQhpo1b_T-RIQ.png"/></div></div></figure><p id="740f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在来听一些评论:</p><ul class=""><li id="4696" class="lx ly it js b jt ju jx jy kb lz kf ma kj mb kn mc md me mf bi translated">第43行:<code class="fe mg mh mi mj b">ft</code>是f(t)在某点的值。因为傅立叶级数是一个和，这个值从零开始，然后我可以把东西加进去。</li><li id="922b" class="lx ly it js b jt mk jx ml kb mm kf mn kj mo kn mc md me mf bi translated">第44行:<code class="fe mg mh mi mj b">nn</code>是一个计数器变量。它用于计算傅立叶级数的最大值(N)。是的，这里还有一个“n”——那只是以前尝试做一些很酷的事情时留下的(但我放弃了)。</li><li id="630e" class="lx ly it js b jt mk jx ml kb mm kf mn kj mo kn mc md me mf bi translated">第45行:这是一个遍历n (n = 1，2，3，…)所有值的循环。对于n的每个值(我称之为nn)，我只需加上傅立叶项(bn*sin(stuff))。</li><li id="8c0c" class="lx ly it js b jt mk jx ml kb mm kf mn kj mo kn mc md me mf bi translated">第49行:画出傅立叶级数和特定值。</li><li id="d807" class="lx ly it js b jt mk jx ml kb mm kf mn kj mo kn mc md me mf bi translated">对下一个时间值重复上述步骤。</li></ul><p id="e17c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看看这个。下面是n = 20时的样子(只是为了好玩)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mp"><img src="../Images/44e18a1137f6c9e463eaff4e8b00df94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j_ppbSTc7IzD8KPO-2a2Bw.png"/></div></div></figure><p id="5faa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在这里的工作已经完成了。接下来我想做一个锯齿波——为了好玩。</p></div></div>    
</body>
</html>