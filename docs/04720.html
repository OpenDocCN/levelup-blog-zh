<html>
<head>
<title>JavaScript Tips — Date Difference, Sleep, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript技巧——时差、睡眠等等</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-tips-date-difference-sleep-and-more-deb5d84dc362?source=collection_archive---------24-----------------------#2020-07-10">https://levelup.gitconnected.com/javascript-tips-date-difference-sleep-and-more-deb5d84dc362?source=collection_archive---------24-----------------------#2020-07-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b385296ca7a4e4e83ba4e4d806aa9c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v9QPKfU_owctFwzG"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@brucemars?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布鲁斯·马尔斯</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="5546" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="d7d2" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">暂停节点程序一段时间</h1><p id="1fc9" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用<code class="fe mh mi mj mk b">setTuimeout</code>方法暂停一个节点程序一段时间。</p><p id="89ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="b879" class="mt lf it mk b gy mu mv l mw mx">setTimeout(() =&gt; console.log('pause'), 3000);</span></pre><p id="e1ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以创建一个带有<code class="fe mh mi mj mk b">setTimeout</code>函数的承诺。</p><p id="c242" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="a9a5" class="mt lf it mk b gy mu mv l mw mx">const sleep = (ms) =&gt; {<br/>  return new Promise((resolve) =&gt; {<br/>    setTimeout(resolve, ms);<br/>  });<br/>}</span></pre><p id="dcf7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们创建了一个<code class="fe mh mi mj mk b">sleep</code>函数来返回一个承诺。</p><p id="9684" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">resolve</code>超时后调用。</p><p id="9162" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">ms</code>是以毫秒为单位的超时持续时间。</p><p id="9397" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以通过写来使用它:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="1b16" class="mt lf it mk b gy mu mv l mw mx">const run = async () {<br/>  console.log('foo');<br/>  await sleep(1000);<br/>  console.log('bar');<br/>}</span></pre><p id="e6d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们调用<code class="fe mh mi mj mk b">sleep</code>在两个控制台日志之间暂停<code class="fe mh mi mj mk b">run</code>功能。</p><h1 id="8dea" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在React中更新嵌套状态属性</h1><p id="33c0" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过使用扩展操作符来更新嵌套状态属性。</p><p id="6989" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="6f62" class="mt lf it mk b gy mu mv l mw mx">this.setState({ foo: { ...this.state.foo, flag: false } });</span></pre><p id="2316" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们用新的值<code class="fe mh mi mj mk b">flag</code>设置<code class="fe mh mi mj mk b">foo</code>状态，同时保留剩余的<code class="fe mh mi mj mk b">this.state.foo</code>对象。</p><p id="2db3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">setState</code>用于组件类。</p><p id="5350" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们使用钩子，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="b0ba" class="mt lf it mk b gy mu mv l mw mx">setFoo({ ...foo, flag: false });</span></pre><p id="ef84" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<code class="fe mh mi mj mk b">setFoo</code>是<code class="fe mh mi mj mk b">useState</code>返回的状态变化函数。</p><h1 id="4651" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">如何通过值获取JavaScript对象中的键</h1><p id="4db6" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过反转键和值来获得JavaScript对象中的键。</p><p id="142e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以通过反转对象的键得到值。</p><p id="7013" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们可以使用下划线的<code class="fe mh mi mj mk b">invert</code>方法。</p><p id="9c41" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="1474" class="mt lf it mk b gy mu mv l mw mx">const obj = {<br/>  foo: 3,<br/>  bar: 4<br/>};<br/><br/>(_.invert(obj))[3];</span></pre><p id="f8b4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们翻转了<code class="fe mh mi mj mk b">obj</code>键和一个值，并用<code class="fe mh mi mj mk b">invert</code>返回新对象。</p><p id="491a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们就可以通过原对象的值得到密钥。</p><p id="6b0a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Lodash也有同样的方法。</p><h1 id="5544" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">将参数向前传递给另一个JavaScript函数</h1><p id="475b" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要将参数传递给另一个函数，我们可以使用<code class="fe mh mi mj mk b">apply</code>方法。</p><p id="c685" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="323a" class="mt lf it mk b gy mu mv l mw mx">const a = (...args) =&gt; {<br/>  b.apply(null, args);<br/>}</span><span id="55cd" class="mt lf it mk b gy my mv l mw mx">const b = (...args) =&gt; {<br/>  console.log(args);<br/>}</span></pre><p id="7b99" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以调用<code class="fe mh mi mj mk b">a</code>:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="6c66" class="mt lf it mk b gy mu mv l mw mx">a(1, 2, 3);​</span></pre><p id="a4cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用想要传入的参数调用<code class="fe mh mi mj mk b">a</code>函数。</p><p id="a7ca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们用<code class="fe mh mi mj mk b">apply</code>用同样的参数调用<code class="fe mh mi mj mk b">b</code>。</p><p id="7cf0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">args</code>是传入的参数数组。</p><p id="d6a7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，我们可以使用spread操作符来扩展参数，而不是使用<code class="fe mh mi mj mk b">apply</code>:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="e90c" class="mt lf it mk b gy mu mv l mw mx">const a = (...args) =&gt; {<br/>  b(...args);<br/>}</span><span id="105d" class="mt lf it mk b gy my mv l mw mx">const b = (...args) =&gt; {<br/>  console.log(args);<br/>}</span></pre><h1 id="8914" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Moment.js日期时间对比</h1><p id="120c" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过使用<code class="fe mh mi mj mk b">diff</code>方法来比较日期和时间。</p><p id="0f4c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="fd41" class="mt lf it mk b gy mu mv l mw mx">moment().diff(dateTime, 'minutes')</span></pre><p id="6f6f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">moment()</code>和<code class="fe mh mi mj mk b">dateTime</code>都是矩对象。</p><p id="246a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在<code class="fe mh mi mj mk b">moment()</code>上调用<code class="fe mh mi mj mk b">diff</code>来与<code class="fe mh mi mj mk b">dateTime</code>进行比较，并通过传入<code class="fe mh mi mj mk b">'minutes'</code>来获得分钟的差异。</p><p id="cd01" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">moment()</code>获取当前日期时间作为moment对象。</p><h1 id="103f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Javascript中默认导入的别名</h1><p id="37f2" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了在JavaScript中给默认导入起别名，我们可以随意命名它。</p><p id="c69c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="38c9" class="mt lf it mk b gy mu mv l mw mx">import alias from './module';</span></pre><p id="d584" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以名称<code class="fe mh mi mj mk b">alias</code>导入<code class="fe mh mi mj mk b">module</code>的默认导入。</p><p id="49f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="3794" class="mt lf it mk b gy mu mv l mw mx">import { default as alias } from './module';</span></pre><p id="403f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">做同样的事情。</p><h1 id="d2f8" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">将数组转换为JSON</h1><p id="cd28" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要将数组转换成JSON，我们可以在数组上调用<code class="fe mh mi mj mk b">JSON.stringify</code>。</p><p id="8a91" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="b7d5" class="mt lf it mk b gy mu mv l mw mx">const str = JSON.stringify(arr);</span></pre><p id="41a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<code class="fe mh mi mj mk b">arr</code>是数组。</p><h1 id="c4b4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从对象数组中获取不同的值</h1><p id="1c7c" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了从一个对象数组中获得不同的值，我们可以使用<code class="fe mh mi mj mk b">map</code>方法，将项目放入一个集合中以删除重复项。</p><p id="1e9f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="dbdd" class="mt lf it mk b gy mu mv l mw mx">const distincts = [...<!-- -->new Set(arr.map((item) =&gt; item.id))]</span></pre><p id="695f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们调用<code class="fe mh mi mj mk b">arr</code>上的<code class="fe mh mi mj mk b">map</code>方法将所有的<code class="fe mh mi mj mk b">id</code>属性值放入一个数组中。</p><p id="354b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们使用<code class="fe mh mi mj mk b">Set</code>构造函数从<code class="fe mh mi mj mk b">id</code>值的数组中创建一个集合来删除重复的值。</p><p id="d557" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们用spread操作符将集合转换回数组。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/df8a424688990e055ea74711164ef5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t0gZxIRWRPUjt_j4"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">凯特·斯通·马西森在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="5f86" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="137a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过使用承诺来暂停程序。</p><p id="54fa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">集合对于删除重复项非常有用。</p><p id="0381" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用rest操作符来获取一个对象的所有参数。</p></div></div>    
</body>
</html>