<html>
<head>
<title>Build a Todo App using Firebase + React + TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Firebase + React + TypeScript构建一个Todo应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/todo-app-using-firebase-react-typescript-ea0a34bd417d?source=collection_archive---------1-----------------------#2020-05-10">https://levelup.gitconnected.com/todo-app-using-firebase-react-typescript-ea0a34bd417d?source=collection_archive---------1-----------------------#2020-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="68f4" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="ak">简介</strong></h1><p id="7345" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">本文是初学者指南，介绍如何通过构建一个简单的TODO应用程序将React应用程序连接到Firebase。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lj"><img src="../Images/aabfc3d12f8e875f271ceae42ab4f6da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5rioxJn72PdQrtiG_65Z7g.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk translated">一个基于Material-UI React框架的基本Todo应用程序</figcaption></figure><p id="535d" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">Firebase通过实时数据库帮助您构建移动和Web应用程序，这意味着如果一个用户更新数据库中的记录，所有订阅该数据的用户都将获得更新的数据。这使得开发人员的工作变得容易。</p><p id="69d3" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">举例来说，如果您必须构建一个简单的聊天，您需要有后端服务、数据库和WebSocket，或者您可以使用Firebase来处理构建实时聊天应用程序所需的所有功能。</p><p id="c527" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated"><strong class="kn ir">使用Firebase的一些主要优势</strong></p><ol class=""><li id="0774" class="me mf iq kn b ko lz ks ma kw mg la mh le mi li mj mk ml mm bi translated">实时数据库</li><li id="76f1" class="me mf iq kn b ko mn ks mo kw mp la mq le mr li mj mk ml mm bi translated">主办；主持</li><li id="6b93" class="me mf iq kn b ko mn ks mo kw mp la mq le mr li mj mk ml mm bi translated">证明</li><li id="4455" class="me mf iq kn b ko mn ks mo kw mp la mq le mr li mj mk ml mm bi translated">储存；储备</li><li id="9cc2" class="me mf iq kn b ko mn ks mo kw mp la mq le mr li mj mk ml mm bi translated">通知</li></ol><p id="3bdb" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">在本文中，我们将介绍如何设置Firebase以及如何将其连接到React应用程序。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="fae0" class="mz jo iq bd jp na nb dn jt nc nd dp jx kw ne nf kb la ng nh kf le ni nj kj nk bi translated"><strong class="ak">建立你的Firebase数据库</strong></h2><p id="18de" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">要设置你的数据库，你需要使用谷歌账户登录到你的firebase控制台<a class="ae nl" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank">链接</a></p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nm"><img src="../Images/9fe0bfed6603b8d3a91a9872acbc7bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B5E7LHpHI27yCw5L9icc9A.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk translated">你的控制台应该看起来像这样</figcaption></figure><p id="1785" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">进入控制台后，通过给项目命名来添加项目</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nm"><img src="../Images/adc776cc8230398b62379d38f7d2cb22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDQ40yo6CLu74INrFLh4VQ.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk translated">数据库控制台</figcaption></figure><p id="0ae8" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">现在下一步是将Firebase连接到你的应用程序。在本文中，我们将使用React.js，因此让我们将它连接到我们的应用程序。点击“&gt;”注册应用程序，您将获得以下格式的配置详情</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="7d0a" class="mz jo iq no b gy ns nt l nu nv">var firebaseConfig = {<br/>    apiKey: "xxxxxxxxxxxxxxxxxxxxxxxxxxxx",<br/>    authDomain: "xxxxxxxxxxxx",<br/>    databaseURL: "xxxxxxxxxx",<br/>    projectId: "xxxxxxxxxx",<br/>    storageBucket: "xxxxxxxxxxx",<br/>    messagingSenderId: "xxxxxxxxxxxxxxxxxxx",<br/>    appId: "1:xxxxxxxxx:web:xxxxxxxxxxxxxx",<br/>    measurementId: "xxxxxxxxx"<br/>  };</span></pre><p id="005e" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">设置Firebase的最后一步是创建一个数据库。在这个例子中，我们将使用测试模式数据库</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nm"><img src="../Images/9d0137b494a7b95d77b3347b2b4e47e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B54u5oJghk4V8wF3dHLIvw.png"/></div></div></figure><p id="b005" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">出于安全原因，Firebase只允许30天的测试模式。您可以通过转到rules并将配置更改为</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="df13" class="mz jo iq no b gy ns nt l nu nv">rules_version = '2';<br/>service cloud.firestore {<br/>  match /databases/{database}/documents {</span><span id="71df" class="mz jo iq no b gy nw nt l nu nv">// This rule allows anyone on the internet to view, edit, and delete<br/>    // all data in your Firestore database. It is useful for getting<br/>    // started, but it is configured to expire after 30 days because it<br/>    // leaves your app open to attackers. At that time, all client<br/>    // requests to your Firestore database will be denied.<br/>    //<br/>    // Make sure to write security rules for your app before that time, or else<br/>    // your app will lose access to your Firestore database<br/>    match /{document=**} {<br/>      allow read, write;<br/>    }<br/>  }<br/>}</span></pre><p id="9541" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">现在我们让Firebase设置它的时间来设置React应用程序。在这个例子中，我们将使用TypeScript。让我们使用CRA命令创建应用程序</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="d65e" class="mz jo iq no b gy ns nt l nu nv">npx create-react-app todo-firebase --template typescript</span><span id="6086" class="mz jo iq no b gy nw nt l nu nv"># or</span><span id="5b81" class="mz jo iq no b gy nw nt l nu nv">yarn create react-app todo-firebase --template typescript</span></pre><p id="1b03" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">一旦应用程序设置，我们需要添加应用程序的Firebase配置。最好的方法是将其作为自定义环境变量添加到。env文件的细节可以在<a class="ae nl" href="https://create-react-app.dev/docs/adding-custom-environment-variables/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。自定义变量应该以REACT_APP_开头。一旦我们添加了变量，我们的env文件将会是这样的</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="d832" class="mz jo iq no b gy ns nt l nu nv">REACT_APP_APIKEY=XXXXXXXXXXXXXXXX</span><span id="581c" class="mz jo iq no b gy nw nt l nu nv">REACT_APP_AUTHDOMAIN=xxxxxxxxxxxxxxx</span><span id="6ddd" class="mz jo iq no b gy nw nt l nu nv">REACT_APP_DB=XXXXXXXXXXXXX</span><span id="9bdc" class="mz jo iq no b gy nw nt l nu nv">REACT_APP_PID=XXXXXXXXXXXXXXX</span><span id="c8b4" class="mz jo iq no b gy nw nt l nu nv">REACT_APP_SB=XXXXXXXXXXXXX</span><span id="7e53" class="mz jo iq no b gy nw nt l nu nv">REACT_APP_SID=XXXXXXXXXXXXXXX</span><span id="334a" class="mz jo iq no b gy nw nt l nu nv">REACT_APP_APPID=1:XXXXXXXXX:web:XXXXXXXXXXXX</span><span id="30c7" class="mz jo iq no b gy nw nt l nu nv">REACT_APP_MID=XXXXXXXXXXX</span></pre><p id="b55b" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">将Firebase模块安装到我们的应用程序中</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="fb5c" class="mz jo iq no b gy ns nt l nu nv">npm install firebase<br/>Or<br/>yarn add firebase</span></pre><p id="7233" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">因此，让我们通过创建文件firebase.ts来初始化我们的应用程序中的firebase。因此，我们只需要导入我们需要的特性，而不是包含所有的特性。在我们的例子中，我们需要唯一的数据库，所以我们的firebase文件将导入唯一的数据库</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="556f" class="mz jo iq no b gy ns nt l nu nv">import firebase from 'firebase/app'</span><span id="7145" class="mz jo iq no b gy nw nt l nu nv">import "firebase/database"</span><span id="1a80" class="mz jo iq no b gy nw nt l nu nv">const config = {</span><span id="f384" class="mz jo iq no b gy nw nt l nu nv">apiKey: process.env.REACT_APP_APIKEY,</span><span id="6611" class="mz jo iq no b gy nw nt l nu nv">authDomain: process.env.REACT_APP_AUTHDOMAIN,</span><span id="fc98" class="mz jo iq no b gy nw nt l nu nv">databaseURL: process.env.REACT_APP_DB,</span><span id="ba23" class="mz jo iq no b gy nw nt l nu nv">projectId: process.env.REACT_APP_PID,</span><span id="d27d" class="mz jo iq no b gy nw nt l nu nv">storageBucket: process.env.REACT_APP_SB,</span><span id="38d1" class="mz jo iq no b gy nw nt l nu nv">messagingSenderId: process.env.REACT_APP_SID,</span><span id="785a" class="mz jo iq no b gy nw nt l nu nv">appId: process.env.REACT_APP_APPID,</span><span id="0b4b" class="mz jo iq no b gy nw nt l nu nv">measurementId:process.env.REACT_APP_MID</span><span id="43db" class="mz jo iq no b gy nw nt l nu nv">};</span><span id="3941" class="mz jo iq no b gy nw nt l nu nv">firebase.initializeApp(config);</span></pre><p id="267b" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">接下来，我们需要引用我们的集合来执行CRUD操作。在本例中，我们将集合称为todos。我们可以通过获取数据库的引用来获取这个集合的引用</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="793b" class="mz jo iq no b gy ns nt l nu nv">firebase.initializeApp(config);</span><span id="9388" class="mz jo iq no b gy nw nt l nu nv">const databaseRef = firebase.database().ref();</span><span id="5a22" class="mz jo iq no b gy nw nt l nu nv">export const todosRef = databaseRef.child("todos")</span></pre><p id="276d" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">因此，配置文件将初始化应用程序，并获取所需集合的引用</p><figure class="lk ll lm ln gt lo"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="30a4" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">我们的示例应用程序有TodoList、TodoForm和Todo组件。这个例子的样板代码可以在这里找到。</p><p id="3543" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">好了，设置好了，让我们创建一个待办事项。通常，如果我们使用我们自己的服务，我们将使用fetch或Axios通过导入包进行API调用来保存数据，然后调用route并发布数据。但是使用firebase，您可以在一行代码中完成导入集合引用并推送数据。这是我喜欢在firebase上工作的众多原因之一。它使前端开发人员的工作变得容易。</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="daa6" class="mz jo iq no b gy ns nt l nu nv">import {todosRef} from "./firebase";</span><span id="a151" class="mz jo iq no b gy nw nt l nu nv">todosRef.push(item)</span></pre><p id="41cb" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">因此，要在TodoForm.tsx中创建todo，我们需要获取数据并将其推送到引用。</p><figure class="lk ll lm ln gt lo"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="673b" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">现在让我们看看如何从todos的案例列表中获取数据。为了检索数据，我们使用<strong class="kn ir"> on() </strong>方法。该方法将事件类型作为<strong class="kn ir">【值】</strong>，然后检索数据的<strong class="kn ir">快照</strong>。因此，每次值改变时，我们将获得新的数据集，而无需用户刷新页面或进行API调用或套接字。就像我之前提到的，它给了我们实时数据。如果我们只需要一次数据，那么我们使用once()方法代替on()方法。我将在下一篇文章中更多地讨论QueryReference和快照，在下一篇文章中，我们将使用Firebase在应用程序中设置身份验证。所以这就是我们的TodoList.tsx添加这个方法后的样子。</p><figure class="lk ll lm ln gt lo"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="3b57" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">为了从集合引用的集合中更新或删除文档，我们通过id获取子文档。一旦有了数据，我们就用set()方法更新它，用remove()方法删除数据</p><pre class="lk ll lm ln gt nn no np nq aw nr bi"><span id="92f1" class="mz jo iq no b gy ns nt l nu nv">// To update data<br/>todosRef.child(todo.id).set({...todo,done:!todo.done})</span><span id="5625" class="mz jo iq no b gy nw nt l nu nv">// To delete data<br/>todosRef.child(todo.id).remove()</span></pre><figure class="lk ll lm ln gt lo"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="af57" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">因此，只需添加一些配置，我们就可以创建一个react应用程序并执行CRUD操作，而无需担心后端。完整的代码可以在<a class="ae nl" href="https://github.com/suhas86/react-todo-firebase/tree/firebase-integration" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p><p id="baf8" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">我将继续撰写一篇关于如何使用firebase处理认证的文章。</p><p id="5f25" class="pw-post-body-paragraph kl km iq kn b ko lz kq kr ks ma ku kv kw mb ky kz la mc lc ld le md lg lh li ij bi translated">编码快乐！干杯</p></div></div>    
</body>
</html>