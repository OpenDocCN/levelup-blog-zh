<html>
<head>
<title>Setting up a cooler for your Orange Pi/Raspberry Pi using Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python为您的橘子汁/树莓汁设置冷却器。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setting-up-a-cooler-for-your-orange-pi-raspberry-pi-using-python-39f6276fc920?source=collection_archive---------1-----------------------#2019-03-18">https://levelup.gitconnected.com/setting-up-a-cooler-for-your-orange-pi-raspberry-pi-using-python-39f6276fc920?source=collection_archive---------1-----------------------#2019-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5027" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python几乎可以用于任何事情，包括帮助控制你最喜欢的单板计算机的温度。尽管今天的SBC很棒，但是如果让它们运行一段时间，大多数都会变得非常热，从而缩短它们的寿命并抑制它们的性能。</p><p id="56e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，让我在我的SBC上安装一个简单的5v或12v风扇，所有问题都解决了，对吗？没那么快。一周七天、一天二十四小时运转的风扇通常会让你因噪音而发疯，在需要更换之前会持续很短一段时间，并利用不必要的能量。</p><p id="ea26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有进展了。让我们使用python建立一个简单的脚本，检查温度是否高于阈值并打开风扇。由于大多数风扇在5V或更高电压下运行(大多数GPIO引脚为3.3V)，我将使用PNP晶体管，因此当GPIO输出为低电平时，晶体管工作(这使得晶体管型号更加灵活)。</p><h1 id="9749" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">你需要:</strong></h1><p id="ca91" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">- 1个橘皮或树莓皮<br/> - 1个PNP晶体管(5v风扇示例中的BC 327)<br/>-电线<br/> -热缩管<br/> -一个风扇(5v或12v)</p><h1 id="a9c2" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">免责声明</strong></h1><p id="a5ce" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">本教程旨在帮助你为你的橘子皮/树莓皮建立一个风扇控制器。以下步骤需要一些电子、电气系统和IT知识。如果你遵循这些步骤，风险自负。</p><h1 id="52e7" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">连接GPIO </strong></h1><p id="251b" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">如果使用5V风扇，找到GND、5V引脚和一个GPIO引脚，用于控制晶体管和插线(可以使用<a class="ae lo" href="https://www.google.com/search?q=pin+headers+female" rel="noopener ugc nofollow" target="_blank">接头</a>或焊接电线)。如果你使用12v风扇，你将需要一个外部电源，而不是使用板GND和5V引脚，使用12v电源线。<strong class="jp ir">任何情况下都不要将任何12V电线连接到电路板上。</strong></p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/1fb67a5e8bf3b0ca952ee0ce1eecc26e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bCzCVPlQZvecgRU6.jpg"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">橙色Pi零GPIO</figcaption></figure><h1 id="3411" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">PNP晶体管布线</strong></h1><p id="0b6d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">现在，按照逻辑示意图焊接来自GPIO的电线。负轨为GND，正轨为5V，GPIO引脚为GPIO输出。逻辑很简单，晶体管充当负供电轨内的开关。当GPIO引脚关闭时，电流流动并允许风扇旋转。最后，你可以用热缩管来隔离连接。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/8c7294fd05faa5def2c16a312aa03754.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*cKON5wWtWF-MuJmm63hdOQ.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">使用PNP晶体管的简单布线示意图</figcaption></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mg"><img src="../Images/64316d579c1eb73a72f1856995b5ba2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KFvri9bdj7-PJsSSVVyWfg.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">第一个原型</figcaption></figure><h1 id="9e93" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">Python脚本</strong></h1><p id="9643" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">现在，连接已经完成，我们可以开始交易的软件部分了。确保在您的系统上安装Python，创建一个. py文件，并粘贴以下代码:</p><pre class="lq lr ls lt gt mh mi mj mk aw ml bi"><span id="9a22" class="mm km iq mi b gy mn mo l mp mq"># Do the imports<br/>import os<br/>import sys<br/># OPi Library and instructions: <a class="ae lo" href="https://pypi.org/project/OrangePi.GPIO/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/OrangePi.GPIO/</a><br/>import OPi.GPIO as GPIO<br/>from time import sleep</span><span id="4762" class="mm km iq mi b gy mr mo l mp mq"># Orange Pi Setup<br/>GPIO.setboard(GPIO.ZERO)<br/>GPIO.setmode(GPIO.BOARD)</span><span id="47f9" class="mm km iq mi b gy mr mo l mp mq"># Targeted temperature to start the fan (40 degrees celsius)<br/>controlTemp = 40000</span><span id="26a4" class="mm km iq mi b gy mr mo l mp mq"># I’m using GPIO and a PNP transistor to control the fan, by default it will be enabled. 1 sets the GPIO to HIGH and 0 to LOW.<br/>outputValue = 0</span><span id="f0be" class="mm km iq mi b gy mr mo l mp mq"># Output GPIO pin for the fan transistor. Check the pinout at: <a class="ae lo" href="https://i0.wp.com/oshlab.com/wp-content/uploads/2016/11/Orange-Pi-Zero-Pinout-banner2.jpg?fit=1200%2C628&amp;ssl=1" rel="noopener ugc nofollow" target="_blank">https://i0.wp.com/oshlab.com/wp-content/uploads/2016/11/Orange-Pi-Zero-Pinout-banner2.jpg?fit=1200%2C628&amp;ssl=1</a><br/>outputPin = 24</span><span id="0b1e" class="mm km iq mi b gy mr mo l mp mq"># Reads the armbian temperature file and checks if it's higher than the threshold, if positive, turns the fan on, otherwise, off.<br/>with open(‘/etc/armbianmonitor/datasources/soctemp’, ‘r’) as fin:<br/> temp=0 <br/> temp = int(fin.read())<br/> if(temp &gt;= controlTemp):<br/>  outputValue = 0<br/> else:<br/>  outputValue = 1<br/> #print temp<br/> #print controlTemp<br/> #print outputValue</span><span id="dfbf" class="mm km iq mi b gy mr mo l mp mq">GPIO.setup(outputPin, GPIO.OUT)<br/>GPIO.output(outputPin, outputValue)<br/>GPIO.cleanup()</span></pre><h1 id="b4a1" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">覆盆子替代品</strong></h1><p id="2770" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">您可以将该脚本用于您的树莓Pi。用<a class="ae lo" href="https://pypi.org/project/RPi.GPIO/" rel="noopener ugc nofollow" target="_blank"> RPI库</a>更改OPi，并用“/sys/class/thermal/thermal _ zone 0/temp”交换“/etc/armbian monitor/data sources/SOC temp”的温度读数。</p><h1 id="11c5" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">设置Cron </strong></h1><p id="3a68" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">现在，让我们将脚本设置为每五分钟运行一次，这样它就可以检查温度并在必要时打开风扇。为此，我们将使用<a class="ae lo" href="https://pt.wikipedia.org/wiki/Crontab" rel="noopener ugc nofollow" target="_blank"> Crontab </a>。在终端中，键入:</p><pre class="lq lr ls lt gt mh mi mj mk aw ml bi"><span id="a0c7" class="mm km iq mi b gy mn mo l mp mq">sudo crontab -e</span></pre><p id="53dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将被要求编辑cron文件(使用nano或您最喜欢的编辑器)。进入编辑模式，转到文件的最后一行，插入以下行:</p><pre class="lq lr ls lt gt mh mi mj mk aw ml bi"><span id="0883" class="mm km iq mi b gy mn mo l mp mq">/5 * * * * /usr/bin/python /path/to/yourscript.py</span></pre><p id="cf68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> /5 </strong>表示系统每五分钟调用一次这个脚本。<br/> <strong class="jp ir"> /usr/bin/python </strong>是python引擎的路径。(如果你的路径更新了，也可以只使用<em class="ms"> python </em>)。<br/><strong class="jp ir">/path/to/your script . py</strong>是你的脚本的路径。</p><p id="c99f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，通过按CTRL + X和“是”保存文件。<br/>重启系统，一切准备就绪。<br/>您的风扇控制器应该工作正常。</p><div class="mt mu gp gr mv mw"><a href="https://media1.giphy.com/media/KhdQ2Ia3FJuKs/giphy.gif?cid=3640f6095c8f05d451717a47366c57de" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd ir gy z fp nb fr fs nc fu fw ip bi translated">猫迷GIF -在GIPHY上查找和分享</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">发现并与你认识的每个人分享这只猫的GIF。GIPHY是你搜索、分享、发现和创建gif的方式。</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">media1.giphy.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk lz mw"/></div></div></a></div><h1 id="784d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">结果</strong></h1><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nl"><img src="../Images/dbf6f9edae6e5481ee797525d35011de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1i1g3mrEa49XWIOKUZ3ztg.jpeg"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">橙色Pi，带风扇和控制器晶体管，用作带外置硬盘的文件服务器。</figcaption></figure><p id="30b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您的SBC可以运行风扇，只在需要时运行。</p></div></div>    
</body>
</html>