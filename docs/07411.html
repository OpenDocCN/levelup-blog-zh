<html>
<head>
<title>3 tips to up your RSpec game</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提升RSpec游戏的3个技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/3-tips-to-up-your-rspec-game-fd4f4b3b39b4?source=collection_archive---------22-----------------------#2021-02-15">https://levelup.gitconnected.com/3-tips-to-up-your-rspec-game-fd4f4b3b39b4?source=collection_archive---------22-----------------------#2021-02-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c8c0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">测试，烦人但有用！</h2></div><p id="7e62" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated">在日常工作中，每个开发人员都应该被要求为他们的工作编写测试，如果没有人被要求，他应该去要求。虽然它们写起来很麻烦，很烦人，而且通常是事后才想到的，但是在重构代码、升级框架或者将它们作为特性文档的一种形式时，它们确实非常有用。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/e4b00a02250fd0ad7e3e8e3d1e2dfb9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yABDxybRlXqJoDxm"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">由<a class="ae ma" href="https://unsplash.com/@karishea?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡里·谢伊</a>在<a class="ae ma" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="c377" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一些帮助我写出更清晰、更有结构、整体更好的规范的技巧。实施这些技巧也将简化你的工作流程，并给你一个关于如何进行测试的方向和更好的想法。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="d5ef" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">构建代码</h1><p id="95c6" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di">如果</span>我们接受测试将作为我们代码的文档这一前提，那么编写描述性测试并使用框架为我们提供的<strong class="kh ir">描述、上下文、信息技术</strong>是很重要的。</p><p id="1aad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个开源项目ChatWoot 的例子，值得推荐。</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="2c8f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个例子中，很容易理解我们正在测试什么，以及在给定的上下文中它应该如何表现。因此，现在当其他人试图做这项工作时，他可以阅读规范并理解给定端点的目的，而不是阅读代码。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="2903" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">使用数据工厂</h1><p id="ab08" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> D </span> ata工厂(或简称为<em class="nh">工厂</em>)是一个蓝图，它允许我们用预定义的值集创建一个对象或对象集合。虽然没有它们你也可以工作，但你绝对应该使用它们。工厂会让你的代码变得枯燥，让你的工作流程变得更快更简单。</p><p id="8d3d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我个人使用<a class="ae ma" href="https://github.com/thoughtbot/factory_bot_rails" rel="noopener ugc nofollow" target="_blank"> FactoryBot </a>，它很容易设置，几乎没有学习曲线，你需要的一切都有据可查，易于实施。</p><p id="3322" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看一个简单的例子，考虑这个模型:</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="5f73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以创建一个工厂，为一个对象创建所有必要的数据:</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="0e5a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过阅读这个要点，我们可以得出结论，下一次我们想要创建一个article对象，它是由用户自动创建的，我们只需调用:</p><pre class="ll lm ln lo gt ni nj nk nl aw nm bi"><span id="b408" class="nn mj iq nj b gy no np l nq nr">create :article, :published</span></pre><p id="d0c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这一行开始，我们将创建一个新的文章，以及带有名称和状态属性的用户对象，显然，如果我们为它们传递不同的值，这些属性可以被覆盖，这显然比手动创建多个对象好得多。</p><p id="6ab2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但这并不是FactoryBot必须提供的全部，它为您可能遇到的不同场景构建了各种有用的回调。所有这些特性都是为了让你的生活更简单，你的代码更干净，这绝对值得一看，<a class="ae ma" href="https://github.com/thoughtbot/factory_bot/blob/master/GETTING_STARTED.md" rel="noopener ugc nofollow" target="_blank">入门</a>。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="4533" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">追踪您的Cove覆盖范围</h1><p id="daac" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi lb translated">知道你是否已经很好地测试了你的代码的最好方法是用一个专门设计的工具来跟踪你的覆盖率。注意，检查你的代码是否被覆盖并不等同于检查你的测试是否有效。</p><p id="cc3a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用测试覆盖你的代码库是非常有用的，这是一个健康的项目和负责任的开发者的标志。</p><p id="0af6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了检查我的代码覆盖率，我使用了<a class="ae ma" href="https://github.com/simplecov-ruby/simplecov" rel="noopener ugc nofollow" target="_blank"> SimpleCov </a>，它设置起来很简单，并且给了你大量的数据来逐行检查你的覆盖率。</p><p id="1367" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设置很简单，将simplecov添加到您的gemfile中，并在您的<code class="fe ns nt nu nj b"><em class="nh">spec_helper.rb</em></code> <em class="nh">或</em> <code class="fe ns nt nu nj b"><em class="nh">rails_helper</em></code> <em class="nh">的顶部添加:</em></p><pre class="ll lm ln lo gt ni nj nk nl aw nm bi"><span id="6463" class="nn mj iq nj b gy no np l nq nr">require 'simplecov'<br/>SimpleCov.start :rails</span></pre><p id="187b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设置完成后，你的规格完成运行，你会得到生成一个HTML文件，非常容易理解和阅读。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="5b34" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">结论</h1><p id="4014" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi lb translated">不管你喜不喜欢，测试你的代码是每个开发人员一天中不可或缺的一部分，一旦你接受了编写测试，并开始将它们视为开发过程中的一个重要部分，那么事后的生活将会变得更加容易。</p><p id="b1ba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些工具帮助我提高了我的Rspec游戏，我不得不艰难地学习它，从一开始我不注意我的覆盖范围一直到现在我不得不回去覆盖错过的行。</p><div class="nv nw gp gr nx ny"><a href="https://rspec.info/" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">r spec:Ruby的行为驱动开发</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">Ruby的行为驱动开发。让TDD变得高效和有趣。首先，安装RSpec并运行rspec…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">rspec.info</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om lu ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a href="https://github.com/simplecov-ruby/simplecov" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">simplecov-ruby/simplecov</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">SimpleCov是一个用于Ruby的代码覆盖分析工具。它使用Ruby内置的覆盖率库来收集代码覆盖率…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">github.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om lu ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a href="https://github.com/thoughtbot/factory_bot_rails" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">思维机器人/工厂机器人轨道</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">factory_bot是fixtures的替代品，具有简单的定义语法，支持多种构建策略…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">github.com</p></div></div><div class="oh l"><div class="oo l oj ok ol oh om lu ny"/></div></div></a></div></div></div>    
</body>
</html>