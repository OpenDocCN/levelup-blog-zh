<html>
<head>
<title>A Simple Guide to Building Your First Python Flask API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建第一个Python Flask API的简单指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-simple-guide-to-building-your-first-python-flask-api-15443afdbd85?source=collection_archive---------7-----------------------#2020-01-13">https://levelup.gitconnected.com/a-simple-guide-to-building-your-first-python-flask-api-15443afdbd85?source=collection_archive---------7-----------------------#2020-01-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/857d73e6d13db504da24deacfe29248b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w95A4tHEPy_wLknb"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">莎伦·麦卡琴在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="0e69" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Python的Flask是一个轻量级web框架，它提供了一种快速构建应用程序后端的方法，同时让开发人员能够控制实现。它是在Django流行几年后创建的，所以它<a class="ae kf" href="http://web.archive.org/web/20160305145017/http://jokull.calepin.co/my-flask-to-django-experience.html" rel="noopener ugc nofollow" target="_blank">在许多方面都比Django</a>有所改进，同时允许更大的灵活性。</p><p id="e7f9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与Django不同，Flask不提供内置的数据访问层或迁移、管理接口、序列化、缓存或表单验证方法。它确实提供了模板引擎、开发服务器和调试器、单元测试，以及对处理HTTP请求和响应的内置支持。</p><p id="6766" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您不喜欢样板代码，希望实现更加灵活，并希望快速入门，Flask是一个很好的选择。</p><p id="7568" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本指南中，我描述了如何在几分钟内建立一个简单的Python Flask API。在以后的教程中，我将深入研究Flask框架的不同元素。</p><h1 id="5913" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">设置您的Python虚拟环境</h1><p id="559e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Python虚拟环境充当容器，允许您独立运行Flask应用程序。如果你还没有建立一个Python虚拟环境，你可以通过<a class="ae kf" href="https://medium.com/swlh/how-to-setup-your-python-projects-1eb5108086b1" rel="noopener">这篇指南</a>来了解如何建立。这一步不是必须的，但是如果你管理多个项目，它会让你的生活变得容易很多。</p><h1 id="a0a3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">安装烧瓶</h1><p id="35d1" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">接下来，使用pip安装Flask框架包。确保您的虚拟环境已激活，然后运行以下命令。这些命令安装flask，然后将需求保存到requirements.txt文件中。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="dae4" class="mq lf it mm b gy mr ms l mt mu">pip install flask<br/>pip freeze &gt; requirements.txt</span></pre><h1 id="90a4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">创建一个基本的烧瓶应用程序</h1><p id="eab6" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">创建Flask应用程序就像用两行代码添加一个文件一样简单。首先，创建一个目录来存储您的新应用程序。然后创建app.py文件。我正在构建的是一个管理食谱的工具，所以我把我的目录命名为recipes-api。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="2f45" class="mq lf it mm b gy mr ms l mt mu">mkdir recipes-api<br/>touch app.py</span></pre><p id="3a70" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">打开app.py文件并添加以下代码。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="70da" class="mq lf it mm b gy mr ms l mt mu">from flask import Flask<br/>app = Flask(__name__)</span></pre><p id="9caa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你现在有了一个Flask API。不过，它没有路线，所以我们来处理一下。</p><h1 id="a22d" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">创建您的路线</h1><p id="2039" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Flask路由对应于可以通过HTTP GET、POST、PUT和DELETE命令调用的API端点。您的路线是消费者对您的API能做什么的看法，因此它们应该对调用它们的程序员有意义，并遵循<a class="ae kf" href="https://devhints.io/rest-api" rel="noopener ugc nofollow" target="_blank"> REST原则</a>。</p><p id="aaa5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们增加两条路线；一个是作为我的API在浏览器中的主页，另一个是获取所有食谱。现在，我返回虚拟数据。在后面的教程中，我将介绍如何使用SQLAlchemy从数据库中获取数据。</p><p id="b5ef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">@app.route装饰器用于告诉Flask哪个路由应该调用这个特定的函数。在函数内部，返回数据。为了简单起见，我们现在只返回原始数据，忽略HTTP状态代码。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="8ef9" class="mq lf it mm b gy mr ms l mt mu">@app.route('/')<br/>def index():<br/>  return '&lt;h1&gt;Recipes API&lt;/h1&gt;'</span><span id="8385" class="mq lf it mm b gy mv ms l mt mu">@app.route('/recipes')<br/>def recipes():<br/>  return {<br/>    'title': 'Smoked Salmon Chowder', <br/>    'ingredients': 'salmon, milk, bacon'<br/>  }</span></pre><h1 id="edf0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">运行应用程序</h1><p id="d746" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Flask框架提供了一个简单的开发web服务器。这个方便的特性是单线程服务器，不适合生产环境。如果您现在需要在生产中运行您的应用程序，请参见这些<a class="ae kf" href="https://flask.palletsprojects.com/en/1.1.x/deploying/" rel="noopener ugc nofollow" target="_blank">部署选项</a>。</p><p id="8383" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们使用以下命令在本地运行我们的应用程序。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="fd98" class="mq lf it mm b gy mr ms l mt mu">flask run</span></pre><p id="4769" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Flask自动检测app.py文件(您也可以将其命名为wsgi.py ),并在其中找到flask应用程序。请注意，该文件必须位于运行flask命令的目录中，所以我通常将它放在项目的根目录中。此外，如果您将文件命名为app.py或wsgi.py之外的名称，您需要通过设置FLASK_APP环境变量来告诉Flask您的应用程序所在的位置。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="fc5a" class="mq lf it mm b gy mr ms l mt mu">export FLASK_APP=my_app.py</span></pre><p id="32ca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当您运行flask应用程序时，您应该会看到这一点。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/e9ffa306c0d9744cc5af2bb6da101e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*YjxK9DktGj-AGGyzVQZgZA.png"/></div></figure><p id="8b10" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在你的浏览器中导航到<a class="ae kf" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>或者<a class="ae kf" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000/ </a>，你应该会看到你的主页。</p><p id="506a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尝试导航到<a class="ae kf" href="http://localhost:5000/recipes" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/recipes</a>，您应该会看到返回的数据。</p><p id="eed7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">恭喜你。您刚刚构建了一个Flask API。</p><h1 id="2dde" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">(奖励)使用调试模式</h1><p id="0592" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要在调试模式下运行您的应用程序并利用FLASK内置的重新加载特性，请设置FLASK_DEBUG=1环境变量，然后重新运行Flask命令。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="c4bb" class="mq lf it mm b gy mr ms l mt mu">export FLASK_DEBUG=1<br/>flask run</span></pre><p id="32e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在您应该在终端中看到类似这样的内容，调试模式设置为on。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/e03cd8abff71f2c02476d0a39918935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*EK_5BE-NuSV5AUR-CFTsMw.png"/></div></figure><p id="5b2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您打开了一个浏览器，并且更改了app.py文件中的某些内容，例如，由您的路线返回的文本，您应该会看到服务器重新构建您的应用程序。</p><p id="3e3c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Flask不会自动重新加载你的浏览器。如果你想要传统的热重装，你会看到一个前端应用程序，试着安装一个像<a class="ae kf" href="https://github.com/lepture/python-livereload" rel="noopener ugc nofollow" target="_blank"> python-livereload </a>这样的包。</p><h1 id="435d" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">(附加)设置一个. env文件</h1><p id="9b77" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Flask会自动识别根目录中的. env文件。为了避免每次启动虚拟环境时都必须设置上述环境变量，请创建一个. env文件。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="7055" class="mq lf it mm b gy mr ms l mt mu">FLASK_APP=path/to/your/app<br/>FLASK_DEBUG=1</span></pre><p id="62d3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要让Flask认识到这一点，首先需要安装<a class="ae kf" href="https://github.com/theskumar/python-dotenv#readme" rel="noopener ugc nofollow" target="_blank"> python-dotenv </a>包。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="13d1" class="mq lf it mm b gy mr ms l mt mu">pip install python-dotenv<br/>pip freeze &gt; requirements.txt</span></pre><p id="8dcb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在停用并重新激活您的虚拟环境。通常，您必须重置Flask环境变量。这一次，Flask会自动拾取它们。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="8477" class="mq lf it mm b gy mr ms l mt mu">flask run</span></pre></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="fad6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是你开始工作所需要的一切。现在，您可以开始构建更多的路线，并添加您的业务逻辑。我将在以后的文章中详细介绍。编码快乐！</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="b100" class="le lf it bd lg lh nf lj lk ll ng ln lo lp nh lr ls lt ni lv lw lx nj lz ma mb bi translated">资源</h1><ul class=""><li id="042c" class="nk nl it ki b kj mc kn md kr nm kv nn kz no ld np nq nr ns bi translated"><a class="ae kf" href="https://www.educba.com/django-vs-flask/" rel="noopener ugc nofollow" target="_blank">姜戈对弗拉斯克</a></li><li id="2374" class="nk nl it ki b kj nt kn nu kr nv kv nw kz nx ld np nq nr ns bi translated"><a class="ae kf" href="https://flask.palletsprojects.com/en/1.1.x/cli/" rel="noopener ugc nofollow" target="_blank">烧瓶命令行界面</a></li><li id="6e6e" class="nk nl it ki b kj nt kn nu kr nv kv nw kz nx ld np nq nr ns bi translated"><a class="ae kf" href="https://www.amazon.com/Flask-Web-Development-Developing-Applications/dp/1491991739/ref=sr_1_1?keywords=flask+development&amp;qid=1578943981&amp;sr=8-1" rel="noopener ugc nofollow" target="_blank">砂箱网开发</a>，作者<em class="ny">米格尔·格林伯格</em></li><li id="ceea" class="nk nl it ki b kj nt kn nu kr nv kv nw kz nx ld np nq nr ns bi translated"><a class="ae kf" href="https://www.fullstackpython.com/flask.html" rel="noopener ugc nofollow" target="_blank">全栈Python </a></li><li id="5469" class="nk nl it ki b kj nt kn nu kr nv kv nw kz nx ld np nq nr ns bi translated"><a class="ae kf" href="http://web.archive.org/web/20160305145017/http://jokull.calepin.co/my-flask-to-django-experience.html" rel="noopener ugc nofollow" target="_blank">我的烧瓶去姜戈体验</a></li></ul></div></div>    
</body>
</html>