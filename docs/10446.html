<html>
<head>
<title>Parsing JSON in C++ with RapidJSON</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用RapidJSON解析C++中的JSON</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/parsing-json-in-c-with-rapidjson-6d6d3e505e12?source=collection_archive---------1-----------------------#2021-12-07">https://levelup.gitconnected.com/parsing-json-in-c-with-rapidjson-6d6d3e505e12?source=collection_archive---------1-----------------------#2021-12-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0cc619bc7b6c134bc25583bab18bf7b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7qOTCCQ6D3NEsG9X"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">费伦茨·阿尔马西在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="c175" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今年早些时候，在做一些咨询工作时，我被要求用C++解析从一个URL下载的JSON文件。在大多数语言中，这是一个容易完成的任务，许多语言都有内置的库来处理JSON文件的读写(例如Python中的<em class="le"> json </em>包)。然而，在C++中，就像C++中的大多数东西一样，没有内置的功能来处理JSON文件或JSON格式的字符串。有一个流行的库<a class="ae kf" href="https://github.com/open-source-parsers/jsoncpp" rel="noopener ugc nofollow" target="_blank"/>，很多人都在使用它，但是我发现与另一个库<a class="ae kf" href="https://rapidjson.org/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="le"> RapidJSON </em> </a> <em class="le">，</em>相比，它实际上非常慢，当处理大型JSON文件时(例如，在JsonCpp中读取大约9年的OHLC股票数据需要大约20分钟，而使用RapidJSON只需要几秒钟)。</p><p id="ef04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管RapidJSON 的<a class="ae kf" href="https://rapidjson.org/md_doc_tutorial.html" rel="noopener ugc nofollow" target="_blank">文档非常好，但我认为看一个用C++处理JSON文件的编程示例会有所帮助。在这篇文章中，我将介绍一种将JSON文件(或字符串)读入RapidJSON文档对象的一般方法，并从我目前从事的项目中提供一个这样做的例子。</a></p><h1 id="019d" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">拉皮德森</h1><p id="a310" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">RapidJSON是一个专注于在C++中提供快速解析和生成JSON文件的库。该库可以通过两种方式包含在C++项目中:只包含头文件的实现可以复制到项目的源目录中，或者可以使用CMAKE来安装项目，然后可以通过<em class="le"> -lrapidjson与g++链接。</em>两种方法的结果都一样，只是项目的构建和库的包含会发生变化。更多信息可以在<a class="ae kf" href="https://github.com/Tencent/rapidjson/" rel="noopener ugc nofollow" target="_blank">项目的GitHub </a>上找到。</p><p id="a4b9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RapidJSON中的Document类以适当的结构保存JSON文件内容，这允许解析JSON数据。该类包括如下内容</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="abb3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这里开始，读取JSON文件的内容非常简单。下面的<em class="le"> JsonParser </em>类可用于通过<em class="le"> getJsonDocument(…) </em>函数解析JSON文件，该函数返回一个rapidjson::Document对象。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="9987" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将使用我目前正在从事的一个项目中的一个JSON文件作为例子。这是一个非常简单的JSON文件，没有数组，但是提供了一个基本的用法示例。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="7e0d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述JSON是用于流体动力学的格子Boltzmann解算器的一些参数。这可以通过扩展上面的JsonParser类来解析。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h1 id="a568" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">数组</h1><p id="0e3f" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">因为大多数JSON文件都有嵌套的数组结构，所以对JSON文件的另一个重要操作是迭代JSON数组。虽然我目前没有在我上面提到的项目中这样做(我很快会这样做)，但我已经在帖子前面提到的咨询项目中这样做了。下面是代码库中的一个片段，演示了RapidJSON中JSON数组的迭代。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="0423" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如上面的代码片段所示，RapidJSON文档对象有一个<em class="le"> GetArray() </em>方法，该方法将返回一个保存JSON数据的RapidJSON值对象。为了清楚起见，RapidJSON中所有解析的JSON都存储在一个值对象中。Document对象是一个表示DOM并保存DOM树的根值的对象。</p><h1 id="df6d" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="a31c" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">在这篇文章中，介绍了RapidJSON JSON解析API。展示并解释了一些示例用法，作为我参与的两个不同项目的代码片段。对于那些需要更深入了解RapidJSON的人来说，这个项目有一个非常有用的<a class="ae kf" href="https://github.com/Tencent/rapidjson/" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>和更多<a class="ae kf" href="https://rapidjson.org/index.html" rel="noopener ugc nofollow" target="_blank">有用的文档</a>。这篇文章的目的是向那些不知道这个项目存在的人(我想大多数人都坚持使用JsonCpp)介绍这个项目，并提供一些非常原始的用法，以便您可以开始使用这个项目。</p></div></div>    
</body>
</html>