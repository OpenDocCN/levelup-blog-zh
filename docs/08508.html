<html>
<head>
<title>One React Provider to Rule Them All</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个React提供者来管理它们</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/one-react-provider-to-rule-them-all-4aeb9db40c94?source=collection_archive---------5-----------------------#2021-05-07">https://levelup.gitconnected.com/one-react-provider-to-rule-them-all-4aeb9db40c94?source=collection_archive---------5-----------------------#2021-05-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1a78" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">集中React提供者以获得更好的维护和可读性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5b6d5c5d185b26a3f4effeb56f7dc8ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r6PT5Li4Qec1q3fp"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Alexey Topolyanskiy 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="d357" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="6de4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这篇文章将向您展示React应用程序中提供者的常见情况，以及如何使它更易于维护和阅读。</p><h1 id="40fb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">“问题”</h1><p id="62ac" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我在React应用中编写并看到过这样的代码:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="586c" class="ms la it mo b gy mt mu l mv mw">function App() {</span><span id="fdad" class="ms la it mo b gy mx mu l mv mw">//...</span><span id="7856" class="ms la it mo b gy mx mu l mv mw">return (<br/>    &lt;AuthProvider&gt;<br/>      &lt;ReduxProvider store={store}&gt;<br/>        &lt;ThemeProvider theme={theme}&gt;<br/>          &lt;IntlProvider locale={locale}&gt;<br/>            &lt;Router&gt;<br/>              &lt;Switch&gt;<br/>                &lt;Route path="/about"&gt;<br/>                    &lt;About /&gt;<br/>                &lt;/Route&gt;<br/>                &lt;Route path="/"&gt;<br/>                    &lt;Home /&gt;<br/>                &lt;/Route&gt;<br/>              &lt;/Switch&gt;<br/>            &lt;/Router&gt;<br/>          &lt;/IntlProvider&gt;<br/>        &lt;/ThemeProvider&gt;<br/>      &lt;/ReduxProvider&gt;<br/>    &lt;/AuthProvider&gt;<br/>  );<br/>}</span></pre><p id="0f55" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这本身没有什么错，但可以做得更好。例如，如果我们想要使用Storybook，我们可能应该这样做，那么很有可能许多React组件将需要一些(如果不是全部)这样的提供者。很可能是IntlProvider和ThemeProvider，甚至可能是ReduxProvider。此外，我们可能需要它们来进行React组件的单元测试。如果一些组件使用React钩子来访问React上下文，那么就保证需要一个提供者。</p><h1 id="ae07" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">如何让它变得更好</strong></h1><p id="6fb3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">因为React中的几乎所有东西都是一个组件，所以让我们创建一个新的组件来集中应用程序中的所有提供者。它看起来像这样:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="1131" class="ms la it mo b gy mt mu l mv mw">// file: AppProvider.tsx</span><span id="f33a" class="ms la it mo b gy mx mu l mv mw">const AppProvider = ({ children, store, theme, locale }) =&gt; {<br/>  return (<br/>    &lt;AuthProvider&gt;<br/>      &lt;ReduxProvider store={store}&gt;<br/>        &lt;ThemeProvider theme={theme}&gt;<br/>          &lt;IntlProvider locale={locale}&gt;<br/>            {children}<br/>          &lt;/IntlProvider&gt;<br/>        &lt;/ThemeProvider&gt;<br/>      &lt;/ReduxProvider&gt;<br/>    &lt;/AuthProvider&gt;<br/>  );<br/>};</span><span id="b5c8" class="ms la it mo b gy mx mu l mv mw">export default AppProvider;</span></pre><p id="cd84" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">然后使用它:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="efb0" class="ms la it mo b gy mt mu l mv mw">// file: App.tsx</span><span id="df8f" class="ms la it mo b gy mx mu l mv mw">import AppProvider from './AppProvider';</span><span id="f34a" class="ms la it mo b gy mx mu l mv mw">function App() {<br/>  <br/>  //...</span><span id="5df1" class="ms la it mo b gy mx mu l mv mw">  return (<br/>    &lt;AppProvider store={store} theme={theme} locale={locale}&gt;<br/>      &lt;Router&gt;<br/>        &lt;Switch&gt;<br/>          &lt;Route path="/about"&gt;<br/>            &lt;About /&gt;<br/>          &lt;/Route&gt;<br/>          &lt;Route path="/"&gt;<br/>            &lt;Home /&gt;<br/>          &lt;/Route&gt;<br/>        &lt;/Switch&gt;<br/>      &lt;/Router&gt;<br/>    &lt;/AppProvider&gt;<br/>  );<br/>}</span></pre><p id="ad42" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">AppProvider组件集中了应用程序的所有全局提供者。我想强调这一点；在这里，我们应该只包括对应用程序运行至关重要的提供商。通常，它们是关于本地化、主题化、全局状态管理、路由和认证的。</p><p id="31c8" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">AppProvider接受任何其他提供者所需的道具，允许我们针对不同的上下文以不同的方式设置提供者。</p><p id="9847" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">例如，如果我们需要Storybook中所有可用的提供者，我们可以这样做:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="01a7" class="ms la it mo b gy mt mu l mv mw">// file: SomeComponent.stories.js</span><span id="1a44" class="ms la it mo b gy mx mu l mv mw">export default {<br/>  component: SomeComponent,<br/>  decorators: [<br/>    (Story) =&gt; (<br/>      &lt;AppProvider store={store} theme={theme} locale={locale}&gt;<br/>        &lt;Story /&gt;<br/>      &lt;/AppProvider&gt;<br/>    ),<br/>  ],<br/>};</span></pre><p id="8ae1" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这种方法的优点是:</p><ul class=""><li id="2ece" class="nd ne it lt b lu my lx mz ma nf me ng mi nh mm ni nj nk nl bi translated">对于提供者来说，如果需要修改，只需在一个地方修改即可。这也有助于维护。</li><li id="352d" class="nd ne it lt b lu nm lx nn ma no me np mi nq mm ni nj nk nl bi translated">复用性</li><li id="ce11" class="nd ne it lt b lu nm lx nn ma no me np mi nq mm ni nj nk nl bi translated">更容易阅读。当我们浏览应用文件时，我们专注于重要的内容。当我们看到AppProvider组件时，我们发现它为应用程序提供了一些共享状态和功能。如果我们需要进一步挖掘，只需打开那个文件，只关注提供者。根据我的经验，像这样的可读性优化有助于避免阅读代码时不必要的脑力劳动。最有可能的是，代码库将会增长，可读性和简单性对于维护将会非常重要。</li></ul><h1 id="7a13" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">警告</h1><p id="e1df" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">作为专业人士，我们工作的很大一部分是利用我们的判断和经验做出好的决定。所以，我们必须练习。如果某些提供程序比解决方案更复杂，那么不要将其包含在AppProvider组件中。例如，故事书或测试中很可能不需要像AuthProvider这样的东西。也许最好不要把它包含在AppProvider里，保留在App文件里。这要根据具体情况来决定。</p><p id="671f" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">感谢您的阅读，我希望这对您有用。</p><p id="c0da" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">如果你有什么推荐或建议，请在评论中告诉我。</p><p id="49e5" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">干杯！</p></div></div>    
</body>
</html>