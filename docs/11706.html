<html>
<head>
<title>Django Rest Framework ViewSets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django Rest框架视图集</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/django-rest-framework-viewsets-2f3283dda518?source=collection_archive---------2-----------------------#2022-04-08">https://levelup.gitconnected.com/django-rest-framework-viewsets-2f3283dda518?source=collection_archive---------2-----------------------#2022-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="3b83" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Django中的视图集和路由器</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/9c9a78d7c171e9dc3b3d2dc94fb3b86f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rs2M0PdEW3He_0lOYydKBg.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@kimileee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> kimi lee </a>在<a class="ae le" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="a2b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Django REST framework是一个强大而灵活的工具包，可以轻松构建Web APIs。它提供了强大的功能，例如:</p><ul class=""><li id="e0fb" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">可浏览的API</li><li id="6bf5" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">证明</li><li id="1ecf" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">序列化程序</li><li id="6418" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">定制功能</li></ul><p id="417c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，我们将构建一个利用视图集和路由器的Django应用程序。</p><h2 id="aefd" class="lt lu it bd lv lw lx dn ly lz ma dp mb kb mc md me kf mf mg mh kj mi mj mk ml bi translated">项目设置</h2><p id="2986" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">创建一个目录并放入cd。</p><pre class="kp kq kr ks gt mr ms mt mu aw mv bi"><span id="b550" class="lt lu it ms b gy mw mx l my mz">mkdir DRF<br/>cd DRF</span></pre><p id="a525" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建一个虚拟环境。</p><pre class="kp kq kr ks gt mr ms mt mu aw mv bi"><span id="6b9b" class="lt lu it ms b gy mw mx l my mz">python3 -m venv env</span></pre><p id="4c08" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">激活虚拟环境并安装Django和Django rest框架</p><pre class="kp kq kr ks gt mr ms mt mu aw mv bi"><span id="0e3b" class="lt lu it ms b gy mw mx l my mz">source env/binactivate<br/>python3 -m pip install django djangorestframework</span></pre><p id="9c97" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建一个名为django_viewsets的新Django项目。在项目目录中，创建一个名为books的应用程序</p><pre class="kp kq kr ks gt mr ms mt mu aw mv bi"><span id="7fb4" class="lt lu it ms b gy mw mx l my mz">django-admin startproject django_viewsets<br/>cd django_viewsets</span><span id="3a08" class="lt lu it ms b gy na mx l my mz">django-admin startapp books</span></pre><p id="1c96" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将app books和rest_framework添加到settings.py文件的INSTALLED_APPS列表中。</p><pre class="kp kq kr ks gt mr ms mt mu aw mv bi"><span id="8872" class="lt lu it ms b gy mw mx l my mz">INSTALLED_APPS = [<br/></span><span id="e0b6" class="lt lu it ms b gy na mx l my mz">'books',</span><span id="4a61" class="lt lu it ms b gy na mx l my mz">'rest_framework',</span><span id="a96f" class="lt lu it ms b gy na mx l my mz">]</span></pre><h2 id="91f1" class="lt lu it bd lv lw lx dn ly lz ma dp mb kb mc md me kf mf mg mh kj mi mj mk ml bi translated">模型</h2><p id="7dde" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">为具有3个字段的数据库创建一个Book对象，即:</p><ul class=""><li id="8f8c" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">标题</li><li id="c913" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">作者</li><li id="982b" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">数据_已发布</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="d4f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为序列化程序将模型转换成json lets，所以在books app目录中创建一个serializers.py文件。序列化程序将采用与模型相同的名称。<br/>创建一个Bookserializer类来序列化模型。序列化程序类也将继承模型的属性。</p><pre class="kp kq kr ks gt mr ms mt mu aw mv bi"><span id="b8df" class="lt lu it ms b gy mw mx l my mz">from rest_framework import serializers</span><span id="b285" class="lt lu it ms b gy na mx l my mz">from .models import Book</span><span id="ab79" class="lt lu it ms b gy na mx l my mz">class BookSerializer(serializers.ModelSerializer):</span><span id="ff5c" class="lt lu it ms b gy na mx l my mz">    class Meta:</span><span id="e0b0" class="lt lu it ms b gy na mx l my mz">        model = Book</span><span id="7047" class="lt lu it ms b gy na mx l my mz">        fields = ['title','author','date_published']</span></pre><h2 id="905f" class="lt lu it bd lv lw lx dn ly lz ma dp mb kb mc md me kf mf mg mh kj mi mj mk ml bi translated">Django管理站点</h2><p id="6751" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">Django管理站点将允许我们添加一些测试数据。在<code class="fe nd ne nf ms b">admin.py</code>中，创建一个带有标题、作者和出版日期字段的<code class="fe nd ne nf ms b">BookAdmin</code>对象</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h2 id="34b4" class="lt lu it bd lv lw lx dn ly lz ma dp mb kb mc md me kf mf mg mh kj mi mj mk ml bi translated">视图集</h2><p id="cfbe" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">来自Django rest框架文档:</p><blockquote class="ng nh ni"><p id="3f9b" class="jq jr nj js b jt ju jv jw jx jy jz ka nk kc kd ke nl kg kh ki nm kk kl km kn im bi translated">一个<code class="fe nd ne nf ms b">ViewSet</code>类仅仅是<strong class="js iu">一种基于类的视图，它不提供任何方法处理程序</strong>如<code class="fe nd ne nf ms b">.get()</code>或<code class="fe nd ne nf ms b">.post()</code>，而是提供动作如<code class="fe nd ne nf ms b">.list()</code>和<code class="fe nd ne nf ms b">.create()</code>。</p></blockquote><p id="3dc4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有四种不同类型的视图集，即，</p><ul class=""><li id="6cff" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">视图集</li><li id="13fc" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">GenericViewSet</li><li id="2d37" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">模型视图集</li><li id="6e20" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">ReadOnlyModelViewSet</li></ul><p id="a2d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，这个视图集可以执行所有的CRUD操作。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="5632" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">动作处理程序对应于不同的HTTP方法:</p><ul class=""><li id="3e6f" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">列表-获取</li><li id="8b13" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">创建-发布</li><li id="b2dd" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">检索-获取特定的项目</li><li id="68c8" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">更新-发布特定项目</li><li id="8766" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">partial_update-修补特定项目</li><li id="da10" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">销毁—删除</li></ul><p id="9550" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">视图集类</strong> <br/>视图集类继承自APIView，默认不包含任何动作。例如</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="9231" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> GenericViewSet类</strong><br/>generic viewset类继承自generic piview，因此将继承generic piview的所有属性，如get_object、get_queryset方法等<br/>默认情况下不包含任何操作。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="1112" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">模型视图集类</strong> <br/>视图集类继承自GenericAPIView，包含动作即。list()，。检索()，。create()，。更新()和。销毁()。<br/>它还将serializer类和queryset作为属性</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="23e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> ReadOnlyModelViewSet类</strong><br/>ReadOnlyModelViewSet顾名思义只提供只读动作(。列表()和。检索()。).<br/>它继承自GenericAPIView，并将至少接受一个queryset和一个serializer类作为属性</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h2 id="86f0" class="lt lu it bd lv lw lx dn ly lz ma dp mb kb mc md me kf mf mg mh kj mi mj mk ml bi translated">视图</h2><p id="5892" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">让我们创建一个BookViewset，它将从ModelViewset继承并具有以下属性</p><ul class=""><li id="0682" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">序列化程序类</li><li id="40eb" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">一个查询集</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h2 id="ae3f" class="lt lu it bd lv lw lx dn ly lz ma dp mb kb mc md me kf mf mg mh kj mi mj mk ml bi translated">路由器</h2><p id="72f4" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">与我们必须自己设计url的视图类不同，Router类负责将资源连接到视图中，我们需要做的就是用一个路由器注册视图集。</p><pre class="kp kq kr ks gt mr ms mt mu aw mv bi"><span id="1c3c" class="lt lu it ms b gy mw mx l my mz">from django.urls import  path,include</span><span id="d9c8" class="lt lu it ms b gy na mx l my mz">from rest_framework import routers</span><span id="0d28" class="lt lu it ms b gy na mx l my mz">from .views import BookViewSet</span><span id="6e6c" class="lt lu it ms b gy na mx l my mz">router = routers.DefaultRouter()</span><span id="d680" class="lt lu it ms b gy na mx l my mz">router.register(r'books', BookViewSet)</span><span id="f09d" class="lt lu it ms b gy na mx l my mz">urlpatterns = [</span><span id="f24a" class="lt lu it ms b gy na mx l my mz">     path('', include(router.urls)),</span><span id="2f5f" class="lt lu it ms b gy na mx l my mz">]</span></pre><h2 id="e002" class="lt lu it bd lv lw lx dn ly lz ma dp mb kb mc md me kf mf mg mh kj mi mj mk ml bi translated">结论</h2><p id="bf1e" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">使用视图集可以最大限度地减少您需要编写的代码量，还可以让您专注于API的交互和表示。</p><p id="89d6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">享受在媒体上阅读的乐趣，<a class="ae le" href="https://essyking.medium.com/membership" rel="noopener">创建一个帐户</a>以获得全部访问权限。如果你喜欢读这篇文章，你可能会喜欢？</p><p id="1bf2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://python.plainenglish.io/an-introduction-to-django-rest-framework-class-based-views-ac2304285d29?source=your_stories_page----------------------------------------" rel="noopener ugc nofollow" target="_blank">https://python . plain English . io/an-introduction-to-django-rest-framework-class-based-views-AC 2304285 d29</a></p></div></div>    
</body>
</html>