<html>
<head>
<title>Why Mocks Are Considered Harmful</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么嘲笑被认为有害</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/why-mocks-are-considered-harmful-b4e8fe60478d?source=collection_archive---------2-----------------------#2022-05-11">https://levelup.gitconnected.com/why-mocks-are-considered-harmful-b4e8fe60478d?source=collection_archive---------2-----------------------#2022-05-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="cfc8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">软件开发过程中的自动化测试涉及到许多不同的技术，其中一个不应该使用的是mocking。嘲笑往好里说是分散注意力，往坏里说是提供虚假的自信。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/ce6ce81ed97469863cba7d6ce20e6c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*hkeUtjT4W3o-sp-bH5uJ2A.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">被认为有害的模仿</figcaption></figure><h1 id="8a7e" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">什么是嘲讽？</strong></h1><p id="df4f" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">软件开发人员通常使用mocks来模拟对其他服务的网络调用或数据库访问的代码行为。这使得单元测试可以同时运行:</p><ul class=""><li id="a658" class="md me it js b jt ju jx jy kb mf kf mg kj mh kn mi mj mk ml bi translated">快速，因为他们不需要依赖额外的服务。</li><li id="3895" class="md me it js b jt mm jx mn kb mo kf mp kj mq kn mi mj mk ml bi translated">稳定，因为它们避免了可用性问题。</li></ul><p id="90a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这意味着模拟通常用于有<strong class="js iu">副作用的代码，</strong>是依赖或修改其参数之外的东西的<strong class="js iu"> </strong>代码。这使我们可以将函数分类为:</p><ul class=""><li id="99e6" class="md me it js b jt ju jx jy kb mf kf mg kj mh kn mi mj mk ml bi translated"><strong class="js iu">纯粹:</strong>没有任何副作用的功能。</li><li id="aa97" class="md me it js b jt mm jx mn kb mo kf mp kj mq kn mi mj mk ml bi translated"><strong class="js iu">不纯:</strong>包含一个或多个副作用的函数。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/a6527f692f75a6e30232bb4ca105284c.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*jaTaBTPNdm_Eifc1ZDMx_g.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">纯函数与不纯函数</figcaption></figure><h1 id="9eeb" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">模仿的问题</h1><p id="4d6d" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated"><strong class="js iu">模拟并不等同于它们所取代的集成。<br/> </strong>如果你模仿一个数据库客户端，那么你还没有测试与真实客户端的集成。这意味着您的代码可以与mock一起工作，但您仍然需要进行集成测试，以确保它在没有mock的情况下也能工作。</p><p id="85cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">特性奇偶校验不可行。如果你做了一个快速模仿，那么它不会返回有用的数据。你花在改进模拟上的时间越多，数据就越有用。然而，它永远不可能是真实的表现。</strong></p><p id="916a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不使用的模仿是浪费时间和精力。如果你模仿了一个数据库客户端并且没有使用它，那么模仿它是没有意义的。如果某些代码需要有效的配置来初始化，但没有使用它，就会发生这种情况。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/e9725872c3e87e8cc827a221498659a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*3YwwXWQydKUNxnFnNj4g0g.png"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">模拟不等同于</figcaption></figure><h1 id="12e9" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">我们如何取代模仿？</h1><p id="44bf" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">模拟是用来提供速度和稳定性的，但我们可以用其他方式来管理它。</p><p id="dbdd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">重构你的代码！我们可以通过分离纯函数和不纯函数来取代对模拟的需求。纯函数可以在没有模拟的情况下进行单元测试，而不纯函数只能进行集成测试。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/d0605bb5e800201db9cb6556a0aaefb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*Qh-cx5m4LsLqpitbxSvBvg.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">代码重构示例</figcaption></figure><p id="8325" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">提高你的自动化水平！通过自动化软件打包、部署和测试，我们可以更快地关注集成测试，而不是依赖单元测试。这也使得连续交付成为可能，并且减少了“它在我的机器上工作”的影响，这在现代软件开发中是有益的。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi my"><img src="../Images/0382ffe833ccd6a6bc2e1e3b7bf75028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2LtaWncGRGX4oyHzl2MZw.png"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">自动化构建、部署和测试</figcaption></figure><h1 id="ace2" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">摘要</h1><p id="3daa" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">嘲笑是一个短期的解决方案，也是一个长期的问题。如果你想更快地交付软件，那么你应该花更少的时间在模拟上，花更多的时间在重构和自动化上。</p><p id="75ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想看更多这样的内容，请跟我来。</p><p id="24fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我知道你在推特<strong class="js iu">上的想法</strong>ben@torvo.com.au</p></div></div>    
</body>
</html>