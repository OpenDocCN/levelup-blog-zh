<html>
<head>
<title>How to Store Passwords in Django the Right Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何以正确的方式在Django中存储密码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-store-passwords-in-django-the-right-way-c572cb4f2eb1?source=collection_archive---------0-----------------------#2021-03-09">https://levelup.gitconnected.com/how-to-store-passwords-in-django-the-right-way-c572cb4f2eb1?source=collection_archive---------0-----------------------#2021-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e52b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不要硬编码你的密码！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e07331511f6b6c95d0ba5ddf09466a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRXB8Q_eYWYit9fWG2Nerg.png"/></div></div></figure><p id="00de" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你知道把你的密码写成代码是不好的。你推它。Python代码甚至没有编译，所以每个人都可以看到它。当您的机器和服务器上有不同的数据库连接时，这是不方便的。</p><p id="4357" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">解决方案:使用环境变量</p><p id="8783" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我将向您展示如何在不同的操作系统中保存这些变量，以及如何在Python中读取它们。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="14a6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当你把你的大作发布到云端，你设置了一个PostgreSQL服务器，然后地狱就开始了。也就是说，您需要将连接设置和密码保存到settings.py文件中。</p><p id="ed0c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后在机器上对这个文件进行修改，并再次推送。你为什么要这么做？当然，你忘了让DEBUG=False。你现在必须在服务器上合并文件。或者git隐藏更改，然后git拉，然后恢复数据库设置。不太好。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="4da0" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">环境变量</h2><p id="df7c" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">环境变量就像普通变量一样，但是它们存在于操作系统中。环境变量的一个例子是PATH。你设置一次，操作系统就用它来搜索你的可执行文件。</p><p id="42a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">问题是这些变量可以被应用程序访问。当然，如果你知道它的名字。</p><h2 id="af5b" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated"><strong class="ak">苹果操作系统</strong></h2><p id="3a6f" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">如果你有一台MAC，去控制台输入</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="1362" class="lx ly it mw b gy na nb l nc nd">nano ~/.bash_profile</span></pre><p id="d6ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每次您登录系统时，该文件都会运行。</p><p id="2057" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您应该会看到这样一个窗口:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/f66125b324d2397a85c46d0170e3275a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*hVSiytjbfiqPn3_gbxtgMw.png"/></div></figure><p id="0fd3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果不是，那就是出问题了。至少应该有些什么。如果您看到一个空屏幕，请检查文件名。</p><p id="07a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，转到文件的末尾，键入某个变量的密码，例如:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="9722" class="lx ly it mw b gy na nb l nc nd">export pgpassword="mysecretpasswordhere"</span></pre><p id="3b5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将是一个PostgreSQL密码。你可以随意命名。但是不要只输入“密码”:)</p><p id="b2a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，你需要重新启动。开玩笑的。只需运行该文件:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="85a8" class="lx ly it mw b gy na nb l nc nd">source ~/.bash_profile</span></pre><h2 id="8edb" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">人的本质</h2><p id="86ce" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">在Ubuntu中，您通常会部署您的应用程序，因此请确保不是为用户而是为系统(即所有用户)设置该变量。</p><p id="b7a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为此，请转到此文件夹:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="7f9a" class="lx ly it mw b gy na nb l nc nd">cd /etc/profile.d</span></pre><p id="0af2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在那里你会看到几个sh文件。在这里为你自己创建一个新文件，你最好不要使用任何现有的文件，因为它们可能会被管理并被一些更新所取代。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/28bb4e913d5d7c840739e6887d5fbf60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*SCIv9Dvqv6xRTnu-SpiPnw.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">我的数字海洋水滴中的/etc/profile.d文件</figcaption></figure><p id="015e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每当任何用户启动系统时，都会加载这些文件。甚至当你ssh到你的服务器。</p><h2 id="17fd" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">窗子</h2><p id="78ca" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">如果您使用Windows并需要设置环境变量，请访问此处:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/f9638d8207626f397fcaf6a1ae088bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/0*o8erFGRnp9RcFwoN.png"/></div></figure><p id="245f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者按Windows键，并在那里键入“环境”。它会让你快捷地进入控制面板中的“编辑环境变量”。</p><h2 id="8d5e" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">微软磁盘操作系统</h2><p id="b6e0" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">在MS-DOS中，每次你运行你的机器时，都会启动一个名为“autoexec.bat”的文件。设置变量的最简单方法是添加这样一行代码:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="ed57" class="lx ly it mw b gy na nb l nc nd">SET PGPASS="mypassword"</span></pre><p id="9ad9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这可以通过以下方式完成:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/9890e2c3def0681c642412ee9d6c5b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*wUPdkGBNit-SjYPEeMauYw.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">在MS-DOS中向autoexec.bat添加一行</figcaption></figure><p id="3311" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是请不要在Windows 3.11中运行Python。这将是极其缓慢的。而对于Django，则需要运行QEMM386，否则会出现内存不足的情况。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="effd" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">计算机编程语言</h2><p id="304d" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">现在，一旦变量被设置，你需要读取它们。</p><p id="f706" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就像这样简单:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="7c07" class="lx ly it mw b gy na nb l nc nd"><strong class="mw iu">import </strong>os<br/>print(os.environ[<strong class="mw iu">"pgpassword"</strong>])</span></pre><p id="08fa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在Django中，您可以像这样设置PostgreSQL连接:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="6e36" class="lx ly it mw b gy na nb l nc nd">DATABASES = {<br/>    <strong class="mw iu">'default'</strong>: {<br/>        <strong class="mw iu">'ENGINE'</strong>: <strong class="mw iu">'django.db.backends.postgresql_psycopg2'</strong>,<br/>        <strong class="mw iu">'NAME'</strong>: <strong class="mw iu">'yourapp'</strong>,<br/>        <strong class="mw iu">'USER'</strong>: <strong class="mw iu">'yourappuser'</strong>,<br/>        <strong class="mw iu">'PASSWORD'</strong>: os.environ[<strong class="mw iu">"pgpassword"</strong>],<br/>        <strong class="mw iu">'HOST'</strong>: <strong class="mw iu">'localhost'</strong>,<br/>        <strong class="mw iu">'PORT'</strong>: <strong class="mw iu">'5432'</strong>,<br/>    }<br/>}</span></pre></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="e027" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">python manage.py测试</h2><p id="a09b" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">当您尝试测试您的Django应用程序时，您会得到以下错误:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="07f6" class="lx ly it mw b gy na nb l nc nd">Creating test database for alias 'default'...</span><span id="4f23" class="lx ly it mw b gy nl nb l nc nd">Got an error creating the test database: permission denied to create database</span></pre><p id="636a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里最简单的解决方法是<strong class="kw iu"> <em class="nm">保留SQLite用于测试，PostgreSQL用于正常运行</em> </strong>。</p><p id="9628" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你应该这样做:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="9e95" class="lx ly it mw b gy na nb l nc nd">DATABASES = {<br/>    <strong class="mw iu">'default'</strong>: {<br/>        <strong class="mw iu">'ENGINE'</strong>: <strong class="mw iu">'django.db.backends.sqlite3'</strong>,<br/>        <strong class="mw iu">'NAME'</strong>: BASE_DIR / <strong class="mw iu">'db.sqlite3'</strong>,<br/>    }<br/>}<br/><strong class="mw iu">try</strong>:<br/>    <strong class="mw iu">if </strong>sys.argv[1:2] != [<strong class="mw iu">'test'</strong>]:<br/>        DATABASES = {<br/>            <strong class="mw iu">'default'</strong>: {<br/>                <strong class="mw iu">'ENGINE'</strong>: <strong class="mw iu">'django.db.backends.postgresql_psycopg2'</strong>,<br/>                <strong class="mw iu">'NAME'</strong>: <strong class="mw iu">'yourapp'</strong>,<br/>                <strong class="mw iu">'USER'</strong>: <strong class="mw iu">'yourappuser'</strong>,<br/>                <strong class="mw iu">'PASSWORD'</strong>: os.environ[<strong class="mw iu">"pgpassword"</strong>],<br/>                <strong class="mw iu">'HOST'</strong>: <strong class="mw iu">'localhost'</strong>,<br/>                <strong class="mw iu">'PORT'</strong>: <strong class="mw iu">'5432'</strong>,<br/>            }<br/>        }<br/><strong class="mw iu">except</strong>:<br/>    <strong class="mw iu">pass</strong></span></pre><p id="8aac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这样，即使您的朋友在另一台计算机上运行您的应用程序，系统变量也不存在，将使用SQLite。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="b82d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你的Django应用太慢，使用缓存:</p><div class="nn no gp gr np nq"><a rel="noopener  ugc nofollow" target="_blank" href="/a-simple-and-quick-way-to-cache-in-django-9bf217812a3b"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">Django中的缓存使您的应用程序在99%的情况下都很快</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">如何在Django中使用cache_page</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div><p id="43df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者在数据库中添加一些索引:</p><div class="nn no gp gr np nq"><a rel="noopener  ugc nofollow" target="_blank" href="/just-one-index-in-django-makes-your-app-15x-faster-742e2f13108e"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">Django中的一个索引就能让您的应用速度提高15倍！</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">你的应用有了索引会快多少？</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nz l"><div class="of l ob oc od nz oe ks nq"/></div></div></a></div><p id="46ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读！</p></div></div>    
</body>
</html>