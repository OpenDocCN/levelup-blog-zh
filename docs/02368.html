<html>
<head>
<title>Application Monitoring Using Spring Boot Admin (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Spring Boot管理监控应用程序(第2部分)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/application-monitoring-using-spring-boot-admin-part-2-ed14178c6964?source=collection_archive---------2-----------------------#2020-03-09">https://levelup.gitconnected.com/application-monitoring-using-spring-boot-admin-part-2-ed14178c6964?source=collection_archive---------2-----------------------#2020-03-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="05f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae kl" href="https://medium.com/@patelromil/application-monitoring-using-spring-boot-actuators-part-1-dab8576f4db6" rel="noopener">上一篇文章</a>中，我们已经创建了客户端应用程序，并探索了<a class="ae kl" href="https://medium.com/@patelromil/application-monitoring-using-spring-boot-actuators-part-1-dab8576f4db6" rel="noopener"> <strong class="jp ir"> Spring Boot执行器</strong> </a>，它们提供了很好的指标和内置端点来监控<strong class="jp ir">健康、API、环境、缓存管理、JVM进程、Tomcat &amp; JDBC连接、调度任务、线程等等。</strong></p><p id="a3cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将创建一个服务器应用程序，它将与客户机应用程序交互，从执行器获取信息，并提供随时可用的UI进行监控。让我们从使用<a class="ae kl" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank"> Spring初始化器</a>创建一个项目开始。</p><ul class=""><li id="e5b7" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated"><a class="ae kl" href="https://medium.com/@patelromil/application-monitoring-using-spring-boot-actuators-part-1-dab8576f4db6" rel="noopener"> <strong class="jp ir">应用监控使用Spring Boot执行器(第一部分)</strong> </a></li><li id="1ee7" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><strong class="jp ir">使用Spring Boot管理进行应用程序监控(第2部分)</strong></li><li id="61c6" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated"><a class="ae kl" href="https://medium.com/@patelromil/application-monitoring-with-prometheus-and-grafana-part-3-1c4ad5e1b042" rel="noopener"> <strong class="jp ir">应用监控使用Prometheus和Grafana(第三部分)</strong> </a></li></ul></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="04a9" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">服务器应用程序(Spring Boot管理)</h1><p id="b222" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们将使用以下依赖项来监控客户端应用程序，并在应用程序出现问题时发出警报通知。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="c043" class="mt li iq mp b gy mu mv l mw mx">&lt;properties&gt;<br/><strong class="mp ir">&lt;spring-boot-admin.version&gt;2.2.1&lt;/spring-boot-admin.version&gt;</strong>&lt;/properties&gt;</span><span id="2542" class="mt li iq mp b gy my mv l mw mx">&lt;dependency&gt;<br/>&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>&lt;artifactId&gt;<strong class="mp ir">spring-boot-starter-mail</strong>&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span><span id="e5a6" class="mt li iq mp b gy my mv l mw mx">&lt;dependency&gt;<br/>&lt;groupId&gt;de.codecentric&lt;/groupId&gt;<br/>&lt;artifactId&gt;<strong class="mp ir">spring-boot-admin-starter-server</strong>&lt;/artifactId&gt;&lt;/dependency&gt;</span></pre><p id="638c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们在<strong class="jp ir">应用程序.属性</strong>文件中添加配置属性</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="1f3e" class="mt li iq mp b gy mu mv l mw mx"><strong class="mp ir">server.port = 9090</strong><br/>spring.boot.admin.server.url = <a class="ae kl" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank">http://localhost:8080</a></span><span id="422e" class="mt li iq mp b gy my mv l mw mx"><strong class="mp ir">#Customize UI</strong><br/>spring.boot.admin.ui.title = Customized Title<br/>spring.boot.admin.ui.brand = Customized Brand</span><span id="8bdf" class="mt li iq mp b gy my mv l mw mx"><strong class="mp ir">#Mail Configuration for gmail</strong><br/>spring.mail.host = smtp.gmail.com<br/>spring.mail.port = 587<br/>spring.mail.username = email@gmail.com<br/>spring.mail.password = password #Generate Your APP Password<br/>spring.mail.properties.mail.smtp.auth = true<br/>spring.mail.properties.mail.smtp.starttls.enable = true</span><span id="efc3" class="mt li iq mp b gy my mv l mw mx"><strong class="mp ir">#SBA Mail Configuration</strong><br/>spring.boot.admin.notify.mail.enabled = true<br/>spring.boot.admin.notify.mail.from = email@gmail.com<br/>spring.boot.admin.notify.mail.to = emailTO@gmail.com</span></pre><p id="b0e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在将<code class="fe mz na nb mp b">@EnableAdminServer</code>添加到开始执行的主类中。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="3e91" class="mt li iq mp b gy mu mv l mw mx">@SpringBootApplication<br/><strong class="mp ir">@EnableAdminServer</strong><br/>public class <strong class="mp ir">ServerApplication </strong>{</span><span id="0aab" class="mt li iq mp b gy my mv l mw mx">public static void main(String[] args) {<br/>      SpringApplication.run(ServerApplication.class, args);<br/>    }<br/>}</span></pre><p id="58a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经准备好我们的Spring Boot管理应用程序，它将与客户端应用程序通信。它将使用致动器提供信息。我们为Gmail添加了<strong class="jp ir">spring-boot-starter-mail</strong>和<strong class="jp ir">配置的邮件属性</strong>，为<strong class="jp ir">Spring Boot管理添加了警报管理，以防应用程序关闭。</strong></p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="fbf0" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">客户端和服务器应用程序之间的通信</h2><p id="f0dd" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">为了使我们的Spring Boot管理服务器能够与客户端通信，我们必须在客户端应用程序上添加所需的配置。</p><p id="e473" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们向客户机应用程序的pom.xml添加以下依赖项。为了避免冲突和错误，请确保您为客户端和服务器使用相同版本的<strong class="jp ir">spring-boot-admin . version</strong>。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="17a2" class="mt li iq mp b gy mu mv l mw mx">&lt;properties&gt;<br/>   <strong class="mp ir">&lt;spring-boot-admin.version&gt;2.2.1&lt;/spring-boot-admin.version&gt;</strong><br/>&lt;/properties&gt;</span><span id="76d9" class="mt li iq mp b gy my mv l mw mx">&lt;dependency&gt;<br/>   &lt;groupId&gt;de.codecentric&lt;/groupId&gt;<br/>   &lt;artifactId&gt;<strong class="mp ir">spring-boot-admin-starter-client</strong>&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span></pre><p id="6d2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们将添加所需的配置属性</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="16b9" class="mt li iq mp b gy mu mv l mw mx"><strong class="mp ir">server.port = 8080</strong><br/>spring.application.name = Application Monitoring using Spring Boot</span><span id="e46c" class="mt li iq mp b gy my mv l mw mx"><strong class="mp ir">#SBA Client Configuration</strong><br/><strong class="mp ir">spring.boot.admin.api-path = /instances<br/>spring.boot.admin.client.url = </strong><a class="ae kl" href="http://localhost:9090" rel="noopener ugc nofollow" target="_blank"><strong class="mp ir">http://localhost:9090</strong></a></span><span id="a0b7" class="mt li iq mp b gy my mv l mw mx">#Datasource, JPA, Management and other properties</span></pre><h2 id="d9f9" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">准备出发！</h2><ul class=""><li id="e4cf" class="km kn iq jp b jq mf ju mg jy nn kc no kg np kk kr ks kt ku bi translated">启动将在端口9090上运行的服务器应用程序</li><li id="a264" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">启动将在端口8080上运行的客户端应用程序</li></ul><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nq"><img src="../Images/080d435f9f7efaffef9ddb457242a13a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K94iOwMr7Wy3NfmdhmwU7A.png"/></div></div></figure><p id="6d53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在控制台中，我们可以看到我们的客户端应用程序已经成功地向Spring Boot管理员注册为3a9aa6fe85fe。现在让我们对REST APIs进行一些修改来生成信息。</p><p id="b71a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们访问<code class="fe mz na nb mp b"><a class="ae kl" href="http://localhost:9090/applications" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://localhost:9090/applications</strong></a></code> <strong class="jp ir"> </strong>我们可以看到注册到服务器的应用程序数量及其状态</p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi ny"><img src="../Images/51395e24e7ed9549ad6035aeb03e7976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nkn4BCfs0eOq6O3CIgMSCw.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk translated"><code class="fe mz na nb mp b"><a class="ae kl" href="http://localhost:9090/applications" rel="noopener ugc nofollow" target="_blank">http://localhost:9090/applications</a></code></figcaption></figure><h2 id="421d" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">应用程序运行状况历史记录</h2><p id="f02e" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">要获取客户端应用程序的健康状态历史，请转到<strong class="jp ir">日志</strong>选项卡或访问<code class="fe mz na nb mp b"><a class="ae kl" href="http://localhost:9090/journal" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://localhost:9090/journal</strong></a></code></p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi od"><img src="../Images/55635bb9a3b738e6a36884b125cceab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BYMljpFujPJyjN7Vbn8eQ.png"/></div></div></figure><h2 id="7405" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">关于健康状态更改的通知</h2><p id="4e04" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">记住，我们已经使用starter-mail依赖项和邮件配置配置了警报通知，以便在客户端应用程序更改其健康状态时获取邮件。您将使用<code class="fe mz na nb mp b"><strong class="jp ir">spring.boot.admin.notify.mail.to</strong></code>在指定的电子邮件地址收到邮件</p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi oe"><img src="../Images/60f73f325e356756e40444e566e21a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zXPblt0Qsfxi5Cjfu8l3A.png"/></div></div></figure><h2 id="b73e" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">数据库状态、CPU进程、内存详细信息、图表</h2><p id="9dde" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">主页由进程、内存、线程、数据库健康状态、垃圾收集详细信息等组成。</p><p id="ef58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在侧边栏上，我们可以看到执行器提供的端点，这些端点可以在<code class="fe mz na nb mp b"><a class="ae kl" href="http://localhost:8080/actuato" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://localhost:8080/actuato</strong></a><strong class="jp ir">r.</strong></code> <strong class="jp ir"> </strong>上访问。更多细节请参考<strong class="jp ir"> </strong>到<strong class="jp ir"> </strong> <a class="ae kl" href="https://medium.com/@patelromil/application-monitoring-using-spring-boot-actuators-part-1-dab8576f4db6" rel="noopener"> <strong class="jp ir"> Spring Boot执行器(第一部分</strong> </a> <strong class="jp ir"> ) </strong>。</p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi of"><img src="../Images/20893a38638d57126d10451802fd2c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_pWTb0Sp9tehMGcBJXiQ9Q.png"/></div></div></figure><h2 id="cbdd" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">度量:REST APIs分析</h2><ul class=""><li id="5d32" class="km kn iq jp b jq mf ju mg jy nn kc no kg np kk kr ks kt ku bi translated">转到Metrics选项卡，从下拉列表中选择<strong class="jp ir">“http . server . requests”</strong></li><li id="e83a" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">选择<strong class="jp ir"> uri、方法、结果、状态和异常</strong></li><li id="27b4" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">添加公制，我们就可以了！</li></ul><p id="a4aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们用不同的方法创建了REST APIs，用适当的状态代码响应，其中一些会生成异常，所有这些都可以通过选择合适的选项使用指标来查看。</p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi og"><img src="../Images/a4feff769aa6c552300221cef628cd2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8NrVNNesYxESvm59SRQ8OQ.png"/></div></div></figure><p id="3749" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以在<strong class="jp ir"> Mappings </strong>选项卡中获得所有的映射和URL模式。您可能会看到REST APIs的端点，如<code class="fe mz na nb mp b">/users/**</code></p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi oh"><img src="../Images/9f250ba9c972ecdad9c032ce22bbbf79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tuo4eXeoocAUukyqhdCnOA.png"/></div></div></figure><h2 id="281d" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">虚拟机（Java Virtual Machine的缩写）</h2><p id="9232" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">JVM选项卡包括JMX、线程转储和堆转储，我们也可以下载同样的数据。</p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi oi"><img src="../Images/689e0e03628f0a75d844b0bb03a595fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IakKzZED6ieS4FzhC8rISQ.png"/></div></div></figure><h2 id="83d2" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">配置属性</h2><p id="97c9" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">使用该选项卡，我们可以获得应用程序的所有配置信息。</p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi oj"><img src="../Images/6ee97d606dddb4f2d5dbea639d8e0ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tEm4Wh7ga3xR69Lh4KDZTQ.png"/></div></div></figure><h2 id="b2ed" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">计划任务</h2><p id="2210" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们可能有预定的任务向用户发送通知，用于缓存管理，验证一些进程，等等。我们可以在这里看到我们的玉米类型、固定延迟和固定费率的预定任务。</p><figure class="mk ml mm mn gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi ok"><img src="../Images/831d05734e78b3a9f60374665e30bba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQ7aGQA32lpuEz2e0CCUZQ.png"/></div></div></figure></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="8abd" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">下一步是什么？普罗米修斯和格拉夫纳。</h2><p id="8463" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们还可以使用Spring Boot管理来管理<strong class="jp ir">记录器、缓存、bean</strong>和其他信息。如上所述，度量提供了关于数据库连接、JVM进程、Tomcat连接、光&amp; JDBC连接等的大量信息。在下一篇文章中，我将演示如何使用Prometheus和Grafana将这些信息转换成图形格式，以便更好地监控、分析和警告机制。</p><h2 id="0f36" class="mt li iq bd lj nc nd dn ln ne nf dp lr jy ng nh lv kc ni nj lz kg nk nl md nm bi translated">下载源代码:</h2><p id="935b" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/romilptl/spring-boot-actuator" rel="noopener ugc nofollow" target="_blank">客户端应用</a>，<a class="ae kl" href="https://github.com/romilptl/spring-boot-admin" rel="noopener ugc nofollow" target="_blank">服务器应用</a></p></div></div>    
</body>
</html>