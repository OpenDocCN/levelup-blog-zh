<html>
<head>
<title>Ensure File Integrity When Uploading a File to a Remote Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将文件上传到远程服务器时确保文件完整性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ensure-file-integrity-when-uploading-a-file-to-a-remote-server-552b7ccb1f3d?source=collection_archive---------15-----------------------#2022-03-08">https://levelup.gitconnected.com/ensure-file-integrity-when-uploading-a-file-to-a-remote-server-552b7ccb1f3d?source=collection_archive---------15-----------------------#2022-03-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="2b21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AWS S3用例——包含JavaScript、Python、Go、Java和Ruby示例</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c84a80d964bed468c12aa78ec0f2b470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v07BMkk_aftzeybIz5k2MA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">图片由<a class="ae le" href="https://pixabay.com/users/swidaalba-8022817/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3604825" rel="noopener ugc nofollow" target="_blank">冷</a>发自<a class="ae le" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3604825" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></figcaption></figure><p id="7e65" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你想上传一个文件到一个远程服务器，比如亚马逊S3，你想确保文件上传没有任何错误。</p><p id="3a32" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有一个简单的方法可以做到:</p><p id="5b87" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">提供文件内容的MD5摘要作为头<code class="fe lf lg lh li b">Content-MD5</code>的值。然后，AWS S3将获取文件内容，在将文件提交到S3桶之前，它将计算收到的内容的MD5摘要，并将它与<code class="fe lf lg lh li b">Content-MD5</code>头的值进行比较。如果它们不同，那么它将假设内容在到达服务器的途中被损坏，因此，实际上不会将它提交到bucket。它会返回一个错误，这样你就知道了。</p><h1 id="c1a3" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">将此用于任何文件上传</h1><p id="188e" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">您可以使用这种技术来检查上传到服务器的文件的完整性，对于其他情况也是如此。不仅仅是上传文件到亚马逊S3。</p><p id="0a46" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更重要的是，您可以从blog post中获得灵感，以便为任何将数据从一个地方移动到另一个地方的用例实现数据完整性解决方案。</p><h1 id="9979" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">内容MD5如何工作</h1><p id="eb43" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">下图说明了该标题如何对您有用，以及您需要采取哪些步骤来计算<code class="fe lf lg lh li b">Content-MD5</code>标题的正确值:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mm"><img src="../Images/e6c1645df1e0693b28efbf68efbe181d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fsbhqIdlypg1E7CCGr3A9Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">如何评估Content-MD5标头</figcaption></figure><p id="5a82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这篇博客文章主要关注为手头的文件计算正确的MD5值需要采取的两个步骤:</p><ol class=""><li id="181f" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated">MD5摘要</li><li id="41bb" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated">Base64编码</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nb"><img src="../Images/be4063dd41acba0122f3cfb449c528b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PYTENfoM3Lz-cCMLjMBaDw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">我们将重点关注的步骤</figcaption></figure><p id="fede" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将展示在您的编程语言中使用哪些正确的语句来计算MD5。由于我们实际上不知道哪一种是你的编程语言，我们将展示一些最流行的语句。</p><p id="4431" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是首先，…</p><h1 id="4959" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">我们的基线</h1><p id="495b" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">因为有很多方法可以计算一组字节的MD5，并将其转换为可以通过HTTP请求头作为值传输的东西，所以我们遵循<a class="ae le" href="https://aws.amazon.com/premiumsupport/knowledge-center/data-integrity-s3/" rel="noopener ugc nofollow" target="_blank"> Amazon建议</a>使用<code class="fe lf lg lh li b">openssl</code>和<code class="fe lf lg lh li b">base64</code>命令(在Linux和Mac上)来计算正确的值，如下所示:</p><pre class="kp kq kr ks gt nd li ne nf aw ng bi"><span id="6463" class="nh lk it li b gy ni nj l nk nl">$ openssl md5 -binary invoice.pdf | base64</span></pre><p id="b627" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中<code class="fe lf lg lh li b">invoice.pdf</code>是我们想要上传到S3的样本二进制文件。</p><p id="fd6d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上述shell调用的输出将为我们提供一个值，该值将用作我们的基线。我们接下来要编写的所有程序都必须为同一个输入文件(<code class="fe lf lg lh li b">invoice.pdf</code>)输出相同的值。如果是的话，他们是正确的。如果他们没有，他们就错了。</p><p id="1ea7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以上，当对我的<code class="fe lf lg lh li b">invoice.pdf</code>文件执行时，返回:<code class="fe lf lg lh li b">EV3WGikm7dyg2HFMqPoY3A==</code>。我希望下面所有的程序都为这个文件输出相同的值。</p><p id="e180" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们开始吧</p><h1 id="953e" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">JavaScript/Node.js</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="cf62" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">计算机编程语言</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="a216" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">去</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="16fa" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">Java 语言(一种计算机语言，尤用于创建网站)</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="dad5" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">红宝石</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="c0f4" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">AWS SDKs</h1><p id="afe0" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">到目前为止一切顺利。这些是一些很好的练习，展示了我们如何计算文件内容的MD5摘要的Base64表示。除了从教程的角度来看，它们有用吗？是的，他们是。当你不想使用官方提供的AWS SDK 作为你的编程语言时，你可能想回到上面描述的这些技术。</p><h1 id="97ec" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">结束语</h1><p id="b734" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">那是一篇快速提示型的博文。它展示了如何在上传文件到远程服务器时计算<code class="fe lf lg lh li b">Content-MD5</code>头的值，事实上，远程服务器是AWS S3。除了本文中描述的具体用例，您还可以获得灵感来实现网络数据完整性的解决方案。</p><p id="7e84" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一如既往，我从你身上学到的比你从我身上学到的要多得多。因此，我们非常欢迎您的评论。</p></div></div>    
</body>
</html>