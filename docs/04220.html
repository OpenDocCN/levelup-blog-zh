<html>
<head>
<title>Evading Detection While Scraping the Web</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">浏览网页时逃避检测</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/web-scraping-the-basics-of-evading-detection-5d49d5082a62?source=collection_archive---------14-----------------------#2020-06-15">https://levelup.gitconnected.com/web-scraping-the-basics-of-evading-detection-5d49d5082a62?source=collection_archive---------14-----------------------#2020-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4dc9e3d0d710b5d0564e41b20dcc143b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W2Aevy3Bv69CsZQ6"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">米哈伊尔·瓦西里耶夫在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9a17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我刚开始编码时，我写了第一个基本的网络抓取程序。它从静态维基百科页面收集信息，最大的挑战是理解HTML结构并将数据解析成可用的格式。我只需要写一个足够自动化的程序，比逐行逐表地复制粘贴数据更有效。对于我的业余项目来说，任何更多的东西都是多余的。</p><p id="69c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，当将web scraper扩展到商业规模时，有许多新的考虑要考虑，它需要以更高的频率和可靠性运行。问题不仅在于解析页面上的数据，还在于如何构建一个能够可靠运行而不被外部服务器检测到的应用程序。网站可以通过多种方式检测可疑流量并阻止可疑的抓取行为(以及其他安全问题)，也有多种方式阻止这些行为。本文介绍了这些方法。我不自称是这方面的专家，但我希望我的初学者视角，加上研究和最近的电子经验，意味着我可以更好地为其他初学者收集基本和必要的概念。</p><h1 id="7ca7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">HTTP标题</h1><p id="4c06" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">您向外部服务器发出的请求和响应都有包含接收方信息和指令的头。它们可以包含允许您访问某个页面的令牌，或者关于您希望返回的信息类型的信息。对于请求头，有些是必需的，有些是可选的，有些是自动添加的。</p><h2 id="2efa" class="me lc iq bd ld mf mg dn lh mh mi dp ll ko mj mk lp ks ml mm lt kw mn mo lx mp bi translated">用户代理</h2><p id="a926" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">每当你访问一个网页时，你的浏览器会自动添加一个<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent" rel="noopener ugc nofollow" target="_blank">用户代理头</a>，它会告诉服务器你是在移动还是桌面，或者是哪个浏览器和版本。这允许服务器发送为您的浏览器定制的正确版本的请求页面。当然没那么简单。这篇关于浏览器用户代理字符串的<a class="ae kc" href="https://webaim.org/blog/user-agent-string-history/" rel="noopener ugc nofollow" target="_blank">历史的博客文章是一个很好的、非常简短的、有趣的介绍，介绍了用户代理头已经成为的混乱的模仿背后的历史。</a></p><p id="a573" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您所想象的，服务器可以用来检测可疑活动的最基本的工具之一是调查传入请求的用户用户代理头。如果它发现突然涌入的请求都具有相同的用户代理头，就很容易阻止该IP地址。轮换IP地址是我下面要谈到的另一个重要工具。</p><p id="f5e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">user-agent头的好处(对我们来说)是，即使它通常是自动生成的，它也可以被覆盖，从而使我们所有的请求看起来像不相关的唯一用户。</p><h2 id="c4c9" class="me lc iq bd ld mf mg dn lh mh mi dp ll ko mj mk lp ks ml mm lt kw mn mo lx mp bi translated">接受语言</h2><p id="43f1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这告诉服务器它想要提供哪种语言的文本。如果服务器收到一大堆来自同一个IP地址的请求，或者有着相同的用户代理头，但是语言头不同，服务器就会得到提示。它不是第一道防线，但它是需要考虑的一种检测方法，需要与其他方法同步使用才能有效。</p><h2 id="320a" class="me lc iq bd ld mf mg dn lh mh mi dp ll ko mj mk lp ks ml mm lt kw mn mo lx mp bi translated">推荐人</h2><p id="341d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这告诉服务器你在访问之前来自哪个网站，这对于他们的广告和SEO来说是非常有用的信息。但是，如果我们用相同的referer发送一堆请求，即使我们有效地随机化了其他内容，服务器也可能检测到可疑的活动。解决这个问题的基本方法是随机化referer头。</p><h1 id="02f4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">IP地址；网络地址</h1><p id="58d0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">从HTTP头开始，你的IP地址是最基本的东西。浏览器很容易标记和拒绝来自同一个IP地址的大量请求。然而，有很多方法可以屏蔽你的IP地址。您的地址可能已经不固定了，这取决于您的ISP的工作方式。要轮换您的IP地址，有许多工具可用。有些是免费的，有些不是，有些是专门为web抓取而构建的。</p><p id="2905" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你在阅读我给出的监控或随机化重要标题的例子时所能想象的那样，这些策略中没有一个能解决你所有的问题，要使你的网页抓取器可靠，还需要考虑许多其他因素。但是如果你想自己建立一个，你需要知道从哪里开始，我希望我给了你一个好的开始。对于任何更有网络抓取经验的程序员，请让我知道任何重要的补充或更正。编码快乐！</p></div></div>    
</body>
</html>