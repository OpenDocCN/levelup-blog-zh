<html>
<head>
<title>.NET Tips: Get TimeZone Data on Different Platforms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">。NET提示:获取不同平台上的时区数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/net-tips-get-timezone-data-on-different-platforms-cff0e2b37f52?source=collection_archive---------6-----------------------#2021-04-04">https://levelup.gitconnected.com/net-tips-get-timezone-data-on-different-platforms-cff0e2b37f52?source=collection_archive---------6-----------------------#2021-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5a82faf05146799124218b527b3af04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-0flE3eH8xjDRDVhi8BP9Q.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://burst.shopify.com/@matthew_henry?utm_campaign=photo_credit&amp;utm_content=Free+Stock+Photo+of+Antique+Globe+Close+Up+%E2%80%94+HD+Images&amp;utm_medium=referral&amp;utm_source=credit" rel="noopener ugc nofollow" target="_blank">马太·亨利</a>发自<a class="ae kf" href="https://burst.shopify.com/travel?utm_campaign=photo_credit&amp;utm_content=Free+Stock+Photo+of+Antique+Globe+Close+Up+%E2%80%94+HD+Images&amp;utm_medium=referral&amp;utm_source=credit" rel="noopener ugc nofollow" target="_blank">突发</a></figcaption></figure><p id="ea9b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated"><span class="l lf lg lh bm li lj lk ll lm di">如果</span>你以前开发过跨平台的应用程序，你可能会遇到这样的情况:尽管使用了跨平台的解决方案，不同的平台仍然有不同的性能。这篇文章将讨论一种情况，在这种情况下，获取时区数据的结果在。网芯。</p><h1 id="a158" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">获取Windows平台上的时区数据</h1><p id="7861" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">首先，让我们创建一个新的。Windows平台上的NET Core控制台应用程序。既然这样，我就以新西兰时间为例。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="00bc" class="mz lo it mv b gy na nb l nc nd">using System;</span><span id="59e0" class="mz lo it mv b gy ne nb l nc nd">namespace DotNETTips<br/>{<br/>    class Program<br/>    {<br/>        static void Main(string[] args)<br/>        {<br/>            var dateTime = <strong class="mv iu">DateTime.UtcNow</strong>;<br/>            Console.WriteLine($"dateTime in UTC : {dateTime}");</span><span id="ad92" class="mz lo it mv b gy ne nb l nc nd">            var nzTzInfo = <strong class="mv iu">TimeZoneInfo.FindSystemTimeZoneById("New Zealand Standard Time");</strong><br/>            dateTime = TimeZoneInfo.ConvertTimeFromUtc(dateTime, nzTzInfo);</span><span id="4a36" class="mz lo it mv b gy ne nb l nc nd">            Console.WriteLine($"dateTime in NZ Time Zone : {dateTime}");<br/>            Console.ReadKey();<br/>        }<br/>    }<br/>}</span></pre><p id="97c2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，Windows平台上新西兰的时区id是“新西兰标准时间”，如下图截图所示。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/8e8d9355528c49459f41779155535156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOiR-QVRKaH5LDkDlPFrzg.png"/></div></div></figure><p id="21ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您对Windows平台上的时区数据感兴趣，可以在下面的链接中找到Windows上的默认时区列表。</p><div class="ng nh gp gr ni nj"><a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/default-time-zones?WT.mc_id=DT-MVP-5001664" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">默认时区</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">当第一个用户登录Windows 10或Windows Server并识别他们所在的地区时，Windows会设置时区。的…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">docs.microsoft.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jz nj"/></div></div></a></div><p id="9fbf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我们可以通过调用<strong class="ki iu"><em class="ny">FindSystemTimeZoneById</em></strong>方法得到新西兰的TimeZoneInfo数据。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="d9b3" class="mz lo it mv b gy na nb l nc nd">TimeZoneInfo.<strong class="mv iu">FindSystemTimeZoneById</strong>("<strong class="mv iu">New Zealand Standard Time</strong>");</span></pre><p id="09ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们可以将UTC格式的日期时间数据转换成NZDT。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="18e8" class="mz lo it mv b gy na nb l nc nd">TimeZoneInfo.<strong class="mv iu">ConvertTimeFromUtc</strong>(dateTime, nzTzInfo);</span></pre><p id="6d50" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">实际上，上面的代码在Windows平台上运行得很好，你可以发现日期时间在终端中被打印出来。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/5a0f59f976aceaeb9734ca07aaf7c22c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*Lxx6j0QkbEd-05SHGhvpjA.png"/></div></figure><h1 id="0b79" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">获取macOS/Linux上的时区数据</h1><p id="3beb" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">然而，如果你想在mac pro笔记本电脑或Linux电脑上运行相同的代码，它不会打印出新西兰时区的日期时间，而是打印出一个<strong class="ki iu">time zonenotfoundexception</strong>。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/d2ea1fb306fdc10f6f7d3b39af9b3725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6vxS456aMqmZgUcnXS8eA.png"/></div></div></figure><p id="0542" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这并不是因为你的mac pro没有安装时区数据，而是因为macOS使用了另一个时区数据提供商——IANA时区数据库。</p><p id="2283" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与Windows平台上的时区Id不同，新西兰的IANA时区标识符是“<strong class="ki iu"> <em class="ny">太平洋/奥克兰”</em> </strong>。并且也有您的时区列表，您可以单击下面的链接在时区数据库中查看时区列表。</p><div class="ng nh gp gr ni nj"><a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">tz数据库时区列表-维基百科</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">这是tz数据库2021a版的时区列表。UTC偏移量(第6列和第7列)在…以东为正</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">en.wikipedia.org</p></div></div><div class="ns l"><div class="ob l nu nv nw ns nx jz nj"/></div></div></a></div><p id="9035" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，要想让你的代码按预期运行，就得在macOS/Linux上把FindSystemTimeZoneById方法的参数从"<strong class="ki iu"> <em class="ny">新西兰标准时间</em> </strong>"修改为"<strong class="ki iu"> <em class="ny">太平洋/奥克兰"</em> </strong>。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/23659f125b597e713c370846712fd881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t2wbklwNZPSkn0fvCVJZwg.png"/></div></div></figure><p id="bc1f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正确的日期时间将会显示在控制台上。因此，如果你的应用程序将在不同的平台上运行，你将需要处理这些差异。</p><h1 id="4aa5" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">解决办法</h1><p id="7a11" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">但是，如果您不想自己处理这些差异，因为这很难维护，GitHub上有一个可用的开源包可以帮助您解决这个问题。</p><div class="ng nh gp gr ni nj"><a href="https://github.com/mattjohnsonpint/TimeZoneConverter" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">mattjohnsonpoint/时区转换器</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">TimeZoneConverter是一个轻量级的库，可以在IANA、Windows和Rails时区名称之间快速转换…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">github.com</p></div></div><div class="ns l"><div class="od l nu nv nw ns nx jz nj"/></div></div></a></div><p id="2dd9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">TimeZoneConverter是一个轻量级的库，可以在IANA、Windows和Rails时区名称之间快速转换。</p><p id="8946" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过NuGet非常容易地安装软件包。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oe"><img src="../Images/5c17dae0d6522bd1ddbd5b82c4714f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pTT9l4mXDpQcZp_xBMF54Q.png"/></div></div></figure><p id="1cb6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我在macOS上使用VS代码来安装这个NuGet包，然后我将FindSystemTimeZoneById修改为GetTimeZoneInfo，并将Windows上使用的相同时区标识符/id“新西兰标准时间”传递给该方法。代码在控制台中打印出正确的结果。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/aa23e39cefd5ab15d9b0cdf49a2e235a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NSjYoeMbVXW70JLPuZhJGA.png"/></div></div></figure><p id="8455" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这种方式，我们能够以统一的方式与不同的时区提供者一起工作，并且更容易维护我们的代码。</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="a203" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读，希望对您有所帮助。</p><p id="e5cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在聊天</p><div class="ng nh gp gr ni nj"><a href="https://www.linkedin.com/in/chenjd/" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">陈家东-高级软件开发人员-X公司| LinkedIn</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">起亚·奥拉，我是个有经验的人。NET/Unity/Azure Developer @ Company-X而我是2015年10月起的微软MVP。之前…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">www.linkedin.com</p></div></div><div class="ns l"><div class="on l nu nv nw ns nx jz nj"/></div></div></a></div></div></div>    
</body>
</html>