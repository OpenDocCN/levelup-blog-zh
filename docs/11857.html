<html>
<head>
<title>Unit testing in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中的单元测试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/unit-testing-in-react-7301989565f2?source=collection_archive---------3-----------------------#2022-04-24">https://levelup.gitconnected.com/unit-testing-in-react-7301989565f2?source=collection_archive---------3-----------------------#2022-04-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8778" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">react中的单元测试</em></p><p id="b379" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">此处:</em><a class="ae kp" href="https://flatteredwithflutter.com/unit-testing-in-react/" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://flatteredwithflutter.com/unit-testing-in-react/</em></a></p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="kv kw l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">React中的单元测试</figcaption></figure><p id="a9e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将简要介绍:</p><ol class=""><li id="a686" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn lg lh li lj bi translated">为组件编写单元测试</li><li id="a36e" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">用Jest进行快照测试</li></ol><blockquote class="lp lq lr"><p id="31bc" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated"><em class="it">注:本文假设读者了解React </em></p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lv"><img src="../Images/0cabbbc380f24747571371e7195520ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmzJmXGl-KQLbwE22_9a5w.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">React中的单元测试</figcaption></figure><h1 id="8901" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">关于单元测试</h1><p id="e731" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">单元测试是一种孤立地测试单个软件单元的测试方法。这包括验证给定<em class="ko">输入</em>的功能或组件的<em class="ko">输出</em>。</p><p id="85b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就React组件而言，这意味着检查组件</p><ul class=""><li id="1c25" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">按照指定道具的预期进行渲染。</li></ul><p id="2e6e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">主要目标是编写测试来验证我们的组件是否按预期工作。</p><div class="ng nh gp gr ni nj"><a href="https://youtube.com/shorts/4edYJZkmqs0?feature=share" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">使用Jest在React中进行单元测试🤩👨‍💻# react js # react # shorts # programming @ aseem wangoo</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">我们将利用jest对我们的react组件进行单元测试。Jest是一个JavaScript测试框架，旨在…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">youtube.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ma nj"/></div></div></a></div><h2 id="2131" class="ny md it bd me nz oa dn mi ob oc dp mm kb od oe mq kf of og mu kj oh oi my oj bi translated">笑话介绍</h2><p id="3a5f" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">我们将利用<a class="ae kp" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> jest </a>来测试我们的react组件。根据文件</p><blockquote class="lp lq lr"><p id="76ec" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">Jest是一个JavaScript测试框架，旨在确保任何JavaScript代码库的正确性。它允许你用一个平易近人的、熟悉的、功能丰富的API来编写测试，并快速给出结果。</p></blockquote><p id="a063" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看如何安装它</p><ul class=""><li id="0e5f" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">安装以下开发依赖项</li></ul><pre class="kq kr ks kt gt ok ol om on aw oo bi"><span id="6126" class="ny md it ol b gy op oq l or os">npm i --save-dev @testing-library/react react-test-renderer</span></pre><blockquote class="lp lq lr"><p id="4546" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">注意:确保您的<code class="fe ot ou ov ol b">react</code>和<code class="fe ot ou ov ol b">react-test-renderer</code>使用相同的版本</p></blockquote><h2 id="21ca" class="ny md it bd me nz oa dn mi ob oc dp mm kb od oe mq kf of og mu kj oh oi my oj bi translated">为组件编写单元测试</h2><p id="d24a" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">我们将从创建一个简单的文本组件开始，如下所示</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi ow"><img src="../Images/73624c2777507b7b7d8f93eba8df5e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m4j4_6bdvWhoOevKV4wtTg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">简单文本组件</figcaption></figure><p id="932a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它接受一个参数<code class="fe ot ou ov ol b">text</code>，并使用<code class="fe ot ou ov ol b">h3</code>样式标签显示在屏幕上。</p><blockquote class="lp lq lr"><p id="6353" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">记下<strong class="js iu">数据测试id。</strong>这将用于测试该组件</p></blockquote><p id="3c67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们测试这个组件，</p><ul class=""><li id="a8f0" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">我们创建了一个名为<code class="fe ot ou ov ol b">__tests__</code>的文件夹，它位于<code class="fe ot ou ov ol b">components</code>文件夹中。在其中，我们创建特定于组件的文件夹</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/d8cfebb4cbe04fc726ffffc59a048820.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*EX_1LanSBv46PnJajCH9_Q.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">文件夹结构</figcaption></figure><p id="6825" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们在<code class="fe ot ou ov ol b">components</code>下有所有的组件，在<code class="fe ot ou ov ol b">__tests__</code>下有所有的测试，这样我们可以为每个组件创建子文件夹。</p><p id="783f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例:对于<code class="fe ot ou ov ol b">components/Text</code>，我们在<code class="fe ot ou ov ol b">components/__tests__/Text</code>文件夹下有相应的测试</p><ul class=""><li id="c08d" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">所有的测试都应该包含惯例<code class="fe ot ou ov ol b">&lt;TestName&gt;.test.js</code>这有助于jest理解测试文件</li></ul><p id="ec25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以我们的测试文件应该是<code class="fe ot ou ov ol b">Text.test.js</code></p><ul class=""><li id="7773" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">接下来，我们将包<code class="fe ot ou ov ol b"><em class="ko">testing-library/react</em></code> <em class="ko"> </em>和jest一起导入为</li></ul><pre class="kq kr ks kt gt ok ol om on aw oo bi"><span id="c678" class="ny md it ol b gy op oq l or os">import { render, screen, cleanup } from "@testing-library/react";<br/>import Text from "../../Text/Text";<br/>import "@testing-library/jest-dom";</span></pre><blockquote class="lp lq lr"><p id="405f" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">注意:我们还需要导入我们想要测试的组件。在我们的例子中，它是<code class="fe ot ou ov ol b">Text</code></p></blockquote><ul class=""><li id="1af3" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">这是我们测试的样子</li></ul><pre class="kq kr ks kt gt ok ol om on aw oo bi"><span id="fd25" class="ny md it ol b gy op oq l or os">test("should render text component", () =&gt; {<br/>  render(&lt;Text /&gt;);</span><span id="6e24" class="ny md it ol b gy oy oq l or os">  var textElem = screen.getByTestId("text");</span><span id="928d" class="ny md it ol b gy oy oq l or os">  expect(textElem).toBeInTheDocument();<br/>});</span></pre><p id="5123" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> test </strong>:这将创建一个测试闭包，并接受par <em class="ko"> am </em> <code class="fe ot ou ov ol b">name</code>(您的测试的名称)和param <code class="fe ot ou ov ol b">fn</code>(您的测试的函数)</p><p id="d195" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">呈现</strong>:这来自于它呈现到一个容器中的<code class="fe ot ou ov ol b"><em class="ko">testing-library/react</em></code>，该容器被附加到文档体中。</p><blockquote class="lp lq lr"><p id="f0b5" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">在我们的例子中，我们呈现了<code class="fe ot ou ov ol b">Text</code>组件</p></blockquote><p id="f34f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> screen </strong>:这可以被认为是一个<code class="fe ot ou ov ol b">document.body</code>，它包含了绑定到您在之前调用中呈现的组件的每个查询</p><blockquote class="lp lq lr"><p id="9744" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">我们将一个<strong class="js iu">数据测试id </strong>分配给我们的文本组件，并尝试使用<a class="ae kp" href="https://testing-library.com/docs/queries/bytestid/" rel="noopener ugc nofollow" target="_blank"> getByTestId </a>来获得它</p></blockquote><p id="e31f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们使用<code class="fe ot ou ov ol b">expect</code>和<code class="fe ot ou ov ol b">toBeInTheDocument</code>来测试元素是否存在于呈现的文档中。</p><p id="2d45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ot ou ov ol b"><a class="ae kp" href="https://testing-library.com/docs/ecosystem-jest-dom" rel="noopener ugc nofollow" target="_blank">jest-dom</a></code>实用程序库提供了<code class="fe ot ou ov ol b">.toBeInTheDocument()</code>匹配器，可以用来断言一个元素是否在文档的主体中。</p><ul class=""><li id="5aec" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">使用运行测试</li></ul><pre class="kq kr ks kt gt ok ol om on aw oo bi"><span id="21e4" class="ny md it ol b gy op oq l or os">npm test</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi oz"><img src="../Images/f8b15ae5908c97f9a6fe5c8566847217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeMq8iA5SIWoriit8pSmVw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">单元测试的结果</figcaption></figure><p id="0f30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">并且，我们编写了我们的第一个测试🎉🎉🎉</p></div><div class="ab cl pa pb hx pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="im in io ip iq"><h1 id="21e0" class="mc md it bd me mf ph mh mi mj pi ml mm mn pj mp mq mr pk mt mu mv pl mx my mz bi translated">用Jest进行快照测试</h1><p id="6a54" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">当你想确保你的用户界面不会发生意外变化时，快照测试是一个非常有用的工具。</p><p id="9439" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">任何快照测试用例都会呈现一个UI组件，获取一个快照，然后将其与测试旁边存储的参考快照文件进行比较。如果两个快照不匹配，测试将失败:要么是意外的更改，要么是引用快照需要根据UI组件的新版本进行更新。</p><p id="71d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们测试一下我们的<code class="fe ot ou ov ol b">Text</code>组件。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi pm"><img src="../Images/c77b8c61f62d689ade37805b3539ec38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I5lep5PgozgmaUq7efYmng.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">用Jest进行快照测试</figcaption></figure><ul class=""><li id="806e" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">我们将使用我们在上一步中安装的<code class="fe ot ou ov ol b"><em class="ko">react-test-renderer</em></code> <em class="ko"> </em>库。</li></ul><p id="d4c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以使用测试渲染器为React树快速生成一个可序列化的值，而不是渲染图形用户界面，这需要构建整个应用程序。</p><ul class=""><li id="5731" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">我们使用<code class="fe ot ou ov ol b">renderer</code>来创建<code class="fe ot ou ov ol b">Text</code>组件</li><li id="d747" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn nf lh li lj bi translated">接下来，我们使用<code class="fe ot ou ov ol b">toJSON</code>将响应保存在JSON中</li><li id="a1ed" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn nf lh li lj bi translated">最后，我们使用<code class="fe ot ou ov ol b">expect</code>来比较使用<code class="fe ot ou ov ol b"><a class="ae kp" href="http://This ensures that a value matches the most recent snapshot" rel="noopener ugc nofollow" target="_blank">toMatchSnapshot</a> </code>的结果，这确保了值匹配最近的快照。</li><li id="99d5" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn nf lh li lj bi translated">使用运行测试</li></ul><pre class="kq kr ks kt gt ok ol om on aw oo bi"><span id="99c1" class="ny md it ol b gy op oq l or os">npm test</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi pn"><img src="../Images/643d0a6b9c78add441dd25889f527fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYLwJo4g0AAoojYNm1wh3w.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">React中的快照测试</figcaption></figure><blockquote class="lp lq lr"><p id="38ab" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">注意:第一次运行快照测试时，不会出现任何快照。控制台将告诉生成快照</p></blockquote><ul class=""><li id="2a3b" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn nf lh li lj bi translated">快照在<code class="fe ot ou ov ol b">__snapshots__</code>文件夹中生成，如下所示</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi po"><img src="../Images/7cc2e4e18e299c7c70adc83f45c48c76.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*AmK8noXVKTy8hDuhdlww-Q.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">生成的快照</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/1403fcba8a129bf2738640e90fe4b786.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*Upet1UQhVx6bs6WU.gif"/></div></figure><pre class="kq kr ks kt gt ok ol om on aw oo bi"><span id="4246" class="ny md it ol b gy op oq l or os"><em class="ko">Hosted URL: </em><a class="ae kp" href="https://funwithreact.web.app/" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://funwithreact.web.app/</em></a></span><span id="32d4" class="ny md it ol b gy oy oq l or os"><a class="ae kp" href="https://github.com/AseemWangoo/expriments_with_react" rel="noopener ugc nofollow" target="_blank"><em class="ko">Source code</em></a></span></pre></div></div>    
</body>
</html>