<html>
<head>
<title>Building a Full-Text Search App Using Django, Docker and Elasticsearch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Djangoã€Dockerå’ŒElasticsearchæ„å»ºå…¨æ–‡æœç´¢åº”ç”¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/building-a-full-text-search-app-using-django-docker-and-elasticsearch-d1bc18504ca4?source=collection_archive---------2-----------------------#2020-08-20">https://levelup.gitconnected.com/building-a-full-text-search-app-using-django-docker-and-elasticsearch-d1bc18504ca4?source=collection_archive---------2-----------------------#2020-08-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/42721c8384e9ce91a7814c88c54bddab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o1IdV4OjRw5T-t2M7EI7og.png"/></div></div></figure><p id="8048" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šç»™ä½ ä¸€äº›å…³äºElasticsearchçš„ç®€å•ä¿¡æ¯ï¼Œå®ƒçš„å®‰è£…ï¼Œä»¥åŠä¸€äº›ä½¿ç”¨çš„ä¾‹å­ã€‚</p><h1 id="c084" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">å¼¹æ€§æœç´¢â€”åŸºæœ¬æ¦‚å¿µ</h1><blockquote class="lu lv lw"><p id="202b" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated">Elasticsearchæ˜¯ä¸€ä¸ªå®æ—¶åˆ†å¸ƒå¼å¼€æºå…¨æ–‡æœç´¢å’Œåˆ†æå¼•æ“ã€‚å®ƒå¯ä»¥ä»RESTful webæœåŠ¡æ¥å£è®¿é—®ï¼Œå¹¶ä½¿ç”¨æ— æ¨¡å¼JSON (JavaScriptå¯¹è±¡ç¬¦å·)æ–‡æ¡£æ¥å­˜å‚¨æ•°æ®ã€‚å®ƒå»ºç«‹åœ¨Javaç¼–ç¨‹è¯­è¨€ä¹‹ä¸Šï¼Œè¿™ä½¿å¾—Elasticsearchå¯ä»¥åœ¨ä¸åŒçš„å¹³å°ä¸Šè¿è¡Œã€‚å®ƒä½¿ç”¨æˆ·èƒ½å¤Ÿä»¥éå¸¸é«˜çš„é€Ÿåº¦æ¢ç´¢å¤§é‡çš„æ•°æ®ã€‚</p></blockquote><p id="7852" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æœ‰ä¸€äº›å¼¹æ€§æœç´¢çš„åŸºç¡€ï¼Œä¸€æ—¦ä½ æŠŠå®ƒä»¬å†…åŒ–äº†ï¼Œå°±èƒ½å‡å°‘å­¦ä¹ æ›²çº¿çš„åˆ›ä¼¤ã€‚æˆ‘æ€»ç»“äº†4ä¸ªæœ€é‡è¦çš„æ¦‚å¿µ:</p><ol class=""><li id="6d14" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated"><strong class="ka ir">å­—æ®µ:</strong>å¼¹æ€§æœç´¢ä¸­æ•°æ®çš„æœ€å°ä¸ªä½“å•ä½ã€‚æ¯ä¸ªå­—æ®µéƒ½æœ‰å®šä¹‰çš„æ•°æ®ç±»å‹ï¼›æ ¸å¿ƒæ•°æ®ç±»å‹(å­—ç¬¦ä¸²ã€æ•°å­—ã€æ—¥æœŸã€å¸ƒå°”å€¼)æˆ–å¤æ‚æ•°æ®ç±»å‹(å¯¹è±¡å’ŒåµŒå¥—)ã€‚</li><li id="c64b" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">ç´¢å¼•:</strong>ä¸åŒç±»å‹æ–‡æ¡£å’Œæ–‡æ¡£å±æ€§çš„é›†åˆã€‚å®ƒå¯ä»¥æ¯”ä½œå…³ç³»æ•°æ®åº“ä¸–ç•Œä¸­çš„ä¸€ä¸ªæ•°æ®åº“ã€‚</li><li id="3aa4" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">æ–‡æ¡£:</strong>ä»¥ç‰¹å®šæ–¹å¼åœ¨JSONæ ¼å¼ä¸­å®šä¹‰çš„å­—æ®µé›†åˆã€‚æ¯ä¸ªæ–‡æ¡£éƒ½å±äºä¸€ç§ç±»å‹ï¼Œå¹¶é©»ç•™åœ¨ç´¢å¼•ä¸­ã€‚åœ¨å…³ç³»æ•°æ®åº“çš„ä¸–ç•Œä¸­ï¼Œæ–‡æ¡£å¯ä»¥æ¯”ä½œè¡¨ä¸­çš„ä¸€è¡Œã€‚</li><li id="a8d4" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">æ˜ å°„:</strong>å…±äº«åŒä¸€ç´¢å¼•ä¸­ä¸€ç»„å…¬å…±å­—æ®µçš„æ–‡æ¡£é›†åˆã€‚åŒæ ·ï¼Œå®ƒå°±åƒå…³ç³»æ•°æ®åº“ä¸–ç•Œä¸­çš„ä¸€ä¸ªæ¨¡å¼ã€‚</li></ol><p id="610a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">âš ï¸:å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒElasticsearchä¸èƒ½ç”¨ä½œæ•°æ®åº“ï¼Œå®ƒä¸æ˜¯ä¸ºæ­¤ç›®çš„è€Œå»ºç«‹çš„ã€‚å› æ­¤ï¼Œæœ€å¥½æ˜¯åœ¨é¡¹ç›®ä¸­å°†å…¶ä½œä¸ºPostgreSQLã€MySQLæˆ–å…¶ä»–æ•°æ®åº“æ—è¾¹çš„é™„åŠ æœåŠ¡ã€‚</p><h1 id="dfc9" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">ä½¿ç”¨Djangoçš„Elasticsearch</h1><p id="84bc" class="pw-post-body-paragraph jy jz iq ka b kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv ij bi translated">å¾ˆå¤šæ•™ç¨‹éƒ½åœ¨ä½¿ç”¨<a class="ae mu" href="https://django-haystack.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> Django-Haystack </a>ï¼Œè¿™ä¸ªåœ¨Djangoç¤¾åŒºä½¿ç”¨éå¸¸å¹¿æ³›çš„å·¥å…·ï¼Œä½œä¸ºä¸€ä¸ªæ¨¡å—åŒ–çš„æœç´¢æ¥æ’å…¥ElasticSearch(æˆ–è€…å…¶ä»–ä»»ä½•æœç´¢å¼•æ“æ¯”å¦‚Solrï¼ŒWhooshï¼ŒXapianç­‰ã€‚)ï¼Œå› ä¸ºå®ƒçš„æœ€å°é…ç½®å’ŒæŸ¥è¯¢è¯­æ³•ç±»ä¼¼äºDjangoçš„ORMã€‚</p><p id="450b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘æœ€è¿‘åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨äº†å®ƒå’ŒSolrï¼Œæˆ‘å¯¹å®ƒçš„ç®€å•å®ç°å°è±¡æ·±åˆ»ï¼Œæˆ‘å–œæ¬¢å®ƒï¼Œä½†æˆ‘ä¸ä¼šåœ¨æœ¬æ–‡ä¸­ä½¿ç”¨å®ƒï¼Œæˆ‘è®¤ä¸ºElasticsearchæœ¬èº«å¾ˆå®¹æ˜“ä½¿ç”¨ã€‚</p><p id="4848" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘å°†ä½¿ç”¨Dockeræ¥è¿è¡ŒElasticsearchã€‚</p><p id="f5a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸‹é¢æ˜¯æºä»£ç ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆ:</p><div class="mv mw gp gr mx my"><a href="https://github.com/aymaneMx/django-elasticsearch" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd ir gy z fp nd fr fs ne fu fw ip bi translated">aymaneMx/django-elasticsearch</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">ç”¨Djangoæµ‹è¯•Elasticsearchçš„ç®€å•é¡¹ç›®ï¼ŒåŸºäºdockeræ„å»ºã€‚</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm jw my"/></div></div></a></div><figure class="no np nq nr gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/9838c5ec3b524827c1eac92c4cecfd0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/1*DDOQkN585MAvdWoBnafEYw.gif"/></div></figure></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="c734" class="kw kx iq bd ky kz nz lb lc ld oa lf lg lh ob lj lk ll oc ln lo lp od lr ls lt bi translated">å¼¹æ€§æœç´¢å®ä¾‹</h1><p id="8c46" class="pw-post-body-paragraph jy jz iq ka b kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv ij bi translated">åœ¨é¡¹ç›®ç›®å½•ä¸­ç¼–è¾‘<code class="fe oe of og oh b">docker-compose.yml</code>ä»¥æ·»åŠ ä¸€ä¸ªESæœåŠ¡:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="86f0" class="om kx iq oh b gy on oo l op oq">es:<br/>    image: elasticsearch:7.8.1<br/>    environment:<br/>      - discovery.type=single-node<br/>    ports:<br/>      - "9200:9200"</span></pre><p id="4729" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åå°†<code class="fe oe of og oh b">es</code>æ·»åŠ åˆ°Django app serviceæ‰€ä¾èµ–çš„æœåŠ¡ä¸­ï¼Œå°†<code class="fe oe of og oh b">ELASTICSEARCH_DSL_HOSTS=es:9200</code>æ·»åŠ åˆ°<code class="fe oe of og oh b">docker-compose.env</code>:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="1cd8" class="om kx iq oh b gy on oo l op oq">web:<br/>    build: .<br/>    command: python /code/manage.py runserver 0.0.0.0:8000<br/>    volumes:<br/>      - .:/code<br/>    ports:<br/>      - 8000:8000<br/>    env_file:<br/>      - docker-compose.env<br/>    depends_on:<br/>      - db<br/>      - es    &lt;--- here</span></pre><p id="19c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨è¿è¡Œ<code class="fe oe of og oh b">docker-compose up -d --build</code></p><p id="f220" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‚¨å¯ä»¥é€šè¿‡curlæ£€æŸ¥å®ƒæ˜¯å¦æ­£å¸¸å·¥ä½œ:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="1949" class="om kx iq oh b gy on oo l op oq">curl -X GET localhost:9200/_cluster/health</span></pre><h1 id="af20" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">è®¾ç½®å¼¹æ€§æœç´¢</h1><p id="452b" class="pw-post-body-paragraph jy jz iq ka b kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv ij bi translated">è®©æˆ‘ä»¬å®‰è£…Django Elasticsearch DSLã€‚ç”¨ä½ å–œæ¬¢çš„PythonåŒ…ç®¡ç†å™¨ä»PyPIå®‰è£…appï¼Œæˆ‘ç”¨pipenvã€‚</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="ab71" class="om kx iq oh b gy on oo l op oq">pipenv install django-elasticsearch-dsl</span></pre><p id="0bb1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸å¤§å¤šæ•°Djangoåº”ç”¨ç¨‹åºä¸€æ ·ï¼Œæ‚¨åº”è¯¥å°†<code class="fe oe of og oh b">django_elasticsearch_dsl</code>æ·»åŠ åˆ°è®¾ç½®æ–‡ä»¶ä¸­çš„INSTALLED_APPS:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="3360" class="om kx iq oh b gy on oo l op oq">INSTALLED_APPS = [<br/>    ...<br/>    'django_elasticsearch_dsl',<br/>    ...<br/>]</span></pre><p id="da1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åï¼Œæ‚¨å¿…é¡»åœ¨Djangoè®¾ç½®ä¸­å®šä¹‰ELASTICSEARCH_DSLã€‚</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="1412" class="om kx iq oh b gy on oo l op oq"># Elasticsearch<br/>ELASTICSEARCH_DSL = {<br/>    'default': {<br/>        <!-- -->'hosts': os.getenv("ELASTICSEARCH_DSL_HOSTS", 'localhost:9200')<br/>    },<br/>}</span></pre><h1 id="a2a0" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">å°†æ•°æ®ç´¢å¼•åˆ°å¼¹æ€§æœç´¢ä¸­</h1><p id="3aad" class="pw-post-body-paragraph jy jz iq ka b kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv ij bi translated">è®©æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹æ¨¡å‹:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="d07a" class="om kx iq oh b gy on oo l op oq">class Post(models.Model):<br/>    title = models.CharField(max_length=128)<br/>    content = models.CharField(max_length=5000)<br/>    created_at = models.DateTimeField(default=timezone.now)<br/>    likes = models.PositiveIntegerField(default=0)<br/>    slug = models.SlugField(max_length=128, db_index=True, null=True)<br/>    draft = models.BooleanField(default=True)</span><span id="087e" class="om kx iq oh b gy or oo l op oq">    user = models.ForeignKey(<br/>        User, <br/>        related_name='posts', <br/>        on_delete=models.CASCADE<br/>    )</span><span id="6c43" class="om kx iq oh b gy or oo l op oq">    def __str__(self):<br/>        return self.title</span><span id="780e" class="om kx iq oh b gy or oo l op oq">    class Meta:<br/>        app_label = 'posts'</span></pre><p id="2c7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åæˆ‘ä»¬åº”è¯¥è¿è¡Œè¿ç§»:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="ad4c" class="om kx iq oh b gy on oo l op oq">$ docker-compose run web python manage.py makemigrations<br/>$ docker-compose run web python manage.py migrate</span></pre><p id="5fa7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨è®©æˆ‘ä»¬å®šä¹‰ElasticSearchç´¢å¼•ï¼Œè¿™éœ€è¦åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºç›®å½•ä¸­çš„<code class="fe oe of og oh b"><a class="ae mu" href="http://documents.py/" rel="noopener ugc nofollow" target="_blank">documents.py</a></code>ä¸­å®šä¹‰æ–‡æ¡£ç±»ã€‚</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="ba8f" class="om kx iq oh b gy on oo l op oq">from django.contrib.auth import get_user_model<br/>from django_elasticsearch_dsl import Document, fields<br/>from django_elasticsearch_dsl.registries import registry<br/>from .models import Post, Reply</span><span id="f924" class="om kx iq oh b gy or oo l op oq">User = get_user_model()</span><span id="3789" class="om kx iq oh b gy or oo l op oq">@registry.register_document<br/>class PostDocument(Document):<br/>    user = fields.ObjectField(properties={<br/>        'id': fields.IntegerField(),<br/>        'username': fields.TextField(),<br/>    })</span><span id="be27" class="om kx iq oh b gy or oo l op oq">class Index:<br/>        name = 'posts'<br/>        settings = {'number_of_shards': 1,<br/>                    'number_of_replicas': 0}</span><span id="5931" class="om kx iq oh b gy or oo l op oq">class Django:<br/>        model = Post</span><span id="425d" class="om kx iq oh b gy or oo l op oq">fields = [<br/>            'title',<br/>            'content',<br/>            'created_at',<br/>            'likes',<br/>            'draft',<br/>            'slug',<br/>        ]</span><span id="4818" class="om kx iq oh b gy or oo l op oq">def get_queryset(self):<br/>        return super(PostDocument, self).get_queryset().select_related(<br/>            'user'<br/>        )</span><span id="dcbb" class="om kx iq oh b gy or oo l op oq">def get_instances_from_related(self, related_instance):<br/>        if isinstance(related_instance, User):<br/>            return related_instance.posts.all()<br/>        elif isinstance(related_instance, Reply):<br/>            return related_instance.post</span></pre><h1 id="ab87" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">ç”¨æ³•ç¤ºä¾‹</h1><p id="6e4e" class="pw-post-body-paragraph jy jz iq ka b kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv ij bi translated">ä¸ºäº†ç”¨ä¸€äº›å†…å®¹å¡«å……æ•°æ®åº“ï¼Œæˆ‘ä¸ºæ­¤å‘å‡ºäº†ä¸€ä¸ªå‘½ä»¤ï¼Œåªéœ€è¿è¡Œ:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="bcc6" class="om kx iq oh b gy on oo l op oq">docker-compose run web python manage.py load_posts 20</span></pre><p id="e518" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿›å…¥äº¤äº’å¼Python shell ( <code class="fe oe of og oh b">docker-compose run web python manage.py shell</code>)å¹¶å°è¯•ä½¿ç”¨ElasticSearchæŸ¥è¯¢:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="1f73" class="om kx iq oh b gy on oo l op oq">&gt;&gt;&gt; from posts.documents import PostDocument<br/>&gt;&gt;&gt; posts = PostDocument.search()<br/>&gt;&gt;&gt; for hit in posts:<br/>...     print(hit.title)<br/>... <br/>Design half three bar quickly material center.<br/>Author true left. Position entire someone study be.<br/>School draw individual sell produce brother.<br/>Truth drug compare TV modern.<br/>Expert apply baby reveal team along.<br/>Beautiful for suddenly half.<br/>Plant argue enough less order receive sing.<br/>Store economy offer decision industry.<br/>Beat chair affect assume score occur include laugh.<br/>Language poor cell fish worry ready industry use.<br/>&gt;&gt;&gt;</span></pre><p id="8de3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘æ”¶é›†äº†ä¸€äº›ä½ å¯èƒ½éœ€è¦çš„ä¾‹å­:</p><pre class="no np nq nr gt oi oh oj ok aw ol bi"><span id="3d49" class="om kx iq oh b gy on oo l op oq">search = PostDocument.search()</span><span id="f41b" class="om kx iq oh b gy or oo l op oq"># Filter by single field equal to a value<br/>search = search.query('match', draft=False)</span><span id="f227" class="om kx iq oh b gy or oo l op oq"># Filter by single field containing a value<br/>search = search.filter('match_phrase', title="value")</span><span id="0698" class="om kx iq oh b gy or oo l op oq"># Add the query to the Search object<br/>from elasticsearch_dsl import Q<br/>q = Q("multi_match", query='python django', fields=['title', 'content'])<br/>search = search.query(q)</span><span id="9a95" class="om kx iq oh b gy or oo l op oq"># Query combination<br/>or_q = Q("match", title='python') | Q("match", title='django')<br/>and_q = Q("match", title='python') &amp; Q("match", title='django')<br/>search = search.query(or_q)</span><span id="b295" class="om kx iq oh b gy or oo l op oq"># Exclude items from your query<br/>search = search.exclude('match', draft=True)</span><span id="2694" class="om kx iq oh b gy or oo l op oq"># Filter documents that contain terms within a provided range.<br/># eg: the posts created for the past day<br/>search = search.filter('range', created_at={"gte": "now-1d"})</span><span id="7044" class="om kx iq oh b gy or oo l op oq"># Ordering<br/># prefixed by the - sign to specify a descending order.<br/>search = search.sort('-likes', 'created_at')</span></pre><p id="778b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç»™ä½ ä¸€ä¸ªå¿«é€Ÿæµ‹éªŒğŸ˜„ï¼Œæ‚¨å¯ä»¥åœ¨è¯„è®ºä¸­æäº¤æ‚¨çš„ç­”æ¡ˆğŸ‘‡</p><blockquote class="os"><p id="e127" class="ot ou iq bd ov ow ox oy oz pa pb kv dk translated">å¦‚ä½•è·å–è¿‡å»ä¸€å‘¨å†…å‘å¸ƒçš„æ ‡é¢˜/å†…å®¹ä¸­åŒ…å«â€œä½¿ç”¨â€ä¸€è¯çš„å¸–å­ï¼Ÿ</p></blockquote><h1 id="5f76" class="kw kx iq bd ky kz la lb lc ld le lf lg lh pc lj lk ll pd ln lo lp pe lr ls lt bi translated">å°±æ˜¯è¿™æ ·ï¼</h1><p id="2f51" class="pw-post-body-paragraph jy jz iq ka b kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv ij bi translated">è€å®è¯´ï¼Œè¿™å¤ªé•¿äº†ã€‚å¦‚æœä½ æœ‰è¶³å¤Ÿçš„è€å¿ƒè¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œå¹¶ä¸”è§‰å¾—å®ƒå¾ˆæœ‰è¶£ï¼Œé‚£ä¹ˆè¯·åˆ†äº«å®ƒã€‚</p><blockquote class="lu lv lw"><p id="fda6" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated">æœ¬æ–‡æœ€åˆå‘è¡¨äº<a class="ae mu" href="https://www.obytes.com/blog/building-a-full-text-search-app-using-django-docker-and-elasticsearch" rel="noopener ugc nofollow" target="_blank">https://obytes.com/</a></p></blockquote></div></div>    
</body>
</html>