<html>
<head>
<title>How to Collect Data with pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用熊猫收集数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-collect-data-with-pandas-5fbff0a9cbf4?source=collection_archive---------18-----------------------#2022-11-01">https://levelup.gitconnected.com/how-to-collect-data-with-pandas-5fbff0a9cbf4?source=collection_archive---------18-----------------------#2022-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c965" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">TL；DR:使用Python从文件和网站中提取数据</h2></div><p id="e454" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个数据科学相关项目的第一步——即使你计划在Google Sheets中显示一些统计数据——是收集数据。</p><p id="dfab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据可以是数据库等结构化数据，也可以是社交媒体图片和视频等非结构化数据。一旦收集了这些数据，在企业可以使用这些数据来做出决策之前，需要对其进行<strong class="kk iu">处理</strong>和<strong class="kk iu">转换成信息</strong>。</p><p id="059e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，您将学习如何使用一个名为<a class="ae le" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>的流行Python库从许多流行的数据源中提取数据。</p><p id="9cd9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您不了解Python，您可以阅读我专门为您创建的这篇文章:</p><div class="lf lg gp gr lh li"><a rel="noopener  ugc nofollow" target="_blank" href="/the-basics-of-python-for-data-science-7f9662e921d1"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">数据科学的Python基础</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">Python的安装和主要概念</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw lx li"/></div></div></a></div><p id="1441" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将首先介绍熊猫图书馆，然后解释如何从多个来源提取数据。</p><p id="7577" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要犹豫，直接联系您感兴趣的数据源:</p><ul class=""><li id="5474" class="ly lz it kk b kl km ko kp kr ma kv mb kz mc ld md me mf mg bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/how-to-collect-data-with-pandas-5fbff0a9cbf4#7ca3">如何从CSV文件中提取数据</a></li><li id="fbd7" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/how-to-collect-data-with-pandas-5fbff0a9cbf4#f9c3">如何从Excel文件中提取数据</a></li><li id="9571" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/how-to-collect-data-with-pandas-5fbff0a9cbf4#7e2b">如何从网站提取数据</a></li><li id="7a01" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/how-to-collect-data-with-pandas-5fbff0a9cbf4#3585">(加分)如何从JSON文件中提取数据</a></li><li id="a654" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/how-to-collect-data-with-pandas-5fbff0a9cbf4#fc10">(加分)将数据帧转换成另一种格式</a></li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/63eeff66d54334c67f47fbb23dc3b26f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b1Uo9DUAjx5VlDp2"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated"><strong class="bd nb">如何用熊猫Python库收集数据</strong>，摄影<a class="ae le" href="https://unsplash.com/@ltmonster?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">徐世阳</a></figcaption></figure><h1 id="16bb" class="nc nd it bd nb ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">Pandas，一个操作数据框的库</h1><p id="3364" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated"><strong class="kk iu"> pandas </strong>是一个快速、强大、灵活且易于使用的开源数据分析和操作工具，构建于<a class="ae le" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>编程语言之上。</p><p id="7752" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个库的大部分都集中在一个名为“DataFrame”的对象上，您可以将它与Excel电子表格进行比较。</p><p id="41c3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ny nz oa ob b"><a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">DataFrame</strong></a></code>是一个二维数据结构，可以在列中存储不同类型的数据(包括字符、整数、浮点值、分类数据等等):</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/83b1c1088720c84293932c344724ab4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*jzzQInd9Rcldiz1l-fuWFA.jpeg"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">一个数据框架，来自<a class="ae le" href="https://pandas.pydata.org/docs/getting_started/intro_tutorials/01_table_oriented.html" rel="noopener ugc nofollow" target="_blank">熊猫文献</a></figcaption></figure><p id="29df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你使用Python包管理器<a class="ae le" href="https://pip.pypa.io/en/stable/installation/" rel="noopener ugc nofollow" target="_blank"> pip </a>安装它:</p><pre class="mn mo mp mq gt od ob oe of aw og bi"><span id="31a8" class="oh nd it ob b gy oi oj l ok ol">pip install pandas</span></pre><h2 id="7df6" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">如何创建熊猫数据框</h2><p id="fa8b" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">您可以根据列表或Python字典创建数据框:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="ox oy l"/></div></figure><h2 id="e0cf" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">你能从数据帧中获得什么信息？</h2><p id="c224" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">访问关于<em class="oz">数据帧</em>的主要信息的最简单方法是执行<a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> describe() </strong>函数</a>。您将获得一组关于所考虑数据集的统计信息:</p><ul class=""><li id="27fd" class="ly lz it kk b kl km ko kp kr ma kv mb kz mc ld md me mf mg bi translated">条目数(注明“<em class="oz">计数</em>”)；</li><li id="6cac" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated">平均值(标注“<em class="oz">表示</em>”)；</li><li id="ca90" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated">标准差(记录为“<em class="oz">STD</em>”)；</li><li id="7362" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated">最小值和最大值(注明“<em class="oz">最小值</em>”、“<em class="oz">最大值</em>”)；</li><li id="8963" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated">第一、第二和第三四分位数(记为<em class="oz"> 25% </em>、<em class="oz"> 50% </em>和<em class="oz">75%</em>)；</li></ul><blockquote class="pa pb pc"><p id="d375" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">不可能计算非数字列或变量的这些属性，例如产品的名称和描述。</p></blockquote><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pg oy l"/></div></figure><p id="4549" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<em class="oz">列</em>属性列出可用变量，并使用<a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rename.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> rename() </strong>函数</a>重命名这些列:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="ph oy l"/></div></figure><h2 id="b4ba" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">在数据帧中查找信息</h2><p id="b744" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">您像管理字典一样管理<em class="oz">数据框架</em>，因此很容易从<em class="oz">数据框架</em>中获取一列或多列，或者只获取一定数量的行。</p><p id="7215" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看看如何从我为您准备的<em class="oz">数据框架</em>中选择具体的列(<em class="oz">您将在下一节</em>中加载):</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pi oy l"/></div></figure><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pj oy l"/></div></figure><p id="ea92" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您筛选一些行，比如前10行，以获得数据的概览:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pk oy l"/></div></figure><p id="69c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">特定于数据框的函数允许您通过仅显示几行(前几行)来了解被操作的数据集。</p><p id="01eb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，使用<a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">头()</strong>功能</a>。</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pl oy l"/></div></figure><blockquote class="pa pb pc"><p id="acd6" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">你认为<a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.tail.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> tail() </strong>函数</a>有什么作用？</p></blockquote><h2 id="d057" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">使用query()函数过滤信息</h2><p id="3818" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated"><a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> query() </strong>函数</a>允许您根据适用于不同列(或变量)的条件过滤<em class="oz">数据框架</em>中的信息。</p><p id="3a43" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，要检索“供应品”类别的所有订单:</p><pre class="mn mo mp mq gt od ob oe of aw og bi"><span id="b995" class="oh nd it ob b gy oi oj l ok ol">orders_furniture = super_store.query('Category == "Furniture"')</span></pre><p id="be65" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者，金额在10美元到50美元之间的所有订单:</p><pre class="mn mo mp mq gt od ob oe of aw og bi"><span id="03a2" class="oh nd it ob b gy oi oj l ok ol">sales = super_store.query('Sales &gt; 10 and Sales &lt; 50')</span></pre><p id="f58b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你懂SQL，这个函数使用类似的语言。</p><p id="bfa9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您不知道，SQL并不难，您可以从我主要为您写的文章开始:</p><div class="lf lg gp gr lh li"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-learn-sql-10-minutes-a-day-bbe023c01470"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">如何学习SQL，每天10分钟</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">这是我作为首席技术/数据保持最新状态的方法。</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="lr l"><div class="pm l lt lu lv lr lw lx li"/></div></div></a></div><h1 id="7ca3" class="nc nd it bd nb ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">如何从CSV文件中提取数据</h1><p id="4a23" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">您可能想知道如何自己访问超级商店数据。</p><p id="e30f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，您将学习如何从CSV文件加载数据😉</p><p id="dd87" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大多数公司将其数据存储在文件或数据库中，您可以从中获得导出。</p><p id="73c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以从任何数据中获取CSV文件(用于“逗号分隔值”)。像Excel这样的著名软件以及大多数软件都提供了以这种格式导出的选项。—所有数据库。</p><p id="b264" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">pandas的库有<a class="ae le" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank"> read_csv()函数</a>来从这个文件类型创建一个<em class="oz">数据帧</em>。</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pn oy l"/></div></figure><h2 id="2d94" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">分离器的选择</h2><p id="8c20" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">CSV文件用逗号分隔变量，但有时您会发现文件使用了不同的分隔符。在这种情况下，使用<strong class="kk iu"> read_csv() </strong>函数的<strong class="kk iu"> sep </strong>参数定义“分隔符”。</p><p id="f36f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看“people.csv”文件的内容:</p><pre class="mn mo mp mq gt od ob oe of aw og bi"><span id="2c59" class="oh nd it ob b gy oi oj l ok ol">lastname;firstname;age<br/>andrieu;mickaël;36<br/>doe;john;27<br/>karembeu;adriana;44</span></pre><p id="36b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以及装载的结果，不使用和使用<strong class="kk iu"> sep </strong>调节器:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="po oy l"/></div></figure><h2 id="03d0" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">编码选择</h2><p id="ad66" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">有时你会在两个不同的环境之间得到一个文件(例如，Windows和Mac OSX)，你会遇到特殊字符的问题。</p><p id="c122" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，如果您知道源文件的编码，那么您可以使用<strong class="kk iu">编码</strong>参数在<strong class="kk iu"> read_csv() </strong>函数中指定它:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pp oy l"/></div></figure><blockquote class="pa pb pc"><p id="3d3d" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">由于正确的编码，像表情符号这样的特殊字符将被正确呈现。</p></blockquote><h2 id="2014" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">优化数据帧加载的性能</h2><p id="f255" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">如果要处理的文件非常大，包含数百万行，那么定义您想要在您的<em class="oz">数据框架</em>中加载多少行可能会很有趣。</p><p id="6447" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">定义参数<strong class="kk iu"> nrows </strong>和<strong class="kk iu">skipows</strong>就足以确定要检索多少行以及从哪一行开始装载。</p><p id="e638" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您定义文件行，其中标题(列名)使用了<strong class="kk iu">标题</strong>参数。<em class="oz">一个技巧</em>是使用<a class="ae le" href="https://docs.python.org/3/tutorial/controlflow.html#the-range-function" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> range() </strong>函数</a>来消除除第一行之外的所有行:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pq oy l"/></div></figure><h1 id="f9c3" class="nc nd it bd nb ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">如何从Excel文件中提取数据</h1><p id="eae6" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated"><strong class="kk iu"> Excel文件(扩展名为。xls或者。xlsx)是公司里最受欢迎的。</strong></p><p id="e2ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">熊猫图书馆完全有能力阅读这些文件。这一次您将使用另一个在互联网上可用的Excel文件，它是一个开源版本:版本4中的Opquast存储库。</p><blockquote class="pa pb pc"><p id="a915" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">您可以下载它并运行下一篇文章中建议的命令。</p></blockquote><p id="88b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就像有<strong class="kk iu"> read_csv() </strong>函数读取csv文件一样，这次你用<a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html?highlight=read_excel" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> read_excel() </strong>函数</a>加载excel文件。</p><p id="b409" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该功能读取两个<em class="oz">。xlsx </em>和<em class="oz">。xls </em>文件，但是对于。xls文件(Excel 2007/2010版本的Excel文件)，必须下载<a class="ae le" href="https://github.com/python-excel/xlrd" rel="noopener ugc nofollow" target="_blank"> xlrd </a>扩展名:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pr oy l"/></div></figure><p id="1df5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要解决此问题，请安装缺少的模块:</p><pre class="mn mo mp mq gt od ob oe of aw og bi"><span id="cfa1" class="oh nd it ob b gy oi oj l ok ol">pip install xlrd</span></pre><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="ps oy l"/></div></figure><h2 id="7035" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">选择要装载的纸张</h2><p id="1569" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">与CSV文件相反，Excel文件将包含几个您可以选择转换成<em class="oz">数据框</em>的工作表。</p><p id="729a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，您将定义<strong class="kk iu"> sheetname </strong>参数，它可以是一个数值(第一张、第二张或“第n张”工作表？)、字符串(工作表的名称)或列表(包含数字或名称):</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pt oy l"/></div></figure><h2 id="8ef7" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">文件标题的识别和选择</h2><p id="e1d6" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">有时数据不是预期的格式，选择或创建文档标题是必要的。此后检查，标题在第4行可用，我们必须忽略所选工作表的前三行:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/c7af88a3cdbf0befdb45c94a67179b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*v4KMDMICnccmZda9U4jKPQ.jpeg"/></div></figure><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pv oy l"/></div></figure><blockquote class="pa pb pc"><p id="26ed" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">这部分可能会让你困惑，但是我保证<strong class="kk iu">范围(0，4) </strong>会从0到3 循环<strong class="kk iu">，而不是4 <em class="it">😶。</em></strong></p></blockquote><h2 id="0473" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">文档处理引擎</h2><p id="019b" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">熊猫库的<strong class="kk iu"> read_excel() </strong>函数读取了很多“电子表格”类型的文件而不仅仅是excel文件……对了，是哪些呢？</p><p id="929b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实上，Excel文件会根据所用软件的版本而发展，并且可以指定使用哪个“引擎”来创建您的<em class="oz">数据框架</em>。</p><p id="6445" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将配置<strong class="kk iu"> read_excel() </strong>的引擎属性:</p><ul class=""><li id="e8c3" class="ly lz it kk b kl km ko kp kr ma kv mb kz mc ld md me mf mg bi translated"><strong class="kk iu"> xlrd </strong>用于旧的Excel文件(<strong class="kk iu">)。xls</strong>)；</li><li id="cd63" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><strong class="kk iu"> openpyxl </strong>用于较新的Excel文件(<strong class="kk iu">)。xlsx</strong>)；</li><li id="72b8" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><strong class="kk iu"> odf </strong>用于从<em class="oz"> Libre Office </em>或<em class="oz"> Open Office </em> ( <strong class="kk iu">)获得的文件。ODT</strong>)；</li></ul><blockquote class="pa pb pc"><p id="0c94" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">由于pandas试图检测要使用的最佳引擎，因此指定该属性是可选的。</p></blockquote><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pw oy l"/></div></figure><h1 id="7e2b" class="nc nd it bd nb ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">如何从网站中提取数据</h1><p id="2616" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">有时候，你只能访问网站上的HTML表格。</p><p id="8fb7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">熊猫图书馆有针对这种情况的<a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.read_html.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> read_html() </strong>功能</a>，在那里你将不得不<strong class="kk iu">从互联网上搜集信息</strong>用于分析目的。</p><blockquote class="pa pb pc"><p id="9ec9" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">作为一个实际例子，我将向您展示如何从维基百科网站检索与世界人口统计相关的信息。</p></blockquote><p id="b0b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于一个网站页面可以包含多个表格，该函数返回<strong class="kk iu">一个<em class="oz"> DataFrames </em> </strong>列表:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="px oy l"/></div></figure><p id="2b5a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后你必须从列表中选择你感兴趣的<em class="oz">数据帧</em>。下面是第一个(所以它在位置0):</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="py oy l"/></div></figure><h2 id="f1a6" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">选择正确的信息</h2><p id="ec63" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">您可以设置<strong class="kk iu"> match </strong>参数来查找HTML表中存在的表达式，并将其转换为<em class="oz"> DataFrame </em>。</p><p id="413f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果你查看法国的<a class="ae le" href="https://fr.wikipedia.org/wiki/France" rel="noopener ugc nofollow" target="_blank">维基百科页面，你会注意到它有很多表格。</a></p><p id="6fe4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">这些信息是否改善了read_html()函数的返回？</strong></p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="pz oy l"/></div></figure><blockquote class="pa pb pc"><p id="95d8" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">我不想谈论HTML尤其是CSS的基础知识。但是如果你想通过熊猫图书馆在网上搜集信息，你可能需要它们。<strong class="kk iu">传递一个CSS选择器会显著提高滤镜的质量。</strong></p></blockquote><p id="327a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你对网络抓取感兴趣，你最好用HTML、CSS和Python BeautifulSoup库来完成你的学习:</p><div class="lf lg gp gr lh li"><a href="https://towardsdatascience.com/data-science-skills-web-scraping-using-python-d1a85ef607ed" rel="noopener follow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">数据科学技能:使用Python进行网络搜集</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">作为一名数据科学家，我在工作中接受的第一批任务之一就是网络搜集。这完全是…</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">towardsdatascience.com</p></div></div><div class="lr l"><div class="qa l lt lu lv lr lw lx li"/></div></div></a></div><h1 id="3585" class="nc nd it bd nb ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">(加分)如何从JSON文件中提取数据</h1><p id="6e62" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">有时数据不能作为文件直接访问，而是以JSON格式作为REST API“公开”。</p><p id="3bf6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">JSON(for "<strong class="kk iu">J</strong>ava<strong class="kk iu">S</strong>script<strong class="kk iu">O</strong>object<strong class="kk iu">N</strong>rotation ")格式很流行，许多公司都使用这种格式共享数据:</p><ul class=""><li id="b7ea" class="ly lz it kk b kl km ko kp kr ma kv mb kz mc ld md me mf mg bi translated">如果你想检索<a class="ae le" href="https://developer.twitter.com/en/docs/api-reference-index" rel="noopener ugc nofollow" target="_blank">一列推文</a>，Twitter提供了JSON格式的API</li><li id="132f" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated">如果您打算<a class="ae le" href="https://coinmarketcap.com/api/documentation/v1/" rel="noopener ugc nofollow" target="_blank">检索加密资产的每日估价</a>，CoinMarketCap提供了一个JSON格式的API</li><li id="dd80" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated">如果你想得到法国所有城市的列表，政府提供了JSON格式的API</li></ul><p id="5303" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后使用<strong class="kk iu"> read_json() </strong>函数将该数据加载到<em class="oz"> DataFrame </em>中:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="qb oy l"/></div></figure><h2 id="f3f0" class="oh nd it bd nb om on dn nh oo op dp nl kr oq or nn kv os ot np kz ou ov nr ow bi translated">网络链接的使用</h2><p id="508c" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">像前面所有的函数一样，您可以将URIs作为这些函数的加载参数进行传递。</p><p id="7732" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，如果下面的链接仍然有效，则执行下面的代码等同于前面的语句:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="qb oy l"/></div></figure><h1 id="fc10" class="nc nd it bd nb ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">(奖励)将数据帧转换成另一种格式</h1><p id="ba10" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">pandas库的一个便利特性是从许多来源导入数据，但是这个库也可以将一个<em class="oz">数据帧</em>导出为一个文件。</p><blockquote class="pa pb pc"><p id="c6c9" class="ki kj oz kk b kl km ju kn ko kp jx kq pd ks kt ku pe kw kx ky pf la lb lc ld im bi translated">您会发现这对于将(以前)获得的JSON文件转换成Excel文件特别有帮助！</p></blockquote><p id="c47a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用适合您需求的功能:</p><ul class=""><li id="e0a9" class="ly lz it kk b kl km ko kp kr ma kv mb kz mc ld md me mf mg bi translated"><a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> to_excel() </strong>函数</a>获取一个. xls文件；</li><li id="02fa" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> to_csv() </strong>函数</a>获取一个. csv文件；</li><li id="dbc0" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated">而<a class="ae le" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_json.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">为什么不在另一个上下文中调用_json() </strong>函数</a>；</li></ul><p id="ad7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要执行<strong class="kk iu"> to_excel() </strong>函数，您必须安装一些额外的Python模块:</p><pre class="mn mo mp mq gt od ob oe of aw og bi"><span id="9f10" class="oh nd it ob b gy oi oj l ok ol">pip install openpyxl xlwt </span></pre><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="qc oy l"/></div></figure><p id="8947" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而这第二篇就结束了。感谢您的阅读！</p><p id="b399" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您需要提高您的Python知识，请关注我的3个月免费计划:</p><div class="lf lg gp gr lh li"><a rel="noopener  ugc nofollow" target="_blank" href="/master-python-10-minutes-a-day-5aeab489e227"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">如何学习Python，每天10分钟</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">这就是我作为数据/人工智能顾问如何跟上时代的方法</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="lr l"><div class="qd l lt lu lv lr lw lx li"/></div></div></a></div></div><div class="ab cl qe qf hx qg" role="separator"><span class="qh bw bk qi qj qk"/><span class="qh bw bk qi qj qk"/><span class="qh bw bk qi qj"/></div><div class="im in io ip iq"><div class="mn mo mp mq gt li"><a href="https://mickael-andrieu.medium.com/membership" rel="noopener follow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">通过我的推荐链接加入Medium-mickal Andrieu</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">mickael-andrieu.medium.com</p></div></div><div class="lr l"><div class="ql l lt lu lv lr lw lx li"/></div></div></a></div><p id="a92a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您有任何问题，请随时发表评论，如果您喜欢这篇文章，<a class="ae le" href="https://mickael-andrieu.medium.com/" rel="noopener">关注我</a>，当我下一次发布时，您会收到通知。</p></div></div>    
</body>
</html>