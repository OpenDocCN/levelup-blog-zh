<html>
<head>
<title>Building a List with UICollectionView in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift中使用UICollectionView构建列表</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-a-list-with-uicollectionview-in-swift-8cbed6aa6080?source=collection_archive---------8-----------------------#2020-07-25">https://levelup.gitconnected.com/building-a-list-with-uicollectionview-in-swift-8cbed6aa6080?source=collection_archive---------8-----------------------#2020-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4b6b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">它看起来完全像一个<code class="fe ki kj kk kl b">UITableView</code>！</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/d8ba62c461858da91031c24d36c196b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1HmpcVElWr3ehXKY"/></div></div></figure><p id="f67a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">本文原载于2020年7月25日</em><a class="ae lv" href="https://swiftsenpai.com/development/uicollectionview-list-basic/" rel="noopener ugc nofollow" target="_blank"><em class="lu">https://swiftsenpai.com</em></a><em class="lu">。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="2136" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">自从在iOS6中引入了<code class="fe ki kj kk kl b">UICollectionView</code>之后，<code class="fe ki kj kk kl b">UICollectionView</code>已经成为构建网格布局的默认组件。在WWDC 2020中，苹果通过在<code class="fe ki kj kk kl b">UICollectionView</code>中引入列表布局，将<code class="fe ki kj kk kl b">UICollectionView</code>的可用性推向了一个新的高度。</p><p id="03d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过使用iOS14中给予<code class="fe ki kj kk kl b">UICollectionView</code>的新功能和API，现在构建一个类似<code class="fe ki kj kk kl b">UITableView</code>的列表非常容易，与<code class="fe ki kj kk kl b">UITableView</code>相比，这无疑是更好的选择。</p><p id="a031" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，让我们看看使用iOS 14中的新<code class="fe ki kj kk kl b">UICollectionView</code>创建一个带有可滑动单元格的列表有多简单，该单元格显示图像和文本。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="63dc" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">示例应用程序</h1><p id="2ff3" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在我们开始之前，让我们快速地看一下我们在本文中试图建立什么样的列表。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/feebb855eeae7237b87f5cdc4186eef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*iB075TPNtdtZW96o"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">我们将要构建的示例应用程序</figcaption></figure><p id="5c6f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你从上面的动画gif中看到的，我们将创建一个应用程序，当你点击它时，它会在一个<code class="fe ki kj kk kl b">UIAlertController</code>中显示<code class="fe ki kj kk kl b">SFSymbol</code>的名称。</p><p id="94a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，列表的单元格也是可滑动的，点击时会触发相应的滑动动作。</p><p id="b6e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">说了这么多，让我们启动Xcode，投入其中吧！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="9c1b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">创建列表</h1><p id="009c" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">为了使用<code class="fe ki kj kk kl b">UICollectionView</code>创建列表，我们需要:</p><ol class=""><li id="26e5" class="nf ng it la b lb lc le lf lh nh ll ni lp nj lt nk nl nm nn bi translated">定义数据标识符类型</li><li id="e9d0" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">定义部分标识符类型</li><li id="5855" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">创建带有列表布局的收藏视图</li><li id="3344" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">定义如何使用单元格注册显示数据</li><li id="9e64" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">定义集合视图的数据源</li><li id="a3fb" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">创建快照并将其应用于数据源</li></ol><h2 id="b981" class="nt me it bd mf nu nv dn mj nw nx dp mn lh ny nz mp ll oa ob mr lp oc od mt oe bi translated">1.定义项目标识符类型</h2><p id="5eb5" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在开始处理集合视图之前，我们必须首先准备好我们的数据模型。让我们继续创建一个由<code class="fe ki kj kk kl b">name</code>和<code class="fe ki kj kk kl b">image</code>常量组成的<code class="fe ki kj kk kl b">SFSymbolItem</code>结构。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="728d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">确保<code class="fe ki kj kk kl b">SFSymbolItem</code>结构符合<code class="fe ki kj kk kl b">Hashable</code>协议，因为我们将要使用的diffable数据源(在iOS13中引入)需要项目标识符的唯一哈希值。</p><p id="c61d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，让我们填充一个数组<code class="fe ki kj kk kl b">SFSymbolItem</code>,以便稍后我们可以使用它作为集合视图的数据模型。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="a2bd" class="nt me it bd mf nu nv dn mj nw nx dp mn lh ny nz mp ll oa ob mr lp oc od mt oe bi translated">2.定义部分标识符类型</h2><p id="5167" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">即使在我们的示例应用程序中只有一个部分，仍然需要定义一个部分。定义节标识符的常用方法是使用枚举。</p><p id="bc81" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常，节标识符只在一个特定的视图控制器中使用，因此建议在使用它的视图控制器中定义它。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="ae3d" class="nt me it bd mf nu nv dn mj nw nx dp mn lh ny nz mp ll oa ob mr lp oc od mt oe bi translated">3.创建带有列表布局的收藏视图</h2><p id="9b5c" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">有了item和section标识符，我们现在就可以开始处理集合视图了。首先，让我们定义一个<code class="fe ki kj kk kl b">UICollectionView</code>实例变量。</p><pre class="kn ko kp kq gt oh kl oi oj aw ok bi"><span id="3d60" class="nt me it kl b gy ol om l on oo">var collectionView: UICollectionView!</span></pre><p id="de51" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，打开视图控制器的<code class="fe ki kj kk kl b">viewDidLoad()</code>，创建一个列表式布局的集合视图。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="918d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从上面的示例代码中需要注意的一点是，在创建列表配置时，您需要选择集合视图列表外观。</p><p id="d318" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在iOS 14中，苹果推出了5种模仿a <code class="fe ki kj kk kl b">UITableView</code>外观的<a class="ae lv" href="https://developer.apple.com/documentation/uikit/uicollectionlayoutlistconfiguration/appearance" rel="noopener ugc nofollow" target="_blank">外观</a>。以下是我们的示例应用程序在不同外观类型下的截图。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi op"><img src="../Images/79edb179dea91f530ae2a80cf14eeda5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZfGXINseatKTxN_H"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">收藏视图列表外观(分组、内分组、普通)</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi op"><img src="../Images/e1b53b3559ca8d66b0f853be7f97e910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r6a4TyRV2lKWdggp"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">收藏视图列表外观(侧栏，sidebarPlain)</figcaption></figure><h2 id="90c1" class="nt me it bd mf nu nv dn mj nw nx dp mn lh ny nz mp ll oa ob mr lp oc od mt oe bi translated">4.定义如何使用单元格注册显示数据</h2><p id="16ed" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">接下来，我们将使用iOS 14中引入的新的<code class="fe ki kj kk kl b"><a class="ae lv" href="https://developer.apple.com/documentation/uikit/uicollectionview/cellregistration" rel="noopener ugc nofollow" target="_blank">UICollectionView.CellRegistration</a></code> API来创建一个单元格注册，它定义了数据应该如何在单元格中显示。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="ea68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们为类型为<code class="fe ki kj kk kl b"><a class="ae lv" href="https://developer.apple.com/documentation/uikit/uicollectionviewlistcell" rel="noopener ugc nofollow" target="_blank">UICollectionViewListCell</a></code>的单元格和类型为<code class="fe ki kj kk kl b">SFSymbolItem</code>的数据项创建一个单元格注册。</p><p id="c06f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在单元格注册处理程序中，我们创建一个默认的单元格内容配置，并使用它来指定我们希望数据(内容)如何显示。之后，我们将为单元分配内容配置。</p><h2 id="1d42" class="nt me it bd mf nu nv dn mj nw nx dp mn lh ny nz mp ll oa ob mr lp oc od mt oe bi translated">5.定义集合视图的数据源</h2><p id="f875" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">单元格注册完成后，我们可以用它来定义集合视图的数据源。</p><p id="db52" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，让我们定义一个<code class="fe ki kj kk kl b">UICollectionViewDiffableDataSource</code>实例变量，用<code class="fe ki kj kk kl b">Section</code>作为部分标识符类型，用<code class="fe ki kj kk kl b">SFSymbolItem</code>作为项目标识符类型。</p><pre class="kn ko kp kq gt oh kl oi oj aw ok bi"><span id="2a32" class="nt me it kl b gy ol om l on oo">var dataSource: UICollectionViewDiffableDataSource&lt;Section, SFSymbolItem&gt;!</span></pre><p id="9080" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，返回到<code class="fe ki kj kk kl b">viewDidLoad()</code>，通过传入我们的集合视图并实现单元格提供者闭包来创建数据源。这样做会将数据源与我们的集合视图连接起来。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="9c53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在单元提供者闭包中，我们使用之前创建的单元注册将可重用单元出队。请注意，我们不再需要使用单元重用标识符来使可重用单元出队。多酷啊。🥳</p><p id="f1ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，单元格提供程序闭包也是配置单元格外观的好地方，例如添加单元格附件或更改单元格的色调。</p><h2 id="2d98" class="nt me it bd mf nu nv dn mj nw nx dp mn lh ny nz mp ll oa ob mr lp oc od mt oe bi translated">6.创建快照并将其应用于数据源</h2><p id="d98c" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在这最后一步，我们将通过使用iOS 13中引入的<code class="fe ki kj kk kl b"><a class="ae lv" href="https://developer.apple.com/documentation/uikit/nsdiffabledatasourcesnapshot" rel="noopener ugc nofollow" target="_blank">NSDiffableDataSourceSnapshot</a></code>告诉我们的视图控制器显示什么数据。</p><p id="28f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">像往常一样，让我们首先创建一个<code class="fe ki kj kk kl b">NSDiffableDataSourceSnapshot</code>实例变量。请确保正确设置区段标识类型和项目标识类型。</p><pre class="kn ko kp kq gt oh kl oi oj aw ok bi"><span id="15c3" class="nt me it kl b gy ol om l on oo">var snapshot: NSDiffableDataSourceSnapshot&lt;Section, SFSymbolItem&gt;!</span></pre><p id="aa0a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，返回到<code class="fe ki kj kk kl b">viewDidLoad()</code>，添加下面的代码片段。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="b2c8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的代码中，我们首先创建一个快照实例，然后我们让快照知道它应该包含<code class="fe ki kj kk kl b">main</code>部分，而<code class="fe ki kj kk kl b">main</code>部分应该包含我们在步骤1中定义的<code class="fe ki kj kk kl b">dataItems</code>。之后，将快照应用到数据源，以在集合视图上显示数据。</p><p id="ac0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是使用集合视图创建列表的全部内容。继续运行示例代码，查看实际的列表布局。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="068b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">处理单元格点击操作</h1><p id="24b3" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在本节中，我们将研究如何处理单元格点击操作。概括一下，我们将在一个<code class="fe ki kj kk kl b">UIAlertController</code>中显示所选<code class="fe ki kj kk kl b">SFSymbol</code>的名称，如下图所示。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/79cea6af1c5b082a8562ff70de444cdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/0*yCCGi3q-Qb1iqQjG"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">点击单元格后显示警告</figcaption></figure><p id="8814" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能已经猜到，为了处理单元格点击动作，我们需要实现<code class="fe ki kj kk kl b">collectionView(_:didSelectItemAt:)</code> delegate方法。但是在此之前，请确保将视图控制器设置为集合视图的委托。</p><pre class="kn ko kp kq gt oh kl oi oj aw ok bi"><span id="54b1" class="nt me it kl b gy ol om l on oo">collectionView.delegate = self</span></pre><p id="ea00" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是<code class="fe ki kj kk kl b">collectionView(_:didSelectItemAt:)</code>委托方法的实现。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="d25d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的代码几乎是不言自明的。但是，需要注意的一点是，我们是直接从<code class="fe ki kj kk kl b">dataSource</code>而不是从<code class="fe ki kj kk kl b">dataItems</code>中检索选定的数据。</p><p id="adfd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这非常重要，因为<code class="fe ki kj kk kl b">UICollectionViewDiffableDataSource</code>可能会执行一些后台操作，导致<code class="fe ki kj kk kl b">dataItems</code>与集合视图中显示的数据不一致。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="b4bb" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">处理滑动动作</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/ef5927f1010992c85aa457524a6f203b.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/0*tAaEH26y06ap4I7_"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">从右向左滑动单元格时的操作</figcaption></figure><p id="c378" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了在我们的列表上启用滑动操作，让我们向上滚动到<code class="fe ki kj kk kl b">viewDidLoad()</code>的开头，并通过定义<code class="fe ki kj kk kl b">trailingSwipeActionsConfigurationProvider</code>来修改<code class="fe ki kj kk kl b">layoutConfig</code>。确保将<code class="fe ki kj kk kl b">layoutConfig</code>的定义从<code class="fe ki kj kk kl b">let</code>更改为<code class="fe ki kj kk kl b">var</code>。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><blockquote class="os ot ou"><p id="9e1d" class="ky kz lu la b lb lc ju ld le lf jx lg ov li lj lk ow lm ln lo ox lq lr ls lt im bi translated"><strong class="la iu"> <em class="it">亲提示:</em> </strong></p><p id="d84e" class="ky kz lu la b lb lc ju ld le lf jx lg ov li lj lk ow lm ln lo ox lq lr ls lt im bi translated"><em class="it">执行</em> <code class="fe ki kj kk kl b"><em class="it">leadingSwipeActionsConfigurationProvider</em></code> <em class="it">启用左右滑动动作。</em></p></blockquote><p id="9846" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">基于苹果<a class="ae lv" href="https://developer.apple.com/documentation/uikit/uicollectionlayoutlistconfiguration/swipeactionsconfigurationprovider?changes=latest_beta" rel="noopener ugc nofollow" target="_blank">文档</a>,<code class="fe ki kj kk kl b">trailingSwipeActionsConfigurationProvider</code>是一个接受<code class="fe ki kj kk kl b">IndexPath</code>并返回<code class="fe ki kj kk kl b">UISwipeActionsConfiguration</code>的闭包。</p><p id="cb9b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下示例代码演示了如何实现<code class="fe ki kj kk kl b">trailingSwipeActionsConfigurationProvider</code>以获得我们的示例应用程序行为。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="b280" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe ki kj kk kl b">trailingSwipeActionsConfigurationProvider</code>闭包内，我们:</p><ol class=""><li id="b959" class="nf ng it la b lb lc le lf lh nh ll ni lp nj lt nk nl nm nn bi translated">从数据源中检索滑动单元格的数据项，就像我们在<code class="fe ki kj kk kl b">collectionView(_:didSelectItemAt:)</code>中所做的一样。</li><li id="5cb3" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">通过创建一个<code class="fe ki kj kk kl b">UIContextualAction</code>的实例来定义第一个动作(动作1)。在初始化期间，我们设置动作的样式、标题，并实现动作处理程序。</li><li id="ebdc" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">在动作处理程序中，调用<code class="fe ki kj kk kl b">handleSwipe(for:item:)</code>函数来显示一条警告消息。我们将很快实现这一点。</li><li id="ce6e" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">调用动作处理程序的完成处理程序来表明我们已经执行了动作。</li><li id="792f" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">配置操作视图背景颜色。</li><li id="accb" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">定义第二个动作并实现其动作处理程序。</li><li id="1061" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">使用我们刚刚创建的所有<code class="fe ki kj kk kl b">UIContextualAction</code>创建一个滑动动作配置，并将其返回给滑动动作配置提供者。</li></ol><p id="d204" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，让我们实现<code class="fe ki kj kk kl b">handleSwipe(for:item:)</code>函数。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="01c8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">至此，我们已经完成了示例应用程序实现。继续运行您的示例项目，看看一切都在运行。</p><p id="1322" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我已经将完整的示例项目上传到了<a class="ae lv" href="https://github.com/LeeKahSeng/SwiftSenpai-UICollectionView-List" rel="noopener ugc nofollow" target="_blank"> Github </a>，如果你需要任何参考，请随意下载。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="639d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">进一步阅读</h1><ul class=""><li id="7f15" class="nf ng it la b lb mv le mw lh oy ll oz lp pa lt pb nl nm nn bi translated"><a class="ae lv" href="https://swiftsenpai.com/development/uicollectionview-list-custom-cell/" rel="noopener ugc nofollow" target="_blank">UICollectionView</a><a class="ae lv" href="https://swiftsenpai.com/development/uicollectionview-list-custom-cell/" rel="noopener ugc nofollow" target="_blank"/><a class="ae lv" href="https://swiftsenpai.com/development/uicollectionview-list-custom-cell/" rel="noopener ugc nofollow" target="_blank">带有自定义单元格和自定义配置的列表</a></li><li id="f912" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://swiftsenpai.com/development/custom-uicollectionviewlistcell-in-ib/" rel="noopener ugc nofollow" target="_blank">在界面构建器中设计自定义UICollectionViewListCell</a></li><li id="da0d" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://swiftsenpai.com/development/collectionview-expandable-list-part1/" rel="noopener ugc nofollow" target="_blank">使用UICollectionView构建可扩展列表:第1部分</a></li><li id="59f3" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://swiftsenpai.com/development/collectionview-expandable-list-part2/" rel="noopener ugc nofollow" target="_blank">使用UICollectionView构建可扩展列表:第2部分</a></li><li id="aa66" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://swiftsenpai.com/development/modern-ways-reload-cells/" rel="noopener ugc nofollow" target="_blank">重新加载表格和集合视图单元格的现代方法</a></li><li id="4e0c" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://swiftsenpai.com/development/declarative-list-header-footer/" rel="noopener ugc nofollow" target="_blank">声明式UICollectionView列表页眉和页脚</a></li><li id="6df7" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://swiftsenpai.com/development/list-interactive-custom-header/" rel="noopener ugc nofollow" target="_blank">带有交互式自定义标题的UICollectionView列表</a></li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="64e5" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">包扎</h1><p id="998c" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">本文涉及的主题仅仅触及了使用<code class="fe ki kj kk kl b">UICollectionView</code>创建的列表的皮毛。还有其他更高级的主题，如多节列表、自定义单元格配置、单元格重新排序和可扩展单元格，我们尚未探索。</p><p id="dae1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想在我发表与这些主题相关的新文章时得到通知，请随时在<a class="ae lv" href="https://twitter.com/Lee_Kah_Seng" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我。</p><p id="2f72" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。🧑🏻‍💻</p><h1 id="9dd4" class="md me it bd mf mg pc mi mj mk pd mm mn jz pe ka mp kc pf kd mr kf pg kg mt mu bi translated">相关WWDC视频</h1><ul class=""><li id="ae84" class="nf ng it la b lb mv le mw lh oy ll oz lp pa lt pb nl nm nn bi translated"><a class="ae lv" href="https://developer.apple.com/videos/play/wwdc2020/10026/" rel="noopener ugc nofollow" target="_blank">UICollectionView中的列表</a></li><li id="a73c" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://developer.apple.com/videos/play/wwdc2020/10097/" rel="noopener ugc nofollow" target="_blank">UICollectionView的进展</a></li><li id="9762" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://developer.apple.com/videos/play/wwdc2020/10027/" rel="noopener ugc nofollow" target="_blank">现代细胞配置</a></li><li id="f708" class="nf ng it la b lb no le np lh nq ll nr lp ns lt pb nl nm nn bi translated"><a class="ae lv" href="https://developer.apple.com/videos/play/wwdc2019/220" rel="noopener ugc nofollow" target="_blank">UI数据源的进步</a></li></ul></div></div>    
</body>
</html>