<html>
<head>
<title>React Context API Step By Step</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逐步反应上下文API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-context-api-step-by-step-f1ee25d90c55?source=collection_archive---------5-----------------------#2021-08-22">https://levelup.gitconnected.com/react-context-api-step-by-step-f1ee25d90c55?source=collection_archive---------5-----------------------#2021-08-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a5e0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用一个示例应用程序在5分钟内学会</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c98a2565619b9d0db125ae86796e5a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_54xAc93WGeIuRZZ.png"/></div></div></figure><p id="f2c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我练习过的学习redux、states或framework等概念的最好方法之一就是边做边学。不是简单的盲目跟着一个教程走。首先，浏览文档或几个视频(但我首先建议在浏览视频之前阅读文档，因为即使是创建视频教程的人也要浏览文档并学习)。然后你可以用学习和逆向工程的概念建造一些东西，并学习它是如何真正工作的。</p><blockquote class="lq lr ls"><p id="c36f" class="ku kv lt kw b kx ky ju kz la lb jx lc lu le lf lg lv li lj lk lw lm ln lo lp im bi translated">如果你愿意支持我成为一名作家，考虑报名参加<a class="ae lx" href="https://freelancingcult.medium.com/membership" rel="noopener">成为</a>的媒体成员。这样我就可以花更多的时间来分享知识。每月只需5美元，你就可以无限制地使用Medium。</p></blockquote><blockquote class="ly"><p id="d247" class="lz ma it bd mb mc md me mf mg mh lp dk translated">“所以先阅读官方文档，然后通过构建和逆向工程来学习”</p></blockquote><div class="mi mj mk ml mm mn"><a href="https://reactjs.org/docs/context.html" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd iu gy z fp ms fr fs mt fu fw is bi translated">上下文反应</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">上下文提供了一种通过组件树传递数据的方法，而不必每次都手动传递属性</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">reactjs.org</p></div></div><div class="mw l"><div class="mx l my mz na mw nb ks mn"/></div></div></a></div><h2 id="1cd4" class="nc nd it bd ne nf ng dn nh ni nj dp nk ld nl nm nn lh no np nq ll nr ns nt nu bi translated">为什么我们需要上下文API</h2><p id="2e44" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">React主要处理组件和状态。React应用程序中有父组件和子组件。组件的父子关系创建了一个组件树。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/754e1c7b3b1aee82d85bb178a0b4f295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PwYBnKKnA_r-J1mf9xjhjg.png"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">反应组件树</figcaption></figure><p id="96f3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以很容易地通过props从上到下发送组件状态。例如，组件1中的状态可以很容易地发送到底部的组件。</p><p id="a81e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用props可以很容易地将组件3中的状态发送到组件6和7。同样，组件2中的状态可以很容易地传递给组件4和5。</p><p id="6e16" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是，如果组件6中的一个状态需要发送到组件4，该怎么办呢？我们必须将状态值从6提升到1，并使用props将状态传递到4。如果我们想要共享组件6和7之间的状态呢。这是一个耗时且乏味的过程，称为支柱钻孔。</p><p id="1a5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Propdrilling使您的应用程序更加复杂，更难调试。因此，一般来说，React开发人员不会进行适当的训练。</p><p id="1cc1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Context API是针对这种在组件之间传递属性的繁琐过程的解决方案。上下文API可以通过提供者-消费者对在组件之间传递数据，而不必传递props。使用上下文API，任何组件都可以轻松访问状态。提供者可以充当屋顶，因此屋顶下任何组件都可以使用它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/967d7a33b3305bdb466fbd5795ab6582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9C9uTGLWy-MX4GHzHJXFpQ.png"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">使用提供程序</figcaption></figure><p id="1b64" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">还有其他方法，比如使用Redux，但是Context API对于中小型应用来说更简单。使用像<code class="fe og oh oi oj b">useReducer</code>这样的钩子，我们可以摆脱像redux这样的第三方库。</p><h2 id="cd16" class="nc nd it bd ne nf ng dn nh ni nj dp nk ld nl nm nn lh no np nq ll nr ns nt nu bi translated">上下文API入门</h2><p id="dc01" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">要开始使用上下文API，您必须首先创建一个上下文。然后你可以把它提供给其他组件，然后使用它。</p><p id="8474" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将上下文API添加到您的应用程序时，主要的3种方法如下。</p><p id="b998" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 1。使用createContext创建上下文。</strong></p><p id="c49f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 2。使用创建的上下文包装React组件。</strong></p><p id="1dd5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 3。使用</strong> <code class="fe og oh oi oj b"><strong class="kw iu">useContext</strong></code> <strong class="kw iu">在组件内部消费创建的上下文。</strong></p><p id="2c91" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，让我们构建一个带有解释的示例项目，并通过我们构建的项目了解一下概念。</p><p id="3652" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最终代码</p><div class="ok ol gp gr om mn"><a href="https://replit.com/join/eguvurbvdk-lahirutech" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd iu gy z fp ms fr fs mt fu fw is bi translated">邀请在Replit上合作</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">使用Replit多人游戏一起编码</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">replit.com</p></div></div><div class="mw l"><div class="on l my mz na mw nb ks mn"/></div></div></a></div><p id="7d28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最初的项目将是一个非常简单的项目，您将在浏览器中呈现一个任务列表。</p><p id="26d5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">开始使用这个样板文件</p><div class="ok ol gp gr om mn"><a href="https://replit.com/join/kbfmxjnoju-lahirutech" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd iu gy z fp ms fr fs mt fu fw is bi translated">邀请在Replit上合作</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">使用Replit多人游戏一起编码</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">replit.com</p></div></div><div class="mw l"><div class="oo l my mz na mw nb ks mn"/></div></div></a></div><p id="ef23" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者在您的本地机器上创建一个新的React应用程序</p><pre class="kj kk kl km gt op oj oq or aw os bi"><span id="bfc6" class="nc nd it oj b gy ot ou l ov ow">npx create-react-app context-app</span></pre><p id="3864" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，让我们创建我们的<code class="fe og oh oi oj b">TaskList</code>组件。在src中创建一个名为components的文件夹，并添加这个文件<code class="fe og oh oi oj b">Tasklist.js</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><h1 id="d038" class="oz nd it bd ne pa pb pc nh pd pe pf nk jz pg ka nn kc ph kd nq kf pi kg nt pj bi translated">创造环境</h1><p id="125b" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">之后，让我们创建我们的上下文。在src文件夹中创建一个名为<code class="fe og oh oi oj b">contexts</code>的文件夹，并添加下面的文件<code class="fe og oh oi oj b">TaskContext.js</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="da9d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以看到我们已经从React导入了<code class="fe og oh oi oj b">createContext</code>和<code class="fe og oh oi oj b">useState</code>钩子。</p><p id="5935" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe og oh oi oj b">createContext</code>钩子启动一个名为<code class="fe og oh oi oj b">TaskContext </code>的上下文</p><pre class="kj kk kl km gt op oj oq or aw os bi"><span id="1720" class="nc nd it oj b gy ot ou l ov ow">export const TaskContext = createContext();</span></pre><p id="e4ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们已经创建了一个名为<code class="fe og oh oi oj b">TaskContextProvider</code>的功能组件。在里面，我们使用<code class="fe og oh oi oj b">useState </code>钩子定义了我们的状态。</p><pre class="kj kk kl km gt op oj oq or aw os bi"><span id="ce3a" class="nc nd it oj b gy ot ou l ov ow">const [tasks, taskList] = useState(<br/>  [<br/>   { title: 'Task 01', priority: 'Medium', id: 1 },        <br/>   { title: 'Task 02', priority: 'Medium', id: 2 },   <br/>  ]<br/>)</span></pre><div class="ok ol gp gr om mn"><a rel="noopener  ugc nofollow" target="_blank" href="/learn-react-usestate-hook-a09ccf955537"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd iu gy z fp ms fr fs mt fu fw is bi translated">学习反应使用状态挂钩</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">有例子和练习</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mw l"><div class="pk l my mz na mw nb ks mn"/></div></div></a></div><h2 id="40ae" class="nc nd it bd ne nf ng dn nh ni nj dp nk ld nl nm nn lh no np nq ll nr ns nt nu bi translated">添加提供程序</h2><p id="c841" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">在创建的上下文中，我们必须添加上下文提供者。</p><p id="4425" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们在<code class="fe og oh oi oj b">TaskContextProvider</code>组件的返回语句中添加了<code class="fe og oh oi oj b">TaskContext.Provider</code>。</p><pre class="kj kk kl km gt op oj oq or aw os bi"><span id="1f67" class="nc nd it oj b gy ot ou l ov ow">&lt;TaskContext.Provider value={{ tasks }}&gt;            <br/>  {props.children}     <br/> &lt;/TaskContext.Provider&gt;</span></pre><p id="00c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe og oh oi oj b">TaskContext.Provider</code>有一个名为value的属性，在这里我们可以发送在<code class="fe og oh oi oj b">TaskContextProvider</code>组件中定义的所有变量和函数(属性)。这里我们已经发送了<code class="fe og oh oi oj b">Task</code>变量。在本文的后面，你会清楚地知道组件的每个部分是如何工作的。</p><h2 id="cdf0" class="nc nd it bd ne nf ng dn nh ni nj dp nk ld nl nm nn lh no np nq ll nr ns nt nu bi translated">使相关组件可以访问上下文。</h2><p id="4a9a" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">为了利用创建的上下文，我们必须用上下文包装我们的组件。让我们在<code class="fe og oh oi oj b">App.js</code>文件中完成它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="eb7e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们已经在app.js文件中导入了<code class="fe og oh oi oj b">TaskContextProvider</code>,并包装了TaskList组件，如上所示。这使得从<code class="fe og oh oi oj b">TaskList</code>组件访问上下文值成为可能。</p><h2 id="40f2" class="nc nd it bd ne nf ng dn nh ni nj dp nk ld nl nm nn lh no np nq ll nr ns nt nu bi translated">在组件中使用上下文。</h2><p id="05c5" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">接下来是在组件内部使用创建的上下文。</p><p id="84b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了使用组件内部的上下文，我们必须导入<code class="fe og oh oi oj b">useContext </code>钩子。下面是我们如何在<code class="fe og oh oi oj b">TaskList </code>组件中使用<code class="fe og oh oi oj b">TaskContext</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="bf9a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以看到我们已经进口了<code class="fe og oh oi oj b">useContext</code>挂钩。通过将创建的上下文作为参数发送给<code class="fe og oh oi oj b">useContext</code>，我们已经成功访问了<code class="fe og oh oi oj b">TaskContext.</code>的属性</p><pre class="kj kk kl km gt op oj oq or aw os bi"><span id="2e1b" class="nc nd it oj b gy ot ou l ov ow">const { tasks } = useContext(TaskContext)</span></pre><p id="f97b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们使用了在<code class="fe og oh oi oj b">TaskList </code>组件的<code class="fe og oh oi oj b">TaskContext </code>中声明的任务列表</p><p id="1129" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果应用程序中的其他组件也需要使用<code class="fe og oh oi oj b">Task</code>状态，你必须用<code class="fe og oh oi oj b">TaskContextProvider</code>包装该组件并跨其使用。</p><p id="af30" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是如何使用上下文API跨组件创建和使用状态。</p><blockquote class="lq lr ls"><p id="12c5" class="ku kv lt kw b kx ky ju kz la lb jx lc lu le lf lg lv li lj lk lw lm ln lo lp im bi translated">我希望你喜欢读这篇文章。如果你愿意支持我作为一个作家和我花在分享知识上的时间，考虑注册<a class="ae lx" href="https://freelancingcult.medium.com/membership" rel="noopener">成为一个媒体成员</a>。每月只需5美元，你就可以无限制地使用Medium。</p></blockquote></div></div>    
</body>
</html>