<html>
<head>
<title>Installing Node.js 12 on z/OS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在z/OS上安装Node.js 12</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/installing-node-js-12-on-z-os-e5bf419826e6?source=collection_archive---------14-----------------------#2020-07-20">https://levelup.gitconnected.com/installing-node-js-12-on-z-os-e5bf419826e6?source=collection_archive---------14-----------------------#2020-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6d98" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Node.js是基于<a class="ae ko" href="https://v8.dev/" rel="noopener ugc nofollow" target="_blank"> Chrome的V8 JavaScript引擎</a>构建的JavaScript运行时。</p><p id="91f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，我将展示如何在z/OS上安装Node.js 12.18.0的最新版本，并且我们将使用Express framework创建一个简单的web服务器应用程序。</p><p id="4890" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Node.js被很多企业用来开发web应用和REST API服务。z/OS上的Node.js可以利用IBM Z上的数据和现有应用程序的协同定位，显著提高吞吐量并减少响应时间。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/d4dc5b01102c6d38eefb673ea156b0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KLFAndcuvaQ3uteqw_Qqkg.png"/></div></div></figure><h1 id="1888" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">下载软件包</h1><p id="05b4" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">z/OS的Node.js主页是https://www.ibm.com/products/sdk-nodejs-compiler-zos/<a class="ae ko" href="https://www.ibm.com/products/sdk-nodejs-compiler-zos/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="7998" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有三种方法可以开始。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi me"><img src="../Images/65734f91134bd5805641d863c0fcd23d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JAH1zVDDrFLWjrFS_1rBkg.png"/></div></div></figure><p id="e9a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用PAX版本，它非常适合在您的系统上尝试Node.js。</p><p id="7309" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它是免费的。IBM为SMP/E版本提供的可选订阅和支持(S&amp;S)。</p><p id="0891" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Node.js应用程序不符合IBM z Integrated Information Processor(zIIP)标准。但是，当作为批准的新应用程序解决方案的一部分进行部署时，您可以使用量身定制的定价新应用程序解决方案来隔离Node.js工作负载，而不会影响现有工作负载的MLC成本。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mf"><img src="../Images/4dbaf15adb01290b3c87274cc3a84a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6p0emfUaUPSIvZeM1gpIuA.png"/></div></div></figure><p id="e3f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">按<strong class="js iu">立即下载</strong>并登录。选择v12文件并将其下载到您的计算机上。z/OS之外的Node.js的最新LTS版本是12.18.2，所以z/OS上的Node.js只差两个次要版本。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mg"><img src="../Images/35fcee7e97406e4e508372fb53e9ad3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lTxtaiPmEWNsU7Axw4TsHA.png"/></div></div></figure><h1 id="9c65" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为Node.js创建zFS文件系统</h1><p id="1e37" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">建议为Node.js分配一个新的zFS文件系统。您可以使用以下作业模板，用您的作业卡替换<code class="fe mh mi mj mk b">${jobcard}</code>和<code class="fe mh mi mj mk b">${prefix}</code>变量，用zFS文件系统替换数据集的前缀。</p><p id="9bf8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">在z/OS上创建zFS文件系统的JCL:</strong></p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="8963" class="mp lc it mk b gy mq mr l ms mt">${jobcard}<br/>//DEFINE EXEC PGM=IDCAMS<br/>//SYSPRINT DD SYSOUT=*<br/>//SYSIN DD *<br/>  DEFINE CLUSTER (NAME(${prefix}.ZFS) -<br/>    LINEAR -<br/>    TRACKS(40000 40000) -<br/>    SHAREOPTIONS(3))<br/>//CREATE EXEC PGM=IOEFSUTL,REGION=0M,COND=(0,LT),<br/>//  PARM=('format -aggregate ${prefix}.ZFS')<br/>//SYSPRINT DD SYSOUT=*</span></pre><p id="e607" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在您喜欢的文本编辑器中编辑文件并替换变量。有关参数的更多详细信息，请参见<a class="ae ko" href="https://www.ibm.com/support/knowledgecenter/SSLTBW_2.4.0/com.ibm.zos.v2r4.idai200/defclu.htm" rel="noopener ugc nofollow" target="_blank">定义集群</a>。</p><p id="0cda" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后您可以提交它并使用<a class="ae ko" href="https://github.com/zowe/zowe-cli#zowe-cli--" rel="noopener ugc nofollow" target="_blank"> Zowe CLI </a>检查它的状态:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="5edb" class="mp lc it mk b gy mq mr l ms mt">$ zowe zos-jobs submit local-file create_zfs.jcl<br/>jobid:   JOB41333<br/>retcode: null<br/>jobname: PLAPE03Z<br/>status:  ACTIVE</span><span id="50ee" class="mp lc it mk b gy mu mr l ms mt">$ zowe zos-jobs view job-status-by-jobid JOB41333<br/>jobid: JOB41333<br/>retcode: CC 0000<br/>jobname: PLAPE03Z<br/>status: OUTPUT</span></pre><p id="6e35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">0000返回代码意味着zFS已分配，我们需要使用SSH或telnet登录到z/OS，然后发出以下命令来挂载zFS文件系统:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="2aa5" class="mp lc it mk b gy mq mr l ms mt">export NODE_DIR=<strong class="mk iu"><em class="mv">{node_dir}</em></strong><br/>mkdir ${NODE_DIR}<br/>/usr/sbin/mount -f <strong class="mk iu"><em class="mv">{prefix}</em></strong>.ZFS ${NODE_DIR}<br/>cd ${NODE_DIR}<br/>mkdir downloads</span></pre><h1 id="a2cd" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在z/OS上安装</h1><p id="d79a" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我们有一个很大的文件系统，所以我们可以使用Zowe CLI上传Node.js包:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="4c27" class="mp lc it mk b gy mq mr l ms mt">zowe zos-files upload file-to-uss --binary ibm-node-v12.18.0-os390-s390x.pax.Z <strong class="mk iu"><em class="mv">{node_dir}</em></strong>/downloads/ibm-node-v12.18.0-os390-s390x.pax.Z</span></pre><p id="6094" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在z/OS shell中:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="334d" class="mp lc it mk b gy mq mr l ms mt">cd <strong class="mk iu"><em class="mv">{node_dir}</em></strong><br/>pax -rzf downloads/ibm-node-v12.18.0-os390-s390x.pax.Z -p p</span></pre><p id="72df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们创建一个为Node.js设置环境的文件。键入<code class="fe mh mi mj mk b">vi nodeenv.sh</code>并在其中插入(按<code class="fe mh mi mj mk b">i</code>然后<em class="mv"> Ctrl/Cmd+V </em>)以下几行:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="76ed" class="mp lc it mk b gy mq mr l ms mt">export NODE_DIR=<strong class="mk iu"><em class="mv">{node_dir}<br/></em></strong>export _BPXK_AUTOCVT=ON<br/>export _CEE_RUNOPTS="FILETAG(AUTOCVT,AUTOTAG) POSIX(ON)"<br/>export PATH=${NODE_DIR}/node-v12.18.0-os390-s390x/bin/:$PATH</span></pre><p id="2815" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">保存并离开Vi ( <code class="fe mh mi mj mk b">:wq</code>)后，您激活环境:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="b34f" class="mp lc it mk b gy mq mr l ms mt">. nodeenv.sh</span></pre><p id="0175" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们测试一下安装:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="8e32" class="mp lc it mk b gy mq mr l ms mt">$ node -v; npm version; npx -v<br/>12.18.0<br/>{<br/>  npm: '6.14.4',<br/>  ares: '1.16.0',<br/>  brotli: '1.0.7',<br/>  cldr: '37.0',<br/>  http_parser: '2.9.3',<br/>  icu: '67.1',<br/>  llhttp: '2.0.4',<br/>  modules: '72',<br/>  napi: '6',<br/>  nghttp2: '1.41.0',<br/>  node: '12.18.0',<br/>  openssl: '1.1.1g',<br/>  tz: '2019c',<br/>  unicode: '13.0',<br/>  uv: '1.37.0',<br/>  v8: '7.8.279.23-node.37',<br/>  zlib: '1.2.11'<br/>}<br/>6.14.4</span></pre><p id="49cb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您已经将Node.js安装到z/OS。这个安装可以很好地运行JavaScript程序，但是我们跳过了在z/OS上安装Node.js的C/C++编译器。这是用本机代码构建扩展所需要的。我们将在另一个故事中讲述它。</p><p id="fb20" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以在<a class="ae ko" href="https://www.ibm.com/support/knowledgecenter/SSTRRS_12.0.0/com.ibm.nodejs.zos.v12.doc/welcome.html" rel="noopener ugc nofollow" target="_blank">https://www . IBM . com/support/knowledge center/sstr RS _ 12 . 0 . 0/com . IBM . nodejs . zos . v 12 . doc/welcome . html</a>找到Node.js for z/OS文档。</p><h1 id="f0a8" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单HTTP服务器</h1><p id="6368" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">让我们使用<a class="ae ko" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>框架开发一个简单的服务。</p><p id="9d6f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">登录到z/OS UNIX会话，启动一个空项目并在其中安装Express:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="1b39" class="mp lc it mk b gy mq mr l ms mt">mkdir server<br/>cd server<br/>npm init -f<br/>npm install express --save</span></pre><p id="a2b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要创建一个ASCII编码的源代码文件:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="cdc6" class="mp lc it mk b gy mq mr l ms mt">touch index.js<br/>chtag -t -c ISO8859-1 index.js<br/>vi index.js</span></pre><p id="7d3c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有以下内容。您应该将端口更改为可用的端口:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="2992" class="mp lc it mk b gy mq mr l ms mt">const express = require('express')<br/>const app = express()<br/>const port = 10055<br/>app.get('/', (req, res) =&gt; res.send('Hello, world!'))<br/>app.listen(port, () =&gt; console.log(`Example app listening on port ${port}!`))</span></pre><p id="a50d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以启动它，看看它是否绑定到端口:</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="7610" class="mp lc it mk b gy mq mr l ms mt">$ node index.js<br/>Example app listening on port 10055!</span></pre><p id="0277" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以使用HTTP客户端连接到它(例如<a class="ae ko" href="https://httpie.org/" rel="noopener ugc nofollow" target="_blank"> HTTPie </a>):</p><pre class="kq kr ks kt gt ml mk mm mn aw mo bi"><span id="8b31" class="mp lc it mk b gy mq mr l ms mt">http GET "<a class="ae ko" href="http://ca32.lvn.broadcom.net:10055/" rel="noopener ugc nofollow" target="_blank">http://ca32.lvn.broadcom.net:10055/</a>"                                                                          </span><span id="3093" class="mp lc it mk b gy mu mr l ms mt">HTTP/1.1 200 OK<br/>Connection: keep-alive<br/>Content-Length: 13<br/>Content-Type: text/html; charset=utf-8<br/>Date: Mon, 20 Jul 2020 07:33:45 GMT<br/>ETag: W/"c-Lve95gjOVATpfV8EL5X4nxwjKHE"<br/>X-Powered-By: Express</span><span id="a7c7" class="mp lc it mk b gy mu mr l ms mt">Hello, world!</span></pre><h1 id="df29" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">摘要</h1><p id="e4aa" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">Node.js很容易安装在z/OS上，Linux很容易安装在System z上。在这两个平台上，它都使用ASCII，所以当您在Node.js中开发应用程序时，您不需要与EBCDIC斗争。</p><p id="2ea0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下一个故事中，我们将安装安装和构建Node.js的本地扩展所需的C++编译器。我们将回顾现有的z/OS特定的可用扩展。</p></div></div>    
</body>
</html>