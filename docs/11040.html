<html>
<head>
<title>How to Write Performant React Apps with Context</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨ä¸Šä¸‹æ–‡ç¼–å†™é«˜æ€§èƒ½çš„ååº”åº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/how-to-write-performant-react-apps-with-context-83b27756c6a0?source=collection_archive---------2-----------------------#2022-02-10">https://levelup.gitconnected.com/how-to-write-performant-react-apps-with-context-83b27756c6a0?source=collection_archive---------2-----------------------#2022-02-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5ebed750133f1f2229806b44c0bd1891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kFZjeqq9u_1nvVcvF_d5Yg.png"/></div></div></figure><p id="d273" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ²¡æœ‰ä¸€ä¸¤ç¯‡å…³äºä¸Šä¸‹æ–‡çš„æ–‡ç« ï¼Œå°±ä¸å¯èƒ½æœ‰å…³äº<a class="ae kw" href="https://www.developerway.com/posts/how-to-write-performant-react-code" rel="noopener ugc nofollow" target="_blank">å¦‚ä½•ç¼–å†™performant Reactä»£ç </a>çš„å¯¹è¯ã€‚è€Œä¸”æ˜¯è¿™ä¹ˆæœ‰äº‰è®®çš„è¯é¢˜ï¼æœ‰å¾ˆå¤šåè§å’Œè°£è¨€å›´ç»•ç€å®ƒã€‚ä¸Šä¸‹æ–‡æ˜¯é‚ªæ¶çš„ï¼ä½¿ç”¨ä¸Šä¸‹æ–‡æ—¶ï¼ŒReactä¼šæ¯«æ— ç†ç”±åœ°é‡æ–°æ¸²æŸ“æ‰€æœ‰å†…å®¹ï¼æœ‰æ—¶å€™æˆ‘è§‰å¾—å¼€å‘è€…æŠŠä¸Šä¸‹æ–‡å½“æˆäº†ä¸€ä¸ªç¥å¥‡çš„å°ç²¾çµï¼Œéšæœºåœ°ã€è‡ªå‘åœ°é‡æ–°æ¸²æŸ“æ•´ä¸ªåº”ç”¨ç¨‹åºæ¥å¨±ä¹è‡ªå·±ã€‚</p><p id="71b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸æ‰“ç®—è¯´æœä»»ä½•äººæˆ‘ä»¬åº”è¯¥æŠ›å¼ƒæˆ‘ä»¬é’Ÿçˆ±çš„å›½å®¶ç®¡ç†åº“è€Œæ”¯æŒä¸Šä¸‹æ–‡ã€‚ä»–ä»¬çš„å­˜åœ¨æ˜¯æœ‰åŸå› çš„ã€‚è¿™é‡Œçš„ä¸»è¦ç›®æ ‡æ˜¯æ¶ˆé™¤ä¸Šä¸‹æ–‡çš„ç¥ç§˜æ„Ÿï¼Œå¹¶æä¾›ä¸€äº›æœ‰è¶£çš„ç¼–ç æ¨¡å¼ï¼Œè¿™å¯ä»¥å¸®åŠ©æœ€å°åŒ–ä¸ä¸Šä¸‹æ–‡ç›¸å…³çš„é‡æ–°æ¸²æŸ“ï¼Œå¹¶æé«˜Reactåº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚è¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œä»£ç çœ‹èµ·æ¥æ›´å¹²å‡€ï¼Œæ›´å®¹æ˜“ç†è§£ã€‚</p><p id="b1c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è®©æˆ‘ä»¬é€šè¿‡å®ç°ä¸€äº›ç°å®ç”Ÿæ´»ä¸­çš„åº”ç”¨ç¨‹åºæ¥å¼€å§‹è°ƒæŸ¥ï¼Œçœ‹çœ‹è¿™ä¼šæŠŠæˆ‘ä»¬å¸¦åˆ°å“ªé‡Œã€‚</p><h1 id="604f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">è®©æˆ‘ä»¬åœ¨Reactä¸­å®ç°ä¸€ä¸ªè¡¨å•</h1><p id="cdfa" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">æˆ‘ä»¬çš„å½¢å¼å°†ä¼šéå¸¸å¤æ‚ï¼Œé¦–å…ˆï¼Œå®ƒå°†åŒ…æ‹¬:</p><ul class=""><li id="a3d1" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">â€œä¸ªäººä¿¡æ¯â€éƒ¨åˆ†ï¼Œäººä»¬å¯ä»¥è®¾ç½®ä¸€äº›ä¸ªäººä¿¡æ¯ï¼Œå¦‚å§“åï¼Œç”µå­é‚®ä»¶ç­‰</li><li id="0b2e" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">ä¸€ä¸ªâ€œä»·å€¼è®¡ç®—â€éƒ¨åˆ†ï¼Œäººä»¬å¯ä»¥è®¾ç½®ä»–ä»¬çš„è´§å¸åå¥½ï¼Œä»–ä»¬å–œæ¬¢çš„æŠ˜æ‰£ï¼Œæ·»åŠ ä¸€äº›ä¼˜æƒ åˆ¸ç­‰</li><li id="bc9d" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">é€‰æ‹©çš„æŠ˜æ‰£åº”è¯¥ä»¥è¡¨æƒ…ç¬¦å·çš„å½¢å¼åœ¨ä¸ªäººéƒ¨åˆ†çªå‡ºæ˜¾ç¤º(ä¸è¦é—®ï¼Œè®¾è®¡å¸ˆæœ‰ä¸€ç§å¥‡æ€ªçš„å¹½é»˜æ„Ÿ)</li><li id="ed29" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">å¸¦æœ‰æ“ä½œæŒ‰é’®çš„â€œæ“ä½œâ€éƒ¨åˆ†(å³â€œä¿å­˜â€ã€â€œé‡ç½®â€ç­‰)</li></ul><p id="a9da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">â€œè®¾è®¡â€çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/52add024ccda6abbc00c8910f8ca8c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pgWgliNW3rcaD4Nt.png"/></div></div></figure><p id="68f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†è®©äº‹æƒ…å˜å¾—æ›´æœ‰è¶£ï¼Œæˆ‘ä»¬è¿˜å°†å‡è£…â€œé€‰æ‹©å›½å®¶â€å’Œâ€œæ‹–åŠ¨æ â€ç»„ä»¶æ˜¯æˆ‘ä»¬ä½œä¸ºä¸€ä¸ªåŒ…å®‰è£…çš„â€œå¤–éƒ¨â€åº“ã€‚æ‰€ä»¥æˆ‘ä»¬åªèƒ½é€šè¿‡APIæ¥ä½¿ç”¨å®ƒä»¬ï¼Œè€Œå¯¹é‡Œé¢çš„ä¸œè¥¿æ²¡æœ‰ä»»ä½•å½±å“ã€‚æˆ‘ä»¬å°†ä½¿ç”¨â€œæ…¢é€Ÿâ€ç‰ˆæœ¬çš„å›½å®¶é€‰æ‹©ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨<a class="ae kw" href="https://www.developerway.com/posts/how-to-write-performant-react-code" rel="noopener ugc nofollow" target="_blank">ä¹‹å‰çš„ç»©æ•ˆè°ƒæŸ¥</a>ä¸­å®æ–½çš„ã€‚</p><p id="0437" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨æ˜¯æ—¶å€™å†™ä¸€äº›ä»£ç äº†ã€‚å…ˆè¯´appçš„ç»„ä»¶ç»“æ„ã€‚æˆ‘çŸ¥é“è¿™ä¸ªè¡¨å•å¾ˆå¿«ä¼šå˜å¾—éå¸¸å¤æ‚ï¼Œæ‰€ä»¥æˆ‘æƒ³é©¬ä¸ŠæŠŠå®ƒåˆ†æˆæ›´å°ã€æ›´åŒ…å®¹çš„ç»„ä»¶ã€‚</p><p id="2fe2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨æ ¹å¤„ï¼Œæˆ‘å°†æ‹¥æœ‰æˆ‘çš„ä¸»<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶ï¼Œå®ƒå°†å‘ˆç°ä¸‰ä¸ªå¿…éœ€çš„éƒ¨åˆ†:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="7f10" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const Form = () =&gt; {<br/>  return (<br/>    &lt;&gt;<br/>      &lt;PersonalInfoSection /&gt;<br/>      &lt;ValueCalculationsSection /&gt;<br/>      &lt;ActionsSection /&gt;<br/>    &lt;/&gt;<br/>  );<br/>};</em></span></pre><p id="f0c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">â€œä¸ªäººä¿¡æ¯â€éƒ¨åˆ†å°†å‘ˆç°ä¸‰ä¸ªç»„ä»¶:æŠ˜æ‰£è¡¨æƒ…ç¬¦å·ã€å§“åè¾“å…¥å’Œå›½å®¶é€‰æ‹©</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="a7fd" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const PersonalInfoSection = () =&gt; {<br/>  return (<br/>    &lt;Section title="Personal information"&gt;<br/>      &lt;DiscountSituation /&gt;<br/>      &lt;NameFormComponent /&gt;<br/>      &lt;SelectCountryFormComponent /&gt;<br/>    &lt;/Section&gt;<br/>  );<br/>};</em></span></pre><p id="9a31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å®ƒä»¬ä¸‰ä¸ªéƒ½å°†åŒ…å«é‚£äº›ç»„ä»¶çš„å®é™…é€»è¾‘(å®ƒä»¬çš„ä»£ç å°†åœ¨ä¸‹é¢)ï¼Œè€Œ<code class="fe mt mu mv mw b">Section</code>åªæ˜¯å°è£…äº†ä¸€äº›æ ·å¼ã€‚</p><p id="01f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">â€œä»·å€¼è®¡ç®—â€éƒ¨åˆ†åªæœ‰ä¸€ä¸ªç»„ä»¶(ç›®å‰)ï¼ŒæŠ˜æ‰£æ :</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="f3d6" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const ValueCalculationSection = () =&gt; {<br/>  return (<br/>    &lt;Section title="Value calculation"&gt;<br/>      &lt;DiscountFormComponent /&gt;<br/>    &lt;/Section&gt;<br/>  );<br/>};</em></span></pre><p id="a29d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">â€œActionsâ€éƒ¨åˆ†ç°åœ¨ä¹Ÿåªæœ‰ä¸€ä¸ªæŒ‰é’®:å¸¦æœ‰onSaveå›è°ƒçš„saveæŒ‰é’®ã€‚</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="c490" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const ActionsSection = ({ onSave }: { onSave: () =&gt; void }) =&gt; {<br/>  return (<br/>    &lt;Section title="Actions"&gt;<br/>      &lt;button onClick={onClick}&gt;Save form&lt;/button&gt;<br/>    &lt;/Section&gt;<br/>  );<br/>};</em></span></pre><p id="d1b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨æœ‰è¶£çš„éƒ¨åˆ†æ˜¯:æˆ‘ä»¬éœ€è¦ä½¿è¿™ä¸ªè¡¨å•å…·æœ‰äº¤äº’æ€§ã€‚è€ƒè™‘åˆ°æ•´ä¸ªè¡¨å•åªæœ‰ä¸€ä¸ªâ€œä¿å­˜â€æŒ‰é’®ï¼Œè€Œä¸”ä¸åŒçš„éƒ¨åˆ†éœ€è¦æ¥è‡ªå…¶ä»–éƒ¨åˆ†çš„æ•°æ®ï¼ŒçŠ¶æ€ç®¡ç†çš„è‡ªç„¶ä½ç½®æ˜¯åœ¨æ ¹ï¼Œåœ¨<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶ä¸­ã€‚æˆ‘ä»¬å°†æœ‰3ä¸ªæ•°æ®:å§“åã€å›½å®¶å’ŒæŠ˜æ‰£ï¼Œä¸€ä¸ªè®¾ç½®è¿™ä¸‰ä¸ªæ•°æ®çš„æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªâ€œä¿å­˜â€å®ƒçš„æ–¹æ³•:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="b6b9" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">type State = {<br/>  name: string;<br/>  country: Country;<br/>  discount: number;<br/>};<br/><br/>const Form = () =&gt; {<br/>  const [state, setState] = useState&lt;State&gt;(defaultState as State);<br/><br/>  const onSave = () =&gt; {<br/>    // send the request to the backend here<br/>  };<br/><br/>  const onDiscountChange = (discount: number) =&gt; {<br/>    setState({ ...state, discount });<br/>  };<br/><br/>  const onNameChange = (name: string) =&gt; {<br/>    setState({ ...state, name });<br/>  };<br/><br/>  const onCountryChange = (country: Country) =&gt; {<br/>    setState({ ...state, country });<br/>  };<br/><br/>  // the rest as before<br/>};</em></span></pre><p id="0532" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨æˆ‘ä»¬éœ€è¦å°†ç›¸å…³æ•°æ®å’Œå›è°ƒä¼ é€’ç»™éœ€è¦å®ƒçš„ç»„ä»¶ã€‚åœ¨æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">PersonalInfoSection</code>:</p><ul class=""><li id="5eb3" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated"><code class="fe mt mu mv mw b">DiscountSituation</code>ç»„ä»¶åº”è¯¥èƒ½å¤Ÿæ˜¾ç¤ºåŸºäº<code class="fe mt mu mv mw b">discount</code>å€¼çš„è¡¨æƒ…ç¬¦å·ã€‚</li><li id="6a9c" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated"><code class="fe mt mu mv mw b">NameFormComponent</code>åº”è¯¥å¯ä»¥æ§åˆ¶<code class="fe mt mu mv mw b">name</code>çš„å€¼</li><li id="7111" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated"><code class="fe mt mu mv mw b">SelectCountryFormComponent</code>åº”èƒ½è®¾ç½®æ‰€é€‰çš„<code class="fe mt mu mv mw b">country</code></li></ul><p id="23f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è€ƒè™‘åˆ°è¿™äº›ç»„ä»¶æ²¡æœ‰ç›´æ¥åœ¨<code class="fe mt mu mv mw b">Form</code>ä¸­å‘ˆç°ï¼Œè€Œæ˜¯<code class="fe mt mu mv mw b">PersonalInfoSection</code>çš„å­ç»„ä»¶ï¼Œæ˜¯æ—¶å€™åšä¸€äº›é“å…·ç»ƒä¹ äº†ğŸ˜Š</p><p id="2520" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mt mu mv mw b">DiscountSituation</code>ä¼šæ¥å—<code class="fe mt mu mv mw b">discount</code>ä½œä¸ºé“å…·:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="57f8" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const DiscountSituation = ({ discount }: { discount: number }) =&gt; {<br/>  // some code to calculate the situation based on discount<br/>  const discountSituation = ...;<br/>  return &lt;div&gt;Your discount situation: {discountSituation}&lt;/div&gt;;<br/>};</em></span></pre><p id="9a8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mt mu mv mw b">NameFormComponent</code>å°†æ¥å—<code class="fe mt mu mv mw b">name</code>å’Œ<code class="fe mt mu mv mw b">onChange</code>çš„å›è°ƒ:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="d349" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const NameFormComponent = ({ onChange, name }: { onChange: (val: string) =&gt; void; name: string }) =&gt; {<br/>  return (<br/>    &lt;div&gt;<br/>      Type your name here: &lt;br /&gt;<br/>      &lt;input onChange={() =&gt; onChange(e.target.value)} value={name} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</em></span></pre><p id="b275" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mt mu mv mw b">SelectCountryFormComponent</code>å°†æ¥å—<code class="fe mt mu mv mw b">onChange</code>çš„å›è°ƒ:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="396e" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const SelectCountryFormComponent = ({ onChange }: { onChange: (country: Country) =&gt; void }) =&gt; {<br/>  return &lt;SelectCountry onChange={onChange} /&gt;;<br/>};</em></span></pre><p id="0e82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">PersonalInfoSection</code>å¿…é¡»å°†å®ƒä»¬ä»å…¶çˆ¶<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶ä¼ é€’ç»™å…¶å­ç»„ä»¶:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="7f1b" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const PersonalInfoSection = ({<br/>  onNameChange,<br/>  onCountryChange,<br/>  discount,<br/>  name,<br/>}: {<br/>  onNameChange: (name: string) =&gt; void;<br/>  onCountryChange: (name: Country) =&gt; void;<br/>  discount: number;<br/>  name: string;<br/>}) =&gt; {<br/>  return (<br/>    &lt;Section title="Personal information"&gt;<br/>      &lt;DiscountSituation discount={discount} /&gt;<br/>      &lt;NameFormComponent onChange={onNameChange} name={name} /&gt;<br/>      &lt;SelectCountryFormComponent onChange={onCountryChange} /&gt;<br/>    &lt;/Section&gt;<br/>  );<br/>};</em></span></pre><p id="fcf5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸<code class="fe mt mu mv mw b">ValueCalculationSection</code>çš„æƒ…å†µç›¸åŒï¼›å®ƒéœ€è¦å°†<code class="fe mt mu mv mw b">onDiscountChange</code>å’Œ<code class="fe mt mu mv mw b">discount</code>çš„å€¼ä»<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶ä¼ é€’ç»™å…¶å­ç»„ä»¶ï¼›</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="28c2" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const ValueCalculationsSection = ({ onDiscountChange }: { onDiscountChange: (val: number) =&gt; void }) =&gt; {<br/>  console.info('ValueCalculationsSection render');<br/>  return (<br/>    &lt;Section title="Value calculation"&gt;<br/>      &lt;DiscountFormComponent onDiscountChange={onDiscountChange} /&gt;<br/>    &lt;/Section&gt;<br/>  );<br/>};</em></span></pre><p id="683b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è€Œ<code class="fe mt mu mv mw b">DiscountFormComponent</code>åªæ˜¯ä½¿ç”¨â€œå¤–éƒ¨â€åº“<code class="fe mt mu mv mw b">DraggingBar</code>æ¥å‘ˆç°å·¥å…·æ¡ï¼Œå¹¶é€šè¿‡å®ƒç»™å‡ºçš„å›è°ƒæ¥æ•æ‰å˜åŒ–:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="c806" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const DiscountFormComponent = ({ onDiscountChange }: { onDiscountChange: (value: number) =&gt; void }) =&gt; {<br/>  console.info('DiscountFormComponent render');<br/>  return (<br/>    &lt;div&gt;<br/>      Please select your discount here: &lt;br /&gt;<br/>      &lt;DraggingBar onChange={(value: number) =&gt; onDiscountChange(value)} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</em></span></pre><p id="9b3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¹¶ä¸”ï¼Œæˆ‘ä»¬çš„<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶çš„æ¸²æŸ“çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="c1e7" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const Form = () =&gt; {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;PersonalInfoSection onNameChange={onNameChange} onCountryChange={onCountryChange} discount={state.discount} name={state.name} /&gt;<br/>      &lt;ValueCalculationsSection onDiscountChange={onDiscountChange} /&gt;<br/>      &lt;ActionsSection onSave={onSave} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</em></span></pre><p id="4101" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç›¸å½“å¤šçš„ä»£ç ï¼Œä½†æœ€ç»ˆå®Œæˆäº†ğŸ˜…æƒ³çœ‹çœ‹ç»“æœå—ï¼Ÿ<a class="ae kw" href="https://codesandbox.io/s/form-initial-implementation-uxw8v?file=/src/App.tsx" rel="noopener ugc nofollow" target="_blank">å‚è§codesandboxã€‚</a></p><p id="239b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸å¹¸çš„æ˜¯ï¼Œç”±å‡ ä¸ªç»„ä»¶å’Œä¸€ä¸ªç®€å•çš„çŠ¶æ€ç»„æˆçš„ç»“æœæ¯”æ‚¨é¢„æœŸçš„è¦ç³Ÿç³•å¾—å¤šğŸ˜•è¯•ç€åœ¨è¾“å…¥ä¸­è¾“å…¥ä½ çš„åå­—ï¼Œæˆ–è€…æ‹–åŠ¨è“è‰²æ¡â€”â€”è¿™ä¸¤ç§æ–¹å¼å³ä½¿åœ¨å¿«é€Ÿçš„ç¬”è®°æœ¬ç”µè„‘ä¸Šä¹Ÿä¼šæ»åã€‚ç”±äºCPUèŠ‚æµï¼Œå®ƒä»¬åŸºæœ¬ä¸Šæ˜¯ä¸å¯ç”¨çš„ã€‚å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ</p><h1 id="4f75" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">å‰ç»©æ•ˆè°ƒæŸ¥</h1><p id="9d26" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é‚£é‡Œçš„æ§åˆ¶å°è¾“å‡ºã€‚å¦‚æœæˆ‘åœ¨<code class="fe mt mu mv mw b">Name</code>è¾“å…¥ä¸­é”®å…¥ä¸€ä¸ªé”®ï¼Œæˆ‘ä¼šçœ‹åˆ°:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="05cf" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">Form render<br/>PersonalInfoSection render<br/>Section render<br/>Discount situation render<br/>NameFormComponent render<br/>SelectCountryFormComponent render<br/>ValueCalculationsSection render<br/>Section render<br/>DiscountFormComponent render<br/>ActionsSection render<br/>Section render</em></span></pre><p id="9359" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘ä»¬è¡¨å•ä¸­çš„æ¯ä¸€ä¸ªç»„ä»¶éƒ½ä¼šåœ¨æ¯æ¬¡å‡»é”®æ—¶é‡æ–°å‘ˆç°ï¼æ‹–åŠ¨ä¹Ÿæ˜¯åŒæ ·çš„æƒ…å†µâ€”â€”æ¯ç§»åŠ¨ä¸€æ¬¡é¼ æ ‡ï¼Œæ•´ä¸ªè¡¨å•åŠå…¶æ‰€æœ‰ç»„ä»¶éƒ½ä¼šé‡æ–°å‘ˆç°ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œæˆ‘ä»¬çš„<code class="fe mt mu mv mw b">SelectCountryFormComponent</code>éå¸¸æ…¢ï¼Œæˆ‘ä»¬å¯¹å®ƒçš„æ€§èƒ½æ— èƒ½ä¸ºåŠ›ã€‚æ‰€ä»¥æˆ‘ä»¬å”¯ä¸€èƒ½åšçš„å°±æ˜¯ç¡®ä¿å®ƒä¸ä¼šåœ¨æ¯æ¬¡æŒ‰é”®æˆ–é¼ æ ‡ç§»åŠ¨æ—¶é‡æ–°å‘ˆç°ã€‚</p><p id="18ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘ä»¬çŸ¥é“ï¼Œç»„ä»¶ä¼šåœ¨ä»¥ä¸‹æƒ…å†µä¸‹é‡æ–°å‘ˆç°:</p><ul class=""><li id="acbf" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">ç»„ä»¶çš„çŠ¶æ€å·²æ›´æ”¹</li><li id="b271" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“</li></ul><p id="aba8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™æ­£æ˜¯è¿™é‡Œå‘ç”Ÿçš„äº‹æƒ…:å½“è¾“å…¥ä¸­çš„å€¼æ”¹å˜æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡å›è°ƒé“¾å°†è¯¥å€¼å‘ä¸Šä¼ æ’­åˆ°æ ¹<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬æ”¹å˜æ ¹çŠ¶æ€ï¼Œè¿™è§¦å‘äº†<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶çš„é‡æ–°å‘ˆç°ï¼Œç„¶åå‘ä¸‹çº§è”åˆ°è¯¥ç»„ä»¶çš„æ¯ä¸ªå­ç»„ä»¶å’Œå­ç»„ä»¶çš„å­ç»„ä»¶(å³æ‰€æœ‰å­ç»„ä»¶)ã€‚</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/5891d5babe86e1bf2e0cce51310d0adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kk9WPt-OV4tzU05s.png"/></div></div></figure><p id="cab3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥åœ¨æˆ˜ç•¥ä½ç½®æ’’ä¸€äº›<code class="fe mt mu mv mw b">useMemo</code>å’Œ<code class="fe mt mu mv mw b">useCallback</code>ï¼Œç„¶åå°±åˆ°æ­¤ä¸ºæ­¢ã€‚ä½†è¿™åªæ˜¯æ©ç›–äº†é—®é¢˜ï¼Œå¹¶æ²¡æœ‰çœŸæ­£è§£å†³é—®é¢˜ã€‚å½“å°†æ¥æˆ‘ä»¬å¼•å…¥å¦ä¸€ä¸ªæ…¢ç»„ä»¶æ—¶ï¼Œè¿™ä¸ªæ•…äº‹å°†ä¼šé‡æ¼”ã€‚æ›´ä¸ç”¨è¯´è¿™ä¼šä½¿ä»£ç å˜å¾—æ›´åŠ å¤æ‚å’Œéš¾ä»¥ç»´æŠ¤ã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œå½“æˆ‘åœ¨<code class="fe mt mu mv mw b">Name</code>ç»„ä»¶ä¸­é”®å…¥ä¸€äº›å†…å®¹æ—¶ï¼Œæˆ‘åªå¸Œæœ›<code class="fe mt mu mv mw b">NameFormComponent</code>å’Œå®é™…ä½¿ç”¨<code class="fe mt mu mv mw b">name</code>å€¼çš„ç»„ä»¶é‡æ–°å‘ˆç°ï¼Œå…¶ä½™çš„åº”è¯¥åªæ˜¯é—²ç½®åœ¨é‚£é‡Œï¼Œç­‰å¾…è½®åˆ°å®ƒä»¬è¿›è¡Œäº¤äº’ã€‚</p><p id="6f4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Reactå®é™…ä¸Šç»™äº†æˆ‘ä»¬ä¸€ä¸ªå®Œç¾çš„å·¥å…·æ¥åšåˆ°è¿™ä¸€ç‚¹â€”â€”<code class="fe mt mu mv mw b">Context</code>ï¼</p><h1 id="5614" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">å‘è¡¨å•æ·»åŠ ä¸Šä¸‹æ–‡</h1><p id="af96" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">æ ¹æ®<a class="ae kw" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank"> React docs </a>ï¼Œä¸Šä¸‹æ–‡æä¾›äº†ä¸€ç§é€šè¿‡ç»„ä»¶æ ‘ä¼ é€’æ•°æ®çš„æ–¹å¼ï¼Œè€Œä¸å¿…åœ¨æ¯ä¸€å±‚æ‰‹åŠ¨å‘ä¸‹ä¼ é€’å±æ€§ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬å°†è¡¨å•çŠ¶æ€æå–åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å»æ‰æ‰€æœ‰æˆ‘ä»¬é€šè¿‡ä¸­é—´éƒ¨åˆ†(å¦‚<code class="fe mt mu mv mw b">PersonalInfoSection</code>)ä¼ é€’çš„é“å…·ï¼Œç›´æ¥åœ¨<code class="fe mt mu mv mw b">NameFormComponent</code>å’Œ<code class="fe mt mu mv mw b">DiscountFormComponent</code>ä¸­ä½¿ç”¨çŠ¶æ€ã€‚æ•°æ®æµçœ‹èµ·æ¥ä¼šåƒè¿™æ ·:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/5d017d0340cfa1430cd0d509e4969800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x6sRkE_5g-9hV30h.png"/></div></div></figure><p id="4c28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»º<code class="fe mt mu mv mw b">Context</code>æœ¬èº«ï¼Œå®ƒå°†æ‹¥æœ‰æˆ‘ä»¬çš„çŠ¶æ€å’Œç®¡ç†è¯¥çŠ¶æ€çš„API(å³æˆ‘ä»¬çš„å›è°ƒ):</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="7a30" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">type State = {<br/>  name: string;<br/>  country: Country;<br/>  discount: number;<br/>};<br/><br/>type Context = {<br/>  state: State;<br/>  onNameChange: (name: string) =&gt; void;<br/>  onCountryChange: (name: Country) =&gt; void;<br/>  onDiscountChange: (price: number) =&gt; void;<br/>  onSave: () =&gt; void;<br/>};<br/><br/>const FormContext = createContext&lt;Context&gt;({} as Context);</em></span></pre><p id="3657" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åæˆ‘ä»¬åº”è¯¥ç§»åŠ¨æ‰€æœ‰çš„çŠ¶æ€é€»è¾‘ï¼Œåœ¨<code class="fe mt mu mv mw b">Form</code>ä¸­ï¼Œåœ¨<code class="fe mt mu mv mw b">FormDataProvider</code>ç»„ä»¶ä¸­ï¼Œå¹¶å°†çŠ¶æ€å’Œå›è°ƒé™„åŠ åˆ°æ–°åˆ›å»ºçš„<code class="fe mt mu mv mw b">Context</code>:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="b557" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const FormDataProvider = ({ children }: { children: ReactNode }) =&gt; {<br/>  const [state, setState] = useState&lt;State&gt;({} as State);<br/><br/>  const value = useMemo(() =&gt; {<br/>    const onSave = () =&gt; {<br/>      // send the request to the backend here<br/>    };<br/><br/>    const onDiscountChange = (discount: number) =&gt; {<br/>      setState({ ...state, discount });<br/>    };<br/><br/>    const onNameChange = (name: string) =&gt; {<br/>      setState({ ...state, name });<br/>    };<br/><br/>    const onCountryChange = (country: Country) =&gt; {<br/>      setState({ ...state, country });<br/>    };<br/><br/>    return {<br/>      state,<br/>      onSave,<br/>      onDiscountChange,<br/>      onNameChange,<br/>      onCountryChange,<br/>    };<br/>  }, [state]);<br/><br/>  return &lt;FormContext.Provider value={value}&gt;{children}&lt;/FormContext.Provider&gt;;<br/>};</em></span></pre><p id="45e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åå…¬å¼€æŒ‚é’©ï¼Œè®©å…¶ä»–ç»„ä»¶ä½¿ç”¨è¯¥ä¸Šä¸‹æ–‡ï¼Œè€Œæ— éœ€ç›´æ¥è®¿é—®å®ƒ:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="a43e" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const useFormState = () =&gt; useContext(FormContext);</em></span></pre><p id="08a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¹¶å°†æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶åŒ…è£…åˆ°<code class="fe mt mu mv mw b">FormDataProvider</code>ä¸­:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="201e" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export default function App() {<br/>  return (<br/>    &lt;FormDataProvider&gt;<br/>      &lt;Form /&gt;<br/>    &lt;/FormDataProvider&gt;<br/>  );<br/>}</em></span></pre><p id="3093" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•´ä¸ªappä¸­å»æ‰<strong class="ka ir">æ‰€æœ‰çš„é“å…·</strong>ï¼Œé€šè¿‡<code class="fe mt mu mv mw b">useFormState</code> hookç›´æ¥åœ¨ç»„ä»¶ä¸­éœ€è¦çš„åœ°æ–¹ä½¿ç”¨æ‰€éœ€çš„æ•°æ®å’Œå›è°ƒã€‚</p><p id="b3ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„æ ¹<code class="fe mt mu mv mw b">Form</code>ç»„ä»¶å°†å˜æˆè¿™æ ·:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="d185" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const Form = () =&gt; {<br/>  // no more props anywhere!<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;PersonalInfoSection /&gt;<br/>      &lt;ValueCalculationsSection /&gt;<br/>      &lt;ActionsSection /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</em></span></pre><p id="f115" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¹¶ä¸”<code class="fe mt mu mv mw b">NameFormComponent</code>å°†èƒ½å¤Ÿåƒè¿™æ ·è®¿é—®æ‰€æœ‰æ•°æ®:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="a3b2" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const NameFormComponent = () =&gt; {<br/>  // accessing the data directly right where it's needed!<br/>  const { onNameChange, state } = useFormState();<br/><br/>  const onValueChange = (e: ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {<br/>    onNameChange(e.target.value);<br/>  };<br/><br/>  return (<br/>    &lt;div&gt;<br/>      Type your name here: &lt;br /&gt;<br/>      &lt;input onChange={onValueChange} value={state.name} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</em></span></pre><p id="e3af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">çœ‹çœ‹<a class="ae kw" href="https://codesandbox.io/s/form-implementation-with-context-2-3wd2i?file=/src/App.tsx" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªä»£ç æ²™ç®±</a>é‡Œçš„å®Œæ•´ä»£ç ã€‚ä¸è¦å¿˜äº†æ¬£èµç°åœ¨æ²¡æœ‰åˆ°å¤„ä¹±ä¸ƒå…«ç³Ÿçš„é“å…·æ—¶çœ‹èµ·æ¥æœ‰å¤šå¹²å‡€ï¼</p><h1 id="db43" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">æ–°å½¢å¼çš„è¡¨ç°å¦‚ä½•ï¼Ÿ</h1><p id="2191" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">ä»æ€§èƒ½çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰åšåˆ°è¿™ä¸€ç‚¹:é”®å…¥åç§°å’Œæ‹–åŠ¨æ»šåŠ¨æ¡ä»ç„¶æ»åã€‚ä½†æ˜¯å¦‚æœæˆ‘å¼€å§‹è¾“å…¥<code class="fe mt mu mv mw b">NameFormComponent</code>ï¼Œåœ¨æ§åˆ¶å°ä¸­æˆ‘ä¼šçœ‹åˆ°:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="532d" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">Discount situation render<br/>NameFormComponent render<br/>SelectCountryFormComponent render<br/>DiscountFormComponent render<br/>ActionsSection render<br/>Section render</em></span></pre><p id="c6c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸€åŠçš„ç»„ä»¶ç°åœ¨ä¸é‡æ–°æ¸²æŸ“ï¼ŒåŒ…æ‹¬æˆ‘ä»¬çš„çˆ¶ç»„ä»¶<code class="fe mt mu mv mw b">Form</code>ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ˜¯å› ä¸ºä¸Šä¸‹æ–‡æ˜¯å¦‚ä½•å·¥ä½œçš„:å½“ä¸€ä¸ªä¸Šä¸‹æ–‡å€¼æ”¹å˜æ—¶ï¼Œ<strong class="ka ir">è¿™ä¸ªä¸Šä¸‹æ–‡çš„æ¯ä¸ªæ¶ˆè´¹è€…å°†é‡æ–°å‘ˆç°</strong>ï¼Œä¸ç®¡ä»–ä»¬æ˜¯å¦ä½¿ç”¨æ”¹å˜çš„å€¼ã€‚è€Œä¸”ï¼Œé‚£äº›è¢«ä¸Šä¸‹æ–‡ç»•è¿‡çš„ç»„ä»¶æ ¹æœ¬ä¸ä¼šè¢«é‡æ–°å‘ˆç°ã€‚æˆ‘ä»¬çš„é‡æ–°æ¸²æŸ“æµç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/0bcecbcdd1cd87abf68d6f64250c81e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E60uWExXdrb0a5jl.png"/></div></div></figure><p id="ce70" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿæˆ‘ä»¬çš„ç»„ä»¶å®ç°ï¼Œç‰¹åˆ«æ˜¯<code class="fe mt mu mv mw b">SelectCountryComponent</code>ï¼Œå®ƒæ˜¯æ…¢é€Ÿâ€œå¤–éƒ¨â€ç»„ä»¶çš„åŒ…è£…å™¨ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒå®é™…ä¸Šå¹¶æ²¡æœ‰ä½¿ç”¨<code class="fe mt mu mv mw b">state</code>æœ¬èº«ã€‚å®ƒæ‰€éœ€è¦çš„åªæ˜¯<code class="fe mt mu mv mw b">onCountryChange</code>çš„å›è°ƒ:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="dbfb" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const SelectCountryFormComponent = () =&gt; {<br/>  const { onCountryChange } = useFormState();<br/>  console.info('SelectCountryFormComponent render');<br/><br/>  return &lt;SelectCountry onChange={onCountryChange} /&gt;;<br/>};</em></span></pre><p id="5a66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæœºä¼šæ¥å°è¯•ä¸€ä¸ªéå¸¸é…·çš„æŠ€å·§:æˆ‘ä»¬å¯ä»¥å°†<code class="fe mt mu mv mw b">state</code>éƒ¨åˆ†å’Œ<code class="fe mt mu mv mw b">API</code>éƒ¨åˆ†æ‹†åˆ†åˆ°<code class="fe mt mu mv mw b">FormDataProvider</code>éƒ¨åˆ†ã€‚</p><h1 id="7974" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">æ‹†åˆ†çŠ¶æ€å’ŒAPI</h1><p id="4b45" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬æƒ³è¦åšçš„æ˜¯å°†æˆ‘ä»¬çš„â€œæ•´ä½“â€çŠ¶æ€åˆ†è§£æˆä¸¤ä¸ªâ€œå¾®è§‚â€çŠ¶æ€ğŸ˜…ã€‚</p><p id="f224" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªç”¨äºæ•°æ®ï¼Œä¸€ä¸ªç”¨äºAPIï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰å†…å®¹çš„ä¸Šä¸‹æ–‡:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="30c3" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">type State = {<br/>  name: string;<br/>  country: Country;<br/>  discount: number;<br/>};<br/><br/>type API = {<br/>  onNameChange: (name: string) =&gt; void;<br/>  onCountryChange: (name: Country) =&gt; void;<br/>  onDiscountChange: (price: number) =&gt; void;<br/>  onSave: () =&gt; void;<br/>};<br/><br/>const FormDataContext = createContext&lt;State&gt;({} as State);<br/>const FormAPIContext = createContext&lt;API&gt;({} as API);</em></span></pre><p id="e4c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">FormDataProvider</code>ç»„ä»¶ä¸­æ²¡æœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡æä¾›è€…ï¼Œè€Œæ˜¯æœ‰ä¸¤ä¸ªï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†çŠ¶æ€ç›´æ¥ä¼ é€’ç»™<code class="fe mt mu mv mw b">FormDataContext.Provider</code>:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="393e" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const FormDataProvider = () =&gt; {<br/>  // state logic<br/><br/>  return (<br/>    &lt;FormAPIContext.Provider value={api}&gt;<br/>      &lt;FormDataContext.Provider value={state}&gt;{children}&lt;/FormDataContext.Provider&gt;<br/>    &lt;/FormAPIContext.Provider&gt;<br/>  );<br/>};</em></span></pre><p id="0e34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨æœ€æœ‰è¶£çš„éƒ¨åˆ†æ˜¯<code class="fe mt mu mv mw b">api</code>å€¼ã€‚</p><p id="0619" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚æœæˆ‘ä»¬åªæ˜¯è®©å®ƒåƒä»¥å‰ä¸€æ ·ï¼Œæ•´ä¸ªâ€œåˆ†è§£â€çš„æƒ³æ³•æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºæˆ‘ä»¬ä»ç„¶å¿…é¡»ä¾èµ–<code class="fe mt mu mv mw b">state</code>ä½œä¸º<code class="fe mt mu mv mw b">useMemo</code>é’©å­ä¸­çš„ä¸€ä¸ªä¾èµ–é¡¹:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="a0fa" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const api = useMemo(() =&gt; {<br/>  const onDiscountChange = (discount: number) =&gt; {<br/>    // this is why we still need state here - in order to update it<br/>    setState({ ...state, discount });<br/>  };<br/><br/>  // all other callbacks<br/><br/>  return { onSave, onDiscountChange, onNameChange, onCountryChange };<br/>  // still have state as a dependency<br/>}, [state]);</em></span></pre><p id="b390" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™å°†å¯¼è‡´<code class="fe mt mu mv mw b">api</code>å€¼éšç€æ¯æ¬¡çŠ¶æ€æ›´æ–°è€Œæ”¹å˜ï¼Œè¿™å°†å¯¼è‡´<code class="fe mt mu mv mw b">FormAPIContext</code>åœ¨æ¯æ¬¡çŠ¶æ€æ›´æ–°æ—¶è§¦å‘é‡æ–°æ¸²æŸ“ï¼Œè¿™å°†ä½¿æˆ‘ä»¬çš„åˆ†å‰²æ— æ•ˆã€‚æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">api</code>ä¿æŒä¸å˜ï¼Œä¸ç®¡<code class="fe mt mu mv mw b">state</code>å¦‚ä½•ï¼Œè¿™æ ·è¿™ä¸ªæä¾›è€…çš„æ¶ˆè´¹è€…å°±ä¸ä¼šé‡æ–°å‘ˆç°ã€‚</p><p id="2472" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¹¸è¿çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åº”ç”¨å¦ä¸€ä¸ªå·§å¦™çš„æŠ€å·§:æˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„çŠ¶æ€æå–åˆ°ä¸€ä¸ªreducerä¸­ï¼Œè€Œä¸æ˜¯åœ¨å›è°ƒä¸­è°ƒç”¨<code class="fe mt mu mv mw b">setState</code>,æˆ‘ä»¬åªæ˜¯è§¦å‘ä¸€ä¸ªreduceråŠ¨ä½œã€‚</p><p id="f953" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é¦–å…ˆï¼Œåˆ›å»ºåŠ¨ä½œå’Œå‡é€Ÿå™¨æœ¬èº«:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="4a58" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">type Actions =<br/>  | { type: 'updateName'; name: string }<br/>  | { type: 'updateCountry'; country: Country }<br/>  | { type: 'updateDiscount'; discount: number };<br/><br/>const reducer = (state: State, action: Actions): State =&gt; {<br/>  switch (action.type) {<br/>    case 'updateName':<br/>      return { ...state, name: action.name };<br/>    case 'updateDiscount':<br/>      return { ...state, discount: action.discount };<br/>    case 'updateCountry':<br/>      return { ...state, country: action.country };<br/>  }<br/>};</em></span></pre><p id="31c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç”¨å‡é€Ÿå™¨ä»£æ›¿<code class="fe mt mu mv mw b">useState</code>:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="9fe7" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const FormProvider = ({ children }: { children: ReactNode }) =&gt; {<br/>  const [state, dispatch] = useReducer(reducer, {} as State);<br/>  // ...<br/>};</em></span></pre><p id="dfc9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¹¶å°†æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">api</code>ä»<code class="fe mt mu mv mw b">setState</code>è¿ç§»åˆ°<code class="fe mt mu mv mw b">dispatch</code>:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="3de1" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const api = useMemo(() =&gt; {<br/>  const onSave = () =&gt; {<br/>    // send the request to the backend here<br/>  };<br/><br/>  const onDiscountChange = (discount: number) =&gt; {<br/>    dispatch({ type: 'updateDiscount', discount });<br/>  };<br/><br/>  const onNameChange = (name: string) =&gt; {<br/>    dispatch({ type: 'updateName', name });<br/>  };<br/><br/>  const onCountryChange = (country: Country) =&gt; {<br/>    dispatch({ type: 'updateCountry', country });<br/>  };<br/><br/>  return { onSave, onDiscountChange, onNameChange, onCountryChange };<br/>  // no more dependency on state! The api value will stay the same<br/>}, []);</em></span></pre><p id="58d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æœ€åä¸€æ­¥:ä¸è¦å¿˜è®°å°†æ‰€æœ‰ä½¿ç”¨è¿‡<code class="fe mt mu mv mw b">useFormState</code>çš„ç»„ä»¶è¿ç§»åˆ°<code class="fe mt mu mv mw b">useFormData</code>å’Œ<code class="fe mt mu mv mw b">useFormAPI</code>ã€‚æ¯”å¦‚æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">SelectCountryFormComponent</code>ä¼šä»<code class="fe mt mu mv mw b">useFormAPI</code>é’©å­ä½¿ç”¨<code class="fe mt mu mv mw b">onCountryChange</code>ï¼Œæ°¸è¿œä¸ä¼šåœ¨çŠ¶æ€æ”¹å˜æ—¶é‡æ–°æ¸²æŸ“ã€‚</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="eb48" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const SelectCountryFormComponent = () =&gt; {<br/>  const { onCountryChange } = useFormAPI();<br/><br/>  return &lt;SelectCountry onChange={onCountryChange} /&gt;;<br/>};</em></span></pre><p id="6332" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">çœ‹çœ‹è¿™ä¸ªä»£ç æ²™ç®±ä¸­çš„å®Œæ•´å®ç°ã€‚ç°åœ¨ï¼Œé”®å…¥å’Œæ‹–åŠ¨æ çš„é€Ÿåº¦éå¸¸å¿«ï¼Œå½“æˆ‘ä»¬é”®å…¥å†…å®¹æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„å”¯ä¸€æ§åˆ¶å°è¾“å‡ºæ˜¯è¿™æ ·çš„:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="e99f" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">Discount situation render<br/>NameFormComponent render</em></span></pre><p id="8bbe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åªæœ‰ä¸¤ä¸ªç»„ä»¶ï¼Œå› ä¸ºåªæœ‰è¿™ä¸¤ä¸ªç»„ä»¶ä½¿ç”¨å®é™…çš„çŠ¶æ€æ•°æ®ã€‚ğŸ‰</p><h1 id="8fbf" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">è¿›ä¸€æ­¥åˆ†è£‚çŠ¶æ€</h1><p id="7f14" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">ç°åœ¨ï¼Œæœ‰å¥½çš„è®¾è®¡çœ¼å…‰çš„äººæˆ–è€…åªæ˜¯ç»†å¿ƒçš„è¯»è€…å¯èƒ½ä¼šæ³¨æ„åˆ°æˆ‘æœ‰ä¸€ç‚¹ä½œå¼Šã€‚æˆ‘ä»¬æ²¡æœ‰å°†é€‰æ‹©çš„å›½å®¶ä¼ é€’ç»™æˆ‘ä»¬çš„" external" <code class="fe mt mu mv mw b">SelectCountry</code>ç»„ä»¶ï¼Œå®ƒåœç•™åœ¨åˆ—è¡¨çš„ç¬¬ä¸€é¡¹ä¸Šã€‚å®é™…ä¸Šï¼Œé€‰ä¸­çš„â€œæ·¡ç´«è‰²â€åº”è¯¥ç§»åŠ¨åˆ°ä½ ç‚¹å‡»çš„å›½å®¶ã€‚ç»„ä»¶å®é™…ä¸Šå…è®¸æˆ‘ä»¬é€šè¿‡<code class="fe mt mu mv mw b">activeCountry</code>ä¼ é€’å®ƒã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œæˆ‘å¯ä»¥åšå¾—å¾ˆç®€å•:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="64e8" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const SelectCountryFormComponent = () =&gt; {<br/>  const { onCountryChange } = useFormAPI();<br/>  const { country } = useFormData();<br/><br/>  return &lt;SelectCountry onChange={onCountryChange} activeCountry={country} /&gt;;<br/>};</em></span></pre><p id="ff48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªé—®é¢˜â€”â€”åªè¦æˆ‘åœ¨ä¸€ä¸ªç»„ä»¶ä¸­ä½¿ç”¨<code class="fe mt mu mv mw b">useFormData</code>é’©å­ï¼Œå®ƒå°±ä¼šéšç€çŠ¶æ€çš„æ”¹å˜å¼€å§‹é‡æ–°æ¸²æŸ“ï¼Œå°±åƒ<code class="fe mt mu mv mw b">NameFormComponent</code>ä¸€æ ·ã€‚å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å°†å›åˆ°æ‰“å­—å’Œæ‹–åŠ¨çš„è½åä½“éªŒã€‚</p><p id="5536" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä½†æ˜¯ç°åœ¨ï¼Œæ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“äº†å¦‚ä½•åœ¨ä¸åŒçš„æä¾›è€…ä¹‹é—´åˆ†å‰²æ•°æ®ï¼Œé‚£ä¹ˆæ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æ­¢æˆ‘ä»¬å°†è¿™ä¸€ç‚¹æå‡åˆ°ä¸‹ä¸€ä¸ªå±‚æ¬¡ï¼Œå¹¶ä¸”åŒæ ·åˆ†å‰²çŠ¶æ€çš„å…¶ä½™éƒ¨åˆ†ã€‚æ‘©å°”ä¾›åº”å•†ï¼ğŸ˜…</p><p id="ac0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¯¹äº<code class="fe mt mu mv mw b">State</code>ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸‰ä¸ªç»Ÿä¸€çš„ä¸Šä¸‹æ–‡:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="9e95" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const FormNameContext = createContext&lt;State['name']&gt;({} as State['name']);<br/>const FormCountryContext = createContext&lt;State['country']&gt;({} as State['country']);<br/>const FormDiscountContext = createContext&lt;State['discount']&gt;({} as State['discount']);</em></span></pre><p id="e000" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸‰ä¸ªå›½å®¶ä¾›åº”å•†:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="c892" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">&lt;FormAPIContext.Provider value={api}&gt;<br/>  &lt;FormNameContext.Provider value={state.name}&gt;<br/>    &lt;FormCountryContext.Provider value={state.country}&gt;<br/>      &lt;FormDiscountContext.Provider value={state.discount}&gt;{children}&lt;/FormDiscountContext.Provider&gt;<br/>    &lt;/FormCountryContext.Provider&gt;<br/>  &lt;/FormNameContext.Provider&gt;<br/>&lt;/FormAPIContext.Provider&gt;</em></span></pre><p id="bf46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å’Œä¸‰ä¸ªé’©å­æ¥ä½¿ç”¨çŠ¶æ€:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="2067" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const useFormName = () =&gt; useContext(FormNameContext);<br/>export const useFormCountry = () =&gt; useContext(FormCountryContext);<br/>export const useFormDiscount = () =&gt; useContext(FormDiscountContext);</em></span></pre><p id="0947" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨åœ¨æˆ‘ä»¬çš„<code class="fe mt mu mv mw b">SelectCountryFormComponent</code>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe mt mu mv mw b">useFormCountry</code>é’©å­ï¼Œé™¤äº†å›½å®¶æœ¬èº«ä¹‹å¤–ï¼Œå®ƒä¸ä¼šåœ¨ä»»ä½•å˜åŒ–ä¸Šé‡æ–°å‘ˆç°:</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="38ba" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">export const SelectCountryFormComponent = () =&gt; {<br/>  const { onCountryChange } = useFormAPI();<br/>  const country = useFormCountry();<br/><br/>  return &lt;SelectCountry onChange={onCountryChange} activeCountry={country} /&gt;;<br/>};</em></span></pre><p id="2b93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨codesandbox ä¸­æ£€æŸ¥è¿™ä¸ª<a class="ae kw" href="https://codesandbox.io/s/form-implementation-split-api-and-state-0tvq0?file=/src/App.tsx" rel="noopener ugc nofollow" target="_blank">:å®ƒä»ç„¶å¾ˆå¿«ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©å›½å®¶ã€‚å½“æˆ‘ä»¬åœ¨åç§°è¾“å…¥ä¸­é”®å…¥ä¸€äº›å†…å®¹æ—¶ï¼Œæˆ‘ä»¬åœ¨æ§åˆ¶å°è¾“å‡ºä¸­çœ‹åˆ°çš„å”¯ä¸€å†…å®¹æ˜¯:</a></p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="468a" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">NameFormComponent render</em></span></pre><h1 id="0b36" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">å¥–åŠ±:å¤–éƒ¨çŠ¶æ€ç®¡ç†</h1><p id="7b21" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">ç°åœ¨ï¼Œè¿™ä¸ªè¡¨å•çš„çŠ¶æ€æ˜¯å¦åº”è¯¥é©¬ä¸Šç”¨ä¸€äº›çŠ¶æ€ç®¡ç†åº“æ¥å®ç°çš„é—®é¢˜å¯èƒ½ä¼šå‡ºç°åœ¨ä½ çš„è„‘æµ·ä¸­ã€‚ä¹Ÿè®¸ä½ æ˜¯å¯¹çš„ã€‚æ¯•ç«Ÿï¼Œå¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä»£ç ï¼Œæˆ‘ä»¬åªæ˜¯é‡æ–°å‘æ˜äº†è½®å­å¹¶å®ç°äº†ä¸€ä¸ªåŸºæœ¬çš„çŠ¶æ€ç®¡ç†åº“ï¼Œå…·æœ‰ç±»ä¼¼é€‰æ‹©å™¨çš„çŠ¶æ€åŠŸèƒ½å’Œæ”¹å˜çŠ¶æ€çš„ç‹¬ç«‹æ“ä½œã€‚</p><p id="39a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä½†æ˜¯ç°åœ¨ä½ æœ‰äº†ä¸€ä¸ªé€‰æ‹©ã€‚ä¸Šä¸‹æ–‡ä¸å†æ˜¯ä¸€ä¸ªè°œï¼Œæœ‰äº†è¿™äº›æŠ€æœ¯ï¼Œå¦‚æœæœ‰éœ€è¦ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ç¼–å†™çº¯ä¸Šä¸‹æ–‡çš„é«˜æ€§èƒ½åº”ç”¨ç¨‹åºï¼Œå¦‚æœä½ æƒ³è¿‡æ¸¡åˆ°ä»»ä½•å…¶ä»–æ¡†æ¶ï¼Œä½ å¯ä»¥é€šè¿‡å¯¹ä»£ç è¿›è¡Œæœ€å°çš„æ›´æ”¹æ¥å®Œæˆã€‚å½“ä½ è®¾è®¡ä½ çš„åº”ç”¨æ—¶ï¼ŒçŠ¶æ€ç®¡ç†æ¡†æ¶<strong class="ka ir">å¹¶ä¸é‡è¦</strong>ã€‚</p><p id="db95" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘ä»¬è¿˜ä¸å¦‚ç°åœ¨å°±æŠŠå®ƒç§»åˆ°æ—§çš„å¥½çš„Reduxä¸Šã€‚æˆ‘ä»¬éœ€è¦åšçš„å”¯ä¸€äº‹æƒ…æ˜¯:å»æ‰ä¸Šä¸‹æ–‡å’Œæä¾›è€…ï¼Œå°†React reducerè½¬æ¢ä¸ºRedux storeï¼Œå¹¶å°†æˆ‘ä»¬çš„é’©å­è½¬æ¢ä¸ºä½¿ç”¨Reduxé€‰æ‹©å™¨å’Œdispatchã€‚</p><pre class="mp mq mr ms gt mx mw my mz aw na bi"><span id="31fb" class="nb ky iq mw b gy nc nd l ne nf"><em class="ng">const store = createStore((state = {}, action) =&gt; {<br/>  switch (action.type) {<br/>    case 'updateName':<br/>      return { ...state, name: action.payload };<br/>    case 'updateCountry':<br/>      return { ...state, country: action.payload };<br/>    case 'updateDiscount':<br/>      return { ...state, discount: action.payload };<br/>    default:<br/>      return state;<br/>  }<br/>});<br/><br/>export const FormDataProvider = ({ children }: { children: ReactNode }) =&gt; {<br/>  return &lt;Provider store={store}&gt;{children}&lt;/Provider&gt;;<br/>};<br/><br/>export const useFormDiscount = () =&gt; useSelector((state) =&gt; state.discount);<br/>export const useFormCountry = () =&gt; useSelector((state) =&gt; state.country);<br/>export const useFormName = () =&gt; useSelector((state) =&gt; state.name);<br/><br/>export const useFormAPI = () =&gt; {<br/>  const dispatch = useDispatch();<br/><br/>  return {<br/>    onCountryChange: (value) =&gt; {<br/>      dispatch({ type: 'updateCountry', payload: value });<br/>    },<br/>    onDiscountChange: (value) =&gt; dispatch({ type: 'updateDiscount', payload: value }),<br/>    onNameChange: (value) =&gt; dispatch({ type: 'updateName', payload: value }),<br/>    onSave: () =&gt; {},<br/>  };<br/>};</em></span></pre><p id="29e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å…¶ä»–ä¸€åˆ‡ä¿æŒä¸å˜ï¼Œå®Œå…¨æŒ‰ç…§æˆ‘ä»¬çš„è®¾è®¡å·¥ä½œã€‚<a class="ae kw" href="https://codesandbox.io/s/form-implementation-redux-2-t5w30?file=/src/form-api.tsx" rel="noopener ugc nofollow" target="_blank">å‚è§CodeSandboxã€‚</a></p><p id="b80a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä»Šå¤©åˆ°æ­¤ä¸ºæ­¢ï¼Œå¸Œæœ›now <code class="fe mt mu mv mw b">Context</code>ä¸æ˜¯ä½ çš„åº”ç”¨ç¨‹åºä¸­ç¥ç§˜çš„è‡ªå‘å†ç°çš„æ¥æºï¼Œè€Œæ˜¯ä½ ç¼–å†™é«˜æ€§èƒ½Reactä»£ç âœŒçš„åšå®å·¥å…·ğŸ¼</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="84bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="ng">æœ€åˆå‘è¡¨äº</em><a class="ae kw" href="https://www.developerway.com/posts/how-to-write-performant-react-apps-with-context" rel="noopener ugc nofollow" target="_blank"><em class="ng"/></a><em class="ng">ã€‚ç½‘ç«™ä¸Šæœ‰æ›´å¤šè¿™æ ·çš„æ–‡ç« </em>ğŸ˜‰</p><p id="27d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://www.developerway.com/" rel="noopener ugc nofollow" target="_blank"> <em class="ng">è®¢é˜…ç®€è®¯</em> </a>ï¼Œ<em class="ng"> </em> <a class="ae kw" href="https://www.linkedin.com/in/adevnadia/" rel="noopener ugc nofollow" target="_blank"> <em class="ng">åœ¨LinkedIn </em> </a> <em class="ng">æˆ–</em> <a class="ae kw" href="https://twitter.com/adevnadia" rel="noopener ugc nofollow" target="_blank"> <em class="ng">ä¸Šå…³æ³¨Twitter </em> </a> <em class="ng">ä»¥ä¾¿åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å‡ºæ¥æ—¶ç«‹å³è·å¾—é€šçŸ¥ã€‚</em></p></div></div>    
</body>
</html>