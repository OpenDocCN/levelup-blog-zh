<html>
<head>
<title>How to Build a Note Taking Command Line Interface (CLI) With Rust: Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Rust构建笔记命令行界面(CLI ):第1部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-build-a-note-taking-command-line-application-with-rust-part-1-34b9cd5be6b9?source=collection_archive---------0-----------------------#2021-11-27">https://levelup.gitconnected.com/how-to-build-a-note-taking-command-line-application-with-rust-part-1-34b9cd5be6b9?source=collection_archive---------0-----------------------#2021-11-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/551ebe491ee01bdc05ed58c6cd9d1efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Fq7K0d07prvWsuxCG1Esg.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">一名矿工拿着一把生锈的鹤嘴锄在2021年前后发现了金块——如果你能认出位置，就能获得额外的网络积分</figcaption></figure><p id="31d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">更新:</strong> <a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/how-to-build-a-note-taking-command-line-application-with-rust-part-2-ec738dd97c48"> <strong class="ki iu">第2部分现已推出</strong> </a></p><p id="5417" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上周我写了我的第一个Rust应用程序。在克服了一些最初的语法障碍后，我对这门语言感觉很好。这篇文章是一系列文章的第一篇，将介绍如何用Rust构建笔记应用程序。</p><p id="b944" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最终目标是给读者足够的知识来构建自己的类似于<a class="ae le" href="https://github.com/adamjberg/engram" rel="noopener ugc nofollow" target="_blank"> engram </a>的笔记应用。</p><p id="3588" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">内容期望读者有一些现有的编程知识，但可以是完全陌生的。本系列的每一部分都将产生一个实用的应用程序，它将在以后的文章中构建。</p><p id="d890" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我强烈建议把你看到的代码打出来，而不是复制粘贴整个代码块。这是获得更好理解的最有效的方法之一。</p><h1 id="730c" class="lf lg it bd kf lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">入门</strong></h1><p id="935a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">使用下面的命令安装rust，该命令可以从他们的<a class="ae le" href="https://www.rust-lang.org/learn/get-started" rel="noopener ugc nofollow" target="_blank">入门页面</a>中找到</p><h2 id="23dc" class="mh lg it bd kf mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated"><strong class="ak">安装防锈</strong></h2><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="900f" class="mh lg it my b gy nc nd l ne nf">curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh</span></pre><p id="1791" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">创建新的Rust项目</strong></p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="c28e" class="mh lg it my b gy nc nd l ne nf">cargo new notes</span></pre><p id="7854" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b"><a class="ae le" href="https://doc.rust-lang.org/cargo/" rel="noopener ugc nofollow" target="_blank">cargo</a></code> <a class="ae le" href="https://doc.rust-lang.org/cargo/" rel="noopener ugc nofollow" target="_blank">是锈包管理者</a>。它支持几个命令，本文将介绍其中的几个。<code class="fe ng nh ni my b">cargo new</code>在当前目录下创建一个名为<code class="fe ng nh ni my b">notes</code>(或者你指定的其他名字)的新项目(和文件夹)。</p><p id="126b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b">src/main.rs</code>包括一个非常简单的“Hello World”应用程序。</p><p id="b1a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b">Cargo.toml</code>被称为<em class="nj">舱单。</em>参见<a class="ae le" href="https://doc.rust-lang.org/cargo/reference/manifest.html" rel="noopener ugc nofollow" target="_blank">货物手册</a>深入了解此处支持的内容。我们只需要在这里做一个小小的调整来添加一个依赖项，所以不要太担心理解所有的东西。</p><p id="19f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b">.gitignore</code>方便地忽略了git默认的<code class="fe ng nh ni my b">target</code>文件夹。</p><h2 id="527a" class="mh lg it bd kf mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">运行hello world应用程序</h2><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="9e32" class="mh lg it my b gy nc nd l ne nf">cargo run</span></pre><p id="0607" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b"><a class="ae le" href="https://doc.rust-lang.org/cargo/commands/cargo-run.html" rel="noopener ugc nofollow" target="_blank">cargo run</a></code> <a class="ae le" href="https://doc.rust-lang.org/cargo/commands/cargo-run.html" rel="noopener ugc nofollow" target="_blank">命令</a>构建并运行当前包。在本教程中进行更改后，您将使用它来运行和测试这些更改。运行一次后，您会看到更多的文件和文件夹出现。</p><p id="4e48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b">Cargo.lock</code>这是一个自动生成的文件，它精确地指定了正在使用的库的版本。关于<a class="ae le" href="https://doc.rust-lang.org/cargo/guide/cargo-toml-vs-cargo-lock.html" rel="noopener ugc nofollow" target="_blank"> Cargo.toml vs. Cargo.lock的更多细节，请参考货物手册</a>。</p><p id="1308" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b">target</code>这个文件夹是存储所有构建文件的地方。您几乎可以忽略这一点，因为<code class="fe ng nh ni my b">cargo</code>工具会根据需要处理它。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/dfaa6b127d7317a1e5bd239b9b59dc4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6It0SIG2e9aY1sS7mK-1hA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">默认rust工作区在VS代码中打开</figcaption></figure><h1 id="b9d3" class="lf lg it bd kf lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">准备数据模型</strong></h1><h2 id="6a47" class="mh lg it bd kf mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated"><strong class="ak">创建一个sqlite3数据库</strong></h2><p id="5fad" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">数据库几乎是任何应用程序的核心。大多数新功能需要存储一些新数据或以某种方式检索现有信息。由于这些原因，这通常是你在构建新东西时首先要考虑的事情。特别是，我试图构建的“模式”是什么。</p><p id="6b2a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出于本教程的目的，我们的模式非常简单。我们想要一个有一个列和一个列的表。<code class="fe ng nh ni my b">id</code>存储特定音符的唯一标识符。这是大多数数据库的必填字段，因为它允许您直接引用现有项目。<code class="fe ng nh ni my b">body</code>列将存储我们正在保存的笔记的内容。你可以在这里选择其他你觉得更好的术语。一些可能的选择:<code class="fe ng nh ni my b">content</code>、<code class="fe ng nh ni my b">message</code>、<code class="fe ng nh ni my b">text</code>或<code class="fe ng nh ni my b">title</code>。当然有可能在事后改变这一点，但是随着时间的推移，越来越多的代码引用这些特定的术语，这变得越来越困难，所以试着选择一个你可以忍受的术语并坚持下去。</p><p id="bf4e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我现在看到的大多数教程主要关注的是在服务器上存储数据，并通过某种API同步数据。这个系列最终会实现，但是像我们正在构建的notes应用程序离线工作是非常重要的。尽早设置这一限制可以让我们考虑离线构建，而不是试图将其捆绑到现有的云应用上。</p><p id="2973" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b"><a class="ae le" href="https://www.sqlite.org/index.html" rel="noopener ugc nofollow" target="_blank">sqlite3</a></code> <a class="ae le" href="https://www.sqlite.org/index.html" rel="noopener ugc nofollow" target="_blank">是一个流行的数据库库</a>，它将数据库存储在文件系统的一个文件中。这对用户来说很简单，因为他们不需要运行单独的数据库服务器，如果需要，数据库文件可以传递给其他系统。</p><h2 id="f0ad" class="mh lg it bd kf mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated"><strong class="ak">创建注释表</strong></h2><p id="e2b3" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">第一步是创建一个表来存放我们的应用程序数据。我们将使用<code class="fe ng nh ni my b">rusqlite</code>库来处理我们到sqlite数据库的连接。你可以通过修改你的<code class="fe ng nh ni my b">Cargo.toml</code>来安装它。</p><p id="9e0a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> Cargo.toml </strong></p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="aa39" class="mh lg it my b gy nc nd l ne nf">[package]<br/>name = "notes"<br/>version = "0.1.0"<br/>edition = "2021"</span><span id="e71f" class="mh lg it my b gy nl nd l ne nf"># See more keys and their definitions at <a class="ae le" href="https://doc.rust-lang.org/cargo/reference/manifest.html" rel="noopener ugc nofollow" target="_blank">https://doc.rust-lang.org/cargo/reference/manifest.html</a></span><span id="e1b0" class="mh lg it my b gy nl nd l ne nf"><strong class="my iu">[dependencies.rusqlite]<br/>version = "0.26.1"<br/>features = ["bundled"]</strong></span></pre><p id="f927" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将添加<code class="fe ng nh ni my b">rusqlite</code>作为一个依赖项，它将在您下次尝试构建时安装。<code class="fe ng nh ni my b">features = [“bundled”]</code>告诉包编译<code class="fe ng nh ni my b">SQLite</code>。这在寻找系统库非常困难的Windows上特别有用。</p><p id="baee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">添加后，您现在可以访问您的<code class="fe ng nh ni my b">main.rs</code>中的<code class="fe ng nh ni my b">rusqlite</code>,用以下代码替换现有代码:</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="0d20" class="mh lg it my b gy nc nd l ne nf"><strong class="my iu">use rusqlite::{Connection, Result};</strong></span><span id="8eeb" class="mh lg it my b gy nl nd l ne nf"><strong class="my iu">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {<br/>  let conn = Connection::open("notes.db")?;<br/>  conn.execute(<br/>    "create table if not exists notes (<br/>      id integer primary key,<br/>      body text not null unique<br/>    )",<br/>    [],<br/>  )?;<br/>  <br/>  Ok(())<br/>}</strong></span></pre><p id="b1a2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在你可以运行<code class="fe ng nh ni my b">cargo run</code>，一旦它构建完成，notes程序将运行并立即退出。然后，您应该会在当前目录中看到一个名为<code class="fe ng nh ni my b">notes.db</code>的文件。如果您安装了DB浏览器，您可以打开这个文件并看到一个带有<code class="fe ng nh ni my b">id</code>和<code class="fe ng nh ni my b">body</code>列的<code class="fe ng nh ni my b">notes</code>表。</p><p id="956e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您再次运行该程序，应该不会发生任何事情。我们正在运行的<a class="ae le" href="https://www.w3schools.com/sql/" rel="noopener ugc nofollow" target="_blank"> SQL </a>命令:</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="ad70" class="mh lg it my b gy nc nd l ne nf">create table if not exists notes (<br/>  id integer primary key,<br/>  body text not null unique<br/>)</span></pre><p id="9dfc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">指定仅在表不存在时创建该表。当我们打开与<code class="fe ng nh ni my b">let conn = Connection::open(“notes.db”)?;</code>的连接时，我们将<code class="fe ng nh ni my b">rusqlite</code>库指向同一个数据库文件，它能够确定这个表已经被创建。</p><h2 id="9e35" class="mh lg it bd kf mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated"><strong class="ak">【可选】为SQLite安装DB浏览器</strong></h2><p id="a444" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我发现能够直观地确认事情是否按预期运行很有帮助。此时，您可以下载一个数据库浏览器，它允许您查看新创建的<code class="fe ng nh ni my b">notes.db</code>文件的内容。</p><p id="6f72" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以<a class="ae le" href="https://sqlitebrowser.org/dl/" rel="noopener ugc nofollow" target="_blank">下载SQLite的DB浏览器</a>。安装完成后，打开它并点击<code class="fe ng nh ni my b">Open Database</code>。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/0a19c1e1ef667f95f036758469986e06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUPWDqA0mI9HsYEODwBKoA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">notes.db在SQLite的db浏览器中打开</figcaption></figure><p id="79cb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们已经创建了一个表并设置了模式，我们可以继续添加第一个注释了。</p><h1 id="4c14" class="lf lg it bd kf lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak"> CRUD —创建、读取、更新、删除</strong></h1><p id="336c" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">当在任何程序中开发新功能时，我通常独立地处理CRUD首字母缩略词的每个组成部分。对我来说最有意义的构建顺序是:</p><ol class=""><li id="6e5c" class="nn no it ki b kj kk kn ko kr np kv nq kz nr ld ns nt nu nv bi translated">创造</li><li id="56c5" class="nn no it ki b kj nw kn nx kr ny kv nz kz oa ld ns nt nu nv bi translated">阅读</li><li id="2294" class="nn no it ki b kj nw kn nx kr ny kv nz kz oa ld ns nt nu nv bi translated">删除</li><li id="96d5" class="nn no it ki b kj nw kn nx kr ny kv nz kz oa ld ns nt nu nv bi translated">更新</li></ol><p id="0b10" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">教程的这一部分将只涉及创建方面。下一个会检查其他的。</p><h1 id="f830" class="lf lg it bd kf lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">创建</strong></h1><p id="e564" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">创造是第一位的，因为没有它，其他一切都没有意义。在很多情况下，一旦可以创建应用程序，它就可以工作了。很明显，您希望能够完成其他任务，但是他们的缺席不会影响您创建新项目。在我们的notes示例中，您将看到，即使您刚刚添加了create功能，您仍然有一个将notes正确存储到本地数据库的程序。如果这是您能够完成的全部工作，您仍然可以使用类似DB Browser for SQLite的工具打开sqlite3数据库，并在那里浏览旧的笔记。</p><p id="5675" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们这里的小例子中，CRUD的其他部分并不多，但是当构建一个更大的图形用户界面时，演示和测试create功能是很有用的。你可能会意识到你想要它工作起来或者看起来不一样，在这里抓住这一点会节省你的时间。</p><h2 id="74b3" class="mh lg it bd kf mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated"><strong class="ak">要求</strong></h2><p id="226b" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">对于笔记的创建，我只是希望能够在终端中键入我的笔记，然后按回车键。为了从命令行收集输入，我们将使用内置的<code class="fe ng nh ni my b"><a class="ae le" href="https://doc.rust-lang.org/std/io/index.html" rel="noopener ugc nofollow" target="_blank">std::io</a></code>包。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="75c2" class="mh lg it my b gy nc nd l ne nf"><strong class="my iu">use std::io;</strong><br/>use rusqlite::{Connection, Result};</span><span id="27da" class="mh lg it my b gy nl nd l ne nf">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {<br/>  let conn = Connection::open("notes.db")?;<br/>  conn.execute(<br/>    "create table if not exists notes (<br/>      id integer primary key,<br/>      body text not null unique<br/>    )",<br/>    [],<br/>  )?;</span><span id="c8b0" class="mh lg it my b gy nl nd l ne nf"><strong class="my iu">  let mut buffer = String::new();<br/>  io::stdin().read_line(&amp;mut buffer)?;<br/>  conn.execute("INSERT INTO notes (body) values (?1)", [buffer])?;</strong></span><span id="9dc0" class="mh lg it my b gy nl nd l ne nf">  Ok(())<br/>}</span></pre><p id="63c2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以用<code class="fe ng nh ni my b">cargo run</code>再次运行我们的应用程序，现在你应该看到它没有立即退出。你可以输入任何你喜欢的信息，但是“你好，世界”是标准的“这东西能用吗”信息。一旦你按下回车键，程序就会退出。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/8c30462e13c3b5c26a9a0d1181fd9f57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HqmEHsWjWgv5337xu_5jTQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">提交第一条注释后的输出示例</figcaption></figure><p id="aaa6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你安装了上面的DB浏览器，你现在可以点击<code class="fe ng nh ni my b">Browse Data</code>，你会看到一行<code class="fe ng nh ni my b">id:</code> 1和<code class="fe ng nh ni my b">body:</code>“hello world”(或者你刚刚输入的任何内容)。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/7f4de70315a163f430dfb9d59fc06625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dzq9EE9EEpl9G0OhEXRoiw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">显示“hello world”注释的数据库浏览器</figcaption></figure><p id="5fc5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这很好，但程序的目的是让我们快速捕捉许多音符。我们需要一些方法来使程序在第一个注释提交后不会立即退出。</p><p id="34c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了实现这一点，我们将使用一个<code class="fe ng nh ni my b">loop</code>——特别是一个<code class="fe ng nh ni my b">while</code>循环。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="0371" class="mh lg it my b gy nc nd l ne nf">use std::io;<strong class="my iu"><br/></strong>use rusqlite::{Connection, Result};</span><span id="f134" class="mh lg it my b gy nl nd l ne nf">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {<br/>  let conn = Connection::open("notes.db")?;<br/>  conn.execute(<br/>    "create table if not exists notes (<br/>      id integer primary key,<br/>      body text not null unique<br/>    )",<br/>    [],<br/>  )?;</span><span id="a08d" class="mh lg it my b gy nl nd l ne nf"><strong class="my iu">  let mut running = true;<br/>  while running == true {<br/>    let mut buffer = String::new();<br/>    io::stdin().read_line(&amp;mut buffer)?;<br/>    let trimmed_body = buffer.trim();<br/>    if trimmed_body == "" {<br/>      running = false;<br/>    } else {<br/>      conn.execute("INSERT INTO notes (body) values (?1)", [trimmed_body])?;<br/>    }<br/>  }</strong></span><span id="85bd" class="mh lg it my b gy nl nd l ne nf">  Ok(())<br/>}</span></pre><p id="5db9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了实现这一点，我们引入了一个名为<code class="fe ng nh ni my b">running</code>的<code class="fe ng nh ni my b">boolean</code>变量。当我们启动程序时，我们希望继续接受输入，所以我们将其初始化为<code class="fe ng nh ni my b">true</code>。</p><p id="e071" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni my b">let trimmed_body = buffer.trim();</code>删除输入行末尾的任何空白。这是必要的，因为<code class="fe ng nh ni my b">read_line</code>返回带有新行字符<code class="fe ng nh ni my b">\n</code>的字符串。这在你可能看到它的大多数地方是看不见的，但是为了使<code class="fe ng nh ni my b">trimmed_body == “”</code>相等检查工作是需要的。作为一个额外的好处，<code class="fe ng nh ni my b">.trim()</code>确保任何尾随空白在我们存储到数据库之前被删除。</p><p id="e383" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在可以用<code class="fe ng nh ni my b">cargo run</code>再次运行，你现在应该能够输入一个又一个音符，而不用退出程序。一旦你写完笔记，你可以输入一个空行，程序将退出。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/d567658237bbd410c2123e4bec1199bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M9VnO4pzsh-21PX9IX-sJA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在一次运行中创建多个音符</figcaption></figure><h1 id="9b5f" class="lf lg it bd kf lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">包装东西</h1><p id="0a38" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">正如开头提到的，这篇文章是一个更长系列的开始，这个系列将介绍如何使用Rust为命令行构建和设计notes应用程序。在过去的一年中，我使用了一个简单的notes应用程序作为我用来试验新技术的项目。到目前为止，我已经使用上述类似的方法使用<a class="ae le" href="https://apps.apple.com/ca/app/engram/id1568952668" rel="noopener ugc nofollow" target="_blank"> Swift iOS </a>、<a class="ae le" href="https://play.google.com/store/apps/details?id=com.xyzdigital.engram" rel="noopener ugc nofollow" target="_blank"> React Native for Android </a>、<a class="ae le" href="https://engram.xyzdigital.com/signup" rel="noopener ugc nofollow" target="_blank"> React </a>和Vanilla JavaScript构建了笔记应用程序(亲切地称为<a class="ae le" href="https://engramhq.xyz" rel="noopener ugc nofollow" target="_blank"> engram </a>)。</p><p id="cab3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我现在正在记录这个过程，因为事实证明它非常成功地让我学到了我需要知道的东西。</p><p id="f243" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你在本教程的任何部分遇到任何问题，请留下评论，我可以更新内容使其更加清晰。如果你喜欢它的发展方向，请务必在medium或Twitter上关注我，以便在未来的部分发布时获得通知。</p></div></div>    
</body>
</html>