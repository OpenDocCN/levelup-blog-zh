<html>
<head>
<title>Deblurring Images using AI and Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用人工智能和Python去模糊图像。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deblurring-images-using-ai-and-python-2e4f295c95d1?source=collection_archive---------3-----------------------#2022-11-10">https://levelup.gitconnected.com/deblurring-images-using-ai-and-python-2e4f295c95d1?source=collection_archive---------3-----------------------#2022-11-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8d3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AI可以对你很想发布但因为最终变得模糊而无法发布的图片/图像进行去模糊吗？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/902597b836f96a1f774091145d5399a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q4nJOemHz3p_5OIajMLlZw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">并排输入和输出(源Nafnet Github库)</figcaption></figure><p id="71b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">人工智能(AI)一直在以非常快的速度发展，无论是计算机视觉、NLP(自然语言处理)、语音合成、艺术创作……不胜枚举。但是它能使你的图像模糊吗，因为有人分散了你的注意力而变得模糊的完美照片？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi le"><img src="../Images/9507fa17d77b3810d630e0b2432563c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*hOXZAbs97SUhiE1pQxs4zg.gif"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd lf">去模糊Gif </strong></figcaption></figure><p id="2b8b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当然可以，而且非常简单。</p><p id="8c53" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">引入<strong class="js iu"> NAFNET </strong>(非线性激活自由网络)进行图像恢复。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lg"><img src="../Images/d99c28d63f3362597ed13eebac458c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-85K2yc2QshAHDZyOTfBw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Nafnet的输入和输出图像(图片由作者提供)</figcaption></figure><p id="0702" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">图像去噪和去模糊方法的现状。它可以去模糊，降噪，并增加您的图像的分辨率。<br/>所以，拿出你想要升级的旧图片和视频，让我们开始吧:</p><p id="bf09" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用<strong class="js iu"> Google Colab </strong>来运行NAFNET模型和输入图像。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lh"><img src="../Images/ae342e2f7cb2e0836985f4b0a820808d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2-16QFJsuu8eHDnk.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Google Colab图像</figcaption></figure><p id="3a32" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="li"> (Google colab允许我们在浏览器中运行代码，而无需在本地安装任何东西。)</em></p><p id="125d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(如果你不熟悉colab或者不想运行整个代码，<strong class="js iu">在本文<strong class="js iu">的末尾有一个web应用</strong>的链接，你可以在那里直接上传你的图片</strong>并摆弄模型。但是<strong class="js iu">我强烈建议你尝试一下代码</strong>。)</p><p id="5e75" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是模型的官方实现的GitHub库。<br/><a class="ae lj" href="https://github.com/megvii-research/NAFNet" rel="noopener ugc nofollow" target="_blank">https://github.com/megvii-research/NAFNet</a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lk"><img src="../Images/9fc59cf126ebda8b826fe03d7fbfb782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5MyNdOLw0WbHlTmdhjEaKQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Nafnet Github知识库。</figcaption></figure><p id="d7a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将使用<strong class="js iu"> Deblur Colab </strong>演示笔记本来演示该模型。别担心，你不用写任何额外的代码。所有的代码都已经写好了，你只需要运行它。)</p><p id="dda6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">转到存储库并点击选项“<strong class="js iu">在Colab中打开</strong>”。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ll"><img src="../Images/d59076cd9618ecf0571353fbc25bbd62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1D2oLTJkK77AzMNxYRKMzg.png"/></div></div></figure><p id="cd25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你会看到一个新的谷歌colab笔记本，看起来像下面的图片。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lm"><img src="../Images/3c1ad1e2f046fdaaa1acd898925f8ed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJJ_RKf9wU5PU8xc7Qqk9Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Google Colab Git克隆库</figcaption></figure><p id="2acc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行笔记本第一个单元格中给出的以下命令。</p><pre class="kp kq kr ks gt ln lo lp lq aw lr bi"><span id="2ba5" class="ls lt it lo b gy lu lv l lw lx">!git clone https://github.com/megvii-research/NAFNet</span><span id="d26a" class="ls lt it lo b gy ly lv l lw lx">%cd NAFNet</span></pre><p id="980a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的命令使用git命令从GitHub克隆Nafnet代码，并更改当前目录。</p><p id="5a89" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一个单元安装所需的库和Nafnet库。pip命令用于安装python库。运行该步骤需要一分钟。</p><pre class="kp kq kr ks gt ln lo lp lq aw lr bi"><span id="62b7" class="ls lt it lo b gy lu lv l lw lx">!pip install -r requirements.txt</span><span id="b0a2" class="ls lt it lo b gy ly lv l lw lx">!pip install --upgrade --no-cache-dir gdown</span><span id="bb8d" class="ls lt it lo b gy ly lv l lw lx">!python3 setup.py develop --no_cuda_ext</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lz"><img src="../Images/9087c25960aa5a0d497eeafd36815723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5BzJ13YpFEY6YlV8XyhDGg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Colab安装库步骤2</figcaption></figure><p id="f297" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一个单元格使用以下代码从作者的google drive 下载<strong class="js iu">预训练模型。使用<em class="li"> gdown </em>库连接到驱动器并下载模型。预训练模型的大小为272 MB。</strong></p><pre class="kp kq kr ks gt ln lo lp lq aw lr bi"><span id="7a6c" class="ls lt it lo b gy lu lv l lw lx">import gdown</span><span id="f984" class="ls lt it lo b gy ly lv l lw lx">gdown.download('https://drive.google.com/uc?id=14D4V4raNYIOhETfcuuLI3bGLB-OYIv6X', "./experiments/pretrained_models/", quiet=False)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ma"><img src="../Images/a45cd8d5f2dc6fc1782ecf9f67f0d222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t19KqVQSqD6qTKoBfXPHjg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Google Colab Google drive</figcaption></figure><p id="c9d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们需要一个图像来测试代码，幸运的是，笔记本确实为我们提供了<strong class="js iu">两个演示图像</strong>，这样我们就可以检查笔记本是否设置正确。以下命令可以做到这一点。它从作者的驱动器下载了两个演示图像。</p><pre class="kp kq kr ks gt ln lo lp lq aw lr bi"><span id="152d" class="ls lt it lo b gy lu lv l lw lx">gdown.download('https://drive.google.com/uc?id=1kWjrGsAvh4gOA_gn7rB9vnnQVfRINwEn', "demo_input/", quiet=False)</span><span id="a708" class="ls lt it lo b gy ly lv l lw lx">gdown.download('https://drive.google.com/uc?id=1xdfmGUKNDXtnWakyxcGq2nh8m18vHhSI', "demo_input/", quiet=False)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mb"><img src="../Images/92e3d822d488568816d622187710936c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6eVahOs3I1fvAgLr_NPgrQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Google Colab获取演示图片</figcaption></figure><p id="9998" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一段代码设置PyTorch、NumPy、matplotlib和OpenCV。它通过将整个过程分成4个功能来实现。<br/> 1。imread <br/> 2。img2tensor <br/> 3。显示<br/> 4。单一图像推理</p><pre class="kp kq kr ks gt ln lo lp lq aw lr bi"><span id="bbd2" class="ls lt it lo b gy lu lv l lw lx">def imread(img_path):<br/>    img = cv2.imread(img_path)<br/>    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)<br/>    return img</span><span id="b88c" class="ls lt it lo b gy ly lv l lw lx">def img2tensor(img, bgr2rgb=False, float32=True):<br/>    img = img.astype(np.float32) / 255.<br/>    return _img2tensor(img, bgr2rgb=bgr2rgb, float32=float32)</span><span id="8fe2" class="ls lt it lo b gy ly lv l lw lx">def display(img1, img2):<br/>    fig = plt.figure(figsize=(25, 10))<br/>    ax1 = fig.add_subplot(1, 2, 1)<br/>    plt.title('Input image', fontsize=16)<br/>    ax1.axis('off')<br/>    ax2 = fig.add_subplot(1, 2, 2)<br/>    plt.title('NAFNet output', fontsize=16)<br/>    ax2.axis('off')<br/>    ax1.imshow(img1)<br/>    ax2.imshow(img2)</span><span id="de61" class="ls lt it lo b gy ly lv l lw lx">def single_image_inference(model, img, save_path):<br/>  model.feed_data(data={'lq': img.unsqueeze(dim=0)})<br/>  if model.opt['val'].get('grids', False):<br/>    model.grids()<br/>    model.test()<br/>  if model.opt['val'].get('grids', False):<br/>    model.grids_inverse()<br/>    visuals = model.get_current_visuals()<br/>    sr_img = tensor2img([visuals['result']])<br/>    imwrite(sr_img, save_path)</span></pre><p id="7d3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一个单元格使用create_model函数加载模型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mc"><img src="../Images/0df7604fae3a15e796b731cac500100b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZQb52J_fikqDUd7xIbdNg.png"/></div></div></figure><p id="58d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一个单元接收演示输入图像，并输出模型处理后的图像。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi md"><img src="../Images/677a451d8107f410c5956afa86514488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*neLdWQEDsWgaNYK78Xy2Ow.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Colab上的输出(图片由作者提供)</figcaption></figure><p id="8a7f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">瞧啊。！现在你有了，用人工智能去模糊图像。</p><p id="3105" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是我们如何在不运行代码的情况下使用我们自己的图像呢？<br/> 这是一个无需运行任何代码就可以拖放的链接。要使用它，只需上传您的图像，然后点击提交。图像在CPU上运行时可能需要一些时间来处理。下面给出的例子花了50秒来处理。<br/>T10】https://huggingface.co/spaces/chuxiaojie/NAFNet</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi me"><img src="../Images/7a51e87c84e17689a174fed53984b582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwyNSgzzpYNFROtmjTKhoA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">拖放应用程序</figcaption></figure><p id="821d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">给你，AI去模糊图像。此外，该模型有一个去噪选项，您可以在提交图像去噪时选择该选项。<br/> </strong>如果你喜欢看这样的文章，<strong class="js iu"> s <em class="li">支持作者通过使用这个<a class="ae lj" href="https://medium.com/@arjungullbadhar/membership" rel="noopener">链接</a>成为一个</em> </strong>媒介会员。</p><div class="mf mg gp gr mh mi"><a rel="noopener  ugc nofollow" target="_blank" href="/colorize-black-and-white-photos-using-python-and-ai-5b3e5f85df44"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">使用Python和AI给黑白照片上色。</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">想知道你以前的黑白照片在现实中是什么样子吗？让我们找出答案。</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw ky mi"/></div></div></a></div><div class="mf mg gp gr mh mi"><a rel="noopener  ugc nofollow" target="_blank" href="/cartoonize-yourself-using-python-and-ai-24fdd4913206"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">使用Python和AI卡通化你自己</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">你有没有想过，作为一个迪士尼角色，你会是什么样子？让我们来了解一下！</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mr l"><div class="mx l mt mu mv mr mw ky mi"/></div></div></a></div></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="8ff5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="li">嘿伙计们，</em></p><p id="d762" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我对媒体写作很陌生，希望听到你的反馈。如果你喜欢我写的东西，不要犹豫，竖起大拇指或者留下提示。如有疑问或推荐，欢迎随时 <strong class="js iu"> <em class="li">留言评论。</em> </strong> <em class="li">我看了每一条留言，尽可能快的回复。</em></p><p id="4d9c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">阿尔琼·古尔巴达尔</p></div></div>    
</body>
</html>