<html>
<head>
<title>Advance your NumPy skills with these functions and operators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用这些函数和运算符提高您的数字技能</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/advance-your-numpy-skills-with-these-functions-and-operators-8b52efd138fe?source=collection_archive---------2-----------------------#2022-09-24">https://levelup.gitconnected.com/advance-your-numpy-skills-with-these-functions-and-operators-8b52efd138fe?source=collection_archive---------2-----------------------#2022-09-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="370a" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">计算机编程语言</h2><div class=""/><div class=""><h2 id="61e7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">学会使用einsum、sliding_window_view、@运算符、省略号对象和几种整形方法来提高自己的NumPy技能。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/a84ca58774af6c5b00f6b5942bf31d85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZMLRgE_TaS7FC8WVqP14JA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">使用Midjourney生成的图像。</figcaption></figure><h1 id="8904" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">滑动窗口视图()</h1><p id="801e" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">你做过向量或矩阵的滑动运算吗？例如，假设我们有一个向量<code class="fe mv mw mx my b">x</code>,我们想在向量上滑动一个大小为100的窗口，并计算均方值。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="9aba" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">这可以通过以下方式实现:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="cc8c" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">在这里，我使用jupyter笔记本中的神奇命令<code class="fe mv mw mx my b">%timeit</code>对函数计时。现在，如果我告诉你有一个更简单更快捷的方法……这个方法叫做<code class="fe mv mw mx my b">sliding_window_view()</code>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="45b8" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">这是大约19倍的加速！</p><p id="9120" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">那么它是如何工作的呢？如果您想要在多个维度上执行滑动窗口操作，该函数将一个向量或矩阵作为第一个参数，将一个具有单个值或元组的窗口作为第二个参数。第三个参数描述操作应用于哪个(些)维度。</p><p id="a789" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">但是这样不是很消耗内存吗？它没有！注意函数的名字，sliding_window_ <strong class="mb jd"> view。</strong>NumPy中的视图不改变原始数据缓冲区，只改变元数据。因此，数据不会被复制，使得操作非常高效。但是，这意味着在数组中的多个位置引用了相同的数据。因此，NumPy增加了一项保护措施，以防您修改对象:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="c5c6" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">如果您仍然想修改数组，您可以将关键字参数<code class="fe mv mw mx my b">writeable=True</code>添加到函数中。但是要小心，正如您在下面看到的，当我修改数组时，数组中的多个值都发生了变化:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="9c83" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">还有更快的方法使用<code class="fe mv mw mx my b"><a class="ae ng" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.fftconvolve.html#scipy.signal.fftconvolve" rel="noopener ugc nofollow" target="_blank">scipy.signal.fftconvolve</a></code>进行窗口卷积操作，但这并不适用于所有操作。</p><h1 id="3c49" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">@运算符</h1><p id="d842" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated"><code class="fe mv mw mx my b">@</code>运算符与NumPy中普通的矩阵乘法(即<code class="fe mv mw mx my b">np.matmul()</code>)相同，但更简洁。那就是:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="d275" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">我个人一直写<code class="fe mv mw mx my b">@</code>而不是<code class="fe mv mw mx my b">matmul</code>。</p><h1 id="a625" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">省略号对象</h1><p id="ac0a" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">省略号是一个Python对象。只需输入<code class="fe mv mw mx my b">Ellipsis</code>或更常见的使用<code class="fe mv mw mx my b">...</code>即可使用。在NumPy中，它在索引期间使用。当索引一个NumPy张量时，它实质上在剩余的未指定维度上添加了“:”，并且在处理许多维度时可以非常方便:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="c9f1" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">new axis vs . expand _ dims()vs . shape()</h1><p id="dbc3" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">在很多情况下，你想改变张量的形状而不改变它的内容。<code class="fe mv mw mx my b">.reshape()</code>是最灵活的方法，可以执行任何尺寸变化。另一个用例是简单地添加一个只有一个元素的新维度，例如将(10，)改为(10，1)。然后你可以用<code class="fe mv mw mx my b">np.newaxis</code>或者<code class="fe mv mw mx my b">expand_dims</code>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1f41" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">假设你有一个形状为(10，10)的矩阵，你想把它变成一个形状为(10，10，1，1，1)的张量，让我们看看这三种方法是如何做到的:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="ae86" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">挤压()</h1><p id="7690" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">现在想象一下相反的问题。我们有一个张量，它有一个或多个尺寸为1的维度，我们想把它们去掉。我们该怎么办？<code class="fe mv mw mx my b">.reshape()</code>工作一如既往，但是如果维度很多就有点繁琐了。相反，我们可以使用<code class="fe mv mw mx my b">.squeeze()</code>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="8654" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">einsum()</h1><p id="ab22" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">这种方法可以做许多事情；<code class="fe mv mw mx my b">einsum</code>代表<em class="nh">爱因斯坦求和约定</em>，是一种简洁地编写张量运算公式的方式。首先，我将向您展示它的一些功能示例:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8565" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">那么这个黑魔法是什么？让我们复习一下公式。这里我来解释一下<em class="nh">显式</em>模式。还有<em class="nh">隐式</em>模式，工作方式略有不同。例如，描述尺寸的字母的字母顺序在隐式模式下很重要，但在显式模式下则无关紧要。你可以在<a class="ae ng" href="https://numpy.org/doc/stable/reference/generated/numpy.einsum.html" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多信息。</p><p id="69a7" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">有两部分，左手侧和右手侧由箭头<code class="fe mv mw mx my b">-&gt;</code>分开:</p><p id="ad30" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated"><code class="fe mv mw mx my b">&lt;left-hand side&gt;</code> <code class="fe mv mw mx my b">-&gt;</code> <code class="fe mv mw mx my b">&lt;right-hand side&gt;</code></p><p id="31f4" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">左手边描述了所涉及的张量的维数。每个字母代表一个维度，每个张量用逗号隔开。所有尺寸都必须写下来。如果一个字母重复出现，则该字母所代表的尺寸会成倍增加(因此，如果使用相同的字母，则尺寸必须相同)。因此，像<code class="fe mv mw mx my b">ij,jk</code>这样的左侧表达式意味着一个维度为<code class="fe mv mw mx my b">ij</code>的张量和另一个维度为<code class="fe mv mw mx my b">jk</code>的张量。由于重复了<code class="fe mv mw mx my b">j</code>，将执行第一张量的第二轴与第二张量的第一轴的乘法(即，第一矩阵的行与第二矩阵的列):</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="7fb1" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">接下来，在右边，结果表达式被公式化。这里省略的尺寸/字母将在上进行<em class="nh">求和，每个字母最多只能出现一次。在上面的例子中，保留了最大可能的张量，但是通过移除索引，我们可以通过对其求和来降低维度:</em></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="a381" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">特殊情况是，如果你有一个尺寸相同的张量，并且在左边为这个张量多次指定相同的字母。然后，通过指定一个字母或对角线的和(如果留空)来获得右侧的对角线:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8e74" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">您还可以控制尺寸的最终<em class="nh">顺序</em>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="c0cd" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">更多信息，请查看官方<a class="ae ng" href="https://numpy.org/doc/stable/reference/generated/numpy.einsum.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="b6a9" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">为什么当你处理多维度时，事情会变得混乱。谁没有尝试过一些复杂的张量乘法，然后检查结果张量的形状，以确认它工作正常？有了einsum，最终结果变得更加清晰。此外，您还学习了一种跨框架甚至跨语言的通用技术。NumPy、Pytorch和TensorFlow就是可以在Python中使用einsum的库的例子。虽然框架的细节可能不同，但符号将保持不变。</p><p id="97af" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">感谢阅读。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="f76c" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">如果你想注册一个中级会员(无限故事)，同时也支持我，你可以使用我的<a class="ae ng" href="https://medium.com/@dreamferus/membership" rel="noopener">推荐链接</a>。然后我会收到佣金(但是价格对你来说不变！).祝你有愉快的一天。</p><div class="np nq gp gr nr ns"><a href="https://medium.com/@dreamferus/membership" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">通过我的推荐链接加入Medium—Jacob Ferus</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">阅读Jacob Ferus(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og lb ns"/></div></div></a></div></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="9659" class="lh li it bd lj lk oh lm ln lo oi lq lr ki oj kj lt kl ok km lv ko ol kp lx ly bi translated">分级编码</h1><p id="2cde" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="ec08" class="om on it mb b mc nb mf nc mi oo mm op mq oq mu or os ot ou bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="f714" class="om on it mb b mc ov mf ow mi ox mm oy mq oz mu or os ot ou bi translated">📰查看<a class="ae ng" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="4b1d" class="om on it mb b mc ov mf ow mi ox mm oy mq oz mu or os ot ou bi translated">🔔关注我们:<a class="ae ng" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ng" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ng" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="a16e" class="pw-post-body-paragraph lz ma it mb b mc nb kd me mf nc kg mh mi nd mk ml mm ne mo mp mq nf ms mt mu im bi translated">🚀👉<a class="ae ng" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="mb jd">将像你这样的开发人员安置在顶级创业公司和科技公司</strong> </a></p></div></div>    
</body>
</html>