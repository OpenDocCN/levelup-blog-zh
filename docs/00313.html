<html>
<head>
<title>Managing Wildcard Subdomains with Vue-Router</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Vue路由器管理通配符子域</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/managing-wildcard-subdomains-with-vue-router-9fd74518f2f5?source=collection_archive---------3-----------------------#2019-01-02">https://levelup.gitconnected.com/managing-wildcard-subdomains-with-vue-router-9fd74518f2f5?source=collection_archive---------3-----------------------#2019-01-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/9017a8fb19a08de86c52cc01e9d3aa09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*-OyoCjLHQrS2u2MgQldN3A.png"/></div></div></figure><div class=""/><h1 id="876a" class="jy jz jb bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">处理子域</h1><p id="ea54" class="pw-post-body-paragraph kw kx jb ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在很多情况下，web应用程序需要使用通配符子域——最常见的例子是当用户拥有自己的子域时的应用程序(例如<em class="lu">mysite.wordpress.com</em>)。但是，vue-router没有内置这一功能，需要我们来实现。这将通过使用vue-router的两个特性来实现，这两个特性很容易在它的文档中找到:命名路由和<code class="fe lv lw lx ly b">router.beforeEach()</code>功能。</p><p id="4462" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">有两种方法可以识别vue-route，它的路径和它的名字。虽然路径是每个路由的必需部分，但名称是可选的，但它将允许我们区分初始路由器请求和使用子路由器重定向的请求。在完整的应用程序中，这应该是最后一个路由，因为它还会捕获所有通配符条目。很简单。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div class="gh gi me"><img src="../Images/8cb5998d7ac9302b658b39b80854e29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/0*PeE0PaWz9JDbDwJ5"/></div></figure><p id="0ad9" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">创建命名路由后，更具挑战性的步骤是根据子域找到链接它们的方法。为此，我们将不得不使用Vue路由器的<a class="ae mj" href="https://router.vuejs.org/guide/advanced/navigation-guards.html#global-guards" rel="noopener ugc nofollow" target="_blank"> beforeEach </a>方法。<code class="fe lv lw lx ly b">beforeEach</code>方法是允许路由器重定向或取消请求的导航保护措施之一。顾名思义，这个方法是在路由器搜索路由数组之前调用的，这将允许我们在加载任何东西之前进行所有的子域检查和路由。</p><p id="4624" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">首先，在路由器的<code class="fe lv lw lx ly b">index.js</code>中，添加以下代码来定义<code class="fe lv lw lx ly b">beforeEach</code>导航保护。这些都包含在文档中，所以如果你觉得更容易的话，可以随意使用。我不会被冒犯的。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/2a8d34c154d0b61b00cd11ca8efc7d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/0*MU4nmk0Ag75cIirN"/></div></figure><p id="e6ad" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">然后，通过解析传递给路由器的URL，我们可以确定是否存在子域。因为下面的代码使用了<code class="fe lv lw lx ly b">.split</code>来获取子域，如果没有子域，就会设置为等于你的域名。这里有一些清晰的例子。</p><ul class=""><li id="133b" class="ml mm jb ky b kz lz ld ma lh mn ll mo lp mp lt mq mr ms mt bi translated"><em class="lu">example.mysite.com</em>—子域将等同于“示例”</li><li id="1497" class="ml mm jb ky b kz mu ld mv lh mw ll mx lp my lt mq mr ms mt bi translated"><em class="lu">mysite.com</em>—子域将等于“我的网站”</li></ul><figure class="mf mg mh mi gt is gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/bfa510d63d84bdad0e2663f92afb11aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/0*qtLG4vyAgvWxmiPi"/></div></figure><p id="0e50" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">if语句有两个检查。首先，它检查是否没有我前面提到的子域。其次，它检查请求是否指向已经是正确页面的路由。这第二个检查非常重要，因为如果没有它，这个循环将会无限地调用自己并破坏你的代码。现在，这个代码块中的关键行是接下来的两个调用。<code class="fe lv lw lx ly b">next()</code>是允许路由器继续搜索正确路由所需的功能。根据文档…</p><ul class=""><li id="0c0e" class="ml mm jb ky b kz lz ld ma lh mn ll mo lp mp lt mq mr ms mt bi translated">。下一步({路径:路径}或{名称:名称})-重定向到新位置，中止当前导航，并开始新的导航</li><li id="d06b" class="ml mm jb ky b kz mu ld mv lh mw ll mx lp my lt mq mr ms mt bi translated">next()-不带任何参数，移动到管道中的下一个挂钩</li></ul><blockquote class="na nb nc"><p id="1bb0" class="kw kx lu ky b kz lz lb lc ld ma lf lg nd mb lj lk ne mc ln lo nf md lr ls lt ij bi translated">注意:本教程是为所有用户子域使用相同页面组件的应用程序设计的。如果需要多个组件，只需在。下一个()调用。</p></blockquote><p id="eb79" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">现在，我将讨论如何在你的计算机上进行本地测试，以及如何处理Google域中的通配符子域。</p><h1 id="3fb3" class="jy jz jb bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">测试本地和谷歌域名</h1><p id="116e" class="pw-post-body-paragraph kw kx jb ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">大多数情况下，当实现预先确定的静态子域时，您可以简单地将CNAME添加到您的DNS中，并非常容易地重新路由所有内容，但使用通配符时，它会变得不太直观，因为不可能明确地将每个可能的子域添加到您的DNS中。对于谷歌域名，只需添加一个CNAME，但要引用*，这表示一个通配符。我假设其他提供商也有类似的流程。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ng"><img src="../Images/1afb3d86b91a229776523560f959a781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eHsX1SYhZaXmfx7G"/></div></div></figure><p id="a56c" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">让子域在本地工作更令人困惑，因为你的系统自然地在<code class="fe lv lw lx ly b">localhost</code>开始项目，这不允许子域或重新路由。为了解决这个问题，安装<a class="ae mj" href="http://www.thekelleys.org.uk/dnsmasq/doc.html" rel="noopener ugc nofollow" target="_blank"> dnsmasq </a>，一个允许你控制本地域名系统的小工具。有一篇优秀的Medium <a class="ae mj" href="https://medium.com/@kharysharpe/automatic-local-domains-setting-up-dnsmasq-for-macos-high-sierra-using-homebrew-caf767157e43" rel="noopener">文章</a>作者<a class="nh ni ep" href="https://medium.com/u/3c106ae5c576?source=post_page-----9fd74518f2f5--------------------------------" rel="noopener" target="_blank">卡瑞·夏普</a>可以带你完成配置本地DNS的过程。</p><p id="7f5a" class="pw-post-body-paragraph kw kx jb ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">希望这个小指南有所帮助。祝你好运！</p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><figure class="mf mg mh mi gt is gh gi paragraph-image"><a href="https://levelup.gitconnected.com/"><div class="gh gi nq"><img src="../Images/439094b9a664ef0239afbc4565c6ca49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9uYu-fFL3hIQLGVu0o-EQ.png"/></div></a></figure><div class="ip iq gp gr ir nr"><a href="https://gitconnected.com/learn/vue-js" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd jc gy z fp nw fr fs nx fu fw ja bi translated">学习Vue.js -最佳Vue.js教程(2019) | gitconnected</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">排名前26的Vue.js教程。课程由开发者提交并投票，让你找到最好的Vue.js…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">gitconnected.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ix nr"/></div></div></a></div></div></div>    
</body>
</html>