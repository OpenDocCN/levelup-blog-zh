<html>
<head>
<title>Building a simple website that outputs results from a CSV using user’s input</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立一个简单的网站，使用用户的输入从CSV输出结果</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-a-simple-website-that-outputs-results-from-a-csv-using-users-input-bfcb782ced45?source=collection_archive---------0-----------------------#2021-01-05">https://levelup.gitconnected.com/building-a-simple-website-that-outputs-results-from-a-csv-using-users-input-bfcb782ced45?source=collection_archive---------0-----------------------#2021-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e12223410522b7a2d448bfb9d167855a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cWfis810xPoWiauuHNm1Gg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">https://jurgenarias.github.io/movies/山谬·里维最佳电影</figcaption></figure><p id="1643" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在寻找一个网站，在那里我可以搜索任何演员/女演员的最佳电影，但我不能找到任何一个提供我想要的特定电影。我不得不谷歌一个男演员/女演员，然后找到他/她的电影，然后找到每部电影的评级，然后进行比较。它效率不高…所以我决定为它做一个网站。</p><p id="5570" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在<a class="ae kc" href="https://www.kaggle.com/stefanoleone992/imdb-extensive-dataset" rel="noopener ugc nofollow" target="_blank"> kaggle </a>的IMDB上找到了电影数据。CSV包含大约85k部电影和175k+演职人员。CSV包括我需要的一切，从电影的名字，演员的名字，它的IMDB评级等等。一个简单的通过<em class="lb">字符串过滤包含</em>和按等级排序的演员列将产生期望的输出。有趣的部分是用它做一个网站…</p><p id="5466" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面，我将介绍构建网站所需的html和JavaScript。</p><h1 id="414c" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak"> HTML </strong></h1><p id="de6f" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">为了建立网站，我使用了Visual Studio代码(然而，任何软件都可以完成这项工作)。你一打<em class="lb">！+ tab </em>将出现基本的html模板:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="1bb5" class="mo ld iq mk b gy mp mq l mr ms">&lt;!DOCTYPE html&gt;</span><span id="4046" class="mo ld iq mk b gy mt mq l mr ms">&lt;html lang=”en”&gt;</span><span id="69fe" class="mo ld iq mk b gy mt mq l mr ms">&lt;head&gt;</span><span id="0ecc" class="mo ld iq mk b gy mt mq l mr ms">&lt;meta charset=”UTF-8"&gt;</span><span id="c42f" class="mo ld iq mk b gy mt mq l mr ms">&lt;meta name=”viewport” content=”width=device-width, initial-scale=1.0"&gt;</span><span id="0006" class="mo ld iq mk b gy mt mq l mr ms">&lt;title&gt;Document&lt;/title&gt;</span><span id="0796" class="mo ld iq mk b gy mt mq l mr ms">&lt;/head&gt;</span><span id="b2cf" class="mo ld iq mk b gy mt mq l mr ms">&lt;body&gt;</span><span id="329f" class="mo ld iq mk b gy mt mq l mr ms">&lt;/body&gt;</span><span id="e64d" class="mo ld iq mk b gy mt mq l mr ms">&lt;/html&gt;</span></pre><p id="d77c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一步是添加引导链接，以改善网站的视觉效果，使其更加用户友好。这一步完全是可选的，但是如果没有它，网站看起来就像是90年代制作的。</p><p id="7917" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了能够使用bootstrap，我在头部添加了以下内容:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="e531" class="mo ld iq mk b gy mp mq l mr ms">&lt;link rel=”stylesheet” href=”https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity=”sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T” crossorigin=”anonymous”&gt;</span></pre><p id="50fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">…完成了！我现在可以使用bootstrap了。</p><p id="307e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我把<em class="lb"> &lt;体&gt; </em>分成两部分:输入和输出。下面是输入部分:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="2d65" class="mo ld iq mk b gy mp mq l mr ms">&lt;body&gt;</span><span id="c7b0" class="mo ld iq mk b gy mt mq l mr ms">&lt;div class=”container”&gt;</span><span id="2e02" class="mo ld iq mk b gy mt mq l mr ms">&lt;div class=”row”&gt;</span><span id="5ec9" class="mo ld iq mk b gy mt mq l mr ms">&lt;div class=”col-md-12"&gt;</span><span id="9924" class="mo ld iq mk b gy mt mq l mr ms">&lt;h1 class=&gt;Find Movies!&lt;/h1&gt;</span><span id="1c62" class="mo ld iq mk b gy mt mq l mr ms">&lt;h2 class=&gt;Enter the name of an actor/actress to see his/her best movies!&lt;/h2&gt;</span><span id="67c9" class="mo ld iq mk b gy mt mq l mr ms">&lt;form id=”form”&gt;</span><span id="c34e" class="mo ld iq mk b gy mt mq l mr ms">&lt;input class=”form-control” id=”user-input” placeholder=”Enter actor/actress…”&gt;</span><span id="8cbb" class="mo ld iq mk b gy mt mq l mr ms">&lt;button id=”button” class=”btn btn-secondary”&gt;Find Movies!&lt;/button&gt;</span><span id="596b" class="mo ld iq mk b gy mt mq l mr ms">&lt;/form&gt;</span></pre><p id="6d2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">容器</em>、<em class="lb">行</em>和<em class="lb"> col-md-12 </em>的前3个&lt;<em class="lb"> div &gt;和</em>只是引导结构，用于在容器中对齐内容。然后我用&lt; <em class="lb"> h1 &gt; </em>创建了一个标题，用&lt; <em class="lb"> h2 &gt; </em>创建了一个副标题。</p><p id="2354" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来是重要的部分。我使用了一个带有id的&lt;<em class="lb">表单&gt; </em>(注意id和类对于引用JavaScript文件或引导样式很重要)。在表单内部，我有一个&lt; <em class="lb">输入&gt; </em>，其中包含用于引导的类、用于JavaScript的id和一个用于在网站中显示的占位符。最后，我有一个&lt; <em class="lb">按钮&gt; </em>，id为JavaScript，类为bootstrap，有一些文本显示在网站中。</p><p id="5fe0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是输出部分:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="b759" class="mo ld iq mk b gy mp mq l mr ms">&lt;table class="table" cellpadding="10"&gt;</span><span id="8115" class="mo ld iq mk b gy mt mq l mr ms">&lt;thead&gt;</span><span id="6fe1" class="mo ld iq mk b gy mt mq l mr ms">&lt;tr&gt;</span><span id="9b64" class="mo ld iq mk b gy mt mq l mr ms">&lt;th scope="col"&gt;#&lt;/th&gt;</span><span id="6c33" class="mo ld iq mk b gy mt mq l mr ms">&lt;th scope="col"&gt;Movie&lt;/th&gt;</span><span id="4770" class="mo ld iq mk b gy mt mq l mr ms">&lt;th scope="col"&gt;Rating&lt;/th&gt;</span><span id="6800" class="mo ld iq mk b gy mt mq l mr ms">&lt;th scope="col"&gt;Year&lt;/th&gt;</span><span id="6a66" class="mo ld iq mk b gy mt mq l mr ms">&lt;th scope="col"&gt;Description&lt;/th&gt;</span><span id="36d9" class="mo ld iq mk b gy mt mq l mr ms">&lt;/tr&gt;</span><span id="0f6c" class="mo ld iq mk b gy mt mq l mr ms">&lt;/thead&gt;</span><span id="3774" class="mo ld iq mk b gy mt mq l mr ms">&lt;tbody&gt;</span><span id="d519" class="mo ld iq mk b gy mt mq l mr ms">&lt;/div&gt;</span><span id="2848" class="mo ld iq mk b gy mt mq l mr ms">&lt;/div&gt;</span><span id="50b5" class="mo ld iq mk b gy mt mq l mr ms">&lt;/div&gt;</span></pre><p id="b14f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我创建了一个&lt;<em class="lb">表格&gt; </em>，并添加了一些填充(让它看起来更好)。然后，我创建了&lt; <em class="lb">和&gt; </em>，这是创建列标题的地方。在这一步之后，我需要为所有的标题设置一行，因此为每一列设置了<em class="lb">&lt;&gt;</em>和所有的<em class="lb">&lt;&gt;</em>。然后我关闭了<em class="lb"> &lt;和&gt; </em>并启动了<em class="lb"> &lt; tbody &gt; </em>这是输出将出现的地方。最后，我正在关闭来自<em class="lb">容器</em>、<em class="lb">行</em>和之前的<em class="lb"> col-md-12 </em>的3个<em class="lb"> &lt; div &gt; </em>。</p><p id="ed31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">网站的骨架完成了！从这一点来看，网站应该是这样的:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/9f2c3aa6ad09811c3ee036b82a142459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mg05zoeVjOk8j9ODb4FD3Q.png"/></div></div></figure><p id="6f7e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与没有自举的情况相比:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/f50388669819f4c5e74002dcf5ebfcd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mrOtZqZ-22mS5NrdXBUJQA.png"/></div></div></figure><p id="5ffe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这标志着网站html部分的结束。当然，在这个阶段，网站什么都不做。它仍然需要一个JavaScript文件才能变得有用。</p><h1 id="3ec0" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">Java Script语言</h1><p id="c6bc" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">我使用JavaScript加载CSV，获取用户输入，过滤CSV并显示结果。</p><p id="6bce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个<em class="lb">。需要js </em>文件。我把它命名为<em class="lb"> app.js </em>，保存在html和CSV文件旁边的文件夹里。</p><p id="34a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用了<a class="ae kc" href="https://d3js.org/" rel="noopener ugc nofollow" target="_blank"> D3 </a>，这是一个非常有用的JavaScript库，用于基于数据操作文档。为了使用D3，我需要将脚本添加到html的头部:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="e3cf" class="mo ld iq mk b gy mp mq l mr ms">&lt;script src=”https://d3js.org/d3.v5.min.js"&gt;&lt;/script&gt;</span></pre><p id="6e2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一切都取决于来自CSV的数据，因此首先要做的是使用D3读取CSV，然后应用一个函数:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="2b64" class="mo ld iq mk b gy mp mq l mr ms">d3.csv(“movies.csv”).then(function (data) {</span><span id="211a" class="mo ld iq mk b gy mt mq l mr ms">var movies = data;</span><span id="e590" class="mo ld iq mk b gy mt mq l mr ms">var button = d3.select(“#button”);</span><span id="68c6" class="mo ld iq mk b gy mt mq l mr ms">var form = d3.select(“#form”);</span><span id="585e" class="mo ld iq mk b gy mt mq l mr ms">button.on(“click”, runEnter);</span><span id="b17c" class="mo ld iq mk b gy mt mq l mr ms">form.on(“submit”, runEnter);</span></pre><p id="6417" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我创建了3个变量:引用CSV的<em class="lb"> movies </em>，引用html中按钮的<em class="lb"> button </em>，引用html中表单的<em class="lb"> form </em>。使用button.on("click "，runEnter)和form.on("submit "，runEnter)，允许用户在我们的网站上按下按钮或按下回车键，javascript将运行runEnter函数。</p><p id="d8f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以定义我们的runEnter函数，我将更详细地解释它，因为它是最重要的部分:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="da6c" class="mo ld iq mk b gy mp mq l mr ms">// Defining the function</span><span id="e321" class="mo ld iq mk b gy mt mq l mr ms">function runEnter() {</span><span id="630a" class="mo ld iq mk b gy mt mq l mr ms"><br/>// This line of code selects the &lt;tbody&gt; from the html and clears it. If this is not used, then the results would appear on top of the previous result.</span><span id="6d4a" class="mo ld iq mk b gy mt mq l mr ms">d3.select(“tbody”).html(“”) </span><span id="0bab" class="mo ld iq mk b gy mt mq l mr ms"><br/>// This code is needed to prevent the page from reloading.</span><span id="dba1" class="mo ld iq mk b gy mt mq l mr ms">d3.event.preventDefault(); </span><span id="c4c2" class="mo ld iq mk b gy mt mq l mr ms"><br/>// This code will get the user's input from what the user will type in the html &lt;input&gt; since we assigned it the "user-input" id. It will get the value and store it in our inputValue variable</span><span id="1abd" class="mo ld iq mk b gy mt mq l mr ms">var inputValue = d3.select(“#user-input”).property("value");</span><span id="948a" class="mo ld iq mk b gy mt mq l mr ms"><br/>// This code will filter the movies looking at the actors column. It will store the values when there is a match from the text sequence the user entered and the text from our actors column from the CSV data.</span><span id="9e06" class="mo ld iq mk b gy mt mq l mr ms">var filteredMovies = <br/>movies.filter(movies =&gt; movies.actors.includes(inputValue));</span><span id="0a97" class="mo ld iq mk b gy mt mq l mr ms"><br/>// This was the easiest approach I found to sort the results by a different column in descending order. I had to include a new script in my head to use the _.sortBy <br/>This is the script:  <br/><em class="lb">&lt;script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.10.0/lodash.min.js"&gt;&lt;/script&gt;</em></span><span id="e7f4" class="mo ld iq mk b gy mt mq l mr ms">var output = _.sortBy(filteredMovies, ‘avg_vote’).reverse()<br/></span><span id="5ce7" class="mo ld iq mk b gy mt mq l mr ms">// Once I had all the values in my output variable, all I needed was to loop through them and add them to the table one by one. This was done using d3, where I inserted the value for each one of the columns I wanted using the necessary html to fit each table row.</span><span id="49ca" class="mo ld iq mk b gy mt mq l mr ms">for (var i = 0; i &lt; filteredMovies.length; i++) {</span><span id="adcf" class="mo ld iq mk b gy mt mq l mr ms">d3.select(“tbody”).insert(“tr”).html(<br/>“&lt;td&gt;” + [i+1] + ”&lt;/td&gt;” +<br/>”&lt;td&gt;” + (output[i][‘original_title’])+”&lt;/a&gt;”+“&lt;/td&gt;” + <br/>”&lt;td&gt;” + (output[i][‘avg_vote’])+”&lt;/td&gt;” +<br/>”&lt;td&gt;” + (output[i][‘year’])+”&lt;/td&gt;” +<br/>”&lt;td&gt;” + (output[i][‘description’])+”&lt;/td” ) }</span><span id="f773" class="mo ld iq mk b gy mt mq l mr ms">};</span><span id="6aac" class="mo ld iq mk b gy mt mq l mr ms">});</span></pre><p id="0425" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码部分到此为止！为了使网站正常运行，剩下的工作就是将脚本添加到网站的html中(我在标题上添加了这个脚本) :</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="1735" class="mo ld iq mk b gy mp mq l mr ms">&lt;script src=”app.js”&gt;&lt;/script&gt;</span></pre><p id="77e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以使用css或者通过下载模板和添加你的代码来添加很多风格，让你的网站看起来像你想要的那样！</p><h1 id="9b8a" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结果</h1><p id="fafc" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">你可以在这里  看到并使用我的最终版本<a class="ae kc" href="https://jurgenarias.github.io/movies/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">。</em></strong></a></p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a0ceb156b1a8bf9d62514d06c57d9fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/1*v-cYfUpBM99oWAs1anVMsg.gif"/></div></figure></div></div>    
</body>
</html>