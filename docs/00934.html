<html>
<head>
<title>Build a Native Desktop App with React and Electron</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React和Electron构建原生桌面应用</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-make-a-windows-app-with-react-and-electron-fad5294fae5c?source=collection_archive---------1-----------------------#2019-09-23">https://levelup.gitconnected.com/how-to-make-a-windows-app-with-react-and-electron-fad5294fae5c?source=collection_archive---------1-----------------------#2019-09-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4a20" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用React和Electron为Windows、Linux和Mac构建本地应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/edf87f851dfa63f1fa46597d8717c310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJJDr1RvDt8OGivZ8FzKig.png"/></div></div></figure><p id="e02f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于网络开发人员来说，制作一个Windows应用程序需要相当长的学习曲线。不过现在有了一个解决方案，用Electron把一个JavaScript web app转换成Windows(或者Max/Linux) app，不需要太多的工作。React可以很容易地与Electron结合，构建一个原生的Windows应用程序。</p><p id="d7ee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一些开发人员已经为用React构建电子应用程序制作了样板文件。其中最容易开始的是<a class="ae lq" href="https://github.com/electron-react-boilerplate/electron-react-boilerplate" rel="noopener ugc nofollow" target="_blank">https://github . com/electron-react-boilerplate/electron-react-boilerplate</a>。</p><p id="42ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这个故事中，我们将构建一个与后端通信的地址簿应用程序，以将数据保存到后端。我们将使用React Boostrap进行样式设计，使用Formik和Yup进行表单验证和更新，使用Axios作为我们的HTTP客户端。它将有一个主页，其中有一个显示联系人列表的表格，每行有编辑或删除联系人的按钮，还有一个添加和编辑联系人的表单。我们将使用Redux在客户端存储联系人的状态。</p><p id="90d9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我们检查一下<a class="ae lq" href="https://github.com/electron-react-boilerplate/electron-react-boilerplate" rel="noopener ugc nofollow" target="_blank">样板代码</a>。我们将代码复制到我们自己的文件夹中，然后我们可以添加我们的库。要添加库，我们将使用Yarn。按照<a class="ae lq" href="https://yarnpkg.com/lang/en/docs/install/#windows-stable" rel="noopener ugc nofollow" target="_blank">官方说明</a>安装。我们需要安装最新版本的Node.js LTS。</p><p id="2163" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来我们运行<code class="fe lr ls lt lu b">yarn add axios formik yup bootstrap jquery react-bootstrap redux react-redux</code>。安装完软件包后。我们可以开始写代码了。我们将修改代码的文件夹结构。</p><p id="d57d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将用我们的文件替换<code class="fe lr ls lt lu b">app</code>文件夹中的文件。首先，我们移除<code class="fe lr ls lt lu b">actions</code>、<code class="fe lr ls lt lu b">components</code>、<code class="fe lr ls lt lu b">constants</code>、<code class="fe lr ls lt lu b">containers</code>、<code class="fe lr ls lt lu b">reducers</code>、<code class="fe lr ls lt lu b">store</code>和<code class="fe lr ls lt lu b">util</code>文件夹。然后，我们将把所有文件添加到这个文件夹中。我们从创建<code class="fe lr ls lt lu b">actionCreator.js</code>开始，并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="98d0" class="lz ma it lu b gy mb mc l md me">import { SET_CONTACTS } from './actions';</span><span id="5fa8" class="lz ma it lu b gy mf mc l md me">const setContacts = contacts =&gt; {<br/>  return {<br/>    type: SET_CONTACTS,<br/>    payload: contacts<br/>  };<br/>};</span><span id="a9c2" class="lz ma it lu b gy mf mc l md me">export { setContacts };</span></pre><p id="60d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将创建Redux store的操作来设置我们的联系人。接下来，我们创建<code class="fe lr ls lt lu b">actions.js</code>并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="01d9" class="lz ma it lu b gy mb mc l md me">const SET_CONTACTS = 'SET_CONTACTS';</span><span id="cb52" class="lz ma it lu b gy mf mc l md me">export { SET_CONTACTS };</span></pre><p id="b211" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我们之前为动作创建器使用的常量。</p><p id="3008" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们创建一个名为<code class="fe lr ls lt lu b">App.js</code>的文件，并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="97c3" class="lz ma it lu b gy mb mc l md me">import React from 'react';<br/>import { Router, Route, Link, HashRouter } from 'react-router-dom';<br/>import HomePage from './HomePage';<br/>import { createBrowserHistory as createHistory } from 'history';<br/>import Navbar from 'react-bootstrap/Navbar';<br/>import Nav from 'react-bootstrap/Nav';<br/>import './App.css';<br/>const history = createHistory();</span><span id="028a" class="lz ma it lu b gy mf mc l md me">function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;HashRouter history={history}&gt;<br/>        &lt;Navbar bg="primary" expand="lg" variant="dark"&gt;<br/>          &lt;Navbar.Brand href="#/"&gt;Address Book App&lt;/Navbar.Brand&gt;<br/>          &lt;Navbar.Toggle aria-controls="basic-navbar-nav" /&gt;<br/>          &lt;Navbar.Collapse id="basic-navbar-nav"&gt;<br/>            &lt;Nav className="mr-auto"&gt;<br/>              &lt;Nav.Link href="#/"&gt;Home&lt;/Nav.Link&gt;<br/>            &lt;/Nav&gt;<br/>          &lt;/Navbar.Collapse&gt;<br/>        &lt;/Navbar&gt;<br/>        &lt;Route path="/" exact component={HomePage} /&gt;<br/>      &lt;/HashRouter&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="3e35" class="lz ma it lu b gy mf mc l md me">export default App;</span></pre><p id="8280" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个文件，包括引导导航栏和我们唯一的路线，这是主页。请注意，我们在路由之前有一个散列，我们使用的是<code class="fe lr ls lt lu b">HashRouter</code>而不是<code class="fe lr ls lt lu b">Router</code>。这是因为电子不能与常规的<code class="fe lr ls lt lu b">Router</code>一起使用。接下来，我们创建<code class="fe lr ls lt lu b">App.css</code>并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="6c89" class="lz ma it lu b gy mb mc l md me">.App {<br/>  text-align: center;<br/>}</span></pre><p id="ad45" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe lr ls lt lu b">app.html</code>中，我们将现有代码替换为:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="f05f" class="lz ma it lu b gy mb mc l md me">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;</span><span id="2a74" class="lz ma it lu b gy mf mc l md me">&lt;head&gt;<br/>  &lt;meta charset="utf-8" /&gt;<br/>  &lt;title&gt;Electron React Address Book App&lt;/title&gt;<br/>  &lt;script&gt;<br/>    (function () {<br/>      if (!process.env.HOT) {<br/>        const link = document.createElement('link');<br/>        link.rel = 'stylesheet';<br/>        link.href = './dist/style.css';<br/>        // HACK: Writing the script path should be done with webpack<br/>        document.getElementsByTagName('head')[0].appendChild(link);<br/>      }<br/>    })();<br/>  &lt;/script&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae lq" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /&gt;<br/>&lt;/head&gt;</span><span id="bafa" class="lz ma it lu b gy mf mc l md me">&lt;body&gt;<br/>  &lt;div id="root"&gt;&lt;/div&gt;<br/>  &lt;script&gt;<br/>    {<br/>      const scripts = [];</span><span id="ad71" class="lz ma it lu b gy mf mc l md me">// Dynamically insert the DLL script in development env in the<br/>      // renderer process<br/>      if (process.env.NODE_ENV === 'development') {<br/>        scripts.push('../dll/renderer.dev.dll.js');<br/>      }</span><span id="6648" class="lz ma it lu b gy mf mc l md me">// Dynamically insert the bundled app script in the renderer process<br/>      const port = process.env.PORT || 1212;<br/>      scripts.push(<br/>        process.env.HOT<br/>          ? '<a class="ae lq" href="http://localhost:'" rel="noopener ugc nofollow" target="_blank">http://localhost:'</a> + port + '/dist/renderer.dev.js'<br/>          : './dist/renderer.prod.js'<br/>      );</span><span id="ee2b" class="lz ma it lu b gy mf mc l md me">document.write(<br/>        scripts<br/>          .map(script =&gt; `&lt;script defer src="${script}"&gt;&lt;\/script&gt;`)<br/>          .join('')<br/>      );<br/>    }<br/>  &lt;/script&gt;<br/>&lt;/body&gt;</span><span id="72dd" class="lz ma it lu b gy mf mc l md me">&lt;/html&gt;</span></pre><p id="c2f2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们修改了标题，保留了代码的其余部分，并添加了<code class="fe lr ls lt lu b">head</code>标签来添加引导样式:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="8a62" class="lz ma it lu b gy mb mc l md me">&lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /&gt;</span></pre><p id="809b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们创建<code class="fe lr ls lt lu b">ContactForm.js</code>并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="e7cb" class="lz ma it lu b gy mb mc l md me">import React from 'react';<br/>import { Formik } from 'formik';<br/>import Form from 'react-bootstrap/Form';<br/>import Col from 'react-bootstrap/Col';<br/>import InputGroup from 'react-bootstrap/InputGroup';<br/>import Button from 'react-bootstrap/Button';<br/>import * as yup from 'yup';<br/>import { COUNTRIES } from './exports';<br/>import PropTypes from 'prop-types';<br/>import { addContact, editContact, getContacts } from './requests';<br/>import { connect } from 'react-redux';<br/>import { setContacts } from './actionCreators';</span><span id="799b" class="lz ma it lu b gy mf mc l md me">const schema = yup.object({<br/>  firstName: yup.string().required('First name is required'),<br/>  lastName: yup.string().required('Last name is required'),<br/>  address: yup.string().required('Address is required'),<br/>  city: yup.string().required('City is required'),<br/>  region: yup.string().required('Region is required'),<br/>  country: yup.string().required('Country is required').default('Afghanistan'),<br/>  postalCode: yup<br/>    .string()<br/>    .when('country', {<br/>      is: 'United States',<br/>      then: yup.string().matches(/^[0-9]{5}(?:-[0-9]{4})?$/, 'Invalid postal code'),<br/>    })<br/>    .when('country', {<br/>      is: 'Canada',<br/>      then: yup.string().matches(/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/, 'Invalid postal code'),<br/>    })<br/>    .required(),<br/>  phone: yup<br/>    .string()<br/>    .when('country', {<br/>      is: country =&gt; ["United States", "Canada"].includes(country),<br/>      then: yup.string().matches(/^[2-9]\d{2}[2-9]\d{2}\d{4}$/, 'Invalid phone nunber')<br/>    })<br/>    .required(),<br/>  email: yup.string().email('Invalid email').required('Email is required'),<br/>  age: yup.number()<br/>    .required('Age is required')<br/>    .min(0, 'Minimum age is 0')<br/>    .max(200, 'Maximum age is 200'),<br/>});</span><span id="ab63" class="lz ma it lu b gy mf mc l md me">function ContactForm({<br/>  edit,<br/>  onSave,<br/>  setContacts,<br/>  contact,<br/>  onCancelAdd,<br/>  onCancelEdit,<br/>}) {<br/>  const handleSubmit = async (evt) =&gt; {<br/>    const isValid = await schema.validate(evt);<br/>    if (!isValid) {<br/>      return;<br/>    }<br/>    if (!edit) {<br/>      await addContact(evt);<br/>    }<br/>    else {<br/>      await editContact(evt);<br/>    }<br/>    const response = await getContacts();<br/>    setContacts(response.data);<br/>    onSave();<br/>  }</span><span id="e4c3" class="lz ma it lu b gy mf mc l md me">return (<br/>    &lt;div className="form"&gt;<br/>      &lt;Formik<br/>        validationSchema={schema}<br/>        onSubmit={handleSubmit}<br/>        initialValues={contact || {}}<br/>      &gt;<br/>        {({<br/>          handleSubmit,<br/>          handleChange,<br/>          handleBlur,<br/>          values,<br/>          touched,<br/>          isInvalid,<br/>          errors,<br/>        }) =&gt; (<br/>            &lt;Form noValidate onSubmit={handleSubmit}&gt;<br/>              &lt;Form.Row&gt;<br/>                &lt;Form.Group as={Col} md="12" controlId="firstName"&gt;<br/>                  &lt;Form.Label&gt;First name&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    name="firstName"<br/>                    placeholder="First Name"<br/>                    value={values.firstName || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.firstName &amp;&amp; errors.firstName}<br/>                  /&gt;<br/>                  &lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.firstName}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;<br/>                &lt;Form.Group as={Col} md="12" controlId="lastName"&gt;<br/>                  &lt;Form.Label&gt;Last name&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    name="lastName"<br/>                    placeholder="Last Name"<br/>                    value={values.lastName || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.firstName &amp;&amp; errors.lastName}<br/>                  /&gt;</span><span id="b833" class="lz ma it lu b gy mf mc l md me">&lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.lastName}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;<br/>                &lt;Form.Group as={Col} md="12" controlId="address"&gt;<br/>                  &lt;Form.Label&gt;Address&lt;/Form.Label&gt;<br/>                  &lt;InputGroup&gt;<br/>                    &lt;Form.Control<br/>                      type="text"<br/>                      placeholder="Address"<br/>                      aria-describedby="inputGroupPrepend"<br/>                      name="address"<br/>                      value={values.address || ''}<br/>                      onChange={handleChange}<br/>                      isInvalid={touched.address &amp;&amp; errors.address}<br/>                    /&gt;<br/>                    &lt;Form.Control.Feedback type="invalid"&gt;<br/>                      {errors.address}<br/>                    &lt;/Form.Control.Feedback&gt;<br/>                  &lt;/InputGroup&gt;<br/>                &lt;/Form.Group&gt;<br/>              &lt;/Form.Row&gt;<br/>              &lt;Form.Row&gt;<br/>                &lt;Form.Group as={Col} md="12" controlId="city"&gt;<br/>                  &lt;Form.Label&gt;City&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    placeholder="City"<br/>                    name="city"<br/>                    value={values.city || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.city &amp;&amp; errors.city}<br/>                  /&gt;</span><span id="015e" class="lz ma it lu b gy mf mc l md me">&lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.city}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;<br/>                &lt;Form.Group as={Col} md="12" controlId="region"&gt;<br/>                  &lt;Form.Label&gt;Region&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    placeholder="Region"<br/>                    name="region"<br/>                    value={values.region || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.region &amp;&amp; errors.region}<br/>                  /&gt;<br/>                  &lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.region}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;</span><span id="1bb0" class="lz ma it lu b gy mf mc l md me">&lt;Form.Group as={Col} md="12" controlId="country"&gt;<br/>                  &lt;Form.Label&gt;Country&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    as="select"<br/>                    placeholder="Country"<br/>                    name="country"<br/>                    onChange={handleChange}<br/>                    value={values.country || ''}<br/>                    isInvalid={touched.region &amp;&amp; errors.country}&gt;<br/>                    {COUNTRIES.map(c =&gt; &lt;option key={c} value={c}&gt;{c}&lt;/option&gt;)}<br/>                  &lt;/Form.Control&gt;<br/>                  &lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.country}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;</span><span id="1733" class="lz ma it lu b gy mf mc l md me">&lt;Form.Group as={Col} md="12" controlId="postalCode"&gt;<br/>                  &lt;Form.Label&gt;Postal Code&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    placeholder="Postal Code"<br/>                    name="postalCode"<br/>                    value={values.postalCode || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.postalCode &amp;&amp; errors.postalCode}<br/>                  /&gt;</span><span id="c964" class="lz ma it lu b gy mf mc l md me">&lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.postalCode}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;</span><span id="77cb" class="lz ma it lu b gy mf mc l md me">&lt;Form.Group as={Col} md="12" controlId="phone"&gt;<br/>                  &lt;Form.Label&gt;Phone&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    placeholder="Phone"<br/>                    name="phone"<br/>                    value={values.phone || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.phone &amp;&amp; errors.phone}<br/>                  /&gt;</span><span id="b7c1" class="lz ma it lu b gy mf mc l md me">&lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.phone}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;</span><span id="4c68" class="lz ma it lu b gy mf mc l md me">&lt;Form.Group as={Col} md="12" controlId="email"&gt;<br/>                  &lt;Form.Label&gt;Email&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    placeholder="Email"<br/>                    name="email"<br/>                    value={values.email || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.email &amp;&amp; errors.email}<br/>                  /&gt;</span><span id="d48e" class="lz ma it lu b gy mf mc l md me">&lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.email}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;</span><span id="16f0" class="lz ma it lu b gy mf mc l md me">&lt;Form.Group as={Col} md="12" controlId="age"&gt;<br/>                  &lt;Form.Label&gt;Age&lt;/Form.Label&gt;<br/>                  &lt;Form.Control<br/>                    type="text"<br/>                    placeholder="Age"<br/>                    name="age"<br/>                    value={values.age || ''}<br/>                    onChange={handleChange}<br/>                    isInvalid={touched.age &amp;&amp; errors.age}<br/>                  /&gt;</span><span id="84e8" class="lz ma it lu b gy mf mc l md me">&lt;Form.Control.Feedback type="invalid"&gt;<br/>                    {errors.age}<br/>                  &lt;/Form.Control.Feedback&gt;<br/>                &lt;/Form.Group&gt;<br/>              &lt;/Form.Row&gt;<br/>              &lt;Button type="submit" style={{ 'marginRight': '10px' }}&gt;Save&lt;/Button&gt;<br/>              &lt;Button type="button" onClick={edit ? onCancelEdit : onCancelAdd}&gt;Cancel&lt;/Button&gt;<br/>            &lt;/Form&gt;<br/>          )}<br/>      &lt;/Formik&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="8b35" class="lz ma it lu b gy mf mc l md me">ContactForm.propTypes = {<br/>  edit: PropTypes.bool,<br/>  onSave: PropTypes.func,<br/>  onCancelAdd: PropTypes.func,<br/>  onCancelEdit: PropTypes.func,<br/>  contact: PropTypes.object<br/>}</span><span id="6a6f" class="lz ma it lu b gy mf mc l md me">const mapStateToProps = state =&gt; {<br/>  return {<br/>    contacts: state.contacts,<br/>  }<br/>}</span><span id="c0c1" class="lz ma it lu b gy mf mc l md me">const mapDispatchToProps = dispatch =&gt; ({<br/>  setContacts: contacts =&gt; dispatch(setContacts(contacts))<br/>})</span><span id="ef13" class="lz ma it lu b gy mf mc l md me">export default connect(<br/>  mapStateToProps,<br/>  mapDispatchToProps<br/>)(ContactForm);</span></pre><p id="e4b6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们在这里使用Formik来帮助构建我们的联系表单，我们的Boostrap <code class="fe lr ls lt lu b">Form</code>组件嵌套在<code class="fe lr ls lt lu b">Formik</code>组件中，因此我们可以使用Formik的<code class="fe lr ls lt lu b">handleChange</code>、<code class="fe lr ls lt lu b">handleSubmit</code>、<code class="fe lr ls lt lu b">values</code>、<code class="fe lr ls lt lu b">touched</code>和<code class="fe lr ls lt lu b">errors</code>参数。</p><p id="7d06" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lr ls lt lu b">handleChange</code>是一个函数，让我们不用自己写代码就可以从输入中更新表单域数据。<code class="fe lr ls lt lu b">handleSubmit</code>是我们传递给<code class="fe lr ls lt lu b">Formik</code>组件的<code class="fe lr ls lt lu b">onSubmit</code>处理程序的函数。</p><p id="67e6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">函数中的参数是我们输入的数据，字段名作为键，由每个字段的<code class="fe lr ls lt lu b">name</code>属性定义，每个字段的值作为那些键的值。</p><p id="d920" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意，在每个<code class="fe lr ls lt lu b">value</code>属性中，我们有<code class="fe lr ls lt lu b">||''</code>，这样我们就不会得到未定义的值，并防止触发不受控制的表单警告。</p><p id="2b4c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了显示表单验证消息，我们必须将<code class="fe lr ls lt lu b">isInvalid</code>属性传递给每个<code class="fe lr ls lt lu b">Form.Control</code>组件。<code class="fe lr ls lt lu b">schema</code>对象是<code class="fe lr ls lt lu b">Formik</code>将检查表单验证的对象。</p><p id="f8a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lr ls lt lu b">required</code>函数中的参数是验证错误消息。<code class="fe lr ls lt lu b">matches</code>、<code class="fe lr ls lt lu b">min</code>和<code class="fe lr ls lt lu b">max</code>功能的第二个参数也是验证消息。</p><p id="e0e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lr ls lt lu b">ContactForm</code>函数的参数是道具，我们将从稍后构建的<code class="fe lr ls lt lu b">HomePage</code>组件传入。</p><p id="f1bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lr ls lt lu b">handleSubmit</code>功能检查数据是否有效，如果有效，将根据是添加还是编辑联系人进行保存。</p><p id="183f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当保存成功时，我们在存储中设置联系人并调用<code class="fe lr ls lt lu b">onSave</code> prop，这是一个关闭表单所在模态的函数。模式将在主页上定义。</p><p id="214f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lr ls lt lu b">mapStateToProps</code>是React Redux提供的一个函数，因此我们可以将状态直接映射到组件的道具，正如函数名所示。</p><p id="3274" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lr ls lt lu b">mapDispatchToProps</code>允许我们在组件的道具中调用一个名为<code class="fe lr ls lt lu b">setContacts</code>的函数来调度动作，正如我们在<code class="fe lr ls lt lu b">actionCreators.js</code>中定义的那样。</p><p id="f330" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后我们创建<code class="fe lr ls lt lu b">exports.js</code>并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="0317" class="lz ma it lu b gy mb mc l md me">export const COUNTRIES = [<br/>  'Afghanistan',<br/>  'Albania',<br/>  'Algeria',<br/>  'Andorra',<br/>  'Angola',<br/>  'Anguilla',<br/>  'Antigua &amp;amp; Barbuda',<br/>  'Argentina',<br/>  'Armenia',<br/>  'Aruba',<br/>  'Australia',<br/>  'Austria',<br/>  'Azerbaijan',<br/>  'Bahamas',<br/>  'Bahrain',<br/>  'Bangladesh',<br/>  'Barbados',<br/>  'Belarus',<br/>  'Belgium',<br/>  'Belize',<br/>  'Benin',<br/>  'Bermuda',<br/>  'Bhutan',<br/>  'Bolivia',<br/>  'Bosnia &amp;amp; Herzegovina',<br/>  'Botswana',<br/>  'Brazil',<br/>  'British Virgin Islands',<br/>  'Brunei',<br/>  'Bulgaria',<br/>  'Burkina Faso',<br/>  'Burundi',<br/>  'Cambodia',<br/>  'Cameroon',<br/>  'Canada',<br/>  'Cape Verde',<br/>  'Cayman Islands',<br/>  'Chad',<br/>  'Chile',<br/>  'China',<br/>  'Colombia',<br/>  'Congo',<br/>  'Cook Islands',<br/>  'Costa Rica',<br/>  'Cote D Ivoire',<br/>  'Croatia',<br/>  'Cruise Ship',<br/>  'Cuba',<br/>  'Cyprus',<br/>  'Czech Republic',<br/>  'Denmark',<br/>  'Djibouti',<br/>  'Dominica',<br/>  'Dominican Republic',<br/>  'Ecuador',<br/>  'Egypt',<br/>  'El Salvador',<br/>  'Equatorial Guinea',<br/>  'Estonia',<br/>  'Ethiopia',<br/>  'Falkland Islands',<br/>  'Faroe Islands',<br/>  'Fiji',<br/>  'Finland',<br/>  'France',<br/>  'French Polynesia',<br/>  'French West Indies',<br/>  'Gabon',<br/>  'Gambia',<br/>  'Georgia',<br/>  'Germany',<br/>  'Ghana',<br/>  'Gibraltar',<br/>  'Greece',<br/>  'Greenland',<br/>  'Grenada',<br/>  'Guam',<br/>  'Guatemala',<br/>  'Guernsey',<br/>  'Guinea',<br/>  'Guinea Bissau',<br/>  'Guyana',<br/>  'Haiti',<br/>  'Honduras',<br/>  'Hong Kong',<br/>  'Hungary',<br/>  'Iceland',<br/>  'India',<br/>  'Indonesia',<br/>  'Iran',<br/>  'Iraq',<br/>  'Ireland',<br/>  'Isle of Man',<br/>  'Israel',<br/>  'Italy',<br/>  'Jamaica',<br/>  'Japan',<br/>  'Jersey',<br/>  'Jordan',<br/>  'Kazakhstan',<br/>  'Kenya',<br/>  'Kuwait',<br/>  'Kyrgyz Republic',<br/>  'Laos',<br/>  'Latvia',<br/>  'Lebanon',<br/>  'Lesotho',<br/>  'Liberia',<br/>  'Libya',<br/>  'Liechtenstein',<br/>  'Lithuania',<br/>  'Luxembourg',<br/>  'Macau',<br/>  'Macedonia',<br/>  'Madagascar',<br/>  'Malawi',<br/>  'Malaysia',<br/>  'Maldives',<br/>  'Mali',<br/>  'Malta',<br/>  'Mauritania',<br/>  'Mauritius',<br/>  'Mexico',<br/>  'Moldova',<br/>  'Monaco',<br/>  'Mongolia',<br/>  'Montenegro',<br/>  'Montserrat',<br/>  'Morocco',<br/>  'Mozambique',<br/>  'Namibia',<br/>  'Nepal',<br/>  'Netherlands',<br/>  'Netherlands Antilles',<br/>  'New Caledonia',<br/>  'New Zealand',<br/>  'Nicaragua',<br/>  'Niger',<br/>  'Nigeria',<br/>  'Norway',<br/>  'Oman',<br/>  'Pakistan',<br/>  'Palestine',<br/>  'Panama',<br/>  'Papua New Guinea',<br/>  'Paraguay',<br/>  'Peru',<br/>  'Philippines',<br/>  'Poland',<br/>  'Portugal',<br/>  'Puerto Rico',<br/>  'Qatar',<br/>  'Reunion',<br/>  'Romania',<br/>  'Russia',<br/>  'Rwanda',<br/>  'Saint Pierre &amp;amp; Miquelon',<br/>  'Samoa',<br/>  'San Marino',<br/>  'Satellite',<br/>  'Saudi Arabia',<br/>  'Senegal',<br/>  'Serbia',<br/>  'Seychelles',<br/>  'Sierra Leone',<br/>  'Singapore',<br/>  'Slovakia',<br/>  'Slovenia',<br/>  'South Africa',<br/>  'South Korea',<br/>  'Spain',<br/>  'Sri Lanka',<br/>  'St Kitts &amp;amp; Nevis',<br/>  'St Lucia',<br/>  'St Vincent',<br/>  'St. Lucia',<br/>  'Sudan',<br/>  'Suriname',<br/>  'Swaziland',<br/>  'Sweden',<br/>  'Switzerland',<br/>  'Syria',<br/>  'Taiwan',<br/>  'Tajikistan',<br/>  'Tanzania',<br/>  'Thailand',<br/>  "Timor L'Este",<br/>  'Togo',<br/>  'Tonga',<br/>  'Trinidad &amp;amp; Tobago',<br/>  'Tunisia',<br/>  'Turkey',<br/>  'Turkmenistan',<br/>  'Turks &amp;amp; Caicos',<br/>  'Uganda',<br/>  'Ukraine',<br/>  'United Arab Emirates',<br/>  'United Kingdom',<br/>  'United States',<br/>  'United States Minor Outlying Islands',<br/>  'Uruguay',<br/>  'Uzbekistan',<br/>  'Venezuela',<br/>  'Vietnam',<br/>  'Virgin Islands (US)',<br/>  'Yemen',<br/>  'Zambia',<br/>  'Zimbabwe'<br/>];</span></pre><p id="839b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe lr ls lt lu b">ContactForm</code>组件的国家下拉列表中添加我们需要的国家。</p><p id="9cfd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后我们创建<code class="fe lr ls lt lu b">HomePage.js</code>并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="3dd1" class="lz ma it lu b gy mb mc l md me">import React from 'react';<br/>import { useState, useEffect } from 'react';<br/>import Table from 'react-bootstrap/Table';<br/>import ButtonToolbar from 'react-bootstrap/ButtonToolbar';<br/>import Button from 'react-bootstrap/Button';<br/>import Modal from 'react-bootstrap/Modal';<br/>import ContactForm from './ContactForm';<br/>import './HomePage.css';<br/>import { connect } from 'react-redux';<br/>import { getContacts, deleteContact } from './requests';</span><span id="e061" class="lz ma it lu b gy mf mc l md me">function HomePage() {<br/>  const [openAddModal, setOpenAddModal] = useState(false);<br/>  const [openEditModal, setOpenEditModal] = useState(false);<br/>  const [initialized, setInitialized] = useState(false);<br/>  const [selectedId, setSelectedId] = useState(0);<br/>  const [selectedContact, setSelectedContact] = useState({});<br/>  const [contacts, setContacts] = useState([]);</span><span id="3140" class="lz ma it lu b gy mf mc l md me">const openModal = () =&gt; {<br/>    setOpenAddModal(true);<br/>  };</span><span id="ae85" class="lz ma it lu b gy mf mc l md me">const closeModal = () =&gt; {<br/>    setOpenAddModal(false);<br/>    setOpenEditModal(false);<br/>    getData();<br/>  };</span><span id="5d8f" class="lz ma it lu b gy mf mc l md me">const cancelAddModal = () =&gt; {<br/>    setOpenAddModal(false);<br/>  };</span><span id="2261" class="lz ma it lu b gy mf mc l md me">const editContact = contact =&gt; {<br/>    setSelectedContact(contact);<br/>    setOpenEditModal(true);<br/>  };</span><span id="e90d" class="lz ma it lu b gy mf mc l md me">const cancelEditModal = () =&gt; {<br/>    setOpenEditModal(false);<br/>  };</span><span id="f63e" class="lz ma it lu b gy mf mc l md me">const getData = async () =&gt; {<br/>    const response = await getContacts();<br/>    setContacts(response.data);<br/>    setInitialized(true);<br/>  };</span><span id="85bf" class="lz ma it lu b gy mf mc l md me">const deleteSelectedContact = async id =&gt; {<br/>    await deleteContact(id);<br/>    getData();<br/>  };</span><span id="8ea4" class="lz ma it lu b gy mf mc l md me">const refresh = () =&gt; {<br/>    getData();<br/>  };</span><span id="26c4" class="lz ma it lu b gy mf mc l md me">useEffect(() =&gt; {<br/>    if (!initialized) {<br/>      getData();<br/>    }<br/>  });</span><span id="c240" class="lz ma it lu b gy mf mc l md me">return (<br/>    &lt;div className="home-page" style={{ padding: '20px' }}&gt;<br/>      &lt;h1&gt;Contacts&lt;/h1&gt;<br/>      &lt;Modal show={openAddModal} onHide={closeModal}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Add Contact&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;<br/>        &lt;Modal.Body&gt;<br/>          &lt;ContactForm<br/>            edit={false}<br/>            onSave={closeModal.bind(this)}<br/>            onCancelAdd={cancelAddModal}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;</span><span id="7002" class="lz ma it lu b gy mf mc l md me">&lt;Modal show={openEditModal} onHide={closeModal}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Edit Contact&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;<br/>        &lt;Modal.Body&gt;<br/>          &lt;ContactForm<br/>            edit={true}<br/>            onSave={closeModal.bind(this)}<br/>            contact={selectedContact}<br/>            onCancelEdit={cancelEditModal}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;<br/>      &lt;ButtonToolbar&gt;<br/>        &lt;Button variant="outline-primary" onClick={openModal}&gt;<br/>          Add Contact<br/>        &lt;/Button&gt;<br/>        &lt;Button variant="outline-primary" onClick={refresh}&gt;<br/>          Refresh<br/>        &lt;/Button&gt;<br/>      &lt;/ButtonToolbar&gt;<br/>      &lt;br /&gt;<br/>      &lt;div className="table-responsive" style={{ width: '95vw' }}&gt;<br/>        &lt;Table striped bordered hover&gt;<br/>          &lt;thead&gt;<br/>            &lt;tr&gt;<br/>              &lt;th&gt;First Name&lt;/th&gt;<br/>              &lt;th&gt;Last Name&lt;/th&gt;<br/>              &lt;th&gt;Address&lt;/th&gt;<br/>              &lt;th&gt;City&lt;/th&gt;<br/>              &lt;th&gt;Country&lt;/th&gt;<br/>              &lt;th&gt;Postal Code&lt;/th&gt;<br/>              &lt;th&gt;Phone&lt;/th&gt;<br/>              &lt;th&gt;Email&lt;/th&gt;<br/>              &lt;th&gt;Age&lt;/th&gt;<br/>              &lt;th&gt;Edit&lt;/th&gt;<br/>              &lt;th&gt;Delete&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>          &lt;/thead&gt;<br/>          &lt;tbody&gt;<br/>            {contacts.map(c =&gt; (<br/>              &lt;tr key={c.id}&gt;<br/>                &lt;td&gt;{c.firstName}&lt;/td&gt;<br/>                &lt;td&gt;{c.lastName}&lt;/td&gt;<br/>                &lt;td&gt;{c.address}&lt;/td&gt;<br/>                &lt;td&gt;{c.city}&lt;/td&gt;<br/>                &lt;td&gt;{c.country}&lt;/td&gt;<br/>                &lt;td&gt;{c.postalCode}&lt;/td&gt;<br/>                &lt;td&gt;{c.phone}&lt;/td&gt;<br/>                &lt;td&gt;{c.email}&lt;/td&gt;<br/>                &lt;td&gt;{c.age}&lt;/td&gt;<br/>                &lt;td&gt;<br/>                  &lt;Button<br/>                    variant="outline-primary"<br/>                    onClick={editContact.bind(this, c)}<br/>                  &gt;<br/>                    Edit<br/>                  &lt;/Button&gt;<br/>                &lt;/td&gt;<br/>                &lt;td&gt;<br/>                  &lt;Button<br/>                    variant="outline-primary"<br/>                    onClick={deleteSelectedContact.bind(this, c.id)}<br/>                  &gt;<br/>                    Delete<br/>                  &lt;/Button&gt;<br/>                &lt;/td&gt;<br/>              &lt;/tr&gt;<br/>            ))}<br/>          &lt;/tbody&gt;<br/>        &lt;/Table&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="0d4b" class="lz ma it lu b gy mf mc l md me">const mapStateToProps = state =&gt; {<br/>  return {<br/>    contacts: state.contacts<br/>  };<br/>};</span><span id="4849" class="lz ma it lu b gy mf mc l md me">export default connect(<br/>  mapStateToProps,<br/>  null<br/>)(HomePage);</span></pre><p id="da15" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它有显示联系人的表格和添加、编辑和删除联系人的按钮。它在第一次加载时用<code class="fe lr ls lt lu b">useEffect</code>的回调函数中的<code class="fe lr ls lt lu b">getData</code>函数调用获取一次数据。</p><p id="d24c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每次渲染都会调用<code class="fe lr ls lt lu b">useEffect</code>的回调，所以我们想设置一个<code class="fe lr ls lt lu b">initialized</code>标志，并检查它是否只在<code class="fe lr ls lt lu b">true</code>时才加载。</p><p id="6280" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意，我们将这个组件中的所有道具传递给了<code class="fe lr ls lt lu b">ContactForm</code>组件。</p><p id="e9ee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要将参数传递给<code class="fe lr ls lt lu b">onClick</code>处理函数，我们必须调用函数上的<code class="fe lr ls lt lu b">bind</code>，并将函数的参数作为第二个参数传递给<code class="fe lr ls lt lu b">bind</code>。</p><p id="e65a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，在这个文件中，我们有<code class="fe lr ls lt lu b">editContact.bind(this, c)</code>，其中<code class="fe lr ls lt lu b">c</code>是联系对象。<code class="fe lr ls lt lu b">editContact</code>功能定义如下:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="35e4" class="lz ma it lu b gy mb mc l md me">const editContact = (contact) =&gt; {<br/>    setSelectedContact(contact);<br/>    setOpenEditModal(true);<br/>  }</span></pre><p id="33dc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lr ls lt lu b">c</code>是我们传入的<code class="fe lr ls lt lu b">contact</code>参数。然后，为了设计页面样式，我们创建了<code class="fe lr ls lt lu b">HomePage.css</code>并添加了:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="67e3" class="lz ma it lu b gy mb mc l md me">.home-page {<br/>  padding: 20px !important;<br/>}</span></pre><p id="6909" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">向页面添加一些填充。</p><p id="11e8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们还添加了一个刷新按钮，因为你通常不能像在生产应用程序的浏览器中那样刷新页面。</p><p id="6297" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe lr ls lt lu b">index.js</code>中，我们将现有代码替换为:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="c078" class="lz ma it lu b gy mb mc l md me">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import './index.css';<br/>import App from './App';<br/>import { contactsReducer } from './reducers';<br/>import { Provider } from 'react-redux';<br/>import { createStore, combineReducers } from 'redux';</span><span id="f5e5" class="lz ma it lu b gy mf mc l md me">const addressBookApp = combineReducers({<br/>  contacts: contactsReducer<br/>});</span><span id="bf7c" class="lz ma it lu b gy mf mc l md me">const store = createStore(addressBookApp);</span><span id="376e" class="lz ma it lu b gy mf mc l md me">ReactDOM.render(<br/>  &lt;Provider store={store}&gt;<br/>    &lt;App /&gt;<br/>  &lt;/Provider&gt;,<br/>  document.getElementById('root')<br/>);</span></pre><p id="aa6f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这样我们就可以在应用的所有部分使用Redux商店。</p><p id="d913" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我们通过添加<code class="fe lr ls lt lu b">reducers.js</code>来完成Redux商店的构建，并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="5c6d" class="lz ma it lu b gy mb mc l md me">import { SET_CONTACTS } from './actions';</span><span id="c930" class="lz ma it lu b gy mf mc l md me">function contactsReducer(state = {}, action) {<br/>  switch (action.type) {<br/>    case SET_CONTACTS:<br/>      state = JSON.parse(JSON.stringify(action.payload));<br/>      return state;<br/>    default:<br/>      return state;<br/>  }<br/>}</span><span id="736d" class="lz ma it lu b gy mf mc l md me">export { contactsReducer };</span></pre><p id="684c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个缩减器，我们通过调用组件中的<code class="fe lr ls lt lu b">mapDispatchToProps</code>函数提供的prop来存储我们发送的联系人。</p><p id="e492" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们创建一个名为<code class="fe lr ls lt lu b">requests.js</code>的文件，并添加:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="d3f0" class="lz ma it lu b gy mb mc l md me">const APIURL = '<a class="ae lq" href="http://localhost:3000'/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000'</a>;<br/>const axios = require('axios');<br/>export const getContacts = () =&gt; axios.get(`${APIURL}/contacts`);<br/>export const addContact = (data) =&gt; axios.post(`${APIURL}/contacts`, data);<br/>export const editContact = (data) =&gt; axios.put(`${APIURL}/contacts/${data.id}`, data);<br/>export const deleteContact = (id) =&gt; axios.delete(`${APIURL}/contacts/${id}`);</span></pre><p id="9966" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些功能向后端发出HTTP请求，以保存和删除联系人。</p><p id="f156" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们可以运行<code class="fe lr ls lt lu b">yarn dev</code>来运行应用程序。</p><p id="ffcf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了启动后端，我们首先通过运行<code class="fe lr ls lt lu b">npm i json-server</code>来安装<code class="fe lr ls lt lu b">json-server</code>包。然后，转到我们的项目文件夹并运行:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="a40b" class="lz ma it lu b gy mb mc l md me">json-server --watch db.json</span></pre><p id="71ec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe lr ls lt lu b">db.json</code>中，将文本更改为:</p><pre class="kj kk kl km gt lv lu lw lx aw ly bi"><span id="dce8" class="lz ma it lu b gy mb mc l md me">{<br/>  "contacts": [<br/>  ]<br/>}</span></pre><p id="6b6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以我们有了在可用的<code class="fe lr ls lt lu b">requests.js</code>中定义的<code class="fe lr ls lt lu b">contacts</code>端点。</p><p id="1d59" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最终，我们得到了以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/edf87f851dfa63f1fa46597d8717c310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJJDr1RvDt8OGivZ8FzKig.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f09be82ec3a2735bb00c5d97280e5d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r43_CjZOErVWPei1zz57eg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cdb5b0e19a30b176b5e6e6195f9e119b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAYAyO0K-BBB8hF2aHrVVw.png"/></div></div></figure></div></div>    
</body>
</html>