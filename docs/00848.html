<html>
<head>
<title>React Native Reward Referrals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应本地奖励推荐</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-native-reward-referrals-47fb1d281229?source=collection_archive---------0-----------------------#2019-08-22">https://levelup.gitconnected.com/react-native-reward-referrals-47fb1d281229?source=collection_archive---------0-----------------------#2019-08-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6ea726c27999c9f6d81081b9d4a5eff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWcQrTJbyn2BIwRTSsSXbQ.png"/></div></div></figure><p id="62bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是系列<a class="ae kw" href="https://iamshadmirza.hashnode.dev/react-native-deep-linking-simplified-cjzj6qf8900003ss1zv178dm9" rel="noopener ugc nofollow" target="_blank"> <em class="kx">的第三篇文章React Native Deep Linking Simplified</em></a>在前两篇博客中，我们学习了如何在我们的应用程序中添加深度链接以及如何优雅地处理它。</p><p id="ff94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我们将建立一个推荐系统，并充分利用这个惊人的特性。</p><blockquote class="ky kz la"><p id="3a31" class="jy jz kx ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><em class="iq">为成功推荐给推荐人和接收者的人提供应用内奖励是鼓励用户使用你的应用的有效方式。</em></p></blockquote><p id="5462" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将经历五个简单的步骤。让我们开始吧。</p><h1 id="828e" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">涉及的步骤:</h1><ol class=""><li id="70b9" class="mc md iq ka b kb me kf mf kj mg kn mh kr mi kv mj mk ml mm bi translated">安装Firebase项目和SDK</li><li id="8b7b" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">创建邀请链接</li><li id="6ace" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">发送邀请链接</li><li id="cb53" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">检索链接</li><li id="f67d" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">给予奖励</li></ol><h1 id="40b8" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">第一步。安装Firebase项目和SDK</h1><p id="394d" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我们已经在本系列的<a class="ae kw" href="https://iamshadmirza.hashnode.dev/react-native-deep-linking-simplified-cjzj6qf8900003ss1zv178dm9" rel="noopener ugc nofollow" target="_blank">第1部分</a>和<a class="ae kw" href="https://iamshadmirza.hashnode.dev/handling-incoming-dynamic-links-cjzkouqgq002nzts1xvo1pz11" rel="noopener ugc nofollow" target="_blank">第2部分</a>中介绍了这一部分。请先浏览一遍，然后从步骤2开始继续。</p><h1 id="145d" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">第二步。创建邀请链接</h1><p id="02c5" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我们已经学习了如何从Firebase控制台创建动态链接。这一次，我们将在发送者端生成<em class="kx">邀请链接</em>，并附上一个<code class="fe mv mw mx my b">payload</code>。这个<code class="fe mv mw mx my b">payload</code>将在接收端指定发送者的用户账户ID。它看起来会像这样:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="34e7" class="nh lf iq my b gy ni nj l nk nl"><a class="ae kw" href="https://www.deeplinkdemo.com?invitedby=SENDER_UID" rel="noopener ugc nofollow" target="_blank">https://www.deeplinkdemo.com?invitedby=SENDER_UID</a></span></pre><p id="8ea0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于这篇文章，我将使用一个随机的SENDER_UID。你可以在Firebase用户上调用<code class="fe mv mw mx my b">getUid()</code>或者生成你喜欢的ID。</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="79ca" class="nh lf iq my b gy ni nj l nk nl">//import firebase<br/>import firebase from 'react-native-firebase';<br/>//Generate unique user ID here<br/>const SENDER_UID = 'USER1234';<br/>//build the link<br/>const link = `https://www.deeplinkdemo.com?invitedBy=${SENDER_UID}`;<br/>const dynamicLinkDomain = 'https://deeplinkblogdemo.page.link';<br/>//call  DynamicLink constructor<br/>const DynamicLink = new firebase.links.DynamicLink(link, dynamicLinkDomain);<br/>//get the generatedLink<br/>const generatedLink = await firebase.links().createDynamicLink(DynamicLink);<br/>console.log('created link', generatedLink);<br/>// console.log: https://deeplinkblogdemo.page.link?link=https%3A%2F%2Fwww.deeplinkdemo.com%3FinvitedBy%3DUSER1234</span></pre><h1 id="de1f" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">第三步。发送邀请链接</h1><p id="1f82" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">既然我们已经创建了链接，我们可以将它包含在邀请中。该邀请可以是电子邮件、SMS消息或任何其他媒体，这取决于哪种方式最适合您的应用程序和受众。示例:</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="ef30" class="nh lf iq my b gy ni nj l nk nl">const INVITATION = 'Shad has invited you to try this app. Use this referral link: ' + link;</span></pre><h1 id="dd1d" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">第四步。检索链接</h1><p id="e4e5" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">当收件人打开带有邀请链接的应用程序时，可能会出现多种情况:</p><ol class=""><li id="d907" class="mc md iq ka b kb kc kf kg kj nm kn nn kr no kv mj mk ml mm bi translated">如果尚未安装该应用程序，他们将被引导至Play Store或App Store安装该应用程序。</li><li id="b7ed" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated">如果安装了应用程序，他们将首次打开我们的应用程序，我们可以检索动态链接中包含的推荐信息。</li></ol><p id="8086" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还记得我们在邀请链接中添加了<code class="fe mv mw mx my b">SENDER_UID</code>作为有效载荷吗？我们将检索该信息来指定用户并授予奖励。我们想检查该应用程序是否已从动态链接启动。</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="1f31" class="nh lf iq my b gy ni nj l nk nl">//add the code to the root file of your app<br/>    async componentDidMount() {<br/>        let url = await firebase.links().getInitialLink();<br/>        console.log('incoming url', url); //incoming url https://www.deeplinkdemo.com?invitedby=USER1234<br/>        if (url) {<br/>        const ID = this.getParameterFromUrl(url, "invitedBy");<br/>        console.log('ID', ID); //ID USER1234<br/>        }<br/>    }<br/><br/>    getParameterFromUrl(url, parm) {<br/>        var re = new RegExp(".*[?&amp;]" + parm + "=([^&amp;]+)(&amp;|$)");<br/>        var match = url.match(re);<br/>        return (match ? match[1] : "");<br/>    }</span></pre><blockquote class="ky kz la"><p id="d4c3" class="jy jz kx ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><code class="fe mv mw mx my b"><em class="iq">getInitialLink()</em></code> <em class="iq">返回app启动时的动态链接。如果应用程序不是从动态链接启动的，该值将为空。</em></p></blockquote><h1 id="a0cb" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">第五步。给予奖励</h1><p id="4f98" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">现在我们已经从动态链接中检索到了有效负载数据，我们可以指定共享链接的用户，并在满足我们想要的条件时向推荐人和接收者授予推荐奖励。至此我们的<em class="kx">奖励推荐系统</em>已经完成。干杯！！</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/ce51e88547db9f31c0888b9a252ec9db.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/0*foJuurqsPBbwQ-3Q.gif"/></div></figure><p id="0476" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你在这三篇博文系列中学习动态链接、处理动态链接和奖励推荐系统的过程中获得了乐趣。觉得有帮助？请分享。<br/>沙德</p></div></div>    
</body>
</html>