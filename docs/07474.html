<html>
<head>
<title>A Guide to Pandas Pivot Tables in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的熊猫数据透视表指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/pivot-tables-in-pandas-7b672e6d8f47?source=collection_archive---------2-----------------------#2021-02-21">https://levelup.gitconnected.com/pivot-tables-in-pandas-7b672e6d8f47?source=collection_archive---------2-----------------------#2021-02-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6f48" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在Python中使用熊猫数据透视表？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1ddcc431e89bf1c296ed72b891a9b8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WnEq61v5NMZtF7N3"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">威廉·艾文在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="1381" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据分析的一个重要部分是对数据进行分组、总结、汇总和计算统计的过程。<strong class="ky ir">熊猫数据透视表提供了一个强大的工具来用Python执行这些分析技术。</strong>有时数据透视表和分组依据之间的区别令人困惑。您可以将数据透视表视为多维形式的分组。</p><p id="dac6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简而言之，我将在这篇文章中解释以下主题。</p><ul class=""><li id="7e1a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">什么是groupby方法？</li><li id="9f1f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">pivot_table和groupby有什么区别？</li><li id="26a6" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">如何使用pivot_table？</li><li id="5e6b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">什么是多级透视表？</li><li id="49a5" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">什么是交叉表？</li><li id="9932" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">如何用真实数据集做一个样本应用？</li></ul><p id="c02e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开始之前，别忘了订阅<a class="ae kv" href="https://youtube.com/c/tirendazacademy" rel="noopener ugc nofollow" target="_blank">我的youtube频道</a>，我在那里创建关于人工智能、数据科学、机器学习和深度学习的内容。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="9ba8" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">什么是groupby方法？</h1><p id="99de" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">为了解释groupby，让我们导入Pandas和NumPy库。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/a93e035ae848873a04ec9df197d07652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*LKtMIicKH-_0qryCpq6Kyw.png"/></div></figure><p id="25c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了展示熊猫数据透视表，让我创建一个数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/da8d31beca63c14fad363b822d4b4067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*cCW_E-bcposfaYHanlmI3Q.png"/></div></figure><p id="1d0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来看看这个数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/8e0040d7a0c63fa5a87551b56c7dd2b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*u7lTkDSTcYdMmFdCQUtMlQ.png"/></div></figure><p id="cd62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我在这篇文章中解释的，你可以用groupby方法对类别进行分组。让我展示给你看。例如，让我们根据课程的类别进行分组。接下来，让我们根据这一课栏找出平均分数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/7e383793c6c156249ca5ba3adca2da88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*HFkZT7At9DOs8VDYcMpCCQ.png"/></div></figure><p id="2060" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们再获得一个分类列，并根据这两个分类列的值找到平均值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/9045c3f0e72199c87ba6ca3a1ee85bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*5SkRo5mn7NAmDM5UyGnYEA.png"/></div></figure><h1 id="3a55" class="mn mo iq bd mp mq np ms mt mu nq mw mx jw nr jx mz jz ns ka nb kc nt kd nd ne bi translated">pivot_table和groupby有什么区别？</h1><p id="9526" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">groupby方法一般对于二维操作就足够了，但是pivot_table用于多维分组操作。</p><h1 id="d256" class="mn mo iq bd mp mq np ms mt mu nq mw mx jw nr jx mz jz ns ka nb kc nt kd nd ne bi translated">如何使用pivot_table？</h1><p id="39ca" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">DataFrame有一个pivot_table方法。让我们使用pivot_table创建我们用groupby创建的表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/5433ccf02ba72208858aa603f004bea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*Iy1KmkkvAKKxPwmZNzhWcw.png"/></div></figure><p id="5a18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给你。现在让我们创建一个带有层次索引的数据透视表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/597d3ae526c06d81c6df5d5a6afaa658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*0ofP5iiKtIGCVxMs3Taxfg.png"/></div></figure><p id="554c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，缺失数据是为表中不对应的值写入的。当Margins = True时，可以将列和行的平均值添加到表格中。让我展示一下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/4d199f0e1871182e2a212b784c3856c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*NwejVbEVRP8oI_I0bRV61g.png"/></div></figure><p id="260d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果要赋值而不是缺失值，可以使用fill_value。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/d5d6ee9f31254d0f17b69873dc8fbffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*cvq6Ilc0Xwz5jnkzMU7-Pg.png"/></div></figure><h1 id="bf4b" class="mn mo iq bd mp mq np ms mt mu nq mw mx jw nr jx mz jz ns ka nb kc nt kd nd ne bi translated">多级数据透视表</h1><p id="4ef8" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">您还可以创建多级数据透视表。例如，让我们用cut方法将兄弟变量划分为区间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/937c253778a9c73ec93bdb515fc74cf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*SMW6uVQ1C3qev4L9mUpfSA.png"/></div></figure><p id="de4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们使用这个兄弟变量创建一个多级数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/58b2dc313cb7b628cdb52dd0ce973549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*XkxNCNiDCAX0q2ZruPetVA.png"/></div></figure><p id="d8dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以增加级别数。默认情况下，aggfunc选项采用均值函数。您可以更改此功能。让我展示一下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/151cc13e1804fecf47f82a6fdccbeeed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*8cnCO1H-kd48GBO4-qseNQ.png"/></div></figure><p id="c5fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也可以使用sum函数代替mean函数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/f94fdb8c5bc0af97a1e12f5112b5e1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*JkoZsEFC79G0Q1N1o67X4w.png"/></div></figure><p id="bcd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果需要，您可以通过使用字典结构，使用单独的函数来为每一列实现。例如，让我们对兄弟使用max函数，对分数使用sum函数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e1424d0f166a82edd55d4068b73af155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*NnSe8skh-nH5_i2R2Xo23A.png"/></div></figure><h1 id="7c8a" class="mn mo iq bd mp mq np ms mt mu nq mw mx jw nr jx mz jz ns ka nb kc nt kd nd ne bi translated">交叉表</h1><p id="208e" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">最后，我们来看看交叉表方法。交叉表是计算分组频率的数据透视表的特例。让我们将交叉表用于兄弟和课程列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/c02c535cf047c8cd5fb03ed1ab52a403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*_hqBIPiYWOMvCUOxUnl-TA.png"/></div></figure><p id="ab37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们将变量性别添加到索引中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/d20d7dfa7271fb24883d3f2ce9d67bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*WO5wPIaM3-g7xKNdqkQk1w.png"/></div></figure><h1 id="bf6f" class="mn mo iq bd mp mq np ms mt mu nq mw mx jw nr jx mz jz ns ka nb kc nt kd nd ne bi translated">具有真实数据集的应用程序</h1><p id="c003" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在，让我们用真实的数据集来展示我所说的内容。这个数据集是关于在美国出生的婴儿的。首先，让我导入数据集。你可以从<a class="ae kv" href="https://github.com/TirendazAcademy/pandas-tutorial" rel="noopener ugc nofollow" target="_blank">这里</a>下载这个数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/6529ec84929abba721bf45d651785058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*x1Jl6lvoO5rgzEdCC2CjKw.png"/></div></div></figure><p id="826b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们使用head方法来查看这个数据集的前五行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/db78975be9a9ea053d202a34e57165b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*XciY9o2QPFna86_5QUpwVA.png"/></div></figure><p id="0fed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该数据集显示了按出生婴儿性别分列的出生人数。让我们使用pivot_table方法来理解这个数据集。我将创建一个名为ten_year的列来查找每十年出生的孩子的数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/3185eb4bd2e77fd8aac1a02e7aaad0fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*62BZg87k96DHNk_wLc0Yow.png"/></div></div></figure><p id="2889" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们来看看男女生育的趋势。为此，我将使用matplotlib。首先，让我使用% matplotlib inline magic命令来内联查看图形。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/193836432369eca007c7e97846e9961b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*z9lQy6moTD8hC6KoI8PQsA.png"/></div></figure><p id="e3e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们导入Matplotlib和Seaborn。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/cb04847bdca3c117f81ab5f15d605ec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*leaJ-hZSJvJtACg9GuL53w.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/92c9ba6ebd1ec5760ed60c6fd3f1ad56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*UgVzFFoWVNsbxS1X2cqE6g.png"/></div></figure><p id="b681" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，我将使用pivot_table方法来查看每年的变化，并绘制一个线图来显示男性和女性出生率的变化。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/86cfd0165e7dad2b768d0145a0a514be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*lLTXUw7RmsYSEt22l6_4sg.png"/></div></figure><p id="74bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给你。从这张图上你可以看到每年的变化。在这篇文章中，我讨论了数据透视表，并展示了如何将数据透视表用于现实世界的数据集。就是这样。我希望你喜欢这篇文章。你可以在这里找到这本笔记本<a class="ae kv" href="https://github.com/TirendazAcademy/PANDAS-TUTORIAL" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="1450" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你还没看过，我强烈推荐你看下面这些关于熊猫的文章。👇👇👇</p><ul class=""><li id="17b9" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><a class="ae kv" href="https://ai.plainenglish.io/introduction-to-the-pandas-library-a3a557c8d094?source=your_stories_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">熊猫简介</a></li><li id="cad3" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://ai.plainenglish.io/important-methods-in-pandas-2d4c774fcac9?source=your_stories_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">熊猫的重要方法</a></li><li id="8c36" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://ai.plainenglish.io/reading-and-writing-in-pandas-2d83dc538aff?source=your_stories_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">在熊猫身上读写数据</a></li><li id="cb31" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://ai.plainenglish.io/missing-data-in-pandas-d41cbcec04e0?source=your_stories_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">如何修复熊猫丢失的数据</a></li><li id="38de" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/working-with-groupby-in-pandas-7e7823414537?source=your_stories_page-------------------------------------">在熊猫里和Groupby一起工作</a></li><li id="6dc0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://tirendazacademy.medium.com/categorical-data-in-pandas-9eaaff71e6f3?source=your_stories_page-------------------------------------" rel="noopener">熊猫的分类数据</a></li><li id="edef" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://tirendazacademy.medium.com/working-with-text-data-in-pandas-f78aa368e1a?source=your_stories_page-------------------------------------" rel="noopener">在Pandas中处理文本数据</a></li><li id="4312" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/practical-data-analysis-with-pandas-c40fbd2955fa?source=your_stories_page-------------------------------------">熊猫实用数据分析</a></li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="93cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请鼓掌👏如果你喜欢这篇博文。另外，别忘了关注我们的<a class="ae kv" href="https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw" rel="noopener ugc nofollow" target="_blank"> <em class="oe">蒂伦达兹学院YouTube </em> </a> <em class="oe"> </em>📺，<a class="ae kv" href="https://twitter.com/TirendazAcademy" rel="noopener ugc nofollow" target="_blank"> <em class="oe">碎碎念</em> </a> <em class="oe"> </em>😎<em class="oe">、</em>、<a class="ae kv" href="https://tirendazacademy.medium.com/" rel="noopener">、<em class="oe">中等</em>、</a>📚，<a class="ae kv" href="https://www.linkedin.com/in/tirendaz-academy" rel="noopener ugc nofollow" target="_blank"><em class="oe">LinkedIn</em></a><em class="oe"/>👍</p><p id="7f07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下一篇文章再见…</p></div></div>    
</body>
</html>