<html>
<head>
<title>Dynamic component styles in Vue (Composition API and TypeScript) using Tailwind CSS and Lookup tables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用顺风CSS和查找表的Vue(组合API和类型脚本)中的动态组件样式</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/dynamic-component-styles-in-vue-composition-api-and-typescript-using-tailwind-css-and-lookup-8322eff93a96?source=collection_archive---------10-----------------------#2020-09-29">https://levelup.gitconnected.com/dynamic-component-styles-in-vue-composition-api-and-typescript-using-tailwind-css-and-lookup-8322eff93a96?source=collection_archive---------10-----------------------#2020-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b3154981b5a533fa60cd989157bc055a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EoXvrfInMC18-zaYIWkizw.png"/></div></div></figure><blockquote class="kb kc kd"><p id="61fc" class="ke kf kg kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="it">本文将假设一些关于Vue的知识</em></p></blockquote><p id="b19f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">你可以在这里找到选项API版本<a class="ae lg" href="https://medium.com/@wearethreebears/dynamic-component-styles-in-vue-options-api-using-tailwind-css-and-lookup-tables-99f9098646e4" rel="noopener"/>。</p><p id="7625" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">上周我写了一篇关于在Nuxt中使用动态组件样式时如何选择使用查找表的文章，你可以在这里找到<a class="ae lg" href="https://dev.to/wearethreebears/dynamic-component-styles-in-nuxt-using-tailwind-css-and-lookup-tables-4k59" rel="noopener ugc nofollow" target="_blank"/>。这个星期我一直在使用Vue 3，就像使用Nuxt一样，在Vue中，当我使用动态组件样式时，我会使用查找表，如下所示:</p><h1 id="8aca" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">顺风顺水</h1><p id="4752" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp ld mh ks kt le mi kw kx lf mj la lb lc im bi translated">顺风CSS是目前前端开发中最热门的话题之一。由Adam Wathan创建的实用优先的CSS框架，在过去的几年中，它已经从一个辅助项目发展成为一个成功的企业。如果您曾经使用过Tailwind，您可能会意识到它在构建时利用PurgeCSS来删除未使用的样式，并创建一个仅由web应用程序中使用的类组成的细长样式表。许多框架现在利用PurgeCSS在构建时从产品样式表中移除不必要的大量内容。</p><p id="4400" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">PurgeCSS是一个很棒的插件，但是，它不能解析或运行JavaScript，并且在大多数情况下只在构建时使用。因此，如果使用不当，可能会导致开发和生产环境之间出现意外的不一致。</p><h1 id="6368" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">使用Tailwind CSS开始一个全新的Vue项目</h1><p id="c532" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp ld mh ks kt le mi kw kx lf mj la lb lc im bi translated">让我们开始创建一个全新的Vue安装，方法是打开您的终端并运行以下命令:</p><p id="2b1b" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated"><code class="fe mk ml mm mn b">vue create &lt;your-project-name&gt;</code></p><p id="6a5f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">我们将按照CLI说明设置Vue的“手动选择功能”选项，确保从功能列表中选择“选择Vue版本”和“类型脚本”,其余部分可以保留为默认设置。一旦我们的项目完成设置，我们可以导航到根目录并使用以下命令安装Tailwind CSS:</p><p id="b1e1" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated"><code class="fe mk ml mm mn b">npm install tailwindcss</code></p><p id="5fde" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">一旦成功安装了Tailwind CSS，我们需要使用下面的命令创建我们的<code class="fe mk ml mm mn b">tailwind.config.js</code>:</p><p id="1143" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated"><code class="fe mk ml mm mn b">npx tailwindcss init</code></p><p id="9de0" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">当<code class="fe mk ml mm mn b">tailwind.config.js</code>文件被创建后，我们需要配置它来扫描我们的<code class="fe mk ml mm mn b">.vue</code>文件中的类。首先，我们将取消对<code class="fe mk ml mm mn b">future</code>对象中属性的注释，这将使将来的升级更加容易。接下来，在<code class="fe mk ml mm mn b">purge</code>数组中，添加下面一行:</p><p id="944d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated"><code class="fe mk ml mm mn b">'src/**/*.vue',</code></p><p id="3374" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">现在我们可以<br/>创建我们的顺风样式表了。导航到<code class="fe mk ml mm mn b">src/assets</code>文件夹，创建一个名为<code class="fe mk ml mm mn b">css</code>的新目录，在其中创建一个名为<code class="fe mk ml mm mn b">styles.css</code>的新文件，并用Tailwind CSS导入填充它:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="f685" class="mw li it mn b gy mx my l mz na">@tailwind base;<br/>@tailwind components;<br/>@tailwind utilities;</span></pre><p id="b44f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">既然样式表已经设置好了，我们可以通过从<code class="fe mk ml mm mn b">src</code>目录中打开<code class="fe mk ml mm mn b">main.js</code>文件并添加下面一行来将其导入到我们的应用程序中:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="5b45" class="mw li it mn b gy mx my l mz na">import '@/assets/css/styles.css';</span></pre><p id="1474" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">最后，我们需要创建PurgeCSS配置文件，同样在项目根中，创建一个新文件，这次称为<code class="fe mk ml mm mn b">postcss.config.js</code>，并用以下代码对其进行配置:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="d6e4" class="mw li it mn b gy mx my l mz na">// postcss.config.js</span><span id="caf3" class="mw li it mn b gy nb my l mz na">const autoprefixer = require('autoprefixer');<br/>const tailwindcss = require('tailwindcss');</span><span id="cdb2" class="mw li it mn b gy nb my l mz na">module.exports = {<br/>    plugins: [<br/>        tailwindcss,<br/>        autoprefixer,<br/>    ],<br/>};</span></pre><h1 id="632e" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">带顺风的Vue中的动态组件样式</h1><p id="33ed" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp ld mh ks kt le mi kw kx lf mj la lb lc im bi translated">Vue中组件的一个关键特性是能够传递道具。道具是传递给组件的自定义属性，可用于控制外观和功能。让我们看看如何使用Tailwind创建一个简单的按钮组件，它接受两种颜色，“主要”和“次要”:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="061e" class="mw li it mn b gy mx my l mz na">&lt;template&gt;<br/>    &lt;button <br/>        class="px-4 py-2 text-center transition-colors duration-300 ease-in-out border border-solid rounded shadow-md"<br/>        :class="{ <br/>            'bg-blue-800 text-white border-blue-800 hover:bg-transparent hover:text-blue-800 hover:border-blue-800' : color == 'primary',<br/>            'bg-transparent text-blue-800 border-blue-800 hover:bg-blue-800 hover:text-white hover:border-blue-800' : color == 'secondary'<br/>        }"<br/>    &gt;<br/>        &lt;slot /&gt;<br/>    &lt;/button&gt;<br/>&lt;/template&gt;</span><span id="0453" class="mw li it mn b gy nb my l mz na">&lt;script lang="ts"&gt;<br/>    import { defineComponent, PropType } from 'vue'</span><span id="0f8c" class="mw li it mn b gy nb my l mz na">    export default defineComponent({<br/>        name: 'component--button',</span><span id="f9c2" class="mw li it mn b gy nb my l mz na">        props: {<br/>            color: {<br/>                required: false,<br/>                type: String as PropType&lt;string&gt;,<br/>                default: 'primary',<br/>                validator: value =&gt; {<br/>                    return ['primary', 'secondary'].includes(value)<br/>                }<br/>            }<br/>        }<br/>    })<br/>&lt;/script&gt;</span></pre><p id="680b" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">因此，我们的按钮组件接受2种动态颜色，“主要”和“次要”，正如我们所设定的那样，然而，即使在这个简单的组件中，也很容易看到这些动态样式如何在更复杂的组件中失控。我们也有一个颜色道具验证器，我们必须手动与模板中的动态样式保持同步。</p><h1 id="d367" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">提取样式并保持验证器与查找表同步</h1><p id="d39c" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp ld mh ks kt le mi kw kx lf mj la lb lc im bi translated">如果您没有听说过查找表，查找表是一个简单的键-值对对象，我们可以用它来匹配键和数据。我们可以利用查找表来提取动态样式，并确保我们的验证器始终与这些动态样式保持同步。</p><p id="f094" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">对于这个例子，我们将在<code class="fe mk ml mm mn b">src</code>目录中创建一个名为<code class="fe mk ml mm mn b">validators</code>的新文件夹来存储我们的查找表，尽管同样的技术也可以用来在组件文件中使用查找表。一旦你创建了一个名为<code class="fe mk ml mm mn b">validators</code>的新文件夹，在里面创建一个名为<code class="fe mk ml mm mn b">Button.ts</code>的新文件。在<code class="fe mk ml mm mn b">Button.ts</code>中，我们将导出一个名为<code class="fe mk ml mm mn b">ButtonColors</code>的<code class="fe mk ml mm mn b">const</code>，一个包含动态样式的键值对的查找表，如下所示:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="2462" class="mw li it mn b gy mx my l mz na">export const ButtonColors = {<br/>    'primary': 'bg-blue-800 text-white border-blue-800 hover:bg-transparent hover:text-blue-800 hover:border-blue-800',<br/>    'secondary': 'bg-transparent text-blue-800 border-blue-800 hover:bg-blue-800 hover:text-white hover:border-blue-800'<br/>}</span></pre><p id="e52f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">现在我们已经将动态样式提取到一个查找表中，我们需要对组件进行一些更改，首先，在开始的脚本标签下，我们需要导入我们的<code class="fe mk ml mm mn b">ButtonColors const</code>:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="6c10" class="mw li it mn b gy mx my l mz na">&lt;script lang="ts"&gt;<br/>/**/<br/>import { ButtonColors } from '../validators/Button'</span><span id="361c" class="mw li it mn b gy nb my l mz na">export default defineComponent({/**/})<br/>&lt;/script&gt;</span></pre><p id="5363" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">接下来，在我们的<code class="fe mk ml mm mn b">color</code> prop中，我们需要让TypesScript知道该字符串应该等于我们的ButtonColors查找表中的一个键，并用来自<code class="fe mk ml mm mn b">ButtonColors</code>查找表的一个键数组替换当前字符串数组:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="ec07" class="mw li it mn b gy mx my l mz na">&lt;script lang="ts"&gt;<br/>    export default defineComponent({<br/>        /**/<br/>        props: {<br/>            color: {<br/>                required: false,<br/>                type: String as PropType&lt;keyof typeof ButtonColors&gt;,<br/>                default: 'primary',<br/>                validator: (value : string ) =&gt; {<br/>                    return Object.keys(ButtonColors).includes(value)<br/>                }<br/>            }<br/>        }<br/>        /**/<br/>    })<br/>&lt;/script&gt;</span></pre><p id="c5ee" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">现在我们可以创建一个computed属性来处理组件模板中的动态类，首先，我们需要从<code class="fe mk ml mm mn b">vue</code>导入<code class="fe mk ml mm mn b">computed</code>，就像我们处理<code class="fe mk ml mm mn b">defineComponent</code>和<code class="fe mk ml mm mn b">PropType</code>一样:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="53ef" class="mw li it mn b gy mx my l mz na">&lt;script&gt;<br/>    import { defineComponent, PropType, computed } from 'vue'<br/>    /**/<br/>&lt;/script&gt;</span></pre><p id="246d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">现在我们可以使用<code class="fe mk ml mm mn b">setup</code>方法并把它作为参数传递给<code class="fe mk ml mm mn b">props</code>，这样我们就可以设置一个计算的<code class="fe mk ml mm mn b">buttonColor</code>属性，如下所示:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="fe40" class="mw li it mn b gy mx my l mz na">&lt;script&gt;<br/>/**/<br/>export default defineComponent({<br/>    /**/<br/>    setup(props) {<br/>        const buttonColor = computed(() : string  =&gt; {<br/>            return ButtonColors[props.color]<br/>        })</span><span id="e33c" class="mw li it mn b gy nb my l mz na">        return {<br/>            buttonColor<br/>        }<br/>    }<br/>})<br/>&lt;/script&gt;</span></pre><p id="4b9a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">然后，我们可以用新的计算属性替换模板中的所有动态类:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="b4a5" class="mw li it mn b gy mx my l mz na">&lt;template&gt;<br/>    &lt;button <br/>        class="px-4 py-2 text-center transition-colors duration-300 ease-in-out border border-solid rounded shadow-md"<br/>        :class="[buttonColor]"<br/>    &gt;<br/>        &lt;slot /&gt;<br/>    &lt;/button&gt;<br/>&lt;/template&gt;</span></pre><p id="7074" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">总之，这应该给我们一个组件模板，如下所示:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="81e8" class="mw li it mn b gy mx my l mz na">&lt;template&gt;<br/>    &lt;button <br/>        class="px-4 py-2 text-center transition-colors duration-300 ease-in-out border border-solid rounded shadow-md"<br/>        :class="[buttonColor]"<br/>    &gt;<br/>        &lt;slot /&gt;<br/>    &lt;/button&gt;<br/>&lt;/template&gt;</span><span id="3482" class="mw li it mn b gy nb my l mz na">&lt;script lang="ts"&gt;<br/>    import { defineComponent, PropType, computed } from 'vue'</span><span id="c438" class="mw li it mn b gy nb my l mz na">    import { ButtonColors } from '../validators/Button'</span><span id="c68c" class="mw li it mn b gy nb my l mz na">    export default defineComponent({<br/>        name: 'component--button',</span><span id="5288" class="mw li it mn b gy nb my l mz na">        props: {<br/>            color: {<br/>                required: false,<br/>                type: String as PropType&lt;keyof typeof ButtonColors&gt;,<br/>                default: 'primary',<br/>                validator: (value : string ) =&gt; {<br/>                    return Object.keys(ButtonColors).includes(value)<br/>                }<br/>            }<br/>        },</span><span id="f2ee" class="mw li it mn b gy nb my l mz na">        setup(props) {<br/>            const buttonColor = computed(() : string  =&gt; {<br/>                return ButtonColors[props.color]<br/>            })</span><span id="bafa" class="mw li it mn b gy nb my l mz na">            return {<br/>                buttonColor<br/>            }<br/>        }<br/>    })<br/>&lt;/script&gt;</span></pre><p id="548e" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">一切看起来都很好，我们的动态样式被提取，我们的验证器将自动与我们添加的任何新的动态样式保持同步，然而不幸的是，目前我们的组件仍然不会像生产中预期的那样进行样式化。幸运的是，有一个非常简单的修复，从项目的根打开<code class="fe mk ml mm mn b">tailwind.config.js</code>并在<code class="fe mk ml mm mn b">purge</code>数组中添加<code class="fe mk ml mm mn b">'src/validators/*.js'</code>，这将告诉PurgeCSS检查我们的validators文件夹中的样式，我们最终的<code class="fe mk ml mm mn b">purge</code>对象应该看起来像这样:</p><pre class="mo mp mq mr gt ms mn mt mu aw mv bi"><span id="0a0a" class="mw li it mn b gy mx my l mz na">module.exports = {<br/>/**/<br/>    purge: [<br/>        'src/**/*.vue',<br/>        'src/validators/*.ts'<br/>    ]<br/>/**/<br/>}</span></pre><h1 id="5631" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">测试</h1><p id="f651" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp ld mh ks kt le mi kw kx lf mj la lb lc im bi translated">如果您想在生产中测试您的查找表是否正常工作，您可以在本地生产中测试您的项目。首先安装Node.js静态文件服务器:</p><p id="ca4a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated"><code class="fe mk ml mm mn b">npm install -g serve</code></p><p id="f05e" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">安装后，导航到项目的根目录并运行:</p><p id="62eb" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated"><code class="fe mk ml mm mn b">serve -s dist</code></p><h1 id="a1f9" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">结论</h1><p id="9ce4" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp ld mh ks kt le mi kw kx lf mj la lb lc im bi translated">希望你已经发现这是一个在Vue options API、Tailwind和PurgeCSS中清理动态类的有用练习。</p><p id="fd93" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp ld kr ks kt le kv kw kx lf kz la lb lc im bi translated">如果你觉得这篇文章有用，请在<a class="ae lg" href="https://medium.com/@wearethreebears" rel="noopener">媒体</a>、<a class="ae lg" href="https://dev.to/wearethreebears" rel="noopener ugc nofollow" target="_blank">开发人员</a>和/或<a class="ae lg" href="https://twitter.com/wearethreebears" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我。</p></div></div>    
</body>
</html>