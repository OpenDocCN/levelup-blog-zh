<html>
<head>
<title>What is Intersection Observer API and how is it useful?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是交叉点观察器API，它有什么用处？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-intersection-observer-api-and-how-is-it-useful-1e91a14579df?source=collection_archive---------6-----------------------#2022-08-14">https://levelup.gitconnected.com/what-is-intersection-observer-api-and-how-is-it-useful-1e91a14579df?source=collection_archive---------6-----------------------#2022-08-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/04f0fccbd2397b6cadf0195b5dc1e146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*41az-PTYfKEOGt3l"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">克里斯托夫·高尔在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d377" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">交叉点观察器API是一个浏览器API，可用于观察和监听与视口相交的变化。例如，您可以使用这个API来检测某个元素何时出现在屏幕上，并在出现时对其进行处理。</p><p id="0670" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该API的使用案例包括但不限于:</p><ol class=""><li id="c1ad" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">无限滚动</li><li id="b513" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">惰性装载</li><li id="df4e" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">平滑动画过渡</li></ol><p id="62c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从一个实现原始无限滚动的例子开始。我们这里有一个基本的HTML:</p><figure class="ls lt lu lv gt ju"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="751b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个HTML在容器中包含16个测试元素。这就是我们想要实现无限滚动的逻辑:当我们检测到倒数第二个元素从我们的视窗底部出现时，我们知道我们需要获取更多的内容来显示。在这个例子中，我们创建了更多的div元素来填充模拟内容(假设我们从一些API或数据库中获取内容)。</p><p id="1a9e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们选择倒数第二个孩子和元素的容器(我们需要将新创建的元素添加到容器中)。</p><pre class="ls lt lu lv gt ly lz ma mb aw mc bi"><span id="3ae6" class="md me it lz b gy mf mg l mh mi"><em class="mj">let</em> secondLastChild = document.querySelectorAll(".box:nth-last-child(2)")[0];</span><span id="e9e1" class="md me it lz b gy mk mg l mh mi"><em class="mj">let</em> boxes = document.querySelector(".boxes")</span></pre><p id="1527" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们想要创建观察者对象。我们不需要导入任何东西，因为这是一个浏览器API。</p><pre class="ls lt lu lv gt ly lz ma mb aw mc bi"><span id="f964" class="md me it lz b gy mf mg l mh mi"><em class="mj">let</em> observer = new <em class="mj">IntersectionObserver</em>((<em class="mj">entries</em>) <em class="mj">=&gt;</em> {<br/>    console.log(entries[0]);<br/>}, {});</span><span id="8c9e" class="md me it lz b gy mk mg l mh mi">observer.observe(secondLastChild)</span></pre><p id="f6d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们来分解一下。这个IntersectionObserver API接受两个参数:一个回调函数和一个选项对象。让我们关注第一个参数，回调函数。这个回调函数将接收一个名为entries的参数，这是一个观察者条目的数组。</p><p id="a01a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们打印出入口对象(我们的倒数第二个子对象)来看看里面是什么。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/a7a3a6f9cce189fdd8b9bdf9c5f05916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*DuxqoUga-vlcVQUOMg3LFw.png"/></div></figure><p id="c016" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以探索所有的属性，但是我们在这里要关注的是“isIntersecting”和“target”。这个“isIntersecting”属性基本上指示所观察的条目当前是否在屏幕上可见。它当前被设置为假，因为测试元素15现在在视口之外。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mm"><img src="../Images/8723dc6fad39c3601a9c5ea358011729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N85VfLD5JCiRx3kVEHvhTQ.png"/></div></div></figure><p id="35b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们向下滚动，测试元素15出现在屏幕上时，观察者将再次被调用并打印出入口对象。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mn"><img src="../Images/70b973c97896db8a0ec1a7fab8326f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q69HgYrllIY-YGQ9ERPbTw.png"/></div></div></figure><p id="32bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该对象现在将isIntersecting设置为true。另一个有用的属性是target，它将目标HTML元素存储在entry对象中。您可以使用此目标属性来操作元素的类或其他类。</p><p id="fa31" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们实现JavaScript:</p><figure class="ls lt lu lv gt ju"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="5765" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总结一下上面的脚本:</p><p id="3de6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们检测到现有盒子列表的倒数第二个元素时，我们想要创建更多的盒子(现实世界中的内容)并添加到列表中。我们还希望观察新的倒数第二个子节点，以便当新的倒数第二个子节点出现在屏幕上时，它可以再次运行该函数。这是一个非常原始的实现，但是希望它足够简单，可以让你理解API的基本用例。</p><p id="db6c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是<a class="ae kf" href="https://codepen.io/ohdylan/pen/ZExqKzx" rel="noopener ugc nofollow" target="_blank">代码笔</a>演示:</p><figure class="ls lt lu lv gt ju"><div class="bz fp l di"><div class="mo lx l"/></div></figure><p id="25a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以在<a class="ae kf" href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener ugc nofollow" target="_blank"> MDN Web文档中进一步了解实施和选项属性。</a>(不是懒惰，而是决定让我的文章可读性强，容易理解)</p><p id="3935" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好吧！文章到此为止。请关注我关于编程、开发人员生产力和更多主题的未来文章！干杯。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="70c3" class="mw me it bd mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns bi translated">分级编码</h1><p id="c2d1" class="pw-post-body-paragraph kg kh it ki b kj nt kl km kn nu kp kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="7d91" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld ny lk ll lm bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="0869" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld ny lk ll lm bi translated">📰查看更多内容请参见<a class="ae kf" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码刊物</a></li><li id="4699" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld ny lk ll lm bi translated">🔔关注我们:<a class="ae kf" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kf" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kf" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="fde9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">🚀👉<a class="ae kf" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>