<html>
<head>
<title>Using PostgreSQL in Rails</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Rails中使用PostgreSQL</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-postgresql-in-rails-e85f44e039e1?source=collection_archive---------8-----------------------#2021-12-07">https://levelup.gitconnected.com/using-postgresql-in-rails-e85f44e039e1?source=collection_archive---------8-----------------------#2021-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1327" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将在Rails应用程序中实现<strong class="jp ir"> PostgreSQL </strong>。最后，您的rails应用程序将被配置为使用PostgreSQL适配器创建数据库。本文面向任何有Ruby on Rails使用经验的人。</p><p id="5a67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将完成以下任务:</p><p id="390a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">—在PostgreSQL shell中创建PostgreSQL用户和密码。</p><p id="3b7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">—创建为PostgreSQL设置的Rails应用程序(或API)。</p><p id="f5b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">—配置将数据库连接到开发、测试和生产环境的连接。</p><p id="62a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">—最后，我们将创建这些数据库。</p><p id="d7ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你还没有，你可以按照<a class="ae kl" href="https://www.postgresql.org/download/" rel="noopener ugc nofollow" target="_blank">这里</a>的指示下载postgresql。</p><h1 id="f7a9" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">从SQLite3到PostgreSQL </strong></h1><p id="2ab4" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">PostgreSQL 是一个开源的<strong class="jp ir">关系数据库管理系统</strong> (RDBMS)，它使用<strong class="jp ir"> SQL </strong>以及它自己的语言来管理你的数据库。Rails的内置数据库管理系统是<strong class="jp ir"> SQLite3。</strong> SQLite3非常适合在您的本地环境中进行开发，但它不适用于生产环境，因为它一次只允许一个用户写入数据库。使用PostgreSQL，我们可以构建一个更好的数据库来处理生产。为此，我们首先需要创建一个PostgreSQL用户和密码。</p><h2 id="56fa" class="lp kn iq bd ko lq lr dn ks ls lt dp kw jy lu lv la kc lw lx le kg ly lz li ma bi translated"><strong class="ak"> PostgreSQL用户和密码</strong></h2><p id="bcb5" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">首先我们进入名为<strong class="jp ir"> psql: </strong>的<strong class="jp ir"> PostgreSQL </strong> shell</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/66df55f5b2eaca53503757fb67ec65b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hPOwoIwI9LlvzGaudJ1bIQ.png"/></div></div></figure><p id="81f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们创建一个用户和密码。请注意，密码必须用单引号括起来，命令以分号结尾。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mn"><img src="../Images/0eef6828f440855d24f3563c62a1b3a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ItIyqvDnXrv8XhHyh1DvKw.png"/></div></div></figure><p id="42ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仅此而已。我们可以通过打印出所有用户的列表来确保我们已经创建了一个用户。在psql shell运行中:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mo"><img src="../Images/44320ef7dfa26b5a7022043ed75b6dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ENNxXPuuosuHQ8OnX3nPA.png"/></div></div></figure><p id="ee2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是了。噪音。在这里，您还可以做更多的事情，包括创建和编辑数据库，但是我们将在我们的rails应用程序中完成所有这些工作。</p><h1 id="5e35" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">创建Rails API </strong></h1><p id="7a7f" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">当第一次创建rails API时，我们指定我们的数据库将使用PostgreSQL系统构建。我们使用— <strong class="jp ir">数据库</strong>命令选项来完成这项工作。我没有使用— <strong class="jp ir"> api </strong>命令选项，因为这样会遗漏一些我稍后会添加回来的特性。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/9028526ef12fdc9c481dd2045393b33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*k1Mx7peaP5s1CuN4o8b1Mg.png"/></div></figure><p id="2354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦创建了应用程序，继续检查<strong class="jp ir"> config/database.yml </strong>文件，确保我们已经正确设置了。在默认情况下，我们应该看到适配器被设置为postgresql。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mq"><img src="../Images/b90e326f46e6f105d6cd1755c6bad201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qn6fAWpcDKX3geBswv-Lw.png"/></div></div></figure><p id="1d2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">厉害！我们准备好了。现在我们只需要稍微修改一下这个文件。</p><h2 id="e332" class="lp kn iq bd ko lq lr dn ks ls lt dp kw jy lu lv la kc lw lx le kg ly lz li ma bi translated"><strong class="ak">将环境连接到数据库</strong></h2><p id="294d" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们将为每个环境设置主机、端口、用户和密码密钥。这就是我们如何让Rails知道如何连接到我们的数据库。</p><p id="8949" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Yaml文件中，我们可以定义默认的键值，并在每个环境中调用它们。然后，如果我们想覆盖一个默认值，我们只需在该环境中用一个新值重新定义该键。</p><p id="8951" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，我们需要一个不同的数据库用于测试和开发，因为测试数据库会在每次运行时自动删除并重新生成。</p><p id="e9d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，我们可以将所有这些值作为环境变量存储在您的<strong class="jp ir">中。env </strong>文件，但是为了简单起见，我只把它们放在这里。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mr"><img src="../Images/bfcceeebcd2b0e2a074ebd55c3a68c12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tUQseSZp8xayjVdA5WVUlA.png"/></div></div></figure><p id="e730" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以运行<strong class="jp ir"> rake db:create </strong>或者<strong class="jp ir"> rails db:create </strong>。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ms"><img src="../Images/43c47d4c0829913f7cbbf864a8201d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NOs85j5RFa0iWT1grONXhw.png"/></div></div></figure><p id="02dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以看到开发和测试数据库已经创建。从这里，您可以继续创建一些模型和迁移。如果你决定使用Heroku或其他类似RDS的服务创建一个生产数据库，并在这个<strong class="jp ir"> config/database.yml </strong>文件中连接它。</p></div></div>    
</body>
</html>