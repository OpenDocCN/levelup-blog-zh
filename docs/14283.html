<html>
<head>
<title>Using a Decorator to Measure Execution Time of a Function in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用装饰器测量Python中函数的执行时间</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-a-decorator-to-measure-execution-time-of-a-function-in-python-9109ce8ff870?source=collection_archive---------9-----------------------#2022-11-14">https://levelup.gitconnected.com/using-a-decorator-to-measure-execution-time-of-a-function-in-python-9109ce8ff870?source=collection_archive---------9-----------------------#2022-11-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8da3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">分析您的应用程序</h2></div><p id="7305" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们的函数是:</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="9e08" class="lk ll iq lg b be lm ln l lo lp">def my_func(a, b):<br/>    retval = a+b<br/>    return retval</span></pre><p id="1e1e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们想测量这个函数所用的时间。简单地说，我们添加一些行来实现这一点。</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="6860" class="lk ll iq lg b be lm ln l lo lp">import time<br/><br/>def my_func(a, b):<br/>    start_time = time.time();<br/>    retval = a+b<br/>    print("the function ends in ", time.time()-start_time, "secs")<br/>    return retval</span></pre><p id="0b81" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将当前时间存储在<code class="fe lq lr ls lg b">start_time</code>变量中，然后我让方法执行，然后从当前时间中减去<code class="fe lq lr ls lg b">start_time</code>以获得实际的方法执行时间。</p><p id="785d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="e0c3" class="lk ll iq lg b be lm ln l lt lp">my_func(1, 2)<br/>the function ends in  7.152557373046875e-07 secs</span></pre><p id="a7bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我们可以更好地使用装饰来包装任何功能。</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="2be6" class="lk ll iq lg b be lm ln l lo lp">from functools import wraps<br/>import time<br/><br/>def timer(func):<br/>    @wraps(func)<br/>    def wrapper(a, b):<br/>        start_time = time.time();<br/>        retval = func(a, b)<br/>        print("the function ends in ", time.time()-start_time, "secs")<br/>        return retval<br/>    return wrapper</span></pre><p id="03de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以使用这个<code class="fe lq lr ls lg b">timer</code>装饰器来装饰<code class="fe lq lr ls lg b">my_func</code>函数。</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="ffed" class="lk ll iq lg b be lm ln l lo lp">@timer<br/>def my_func(a, b):<br/>    retval = a+b<br/>    return retval</span></pre><p id="278a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当调用这个函数时，我们得到下面的结果。</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="a5ec" class="lk ll iq lg b be lm ln l lt lp">my_func(1, 2) <br/>the function ends in 1.1920928955078125e-06 secs</span></pre><p id="521d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果函数接受两个以上的变量，因为我们不知道需要多少个参数，那该怎么办？</p><p id="1303" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简单地说，我们使用<code class="fe lq lr ls lg b">*args</code>允许我们向Python函数传递可变数量的非关键字参数。</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="c573" class="lk ll iq lg b be lm ln l lo lp">def timer(func):<br/>    @wraps(func)<br/>    def wrapper(*args):<br/>        start_time = time.time();<br/>        retval = func(*args)<br/>        print("the function ends in ", time.time()-start_time, "secs")<br/>        return retval<br/>    return wrapper</span></pre><p id="c39a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将<code class="fe lq lr ls lg b">@timer</code>添加到我们想要测量的每个函数中。</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="1bed" class="lk ll iq lg b be lm ln l lo lp">@timer<br/>def my_func(a, b, c):<br/>    retval = a+b+c<br/>    return retval</span></pre><p id="abf1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="f1fc" class="lk ll iq lg b be lm ln l lo lp">my_func(1,2, 3)<br/>the function ends in  1.6689300537109375e-06 secs</span></pre><p id="4583" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很简单，对吧？</p></div></div>    
</body>
</html>