<html>
<head>
<title>Micro-interactions in SwiftUI: Animated Wave</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI中的微交互:动画波</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/micro-interactions-animated-wave-14e0b74a69a4?source=collection_archive---------10-----------------------#2020-09-02">https://levelup.gitconnected.com/micro-interactions-animated-wave-14e0b74a69a4?source=collection_archive---------10-----------------------#2020-09-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="736b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让-马克·布里安内</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/a2b8169fae3d14d6ad0e6736b9d1703b.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/0*TJaJWhCPgHSRd5u5.png"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated"><code class="fe ku kv kw kx b">ScrollView</code>背景中的波浪</figcaption></figure><p id="af6c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">欢迎回来！本周的帖子涵盖了我为自己的应用程序制作的各种SwiftUI微交互。这些交互带来的好处确实有助于让你的应用感觉更好，更容易使用。今天的微互动都是基于我定制的<code class="fe ku kv kw kx b">Wave</code>造型。</p><blockquote class="lu lv lw"><p id="5262" class="ky kz lx la b lb lc ju ld le lf jx lg ly li lj lk lz lm ln lo ma lq lr ls lt im bi translated">如果你觉得这个提示有用，请考虑使用这个<a class="ae mb" href="https://trailingclosure.com/signup/?utm_source=trailing_closure&amp;utm_medium=blog_post&amp;utm_campaign=mi_flowing_wave" rel="noopener ugc nofollow" target="_blank">链接</a>订阅，如果你没有在<a class="ae mb" href="https://trailingclosure.com/?utm_source=trailing_closure&amp;utm_medium=blog_post&amp;utm_campaign=mi_flowing_wave" rel="noopener ugc nofollow" target="_blank">TrailingClosure.com</a>上阅读这篇文章，请随时来看看我们！</p></blockquote><h2 id="504d" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">SwiftUI <code class="fe ku kv kw kx b">Wave</code>形状</h2><p id="ae8d" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">这些动画都有一个共同点，那就是我的自定义SwiftUI Shape struct，<code class="fe ku kv kw kx b">Wave</code>。这种形状的工作方式是从帧的前端到后端画一个连续的波。<code class="fe ku kv kw kx b">Wave</code>有两种属性可以改变形状的外观:</p><ul class=""><li id="d02a" class="na nb it la b lb lc le lf lh nc ll nd lp ne lt nf ng nh ni bi translated"><code class="fe ku kv kw kx b">phase</code> -波开始的阶段</li><li id="efaa" class="na nb it la b lb nj le nk lh nl ll nm lp nn lt nf ng nh ni bi translated"><code class="fe ku kv kw kx b">waveHeight</code> -波浪的高度(或真正的振幅)。</li></ul><p id="4b31" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是<code class="fe ku kv kw kx b">Wave</code>形状的代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/59b1eb55e48406574b48b630996ec85e.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/0*2HnNPsVXSSlCPz8k.png"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">SwiftUI <code class="fe ku kv kw kx b">Wave</code>形状</figcaption></figure><pre class="kj kk kl km gt np kx nq nr aw ns bi"><span id="7093" class="mc md it kx b gy nt nu l nv nw">struct Wave: Shape {<br/>    <br/>    var waveHeight: CGFloat<br/>    var phase: Angle<br/>    <br/>    func path(in rect: CGRect) -&gt; Path {<br/>        var path = Path()<br/>        path.move(to: CGPoint(x: 0, y: rect.maxY)) // Bottom Left<br/>        <br/>        for x in stride(from: 0, through: rect.width, by: 1) {<br/>            let relativeX: CGFloat = x / 50 //wavelength<br/>            let sine = CGFloat(sin(relativeX + CGFloat(phase.radians)))<br/>            let y = waveHeight * sine //+ rect.midY<br/>            path.addLine(to: CGPoint(x: x, y: y))<br/>        }<br/>        <br/>        path.addLine(to: CGPoint(x: rect.maxX, y: rect.midY)) // Top Right<br/>        path.addLine(to: CGPoint(x: rect.maxX, y: rect.maxY)) // Bottom Right<br/>        <br/>        return path<br/>    }<br/>}</span></pre><h2 id="ae3c" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">我们的第一个例子！</h2><p id="a4f9" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">是的，我们的第一个例子！这个<code class="fe ku kv kw kx b">Wave</code>形状是我们开始为我们的应用程序创建一些惊人的交互所需要的。看看我用两个<code class="fe ku kv kw kx b">Wave</code>形状放在一个<code class="fe ku kv kw kx b">ScrollView</code>里面做的这个。注意当用户滚动时，波形的<code class="fe ku kv kw kx b">phase</code>是如何改变的，因此它们看起来在屏幕上移动。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><pre class="kj kk kl km gt np kx nq nr aw ns bi"><span id="b2be" class="mc md it kx b gy nt nu l nv nw">var body: some View {<br/>    ScrollView(.vertical, showsIndicators: false) {<br/>        VStack(spacing: 0) {<br/><br/>            // Other Views...<br/><br/>            GeometryReader { geo in<br/>                ZStack {<br/>                    Wave(waveHeight: 30, phase: Angle(degrees: (Double(geo.frame(in: .global).minY) + 45) * -1 * 0.7))<br/>                        .foregroundColor(.orange)<br/>                        .opacity(0.5)<br/>                    Wave(waveHeight: 30, phase: Angle(degrees: Double(geo.frame(in: .global).minY) * 0.7))<br/>                        .foregroundColor(.red)<br/>                }<br/>            }.frame(height: 70, alignment: .center)<br/><br/>            // Other Views...<br/>        }<br/>    }<br/>}</span></pre><h2 id="3ad4" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">使用波作为遮罩</h2><p id="f6b9" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">使用<code class="fe ku kv kw kx b">Wave</code>形状的另一种方法是创建一个自定义的<code class="fe ku kv kw kx b">AnimatableModifier</code>，将该形状作为遮罩应用到您的视图中。您将在下面看到的一个显著变化是遮罩根据<code class="fe ku kv kw kx b">pct</code>属性增大或缩小。在我们开始第二个例子之前，先看看下面的代码！</p><pre class="kj kk kl km gt np kx nq nr aw ns bi"><span id="98f1" class="mc md it kx b gy nt nu l nv nw">struct WaveMaskModifier: AnimatableModifier {<br/>    <br/>    var pct: CGFloat<br/>    <br/>    var animatableData: CGFloat {<br/>        get { pct }<br/>        set { pct = newValue }<br/>    }<br/>    <br/>    func body(content: Content) -&gt; some View {<br/>        content<br/>            .mask(<br/>                GeometryReader { geo in<br/>                    VStack {<br/>                        Spacer()<br/>                        ZStack {<br/>                            Wave(waveHeight: 30, phase: Angle(degrees: (Double(pct) * 720 * -1) + 45))<br/>                                .opacity(0.5)<br/>                                .scaleEffect(x: 1.0, y: 1.2, anchor: .center)<br/>                                .offset(x: 0, y: 30)<br/>                            Wave(waveHeight: 30, phase: Angle(degrees: Double(pct) * 720))<br/>                                .scaleEffect(x: 1.0, y: 1.2, anchor: .center)<br/>                                .offset(x: 0, y: 30)<br/>                        }<br/>                        .frame(height: geo.size.height * pct, alignment: .bottom)<br/>                    }<br/>                    <br/>                }<br/>            )<br/>    }<br/>}</span></pre><h2 id="c704" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">我们的第二个例子！</h2><p id="c8a7" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">对，第二个例子！我们今天进展很快。下面你会看到应用于一系列<code class="fe ku kv kw kx b">Image</code>视图的动画遮罩。当用户点击屏幕时，<code class="fe ku kv kw kx b">WaveMaskModifer</code>作为一个自定义的<code class="fe ku kv kw kx b">AnyTransition</code>被应用来动画显示图像的变化。这种过渡对于展示这些类型内容的各种照片/视频共享应用程序非常有用。</p><p id="724e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了示例代码之外，我将在下面提供转换代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="6f32" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated"><code class="fe ku kv kw kx b">WaveMaskModifier</code>作为过渡</h2><p id="2998" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">下面是自定义转换的代码。</p><pre class="kj kk kl km gt np kx nq nr aw ns bi"><span id="6ef0" class="mc md it kx b gy nt nu l nv nw">extension AnyTransition {<br/>    static let waveMask = AnyTransition.asymmetric(insertion:<br/>        AnyTransition.modifier(active: WaveMaskModifier(pct: 0), identity: WaveMaskModifier(pct: 1))<br/>        , removal:<br/>            .scale(scale: 1.1)<br/>    )<br/>}</span></pre><h2 id="5eff" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">示例2的代码</h2><p id="f8ac" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">下面是上面例子的代码。</p><pre class="kj kk kl km gt np kx nq nr aw ns bi"><span id="832f" class="mc md it kx b gy nt nu l nv nw">struct ContentView: View {<br/>    <br/>    @State var index: Int = 0<br/>    <br/>    var images: [Image] = [<br/>        Image("stock_1"),<br/>        Image("stock_2"),<br/>        Image("stock_3"),<br/>        Image("stock_4"),<br/>    ]<br/>    <br/>    var body: some View {<br/>        ZStack {<br/>            ForEach(images.indices) { i in<br/>                if i == index {<br/>                    images[index]<br/>                        .resizable()<br/>                        .aspectRatio(contentMode: .fill)<br/>                        .transition(.waveMask)<br/>                }<br/>            }<br/>            <br/>        }.onTapGesture {<br/>            withAnimation(.easeOut(duration: 3)) {<br/>                index = (index + 1) % images.count<br/>            }<br/>            <br/>        }.edgesIgnoringSafeArea(.all)<br/>    }<br/>}</span></pre><h2 id="d3fb" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">流动波背景</h2><p id="64fb" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">最后，我们将使用一组<code class="fe ku kv kw kx b">Wave</code>形状作为我们一个视图的背景。奇妙的是，当我们等待用户与屏幕交互时，wave将在背景中无缝地动画化，以赋予视图一些生命。请看下面的视频示例！</p><h2 id="558d" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">我们的第三个例子！</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="a571" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过动画制作<code class="fe ku kv kw kx b">Wave</code>形状的<code class="fe ku kv kw kx b">phase</code>属性，我们得到了这个流动的背景，它在等待用户交互时很好地呈现出来。</p><h2 id="2121" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">喜欢这个教程？</h2><h2 id="accf" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">让我们看看你做了什么！</h2><p id="69e3" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">给我们发照片！给我们一个链接！任何事！在推特<a class="ae mb" href="https://twitter.com/TrailingClosure" rel="noopener ugc nofollow" target="_blank"> @TrailingClosure </a>、Instagram 上找到我们，或者发邮件到howdy@TrailingClosure.com<!-- --><!-- -->联系我们。</p></div></div>    
</body>
</html>