<html>
<head>
<title>5 Super-Useful Linux Network Troubleshooting Commands</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个非常有用的Linux网络故障排除命令</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/5-super-useful-linux-network-troubleshooting-commands-3e0581a20bf9?source=collection_archive---------9-----------------------#2021-06-27">https://levelup.gitconnected.com/5-super-useful-linux-network-troubleshooting-commands-3e0581a20bf9?source=collection_archive---------9-----------------------#2021-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/60b56731f4cedc12b901fea3e97602e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*khbyvmfrwRwR_eYfHa2oyw.jpeg"/></div></div></figure><h1 id="a3e6" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="4ded" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">从建立最初的通信模式到实现即时的全球连接，计算机网络已经使许多事情成为可能。尽管网络让我们的生活变得更简单，但它们在本质上是复杂的。它们需要配置、维护，最重要的是排除故障。网络是由多个节点互连而成的，存在几个潜在的故障点。在网络连接失败的情况下，了解故障排除工具是一个优势。Linux支持非常有用的命令行实用程序，可以帮助您缩小网络问题的范围。在这篇博客中，我将解释5个Linux网络故障排除命令，当事情似乎不工作时，它们可以帮助你。</p><h1 id="0df1" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">ip命令</h1><p id="b76b" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><code class="fe lu lv lw lx b">ip</code>命令是一个一体化的命令，可以用来处理几乎整个系统的网络堆栈。它不仅有助于排除网络故障，还可以配置各种网络设置。使用<code class="fe lu lv lw lx b">ip</code>命令的一般语法是:</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="8274" class="mg jz iq lx b gy mh mi l mj mk">ip [ OPTIONS ] OBJECT { COMMAND | help }</span></pre><ul class=""><li id="0cd8" class="ml mm iq ky b kz mn ld mo lh mp ll mq lp mr lt ms mt mu mv bi translated"><code class="fe lu lv lw lx b">OPTIONS </code>是各种可以用来控制输出外观的标志。最常用的选项有<code class="fe lu lv lw lx b">-s</code>(显示统计数据)，和<code class="fe lu lv lw lx b"> -br</code>(显示简要信息)。</li><li id="2974" class="ml mm iq ky b kz mw ld mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe lu lv lw lx b">OBJECT</code>是要处理的网络对象，包括链路、地址、路由和邻居。</li><li id="e25b" class="ml mm iq ky b kz mw ld mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe lu lv lw lx b">COMMAND</code>是对被使用对象进行的操作。让我们看一个例子。</li></ul><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="cae0" class="mg jz iq lx b gy mh mi l mj mk">ip -s link show</span></pre><p id="3827" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">你能解释这个命令是干什么的吗？如前所述，<code class="fe lu lv lw lx b">-s </code>是选项之一，<code class="fe lu lv lw lx b">link </code>是对象，<code class="fe lu lv lw lx b">show</code>是命令。因此，该命令显示系统所有接口的统计信息和信息。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/a17ef314b580ed93be42341820121b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HFDQPHfIlnDf4DrrlKgAzQ.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">ip命令</figcaption></figure><p id="560c" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">以类似的方式，<code class="fe lu lv lw lx b">ip </code>命令可用于其他对象和命令。让我们看看其他几个例子。</p><p id="29dc" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">要检查系统的IP地址，可以使用如下的<code class="fe lu lv lw lx b"> ip</code>命令。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/b565863fe2e31b189bf07414856484d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5InfRZmdqyRXLpBDClk0w.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">ip命令</figcaption></figure><p id="2d0f" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">要查看一个系统的ARP表，使用<code class="fe lu lv lw lx b">ip neighbor show</code>，为了检查路由表，<code class="fe lu lv lw lx b">ip route show</code>将完成这项工作。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/3433da06b42f9b6d1e7709a3bde5a78e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DV9XgHGSmmBVqHzF2lHv2g.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">ip命令</figcaption></figure></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="e5b2" class="jy jz iq bd ka kb ns kd ke kf nt kh ki kj nu kl km kn nv kp kq kr nw kt ku kv bi translated">ping命令</h1><p id="a685" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">Ping是广泛使用的网络故障排除命令之一。它代表分组因特网路由器，使用ICMP网络协议实现。它向目标系统发送ICMP回应请求数据包，并等待ICMP回应回复数据包。成功的ping确认系统之间建立了网络连接。除了检查基本的网络连接，它还能让您测试您的网络接口卡，并验证DNS是否工作正常。它可以与IPv4地址或IPv6地址一起使用。此外，它还可以与域名。下面是它的实际工作。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/5543a3a980a589f93e0a0841429fb803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P_OU74auU_U-dBu3dn-NAw.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">ping命令</figcaption></figure><ul class=""><li id="bfc9" class="ml mm iq ky b kz mn ld mo lh mp ll mq lp mr lt ms mt mu mv bi translated">这里<code class="fe lu lv lw lx b">icmp_seq</code>表示正在传送的数据包的序列号。</li><li id="c3f1" class="ml mm iq ky b kz mw ld mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe lu lv lw lx b">ttl </code>代表<strong class="ky ir">生存时间</strong>作为跳数计数器工作。它是数据包在被丢弃之前可以经过的跳数的计数。</li><li id="9a7d" class="ml mm iq ky b kz mw ld mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe lu lv lw lx b">time</code>是数据包往返目的地的往返时间的量度。</li></ul><p id="af1e" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">注意<code class="fe lu lv lw lx b">8.8.8.8 </code>是Google的公共DNS IPv4地址。检查“发送14个包，接收14个包，0%包丢失”结尾的输出。这表示ping操作成功，您的网卡工作正常。以下是ping不成功的可能情况:</p><ul class=""><li id="7f27" class="ml mm iq ky b kz mn ld mo lh mp ll mq lp mr lt ms mt mu mv bi translated"><strong class="ky ir">请求超时:</strong>ping不成功可能有多种原因。您尝试ping的服务器/主机可能已关闭。还有一种可能是，在目标系统上有一个防火墙不允许ICMP请求数据包通过。</li><li id="5ec8" class="ml mm iq ky b kz mw ld mx lh my ll mz lp na lt ms mt mu mv bi translated"><strong class="ky ir">丢包:</strong>不是每次都能得到0%丢包的输出。由于网络拥塞、硬件故障或电缆损坏，数据包可能会在到达目的地的途中丢失。</li><li id="e794" class="ml mm iq ky b kz mw ld mx lh my ll mz lp na lt ms mt mu mv bi translated"><strong class="ky ir">目标主机不可达:</strong>当找不到到目标系统的路由时，会出现这种情况。这也可能意味着您的系统没有连接到网络。尝试在wifi断开的情况下使用ping并检查输出！</li></ul><p id="8483" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">在linux中，ping不断向目的地发送ICMP回应请求数据包，直到被手动停止。要限制要发送的数据包数量，请使用<code class="fe lu lv lw lx b">-c</code>标志。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/3bbf885d4b9f3ff23e975021d15faa38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*riz6ry39JBwFxMNxFaE7kA.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">ping命令</figcaption></figure><p id="1fa3" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">在上面的例子中，ping与<code class="fe lu lv lw lx b">-c </code>标志一起使用，后跟一个<code class="fe lu lv lw lx b">4 </code>，这意味着“只发送4个包到目的地”。因此，只发送和接收了4个包。</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="4740" class="jy jz iq bd ka kb ns kd ke kf nt kh ki kj nu kl km kn nv kp kq kr nw kt ku kv bi translated">traceroute命令</h1><p id="625d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><code class="fe lu lv lw lx b">Traceroute </code>是一个非常有趣和方便的命令，用于跟踪数据包从发送者到目的地的确切路径。当<code class="fe lu lv lw lx b">ping </code>命令告诉网络是否有问题时，<code class="fe lu lv lw lx b">traceroute </code>命令显示故障的确切点。它的工作原理是在到达目的地的途中ping每台路由器。它向每台路由器发送三个数据包，并测量它们的往返时间。通过这种方式，可以计算出源和目的地之间的总跳数/路由器数。让我们追踪从我的系统到<code class="fe lu lv lw lx b">google.com.</code>的路径</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/5e9be86e7696e062f81a02067a15ba03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JoQ7mxf5bEwQu5ZDqLnVEw.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">traceroute命令</figcaption></figure><p id="0b58" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">从输出中可以推断出，从我的系统发送到<code class="fe lu lv lw lx b">google.com</code>的数据包经过了11个路由器。从上面的结果还能解读出什么？你认为如何确定潜在的故障点？</p><p id="3df6" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">要得到这个问题的答案，请查看每个条目。在每个步骤中，给出每个路由器的IP地址及其域名(如果可用),然后是发送到该路由器的3个数据包的3次往返时间。往返时间长表示路由器有问题(网络拥塞或网络速度慢)。</p><p id="c79b" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">为了更好地理解<code class="fe lu lv lw lx b">traceroute</code>的实现，这里有一个简化的解释。还记得ping命令解释里的<code class="fe lu lv lw lx b">ttl </code>(生存时间)吗？它在<code class="fe lu lv lw lx b">traceroute </code>中也起着巨大的作用。在后台，<code class="fe lu lv lw lx b">traceroute </code>的工作原理是将<code class="fe lu lv lw lx b"> ttl </code>的值设置为1，以便将数据包发送到第一个路由器。因此，数据包在到达第一个路由器后被丢弃。对于要发送到第二个路由器的数据包，<code class="fe lu lv lw lx b">ttl</code>值设置为2，而对于要传输到第三个路由器的数据包，<code class="fe lu lv lw lx b"> ttl </code>值设置为3，依此类推。有趣吧？</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="d28e" class="jy jz iq bd ka kb ns kd ke kf nt kh ki kj nu kl km kn nv kp kq kr nw kt ku kv bi translated">nslookup命令</h1><p id="7514" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">毫无疑问，没有DNS域名解析或其等价物，上网不会更容易。DNS中的一个问题可以在一段时间内颠覆我们的世界。幸运的是，我们有<code class="fe lu lv lw lx b">nslookup</code>，一个可以帮助我们解决DNS问题的命令行工具。</p><p id="b9be" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">要获取特定域名的IP地址，请使用带域名的<code class="fe lu lv lw lx b">nslookup</code>作为参数。然后，系统的默认DNS配置将用于执行查找。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/d85b08434e02458afd9069cabf7340f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W4Jf_KotHCZl9f2cw6YlvQ.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">nslookup命令</figcaption></figure><p id="24ef" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">要使用特定的名称服务器执行查找，请在命令末尾提供名称服务器的地址。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/71974b7ee2be0bdd6769cfb8c2d5a8fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPKNqZF4OfQuQgQchRMFNw.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">nslookup命令</figcaption></figure></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="add3" class="jy jz iq bd ka kb ns kd ke kf nt kh ki kj nu kl km kn nv kp kq kr nw kt ku kv bi translated">netcat命令</h1><p id="4569" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">Netcat是系统管理员最有用的命令行工具之一。它可以用于检查端口连接、发送文件、执行HTTP请求等等。使用netcat命令的一般语法是</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="3728" class="mg jz iq lx b gy mh mi l mj mk">netcat [options] host port</span></pre><p id="0f90" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">默认情况下，netcat使用TCP建立与主机的连接。为了使用UDP，使用<code class="fe lu lv lw lx b">-u </code>作为选项。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/b4579f30c7c790e66d2decdedaf1925e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-bFSFnX2eCCwrixbWC2-g.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">netcat命令</figcaption></figure><p id="c3fe" class="pw-post-body-paragraph kw kx iq ky b kz mn lb lc ld mo lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt ij bi translated">上面的命令使用TCP在端口80连接到google.com。<code class="fe lu lv lw lx b">-z</code>选项用于连接到主机，而不向上述端口发送任何数据。<code class="fe lu lv lw lx b">-v</code>选项告诉<code class="fe lu lv lw lx b">netcat </code>命令提供详细的输出。</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="3a61" class="jy jz iq bd ka kb ns kd ke kf nt kh ki kj nu kl km kn nv kp kq kr nw kt ku kv bi translated">结论</h1><p id="2509" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在这篇博客中，我们浏览了5个强大的linux网络故障排除命令。感谢您的阅读，我真的希望您对Linux网络故障诊断有了宝贵的见解。这些命令可以根据问题和要求来使用。请注意，除了这5个命令之外，还有其他有效的实用程序，如netstat、tcpdump、host等等。要了解更多命令，下面是一些很好的资源。</p><ul class=""><li id="7cb4" class="ml mm iq ky b kz mn ld mo lh mp ll mq lp mr lt ms mt mu mv bi translated"><a class="ae od" href="https://www.tecmint.com/linux-network-configuration-and-troubleshooting-commands/" rel="noopener ugc nofollow" target="_blank"> Techmint </a></li><li id="7838" class="ml mm iq ky b kz mw ld mx lh my ll mz lp na lt ms mt mu mv bi translated"><a class="ae od" href="https://devopscube.com/list-linux-networking-troubleshooting-and-commands-beginners/" rel="noopener ugc nofollow" target="_blank"> Devopscube </a></li></ul></div></div>    
</body>
</html>