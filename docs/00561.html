<html>
<head>
<title>Intersection Observer API: speed up your web applications with lazy loading</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">äº¤å‰ç‚¹è§‚å¯Ÿå™¨API:é€šè¿‡å»¶è¿ŸåŠ è½½åŠ é€Ÿæ‚¨çš„webåº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/intersection-observer-api-speed-up-your-web-applications-with-lazy-loading-ab6df7ead9ca?source=collection_archive---------1-----------------------#2019-05-07">https://levelup.gitconnected.com/intersection-observer-api-speed-up-your-web-applications-with-lazy-loading-ab6df7ead9ca?source=collection_archive---------1-----------------------#2019-05-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="3e61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">äº¤å‰ç‚¹è§‚å¯Ÿå™¨å¯ä»¥é€šè¿‡å¸®åŠ©ä½ å®ç°å›¾åƒçš„å»¶è¿ŸåŠ è½½æ¥æé«˜ä½ çš„webåº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</em></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/cf8d447e9354a3316274431b58165291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUWWv7fGDMjCJy9tPGIjMQ.png"/></div></div></figure><p id="1394" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨è¿‡å»çš„å‡ ä¸ªæœˆé‡Œï¼Œæˆ‘åŠªåŠ›æé«˜æˆ‘çš„ç½‘ç«™çš„é¡µé¢é€Ÿåº¦ã€‚æˆ‘æ”¹è¿›äº†æˆ‘æ‰€æœ‰çš„å®¢æˆ·ç«¯ä»£ç ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨è°·æ­Œå®˜æ–¹Chromeå·¥å…·<a class="ae lb" href="https://developers.google.com/web/tools/lighthouse/" rel="noopener ugc nofollow" target="_blank"> Lighthouse </a>ä¸Šè¾¾åˆ°90åˆ†ä»¥ä¸Šçš„æ€§èƒ½åˆ†æ•°ï¼Œä»¥è¡¡é‡ä½ çš„ç½‘ç»œåº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€å¯è®¿é—®æ€§ã€<a class="ae lb" href="https://www.fabrizioduroni.it/2019/03/03/github-pages-progressive-web-app.html" rel="noopener ugc nofollow" target="_blank"> progressive web apps </a>åˆè§„æ€§ç­‰ã€‚æŠ¥å‘Šä¸­çš„æœ€åä¸€ä»¶äº‹æ˜¯å…³äºå±å¹•å¤–å›¾åƒçš„è­¦å‘Šï¼Œå¦‚ä¸‹é¢çš„å±å¹•æˆªå›¾æ‰€ç¤º:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lc"><img src="../Images/ad8fb006e562019b0cf19721cbfb4692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3QmIUuakWjh_9E7LpQv6w.jpeg"/></div></div></figure><p id="6a33" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ‰€ä»¥æˆ‘ç‚¹å‡»äº†æŠ¥å‘Šä¸­çš„é“¾æ¥ï¼Œè¯¥é“¾æ¥æŒ‡å‘ä¸€ä¸ªåŒ…å«è°·æ­Œå®˜æ–¹å…³äºå±å¹•å¤–å›¾ç‰‡åŠ è½½æŒ‡å—çš„é¡µé¢ã€‚è¯¥é¡µé¢çš„ä¸»é¢˜æ˜¯<a class="ae lb" href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener ugc nofollow" target="_blank">äº¤å‰ç‚¹è§‚å¯Ÿå™¨API </a>ä»¥åŠå®ƒå¦‚ä½•å¸®åŠ©æ‚¨ä»…åœ¨ç‰¹å®šå†…å®¹åœ¨è§†çª—ä¸­å¯è§æ—¶æ‰åŠ è½½å®ƒã€‚æˆ‘è¿˜åœ¨Google developerå®˜æ–¹ç½‘ç«™ä¸Šæ‰¾åˆ°äº†å¦ä¸€ç¯‡æ–‡ç« ï¼Œè¯¦ç»†è§£é‡Šäº†å¦‚ä½•åˆ©ç”¨Intersection Observerçš„èƒ½åŠ›åœ¨webåº”ç”¨ç¨‹åºä¸­å»¶è¿ŸåŠ è½½å›¾åƒã€‚æ‰€ä»¥ä½ å¯ä»¥æƒ³è±¡æˆ‘â€œæ¥å—äº†æŒ‘æˆ˜â€(å°±åƒã€Šæˆ‘æ˜¯å¦‚ä½•é‡è§ä½ çš„æ¯äº²ã€‹ä¸­çš„å·´å°¼Â·æ–¯ä¸æ£®é‚£æ ·)ğŸ˜œ)ç„¶åæˆ‘å¼€å§‹ä¸ºæˆ‘çš„ç½‘ç«™å®ç°å›¾ç‰‡çš„æƒ°æ€§åŠ è½½ã€‚</p><h2 id="3870" class="ld le it bd lf lg lh dn li lj lk dp ll kb lm ln lo kf lp lq lr kj ls lt lu lv bi translated">å±¥è¡Œ</h2><p id="507e" class="pw-post-body-paragraph jq jr it js b jt lw jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj ma kl km kn im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªåä¸º<code class="fe mb mc md me b">lazyLoadImages</code>çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°:</p><ul class=""><li id="4275" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe mb mc md me b">selector</code>è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘å°†ä½¿ç”¨å®ƒæ¥é€‰æ‹©æˆ‘æƒ³è¦è§‚å¯Ÿçš„æ‰€æœ‰æ–‡æ¡£å¯¹è±¡</li><li id="295c" class="mf mg it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe mb mc md me b">loadCompleted</code>å›¾åƒä¸‹è½½åå°†æ‰§è¡Œçš„åŠŸèƒ½</li></ul><p id="1ee3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¯¥å‡½æ•°å°†ä»<a class="ae lb" href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener ugc nofollow" target="_blank">äº¤å‰ç‚¹è§‚å¯Ÿå™¨API </a>åˆ›å»ºä¸€ä¸ª<code class="fe mb mc md me b">IntersectionObserver</code>å¯¹è±¡çš„æ–°å®ä¾‹ã€‚è¿™ä¸ªå¯¹è±¡æ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°:</p><ul class=""><li id="7a51" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated">å›è°ƒï¼Œå³åœ¨ç»™å®šå½“å‰é…ç½®çš„æƒ…å†µä¸‹ï¼Œå½“å¯¹è±¡å˜å¾—å¯è§æ—¶è°ƒç”¨çš„å‡½æ•°</li><li id="537d" class="mf mg it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå…è®¸å¼€å‘äººå‘˜è‡ªå®šä¹‰äº¤å‰ç‚¹è§‚å¯Ÿå™¨å¦‚ä½•è®¡ç®—ä¸è§†å£çš„äº¤å‰ç‚¹</li></ul><p id="0e5b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨åˆ›å»ºäº†<code class="fe mb mc md me b">IntersectionObserver</code>å¯¹è±¡ä¹‹åï¼Œæˆ‘é€šè¿‡è°ƒç”¨ä½¿ç”¨<a class="ae lb" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll" rel="noopener ugc nofollow" target="_blank"> querySelectorAll </a>æ–¹æ³•é€‰æ‹©çš„æ–‡æ¡£å¯¹è±¡ä¸Šçš„<code class="fe mb mc md me b">observer(element)</code>æ–¹æ³•ï¼Œå°†å®ƒé™„åŠ åˆ°æˆ‘æƒ³è¦è§‚å¯Ÿçš„DOMå…ƒç´ ä¸Šï¼Œå¹¶å°†<code class="fe mb mc md me b">selector</code>ä½œä¸ºå‚æ•°æ¥æ”¶ã€‚</p><pre class="kq kr ks kt gt mt me mu mv aw mw bi"><span id="4bc7" class="ld le it me b gy mx my l mz na">const lazyLoadImages = (selector, loadCompleted) =&gt; {<br/>  const intersectionObserver: IntersectionObserver = <br/>          new IntersectionObserver(<br/>            (entries, observer) =&gt; onIntersection(entries, <br/>                                                  observer,  <br/>                                                  loadCompleted),<br/>            { rootMargin: '50px 0px', threshold: 0.01 }<br/>          )<br/>  document.querySelectorAll(selector)<br/>          .forEach(image =&gt; intersectionObserver.observe(image))<br/>}</span></pre><p id="273f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­£å¦‚ä½ åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­çœ‹åˆ°çš„ï¼Œåœ¨äº¤å‰ç‚¹å›è°ƒä¸­ï¼Œæˆ‘è°ƒç”¨äº†<code class="fe mb mc md me b">onIntersection</code>å‡½æ•°ã€‚å®ƒæ˜¯åšä»€ä¹ˆçš„ï¼Ÿè¯¥å‡½æ•°æ£€æŸ¥ä»äº¤å‰ç‚¹è§‚å¯Ÿå™¨æ¥æ”¶çš„<code class="fe mb mc md me b">IntersectionObserverEntry</code>ä½œä¸ºå‚æ•°ã€‚å¦‚æœä¸€ä¸ª<code class="fe mb mc md me b">target</code> <code class="fe mb mc md me b">Element</code>åœ¨è§†å£å†…ï¼Œå®ƒçš„<code class="fe mb mc md me b">intersectionRatio</code> &gt;å°†ä¸º0ã€‚å½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œæˆ‘å¯ä»¥ç§»é™¤è§‚å¯Ÿè€…ï¼Œå¹¶ä½¿ç”¨<code class="fe mb mc md me b">loadImage</code>å‡½æ•°å¼€å§‹åŠ è½½å›¾åƒã€‚</p><pre class="kq kr ks kt gt mt me mu mv aw mw bi"><span id="8bf5" class="ld le it me b gy mx my l mz na">const onIntersection = (entries, observer, loadCompleted) =&gt; {<br/>  entries.forEach(entry =&gt; {<br/>    if (entry.intersectionRatio &gt; 0) {<br/>      observer.unobserve(entry.target)<br/>      loadImage(entry.target, loadCompleted)<br/>    }<br/>  })<br/>}</span></pre><p id="4009" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mb mc md me b">loadImage</code>åŠŸèƒ½é€šè¿‡ç”¨<code class="fe mb mc md me b">data-src</code>åŸŸä¸­åŒ…å«çš„æ•°æ®è®¾ç½®å›¾åƒsrcåŸŸæ¥ä¸‹è½½å›¾åƒã€‚åœ¨ä¸‹è½½ç»“æŸæ—¶ï¼Œæˆ‘åˆ é™¤äº†ç”¨æ¥éšè—å›¾ç‰‡çš„cssç±»<code class="fe mb mc md me b">lazy</code>,ç›´åˆ°å›¾ç‰‡ä¸‹è½½å®Œæ¯•ã€‚ç„¶åè°ƒç”¨<code class="fe mb mc md me b">loadCompleted</code>å‡½æ•°ï¼Œè°ƒç”¨è€…å¯ä»¥å¯¹å›¾åƒåšä»»ä½•æƒ³åšçš„äº‹æƒ…(ä¾‹å¦‚ï¼Œæˆ‘åšäº†ä¸€ä¸ªè‡ªå®šä¹‰åŠ¨ç”»ï¼Œä»¥é¿å…å›¾åƒæ˜¾ç¤ºæ—¶å‡ºç°é—ªçƒæ•ˆæœ)ã€‚</p><pre class="kq kr ks kt gt mt me mu mv aw mw bi"><span id="4f1f" class="ld le it me b gy mx my l mz na">const loadImage = (image, loadCompleted) =&gt; {<br/>  image.src = image.dataset.src<br/>  image.onload = () =&gt; {<br/>    removeCssClass(image, 'lazy')<br/>    loadCompleted(image)<br/>  }<br/>}</span></pre><p id="0ab0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¿™æ˜¯å…·æœ‰å®Œæ•´æµç¨‹çš„æœ€ç»ˆè„šæœ¬ã€‚</p><pre class="kq kr ks kt gt mt me mu mv aw mw bi"><span id="5a0a" class="ld le it me b gy mx my l mz na">import 'intersection-observer'<br/>import { removeCssClass } from './css-class'</span><span id="4a0e" class="ld le it me b gy nb my l mz na">const lazyLoadImages = (selector, loadCompleted) =&gt; {<br/>  const intersectionObserver: IntersectionObserver = <br/>          new IntersectionObserver(<br/>            (entries, observer) =&gt; onIntersection(entries, <br/>                                                  observer,  <br/>                                                  loadCompleted),<br/>            { rootMargin: '50px 0px', threshold: 0.01 }<br/>          )<br/>  document.querySelectorAll(selector)<br/>          .forEach(image =&gt; intersectionObserver.observe(image))<br/>}</span><span id="2224" class="ld le it me b gy nb my l mz na">const onIntersection = (entries, observer, loadCompleted) =&gt; {<br/>  entries.forEach(entry =&gt; {<br/>    if (entry.intersectionRatio &gt; 0) {<br/>      observer.unobserve(entry.target)<br/>      loadImage(entry.target, loadCompleted)<br/>    }<br/>  })<br/>}</span><span id="4262" class="ld le it me b gy nb my l mz na">const loadImage = (image, loadCompleted) =&gt; {<br/>  image.src = image.dataset.src<br/>  image.onload = () =&gt; {<br/>    removeCssClass(image, 'lazy')<br/>    loadCompleted(image)<br/>  }<br/>}</span><span id="0097" class="ld le it me b gy nb my l mz na">export { lazyLoadImages }</span></pre><p id="1bfc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¿˜æœ‰ä¸€ä»¶äº‹æˆ‘è¿˜æ²¡è®¨è®ºã€‚å¯¹äºè¿˜æ²¡æœ‰å®ç°<code class="fe mb mc md me b">IntersectionObserver</code> APIçš„æµè§ˆå™¨ï¼Œæˆ‘ä»¬å¦‚ä½•æ”¯æŒè¿™ç§ç±»å‹çš„å»¶è¿ŸåŠ è½½å‘¢ï¼Ÿç­”æ¡ˆæ˜¯<a class="ae lb" href="https://github.com/w3c/IntersectionObserver/tree/master/polyfill" rel="noopener ugc nofollow" target="_blank">èŠ‚é—´è§‚å¯Ÿè€…Polyfill </a>ã€‚æˆ‘æŠŠå®ƒä½œä¸ºæˆ‘çš„é¡¹ç›®çš„ä¸€ä¸ªä¾èµ–é¡¹æ¥å®‰è£…ã€‚</p><pre class="kq kr ks kt gt mt me mu mv aw mw bi"><span id="895f" class="ld le it me b gy mx my l mz na">npm install --save intersection-observer</span></pre><p id="98ff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¿™ä¸ª<a class="ae lb" href="https://en.wikipedia.org/wiki/Polyfill_(programming)" rel="noopener ugc nofollow" target="_blank"> polyfill </a>å…¬å¼€äº†äº¤å‰ç‚¹è§‚å¯Ÿå™¨çš„æ™®é€šjavascriptä¸­çš„ç‰¹å®šå®ç°ï¼Œæˆ–è€…å®ƒå…¬å¼€äº†å½“å‰çš„æµè§ˆå™¨å®ç°ï¼Œå¦‚æœå®ƒå·²ç»å­˜åœ¨äºç”¨æˆ·æ­£åœ¨ä½¿ç”¨çš„æµè§ˆå™¨ä¸­çš„è¯ã€‚</p><h2 id="c8c0" class="ld le it bd lf lg lh dn li lj lk dp ll kb lm ln lo kf lp lq lr kj ls lt lu lv bi translated">ç»“è®º</h2><p id="62f5" class="pw-post-body-paragraph jq jr it js b jt lw jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj ma kl km kn im bi translated">äº¤å‰ç‚¹è§‚å¯Ÿå™¨æ˜¯ä¸€ä¸ªå¼ºå¤§çš„APIã€‚å®ƒè®©ä½ å®ç°èµ„æºåŠ è½½çš„å»¶è¿ŸåŠ è½½ï¼Œå¹¶è¾¾åˆ°æˆ‘åªæœ‰åœ¨ç§»åŠ¨åŸç”Ÿåº”ç”¨ä¸­æ‰æœ‰æœºä¼šçœ‹åˆ°çš„æ€§èƒ½å’Œæ¶æ„åº”ç”¨æ¨¡å¼ã€‚ç½‘ç»œæ­£åœ¨ç”¨åŸç”Ÿåº”ç”¨å¡«è¡¥è¿™ä¸€ç©ºç™½ï¼Œè€Œäº¤å‰ç‚¹è§‚å¯Ÿè€…æ˜¯å¦ä¸€ä¸ªè¯æ˜ï¼Œ90%çš„ç°æœ‰åŸç”Ÿç§»åŠ¨åº”ç”¨å¯ä»¥æˆä¸ºå¼ºå¤§çš„ç½‘ç»œåº”ç”¨ã€‚äº‹å®ä¸Šï¼Œåœ¨æˆ‘çš„æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»ç„¶æ˜¯ä¸€ååŸç”Ÿç§»åŠ¨åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œæˆ‘ä»ç„¶åœ¨å…³æ³¨iOSã€Androidå’ŒReactåŸç”Ÿåœºæ™¯ï¼Œæˆ‘ä»ç„¶åœ¨ç ”ç©¶è‹¹æœã€è°·æ­Œå’Œè„¸ä¹¦å‘å¸ƒçš„æ‰€æœ‰æ–°å·¥å…·å’ŒSDKæ”¹è¿›ã€‚ä½†æ˜¯ï¼Œä½ çŸ¥é“ï¼ŒæŠ€æœ¯å‘å±•å¾ˆå¿«ï¼Œæˆ‘å¿…é¡»ä¸ºæœªæ¥åšå¥½å‡†å¤‡ğŸ˜Œã€‚Soooï¼Œè·¯å£è§‚å¯Ÿè€…ä¸‡å²ï¼ï¼ï¼æœ‰äº†æ‚¨çš„å¸®åŠ©ï¼ŒWebåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ä¼šå¤§å¤§æé«˜ğŸ’šã€‚</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="c503" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">åŸè½½äº2019å¹´5æœˆ7æ—¥</em><a class="ae lb" href="https://www.fabrizioduroni.it/2019/05/08/intersection-observer.html" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://www . fabrizioduroni . it</em></a><em class="ko">ã€‚</em></p></div></div>    
</body>
</html>