<html>
<head>
<title>Create a Number Animation with React Spring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用反应弹簧创建数字动画</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-a-number-animation-with-react-spring-670975daa28d?source=collection_archive---------11-----------------------#2021-03-07">https://levelup.gitconnected.com/create-a-number-animation-with-react-spring-670975daa28d?source=collection_archive---------11-----------------------#2021-03-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f7e1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">react-spring中的useSpring钩子使用介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab319738083a052bd8bd244f1516738f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xzj6zLtv4EOwCsta"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Markus Spiske </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="540a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将看看如何使用<a class="ae ky" href="https://www.react-spring.io/" rel="noopener ugc nofollow" target="_blank"> react-spring </a>库来创建这个动画。这比你想象的要容易得多。</p><blockquote class="lv lw lx"><p id="7516" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">react-spring是一个基于spring物理学的动画库，应该可以满足你的大部分UI相关的动画需求。它为您提供了足够灵活的工具，让您可以自信地将自己的想法融入到移动界面中。”</p></blockquote><p id="b9dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的示例中，我们将创建一个应用程序，它将在单击按钮时生成一个随机数。</p><p id="4a57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当数字生成时，它将从0开始向上计数，创建一个有趣的动画，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/a1305fc87a6e51c1f84300d1a51995c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*QRT2TnkJpqOJSfMWeGuung.gif"/></div></figure></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="95f8" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">入门指南</h1><p id="1298" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">让我们从使用<code class="fe nh ni nj nk b">create-react-app</code>创建一个新的应用程序开始。从那里，我们将清理未使用的文件，我们的文件结构将如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/0711731ea0c0ff0ec5a3c839b9f8797d.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*gJu2My_AuldPzv2IiUdHxg.png"/></div></figure><p id="6a5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将首先用硬编码数据构建一个基本设计。在<code class="fe nh ni nj nk b">App.js</code>文件中，创建一个<code class="fe nh ni nj nk b">div</code>，它将成为我们的卡组件。在这个<code class="fe nh ni nj nk b">div</code>中，我们将有另一个<code class="fe nh ni nj nk b">div</code>作为数字和一个<code class="fe nh ni nj nk b">button</code>标签。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="b6b7" class="nq ml it nk b gy nr ns l nt nu">const App = () =&gt; {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;div className="card"&gt;<br/>        &lt;div className="number"&gt;1000000&lt;/div&gt;<br/>        &lt;button&gt;Random Number&lt;/button&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span></pre><p id="6431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nh ni nj nk b">index.css</code>文件中，让我们添加一些如下的样式，让我们的应用程序看起来更好一些。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3939" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的应用程序现在应该如下图所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/b28a4cbcb541c7d24c8338fd1929965f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*Vm4jWvn7u9QPJAyP-5WQ9w.png"/></div></figure><h1 id="be21" class="mk ml it bd mm mn ny mp mq mr nz mt mu jz oa ka mw kc ob kd my kf oc kg na nb bi translated">创建数字动画</h1><p id="f60f" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">接下来，我们将使用react-spring创建数字动画。首先，将库安装到项目中。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="f617" class="nq ml it nk b gy nr ns l nt nu">npm install react-spring</span></pre><p id="18c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用库中的<code class="fe nh ni nj nk b">useSpring</code>钩子和<code class="fe nh ni nj nk b">animated</code>值。让我们将这些导入到<code class="fe nh ni nj nk b">App.js</code>文件中。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="3d2a" class="nq ml it nk b gy nr ns l nt nu">import { useSpring, animated } from 'react-spring';</span></pre><p id="d035" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">useSpring</code>钩子是一个弹簧，它将数据从一种状态转移到另一种状态。在App组件中，我们将定义我们想要做的spring动画。它将接受一个数字，从0开始，动画到1000000。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="82f0" class="nq ml it nk b gy nr ns l nt nu">const props = useSpring({ val: 100000, from: { val: 0 } });</span></pre><p id="d32d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们需要更新return语句中的元素来使用这个动画。要使用react-spring，我们需要将<code class="fe nh ni nj nk b">animated</code>添加到我们想要制作动画的<code class="fe nh ni nj nk b">div</code>中。然后我们将添加动画作为一个值来代替硬编码的数字。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="bad8" class="nq ml it nk b gy nr ns l nt nu">&lt;animated.div className="number"&gt;<br/>  {props.val}<br/>&lt;/animated.div&gt;</span></pre><p id="f0d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将创建我们的动画如下。但是有些不对劲。正如你所看到的，当数字向上计数时，有这么多的小数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/d93c4a1653fab1499f49d46ae80e87cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*ehw-0k3Ryn7_pPLB-Ew_uQ.gif"/></div></figure><p id="96cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了解决这个问题，我们将使用插值函数并对值调用<code class="fe nh ni nj nk b">Math.floor</code>。这将为我们去掉小数。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="589f" class="nq ml it nk b gy nr ns l nt nu">&lt;animated.div className="number"&gt;<br/>  {props.val.interpolate(<em class="ly">val</em> =&gt; Math.floor(val))}<br/>&lt;/animated.div&gt;</span></pre><p id="d263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们应该有一个没有小数的清晰的动画。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/68828f24c51f3e7d9f73f6f0b2fa3fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*7iyFd85Gm_h47L5TkgiGtQ.gif"/></div></figure><h1 id="57cb" class="mk ml it bd mm mn ny mp mq mr nz mt mu jz oa ka mw kc ob kd my kf oc kg na nb bi translated">生成一个随机数</h1><p id="6390" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">最后，我们将添加按钮功能来生成一个随机数。</p><p id="8f19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用react中的<code class="fe nh ni nj nk b">useState</code>钩子来创建一个数字状态。这将更新一个按钮点击随机生成的数字。</p><p id="5368" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还在<code class="fe nh ni nj nk b">App.js</code>文件里面，从react导入<code class="fe nh ni nj nk b">useState</code>。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="4bc7" class="nq ml it nk b gy nr ns l nt nu">import { useState } from 'react';</span></pre><p id="3781" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，创建一个状态，我们将初始值设置为1000000。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="0980" class="nq ml it nk b gy nr ns l nt nu">const [num, setNum] = useState(1000000);</span></pre><p id="7e6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以更新我们的<code class="fe nh ni nj nk b">useSpring</code>函数来制作动画，直到<code class="fe nh ni nj nk b">num</code>值，而不是一个静态的数字。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="707b" class="nq ml it nk b gy nr ns l nt nu">const props = useSpring({ val: num, from: { val: 0 } });</span></pre><p id="a516" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将创建一个名为<code class="fe nh ni nj nk b">randomNum</code>的变量，它将为我们生成一个介于0和1000000之间的随机数。为此，我们将使用如下的<code class="fe nh ni nj nk b">Math.floor</code>和<code class="fe nh ni nj nk b">Math.random</code>函数。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="3c3f" class="nq ml it nk b gy nr ns l nt nu">const randomNum = Math.floor(Math.random() * 1000000);</span></pre><p id="a775" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们将在按钮上添加<code class="fe nh ni nj nk b">onClick</code>道具，这将在按钮点击时更新<code class="fe nh ni nj nk b">num</code>的状态。</p><pre class="kj kk kl km gt nm nk nn no aw np bi"><span id="55a6" class="nq ml it nk b gy nr ns l nt nu">&lt;button onClick={() =&gt; setNum(randomNum)}&gt;Random Number&lt;/button&gt;</span></pre><p id="12c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终的<code class="fe nh ni nj nk b">App.js</code>文件将如下所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="4d5f" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">包扎</h1><p id="d494" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">感谢阅读！你现在有一个随机数发生器，它可以做一个向上计数的动画。你可以在这里找到这个应用<a class="ae ky" href="https://github.com/chadmuro/medium-react-spring-number" rel="noopener ugc nofollow" target="_blank">的完整源代码。</a></p><p id="852e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">React-spring是一个很好的库，可以向React应用程序添加动画。它很容易使用，你可以用它做很多事情。查看下面的文档，看看你还能做些什么。</p><div class="od oe gp gr of og"><a href="https://www.react-spring.io/" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">反作用弹簧</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">使用React的简单spring动画原语，让您的组件栩栩如生</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">www.react-spring.io</p></div></div><div class="op l"><div class="oq l or os ot op ou ks og"/></div></div></a></div><p id="5496" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想查看另一个react动画库的运行情况，请查看下面的文章以了解framer-motion。</p><div class="od oe gp gr of og"><a href="https://js.plainenglish.io/animate-when-element-is-in-view-with-framer-motion-63b254403bf" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">当元素出现在视图中且有帧运动时，制作动画</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">一个简单的解决方案，动画反应元素时，在视图中使用帧运动</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">js .平原英语. io</p></div></div><div class="op l"><div class="ov l or os ot op ou ks og"/></div></div></a></div></div></div>    
</body>
</html>