<html>
<head>
<title>How Slow is Python?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python到底有多慢？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-slow-is-python-6f2fc1fbfbaa?source=collection_archive---------5-----------------------#2022-02-22">https://levelup.gitconnected.com/how-slow-is-python-6f2fc1fbfbaa?source=collection_archive---------5-----------------------#2022-02-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0b1c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们都知道它比C，Java，Rust慢，但是到底有多慢呢？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/14c58eb50b89f2210c729834b890c4ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kOjDXNW1V5aQYWmI"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Alex bljan在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="05e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就在我开始思考这篇文章的时候，我的Medium feed发表了一篇滑稽的帖子“Python其实并不慢”——我读了它，尽管我知道这不是真的，只是一个点击诱饵。当谈到Python时，你是在和一只蜗牛打交道，虽然你可以训练出一只蜗牛，但你无法逃脱它的基本遗传(不像经典电影《Gattaca》中的伊桑·霍克)。</p><h1 id="c23a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">标杆管理</h1><p id="c679" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我开始编写一些简单的基准程序，用C、Rust、Java和Python进行交叉测试。我认为要评估的主要类别有:</p><ul class=""><li id="a0b8" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">管理内存压力(对象创建/销毁)</li><li id="6762" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">类似JSON的字符串处理</li><li id="d9cc" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">循环和计算密集型操作</li></ul><p id="5264" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为参考，有一个很棒的<a class="ae ky" href="https://github.com/kostya/benchmarks" rel="noopener ugc nofollow" target="_blank"> GitHub项目</a>评估十几种语言的性能。下面是汇总表，如果C++的基线是1，那么Python在<a class="ae ky" href="https://gist.github.com/roachhd/dce54bec8ba55fb17d3a" rel="noopener ugc nofollow" target="_blank"> brainf测试</a>(这是一个非常有趣的<strong class="lb iu">图灵机</strong>解释器)中慢了227倍。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/17e915807966184e58c8a3638de9e3c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*1YFqFHxz77sbFp-v_8k7Ow.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://github.com/kostya/benchmarks" rel="noopener ugc nofollow" target="_blank"> Kostya M </a>的github项目提供</figcaption></figure><p id="5287" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最终编写了超级基本的代码片段测试，因为我意识到我忘记了如何用这些语言编程。我不得不重新设定我的雄心以匹配我的微弱技能...</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/125d25370a45fdd01846e33292e8f6eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sc0AvOEI6nBMLr0a_iyCMg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">道格·福实验室</figcaption></figure><h1 id="418b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">来自测试结果的见解</h1><p id="99bf" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><em class="ni">我将在参考资料部分链接到我的GitHub进行真正的测试。我希望命名是不言自明的。</em></p><p id="3ce1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些是我跨语言的心得:</p><ol class=""><li id="c3b3" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu nj my mz na bi translated"><strong class="lb iu"> Python文件I/O相对较快</strong>，因为限制因素是磁盘</li><li id="8aeb" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated"><strong class="lb iu"> Python在递归上异常慢</strong>，做递归Fibonacci在fib(30)上慢得不可理喻</li><li id="1100" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated"><strong class="lb iu"> Python函数调用缓慢</strong>——导致了递归问题</li><li id="cab5" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">Java w/o JIT优化可能真的很慢，有些事情甚至比Python还慢</li><li id="9624" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">Java原生字符串仍然非常慢(100倍)，使用StringBuilder使它变得相当快，但是比Python慢</li><li id="5718" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated"><strong class="lb iu"> Java w/ JIT现在相当快</strong>几乎不值得再用C了…</li><li id="ef9e" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">Rust真的很快，如果我知道如何在它里面更好地编码，可能会更快…</li></ol><p id="8b57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">速度慢200倍的基准测试还没有在我的小工具包中得到验证，但是很明显，只要进行一些额外的函数调用和递归，就可以轻松实现。</p><h1 id="a835" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">那么Python为什么慢呢？</strong></h1><p id="4913" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">大多数事情都是显而易见的，但让我列出来:</p><ol class=""><li id="37fa" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu nj my mz na bi translated">Python是<strong class="lb iu">解释的</strong>，虽然是字节编译的，但并没有真正优化</li><li id="3941" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">它是<strong class="lb iu">垃圾收集</strong>，但是它主要使用引用计数，所以它比Java快一点或者至少更确定</li><li id="d8b0" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">默认情况下，它没有JIT编译器(T7)——这对于解释型语言来说似乎很关键(PyPy利用这一点将其提升了10倍)</li><li id="d97c" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">作为一种<strong class="lb iu">非类型化的动态语言</strong>有其缓慢之处(并且使得构建JIT更加困难)</li><li id="48f9" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">执行<strong class="lb iu">函数调用异常缓慢</strong>(也许是堆栈帧分配有些复杂？)</li></ol><p id="bacb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们甚至没有测试多线程或多编程，因为我们都知道Python也有<strong class="lb iu"> GIL(全局解释器锁)</strong>问题。</p><h1 id="3336" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">如何优化Python</h1><p id="c8aa" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">有一些技巧可以提高Python的速度，但是大多数都不是很好。</p><ol class=""><li id="0526" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu nj my mz na bi translated">使用多进程来产生工人(但是要注意你会受到GIL的限制)</li><li id="9507" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">写原生C代码，链接到Python</li><li id="a983" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">使用本地Python函数(用C语言在运行时编写)</li><li id="d170" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">一行列表理解似乎是性能优化的，所以它们看起来不仅仅是很酷的技巧</li></ol><p id="9f92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">老实说，我没有看到很多很棒的提示……有些提示就像“使用O(n)和O(n-log n)算法，而不是O(n)”……也许第一个提示应该是<strong class="lb iu">学习一些计算机科学</strong>？</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="985c" class="lv lw it bd lx ly nr ma mb mc ns me mf jz nt ka mh kc nu kd mj kf nv kg ml mm bi translated">参考</h1><ol class=""><li id="5178" class="ms mt it lb b lc mn lf mo li nw lm nx lq ny lu nj my mz na bi translated">让Python快速—<a class="ae ky" href="https://www.kdnuggets.com/2021/06/make-python-code-run-incredibly-fast.html" rel="noopener ugc nofollow" target="_blank">https://github . com/ajcr/ajcr . github . io/blob/master/_ posts/2016-04-01-fast-inverse-square-root-Python . MD</a></li><li id="c190" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">python Slowness—<a class="ae ky" href="https://towardsdatascience.com/why-is-python-so-slow-and-how-to-speed-it-up-485b5a84154e" rel="noopener" target="_blank">https://medium . com/analytics-vid hya/is-python-really-very-slow-2-major-problems-to-know-that-makes-python-very-slow-9e 92653265 ea</a></li><li id="e14d" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">Python为什么慢—<a class="ae ky" href="https://hackernoon.com/why-is-python-so-slow-e5074b6fe55b" rel="noopener ugc nofollow" target="_blank">https://hackernoon.com/why-is-python-so-slow-e5074b6fe55b</a></li><li id="72b7" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">hack test1的GitHub。*样本s—<a class="ae ky" href="https://github.com/dougfoo/medium" rel="noopener ugc nofollow" target="_blank">https://github.com/dougfoo/medium</a></li><li id="17bb" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu nj my mz na bi translated">Python中缺乏字节码优化—<a class="ae ky" href="https://nullprogram.com/blog/2019/02/24/" rel="noopener ugc nofollow" target="_blank">https://nullprogram.com/blog/2019/02/24/</a></li></ol></div></div>    
</body>
</html>