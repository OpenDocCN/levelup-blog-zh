<html>
<head>
<title>How To Build A Real-Time Emotion Detection Web App💻</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建一个实时情绪检测Web应用程序💻</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-build-a-real-time-emotion-detection-web-app-ce7e3ed7b7de?source=collection_archive---------1-----------------------#2021-08-02">https://levelup.gitconnected.com/how-to-build-a-real-time-emotion-detection-web-app-ce7e3ed7b7de?source=collection_archive---------1-----------------------#2021-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="09b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用卷积神经网络检测多达7种情绪</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/060427506ac385509dc90e26e993753b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwVmXSP24RORV13JL0nGGg.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">马修·福涅尔在<a class="ae lb" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0355" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们开始之前，请确保您熟悉先决条件。</p><h1 id="d032" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">先决条件</h1><ul class=""><li id="e3f6" class="ma mb iq jp b jq mc ju md jy me kc mf kg mg kk mh mi mj mk bi translated">计算机编程语言</li><li id="13de" class="ma mb iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">张量流+ Keras</li><li id="d2e7" class="ma mb iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">瓶</li><li id="c790" class="ma mb iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">OpenCV</li></ul><p id="fd32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们完成后web应用程序的预览😄</p><p id="3c00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://github.com/Kakarot-2000/Real_Time_Emotion_Detection" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="mq">这里是该项目的GitHub链接。</em> </strong> </a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mr"><img src="../Images/60c922646d02759627dd8f59f386ac64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ZhrYZxtruSXnoi9yiIGA1Q.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">我不太善于表达，是吗？😐</figcaption></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="364e" class="lc ld iq bd le lf mz lh li lj na ll lm ln nb lp lq lr nc lt lu lv nd lx ly lz bi translated">1.安装</h1><p id="2a1a" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy ne ka kb kc nf ke kf kg ng ki kj kk ij bi translated">首先，创建一个工作目录并切换到它。</p><pre class="km kn ko kp gt nh ni nj nk aw nl bi"><span id="0b62" class="nm ld iq ni b gy nn no l np nq">C:\Github&gt;mkdir emotion-detection &amp;&amp; cd emotion-detection<br/>C:\Github\emotion-detection&gt;</span></pre><p id="3186" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们需要下载数据集并将其复制到目录中。</p><p id="87a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://www.kaggle.com/msambare/fer2013" rel="noopener ugc nofollow" target="_blank">下载链接</a> : fer2013数据集</p><p id="edd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，让我们设置一个虚拟环境并安装需求。</p><pre class="km kn ko kp gt nh ni nj nk aw nl bi"><span id="c45b" class="nm ld iq ni b gy nn no l np nq">C:\Github\emotion-detection&gt;virtualenv venv1<br/>C:\Github\emotion-detection&gt;call venv1/Scripts/Activate<br/>(venv1) C:\Github\emotion-detection&gt; </span></pre><p id="f374" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们需要的图书馆的清单。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="km kn ko kp gt nh ni nj nk aw nl bi"><span id="da82" class="nm ld iq ni b gy nn no l np nq">(venv1) C:\Github\emotion-detection&gt;pip install -r requirements.txt</span></pre><p id="7efc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们完成后文件夹结构的样子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/4deff5c39a93bdf13e772f7a5bc89588.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*WXIUZyZFe40_9xnm0YxoXw.png"/></div></figure><h2 id="c2da" class="nm ld iq bd le nu nv dn li nw nx dp lm jy ny nz lq kc oa ob lu kg oc od ly oe bi translated">目录结构:</h2><ul class=""><li id="b33f" class="ma mb iq jp b jq mc ju md jy me kc mf kg mg kk mh mi mj mk bi translated"><code class="fe of og oh ni b">templates </code>:包含HTML文件的文件夹</li><li id="f969" class="ma mb iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated"><code class="fe of og oh ni b">app.py</code>:。包含web应用程序代码的py文件</li><li id="480d" class="ma mb iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated"><code class="fe of og oh ni b">emotion_detection.py</code>:神经网络实现</li><li id="40e9" class="ma mb iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated"><code class="fe of og oh ni b">fer.h5</code>:保存的模型架构</li><li id="3c06" class="ma mb iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated"><code class="fe of og oh ni b">fer.json</code>:保存的模型权重</li></ul><p id="9fe8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们完成安装包之后，我们可以开始训练模型^_^</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oi"><img src="../Images/29c3ea8623381ab98348e2cf0e5cb222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tX5wuhfLPeinWsdEemi3Q.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">图片来源:谷歌图片</figcaption></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="e302" class="lc ld iq bd le lf mz lh li lj na ll lm ln nb lp lq lr nc lt lu lv nd lx ly lz bi translated"><strong class="ak"> 2。训练模型</strong></h1><p id="a332" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy ne ka kb kc nf ke kf kg ng ki kj kk ij bi translated">创建一个文件<code class="fe of og oh ni b">emotion_detection.py</code>来建立和训练模型。训练之后，我们将保存模型的架构和权重，以便我们可以直接加载它来获得结果。</p><p id="6618" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一步是导入所有需要的库。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="eba7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，让我们将数据分成训练集和测试集。在这里，我们有7类情绪，因此<code class="fe of og oh ni b">num_classes</code> <em class="mq">是7。</em></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="45c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们对图像执行一些数据扩充以获得更好的结果。</p><p id="e441" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该步骤通过执行诸如旋转、缩放、重新缩放、翻转图像等操作来扩充数据。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4c26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">厉害！现在是时候建造神经net‼了</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="bd04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以调整参数或者用不同的层数、激活函数等建立你自己的网络。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5be41f41d25a7cf82dc3d6867167f0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*gT1bZLRWw1QfupGITZNYog.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">神经网络体系结构</figcaption></figure><p id="a2a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧！下一步是使模型适合数据集。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/94e1bec171d36a9a06687f70de402288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*Ky_eT5w7BDoqZgTuRyXwIw.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">我们都曾经有过这样的经历😐</figcaption></figure><p id="d4d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="mq">注意:如果你的模型训练时间太长，那么使用允许访问免费GPU或TPU进行训练的平台(例如:Google Colab，Kaggle) </em> </strong></p><p id="a85b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在emotion_detection.py文件的最后一部分，我们将保存模型的架构和权重。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9f85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在运行emotion_detection.py之后，我们应该在目录中有了<code class="fe of og oh ni b">fer.json</code>和<code class="fe of og oh ni b">fer.h5</code>。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="14a7" class="lc ld iq bd le lf mz lh li lj na ll lm ln nb lp lq lr nc lt lu lv nd lx ly lz bi translated">3.构建web应用程序</h1><p id="b6b4" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy ne ka kb kc nf ke kf kg ng ki kj kk ij bi translated">我们将使用flask框架构建一个轻量级的web应用程序。在此之前，我们需要OpenCV的<code class="fe of og oh ni b">haarcascade_frontalface_default.xml</code>来检测人脸。从GitHub中克隆<a class="ae lb" href="https://github.com/opencv/opencv" rel="noopener ugc nofollow" target="_blank"> OpenCV的仓库</a>并将<code class="fe of og oh ni b">.xml</code>文件复制到工作目录中。</p><p id="d0f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们来编码<code class="fe of og oh ni b">app.py</code>。这里的第一步是导入库。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="bc1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将把之前训练好的模型加载到<code class="fe of og oh ni b">app.py</code></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="ef8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网络摄像头馈送输入由0表示，因此<code class="fe of og oh ni b">cv2.VideoCapture()</code>的参数为0。接下来，我们从视频馈送中一个接一个地抓取帧，并转换它们以适应我们的神经网络的输入维度大小。然后，我们对图像帧进行预测，并返回该帧及其周围的文本框，并在框上标记情感！</p><p id="6c33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">检测人脸的代码由</strong> <a class="ae lb" href="https://www.c-sharpcorner.com/members/dhanush-m2" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">丹努什M </strong> </a> <strong class="jp ir">经</strong> <a class="ae lb" href="https://www.c-sharpcorner.com/article/real-time-emotion-detection-using-python/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="mq">来源</em> </strong> </a> <strong class="jp ir">。</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者:<a class="ae lb" href="https://www.c-sharpcorner.com/members/dhanush-m2" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">丹努什M </strong> </a></figcaption></figure><p id="0377" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">咻！只要再走一步，我们就完成了🔥</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="311a" class="lc ld iq bd le lf mz lh li lj na ll lm ln nb lp lq lr nc lt lu lv nd lx ly lz bi translated">4.将静态文件(HTML、CSS)添加到模板文件夹</h1><p id="d9f1" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy ne ka kb kc nf ke kf kg ng ki kj kk ij bi translated">我们需要将HTML文件放在templates文件夹中，因为Flask会自动在那里查找。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="c8c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！！现在我们可以运行代码来测试它了！！</p><ul class=""><li id="f934" class="ma mb iq jp b jq jr ju jv jy ol kc om kg on kk mh mi mj mk bi translated">运行app.py</li></ul><pre class="km kn ko kp gt nh ni nj nk aw nl bi"><span id="7455" class="nm ld iq ni b gy nn no l np nq">(venv1) C:\Github\emotion-detection&gt;<!-- -->python app.py</span></pre><ul class=""><li id="68d6" class="ma mb iq jp b jq jr ju jv jy ol kc om kg on kk mh mi mj mk bi translated">在浏览器中输入本地主机地址</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oo"><img src="../Images/992e1291ddc7d6f12870be03efbf2433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Npq2USK7zqnKorCmKVOBg.png"/></div></div></figure><p id="7bf2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，最后一个迷因😉</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi op"><img src="../Images/7770ff7cb327706a524c20c5744c6e8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*EmIOWQJOz_4TuKTIISf2ZA.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">向国王致敬👑</figcaption></figure></div></div>    
</body>
</html>