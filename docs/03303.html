<html>
<head>
<title>Deploying Microservices Using Serverless Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用无服务器架构部署微服务</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploying-microservices-using-serverless-architecture-cf7d1570950?source=collection_archive---------4-----------------------#2020-05-01">https://levelup.gitconnected.com/deploying-microservices-using-serverless-architecture-cf7d1570950?source=collection_archive---------4-----------------------#2020-05-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f841" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi ko translated">无服务器架构(有时称为FaaS——功能即服务)是一种执行模式，云提供商负责运行代码片段，动态分配资源，客户只需为执行时间付费。</p><p id="ad5c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">代码通常在临时容器中执行，可以由几种类型的事件触发，包括HTTP请求、队列、数据库事件、监控警报、文件上传、cron作业等。在这个模型中，客户端不需要关心服务器，因为它被提供者的架构抽象了。</p><p id="0a4b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们从分析图1中定义的架构开始，在这里我们可以看到微服务的常规部署。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/2aae7785e3fdd8e058aaf26ac3b0c49f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HrZ50QgVa5AzF12I"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><strong class="bd ln">图1:一个基本的微服务架构</strong></figcaption></figure><p id="c90d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Web </strong>可以是运行在Web服务器上的SPA(单页应用程序)，比如Tomcat。</p><p id="029f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> API </strong></p><p id="b4df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">微服务</strong>(图中<strong class="js iu"> MS </strong>)，运行rest控制器、服务和存储库的Spring boot</p><p id="cbc3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">数据库</strong> (DB)，MySQL数据库，它可以是每台机器有一个或多个实例的DB服务器，其中每个服务都有其DB实例。</p><p id="7443" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，让我们看看如何使用无服务器架构部署微服务。</p><p id="266b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以从将代码转换成无服务器功能(FaaS)开始，并将它们部署在云中。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/eae25991b61ccf050d0a0aa59636c77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjHwHsFXCdcJyRLOHr0rJA.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><strong class="bd ln">图2:功能(FaaS):你在云中编码</strong></figcaption></figure><p id="3d81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但这里似乎少了点什么。如何通过互联网从云外部访问功能？</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/e9540019666b3118d62a3352924800ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S59MQMY8sbd6-E1W"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><strong class="bd ln">图3:无服务器功能本身无法从互联网访问</strong></figcaption></figure><p id="c95f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要在互联网上发布我们的功能，帮助我们的自然候选是API网关。它是访问云中大多数服务的大门。它是一种无服务器的云资源，用于向互联网公开服务。它提供了实现这一目标所需的最常见的特性，比如缓存、安全性、请求节流、cors访问等等。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/6b95280cabfb5d9accf2b88d10c0d611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NCMdmUiS8UmyC9XL"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><strong class="bd ln">图4: API网关是向互联网公开云资源的最常见方式</strong></figcaption></figure><p id="5a82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一丝不苟的开发人员和架构师可以带着一定的批评来看待使用无服务器功能的微服务的实现。由于无服务器功能只是在云中执行的代码片段，它们太小而不能被视为微服务，它们看起来更像纳米服务——一种微服务反模式，其中服务变得太细粒度了。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/8fca1566e57a5a26f1f0dec802632c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9KhxG6TcJuJi_BMF"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">图5:无服务器功能是小段代码，难道它们不被认为是纳米服务吗？</figcaption></figure><p id="3c83" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">单个功能可能太小，无法执行微服务的一些复杂任务。因此，大多数情况下，我们将使用一组协同工作的功能，还有API Gateway作为聚合器，这样我们就可以以正确的方式为我们的无服务器微服务建模。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/609939a20fb18dbec54ea1e0a7956cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wYpO3yMkIcsvBqrC"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><strong class="bd ln">图6:你可以聚合几个函数来完成更复杂的任务</strong></figcaption></figure><p id="7920" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，为了完成我们的架构，我们的函数将存储我们的数据，一部分存储在NoSQL中，一部分存储在SQL无服务器数据库中，并且还从文件存储中检索数据。它们都是无服务器资源。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/e5448c27e5d4a5c143851b7a64fa2d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*07mCZlqNHEeBoctM"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><strong class="bd ln">图7:无服务器功能可以从文件存储器中读取数据，并将数据记录在数据库、无服务器数据库或NoSQL数据库中</strong></figcaption></figure><p id="518e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们可以在云提供商(AWS)中实现我们的架构，该提供商提供我们实现这一目标所需的资源，如图8所示。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/28de674c0b4350c1d461d505eb3bcaa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*2LuJO7FyrKdf-l9FrFbq1A.jpeg"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><strong class="bd ln">图8:在AWS上实现无服务器的资源(Lambda，DynamoDB，API Gateway，Aurora，S3) </strong></figcaption></figure><ul class=""><li id="ee6b" class="lp lq it js b jt ju jx jy kb lr kf ls kj lt kn lu lv lw lx bi translated"><strong class="js iu"> Lambda函数</strong>执行计算任务，一些充当聚合器，另一些执行特定的任务。</li><li id="519e" class="lp lq it js b jt ly jx lz kb ma kf mb kj mc kn lu lv lw lx bi translated"><strong class="js iu"> S3 </strong>用作对象存储，在这里我们可以保存图片或接收待处理的文本数据，如导入数据库的CSV文件。</li><li id="3e43" class="lp lq it js b jt ly jx lz kb ma kf mb kj mc kn lu lv lw lx bi translated">我们有<strong class="js iu"> AWS Aurora无服务器</strong>，这是一个高度可扩展的关系数据库，您只需为您执行的请求付费。它最适合与高度可伸缩的Lambda函数一起工作。</li><li id="4762" class="lp lq it js b jt ly jx lz kb ma kf mb kj mc kn lu lv lw lx bi translated">我们还有<strong class="js iu"> DynamoDB </strong>，这是一个高可伸缩的无服务器NoSQL数据库，我们可以访问延迟低至两位数毫秒的数据。</li></ul><p id="3b17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如您所见，将您的微服务部署为无服务器资源是可行的。正如您可能已经知道的，与任何其他技术一样，无服务器不会适合所有情况，也不是解决所有问题的最佳方案。但它在将项目投入生产所需的时间上提供了难以置信的优势，它降低了基础架构的成本，消除了对可伸缩性和可用性的担忧。另一方面，它是高度分布式的模型，因此除了一些关于超时、内存、存储等的限制之外，您还有与分布式系统相关的所有问题。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><p id="97f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果这篇文章有帮助，请点击拍手👏按钮几下，以示你对作者的支持</p></div></div>    
</body>
</html>