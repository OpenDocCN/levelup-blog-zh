<html>
<head>
<title>Setting up Postgres with Ruby on Rails on Ubuntu 20.04</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu 20.04上用Ruby on Rails设置Postgres</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setting-up-postgres-with-ruby-on-rails-7-on-ubuntu-20-04-45ffd75e863d?source=collection_archive---------3-----------------------#2022-01-20">https://levelup.gitconnected.com/setting-up-postgres-with-ruby-on-rails-7-on-ubuntu-20-04-45ffd75e863d?source=collection_archive---------3-----------------------#2022-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0c9e61a6c9dc81bbea12131b0a5b783e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1hGBpaF3PE1uKHJGAA0A3g.png"/></div></div></figure><p id="6518" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Postgres是在Ruby on Rails开发人员中广泛使用的最强大的数据库之一。使用这个数据库有很多好处，例如，更容易部署到Heroku。</p><p id="7649" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本教程中，我将向您展示如何安装Postgres、创建角色以及将数据库与Ruby on Rails应用程序链接起来。</p><p id="33c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们开始吧！</p><h1 id="ff90" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">第一步。安装Postgres</h1><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="5a54" class="md kx iq lz b gy me mf l mg mh">sudo apt-get update<br/>sudo apt install postgresql postgresql-contrib libpq-dev</span></pre><p id="f42a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk lz b">postgresql</code>是一个通用数据库包。</p><p id="30e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk lz b">postgresql-contrib</code>包含额外的实用程序和功能。</p><p id="b154" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk lz b">libpq-dev</code>用于编译C程序与Postgres通信。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="05b2" class="kw kx iq bd ky kz ms lb lc ld mt lf lg lh mu lj lk ll mv ln lo lp mw lr ls lt bi translated">第二步。创建用户</h1><p id="126c" class="pw-post-body-paragraph jy jz iq ka b kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr nb kt ku kv ij bi translated">安装过程创建了一个名为<strong class="ka ir"> postgres </strong>的用户帐户，该帐户与默认postgres角色相关联。</p><p id="659c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们切换到<strong class="ka ir"> postgres </strong>账户，进入<strong class="ka ir">psql</strong>——基于终端的postgres前端程序。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="da86" class="md kx iq lz b gy me mf l mg mh">sudo -i -u postgres<br/>psql</span></pre><p id="8867" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在有了<code class="fe mi mj mk lz b">postgres=#</code>环境。要创建新角色，请输入以下命令。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="897d" class="md kx iq lz b gy me mf l mg mh">CREATE ROLE &lt;your_username&gt; LOGIN SUPERUSER PASSWORD '&lt;your_password&gt;';</span><span id="034e" class="md kx iq lz b gy nc mf l mg mh"># CREATE ROLE</span></pre><p id="e3ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">超级用户绕过所有权限检查。</p><p id="aaff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">列出所有用户。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="fd8d" class="md kx iq lz b gy me mf l mg mh">\du</span></pre><p id="28ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用下面的命令退出<strong class="ka ir"> psql </strong>和<strong class="ka ir"> postgres </strong>环境。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="3f95" class="md kx iq lz b gy me mf l mg mh">exit</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="600e" class="kw kx iq bd ky kz ms lb lc ld mt lf lg lh mu lj lk ll mv ln lo lp mw lr ls lt bi translated">第三步。C <strong class="ak">加工</strong> a <strong class="ak">轨道App </strong></h1><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="a7e1" class="md kx iq lz b gy me mf l mg mh">rails new app -d postgresql<br/>cd app<br/>bundle</span></pre><p id="12b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了存储秘密，我将使用凭证。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="db92" class="md kx iq lz b gy me mf l mg mh">EDITOR=nano rails credentials:edit</span></pre><p id="903a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">添加数据库用户名和密码。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="8803" class="md kx iq lz b gy me mf l mg mh">database:<br/>  username: &lt;your_username&gt;<br/>  password: &lt;your_password&gt;</span></pre><p id="4488" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk lz b">Ctrl + X</code><strong class="ka ir"/><code class="fe mi mj mk lz b">Y</code>和<code class="fe mi mj mk lz b">Enter</code>。</p><p id="cd71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更新<code class="fe mi mj mk lz b">database.yml</code></p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="875b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建和迁移数据库</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="a511" class="md kx iq lz b gy me mf l mg mh">rails db:create db:migrate</span></pre><p id="ad1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并启动服务器。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="1418" class="md kx iq lz b gy me mf l mg mh">rails s</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="451c" class="kw kx iq bd ky kz ms lb lc ld mt lf lg lh mu lj lk ll mv ln lo lp mw lr ls lt bi translated">好处:从SQLite转换到Postgres</h1><p id="7000" class="pw-post-body-paragraph jy jz iq ka b kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr nb kt ku kv ij bi translated">有时，您需要从一个数据库切换到另一个数据库。为此，请遵循以下简单步骤。</p><h2 id="92c5" class="md kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated">更新Gemfile</h2><p id="553c" class="pw-post-body-paragraph jy jz iq ka b kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr nb kt ku kv ij bi translated">从Gemfile中删除SQLite gem。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="b81c" class="md kx iq lz b gy me mf l mg mh">gem 'sqlite3'</span></pre><p id="a60c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并添加Postgres宝石。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="fc01" class="md kx iq lz b gy me mf l mg mh">gem 'pg'</span></pre><p id="4af1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行捆绑包。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="5fa2" class="md kx iq lz b gy me mf l mg mh">bundle</span></pre><p id="d691" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">按照上述说明设置凭证并更换<code class="fe mi mj mk lz b">database.yml</code>。</p><p id="86d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您有迁移文件，请用<code class="fe mi mj mk lz b">t.string</code>到<code class="fe mi mj mk lz b">t.text</code>替换列。</p><p id="4d47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后一步是创建一个新的数据库。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="aba4" class="md kx iq lz b gy me mf l mg mh">rails db:setup db:migrate</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="2b52" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">万岁！🎉希望本教程能帮助你用Rails设置Postgres。祝你好运。</p></div></div>    
</body>
</html>