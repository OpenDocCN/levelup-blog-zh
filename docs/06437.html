<html>
<head>
<title>Istio: Setting Up a Local Sandbox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Istio:设置本地沙箱</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/istio-setting-up-a-local-sandbox-5ee84175de0f?source=collection_archive---------11-----------------------#2020-11-24">https://levelup.gitconnected.com/istio-setting-up-a-local-sandbox-5ee84175de0f?source=collection_archive---------11-----------------------#2020-11-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/0fedba779984b763f0cfb2cd3c5dbc66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*zPd8ndlTTPoIl58P0chOUQ.jpeg"/></div></figure><p id="0913" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">为了在Kubernetes中学习和测试新事物，我喜欢在本地集群中进行。能够在你的笔记本电脑上旋转是一个简单的胜利。这篇文章不会讨论“为什么Istio ”,只讨论“如何”。之前我写了一篇关于用Docker桌面和Helm 获得一个<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/go-helm-kubernetes-docker-desktop-bf59f4eb9e9d">本地Kubernetes集群的文章。沿着这条路走下去，我加入了</a><a class="ae kv" href="https://istio.io/" rel="noopener ugc nofollow" target="_blank"> Istio </a>。这项工作是在同一个<a class="ae kv" href="https://github.com/nwillc/webgo/tree/feature/istio" rel="noopener ugc nofollow" target="_blank">库</a>的一个分支中完成的。</p><h2 id="23de" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">入门指南</h2><p id="0654" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">您可能想要抓住<a class="ae kv" href="https://github.com/nwillc/webgo/tree/feature/istio" rel="noopener ugc nofollow" target="_blank">库</a>来跟随。</p><p id="6a94" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">你将只需要<strong class="jz iu">两个</strong>东西来完成这一切，<a class="ae kv" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> Docker Desktop </a>和<a class="ae kv" href="https://github.com/asdf-vm/asdf" rel="noopener ugc nofollow" target="_blank"> asdf </a>。我们将使用Docker Desktop进行集装箱化和Kubernetes集群:</p><figure class="lv lw lx ly gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lu"><img src="../Images/27093572289bd2cbc3e99e805825c99a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yFK66iP5cxoKd1ARWQ4n6A.png"/></div></div></figure><p id="c253" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这一切都适用于Kubernetes的Minikube，但不需要额外安装。</p><h2 id="3226" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">为了得到剩下的…</h2><p id="1e8f" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">安装<a class="ae kv" href="https://github.com/asdf-vm/asdf" rel="noopener ugc nofollow" target="_blank"> asdf </a>。这是一个很好的工具。一旦你准备好了，运行我包括的<code class="fe md me mf mg b">bin/asdf-sync.sh</code>。那会给你我们需要的一切。</p><h2 id="0c45" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">获取Istio</h2><p id="7756" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">Istio是那些为<em class="mh">也为</em>提供了许多受支持的安装方式的工具之一，并且固执己见的正确方式似乎在不断变化。在这里，我们将看到Istio 1.8.0，他们又回到了提倡头盔，这是我更喜欢的，至少对于基础安装来说，插件，其中一些几乎是必需的，但可悲的是没有在头盔中。无论如何，让我们看看我的安装脚本的内容:</p><pre class="lv lw lx ly gt mi mg mj mk aw ml bi"><span id="8851" class="kw kx it mg b gy mm mn l mo mp"><em class="mh"># Get the distribution<br/>mkdir </em>istio<br/><em class="mh">cd </em>istio<br/><em class="mh">curl </em>-L https://istio.io/downloadIstio | <em class="mh">sh </em>-<br/><em class="mh">cd </em>istio-1.8.0</span><span id="2aed" class="kw kx it mg b gy mq mn l mo mp"># Create a namespace for Istio<br/><em class="mh">kubectl </em>create namespace istio-system</span><span id="7973" class="kw kx it mg b gy mq mn l mo mp"># Use Helm to install Istio<br/><em class="mh">helm </em>install --namespace istio-system istio-base \<br/>  manifests/charts/base \<br/>  --set global.jwtPolicy=first-party-jwt </span><span id="a0db" class="kw kx it mg b gy mq mn l mo mp"><em class="mh">helm </em>install --namespace istio-system istiod \<br/>  manifests/charts/istio-control/istio-discovery \<br/>  --set global.hub="docker.io/istio" \<br/>  --set global.tag="1.8.0" \<br/>  --set global.jwtPolicy=first-party-jwt</span><span id="19e8" class="kw kx it mg b gy mq mn l mo mp"># Now get the key addons<br/><em class="mh">kubectl </em>apply -f samples/addons/prometheus.yaml<br/><em class="mh">kubectl </em>apply -f samples/addons/kiali.yaml<br/><em class="mh">kubectl </em>apply -f samples/addons/grafana.yaml</span><span id="e6fe" class="kw kx it mg b gy mq mn l mo mp"># And set up automatic sidecar injection<br/><em class="mh">kubectl </em>label namespace default istio-injection=enabled</span></pre><p id="4aa6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这比我想要的要多，但它非常简单，一旦完成，你就有了Istio，它的关键插件在你的集群中，并设置为在需要的地方自动注入它的边车。我已经将上述内容作为<code class="fe md me mf mg b">bin/install-istio.sh</code>脚本包含在我的存储库中。</p><h2 id="65d7" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">给我们看看你有什么</h2><p id="d50f" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">此时，您将拥有一个包含Istio的Kubernetes集群。那又怎样？我还包含了一个演示应用程序。如果您只是想获得笑点，而不是查看引擎盖下的内容，则部署已经在Docker Hub上构建的映像:</p><pre class="lv lw lx ly gt mi mg mj mk aw ml bi"><span id="cd5a" class="kw kx it mg b gy mm mn l mo mp">./bin/deploy.sh -r nwillc/webgo -v 1.0.27</span></pre><p id="54a4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">然后打开Istio的Kiali addon的仪表盘:</p><pre class="lv lw lx ly gt mi mg mj mk aw ml bi"><span id="7a69" class="kw kx it mg b gy mm mn l mo mp">istioctl dashboard kiali</span></pre><figure class="lv lw lx ly gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mr"><img src="../Images/76cf7bbf84b4b58f5286c422fcbcd2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5f9sbPBl_NJQWz-0HJYUOA.png"/></div></div></figure><p id="399b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">哇，那是可观察性！该应用程序，它的端点，流量分析，等等，你只需点击一下。不坏5分钟安装到笔记本电脑上。或者用K9s看这是你已经实现的:</p><figure class="lv lw lx ly gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ms"><img src="../Images/9c9733bf5fc4fb63d7c6b7b33b2d6103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uk-4egm_7Ns39Z7Y3y9slw.png"/></div></div></figure></div></div>    
</body>
</html>