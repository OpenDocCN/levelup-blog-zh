<html>
<head>
<title>Exploring AppleScript — Part 6</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索AppleScript —第6部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/exploring-applescript-part-6-83202543346d?source=collection_archive---------12-----------------------#2022-01-07">https://levelup.gitconnected.com/exploring-applescript-part-6-83202543346d?source=collection_archive---------12-----------------------#2022-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="71b7" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://gentille.us/applescript-articles-7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank"> AppleScript课程</a></h2><div class=""/><div class=""><h2 id="6ce7" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">我们将达到我们的最终目标，将我们的脚本保存到正确的位置，并赋予它所需的权限。这将让我们方便地从macOS菜单栏运行它。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c7fbba58b2d6f4e116d15ef0a86d4a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M3gywfhArPLgrGI_j_2Srg.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">让剧本通过球门柱</figcaption></figure><h1 id="b53e" class="le lf iq bd lg lh li lj lk ll lm ln lo kf lp kg lq ki lr kj ls kl lt km lu lv bi translated">前情提要…</h1><p id="18ec" class="pw-post-body-paragraph lw lx iq ly b lz ma ka mb mc md kd me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated"><a class="ae ms" href="https://gentille.us/applescript-articles-7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank">前几期</a>探索了AppleScript中的各种工具和技术，并多次引用了<a class="ae ms" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html" rel="noopener ugc nofollow" target="_blank">源文档</a>。我们已经写了一个完整而有用的脚本。现在我们需要一种更方便的方式来运行它。这是我们结束时的脚本。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2931dae27767aa3928e363d72944d2d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/0*M1EmlnlhmdDykoOS.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">完整脚本</figcaption></figure><h1 id="a5a1" class="le lf iq bd lg lh li lj lk ll lm ln lo kf lp kg lq ki lr kj ls kl lt km lu lv bi translated">保存脚本</h1><p id="354c" class="pw-post-body-paragraph lw lx iq ly b lz ma ka mb mc md kd me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">我假设你已经保存了这个脚本，因为我们一直在开发它；因此，使用脚本编辑器的<code class="fe mu mv mw mx b">File→Save</code>菜单不会给我们任何选项。让我们用<code class="fe mu mv mw mx b">File→Export… menu</code>来代替。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi my"><img src="../Images/80677018b99d6f57d8f46d298d530cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZC3ILcEMcg21jBhLSGoLAA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">导出菜单</figcaption></figure><ol class=""><li id="0440" class="mz na iq ly b lz nb mc nc mf nd mj ne mn nf mr ng nh ni nj bi translated">把名字改成有意义的，在这个例子的后面你会看到我用了<code class="fe mu mv mw mx b">display-fixer-app</code>。</li><li id="2e95" class="mz na iq ly b lz nk mc nl mf nm mj nn mn no mr ng nh ni nj bi translated">选择文件格式。你可以在Mac自动化脚本指南中了解不同的<a class="ae ms" href="https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/TypesofScripts.html" rel="noopener ugc nofollow" target="_blank">脚本类型。我们没有任何资源，因此我们不需要一个脚本包。我正在用下拉菜单中的<code class="fe mu mv mw mx b">Application</code>项创建一个脚本小程序。</a></li><li id="7452" class="mz na iq ly b lz nk mc nl mf nm mj nn mn no mr ng nh ni nj bi translated">如果你不想保存你的源脚本，你可以启用<code class="fe mu mv mw mx b">Run-only</code>复选框来只保存你的脚本的编译版本。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi my"><img src="../Images/f9dfd43f940fc022472311fb5b4d6a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRFHBTBG6F_2V2lMeD_zsg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">应用程序文件格式</figcaption></figure><h1 id="82b3" class="le lf iq bd lg lh li lj lk ll lm ln lo kf lp kg lq ki lr kj ls kl lt km lu lv bi translated">挑选地点</h1><p id="d3ca" class="pw-post-body-paragraph lw lx iq ly b lz ma ka mb mc md kd me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">您可以在任何地方保存一个脚本小程序，然后双击它来运行它。我喜欢让我的脚本出现在macOS菜单栏的脚本菜单栏项中。这需要将脚本保存到特定的位置。</p><p id="8e5f" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">如果您导航到<code class="fe mu mv mw mx b">Users</code>文件夹下的个人文件夹，它看起来应该如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi my"><img src="../Images/321e941115ecdc5d0b54e693873c221a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M4GRVEFjNO4Le8mfT2XwNg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">主目录的普通视图</figcaption></figure><p id="3c7b" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">如果您现在按住Command，并按住Shift键和句点键(⌘-⇧-.)在你的键盘上，会出现隐藏的文件和文件夹。我们这样做是为了获得对<code class="fe mu mv mw mx b">Library</code>文件夹的访问权。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi my"><img src="../Images/24e6d65239dbd3b1c7c8e76fb1964f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0EwGz29hmQCWT03Mg2AFA.png"/></div></div></figure><p id="a767" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">如果您有许多隐藏的文件和文件夹，您可能需要向下滚动来查看<code class="fe mu mv mw mx b">Library</code>文件夹。选择<code class="fe mu mv mw mx b">Library</code>文件夹，然后选择<code class="fe mu mv mw mx b">Scripts</code>文件夹，如图所示</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/1121eeec98e52632b14922f8242a01cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5jbEhXGJTp2eUoLrcRVwuQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">导航到用户的“资源库/脚本”文件夹</figcaption></figure><p id="b38d" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">为您的小程序命名，然后单击保存。</p><h1 id="af71" class="le lf iq bd lg lh li lj lk ll lm ln lo kf lp kg lq ki lr kj ls kl lt km lu lv bi translated">脚本菜单栏</h1><p id="0a9d" class="pw-post-body-paragraph lw lx iq ly b lz ma ka mb mc md kd me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">使用<code class="fe mu mv mw mx b">Script Editor→Preferences</code>菜单项并选择<code class="fe mu mv mw mx b">General</code>选项卡。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/01bab49095fedea8aef153509ef28943.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*MM6INpilgVNoO9KdoFoqrg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">一般偏好</figcaption></figure><p id="faac" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">启用<code class="fe mu mv mw mx b">Show Script menu in menu bar</code>复选框。完成后，您将在macOS菜单栏中看到一个脚本菜单栏项目。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/2f746e6b6aef97abccb0f7520650e202.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*Im7gReE5lYOTRUaYeuYxqQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">菜单栏中的脚本菜单</figcaption></figure><h1 id="d322" class="le lf iq bd lg lh li lj lk ll lm ln lo kf lp kg lq ki lr kj ls kl lt km lu lv bi translated">许可之舞</h1><p id="24ed" class="pw-post-body-paragraph lw lx iq ly b lz ma ka mb mc md kd me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">当您单击script菜单项时，您应该会在下拉列表中看到您的新脚本。继续点击它，但是不要期望它运行(还没有)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3611ad33aaf79c31cc4fd273b34dd142.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*j1q5S8oc96zrE2r5qbf9xg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">脚本菜单已展开</figcaption></figure><p id="9118" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">在其中一台显示器上，您会看到以下对话框:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/68220fb71f26c64bdeedc14aebc21078.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*lc4fiUEdTnW3QFVI0e_Bgw.png"/></div></figure><p id="c79a" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">单击OK，脚本将进入第一步，并可能显示另外两个对话框:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/5ad146ced813e2c2e5f4626b98723012.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*YdQUrRQp18HbFvQmChFcCw.png"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/4fe9d83b9b5dca868adab3dc59bea57a.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*NcFX6QaAsTJxrj0dbWLbzQ.png"/></div></figure><p id="b606" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">您可以点击确定关闭第二个对话框，然后点击<code class="fe mu mv mw mx b">Open System Preferences</code>按钮。如果由于某种原因<code class="fe mu mv mw mx b">Accessibility Access</code>对话框没有出现，但是你的脚本没有运行，不要惊慌。打开<code class="fe mu mv mw mx b">System Preferences</code>对话框，手动选择<code class="fe mu mv mw mx b">Security and Privacy</code>窗格。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/51669ec4e4757feb535a4e3ea6723c55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*jL_Np9gXl7chDYYVEfsWyg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">手动选择“安全性与隐私”面板</figcaption></figure><p id="5d27" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">点按锁图标并输入您的密码</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/5dc9bd16af4b1d00aa3c1d4b7578cb44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*3JWeui0LoPw3CKsz_Kh8Kg.png"/></div></figure><p id="4942" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">向下滚动找到脚本并启用复选框。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ada1e5395146c3067ab4452c80cffc25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*WZNXEbmGk1YHZdaCEUJ6oA.png"/></div></figure><h1 id="c836" class="le lf iq bd lg lh li lj lk ll lm ln lo kf lp kg lq ki lr kj ls kl lt km lu lv bi translated">最后一支舞</h1><p id="a445" class="pw-post-body-paragraph lw lx iq ly b lz ma ka mb mc md kd me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">此时，您的脚本已经放弃了您，是时候尝试再次运行它了。它不会立即生效，相反，您会看到以下对话框:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/cd3de69ed4ffd75117fbab96b92e699b.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*E9SUJv63UurlWYqWuVrSow.png"/></div></figure><p id="4de7" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">点击<code class="fe mu mv mw mx b">OK</code>，您的脚本应该会运行。</p><h1 id="06b6" class="le lf iq bd lg lh li lj lk ll lm ln lo kf lp kg lq ki lr kj ls kl lt km lu lv bi translated">恭喜你！</h1><p id="fed5" class="pw-post-body-paragraph lw lx iq ly b lz ma ka mb mc md kd me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">您已经创建并部署了您的第一个脚本。只要你不做需要重新保存你的脚本的修改，它将总是在脚本菜单中一键点击。</p><p id="01eb" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">感谢您阅读本系列，我希望您喜欢了解AppleScript。我知道写这些文章让我学到了很多。玩得开心。</p><p id="5855" class="pw-post-body-paragraph lw lx iq ly b lz nb ka mb mc nc kd me mf np mh mi mj nq ml mm mn nr mp mq mr ij bi translated">平静地编码。</p></div></div>    
</body>
</html>