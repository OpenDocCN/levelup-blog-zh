<html>
<head>
<title>Delete files and directories using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python删除文件和目录</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/delete-files-and-directories-using-python-5f1741710a5b?source=collection_archive---------23-----------------------#2022-07-18">https://levelup.gitconnected.com/delete-files-and-directories-using-python-5f1741710a5b?source=collection_archive---------23-----------------------#2022-07-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bd69" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">迷你项目| Python 101系列</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9c182b00191733aab2117f47095db38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MEWGk-bbfkzawpUAF8Yhrg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用Python删除文件和目录</figcaption></figure><p id="31b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，我们已经学习了很多Python的基本概念。我们了解了:</p><ol class=""><li id="2c0b" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">数据类型和变量</li><li id="3a0a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">字符串操作方法</li><li id="c7a5" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">列表和字典操作方法</li><li id="97f0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">条件语句</li><li id="197d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">环</li><li id="8c98" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">文件处理</li></ol><p id="ded1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是现在呢？仅仅通过阅读博客或观看YouTube教程，我们无法擅长某件事。我们必须不断练习，直到我们擅长为止。所以，在这篇博客中，我会试着展示我们到目前为止学到的大部分概念。</p><blockquote class="mi"><p id="eac8" class="mj mk it bd ml mm mn mo mp mq mr lt dk translated"><em class="ms">“对于我们在做之前必须学习的东西，我们通过做来学习。”<br/> </em> ― <strong class="ak">亚里斯多德</strong></p></blockquote><p id="cbe8" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">那么，我们要做什么？</p><h1 id="a150" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">规划</h1><p id="d919" class="pw-post-body-paragraph ky kz it la b lb nq ju ld le nr jx lg lh ns lj lk ll nt ln lo lp nu lr ls lt im bi translated">在这篇博客中，我将向你展示</p><ol class=""><li id="6d33" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">我们如何使用<strong class="la iu"> os </strong>模块列出特定位置的所有文件和目录</li><li id="8b0a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">分离文件和目录，并使用<strong class="la iu"> isfile() </strong>方法将它们添加到各自的列表中</li><li id="cf46" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用<strong class="la iu"> for </strong>循环遍历这些文件和目录列表</li><li id="6b20" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用<strong class="la iu">操作系统</strong>模块删除文件</li><li id="8526" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用<strong class="la iu"> shutil </strong>模块删除目录</li></ol><p id="81ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除此之外，我们还会看到一些Python中的错误处理。即使我们测试我们的代码，在现实环境中，意外的错误最终会出现。为了解决这些情况，我们使用错误处理。错误处理是一个通用的编程概念，它不是Python独有的概念。</p><h1 id="92a5" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">编码</h1><p id="e93c" class="pw-post-body-paragraph ky kz it la b lb nq ju ld le nr jx lg lh ns lj lk ll nt ln lo lp nu lr ls lt im bi translated">在我们进入代码之前，我想提一下，如果你不理解任何一行或有任何疑问，你可以随时在<a class="ae nv" href="https://twitter.com/Sahil_Fruitwala" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae nv" href="https://www.linkedin.com/in/sahilfruitwala" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。我会分块解释代码，也会在博客的最后添加完整的代码文件。我们将继续:</p><h1 id="bc2f" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">1.导入必要的模块</h1><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="5d97" class="ob mz it nx b gy oc od l oe of">import os<br/>import shutil</span></pre><h1 id="f644" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">2.获取特定位置的所有文件和目录的列表</h1><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="eb46" class="ob mz it nx b gy oc od l oe of"># location of temp files in windows<br/>location = 'C:\\Windows\\Temp' <br/>file_dir = os.listdir(location)</span></pre><p id="6f43" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="og">注意:Mac人，你可以使用任何你希望程序不会停止工作的临时文件夹或目录。我是windows用户，所以不知道mac设备上的临时文件存储在哪里。</em></p><h1 id="9dde" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">3.文件和目录的分离</h1><p id="6698" class="pw-post-body-paragraph ky kz it la b lb nq ju ld le nr jx lg lh ns lj lk ll nt ln lo lp nu lr ls lt im bi translated">listdir()方法返回文件和目录。所以，我们需要将文件和目录从file_dir中分离出来。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="20ee" class="ob mz it nx b gy oc od l oe of">only_files = []<br/>only_dir = []<br/>for i in file_dir:<br/>       # generate full path<br/>       full_path = os.path.join(location, I)</span><span id="94a7" class="ob mz it nx b gy oh od l oe of">       # checks if the given path is of file or not<br/>       if os.path.isfile(full_path):<br/>           only_files.append(full_path)</span><span id="db4e" class="ob mz it nx b gy oh od l oe of">       # checks if the given path is of directory or not<br/>       if os.path.isdir(full_path):<br/>           only_dir.append(os.path.join(full_path)</span></pre><h1 id="7118" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">4.删除文件</h1><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="c373" class="ob mz it nx b gy oc od l oe of"># loop through the list that contains only files<br/>for i in only_files:<br/>    try:<br/>        # os.chmod(i, 0o777)<br/>        os.remove(i) # removes the files<br/>    except Exception as e:<br/>        print(e)</span></pre><p id="faef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，我们保留了整个删除逻辑(一行😂)进入<code class="fe oi oj ok nx b">try and except</code>块。我们为什么要这样做？文件可能已被移动，或者我们没有访问该文件的权限。这种情况会引发错误/异常，我们的代码将停止工作。有许多方法可以处理异常。但是，我选择了简单易行的方法，只需打印错误消息。别担心，我们将在下一篇博客中学习异常处理。</p><h1 id="f2c3" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">5.删除目录</h1><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="830c" class="ob mz it nx b gy oc od l oe of"># loop through the list that contains only directories <br/>for i in only_dir:<br/>    try:<br/>        # os.chmod(i, 0o777)<br/>        shutil.rmtree(i, ignore_errors = False) # removes the the directory and all the sub-files and sub-directory that it might have<br/>    except Exception as e:<br/>        print(e)</span></pre><p id="21ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe oi oj ok nx b">shutil.rmtree()</code>方法将接受输入，并尝试删除目录及其所有子文件和目录。这里，我们希望在方法无法删除某些文件/目录时引发异常。因此，我们传递了值为false的<strong class="la iu"> ignore_errors </strong>参数。</p><p id="67fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:在Windows中，有时你会面临权限问题。为了避免这些问题，请打开您的编辑器或控制台，以管理员身份运行这些代码。对于mac，取消对<code class="fe oi oj ok nx b"><strong class="la iu">os.chmod(i, 0o777)</strong></code>部分的注释。它应该工作，但不确定，因为我没有在mac系统中尝试过。</p><p id="a6a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个演示只是为了更好地理解我们到目前为止所学的概念。我们可以通过在将文件/目录分成两个列表的同时删除它们来优化代码。但是这也是为了让你理解如何使用python。</p><h1 id="e3e3" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">6.将整个逻辑转换成一个函数</h1><p id="4c8a" class="pw-post-body-paragraph ky kz it la b lb nq ju ld le nr jx lg lh ns lj lk ll nt ln lo lp nu lr ls lt im bi translated">可重用性在编程领域非常重要。对这个程序来说这不是必须的，只是为了向你展示我们将把整个逻辑转换成一个函数。我们只调用这个函数。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="aefa" class="ob mz it nx b gy oc od l oe of">def delete_temp_file(locations):<br/>    for location in locations:        <br/>        try:<br/>            # get list of all files and directories<br/>            file_dir = os.listdir(location) </span><span id="c9a3" class="ob mz it nx b gy oh od l oe of">            only_files = []<br/>            only_dir = []</span><span id="0c34" class="ob mz it nx b gy oh od l oe of">            for i in file_dir:<br/>                # checks if the given path is of file or not<br/>                # print(location+'\\'+i)<br/>                # print(os.path.join(location, i))<br/>                full_path = os.path.join(location, i)<br/>                if os.path.isfile(full_path):<br/>                    only_files.append(full_path)</span><span id="ebb8" class="ob mz it nx b gy oh od l oe of">                # checks if the given path is of directory or not<br/>                if os.path.isdir(full_path):<br/>                    only_dir.append(full_path)<br/>        except Exception as e:<br/>            print(e)</span><span id="2a93" class="ob mz it nx b gy oh od l oe of">        # loop through the list that contains only files <br/>        for i in only_files:<br/>            try:<br/>                # os.chmod(i, 0o777)<br/>                os.remove(i) # removes the files<br/>            except Exception as e:<br/>                print(getattr(e, 'message', repr(e)))</span><span id="9f26" class="ob mz it nx b gy oh od l oe of">        # loop through the list that contains only directories <br/>        for i in only_dir:<br/>            try:<br/>                # os.chmod(i, 0o777)<br/>                # removes the the directory and all the sub-files and sub-directory it has<br/>                shutil.rmtree(i, ignore_errors = False)<br/>            except Exception as e:<br/>                print(e)</span></pre><p id="d7b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，执行时间！😎</p><h1 id="e585" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">最终接触和执行</h1><p id="4787" class="pw-post-body-paragraph ky kz it la b lb nq ju ld le nr jx lg lh ns lj lk ll nt ln lo lp nu lr ls lt im bi translated">这是重复的，但我已经添加了完整的代码，以便您可以在一个流程中看到它。在你运行它之前，根据你的需要编辑位置列表。然后转到保存代码库的位置，运行<code class="fe oi oj ok nx b">python file_name.py</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><p id="4e46" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">终于！我们已经到了这一节的末尾😁。</p><p id="507d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就这样。感谢您的阅读。</p><p id="c6c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你需要任何帮助或者想讨论什么，请告诉我。在Twitter或LinkedIn上联系我。请务必在下面的评论中留下你的想法、问题或担忧。我很想看看他们。</p><blockquote class="mi"><p id="03fa" class="mj mk it bd ml mm mn mo mp mq mr lt dk translated">想了解更多？</p><p id="a5a6" class="mj mk it bd ml mm mn mo mp mq mr lt dk translated">注册我的<a class="ae nv" href="https://bit.ly/3Menk8Q" rel="noopener ugc nofollow" target="_blank">时事通讯</a>，把最好的文章放进你的收件箱。</p></blockquote><p id="357b" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">直到下一次👋</p><blockquote class="mi"><p id="fbdc" class="mj mk it bd ml mm mn mo mp mq mr lt dk translated">探索我的Python 101系列的其他博客</p></blockquote><div class="ou ov ow ox oy oz"><a href="https://betterprogramming.pub/organize-files-and-folders-using-python-660246ef9310" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">如何使用Python组织文件和文件夹</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">3件主要的事情将帮助我们决定如何组织我们的文件</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">better编程. pub</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ks oz"/></div></div></a></div><div class="po pp gp gr pq oz"><a rel="noopener  ugc nofollow" target="_blank" href="/file-handling-in-python-6ffc23cc92c"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">Python中的文件处理</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">所以，只是为了刷新我们的记忆，到目前为止，我们已经看到了python的所有基础知识，包括变量、数据类型、函数…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pi l"><div class="pr l pk pl pm pi pn ks oz"/></div></div></a></div><div class="po pp gp gr pq oz"><a rel="noopener  ugc nofollow" target="_blank" href="/modules-and-packages-in-python-63df7d952bb8"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">Python中的模块和包</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">了解模块和包的基础知识以及如何在python中使用它们</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pi l"><div class="ps l pk pl pm pi pn ks oz"/></div></div></a></div></div></div>    
</body>
</html>