<html>
<head>
<title>How To Deal With Custom .env Files in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何应对海关？React中的环境文件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-deal-with-custom-env-files-in-react-148afda1ffb?source=collection_archive---------5-----------------------#2022-09-15">https://levelup.gitconnected.com/how-to-deal-with-custom-env-files-in-react-148afda1ffb?source=collection_archive---------5-----------------------#2022-09-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="98b2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">向Create-React-App应用程序添加定制的<code class="fe ki kj kk kl b">.env.staging</code>文件</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/d8aa46d4ea820d17d83de09f6ad0aa40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I-pCGf16jQTyYMeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">照片由<a class="ae lc" href="https://unsplash.com/@lautaroandreani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">劳塔罗·安德烈亚尼</a>在<a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="5674" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在开发React应用程序时，一个常见的场景是拥有三个<a class="ae lc" href="https://en.wikipedia.org/wiki/Deployment_environment" rel="noopener ugc nofollow" target="_blank">部署环境</a>:</p><ul class=""><li id="8b7c" class="lz ma it lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated">本地:用于本地发展。</li><li id="0f3c" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><a class="ae lc" href="https://en.wikipedia.org/wiki/Deployment_environment#Staging" rel="noopener ugc nofollow" target="_blank"> Staging </a>:生产环境的在线镜像。</li><li id="3c77" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><a class="ae lc" href="https://en.wikipedia.org/wiki/Deployment_environment#Production" rel="noopener ugc nofollow" target="_blank">生产</a>:为最终用户服务的实时应用程序。</li></ul><p id="5cba" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您的架构还可能有其他部署环境，比如测试、开发或生产前环境。</p><p id="6b17" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这意味着您的应用程序可能需要至少三个不同的<code class="fe ki kj kk kl b">.env</code>文件。然而，<a class="ae lc" href="https://create-react-app.dev/docs/getting-started" rel="noopener ugc nofollow" target="_blank"> Create-React-App </a>应用程序只支持一组有限的预定义的<code class="fe ki kj kk kl b">.env</code>文件。</p><p id="384b" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在让我们学习如何为您的React应用程序设置多个定制的<code class="fe ki kj kk kl b">.env</code>文件。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="cfd2" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">设置多个自定义。创建-反应-应用程序中的env文件</h1><p id="4021" class="pw-post-body-paragraph ld le it lf b lg nm ju li lj nn jx ll lm no lo lp lq np ls lt lu nq lw lx ly im bi translated">创建-反应-应用程序使用<code class="fe ki kj kk kl b"><a class="ae lc" href="https://www.npmjs.com/package/react-scripts" rel="noopener ugc nofollow" target="_blank">react-scripts</a></code>。如果你不熟悉<code class="fe ki kj kk kl b">.evn</code>文件如何在<code class="fe ki kj kk kl b"><a class="ae lc" href="https://www.npmjs.com/package/react-scripts" rel="noopener ugc nofollow" target="_blank">react-scripts</a></code>中工作，看看<a class="ae lc" href="https://create-react-app.dev/docs/adding-custom-environment-variables/#what-other-env-files-can-be-used" rel="noopener ugc nofollow" target="_blank">“什么其他的。env文件都可以用？”</a>创建React应用程序文档的一节。在那里，您可以了解到<code class="fe ki kj kk kl b">.env</code>文件<code class="fe ki kj kk kl b">react-scripts</code>支持什么以及如何使用它们。</p><p id="456e" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在，让我们学习如何在React应用程序中设置一个定制的<code class="fe ki kj kk kl b">.env.staging</code>文件。注意，下面的方法可以很容易地扩展到任何其他定制的<code class="fe ki kj kk kl b">.env</code>文件。此外，这个解决方案允许你有多个自定义的<code class="fe ki kj kk kl b">.env</code>文件。</p><h2 id="7f48" class="nr mv it bd mw ns nt dn na nu nv dp ne lm nw nx ng lq ny nz ni lu oa ob nk oc bi translated">1.入门指南</h2><p id="4900" class="pw-post-body-paragraph ld le it lf b lg nm ju li lj nn jx ll lm no lo lp lq np ls lt lu nq lw lx ly im bi translated">Create-React-App应用程序用<code class="fe ki kj kk kl b">package.json</code>文件中的以下<code class="fe ki kj kk kl b">scripts</code>部分初始化:</p><pre class="kn ko kp kq gt od kl oe of aw og bi"><span id="9a07" class="nr mv it kl b gy oh oi l oj ok">"scripts": {<br/>  "start": "react-scripts start",<br/>  "build": "react-scripts build",<br/>  "test": "react-scripts test",<br/>  "eject": "react-scripts eject"<br/>}</span></pre><p id="c4d2" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe ki kj kk kl b">react-scripts</code>仅支持一组特定的<code class="fe ki kj kk kl b">.env</code>文件。这些<code class="fe ki kj kk kl b">.env</code>文件是在构建时部署应用程序时使用的。</p><p id="78f6" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因此，如果您希望您的带有定制<code class="fe ki kj kk kl b">.env</code>文件的Create-React-App应用程序正确构建，您需要定制<code class="fe ki kj kk kl b">build</code>命令。具体来说，您需要用一个定制的构建脚本来替换它。这样，当涉及到<code class="fe ki kj kk kl b">.env</code>文件时，您可以克服<code class="fe ki kj kk kl b">react-scripts</code>的限制。</p><h2 id="c4cc" class="nr mv it bd mw ns nt dn na nu nv dp ne lm nw nx ng lq ny nz ni lu oa ob nk oc bi translated">2.创建自定义构建脚本</h2><p id="7123" class="pw-post-body-paragraph ld le it lf b lg nm ju li lj nn jx ll lm no lo lp lq np ls lt lu nq lw lx ly im bi translated">首先，在项目的根目录下创建一个<code class="fe ki kj kk kl b">build.sh</code>文件。按如下方式初始化它:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="a884" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这里，当<code class="fe ki kj kk kl b">ENV</code>环境变量等于“staging”时，删除<code class="fe ki kj kk kl b">.env.local</code>并用<code class="fe ki kj kk kl b">.env.staging</code>代替<code class="fe ki kj kk kl b">.env.production</code>。这样，<code class="fe ki kj kk kl b">react-scripts build</code>会将自定义的<code class="fe ki kj kk kl b">.env.staging</code>文件视为<code class="fe ki kj kk kl b">.env.production</code>，并在构建应用程序时使用它。</p><p id="890e" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">注意，您可以简单地通过重复<code class="fe ki kj kk kl b">if ... fi</code>逻辑并改变测试条件，将这种方法扩展到几个环境变量。</p><p id="ba92" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在，你必须更新<code class="fe ki kj kk kl b">package.json</code>，让它调用<code class="fe ki kj kk kl b">build</code>上的自定义<code class="fe ki kj kk kl b">build.sh</code>脚本。您可以通过以下方式实现这一点:</p><pre class="kn ko kp kq gt od kl oe of aw og bi"><span id="2903" class="nr mv it kl b gy oh oi l oj ok">"scripts": {<br/>  // ...<br/>  "build": "bash build.sh",<br/>  // ...<br/>}</span></pre><p id="5ae9" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">当您运行<code class="fe ki kj kk kl b">npm run build</code>时，将会启动<code class="fe ki kj kk kl b">build.sh</code>文件。由于<code class="fe ki kj kk kl b">buld.sh</code>包含<code class="fe ki kj kk kl b">react-script build</code>命令，应用程序将像以前一样构建。但是具有在<code class="fe ki kj kk kl b">react-script</code>命令之前定义的<code class="fe ki kj kk kl b">.env</code>文件管理逻辑。</p><h2 id="63c5" class="nr mv it bd mw ns nt dn na nu nv dp ne lm nw nx ng lq ny nz ni lu oa ob nk oc bi translated">3.在部署服务器中设置ENV环境变量</h2><p id="47c1" class="pw-post-body-paragraph ld le it lf b lg nm ju li lj nn jx ll lm no lo lp lq np ls lt lu nq lw lx ly im bi translated">此时，您所要做的就是在您的临时部署服务器中设置<code class="fe ki kj kk kl b">ENV</code>环境变量。在Linux上，您可以使用以下命令来实现:</p><pre class="kn ko kp kq gt od kl oe of aw og bi"><span id="8393" class="nr mv it kl b gy oh oi l oj ok">export ENV=staging</span></pre><p id="d533" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">瞧啊！您刚刚学习了如何在Create-React-App React应用程序中使用定制的<code class="fe ki kj kk kl b">.env</code>文件。请注意，您还可以在Next.js 中<a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/how-to-deal-with-custom-env-files-in-next-js-98d8c5b7899a">配置自定义</a> <code class="fe ki kj kk kl b"><a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/how-to-deal-with-custom-env-files-in-next-js-98d8c5b7899a">.env</a></code> <a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/how-to-deal-with-custom-env-files-in-next-js-98d8c5b7899a">文件。</a></p><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-deal-with-custom-env-files-in-next-js-98d8c5b7899a"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">如何应对海关？Next.js中的env文件</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">将自定义. env.staging文件添加到Create-Next-App应用程序中</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kw oq"/></div></div></a></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="9356" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">结论</h1><p id="13c6" class="pw-post-body-paragraph ld le it lf b lg nm ju li lj nn jx ll lm no lo lp lq np ls lt lu nq lw lx ly im bi translated">在本文中，您了解了如何配置React应用程序来支持多个定制的<code class="fe ki kj kk kl b">.env</code>文件。当涉及到<code class="fe ki kj kk kl b">.env</code>文件时，Create-React-App应用程序有一些限制。因此，如果您有更多的部署环境，而不是那些由<code class="fe ki kj kk kl b">react-scripts</code>所期望的，那么您需要实现定制逻辑来启用对定制<code class="fe ki kj kk kl b">.env</code>文件的支持。在这里，您学会了如何做到这一点。</p><p id="9826" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">感谢阅读！我希望这篇文章对你有所帮助。请随意留下任何问题、评论或建议。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="49dd" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">分级编码</h1><p id="00f6" class="pw-post-body-paragraph ld le it lf b lg nm ju li lj nn jx ll lm no lo lp lq np ls lt lu nq lw lx ly im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="ba18" class="lz ma it lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="af2a" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">📰查看<a class="ae lc" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="20d5" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">🔔关注我们:<a class="ae lc" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae lc" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae lc" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="7fc1" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">🚀👉<a class="ae lc" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>