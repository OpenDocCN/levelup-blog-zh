<html>
<head>
<title>How To Deploy a React Application on Dokku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Dokku上部署React应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-deploy-a-react-application-on-dokku-afd8ed8887fa?source=collection_archive---------8-----------------------#2022-10-18">https://levelup.gitconnected.com/how-to-deploy-a-react-application-on-dokku-afd8ed8887fa?source=collection_archive---------8-----------------------#2022-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="daa0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">和杜库一起主持你的React SPA</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e507fa0d86fd76722bf7336c857575b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UxLDnfvnDWE3RcAQ"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@thkelley?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托马斯·凯利</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6b19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://dokku.com/" rel="noopener ugc nofollow" target="_blank"> Dokku </a>已经成为市场上最受欢迎的PaaS ( <a class="ae ky" href="https://en.wikipedia.org/wiki/Platform_as_a_service" rel="noopener ugc nofollow" target="_blank">平台即服务</a>)之一。特别是，Dokku是一个可扩展的、开源的PaaS，它运行在单个服务器上。</p><p id="ffeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Dokku使你能够通过一个简单的<code class="fe lv lw lx ly b">git push</code>命令，经由<a class="ae ky" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank"> Dockerfile </a>或者通过用<a class="ae ky" href="https://buildpacks.io/" rel="noopener ugc nofollow" target="_blank"> Buildpacks </a>自动检测语言来动态构建应用。具体来说，它基于应用程序的构建映像创建了一个Docker容器。然后，它启动容器，启动您的应用程序。</p><p id="06e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们了解一下在Dokku上部署React应用程序需要做些什么！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="353f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在Dokku上部署React应用程序</h1><p id="d0b8" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在Dokku上部署React SPA ( <a class="ae ky" href="https://en.wikipedia.org/wiki/Single-page_application" rel="noopener ugc nofollow" target="_blank">单页面应用程序</a>)需要五个简单的步骤。让我们深入研究一下。</p><h2 id="8cfd" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">1.设置Dokku</h2><p id="6c41" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">你可以在这里学习如何设置Dokku服务器<a class="ae ky" href="http://dokku.viewdocs.io/dokku/getting-started/installation/" rel="noopener ugc nofollow" target="_blank">。然后，按照这个</a>指南来学习如何部署你的应用程序。初始化您的Dokku机器后，启动以下命令创建一个新的Dokku应用程序:</p><pre class="kj kk kl km gt np ly nq nr aw ns bi"><span id="8ac8" class="nd mh it ly b gy nt nu l nv nw">dokku apps:create &lt;YOUR_REACT_APP_NAME&gt;</span></pre><p id="d25a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将<code class="fe lv lw lx ly b">&lt;YOUR_REACT_APP_NAME&gt;</code>替换为您希望在Dokku上为React应用程序指定的名称。比如，姑且称之为<code class="fe lv lw lx ly b">my-react-app</code>:</p><pre class="kj kk kl km gt np ly nq nr aw ns bi"><span id="34dd" class="nd mh it ly b gy nt nu l nv nw">dokku apps:create my-react-app</span></pre><h2 id="a986" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">2.添加Dokku Git遥控器</h2><p id="603c" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">要在Dokku上部署React应用程序，您必须启动一个涉及特定<a class="ae ky" href="https://git-scm.com/docs/git-remote" rel="noopener ugc nofollow" target="_blank">遥控器</a>的<code class="fe lv lw lx ly b">git push</code>命令。在终端中输入React项目，并使用以下命令添加Dokku git remote:</p><pre class="kj kk kl km gt np ly nq nr aw ns bi"><span id="b1f3" class="nd mh it ly b gy nt nu l nv nw">git remote add &lt;REMOTE_NAME&gt; dokku@&lt;YOUR_SERVER_IP&gt;:&lt;YOUR_REACT_APP_NAME&gt;</span></pre><p id="c9b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用你想给git遥控器起的名字替换<code class="fe lv lw lx ly b">&lt;REMOTE_NAME&gt;</code>。比如可能是<code class="fe lv lw lx ly b">dokku</code>、<code class="fe lv lw lx ly b">production</code>等。另外，用您的服务器/VPS的域或IP地址替换<code class="fe lv lw lx ly b">&lt;YOUR_SERVER_IP&gt;</code>。同样，用您在第一步中使用的Dokku应用程序的名称替换<code class="fe lv lw lx ly b">&lt;YOUR_REACT_APP_NAME&gt;</code>。</p><p id="885e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本例中，该命令将如下所示:</p><pre class="kj kk kl km gt np ly nq nr aw ns bi"><span id="d6ef" class="nd mh it ly b gy nt nu l nv nw">git remote add production dokku@app.my-domain.com:my-react-app</span></pre><p id="1b26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，您就添加了Dokku git遥控器。您现在可以通过<code class="fe lv lw lx ly b">git push</code>命令部署您的应用程序。但是首先，您需要一个应用服务器！</p><h2 id="bd05" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">3建立一个Node.js服务器</h2><p id="46bf" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">现在，您应该设置一个服务器。这是因为任何React应用程序都需要通过应用服务器提供服务。只需几行代码就可以配置Node.js Express服务器。</p><p id="cea7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，确保使用以下命令将<code class="fe lv lw lx ly b"><a class="ae ky" href="https://www.npmjs.com/package/express" rel="noopener ugc nofollow" target="_blank">express</a></code>添加到项目的依赖项中:</p><pre class="kj kk kl km gt np ly nq nr aw ns bi"><span id="ac66" class="nd mh it ly b gy nt nu l nv nw">npm i express</span></pre><p id="632a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在React项目的根文件夹中创建一个<code class="fe lv lw lx ly b">server.js</code>文件，并将其初始化，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="5381" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，该文件充当Node.js Express服务器。特别是，它初始化一个Express服务器，并使用它来服务于<code class="fe lv lw lx ly b">/build/index.html</code>文件。这是React构建过程通过<code class="fe lv lw lx ly b">npm run build</code>命令生成的索引文件。</p><p id="e541" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">*</code>限定符指定服务器将使用<code class="fe lv lw lx ly b">index.html</code>文件响应收到的任何<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET" rel="noopener ugc nofollow" target="_blank"> HTTP GET请求</a>。这正是让SPA前端路由系统工作所需要做的。</p><p id="bea9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，您可以定制这个Express服务器来处理CSP ( <a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" rel="noopener ugc nofollow" target="_blank">内容安全策略</a>)或其他带有<code class="fe lv lw lx ly b"><a class="ae ky" href="https://www.npmjs.com/package/helmet" rel="noopener ugc nofollow" target="_blank">helmet</a></code>的HTTP头。</p><h2 id="49b9" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">4.创建Procfile</h2><p id="9d0e" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b"><a class="ae ky" href="https://dokku.com/docs/deployment/builders/dockerfiles/#procfiles-and-multiple-processes" rel="noopener ugc nofollow" target="_blank">Procfile</a></code>允许您指定由Dokku执行的运行命令来启动您的应用程序。详细地说，<code class="fe lv lw lx ly b">Procfile</code>将在部署后从Dokku创建的Docker映像中提取。然后包含在<code class="fe lv lw lx ly b">Procfile</code>中的命令将被传递给<code class="fe lv lw lx ly b"><a class="ae ky" href="https://docs.docker.com/engine/reference/run/" rel="noopener ugc nofollow" target="_blank">docker run</a></code>命令来启动您的应用程序。</p><p id="f495" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个<code class="fe lv lw lx ly b">Procfile</code>文件并把它放在<code class="fe lv lw lx ly b">/app</code>或者你的<code class="fe lv lw lx ly b"><a class="ae ky" href="https://dokku.com/docs/deployment/builders/dockerfiles/" rel="noopener ugc nofollow" target="_blank">Dockerfile</a></code>中定义为<code class="fe lv lw lx ly b">WORKDIR</code>的文件夹中。默认情况下，存储库的根文件夹将用作文档根。因此，将<code class="fe lv lw lx ly b">Procfile</code>放在你的应用程序的根目录下应该是可行的。</p><p id="6c5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，将其初始化如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="2227" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该命令将在每个Dokku部署结束时使用，以启动Node.js Express服务器并为React SPA提供服务。</p><h2 id="5b5e" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">5.部署到杜库</h2><p id="d950" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">现在，您已经准备好在Dokku上部署React应用程序了。您所要做的就是<a class="ae ky" href="https://github.com/git-guides/git-commit" rel="noopener ugc nofollow" target="_blank">提交更改</a>并启动以下命令:</p><pre class="kj kk kl km gt np ly nq nr aw ns bi"><span id="ffc1" class="nd mh it ly b gy nt nu l nv nw">git push <!-- -->&lt;REMOTE_NAME&gt;</span></pre><p id="88d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用您在步骤2中给Dokku Git遥控器的名称替换<code class="fe lv lw lx ly b">&lt;REMOTE_NAME&gt;</code>。在本例中，该命令变为:</p><pre class="kj kk kl km gt np ly nq nr aw ns bi"><span id="c6f7" class="nd mh it ly b gy nt nu l nv nw">git push production </span></pre><p id="049e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">等待Dokku上的部署过程结束。首先，Dokku将通过运行<code class="fe lv lw lx ly b">npm run build</code>构建您的React应用程序。然后，它将启动包含在<code class="fe lv lw lx ly b">Procfile</code>中的命令，并启动您的应用程序。</p><p id="c921" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您应该能够在浏览器中通过服务器的IP地址/域名访问React应用程序。</p><p id="2efb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你。您刚刚学习了如何在Dokku上部署React应用程序！</p><p id="b6c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能也有兴趣了解如何在Apache服务器上部署和托管React应用程序。</p><div class="nz oa gp gr ob oc"><a href="https://codeburst.io/deploying-and-hosting-a-react-app-on-an-apache-server-b7121dffb07a" rel="noopener follow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">在Apache服务器上部署和托管React应用程序</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">你甚至可以在共享主机上运行React应用程序！</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">codeburst.io</p></div></div><div class="ol l"><div class="om l on oo op ol oq ks oc"/></div></div></a></div></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0d5d" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="1468" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在本文中，您了解了在Dokku上部署React应用程序所需的一切。Dokku是最受欢迎的PaaS之一，它允许您在几分钟内部署一个应用程序。在这里，您看到了如何配置它，以及您需要在React应用程序中做些什么来使它可在Dokku上部署。</p><p id="1543" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！我希望这篇文章对你有所帮助。请随意留下任何问题、评论或建议。</p></div></div>    
</body>
</html>