<html>
<head>
<title>Speed up Your Python Code with Cython</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Cython加速您的Python代码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/speed-up-your-python-code-with-cython-30a67ced1c72?source=collection_archive---------23-----------------------#2021-06-29">https://levelup.gitconnected.com/speed-up-your-python-code-with-cython-30a67ced1c72?source=collection_archive---------23-----------------------#2021-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6884" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">cy thon:Python的C扩展</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/59cb172f003656f07627e6783da5a059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cchQaiD0_ja2KooF"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@grzegorzwalczak?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Grzegorz Walczak </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="41bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能听过有人抱怨Python非常慢。他们经常在代码执行时间方面比较Python和C语言。</p><p id="347d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们忘记了一件事，Python是比C更高级的语言，它允许我们以更接近人类思维方式的方式编写代码。</p><p id="24f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就代码执行时间而言，C编程语言确实比Python编程语言快很多倍。尽管如此，如果算上开发时间，Python往往胜过C语言。</p><p id="abfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想提高Python代码的速度，有一个选项可供您选择，<strong class="lb iu"> Cython。</strong>在本文中，我们将讨论什么是Cython，以及我们如何使用它来加速我们的Python代码。我们开始吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="62a0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Cython</h1><p id="3229" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Cython是Python的C扩展。它允许您编写纯Python代码，只需做一些小的更改，就可以翻译成C代码，并为您提供高性能，就像C编程语言一样。</p><p id="1cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想拥有像Python一样的简单语法和像C语言一样的高性能，Cython就是你的选择。它是Python和C编程语言的结合。</p><p id="76d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Cython，您可以使用Python的简单语法编写代码，并实现C语言的高性能。</p><h1 id="f7a9" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">装置</h1><p id="76ea" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">每个操作系统的安装过程都不同。为了使用Cython，我们需要一个C编译器。你可以在这里查看不同操作系统的C编译器的兼容性<a class="ae ky" href="https://cython.readthedocs.io/en/latest/src/quickstart/install.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9049" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦在系统中安装了C编译器，我们可以使用<code class="fe ne nf ng nh b">pip</code>命令简单地安装Cython:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="93c6" class="nm md it nh b gy nn no l np nq">pip install Cython</span></pre><h1 id="cfce" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">Cython中可用的数据类型</h1><p id="41b1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以使用所有静态类型来声明在<strong class="lb iu"> C/C++ </strong>语言中可用的变量和函数。</p><p id="4ee2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">在Cython中声明变量:</strong></p><p id="11d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<code class="fe ne nf ng nh b">int</code>、<code class="fe ne nf ng nh b">float</code>、<code class="fe ne nf ng nh b">double</code>、<code class="fe ne nf ng nh b">list</code>、<code class="fe ne nf ng nh b">dict</code>和<code class="fe ne nf ng nh b">object</code>等数据类型来声明变量。</p><p id="f5ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">例如:</strong></p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="6ebf" class="nm md it nh b gy nn no l np nq"><strong class="nh iu">cdef </strong>int x = 10;</span></pre><p id="2326" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">在Cython中声明一个函数:</strong></p><p id="a16d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们可以用来编写函数的方法:</p><ul class=""><li id="526a" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><strong class="lb iu"> def — </strong>用于常规python函数。只能从Python中调用它们。</li><li id="5242" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><strong class="lb iu"> cdef — </strong>仅用于Cython功能。它们不能从python代码中访问，必须在Cython中调用。</li><li id="a93c" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><strong class="lb iu"> cpdef — </strong>对于<strong class="lb iu"> </strong> C和Python都适用。用<code class="fe ne nf ng nh b">cpdef</code>类型定义的函数可以从Python和C代码中访问。</li></ul><p id="1e6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">举例:</strong></p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="f903" class="nm md it nh b gy nn no l np nq"><strong class="nh iu">cdef</strong> int addition(int x, int y):<br/>    <strong class="nh iu">return</strong> x + y</span></pre><p id="422f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，你可以看到语法是如何与Python语言相同，但我们需要静态地使用数据类型与每个变量声明。</p><h1 id="e4fe" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated"><strong class="ak">如何使用Cython？</strong></h1><p id="d89e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您可以在<code class="fe ne nf ng nh b">Jupyter Notebook</code>中轻松使用Cython。Jupyter Notebook是一个交互式网络工具，用于开发基于数据科学和python的项目。</p><p id="5ed8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在Jupyter笔记本中运行Cython代码，您需要运行:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="bad5" class="nm md it nh b gy nn no l np nq">%load_ext Cython</span></pre><p id="7466" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，每当您想要运行Cython代码时，我们需要在代码单元格中添加以下命令:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="5583" class="nm md it nh b gy nn no l np nq">%%cython</span></pre><p id="c952" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成这两步后，就可以开始在笔记本上写Cython代码了。</p><h1 id="0ce7" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">Cython有多快？</h1><p id="c865" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们知道如何在Cython中声明变量以及它的语法。现在，我们想比较Cython与Python相比快了多少。</p><p id="e2a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们以斐波那契数为例，用Cython和Python计算执行时间。</p><p id="ed01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Python代码:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="1ecd" class="nm md it nh b gy nn no l np nq">Output:</span><span id="2384" class="nm md it nh b gy oh no l np nq">24157817 <br/>Execution time: 14.819252490997314</span></pre><p id="12f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们可以看到，计算第38个斐波那契数用了14.81秒。现在让我们看看Cython代码在相同的计算中是如何执行的。</p><p id="b04f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Cython代码:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="dc1a" class="nm md it nh b gy nn no l np nq">Output:</span><span id="2c8d" class="nm md it nh b gy oh no l np nq">24157817<br/>Execution time: 0.6341381072998047</span></pre><p id="2638" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们可以看到<strong class="lb iu"> Cython代码比Python代码快大约23.5倍。</strong>这个例子完美地展示了使用Cython的能力。</p><h1 id="c3b7" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">Cython的特点</h1><ul class=""><li id="14c7" class="nr ns it lb b lc mu lf mv li oi lm oj lq ok lu nw nx ny nz bi translated">Cython与Python完全兼容，高效易用。</li><li id="40ae" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">编写与C代码来回调用的Python代码。</li><li id="abb2" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">具有C语言性能的可读Python代码。</li><li id="54b6" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">高效处理大型数据集。</li><li id="d658" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">在CPython生态系统中快速构建应用程序。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0180" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="c5af" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这篇文章就是这么说的。在本文中，我们讨论了如何使用Cython来加速我们的Python代码，并使用它的功能来改进代码执行时间。您可以练习Cython代码，以便更好地实践，并使您的代码运行得更快。</p><p id="0535" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="2248" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里免费订阅我的时事通讯:<a class="ae ky" href="https://pralabhsaxena.medium.com/subscribe" rel="noopener"> Pralabh的时事通讯</a></p></div></div>    
</body>
</html>