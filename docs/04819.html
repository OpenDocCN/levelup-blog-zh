<html>
<head>
<title>Changing the MAC Address using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python更改MAC地址</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/changing-mac-address-using-python-8a16fc4a3563?source=collection_archive---------0-----------------------#2020-07-17">https://levelup.gitconnected.com/changing-mac-address-using-python-8a16fc4a3563?source=collection_archive---------0-----------------------#2020-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/81aa230d7ca426dc509ddbf47e47af1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzLQY2lUIx_r6ZI2v6ZBew.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">媒体访问控制(MAC)地址</figcaption></figure><blockquote class="kc kd ke"><p id="23e8" class="kf kg kh ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated"><strong class="ki ir">注意:</strong>下面的教程适用于任何Linux发行版，但是您需要root权限来执行必要的系统命令，以便成功地更改MAC地址。</p></blockquote></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h2 id="c7af" class="ll lm iq bd ln lo lp dn lq lr ls dp lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">什么是MAC地址？</h2><p id="8621" class="pw-post-body-paragraph kf kg iq ki b kj mh kl km kn mi kp kq lu mj kt ku ly mk kx ky mc ml lb lc ld ij bi translated">要了解如何更改MAC地址，有必要了解什么是MAC地址。我们都使用各种电子设备，如智能手机、台式机、笔记本电脑、平板电脑等来浏览互联网、娱乐以及完成其他任务。这些电子设备都有自己的MAC地址。<strong class="ki ir"> MAC </strong>代表<strong class="ki ir">媒体访问控制</strong>地址。每台设备都需要一个MAC地址，以便被网络上的其他设备唯一识别。例如，当你在Youtube上观看一个视频时，你通过你的设备发送一个视频请求，这个请求通过你的默认网关传输(通常通过一个私人家庭网络的路由器)。然后，路由器将这个请求发送到万维网，并接收响应。现在，<strong class="ki ir">万维网(它是公共的)</strong>不知道你是谁，因为你的设备有一个<strong class="ki ir">私有IP地址</strong>，它只被你的路由器识别，所以路由器收到的响应然后给你，因为路由器知道你的MAC地址与你的设备的私有IP地址相关联。</p><p id="3442" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">MAC地址是一个48位硬件地址，在制造时硬编码在<strong class="ki ir">网络接口卡(NIC) </strong>上。MAC地址也称为设备的<strong class="ki ir">物理地址</strong>。MAC地址用于在网络中传输数据包。</p><p id="0f8a" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">例如，<strong class="ki ir"> 00:1A:3F:F1:4C:C6 </strong>是一个MAC地址。地址的前三个八位字节(00:1A:3F)标识制造商，称为<strong class="ki ir"> OUI(组织唯一标识符)。</strong>最后三个八位字节是<strong class="ki ir">网络接口控制器专用的</strong>。</p><p id="2994" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">点击阅读更多关于<strong class="ki ir">NIC</strong>T22。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h2 id="a842" class="ll lm iq bd ln lo lp dn lq lr ls dp lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">为什么我们需要更改MAC地址？</h2><p id="7828" class="pw-post-body-paragraph kf kg iq ki b kj mh kl km kn mi kp kq lu mj kt ku ly mk kx ky mc ml lb lc ld ij bi translated">您想要更改设备的MAC地址有几个原因。让我们一个一个来看:</p><ul class=""><li id="6bd7" class="mn mo iq ki b kj kk kn ko lu mp ly mq mc mr ld ms mt mu mv bi translated"><strong class="ki ir">增加匿名性:</strong>在公共网络上，你可能希望更改MAC地址以保持匿名，如果你不这样做，那么你所在的网络可能会记录你的MAC地址，从而留下痕迹。</li><li id="8785" class="mn mo iq ki b kj mw kn mx lu my ly mz mc na ld ms mt mu mv bi translated"><strong class="ki ir">模拟其他设备:</strong>当您想要实施攻击(出于测试目的)时，更改MAC地址对于模拟任何合法设备都很有用。</li><li id="23ca" class="mn mo iq ki b kj mw kn mx lu my ly mz mc na ld ms mt mu mv bi translated"><strong class="ki ir">绕过过滤器:</strong>如果一个MAC地址被列入黑名单使用网络，要克服这一点就是改变MAC地址，骗过过滤器。</li></ul></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h2 id="f0bf" class="ll lm iq bd ln lo lp dn lq lr ls dp lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">如何更改MAC地址？</h2><p id="766b" class="pw-post-body-paragraph kf kg iq ki b kj mh kl km kn mi kp kq lu mj kt ku ly mk kx ky mc ml lb lc ld ij bi translated">要更改MAC地址，我们需要执行一些系统命令。第一步是确定您想要更改其MAC地址的接口，您可以在Linux中使用以下命令来完成。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="38e4" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ ifconfig</span></pre><p id="08ad" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">上述命令产生以下输出。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="30e5" class="ll lm iq ng b gy nk nl l nm nn"><strong class="ng ir">enp0s3:</strong> flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br/>        inet 10.0.2.5  netmask 255.255.255.0  broadcast 10.0.2.255<br/>        <strong class="ng ir">ether 08:00:27:35:21:ff</strong>  txqueuelen 1000  (Ethernet)<br/>        RX packets 13962  bytes 17732985 (17.7 MB)<br/>        RX errors 0  dropped 0  overruns 0  frame 0<br/>        TX packets 7969  bytes 975852 (975.8 KB)<br/>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span></pre><p id="5db6" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">首先，要改变MAC地址我们需要知道<strong class="ki ir">接口名称</strong>和现有的<strong class="ki ir"> MAC地址。</strong>该信息可通过执行<strong class="ki ir"> ifconfig </strong>命令获得。我们可以从<strong class="ki ir"> ifconfig </strong>产生的输出中获得接口名称和现有的MAC地址。例如，从上面的输出来看，<strong class="ki ir"> enp0s3 </strong>是<strong class="ki ir">接口</strong>的名称，第三行的<strong class="ki ir"> ether </strong>字段具有MAC地址(在我们的例子中是<strong class="ki ir"> 08:00:27:35:21:ff </strong>)。</p><p id="fecf" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">现在我们知道了要更改其MAC地址的接口名称，我们可以转到下一个命令。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="cff9" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ sudo ifconfig enp0s3 down</span></pre><p id="cdaf" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">上面的命令在执行时会关闭接口。这意味着您将无法再连接到互联网。如果我们需要更改MAC地址，我们需要首先关闭接口<strong class="ki ir">(禁用)</strong>。在此之后，下一个要执行的命令将更改MAC地址。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="02c9" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ sudo ifconfig enps03 hw ether 00:11:22:33:44:55</span></pre><p id="7490" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">上述命令将现有的MAC地址<strong class="ki ir"> (08:00:27:35:21:FF) </strong>更改为命令本身指定的新MAC地址<strong class="ki ir"> (00:11:22:33:44:55) </strong>。现在接口enp0s3的MAC地址已经更改，但要使用它，我们需要使用以下命令再次启用该接口。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="00ae" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ sudo ifconfig enp0s3 up</span></pre><p id="f27d" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">执行上述命令后，再次启用接口，以便可以访问互联网。要检查MAC地址是否更改为我们指定的地址，请执行<strong class="ki ir"> ifconfig </strong>命令。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b407" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ ifconfig<br/><strong class="ng ir">enp0s3:</strong> flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br/>        inet 10.0.2.5  netmask 255.255.255.0  broadcast 10.0.2.255<br/>        <strong class="ng ir">ether 00:11:22:33:44:55</strong>  txqueuelen 1000  (Ethernet)<br/>        RX packets 13997  bytes 17737735 (17.7 MB)<br/>        RX errors 0  dropped 0  overruns 0  frame 0<br/>        TX packets 8892  bytes 1059117 (1.0 MB)<br/>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span></pre><p id="8faa" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">从输出中我们可以看到MAC地址由<strong class="ki ir"> 08:00:27:35:21:ff </strong>更改为<strong class="ki ir"> 00:11:22:33:44:55 </strong>。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h2 id="9af1" class="ll lm iq bd ln lo lp dn lq lr ls dp lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">使用Python更改MAC地址</h2><p id="0f72" class="pw-post-body-paragraph kf kg iq ki b kj mh kl km kn mi kp kq lu mj kt ku ly mk kx ky mc ml lb lc ld ij bi translated">到目前为止，我们都是手动键入命令并执行它们，但是我们可以使用Python来自动化整个过程，因此我们只需向脚本提供接口名称和新的MAC地址。</p><p id="3e51" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">使用的模块:</strong></p><ul class=""><li id="709c" class="mn mo iq ki b kj kk kn ko lu mp ly mq mc mr ld ms mt mu mv bi translated"><a class="ae mm" href="https://docs.python.org/3.4/library/subprocess.html" rel="noopener ugc nofollow" target="_blank">子流程</a></li><li id="1242" class="mn mo iq ki b kj mw kn mx lu my ly mz mc na ld ms mt mu mv bi translated"><a class="ae mm" href="https://docs.python.org/3/library/argparse.html" rel="noopener ugc nofollow" target="_blank"> argparse </a></li><li id="2864" class="mn mo iq ki b kj mw kn mx lu my ly mz mc na ld ms mt mu mv bi translated"><a class="ae mm" href="https://docs.python.org/3/library/re.html" rel="noopener ugc nofollow" target="_blank">回复</a></li></ul><p id="3771" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">子流程</strong>模块用于使用Python执行系统命令。它包含几个可以使用的函数。我们将重点关注一个用于执行系统命令的特定功能。它被称为<strong class="ki ir"> call() </strong>函数。</p><p id="9bd6" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">用法</strong></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="f11d" class="ll lm iq ng b gy nk nl l nm nn">subprocess.call([‘ifconfig’])</span></pre><p id="6209" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">此指令使用Python执行ifconfig命令。</p><p id="f878" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir"> argparse </strong>模块可以方便地编写用户友好的命令行界面。程序定义了它所需要的参数，argparse会计算出如何解析这些参数。它还生成帮助和用法消息，并在用户输入任何无效参数时发出错误。</p><p id="ef22" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">用途</strong></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="71ce" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ python3 programs_name.py -op1 option -op2 option</span></pre><p id="e82d" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">在argparse的帮助下，我们可以为用户提供使用命令行参数传递输入值的能力。即使你现在不明白，一旦我们开始编码，你就会明白了😃。</p><p id="a77e" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">接下来，<strong class="ki ir"> re </strong>模块提供了<strong class="ki ir">正则表达式</strong>匹配操作。随着我们继续前进，你会知道我们使用<strong class="ki ir"> re </strong>模块的目的。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h2 id="b91b" class="ll lm iq bd ln lo lp dn lq lr ls dp lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">Python脚本编码</h2><p id="65ca" class="pw-post-body-paragraph kf kg iq ki b kj mh kl km kn mi kp kq lu mj kt ku ly mk kx ky mc ml lb lc ld ij bi translated">这是我们开始用Python编码的地方。</p><p id="3010" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">第一步:</strong> <strong class="ki ir">导入上面讨论的模块。</strong></p><figure class="nb nc nd ne gt jr"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">导入必要的模块</figcaption></figure><p id="03c5" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">步骤2: </strong> <strong class="ki ir">实现允许用户传递命令行参数的功能。</strong></p><p id="4b51" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">要将这个特性添加到我们的脚本中，我们需要利用我们在步骤1中导入的<strong class="ki ir"> argparse </strong>模块。</p><figure class="nb nc nd ne gt jr"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">添加命令行参数功能</figcaption></figure><p id="0a4c" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">上述代码允许用户为<strong class="ki ir">接口</strong>值和<strong class="ki ir">新MAC地址</strong>提供如下输入:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0f68" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ python3 mac_changer.py -i interface_name -m new_mac_address</span></pre><p id="a7bb" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">或</strong></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="ee21" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ python3 mac_changer.py --interface interface_name --mac new_mac_address</span></pre><p id="83ee" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">interface_name =要更改其MAC地址的接口的名称。</p><p id="71af" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">new_mac_address =要替换旧地址的mac地址。</p><p id="b37c" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">选项</strong>存储用户提供的值。当您打印它时，输出如下:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="8c3d" class="ll lm iq ng b gy nk nl l nm nn">print(options)</span><span id="a1f5" class="ll lm iq ng b gy nq nl l nm nn"><strong class="ng ir">Output:</strong> <br/>Namespace(interface='enp0s3', new_mac='00:55:22:33:44:11')</span></pre><p id="6bbd" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">单独访问两个参数的方法如下:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="c314" class="ll lm iq ng b gy nk nl l nm nn">print(options.interface)<br/>print(options.new_mac)</span><span id="4ebe" class="ll lm iq ng b gy nq nl l nm nn"><strong class="ng ir">Output:</strong> <br/>enp0s3<br/>00:11:22:33:44:55</span></pre><blockquote class="kc kd ke"><p id="014b" class="kf kg kh ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">注意:<strong class="ki ir"> add_argument() </strong>方法中的<strong class="ki ir"> dest </strong>参数提供了<strong class="ki ir"> parse_args() </strong>在<strong class="ki ir"> options </strong>变量中存储其对应值的名称。</p></blockquote><p id="4a07" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">第2步的最后一件事是我们创建了一个变量<strong class="ki ir"> command_args </strong>并调用了函数<strong class="ki ir"> get_args() </strong>。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="4a0d" class="ll lm iq ng b gy nk nl l nm nn">command_args = get_args()</span></pre><p id="744a" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">上面的语句将存储由<strong class="ki ir"> get_args() </strong>返回的<strong class="ki ir">选项</strong>，因此我们可以访问函数范围之外的参数值。</p><p id="36b8" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">第三步:编写一个改变MAC地址的函数。</p><p id="774f" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">现在我们有了更改MAC地址所需的两个值<strong class="ki ir">(接口和新MAC地址)，</strong>我们将编写一个使用系统命令更改MAC地址的函数。</p><figure class="nb nc nd ne gt jr"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">写一个函数来改变MAC地址</figcaption></figure><p id="0fbf" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">看看我们刚刚写的函数，它接受<strong class="ki ir">两个</strong>参数<strong class="ki ir">(接口和new_mac)。</strong>这两个值由<strong class="ki ir"> command_args </strong>变量提供给<strong class="ki ir"> change_mac() </strong>函数。它还检查所提供的MAC地址是否有效。之后，使用<strong class="ki ir">子流程</strong>模块，我们执行系统命令。注意:您需要root访问权限来执行这些命令。</p><p id="a6d7" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">现在，我们已经完成了更改MAC地址的Python脚本，但是我们仍然需要确保应用了新的MAC地址。为此，我们需要编写另一个函数来返回接口的当前MAC地址。</p><p id="7f45" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated"><strong class="ki ir">第四步:编写函数获取当前MAC地址</strong></p><p id="abb2" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">该函数将interface作为输入，并返回该接口的当前MAC地址。我们写这个函数是为了检查新的MAC地址是否被应用。</p><figure class="nb nc nd ne gt jr"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">编写一个函数来获取MAC地址</figcaption></figure><p id="dfeb" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">因此，<strong class="ki ir"> get_current_mac() </strong>函数提取所提供接口的当前mac地址。现在，让我们来分解这个函数。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="c312" class="ll lm iq ng b gy nk nl l nm nn">output = sub.check_output(['ifconfig', interface], universal_newllines = True)</span></pre><p id="2d89" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">上述语句类似于<strong class="ki ir"> change_mac() </strong>函数中的<strong class="ki ir">sub call()</strong>，但有一处不同。<strong class="ki ir">sub check _ output()</strong>函数返回命令的输出，而<strong class="ki ir">sub call()</strong>不返回任何内容。返回的输出存储在变量<strong class="ki ir">输出中。</strong></p><p id="e975" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">此外，使用参数<strong class="ki ir">universal _ newlines = True</strong>是因为如果该值设置为<strong class="ki ir"> False </strong>，则返回的输出以<strong class="ki ir">字节为单位。</strong></p><blockquote class="kc kd ke"><p id="ec22" class="kf kg kh ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">Docs -&gt;默认情况下，该函数将返回编码字节形式的数据。输出数据的实际编码可能取决于被调用的命令，因此解码成文本通常需要在应用程序级别处理。这种行为可以通过将<em class="iq"> universal_newlines </em>设置为真来覆盖</p></blockquote><p id="c422" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">下一句话是，</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="4ff4" class="ll lm iq ng b gy nk nl l nm nn">search_mac = re.search(r"\w\w:\w\w:\w\w:\w\w:\w\w:\w\w", output)</span></pre><p id="32de" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">这就是使用<strong class="ki ir"> re </strong>模块的地方。<strong class="ki ir"> re </strong>代表正则表达式，它们经常在字符串匹配应用中使用。<strong class="ki ir"> re.search() </strong>函数接受<strong class="ki ir">正则表达式</strong>和<strong class="ki ir">字符串</strong>，其中模式应该被匹配。在我们的例子中，字符串存储在变量<strong class="ki ir">输出中。</strong><strong class="ki ir">\ w \ w:\ w \ w:\ w \ w:\ w \ w:\ w \ w:\ w \ w</strong>表达式匹配输出变量中的MAC地址，该变量具有<strong class="ki ir"> ifconfig </strong>命令的输出。看下图可以更好的理解。</p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/812b7cd239ac0553df2948fcbc16b506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6kJTE176C7GJTuPsi2A8AA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">正则表达式演示</figcaption></figure><p id="378e" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">如您所见，正则表达式与MAC地址完全匹配(在匹配结果框中以绿色突出显示)。<a class="ae mm" href="https://pythex.org/" rel="noopener ugc nofollow" target="_blank">正则表达式备忘单</a></p><p id="7a93" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">此外，<strong class="ki ir"> re.search() </strong>可能会找到多个与regex(正则表达式)匹配的字符串。因此，下面的语句将确保只返回第一个匹配的元素。如果它匹配一个以上的字符串，并返回不需要的字符串呢？在由<strong class="ki ir"> ifconfig，</strong>返回的输出中，得到不是想要的字符串的可能性几乎为零。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="60c5" class="ll lm iq ng b gy nk nl l nm nn">search_mac.group(0)</span></pre><p id="293e" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">这就总结了<strong class="ki ir"> get_current_mac() </strong>函数。</p><p id="eb32" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">现在，剩下的唯一事情就是检查用户提供的MAC地址是否被应用。对此，你可以看到我们调用了两次<strong class="ki ir"> get_current_mac() </strong>函数，一次在调用<strong class="ki ir"> change_mac() </strong>函数之前，一次在调用<strong class="ki ir"> change_mac() </strong>函数之后。这确保了我们捕获两个MAC地址(更改之前和之后)。然后，我们比较<strong class="ki ir"> changed_mac </strong>和<strong class="ki ir"> command_args.new_mac </strong>，如果两者匹配，则mac地址已成功更改。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="ca65" class="ll lm iq ng b gy nk nl l nm nn">if changed_mac == command_args.new_mac:<br/>    print('Successfully Changed the MAC Address')<br/>else:<br/>    print('Could not change the MAC Address')</span></pre><p id="5ad4" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">这是脚本结束的地方，要执行脚本，请执行以下操作:这在<strong class="ki ir">步骤2中有所介绍。</strong></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="c507" class="ll lm iq ng b gy nk nl l nm nn">dcode@dcode-pop-os:~$ python3 mac_changer.py -i interface_name -m new_mac_address</span><span id="73c9" class="ll lm iq ng b gy nq nl l nm nn"><strong class="ng ir">OR</strong></span><span id="15a3" class="ll lm iq ng b gy nq nl l nm nn">dcode@dcode-pop-os:~$ python3 mac_changer.py --interface interface_name --mac new_mac_address</span></pre></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="c40f" class="pw-post-body-paragraph kf kg iq ki b kj kk kl km kn ko kp kq lu ks kt ku ly kw kx ky mc la lb lc ld ij bi translated">完整的代码可以在我的<a class="ae mm" href="https://github.com/dharmil18/MAChanger" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p></div></div>    
</body>
</html>