<html>
<head>
<title>KNN: Failure cases, Limitations, and Strategy to Pick the Right K</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">KNN:失败案例、限制和选择正确K的策略</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/knn-failure-cases-limitations-and-strategy-to-pick-right-k-45de1b986428?source=collection_archive---------1-----------------------#2020-07-17">https://levelup.gitconnected.com/knn-failure-cases-limitations-and-strategy-to-pick-right-k-45de1b986428?source=collection_archive---------1-----------------------#2020-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5248" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇文章中，我们将讨论KNN的失败案例，它的局限性，以及如何选择正确的“K”值。</p><p id="4c86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你错过了第一部分，我强烈建议你先过一遍，<a class="ae ko" rel="noopener ugc nofollow" target="_blank" href="/knn-k-nearest-neighbours-d3ce76380e14"> <strong class="js iu"> <em class="kp">这里</em> </strong> </a>。</p><h2 id="c2dd" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">KNN的失败案例:</h2><h2 id="f246" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">案例1</h2><p id="dc6f" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">考虑下面的例子:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/c8e21dd9098a3bc3bcd69fdc9c0431e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tkmaHbeJu7fgrDkKCTXOdw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">作者图片</figcaption></figure><p id="0e75" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这种情况下，数据是随机分布的，因此无法从中获得有用的信息。现在，在这种情况下，当我们给定一个查询点(黄点)时，KNN算法将试图找到k个最近的邻居，但由于数据点是混乱的，准确性是值得怀疑的。</p><h2 id="6431" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">案例2</h2><p id="bbdf" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">考虑下面的例子:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/36f89190944994fc301725587f369810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mpi5Y2VOEwviB64ebnFOJQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">作者图片</figcaption></figure><h2 id="3287" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">在这种情况下，数据被分组到簇中，但是查询点似乎远离实际的分组。在这种情况下，我们可以使用K个最近邻来识别类，但是，这没有多大意义，因为查询点(黄点)离数据点真的很远，因此我们不能非常确定它的分类。</h2><h2 id="208a" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">KNN的局限性:</h2><p id="383d" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">KNN是一个非常强大的算法。也叫“懒学习者”。但是，它有以下一组限制:</p><p id="ef30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 1。不适用于大型数据集:</strong> <br/>由于KNN是一种基于距离的算法，计算新点和每个现有点之间的距离的成本非常高，从而降低了算法的性能。</p><p id="52bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 2。不适用于维数较高的情况:</strong> <br/>同样，原因同上。在高维空间中，计算距离的成本变得昂贵，因此影响性能。</p><p id="efc0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 3。对异常值和缺失值敏感:</strong> <br/> KNN对异常值和缺失值敏感，因此我们首先需要估算缺失值，并在应用KNN算法之前去除异常值。</p><h2 id="5770" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">如何挑选合适的“K”值？</h2><p id="f2bc" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">这是这个算法下最关键的一步。让我在这里重新构建我们在<a class="ae ko" rel="noopener ugc nofollow" target="_blank" href="/knn-k-nearest-neighbours-d3ce76380e14">之前的文章</a>中的例子。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/b162d7b48234f4ca17d443434ecc3ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*igIhJV6L620FAWNJltdV4Q.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated"><a class="ae ko" href="https://medium.com/@madanflies/k-nearest-neighbour-for-classification-on-breast-cancer-data-results-with-preprocessing-and-w-o-e21b0cc98a2f" rel="noopener">图像来源</a></figcaption></figure><p id="d3b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，当K的值=3时，我们将查询点分类为B类，如果K的值=7，我们将查询点分类为A类，这就是关于选择哪个K值的困惑所在。</p><p id="072b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们首先理解一个叫做<strong class="js iu">决策面</strong>的术语。</p><p id="3588" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，考虑下面的例子:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mg"><img src="../Images/4e362df0fff5561a407b281cc814fe67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZH_M-2NAFgdMfd8ves6MQ.jpeg"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">作者图片</figcaption></figure><p id="51d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，你可以观察到有一条蓝色的曲线将积极点和消极点分开。所以，当我们说，我们正在建立一个模型，将点分为积极和消极的点，我们基本上是在寻找一个函数，会为我们实现这一点。你看到的这条曲线就是那个函数。这条曲线是我们的模型。</p><p id="e1ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，除了几个点之外，我们看到这条曲线/决策面分隔了所有的正负点。此外，给定任何查询点，根据查询点位于决策表面的哪一侧(考虑到与邻居的距离)，它将被分类为正点或负点。</p><p id="e1f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们把注意力集中在绿点上。这个绿点是我的查询点，目标是将这个绿点分类到其中一个类中。</p><p id="7cc1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们把这个变得更有趣一些。考虑以下3种情况，以获得更好的直觉。</p><h2 id="44a0" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated"><strong class="ak">案例1 </strong></h2><p id="eaf5" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">假设我选择K=1的值。也就是说，我必须选择我的查询点的1-最近邻，无论那个1-NN的类标签是什么，我都需要把它赋给查询点。在这种情况下，我的1-NN是一个正的点，因此我需要给我的查询点分配一个正的类标签。但是等等！我的疑问点在决策面的负面。是的。没错，但那是从几何角度来说的。当我们应用KNN(其中K=1)时，最近的邻居是我的正点，因此算法将其分类为正点。这也被称为<strong class="js iu">过拟合</strong>。</p><h2 id="7e8f" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">案例2</h2><p id="0e03" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">这里，我选择K=5的值。现在，我需要考虑5个最近的邻居。当我考虑5-NN，取多数票时，我可以把查询点归为负面。</p><h2 id="d535" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">案例3</h2><p id="4e8d" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">这里，我的K值=n，其中n =数据集中的点的总数。为了便于理解，我们假设我有1000个数据点，在这1000个数据点中，600个点是负的，400个点是正的。所以我的K=1000。这意味着我们将把所有的1000个数据点视为我们的邻居。现在，当我们考虑所有数据点并考虑多数投票时，我们的查询点将被分类为负，因为负点数大于正点数。</p><p id="da80" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想在这里强调一个有趣的事实。考虑用蓝色标记的查询点。该查询点在正聚类的深处，但是对于K=1000，该查询点将被认为是负的，因为当考虑多数投票时，因为我有600个负点对400个正点，所以它将被认为是负点。因此，我想说的是，不管我的查询点在哪里，因为我将所有的数据点视为最近的邻居，并且我的负类标签占大多数，所以我的所有查询点都将被归类为负点。这也被称为欠拟合。</p><p id="80ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，你可能会想，这一切听起来很有趣，但困惑仍然普遍存在。如何选择合适的“K”值？</p><p id="5c35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个问题的答案是，没有一步一步的指南来解释找到“K”的正确值的最佳方法。</p><p id="73b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一种方法是针对不同的K值训练KNN，并获取该K值的性能指标。例如，您将精度视为性能指标，然后我们绘制精度与不同K值的关系图，并选择一个获得最佳精度的点。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/38d24e3a31312d796185005dcef7eaf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*i4kBCXqfRDpos3rdFY-gDw.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">Ogunkeye，Fiyinfoba。(2020).怎样才能在K近邻中找到最优的K？检索自:<a class="ae ko" href="https://www.researchgate.net/post/How_can_we_find_the_optimum_K_in_K-Nearest_Neighbor/5eed1eda27aecf741e3dd6db/citation/download" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h2 id="9d22" class="kq kr it bd ks kt ku dn kv kw kx dp ky kb kz la lb kf lc ld le kj lf lg lh li bi translated">结论:</h2><p id="0cef" class="pw-post-body-paragraph jq jr it js b jt lj jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj ln kl km kn im bi translated">到目前为止，我们了解了KNN的失败案例及其局限性，以及如何选择正确的k值。在下一节中，我们将了解交叉验证和k倍交叉验证。</p><p id="cec8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您有任何疑问/建议，请点击“关注”按钮，在评论区随意回复。</p><p id="8424" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">直到那时，快乐学习！</p></div></div>    
</body>
</html>