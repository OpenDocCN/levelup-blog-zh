<html>
<head>
<title>Donâ€™t let your secrets spill out; use AWS Parameter Store</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä¸è¦è®©ä½ çš„ç§˜å¯†æ³„éœ²å‡ºå»ï¼›ä½¿ç”¨AWSå‚æ•°å­˜å‚¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/dont-let-your-secrets-spill-out-use-aws-parameter-store-8a7252535c72?source=collection_archive---------19-----------------------#2021-01-25">https://levelup.gitconnected.com/dont-let-your-secrets-spill-out-use-aws-parameter-store-8a7252535c72?source=collection_archive---------19-----------------------#2021-01-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="78be" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">åœ¨AWS Lambdaä¸­è®¿é—®APIå¯†é’¥ç­‰ç§˜å¯†çš„ç®€å•æ–¹æ³•</h2></div></div><div class="ab cl kj kk hy kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="in io ip iq ir"><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj kq"><img src="../Images/3e71a3a67486e0a932e398e812425e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Lb2o8nhz9cgXPfqU"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated">åœ¨<a class="ae lg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šç”±<a class="ae lg" href="https://unsplash.com/@madhatterzone?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Manja Vitolic </a>æ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="47f4" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">ä½¿ç”¨Lambdaå¼€å‘å‡½æ•°æ—¶ï¼Œæ‚¨ä¼šé‡åˆ°éœ€è¦è®¿é—®å¤–éƒ¨ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åº(ä¾‹å¦‚Stripe)çš„æƒ…å†µã€‚ä¸ºæ­¤ï¼Œæ‚¨å¾ˆå¯èƒ½éœ€è¦ç”±å¤–éƒ¨æœåŠ¡æä¾›çš„APIå¯†é’¥ã€‚</p><p id="1b7c" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">ç¬¬ä¸€ååº”æ˜¯å°†è¿™ä¸ªAPIé”®ä¿å­˜ä¸ºä¸€ä¸ªç¯å¢ƒå˜é‡ã€‚æŸ¥çœ‹Terraformä¸­çš„ä»£ç :</p><pre class="kr ks kt ku gu md me mf mg aw mh bi"><span id="efc3" class="mi mj iu me b gz mk ml l mm mn">resource "aws_lambda_function" "test" {  <br/>  filename = "test.zip"<br/>  function_name = "test"<br/>  handler = "test.handler"<br/>  source_code_hash = filebase64sha256("test.zip")<br/>  runtime = "nodejs12.x"</span><span id="669d" class="mi mj iu me b gz mo ml l mm mn">  environment {<br/>    variables = {<br/>      API_KEY = "api-key"<br/>    }<br/>  }<br/>}</span></pre><p id="d4ec" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">å°½ç®¡è¿™å¯¹äºå¿«é€Ÿå®ç°æ¥è¯´å¾ˆå¥½ï¼Œä½†å®ƒå¹¶ä¸æ˜¯100%å®‰å…¨çš„ï¼Œå› ä¸ºAPIå¯†é’¥æ˜¯é€šè¿‡AWSæ§åˆ¶å°ä»¥æ˜æ–‡å½¢å¼å¯è§çš„ã€‚æˆ‘çŸ¥é“å¦‚æœä½ éµå¾ª<a class="ae lg" href="https://aws.amazon.com/blogs/security/getting-started-follow-security-best-practices-as-you-configure-your-aws-resources/" rel="noopener ugc nofollow" target="_blank"> AWSæœ€ä½³å®è·µ</a>ï¼Œæœ‰äººè®¿é—®ä½ çš„AWSè´¦æˆ·çš„å¯èƒ½æ€§å¾ˆå°ï¼Œä½†å®‰å…¨æ€»æ¯”åæ‚”å¥½ã€‚</p><p id="a93b" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">å¥½åœ¨AWSä¸ºè¿™ä¸ªç”¨ä¾‹æä¾›äº†ä¸€ä¸ªæœåŠ¡:<a class="ae lg" href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html" rel="noopener ugc nofollow" target="_blank">å‚æ•°å­˜å‚¨</a>ã€‚</p><p id="8b99" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·æ›´æ–°æˆ‘ä»¬çš„Terraformä»£ç :</p><pre class="kr ks kt ku gu md me mf mg aw mh bi"><span id="d158" class="mi mj iu me b gz mk ml l mm mn">resource "aws_ssm_parameter" "ssm_api_key" {<br/>  name  = "ssm-api-key"<br/>  type  = "SecureString"<br/>  value = "api-key"<br/>}</span><span id="8ebe" class="mi mj iu me b gz mo ml l mm mn">resource "aws_lambda_function" "test" {<br/>  filename = "test.zip"<br/>  function_name = "test"<br/>  handler = "test.handler"<br/>  source_code_hash = filebase64sha256("test.zip")<br/>  runtime = "nodejs12.x"</span><span id="f1f6" class="mi mj iu me b gz mo ml l mm mn">environment {<br/>    variables = {<br/>      API_KEY = "ssm-api-key"<br/>    }<br/>  }<br/>}</span></pre><p id="2bf8" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">è¿™æ ·ï¼Œæ‚¨å¯ä»¥åœ¨ç¯å¢ƒå˜é‡ä¸­å­˜å‚¨å¯¹APIé”®çš„å¼•ç”¨ã€‚åœ¨æ‚¨çš„ä»£ç (ä¾‹å¦‚JS)ä¸­ï¼Œæ‚¨ä½¿ç”¨AWS SDKæˆ–å¦ä¸€ä¸ªåº“(ä¾‹å¦‚<a class="ae lg" href="https://www.npmjs.com/package/aws-param-store" rel="noopener ugc nofollow" target="_blank"> aws-param-store </a>)æ¥è®¿é—®å®ƒçš„å€¼ã€‚</p><pre class="kr ks kt ku gu md me mf mg aw mh bi"><span id="209b" class="mi mj iu me b gz mk ml l mm mn">'use strict'</span><span id="30e9" class="mi mj iu me b gz mo ml l mm mn">import paramStore from 'aws-param-store'</span><span id="040c" class="mi mj iu me b gz mo ml l mm mn">const API_KEY = process.env.API_KEY<br/>const REGION = process.env.REGION</span><span id="e6e0" class="mi mj iu me b gz mo ml l mm mn">const apiKey = paramStore.getParameterSync(API_KEY, { region: REGION })?.Value</span></pre><p id="b501" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">è¯·è®°ä½æ›´æ–°Lambdaå‡½æ•°çš„IAMè§’è‰²ï¼Œä»¥å…è®¸è®¿é—®SSM:</p><pre class="kr ks kt ku gu md me mf mg aw mh bi"><span id="aa6b" class="mi mj iu me b gz mk ml l mm mn">{<br/>  "Effect": "Allow",<br/>  "Action": ["ssm:GetParameter"],<br/>  "Resource": [<br/>   "arn:aws:ssm:${var.region}:${var.account_id}:parameter/ssm-api-key"<br/>  ]<br/>}</span></pre><p id="0365" class="pw-post-body-paragraph lh li iu lj b lk ll jv lm ln lo jy lp lq lr ls lt lu lv lw lx ly lz ma mb mc in bi translated">ä½ çš„ç§˜å¯†ç°åœ¨å®‰å…¨äº†ğŸ‰</p><div class="mp mq gq gs mr ms"><a href="https://blog.jagonzalr.com/membership" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fp"><div class="mu ab mv cl cj mw"><h2 class="bd iv gz z fq mx fs ft my fv fx it bi translated">åŠ å…¥æˆ‘çš„ä»‹ç»é“¾æ¥åª’ä½“-ä½•å¡å®‰ä¸œå°¼å¥¥å†ˆè¨é›·æ–¯ç½—å¾·é‡Œæ ¼æ–¯</h2><div class="mz l"><h3 class="bd b gz z fq mx fs ft my fv fx dk translated">ä½œä¸ºä¸€ä¸ªåª’ä½“ä¼šå‘˜ï¼Œä½ çš„ä¼šå‘˜è´¹çš„ä¸€éƒ¨åˆ†ä¼šç»™ä½ é˜…è¯»çš„ä½œå®¶ï¼Œä½ å¯ä»¥å®Œå…¨æ¥è§¦åˆ°æ¯ä¸€ä¸ªæ•…äº‹â€¦</h3></div><div class="na l"><p class="bd b dl z fq mx fs ft my fv fx dk translated">blog.jagonzalr.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng la ms"/></div></div></a></div></div></div>    
</body>
</html>