<html>
<head>
<title>The Strategy Pattern In Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">围棋中的战略模式</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-strategy-pattern-in-go-2072d2b9d6ae?source=collection_archive---------4-----------------------#2020-11-23">https://levelup.gitconnected.com/the-strategy-pattern-in-go-2072d2b9d6ae?source=collection_archive---------4-----------------------#2020-11-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="37ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">动态地为您的程序添加功能！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2f064b84b74a735974115c790f1bd8b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LPs0k_-NlOUyrrAU.jpg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">图片来自<a class="ae le" href="https://www.reddit.com/r/2007scape/comments/2bpopj/alternate_trim_ideas_for_dragon_armor/" rel="noopener ugc nofollow" target="_blank"> Reddit </a></figcaption></figure><p id="bd7e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi lf translated">策略模式无疑是我最喜欢的设计模式之一。它允许您在程序运行时动态地向对象添加功能。这种设计模式的一个很好的用例是视频游戏，比如我一直最喜欢的游戏之一——老派江湖。在这个游戏中，你可以通过装备一把弓来增加你的攻击范围，用一根棍子和符文来改变你的伤害类型为魔法，或者用一件武器比如花岗岩巨锤来获得一次特殊的攻击！</p><p id="afa3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将研究真实世界的例子、UML+序列图以及Go for the Strategy模式的实现。该代码将基于能够装备不同的武器，以改变他们的攻击能力。</p><p id="a60d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们开始吧！</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="f671" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">真实世界的例子</h2><p id="1c6e" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">策略设计模式非常灵活，适用于许多类型的项目。包含它的主要原因是为了能够在运行时向对象动态添加新的行为。策略模式类似于装饰器模式，但是策略模式改变了对象的功能，而装饰器增加了该对象的现有行为。当您有一个需要以多种方式执行某个操作的对象时，这尤其有用。</p><p id="4218" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，如果您想为一个应用程序动态地选择不同的排序方法，您可以使用策略模式来实现。如果您想为排序方法添加日志记录功能，可以通过将排序方法包装在日志记录对象中来实现。您没有从根本上改变排序算法本身，但是您通过记录速度、使用的空间等增加了排序算法。</p><p id="6f12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">策略模式的其他用例包括:</p><ul class=""><li id="6745" class="mt mu it js b jt ju jx jy kb mv kf mw kj mx kn my mz na nb bi translated">方向应用程序-您可能只需要从A点到B点，但是您需要根据您是开车、骑自行车还是走路来修改路径算法。</li><li id="5b00" class="mt mu it js b jt nc jx nd kb ne kf nf kj ng kn my mz na nb bi translated">文件加密—行为要求可能会根据文件的大小而变化。较小的文件可以直接在内存中加密，而较大的文件可以在加密过程中部分存储。</li><li id="fdad" class="mt mu it js b jt nc jx nd kb ne kf nf kj ng kn my mz na nb bi translated">数据存储——您的程序目前可能只输出到JSON，但是如果您发现您实际上也需要输出到XML呢？</li></ul><p id="0b1f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用策略模式的另一个主要好处是，它可以让您为不明确的业务需求的变化做好准备。如果客户要求一些特性功能，但他们不知道他们希望它如何实现和/或您期望该功能发生变化，策略模式可以帮助您保持领先地位，并动态地满足这些功能！</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="90ca" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">UML和序列图</h2><p id="1207" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">从UML图开始，我们有需要方法<code class="fe nh ni nj nk b">operation()</code>的上下文结构。上下文结构将引用包含要实现的<code class="fe nh ni nj nk b">algorithm()</code>方法的策略接口。上下文可以给出所选算法所需的背景。</p><p id="5446" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我们有实现策略接口的策略1和策略2，以及调用方法<code class="fe nh ni nj nk b">algorithm()</code>的实际逻辑。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/3a251293d8770d77c2fb24d9bb2f2c5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/0*GbrzzXoU7Ix5f0yn.jpg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来自<a class="ae le" href="https://en.wikipedia.org/wiki/Strategy_pattern" rel="noopener ugc nofollow" target="_blank">维基百科</a></figcaption></figure><p id="6338" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，序列图简单地描述了当我们从调用链的顶端调用<code class="fe nh ni nj nk b">algoritm()</code>方法时，我们将使用选择的策略逻辑来执行算法并返回一些结果。</p><p id="a749" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如你所见，策略模式简单、简洁、灵活！</p><h2 id="2539" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">Go中的实现</h2><p id="9511" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">策略模式就是能够为给定的操作交换不同的功能。在这个例子中，我们将创建一个RPG游戏的基本结构，其中角色可以使用策略模式装备不同的武器。</p><p id="39cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我们需要的文件:</p><pre class="kp kq kr ks gt nm nk nn no aw np bi"><span id="971b" class="lv lw it nk b gy nq nr l ns nt">$ mkdir strategy-pattern-go<br/>$ cd strategy-pattern-go<br/>$ touch main.go character.go weapon.go sword.go bow.go</span></pre><p id="f43c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们必须实现的策略接口将是一种武器。具体的实现将是角色可以装备的实际武器。界面如下:</p><h2 id="64d6" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">武器，走</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="25f4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们需要实现一些这样的武器。在这个例子中只有两个，但是它们应该清楚地说明如何在<code class="fe nh ni nj nk b">useWeapon()</code>方法中实现不同的行为。</p><h2 id="b49e" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">剑，走</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="72d6" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">鞠躬，走</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="fc6b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然这两个结构几乎相同，但是你可以很容易地添加额外的行为，比如给每个武器一个攻击范围。如果你在游戏中加入了某种形式的位置属性，那么弓就可以远距离攻击角色。</p><p id="600f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在是时候给我们的策略一个参照的背景了，也就是一个新角色。注意角色攻击另一个对手，留下实际的武器行为和对武器本身的伤害之间的分离。这种委托允许角色使用不同类型的武器，给出不同的行为，而只需要调用<code class="fe nh ni nj nk b">attack()</code>方法。</p><h2 id="5448" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">人物. go</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="e6cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们有了背景(角色)和策略界面(武器)以及最终的具体策略(剑和弓),我们可以调用我们的对象来组织游戏的基础结构。</p><h2 id="bd0e" class="lv lw it bd lx ly lz dn ma mb mc dp md kb me mf mg kf mh mi mj kj mk ml mm mn bi translated">main.go</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="6313" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这绝对不是你想离开游戏的方式，因为它很快就会变得非常重复，但主要目标是让你理解策略模式如何给你的程序带来灵活性。</p><p id="d7f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们用<code class="fe nh ni nj nk b">go run *.go</code>运行这个程序，我们将得到以下输出:</p><pre class="kp kq kr ks gt nm nk nn no aw np bi"><span id="6a62" class="lv lw it nk b gy nq nr l ns nt">The Champion has 100 health left.<br/>The Cave Troll has 100 health left.<br/>The Champion slashes the Cave Troll with a Armadyl Godsword!<br/>The Cave Troll has 55 health left.<br/>The Cave Troll slashes the Champion with a Giant's Sword!<br/>The Champion has 45 health left.<br/>The Champion shoots the Cave Troll with a Dark Bow!<br/>The Cave Troll has 20 health left.</span></pre></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><p id="abbd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你有它，战略模式与Go！如果你想实际构建一个RPG游戏，我首先会建议你甚至不要使用Go。上面的例子也可以和另一种模式搭配，比如工厂模式，它可以让你在飞行中制造武器。你也可以添加装饰图案来给你的武器附魔和额外的能力。</p><p id="2983" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如您所见，如果您想继续本文中的示例，有许多可能性。我希望你能够更好地理解策略模式，并且学到一些新东西。感谢阅读！</p></div></div>    
</body>
</html>