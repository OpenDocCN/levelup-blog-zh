# 使用 Python 和 Pillow 创建自定义形状遮罩

> 原文：<https://levelup.gitconnected.com/create-a-custom-shape-mask-with-python-pillow-9f566dd1e6ae>

![](img/0436d53912cbeb64dc0bc61e07c7b8c8.png)

[(来源)](https://unsplash.com/photos/SUTfFCAHV_A)

和许多其他东西一样，Python 非常适合编程式的图像编辑。这在很大程度上要感谢[枕](https://pillow.readthedocs.io/en/stable/)库。从头开始创建一个图像，在上面粘贴几层，或者应用一些滤镜，只需几行代码就可以轻松完成。

今天，我将向您展示一个创建自定义形状遮罩的简短脚本。我们将加载一个没有背景的圣诞老人帽子，并在不到 20 行代码中添加一个和一个阴影！

圣诞帽原图，请在这里找到[。](https://github.com/Ze1598/medium-articles/blob/master/Create%20a%20custom%20shape%20mask%20with%20Python%20%26%C2%A0Pillow/santa_hat.png)

如果您已经熟悉 Pillow，那么这段代码看起来会很简单，即使这是您第一次接触这个库，我认为代码中的注释就足够了。但是，让我强调一下最重要的部分。

在第 8 行，创建将成为遮罩黑色矩形非常重要。它必须与原始图像的大小/尺寸相同，并且稍后会被裁剪成所需的形状，所以不要担心它的原始形状。

然后，第 15 行和第 17 行分别添加阴影和圣诞老人帽子，作为用脚本创建的图像的两个新图层。当添加阴影时，`mask=santa_hat`参数发挥了所有的魔力，因为它将矩形转换成与帽子相同的形状。当然，原图有透明背景是必不可少的，否则什么都不会发生。

当在第 17 行粘贴帽子本身时，它也需要`mask=santa_hat`参数，因此 Pillow 保持透明背景，即只粘贴帽子而不粘贴帽子**并且**填充帽子的背景…

![](img/d2961cb85f00696936e4f5be749afbe4.png)

不要忘记使用掩码参数

![](img/990f6763fab9914f0e8ef66a45c9f687.png)

适当的结果

就是这样！现在你知道如何创建一个自定义形状的面具的基础上，另一个形象。我认为这个阴影例子可能是一个有用的演示，但当然这也可以用于许多其他场景。只要你想要定制的图像和你的面具尺寸相同，你就可以开始了！

这种技术的未来应用注意:如果你有一个定制形状的图像，而不是一个实心矩形，那么在调用`paste`之前，调用`PIL.mageOps.fit`函数将图像调整到蒙版的尺寸。