<html>
<head>
<title>Helm — Create a Private Repository Using Apache Webserver</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Helm —使用Apache Webserver创建私有存储库</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/helm-create-a-private-repository-using-apache-webserver-e80e5dd7569e?source=collection_archive---------13-----------------------#2022-11-28">https://levelup.gitconnected.com/helm-create-a-private-repository-using-apache-webserver-e80e5dd7569e?source=collection_archive---------13-----------------------#2022-11-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b4fb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从私人存储库分发舵图</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4244771be1734b214108cb6bfe57cd4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6vEGao_3kKuqviuq"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@ventiviews?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Venti Views </a>拍摄的照片</figcaption></figure><p id="d566" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设，我们有一个场景，我们想在内部或组织内分发我们的掌舵图。实现这一点的方法之一是使用<strong class="ky ir"> Apache服务器</strong>创建一个私有存储库，该服务器将作为一个helm存储库。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/8f6aab87b2a7235acd6aeefc306aa90d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HvpdQGvtZvK0mvV1tUTF7w.png"/></div></div></figure><h2 id="4466" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">1.Apache服务器配置</h2><p id="db2f" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated"><strong class="ky ir"> ●安装Apache服务器:</strong></p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="8b31" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Repo-$ </strong>yum update<strong class="ms ir"><br/>Repo-$ </strong>yum install httpd</span></pre><p id="efd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> ●配置基本认证:</strong></p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="ddc3" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Repo-$</strong> vim /etc/httpd/conf/httpd.conf</span><span id="54b0" class="lt lu iq ms b gy na mx l my mz"><strong class="ms ir"># Add the below lines at the end</strong><br/><br/>&lt;Directory "/var/www/html"&gt;<br/>      AuthType Basic<br/>      AuthName "Restricted Content"<br/>      AuthUserFile /etc/httpd/.htpasswd<br/>      Require valid-user<br/>&lt;/Directory&gt;</span></pre><p id="c50a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> ●启动并启用Apache服务器:</strong></p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="edb9" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Repo-$ </strong>systemctl start httpd<br/><strong class="ms ir">Repo-$</strong> systemctl enable httpd<br/><strong class="ms ir">Repo-$</strong> systemctl status httpd</span></pre><h2 id="4079" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated"><strong class="ak"> 2。创建一个舵库</strong></h2><p id="413d" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">在“/var/www/html”目录下创建一个目录。新创建的目录将作为存储库。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="ed21" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Repo-$ </strong>mkdir /var/www/html/charts</span></pre><p id="ecfa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">图表存储库应该有一个<strong class="ky ir"> index.yaml </strong>文件。索引文件将包含存储库下的图表列表。每当我们在存储库下添加一个新图表时，我们都必须更新<strong class="ky ir"> index.yaml </strong>文件。使用下面的命令，我们可以生成一个<strong class="ky ir"> index.yam </strong> l文件。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="7d31" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Repo-$ </strong>helm repo index /var/www/html/charts/</span></pre><p id="0ac1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于存储库目前是空的，这就是为什么<strong class="ky ir"> index.yaml </strong>文件看起来像这样:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="d2e5" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir"># index.yaml</strong></span><span id="9864" class="lt lu iq ms b gy na mx l my mz">apiVersion: v1<br/>entries: {}<br/>generated: "2022-11-02T05:28:16.054800151Z"</span></pre><p id="f3d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一件需要记住的重要事情是，我们必须将舵图以打包格式存储在存储库下。</p><p id="4cbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设，我们有一个名为“webserver”的舵图。为了使用存储库来分发它，我们必须将它打包并存储在存储库目录下。然后我们必须更新<strong class="ky ir"> index.yaml </strong>文件。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="63fe" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Repo-$  </strong>helm package ~/webserver/ -d /var/html/www/charts/</span><span id="50e1" class="lt lu iq ms b gy na mx l my mz"># Update the index.yaml file:</span><span id="ddff" class="lt lu iq ms b gy na mx l my mz"><strong class="ms ir">Repo-$  </strong>helm repo index charts/</span></pre><p id="80b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们现在检查<strong class="ky ir"> index.yaml </strong>文件，我们会看到<strong class="ky ir"> index.yaml </strong>中填充了当前位于存储库目录下的图表信息。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="a366" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir"># index.yaml</strong></span><span id="b3e3" class="lt lu iq ms b gy na mx l my mz">apiVersion: v1<br/><strong class="ms ir">entries:<br/>  webserver:</strong><br/>  - apiVersion: v2<br/>    appVersion: 1.16.0<br/>    created: "2022-11-02T05:36:05.101051659Z"<br/>    description: A Helm chart for Kubernetes<br/>    digest: d4c08bc9cb975e4dcc0a486e4faace801685071686daa4f6aff74408eb5d714e<br/><strong class="ms ir">    name: webserver</strong><br/>    type: application<br/>    urls:<br/>    - webserver-0.1.0.tgz<br/>    version: 0.1.0<br/>generated: "2022-11-02T05:36:05.09986321Z"</span></pre><h2 id="0392" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">3.访问私有存储库</h2><p id="b247" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">在上面的两个步骤中，我们配置了apache服务器和helm存储库。在这一步中，我们将尝试从同一网络中的其他机器或kubernetes集群访问这个存储库。</p><p id="2bfa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了访问存储库，我们需要存储库服务器的IP地址和图表所在的目录名。以及我们在apache服务器配置期间配置的凭证。</p><p id="fc29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们在所需的机器中添加私有helm存储库(helm必须安装在机器上) :</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="1e3a" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Server-1 $ </strong>helm repo add <strong class="ms ir">customrepo </strong><a class="ae kv" href="http://172.31.3.183/charts/" rel="noopener ugc nofollow" target="_blank">http://172.31.3.183/charts/</a> --username admin --password Admin@123</span><span id="fa0e" class="lt lu iq ms b gy na mx l my mz"><strong class="ms ir">Server-1 $</strong> helm repo ls<br/>--------------------------------------------------------------------NAME            URL                        <br/>customrepo      <a class="ae kv" href="http://172.31.3.183/charts/" rel="noopener ugc nofollow" target="_blank">http://172.31.3.183/charts/</a></span></pre><p id="b6da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">搜索图表。尽管此时只有一个名为“webserver”的图表位于存储库之下。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="4968" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Server-1 $</strong> helm search repo webserver<br/>--------------------------------------------------------------------<br/>NAME                    CHART VERSION   APP VERSION     DESCRIPTION                <br/><strong class="ms ir">customrepo/webserver </strong>   0.1.0           1.16.0          A Helm chart for Kubernetes</span></pre><p id="226e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将图表从“custom repo”helm存储库中安装到k8s集群中。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="8e05" class="lt lu iq ms b gy mw mx l my mz"><strong class="ms ir">Server-1 $ </strong>helm install app websrever<br/>--------------------------------------------------------------------<br/>NAME: app<br/>LAST DEPLOYED: Wed Nov  2 05:55:44 2022<br/>NAMESPACE: default<br/>STATUS: deployed<br/>REVISION: 1<br/>TEST SUITE: None</span></pre><blockquote class="nb nc nd"><p id="eb6e" class="kw kx ne ky b kz la jr lb lc ld ju le nf lg lh li ng lk ll lm nh lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">注1(用于回购):</em> </strong> <em class="iq">每次我们在存储库目录下增加一个图表。我们必须更新</em><strong class="ky ir"><em class="iq">index . YAML</em></strong><em class="iq">文件。</em></p><p id="30ea" class="kw kx ne ky b kz la jr lb lc ld ju le nf lg lh li ng lk ll lm nh lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">注2(回购用户):</em> </strong> <em class="iq">从存储库中获取最新的可用图表。在从相应的存储库中搜索图表之前，我们需要更新存储库。</em></p></blockquote></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><blockquote class="nb nc nd"><p id="592e" class="kw kx ne ky b kz la jr lb lc ld ju le nf lg lh li ng lk ll lm nh lo lp lq lr ij bi translated"><em class="iq">如果您觉得这篇文章很有帮助，请点击</em> <strong class="ky ir"> <em class="iq">跟随</em> </strong> <em class="iq">👉</em><strong class="ky ir"><em class="iq"/></strong><em class="iq"/><strong class="ky ir"><em class="iq">拍拍</em> </strong> <em class="iq">👏</em> <strong class="ky ir"> <em class="iq"> </em> </strong> <em class="iq">按钮帮助我写更多这样的文章。<br/>谢谢🖤 </em></p></blockquote><h2 id="d20d" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">👉所有关于Helm的文章—</h2><div class="np nq gp gr nr"><div role="button" tabindex="0" class="ab bv gv cb fp ns nt bn nu kp ex"><div class="nv l"><div class="ab q"><div class="l di"><img alt="Md Shamim" class="l de bw nw nx fe" src="../Images/b46bdc53005abde6c6cb3e8ff0c200c3.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*Hqd8Xz1WHsoL1s2To3awnA.png"/><div class="fb bw l nw nx fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@shamimice03?source=post_page-----e80e5dd7569e--------------------------------" rel="noopener follow" target="_top"> Md沙米姆</a></p></div></div><div class="oa ob gw l"><h2 class="bd ir uf pe fp ug fr fs uh fu fw ip bi translated">HelmーSeries</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi ui au uj uk ul qv um an eh ei un uo up el em eo de bk ep" href="https://medium.com/@shamimice03/list/helmseries-6e2076d48ba8?source=post_page-----e80e5dd7569e--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="uq l fo"><span class="bd b dl z dk">11 stories</span></div></div></div><div class="on dh oo fp ab op fo di"><div class="di of bv og oh"><div class="dh l"><img alt="" class="dh" src="../Images/9ba5df61339b6f5d2ad01696050835e3.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*3NGLzkzV47jeWMX8"/></div></div><div class="di of bv oi oj ok"><div class="dh l"><img alt="" class="dh" src="../Images/74e4f8812ce0aceba2616e176b3021c2.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*wzqjRqAlMOjlwt7x"/></div></div><div class="di bv ol om ok"><div class="dh l"><img alt="" class="dh" src="../Images/a734d6746ba78eda4d8d1347c4231bae.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*6RKJMoeEspoXyjGN"/></div></div></div></div></div><h2 id="9a4d" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">👉所有关于Kubernetes的文章—</h2><div class="np nq gp gr nr"><div role="button" tabindex="0" class="ab bv gv cb fp ns nt bn nu kp ex"><div class="nv l"><div class="ab q"><div class="l di"><img alt="Md Shamim" class="l de bw nw nx fe" src="../Images/b46bdc53005abde6c6cb3e8ff0c200c3.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*Hqd8Xz1WHsoL1s2To3awnA.png"/><div class="fb bw l nw nx fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@shamimice03?source=post_page-----e80e5dd7569e--------------------------------" rel="noopener follow" target="_top"> Md沙米姆</a></p></div></div><div class="oa ob gw l"><h2 class="bd ir uf pe fp ug fr fs uh fu fw ip bi translated">关于Kubernetes的所有文章</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi ui au uj uk ul qv um an eh ei un uo up el em eo de bk ep" href="https://medium.com/@shamimice03/list/all-articles-on-kubernetes-7ae1a0f96f3b?source=post_page-----e80e5dd7569e--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="uq l fo"><span class="bd b dl z dk">24 stories</span></div></div></div><div class="on dh oo fp ab op fo di"><div class="di of bv og oh"><div class="dh l"><img alt="" class="dh" src="../Images/f1050aa27a3ef03122558b1ba1de1f58.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*7DhVxBWLKw_5M_jP"/></div></div><div class="di of bv oi oj ok"><div class="dh l"><img alt="" class="dh" src="../Images/f1c4131e92176033bce05392de197205.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*AkrEbqlA_j76u2I5Tm8npg.png"/></div></div><div class="di bv ol om ok"><div class="dh l"><img alt="" class="dh" src="../Images/27d4385154af67764cf37713dbbdc38e.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*98RmgcHgM1cyOobu"/></div></div></div></div></div></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><h1 id="24e5" class="ot lu iq bd lv ou ov ow ly ox oy oz mb jw pa jx me jz pb ka mh kc pc kd mk pd bi translated">分级编码</h1><p id="25b3" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="b4e5" class="pe pf iq ky b kz la lc ld lf pg lj ph ln pi lr pj pk pl pm bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="eb7d" class="pe pf iq ky b kz pn lc po lf pp lj pq ln pr lr pj pk pl pm bi translated">📰查看<a class="ae kv" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="7407" class="pe pf iq ky b kz pn lc po lf pp lj pq ln pr lr pj pk pl pm bi translated">🔔关注我们:<a class="ae kv" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kv" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kv" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="c158" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">🚀👉<a class="ae kv" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">加入升级人才集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>