<html>
<head>
<title>Implementing Golang Interfaces; Like a Boss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实现Golang接口；像老板一样</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/implementing-golang-interfaces-like-a-boss-73a0f7757597?source=collection_archive---------3-----------------------#2020-06-01">https://levelup.gitconnected.com/implementing-golang-interfaces-like-a-boss-73a0f7757597?source=collection_archive---------3-----------------------#2020-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq jr js"><p id="1abd" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">TL；DR <a class="ae ks" href="https://github.com/josharian/impl" rel="noopener ugc nofollow" target="_blank"> impl </a>是在Go中实现接口的一个非常方便的工具。</p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/24293b0ebb39f10bb3a3cf8ee439fda3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9D9u62mCYT7OhB9dNxXrkw.png"/></div></div></figure><p id="6aa2" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">Go中的接口提供了一种非常棒的方式来编写可重用的代码。它们在几乎所有的Go项目中被大量使用，所以我发现自己经常引用不同的<a class="ae ks" href="https://godoc.org/" rel="noopener ugc nofollow" target="_blank"> GoDocs </a>来在我自己的项目中实现接口。然而，为了弄清楚如何完全实现一个特定的接口，需要不断地参考文档，这可能会浪费一些时间。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi li"><img src="../Images/9280b082b1a25eccaf11593c4fd40f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68L7krFQLGxAQTeuvrI_Iw.png"/></div></div></figure><p id="ab52" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">例如，为了使我的结构可散列，需要实现<a class="ae ks" href="https://golang.org/pkg/hash/#Hash" rel="noopener ugc nofollow" target="_blank"> hash </a>接口是很常见的。以下是hash的文档页面:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lj"><img src="../Images/5d5e89f9145aed67ecc6a7ee64239f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q1YgC3cmGUiTaM4SZT2TbQ.png"/></div></div></figure><p id="8856" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">我没有将实现这个接口所需的五个方法签名提交到内存中，而是提出了一个更好的解决方案。</p></div><div class="ab cl lk ll hx lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="im in io ip iq"><h2 id="6464" class="lr ls it bd lt lu lv dn lw lx ly dp lz lf ma mb mc lg md me mf lh mg mh mi mj bi translated">把英普尔·⚡️带来</h2><p id="01a6" class="pw-post-body-paragraph jt ju it jw b jx mk jz ka kb ml kd ke lf mm kh ki lg mn kl km lh mo kp kq kr im bi translated"><a class="ae ks" href="https://github.com/josharian/impl" rel="noopener ugc nofollow" target="_blank"> Impl </a>生成实现接口的方法存根。这听起来足够简单，但是在实践中，它<em class="jv">居然</em>有用！</p><p id="3417" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">要使用impl，您只需要指定您想要实现接口的结构的名称，以及您想要实现的接口的名称。</p><pre class="ku kv kw kx gt mp mq mr ms aw mt bi"><span id="273e" class="lr ls it mq b gy mu mv l mw mx">$ impl &lt;struct-name&gt; &lt;interface-name&gt;</span></pre><p id="8178" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">回到hash示例，让我们看看如何利用impl来生成这个接口的实现。</p><p id="af51" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">运行<code class="fe my mz na mq b">impl Foo hash.Hash</code>会为我们生成以下代码:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="6da9" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">现在，我们不再需要查找如何实现Hash，我们可以参考impl为我们留下的方便的注释，以便完成每个方法。厉害！</p></div><div class="ab cl lk ll hx lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="im in io ip iq"><p id="48ba" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">现在想象一下，在未来，我们的<code class="fe my mz na mq b">Foo</code>结构不仅需要是可散列的，还需要是可排序的。这不是问题，我们也可以通过impl来根除<code class="fe my mz na mq b">sort</code>接口的实现！</p><pre class="ku kv kw kx gt mp mq mr ms aw mt bi"><span id="730d" class="lr ls it mq b gy mu mv l mw mx">$ impl Foo sort.Interface</span></pre><p id="337b" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">同样，这会生成实现sort所需的方法！</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="nb nc l"/></div></figure></div><div class="ab cl lk ll hx lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="im in io ip iq"><p id="e82e" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">impl不仅可以用来生成标准库接口的实现，还可以用来清除任何接口！例如，<a class="ae ks" href="https://github.com/siddontang/go-mysql/" rel="noopener ugc nofollow" target="_blank"> go-mysql </a>提供了一个强大的工具集，用于在go中与mysql数据库进行交互。我们可以很容易地使用impl来实现go-mysql中的<a class="ae ks" href="https://github.com/siddontang/go-mysql/blob/8b4711353793b5410c8dee9f44377bb11f9aa728/server/command.go#L11" rel="noopener ugc nofollow" target="_blank"> Handler </a>接口。</p><pre class="ku kv kw kx gt mp mq mr ms aw mt bi"><span id="3be2" class="lr ls it mq b gy mu mv l mw mx">$ go get github.com/siddontang/go-mysql/server<br/>$ impl Foo server.Handler</span></pre><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="3d16" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">现在，我们已经有了一个完整的、经过注释的go-mysql服务器处理程序接口的实现，可以填充了！有了这个一般原则，我们可以利用impl快速实现任何接口。</p></div><div class="ab cl lk ll hx lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="im in io ip iq"><p id="e3f1" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">在幕后，impl利用了<a class="ae ks" href="https://golang.org/pkg/cmd/go/internal/generate/" rel="noopener ugc nofollow" target="_blank"> go:generate </a>,我希望在以后的文章中会谈到这一点。如果您对此感兴趣，请告诉我！</p><p id="6341" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke lf kg kh ki lg kk kl km lh ko kp kq kr im bi translated">感谢阅读！👋</p></div><div class="ab cl lk ll hx lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="im in io ip iq"><div class="ku kv kw kx gt nd"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd iu gy z fp ni fr fs nj fu fw is bi translated">编写面试问题</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">一个完整的平台，在这里我会教你找到下一份工作所需的一切，以及…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">技术开发</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ld nd"/></div></div></a></div></div></div>    
</body>
</html>