<html>
<head>
<title>Beginner Spam Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初级垃圾邮件检测</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/beginner-spam-detection-63ad2b8a91ca?source=collection_archive---------3-----------------------#2020-08-26">https://levelup.gitconnected.com/beginner-spam-detection-63ad2b8a91ca?source=collection_archive---------3-----------------------#2020-08-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5ffccbe17eba9063a9c3f5494fcd9635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F346h5fUvcErRHnPgeX7GQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.mentalfloss.com%2Farticle%2F20997%2Forigin-spam-food-spam-email&amp;psig=AOvVaw25Vdg1kAAzZMwFOl4vrgFW&amp;ust=1598505365606000&amp;source=images&amp;cd=vfe&amp;ved=0CA0QjhxqFwoTCJjrtO2OuOsCFQAAAAAdAAAAABAK" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kd">垃圾邮件Vs火腿</strong> </a></figcaption></figure><p id="dd87" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这是python中的一个小项目，使用机器学习来检测给定的文本是垃圾邮件还是ham(不是垃圾邮件)。我在完成了密歇根大学在Coursera上的“Python中的应用文本挖掘”课程后做了这个项目，课程的链接在博客的末尾。在这里，我将尝试解释我的代码中的每一步，如果你想要完整的代码，GitHub链接也将在最后提供。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="a673" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我用我的本地机器做这个项目，规范如下。虽然这是一个非常小的项目，所以你不需要太多的计算能力。</p><h1 id="c5d5" class="lj lk iq bd kd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">规格</h1><p id="2631" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">名称:宏碁Predator Helios 300 (2019)</p><p id="556e" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">显卡:英伟达GeForce GTX 1660 Ti</p><p id="e9af" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">处理器名称:英特尔酷睿i7–9750h</p><p id="c549" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">内存:16 GB</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="c158" class="lj lk iq bd kd ll ml ln lo lp mm lr ls lt mn lv lw lx mo lz ma mb mp md me mf bi translated">导入库</h1><p id="fe6d" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">我使用Pandas和NumPy进行数据操作，使用matplotlib进行图形绘制，使用sklearn进行预处理、模型创建和模型评估。我将解释当我在代码中使用它们时，每个库在做什么。</p><p id="f113" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">P.S. — %matplotlib笔记本，是一款jupyter笔记本神奇功能。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="c307" class="lj lk iq bd kd ll ml ln lo lp mm lr ls lt mn lv lw lx mo lz ma mb mp md me mf bi translated">分析数据</h1><p id="b541" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">使用df.head()函数来查看数据，df是Pandas DataFrame对象，我已经从CSV函数中加载了数据，这里我们看到只有两列。文本，包含用于检测和目标的文本，作为标签来区分该文本是否是垃圾邮件。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="db26" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">现在，我已经绘制了数据集中有多少数据点是垃圾邮件或垃圾邮件。在这里，我们可以看到这是一个不平衡的数据集，因为垃圾邮件文本的数量远远小于火腿文本。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="1796" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">虽然我没有对数据做任何预处理，比如处理数据的不平衡，或者处理停用词，像‘the’，‘a’等词，以及像“.”这样的符号。, ';'等。你可以做这些事情来获得更好的结果。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="81b9" class="lj lk iq bd kd ll ml ln lo lp mm lr ls lt mn lv lw lx mo lz ma mb mp md me mf bi translated">特征工程</h1><p id="7dad" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">我把数据按80% — 20%的比例拆分，分别是训练和测试。然后，我用以下参数初始化了一个计数矢量器。尽管你可以改变这些来获得更好的结果，但是记住不要过度拟合你的模型。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="e716" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">初始化矢量器后，我拟合并转换了训练和测试数据，并给它们添加了一些新的特性。增加的特性是文本的总长度、文本中数字字符的总数和文本中的字数。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="cee9" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">add_feature()函数是我从课程中复制的，它是一个方便的函数，正如它的名字一样，向现有数据添加要素(矢量化)。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="5463" class="lj lk iq bd kd ll ml ln lo lp mm lr ls lt mn lv lw lx mo lz ma mb mp md me mf bi translated"><strong class="ak">模特创作</strong></h1><p id="200a" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">在创建我自己的模型之前，我使用了一个虚拟分类器来获得基线性能。用训练数据对其进行拟合，并使用测试数据进行预测。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="a3c3" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">现在，我选择逻辑回归作为我的模型，超参数C=100，max_iter=1000，用训练数据拟合它，并对测试数据进行预测。您可以尝试SVC或任何其他分类器，看看结果如何变化。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="c927" class="lj lk iq bd kd ll ml ln lo lp mm lr ls lt mn lv lw lx mo lz ma mb mp md me mf bi translated"><strong class="ak">模型评估</strong></h1><p id="11eb" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">使用混淆矩阵评估模型、虚拟回归和逻辑回归。我们可以看到，逻辑回归比我们的虚拟模型做得好得多。但它仍然不完美，因为据我所知，检测垃圾邮件是一个更加精确的问题，所以仍然有改进的空间。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="ec83" class="lj lk iq bd kd ll ml ln lo lp mm lr ls lt mn lv lw lx mo lz ma mb mp md me mf bi translated"><strong class="ak">结果</strong></h1><p id="2e9b" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">这是它的项目，是的，这是一个没有什么太复杂的小项目。现在，它更像是一个初级项目，但有可能变得更加复杂和高级。因为检测垃圾邮件是一个非常常见的问题，这只是一个简单的问题，但是您可以使用nltk这样的库添加更多的预处理，从而获得更好的结果。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="af6e" class="lj lk iq bd kd ll ml ln lo lp mm lr ls lt mn lv lw lx mo lz ma mb mp md me mf bi translated"><strong class="ak">链接</strong></h1><p id="6688" class="pw-post-body-paragraph ke kf iq kg b kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">GitHub:<a class="ae kc" href="https://github.com/Conero007/Spam-Detection/tree/master" rel="noopener ugc nofollow" target="_blank">https://github.com/Conero007/Spam-Detection</a></p><p id="b51a" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">领英:<a class="ae kc" href="https://www.linkedin.com/in/jayesh-rohan-singh-40a122197/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jayesh-rohan-singh-40a122197/</a></p><p id="b7d6" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">课程:<a class="ae kc" href="https://www.coursera.org/learn/python-text-mining/home/welcome" rel="noopener ugc nofollow" target="_blank">https://www . coursera . org/learn/python-text-mining/home/welcome</a></p></div></div>    
</body>
</html>