<html>
<head>
<title>Visual regression testing with BackstopJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用BackstopJS进行可视化回归测试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/visual-regression-testing-with-backstopjs-614703db1642?source=collection_archive---------0-----------------------#2018-10-29">https://levelup.gitconnected.com/visual-regression-testing-with-backstopjs-614703db1642?source=collection_archive---------0-----------------------#2018-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c089" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">项目越大，每次变更后花在回归测试上的时间就越多。BackstopJS是一个工具，可以帮助你减少这个过程中的努力</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f06c3f5c979d0b5a1c54b42ff28f0551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5XzHqXgZX4BzcZqn"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://www.adcisolutions.com/?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=medium-story-backstopjs-mainpagewebsite&amp;utm_content=medium-story-backstopjs" rel="noopener ugc nofollow" target="_blank">由ADCI解决</a></figcaption></figure><h1 id="5e9c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="3a82" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一个组件的变化会导致其他组件发生不希望的变化。通常，这只是视觉上的变化。<strong class="lq ir">回归测试</strong>允许发现这样的变化。</p><p id="7102" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">简而言之，回归测试是在已经存在的功能发生变化或添加了新组件时检查其可操作性的过程。</p><p id="17fb" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这种测试可以手动完成(这种情况经常发生)，但是根据项目的大小，这可能需要付出大量的努力并且非常耗时。这就是为什么建议通过使用特殊的自动化程序来优化测试过程，从而进行<strong class="lq ir">视觉回归测试</strong>。</p><p id="1c7b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">有许多可视化回归测试的工具。你可以在这里阅读其中一个<a class="ae kv" href="https://www.adcisolutions.com/knowledge/visual-regression-testing-drupal-using-gemini?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=medium-story-backstopjs-hackernoon-gemini&amp;utm_content=medium-story-backstopjs-hackernoon" rel="noopener ugc nofollow" target="_blank"/>。在本文中，我们将考虑BackstopJS工具，因为它功能强大，使用简单。</p><p id="e026" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们会考虑<strong class="lq ir">逆推</strong>的特点。读完这篇文章后，读者将会知道如何为他/她的项目安装和配置它，学习如何使用这个工具。</p><p id="0326" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们开始了解背刺。</p><h1 id="429c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">如何安装BackstopJS</h1><p id="52a9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">很简单。BackstopJS 既可以全局安装(推荐)，也可以本地安装在您的项目中。要安装，请运行以下命令:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="9c15" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">如何配置背景</h1><p id="14bf" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果还没有配置BackstopJS，可以在当前工作目录中创建一个默认的配置文件。在项目目录中运行以下命令:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="f832" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">将创建backstop.json配置文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="d244" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们看看文件的主要部分。</p><ul class=""><li id="4613" class="mr ms iq lq b lr mk lu ml lx mt mb mu mf mv mj mw mx my mz bi translated">id —用于屏幕截图命名</li><li id="2fcd" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">视窗—一组屏幕大小的对象，用于测试您的站点。您可以向视口中添加尽可能多的对象，但至少必须有一个</li><li id="2941" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">场景—这是您为测试设置特定数据的地方:</li></ul><p id="2dd6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">-场景[n]。标签—必需。用于屏幕截图命名</p><p id="3d70" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">-场景[n]。url —必需。这正是我们想要测试的。它可以是绝对URL，也可以是当前工作目录的本地URL</p><p id="ec30" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这些是主要参数，但还有许多其他参数可以帮助测试过程。</p><ul class=""><li id="4d96" class="mr ms iq lq b lr mk lu ml lx mt mb mu mf mv mj mw mx my mz bi translated">onBeforeScript —用于在测试前设置浏览器状态</li><li id="ec06" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">onReadyScript —在截屏前修改UI状态的脚本，例如悬停、点击等</li><li id="8e26" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">readyEvent —在将该字符串记录到控制台之前，测试无法运行</li><li id="0c24" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">readySelector —在该选择器出现之前，测试不会开始</li><li id="c5a1" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">hideSelectors —设置为可见性:隐藏的选择器数组</li><li id="26d7" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">removeSelectors —设置为显示的选择器数组:none</li><li id="5cbd" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">延迟—等待(毫秒)</li></ul><p id="0af2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您可以模拟用户行为:</p><ul class=""><li id="04c4" class="mr ms iq lq b lr mk lu ml lx mt mb mu mf mv mj mw mx my mz bi translated">hoverSelector —在创建屏幕截图之前，将鼠标光标移动到指定的DOM元素上</li><li id="9ab4" class="mr ms iq lq b lr na lu nb lx nc mb nd mf ne mj mw mx my mz bi translated">单击选择—在屏幕截图之前单击指定的DOM元素</li></ul><p id="4445" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">比较两种环境:</p><ul class=""><li id="3c1c" class="mr ms iq lq b lr mk lu ml lx mt mb mu mf mv mj mw mx my mz bi translated">reference URL——可以在两个不同的环境中比较页面，而不是使用参考截图</li></ul><p id="f0b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这还不是<strong class="lq ir">背刺</strong>能做的全部。在<a class="ae kv" href="https://github.com/garris/BackstopJS" rel="noopener ugc nofollow" target="_blank">官方文件</a>中查看完整列表。</p><h1 id="c66d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">如何使用背景知识</h1><p id="941f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在我们回顾了测试的基本设置之后，让我们来看看使用<strong class="lq ir">背景图</strong>的基本命令。</p><p id="945c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们仍然没有参考截图，我们将在测试期间比较页面的当前状态。运行命令:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="7455" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们有了所有的截图，我们可以开始测试了。运行以下命令:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="f2ac" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">它将在“bitmaps_test/ <timestamp> /”文件夹中生成新的图像，并将显示一份报告，比较最新的参考截图和当前的参考截图。</timestamp></p><p id="adb4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果所有测试用例都通过了，就可以更新参考截图了。运行以下命令:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="ab8a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来的测试将与您的新参考截图进行比较。</p><h1 id="de93" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">报告</h1><p id="a91e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在我们运行测试之后，BackstopJS在“back stop _ data/HTML _ report/index . HTML”文件夹中创建HTML报告，它清楚地显示了哪里出了问题以及出了什么问题。</p><p id="ae3d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这些报告看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/078d0388988e4cc16b89bc28202aa23e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LZICCOemAINx7o3W.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">BackstopJS HTML报表的外观</figcaption></figure><h1 id="98dc" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">编后记</h1><p id="bc19" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们已经学习了<strong class="lq ir"> BackstopJS </strong>的特性和功能，这是一个极大地方便了<strong class="lq ir">回归测试</strong>的工具，并且学习了如何使用这个工具。在社交网络上分享这个指南，以减少熵和一些不想要的变化。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="ec69" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="nn">最初发布于</em><a class="ae kv" href="https://www.adcisolutions.com/knowledge/visual-regression-testing-backstopjs?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=medium-story-backstopjs-article&amp;utm_content=medium-story-backstopjs" rel="noopener ugc nofollow" target="_blank"><em class="nn">ADCI解决方案网站。</em> </a></p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="d5a1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">作者是弗拉德·布拉特尼科夫，ADCI解决方案公司的网络开发人员</strong></p><p id="e9aa" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">Vladislav致力于为全球各地的客户提供完美的网站。他不断提高自己的技能，以交付更好的项目。在业余时间，他看书，做饭或打排球。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl no"><img src="../Images/73bcb62bbfda355e913e5b86e2193e46.png" data-original-src="https://miro.medium.com/v2/format:webp/1*5kC2KhUXG-R8C8-59J1RCA.png"/></div></figure><p id="f79a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在社交网络上关注我们: <a class="ae kv" href="https://twitter.com/ADCISolutions" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae kv" href="https://www.facebook.com/adcisolutions/" rel="noopener ugc nofollow" target="_blank">脸书</a> | <a class="ae kv" href="https://www.linkedin.com/company/adci-solutions/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><div class="np nq gp gr nr ns"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-work-with-project-documentation-3875135f0881"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">如何使用项目文档</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">详细文档的存在对于任何项目来说都是重要的事情之一。你是否使用…并不重要</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kp ns"/></div></div></a></div><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh mq l"/></div></figure></div></div>    
</body>
</html>