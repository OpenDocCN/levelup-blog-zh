<html>
<head>
<title>Getting Java and Jenkins Working on Linux on Mainframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让Java和Jenkins在大型机上运行Linux</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/getting-java-and-jenkins-working-on-linux-on-mainframe-d2a8736f2469?source=collection_archive---------9-----------------------#2020-02-07">https://levelup.gitconnected.com/getting-java-and-jenkins-working-on-linux-on-mainframe-d2a8736f2469?source=collection_archive---------9-----------------------#2020-02-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="dd3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在前面的故事中，我们已经了解了IBM大型机(System z)上的Linux，以及如何在真正的大型机硬件上免费访问IBM LinuxONE机器。</p><div class="ko kp gp gr kq kr"><a rel="noopener  ugc nofollow" target="_blank" href="/getting-started-with-linux-on-mainframe-fcd4b19d147d"><div class="ks ab fo"><div class="kt ab ku cl cj kv"><h2 class="bd iu gy z fp kw fr fs kx fu fw is bi translated">大型机Linux入门</h2><div class="ky l"><h3 class="bd b gy z fp kw fr fs kx fu fw dk translated">从上个世纪末开始，在大型机(System z)硬件上运行Linux并从中受益是可能的</h3></div><div class="kz l"><p class="bd b dl z fp kw fr fs kx fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="la l"><div class="lb l lc ld le la lf lg kr"/></div></div></a></div><p id="51d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个故事是关于在这样的机器上使用Java，这样我们就可以让像Jenkins这样的Java应用程序在这个系统上很好地运行。</p><h1 id="4bd7" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">在LinuxONE上安装Java</h1><p id="ed8e" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">让我们试试是否已经安装了Java:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="7407" class="mt li it mp b gy mu mv l mw mx">[linux1@plape ~]$ java<br/>-bash: java: command not found</span></pre><p id="82e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不，不是的。IBM推荐使用来自https://adoptopenjdk.net/ T2的Java版本。这是一个由IBM发起的项目，IBM在https://www.ibm.com/cloud/support-for-runtimes为这些Java运行时提供商业支持。</p><p id="ae06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开<a class="ae my" href="https://adoptopenjdk.net/" rel="noopener ugc nofollow" target="_blank">https://adoptopenjdk.net/</a>时，需要点击<strong class="js iu">其他平台</strong>按钮，选择<strong class="js iu"> s390x </strong>架构。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mz"><img src="../Images/943037e97ec27731e5d7ee38f1ee6176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qz8ayRn4scZPqNhv4z5e3Q.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">可用的JVM版本和类型</figcaption></figure><p id="ed06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">应该选择什么类型的JVM？HotSpot还是OpenJ9？IBM投资了Eclipse OpenJ9项目，其好处在<a class="ae my" href="https://developer.ibm.com/blogs/openjdk-with-eclipse-openj9-no-worries-just-improvements/" rel="noopener ugc nofollow" target="_blank">https://developer . IBM . com/blogs/open JDK-with-Eclipse-open j9-no-worries-just-improvements/</a>中有描述。</p><p id="ee62" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您下载s390x的HotSpot版本时，它只能在解释模式下运行，因此OpenJ9是一个明确的选择。我们来装吧！</p><p id="3ab3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">复制AdoptOpenJDK.net网页上的链接，并使用curl下载软件包:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="6473" class="mt li it mp b gy mu mv l mw mx">curl -OL <a class="ae my" href="https://github.com/AdoptOpenJDK/openjdk8-binaries/releases/download/jdk8u242-b08_openj9-0.18.1/OpenJDK8U-jdk_s390x_linux_openj9_8u242b08_openj9-0.18.1.tar.gz" rel="noopener ugc nofollow" target="_blank">https://github.com/AdoptOpenJDK/openjdk8-binaries/releases/download/jdk8u242-b08_openj9-0.18.1/OpenJDK8U-jdk_s390x_linux_openj9_8u242b08_openj9-0.18.1.tar.gz</a></span></pre><p id="5ebb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">拆开包装:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="9dc4" class="mt li it mp b gy mu mv l mw mx">tar -xf OpenJDK8U-jdk_s390x_linux_openj9_8u242b08_openj9-0.18.1.tar.gz</span></pre><p id="9657" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它创建一个新目录<code class="fe nk nl nm mp b">jdk8u242-b08</code>。</p><p id="0012" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将其移动到/opt:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="36cc" class="mt li it mp b gy mu mv l mw mx">sudo mv jdk8u242-b08 /opt/<br/>sudo chmod -R a+r /opt/jdk8u242-b08</span></pre><p id="bdc5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将其添加到路径:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="d4aa" class="mt li it mp b gy mu mv l mw mx">export PATH=/opt/jdk8u242-b08/bin:$PATH</span></pre><p id="443b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">并检查它是否工作:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="5993" class="mt li it mp b gy mu mv l mw mx">[linux1@plape ~]$ java -version<br/>openjdk version "1.8.0_242"<br/>OpenJDK Runtime Environment (build 1.8.0_242-b08)<br/>Eclipse OpenJ9 VM (build openj9-0.18.1, JRE 1.8.0 Linux s390x-64-Bit Compressed References 20200122_505 (JIT enabled, AOT enabled)<br/>OpenJ9   - 51a5857d2<br/>OMR      - 7a1b0239a<br/>JCL      - 8cf8a30581 based on jdk8u242-b08)</span></pre><h1 id="5433" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated"><strong class="ak">基准</strong></h1><p id="ce32" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">我们将使用<strong class="js iu">Renaissance Suite</strong>(<a class="ae my" href="https://renaissance.dev/" rel="noopener ugc nofollow" target="_blank">https://Renaissance . dev)</a>对这套系统的性能有所了解。Renaissance是一套JVM基准。我们只使用一个:<strong class="js iu"> finagle-http </strong>。</p><p id="0302" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们下载。jar文件:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="3e60" class="mt li it mp b gy mu mv l mw mx">curl -OL <a class="ae my" href="https://github.com/renaissance-benchmarks/renaissance/releases/download/v0.10.0/renaissance-gpl-0.10.0.jar" rel="noopener ugc nofollow" target="_blank">https://github.com/renaissance-benchmarks/renaissance/releases/download/v0.10.0/renaissance-gpl-0.10.0.jar</a></span></pre><p id="e8f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">并运行测试:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="66c0" class="mt li it mp b gy mu mv l mw mx">java -jar renaissance-gpl-0.10.0.jar finagle-http --csv jdk8u242-b08-openj9.csv</span></pre><p id="5bc0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有测试的平均时间(除了这个)是<strong class="js iu">1613</strong>23毫秒。到底好不好？在我装有2.3 GHz Intel Core i9的Mac上的结果是11357 ms。这使得这个LinuxONE系统对于Java来说是一个相当不错的系统！</p><p id="b10f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">s390x的HotSpot JVM运行在解释模式下，在这个基准测试中，它比OpenJ9慢了大约50倍。</p><p id="7eb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以使用RedHat包管理器安装的包<strong class="js iu">Java-1 . 8 . 0-open JDK . s390x:open JDK Runtime Environment 8</strong>会安装较慢的HotSpot JVM。最好使用上面的步骤安装OpenJ9 JVM。</p><h1 id="5614" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">詹金斯</h1><p id="2063" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">Jenkins是一个开源自动化服务器，Jenkins提供了数百个插件来支持构建、部署和自动化任何项目。</p><p id="7db5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当与<a class="ae my" href="https://github.com/zowe/zowe-cli/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> Zowe CLI </a>搭配使用时，它甚至可以用来在z/OS上自动执行任务。</p><p id="716c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将遵循<a class="ae my" href="https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions" rel="noopener ugc nofollow" target="_blank">在Red Hat发行版上安装Jenkins</a>中描述的步骤。</p><p id="c35d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将Jenkins存储库添加到yum repos，并从这里安装Jenkins。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="d83e" class="mt li it mp b gy mu mv l mw mx">sudo wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo</span><span id="e3c4" class="mt li it mp b gy nn mv l mw mx">sudo rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key</span><span id="0964" class="mt li it mp b gy nn mv l mw mx">sudo yum install jenkins</span></pre><p id="7cf5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Jenkins包不知道您的Java在哪里，因此您需要修改Jenkins配置参数:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="98af" class="mt li it mp b gy mu mv l mw mx">sudo vi /etc/sysconfig/jenkins</span></pre><p id="0d57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将<code class="fe nk nl nm mp b">java</code>可执行文件的路径添加到<code class="fe nk nl nm mp b">JENKINS_JAVA_CMD</code>参数中:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="39e7" class="mt li it mp b gy mu mv l mw mx">## Type: string<br/>## Default: ""<br/>## ServiceRestart: jenkins<br/>#<br/># Java executable to run Jenkins<br/># When left empty, we'll try to find the suitable Java.<br/>#<br/>JENKINS_JAVA_CMD="/opt/jdk8u242-b08/bin/java"</span></pre><p id="713d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一步是在防火墙上打开端口8080:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="6045" class="mt li it mp b gy mu mv l mw mx">sudo su</span><span id="4240" class="mt li it mp b gy nn mv l mw mx">firewall-cmd --permanent --new-service=jenkins</span><span id="d1ce" class="mt li it mp b gy nn mv l mw mx">firewall-cmd --permanent --service=jenkins --set-short="Jenkins Service Ports"</span><span id="9a3f" class="mt li it mp b gy nn mv l mw mx">firewall-cmd --permanent --service=jenkins --set-description="Jenkins service firewalld port exceptions"</span><span id="c235" class="mt li it mp b gy nn mv l mw mx">firewall-cmd --permanent --service=jenkins --add-port=8080/tcp</span><span id="66fb" class="mt li it mp b gy nn mv l mw mx">firewall-cmd --permanent --add-service=jenkins</span><span id="fe55" class="mt li it mp b gy nn mv l mw mx">firewall-cmd --zone=public<!-- --> <!-- -->--add-service=http --permanent</span><span id="7e0e" class="mt li it mp b gy nn mv l mw mx">firewall-cmd --reload</span><span id="5b82" class="mt li it mp b gy nn mv l mw mx">exit</span></pre><p id="e31a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您需要安装另一个软件包，以便Jenkins可以启动:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="ecd7" class="mt li it mp b gy mu mv l mw mx">sudo yum install fontconfig</span></pre><p id="ba62" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，您可以启动Jenkins服务:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="1148" class="mt li it mp b gy mu mv l mw mx">sudo service jenkins restart<br/>Starting jenkins (via systemctl): [ OK ]</span></pre><p id="e224" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后就可以打开网址:<a class="ae my" href="http://your-linux-one-ip-address:8080/" rel="noopener ugc nofollow" target="_blank">http://your-Linux-one-IP-address:8080/</a>完成Jenkins安装。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi no"><img src="../Images/434bb4a5ace68b17b25ce21d27c2745f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gY7dUAnti2UZZDnx6Oyd2Q.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">初始Jenkins网页来完成安装</figcaption></figure><p id="1537" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想了解更多关于Jenkins安装的信息，请参见本文档:<a class="ae my" href="https://jenkins.io/doc/book/installing/#setup-wizard" rel="noopener ugc nofollow" target="_blank">https://jenkins.io/doc/book/installing/#setup-wizard</a>。</p><h1 id="69e4" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">摘要</h1><p id="1e36" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">我们已经了解了什么是适合大型机上Linux的JVM，并且已经将Jenkins安装到LinuxONE系统上。</p><p id="1a64" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了Jenkins，您可以自动化许多事情。如果您有兴趣了解如何从另一个平台自动化z/OS上的流程，请学习Zowe CLI。</p><div class="ko kp gp gr kq kr"><a href="https://medium.com/zowe/getting-started-with-zowe-cli-7a29420c6be7" rel="noopener follow" target="_blank"><div class="ks ab fo"><div class="kt ab ku cl cj kv"><h2 class="bd iu gy z fp kw fr fs kx fu fw is bi translated">Zowe CLI入门</h2><div class="ky l"><h3 class="bd b gy z fp kw fr fs kx fu fw dk translated">Zowe CLI用于z/OS，就像AWS CLI用于AWS一样。这是一个客户端CLI，允许访问所有基础架构…</h3></div><div class="kz l"><p class="bd b dl z fp kw fr fs kx fu fw dk translated">medium.com</p></div></div><div class="la l"><div class="np l lc ld le la lf lg kr"/></div></div></a></div><p id="67f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Zowe CLI正在使用Node.js，我们将在未来介绍如何在大型机上安装Node.js，包括Linux和z/OS！</p></div></div>    
</body>
</html>