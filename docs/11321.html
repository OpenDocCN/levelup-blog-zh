<html>
<head>
<title>Transactions in Relational Databases With Postgres Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关系数据库中的事务与Postgres示例</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/transactions-in-relational-databases-with-postgres-examples-256abc44f0b9?source=collection_archive---------21-----------------------#2022-03-07">https://levelup.gitconnected.com/transactions-in-relational-databases-with-postgres-examples-256abc44f0b9?source=collection_archive---------21-----------------------#2022-03-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b6ff" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">什么是数据库中的事务以及如何使用它们！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c272491a594821f13d58dea46ba9d35f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jFk7fGUTBum5tUhX"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯托夫·高尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="82d2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是交易？</h1><p id="7d7e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在数据库的上下文中，事务是一组操作，在事务最终作为一个整体提交之前，这些操作应用于一个或多个表。</p><p id="b120" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">理解这一点非常重要，如果一个事务的一个操作失败，整个事务都会失败，并且会发生回滚来恢复失败事务中应用的更改。</p><p id="2fe2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我用一个基于<strong class="lt iu"> Postgres 13 </strong>的例子来解释这种行为。</p><h1 id="0424" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建表格</h1><p id="1d8e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，我们需要在你想要的数据库中创建一个表，我们把这个表叫做:<strong class="lt iu"> bank_account </strong>。我们将<strong class="lt iu">约束</strong>添加到<strong class="lt iu">平衡</strong>列:</p><p id="bfe4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">余额&gt; = 0</p><p id="b25f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这意味着列<strong class="lt iu">余额</strong>不能小于0。在表<strong class="lt iu"> bank_account </strong>被创建后，我们将插入2行:</p><p id="817d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">埃隆余额100，杰夫余额和我们第一排(埃隆)一样多。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在插入两行中创建一个表。</figcaption></figure><p id="7bdc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的<strong class="lt iu"> bank_account </strong>表现在看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/79d3ccd4546ce42560e1c0437a5d9982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jd5i1w6t66x3FlcT0z6T3g.png"/></div></div></figure><h1 id="d72b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">成功的交易</h1><p id="dc28" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们的第一笔交易中，我们给Elon增加了50英镑的余额，同时我们从Jeff那里扣除了同样的金额。那笔交易成功了，因为杰夫的余额还在50以上，他的余额不会少于0。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">该事务将成功运行。</figcaption></figure><p id="c7a4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们的<strong class="lt iu">银行账户</strong>表将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/7058a9bbb8c065c019820cae9e861dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0SFm1JRRaVkxtRrYP6goQ.png"/></div></div></figure><h1 id="9971" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">失败的事务(带回滚)</h1><p id="6091" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们记得，埃隆的余额是150，而杰夫的余额是50。现在我们做的是非常相似的交易。但是这一次，我们将Jeff的银行帐户余额减少150，同时将Elon的银行帐户余额增加150。</p><p id="ef4b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你能猜到现在会发生什么吗？我们先来看看交易片段。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">该事务将失败并恢复其更改。</figcaption></figure><p id="1e0a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这项交易将<strong class="lt iu">失败</strong>，因为杰夫的余额将少于0。</p><p id="f8ec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是请记住，在交易失败之前，我们已经将Elon的余额增加了150，正如您在上面的交易片段的第2行中所看到的。但是，这一更改不会在最后提交，因为事务在第3行失败了。Postgres将自动执行回滚。所以你不需要自己为此烦恼。</p><p id="0971" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢您阅读我关于关系数据库事务的文章。我希望，我可以刷新你对这个特定主题的知识。</p><p id="afc8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">干杯！</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><p id="3c8c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望你喜欢读这篇文章。如果你愿意支持我成为一名作家，考虑注册<a class="ae ky" href="https://medium.com/@hellokevinvogel/membership" rel="noopener">成为一名媒体成员</a>。每月只需5美元，你就可以无限制地使用Medium。</p><p id="4cc3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">想支持我？<a class="ae ky" href="https://www.buymeacoffee.com/hellokevinvogel" rel="noopener ugc nofollow" target="_blank">给我买杯咖啡。</a></p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="a752" class="kz la it bd lb lc nc le lf lg nd li lj jz ne ka ll kc nf kd ln kf ng kg lp lq bi translated">接下来阅读</h1><div class="nh ni gp gr nj nk"><a href="https://blog.devgenius.io/object-orientated-programming-oop-in-typescript-c1066941f5ee" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">TypeScript中的面向对象编程(OOP)</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">TypeScript对JavaScript中面向对象编程的实现有很大的影响。今天，我想谈谈…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">blog.devgenius.io</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ks nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a href="https://blog.bitsrc.io/node-js-event-loop-and-multi-threading-e42e5fd16a77" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">Node.js事件循环:不是单线程的</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">Node.js、事件循环和多线程</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">blog.bitsrc.io</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny ks nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a href="https://blog.bitsrc.io/how-to-build-a-simple-api-in-typescript-with-nest-js-876386b29753" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">用NestJS (2022)在TypeScript中构建一个简单的API</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">如何在TypeScript中构建NestJS API的简要指南</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">blog.bitsrc.io</p></div></div><div class="nt l"><div class="oa l nv nw nx nt ny ks nk"/></div></div></a></div></div></div>    
</body>
</html>