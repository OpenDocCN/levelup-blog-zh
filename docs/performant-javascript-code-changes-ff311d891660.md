# 高性能 JavaScript —代码更改

> 原文：<https://levelup.gitconnected.com/performant-javascript-code-changes-ff311d891660>

![](img/7a4002124defb7715a07cb49eafde071.png)

哈雷戴维森在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

像任何程序一样，如果我们不小心编写代码，JavaScript 程序会变得很慢很快。

在本文中，我们将研究一些可以加速 JavaScript 程序的代码更改。

# 局部变量

应该尽可能使用局部变量，这样我们就不必在代码中创建大量的全局变量。

全局变量很容易发生冲突，它们总是需要被加载。因此，我们应该避免使用它们。

我们应该用`let`和`const`声明块范围的变量。这样，我们总是知道它们将生活在街区内，我们不必担心它们被吊起，它们在功能的不同部分是可用的。

例如，我们可以编写以下代码来实现这一点:

```
{
  let x = 1;
  const y = 2;
}
```

在上面的代码中，我们创建了一个包含变量`x`和`y`的块，这样它们就不能在块外被访问。

一个块可以是一个普通的块，就像我们上面的一样，也可以是`if`块和循环体。

因此，局部变量不会一直被加载，它们被限制在一个块中。这大大减少了查找变量所需的时间。

# 没有嵌套循环

我们应该尽可能避免嵌套循环。嵌套循环总是很慢，因为我们在外循环的每次迭代中运行内循环。

因此，无论我们对嵌套循环做什么，它都会很慢。

# 缓存对象以提高性能

我们应该将我们的对象缓存在一个变量中，这样它们只生成一次，其他代码将引用该变量，而不是从其他来源生成。

我们在不同的地方重复创造同样的东西是不理想的。

例如，如果我们从 DOM 中获取一个元素，我们不希望每次用它做某些事情时都获取它。DOM 遍历肯定很慢，所以我们不应该经常这样做。

例如，我们应该编写如下内容:

```
document.querySelector('p').style.color = 'red';
document.querySelector('p').style.fontSize = '20px';
```

在上面的代码中，我们有:

```
document.querySelector('p').
```

两次。每次调用`querySelector`时，浏览器都必须遍历 DOM。

这并不好，因为我们必须做两次不必要的工作。

相反，我们应该通过编写以下代码来消除重复并缓存元素的值:

```
const p = document.querySelector('p');
p.style.color = 'red';
p.style.fontSize = '20px';
```

在上面的代码中，我们通过将 p 元素的 DOM 对象赋给 p 常量来缓存它。

然后我们可以在上面设置样式，而不用再次从 DOM 中获取元素。

# 将 JavaScript 放在页面底部

脚本应该放在页面的底部，以便它在我们的 HTML 加载后加载。

这是有意义的，因为它将使页面看起来更具响应性，因为内容是首先加载的，而不是在所有脚本加载之后。

我们还可以在脚本标签上使用`async`和`defer`指令来异步加载脚本。`async`意味着脚本是异步加载的，不需要等待之前的脚本加载。

而`defer`意味着脚本是异步加载的，但它是在前面添加的脚本先加载后加载。

# 最小化 HTTP 请求

最大限度地减少 HTTP 请求是很重要的，因为它减少了我们的代码运行的操作数量，也减轻了我们自己的服务器或其他人的服务器的负担。

因此，我们应该减少 HTTP 请求的数量，这样我们就可以减少发出请求和等待响应的延迟。

![](img/f93376be06facc980aeaf1cd9a24321c.png)

照片由[蒂姆·凯里](https://unsplash.com/@baudy?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

# 结论

HTTP 请求应该最小化，以减少我们的服务器和客户端应用程序的延迟。

嵌套循环总是很慢，所以它们不应该包含在我们的代码中

此外，对象应该被缓存，这样就不会一直从其他来源检索它们。

脚本也应该异步加载，这样加载一个脚本就不会耽误其他脚本。

最后，局部变量减少了在整个应用程序中查找变量的需要，所以我们应该使用它们。我们可以用`let`和`const`来声明它们。