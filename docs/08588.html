<html>
<head>
<title>Explaining The New script Setup Type in Vue 3 — Major Takeaways from the RFC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释Vue 3中新的脚本设置类型RFC的主要优点</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/explaining-the-new-script-setup-type-in-vue-3-major-takeaways-from-the-rfc-e28e561ac57e?source=collection_archive---------12-----------------------#2021-05-14">https://levelup.gitconnected.com/explaining-the-new-script-setup-type-in-vue-3-major-takeaways-from-the-rfc-e28e561ac57e?source=collection_archive---------12-----------------------#2021-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jq jr js jt"><div class="bz fp l di"><div class="ju jv l"/></div></figure><p id="cc09" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">如果你最近一直在使用<a class="ae ku" href="https://learnvue.co/2020/12/setting-up-your-first-vue3-project-vue-3-0-release/" rel="noopener ugc nofollow" target="_blank"> Vite和Vue 3 </a>，你会注意到当你开始一个新项目时，你的脚本部分看起来像这样，在你的Vue组件中有这个语法。</p><figure class="kv kw kx ky gt jt"><div class="bz fp l di"><div class="kz jv l"/></div></figure><p id="ef2e" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">你可能会疑惑，<em class="la">“这是什么？这是选项API吗？作文API？设置方法在哪里？”</em></p><p id="9502" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated"><a class="ae ku" href="https://github.com/vuejs/rfcs/blob/script-setup-2/active-rfcs/0000-script-setup.md" rel="noopener ugc nofollow" target="_blank">&lt;脚本设置&gt;类型是在Vue的Git RFC</a>中提议的变更。需要明确的是，这并不是要完全取代当前任何一种编写代码的方式。它的目的是为开发人员提供一个更简洁的语法来编写他们的单个文件组件。</p><p id="ef04" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">在这篇文章中，我们将看看它是如何工作的，以及它的一些有用之处。</p><p id="935d" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">好吧——我们走。</p><h1 id="e09e" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">脚本设置的概要</h1><p id="2469" class="pw-post-body-paragraph jw jx it jy b jz lz kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt im bi translated">在<code class="fe me mf mg mh b">&lt;script setup&gt;</code>中，我们不必声明一个<code class="fe me mf mg mh b">export default</code>和一个<code class="fe me mf mg mh b">setup</code>方法——相反，<strong class="jy iu">所有的顶级绑定都暴露给模板</strong></p><p id="1b30" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">在Composition API中，我们习惯于创建我们的设置方法，然后返回我们想要公开的任何内容。大概是这样的:</p><figure class="kv kw kx ky gt jt"><div class="bz fp l di"><div class="kz jv l"/></div></figure><p id="dd8a" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">但是有了<code class="fe me mf mg mh b">&lt;script setup&gt;</code>，我们可以像这样重写相同的代码..</p><figure class="kv kw kx ky gt jt"><div class="bz fp l di"><div class="kz jv l"/></div></figure><p id="617d" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">而且不仅仅是数据、<a class="ae ku" href="https://learnvue.co/2019/12/mastering-computed-properties-in-vuejs/" rel="noopener ugc nofollow" target="_blank">计算属性</a>和方法！甚至<a class="ae ku" href="https://learnvue.co/2020/01/creating-your-first-vuejs-custom-directive/" rel="noopener ugc nofollow" target="_blank">导入的指令</a>和我们设置范围顶层的组件在我们的模板中也自动可用。</p><p id="3987" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">看看这个导入组件的例子。</p><figure class="kv kw kx ky gt jt"><div class="bz fp l di"><div class="kz jv l"/></div></figure><p id="063a" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">很神奇，对吧？</p><h1 id="76c3" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">所以…这有什么意义？</h1><p id="c2e7" class="pw-post-body-paragraph jw jx it jy b jz lz kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt im bi translated">长话短说，这种语法使单个文件组件更简单。</p><p id="5170" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">用RFC的原话来说:</p><blockquote class="mi mj mk"><p id="9859" class="jw jx la jy b jz ka kb kc kd ke kf kg ml ki kj kk mm km kn ko mn kq kr ks kt im bi translated"><em class="it">“该提案的主要目标是通过将</em> <code class="fe me mf mg mh b"><em class="it">&lt;script setup&gt;</em></code> <em class="it">的上下文直接暴露给模板来减少sfc中组合API使用的冗长性。”</em></p></blockquote><p id="bebd" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这正是我们刚刚看到的，通过不必担心创建一个<code class="fe me mf mg mh b">setup</code>方法并返回我们想要公开的内容，我们可以简化我们的代码。</p><p id="e962" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">加上<strong class="jy iu">——没有忘记从我们的设置方法中返回一些东西</strong>(我知道我一直在做的事情)。</p><h1 id="5c87" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><script setup="">的更高级用法&lt;/root&gt;</script></h1><p id="44fc" class="pw-post-body-paragraph jw jx it jy b jz lz kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt im bi translated">既然我们知道了even是什么以及它为什么有用，让我们看看它的一些更高级的特性。</p><h1 id="a3ce" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">访问道具，发射事件等。</h1><p id="6fe5" class="pw-post-body-paragraph jw jx it jy b jz lz kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt im bi translated">在Composition API中，这些只是我们设置方法的参数，</p><pre class="kv kw kx ky gt mo mh mp mq aw mr bi"><span id="3dec" class="ms lc it mh b gy mt mu l mv mw">setup (props, context) { // context has attrs, slots, and emit }</span></pre><p id="7934" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">然而，在脚本设置语法中，我们可以从Vue的3个导入中访问这些相同的选项。</p><ul class=""><li id="b9da" class="mx my it jy b jz ka kd ke kh mz kl na kp nb kt nc nd ne nf bi translated"><code class="fe me mf mg mh b">defineProps</code>——顾名思义，允许我们为组件定义道具</li><li id="6788" class="mx my it jy b jz ng kd nh kh ni kl nj kp nk kt nc nd ne nf bi translated"><code class="fe me mf mg mh b">defineEmits</code>——让我们定义组件可以发出的事件</li><li id="1561" class="mx my it jy b jz ng kd nh kh ni kl nj kp nk kt nc nd ne nf bi translated"><code class="fe me mf mg mh b">useContext</code> -允许我们访问组件的插槽和属性</li></ul><figure class="kv kw kx ky gt jt"><div class="bz fp l di"><div class="kz jv l"/></div></figure><p id="14fa" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">有了这3个导入，我们可以获得我们习惯于传统设置方法的功能。</p><h1 id="d928" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建异步设置功能</h1><p id="a670" class="pw-post-body-paragraph jw jx it jy b jz lz kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt im bi translated">脚本设置的另一个很酷的特性是创建一个异步设置函数是多么容易。</p><p id="3de6" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这对于在创建组件时加载API非常有用，甚至可以将代码与<a class="ae ku" href="http://link" rel="noopener ugc nofollow" target="_blank">实验性&lt;悬念&gt;特性</a>捆绑在一起。</p><p id="b990" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">要使我们的设置函数异步，我们所要做的就是在脚本设置中使用一个顶级的await。</p><p id="a1de" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">例如，如果我们正在使用<a class="ae ku" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank"> Fetch API </a>，我们可以像这样使用await</p><figure class="kv kw kx ky gt jt"><div class="bz fp l di"><div class="kz jv l"/></div></figure><p id="e384" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">…我们得到的<code class="fe me mf mg mh b">setup()</code>函数也将是异步的。</p><p id="8a63" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">就这么简单。</p><h1 id="f423" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用普通<script>的&lt;script setup&gt;&lt;/root&gt;</script></h1><p id="1250" class="pw-post-body-paragraph jw jx it jy b jz lz kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt im bi translated"><code class="fe me mf mg mh b">&lt;script setup&gt;</code>为其顶级绑定创建自己的脚本范围。但在某些情况下，有代码规定<strong class="jy iu">必须在模块范围内执行。</strong></p><p id="49e6" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">本RFC中的两个具体示例是…</p><ol class=""><li id="1240" class="mx my it jy b jz ka kd ke kh mz kl na kp nb kt nl nd ne nf bi translated">申报指定出口</li><li id="b65c" class="mx my it jy b jz ng kd nh kh ni kl nj kp nk kt nl nd ne nf bi translated">产生只执行一次的全局副作用。</li></ol><p id="7a90" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这可以通过像这样在脚本设置旁边添加一个普通的<code class="fe me mf mg mh b">&lt;script&gt;</code>块来实现。</p><figure class="kv kw kx ky gt jt"><div class="bz fp l di"><div class="kz jv l"/></div></figure><h1 id="6b19" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">现在你知道了！</h1><p id="d877" class="pw-post-body-paragraph jw jx it jy b jz lz kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt im bi translated">目前，这个脚本设置是自愿加入的，所以如果你想尝试一下，<strong class="jy iu">只需将设置添加到你的脚本标签。</strong></p><p id="5247" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">或者…</p><p id="2fb2" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">如果你不想去想它，只想用你习惯的方式写代码，那就去做吧。选择权在你。</p><p id="00f0" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">要了解更多关于脚本设置的信息，<a class="ae ku" href="https://github.com/vuejs/rfcs/blob/script-setup-2/active-rfcs/0000-script-setup.md" rel="noopener ugc nofollow" target="_blank">这里是完整RFC </a>的链接，包括它的动机、精确语法和更多技术实现。</p><p id="61cf" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">这就是这篇文章的全部内容，我希望它能帮助你弄清楚你的Vite应用程序中的新语法是什么！</p><p id="9355" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated">如果你有任何问题，请在下面的评论中留言！</p><p id="efda" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated"><a class="ae ku" href="https://learnvue.co/vue-3-essentials-cheatsheet/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy iu"> <em class="la">如果你有兴趣了解更多关于Vue 3的知识，请下载我的免费Vue 3备忘单，里面有一些基本知识，比如组合API、Vue 3模板语法和事件处理。</em> </strong> </a></p><figure class="kv kw kx ky gt jt gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/3d50ac4ec6748bd4c29bd83276873799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrcEWyIs1mW7VlM8SvJ6hA.png"/></div></div></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><p id="609b" class="pw-post-body-paragraph jw jx it jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt im bi translated"><em class="la">原载于2021年5月14日https://learnvue.co</em><em class="la"/><a class="ae ku" href="https://learnvue.co/2021/05/explaining-the-new-script-setup-type-in-vue-3-major-takeaways-from-the-rfc/" rel="noopener ugc nofollow" target="_blank"><em class="la">。</em></a></p></div></div>    
</body>
</html>