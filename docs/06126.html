<html>
<head>
<title>Use machine learning to code music in a browser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习在浏览器中编码音乐</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/use-machine-learning-to-code-music-in-a-browser-21249f9cdce5?source=collection_archive---------9-----------------------#2020-10-28">https://levelup.gitconnected.com/use-machine-learning-to-code-music-in-a-browser-21249f9cdce5?source=collection_archive---------9-----------------------#2020-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9140" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Google Project Magenta是如何提升音乐创造力的？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/662d4b48085884c93b9b74ac7011431a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J9l0YJf488pqZxy6xj-qHA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">凯文·麦卡琴在<a class="ae lb" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</figcaption></figure><p id="af43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你知道我们可以用代码创作音乐吗？是的，使用相同的代码行，我们可以创建视觉和听觉效果。这不仅仅是播放音轨，我们还可以自己产生声音。在这种情况下，浏览器将充当合成器的角色！关于网络应用中音乐创作的更多细节，你可以阅读<a class="ae lb" href="https://medium.com/better-programming/frontend-development-sounds-9fe7e5839ab9" rel="noopener">我之前的文章</a>。</p><blockquote class="lc"><p id="d761" class="ld le iq bd lf lg lh li lj lk ll kk dk translated">我认为用代码创作音乐是一件疯狂的事情。我那时很年轻，很天真……(两个月前)。我不知道声音不仅可以由开发人员的代码生成，还可以通过使用机器学习来生成！</p></blockquote><h1 id="0dc1" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">品红. js</h1><p id="d83e" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated"><a class="ae lb" href="https://magenta.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Magenta </a>是一个开源<a class="ae lb" href="https://about.google/" rel="noopener ugc nofollow" target="_blank"> Google </a>项目，它在音乐和艺术创作过程中提供机器学习作为工具。<a class="ae lb" href="https://nsynthsuper.withgoogle.com/" rel="noopener ugc nofollow" target="_blank"> NSynth Super </a>是如何使用洋红色来创造音乐创造力的惊人工具的一个例子。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Magenta库使用案例— NSynth Super</figcaption></figure><p id="3a04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://magenta.tensorflow.org/js-announce" rel="noopener ugc nofollow" target="_blank"> Magenta.js </a>是上述项目的一个子集，它提供Javascript API在浏览器中使用Magenta模型。在引擎盖下，它由另一个著名的面向Javascript用户的机器学习库提供支持— <a class="ae lb" href="https://www.tensorflow.org/js/" rel="noopener ugc nofollow" target="_blank"> Tensorflow.js </a>，它允许快速的GPU加速推理。</p><p id="1c2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Magenta.js被分发到几种类型的库:</p><ul class=""><li id="4740" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><a class="ae lb" href="https://github.com/magenta/magenta-js/tree/master/music" rel="noopener ugc nofollow" target="_blank">/音乐</a> —基于音符的模型包括<a class="ae lb" href="https://magenta.github.io/magenta-js/music/classes/_music_vae_model_.musicvae.html" rel="noopener ugc nofollow" target="_blank"> MusicVAE </a>、<a class="ae lb" href="https://magenta.github.io/magenta-js/music/classes/_music_rnn_model_.musicrnn.html" rel="noopener ugc nofollow" target="_blank"> MelodyRNN </a>、<a class="ae lb" href="https://github.com/magenta/magenta/tree/master/magenta/models/drums_rnn" rel="noopener ugc nofollow" target="_blank"> DrumsRNN </a>、<a class="ae lb" href="https://github.com/magenta/magenta/tree/master/magenta/models/performance_rnn" rel="noopener ugc nofollow" target="_blank"> PerformanceRNN </a>和<a class="ae lb" href="https://github.com/magenta/magenta/tree/master/magenta/models/improv_rnn" rel="noopener ugc nofollow" target="_blank"> ImprovRNN </a></li><li id="186e" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="https://github.com/magenta/magenta-js/tree/master/sketch" rel="noopener ugc nofollow" target="_blank">/草图</a>—草图(绘图)模型，包括<a class="ae lb" href="https://goo.gl/magenta/sketchrnn" rel="noopener ugc nofollow" target="_blank"> SketchRNN </a></li><li id="71ac" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="https://github.com/magenta/magenta-js/tree/master/image" rel="noopener ugc nofollow" target="_blank">/图像</a> —图像风格转换模型</li></ul><blockquote class="lc"><p id="09c5" class="ld le iq bd lf lg ng nh ni nj nk kk dk translated">如果这些缩写没有给你敲响警钟，不要担心，继续前进。</p></blockquote><h1 id="23e4" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">如何在web应用中使用Magenta.js？</h1><p id="f5ce" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">我将展示如何在简单的web应用程序中使用Magenta.js提供的机器学习功能。本文主要关注基于音符的模型。出于演示的目的，我使用的是Angular框架。然而，这种设置与任何其他前端框架甚至普通的JavaScript都没有什么不同。</p><h2 id="444f" class="nl lo iq bd lp nm nn dn lt no np dp lx jy nq nr mb kc ns nt mf kg nu nv mj nw bi translated">初始设置</h2><ol class=""><li id="d9ac" class="ms mt iq jp b jq ml ju mm jy nx kc ny kg nz kk oa my mz na bi translated">使用<a class="ae lb" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>创建一个新的Angular app:</li></ol><pre class="km kn ko kp gt ob oc od oe aw of bi"><span id="cb8b" class="nl lo iq oc b gy og oh l oi oj">npm install -g @angular/cli<br/>ng new ai-music</span></pre><p id="4c23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.安装<a class="ae lb" href="https://www.npmjs.com/package/@magenta/music" rel="noopener ugc nofollow" target="_blank"> @magenta/music </a>库:</p><pre class="km kn ko kp gt ob oc od oe aw of bi"><span id="a44c" class="nl lo iq oc b gy og oh l oi oj">cd ai-music<br/>npm install @magenta/music</span></pre><p id="ae80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.使用以下工具构建和服务您的应用:</p><pre class="km kn ko kp gt ob oc od oe aw of bi"><span id="63c9" class="nl lo iq oc b gy og oh l oi oj">ng serve</span></pre></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h2 id="8840" class="nl lo iq bd lp nm nn dn lt no np dp lx jy nq nr mb kc ns nt mf kg nu nv mj nw bi translated">播放指定的歌曲</h2><p id="b06c" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">在初始化<code class="fe or os ot oc b">AppComponent</code>的过程中，我使用Magenta库创建了<code class="fe or os ot oc b">Player</code>元素。用户的<code class="fe or os ot oc b">click</code>事件将发起在浏览器中播放一首著名的代表作——<a class="ae lb" href="https://www.youtube.com/watch?v=sh9wsrL43RY&amp;ab_channel=MusicGuide" rel="noopener ugc nofollow" target="_blank">跳转歌曲</a>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ou mr l"/></div></figure><p id="5700" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ov mr l"/></div></figure><p id="c47a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">音符以一种特定的格式描述，这种格式显示了应该演奏什么样的音高以及在什么特定的时间演奏。音符的音高在MIDI键号中指定。你可以在这里找到数字是如何映射到频率<a class="ae lb" href="https://www.inspiredacoustics.com/en/MIDI_note_numbers_and_center_frequencies" rel="noopener ugc nofollow" target="_blank">的。顺便提一下，我建议您将注释移动到单独的常量文件中，以保持组件的整洁。</a></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ou mr l"/></div></figure></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h2 id="45f3" class="nl lo iq bd lp nm nn dn lt no np dp lx jy nq nr mb kc ns nt mf kg nu nv mj nw bi translated">请艾继续一首歌</h2><p id="dab2" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">目前，我们不使用任何预先训练的模型——我们正在演奏指定的音符。让我们使用一个洋红色模型来继续之前使用的跳转歌曲。在接下来的例子中，我将从<strong class="jp ir"> basic_rnn </strong>检查点创建一个模型。您可以在此找到所有托管的检查点<a class="ae lb" href="https://goo.gl/magenta/js-checkpoints" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ou mr l"/></div></figure><p id="023c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，根据提供的检查点初始化递归神经网络模型<code class="fe or os ot oc b">musicRNN</code>。请注意，有时这可能需要几秒钟的时间！🤷🏻‍♀️之后，我们可以要求继续跳这首歌。我们之前以未量化的格式(以秒为单位)描述了音符的特征，但是对于<code class="fe or os ot oc b">musicRNN</code>模型，我们应该以量化的格式(以步为单位)构建它们。你可能会问艾怎么可能继续跳歌？检查几次尝试:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ov mr l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ov mr l"/></div></figure><p id="9f66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们不能确定会返回什么确切的结果，一个旋律永远是唯一的。另一方面，有3个主要参数用于控制结果:</p><ul class=""><li id="f8cc" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><code class="fe or os ot oc b">steps</code> —持续时间测量，值越大，结果越长</li><li id="3e3e" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe or os ot oc b">temperature</code> —随机化权重，其中较高的值结果导致与所提供的原始旋律的偏离程度较高(在音符音高、长度、力度、主题等方面)。)</li><li id="a3b6" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe or os ot oc b">stepsPerQuarter</code> —速度估计，较大的值会增加结果的BPM(每分钟节拍数)</li></ul><p id="2bd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了比较，我将<code class="fe or os ot oc b">steps</code>改为30、<code class="fe or os ot oc b">temperature</code>改为10、<code class="fe or os ot oc b">stepsPerQuarter</code>改为6，结果是这样的:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ov mr l"/></div></figure><p id="47b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我想提一下Typescript用户的一个<a class="ae lb" href="https://github.com/tensorflow/tfjs/issues/2007#issuecomment-529630217" rel="noopener ugc nofollow" target="_blank">问题</a>，这个问题可以通过启用编译器选项“skipLibCheck”(快速而麻烦的解决方案)或者通过手动安装缺少的类型(更健壮且耗时的解决方案)来解决。</p><blockquote class="lc"><p id="ad9b" class="ld le iq bd lf lg lh li lj lk ll kk dk translated">总的来说，这个库非常新，几年前才发布，所以在我写作的时候可能会引入一些修正和新特性。</p></blockquote></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h2 id="20e8" class="nl lo iq bd lp nm nn dn lt no np dp lx jy nq nr mb kc ns nt mf kg nu nv mj nw bi translated">释放人工智能创造自己的摇滚</h2><p id="044a" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">另一个称为变分自动编码器<code class="fe or os ot oc b">musicVAE</code>的Magenta模型不需要提供任何注释，但结果是，给出了重建输入数据的新序列。在下面的例子中，我使用<strong class="jp ir"> mel_4bar_small_q2 </strong>检查点初始化模型。之后，我可以通过指定序列的计数和控制温度来请求一个结果。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ou mr l"/></div></figure><p id="c2ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">听起来像什么:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ov mr l"/></div></figure><p id="07a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过将检查点更新为<strong class="jp ir"> groovae_4bar </strong>，结果将会发生巨大变化:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ov mr l"/></div></figure></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h1 id="a656" class="ln lo iq bd lp lq ow ls lt lu ox lw lx ly oy ma mb mc oz me mf mg pa mi mj mk bi translated">摘要</h1><p id="5d2d" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">老实说，从不同的洋红色模型提供的结果可能有点远离你最喜欢的音乐…但它也可能产生一些令人惊讶的好样本！看看这件洋红色杰作:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="60fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">音乐产业已经被科技塑造<a class="ae lb" href="https://www.music.org/index.php?option=com_content&amp;view=article&amp;id=2675:the-impact-of-technology-on-the-musical-experience&amp;catid=220&amp;Itemid=3665" rel="noopener ugc nofollow" target="_blank">。机器学习只是一种新的工具，可以提高音乐创造力，使音乐创作过程更快更容易。</a></p><h1 id="9177" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly pb ma mb mc pc me mf mg pd mi mj mk bi translated">奖金</h1><p id="7080" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">你有没有想过成为顶尖的钢琴演奏者是什么感觉？即使你没有，你也需要试试<a class="ae lb" href="http://piano-genie.glitch.me/" rel="noopener ugc nofollow" target="_blank">钢琴精灵</a>。机器学习会让你相信你是一个🎹名家！</p><p id="ba40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果钢琴乐器对你来说太无聊，你也应该试试<a class="ae lb" href="https://www.youtube.com/watch?v=HGWkQP9lVPw&amp;ab_channel=Google" rel="noopener ugc nofollow" target="_blank">玩水果</a>！</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="c299" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="pe">感谢您的阅读。你有过音乐编码或者洋红库的经验吗？我很想听听你的冒险经历！🤘</em></p></div></div>    
</body>
</html>