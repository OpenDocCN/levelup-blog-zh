# 创建我们的测试虚拟机

> 原文：<https://levelup.gitconnected.com/creating-our-test-vms-5d3b239f665a>

## 为 Windows 和 Linux 环境创建基本虚拟机

在本出版物中，我们将制作 2 个虚拟机，一个使用 Windows (Server 2016，仅 180 天评估版)，另一个使用 Linux (CentOS 7)。

我这样做的原因是，有很多人不知道如何安装操作系统。这本指南将帮助他们了解如何去做。

我知道外面有很多指南。但是在这里，一旦我们进入下一章，如果我发现需要修改的地方，我可以跟踪并更新指南。

## 我可以从哪里下载操作系统映像来进行安装？

对于 **Windows** ，你可以从微软评估中心([链接](https://www.microsoft.com/es-es/evalcenter/))搜索正确的 ISO。在这里，您还可以找到许多其他评估工具。但是我们现在感兴趣的是 Windows 服务器 ISOs。

![](img/e24c94d4ad549468d21a18f41793a93a.png)

在这里，我们选择“查看全部”选项。

![](img/a35be1be18d84c5e4326708081fe77c7.png)

这里我们选择 ISO 图像。

一旦我们点击这里的继续按钮，我们将需要完成一些信息，然后微软将离开我们下载 ISO 映像。

对于 **Linux** ，我们去 CentOS 下载中心([链接](https://www.centos.org/download/))。由于 CentOS 的当前版本是 8，我们需要选择下载旧版本。然后选择 CentOS 7 镜子。

![](img/8ecd2cba84950ac6a71bc6cf17fadf83.png)

“点击这里”是一个好迹象。

![](img/ed794b1f50f288d61ec56da3309ca3f2.png)

在这里，我们点击 CentOS 7 版本的镜子。

![](img/735e5eab792708606f8d76291703ba0d.png)

一旦你点击镜像链接，你会看到可供下载的替代品。

![](img/69bec3c2957436bc09e71a6e390882a8.png)

我在这里的建议是使用 DVD-1908.iso 甚至最小的-1908.iso。

下载安装程序后，您就可以开始创建虚拟机了。

# 为我们的实验室创建虚拟机

在这两种情况下，我们的初始配置都是双核 CPU、8gb RAM 和一个 50 GB HDD (60 GB 用于 Windows VM 设置)。这将帮助我们毫无问题地安装操作系统，并且我们可以制作一个起始映像，以便在其他情况下重新部署以进行测试。

*注意:我将向您展示如何在 VMware 工具上设置虚拟机。您需要将这些设置转移到您首选的虚拟机管理程序。*

![](img/f1b4b6e696a0317b0fcfb8d08ac7e13b.png)

我们将走捷径…

![](img/b2894b08e3d367b8f45677e822fa782b.png)

选择“典型”设置(我们将在创建好一切后定制虚拟硬件)。

![](img/8c6094dc0ca345f75c3f6ae9f28c296d.png)

由于我们要创建 2 个虚拟机，因此我们将选择“稍后安装操作系统”选项。

![](img/4084e126a8f85d62c6c3b04d3ef67cc4.png)

Windows 的版本…

![](img/16158a6bd9d4dadde8dbbbd7eb2354b5.png)

以及我们将要安装的 Linux 版本。

![](img/a5d6bd111220a53ae8e12f2049f34580.png)

只是一个简单的虚拟机名称，没什么复杂的。

![](img/fc4c3676f862c2aee56059b5a3d36d44.png)

Linux 硬盘的建议大小是 20 GB，但我们将把它改为 50 GB。Windows Server 默认值为 60 GB，无需更改。

![](img/ac3bf2f48072e9c30f38d3c34e0f6145.png)

最后，我们看到一些设置是默认值(CPU、RAM、网络)。我们将在接下来的步骤中更改其中的一些。

![](img/38793e55a2adba69e902e408059a277d.png)

在此预览中，我们看到创建了两个虚拟机。下一步是定制一些默认设置。

![](img/b8d731d18204d1ef06360d2fce565eb4.png)

在这里，我们从默认设置中删除了声卡和打印机(对于我们将要做的事情，我们不需要它们)，然后我们将 RAM 的数量增加到 8 GB，并将 CPU 核心数增加到 2 (1 个处理器/ 2 个核心)。

![](img/06a0e8cf53378f204dd6832efc039c56.png)

设置页面的最终结果应该是这样的。

我们没有修改任何关于网络适配器的设置，也没有修改虚拟机的硬盘数量。由于这将是我们所有 Windows 和 Linux 测试的基础机器，我们将安装操作系统并导出机器以获得虚拟机的启动映像。

接下来的步骤是安装 Linux 和 Windows。

# 安装 Linux CentOS 7

安装 Linux 并不难。但是如果你在这里，你可能仍然需要一些帮助。这就是这篇文章存在的原因。

第一步是为安装选择正确的 ISO(显然是我们从 CentOS 推荐的镜像列表中下载的那个)。为此，我们需要编辑设置，选择 CD/DVD 设备，然后更改配置以选择我们从网上下载的 ISO。

![](img/1d221bc4956750fc5d4c567fa62a7770.png)

选择后，启动虚拟机，然后选择安装操作系统。

![](img/5f76229b64514a4ee3309998fdfcdc2d.png)

一旦安装程序加载了所有东西，第一件事就是选择你的语言。

![](img/159947ac48e9119f082f2a68480c05e5.png)

为了简单起见，我们将选择英语作为操作系统语言。

![](img/90938fc03eb16553e81ef7f870b6adff.png)

设置页面非常简单。在这里，我们要做的是设置网络信息，日期和时间设置，然后选择安装软件。

![](img/c19cc864223ced41bf66093f28806edd.png)

默认情况下，网络是关闭的。我们把它改成开。

![](img/765f2c03551f84c2940d1b47de374250.png)

VMware DHCP 服务器根据虚拟机设置分配 IP(目前，我们的网络适配器正在 NAT 配置中工作)。

![](img/33e8538c3b55ef9a987542012d5c19d8.png)

我们编辑主机名和域，然后应用更改。

一旦我们点击了左上方的*完成*按钮，我们继续更改*日期&时间*设置。

![](img/dcb8ab90d1769ebc926e4eebdae69017.png)

我所在的地方是南美洲的中心。

在这个屏幕中，我们启用了网络时间，因此机器将始终保持时间同步(设置 NTP 服务器很好…我没有这样做)。

好吧…继续…

![](img/d82b9c6da39e487f3c5d52934ee0781c.png)

在软件选择页面，我们将选择*最小安装*，并启用一些插件。

通过这些设置，默认情况下，系统将在没有 GUI(只有控制台)的情况下工作。不用担心，我们将在安装完成后安装 GUI(但我们不会默认启用它，它将被禁用，如果需要，您将需要运行一个命令来启动桌面环境)。

![](img/59c634f3c24536263df01a815636eb28.png)

继续安装操作系统之前的最后一步是选择分区配置。这次我们将保留默认的“*自动*”选项。

一旦完成，我们点击*完成*，然后，点击*开始安装*按钮。

![](img/c7724bf462c33e15d68ed9f78c124082.png)

在这个屏幕上，我们看到最后两个要定义的设置:*根密码*和*用户创建*。

![](img/446bc1739555fc25bbda32e3726a4f06.png)

对于根通道，选择一个您将来会记住的通道

![](img/11140b3f3687c250ec1f49349084ff58.png)

我知道，这是用户的陈词滥调…

对于用户，我们选择使用户成为管理员的选项，并为帐户设置密码。

![](img/70516df0a979d102d150484ae9a5323e.png)

安装完成后，我们重新启动虚拟机。

![](img/8b65de8b7b0ab63751e9053e1e1cea96.png)

一旦我们选择了内核并登录，我们就可以测试连通性了。

![](img/a9926c2eeb1912bb2cbbfa9a6d437af0.png)

到目前为止一切正常。下一步是运行更新命令。

*注意:要运行该命令，用户需要是* ***root*** *或者拥有* ***sudo*** *权限。感谢选择让我们创建的用户成为管理员组的一部分，他有权运行****sudo****。*

![](img/3a8393ebc804af1996c78c9fc082c4d9.png)

该命令将列出需要更新的包，甚至是安装包(这可能是一个依赖项或类似的东西)。

你输入 *Yes* ，安装就会运行。

![](img/6050db710c5ff64614e000ba21899a8c.png)

一切都安装得很好，没有问题，甚至我们同时得到了一个内核更新。因此，我们将再次重启系统。

![](img/1b3a16566d824261171c6e8f6a3c1737.png)

新内核可用:)

本指南不会就此结束，因为正如我之前承诺的，我们将安装 GUI，以“按需”运行。

## 安装 GUI

安装 GUI 很简单，但是需要一些时间。您只需要运行命令来安装带有 GUI 组的*服务器:*

> sudo yum 集团安装“带 GUI 的服务器”

![](img/51a5fc182acc77281631e03164dba16c.png)![](img/dfae584357d2bd69711f4ce308e700ad.png)

这需要一段时间…

一旦您键入 *Yes* ，GUI 组件及其依赖项将被安装。

![](img/7c2908f4f9ca75a6db2e8160eb7e10f0.png)

默认情况下，此安装的 GUI 不会在启动时运行。如果您想运行它，只需键入以下命令:

> sudo system CTL isolate graphical . target

![](img/548c24310667d799a31a8377a2944111.png)

如果一切正常，您将在虚拟机上看到以下屏幕。

![](img/ba9a92e81efcceea12870627ec401c5b.png)

## 修复我们之前没有配置的 NTP

这是我的错…我不想再为此安装操作系统…所以我们将通过命令行安装和配置 NTP 客户端:)

首先，我们将安装 NTP 服务。

> sudo yum 安装 ntp

![](img/fbbd8751fdb725cf49a44356eca1e041.png)

安装完成后，如果我们看到 ntp.conf 文件，就会看到 CentOS NTP 服务器池中的一些服务器。您可以在这里添加更多的服务器。您可以在 [NTP Pool 项目](https://www.ntppool.org/)站点中看到您所在地区的一些服务器列表。

因为我来自南美，所以我将把一些地区服务器添加到 ntp.conf 文件中。

为了编辑文件，我们运行下一个命令。

> sudo vim /etc/ntp.conf

然后，为了将这些行添加到文件中，我们按下键盘上的 *INS(ERT)* 键。我们用一个 *#* 符号将原始行标记为注释。

一旦我们完成了编辑，我们按下 Esc 键，为了保存更改，我们编写命令 *:wq(编写& Quit)。VIM 迷你教程结束-* 😉

![](img/35630ba3d6dceacacb7b93350c9ee9fa.png)

更改之后，我们需要重新启动 NTP 守护程序。

为此，我们将运行下面的命令。

要启动 NTP 守护程序:

> sudo systemctl 启动 ntpd

要在启动时启用 NTP 守护程序:

> sudo systemctl 启用 ntpd

要检查 NTP 守护程序的状态:

> sudo 系统控制状态 ntpd

![](img/1ac64fb738e3f806bad8f1a8bf01ef65.png)

完成 NTP 配置后，我们将导出该虚拟机，为将来的实验创建基础映像。

## 导出虚拟机

对于此任务，您需要选择虚拟机，然后在菜单上选择*导出到 OVF* 。

![](img/040eb0e8272f533b43f65314b8d49eb8.png)

这将显示一个*保存对话框*窗口。一旦你选择了路径，点击*保存*按钮，过程将开始。

*注意:记住卸载/取消选择我们用来进行安装的 ISO 映像，因为导出会尝试创建该映像的副本，作为运行 VM 所需的依赖项。*

![](img/2add1a42f5f83098b9234a8b8f1a9fcb.png)![](img/89c7dbd297bc88e02ae6e56286dd9069.png)

当一切完成后，您将会在您选择的路径上看到文件。

![](img/88b6cc7cab6501a6a20f572505333e6e.png)

好了，这对于 Linux 来说已经足够了，现在是时候安装 Windows Server VM 了。

# 正在安装 Windows Server 2016

在这一部分，我们将使用从微软评估中心下载的 Windows Server 2016 ISO 来创建一个虚拟机。

与上一节一样，我们选择虚拟机并编辑它们的设置，将 CD/DVD 虚拟设备与操作系统安装程序的 ISO 映像相关联。

![](img/bbb8f18d39c61e74fa0440a660021892.png)

启动虚拟机后，安装程序会提示您按键。一旦按下，安装程序将开始。

![](img/0a78cd015aecb6747bdd4db577083a35.png)

你需要在虚拟机内部点击并快速按键。

![](img/7ee8deb5d1ba207a25c1431a1534fbb3.png)![](img/319cecba4d75f83702a0ac6897d509bd.png)

在这里，我们选择语言、格式和键盘分布，然后按下*下一个*按钮。

![](img/fbdbdf6ee6385824df0ac528bcbcc01d.png)

在这里，点击立即安装。

![](img/89ee8e0786ce2f0484ea2acecd9dc002.png)

对于此安装，我们将选择具有桌面体验的标准评估。对于我们的使用来说，标准和数据中心之间的差异可以忽略不计。

![](img/a0f740e4ff1ad30b92bf38a6cf6e3fa9.png)

在这里，我们“阅读”许可条款…😉

![](img/b99ab66b2a3c1cd5c5c29e05eb9cea36.png)

对于此安装，我们需要选择仅安装 Windows。

![](img/98cd3d76abd349cc01735d2ef030de59.png)

与 CentOS 安装一样，这里我们让操作系统自动对虚拟驱动器进行分区。

单击“下一步”后，安装过程将开始。

![](img/2456169e68877dd233b5119189259612.png)![](img/1e642739887a782a2a670312eb7a8194.png)

几分钟后…

![](img/e43b9304aab925d8c9a1e71dcda7e350.png)

最后一步是为虚拟机设置管理员密码。

确认通过后，我们将看到 Windows Server 2016 虚拟机的锁定屏幕。

![](img/8a2a6dd893df5a5c4ab5d0735979bf5c.png)

Tadaaaaaaaaaaaaaaaaaaa！！！！！。

当您登录时，您将看到管理员控制面板，其中包含一些信息。我们将跳过这一部分，直接进入新控制面板上的一些设置。

![](img/086c81459b54a2d48bcf67b82c1e80a3.png)

与 Linux VM 一样，我们将系统配置为自动设置时间和时区。下一步是更新计算机名。

![](img/a782b7f4890e65008d3cdc2ff25afc14.png)

对于此更改，您需要重启电脑，但我们将选择稍后重启。

Linux 虚拟机会自动安装 Open VM 工具(与 VMware 产品兼容)，我们不需要额外的安装步骤。

但是对于 Windows，您需要在来宾操作系统上安装 VMware 工具，以使他与主机操作系统无缝协作。

安装 VMware 工具非常简单。在虚拟机运行的情况下，右键单击选项卡，并在菜单上检查安装组件的选项。

![](img/e14305d466be6e5c1463b72b72e51ca7.png)

单击此选项后，驱动器将被装载并可在虚拟机内部访问。

![](img/c21bbfcbe91fd5007367d19a20e23b5b.png)

在这里，我们双击 DVD 驱动器，安装程序将自动启动。

![](img/df3396c485ecf1c3e53970103ca5560f.png)![](img/b914cb3603904a2c7e5667456df08fa5.png)

完整，因为我们不知道我们的虚拟机将来会在哪里结束。😄

![](img/4026c605eb3ca05cb46a03dffc74839a.png)

下一个下一个下一个哦！现在正在安装。

![](img/5b0797537631b9fa87916c19a52d8d4a.png)

一旦完成，我们重新启动系统。我们将看到如何使用工具中所有可用的屏幕空间来打开 VM。

对于此 Windows 安装，下一步是运行 Windows 更新。

![](img/caccb5cb82eb0db4e3619877b25225a0.png)

一旦更新完成，您重新启动并检查一切正常，我们就关闭系统，并且，与 Linux VM 一样，我们将导出 VM 以拥有用于未来项目的基础映像。

## 将虚拟机导出到 OVF。

与 Linux 一样，关闭虚拟机，单击列表中的名称，然后在主菜单上，单击导出到 OVF。

一旦*保存对话框*出现，选择创建文件的最终路径，点击*保存*按钮。

![](img/b0f174de4e970dd81faafbe6f8336b23.png)

当导出结束时，您将在您选择的位置看到文件。

![](img/c8c9318dc358d3c98a8b02decb066d6d.png)

这个虚拟机有点…重…

最后，一些结束语…

# 我们将对这些虚拟机做很多事情…说真的…

我创建了许多虚拟机来测试一些工具。最新的是要测试的虚拟机:

*   域控制器。
*   集群。
*   SQL Server。
*   PostgreSQL。
*   Cloudera Hadoop。

您也可以使用这些虚拟机来测试您想要的一切。

我今天没有展示最有用的技巧(快照)，但是一旦你了解了它，你就会爱上它…但是请记住，我们将看到的大多数技巧只适用于我们的测试实验室，我不鼓励你在生产环境中使用它们。不不不。

今天就这些了，下周见。