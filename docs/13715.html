<html>
<head>
<title>Integrate APIs in Next.js with Redux and Axios: 10-step guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Next.js中的API与Redux和Axios集成:10步指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/integrate-apis-in-next-js-with-redux-and-axios-10-step-guide-3d20a2bc9365?source=collection_archive---------0-----------------------#2022-09-30">https://levelup.gitconnected.com/integrate-apis-in-next-js-with-redux-and-axios-10-step-guide-3d20a2bc9365?source=collection_archive---------0-----------------------#2022-09-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="2b3d" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在本文中，我将介绍如何通过简单易懂的步骤在应用程序中建立一个标准的redux存储来进行API调用。</p><p id="bcfb" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在本文中，我将介绍:Next.js中的项目设置，从头实现redux store，React-Bootstrap的基本UI增强(可选部分)。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/b915d0cc25ef45c8f041278a53cf19d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eFCQqK9F3CyytUMQT0NWEg.jpeg"/></div></div></figure><p id="cf87" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">Redux是一个开源的javascript状态管理工具。当我们在应用程序中提到redux时，人们首先会想到与之相关的样板文件。如果我们是诚实的，那么是的，redux确实有很多样板文件。然而，如果我们能够在开发过程中很好地管理这些复杂性，那么redux对于我们的前端应用程序来说是一个非常方便的工具。</p><p id="1ee5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated"><strong class="jt ir">注意:</strong>对于API，我将使用我在我的<a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/datasource-in-typeorm-a-new-way-to-connect-to-your-database-cdc6622f9bbc">上一篇文章</a>中创建的现有express项目。它由一个足球运动员API和四个端点组成，用于获取、发布、上传和删除请求。要设置你的项目，你可以参考我的文章— <a class="ae le" href="https://medium.com/geekculture/setting-up-a-node-js-project-environment-with-express-js-and-typescript-best-practices-284cc37c5aa1" rel="noopener">用express.js和typeScript设置node.js项目环境:最佳实践</a></p></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h2 id="54b9" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤1:next . js中的项目设置。</h2><p id="bde3" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">我将使用typescript来设置我们的Next.js应用程序。但是在这样做之前，请确保您的系统上安装了node和npm。您可以通过在终端中运行以下命令来实现这一点:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="2555" class="lm ln iq ml b gy mp mq l mr ms">node -v // Checks the version of node.js installed<br/>npm -v // Checks the version of npm installed</span></pre><p id="133b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">如果您没有安装它，您可以从这里安装<a class="ae le" href="https://linuxize.com/post/how-to-install-node-js-on-ubuntu-20-04/" rel="noopener ugc nofollow" target="_blank">(对于Linux系统)</a>和从这里安装<a class="ae le" href="https://phoenixnap.com/kb/install-node-js-npm-on-windows" rel="noopener ugc nofollow" target="_blank">(对于Windows系统)</a>。对于任何使用yarn的人，您可以运行以下命令:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="3df6" class="lm ln iq ml b gy mp mq l mr ms">yarn -v // Checks the version of yarn installed</span></pre><p id="259c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated"><strong class="jt ir">注意:</strong>为了安装所有的依赖项，我将使用yarn。你可以自由使用npm来安装我们在这个项目过程中需要的所有依赖项。你可以从这里<a class="ae le" href="https://linuxize.com/post/how-to-install-yarn-on-ubuntu-20-04/" rel="noopener ugc nofollow" target="_blank">(对于Linux系统)</a>和这里<a class="ae le" href="https://phoenixnap.com/kb/yarn-windows" rel="noopener ugc nofollow" target="_blank">(对于Windows) </a>安装yarn。</p><p id="8c8b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">之后，我们将在next.js中创建我们的应用程序，并用typescript初始化它。在您的终端中执行以下代码行:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="ae63" class="lm ln iq ml b gy mp mq l mr ms">yarn create next-app --typescript</span></pre><p id="799c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">在运行这个命令时，你会被询问一些基本的权限，以及诸如你的应用程序的名称等问题。完成后，您的应用程序就可以使用了。</p><p id="042b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">我们现在将对next.js默认提供的标准项目结构进行一些更改。以下是标准结构:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2fe9e1a970fe69b97239443207af14ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*r50ZEmz-AxRy5Lx08Sqb_Q.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">带有TypeScript标准项目布局的Next.js</figcaption></figure><p id="a450" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">从<strong class="jt ir">‘pages’</strong>文件夹中，删除名为<strong class="jt ir">‘API’</strong>的文件夹，因为我们不会在任何地方使用它。同时，在你的项目结构的根目录下创建一个名为<strong class="jt ir">‘src’</strong>的文件夹。然后只需将<strong class="jt ir"> pages文件夹移到‘src’</strong>中。在<strong class="jt ir">‘src’</strong>文件夹中，再创建两个名为<strong class="jt ir"> components </strong>和<strong class="jt ir"> state </strong>的文件夹(我将在本文的后面部分介绍这些文件夹的重要性)。完成这些步骤后，我们的新项目结构就可以使用了。现在，您可以通过执行以下操作来启动服务器:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="237d" class="lm ln iq ml b gy mp mq l mr ms">yarn run dev</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi my"><img src="../Images/85e05137fc6e42ae77db9713e08ed064.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*esBmHNZNWlOjsd2ts7C1dQ.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">修改的项目结构</figcaption></figure><h2 id="22fd" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤2:安装依赖项。</h2><p id="933e" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">我们现在将安装一个依赖项列表，我们将在需要时在整个应用程序中使用它。</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="c080" class="lm ln iq ml b gy mp mq l mr ms">yarn add redux // Adds redux as a dependency<br/>yarn add react-redux // Adds react-redux to our project<br/>yarn add axios // Axios will be used to make API calls<br/>yarn add redux-thunk // Adds redux-thunk</span></pre><p id="f27d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">注意，这里我们安装了redux-thunk。Redux-Thunk是一个中间件，它允许我们返回函数，而不仅仅是用Redux返回普通的动作。这个中间件用于处理异步动作。这些都是我们需要的依赖。</p><h2 id="33c7" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤3:创建操作。</h2><p id="f8fe" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">在redux中，动作在我们希望商店实现的目标中起着关键作用，这一点我们将在后面定义。动作基本上是简单的对象，返回一个带有两个<strong class="jt ir">键值对的对象，即类型和有效负载</strong>。您定义的任何操作都需要导出以供将来使用。</p><p id="175a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">在<strong class="jt ir">‘state’</strong>文件夹内创建一个名为<strong class="jt ir">‘actions’</strong>的新文件夹。在这个文件夹中，我们创建了一个名为<strong class="jt ir"> 'footballerActions.ts' </strong>的新文件。在该文件中，您可以粘贴以下代码:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="a3ef" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">这里我定义了三个不同的动作来获取数据，创建新的球员数据和更新现有的球员数据。这些动作将被称为reducers的东西访问。请注意，我用附加参数填充了payload属性，我们将在进行API调用时设置这些参数的值。</p><h2 id="90d7" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤4:创建减速器:</h2><p id="03f7" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">redux中的redux函数从您已经定义的动作(参见第3步)和应用程序的先前状态中获取动作类型和有效负载，并返回您的状态的新实例。我们将返回到<strong class="jt ir">‘src’</strong>中的【T22’‘state’文件夹，并创建一个名为<strong class="jt ir">‘reducers’</strong>的新文件夹。在这个文件夹中，我们将创建一个名为<strong class="jt ir">' footballers reducers . ts '</strong>的新文件。您可以复制下面提供的代码来初始化您的缩减器:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="7a56" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">为了实现一个缩减器，我们定义了一个初始状态，在由于某种错误而无法设置或找到新状态的情况下，可以访问这个初始状态。缩减器接受两个参数，初始状态和动作。根据所提供的动作类型，我使用switch case语句来执行reducer中的某些功能。您也可以使用if-else语句来创建您的reducer。我们将<strong class="jt ir">‘action . types’</strong>作为我们的表达式传递给switch语句。然后对于每一种情况，我们使用<strong class="jt ir">‘action . payload’</strong>返回状态和与之相关的相应负载。</p><h2 id="ecb4" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤5:初始化Redux存储以便在应用程序范围内使用。</h2><p id="839d" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">商店是我们所有减速器连接的地方。这个存储必须在整个应用程序中可用。但是在初始化存储之前，我们需要向reducers文件夹添加另一个名为index.ts的文件，在这个文件中，我们将组合所有的reducers，以便它可以为我们的存储返回一个reducer。您可以复制下面的代码来组合所有的减速器:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="9502" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">combineReducers辅助函数将所有的reducer组合成一个具有键-值对的函数，其中每个reducer都作为一个值传递给其对应的键。这个现在可以传给redux商店了。</p><p id="2bd9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">要创建存储，请在名为store.ts的状态文件夹中创建一个新文件夹。在该文件夹中，创建一个名为store.ts的新文件。向该文件添加下面提到的代码:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="379b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">这里我们从redux导入了'<strong class="jt ir"> legacy_createStore '作为</strong> ' <strong class="jt ir"> createStore' </strong>和<strong class="jt ir"> applyMiddleware </strong>。然后，我们声明一个名为store的命名导出，其中“createStore”接受三个参数，即reducers、一个空对象和作为中间件的thunk，该中间件用applyMiddleware初始化。传递空对象来定义初始状态或默认状态。</p><p id="39b0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">最后，我们需要我们的整个应用程序能够访问这个商店，这可以通过使用react-redux中的一个组件来实现，这个组件叫做<strong class="jt ir"> Provider </strong>。您可以将提供程序导入为:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="6f74" class="lm ln iq ml b gy mp mq l mr ms">import { Provider } from 'react-redux'; </span></pre><p id="fa4b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">除了提供者，我们还需要导入我们的商店。要使用提供者来访问应用程序中的商店，只需将此代码块复制并粘贴到您的<strong class="jt ir"> '_app.tsx' </strong>文件中:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="2d0b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">提供者组件将我们导入的商店作为道具，并将我们完整的应用程序组件包装在其中。这样，我们就完成了商店的实现。</p><h2 id="b41a" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤6:请求从我们的API中获取球员的数据:</h2><p id="239e" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">现在让我们回到src，在那里我们创建了一个名为components的文件夹。在组件内部，我们将创建一个名为FootballerDetails的新文件夹。在其中，我们将创建一个名为<strong class="jt ir"> 'basicDetails.tsx' </strong>的新文件。在这个文件中，我们需要从<strong class="jt ir"> footballersAction </strong>文件中导入Axios、react-redux提供的两个钩子即<strong class="jt ir"> useSelector </strong>和<strong class="jt ir"> useDispatch </strong>以及<strong class="jt ir"> getFootballersData </strong>动作。除此之外，我还创建了一个加载器组件，只要我们的状态没有被填充，它就会显示出来。一旦状态被填充，将显示从我们的状态形成的UI，而不是加载器。下面是加载器组件的代码:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="d290" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">您可以通过参考下面的代码来创建BasicDetails组件:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="667d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">这里我们使用了<strong class="jt ir"> useSelector </strong>钩子，它将状态作为一个参数，以便从我们的存储中检索关于足球运动员的数据。在下一行中，我们定义了一个名为dispatch 的<strong class="jt ir">常量，它被设置为useDispatch钩子。接下来，我们有一个名为<strong class="jt ir"> fetchFootballers </strong>的函数，我们在其中实现Axios GET请求。请注意，我们正在将我们的API响应(即<strong class="jt ir"> res.data </strong>)分派给getFootballersData动作，该动作采用我们在上面定义的参数。之后，我们将这个函数传递给一个useEffect块。最后，在返回时，我们将检查足球运动员数据是否可用，并且没有设置为未定义。如果它不可用并且一开始没有定义，那么我们将呈现加载器，否则我们将通过映射足球运动员数据(调用状态的常量变量)来呈现显示球员信息的UI。</strong></p><p id="d4f1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">我将把这个组件传递到我们的index.tsx页面，以便所有足球运动员的数据可以立即加载到我们的主页上。您可以参考下面的索引文件代码块。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nb"><img src="../Images/c88e3d8feb5abd81865d8c30bd0336db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SWBvEjQqFoWkucf2kA45Tw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">我们如何提出GET请求的摘要</figcaption></figure><h2 id="00d9" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤7:发布创建新玩家数据的请求:</h2><p id="9dd4" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">在src/components中，我们将创建一个名为<strong class="jt ir">new football</strong>的新文件夹，其中将包含一个名为<strong class="jt ir">createnewplayerdata . tsx</strong>的文件。同样，在pages文件夹中，我们将创建一个名为<strong class="jt ir"> newplayer.tsx </strong>的新页面。您可以参考下面的代码来创建您的新播放器组件:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="74a4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">在<strong class="jt ir">CreateNewPlayerProfileComponent</strong>中，当postValStatus设置为true时，我们返回了三个带有按钮和条件渲染的输入字段。我们使用useState钩子从各自的输入字段中获取值。为了将各个状态的值设置为用户在输入字段中输入的值，我们借助onChange属性向每个输入传递一个函数。在这些变更处理函数中，我们用<strong class="jt ir"> event.target.value </strong>设置状态(event.target.value用于获取输入字段的值)。</p><p id="c784" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">接下来，我们有发出POST请求的函数。createNewPlayer函数调用event上的preventDefault()方法。此方法防止浏览器执行相关元素的默认操作。然后，我们用Axios发出POST请求，它带有三个参数，您的API端点、有效负载，最后是指定有效负载中的数据类型和访问控制的配置。来自POST请求的响应随后被分派给createFootballPlayerProfile操作(该操作在步骤3中定义)，该操作随后填充其有效负载，并在以后供reducer使用。同时，当数据成功提交时，我们将postValStatus设置为true。然后我们将这个函数传递给按钮的onClick属性。</p><p id="7445" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">最后，进入条件呈现部分，如果postValStatus没有设置为true，也就是说，如果它保留了它的原始值false，那么向用户显示输入字段和提交按钮。当state设置为true时，这种情况只在值被成功提交时才会发生，然后显示一个简单的路由器链接，该链接会将它们带回到主页。</p><p id="84b6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">导出CreateNewPlayerProfileComponent后，我们只需将其呈现到newplayer页面。这可以通过以下方式完成:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nc"><img src="../Images/b9bfe35aa4a50fb72a38d9c7669e0dfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uI1b9Szkf5Ro-g9kvspijQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">我们的帖子请求摘要</figcaption></figure><h2 id="babc" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤8:提交更新现有球员数据的请求:</h2><p id="cd54" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">在src/components中，我们将创建一个名为<strong class="jt ir">的文件夹。在这个文件夹中创建一个名为<strong class="jt ir">updateplayercomponent . tsx</strong>的文件。并在pages文件夹中创建一个名为<strong class="jt ir"> updateplayer.tsx </strong>的文件。在basicDetails.tsx中，我们将呈现一个按钮，通过单击触发重定向功能，将我们重定向到updateplayer页面。为了重定向到更新页面，我们需要从next/router导入<strong class="jt ir"> useRouter </strong>，并在我们的功能组件内部和return语句之上调用它。</strong></p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="306c" class="lm ln iq ml b gy mp mq l mr ms">// Add routing<br/>import { useRouter } from "next/router";</span><span id="fad6" class="lm ln iq ml b gy nd mq l mr ms">const router = useRouter();</span></pre><p id="e488" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">这个重定向函数的目的是获取玩家ID，最终用于更新玩家数据。我们将该函数定义如下:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e8e2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">我们将ID作为查询参数发送到我们希望重定向用户的页面。完成后，您的URL格式将如下所示:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="1088" class="lm ln iq ml b gy mp mq l mr ms"><a class="ae le" href="http://localhost:3001/updateplayer?id=7" rel="noopener ugc nofollow" target="_blank">http://localhost:3001/updateplayer?id=7</a></span></pre><p id="222e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">我们将调用footballersData.map中的一个简单按钮来调用这个函数，这样我们就可以访问每个球员的id。</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="90bd" class="lm ln iq ml b gy mp mq l mr ms">&lt;button onClick={() =&gt; {redirectToUpdatePage(individualPlayerData.id)}&gt;<br/>    Delete<br/>&lt;/button&gt;</span><span id="8ca1" class="lm ln iq ml b gy nd mq l mr ms">// In the basicDetails.tsx page</span></pre><p id="8ea2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">现在，要创建<strong class="jt ir"> UpdatePlayerComponent </strong>，您可以执行以下操作:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="f450" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">在这个组件中，我们从footballerActions.ts文件中导入<strong class="jt ir"> updateFootballerData动作</strong>(在步骤3中定义)。该组件与CreateNewPlayerProfileComponent非常相似。因此，定义的状态、变更处理函数和输入字段都没有变化。</p><p id="a4d8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">我们已经定义了一个名为<strong class="jt ir"> updateFootballPlayerData </strong>的函数，它将使我们能够更新所选球员的数据。Axios PUT请求有两个参数，API端点和更新数据所需的有效负载。就像前面的步骤一样，我们将把我们的有效负载分派给updateFootballerData动作。此外，我们将把PostValStatus设置为true。</p><p id="a526" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">玩家更新后，postValStatus设置为true，我们将为用户提供一个返回主页的选项。</p><p id="6b10" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">然后，该组件被传递到updateplayer页面。您可以按如下方式实现它:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ne"><img src="../Images/77834dab1bc1a025fb9bbc012769bf67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pu7MsImfjvsih0WGbPtZPw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">我们的卖出请求摘要</figcaption></figure><h2 id="e21d" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤9:删除请求:</h2><p id="96a5" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">在basicDetails.tsx文件中，我们将创建一个函数来处理我们的删除请求。这个函数也将一个ID作为参数。您可以将此函数定义为:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1107" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">这个函数实际上只是获取ID并完成它的工作。为delete创建单独的操作是完全可选的，我认为没有必要，只是继续进行API调用。请注意，我正在进行router.reload()调用，以便我们的更改在每次删除球员数据时都能得到反映。</p><p id="74f1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">然后我们需要调用这个函数来调用一个按钮，这个按钮将在footballersData.map中呈现</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="8da1" class="lm ln iq ml b gy mp mq l mr ms">&lt;button onClick={() =&gt; {deleteFootballer(individualPlayerData.id)}}&gt;<br/>    Delete<br/>&lt;/button&gt;</span></pre><p id="38ee" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">这也完成了我们的删除端点集成。</p><h2 id="b8bc" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">步骤10(可选):使用React-Bootstrap增强用户界面:</h2><p id="52a3" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated">这一部分是完全可选的，因为它主要处理我们的应用程序的样式，只是为了让它看起来更像样。同样，我将使用React-Bootstrap。您可以通过在终端中运行以下命令来安装React-Bootstrap:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="ddab" class="lm ln iq ml b gy mp mq l mr ms">yarn add react-bootstrap bootstrap</span></pre><p id="37f7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">然后在_app.tsx文件中导入它的CSS:</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="5a20" class="lm ln iq ml b gy mp mq l mr ms">// Use React-Bootstrap<br/>import 'bootstrap/dist/css/bootstrap.min.css';</span></pre><p id="6f75" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">对于图标，我将使用反应图标。</p><pre class="kq kr ks kt gt mk ml mm mn aw mo bi"><span id="935f" class="lm ln iq ml b gy mp mq l mr ms">yarn add react-icons</span></pre><p id="7e9c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">长话短说，我将在最后提供GitHub库的链接，这样您就可以直接在您的系统上克隆它。</p><p id="970e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">在添加了一点React-Bootstrap之后，我们的应用程序中的各个页面看起来是这样的:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/551ba079b18bf6805aef05755ead8583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q537OO-eyHkYfZM7wRiRDg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">当AXIOS GET请求从API获取响应时，加载程序被执行</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/4b28690babed25e23e909a5cfadbcdaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFsK14fKnGoAB29icPXkfg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">index.tsx中的BasicDetails组件</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/df6a9a2522f7d9786d03c4712fc174ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BwDWRYjQAh7_s0EvTLPyvw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">新玩家页面</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/03e0c3afdb2b4d5ddc03475859cfd28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7ihByNrOz3YDTXg5XUtFQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">更新玩家页面</figcaption></figure><p id="0e2f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">这通过初始化Redux存储完成了我们与Axios的Next.js应用程序的API集成。</p><h2 id="b04d" class="lm ln iq bd lo lp lq dn lr ls lt dp lu lb lv lw lx lc ly lz ma ld mb mc md me bi translated">克隆这些存储库:</h2><p id="ee8c" class="pw-post-body-paragraph jq jr iq jt b ju mf jw jx jy mg ka kb lb mh ke kf lc mi ki kj ld mj km kn ko ij bi translated"><a class="ae le" href="https://github.com/chinmaykarmokar/next-redux-ts-integrations" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir">链接到我的Next.js项目GitHub资源库。</strong>T9】</a></p><p id="ec47" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated"><a class="ae le" href="https://github.com/chinmaykarmokar/node-express-ts-orm" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir">链接到我的Express.js足球运动员API库。</strong>T3】</a></p><p id="9a8e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">谢谢大家！</p></div></div>    
</body>
</html>