<html>
<head>
<title>Introduction to Histogram Equalization for Digital Image Enhancement</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数字图像增强的直方图均衡化介绍</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/introduction-to-histogram-equalization-for-digital-image-enhancement-420696db9e43?source=collection_archive---------0-----------------------#2021-01-11">https://levelup.gitconnected.com/introduction-to-histogram-equalization-for-digital-image-enhancement-420696db9e43?source=collection_archive---------0-----------------------#2021-01-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d232" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python中的基本概念、算法和实现</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f9ba63f50a95941c07e23926209a0494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Si2JkbWNlUK3pSVKkXU2Dw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">直方图均衡化提高了图像对比度[图片由作者根据菲利普·卡珀在<a class="ae kv" href="https://commons.wikimedia.org/wiki/File:Unequalized_Hawkes_Bay_NZ.jpg" rel="noopener ugc nofollow" target="_blank">的原始图片</a>创建]</figcaption></figure><p id="5bca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated"><span class="l lt lu lv bm lw lx ly lz ma di"> H </span> istogram均衡是一种增强数字图像的简单技术。它是数字图像处理和计算机视觉应用中的标准工具。它在改善灰度图像的视觉质量方面特别有效。例如，直方图均衡化已经广泛应用于医学成像中，以提高X射线和MRI图像的对比度。这种改进使得医疗诊断更加准确。</p><p id="8272" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将介绍直方图均衡化的基本概念。我们还将看看Python中的算法和实现。对于那些不熟悉这个领域的人来说，我包括了数字图像和直方图的简要概述。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="9ad7" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">概述</h1><ol class=""><li id="c472" class="na nb iq ky b kz nc lc nd lf ne lj nf ln ng lr nh ni nj nk bi translated"><strong class="ky ir">数字图像。</strong>数字图像表示的快速概述。</li><li id="4b9e" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir">什么是直方图？</strong>直方图及其计算简介。</li><li id="6ef1" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir">低对比度图像的直方图。</strong>检查低对比度图像的直方图，了解直方图均衡化的作用。</li><li id="4e26" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir">直方图均衡化。</strong>增强图像对比度的基本概念。</li><li id="1f96" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir">核心算法。</strong></li><li id="ba7e" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir"> Python实现。</strong>使用NumPy和Pillow库从头开始简单实现直方图均衡化。</li><li id="b23e" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir">结果。</strong>我们用Python代码执行了直方图均衡化，并检查了结果。</li></ol></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="5461" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">1.数字图像</h1><p id="74b0" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">假设你想画一个黄色的，独眼的，全身穿着蓝色衣服的生物，叫做<em class="nt"> minion。</em>你将只用彩色圆点画画。你开始画画是用彩笔在纸上画小点。这些彩色的点被排列成你希望看到的一个小人的形象。生成的图像可能类似于下图。这类似于计算机屏幕呈现图像的方式。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/6ffbffda08e2a856bdfe4166963f80c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*StGJWd4TsuVkwkrnQ-lu9w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">这幅小精灵的图像是由类似像素的彩色小点组成的</figcaption></figure><p id="8157" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数字图像由称为<em class="nt">像素</em>的离散元素组成。每个像素由强度值表示，并且在2D图像平面中占据唯一的位置。在灰度图像中，每个像素由范围从0到255的单个强度值表示。具有最小亮度值的像素显示为黑色像素。随着强度值的增加，像素在各种灰色阴影中变亮。具有最大强度值的像素显示为白色像素。</p><p id="64c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">彩色图像稍微复杂一些。每个像素由三个强度值表示，这三个强度值表示颜色分量的强度:红色、绿色和蓝色。改变这些原色的比例和强度能够在像素中呈现各种颜色。</p><h1 id="13d5" class="mi mj iq bd mk ml nv mn mo mp nw mr ms jw nx jx mu jz ny ka mw kc nz kd my mz bi translated"><strong class="ak"> 2。什么是直方图？</strong></h1><p id="814e" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">直方图表示数据的频率分布。它通常被可视化为条形图。我将使用上面的minion图像来说明这些要点。图像的尺寸是22x37像素，总共814像素。假设我们生活在一个只有五种可能颜色的世界里:黑色、灰色、白色、黄色和蓝色。为了获得直方图，我们可以计算每种可能颜色的像素数:</p><ul class=""><li id="cbe3" class="na nb iq ky b kz la lc ld lf oa lj ob ln oc lr od ni nj nk bi translated">黑色— 34像素</li><li id="4982" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr od ni nj nk bi translated">灰色— 12像素</li><li id="8675" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr od ni nj nk bi translated">白色— 646像素</li><li id="5ee4" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr od ni nj nk bi translated">黄色— 76像素</li><li id="c1ff" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr od ni nj nk bi translated">蓝色— 46像素</li></ul><p id="286f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一个通用术语，每个可能的值被称为一个<strong class="ky ir"> <em class="nt"> bin </em> </strong>，计数被称为<strong class="ky ir"> <em class="nt">频率</em> </strong>。因此，我们刚刚导出了具有五个面元的图像的<strong class="ky ir"> <em class="nt">颜色直方图</em> </strong>。柱状图如下图所示。这里，x轴是频段，y轴是频率。在直方图均衡化中，我们感兴趣的是图像的<strong class="ky ir"> <em class="nt">强度直方图</em> </strong>。这意味着对于每个可能的像素强度值(0到255)，我们计算具有相应值的像素的数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/bdb7093c9dd4c0c5a47f3ad2cc2a03ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*9Cmz3pnDguv9YVEYjlwLhA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">直方图通常被可视化为条形图，如下图所示[图片由作者提供]</figcaption></figure><h1 id="bb6a" class="mi mj iq bd mk ml nv mn mo mp nw mr ms jw nx jx mu jz ny ka mw kc nz kd my mz bi translated">3.低对比度图像的直方图</h1><p id="2795" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">为了理解直方图均衡化的作用，我们来看两个低对比度图像的例子。对于每幅图像，显示直方图(蓝色图)和<strong class="ky ir"> <em class="nt">累积直方图</em> </strong>(橙色图)。累积直方图只是从第一个到最后一个柱的直方图频率的运行总和。累积直方图按比例缩小，因此它可以按与直方图相同的比例绘制。</p><h2 id="95bc" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">情况1:图像看起来太亮</h2><p id="ef68" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">下图看起来很亮，但已经褪色。解释可以在直方图中找到。像素强度集中在该范围的上部区域，大约在125和200之间。在这个区域中，像素被轻微地遮蔽，因此呈现明亮的外观。由于亮度范围较窄，像素在色调上非常相似，导致外观褪色。在这个狭窄的区域中，累积直方图以陡峭的斜率增加，而在其他地方是平坦的。</p><div class="kg kh ki kj gt ab cb"><figure class="or kk os ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/756ca1523d64843d32a4ed2cb2df55ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*mXVbHChSQmsdAmDkuWQIAw.jpeg"/></div></figure><figure class="or kk ox ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1d01e3d1a094f263c45a3837c312e1ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*10P_WKuwIxYBrtKMoQYSng.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk oy di oz pa translated">这个图像看起来褪色了。它的像素强度集中在125和200之间的高强度区域。[图片来自<a class="ae kv" href="https://commons.wikimedia.org/wiki/File:Unequalized_Hawkes_Bay_NZ.jpg" rel="noopener ugc nofollow" target="_blank">本来源</a></figcaption></figure></div><h2 id="c3d6" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">情况2:图像看起来太暗</h2><p id="1e73" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">下图看起来相当阴暗。查看直方图，强度集中在范围的较低区域，大约在5到95之间。在该区域中，像素在阴影中较暗。还可以观察到，累积直方图在该区域急剧增加，而在其他区域平缓。</p><div class="kg kh ki kj gt ab cb"><figure class="or kk pb ot ou ov ow paragraph-image"><img src="../Images/3bed6c7aba64c96aa17577504a29d4d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*aXiUMmRbxZCxphN-v6aXUw.png"/></figure><figure class="or kk pc ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/55717abf299260aa4967695a3be3acce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*JnwJhWECFDybrfJGuIP6aA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk pd di pe pa translated">这个图像看起来很暗。它的像素强度集中在5和95之间的较低强度区域周围。[ <a class="ae kv" href="https://haltair.files.wordpress.com/2010/07/lena_dark.png" rel="noopener ugc nofollow" target="_blank">我</a>法师来自<a class="ae kv" href="https://haltair.files.wordpress.com/2010/07/lena_dark.png" rel="noopener ugc nofollow" target="_blank">本源</a></figcaption></figure></div><p id="5442" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这两种情况下，直方图分析显示，在低对比度图像中:</p><ul class=""><li id="a0de" class="na nb iq ky b kz la lc ld lf oa lj ob ln oc lr od ni nj nk bi translated">像素强度集中在一个狭窄的区域，导致像素具有相似的阴影，给图像一个褪色的外观，并且</li><li id="4ce4" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr od ni nj nk bi translated">累积直方图在狭窄区域内以陡峭的斜率增加，而在其他区域则平坦。</li></ul><h1 id="54fa" class="mi mj iq bd mk ml nv mn mo mp nw mr ms jw nx jx mu jz ny ka mw kc nz kd my mz bi translated">4.直方图均衡</h1><p id="db3a" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">当图像中的各种阴影变得更加明显时，图像的对比度增强。我们可以通过加深较暗像素的阴影来做到这一点，反之亦然。这相当于扩大了像素强度的范围。为了获得良好的对比度，需要以下直方图特征:</p><ul class=""><li id="0376" class="na nb iq ky b kz la lc ld lf oa lj ob ln oc lr od ni nj nk bi translated">像素强度均匀分布在整个数值范围内(每个强度值的概率相等)，以及</li><li id="702c" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr od ni nj nk bi translated">累积直方图在整个强度范围内线性增加。</li></ul><p id="7424" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">直方图均衡化修改像素强度的分布以实现这些特征。</p><h1 id="a4fa" class="mi mj iq bd mk ml nv mn mo mp nw mr ms jw nx jx mu jz ny ka mw kc nz kd my mz bi translated">5.核心算法</h1><h2 id="c2db" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">步骤1:计算归一化累积直方图</h2><p id="e1c4" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">首先，我们计算图像的归一化直方图。归一化是通过将每个箱的频率除以图像中的像素总数来执行的。结果，累积直方图的最大值是1。下图显示了与第3节中情况1相同的低对比度图像的<em class="nt">归一化累积直方图</em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/03a5d19a106146b4453b6d82630c34de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1nCh5Lyv1RB4Z3z2LJBDA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">归一化累积直方图被用作直方图均衡化中的变换函数。它将窄像素亮度范围映射到全范围。[图片由作者提供]</figcaption></figure><h2 id="a125" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">步骤2:导出强度映射查找表</h2><p id="46a4" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">接下来，我们导出一个查找表，该查找表映射像素强度以实现均衡的直方图特征。回想一下，均衡的累积直方图在整个强度范围内线性增加。对于每个离散强度等级<em class="nt"> i </em>，映射的像素值根据以下等式从归一化累积直方图计算:</p><blockquote class="pg ph pi"><p id="384c" class="kw kx nt ky b kz la jr lb lc ld ju le pj lg lh li pk lk ll lm pl lo lp lq lr ij bi translated"><strong class="ky ir"><em class="iq">mapped _ pixel _ value(I)=(L-1)*归一化_累积_直方图(i) </em> </strong></p></blockquote><p id="47d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中<em class="nt"> L </em> = 256，用于像素强度的典型8位无符号整数表示。</p><p id="f3b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了直观地了解映射是如何工作的，让我们参考上图中显示的归一化累积直方图。最小像素强度值125被转换为0.0。最大像素强度值200转换为1.0。中间的所有值都相应地在这两个值之间映射。一旦乘以最大可能强度值(255)，得到的像素强度现在分布在整个强度范围内。</p><h2 id="0a7a" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">步骤3:用查找表转换原始图像的像素亮度</h2><p id="5ca6" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">一旦得到查找表，图像中所有像素的亮度都被映射到新的值。结果是均衡的图像。</p><h1 id="2161" class="mi mj iq bd mk ml nv mn mo mp nw mr ms jw nx jx mu jz ny ka mw kc nz kd my mz bi translated">6.Python实现</h1><p id="ff8d" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">直方图均衡是各种图像处理库中的标准操作，如openCV和Pillow。但是，我们将从头开始实现这个操作。我们将需要两个Python库:<strong class="ky ir"/><a class="ae kv" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">NumPy</strong></a><strong class="ky ir"/>用于数值计算，以及<strong class="ky ir"/><a class="ae kv" href="https://python-pillow.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">Pillow</strong></a><strong class="ky ir"/>用于图像I/O。在您的终端上输入以下命令，您就设置好了！</p><pre class="kg kh ki kj gt pq pp pr ps aw pt bi"><span id="d46b" class="of mj iq pp b gy pu pv l pw px">pip install numpy<br/>pip install pillow</span></pre><p id="5385" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整的代码如下所示，随后是均衡过程的详细解释。要平衡你自己的图像，只需相应地编辑<code class="fe pm pn po pp b">img_filename</code>和<code class="fe pm pn po pp b">save_filename</code>。演示版Jupyter笔记本和样本图片也可以从<a class="ae kv" href="https://github.com/samsudinng/cv_histogram_equalization/tree/master/demo_notebook" rel="noopener ugc nofollow" target="_blank">我的github库</a>获得。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="py pz l"/></div></figure><h2 id="e5c0" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">图像输入/输出</h2><p id="77a4" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">为了读取和写入图像文件，我们将使用Pillow库。它读取图像文件作为<code class="fe pm pn po pp b">Image</code>对象。这些对象可以很容易地转换成NumPy数组，反之亦然。所需的I/O操作编码如下。为了简单起见，让图像文件名为<em class="nt"> input_image.jpg </em>,与Python脚本位于同一个目录中。</p><pre class="kg kh ki kj gt pq pp pr ps aw pt bi"><span id="661c" class="of mj iq pp b gy pu pv l pw px">import numpy as np<br/>from PIL import Image</span><span id="20a0" class="of mj iq pp b gy qa pv l pw px">img_filename = 'input_image.jpg'<br/>save_filename = 'output_image.jpg'</span><span id="5621" class="of mj iq pp b gy qa pv l pw px">#load file as pillow Image <br/>img = Image.open(img_filename)</span><span id="d3f7" class="of mj iq pp b gy qa pv l pw px"># convert to grayscale<br/>imgray = img.convert(mode='L')</span><span id="f317" class="of mj iq pp b gy qa pv l pw px">#convert to NumPy array<br/>img_array = np.asarray(imgray)<br/></span><span id="9bf8" class="of mj iq pp b gy qa pv l pw px">#PERFORM HISTOGRAM EQUALIZATION AND ASSIGN OUTPUT TO eq_img_array<br/></span><span id="b1ee" class="of mj iq pp b gy qa pv l pw px">#convert NumPy array to pillow Image and write to file<br/>eq_img = Image.fromarray(eq_img_array, mode='L')<br/>eq_img.save(save_filename)</span></pre><h2 id="00d7" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">直方图均衡</h2><p id="8941" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">主算法只用几行代码就可以实现。在这个例子中，强度映射查找表被实现为1D列表，其中索引表示原始图像像素强度。每个索引处的元素是相应的转换值。最后，有各种方法来执行像素强度映射。我使用<a class="ae kv" href="https://www.w3schools.com/python/python_lists_comprehension.asp" rel="noopener ugc nofollow" target="_blank">列表理解</a>，在映射之前和之后对2D图像阵列进行展平和整形。</p><pre class="kg kh ki kj gt pq pp pr ps aw pt bi"><span id="d2d4" class="of mj iq pp b gy pu pv l pw px">"""<br/>STEP 1: Normalized cumulative histogram<br/>"""</span><span id="e2e4" class="of mj iq pp b gy qa pv l pw px">#flatten image array and calculate histogram via binning<br/>histogram_array = np.bincount(img_array.flatten(), minlength=256)</span><span id="37c8" class="of mj iq pp b gy qa pv l pw px">#normalize<br/>num_pixels = np.sum(histogram_array)<br/>histogram_array = histogram_array/num_pixels</span><span id="853f" class="of mj iq pp b gy qa pv l pw px">#cumulative histogram<br/>chistogram_array = np.cumsum(histogram_array)<br/></span><span id="47d3" class="of mj iq pp b gy qa pv l pw px">"""<br/>STEP 2: Pixel mapping lookup table<br/>"""<br/>transform_map = np.floor(255 * chistogram_array).astype(np.uint8)<br/></span><span id="5a67" class="of mj iq pp b gy qa pv l pw px">"""<br/>STEP 3: Transformation<br/>"""</span><span id="02ff" class="of mj iq pp b gy qa pv l pw px"># flatten image array into 1D list<br/>img_list = list(img_array.flatten())</span><span id="bbbe" class="of mj iq pp b gy qa pv l pw px"># transform pixel values to equalize<br/>eq_img_list = [transform_map[p] for p in img_list]</span><span id="5a0f" class="of mj iq pp b gy qa pv l pw px"># reshape and write back into img_array<br/>eq_img_array = np.reshape(np.asarray(eq_img_list), img_array.shape)</span></pre><h1 id="2095" class="mi mj iq bd mk ml nv mn mo mp nw mr ms jw nx jx mu jz ny ka mw kc nz kd my mz bi translated">7.结果</h1><p id="5321" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">让我们看看第3节中给出的两幅图像的直方图均衡化输出。对于每个结果，上面两个图像显示原始图像和均衡图像。可以清楚地观察到对比度的提高。下面两幅图像显示了直方图和累积直方图，比较了原始图像和均衡图像。直方图均衡化后，像素亮度分布在整个亮度范围内。累积直方图如预期的那样线性增加，同时呈现出阶梯模式。这是预期的，因为原始图像的像素强度被拉伸到更宽的范围。这在相邻的非零仓之间产生了具有零频率的仓的间隙，在累积直方图中表现为扁平线。</p><h2 id="c373" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">案例一:不平等_Hawkes_Bay_NZ.jpg</h2><div class="kg kh ki kj gt ab cb"><figure class="or kk qb ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/23fcad569ec95150168a7ee011e91dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*mXVbHChSQmsdAmDkuWQIAw.jpeg"/></div></figure><figure class="or kk qb ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/8f09b05ddc161809cf5bb853a0fa135d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*2JWOnvJWjOWvL1WJayjvFQ.png"/></div></figure></div><div class="ab cb"><figure class="or kk qb ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/c0b729faae7b60b00ec706b8cccd8d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Zo4eQNFmtp9msW4OlEjXXQ.png"/></div></figure><figure class="or kk qb ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/576d9d6e6d8bf71ca98f640fe8cd4dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*QWOXiiw8PH0QDnGSlT3edA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk qc di qd pa translated">情况1:均衡前后的图像、直方图和累积直方图。[图片由作者和<a class="ae kv" href="https://commons.wikimedia.org/wiki/File:Unequalized_Hawkes_Bay_NZ.jpg" rel="noopener ugc nofollow" target="_blank">本来源</a></figcaption></figure></div><h2 id="e92d" class="of mj iq bd mk og oh dn mo oi oj dp ms lf ok ol mu lj om on mw ln oo op my oq bi translated">案例二:lena_dark.png</h2><div class="kg kh ki kj gt ab cb"><figure class="or kk qb ot ou ov ow paragraph-image"><img src="../Images/3bed6c7aba64c96aa17577504a29d4d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*aXiUMmRbxZCxphN-v6aXUw.png"/></figure><figure class="or kk qb ot ou ov ow paragraph-image"><img src="../Images/5a0f143665a457d8af7ed3d9f766c4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*YFmcdGFDeeXcpJzPLlmcjg.png"/></figure></div><div class="ab cb"><figure class="or kk qb ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/cd434076e0417a3f8b4581f1f28d98fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Uf6WAMyuYvLjG6qlPajn_g.png"/></div></figure><figure class="or kk qb ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/31f00bd7ad43c2cc7064797cb75ca3d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Xnz6cxNOBHadlVym3wqLZA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk qc di qd pa translated">情况1:均衡前后的图像、直方图和累积直方图。[图片作者和<a class="ae kv" href="https://haltair.files.wordpress.com/2010/07/lena_dark.png" rel="noopener ugc nofollow" target="_blank">此来源</a></figcaption></figure></div></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="b290" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">结论</h1><p id="69a4" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">在本文中，我们研究了基本的直方图均衡算法和实现。因为它是基于整个图像的直方图来执行的，所以它通常被称为<em class="nt">全局直方图均衡化</em>。这是一个简单而有效的工具来增加图像的整体对比度。但是，如果图像包含噪声，这些噪声也会被放大。有几种算法变体可以解决这个问题，比如<em class="nt">自适应直方图均衡</em> (AHE)和<em class="nt">对比度受限的自适应直方图均衡</em> ( <a class="ae kv" href="https://en.wikipedia.org/wiki/Adaptive_histogram_equalization" rel="noopener ugc nofollow" target="_blank"> CLAHE </a>)。然而，这些是另一篇文章的主题！</p></div></div>    
</body>
</html>