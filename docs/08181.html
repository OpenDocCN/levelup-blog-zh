<html>
<head>
<title>Python Sun Position for Solar Energy and Research</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">太阳能和研究的Python太阳位置</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-sun-position-for-solar-energy-and-research-7a4ead801777?source=collection_archive---------2-----------------------#2021-04-07">https://levelup.gitconnected.com/python-sun-position-for-solar-energy-and-research-7a4ead801777?source=collection_archive---------2-----------------------#2021-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="43d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里有一个简洁的Python程序，你可以用它来计算太阳的位置，精度达到0.01度。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/f0e4450d2fd1b6ba4d70198a434c7048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFgIHi-oGJ7mNjtya7IbeA.jpeg"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">作者在假虎刺属平原发电设施</figcaption></figure><p id="71e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我最喜欢的太阳笑话……”我彻夜未眠，试图弄清楚太阳去了哪里。我终于明白了。”</p><p id="03a2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不过说真的，随着世界转向太阳能和风能替代能源，知道太阳在天空中的位置非常重要。我已经为许多太阳能站点创建了软件，例如上面显示的假虎刺属平原项目，分享一个核心Python算法来计算太阳的位置感觉是正确的事情。我希望它能帮助你，无论是在一个爱好项目上，还是在一些世界上最大的太阳能项目上。给你更多的力量！</p><p id="3d5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里介绍的程序简短、快速，对于1901年到2099年之间的任何一天，以及地球上的任何一个位置，精度都可以达到0.01度。为了更好地理解这种准确性，这张太阳圆盘照片中心附近的黑点大约是太阳直径的1/50，或大约0.01度。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lf"><img src="../Images/9bf0d77a4d9cf8189f210037faa550c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zx0t2FDpeBenMFzrO_tSzQ.jpeg"/></div></div></figure><p id="1913" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于瞄准太阳跟踪器或定日镜以获取能量来说，这种精度已经足够了。对于极其精确的科学目的，如跟踪太阳黑子或其他细节，VSOP87算法更好，但它要复杂得多。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="d359" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">注:我的激情是Python，但如果你需要不同通用编程语言中的这种算法，请查阅我的书，</em> <a class="ae ln" href="https://amzn.to/3mE8Aoh" rel="noopener ugc nofollow" target="_blank"> <em class="ko">《太阳位置:9种通用编程语言中的天文算法》</em> </a></p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="a5a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我的Python程序，它可以让你找到地球上任何特定时刻的太阳在天空中的位置:</p><pre class="kq kr ks kt gt lo lp lq lr aw ls bi"><span id="bdcf" class="lt lu it lp b gy lv lw l lx ly"># sunpos.py</span><span id="f1a6" class="lt lu it lp b gy lz lw l lx ly">import math</span><span id="238a" class="lt lu it lp b gy lz lw l lx ly">def sunpos(when, location, refraction):</span><span id="df50" class="lt lu it lp b gy lz lw l lx ly"># Extract the passed data<br/>    year, month, day, hour, minute, second, timezone = when<br/>    latitude, longitude = location</span><span id="b397" class="lt lu it lp b gy lz lw l lx ly"># Math typing shortcuts<br/>    rad, deg = math.radians, math.degrees<br/>    sin, cos, tan = math.sin, math.cos, math.tan<br/>    asin, atan2 = math.asin, math.atan2</span><span id="4d5d" class="lt lu it lp b gy lz lw l lx ly"># Convert latitude and longitude to radians<br/>    rlat = rad(latitude)<br/>    rlon = rad(longitude)</span><span id="6454" class="lt lu it lp b gy lz lw l lx ly"># Decimal hour of the day at Greenwich<br/>    greenwichtime = hour - timezone + minute / 60 + second / 3600</span><span id="6e4d" class="lt lu it lp b gy lz lw l lx ly"># Days from J2000, accurate from 1901 to 2099<br/>    daynum = (<br/>        367 * year<br/>        - 7 * (year + (month + 9) // 12) // 4<br/>        + 275 * month // 9<br/>        + day<br/>        - 730531.5<br/>        + greenwichtime / 24<br/>    )</span><span id="c0c9" class="lt lu it lp b gy lz lw l lx ly"># Mean longitude of the sun<br/>    mean_long = daynum * 0.01720279239 + 4.894967873</span><span id="8fe4" class="lt lu it lp b gy lz lw l lx ly"># Mean anomaly of the Sun<br/>    mean_anom = daynum * 0.01720197034 + 6.240040768</span><span id="d74d" class="lt lu it lp b gy lz lw l lx ly"># Ecliptic longitude of the sun<br/>    eclip_long = (<br/>        mean_long<br/>        + 0.03342305518 * sin(mean_anom)<br/>        + 0.0003490658504 * sin(2 * mean_anom)<br/>    )</span><span id="3f7d" class="lt lu it lp b gy lz lw l lx ly"># Obliquity of the ecliptic<br/>    obliquity = 0.4090877234 - 0.000000006981317008 * daynum</span><span id="4609" class="lt lu it lp b gy lz lw l lx ly"># Right ascension of the sun<br/>    rasc = atan2(cos(obliquity) * sin(eclip_long), cos(eclip_long))</span><span id="4455" class="lt lu it lp b gy lz lw l lx ly"># Declination of the sun<br/>    decl = asin(sin(obliquity) * sin(eclip_long))</span><span id="7c08" class="lt lu it lp b gy lz lw l lx ly"># Local sidereal time<br/>    sidereal = 4.894961213 + 6.300388099 * daynum + rlon</span><span id="b964" class="lt lu it lp b gy lz lw l lx ly"># Hour angle of the sun<br/>    hour_ang = sidereal - rasc</span><span id="09e7" class="lt lu it lp b gy lz lw l lx ly"># Local elevation of the sun<br/>    elevation = asin(sin(decl) * sin(rlat) + cos(decl) * cos(rlat) * cos(hour_ang))</span><span id="a0fa" class="lt lu it lp b gy lz lw l lx ly"># Local azimuth of the sun<br/>    azimuth = atan2(<br/>        -cos(decl) * cos(rlat) * sin(hour_ang),<br/>        sin(decl) - sin(rlat) * sin(elevation),<br/>    )</span><span id="e9b4" class="lt lu it lp b gy lz lw l lx ly"># Convert azimuth and elevation to degrees<br/>    azimuth = into_range(deg(azimuth), 0, 360)<br/>    elevation = into_range(deg(elevation), -180, 180)</span><span id="42ee" class="lt lu it lp b gy lz lw l lx ly"># Refraction correction (optional)<br/>    if refraction:<br/>        targ = rad((elevation + (10.3 / (elevation + 5.11))))<br/>        elevation += (1.02 / tan(targ)) / 60</span><span id="da11" class="lt lu it lp b gy lz lw l lx ly"># Return azimuth and elevation in degrees<br/>    return (round(azimuth, 2), round(elevation, 2))</span><span id="69ce" class="lt lu it lp b gy lz lw l lx ly">def into_range(x, range_min, range_max):<br/>    shiftedx = x - range_min<br/>    delta = range_max - range_min<br/>    return (((shiftedx % delta) + delta) % delta) + range_min</span><span id="566c" class="lt lu it lp b gy lz lw l lx ly">if __name__ == "__main__":</span><span id="d530" class="lt lu it lp b gy lz lw l lx ly"># Close Encounters latitude, longitude<br/>    location = (40.602778, -104.741667)</span><span id="b644" class="lt lu it lp b gy lz lw l lx ly"># Fourth of July, 2022 at 11:20 am MDT (-6 hours)<br/>    when = (2022, 7, 4, 11, 20, 0, -6)</span><span id="d11a" class="lt lu it lp b gy lz lw l lx ly"># Get the Sun's apparent location in the sky<br/>    azimuth, elevation = sunpos(when, location, True)</span><span id="7ce5" class="lt lu it lp b gy lz lw l lx ly"># Output the results<br/>    print("\nWhen: ", when)<br/>    print("Where: ", location)<br/>    print("Azimuth: ", azimuth)<br/>    print("Elevation: ", elevation)</span><span id="2d20" class="lt lu it lp b gy lz lw l lx ly"># When:  (2022, 7, 4, 11, 20, 0, -6)<br/># Where:  (40.602778, -104.741667)<br/># Azimuth:  121.38<br/># Elevation:  61.91</span></pre><p id="1e9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我已经设置了这个程序，这样你就可以很容易地将它导入到任何需要寻找太阳位置的程序中。将代码保存在一个名为sunpos.py的文件中，将其导入到您的项目中，并根据需要调用函数sunpos()。现在，请注意，很容易在清单末尾附近更改位置和时间参数，以生成任意位置的太阳位置。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ma"><img src="../Images/f03d5561d364de4ef44d2747d4576137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bhLhpz46P4wBnQ68"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">怀俄明州的恶魔之塔——杰夫·芬利<a class="ae ln" href="https://unsplash.com/@jeff_finley?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在</a><a class="ae ln" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="41c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如清单末尾的示例代码所示，我选择了一个我最喜欢的位置，电影《第三类亲密接触》中的错误的纬度和经度位置。据推测，外星人向怀俄明州的恶魔之塔发出了与当局会面的信号，但电影中的经纬度实际上指向科罗拉多州奥尔特北部一座农舍附近的一块田地。这不是一个戏剧性的网站，但它将是伟大的安装一些太阳能追踪器！</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/c124d86691be3bdc5a3c95925a0b2e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*wu9ma1_ECEnad0YvRC0SUw.png"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">谷歌地图提供</figcaption></figure><p id="1539" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我选择了2022年7月4日上午11点20分。如果需要，可以随意更改这些参数，但是我建议使用它们来验证代码。您的输出应该与这里显示的代码清单相匹配。</p><p id="8fc3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">位置和时间参数被设置为列表或元组。时间包括时区，或与格林威治时间的时差，因地点和一年中的时间而异。网上有很多地方可以仔细检查这个值。</p><h1 id="f46c" class="mc lu it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">大气折光改正</h1><p id="8400" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb nb kd ke kf nc kh ki kj nd kl km kn im bi translated">通常情况下，对于太阳能计算，太阳在天空中的表观位置就是您想要的位置。但是有些时候，比如在计算日出和日落时，你不想校正折射。请注意传递的参数是真还是假，以包括或忽略折射校正。我来解释一下屈光矫正是什么意思。</p><p id="c2cb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">大气使光线发生了一点弯曲，使星星、月亮和太阳在天空中的位置发生了一点偏移。这种变化很小，但意义重大，尤其是当太阳在天空中低低的时候，更接近地平线。当太阳看起来位于地平线上时，它实际上正悬挂在地平线下。在更高的天空中，这种移动比太阳圆盘的直径要小一些。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ne"><img src="../Images/ab5f07570409a287ebb3dd33a7dd018b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qsq0urj2g9CYEIz7.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">弗朗西斯科·哈维尔和布兰科·冈萨雷斯</figcaption></figure><h1 id="d290" class="mc lu it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">弧度或角度</h1><p id="1069" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb nb kd ke kf nc kh ki kj nd kl km kn im bi translated">大多数编程语言中的三角函数需要用弧度而不是度数表示的参数。这里介绍的大多数方程都可以在用度数表示的天文资料中找到。为了加速代码，我把这些方程项转换成弧度，用弧度做所有复杂的计算，最后再转换回度数。这有助于加快速度。</p><h1 id="1b80" class="mc lu it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">方位角和仰角</h1><p id="1364" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb nb kd ke kf nc kh ki kj nd kl km kn im bi translated">太阳的位置用方位角和仰角来表示。为了清楚起见，让我确切地定义这是什么意思。方位角是地平线上从北向东旋转的度数。因此，如果太阳正好位于东方地平线之上，它的方位角将是90度。在太阳正午，当太阳穿过观察者正南方的天空时(北半球的情况)，它的方位角是180度。方位角表示为范围从0到360度的正数。</p><p id="1e57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">仰角是从地平线到太阳圆盘中心位置的度数。当穿过地平线时，太阳处于0度仰角，当太阳垂直向上时，头顶上的所谓天顶，其仰角为90度。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3445c164be86daaf025858cdf3f940e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/0*H56ITCi-WmbM6khD.jpg"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">礼貌Celestis.com</figcaption></figure><h1 id="4564" class="mc lu it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">黄道倾角和其他奇怪的术语</h1><p id="cdfa" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb nb kd ke kf nc kh ki kj nd kl km kn im bi translated">你会在代码中注意到一些你可能不知道的天文细节的计算。这些细节处理了与太阳穿过我们天空的复杂路径有关的因素，这些复杂路径是由于地球的倾斜、月球的引力推动、地球略呈椭圆形的轨道等等。你不需要了解这些因素来使用这个程序，但是如果感兴趣，我建议你在网上搜索一下，或者买我上面提到的书，因为它有更多的解释。</p><h1 id="692d" class="mc lu it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">太阳位置的创造性应用</h1><p id="6d9b" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb nb kd ke kf nc kh ki kj nd kl km kn im bi translated">太阳的位置对于瞄准所有类型的太阳跟踪器都是有用的，例如双轴定日镜或各种类型的单轴跟踪光伏板。它对于非跟踪应用程序也非常有用。例如，我的下一篇文章将展示如何计算放置在屋顶上的面板的整体年效率，这些面板面向任何方位，具有任何标准斜度，并且位于地球上的某个纬度。</p><p id="4381" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我已经开发了几十个有用的太阳能程序，都是基于这个核心的太阳位置算法，其中许多被我的妻子用于她的分析，因为她向全国各地的房主出售最佳效率和最佳省钱的太阳能电池板系统。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ng"><img src="../Images/17ef5b43490c6e752d1ee240624ab3d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*15p_19DnwX95erewbQ1Q9Q.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">作者的许多太阳能应用程序的例子</figcaption></figure><h1 id="4c63" class="mc lu it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">这是家庭事务</h1><p id="9782" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb nb kd ke kf nc kh ki kj nd kl km kn im bi translated">我娶了老板的女儿。我的老板是一名顶尖的工程师，他参与了海盗号火星着陆器以及其他许多著名的项目。当时，他的小型太阳能工程小组创造、建造并规划了(由我负责)几个世界上最大的太阳能发电设施。这是我做过的最好的工作，它包括一个很棒的附带福利；会见老板的女儿，EJ！</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nh"><img src="../Images/c0a83406cdc7e101dd5727c89ed3abd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5WRNIV37Wx8yHXIUorTs4A.jpeg"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">作者的老板，弗洛伊德·布莱克，在我们的一个太阳能测试设施</figcaption></figure><p id="f60c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天，EJ是一名“总统俱乐部”的销售人员，拥有数百名快乐的客户，因为她帮助他们节省了大量资金，同时通过定制安装你看到的出现在邻居屋顶上的太阳能电池板来保护地球。我很荣幸能够帮助她完成各种软件任务，其中许多任务都是基于这里介绍的sun位置代码。</p><p id="22a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">全面披露:如果你想了解更多关于EJ如何通过定制安装太阳能电池板来取代你的电费账单，从而为你节省大量资金，</strong> <a class="ae ln" href="https://powur.com/solar.proud/education/why-solar" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">只需点击此处</strong> </a> <strong class="js iu">。(EJ将是她公司中被通知的人)</strong></p><h1 id="15fb" class="mc lu it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">下一步是什么？</h1><p id="2fa5" class="pw-post-body-paragraph jq jr it js b jt mz jv jw jx na jz ka kb nb kd ke kf nc kh ki kj nd kl km kn im bi translated">这里介绍的核心太阳位置程序已经被我多年来开发的许多太阳能应用程序所采用。我的计划是写更多的Medium.com文章，展示一些有用的Python实用程序，任何人，从房主到太阳能专家，都可以使用它们，因为我们都在努力让世界变得更美好。敬请期待！</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="c22a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">John的热情和使命是分享Python代码，帮助揭开生活挑战的神秘面纱，并从中获得乐趣。约翰著有 <a class="ae ln" href="https://amzn.to/3k4O39j" rel="noopener ugc nofollow" target="_blank"> <em class="ko"> Python为Numworks </em> </a> <em class="ko">，</em> <a class="ae ln" href="https://amzn.to/3mHK0Br" rel="noopener ugc nofollow" target="_blank"> <em class="ko"> Python为OpenSCAD </em> </a> <em class="ko">，以及</em> <a class="ae ln" href="https://amzn.to/320uLMg" rel="noopener ugc nofollow" target="_blank"> <em class="ko">等诸多头衔</em> </a> <em class="ko">。</em></p></div></div>    
</body>
</html>