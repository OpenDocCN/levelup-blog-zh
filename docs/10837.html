<html>
<head>
<title>Handling Access Tokens for Google APIs with React &amp; Node.js Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React &amp; Node.js教程处理Google APIs的访问令牌</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/handling-access-tokens-for-google-apis-with-react-node-js-tutorial-5ebf94d8f90f?source=collection_archive---------2-----------------------#2022-01-17">https://levelup.gitconnected.com/handling-access-tokens-for-google-apis-with-react-node-js-tutorial-5ebf94d8f90f?source=collection_archive---------2-----------------------#2022-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5c25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Google认证、访问令牌和API使用的刷新令牌</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3a76f79753a3c5667014df328869e224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZAa3T2ufLBRa0roXNqv20Q.png"/></div></div></figure><p id="4887" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是一个认证和处理API使用的Google访问令牌的指南。我将使用Google日历API作为例子。</p><p id="6db3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您将了解如何通过Google进行身份验证、取回令牌、存储访问令牌、使用API访问令牌、处理刷新令牌，以及如何检查令牌是否过期，以便获得新的访问令牌或使用旧的令牌。</p><p id="c079" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我也正在写一本电子书来分享我从零开始学到的关于Google APIs的一切！如果您感兴趣，请告诉我:)</p><div class="la lb gp gr lc ld"><a href="https://react-ultimate-guide-googleapis.vercel.app/" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd iu gy z fp li fr fs lj fu fw is bi translated">React &amp; Google APIs</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">从头开始学习操作谷歌API:认证，电子表格管理，谷歌日历，令牌…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">react-ultimate-guide-Google APIs . vercel . app</p></div></div></div></a></div><h2 id="006c" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">要求</h2><ul class=""><li id="5f4e" class="mf mg it js b jt mh jx mi kb mj kf mk kj ml kn mm mn mo mp bi translated">Basic React.js</li><li id="7824" class="mf mg it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">Javascript获取</li><li id="377e" class="mf mg it js b jt mq jx mr kb ms kf mt kj mu kn mm mn mo mp bi translated">基本节点. js</li></ul><h2 id="42a9" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">问题是</h2><p id="38c7" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">谷歌访问令牌在1小时后过期。这意味着，如果您通过谷歌认证，获得一个访问令牌，并使用它来访问您的谷歌日历API，您将只能使用该访问令牌1小时。之后，令牌过期，您需要一个新的。</p><h2 id="1579" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">解决方案</h2><p id="5c65" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">我们将在Node.js服务器上与Google进行认证，认证完成后将<strong class="js iu"> access_token </strong>和<strong class="js iu"> refresh_token </strong>发送给前端用户，并将<strong class="js iu"> refresh_token </strong>存储在<strong class="js iu"> localStorage </strong>上。您也可以将它存储在您的用户数据库文件中。然后，每次我们向Google API发出请求时，检查令牌是否过期，并相应地处理它。</p><h2 id="b732" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">开始前的步骤</h2><ol class=""><li id="80f4" class="mf mg it js b jt mh jx mi kb mj kf mk kj ml kn my mn mo mp bi translated">创建新的React应用程序</li><li id="0f56" class="mf mg it js b jt mq jx mr kb ms kf mt kj mu kn my mn mo mp bi translated">用Express.js创建新的Node.js服务器</li></ol><h2 id="f97b" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">项目设置</h2><p id="0718" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">我建立了一个名为google-auth-tokens的文件夹，然后在里面创建了一个名为<strong class="js iu"> client </strong>的React应用和一个名为<strong class="js iu"> server的Node.js应用。</strong>然后我在服务器上安装了express、googleapis、cors和dotenv依赖项。</p><p id="55ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以复制以下命令来设置项目。</p><p id="95ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mz na nb nc b">mkdir google-auth-tokens &amp;&amp; cd google-auth-tokens</code></p><p id="5c75" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mz na nb nc b">npx create-react-app client &amp;&amp; touch client/src/tokens.js &amp;&amp; touch client/src/calendarApi.js</code></p><p id="e525" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mz na nb nc b">mkdir server &amp;&amp; touch server/index.js &amp;&amp; touch server/.env &amp;&amp; cd server &amp;&amp; npm init -y &amp;&amp; yarn add express dotenv googleapis cors node-fetch@2.0 body-parser</code></p><p id="1aac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">项目结构设置完毕！</p><h2 id="eb2a" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated"><strong class="ak"> React客户端:</strong></h2><p id="9324" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">让我们直接跳到代码。客户端应用程序基本上有3个步骤。</p><ol class=""><li id="0ba8" class="mf mg it js b jt ju jx jy kb nd kf ne kj nf kn my mn mo mp bi translated">登录并从查询参数中获取凭据</li><li id="1350" class="mf mg it js b jt mq jx mr kb ms kf mt kj mu kn my mn mo mp bi translated">将令牌凭据存储在会话存储中</li><li id="94dd" class="mf mg it js b jt mq jx mr kb ms kf mt kj mu kn my mn mo mp bi translated">发送API请求时处理过期和未过期的令牌</li></ol><p id="63ee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在App.js上，使用按钮<strong class="js iu"> Login </strong>启动认证，该按钮调用函数<strong class="js iu"> createGoogleAuthLink。</strong>这会在您的服务器中创建链接，将验证链接发送回客户端，并在成功时将React应用重定向到Google验证链接。</p><p id="133e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在通过Google认证之后，应该发送回另一个包含访问令牌和刷新令牌的链接。这将在useEffect钩子中用一个名为<strong class="js iu">handleTokenFromQueryParams()</strong>的函数来处理，并让用户登录。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6b49" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们将处理日历请求和令牌过期。</p><h2 id="fd13" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">客户端上的访问令牌管理</h2><p id="f585" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">我们将创建令牌管理系统来处理到期时间，并始终获得有效的<strong class="js iu"> access_token </strong>。</p><p id="9a26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在文件<strong class="js iu"> tokens.js </strong>上，我们将创建一个函数<strong class="js iu"> getToken()。</strong>它的功能非常简单:</p><p id="9c6d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">功能<strong class="js iu">检查令牌是否过期</strong>。</p><p id="9a4b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果<strong class="js iu">过期</strong>，它将使用存储在sessionStorage中的refresh_token从服务器获取一个新令牌。它还在<strong class="js iu"> sessionStorage上设置新的access_token和新的expirationDate。</strong></p><p id="5086" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果<strong class="js iu">没有过期</strong>，我们返回当前存储的访问令牌。</p><p id="c7e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这一切都发生在用户至少被认证一次之后。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="f728" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们需要做的就是用从<strong class="js iu"> getToken()返回的令牌调用Google Calendar API。</strong>我们将在一个名为<strong class="js iu"> calendarApi.js </strong>的文件中完成这项工作。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="efc5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在这里阅读更多关于谷歌日历API REST功能的信息<a class="ae ni" href="https://developers.google.com/calendar/api/v3/reference" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/calendar/api/v3/reference</a></p><p id="bd64" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">太好了！您已经设置了客户端。现在让我们设置Google项目，这样您就可以在服务器上进行身份验证。</p><h2 id="0bec" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">服务器的Google控制台项目设置</h2><p id="460a" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">为了通过您的服务器进行认证，您需要设置一个Google控制台项目。</p><p id="3d06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在此创建新项目:</p><div class="la lb gp gr lc ld"><a href="https://console.cloud.google.com/projectcreate" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd iu gy z fp li fr fs lj fu fw is bi translated">谷歌云平台</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">Google云平台让您可以在同一基础设施上构建、部署和扩展应用程序、网站和服务…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">console.cloud.google.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no ky ld"/></div></div></a></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi np"><img src="../Images/0121fd845d2d07f51f38fd7d331714ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auldgtMEfnXHe9EQ13XbNg.png"/></div></div></figure><p id="45c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在API和服务-&gt;库上启用Google日历API。寻找日历API</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/80f600e2aad68cef8300b2b561f980c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dt294GrBapRapAAgfrdVqA.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/7ea87021569bd0bbc8e2036e66dc5997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q8One157-6gCHjteROOPLw.png"/></div></div></figure><p id="82ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在OAuth同意屏幕上设置允许的访问路由，并在控制台上设置重定向路由。您需要首先转到API和服务，并创建外部使用设置:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/a714c1ed49caaffeb06135fc10c61ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1KV4UfFt4U-k1NTkQ1f7Zw.png"/></div></div></figure><p id="20ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您到达OAuth同意屏幕的scopes部分时，确保添加scope Google Calendar API。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nt"><img src="../Images/e07cafe0168445e8cee44f8c7c647669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ypxyspT5Ko3keGPFX4CUjw.png"/></div></div></figure><p id="da7d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">点击保存，然后通过<strong class="js iu">可选</strong>信息和<strong class="js iu">摘要。</strong></p><p id="aa86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，在<strong class="js iu">凭证</strong>页面上设置您的身份验证客户端id:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nu"><img src="../Images/d59aebb08bf005e0d9f4beb1d7b991c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bixf0h3JWzjifIzmB4PW3w.png"/></div></div></figure><p id="9af0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，在<strong class="js iu">凭证</strong>选项卡上，将其配置为一个web应用程序，并在登录时重定向到正确的路由。</p><p id="d723" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意:你需要在一个我们称之为<strong class="js iu"> /handleGoogleRedirect的GET路径上处理成功的Google登录。</strong>这就是如何使用URL查询上的令牌将服务器指向客户端。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nv"><img src="../Images/a5b366206293161ea55c8c1aa2384a94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8GTidC9JFVuzRaarUU4fDg.png"/></div></div></figure><p id="2087" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保你点击了<strong class="js iu">发布应用。</strong>否则，您将无法登录。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/194b3ff57a12e5b0228e36c8015e9b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*weETN6JNq7J0gsQISn8QAg.png"/></div></div></figure><p id="8886" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完成这一步后，您将获得您的<strong class="js iu">客户端id和密码</strong>。在下一步中，您将使用这两者。</p><h2 id="5440" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">Node.js项目配置</h2><p id="3b0f" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">将您的Google <strong class="js iu">客户端id和密码</strong>添加到您的<strong class="js iu">中。Node.js服务器上的env </strong>文件。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nx"><img src="../Images/19c37fe92144b2166e69b568db11ed61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amTWXaa58oDWG9_1Hx8OHA.png"/></div></div></figure><p id="6d10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果设置正确，将以下代码添加到index.js并运行您的服务器。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="e796" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">鉴定</h2><p id="4de8" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">现在同时运行React应用程序和Node.js服务器。在客户端，点击登录按钮。您将被带到由服务器处理的Google登录屏幕。</p><h2 id="f1b3" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">警告</h2><p id="f1ff" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">当你授权时，你会看到一个来自谷歌的警告屏幕，因为你正在使用敏感范围(谷歌日历)。如果你想发表它，你需要向谷歌核实。出于时间考虑，我们将忽略警告消息底部的最后一个按钮“<strong class="js iu">转到身份验证令牌(不安全)</strong>”。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/34968b8b3b6fa7fb905341c17e1fc633.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAbJg0Qn_t2fP0DdIn4qZg.png"/></div></div></figure><p id="17fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nz">您应该会在该文本上方看到“转到授权令牌”。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8f0c2e42cd5112d762f901d216d440fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wUieJP-vLEjVfnOAnSf9A.png"/></div></div></figure><p id="bcda" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">允许您的应用程序访问您的日历，然后点击<strong class="js iu">继续。</strong></p><h2 id="e998" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated"><strong class="ak">服务器代码解释</strong></h2><p id="dfda" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">在允许应用程序访问您的日历后，您将被重定向到localhost:8080/handleGoogleRedirect，带有Google access <strong class="js iu">代码。</strong>这不是一个API访问令牌，而是一个代码，用来识别你是不是谷歌的登录用户。您可以使用此代码获得<strong class="js iu">令牌。</strong></p><p id="d9bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了<strong class="js iu"> googleapis </strong>包，我们可以用<strong class="js iu"> getToken </strong>函数从Google获得带有<strong class="js iu">代码</strong>的令牌。这提供了一个<strong class="js iu">访问令牌</strong>和一个<strong class="js iu">刷新令牌。</strong></p><p id="1f97" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以用一个响应将这些内容发送回客户端:</p><p id="ef58" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">RES . redirect(client:refresh token，accessToken，expiration date)</strong>call(line 48 server/index . js)。</p><p id="596c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果操作正确，您将被重定向到位于localhost:3000的React客户端。</p><p id="eb60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后点击“获取谷歌日历”按钮，你应该会看到它在控制台打印出来！</p><p id="3375" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">大功告成！现在，您拥有了一个成功运行的身份验证流程，其中的访问令牌不会过期。</strong></p><p id="581b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以在此处访问回购:</p><div class="la lb gp gr lc ld"><a href="https://github.com/Ignacio1996/google-auth-tokens" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd iu gy z fp li fr fs lj fu fw is bi translated">GitHub-Ignacio 1996/谷歌-授权-令牌</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">github.com</p></div></div><div class="nj l"><div class="oa l nl nm nn nj no ky ld"/></div></div></a></div><p id="45fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">几周前，我构建了一个解决方案，旨在分享我如何用Firebase解决这个问题。这是一个高级教程，但如果你事先阅读当前的文章，你会更好地理解它。</p><p id="f049" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在这里查看:</p><div class="la lb gp gr lc ld"><a href="https://inaguirre.medium.com/reusing-access-tokens-in-firebase-with-react-and-node-3fde1d48cbd3" rel="noopener follow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd iu gy z fp li fr fs lj fu fw is bi translated">用React和Node重用Firebase中的访问令牌</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">适用于Google APIs无过期访问(中级/高级)</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">inaguirre.medium.com</p></div></div><div class="nj l"><div class="ob l nl nm nn nj no ky ld"/></div></div></a></div><p id="29a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你在inaguirre96@gmail.com有任何问题/建议，请告诉我，我很乐意帮忙。</p><p id="fa61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我正在为高中建立一个名为雪球的金融教育平台。你可以在这里查看:</p><p id="7412" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ni" href="http://www.snowballfinances.com" rel="noopener ugc nofollow" target="_blank">www.snowballfinances.com</a></p><p id="8b9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">谢谢你，一如既往，</p><h2 id="36a9" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">编码快乐！</h2></div></div>    
</body>
</html>