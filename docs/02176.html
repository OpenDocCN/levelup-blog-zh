<html>
<head>
<title>Processing 19 million rows CSV in 1 second with Rust</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Rust在1秒钟内处理1900万行CSV</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/processing-19-million-rows-csv-in-1-second-with-rust-96c5b360171?source=collection_archive---------7-----------------------#2020-02-24">https://levelup.gitconnected.com/processing-19-million-rows-csv-in-1-second-with-rust-96c5b360171?source=collection_archive---------7-----------------------#2020-02-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="b5bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">周末建设和学习</p><h2 id="9561" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">背景和使用案例</h2><p id="fa19" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">作为我新年决心的一部分，我需要探索铁锈。这是我最后一篇关于铁锈的文章。</p><p id="f716" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lm" href="https://medium.com/@jayhuang75/file-processing-go-vs-rust-6e210a3168fd" rel="noopener">https://medium . com/@ jayhuang 75/file-processing-go-vs-rust-6e 210 a 3168 FD</a></p><p id="01d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天的用例是来自Kaggle的数据集，其中包含2016年至2019年蒙特利尔的自行车共享信息。</p><p id="9e5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">数据集如下:</strong></p><p id="8ad1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ln lo lp lq b">start_date</code>:行程开始的日期和时间(AAAA-MM-JJ hh: mm ) <br/> <code class="fe ln lo lp lq b">start_station_code</code>:始发站ID <br/> <code class="fe ln lo lp lq b">end_date</code>:行程开始的日期和时间(AAAA-MM-JJ hh: mm ) <br/> <code class="fe ln lo lp lq b">end_station_code</code>:终点站ID <br/> <code class="fe ln lo lp lq b">is_member</code>:类型用户。(1:用户，0:非用户)<br/> <code class="fe ln lo lp lq b">duration_sec</code>:总行程时间(秒)</p><p id="8e21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">数据集有35个文件，1G左右。</strong></p><blockquote class="lr ls lt"><p id="70d8" class="jq jr lu js b jt ju jv jw jx jy jz ka lv kc kd ke lw kg kh ki lx kk kl km kn im bi translated">对于一个简单的用例，我们希望找出所有的is_member行并获得总计数。</p></blockquote><p id="fea6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出应该是:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/b0962260daa9fba23f0140964b686fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*iaLvwVgSH0GhIGRhcH2omQ.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">已处理的输出</figcaption></figure><h2 id="938f" class="ko kp it bd kq kr ks dn kt ku kv dp kw kb kx ky kz kf la lb lc kj ld le lf lg bi translated">应用设计</h2><p id="3d54" class="pw-post-body-paragraph jq jr it js b jt lh jv jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn im bi translated">一切都是关于设计的，应用程序设计很重要，在你开始编码之前思考更重要。</p><blockquote class="mk"><p id="2908" class="ml mm it bd mn mo mp mq mr ms mt kn dk translated">好的软件设计和架构来自白板，而不是键盘。</p></blockquote><p id="05bd" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">为了最大化单机，我们会考虑使用worker pool和内置迭代器。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/fe330d5d8fbc52a97c8074f3f3118480.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*GK4ueXaNrpgCkUA4hGVyDw.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">创建一个容量无限的渠道。</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi na"><img src="../Images/15f3058f03c472a92e5f9ea345f8497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*Hwkp2NkJZQpOxbonK8VNIA.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">根据计算机的CPU数量，创建工作池。</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/75f37e6367184adda06b5e0e6103af59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZOyjz-MincJKELN77jbvLg.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">每个工人池执行迭代器，过滤器，计数。</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/fafd125e9a59c1accc0679871696afc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*BDVxf-lZ_NNMOfnjqN6aSw.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">使用通道的发送端发送回主执行器。</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nh"><img src="../Images/e9dd8d413a01443fc1189061640ba1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*gkryKVDlM9hY0kpi05MrLw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">在通道的接收端循环并准备输出。</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ni"><img src="../Images/b0ea26b2aebcc120a4700bfcffc67494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoFzg2QnZT75I3pCc61U1A.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">结果。</figcaption></figure><h1 id="34d5" class="nj kp it bd kq nk nl nm kt nn no np kw nq nr ns kz nt nu nv lc nw nx ny lf nz bi translated">我学到了什么？</h1><ol class=""><li id="0919" class="oa ob it js b jt lh jx li kb oc kf od kj oe kn of og oh oi bi translated">铁锈工人。</li><li id="02ee" class="oa ob it js b jt oj jx ok kb ol kf om kj on kn of og oh oi bi translated">Rust迭代器。</li><li id="0a36" class="oa ob it js b jt oj jx ok kb ol kf om kj on kn of og oh oi bi translated">永远享受编码的乐趣。:)</li></ol><p id="d6c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">如果你想看我的其他系列文章，请看下面:</strong></p><p id="deed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lm" href="https://medium.com/@jayhuang75" rel="noopener">https://medium.com/@jayhuang75</a></p></div></div>    
</body>
</html>