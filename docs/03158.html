<html>
<head>
<title>All You Want To Know About The Concept Of Immutable Server Is Here</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">所有你想知道的关于不可变服务器的概念都在这里</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/all-you-want-to-know-about-the-concept-of-immutable-server-is-here-c9510034b398?source=collection_archive---------12-----------------------#2020-04-22">https://levelup.gitconnected.com/all-you-want-to-know-about-the-concept-of-immutable-server-is-here-c9510034b398?source=collection_archive---------12-----------------------#2020-04-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0e813401d16fbe4e19fd5a16c5127ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rfFdkIi75-VxM9tM"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><em class="kc">原载于</em>【https://edward-huang.com】<em class="kc"/></figcaption></figure><p id="1771" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在传统的可变服务器中，服务器不断地被修改。工程师可以通过ssh连接到他们的服务器，并在他们的实例中修改一些配置。他们还可以逐个服务器地将新代码直接部署到那个服务器上，然后在那个服务器上修改他们的代码，这一切都是通过ssh实现的。</p><p id="2ccc" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">虽然现在看到工程师ssh到生产服务器并更新其配置是令人不快的，但在云计算出现之前，这是可以理解的。</p><p id="69ab" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在虚拟化、容器化架构和云计算兴起之前，部署应用程序需要大量的时间和资源。你需要购买物理服务器，这要花很多钱。当您想要设置服务器时，可能需要几周时间让服务器运行。</p><p id="425f" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">由于更改服务器的成本如此之高，因此尽可能长时间地保持服务器运行以避免停机，并改变服务器内的代码库或配置是可行的。然而，为临时修复而改变服务器的成本可能会遇到一些难以复制的意外错误。</p><p id="23d7" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">随着云计算的兴起，虚拟化，尤其是容器化，标志着服务器架构的一个转折点。拥有虚拟服务器不如拥有物理服务器昂贵。服务器管理配置和修复可以通过编程来完成，而不是对硬件进行操作。此外，虚拟服务器的规模更大，它们可以在几个小时而不是几天或几周内被轻松地销毁和创建。虚拟服务器的出现使不可变的服务器部署成为可能。</p><p id="1a14" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下面是不可变服务器的一些优点。</p><h1 id="ed61" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">已知的服务器状态和较少的部署错误</h1><p id="4950" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">通过使用永久状态，您不会修改正在运行的服务器的当前状态。您可以修改部署服务器新实例的基本映像。</p><p id="1106" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">每次有新的配置更改或功能时，您都要修改基本映像。在该基础映像上运行所有测试，并且仅在这些测试通过后部署服务器。</p><p id="b10a" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">通过修改基本映像，我们可以通过我们部署的新配置代码来确保服务器的当前状态。我们可以保持服务器状态完全一致。</p><h1 id="e62f" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">回滚和恢复过程</h1><p id="b9f1" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">对于不可变服务器，它引入了蓝绿色部署<a class="ae kd" href="https://martinfowler.com/bliki/BlueGreenDeployment.html" rel="noopener ugc nofollow" target="_blank">策略</a>。当新修改的特性出现问题时，它使得回滚到以前的更改变得更加容易。</p><p id="e217" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">每当我们创建一个构建或者发布的时候，一旦所有的测试用例都通过了，我们就创建了这个发布的一个新版本。因此，我们保留了版本发布的所有历史记录，并且可以很容易地回滚到以前的版本。</p><h1 id="4c38" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">数据处理</h1><p id="f7be" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">尽管我们将服务器视为一次性的，但存储在服务器中的数据却不是。因此，数据现在通常被持久化或复制到服务器之外的某个地方，比如共享文件系统或云数据库。</p><p id="93a0" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如今这听起来很熟悉，因为许多组织已经采用了不可变服务器模式。它在持续集成(CI)和持续交付(CD)的实践中使用，其中它只部署一个已知的工件，并在所有环境中运行应用程序。不可变的服务器模式在云服务中被广泛使用，例如Amazon Cloudformation，它提供了一种快速的方法来通过模板自动化您的基础设施。它自动化您的构建，并在构建失败时自动回滚到原始状态。藏物是唯一的真相来源。</p><h1 id="07a5" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="c360" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">不可变服务器在整个组织中广泛使用，这种模式的存在有其历史原因。</p><p id="b83b" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">借助不可变服务器，我们可以在整个基础架构中保持一致性，并避免任何<a class="ae kd" href="https://martinfowler.com/bliki/SnowflakeServer.html" rel="noopener ugc nofollow" target="_blank">雪花服务器</a>。</p><p id="9a45" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">不可变服务器通过创建新版本，将配置管理从服务器实例转移到基础映像。通过创建新版本，服务器可以在遇到意外问题时快速回滚和恢复。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="c044" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="kg ir">感谢阅读！如果你喜欢这篇文章，请随时订阅我的简讯</strong><a class="ae kd" href="https://edward-huang.com/subscribe/" rel="noopener ugc nofollow" target="_blank"><strong class="kg ir"/></a><strong class="kg ir">，以便在我写新内容时得到通知！</strong></p><p id="ecea" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">你也可以在<a class="ae kd" href="https://medium.com/@edwardgunawan880" rel="noopener"> Medium </a>上关注我更多类似的帖子。</p></div></div>    
</body>
</html>