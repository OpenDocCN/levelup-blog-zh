# 重构:透过表面看

> 原文：<https://levelup.gitconnected.com/refactoring-looking-past-the-surface-6383a91d0ba>

![](img/c34b1dc8f4043f22e777bb635320d35c.png)

在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上 [Wonderlane](https://unsplash.com/@wonderlane?utm_source=medium&utm_medium=referral) 拍摄的照片

# 常见的误解

我对重构有一个很大的误解，那就是只有当你的代码不好的时候，你才会去重构。如果你不得不重构，这意味着你第一次写代码的时候就搞砸了，现在你不得不修复你的错误。

因此，当我不得不告诉我的经理我必须花一些时间重构时，这就像是我承认自己不够好，第一次写“好代码”时，所以现在我必须修复我的错误。我没有把时间花在给项目添加新功能上，而是“*浪费”*在修复我的错误上。

这让我害怕重构。

尽管在这种情况下使用了重构，但是重构的原因远不止于此。其中大多数都是积极的原因，为您的代码增加了真正的价值。重构不仅仅是糟糕的代码或技术债务。

当你写代码的时候，你应该一直重构。你应该学会热爱它，并且擅长它。这会让你的生活轻松很多。

重构一段代码有很多原因。以下是其中的一些:

# 简单的改变

我读过的关于重构的最好的名言是:

> “让改变变得容易，然后让改变变得容易”
> 
> —肯特·贝克

这是一个简单而有力的声明，在许多层面上都有效。就重构而言，它是这样工作的:由于新的需求，你经常需要扩展或改变一段代码。有时候，这种改变看起来并不容易。

因此，在您开始编写新的需求之前，您需要后退一步，考虑一下您现有的代码。你如何改变它(*使改变变得容易*)，以使实现新的需求变得非常简单(*‘使改变变得容易’*)。

这就是重构最强大的地方。使用重构技术，您可以更改现有代码，同时确保行为保持不变。当你确定没有更多的重构要做时(你使改变变得容易)，你就可以继续*‘使改变变得容易’*并实现你的新需求。

在这种情况下，您重构了现有的代码并改变了它的设计，但不是因为它是一个糟糕的设计，而是因为它不再是该代码需求的正确设计。通过重构，你改进了它，增加了它的价值。

# 现有功能的需求变更

当需求改变时，代码设计也必须改变，以便能够反映这些变化。

功能的每次改变都是重新评估当前设计的机会，看看是否有可以改进的地方。

因此，在您根据新的需求进行了功能更改之后，是时候进行重构了。也许现在应该将一个方法提取到一个新的类中。或者这里使用的设计模式，看起来不再是正确的解决方案。

但是在为当前需求设计解决方案时，不要担心预测未来的需求变化。你不需要。确保您当前的设计最适合当前的需求。你从重构技巧中获得的自信应该让你不再害怕任何未来的需求变化。如果发生了，你知道该怎么做。

# 功能第一，重构第二

*'* ***什么*** *'* 代码做的事情和 *'* ***代码怎么做*** *'* 代码做的事情常常可以被看作是两个不同的问题，可以分别处理。 *'* ***什么*** *'* 为代码的功能，而 *'* ***如何*** *'* 为代码的设计。

首先将所有精力集中在获得正确的功能上通常非常有帮助。一开始你并不关心设计，因为你相信你的重构技巧会帮助你得到最好的设计。当“你的代码*做什么”*(功能性)已经处理好的时候，你就可以自由地思考*如何*(设计)*。*

# 前期设计

重构减轻了第一次就必须把一切都做好的焦虑。您不必担心，也不必花太多时间试图马上为您的解决方案找到完美的设计。

你可以暂时把它做得足够好，用它工作一会儿，这样你就可以对它有一个好的感觉，然后回来重构它。

如果有反馈，每个解决方案都可以变得更好。对你来说，这种情况下的反馈是你自己处理代码的经验。每次你不得不使用它的时候，你重构并使它变得更好一点。

这并不意味着你第一次就失败了。你现在有更多的信息来使它变得更好。

# 可读性

你正在处理别人的代码，你注意到如果你对它进行一些重构，它的一部分可以变得更容易理解。如果你重命名一个方法，或者你提取一段代码到一个新的方法中，这将使它对将来从事这个工作的人来说更具可读性和可理解性。因此，您重构它以提高其可读性，从而增加其整体价值。你应该永远试着让它比你发现它时更好。

# 结论

重构不仅仅是关于糟糕的代码——它远不止于此。重构也有许多积极的理由。如果你想成为一名更好的开发人员，认识重构的原因和重构技术是你应该掌握和每天做的事情。

一本帮助你提高重构技巧的有用的书是马丁·福勒的《重构》。