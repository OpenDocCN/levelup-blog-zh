<html>
<head>
<title>Deploy Node.js App to Fly.io</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Node.js应用程序部署到Fly.io</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploy-node-js-app-to-fly-io-fb0f7ea9c13a?source=collection_archive---------12-----------------------#2022-12-19">https://levelup.gitconnected.com/deploy-node-js-app-to-fly-io-fb0f7ea9c13a?source=collection_archive---------12-----------------------#2022-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ecb739b2835bcfb6a880a3e31426bab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QPd0n1f-0VAM4glnpserg.png"/></div></div></figure><h1 id="9ff8" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="5455" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在本文中，我们将通过3个简单的步骤将Node.js应用程序部署到<a class="ae lu" href="https://fly.io/" rel="noopener ugc nofollow" target="_blank"> Fly.io </a>中。Fly.io是一个与Heroku非常相似的托管平台，使用他们的CLI部署应用程序非常容易。</p><p id="0bd6" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">他们有免费限额，如果你的应用程序没有超过你在这里看到的这些限制，你可以免费使用他们的服务。</p><h2 id="a328" class="ma jz iq bd ka mb mc dn ke md me dp ki lh mf mg km ll mh mi kq lp mj mk ku ml bi translated">免费津贴</h2><p id="1b24" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">所有计划中免费包含的资源:</p><ul class=""><li id="c80f" class="mm mn iq ky b kz lv ld lw lh mo ll mp lp mq lt mr ms mt mu bi translated">多达3个共享cpu-1x 256mb虚拟机</li><li id="3b9f" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated">3GB永久卷存储(总计)</li><li id="317e" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated">160GB出站数据传输</li></ul><h1 id="f7e8" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">步骤1:安装flyctl</h1><p id="674d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">打开您想要部署的应用程序，如果您只是想跟进，这里有我的<a class="ae lu" href="https://github.com/hayk-simonyan/basic-express-api" rel="noopener ugc nofollow" target="_blank"> simple Node.js应用程序</a>用于演示部署。</p><p id="70c7" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">要部署我们的应用程序，我们需要做的第一件事是<a class="ae lu" href="https://fly.io/docs/hands-on/install-flyctl/" rel="noopener ugc nofollow" target="_blank">安装flyctl </a>，这是一个用于在Fly.io上管理应用程序的CLI</p><ul class=""><li id="fbc3" class="mm mn iq ky b kz lv ld lw lh mo ll mp lp mq lt mr ms mt mu bi translated"><strong class="ky ir"> Mac OS: </strong>如果你在Mac OS上并且安装了brew，你可以使用这个命令来安装flyctl <br/> <code class="fe na nb nc nd b">brew install flyctl</code> <br/>否则，你需要运行一个脚本来安装它<br/> <code class="fe na nb nc nd b">curl -L <a class="ae lu" href="https://fly.io/install.sh" rel="noopener ugc nofollow" target="_blank">https://fly.io/install.sh</a> | sh</code></li><li id="dc49" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated"><strong class="ky ir"> Linux: </strong>对于Linux用户，需要运行这个脚本<br/>T2】</li><li id="2e93" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated"><strong class="ky ir"> Windows: </strong>在Windows上运行Powershell安装脚本<br/>T3】</li></ul><h1 id="a085" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">步骤2:注册/登录飞行</h1><p id="ee30" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">下一步是注册或登录Fly.io。如果您已经有一个帐户，请使用此命令从终端登录</p><pre class="ne nf ng nh gt ni nd nj bn nk nl bi"><span id="d2ef" class="nm jz iq nd b be nn no l np nq">flyctl auth login</span></pre><p id="5a6d" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">否则，使用注册命令注册并登录</p><pre class="ne nf ng nh gt ni nd nj bn nk nl bi"><span id="5b4c" class="nm jz iq nd b be nn no l np nq">flyctl auth signup</span></pre><p id="e666" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">我还没有帐户，所以我将使用注册命令来创建一个。在你的终端中输入<code class="fe na nb nc nd b">flyctl auth signup</code>，使用GitHub进行注册。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/e9cf0e73607a386207f6f8a991a9c413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*kaFGJKa13Dk2f2m_R6MIJQ.png"/></div></div></figure><p id="3d7b" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">注册后，它会询问您卡的详细信息，尽管您可以选择免费试用而无需提供信用卡，但部署您的应用程序时需要提供信用卡，因此最好在此处提供信用卡。如果你没有超过他们的免费限额，它根本不会向你收费。</p><h1 id="f79d" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">步骤3:部署</h1><p id="8d7a" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">注册并提供卡信息或登录后，如果你已经有一个帐户，最后一步是使用flyctl CLI部署您的应用程序。</p><p id="fc61" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">在此之前，<a class="ae lu" href="https://community.fly.io/t/failed-due-to-unhealthy-allocations/199" rel="noopener ugc nofollow" target="_blank">您必须将您的内部端口设置为8080 </a>，因为它在CLI生成的<code class="fe na nb nc nd b">fly.toml</code>文件中被设置为8080</p><p id="7874" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">因此，将端口更新为8080并运行deploy命令。</p><pre class="ne nf ng nh gt ni nd ns nt aw nu bi"><span id="7ed2" class="ma jz iq nd b gy nv nw l nx nq">flyctl launch</span><span id="4a4a" class="ma jz iq nd b gy ny nw l nx nq">Scanning source code<br/>Detected a Dockerfile app<br/>? Choose an app name (leave blank to generate one):<br/>? Choose a region for deployment: &gt; Miami, Florida (US) (mia)<br/>? Would you like to set up a Postgresql database now? No<br/>? Would you like to set up an Upstash Redis database now? No<br/>? Would you like to deploy now? Yes</span><span id="05dd" class="ma jz iq nd b gy ny nw l nx nq">Deploying<br/>...</span></pre><ul class=""><li id="fd7b" class="mm mn iq ky b kz lv ld lw lh mo ll mp lp mq lt mr ms mt mu bi translated">如果您有docker文件，它将自动检测它，如果您没有，它将检测Node.js应用程序并开始部署</li><li id="458a" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated">接下来，它会询问一个应用程序名称，留空它会生成一个名称</li><li id="3648" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated">选择您想要部署的区域，无论哪个离您的用户最近</li><li id="347e" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated">它询问您是否想要设置Postgresql或Redis数据库—我将选择否</li><li id="2b5b" class="mm mn iq ky b kz mv ld mw lh mx ll my lp mz lt mr ms mt mu bi translated">您想现在部署吗？是</li></ul><pre class="ne nf ng nh gt ni nd nj bn nk nl bi"><span id="b81c" class="nm jz iq nd b be nn no l np nq">1 desired, 1 placed, 1 healthy, 0 unhealthy [health checks: 1 total, 1 passing]<br/>--&gt; v1 deployed successfully</span></pre><h1 id="1241" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">验证部署</h1><p id="5c65" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">要验证它是否有效，请转到您的仪表板。选择您刚刚部署的应用程序，并打开主机名下提供的链接。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/73ec3fb00578945ad9c077d854c31195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mdTHiLQSsJ1JEJROjgv_gg.png"/></div></div></figure><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/a3011ac9e77d27d6519cf5baac9b455e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GhokPsWo79HjbAo26O6x6g.png"/></div></div></figure><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/570f4727d25f3101d8bf42b3da635921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tZczQ_1n9KredC4X0UIpQ.png"/></div></div></figure><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/fc4285d45e4fbab9e7c60e6803710619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LX3ihuVolIVyKcfj11OyjQ.png"/></div></div></figure><p id="d5d5" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">我们的应用程序已经成功启动并运行</p><p id="9d05" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">此外，您的代码中可能有环境变量，这些变量可以添加到仪表板中的secrets选项卡下。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/c09efb0ff928c510457574ffd5142b5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*ZjrCT1d9uDJo2AcTzTpDhw.png"/></div></figure><h1 id="0dd7" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">摘要</h1><p id="c5bc" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这就是将您的应用部署到Fly.io的全部步骤，对于更复杂的应用，可能需要一些额外的步骤，但过程是相同的，您已经可以使用本指南开始部署了。</p><h2 id="a88d" class="ma jz iq bd ka mb mc dn ke md me dp ki lh mf mg km ll mh mi kq lp mj mk ku ml bi translated">资源</h2><p id="ce40" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><a class="ae lu" href="https://fly.io/docs/languages-and-frameworks/node/" rel="noopener ugc nofollow" target="_blank">部署节点App </a> <br/> <a class="ae lu" href="https://fly.io/docs/getting-started/log-in-to-fly/" rel="noopener ugc nofollow" target="_blank">登录Fly </a> <br/> <a class="ae lu" href="https://fly.io/docs/hands-on/install-flyctl/" rel="noopener ugc nofollow" target="_blank">安装flyctl </a> <br/> <a class="ae lu" href="https://fly.io/docs/about/pricing/" rel="noopener ugc nofollow" target="_blank"> Fly.io定价</a><br/><a class="ae lu" href="https://community.fly.io/t/failed-due-to-unhealthy-allocations/199" rel="noopener ugc nofollow" target="_blank">Fly . io常见问题</a> <br/> <a class="ae lu" href="https://fly.io/docs/getting-started/troubleshooting/" rel="noopener ugc nofollow" target="_blank">解决您的部署问题</a></p><p id="643f" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">🔔感谢您阅读并关注更多部署指南</p></div></div>    
</body>
</html>