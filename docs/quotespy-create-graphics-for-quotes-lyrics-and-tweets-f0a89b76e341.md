# quotespy:为引用、歌词和推文创建图形

> 原文：<https://levelup.gitconnected.com/quotespy-create-graphics-for-quotes-lyrics-and-tweets-f0a89b76e341>

2019 年 10 月，我[写了一篇中型文章](https://medium.com/analytics-vidhya/how-to-create-twitter-screenshots-with-python-c142ef71fda7?source=friends_link&sk=8a5bb375ca2969b6d59231d8796d7ce0)，讲述如何使用 Python 和 PIL 图书馆创建类似 tweet 的图形。现在我发布了一个完整的 Python 库，可以用于这个目的，也可以用于歌词和引用图形。我叫它 quotespy。

在本文中，我将向您展示基于项目自述文件中包含的示例的演示，从最简单的用法到将 quotespy 与`os`模块集成在一起的更“高级”的案例。

对于初学者，用通常的 pip 命令安装库

```
pip install quotespy
```

你就可以走了。

# **用 quotespy.graphics 创建歌词/引语图形**

quotespy 有两个软件包，一个用于类似推特的图形，另一个用于歌词/引语。我们将首先讨论后者。

quotespy.graphics 基本用法

正如您所看到的，给定一个包含图形信息的字典和一个图形设置(默认)格式，上面的脚本生成了以下内容。png 文件。

![](img/94f2540ab1d989eea77dc924ebe59bd0.png)

基本歌词图形示例

就我个人而言，我不认为默认设置的字体(Arial)适合图形/歌词，但我选择了它，因为(1)它是 tweets 包的字体,( 2)它在潜在用户的机器上更常见。

因此，为了改进定制，您可以传递您自己的设置，而不是传递一个空字典作为第二个参数。我称之为`graphic_settings`字典，它包括图形的格式设置。请注意，这里显示的所有字典，无论是图形信息还是图形格式，都需要例子中包含的所有键值对。说到这里，请注意，无论是空字典还是自定义设置的完整字典，都必须作为第二个位置参数传递。

带有自定义图形设置的 quotespy.graphics 基本用法

正如您在上面的代码片段中看到的，您可以选择字体系列、字体大小、图形的尺寸(宽度和高度，都是像素)、配色方案(背景和文本颜色，都是十六进制值)、每行的最大字符数以及行间的垂直边距。哦，因为我们使用自定义图形设置，所以没有必要指定`default_settings_format`。

此外，请注意，在本例中还指定了输出目录。省略时，创建的图形的目的地默认为当前目录，但当给定路径(相对或绝对)时，它会保存在该位置。在这种情况下，图形保存在当前目录下的“输出”文件夹中。

![](img/d88bd462ad880ea2443319bd4b690c6f.png)

带有自定义设置的基本歌词图形示例

理想情况下，使用默认设置创建的图形应该是这样的，使用无墨字体，但由于默认情况下它不可用，所以我保留了 Arial 作为默认设置。

下一个例子是从一个. txt 或者。json 文件为每一个创建一个图形。假设您手头有一个这样的. json 文件

quotes.json 示例文件

或. txt 替代文件

quotes.txt 示例文件

您可以使用`gen_graphics`功能来加载文件，并为每个引用/歌词创建图形:

quotespy.graphics 加载多个报价的基本用法

同样，我们使用自定义图形设置，并指定。引用的 json 文件。所有创建的报价图形再次保存在“输出”文件夹中。这是一个创建的报价图形的示例。

![](img/423c457d94ada70938be8c34318432d6.png)

引用图形示例

当然，同样的`gen_graphics`函数也可以用于歌词文件。这里的可变因素是所使用的图形设置，文本只是在图形中绘制的内容。

对于`graphics`一揽子计划来说，差不多就是这些了。现在让我们继续讨论`tweet_graphics`的对应部分。

# **使用 quotespy.tweet_graphics 创建推文图形**

创建 tweet 图形同样简单，只需为信息和图形设置字典添加一些键值对。

首先，`tweet_info`字典需要 tweet/file 的名称(而不是`title`)、用户的用户名和标签/句柄，当然还有实际的 tweet 文本。也可以添加配置文件图片的路径，或者保留为空字符串。

tweet_graphics 基本用法

在这种情况下，配置文件图片位于“samples”文件夹中，名称为“user_photo.png”，也就是说，它的位置是用相对路径指定的。哦，请注意，个人资料图片被调整为图形尺寸的十分之一，并带有圆形裁剪。

类似于`graphics`包，`create_tweet`功能也接受默认的图形设置:“蓝色”、“亮”和“暗”，这反映了 Twitter 的主题。下面是所示代码片段的输出图形。

![](img/c5c1498c95886b447c4fa44c4c57a151.png)

tweet_graphics 基本使用示例输出

当然，也可以传递自定义图形设置。

带有自定义图形设置的基本 quotespy.tweet_graphics 用法

请注意用于 tweet 的`graphic_settings`字典是如何包含`font_size_text`和`font_size_header`键的，因此标题(用户名和标签/句柄)可以与 tweet 的其余部分大小不同。

这一次图形保存在当前目录中，并且它没有个人资料图片:

![](img/7591e8e19f1fea22c1d03f67498a544f.png)

带有自定义设置的基本 tweet 图形示例

最后，也可以加载一个包含多个 tweets 的文件，但仅限于这一次。json 文件。

假设您有一个这样的文件(一个 JSON 对象数组，作为一个`graphic_info`字典列表加载):

tweets.json 示例文件

然后，可以使用以下代码为文件中的每个 tweet 生成图形:

它创建了两个图形，文件中的每个 tweet 都有一个图形，使用默认的“light”主题图形设置。第二个看起来像这样:

![](img/039685b3d1b67c2b21b8dd2a500afb15.png)

gen_tweet 示例输出

我展示了第二张 tweet 图片，这样你就可以看到长用户名和文本的图片了。

# "高级用法"

最后，我想展示一个“高级用法”的例子，它将 quotespy 与`os`模块集成在一起，在每个 tweet 的文件夹中创建 tweet 的“亮”和“暗”模式图形。

quotespy 高级用法

首先，有一个`tweet_info`字典列表，也就是推文列表。“顶层”保存目标再次是“输出”文件夹，在`PATH`变量中指定。然后，指定两个自定义图形设置字典:一个用于亮模式，另一个用于暗模式。

现在所有的信息都已确定，我们可以循环遍历推文列表，用`create_tweet`函数创建每一条推文。然而，在创建任何图形之前，我们在“输出”中创建了一个新文件夹来存储当前 tweet 的两个版本(浅色和深色)。这是通过`os.path.join`和`mkdir`终端命令(通过`os.system`执行)创建与 tweet 同名的文件夹来实现的。

最后，创建浅色模式版本，为了创建深色版本，将“_DM”附加到 tweet 的名称上，以便每个版本有不同的名称。如果名称相同，黑暗模式版本将覆盖光明模式版本。

运行脚本后,“output”文件夹现在包含三个文件夹，每个 tweet 一个，每个文件夹中有一个深色和浅色版本。

# 结论

编写这个库是一次宝贵的经历。首先，我相信我创建了一个有趣的库，可以帮助人们准备好在社交媒体上发布的内容。第二，我在创作过程中学到了很多。我一直在本地用独立的脚本进行这些创作，但是现在代码已经公开了。

这个项目的另一个好处是熟悉了`pytest`测试库。它很灵活，允许快速编写自动化测试，编写相同测试的变体的开销很小(例如，测试一个函数为不同的`graphic_settings`字典抛出了哪个异常)。不幸的是，我没能写出我想要的所有测试，但至少这个库有足够好的代码覆盖率(大约 80%)。

最后，我想指出 micha karzyński 的“ [Python 项目成熟度检查表](http://michal.karzynski.pl/blog/2019/05/26/python-project-maturity-checklist/)”的方向。从分离的脚本到准备出版的最终库，这确实是一个很好的指南。

quotespy 在 GitHub [这里](https://github.com/Ze1598/quotespy)有售，在 PyPi [这里](https://pypi.org/project/quotespy/1.0.1/)有售。