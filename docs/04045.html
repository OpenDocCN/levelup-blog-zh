<html>
<head>
<title>Challenge: Predict a Sine function with Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">挑战:用线性回归预测正弦函数</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/challenge-predict-a-sine-function-with-linear-regression-8186e46a7313?source=collection_archive---------8-----------------------#2020-06-07">https://levelup.gitconnected.com/challenge-predict-a-sine-function-with-linear-regression-8186e46a7313?source=collection_archive---------8-----------------------#2020-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="79a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你能用线性回归预测正弦函数吗？</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h2 id="4d87" class="kv kw it bd kx ky kz dn la lb lc dp ld kb le lf lg kf lh li lj kj lk ll lm ln bi translated">动机</h2><p id="77d0" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb lq kd ke kf lr kh ki kj ls kl km kn im bi translated">我总是说90%的机器学习可以用线性回归来完成。当处理一个巨大的领域，比如图像、声音等时，你只需要神经网络或其他东西。</p><p id="9b6a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在向学生讲授线性回归时，我们决定尝试预测一个正弦函数，如下图所示，只使用线性回归。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/5418d70e71748e8125095b2da1390c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*xTesSJ7_NTS0JAkJ3CRskg.png"/></div></figure><p id="c7d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该功能是:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="5a16" class="kv kw it mc b gy mg mh l mi mj">y = (np.sin(x)+1)*10+2*x+np.random.rand(100)*5</span></pre><p id="d0df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">很可能，几乎所有人都会说这是不可能的，人们可能会想出一条正好在中间穿过这个函数的线，但永远不会想出一个精确的模型来重复这些波。</p><p id="fafe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感兴趣吗？</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h2 id="1361" class="kv kw it bd kx ky kz dn la lb lc dp ld kb le lf lg kf lh li lj kj lk ll lm ln bi translated">滚动窗</h2><p id="6963" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb lq kd ke kf lr kh ki kj ls kl km kn im bi translated">我们在这里做的是使用滚动窗口为线性回归准备数据集:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="86fb" class="kv kw it mc b gy mg mh l mi mj">x = np.arange(0,100)<br/>y = (np.sin(x)+1)*10+2*x+np.random.rand(100)*5<br/><br/>points = 12<br/>names = []<br/><strong class="mc iu">for</strong> i <strong class="mc iu">in</strong> range(points):<br/>  names.append("a"+str(i))<br/>ds = []<br/>target = []<br/><strong class="mc iu">for</strong> i <strong class="mc iu">in</strong> range(points,len(x)-1):<br/>  ds.append(y[i-points:i])<br/>  target.append(y[i]) <br/>df = pd.DataFrame(np.array(ds),columns=names) <br/>dfy = df <br/>dfy["target"] = target</span></pre><p id="fac0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们得到一个包含字段的数据集:</p><p id="a2cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mc b">a0,a1,a2,...,a11,target</code></p><p id="6a61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中<code class="fe mk ml mm mc b">a0,...,a11</code>是前12个点，目标是下一个点:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/e7ded9c844b42d63866162966e53310c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*9f5qXVeR14geCM4efKzI8Q.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">你可能会看到这是一个滚动窗口</figcaption></figure><p id="914e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每下一行都是通过左移和添加函数的下一个值来重复上一行。</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h2 id="4bb1" class="kv kw it bd kx ky kz dn la lb lc dp ld kb le lf lg kf lh li lj kj lk ll lm ln bi translated">线性回归(拟合-预测)</h2><p id="1d67" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb lq kd ke kf lr kh ki kj ls kl km kn im bi translated">长话短说，我们现在符合我们的模型:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="a9e8" class="kv kw it mc b gy mg mh l mi mj">model = LinearRegression()<br/>model.fit(dfy[names],dfy["target"])<br/>plt.plot(np.arange(len(df)),df["target"])<br/>plt.plot(np.arange(len(df)),model.predict(dfy[names]))</span></pre><p id="1c70" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们得到了想要的图像:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/1bd1ec9188442ae6842f60188acbfa14.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*t006KUSLazhExm7KBdKBZw.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">你看多准啊！</figcaption></figure><p id="9801" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是我们真的能预测未来吗？</p><p id="e8a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们试试:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="4f66" class="kv kw it mc b gy mg mh l mi mj">last = dfy.iloc[-1]<br/>prediction = []<br/>n = []<br/><strong class="mc iu">for</strong> i <strong class="mc iu">in</strong> range(points-1):<br/>  n.append(last["a"+str(i+1)])<br/>n.append(last["target"])<br/>n.append(model.predict(np.array(n).reshape(1,-1))[0])<br/>prediction.append(n[-1])<br/><strong class="mc iu">for</strong> i <strong class="mc iu">in</strong> range(100):<br/>  n = n[1:]<br/>  n.append(model.predict(np.array(n).reshape(1,-1))[0])<br/>  prediction.append(n[-1])</span></pre><p id="5e2b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还有…剧情！</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="3a1c" class="kv kw it mc b gy mg mh l mi mj">plt.plot(np.arange(len(dfy)),dfy["target"],c="green")<br/>plt.plot(np.arange(len(dfy),len(dfy)+len(prediction)),prediction,c="red")</span></pre><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/4cf8f775e7b629ea75ce0fc922b4fb98.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*a2rQPtbEqmtR5kRduFnBgw.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">是的，我们可以！</figcaption></figure><p id="e7df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这只是线性回归有多强大的另一个例子！</p><p id="f14f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有好看的代码！</p></div></div>    
</body>
</html>