<html>
<head>
<title>How to do Widget testing in a Flutter application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Flutter应用程序中进行小部件测试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-do-widget-testing-in-a-flutter-application-da2105909912?source=collection_archive---------11-----------------------#2022-09-08">https://levelup.gitconnected.com/how-to-do-widget-testing-in-a-flutter-application-da2105909912?source=collection_archive---------11-----------------------#2022-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="473f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们来看看Flutter应用程序中的小部件测试是如何工作的。通过本指南提高您的测试知识。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a24793419ec8ec13ad015e7f73bd4de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M9fs52dBylepKB16T3u9Gg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://pixabay.com/users/geralt-9301/" rel="noopener ugc nofollow" target="_blank"> geralt </a>从<a class="ae ky" href="https://pixabay.com/illustrations/board-school-university-to-learn-361516/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄</figcaption></figure><p id="c698" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Flutter提供了几种类型的测试，可以用来确保正确的应用程序行为。还有<a class="ae ky" href="https://docs.flutter.dev/cookbook/testing/unit/introduction" rel="noopener ugc nofollow" target="_blank">单元测试</a>、<a class="ae ky" href="https://docs.flutter.dev/testing/integration-tests" rel="noopener ugc nofollow" target="_blank">集成测试</a>，最后是<a class="ae ky" href="https://docs.flutter.dev/cookbook/testing/widget/introduction" rel="noopener ugc nofollow" target="_blank">小部件测试</a>。在本文中，我们将关注小部件测试。这意味着应用程序的一部分在测试期间被渲染，你可以描述测试步骤来复制真实用户的行为。Flutter SDK提供了模拟完整工作流的方法。</p><blockquote class="lv"><p id="05c6" class="lw lx it bd ly lz ma mb mc md me lu dk translated">如果您想深入测试颤振应用，请查看📙<a class="ae ky" href="https://xeladu.gumroad.com/l/ftg" rel="noopener ugc nofollow" target="_blank">我的免费电子书</a>有更多细节！</p></blockquote><h2 id="db37" class="mf mg it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">要测试的应用程序</h2><p id="2aaa" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我创建了一个简单的应用程序，需要一些小部件测试。你可以在下面看到一个演示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/d9ea0b6dd7a1c2d12c9439003fb438c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/1*pcjTs_7wA4_cDuJNpjNkCg.gif"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">演示颤振应用程序将由作者测试</figcaption></figure><p id="0143" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该应用包含一个带有静态<a class="ae ky" href="https://api.flutter.dev/flutter/material/AppBar-class.html" rel="noopener ugc nofollow" target="_blank">应用栏</a>的<a class="ae ky" href="https://api.flutter.dev/flutter/material/Scaffold-class.html" rel="noopener ugc nofollow" target="_blank">脚手架</a>，一个描述<a class="ae ky" href="https://api.flutter.dev/flutter/widgets/Text-class.html" rel="noopener ugc nofollow" target="_blank">文本</a>，一个<a class="ae ky" href="https://api.flutter.dev/flutter/widgets/ListView-class.html" rel="noopener ugc nofollow" target="_blank">列表视图</a>，以及一个<a class="ae ky" href="https://api.flutter.dev/flutter/material/FloatingActionButton-class.html" rel="noopener ugc nofollow" target="_blank">浮动操作按钮</a>。当您点击按钮时，一个新的行被插入到ListView中，并带有一个0到10之间的随机数，标题文本被更新，并显示一个<a class="ae ky" href="https://api.flutter.dev/flutter/material/SnackBar-class.html" rel="noopener ugc nofollow" target="_blank"> SnackBar </a>。您也可以长按删除条目。一个简单的点击显示你点击了哪一行的确认。这就是我们现在要测试的。💪</p><h2 id="778a" class="mf mg it bd mh mi ne dn mk ml nf dp mn li ng mp mq lm nh ms mt lq ni mv mw mx bi translated">编写测试</h2><p id="db67" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">由于应用程序工作流程非常简单，我们将只编写一个满足所有需求的测试。当然，如果有意义的话，您可以将您的测试分成多个测试。良好的测试组织对于较大的应用程序来说是必不可少的，所以不要着急，想想什么是合理的。</p><p id="6592" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的测试将完成以下任务: (🔹行动步骤，🔸验证步骤)</p><p id="0aa2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔸验证已经存在3个数据项<br/>🔹点击浮动操作按钮<br/>🔸验证是否添加了新的数据项<br/>🔹轻点第三项<br/>🔸验证SnackBar显示的数据与列表中的数据相同<br/>🔹长按第2项<br/>🔸验证是否删除了正确的项目</p><p id="5fc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">小部件测试的测试框架类似于单元测试，但是有一个额外的<a class="ae ky" href="https://api.flutter.dev/flutter/flutter_test/WidgetTester-class.html" rel="noopener ugc nofollow" target="_blank"> WidgetTester </a>参数。它总是看起来像这样</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="cb7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> WidgetTester </strong></p><p id="5cba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://api.flutter.dev/flutter/flutter_test/WidgetTester-class.html" rel="noopener ugc nofollow" target="_blank"> WidgetTester </a>是测试期间执行动作的中央单元。例如，有一些方法可以</p><p id="e760" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">写入<a class="ae ky" href="https://api.flutter.dev/flutter/material/TextField-class.html" rel="noopener ugc nofollow" target="_blank">TextField</a>widgets→<a class="ae ky" href="https://api.flutter.dev/flutter/flutter_test/WidgetTester/enterText.html" rel="noopener ugc nofollow" target="_blank">enter text</a><br/>【点击widgets】→<a class="ae ky" href="https://api.flutter.dev/flutter/flutter_test/WidgetController/tap.html" rel="noopener ugc nofollow" target="_blank">点击</a> <br/>【触发动画和渲染】→ <a class="ae ky" href="https://api.flutter.dev/flutter/flutter_test/WidgetTester/pump.html" rel="noopener ugc nofollow" target="_blank"> pump </a>、<a class="ae ky" href="https://api.flutter.dev/flutter/flutter_test/WidgetTester/pumpAndSettle.html" rel="noopener ugc nofollow" target="_blank"> pumpAndSettle </a></p><p id="ff54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">查找小工具</strong></p><p id="cbd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要查找小部件，可以使用<a class="ae ky" href="https://api.flutter.dev/flutter/flutter_test/Finder-class.html" rel="noopener ugc nofollow" target="_blank">查找器</a>类。它有很多方法可以找到你想要的东西。一些例子是</p><p id="98d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">find.byType <br/></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/4528911656a22962ae46726e1af5547b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*pCQnPz8i3ssg46OWdvp3fA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">VS代码中查找器类的自动完成选项</figcaption></figure><p id="593c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">验证</strong></p><p id="5089" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了验证，您可以像在常规单元测试中一样使用<a class="ae ky" href="https://api.flutter.dev/flutter/package-test_api_expect/package-test_api_expect-library.html" rel="noopener ugc nofollow" target="_blank"> expect库</a>。典型的expect语句可能如下所示:</p><p id="c2d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nm nn no np b">expect(find.byText(”test”), findsOneWidget);</code></p><p id="b712" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">寻找一个或多个特定的小部件并断言它。</p><p id="7b0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">把所有的放在一起</strong></p><p id="8cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">小部件测试中的一般工作流程总是相同的。首先，您使用Finder来识别您想要与之交互的小部件。然后，将它传递给WidgetTester，widget tester执行一个动作并触发动画和渲染。最后，用Expect类验证结果。</p><p id="0293" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">测试示例如下所示。最后会链接整个app源代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="664b" class="mf mg it bd mh mi ne dn mk ml nf dp mn li ng mp mq lm nh ms mt lq ni mv mw mx bi translated">结论</h2><p id="84ca" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">有了这个指南，你应该能够编写小部件测试来验证你的应用程序的正确行为。</p><h2 id="cdba" class="mf mg it bd mh mi ne dn mk ml nf dp mn li ng mp mq lm nh ms mt lq ni mv mw mx bi translated">源代码</h2><p id="a211" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">你可以在<a class="ae ky" href="https://github.com/xeladu/flutter_widget_test" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到源代码。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="f5ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/@xeladu/membership" rel="noopener">通过我的推荐链接加入成千上万的媒体会员，每月只需5美元就可以阅读你想阅读的文章。</a></p><div class="nx ny gp gr nz oa"><a href="https://medium.com/@xeladu/membership" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">通过我的推荐链接加入Medium-xela du</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">只需点击一下，就可以通过会员资格访问数千篇文章！您的会员资格只需5美元一张…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div><p id="6173" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击<a class="ae ky" href="https://xeladu.medium.com/subscribe" rel="noopener"> <strong class="lb iu">这里</strong> </a>把我所有的新文章都发到你的邮箱里🔔如果你浏览<a class="ae ky" href="https://xeladu.gumroad.com/" rel="noopener ugc nofollow" target="_blank">我的口香糖商店</a>，你可能会找到你喜欢的东西(<a class="ae ky" href="https://xeladu.gumroad.com/l/scratch" rel="noopener ugc nofollow" target="_blank">甚至是免费的</a>)🏬</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><div class="kj kk kl km gt"><div role="button" tabindex="0" class="ab bv gv cb fp op oq bn or ks ex"><div class="os l"><div class="ab q"><div class="l di"><img alt="xeladu" class="l de bw ot ou fe" src="../Images/c6d3049714795a7a8169ac0957f05cfe.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*zDQIuT_7N15cT_wzRxjc4g.jpeg"/><div class="fb bw l ot ou fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://xeladu.medium.com/?source=post_page-----da2105909912--------------------------------" rel="noopener follow" target="_top">赛拉杜</a></p></div></div><div class="ox oy gw l"><h2 class="bd iu uy qc fp uz fr fs og fu fw is bi translated">测试你的Flutter应用</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi va au vb vc vd rq ve an eh ei vf vg vh el em eo de bk ep" href="https://xeladu.medium.com/list/test-your-flutter-app-aabad9825b7f?source=post_page-----da2105909912--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vi l fo"><span class="bd b dl z dk">6 stories</span></div></div></div><div class="pk dh pl fp ab pm fo di"><div class="di pc bv pd pe"><div class="dh l"><img alt="" class="dh" src="../Images/b22d3d39087af83e4b4428691ece9051.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*M9fs52dBylepKB16T3u9Gg.jpeg"/></div></div><div class="di pc bv pf pg ph"><div class="dh l"><img alt="" class="dh" src="../Images/1bf539f85e80a4f8d2b1a0c970cd006a.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*bEtexwcMFVhNYURE"/></div></div><div class="di bv pi pj ph"><div class="dh l"><img alt="" class="dh" src="../Images/636c1e82bc130a3a75e6b355e38aaaff.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*2m6PhvUyTNtgTaVa"/></div></div></div></div></div><div class="nx ny gp gr nz"><div role="button" tabindex="0" class="ab bv gv cb fp op oq bn or ks ex"><div class="os l"><div class="ab q"><div class="l di"><img alt="xeladu" class="l de bw ot ou fe" src="../Images/c6d3049714795a7a8169ac0957f05cfe.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*zDQIuT_7N15cT_wzRxjc4g.jpeg"/><div class="fb bw l ot ou fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated">xeladu </p></div></div><div class="ox oy gw l"><h2 class="bd iu uy qc fp uz fr fs og fu fw is bi translated">适合初学者的颤振文章</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi va au vb vc vd rq ve an eh ei vf vg vh el em eo de bk ep" href="https://xeladu.medium.com/list/flutter-articles-for-beginners-a040ea777956?source=post_page-----da2105909912--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vi l fo"><span class="bd b dl z dk">24 stories</span></div></div></div><div class="pk dh pl fp ab pm fo di"><div class="di pc bv pd pe"><div class="dh l"><img alt="" class="dh" src="../Images/51383106204c2ff6d45c05fd52772a7d.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*fCxl8TrfbpOgvCzq"/></div></div><div class="di pc bv pf pg ph"><div class="dh l"><img alt="" class="dh" src="../Images/cdd4d94a464cda34d46fc00e13cf7bf9.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*XYet0y5T5xce5j8F80Lmdw.jpeg"/></div></div><div class="di bv pi pj ph"><div class="dh l"><img alt="" class="dh" src="../Images/367140fae23113f1e2e868c2157d1e71.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*miSaeOqwwTMnpGF9tdVIbg.png"/></div></div></div></div></div></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="4a57" class="pr mg it bd mh ps pt pu mk pv pw px mn jz py ka mq kc pz kd mt kf qa kg mw qb bi translated">分级编码</h1><p id="2d99" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="1178" class="qc qd it lb b lc ld lf lg li qe lm qf lq qg lu qh qi qj qk bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="1827" class="qc qd it lb b lc ql lf qm li qn lm qo lq qp lu qh qi qj qk bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="17e5" class="qc qd it lb b lc ql lf qm li qn lm qo lq qp lu qh qi qj qk bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="d512" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入升级人才集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>