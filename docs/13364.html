<html>
<head>
<title>TypeScript Tidbits — Generic Type Parameter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript花絮—泛型类型参数</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/typescript-tidbits-generic-type-parameter-82859ffb2582?source=collection_archive---------3-----------------------#2022-08-30">https://levelup.gitconnected.com/typescript-tidbits-generic-type-parameter-82859ffb2582?source=collection_archive---------3-----------------------#2022-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="3f3b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">偶尔你可能会发现自己编写了一个函数，它可以采用许多不同的类型。Typescript允许您为此创建一个泛型类型参数。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c5ab1afaea126d3b8afc7c64678679cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYfdBWDYvG1FeceA-zPfGw.jpeg"/></div></div></figure><p id="2ac1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">泛型类型参数是一个占位符，我们可以用它在多个地方强制实施类型级约束。如果我们浏览一个例子，这是最简单的。</p><p id="28e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看泛型的“Hello world”——identity函数。identity函数只是返回传入的内容。在普通的JavaScript中，它看起来像这样:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="de55" class="lf lg it lb b gy lh li l lj lk">function identity(arg) {<br/>  return arg<br/>}<br/>identity(2) // returns 2<br/>identity("Hello") // returns "Hello"</span></pre><p id="ea18" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Typescript中编写这些内容时，我们可能会尝试使用<code class="fe ll lm ln lb b">any</code>类型来涵盖我们可以传入的所有特定情况:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="5a96" class="lf lg it lb b gy lh li l lj lk">function identity(arg: any): any {<br/>  return arg<br/>}</span></pre><p id="324f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">尽管这样做是可行的，但是我们丢失了很多关于函数返回类型的信息，所以我们在这里使用TypeScript没有得到任何东西。</p><p id="dd02" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以重载这个函数，赋予它多种类型:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="55c2" class="lf lg it lb b gy lh li l lj lk">type Identity = [<br/>  (arg: string): string<br/>  (arg: number): number<br/>]<br/>function identity: Identity (arg) {<br/>  return arg<br/>}</span></pre><p id="7414" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请注意，在这个例子中，我已经将类型签名分开，以使事情更整洁。这个方法<em class="lo">可以</em>工作，但是它过于冗长，并且当你试图包含所有需要的类型时会变得混乱。</p><p id="3ce5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">幸运的是，TypeScript允许您定义“泛型类型参数”。我们可以重写我们的示例来利用这一点:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="c70c" class="lf lg it lb b gy lh li l lj lk">function identity&lt;T&gt;(arg: T): T {<br/>  return arg<br/>}</span></pre><p id="85c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意这里搞笑的尖括号(<code class="fe ll lm ln lb b">&lt;T&gt;</code>)。这就是我们如何定义一个类型变量<code class="fe ll lm ln lb b">T</code>。TypeScript将把传递给<code class="fe ll lm ln lb b">identity</code>的类型存储在<code class="fe ll lm ln lb b">T</code>变量中，这允许我们在类型签名中引用它。</p><p id="4654" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在可以用两种方式来称呼它。</p><ol class=""><li id="4041" class="lp lq it js b jt ju jx jy kb lr kf ls kj lt kn lu lv lw lx bi translated">我们可以明确我们传入的类型:<br/> <code class="fe ll lm ln lb b">let result = identity&lt;string&gt;(“Hello”) // typeof result === ‘string’</code></li><li id="9be0" class="lp lq it js b jt ly jx lz kb ma kf mb kj mc kn lu lv lw lx bi translated">我们可以让编译器推断出类型:<br/> <code class="fe ll lm ln lb b">let result = identity(42) // typeof result === ‘number’</code></li></ol><p id="ec0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们的解决方案现在非常通用，因为它可以与一系列类型一起工作，但是它比使用<code class="fe ll lm ln lb b">any</code>更精确，因为我们不会丢失任何信息。</p><p id="ea90" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个旁注——当像这样对泛型使用类型别名时:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="4626" class="lf lg it lb b gy lh li l lj lk">type Identity&lt;T&gt; = {<br/>  (arg: T): T<br/>}<br/>function identity: Identity (arg) {<br/>  return arg<br/>}</span></pre><p id="ac99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我们调用函数时，我们用<strong class="js iu">和</strong>来定义我们的类型，否则我们会得到一个错误:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="3137" class="lf lg it lb b gy lh li l lj lk">let valid = identity&lt;string&gt;("Hello") <br/>// valid === "Hello"</span><span id="715c" class="lf lg it lb b gy md li l lj lk">let invalid = identity("Hello") <br/>// Error TS2314: Generic type 'Identity' requires 1 type argument(s)</span></pre><h1 id="b82a" class="me lg it bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">约束我们的泛型类型参数</h1><p id="b793" class="pw-post-body-paragraph jq jr it js b jt nb jv jw jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn im bi translated">假设我们想让我们的身份函数也记录参数的长度。我们可能会忍不住这样写:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="30ee" class="lf lg it lb b gy lh li l lj lk">function identity&lt;T&gt;(arg: T): T {<br/>  console.log(arg.length)<br/>  return arg<br/>}</span></pre><p id="2e4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，我们的编辑应该在这里强调一个错误:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="bd41" class="lf lg it lb b gy lh li l lj lk">Property 'length' does not exist on type 'T'.</span></pre><p id="be8a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是有意义的，因为我们还没有定义具有长度属性的类型。如果我们只对用于数组的函数感兴趣，我们可以将代码更改为以下代码并消除错误:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="f944" class="lf lg it lb b gy lh li l lj lk">function identity&lt;T&gt;(arg: Array&lt;T&gt;): Array&lt;T&gt; {<br/>  console.log(arg.length)<br/>  return arg<br/>}</span></pre><p id="d101" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将适用于任何类型的数组。如果我们希望它也能处理简单的字符串，我们可以创建一个接口:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="b73d" class="lf lg it lb b gy lh li l lj lk">interface HasLength {<br/>  length: number<br/>}<br/> <br/>function identity&lt;T extends HasLength&gt;(arg: T): T {<br/>  console.log(arg.length)<br/>  return arg<br/>}</span></pre><p id="78e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们可以用数组或字符串来调用它，它会像预期的那样工作，但是如果我们试图用一个数字来调用它，我们会得到下面的错误消息:</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="dabb" class="lf lg it lb b gy lh li l lj lk">Argument of type ‘number’ is not assignable to parameter of type ‘HasLength’.</span></pre><h2 id="4684" class="lf lg it bd mf ng nh dn mj ni nj dp mn kb nk nl mr kf nm nn mv kj no np mz nq bi translated">脚注:</h2><ol class=""><li id="e26f" class="lp lq it js b jt nb jx nc kb nr kf ns kj nt kn lu lv lw lx bi translated">我们可以为我们的类型变量(<code class="fe ll lm ln lb b">T</code>)使用任何我们喜欢的名字，但是通常使用单个大写字符。</li><li id="54ca" class="lp lq it js b jt ly jx lz kb ma kf mb kj mc kn lu lv lw lx bi translated">允许编译器尽可能推断类型通常更好，但是每个人都有自己的偏好。</li></ol></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="11db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ob" href="https://richard-t-bell90.medium.com/membership" rel="noopener"> <em class="lo">获得无限制的介质</em> </a></p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="b908" class="me lg it bd mf mg oc mi mj mk od mm mn mo oe mq mr ms of mu mv mw og my mz na bi translated">分级编码</h1><p id="a836" class="pw-post-body-paragraph jq jr it js b jt nb jv jw jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="1a6a" class="lp lq it js b jt ju jx jy kb lr kf ls kj lt kn oh lv lw lx bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="039a" class="lp lq it js b jt ly jx lz kb ma kf mb kj mc kn oh lv lw lx bi translated">📰查看<a class="ae ob" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="c542" class="lp lq it js b jt ly jx lz kb ma kf mb kj mc kn oh lv lw lx bi translated">🔔关注我们:<a class="ae ob" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ob" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ob" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="959b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🚀👉<a class="ae ob" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>