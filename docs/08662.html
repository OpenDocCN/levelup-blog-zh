<html>
<head>
<title>Writing Cleaner Code (with examples)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写更干净的代码(有示例)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/writing-cleaner-code-with-examples-69be2160b4c1?source=collection_archive---------0-----------------------#2021-05-23">https://levelup.gitconnected.com/writing-cleaner-code-with-examples-69be2160b4c1?source=collection_archive---------0-----------------------#2021-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1111" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">实用编程建议</h2><div class=""/><div class=""><h2 id="ca1a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">无论何时编写代码，提高信噪比都应该是最重要的。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/921e33445501df57020a53b49935921d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIWPWINOPteMokCO4RQWUg.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">尼克拉斯·米勒德拍摄的图片</figcaption></figure><p id="b574" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">代码经常引起“WTF”——每当读者不理解一段代码的目的、目标或者代码过于冗长时。</p><p id="030b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我想你很清楚我在说什么。</p><p id="bc7b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">阅读代码，理解语法，应用的模式等。，不是问题。但是，你仍然想知道，“wtf”是怎么回事？他为什么这样写？什么是<em class="mf">即</em>有条件检查，而<em class="mf">为什么是</em>？问题的清单还在继续。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="11cc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">干净的代码就是尽可能清晰地传达你的意图。</p><p id="8f38" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">有时这意味着写更多的代码，有时则意味着写更少的代码。但是，最重要的是，您的代码应该简单、可读性高、可维护，并且清楚地传达意图。</p><blockquote class="mn"><p id="0aed" class="mo mp it bd mq mr ms mt mu mv mw me dk translated">“WTF”时刻越少越好。</p></blockquote><p id="1a33" class="pw-post-body-paragraph lj lk it ll b lm mx kd lo lp my kg lr ls mz lu lv lw na ly lz ma nb mc md me im bi translated">顺便说一下，当我提到“简单”时，我绝对不是在谈论为最小分母(团队中最低级的人)编写代码。</p><blockquote class="nc nd ne"><p id="7f43" class="lj lk mf ll b lm ln kd lo lp lq kg lr nf lt lu lv ng lx ly lz nh mb mc md me im bi translated">快速补充:编写最简单的代码只是为了确保团队中最菜鸟的人能读懂它，这实际上是在给那个人抹黑。</p></blockquote><h1 id="0fae" class="ni nj it bd nk nl nm nn no np nq nr ns ki nt kj nu kl nv km nw ko nx kp ny nz bi translated">没有“意外的”干净代码。</h1><p id="7c4f" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">你不会意外地写出干净的代码。这不是你碰巧写的东西。它需要深思熟虑的行动。这需要练习。你甚至可能需要忘记一些过去的做法。</p><p id="410c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这甚至可能挫伤你的自尊心。</p><p id="a45f" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">尤其是如果你刚从大学毕业，拥有一个很棒的计算机科学学位，准备单枪匹马地重新实现曾经创建的每一个库。</p><p id="53fc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">“好了，说够了。让我们看看一些代码！”…</p><p id="e815" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">但是首先，让我来确定这篇文章的范围。我绝对不可能涵盖干净代码的每一个细节，为什么它是重要的，以及它可能采取的所有不同的变化。所以，我挑选了7个我经常遇到的场景。</p><p id="ddcc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">🔔<a class="ae of" href="https://nmillard.medium.com/subscribe" rel="noopener">想要更多这样的文章？在这里签名。</a></p><h2 id="00e6" class="og nj it bd nk oh oi dn no oj ok dp ns ls ol om nu lw on oo nw ma op oq ny iz bi translated">多态性带来的清晰性。</h2><p id="d341" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">任何一直关注我的文章的人都知道，我不可能不抨击那些散布if-else的花括号应用程序编码者，他们对多态性或可扩展性没有欣赏力。</p><p id="bd54" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">花点时间看看下面这个庞然大物的代码片段。</p><p id="2c1a" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">“怎么了？”你可能会问…简单地说<em class="mf">一切</em>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/16b24779806cc1867946ed12e539ed1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jiesx_z8gVwLp6PIe9ZKRQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">当然，它是为CPU和诸如此类的东西优化的。但是清晰却被浪费了。</figcaption></figure><p id="5327" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们想要达到的目标一点都不清楚。没有明确的责任。同一段代码重复了三次。开闭原则已经过时了。方圆几英里内绝对看不到一行面向对象的代码。可维护性1/10。可读性-1/10。</p><p id="b546" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">但是有一个非常简单的方法。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/9494e933a2b757d897e2ce5c75ecf7c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtphOSwgijD0FWoFhSmnQg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">简单明了的代码。</figcaption></figure><p id="acff" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们走吧。一个“搞什么鬼”的时刻都没有。</p><h2 id="527c" class="og nj it bd nk oh oi dn no oj ok dp ns ls ol om nu lw on oo nw ma op oq ny iz bi translated">过于冗长和僵尸代码。</h2><p id="4953" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">如果说<em class="mf">有一种</em>类型的代码让我烦透了，那么它就是被僵尸化的代码。</p><p id="fbd9" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">你几乎可以在任何代码库中找到类似的东西。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/9d061c80f293b19549af1d27601551dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c363RaIgkSrqixSjN-Zzbg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">僵尸评论</figcaption></figure><p id="7b2f" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">你经常会看到代码被僵尸化，因为有人试图展示他们的“疯狂技能”，编写过于冗长、复杂和错误的代码——所有这些都是任何一个刚出校门的初级开发人员都非常推崇的品质。</p><p id="8dbe" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">当你看到注释掉的代码时，删除它。使用源代码管理的历史记录来跟踪代码，而不是注释。</p><h2 id="ffd4" class="og nj it bd nk oh oi dn no oj ok dp ns ls ol om nu lw on oo nw ma op oq ny iz bi translated">清理复杂的代码。</h2><p id="543b" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">偶然发现深度嵌套的代码是很常见的。每一个嵌套都使阅读变得更加困难，意图也变得模糊不清。</p><p id="fcbc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这段代码唯一值得一提的积极方面是使用了mayfly变量。也就是说，短期变量是在使用之前声明的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/cc805fc9243d9cd9858c926a04146e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdJ9XQg9k84CdL0xGwc-sg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">讨厌的分支代码。</figcaption></figure><p id="8d25" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我知道一些开发人员很大程度上反对应用久经考验的设计模式。但是，设计模式确实解决了常见的问题、代码味道和其他讨厌的东西。</p><p id="eacb" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们可以很容易地将这个庞然大物重构为使用guard子句，使我们的意图更加清晰。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/c3881469925bfdf3866f7acc5c843329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4i8g4i7ynv2FJ_kbPoSWQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">带有保护条款的更干净的方法。</figcaption></figure><p id="d709" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">假设你是那种相信异常是邪恶的开发人员，那么不要哭。只是用<code class="fe ou ov ow ox b">return false</code>替换异常或者返回一个<code class="fe ou ov ow ox b">Result</code>。问题解决了。</p><h2 id="dc4d" class="og nj it bd nk oh oi dn no oj ok dp ns ls ol om nu lw on oo nw ma op oq ny iz bi translated">详细布尔赋值。</h2><p id="266f" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">我经常看到这样的代码。它本身并不“糟糕”，但它极其冗长，你像个疯子一样在重复自己的话。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/09851a52d19a524d2343e024186af582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TyPyWPaZnaaVJUGj9lbeZw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">超级详细布尔赋值。</figcaption></figure><p id="a602" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">通过这个简单的改动，让你的意图昭然若揭。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/9a8231033b8590655862d92cac8aafaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ieiCEukBv_FqVVUBSXv8uQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">简单，整洁，干净。</figcaption></figure><h2 id="381e" class="og nj it bd nk oh oi dn no oj ok dp ns ls ol om nu lw on oo nw ma op oq ny iz bi translated">详细值分配。</h2><p id="8db1" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">好的，这个例子和上面的基本相同。然而，现在我们不仅仅对检查条件感兴趣；我们还想根据这个条件赋值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/2994364225f01d66be015293e8bc37c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BcihUAmmvGRGXReET3PH0A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">误用if-else。</figcaption></figure><p id="2025" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我想现在大家都知道if-else语句被滥用了。使用if-else进行二进制赋值仍然很常见，但是很容易重构为更简单、可读性更好的代码，如下所示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/0a62793c719a5ac7cd3a4afe0cfe19ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyNUV6OPOh3Jb6UerkW93w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">三元值赋值。</figcaption></figure><h2 id="c357" class="og nj it bd nk oh oi dn no oj ok dp ns ls ol om nu lw on oo nw ma op oq ny iz bi translated">猜测条件的意图。</h2><p id="a6b0" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">对，还有一个如果-否则。你开始注意到这里的模式了吗？</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/7ffe61416f7c915b90589c8a70d25169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aU2Yo5UzEX938D7g5gPhiw.png"/></div></div></figure><p id="adfc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">你经常会看到到处都是条件句，你经常需要在原始开发者的脑袋里面去理解<em class="mf">什么</em>和<em class="mf">为什么</em>一些条件句存在。</p><p id="c2c6" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在上面的例子中，你不知道16这个神奇的数字代表什么。但是，通过一个简单的重构，将条件提取到一个命名良好的变量中，现在传达了理解<em class="mf">这里测试什么</em>所需的所有含义。</p><h2 id="68bc" class="og nj it bd nk oh oi dn no oj ok dp ns ls ol om nu lw on oo nw ma op oq ny iz bi translated">有条件地访问成员。</h2><p id="52a1" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">在试图访问变量的成员之前，通常需要评估变量是否为null。“典型的”方法包括使用<code class="fe ou ov ow ox b">!=</code>或字符串<code class="fe ou ov ow ox b">string.IsNullOrEmpty</code>(或您选择的语言中的等效语言)来检查变量。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/987a08f6b3febc08fccd801660b7330f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gq-OhqAmlBwW0Fhrdj9B5A.png"/></div></div></figure><p id="219a" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">任何现代编程语言都提供(或者应该提供——谢谢C#)条件访问操作符。</p><p id="8b8a" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这可能看起来微不足道，不是问题。你是对的。但是，对于一个企业规模的代码库，比方说+30万行代码，当有一个更简洁的选项可用时，阅读这样的冗长很快就会变得很麻烦。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="b973" class="ni nj it bd nk nl pa nn no np pb nr ns ki pc kj nu kl pd km nw ko pe kp ny nz bi translated">离别词。</h1><p id="3481" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated">您可能已经知道我演示的所有“干净代码”的例子。如果没有，我希望你能得到一些关于如何清晰写作的灵感。</p><p id="008b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">所有的例子都很简单，琐碎，也许还有点做作，但无论如何，反映了真实代码库的现实以及如何清理某些部分。</p><p id="0adc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">一段冗长的代码不会造成太大的损害。但是，复合效应可能是严重的，并对其读者产生“精神负担”。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="a1d0" class="ni nj it bd nk nl pa nn no np pb nr ns ki pc kj nu kl pd km nw ko pe kp ny nz bi translated">让我们保持联系！</h1><p id="c086" class="pw-post-body-paragraph lj lk it ll b lm oa kd lo lp ob kg lr ls oc lu lv lw od ly lz ma oe mc md me im bi translated"><a class="ae of" href="https://nmillard.medium.com/subscribe" rel="noopener">点击这里</a>订阅时事通讯，获得类似文章的通知，并查看新的YouTube频道<a class="ae of" href="https://www.youtube.com/channel/UCaUy83EAkVdXsZjF3xGSvMw" rel="noopener ugc nofollow" target="_blank"><em class="mf">(@ Nicklas Millard)</em></a></p><p id="4cc4" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><em class="mf">连接上</em><a class="ae of" href="https://www.linkedin.com/in/nicklasmillard/" rel="noopener ugc nofollow" target="_blank"><em class="mf">LinkedIn</em></a></p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="0f85" class="ni nj it bd nk nl pa nn no np pb nr ns ki pc kj nu kl pd km nw ko pe kp ny nz bi translated">好奇者的资源</h1><ul class=""><li id="0f6a" class="pf pg it ll b lm oa lp ob ls ph lw pi ma pj me pk pl pm pn bi translated"><a class="ae of" href="https://www.youtube.com/watch?v=goVjlWLY9NQ" rel="noopener ugc nofollow" target="_blank">。NET C#干净代码</a>作者<a class="lh li ep" href="https://medium.com/u/7c7a43b3d9de?source=post_page-----69be2160b4c1--------------------------------" rel="noopener" target="_blank">尼可拉斯·米勒德</a></li></ul></div></div>    
</body>
</html>