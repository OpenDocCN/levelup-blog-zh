<html>
<head>
<title>How to Easily Process Images with SharpJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用SharpJS轻松处理图像</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-easily-process-images-with-sharpjs-2af2408ad813?source=collection_archive---------13-----------------------#2020-11-30">https://levelup.gitconnected.com/how-to-easily-process-images-with-sharpjs-2af2408ad813?source=collection_archive---------13-----------------------#2020-11-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/841c4ebc919d30cb617b895c99e63777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*52LEPNu5SUSgc_4E"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@usgs?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">美国地质勘探局</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="8767" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所知，图像是任何现代用户友好应用程序的重要组成部分。让我们以任何社交媒体平台，或电子商务网站，或几乎任何其他网站为例，它们都以某种方式利用图像。在一些平台上，用户想要裁剪、更新他们的图片，或者将滤镜应用到他们的图片上，而在其他平台上，例如电子商务平台，商家想要增强他们产品的图像，以便他们卖得更多。最棘手的部分是处理大图像。更令人沮丧的是将这些沉重的图像存储到数据库中，在糟糕的互联网连接下，它们可能要花很长时间才能加载。</p><p id="49b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有一种方法可以让我们的图像加载更快，甚至更高的质量，同时也使它们更加用户友好。现在您可能已经猜到了，解决方案是用于Node.js应用程序的SharpJS库。</p><blockquote class="le"><p id="ceeb" class="lf lg it bd lh li lj lk ll lm ln ld dk translated">这种高速Node.js模块的典型用例是将常见格式的大图像转换为较小的、网页友好的不同尺寸的JPEG、PNG和WebP图像。</p><p id="34d9" class="lf lg it bd lh li lj lk ll lm ln ld dk translated">—根据SharpJS的官方文件</p></blockquote><h1 id="64c6" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">1)先决条件</h1><p id="91f4" class="pw-post-body-paragraph kg kh it ki b kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">在我们开始使用这个库之前，我们需要满足一个要求，你应该有<strong class="ki iu"> NodeJs v10 </strong>或者更新的版本。就是这样！</p><h1 id="662d" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz mr mb mc md ms mf mg mh mt mj mk ml bi translated">2)安装和导入</h1><ul class=""><li id="4672" class="mu mv it ki b kj mm kn mn kr mw kv mx kz my ld mz na nb nc bi translated">要使用npm进行安装:</li></ul><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="f6ed" class="nm lp it ni b gy nn no l np nq">npm install sharp</span></pre><ul class=""><li id="94fd" class="mu mv it ki b kj kk kn ko kr nr kv ns kz nt ld mz na nb nc bi translated">使用纱线安装:</li></ul><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="43b7" class="nm lp it ni b gy nn no l np nq">yarn add sharp</span></pre><h1 id="3234" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz mr mb mc md ms mf mg mh mt mj mk ml bi translated">3)使用SharpJS</h1><p id="4cbf" class="pw-post-body-paragraph kg kh it ki b kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">在开始使用这个库之前，我们需要用到它，就像其他Javascript库一样。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="9dae" class="nm lp it ni b gy nn no l np nq">const sharp = require("sharp");</span></pre><h1 id="97a4" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz mr mb mc md ms mf mg mh mt mj mk ml bi translated">4)示例</h1><p id="4e9c" class="pw-post-body-paragraph kg kh it ki b kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">接下来，让我们看一些如何使用这个库的例子。</p><h2 id="7237" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例1:调整图像大小/裁剪图像</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="99f9" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .resize({ width: 250, height: 350 })<br/>  .toFile("Output.jpg");</span></pre><p id="e78b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">toFile()方法将输出图像数据写入文件。在这种情况下，调整后的图像将保存在一个名为“输出”的JPG类型的输出文件中。</p><h2 id="8823" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例2:获取图像灰度</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="e61d" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .greyscale()  //.grayscale()<br/>  .toFile("Output.jpg");</span></pre><p id="8ded" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">灰度( )方法<em class="of">(替代拼写，</em> <code class="fe og oh oi ni b"><em class="of">grayscale</em></code> <em class="of">)。都可以用)。</em>将输入图像转换为8位灰度；256种灰度。</p><h2 id="ddb2" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例3:获取图像底片</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="bd98" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .negate()<br/>  .toFile("Output.jpg");</span></pre><p id="9523" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就产生了图像的“负片”。</p><h2 id="4f03" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例4:模糊图像</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="74ad" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .blur()<br/>  .toFile("Output.jpg");</span></pre><p id="2d06" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当在没有参数的情况下使用blur()方法时，它对输出图像执行快速、<em class="of">温和</em> <em class="of">模糊</em>。然而，你也可以为它提供一个<strong class="ki iu">西格玛</strong>值来执行一个更慢、<em class="of">更精确的高斯模糊</em>。适马值的范围可以在<strong class="ki iu"> 0.3到1000之间。</strong></p><h2 id="0631" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例5:旋转图像</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="5018" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .rotate(180)<br/>  .toFile("Output.jpg");</span></pre><p id="6294" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将图像旋转正180度。</p><h2 id="9f2d" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例6:翻转图像</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="f724" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .flip()<br/>  .toFile("Output.jpg");</span></pre><p id="01db" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">围绕垂直Y轴翻转图像。</p><h2 id="b468" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例7:翻转图像</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="7e69" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .flop()<br/>  .toFile("Output.jpg");</span></pre><p id="ede1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">围绕水平X轴翻转图像。</p><h2 id="c123" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例8:更改图像格式</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="a038" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg") <br/>  .toFormat("png")<br/>  .toFile("Output.png");</span></pre><p id="7c71" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将输入图像转换为新的格式，作为toFormat()方法的参数提供。</p><h2 id="3cf8" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例9:增强图像质量</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="193f" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .toFormat("png")<br/>  .png({ quality: 100 })<br/>  .toFile("Output.png");</span></pre><p id="fb91" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">图像质量可以设置为1到100之间的任何值。不用说，价值越高，质量越好。</p><h2 id="e295" class="nm lp it bd lq nu nv dn lu nw nx dp ly kr ny nz mc kv oa ob mg kz oc od mk oe bi translated">示例10:将图像存储到数据库中</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="a4b4" class="nm lp it ni b gy nn no l np nq">sharp("Input_Image.jpg")<br/>  .resize({ width: 500, height: 450 })<br/>  .toFormat("png")<br/>  .png({ quality: 100 })<br/>  .toFile("Output.png")<br/>  .then(() =&gt; {<br/>    //Here, you can either store the image to the database or     <br/>//send it to the frontend client(React, Vue, Angular, etc.)<br/>    <br/>  console.log('Please Like Comment and Subscribe!!');<br/><br/>  })<br/>  .catch((err) =&gt; console.warn(err)); // print error(if any) on the console</span></pre><p id="079c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，在这里，我们要调整图像的大小，给它500像素的宽度和450像素的高度，然后，我们要将其转换为PNG格式，接下来，我们将输出图像的质量设置为100，输出图像保存为“Output.png”。在前面的所有滤镜都应用到图像后。然后( )块将被执行，它采用一个回调函数，在这里您可以对输出图像执行任何操作。</p><blockquote class="le"><p id="1a13" class="lf lg it bd lh li lj lk ll lm ln ld dk translated">除了承诺，SharpJS还支持回调和异步等待。</p></blockquote><h2 id="51fa" class="nm lp it bd lq nu oj dn lu nw ok dp ly kr ol nz mc kv om ob mg kz on od mk oe bi translated">示例11:使用gif</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="5931" class="nm lp it ni b gy nn no l np nq">sharp('inputGIF.gif', { animated: true })<br/>  .toFile('Output.webp');</span></pre><p id="c841" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将gif转换成WEBP格式，同时仍然保留动画。</p><p id="4e34" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是这个有用的Javascript库的全部内容。我希望本文提供的信息对您有价值，并帮助您简化和优化web应用程序上的未来图像处理任务。</p><figure class="nd ne nf ng gt ju"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="1018" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有用的资源:</p><ul class=""><li id="0d18" class="mu mv it ki b kj kk kn ko kr nr kv ns kz nt ld mz na nb nc bi translated"><a class="ae kf" href="https://sharp.pixelplumbing.com/" rel="noopener ugc nofollow" target="_blank">sharp . js的官方文档</a></li><li id="be47" class="mu mv it ki b kj oq kn or kr os kv ot kz ou ld mz na nb nc bi translated"><a class="ae kf" href="https://gist.github.com/KritikaSharmaKS/b1073302961a169e9ef4674dca086a13" rel="noopener ugc nofollow" target="_blank">我的Sharp.js例子的要点</a></li></ul></div><div class="ab cl ov ow hx ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="im in io ip iq"><p id="fc1f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">【https://www.theimmigrantprogrammers.com】最初发表于<a class="ae kf" href="https://www.theimmigrantprogrammers.com/p/process-images-the-right-way-sharpjs" rel="noopener ugc nofollow" target="_blank"><em class="of"/></a><em class="of">。</em></p></div></div>    
</body>
</html>