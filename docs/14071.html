<html>
<head>
<title>What Is the Difference Between the Efficiency of Java Reflection and Java New</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Java反射和Java New的效率有什么区别</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-the-difference-between-the-efficiency-of-java-reflection-and-java-new-1169cb5fe896?source=collection_archive---------6-----------------------#2022-10-30">https://levelup.gitconnected.com/what-is-the-difference-between-the-efficiency-of-java-reflection-and-java-new-1169cb5fe896?source=collection_archive---------6-----------------------#2022-10-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6684701000cf98dc78e99c54ce57c75d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w3vj_0OD8Y6Cns2Q"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kf" href="https://unsplash.com/@clemhlrdt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Clément Hélardot </a>拍摄的照片</figcaption></figure><p id="2fd3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的日常使用中，使用最多的是Java new，但是有些框架经常使用Java反射来实现灵活性，但是它们的直接效率有什么区别呢？</p><p id="5323" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，你有没有想过，我们什么时候应该用new来创建对象，什么时候应该用reflection来创建对象？</p><p id="bc5d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">两者之间创建对象的效率如何？</p><figure class="le lf lg lh gt ju"><div class="bz fp l di"><div class="li lj l"/></div></figure><h1 id="14c2" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">1.新对象与创建对象的反射之间的效率比较</h1><figure class="le lf lg lh gt ju"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="7aa8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们发现新建100000000个对象的效率和反射创建100000000个对象的效率相差很多倍。</p><p id="cf29" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">那么我们来探讨一下为什么会有这么大的差异。</strong></p><p id="c3bc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，一般来说，我们的Java代码需要在虚拟机上编译运行。</p><p id="11c8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们一般通过前端编辑器，比如<code class="fe mi mj mk ml b">javac</code>，把java文件转换成类文件。</p><p id="d1cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，在程序执行期间，JIT，即时编译器，可以将字节码文件转换成计算机识别的机器代码文件。</p><p id="faf3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一种可能是通过AOT编译器将java文件直接编译成本机代码文件。其中JIT会在程序运行时对程序进行优化，但是反射是通过动态分析，所以可能无法执行Java虚拟机的一些优化。</p><p id="f8d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">综上，有几个原因:</strong></p><p id="7fca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mi mj mk ml b">Method#invoke</code>方法将<code class="fe mi mj mk ml b">encapsulate</code>和<code class="fe mi mj mk ml b">unencapsulate</code>参数</p><ul class=""><li id="dcfe" class="mm mn it ki b kj kk kn ko kr mo kv mp kz mq ld mr ms mt mu bi translated">需要检查方法是否可见</li><li id="2238" class="mm mn it ki b kj mv kn mw kr mx kv my kz mz ld mr ms mt mu bi translated">需要验证参数</li><li id="527a" class="mm mn it ki b kj mv kn mw kr mx kv my kz mz ld mr ms mt mu bi translated">反射方法很难内联</li><li id="38e1" class="mm mn it ki b kj mv kn mw kr mx kv my kz mz ld mr ms mt mu bi translated">JIT无法优化</li></ul><h1 id="d7bf" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">2.反射和new的使用场景</h1><p id="19ee" class="pw-post-body-paragraph kg kh it ki b kj na kl km kn nb kp kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated"><strong class="ki iu">反射的一些使用场景</strong></p><ul class=""><li id="3e86" class="mm mn it ki b kj kk kn ko kr mo kv mp kz mq ld mr ms mt mu bi translated">Spring帮助我们通过反射实例化对象，并将它们放入IOC容器中</li><li id="291b" class="mm mn it ki b kj mv kn mw kr mx kv my kz mz ld mr ms mt mu bi translated">使用JDBC链接数据库时加载数据库驱动程序<code class="fe mi mj mk ml b">Class.forName()</code></li><li id="0b65" class="mm mn it ki b kj mv kn mw kr mx kv my kz mz ld mr ms mt mu bi translated">反编译等逆向代码</li><li id="1489" class="mm mn it ki b kj mv kn mw kr mx kv my kz mz ld mr ms mt mu bi translated">使用反射，在泛型类型为int的<code class="fe mi mj mk ml b">ArrayList</code>集合中存储一个类型为<code class="fe mi mj mk ml b">String</code>的对象</li></ul><p id="7b42" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">新物体与倒影的区别</strong></p><ul class=""><li id="847b" class="mm mn it ki b kj kk kn ko kr mo kv mp kz mq ld mr ms mt mu bi translated">新对象不能访问它的私有属性，通过设置<code class="fe mi mj mk ml b">setAccessible()</code>方法可以省略反射的属性。</li><li id="e777" class="mm mn it ki b kj mv kn mw kr mx kv my kz mz ld mr ms mt mu bi translated"><code class="fe mi mj mk ml b">New</code>必须知道类名，而反射可以在不知道类型的情况下创建对象</li></ul><h1 id="ca49" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">最后</h1><p id="e619" class="pw-post-body-paragraph kg kh it ki b kj na kl km kn nb kp kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated"><strong class="ki iu">感谢阅读</strong>。期待您的关注，阅读更多高质量的文章。</p><div class="nf ng gp gr nh"><div role="button" tabindex="0" class="ab bv gv cb fp ni nj bn nk jz ex"><div class="nl l"><div class="ab q"><div class="l di"><img alt="omgzui" class="l de bw nm nn fe" src="../Images/113db82933227743d0067a68e250ac93.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*AmBIV4haXTWPO--EhE0Q1A.jpeg"/><div class="fb bw l nm nn fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@omgzui?source=post_page-----1169cb5fe896--------------------------------" rel="noopener follow" target="_top"> omgzui </a></p></div></div><div class="nq nr gw l"><h2 class="bd iu tb mm fp tc fr fs td fu fw is bi translated">更好的编程</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi te au tf tg th pl ti an eh ei tj tk tl el em eo de bk ep" href="https://medium.com/@omgzui/list/better-programing-9b4c9bb174aa?source=post_page-----1169cb5fe896--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="tm l fo"><span class="bd b dl z dk">108 stories</span></div></div></div><div class="od dh oe fp ab of fo di"><div class="di nv bv nw nx"><div class="dh l"><img alt="" class="dh" src="../Images/3e6ce891363c151131c5993ca0dcc526.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*7cAp-WibSblfO7hT"/></div></div><div class="di nv bv ny nz oa"><div class="dh l"><img alt="" class="dh" src="../Images/a7dd413de22f319a3c4729c9e737feb8.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*FcmHdVfoUOhlJlsG"/></div></div><div class="di bv ob oc oa"><div class="dh l"><img alt="" class="dh" src="../Images/3666e533060c4dc70c7e80f31bccbcba.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*V6I1dcf-gpxiYTjb"/></div></div></div></div></div><div class="nf ng gp gr nh"><div role="button" tabindex="0" class="ab bv gv cb fp ni nj bn nk jz ex"><div class="nl l"><div class="ab q"><div class="l di"><img alt="omgzui" class="l de bw nm nn fe" src="../Images/113db82933227743d0067a68e250ac93.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*AmBIV4haXTWPO--EhE0Q1A.jpeg"/><div class="fb bw l nm nn fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@omgzui?source=post_page-----1169cb5fe896--------------------------------" rel="noopener follow" target="_top"> omgzui </a></p></div></div><div class="nq nr gw l"><h2 class="bd iu tb mm fp tc fr fs td fu fw is bi translated">Java 语言(一种计算机语言，尤用于创建网站)</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi te au tf tg th pl ti an eh ei tj tk tl el em eo de bk ep" href="https://medium.com/@omgzui/list/java-e7c93884d94b?source=post_page-----1169cb5fe896--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="tm l fo"><span class="bd b dl z dk">55 stories</span></div></div></div><div class="od dh oe fp ab of fo di"><div class="di nv bv nw nx"><div class="dh l"><img alt="" class="dh" src="../Images/3666e533060c4dc70c7e80f31bccbcba.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*V6I1dcf-gpxiYTjb"/></div></div><div class="di nv bv ny nz oa"><div class="dh l"><img alt="" class="dh" src="../Images/0dd5c9327f714baf2e445bfe821b8114.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*UsD4qh_ARNmOPhO96s5dvQ.png"/></div></div><div class="di bv ob oc oa"><div class="dh l"><img alt="" class="dh" src="../Images/9054376845be34a58a63fb815bb5d5b3.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*iohZiyQquP93nEL4X5h3ow.png"/></div></div></div></div></div><div class="nf ng gp gr nh"><div role="button" tabindex="0" class="ab bv gv cb fp ni nj bn nk jz ex"><div class="nl l"><div class="ab q"><div class="l di"><img alt="omgzui" class="l de bw nm nn fe" src="../Images/113db82933227743d0067a68e250ac93.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*AmBIV4haXTWPO--EhE0Q1A.jpeg"/><div class="fb bw l nm nn fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@omgzui?source=post_page-----1169cb5fe896--------------------------------" rel="noopener follow" target="_top"> omgzui </a></p></div></div><div class="nq nr gw l"><h2 class="bd iu tb mm fp tc fr fs td fu fw is bi translated">新闻</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi te au tf tg th pl ti an eh ei tj tk tl el em eo de bk ep" href="https://medium.com/@omgzui/list/news-67ec0a972660?source=post_page-----1169cb5fe896--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="tm l fo"><span class="bd b dl z dk">23 stories</span></div></div></div><div class="od dh oe fp ab of fo di"><div class="di nv bv nw nx"><div class="dh l"><img alt="" class="dh" src="../Images/c3f36b36bf050f98fd5a8e3c89103cad.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*LISEmTdz19k7BAHY"/></div></div><div class="di nv bv ny nz oa"><div class="dh l"><img alt="" class="dh" src="../Images/8459df5aae62dc00f04377e09544be88.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*RvBGLw3V9JZfn_HO"/></div></div><div class="di bv ob oc oa"><div class="dh l"><img alt="" class="dh" src="../Images/2864058bcedc8c1cd6492624ba9671c6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*IUWVb3zTn1_HKV9P"/></div></div></div></div></div></div></div>    
</body>
</html>