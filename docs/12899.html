<html>
<head>
<title>Event Sourcing: The new silver bullet?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">事件采购:新的银弹？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/event-sourcing-the-new-silver-bullet-1c58ff48d56f?source=collection_archive---------3-----------------------#2022-07-19">https://levelup.gitconnected.com/event-sourcing-the-new-silver-bullet-1c58ff48d56f?source=collection_archive---------3-----------------------#2022-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a02b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">事件源是称为事件驱动架构的大型架构设计的一部分。这是我在研究后学到的东西，希望能帮助你弄清楚这种架构是你应该使用的还是只会让事情变得复杂。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8f84d574d846a336572b19bfe66581d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4veEzxd3Ashz7T_u"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@homajob?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><blockquote class="lf lg lh"><p id="5748" class="jq jr li js b jt ju jv jw jx jy jz ka lj kc kd ke lk kg kh ki ll kk kl km kn im bi translated">事件驱动架构使用事件来触发解耦服务并在它们之间进行通信，这在使用微服务构建的现代应用程序中很常见。事件是状态的变化或更新，就像电子商务网站上购物车中的商品。事件可以携带状态(购买的商品、价格和送货地址)，也可以是标识符(订单已发货的通知)。</p></blockquote><p id="23ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">许多系统被称为<em class="li">事件驱动</em>，但是这意味着什么以及你被事件驱动的范围还有更多细节。在某些场景或用例中，将整个系统的服务或组件解耦并利用外部系统或最终用户触发的事件是天作之合。然而，尽管事件驱动的架构为您提供了一个松散耦合的系统，但您却失去了查看代码和理解正在发生的事情的能力。您必须依赖许多不同的信息或代码来真正理解当一个事件被触发时会发生什么，以及什么系统利用这些信息以及如何利用。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lm"><img src="../Images/9ee8e9c592d574b667c4c77d868bcd54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Fy4NKeWJAOfkxeLV"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Christian Kapeller 在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="b038" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated"><strong class="ak">事件通知</strong></h1><p id="f588" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">这是事件驱动系统的基本层次，通常意味着您正在系统中的某个地方使用事件。系统的某个部分触发一个事件并把它放到一个队列或总线上，另一个系统读取该事件并执行一个任务。简而言之，使用事件通知系统，但是除了“发生了一些事情”之外，事件通常没有太多其他数据。一个例子是“下了一个订单”,另一个系统可能会向客户发送一封电子邮件，对订单表示感谢，然后通知仓库系统开始包装和运输该商品。</p><p id="f670" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">赞成的意见</p><ul class=""><li id="f589" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">去耦高可用系统</li></ul><p id="70e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">骗局</p><ul class=""><li id="473c" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">下游用户通常需要来自源系统的更多信息，额外的流量可能会淹没或影响源系统的性能</li></ul><h1 id="f433" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated"><strong class="ak">事件携带状态转移</strong></h1><p id="8ed0" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">事件驱动系统的下一个领域是事件携带状态转移，由Martin Fowler和Thoughtworks的人员创造。此版本中的事件具有包含在事件中的附加信息以及所发生事件的名称或上下文。一个例子可以是一个客户地址，该事件将具有进行更改之前的地址和更新后的地址。有了这两条信息，下游系统就不必为了对事件采取行动而回到源系统去了解发生了什么变化。下游系统通常会缓存或存储这些增量，以便以后使用。这种模式在野外不太常见，但比事件通知要高级一些。</p><p id="e026" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">赞成的意见</p><ul class=""><li id="2e60" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">去耦高可用系统</li><li id="f50b" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">因为事件包含附加信息，所以源系统上的负载较少</li></ul><p id="cec5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">骗局</p><ul class=""><li id="224d" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">事件和本地数据库或缓存中的复制数据</li><li id="4468" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">利用事件时的最终一致性</li></ul><h1 id="0f30" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated"><strong class="ak">事件采购</strong></h1><p id="5def" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">我们到了。事件驱动架构的进一步发展是事件源，随着对事件驱动架构兴趣的增长，事件源最近似乎越来越受欢迎。</p><blockquote class="lf lg lh"><p id="3c03" class="jq jr li js b jt ju jv jw jx jy jz ka lj kc kd ke lk kg kh ki ll kk kl km kn im bi translated">事件源确保对应用程序状态的所有更改都存储为一系列事件。</p></blockquote><p id="0834" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些事件必须在应用程序的生命周期中作为事实的来源保存，本质上这些事件就是您的应用程序状态。如果你使用了版本控制系统，那么你就使用了事件源系统，因为版本控制(如Git、SVN、Mercurial)会存储对文件系统或结构所做的更改(也称为事件),重放这些更改会使你进入一个特定的状态。</p><p id="486e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">非开发人员的另一个真实例子是会计分类账。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/02e0148cf55f3fa12b20946132a688c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/0*l4rNPEcrCJmFWu7K.jpg"/></div></figure><p id="863b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">分类账记录了不同的事件及其背景。如果你“回放”了所有的事件，那么你应该得到你的“当前状态”,也就是你的银行账户里有多少钱。</p><p id="2578" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">赞成的意见</p><ul class=""><li id="535a" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">清除审计记录</li><li id="ee02" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">能够重放事件和调试问题，并确切知道发生了什么变化</li><li id="3299" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">系统设计的历史状态</li><li id="5f95" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">如果有人意识到不久前发生的一个错误的价值观，那就是另一种状态</li><li id="c6e7" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">内存映像——可以拥有高性能的内存系统，因为您的状态存在于不可变的事件存储中</li></ul><p id="d969" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">骗局</p><ul class=""><li id="1d1e" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">新的设计模式，许多开发人员不熟悉</li><li id="44d8" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">外部系统—您无法重放来自外部系统的事件，因此您应该生成事件来促进这种行为</li><li id="22c9" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">事件架构—以代码始终可以继续处理事件的方式存储事件</li><li id="0efd" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">标识符-知道何时在数据中生成标识符可能很困难</li><li id="a240" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">版本控制Greg Young讨论过，但是当希望从时间开始的所有事件都可以重放时，这可能会很困难(快照可能是帮助实现这一点的一种方法)</li></ul><h1 id="da1b" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated"><strong class="ak"> CQRS —命令查询责任分离</strong></h1><p id="7fb5" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">这是迄今为止最复杂的系统，需要两个独立的系统来处理查询(即读取)和命令(即写入)。在设计或迁移系统时，您应该认真考虑是否需要这种级别的架构，因为它很快就会变得很糟糕。这里有一些来自马丁·福勒和另一位作者T2的参考资料。许多公司利用的一个例子是将操作数据库与报告或分析数据库分离，并使用ETL作业或其他机制将数据传输到单独的系统中进行大量读取。</p><p id="1e57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">赞成的意见</p><ul class=""><li id="fd6a" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">在适当的时候工作非常出色，并且可以成为工作的乐趣</li></ul><p id="fdac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">骗局</p><ul class=""><li id="75e6" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">很多复杂性、基础设施和开销</li></ul><p id="a5ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">需要记住的一点是，高可用性系统最终只会保持一致。这是您为高度可用的系统所做的折衷，即最终的一致性和潜在的其他ACID属性。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nf"><img src="../Images/939151cdf6ee6618006ebf315653835a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DYZ-0SrTX8kKkzsN"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@tingeyinjurylawfirm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">廷杰律师事务所</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2eb8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您有兴趣进一步研究和评估活动采购，这里有一些资源。看看Martin Fowler的视频<a class="ae le" href="https://www.youtube.com/watch?v=STKCRSUsyP0" rel="noopener ugc nofollow" target="_blank">和他的博客文章</a>中的分类。<a class="ae le" href="https://leanpub.com/esversioning/read" rel="noopener ugc nofollow" target="_blank"> Greg Young </a>经验丰富，是<a class="ae le" href="https://www.eventstore.com/event-sourcing" rel="noopener ugc nofollow" target="_blank"> EventStore </a>的作者。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="20a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这篇文章，考虑<a class="ae le" href="https://medium.com/@ascourter/membership" rel="noopener">订阅Medium </a>！</p><div class="nn no gp gr np nq"><a href="https://medium.com/@ascourter/membership" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">通过我的推荐链接加入媒体-安德鲁考特</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">阅读安德鲁·考特(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ky nq"/></div></div></a></div><p id="e5de" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你或你的公司有兴趣找人进行技术面试，那么请在Twitter ( <a class="ae le" href="http://twitter.com/Exosyphon" rel="noopener ugc nofollow" target="_blank"> @Exosyphon </a>)上给我发DM，或者访问我的<a class="ae le" href="https://andrewcourter.com/" rel="noopener ugc nofollow" target="_blank">网站</a>。如果你喜欢这样的话题，那么你可能也会喜欢我的<a class="ae le" href="https://www.youtube.com/channel/UCx3Vist13GWLzRPvhUxQ3Jg" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>。如果你想支持更多像这样的内容<a class="ae le" href="https://www.buymeacoffee.com/andrewcourter" rel="noopener ugc nofollow" target="_blank"> buymeacoffee </a>。祝您愉快！</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="dbff" class="ln lo it bd lp lq of ls lt lu og lw lx ly oh ma mb mc oi me mf mg oj mi mj mk bi translated">分级编码</h1><p id="9454" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="567c" class="mq mr it js b jt ju jx jy kb ms kf mt kj mu kn mv mw mx my bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="d048" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">📰查看<a class="ae le" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">升级编码</a>中的更多内容</li><li id="1a6b" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">🔔关注我们:<a class="ae le" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae le" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a></li><li id="0f2f" class="mq mr it js b jt mz jx na kb nb kf nc kj nd kn mv mw mx my bi translated">🚀👉<a class="ae le" href="https://jobs.levelup.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">软件工程师的顶级工作</strong> </a></li></ul></div></div>    
</body>
</html>