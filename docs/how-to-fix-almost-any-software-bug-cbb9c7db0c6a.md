# 如何修复(几乎)任何软件缺陷

> 原文：<https://levelup.gitconnected.com/how-to-fix-almost-any-software-bug-cbb9c7db0c6a>

## 你的周末得救了

## 系统修复 bug 的开发者指南

每个开发者都知道这种感觉。你已经盯着屏幕几个小时了。尽管你一直盯着代码看，对它破口大骂，但它就是不做你想让它做的事情。

![](img/0e2540016c895e0aab929edac89fda0d.png)

她已经摘下了她的眼镜，这就是你如何知道它是严重的。由 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上 [Elisa Ventur](https://unsplash.com/@elisa_ventur?utm_source=medium&utm_medium=referral) 拍摄的照片

沮丧的你决定这是一个不可修复的 bug，它不能被解决。

然而，这是我解决任何软件错误的简单方法。

第一步是找到以稳定的方式重现问题的步骤。对于一些讨厌的 bug 来说，这可能是最难的一步，但却是绝对必要的。

有时，开发人员可能会收到一份错误报告，其中包含重现问题的详细步骤列表。这表明开发人员很幸运，在他们的项目中有有能力的测试人员，或者更好的客户，他们足够关心产品来提供这些步骤。

但是很多时候你得到的只是一个模糊的错误“产品 XY 不能放入购物车”。所以这意味着可能要搜索日志文件，找出这个产品的特别之处？产品是不是在一个特殊的群体里，他有没有特殊的属性？

![](img/1ae1119608c4887433b0a125631de556.png)

“产品无法添加到购物车”。照片由[拉斐尔·洛瓦斯基](https://unsplash.com/@raphaellovaski?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄

很多时候，这已经是修复错误之旅的终点了。举例来说，一旦你意识到这种产品没有价格，就很清楚这是一个应该处理的案例。

但是让我们假设不清楚是什么导致了这个问题。不知何故，这种产品看起来像任何其他产品，但它不能放在购物车中。

因此，许多开发人员可能会开始责怪某些东西或其他人。是数据库，是硬件，是产品所有者。原因不是开发商的懒惰或威胁。这是一个简单的事实，开发者已经建立了一个心智模型，他的代码中的所有东西是如何与所有其他系统一起工作的，而这个心智模型正受到 bug 的挑战。

归咎于外部因素当然比挑战一个人的心智模式更容易，那么我们该如何绕过它呢？

答案是搜索。与其盯着屏幕几个小时让我们的心理模型和现实匹配，最简单的方法是把它变成一个搜索问题。

![](img/e386d4818d2d9b84b9b1354807457eba.png)

不过，我在找一个软件漏洞。在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上由 [Austin Chan](https://unsplash.com/@austinchan?utm_source=medium&utm_medium=referral) 拍摄的照片

下面是如何在我们的假设示例中实现这一点:

# 签入您的代码

第一步是确保所有代码都被签入。如果需要，可以创建一个分支。相信我吧

# 减少直至发现错误

有错误信息吗？注释掉代码，直到它们消失。可以删除属性使错误消失吗？是否可以删除实体以使错误消失？

# 添加，直到发现错误

该产品有什么特别之处吗？你能创造一个与现有产品完全相同的新产品吗？这是否表现出同样的问题。拿一个工作的产品，将属性复制到坏的产品中。错误何时出现/消失。

# 各个击破

如果涉及许多潜在的属性/实体，尝试缩小搜索空间，例如通过将其划分为子空间并搜索这些子空间。如果说一批产品有问题，看看是否有一种自然的方法将它们分组，以及这是否与问题相关。是不是所有的美容产品都有这个问题而服装没有？这极大地限制了搜索空间，并可能意味着它是第一类而不是第二类特有的属性。

对于那些很难复制的错误，也只是偶尔发生。有时候试着定义一下。

随机性告诉我们，它不是假设产品的固有属性，而是系统本身的属性。

“有时”成为你的搜索空间。

只有周末吗？工作日？负荷不足？当某个进程正在运行时。如果它不总是发生，一定有一个错误的原因。修复软件错误的第一条规则是，相信引起错误是有原因的。

使用“分而治之”来缩小搜索空间，直到搜索变得微不足道。

# 对剩余的实体/属性应用调试/日志记录/…

在某种程度上，您最终会发现一个实体属性或代码路径就是问题所在。如果您无法解决问题，请为该特定路径添加日志或调试该问题。

# 验证问题是否已解决

修复后，确保错误不能再被复制，所以你确实修复了实际问题。如果它仍然存在，那就又回到了起点。

# 真实世界的例子

为了更好地说明这个问题，下面是我最近工作中的两个例子。我的代码处理 86，756 个文件。进行得很顺利，表演很棒，一切都在预料之中。成功处理了 86，755 份文件。

等一下…

![](img/b3323859131946fc25e376b2a9817b4c.png)

当我意识到我丢失了一个文件时的反应。重演。阿菲夫·库苏马在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

86，756 个文件中有一个有错误？那肯定是统计上的错误。结果不是。每次运行时，处理过程中都会丢失一个文件。

所以我求助于盯着屏幕的老开发者工具。这没用。过了一会儿我把它变成了一个搜索问题。我把文件分成两半。一半有问题，另一半没有。

这已经告诉了我一个重要的信息。该问题与文件有关，而不是系统本身。例如，它与系统的正常运行时间无关。

所以我把一半分成两半，看看问题出在哪里。经过几个进一步的划分，它归结为几个文件，这是一个可调试的数量。在调试过程中，问题变得很明显，这是一个简单的修复。

还有一次，我的代码应该转发到/另一个页面，却被转发到/页面。由于/page 有很多转发，我不知道是哪个转发导致了这个问题。

为了解决这个问题，在必要的凝视和抱怨之后，我将/page 的所有转发替换为/page1 /page2 /page3 的转发。所以我列举了所有电话。/page1 /page2 和/page3 不存在。但是通过枚举页面，查找 bug 变成了简单的检查，看看哪个页面将在转发中使用。

我也可以简单地注释掉所有转发到/page 的内容，然后查看问题何时消失，但是枚举转发允许我更快地搜索问题，因为只需要一次部署。

就是这样，几乎所有顽固的 bug 都是这样被修复的，通过系统地搜索问题空间。