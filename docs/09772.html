<html>
<head>
<title>Write your tools: simple JIRA automation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写您的工具:简单的JIRA自动化</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/write-your-tools-simple-jira-automation-c0421aaf6ec?source=collection_archive---------9-----------------------#2021-09-12">https://levelup.gitconnected.com/write-your-tools-simple-jira-automation-c0421aaf6ec?source=collection_archive---------9-----------------------#2021-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/da5236b7a6f2d481998a4dc1225a2f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qlLF7zW7wXxEIWFTH-bx7Q.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">你应该对工具自动化的新思想持开放态度</figcaption></figure><p id="30e9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我最近有一个想法，自己编写工具是一种令人耳目一新的体验，它可以让你走出日常工作，同时，它还可以帮助你学习新的东西。这个学习过程真的很刺激，有时接近沮丧感，有时接近兴奋感，有时接近T2。这不仅仅是你的事。你也可以帮助你组织中的其他人。</p><p id="5e5d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">你正在使用的大多数基于网络的服务都有一个API </strong>(或者至少是伪装成API的东西)。这是因为大多数类似SaaS的企业都有一个面向最终用户的SPA(单页应用程序)应用程序，在这个架构中，API需要在某个地方。这些API的问题在于，它们通常不是设计用于“原始”模式的。基于API的产品是一个不同的故事，因为那里的API设计和易用性是惊人的。</p><p id="3a81" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">请记住，直接使用API是具有挑战性的，这些API最初是为了支持内部开发团队而设计的。你会遇到像糟糕的文档、过时的文档、根本没有文档、没有文档的API怪癖、乍一看很难理解的奇怪的解决方案等等问题——这是学习过程中令人着迷的部分。</p><p id="738f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这个故事中，<strong class="kh iu">我将向您展示如何开始构建您的<em class="ld"> Python </em>脚本来管理JIRA </strong>。首先，我应该解释我为什么这样做。我认为至少有两个原因:</p><ul class=""><li id="381f" class="le lf it kh b ki kj km kn kq lg ku lh ky li lc lj lk ll lm bi translated">JIRA接口激怒了我。这并不是说我不喜欢它的外观，我不喜欢它的工作方式，作为一个专注于web开发的开发人员，我不断地问自己如何才能提供一个界面，这简直是笨拙的。页面和模态加载<em class="ld"> ages，</em>HTML元素的加载移动了其他元素——我就像是在我点击了错误的地方的情况下结束；这里提到的所有事情都是可以原谅的，最后，JIRA是一个非常令人印象深刻的工具，有很多功能，让它<em class="ld">平滑</em>是一种挑战，下一个原因在这里更重要。</li><li id="9891" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">我讨厌会议团队浪费时间，最令人沮丧的时刻是在一些讨论之后，我们都在看PO屏幕上的共享视频，看问题是如何产生的。在这个时间点上，它不再是一个团队活动，它变成了一个人的表演。我们可以找到的最快的界面之一是文本界面IDE或简单的文本编辑器反应时间很长，不需要点击，所以我已经实现了这种方法，并在<em class="ld"> YAML </em>结构中准备任务，稍后(会议结束后)我简单地使用<em class="ld"> Python </em>脚本将其放入JIRA。</li></ul><p id="c5e8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">说够了！让我们做一些编码。</strong></p><p id="27a9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">要完成这个练习，我们需要:</p><ul class=""><li id="8a35" class="le lf it kh b ki kj km kn kq lg ku lh ky li lc lj lk ll lm bi translated">JIRA帐户—最多10个用户免费使用</li><li id="0d05" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">JIRA项目已创建</li><li id="a167" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">访问API的一个键</li></ul><p id="0e7d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">前两个——只需去https://www.atlassian.com的<a class="ae ls" href="https://www.atlassian.com" rel="noopener ugc nofollow" target="_blank">并按照步骤操作，首先设置账户，然后去新创建的JIRA实例并创建一些Scrum项目。</a></p><p id="3551" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">最后一个不是超级明显。</p><ul class=""><li id="d1e5" class="le lf it kh b ki kj km kn kq lg ku lh ky li lc lj lk ll lm bi translated">转到:<a class="ae ls" href="https://id.atlassian.com" rel="noopener ugc nofollow" target="_blank">https://id.atlassian.com</a></li><li id="9e16" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">在右上角点击您的个人资料，然后点击<em class="ld">账户设置</em></li><li id="8a21" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">转到<em class="ld">安全</em>选项卡，在这里您会看到一个部分，在这里您可以管理您的API密钥，单击链接<em class="ld">创建和管理API令牌</em>:</li></ul><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/a8323f62e647885433c7d9a66fdae366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*2O3W73qH8lZaEKdSLqwU9w.png"/></div></figure><ul class=""><li id="e01f" class="le lf it kh b ki kj km kn kq lg ku lh ky li lc lj lk ll lm bi translated">在下一个屏幕上，单击<em class="ld">创建API令牌</em>按钮，为您的新API密钥添加一个有意义的标签，如<em class="ld"> myfirsttesttoken </em></li><li id="3e03" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">仔细阅读消息:"<em class="ld">确保您复制了新的API令牌。你将无法再看到此令牌。</em>“并将新创建的API令牌复制到某个地方，我们将来会需要它。</li></ul><blockquote class="ly lz ma"><p id="71aa" class="kf kg ld kh b ki kj kk kl km kn ko kp mb kr ks kt mc kv kw kx md kz la lb lc im bi translated">请注意，您将能够在与您的用户相同的权限级别上对API执行操作，例如，如果您没有在JIRA创建新项目的权限，您也将无法使用API令牌执行此操作。这意味着，在某些情况下，您需要请求某人为您提供更多的API令牌访问权限——这取决于集成。</p></blockquote></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="97d6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">此时，我们已经准备好编写一些<em class="ld"> Python </em>脚本。我会尽量保持这个脚本简单——主要关注集成和使事情工作，自己组织代码——作为练习:)</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="0dcd" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">首先，让我们确保一切正常，执行以下脚本:</p><figure class="lu lv lw lx gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="44c7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为你的情况设置合适的变量。在响应中，您应该得到(假设您的JIRA项目已创建)，类似于:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="f4db" class="ms mt it mo b gy mu mv l mw mx">[<br/>    {<br/>        "expand": "description,lead,issueTypes,url,projectKeys,permissions,insight",<br/>        "self": "<a class="ae ls" href="https://your-jira.atlassian.net/rest/api/3/project/10000" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/rest/api/3/project/10000</a>",<br/>        "id": "10000",<br/>        "key": "your-project-key",<br/>        "name": "your-project-name",<br/>        "avatarUrls": {<br/>            "48x48": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/projectavatar?pid=10000&amp;avatarId=10407" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/projectavatar?pid=10000&amp;avatarId=10407</a>",<br/>            "24x24": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/projectavatar?size=small&amp;s=small&amp;pid=10000&amp;avatarId=10407" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/projectavatar?size=small&amp;s=small&amp;pid=10000&amp;avatarId=10407</a>",<br/>            "16x16": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/projectavatar?size=xsmall&amp;s=xsmall&amp;pid=10000&amp;avatarId=10407" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/projectavatar?size=xsmall&amp;s=xsmall&amp;pid=10000&amp;avatarId=10407</a>",<br/>            "32x32": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/projectavatar?size=medium&amp;s=medium&amp;pid=10000&amp;avatarId=10407" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/projectavatar?size=medium&amp;s=medium&amp;pid=10000&amp;avatarId=10407</a>"<br/>        },<br/>        "projectTypeKey": "software",<br/>        "simplified": true,<br/>        "style": "next-gen",<br/>        "isPrivate": false,<br/>        "properties": {},<br/>        "entityId": "uuid-like-key",<br/>        "uuid": "uuid-like-key"<br/>    }<br/>]</span></pre><p id="4407" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如您所见，这是API返回的一个简单的项目列表。JIRA API提供的所有端点的文档都可以在这里找到。你可以回顾它，并找到如何使用它们的想法。在这个故事中，我将专注于在给定的项目中创建新任务。要创建新问题，我们需要在端点<code class="fe my mz na mo b">/rest/api/3/issue</code>上使用POST方法。API使用示例可以在文档中找到。</p><p id="9e26" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">要使用JIRA API创建新问题，我们在发出创建API请求之前需要两件事情:</p><ul class=""><li id="812b" class="le lf it kh b ki kj km kn kq lg ku lh ky li lc lj lk ll lm bi translated">项目id</li><li id="3869" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">问题类型id(任务/用户案例/Epic)</li></ul><p id="9854" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">获取项目id很容易:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="fda3" class="ms mt it mo b gy mu mv l mw mx">response = requests.get(<br/>    f"{BASE_URL}/rest/api/3/project/{PROJECT_KEY}",<br/>    headers=HEADERS,<br/>    auth=auth,<br/>)</span><span id="2792" class="ms mt it mo b gy nb mv l mw mx">project_id = response.json()["id"]</span></pre><p id="903b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">注意URL中的<code class="fe my mz na mo b">{PROJECT_KEY}</code>,这里我们打电话询问项目细节，如果你在JIRA只有一个项目，你可以使用上面的项目列表示例。</p><p id="5b05" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">获取问题类型并不那么明显，因为请求是不言自明的，我们需要理解它背后的一些逻辑。</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="5048" class="ms mt it mo b gy mu mv l mw mx">response = requests.get(<br/>    f"{BASE_URL}/rest/api/3/issuetype",<br/>    headers=HEADERS,<br/>    auth=auth,<br/>)</span><span id="8bd8" class="ms mt it mo b gy nb mv l mw mx">issues_types = response.json()</span></pre><p id="3ecb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><code class="fe my mz na mo b">issues_types</code>变量将存储:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="50f8" class="ms mt it mo b gy mu mv l mw mx">[<br/>    {<br/>        "self": "<a class="ae ls" href="https://your-jira.atlassian.net/rest/api/3/issuetype/10005" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/rest/api/3/issuetype/10005</a>",<br/>        "id": "10005",<br/>        "description": "Subtasks track small pieces of work that are part of a larger task.",<br/>        "iconUrl": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10316&amp;avatarType=issuetype" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10316&amp;avatarType=issuetype</a>",<br/>        "name": "Subtask",<br/>        "untranslatedName": "Subtask",<br/>        "subtask": true,<br/>        "avatarId": 10316,<br/>        "hierarchyLevel": -1,<br/>        "scope": {<br/>            "type": "PROJECT",<br/>            "project": {<br/>                "id": "10000"<br/>            }<br/>        }<br/>    },<br/>    {<br/>        "self": "<a class="ae ls" href="https://your-jira.atlassian.net/rest/api/3/issuetype/10001" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/rest/api/3/issuetype/10001</a>",<br/>        "id": "10001",<br/>        "description": "Stories track functionality or features expressed as user goals.",<br/>        "iconUrl": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10315&amp;avatarType=issuetype" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10315&amp;avatarType=issuetype</a>",<br/>        "name": "Story",<br/>        "untranslatedName": "Story",<br/>        "subtask": false,<br/>        "avatarId": 10315,<br/>        "hierarchyLevel": 0,<br/>        "scope": {<br/>            "type": "PROJECT",<br/>            "project": {<br/>                "id": "10000"<br/>            }<br/>        }<br/>    },<br/>    {<br/>        "self": "<a class="ae ls" href="https://your-jira.atlassian.net/rest/api/3/issuetype/10002" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/rest/api/3/issuetype/10002</a>",<br/>        "id": "10002",<br/>        "description": "Tasks track small, distinct pieces of work.",<br/>        "iconUrl": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10318&amp;avatarType=issuetype" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10318&amp;avatarType=issuetype</a>",<br/>        "name": "Task",<br/>        "untranslatedName": "Task",<br/>        "subtask": false,<br/>        "avatarId": 10318,<br/>        "hierarchyLevel": 0,<br/>        "scope": {<br/>            "type": "PROJECT",<br/>            "project": {<br/>                "id": "10000"<br/>            }<br/>        }<br/>    },<br/>    {<br/>        "self": "<a class="ae ls" href="https://your-jira.atlassian.net/rest/api/3/issuetype/10003" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/rest/api/3/issuetype/10003</a>",<br/>        "id": "10003",<br/>        "description": "Bugs track problems or errors.",<br/>        "iconUrl": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10303&amp;avatarType=issuetype" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10303&amp;avatarType=issuetype</a>",<br/>        "name": "Bug",<br/>        "untranslatedName": "Bug",<br/>        "subtask": false,<br/>        "avatarId": 10303,<br/>        "hierarchyLevel": 0,<br/>        "scope": {<br/>            "type": "PROJECT",<br/>            "project": {<br/>                "id": "10000"<br/>            }<br/>        }<br/>    },<br/>    {<br/>        "self": "<a class="ae ls" href="https://your-jira.atlassian.net/rest/api/3/issuetype/10000" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/rest/api/3/issuetype/10000</a>",<br/>        "id": "10000",<br/>        "description": "A big user story that needs to be broken down. Created by Jira Software - do not edit or delete.",<br/>        "iconUrl": "<a class="ae ls" href="https://your-jira.atlassian.net/images/icons/issuetypes/epic.svg" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/images/icons/issuetypes/epic.svg</a>",<br/>        "name": "Epic",<br/>        "untranslatedName": "Epic",<br/>        "subtask": false,<br/>        "hierarchyLevel": 1<br/>    },<br/>    {<br/>        "self": "<a class="ae ls" href="https://your-jira.atlassian.net/rest/api/3/issuetype/10004" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/rest/api/3/issuetype/10004</a>",<br/>        "id": "10004",<br/>        "description": "Epics track collections of related bugs, stories, and tasks.",<br/>        "iconUrl": "<a class="ae ls" href="https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10307&amp;avatarType=issuetype" rel="noopener ugc nofollow" target="_blank">https://your-jira.atlassian.net/secure/viewavatar?size=medium&amp;avatarId=10307&amp;avatarType=issuetype</a>",<br/>        "name": "Epic",<br/>        "untranslatedName": "Epic",<br/>        "subtask": false,<br/>        "avatarId": 10307,<br/>        "hierarchyLevel": 1,<br/>        "scope": {<br/>            "type": "PROJECT",<br/>            "project": {<br/>                "id": "10000"<br/>            }<br/>        }<br/>    }<br/>]</span></pre><p id="2bca" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如您所见，这是您的项目中允许的问题类型的列表，这不是简单的硬编码任务，Epic，Bug是问题类型在JIRA是高度可定制的，它们可以根据项目而变化。您可以在响应中看到scope字段，它告诉我们这些问题类型适用于ID等于10000的项目。如果您知道项目ID，您可以简单地过滤类似人类的名称并将其映射到适当的问题类型ID。我们现在已经具备了使用Python脚本创建JIRA项目第一期的所有条件:</p><figure class="lu lv lw lx gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="32db" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你现在去JIRA，你应该能看到积压的新问题:</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nc"><img src="../Images/79756e680b381f19c38e7ab238d08f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4npb8sjWbTeNI-0zDYug_A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">我们的第一期通过python脚本创建。</figcaption></figure><p id="8539" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">使用这个API的最大问题之一是内容字段。可能你已经注意到了，但是它是一种结构化的数据格式，乍一看用起来并不明显，即使经过一些挖掘，它仍然不明显。Atlassian在这里所做的是他们创建了自己的文档格式，称为<a class="ae ls" href="https://developer.atlassian.com/cloud/jira/platform/apis/document/structure/" rel="noopener ugc nofollow" target="_blank"> Atlassian文档格式</a>。遗憾的是，除了学习之外，没有其他方法可以解决这个问题。</p><p id="fc9e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">最简单的任务结构之一是:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="4a55" class="ms mt it mo b gy mu mv l mw mx">Task<br/>  - Do this<br/>  - Do that<br/>Definition of Done<br/>  - DoD 1<br/>  - DoD 2</span></pre><p id="15c5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们试着让我们的生活更简单，并提高执行。首先，让我们用一个简单的YAML结构来定义我们的任务:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="e5f0" class="ms mt it mo b gy mu mv l mw mx">task_yaml = """<br/>title: My First Task<br/>tasks:<br/>  - Do something <br/>  - Do something different<br/>dod:<br/>  - dod 1<br/>  - dod 2<br/>"""<br/># to load this:<br/>import yaml<br/>task_data = yaml.load(StringIO(task_yaml), Loader=yaml.FullLoader)</span></pre><p id="d274" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们的任务数据将如下所示:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="de8f" class="ms mt it mo b gy mu mv l mw mx">{<br/>    'title': 'My First Task', <br/>    'tasks': ['Do something', 'Do something different'], <br/>    'dod': ['dod 1', 'dod 2']<br/>}</span></pre><p id="a970" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在让我们创建将上述结构转换为ADF格式的方法:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="d07a" class="ms mt it mo b gy mu mv l mw mx">def create_task_content(task):<br/>    content = [{<br/>        "type": "paragraph",<br/>        "content": [<br/>            {<br/>                "text": "Tasks",<br/>                "type": "text"<br/>            }<br/>        ]<br/>    }]<br/>    tasks = [<br/>        {'type': 'listItem',<br/>         'content': [{'type': 'paragraph', 'content': [{'type': 'text', 'text': item}]}]}<br/>        for item in task["tasks"]<br/>    ]<br/>    content.append({'type': 'bulletList', 'content': tasks})<br/>    content.append({<br/>        "type": "paragraph",<br/>        "content": [<br/>            {<br/>                "text": "Definition of Done",<br/>                "type": "text"<br/>            }<br/>        ]<br/>    })<br/>    dod = [<br/>        {'type': 'listItem',<br/>         'content': [{'type': 'paragraph', 'content': [{'type': 'text', 'text': item}]}]}<br/>        for item in task["dod"]<br/>    ]<br/>    content.append({'type': 'bulletList', 'content': dod})<br/>    return content</span></pre><p id="b6cb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">并对我们创建问题的issue_data on POST方法做了细微的修改:</p><pre class="lu lv lw lx gt mn mo mp mq aw mr bi"><span id="2e08" class="ms mt it mo b gy mu mv l mw mx">issue_data = {<br/>    "update": {},<br/>    "fields": {<br/>        "summary": task_data["title"],<br/>        "issuetype": {<br/>            "id": issue_type_task["id"]<br/>        },<br/>        "project": {<br/>            "id": project_id<br/>        },<br/>        "description": {<br/>            'version': 1,<br/>            'type': 'doc',<br/>            'content': create_task_content(task_data)<br/>        },<br/>    }<br/>}</span></pre><p id="8457" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">请注意标题和内容字段，这个有效负载将在JIRA产生以下问题，这看起来已经有点令人满意了:</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/2b22023e95cbb61297ba55a3772045c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p1_semR26YvjkUmFShPWRw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">JIRA问题与尼斯项目清单的任务和定义完成。</figcaption></figure><p id="d1ab" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">扩展的想法:</p><ul class=""><li id="c588" class="le lf it kh b ki kj km kn kq lg ku lh ky li lc lj lk ll lm bi translated">扩展<em class="ld"> YAML </em>结构以支持多任务</li><li id="f266" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">将<em class="ld"> YAML </em>文件加载添加到脚本中，这将允许您在IDE/文本编辑器中以<em class="ld"> YAML </em>格式简单地做笔记，然后使用团队提供的最终数据运行脚本</li><li id="4f8a" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">多项目支持</li><li id="4b57" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">简单的命令行实用程序</li><li id="23e6" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">也自动化不同的JIRA流程(例如关闭/打开sprints)</li></ul><p id="d142" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">脚本的最终版本:</p><figure class="lu lv lw lx gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="ce18" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">感谢阅读和快乐编码:)</p></div></div>    
</body>
</html>