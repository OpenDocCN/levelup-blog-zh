<html>
<head>
<title>GitHub Action to Automatically Push to Another Repository</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动推送到另一个存储库的GitHub动作</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/github-action-to-automatically-push-to-another-repository-1e327862f067?source=collection_archive---------11-----------------------#2022-09-18">https://levelup.gitconnected.com/github-action-to-automatically-push-to-another-repository-1e327862f067?source=collection_archive---------11-----------------------#2022-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a4fc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">是时候让GitHub action自动为你推送了！</h2></div><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div class="ab gu cl kk"><img src="../Images/9aaad59bc8e6627d740a3168a594f132.png" data-original-src="https://miro.medium.com/v2/0*QBe0R0F4jfMeucKz"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk translated">照片由<a class="ae kr" href="https://unsplash.com/@kaitlynbaker?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯特琳·贝克</a>在<a class="ae kr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="90b0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">您是否曾经需要您的某个存储库自动将内容推送到另一个存储库？</p><p id="bf4b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这可能有几个原因。也许您的主存储库还不可共享，或者您希望将一些内容保留在其他存储库之外，也许您希望主存储库保持私有，同时充当中央存储库来控制私有和部分公开的内容。</p><p id="a77b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">由于我最近才开始在<a class="ae kr" href="https://pinloon.medium.com" rel="noopener">媒体</a>上写帖子，当我希望以更好的方式组织帖子时，我有必要这样做。为了减轻我写文章的负担，我一直在使用从<code class="fe lo lp lq lr b">Brian Mayo</code>开始的Github <a class="ae kr" href="https://github.com/protiumx/blogpub" rel="noopener ugc nofollow" target="_blank">动作</a>来自动将文章发布到媒体上。我要做的只是用Markdown格式写下帖子，然后推送到Github。博客库一直是公开可用的，因为它也是本文中使用的示例代码的存储空间。</p><p id="136b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然而，当我意识到有一天有些帖子可能只有媒体成员可以访问时，我应该在一个单独的存储库中保持内容的私密性，同时使帖子中使用的代码可以公开。在考虑了git子模块，encrypted markdown之后，我决定保持当前的博客存储库(包含文章和代码)私有，同时增加一个Github动作，只将共享代码导出到另一个公共存储库。</p><p id="5b25" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这时我发现<code class="fe lo lp lq lr b">Carles Pina Estany</code>中的Github <a class="ae kr" href="https://github.com/cpina/github-action-push-to-another-repository" rel="noopener ugc nofollow" target="_blank">动作</a>对这个案例很有用。</p><p id="0349" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">为了更好地说明，我创建了<a class="ae kr" href="https://github.com/pllee4-Experimental/mock-medium-source" rel="noopener ugc nofollow" target="_blank">模拟媒体源</a>和<a class="ae kr" href="https://github.com/pllee4-Experimental/mock-medium-output" rel="noopener ugc nofollow" target="_blank">模拟媒体输出</a>来模拟我的用例。</p><p id="cced" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">从<code class="fe lo lp lq lr b">mock-medium-source</code>中，文件结构如下</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="5b56" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">Medium中的帖子将源自<code class="fe lo lp lq lr b">.md</code>文件，而<code class="fe lo lp lq lr b">posts/&lt;number&gt;/files</code>下的其余内容将是关于帖子的参考代码或信息。</p><p id="8909" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因此，我应该保密的是markdown文件，因为如果没有帖子的内容，共享代码就没有意义了。虽然<a class="ae kr" href="https://gist.github.com/" rel="noopener ugc nofollow" target="_blank"> Github Gist </a>是一种流行的共享代码和代码片段的方式，但此时我仍然更喜欢将代码与<code class="fe lo lp lq lr b">Makefile</code>或<code class="fe lo lp lq lr b">CMakeLists.txt</code>放在一个地方，以方便代码的编译和运行。在推送<code class="fe lo lp lq lr b">mock-medium-output</code>之前，我没有使用任何花哨的操作来过滤掉那些来自<code class="fe lo lp lq lr b">mock-medium-source</code>的私人内容，目前只是在推送至其他存储库之前简单地删除了那些降价文件。</p><p id="fefe" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><code class="fe lo lp lq lr b">mock-medium-output</code>存储库的预期文件结构应该是</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="620b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><code class="fe lo lp lq lr b">mock-medium-source</code>中Github工作流的yaml文件如下，(记得为<code class="fe lo lp lq lr b">SSH_DEPLOY_KEY</code>创建秘密)</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="308c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">对于这个yaml文件，有两点需要注意</p><ul class=""><li id="16e5" class="lu lv iq ku b kv kw ky kz lb lw lf lx lj ly ln lz ma mb mc bi translated">公共存储库<code class="fe lo lp lq lr b">mock-medium-output</code>必须在能够从<code class="fe lo lp lq lr b">mock-medium-source</code> <em class="md">推送之前创建(“已创建”意味着至少通过一次提交来推送，以便将有效分支作为源存储库的目标分支)</em></li><li id="6b50" class="lu lv iq ku b kv me ky mf lb mg lf mh lj mi ln lz ma mb mc bi translated">从Github工作流来看，路径是<code class="fe lo lp lq lr b">posts/**</code>，也就是说<code class="fe lo lp lq lr b">mock-medium-source</code>的工作流只有在<code class="fe lo lp lq lr b">posts</code>下的目录发生变化时才会被触发运行。这对于我的使用是有意义的，但是如果你愿意，你可以删除这部分。</li></ul><p id="4f88" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">就是这样！我可以继续使用markdown格式写帖子，并让工作流自动推送相关的公共内容与您共享！</p><p id="1b7c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">谢谢，希望这对你有帮助！</p></div></div>    
</body>
</html>