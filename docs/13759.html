<html>
<head>
<title>A practical guide for parsing websites with jsoup and java.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用jsoup和java解析网站的实用指南。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-practical-guide-for-parsing-websites-with-jsoup-and-java-9b688e127f6?source=collection_archive---------12-----------------------#2022-10-03">https://levelup.gitconnected.com/a-practical-guide-for-parsing-websites-with-jsoup-and-java-9b688e127f6?source=collection_archive---------12-----------------------#2022-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/88b9da65c92b87cc34fce87e21f13de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GrtqG9brdgy8aoJy4WTrxw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">潘卡杰·帕特尔在<a class="ae kc" href="https://unsplash.com/s/photos/html-code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="74fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当一个人把你经常做的事情自动化时，总会有一种快乐。它不仅给你带来空闲时间，而且感觉正确，减少不必要的例行公事。在本指南中，我将针对一个简单的问题，尝试从零开始描述整个过程。</p><p id="2e63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">声明</strong></p><p id="9924" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我喜欢足球。而作为一个看英超的人，我玩的是梦幻足球。这是一个可以和朋友吹嘘的有趣游戏，但是要花很多时间去网站查看预测的阵容等等。因为有几个，他们列出了所有我目前可能不感兴趣的球队和球员。因此，让我们编写一个简单的电报机器人，它将解析其中一个网站(<a class="ae kc" href="https://www.fantasyfootballpundit.com/fantasy-premier-league-team-news/" rel="noopener ugc nofollow" target="_blank">https://www . fantasyfootbalbundit . com/fantasy-premier-league-team-news/</a>)，并根据它给出聊天者预测的开始时间。在这一部分，我将描述如何解决这些问题的思考过程。</p><p id="ed43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">寻找共同模式。</strong></p><p id="f903" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现代网站的一切都使用CSS，这使得解析器的工作变得更加容易，因为在大多数情况下，人们可以根据CSS类和结构轻松区分搜索到的信息。</p><p id="2bff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了我们的目标，我们需要找到一个显示团队和玩家的通用模式。我们可以检查页面，注意到所有对我们有用的信息都在<em class="lb"> div class="content" </em>中，如果我们更仔细地观察团队，我们可以注意到模式(<em class="lb">div class = " WP-block-columns "</em>)。所以你总是可以看着页面去做，但是有一个更简单的方法——写一个测试。</p><figure class="ld le lf lg gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lc"><img src="../Images/1b516cc9133a9233a654cd8125004589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0gtdvJ4lQ3LANvj3Wcuhw.png"/></div></div></figure><p id="8260" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">使用简单测试</strong></p><p id="35d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以下载页面并编写一个简单的测试来解析它，借助现代开发工具(在本例中是intellij)的强大功能，我们可以通过计算一个表达式来找到我们需要的20支球队和球员。</p><figure class="ld le lf lg gt jr"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="34bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个测试没什么特别的，但是它允许我们进入调试模式并动态评估文档页面。下面的截图可以像例子一样得到球队和球员。</p><figure class="ld le lf lg gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lj"><img src="../Images/f633ef44b8c0e58ed6eb0dcf166eb21d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mwxtOJlEyfUkyxG78MEIuw.png"/></div></div></figure><figure class="ld le lf lg gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lk"><img src="../Images/c9dabc5cd8ad8c717bb052eb9bd76eb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9E-2chh33zci5aqkcxGz7A.png"/></div></div></figure><p id="7c74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">编写代码并把它们放在一起</strong></p><p id="11da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们把它们放在一起。我们将有一个服务来解析网页，并返回一个球员的球队地图。</p><p id="9170" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据之前的截图，我们知道该团队的位置:</p><pre class="ld le lf lg gt ll lm ln lo aw lp bi"><span id="33d8" class="lq lr iq lm b gy ls lt l lu lv">getElementsByClass("content").first().getElementsByClass("wp-block-coumns")</span></pre><p id="b79b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而对于相应球队的球员来说:</p><pre class="ld le lf lg gt ll lm ln lo aw lp bi"><span id="dda0" class="lq lr iq lm b gy ls lt l lu lv">getElementsByClass("content").first().getElementsByClass("wp-block-coumns").first().getElementsbyTag("tr")</span></pre><p id="aae1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基本上就是这样，这个服务还从响应中删除不需要的数据。</p><figure class="ld le lf lg gt jr"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="0646" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在服务被调用后，它只是从输入的键(team)返回值。</p><p id="5342" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">调度程序和缓存</strong></p><p id="e368" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然一切正常，并给出了我们想要的响应，但它几乎不可用，因为请求下载整个页面并解析它以获得输出需要时间。考虑到我们预先知道页面，并且知道它不会定期更新，我们可以简单地编写一个调度程序并缓存这些值。</p><figure class="ld le lf lg gt jr"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="f76f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不会使用任何花哨的缓存，只是一个简单的静态地图就足够了。下一次我们想要获得关于某个团队的信息时，我们不必连接到网站并等待，而只需从预加载的地图中获取值。</p><figure class="ld le lf lg gt jr"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="a10a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">连接器只是以jsoup文档的形式获取网页。</p><figure class="ld le lf lg gt jr"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="3d41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望这些简单的步骤能让更多的人自动完成他们日常的网络任务，否则这些任务会变得很无聊。</p><p id="5ad0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">继续编码，拥有一个。</strong></p><p id="9f3f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — -</p><p id="3d5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">【https://github.com/Mumuksia/telegram_fpl】的 <a class="ae kc" href="https://github.com/Mumuksia/telegram_fpl" rel="noopener ugc nofollow" target="_blank"> <em class="lb">可以找到<em class="lb">的代码</em></em></a></p><p id="3d1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">电报可以通过</em><a class="ae kc" href="http://t.me/UkrGreetingBot" rel="noopener ugc nofollow" target="_blank"><em class="lb">http://t.me/</em></a><a class="ae kc" href="http://twitter.com/FPLTeamBot" rel="noopener ugc nofollow" target="_blank">@ FPLTeamBot</a>访问</p><p id="c1d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">文章</em> <a class="ae kc" href="https://medium.com/@Mumuksia/telegram-bot-with-java-and-docker-636c4136fe7b" rel="noopener">如何设置电报机器人https://medium . com/@ mumuk sia/telegram-bot-with-Java-and-docker-636 c 4136 fe7b</a></p></div></div>    
</body>
</html>