<html>
<head>
<title>Python Has A Scalability Flaw</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python有一个可伸缩性缺陷</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-has-a-fatal-flaw-e4bf0462d366?source=collection_archive---------21-----------------------#2022-09-26">https://levelup.gitconnected.com/python-has-a-fatal-flaw-e4bf0462d366?source=collection_archive---------21-----------------------#2022-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4212" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在当今的技术领域，扩展应用程序是必要的。</p><p id="e4ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">应用程序的用户群会呈指数级增长，因此开发应用程序的目的是在这种情况下每分钟处理越来越多的请求。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/7cc497723fd0280a3cfb5c5ad42d0265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*awG-1mKl_67fqEY-"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">凯利·西克玛在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="d875" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在讨论可伸缩性之前，我们需要熟悉一些计算机科学概念。</p><p id="6675" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">来说说他们吧！</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h2 id="19c7" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">什么是过程？</h2><p id="f260" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">进程是程序/应用程序的运行实例。</p><p id="f297" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个程序可以同时运行多个实例(进程)。</p><p id="6190" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同一程序和其他程序的不同进程由计算机的操作系统管理。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mk"><img src="../Images/5d23ea99e198c8d87d9cb056f0b6436f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zPJ5bKhxX4HiOPs2CHYXyQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">任务管理器中显示的进程(作者图片)</figcaption></figure><h2 id="0f5a" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">什么是线程？</h2><ul class=""><li id="ce05" class="ml mm it js b jt mf jx mg kb mn kf mo kj mp kn mq mr ms mt bi translated">线程表示在进程上下文中执行的实际处理器指令。</li><li id="f302" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">每个进程至少有一个线程执行它的指令。</li></ul><h2 id="e617" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">什么是<strong class="ak">多线程？</strong></h2><ul class=""><li id="f6be" class="ml mm it js b jt mf jx mg kb mn kf mo kj mp kn mq mr ms mt bi translated">当多个线程协同工作时，在一个进程的上下文中并行执行指令</li><li id="9ab1" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">进程中的线程共享状态信息、内存和许多其他属性。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mz"><img src="../Images/925200a315449c14f9d0bccc7165104f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eSzj76SU2HbW7XRo"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@metriics?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">夏羽·加尼翁</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="c2ac" class="na ln it bd lo nb nc nd lr ne nf ng lu nh ni nj lx nk nl nm ma nn no np md nq bi translated">缩放应用</h1><p id="3912" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">让我们来谈谈不同的应用扩展设计。</p><h2 id="91c2" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">级别1:单线程应用程序</h2><p id="cad5" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">这是应用程序进程使用单线程运行的时候。</p><h2 id="d5ae" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">级别2:多线程应用程序</h2><p id="2f77" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">这是指应用程序进程可以利用计算机CPU处理器中的不同内核，并行运行多个线程。</p><p id="1140" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样做是为了提高计算效率/减少执行时间。</p><p id="1ffc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这构成了<strong class="js iu">垂直扩展</strong>的基础，下一步可以添加更多更快的处理器/执行内核。</p><p id="0b6e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但这有局限性。您无法升级到不断增长的处理能力，这将变得非常昂贵！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/19d3ebe522558d7ad2e712403a3081a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m6DUA-KjGSf-mgZs"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">水平与垂直扩展的成本(来源:<a class="ae le" href="https://www.mongodb.com/basics/horizontal-vs-vertical-scaling" rel="noopener ugc nofollow" target="_blank">https://www . MongoDB . com/basics/水平与垂直扩展</a>)</figcaption></figure><h2 id="af76" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">级别3:分布式应用程序</h2><p id="b317" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">这包括使用通过网络连接的多个计算机系统(服务器)。</p><p id="e13c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您不熟悉分布式系统，请查看下面的这篇文章:</p><div class="ns nt gp gr nu nv"><a rel="noopener  ugc nofollow" target="_blank" href="/100-essential-systems-design-concepts-that-every-developer-must-know-part-1-1318c2c402ca"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">每个开发人员都必须知道的100个基本系统设计概念(第1部分)</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">设计高效、容错和可扩展系统的首选清单</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ky nv"/></div></div></a></div></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="daf0" class="na ln it bd lo nb nc nd lr ne nf ng lu nh ni nj lx nk nl nm ma nn no np md nq bi translated">Python应用中的多线程</h1><p id="0986" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">让我们编写一个名为<code class="fe ok ol om on b">countdown</code>的函数并执行它。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="fd86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个函数完成执行需要1.946秒。</p><p id="35c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们使用多线程，再次执行这个函数。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="e35e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">人们会认为运行速度会提高一倍，因为我们使用了两个线程来执行这个函数。</p><p id="a4c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">令人惊讶的是，这并不像我们预期的那样工作！</p><p id="72fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你知道为什么吗？</p><p id="544a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">原因是<strong class="js iu"> Python GIL(全局解释器锁)</strong>。</p><p id="10e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">先说说它是从哪里来的。</p><h1 id="046f" class="na ln it bd lo nb oq nd lr ne or ng lu nh os nj lx nk ot nm ma nn ou np md nq bi translated">CPython</h1><p id="31fc" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated"><strong class="js iu"> CPython </strong>是Python的默认且最广泛使用的参考实现。</p><p id="303e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是用C和Python写的。</p><p id="30b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">CPython的作用是在解释之前将Python代码编译成<a class="ae le" href="https://en.wikipedia.org/wiki/Bytecode" rel="noopener ugc nofollow" target="_blank">字节码</a>。</p><p id="12d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">CPython在每个CPython解释器进程上使用GIL。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/ea67d1aef8cee1579d7b8f27d3407826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DNtocEk7WwpBH5MV"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">克里斯·里德在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="651e" class="na ln it bd lo nb oq nd lr ne or ng lu nh os nj lx nk ot nm ma nn ou np md nq bi translated">但是，GIL是什么？</h1><p id="cb74" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">GIL或全局解释器锁是一个<strong class="js iu">互斥锁</strong>。</p><p id="856a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是避免<strong class="js iu">竞态条件的一种方法。</strong></p><p id="2fb4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它确保在Python解释器进程的执行过程中，任何时候只有一个线程可以处理Python <a class="ae le" href="https://en.wikipedia.org/wiki/Bytecode" rel="noopener ugc nofollow" target="_blank">字节码</a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ow"><img src="../Images/37a47db4ded28b1246dded2a6722e9f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RT0HPLWaKiMzkgw7"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">飞:D </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><h1 id="1b7f" class="na ln it bd lo nb oq nd lr ne or ng lu nh os nj lx nk ot nm ma nn ou np md nq bi translated">这会导致什么问题？</h1><p id="8823" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">应用程序可以处理两种类型的操作:</p><ul class=""><li id="a45c" class="ml mm it js b jt ju jx jy kb ox kf oy kj oz kn mq mr ms mt bi translated">CPU限制</li><li id="1698" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">输入输出绑定</li></ul><p id="cb19" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> CPU限制的操作</strong>计算量很大，并且受限于处理器的完成能力。<br/>比如复杂的数学运算都是CPU绑定的。</p><p id="f881" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另一方面，<strong class="js iu">待完成的I/O绑定操作</strong>受限于等待输入/输出操作所花费的时间。<br/>比如数据库和网络操作。</p><p id="fbf8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当应用程序使用分布在多个内核上的CPU密集型操作时，GIL在CPython中对抗多线程。</p><p id="794c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">尽管如此，多线程仍然是I/O绑定操作的一种可能性。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="f8d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Python先驱Dave Beazley 的博客<a class="ae le" href="https://dabeaz.blogspot.com/2010/01/python-gil-visualized.html" rel="noopener ugc nofollow" target="_blank">中可以找到一个很好的可视化例子。</a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/430e3c9ba92aafb659f95a097d97a716.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/0*E2mdZMG_8ar3g4oZ"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">图注(来源:<a class="ae le" href="https://dabeaz.blogspot.com/2010/01/python-gil-visualized.html" rel="noopener ugc nofollow" target="_blank">https://dabe az . blogspot . com/2010/01/python-Gil-visualized . html</a>)</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/98fa41d1ac5b1aad34814f6e10b51b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_sBExa3N8TKxx4hG"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">在具有单个处理核心的机器上运行的2个CPU绑定的线程(来源:<a class="ae le" href="https://dabeaz.blogspot.com/2010/01/python-gil-visualized.html" rel="noopener ugc nofollow" target="_blank">https://dabe az . blogspot . com/2010/01/python-Gil-visualized . html</a></figcaption></figure><p id="264f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">他谈到了一个应用程序，该应用程序在一台具有单个处理核心的计算机上运行两个CPU绑定的线程。</p><p id="7146" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这很有效，两个线程同时执行。</p><p id="dab9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当同一个双线程应用程序在一台具有两个处理内核的计算机上运行时，由于GIL的存在，会发生一些奇怪的事情。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/495f8765569ee7856965a5755394fb28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JZr80R5-B_6dw9CW"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">在具有两个处理核心的机器上运行的两个CPU绑定线程(来源:<a class="ae le" href="https://dabeaz.blogspot.com/2010/01/python-gil-visualized.html" rel="noopener ugc nofollow" target="_blank">https://dabe az . blogspot . com/2010/01/python-Gil-visualized . html</a>)</figcaption></figure><p id="613c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上图中，红色区域显示了由于另一个内核上的另一个线程占用了一个处理器的线程而无法运行的时间。</p><p id="a078" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有趣的是，GIL也让多线程的I/O操作变慢了。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/47cdd21bc412e846d8931dc99765c63e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PH4jxUYfoO0RalZM"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">多线程，一个I/O绑定，另一个CPU绑定(来源:<a class="ae le" href="https://dabeaz.blogspot.com/2010/01/python-gil-visualized.html" rel="noopener ugc nofollow" target="_blank">https://dabe az . blogspot . com/2010/01/python-Gil-visualized . html</a>)</figcaption></figure><p id="7967" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上文中，请注意，I/O绑定操作在从CPU绑定操作获取GIL以执行其处理时面临困难。</p><p id="bd70" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个问题后来得到了解决，如下文所述:</p><div class="ns nt gp gr nu nv"><a href="https://mail.python.org/pipermail/python-dev/2009-October/093321.html" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">返工GIL</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">你好，在过去的几天里，我一直致力于GIL的实验性重写。因为工作已经…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">mail.python.org</p></div></div></div></a></div></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="0971" class="na ln it bd lo nb nc nd lr ne nf ng lu nh ni nj lx nk nl nm ma nn no np md nq bi translated">那为什么用GIL呢？</h1><p id="c4b7" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">GIL的发展是因为它提供了许多优势:</p><ul class=""><li id="cbae" class="ml mm it js b jt ju jx jy kb ox kf oy kj oz kn mq mr ms mt bi translated">这很容易实现，同时确保线程安全并避免竞争情况</li><li id="e743" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">它提高了单线程应用程序的速度</li><li id="e4bf" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">它允许Python与许多非线程安全的C库轻松集成</li></ul><p id="23b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于许多Python包和模块都是在牢记GIL的情况下开发的，因此很难在不破坏它们的情况下移除GIL。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/f453c9bcd67ff4f0a4606945c648bb0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9y7xmWq2QxDucues"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@writecodenow?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Boitumelo Phetla </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="08d0" class="na ln it bd lo nb nc nd lr ne nf ng lu nh ni nj lx nk nl nm ma nn no np md nq bi translated">解决方法</h1><ul class=""><li id="8471" class="ml mm it js b jt mf jx mg kb mn kf mo kj mp kn mq mr ms mt bi translated">一个可能的解决方案是使用另一个不使用GIL的Python参考实现。<br/>这样的例子有<a class="ae le" href="https://wiki.python.org/moin/Jython" rel="noopener ugc nofollow" target="_blank"> Jython </a>(运行在Java上)和<a class="ae le" href="https://wiki.python.org/moin/IronPython" rel="noopener ugc nofollow" target="_blank"> IronPython </a>(运行在Java上)。NET CLR和Mono)。</li><li id="e5f0" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">另一种方法是使用多个进程而不是多线程来扩展应用程序(使用Python <code class="fe ok ol om on b">multiprocessing</code>包)</li><li id="47df" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">最后，最终的解决方案可能是从CPython中移除GIL(通常称为“<strong class="js iu"><em class="pd">gile切除术</em> </strong>”)。<br/>由于移除GIL时给出的许多硬性要求，此操作尚未完成。</li></ul><p id="d91f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以在此阅读相关要求:</p><div class="ns nt gp gr nu nv"><a href="https://wiki.python.org/moin/GlobalInterpreterLock" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">GlobalInterpreterLock-Python Wiki</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">在CPython中，全局解释器锁或GIL是一个互斥体，它保护对Python对象的访问，防止多个…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">wiki.python.org</p></div></div></div></a></div><p id="b2eb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您也可以查看下面的库的<code class="fe ok ol om on b">gilectomy</code>分支，了解更多关于这项工作的更新。</p><div class="ns nt gp gr nu nv"><a href="https://github.com/larryhastings/gilectomy" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">GitHub-Larry Hastings/gile切除术:CPython的gile切除术分支。在git中使用“git切除术”分支。阅读…</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">CPython直肠切除术支。在git中使用“git切除术”分支。阅读下面重要的简短自述文件！- GitHub …</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="pe l og oh oi oe oj ky nv"/></div></div></a></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/c9346b7d9d1f8c0d919dc36354e5d7a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SCbyNt8Hr3lXvLYX"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">约翰·施诺布里奇在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="17ba" class="na ln it bd lo nb oq nd lr ne or ng lu nh os nj lx nk ot nm ma nn ou np md nq bi translated">其他资源</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg op l"/></div></figure><div class="ns nt gp gr nu nv"><a href="https://docs.python.org/3/c-api/init.html#thread-state-and-the-global-interpreter-lock" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">初始化、终结和线程- Python 3.10.7文档</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">在嵌入Python的应用中，必须在使用任何其他Python/C API函数之前调用该函数；与……</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">docs.python.org</p></div></div></div></a></div><div class="ns nt gp gr nu nv"><a href="https://realpython.com/python-gil/" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">什么是Python全局解释器锁(GIL)？-真正的蟒蛇</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">Python的全局解释器锁或GIL，简单来说就是一个互斥体(或锁)，只允许一个线程持有…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">realpython.com</p></div></div><div class="oe l"><div class="ph l og oh oi oe oj ky nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a href="https://en.wikipedia.org/wiki/Global_interpreter_lock" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">全局解释器锁-维基百科</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">全局解释器锁(GIL)是计算机语言解释器中使用的一种机制，用于同步…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">en.wikipedia.org</p></div></div></div></a></div><div class="ns nt gp gr nu nv"><a href="https://en.wikipedia.org/wiki/CPython" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">CPython -维基百科</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">CPython是Python编程语言的参考实现。用C和Python编写的CPython是…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">en.wikipedia.org</p></div></div><div class="oe l"><div class="pi l og oh oi oe oj ky nv"/></div></div></a></div></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="9e81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="pd">本文到此为止！非常感谢你的阅读！</em></p><div class="ns nt gp gr nu nv"><a href="https://bamania-ashish.medium.com/membership" rel="noopener follow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">通过我的推荐链接加入Medium-Ashish Bama nia博士</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">阅读Ashish Bamania博士(以及Medium上成千上万的其他作家)的每一个故事。您的会员费直接…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">bamania-ashish.medium.co</p></div></div><div class="oe l"><div class="pj l og oh oi oe oj ky nv"/></div></div></a></div></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="a390" class="na ln it bd lo nb nc nd lr ne nf ng lu nh ni nj lx nk nl nm ma nn no np md nq bi translated">分级编码</h1><p id="ac0c" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="2d3c" class="ml mm it js b jt ju jx jy kb ox kf oy kj oz kn mq mr ms mt bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="0ca0" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">📰查看<a class="ae le" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>中的更多内容</li><li id="0c37" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">🔔关注我们:<a class="ae le" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae le" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae le" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="6313" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🚀👉<a class="ae le" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">将像你这样的开发人员安置在顶级创业公司和科技公司</strong> </a></p></div></div>    
</body>
</html>