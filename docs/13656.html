<html>
<head>
<title>Build React Application using Web Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Web组件构建React应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-react-application-using-web-components-4d3ff46bc92f?source=collection_archive---------9-----------------------#2022-09-26">https://levelup.gitconnected.com/build-react-application-using-web-components-4d3ff46bc92f?source=collection_archive---------9-----------------------#2022-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="62d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们是否应该在应用程序中与React.js一起使用Web组件一直是有争议的。然而，将Web组件与React一起使用是很简单的。两者可以毫不费力地共存。React.js可用于构建直观的UI和管理数据。Web组件可用于创建可重用的DOM元素。但是，<a class="ae ko" href="https://reactjs.org/docs/web-components.html" rel="noopener ugc nofollow" target="_blank"> React社区并不推荐在React app </a>中使用Web组件制作组件。</p><p id="2776" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将把Web组件集成到React.js应用程序中。我们还将看到在React.js应用程序中集成<a class="ae ko" href="https://lit.dev/" rel="noopener ugc nofollow" target="_blank"> Lit元素</a>的示例。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/021f28f7f3ec6b4363c206a931b571c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YeESsUjY8jn1odH0KlcTPg.png"/></div></div></figure><h2 id="934e" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated"><strong class="ak">先决条件</strong>:</h2><p id="ad3c" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">在继续之前，您应该对React.js和Web组件有一个基本的了解。</p><h2 id="8d50" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">1.创建基本的React应用程序</h2><p id="53eb" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">我们将使用<a class="ae ko" href="https://parceljs.org/" rel="noopener ugc nofollow" target="_blank">package bundler</a>在CodeSandbox中创建一个简单的React应用程序。我们将创建一个主页组件和一个标题组件。稍后，我们将迁移Web组件中的Header组件。项目目录将如下所示</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/05295e71d9b0b4635f878089e393021f.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*PkYXockuoIrNdDRcq1Lhvg.png"/></div></figure><p id="66a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">头组件是非常基本的。它有菜单项。单击菜单项时，它会提示菜单项名称。</p><pre class="kq kr ks kt gt ma mb mc md aw me bi"><span id="650f" class="lb lc it mb b gy mf mg l mh mi">function Header() {<br/>  const onLinkClick = (name) =&gt; alert(`You have clicked on "${name}"`);<br/>  return (<br/>    &lt;header&gt;<br/>      &lt;ul&gt;<br/>        &lt;li onClick={() =&gt; onLinkClick("Home")}&gt;Home&lt;/li&gt;<br/>        &lt;li onClick={() =&gt; onLinkClick("About")}&gt;About&lt;/li&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/header&gt;<br/>  );<br/>}</span></pre><p id="57fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">主页组件导入了标题和一个带有表格的部分。</p><pre class="kq kr ks kt gt ma mb mc md aw me bi"><span id="8506" class="lb lc it mb b gy mf mg l mh mi">import Header from "../components/Header";</span><span id="9870" class="lb lc it mb b gy mj mg l mh mi">function HomePage() {<br/>  return (<br/>    &lt;div&gt;<br/>      <strong class="mb iu">&lt;Header /&gt;</strong><br/>      &lt;section&gt;<br/>        &lt;table&gt;<br/>          &lt;thead&gt;<br/>            &lt;tr&gt;<br/>              &lt;th&gt;Name&lt;/th&gt;<br/>              &lt;th&gt;Age&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>          &lt;/thead&gt;<br/>          &lt;tbody&gt;<br/>            &lt;tr&gt;<br/>              &lt;td&gt;Deepak&lt;/td&gt;<br/>              &lt;td&gt;33&lt;/td&gt;<br/>            &lt;/tr&gt;<br/>            &lt;tr&gt;<br/>              &lt;td&gt;Sam&lt;/td&gt;<br/>              &lt;td&gt;20&lt;/td&gt;<br/>            &lt;/tr&gt;<br/>          &lt;/tbody&gt;<br/>        &lt;/table&gt;<br/>      &lt;/section&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="9730" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以在给定的CodeSandbox中找到完整的代码。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h2 id="2b87" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">2.将React.js组件迁移到Web组件</h2><p id="b722" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">要将React组件转换为Web组件，首先我们需要创建HeaderElm。HeaderElm将扩展<code class="fe mm mn mo mb b">HTMLElement</code>。在组件创建上，我们需要打开影子根，修改<code class="fe mm mn mo mb b">shadowRoot</code>的<code class="fe mm mn mo mb b">innerHTML</code>内容。</p><pre class="kq kr ks kt gt ma mb mc md aw me bi"><span id="4590" class="lb lc it mb b gy mf mg l mh mi">class HeaderElm extends HTMLElement {<br/>  constructor() {<br/>    super();<br/>    const shadow = this.attachShadow({ mode: "open" });<br/>    shadow.innerHTML = `<br/>    &lt;style&gt;<br/>    header {<br/>      height: 40px;<br/>      width: 100%;<br/>      padding: 10px 20px;<br/>      background-color: rebeccapurple;<br/>      color: #fff;<br/>    }<br/>    header ul {<br/>      list-style: none;<br/>      padding: 0;<br/>      margin: 0;<br/>    }<br/>    header ul li {<br/>      display: inline;<br/>      line-height: 40px;<br/>      margin-right: 10px;<br/>    }<br/>    header ul li:hover {<br/>      background-color: red;<br/>      cursor: pointer;<br/>    }<br/>    &lt;/style&gt;<br/>    &lt;header&gt;<br/>      &lt;ul&gt;<br/>        &lt;li &gt;Home&lt;/li&gt;<br/>        &lt;li&gt;About&lt;/li&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/header&gt;<br/>    `;<br/>  }</span><span id="cec7" class="lb lc it mb b gy mj mg l mh mi">connectedCallback() {<br/>    this.attachedListener(this.shadowRoot);<br/>  }<br/>  attachedListener(root) {<br/>    for (let elm of root.querySelectorAll("ul li")) {<br/>      elm.addEventListener("click", ({ target: { textContent } }) =&gt;<br/>        alert(`You have clicked on ${textContent}`)<br/>      );<br/>    }<br/>  }<br/>}<br/>if (!customElements.get("app-header"))<br/>  customElements.define("app-header", HeaderElm);</span></pre><p id="e954" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它可能看起来很冗长，因为我们必须在<code class="fe mm mn mo mb b">innerHTML</code>中附加样式。然而，我们可以将CSS字符串迁移到一个<strong class="js iu">外部JS </strong>文件，并在需要时导入它。你应该注意的另一件事是，我们需要从影子根和<code class="fe mm mn mo mb b">addEventListener</code>中获取元素。由于有了<strong class="js iu"> JSX </strong>，在React组件中添加事件监听器要容易得多。</p><p id="1df5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了使用<code class="fe mm mn mo mb b">app-header</code>，我们需要稍微修改一下JSX。</p><pre class="kq kr ks kt gt ma mb mc md aw me bi"><span id="8ec4" class="lb lc it mb b gy mf mg l mh mi">function HomePage() {<br/>  return (<br/>    &lt;div&gt;<br/>      <strong class="mb iu">&lt;app-header&gt;&lt;/app-header&gt;</strong><br/>      &lt;section&gt;<br/>        { /* Rest of the code */ }<br/>      &lt;/section&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="ea17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以在给定的CodeSandbox中找到完整的代码。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h2 id="d720" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">3.将数据从React.js传递到Web组件</h2><p id="4f65" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">您可以使用属性将数据从React组件传递到Web组件。但是，由于HTML的限制，您只能将字符串数据作为属性值传递。然后，您必须对字符串数据进行反序列化。</p><pre class="kq kr ks kt gt ma mb mc md aw me bi"><span id="e189" class="lb lc it mb b gy mf mg l mh mi">// HomePage.jsx</span><span id="edd2" class="lb lc it mb b gy mj mg l mh mi">function HomePage() {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;app-header <strong class="mb iu">data={JSON.stringify({ name: "deepak" })}</strong>&gt;&lt;/app-header&gt;<br/>      { /* Rest of the code */ }<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="846b" class="lb lc it mb b gy mj mg l mh mi">// Header.js<br/>class HeaderElm extends HTMLElement {<br/>  // Rest of the code<br/>  connectedCallback() {<br/>    <strong class="mb iu">const data = JSON.parse(this.getAttribute("data"));<br/>    console.log(data);</strong><br/>  }  <br/>}</span></pre><p id="fb04" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将数据作为属性传递既乏味又容易受到攻击。另一种传递数据的方法是直接获取web组件并将数据分配给元素。但是，您确实需要某种更新方法来确认Web组件您已经更新了数据。</p><pre class="kq kr ks kt gt ma mb mc md aw me bi"><span id="029c" class="lb lc it mb b gy mf mg l mh mi">// Header.js<br/>class HeaderElm extends HTMLElement {<br/>  // rest of the code<br/>  update() {<br/>    console.log(this.userdata);<br/>  }<br/>}</span><span id="b19a" class="lb lc it mb b gy mj mg l mh mi">// HomePage.jsx</span><span id="e03e" class="lb lc it mb b gy mj mg l mh mi">function HomePage() {<br/>  <strong class="mb iu">const hederRef = useRef(null);</strong></span><span id="162a" class="lb lc it mb b gy mj mg l mh mi"><strong class="mb iu">  useEffect(() =&gt; {<br/>    hederRef.current.userdata = { name: "deepak" };<br/>    hederRef.current.update();<br/>  }, []);</strong></span><span id="713a" class="lb lc it mb b gy mj mg l mh mi">return (<br/>    &lt;div&gt;<br/>      &lt;app-header<br/>        <strong class="mb iu">ref={hederRef}</strong><br/>        data={JSON.stringify({ name: "deepak" })}<br/>      &gt;&lt;/app-header&gt;<br/>      <br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="608e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mp">还有另外一种方法，使用</em> <a class="ae ko" href="https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events" rel="noopener ugc nofollow" target="_blank"> <em class="mp">自定义事件</em> </a> <em class="mp">。您可以在Web组件中添加一个事件侦听器，并从React App向Web组件分派事件。我将把实现留给您来尝试。</em></p><p id="ea10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi mq translated"><span class="l mr ms mt bm mu mv mw mx my di"> N </span> <strong class="js iu">注:</strong>如果你想学习更多关于web组件和围绕它们的设计模式的知识。请参考我之前的文章<a class="ae ko" href="https://javascript.plainenglish.io/build-react-like-web-components-in-plain-javascript-b9921dcf6df0" rel="noopener ugc nofollow" target="_blank">build-react-like-we b-components-in-plain-JavaScript</a>。它将指导您通过不同的设计模式来传递数据，就像React.js组件一样。</p><p id="200f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以在给定的CodeSandbox中找到更新的代码。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h2 id="5748" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">结论</h2><p id="cd92" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">如您所见，在React.js应用程序中使用Web组件并不困难。但是，它会增加应用程序的复杂性，并且复杂性会随着应用程序的增加而增加。所以，我不建议你把React.js和Web组件混合使用。除非你想创建一个独立的跨框架Webb组件库。</p><h2 id="9c1f" class="lb lc it bd ld le lf dn lg lh li dp lj kb lk ll lm kf ln lo lp kj lq lr ls lt bi translated">参考</h2><ol class=""><li id="7d0c" class="mz na it js b jt lu jx lv kb nb kf nc kj nd kn ne nf ng nh bi translated"><a class="ae ko" href="https://reactjs.org/tutorial/tutorial.html" rel="noopener ugc nofollow" target="_blank">https://reactjs.org/tutorial/tutorial.html</a></li><li id="5559" class="mz na it js b jt ni jx nj kb nk kf nl kj nm kn ne nf ng nh bi translated"><a class="ae ko" href="https://reactjs.org/docs/hooks-reference.html" rel="noopener ugc nofollow" target="_blank">https://reactjs.org/docs/hooks-reference.html</a></li><li id="56f7" class="mz na it js b jt ni jx nj kb nk kf nl kj nm kn ne nf ng nh bi translated"><a class="ae ko" href="https://reactjs.org/docs/web-components.html" rel="noopener ugc nofollow" target="_blank">https://reactjs.org/docs/web-components.html</a></li><li id="a101" class="mz na it js b jt ni jx nj kb nk kf nl kj nm kn ne nf ng nh bi translated"><a class="ae ko" href="https://javascript.plainenglish.io/build-react-like-web-components-in-plain-javascript-b9921dcf6df0" rel="noopener ugc nofollow" target="_blank">https://JavaScript . plain English . io/build-react-like-we b-components-in-plain-JavaScript-b 9921 DCF 6 df 0</a></li><li id="0875" class="mz na it js b jt ni jx nj kb nk kf nl kj nm kn ne nf ng nh bi translated"><a class="ae ko" href="https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/Events/Creating _ and _ trigging _ Events</a></li></ol></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="738e" class="nu lc it bd ld nv nw nx lg ny nz oa lj ob oc od lm oe of og lp oh oi oj ls ok bi translated">分级编码</h1><p id="d2d7" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="8bb4" class="mz na it js b jt ju jx jy kb ol kf om kj on kn oo nf ng nh bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="b647" class="mz na it js b jt ni jx nj kb nk kf nl kj nm kn oo nf ng nh bi translated">📰查看<a class="ae ko" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="3309" class="mz na it js b jt ni jx nj kb nk kf nl kj nm kn oo nf ng nh bi translated">🔔关注我们:<a class="ae ko" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ko" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ko" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="9b1e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🚀👉<a class="ae ko" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">将像你这样的开发人员安置在顶级创业公司和科技公司</strong> </a></p></div></div>    
</body>
</html>