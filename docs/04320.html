<html>
<head>
<title>How to squash git commits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何挤压git提交</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-squash-git-commits-9a095c1bc1fc?source=collection_archive---------0-----------------------#2020-06-21">https://levelup.gitconnected.com/how-to-squash-git-commits-9a095c1bc1fc?source=collection_archive---------0-----------------------#2020-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/193c0975d9336246c185c8e48e0973a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2jVIe1lUmOilV2HFrQViQ.png"/></div></div></figure><p id="4ab2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在学习如何挤压提交之前，让我们先看看<code class="fe kz la lb lc b">git squash</code>是什么。</p><p id="62bd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Git squash是一种帮助您进行一系列提交并将其浓缩为几个提交的技术。</p><p id="1f77" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，假设您有一系列n次提交。通过挤压，您可以将所有的n次提交变成一次提交。</p><p id="67e3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">挤压主要用于压缩大量提交，使其成为少量有意义的提交。这样我们可以让git的历史更加清晰。</p><p id="03ac" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">合并分支时也会用到它。大多数人会建议您总是压缩提交，并将其与父分支(如master或develop)重新组合。</p><p id="c408" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，当你挤压和重置父分支时，主分支的历史将非常清晰，并且只有有意义的提交。</p><h2 id="4a86" class="ld le it bd lf lg lh dn li lj lk dp ll km lm ln lo kq lp lq lr ku ls lt lu lv bi translated">如何做git壁球</h2><p id="283c" class="pw-post-body-paragraph kb kc it kd b ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky im bi translated">例如，考虑下面的git历史</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/38948877e7a55aecaf3e79080da5c6c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/0*kNhvmKOTbH8gREZr.png"/></div></figure><p id="48ed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这里，您可以看到最后三次提交。这三次提交说明我们添加了一个新文件，并添加了一些内容。</p><p id="912e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最好将它作为一次提交，说明新文件已经添加了一些内容。因此，让我们看看如何将最后三次提交压缩为一次提交。</p><pre class="mc md me mf gt mg lc mh mi aw mj bi"><span id="2c99" class="ld le it lc b gy mk ml l mm mn">git rebase -i HEAD~3</span></pre><p id="a3e6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">git rebase -i是一个交互式工具，可以帮助你挤压提交。它有各种各样的选择。但我们只讨论饭桶南瓜。</p><p id="50ef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您对git-rebase不太适应，也不用担心。使用交互式git-rebase(即git rebase -i)实现压缩提交是一种非常简单的技术</p><p id="f0c3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">HEAD~3解释了我们正在进行最后三次提交。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/10401a9a8bd660401e3b50bf19337466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/0*1OcD1ro5Diu6_RfC.png"/></div></figure><p id="d25e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">交互式rebase将打开编辑器。您可以看到rebase -i是如何进行最后三次提交的。注意它的选项数量。</p><p id="65b9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们只关注壁球。</p><p id="88c0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如前所述，让我们进行一次提交。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/da0fdad3887454226a9430f735e46d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/0*WdMxm8X6u0zBNHMG.png"/></div></figure><p id="57d3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以看到，我们已经将最后两个提交标记为挤压。您可以使用<strong class="kd iu">挤压</strong>或<strong class="kd iu"> s </strong>来标记挤压的提交。</p><p id="adae" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在上面的例子中，被挤压的提交将被合并到主提交(即被标记为pick的提交)中。</p><p id="cbaf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">标记提交后，您可以保存编辑器。</p><p id="16b0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">保存编辑器后，rebase -i将打开另一个编辑器输入提交消息，如下图所示。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/3d28cf73d0d58ec78af3ff844c73a499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/0*HPJdNAq7ZNLbl7bv.png"/></div></figure><p id="fa2a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">编辑提交消息后，您可以保存该编辑器。注意以<strong class="kd iu"> # </strong>开头的行将被忽略。</p><p id="62db" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">git日志如下</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/5ced14bc88143c93201cd018211899f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/0*w6Tt4DpGTEPC84St.png"/></div></figure><p id="fcd2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我已经编辑了提交消息，还注意到我们已经将这三个提交压缩为一个提交。</p><p id="70bc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请注意，提交哈希也发生了变化。git rebase将总是创建一个新的commit，包含相应的更改。</p><p id="9d6b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">慎用</strong></p><p id="ae24" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">记住挤压将改变git历史。因此，如果您已经将分支推到远程，则不建议挤压。</p><p id="edd4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将更改推至远程之前，请始终挤压。</p><h2 id="7401" class="ld le it bd lf lg lh dn li lj lk dp ll km lm ln lo kq lp lq lr ku ls lt lu lv bi translated">使用修复选项挤压</h2><p id="1618" class="pw-post-body-paragraph kb kc it kd b ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky im bi translated">您还可以使用修复选项来压缩提交。修正和挤压是一样的，但是它不允许你编辑提交消息。它会将主提交(即标记为pick的提交)作为提交消息。</p><p id="2384" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们看一个例子</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/19706b3600db12bd6650ade018d62c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/0*YUoTPxeOiDrTOJp4.png"/></div></figure><p id="8c8a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以使用<strong class="kd iu">修复</strong>或<strong class="kd iu"> f </strong>来获得提交。获得提交后，您可以保存编辑器。交互式rebase将保存提交消息。</p><p id="3175" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">git历史如下</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/98199942b9939f92e55035e82c9cb9a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/0*oT0-htVk3SxUQ2hn.png"/></div></figure><p id="335d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请注意，Git已经接收了主提交消息，并将另外两个提交消息压入其中。另请注意，提交哈希也已经更改。</p><h2 id="d90e" class="ld le it bd lf lg lh dn li lj lk dp ll km lm ln lo kq lp lq lr ku ls lt lu lv bi translated">合并分支时使用挤压</h2><p id="d29d" class="pw-post-body-paragraph kb kc it kd b ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky im bi translated">Git还提供了在合并分支时挤压的选项。这是一个非常有用的命令，非常方便。</p><p id="a6f8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们大多数人将在分行工作。我们将检查分支，以建立一个新的功能或修复一些快速错误。</p><p id="b737" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，当我们准备将这些变更合并到主分支(主分支或开发分支)时，压缩这些变更将更有意义。</p><p id="cc29" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，考虑下面的命令</p><pre class="mc md me mf gt mg lc mh mi aw mj bi"><span id="3b7a" class="ld le it lc b gy mk ml l mm mn">git merge --squash target_branch_name</span></pre><p id="317a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该命令将从目标分支获取所有提交，压缩它们，并在当前分支中存放所有更改。然后，您可以在一次提交中提交所有的更改。</p><p id="8668" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们看一个例子</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/05bb9f6fc2ba0aadc357711c31e8f221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/0*o4BxVOTurF3xP3RB.png"/></div></figure><p id="c70f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以看到，我们正在合并一个分支，以使用-squash选项进行开发。Git将接受所有的更改，并且已经准备好这些更改。</p><h2 id="03fb" class="ld le it bd lf lg lh dn li lj lk dp ll km lm ln lo kq lp lq lr ku ls lt lu lv bi translated">在Github中压缩提交</h2><p id="98db" class="pw-post-body-paragraph kb kc it kd b ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky im bi translated">Github还提供了挤压提交的选项。这也是一个非常有用的特性，在合并一个拉取请求时会很方便。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/749a81cf5640e112ed16866662c0d781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CynQqPwIIojBNXmy.png"/></div></div></figure><p id="3b3a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以挤压和合并更改。因此所有五次提交将被压缩为一次提交。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/5f6144e9f67cc8dcdd525e59f36918f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-9oNAyEzETbosHXS.png"/></div></div></figure><p id="0416" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以看到，单次提交是通过相关的提交消息完成的。</p><p id="d716" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢您的阅读:)</p><p id="3a37" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">希望你学到了新东西:)</p><p id="4360" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">你可以在这里找到我的其他git相关文章</strong></p><pre class="mc md me mf gt mg lc mh mi aw mj bi"><span id="781d" class="ld le it lc b gy mk ml l mm mn">1. <a class="ae mw" rel="noopener ugc nofollow" target="_blank" href="/how-to-rewrite-the-latest-commit-with-git-amend-48a8d5f27758">How to rewrite the latest commit with git amend</a></span><span id="b01f" class="ld le it lc b gy mx ml l mm mn">2. <a class="ae mw" rel="noopener ugc nofollow" target="_blank" href="/useful-tricks-you-might-not-know-about-git-log-ed5ac32625ef">Useful tricks you might not know about git log</a></span><span id="22d6" class="ld le it lc b gy mx ml l mm mn">3. <a class="ae mw" rel="noopener ugc nofollow" target="_blank" href="/how-git-revert-works-9b87b8b03dd3">How git revert works</a></span><span id="9366" class="ld le it lc b gy mx ml l mm mn">4. <a class="ae mw" rel="noopener ugc nofollow" target="_blank" href="/what-is-git-cherry-pick-and-how-to-use-it-effectively-665247192442">How git cherry-pick works and how to use it effectively</a></span><span id="8fa6" class="ld le it lc b gy mx ml l mm mn">5. <a class="ae mw" rel="noopener ugc nofollow" target="_blank" href="/automate-repetitive-tasks-with-custom-git-commands-76a4b71d262f">Automate repetitive tasks in Git</a></span><span id="e5a3" class="ld le it lc b gy mx ml l mm mn">6. <a class="ae mw" rel="noopener ugc nofollow" target="_blank" href="/how-to-use-git-fetch-and-git-pull-effectively-c6a4becfbc16">Useful tricks of git fetch and git pull</a></span><span id="73cc" class="ld le it lc b gy mx ml l mm mn">7. <a class="ae mw" href="https://medium.com/@srebalaji/a-very-basic-intro-of-git-b9cab0e64153" rel="noopener">A very basic intro of Git</a></span></pre><p id="0513" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你已经来了这么久，那么我想你会对Git更感兴趣。可以订阅我的简讯<a class="ae mw" href="https://gitbetter.substack.com/" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">Git better</strong></a><strong class="kd iu">获取Git的招数、技巧、高级话题。</strong></p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="c4b9" class="nf le it bd lf ng nh ni li nj nk nl ll nm nn no lo np nq nr lr ns nt nu lu nv bi translated">分级编码</h1><p id="ef3e" class="pw-post-body-paragraph kb kc it kd b ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky im bi translated">感谢您成为我们社区的一员！<a class="ae mw" href="https://www.youtube.com/channel/UC3v9kBR_ab4UHXXdknz8Fbg?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank">订阅我们的YouTube频道</a>或者加入<a class="ae mw" href="https://skilled.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu"> Skilled.dev编码面试课程</strong> </a>。</p><div class="nw nx gp gr ny nz"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">编写面试问题</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">一个完整的平台，在这里我会教你找到下一份工作所需的一切，以及…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">技术开发</p></div></div><div class="oi l"><div class="oj l ok ol om oi on jz nz"/></div></div></a></div></div></div>    
</body>
</html>