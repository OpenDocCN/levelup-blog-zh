<html>
<head>
<title>How to add text summarizer to Google Docs using Text Summarization API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用文本摘要API将文本摘要添加到Google文档中</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-add-text-summarizer-to-google-docs-using-text-summarization-api-22a81e780f06?source=collection_archive---------6-----------------------#2021-05-25">https://levelup.gitconnected.com/how-to-add-text-summarizer-to-google-docs-using-text-summarization-api-22a81e780f06?source=collection_archive---------6-----------------------#2021-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7689" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">添加一个TL；谷歌文档的博士按钮</h2></div><p id="f9e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">无论你是一名作家、数据科学家，还是只是为了完成一项工作而浏览资料，阅读较长的文本来提取信息碎片都是相当累人的。将工作中的这些元素自动化可以让你专注于事物的创造性方面。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/3476ced8dd500dac2d3a78595f9535c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oyCaHSA8-QC4J_r5f6eRug.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">除非另有说明，文中所有图片均为作者。</figcaption></figure><h1 id="f459" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">文本摘要</h1><p id="29b4" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">文本摘要是从大量文本中提取关键信息元素的技术。手动文本摘要是一项困难且耗时的任务，因此NLP和机器学习算法开始流行来自动化它。</p><p id="dfc2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">市场上有现成的解决方案，无论是以库的形式还是以面向最终用户的现成工具的形式。</p><p id="6691" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将准备我们自己的定制解决方案，同时不需要数据科学的高级知识。</p><p id="84c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae mr" href="https://fischerbach.medium.com/membership" rel="noopener">🔔想要更多这样的文章？在这里签名。</a></p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="ce16" class="lu lv it bd lw lx mz lz ma mb na md me jz nb ka mg kc nc kd mi kf nd kg mk ml bi translated">NLP云</h1><p id="a815" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated"><a class="ae mr" href="https://nlpcloud.io/" rel="noopener ugc nofollow" target="_blank"> NLP Cloud </a>是使用机器学习模型进行文本处理的多个API的提供商。其中之一是文本摘要器，从简单实现的角度来看，它很有前途。</p><p id="ad17" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">NLP Cloud提供的摘要器是<em class="ne">提取</em>，意思是不生成新的句子，但是去除了低信噪比的部分。</p><p id="beff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看一个例子:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nf"><img src="../Images/3329a59eae73c77ff8bfc6305ecbbf40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHsc1i1KqLPn0REStxDgNQ.png"/></div></div></figure><p id="7bb0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们传递一个文本块，模型返回一个摘要。但是在控制台中操作不是很方便。所以，我们让Google Docs这样总结选中的文本片段。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="d8e7" class="lu lv it bd lw lx mz lz ma mb na md me jz nb ka mg kc nc kd mi kf nd kg mk ml bi translated">扩展Google文档</h1><p id="622e" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">我们的目标是创建一个方便的菜单，使文本摘要自动发生在谷歌文档。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ng"><img src="../Images/b0393dce495b2b1d21e49c8168bf6acd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*euqj0_PgCApv_oKiRkK__g.png"/></div></div></figure><p id="cbd5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是我们项目的结构。使用Apps脚本，我们将使用一个按钮来扩展GUI，该按钮将触发与NLP云API通信的函数，然后插入下面的结果。</p><p id="8453" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将从准备菜单附件开始。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="c8ca" class="lu lv it bd lw lx mz lz ma mb na md me jz nb ka mg kc nc kd mi kf nd kg mk ml bi translated">制作菜单</h1><p id="1452" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">使用Google Apps脚本向Google Docs添加自定义功能相当容易。您可以使用新的菜单、对话框和边栏来自定义用户界面。要创建脚本，打开谷歌文档后，选择工具-&gt;脚本编辑器。</p><p id="f718" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ne">注意:你可以从我的其他文章中了解更多关于创建Apps脚本项目的信息:</em></p><div class="nh ni gp gr nj nk"><a href="https://netlabe.com/how-to-create-online-survey-for-free-with-surveyjs-and-google-sheets-d9a782d0f458" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">如何使用SurveyJS和Google Sheets免费创建在线调查</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">作为web应用程序数据库的电子表格</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">netlabe.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny lo nk"/></div></div></a></div><p id="36c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有界面元素都应添加到<code class="fe nz oa ob oc b">onOpen</code>功能中。它在打开文档后运行，允许我们添加菜单。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="2af6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">保存脚本并刷新文档后，您应该会发现新的菜单元素“文本摘要器”。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi of"><img src="../Images/af9c23622d26bb685db5cd7d6956f899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*VuEULNEvGb3PZkGYf8i5Pw.png"/></div></figure><p id="46af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们实现<code class="fe nz oa ob oc b">summarizeSelection</code>函数之前，我们必须获得选中的文本。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="99ba" class="lu lv it bd lw lx mz lz ma mb na md me jz nb ka mg kc nc kd mi kf nd kg mk ml bi translated">获取选择</h1><p id="15b8" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">棘手的部分是获取当前选中的文本并将其传递给函数。得益于<code class="fe nz oa ob oc b">getSelection</code>功能，这是可能的:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="23a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，这个函数不仅返回文档中突出显示的部分，还返回选择内容所在的整个段落。这就是为什么我们创建更复杂的<code class="fe nz oa ob oc b">getSelectedText</code>函数:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="d4e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该函数只需将整个段落裁剪成选中的片段。它还返回段落的索引，以便您知道在哪里插入摘要。</p><p id="f25e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们将文本发送给API并解析结果。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="4ec9" class="lu lv it bd lw lx mz lz ma mb na md me jz nb ka mg kc nc kd mi kf nd kg mk ml bi translated">外部API</h1><p id="42dd" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">我们将使用` UrlFetch服务直接发出API请求。文本摘要API请求需要通过令牌进行授权。要获得它，在nlpcloud.io注册(免费计划就可以了)。</p><p id="75aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">被请求的API返回请求的原始JSON响应。</p><p id="76ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">记住，这个脚本处理的所有文本都被发送到外部API。</strong></p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="a7b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要测试功能，只需在文档中选择一个文本片段，然后从文档菜单中选择<code class="fe nz oa ob oc b">Text Summarization -&gt; Summarize selection</code>。</p><p id="637b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">经过一段时间的处理后，您应该会看到一个带有结果的弹出窗口，您甚至可以复制它。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi og"><img src="../Images/f2aee65342ea3d1e04031d85486b0b5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wN7Klk-qgc_6iVKQrq05w.png"/></div></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="7a89" class="lu lv it bd lw lx mz lz ma mb na md me jz nb ka mg kc nc kd mi kf nd kg mk ml bi translated">撰写对文档的回复</h1><p id="2146" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">最后，我们可以将API生成的摘要直接插入到文档中。为了便于区分，将摘要文本加粗。这就是为什么<code class="fe nz oa ob oc b">getSelectedText</code>函数还会返回所选文本的段落索引。</p><p id="fe0e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这种方式，我们确切地知道在哪里告诉应用程序脚本插入新的文本。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="c24e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们测试最终版本:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="oh oe l"/></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="66e3" class="lu lv it bd lw lx mz lz ma mb na md me jz nb ka mg kc nc kd mi kf nd kg mk ml bi translated">外卖食品</h1><p id="593e" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">构建一个基于外部API扩展Google Docs功能的应用程序，是构建大型系统来自动化不方便的工作步骤的有趣替代方案。此外，根据需要和具体技能，可以更换单个组件。例如，我们的解决方案可以扩展为情感检测或文本分类(在NLP Cloud中也可用)。您也可以直接在Apps脚本中准备自己的API或简单函数。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oi"><img src="../Images/22e1b0bc54a738bc156fba54cff2eda0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nwZvfADZ0PWLBXDCdIWjBg.png"/></div></div></figure><h1 id="b56c" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">参考</h1><p id="cc94" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated"><a class="ae mr" href="https://jeffreyeverhart.com/2018/10/05/translate-text-google-doc-using-google-apps-script/" rel="noopener ugc nofollow" target="_blank">https://jeffreyeverhart . com/2018/10/05/translate-text-Google-doc-using-Google-apps-script/</a></p><p id="5bc1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae mr" href="https://developers.google.com/google-ads/scripts/docs/features/third-party-apis" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/Google-ads/scripts/docs/features/第三方API</a></p><p id="c17a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae mr" href="https://netlabe.com/real-time-context-targeting-using-nlp-baceb4324fc4" rel="noopener ugc nofollow" target="_blank">https://netlabe . com/real-time-context-targeting-using-NLP-baceb 4324 fc 4</a></p></div></div>    
</body>
</html>