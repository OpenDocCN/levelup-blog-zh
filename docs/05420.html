<html>
<head>
<title>Create Resizable Table Columns with Angular Directives</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用角度指令创建可调整大小的表列</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-resizable-table-columns-with-angular-directives-a9e0f5c1cbf7?source=collection_archive---------1-----------------------#2020-08-27">https://levelup.gitconnected.com/create-resizable-table-columns-with-angular-directives-a9e0f5c1cbf7?source=collection_archive---------1-----------------------#2020-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="871e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">增压您的角度应用自定义可调整大小的表格指令！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/393622ab6dbfa44a425e269244ff66cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Na9vfvsPtz8zHcFB9XSp-g.jpeg"/></div></div></figure><blockquote class="kr"><p id="a598" class="ks kt iq bd ku kv kw kx ky kz la lb dk translated">简单是效率的灵魂—奥斯汀·弗里曼</p></blockquote><p id="156d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx lb ij bi ly translated">Twitter开发者社区是我遇到的最好的开发者聚集地之一。我最近开始变得更加活跃，我发现这很有趣，学习和灵感。</p><p id="1274" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">亚历克斯·因金的以下推文启发了我写这篇文章。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mn mo l"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">亚历克斯·因金发推文</figcaption></figure><p id="df70" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">上面的代码片段是一个角度指令，可用于调整任何表格列的大小。我个人认为这非常有用，并将为学习角度指令和<code class="fe mt mu mv mw b">rxjs</code>基础知识树立一个很好的榜样。</p><p id="b380" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">让我们开始吧</p><h2 id="1213" class="mx my iq bd mz na nb dn nc nd ne dp nf lm ng nh ni lq nj nk nl lu nm nn no np bi translated">这个计划</h2><p id="58a3" class="pw-post-body-paragraph ld le iq lf b lg nq jr li lj nr ju ll lm ns lo lp lq nt ls lt lu nu lw lx lb ij bi translated">这里的基本思想并不简单。为此，我们将采取以下步骤。</p><blockquote class="nv nw nx"><p id="cf2d" class="ld le ny lf b lg mh jr li lj mi ju ll nz mj lo lp oa mk ls lt ob ml lw lx lb ij bi translated"><strong class="lf ir">注意:</strong>表格列的宽度实际上是相应标题单元格的宽度(<code class="fe mt mu mv mw b">&lt;th&gt;</code>)。</p></blockquote><ol class=""><li id="eda5" class="oc od iq lf b lg mh lj mi lm oe lq of lu og lb oh oi oj ok bi translated">通过创建一个新的组件向<code class="fe mt mu mv mw b">&lt;th&gt;</code>元素引入更多的模板。</li><li id="947b" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">设置这些模板的样式以反映表格边框样式。</li><li id="3c92" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">沿着边框拖动时，增加/减少<code class="fe mt mu mv mw b">&lt;th&gt;</code>元素的宽度。</li></ol><h2 id="0caa" class="mx my iq bd mz na nb dn nc nd ne dp nf lm ng nh ni lq nj nk nl lu nm nn no np bi translated">创建组件</h2><p id="4a1a" class="pw-post-body-paragraph ld le iq lf b lg nq jr li lj nr ju ll lm ns lo lp lq nt ls lt lu nu lw lx lb ij bi translated">这里的要点是在表头单元格中有伪模板。出于这个原因，我们需要引入一个带有模板的新组件。</p><pre class="kg kh ki kj gt oq mw or os aw ot bi"><span id="3ea4" class="mx my iq mw b gy ou ov l ow ox">ng generate component resizable</span></pre><p id="e0cc" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">让我们向它介绍我们的模板</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oy mo l"/></div></figure><p id="3212" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">你可以看到我们在这里使用了内容投影，有趣的是，我们在<code class="fe mt mu mv mw b">.bar</code>元素上还有一个名为<code class="fe mt mu mv mw b">resizable</code>的自定义事件。</p><p id="32dd" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">实现控制器</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oy mo l"/></div></figure><p id="e068" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">值得注意的是，组件选择器是<code class="fe mt mu mv mw b">th[resizable]</code>，它将使用<code class="fe mt mu mv mw b">[resizable]</code>指令选择所有的<code class="fe mt mu mv mw b">&lt;th&gt;</code>元素。</p><p id="2fd1" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">你可以在下面我写的文章中读到更多关于上述选择器方法的内容。</p><div class="oz pa gp gr pb pc"><a href="https://bharathravi.com/posts/learn-angular-component-design-patterns-from-material-components" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd ir gy z fp ph fr fs pi fu fw ip bi translated">从材料组件中学习角度组件设计模式</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">有哪些材料组件可以教给我们组件设计模式！巴拉瑟拉维8月6日3分钟读“使它…</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">bharathravi.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq kp pc"/></div></div></a></div><p id="560a" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">我们还使用<code class="fe mt mu mv mw b">@HostBinding</code>将主机的宽度(<code class="fe mt mu mv mw b">th</code>)绑定到属性<code class="fe mt mu mv mw b">width</code>。元素的宽度现在用<code class="fe mt mu mv mw b">onResize(width)</code>函数动态更新。该事件稍后将由<code class="fe mt mu mv mw b">resizable</code>指令触发。</p><p id="285e" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">我们还需要一些CSS样式来模仿表格的边框。这里可以找到<a class="ae mm" href="https://gist.github.com/BharathRavi27/ef37204793618bc4d89c718e7b058214" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="2888" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">这就是组件实现的全部内容。</p><h2 id="6477" class="mx my iq bd mz na nb dn nc nd ne dp nf lm ng nh ni lq nj nk nl lu nm nn no np bi translated">创建指令</h2><p id="c698" class="pw-post-body-paragraph ld le iq lf b lg nq jr li lj nr ju ll lm ns lo lp lq nt ls lt lu nu lw lx lb ij bi translated">现在让我们创建<code class="fe mt mu mv mw b">resizable</code>指令。</p><pre class="kg kh ki kj gt oq mw or os aw ot bi"><span id="8fde" class="mx my iq mw b gy ou ov l ow ox">ng generate directive resizable</span></pre><p id="134a" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">我们的<code class="fe mt mu mv mw b">resizable</code>指令的唯一目的是在拖动列边框时发出一个事件(<code class="fe mt mu mv mw b">resizable</code>)。然后，<code class="fe mt mu mv mw b">resizable</code>组件使用该事件来操作表格单元格宽度属性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oy mo l"/></div></figure><p id="d712" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">我们在<code class="fe mt mu mv mw b">constructor</code>中注入<code class="fe mt mu mv mw b">DOCUMENT</code>和<code class="fe mt mu mv mw b">ElementRef</code>来间接访问各自的API。</p><p id="d3ac" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">然后我们还有使用指令发出的<code class="fe mt mu mv mw b">readonly</code> <code class="fe mt mu mv mw b">@Output</code>事件。我们在<code class="fe mt mu mv mw b">rxjs operators</code>的帮助下创建一个可观察值，并将值转换成期望的形式。</p><p id="d2d0" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">让我们将上面的代码实现分解成下面这些较小的步骤。</p><ol class=""><li id="d9fd" class="oc od iq lf b lg mh lj mi lm oe lq of lu og lb oh oi oj ok bi translated">使用<code class="fe mt mu mv mw b">rxjs</code>的<code class="fe mt mu mv mw b">fromEvent()</code>函数在主机组件上创建一个来自本机<code class="fe mt mu mv mw b">mousedown</code>事件的可观察对象(在我们的例子中，这是我们引入到<code class="fe mt mu mv mw b">&lt;th&gt;</code>中的自定义模板)。</li><li id="6a38" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">使用<code class="fe mt mu mv mw b">pipe()</code>方法组合多个<code class="fe mt mu mv mw b">rxjs</code>运算符。</li><li id="376d" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">使用<code class="fe mt mu mv mw b">tap</code>操作器执行<code class="fe mt mu mv mw b">preventdefault()</code>功能，这对于避免任何不良副作用非常重要。</li><li id="220b" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">应用<code class="fe mt mu mv mw b">switchMap</code>操作符，确保我们在<code class="fe mt mu mv mw b">mousemove</code>期间取消任何<code class="fe mt mu mv mw b">mousedown</code>事件，以避免多次发射。</li><li id="f0be" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">获取最近的<code class="fe mt mu mv mw b">th</code>(宿主元素)的信息(在DOM中的宽度和位置)。</li><li id="85fb" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">计算标题单元格右边界的新位置。</li><li id="5e6f" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">使用<code class="fe mt mu mv mw b">distinctUntilChanged()</code>过滤掉与先前值相同的值(将鼠标放在相同的位置)</li><li id="7a8b" class="oc od iq lf b lg ol lj om lm on lq oo lu op lb oh oi oj ok bi translated">在<code class="fe mt mu mv mw b">mouseup</code>事件时停止发射数值。</li></ol><p id="5663" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">就这些了！我们现在有了一个角度指令，可以在整个应用程序中使用它来赋予表格列调整大小的超级能力😃。</p><h2 id="3a36" class="mx my iq bd mz na nb dn nc nd ne dp nf lm ng nh ni lq nj nk nl lu nm nn no np bi translated">测试它</h2><p id="d06f" class="pw-post-body-paragraph ld le iq lf b lg nq jr li lj nr ju ll lm ns lo lp lq nt ls lt lu nu lw lx lb ij bi translated">让我们看看如何在组件上使用它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oy mo l"/></div></figure><p id="d54c" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">像那样优雅！</p></div><div class="ab cl pr ps hu pt" role="separator"><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw"/></div><div class="ij ik il im in"><p id="3fe2" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">更多类似的文章👇</p><div class="oz pa gp gr pb pc"><a href="http://bharathravi.com/" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd ir gy z fp ph fr fs pi fu fw ip bi translated">Bharath Ravi | javaScript文章</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">有能力的文章来提升你的网络技能。javaScript全栈开发者Bharath Ravi的个人博客</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">bharathravi.com</p></div></div><div class="pl l"><div class="py l pn po pp pl pq kp pc"/></div></div></a></div><p id="daed" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">在twitter上找到我<a class="ae mm" href="https://twitter.com/_bharath_ravi" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="5032" class="pw-post-body-paragraph ld le iq lf b lg mh jr li lj mi ju ll lm mj lo lp lq mk ls lt lu ml lw lx lb ij bi translated">黑客快乐！</p></div></div>    
</body>
</html>