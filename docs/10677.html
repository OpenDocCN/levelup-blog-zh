<html>
<head>
<title>FastAPI vs. Express.js vs. Flask vs. Nest.js Benchmark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">FastAPI vs . express . js vs . Flask vs . nest . js基准测试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/fastapi-vs-express-js-vs-flask-vs-nest-js-benchmark-5e14d518cc00?source=collection_archive---------1-----------------------#2022-01-01">https://levelup.gitconnected.com/fastapi-vs-express-js-vs-flask-vs-nest-js-benchmark-5e14d518cc00?source=collection_archive---------1-----------------------#2022-01-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0190" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想验证FastAPI宣称的与Node.js相当的性能，所以我决定进行一次基准测试。为此，我使用了wrk，一个HTTP基准测试工具。</p><p id="ed15" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我还想通过调用一个端点来测试它，这个端点调用一个PostgreSQL数据库，以便模拟一个更“真实”的场景。在每种情况下，我都创建了一个从数据库返回100行数据的端点。</p><p id="829d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我测试了以下组合:</p><ul class=""><li id="54c9" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">FastAPI + psycopg2</li><li id="b9da" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">FastAPI + SQLModel</li><li id="c27a" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">烧瓶+ psycopg2 +烧瓶运行</li><li id="35b2" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">烧瓶+ psycopg2 + gunicorn</li><li id="1976" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">快递. js + pg</li><li id="7a62" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">Nest.js + Prisma</li><li id="e0f6" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">烧瓶+ psycopg2 + gunicorn (4名工人)</li><li id="a6c8" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">FastAPI + psycopg2 + gunicorn (4名工人)</li><li id="ba28" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">FastAPI + SQLModel + gunicorn (4个工人)</li></ul><p id="2064" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个测试的代码可以在这里找到:<a class="ae lc" href="https://github.com/travisluong/python-vs-nodejs-benchmark" rel="noopener ugc nofollow" target="_blank">https://github.com/travisluong/python-vs-nodejs-benchmark</a>。</p><p id="9038" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果如下:</p><h1 id="8312" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI+psycopg 2+uvicon</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="5c47" class="mk le it mg b gy ml mm l mn mo">$ uvicorn fast_psycopg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></span><span id="ae8b" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    32.35ms    3.63ms  50.66ms   90.42%<br/>    Req/Sec   154.76     13.60   202.00     78.00%<br/>  3110 requests in 10.10s, 23.79MB read<br/>Requests/sec:    308.01<br/>Transfer/sec:      2.36MB</span></pre><h1 id="e026" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI+SQL model+uvicon</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="713f" class="mk le it mg b gy ml mm l mn mo">$ uvicorn fast_sqlmodel:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></span><span id="139f" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    54.50ms    9.41ms  99.36ms   78.56%<br/>    Req/Sec    91.89     16.03   130.00     75.38%<br/>  1842 requests in 10.10s, 11.28MB read<br/>Requests/sec:    182.45<br/>Transfer/sec:      1.12MB</span></pre><h1 id="5e3b" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">烧瓶+ psycopg2 +烧瓶运行</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="6a81" class="mk le it mg b gy ml mm l mn mo">$ FLASK_APP=flask_psycopg flask run<br/>$ wrk <a class="ae lc" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank">http://localhost:5000</a></span><span id="63b9" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:5000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    14.06ms    4.48ms  42.07ms   73.73%<br/>    Req/Sec   354.51     19.96   404.00     70.50%<br/>  7070 requests in 10.01s, 37.77MB read<br/>  Non-2xx or 3xx responses: 2501<br/>Requests/sec:    705.95<br/>Transfer/sec:      3.77MB</span></pre><h1 id="31b7" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">烧瓶+ psycopg2 + gunicorn (1名工人)</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="d139" class="mk le it mg b gy ml mm l mn mo">$ gunicorn -w 1 --bind 0.0.0.0:5000 flask_psycopg:app<br/>$ wrk <a class="ae lc" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank">http://localhost:5000</a></span><span id="9763" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:5000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    18.50ms  743.07us  22.31ms   84.33%<br/>    Req/Sec   269.51      7.33   287.00     55.00%<br/>  5386 requests in 10.04s, 46.47MB read<br/>Requests/sec:    536.65<br/>Transfer/sec:      4.63MB</span></pre><h1 id="8056" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">快递. js + pg</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="a4e9" class="mk le it mg b gy ml mm l mn mo">$ node express_pg.js<br/>$ wrk <a class="ae lc" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></span><span id="9660" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:3000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency     5.19ms    1.04ms  20.60ms   89.87%<br/>    Req/Sec     0.97k    89.72     1.08k    66.34%<br/>  19521 requests in 10.10s, 151.39MB read<br/>Requests/sec:   1931.99<br/>Transfer/sec:     14.98MB</span></pre><h1 id="d10a" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">Nest.js + Prisma</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="6dbb" class="mk le it mg b gy ml mm l mn mo">$ npm start<br/>$ wrk <a class="ae lc" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></span><span id="625e" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:3000/feed<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency     8.49ms    2.37ms  37.77ms   84.94%<br/>    Req/Sec   594.97     91.32   720.00     65.00%<br/>  11860 requests in 10.02s, 91.98MB read<br/>Requests/sec:   1184.11<br/>Transfer/sec:      9.18MB</span></pre><h1 id="1759" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">烧瓶+ psycopg2 + gunicorn (4名工人)</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="1a52" class="mk le it mg b gy ml mm l mn mo">$ gunicorn -w 4 --bind 0.0.0.0:5000 flask_psycopg:app<br/>$ wrk <a class="ae lc" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank">http://localhost:5000</a></span><span id="4713" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:5000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency     6.66ms    1.71ms  26.50ms   90.09%<br/>    Req/Sec   743.20     60.59     0.89k    65.00%<br/>  14814 requests in 10.02s, 127.81MB read<br/>Requests/sec:   1478.02<br/>Transfer/sec:     12.75MB</span></pre><h1 id="4a02" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI + psycopg2 + gunicorn (4名工人)</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="7c22" class="mk le it mg b gy ml mm l mn mo">$ gunicorn -w 4 -k uvicorn.workers.UvicornWorker fast_psycopg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></span><span id="c39e" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    10.86ms    7.75ms  39.84ms   78.87%<br/>    Req/Sec   499.02    291.50     0.91k    55.50%<br/>  9962 requests in 10.07s, 76.19MB read<br/>Requests/sec:    989.50<br/>Transfer/sec:      7.57MB</span></pre><h1 id="ab17" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI + SQLModel + gunicorn (4个工人)</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="715a" class="mk le it mg b gy ml mm l mn mo">$ gunicorn -w 4 -k uvicorn.workers.UvicornWorker fast_sqlmodel:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></span><span id="acab" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    17.72ms   10.82ms  57.08ms   58.85%<br/>    Req/Sec   286.39    112.97   515.00     56.00%<br/>  5723 requests in 10.05s, 35.04MB read<br/>Requests/sec:    569.46<br/>Transfer/sec:      3.49MB</span></pre><h1 id="655b" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">结论</h1><p id="1384" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">看起来极简主义者Express.js + pg组合赢得了这一轮基准测试，其次是拥有4个gunicorn工人的Flask和Nest.js + Prisma。</p><p id="6c82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">带有“Flask run”服务器的flask有大量非2xx或3xx响应，这是开发服务器所期望的。</p><p id="ab5b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另一方面，FastAPI+psyco pg 2+uvicon似乎落后Express.js + pg超过6倍。</p><p id="ed67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">FastAPI + SQLModel + gunicorn相比Nest.js + Prisma大约相差2倍。</p><p id="6de8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有趣的是，Flask + psycopg2 + gunicorn几乎以2倍的速度击败了FastAPI + psycopg2 + gunicorn。</p><p id="568a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">FastAPI在性能方面与Node.js框架不相上下，这样说安全吗？还是我做的测试不正确？也许我没有以正确的方式利用FastAPI的异步功能？</p><p id="12d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最终，您选择哪个框架可能并没有太大的关系。只使用你最擅长的语言，因为开发人员的时间通常比计算能力更昂贵。</p><h1 id="a032" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">2012年1月3日更新</h1><p id="ba8b" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">感谢Dmitry指出我应该使用asyncpg库而不是psycopg2。</p><p id="ace4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我还包含了一个encode/databases库的基准测试，它在FastAPI网站的Async SQL部分中公布。</p><p id="4315" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">尽管添加了异步数据库驱动程序，FastAPI在性能上似乎仍然落后于Node.js。JSON序列化是一个可能的瓶颈。如果有人知道如何优化这一点，请告诉我！</p><p id="6539" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是asyncpg和数据库的更新结果。</p><h1 id="4ddc" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI+asyncpg+uvicon</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="280f" class="mk le it mg b gy ml mm l mn mo">$ uvicorn fast_asyncpg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></span><span id="c2e9" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    31.74ms    3.49ms  79.23ms   97.83%<br/>    Req/Sec   158.01     13.26   181.00     85.00%<br/>  3172 requests in 10.09s, 24.26MB read<br/>Requests/sec:    314.52<br/>Transfer/sec:      2.41MB</span></pre><h1 id="696b" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI + asyncpg + gunicorn (4名工人)</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="3c1f" class="mk le it mg b gy ml mm l mn mo">$ gunicorn -w 4 -k uvicorn.workers.UvicornWorker fast_asyncpg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></span><span id="d2e9" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    10.48ms    4.41ms  27.52ms   59.84%<br/>    Req/Sec   478.83     84.78   666.00     60.50%<br/>  9552 requests in 10.02s, 73.06MB read<br/>Requests/sec:    952.99<br/>Transfer/sec:      7.29MB</span></pre><h1 id="78ab" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI +数据库+uvicon</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="3069" class="mk le it mg b gy ml mm l mn mo">$ uvicorn fast_databases:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></span><span id="3988" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    37.31ms    4.39ms  95.69ms   94.49%<br/>    Req/Sec   134.30     12.86   151.00     77.50%<br/>  2697 requests in 10.08s, 20.63MB read<br/>Requests/sec:    267.69<br/>Transfer/sec:      2.05MB</span></pre><h1 id="f3a3" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">2012年1月4日更新</h1><p id="3623" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">我已经确认JSON序列化是瓶颈。默认的序列化器比ujson和orjson慢很多。</p><p id="a445" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是新的结果！</p><h1 id="3939" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI+psyco pg 2+uvicon+orjson</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="4df3" class="mk le it mg b gy ml mm l mn mo">$ uvicorn fast_psycopg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000/orjson" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/orjson</a></span><span id="0d06" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000/orjson<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency    12.06ms    1.77ms  30.71ms   87.39%<br/>    Req/Sec   415.52     23.51   464.00     72.50%<br/>  8317 requests in 10.05s, 63.61MB read<br/>Requests/sec:    827.30<br/>Transfer/sec:      6.33MB</span></pre><h1 id="f06d" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI+asyncpg+uvicon+orjson</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="6c39" class="mk le it mg b gy ml mm l mn mo">$ uvicorn fast_asyncpg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000/orjson" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/orjson</a></span><span id="7b9b" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000/orjson<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency     5.34ms    1.15ms  19.18ms   94.82%<br/>    Req/Sec     0.95k    44.71     1.01k    78.50%<br/>  18870 requests in 10.01s, 144.33MB read<br/>Requests/sec:   1885.25<br/>Transfer/sec:     14.42MB</span></pre><h1 id="f01a" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI+asyncpg+uvicon+ujson</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="30c8" class="mk le it mg b gy ml mm l mn mo">$ uvicorn fast_asyncpg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000/ujson" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/ujson</a></span><span id="b3ad" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000/ujson<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency     5.85ms    0.97ms  18.79ms   88.35%<br/>    Req/Sec     0.86k    33.84     0.92k    82.00%<br/>  17134 requests in 10.01s, 131.05MB read<br/>Requests/sec:   1711.69<br/>Transfer/sec:     13.09MB</span></pre><h1 id="2622" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI + asyncpg + gunicorn (4名工人)+ orjson</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="ad83" class="mk le it mg b gy ml mm l mn mo">$ gunicorn -w 4 -k uvicorn.workers.UvicornWorker fast_asyncpg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000/orjson" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/orjson</a></span><span id="ffac" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000/orjson<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency     2.64ms    3.04ms  47.94ms   98.38%<br/>    Req/Sec     2.11k   733.24     3.31k    54.50%<br/>  41995 requests in 10.01s, 321.20MB read<br/>Requests/sec:   4193.72<br/>Transfer/sec:     32.08MB</span></pre><h1 id="168b" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">FastAPI + asyncpg + gunicorn (4名工人)+ ujson</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="48c8" class="mk le it mg b gy ml mm l mn mo">$ gunicorn -w 4 -k uvicorn.workers.UvicornWorker fast_asyncpg:app<br/>$ wrk <a class="ae lc" href="http://localhost:8000/ujson" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/ujson</a></span><span id="298e" class="mk le it mg b gy mp mm l mn mo">Running 10s test @ http://localhost:8000/ujson<br/>  2 threads and 10 connections<br/>  Thread Stats   Avg      Stdev     Max   +/- Stdev<br/>    Latency     2.27ms  794.94us  21.49ms   69.94%<br/>    Req/Sec     2.21k   316.77     2.79k    63.00%<br/>  44028 requests in 10.00s, 336.75MB read<br/>Requests/sec:   4401.04<br/>Transfer/sec:     33.66MB</span></pre><h1 id="4157" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">定论</h1><p id="c086" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">胜出者是FastAPI+asyncpg+4 guni corn workers+ujson。</p><p id="1c39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">FastAPI绝对很快，与Node.js不相上下，不负众望！根据这些基准。</p><p id="1813" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">只要确保你使用了正确的库就行了！</p><p id="fe4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我意识到基准测试中还有另一个缺陷。Node.js有一个集群模式，我并不知道。有关新的基准测试和完整的排名，请查看这篇基准测试文章的第2部分:</p><p id="88f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lc" href="https://medium.com/@travisluong/fastapi-vs-fastify-vs-spring-boot-vs-gin-benchmark-b672a5c39d6c" rel="noopener">https://medium . com/@ travisluong/fastapi-vs-fastify-vs-spring-boot-vs-gin-benchmark-b 672 a5 c 39d 6 c</a></p><p id="e0b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您有兴趣了解FastAPI和其他神奇工具的更多信息，请查看我的完整堆栈教程:</p><p id="ccb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lc" href="https://medium.com/@travisluong/full-stack-next-js-fastapi-postgresql-tutorial-86f0af0747b7" rel="noopener">https://medium . com/@ travisluong/full-stack-next-js-fastapi-PostgreSQL-tutorial-86 f 0af 0747 b 7</a></p><p id="9ef8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读。</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><p id="f217" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nc">原载于2022年1月1日</em><a class="ae lc" href="https://www.travisluong.com/fastapi-vs-express-js-vs-flask-vs-nest-js-benchmark/" rel="noopener ugc nofollow" target="_blank"><em class="nc"/></a><em class="nc">。</em></p></div></div>    
</body>
</html>