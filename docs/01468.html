<html>
<head>
<title>Set Up a Simple JavaScript Unit Test Environment From Zero</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从零开始设置简单的JavaScript单元测试环境</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/set-up-a-simple-javascript-unit-test-environment-from-zero-ab8c053050ac?source=collection_archive---------6-----------------------#2020-01-05">https://levelup.gitconnected.com/set-up-a-simple-javascript-unit-test-environment-from-zero-ab8c053050ac?source=collection_archive---------6-----------------------#2020-01-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b2a1" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Java Script语言</h2><div class=""/><div class=""><h2 id="964f" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用Jest从头开始实现JavaScript单元测试的指南</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/f0c663d1a50c128da32cc74516ac8550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NAhkH-TzdqTMKU_y4wopjw.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">Ashkan Forouzani 在<a class="ae lh" href="https://unsplash.com/s/photos/coffee-cup?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="60f2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将提供一个教程，介绍如何用Jest创建一个简单的单元测试环境。</p><ol class=""><li id="533d" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">从头开始创建项目</li><li id="7bae" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">安装Jest</li><li id="7441" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">编写您的第一个单元测试</li></ol><p id="e4d7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我通常用这种方式为我的私有库在一个用JavaScript实现的项目中创建单元测试。</p><p id="cadd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="ms">更多类似内容，请查看</em><a class="ae lh" href="https://betterfullstack.com" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://betterfullstack.com</em></a></p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="b4ea" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">从头开始创建项目</h1><p id="ce5c" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">我更喜欢从零开始为初级开发人员创造一些东西，因为这将帮助他们很好地理解编程，设置事物，并对事物如何协同工作有更好的想法。</p><p id="6279" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我创建一个名为<code class="fe nx ny nz oa b">setup-unit-test</code>的新文件夹:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/bde08d9be35375132661257a8bc7a1b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTQUovq8gCSae4UNJQV3dA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">安装-单元-测试中的Visual Studio代码和PowerShell状态</figcaption></figure><p id="4f97" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其次，使用<code class="fe nx ny nz oa b">npm init</code>创建<code class="fe nx ny nz oa b">package.json</code>,需要注意几点:</p><ol class=""><li id="6d7a" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><strong class="lk jd">描述</strong>:您的项目描述</li><li id="a411" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd">测试命令</strong>:放<code class="fe nx ny nz oa b">jest</code>因为这个项目会用jest来运行</li><li id="fa0a" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd">关键字</strong>:添加项目中使用的编程语言或主要框架等主要关键字。</li><li id="815e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd">作者</strong>:作者信息，应遵循<code class="fe nx ny nz oa b">full name &lt;email&gt; (personal website)</code>。</li></ol><p id="f3d5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你想把你的代码推送到像<a class="ae lh" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> Github </a>这样的公共库，那么做:</p><pre class="ks kt ku kv gt oc oa od oe aw of bi"><span id="51a1" class="og nb it oa b gy oh oi l oj ok">git init<br/>git add README.md<br/>git commit -m "first commit"<br/>git remote add origin REPO-URL<br/>git push -u origin master</span></pre><p id="91aa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">或者用于现有的储存库。</p><pre class="ks kt ku kv gt oc oa od oe aw of bi"><span id="4d1e" class="og nb it oa b gy oh oi l oj ok">git remote add origin REPO-URL<br/>git push -u origin master</span></pre></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="63b4" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">安装Jest</h1><p id="e8d3" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">什么是Jest？Jest 是一个令人愉快的JavaScript测试框架，专注于简单性。</p><p id="a03d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们需要首先创建<code class="fe nx ny nz oa b">package.json</code>，因为我们需要这个文件来管理项目的依赖项，比如<a class="ae lh" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>。</p><p id="08c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要安装Jest，我们需要执行以下步骤:</p><p id="94c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，运行<code class="fe nx ny nz oa b">npm i -D jest</code>或<code class="fe nx ny nz oa b">npm install --save-dev jest</code>将jest添加到<code class="fe nx ny nz oa b">package.json</code></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/0d3956fc17947bca740831a0a1316a43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LLQCkIeIX_jB88twgCw0Jg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">将jest安装到项目</figcaption></figure><p id="df61" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这将自动添加<code class="fe nx ny nz oa b">node_modules</code>文件夹，我们存储所有的依赖关系。</p><p id="0a6e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其次，添加一个<code class="fe nx ny nz oa b">index.js</code>文件，因为在<code class="fe nx ny nz oa b">package.json</code>中，我们添加了<code class="fe nx ny nz oa b">index.js</code>作为项目的主文件。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/d4029b3a566f63cf6910ea35e336a973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*etM5uupoLvZmDKIgEO9JYw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">index.js文件被自动设置为主文件。</figcaption></figure><p id="9d30" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在你可以看到，如果你在项目中有Git，我们有超过5k的文件修改。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi on"><img src="../Images/718d2174f0aa0c27d646f1744d6c97a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*ebVSZSQ8-lVuh8tEP44zOw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">来自git的5k文件更改</figcaption></figure><p id="72c1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们需要添加<code class="fe nx ny nz oa b">.gitignore</code>来忽略<code class="fe nx ny nz oa b">node_modules</code>目录，以减少文件更改，并删除不必要推送到存储库的文件夹。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/923ceaf85bc4cc4b200ebc5c70345a04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PIU9N-Bw41-G45tgw5zImQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">添加gitignore文件以忽略node_modules</figcaption></figure><p id="6a55" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在提交文件，一切准备就绪，可以编写一些单元测试了。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="2ba7" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">编写第一个单元测试</h1><p id="5c14" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">注意:这一节不是关于如何编写一个好的单元测试。这就是我们在为新手级别安装Jest后，如何用Jest实现我们的第一个单元测试。</p><p id="0aac" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">开始吧！</p><p id="2749" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有一个新函数接受一个整数，并将其作为一个<strong class="lk jd">序数返回。</strong>序数<a class="ae lh" href="https://www.mathsisfun.com/numbers/cardinal-ordinal-chart.html" rel="noopener ugc nofollow" target="_blank">是表示某事物在列表中的位置的数字，如第一、第二、第三、第四、第五等。</a></p><p id="c045" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">问题</strong>:需要对新功能进行单元测试，这样我们才能确保它在每一种情况下都能正常工作。</p><p id="4395" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在源代码中，我们需要为其编写单元测试的文件位于<code class="fe nx ny nz oa b">moduleA</code>文件夹中，并命名为<code class="fe nx ny nz oa b">module-a.js</code>。以下是文件开头的内容:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="op oq l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><code class="fe nx ny nz oa b">module-a.js</code>的内容</figcaption></figure><p id="d4a9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来创建一个<code class="fe nx ny nz oa b">module-a.test.js</code>文件，我们将在其中编写我们的测试。</p><p id="13ed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们要为单元测试写一些案例:</p><ol class=""><li id="af46" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">为快乐案例编写测试</li><li id="f41e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">为诸如负数、非数字、浮点数等错误输入编写测试用例。</li></ol><p id="4b29" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，为happy case编写所有测试用例。运行<code class="fe nx ny nz oa b">npm run test</code>来测试我们的文件。Jest将识别扩展名为<code class="fe nx ny nz oa b">.test.js</code>的测试文件。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/6e35ae8d496ca5efa2cbbdf628d3c49c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zjMsdan1ZrSuuLeWN-Yx0A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">测试每种情况下的输出</figcaption></figure><p id="e21a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第二，编写所有单元测试来处理错误输入，并期望得到一些错误消息。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="op oq l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">完成所有关于不良输入的测试用例</figcaption></figure><p id="e11a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里我们有3个测试失败。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/2a3a7823d95f6b8b732bc3e5fbaea720.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ffJYIqCuyuqkBCE2iEGYLw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">在我们为错误输入添加更多单元测试后，测试失败</figcaption></figure><p id="9db5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们回去更新函数来处理错误的输入。</p><ol class=""><li id="508f" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">为负数添加验证</li><li id="f0d6" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">为非数字输入添加验证</li><li id="eed5" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">为浮点数添加验证</li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/aebc50692e05d0be1b91cff6c30f2b6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LoBjY4LOb-nvUzyJmkoiw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">处理方法的错误输入的新逻辑</figcaption></figure><p id="367b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是我们添加更多逻辑来处理糟糕情况后的最终结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/6f0963d21cd052a27d9b5d9834ed77f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QekGblOuvk6Frrp0Z_dTwA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">所有测试用例都通过了</figcaption></figure><p id="1fd2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">搞定了。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="6d58" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">摘要</h1><p id="a22d" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">本文提供了一些关于从头创建一个简单的JavaScript项目并为其安装单元测试的提示。</p><p id="fe4d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望这篇文章对你有用！你可以在<a class="ae lh" href="https://medium.com/@transonhoang?source=post_page---------------------------" rel="noopener">媒体</a>上关注我。我也在<a class="ae lh" href="https://twitter.com/transonhoang" rel="noopener ugc nofollow" target="_blank">推特</a>上。欢迎在下面的评论中留下任何问题。我很乐意帮忙！</p><p id="7432" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">查看源代码样本<a class="ae lh" href="https://github.com/hoangtranson/setup-unit-test" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><div class="ks kt ku kv gt ov"><a href="https://betterfullstack.com/stories/" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd jd gy z fp pa fr fs pb fu fw jc bi translated">故事-更好的全栈</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">关于JavaScript、Python和Wordpress的有用文章，有助于开发人员减少开发时间并提高…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">betterfullstack.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj lb ov"/></div></div></a></div></div></div>    
</body>
</html>