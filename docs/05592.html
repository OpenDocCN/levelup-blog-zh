<html>
<head>
<title>SQL v. Pandas: Basic Syntax Comparison &amp; Cheat Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL v. Pandas:基本语法比较和备忘单</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/sql-v-pandas-basic-syntax-comparison-cheat-sheet-498289372d45?source=collection_archive---------0-----------------------#2020-09-13">https://levelup.gitconnected.com/sql-v-pandas-basic-syntax-comparison-cheat-sheet-498289372d45?source=collection_archive---------0-----------------------#2020-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="efd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在开始使用Python中的Pandas之前，我已经使用SQL好几年了。我最终习惯了它，但是当我开始的时候，我在它们之间的语法差异中挣扎。</p><p id="9c87" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想在这篇文章中收集语法比较，也作为备忘单。我将提到基本语法，但如果有另一个例子在这篇文章中不存在，请让我知道！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3c6d85580695ecf76df76fceb2901a5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gl6OfQ_bvf5TzWr5Q8xYw.png"/></div></div></figure><p id="49a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae la" href="https://github.com/shotin93/sql-v-pandas" rel="noopener ugc nofollow" target="_blank">https://github.com/shotin93/sql-v-pandas</a></p><h1 id="4de7" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">资料组</h1><p id="054f" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我将使用这个数据集。</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="cf9a" class="mj lc it mf b gy mk ml l mm mn">import pandas as pd</span><span id="cdaf" class="mj lc it mf b gy mo ml l mm mn">df_list = [<br/>  ["Lamar Jackson", 23, "Ravens", "QB"]<br/>  , ["Russell Wilson", 31, "Seahawks", "QB"]<br/>  , ["Aaron Donald", 29, "Rams", "DT"]<br/>  , ["Patrick Mahomes", 24, "Chiefs", "QB"]<br/>  , ["Michael Thomas", 27, "Saints", "WR"]<br/>  , ["Christian McCaffrey", 24, "Panthers", "RB"]<br/>  , ["George Kittle", 26, "49ers", "TE"]<br/>  , ["DeAndre Hopkins", 28, "Cardinals", "WR"]<br/>  , ["Stephon Gilmore", 29, "Patriots", "CB"]<br/>  , ["Derrick Henry", 26, "Titans", "RB"]<br/>]<br/>df_columns = ["Name", "Age", "Team", "Position"]<br/>players = pd.DataFrame(data=df_list, columns=df_columns)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/414c90db184d7ebcdfa225a786cbdb8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*oHxb8Eco_loMy9EI4e-m3A.png"/></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">演员</figcaption></figure><h1 id="c9bf" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">挑选</h1><p id="ec4a" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">全部提取:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="793e" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players</span><span id="9f69" class="mj lc it mf b gy mo ml l mm mn">Pandas: players</span></pre><p id="6537" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一些列的投影:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="5cef" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT Name, Age FROM players</span><span id="6ebd" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[["Name", "Age"]]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/9b7bf85ad3939619f52c7c88ee569f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*QQ1Qrp3TLjP9w1fekoL69A.png"/></div></figure><p id="4a8e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">顶部一些行的选择:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="b634" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT TOP 5 * FROM players</span><span id="f1ba" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.head(5)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e9147db59037a5a181c965321c634f81.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*rdN-YHl32Rm_dnCZFcWN0Q.png"/></div></figure><p id="09e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">独特:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="241f" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT DISTINCT Position FROM players</span><span id="c582" class="mj lc it mf b gy mo ml l mm mn">Pandas: players["Position"][~players["Position"].duplicated()]</span></pre><h1 id="edef" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在哪里</h1><p id="3d92" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">带条件的特定行的选择:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="dc54" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players WHERE Position = 'QB'</span><span id="aa0f" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[players.Position == "QB"]<br/>also: players[players["Position"] == "QB"]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/4f29cd17932ba639a927f59c8bec5b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*oN80uuxxeuXATepY9pjI3w.png"/></div></figure><p id="cd56" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">特定行的选择和某些列的投影</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="bac4" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT Name, Age FROM players WHERE Position = 'QB'</span><span id="f8db" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[["Name", "Age"]][players.Position == "QB"]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/89eaed14f5b813b2c118bb5c47d50f71.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*U2VfCKfGHgtgcMDPGpGoPA.png"/></div></figure><p id="94ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不是:</p><p id="28e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你必须用“~”而不是“不是”。</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="d902" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players WHERE NOT Position =='QB'</span><span id="db8d" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[~(players.Position == "QB")]<br/>also: players[~(players["Position"] == "QB")]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f3c5efd3387ef0c47e2c7ee4ff9ab0ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*ov-IrAjruthNpgwgYPSlWg.png"/></div></figure><p id="4871" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">和/或:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="ae67" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT Name, Age FROM players WHERE Position = 'QB' AND Age &lt; 30</span><span id="7ed4" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[["Name", "Age"]][(players.Position == "QB") &amp; (players.Age &lt; 30)]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/eae9753859b3aafaf1b212dfc52bc910.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*-hOrSZSyYw8upUTTyHMxpA.png"/></div></figure><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="ba04" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT Name, Age FROM players WHERE Position = 'QB' OR Position = 'RB'</span><span id="831f" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[["Name", "Age"]][(players.Position == "QB") |(players.Position == "RB")]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi na"><img src="../Images/85d757b4910b4d070876fe94a0d2ba09.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*GCw6ZjscAkAFgk-qflLAfQ.png"/></div></figure><p id="d4f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你必须用括号把操作符括起来。</p><p id="0e73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">否则，您将得到一个TypeError:无法对dtyped [int64]数组和类型为[bool]的标量执行“rand_”</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="6c8d" class="mj lc it mf b gy mk ml l mm mn"># without brackets<br/>players[["Name", "Age"]][players.Position == "QB" &amp; players.Age &lt; 30]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nb"><img src="../Images/a6d2981f37d20cbd5d2faa179c120441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tXsknv0zgni2bcNEl7aHtQ.png"/></div></div></figure><p id="9bde" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你还必须用' &amp; '和' | '来代替' and '和' or '。</p><p id="37fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">否则，您将得到一个ValueError:一个序列的真值是不明确的。使用a.empty、a.bool()、a.item()、a.any()或a.all()。</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="d7ed" class="mj lc it mf b gy mk ml l mm mn"># using 'and'<br/>players[["Name", "Age"]][(players.Position == "QB") and (players.Age &lt; 30)]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nc"><img src="../Images/0f6c9d0be10336ebc03d9ce108b3d010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G7wpexlFaKTbyB17VoOzYw.png"/></div></div></figure><p id="5cf6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当你想这样查询的时候；</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="5748" class="mj lc it mf b gy mk ml l mm mn">SELECT Name, Age FROM<br/>players<br/>WHERE (Position = 'QB' AND Age &lt; 25) OR (Position = 'RB' AND Age &lt; 25)</span></pre><p id="d144" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你必须写作；</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="6614" class="mj lc it mf b gy mk ml l mm mn">players[["Name", "Age"]][<br/>(<br/>    (players.Position == "QB") &amp; (players.Age &lt; 25)<br/>) | (<br/>    (players.Position == "RB") &amp; (players.Age &lt; 25)<br/>)]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/6caac1432cc6197fdd3e23079876d7dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*PwJgg1nA5mjqRvpUsXQDVA.png"/></div></figure><p id="4eb2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不是:</p><p id="4bbb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="2406" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players WHERE Position IN ('QB', 'RB')</span><span id="6003" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[players.Position.isin(["QB", "RB"])]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ne"><img src="../Images/2dd9438d377df90ff2f1dc9d0c5d1232.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*OYXm3woxtcwCnPn_4dwtfA.png"/></div></div></figure><p id="75ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">比如:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="ae22" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players WHERE Team LIKE '%ns%'</span><span id="9da6" class="mj lc it mf b gy mo ml l mm mn">Pandas: players[players.Team.str.contains("ns")]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b86d0a3ad7d8ca5375f89c8fafd3d895.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*TuOptmwhxohvLjh0MgqaEA.png"/></div></figure><h1 id="d3fc" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">以...排序</h1><p id="3874" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">按1列排序:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="89f1" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players ORDER BY Name</span><span id="69aa" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.sort_values("Name")</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/60ba74e9d0c1350768c19319b2062105.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*1wK5MuEqLqd8ExPkXdnIMQ.png"/></div></figure><p id="0458" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">按2+列排序:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="4267" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players ORDER BY Age, Name</span><span id="cc2f" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.sort_values(["Age", "Name"])</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ebc6299d97046323a7f4077de13b7afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*MZc9pdUvs_oM-a_lHl8cTA.png"/></div></figure><p id="937f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">DESC:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="0d6a" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT * FROM players ORDER BY Age DESC, Name</span><span id="4342" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.sort_values(["Age", "Name"], ascending=[False, True])</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/9f57450bde611b64c531c054335a5c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*rXrzozGD_BxHc1LKq7iFSw.png"/></div></figure><h1 id="bccc" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">分组依据</h1><p id="a0f9" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">计数:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="4ef2" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT COUNT(*) AS COUNT FROM players GROUP BY Position</span><span id="6689" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.groupby("Position").agg({"Name": "count"}).rename(columns={"Name": "COUNT"})</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/1182d551485f22500db0f08f3ddc6269.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/1*719Hh5b_-U5LJE4HiewzPA.png"/></div></figure><p id="97cb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总和:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="daa4" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT SUM(Age) AS Age FROM players GROUP BY Position</span><span id="a797" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.groupby("Position").agg({"Age": "sum"})</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ni"><img src="../Images/3c50c2a211714252853e961fcdb1ff95.png" data-original-src="https://miro.medium.com/v2/resize:fit:236/format:webp/1*eDiLRzyLQceAwuSuwQ7dwg.png"/></div></div></figure><p id="c7e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AVG:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="6887" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT AVG(Age) AS Age FROM players GROUP BY Position</span><span id="f6c5" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.groupby("Position").agg({"Age": "mean"})</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nj"><img src="../Images/2b40ca5355eab317be676a8e0546abe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:246/format:webp/1*93ntPcSD3M-xwv1XYd98Xw.png"/></div></div></figure><p id="f2d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">排名:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="e224" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT *, RANK() OVER (ORDER BY Age DESC) FROM players</span><span id="e1d5" class="mj lc it mf b gy mo ml l mm mn">Pandas: <br/>players["AgeRank"] = players.Age.rank(ascending=False)<br/>players</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/14bfee4148fb7d27190040af1fc24605.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*T8NXbz7TgeHdvb1-sGvh-g.png"/></div></figure><p id="0158" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">等级+分区依据</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="abc4" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT *, RANK() OVER (PARTITION BY Position ORDER BY Age DESC) FROM players</span><span id="b907" class="mj lc it mf b gy mo ml l mm mn">Pandas: <br/>players["AgeRank"] = players.groupby("Position")["Age"].rank(ascending=False)<br/>players</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/36af9fcb2a5aa2b314d97a6224bc6533.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*0YynqTI0yKIo6-euG1fWTA.png"/></div></figure><p id="0e27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">密集:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="179d" class="mj lc it mf b gy mk ml l mm mn">SQL: SELECT *, DENSE_RANK() OVER (ORDER BY Age DESC) FROM players</span><span id="2405" class="mj lc it mf b gy mo ml l mm mn">Pandas: <br/>players["AgeRank"] = players.Age.rank(method="dense", ascending=False)<br/>players</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/f8d9a2f983c81a2c19555ea6849f58a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*Zl6C1k_f4t8YQceHLy49ZA.png"/></div></figure><h1 id="847a" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更新</h1><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="5b3e" class="mj lc it mf b gy mk ml l mm mn">SQL: UPDATE players SET Age = 0 WHERE Age = 24</span><span id="69ef" class="mj lc it mf b gy mo ml l mm mn">Pandas: players.loc[players.Age == 24, "Age"] = 0</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/30e5adefd7bfd618a3ca7dc7e2dc0415.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*tGRdPFGnaj6mvNC7SOALeA.png"/></div></figure><h1 id="b913" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">加入</h1><p id="821a" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">请看我的另一篇文章！</p><div class="nn no gp gr np nq"><a href="https://medium.com/@sh_in/sql-v-pandas-join-57642dc3ce76" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">SQL v. Pandas:加入</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">在开始使用Python中的Pandas之前，我已经使用SQL好几年了。我最终习惯了，但是我…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ky nq"/></div></div></a></div></div></div>    
</body>
</html>