<html>
<head>
<title>Writing Environment Values to Allure Report in Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Java编写Allure报表的环境值</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/writing-environment-values-to-allure-report-in-java-47ab4d681fc4?source=collection_archive---------11-----------------------#2020-10-30">https://levelup.gitconnected.com/writing-environment-values-to-allure-report-in-java-47ab4d681fc4?source=collection_archive---------11-----------------------#2020-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ffc8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了用一个好的功能扩展Allure框架，我开发了<a class="ae kl" href="https://github.com/AutomatedOwl/allure-environment-writer" rel="noopener ugc nofollow" target="_blank"> Java库</a>，它允许在运行时使用allure-results目录将键/值对写入environment.xml文件。目前，该库支持带有JUnit或TestNG的Allure report。它将允许您:</p><ul class=""><li id="bdb1" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">在测试的任何阶段，轻松地将environment.xml文件的键/值集写入allure-results目录。</li><li id="4a4f" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">定义“allure-results”目录的可配置路径。</li><li id="1874" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">使用ImmutableMap对象为环境创建一组不可变的值。</li><li id="cd2d" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">GitHub链接:【https://github.com/AutomatedOwl/allure-environment-writer T2】</li></ul><h1 id="6dda" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">常见用法示例(默认路径是target/allure-results):</h1><p id="c3db" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">在下面的TestNG方法中，我们制作了一个ImmutableMap对象，它包含一组硬编码的所需键/值，出现在allure报告的“环境”部分下。我们使用allure-results文件夹的默认路径。在幕后，一个工厂方法迭代映射，并将每个键/值对写入XML文件的指定标记中。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="13c3" class="mm lb iq mi b gy mn mo l mp mq">import static com.github.automatedowl.tools.AllureEnvironmentWriter.allureEnvironmentWriter;</span><span id="15a5" class="mm lb iq mi b gy mr mo l mp mq">public class SomeTests {</span><span id="5e40" class="mm lb iq mi b gy mr mo l mp mq">    @BeforeSuite<br/>    void setAllureEnvironment() {<br/>        allureEnvironmentWriter(<br/>                ImmutableMap.&lt;String, String&gt;builder()<br/>                        .put("Browser", "Chrome")<br/>                        .put("Browser.Version", "70.0.3538.77")<br/>                        .put("URL", "http://testjs.site88.net")<br/>                        .build());<br/>    }</span><span id="a0af" class="mm lb iq mi b gy mr mo l mp mq">    @Test<br/>    void sanityOneTest() {<br/>        Assert.assertTrue(true);<br/>    }</span><span id="1a4e" class="mm lb iq mi b gy mr mo l mp mq">    @Test<br/>    void sanityTwoTest() {<br/>        Assert.assertTrue(true);<br/>    }<br/>}</span></pre><h1 id="6e46" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">定制allure的使用示例-结果路径:</h1><p id="d40d" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">下面的TestNG方法与关于的示例相同，只是使用了可配置的allure-results路径，作为“可选”参数传递给allureEnvironmentWriter方法。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="3216" class="mm lb iq mi b gy mn mo l mp mq">import static com.github.automatedowl.tools.AllureEnvironmentWriter.allureEnvironmentWriter;</span><span id="86bc" class="mm lb iq mi b gy mr mo l mp mq">public class SomeTests {</span><span id="a522" class="mm lb iq mi b gy mr mo l mp mq">    @BeforeSuite<br/>    void setAllureEnvironment() {<br/>        allureEnvironmentWriter(<br/>                ImmutableMap.&lt;String, String&gt;builder()<br/>                        .put("Browser", "Chrome")<br/>                        .put("Browser.Version", "70.0.3538.77")<br/>                        .put("URL", "http://testjs.site88.net")<br/>                        .build(), System.getProperty("user.dir")<br/>                        + "/allure-results/");<br/>    }</span><span id="93b2" class="mm lb iq mi b gy mr mo l mp mq">    @Test<br/>    void someTest() {<br/>        Assert.assertTrue(true);<br/>    }<br/>}</span></pre><h1 id="6ea6" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Allure报告中收到的环境数据的快照:</h1><figure class="md me mf mg gt mt gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/733dafc4ac2c1fbbe85619005c036fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/0*LTYCw5O317BEWd6f"/></div></figure><h1 id="3994" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Maven依赖性</h1><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="51a5" class="mm lb iq mi b gy mn mo l mp mq">&lt;dependency&gt;<br/>&lt;groupId&gt;com.github.automatedowl&lt;/groupId&gt;<br/>&lt;artifactId&gt;allure-environment-writer&lt;/artifactId&gt;&lt;version&gt;1.0.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre></div></div>    
</body>
</html>