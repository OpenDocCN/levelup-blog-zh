# æ„å»ºä¸€ä¸ª React æŒ‚é’©å¹¶å‘å¸ƒåˆ° NPM åŒ…

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/build-a-react-hook-and-publish-to-npm-packages-807041135982>

![](img/d00d12496f740cf6fff615d81672b03b.png)

react-hook ç±»å‹è„šæœ¬

è¿™æ˜¯ä¸€ä¸ªå…³äºå¦‚ä½•æ„å»ºè‡ªå®šä¹‰ React è‡ªå®šä¹‰é’©å­çš„å°æ•™ç¨‹ã€‚

React æŒ‚é’©ç°åœ¨æ›´å—åŠŸèƒ½ç»„ä»¶çš„æ¬¢è¿ï¼Œå®ƒæä¾›äº†ä¸€ç§ä½¿ç”¨ React çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ã€‚äººä»¬å¯ä»¥å°†ç»„ä»¶ä¸šåŠ¡é€»è¾‘è½¬æ¢æˆè‡ªå®šä¹‰æŒ‚é’©ã€‚è¿™å°†ä½¿ä½ çš„ä»£ç æ›´åŠ æ•´æ´å’Œæ˜“äºç®¡ç†ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ€ä¹ˆåšã€‚

æœ‰ä¸¤ä¸ªæ ¸å¿ƒ React æŒ‚é’©:

*   **ä½¿ç”¨çŠ¶æ€**
*   **ä½¿ç”¨æ•ˆæœ**

# ä½¿ç”¨çŠ¶æ€æŒ‚é’©

React çš„ useState home ç”¨äºåœ¨åŠŸèƒ½ç»„ä»¶ä¸­åˆ›å»ºçŠ¶æ€ã€‚React å°†åœ¨é‡æ–°æ¸²æŸ“ä¹‹é—´ä¿æŒè¿™ç§çŠ¶æ€ã€‚useState è¿”å›ä¸€å¯¹å€¼:å½“å‰çŠ¶æ€å€¼å’Œä¸€ä¸ªå…è®¸æ‚¨æ›´æ–°å®ƒçš„å‡½æ•°ã€‚æ‚¨å¯ä»¥ä»äº‹ä»¶å¤„ç†ç¨‹åºæˆ–å…¶ä»–åœ°æ–¹è°ƒç”¨è¯¥å‡½æ•°ã€‚å®ƒç±»ä¼¼äºç±»ä¸­çš„ this.setStateï¼Œåªæ˜¯å®ƒä¸åˆå¹¶æ–°æ—§çŠ¶æ€ã€‚

# ä½¿ç”¨æ•ˆæœ

effect æŒ‚é’©å¢åŠ äº†å¤„ç†å‰¯ä½œç”¨çš„èƒ½åŠ›ï¼Œå¹¶æ¨¡ä»¿ react çš„ç”Ÿå‘½å‘¨æœŸï¼Œç±»ä¼¼äºåŸºäºç±»çš„ç»„ä»¶ã€‚å®ƒä¸ React ç±»ä¸­çš„**componentid mount**ã€**componentid update**å’Œ**componentid unmount**çš„ä½œç”¨ç›¸åŒï¼Œä½†æ˜¯ç»Ÿä¸€åˆ°ä¸€ä¸ª API ä¸­ã€‚å½“æ‚¨è°ƒç”¨ useEffect æ—¶ï¼Œæ‚¨æ˜¯åœ¨å‘Šè¯‰ React åœ¨åˆ·æ–°å¯¹ DOM çš„æ›´æ”¹åè¿è¡Œæ‚¨çš„â€œEffectâ€å‡½æ•°ã€‚

# æ‰“é€ è‡ªå·±çš„é’©å­ğŸ’¡

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰æŒ‚é’©æ¥ä½¿ç”¨æµè§ˆå™¨å­˜å‚¨ï¼Œå¹¶é€‰æ‹©ä½¿ç”¨ localStorage å’Œ sessionStorageã€‚

> ç”¨æˆ·æµè§ˆå™¨å­˜å‚¨

å¦‚æœä¸€ä¸ªå‡½æ•°åä»¥â€œuseâ€å¼€å¤´ï¼Œé‚£ä¹ˆå®ƒå°±è¢«ç§°ä¸ºä¸€ä¸ªé’©å­ã€‚ *useBrowserStorage* å‘½åçº¦å®šæ˜¯ linter æ’ä»¶å¦‚ä½•ä½¿ç”¨é’©å­æ‰¾åˆ°ä»£ç ä¸­çš„ bugã€‚

# è®¾ç½®

æœ€å¿«çš„å¼€å§‹æ–¹å¼æ˜¯ä½¿ç”¨æ ·æ¿æ–‡ä»¶ã€‚å› æ­¤æ‚¨ä¸éœ€è¦æ‹…å¿ƒæ·»åŠ ä¾èµ–é¡¹å’Œæ„å»ºå·¥å…·ã€‚æˆ‘ä»¬å°†ä½¿ç”¨`create-react-hook` NPM åŒ…æ ·æ¿å·¥ç¨‹ã€‚

[https://www.npmjs.com/package/create-react-hook](https://www.npmjs.com/package/create-react-hook)

```
npx create-react-hook <hook-name>
```

è¿è¡Œåï¼Œæ­¤å‘½ä»¤å°†å›ç­”ä¸€äº›é—®é¢˜ï¼ŒCLI å°†è®¾ç½®é¡¹ç›®ã€‚

# å†™å‡ºä½ çš„é€»è¾‘

ç°åœ¨ä½ å·²ç»èµ°åˆ°è¿™ä¸€æ­¥ï¼Œè®©æˆ‘ä»¬å†™æˆ‘ä»¬çš„`useBrowserStorage`é’©å­é€»è¾‘ã€‚å¦‚æœä½ å·²ç»ä½¿ç”¨`create-react-hook` CLI è®¾ç½®äº†é¡¹ç›®ï¼Œé‚£ä¹ˆåœ¨`src/index.(jsx, tsx)`ä¸­æœ‰ä¸€ä¸ªæ¡ç›®æ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€äº›ç¼–å†™é’©å­çš„ç¤ºä¾‹ä»£ç ã€‚è®©æˆ‘ä»¬æ›¿æ¢å®ƒã€‚

```
export const useBrowserStorage = () => { *// logic will go here*}
```

æˆ‘ä»¬å°†æä¾›ä¸€ä¸ªé€‰é¡¹{ type }åœ¨`localStorage`å’Œ`sessionStorage`ä¹‹é—´åˆ‡æ¢ã€‚ç±»å‹çš„é»˜è®¤å€¼æ˜¯`localStorage`ã€‚

```
const STORAGE_TYPES = ['localStorage', 'sessionStorage'];export const useBrowserStorage = (options = {}) => { const type = (STORAGE_TYPES.includes(options.type) && options.type) || 'localStorage';}
```

ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒå­˜å‚¨ã€‚å®ƒè¿˜ä¼šæ£€æŸ¥æˆ‘ä»¬çš„é’©å­æ˜¯å¦åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šäº§ç”Ÿä»»ä½•é”™è¯¯ã€‚

æœ€åç»„åˆåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­

# å‘å¸ƒåˆ° NPM

ä¸€æ—¦æˆ‘ä»¬å‡†å¤‡å¥½é’©å­ï¼Œè®©æˆ‘ä»¬æŠŠå®ƒå‘å¸ƒåˆ° NPM åŒ…ã€‚

ç™»å½• NPM CLIã€‚è¾“å…¥æ‚¨çš„ç”¨æˆ·åã€å¯†ç å’Œç”µå­é‚®ä»¶è¿›è¡Œç™»å½•ã€‚

```
npm login
```

æˆåŠŸç™»å½•åï¼Œè®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªå‘½ä»¤æ¥å‘å¸ƒ

```
npm publish
```

å°±æ˜¯è¿™æ ·ï¼ï¼ï¼

**æç¤º:**å¦‚æœä½ æƒ³é‡æ–°å‘å¸ƒä½ çš„åŒ…ä¸­æœ‰æ–°çš„æ”¹åŠ¨æˆ–è€… bug ä¿®æ­£ã€‚ç„¶åä½ å¿…é¡»æ›´æ–°ä½ çš„è½¯ä»¶åŒ…ç‰ˆæœ¬ã€‚æ‚¨å¯ä»¥æ‰‹åŠ¨å°†åŒ…ç‰ˆæœ¬æ›´æ–°åˆ°`package.json`æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
npm version patch -m "message"
```

[ä¸º`npm version`å‘½ä»¤è¯»å–æ›´å¤š](https://docs.npmjs.com/cli/v6/commands/npm-version)

è¿™é‡Œæ˜¯`useBrowserStorage`çš„å®Œæ•´æºä»£ç 

[](https://github.com/ravid7000/use-browser-storage) [## ravid 7000/ä½¿ç”¨-æµè§ˆå™¨-å­˜å‚¨

### åœ¨ react ç»„ä»¶- ravid7000/use-browser-storage ä¸­ä½¿ç”¨ localStorage å’Œ sessionStorage

github.com](https://github.com/ravid7000/use-browser-storage) [](https://www.npmjs.com/package/use-browser-storage) [## ä½¿ç”¨-æµè§ˆå™¨-å­˜å‚¨

### React hook ä½¿ç”¨æµè§ˆå™¨çš„å­˜å‚¨ã€‚å½“å‰æ”¯æŒ localStoage å’Œ sessionStoageã€‚npm å®‰è£…-ä¿å­˜â€¦

www.npmjs.com](https://www.npmjs.com/package/use-browser-storage) 

å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªæ•™ç¨‹ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼ï¼ï¼