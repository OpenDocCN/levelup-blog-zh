<html>
<head>
<title>A Quick Introduction to Istio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Istio快速介绍</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-quick-introduction-to-istio-ffb486221f1f?source=collection_archive---------13-----------------------#2021-08-31">https://levelup.gitconnected.com/a-quick-introduction-to-istio-ffb486221f1f?source=collection_archive---------13-----------------------#2021-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/98e835adac456ab74c518b877dbb07b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YECeOxlko9KoOJNw8RNm3A.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">艾莉娜·格鲁布尼亚克在<a class="ae jd" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><p id="d6a4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">微服务这几天特别受欢迎。在微服务架构中，我们将大的整体系统分成许多小的微服务。所有微服务都是松散耦合的，可以相互独立地更新/部署。微服务解决了很多问题，让我们的生活轻松了很多，但也给我们的系统增加了新的复杂性。微服务增加的最大复杂性之一是不同微服务之间通信的增加。许多网络问题都是由于通信量的增加而产生的，下面列出了其中一些问题:</p><ol class=""><li id="c296" class="lb lc jg kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">管理超时和重试逻辑。</li><li id="ae54" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">通过加密数据来保护通信</li><li id="c3d9" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">观察不同服务之间的交互。</li><li id="6c0c" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">交通管理</li></ol><p id="0bd7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，我们可以在微服务逻辑本身中解决所有这些问题，但这会产生大量冗余代码。这就是一个服务网来拯救我们的地方。</p><h1 id="03c9" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">什么是服务网格？</h1><p id="66fd" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">简单地说，服务网格是一种控制不同微服务如何相互交互的方法。服务网格并不真正建立不同微服务之间的连接，而是包含管理两个不同微服务如何相互交互的策略和控制。服务网格可以让您观察、保护和控制您的网络，而只需对正在运行的微服务做很少或不做任何代码更改。Istio是一个开源项目，由Google、IBM和Lyft共同创建。</p><h1 id="ebf6" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">Istio是如何工作的？</h1><p id="96a7" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">Istio并没有为应用程序添加任何新功能，但它实际上创建了一些规则，这些规则指定了一个微服务如何与另一个微服务进行交互。Istio从微服务中提取管理服务到服务通信的逻辑，并将其抽象到基础架构层。Istio利用代理从微服务中提取通信规则。</p><p id="0096" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Istio包含两个组件:数据平面和控制平面。</p><h2 id="d4ef" class="ms lq jg bd lr mt mu dn lv mv mw dp lz ko mx my md ks mz na mh kw nb nc ml nd bi translated">数据平面</h2><p id="8e01" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">Istio的data place拦截网络上的所有数据包，并负责身份验证、授权、可观察信号的生成、健康检查、负载平衡和路由。数据平面负责集群内部发生的所有通信以及入站和出站流量。应用程序不知道网络中数据平面的存在，服务代理透明地部署在集群中所有正在运行的服务中。在下图中，您可以看到在采用Istio时是如何添加代理的。</p><figure class="nf ng nh ni gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/79d29e27356732de337961b53349c62a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Toknk68Pff6DYknesj81gw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图1:没有使用Istio(来源:<a class="ae jd" href="https://istio.io/latest/about/service-mesh/" rel="noopener ugc nofollow" target="_blank">https://istio.io/latest/about/service-mesh/</a></figcaption></figure><figure class="nf ng nh ni gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/5c35630c23260c68bc2f599ba4293720.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z_0qEsAMaTnKjp6X0IHN7w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图2使用Istio后(来源:【https://istio.io/latest/about/service-mesh/】T2)</figcaption></figure><p id="9afb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Istio使用一种称为特使代理的特殊代理。Envoy代理作为sidecar容器与所有服务一起部署。应用程序的出口和入口流量被配置为流经边车代理。由于所有流量都通过envoy proxy路由，因此它使it能够收集指标、控制流量、评估策略和加密数据传输。Istio增加了Envoy的许多内置功能，如负载平衡、TLS终止、断路器、健康检查、HTTP/2、gRPC等等。</p><h2 id="85cf" class="ms lq jg bd lr mt mu dn lv mv mw dp lz ko mx my md ks mz na mh kw nb nc ml nd bi translated">制导机</h2><p id="937a" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">控制平面是管理和保护数据平面的组件。图3显示了Istio的架构。</p><figure class="nf ng nh ni gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/6f626cca4f1ce2062fa8ad57b6563b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BBCo_Qavx_YDIX3GFppr8g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图3 Istio建筑(来源:【https://istio.io/v1.4/docs/ops/deployment/architecture/】T4</figcaption></figure><p id="e456" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从架构图中，我们可以看到控制平面有许多组件。让我们逐一讨论所有这些组件。</p><p id="9ce3" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh"> <em class="nk"> Pilot:- </em> </strong> Pilot是一个组件，它将控制流量行为的高级路由规则转换为特使特定的配置，然后传播到特使侧柜。pilot主要负责流量管理，还处理服务发现以及电路中断和重试逻辑等弹性功能。</p><p id="b2b1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh"><em class="nk">Galley:-</em></strong>Galley负责验证、摄取、处理和分发istio的配置给其他组件。厨房是从平台(如Kubernetes)读取istio的所有配置的组件，有助于将其他组件与从平台获取配置的细节隔离开来。</p><p id="c066" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh"><em class="nk">Citadel:-</em></strong>Citadel提供各种安全相关的功能。它为不同的服务提供认证和身份管理能力。它还可以在mTLS的帮助下加密多个服务之间的纯文本通信。</p><p id="3be5" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh"> <em class="nk">混合器:- </em> </strong>混合器从其余的istio组件中抽象出基础设施后端。调音师的主要职责是:</p><ol class=""><li id="7a76" class="lb lc jg kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">配额管理(如费率限制)</li><li id="a659" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">前提条件检查(例如源服务是否在目标服务的允许列表中)</li><li id="3d38" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">遥测报告(如将测井数据发送到zipkin，并通过grafana显示。).</li></ol><p id="b239" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从istio 1.6开始，混合器已被弃用，取而代之的是<a class="ae jd" href="https://istio.io/latest/docs/concepts/wasm/" rel="noopener ugc nofollow" target="_blank"> web assembly </a>。</p><h1 id="c61b" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated"><strong class="ak"> <em class="nl">结论</em> </strong></h1><p id="1d1a" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">Istio为您的应用程序做了大量繁重的工作。Istio有助于集中安全、流量管理和可观察性。Istio为运营团队带来工具，代表开发团队管理网络问题，让开发团队更加专注于应用的业务。当您的系统有许多微服务时，像istio这样的服务网格可以大大减少微服务级别的冗余配置，并使其集中在系统级别。</p></div></div>    
</body>
</html>