# 什么是 Python 集合

> 原文：<https://levelup.gitconnected.com/what-are-python-sets-59eb890ab522>

## Python 集合的简明介绍

![](img/bcfc44f18ca721391d840577329a5d10.png)

由[马克斯韦尔·尼尔森](https://unsplash.com/@maxcodes)在[unsplash.com](https://unsplash.com/photos/taiuG8CPKAQ)拍摄的照片

Python *集合*是 2.4 版本中引入的*集合*类型。它是这种语言最强大的数据结构之一，因为它的特性可以在许多用例中证明是有用和实用的。在本文中，我们将快速浏览集合背后的理论，稍后将讨论最常见的集合运算以及集合派上用场的一些用例。

## 什么是集合？

集合是可散列(即不可变)对象的**可变**和**无序**集合，其中**没有重复**。集合背后的基本思想基于数学的集合论，因此 Python 提供了与元素集合的数学概念相对应的运算。

## 如何创建器械包

有一些不同的符号可以用来创建集合，但是这也取决于您运行的 Python 版本。

在 Python 2 中。x 您可以通过调用接受任何**可迭代**或**序列**的内置函数`set()`来创建集合:

```
# Creating a set in Python 2.x>>> x = set('abcdefg')
>>> x
set(['b', 'd', 'g', 'a', 'c', 'f', 'e'])  # display in Python 2.x
```

注意，正如我们已经提到的，集合是一个**无序的**元素集合。从上面的例子可以看出，结果集中元素的顺序与提供的原始*序列*的顺序不匹配(回想一下，在 Python 中，字符串是一个*序列*)。

Python 3.0 引入了一种使用花括号创建集合的额外方法——同样用于字典，但在这种情况下，我们没有键值对的符号。

```
# Creating sets in Python 3.x>>> x = {1, 2, 3, 4}
>>> x
{1, 2, 3, 4}
>>> type(x)
<class 'set'>
```

请注意，在 Python 3.x 中，`set()`内置函数也可用于创建集合，但是我们应该注意，与 Python 2.x 相比，显示略有不同。

```
# Creating a set in Python 3.x>>> x = set('abcdefg')
>>> x
{'b', 'd', 'g', 'a', 'c', 'f', 'e'}  # display in Python 3.x
```

注意，这里没有空集的字面语法，因此如果你想创建一个，你**必须**使用内置`set()`函数。这是因为花括号也用于字典。

```
# How to create an empty set in Python>>> x = set()
>>> x
set()
>>> type(x)
<class 'set'>
```

此外，我们不能使用花括号文字语法来创建空集。如果您尝试这样做，您将会得到一个空的字典，因为在创建类型`dict`的对象时会使用这个字面语法:

```
>>> x = {}
>>> type(x)
<class 'dict'>
```

还要注意 Python 显示一个空集为`set()`而不是`{}`，因为后者翻译成一个空字典:

```
>>> a = set()
>>> a
set()
```

## 有用的集合运算

如前所述，Python 提供了许多非常有用的集合操作。在这一节中，我将介绍几个最重要的常用工具。

**路口**

您可以使用`intersection()` set 方法或位运算符`&`计算两个集合的交集:

```
>>> a = set([1, 2, 3, 4, 5])
>>> b = set([1, 3, 6])
>>>
>>> a & b
{1, 3}
>>> 
>>> a.intersection(b)
{1, 3}
```

**工会**

两个集合的并集可以通过使用`|`位运算或`union()`集合方法进行计算:

```
>>> a = set([1, 2, 3, 4, 5])
>>> b = set([1, 3, 6])
>>>
>>> a | b
{1, 2, 3, 4, 5, 6}
>>> 
>>> a.union(b)
{1, 2, 3, 4, 5, 6}
```

**差异**

可以使用算术运算符`-`或集合方法`difference()`计算集合差:

```
>>> a = set([1, 2, 3, 4, 5])
>>> b = set([1, 3, 6])
>>>
>>> a - b
{2, 4, 5}
>>>
>>> b.difference(a)
{6}
```

**子集和超集**

此外，您还可以检查一个集合是另一个集合的超集还是子集:

```
# Check if a set is a subset of another set
>>> a = set([1, 2, 3, 4, 5])
>>> b = set([1, 3])
>>> b < a # i.e. check if b is a subset of a
True
>>> b.issubset(a)
True# Check if a set is a superset of another set
>>> a > b # i.e. check if a is a superset of b
True
>>> a.issuperset(b)
True
```

## 操纵集合

因为 Python 集合是可变的数据结构，所以知道如何添加或删除元素是很好的。

**向列表中添加元素**

```
>>> x = {1, 2, 3, 4}
>>> x.add(5)
>>> x
{1, 2, 3, 4, 5}
```

**合并两套**

```
>>> x = {1, 2, 3, 4}
>>> x.update(set([1, 5, 6]))
>>> x
{1, 2, 3, 4, 5, 6}
```

**从器械包中移除一个物品**

```
>>> x = {1, 2, 3, 4}
>>> x.remove(1)
>>> x
{2, 3, 4}
```

## 冻结集

Python 集合只能包含不可变的对象。例如，你不能在一个集合中存储一个`list`或者一个`dict`，因为这两个数据结构都是不可散列的(也就是说，它们是可变的)。另一方面，`tuple`是不可变的对象类型，可以插入到集合中。

试图在`set`中添加`list`或`dict`将导致`TypeError`:

```
>>> x = {1, 2, 3, 4}
>>> x.add([1, 3, 5, 7])
TypeError: unhashable type: 'list'
>>> x.add({"a": 1})
TypeError: unhashable type: 'dict'
```

另一方面，如果我们添加一个`tuple`，Python 解释器不会抱怨:

```
>>> x = {1, 2, 3, 4}
>>> x.add((1, 5))
>>> x
{1, 2, 3, 4, (1, 5)}
```

尽管默认情况下集合是可变的，Python 有一个不可变的版本，叫做`frozenset`。我们还没有讨论的一个用例可能是嵌套集合。使用默认集合，不可能将一个集合添加到另一个集合中，因为集合在默认情况下是可变的，并且正如我们已经讨论过的，您只能存储不可变的对象类型。如果是这种情况，那么`frozenset`可用于创建嵌套集合。

**创建一个冷冻集**

```
>>> a = frozenset([1, 2, 3])
>>> a
frozenset({1, 2, 3})
```

**将 frozenset 添加到现有集合**

```
>>> b = set([4, 5, 6])
>>> b.add(a)
>>> b
{frozenset({1, 2, 3}), 4, 5, 6}
```

## 集合理解

除了集合的花括号字面语法之外，Python 3.0 还引入了集合理解符号，它比等价的 for 循环更快。最重要的是，它被认为是一种更“pythonic 式”的编写代码的方式。

下面的示例展示了一个简单的集合理解，它循环遍历一个数字列表，向每个元素添加一个单位，并返回元素的结果集合:

```
>>> {x + 1 for x in [1, 2, 3, 4]}
{2, 3, 4, 5}
```

## 集合的实际用途

除了集合支持的数学概念之外，它还是一种非常实用的数据结构，可以用来解决相当常见的问题。在这一节中，我将介绍几个集合被证明是有用的用例。

**从列表中删除重复项**

当我们想要从列表中删除重复项时，经常使用集合。回想一下，集合是丢弃重复条目的**唯一元素**的集合。因此，当我们需要消除列表中的重复元素时，将列表转换为集合是一种非常聪明和实用的方法。

```
>>> l = [1, 2, 2, 3, 3, 4, 5]
>>> set(l)
{1, 2, 3, 4, 5}
```

**处理查询结果**

由于集合提供了支持数学集合论基本运算的功能，所以在处理来自数据库的查询结果时通常使用它们。考虑这样一个用例，您在数据库上执行了一个查询，以便检索一所大学的所有雇员，并另外执行一个查询来获取教授(让我们假设他们存储在不同的表中):

```
university_employees = {'Alice', 'Bob', 'Andrew', 'Mary', 'Ann'}
professors = {'Alice', 'Bob'}
```

现在，您可以轻松地应用集合运算来回答特定的问题。例如，让我们假设我们需要知道哪些雇员不是教授:

```
>>> not_professors = university_employees - professors
>>> not_professors
{'Ann', 'Mary', 'Andrew'}
```

## 结论

Python 集合非常强大，它们可以帮助您使代码看起来像 Python，因为它们为 Python 开发人员必须处理的常见问题提供了实用的解决方案。在本文中，只讨论了集合全部功能的一个子集。关于`set`和`frozenset`支持的方法的完整列表，你可以参考 Python 文档的[这一节](https://docs.python.org/3/library/stdtypes.html#set)。