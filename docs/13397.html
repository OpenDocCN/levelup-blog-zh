<html>
<head>
<title>Elasticsearch &amp; Kibana : security, authentication, and network encryption enabled with Docker Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Elasticsearch &amp; Kibana:通过Docker Compose实现安全性、认证和网络加密</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/elasticsearch-kibana-security-authentication-and-network-encryption-enabled-with-docker-e6747a989766?source=collection_archive---------1-----------------------#2022-09-01">https://levelup.gitconnected.com/elasticsearch-kibana-security-authentication-and-network-encryption-enabled-with-docker-e6747a989766?source=collection_archive---------1-----------------------#2022-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/334604aa846eaf67e0642e621bb3e2a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IFDTmaXjQATOpmBIcv_yXQ.png"/></div></div></figure><p id="c922" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们继续我们的势头。在上一篇文章中，我们展示了如何在禁用安全性的情况下使用Docker Compose启动Elasticsearch和Kibana。如果你还没有这样做，我建议你通过点击<a class="ae kw" href="https://medium.com/@mhdabdel151/elasticsearch-and-kibana-installation-using-docker-compose-886c4823495e" rel="noopener">这个链接</a>来看看它。今天，我们将通过启用<strong class="ka ir">安全</strong>、<strong class="ka ir">认证</strong>和<strong class="ka ir">网络加密</strong>对配置进行更深入的探讨。</p><p id="8273" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的<em class="kx"> docker-compose.yml </em>文件目前看起来像这样:</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="8c88" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有。<em class="kx"> env </em>包含这个:</p><pre class="ky kz la lb gt le lf lg lh aw li bi"><span id="f8b8" class="lj lk iq lf b gy ll lm l ln lo"># Version of Elastic products<br/>STACK_VERSION=8.4.0</span><span id="993d" class="lj lk iq lf b gy lp lm l ln lo"># Port to expose Elasticsearch HTTP API to the host<br/>ES_PORT=9200</span><span id="108d" class="lj lk iq lf b gy lp lm l ln lo"># Port to expose Kibana to the host<br/>KIBANA_PORT=5601</span></pre><p id="4829" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们将把客户机的密码添加到环境变量中。因此，添加这些具有所需值的行:</p><pre class="ky kz la lb gt le lf lg lh aw li bi"><span id="2a28" class="lj lk iq lf b gy ll lm l ln lo"># Password for our 'elastic' user<br/>ELASTIC_PASSWORD=TYPE_HERE</span><span id="fc93" class="lj lk iq lf b gy lp lm l ln lo"># Password for our 'kibana_system' user<br/>KIBANA_PASSWORD=TYPE_HERE</span><span id="326c" class="lj lk iq lf b gy lp lm l ln lo"># Set the license<br/>LICENSE=trial</span></pre><p id="7941" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当设置为<strong class="ka ir">试用</strong>时，自生成的许可证仅允许30天访问x-pack的所有功能(<em class="kx">根据本</em> <a class="ae kw" href="https://www.elastic.co/blog/security-for-elasticsearch-is-now-free" rel="noopener ugc nofollow" target="_blank"> <em class="kx">条</em> </a> <em class="kx">，在版本6.8.0和7.1.0 </em>中是免费开始)。对于与集群的任何交互，您必须利用<em class="kx"> ELASTIC_PASSWORD </em>值。<em class="kx"> KIBANA_PASSWORD </em>值仅在内部配置KIBANA时使用。</p><p id="2da0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，让我们编辑我们的<em class="kx"> docker-compose.yml </em>文件。我们希望创建一个安全的Elasticsearch集群，启用身份验证和网络加密，并安全地连接一个Kibana实例。</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="d88b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面提供的示例代码是针对单节点Elasticsearch集群的，但是通过添加一些额外的Docker容器服务并进行适当的配置，它可以被复制用于多节点集群。您可以添加脚本以在执行前检查是否提供了密码，请参考此<a class="ae kw" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html#docker-file" rel="noopener ugc nofollow" target="_blank">链接</a>了解。</p><p id="a84c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，通过运行以下命令，创建并启动Kibana实例和单节点Elasticsearch集群:</p><pre class="ky kz la lb gt le lf lg lh aw li bi"><span id="7a9f" class="lj lk iq lf b gy ll lm l ln lo">docker-compose up -d</span></pre><p id="1840" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一切似乎都正常，进入<a class="ae kw" href="http://localhost:5601" rel="noopener ugc nofollow" target="_blank"> http://localhost:5601 </a>访问Kibana，以<em class="kx"> elastic </em>用户身份登录，并填写<em class="kx">中的密码。env </em>文件(<em class="kx"> ELASTIC_PASSWORD </em>)。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lq"><img src="../Images/f9daa98573c1c3381a2a773e9f603969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-UdayB8uZzRe_JD89gEbzg.png"/></div></div></figure><p id="a12f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行<code class="fe lr ls lt lf b">docker-compose down</code>停止集群。当使用<code class="fe lr ls lt lf b">docker-compose up</code>重启集群时，Docker卷中的数据被维护和加载。停止集群时，使用<code class="fe lr ls lt lf b">-v</code>选项销毁网络、容器和卷。</p><p id="8f70" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">今天到此为止，请随意查看关于这个主题的<a class="ae kw" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html#docker-compose-file" rel="noopener ugc nofollow" target="_blank">官方文档</a>，了解更多细节和配置。感谢您的阅读，如果您对本文有任何问题或评论，请在下面留下您的评论。</p><p id="e7fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们下次再见，看更多的帖子🚀。</p><p id="2199" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">阿卜杜尔-巴吉</p></div></div>    
</body>
</html>