<html>
<head>
<title>Setup a VM for Laravel 8 with Ubuntu 20.04, PHP8, Nginx and MySql</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Ubuntu 20.04、PHP8、Nginx和MySql为Laravel 8设置一个虚拟机</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setup-a-vm-for-laravel-8-with-ubuntu-20-04-php8-nginx-and-mysql-4b709de88154?source=collection_archive---------0-----------------------#2021-02-15">https://levelup.gitconnected.com/setup-a-vm-for-laravel-8-with-ubuntu-20-04-php8-nginx-and-mysql-4b709de88154?source=collection_archive---------0-----------------------#2021-02-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/06388d38a29d6f25e430637d670cd7ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6PXc1jYO4mapPqomJXv_Jg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">为Laravel 8设置Droplet</figcaption></figure><p id="e0b3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我的目标是用Ubuntu 20.04 LTS、PHP8、Nginx和MySql建立一个GNU/Linux VM来服务Laravel 8应用程序。对于Web服务器，我将使用Nginx，所以我需要php-fpm。</p><p id="ec6b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有一些方法可以实现这一点，您可以考虑使用:</p><ul class=""><li id="a93e" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">像Forge(<a class="ae lj" href="https://forge.laravel.com/" rel="noopener ugc nofollow" target="_blank">https://forge.laravel.com/</a>)这种帮你维护服务器的软件；</li><li id="120e" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">一种无服务器的方法，使用Vapor(【https://vapor.laravel.com/】)；</li><li id="1f45" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">像数字海洋应用平台(【https://www.digitalocean.com/products/app-platform/】T4)这样的应用平台</li><li id="d3b9" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">DigitalOcean Droplets提供的一个Linux虚拟机。</li></ul><p id="fb9d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于我的辅助项目，我通常使用数字海洋液滴，因为:</p><ul class=""><li id="338a" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">这是一个“手动”的方法，但是我的一个目标是，当我在边项目上工作时，学习和理解“引擎盖下”的过程/工具/配置；</li><li id="7b7b" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">成本是可以预测的；</li><li id="ca46" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">我喜欢在我的副业上动手。</li></ul><p id="4aca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于我的工作项目，我通常选择“管理的”解决方案。</p><p id="75c7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">关于自动化的思考。我是“自动化一切”的粉丝。但在自动化流程、设置或工作流之前，我认为我们需要弄清楚幕后发生了什么。</p><h1 id="ff72" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">设置Droplet</h1><p id="bb09" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">正如我之前提到的，我将使用DigitalOcean的一滴。droplet本质上是一个带有操作系统的虚拟机，您可以在其中添加软件堆栈，以及操作系统提供的工具和应用程序。在我们的例子中，我将选择Ubuntu 20.04，所以我将使用Apt添加软件。创建Droplet时，您可以选择一些参数，如操作系统、虚拟机大小(CPU/内存)、数据中心位置等</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/b6e1267249a5a862525e2c84e2a22c0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WID3hiNXECeqVbb_mMMQFg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建一个水滴，你需要选择一些选项</figcaption></figure><p id="0580" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最便宜的配置(但性能较差):</p><ul class=""><li id="5bbc" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">选择图像:发行版Ubuntu 20.04 LTS</li><li id="17a4" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">选择计划:共享CPU基本版—每月5美元(1 GB、1个CPU、25 GB固态硬盘、1000 GB传输)</li><li id="e682" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">选择一个数据中心区域:法兰克福1(离意大利最近)，如果你想进行速度测试，你可以使用这个工具:<a class="ae lj" href="http://speedtest-fra1.digitalocean.com/" rel="noopener ugc nofollow" target="_blank">http://speedtest-fra1.digitalocean.com/</a></li><li id="b07f" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">身份验证，如果您能够上传您的公钥，您可以选择SSH密钥，否则您可以使用root用户的经典方式登录/密码。</li></ul><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/eb565622d55173c7c803c5bb393ccf30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IKCPEC8Mag92exMw0Mgj6Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">身份验证方法。我的建议是使用SSH密钥，而不是非常长的复杂密码。</figcaption></figure><p id="cf89" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">创建Droplet后，您可以看到新的IPv4地址。</p><p id="59d0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这对于访问您的新虚拟机非常重要。</p><h1 id="324b" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">你的第一次访问</h1><p id="9389" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">如果您在创建droplet时选择了ssh密钥验证方法而不是登录/密码，我建议您在您的机器中创建一个SSH别名，以便有一个快捷方式来定义“SSH”用户名、IP地址和用于访问您的虚拟机的密钥。</p><p id="2689" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这种情况下在您的<em class="my"> ~/中。ssh/config，</em>添加这些行:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="546b" class="ne lq iq na b gy nf ng l nh ni">host &lt;alias_name&gt;<br/>    HostName &lt;ip_address&gt;<br/>    User &lt;user_name&gt;<br/>    IdentityFile &lt;key_file&gt;</span></pre><p id="cfd8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">其中:</p><ul class=""><li id="f9d7" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated"><alias_name>是你要启动ssh的时候用的名字；</alias_name></li><li id="2dd3" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated"><ip_address>水滴提供的IP地址；</ip_address></li><li id="362f" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated"><user_name>用户，对于初始配置使用<em class="my">根</em>即可。在设置过程中，我们将创建一个“无根”用户；</user_name></li><li id="43c8" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated"><key_file>ssh密钥文件，在我的例子中是<em class="my"> ~/。ssh/id _ RSA _ side project _ dev</em>；</key_file></li></ul><p id="5098" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要访问您的Droplet，您可以使用ssh:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="7f77" class="ne lq iq na b gy nf ng l nh ni">ssh &lt;alias_name&gt;</span></pre><p id="0925" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第一次访问时，会提示您一个关于创建ECDSA密钥指纹的问题。选择“是”接受它。</p><p id="513d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您选择登录/密码方法而不是SSH密钥，您可以使用ssh root@ <ip_address>来访问您的虚拟机。</ip_address></p><h1 id="b448" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">升级您的系统软件包</h1><p id="dfbb" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">首先我建议你用Apt命令升级你的包(我们用的是Ubuntu所以有Apt)。第一次访问时，您使用的是“root”用户，所以现在您不需要使用sudo。</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="4fff" class="ne lq iq na b gy nf ng l nh ni">apt-get update<br/>apt-get upgrade</span></pre><p id="27ff" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我们可以开始安装所有需要的软件包:</p><ul class=""><li id="d6a8" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">Nginx</li><li id="1722" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">PHP 8 (fpm)(以及Laravel 8需要的模块)</li><li id="bd95" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">MySql 8</li></ul><p id="d74d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您正在安装一些服务，所以我的建议是也配置防火墙。</p><h1 id="e967" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">安装Nginx</h1><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="0114" class="ne lq iq na b gy nf ng l nh ni">apt-get install nginx</span></pre><p id="7d8b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">可选:如果你想托管多个域(或子域),我建议为你想用Nginx服务的每个子域创建一个目录。反正默认目录是:/var/www/html/。所以，安装nginx后你尝试去tu url http:// <ip_address>，你会看到Nginx提供的默认html文件来自/var/www/html目录。</ip_address></p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/15f0c431daf6ba866a44d700d30d48fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zSb0jWKQ0FMP0L34j2o7yw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Nginx全新安装的欢迎页面</figcaption></figure><p id="3b99" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将安装Laravel，因此我们需要将<em class="my"> public/ </em>设置为文档根。</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="d49e" class="ne lq iq na b gy nf ng l nh ni">mkdir -p /var/www/mydomain/htdocs/public</span></pre><p id="681c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这种情况下:</p><ul class=""><li id="706a" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">/var/www/mydomain/htdocs将是您的Laravel应用程序被复制到的目录；</li><li id="bbe2" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">/var/www/my domain/htdocs/public将是文档根。</li></ul><h1 id="c6f8" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">安装PHP 8</h1><p id="b937" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">我们刚刚安装了搭载PHP 7.4的Ubuntu 20.04。在安装PHP之前，我们需要添加一个存储库，以便有机会安装PHP 8。所以我们将从<em class="my"> ondrej/php </em> PPA库安装PHP。要启用回购和更新包:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="7587" class="ne lq iq na b gy nf ng l nh ni">apt install software-properties-common<br/>add-apt-repository ppa:ondrej/php<br/>apt update<br/>apt upgrade</span></pre><p id="9060" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在你可以安装PHP 8:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="9013" class="ne lq iq na b gy nf ng l nh ni">apt install php8.0-fpm</span></pre><p id="8524" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要测试您是否有PHP 8:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="519c" class="ne lq iq na b gy nf ng l nh ni">php -v</span></pre><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/893d37cdce83cc9c5217e580cd3adb36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKGmyvYeT4hZlCfiepgTIg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">你的新PHP 8</figcaption></figure><p id="283f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要检查PHP-fpm是否启动并运行:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="3cf4" class="ne lq iq na b gy nf ng l nh ni">systemctl status php8.0-fpm</span></pre><p id="d1e8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们可以为您的Laravel 8应用程序安装所有PHP依赖项了:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="49c0" class="ne lq iq na b gy nf ng l nh ni">apt-get install php8.0-mysql php8.0-mbstring php8.0-xml php8.0-bcmath</span></pre><h1 id="c110" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">配置Nginx和PHP 8 fpm</h1><p id="61b4" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">现在您使用的是根用户，这对于初始设置来说很好。我建议创建一个非特权用户来登录系统，并访问部署Laravel应用程序的目录。</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="b6de" class="ne lq iq na b gy nf ng l nh ni">adduser deploy<br/>usermod -aG www-data deploy<br/>chown -R deploy:www-data /var/www/mydomain/</span></pre><p id="1f38" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在让我们关注Nginx配置，我们可以从Nginx的默认配置开始，然后我们将对其进行自定义:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="4f88" class="ne lq iq na b gy nf ng l nh ni">cp /etc/nginx/sites-available/default /etc/nginx/sites-available/mydomain</span></pre><p id="e758" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">按照以下示例编辑新文件:</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="227d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后，您需要创建一个符号链接来激活新的配置(看看站点-可用与站点-启用):</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="b6c3" class="ne lq iq na b gy nf ng l nh ni">ln -s /etc/nginx/sites-available/mydomain /etc/nginx/sites-enabled/</span></pre><p id="82a9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您想检查配置的语法:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="973d" class="ne lq iq na b gy nf ng l nh ni">nginx -t</span></pre><p id="a0e1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要重启Nginx并加载新配置:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="4ad3" class="ne lq iq na b gy nf ng l nh ni">service nginx restart</span></pre><h1 id="11da" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">安装数据库</h1><p id="df07" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">我们将安装MySql server 8:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="3997" class="ne lq iq na b gy nf ng l nh ni">apt install mysql-server<br/>mysql_secure_installation</span></pre><p id="7d60" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这个脚本的执行过程中，它会要求您键入根数据库密码。执行完成后，尝试访问您的数据库服务器:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="0df9" class="ne lq iq na b gy nf ng l nh ni">mysql -u root -p</span></pre><p id="d4bc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">并键入新密码以访问数据库管理控制台。在数据库管理控制台中:</p><ul class=""><li id="8069" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">创建数据库<em class="my">db _ laravel 8</em>；</li><li id="f539" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">创建用户，使用密码<em class="my"> somepassword </em>访问数据库(<em class="my"> userdb </em></li><li id="31d3" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">向新用户授予适当的权限；</li></ul><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="4005" class="ne lq iq na b gy nf ng l nh ni">CREATE DATABASE db_laravel8;<br/>CREATE USER 'userdb'@'localhost' IDENTIFIED BY 'somepassword';<br/>GRANT ALL PRIVILEGES ON * . * TO 'userdb'@'localhost';<br/>FLUSH PRIVILEGES;</span></pre><h1 id="aebc" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">设置防火墙</h1><p id="9d34" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">仅打开HTTP和SSH端口:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="c51b" class="ne lq iq na b gy nf ng l nh ni">ufw allow 'Nginx HTTP'<br/>ufw allow 'OpenSSH'</span></pre><p id="f02e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">激活防火墙:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="61ce" class="ne lq iq na b gy nf ng l nh ni">ufw enable</span></pre><p id="5e9a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后检查状态:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="0224" class="ne lq iq na b gy nf ng l nh ni">ufw status</span></pre><p id="12af" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">输出应该是这样的:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="7a1f" class="ne lq iq na b gy nf ng l nh ni">Status: active<br/>To Action From<br/> — — — — — — <br/>Nginx HTTP ALLOW Anywhere<br/>OpenSSH ALLOW Anywhere<br/>Nginx HTTP (v6) ALLOW Anywhere (v6)<br/>OpenSSH (v6) ALLOW Anywhere (v6)</span></pre><h1 id="dfe0" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">设置HTTPS</h1><p id="9690" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">对于辅助项目，我通常使用<a class="ae lj" href="https://letsencrypt.org/" rel="noopener ugc nofollow" target="_blank">https://letsencrypt.org/</a>来获得证书，以启用HTTPS协议。</p><p id="5182" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">作为root用户，要安装安装证书的工具，请运行:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="2e1f" class="ne lq iq na b gy nf ng l nh ni">apt-get install certbot python3-certbot-nginx</span></pre><p id="89e3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果需要为主机名<em class="my">host.mydomain.com</em>安装证书:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="ccb1" class="ne lq iq na b gy nf ng l nh ni">certbot --nginx -d host.mydomain.com</span></pre><p id="f7fe" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">该命令还将更新Nginx配置文件(启用指令<em class="my">监听端口443上的</em>并加载刚刚创建的证书)。</p><p id="928b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您还需要打开HTTPS端口的防火墙:</p><pre class="mt mu mv mw gt mz na nb nc aw nd bi"><span id="41f9" class="ne lq iq na b gy nf ng l nh ni">ufw allow 'Nginx HTTPS'</span></pre><h1 id="5509" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">包裹</h1><p id="0f7e" class="pw-post-body-paragraph kc kd iq ke b kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ij bi translated">如果您遵循这些步骤，我们将:</p><ul class=""><li id="0599" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">用LTS的Ubuntu 20.04在数字海洋上创建了一个虚拟机</li><li id="471b" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">安装Nginx通过HTTP提供文件服务；</li><li id="20a1" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">安装了PHP8和Laravel 8需要的模块</li><li id="e65e" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">安装了MySql 8服务器；</li><li id="8b58" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">配置Nginx以服务PHP文件和一个我们可以复制Laravel文件的特定目录；</li><li id="003d" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">配置了一个非特权用户来访问虚拟机；</li><li id="0eac" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">配置一个数据库用户，并创建一个新的数据库来使用Laravel应用程序(记得更新您的。带有DB_NAME、DB_USER、DB_PASSWORD的env文件)；</li><li id="8217" class="la lb iq ke b kf lk kj ll kn lm kr ln kv lo kz lf lg lh li bi translated">设置HTTPS以服务于Laravel应用。</li></ul><p id="f9d0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，您可以在/var/www/mydomain/htdocs中部署您的应用程序。</p><p id="bf5b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">请随意留下评论和反馈，我可以改进这个教程(或者我的英语；) )</p></div></div>    
</body>
</html>