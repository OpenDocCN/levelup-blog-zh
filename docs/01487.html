<html>
<head>
<title>Formatting Relative Time with JavaScript’s RelativeTimeFormat Constructor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript的RelativeTimeFormat构造函数格式化相对时间</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/formatting-relative-time-with-javascripts-relativetimeformat-constructor-a5c584ce79a8?source=collection_archive---------10-----------------------#2020-01-06">https://levelup.gitconnected.com/formatting-relative-time-with-javascripts-relativetimeformat-constructor-a5c584ce79a8?source=collection_archive---------10-----------------------#2020-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jv jw jx jy gh gi paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="gh gi ju"><img src="../Images/2846385d5a275e4405ac3e5be784a377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MKsT5fn4727UzKuF"/></div></div><figcaption class="kf kg gj gh gi kh ki bd b be z dk translated"><a class="ae kj" href="https://unsplash.com/@agebarros?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿格巴洛斯</a>在<a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2603" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">使用<code class="fe jq jr js jt b">Intl.RelativeTimeFormat</code>构造函数，我们可以轻松地以一种区域敏感的方式格式化相对时间。我们可以用不同的方式来设计风格，用我们想要的方式来格式化它。这让我们可以格式化相对时间字符串，而没有操作字符串带来的麻烦。构造函数有两个参数。第一个参数是一个区域设置字符串或此类字符串的数组。第二个参数是一个对象，它接受各种参数来按照我们想要的方式调整相对时间字符串。这个构造函数的实例有几个返回格式化字符串的方法，格式化字符串是子字符串的数组，还有一个方法返回我们为格式化字符串设置的选项。</p><p id="ef3f" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><code class="fe jq jr js jt b">Intl.RelativeTimeFormat</code>构造函数的第一个参数是区域设置，它应该是一个<a class="ae kj" href="https://github.com/libyal/libfwnt/wiki/Language-Code-identifiers" rel="noopener ugc nofollow" target="_blank"> BCP 47语言标签</a>或者一个这样的区域设置字符串数组。这是一个可选参数。</p><p id="e4b3" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">第二个参数接受一个具有几个属性的对象— <code class="fe jq jr js jt b">localeMatcher</code>、<code class="fe jq jr js jt b">numeric</code>和<code class="fe jq jr js jt b">style</code>。</p><p id="cf56" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><code class="fe jq jr js jt b">localeMatcher</code>选项指定要使用的语言环境匹配算法。可能的值是<code class="fe jq jr js jt b">lookup</code>和<code class="fe jq jr js jt b">best fit</code>。查找算法搜索区域设置，直到找到符合正在比较的字符串的字符集的区域设置。<code class="fe jq jr js jt b">best fit</code>找到至少比<code class="fe jq jr js jt b">lookup</code>算法更适合的语言环境。</p><p id="ce4e" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><code class="fe jq jr js jt b">numeric</code>选项让我们设置如何输出格式化字符串信息的选项。可能的值有<code class="fe jq jr js jt b">always</code>，比如“2天前”，或者<code class="fe jq jr js jt b">auto</code>，比如“昨天”。<code class="fe jq jr js jt b">auto</code>允许我们不总是使用数值输出。<code class="fe jq jr js jt b">style</code>选项让我们改变国际化消息的长度。可能的值有<code class="fe jq jr js jt b">long</code>、<code class="fe jq jr js jt b">short</code>或<code class="fe jq jr js jt b">narrow</code>。<code class="fe jq jr js jt b">long</code>会输出类似“2个月内”的内容，<code class="fe jq jr js jt b">short</code>会输出类似“2个月内”的内容，而<code class="fe jq jr js jt b">narrow</code>应该是类似于“在2个月内”在某些地区，它可能类似于<code class="fe jq jr js jt b">short</code>样式。</p><figure class="lj lk ll lm gt jy gh gi paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="gh gi li"><img src="../Images/80194c78a5d9515eb64ee799f6eee45d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EbQ7hgjD-E8r7VkE"/></div></div><figcaption class="kf kg gj gh gi kh ki bd b be z dk translated">由<a class="ae kj" href="https://unsplash.com/@kaylahotto?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯拉·奥托</a>在<a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="69b3" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><code class="fe jq jr js jt b">Intl.RelativeTimeFormat</code>构造函数的实例有一些方法。它有一个<code class="fe jq jr js jt b">format</code>方法，可以根据区域设置和构造函数中给定的格式化选项来获取带值和单位的格式化相对时间字符串。<code class="fe jq jr js jt b">formatToParts</code>方法类似于<code class="fe jq jr js jt b">format</code>方法，除了格式化字符串作为数组而不是字符串返回。<code class="fe jq jr js jt b">resolvedOptions</code>方法返回一个对象，该对象带有我们在构造函数中设置的选项，用于格式化字符串和设置的区域设置。</p><p id="4e50" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><code class="fe jq jr js jt b">format</code>方法有两个参数。第一个是相对日期的数量值，第二个是字符串形式的时间单位。例如，我们可以用下面的代码中的<code class="fe jq jr js jt b">format</code>方法格式化相对日期:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="5208" class="lr ls it jt b gy lt lu l lv lw">const rtf = new Intl.RelativeTimeFormat("en", {<br/>  localeMatcher: "best fit",<br/>  numeric: "always",<br/>  style: "long",<br/>});</span><span id="6a60" class="lr ls it jt b gy lx lu l lv lw">console.log(rtf.format(-1, "day"));</span></pre><p id="a9f9" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">上面的代码将记录“1天前”，因为我们将相对日期的值指定为-1，这意味着今天之前的1天，时间单位是<code class="fe jq jr js jt b">day</code>。我们也可以放入其他单位。例如，如果我们想要分钟，那么我们得到:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="77c9" class="lr ls it jt b gy lt lu l lv lw">const rtf = new Intl.RelativeTimeFormat("en", {<br/>  localeMatcher: "best fit",<br/>  numeric: "always",<br/>  style: "long",<br/>});</span><span id="427d" class="lr ls it jt b gy lx lu l lv lw">console.log(rtf.format(-10, "minute"));</span></pre><p id="3b39" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">然后我们从<code class="fe jq jr js jt b">console.log</code>语句中得到‘10分钟前’。我们也可以改变样式和长度。例如，我们可以写:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="6077" class="lr ls it jt b gy lt lu l lv lw">const rtf = new Intl.RelativeTimeFormat("en", {<br/>  localeMatcher: "best fit",<br/>  numeric: "auto",<br/>  style: "short",<br/>});<br/>console.log(rtf.format(10, "minute"));</span></pre><p id="fac2" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">然后我们得到' 10分钟内'从<code class="fe jq jr js jt b">console.log</code>语句中，因为我们有正10而不是负10，即距离当前时间10分钟。此外，我们有<code class="fe jq jr js jt b">short</code>样式，它是单位的缩写。</p><p id="4d0b" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们还可以为不同的地区更改地区。例如，我们可以写:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="9781" class="lr ls it jt b gy lt lu l lv lw">const rtf = new Intl.RelativeTimeFormat("zh-hant", {<br/>  localeMatcher: "best fit",<br/>  numeric: "auto",<br/>  style: "long",<br/>});<br/>console.log(rtf.format(1, "minute"));</span></pre><p id="7799" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi">This gets the relative date-time string in Chinese Traditional characters instead of English. If we run the <code class="fe jq jr js jt b">console.log</code> statement in the code above, we get ‘1 分鐘後’, which means 1 minute later.</p><p id="a7da" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们可以用<code class="fe jq jr js jt b">formatToParts()</code>方法获得字符串部分数组中的格式化字符串。它返回格式化字符串的子字符串数组。例如，我们可以像下面的代码那样调用它:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="90f9" class="lr ls it jt b gy lt lu l lv lw">const rtf = new Intl.RelativeTimeFormat("en", {<br/>  localeMatcher: "best fit",<br/>  numeric: "always",<br/>  style: "long",<br/>});</span><span id="3dbb" class="lr ls it jt b gy lx lu l lv lw">const parts = rtf.formatToParts(-1, "day");<br/>console.log(parts);</span></pre><p id="6d4e" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">上面的代码会让我们:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="0ed4" class="lr ls it jt b gy lt lu l lv lw">[<br/>  {<br/>    "type": "integer",<br/>    "value": "1",<br/>    "unit": "day"<br/>  },<br/>  {<br/>    "type": "literal",<br/>    "value": " day ago"<br/>  }<br/>]</span></pre><p id="be03" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">用上面代码中的<code class="fe jq jr js jt b">console.log</code>语句。</p><p id="422f" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">这种方法同样适用于非英语地区。例如，我们可以写:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="0e29" class="lr ls it jt b gy lt lu l lv lw">const rtf = new Intl.RelativeTimeFormat("zh-hant", {<br/>  localeMatcher: "best fit",<br/>  numeric: "auto",<br/>  style: "long",<br/>});</span><span id="d768" class="lr ls it jt b gy lx lu l lv lw">const parts = rtf.formatToParts(1, "minute")<br/>console.log(parts);</span></pre><p id="b1a7" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">然后我们得到:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="041a" class="lr ls it jt b gy lt lu l lv lw">[<br/>  {<br/>    "type": "integer",<br/>    "value": "1",<br/>    "unit": "minute"<br/>  },<br/>  {<br/>    "type": "literal",<br/>    "value": " 分鐘後"<br/>  }<br/>]</span></pre><p id="7114" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">用上面代码中的<code class="fe jq jr js jt b">console.log</code>语句。</p><p id="525b" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><code class="fe jq jr js jt b">resolvedOptions()</code>方法为我们获取一个对象，该对象带有我们在构造函数中设置的选项，用于格式化字符串和设置的区域设置。我们可以在下面的代码中使用它:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="852c" class="lr ls it jt b gy lt lu l lv lw">const rtf = new Intl.RelativeTimeFormat("zh-hant", {<br/>  localeMatcher: "best fit",<br/>  numeric: "auto",<br/>  style: "long",<br/>});<br/>console.log(rtf.<!-- -->resolvedOptions<!-- -->());</span></pre><p id="d25f" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">使用上面的代码，我们从<code class="fe jq jr js jt b">console.log</code>语句中得到以下内容:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="0fb9" class="lr ls it jt b gy lt lu l lv lw">{<br/>  "locale": "zh-Hant",<br/>  "style": "long",<br/>  "numeric": "auto",<br/>  "numberingSystem": "latn"<br/>}</span></pre><p id="a473" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><code class="fe jq jr js jt b">Intl.RelativeDateFormat</code>构造函数也有一个<code class="fe jq jr js jt b">supportedLocalesOf</code>方法来获取格式化日期和时间所支持的地区。它将一组BCP 47语言环境字符串作为参数。Unicode扩展键将与区域设置代码一起返回，即使它与日期格式无关(如果提供的话)。它使用<code class="fe jq jr js jt b">localeMatcher</code>选项来指定要使用的区域匹配算法。可能的值是<code class="fe jq jr js jt b">lookup</code>和<code class="fe jq jr js jt b">best fit</code>。查找算法搜索区域设置，直到找到符合正在比较的字符串字符集的区域设置。<code class="fe jq jr js jt b">best fit</code>查找至少比<code class="fe jq jr js jt b">lookup</code>算法更适合的语言环境。</p><p id="52a5" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">例如，我们可以在下面的代码中使用它:</p><pre class="lj lk ll lm gt ln jt lo lp aw lq bi"><span id="88d1" class="lr ls it jt b gy lt lu l lv lw">const locales = ['en-ca', 'id-u-co-pinyin', 'ban'];<br/>const options = {<br/>  localeMatcher: 'lookup'<br/>};</span><span id="99a8" class="lr ls it jt b gy lx lu l lv lw">console.log(Intl.RelativeTimeFormat.supportedLocalesOf(locales, options));</span></pre><p id="5cbf" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">然后我们得到<code class="fe jq jr js jt b">[“en-CA”, “id-u-co-pinyin”]</code>。这是因为巴厘语与印尼语非常相似，对于<code class="fe jq jr js jt b">lookup</code>算法来说是相同的。请注意，输入数组中的Unicode扩展会随输出一起返回，即使它与上下文无关。</p><p id="52fa" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">JavaScript <code class="fe jq jr js jt b">Intl.RelativeTimeFormat</code>构造函数让我们能够轻松地以一种区域敏感的方式格式化相对时间。我们可以用不同的方式来设计风格，用我们想要的方式来格式化它。这让我们可以格式化相对时间字符串，而没有操作字符串带来的麻烦。构造函数有两个参数。第一个参数是区域设置字符串或此类字符串的数组。第二个是一个对象，它接受各种参数来按照我们想要的方式调整相对时间字符串。这个构造函数的实例有几个返回格式化字符串的方法，格式化字符串是子字符串的数组，还有一个方法返回我们为格式化字符串设置的选项。我们还可以检查支持静态<code class="fe jq jr js jt b">supportedLocalesOf</code>方法的地区。</p></div></div>    
</body>
</html>