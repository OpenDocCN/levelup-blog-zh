<html>
<head>
<title>All you need to know about automated API tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于自动化API测试，您需要知道的是</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/automated-api-tests-39f5a25f4eae?source=collection_archive---------12-----------------------#2020-04-02">https://levelup.gitconnected.com/automated-api-tests-39f5a25f4eae?source=collection_archive---------12-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="3ad6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">API正日益成为当今应用程序开发的中心。作为web组件之间的主要通信模式，它们用于跨系统连接和传输数据和业务逻辑。</p><p id="0e64" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这意味着彻底的API测试可以提高软件的质量，并在生产之前将重大的安全风险降至最低。</p><p id="64ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是在深入了解自动化API测试的更多细节之前，我们先回顾一下API测试。</p><p id="a1fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想连接、管理或找到数千个API，你可以利用<a class="ae ko" href="https://rapidapi.com/" rel="noopener ugc nofollow" target="_blank"> API市场</a>来轻松开始集成。</p><h1 id="2d52" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">什么是API测试？</h1><p id="cb50" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">API测试是一种直接在API上执行的软件测试，用于验证它是否满足预期的功能、安全性、可靠性和性能要求。它通常在不加载或不与用户界面交互的情况下测试API，而是通过向API后端发起直接请求。</p><p id="a294" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如下图所示，API测试是在<a class="ae ko" href="https://en.wikipedia.org/wiki/Business_logic#Business_logic_layer" rel="noopener ugc nofollow" target="_blank">业务层</a>完成的GUI和数据库层之间的所有逻辑操作和事务都发生在这里。它对软件质量至关重要，因为它在短时间内验证了构建中的逻辑。</p><p id="a7ca" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与<a class="ae ko" href="https://en.wikipedia.org/wiki/Graphical_user_interface_testing" rel="noopener ugc nofollow" target="_blank"> GUI测试</a>不同，API测试可以应对更短的发布周期和常规变化</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/889b404e1de8ab79b1f00475b66ea445.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/0*iGd1DZG0JW4ePuFI.png"/></div></figure><h1 id="a4b2" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">你可以测试什么类型的API？</h1><p id="6e1d" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">API已经发展了多年——从允许应用程序在同一台设备上运行代码的简单代码库，到允许在一台设备上运行的应用程序调用托管在另一台设备上的代码的远程API。</p><p id="1876" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在选择API测试自动化工具时，理解您正在使用的API技术以及如何以最佳方式测试它是很重要的。最常见的web服务API包括</p><ul class=""><li id="f6b4" class="ma mb it js b jt ju jx jy kb mc kf md kj me kn mf mg mh mi bi translated"><a class="ae ko" href="https://en.wikipedia.org/wiki/SOAP" rel="noopener ugc nofollow" target="_blank"> SOAP </a>(简单对象访问协议)</li><li id="1fdb" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated"><a class="ae ko" href="https://en.wikipedia.org/wiki/Representational_state_transfer" rel="noopener ugc nofollow" target="_blank">休息</a>(具象状态转移)</li><li id="6bba" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated"><a class="ae ko" href="https://www.oreilly.com/library/view/programming-web-services/0596001193/ch01.html" rel="noopener ugc nofollow" target="_blank"> XML-RPC </a>(可扩展标记语言——远程过程调用)</li><li id="7f36" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated"><a class="ae ko" href="https://en.wikipedia.org/wiki/JSON-RPC" rel="noopener ugc nofollow" target="_blank"> JSON-RPC </a> (JavaScript对象符号-远程过程调用)</li></ul><h1 id="0c3e" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">自动化API测试的需求</h1><p id="c2aa" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">API测试可以提高整个测试套件的效率。在高层次上，API测试帮助开发人员验证解决方案，维护解决方案，并消除错误。</p><p id="c473" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是，如果没有彻底执行，问题可能会在产生后很久才出现。这可能会迫使开发团队停止当前的冲刺周期，并返回去寻找哪里出错了。</p><p id="a3fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在测试周期的后期发现bug可能会阻碍开发过程，从长远来看，这证明是昂贵的。通过设置自动化API测试，您可以:</p><ul class=""><li id="cd4f" class="ma mb it js b jt ju jx jy kb mc kf md kj me kn mf mg mh mi bi translated">确保所有服务都按预期运行</li><li id="ecb7" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">确认是否所有端点都是安全的，不会受到未经授权和未经身份验证的用户的攻击</li><li id="8579" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">提高功能和非功能测试的覆盖率</li><li id="f85b" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">允许及时向开发团队反馈，最终更快地发布产品</li><li id="faec" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">从AWS Lambda到您的本地设备，测试所有应用程序端点，无论它们托管在哪里。</li></ul><p id="da3b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">API测试允许您验证web服务API中的四个主要操作，即GET、POST、PUT和DELETE方法。</p><p id="c7b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是一个示例片段，它使用java <a class="ae ko" href="http://rest-assured.io/" rel="noopener ugc nofollow" target="_blank">放心库</a>验证从服务器收到的JSON响应</p><p id="fd2e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设回答是这样的:</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/c0efe33f289c071499883393a0988cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/0*jR_70MoC4LvX-uF2.png"/></div></figure><p id="bfdc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以放心地验证响应。在这种情况下，一个简单的测试是:</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/10b85a6e80b24964807a64e01968a3ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/0*RWGjVdSzBNY-wlO_.png"/></div></figure><p id="dee5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从上面的代码片段来看，函数validateDataOnResponse()调用API端点/数据？id=254，我们收到一个JSON格式的响应。</p><p id="8d24" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该测试还验证statusCode为200，并断言响应在其主体中包含名称“Tom”</p><h1 id="136f" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">您可以自动化哪些类型的API测试？</h1><p id="8527" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">您可以在API上执行不同类型的测试。虽然测试的范围因API而异，但大多数测试都属于以下类别之一:</p><ul class=""><li id="fe31" class="ma mb it js b jt ju jx jy kb mc kf md kj me kn mf mg mh mi bi translated">功能测试——它侧重于测试应用程序代码库中的特定功能。目的是确保API函数在预期的参数范围内，如果不在，错误会得到适当的处理。理想情况下，这将包括验证HTTP响应代码、错误代码和响应的测试用例。</li><li id="117f" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">负载测试——这种类型的测试是为了测试一个特定的单元或者整个代码库可以支持多少负载。对于处理大量数据或多个用户的应用程序来说，这尤其必要。<br/>为了确保峰值性能，您需要确定API是否能够实际支持预期的负载，无论是500个请求，5K个请求，50k个请求，甚至100k个请求。</li><li id="302c" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">安全性测试——安全性测试至关重要，因为它有助于确保您的API实现不会受到漏洞的影响。因此，开发人员应该确保他们的API测试用例包括验证授权、加密机制、访问控制、会话管理等的检查。<br/>API安全验证和审计过程还包括<a class="ae ko" href="https://owasp.org/www-community/Fuzzing" rel="noopener ugc nofollow" target="_blank">模糊测试</a>和<a class="ae ko" href="https://blog.securelayer7.net/api-penetration-testing-with-owasp-2017-test-cases/" rel="noopener ugc nofollow" target="_blank">渗透测试</a>，两者都确保你的API免受外部漏洞的攻击</li><li id="d901" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">验证测试API实现中最后但非常重要的测试之一。<br/>它验证产品开发、API行为和整体效率的重要方面。<br/>这种类型的测试用于验证API的开发和实现是否符合约定的标准以及用户的需求和要求。</li><li id="ff4c" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">运行时/错误检测——与上面的测试不同，上面的测试主要关注在特定场景中实现API的结果，这种类型的测试关注的是API如何运行。</li><li id="ca9b" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">这包括监视代码实现、执行、错误检测和资源泄漏中的异常。</li></ul><h1 id="32fd" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">API的测试策略</h1><p id="77b2" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">自动化测试的最佳实践之一，不仅仅是对API，是配置你的测试套件来提供一个输出，这样你就不必观察系统的响应。<br/>自动化API测试可以根据输入条件返回这三个输出中的任何一个:</p><ul class=""><li id="33a4" class="ma mb it js b jt ju jx jy kb mc kf md kj me kn mf mg mh mi bi translated">布尔状态-通过或失败</li><li id="55cf" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">任何类型的数据或信息</li><li id="a693" class="ma mb it js b jt mj jx mk kb ml kf mm kj mn kn mf mg mh mi bi translated">对其他API函数或事件的调用</li></ul><p id="ec54" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在直接测试API时，指定具体的通过或失败场景有些困难。</p><p id="f643" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有些情况下可能没有输出或发生不可预知的事情。然而，通过比较测试后的响应数据或调用另一个API后的行为，测试人员可以为他们的测试创建明确的验证场景。</p><p id="f1fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">执行全面而严格的API测试是验证您的应用程序自始至终运行良好的可靠方法。</p><p id="d56b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，为了确保代码更改不会破坏您的API并保证生产中的成功，请考虑将自动化API测试集成到您的CI/CD管道中。</p></div></div>    
</body>
</html>