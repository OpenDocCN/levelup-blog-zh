<html>
<head>
<title>The Mystery of the Changing Favicon</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">变化中的Favicon之谜</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-mystery-of-the-changing-favicon-33628b485392?source=collection_archive---------4-----------------------#2022-01-25">https://levelup.gitconnected.com/the-mystery-of-the-changing-favicon-33628b485392?source=collection_archive---------4-----------------------#2022-01-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/22f88c28b2cdfa5b72d6d3e78a3d0c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VShYNqsR0vgkcvHD-Fs2wA.png"/></div></div></figure><div class=""/><div class=""><h2 id="5a68" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">一个favicon的问题如何突出了一个浏览器的错误(或者可能是一个功能)</h2></div><p id="e22d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">昨天在工作中，另一名开发人员向我提出了一个问题。对话是这样进行的(带有一些艺术许可):</p><p id="80b9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="lp">戴夫</em>:嘿，阿尔瓦罗！我们有麻烦了。<br/>T5】我:什么事？<br/> <em class="lp"> Dev </em>:网站上的favicon是错的。这不是公司的标志。<br/> <em class="lp">我</em>:什么？<br/> <em class="lp"> Dev </em>:是。这不是我们的标志…这是你的名字！<br/> <em class="lp">我</em>:什么？？？？<br/><em class="lp">Dev</em>:*显示屏幕*<br/><em class="lp">Me</em>:…<br/><em class="lp">Dev</em>:…<br/><em class="lp">Me</em>:哦，****！</p><p id="6558" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">一清二楚，但我不敢相信自己的眼睛:这是我们的网站，标题是正确的，只是标签上显示的favicon没有公司的标志，而是字母“Alv”(来自阿尔瓦罗？)我刷新了又刷新，心想也许是什么恶作剧。但事实并非如此。</p><blockquote class="lq lr ls"><p id="b9e2" class="kt ku lp kv b kw kx kf ky kz la ki lb lt ld le lf lu lh li lj lv ll lm ln lo im bi translated"><em class="je">注:为了避免问题，我删除了网站名称和徽标的截图。在文章的底部有一个小例子来重现通用图标的问题。</em></p></blockquote><p id="a525" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">令人困惑的是:<strong class="kv jf">根据浏览器的不同，图标的工作方式也不同。Chrome和Safari显示了正确的favicon </strong>(带有公司标志)<strong class="kv jf">，而Firefox显示了完全不同的标志</strong>(带有一些字母。)并且我们仔细检查了文件是相同的，而不是旧的缓存版本。这是完全相同的文件…但它是不同的。</p><p id="9dfb" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">幸运的是，只花了几分钟就弄清楚发生了什么(并解决了问题。)但我必须承认，这是我最近见过的最奇怪的问题之一。</p><p id="7b9f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们下载了favicon.ico文件，并在图像编辑器中打开了它，然后我们看到了问题的根本原因:</p><figure class="lx ly lz ma gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lw"><img src="../Images/b47367f6df9ceb2a736902ada068d2c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OLagjnfN3cwOweki.jpeg"/></div></div></figure><p id="4c5a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">的。ico文件中有多个层(或图标)。顶层(第一个图标)是Chrome和Safari显示的，底层(最后一个图标)是Firefox显示的。</p><p id="6903" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们甚至进行了一项测试来验证这一点。我们交换了图层的顺序，保存了文件……所有浏览器中的图标都变了！现在Chrome有了Alv图标(顶层),而Firefox有了公司标志(底层)。)</p><p id="746c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">浏览器忽略了透明胶片。这个问题不是堆叠层的问题，而是包含多个图标的. ico文件，而浏览器选择了一个(且仅一个)图标。正如Bramus在Twitter上建议的那样:</p><figure class="lx ly lz ma gt iv"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="48d6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">找出错误的原因后，解决方法变得简单了:<strong class="kv jf">从。ico文件并保存</strong>。问题(和谜团)解决了。</p><p id="149f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但为什么是字母“Alv”？最初，我们用一个虚拟图标进行测试。当我们得到公司的标志时，我们把它放在图像编辑器上面的一个层中，并隐藏了测试层。但是<strong class="kv jf">即使图层被隐藏，当我们保存时，它仍然被导出</strong>作为图标的一部分！</p><p id="9d79" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我不知道我们是否可以将Firefox的行为视为bug或功能。但这变成了一个有趣的谜题。</p><h1 id="7380" class="me mf je bd mg mh mi mj mk ml mm mn mo kk mp kl mq kn mr ko ms kq mt kr mu mv bi translated">重现问题</h1><p id="ffd5" class="pw-post-body-paragraph kt ku je kv b kw mw kf ky kz mx ki lb lc my le lf lg mz li lj lk na lm ln lo im bi translated">当地看到了什么问题？在你的计算机上创建一个这样的HTML文件(简单的东西，你甚至不需要<code class="fe nb nc nd ne b">&lt;body&gt;</code>的内容):</p><pre class="lx ly lz ma gt nf ne ng bn nh ni bi"><span id="1591" class="nj mf je ne b be nk nl l nm nn">&lt;!doctype html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Favicon test&lt;/title&gt;<br/>    &lt;link rel="icon" href="./favicon.ico" /&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;h1&gt;favicon test&lt;/h1&gt;<br/>    &lt;p&gt;The favicon has two layers and it is <br/>    displayed differently by the browsers.&lt;/p&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ffc2" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">然后创建一个favicon.ico文件，里面有两个图层/图标。我用GIMP创建了这个文件，添加了两个64x64的图层，如下所示:</p><blockquote class="lq lr ls"><p id="ca3f" class="kt ku lp kv b kw kx kf ky kz la ki lb lt ld le lf lu lh li lj lv ll lm ln lo im bi translated">注意:如果你手边没有图像编辑器，你可以从我的网站下载一个<a class="ae mb" href="https://alvaromontoro.com/images/blog/favicon.ico" rel="noopener ugc nofollow" target="_blank">版本的favicon.ico </a>。</p></blockquote><figure class="lx ly lz ma gt iv gh gi paragraph-image"><div class="gh gi no"><img src="../Images/4a2586831b650ddf7b803c9591c069b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:128/format:webp/0*lmWxAiexF1dACsSk.png"/></div></figure><figure class="lx ly lz ma gt iv gh gi paragraph-image"><div class="gh gi no"><img src="../Images/66d5888a35fdaeef8fd2c477b9aea35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:128/format:webp/0*iB5F6dKp5zpFNzQH.png"/></div></figure><p id="5ffd" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">然后保存为. ico，放在与HTML文件相同的文件夹中。就是这样。你的演示已经可以测试了。在Chrome上打开页面，标签会是这样的:</p><figure class="lx ly lz ma gt iv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/57ef3a54ebc93d5493d6cc17f5b61cc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/0*SZYPL1vhqXd-E_dc.png"/></div></figure><p id="2498" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在Firefox中打开时，标签看起来会有所不同:</p><figure class="lx ly lz ma gt iv gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7748f4c80d8b5b4b2fc270fe6fa3af9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/0*iBEvy9UDiQ44RMIN.png"/></div></figure><p id="35ea" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">你可以给图标添加更多的层，但结果始终是一样的:Chrome和Safari会选择最上面的一层显示为favicon，Firefox会选择最后一层。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="2aa5" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="lp">原载于2022年1月25日https://alvaromontoro.com</em><em class="lp"/><a class="ae mb" href="https://alvaromontoro.com/blog/67996/the-mystery-of-the-changing-favicon" rel="noopener ugc nofollow" target="_blank"><em class="lp">。</em></a></p></div></div>    
</body>
</html>