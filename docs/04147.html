<html>
<head>
<title>Diving into sandbox-captured malware data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入沙盒捕获的恶意软件数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/diving-into-sandbox-captured-malware-data-d0bb10a5bfd9?source=collection_archive---------17-----------------------#2020-06-11">https://levelup.gitconnected.com/diving-into-sandbox-captured-malware-data-d0bb10a5bfd9?source=collection_archive---------17-----------------------#2020-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="02ff" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在所有正确的地方寻找恶意软件(使用正确的工具！)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2b87dcd86b8691c0eefa360998ec5cda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5e9q0ByaHaR8BzktGutTuA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">NotPetya截图来自<a class="ae ky" href="https://mcfp.felk.cvut.cz/publicDatasets/CTU-Malware-Capture-Botnet-289-1/" rel="noopener ugc nofollow" target="_blank">CTU-恶意软件-捕获-僵尸网络-289–1</a></figcaption></figure><p id="4118" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我敢肯定，在某个时候，你已经收到了来自某个实体的报告或警报——US-CERT、DHS、Twitter上转发安全研究员或反病毒公司的人，甚至可能是你的银行或信用合作社？—关于特定的威胁参与者以及他们可能对您组织的网络使用的恶意软件。你知道，就像上面截图里的恶意软件。</p><p id="2a02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想了解恶意软件的工作原理，以便做好应对准备，您会怎么做？</p><p id="09a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我给你一个免费的软件工具来帮助你搜索成百上千的网络数据包以找到关于特定恶意软件的信息，会有帮助吗？</p><p id="387c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你读完这篇文章的时候，你可以拥有一个工具，并且知道如何使用它来获取网络数据包捕获文件！</p><h2 id="88c8" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">循环从这里开始…</h2><p id="2990" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当一些恶意行为者损害了您的信息系统的<em class="mt">完整性</em>和<em class="mt">保密性</em>(进而损害了其中的信息)时，您需要采取行动。</p><p id="812e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们假设目前你做了你所知道的一切来防止这种事情发生，但是你仍然受到了威胁。</p><p id="1733" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望你<em class="mt">发现了</em>妥协。但也有可能是其他受到类似危害的人通知了您这次危害，但可能是联邦调查局或DHS通知了您，或者可能是世界上许多计算机紧急响应小组(CERT)或计算机安全事件响应小组(CSIRT)组织中的一员。他们很可能以简单的<em class="mt">可观察指标</em>或更复杂的<a class="ae ky" href="https://threatpost.com/misunderstanding-indicators-of-compromise/117560/" rel="noopener ugc nofollow" target="_blank"> <em class="mt">危害指标</em> (IOCs) </a>的形式向您提供信息。甚至国家安全局也发布了<a class="ae ky" href="https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf" rel="noopener ugc nofollow" target="_blank">带有可观察物和IOC的公告</a>来帮助理解广泛的重大入侵活动！</p><p id="08cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你需要两种基本类型的信息，每一种都在因果的虚拟链条中相互关联和联系，来处理妥协。</p><ol class=""><li id="2924" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">第一类是<em class="mt">基于主机的</em>信息，与文件系统中的程序、执行这些程序的进程、网络连接、注册表项等持久性机制相关联。这是关于你的计算机内部正在发生什么的信息。</li><li id="5ae6" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">第二种是基于网络的信息，它与计算机进程间的数据流相关联，包裹在数据包中，将数据从一台计算机路由到另一台计算机，请求查找有关计算机的信息，等等。这是关于你的计算机<em class="mt">之外发生的事情的信息</em>在他们和互联网上的其他计算机之间的网络上(有些是良性的，有些是恶意的。)</li></ol><p id="4d11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些信息不仅让您能够<em class="mt">响应</em>和<em class="mt">恢复对您系统的</em>控制，还能帮助您调整您的保护防御和检测能力，因为您现在知道可能会发生什么。然而，这是一个无尽的循环，你无法避免。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/af17e3e98f0e28808733ec7b405a8726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*_kLuzttS_eISO0bMwbpa-g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图3–1。事故响应生命周期(来源:<a class="ae ky" href="https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf" rel="noopener ugc nofollow" target="_blank">NIST sp 800–61 R2</a>)</figcaption></figure><h2 id="35c7" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">获得主机和网络信息的访问权限，为入侵做准备</h2><p id="a26a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">但是，如果您还没有受到威胁，并且想要主动了解特定恶意软件工具的工作原理，以便在它被用来对付您的情况下做好准备，该怎么办呢？你如何以及从哪里获得你需要的信息？</p><p id="137f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我第一次接触计算机和网络取证时，我很幸运。</p><p id="e9dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在<code class="fe nj nk nl nm b">$DAYJOB</code>有一个操作角色，使我能够监控跨企业边界的网络流量，管理网络上被入侵系统的人通常<em class="mt">非常乐意</em>拿出计算机硬盘，交给我分析(并向他们报告如何清理和防止未来的入侵)。</p><p id="6170" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我职业生涯的早期，我发表了一系列文章，帮助其他人获得我刚刚描述的信息，以便更好地保护、检测、响应和恢复。</p><p id="beff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这包括一份关于<a class="ae ky" href="https://web.archive.org/web/20000816092648/http://staff.washington.edu/dittrich/misc/sniffers/" rel="noopener ugc nofollow" target="_blank">网络嗅探器</a>的报告，一份关于<a class="ae ky" href="https://web.archive.org/web/20000816092639/http://staff.washington.edu/dittrich/R870/reacting.html" rel="noopener ugc nofollow" target="_blank">响应可疑入侵</a>的指南，遵循我收集的<a class="ae ky" href="https://web.archive.org/web/20000303125927/http://staff.washington.edu/dittrich/R870/security-checklist.html" rel="noopener ugc nofollow" target="_blank">综合安全清单</a>，一种用于<a class="ae ky" href="https://web.archive.org/web/20010304040516/http://staff.washington.edu/dittrich/misc/faqs/incidentcosts.faq" rel="noopener ugc nofollow" target="_blank">计算计算机安全事件损害的方法</a>，关于新生磁盘取证分析工具的首批详细指南之一(后来成为Unix系统取证分析的<a class="ae ky" href="https://web.archive.org/web/20010124095100/http://staff.washington.edu/dittrich/misc/forensics/" rel="noopener ugc nofollow" target="_blank">基本步骤</a>，许多第一批公开的DDoS工具分析(<a class="ae ky" href="https://web.archive.org/web/20000815075728/http://staff.washington.edu/dittrich/misc/trinoo.analysis" rel="noopener ugc nofollow" target="_blank"> trinoo </a>， <a class="ae ky" href="https://web.archive.org/web/20000229182625/http://staff.washington.edu/dittrich/misc/tfn.analysis" rel="noopener ugc nofollow" target="_blank">部落洪水网</a>、<a class="ae ky" href="https://web.archive.org/web/20000229173628/http://staff.washington.edu/dittrich/misc/stacheldraht.analysis" rel="noopener ugc nofollow" target="_blank"> stacheldraht </a>、<a class="ae ky" href="https://www.usenix.org/legacy/publications/library/proceedings/lisa2000/full_papers/dietrich/dietrich_html/index.html" rel="noopener ugc nofollow" target="_blank"> Shaft </a>、<a class="ae ky" href="https://web.archive.org/web/20000816021407/http://staff.washington.edu/dittrich/misc/mstream.analysis.txt" rel="noopener ugc nofollow" target="_blank"> mstream </a>)，我维护了<a class="ae ky" href="https://web.archive.org/web/20130705151616/https://staff.washington.edu/dittrich/misc/ddos/" rel="noopener ugc nofollow" target="_blank">分布式拒绝服务工具</a>最全的网页。</p><p id="d49b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些出版物大多涉及对硬盘内容、逆向工程恶意软件和网络数据包捕获的分析，采用<a class="ae ky" href="https://wiki.wireshark.org/Development/LibpcapFileFormat" rel="noopener ugc nofollow" target="_blank"> PCAP格式</a>。我维护了一个<a class="ae ky" href="https://davedittrich.github.io/network.html" rel="noopener ugc nofollow" target="_blank">网络分析工具列表，并指导</a>进行分析，这样任何人(甚至是你！)可以重复我所做的。</p><p id="7603" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我能分享的信息是有限的。</p><p id="69d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于许多法律和道德原因，我不能发布网络数据包捕获或硬盘副本，这是我加入<a class="ae ky" href="https://medium.com/swlh/tales-from-the-crypt-3-ca8801b9f725" rel="noopener">蜜网项目</a>的动力之一，在那里我们发布了许多<a class="ae ky" href="https://www.honeynet.org/challenges/" rel="noopener ugc nofollow" target="_blank">挑战</a>，其中包括蜜罐硬盘的位映像副本、数据包捕获、恶意软件工件等。供人分析。这些都是<em class="mt">仍然</em>有价值和经常使用的资源。</p><p id="551a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有直接安全操作角色或关系的研究人员，以及学习成为恶意软件分析师的学生，需要访问与互联网连接网络上的<em class="mt">真实</em>恶意软件相关联的<em class="mt">真实</em>数据，以便对其进行研究并锻炼他们的分析技能。</p><p id="224d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然可以设置蜜罐来收集此类数据，但设置蜜罐并不像看起来那么容易。获取此类数据的一种更简单的方法是从已经建立了蜜罐或恶意软件分析“沙箱”环境并向公众提供数据的人那里获取。</p><p id="f228" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这导致研究人员和学生从像蜜网项目这样的组织中寻找数据，但是也有其他来源！</p><h2 id="2ee4" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">CTU恶意软件捕获设施</h2><p id="a642" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">捷克布拉格的CVUT大学是世界上少数几所运营复杂的恶意软件分析捕获基础设施并提供发布此类数据服务的大学之一。</p><div class="nn no gp gr np nq"><a href="https://mcfp.weebly.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">恶意软件捕获设施项目</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">恶意软件捕获设施项目是捷克技术大学ATG小组为捕获…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">mcfp.weebly.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div><p id="64ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mt"> CTU恶意软件捕获工具</em>使用一个由同温层IPS和Avast部分支持的仪表化沙盒环境，从恶意软件、手动执行的“攻击”和正常(即非恶意)系统操作中生成数据集。一些数据集被额外标记，以便在训练期间帮助机器学习算法。其他的是相对基本和原始的(但都包括恶意软件样本和PCAP数据包捕获文件。)</p><div class="nn no gp gr np nq"><a href="https://www.stratosphereips.org/datasets-overview" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">数据集概述—同温层IPS</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">同温层IPS利用从真实恶意软件流量样本中创建的模型为自己提供信息。通过使用和研究恶意软件在现实中的表现，我们确保我们创建的模型和我们对性能的测量是真实的。我们的姐妹项目，恶意软件捕获设施项目…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">www.stratosphereips.org</p></div></div><div class="nz l"><div class="of l ob oc od nz oe ks nq"/></div></div></a></div><p id="65e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2018年12月，他们的<a class="ae ky" href="https://www.stratosphereips.org/aposemat" rel="noopener ugc nofollow" target="_blank"> Aposemat物联网项目</a>开始制作物联网专用数据集——包括Mirai未来组合和CoinMiner等恶意软件——这些数据集也包含在同温层IPS网站上。</p><p id="0d23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总之，CTU数据集集合包括<em class="mt">超过360个个体捕获</em>！</p><p id="c8f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些被很好地注释、标记，并且包括来自多个分析工具的输出。其他的很少，但都包括至少原始的PCAP捕获。恶意软件捕获工具已经运行了许多年，并且显然在不断发展其收集基础设施和处理。</p><p id="235c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要找到您特定的研究或教育所需的数据，可能需要花费一些努力来搜索、挖掘许多级别的web服务器目录结构，以及争论许多浏览器标签。</p><p id="6e56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如Raymond Hettinger喜欢说的，“有了<em class="mt">就有了</em>更好的方式！”所以我写了一个。；)</p><h2 id="ee71" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">从命令行访问CTU数据集</h2><p id="dbde" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">不久前，我有一个客户项目，需要网络数据包捕获和恶意软件工件(包括系统事件日志)来运行“大数据”工具。我向命令行界面(CLI)添加了一些子命令，我使用匿名的LANL <a class="ae ky" href="https://csr.lanl.gov/data/2017.html" rel="noopener ugc nofollow" target="_blank">统一主机和网络数据集</a>的子集进行研究和原型开发。</p><p id="f408" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，我需要非匿名化的数据来适当地审查结果，并找到了CTU数据集集合的方法。它包含了一些我想使用的有代表性的代理C&amp;C恶意软件，所以我写了我的第一个Python异步代码来高效地(并且温和地！)抓取网页以缓存它们的元数据，以便于搜索、检索和处理。</p><p id="4df6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">后来，我的另一个客户需要恶意软件和相关数据来模拟事件响应/安全运营中心分析和报告，这与我为<a class="ae ky" href="http://www.all.net/journal/deception/www.honeynet.org/project.honeynet.org/challenge/results/index.html" rel="noopener ugc nofollow" target="_blank">蜜网项目取证挑战</a>执行的参考分析一致。CTU数据集再次包含了我需要的东西，我的工具帮助我快速移动。</p><p id="05ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我拉出子命令，并启动了一个新的CLI，旨在用于为我在2019年共同创立的一家初创企业制作商业产品和服务的原型。我把这个程序命名为<code class="fe nj nk nl nm b">lim</code>(我们公司名字的简称，利民信息公司)。</p><p id="4693" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在2020年1月，一种新型冠状病毒在世界各地蔓延，我和我的搭档发现自己身处美国两个最初的SARS-COV-2病毒社区传播热点(华盛顿州的金县和加利福尼亚州的圣克拉拉县)。我们的小说业务陷入了人工昏迷，其创始人被隔离在“呆在家里”的命令下，前途未卜。😷</p><p id="e2d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有什么更好的时机来发布这款工具，演示如何使用它，<br/>并看看它的发展方向？:)</p><h2 id="02a1" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">我们去打猎吧！</h2><p id="6dce" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">为了演示如何使用<code class="fe nj nk nl nm b">lim</code>来探索恶意软件和相关元数据，让我们寻找一个在2018-2019年期间足够广泛出现的著名恶意软件家族，以接收官方的美国证书<a class="ae ky" href="https://www.us-cert.gov/ncas/alerts/TA18-201A" rel="noopener ugc nofollow" target="_blank">警报(TA18–201 a)</a>，即<em class="mt"> Emotet </em>。</p><blockquote class="og oh oi"><p id="c5f1" class="kz la mt lb b lc ld ju le lf lg jx lh oj lj lk ll ok ln lo lp ol lr ls lt lu im bi translated">Emotet是一种高级的模块化银行特洛伊木马，主要用作其他银行特洛伊木马的下载程序或下载程序。Emotet仍然是影响州、地方、部落和地区(SLTT)政府以及私营和公共部门的最昂贵和最具破坏性的恶意软件之一。</p><p id="209c" class="kz la mt lb b lc ld ju le lf lg jx lh oj lj lk ll ok ln lo lp ol lr ls lt lu im bi translated">[…] Emotet是[多态的，意味着它]可以逃避典型的基于签名的检测。它有几种维护持久性的方法，包括自动启动注册表项和服务。它使用模块化动态链接库(dll)来不断发展和更新其功能。此外，Emotet支持虚拟机，如果在虚拟环境中运行，可能会生成错误的指示器。</p></blockquote><p id="c5b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，Emotet主要被视为多阶段入侵序列中的第一阶段。他们提到的“垃圾邮件”通常是一种精心起草的消息，以保证收件人(a)会打开该消息(从而使他们的计算机受到感染),以及(b)不愿意——即使他们注意到任何奇怪的事情——向任何可以阻止入侵的人报告潜在的问题。</p><p id="9b57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些精心制作的消息在<a class="ae ky" href="https://www.dragos.com/wp-content/uploads/The-ICS-Threat-Landscape.pdf" rel="noopener ugc nofollow" target="_blank"> Dragos Security 2019年回顾</a>报告中有所描述，该报告还提到他们看到了Emotet部署的两个特定的二级下载:</p><blockquote class="og oh oi"><p id="02e8" class="kz la mt lb b lc ld ju le lf lg jx lh oj lj lk ll ok ln lo lp ol lr ls lt lu im bi translated">Emotet于2018年底首次出现，感染了多个ICS相关实体。在整个2019年，它继续影响企业，在夏季有短暂的下降。Emotet是一种常见的模块化特洛伊木马，部署了<strong class="lb iu"> Trickbot </strong>和<strong class="lb iu"> Ryuk </strong>恶意软件。<br/> — <a class="ae ky" href="https://www.dragos.com/wp-content/uploads/The-ICS-Threat-Landscape.pdf" rel="noopener ugc nofollow" target="_blank"> Dragos Security 2019年度回顾</a></p></blockquote><p id="65b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看是否可以在CTU数据集场景的描述中找到任何包含“emotet”、“ryuk”或“trickbot”的场景。</p><p id="8190" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一次运行其中一个<code class="fe nj nk nl nm b">lim ctu</code>子命令时，它会抓取网站一次并缓存结果。这只需要几秒钟。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/0b452038673abb784c75ade3d6b02fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prm_SjtYfSzmEuOh8XuLXA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">按组获取场景计数</figcaption></figure><p id="f569" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以在场景描述中搜索“emotet ”(为了节省屏幕空间，只显示前三列。)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/fa34206d245c36fb588b89e07b4f8fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7DjjG6SPUxfHJAbyU1PhiA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">列出按描述内容过滤的场景</figcaption></figure><p id="c368" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对“ryuk”做同样的操作没有显示结果，但是对“trickbot”有一些结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/a5f2681428e19384b95402065bae3a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySTBYZ0kyxmBg7hj1ioLZA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">列出按描述内容过滤的方案(续)</figcaption></figure><p id="f5f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“僵尸网络-114”有四个捕获，值得注意的是<em class="mt">在<strong class="lb iu"> PROBABLE_NAME </strong>字段中没有</em>的名称“emotet”。以下是该场景的全部细节:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/1e9f047e059c89805b1a7df08b4a0f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzkAnHQNpS3vCvLu-yNhrw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">显示方案的元数据</figcaption></figure><p id="97ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在浏览器窗口中打开网页(在Mac、Linux上，很快就会在Linux 2的Windows子系统上打开)?！)用命令<code class="fe nj nk nl nm b">lim ctu overview Botnet-114–1</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/b0d589d14fda0d77374ec358ce544a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QI3UTMtmMFR1URZAEoIPgA.png"/></div></div></figure><p id="ff12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这显示了第一个<em class="mt">疑似</em> emotet样本于2015年4月在沙盒中运行。具有相同基础名称的多个场景(<code class="fe nj nk nl nm b">Botnet-114–1</code>、<code class="fe nj nk nl nm b">Botnet-114–2</code>、<code class="fe nj nk nl nm b">Botnet-114–3</code>和<code class="fe nj nk nl nm b">Botnet-114–4</code>)表明他们执行了多次运行，以查看它们之间的不同之处。</p><p id="8bf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以通过哈希(MD5、SHA1或SHA256)搜索方案。下面是一个随机选择的示例，其中多个场景与同一个二进制文件相关:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/4b814ecb997ea9d00f2c193007975f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dkmzvdkcwQaQ9tq97zVx1w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">列出按哈希过滤的场景</figcaption></figure><p id="3b06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">统计数据也可用于元数据属性。默认情况下，显示<code class="fe nj nk nl nm b">GROUPS</code>属性(如上所示)。</p><p id="f1fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以执行的一个简单分析是确定特定恶意软件样本的出现频率。以下是MD5哈希出现次数的部分列表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/f50456c3b6a67a4c5639fd8d2594c49d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gDBlw62kTNJFYnoXZAobmg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">按属性获取场景计数</figcaption></figure><p id="8593" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">77个场景没有记录MD5散列，而绝大多数捕获只涉及运行一两次的二进制文件。</p><p id="c087" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前三名是什么？我们可以通过列出场景，按哈希过滤:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/7d57bdb073ff030475254748185044f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*glDd8Zdm2ASfWvGyRUaPVA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">列出按哈希过滤的场景</figcaption></figure><p id="8dfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们得到所有的“超级用户”并检索每个涉及emotet的场景的PCAP文件。这展示了如何编写跨多个场景的批量分析任务的脚本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/dc1a94902cc4bba505b157ffb19ad15b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cN8WZlJIC8TW9YiGfzi1QQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通过单个命令中的描述内容从多个场景中检索数据</figcaption></figure><h2 id="ec77" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">千步之旅</h2><p id="d09c" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">好了，这是第一步！</p><p id="c1cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经能够识别一些候选场景，查看它们的描述，并从命令行(而不是浏览器)检索它们的一些内容。</p><p id="c84e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在就有这么多时间，但是你还可以做得更多。</p><p id="43d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在https://pypi.org/project/lim-cli的<a class="ae ky" href="https://pypi.org/project/lim-cli" rel="noopener ugc nofollow" target="_blank">从PyPi获得<code class="fe nj nk nl nm b">lim</code>(称为<code class="fe nj nk nl nm b">lim-cli</code>，因为与一个预先存在的包名称冲突)。</a></p><div class="nn no gp gr np nq"><a href="https://pypi.org/project/lim-cli" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">lim-cli</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">用于访问、操作和处理计算机和网络安全信息的Python CLI(例如，PCAP、Netflow…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">pypi.org</p></div></div><div class="nz l"><div class="op l ob oc od nz oe ks nq"/></div></div></a></div><p id="5a49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按照<a class="ae ky" href="https://lim-cli.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">文档链接获取安装说明</a>。</p><p id="567b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">试试看，让我知道你的想法！</p><p id="498b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【感谢Sebastian Garcia、Lukas Rist和其他人对本文的反馈。]</p></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="b01c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mt">要引用CTU数据集，请引用Sebastian Garcia、Martin Grill、Jan Stiborek和Alejandro Zunino的论文“僵尸网络检测方法的实证比较”。计算机与安全杂志。2014.第45卷，第100-123页。</em><a class="ae ky" href="http://dx.doi.org/10.1016/j.cose.2014.05.011" rel="noopener ugc nofollow" target="_blank"><em class="mt">http://dx.doi.org/10.1016/j.cose.2014.05.011</em></a></p></div></div>    
</body>
</html>