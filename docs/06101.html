<html>
<head>
<title>SQL statement logging in Spring Boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot的SQL语句日志记录</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/sql-statement-logging-in-spring-boot-ffac0f9294a5?source=collection_archive---------15-----------------------#2020-10-26">https://levelup.gitconnected.com/sql-statement-logging-in-spring-boot-ffac0f9294a5?source=collection_archive---------15-----------------------#2020-10-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4ba9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在开发spring boot应用程序时，您可能会遇到各种各样的错误，尤其是在使用数据库时。在这些Spring boot应用程序中，我们通常使用JPA来简化数据库管理工作。当出现内部服务器错误之类的错误时，您肯定需要查看日志来找到问题。在这篇文章中，您可以学习如何从Springboot记录Hibernate/JPA SQL语句。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/589b437c0f02cd26228cec2f0c999e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bs0BZAWEAwJaEGbsXA9U0w.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">检查SQL日志</figcaption></figure><p id="5cd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有很多方法可以做到这一点。</p><h2 id="8b18" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">1)标准输出</h2><p id="7770" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">下面是记录SQL语句的最简单的方法。您只需将这一行添加到<em class="lz"> application.properties </em>文件中:</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="1114" class="lb lc iq mb b gy mf mg l mh mi">spring.jpa.show-sql=true</span></pre><p id="2263" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如此简单。对吗？让我们看看输出。如果你使用的是tomcat，你可以从<em class="lz">/Tomcat/logs/catalina . out</em>中找到日志</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="db40" class="lb lc iq mb b gy mf mg l mh mi">Hibernate: insert into program (id, created_at, title, image_url) values (?, ?, ?, ?)</span></pre><p id="1e53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会注意到这里有些不寻常。是的，它没有显示我们发送的参数。这些用“？”表示马克斯。不过，我主要是在<a class="ae mj" href="https://github.com/sef-global/scholarx" rel="noopener ugc nofollow" target="_blank"> ScholarX </a>和<a class="ae mj" href="https://github.com/sef-global/sef-core" rel="noopener ugc nofollow" target="_blank"> Academix </a>在<a class="ae mj" href="http://sefglobal.org/" rel="noopener ugc nofollow" target="_blank"> SEF </a>开发后端的时候用这个方法。</p><p id="5c7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想美化这个陈述，特别是当它涉及到长的陈述时，你可以添加以下内容:</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="65db" class="lb lc iq mb b gy mf mg l mh mi">spring.jpa.properties.hibernate.format_sql=true</span></pre><p id="4ea4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将格式化语句，并通过添加一些缩进来美化它，就像这样。所以你会更清楚。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="f738" class="lb lc iq mb b gy mf mg l mh mi">Hibernate: <br/>    insert <br/>    into<br/>        program<br/>        (id, created_at, title, image_url) <br/>    values<br/>        (?, ?, ?, ?)</span></pre><h2 id="96be" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">2)通过记录器</h2><p id="ae5e" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">另一种方法是通过记录器。通过使用记录器，我们还可以跟踪语句参数。同样，我们只需通过添加以下内容来更新<em class="lz">应用程序.属性</em>:</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="20d4" class="lb lc iq mb b gy mf mg l mh mi">logging.level.org.hibernate.SQL=DEBUG<br/>logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE</span></pre><p id="1ccf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将在更详细的视图中记录带有参数的SQL查询:</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="da3b" class="lb lc iq mb b gy mf mg l mh mi">2020–10–24 00:28:26.005 DEBUG 1096 — — [io-8080-exec-12] org.hibernate.SQL : insert into program (id, created_at, title, image_url) values (?, ?, ?, ?)</span><span id="f460" class="lb lc iq mb b gy mk mg l mh mi">2020–10–24 00:28:26.039 TRACE 1096 — — [io-8080-exec-12] o.h.type.descriptor.sql.BasicBinder : binding parameter [1] as [BIGINT] — [1]<br/>2020–10–24 00:28:26.037 TRACE 1096 — — [io-8080-exec-12] o.h.type.descriptor.sql.BasicBinder : binding parameter [2] as [TIMESTAMP] — [Sat Oct 24 00:28:25 IST 2020]<br/>2020–10–24 00:28:26.037 TRACE 1096 — — [io-8080-exec-12] o.h.type.descriptor.sql.BasicBinder : binding parameter [3] as [VARCHAR] — [Hello World]<br/>2020–10–24 00:28:26.037 TRACE 1096 — — [io-8080-exec-12] o.h.type.descriptor.sql.BasicBinder : binding parameter [4] as [VARCHAR] — [hello.jpg]</span></pre><p id="49c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那个“？”痕迹还在。但是你可以看到参数显示在下面。你也可以使用我们之前用过的美化命令(这看起来很复杂。所以我一般不用这个)</p><p id="02c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天到此为止。我希望你学到了新东西。向我们的<a class="ae mj" href="https://github.com/sef-global" rel="noopener ugc nofollow" target="_blank"> Github repos </a>投稿。还有Hacktoberfest快乐！</p></div></div>    
</body>
</html>