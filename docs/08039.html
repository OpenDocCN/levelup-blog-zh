<html>
<head>
<title>Write Comments. Please.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">写评论。求你了。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/write-comments-please-79752a6a3080?source=collection_archive---------18-----------------------#2021-03-29">https://levelup.gitconnected.com/write-comments-please-79752a6a3080?source=collection_archive---------18-----------------------#2021-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ef5405571a36334b440691ff955ac85d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iRmkIysw1XR0YA63x5QKiA.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由ShotPrime工作室从<a class="ae kf" href="https://www.shutterstock.com/image-photo/woman-touches-her-head-hands-looks-1338385289" rel="noopener ugc nofollow" target="_blank"> ShutterStock </a></figcaption></figure><ul class=""><li id="c181" class="kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">"如果你需要写注释，你需要重写你的代码."</li><li id="392c" class="kg kh it ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">"你的代码应该是自文档化的."</li><li id="bc9c" class="kg kh it ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">"评论永远不会保持最新。"</li><li id="3e86" class="kg kh it ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">"评论是浪费时间。"</li></ul><p id="8e56" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">我们多少次听到这些和类似的声明？足以让你相信所有的代码注释都是不好的。</p><p id="4b0e" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">他们不是。评论至关重要。写得明智，评论是未来开发者的生命线，甚至是你自己。</p><h1 id="9ffe" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">注释代码中无法解释的内容。</h1><p id="f60e" class="pw-post-body-paragraph ld le it ki b kj mq lf lg kl mr lh li kn ms lk ll kp mt ln lo kr mu lq lr kt im bi translated">当开发人员被告诫注释是编码失败的一个原因时，他们被教导要相信所有的事情在代码中都是可以解释的。有时候，这还不够。</p><p id="9234" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">我们将使用下面的代码片段来解释创建好的评论的过程:</p><figure class="mv mw mx my gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e6b8" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">这是怎么回事？既混乱又简洁。它没有提供上下文。让我们看看是否至少可以改进命名，以更好地解释正在发生的事情:</p><figure class="mv mw mx my gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="7b0d" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">好吧。我们改进了函数和变量名。<code class="fe nb nc nd ne b">highSpeedLoop</code>告诉我们这个功能是面向性能的。<code class="fe nb nc nd ne b">numLoops</code>解释说这个变量告诉我们我们想要通过<code class="fe nb nc nd ne b">fn</code>循环多少次。<code class="fe nb nc nd ne b">index</code>帮助我们看到这个变量是一个通过<code class="fe nb nc nd ne b">fn</code>运行的指数。<code class="fe nb nc nd ne b">internalLoopIndex</code>有些含糊，但至少它解释了它的值是内部使用的，并不意味着影响<code class="fe nb nc nd ne b">fn</code>的执行。同样的道理也适用于<code class="fe nb nc nd ne b">remainderIndex</code>，顾名思义，它与<code class="fe nb nc nd ne b">internalLoopIndex</code>多少有些关联。</p><p id="c83f" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">也许这还不够。我们有了更容易理解的变量名和函数名，但是我们仍然有这些令人困惑的循环。也许我们应该解释一下？</p><figure class="mv mw mx my gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="a09b" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">好的，这解释了正在发生的事情……但是我不确定这是否减少了困惑。</p><p id="a468" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">这是人们告诫我们不要做的那种评论。在这里，我们添加了英语来说明<em class="nf">正在发生什么……但是它并没有解释<em class="nf">为什么</em>我们首先要这么做。我们添加了文本，但没有添加实际信息。</em></p><p id="347c" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">如果我们要给代码添加注释，它应该添加通过阅读代码无法获得的信息。代码应该说明正在做什么，以及如何做。但是它不能解释为什么。</p><h1 id="1508" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">注释解释了“为什么”</h1><p id="01fa" class="pw-post-body-paragraph ld le it ki b kj mq lf lg kl mr lh li kn ms lk ll kp mt ln lo kr mu lq lr kt im bi translated">当我们拥有业务文档时，它解释了功能应该做什么。代码库不需要重复这一点。但是业务文档不能做的，变量命名和函数组合不能做的，是解释<em class="nf">为什么</em>我们以一种特定的方式编写一个函数。</p><p id="f948" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">我们一直遵循的代码基于一个旧的编译器技巧，通过将循环展开成八个一组来提高循环速度。这一招是几十年前的。从那时起，它可能已经改变了，并且几乎总是由当今的解释器和JIT hotspot编译器来管理。您可能会在编译器和图形处理器中看到这种代码，但很少在应用程序中看到。为什么会在这里？</p><p id="6bd6" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">这就是评论的作用。</p><figure class="mv mw mx my gt ju"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="91cd" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">顶部的评论回答了这个问题，“我们为什么要制造这个怪物？”函数中的第一个注释解释了为什么我们将循环展开成8个一组。最后一个注释解释了最后一个循环的目的。(这最后一个评论可能被认为是无关紧要的，但它有助于平衡解释展开的第一个评论。)</p><p id="a24c" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">顶部的注释没有记录我们的代码。<em class="nf">评论解释了代码的存在。</em>代码可以像我们一直在跟踪的函数一样复杂，也可以简单到只有三行代码，解决一个没有注释看起来不必要的边缘情况。但是如果没有注释，未来的开发人员在阅读未注释的代码时，可能会认为它是Delete键的绝佳选择。</p><p id="4570" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">好的注释可以防止不适当的重构。互联网上有一些关于代码重构变坏的<a class="ae kf" href="https://overreacted.io/goodbye-clean-code/" rel="noopener ugc nofollow" target="_blank">伟大</a> <a class="ae kf" href="https://zigamiklic.com/cautionary-tale/" rel="noopener ugc nofollow" target="_blank">故事</a>，它们是不理解为什么代码以这种方式构建的结果。</p><p id="8de3" class="pw-post-body-paragraph ld le it ki b kj kk lf lg kl km lh li kn lj lk ll kp lm ln lo kr lp lq lr kt im bi translated">所以当你写代码的时候，写你最好的代码。确保它是可读的，这样未来的开发者就能理解它在做什么。但是如果不清楚<em class="nf">为什么</em>你用你的方式写代码，如果它的复杂性管理一个边缘情况，确保你评论<em class="nf">为什么</em>它是复杂的。未来的开发者——包括你自己——会感谢你的。</p></div></div>    
</body>
</html>