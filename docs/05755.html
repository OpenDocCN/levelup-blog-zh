<html>
<head>
<title>Spark on Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes上的火花</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/spark-on-kubernetes-3d822969f85b?source=collection_archive---------0-----------------------#2020-09-29">https://levelup.gitconnected.com/spark-on-kubernetes-3d822969f85b?source=collection_archive---------0-----------------------#2020-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7ca8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">动手操作介绍:启动和运行。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/56edb93e9109eaa5c99c06121e1bfa8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2tjWcbrgNiubNZlyKdc3sw.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">拉里莎·比尔塔在<a class="ae ky" href="https://unsplash.com/s/photos/orchestra?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2f7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程旨在帮助工程师了解如何在Kubernetes 上使用<em class="lv"> Spark。我希望您能够使用本系列中开发的技能，熟练使用Kubernetes调度程序构建和部署Spark应用程序。</em></p><p id="c978" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于这是本系列的第一篇教程，自然也是最简单的。这里的想法是介绍我们将在整个系列中使用的概念和组件，包括<a class="ae ky" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank">Kubernetes</a>(K8s)<a class="ae ky" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">Docker</a>和<a class="ae ky" href="http://spark.apache.org/" rel="noopener ugc nofollow" target="_blank"> Spark 3.0.1 </a>。</p><h2 id="bff3" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">先决条件</h2><p id="a275" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">对Apache Spark的基本了解。</p><div class="mu mv gp gr mw mx"><a href="https://databricks.com/spark/about" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">Apache Spark什么是Spark</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">Spark是一个强大的开源统一分析引擎，围绕速度、易用性和流分析而构建…</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">databricks.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ks mx"/></div></div></a></div><h2 id="1de6" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">你将学到什么</h2><p id="e473" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">这第一个教程将涵盖以下内容。</p><ol class=""><li id="8980" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">在Docker桌面上启动和运行</li><li id="e2b3" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">配置Docker环境</li><li id="5fce" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">使用Docker桌面的捆绑Kubernetes</li><li id="08e3" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">安装Kubernetes仪表板</li><li id="40b6" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">基本Kubernetes命令</li><li id="cd42" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">局部火花装置</li><li id="1ee9" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">如何构建自定义Spark Docker映像</li><li id="4f59" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">如何将自定义Spark图像推送到DockerHub</li><li id="64c5" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">在本地Kubernetes集群中启动您的第一个Spark应用程序</li><li id="70dd" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">使用Kubernetes仪表板查看应用程序的运行情况</li></ol><p id="f481" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来的两节旨在涵盖所使用技术的基础知识，如果您赶时间，那么您可以跳到<strong class="lb iu">在Docker Desktop </strong>上开始运行，稍后再回来了解Kubernetes是什么，以及一点关于<a class="ae ky" href="https://github.com/GoogleCloudPlatform/spark-on-k8s-operator/blob/master/docs/user-guide.md" rel="noopener ugc nofollow" target="_blank"> Spark Kubernetes操作符</a>或Spark的官方Kubernetes调度程序。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="219f" class="oh lx it bd ly oi oj ok mb ol om on me jz oo ka mh kc op kd mk kf oq kg mn or bi translated">什么是Kubernetes？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/eef7af5652cd4d4a190eb6227f1eaa1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6bIZkX0MBbBSBh9iS3xHTw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">图1–1</strong>:部署、自动扩展和修复由Kubernetes编排的容器化应用程序:通过<a class="ae ky" href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>从什么是Kubernetes？</figcaption></figure><p id="49c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>简而言之，它是一个开源基础设施管理框架，允许您提供集群计算基础设施的逻辑切片，以便部署、扩展和管理不同规模的容器化应用。</p><p id="8e1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">乍一看，这个心理模型的某些部分感觉很熟悉。如果你已经站在DevOps一边有一段时间了——就像我一样——你可能已经在精神上看到了许多类似的解决方案。从不起眼的shell脚本，到不同的服务引导库，如<a class="ae ky" href="https://capistranorb.com/" rel="noopener ugc nofollow" target="_blank"> Capistrano </a>(还记得ruby)、<a class="ae ky" href="https://community.chef.io/" rel="noopener ugc nofollow" target="_blank">Chef</a>(…更多Ruby)、<a class="ae ky" href="https://www.ansible.com/" rel="noopener ugc nofollow" target="_blank"> Ansible </a> (python)，再到内部部署、预云部署和基于云的部署，我们都见过在一个地方运行良好，而在另一个地方却严重失败的情况。</p><blockquote class="ot ou ov"><p id="7419" class="kz la lv lb b lc ld ju le lf lg jx lh ow lj lk ll ox ln lo lp oy lr ls lt lu im bi translated">还记得上一次您或您认识的人更改了配置，重新启动了流程，却忘记了所做的更改吗？不料在下一次部署中又出现了同样的问题:)</p></blockquote><h2 id="59f9" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">自动化</h2><p id="3951" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们正处于计算机化自动化的时代，能够自动化修复过程、触发替换或自主扩大生产机器的车队——所有这些都基于“基础设施即代码”——可能是极其有益的。在本地工作的只是复制确切环境的蓝图，因此您可以在所有环境中依靠持久、可靠的部署—这是它的要点。</p><p id="557d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">基础设施即代码</strong>支持服务配置、共享机密(位置而非实际机密…因为我们不会将密码登记到github中！)，磁盘和ram分配被检查到您的github中，并与典型的CI/CD管道一起释放。这些配置是等幂的，这意味着除非有真正的变化(配置哈希变化)，否则将相同的配置推送到集群两次不会改变集群内运行的服务。乍一看，这似乎微不足道，但Kubernetes是建立在多年的谷歌规模的部署和他们的最佳实践捆绑在一起的堆栈。</p><p id="4931" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于您的容器化应用程序，包括Spark，所有东西都包装在一个版本化的容器中，该容器必须首先发布到您的容器注册中心或公共注册中心。</p><p id="fcd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Kubernetes支持多种容器格式，以防止锁定，但大多数人会告诉你他们正在用Docker做什么。</p><p id="f6d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看官方Kubernetes文档中的<a class="ae ky" href="https://kubernetes.io/docs/concepts/containers/#container-runtime" rel="noopener ugc nofollow" target="_blank">容器运行时</a>信息，或者浏览下面链接的书。</p><h2 id="5974" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">吊舱</strong></h2><p id="b45c" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">Pods包装了您的应用程序配置、机器布局(文件系统路径、安装的操作系统、软件包等)、共享资源(如CPU(cgroups)、ram分配、应用程序配置、系统设置，甚至通过卷(python文件、其他脚本)本地访问的共享文件，以及任何其他基于角色的访问控制。</p><p id="1c9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个名字来源于一种豆荚，这种豆荚在本质上是一种受保护的资源，就像“鲸鱼豆荚”或“豆荚中的豌豆”。更多详情请参见<a class="ae ky" href="https://kubernetes.io/docs/concepts/workloads/pods/" rel="noopener ugc nofollow" target="_blank">什么是Pod </a>。</p><p id="35d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在spark应用程序的情况下，这个应用程序运行时逻辑是标准的<em class="lv"> spark.conf.* </em>设置，以及任何共享卷(磁盘)、应用程序依赖项(jars/python/r等)和运行Spark应用程序时想要细粒度访问的任何东西。</p><h2 id="5125" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">推荐阅读</h2><p id="e82f" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我想涵盖基本的行话，但对于Kubernetes的完整端到端覆盖，我会推荐事实上标准的书(如下)，或者只是浏览一下<a class="ae ky" href="https://kubernetes.io/docs/home/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><div class="mu mv gp gr mw mx"><a href="https://learning.oreilly.com/library/view/kubernetes-up-and/9781492046523/" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">Kubernetes:启动并运行，第二版</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">Kubernetes从根本上改变了应用程序在云中构建和部署的方式。自2014年推出以来…</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">learning.oreilly.com</p></div></div><div class="ng l"><div class="oz l ni nj nk ng nl ks mx"/></div></div></a></div><p id="bbea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到这篇文章不是Kubernetes的入门，我就不说了，这样我们就可以进入教程的实质了。在下一节中，我们将看看Kubernetes上的Spark，了解它是什么，然后开始设置本地环境并运行我们的第一个部署。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="6697" class="oh lx it bd ly oi oj ok mb ol om on me jz oo ka mh kc op kd mk kf oq kg mn or bi translated">Kubernetes上的火花</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/3aef08845c50891b3a469fa52d14ee6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tkWi16Clt_6RjLJNmyLVkg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">图1–2</strong>:在Pod内运行的火花驱动器。图片来自<a class="ae ky" href="https://spark.apache.org/docs/latest/running-on-kubernetes.html" rel="noopener ugc nofollow" target="_blank"> Spark文档</a></figcaption></figure><h2 id="ff70" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">Kubernetes调度程序</h2><p id="8876" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">Spark Kubernetes调度器允许您将Apache Spark应用程序部署在一个容器化的包中，以及您的应用程序配置、自定义环境变量、共享机密和通过卷挂载的共享磁盘访问，即所谓的驱动程序Pod。这可以看作是对Spark Standalone上部署的改进，原因如下。</p><h2 id="34cb" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">从Spark Standalone到Spark Kubernetes</h2><p id="32fa" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">如果你一直在独立模式下使用Spark，这可能会在整体思维模式方面有所不同，下面是它的分解方式。在<a class="ae ky" href="http://spark.apache.org/docs/latest/spark-standalone.html" rel="noopener ugc nofollow" target="_blank"> Spark独立</a>部署模式下，您必须部署一个独立的主服务器(集群协调器)，并且为了实现高可用性(HA ),还必须部署一个备用的主服务器。<em class="lv">这些机器不一定是结实的机器。2个内核和4gb ram以及像样的网络实现了这个目标</em>。</p><p id="810b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这确实需要<a class="ae ky" href="https://zookeeper.apache.org/" rel="noopener ugc nofollow" target="_blank"> Zookeeper </a>来管理集群状态，例如，什么应用程序正在运行，每个应用程序分配了什么——也就是我的CPU和RAM去哪里了？—最后，哪些执行器实例在哪里运行。对于许多想要运行Spark的团队来说，仅仅是准备好运行第一个Spark应用程序的环境，就已经有了大量的DevOps开销。</p><p id="cb23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还必须在第一步部署中配置和设置Spark Worker实例，以便有一个集群来提交工作。</p><h2 id="ce2c" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">独立Spark版本控制</h2><p id="64e8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">还有棘手的集群版本锁定。如果您有一个运行Spark 2.3的集群，那么您需要将您的应用程序部署和迁移到一个新的Spark 2.4及更高版本的集群。当然，在某些情况下，小版本仍然可以正常运行，但是总的来说，迁移应用程序总比期望最好的要好。</p><h2 id="09d6" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">新心智模式</h2><p id="9736" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">现在如果我们抽象地思考，Kubernetes在概念上相当于一个火花簇。虽然这不一定是真的，但请听我说完。Kubernetes是一个通用基础设施管理框架，可以调度部署、自动扩展应用程序，并通过自我修复来减少常见的基础设施缺陷，如主机停机。有一个丰富的生态系统，使您能够通过Kubernetes仪表板轻松监控集群的行为，您实际上是在一个可弹性扩展的高度分布式生态系统中开拓空间，非常类似于传统Spark集群中的共享计算资源。当然，也许我正在努力。</p><h2 id="550e" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">BYO星团</h2><p id="2ab4" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">现在，假设您已经配置了一个Kubernetes集群，真正重要的是，我认为最大的增值如下。每个Spark应用程序驱动程序本质上都分配了一个ad-hoc Spark集群，通过Executor Pods分配，基于不可变的Docker映像和幂等Pod配置。</p><blockquote class="pb"><p id="07d9" class="pc pd it bd pe pf pg ph pi pj pk lu dk translated">每个Spark应用程序驱动程序本质上分配一个ad-hoc Spark集群，通过Executor Pods分配，基于不可变的Docker映像和幂等Pods配置</p></blockquote><p id="e430" class="pw-post-body-paragraph kz la it lb b lc pl ju le lf pm jx lh li pn lk ll lm po lo lp lq pp ls lt lu im bi translated">如果你已经习惯了在这些共享的计算资源上运行Spark独立和共存的Spark应用程序，那么你也知道必须将旧应用程序迁移到新版本的Spark以减少多年积累的技术债务的烦恼。</p><p id="fdcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在这是一个尤里卡！至少对我来说，这是一个瞬间，因为我在Twilio的团队已经编写并运行了60多个不同版本的Spark和scala应用程序。</p><h2 id="9170" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">后续步骤</h2><p id="c4dc" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">好吧。有很多要说的，我甚至没有真正触及表面。让我们继续实际动手做一些事情。在下一部分，我们将安装并运行<a class="ae ky" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> Docker桌面</a>。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="a0a7" class="oh lx it bd ly oi oj ok mb ol om on me jz oo ka mh kc op kd mk kf oq kg mn or bi translated"><strong class="ak">在Docker桌面上开始运行</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/890dd0c0481572819ea548464ee80dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lafvZDmkB62xcYqGrAHGDQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Docker桌面。图片通过<a class="ae ky" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> Docker </a></figcaption></figure><p id="f605" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重要的事情先来。让我们安装<a class="ae ky" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> Docker桌面</a>，这样我们就能在同一个竞技场上公平竞争。</p><h2 id="96af" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">安装Docker桌面</h2><p id="3b22" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">这一部分相当容易，因为唯一的步骤是为您选择的平台下载安装程序。</p><ol class=""><li id="a8ef" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">安装<a class="ae ky" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> Docker桌面</a>。</li><li id="cc6e" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">创建一个<a class="ae ky" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>账户。(*仅当您想要构建和上传自定义Spark图像时。)</li></ol><p id="2b9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我倾向于使用4个CPU和10gb RAM。根据您的机器大小，如果您主要在Docker/K8s上运行<em class="lv">而不是主要在您的核心系统OS上运行</em>，您可以增加资源。<em class="lv">记得给核心系统留些RAM</em>。我倾向于在机器上留下1个内核，2gb内存用于后台操作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/e57c087d6f033b4a620358ffb8650d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpUWzoBDlF1sRwfcA6Y1vw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">我的笔记本电脑是6核i9，64gb内存，2TB固态硬盘——16英寸MacBook Pro。这种设置对于演示来说效果很好。</figcaption></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h2 id="210c" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">启用Kubernetes </strong></h2><p id="2ae6" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">您的单节点集群只需点击一下鼠标。说真的，这是一个救命稻草，因为它减少了开始使用K8s的认知负担。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/de2811108eb2f18a7e144250ea85eb9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pN7aunP-uYYFfCdk9lJDcQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">真的。只需点击启用Kubernetes，你就可以开始摇滚了</figcaption></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h2 id="090f" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">验证Kubernetes正在运行</strong></h2><p id="a3ce" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">如果一切顺利的话。很可能是这样的。然后，您可以打开您最喜欢的终端程序(terminal、iTerm等),您应该可以随意使用K8s命令行界面。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="22b4" class="lw lx it pu b gy py pz l qa qb">kubectl cluster-info</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qc"><img src="../Images/67d93c0fc2a599030fd8c5a90a50c095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzMMIG6SilozFa_b8HadbQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">如果一切正常，您应该会看到一个类似的对话框。</figcaption></figure><h2 id="dc9e" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">安装K8s仪表板</strong></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/a9fa767e6b2940e29bb3d6c34c969664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JASF8D2oTqN0X4fpsdJuEw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Kubernetes仪表板:让自己管理事情变得容易</figcaption></figure><p id="f040" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最新的安装步骤可以在<a class="ae ky" href="https://github.com/kubernetes/dashboard#install" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。事情比我最初预期的要容易得多，希望事情对你来说也一样容易。下面是您将要安装的组件。可以把这个仪表板看作是您完成常见K8s任务的向导和助手。集成的仪表板允许你点击按钮而不是记住命令来做一些普通的事情，比如停止部署，在容器上执行命令等等。</p><h2 id="72e8" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">应用仪表板</h2><p id="f00f" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">使用命令行工具应用仪表板配置。如果你想下载<a class="ae ky" href="https://yaml.org/" rel="noopener ugc nofollow" target="_blank"> YAML </a>看看它到底在做什么，请这样做，而不是盲目地应用这个链接！</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="76ba" class="lw lx it pu b gy py pz l qa qb">kubectl apply -f <a class="ae ky" href="https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.4/aio/deploy/recommended.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.4/aio/deploy/recommended.yaml</a></span></pre><p id="7486" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那就启动Kubernetes代理吧。</p><p id="87e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个代理将使您能够使用<code class="fe qe qf qg pu b">localhost:8001</code>而不是您的集群DNS，这可以很容易地找到返回到您的集群上运行的任何UI的方法。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="559c" class="lw lx it pu b gy py pz l qa qb">kubectl proxy</span></pre><h2 id="a147" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">打开仪表板</h2><p id="fd6c" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">仪表板:<a class="ae ky" href="http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login" rel="noopener ugc nofollow" target="_blank">http://localhost:8001/API/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/log in</a></p><p id="72ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你试图加载Kubernetes仪表盘，你会被吼成没有令牌。这是由于设计的安全性。你没做错什么。你可能会问自己<em class="lv">“但是等等。我只是点击了一个按钮</em> <strong class="lb iu"> <em class="lv">启用Kubernetes </em> </strong> <em class="lv">。我该怎么修？”</em>既然连东西在哪里配置都不知道。没关系。你并不孤单。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qh"><img src="../Images/addc6d511126f1bb7292f14f27f410fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KgS0itV77r0XfTupgKzQDw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">哦，太好了。我们现在要干嘛？通过K8s仪表板用户界面的图像</figcaption></figure><h2 id="fb81" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">访问默认令牌</strong></h2><p id="80a7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">当您的K8s环境从Docker Desktop引导时，会生成默认的系统令牌。您可以使用以下命令获取登录仪表板的令牌。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="2a9c" class="lw lx it pu b gy py pz l qa qb">kubectl -n kube-system describe secret default</span></pre><p id="9c8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用上面的命令将产生以下结果。只需复制<strong class="lb iu">令牌</strong>字符串并登录即可。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qi"><img src="../Images/cad8e3a8f37f220ef867d3ffab4dd625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEhpvivgZFFB8EgPqzcPsg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">复制令牌:您将把它粘贴到认证对话框中</figcaption></figure><p id="49d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在返回，粘贴令牌，并登录到仪表板。</p><h2 id="ef16" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">成功</strong>。</h2><p id="16a5" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">现在，您应该已经启动并运行了Kubernetes仪表板。花点时间拍拍自己的肩膀。我们正在学习新的东西，这才是真正的意义所在。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="b548" class="oh lx it bd ly oi oj ok mb ol om on me jz oo ka mh kc op kd mk kf oq kg mn or bi translated">安装Spark 3.x</h1><p id="d5c5" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">安装Spark非常简单。只需转到下面的下载页面，选择预构建(tgz)或勇敢者获得完整的源代码来构建自己。我会等的，你下载所有东西需要几分钟。</p><div class="mu mv gp gr mw mx"><a href="http://spark.apache.org/downloads.html" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">下载| Apache Spark</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">注意，Spark 2.x是用Scala 2.11预建的，除了2.4.2版本是用Scala 2.12预建的。火花3.0+…</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">spark.apache.org</p></div></div><div class="ng l"><div class="qj l ni nj nk ng nl ks mx"/></div></div></a></div><p id="9319" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望您现在已经下载了tarball (tgz)。</p><h2 id="e5bc" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">创建一个安装位置</strong></h2><p id="25e2" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">请注意。为了这个教程，我下载了<code class="fe qe qf qg pu b">spark-3.0.1-bin-hadoop3.2</code>。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="f780" class="lw lx it pu b gy py pz l qa qb">mkdir ~/install &amp;&amp; cd ~/install<br/>mv ~/Downloads/spark-3.0.1*3.2.tgz .</span></pre><h2 id="21bd" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">提取Tarball并清理</strong></h2><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="b1cc" class="lw lx it pu b gy py pz l qa qb">tar -xvzf spark-3.0.1-bin-hadoop3.2.tgz<br/>rm -rf spark-3.0.1-bin-hadoop3.2.tgz</span></pre><h2 id="3818" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">用Spark Home更新你的BashRC或ZshRC】</strong></h2><p id="9651" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">你需要有一个简单的地方来引用你已经安装了Spark。标准就是只用<strong class="lb iu"> SPARK_HOME </strong>。我用的是zsh，如果你用的是bash，那么<code class="fe qe qf qg pu b">vim ~/.bashrc</code>但是你可以遵循同样的命令。</p><p id="9fd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开并编辑您的ZshRC</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="7c49" class="lw lx it pu b gy py pz l qa qb">vim ~/.zshrc</span></pre><p id="1114" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并添加以下内容</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="e632" class="lw lx it pu b gy py pz l qa qb">export SPARK_HOME=/Users/`whoami`/install/spark-3.0.1-bin-hadoop3.2</span><span id="0b28" class="lw lx it pu b gy qk pz l qa qb">alias spark-shell=”$SPARK_HOME/bin/spark-shell”</span></pre><p id="348c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在确保这些设置与当前打开的终端窗口保持一致。你打开的任何新窗口都将继承你的<code class="fe qe qf qg pu b">*rc</code>。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="32f2" class="lw lx it pu b gy py pz l qa qb">source ~/.zshrc</span></pre><p id="1b08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，您已经安装好了所有的东西，并做好了准备。</p><h2 id="eccc" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">我们处于流程的哪个阶段？</strong></h2><p id="fb12" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在本教程的这一点上，我们已经完成了大量的下载、安装和配置工作，但是我们还完成了本地环境设置，并为Spark应用程序开发做好了准备。</p><ol class=""><li id="be4d" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">我们已经将docker设置配置为4核10gb RAM。</li><li id="835e" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">我们已经启用了Kubernetes，因此我们可以使用简单的单节点集群。</li><li id="30de" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">我们已经安装了Kubernetes桌面软件包。这将让我们看到我们的应用程序正在运行。</li><li id="73cd" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">我们已经在本地下载并安装了Spark</li></ol><p id="1438" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们准备开始在Kubernetes上运行Spark。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="66b1" class="oh lx it bd ly oi oj ok mb ol om on me jz oo ka mh kc op kd mk kf oq kg mn or bi translated"><strong class="ak">设置Spark在K8s上运行</strong></h1><p id="79d4" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们希望能够在我们的Kubernetes集群中构建和运行本地Docker映像。这对于在Kubernetes上运行Spark是必不可少的，如果您想为Spark创建一个基础映像以便在您的组织中重用，这也是非常有用的。能够重用基本映像并有效地扩展这些基本的共享映像是一项关键的技能——例如PySpark和定制的运行时安装。</p><h2 id="e1cd" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">构建基础映像</h2><p id="93e6" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">首先让我们找到官方的Spark Dockerfile文件。您应该能够在本地Spark安装目录中找到它。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="2614" class="lw lx it pu b gy py pz l qa qb">ls -l $SPARK_HOME/kubernetes/dockerfiles/spark</span></pre><p id="d277" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是基本docker文件的样子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ql"><img src="../Images/3d791761b15b4d9e31d3f84ccb7bc774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q6J4qUJdadw2pQnU5bw_TQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">火花文件。通过GitHub上的<a class="ae ky" href="https://github.com/apache/spark/tree/branch-3.0/resource-managers/kubernetes/docker/src/main/dockerfiles/spark" rel="noopener ugc nofollow" target="_blank">火花</a></figcaption></figure><h2 id="571e" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">修改</strong></h2><p id="18a7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我想用Java 14构建Spark。Spark 3.x最终使您能够脱离Java 8，因此您现在可以利用现代Java了。我在<em class="lv"> docker hub </em>上看了一下，找到了<a class="ae ky" href="https://hub.docker.com/_/openjdk" rel="noopener ugc nofollow" target="_blank"> OpenJDK </a>资源。我最终使用了默认Dockerfile文件中的<strong class="lb iu"> 14-slim </strong>与标准的<strong class="lb iu"> 8-jre-slim </strong>。</p><p id="2a10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong> : Spark默认运行为<em class="lv"> spark_uid </em> =185。如果您正在构建一个图像，您可能想要使用您自己的非特权用户。</p><h2 id="7782" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">节食中的容器</h2><p id="137a" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">OpenJdk 14-slim是基于Alpine linux发行版构建的，这是一个非常小的版本。苗条是因为它在节食。为了减小文件大小，大多数默认的命令行工具和包都被省略了。然而，值得指出的是，在Docker和Kubernetes的例子中，容器越小，由于带宽开销越小，上线越快。这也意味着缓存中的图像不会使缓存膨胀，或者导致其他图像从缓存中被逐出。</p><p id="515e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种策略，您还可以创建最小的Spark应用程序，只需要提供Spark运行时没有提供的jar。值得花时间检查包装有Spark的<strong class="lb iu">罐</strong>。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="9485" class="lw lx it pu b gy py pz l qa qb">ls -l $SPARK_HOME/jars/</span></pre><p id="1914" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并且在你的maven或者sbt中使用<strong class="lb iu">提供的作用域</strong>。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h2 id="b176" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">构建和推送自定义Spark图像</strong></h2><p id="88d3" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">如果你想下载我制作的图片，请随意。我把它们上传到码头中心了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qm"><img src="../Images/83a4d1cf90374186b0dba780e91637d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EOuGJZNbak5ky3meN5yjQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">Spark</strong>:Java 14 slim via<a class="ae ky" href="https://hub.docker.com/repository/docker/newfrontdocker/spark" rel="noopener ugc nofollow" target="_blank">docker hub</a></figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qn"><img src="../Images/adf80dcc5c1773399dd46b2dadb9633e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OXEu9lk1t2RlJVuuZP5Wcg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly"> PySpark </strong>:额外的Python依赖于<a class="ae ky" href="https://hub.docker.com/repository/docker/newfrontdocker/spark-py" rel="noopener ugc nofollow" target="_blank"> DockerHub </a></figcaption></figure><p id="a313" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">否则。让我们来看一下创建火花图像的过程。</p><h2 id="3372" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">创建Docker图像</strong></h2><p id="0153" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在撰写本文时，我在Slim Java 14 open-jdk上构建了Spark 3.0.1。我也选择支持Python3。以下命令使用Spark<strong class="lb iu">docker-image-tool . sh</strong>脚本。如果您想亲自尝试一下，那么只需用您的dockerhub用户名替换<strong class="lb iu"> newfrontdocker </strong>即可。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="2d07" class="lw lx it pu b gy py pz l qa qb">$SPARK_HOME/bin/docker-image-tool.sh -r newfrontdocker -t v3.0.1-j14 -p kubernetes/dockerfiles/spark/bindings/python/Dockerfile -b java_image_tag=14-slim build</span></pre><p id="b4b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将运行一会儿。如果一切正常，您应该看到以下内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qo"><img src="../Images/122fb15727edcb992f37ed6d63e58089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i747jXG8ggl8Wu0AuZll8A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">命令行</strong>:Java/Scala Spark Docker成功输出</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qp"><img src="../Images/389de0af66dfb5277a67e9cc9ee68f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Md6M7HqqiRK5x2w_HUf3vw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">命令行</strong>:<strong class="bd ly"/>py spark构建成功输出。注意它跳过了java image标签——这不是错误！</figcaption></figure><p id="056a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您应该在本地docker图像缓存中有两个新图像。您可以使用下面的docker命令来检查它们。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="873d" class="lw lx it pu b gy py pz l qa qb">docker images </span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qq"><img src="../Images/86003f321707a69aa691654685d29507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dObQR5L-3B_il3Yerh_irg.png"/></div></div></figure><p id="a88a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将图像放在本地有助于测试事情是否按照您期望的方式工作。然而，最终的游戏通常是将构建推送到Docker存储库中。我们现在就去做。</p><h2 id="9e1c" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">将你的Spark图片推送到DockerHub </strong></h2><p id="dfbb" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">鉴于我们所做的只是构建spark和pyspark图像，我们仍然需要推进到DockerHub。</p><p id="3d73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">提示</strong>:考虑到您的Kubernetes集群可以在本地或远程运行，当您准备开始在本地机器之外工作时，推送最终的Spark构建是有意义的。</p><p id="fcc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想删除您创建的图像，可能您不喜欢潜在的存储库名称。然后，您可以使用下面的命令来做到这一点。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="fd4c" class="lw lx it pu b gy py pz l qa qb">docker image rm {containerId}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qr"><img src="../Images/cc74a978b7f8d420747f188d22914fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*74soyz6TpbZNlc96ULdFIg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">例如:</strong>删除一张我不喜欢的图片。</figcaption></figure><h2 id="8701" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">推送图像</h2><p id="bc64" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">如果您对事情满意，可以随意将构建版本发布到您的容器注册中心。</p><p id="2aa8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步是确保你登录到docker。这里有两种方法。</p><h2 id="71ae" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">使用Docker桌面的凭证</strong></h2><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="5709" class="lw lx it pu b gy py pz l qa qb">docker login docker.io</span></pre><h2 id="d1ec" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">新鲜登录</strong></h2><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="44cc" class="lw lx it pu b gy py pz l qa qb">docker login <a class="ae ky" href="http://docker.io" rel="noopener ugc nofollow" target="_blank">docker.io</a> — username newfrontdocker</span></pre><p id="bd36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何一个都应该以</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="a062" class="lw lx it pu b gy py pz l qa qb">&gt; Login Succeeded</span></pre><h2 id="8b2d" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">推送构建</strong></h2><p id="c983" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated"><strong class="lb iu"> Spark Python Docker图片</strong>:</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="6e6b" class="lw lx it pu b gy py pz l qa qb">docker push newfrontdocker/spark-py:v3.0.1-j14</span></pre><p id="ffcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">火花对接图像</strong>:</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="1999" class="lw lx it pu b gy py pz l qa qb">docker push newfrontdocker/spark:v3.0.1-j14</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qs"><img src="../Images/e8d2d5ae92843516268bc52cb954455c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*69D86eGfmbIQLiIXrF9bIQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">命令行</strong>:推送到Docker</figcaption></figure><p id="d2ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在教程的这一点上，我们只是在主任务。在下一节中，我们将最终在Kubernetes上运行一个Spark应用程序。如果你坚持到现在，谢谢。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="728f" class="oh lx it bd ly oi oj ok mb ol om on me jz oo ka mh kc op kd mk kf oq kg mn or bi translated"><strong class="ak">Kubernetes上的火花:Hello World </strong></h1><p id="b734" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们现在正准备在Kubernetes上运行我们的第一个Spark任务。这是一件大事。这就是我们在这里的原因！</p><ol class=""><li id="275e" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">我们需要找到集群主节点。</li></ol><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="907f" class="lw lx it pu b gy py pz l qa qb">kubectl cluster-info</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qc"><img src="../Images/67d93c0fc2a599030fd8c5a90a50c095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzMMIG6SilozFa_b8HadbQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly">记住这个</strong>:现在我们实际上正在使用来自集群信息的值</figcaption></figure><p id="004f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，我们关心的是Kubernetes Master，因为我们需要在Spark提交中引用它。</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="3809" class="lw lx it pu b gy py pz l qa qb"><em class="lv">$SPARK_HOME/bin/spark-submit \<br/>  --master k8s://https://kubernetes.docker.internal:6443 \<br/>  --deploy-mode cluster \<br/>  --name spark-pi \<br/>  --class org.apache.spark.examples.SparkPi \<br/>  --conf spark.executor.instances=5 \<br/>  --conf spark.kubernetes.container.image=newfrontdocker/spark:v3.0.1-j14 \<br/>  local:///opt/spark/examples/jars/spark-examples_2.12–3.0.1.jar</em></span></pre><blockquote class="ot ou ov"><p id="c931" class="kz la lv lb b lc ld ju le lf lg jx lh ow lj lk ll ox ln lo lp oy lr ls lt lu im bi translated">值得指出的是，<code class="fe qe qf qg pu b"><strong class="lb iu">local:///opt/</strong></code>实际上引用了Docker容器内部的JAR路径。当您想要从您的部署中访问本地配置文件、spark-environment变量、日志记录概要文件等等时，这是非常有用的。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qt"><img src="../Images/5c1b815157706db9dbb8cc3629df4b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tx9fK03HIwsfgCoRonqzPA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly"> Spark提交输出</strong>:当运行Spark应用程序时，您应该会看到类似的内容</figcaption></figure><h2 id="a270" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">豆荚里的火花</strong></h2><p id="9783" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">如果您在Spark应用程序运行时打开<strong class="lb iu"> <em class="lv"> Kubernetes仪表板</em> </strong>，您会看到类似的视图。值得注意的是，由于我们在Spark提交中配置了<code class="fe qe qf qg pu b">spark.executor.instances=5</code>,您将看到5个pods为您的应用程序运行。这相当于在传统的Spark独立世界中有5个executor实例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qu"><img src="../Images/3bf43014a7df0ba294624ff52df4fd56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5F1Bd319NCtvvUFPLDaO3w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ly"> Kubernetes仪表盘</strong>:Spark Executor吊舱运行视图</figcaption></figure><h1 id="8ab0" class="oh lx it bd ly oi qv ok mb ol qw on me jz qx ka mh kc qy kd mk kf qz kg mn or bi translated">那是一个包裹</h1><p id="629b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在第一节教程中，我们确实涉及了很多内容。我真的很享受学习周期的这一部分。当创造性的汁液开始流动，新的想法似乎活跃起来，这是大脑奖励学习过程的一种方式，我希望你能够坚持到这一点。在本教程的过程中，我们相当快地覆盖了很多领域。这是倒带。</p><h2 id="247e" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak"> Docker桌面</strong></h2><p id="64fd" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们在我们的电脑上安装并运行了Docker Desktop。到处击掌。这包括在我们的笔记本电脑上配置一些空间，以便为Docker环境供电。我用的是旧笔记本电脑上的4核10gb内存。如果你有更多的内核和更多的内存，Kubernetes会很乐意从你那里得到更多的并行性，让事情运行得更快。</p><h2 id="901b" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">本地Kubernetes </strong></h2><p id="cf31" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们进一步点击复选框，在本地Docker中启用了Kubernetes(单节点)集群支持。这是我们共同的库伯内特之旅的开始。</p><h2 id="a9a2" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak"> Kubernetes仪表盘</strong></h2><p id="128c" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们获取并应用了运行Kubernetes仪表板的配置和信息，这样我们就可以对集群有所了解。这是一个比Docker桌面仪表盘上的<strong class="lb iu">运行</strong>绿灯更好的集群视图。</p><ul class=""><li id="c694" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu ra ns nt nu bi translated">我们研究了一些“kubectl”命令，以找到我们的令牌并实际登录到仪表板</li><li id="9bda" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu ra ns nt nu bi translated">我们看到了如何通过使用“kubectl cluster-info”命令获得一些非常重要的集群信息</li></ul><h2 id="cfdc" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">安装Apache Spark </strong></h2><p id="12a8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们在本地安装了Apache Spark，以便访问项目附带的核心order文件。这是该过程的一个重要部分，因为当我们创建一个新的Docker映像时，我们需要能够在本地发布Spark源。</p><p id="d7ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们只是想做一些基本的事情，并通过spark-shell来了解spark，那么我们可以开箱即用，只是玩玩Spark运行时。<code class="fe qe qf qg pu b">$SPARK_HOME/bin/spark-shell</code>和<code class="fe qe qf qg pu b">$SPARK_HOME/bin/pyspark</code>分别给你访问本地外壳的权限。</p><h2 id="2388" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">构建Spark Docker映像</strong></h2><p id="5fc7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们能够构建一个本地版本的Spark，将我们自己的JDK带到餐桌上——因为运输集装箱时饮食是很好的。这让我们能够<strong class="lb iu">选择</strong>如何在不引入集体厨房水槽的情况下构建这些图像。现在，本地测试、列出本地映像、有选择地删除映像以及最后将映像推送到公共存储库的功能都在您的工具箱中了。</p><h2 id="c056" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">在Kubernetes上本地运行Spark】</strong></h2><p id="c4a8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们通过运行一个示例Spark应用程序完成了这次旋风式的深入研究。这是作为测试集群的<strong class="lb iu"> HelloWorld </strong>完成的，现在我们可以使用这里完成的工作，以便继续做更大更好的事情。</p><h2 id="d133" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">后续步骤</h2><p id="d207" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在我的下一篇教程中，我将向您展示如何使用这两个基础Spark映像来简化运行Spark Scala应用程序以及需要定制python安装的PySpark应用程序。我们将更深入地了解Kubernetes配置如何工作，以便<strong class="lb iu"> <em class="lv">支持基于服务和角色的访问</em> </strong>到在我们的<em class="lv">驱动程序</em>和<em class="lv">执行程序</em>容器中运行的流程。</p><p id="33e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您花时间深入了解Kubernetes上的Spark。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h2 id="b23f" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">注意事项和绊脚石</strong></h2><p id="6179" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">作为题外话。Kubernetes Docs上的“熄灭火花”为入门提供了答案。困难的部分实际上是让图像构建并上传到DockerHub。我很不好意思地说，我敲了两个多小时的键盘，试图理解<code class="fe qe qf qg pu b">-r &lt;repo&gt;</code>应该只是我的<code class="fe qe qf qg pu b">username</code>——比如<code class="fe qe qf qg pu b">newfrontdocker</code>。为我想得太多而感到羞耻。</p><p id="8568" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">DockerHub的注册表实际上帮助我调试了这个问题，因为我不能在一个存储库中创建文件夹。啊。查看Spark Kubernetes目录中的<code class="fe qe qf qg pu b">docker-image-tool.sh</code>有助于了解工件是如何合成的。这帮助我明白了我应该创建两个存储库<code class="fe qe qf qg pu b">spark</code>和<code class="fe qe qf qg pu b">spark-py</code>。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h2 id="f8ad" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">链接和感谢</strong></h2><p id="a97f" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在我经历这个过程的时候，网上有大量的资源可以提供帮助。我已经按内容把链接分解了。</p><h2 id="8952" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">码头工人</h2><p id="b06a" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated"><a class="ae ky" href="https://docs.docker.com/docker-hub/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/docker-hub/</a></p><p id="98bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://hub.docker.com/_/openjdk?tab=tags&amp;page=1&amp;name=14-slim" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/_/openjdk?tab=tags&amp;page = 1&amp;name = 14-slim</a></p><p id="814f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://docs.docker.com/engine/reference/commandline/login/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/engine/reference/commandline/login/</a></p><p id="6555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.docker.com/blog/docker-hub-new-personal-access-tokens/" rel="noopener ugc nofollow" target="_blank">https://www . docker . com/blog/docker-hub-new-personal-access-tokens/</a></p><p id="a24d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【https://docs.docker.com/engine/reference/commandline/push/ T4】</p><p id="c027" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://docs.docker.com/docker-hub/repos/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/docker-hub/repos/</a></p><p id="b62b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/54410909/what-is-the-correct-upload-url-for-a-dockerhub-repo" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/54410909/what-the-correct-upload-URL-for-a-docker hub-repo</a></p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h2 id="a215" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">K8s上的火花</h2><p id="10a8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated"><a class="ae ky" href="https://spark.apache.org/docs/latest/running-on-kubernetes.html" rel="noopener ugc nofollow" target="_blank">https://spark . Apache . org/docs/latest/running-on-kubernetes . html</a></p><p id="84eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://spark.apache.org/docs/latest/running-on-kubernetes.html#pod-template" rel="noopener ugc nofollow" target="_blank">https://spark . Apache . org/docs/latest/running-on-kubernetes . html # pod-template</a></p><p id="85e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.slideshare.net/databricks/running-apache-spark-jobs-using-kubernetes" rel="noopener ugc nofollow" target="_blank">https://www . slide share . net/databricks/running-Apache-spark-jobs-using-kubernetes</a></p><p id="bc78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/marcelonyc/igz_sparkk8s" rel="noopener ugc nofollow" target="_blank">https://github.com/marcelonyc/igz_sparkk8s</a></p><p id="184b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://collabnix.com/kubernetes-dashboard-on-docker-desktop-for-windows-2-0-0-3-in-2-minutes/" rel="noopener ugc nofollow" target="_blank">https://collab nix . com/kubernetes-dashboard-on-docker-desktop-for-windows-2-0-0-3-in-2-minutes/</a></p><p id="6c40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.oreilly.com/content/how-to-run-a-custom-version-of-spark-on-hosted-kubernetes/" rel="noopener ugc nofollow" target="_blank">https://www . oreilly . com/content/how-to-run-a-custom-version-of-spark-on-hosted-kubernetes/</a></p><h2 id="34d5" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak"> Docker桌面替代</strong></h2><p id="90f7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">最后。如果你只是想运行<em class="lv"> Kubernetes </em>那么你也可以使用<a class="ae ky" href="https://kubernetes.io/docs/setup/learning-environment/minikube/" rel="noopener ugc nofollow" target="_blank"> <em class="lv"> MiniKube </em> </a>。</p></div></div>    
</body>
</html>