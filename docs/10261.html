<html>
<head>
<title>Building A Websocket Channel in Golang to Stream Real-time Cryptocurrency Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Golang中构建Websocket通道以传输实时加密货币数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-a-websocket-channel-in-golang-to-stream-real-time-cryptocurrency-data-117841ef7806?source=collection_archive---------2-----------------------#2021-11-14">https://levelup.gitconnected.com/building-a-websocket-channel-in-golang-to-stream-real-time-cryptocurrency-data-117841ef7806?source=collection_archive---------2-----------------------#2021-11-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3fae" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">with WebSocket入门</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/623b75f4c4662889b5ec57afb55d7b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5L8Y-uCAwznxG811"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@wildbook?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Dmitry Demidko </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="78f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">加密货币数据更新非常快，我们总是需要获取最新的数据。传统的HTTP请求速度不够快，无法获得最新的数据。所以我们需要使用<strong class="lb iu"> WebSockets </strong>来获取实时数据。</p><p id="115e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将讨论如何在一个真实的例子中实现WebSocket。</p><h1 id="c7d2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是WebSockets？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/6f278e8ad4a2b991b2e64328a2ba80d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*pdGt1ny34IwVGV2frGBnRA.jpeg"/></div></figure><p id="daf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">WebSocket是一种允许客户端和服务器之间进行通信的协议。这是一个全双工协议，意味着双方都可以互相发送消息。通信连接是长期的。这意味着客户端和服务器之间的实时通信是可能的。</p><p id="12af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想了解更多关于WebSocket的细节，你可以阅读下面这篇文章。</p><div class="mo mp gp gr mq mr"><a href="https://blog.bitsrc.io/deep-dive-into-websockets-e6c4c7622423" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">深入研究WebSockets</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">了解每个开发人员都应该知道的WebSockets的重要属性</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">blog.bitsrc.io</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ks mr"/></div></div></a></div><h1 id="1132" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">WebSocket入门</h1><h2 id="11cf" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">先决条件</h2><ul class=""><li id="c115" class="ns nt it lb b lc nu lf nv li nw lm nx lq ny lu nz oa ob oc bi translated"><a class="ae ky" href="https://github.com/gorilla/websocket" rel="noopener ugc nofollow" target="_blank">大猩猩WebSocket包</a></li><li id="b6c5" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><a class="ae ky" href="https://docs.coincap.io/#9d1f0874-aa46-420c-9091-8bf9859c0743" rel="noopener ugc nofollow" target="_blank">coin cap trade web socket streams</a>API</li></ul><p id="a86c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的例子中。我们将连接到一个加密货币WebSocket服务器，并接收实时交易数据。</p><h2 id="85f0" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">步骤1:创建连接</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="288c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ok ol om on b">websocket.DefaultDialer.Dial</code>是<a class="ae ky" href="https://github.com/gorilla/websocket" rel="noopener ugc nofollow" target="_blank"> gorilla/WebSocket </a>包中的一个函数。它返回给定URL的新WebSocket连接。</p><h2 id="dad0" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">步骤2:数据建模</h2><p id="dd78" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">我们将要接收的数据流中的每个数据记录都是一个JSON字符串，它包含以下字段:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">交易对象</figcaption></figure><ul class=""><li id="be17" class="ns nt it lb b lc ld lf lg li or lm os lq ot lu nz oa ob oc bi translated"><code class="fe ok ol om on b">Exchange</code>:交易所名称，如币安、Bitfinex等。</li><li id="a160" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><code class="fe ok ol om on b">Base</code>:正在交易的货币，如比特币、dogecoin等。</li><li id="a075" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><code class="fe ok ol om on b">Quote</code>:被交易的货币，如比特币、dogecoin等。</li><li id="67c1" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><code class="fe ok ol om on b">Direction</code>:贸易的方向。可以是“买”也可以是“卖”。</li><li id="9022" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><code class="fe ok ol om on b">Price</code>:交易价格。</li><li id="4282" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><code class="fe ok ol om on b">Volume</code>:交易的报价币种金额。</li><li id="0015" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><code class="fe ok ol om on b">Timestamp</code>:交易的毫秒时间戳。</li><li id="87db" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><code class="fe ok ol om on b">PriceUsd</code>:以旧换新的美元价格。</li></ul><h2 id="8cda" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">第三步:流式数据</h2><p id="d83f" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">在这一部分中，我们将从WebSocket读取数据流，并将其发送到Golang通道。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><ul class=""><li id="16f9" class="ns nt it lb b lc ld lf lg li or lm os lq ot lu nz oa ob oc bi translated">1️⃣我们定义了一个渠道类型贸易。</li><li id="ee07" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated">2️⃣:我们定义了一个匿名函数，当收到新消息时调用这个函数。</li><li id="aa4c" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated">3️⃣ <code class="fe ok ol om on b">ReadMessage</code>的方法是从WebSocket连接中读取下一条消息。</li><li id="a185" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated">4️⃣:我们将消息解组到交易结构中。</li><li id="032e" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated">5️⃣:我们将贸易结构发送给渠道。</li><li id="669b" class="ns nt it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated">6️⃣，我们关闭频道。</li></ul><h2 id="9a83" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">第四步:数据管道</h2><p id="8861" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">在这个阶段，我们只过滤dogecoin交易，并将它们发送到输出通道，然后打印到控制台。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="7564" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章，并对WebSocket有所了解。如果您觉得这篇文章有用👏？看看我下面的其他文章吧！</p><div class="mo mp gp gr mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/how-does-golang-channel-works-6d66acd54753"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">Golang频道是如何工作的</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">了解戈朗通道的内部运作</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="na l"><div class="pb l nc nd ne na nf ks mr"/></div></div></a></div><div class="mo mp gp gr mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/solid-principles-in-golang-explained-by-examples-4a4cccf47388"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">举例说明戈兰语中的固体原理</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">对于有经验的程序员来说，这些坚实的原则并不陌生。它们为我们提供了如何安排功能和…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="na l"><div class="pc l nc nd ne na nf ks mr"/></div></div></a></div><div class="mo mp gp gr mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/observer-design-pattern-in-golang-with-an-example-6c24898059b1"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">Golang中的观察者设计模式及实例</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">在Golang中实现观察者设计模式</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="na l"><div class="pd l nc nd ne na nf ks mr"/></div></div></a></div></div></div>    
</body>
</html>