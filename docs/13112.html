<html>
<head>
<title>Use Golang to Capture a Screenshot of a Page with Dynamic Content and Required Login</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Golang捕获包含动态内容和所需登录的页面的屏幕截图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-capture-a-screenshot-for-a-required-login-dynamic-html-af792edd9b15?source=collection_archive---------0-----------------------#2022-08-08">https://levelup.gitconnected.com/how-to-capture-a-screenshot-for-a-required-login-dynamic-html-af792edd9b15?source=collection_archive---------0-----------------------#2022-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/21927d4a57520a1a800de666b0c4d70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kLv7b7pKY3WSLdZL"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@rirri01?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">里里</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8848" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">捕捉一个需要登录的页面的截图有时比你想象的要困难。</p><p id="ab3d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我推荐这款名为<a class="ae kf" href="https://github.com/chromedp/chromedp" rel="noopener ugc nofollow" target="_blank"> chromedp </a>的网络自动化工具来完成这项任务。</p><h1 id="7df7" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">什么是Chromedp</h1><blockquote class="mc"><p id="a52f" class="md me it bd mf mg mh mi mj mk ml ld dk translated">一种更快、更简单的方式来驱动支持Chrome DevTools协议的浏览器。'</p></blockquote><p id="0609" class="pw-post-body-paragraph kg kh it ki b kj mm kl km kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">简单来说，chromedp是一个高级Chrome DevTools协议客户端，它使用CDP简化了浏览器的驱动。</p><p id="a575" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它是一个用于Go的库，允许您自动处理网页，例如:</p><ul class=""><li id="93c8" class="mr ms it ki b kj kk kn ko kr mt kv mu kz mv ld mw mx my mz bi translated">网页抓取</li><li id="d73e" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">单击一个元素</li><li id="f746" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">填写并提交表格</li><li id="26d3" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">下载文件和图像</li><li id="ba5e" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">捕获页面的pdf</li><li id="dbe3" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">获取特定元素和整个浏览器视口的屏幕截图</li><li id="9bf8" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">评估javascript并检索结果</li></ul><h1 id="6f02" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">一些概念</h1><p id="fb96" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">在我们进入实际代码之前，让我们澄清一些概念。</p><h2 id="a8c9" class="nk lf it bd lg nl nm dn lk nn no dp lo kr np nq ls kv nr ns lw kz nt nu ma nv bi translated">静态网站</h2><figure class="nx ny nz oa gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nw"><img src="../Images/10089e8015cad4453985a18e64819dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cYsG8IyzB9sIxLf7.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图片来自<a class="ae kf" href="https://chandulanethmal.github.io/programming/web/Static-Dynamic-Websites/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="c6eb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">静态网站只有简单的静态资源文件，如服务器上托管的图像、CSS和JavaScript。</p><p id="a0c7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当用户访问静态网站时，浏览器向服务器请求特定页面。然后，web服务器将网页直接发送到浏览器，而不进行修改。</p><h2 id="9865" class="nk lf it bd lg nl nm dn lk nn no dp lo kr np nq ls kv nr ns lw kz nt nu ma nv bi translated">动态网站</h2><p id="8774" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">动态网站不一样；它们包含代码生成的内容，并且不是静态的。</p><p id="6596" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有两种类型的动态网站:</p><ul class=""><li id="bd7c" class="mr ms it ki b kj kk kn ko kr mt kv mu kz mv ld mw mx my mz bi translated">客户端脚本(JavaScript)驱动的网站</li><li id="63f1" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">服务器端脚本(PHP、Python、Ruby等。)驱动的网站</li></ul><h2 id="c0fc" class="nk lf it bd lg nl nm dn lk nn no dp lo kr np nq ls kv nr ns lw kz nt nu ma nv bi translated">必需的登录网站</h2><p id="a013" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">要求登录的网站是指要求用户登录后才能访问的网站。</p><p id="42f6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Gmail是需要登录的网站的一个例子。</p><figure class="nx ny nz oa gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/1e1353258226698dd57ab112ecd3953c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tIVC2k8vmpEOGK7c"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">斯蒂芬·菲利普斯-Hostreviews.co.uk在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="f57e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">弄脏手</h1><p id="02fd" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">我们今天的目标网站是谷歌分析营销<a class="ae kf" href="https://datastudio.google.com/u/0/reporting/0B_U5RNpwhcE6SF85TENURnc4UjA/preview" rel="noopener ugc nofollow" target="_blank">网站</a>，它跟踪一系列指标，如下所示。</p><p id="62c1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完整的代码是<a class="ae kf" href="https://gist.github.com/jerryan999/47bf118092655084ebfb9d17cdfcd606?file=full_code.go" rel="noopener ugc nofollow" target="_blank">这里</a></p><figure class="nx ny nz oa gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/1060a8403f0c7e778b1a0721afb75f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wY7GyiLXAgy4SQPiLhb3iQ.png"/></div></div></figure><ol class=""><li id="82f2" class="mr ms it ki b kj kk kn ko kr mt kv mu kz mv ld od mx my mz bi translated">我们需要首先安装必要的软件包。</li></ol><pre class="nx ny nz oa gt oe of og oh aw oi bi"><span id="560b" class="nk lf it of b gy oj ok l ol om">go get -u github.com/chromedp/chromedp</span></pre><p id="7be7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.主要的屏幕截图功能定义如下。</p><ul class=""><li id="c4f1" class="mr ms it ki b kj kk kn ko kr mt kv mu kz mv ld mw mx my mz bi translated">导航到目标网页。</li><li id="84f5" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">根据目标参数模拟视口大小。</li><li id="4f4f" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">睡10秒。</li><li id="bb8f" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">截图。</li></ul><figure class="nx ny nz oa gt ju"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="f378" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.截图调用部分很好理解。</p><figure class="nx ny nz oa gt ju"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="3e51" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.在chromedp对象的初始化中，有两点需要注意。</p><ul class=""><li id="0211" class="mr ms it ki b kj kk kn ko kr mt kv mu kz mv ld mw mx my mz bi translated">Chrome可执行路径被设置为默认的chrome路径。</li><li id="feb5" class="mr ms it ki b kj na kn nb kr nc kv nd kz ne ld mw mx my mz bi translated">用户数据目录也被设置为您的默认用户数据目录，在浏览器中输入<code class="fe op oq or of b">chrome://version</code>即可获得。</li></ul><figure class="nx ny nz oa gt ju"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="51b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想了解更多？查看chromedp <a class="ae kf" href="https://pkg.go.dev/github.com/chromedp/chromedp" rel="noopener ugc nofollow" target="_blank">文档</a>！</p></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><p id="1afe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你喜欢读这篇文章。如果你愿意支持我成为一名作家，可以考虑注册<a class="ae kf" href="https://jerryan.medium.com/membership" rel="noopener">成为</a>的媒体会员。你还可以无限制地访问媒体上的每个故事。</p></div></div>    
</body>
</html>