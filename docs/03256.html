<html>
<head>
<title>How to Setup a React SPA With TypeScript, Redux and Material-UI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用TypeScript，Redux和Material-UI设置一个React SPA</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-setup-a-react-spa-with-typescript-redux-and-material-ui-99a1e1ec7d54?source=collection_archive---------3-----------------------#2020-04-28">https://levelup.gitconnected.com/how-to-setup-a-react-spa-with-typescript-redux-and-material-ui-99a1e1ec7d54?source=collection_archive---------3-----------------------#2020-04-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d78" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将功能组件与TypeScript的强大功能结合起来</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f520db411177635b955a9390db5ae54f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDydHW5sYfpLBZ_HOF3Jzw.jpeg"/></div></div></figure><p id="f36d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文将指导您使用TypeScript、Redux、React-Router和Material-UI启动一个新的React.js应用程序。</p><p id="30d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文的所有代码都可以在<a class="ae lq" href="https://github.com/mariofonteles/react-redux-typescript-boilerplate" rel="noopener ugc nofollow" target="_blank"> this repository </a>上找到，下次您想快速开始使用您的应用程序时，可以将其用作样板文件！</p><h1 id="e6c5" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">入门指南</h1><p id="268a" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">首先，你需要Node.js和NPM，所以确保你已经安装并更新了它们。</p><p id="9ac4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们将使用<code class="fe mo mp mq mr b">create-react-app</code>来启动我们的新应用程序，因此执行以下命令:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="765c" class="mw ls it mr b gy mx my l mz na">npm install -g create-react-app</span><span id="9dab" class="mw ls it mr b gy nb my l mz na">create-react-app myApp --typescript</span><span id="f8dc" class="mw ls it mr b gy nb my l mz na">cd myApp</span></pre><p id="ebef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们从依赖项开始。在本应用中，我们将使用:</p><ul class=""><li id="05e1" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nh ni nj nk bi translated">反应路由器</li><li id="069a" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated">材料-用户界面</li><li id="6e4f" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated">Redux</li><li id="1778" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated">还原-Thunk</li></ul><p id="a1ec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将在后面详细解释为什么要使用这些方法。现在，让我们添加依赖项:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="a20f" class="mw ls it mr b gy mx my l mz na">npm install --save react-router-dom @material-ui/core redux react-redux redux-thunk</span></pre><p id="c668" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，由于我们正在使用TypeScript，我们需要为我们的一些包添加类型:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="c274" class="mw ls it mr b gy mx my l mz na">npm install --save-dev @types/react-router-dom @types/material-ui @types/redux @types/react-redux </span></pre><p id="2f8b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装完依赖项后，我们现在可以开始设置应用程序了。</p><h1 id="a701" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">设置</strong></h1><p id="1447" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">首先，我们需要修改我们的<code class="fe mo mp mq mr b">index.tsx</code>文件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="1ba3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里发生了很多事情，所以让我们把它分成几部分:</p><h1 id="4529" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">路由器</h1><p id="e15e" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">首先，我们将<code class="fe mo mp mq mr b">&lt;Router&gt;&lt;/Router&gt;</code>组件添加到文件中。这样，我们的路由器将能够正确地服务于我们的路由。</p><h1 id="05fe" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">材料-用户界面</h1><p id="c987" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">Material-UI是一个非常棒的React主题化工具，它有一个非常强大的文档和一组非常棒的组件。我们添加了<code class="fe mo mp mq mr b">&lt;ThemeProvider&gt;</code>、<code class="fe mo mp mq mr b">&lt;CssBaseline&gt;</code>组件和<code class="fe mo mp mq mr b">theme.tsx</code>文件，这样我们就可以为我们的应用程序提供定制的材质主题。</p><p id="9398" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">说到<code class="fe mo mp mq mr b">theme.tsx</code>文件，应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="6f5b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该文件负责设置整个应用程序可访问的任何全局<em class="ns">样式</em>规则或变量。</p><h1 id="4080" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">Redux</h1><p id="a4d5" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">最后，我们在组件树的顶层添加了<code class="fe mo mp mq mr b">&lt;Provider store={store}&gt;</code>。这样做的目的是设置Redux存储，这样我们就可以在任何地方访问actions和reducers。</p><p id="38a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mo mp mq mr b">store</code>由<code class="fe mo mp mq mr b">configureStore()</code>方法定义，我们像这样导入它:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="ca3d" class="mw ls it mr b gy mx my l mz na">import configureStore from './store/store';</span></pre><p id="8765" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">显然，那个文件还不存在，所以让我们创建它。</p><h1 id="d09c" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">定义我们的商店</h1><p id="8de8" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">首先，让我们在<code class="fe mo mp mq mr b">src</code>文件夹中创建一个<code class="fe mo mp mq mr b">store</code>文件夹，并在其中添加一个<code class="fe mo mp mq mr b">store.ts</code>文件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="ae9f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是事情开始变得有趣的地方。有了TypeScript，我们就有能力<em class="ns">键入</em>我们所有的动作和Reducers，以及存储本身。这意味着我们可以确保组件在任何时候都得到正确的支持，同时也使我们的代码更容易阅读和维护。让我们详细看看这段代码做了什么:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="c465" class="mw ls it mr b gy mx my l mz na">import { applyMiddleware, combineReducers, createStore, Store } from 'redux';</span><span id="3186" class="mw ls it mr b gy nb my l mz na">import thunk from 'redux-thunk'; </span><span id="687c" class="mw ls it mr b gy nb my l mz na">import { IBasicState, basicReducer } from '../reducers/basicReducer';</span></pre><p id="f8b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里我们从Redux导入必要的依赖项。您可能会注意到两件事:</p><ul class=""><li id="dfb7" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nh ni nj nk bi translated"><code class="fe mo mp mq mr b">redux-thunk</code>进口</li></ul><p id="52f8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="https://github.com/reduxjs/redux-thunk" rel="noopener ugc nofollow" target="_blank"> Thunk </a> <strong class="kw iu"> </strong>是一个很棒的Redux中间件。基本上，Thunk允许我们做的是在我们的操作中返回一个<code class="fe mo mp mq mr b">function</code>,而不是马上分派它。这使我们能够正确处理<code class="fe mo mp mq mr b">async</code>行为，比如<code class="fe mo mp mq mr b">axios</code>或<code class="fe mo mp mq mr b">fetch</code> REST API请求。</p><ul class=""><li id="1db1" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nh ni nj nk bi translated"><code class="fe mo mp mq mr b">reducers</code>进口</li></ul><p id="9eb1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们目前正在从位于<code class="fe mo mp mq mr b">reducers/basicReducer</code>的文件中导入两个东西:<code class="fe mo mp mq mr b">IBasicState</code>和<code class="fe mo mp mq mr b">basicReducer</code>。在我们推进商店之前，我们将为我们的第一个减压器定义一个基本的脚手架。</p><h1 id="a6d1" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">动作和减速器</h1><p id="c594" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">如你所知，Redux通过减速器的循环动作来工作。一个动作被分派，该动作被一个Reducer解析，任何订阅该动作的组件都将收到最终数据并相应地更新它们的状态。</p><p id="adad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们创建我们的第一个减速器，位于<code class="fe mo mp mq mr b">src/reducers/basicReducer.ts:</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="814f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们称为<code class="fe mo mp mq mr b">basicReducer.ts</code>的文件中，我们使用TypeScript接口来键入<code class="fe mo mp mq mr b">basicComponent</code>应该具有的状态。现在这是非常基本的，但是我们将在以后的后续文章中扩展它的功能。让我们来分解一下<code class="fe mo mp mq mr b">basicReducer()</code>功能:</p><ul class=""><li id="6d31" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nh ni nj nk bi translated">首先，我们定义<code class="fe mo mp mq mr b">Reducer&lt;IBasicState, BasicActions&gt;</code>。这确保了这个缩减器只能返回我们的基本状态定义，并响应我们稍后将创建的基本动作。该函数接收两个参数:<code class="fe mo mp mq mr b">state</code>，这是当前状态，或者默认情况下，是已定义的<code class="fe mo mp mq mr b">initialBasicState</code>。第二个参数是<code class="fe mo mp mq mr b">action</code>，是这个reducer应该响应什么的定义。</li><li id="211b" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated">然后，在<code class="fe mo mp mq mr b">switch()</code>语句中，我们比较<code class="fe mo mp mq mr b">action.type</code>属性以返回所需的状态属性来更新组件的状态。请注意，我们巧妙地使用了JavaScript spread操作符来返回整个状态，并在我们想要更改的属性旁边添加了<code class="fe mo mp mq mr b">...state</code>。</li></ul><p id="d231" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们定义我们的<code class="fe mo mp mq mr b">src/actions/basicActions.ts</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="a326" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这里，我们创建了一个基本模板，说明一个动作应该做什么，以及一个简单的动作类型。<code class="fe mo mp mq mr b">BasicActionTypes</code>应该为<code class="fe mo mp mq mr b">basicComponent</code>列举所有可能的动作。对于每个列举的动作，我们需要为该动作定义一个接口，如<code class="fe mo mp mq mr b">IBasicAnyAction</code>所示，它为<code class="fe mo mp mq mr b">ANY</code>动作定义了适当的类型。</p><p id="26ef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mo mp mq mr b">export type BasicActions = IBasicAnyAction</code>是我们对所有与基本组件相关的动作的类型定义。现在，我们只有<code class="fe mo mp mq mr b">ANY</code>动作，但是如果我们有一些其他的动作，比如说，由<code class="fe mo mp mq mr b">IBasicPushAction</code>接口定义的<code class="fe mo mp mq mr b">PUSH</code>动作，<code class="fe mo mp mq mr b">BasicActions</code>类型将如下所示:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="f359" class="mw ls it mr b gy mx my l mz na">export type BasicActions = IBasicAnyAction | IBasicPushAction</span></pre><p id="ed0d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们使用TypeScript联合类型来实现这一点。</p><p id="524e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，我们定义了<code class="fe mo mp mq mr b">basicAction</code>函数。这个函数使用Thunk返回一个<code class="fe mo mp mq mr b">async</code>函数，而不仅仅是立即分派动作，允许我们添加任何我们想要的逻辑。同样，我们只定义了一个动作类型，但是如果我们有更多的动作类型，我们需要为每个动作定义额外的函数。</p><h1 id="2bd4" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">回到商店</h1><p id="71c3" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">现在我们定义了我们的动作和Reducers，让我们再来看看我们的Redux存储:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="3e9f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mo mp mq mr b">IAppState</code>接口定义了我们的应用程序的根状态。现在，我们只有一个<code class="fe mo mp mq mr b">basicState</code>道具，由我们之前创建的<code class="fe mo mp mq mr b">IBasicState</code>接口定义。我们将在本文的第二部分展开这个状态。</p><p id="f497" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们定义我们的<code class="fe mo mp mq mr b">rootReducer</code>，它是一个常量，将我们所有的reducers组合成一个。我们在<code class="fe mo mp mq mr b">configureStore()</code>功能上使用它:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="9dbe" class="mw ls it mr b gy mx my l mz na">export default function configureStore(): Store&lt;IAppState, any&gt; <br/>{      <br/>const store = createStore(rootReducer, undefined,    applyMiddleware(thunk)); <br/>return store;<br/>}</span></pre><p id="87cc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个函数负责创建我们的商店和应用Thunk中间件。</p><h1 id="870f" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">定义应用程序组件</h1><p id="1835" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我们快到了！现在我们需要做的就是创建一个简单的应用程序组件，这样我们就可以测试我们的项目了。我们可以这样做:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="dfe7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这没什么特别的:这是<code class="fe mo mp mq mr b">create-react-app</code>应该为你创建的基本应用组件。</p><p id="0716" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要检查我们的应用程序是否正常工作，请在项目的根文件夹中运行以下命令:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="325d" class="mw ls it mr b gy mx my l mz na">npm start</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/0ae2cf09f68a8f613278f45d186a9d5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GRlPeG7yT634Q3dygbrpIg.png"/></div></div></figure><p id="8c41" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">而且很管用！您已经成功启动了一个包含TypeScript、Redux、React-Router和Material-UI的React应用程序。</p><h1 id="1f0d" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">后续步骤</h1><p id="c206" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在本文的下一部分，我们将创建一些功能组件，并使用React钩子与Redux存储进行交互。</p></div></div>    
</body>
</html>