<html>
<head>
<title>Swift | Making an API Call and Fetching JSON</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift |进行API调用并获取JSON</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/swift-making-an-api-call-and-fetching-json-acd364c77a71?source=collection_archive---------1-----------------------#2022-02-07">https://levelup.gitconnected.com/swift-making-an-api-call-and-fetching-json-acd364c77a71?source=collection_archive---------1-----------------------#2022-02-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/199e216ee5bf72e3d8c2aa65e5eb7784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qcq1sSrwhfVcb73PowpWFA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@barnimages?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">谷仓图片</a>在<a class="ae kc" href="https://unsplash.com/s/photos/http?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="dcf6" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">API和REST(RESTful)API</h1><h2 id="ee71" class="lb ke iq bd kf lc ld dn kj le lf dp kn lg lh li kr lj lk ll kv lm ln lo kz lp bi translated"><strong class="ak"> API </strong></h2><p id="be33" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma lg mb mc md lj me mf mg lm mh mi mj mk ij bi translated">也称为应用程序编程接口，是软件中使用的一组协议和功能，用于帮助与其他软件进行交互。</p><h2 id="8bff" class="lb ke iq bd kf lc ld dn kj le lf dp kn lg lh li kr lj lk ll kv lm ln lo kz lp bi translated"><strong class="ak"> RESTful API </strong></h2><p id="22d1" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma lg mb mc md lj me mf mg lm mh mi mj mk ij bi translated">简称为<strong class="ls ir">Re</strong>presentational<strong class="ls ir">S</strong>state<strong class="ls ir">T</strong>transfer API，是一个基于客户端服务器的API，使用URIs、HTTP协议和JSON从web访问数据。</p><p id="d556" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">Restful APIs通过HTTP动词(GET、POST、PUT、DELETE、PATCH)执行CRUD，通过XML或JSON文件交换数据。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="2926" class="lb ke iq mv b gy mz na l nb nc">POST :Request a URI with POST creates a resource </span><span id="8a5d" class="lb ke iq mv b gy nd na l nb nc">GET: Retrieves the resource and gets detailed information about the document. </span><span id="30b6" class="lb ke iq mv b gy nd na l nb nc">PUT: Replaces all current representation. Causes change in state(Updates information) -&gt; always call POST to view changes </span><span id="f061" class="lb ke iq mv b gy nd na l nb nc">DELETE: Deletes information from server.</span></pre><p id="8236" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">例子</p><p id="bca4" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">考虑一个管理学生资源的API。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="4be9" class="lb ke iq mv b gy mz na l nb nc">{<br/>  "id": 1,<br/>  "firstName": "Tyrion",<br/>  "lastName": "Lannister",<br/>  "classes": [<br/>    {"id": 1, "name": "History of Westeros"}, <br/>    {"id": 2, "name": "Brewing"}, <br/>    {"id": 3, "name": "High Valyrian 101"}<br/>  ]<br/>}</span></pre><ul class=""><li id="56ad" class="ne nf iq ls b lt ml lx mm lg ng lj nh lm ni mk nj nk nl nm bi translated">[POST]/学生:创建新学生</li><li id="fe09" class="ne nf iq ls b lt nn lx no lg np lj nq lm nr mk nj nk nl nm bi translated">[GET]/学生:调用整个学生列表</li><li id="3986" class="ne nf iq ls b lt nn lx no lg np lj nq lm nr mk nj nk nl nm bi translated">[GET]/学生:叫第一个学生</li><li id="c1ae" class="ne nf iq ls b lt nn lx no lg np lj nq lm nr mk nj nk nl nm bi translated">[PUT]/students/1:编辑关于学生1的信息</li><li id="e3ce" class="ne nf iq ls b lt nn lx no lg np lj nq lm nr mk nj nk nl nm bi translated">[DELETE]/students/1:删除学生1</li></ul></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="69d1" class="kd ke iq bd kf kg nz ki kj kk oa km kn ko ob kq kr ks oc ku kv kw od ky kz la bi translated">正在获取JSON</h1><p id="dfea" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma lg mb mc md lj me mf mg lm mh mi mj mk ij bi translated">我将使用<a class="ae kc" href="https://jsonplaceholder.typicode.com" rel="noopener ugc nofollow" target="_blank"> JSONPlaceholder API </a>，这是一个用于原型和测试数据的免费REST API。他们提供的API之一是<a class="ae kc" href="https://jsonplaceholder.typicode.com/posts" rel="noopener ugc nofollow" target="_blank"> posts API </a>，看起来像这样。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="7bfa" class="lb ke iq mv b gy mz na l nb nc">{<br/>    "userId": 1,<br/>    "id": 1,<br/>    "title": "sunt aut facere repellat provident occaecati excepturi optio reprehenderit",<br/>    "body": "quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto"</span><span id="f293" class="lb ke iq mv b gy nd na l nb nc">  }</span></pre><p id="828f" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">创建一个名为Post的模型，它符合<strong class="ls ir">可编码协议。</strong>Codable<strong class="ls ir"/>协议用于编码(从Swift到other(JSON))和解码(从other(JSON)到Swift)我们从API获得的数据。你可以选择你想从API中获取的数据，我已经决定获取所有的数据，包括用户Id、id、标题和主体。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="32aa" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">苹果创建了一个名为<strong class="ls ir"> URLSession </strong>的会话来帮助IOS程序与服务器通信。它支持HTTP协议，这是我们访问RESTful APIs时所需要的。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="oe of l"/></div></figure><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="9f7f" class="lb ke iq mv b gy mz na l nb nc"><strong class="mv ir">{</strong></span><span id="8c0a" class="lb ke iq mv b gy nd na l nb nc"><strong class="mv ir">"userId": 1,<br/>"id": 1,<br/>"title": "sunt aut facere repellat provident occaecati excepturi optio reprehenderit",<br/>"body": "quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto"</strong></span><span id="c68f" class="lb ke iq mv b gy nd na l nb nc"><strong class="mv ir">}</strong></span></pre><h1 id="eec8" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">解码JSON</h1><p id="ca4b" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma lg mb mc md lj me mf mg lm mh mi mj mk ij bi translated">上面的代码只是使用苹果的URL会话从一个API获取数据。让我们试着解码数据。我们需要解码数据，因为它是以JSON格式编写的，我们使用的是Swift。为此，我们将使用<strong class="ls ir"> JSONDecoder() </strong>，这是一个从JSON对象中解码数据的对象。对于这个例子，我将使用<a class="ae kc" href="https://jsonplaceholder.typicode.com/posts" rel="noopener ugc nofollow" target="_blank"> full post API。</a></p><p id="99e5" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">在这里，我收集了每一个实例，对其进行解码，并打印出帖子的标题。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="oe of l"/></div></figure><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="059c" class="lb ke iq mv b gy mz na l nb nc"><strong class="mv ir">sunt aut facere repellat provident occaecati excepturi optio reprehenderit<br/>qui est esse<br/>ea molestias quasi exercitationem repellat qui ipsa sit aut<br/>eum et est occaecati<br/>nesciunt quas odio<br/>......</strong></span></pre></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="ade3" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">这就是我对这个会议的全部内容，我希望它真的有所帮助！获取和解码JSON数据可能会令人困惑，但是如果你练习的话，它真的很有帮助！</p><p id="bf11" class="pw-post-body-paragraph lq lr iq ls b lt ml lv lw lx mm lz ma lg mn mc md lj mo mf mg lm mp mi mj mk ij bi translated">如果你在yu24c@mtholyoke.edu有任何问题，请告诉我。感谢你阅读这篇文章！</p></div></div>    
</body>
</html>