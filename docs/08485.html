<html>
<head>
<title>Speedy Tip: How to Loop Through a JSON Response in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">快速技巧:如何在JavaScript中遍历JSON响应</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/speedy-tip-how-to-loop-through-a-json-response-in-javascript-1963c9b728?source=collection_archive---------8-----------------------#2021-05-06">https://levelup.gitconnected.com/speedy-tip-how-to-loop-through-a-json-response-in-javascript-1963c9b728?source=collection_archive---------8-----------------------#2021-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="052a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当从远处的工作人员那里获得信息时，工作人员的反应通常会出现在JSON design中。在这篇快速技巧文章中，我将展示如何利用JavaScript来解析工作人员的反应，以获得您需要的信息。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/e0f1dcc8712fc6ea4a2b213c1b1c54df.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*4MgUozUh71sdgiZkGPyLdQ.png"/></div></div></figure><p id="a929" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个过程通常由两个步骤组成:将数据解码为原生结构(比如数组或对象)，然后使用JavaScript的一个内置方法遍历该数据结构。在本文中，我将使用大量可运行的示例来涵盖这两个步骤。</p><h1 id="047a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">JSON是什么？</h1><p id="ec62" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在我们研究如何处理JSON之前，让我们花一点时间来理解它是什么(以及它不是什么)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ma"><img src="../Images/a80ca2d7ba603ac0830c26ba07d52ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BpipjYeduZ-7vk4e8K6m-w.png"/></div></div></figure><p id="0b07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JSON代表“JavaScript对象符号”。它是一种独立于语言、基于文本的格式，通常用于在web应用程序中传输数据。JSON的灵感来自JavaScript对象文字符号，但两者之间存在差异。例如，在JSON中，键必须用双引号括起来，而在object literals中却不是这样。</p><h2 id="81bb" class="mb ky iq bd kz mc md dn ld me mf dp lh jy mg mh ll kc mi mj lp kg mk ml lt mm bi translated">在JSON中有两种存储数据的方式:</h2><p id="fefd" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">名称/值对的集合(也称为JSON对象)<br/>值的有序列表(也称为JSON数组)<br/>当从web服务器接收数据时，数据总是一个字符串，这意味着您的工作是将其转换成您可以使用的数据结构。</p><p id="8cd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想了解更多关于JSON的工作原理，请访问JSON网站。</p><h2 id="395f" class="mb ky iq bd kz mc md dn ld me mf dp lh jy mg mh ll kc mi mj lp kg mk ml lt mm bi translated">从远程API获取JSON</h2><p id="7097" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在下面的例子中，我们将使用奇妙的icanhazdadjoke API。正如您在它的文档中所看到的，发出一个GET请求，其中Accept头设置为application/JSON，将会看到API返回一个JSON有效负载。</p><p id="5350" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从一个简单的例子开始:</p><pre class="km kn ko kp gt mn mo mp mq aw mr bi"><span id="1d0d" class="mb ky iq mo b gy ms mt l mu mv">const xhr = new XMLHttpRequest();<br/>xhr.onreadystatechange = () =&gt; {<br/>  if (xhr.readyState === XMLHttpRequest.DONE) {<br/>    console.log(typeof xhr.responseText);<br/>    console.log(xhr.responseText);<br/>  }<br/>};<br/>xhr.open('GET', 'https://icanhazdadjoke.com/', true);<br/>xhr.setRequestHeader('Accept', 'application/json');<br/>xhr.send(null);</span></pre><p id="6282" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mw mx my mo b">// string<br/>// {"id":"daaUfibh","joke":"Why was the big cat disqualified from the race? Because it was a cheetah.","status":200}</code></p><p id="da1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们所看到的，服务器返回给我们一个字符串。我们需要将它解析成一个JavaScript对象，然后才能遍历它的属性。我们可以用JSON.parse()做到这一点:</p><pre class="km kn ko kp gt mn mo mp mq aw mr bi"><span id="b0af" class="mb ky iq mo b gy ms mt l mu mv">if (xhr.readyState === XMLHttpRequest.DONE) {<br/>  const res = JSON.parse(xhr.responseText);<br/>  console.log(res);<br/>};</span><span id="bf61" class="mb ky iq mo b gy mz mt l mu mv">// Object { id: "fiyPR7wPZDd", joke: "When does a joke become a dad joke? When it becomes apparent.", status: 200 }</span></pre><p id="41db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们有了作为JavaScript对象的响应，就有很多方法可以用来遍历它。</p><p id="a856" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用一个<a class="ae na" href="https://dev.to/fariharajput/speedy-tip-how-to-loop-through-a-json-response-in-javascript-6a1" rel="noopener ugc nofollow" target="_blank"> for…in循环</a> <br/>一个for…in循环遍历一个对象的所有可枚举属性:</p><pre class="km kn ko kp gt mn mo mp mq aw mr bi"><span id="72bb" class="mb ky iq mo b gy ms mt l mu mv">const res = JSON.parse(xhr.responseText);</span><span id="7654" class="mb ky iq mo b gy mz mt l mu mv">for (const key in res){<br/>  if(obj.hasOwnProperty(key)){<br/>    console.log(`${key} : ${res[key]}`)<br/>  }<br/>}</span><span id="dc08" class="mb ky iq mo b gy mz mt l mu mv">// id : H6Elb2LBdxc<br/>// joke : What's blue and not very heavy?  Light blue.<br/>// status : 200</span></pre><p id="011e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意for…of循环将遍历整个原型链，所以这里我们使用hasOwnProperty来确保该属性属于我们的res对象。</p><p id="378f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Object.entries、Object.values或Object.entries <br/>上述方法的另一种方法是使用Object.keys()、Object.values()或Object.entries()之一。这些将返回一个数组，然后我们可以迭代。</p><p id="6399" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看如何使用Object.entries。这将返回我们传递给它的对象的键/值对的数组:</p><pre class="km kn ko kp gt mn mo mp mq aw mr bi"><span id="c202" class="mb ky iq mo b gy ms mt l mu mv">const res = JSON.parse(xhr.responseText);</span><span id="02d3" class="mb ky iq mo b gy mz mt l mu mv">Object.entries(res).forEach((entry) =&gt; {<br/>  const [key, value] = entry;<br/>  console.log(`${key}: ${value}`);<br/>});</span><span id="e2b6" class="mb ky iq mo b gy mz mt l mu mv">// id: SvzIBAQS0Dd <br/>// joke: What did the pirate say on his 80th birthday? Aye Matey!<br/>// status: 200</span></pre><p id="ce63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意const [key，value]= entry；该语法是ES2015语言中引入的数组析构的一个示例。</p><p id="b60a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这要简洁得多，避免了前面提到的原型问题，并且是我首选的遍历JSON响应的方法。</p><p id="9282" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Fetch API <br/>虽然上面使用XMLHttpRequest对象的方法工作得很好，但它会很快变得难以处理。我们可以做得更好。</p></div></div>    
</body>
</html>