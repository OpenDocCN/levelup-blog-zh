<html>
<head>
<title>Comparing Container Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比较容器管道</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/comparing-container-pipelines-3ff5ee8ddd26?source=collection_archive---------18-----------------------#2020-03-19">https://levelup.gitconnected.com/comparing-container-pipelines-3ff5ee8ddd26?source=collection_archive---------18-----------------------#2020-03-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f2bc48482164aae9a74db3d812a66360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hd3vYCJhOs5RKzOKWFi8zw.jpeg"/></div></div></figure><h1 id="fbd7" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">介绍</h1><p id="2087" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">容器给DevOps带来了巨大的转变，它允许团队比以前更快地交付代码。然而，我们仍然必须经历构建、打包和部署这些容器的过程。这就是我们使用容器管道的原因。</p><p id="f43f" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">然而，对于容器管道，有许多不同的选择。我们如何知道使用哪一个？在本文中，我们将比较六种选择，并介绍每种选择的配置、优点、局限性和定价。</p><h1 id="00e1" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是容器管道？</h1><p id="2f50" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">首先，让我们谈谈什么是真正的容器管道。管道有助于软件开发过程中各个阶段的自动化，尤其是持续集成和持续交付(CI/CD)。</p><p id="34b2" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">容器管道自动化了容器部署过程中的每个阶段，从构建初始映像到部署到生产。</p><p id="3c19" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">通常，整个容器管道由三个阶段组成:</p><ul class=""><li id="16d9" class="mc md it lb b lc lx lg ly lk me lo mf ls mg lw mh mi mj mk bi translated">集成:变更被签入源代码控制，触发构建过程和单元测试。</li><li id="7ba7" class="mc md it lb b lc ml lg mm lk mn lo mo ls mp lw mh mi mj mk bi translated">验收测试:将容器部署到测试环境中，并验证其功能。</li><li id="cddb" class="mc md it lb b lc ml lg mm lk mn lo mo ls mp lw mh mi mj mk bi translated">部署:将经过全面测试的最终映像部署到生产环境中。</li></ul><p id="6107" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">容器管道工具通常至少提供三种中的两种，但它们可以有所不同。</p><p id="0e82" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">现在让我们看看我们的六个选择。</p><h1 id="e928" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">1.赫罗库</h1><p id="5554" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">Heroku 是一个完整的集装箱管道，利用<a class="ae mq" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">码头工人</a>。您可以在同一个平台上构建、测试、验证和部署容器，而无需提供硬件或利用不同的服务提供商。</p><p id="c4d9" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">配置</strong></p><p id="631b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Heroku应用程序是使用一个<a class="ae mq" href="https://devcenter.heroku.com/articles/build-docker-images-heroku-yml" rel="noopener ugc nofollow" target="_blank"> heroku.yml </a>清单配置的，它定义了构建和部署容器所需的步骤。具有自定义docker文件的应用程序清单可能如下所示:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="c4e0" class="na kc it mw b gy nb nc l nd ne">build:<br/>  docker:<br/>    web: Dockerfile</span></pre><p id="741e" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">要使用Git 部署这个容器，只需运行:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="6842" class="na kc it mw b gy nb nc l nd ne">$ heroku stack:set container</span><span id="28e8" class="na kc it mw b gy nf nc l nd ne">$ git add heroku.yml</span><span id="dc27" class="na kc it mw b gy nf nc l nd ne">$ git commit -m "Add heroku.yml"</span><span id="9b7d" class="na kc it mw b gy nf nc l nd ne">$ git push heroku master</span></pre><p id="1b36" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Heroku还支持<a class="ae mq" href="https://devcenter.heroku.com/articles/pipelines" rel="noopener ugc nofollow" target="_blank">管道</a>，它允许您将一个容器部署到多个不同的环境中，以反映连续交付工作流中的各个阶段。例如，在部署到生产环境之前，您可以使用管道来测试临时环境中的更改。</p><p id="412b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">优点和局限性</strong></p><p id="38e8" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Heroku非常容易使用，整个管道只需要一个YAML文件。它是完全托管的，提供了测试和部署变更的多种环境，甚至允许您在部署失败的情况下<a class="ae mq" href="https://devcenter.heroku.com/articles/releases#rollback" rel="noopener ugc nofollow" target="_blank">回滚变更</a>。</p><p id="e569" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">然而，并不是所有的Heroku特性都支持Docker部署。例如，您不能使用<a class="ae mq" href="https://devcenter.heroku.com/articles/heroku-ci#docker-deploys" rel="noopener ugc nofollow" target="_blank"> Heroku CI </a>来运行您的应用程序的测试套件，这意味着要么在构建映像的同时运行测试套件，要么使用<a class="ae mq" href="https://docs.docker.com/develop/develop-images/multistage-build/" rel="noopener ugc nofollow" target="_blank">多阶段构建</a>。您也不能使用<a class="ae mq" href="https://devcenter.heroku.com/articles/pipelines#promoting" rel="noopener ugc nofollow" target="_blank">管道提升</a>将容器从一个管道阶段提升到下一个管道阶段。相反，您必须将容器重新部署到目标阶段。</p><p id="8884" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">定价</strong></p><p id="234b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Heroku <a class="ae mq" href="https://www.heroku.com/pricing" rel="noopener ugc nofollow" target="_blank">为一个web dyno和一个worker dyno提供了一个每月1000小时的免费计划</a>。付费计划起价为每月7美元，并提供额外的功能，如更大容量的dyno和改进的可扩展性。有关更多信息，请参见Heroku的<a class="ae mq" href="https://www.heroku.com/pricing" rel="noopener ugc nofollow" target="_blank">定价页面</a>。</p><p id="a26a" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">我的拍摄</strong></p><p id="0af0" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Heroku是一个非常简单且经济高效的容器管道解决方案。它让您能够完全控制CI/CD流程，同时提供一个完全受管理的环境。有了免费层和<a class="ae mq" href="https://www.heroku.com/pricing#support" rel="noopener ugc nofollow" target="_blank">免费标准支持</a>，值得一试。</p><h1 id="18bb" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">2.Azure DevOps</h1><p id="18d1" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><a class="ae mq" href="https://azure.microsoft.com/en-us/services/devops/" rel="noopener ugc nofollow" target="_blank"> Azure DevOps </a>是微软针对项目管理、源代码管理(SCM)和CI/CD的一体化服务。它允许您控制DevOps生命周期中的几乎每个阶段，同时提供许多高级的特定于容器的功能，包括私有<a class="ae mq" href="https://azure.microsoft.com/en-us/services/container-registry/" rel="noopener ugc nofollow" target="_blank">容器注册中心</a>和与Azure Kubernetes服务(AKS)的集成。Azure Pipelines 提供平台的CI/CD服务。</p><p id="8360" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">配置</strong></p><p id="82e0" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">所有的Azure DevOps都可以使用基于web的用户界面来管理，但你也可以使用签入你的应用程序源代码的基于YAML的清单来配置Azure管道。web UI允许您管理和跟踪部署环境和发布版本、工件等等。</p><p id="ccca" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">优点和局限性</strong></p><p id="59ed" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">如果你的团队已经在使用Azure，那么Azure DevOps就是你现有工作流程的自然延伸。它支持托管和本地安装，还支持许多Azure部署目标，包括Azure App Service、Kubernetes和Azure Functions。</p><p id="c6cd" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">然而，与其他服务(包括Azure服务)的集成并不简单。在Azure DevOps中配置一个集成需要你复制和粘贴值，甚至从Azure Container Registry这样的服务中复制和粘贴值，这使它感觉不那么内聚，并且更难设置。</p><p id="9085" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">定价</strong></p><p id="1397" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Azure Pipelines提供了一个免费层，包含一个免费并发CI/CD作业和每月1800分钟。额外的工作花费40美元，托管工件(如图像)每月每GB花费2美元。像Azure Boards这样的附加服务需要额外的月费。要了解更多信息，请访问<a class="ae mq" href="https://azure.microsoft.com/en-us/pricing/details/devops/azure-devops-services/" rel="noopener ugc nofollow" target="_blank"> Azure DevOps服务定价</a>页面。</p><p id="6d6b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">我的拍摄</strong></p><p id="ec1a" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Azure DevOps非常适合想要一体化DevOps管理解决方案的团队，或者已经在使用Azure的团队。通过将它集中在一个位置，它极大地简化了开发生命周期。然而，它可能很难设置，并且对于只需要基本容器管道的团队来说可能过于复杂。</p><h1 id="174f" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">3.GitLab CI/CD</h1><p id="a5b6" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">GitLab 最初是一个开源的SCM，但很快成长为一个完整的DevOps管理解决方案。像Azure DevOps一样，它提供了项目管理、私有容器注册和编排的构建环境(包括Kubernetes)等功能。</p><p id="bd37" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">配置</strong></p><p id="edf0" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">GitLab CI/CD由<a class="ae mq" href="https://docs.gitlab.com/runner/" rel="noopener ugc nofollow" target="_blank"> GitLab Runner </a>提供支持，它在一个自包含的环境中执行CI/CD管道中的每个步骤。通过<a class="ae mq" href="https://docs.gitlab.com/ee/ci/yaml/README.html" rel="noopener ugc nofollow" target="_blank">完成配置。gitlab-ci.yml </a> manifest，它支持一些高级配置，包括条件逻辑和导入其他清单。</p><p id="7e41" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">或者，您可以使用<a class="ae mq" href="https://docs.gitlab.com/ee/topics/autodevops/" rel="noopener ugc nofollow" target="_blank"> Auto DevOps </a>在没有配置的情况下自动化您的整个管道。GitLab使用<a class="ae mq" href="https://devcenter.heroku.com/articles/buildpacks" rel="noopener ugc nofollow" target="_blank"> Heroku buildpacks </a>(通过<a class="ae mq" href="https://github.com/gliderlabs/herokuish" rel="noopener ugc nofollow" target="_blank"> Herokuish </a>)自动确定如何基于源代码(在本例中是Dockerfile)构建您的应用程序。Auto DevOps可以自动运行单元测试，执行代码质量分析，并扫描图像以发现安全问题。</p><p id="915f" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">对于部署，GitLab使用<a class="ae mq" href="https://github.com/travis-ci/dpl" rel="noopener ugc nofollow" target="_blank"> dpl </a>工具，该工具支持广泛的提供商，包括云平台和Kubernetes集群。</p><p id="af8b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">优点和局限性</strong></p><p id="332c" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">GitLab提供了一个极其灵活的管道，您可以使用内置工具自行配置或完全自动化。YAML配置允许更大范围的项目结构和步骤，例如创建项目依赖关系和<a class="ae mq" href="https://docs.gitlab.com/ee/ci/pipelines.html#multi-project-pipelines-premium" rel="noopener ugc nofollow" target="_blank">合并来自不同项目的多个管道</a>。因为GitLab使用现有的开源工具，如Herokuish和dpl，所以它支持广泛的项目类型、语言和部署目标。</p><p id="b64b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">虽然GitLab可以将Runners和工件部署到现有的环境中，但是它不能自己供应或维护那些环境(Google Kubernetes引擎和Amazon Elastic Kubernetes服务除外)。它也缺乏图形化的管道配置工具，这使得管道管理不如Azure Pipelines等工具直观。</p><p id="8b77" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">定价</strong></p><p id="c5d2" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">GitLab使用开放核心模型:它提供一个开源基础版本和一个带有附加功能的付费企业版本。对于付费计划，<a class="ae mq" href="https://about.gitlab.com/pricing/#gitlab-com" rel="noopener ugc nofollow" target="_blank">定价</a>根据用户数量、每月运行CI渠道的分钟数以及对特定功能的访问情况进行分级。所有计划包括无限的代码库、项目规划工具和每月2000分钟的免费管道时间。付费计划从每个用户每月4美元到每个用户每月99美元不等。</p><p id="109b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">我的拍摄</strong></p><p id="d9d6" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">GitLab是一个非常通用和强大的CI/CD工具，包含非常有用的功能。开源版本的功能足够丰富，可以与许多商业选项竞争，同时还允许您进行自我托管。但是，它要求您维护一个单独的部署环境。</p><h1 id="8f4f" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">4.AWS弹性豆茎</h1><p id="6d00" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">弹性豆茎与其说是一个管道，不如说是一个编排AWS资源的工具。它可以自动供应、负载平衡、扩展和监控ECS容器、S3存储桶和EC2实例等资源。这允许您根据自己的特定需求在AWS中创建一个完全定制的管道。</p><p id="af93" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">配置</strong></p><p id="b6c9" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Beanstalk配置描述了如何部署容器以及部署容器的环境。这在一个<a class="ae mq" href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker_v2config.html" rel="noopener ugc nofollow" target="_blank"> Dockerrun.aws.json </a>文件中定义。Beanstalk引入了独特的<a class="ae mq" href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/concepts.html" rel="noopener ugc nofollow" target="_blank">概念</a>，例如:</p><p id="fd14" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">应用程序:Beanstalk组件的逻辑集合，比如环境和版本。应用程序版本:源代码的可部署版本。环境:运行应用程序版本所需的AWS资源集。优点和局限性</p><p id="1ef9" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Beanstalk不仅对于Docker，而且对于AWS都是一个非常强大的工具。它提供自动扩展、滚动更新、监控和发布管理。它还允许您直接访问和管理资源。</p><p id="aa9a" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">然而，Beanstalk比普通管道更复杂。您需要在映像存储库中预构建和托管Docker映像，除非您使用的是<a class="ae mq" href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/single-container-docker.html" rel="noopener ugc nofollow" target="_blank">单容器环境，</a>和容器版本与环境紧密耦合。您只能通过Beanstalk CLI触发更新；因此，如果容器出现故障，您需要使用Beanstalk控制台手动解决它。</p><p id="db7f" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">定价</strong></p><p id="cf90" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Beanstalk本身是免费的，但是它提供的AWS组件是按正常价格定价的。例如，如果您为您的环境配置了ECS节点和ELB负载平衡器，您将像正常调配一样为节点和负载平衡器付费。</p><p id="f2ba" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">我的拍摄</strong></p><p id="8d15" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">有了大量可用的AWS服务，Beanstalk提供了管理所有这些服务的好方法。当作为编排工具使用时，它可能非常强大，但是作为容器管道使用时，它可能太复杂了。</p><h1 id="3492" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">5.谷歌云构建</h1><p id="cd7a" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><a class="ae mq" href="https://cloud.google.com/cloud-build" rel="noopener ugc nofollow" target="_blank"> Cloud Build </a>是构建在谷歌云平台(GCP)上的一个相对基础的容器CI服务。它可以直接从源代码或other文件构建映像，并直接部署到GKE、云运行和其他GCP服务。</p><p id="52c2" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">配置</strong></p><p id="2c1b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">云构建是通过一个<a class="ae mq" href="https://cloud.google.com/cloud-build/docs/build-config" rel="noopener ugc nofollow" target="_blank"> cloudbuild.yaml </a>(或JSON)文件配置的。您可以定义构建图像的过程，以及存储结果图像的位置。例如，构建Docker映像并将其推送到Google Container Registry非常简单:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="e20d" class="na kc it mw b gy nb nc l nd ne">steps:<br/>- name: gcr.io/cloud-builders/docker<br/>  args: ['build', '-t', 'gcr.io/$PROJECT_ID/myimage', '.']<br/>images: ['gcr.io/$PROJECT_ID/myimage']</span></pre><p id="2c4b" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">云构建支持<a class="ae mq" href="https://cloud.google.com/cloud-build/docs/running-builds/create-manage-triggers" rel="noopener ugc nofollow" target="_blank">触发器</a>，它自动启动对源代码的构建。</p><p id="02cd" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">好处和局限</strong></p><p id="9992" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">云构建灵活<a class="ae mq" href="https://cloud.google.com/cloud-build/docs/how-to#deploying-builds" rel="noopener ugc nofollow" target="_blank">与其他GCP服务</a>集成，包括GKE、应用引擎和云运行。您可以直接控制构建机器的大小和容量，还可以通过<a class="ae mq" href="https://cloud.google.com/cloud-build/docs/kaniko-cache" rel="noopener ugc nofollow" target="_blank">缓存图像层</a>来加快构建速度。您还可以运行<a class="ae mq" href="https://cloud.google.com/cloud-build/docs/build-debug-locally" rel="noopener ugc nofollow" target="_blank">本地构建</a>来验证或调试您的构建，然后再推进到云运行。</p><p id="93a1" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">因为云构建是围绕GCP构建的，所以它只支持有限数量的部署目标。将容器部署到其他平台是可能的，但是需要额外的步骤。另外，和GitLab一样，Cloud Build也没有可视化的管道配置工具。</p><p id="0b90" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">定价</strong></p><p id="227a" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><a class="ae mq" href="https://cloud.google.com/cloud-build/pricing" rel="noopener ugc nofollow" target="_blank">定价</a>基于您的构建机器的大小和构建时间。一个标准的n1-standard-1实例每构建分钟花费0.003美元，在n1-highcpu-32实例上高达0.064美元。在n1-standard-1实例上，您每天还可以获得120分钟的免费构建时间。</p><p id="8bd2" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">我的拍摄</strong></p><p id="63d7" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">云构建相对简单，但这也是它的优势之一。它很快，容易学习，相当便宜，并与其他GCP服务很好地集成。如果您已经有了一个部署环境，或者已经利用了GCP，我建议您尝试一下。</p><h1 id="4395" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">6.詹金斯X</h1><p id="af56" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><a class="ae mq" href="https://jenkins-x.io/" rel="noopener ugc nofollow" target="_blank"> Jenkins </a>是目前最流行的CI/CD工具之一，Jenkins X通过添加全面的Kubernetes集成进一步扩展了它。Jenkins X不仅可以部署到Kubernetes，还可以为您提供和管理Kubernetes集群。</p><p id="6ba4" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">配置</strong></p><p id="3483" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Jenkins X管道建立在<a class="ae mq" href="https://tekton.dev/" rel="noopener ugc nofollow" target="_blank"> Tekton管道</a>之上，帮助在Kubernetes上运行CI/CD管道。您可以使用一个<a class="ae mq" href="https://jenkins-x.io/docs/reference/pipeline-syntax-reference/" rel="noopener ugc nofollow" target="_blank"> jenkins-x.yml </a>文件来配置您的管道(与传统的Jenkinsfile相比)。Jenkins X还提供了<a class="ae mq" href="https://jenkins-x.io/docs/reference/components/build-packs//" rel="noopener ugc nofollow" target="_blank">构建包</a>，可以帮助将源代码打包成映像，然后部署到Kubernetes。</p><p id="eeb3" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">优点和局限性</strong></p><p id="e632" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Jenkins X利用两个流行的现有项目——Jenkins和Kubernetes——创建一个可扩展的CI/CD平台。它可以自动化整个CI/CD渠道，并支持预览环境和渠道促销。因为它包括Jenkins，所以它可以访问整个Jenkins开发人员社区。</p><p id="5bde" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">然而，Jenkins X需要Kubernetes，并且对集群如何配置非常固执己见。命令行工具自动化了这个过程的大部分，但这是一个重要的考虑因素。</p><p id="b777" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">定价</strong></p><p id="38fc" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">Jenkins X是开源的。</p><p id="1048" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated"><strong class="lb iu">我的拍摄</strong></p><p id="7d0d" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">对于使用詹金斯的球队来说，詹金斯X会感觉是一个自然的进程。它有一些严格的限制和要求，但是对于使用Kubernetes的团队来说，拥有一个能够与您的基础设施进行本机集成的工具是一个好处。</p><h1 id="104f" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h1><p id="f9b9" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">让我们快速对比一下:</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/1fceac148c81fc244c72b8611054d066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/0*bzm-jo7x0JYAex3Q"/></div></figure><p id="3c4c" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">对于希望在稳定的环境中简单地部署和托管Docker容器的团队来说，Heroku是无可匹敌的。它提供了一个快速且可配置的平台，支持广泛的集成，并拥有一个庞大的第三方附加组件市场。Elastic Beanstalk在编排AWS资源的能力方面紧随其后，是具有更复杂需求的团队的推荐选择。</p><p id="b3e2" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">对于容器CI，GitLab可以说是最全面的选择，因为它有大量的特性、自动开发能力和开放核心模型。Google Cloud Build利用了Google Cloud Platform的速度和容量来实现快速构建，Jenkins X受益于成为Jenkins项目的一部分。大多数这些服务要么是开源的，要么提供免费试用，所以我们建议尝试一下，看看哪个最适合您的工作流程。</p></div></div>    
</body>
</html>