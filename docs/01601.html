<html>
<head>
<title>Localization in React Native with React Navigation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native中的本地化和React导航</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/localization-in-react-native-with-react-navigation-4f4e2ad2c8d0?source=collection_archive---------8-----------------------#2020-01-15">https://levelup.gitconnected.com/localization-in-react-native-with-react-navigation-4f4e2ad2c8d0?source=collection_archive---------8-----------------------#2020-01-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/db24184da5d1482b6dc8389a4a64e69a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ms-UnGLQzw_1ZzUX"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">照片由<a class="ae jd" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> chuttersnap </a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><div class=""/><p id="c418" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将介绍如何使用React导航来国际化您的React本地应用程序。它将在现有的<a class="ae jd" href="https://reactnavigation.org/docs/en/localization.html" rel="noopener ugc nofollow" target="_blank">指南</a>上进行扩展，通过添加选项卡或抽屉导航器所需的步骤，对屏幕的本地化进行反应导航。</p><p id="5e08" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想使用它来跟进，下面是完整的代码:</p><p id="8026" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">抽屉导航:<a class="ae jd" href="https://github.com/mariesta/localization-drawer-react-navigation" rel="noopener ugc nofollow" target="_blank">https://github . com/mariesta/localization-drawer-react-navigation</a></p><p id="0b95" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">tabs navigator:<a class="ae jd" href="https://github.com/mariesta/localization-tabs-react-navigation" rel="noopener ugc nofollow" target="_blank">https://github . com/mariesta/localization-tabs-react-navigation</a></p><p id="2a6d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本教程中使用的主要技术:</p><ul class=""><li id="dbff" class="lb lc jg kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">反应原生0.61</li><li id="bfb6" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">反应导航4</li><li id="f1ff" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">i18next 19 &amp; react-i18next 10(但是您可以用它替换您自己的框架)</li><li id="2755" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Expo SDK 36(还是个人喜好。不一定要用)</li></ul><p id="e38d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你需要的话，我会在底部添加所有的文档。</p><p id="03a0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:我将使用react-i18next作为我的国际化框架。如果您决定也这样做，请检查您的React Native版本。react-i18next (v10)的最新版本使用了仅在react原生版本v0.59或更高版本上可用的钩子。如果你有一个旧版本的React Native，不用担心。您可以使用react-i18next (v9)的遗留版本，它工作得一样好，但是一些函数已经被重命名，所以要小心那些。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="064a" class="lw lx jg bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">项目设置</h1><p id="e229" class="pw-post-body-paragraph kd ke jg kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">我个人使用Expo来创建和运行我的React原生应用。要创建一个新项目，只需运行expo init [project name],然后将cd放入您的项目。</p><p id="1848" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用npm(或yarn)安装i18next和react-i18next</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="d8b1" class="ni lx jg ne b gy nj nk l nl nm">npm install i18next react-i18next</span></pre><p id="b2fc" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您需要抽屉导航器的图标，我可以建议您使用React本地元素吗？</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="5a7d" class="ni lx jg ne b gy nj nk l nl nm">npm install react-native-elements</span></pre><h1 id="0ea6" class="lw lx jg bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">i18n.js</h1><p id="da71" class="pw-post-body-paragraph kd ke jg kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">在我们的项目根目录中，我们将创建一个i18n.js文件。同样，这取决于您的国际化框架。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="d156" class="ni lx jg ne b gy nj nk l nl nm">import i18n from 'i18next';<br/>import { initReactI18next } from 'react-i18next';</span><span id="fb64" class="ni lx jg ne b gy ns nk l nl nm">// the translations<br/>// (tip: move them in separate JSON files and import them)<br/>const resources = {<br/>  en: {<br/>    translation: {<br/>      "screen": "Screen {{ order }}",<br/>      "tab": "Tab {{ order }}",<br/>      "change_language_english": "In english",<br/>      "change_language_french": "In french"<br/>    }<br/>  },<br/>  fr: {<br/>    translation: {<br/>      "screen": "Écran {{ order }}",<br/>      "tab": "Onglet {{ order }}",<br/>      "change_language_english": "En anglais",<br/>      "change_language_french": "En français"<br/>    }<br/>  }<br/>};</span><span id="430c" class="ni lx jg ne b gy ns nk l nl nm">i18n<br/>  .use(initReactI18next)<br/>  // init i18next<br/>  // for all options read: <a class="ae jd" href="https://www.i18next.com/overview/configuration-options" rel="noopener ugc nofollow" target="_blank">https://www.i18next.com/overview/configuration-options</a><br/>  .init({<br/>    resources,<br/>    lng: "en",<br/>    fallbackLng: 'en',<br/>    debug: true,<br/>    interpolation: {<br/>      escapeValue: false<br/>    }<br/>  });</span><span id="0cc5" class="ni lx jg ne b gy ns nk l nl nm">export default i18n;</span></pre><p id="0e51" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们创建我们的翻译。随着它不断增长，我建议您为每种语言创建一个单独的JSON文件，并将它们导入到这个文件中。其次，我们通过设置一些配置来创建我们的<code class="fe nt nu nv ne b">i18n</code>实例。</p><h1 id="aed0" class="lw lx jg bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">App.js</h1><p id="73da" class="pw-post-body-paragraph kd ke jg kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">完成i18n文件后，我们将其导入到App.js文件中。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="0360" class="ni lx jg ne b gy nj nk l nl nm">import React, { useState } from 'react';<br/>...</span><span id="9ff0" class="ni lx jg ne b gy ns nk l nl nm">import AppNavigator from './navigation/AppNavigator';<br/>import './i18n';</span><span id="591f" class="ni lx jg ne b gy ns nk l nl nm">export default function App(props) {<br/>  return (<br/>      &lt;View&gt;<br/>          ...<br/>          &lt;AppNavigator /&gt;<br/>      &lt;/View&gt;<br/>    );<br/>}</span></pre><h1 id="39b2" class="lw lx jg bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">AppNavigator.js</h1><p id="dc1f" class="pw-post-body-paragraph kd ke jg kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">AppNavigator.js就是我们的<code class="fe nt nu nv ne b">AppContainer</code>住的地方。</p><p id="d8c9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React Navigation 4有一个非常方便的名为<code class="fe nt nu nv ne b">screenProps</code>的全局<code class="fe nt nu nv ne b">props</code>，它允许我们传递所有子导航器都可以访问的道具。这将对我们非常有用，因为它将允许我们翻译标签、抽屉等等中的所有标签。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="f787" class="ni lx jg ne b gy nj nk l nl nm">import React from 'react';<br/>import { createAppContainer } from 'react-navigation';<br/>import { withTranslation } from 'react-i18next';</span><span id="ed9b" class="ni lx jg ne b gy ns nk l nl nm">import MainNavigator from './MainNavigator';</span><span id="79fd" class="ni lx jg ne b gy ns nk l nl nm">const AppContainer = createAppContainer(MainNavigator);</span><span id="5571" class="ni lx jg ne b gy ns nk l nl nm">class AppNavigator extends React.Component {</span><span id="21a7" class="ni lx jg ne b gy ns nk l nl nm">  render() {<br/>    const { t, i18n } = this.props;</span><span id="c7b9" class="ni lx jg ne b gy ns nk l nl nm">    return (<br/>      &lt;AppContainer<br/>        screenProps={{<br/>          t,<br/>          i18n<br/>        }}<br/>      /&gt;<br/>    );<br/>  }<br/>}</span><span id="aa37" class="ni lx jg ne b gy ns nk l nl nm">export default withTranslation()(AppNavigator);</span></pre><p id="5bd5" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们导入主导航器，这将在下一步中介绍。第二，我们用它创造我们的<code class="fe nt nu nv ne b">AppContainer</code>。第三，我们用<code class="fe nt nu nv ne b">withTranslation()</code>包装我们的<code class="fe nt nu nv ne b">AppNavigator</code>，这将添加i18n实例和<code class="fe nt nu nv ne b">t</code>函数。i18n实例用于更改语言(比如说<code class="fe nt nu nv ne b">i18n.changeLanguage(‘fr’)</code>)，而t函数有助于通过传入键来翻译我们的内容，并获得基于当前语言的内容(例如，如果语言是英语，则<code class="fe nt nu nv ne b">t(‘hi’)</code>将返回“Hello ”,如果语言是法语，则返回“Bonjour”——假设您在i18n文件中设置了正确的翻译)。</p><p id="146e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们得到这两个，我们就把它加到我上面提到的<code class="fe nt nu nv ne b">screenProps</code>中。</p><h1 id="3ba7" class="lw lx jg bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">主导航器. js</h1><p id="f74e" class="pw-post-body-paragraph kd ke jg kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">现在我们添加了这两个，我们如何访问它们呢？</p><p id="1762" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">1)选项卡导航器</p><p id="6a53" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建我们的<code class="fe nt nu nv ne b">bottomTabNavigator</code>，我将使用一系列堆栈。</p><p id="7124" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:如果你不知道什么是栈，有大量的文档包括这篇特殊的<a class="ae jd" href="https://medium.com/async-la/react-navigation-stacks-tabs-and-drawers-oh-my-92edd606e4db" rel="noopener">文章</a>。</p><p id="bcbe" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本质上，一个<code class="fe nt nu nv ne b">stackNavigator</code>看起来像这样:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="a38b" class="ni lx jg ne b gy nj nk l nl nm">const Tab1Stack = createStackNavigator(<br/>  {<br/>    Home: {<br/>      screen: Screen1<br/>    }<br/>    ... // include all the screens that will fall under Tab 1 <br/>  }<br/>);</span></pre><p id="98f3" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还记得上一步的<code class="fe nt nu nv ne b">screenProps</code>吗？我们不仅要用它来定义一个标签，还要翻译它。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="7584" class="ni lx jg ne b gy nj nk l nl nm">Tab1Stack.navigationOptions = ({ screenProps: { t } }) =&gt; (<br/>  {<br/>    tabBarLabel: t('tab', { order: 1 })<br/>  }<br/>);</span></pre><p id="4877" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从<code class="fe nt nu nv ne b">screenProps</code>中获取<code class="fe nt nu nv ne b">t</code>函数，并用它来获取选项卡的正确标签。</p><p id="7d57" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想翻译屏幕的标题，你可以使用同样的逻辑，稍微调整一下你的<code class="fe nt nu nv ne b">stackNavigator</code>。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="3026" class="ni lx jg ne b gy nj nk l nl nm">const Tab1Stack = createStackNavigator(<br/>  {<br/>    Home: {<br/>      screen: Screen1,<br/>      navigationOptions: ({ screenProps: { t } }) =&gt; ({<br/>        title: t('screen', { order: 1 })<br/>      })<br/>    }<br/>  }<br/>);</span></pre><p id="7a30" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建尽可能多的标签堆栈，然后用以下内容结束文件:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="b152" class="ni lx jg ne b gy nj nk l nl nm">const tabNavigator = createBottomTabNavigator({<br/>  Tab1Stack,<br/>  Tab2Stack,<br/>  Tab3Stack,<br/>});</span><span id="821b" class="ni lx jg ne b gy ns nk l nl nm">export default tabNavigator;</span></pre><p id="fb3f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里的是MainNavigator.js的完整代码</p><p id="da92" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2)抽屉导航器</p><p id="2fe4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和tab Navigator区别不大。首先，我们有一个堆栈:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="c93e" class="ni lx jg ne b gy nj nk l nl nm">const Drawer1Stack = createStackNavigator(<br/>  {<br/>    Home: {<br/>      screen: Screen1,<br/>    },<br/>     ... // include all the screens for your first drawer option<br/>  }<br/>);</span></pre><p id="5e01" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">只有当我们为堆栈设置导航选项时，才不设置<code class="fe nt nu nv ne b">tabBarLabel</code>和<code class="fe nt nu nv ne b">tabBarIcon</code>，而是设置<code class="fe nt nu nv ne b">drawerLabel</code>。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="f4bb" class="ni lx jg ne b gy nj nk l nl nm">Drawer1Stack.navigationOptions = ({ screenProps: { t } }) =&gt; ({<br/>  drawerLabel: t('screen', { order: 1 }),<br/>});</span></pre><p id="cd6e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">堆栈中特定屏幕标题的<code class="fe nt nu nv ne b">navigationOptions</code>也是类似的。除了我在左边加了一个<code class="fe nt nu nv ne b">Icon</code>用来拨动抽屉。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="a7e6" class="ni lx jg ne b gy nj nk l nl nm">const Drawer1Stack = createStackNavigator(<br/>  {<br/>    Home: {<br/>      screen: Screen1,<br/>      navigationOptions: ({ navigation, screenProps: { t } }) =&gt; ({<br/>        title: t('screen', { order: 1 }),<br/>        headerLeft:<br/>        &lt;Icon<br/>          name='bars'<br/>          size={18}<br/>          type='font-awesome'<br/>          containerStyle={{paddingLeft: 10}}<br/>          onPress={() =&gt; navigation.toggleDrawer()} /&gt;<br/>      })<br/>    }<br/>  }<br/>);</span></pre><p id="e783" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据需要创建尽可能多的堆栈，用您的<code class="fe nt nu nv ne b">drawerNavigator</code>完成您的文件:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="b359" class="ni lx jg ne b gy nj nk l nl nm">const drawerNavigator = createDrawerNavigator({<br/>  Drawer1Stack,<br/>  Drawer2Stack,<br/>  Drawer3Stack<br/>});</span><span id="e06e" class="ni lx jg ne b gy ns nk l nl nm">export default drawerNavigator;</span></pre><p id="91a0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae jd" href="https://github.com/mariesta/localization-drawer-react-navigation/blob/master/navigation/DrawerNavigator.js" rel="noopener ugc nofollow" target="_blank">这里的</a>是DrawerNavigator.js的完整代码</p><h1 id="b0bc" class="lw lx jg bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">改变语言</h1><p id="0f5f" class="pw-post-body-paragraph kd ke jg kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">现在我们已经设置了我们的导航器，我们如何通过改变语言来测试它呢？谢天谢地，<code class="fe nt nu nv ne b">screenProps</code>不仅仅局限于栈和导航仪。它也可以在屏幕中访问。这允许我们这样做:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="0cdc" class="ni lx jg ne b gy nj nk l nl nm">import React from 'react';<br/>import { Button, View, StyleSheet } from 'react-native';</span><span id="e963" class="ni lx jg ne b gy ns nk l nl nm">export default class Screen1 extends React.Component {</span><span id="4d91" class="ni lx jg ne b gy ns nk l nl nm">render() {<br/>    let { t, i18n} = this.props.screenProps;<br/>    return (<br/>      &lt;View style={styles.container}&gt;<br/>        &lt;Button<br/>          transparent<br/>          onPress={() =&gt; i18n.changeLanguage('en')}<br/>          title={t('change_language_english')}/&gt;<br/>        &lt;Button<br/>          transparent<br/>          onPress={() =&gt; i18n.changeLanguage('fr')}<br/>          title={t('change_language_french')}/&gt;<br/>      &lt;/View&gt;<br/>    );<br/>  }<br/>}</span><span id="b16a" class="ni lx jg ne b gy ns nk l nl nm">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    backgroundColor: '#fff',<br/>    paddingTop: 20<br/>  },<br/>});</span></pre><p id="c0d6" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nt nu nv ne b">i18n</code>实例和<code class="fe nt nu nv ne b">t</code>函数现在都可用了，不仅允许我们翻译按钮标题，还允许我们改变语言。</p><p id="3add" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你喜欢这篇文章，你可以在Twitter上关注我。</p></div></div>    
</body>
</html>