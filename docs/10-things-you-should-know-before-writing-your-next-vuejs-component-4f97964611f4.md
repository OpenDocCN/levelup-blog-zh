# 在编写下一个 Vue.js 组件之前你应该知道的 10 件事

> 原文：<https://levelup.gitconnected.com/10-things-you-should-know-before-writing-your-next-vuejs-component-4f97964611f4>

## 构建更好的 Vue 组件指南

![](img/f73c2ede0bcc1737b7f27684d10bbfab.png)

# 1.组件可以在全局或本地加载

Vue.js 提供了两种加载组件的方法——一种是在 Vue 实例上全局加载，另一种是在组件级加载。这两种方法都有各自的好处。

通过全局加载组件，可以从应用程序中的任何模板访问该组件，包括子组件。它限制了将全局组件导入子组件的次数。此外，如果你全局加载组件，你不会得到 Vue 寄存器组件错误`“did you register the component correctly?”`。注意，尽量少加载全局组件。它会使您的应用程序膨胀，即使不使用它，它仍然会包含在您的 Webpack 构建中。

本地加载组件为您提供了隔离组件并仅在必要时加载它们的能力。当与 Webpack 结合使用时，您可以仅在组件被使用时延迟加载它们。这使您的初始应用程序文件变得非常小，并减少了初始加载时间。

# 2.延迟加载/异步组件

使用 Webpack 的动态导入延迟加载组件。Vue 支持渲染时组件的延迟加载和代码分割。这些优化允许组件代码只在需要的时候加载，减少了 HTTP 请求和文件大小，并自动提升了性能。这个特性的伟大之处在于，它既可以处理全局加载的组件，也可以处理本地加载的组件。

全局加载异步组件:

本地加载异步组件:

> [库克将平均页面加载时间减少了 850 毫秒，转换率提高了 7%，跳出率降低了 7%，每个会话的页面增加了 10%](https://www.nccgroup.trust/uk/about-us/resources/cook-real-user-monitoring-case-study/?style=Website+Performance&resources=Case+Studies)

[](https://developers.google.com/web/fundamentals/performance/why-performance-matters/) [## 为什么性能很重要|网络基础| Google 开发者

### 由于移动设备和网络的激增，使用网络的人比以往任何时候都多。作为这个用户群…

developers.google.com](https://developers.google.com/web/fundamentals/performance/why-performance-matters/) 

# 3.必需的道具

有许多方法可以为组件创建道具；您可以传递一个表示属性名的字符串数组，也可以传递一个带有作为属性名的键的对象和一个配置对象。

使用基于对象的方法，您可以为单个道具创建一些关键配置更改，其中一个是必需的关键。所需的键需要一个`true`或`false`值。如果使用组件时未设置属性，True 将引发错误；如果未设置属性，false(默认值)将不要求或引发错误。在共享组件时，为其他开发人员以及您自己使用所需的道具是一个好的实践，以提醒您道具对于组件是至关重要的。

# 4.用`$emit`触发自定义事件

子组件和父组件之间的通信可以通过使用组件内置函数`$emit`发出自定义事件来完成。`$emit`函数接受一个事件名称字符串和一个要发出的可选值。要监听事件，只需向发出事件的组件添加“`@eventName`”，并传入您的事件处理程序。这是保持单一真实来源并让数据从子组件流向父组件的好方法。

# 5.将组件分解成逻辑块

说起来容易做起来难，但是如何定义一个逻辑片段来将一个组件分解成几个部分呢？分解组件的第一种方法是基于数据变化率。如果数据在组件的一个部分持续变化，而在其他部分没有变化，那么它可能是它自己的组件。

原因是如果你的数据/HTML 在你的模板的一个部分持续变化，整个事情都需要检查和更新。但是，如果将相同的 HTML 放入它自己的组件中，并使用 props 传递数据，那么当它的 props 改变时，只更新那个组件。

逻辑上分解组件的另一种方式是为了可重用性。如果你有 HTML，图形，或者在你的应用程序中一直使用的功能，比如按钮，复选框，图标动画，行动号召或者有简单修改文本的图形——这将是一个很好的候选隔离到一个可以重用的新组件中。可重用组件有一个隐藏的好处，即更容易维护，因为您只需更改一个组件，而不必在代码库中寻找替换和更改多个区域。

# 6.验证你的道具

不要使用字符串数组来定义你的属性，而是使用对象符号来配置每个属性。两种非常有用的配置风格是“类型”和验证器。

使用类型参数，Vue 将自动类型检查您的属性值。例如，如果我们期待一个数字属性，但收到一个字符串，您将在控制台中得到类似于以下内容的警告:

```
[Vue warn]: Invalid prop: type check failed for prop “count”. Expected Number
```

对于更复杂的验证，我们可以将一个函数传递给 validator 属性，该属性接受值作为参数并返回`true`或`false`。这非常强大，因为它允许我们针对传递给特定属性的值编写自定义验证。

# 7.多道具绑定和覆盖

如果你的组件有很多道具，比如说 5 个、6 个、7 个或者更多，那么不断地为每个道具设置绑定可能会变得很乏味。幸运的是，有一种快速的方法可以为组件的所有属性设置绑定，那就是使用`v-bind`绑定一个对象，而不仅仅是一个属性。

使用对象绑定的另一个好处是，您可以覆盖对象的任何绑定。在我们的例子中，如果我们在 person 对象中将`isActive`设置为 false，那么我们可以在实际的 person 组件上进行另一个绑定，并将`isActive`设置为 true，不覆盖原来的内容。

# 8.修改组件中的属性

在某些情况下，您可能希望修改从属性传入的值。然而，这样做会给你一个警告“避免直接改变道具”,这是有充分理由的。相反，使用 prop 值作为本地数据属性的默认值。这样做将使您能够看到原始值，但修改本地数据不会改变属性值。

这里有一个权衡。使用这种方法，您的本地数据属性不会对属性值做出反应，因此父组件对属性值的任何更改都不会更新您的本地值。但是，如果您确实需要这些更新，也可以使用计算属性来组合值。

# 9.测试实用安装与浅安装

有两种方法可以在 Vue 测试工具中创建和引导组件。一个是座式，另一个是浅座式；两者各有优缺点。

当您想要在一个组件及其子组件之间进行相互依赖的测试时，挂载技术非常有用。允许您测试父组件是否如预期的那样与其子组件正确交互。相反，顾名思义，浅挂载技术只实例化和呈现完全隔离的父组件，而不考虑它的任何子组件。

那么哪种方法更好呢？这取决于你。你选择的策略应该取决于你可衡量的目标。尝试在完全隔离的情况下单独测试一个组件，浅层方法效果很好。需要在一个包含子组件的组件上工作，并希望确保通信，然后使用挂载选项。一个很好的选择是两者都用。你不局限于只有一个，所以混合和匹配，以满足您的测试需求。

# 10.Vue-cli 的强大功能

Vue CLI 是一个强大的命令行界面，允许开发人员快速利用大量功能来加快您的工作流程。

我经常使用的一个特性是运行`vue serve`并传入一个 Vue 组件的路径。这样做的好处是，你可以完全独立地开发一个组件，但也可以热重载和迭代组件，直到它的核心功能消失。无需临时将新组件导入到页面上进行开发。

```
vue serve ./components/views/GoldenRule
```

在团队中工作时，您可能希望拿出一个特定的组件并与其他人共享。这引出了下一个特性 Vue CLI 将 Vue 组件导出为库的能力。当被调用时，Vue 将自动构建一个单独的文件组件，将 CSS 移动到一个外部 CSS 文件中(可选的，你也可以内联它),并创建 UMD 和通用。用于导入其他 js 项目的 JS 文件。

```
vue build —-target lib --name goldenRule ./components/views/GoldenRule
```

[](https://cli.vuejs.org/) [## Vue CLI

### 用于 Vue.js 开发的🛠️标准工具

cli.vuejs.org](https://cli.vuejs.org/) [](https://gitconnected.com/learn/vue-js) [## 学习 Vue.js -最佳 Vue.js 教程(2019) | gitconnected

### 28 大 Vue.js 教程-免费学习 Vue.js。课程由开发人员提交并投票，使您能够…

gitconnected.com](https://gitconnected.com/learn/vue-js)