<html>
<head>
<title>Building Esri ArcGIS Map in React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React Hooks中构建Esri ArcGIS地图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-esri-arcgis-map-in-react-hooks-fcb5d4189b42?source=collection_archive---------5-----------------------#2022-03-28">https://levelup.gitconnected.com/building-esri-arcgis-map-in-react-hooks-fcb5d4189b42?source=collection_archive---------5-----------------------#2022-03-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3fdf516ca11ed8efabf95cadaa86a528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Quw67BD9GnA5DZ2dWqDH2Q.jpeg"/></div></div></figure><p id="156d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您曾经使用过ArcGIS for JS并浏览过它的文档，您就会知道有很多东西需要学习。值得庆幸的是，Esri拥有杀手级的编码示例，可以让您立即开始使用ol的复制粘贴技巧。</p><p id="e9e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，(我假设)为了“前端框架不可知”，似乎没有太多在React中构建ArcGIS地图的例子。</p><p id="8d2d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">鉴于React的受欢迎程度和我目前作为前端开发人员处理大量GIS信息的工作，这成为了我的兴趣所在。</p><p id="a8f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我不仅想在React中创建并运行地图，还想尽量避免创建ArcGIS地图时很容易出现的典型的巨型代码。</p><p id="4dcf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw">解决方案:构造简单的组件，将Esri的业务逻辑分离到一个自定义的React钩子</em> </strong></p><p id="8e3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们开始吧！</p><p id="58d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要一个react应用程序和esri-loader:</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="edfd" class="lg lh iq lc b gy li lj l lk ll">npx create-react-app my-map<br/>cd my-map<br/>yarn add esri-loader</span></pre><p id="188c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装好react应用程序和esri-loader后，让我们从削减App.js组件开始:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/337ce69f360041a736305419048e3755.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*dwS_vo5CYZG3CkRn3hnYOA.png"/></div></figure><p id="ee6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">超级简单。这总是好的！我们只是在App.js的div中导入并呈现地图组件。在我忘记之前，我们需要在App.css中添加一行代码:</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="6763" class="lg lh iq lc b gy li lj l lk ll">.map-view { height: 100vh }</span></pre><p id="a9c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种特殊的酱允许我们的地图div实际出现！</p><p id="3e42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在地图上:让我们在src中创建Map.jsx。为了简单起见，我们不会太关心我们项目的文件夹结构，但是您显然可以根据您自己的文件夹结构的组织偏好来修改本文。同样，另一个相当直接的组件:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/9953f1fa42b1e4a62b311b50edf0a1f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zy-RoETepTReTDXeQd-StQ.png"/></div></div></figure><p id="e51a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">需要注意的事项:</p><ul class=""><li id="84ac" class="lo lp iq ka b kb kc kf kg kj lq kn lr kr ls kv lt lu lv lw bi translated">导入useRef是为了将一个Ref传递给包含我们的地图的div</li><li id="00f2" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">我们正在导入即将推出的定制钩子——useCreateMap</li><li id="725e" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">然后调用useCreateMap并接受mapRef作为参数</li><li id="7ba8" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">我们的div有一个利用css的类名“map-view”</li></ul><p id="e683" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，神奇的事情发生了…我们的用户创建了一个地图钩子！</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/2c531a2e46f76c2e232bdefd71e8ee92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cdJovJGBDs71W8IhamNaaA.png"/></div></div></figure><p id="104a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">快速分解:</p><ul class=""><li id="13cc" class="lo lp iq ka b kb kc kf kg kj lq kn lr kr ls kv lt lu lv lw bi translated">我们导入并调用useEffect在加载时创建地图</li><li id="2dfb" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">esri-loader用于异步访问ArcGIS goodies</li><li id="1d03" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">initializeMap包含创建地图的基本ArcGIS代码(<a class="ae md" href="https://developers.arcgis.com/javascript/latest/sample-code/intro-mapview/" rel="noopener ugc nofollow" target="_blank">见文档</a>)</li><li id="36f1" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">initializeMap是在接收mapRef时定义和调用的</li><li id="fea0" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">作为负责任的公民，我们的目标是自己收拾行李，并计划在组件卸载时销毁地图视图</li></ul><p id="7ccd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在你知道了！启动您的应用程序</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="e4ad" class="lg lh iq lc b gy li lj l lk ll">yarn start</span></pre><p id="621b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你很快就会开始在地图上漫游了！</p><p id="372d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望您发现这是一种通过自定义挂钩将Esri的ArcGIS for JS集成到React的框架中的有用方法。我继续使用这种模式来利用Esri微件、图层，甚至是ArcGIS世界中的地图事件处理程序。</p><p id="0c8c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我知道它是如何为你工作的！更多的代码向你走来。干杯！</p></div></div>    
</body>
</html>