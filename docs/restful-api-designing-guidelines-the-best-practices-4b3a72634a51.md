# RESTful API 设计指南—最佳实践

> 原文：<https://levelup.gitconnected.com/restful-api-designing-guidelines-the-best-practices-4b3a72634a51>

## 拥有制作精美的 API 对您的应用程序总是有益的

![](img/88f7c8bebb0bc3538a4cc2a3227b8f4e.png)

脸书、谷歌、GitHub、网飞和其他一些科技巨头给了开发者和产品一个通过 API 消费数据的机会，并成为他们的平台。

即使你不是为其他开发人员和产品编写 API，拥有精美的 API 对你的应用程序来说总是非常有益的。

关于设计 API 的最佳方式，互联网上有一场长期的争论，这是最微妙的争论之一。没有为它定义的官方指导方针。

API 是一个接口，许多开发人员通过它与数据进行交互。一个设计良好的 API 总是非常容易使用，并使开发人员的生活非常顺利。

API 是开发人员的 GUI，如果它令人困惑或不冗长，那么开发人员将开始寻找替代品或停止使用它。开发人员的经验是衡量 API 质量的最重要的标准。

API 就像一个在舞台上表演的艺术家，它的用户就是观众。

# 术语

以下是与 REST APIs 相关的最重要的术语。

*   *Resource* 是一个对象或某种东西的表示，它有一些相关的数据，可以有一组方法对它进行操作。例如动物、学校、员工都是资源，删除、添加、更新*、是对这些资源进行的操作。*
*   *集合*是一组资源，例如公司是公司资源的集合。
*   *URL* (统一资源定位符)是一个路径，通过它可以定位资源并对其执行操作。

# API 端点

让我们为有一些员工的公司写几个 API**、**来了解更多。

是一个 API，它将响应一个雇员列表。公司中的其他一些 API 如下所示:

*   `/addNewEmployee`
*   `/updateEmployee`
*   `/deleteEmployee`
*   `/deleteAllEmployees`
*   `/promoteEmployee`
*   `/promoteAllEmployees`

对于不同的操作，将会有大量类似的 API 端点。所有这些都会包含许多多余的动作。因此，当 API 数量增加时，所有这些 API 端点都难以维护。

## 怎么了？

URL 应该只包含资源(名词)，不包含动作或动词。API 路径`/addNewEmployee`包含动作`addNew` 以及资源名称`Employee`。

## 正确的方法是什么？

`/companies`端点是一个不包含动作的好例子。但是问题是:“我们如何告诉服务器关于在`companies`资源上要执行的操作，以及是添加、删除还是更新？”

这就是 [HTTP 方法](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods) ( `GET`、`POST`、`DELETE`、`PUT`)，也称为动词，发挥作用的地方。

在 API 端点中资源应该总是复数*T21，如果我们想要访问资源的一个实例，我们可以总是在 URL 中传递 ID。*

*   方法`GET`路径`/companies`应该得到所有公司的列表。
*   方法`GET`路径`/companies/34`应该获取公司 34 的详细信息。
*   方法`DELETE`路径`/companies/34`应该删除公司 34。

在其他一些用例中，如果我们在一个资源下有资源，例如一个公司的雇员，那么一些示例 API 端点将是:

*   `GET /companies/3/employees`应该从公司 3 得到所有员工的名单。
*   `GET /companies/3/employees/45`应该获得属于公司 3 的雇员 45 的详细信息。
*   `DELETE /companies/3/employees/45`应该删除属于公司 3 的员工 45。
*   `POST /companies`应该创建一个新公司并返回创建的新公司的详细信息。

现在的 API 不是更加精确和一致了吗？

## 结论

路径应该包含资源的复数形式，HTTP 方法应该定义要在资源上执行的动作的种类。

# HTTP 方法(动词)

HTTP 已经定义了几组方法，这些方法指示要在资源上执行的动作类型。

URL 是一个句子，其中资源是名词，HTTP 方法是动词。

重要的 HTTP 方法如下:

1.  `GET`方法从资源请求数据，并且不应该产生任何副作用。例如`/companies/3/employees`返回公司 3 的所有雇员的列表。
2.  `POST`方法请求服务器*在数据库中创建*一个资源，通常是在提交 web 表单时。例如`/companies/3/employees`创建了公司 3 的新员工。`POST`是非[幂等的](https://en.wikipedia.org/wiki/Idempotence#Computer_science_meaning)，这意味着多个请求会有不同的效果。
3.  `PUT`方法请求服务器*更新*一个资源，或者*创建*一个不存在的资源。例如，`/companies/3/employees/john`会请求服务器更新或创建公司 3 下**员工集合中的*约翰*资源。`PUT`是[等幂](https://en.wikipedia.org/wiki/Idempotence#Computer_science_meaning)，这意味着多个请求将具有相同的效果。**
4.  **方法请求从数据库中删除资源或它们的实例。例如，`/companies/3/employees/john/`将请求服务器从公司 3 下的雇员集合中删除 *john* 资源。**

**还有一些其他的方法，我们将在另一篇文章中讨论。**

# **HTTP 响应状态代码**

**当客户机通过 API 向服务器发出请求时，客户机应该知道反馈，是失败、通过还是请求错误。**

**HTTP 状态代码是一堆标准化的代码，在不同的场景中有不同的解释。服务器应该总是返回正确的状态代码。**

**以下是 HTTP 代码的重要分类:**

# **2xx(成功类别)**

**这些状态代码表示请求的操作已被服务器接收并成功处理。**

*   **200 OK **—** 表示 GET、PUT 或 POST 成功的标准 HTTP 响应。**
*   **201 Created —每当创建新实例时，都应返回此状态代码。例如，在使用 POST 方法创建新实例时，应该总是返回 201 状态代码。**
*   **204 无内容—表示请求已成功处理，但未返回任何内容。删除就是一个很好的例子。API `DELETE /companies/43/employees/2`将删除雇员 2，作为回报，我们在 API 的响应体中不需要任何数据，因为我们明确要求系统删除。如果有任何错误，比如数据库中不存在`employee 2`，那么响应代码就不会是`2xx Success Category`的，而是在`4xx Client Error category`附近。**

# **3xx(重定向类别)**

*   **304 未修改—表示客户端的缓存中已经有响应。因此，不需要再次传输相同的数据。**

# **4xx(客户端错误类别)**

**这些状态代码表示客户端提出了一个错误的请求。**

*   **400 错误请求—这表示客户端的请求未得到处理，因为服务器无法理解客户端的请求。**
*   **401 未授权—表示不允许客户端访问资源，应该使用所需的凭据重新请求。**
*   **403 Forbidden — **I** 表示请求是有效的，并且客户端已经过身份验证，但是由于任何原因客户端都不允许访问页面或资源。例如，有时授权的客户端不被允许访问服务器上的目录。**
*   **404 未找到—表示请求的资源现在不可用。**
*   **410 消失—表示请求的资源不再可用，已被有意移动。**

# **5xx(服务器错误类别)**

*   **500 内部服务器错误—表示请求是有效的，但服务器完全混乱，服务器被要求处理意外情况。**
*   **503 服务不可用—表示服务器已关闭或无法接收和处理请求。主要是在服务器进行维护时。**

# **字段名大小写约定**

**您可以遵循任何大小写约定，但要确保在整个应用程序中保持一致。如果请求体或响应类型是 [JSON](https://en.wikipedia.org/wiki/JSON) ，那么请遵循 camelCase 以保持一致性。**

# **搜索、排序、过滤和分页**

**所有这些操作都只是对一个数据集的查询。将不会有新的 API 集来处理这些操作。我们需要用 GET 方法 API 附加查询参数。**

**让我们通过几个例子来理解如何实现这些动作。**

*   **排序——如果客户机想要获得公司的排序列表,`GET /companies`端点应该在查询中接受多个排序参数。
    例如`GET /companies?sort=rank_asc`将按升序排列公司。**
*   **过滤—为了过滤数据集，我们可以通过查询参数传递各种选项。例如，`GET /companies?category=banking&location=india`将使用公司类别“银行”和位置“印度”来过滤公司列表数据。**
*   **搜索—在公司列表中搜索公司名称时，API 端点应该是`GET /companies?search=Digital Mckinsey`。**
*   **分页—当数据集太大时，我们将数据集分成更小的块，这有助于提高性能，并且更容易处理响应。例如，`GET /companies?page=23`的意思是获取第 23 页的公司列表。**

**如果在 GET 方法中添加许多查询参数使得 URI 太长，服务器可能会以`414 URI Too long` HTTP 状态响应。在这些情况下，参数也可以在`POST`方法的请求体中传递。**

# **版本控制**

**当你的 API 被全世界使用时，用一些突破性的改变来升级 API 也会导致使用你的 API 的现有产品或服务被破坏。**

**`http://api.yourservice.com/v1/companies/34/employees`就是一个很好的例子，它在路径中有 API 的版本号。如果有任何重大的突破性更新，我们可以将新的 API 集命名为`v2`或`v1.x.x`。**

# **结论**

**这些指导方针是基于我的开发经验。我很想知道你对上述几点的看法。请留下评论，让我知道！**