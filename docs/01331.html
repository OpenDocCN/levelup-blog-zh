<html>
<head>
<title>Find Users in Nested AD Groups</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在嵌套广告组中查找用户</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/find-users-in-nested-ad-groups-95f738078b18?source=collection_archive---------7-----------------------#2019-12-14">https://levelup.gitconnected.com/find-users-in-nested-ad-groups-95f738078b18?source=collection_archive---------7-----------------------#2019-12-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bfc88c461433285a62a8eb8d3f693d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MIab2IyJV0t0Ujg8"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Elena Mozhvilo 在<a class="ae kc" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="4f6d" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">递归查找广告组和所有嵌套组中的用户</h1><p id="4dcb" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在工作中，我们要处理很多关于网络上的用户和计算机的报告信息，我最近被分配的一项任务就是递归地报告哪些用户是一个组的一部分，以及所有嵌套的组。</p><p id="05be" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我一直在与递归作斗争，主要是因为我真的不需要使用它，所以当需要解决这个问题时，我发现画一些流程图真的很有帮助:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/a7f46d437ade6c8279c908e17211edae.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/0*_pdwSzqgWWLLdhG3.jpg"/></div></figure><h1 id="5c65" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">该过程</h1><p id="4d7e" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这个过程非常简单，给定一个广告组名，找到它的所有成员。对于它的每个成员，如果是一个组，再次调用这个方法，否则将成员添加到一个列表中。</p><h1 id="d4ab" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">跨域问题</h1><h2 id="ebd6" class="mj ke iq bd kf mk ml dn kj mm mn dp kn lm mo mp kr lq mq mr kv lu ms mt kz mu bi translated">婴儿猝死综合症</h2><p id="796e" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">不幸的是，当你有不同广告领域的成员时，事情就有点棘手了。</p><p id="3c69" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">位于不同域中的成员的<code class="fe mv mw mx my b">name</code>属性将是安全标识符(SID ),而不是实际名称。要获得名称，您需要使用这段代码:</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="mz na l"/></div></figure><h2 id="ee8e" class="mj ke iq bd kf mk ml dn kj mm mn dp kn lm mo mp kr lq mq mr kv lu ms mt kz mu bi translated">该组的成员属性</h2><p id="6cd8" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">当一个组超过1500个成员时，<code class="fe mv mw mx my b">member</code>属性的计数为0，取而代之的是一个名为<code class="fe mv mw mx my b">member;range:0–1499</code>的属性。</p><p id="7131" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">该属性包含前1500个成员，为了获取所有成员，您需要在for循环中继续加载下一个属性(例如<code class="fe mv mw mx my b">member;range:1500–2999</code>):</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="9099" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">while循环的第一部分生成属性名并获取成员。</p><p id="df1e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">while循环的最后一部分检查members属性是否为空，如果是，那么我们知道我们已经到了循环的末尾，为了得到最后几个成员，我们使用一个<code class="fe mv mw mx my b">*</code>符号来表示结束索引。</p><p id="2772" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">一旦理解了跨域和成员属性问题，剩下的就很容易了。</p><p id="7361" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">下面是一个输出示例:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/810ccf0d94816733aacf92aa3d6aad3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*enL2ocMWEwf3A4OP.JPG"/></div></div></figure><h1 id="2b3d" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">代码</h1><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="52c8" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">带重音的编码</h1><p id="3b5c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">您可能已经注意到，我在Powershell中编写代码时带有C#口音。例如，使用<code class="fe mv mw mx my b">[System.IO.File]::ReadAllLines()</code>而不是<code class="fe mv mw mx my b">Get-Content</code>。我这样做有几个原因:</p><ul class=""><li id="c3c9" class="nc nd iq ld b le lz li ma lm ne lq nf lu ng ly nh ni nj nk bi translated">如果需要的话，以后转换成C#会更容易。</li><li id="9090" class="nc nd iq ld b le nl li nm lm nn lq no lu np ly nh ni nj nk bi translated">对于来自Java/C#背景的开发人员来说，它仍然是可读的。</li><li id="69b7" class="nc nd iq ld b le nl li nm lm nn lq no lu np ly nh ni nj nk bi translated">Commandlets不会让您看到幕后使用的是什么类。如果你知道这个类，你可以在MSDN上查找，看看这个类的所有其他方法。</li></ul></div></div>    
</body>
</html>