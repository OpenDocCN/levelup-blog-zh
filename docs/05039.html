<html>
<head>
<title>Stop duplicating constants between JS and CSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止在JS和CSS之间复制常量</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/stop-duplicating-constants-between-js-and-css-40efd253a945?source=collection_archive---------3-----------------------#2020-07-31">https://levelup.gitconnected.com/stop-duplicating-constants-between-js-and-css-40efd253a945?source=collection_archive---------3-----------------------#2020-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ed9d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">防止JS和CSS中常量重复的两个技巧</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c4bb29d2d952c304821340221f53824c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*APwkjd3D9FdMZy22"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@pankajpatel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pankaj Patel </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="b655" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们知道，拥有一个以上的真理来源只会导致疯狂。但是我在几个前端代码库中遇到的问题是CSS和JS中样式常量(颜色、字体、大小)的重复。我们将CSS中的原色放在一个很好的变量中，但是我们需要在JS代码中使用它(不管它有什么正当的理由)，所以我们继续为它创建一个常量，因为我们不打算硬编码那个值，哦不！但是我们还是违反了干燥原则。不要重复自己。</p><p id="b454" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以今天我将向你展示两种技术，要么在CSS中声明变量并在JS中使用它们，要么相反。</p><h1 id="0c4d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">JS =&gt; CSS</h1><p id="fede" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">所以你决定使用JavaScript作为你的真实来源。没关系，你有你的理由。例如，你可能从一个<code class="fe mp mq mr ms b">npm</code>包中加载这些常量，它们被导出为JS常量，你需要将它们注入CSS中。</p><p id="1d0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以首先，你需要有一个从代码中注入CSS的方法。这里有一个函数:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="32b4" class="mx lt iq ms b gy my mz l na nb">function <strong class="ms ir">addStyle</strong>(styleString) {<br/>  const style = document.createElement(<em class="nc">'style'</em>);<br/>  style.textContent = styleString;<br/>  document.head.append(style);<br/>}</span></pre><p id="b6fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个函数接收一个参数<code class="fe mp mq mr ms b">styleString</code>，那将是我们想要注入的CSS。该函数的第一行创建了一个<code class="fe mp mq mr ms b">&lt;style&gt;</code>元素，第二行将该元素的内容设置为<code class="fe mp mq mr ms b">styleString</code>参数，最后一行将该元素附加到我们的HTML的<code class="fe mp mq mr ms b">&lt;head&gt;</code>部分。就是这样。</p><p id="e58b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦有了这个函数，就可以用CSS变量的标准声明来调用它。</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="a717" class="mx lt iq ms b gy my mz l na nb"><strong class="ms ir">addStyle</strong>(<em class="nc">`<br/>  :root {<br/>    --color-primary: </em>${<strong class="ms ir">primaryColor</strong>};<em class="nc"><br/>  }<br/>`</em>)</span></pre><p id="93a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！所以现在你可以从CSS中访问这个变量了！</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="5464" class="mx lt iq ms b gy my mz l na nb">button {<br/>  background: var(--color-primary);<br/>}</span></pre><p id="f469" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！很简单，对吧？</p><p id="0006" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不过，这个方法有一个<strong class="ky ir">警告</strong>。CSS现在依赖于被加载和执行的JS。为什么这很重要？通常情况下，CSS是页面加载的第一个东西，JS是最后一个。例如，如果您使用CSS-in-JS，您可能已经遇到了这个问题，但是最好记住它。</p><p id="72d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个带示例的codepen可以玩！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">JS到CSS</figcaption></figure><h1 id="bf8e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">CSS =&gt; JS</h1><p id="48fe" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这是一种从JavaScript代码中访问CSS变量的简便方法。</p><p id="42fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此方法依赖于以下代码片段:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="35a6" class="mx lt iq ms b gy my mz l na nb">function <strong class="ms ir">getCSSVariable</strong>(varName) {<br/>  return getComputedStyle(document.documentElement)<br/>    .getPropertyValue(varName);<br/>}</span></pre><p id="7330" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该函数接收变量名作为参数，并执行以下操作:首先，它为<code class="fe mp mq mr ms b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/documentElement" rel="noopener ugc nofollow" target="_blank">document.documentElement</a></code>(通常是<code class="fe mp mq mr ms b">&lt;html&gt;</code>)调用<code class="fe mp mq mr ms b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle" rel="noopener ugc nofollow" target="_blank">window.getComputedStyle</a></code>，这返回一个<code class="fe mp mq mr ms b">CSSStyleDeclaration</code>，从这里我们可以调用<code class="fe mp mq mr ms b">getPropertyValue</code>并获得我们想要的变量。</p><p id="8a65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个codepen，也有一个使用这种技术的例子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">CSS到JS</figcaption></figure><h1 id="cb6d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">预处理器呢？</h1><p id="386c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这些技术都依赖于<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties" rel="noopener ugc nofollow" target="_blank"> CSS变量</a>特性，所以如果你使用SASS/LESS/Stylus变量，它们就不起作用。</p><p id="08a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，您可以从预处理程序变量中声明CSS变量，然后从JS中获取它们，就像下面这个使用SASS的例子:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="dad3" class="mx lt iq ms b gy my mz l na nb">$red: #ff0000;</span><span id="60b3" class="mx lt iq ms b gy nf mz l na nb">:root {<br/>  --red: $red;<br/>}</span></pre><p id="56f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也许您甚至可以编写一个很酷的函数/mixin来生成元编程风格的代码。超级酷吧。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="caf3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望这些技巧对你有用！</p></div></div>    
</body>
</html>