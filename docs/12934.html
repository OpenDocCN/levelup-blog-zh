<html>
<head>
<title>How To Replace Text with a Bash Script</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Bash脚本替换文本</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/bash-script-to-replace-text-904f1ba05bc?source=collection_archive---------5-----------------------#2022-07-24">https://levelup.gitconnected.com/bash-script-to-replace-text-904f1ba05bc?source=collection_archive---------5-----------------------#2022-07-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1516" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">替换行和文件中的字符串和特殊字符</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f7829573f2a3ff0f1c4067df3fc46118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IIYWL95ur9dNwtkvvmlScg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Gabriel Heinzer 在<a class="ae ky" href="https://unsplash.com/s/photos/commandline?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="dbcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将提供一个解决方案，并提供一些如何使用它的附加环境。我的希望是，这将为初始情况提供一个简洁而直接的解决方案，以及一些异常值。</p><p id="aa48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们直接进入脚本。</p><h1 id="8603" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">基本用例</h1><p id="5dd2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">假设您有一个如下所示的<code class="fe ms mt mu mv b">.txt</code>文件。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0468" class="na lw it mv b gy nb nc l nd ne">hello there<br/>how is life?<br/>today is over<br/>don't be sad<br/>tomorrow is a new day</span></pre><p id="08b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，你正试图用<em class="nf">明天将开始</em>来定位并替换<em class="nf">今天已经结束</em>这句话。你可以用下面的代码来实现。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6d37" class="na lw it mv b gy nb nc l nd ne">#!/usr/bin/env bash</span><span id="a282" class="na lw it mv b gy ng nc l nd ne">YOUR_FILE='testing.txt'<br/>TEXT="today is over"</span><span id="7ab5" class="na lw it mv b gy ng nc l nd ne">sed -i "" "s/$TEXT/tomorrow will begin/" $YOUR_FILE</span></pre><p id="8dde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们来分析一下。</p><ul class=""><li id="1210" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated"><code class="fe ms mt mu mv b"><strong class="lb iu">$YOUR_FILE</strong></code>:你要读的行的文件。</li><li id="1fff" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe ms mt mu mv b"><strong class="lb iu">$TEXT</strong></code>:您试图替换的文本块。</li><li id="1809" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe ms mt mu mv b"><strong class="lb iu">-i</strong></code>:基本上意味着它会就地改变文件。</li><li id="a41f" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe ms mt mu mv b"><strong class="lb iu">“”</strong></code><strong class="lb iu">:<code class="fe ms mt mu mv b">-i</code>后的</strong>双引号是<strong class="lb iu"> <em class="nf">只针对Mac </em> </strong>。在Mac上,<code class="fe ms mt mu mv b">-i</code>选项需要一个用于备份的扩展。如果不想备份，可以只使用空引号。</li><li id="57b1" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe ms mt mu mv b"><strong class="lb iu">s</strong></code> <strong class="lb iu"> : </strong>替代命令。</li><li id="15b1" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe ms mt mu mv b"><strong class="lb iu">$line</strong></code>:要更换的线。</li><li id="a804" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe ms mt mu mv b"><strong class="lb iu">tomorrow will begin</strong></code>:用于替换<code class="fe ms mt mu mv b">$TEXT</code>。</li></ul><p id="2534" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述命令将找到所有出现<code class="fe ms mt mu mv b">$TEXT</code>的行。所以如果你的<code class="fe ms mt mu mv b">.txt</code>文件看起来像这样…</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c32a" class="na lw it mv b gy nb nc l nd ne">hello there<br/>today is over<br/>how is life?<br/>today is over<br/>don't be sad<br/>today is over<br/>tomorrow is a new day</span></pre><p id="ee83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">…运行上述命令后，它将看起来像这样…</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0436" class="na lw it mv b gy nb nc l nd ne">hello there<br/><strong class="mv iu">tomorrow will begin</strong><br/>how is life?<br/><strong class="mv iu">tomorrow will begin</strong><br/>don't be sad<br/><strong class="mv iu">tomorrow will begin</strong><br/>tomorrow is a new day</span></pre><p id="7459" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果我们在<em class="nf">相同的</em>行上有多个<code class="fe ms mt mu mv b">today is over</code>实例会怎样？</p><h1 id="9d81" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">全球使用案例</h1><p id="79de" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">上面的命令有效，但是每行只对<em class="nf">有效一次。这是因为我们没有在命令中提供一个<strong class="lb iu">全局</strong>标签。如果您的<code class="fe ms mt mu mv b">.txt</code>文件看起来像这样…</em></p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="4529" class="na lw it mv b gy nb nc l nd ne">hello there<br/>today is over today is over today is over<br/>how is life?<br/>don't be sad<br/>tomorrow is a new day</span></pre><p id="edf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">…上面的命令将使它像这样工作…</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="9611" class="na lw it mv b gy nb nc l nd ne">hello there<br/><strong class="mv iu">tomorrow will begin </strong>today is over today is over<br/>how is life?<br/>don't be sad<br/>tomorrow is a new day</span></pre><p id="d0fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果想要获得所有实例，可以在sed命令的末尾追加<code class="fe ms mt mu mv b">/g</code>。像这样:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c70d" class="na lw it mv b gy nb nc l nd ne">sed -i "" "s/$TEXT/tomorrow will begin<strong class="mv iu">/g</strong>" $YOUR_FILE</span></pre><p id="f261" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将确保<strong class="lb iu">的所有</strong>实例都被替换，不管一行中有多少个。噪音。</p><p id="7cc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是如果我们只想得到第一个实例呢？还是只有前两个例子？</p><p id="7299" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在知道了如何获得所有的<code class="fe ms mt mu mv b">$TEXT</code>实例，但是如果<code class="fe ms mt mu mv b">$TEXT</code>不是如此简单呢？如果我们的<code class="fe ms mt mu mv b">.txt</code>文件有这样的内容会怎么样…</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a2b6" class="na lw it mv b gy nb nc l nd ne">hello there<br/>how is life?<br/>today is over<br/>don't be sad! Just say, "life is good!"<br/>tomorrow is a new day</span></pre><h1 id="43f7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">特殊字符大小写</h1><p id="af16" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们这里有一个“特殊字符”的实例。这些字符在Bash中没有字面意义<a class="ae ky" href="https://mywiki.wooledge.org/BashGuide/SpecialCharacters#:~:text=Special%20characters,or%20%22meta%2Dcharacters%22." rel="noopener ugc nofollow" target="_blank"/>。相反，他们自己执行一个特殊的指令。</p><p id="1034" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里找到特殊字符及其含义的列表<a class="ae ky" href="https://www.oreilly.com/library/view/learning-the-bash/1565923472/ch01s09.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="e6f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第四行，你可以看到我们有一些特殊的字符，如撇号(或单引号)，感叹号，逗号，<strong class="lb iu"> <em class="nf">和</em> </strong>一些文本在 <em class="nf">双引号</em>里面有一个感叹号<strong class="lb iu">。</strong></p><p id="8b6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了处理特殊字符，使它们不被视为操作符，您需要使用所谓的反斜杠转义。</p><p id="70e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参见下面的代码。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="56c7" class="na lw it mv b gy nb nc l nd ne">#!/usr/bin/env bash</span><span id="1645" class="na lw it mv b gy ng nc l nd ne">YOUR_FILE='testing.txt'<br/>TEXT="don't be sad! Just say, "life is good!""</span><span id="34a6" class="na lw it mv b gy ng nc l nd ne">sed -i "" "s/$TEXT/tomorrow will begin/" $YOUR_FILE</span></pre><p id="7fb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您要运行这个脚本，您不会找到第四行并用<code class="fe ms mt mu mv b">tomorrow will begin</code>替换它，而是会给您一个错误:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="8748" class="na lw it mv b gy nb nc l nd ne">./test.sh: line 4: is: command not found<br/>sed: first RE may not be empty</span></pre><p id="498b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了让它工作，你需要用反斜杠“转义”双引号。见下文。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="116d" class="na lw it mv b gy nb nc l nd ne">LINE="don't be sad! Just say, \"life is good!\""</span></pre><p id="a705" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你再次重新运行你的脚本，它应该工作！现在，你可能会问自己，其他角色呢？为什么他们不需要被逃脱？</p><p id="13bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在当前的用例中，它们不需要转义，因为整行都用引号括起来了。引用，是转义特殊字符的另一种方式。但是，正如你在上面看到的，我们需要使用反斜杠转义，因为我们在双引号里面有双引号。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><p id="2fae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Bash中如何替换文本？我错过了什么？请在评论中告诉我！</p><p id="40fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://matt-croak.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="nf">升级您的免费媒体会员资格</em> </strong> </a> <em class="nf">并接收来自各种出版物上数千名作家的无限量、无广告的故事。这是一个附属链接，你的会员资格的一部分帮助我为我创造的内容获得奖励。</em></p><p id="d327" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以通过电子邮件   <em class="nf">订阅，每当我发布新内容时，你都会收到通知！</em></p><h1 id="6d11" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><div class="oc od gp gr oe of"><a href="https://mywiki.wooledge.org/BashGuide/SpecialCharacters#:~:text=Special%20characters,or%20%22meta%2Dcharacters%22." rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">bash guide/特殊字符</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">一些字符被Bash评估为具有非字面意义。相反，这些角色执行一个特殊的…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">mywiki.wooledge.org</p></div></div></div></a></div><div class="oc od gp gr oe of"><a href="https://www.oreilly.com/library/view/learning-the-bash/1565923472/ch01s09.html" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">学习bash Shell，第二版</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">表1.6仅给出了shell命令行中所有特殊字符的含义。其他角色有特殊的…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">www.oreilly.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ks of"/></div></div></a></div></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="3e35" class="lv lw it bd lx ly ou ma mb mc ov me mf jz ow ka mh kc ox kd mj kf oy kg ml mm bi translated">分级编码</h1><p id="eee8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="8326" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="6711" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>中的更多内容</li><li id="0724" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="8d20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/jobs?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">软件工程师的顶级工作</strong> </a></p></div></div>    
</body>
</html>