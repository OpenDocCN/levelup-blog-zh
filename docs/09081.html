<html>
<head>
<title>Timer and Ticker Using Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Golang的计时器和跑马灯</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/timer-and-ticker-using-golang-933a6d00a832?source=collection_archive---------3-----------------------#2021-07-05">https://levelup.gitconnected.com/timer-and-ticker-using-golang-933a6d00a832?source=collection_archive---------3-----------------------#2021-07-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ca1e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">计时器和跑马灯让你编写代码，在未来执行，一次或重复。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/67278a95e7a63fea5fd06de2b26b0da9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MI5AR2HlLRR7TZgNn72NlQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@veri_ivanova?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">维里·伊万诺娃</a>在<a class="ae kv" href="https://unsplash.com/s/photos/timer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="f9f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将介绍Go中的计时器和计时器，以及如何在自己的Go应用程序中有效地使用它们。</p><h2 id="e073" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">计时器与计时器</h2><p id="dd09" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><strong class="ky ir">计时器— </strong>用于一次性任务。它代表未来的单一事件。你告诉定时器你想等多久，它提供了一个通道，到时候会通知。</p><p id="370f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">滚动条</strong> —当你需要在给定的时间间隔内重复执行一个动作时，滚动条非常有用。我们可以结合使用tickers和goroutines在应用程序的后台运行这些任务。</p><h2 id="d311" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">一个简单的<strong class="ak">定时器</strong></h2><p id="34bc" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">让我们从一个非常简单的计时器开始，它将在2秒钟后运行。时间的执行与goroutine相关联。使用<code class="fe mq mr ms mt b"><strong class="ky ir"><em class="mu">done</em></strong></code> <strong class="ky ir"> <em class="mu"> </em> </strong>的目的只是为了控制程序的执行。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">代码清单1.1 — <a class="ae kv" href="https://play.golang.org/p/jOjaCsnUiZY" rel="noopener ugc nofollow" target="_blank">点击运行</a></figcaption></figure><h2 id="2d1d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">圈数前停止计时器</h2><p id="8231" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在下面的代码清单中，您可以调用计时器上的<code class="fe mq mr ms mt b"><strong class="ky ir">Stop()</strong></code> <strong class="ky ir"> </strong>方法来停止它的执行。我们已经配置了一个10秒后执行的时间，但是第14行提前停止了它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">代码清单1.2 — <a class="ae kv" href="https://play.golang.org/p/FBIx6SxnaD1" rel="noopener ugc nofollow" target="_blank">点击运行</a></figcaption></figure><h2 id="734e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">简单的跑马灯</h2><p id="237d" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">让我们从一个非常简单的开始，我们每1秒钟重复运行一个简单的<code class="fe mq mr ms mt b">fmt.Println</code>语句。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">代码清单1.3 — <a class="ae kv" href="https://play.golang.org/p/G-F7ioT1vU8" rel="noopener ugc nofollow" target="_blank">点击运行</a></figcaption></figure><h2 id="e87c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">停止跳动</h2><p id="09e9" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在下面的代码清单中，ticker被配置为每1秒钟执行一次。编写一个goroutine来监视是否收到了ticker事件，或者done通道是否收到了停止它的信号。在向<code class="fe mq mr ms mt b"><strong class="ky ir"><em class="mu">done</em></strong></code>通道发送信号之前，在第24行，我们已经调用了<code class="fe mq mr ms mt b"><em class="mu">time.Sleep(10*time. Second)</em></code> <em class="mu"> </em>让ticker执行10次。</p><p id="0b2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">休眠10秒钟后，将执行第25行的语句，这将导致停止ticker。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">代码清单1.4 — <a class="ae kv" href="https://play.golang.org/p/l1DUFYNk893" rel="noopener ugc nofollow" target="_blank">点击运行</a></figcaption></figure><h2 id="0dfd" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">背景股票</h2><p id="b962" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">如果我们有一个希望在后台运行的任务，我们可以将迭代<code class="fe mq mr ms mt b">ticker.C</code>的<code class="fe mq mr ms mt b">for</code>循环移到<code class="fe mq mr ms mt b">goroutine</code>内部，这将允许我们的应用程序执行其他任务。</p><p id="c4fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们移动代码来创建ticker，并将其循环到一个名为<code class="fe mq mr ms mt b">bgTask()</code>的新函数中，然后，在我们的<code class="fe mq mr ms mt b">main()</code>函数中，我们将使用<code class="fe mq mr ms mt b">go</code>关键字调用这个函数作为goroutine，如下所示</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">代码清单1.5 — <a class="ae kv" href="https://play.golang.org/p/V4KXntZkuVG" rel="noopener ugc nofollow" target="_blank">点击运行</a></figcaption></figure><h2 id="c5c6" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><p id="314b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我们经常希望在未来的某个时间点执行Go代码，或者每隔一段时间重复执行一次。Go的内置<code class="fe mq mr ms mt b"><em class="mu">timer</em></code>和<code class="fe mq mr ms mt b"><em class="mu">ticker</em></code>功能让这两项任务变得简单。我们可以以一种可控的方式使用这些实现。</p><p id="ee53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前就这些了…继续学习…..快乐学习😃</p></div></div>    
</body>
</html>