<html>
<head>
<title>Serialize and Save ML Models for Future Use in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">序列化并保存ML模型，以备将来在Python中使用</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/serialize-and-save-ml-models-for-future-use-in-python-c0953e4193f9?source=collection_archive---------24-----------------------#2022-09-26">https://levelup.gitconnected.com/serialize-and-save-ml-models-for-future-use-in-python-c0953e4193f9?source=collection_archive---------24-----------------------#2022-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="738e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">增加毅力和避免长时间再培训的实用指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e61e895f05def7965b568b98ce00321e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0_1kUe2LpUvhh_dC"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@steve_j?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯蒂夫·约翰森</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="e752" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为数据科学家，<strong class="lb iu">我们每天都和模型打交道</strong>。有时，模型在训练阶段需要不连续的时间，保存一个(完成的)模型可能会有所帮助。</p><p id="b6b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存模型的过程被称为<strong class="lb iu">序列化</strong>，它有几个优点。比如<strong class="lb iu">将来重用模型</strong>，<strong class="lb iu">创建一个演示app </strong>来展示它的特性，或者干脆<strong class="lb iu">避免再培训</strong>。</p><p id="d074" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">存在不同的<strong class="lb iu">序列化(和反序列化)</strong>模型的方式，但是在本文中，<strong class="lb iu">我将介绍以下两种</strong>:</p><ol class=""><li id="cedf" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu"> <em class="me">序列化库(Joblib，Pickle，…) </em> </strong></li><li id="99f1" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><strong class="lb iu"> <em class="me">机器学习库提供的专用序列化方法</em> </strong></li></ol><p id="f825" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们探索这些替代方案:)</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h2 id="6e93" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">1.序列化库</h2><p id="b8eb" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在这个类别中，<strong class="lb iu">两个比较知名的库是</strong> <a class="ae ky" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">泡菜</strong> </a> <strong class="lb iu">和</strong> <a class="ae ky" href="https://joblib.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Joblib </strong> </a>。</p><p id="f3c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些库的主要任务是<strong class="lb iu">实现可再现性，避免多次计算相同的东西</strong>。有保证的持久性允许<strong class="lb iu">恢复计算任务</strong>。这些解决方案通常比定制的写入磁盘脚本效果更好。[1, 2]</p><p id="ee75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以两者都用，但是Joblib在管理大型NumPy数组时更有效。</p><p id="e3d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住:你应该<strong class="lb iu">永远不要对来自不可信来源</strong>的<strong class="lb iu">对象使用这些库</strong>。</p><p id="fa4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为<strong class="lb iu">加载序列化对象时</strong>可以执行任意(恶意)代码。<strong class="lb iu">只反序列化你可以信任的对象</strong>【3】。</p><p id="43ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看这些库是如何工作的。</p><ul class=""><li id="a569" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu np mb mc md bi translated"><strong class="lb iu"> <em class="me">泡菜:</em> </strong></li></ul><p id="b581" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我们序列化了一个名为<code class="fe nq nr ns nt b">model</code>的模型。这个操作的输出是磁盘上的一个文件，名为<code class="fe nq nr ns nt b">output.pkl</code>。这个模型可以照常加载和使用。[2]</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">用pickle进行序列化和反序列化。作者代码</figcaption></figure><ul class=""><li id="25fc" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu np mb mc md bi translated"><strong class="lb iu"> <em class="me"> Joblib: </em> </strong></li></ul><p id="2608" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我们序列化了同一个叫做<code class="fe nq nr ns nt b">model</code>的模型。输出是磁盘上的一个文件，这次命名为<code class="fe nq nr ns nt b">output.joblib</code>。与Pickle一样，我们可以加载模型并使用它。Joblib的<code class="fe nq nr ns nt b">dump</code>和<code class="fe nq nr ns nt b">load</code>函数基于Python Pickle序列化。[1]</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">用joblib序列化和反序列化。作者代码</figcaption></figure><p id="1393" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见<strong class="lb iu">这两种方法工作方式相似，</strong>保存你的模型<strong class="lb iu">非常简单</strong>。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/bc41fcd6f9a6e69c6067ee0ad4ec9108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HCxBLzMCZG1SIAo1"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Markus Spiske </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="1d2c" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">2.ML库提供的专用序列化方法</h2><p id="c4bb" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在这个选项中包含了那些为保存和加载特定模型提供定制方法的<strong class="lb iu">库。</strong></p><p id="e209" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不可能提到所有提供专用方法的库。总是<strong class="lb iu">检查你使用的库的官方文档</strong>以了解是否有可用的方法以及哪些方法可用。一般来说，<strong class="lb iu">如果一个库提供了专用的方法</strong>，那么使用那些总是<strong class="lb iu">最好。</strong></p><p id="c7ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">举个例子</strong>，不得不介绍一下Gensim。<a class="ae ky" href="https://radimrehurek.com/gensim/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Gensim </strong> </a> <strong class="lb iu">是一个开源的、生产就绪的库</strong>，它提供了<strong class="lb iu">自然语言处理(NLP)和主题建模特性</strong>【4】。</p><p id="53a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特别是我使用了<strong class="lb iu"> Doc2Vec </strong>模型，其中<a class="ae ky" href="https://en.wikipedia.org/wiki/Sentence_embedding" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">将</strong> </a> <strong class="lb iu">一组单词嵌入到一个向量</strong>中，考虑到语义(文本的语义表示)。</p><p id="e5be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Doc2Vec模型可能很难训练，而<strong class="lb iu"> Gensim提供了保存和加载已训练模型</strong>的具体方法，避免了重新训练。下面是Gensim <code class="fe nq nr ns nt b">save</code>和<code class="fe nq nr ns nt b">load</code>函数的工作方式[4]:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">用Gensim保存并加载Doc2Vec模型。作者代码</figcaption></figure><p id="0c70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Gensim为其他模型</strong>提供了类似的方法，比如Word2Vec。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h2 id="1321" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">结论</h2><p id="2a4e" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated"><strong class="lb iu">如果你有合适的工具，序列化一个模型既简单又聪明</strong>。<strong class="lb iu"> Pickle和Joblib提供了一个简单通用的方法</strong>来保存和加载对象和模型，但是<strong class="lb iu">与不可信数据</strong>有一个共同的安全问题。</p><p id="12fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">其他ML库</strong>，如Gensim，<strong class="lb iu">提供了工作良好且易于使用的定制方法</strong>。</p><p id="e12b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你需要<strong class="lb iu">为你的推荐系统序列化一个Scikit-learn模型或者一个相似矩阵</strong>，你可以使用<strong class="lb iu"> Joblib </strong>。如果您使用的是<strong class="lb iu">不同的库，</strong> <strong class="lb iu">查看文档</strong>查看<strong class="lb iu">是否有</strong> <strong class="lb iu">具体方法使用</strong>。并利用它们。</p><p id="1f79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="me">感谢阅读，快乐模型连载:)</em></p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="99d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能对以下内容感兴趣:</p><div class="nx ny gp gr nz oa"><a href="https://pub.towardsai.net/improve-your-classification-models-with-threshold-tuning-bb69fca15114" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">通过阈值调整改进您的分类模型</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">实用而重要的指南</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">pub.towardsai.net</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a href="https://pub.towardsai.net/sql-vs-nosql-choose-the-most-convenient-technology-4506d831b6e4" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">SQL与NoSQL:选择最方便的技术</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">数据库的酸碱属性</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">pub.towardsai.net</p></div></div><div class="oj l"><div class="op l ol om on oj oo ks oa"/></div></div></a></div></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h2 id="2f77" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">参考</h2><p id="ba14" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">[1] <a class="ae ky" href="https://joblib.readthedocs.io/en/latest/persistence.html" rel="noopener ugc nofollow" target="_blank"> JobLib文档</a>，readthedocs.io</p><p id="5ff8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] <a class="ae ky" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank">咸菜文献</a>，docs.python.org</p><p id="3990" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3] <a class="ae ky" href="https://www.ibm.com/support/pages/security-bulletin-wml-ce-scikit-learn-vulnerable-irresponsible-usage-0" rel="noopener ugc nofollow" target="_blank">安全公告:WML CE sci kit-learn vulnerable to responsible usage</a>(2020)，IBM支持</p><p id="d60e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[4] <a class="ae ky" href="https://radimrehurek.com/gensim/auto_examples/index.html#documentation" rel="noopener ugc nofollow" target="_blank"> Gensim文件</a>，radimrehurek.com</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="df26" class="oq ms it bd mt or os ot mw ou ov ow mz jz ox ka nc kc oy kd nf kf oz kg ni pa bi translated">分级编码</h1><p id="c81e" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="14c5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu np mb mc md bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="7013" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu np mb mc md bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="1c84" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu np mb mc md bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="77b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">将像你这样的开发人员安置在顶级创业公司和科技公司</strong> </a></p></div></div>    
</body>
</html>