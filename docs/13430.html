<html>
<head>
<title>Ways to Define Custom Command-Line Flags in Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨Golangä¸­å®šä¹‰è‡ªå®šä¹‰å‘½ä»¤è¡Œæ ‡å¿—çš„æ–¹æ³•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/ways-to-define-custom-command-line-flags-in-golang-f7f47d55258f?source=collection_archive---------4-----------------------#2022-09-03">https://levelup.gitconnected.com/ways-to-define-custom-command-line-flags-in-golang-f7f47d55258f?source=collection_archive---------4-----------------------#2022-09-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3ba6ebc03c58cfcbad8825af3ddedc65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LHQ9n5Q1WD7IIsV5"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><em class="kc">Photo by</em><a class="ae kd" href="https://unsplash.com/@joshuafuller" rel="noopener ugc nofollow" target="_blank"><em class="kc">@ Joshua fuller</em></a><em class="kc">on Unsplash</em></figcaption></figure><h1 id="c901" class="ke kf iq bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">ä»‹ç»</h1><p id="29ad" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">å¦‚æœæ‚¨ç†Ÿæ‚‰å‘½ä»¤è¡Œç•Œé¢ï¼Œæ‚¨å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼äº<code class="fe ma mb mc md b">-h</code>ã€<code class="fe ma mb mc md b">-v</code>ã€<code class="fe ma mb mc md b">--name foo</code>ç­‰æ ‡å¿—ã€‚ä¸€äº›æ ‡å¿—ä½¿ç”¨åŸå§‹æ•°æ®ç±»å‹ï¼Œå¦‚<code class="fe ma mb mc md b">string</code>ã€<code class="fe ma mb mc md b">int</code>ã€<code class="fe ma mb mc md b">bool</code>ç­‰ã€‚å…¶ä½™çš„æ ‡å¿—æ˜¯ä½¿ç”¨ç‰¹å®šæ¨¡å¼æˆ–æ•°æ®ç»“æ„çš„è‡ªå®šä¹‰æ ‡å¿—ï¼Œå¦‚<code class="fe ma mb mc md b">IP</code>ã€<code class="fe ma mb mc md b">URL</code>ã€<code class="fe ma mb mc md b">Array</code>ã€<code class="fe ma mb mc md b">Map</code>ç­‰ã€‚Golangæä¾›äº†ä¸€ä¸ªåä¸º<code class="fe ma mb mc md b">flag</code>çš„å†…ç½®åº“æ¥å®šä¹‰å‘½ä»¤è¡Œæ ‡å¿—ã€‚æä¾›çš„ä¸€äº›å®šä¹‰æ ‡å¿—çš„å‡½æ•°éå¸¸ç®€å•ï¼Œå¦‚<code class="fe ma mb mc md b">flag.String</code>ã€<code class="fe ma mb mc md b">flag.Int</code>ç­‰ã€‚ä½†æ˜¯ï¼Œè‡ªå®šä¹‰çš„æ——å¸œå‘¢ï¼Ÿåœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†å­¦ä¹ ä¸€äº›åœ¨Golangä¸­å®šä¹‰è‡ªå®šä¹‰å‘½ä»¤è¡Œæ ‡å¿—çš„æ–¹æ³•ã€‚</p><h1 id="8543" class="ke kf iq bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">ä¾‹å­</h1><p id="5d64" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">å‡è®¾æ‚¨æƒ³è¦åˆ›å»ºä¸€ä¸ªæ¥å—å­—ç¬¦ä¸²å€¼åˆ—è¡¨çš„è‡ªå®šä¹‰æ ‡å¿—ã€‚æ ‡å¿—çš„ç”¨æ³•åº”è¯¥æ˜¯è¿™æ ·çš„:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="edba" class="mm kf iq md b gy mn mo l mp mq">$ go run main.go --list a --list b,c,d<br/>[a b c d]</span></pre><p id="8e10" class="pw-post-body-paragraph lc ld iq le b lf mr lh li lj ms ll lm ln mt lp lq lr mu lt lu lv mv lx ly lz ij bi translated">ä¸‹é¢æ˜¯ä¸€äº›å®šä¹‰è‡ªå®šä¹‰æ ‡å¿—çš„æ–¹æ³•ã€‚</p><h1 id="a9ea" class="ke kf iq bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">æ ‡å¿—å˜é‡</h1><p id="1228" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><code class="fe ma mb mc md b">flag.Var</code>æ˜¯å®šä¹‰è‡ªå®šä¹‰æ ‡å¿—çš„ä¸€ç§æ–¹å¼ã€‚å®ƒæ¥å—å®ç°<code class="fe ma mb mc md b">flag.Value</code>æ¥å£çš„è‡ªå®šä¹‰ç»“æ„ã€‚</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="16f4" class="mm kf iq md b gy mn mo l mp mq">type ListFlag []string</span><span id="54e4" class="mm kf iq md b gy mw mo l mp mq">func (f *ListFlag) String() string {<br/> b, _ := json.Marshal(*f)<br/> return string(b)<br/>}</span><span id="b88e" class="mm kf iq md b gy mw mo l mp mq">func (f *ListFlag) Set(value string) error {<br/> for _, str := range strings.Split(value, ",") {<br/>  *f = append(*f, str)<br/> }<br/> return nil<br/>}</span><span id="3a3e" class="mm kf iq md b gy mw mo l mp mq">func main() {<br/>    // foo and bar as a default value<br/> list := ListFlag([]string{"foo", "bar"})<br/> flag.Var(&amp;list, "list", "your flag usage")</span><span id="98f6" class="mm kf iq md b gy mw mo l mp mq"> flag.Parse()<br/> fmt.Println(list) // [foo bar a b c d]<br/>}</span></pre><p id="da0a" class="pw-post-body-paragraph lc ld iq le b lf mr lh li lj ms ll lm ln mt lp lq lr mu lt lu lv mv lx ly lz ij bi translated">éœ€è¦æ³¨æ„çš„é‡è¦ä¸€ç‚¹æ˜¯<code class="fe ma mb mc md b">Set</code>æ–¹æ³•ã€‚æ¯æ¬¡è°ƒç”¨æ‚¨çš„æ ‡å¿—æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨<code class="fe ma mb mc md b">Set</code>æ–¹æ³•ã€‚</p><h1 id="9ba0" class="ke kf iq bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">æ ‡å¿—åŠŸèƒ½</h1><p id="dd76" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><code class="fe ma mb mc md b">flag.Func</code>æ˜¯ä¸€ç§å®šä¹‰è‡ªå®šä¹‰æ ‡å¿—çš„ç®€å•æ–¹æ³•ã€‚å®ƒä½¿ç”¨äº†<code class="fe ma mb mc md b">flag.Var</code>,æ‰€ä»¥ä½ ä¸éœ€è¦åˆ›å»ºä¸€ä¸ªå®šåˆ¶çš„ç»“æ„ã€‚</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="676d" class="mm kf iq md b gy mn mo l mp mq">func main() {<br/> list := ListFlag([]string{"foo", "bar"})<br/> flag.Func("list", "your flag usage", func(s string) error {<br/>  for _, str := range strings.Split(s, ",") {<br/>   list = append(list, str)<br/>  }<br/>  return nil<br/> })</span><span id="5625" class="mm kf iq md b gy mw mo l mp mq"> flag.Parse()<br/> fmt.Println(list) // [foo bar a b c d]<br/>}</span></pre><p id="974c" class="pw-post-body-paragraph lc ld iq le b lf mr lh li lj ms ll lm ln mt lp lq lr mu lt lu lv mv lx ly lz ij bi translated">å¦‚æ‚¨æ‰€è§ï¼Œ<code class="fe ma mb mc md b">flag.Func</code>çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯æ‚¨åœ¨å‰ä¸€ä¸ªç¤ºä¾‹ä¸­å®ç°çš„ä¸€ä¸ª<code class="fe ma mb mc md b">Set</code>æ–¹æ³•ã€‚</p><h1 id="c5bb" class="ke kf iq bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">æ ‡å¿—æ–‡æœ¬å˜é‡</h1><p id="4323" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><code class="fe ma mb mc md b">flag.TextVar</code>æ˜¯<code class="fe ma mb mc md b">go1.19</code>ä¸­å¼•å…¥çš„æ–°æ–¹å¼ã€‚å®ƒåƒ<code class="fe ma mb mc md b">flag.Func</code>ä¸€æ ·ä½¿ç”¨äº†å¼•æ“ç›–ä¸‹çš„<code class="fe ma mb mc md b">flag.Var</code>ï¼Œä½†å®ƒæ¥å—äº†ä¸€ä¸ª<code class="fe ma mb mc md b">encoding.TextUnmarshaler</code>å’Œ<code class="fe ma mb mc md b">encoding.TextMarshaler</code>æ¥å£ï¼Œè€Œä¸æ˜¯<code class="fe ma mb mc md b">flag.Value</code>æ¥å£ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥ä½¿ç”¨åƒ<code class="fe ma mb mc md b">big.Int</code>ã€<code class="fe ma mb mc md b">netip.Addr</code>å’Œ<code class="fe ma mb mc md b">time.Time</code>è¿™æ ·çš„å†…ç½®ç»“æ„ä½œä¸ºæ ‡å¿—ï¼Œè€Œæ— éœ€å®ç°è‡ªå®šä¹‰ç»“æ„ã€‚</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="d153" class="mm kf iq md b gy mn mo l mp mq">type ListFlag []string</span><span id="f5f7" class="mm kf iq md b gy mw mo l mp mq">func (f *ListFlag) MarshalText() ([]byte, error) {<br/> return json.Marshal(*f)<br/>}</span><span id="a678" class="mm kf iq md b gy mw mo l mp mq">func (f *ListFlag) UnmarshalText(b []byte) error {<br/> for _, str := range strings.Split(string(b), ",") {<br/>  *f = append(*f, str)<br/> }<br/> return nil<br/>}</span><span id="55d5" class="mm kf iq md b gy mw mo l mp mq">func main() {<br/> list := ListFlag([]string{"foo", "bar"})<br/> flag.TextVar(&amp;list, "list", &amp;list, "your flag usage")</span><span id="d8d6" class="mm kf iq md b gy mw mo l mp mq"> flag.Parse()<br/> fmt.Println(list)<br/>}</span></pre><p id="88fb" class="pw-post-body-paragraph lc ld iq le b lf mr lh li lj ms ll lm ln mt lp lq lr mu lt lu lv mv lx ly lz ij bi translated">å¦‚ä½ æ‰€è§ï¼Œå®ƒä¸<code class="fe ma mb mc md b">flag.Var</code>ç›¸ä¼¼ï¼Œä½†å®ƒä½¿ç”¨<code class="fe ma mb mc md b">MarshalText</code>å’Œ<code class="fe ma mb mc md b">UnmarshalText</code>è€Œä¸æ˜¯<code class="fe ma mb mc md b">String</code>å’Œ<code class="fe ma mb mc md b">Set</code>æ–¹æ³•ã€‚</p><h1 id="e4c2" class="ke kf iq bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">ç»“è®º</h1><p id="efb3" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">ç°åœ¨æ‚¨çŸ¥é“äº†ä¸€äº›åœ¨Golangä¸­å®šä¹‰è‡ªå®šä¹‰å‘½ä»¤è¡Œæ ‡å¿—çš„æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº<code class="fe ma mb mc md b">flag</code>åŒ…çš„ä¿¡æ¯ï¼Œå¯ä»¥åœ¨è¿™é‡Œé˜…è¯»å®˜æ–¹æ–‡æ¡£<a class="ae kd" href="https://pkg.go.dev/flag" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><p id="dff1" class="pw-post-body-paragraph lc ld iq le b lf mr lh li lj ms ll lm ln mt lp lq lr mu lt lu lv mv lx ly lz ij bi translated">æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="2cd6" class="pw-post-body-paragraph lc ld iq le b lf mr lh li lj ms ll lm ln mt lp lq lr mu lt lu lv mv lx ly lz ij bi translated"><em class="ne">åŸè½½äº2022å¹´9æœˆ3æ—¥</em><a class="ae kd" href="https://clavinjune.dev/en/blogs/ways-to-define-custom-command-line-flags-in-golang/" rel="noopener ugc nofollow" target="_blank"><em class="ne">https://clavinjune . dev</em></a><em class="ne">ã€‚</em></p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="39dc" class="ke kf iq bd kg kh nf kj kk kl ng kn ko kp nh kr ks kt ni kv kw kx nj kz la lb bi translated">åˆ†çº§ç¼–ç </h1><p id="09dc" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼åœ¨ä½ ç¦»å¼€ä¹‹å‰:</p><ul class=""><li id="5b4f" class="nk nl iq le b lf mr lj ms ln nm lr nn lv no lz np nq nr ns bi translated">ğŸ‘ä¸ºæ•…äº‹é¼“æŒï¼Œè·Ÿç€ä½œè€…èµ°ğŸ‘‰</li><li id="3805" class="nk nl iq le b lf nt lj nu ln nv lr nw lv nx lz np nq nr ns bi translated">ğŸ“°æŸ¥çœ‹<a class="ae kd" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">å‡çº§ç¼–ç å‡ºç‰ˆç‰©</a>ä¸­çš„æ›´å¤šå†…å®¹</li><li id="c0de" class="nk nl iq le b lf nt lj nu ln nv lr nw lv nx lz np nq nr ns bi translated">ğŸ””å…³æ³¨æˆ‘ä»¬:<a class="ae kd" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kd" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kd" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">æ—¶äº‹é€šè®¯</a></li></ul><p id="b08c" class="pw-post-body-paragraph lc ld iq le b lf mr lh li lj ms ll lm ln mt lp lq lr mu lt lu lv mv lx ly lz ij bi translated">ğŸš€ğŸ‘‰<a class="ae kd" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="le ir">åŠ å…¥å‡çº§äººæ‰é›†ä½“ï¼Œæ‰¾åˆ°ä¸€ä»½æƒŠè‰³çš„å·¥ä½œ</strong> </a></p></div></div>    
</body>
</html>