<html>
<head>
<title>RShiny Authentication with Polished on AWS Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS Kubernetes上使用抛光的RShiny认证</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/rshiny-authentication-with-polished-on-aws-kubernetes-358baff9a61c?source=collection_archive---------13-----------------------#2020-07-07">https://levelup.gitconnected.com/rshiny-authentication-with-polished-on-aws-kubernetes-358baff9a61c?source=collection_archive---------13-----------------------#2020-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e1e791fb093106fda52818983756fcc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RBYDUXeizAdy02TP.jpg"/></div></div></figure><p id="320a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你正在寻找一种便捷的方式为你的RShiny应用添加认证，你应该看看<a class="ae kw" href="http://polished.tech/" rel="noopener ugc nofollow" target="_blank"> polished.tech </a>。用他们自己的话说:</p><blockquote class="kx ky kz"><p id="83e8" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><em class="iq"> Polished是一个R包，它为你闪亮的应用程序增加了认证、用户管理和其他功能。抛光。技术是最快和最简单的方法来使用抛光。</em></p><p id="e57d" class="jy jz la ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">Polished.tech提供了一个托管的API和仪表板，所以你不需要担心设置和维护polished API。有了polished.tech，您可以不再担心样板基础设施，并回到构建您的核心应用程序逻辑。</p></blockquote><p id="9046" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Polished.tech是一个托管解决方案，用于为您的RShiny应用程序添加身份验证。它对前10个用户是完全免费的，这给了你足够的自由来使用它。</p><p id="99aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我们将讨论如何:</p><ul class=""><li id="0f5e" class="le lf iq ka b kb kc kf kg kj lg kn lh kr li kv lj lk ll lm bi translated">快速轻松地开始使用polished.tech托管解决方案，并获取您的API证书</li><li id="6250" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">使用预构建的docker容器测试您的API凭证</li><li id="dc57" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">部署AWS Kubernetes (EKS)集群</li><li id="b8b4" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">将您的API凭据安全地添加到EKS集群</li><li id="07d2" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">使用polished.tech身份验证，使用示例RShiny应用程序部署舵图！</li></ul><p id="829d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以让我们开始吧！</p><h1 id="a378" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">先决条件</h1><p id="0f24" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">为了完成本教程的AWS部分，您需要:</p><h1 id="d0b1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">码头工人</h1><p id="02f4" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">您将需要Docker来运行快速入门指南。</p><p id="b4dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我总是用我需要的所有CLI工具创建一个Docker映像，并将任何凭证的副本直接保存在项目文件夹中。您不需要特别了解如何使用Docker，因为我们只是将容器视为一个终端。</p><p id="7dec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您不想使用Docker，您需要安装Docker文件中显示的所有CLI工具，并在本地运行shiny应用程序。</p><h1 id="e948" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">AWS IAM用户</h1><p id="cbf9" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果您想部署到AWS，您需要一个AWS IAM用户，以及该用户的API密匙。更多信息参见<a class="ae kw" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-creds" rel="noopener ugc nofollow" target="_blank"> AWS文档</a>。</p><p id="aab1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同一个AWS IAM用户必须拥有创建EKS集群的权限。您可以使用<a class="ae kw" href="https://docs.aws.amazon.com/eks/latest/userguide/service_IAM_role.html" rel="noopener ugc nofollow" target="_blank">这个角色</a>，或者具有管理员权限的用户。</p><h1 id="2b51" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">快速启动</h1><p id="fe85" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果您已经有了完善的API证书，那么您可以从这里开始。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="fd92" class="ne lt iq na b gy nf ng l nh ni">docker run -it \<br/> --rm \<br/>-p 3838:3838 \<br/> -e POLISHED_APP_NAME="my_first_shiny_app" \<br/> -e POLISHED_API_KEY="XXXXXXXXXXXXXX" \<br/> jerowe/polished-tech:latest</span></pre><p id="32ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将您自己的凭证添加到<code class="fe nj nk nl na b">POLISHED_APP_NAME</code>和<code class="fe nj nk nl na b">POLISHED_API_KEY</code>中。</p><p id="c138" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后在<code class="fe nj nk nl na b">localhost:3838</code>打开浏览器，使用你的电子邮件和密码组合登录你的应用程序。</p><h1 id="e791" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">注册并获得您的证书</h1><p id="bdda" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">所有这些说明都在文档中<a class="ae kw" href="https://polished.tech/docs/get-started" rel="noopener ugc nofollow" target="_blank">，这里只是为了完整起见。</a></p><h1 id="cab3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">签约雇用</h1><p id="2fc9" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">前往<a class="ae kw" href="https://dashboard.polished.tech" rel="noopener ugc nofollow" target="_blank">仪表板URL </a>并注册。从那里，登录，你会看到你的帐户仪表板。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/d31f422abc47fd67899ea8c4eea0f6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q0pOxykE8gjnC8f79kwZ6A.png"/></div></div></figure><p id="91e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你使用谷歌或微软，系统会提示你使用这些账户登录。如果您使用电子邮件，系统会提示您创建密码。</p><h1 id="7f7a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">可选—社交登录与电子邮件和密码</h1><p id="35d3" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果您想使用社交登录并在AWS上部署，您需要使用<a class="ae kw" href="https://polished.tech/docs/firebase-setup" rel="noopener ugc nofollow" target="_blank">外部域</a>设置Firebase。如果您要部署到localhost之外的主机，并且想要使用Google之类的社交登录提供者，那么您只需要完成这一步。当我们进一步部署到AWS时，我们将进入更多的细节。</p><h1 id="f44a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">获取您的API密钥</h1><p id="c456" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">前往<a class="ae kw" href="https://dashboard.polished.tech/" rel="noopener ugc nofollow" target="_blank">仪表板</a>，在左侧菜单中，点击<em class="la">账户</em>获取您的密钥。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/bff49e7076dd278419a6f6ed300b0cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UVc8OyIolKG9PMCF.jpg"/></div></div></figure><p id="14e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">把它放在某个地方！从现在开始，我们将把它称为<code class="fe nj nk nl na b">POLISHED_API_KEY</code>。</p><h1 id="bd75" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">创建应用程序</h1><p id="ed56" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">你必须创建一个应用程序，整个计划才能发挥作用。</p><p id="aff6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在左侧菜单中点击<em class="la">闪亮应用</em>。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/dc037bd182f2e8aa7e3e91af3b3f37e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4xFEmjszaCUUHIx0.png"/></div></div></figure><p id="06d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">把它写在某个地方！从这里开始，我们将把它称为<code class="fe nj nk nl na b">POLISHED_APP_NAME</code>。</p><h1 id="20d7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">将应用程序与您的用户相关联</h1><p id="b598" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">(还有潜在的其他用户！)</p><p id="82ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦你有了一个应用，一定要把它和你的用户联系起来。这个第一次就把我难住了，因为我没有很好地遵循指示。；-)如果跳过这一步，您将无法登录。</p><p id="abd8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的仪表板左侧菜单中，转到<em class="la">用户</em>，将应用程序与用户相关联。</p><p id="8859" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以编辑用户以允许访问应用程序，也可以编辑应用程序以授予用户访问权限。两者都实现了相同的目标。</p><p id="3123" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">从用户菜单</strong></p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/723e4dd6cdb664c4cebd92a6444a2c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ceu_XBG54muf0t9g.jpg"/></div></div></figure><p id="318c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">从应用菜单</strong></p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/1e6e80eac5ce5953f4fc8164eab1da41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VAizJkVgWEKVCHhR.jpg"/></div></div></figure><h1 id="fb33" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">测试您的证书</h1><p id="f82f" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果你只是想测试你的凭证，运行<code class="fe nj nk nl na b">docker run</code>命令。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="2ad6" class="ne lt iq na b gy nf ng l nh ni">docker run -it \<br/> --rm \<br/> -p 3838:3838 \<br/> -e POLISHED_APP_NAME="my_first_shiny_app" \<br/> -e POLISHED_API_KEY="XXXXXXXXXXXXXX" \<br/> jerowe/polished-tech:latest</span></pre><p id="e589" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当然，我知道你之前写下的凭证。；-)</p><p id="5c78" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe nj nk nl na b">localhost:3838</code>打开浏览器，使用您的用户邮箱和密码登录。您应该会看到一个包含您的用户UID和会话信息的屏幕。成功！</p><h1 id="5faf" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">让我们部署我们的应用程序吧！</h1><p id="659d" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">在教程的下一部分，我们将讨论如何让你的应用程序进入大自然！我为此选择了Kubernetes，因为它在任何地方都可以工作，而且托管的AWS解决方案也很好。此外，部署到Kubernetes允许您轻松地加密API密钥、数据库凭证等。</p><h1 id="0d12" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">抓住密码</h1><p id="dc1f" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果你想继续克隆Github repo。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="7b9b" class="ne lt iq na b gy nf ng l nh ni">git clone <a class="ae kw" href="https://github.com/jerowe/rshiny-with-polished-tech-eks" rel="noopener ugc nofollow" target="_blank">https://github.com/jerowe/rshiny-with-polished-tech-eks</a></span></pre><h1 id="51d2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">项目结构</h1><p id="96c4" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">GitHub repo中有两个目录，<code class="fe nj nk nl na b">auto-deployment,</code>和<code class="fe nj nk nl na b">rshiny-app-polished-auth</code>。</p><p id="13fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe nj nk nl na b">auto-deployment</code>有一个(稍微修改的)<a class="ae kw" href="https://github.com/terraform-aws-modules/terraform-aws-eks" rel="noopener ugc nofollow" target="_blank">地形EKS </a>的配方，首先部署我们的EKS集群，安装我们的舵图，并做一些联网魔法。</p><p id="e02d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您以前从未使用过Terraform，请不要担心。它真的像一个语法更好的Makefile。<a class="ae kw" href="https://helm.sh/docs/topics/charts/" rel="noopener ugc nofollow" target="_blank">掌舵图</a>是Kubernetes打包和定义应用程序的首选方法。</p><p id="a2c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">深入掌舵图会让这篇文章<em class="la">太长，但我会在这篇文章中更深入地讨论<a class="ae kw" href="https://www.dabbleofdevops.com/blog/deploy-rshiny-on-kubernetes-with-a-helm-chart" rel="noopener ugc nofollow" target="_blank">。</a></em></p><p id="546a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">项目系统的根中还有一个<code class="fe nj nk nl na b">Dockerfile</code>。这个<code class="fe nj nk nl na b">Dockerfile</code>拥有部署EKS集群和安装掌舵图所需的一切。安装<code class="fe nj nk nl na b">aws-cli</code>、<code class="fe nj nk nl na b">terraform</code>、<code class="fe nj nk nl na b">helm</code>和<code class="fe nj nk nl na b">kubectl</code> cli工具。你可以在你的本地电脑上安装这些东西，但是那会很痛苦。；-)</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="a5a4" class="ne lt iq na b gy nf ng l nh ni">├── Dockerfile<br/>├── README.md<br/>├── auto-deployment<br/>│   ├── eks<br/>│   │   ├── aws.tf<br/>│   │   ├── helm.tf<br/>│   │   ├── helm_charts<br/>│   │   │   ├── rshiny-eks<br/>│   │   │   │   ├── Chart.yaml<br/>│   │   │   │   ├── charts<br/>│   │   │   │   ├── templates<br/>│   │   │   │   │   ├── NOTES.txt<br/>│   │   │   │   │   ├── _helpers.tpl<br/>│   │   │   │   │   ├── deployment.yaml<br/>│   │   │   │   │   ├── ingress.yaml<br/>│   │   │   │   │   ├── service.yaml<br/>│   │   │   │   │   ├── serviceaccount.yaml<br/>│   │   │   │   │   └── tests<br/>│   │   │   │   │       └── test-connection.yaml<br/>│   │   │   │   └── values.yaml<br/>│   │   ├── main.tf<br/>│   │   ├── outputs.tf<br/>│   │   └── variables.tf<br/>│   └── terraform-state<br/>│       ├── main.tf<br/>├── build_and_run_polished_app.sh<br/>└── rshiny-app-polished-auth<br/>    ├── Dockerfile<br/>    ├── app.R<br/>    └── shiny-server.sh</span></pre><h1 id="975e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">码头工人形象</h1><p id="3810" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我基于<a class="ae kw" href="https://hub.docker.com/r/rocker/shiny" rel="noopener ugc nofollow" target="_blank">摇杆/闪亮</a>图像构建了一个docker图像。</p><p id="d81a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里需要注意的重要事情是，我删除了默认的index.html和其他示例应用程序，并添加了我自己的应用程序</p><h2 id="10b4" class="ne lt iq bd lu nq nr dn ly ns nt dp mc kj nu nv mg kn nw nx mk kr ny nz mo oa bi translated">环境变量</h2><p id="cab8" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我添加了一个启动CMD来将<code class="fe nj nk nl na b">POLISHED_*</code>变量添加到<code class="fe nj nk nl na b">/home/shiny/.Renviron</code>。闪亮的服务器运行一个干净的过程，它不会拾取任何外部环境变量。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="4c4b" class="ne lt iq na b gy nf ng l nh ni"># rshiny-app-polished-auth/Dockerfile<br/>FROM rocker/shiny:4.0.0<br/><br/># Install everything needed for polished<br/><br/>RUN apt-get update &amp;&amp; apt-get install -y \<br/>    libssl-dev<br/><br/><br/>RUN R -e "install.packages('remotes')"<br/>RUN R -e "remotes::install_github('tychobra/polished')"<br/>RUN rm -rf /srv/shiny-server/*<br/>COPY app.R /srv/shiny-server/app.R<br/><br/>COPY shiny-server.sh /usr/bin/shiny-server.sh</span></pre><p id="7219" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe nj nk nl na b">shiny-server</code>进程干净地运行，这意味着我们必须从<code class="fe nj nk nl na b">~/.Renviron</code>文件中加载我们的<code class="fe nj nk nl na b">POLISHED_*</code>环境变量。如果您需要添加任何其他变量，请确保您在这里这样做，并重建docker映像！</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="002c" class="ne lt iq na b gy nf ng l nh ni"># rshiny-app-polished-auth/shiny-server.sh<br/>#!/bin/sh<br/><br/># Make sure that we add our Polished to our /home/shiny/.Renviron<br/>env | grep POLISHED &gt; /home/shiny/.Renviron<br/>chown shiny:shiny /home/shiny/.Renviron<br/><br/># Make sure the directory for individual app logs exists<br/>mkdir -p /var/log/shiny-server<br/>chown shiny.shiny /var/log/shiny-server<br/><br/>if [ "$APPLICATION_LOGS_TO_STDOUT" != "false" ];<br/>then<br/>    # push the "real" application logs to stdout with xtail in detached mode<br/>    exec xtail /var/log/shiny-server/ &amp;<br/>fi<br/><br/># start shiny server<br/>exec shiny-server 2&gt;&amp;1</span></pre><h1 id="725e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">更新AWS区域</h1><p id="c330" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">AWS区域被设置为<code class="fe nj nk nl na b">us-east-1</code>。如果你需要改变它，看看<code class="fe nj nk nl na b">auto-deployment/eks/variables.tf</code>和<code class="fe nj nk nl na b">auto-deployment/terraform-state/main.tf</code>。</p><h1 id="d3bd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">可选—社交登录的Firebase设置</h1><p id="9dd4" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果你想使用社会登录(谷歌，微软等)，你需要获得自己的Firebase帐户和凭证。如果你使用电子邮件和密码，你可以跳过这一步！</p><p id="137f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们将设置Firebase项目，然后我们将向该项目注册一个应用程序。</p><h1 id="4796" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">FireBase项目设置</h1><p id="bb1f" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">前往<a class="ae kw" href="https://console.firebase.google.com/u/0/?pli=1" rel="noopener ugc nofollow" target="_blank"> FireBase控制台</a>建立一个项目。这非常简单，向导会引导您完成所有步骤。从那里转到_Develop - &gt;认证- &gt;登录方法。_然后启用电子邮件+密码以及您喜欢的任何社交提供商。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/2647ce8ee0506782677db015db9eb08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OMUihLVo7F5u5Z0a.jpg"/></div></div></figure><p id="60f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保您的社交登录为绿色并已启用！</p><h1 id="a67f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">设置您的FireBase应用程序</h1><p id="5bb2" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">在您的项目中，您需要注册一个应用程序并获取凭据。在你的Firebase项目中点击设置图标，然后点击<em class="la">添加应用。</em></p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/85e4f3358dc04fc10b41cf2767fbab0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cIKoIamA28s5SgQy.jpg"/></div></div></figure><p id="e33b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注册应用程序后，您将获得应用程序凭据。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/1db0800cfe450a55eccba18bf7002767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NlIZWI1gu_bAwMYm.jpg"/></div></div></figure><p id="8803" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下一步中，您将把这些添加到terraform配方中。</p><p id="d332" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将您的完美证书添加到Terraform食谱中</p><p id="5491" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在部署您的EKS集群之前，请确保您添加了完善的凭证。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="165c" class="ne lt iq na b gy nf ng l nh ni"># auto-deployment/eks/variables.tf<br/># CHANGE THESE!<br/><br/>...<br/><br/># Then make sure to add your user to the app!<br/>variable "POLISHED_APP_NAME" {<br/>  default = "my_first_shiny_app"<br/>}<br/><br/># Grab this from the polished.tech Dashboard -&gt; Account -&gt; Secret<br/>variable "POLISHED_API_KEY" {<br/>  default = "XXXXXXXXXXXXXXXXXX"<br/>}<br/><br/># Firebase credentials<br/># Only add these if you've setup your own firebase credentials<br/>variable "POLISHED_FIREBASE_API_KEY" {<br/>  default = ""<br/>}</span></pre><p id="ab31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您按照Firebase的说明进行操作，请确保您也添加了Firebase凭据。如果你不是，就让它们保持原样。</p><h1 id="cf11" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">库伯内特的秘密</h1><p id="148f" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">您可以看到我们添加了作为terraform变量的<code class="fe nj nk nl na b">POLISHED_*</code>变量，然后这些变量作为<a class="ae kw" href="https://kubernetes.io/docs/concepts/configuration/secret/" rel="noopener ugc nofollow" target="_blank">秘密</a>被添加到我们的Kubernetes集群中。</p><p id="9ac6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">秘密变得有点棘手，因为感觉你必须把它们添加到一百万个地方，而且很容易让它们不同步。我建议选择一个，并且只有一个引用变量的方法。别装可爱了！；-)</p><p id="f885" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你的Kubernetes秘密(通常)出现在3个地方:</p><ul class=""><li id="9202" class="le lf iq ka b kb kc kf kg kj lg kn lh kr li kv lj lk ll lm bi translated">在你的Terraform食谱中(作为秘密)</li><li id="d680" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">在你的舵轮图中的环境变量要么在<code class="fe nj nk nl na b">values.yaml</code></li><li id="3ce4" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">还是在<code class="fe nj nk nl na b">templates/deployment.yaml</code>里。</li></ul><p id="a85a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二个真的取决于你的图表的组织方式。</p><p id="dab8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">秘密可能很棘手，所以我用几种不同的方式展示它们。</p><h1 id="9404" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">Kubernetes的秘密—代码视图</h1><p id="6365" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">以下是我们在terraform部署中的秘密:</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="d3ca" class="ne lt iq na b gy nf ng l nh ni"># auto-deployment/eks/main.tf<br/>locals {<br/>  secrets = [<br/>    {<br/>      name = "polished"<br/>      data = {<br/>        app_name = var.POLISHED_APP_NAME<br/>        api_key = var.POLISHED_API_KEY<br/>      }<br/>    },<br/>  ]<br/>}<br/><br/>resource "kubernetes_secret" "main" {<br/>  depends_on = [<br/>    module.eks,<br/>  ]<br/>  count = length(local.secrets)<br/><br/>  metadata {<br/>    name = local.secrets[count.index].name<br/>    labels = {<br/>      Project = local.cluster_name<br/>      Owner = "terraform"<br/>    }<br/><br/>  }<br/><br/>  data = local.secrets[count.index].data<br/><br/>  type = "Opaque"<br/>}</span></pre><p id="a54b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">火焰基地的秘密也在那里，只是为了不使它成为百科全书而没有展示出来。现在我们将它们读入我们的RShiny应用程序部署，告诉Helm它们是Kubernetes的秘密。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="85e7" class="ne lt iq na b gy nf ng l nh ni"># auto-deployment/helm_charts/rshiny-eks/values.yaml<br/>env:<br/>  - name: POLISHED_API_KEY<br/>    valueFrom:<br/>      secretKeyRef:<br/>        # In terraform this is locals.secrets.[0].polish.data.api_key<br/>        name: polished<br/>        key: api_key<br/>  - name: POLISHED_APP_NAME<br/>    valueFrom:<br/>      secretKeyRef:<br/>        # In terraform this is locals.secrets.[0].polish.data.app_name<br/>        name: polished<br/>        key: app_name</span></pre><p id="5563" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，在我们的实际部署中，我们添加了来自<code class="fe nj nk nl na b">values.yaml</code>的env键。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="f024" class="ne lt iq na b gy nf ng l nh ni">containers:<br/>   - name: {{ .Chart.Name }}<br/>     securityContext:<br/>       {{- toYaml .Values.securityContext | nindent 12 }}<br/>     image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"<br/>     imagePullPolicy: {{ .Values.image.pullPolicy }}<br/>     # Env vars are read in HERE<br/>     env:<br/>       - name: TAG<br/>         value: {{ .Values.image.tag }}<br/>       {{- toYaml .Values.env | nindent 12 }}</span></pre><h2 id="c476" class="ne lt iq bd lu nq nr dn ly ns nt dp mc kj nu nv mg kn nw nx mk kr ny nz mo oa bi translated">Kubernetes的秘密—图像视图</h2><p id="df55" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">这是我们的中公布的秘密的并排视图:</p><ul class=""><li id="7872" class="le lf iq ka b kb kc kf kg kj lg kn lh kr li kv lj lk ll lm bi translated">地形变量— <code class="fe nj nk nl na b">auto-deployment/eks/variables.tf</code></li><li id="1e18" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">库伯内特的秘密— <code class="fe nj nk nl na b">auto-deployment/eks/main.tf</code></li><li id="899d" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">在舵图中——<code class="fe nj nk nl na b">auto-deployment/eks/helm_charts/rshiny-eks/values.yaml</code>(以及<code class="fe nj nk nl na b">auto-deployment/eks/helm_charts/rshiny-eks/templates/deployment.yaml</code>的<code class="fe nj nk nl na b">containers[0].env</code>)</li></ul><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/2f680f1db51e685233e81ddcb7f71e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vpVXrtvVEud31VkA.jpg"/></div></div></figure><h1 id="32a5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">部署到AWS Kubernetes集群(EKS)</h1><p id="15d1" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">现在我们已经介绍了所有的基础知识，让我们最终部署我们的集群吧！</p><h1 id="6801" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">构建Terraform Docker映像</h1><p id="f1ce" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我喜欢在docker文件中拥有部署特定项目所需的一切。我几乎为我参与的每个项目都准备了一个，因为没有人想跟踪部署情况。</p><p id="339d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的大多数项目看起来像:</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="d28d" class="ne lt iq na b gy nf ng l nh ni">├── .aws<br/>├── Dockerfile<br/>├── README.md<br/>├── auto-deployment</span></pre><p id="4944" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中的<code class="fe nj nk nl na b">.aws</code>目录包含项目的AWS凭证，Dockerfile包含部署所需的cli工具，然后是实际的自动部署。如果您还没有配置AWS CLI，您可以在<a class="ae kw" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-creds" rel="noopener ugc nofollow" target="_blank"> AWS文档</a>中了解更多信息。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="23ff" class="ne lt iq na b gy nf ng l nh ni"># From the project directory<br/>docker build -t eks-k8 .<br/># If your aws credentials are someplace else be sure to change this!<br/># The default AWS cli credentials location is home<br/># If you keep your .aws credentials in the project folder use this command<br/>#docker run -it -v "$(pwd):/project" -v "$(pwd)/.aws:/root/.aws" eks-k8 bash<br/># If your AWS credentials are in ~/.aws use this one<br/>docker run -it \<br/>    -v "$(pwd):/project" -v "${HOME}/.aws:/root/.aws" eks-k8 bash</span></pre><p id="d9b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将创建一个包含您需要的所有内容的映像，然后将您放入shell中。从那里像对待任何其他终端一样对待您的图像。</p><h1 id="8ff0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">初始化地形状态</h1><p id="2d76" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">还记得我之前说过Terraform有点像Makefile吗？作为其<a class="ae kw" href="https://www.terraform.io/docs/state/" rel="noopener ugc nofollow" target="_blank">状态</a>的一部分，它跟踪它所执行的操作、它所创建或销毁的资源。它可以在本地或在S3桶或其他类型的存储中跟踪这些内容。在我们的例子中，我们将在S3桶中跟踪状态。</p><p id="13fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，S3存储桶名称必须是全球唯一的。这意味着你和我不能有相同的S3桶名！我使用一个随机数生成器，但你也可以在_ <code class="fe nj nk nl na b">auto-deployment/terraform-state/main.tf</code>中更改名称</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="8a0f" class="ne lt iq na b gy nf ng l nh ni"># From within the eks-k8 docker image<br/>cd /project/auto-deployment/terraform-state<br/>terraform init; terraform refresh; terraform apply -auto-approve</span></pre><h1 id="cb71" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">部署集群！</h1><p id="a942" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated"><strong class="ka ir">终于！</strong></p><p id="baea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将一举部署我们的集群，配置我们的各种CLI，安装我们的舵图，并获得我们的外部URL！</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="3552" class="ne lt iq na b gy nf ng l nh ni"># From within the eks-k8 docker image<br/>cd /project/auto-deployment/eks<br/>terraform init; terraform refresh; terraform apply -auto-approve</span></pre><p id="da62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">偶尔，东西会超时。您可能需要多次运行该命令。抓个零食看着它走！</p><p id="6748" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，你应该会看到这样的东西-</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/3c463d71a3c9ee4d585a3b219cbb2ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z2mV0P9BZO3XkZih.png"/></div></div></figure><h1 id="e59f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">查看我们的RShiny应用程序</h1><p id="aa80" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果你注意的话，你会看到很多很多terraform命令的输出。</p><p id="fc20" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于没有耐心的人来说，我们真正想要的是运行这个命令来获取外部URL。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="83e5" class="ne lt iq na b gy nf ng l nh ni">export EXPOSED_URL=$(kubectl get svc --namespace default rshiny-nginx-ingress-controller -o json | jq -r '.status.loadBalancer.ingress[]?.hostname') <br/>echo $EXPOSED_URL</span></pre><h1 id="615b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">可选—将外部域添加到Firebase</h1><p id="f04d" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">如果你已经建立了自己的Firebase帐户，那么你需要获取外部URL并将其添加到Firebase控制台。<em class="la">进入开发- &gt;认证- &gt;签到方式- &gt;授权域。</em></p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/d1f1929568b23ac2f402bcb4bb3970d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*khPfj5lN-Gi9RhJW.jpg"/></div></div></figure><h1 id="57ad" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">成功！</h1><p id="3d56" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">抓取$EXTERNAL_URL并打开浏览器。您应该会看到polished.tech登录页面！</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/8e96b9805ddd03b1bf5cc324ec50a525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0gmPuu-T8e9iRcBB.png"/></div></div></figure><p id="4775" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，当您登录时，您将看到会话数据！</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/7517881533b694f58941ed6bcda13cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1yYTkmcHyBwBURkV.jpg"/></div></div></figure><h1 id="a41c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">有用的命令</h1><p id="a058" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">下面是一些在Kubernetes上导航RShiny部署的有用命令。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="d800" class="ne lt iq na b gy nf ng l nh ni"># Get a list of all running pods<br/>kubectl get pods <br/># Describe the pod. This is very useful for troubleshooting! <br/>kubectl describe pod PODNAME<br/># Drop into a shell in your pod. It's like docker run.<br/>kubectl exec -it PODNAME bash<br/># Get the logs from stdout on your pod<br/>kubectl logs PODNAME <br/># Get all the services and urls<br/>kubectl get svc</span></pre><h1 id="e6cf" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">关于SSL的简短说明</h1><p id="0f4b" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">进入SSL有点超出了本教程的范围，但是这里有两个资源可以帮助您入门。</p><p id="b62f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一个是<a class="ae kw" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nginx-ingress-with-cert-manager-on-digitalocean-kubernetes" rel="noopener ugc nofollow" target="_blank">数字海洋教程</a>关于通过NGINX入口保护你的应用。我建议通读这篇文章，因为这会让您对设置https有一个很好的概念性理解。</p><p id="a947" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二篇是由<a class="ae kw" href="https://docs.bitnami.com/tutorials/secure-kubernetes-services-with-ingress-tls-letsencrypt/" rel="noopener ugc nofollow" target="_blank">比特纳米</a>写的文章。这是一个非常清晰的教程，教你如何使用舵轮图来启动和运行HTTPS，我认为它很好地指导你尽可能简单地完成步骤。</p><p id="92ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你不在乎用Kubernetes理解https的来龙去脉，就去读Bitnami教程吧。；-)</p><h1 id="8a9c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">包裹</h1><p id="b326" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">就是这样！希望您能看到使用polished.tech托管服务启动和运行安全认证是多么容易！</p><p id="d86a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您有任何问题或意见，请通过<a class="ae kw" href="mailto:jillian@dabbleofdevops.com" rel="noopener ugc nofollow" target="_blank">jillian@dabbleofdevops.com</a>直接联系我。如果你对polished.tech认证服务<a class="ae kw" href="http://polished.tech/" rel="noopener ugc nofollow" target="_blank">有任何疑问，请访问他们的网站</a>。</p><h1 id="beed" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">资源</h1><p id="0e5f" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated"><a class="ae kw" href="https://polished.tech/docs/get-started" rel="noopener ugc nofollow" target="_blank">抛光技术认证</a></p><p id="8eb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://helm.sh/docs/topics/charts/" rel="noopener ugc nofollow" target="_blank">舵图</a></p><p id="e404" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://github.com/terraform-aws-modules/terraform-aws-eks" rel="noopener ugc nofollow" target="_blank">地形EKS食谱</a></p><p id="45bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://hub.docker.com/r/rocker/shiny" rel="noopener ugc nofollow" target="_blank">摇杆闪亮的Docker图像</a></p><p id="d014" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://aws.amazon.com/eks/" rel="noopener ugc nofollow" target="_blank"> EKS — AWS管理的Kubernetes集群</a></p><p id="c3b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://docs.bitnami.com/tutorials/secure-kubernetes-services-with-ingress-tls-letsencrypt/" rel="noopener ugc nofollow" target="_blank">添加SSL教程</a> <a class="ae kw" href="https://aws.amazon.com/about-aws/global-infrastructure/regions_az/#:~:text=AWS%20maintains%20multiple%20geographic%20Regions,Africa%2C%20and%20the%20Middle%20East." rel="noopener ugc nofollow" target="_blank"> AWS —地区</a></p><p id="1a14" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-creds" rel="noopener ugc nofollow" target="_blank"> AWS —配置CLI </a> <a class="ae kw" href="https://docs.aws.amazon.com/eks/latest/userguide/service_IAM_role.html" rel="noopener ugc nofollow" target="_blank"> AWS — EKS IAM策略</a></p></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="1f88" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="la">最初发表于</em><a class="ae kw" href="https://www.dabbleofdevops.com/blog/rshiny-authentication-with-polished-on-aws-kubernetes" rel="noopener ugc nofollow" target="_blank"><em class="la">https://www.dabbleofdevops.com</em></a><em class="la">。</em></p></div></div>    
</body>
</html>