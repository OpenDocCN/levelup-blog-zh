<html>
<head>
<title>Authenticate Google Service Accounts in Postman</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Postman中验证Google服务帐户</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/authenticate-google-service-accounts-in-postman-c6ad065d6cb?source=collection_archive---------9-----------------------#2022-11-01">https://levelup.gitconnected.com/authenticate-google-service-accounts-in-postman-c6ad065d6cb?source=collection_archive---------9-----------------------#2022-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7176" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Postman中释放Google APIs的可能性。创建机器人与G驱动器，G日历，和更多！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/df2ab408c8ae19ef8e38267378db3c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-m6P3tv8KXnzkomUtDyNuA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在Postman中验证Google服务帐户</figcaption></figure><p id="b173" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你只知道Postman是一个调用API的工具，那么你还只是刚刚接触到皮毛。我的其他文章描述了如何使用它们的监视器特性在Postman中创建机器人。在创建这些无服务器机器人时，我发现Google APIs有许多用途和需求。</p><p id="e5ad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我有一个需求，需要将数据存储在一个google sheet中。在尝试自动化Google电子表格数据输入时，我遇到了一个问题。谷歌服务不允许我在没有<em class="lu">在场登录</em>的情况下使用OAuth进行认证！</p><p id="5847" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，谷歌允许你创建一个<em class="lu">服务账户</em>，它可以像另一个普通账户一样——分享权限、文件、日历、文档等。服务帐户的主要用途是用于服务器到服务器的代码，因此您无需亲自登录即可访问您的数据；你能做的就是把你想要的数据分享给服务账号，就好像是另外一个人一样！</p><p id="6a27" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">服务器到服务器的认证交互机制要求应用程序创建JSON Web令牌(jwt)并对其进行加密签名。</p><p id="b638" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lv" href="https://jwt.io/" rel="noopener ugc nofollow" target="_blank"> JSON网络令牌</a>，或jwt，是代表双方声明的加密有效载荷。我们可以用JWT交换访问令牌。然而，谷歌要求我们的JWT签署了RSA-256签名。</p><p id="a475" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">谷歌在这里概述了如何认证<a class="ae lv" href="https://developers.google.com/identity/protocols/oauth2/service-account#makingrequest" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="6d5b" class="lw lx it bd ly lz ma dn mb mc md dp me lh mf mg mh ll mi mj mk lp ml mm mn mo bi translated">创建服务帐户</h2><p id="6669" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">去<a class="ae lv" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌的云控制台</a>创建一个项目。然后在凭证下创建Google服务帐户。它还会给你一个公钥和私钥对。您将需要存储这个私钥，以便以后在Postman中使用。</p><p id="c4b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想要使用此服务帐户来自动处理表单或日历，则您需要像使用任何其他帐户一样将资源共享到电子邮件。对于大多数Google Drive产品，只需使用UI中的分享按钮即可。</p><div class="kj kk kl km gt ab cb"><figure class="mu kn mv mw mx my mz paragraph-image"><img src="../Images/365de21c69bd0f49a6afc305b105ba05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*AL57TNXYv_phvHBo9RHO0g.png"/></figure><figure class="mu kn na mw mx my mz paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/54c57ca5ded9d733362b44524f670239.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*AT08V8bik88mgriYboAZ3Q.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk nb di nc nd translated">创建一个谷歌云项目，并创建一个服务帐户</figcaption></figure></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/58d25b8a6442fbc25cd49bffd721c1c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P1qd_phOXUL1sye0GHAnqQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通过使用Google服务帐户的电子邮件进行共享来访问资源。</figcaption></figure><h2 id="6a5b" class="lw lx it bd ly lz ma dn mb mc md dp me lh mf mg mh ll mi mj mk lp ml mm mn mo bi translated">侧装JRS-分配</h2><p id="6999" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">Postman可以通过向CDN发出请求并设置对环境的响应(库代码)来导入第三方库。然后我们可以使用这个库，但是要把它从环境中取出来并运行<em class="lu"> eval() </em>。</p><p id="be28" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于JSR赋值库，我必须模拟browser和navigator对象，因为库期望代码在web浏览器中运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/44880105d4542f543cd8c7bf6aa5e1a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*M5GjJu2LgpIgkak-lCuZ2Q.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通过CDN请求库，并将库存储在您的环境中。</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d51316ad572fbffe911f75ac2319f1fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*O0TJdA4KdExRzQIy1osLmQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在任何你想使用这个库的地方，使用eval()并创建它可能需要的依赖项。</figcaption></figure><h2 id="ab01" class="lw lx it bd ly lz ma dn mb mc md dp me lh mf mg mh ll mi mj mk lp ml mm mn mo bi translated">创建和签署JWT索赔集</h2><p id="2732" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">在工作流的后续请求中，我们向<a class="ae lv" href="https://oauth2.googleapis.com/token." rel="noopener ugc nofollow" target="_blank"><em class="lu"/></a>发出一个POST请求</p><p id="e671" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请求体中需要一个JWT，因此在请求前脚本中，我们将在发送请求之前创建JWT。</p><p id="7567" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里列出了谷歌对JWT的要求<a class="ae lv" href="https://cloud.google.com/api-gateway/docs/authenticating-users-jwt" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="46b6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们首先需要创建JWT报头，它将告诉我们令牌的算法和类型。</p><p id="16af" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们构建一个声明集，它将包括服务帐户的电子邮件、我们想要访问的API和权限的范围、截止日期以及发布声明的时间。这些与相应的邮递员集合一起被记录。</p><p id="6ceb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们使用JRS分配库来签署JWT，并在创建Google服务帐户时包含私钥，并将其保存到环境中，使其在请求中可用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/b80e67af4d589c522a6c70c6054d2243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*Q5a7oXsjQetO_FiQ1511Pw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">创建和签署JWT的预请求脚本</figcaption></figure><p id="0065" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面我找到了一个StackOverflow帖子，解释了这个脚本，如果你需要另一个视角的话。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ac16f2758bdafc57675f55d4d20733b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*hg2ATyGBe5ui1HfUYle_QQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">JWT曾经获得一个访问令牌</figcaption></figure><h2 id="af26" class="lw lx it bd ly lz ma dn mb mc md dp me lh mf mg mh ll mi mj mk lp ml mm mn mo bi translated">在Google API请求中使用令牌</h2><p id="042e" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">现在，我们可以在与电子表格、日历、g盘、照片等交互时使用令牌。</p><p id="ee62" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请确保与服务帐户共享资源。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/514e976e1bed9ecdf91596d363110363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NwBBaF5tQKrgR7wy7iKrnw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用google电子表格的访问令牌示例</figcaption></figure><h1 id="3f51" class="nk lx it bd ly nl nm nn mb no np nq me jz nr ka mh kc ns kd mk kf nt kg mn nu bi translated">使用</h1><p id="c52d" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">我经常使用这个。</p><ul class=""><li id="98be" class="nv nw it la b lb lc le lf lh nx ll ny lp nz lt oa ob oc od bi translated">自动执行电子表格，并从其他API数据源自动填充，以便为您的报告迁移数据或存储数据</li><li id="cca8" class="nv nw it la b lb oe le of lh og ll oh lp oi lt oa ob oc od bi translated">使用Twilio创建日历事件或提醒事项</li><li id="4725" class="nv nw it la b lb oe le of lh og ll oh lp oi lt oa ob oc od bi translated">任何谷歌资源都由你支配</li></ul><h1 id="e62f" class="nk lx it bd ly nl nm nn mb no np nq me jz nr ka mh kc ns kd mk kf nt kg mn nu bi translated">TL；速度三角形定位法(dead reckoning)</h1><ul class=""><li id="9784" class="nv nw it la b lb mp le mq lh oj ll ok lp ol lt oa ob oc od bi translated">侧装JRS-将库分配给邮递员</li><li id="37b6" class="nv nw it la b lb oe le of lh og ll oh lp oi lt oa ob oc od bi translated">创建一个索赔集，并对其进行签名以创建JWT。与谷歌交易一个服务帐户</li><li id="8c54" class="nv nw it la b lb oe le of lh og ll oh lp oi lt oa ob oc od bi translated">像其他用户一样与任何资源共享服务帐户，然后编写您的集成或自动化代码！</li></ul><p id="c1c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">导入我的收藏以开始使用它，或者在您的收藏中将它用作模板！</p><p id="a22d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lv" href="https://www.linkedin.com/in/stcalica/" rel="noopener ugc nofollow" target="_blank">在LinkedIn上联系我</a>。</p><p id="0e9d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就业市场很艰难，但科技是我的激情所在，我希望❤能给我一点咖啡</p><h1 id="47f1" class="nk lx it bd ly nl nm nn mb no np nq me jz nr ka mh kc ns kd mk kf nt kg mn nu bi translated">其他邮递员和API文章</h1><ul class=""><li id="ebcf" class="nv nw it la b lb mp le mq lh oj ll ok lp ol lt oa ob oc od bi translated"><a class="ae lv" rel="noopener ugc nofollow" target="_blank" href="/automate-the-boring-stuff-with-postman-discord-bots-9a2ad0088792">创建邮递员不和机器人</a></li><li id="e1ed" class="nv nw it la b lb oe le of lh og ll oh lp oi lt oa ob oc od bi translated"><a class="ae lv" rel="noopener ugc nofollow" target="_blank" href="/websockets-with-postman-and-discord-db26efed56c1">有邮差和不和的web sockets</a></li><li id="53aa" class="nv nw it la b lb oe le of lh og ll oh lp oi lt oa ob oc od bi translated"><a class="ae lv" href="https://medium.com/swlh/automate-the-boring-stuff-with-postman-syncing-product-screenshots-3af6e0e2e2cf" rel="noopener">使用Postman Hack同步截图</a></li></ul><p id="8f32" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lv" href="https://www.linkedin.com/in/stcalica/" rel="noopener ugc nofollow" target="_blank">在LinkedIn上和我联系</a>。</p><div class="om on gp gr oo op"><a href="https://stackoverflow.com/questions/53965446/how-to-sign-a-jwt-with-a-private-key-pem-in-cryptojs" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">如何在CryptoJS中用私钥(pem)签署JWT？</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">邮递员的出现改变了这一点。我有一个解决办法给你，但无论如何这都不是一个干净方法。你会…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">stackoverflow.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ks op"/></div></div></a></div></div></div>    
</body>
</html>