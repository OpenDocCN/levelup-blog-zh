<html>
<head>
<title>Fruit Ninja Random Fruit Facts API Built with Pure Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Pure Node.js构建的水果忍者随机水果事实API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/fruit-ninja-random-fruit-facts-api-built-with-pure-node-js-5bff9c0e62a5?source=collection_archive---------3-----------------------#2019-05-12">https://levelup.gitconnected.com/fruit-ninja-random-fruit-facts-api-built-with-pure-node-js-5bff9c0e62a5?source=collection_archive---------3-----------------------#2019-05-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="84dc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">仅使用普通节点构建web服务器，不使用任何第三方软件包或库</h2></div><p id="e871" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我开始学习如何使用纯节点web服务器(没有Express或任何其他包)。巩固学习的最佳方式是用知识构建一些东西。然而，由于课程范围有限，我无法找到要构建的项目。</p><p id="a8ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这几天在玩水果忍者。在每一轮之后，它显示有趣的水果事实。我有一个想法，制作一个API，以JSON格式显示随机的水果事实。这样我就可以在创造一些有趣的东西的同时运用我的知识。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/56d93d1d1d63cb3bfa41ae0d250f450d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6kbmDqx0pnBVV9pw404mA.jpeg"/></div></div></figure><p id="7116" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我构建了这个简单的API，它以JSON格式显示有趣的水果事实。当你输入<code class="fe ln lo lp lq b">localhost:3000/apple</code>或者其他任何可用的水果，它都会吐出这个数据。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/311ebb554d84fb00f3d95c52ed2a310a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*V4TWdKEuH0xVVVDh4GLBnA.png"/></div></figure><p id="32ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该API简单而复杂。这是我第一次构建一个URL slug作为一个变量。和express.js里的<code class="fe ln lo lp lq b">/:fruit</code>一样。</p><p id="e185" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">我建议你</strong> <a class="ae ls" href="https://github.com/TamalAnwar/fruit-facts/blob/master/index.js" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">打开代码</strong> </a> <strong class="kh ir">跟随着这篇帖子。</strong></p><p id="2076" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个想法是把完整的网址<code class="fe ln lo lp lq b">http://localhost:3000/mango</code>分成几个部分。然后我选择路径<code class="fe ln lo lp lq b">/mango</code>，去掉所有斜线，得到一个最终干净的修剪过的路径<code class="fe ln lo lp lq b">mango</code>，之后我可以将这个slug与我的路径处理程序进行匹配。我从<a class="ae ls" href="https://pirple.thinkific.com/courses/the-nodejs-master-class" rel="noopener ugc nofollow" target="_blank"> Pirple的节点大师班课程</a>中学到了这种方法。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/6594c6625c4c2847bb953c42e46b5ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*kW-dpFp38MFOgLyJ9XgBHA.png"/></div></figure><p id="5cb7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我从维基页面上收集了这些水果信息。我将在另一篇文章中讲述我是如何用JavaScript放弃这些事实的。</p><p id="94f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我创建了一个可用水果的数组。许多水果有不止一个事实，所以我创建了一个水果对象，每个水果都有一组事实:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lu"><img src="../Images/8ecc32cf06677eed1b4807fa13f739c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0-NvGINg5r3Qzbac11vew.png"/></div></div></figure><p id="f55f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了水果事实，API还有3个额外的页面——主页、一个未找到的页面和一个帮助页面。首先，我检查给定的URL是否是匹配的水果。如果是匹配的水果，它将把给定的水果提供给水果处理员。如果它不包含匹配的水果，但与其他处理程序匹配，它将相应地为它们提供服务:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lv"><img src="../Images/ff0d5cffaf3c38fe554ee1aa2f57e502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*p8olAaFsOobccQbxSUZWBA.png"/></div></div></figure><p id="9df6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后剩下要做的就是调用<code class="fe ln lo lp lq b">chosenHandler</code>函数并传入回调函数:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/2a49a9b6dc5c2f12cd85bb04e96d28cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*8-NoQdtuC0xsJBpxCKbZgQ.png"/></div></figure><p id="8f72" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用原生的<code class="fe ln lo lp lq b">http</code>包来创建一个web服务器。服务器是使用<code class="fe ln lo lp lq b">http.createServer</code>构建的。<code class="fe ln lo lp lq b">createServer</code>函数接受回调，在回调中我们可以处理请求并提供来自<code class="fe ln lo lp lq b">chosenHandler</code>的水果事实或其他页面。然后我们使用<code class="fe ln lo lp lq b">server.listen</code>监听端口3000。</p><pre class="lc ld le lf gt lx lq ly lz aw ma bi"><span id="6197" class="mb mc iq lq b gy md me l mf mg">const server = http.createServer(function(req, res) { <br/>  /* Callback to handle requests with chosenHandler */<br/>}</span><span id="23c7" class="mb mc iq lq b gy mh me l mf mg">server.listen(3000, () =&gt; { console.log('Server started') })</span></pre><p id="4e2d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以修改我的Github页面上的代码。我建议你<a class="ae ls" href="https://chrome.google.com/webstore/detail/json-viewer/gbmdgpbipfallnflgajpaliibnhdgobh" rel="noopener ugc nofollow" target="_blank">安装JSON查看器扩展</a>，以一种漂亮的格式化方式查看JSON。</p><p id="f35f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你喜欢这篇文章，你可以看看我的博客，了解更多与节点JS相关的文章。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><div class="lc ld le lf gt mp"><a href="https://gitconnected.com/learn/node-js" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">学习Node.js -最佳Node.js教程(2019) | gitconnected</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">前33个Node.js教程-免费学习Node.js。课程由开发人员提交和投票，使您能够…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">gitconnected.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd ll mp"/></div></div></a></div></div></div>    
</body>
</html>