<html>
<head>
<title>Testing for Nonexistence in Cypress</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">柏树中不存在的测试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/testing-for-non-existence-in-cypress-a8ae941d6064?source=collection_archive---------21-----------------------#2021-10-26">https://levelup.gitconnected.com/testing-for-non-existence-in-cypress-a8ae941d6064?source=collection_archive---------21-----------------------#2021-10-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="8551" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://gentille.us/b3601fb73472?sk=0dc73c81df810c0f181c432c9db3e085" rel="noopener ugc nofollow" target="_blank"> JavaScript和类型脚本测试</a></h2><div class=""/><div class=""><h2 id="060f" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">为不存在的东西测试一个UI比你想象的要难。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/3f69569025573bedc6211db51b0fad73.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*x00dPW6NL2QOTgXaAuuNPg.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">有什么东西不在那里吗？</figcaption></figure><p id="555b" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">一些用户可能具有读/写权限，而一些用户可能是只读的。您对此的控制可能就像编辑按钮一样简单，所以测试如果用户没有可编辑的声明，他们就看不到编辑按钮是非常重要的。</p><h1 id="4f5e" class="lw lx iq bd ly lz ma mb mc md me mf mg kf mh kg mi ki mj kj mk kl ml km mm mn bi translated">我的天真方法</h1><p id="a6e7" class="pw-post-body-paragraph la lb iq lc b ld mo ka lf lg mp kd li lj mq ll lm ln mr lp lq lr ms lt lu lv ij bi translated">问题在于，根据页面的构造方式，编辑按钮可能一开始并不存在，但在最终呈现时会显示出来。如果您遵循标准的测试协议，即首先编写一个失败的测试，那么您将增加编写一个有意义的测试的几率。这是我写的第一个测试的近似值，我预计会失败。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/ec3a09e775ab1147771b310c9f3b6336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*nhgAGiziCGV2BBBoXmqxuA.png"/></div></figure><p id="535a" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><code class="fe mu mv mw mx b">testSetup(UserType.MANAGER)</code>调用应该使测试模拟一个经理，我期望对于经理来说，页面看起来像下面的图片，其中橙色箭头指向测试中的按钮。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi my"><img src="../Images/177fe0c80feda496719afa51d57ff32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*UB2TKgrcfG5VON55CTUU9w.png"/></div></figure><p id="d616" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">令我惊讶的是测试通过了，尽管我测试按钮<strong class="lc ja">并不存在。问题只是与时间有关。当调用断言时，页面看起来像这样:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/c16d42005683a4e205a0b1cec08c3aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*Kk20fImLdY9mc_s-sFAHPw.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">没有链接按钮的部分呈现页面</figcaption></figure><p id="3d98" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">对于这个部分呈现的页面，问题变得很明显，确实没有链接按钮。断言运行得比我期望的要快。</p><h1 id="a4e8" class="lw lx iq bd ly lz ma mb mc md me mf mg kf mh kg mi ki mj kj mk kl ml km mm mn bi translated">弗拉基米尔和埃斯特雷根</h1><p id="527d" class="pw-post-body-paragraph la lb iq lc b ld mo ka lf lg mp kd li lj mq ll lm ln mr lp lq lr ms lt lu lv ij bi translated">Cypress非常有用，因为它在测试时会等待事物的存在。它甚至会等待事物停止存在，如果它们已经存在的话。但是当你测试一个不存在的东西时，它马上就不存在了，Cypress会很高兴地继续下去。如果弗拉迪米尔和埃斯特雷根也这样做的话，等待戈多的时间会短得多。</p><p id="51af" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">解决方法很简单，只需等待应该存在的东西和不应该存在的东西同时出现。在我的例子中，标题名(“dot-com turquoise azure”)和按钮都包装在同一个组件中。如果我等待标题，那么测试应该会失败。下面是代码:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/aa4109e26e503264b37f5a7b90665a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*iL2bvt9tC7QANtCDl_UPKA.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">最后，一个失败的测试</figcaption></figure><p id="81c5" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">现在我有了一个适当失败的测试，我可以通过将声明更改为<code class="fe mu mv mw mx b">UserType.NON_MANAGER.</code>来创建通过的测试</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a4db0b94f8fd896108ffb5acb200124b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*LXd89jiXDIwlqNf2D1B_QA.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">最终通过测试</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="baa8" class="lw lx iq bd ly lz nk mb mc md nl mf mg kf nm kg mi ki nn kj mk kl no km mm mn bi translated">两份外卖</h1><ol class=""><li id="eb08" class="np nq iq lc b ld mo lg mp lj nr ln ns lr nt lv nu nv nw nx bi translated">首先编写一个失败的测试可以证明你的测试确实如你所想的那样。</li><li id="7cb6" class="np nq iq lc b ld ny lg nz lj oa ln ob lr oc lv nu nv nw nx bi translated">当事情没有做到你认为应该做到的时候，赛普拉斯测试跑者的命令日志是必不可少的。我通过打开日志的<code class="fe mu mv mw mx b">TEST BODY</code>部分，并点击如下所示的断言，捕获了部分呈现页面的图像。该日志在应用程序预览窗口中向您显示您的UI状态，确切时间是您做出断言的时间。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d9ac4209cf5cc0c14028c153a6fb5b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*OJkmm_tG_QUUwEIQIjBlyA.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">测试失败时的日志图像</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="ab1f" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">还有更多<a class="ae oe" href="https://gentille.us/b3601fb73472?sk=0dc73c81df810c0f181c432c9db3e085" rel="noopener ugc nofollow" target="_blank"> JavaScript和类型脚本测试</a>技巧文章。</p><p id="fbfa" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">平静地编码。</p></div></div>    
</body>
</html>