<html>
<head>
<title>Tweet2Map: Twitter for Traffic Accident Research in Metro Manila</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tweet2Map:马尼拉交通事故研究推特</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tweet2map-twitter-for-traffic-accident-research-in-metro-manila-d0f861c9b8b7?source=collection_archive---------19-----------------------#2020-09-26">https://levelup.gitconnected.com/tweet2map-twitter-for-traffic-accident-research-in-metro-manila-d0f861c9b8b7?source=collection_archive---------19-----------------------#2020-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="bd4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个自动化的Python工具，用于解释来自MMDA的推文并提取大马尼拉地区的高精度交通事件数据</p><p id="40cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">大马尼拉的交通事故逐年稳步增长，2019年大马尼拉共有121，771起记录在案的事故[1]。公众可公开获得一些报告，如大马尼拉事故报告和分析系统(<a class="ae ko" href="http://www.mmda.gov.ph/homepage/2-uncategorised/3345-freedom-of-information-foi.html" rel="noopener ugc nofollow" target="_blank"> MMARAS </a>)，但是它们已经是城市级别的汇总数据，并不提供城市内更精细的空间数据。</p><p id="fee6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Tweet2Map将特别关注大马尼拉发展局(<a class="ae ko" href="https://twitter.com/mmda" rel="noopener ugc nofollow" target="_blank"> MMDA </a>)的Twitter feed，旨在为Twitter feed上报告的每个事件附上高质量的点数据，以便准确定位每个事件。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/c33bfe437f3ea3300fa75f9107654793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*3y_-wR4hUFX3sqOwOwrF7Q.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">大马尼拉选定交通事件的点位置以及核密度分析</figcaption></figure><p id="82e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这篇文章将重点介绍Tweet2Map脚本是如何工作的。我写这篇文章是为了庆祝Tweet2Map脚本的<strong class="js iu">版本1.0 </strong>在程序完全重写后的发布。本博客的下一篇文章将使用这些数据进行探索性的数据分析。Github repo中提供了关于如何创建虚拟环境、配置和运行软件的完整说明:</p><div class="lb lc gp gr ld le"><a href="https://github.com/pbrotoisworo/tweet2map" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd iu gy z fp lj fr fs lk fu fw is bi translated">pbrotoisworo/tweet2map</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">作者:潘吉·布罗托伊斯沃罗联系人:panji.p.broto@gmail.com·MMDA tweet 2 map是一个挖掘MMDA推文的python脚本…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls kv le"/></div></div></a></div><p id="6216" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该脚本是一个自动化的CLI工具，默认情况下会下载推文并将其存储在缓存中以供以后处理。我安排脚本在PythonAnywhere免费层上每天运行一次。一旦我准备好处理数据，我就可以运行处理参数<code class="fe lt lu lv lw b">-p</code>,它将加载最新的tweet，还会加载缓存中存储的tweet。该脚本通过检查缓存中唯一的tweet ID、下载的新tweet和数据库中最新处理的tweet来过滤重复的tweet。</p><h1 id="0838" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">数据挖掘Twitter</h1><p id="d76a" class="pw-post-body-paragraph jq jr it js b jt mv jv jw jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn im bi translated">MMDA推特的特色是实时事件报道，其结构与下图相同。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi na"><img src="../Images/cd2932e375d48cc82fbd0f94436440b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*C_MQwrZP7SZPSeOwguSKZg.png"/></div></figure><p id="32c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是脚本解析推文的方式:</p><ul class=""><li id="a05a" class="nb nc it js b jt ju jx jy kb nd kf ne kj nf kn ng nh ni nj bi translated">红色:事故类型</li><li id="885d" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated">浅蓝色:位置</li><li id="46e8" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated">橙色:方向</li><li id="353e" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated">格林:谁参与了</li><li id="fad2" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated">深蓝色:时间</li><li id="4a9e" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated">棕色:车道被占用</li></ul><p id="fec3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">目前，该脚本使用正则表达式来解析文本，但有计划包括自然语言处理(NLP)。这是因为尽管这些推文中有一个总体结构，但我观察到它们仍然是手动输入的。这是因为我不时会遇到错别字和错误，这些错别字和错误会混淆需要精确结构的正则表达式，从而导致无效的tweets。我希望NLP tweet解析器更加灵活。</p><h1 id="5bc9" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">向数据库添加位置</h1><p id="b1c2" class="pw-post-body-paragraph jq jr it js b jt mv jv jw jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn im bi translated">截至发稿时，数据库中有2，780个命名的地点。大多数位置都具有可靠和准确的点数据，但也有相对不准确的名称。诸如“ROXAS BLVD .”之类的名称是不准确的，因为Roxas Blvd .是一条很长的路，因此您无法准确地放置一个点，即使是在城市集合级别，因为这条路穿过几个城市。</p><p id="0d46" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该软件通过提供“高精度”列，提供了一种识别哪些位置是可靠的方法。由于我在SQLITE3上运行是为了与免费层云托管兼容，所以我不能创建BOOL列，所以它只是一个整数列，其中1为真，0为假。</p><p id="e046" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有两种不准确的数据。第一种情况是，名称完全错误，无法精确定位到某个位置，该位置标有坐标0，0，因此无效。第二种不准确的数据是，你仍然可以大致确定事故发生的位置，但是你不能在几百米内确定准确的位置。第二种类型的不准确数据在城市聚合级别仍然可用，但如果您想要非常精确的坐标，它就不可靠。</p><p id="71a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您使用<code class="fe lt lu lv lw b">-p</code>参数处理数据时，如果遇到新的位置，会出现一个提示，并给出如下图所示的选项。你可以选择任何一个选项，但是如果你想返回菜单，只要输入“BREAK”就可以了。</p><p id="f548" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们通过快速演示来完成在a中添加新位置的过程。这里“EDSA·皮纳图博”与位置数据库中找到的任何字符串都不匹配。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi np"><img src="../Images/877220cf15cfc0c30b40bad33ad2836f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rH_hdH8AGIl35Haf0_DydA.png"/></div></div></figure><p id="1806" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以使用字符串匹配在位置数据库中搜索现有位置，如下所示。我搜索了“PINATUBO ”,但是没有匹配的，所以我输入“BREAK”返回主菜单。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi np"><img src="../Images/3745d0f2e27316d40f9f8abfe348112d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CKXmwfnHg4iXfJf20jWe6g.png"/></div></div></figure><p id="6c0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我在谷歌上搜索这个位置，它显示这个位置有一个非常准确的位置。所以我们可以将它创建为一个高精度位置。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi nu"><img src="../Images/2da0bac5890152084a3a0aa137dc0b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BpQvELNxjsWT_X6F5A59Kg.png"/></div></div></figure><p id="6ae9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">右键单击点位置，然后单击“这是什么？”。这将显示您可以复制并粘贴到终端的坐标位置。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/62010381307c37b981e73cf0c9350807.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*tB2NofrzFpYcyZU2qSTRow.png"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi np"><img src="../Images/b54849359ca8efaa198a1ce4de82b7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJrQsaj9U8lKbJfoVsQ-jQ.png"/></div></div></figure><p id="6093" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们在位置数据库里找到了EDSA·皮纳图博。因此，如果这个位置再次出现，它不会提示输入坐标。</p><h1 id="7542" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">限制</h1><p id="57d2" class="pw-post-body-paragraph jq jr it js b jt mv jv jw jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn im bi translated">这个数据集有一些限制。这些事故大部分是由MMDA人员报告的，因此大部分将被记录的事故将只发生在MMDA管辖的主要道路上。</p><p id="3724" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，该数据不能完全代表大马尼拉的所有交通事故。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/257a69599350594f757d7eae9ef4e716.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*6WPB6OK7U4ASdXk2j9ybrA.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">MMDA事故报告的核分布</figcaption></figure><h1 id="f8cd" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">参考</h1><p id="4817" class="pw-post-body-paragraph jq jr it js b jt mv jv jw jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn im bi translated">[1]: <a class="ae ko" href="http://www.mmda.gov.ph/images/Home/FOI/MMARAS/MMARAS_Annual_Report_2019.pdf" rel="noopener ugc nofollow" target="_blank">大马尼拉事故报告与分析系统2019年度报告</a></p></div></div>    
</body>
</html>