<html>
<head>
<title>How To Use Kubernetes and Minikube to Set up a Relational Database Locally</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨Kuberneteså’ŒMinikubeåœ¨æœ¬åœ°å»ºç«‹å…³ç³»æ•°æ®åº“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/how-to-use-kubernetes-and-minikube-to-set-up-a-relational-database-locally-1ea04ba6cb7f?source=collection_archive---------3-----------------------#2020-11-03">https://levelup.gitconnected.com/how-to-use-kubernetes-and-minikube-to-set-up-a-relational-database-locally-1ea04ba6cb7f?source=collection_archive---------3-----------------------#2020-11-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c5d6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ä¸€æ­¥ä¸€æ­¥çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„ä¾‹å­</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f4844787f4ba1b613fa29426f7f087c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LpofnCw46zZIuJ-ex0FILg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">ç”±<a class="ae ky" href="https://unsplash.com/@kelvin1987?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Kelvin Ang </a>åœ¨<a class="ae ky" href="https://unsplash.com/s/photos/server?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="b239" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Kubernetesæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å¹³å°ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²ã€ç®¡ç†å’Œæ‰©å±•ã€‚åœ¨2014å¹´å¼€æºä¹‹å‰ï¼ŒKubernetesæœ€åˆæ˜¯ç”±è°·æ­Œçš„å·¥ç¨‹å¸ˆå¼€å‘çš„ã€‚è®¸å¤šå¤§å…¬å¸ç°åœ¨éƒ½é‡‡ç”¨Kubernetesä½œä¸ºä»–ä»¬çš„å®¹å™¨ç¼–æ’é€‰é¡¹ã€‚</p><p id="8e9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœæ‚¨å¯¹Kubernetesæœ‰ä¸€äº›åŸºæœ¬çš„äº†è§£ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« éå¸¸é€‚åˆæ‚¨ã€‚å®ƒå°†å¸¦æ‚¨å®Œæˆä½¿ç”¨Minikubeåœ¨æœ¬åœ°è®¾ç½®Kubernetesé›†ç¾¤å’Œéƒ¨ç½²MySQLæ•°æ®åº“çš„æ­¥éª¤ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cb87" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">å®‰è£…Minikube</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="105f" class="mz md it mv b gy na nb l nc nd">brew install minikube</span></pre><p id="2f24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™å°†åœ¨æ‚¨çš„æœ¬åœ°æœºå™¨ä¸Šå®‰è£…minikubeã€‚å®‰è£…åæ£€æŸ¥minikubeç‰ˆæœ¬ã€‚</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="042d" class="mz md it mv b gy na nb l nc nd">minikube version: v1.13.1commit: 1fd1f67f338cbab4b3e5a6e4c71c551f522ca138</span></pre><h1 id="5e63" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">å¯åŠ¨Minikubeé›†ç¾¤</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="b5a8" class="mz md it mv b gy na nb l nc nd">minikube start</span><span id="3639" class="mz md it mv b gy nj nb l nc nd"><br/>ğŸ˜„  minikube v1.13.1 on Darwin 10.15.7</span><span id="4a50" class="mz md it mv b gy nj nb l nc nd">...</span><span id="4156" class="mz md it mv b gy nj nb l nc nd">ğŸ„  Done! kubectl is now configured to use "minikube" by default</span></pre><p id="3ba0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœä½ å¾—åˆ°ä¸€ä¸ªä¸Dockerç›¸å…³çš„é”™è¯¯ï¼Œé¦–å…ˆå®‰è£…Dockeræ¡Œé¢ã€‚æˆ–è€…ä¸ºdockerå¢åŠ å†…å­˜å’Œå†…æ ¸ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å°è¯•æ—¶é‡åˆ°çš„ä¸€ä¸ªç›¸å…³é”™è¯¯ã€‚</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="4aab" class="mz md it mv b gy na nb l nc nd">â›”  Exiting due to RSRC_DOCKER_CORES: Docker Desktop has less than 2 CPUs configured, but Kubernetes requires at least 2 to be available<br/>ğŸ’¡  Suggestion:    <br/>1. Click on "Docker for Desktop" menu icon<br/>2. Click "Preferences"<br/>3. Click "Resources"<br/>4. Increase "CPUs" slider bar to 2 or higher<br/>5. Click "Apply &amp; Restart"<br/>ğŸ“˜  Documentation: <a class="ae ky" href="https://docs.docker.com/docker-for-mac/#resources" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/docker-for-mac/#resources</a></span></pre><h1 id="18e8" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">æ£€æŸ¥å¹¶ç¡®è®¤å½“å‰é…ç½®å’Œé›†ç¾¤</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="ff16" class="mz md it mv b gy na nb l nc nd">kubectl config view</span><span id="2e24" class="mz md it mv b gy nj nb l nc nd">contexts:<br/>- context:<br/>cluster: minikube<br/>user: minikube<br/>name: minikube</span><span id="ca5e" class="mz md it mv b gy nj nb l nc nd">kubectl get all</span><span id="d759" class="mz md it mv b gy nj nb l nc nd">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE<br/>service/kubernetes ClusterIP IP &lt;none&gt; 443/TCP 2m49s</span></pre><p id="13a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨çš„minikubeé›†ç¾¤å·²ç»å¯åŠ¨å¹¶æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸”æ­£åœ¨ä½¿ç”¨é»˜è®¤çš„åç§°ç©ºé—´ã€‚ç°åœ¨è®©æˆ‘ä»¬ç»§ç»­éƒ¨ç½²ä¸€ä¸ªMySQLæ•°æ®åº“ã€‚</p><h1 id="77b1" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">éƒ¨ç½²å·</h1><p id="953a" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">è¦è®¾ç½®æœ‰çŠ¶æ€çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨éœ€è¦æŒä¹…æ€§å·æ¥å­˜å‚¨æ•°æ®ã€‚å› æ­¤ï¼Œåˆ›å»ºMySQLå®ä¾‹çš„ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºè¿™äº›<strong class="lb iu">æŒä¹…å·</strong>ã€‚è¿™æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨çš„YAMLã€‚</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="66be" class="mz md it mv b gy na nb l nc nd">apiVersion: v1<br/>kind: PersistentVolume<br/>metadata:<br/>  name: mysql-pv-volume<br/>  labels:<br/>    type: local<br/>spec:<br/>  storageClassName: manual<br/>  capacity:<br/>    storage: 20Gi<br/>  accessModes:<br/>    - ReadWriteOnce<br/>  hostPath:<br/>    path: "/mnt/data"<br/>---<br/>apiVersion: v1<br/>kind: PersistentVolumeClaim<br/>metadata:<br/>  name: mysql-pv-data<br/>spec:<br/>  storageClassName: manual<br/>  accessModes:<br/>    - ReadWriteOnce<br/>  resources:<br/>    requests:<br/>      storage: 20Gi</span></pre><p id="faa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ³¨æ„äº‹é¡¹:</p><p id="98a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">â†’<em class="np">metadata . name:mysql-PV-data</em>:è¿™æ˜¯å®é™…çš„MySQLéƒ¨ç½²å°†å¦‚ä½•ä½¿ç”¨å·</p><p id="39c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">â†’<em class="np">resources . requests . storage:20Gi</em>:è¿™æ˜¯æˆ‘ä»¬è¯·æ±‚çš„å­˜å‚¨</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="b0fb" class="mz md it mv b gy na nb l nc nd">kubectl apply -f pv-mysql.yaml</span><span id="bc65" class="mz md it mv b gy nj nb l nc nd">persistentvolume/mysql-pv-volume created<br/>persistentvolumeclaim/mysql-pv-data created</span></pre><h1 id="5049" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">æ£€æŸ¥å·èµ„æº</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="10e4" class="mz md it mv b gy na nb l nc nd"><strong class="mv iu">kubectl get pvc</strong></span><span id="0456" class="mz md it mv b gy nj nb l nc nd">NAME            STATUS   VOLUME            CAPACITY   ACCESS MODES   STORAGECLASS   AGE<br/>mysql-pv-data   Bound    mysql-pv-volume   <strong class="mv iu">20Gi</strong>       RWO            manual         12s</span></pre><h1 id="89fc" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">éƒ¨ç½²MySQL</h1><p id="31c7" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">è¿™æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨çš„YAMLã€‚</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="c9da" class="mz md it mv b gy na nb l nc nd">apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: mysql<br/>spec:<br/>  ports:<br/>  - port: 3306<br/>  selector:<br/>    app: mysql<br/>  clusterIP: None<br/>---<br/>apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2<br/>kind: Deployment<br/>metadata:<br/>  name: mysql<br/>spec:<br/>  selector:<br/>    matchLabels:<br/>      app: mysql<br/>  strategy:<br/>    type: Recreate<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: mysql<br/>    spec:<br/>      containers:<br/>      - image: mysql:5.6<br/>        name: mysql<br/>        env:<br/>          # Use secret in prod use cases<br/>        - name: MYSQL_ROOT_PASSWORD<br/>          value: password<br/>        ports:<br/>        - containerPort: 3306<br/>          name: mysql<br/>        volumeMounts:<br/>        - name: mysql-persistent-storage<br/>          mountPath: /var/lib/mysql<br/>      volumes:<br/>      - name: mysql-persistent-storage<br/>        persistentVolumeClaim:<br/>          claimName: mysql-pv-data</span></pre><p id="090c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ³¨æ„äº‹é¡¹:</p><p id="1a5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">â†’<em class="np">claim name:MySQL-PV-data:</em>ä¸ä¸Šé¢å®šä¹‰çš„å·åŒå</p><p id="5d5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">â†’ <em class="np">å€¼:å¯†ç </em>:è¿™æ˜¯ç™»å½•MySQLçš„å¯†ç ã€‚ä½ ä»¥åä¼šéœ€è¦å®ƒçš„ã€‚</p><h1 id="09d0" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„èµ„æº</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="2e5d" class="mz md it mv b gy na nb l nc nd">Cintos-Mac:MySQL_MiniKube cinto$ <strong class="mv iu">kubectl get all</strong><br/>NAME                         READY   STATUS    RESTARTS   AGE<br/>pod/mysql-7d8f78bf86-hfjkg   1/1     Running   0          38s</span><span id="dea1" class="mz md it mv b gy nj nb l nc nd">NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE<br/>service/kubernetes   ClusterIP   10.96.0.1    &lt;none&gt;        443/TCP    16m<br/>service/mysql        ClusterIP   None         &lt;none&gt;        3306/TCP   38s</span><span id="43b1" class="mz md it mv b gy nj nb l nc nd">NAME                    READY   UP-TO-DATE   AVAILABLE   AGE<br/>deployment.apps/mysql   1/1     1            1           38s</span><span id="334f" class="mz md it mv b gy nj nb l nc nd">NAME                               DESIRED   CURRENT   READY   AGE<br/>replicaset.apps/mysql-7d8f78bf86   1         1         1       38s</span></pre><p id="0e96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ‰ä¸€ä¸ª<strong class="lb iu"> pod </strong>æ­£åœ¨è¿è¡Œï¼Œä¸€ä¸ª<strong class="lb iu">éƒ¨ç½²ï¼Œ</strong>å’Œä¸€ä¸ª<strong class="lb iu">å‰¯æœ¬é›†</strong>ã€‚è¿™äº›æ˜¯æˆ‘ä»¬åœ¨YAMLé…ç½®çš„ã€‚</p><h1 id="08a7" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">ç™»å½•MySQL podå¹¶éªŒè¯</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="415b" class="mz md it mv b gy na nb l nc nd">kubectl exec -it pod/mysql-7d8f78bf86-hfjkg /bin/bash</span></pre><p id="49c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™å°†ç™»å½•åˆ°MySQLæ­£åœ¨è¿è¡Œçš„podã€‚</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="1622" class="mz md it mv b gy na nb l nc nd">mysql -ppassword<br/>Welcome to the MySQL monitor.  Commands end with ; or \g.<br/>Your MySQL connection id is 2<br/>Server version: 5.6.50 MySQL Community Server (GPL)<br/>...<br/>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement</span><span id="d3c2" class="mz md it mv b gy nj nb l nc nd">mysql&gt;</span></pre><p id="ef0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬ç°åœ¨å·²ç»ç™»å½•åˆ°MySQLæ•°æ®åº“ã€‚</p><h1 id="425e" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">åˆ›å»ºç¤ºä¾‹è¡¨å’Œæ•°æ®</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="2729" class="mz md it mv b gy na nb l nc nd">use mysql<br/>CREATE TABLE test_kube(namespace VARCHAR(100),cluster VARCHAR(50), create_date DATE);<br/>Query OK, 0 rows affected (0.01 sec)</span><span id="c585" class="mz md it mv b gy nj nb l nc nd">insert into test_kube values('default','minikube','2020-10-10');<br/>Query OK, 1 row affected, 1 warning (0.00 sec)</span><span id="d82c" class="mz md it mv b gy nj nb l nc nd">select * from test_kube;<br/>+-----------+----------+-------------+<br/>| namespace | cluster  | create_date |<br/>+-----------+----------+-------------+<br/>| default   | minikube | 2020-10-10  |<br/>+-----------+----------+-------------+<br/>1 row in set (0.00 sec)</span></pre><p id="6e82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨çš„è®¾ç½®å·²ç»å°±ç»ªã€‚äº«å—å§ã€‚</p><h1 id="31f3" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">åˆ é™¤å’Œæ¸…ç†</h1><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="2003" class="mz md it mv b gy na nb l nc nd">minikube stop</span></pre><p id="8a96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·ç»™æˆ‘ç•™è¨€ã€‚</p><p id="0232" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœæ‚¨æƒ³å­¦ä¹ Unixé«˜çº§å‘½ä»¤ï¼Œè¯·æŸ¥çœ‹ä»¥ä¸‹å†…å®¹:</p><div class="nq nr gp gr ns nt"><a rel="noopener  ugc nofollow" target="_blank" href="/advanced-unix-commands-to-boost-your-productivity-4af6e9086c04"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">æé«˜ç”Ÿäº§åŠ›çš„é«˜çº§Unixå‘½ä»¤</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">ä½ å­¦å¾—è¶Šå¤šï¼Œä½ å°±å˜å¾—è¶Šå¥½</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh ks nt"/></div></div></a></div></div></div>    
</body>
</html>