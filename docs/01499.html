<html>
<head>
<title>3 Python list comprehension tricks you might not know yet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你可能还不知道的3个Python列表理解技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/3-python-list-comprehension-tricks-you-might-not-know-yet-5891d904ee76?source=collection_archive---------3-----------------------#2020-01-08">https://levelup.gitconnected.com/3-python-list-comprehension-tricks-you-might-not-know-yet-5891d904ee76?source=collection_archive---------3-----------------------#2020-01-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/0dd9de8b1a621f0ccf701e4cc2978d53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXI-kg18liPn4XcfZmoqQQ.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="dd3b" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">列表理解不仅仅是为了列表</h2></div><p id="c833" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果你使用过Python，你可能会熟悉<em class="lp">列表理解</em>语法。</p><p id="11f6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果你从这样一个列表开始:</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="86e0" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; words = ['goodbye', 'cruel', 'world']</span></pre><p id="2f96" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">您可以像这样创建一个新列表:</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="34e0" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; lengths = [len(x) for x in words]<br/>[7, 5, 5]</span></pre><p id="8433" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">与将项目追加到空列表相比。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="067e" class="lz ma je lv b gy mb mc l md me"># Not the pythonic way!<br/>lengths = []<br/>for word in words:<br/>    lengths.append(len(word))</span></pre><p id="2c8e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用list comprehension <em class="lp">和</em>创建列表更加简洁，也更容易阅读。</p><p id="9bee" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但是你知道你可以用同样的技术创造其他类型的物体吗？</p><p id="e51e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">列表理解不仅仅是为了列表。</p><p id="25f8" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们将向你展示3个你可能还没用过的技巧。它们将有助于使你的代码更容易阅读，更容易编写。</p><h2 id="4613" class="lz ma je bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated">1.词典理解</h2><p id="bfa7" class="pw-post-body-paragraph kt ku je kv b kw mw kf ky kz mx ki lb lc my le lf lg mz li lj lk na lm ln lo im bi translated">您也可以使用相同的列表理解语法创建词典。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="a6d6" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; data = {word: len(word) for word in words}<br/>{"goodbye": 7, "cruel": 5, "world": 5}</span></pre><p id="f4c1" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">注意键<code class="fe nb nc nd lv b">word</code>和它的值<code class="fe nb nc nd lv b">len(word)</code>用冒号<code class="fe nb nc nd lv b">:</code>分开。</p><p id="bc3a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这意味着您需要使用<code class="fe nb nc nd lv b">word: len(word)</code>而不是<code class="fe nb nc nd lv b">word, len(word)</code>，这将是一个语法错误。</p><p id="75f3" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">额外收获:创建字典的另一个有用的技巧是将两个列表放在一起。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="9ad9" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; words = ["hello", "old", "friend"]<br/>&gt;&gt;&gt; lengths = [len(word) for word in words]<br/>&gt;&gt;&gt; data = dict(zip(words, lengths))<br/>{"hello": 5, "old": 3, "friend": 6}</span></pre><h2 id="32e5" class="lz ma je bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated">2.过滤</h2><p id="3631" class="pw-post-body-paragraph kt ku je kv b kw mw kf ky kz mx ki lb lc my le lf lg mz li lj lk na lm ln lo im bi translated">您可以过滤包含的项目。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="9749" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; words = ['deified', 'radar', 'guns']<br/>&gt;&gt;&gt; palindromes = [word for word in words if word == word[::-1]]<br/>['deified', 'radar']</span></pre><p id="74ad" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">过滤也适用于字典理解。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="cb4f" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; words = ["not", "on", "my", "watch"]<br/>&gt;&gt;&gt; data = {w: w[::-1] for w in words if len(w) &lt; 5}<br/>{'not': 'ton', 'on': 'no', 'my': 'ym'}</span></pre><h2 id="403b" class="lz ma je bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated">3.发电机</h2><p id="1898" class="pw-post-body-paragraph kt ku je kv b kw mw kf ky kz mx ki lb lc my le lf lg mz li lj lk na lm ln lo im bi translated">您也可以使用相同的语法创建<em class="lp">生成器</em>。</p><p id="5e1e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">生成器是类似于列表的<em class="lp"> iterables </em>，但是生成器中的项目只有在实际使用时才会被创建。用过之后，它们被扔掉，不能再用了。</p><p id="a711" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">所以生成器比列表占用更少的内存，但是你只能迭代一次。</p><p id="30b0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这里有一个例子。(图片我们有一个名为<code class="fe nb nc nd lv b">bigdata.txt</code>的文件，有数百万行)。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="d813" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; text = open("bigdata.txt", "r")<br/>&gt;&gt;&gt; lines = (line for line in text if line.startswith("2020-01-01"))<br/>&lt;generator object &lt;genexpr&gt; at 0x10fe3d550&gt;</span></pre><p id="e2d3" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们已经打开了一个大型数据文件，并创建了一个生成器对象。生成器对象将只包含以<code class="fe nb nc nd lv b">2020-01-01</code>开头的行。</p><p id="82a0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">因为我们使用了生成器理解而不是列表理解，所以我们不需要读取整个文件。</p><p id="a1a6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">让我们找出文件中各行的平均长度。</p><p id="cfa8" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">首先，我们将编写一个助手函数。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="ee0a" class="lz ma je lv b gy mb mc l md me">def average_line_length(lines):<br/>    num_lines = 0<br/>    total_length = 0<br/>    for line in lines:<br/>        num_lines += 1<br/>        total_length += len(line)<br/>    return total_length / num_lines</span></pre><p id="d64c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们现在将通过<code class="fe nb nc nd lv b">lines</code>发电机。</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="6aca" class="lz ma je lv b gy mb mc l md me">&gt;&gt;&gt; result = average_line_length(lines)<br/>24</span></pre><p id="9fb5" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用generator comprehension的好处是我们不需要读入大型数据文件。</p><p id="4d35" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但是我们仍然可以将生成器传递给其他需要可迭代的函数，比如<code class="fe nb nc nd lv b">average_line_length </code>函数。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="bfaa" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">感谢阅读！如果您觉得这很有用，我还写了其他Python和数据科学技巧，所以请关注我，获取更多类似本文的文章。</p><div class="is it gp gr iu nl"><a href="https://towardsdatascience.com/how-to-reuse-your-python-models-without-retraining-them-39cd685659a5" rel="noopener follow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd jf gy z fp nq fr fs nr fu fw jd bi translated">如何重用您的Python模型而无需重新训练它们</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">Python的对象序列化库简介</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">towardsdatascience.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ja nl"/></div></div></a></div></div></div>    
</body>
</html>