<html>
<head>
<title>How to Render a React App Using an Express Server in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中使用Express服务器呈现React应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-render-react-app-using-express-server-in-node-js-a428ec4dfe2b?source=collection_archive---------0-----------------------#2020-05-10">https://levelup.gitconnected.com/how-to-render-react-app-using-express-server-in-node-js-a428ec4dfe2b?source=collection_archive---------0-----------------------#2020-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="843b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用Express.js服务create-react-app创建的整个构建文件夹</h2></div><p id="98e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将探索如何使用<code class="fe lb lc ld le b">Express.js</code>服务器呈现React应用程序。</p><p id="f43b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你正在使用<code class="fe lb lc ld le b">Express.js</code>、<code class="fe lb lc ld le b">React.js</code>、<code class="fe lb lc ld le b">Node.js</code>和<code class="fe lb lc ld le b">Nodejs</code>中的任何数据库创建一个全栈应用，这是非常有用的。因此，我们可以在同一个端口上运行我们的<code class="fe lb lc ld le b">React.js</code>和<code class="fe lb lc ld le b">Node.js</code>应用程序，避免运行两个单独的命令来启动<code class="fe lb lc ld le b">Node.js</code>和<code class="fe lb lc ld le b">React.js</code>应用程序。</p><p id="0fe1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在深入研究之前，让我们首先了解如何使用<code class="fe lb lc ld le b">Express.js</code>来服务静态文件</p></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h2 id="ca95" class="lm ln iq bd lo lp lq dn lr ls lt dp lu ko lv lw lx ks ly lz ma kw mb mc md me bi translated"><strong class="ak">使用Express.js提供静态文件:</strong></h2><p id="67f1" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">有一些要求，我们需要在浏览器中访问一些文件，但如果您在服务器端运行的<code class="fe lb lc ld le b">Node.js</code>中使用<code class="fe lb lc ld le b">Express.js</code>，这些文件不会自动可用。为了让它工作，我们需要做一些代码更改。让我们开始吧。</p><p id="06cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个名为<code class="fe lb lc ld le b">express-static-serve</code>的新文件夹，在该文件夹中，创建另一个名为<code class="fe lb lc ld le b">server</code>的文件夹，并从终端的<code class="fe lb lc ld le b">server</code>文件夹中运行以下命令。</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="392b" class="lm ln iq le b gy ms mt l mu mv">yarn init -y</span></pre><p id="dba0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将在<code class="fe lb lc ld le b">server</code>文件夹中创建一个<code class="fe lb lc ld le b">package.json</code>文件</p><p id="643e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行以下命令安装<code class="fe lb lc ld le b">express</code>和<code class="fe lb lc ld le b">nodemon</code>包</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="5272" class="lm ln iq le b gy ms mt l mu mv">yarn add express@4.17.1 nodemon@2.0.3</span></pre><p id="e19f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">nodemon</code>用于在我们更改代码时重启应用程序</p><p id="9916" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个新文件<code class="fe lb lc ld le b">index.js</code>并在其中添加以下内容</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">索引. js</figcaption></figure><p id="7667" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">package.json</code>的<code class="fe lb lc ld le b">scripts</code>部分添加新脚本</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="d872" class="lm ln iq le b gy ms mt l mu mv">"start": "nodemon index.js"</span></pre><figure class="mk ml mm mn gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/c59f4e91e54202a607e366d69a9de1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BStHoWOkrCfrXVhZVzbiYw.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">package.json</figcaption></figure><p id="68e4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，从<code class="fe lb lc ld le b">server</code>文件夹运行<code class="fe lb lc ld le b">yarn start</code>命令启动应用程序</p><p id="1476" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果导航到<a class="ae nk" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000/ </a>。您将看到浏览器中显示的消息</p><p id="f95d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种静态硬编码的消息很好，但是如果我们想要呈现包含CSS和Javascript文件而不是文本的HTML文件的内容，我们该怎么做呢？</p><p id="93b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，创建一个名为<code class="fe lb lc ld le b">public</code>的新文件夹，并在其中创建两个名为<code class="fe lb lc ld le b">js</code>和<code class="fe lb lc ld le b">css</code>的文件夹。</p><p id="3fd0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">public/js</code>文件夹中添加<code class="fe lb lc ld le b">script.js</code>，内容如下</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">脚本. js</figcaption></figure><p id="0f86" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将<code class="fe lb lc ld le b">styles.css</code>添加到<code class="fe lb lc ld le b">public/css</code>文件夹中，内容如下</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">样式. css</figcaption></figure><p id="9579" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将<code class="fe lb lc ld le b">index.html</code>添加到<code class="fe lb lc ld le b">public</code>文件夹中，内容如下</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">index.html</figcaption></figure><p id="85f1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，在<code class="fe lb lc ld le b">index.js</code>中，为<code class="fe lb lc ld le b">path</code>包添加一个导入，并发送<code class="fe lb lc ld le b">index.html</code>文件以响应<code class="fe lb lc ld le b">/</code>路径</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="1e84" class="lm ln iq le b gy ms mt l mu mv">const path = require("path");</span><span id="a648" class="lm ln iq le b gy nl mt l mu mv">app.get("/", (req, res) =&gt; {<br/> res.sendFile(path.join(__dirname, "public", "index.html"));<br/>});</span></pre><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">更新的index.js</figcaption></figure><p id="bbd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，如果您检查应用程序，您会看到<code class="fe lb lc ld le b">index.html</code>中的按钮已显示，但Javascript和CSS文件未加载，浏览器控制台中显示错误</p><figure class="mk ml mm mn gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nm"><img src="../Images/90c81e1425c69a77f3214b73da77454b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KN0z0uFg7nE4bFzZA3l-mg.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">应用</figcaption></figure><p id="d961" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，<code class="fe lb lc ld le b">Express.js</code>无法使用<code class="fe lb lc ld le b">sendFile</code>方法渲染<code class="fe lb lc ld le b">public</code>文件夹中的静态CSS和JavaScript文件。</p><p id="6a6b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这个问题，我们需要使用<code class="fe lb lc ld le b">Express.js</code>提供的<code class="fe lb lc ld le b">express.static</code>方法添加一个<code class="fe lb lc ld le b">middleware</code></p><p id="7175" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以不要</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="bb7b" class="lm ln iq le b gy ms mt l mu mv">app.get("/", (req, res) =&gt; {<br/> res.sendFile(path.join(__dirname, "public", "index.html"));<br/>});</span></pre><p id="c7b8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">index.js</code>中添加以下代码</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="12eb" class="lm ln iq le b gy ms mt l mu mv">app.use(express.static("public"));</span></pre><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">索引. js</figcaption></figure><p id="e8fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将通知<code class="fe lb lc ld le b">Express.js</code>提供<code class="fe lb lc ld le b">public</code>文件夹中的所有文件</p><p id="b314" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，如果您在<a class="ae nk" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000/ </a>检查应用程序，您将看到控制台中没有错误，CSS被正确应用，并且单击按钮还会显示当前日期</p><figure class="mk ml mm mn gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nn"><img src="../Images/86f27d10eb9d36ac13a2d17dcc20ac49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6U5dZv4yhbKKp45agit-EA.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">工作应用</figcaption></figure><p id="9b91" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们在<code class="fe lb lc ld le b">public</code>文件夹中有任何其他文件，如<code class="fe lb lc ld le b">help.html</code>或<code class="fe lb lc ld le b">contact.html</code>，我们也可以通过直接URL访问，如<a class="ae nk" href="http://localhost:5000/help.html" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/help . html</a>或<a class="ae nk" href="http://localhost:5000/contact.html" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/contact . html</a></p><p id="2329" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">public</code>文件夹中新建一个<code class="fe lb lc ld le b">users.json</code>文件，内容如下</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">用户. json</figcaption></figure><p id="9bc3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以通过访问<a class="ae nk" href="http://localhost:5000/users.json" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/users . JSON</a>进行访问</p><figure class="mk ml mm mn gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi no"><img src="../Images/42eebde37cc1d0bd763831a6e77c126b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vu1W7ZtLTBfrn8vWaEk0tg.png"/></div></div></figure><p id="a570" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，只需添加<code class="fe lb lc ld le b">express.static</code>方法，我们就可以服务于所有的JavaScript、CSS、HTML，甚至图像。</p><p id="35bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注意:</strong>我们可以在一个文件中有多个<code class="fe lb lc ld le b">express.static</code>方法，每个方法服务于不同的文件夹内容。</p><p id="59c8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在这里找到到此为止的源代码<a class="ae nk" href="https://github.com/myogeshchavan97/express-static-serve/tree/static-serve-initial" rel="noopener ugc nofollow" target="_blank"/></p><h2 id="3260" class="lm ln iq bd lo lp lq dn lr ls lt dp lu ko lv lw lx ks ly lz ma kw mb mc md me bi translated"><strong class="ak">使用Express.js渲染React app:</strong></h2><p id="df3e" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">通过从<code class="fe lb lc ld le b">express-static-serve</code>文件夹运行以下命令，使用<code class="fe lb lc ld le b">create-react-app</code>创建一个新的React应用程序</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="c1d0" class="lm ln iq le b gy ms mt l mu mv">create-react-app react-app</span></pre><p id="76b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以现在，<code class="fe lb lc ld le b">express-static-serve</code>文件夹中有两个文件夹，一个名为<code class="fe lb lc ld le b">server</code>，另一个名为<code class="fe lb lc ld le b">react-app</code></p><p id="e188" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从终端/命令提示符导航到<code class="fe lb lc ld le b">react-app</code>文件夹，运行以下命令安装<code class="fe lb lc ld le b">axios</code>库</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="4757" class="lm ln iq le b gy ms mt l mu mv">yarn add axios@0.19.2</span></pre><p id="6f6d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成后，删除<code class="fe lb lc ld le b">react-app/src</code>文件夹中的所有文件，并在<code class="fe lb lc ld le b">src</code>文件夹中创建<code class="fe lb lc ld le b">index.js</code>、<code class="fe lb lc ld le b">App.js</code>和<code class="fe lb lc ld le b">styles.css</code></p><p id="bf0c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开<code class="fe lb lc ld le b">App.js</code>并添加以下内容</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">App.js</figcaption></figure><p id="2e41" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开<code class="fe lb lc ld le b">styles.css</code>并添加以下内容</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">样式. css</figcaption></figure><p id="1aee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开<code class="fe lb lc ld le b">index.js</code>并添加以下内容</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">索引. js</figcaption></figure><p id="c28f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，将<code class="fe lb lc ld le b">server</code>文件夹从<code class="fe lb lc ld le b">express-static-serve</code>移动到<code class="fe lb lc ld le b">react-app</code>文件夹</p><p id="995d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，您的文件夹结构将如下所示</p><figure class="mk ml mm mn gt mw gh gi paragraph-image"><div class="gh gi np"><img src="../Images/68ed1a987bb2a43859f57fb7f42950b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*pQx0IL1a5Ly13r0mwIQmXQ.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">文件夹结构</figcaption></figure><p id="6f33" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，从<code class="fe lb lc ld le b">react-app</code>文件夹中打开<code class="fe lb lc ld le b">package.json</code>并改变</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="8f89" class="lm ln iq le b gy ms mt l mu mv">"start": "react-scripts start",</span></pre><p id="143a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="f5ff" class="lm ln iq le b gy ms mt l mu mv">"start-client": "react-scripts start",</span></pre><p id="7823" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并添加新的<code class="fe lb lc ld le b">start</code>脚本</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="67a5" class="lm ln iq le b gy ms mt l mu mv">"start": "yarn run build &amp;&amp; (cd server &amp;&amp; yarn start)"</span></pre><p id="fa82" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里，我们将首先生成<code class="fe lb lc ld le b">build</code>文件夹，然后使用<code class="fe lb lc ld le b">Express.js</code>服务于那个<code class="fe lb lc ld le b">build</code>文件夹</p><p id="3667" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以你的<code class="fe lb lc ld le b">package.json</code>会是这个样子</p><figure class="mk ml mm mn gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nq"><img src="../Images/0a878e65694ce68a88fe29c92c857c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yn3NA8-8AIdn3JSYVe4GJg.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">package.json</figcaption></figure><p id="d86a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，打开<code class="fe lb lc ld le b">server/index.js</code>并为<code class="fe lb lc ld le b">path</code>和另一个<code class="fe lb lc ld le b">app.use</code>添加一个导入，以服务于<code class="fe lb lc ld le b">create-react-app</code>即将创建的<code class="fe lb lc ld le b">build</code>文件夹。</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="1da7" class="lm ln iq le b gy ms mt l mu mv">const path = require("path");</span><span id="bd27" class="lm ln iq le b gy nl mt l mu mv">app.use(express.static(path.join(__dirname, "..", "build")));<br/>app.use(express.static("public"));</span></pre><p id="b301" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里，在第一个<code class="fe lb lc ld le b">app.use</code>中，由于<code class="fe lb lc ld le b">build</code>文件夹将被创建在<code class="fe lb lc ld le b">react-app</code>文件夹内，我们为位于服务器文件夹外的<code class="fe lb lc ld le b">build</code>文件夹创建一个路径。</p><p id="dad9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注:<code class="fe lb lc ld le b">app.use</code>的</strong>顺序此处为准。我们希望我们的<code class="fe lb lc ld le b">React</code>应用程序在页面加载时显示，所以应该首先加载<code class="fe lb lc ld le b">build</code>文件夹，因为它也将包含<code class="fe lb lc ld le b">index.html</code>。如果我们先添加<code class="fe lb lc ld le b">public</code>文件夹，那么<code class="fe lb lc ld le b">server/public</code>文件夹中的<code class="fe lb lc ld le b">index.html </code>将被加载，因为<code class="fe lb lc ld le b">Express.js</code>从上到下读取文件，并且当它找到第一个匹配文件时停止渲染。</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">更新的index.js</figcaption></figure><p id="b44a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，从终端导航到<code class="fe lb lc ld le b">react-app</code>文件夹并运行<code class="fe lb lc ld le b">yarn start</code>命令，您将看到显示React应用程序，并且类似<code class="fe lb lc ld le b">help.html</code>、<code class="fe lb lc ld le b">users.json</code>的文件也可以在<code class="fe lb lc ld le b">5000</code>的同一个端口上访问。</p><div class="mk ml mm mn gt ab cb"><figure class="nr mw ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><img src="../Images/38c62b7899117c3532fe5e42ab860d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*ln8ykVQISfdH-yruXpxNGw.png"/></div></figure><figure class="nr mw nx nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><img src="../Images/f9abb3a4762ac0bd5443301fea3f5672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*fRxd6dCrnZhsNFcHgK5qIw.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk ny di nz oa translated">最终应用</figcaption></figure></div><p id="bac9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你的React应用程序使用路由，那么它将不会工作，因为我们从<code class="fe lb lc ld le b">Express.js</code>启动服务器，所以请求将总是发送到<code class="fe lb lc ld le b">Express.js</code>服务器，并且没有任何路由来处理它。</p><p id="f620" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，要解决这个问题，请在<code class="fe lb lc ld le b">server/index.js</code>文件中的所有<code class="fe lb lc ld le b">Express.js</code>路线和中间件之后添加以下代码。</p><pre class="mk ml mm mn gt mo le mp mq aw mr bi"><span id="eb6b" class="lm ln iq le b gy ms mt l mu mv">app.use((req, res, next) =&gt; {<br/>  res.sendFile(path.join(__dirname, "..", "build", "index.html"));<br/>});</span></pre><p id="2c04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以现在，当任何路由的请求到达服务器，而您试图访问的路由在服务器端不存在时，我们将从<code class="fe lb lc ld le b">build</code>文件夹发送<code class="fe lb lc ld le b">index.html</code>文件，这样您的客户端路由(React App)将处理该请求并显示客户端路由页面。</p><p id="301b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您最终的<code class="fe lb lc ld le b">server/index.js</code>文件将如下所示:</p><figure class="mk ml mm mn gt mw"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="a286" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在这里找到本文<a class="ae nk" href="https://github.com/myogeshchavan97/express-static-serve" rel="noopener ugc nofollow" target="_blank">的完整源代码，在这里</a>找到现场演示<a class="ae nk" href="https://express-static-serve.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"/></p><p id="81e1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天到此为止。我希望你学到了新东西。</p><p id="7d5e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看看我最近出版的<a class="ae nk" href="https://master-redux.yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank">掌握Redux </a>课程。</p><p id="eafd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本课程中，您将构建3个应用程序以及一个点餐应用程序，您将了解:</p><ul class=""><li id="6624" class="ob oc iq kh b ki kj kl km ko od ks oe kw of la og oh oi oj bi translated">基本和高级冗余</li><li id="f7e4" class="ob oc iq kh b ki ok kl ol ko om ks on kw oo la og oh oi oj bi translated">如何管理数组和对象的复杂状态</li><li id="179e" class="ob oc iq kh b ki ok kl ol ko om ks on kw oo la og oh oi oj bi translated">如何使用多个减速器管理复杂的冗余状态</li><li id="2415" class="ob oc iq kh b ki ok kl ol ko om ks on kw oo la og oh oi oj bi translated">如何调试Redux应用程序</li><li id="95b3" class="ob oc iq kh b ki ok kl ol ko om ks on kw oo la og oh oi oj bi translated">如何在React中使用Redux使用react-redux库让你的app反应性。</li><li id="8cf9" class="ob oc iq kh b ki ok kl ol ko om ks on kw oo la og oh oi oj bi translated">如何使用redux-thunk库处理异步API调用等等</li></ul><p id="b43a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们将从头开始构建一个完整的<a class="ae nk" href="https://www.youtube.com/watch?v=2zaPDfCKAvM" rel="noopener ugc nofollow" target="_blank">订餐应用</a>，集成stripe以接受支付，并将其部署到生产中。</p><p id="d645" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">别忘了直接在你的收件箱</strong> <a class="ae nk" href="https://yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">订阅我的每周时事通讯，里面有惊人的技巧、诀窍和文章。</strong> </a></p></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><h1 id="6f58" class="op ln iq bd lo oq or os lr ot ou ov lu jw ow jx lx jz ox ka ma kc oy kd md oz bi translated">分级编码</h1><p id="9489" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">感谢您成为我们社区的一员！升级正在改变技术招聘。<a class="ae nk" href="https://jobs.levelup.dev/talent" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">在最好的公司</strong> </a> <strong class="kh ir">找到你的完美工作</strong>。</p><div class="pa pb gp gr pc pd"><a href="https://jobs.levelup.dev/talent" rel="noopener  ugc nofollow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd ir gy z fp pi fr fs pj fu fw ip bi translated">提升——改变招聘流程</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">🔥让软件工程师找到他们热爱的完美角色🧠寻找人才是最痛苦的部分…</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">作业. levelup.dev</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr ni pd"/></div></div></a></div></div></div>    
</body>
</html>