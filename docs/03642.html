<html>
<head>
<title>Config Service using Google Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Sheet配置服务</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/config-service-using-google-sheet-6ac126b1c742?source=collection_archive---------8-----------------------#2020-05-20">https://levelup.gitconnected.com/config-service-using-google-sheet-6ac126b1c742?source=collection_archive---------8-----------------------#2020-05-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0a6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从Google Sheet获取环境配置的简单服务。</p><p id="1824" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按照下面的步骤在本地将该服务部署为docker容器。</p><h2 id="0a04" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">启用API</h2><p id="ead5" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">去https://developers.google.com/console</p><p id="6059" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">启用工作表API和驱动API</p><h2 id="9d12" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">创建服务帐户</h2><p id="c7fd" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">创建一个服务帐户，并下载JSON中的服务帐户密钥。将此密钥重命名为client-secret.json。复制client-email以供将来参考。</p><h2 id="ca8d" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">创建Google工作表(sheet.new)</h2><p id="c103" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">在多个工作表中创建条目。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/9cad5fbd1b21aaa225eafc94ca8131e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OO-RqBGVzdaShY2OvkgLJA.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">示例配置数据</figcaption></figure><p id="a052" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与上一步中创建的服务帐户的客户端电子邮件共享Google表单。</p><h2 id="50d2" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">创建一个Docker容器。</h2><p id="6f34" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">创建文件夹凭据并复制服务帐户(client-secret.json)。</p><p id="1935" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行以下命令创建docker容器。</p><pre class="ll lm ln lo gt ma mb mc md aw me bi"><span id="7df7" class="kl km iq mb b gy mf mg l mh mi">docker run -v $PWD/credentials:/app/credentials -p 8080:8080 vikramshinde/config-service-googlesheet:latest</span></pre><h2 id="c3a0" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">触及API端点</h2><pre class="ll lm ln lo gt ma mb mc md aw me bi"><span id="7d9f" class="kl km iq mb b gy mf mg l mh mi">localhost:8080/project/&lt;&lt;spreadsheet name&gt;&gt;/env/&lt;&lt;worksheet_name&gt;&gt;/key/&lt;&lt;config_key&gt;&gt;</span><span id="234f" class="kl km iq mb b gy mj mg l mh mi">e.g.<br/>localhost:8080/project/mskproject/env/PROD/key/PROJECT_NAME</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="00ab" class="mr km iq bd kn ms mt mu kq mv mw mx kt my mz na kw nb nc nd kz ne nf ng lc nh bi translated">背景</h1><p id="f53b" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">这个应用程序正在使用<a class="ae lj" href="https://pypi.org/project/gspread/" rel="noopener ugc nofollow" target="_blank"> gspread </a> python库来连接Google Sheet。</p><p id="25f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您也可以下载该代码的副本。</p><pre class="ll lm ln lo gt ma mb mc md aw me bi"><span id="36ef" class="kl km iq mb b gy mf mg l mh mi">git clone <a class="ae lj" href="https://github.com/vikramshinde12/config-service-googlesheet.git" rel="noopener ugc nofollow" target="_blank">https://github.com/vikramshinde12/vikramshinde/config-service-googlesheet.git</a></span></pre><p id="46bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Dockerfile文件</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="91ff" class="mr km iq bd kn ms nk mu kq mv nl mx kt my nm na kw nb nn nd kz ne no ng lc nh bi translated">结论</h1><p id="bef0" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">这样，我们可以添加多个项目环境变量，并将它们共享到一个配置服务中。</p></div></div>    
</body>
</html>