<html>
<head>
<title>Upload And Download Multiple Files Using .Net 5.0 Web API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用上传和下载多个文件。Net 5.0 Web API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/upload-and-download-multiple-files-using-net-5-0-web-api-430f95f34237?source=collection_archive---------0-----------------------#2021-07-01">https://levelup.gitconnected.com/upload-and-download-multiple-files-using-net-5-0-web-api-430f95f34237?source=collection_archive---------0-----------------------#2021-07-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5a91ca9272eee2e9efeb80294e94cdc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QXEjrKj9H90llCXt6HmLJg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">多文件上传-下载</figcaption></figure><p id="d22f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">今天，我们将通过一个简单的过程，介绍如何使用ASP.Net核心5.0 web API上传和下载多个文件。</p><p id="079a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">注意:</strong>同样的技术也适用于。Net Core 3.1和。Net Core 2.1也是如此。</p><p id="ebf7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">首先在visual studio中创建一个空的web API项目，对于目标，框架选择<strong class="kh iu">。Net 5.0。</strong></p><p id="1691" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个项目中没有使用外部包。</p><p id="e308" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">创建一个服务文件夹，并在其中创建一个文件服务类和IFileService接口。</p><p id="5b2c" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们在这个文件Service.cs中使用了三种方法</p><ul class=""><li id="b089" class="ld le it kh b ki kj km kn kq lf ku lg ky lh lc li lj lk ll bi translated">上传文件</li><li id="b10f" class="ld le it kh b ki lm km ln kq lo ku lp ky lq lc li lj lk ll bi translated">下载文件</li><li id="156f" class="ld le it kh b ki lm km ln kq lo ku lp ky lq lc li lj lk ll bi translated">尺寸转换器</li></ul><p id="171e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因为我们需要一个文件夹来存储这些上传的文件，这里我们添加了一个参数来传递文件夹名作为一个字符串，它将在那里存储所有这些文件。</p><p id="e4ba" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">文件服务. cs </strong></p><figure class="lr ls lt lu gt ju"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="ee71" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">SizeConverter函数用于获取上传到服务器的文件的实际大小。</p><p id="6ba3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> IFileService.cs </strong></p><figure class="lr ls lt lu gt ju"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="c081" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们在startup.cs文件中添加这个服务依赖项</p><p id="c740" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> Startup.cs </strong></p><figure class="lr ls lt lu gt ju"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="4c9f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">创建一个FileController &amp;现在使用这个FileController中的构造函数注入来注入这个IFileService。</p><p id="a97b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">文件控制器. cs </strong></p><figure class="lr ls lt lu gt ju"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="a2ac" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们可以在swagger和postman中测试我们的API。</p><figure class="lr ls lt lu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/9bc674339fb0b73506733e252269ffdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cuzf4O5vXpImf7RXhcfV6w.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图一</figcaption></figure><p id="b402" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这里我们看到我们创建的两个API，分别用于上传和下载，所以让我们分别测试这两个API。</p><figure class="lr ls lt lu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/4e8d29b453696aec7d3f7678b6173cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68-MEeQmGHnIdKD0LQ8V_A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图二</figcaption></figure><p id="71af" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">传递子目录中的文件夹名称，并在下面添加文件，以保存在服务器中的文件夹名称下。作为响应，我们会看到文件总数和整个文件的实际大小。</p><figure class="lr ls lt lu gt ju gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/2bb0550f3fde54549002558cf94121c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*iRt6Akb9QUpvptjySa4uiw.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图三</figcaption></figure><p id="14a4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，将使用下载API进行检查。由于我们的文件夹中有多个文件，它将作为一个<strong class="kh iu"> Zip文件</strong>下载，我们需要提取它来检查文件。</p><figure class="lr ls lt lu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ma"><img src="../Images/04905405545a0a2ac1f5f2ea5ad80828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LsP42QhHHRNxxg-9kvrECA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图4</figcaption></figure><p id="8940" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> <em class="mb">源代码</em> </strong></p><div class="mc md gp gr me mf"><a href="https://github.com/JayKrishnareddy/UploadandDownloadFiles" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">JayKrishnareddy/UploadandDownloadFiles</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">github.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt jz mf"/></div></div></a></div><p id="c360" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">结论</strong></p><p id="815d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">希望这篇文章能让你清楚地理解使用。Net 5.0。</p><p id="012d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">谢谢你坚持到最后，也谢谢你的阅读。请在评论区告诉我你的问题、想法或反馈。感谢您的反馈和鼓励。</p><p id="7bce" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">….继续学习！！！</p></div></div>    
</body>
</html>