<html>
<head>
<title>Events vs Functions in Solidity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">固体中的事件与功能</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/events-vs-functions-in-solidity-3d6e797f349e?source=collection_archive---------7-----------------------#2021-04-18">https://levelup.gitconnected.com/events-vs-functions-in-solidity-3d6e797f349e?source=collection_archive---------7-----------------------#2021-04-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7469" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">两者的区别以及何时使用。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d13f10d25c33451b9b8630d65df061d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SG465junzD4iBAavSaoSxg.png"/></div></div></figure><p id="07a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">函数是任何编程语言的核心特性。它们允许我们通过在一个函数中编写一次代码来简化我们的代码库。然后在我们需要的时候调用这个函数。</p><p id="0d52" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<a class="ae lq" href="https://docs.soliditylang.org/en/v0.8.3/index.html" rel="noopener ugc nofollow" target="_blank"> Solidity </a>中，函数可以读取、写入、更改和存储智能合约中的数据。您可以将自变量(参数)传递给函数。如果你想的话，这个函数可以返回值。</p><p id="ebdf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们看一个例子。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="c099" class="lw lx it ls b gy ly lz l ma mb">function owner() public view returns(address) {</span><span id="933c" class="lw lx it ls b gy mc lz l ma mb">return _owner;</span><span id="275e" class="lw lx it ls b gy mc lz l ma mb">}</span></pre><p id="7eaf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个简单的函数，返回所有者的地址。它返回你传递给它的任何东西的地址。但是它实际上什么都不做。这就是它使用<em class="md">视图</em>关键字的原因。它也是<em class="md">公开</em>的，这意味着任何人都可以看。这里没有敏感数据。</p><p id="e289" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">只要想使用这个函数，就可以简单地调用它。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="90de" class="lw lx it ls b gy ly lz l ma mb">owner();</span></pre><p id="1e05" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很简单，对吧？现在，让我们看看事件。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="a68f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">事件看起来很像函数。但是它们非常不同。</p><p id="97a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">事件也接受参数。并将它们存储在事务日志中。请将此视为区块链中的一种特殊数据结构。</p><p id="5f35" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">事件用于通知区块链之外的服务，让用户知道发生了一些事情。他们不存储这些数据。他们开火后就忘记了。事件内部的内容对于智能合约是<em class="md">不</em>可见的。甚至是引发事件的智能合约。</p><p id="206b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可以把它想象成JavaScript中的console.log()。</p><p id="be13" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以作为连接到节点的应用程序订阅事件通知。仅依靠通知来获得有关更改的提醒，而无需自己进行更改。</p><p id="b7b0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们看一个例子。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="0e69" class="lw lx it ls b gy ly lz l ma mb">event Transfer(address indexed _from, address indexed _to, uint256 indexed _tokenId);</span></pre><p id="3b12" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该事件在事务日志中存储3个参数。发件人地址、收件人地址和令牌ID。<em class="md">索引的</em>关键字用于更容易地找到事务日志中的数据。</p><p id="eb4e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当您在智能合约中将ERC721令牌从一个用户转移到另一个用户时，您可以触发此事件。</p><p id="86cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">调用事件就像调用一个函数，有一个很大的不同。事件使用<em class="md">发出</em>关键字。这让开发者知道一个事件被调用，而不是一个函数。否则，很难发现不同之处。</p><p id="aadf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们把刚才写的事件叫做。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="8966" class="lw lx it ls b gy ly lz l ma mb">emit Transfer(_from, _to, _tokenId)</span></pre><p id="141e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="md"> emit </em>关键字是2017年的必要更新。</p><p id="180e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当一名黑客成功从一个分散自治组织(DAO)窃取了360万以太币时，以太币的价格下跌。这一切都源于这个特定智能契约中事件和函数之间的混淆。</p><p id="4043" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">混乱导致了<a class="ae lq" href="https://www.investopedia.com/terms/h/hard-fork.asp#:~:text=What%20Is%20a%20Hard%20Fork,version%20of%20the%20protocol%20software." rel="noopener ugc nofollow" target="_blank">硬分叉</a>并催生了<a class="ae lq" href="https://ethereumclassic.org/" rel="noopener ugc nofollow" target="_blank">以太坊经典</a>以及以太坊。</p><p id="e0fc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在Github上的<a class="ae lq" href="https://github.com/ethereum/solidity/issues/2877" rel="noopener ugc nofollow" target="_blank">这一期</a>中找到介绍<em class="md"> emit </em>的提议。</p><p id="e876" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了这次更新，就不太可能有人再犯同样的错误了。</p></div></div>    
</body>
</html>