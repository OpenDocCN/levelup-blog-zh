<html>
<head>
<title>Building Chat App Using Firebase; Cross-Platform With Android App (NativeScript) + Web app (NuxtJs)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Firebase构建聊天应用程序；Android应用(NativeScript) + Web应用(NuxtJs)的跨平台</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-chat-app-using-firebase-cross-platform-with-mobile-app-nativescript-web-app-nuxtjs-44b5984e7b7a?source=collection_archive---------5-----------------------#2020-07-19">https://levelup.gitconnected.com/building-chat-app-using-firebase-cross-platform-with-mobile-app-nativescript-web-app-nuxtjs-44b5984e7b7a?source=collection_archive---------5-----------------------#2020-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/0d1d81cf28f43f9fae8c671575bdd56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*GcIH7fAxXaboIz1qwtvW7g.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">NuxtJS、NativeScript和Firebase一起开发非常容易。</figcaption></figure><div class=""/><p id="4dc6" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">作为一名开发人员，我总是不断地自学新东西来提高我的编码技能。所以跟着做，你会发现你可以用NuxtJs和NativeScript构建一个跨平台的聊天应用。</p><h1 id="a4f4" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">要领</strong></h1><ul class=""><li id="44b8" class="lx ly je kd b ke lz ki ma km mb kq mc ku md ky me mf mg mh bi translated"><a class="ae mi" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">已安装节点</a></li><li id="e917" class="lx ly je kd b ke mj ki mk km ml kq mm ku mn ky me mf mg mh bi translated"><a class="ae mi" href="https://nativescript-vue.org" rel="noopener ugc nofollow" target="_blank">原生脚本</a></li><li id="2318" class="lx ly je kd b ke mj ki mk km ml kq mm ku mn ky me mf mg mh bi translated"><a class="ae mi" href="https://nuxtjs.org/" rel="noopener ugc nofollow" target="_blank"> NuxtJs </a></li><li id="7ccd" class="lx ly je kd b ke mj ki mk km ml kq mm ku mn ky me mf mg mh bi translated"><a class="ae mi" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank">燃烧基地</a></li></ul><h1 id="d016" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">设置Firebase</h1><p id="1d28" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">Firebase是Google的移动应用开发平台，可以帮助您构建、改进和发展您的应用。</p><h2 id="fbf5" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">创建Firebase项目</h2><p id="795d" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">前往<a class="ae mi" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank">https://console.firebase.google.com/</a>创建一个项目。</p><h2 id="10d8" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">创建Firebase数据库</h2><p id="e5e0" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">转到左侧导航的“数据库”,创建一个“云Firestore”。确保创建数据库是“测试模式”，因为它将允许您在没有任何规则的情况下读取和写入数据库。</p><h1 id="d949" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">初始化NativeScript</h1><p id="9946" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">在您的终端中，无论您想在哪里创建这个项目，请执行以下操作:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="0dda" class="mr la je ni b gy nm nn l no np">vue init nativescript-vue/vue-cli-template firebase-chat</span></pre><p id="8336" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它会问你一些问题(名字，描述，编程语言，vuex等。)，当回答时，项目被创建:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="c775" class="mr la je ni b gy nm nn l no np">cd firebase-chat<br/>npm install</span></pre><p id="bc88" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这一步是导航到项目文件夹并安装所有依赖项以启动项目。</p><p id="ef0c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，您已经准备好使用NativeScript开发跨平台移动应用程序了。</p><p id="14cd" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，您必须安装Firebase插件:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="9310" class="mr la je ni b gy nm nn l no np">tns plugin add nativescript-plugin-firebase</span></pre><p id="8368" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该插件旨在为Firebase实例提供一个通用接口，可以方便地与NativeScript一起使用。安装这些插件时，它会问一些问题，一些问题必须回答是(y)，包括:</p><ul class=""><li id="7cc0" class="lx ly je kd b ke kf ki kj km nq kq nr ku ns ky me mf mg mh bi translated">你用的是安卓吗</li><li id="1dbc" class="lx ly je kd b ke mj ki mk km ml kq mm ku mn ky me mf mg mh bi translated">你在用Firestore吗？</li><li id="e44f" class="lx ly je kd b ke mj ki mk km ml kq mm ku mn ky me mf mg mh bi translated">你在使用实时数据库吗？</li></ul><p id="af91" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您选择“是”( y ),将在安装后生成Firebase配置JSON。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="7527" class="mr la je ni b gy nm nn l no np">Do you want to save the selected configuration. Reinstalling the dependency will reuse the setup from: firebase.nativescript.json. CI will be easier.</span></pre><figure class="nd ne nf ng gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="715f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，您需要在<code class="fe nv nw nx ni b">App_Resources/app.gradle</code>中配置<code class="fe nv nw nx ni b">multiDexEnable true</code>来避免这个错误:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="dab9" class="mr la je ni b gy nm nn l no np">Error: null, Cannot fit requested classes in a single dex file (# methods: 103413 &gt; 65536).</span></pre><figure class="nd ne nf ng gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="3241" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">将Firebase添加到Android应用程序</h2><p id="cac1" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">进入“项目设置”以添加“Android”应用程序并下载“google-services.json”</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi ny"><img src="../Images/b6fb0f4f9a1a7a11c65588fa9bdef5eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ufalneyMfivCgz_y8esnKA.png"/></div></div></figure><p id="33b2" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">确保捆绑包id或包名与您在<code class="fe nv nw nx ni b">package.json</code>中的<code class="fe nv nw nx ni b">nativescript.id</code>相同，这样您就可以下载了。</p><h2 id="25e8" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">将Firebase连接到您的Android应用程序</h2><p id="36ab" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">在<code class="fe nv nw nx ni b">app/App_Resources/Android/google-services.json</code>将<code class="fe nv nw nx ni b">google-services.json</code>添加到您的NativeScript项目中</p><h2 id="ca83" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">构建应用程序</h2><p id="e468" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">在这个项目中，我们将只使用<strong class="kd jf"> App.vue </strong>组件。我们不会创建任何其他组件。打开<strong class="kd jf"> App.vue </strong>，写下下面的代码。</p><figure class="nd ne nf ng gt iv"><div class="bz fp l di"><div class="nt nu l"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">App.vue</figcaption></figure><p id="5098" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该方法从Firebase获取数据:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="1e0a" class="mr la je ni b gy nm nn l no np">...<br/>fetchMessages() {                             <br/>  let vm = this;                             <br/>  firebase                               <br/>    .firestore()                               <br/>    .collection("chat")                               <br/>    .orderBy("createAt")                               <br/>    .onSnapshot(querySnapshot =&gt; {                                 <br/>      const allMessages = [];                                 <br/>      querySnapshot.forEach(doc =&gt; {                                   <br/>        allMessages.push(doc.data());                                 <br/>      });                                 <br/>      vm.messages = allMessages;                               <br/>    });                           <br/>},</span></pre><p id="2320" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此方法向Firebase发送消息:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="05b4" class="mr la je ni b gy nm nn l no np">...<br/>saveMessage() {                             <br/>  const vm = this;                             <br/>  if (this.message) {                               <br/>  firebase                                 <br/>    .firestore()                                 <br/>    .collection("chat")                                 <br/>    .add({                                   <br/>      message: this.message,                                   <br/>      createAt: new Date(),                                   <br/>      from: this.username                                 <br/>    })                                 <br/>    .then(function(docRef) {                                                                                     <br/>      vm.message = null;                                 <br/>    })                                 <br/>    .catch(function(error) {                                              <br/>      console.error("Error adding document: ", error);                                    <br/>    });                             <br/>  }                           <br/>},</span></pre><h1 id="88f7" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">初始化NuxtJS</h1><p id="a53f" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">在您的终端中，无论您想在哪里创建这个项目，请执行以下操作:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="5397" class="mr la je ni b gy nm nn l no np">npx create-nuxt-app firebase-chat</span></pre><p id="562b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它会问你一些问题(名字，Nuxt选项，UI框架，TypeScript，linter，测试框架等。)，我对这个项目的UI框架选择Vuetify。回答后，它将安装所有的依赖项，因此下一步是导航到项目文件夹并使用以下命令启动它:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="b294" class="mr la je ni b gy nm nn l no np">cd firebase-chat<br/>npm run dev</span></pre><p id="0541" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你已经准备好让一些事情发生了！</p><h2 id="8f56" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">将Firebase连接到您的Web应用程序</h2><p id="bba8" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">转到“项目设置”并添加Web应用程序。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi ny"><img src="../Images/5a68a0d72f565d6511884614a19f8faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*44y2l2u26nykyZTZQOeMsw.png"/></div></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">项目设置中的应用程序</figcaption></figure><h2 id="5e7a" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">安装Firebase插件</h2><p id="0a3f" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">安装此软件包支持web(浏览器)、mobile-web和server (Node.js)客户端，其中包含可以在Firebase浏览器中运行的代码。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="13a8" class="mr la je ni b gy nm nn l no np">npm install firebase --save</span></pre><p id="9b4e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe nv nw nx ni b">/plugins</code>中创建新文件<code class="fe nv nw nx ni b">firebase.js</code>并从CDN中复制firebaseConfig。</p><figure class="nd ne nf ng gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="7de6" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">安装过滤器插件</h2><p id="b401" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">一个轻量级的JavaScript日期库，用于解析、验证、操作和格式化日期。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="6120" class="mr la je ni b gy nm nn l no np">npm install moment moment-timezone --save</span></pre><p id="4e4f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我创建了这个格式化日期的插件，它可以重复使用并缩短处理日期时间的代码。</p><figure class="nd ne nf ng gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="dcc0" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">配置插件</h2><p id="7b49" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">转到nuxt.config.js，将以下代码添加到插件中:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="b86e" class="mr la je ni b gy nm nn l no np">plugins: ['~/plugins/firebase.js', '~/plugins/filter.js'],</span></pre><figure class="nd ne nf ng gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="eebc" class="mr la je bd lb ms mt dn lf mu mv dp lj km mw mx ln kq my mz lr ku na nb lv nc bi translated">构建应用程序</h2><p id="a0dd" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">在这个项目中，我们将只在<code class="fe nv nw nx ni b">/pages</code>使用<strong class="kd jf"> index.vue </strong>。我们不会创建任何其他组件。打开<strong class="kd jf"> index.vue </strong>，写下下面的代码。</p><figure class="nd ne nf ng gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="4c39" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该方法从Firebase获取数据:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="9a3e" class="mr la je ni b gy nm nn l no np">...<br/>fetchMessages() {<br/>  const vm = this<br/>  db.collection('chat')<br/>  .orderBy('createAt')<br/>  .onSnapshot((querySnapshot) =&gt; {<br/>    const allMessages = []<br/>    querySnapshot.forEach((doc) =&gt; {<br/>      allMessages.push(doc.data())<br/>    })<br/>    vm.messages = allMessages<br/>  })<br/>},</span></pre><p id="04ec" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此方法向Firebase发送消息:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="331a" class="mr la je ni b gy nm nn l no np">...<br/>saveMessage() {<br/>  const vm = this<br/>  if (this.message.trim()) {<br/>    db.collection('chat')<br/>    .add({<br/>      message: this.message,<br/>      createAt: new Date(),<br/>      username: this.username,<br/>    })<br/>    .then(function (docRef) {<br/>      vm.message = null<br/>    })<br/>    .catch(function (error) {<br/>      // eslint-disable-next-line no-console<br/>      console.error('Error adding document: ', error)<br/>    })<br/>  }<br/>},</span></pre><p id="f270" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就这样，你们都完成了。嗯，这是草稿，所以它是相当多余的，你可以在你自己的时间更新风格或任何逻辑。但是现在我们成功地使用NativeScript(移动)+ Nuxtjs (web)和Firebase创建了跨平台聊天应用。我爱上了Vue，现在我要开始在我的项目中实现firebase。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi ny"><img src="../Images/d6dc28ec6853e106a6e73a38d03f6edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ClmbCXDNGphHOo1Z.gif"/></div></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">演示</figcaption></figure><p id="9857" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以在这里查看我的代码:</p><div class="is it gp gr iu od"><a href="https://github.com/bachhm-dev/nuxtjs-chat" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jf gy z fp oi fr fs oj fu fw jd bi translated">bachm-dev/nuxtjs-chat</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="on l oo op oq om or iw od"/></div></div></a></div><div class="is it gp gr iu od"><a href="https://github.com/bachhm-dev/nativescript-chat" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jf gy z fp oi fr fs oj fu fw jd bi translated">bachm-dev/native script-chat</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">在GitHub上创建一个帐户，为bachhm-dev/nativescript-chat开发做出贡献。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="os l oo op oq om or iw od"/></div></div></a></div><p id="6eaf" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢您的阅读，我希望这有助于您进一步了解Vue、Nuxtjs、NativeScript和Firebase。</p></div></div>    
</body>
</html>