<html>
<head>
<title>How To Create a Shared JavaScript Class for Node.js and Browsers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为Node.js和浏览器创建一个共享的JavaScript类</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-create-a-shared-javascript-class-for-node-js-and-browsers-b870aeff303d?source=collection_archive---------9-----------------------#2022-11-20">https://levelup.gitconnected.com/how-to-create-a-shared-javascript-class-for-node-js-and-browsers-b870aeff303d?source=collection_archive---------9-----------------------#2022-11-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cc97" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用ES6模块在前端和后端之间共享代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9e208e969d58043fd555b1c341cd9cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wYPCzdxfAKcW_F7w"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ferenc Almasi </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="3d69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自从几年前我开始在一些后端应用程序中使用Node.js以来，我一直在努力在节点和浏览器环境之间共享代码。使代码适应任一环境所需的更改非常小，这经常导致我拥有同一个文件的两个几乎相同的版本的情况。</p><p id="6445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几周前，我正在计划一个新项目，如果没有Node和浏览器之间的代码共享，这几乎是不可能的。因此，我决定再次调查，我终于能够找到一个解决这个问题的好办法。</p><h1 id="3515" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">共享的JavaScript类</h1><p id="4dd0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">让我们从创建一个非常简单的共享类开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="918e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该类看起来与可以在节点环境或浏览器中使用的普通JavaScript类非常相似。唯一重要的细节是定义前面的关键字<code class="fe mu mv mw mx b">export</code>。创建JavaScript类时，也可以使用较新的<code class="fe mu mv mw mx b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes" rel="noopener ugc nofollow" target="_blank">class</a></code>语法，但我习惯使用原型。</p><h1 id="fe4b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用Node.js中的类</h1><p id="8097" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在让我们看看如何在节点环境中使用共享类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1cb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，这看起来像普通的Node.js代码。导入类，创建一个对象，并调用<code class="fe mu mv mw mx b">print()</code>函数。</p><p id="18ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里值得注意的一点是<code class="fe mu mv mw mx b">SharedClass.mjs</code>和<code class="fe mu mv mw mx b">SharedClassNode.mjs</code>文件的<code class="fe mu mv mw mx b">.mjs</code>扩展名。这表明文件是ES6模块。如果您不想将文件命名为<code class="fe mu mv mw mx b">.mjs</code>，您也可以将<code class="fe mu mv mw mx b">“type”: “module”</code>添加到您的<code class="fe mu mv mw mx b">package.json</code>文件中。</p><h1 id="bce3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在浏览器中使用类</h1><p id="ad53" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在浏览器JavaScript中使用我们的共享类也很简单，我们只需要担心一个细节。当导入JavaScript文件时，我们需要将<code class="fe mu mv mw mx b">type=”module”</code>添加到脚本标签中，以便导入和导出语句在浏览器中可用。然而，这伴随着一些警告。当我们想要使用共享类时，我们只能在其他<code class="fe mu mv mw mx b">type=”module”</code>脚本中这样做，并且我们需要像在节点环境中那样显式地导入它。另外，<code class="fe mu mv mw mx b">type=”module”</code>脚本中的代码有自己的作用域，它不会被添加到全局作用域中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="2d3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着JavaScript在前端和后端开发中越来越受欢迎，能够在不同环境之间共享代码变得非常重要。在这个问题上挣扎了很多年后，我终于深入研究了一下，并找到了一个好的解决办法。我还没有在一个更大的项目中使用它，但我相信它将消除对同一个文件的多个版本的需要，并在未来使事情变得容易得多。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="0333" class="lv lw it bd lx ly nf ma mb mc ng me mf jz nh ka mh kc ni kd mj kf nj kg ml mm bi translated">资源</h1><ul class=""><li id="da3f" class="nk nl it lb b lc mn lf mo li nm lm nn lq no lu np nq nr ns bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules" rel="noopener ugc nofollow" target="_blank"> JavaScript模块</a></li></ul></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="f8a9" class="lv lw it bd lx ly nf ma mb mc ng me mf jz nh ka mh kc ni kd mj kf nj kg ml mm bi translated">分级编码</h1><p id="70ee" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="2f9d" class="nk nl it lb b lc ld lf lg li nt lm nu lq nv lu np nq nr ns bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="1ce4" class="nk nl it lb b lc nw lf nx li ny lm nz lq oa lu np nq nr ns bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="b7f3" class="nk nl it lb b lc nw lf nx li ny lm nz lq oa lu np nq nr ns bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="2fe8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>