<html>
<head>
<title>Javascript Design Patterns</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript设计模式</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-design-patterns-aa4adb7b85e6?source=collection_archive---------0-----------------------#2022-11-17">https://levelup.gitconnected.com/javascript-design-patterns-aa4adb7b85e6?source=collection_archive---------0-----------------------#2022-11-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b891" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单例模式|工厂模式|构造器模式</p><h2 id="79b7" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">主题</h2><ul class=""><li id="93d8" class="le lf iq jp b jq lg ju lh jy li kc lj kg lk kk ll lm ln lo bi translated">单一模式</li><li id="bcfa" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">工厂模式</li><li id="3cae" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">工厂模式与构造器模式</li></ul></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="9efd" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">单一模式(使用Redux或React上下文)</h2><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/f4ba15989b9e32ee24d2e6d99e31f2cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKEwI_zU33dt0sNk_HMHog.png"/></div></div></figure><ul class=""><li id="bd82" class="le lf iq jp b jq jr ju jv jy mn kc mo kg mp kk ll lm ln lo bi translated">单例设计模式公开了可以被多个组件使用的单个实例</li><li id="967b" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated"><strong class="jp ir">单例模式</strong>可以被认为是全局状态管理库的基础，如<strong class="jp ir"> Redux或React Context </strong>。</li><li id="b611" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">这是一种限制类只能创建一个实例的模式。</li><li id="2b0c" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">它们可以被全局访问，并作为访问全局状态的单一访问点。</li></ul><pre class="mc md me mf gt mq mr ms bn mt mu bi"><span id="efc4" class="mv km iq mr b be mw mx l my mz">let instance;<br/>let globalState = {<br/>  color: ""<br/>};<br/><br/>class StateUtility {<br/>  constructor() {<br/>    if (instance) {<br/>      throw new Error("New instance cannot be created!!");<br/>    }<br/>    instance = this;<br/>  }<br/>  getPropertyByName(propertyName) {<br/>    return globalState[propertyName];<br/>  }<br/>  setPropertyValue(propertyName, propertyValue) {<br/>    globalState[propertyName] = propertyValue;<br/>  }<br/>}<br/>let stateUtilityInstance = Object.freeze(new StateUtility());<br/>export default stateUtilityInstance;</span></pre><ul class=""><li id="724c" class="le lf iq jp b jq jr ju jv jy mn kc mo kg mp kk ll lm ln lo bi translated">我们确保不暴露<code class="fe na nb nc mr b">globalState</code>。我们使用<code class="fe na nb nc mr b">StateUtility</code>的类方法来公开它们。这样，我们保护全局状态不被直接改变。</li><li id="9e66" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">最后，我们创建类的实例如下:<code class="fe na nb nc mr b">let stateUtilityInstance = Object.freeze(new StateUtility());</code>。</li><li id="9ab5" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">我们已经使用了<code class="fe na nb nc mr b">Object.freeze</code>，所以没有其他类/组件/模块能够修改暴露的<code class="fe na nb nc mr b">stateUtilityInstance</code>。</li></ul></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="7551" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">工厂模式(工厂模式vs构造函数)—</h2><ul class=""><li id="2397" class="le lf iq jp b jq lg ju lh jy li kc lj kg lk kk ll lm ln lo bi translated">工厂是用于创建对象的函数式编程范例中的对象或类或函数。</li><li id="c1e8" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated"><strong class="jp ir"> <em class="nd">工厂方法</em>按照客户的指示创建新对象</strong>。在JavaScript中创建对象的一种方法是使用new运算符调用构造函数</li><li id="54fd" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">工厂设计模式用于<strong class="jp ir">当我们有一个包含多个子类的超类时，基于输入，我们需要返回一个子类</strong>。这种模式将类实例化的责任从客户端程序转移到了工厂类。</li><li id="2a67" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">类将责任委托给几个助手子类中的一个，并且您想要本地化哪个助手子类是委托的知识</li><li id="daf7" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">工厂方法经常用于管理、维护或操作不同但同时具有许多共同特征(即方法和属性)的对象集合的应用程序中。</li><li id="6fe1" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">工厂模式可以在内部使用构造函数或类，但是在对象创建过程依赖于动态因素的情况下——比如当我们想要动态创建子类时——工厂模式是首选。</li><li id="db33" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">Factory给了我们一个既灵活又可重用的对象创建机制。</li></ul><pre class="mc md me mf gt mq mr ms bn mt mu bi"><span id="dfe0" class="mv km iq mr b be mw mx l my mz">// creates factory function<br/>function vehicleFactory (manufacturer, plateNO) {<br/>    return  {<br/>        manufacturer,<br/>        plateNO,<br/>        startEngine () {<br/>            console.log("reving engine")<br/>        },<br/>        drive () {<br/>            console.log("driving car...")<br/>        }<br/>    }<br/>}<br/> <br/>const Vehicle1 = vehicleFactory("Toyota", 12345);<br/>console.log(Vehicle1) <br/>// prints <br/>//{<br/>//  manufacturer: 'Toyota',<br/>//  plateNO: 12345,<br/>//  startEngine: [Function: startEngine],<br/>//  drive: [Function: drive]<br/>//}<br/>  <br/>const Vehicle2 = vehicleFactory("Ford", 13345);<br/>console.log(Vehicle2) <br/>// prints <br/>// {<br/>//  manufacturer: 'Ford',<br/>//  plateNO: 13345,<br/>//  startEngine: [Function: startEngine],<br/>//  drive: [Function: drive]<br/>// }</span></pre><p id="9e52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例子，</p><ul class=""><li id="a3b8" class="le lf iq jp b jq jr ju jv jy mn kc mo kg mp kk ll lm ln lo bi translated">工厂模式通过重用<code class="fe na nb nc mr b">StartEngine</code>、<code class="fe na nb nc mr b">driveVehicle</code>和<code class="fe na nb nc mr b">stopEngine</code>方法来提高代码的可重用性。</li></ul><pre class="mc md me mf gt mq mr ms bn mt mu bi"><span id="2ce5" class="mv km iq mr b be mw mx l my mz">class Car {<br/>    constructor(options) {<br/>        this.wheels = options.wheels || 4;<br/>        this.doors = options.doors || 4;<br/>        this.color = options.color || "silver"; <br/>    }<br/>}<br/><br/>class Truck {<br/>    constructor(options) {<br/>        this.wheels = options.wheels || 6;<br/>        this.doors = options.doors || 2;<br/>        this.color = options.color || "red"; <br/>    }<br/>}<br/><br/><br/>class Factory {<br/><br/>    create = (options, vehicleType) =&gt; {<br/><br/>        if(!vehicleType) {<br/>            return "unable to make vehicle. Please specify a vehicle type and tryagain!"<br/>        }<br/><br/>        let vehicle;<br/>        <br/>        if (vehicleType === "car") {<br/>            vehicle = new Car(options);<br/>        } else if (vehicleType === "truck") {<br/>            vehicle = new Truck(options);<br/>        } <br/><br/>  <br/>        vehicle.vehicleType = vehicleType;<br/><br/>        vehicle.startEngine = ()=&gt; console.log(`Reving ${vehicleType} engine`);<br/><br/>        vehicle.driveVehicle = ()=&gt; console.log(`Driving ${vehicleType}...`);<br/><br/>        vehicle.stopEngine = ()=&gt; console.log(`Stop ${vehicleType} engine`);<br/><br/>        return vehicle;<br/>    }<br/> <br/>};<br/><br/>const vehicleFactory = new Factory();<br/><br/>const car = vehicleFactory.create({<br/>    wheels: 4,<br/>    doors: 2,<br/>    color: "black",<br/>}, "car");<br/><br/>console.log(car)<br/>console.log(car.startEngine())<br/>console.log(car.driveVehicle())<br/><br/>// prints:<br/>//Car {<br/>//  wheels: 4,<br/>//  doors: 4,<br/>//  color: 'silver',<br/>//  vehicleType: 'car',<br/>//  startEngine: [Function],<br/>//  driveVehicle: [Function],<br/>//  stopEngine: [Function]<br/>//}<br/><br/>// Reving car engine<br/>// Driving car...<br/><br/>const truck = vehicleFactory.create({<br/>    wheels: 4,<br/> doors: 2,<br/> color: "yellow",<br/>}, "truck")<br/><br/>console.log(truck)<br/>console.log(truck.startEngine())<br/>console.log(truck.stopEngine())<br/>// prints<br/>//Truck {<br/>//  wheels: 4,<br/>//  doors: 2,<br/>//  color: 'yellow',<br/>//  vehicleType: 'truck',<br/>//  startEngine: [Function],<br/>//  driveVehicle: [Function],<br/>//  stopEngine: [Function]<br/>//}<br/><br/>// Reving truck engine<br/>// Stop truck engine</span></pre><ul class=""><li id="a2fb" class="le lf iq jp b jq jr ju jv jy mn kc mo kg mp kk ll lm ln lo bi translated"><strong class="jp ir">通过使用工厂模式，我们的代码也很容易维护</strong>，因此，如果业务扩展，工厂开始生产新类型的车辆，我们可以很容易地控制我们的实现来处理这种情况，如下所示:</li></ul><pre class="mc md me mf gt mq mr ms bn mt mu bi"><span id="028b" class="mv km iq mr b be mw mx l my mz">class Car {<br/>    constructor(options) {<br/>        this.wheels = options.wheels || 4;<br/>        this.doors = options.doors || 4;<br/>        this.color = options.color || "silver"; <br/>    }<br/>}<br/><br/>class Truck {<br/>    constructor(options) {<br/>        this.wheels = options.wheels || 6;<br/>        this.doors = options.doors || 2;<br/>        this.color = options.color || "red"; <br/>    }<br/>}<br/><br/>class Bus {<br/>    constructor(options) {<br/>        this.wheels = options.wheels || 4;<br/>        this.doors = options.doors || 4;<br/>        this.color = options.color || "white"; <br/>    }<br/>}<br/><br/>class Motorcycle {<br/>    constructor(options) {<br/>        this.wheels = options.wheels || 2;<br/>        this.doors = options.doors || 0;<br/>        this.color = options.color || "Black"; <br/>    }<br/>}<br/><br/><br/>class Factory {<br/><br/>    create = (options, vehicleType) =&gt; {<br/><br/>        if(!vehicleType) {<br/>            return "unable to make vehicle. Please specify a vehicle type and tryagain!"<br/>        }<br/><br/>        let vehicle;<br/>        <br/>        if (vehicleType === "car") {<br/>            vehicle = new Car(options);<br/>        } else if (vehicleType === "truck") {<br/>            vehicle = new Truck(options);<br/>        } else if (vehicleType === "bus") {<br/>            vehicle = new Bus(options);<br/>        } else if (vehicleType === "motorcycle") {<br/>            vehicle = new Motocycle(options);<br/>        }<br/><br/>  <br/>        vehicle.vehicleType = vehicleType;<br/><br/>        vehicle.startEngine = ()=&gt; console.log(`Reving ${vehicleType} engine`);<br/><br/>        vehicle.driveVehicle = ()=&gt; console.log(`Driving ${vehicleType}...`);<br/><br/>        vehicle.stopEngine = ()=&gt; console.log(`Stop ${vehicleType} engine`);<br/><br/>        return vehicle;<br/>    }<br/> <br/>};<br/><br/>const vehicleFactory = new Factory();<br/><br/>const bus = vehicleFactory.create({<br/>    wheels: 4,<br/>    doors: 4,<br/>    color: "yellow",<br/>}, "bus");<br/><br/>console.log(bus)<br/>console.log(bus.startEngine())<br/>console.log(bus.driveVehicle())<br/><br/>// prints:<br/>// Bus {<br/>//  wheels: 4,<br/>//  doors: 4,<br/>//  color: 'yellow',<br/>//  vehicleType: 'bus',<br/>//  startEngine: [Function],<br/>//  driveVehicle: [Function],<br/>//  stopEngine: [Function]<br/>//}<br/><br/>// Reving bus engine<br/>// Driving bus...<br/><br/>const bike = vehicleFactory.create({<br/>    wheels: 2,<br/> doors: 0,<br/> color: "red",<br/>}, "motorcycle")<br/><br/>console.log(bike)<br/>console.log(bike.startEngine())<br/>console.log(bike.stopEngine())<br/>// prints<br/>// Motorcycle {<br/>//  wheels: 2,<br/>//  doors: 0,<br/>//  color: 'red',<br/>//  vehicleType: 'bike',<br/>//  startEngine: [Function],<br/>//  driveVehicle: [Function],<br/>//  stopEngine: [Function]<br/>//}<br/><br/>// Reving motorcycle engine<br/>// Stop motorcycle engine</span></pre><p id="9f79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多例子，</p><pre class="mc md me mf gt mq mr ms bn mt mu bi"><span id="22c5" class="mv km iq mr b be mw mx l my mz">var Factory = function () {<br/>    this.createEmployee = function (type) {<br/>        var employee;<br/><br/>        if (type === "fulltime") {<br/>            employee = new FullTime();<br/>        } else if (type === "parttime") {<br/>            employee = new PartTime();<br/>        } else if (type === "temporary") {<br/>            employee = new Temporary();<br/>        } else if (type === "contractor") {<br/>            employee = new Contractor();<br/>        }<br/><br/>        employee.type = type;<br/><br/>        employee.say = function () {<br/>            console.log(this.type + ": rate " + this.hourly + "/hour");<br/>        }<br/><br/>        return employee;<br/>    }<br/>}<br/><br/>var FullTime = function () {<br/>    this.hourly = "$12";<br/>};<br/><br/>var PartTime = function () {<br/>    this.hourly = "$11";<br/>};<br/><br/>var Temporary = function () {<br/>    this.hourly = "$10";<br/>};<br/><br/>var Contractor = function () {<br/>    this.hourly = "$15";<br/>};<br/><br/>function run() {<br/><br/>    var employees = [];<br/>    var factory = new Factory();<br/><br/>    employees.push(factory.createEmployee("fulltime"));<br/>    employees.push(factory.createEmployee("parttime"));<br/>    employees.push(factory.createEmployee("temporary"));<br/>    employees.push(factory.createEmployee("contractor"));<br/><br/>    for (var i = 0, len = employees.length; i &lt; len; i++) {<br/>        employees[i].say();<br/>    }<br/>}</span></pre><h1 id="f1bc" class="ne km iq bd kn nf ng nh kq ni nj nk kt nl nm nn kw no np nq kz nr ns nt lc nu bi translated">工厂模式与构造函数</h1><ul class=""><li id="848c" class="le lf iq jp b jq lg ju lh jy li kc lj kg lk kk ll lm ln lo bi translated">构造器模式和工厂模式是相似的，因为<strong class="jp ir">它们是返回新对象的对象创建模式</strong></li><li id="a0fb" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated"><strong class="jp ir">工厂方法可以返回一个已经创建的对象</strong>，不像构造函数总是创建一个新的实例。</li><li id="c754" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">工厂方法提倡先使用接口再使用实现来编码的思想，这样会产生更灵活的代码，但是构造函数会将您的代码绑定到特定的实现上。</li><li id="4701" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated"><strong class="jp ir">使用构造函数的理由:</strong>我们使用构造函数<strong class="jp ir">用默认或初始状态</strong>初始化对象。原语的默认值可能不是您想要的。使用构造函数的另一个原因是它告知依赖关系。</li><li id="ce4b" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated"><strong class="jp ir">使用工厂的理由:</strong>工厂方法模式<strong class="jp ir">允许子类选择要创建的对象类型</strong>。它消除了将特定于应用程序的类绑定到代码中的需要，从而促进了松散耦合。</li></ul><pre class="mc md me mf gt mq mr ms bn mt mu bi"><span id="9219" class="mv km iq mr b be mw mx l my mz">const vehicleOptions = {type: "cars", color: "white", doors: 4, wheels: 4}<br/><br/>// factory pattern<br/>function Factory(options) {<br/>  let factory = {};<br/>  factory.type = options.type;<br/>  factory.color = options.color;<br/>  factory.wheels = options.wheels;<br/>  factory.doors = options.doors;<br/>  <br/>  return factory;<br/>}<br/><br/>const vehicle = Factory(vehicleOptions);<br/><br/>// constructor pattern<br/>function ConstructorPattern(options) {<br/>  this.type = options.type;<br/>  this.color = options.color<br/>  this.doors = options.doors;<br/>  this.wheels = options.wheels;<br/>}<br/><br/>const vehicle2 = new ConstructorPattern(vehicleOptions);<br/><br/>console.log("factory car", vehicle)<br/>// prints { type: 'cars', color: 'white', wheels: 4, doors: 4 }<br/><br/>console.log("constructor car", vehicle2)<br/>// prints { type: 'cars', color: 'white', wheels: 4, doors: 4 }</span></pre><h1 id="9f8c" class="ne km iq bd kn nf ng nh kq ni nj nk kt nl nm nn kw no np nq kz nr ns nt lc nu bi translated">何时使用工厂模式</h1><p id="076e" class="pw-post-body-paragraph jn jo iq jp b jq lg js jt ju lh jw jx jy nv ka kb kc nw ke kf kg nx ki kj kk ij bi translated">工厂模式在应用于以下情况时尤其有用:</p><ul class=""><li id="e6ee" class="le lf iq jp b jq jr ju jv jy mn kc mo kg mp kk ll lm ln lo bi translated">当我们的对象或组件设置涉及高度复杂时。</li><li id="61e1" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">当我们需要根据所处的环境轻松生成不同的对象实例时。</li><li id="9db8" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">当我们处理许多具有相同属性的小对象或组件时。</li><li id="5860" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">当用其他对象的实例组成对象时，只需要满足一个API契约(也称为duck typing)就可以工作。这对解耦很有用。</li></ul></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="665c" class="ne km iq bd kn nf ny nh kq ni nz nk kt nl oa nn kw no ob nq kz nr oc nt lc nu bi translated">感谢阅读</h1><ul class=""><li id="29e5" class="le lf iq jp b jq lg ju lh jy li kc lj kg lk kk ll lm ln lo bi translated">👏请为这个故事鼓掌，然后跟我来👉</li><li id="8151" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">📰查看更多关于<a class="ae od" href="https://sonikamaheshwari067.medium.com/" rel="noopener">编码和系统设计访谈的内容</a></li><li id="15b5" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">🔔关注我:<a class="ae od" href="https://www.linkedin.com/in/sonika-maheshwari-81542220/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>！</li></ul><p id="47f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我知道总会有需要改进的地方。请随意分享你的想法</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="3e2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">🚀👉</strong> <a class="ae od" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">加入升一级的人才集体，找到一份惊人的工作</strong> </a></p></div></div>    
</body>
</html>