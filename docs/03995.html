<html>
<head>
<title>How to Easily Integrate Spreadsheets from Google Sheets, Dropbox and Your Desktop in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中轻松集成来自Google Sheets、Dropbox和你的桌面的电子表格</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-easily-integrate-spreadsheets-from-google-sheets-dropbox-and-your-desktop-in-python-e389eae8b475?source=collection_archive---------25-----------------------#2020-06-04">https://levelup.gitconnected.com/how-to-easily-integrate-spreadsheets-from-google-sheets-dropbox-and-your-desktop-in-python-e389eae8b475?source=collection_archive---------25-----------------------#2020-06-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6de4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">免责声明:这篇文章使用了我们的产品</em> <a class="ae km" href="http://www.apispreadsheets.com" rel="noopener ugc nofollow" target="_blank"> <em class="kl"> API电子表格</em> </a> <em class="kl">，我们相信这是最简单的方法。你可以自己去看看。</em></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/c042c1383f4eec8729cd69e3a5c1c150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lfcJVt3esgKnIm_hrHun4Q.png"/></div></div></figure><p id="4996" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你从事数据科学或分析项目时，通常到处都存储着大量的电子表格。</p><p id="119f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你和我们一样，你可能会这样做:</p><ol class=""><li id="aa45" class="kz la iq jp b jq jr ju jv jy lb kc lc kg ld kk le lf lg lh bi translated">下载你的谷歌工作表作为电子表格</li><li id="51f0" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk le lf lg lh bi translated">下载你的Dropbox电子表格</li><li id="1267" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk le lf lg lh bi translated">把它们和你的桌面文件放在同一个文件夹里</li><li id="c411" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk le lf lg lh bi translated">使用熊猫读取所有文件</li></ol><p id="95cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个不错的工作流程。但是营销部门的史蒂夫改变了谷歌表单中的一些数据。</p><p id="7e02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“不要担心”，您在重新下载表单并重新运行工作流程时回复。</p><p id="9540" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，人力资源部的卡玛拉又给Dropbox添加了两个电子表格。</p><p id="2915" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“我明白了”，你一边慢慢冷静一边说。</p><p id="5a20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后你的老板告诉你把你所有的电子表格用电子邮件发给她，这样她就可以对你的数据进行三次检查。“哦，顺便说一句”，她说，“不要忘了使用我们副总裁力推的样式来更改所有电子表格的名称”</p><p id="2116" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你正式失去理智了。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ln"><img src="../Images/26136ea06b1968af3284ce6510644985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IT5b_TkkAX_Mxr_A"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">心智正式丧失</figcaption></figure><h1 id="0b78" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">更简单的方法</h1><p id="3765" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">我们将向您展示如何使用<a class="ae km" href="http://apispreadsheets.com" rel="noopener ugc nofollow" target="_blank"> API电子表格</a>和Python轻松地将所有这些来源的数据整合在一起。并保持更新和同步。这样你就能保持冷静和快乐！</p><p id="1d8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用1个谷歌表，1个本地文件和1个Dropbox文件。每个文件将包含来自一个唯一美国州的Covid数据:TX、NJ或CA。数据将按县在每行上分解，如下所示:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/ebe3d04293cd1186d36b28cd17e7fdae.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*Jz1NgwBN7I9Nu8n_mLbjrg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">来自NJ文件的样本数据。每个文件中的标题都是相同的</figcaption></figure><p id="2749" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们开始吧！</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="21f1" class="ls lt iq bd lu lv nd lx ly lz ne mb mc md nf mf mg mh ng mj mk ml nh mn mo mp bi translated"><strong class="ak">步骤0:创建一个空的Python文件</strong></h1><p id="a381" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">创建一个名为<strong class="jp ir">spread sheet _ integration . py</strong>的空Python文件，并将其保存在某个地方。</p><p id="0cff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该文件的最终代码如下。我们将在这篇文章中介绍如何到达那里。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">最终文件代码</figcaption></figure><h1 id="ec1a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">步骤1:创建一个API电子表格免费帐户</h1><p id="02d0" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">前往<a class="ae km" href="http://www.apispreadsheets.com" rel="noopener ugc nofollow" target="_blank">www.apispreadsheets.com</a>点击注册创建一个免费账户</p><h1 id="5a05" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">第二步:连接到你的谷歌表单</h1><p id="27a4" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">点击谷歌表单上传框</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nk"><img src="../Images/99145265b3c6966a9cf2e9808a6fc973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6EYBC-_itny-QluN.png"/></div></div></figure><p id="f794" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择您想要连接的Google表单</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/18e9df6d8368bb3099ea7ea51ac3fd58.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*wqzpDTHCh3Ds59aq5WOAzg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">选择要连接的文件</figcaption></figure><p id="5fa2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从读取选项卡中复制Python代码，并将其粘贴到Python文件中</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nm"><img src="../Images/f186078f20884efc52f0836fc343d4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9vcTBQ6Nh4lvnWbhiWfUMw.png"/></div></div></figure><p id="a2ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您的Python文件现在将包含以下代码</p><pre class="ko kp kq kr gt nn no np nq aw nr bi"><span id="753d" class="ns lt iq no b gy nt nu l nv nw">import requests</span><span id="08ee" class="ns lt iq no b gy nx nu l nv nw">r = requests.get("<a class="ae km" href="https://api.apispreadsheets.com/data/581/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/581/</a>")</span><span id="a37b" class="ns lt iq no b gy nx nu l nv nw">if r.status_code == 200:<br/>    # SUCCESS <br/>    data = r.json()<br/>else:<br/>    # ERROR<br/>    data=None</span></pre><p id="31d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在要改变代码中的两件事，使数据更容易处理</p><ol class=""><li id="dbc2" class="kz la iq jp b jq jr ju jv jy lb kc lc kg ld kk le lf lg lh bi translated">我们将从r.json()对象的数据键中访问数据</li><li id="f1e6" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk le lf lg lh bi translated">我们将导入熊猫并将数据转换成熊猫数据框架</li></ol><p id="62d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的代码现在将如下所示</p><pre class="ko kp kq kr gt nn no np nq aw nr bi"><span id="dcc7" class="ns lt iq no b gy nt nu l nv nw">import requests<br/>import pandas as pd</span><span id="0110" class="ns lt iq no b gy nx nu l nv nw">r = requests.get("<a class="ae km" href="https://api.apispreadsheets.com/data/581/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/581/</a>")</span><span id="1735" class="ns lt iq no b gy nx nu l nv nw">if r.status_code == 200:<br/>    data = pd.DataFrame(r.json()["data"])<br/>else:<br/>    data = None</span></pre><blockquote class="ny nz oa"><p id="3d44" class="jn jo kl jp b jq jr js jt ju jv jw jx ob jz ka kb oc kd ke kf od kh ki kj kk ij bi translated">这篇文章中的所有API链接都是公开的，所以可以随意使用它来测试！</p></blockquote><h1 id="41ad" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">步骤3:连接到你的Dropbox文件</h1><p id="8405" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">点击Dropbox上传框。第一次点击会要求您进行身份验证，或者如果您的帐户已经在标签中打开，它会刷新页面。这是Dropbox身份验证的预期行为。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nk"><img src="../Images/a376abba65cf99f8fcc89480a5494284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Quc5r_eKRTgmIq8F.png"/></div></div></figure><p id="6a52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在再次点击Dropbox上传框，你会看到一个文件选择器。选择您的文件。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi oe"><img src="../Images/4460a845398f9586d5887447d2edbdd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCJtKc3QT3FUTAWsK8ekNQ.png"/></div></div></figure><p id="db05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按照与上面相同的步骤在文件中复制Python代码。</p><p id="36d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，我们现在将更改请求和数据的名称，以便于识别</p><pre class="ko kp kq kr gt nn no np nq aw nr bi"><span id="cfc2" class="ns lt iq no b gy nt nu l nv nw">import requests<br/>import pandas as pd</span><span id="820d" class="ns lt iq no b gy nx nu l nv nw">google_sheet_request = requests.get("<a class="ae km" href="https://api.apispreadsheets.com/data/581/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/581/</a>")</span><span id="1657" class="ns lt iq no b gy nx nu l nv nw">dropbox_request = requests.get("<a class="ae km" href="https://api.apispreadsheets.com/data/582/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/582/</a>")</span><span id="0b4b" class="ns lt iq no b gy nx nu l nv nw">if google_sheet_request.status_code == 200:<br/>    google_sheet_data = pd.DataFrame(google_sheet_request.json()["data"])<br/>else:<br/>    google_sheet_data = None</span><span id="03f5" class="ns lt iq no b gy nx nu l nv nw">if dropbox_request.status_code == 200:<br/>    dropbox_data = pd.DataFrame(dropbox_request.json()["data"])<br/>else:<br/>    dropbox_data = None</span></pre><h1 id="9a99" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated"><strong class="ak">第四步:从你的桌面上传文件</strong></h1><p id="4f29" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">现在，我们将从您的桌面上传文件。</p><p id="965b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们不会让你厌烦这个过程。只需点击<strong class="jp ir">上传或删除文件</strong>框，上传您的文件。</p><p id="80ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按照与上面相同的步骤获取python代码，并将其插入到Python文件中。然后更改变量名，这样就有意义了。</p><p id="dc2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将引导我们找到最终的代码</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">原谅local_data上的缩进</figcaption></figure><h1 id="acec" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">第五步:用你的数据做点什么</h1><p id="f7b2" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">就是这样！这就是集成各种来源的电子表格数据有多容易。</p><p id="27e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最棒的是，如果底层的Google Sheet或Dropbox文件数据发生变化，那么你的数据会自动更新。</p><p id="c83f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想和别人分享你的数据，你只需要给他们发送API链接。</p><p id="60c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">祝您整合之旅好运，如果您遇到任何麻烦或有任何问题，请随时在info@lovespreadsheets.com给我们留言。</p><p id="cb9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想要一个定制的应用程序，清理数据，或者使用电子表格建立一个项目，你可以在这里查看我们的咨询服务:【https://www.lovespreadsheets.com<a class="ae km" href="https://www.lovespreadsheets.com/" rel="noopener ugc nofollow" target="_blank"/>！</p></div></div>    
</body>
</html>