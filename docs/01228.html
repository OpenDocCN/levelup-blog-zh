<html>
<head>
<title>React-Redux Hooks: useSelector and useDispatch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React-Redux挂钩:useSelector和useDispatch</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-redux-hooks-useselector-and-usedispatch-f7d8c7f75cdd?source=collection_archive---------0-----------------------#2019-12-02">https://levelup.gitconnected.com/react-redux-hooks-useselector-and-usedispatch-f7d8c7f75cdd?source=collection_archive---------0-----------------------#2019-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="11b3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Redux和React挂钩来清理代码的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9d833ea2e922449aa699a15ab111bebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2QXFv38dyGxpx5eK.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">反应还原</figcaption></figure></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="2275" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">React Redux提供了一组钩子作为现有的<code class="fe ly lz ma mb b">connect()</code> <strong class="le ir"> </strong>高阶组件的替代。这些钩子允许您连接到Redux store并分派动作，而不必将组件包装在<code class="fe ly lz ma mb b">connect()</code>中。</p><p id="e0ca" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">本指南将介绍如何在您的应用程序中实现React-Redux挂钩<code class="fe ly lz ma mb b">useSelector</code>和<code class="fe ly lz ma mb b">useDispatch</code>。</p><h1 id="f5b8" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">入门指南</h1><p id="5136" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">首先在您的应用程序中安装以下内容:</p><pre class="kg kh ki kj gt mz mb na nb aw nc bi"><span id="abf0" class="nd md iq mb b gy ne nf l ng nh">npm install redux</span><span id="f3dc" class="nd md iq mb b gy ni nf l ng nh">npm install react-redux</span></pre><p id="3437" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">本指南中的示例将引用我的存储库:</p><div class="nj nk gp gr nl nm"><a href="https://github.com/reireynoso/react-redux-hooks-practice" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">reireynoso/react-redux-hooks-练习</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">这个项目是用Create React App引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">github.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa kp nm"/></div></div></a></div><p id="5fc7" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">下面是该应用功能的快速gif图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/58de6381226f343ee556335d208836fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Sr7axcFaMxvbbyyiP4w2OQ.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">React-Redux钩子练习Gif</figcaption></figure><p id="8e5e" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">有两种独立的状态，一种用于跟踪计数器，另一种用于跟踪登录的用户。我们将有单独的文件来处理每个状态。</p><h1 id="baef" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">创建一个操作和减速器文件夹</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/35c05971bee6eea4f68f0e0fc706d3c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*sAu3-713CQYMvofUQZChJg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">操作和减速器文件夹</figcaption></figure><h2 id="7960" class="nd md iq bd me od oe dn mi of og dp mm ll oh oi mo lp oj ok mq lt ol om ms on bi translated">行动</h2><p id="7dfd" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">让我们从定义<code class="fe ly lz ma mb b">counterActions.js</code>中计数器的动作开始。有几个方法是必须的，<code class="fe ly lz ma mb b">increment</code>和<code class="fe ly lz ma mb b">decrement</code>。我们将在一个对象中导出这两个方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">反作用</figcaption></figure><p id="a373" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">类似地，让我们在<code class="fe ly lz ma mb b">userActions.js</code> <strong class="le ir">、</strong>中定义当前用户的动作，其中也将有两个方法<code class="fe ly lz ma mb b">setUser</code>和<code class="fe ly lz ma mb b">logOut</code>，它们将在一个对象中导出。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">用户操作. js</figcaption></figure><p id="b9d7" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">为了有条理，我们将这两个文件导入到一个位置，即<code class="fe ly lz ma mb b">actions</code>文件夹中的<code class="fe ly lz ma mb b">index.js</code> <strong class="le ir"> </strong>文件。我们创建一个变量<code class="fe ly lz ma mb b">allActions</code>并将其设置为一个对象，该对象包含将要导出的导入动作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">操作-&gt; index.js</figcaption></figure><h2 id="af9e" class="nd md iq bd me od oe dn mi of og dp mm ll oh oi mo lp oj ok mq lt ol om ms on bi translated">还原剂</h2><p id="9e75" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">与操作文件结构采用的方法相似，我们创建单独的<code class="fe ly lz ma mb b">reducers</code>文件夹来保存用户和计数器reducers。先说计数器减速器，<code class="fe ly lz ma mb b">counter.js</code>。</p><p id="84ca" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">一个reducer函数接受两个参数，<code class="fe ly lz ma mb b">state</code>和<code class="fe ly lz ma mb b">action</code>。状态不一定必须设置为对象。在这种情况下，状态的默认值被设置为一个整数。</p><p id="4d71" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">正如我们前面定义的，一个动作返回一个对象，该对象可以包含两个键，<code class="fe ly lz ma mb b">type</code>和一个可选的<code class="fe ly lz ma mb b">payload</code>。基于动作类型，状态的值将被改变。请记住，在调用不存在的动作类型的情况下，默认情况是必要的，以防止应用程序中断。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">计数器减速器，counter.js</figcaption></figure><p id="ab36" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">对于当前用户reducer<code class="fe ly lz ma mb b">currentUser.js</code>，状态将被设置为一个空对象，其中包含键<code class="fe ly lz ma mb b">user</code>和<code class="fe ly lz ma mb b">loggedIn</code>。请注意<code class="fe ly lz ma mb b">counter</code>和<code class="fe ly lz ma mb b">currentUser</code>之间返回内容的差异。在所有情况下，计数器缩减器返回一个整数，因为它的初始值是一个整数。对于当前用户reducer，总是返回一个对象。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">当前用户减少器。currentUser.js</figcaption></figure><p id="6612" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">我们需要将这些减速器合二为一。在<code class="fe ly lz ma mb b">reducers/index.js</code>下，让我们导入reducer文件以及<code class="fe ly lz ma mb b">combineReducers</code>:</p><pre class="kg kh ki kj gt mz mb na nb aw nc bi"><span id="f885" class="nd md iq mb b gy ne nf l ng nh">import {combineReducers} from 'redux'</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="1de8" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">合并reducers顾名思义就是将独立的reducer文件合并成一个文件。它接受一个参数，一个包含reducer文件的对象。现在我们的动作和reducers已经设置好了，让我们继续在应用程序中实现Redux。</p><h1 id="2b16" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">实施Redux</h1><p id="279f" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">在我们的<code class="fe ly lz ma mb b">index.js</code>下的<code class="fe ly lz ma mb b">src</code>文件夹中，我们将导入以下内容:</p><pre class="kg kh ki kj gt mz mb na nb aw nc bi"><span id="45e6" class="nd md iq mb b gy ne nf l ng nh">import {Provider} from 'react-redux';<br/>import {createStore} from 'redux'<br/>import rootReducer from './reducers'</span></pre><p id="89b0" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">将使用方法<code class="fe ly lz ma mb b">createStore</code>创建一个Redux存储。它接受两个参数，即组合了我们的reducers和Redux devtools扩展的文件<code class="fe ly lz ma mb b">rootReducer</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="1b55" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">最后，我们用来自<code class="fe ly lz ma mb b">react-redux</code>的<code class="fe ly lz ma mb b">Provider</code>组件包装我们的<code class="fe ly lz ma mb b">App</code>组件。<code class="fe ly lz ma mb b">Provider</code>组件将接收一个道具，从<code class="fe ly lz ma mb b">createStore</code>存储到<code class="fe ly lz ma mb b">store</code>中。</p><h1 id="df12" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">实现useSelector/useDispatch</h1><p id="78c6" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">我们从react-redux、<code class="fe ly lz ma mb b">useSelector</code>和<code class="fe ly lz ma mb b">useDispatch</code>导入以下钩子。之前，我们必须从react-redux导入<code class="fe ly lz ma mb b">connect()</code>,并用它包装我们的组件，以便将状态映射到道具，并将调度映射到道具。</p><h2 id="fd1d" class="nd md iq bd me od oe dn mi of og dp mm ll oh oi mo lp oj ok mq lt ol om ms on bi translated">使用选择器</h2><p id="9cc7" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">地图状态相当于道具的是<code class="fe ly lz ma mb b">useSelector</code>。它接受一个函数参数，返回您想要的状态部分。在这种情况下，我们有以下来自状态定义的键，<code class="fe ly lz ma mb b">counter</code>和<code class="fe ly lz ma mb b">currentUser</code>。我们之前在组合异径管时定义了这些。</p><pre class="kg kh ki kj gt mz mb na nb aw nc bi"><span id="0f8b" class="nd md iq mb b gy ne nf l ng nh">const counter = useSelector(state =&gt; state.counter)<br/>// 1</span><span id="9a3d" class="nd md iq mb b gy ni nf l ng nh">const currentUser = useSelector(state =&gt; state.currentUser)<br/>// {}</span></pre><p id="fe40" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">因此，变量<code class="fe ly lz ma mb b">counter</code>和<code class="fe ly lz ma mb b">currentUser</code>被设置为由它们各自的减速器定义的状态。</p><h2 id="a955" class="nd md iq bd me od oe dn mi of og dp mm ll oh oi mo lp oj ok mq lt ol om ms on bi translated">使用显示器</h2><p id="80e6" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">相当于地图分派到道具的是<code class="fe ly lz ma mb b">useDispatch</code>。我们将调用<code class="fe ly lz ma mb b">useDispatch</code>并将其存储到变量<code class="fe ly lz ma mb b">dispatch</code>中。Dispatch将使用从actions文件夹导入的<code class="fe ly lz ma mb b">allActions</code>。例如，<code class="fe ly lz ma mb b">useEffect</code>用下面的动作<code class="fe ly lz ma mb b">allActions.userActions.setUser(user)</code>调用一个<code class="fe ly lz ma mb b">dispatch</code>。用户被定义为:</p><pre class="kg kh ki kj gt mz mb na nb aw nc bi"><span id="f910" class="nd md iq mb b gy ne nf l ng nh">const user = {name: "Rei"}</span></pre><p id="a972" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">请记住，<code class="fe ly lz ma mb b">allActions</code>是一个以<code class="fe ly lz ma mb b">userActions</code>和<code class="fe ly lz ma mb b">counterActions</code>为关键字的对象。作为对<code class="fe ly lz ma mb b">userActions.js</code>中定义的<code class="fe ly lz ma mb b">setUser</code>功能的复习:</p><pre class="kg kh ki kj gt mz mb na nb aw nc bi"><span id="b0db" class="nd md iq mb b gy ne nf l ng nh">const setUser = (userObj) =&gt; {</span><span id="f905" class="nd md iq mb b gy ni nf l ng nh">   return {</span><span id="5414" class="nd md iq mb b gy ni nf l ng nh">      type: "SET_USER",</span><span id="d294" class="nd md iq mb b gy ni nf l ng nh">      payload: userObj</span><span id="5aea" class="nd md iq mb b gy ni nf l ng nh">    }</span><span id="502a" class="nd md iq mb b gy ni nf l ng nh">}</span></pre><p id="a0d0" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><code class="fe ly lz ma mb b">setUser</code>将返回一个带有<code class="fe ly lz ma mb b">type</code>和<code class="fe ly lz ma mb b">payload</code>的对象。Dispatch将接受这个对象，并检查与动作类型匹配的reducers。在这种特殊情况下，它位于<code class="fe ly lz ma mb b">reducers</code>文件夹中的<code class="fe ly lz ma mb b">currentUser.js</code>。</p><pre class="kg kh ki kj gt mz mb na nb aw nc bi"><span id="7c0a" class="nd md iq mb b gy ne nf l ng nh">case "SET_USER":</span><span id="402a" class="nd md iq mb b gy ni nf l ng nh">   return {</span><span id="d653" class="nd md iq mb b gy ni nf l ng nh">   ...state,</span><span id="3a1a" class="nd md iq mb b gy ni nf l ng nh">   user: action.payload,</span><span id="41b2" class="nd md iq mb b gy ni nf l ng nh">   loggedIn: true</span><span id="697a" class="nd md iq mb b gy ni nf l ng nh">}</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">应用程序组件</figcaption></figure><p id="dd9e" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">现在你知道了。React-Redux挂钩<code class="fe ly lz ma mb b">useSelector</code>和<code class="fe ly lz ma mb b">useDispatch</code>在React应用中实现。与<code class="fe ly lz ma mb b">connect()</code>替代方案相比，代码更干净、更有条理。</p><p id="0bae" class="pw-post-body-paragraph lc ld iq le b lf lg jr lh li lj ju lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">感谢您的阅读！</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="9c44" class="mc md iq bd me mf oq mh mi mj or ml mm jw os jx mo jz ot ka mq kc ou kd ms mt bi translated">分级编码</h1><p id="9489" class="pw-post-body-paragraph lc ld iq le b lf mu jr lh li mv ju lk ll mw ln lo lp mx lr ls lt my lv lw lx ij bi translated">感谢您成为我们社区的一员！升级正在改变技术招聘。<a class="ae ov" href="https://jobs.levelup.dev/talent" rel="noopener ugc nofollow" target="_blank"> <strong class="le ir">在最好的公司找到你的完美工作</strong></a><strong class="le ir"/>。</p><div class="nj nk gp gr nl nm"><a href="https://jobs.levelup.dev/talent" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">提升——改变招聘流程</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">🔥让软件工程师找到他们热爱的完美角色🧠寻找人才是最痛苦的部分…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">作业. levelup.dev</p></div></div><div class="nv l"><div class="ow l nx ny nz nv oa kp nm"/></div></div></a></div></div></div>    
</body>
</html>