<html>
<head>
<title>Creating a Local Blockchain Website with React + Hardhat</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React + Hardhat创建本地区块链网站</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-a-local-blockchain-website-with-react-hardhat-691ba5ee6426?source=collection_archive---------7-----------------------#2022-05-29">https://levelup.gitconnected.com/creating-a-local-blockchain-website-with-react-hardhat-691ba5ee6426?source=collection_archive---------7-----------------------#2022-05-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f273b06c15be2380c974bc4cc361b8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygcJhtx-NkysU9_egSOJOQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">【https://unsplash.com/@theshubhamdhage T4】</figcaption></figure><p id="0eaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本教程中，我们将在Hardhat的帮助下，构建一个非常简单的React Webapp，它与本地主机上区块链的Solidity契约进行交互。该应用程序将在区块链上存储问候，并允许用户获取或更新问候。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/caa08a3d6222c7632e1e190005aa3a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3jZMm2z2iytIgAZ7HHKCbA.png"/></div></div></figure><h1 id="f574" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建基本的React和Hardhat应用</h1><ul class=""><li id="7ab0" class="me mf iq kf b kg mg kk mh ko mi ks mj kw mk la ml mm mn mo bi translated">我们要做的第一件事是创建一个React应用程序。我们可以通过运行<code class="fe mp mq mr ms b">npx create-react-app</code>来做到这一点</li><li id="8e8b" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ml mm mn mo bi translated"><strong class="kf ir">库</strong>:我们将需要几个库，使用<code class="fe mp mq mr ms b">npm install --save-dev @nomiclabs/hardhat-ethers ethers @nomiclabs/hardhat-waffle ethereum-waffle chai</code>安装它们</li><li id="dd42" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ml mm mn mo bi translated"><strong class="kf ir">安全帽</strong>:接下来我们将通过运行<code class="fe mp mq mr ms b">npx hardhat</code>初始化一个安全帽应用程序(确保选择<code class="fe mp mq mr ms b">Create a sample project</code></li></ul><p id="18f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看看我们有什么…</p><p id="6fea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> Greeter.sol </strong></p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="7f3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们的可靠性合同，我们将部署在我们当地的以太坊区块链。基本上，它接受一个初始问候语，并有一个返回该问候语的方法和一个更新该问候语的方法。一份相当简单的合同！</p><p id="92e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> App.js </strong></p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="1f68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们去掉最初的React应用程序中的一些附加功能，这样我们就有了这个基本组件。</p><p id="f75a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> scripts/deploy.js(注意:你的可能不叫deploy) </strong></p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="8321" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是Hardhat为我们制作的一个简单的部署脚本。正如您在第17–20行看到的，我们创建了一个欢迎契约，然后使用初始消息“Hello，Hardhat”部署它。</p><p id="8f95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> hardhat.config.js </strong></p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="06cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个文件配置了HardHat如何部署我们的链。需要更新的一些关键内容是…</p><ul class=""><li id="3240" class="me mf iq kf b kg kh kk kl ko na ks nb kw nc la ml mm mn mo bi translated">添加chainID 1337(必须是1337，因为元掩码如何与本地主机<a class="ae kc" href="https://hardhat.org/metamask-issue.html" rel="noopener ugc nofollow" target="_blank">https://hardhat.org/metamask-issue.html</a>交互</li><li id="8d15" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ml mm mn mo bi translated">将工件的路径设置为。/src/artifacts，默认情况下，工件进入根目录，但是如果我们希望我们的应用程序能够与我们的新契约交互，我们需要将工件文件发送到src。</li></ul><h2 id="0fa9" class="nd lh iq bd li ne nf dn lm ng nh dp lq ko ni nj lu ks nk nl ly kw nm nn mc no bi translated">让我们更新App.js</h2><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="25ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有相当大的数量，所以让我们一行一行地看。</p><ul class=""><li id="7b74" class="me mf iq kf b kg kh kk kl ko na ks nb kw nc la ml mm mn mo bi translated">我们通过运行部署脚本(下一节)获得<strong class="kf ir"> GREETER_ADDRESS </strong></li><li id="33ed" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ml mm mn mo bi translated"><strong class="kf ir">构造函数</strong>创建一个状态，其中问候语设置为空字符串</li><li id="7476" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ml mm mn mo bi translated">在<strong class="kf ir"> fetchGreeting </strong>中，我们检查以确保我们有一个以太坊提供者(比如MetaMask chrome插件)。如果是这样的话，我们用它来创建一个对我们在链上的契约的引用(第17–18行)。然后，我们调用契约上的greet方法来获取问候语，并将其存储在我们的状态中(第22–24行)。</li><li id="bf1f" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ml mm mn mo bi translated">在<strong class="kf ir"> setGreeting中，</strong>我们为newGreeting接受一个字符串。由于更新合同价值需要汽油费，我们需要一个以太坊账户来支付，所以我们去申请一个账户。现在我们可以创建一个合同引用，使用我们的以太坊账户来支付汽油费(第35–39行)。然后，我们执行一个事务来更新链上的值，并调用我们的fetchGreeting方法来更新我们的状态(第42–44行)。</li><li id="2752" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ml mm mn mo bi translated">在<strong class="kf ir">渲染</strong>中，我们创建了一个h1来显示我们的问候状态。我们提供了一个输入字段和一个按钮，当点击时，这个按钮试图更新链上的问候。</li></ul><h2 id="1393" class="nd lh iq bd li ne nf dn lm ng nh dp lq ko ni nj lu ks nk nl ly kw nm nn mc no bi translated">运行它！！！</h2><p id="345c" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko np kq kr ks nq ku kv kw nr ky kz la ij bi translated">现在我们可以运行我们的应用程序了！</p><ol class=""><li id="e39a" class="me mf iq kf b kg kh kk kl ko na ks nb kw nc la ns mm mn mo bi translated">端子1:运行<strong class="kf ir"> npx安全帽清洗</strong></li><li id="64cd" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ns mm mn mo bi translated">终端1:运行<strong class="kf ir"> npx hardhat编译</strong></li><li id="6bd8" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ns mm mn mo bi translated">端子2:运行<strong class="kf ir"> npx hardhat节点</strong>(并保持运行)</li><li id="9e4b" class="me mf iq kf b kg mt kk mu ko mv ks mw kw mx la ns mm mn mo bi translated">终端1:运行<strong class="kf ir"> npx hardhat运行scripts/deploy.js —网络本地主机</strong></li></ol><p id="ea95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您将得到如下输出</p><blockquote class="nt nu nv"><p id="f6d1" class="kd ke nw kf b kg kh ki kj kk kl km kn nx kp kq kr ny kt ku kv nz kx ky kz la ij bi translated">G <!-- --> reeter部署到:0x 5 fbdb 2315678 afec b 367 f 032d 93 f 642 f 64180 aa 3</p></blockquote><p id="f791" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那是你的GREETER_CONTRACT，把那个放在你的App.js里面。</p><p id="a556" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.端子3:运行<strong class="kf ir"> npm启动</strong></p><p id="ccf7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.在MetaMask中，切换到localhost:8545网络，单击右上角的圆圈，并使用运行步骤3后显示的私钥之一导入帐户。然后单击设置&gt;高级&gt;重置帐户</p><p id="bde6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">TaDa！！现在，您可以在本地创建分散的web应用程序，然后将它们部署到主以太网！</p></div></div>    
</body>
</html>