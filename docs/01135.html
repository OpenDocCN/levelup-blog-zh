<html>
<head>
<title>How to Build a Chrome Extension with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用React构建一个Chrome扩展</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-make-a-chrome-extension-with-react-129cdcbf1414?source=collection_archive---------0-----------------------#2019-11-14">https://levelup.gitconnected.com/how-to-make-a-chrome-extension-with-react-129cdcbf1414?source=collection_archive---------0-----------------------#2019-11-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6e12" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用React with Hooks构建一个Chrome扩展，通过调用OpenWeaterMap API来显示天气。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e587a040043f6f0fa89e84bd4764560c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_so-kUiAsgAi0cddfqATFw.jpeg"/></div></div></figure><p id="498e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最流行的网络浏览器Chrome和Firefox都支持扩展。扩展是使用HTML、CSS和JavaScript构建的小应用程序，您可以将其添加到浏览器中，以获得默认情况下不包含的附加功能。这使得扩展你的浏览器非常容易。用户需要做的只是从在线商店添加浏览器插件，比如Chrome网络商店或Firefox商店。</p><p id="16ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">浏览器扩展只是以特定方式包装的普通HTML应用程序。这意味着我们可以使用HTML、CSS和JavaScript来构建自己的扩展——这也意味着我们可以使用React或Vue这样的前端JavaScript框架来构建扩展。</p><p id="da12" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Chrome和Firefox扩展遵循<a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions" rel="noopener ugc nofollow" target="_blank"> Web扩展API标准</a>。</p><p id="0902" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我们将构建一个Chrome扩展来显示来自OpenWeatherMap API的天气。我们将添加搜索，让用户从API中查找当前天气和预报，并在扩展的弹出框中显示。</p><p id="ce05" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">OpenWeatherMap API可在https://openweathermap.org/api<a class="ae lq" href="https://openweathermap.org/api" rel="noopener ugc nofollow" target="_blank">获得，你需要注册一个API密钥。</a></p><h2 id="7e1f" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">入门指南</h2><p id="4ade" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">我们将使用React来构建浏览器扩展。如果我们使用Create React App创建应用程序，我们可以像平常一样构建应用程序，然后修改项目中的<code class="fe mp mq mr ms b">manifest.json</code>来创建有效的Chrome扩展。</p><p id="acac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mp mq mr ms b">manifest.json</code>是额外的配置文件，用来告诉Chrome如何将我们的应用作为一个扩展来处理。我们将首先建立应用程序，然后我会告诉你在<code class="fe mp mq mr ms b">manifest.json</code>需要什么才能让它工作。</p><p id="6d56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了开始构建应用程序，我们通过运行以下命令来运行Create React App:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="2b2b" class="lr ls it ms b gy mx my l mz na">npx create-react-app weather-app</span></pre><p id="6541" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该命令将创建React项目文件夹，其中包含我们将要构建的框架代码。</p><p id="dff9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们安装一些构建扩展所需的包。我们需要Axios进行HTTP请求，需要Bootstrap进行样式设计，需要Formik进行表单值处理，需要MobX进行状态管理，需要Yup进行表单验证。</p><p id="49a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们通过运行以下命令来安装它们:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="3420" class="lr ls it ms b gy mx my l mz na">npm i axios bootstrap formik mobx mobx-react react-bootstrap yup</span></pre><h2 id="fb59" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">构建应用程序</h2><p id="8d35" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">现在我们可以构建我们的天气窗口小部件Chrome扩展了。在<code class="fe mp mq mr ms b">App.js</code>中，将现有代码替换为:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="ce37" class="lr ls it ms b gy mx my l mz na">import React from "react";<br/>import HomePage from "./HomePage";<br/>import "./App.css";<br/>import { KeywordStore } from "./store";<br/>import Navbar from "react-bootstrap/Navbar";<br/>const keywordStore = new KeywordStore();</span><span id="170f" class="lr ls it ms b gy nb my l mz na">function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Navbar bg="primary" expand="lg" variant="dark"&gt;<br/>        &lt;Navbar.Brand href="#home"&gt;Weather App&lt;/Navbar.Brand&gt;<br/>      &lt;/Navbar&gt;<br/>      &lt;HomePage keywordStore={keywordStore} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="0aa9" class="lr ls it ms b gy nb my l mz na">export default App;</span></pre><p id="6818" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们在文件中添加了反应助推器<code class="fe mp mq mr ms b">Navbar</code>和我们的<code class="fe mp mq mr ms b">HomePage</code>。</p><p id="d4b6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来在<code class="fe mp mq mr ms b">App.css</code>中，用以下代码替换现有代码:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="9940" class="lr ls it ms b gy mx my l mz na">html,<br/>body {<br/>  min-width: 500px;<br/>}</span><span id="ea60" class="lr ls it ms b gy nb my l mz na">.page {<br/>  padding: 20px;<br/>}</span></pre><p id="c8ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们指定小部件在浏览器中显示时的最小宽度，并在页面中添加一些填充。</p><p id="3cae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们创建一个组件来显示当前天气。在<code class="fe mp mq mr ms b">src</code>文件夹中创建一个名为<code class="fe mp mq mr ms b">CurrentWeather.js</code>的文件，并添加:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="92f7" class="lr ls it ms b gy mx my l mz na">import React from "react";<br/>import { observer } from "mobx-react";<br/>import { searchWeather } from "./request";<br/>import ListGroup from "react-bootstrap/ListGroup";</span><span id="c2a4" class="lr ls it ms b gy nb my l mz na">function CurrentWeather({ keywordStore }) {<br/>  const [weather, setWeather] = React.useState({});</span><span id="39ac" class="lr ls it ms b gy nb my l mz na">  const getWeatherForecast = async keyword =&gt; {<br/>    const response = await searchWeather(keyword);<br/>    setWeather(response.data);<br/>  };</span><span id="1500" class="lr ls it ms b gy nb my l mz na">  React.useEffect(() =&gt; {<br/>    keywordStore.keyword &amp;&amp; getWeatherForecast(keywordStore.keyword);<br/>  }, [keywordStore.keyword]);</span><span id="648e" class="lr ls it ms b gy nb my l mz na">return (<br/>    &lt;div&gt;<br/>      {weather.main ? (<br/>        &lt;ListGroup&gt;<br/>          &lt;ListGroup.Item&gt;<br/>            Current Temparature: {weather.main.temp - 273.15} C<br/>          &lt;/ListGroup.Item&gt;<br/>          &lt;ListGroup.Item&gt;<br/>            High: {weather.main.temp_max - 273.15} C<br/>          &lt;/ListGroup.Item&gt;<br/>          &lt;ListGroup.Item&gt;<br/>            Low: {weather.main.temp_min - 273.15} C<br/>          &lt;/ListGroup.Item&gt;<br/>          &lt;ListGroup.Item&gt;Pressure: {weather.main.pressure} &lt;/ListGroup.Item&gt;<br/>          &lt;ListGroup.Item&gt;Humidity: {weather.main.humidity}&lt;/ListGroup.Item&gt;<br/>        &lt;/ListGroup&gt;<br/>      ) : null}<br/>    &lt;/div&gt;<br/>  );<br/>}<br/>export default observer(CurrentWeather);</span></pre><p id="7d07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们从<code class="fe mp mq mr ms b">keywordStore</code>(我们将在本文稍后构建)中获取搜索关键字，并通过将当前天气传递给<code class="fe mp mq mr ms b">React.useEffect</code>函数的第二个参数来搜索当前天气。</p><p id="43bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦检索到数据，我们用<code class="fe mp mq mr ms b">setWeather</code>函数设置数据，并在页面底部的<code class="fe mp mq mr ms b">ListGroup</code>中显示数据。</p><p id="ac4c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将最后一行中的组件用<code class="fe mp mq mr ms b">observer</code>包装起来，这样我们就可以从<code class="fe mp mq mr ms b">keywordStore</code>中获得最新的<code class="fe mp mq mr ms b">keyword</code>值。</p><p id="138e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们添加一个组件来显示预测，在<code class="fe mp mq mr ms b">src</code>文件夹中添加<code class="fe mp mq mr ms b">Forecast.js</code>并添加:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="08e3" class="lr ls it ms b gy mx my l mz na">import React from "react";<br/>import { observer } from "mobx-react";<br/>import { searchForecast } from "./request";<br/>import ListGroup from "react-bootstrap/ListGroup";<br/>import Card from "react-bootstrap/Card";</span><span id="975a" class="lr ls it ms b gy nb my l mz na">function Forecast({ keywordStore }) {<br/>  const [forecast, setForecast] = React.useState({});</span><span id="73ff" class="lr ls it ms b gy nb my l mz na">  const getWeatherForecast = async keyword =&gt; {<br/>    const response = await searchForecast(keyword);<br/>    setForecast(response.data);<br/>  };</span><span id="bf70" class="lr ls it ms b gy nb my l mz na">  React.useEffect(() =&gt; {<br/>    keywordStore.keyword &amp;&amp; getWeatherForecast(keywordStore.keyword);<br/>  }, [keywordStore.keyword]);</span><span id="27b6" class="lr ls it ms b gy nb my l mz na">  return (<br/>    &lt;div&gt;<br/>      {Array.isArray(forecast.list) ? (<br/>        &lt;div&gt;<br/>          {forecast.list.map(l =&gt; {<br/>            return (<br/>              &lt;Card body&gt;<br/>                &lt;ListGroup&gt;<br/>                  &lt;ListGroup.Item&gt;Date: {l.dt_txt}&lt;/ListGroup.Item&gt;<br/>                  &lt;ListGroup.Item&gt;<br/>                    Temperature: {l.main.temp - 273.15} C<br/>                  &lt;/ListGroup.Item&gt;<br/>                  &lt;ListGroup.Item&gt;<br/>                    High: {l.main.temp_max - 273.15} C<br/>                  &lt;/ListGroup.Item&gt;<br/>                  &lt;ListGroup.Item&gt;<br/>                    Low: {l.main.temp_min - 273.15} C<br/>                  &lt;/ListGroup.Item&gt;<br/>                  &lt;ListGroup.Item&gt;Pressure: {l.main.pressure} C&lt;/ListGroup.Item&gt;<br/>                &lt;/ListGroup&gt;<br/>              &lt;/Card&gt;<br/>            );<br/>          })}<br/>        &lt;/div&gt;<br/>      ) : null}<br/>    &lt;/div&gt;<br/>  );<br/>}<br/>export default observer(Forecast);</span></pre><p id="0674" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除了数据在一个列表中之外，它与<code class="fe mp mq mr ms b">CurrentWeather.js</code>非常相似。所以我们将<code class="fe mp mq mr ms b">forecast.list</code>映射到一个由<code class="fe mp mq mr ms b">Card</code>组成的数组中，而不仅仅是渲染它。</p><p id="4a43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们在<code class="fe mp mq mr ms b">src</code>文件夹中创建一个<code class="fe mp mq mr ms b">HomePage.js</code>文件，并添加:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="4ac1" class="lr ls it ms b gy mx my l mz na">import React from "react";<br/>import { Formik } from "formik";<br/>import Form from "react-bootstrap/Form";<br/>import Col from "react-bootstrap/Col";<br/>import Button from "react-bootstrap/Button";<br/>import { observer } from "mobx-react";<br/>import * as yup from "yup";<br/>import Tabs from "react-bootstrap/Tabs";<br/>import Tab from "react-bootstrap/Tab";<br/>import CurrentWeather from "./CurrentWeather";<br/>import Forecast from "./Forecast";</span><span id="21e4" class="lr ls it ms b gy nb my l mz na">const schema = yup.object({<br/>  keyword: yup.string().required("Keyword is required")<br/>});</span><span id="4c9d" class="lr ls it ms b gy nb my l mz na">function HomePage({ keywordStore }) {<br/>  const [initialized, setInitialized] = React.useState(false);</span><span id="7c51" class="lr ls it ms b gy nb my l mz na">const handleSubmit = async evt =&gt; {<br/>    const isValid = await schema.validate(evt);<br/>    if (!isValid) {<br/>      return;<br/>    }<br/>    localStorage.setItem("keyword", evt.keyword);<br/>    keywordStore.setKeyword(evt.keyword);<br/>  };</span><span id="954d" class="lr ls it ms b gy nb my l mz na">React.useEffect(() =&gt; {<br/>    if (!initialized) {<br/>      keywordStore.setKeyword(localStorage.getItem("keyword") || "");<br/>      setInitialized(true);<br/>    }<br/>  });</span><span id="081b" class="lr ls it ms b gy nb my l mz na">return (<br/>    &lt;div className="page"&gt;<br/>      &lt;h1&gt;Weather&lt;/h1&gt;<br/>      &lt;Formik<br/>        validationSchema={schema}<br/>        onSubmit={handleSubmit}<br/>        initialValues={{ keyword: localStorage.getItem("keyword") || "" }}<br/>      &gt;<br/>        {({<br/>          handleSubmit,<br/>          handleChange,<br/>          handleBlur,<br/>          values,<br/>          touched,<br/>          isInvalid,<br/>          errors<br/>        }) =&gt; (<br/>          &lt;Form noValidate onSubmit={handleSubmit}&gt;<br/>            &lt;Form.Row&gt;<br/>              &lt;Form.Group as={Col} md="12" controlId="keyword"&gt;<br/>                &lt;Form.Label&gt;City&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  name="keyword"<br/>                  placeholder="City"<br/>                  value={values.keyword || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.keyword &amp;&amp; errors.keyword}<br/>                /&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.keyword}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;<br/>            &lt;/Form.Row&gt;<br/>            &lt;Button type="submit" style={{ marginRight: "10px" }}&gt;<br/>              Search<br/>            &lt;/Button&gt;<br/>          &lt;/Form&gt;<br/>        )}<br/>      &lt;/Formik&gt;<br/>      &lt;br /&gt;<br/>      &lt;Tabs defaultActiveKey="weather"&gt;<br/>        &lt;Tab eventKey="weather" title="Current Weather"&gt;<br/>          &lt;CurrentWeather keywordStore={keywordStore} /&gt;<br/>        &lt;/Tab&gt;<br/>        &lt;Tab eventKey="forecast" title="Forecast"&gt;<br/>          &lt;Forecast keywordStore={keywordStore} /&gt;<br/>        &lt;/Tab&gt;<br/>      &lt;/Tabs&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}<br/>export default observer(HomePage);</span></pre><p id="8c58" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们有一个表单，让用户在搜索框中输入他们选择的城市。提交表单时，商店中会设置<code class="fe mp mq mr ms b">evt.keyword</code>值。当存储器中的<code class="fe mp mq mr ms b">keyword</code>值更新时，将执行<code class="fe mp mq mr ms b">CurrentWeather</code>和<code class="fe mp mq mr ms b">Forecast</code>组件中的搜索功能。我们还在本地存储中设置了<code class="fe mp mq mr ms b">keyword</code>。使用本地存储还允许我们根据用户设置的位置为用户保存默认值。</p><p id="61f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">表单验证由Yup库通过为表单验证模式创建一个对象来完成。我们将<code class="fe mp mq mr ms b">keyword</code>字段设为必填字段。</p><p id="7b61" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe mp mq mr ms b">useEffect</code>回调中，我们从本地存储中加载<code class="fe mp mq mr ms b">keyword</code>并将其设置在MobX存储中以触发搜索。</p><p id="9735" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在组件的底部，我们有显示当前天气和预报的选项卡。</p><p id="0488" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来在<code class="fe mp mq mr ms b">src</code>文件夹中创建一个名为<code class="fe mp mq mr ms b">request.js</code>的文件，并添加:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="d6b3" class="lr ls it ms b gy mx my l mz na">const APIURL = "<a class="ae lq" href="http://api.openweathermap.org" rel="noopener ugc nofollow" target="_blank">http://api.openweathermap.org</a>";<br/>const axios = require("axios");</span><span id="fc66" class="lr ls it ms b gy nb my l mz na">export const searchWeather = loc =&gt;<br/>  axios.get(<br/>    `${APIURL}/data/2.5/weather?q=${loc}&amp;appid=${process.env.REACT_APP_APIKEY}`<br/>  );</span><span id="40bd" class="lr ls it ms b gy nb my l mz na">export const searchForecast = loc =&gt;<br/>  axios.get(<br/>    `${APIURL}/data/2.5/forecast?q=${loc}&amp;appid=${process.env.REACT_APP_APIKEY}`<br/>  );</span></pre><p id="8579" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是搜索当前天气和预报的HTTP请求的代码。</p><p id="aa9f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mp mq mr ms b">process.env.REACT_API_APIKEY</code>是存储在项目根文件夹的<code class="fe mp mq mr ms b">.env</code>文件中的OpenWeatherMap API key。</p><p id="a69d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它存储为:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="000a" class="lr ls it ms b gy mx my l mz na">REACT_APP_APIKEY='OpenWeatherMap API key'</span></pre><p id="8b53" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来在<code class="fe mp mq mr ms b">src</code>文件夹中创建一个<code class="fe mp mq mr ms b">store.js</code>，并添加:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="c45f" class="lr ls it ms b gy mx my l mz na">import { observable, action, decorate } from "mobx";</span><span id="2160" class="lr ls it ms b gy nb my l mz na">class KeywordStore {<br/>  keyword = "";</span><span id="0339" class="lr ls it ms b gy nb my l mz na">  setKeyword(keyword) {<br/>    this.keyword = keyword;<br/>  }<br/>}</span><span id="29a8" class="lr ls it ms b gy nb my l mz na">KeywordStore = decorate(KeywordStore, {<br/>  keyword: observable,<br/>  setKeyword: action<br/>});</span><span id="a270" class="lr ls it ms b gy nb my l mz na">export { KeywordStore };</span></pre><p id="fea3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我们存储<code class="fe mp mq mr ms b">keyword</code>的MobX商店，这样我们的组件就可以很容易地设置和访问它们。我们在<code class="fe mp mq mr ms b">HomePage</code>中设置它，并在<code class="fe mp mq mr ms b">CurrentWeather</code>和<code class="fe mp mq mr ms b">Forecast</code>组件中获取它。</p><h2 id="8f95" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">为浏览器打包应用程序</h2><p id="ad93" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">为了创建Chrome扩展，我们需要修改<code class="fe mp mq mr ms b">manifest.json</code>。</p><p id="7685" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在那里，将现有代码替换为:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="0b6e" class="lr ls it ms b gy mx my l mz na">{<br/>  "short_name": "Weather Extension",<br/>  "name": "Weather Extension",<br/>  "icons": {<br/>    "16": "favicon.ico",<br/>    "48": "logo192.png",<br/>    "128": "logo512.png"<br/>  },<br/>  "content_security_policy": "script-src 'self' 'sha256-WDhufSqZOEoWULzS4Nwz11MNyHzZClVYbQ2JSt1vfkw'; object-src 'self'",<br/>  "permissions": [],<br/>  "manifest_version": 2,<br/>  "version": "0.0.1",<br/>  "browser_action": {<br/>    "default_popup": "index.html",<br/>    "default_title": "Weather Widget"<br/>  }<br/>}</span></pre><p id="47fa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些键值中的一些必须按照它们在这个文件中的方式进行设置。<code class="fe mp mq mr ms b">manifest_version</code>必须设置为<code class="fe mp mq mr ms b">2</code>，且<code class="fe mp mq mr ms b">version</code>必须大于0。</p><p id="4e23" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，我们需要:</p><pre class="kj kk kl km gt mt ms mu mv aw mw bi"><span id="1fda" class="lr ls it ms b gy mx my l mz na">"browser_action": {<br/>  "default_popup": "index.html",<br/>  "default_title": "Weather Widget"<br/>}</span></pre><p id="3b2d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这显示了在我们安装扩展之后，当点击扩展的图标时的弹出窗口。</p><h2 id="2aa2" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">在Chrome中加载应用程序</h2><p id="eed7" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">接下来，我们运行<code class="fe mp mq mr ms b">npm run build</code>来构建生产文件。然后到Chrome里的<code class="fe mp mq mr ms b">chrome://extensions/</code>。切换到开发者模式并点击“加载解压”，然后在打开文件对话框出现时选择<code class="fe mp mq mr ms b">build</code>文件夹。</p><p id="9573" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完成后，我们应该会在屏幕的右上角看到一个图标和一个弹出窗口，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/e88f6300580e2eae55ed19f208e7a802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*UzZSnZOt5eiaw1KoF64Fkw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/ed0d80a626f6e156e6179a8e2765fe11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*UCn3d46Up33AxyHSnbviiQ.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/ac49d695e7ea6df883dfece0bad7fdb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*4BE7MvPWlj46TJPv5wOTfg.png"/></div></figure></div></div>    
</body>
</html>