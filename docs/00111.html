<html>
<head>
<title>🤖 How to get Certbot wildcard certificates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">🤖如何获取Certbot通配符证书</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-get-certbot-wildcard-certificates-3d25618a81e0?source=collection_archive---------0-----------------------#2018-04-15">https://levelup.gitconnected.com/how-to-get-certbot-wildcard-certificates-3d25618a81e0?source=collection_archive---------0-----------------------#2018-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b8e146f8281e1391935b95f9ed19516c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9f_oS_Cuc2Nm21qk76OQRA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://certbot.eff.org/" rel="noopener ugc nofollow" target="_blank">https://certbot.eff.org/</a></figcaption></figure><p id="9513" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是如何获得<strong class="kf ir">证书机器人</strong>通配符证书的3个步骤。在这个例子中，我使用的是我的域名<strong class="kf ir"> catcat.io </strong>，但是您可以简单地用您的域名替换这个名称。</p><ol class=""><li id="380c" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><strong class="kf ir"> SSH </strong>进入你的服务器(我使用<a class="ae kc" href="https://m.do.co/c/6dcfcc2a3392" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> DigitalOcean </strong> </a>)并运行这个</li></ol><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="31f6" class="lt lu iq lp b gy lv lw l lx ly"># To ensure python will not throw error<br/>export LC_ALL="en_US.UTF-8"<br/>export LC_CTYPE="en_US.UTF-8"<br/>sudo dpkg-reconfigure locales</span></pre><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/f5f5094413c3605d747eab84d5ce9a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5HGb3BN0JsB_MyEWa57LpQ.png"/></div></div></figure><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="94a1" class="lt lu iq lp b gy lv lw l lx ly"># Get the source<br/>git clone <a class="ae kc" href="https://github.com/certbot/certbot" rel="noopener ugc nofollow" target="_blank">https://github.com/certbot/certbot</a><br/>cd certbot</span><span id="646a" class="lt lu iq lp b gy ma lw l lx ly"># Run certbot auto<br/>./certbot-auto --os-packages-only</span><span id="58ea" class="lt lu iq lp b gy ma lw l lx ly"># New version doesn't need this, please skip<br/>./tools/venv.sh<br/>source venv/bin/activate</span><span id="81de" class="lt lu iq lp b gy ma lw l lx ly"># Ask for cert<br/>./certbot-auto -d catcat.io -d *.catcat.io --manual --preferred-challenges dns-01 --server https://acme-v02.api.letsencrypt.org/directory certonly</span></pre><p id="36e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.您将被要求在您的域名提供商处提交两次DNS<strong class="kf ir">TXT<strong class="kf ir">TXT</strong>记录<strong class="kf ir"/></strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/9a7c111bfc6e1a7bbbc8af18f1d102d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVC9PQ51L_WcygPgGTPJsA.png"/></div></div></figure><p id="aed0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将来自命令行的值作为2个单独的<strong class="kf ir"> TXT </strong>记录<strong class="kf ir"> </strong>值相加。</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/1e276a0bf26977b5261ced4ba401b681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BDgy-tTgOn0Tlhm9ZX8upg.png"/></div></div></figure><p id="a5ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你会在那里看到2条TXT记录</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/c092dc906a4d95b60ea0f33c37d89573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8lbUL2mK3sLfXGVeeUCtTA.png"/></div></div></figure><p id="2acd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.既然已经部署了DNS <strong class="kf ir"> TXT </strong>记录，那么返回到命令行并点击enter。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="5569" class="lt lu iq lp b gy lv lw l lx ly">Press Enter to Continue<br/>Waiting for verification...<br/>Cleaning up challenges</span><span id="dadc" class="lt lu iq lp b gy ma lw l lx ly">IMPORTANT NOTES:<br/> - Congratulations! Your certificate and chain have been saved at:<br/>   /etc/letsencrypt/live/catcat.io-0001/fullchain.pem<br/>   Your key file has been saved at:<br/>   /etc/letsencrypt/live/catcat.io-0001/privkey.pem<br/>   Your cert will expire on 2018-07-08. To obtain a new or tweaked<br/>   version of this certificate in the future, simply run certbot<br/>   again. To non-interactively renew *all* of your certificates, run<br/>   "certbot renew"<br/> - If you like Certbot, please consider supporting our work by:</span><span id="6ded" class="lt lu iq lp b gy ma lw l lx ly">Donating to ISRG / Let's Encrypt:   <a class="ae kc" href="https://letsencrypt.org/donate" rel="noopener ugc nofollow" target="_blank">https://letsencrypt.org/donate</a><br/>   Donating to EFF:                    <a class="ae kc" href="https://eff.org/donate-le" rel="noopener ugc nofollow" target="_blank">https://eff.org/donate-le</a></span></pre><blockquote class="me mf mg"><p id="a82f" class="kd ke mh kf b kg kh ki kj kk kl km kn mi kp kq kr mj kt ku kv mk kx ky kz la ij bi translated">PS:以上是假的<strong class="kf ir">极致挑战</strong>所以不需要审查，只是不要分享你的:)</p></blockquote><h2 id="cfc8" class="lt lu iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">旧证书的额外步骤</h2><p id="83a6" class="pw-post-body-paragraph kd ke iq kf b kg nc ki kj kk nd km kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">您的新证书将在<strong class="kf ir"> catcat.io-0001 </strong>创建一个新文件夹。您可以从两个选项中选择，让您的服务器使用这个新证书。</p><ol class=""><li id="499d" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">更新您的<strong class="kf ir"> nginx </strong> SSL配置以指向新的<strong class="kf ir"> catcat.io-0001 </strong>文件夹</li><li id="6a01" class="lb lc iq kf b kg nh kk ni ko nj ks nk kw nl la lg lh li lj bi translated">将任何<strong class="kf ir"> catcat.io-0001 </strong>重命名为<strong class="kf ir"> catcat.io </strong>(备份后)</li></ol><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="382b" class="lt lu iq lp b gy lv lw l lx ly">mv /etc/letsencrypt/live/catcat.io-0001 /etc/letsencrypt/live/catcat.io</span><span id="098f" class="lt lu iq lp b gy ma lw l lx ly">mv /etc/letsencrypt/renewal/catcat.io-0001.conf /etc/letsencrypt/renewal/catcat.io.conf</span><span id="b2ea" class="lt lu iq lp b gy ma lw l lx ly"># use sed or manual replace catcat.io-0001 to catcat.io via nano<br/>nano /etc/letsencrypt/renewal/catcat.io.conf</span><span id="d3dd" class="lt lu iq lp b gy ma lw l lx ly"># OR via command line (do backup first)<br/>sed -e "s|catcat.io-0001|catcat.io|g" /etc/letsencrypt/renewal/catcat.io.conf &gt; /etc/letsencrypt/renewal/catcat.io.conf</span></pre><p id="0ee8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我选择#2来保持目录名的整洁。确保<strong class="kf ir"> NGINX </strong>配置中的任何子域都指向新的SSL证书。</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="0785" class="lt lu iq lp b gy lv lw l lx ly">nano /etc/nginx/conf.d/default.conf</span></pre><p id="9fd5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">确保这两个存在并且正确</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="9579" class="lt lu iq lp b gy lv lw l lx ly">ssl_certificate /etc/letsencrypt/live/catcat.io/fullchain.pem;<br/>ssl_certificate_key /etc/letsencrypt/live/catcat.io/privkey.pem;</span></pre><p id="43a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后重启<strong class="kf ir"> NGINX </strong>，你应该得到子域TLS工作！耶！</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="a305" class="lt lu iq lp b gy lv lw l lx ly">service nginx restart</span></pre><figure class="lk ll lm ln gt jr gh gi paragraph-image"><a href="https://levelup.gitconnected.com/"><div class="gh gi nm"><img src="../Images/439094b9a664ef0239afbc4565c6ca49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9uYu-fFL3hIQLGVu0o-EQ.png"/></div></a></figure></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><h2 id="0acf" class="lt lu iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">喜欢这个教程吗？下面支持！:D</h2><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="ff27" class="lt lu iq lp b gy lv lw l lx ly">XLM : GDI6FBVJSHMF5PF6C7DDM57NAGYTYWMQQW2A6BVA6DTS2ZL7ZDRZBI2S<br/>ETH : 0x3E84004C41786CdC409F9355E6eF133f70907Da1</span></pre></div></div>    
</body>
</html>