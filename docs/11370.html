<html>
<head>
<title>Behavior Parameterization in Java and Spring with lambdas, streams, and functional interfaces</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用lambdas、streams和函数接口实现Java和Spring中的行为参数化</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/behavior-parameterization-pattern-in-java-with-lambdas-streams-and-functional-interfaces-99ff6eafaba6?source=collection_archive---------2-----------------------#2022-03-11">https://levelup.gitconnected.com/behavior-parameterization-pattern-in-java-with-lambdas-streams-and-functional-interfaces-99ff6eafaba6?source=collection_archive---------2-----------------------#2022-03-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8a17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">利用Java和Spring中的函数式编程实现灵活性。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/7328786c532f0347fa4d7e66dad512d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*KHJH7IEt9ip2xXphBrC2_w.png"/></div></figure><blockquote class="kt ku kv"><p id="254e" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">代码可以在<a class="ae la" href="https://github.com/pedroluiznogueira/medium-behavior-parameterization" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p><p id="9e6b" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">我们的目标</p></blockquote><p id="7085" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们将讨论如何基于一些业务规则，使用Java中的函数式编程，通过lambdas、streams和函数接口，实现<strong class="jp ir"> <em class="kw">行为参数化</em> </strong>，来实现编码的灵活性。</p><blockquote class="kt ku kv"><p id="4adf" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">定义</p></blockquote><p id="4001" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kw">行为参数化</em> </strong>是一种让你处理频繁需求变更的模式，这是一个非常常见的问题，项目的需求发生了变化。</p><p id="78a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基本上，我们将把一段代码作为一个参数传递给一个方法，如果你用不同的实现来传递它，这可以提供灵活性。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><blockquote class="kt ku kv"><p id="5de6" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">实施</p></blockquote><p id="c66f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的想法是发展一个特定的已实现的业务逻辑，以便它可以更灵活地适应不断变化的需求。我们将从“最差”的方法开始，并尝试改进它。</p><blockquote class="kt ku kv"><p id="93af" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">商业规则</p></blockquote><p id="a73f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">想象一下，我们有一个糖果厂，生产各种各样的糖果。在我们的领域，我们将只与蛋糕和巧克力合作。</p><p id="606a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的客户要求的功能之一是<strong class="jp ir">过滤某种类型的巧克力。</strong></p><p id="a99f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，如果一周后他决定我们需要<strong class="jp ir">也根据重量过滤巧克力</strong>呢？然后下周他要求我们用完全不同的逻辑过滤任何种类的糖果。你明白了。</p><p id="78b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有几种方法可以处理这个问题，但是我们要看看如何使用<strong class="jp ir"> <em class="kw">行为参数化来处理它。</em> </strong></p><blockquote class="kt ku kv"><p id="81bd" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">该项目</p></blockquote><p id="1b71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用最简单的spring api，因此我们可以运行一些单元测试来证明一切都按预期运行。</p><ol class=""><li id="1082" class="li lj iq jp b jq jr ju jv jy lk kc ll kg lm kk ln lo lp lq bi translated">在<a class="ae la" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank"> start.spring.io </a>上生成</li></ol><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/6933f362a57f472d25c4ec6b480b3fdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuwNzy3YIQZCzBzeVbEQvg.png"/></div></div></figure><blockquote class="kt ku kv"><p id="fc0f" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">领域</p></blockquote><p id="9f5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">糖果</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="fa10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">巧克力</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="d844" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">蛋糕</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><blockquote class="kt ku kv"><p id="fd03" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">要求</p></blockquote><p id="c26e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“从给定的巧克力列表中过滤所有的苦巧克力”。</p><h1 id="fc45" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第一种方法:为每个需求创建一个方法</h1><p id="db13" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated"><strong class="jp ir">巧克力服务</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="181a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们创建一个单元测试来检查它是否有效。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="e840" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，正如预期的那样，我们能够将<strong class="jp ir"> mockedChocos </strong>列表过滤为只包含苦巧克力的列表。</p><p id="4e8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题很明显，如果现在我们需要过滤所有的黑巧克力呢？一个解决方案是为它创建另一个方法，并且你知道它在哪里结束…</p><h1 id="034c" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第二种方法:参数化类型</h1><p id="c76d" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated"><strong class="jp ir">巧克力服务</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="dc13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它工作了。现在我们可以灵活地传递不同类型的巧克力，它们将被动态地用来过滤列表。</p><p id="6b84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，如果现在客户希望我们也根据重量来过滤巧克力呢？</p><h1 id="fc22" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第三种方法:按任意属性过滤</h1><p id="f3e8" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">我们可以创建另一个参数化的方法，现在根据巧克力的重量进行过滤。</p><p id="4316" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们甚至可以创建一个方法来处理这两者。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="f014" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它工作得很好，完成了工作，但是现在我们必须创建另一个方法来处理更改，并且我们通过使用<strong class="jp ir">filterChocolatesByAnyAttribute()</strong>方法造成了整个混乱。</p><p id="40e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每当我们编写类似的代码时，都是思考抽象的好时机。</p><h1 id="10c7" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第四种方法:抽象过滤</h1><p id="22a7" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">来自Stream API的filter方法接收一个谓词<t>作为参数，这意味着无论传递给它什么lambda表达式，都必须遵循谓词<t>函数接口拥有的单一抽象方法。</t></t></p><p id="f6a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kw">函数接口是具有单一抽象方法的接口。</em></p><p id="550e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以创建一个实现谓词<t>并使用单一抽象方法的类。</t></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="5504" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法提供了什么灵活性？现在我们可以传递不同的谓词实现类，例如，WhiteChocolateFilter <t>，但是我们仍然会在每次需求改变时创建类。</t></p><h1 id="bc48" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第五种方法:使用匿名类过滤</h1><p id="9974" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">我们也可以使用匿名类</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="6ed5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是这是一个非常冗长的方法。</p><h1 id="bbac" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第六种方法:用lambdas直接过滤传递函数接口实现</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="65f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，定义我们将要使用的过滤类型的将是lambda表达式本身，仅在调用方法时传递。</p><p id="8c0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它提供了巨大的灵活性，所以如果需求改变，我们不需要创建类，创建其他方法。</p><h1 id="065c" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第七种方法:实现行为参数化提供的灵活性</h1><p id="6fa1" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">我们将创建一个<strong class="jp ir"> CandyService </strong>，它将处理任何类型的蜡烛过滤，而不需要知道它是什么类型的蜡烛。</p><p id="0bcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> CandyService </strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="a64d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们调用时，<strong class="jp ir"> filter() </strong>方法将只知道它必须使用哪种类型的糖果。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="694f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，使用lambdas我们可以指定不同的过滤逻辑，而不必编写锅炉板代码，并重用每个糖果都可以使用的过滤方法。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="6c1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章到此为止，如果它在某些方面帮助了你，请为它鼓掌。</p><p id="46de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里找到该项目的github repo <a class="ae la" href="https://github.com/pedroluiznogueira/medium-behavior-parameterization" rel="noopener ugc nofollow" target="_blank">。如果你喜欢，可以考虑在github上主演。</a></p><p id="96e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也可以在github上随意投稿或提出建议。</p></div></div>    
</body>
</html>