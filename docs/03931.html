<html>
<head>
<title>Introduction to MotionLayout on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android上的MotionLayout简介</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/introduction-to-motionlayout-on-android-f16420d42459?source=collection_archive---------10-----------------------#2020-06-02">https://levelup.gitconnected.com/introduction-to-motionlayout-on-android-f16420d42459?source=collection_archive---------10-----------------------#2020-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8e32" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">想要在Android应用程序中让一些东西移动和移动吗？这里有一个快速的操作方法，包括示例动画。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/63cb56b6ba12700e9685287cb52d5f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEWG30REwBskCUjX_KYn0g.jpeg"/></div></div></figure><p id="df66" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我们将浏览一下<a class="ae lq" href="https://developer.android.com/reference/androidx/constraintlayout/motion/widget/MotionLayout" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> MotionLayout </strong> </a>的一些基本信息，motion layout是<a class="ae lq" href="https://developer.android.com/training/constraint-layout" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> ConstraintLayout </strong> </a>的子类。Android开发人员用它来在他们的应用程序中创建动作和小部件动画。我们计划描述创建这些动画所需的构件。通过一个例子，我们将强调最重要的步骤。最后会列出有用的链接，以及更多的信息和例子。</p><h1 id="0d47" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">介绍</h1><p id="c8e1" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">如<a class="ae lq" href="https://developer.android.com/training/constraint-layout/motionlayout" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">文档</strong> </a>所述:</p><blockquote class="mo"><p id="da47" class="mp mq it bd mr ms mt mu mv mw mx lp dk translated"><em class="my"> MotionLayout是一种布局类型，可帮助您管理应用程序中的运动和小部件动画。它是ConstraintLayout的子类，构建于其丰富的布局功能之上。</em></p></blockquote><p id="6e50" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">所以，它真的很强大，它有很大的潜力，但它只对它的直系子孙有效。它不支持嵌套的布局层次结构或活动转换，这一点应该考虑在内。</p><p id="9f9e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">MotionLayouts的一些关键特性是:描述布局之间的过渡，动画显示布局属性，支持可查找的过渡和自定义过渡的关键帧。最后，它是完全声明性的，它的任何转换都可以在XML文件中描述。</p><p id="7844" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">由于MotionLayout是<strong class="kw iu"> ConstraintLayout </strong>的扩展，它继承了它的所有特性，您需要将以下依赖项添加到您的应用程序的<strong class="kw iu"> build.gradle </strong>:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="3e9c" class="nj ls it nf b gy nk nl l nm nn">dependencies {<br/>    implementation 'androidx.constraintlayout:constraintlayout:2.0.0-beta4'<br/>}</span></pre><p id="443c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者这个，如果你没有使用AndroidX:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="981a" class="nj ls it nf b gy nk nl l nm nn">dependencies {<br/>    implementation 'com.android.support.constraint:constraint-layout:2.0.0-beta4'<br/>}</span></pre><p id="2088" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果将MotionLayout添加到布局文件中，您会注意到<strong class="kw iu"> Android Studio </strong>(我使用的是Android Studio 4.0 Beta 3)报错如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/7473c119c51c39be87b2aedd837a0ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYI6joxBtnnhGE2-5LLH5Q.png"/></div></div></figure><p id="5d17" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这里，您可以点击<strong class="kw iu">生成运动场景</strong>文件按钮，一个运动场景文件就会为您生成。我将我的布局文件命名为<strong class="kw iu"> motion_layout.xml </strong>，生成的文件命名为<strong class="kw iu">motion _ layout _ scene . XML</strong>(可以在<strong class="kw iu"> res/xml </strong>文件夹中找到)。布局文件现在如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/9ca970f204899bd92902630376283b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBI0I-F0IEhCiO9C8aAE7A.png"/></div></div></figure><p id="45ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">生成的<strong class="kw iu">motion _ layout _ scene . XML</strong>是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/1ccc84c1fe7962777feeb2bd3550cf34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JhrCHGWKWWXykb2nTfDHzA.png"/></div></div></figure><p id="1af9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> MotionScene </strong>是一个运动场景文件的根元素，用于以<strong class="kw iu">声明的方式</strong>创建动画。同一个<strong class="kw iu"> MotionScene </strong>文件可以重复使用并应用于不同的布局。</p><p id="c184" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> ConstraintSet </strong>元素为您想要在运动序列中制作动画的每个<strong class="kw iu">视图</strong>提供了定义。</p><p id="8b57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">约束</strong>元素指定运动序列中单个<strong class="kw iu">视图</strong>的属性和位置。</p><p id="618a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">过渡</strong>至少包含开始和结束<strong class="kw iu">约束集</strong>，它描述了从开始到结束状态的变化。它可以包含<strong class="kw iu"> OnClick </strong>、<strong class="kw iu">on switch</strong>和<strong class="kw iu"> KeyFrameSet </strong>元素。</p><p id="e43f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">关于提到的元素的更多信息可以在官方<a class="ae lq" href="https://developer.android.com/training/constraint-layout/motionlayout/ref" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">文档</strong> </a>中找到。</p><p id="b354" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是，足够的理论，让我们看看我们的例子！</p><h1 id="2243" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">示例动画</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/5bbe292f261a148926ffa9d5356a4620.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/1*T-_Rl68wrF3OPkOvZtUMuw.gif"/></div></figure><p id="516e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请随意查看下面的Github repo源代码。</p><div class="ns nt gp gr nu nv"><a href="https://github.com/dfodor/MotionLayoutSample" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">dfodor/MotionLayoutSample</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">在Android上使用MotionLayout的示例动画。-d fooder/MotionLayoutSample</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div><p id="9166" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的布局文件<strong class="kw iu">activity _ music _ band _ list . XML</strong>具有以下层次结构:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/c87fec55143903caacb6dc84faf54074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFVZYeLovpm-Wh6yRAy7Uw.png"/></div></div></figure><p id="286c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这里，您可以看到一个父级<strong class="kw iu"> MotionLayout </strong>和两个子级<strong class="kw iu"> RecyclerView </strong>和另一个<strong class="kw iu"> MotionLayout </strong>，包含将被动画化的视图。父<strong class="kw iu"> MotionLayout </strong>的目的是通过运动场景文件控制其子对象的可见性。</p><p id="c76d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们深入研究动画实现之前，我想提一下这是一个多步动画。<strong class="kw iu"> MotionLayout </strong>目前没有用于受控多步过渡的API。由于我有4个<strong class="kw iu">约束集</strong>并需要处理3个过渡，我必须以编程方式开始一些过渡。对于更复杂的过渡，有更多的步骤，你可以看到克里斯·贝恩斯写的一篇<a class="ae lq" href="https://medium.com/androiddevelopers/suspending-over-views-example-260ce3dc9100" rel="noopener"> <strong class="kw iu">文章</strong> </a>。</p><p id="1072" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当<strong class="kw iu"> RecyclerView </strong>项被点击时，我们调用<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/java/com/dfodor/motionlayout/sample/MusicBandListActivity.kt" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">musicbandlistativity</strong></a>中定义的<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/java/com/dfodor/motionlayout/sample/MusicBandListActivity.kt#L92...#L132" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> animate </strong> </a>方法。</p><p id="4de9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> vhValues </strong>参数是一个带有两个方法的接口，这两个方法通过使用<strong class="kw iu"> ConstraintSet </strong>提供定位视图所需的信息。</p><p id="d94f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> musicBandModel </strong>代表被点击的<strong class="kw iu"> RecyclerView </strong>项目的POJO。</p><p id="0a43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我们需要用来自接口参数的值修改视图的边距:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="c401" class="nj ls it nf b gy nk nl l nm nn">private fun animate(<br/>    vhValues: MusicBandAdapter.ViewHolderValues,<br/>    musicBandModel: MusicBandModel) {<br/><br/>    val marginTop = <br/>        (vhValues.getThumbnailHeight() * SCALE).toInt() - (iconSize * SCALE / 2).toInt() - margin<br/><br/>    animatedView.also {<br/>        var set = it.getConstraintSet(firstSet)<br/>        set.setMargin(R.id.thumbnail, ConstraintSet.TOP, vhValues.getY())<br/>        set.setVisibility(R.id.thumbnail, ConstraintSet.VISIBLE)<br/>        set.setMargin(R.id.more_info, ConstraintSet.TOP, marginTop)<br/>        set.applyTo(it)<br/><br/>        set = it.getConstraintSet(secondSet)<br/>        set.setMargin(R.id.more_info, ConstraintSet.TOP, marginTop)<br/>        set.applyTo(it)<br/><br/>        set = it.getConstraintSet(thirdSet)<br/>        set.setMargin(R.id.more_info, ConstraintSet.TOP, marginTop)<br/>        set.setMargin(R.id.about_container, ConstraintSet.TOP, marginTop)<br/>        set.applyTo(it)<br/>        // ...<br/>    }<br/>}</span></pre><p id="8361" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">动画视图</strong>代表子视图<strong class="kw iu"> MotionLayout </strong>，包含所有将被动画化的视图。<strong class="kw iu">第一组</strong>、<strong class="kw iu">第二组</strong>、<strong class="kw iu">第三组</strong>是<strong class="kw iu">约束组</strong>的id。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="ac72" class="nj ls it nf b gy nk nl l nm nn">private val firstSet = R.id.first_set<br/>private val secondSet = R.id.second_set<br/>private val thirdSet = R.id.third_set</span></pre><p id="ef0e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它们在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">animated _ music _ band _ item _ scene . XML</strong></a>中定义。</p><p id="9d16" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">之后，我们需要将数据设置为动画视图，设置转换监听器，启动父动画以隐藏<strong class="kw iu"> RecyclerView </strong>，并显示子动画<strong class="kw iu"> MotionLayout </strong>。下面是代码:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="d9fb" class="nj ls it nf b gy nk nl l nm nn">private fun animate(<br/>    vhValues: MusicBandAdapter.ViewHolderValues,<br/>    musicBandModel: MusicBandModel) {<br/><br/>    animatedView.also {<br/>    	// ...<br/>        with(binding) {<br/>            thumbnail.background =<br/>            ContextCompat.getDrawable(this@MusicBandListActivity, musicBandModel.drawableId)<br/>            name.text = getString(musicBandModel.name)<br/>            tags.text = getString(musicBandModel.tags)<br/>            description.text = getString(musicBandModel.shortDescriptionStringRes)<br/>            aboutText.text = getString(musicBandModel.aboutStringRes)<br/><br/>            it.setTransitionListener(transitionAdapter)<br/><br/>            root.transitionToEnd()<br/>            it.setTransition(firstSet, secondSet)<br/>            it.setTransitionDuration(ANIMATION_DURATION)<br/>            it.transitionToState(secondSet)<br/>            activeSet = ConstraintSetState.FIRST_TO_SECOND<br/>        }<br/>    }<br/>}</span></pre><p id="e376" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">活动集</strong>是一个<strong class="kw iu">约束集状态</strong>类型，它是一个帮助我们跟踪哪个<strong class="kw iu">约束集</strong>将是下一个或前一个的枚举。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="1889" class="nj ls it nf b gy nk nl l nm nn">private enum class ConstraintSetState {<br/>    FIRST_TO_SECOND,<br/>    SECOND_TO_THIRD,<br/>    SECOND_TO_FIRST,<br/>    THIRD_TO_SECOND<br/>}</span></pre><p id="8c22" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你会注意到<strong class="kw iu">根</strong>动画是通过使用<strong class="kw iu"> transitionToEnd </strong>()方法启动的，该方法只有两个<strong class="kw iu">约束集</strong>→<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/activity_music_band_list_scene.xml" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">activity _ music _ band _ list _ scene . XML</strong></a>。<strong class="kw iu">动画视图</strong>上的动画却没有。这是因为我们有一个多步动画，我们必须手动设置过渡。</p><p id="4397" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">由于MotionScene文件中有相当多的XML代码，我不想在这里复制粘贴，您可以打开<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">animated _ music _ band _ item _ scene . XML</strong></a>并检查所有<strong class="kw iu">约束集</strong>和<strong class="kw iu">过渡</strong>。</p><p id="1577" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L278...#L290" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">第一次过渡</strong></a>(<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L5...#L35" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">first set</strong></a>→<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L37...#L104" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">secondSet</strong></a>)之后，屏幕看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/099c95aa0d809525fc593547a94a69db.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*pzMVXVRR87lT3l2aNr4BBw.png"/></div></figure><p id="9cab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L5...#L35" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">中首先_设置</strong> </a>，我们正在定位视图，设置缩略图尺寸比例和缩放比例。比例需要重置，因为我们希望在动画从头到尾运行时使用初始比例。实际比例从帧位置80开始应用(在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L278...#L290" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">过渡</strong> </a>块中定义)。我们还通过设置它的<strong class="kw iu"> alpha </strong>和<strong class="kw iu"> visibility </strong>值来隐藏返回箭头。在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L37...#L104" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">秒_设置</strong> </a>中，我们必须再次设置刻度类型，这样它才不会丢失。我们还需要通过改变其他视图的<strong class="kw iu"> alpha </strong>值来隐藏它们。</p><p id="762f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当第一个过渡完成后，我们立即准备开始第二个过渡(<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L37...#L104" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">secondSet</strong></a>→<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L106...#L211" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">thirdSet</strong></a>)在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/java/com/dfodor/motionlayout/sample/MusicBandListActivity.kt#L55...#L81" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">on transition completed</strong></a>回调中。这将导致以下屏幕:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/34130d27c542a8ce278ed5d9239291be.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*8vW6z2FCJJglUJwb5Evm-A.png"/></div></figure><p id="a412" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们从<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L37...#L104" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">第二组</strong> </a>开始，在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L106...#L211" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">第三组</strong> </a>中，我们在控制动画从结束状态执行到开始状态的情况下，使视图可见。在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L292...#L309" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">过渡</strong> </a>块内，<strong class="kw iu"> OnClick </strong>动作用于在第二组和第三组之间切换。</p><p id="0287" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">动画的最后一步完全在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L213...#L276" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">运动场景</strong> </a>文件中定义，因为我们可以在用户点击视图时选择动作。在我们的场景中，我们在<a class="ae lq" href="https://github.com/dfodor/MotionLayoutSample/blob/master/app/src/main/res/xml/animated_music_band_item_scene.xml#L311...#L346" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu"/></a>中又有一个<strong class="kw iu"> OnClick </strong>动作，它为我们处理开始和结束状态。还有一个<strong class="kw iu">关键帧集</strong>元素，它包含用于在过渡期间更改特定视图的<strong class="kw iu"> alpha </strong>值的<strong class="kw iu"> KeyAttribute </strong>元素。属性<strong class="kw iu"> app:framePosition </strong>可以保存0到100之间的任何值。另一个有用的类是<strong class="kw iu"> ImageFilterView </strong>，在我们的例子中，它通过其<strong class="kw iu"> crossfade </strong>属性在两个图像之间制作动画。</p><p id="66c1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">屏幕现在看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f08050c948ed0ded14296c17b4321e4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*kgeybhXf2sCxydHij7GjOw.png"/></div></figure><h1 id="b001" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">结论</h1><p id="bfd0" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">本文提供了一些关于<strong class="kw iu"> MotionLayout </strong>的一般信息，以及一个将所有部分放在一起的示例动画。尽管它仍处于测试阶段，但这并不妨碍我们创作出漂亮的动画。如果你想了解更多关于<strong class="kw iu"> MotionLayout </strong>的信息，这里有一些资源:</p><ul class=""><li id="4745" class="ol om it kw b kx ky la lb ld on lh oo ll op lp oq or os ot bi translated"><a class="ae lq" href="https://medium.com/google-developers/introduction-to-motionlayout-part-i-29208674b10d" rel="noopener"><strong class="kw iu">《motion layout导论(第一部分)】</strong> </a>尼古拉斯·罗阿德著</li><li id="7e8c" class="ol om it kw b kx ou la ov ld ow lh ox ll oy lp oq or os ot bi translated"><a class="ae lq" href="https://medium.com/google-developers/introduction-to-motionlayout-part-ii-a31acc084f59" rel="noopener"><strong class="kw iu">【motion layout导论(第二部分)</strong> </a>尼古拉斯·罗德著</li><li id="0e7f" class="ol om it kw b kx ou la ov ld ow lh ox ll oy lp oq or os ot bi translated"><a class="ae lq" href="https://medium.com/google-developers/introduction-to-motionlayout-part-iii-47cd64d51a5" rel="noopener"><strong class="kw iu">【motion layout导论(第三部分)</strong> </a>尼古拉斯·罗阿尔著</li><li id="bbdc" class="ol om it kw b kx ou la ov ld ow lh ox ll oy lp oq or os ot bi translated"><a class="ae lq" href="https://medium.com/google-developers/defining-motion-paths-in-motionlayout-6095b874d37" rel="noopener"> <strong class="kw iu">在Nicolas Roard的MotionLayout </strong> </a>中定义运动路径</li><li id="5893" class="ol om it kw b kx ou la ov ld ow lh ox ll oy lp oq or os ot bi translated"><a class="ae lq" href="https://proandroiddev.com/complex-ui-animations-on-android-featuring-motionlayout-aa82d83b8660" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">Android上复杂的UI/动画——以Nikhil Panju的MotionLayout </strong> </a>为特色</li><li id="b70b" class="ol om it kw b kx ou la ov ld ow lh ox ll oy lp oq or os ot bi translated"><a class="ae lq" href="https://www.youtube.com/watch?v=TcKGOxsrxCM" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">做运动布局:用运动布局</strong> </a>制作动画</li><li id="3e6d" class="ol om it kw b kx ou la ov ld ow lh ox ll oy lp oq or os ot bi translated">杰森·皮尔森<a class="ae lq" href="https://www.droidcon.com/media-detail?video=362742385" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">高级&amp;实用动作布局</strong> </a></li><li id="2fa0" class="ol om it kw b kx ou la ov ld ow lh ox ll oy lp oq or os ot bi translated"><a class="ae lq" href="https://developer.android.com/training/constraint-layout/motionlayout" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">官方文档</strong> </a></li></ul><p id="bb6f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望你在这篇文章中学到了一些新的东西。欢迎在下面发表任何问题或评论，或者通过<a class="ae lq" href="mailto:denis@arsfutura.co" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">denis@arsfutura.co</strong></a>联系我。干杯！</p><p id="c82d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最初发布于:</p><div class="ns nt gp gr nu nv"><a href="https://arsfutura.com/magazine/introduction-to-motionlayout-on-android" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">Android上的MotionLayout简介</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">想要在Android应用程序中让一些东西移动和移动吗？这里有一个快速的操作方法，包括示例动画。在这个…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">arsfutura.com</p></div></div><div class="oe l"><div class="oz l og oh oi oe oj ks nv"/></div></div></a></div><p id="7727" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">特别感谢<a class="pa pb ep" href="https://medium.com/u/8e1de1491ab4?source=post_page-----f16420d42459--------------------------------" rel="noopener" target="_blank">莉娅·梅特里奇</a>、<a class="pa pb ep" href="https://medium.com/u/ab14918cee6d?source=post_page-----f16420d42459--------------------------------" rel="noopener" target="_blank">安东尼娅·戈利奇</a>、乔西普·格鲁贝萨</p></div></div>    
</body>
</html>