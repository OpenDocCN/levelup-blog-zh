<html>
<head>
<title>Moduliths in Angular with Nx</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以Nx为单位的角度模数</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/moduliths-in-angular-with-nx-b8b0076794fb?source=collection_archive---------1-----------------------#2022-07-15">https://levelup.gitconnected.com/moduliths-in-angular-with-nx-b8b0076794fb?source=collection_archive---------1-----------------------#2022-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fbf8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用DDD和Monorepos创建可持续应用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c31b185997760b5915143e8bf23ff925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e4H8VpkNtkZd1xQQ.png"/></div></div></figure><h2 id="0a9f" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">整体建筑与微型建筑</h2><p id="2439" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated"><a class="ae mj" href="https://medium.com/stepstone-tech/microfrontends-extending-service-oriented-architecture-to-frontend-development-part-1-120b71c87b68" rel="noopener"> <strong class="ls iu"> <em class="mk">微前端</em> </strong> </a> <strong class="ls iu"> <em class="mk"> </em> </strong>几乎是新的趋势，围绕它有很大的炒作，因为它是一种很酷的技术，有自己的优势，如独立部署。通常，缺点没有被提及，而最令人担忧的缺点是复杂性增加，因此这种架构不应该被考虑用于许多应用。</p><p id="a19e" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">选择微前端架构背后的原因通常不是技术决策，而是拥有许多前端团队、希望独立工作的大公司的组织决策。</p><p id="b954" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">这就是为什么大多数人坚持使用通常的monolith，所有的模块和特性都在一个应用程序中。虽然它被描绘成老派，但对于大多数应用程序来说，它仍然是一个非常有效的架构，因为复杂性非常低，因此上市速度非常快。常见的主要缺点是，它没有强制任何边界，从长远来看会导致软件不稳定，难以维护和扩展。</p><p id="cfdd" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">有许多设计原则可以用来防止这种情况，其中之一是<strong class="ls iu"> Modulith </strong>，它将两者的优点结合在一起。</p><h2 id="240e" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">领域驱动设计</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/9fa3574cfef928f1911180a51d3578a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciJXzZ5UdBjgs1xCaBXTUw.png"/></div></div></figure><p id="fb1c" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">模块化是基于被称为领域驱动设计的基本设计原则，这是关于设计独立的全功能特性仓——我们称之为领域。如果我们以Medium为例，我们可以怀疑我们至少拥有以下领域:<em class="mk">博客创建、计费、统计、用户订阅、通知/消息传递等。，… </em>。它试图将不同域之间的依赖性降低到最小，因此最佳场景是没有域与另一个域有任何依赖性。通常情况下，情况并不总是这样，但是通过共享内核或独特的API限制等模式，我们可以将依赖性降低到最小。</p><p id="e114" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">这样，如果有足够的资源可用，我们可以将团队分配到域中。否则，DDD仍然是一个很好的遵循原则，因为关注点严格分离的基本原则使得软件本身更加稳定，因为域没有(或者只有很少)依赖于其他域。因此，我们可以扩展一个域，而不用担心应用程序的某个完全不同的部分出现问题。</p><h2 id="8ca3" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">模数</h2><p id="4dd6" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">一个模块是基于DDD的，这样它就把一个经典的整体分割成多个区域。这些域不会直接在应用程序本身中实现，而是每个域将成为一个角度库，然后由应用程序使用。</p><p id="a64c" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">就像微前端架构一样，我们有不同的域/库，它们划分了清晰的边界，因此有助于更稳定的软件。但是我们没有微前端的复杂性，因为不是在不同的微前端中使用库，而是在一个应用程序中使用所有的库。</p><p id="0985" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">简单来说，模块有清晰的边界，就像DDD方式的微前端架构，但整体结构的复杂度更低。</p><h2 id="f422" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">（同nonexpendable）非消耗品</h2><p id="3894" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">Angular作为前端框架，不过说实话，这个例子中真正的英雄是<strong class="ls iu"> Nx </strong>。以前没听说过Nx？基本上，Nx在Angular CLI的基础上提供了额外的工具来创建和管理monorepositories，它将各种应用程序和库保存在一个库中，只有一个package.json。这意味着每个库和应用程序都依赖于相同版本的包，因此版本不匹配是不可能的。此外，你不必将你的库发布到NPM注册表中，并安装到应用程序中，而是可以在Nx的帮助下直接引用它们。已经听起来不错了？准备好迎接更多的美好吧。</p><h2 id="d4d6" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><a class="ae mj" href="https://www.npmjs.com/package/@angular-architects/ddd" rel="noopener ugc nofollow" target="_blank">@ angular-architect</a>s<a class="ae mj" href="https://www.npmjs.com/package/@angular-architects/ddd" rel="noopener ugc nofollow" target="_blank">/DDD</a>套餐</h2><p id="9e03" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">Angular Architects提供了一个非常好的示意图包，它不仅帮助我们跟踪DDD，还给了我们实施它的可能性。首先，我们进行传统的域切片，并在<em class="mk"> libs </em>文件夹中为每个域创建一个文件夹。但是我们并没有就此止步，相反，我们还通过深入研究<strong class="ls iu">特性</strong>、<strong class="ls iu"> UI </strong>、<strong class="ls iu">域</strong>和<strong class="ls iu">实用程序</strong>，在域内部划分出不同的界限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/7b952f0c0b6106ae32e9b61a04d1239c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lwkuinHov0grRkqswKKNg.png"/></div></div></figure><p id="e749" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">智能组件被认为是特性，而非智能组件被认为是UI。状态管理、服务和后端通信和逻辑通常包含在域中。Utils将包含相当经典的独立JavaScript助手函数，如createUuid()、parseSomeDate()等。</p><p id="9929" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">但这还不是全部！如果我们使用@ angular-architects/DDD schematics，那么每个特性、UI、域和实用程序都将是一个单独的库。为什么这样因为这样一来，标签可以添加到<em class="mk"> project.json </em>文件中，我们可以在林挺配置中使用这些标签来创建水平和垂直限制。这意味着我们不仅可以限制域A和B之间的访问，而且我们还可以在域内部进行限制，因为我们将一个域分成了多个子库。</p><ul class=""><li id="8d29" class="ms mt it ls b lt ml lw mm ld mu lh mv ll mw mi mx my mz na bi translated"><strong class="ls iu"> Utils </strong>可以依靠<strong class="ls iu">一无所有</strong></li><li id="4619" class="ms mt it ls b lt nb lw nc ld nd lh ne ll nf mi mx my mz na bi translated"><strong class="ls iu">域</strong>可以依赖<strong class="ls iu">工具</strong></li><li id="2ff2" class="ms mt it ls b lt nb lw nc ld nd lh ne ll nf mi mx my mz na bi translated"><strong class="ls iu"> UI </strong>可以依赖<strong class="ls iu">域</strong>，<strong class="ls iu">实用程序</strong></li><li id="75a3" class="ms mt it ls b lt nb lw nc ld nd lh ne ll nf mi mx my mz na bi translated"><strong class="ls iu">功能</strong>可以依赖<strong class="ls iu"> UI </strong>、<strong class="ls iu">域</strong>、<strong class="ls iu">实用工具</strong></li></ul><h2 id="e9f9" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">林挺规则</h2><p id="062f" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在文件<em class="mk"> .eslintrc.json </em>中，我们现在可以使用库上指定的标签来创建林挺规则的限制。幸运的是，当我们使用schematics创建库时,@angular-architects/ddd包可以处理所有这些问题。</p><p id="9d2b" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">在<em class="mk"> depConstraints </em>数组中，依赖关系被明确指定如下:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="88c5" class="ku kv it nh b gy nl nm l nn no">...<br/>{</span><span id="63d9" class="ku kv it nh b gy np nm l nn no">   “sourceTag”: “domain:domainA”,</span><span id="7c24" class="ku kv it nh b gy np nm l nn no">   “onlyDependOnLibsWithTags”: [</span><span id="9c68" class="ku kv it nh b gy np nm l nn no">      “domain:domainA”,</span><span id="ec8b" class="ku kv it nh b gy np nm l nn no">      “domain:shared”</span><span id="2891" class="ku kv it nh b gy np nm l nn no">   ]</span><span id="bb1c" class="ku kv it nh b gy np nm l nn no">}, <br/>...<br/>{</span><span id="f5b7" class="ku kv it nh b gy np nm l nn no">   "sourceTag": "type:feature",</span><span id="ff84" class="ku kv it nh b gy np nm l nn no">   "onlyDependOnLibsWithTags": [</span><span id="4571" class="ku kv it nh b gy np nm l nn no">      "type:ui",</span><span id="6ae0" class="ku kv it nh b gy np nm l nn no">      "type:domain-logic",</span><span id="a8a1" class="ku kv it nh b gy np nm l nn no">      "type:util"</span><span id="e40d" class="ku kv it nh b gy np nm l nn no">    ]</span><span id="3964" class="ku kv it nh b gy np nm l nn no">},</span><span id="dd29" class="ku kv it nh b gy np nm l nn no">...</span></pre><h2 id="67c8" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">现实场景</h2><p id="ac4a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">理想情况下，所有域都应该完全隔离，彼此之间没有任何依赖关系，但这是不现实的。通常情况下，域A对域B内部的某些东西有一点依赖，如果我们知道如何处理这一点，这是完全没问题的。我们可以创建一个单独的桶来暴露域A的依赖性，或者创建一个共享内核，当我们担心循环依赖性时，这也是一个好方法。</p><p id="383f" class="pw-post-body-paragraph lq lr it ls b lt ml ju lv lw mm jx ly ld mn ma mb lh mo md me ll mp mg mh mi im bi translated">但是要注意，把所有东西都放在共享内核中会把你的应用程序变回一个经典的整体，破坏我们通过模块化设计获得的所有好处。因此，如果可能的话，创建多个共享内核，不要把所有的哑组件放在一个共享内核中。尽管哑组件不知道它们被使用的确切数据上下文，但是它们仍然可以知道它们被使用的域。</p><h2 id="5ab8" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">结论</h2><p id="12a9" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">模数非常适合许多架构。如果您想以一种清晰的方式构建您的应用程序，并通过林挺规则来加强边界，但不关心独立部署，那么modulith是一条不错的道路。如果你不喜欢DDD，你仍然可以通过使用Nx，单独的库和林挺规则来保护边界。否则我推荐使用<a class="ae mj" href="https://www.npmjs.com/package/@angular-architects/ddd" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">@ angular-architects/ddd</strong></a>包在你的Angular应用中跟随DDD。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h2 id="1aa0" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">通过我的推荐链接加入Medium:</h2><p id="2f33" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">如果你喜欢这篇博文，并想在Medium上无限阅读，如果你能使用我的推荐链接创建一个Medium订阅，我将不胜感激:</p><div class="nx ny gp gr nz oa"><a href="https://medium.com/@stefan.haas.privat/membership" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">通过我的推荐链接-斯特凡·哈斯加入媒体</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">阅读斯特凡·哈斯的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div><h2 id="9793" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">其他有趣的阅读:</h2><div class="nx ny gp gr nz oa"><a rel="noopener  ugc nofollow" target="_blank" href="/your-first-angular-microfrontend-58950768a465"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">角形微前端波导</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">这是一个关于如何创建一个简单的angular应用程序来使用另一个应用程序的模块的分步指南…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oj l"><div class="op l ol om on oj oo ks oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener  ugc nofollow" target="_blank" href="/refactoring-angular-applications-be18a7ee65cb"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">重构角度应用程序</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">重构是软件工程中最重要的技术之一，因为它是项目进行的唯一方式</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oj l"><div class="oq l ol om on oj oo ks oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener  ugc nofollow" target="_blank" href="/secure-frontend-authorization-67ae11953723"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">使用令牌处理程序模式的SPA身份验证</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">为单页应用程序构建安全认证过程的现代方法。</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oj l"><div class="or l ol om on oj oo ks oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener  ugc nofollow" target="_blank" href="/sustainable-future-proof-web-frontends-89ac5dd67dfb"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">可持续的(经得起未来考验的)网络前端</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">在这一点上，它已经成为一个公认的迷因，每隔几个月就会弹出一个新的JavaScript框架…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oj l"><div class="os l ol om on oj oo ks oa"/></div></div></a></div></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h2 id="f27f" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">更多关于DDD与棱角分明:</h2><div class="nx ny gp gr nz oa"><a href="https://www.angulararchitects.io/aktuelles/tactical-domain-driven-design-with-monorepos/" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">战术领域驱动的设计与角和Monorepos？-角形建筑</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">这篇文章是关于领域驱动设计的系列文章的一部分</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">www.angulararchitects.io</p></div></div><div class="oj l"><div class="ot l ol om on oj oo ks oa"/></div></div></a></div></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="16c9" class="ou kv it bd kw ov ow ox kz oy oz pa lc jz pb ka lg kc pc kd lk kf pd kg lo pe bi translated">分级编码</h1><p id="7ed6" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">感谢您成为我们社区的一员！更多内容见<a class="ae mj" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>。<br/>跟随:<a class="ae mj" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae mj" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>，<a class="ae mj" href="https://newsletter.levelup.dev/" rel="noopener ugc nofollow" target="_blank">迅</a> <br/>升一级就是转型科技招聘👉<a class="ae mj" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">加入我们的人才集体</strong> </a></p></div></div>    
</body>
</html>