<html>
<head>
<title>Localizing Your Chrome Extension: An Easy Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">本地化你的Chrome扩展:一个简单的教程</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/localizing-your-chrome-extension-an-easy-tutorial-b0892e225576?source=collection_archive---------4-----------------------#2020-11-26">https://levelup.gitconnected.com/localizing-your-chrome-extension-an-easy-tutorial-b0892e225576?source=collection_archive---------4-----------------------#2020-11-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/dd8a1b4383b171c824711c218e941ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5X65nyTv2LzUhScR0rbQAA.jpeg"/></div></div></figure><p id="b454" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">你也可以在我的个人博客</em> <a class="ae kx" href="https://shahednasserblog.tk/localizing-your-chrome-extension-an-easy-tutorial/" rel="noopener ugc nofollow" target="_blank"> <em class="kw">这里</em> </a> <em class="kw">查看这个帖子。</em></p><p id="c14c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本地化和国际化是为您的扩展获得更多用户的好方法。这里有一个简单的教程可以帮助你做到这一点。</p><p id="d7f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本教程假设你已经知道如何创建一个chrome扩展。如果没有，你可以前往我的 <a class="ae kx" href="https://shahednasserblog.tk/chrome-extension-tutorial-replace-images-in-any-website-with-pikachu/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">其他教程</strong> </a> <strong class="ka ir">了解如何做到这一点。</strong></p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="f382" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">步骤1:更改Manifest.json</h1><p id="6a53" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">在本地化您的扩展时，您需要选择一个默认的区域设置。这需要在<code class="fe mi mj mk ml b">manifest.json</code>文件中定义:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="2fa3" class="mu lg iq ml b gy mv mw l mx my">{<br/> ...<br/>    "default_locale": "en",<br/>    ...<br/>}</span></pre><p id="d192" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要添加一个新的键<code class="fe mi mj mk ml b">default_locale</code>,其值应该是您的扩展默认的区域设置。在上面的例子中，我们为英语选择了<code class="fe mi mj mk ml b">en</code>。</p><p id="c827" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以点击查看支持的地区列表<a class="ae kx" href="http://code.google.com/chrome/webstore/docs/i18n.html#localeTable" rel="noopener ugc nofollow" target="_blank">。如果你选择了一个不受支持的语言环境，Chrome会忽略它。</a></p><h1 id="7448" class="lf lg iq bd lh li mz lk ll lm na lo lp lq nb ls lt lu nc lw lx ly nd ma mb mc bi translated">步骤2:翻译字符串</h1><p id="afa3" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">接下来您需要做的是开始创建JSON文件，这些文件将在您的扩展中保存可本地化的字符串。</p><p id="c43d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要首先在您的扩展的根目录下创建目录<code class="fe mi mj mk ml b">locales</code>。然后，在该目录中，您将为每个地区创建一个文件夹，该文件夹将保存JSON文件以及每个地区的字符串翻译。例如，要添加英语地区<code class="fe mi mj mk ml b">en</code>的字符串翻译，您需要在<code class="fe mi mj mk ml b">_locales</code>中创建目录<code class="fe mi mj mk ml b">en</code>，然后在其中创建<code class="fe mi mj mk ml b">messages.json</code>。</p><p id="0232" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您不必为每种语言创建<code class="fe mi mj mk ml b">messages.json</code>文件，也不必翻译每种语言的所有字符串。唯一需要的是拥有默认区域设置的字符串。那么对于任何其他语言，如果消息没有被翻译成该语言环境，它将默认为默认语言环境中的字符串。</p><p id="9943" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，基于前面的例子，我们需要创建文件<code class="fe mi mj mk ml b">_locales/en/messages.json</code>并放置我们需要在整个扩展中翻译的字符串。</p><p id="d272" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">messages.json</code>文件的格式如下:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="8fcf" class="mu lg iq ml b gy mv mw l mx my">{<br/> "KEY": {<br/>     "message": "VALUE"<br/>    },<br/>    ...<br/>}</span></pre><p id="b792" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于您想要翻译的每个字符串，您需要指定<code class="fe mi mj mk ml b">KEY</code>，然后它的值将是一个带有键<code class="fe mi mj mk ml b">message</code>的对象，它的值将是这个区域设置中的字符串。</p><p id="154d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，如果我想添加字符串“Hello”:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="6078" class="mu lg iq ml b gy mv mw l mx my">{<br/> "greeting": {<br/>     "message": "Hello"<br/>    }<br/>}</span></pre><p id="e604" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我定义了键<code class="fe mi mj mk ml b">greeting</code>，它在英语地区的值是“Hello”。</p><p id="e26e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还可以添加可选键<code class="fe mi mj mk ml b">description</code>。只有当你想让其他人翻译你的字符串时，这才有帮助，你可以给他们一些关于何时使用这个消息或者应该如何翻译的上下文。</p><p id="8c41" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们想把一个不应该翻译的参数传递给翻译字符串呢？假设我想称呼用户的名字。例如，“你好，约翰”。</p><p id="a863" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要向字符串添加参数，字符串对象应该如下所示:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="a7df" class="mu lg iq ml b gy mv mw l mx my">{<br/> "greeting": {<br/>     "message": "Hello, $USERNAME$",<br/>        "placeholder": {<br/>         "username": {<br/>             "content": "$1"<br/>            }<br/>        }<br/>    }<br/>}</span></pre><p id="c183" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们是这样做的:</p><ol class=""><li id="3111" class="ne nf iq ka b kb kc kf kg kj ng kn nh kr ni kv nj nk nl nm bi translated">我们使用<code class="fe mi mj mk ml b">$USERNAME</code>作为<code class="fe mi mj mk ml b">message</code>中参数的名称</li><li id="3d9e" class="ne nf iq ka b kb nn kf no kj np kn nq kr nr kv nj nk nl nm bi translated">我们在<code class="fe mi mj mk ml b">greeting</code>对象中添加了一个新的键<code class="fe mi mj mk ml b">placeholder</code>。<code class="fe mi mj mk ml b">placeholder</code>是一个对象，其中有对象，键是消息中存在的参数的名称，每个对象的值都有定义参数值的键<code class="fe mi mj mk ml b">content</code>。</li><li id="3329" class="ne nf iq ka b kb nn kf no kj np kn nq kr nr kv nj nk nl nm bi translated">在内容中使用<code class="fe mi mj mk ml b">$1</code>意味着它将是传递给翻译函数的第一个参数(我们很快会谈到这一点)。该值可以是类似于<code class="fe mi mj mk ml b">$2</code>(第二个参数)、<code class="fe mi mj mk ml b">$3</code>(第三个参数)的东西，或者只是一个类似于“John”的字符串。如果翻译函数中没有传递值，<code class="fe mi mj mk ml b">$USERNAME</code>将被一个空字符串替换。</li></ol><p id="1a5c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">placeholder</code>中的每个对象也可以有一个可选键<code class="fe mi mj mk ml b">example</code>,表示参数值可以是什么。例如:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="17a4" class="mu lg iq ml b gy mv mw l mx my">{<br/> ...<br/>    "username": {<br/>     "content": "$1",<br/>        "example": "John"<br/>    }<br/>    ...<br/>}</span></pre><p id="a008" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这和上面解释的<code class="fe mi mj mk ml b">description</code>键一样，可以帮助任何翻译这个扩展的人理解传递给消息的参数可能是什么。</p><p id="a0c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们现在想添加西班牙语的翻译。我们需要创建文件<code class="fe mi mj mk ml b">locales/es/messages.json</code>。注意，我们在<code class="fe mi mj mk ml b">_locales</code>中创建了一个新文件夹<code class="fe mi mj mk ml b">es</code>。</p><p id="fe16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后在<code class="fe mi mj mk ml b">messages.json</code>文件中，我们将有如下内容:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="2b5a" class="mu lg iq ml b gy mv mw l mx my">{<br/> "greeting": {<br/>     "message": "Hola"<br/>    }<br/>}</span></pre><p id="659d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要使用在默认区域设置中使用的相同键<code class="fe mi mj mk ml b">greeting</code>，因为我们稍后将使用它来获取基于区域设置的字符串。然后对于<code class="fe mi mj mk ml b">message</code>,我们使用西班牙语的翻译。</p><p id="9b32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意，如果你使用一个参数，你也需要把它放在这里。例如:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="ee5e" class="mu lg iq ml b gy mv mw l mx my">{<br/> "greeting": {<br/>     "message": "Hola, $USERNAME",<br/>        "placeholder": {<br/>         "username": { <br/>             "content": "$1"<br/>            }<br/>        }<br/>    }<br/>}</span></pre><h1 id="514d" class="lf lg iq bd lh li mz lk ll lm na lo lp lq nb ls lt lu nc lw lx ly nd ma mb mc bi translated">步骤3:使用本地化字符串</h1><h1 id="d09a" class="lf lg iq bd lh li mz lk ll lm na lo lp lq nb ls lt lu nc lw lx ly nd ma mb mc bi translated">在JS文件中:</h1><p id="1279" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">要获得JS文件中的本地化字符串，您需要使用函数<code class="fe mi mj mk ml b">chrome.i18n.getMessage</code>。例如:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="b8a8" class="mu lg iq ml b gy mv mw l mx my">chrome.i18n.getMessage('greeting');</span></pre><p id="b17f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该值将是当前语言环境中键<code class="fe mi mj mk ml b">greeting</code>的翻译。如果翻译不存在，将使用默认区域设置中的值。</p><p id="f9b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果要传递一个参数，可以将其作为第二个参数传递:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="9bcb" class="mu lg iq ml b gy mv mw l mx my">chrome.i18n.getMessage('greeting', 'John');</span></pre><p id="f133" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意，如果你想传递多个参数，你应该使用一个数组。</p><h1 id="3c08" class="lf lg iq bd lh li mz lk ll lm na lo lp lq nb ls lt lu nc lw lx ly nd ma mb mc bi translated">在manifest.json和CSS文件中</h1><p id="f136" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">要在<code class="fe mi mj mk ml b">manifest.json</code>和CSS文件中使用本地化字符串，您需要在字符串名称前加上<code class="fe mi mj mk ml b">__MSG_</code>，然后在其后加上<code class="fe mi mj mk ml b">__</code>。例如:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="2a98" class="mu lg iq ml b gy mv mw l mx my">{<br/>...<br/>"name": "__MSG_greeting__"<br/>...<br/>}</span></pre><p id="8d99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mi mj mk ml b">__MSG_greeting__</code>将为键<code class="fe mi mj mk ml b">greeting</code>放置翻译。</p><h1 id="2fea" class="lf lg iq bd lh li mz lk ll lm na lo lp lq nb ls lt lu nc lw lx ly nd ma mb mc bi translated">HTML文件中的本地化</h1><p id="fbc5" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">为了翻译HTML文件中的字符串，您需要使用javascript手动完成。</p><p id="82d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是如何用普通Javascript实现这一点:</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4c37" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您也可以使用jQuery:</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h1 id="6615" class="lf lg iq bd lh li mz lk ll lm na lo lp lq nb ls lt lu nc lw lx ly nd ma mb mc bi translated">步骤4(可选):根据区域设置更改CSS方向</h1><p id="21cc" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">当您本地化您的扩展时，您可能需要根据语言改变样式。最重要的是，使您的扩展兼容RTL和LTR语言。</p><p id="aabc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Chrome的国际化系统提供了一些有助于扩展本地化的消息或变量。在CSS中特别有用的是:</p><ol class=""><li id="b58b" class="ne nf iq ka b kb kc kf kg kj ng kn nh kr ni kv nj nk nl nm bi translated"><strong class="ka ir"> @@bidi_dir: </strong>基于当前区域设置的方向(值将是<strong class="ka ir"> rtl </strong>或<strong class="ka ir"> ltr </strong>)</li><li id="69da" class="ne nf iq ka b kb nn kf no kj np kn nq kr nr kv nj nk nl nm bi translated"><strong class="ka ir"> @@bidi_reversed_dir: </strong>当前方向的反向。所以如果<code class="fe mi mj mk ml b">@@bidi_dir</code>的值是rtl，<code class="fe mi mj mk ml b">@@bidi_reversed_dir</code>的值将是ltr，反之亦然。</li><li id="478c" class="ne nf iq ka b kb nn kf no kj np kn nq kr nr kv nj nk nl nm bi translated"><strong class="ka ir"> @@bidi_start_edge: </strong>如果<code class="fe mi mj mk ml b">@@bidi_dir</code>的值是rtl，值就对了；否则，它将被留下。</li><li id="229f" class="ne nf iq ka b kb nn kf no kj np kn nq kr nr kv nj nk nl nm bi translated"><strong class="ka ir"> @@bidi_end_edge: </strong>如果<code class="fe mi mj mk ml b">@@bidi_dir</code>的值为rtl，则该值为左；否则，它将被留下。基本上和<code class="fe mi mj mk ml b">@@bidi_start_edge</code>相反。</li></ol><p id="9f34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些消息在您的CSS中很有帮助，因为您可以在设计您的扩展时使用它们。例如:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="4b52" class="mu lg iq ml b gy mv mw l mx my">html {<br/> direction: __MSG_@@bidi_dir__; //The direction will change based on the current locale<br/>}</span></pre><p id="bb87" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保CSS中的每条消息前面都有<code class="fe mi mj mk ml b">__MSG_</code>，后面有<code class="fe mi mj mk ml b">__</code></p><p id="95dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还提供了其他消息:</p><ol class=""><li id="8ebf" class="ne nf iq ka b kb kc kf kg kj ng kn nh kr ni kv nj nk nl nm bi translated"><strong class="ka ir"> @@extension_id: </strong>您分机的id。在<code class="fe mi mj mk ml b">manifest.json</code>不能用</li><li id="3567" class="ne nf iq ka b kb nn kf no kj np kn nq kr nr kv nj nk nl nm bi translated"><strong class="ka ir"> @@ui_locale: </strong>当前区域设置。</li></ol></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="b651" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="a04c" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">完成上述步骤后，您的chrome扩展将被本地化，并为不同语言的用户做好准备！</p></div></div>    
</body>
</html>