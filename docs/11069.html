<html>
<head>
<title>DateTime Best Practices In .NET C#</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">中的日期时间最佳实践。NET C#</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/datetime-best-practices-in-net-c-4c2679fcc9e0?source=collection_archive---------0-----------------------#2022-02-13">https://levelup.gitconnected.com/datetime-best-practices-in-net-c-4c2679fcc9e0?source=collection_archive---------0-----------------------#2022-02-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="9af9" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">最佳实践</h2><div class=""/><div class=""><h2 id="c498" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在中使用DateTime时要遵循的最佳实践。NET C#</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/2d71ea3ebd11887d0d2a2fbe1580482f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_kJ_WPbxb3aIrBiXRm5SlQ.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae lh" href="https://unsplash.com/@esteejanssens?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">埃斯特·扬森斯</a>拍摄，由<a class="ae lh" href="https://medium.com/@eng_ahmed.tarek" rel="noopener">艾哈迈德·塔雷克</a>调整</figcaption></figure><h1 id="e4f4" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="a7bf" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在我们正在开发的几乎所有软件系统中，我们都需要使用<strong class="mc jd"> DateTime </strong>来表示一些动作的时间戳。</p><p id="0f06" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">然而，我注意到的是，有时我们会犯一些在某些场合可能是致命的错误。</p><p id="124b" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">因此，我决定写这篇文章，与大家分享在<strong class="mc jd">中处理<strong class="mc jd"> DateTime </strong>时可以遵循的一些最佳实践。NET C# </strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><div class="nc nd gp gr ne nf"><a href="https://medium.com/subscribe/@eng_ahmed.tarek" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd jd gy z fp nk fr fs nl fu fw jc bi translated">🔥订阅艾哈迈德的时事通讯🔥</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">订阅艾哈迈德的时事通讯📰直接获得最佳实践、教程、提示、技巧和许多其他很酷的东西…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt lb nf"/></div></div></a></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nu"><img src="../Images/9478296cd9f1f74aaadc79e31323a3f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CtHLiYHq-W3YOFNFN-fUXw.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@jeshoots?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae lh" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄，由<a class="ae lh" href="https://medium.com/@eng_ahmed.tarek" rel="noopener"> Ahmed Tarek </a>调整</figcaption></figure><h1 id="9967" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">议程</h1><p id="ec28" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在本文中，我们将讨论以下主题:</p><ol class=""><li id="3bdf" class="nv nw it mc b md mw mg mx mj nx mn ny mr nz mv oa ob oc od bi translated"><strong class="mc jd">日期时间</strong> vs <strong class="mc jd">日期时间偏移量</strong>。</li><li id="49a2" class="nv nw it mc b md oe mg of mj og mn oh mr oi mv oa ob oc od bi translated">注意值初始化的时间。</li><li id="7961" class="nv nw it mc b md oe mg of mj og mn oh mr oi mv oa ob oc od bi translated">统一来源。</li><li id="41d1" class="nv nw it mc b md oe mg of mj og mn oh mr oi mv oa ob oc od bi translated">静态与抽象。</li></ol><p id="90d9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">现在，你可以系好安全带，享受旅程了。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><h1 id="5203" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">日期时间</strong> vs <strong class="ak">日期时间偏移量</strong></h1><p id="2094" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我确信这一切。NET开发者知道<strong class="mc jd"> DateTime </strong>，然而，并不是所有人都知道<strong class="mc jd"> DateTimeOffset </strong>。两者有显著的区别。</p><p id="ab70" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">关于这个话题，<a class="oj ok ep" href="https://medium.com/u/2f1faa247027?source=post_page-----4c2679fcc9e0--------------------------------" rel="noopener" target="_blank">史蒂夫·史密斯</a>发表了一篇很棒的<a class="ae lh" href="https://ardalis.com/why-use-datetimeoffset/" rel="noopener ugc nofollow" target="_blank"> <strong class="mc jd">文章</strong> </a>，我鼓励你去读一读。</p><p id="9e76" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">作为一个快速总结，让我们检查下面的笔记。</p><h2 id="9c68" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated"><strong class="ak">日期时间</strong></h2><p id="1dd9" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">使用<strong class="mc jd"> DateTime </strong>时，当前系统日期被保存并封装在变量中，但不保存或链接到时区。</p><p id="7a5c" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">因此，如果使用多台不同时区的机器，这最终会导致问题。</p><h2 id="68ad" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated">日期时间偏移量</h2><p id="3bad" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">相反，<strong class="mc jd"> DateTimeOffset </strong>通过保存UTC日期时间的偏移量，将当前值链接到时区。</p><p id="b2e0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这样，保存的值可以统一，因为它以一种格式保存，然后可以转换到不同的时区，而不会影响值本身。</p><h2 id="8538" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated">结论</h2><p id="0336" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我总是建议尽可能使用<strong class="mc jd"> DateTimeOffset </strong>,最棒的是它完全被著名的模块和框架支持，甚至是MS SQL。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><h1 id="381d" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">注意值初始化的时间</h1><p id="36ea" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我注意到的是，有时开发人员在初始化<strong class="mc jd"> DateTime </strong>或<strong class="mc jd"> DateTimeOffset </strong>值时会很粗心，特别是当这个值会在多个地方使用，并且业务需要在所有地方都使用相同的值时。我再强调一下。</p><p id="1f95" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">让我们来研究这一小段代码。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="57d5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们在这里所做的是，我们想要调用两个方法<code class="fe oy oz pa pb b">DoSomething1</code>和<code class="fe oy oz pa pb b">DoSomething2</code>,传入对应于现在的同一个日期时间戳。</p><p id="679f" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">因此，在代码示例中，我们通过两种方式来展示不同之处。我们正在用<code class="fe oy oz pa pb b">BadTiming</code>和<code class="fe oy oz pa pb b">GoodTiming</code>方法做这件事。</p><h2 id="304e" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated">时机不对</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="d287" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这里，当调用<code class="fe oy oz pa pb b">DoSomething1</code>方法时，我们传入<code class="fe oy oz pa pb b">DateTimeOffset.Now</code>，当调用<code class="fe oy oz pa pb b">DoSomething2</code>方法时，我们做同样的事情。</p><p id="f276" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们现在应该期望的是传递给方法的<code class="fe oy oz pa pb b">DateTimeOffset</code>值是不同的，因为它们是在不同的时间戳捕获的。</p><h2 id="ba77" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated">好时机</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="f703" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这里，当调用<code class="fe oy oz pa pb b">DoSomething1</code>和<code class="fe oy oz pa pb b">DoSomething2</code>方法时，我们传递的是已经保存在<code class="fe oy oz pa pb b">now</code>变量中的同一个预先捕获的DateTimeOffset值。</p><p id="375c" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">因此，现在很明显，传递给这些方法的<code class="fe oy oz pa pb b">DateTimeOffset</code>值是相同的，因为它们是在相同的确切时间戳捕获的。</p><h2 id="61ae" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated">运行代码</h2><p id="8fb3" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">当我们运行整个代码时，我们将得到这个输出。</p><pre class="ks kt ku kv gt pc pb pd pe aw pf bi"><span id="86fa" class="ol lj it pb b gy pg ph l pi pj">Testing Bad Timing<br/>First Stamp: 2022–01–31T11:01:25.3441950+00:00<br/>Second Stamp: 2022–01–31T11:01:25.3488150+00:00</span><span id="e04e" class="ol lj it pb b gy pk ph l pi pj">Testing Good Timing<br/>First Stamp: 2022–01–31T11:01:25.3491070+00:00<br/>Second Stamp: 2022–01–31T11:01:25.3491070+00:00</span></pre><p id="d57e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">你注意到不同了吗？运行<code class="fe oy oz pa pb b">BadTiming</code>方法时，两种方法的时间戳不同。另一方面，当运行<code class="fe oy oz pa pb b">GoodTiming</code>方法时，两种方法的时间戳相似。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><h1 id="a89d" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">统一来源</h1><p id="9adf" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">当在一个软件系统上工作时，无论何时你正在捕获<code class="fe oy oz pa pb b">DateTime</code>或<code class="fe oy oz pa pb b">DateTimeOffset</code>值，试着统一捕获这些值的机器。</p><p id="a115" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我注意到一些开发人员混合了他们获取这些价值的方式，有时从浏览器(客户端)，有时从服务器，有时从某台机器，…等等。</p><p id="654e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这种方法的问题是，如果这些不同的源上的时钟之间存在微小的差异，那么数据中可能存在不一致。此外，想象一下如果差异很大，而不仅仅是微小的差异。</p><p id="7b5e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">不应用此最佳实践可能会导致应用程序和保存的数据出现致命问题。如果损坏的数据像银行系统中的资金转移交易一样敏感，您可能会以灾难告终。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><h1 id="c637" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">静态与抽象</h1><p id="ee06" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我经常遇到的一个不好的做法是将<code class="fe oy oz pa pb b">DateTime</code>或<code class="fe oy oz pa pb b">DateTimeOffset</code>的用法封装在逻辑中，而不提供任何抽象。让我解释一下。</p><p id="00ec" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">让我们假设我们有一个虚拟的控制台应用程序，其中我们定义了一个<code class="fe oy oz pa pb b">Logger</code>类。这个类应该只定义一个接受字符串消息的<code class="fe oy oz pa pb b">Log</code>方法，它返回相同的消息，但是以日期时间戳为前缀。</p><h2 id="060f" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated">静态方式</h2><p id="0a81" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">一种方法是这样的:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="d0da" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">因此，现在运行应用程序，您应该得到以下结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pl"><img src="../Images/a06f75f9692386196e2bae53689ba778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Z0MoJLp7zet0faHF86QJA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lk">结果</strong>。图片由<a class="ae lh" href="https://medium.com/@eng_ahmed.tarek" rel="noopener">艾哈迈德·塔里克</a>拍摄</figcaption></figure><p id="5dd8" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">简单吧？</p><p id="0e97" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果你只关心运行时的结果，那就可以了。然而，如果你也关心你的代码质量和可测试性，这就不是那么好了。我强调一下。</p><p id="c797" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">假设我们想用单元测试覆盖我们的<code class="fe oy oz pa pb b">Logger</code>类。这是我们能做的:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="2e42" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如您所见，这里您能做的最好的事情是忽略消息的日期时间戳部分，只断言真正的消息是实际结果消息的一部分。</p><p id="83ec" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这意味着如果有人对<code class="fe oy oz pa pb b">Logger</code>类进行了修改，只要真实的消息仍然是最终消息的一部分，同样的测试仍然会通过。</p><p id="7a33" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">此外，测试实际上没有注意到<code class="fe oy oz pa pb b">DateTimeOffset</code>类的用法。因此，业务逻辑的一部分被完全忽略，没有被测试覆盖。</p><h2 id="b811" class="ol lj it bd lk om on dn lo oo op dp ls mj oq or lu mn os ot lw mr ou ov ly iz bi translated">抽象的方式</h2><p id="d474" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">然而，另一种方式是这样的:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="aa38" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们在这里所做的是将<code class="fe oy oz pa pb b">DateTimeOffset.Now</code>抽象到接口<code class="fe oy oz pa pb b">IDateTimeProvider</code>中，并将默认实现<code class="fe oy oz pa pb b">SystemDateTimeProvider</code>定义为<code class="fe oy oz pa pb b">DateTimeOffset.Now</code>的瘦包装器。</p><p id="6deb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">现在，我们的<code class="fe oy oz pa pb b">Logger</code>类将<code class="fe oy oz pa pb b">IDateTimeProvider</code>定义为一个依赖项，我们可以在测试时<strong class="mc jd">模仿</strong>或<strong class="mc jd">存根</strong>。</p><p id="f951" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">因此，正如我们提到的测试，这就是我们最终能得到的结果:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="60bb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">看，现在我们可以用单元测试完全覆盖业务逻辑，而不会忽略任何业务规则。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pm"><img src="../Images/7bb6ef8e1e14684a9739af24615a9310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZpHDRcFLfitsCgUnhRD2ow.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@ambreenhasan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">安布林·哈桑</a>在<a class="ae lh" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄，由<a class="ae lh" href="https://medium.com/@eng_ahmed.tarek" rel="noopener">艾哈迈德·塔雷克</a>调整</figcaption></figure><h1 id="725e" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">最后的想法</h1><p id="e25a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在这篇文章中，我与你分享了一些在<strong class="mc jd">中使用<code class="fe oy oz pa pb b">DateTime</code>和<code class="fe oy oz pa pb b">DateTimeOffset</code>的最佳实践。NET C# </strong>。</p><p id="175d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">就这样结束了吗？不，我鼓励你做自己的研究和评估，因为这将有助于你了解更多。</p><p id="2344" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">最后，我希望你喜欢读这篇文章，就像我喜欢写它一样。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><h1 id="8195" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">希望这些内容对你有用。如果您想支持:</h1><p id="3514" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">如果你还不是<strong class="mc jd">中的</strong>会员，你可以使用<a class="ae lh" href="https://medium.com/@eng_ahmed.tarek/membership" rel="noopener"> <strong class="mc jd">我的推荐链接</strong> </a>，这样我可以从<strong class="mc jd">中</strong>得到你的一部分费用，你不需要支付任何额外的费用。订阅<a class="ae lh" href="https://medium.com/subscribe/@eng_ahmed.tarek" rel="noopener"> <strong class="mc jd">我的简讯</strong> </a>将最佳实践、教程、提示、技巧和许多其他很酷的东西直接发送到您的收件箱。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure><h1 id="e6a7" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">其他资源</h1><p id="2846" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">这些是你可能会发现有用的其他资源。</p><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/curse-of-recursion-in-net-c-b017271ddbe6"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd jd gy z fp nk fr fs nl fu fw jc bi translated">递归的诅咒。NET C#</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">为什么以及如何在？NET C#</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="no l"><div class="pn l nq nr ns no nt lb nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-cancel-a-running-process-in-a-separate-request-command-in-net-c-2ca8fb733618"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd jd gy z fp nk fr fs nl fu fw jc bi translated">如何在单独的请求/命令中取消正在运行的进程。NET C#</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">了解如何在单独的请求中取消已经运行的进程。NET C#</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="no l"><div class="po l nq nr ns no nt lb nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a href="https://medium.com/illumination/how-to-drive-traffic-to-your-medium-stories-f82a9f5eb6c7" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd jd gy z fp nk fr fs nl fu fw jc bi translated">如何为你的媒体故事带来流量</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">如何在媒体上取得成功并为你的故事带来流量的实用指南。</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="pp l nq nr ns no nt lb nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/template-method-design-pattern-in-net-c-73d0be82571e"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd jd gy z fp nk fr fs nl fu fw jc bi translated">中模板方法设计模式的分析。NET C#</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">中学习模板方法设计模式。NET C#并探索不同的可能性。</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="no l"><div class="pq l nq nr ns no nt lb nf"/></div></div></a></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/dae42316c04548aad197e34b378e3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFZ-qimUzmMG4vLln9mYSw.png"/></div></div></figure></div></div>    
</body>
</html>