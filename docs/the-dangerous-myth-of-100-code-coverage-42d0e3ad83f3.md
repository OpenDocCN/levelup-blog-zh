# 100%代码覆盖率的危险神话

> 原文：<https://levelup.gitconnected.com/the-dangerous-myth-of-100-code-coverage-42d0e3ad83f3>

![](img/50b71724be60d32999dfe9fb775f7c34.png)

照片由 [Siora 摄影](https://unsplash.com/@siora18?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

你听到单元测试人群的命令了吗？我们必须开悟。我们必须实现 100%的代码覆盖率！任何没有达到 100%代码覆盖率的项目都是*垃圾！*

这是一个吸引人的论点。如果我们接受测试对代码有益这一逻辑论点，那么似乎可以得出这样的结论:覆盖 100%代码的更多测试会更好，对吗？

# 代码覆盖率很高

这是真的，代码覆盖率很高。这绝对是我们应该努力争取的事情。这是一个足够简单的论点，而且在大多数情况下都成立——铺垫！

从长远来看，被好的测试 100%覆盖的好代码只会让你的项目更加强大。这就是我们一直在寻找的乌托邦，天啊，这是我们应得的，不是吗？

# TDD 可以帮助我们达到 100%的覆盖率

当然，测试驱动开发要求你写的任何一行代码都要被相应的测试覆盖。如果你正确地进行 TDD，你将会达到 100%的代码覆盖率。

就这么简单。

所以答案是 TDD，我们到此为止，对吗？

你为什么还在读书？

哦，对了，我忘了:*神话！*

# 100%的覆盖率并不能解决糟糕代码的问题

不管是否被测试覆盖，坏代码就是坏代码。但是我所说的“糟糕的代码”是什么意思呢这只是我主观和判断吗？我认为任何不使用类型声明或者保护子句的代码都是糟糕的代码吗？

嗯，是的，但这不是我在这里说的。

我在这里对坏代码的定义更深入。坏代码是任何看起来只做了它应该做的事情的代码。

这就是 100%代码覆盖率的神话。

# 编程从解决问题开始

在我的职业生涯中，我有不止一个项目保持了 100%的代码覆盖率，被移交给客户，只是被返回给我，并声明“这不是我们所要求的。”

如果我们只关注我们的测试覆盖了多少代码，我们可以忽略关注我们的代码覆盖了多少问题。

# 覆盖的代码仍然可能有错误

我们不能让自己被欺骗，把代码覆盖率等同于无 bug。我们在初始 TDD 期间创建的测试与我们在修复 bug 时创建的测试是不同的。

我们在第一次构建的路径中覆盖了所有的代码，但这并不意味着我们是正确的，或者那些相同的路径不能以我们没有想到的其他方式使用。

覆盖代码只证明它已经被测试证明的东西。

任何未测试的——但是被覆盖的——最终都需要回归测试。

# 未写的代码不会降低覆盖率

如果你需要更多的证据来证明代码覆盖率不等于高质量的代码，只要看看我刚刚写的这个社交网络代码就知道了:

一个完美的，100%代码覆盖的社交网络。

但是你认为它作为一个社交网络有多好呢？不太可能。那是因为不成文的代码不会降低覆盖率。没有一个快速的标准来衡量我们有多少问题没有解决。

为此，我们只有需求文档和经验。

# 所以，我不应该担心代码覆盖率？

我根本不是这个意思。你应该担心它，但它不应该是你的第一个或最大的担心。

你的第一个，也是最大的关注点应该是解决你所面临的问题。这是我们工作的一部分。

您的第二个关注点应该是确保该问题的需求已经以可重复和自动化的方式被规划出来，并被单元、特性、集成和/或验收测试所覆盖。

一旦覆盖了前两件事，*然后*我们可以担心 100%的代码覆盖率。

我敢说，100%覆盖但在需求中什么都不做的代码比 0%覆盖但在需求中做了所有事情的代码更糟糕。

因为我们可以随时回溯并添加测试。100%覆盖的不做任何事情的代码只是一个你没有完成的项目。

*如果你对这篇文章感兴趣，你会爱上我的 Twitter 上的技术意识流。* [*头那边，给我跟着*](https://twitter.com/n00bJackleCity) *。你不会失望的。*