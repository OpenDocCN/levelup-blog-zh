<html>
<head>
<title>Docker 101: Part 2 - Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文档101:第2部分-图像</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/docker-101-part-2-images-cf845d1a4fcb?source=collection_archive---------16-----------------------#2022-07-31">https://levelup.gitconnected.com/docker-101-part-2-images-cf845d1a4fcb?source=collection_archive---------16-----------------------#2022-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2091446edbc682e200717654fa22955a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fIvPgbHVhJb73r7YeW_0A.png"/></div></div></figure><p id="dad3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上一篇文章中，我们研究了一些与容器相关的基本概念，以及容器与虚拟机的区别。在本文中，我们将研究容器注册表、Docker图像以及与图像相关的主要命令。</p><p id="ffa1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了跟进，需要在我们的系统上安装Docker引擎，这可以通过遵循<a class="ae kw" href="https://docs.docker.com/engine/install/" rel="noopener ugc nofollow" target="_blank"> Docker文档</a>上给出的说明来实现</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="dcce" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Docker图像</h1><p id="5dec" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">如前所述，映像只是一个包，其中包含程序及其依赖项和元数据，这是映像运行所必需的。</p><p id="42d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">映像不包含内核，甚至不包括驱动程序，因为这些底层组件是由安装Docker引擎的主机系统提供的。</p><p id="43aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Docker图像由层组成，每层都有一个与之关联的<a class="ae kw" href="https://www.sentinelone.com/cybersecurity-101/hashing/" rel="noopener ugc nofollow" target="_blank">哈希</a>。每层的<a class="ae kw" href="https://www.sentinelone.com/cybersecurity-101/hashing/" rel="noopener ugc nofollow" target="_blank">散列</a>用于唯一标识该层。Docker利用<a class="ae kw" href="https://stackoverflow.com/questions/32775594/why-does-docker-need-a-union-file-system" rel="noopener ugc nofollow" target="_blank">联合文件系统(UFS) </a>将多个图层组合在一起，组成一幅图像。如果有多个图像共享一个图层，则共享的图层只需下载一次。</p><p id="012b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是容器的基本思想之一，使它们如此轻量级和健壮，这种方法允许节省空间和尽可能重用图像的一部分。当我们运行一个容器时，Docker使用它的基本映像，并在它的顶部<strong class="ka ir"> </strong>添加一个临时读/写层，一旦容器完成了它的工作并被用户删除，只需要删除临时层。这样，只要需要，就可以重复使用相同的基本映像，而不会改变其状态。</p><p id="da06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，如果我们旋转一个图像的5个实例，Docker不会制作基础图像的5个副本，而是使用基础图像的单个副本并制作5个临时层(5个实例中的每一个都有一个)。</p><p id="e999" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种分层方法也有助于安全性，每一层都是孤立的，看不到其他层中的内容。只有当UFS合并这些层时，属于同一个目录的不同文件才会看起来像是在一起。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="6a97" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">集装箱登记处</h1><p id="ffd2" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">容器注册表是存储和管理容器映像的中心位置。你可以把它想象成Google Drive，但它是针对图像的。除了存储之外，注册中心通常还提供一些附加功能，如漏洞分析、映像版本控制、访问控制和CI/CD集成。</p><p id="45c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有几家公司提供容器注册，有些是公共的，有些是私人的。最流行的注册表公共注册表是<a class="ae kw" href="https://hub.docker.com/search?q=&amp;type=image" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/9a3dfd379178ef063b3d1c0c63ddd9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4K9pf19S2fbKGquzmPoAw.png"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="ba02" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">拉动图像</h1><p id="bf23" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">现在，让我们来看看如何将图像拉至我们的本地系统。在Docker Hub上，让我们找到一个要下载的图像，我将使用这个例子中的<a class="ae kw" href="https://hub.docker.com/_/alpine" rel="noopener ugc nofollow" target="_blank">阿尔卑斯山</a>图像，但是这个过程对于所有的图像都是一样的。一旦Docker启动并运行，打开一个终端并键入以下命令。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="ba1d" class="mr lf iq mn b gy ms mt l mu mv">docker image pull alpine</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/c41b960a634ba7cec69d61f6cc7fce9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bDiXCK2LyXLwZe_Vjp85tQ.png"/></div></div></figure><p id="2e42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将拉下阿尔卑斯山图像的最新版本。</p><p id="4d4d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意写着“pull complete”的那一行，它前面有一个散列，这是组成该图像的层的散列。如果我们拉下一个更大的图像，我们会看到多个这样的层被下载，然后由UFS合并在一起，形成一个单一的图像。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/58e153bc9013cf4e56b83d771e9bdcc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyFLvpquXx30zwLdo0L4rQ.png"/></div></div></figure><p id="c245" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我们可以看到有5层组成了这个python图像。如果我们试图下载两个共享相同层的图像，我们将看到Docker不会重新下载我们系统中已经存在的层。</p><p id="a2e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用“image ls”命令查看所有下载的和本地可用的图像。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="44b3" class="mr lf iq mn b gy ms mt l mu mv">docker image ls</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/a9045e0073f1b7b5f0a4f661ee2a978d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2nBySJG3iEHDbYqifmaIg.png"/></div></div></figure><p id="cf39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以看到标签为<strong class="ka ir">最新</strong>的阿尔卑斯山图片已经下载到我们的系统中。这是下载最新版本图像的默认行为。现在，如果我们不想下载图像的最新版本，我们如何指定下载图像的哪个版本呢？这可以通过指定图像的<strong class="ka ir">标签</strong>来实现。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/a18e4e45fbb3567f2586e71d990cb267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrqWBcys1mO2VALhc-FOXQ.png"/></div></div></figure><p id="e0af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Docker Hub上，我们可以查看图像的“支持的标签”部分，以找到可用的标签。或者，我们可以访问图像拉取命令下方的“查看可用标签”链接，以查看相同的信息。标签在图像名称后指定，以下载该版本的图像。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="aa2e" class="mr lf iq mn b gy ms mt l mu mv">docker image pull alpine:3.15</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/2a9e5fd285430e92ac6b77b253ce36c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kglks5rJSToBRxhIPdAZXw.png"/></div></div></figure><p id="0b75" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，如果我们列出这些图片，我们会看到Alpine现在有两个版本。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/604b2dcb2d37a21b6a0ba9495566dd06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*W0oac6DrXaPCU8K-mmnEWw.png"/></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="bff9" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">图像元数据</h1><p id="f7df" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">我们可以通过查看“图像历史”和“图像检查”命令来查看各种与图像相关的元数据。</p><p id="8023" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">history命令向我们展示了组成图像的不同层，以及用来制作图像的命令的快照(创建图像将在以后的文章中讨论)。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/e3edd8fd20449824c2a04c5e861ba2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CO0FZALa7VO2Ia7IkL9omw.png"/></div></div></figure><p id="725d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不需要担心在第一列中出现的遗漏，只有最后一层被认为是图像，因此只为它显示散列。</p><p id="c7da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">“图像检查”命令可用于查看组成图像的不同层和配置的所有元数据。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/06607132d4c0ccca7a63bbe8967a9978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gTac1NNBJ1rVFlEyCwZPA.png"/></div></div></figure><p id="0e49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不是每个人都能理解这里显示的所有信息，这很好，重要的是知道我们可以使用上面的命令查看与图像相关的元数据。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="215c" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">移除图像</h1><p id="be52" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">一旦我们正在使用一个映像，我们可以使用“image rm”命令将它从我们的系统中删除以释放空间。让我们在我们的系统上删除Alpine的两个版本中的一个。</p><p id="fc0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用“image rm”命令从系统中删除映像。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="c837" class="mr lf iq mn b gy ms mt l mu mv">docker image rm &lt;image-name&gt;</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/4c5b14a05ddb9e39f53d1c78c534b61f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciJYH0HNV__j86TgNBIB9g.png"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="6393" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">帮助命令</h1><p id="d4b6" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">要查看Docker提供的所有与图像相关的命令，我们可以使用<code class="fe nf ng nh mn b">--help</code>标志</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="2a23" class="mr lf iq mn b gy ms mt l mu mv">docker image --help</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/0c2ab6ee8ef5fe88d412bf0e87880408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LNUw9cVZBHSVtXzZHQhCKw.png"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h2 id="1911" class="mr lf iq bd lg nj nk dn lk nl nm dp lo kj nn no ls kn np nq lw kr nr ns ma nt bi translated">前一篇文章</h2><div class="nu nv gp gr nw nx"><a href="https://david-varghese.medium.com/docker-101-part-1-the-basics-d0dfa595e0a4" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">Docker 101:第一部分-基础知识</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">在本帖中，我们将会看到一些对理解Docker很重要的基本概念，并有一个…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">david-varghese.medium.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol jw nx"/></div></div></a></div><h2 id="5d9e" class="mr lf iq bd lg nj nk dn lk nl nm dp lo kj nn no ls kn np nq lw kr nr ns ma nt bi translated"><strong class="ak">下一篇</strong></h2><div class="nu nv gp gr nw nx"><a href="https://david-varghese.medium.com/docker-101-part-3-containers-e2328ed3dda6" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">码头工人101:第3部分-集装箱</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">到目前为止，我们已经了解了与容器和用于管理图像的各种Docker命令相关的基础知识。在这个…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">david-varghese.medium.com</p></div></div><div class="og l"><div class="om l oi oj ok og ol jw nx"/></div></div></a></div></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h2 id="7f83" class="mr lf iq bd lg nj nk dn lk nl nm dp lo kj nn no ls kn np nq lw kr nr ns ma nt bi translated">参考</h2><ul class=""><li id="40cb" class="on oo iq ka b kb mc kf md kj op kn oq kr or kv os ot ou ov bi translated"><a class="ae kw" href="https://stackoverflow.com/questions/32775594/why-does-docker-need-a-union-file-system" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/32775594/why-do-docker-need-a-union-file-system</a></li><li id="834c" class="on oo iq ka b kb ow kf ox kj oy kn oz kr pa kv os ot ou ov bi translated"><a class="ae kw" href="https://en.wikipedia.org/wiki/UnionFS" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/UnionFS</a></li><li id="7def" class="on oo iq ka b kb ow kf ox kj oy kn oz kr pa kv os ot ou ov bi translated"><a class="ae kw" href="https://hub.docker.com/search?q=&amp;type=image" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/search?q=&amp;类型=图像</a></li><li id="0f89" class="on oo iq ka b kb ow kf ox kj oy kn oz kr pa kv os ot ou ov bi translated"><a class="ae kw" href="https://docs.docker.com/engine/reference/commandline/image/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/engine/reference/commandline/image/</a></li></ul></div></div>    
</body>
</html>