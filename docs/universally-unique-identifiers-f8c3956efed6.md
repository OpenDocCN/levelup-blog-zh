# 通用唯一标识符

> 原文：<https://levelup.gitconnected.com/universally-unique-identifiers-f8c3956efed6>

![](img/46ba42166b77fbac919ecd2a31d3bd87.png)

通用唯一标识符(UUIDs)是 128 位唯一标识符，用于在计算系统中标记信息。UUIDs 不需要由中央系统生成，并且保持低冲突概率。这些特性使它们成为苹果、HubSpot 和微软的数据库关键字、网络分析和硬件的有用标识符。本出版物涵盖了微软、 [Leach 等人在 RCF 4122 中提出的规范。](https://datatracker.ietf.org/doc/html/rfc4122)

**举例:**

`787bce4a-6865-11ec-a24f-38f9d34e0805`

最流行的 UUID 版本是使用伪随机数生成器生成的，而其他 UUID 版本通过在 UUID 中包含时间戳、节点或哈希网络信息来降低熵。

# 结构

UUIDs 由 16 个八位字节组成，为`version`和`variant`保留了位。

## 版本

版本号位于 **time_hi_version** 字段的最高 4 位。

**版本 1 和版本 2**

版本 1 使用包含时间戳、时钟序列和系统节点的确定性过程来生成无冲突 UUID。这是 UUID 最受欢迎的版本。版本 2 用本地域标识符替换了 40 位时间信息。

**版本 3 和版本 5**

第 3 版和第 5 版通过分别使用 MD5 和 SHA-1 对名称空间进行哈希运算来生成 UUID。

**版本 4**

使用 122 位生成随机 UUID。其余 6 位保留给版本和变体。

在我们的例子中，`[1]1ec`的 msb 0–4 是`0001`，所以它是版本 1 UUID。

## 不同的

变量字段决定了 UUID 的布局。它是 **clock_seq_hi_variant** 域的最高有效位 3 位。

在我们的例子中，`[a]24f`的 msb 0–3 是`1010`，所以它是变体 1 UUID。

下面是一个 python 脚本，它打印了任何 UUID 的版本和变体。

# 冲突

当同一个 UUID 生成两次时，就会发生冲突。了解每个版本中的冲突概率可以决定最适合您的服务的版本。以 docker 容器使用内核熵生成版本 4 UUIDs(伪随机数生成器)为例。版本 4 UUIDs 中的冲突概率是使用[生日问题](https://en.wikipedia.org/wiki/Birthday_problem)得出的。很有可能出现重复，或者更糟，耗尽熵。或者，第 1 版和第 2 版牺牲了 48 位熵，在 UUID 代中包含了主机的 MAC 地址。这种空间减少是否会影响 UUID 的生成，可能应该在更改任何代码之前进行测试。

请注意，如果在应用程序的生命周期中冲突的概率增加，那么 UUID 生成过程就有可能无法满足需求。如果冲突对应用程序至关重要，那么添加错误处理和指标以生成新的 UUID 并跟踪冲突计数也很重要。