<html>
<head>
<title>React Formik and simple form validation.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Formik和简单表单验证。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-formik-and-simple-form-validation-8fef0ccb54b?source=collection_archive---------2-----------------------#2021-04-14">https://levelup.gitconnected.com/react-formik-and-simple-form-validation-8fef0ccb54b?source=collection_archive---------2-----------------------#2021-04-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/81c448011527b9f0269eeb06e53ae47c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-v0BWB-s9-Mip3cqbMriA.jpeg"/></div></div></figure><p id="72f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从在本地环境中创建react应用程序开始。为此，我们打开命令行，使用以下命令进入桌面文件夹:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="391a" class="lf lg iq lb b gy lh li l lj lk">cd Desktop/</span></pre><p id="ab69" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建react应用程序后，使用:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="ce7c" class="lf lg iq lb b gy lh li l lj lk">npx create-react-app testapp</span></pre><p id="d3b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的计算机上创建React项目后，用您使用的代码编辑器打开它，并打开App.js文件。清除App.js文件并复制它以便启动。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="7646" class="lf lg iq lb b gy lh li l lj lk">export default function App() {</span><span id="b98d" class="lf lg iq lb b gy ll li l lj lk"> return (</span><span id="e68d" class="lf lg iq lb b gy ll li l lj lk">    &lt;div className="App"&gt;</span><span id="720c" class="lf lg iq lb b gy ll li l lj lk">       &lt;form&gt;</span><span id="832a" class="lf lg iq lb b gy ll li l lj lk">       &lt;label htmlFor='name'&gt;Name&lt;/label&gt;<br/>       &lt;input id='name' type='text' placeholder='Name' /&gt;</span><span id="7e87" class="lf lg iq lb b gy ll li l lj lk">       &lt;label htmlFor='email'&gt;Email&lt;/label&gt;<br/>       &lt;input id='email' type='email' placeholder='Email'/&gt;</span><span id="2dbd" class="lf lg iq lb b gy ll li l lj lk">       &lt;button type='submit'&gt;Submit&lt;/button&gt;</span><span id="6d64" class="lf lg iq lb b gy ll li l lj lk">      &lt;/form&gt;</span><span id="21b5" class="lf lg iq lb b gy ll li l lj lk">  &lt;/div&gt;</span><span id="d774" class="lf lg iq lb b gy ll li l lj lk">);</span><span id="09d1" class="lf lg iq lb b gy ll li l lj lk">}</span></pre><p id="edae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我们应用程序的基本形式。</p><p id="5c1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们将formik包添加到我们的应用程序中。打开终端写:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="93f7" class="lf lg iq lb b gy lh li l lj lk">npm i formik</span></pre><p id="0b2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们将使用<code class="fe lm ln lo lb b">useFormik()</code>自定义react钩子。在内部，Formik使用<code class="fe lm ln lo lb b">useFormik</code>来创建<code class="fe lm ln lo lb b">&lt;Formik&gt;</code>组件(这将呈现一个<a class="ae lp" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank"> React上下文</a>提供者)。</p><p id="4cac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用以下内容将useFormik导入到我们的项目:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="884c" class="lf lg iq lb b gy lh li l lj lk">import { useFormik } from ‘formik’</span></pre><p id="f3d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们在组件中调用它</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="c160" class="lf lg iq lb b gy lh li l lj lk">const formik = useFormik({})</span></pre><p id="6654" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们创建的表单中，我们有两个字段:姓名和电子邮件。对于管理表单状态，我们首先像这样声明输入字段的初始值。useFormik挂钩中声明的初始值。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="837b" class="lf lg iq lb b gy lh li l lj lk">const formik = useFormik({<br/> initialValues:{<br/>   name:'',<br/>   email:''<br/>  }<br/>})</span></pre><p id="1f92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们在控制台日志中记录formik元素的值，请写下这一行</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="9711" class="lf lg iq lb b gy lh li l lj lk">console.log(formik.values);</span></pre><p id="493f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你会看到</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/13c5abd4e825324b2a1e0c739f346fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*LwAXrNwnNiiXZ2sv-904UA.png"/></div></figure><p id="2bad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Formik使用onChange函数检测输入元素的变化，并且我们使用formik声明输入的值。将onChange函数和值添加到如下所示的元素中。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="aa30" class="lf lg iq lb b gy lh li l lj lk">*Name input*</span><span id="422b" class="lf lg iq lb b gy ll li l lj lk">&lt;input <br/><em class="lr">id</em>=’name’ <br/><em class="lr">type</em>=’text’ <br/><em class="lr">placeholder</em>=’Name’ <br/><em class="lr">onChange</em>={formik.handleChange} <br/><em class="lr">value</em>={formik.values.name } <br/>/&gt;</span><span id="fcdf" class="lf lg iq lb b gy ll li l lj lk">*Email input*</span><span id="0bc2" class="lf lg iq lb b gy ll li l lj lk">&lt;input <br/><em class="lr">id</em>='email' <br/><em class="lr">type</em>='email' <br/><em class="lr">placeholder</em>='Email' <br/><em class="lr">onChange</em>={formik.handleChange} <br/><em class="lr">value</em>={formik.values.email } /&gt;</span></pre><p id="d70f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让控制台再次登录，并在输入字段中键入一些内容</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ls"><img src="../Images/16be0c89d29565502eccae8137ac0722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QQdjBqEwU3CCshfcAdRzGA.png"/></div></div></figure><p id="1329" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你看，我把我的名字写到输入中，然后<code class="fe lm ln lo lb b">handleChange </code>发现了。</p><p id="abef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们编写onChange函数并检测输入字段的变化。</p><p id="fafa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">让我们看看如何在提交时处理表单:</strong></p><p id="539a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">🌓首先，将onSubmit函数添加到<code class="fe lm ln lo lb b">&lt;form/&gt;</code>项，如下所示:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="0ffd" class="lf lg iq lb b gy lh li l lj lk">&lt;form <em class="lr">onSubmit</em>={formik.handleSubmit}&gt;</span></pre><blockquote class="lt lu lv"><p id="dd91" class="jy jz lr ka b kb kc kd ke kf kg kh ki lw kk kl km lx ko kp kq ly ks kt ku kv ij bi translated"><code class="fe lm ln lo lb b">formik.handleChange</code>来自图书馆。</p></blockquote><p id="3c51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">🌗其次，将onSubmit添加到useFormik挂钩中。这个onSubmit是对象，它接受箭头函数。在这个箭头功能控制台中记录输入值。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="c776" class="lf lg iq lb b gy lh li l lj lk">const formik = useFormik({<br/>initialValues:{<br/> name:’’,<br/> email:’’<br/>},<br/>onSubmit:<em class="lr">values</em>=&gt;{<br/>  console.log(‘Form data’,<em class="lr">values</em>);<br/>}})</span></pre><p id="ca26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们测试一下，在输入中写入任何内容，然后单击submit按钮。</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/b8a8ec1f1928036680b94cfa80b1302b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGD76FELN-VSZj_cuNS0zQ.png"/></div></div></figure><p id="1f4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你点击提交按钮，你会看到它会工作。</p><h1 id="807b" class="ma lg iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">💛让我们为表单编写验证</h1><p id="fb07" class="pw-post-body-paragraph jy jz iq ka b kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr nb kt ku kv ij bi translated">为了验证，我们再次使用useFormik。让我们看看如何</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="ff46" class="lf lg iq lb b gy lh li l lj lk">const formik = useFormik({<br/>initialValues:{<br/> name:’’,<br/> email:’’<br/>},<br/>onSubmit:<em class="lr">values</em>=&gt;{<br/>  console.log(‘Form data’,<em class="lr">values</em>);<br/>},<br/>validate:values=&gt;{<br/> let errors = {};</span><span id="15ab" class="lf lg iq lb b gy ll li l lj lk"> if(!values.name){<br/>  errors.name = 'Required!'<br/> } </span><span id="048a" class="lf lg iq lb b gy ll li l lj lk">if(!values.email){<br/>  errors.email= 'Required!'<br/> }else if(!/^(([^&lt;&gt;()\[\]\\.,;:\s@"]+(\.[^&lt;&gt;()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i.test(values.email)){<br/>errors.email = 'Invalid email format!'<br/>}</span><span id="a9fc" class="lf lg iq lb b gy ll li l lj lk"> return errors;<br/>}</span><span id="7a47" class="lf lg iq lb b gy ll li l lj lk">})</span></pre><p id="9856" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在验证对象内部，如果输入字段为空“必填”，我们使用if语句并查询名称或电子邮件部分是否为空错误被添加到错误对象。对于电子邮件查询，我们也使用正则表达式来表示电子邮件的正确格式。</p><p id="a8f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">电子邮件的正则表达式:<code class="fe lm ln lo lb b">!/^(([^&lt;&gt;()\[\]\\.,;:\s@”]+(\.[^&lt;&gt;()\[\]\\.,;:\s@”]+)*)|(“.+”))@((\[[0–9]{1,3}\.[0–9]{1,3}\.[0–9]{1,3}\.[0–9]{1,3}])|(([a-zA-Z\-0–9]+\.)+[a-zA-Z]{2,}))$/i.test(values.email)</code></p><p id="58be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们像这样记录错误:<code class="fe lm ln lo lb b">console.log(‘Errors’ , formik.errors);</code>我们会看到错误。</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/39c5df73b44b11ca1d9d6d8b11e420c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lq_X8-DaOwH9FgHvApr58Q.png"/></div></div></figure><p id="4abe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果电子邮件部分不是空的，而是格式错误</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/b0d56129a605dab7d738a864e320f11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kupCRZKfT6zWRv5GFeNRkg.png"/></div></div></figure><h1 id="7fa6" class="ma lg iq bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">🖥️:让我们在屏幕上显示错误</h1><p id="190b" class="pw-post-body-paragraph jy jz iq ka b kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr nb kt ku kv ij bi translated">在<label>标签中，我们使用花括号和三元表达式来询问错误是否存在。如果屏幕上显示错误。</label></p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="ee47" class="lf lg iq lb b gy lh li l lj lk">*For name *</span><span id="a89e" class="lf lg iq lb b gy ll li l lj lk">&lt;label <em class="lr">htmlFor</em>='name'&gt;Name &amp;nbsp;<br/>  {formik.errors.name &amp;&amp; &lt;div <em class="lr">className</em>="error"&gt;{formik.errors.name}       &lt;/div&gt;}<br/>&lt;/label&gt;</span><span id="5ac9" class="lf lg iq lb b gy ll li l lj lk">*For email*</span><span id="046d" class="lf lg iq lb b gy ll li l lj lk">&lt;label <em class="lr">htmlFor</em>='email'&gt;Email&amp;nbsp;<br/> {formik.errors.email&amp;&amp; &lt;div <em class="lr">className</em>="error"&gt;{formik.errors.email}       <br/>&lt;/div&gt;}<br/>&lt;/label&gt;</span></pre><p id="bdd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你会在屏幕上看到一个错误</p><p id="3524" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">简单表单验证代码:<a class="ae lp" href="https://github.com/Simuratli/simpleFormikValidation" rel="noopener ugc nofollow" target="_blank"> Github repo </a></p><p id="1b9b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了支持我:<a class="ae lp" href="https://www.patreon.com/simuratli" rel="noopener ugc nofollow" target="_blank">帕特里翁</a></p></div></div>    
</body>
</html>