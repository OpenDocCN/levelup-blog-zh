<html>
<head>
<title>Reading file line by line in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Go中逐行读取文件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/reading-file-line-by-line-in-go-9904fcb36b7c?source=collection_archive---------14-----------------------#2022-11-14">https://levelup.gitconnected.com/reading-file-line-by-line-in-go-9904fcb36b7c?source=collection_archive---------14-----------------------#2022-11-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/be25cb14b80faacd7ea426198b2d9ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wjew3-JbO8Ad4ew9"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@madalyncox?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Madalyn Cox </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="e75c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在go中读取文件的一种流行方式是使用Go标准包“bufio”。</p><p id="8ad3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码片段:</p><pre class="le lf lg lh gt li lj lk bn ll lm bi"><span id="4f21" class="ln lo it lj b be lp lq l lr ls">package main<br/><br/>import (<br/>    "bufio"<br/>    "fmt"<br/>    "log"<br/>    "os"<br/>)<br/><br/>func main() {<br/>    file, err := os.Open("file.txt")<br/>    if err != nil {<br/>        log.Fatal(err)<br/>    }<br/>    defer file.Close()<br/><br/>    scanner := bufio.NewScanner(file)<br/>    for scanner.Scan() {<br/>        fmt.Println(scanner.Text())<br/>    }<br/><br/>    if err := scanner.Err(); err != nil {<br/>        log.Fatal(err)<br/>    }<br/>}</span></pre><p id="9959" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个示例代码中，我们首先尝试使用“OS”包打开位于当前目录中的文件“file.txt”</p><p id="e323" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后传递这个io类型的文件。Reader进入一个名为“NewScanner”的函数，在“bufio”一个标准的库包中，返回一个“Scanner”</p><p id="b50e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">扫描器有一个名为的方法，该方法使扫描器前进到下一个标记，然后可以通过Bytes或Text方法使用该标记。当扫描停止时，它返回false，无论是由于到达输入的结尾还是由于出错。Scan返回false后，Err方法将返回扫描期间发生的任何错误，除非是io。EOF，Err将返回nil。</p><p id="f4e7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们使用“fmt”打印文件的每一行。Println "</p><blockquote class="lt lu lv"><p id="8b26" class="kg kh lw ki b kj kk kl km kn ko kp kq lx ks kt ku ly kw kx ky lz la lb lc ld im bi translated"><strong class="ki iu">警告:</strong></p></blockquote><p id="48d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当行数超过65536个字符时，扫描仪将抛出错误。如果长度有可能超过65536个字符，可以使用<code class="fe ma mb mc lj b"><a class="ae kf" href="https://pkg.go.dev/bufio#Scanner.Buffer" rel="noopener ugc nofollow" target="_blank">Buffer()</a></code>方法增加扫描仪的容量:</p><pre class="le lf lg lh gt li lj lk bn ll lm bi"><span id="380b" class="ln lo it lj b be lp lq l lr ls">package main<br/><br/>import (<br/>    "bufio"<br/>    "fmt"<br/>    "log"<br/>    "os"<br/>)<br/><br/>func main() {<br/>    file, err := os.Open("file.txt")<br/>    if err != nil {<br/>        log.Fatal(err)<br/>    }<br/>    defer file.Close()<br/><br/>    scanner := bufio.NewScanner(file)<br/>    const maxCap int = lengthOfTheLongestLine<br/>    buf := make([]byte, maxCapacity)<br/>    scanner.Buffer(buf, maxCapacity)<br/>    for scanner.Scan() {<br/>        fmt.Println(scanner.Text())<br/>    }<br/><br/>    if err := scanner.Err(); err != nil {<br/>        log.Fatal(err)<br/>    }<br/>}</span></pre></div></div>    
</body>
</html>