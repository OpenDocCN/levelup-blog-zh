<html>
<head>
<title>Web API best practices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Web API最佳实践</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/web-api-best-practices-9e37162c70c8?source=collection_archive---------17-----------------------#2021-05-16">https://levelup.gitconnected.com/web-api-best-practices-9e37162c70c8?source=collection_archive---------17-----------------------#2021-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/04812d1ea5616476aeed92ce22946eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rGBx9fMhiri8XMiR"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">克里斯托夫·高尔在<a class="ae jg" href="https://unsplash.com/s/photos/laptop-code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="85c7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如今，拥有一个可靠的API是成功的关键。API不仅与连接外部系统相关，它们也是内部系统软件架构的关键(例如，如果你决定使用<a class="ae jg" href="https://en.wikipedia.org/wiki/Microservices" rel="noopener ugc nofollow" target="_blank">微服务</a>)。<br/>在这篇文章中，我想重点介绍Web API最佳实践的三个关键方面:</p><ul class=""><li id="8965" class="le lf jj ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">版本控制</li><li id="a457" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">证明</li><li id="df80" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">错误处理</li></ul><p id="d36a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我努力保持it平台/技术的独立性。如果您正在寻找可能技术的概述，请查看以下内容:</p><ul class=""><li id="3e18" class="le lf jj ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><a class="ae jg" href="https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-web-api?view=aspnetcore-5.0&amp;tabs=visual-studio" rel="noopener ugc nofollow" target="_blank"> REST API </a></li><li id="36e7" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae jg" href="https://github.com/graphql-dotnet/graphql-dotnet" rel="noopener ugc nofollow" target="_blank"> GraphQL API </a></li></ul><h1 id="e88e" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">版本控制</h1><p id="287e" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">您的API将是另一个应用程序的一部分，另一个应用程序让它成为外部应用程序，或者您的某个项目在某种程度上依赖于您的API。<br/>像任何依赖关系一样，消费应用程序应该能够定义一个测试版本。<br/>这是否意味着您不能更新您的API，并且需要通知所有客户并就所有变更达成一致？当然，你可以这样做，或者在你的API中增加一个版本控制的概念。<br/>根据您最终的API技术，您可以选择不同的归档方式，以下链接将为您提供大量内容:</p><ul class=""><li id="78c8" class="le lf jj ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><a class="ae jg" href="https://github.com/microsoft/api-guidelines/blob/vNext/Guidelines.md#12-versioning#" rel="noopener ugc nofollow" target="_blank"> REST API版本控制。网络</a></li><li id="1d56" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae jg" href="https://docs.microsoft.com/en-us/azure/architecture/best-practices/api-implementation" rel="noopener ugc nofollow" target="_blank">微软Web API实施指南</a></li></ul><p id="d970" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您使用的是<a class="ae jg" href="https://graphql.org/learn/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>，那么您并不像上面的链接那样直接需要版本控制。你应该<a class="ae jg" href="https://graphql.org/learn/best-practices/#versioning" rel="noopener ugc nofollow" target="_blank">尽量避免破坏性的改变</a>(比如删除一个字段)并在顶部添加新的东西。</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/0ab7220291a2a578f2bd441d22dd02f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BO2M8au5ROTMODkt"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@franckinjapan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">弗兰克</a>在<a class="ae jg" href="https://unsplash.com/s/photos/phone-yellow-lock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="4ab9" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">证明</h1><p id="acd5" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">你发布的任何软件都必须考虑安全问题，对于一个好的API概念来说也是如此。<br/>虽然我想从总体上谈论身份验证，但也要考虑到这样一个事实，即您必须<a class="ae jg" href="https://docs.microsoft.com/en-us/azure/architecture/best-practices/api-implementation#handling-large-requests-and-responses" rel="noopener ugc nofollow" target="_blank">处理潜在的长时间运行的批量请求</a>，这可能会导致应用程序无响应。<br/>身份验证的经验法则是不要自己构建东西，采用久经考验的市场标准库(基本的HTTP身份验证不应该是您的答案)。</p><h1 id="12c5" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">JWT</h1><p id="15da" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">JSON Web Token于2010年首次发布(经过了实战检验)。核心概念包含带有可选签名和/或可选加密的基于声明的JSON结构。签名可以用公钥/私钥进行。许多框架将支持JWT开箱即用，前往<a class="ae jg" href="https://jwt.io/introduction" rel="noopener ugc nofollow" target="_blank"> JWT文档了解更多</a></p><h1 id="3648" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">OAuth2</h1><p id="dece" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">OAuth是访问授权的开放标准(如JWT)。Simple表示，您的用户通过第三方验证了您的身份。他们永远不会向你透露密码。眼下，<a class="ae jg" href="https://oauth.net/code/" rel="noopener ugc nofollow" target="_blank">各大平台都提供OAuth2认证</a>。</p><h1 id="2995" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">安全声明标记语言（Security Assertion Markup Language的缩写）</h1><p id="9017" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">像上面两个一样，安全断言标记语言也是一个开放标准。SAML允许单点登录，并且基于基于XML的消息协议。像OAuth2一样，您必须与身份验证提供者打交道。</p><h1 id="3f49" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">我的5美分</h1><p id="2177" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">从我个人的经验来看，如果你有一个简单的服务器到服务器或客户端到服务器的设置，我会推荐使用JWT。如果您的API涉及多个端点和设备，OAuth2将为您提供更好的服务，提供对知名(可信)认证提供商的访问，如Google、Microsoft或Apple。</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5f96b5007fefac60959b79b40cac8169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tYYjEJDqNSMHvWS0"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/@sigmund?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae jg" href="https://unsplash.com/s/photos/game-over-pixel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><h1 id="c301" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">错误处理</h1><p id="e252" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">每个应用程序都会遇到错误，在API上甚至可能是调用者的错误。拥有一个可靠的错误处理和通信模型将使您的API和依赖产品更加健壮。像身份验证一样，依赖市场标准不要创建定制的解决方案向客户传达错误。一个好的错误响应应该总是包含:</p><h1 id="6d56" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">HTTP状态代码</h1><p id="a2fc" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">(当然，这取决于你的技术水平)<br/>让呼叫者快速查看请求是否成功。</p><h1 id="4f71" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">内部参考ID</h1><p id="2abd" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">这将帮助您记录您的自定义错误场景，并确保错误处理配得上处理这个术语。沟通和记录是关键，在结束语中会有更多的介绍。</p><h1 id="b931" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">人类可读的信息</h1><p id="0119" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">开发人员也是人，有一个人可读的信息，其中包含背景、原因和可能的解决方案或文档链接的摘要，可以拯救别人的一天。</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mz"><img src="../Images/50301dfc200a170f3da7a737f80e5dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-P1ZDZSL8yWbShShdii_w.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@dtopkin1?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">戴恩·托普金</a>在<a class="ae jg" href="https://unsplash.com/s/photos/start?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="db20" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">摘要</h1><p id="6432" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">创建一个好的API不是一件容易的事情，你必须考虑正确的技术、认证和请求处理。最重要的是，你需要记录你的工作，并向每个应该使用你的API的人提供例子和细节。<br/>有一个工具可以帮你完成部分工作，它是开源的，甚至提供了一种为你的API自动生成客户端代码的方法，那就是<a class="ae jg" href="https://swagger.io/" rel="noopener ugc nofollow" target="_blank"> Swagger </a>。<br/>旋转一下，实现你的API梦想。</p></div></div>    
</body>
</html>