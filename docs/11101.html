<html>
<head>
<title>Up and Running with Azure Kubernetes Service (AKS) and DevOps Pipelines — Deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Azure Kubernetes服务(AKS)和DevOps管道启动和运行—部署</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/up-and-running-with-azure-kubernetes-service-aks-and-devops-pipelines-deployment-40f054071477?source=collection_archive---------3-----------------------#2022-02-16">https://levelup.gitconnected.com/up-and-running-with-azure-kubernetes-service-aks-and-devops-pipelines-deployment-40f054071477?source=collection_archive---------3-----------------------#2022-02-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e689" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第3部分— <em class="kl">使用Azure DevOps管道部署到Kubernetes</em></strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/b1529a9bec791d833a2e32d0f30a1635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VVl_m89l-7K6Fa709pCKaQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">管道——照片由<a class="ae lc" href="https://www.pexels.com/@hngstrm?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">亨利&amp;公司</a>从<a class="ae lc" href="https://www.pexels.com/photo/gray-metal-pipe-beside-wall-1983924/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</figcaption></figure><p id="4d89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们回到AKS和DevOps管道系列的第三部分(也是最后一部分)。如果您刚刚加入我们的旅程，您可能想看看这个系列的前两部分:<a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/up-and-running-with-azure-kubernetes-service-aks-and-devops-pipelines-2208c24378ff"> <em class="kl">在Azure门户中设置AKS</em></a><em class="kl"/>和<em class="kl"> </em> <a class="ae lc" href="https://tbd" rel="noopener ugc nofollow" target="_blank"> <em class="kl">配置Kubernetes集群</em> </a></p><p id="23c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的Kubernetes集群应该已经启动并运行了，所以我们剩下要做的就是配置我们的Azure DevOps管道。</p><p id="19e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从任何管道开始，我们显然必须有一个要部署的应用程序和一个存放它的存储库。如果你心中还没有一个应用程序，你可以把这个<a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/a-containerized-nodejs-express-hello-world-application-28d286556890">超级简单的NodeJS+Express“Hello World”应用程序</a>组合在一起。</p><h1 id="1870" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><strong class="ak">先决条件</strong></h1><h2 id="a6dd" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak"> Azure容器注册表</strong></h2><p id="15a2" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">如果您已经有了一个容器注册中心，可以将容器放入其中，那么这一步就没有必要了。如果没有，Azure Container Registry是一个很好的地方。</p><p id="7622" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前往你的<a class="ae lc" href="https://portal.azure.com" rel="noopener ugc nofollow" target="_blank"> Azure门户</a>并选择左手边的<strong class="jp ir"> <em class="kl">创建资源</em> </strong>。从那里，选择“<strong class="jp ir"><em class="kl"/></strong>”面板下的“<strong class="jp ir"> <em class="kl">容器</em> </strong>，然后选择“<strong class="jp ir"> <em class="kl">容器注册表</em> </strong>”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ms"><img src="../Images/de20e28cb8f5789aa52b8dabf54d2589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E_Ybw3urYDEbZ32QlxFD-w.png"/></div></div></figure><p id="b21b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一页(创建容器注册表)，选择要部署到的订阅和资源组，或者使用“<strong class="jp ir"> <em class="kl">”创建新的</em> </strong>”创建新的资源组。输入注册表名称，该名称在所有Azure容器注册表中必须是唯一的。选择要部署的地区，在SKU下拉列表中选择“<strong class="jp ir"> <em class="kl">基本</em> </strong>”。接下来，选择底部的“<strong class="jp ir"> <em class="kl">审核+创建</em> </strong>”按钮，然后选择“<strong class="jp ir"><em class="kl"/></strong>”按钮。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mt"><img src="../Images/cd334323417171bda80802e789a0e3bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PV0ZKfLD5FAq6SsMi655YQ.png"/></div></div></figure><blockquote class="mu mv mw"><p id="f3ea" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong> <br/>这里我们不讨论任何网络或加密选项，因为基本SKU不支持这些项目的定制。有关可用SKU及其适用定价的更多信息，请参见<a class="ae lc" href="https://azure.microsoft.com/en-us/pricing/details/container-registry/" rel="noopener ugc nofollow" target="_blank">定价—集装箱注册</a></p></blockquote><h1 id="6776" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><strong class="ak">项目设置</strong></h1><h2 id="a90f" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">创建Azure DevOps组织</strong></h2><p id="b406" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">为了利用Azure DevOps的力量，我们创建一个Azure devo PS组织是有意义的！前往<a class="ae lc" href="https://dev.azure.com" rel="noopener ugc nofollow" target="_blank">https://dev.azure.com</a>并选择“自由启动”按钮。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi na"><img src="../Images/277a127adb36bd507ac2b309bad4310e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T3tFA34DOyuz4aKu3Bq2ZQ.png"/></div></div></figure><blockquote class="mu mv mw"><p id="dc77" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">请记住，“免费开始”链接的位置可能会随着时间的推移而改变，但在撰写本文时，它就在这里！</p></blockquote><p id="0a08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里，你将继续使用你的Azure帐户登录，它应该会带你到你的项目仪表板。如果你<strong class="jp ir"> <em class="kl">从来没有</em> </strong>使用过Azure DevOps，会提示你创建一个项目开始使用。如果您<strong class="jp ir"> <em class="kl">已经</em> </strong>使用了Azure DevOps，您将看到显示您组织中不同项目的卡片。</p><h2 id="cece" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated">创建项目</h2><p id="6f15" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">在这里，您需要输入一个项目名称，并确保可见性是“<strong class="jp ir"><em class="kl"/></strong>”。从那里，展开“<strong class="jp ir"> <em class="kl">【高级】</em> </strong>”面板，并确保“<strong class="jp ir"> <em class="kl">【版本控制】</em> </strong>”被设置为“<strong class="jp ir"><em class="kl">【Git】</em></strong>”。然后，选择<strong class="jp ir"> <em class="kl">创建</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/1a988f92e6c8ed14ecd4ff6dbf4780f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHvTvUcRa1-O1arBsH6Fag.png"/></div></div></figure><blockquote class="mu mv mw"><p id="e200" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong> <br/>如果您在“<strong class="jp ir">高级</strong>”面板下还有一个“<strong class="jp ir">工作项流程</strong>”下拉菜单，您可以将其保留为“<strong class="jp ir">基本</strong>”或选择您喜欢的任何其他流程。虽然这是在真实场景中设置项目的关键步骤，但它与本文的范围无关。</p></blockquote><p id="f50c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，您将看到关于新项目的摘要信息。它应该包含一个面板，其中包含“<strong class="jp ir"><em class="kl"/></strong>”、“<strong class="jp ir"> <em class="kl">板卡</em> </strong>”、“<strong class="jp ir"> <em class="kl"> Repos </em> </strong>”、“<strong class="jp ir"> <em class="kl">管道</em> </strong>”、“<strong class="jp ir"> <em class="kl">测试计划</em> </strong>”、“<strong class="jp ir"> <em class="kl">工件</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/7243b137326ff39767b589337abef24a.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*Ip-yLym_eY9BEP2xZdQg4A.png"/></div></figure><blockquote class="mu mv mw"><p id="dc10" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">与吉拉等其他解决方案相比，使用Azure DevOps的最大优势之一是，当你创建一个新项目时，你的董事会/Backlog、代码仓库、管道、测试计划和工件都在一个地方，并且无缝链接在一起，无需任何配置——开箱即用。当然，您可以自定义一些东西，但是在其他解决方案中这样做可能需要几个小时(如果不是几天甚至几周)才能将它连接到其他解决方案以获得相同的功能，更不用说正确使用它所需的配置了！</p></blockquote><h2 id="2c84" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated">建立服务连接</h2><p id="a6a9" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">在我们可以连接我们的Azure门户资源(例如AKS &amp; Azure Container Registry)之前，我们需要在Azure DevOps中创建和链接一个服务连接。</p><p id="115c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们希望建立三个服务连接，一个用于Azure资源管理器，一个用于Azure容器注册，一个用于Azure Kubernetes服务。</p><p id="8b9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确保您在我们刚刚创建的新项目中，然后转到左侧导航栏底部的<strong class="jp ir"> <em class="kl">【项目设置】</em> </strong>，然后选择<strong class="jp ir"><em class="kl"/></strong><strong class="jp ir"><em class="kl">【管道】</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/fe34e0fe926a4cade87637abf433d5b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*zFBBxX-7HujB23mnd4KItw.png"/></div></figure><p id="9ad3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，选择<strong class="jp ir"> <em class="kl">“创建服务连接”</em> </strong>按钮，或者<strong class="jp ir"> <em class="kl">“新服务连接”</em> </strong>(如果已经存在)。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nd"><img src="../Images/fca204b09594e8b3d3ac248f72851568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUrXqMY9vqRg6IBWHRcYrQ.png"/></div></div></figure><p id="96b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您已经有服务连接</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ne"><img src="../Images/6424b20afd72d15a79e57d2ce1cb85a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z7Qn_91sb31I3FmYfG85Rw.png"/></div></div></figure><h2 id="daf3" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated">Azure资源管理器</h2><p id="0972" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">在打开的面板上，选择“Azure资源管理器”,然后选择面板底部的“下一步”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/08ca787b674535d56ec6e554adf3174b.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*RDsPrBSlNnTPk-cXgtrleg.png"/></div></figure><p id="0d71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在那里，选择“服务主体(自动)”，然后选择“下一步”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/5a1e9d981b58d526063fe3ed0a587e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*gEvV7mM5U1viqkbi-l4aZw.png"/></div></figure><p id="5076" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，确保将“<strong class="jp ir"> <em class="kl">作用域级别</em> </strong>设置为<strong class="jp ir"> <em class="kl">【订阅】</em>，<em class="kl">【资源组】</em> </strong>设置为我们之前创建的包含您的Kubernetes和容器注册表的资源组的名称，输入您选择的“<strong class="jp ir"> <em class="kl">服务连接名称</em> </strong>，然后选择“<strong class="jp ir"> <em class="kl">授予对所有管道的访问权限【T63然后，选择<strong class="jp ir"> <em class="kl">【保存】</em> </strong>。</em></strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/7c5efddb48c5bbe8bbc9e350b13f53aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*vMzz3aBhm-2Q1R8iO8dDNw.png"/></div></figure><h2 id="bbff" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated">Azure容器注册表</h2><p id="0d14" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">在打开的面板上，选择<strong class="jp ir"><em class="kl">“Docker注册表”</em> </strong>，然后选择面板底部的<strong class="jp ir"> <em class="kl">“下一个”</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/b51593ec308b5727ba7cbea495357df3.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*P6nNDTmLtIP2PW3_xee4yw.png"/></div></figure><p id="17c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从那里，在<strong class="jp ir"> <em class="kl">【注册类型】下选择<strong class="jp ir"><em class="kl">【Azure Container Registry】</em></strong>，</em> </strong>选择您的订阅，确保<strong class="jp ir"> <em class="kl">【资源组】</em> </strong>设置为我们之前创建的包含您的容器注册表的资源组的名称，输入您选择的一个<strong class="jp ir"> <em class="kl">服务连接名称</em> </strong>，然后选择<strong class="jp ir"> <em class="kl">授予所有访问权限然后，选择<strong class="jp ir"> <em class="kl">【保存】</em> </strong>。</em></strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/dbccc8e9451983bc771ff04a76e933a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*s1BIr2BMhINfXXJgVI5FSg.png"/></div></figure><h2 id="7000" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated">蓝色库伯内特服务</h2><p id="3f70" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">在打开的面板上，选择面板底部的<strong class="jp ir"><em class="kl">【Kubernetes】</em></strong>，然后选择<strong class="jp ir"> <em class="kl">【下一步】</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0d59d71a36cadf0091a6988e886e623e.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*TvKjQ1gsk2QsqWXjRAggcA.png"/></div></figure><p id="ec62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从那里，选择<strong class="jp ir"><em class="kl">【Azure订阅】</em></strong><strong class="jp ir"><em class="kl">【认证方式】</em> </strong>选择你的订阅，选择你的Kubernetes集群<strong class="jp ir"> <em class="kl">【集群】</em> </strong>设置命名空间为<strong class="jp ir"> <em class="kl">默认</em> </strong>，选择<strong class="jp ir"> <em class="kl">使用集群管理员凭证</em> </strong>，输入一个<strong class="jp ir"> <em class="kl">服务然后，选择<strong class="jp ir"> <em class="kl">【保存】</em> </strong>。</em></strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/478c003eaed75e272b378746f6d91fc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*8QUAgax5B35Rg-hJqhDnpA.png"/></div></figure><h2 id="a68f" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">设置知识库</strong></h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/478df770dafd0cba6fdc072030bbfeea.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*ZnCpH_eyPFD1iQFaEvJ2Mg.png"/></div></figure><p id="7baa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在项目面板上选择“<strong class="jp ir"><em class="kl"/></strong>”</p><p id="67f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，在“<strong class="jp ir"> <em class="kl">下从命令行</em> </strong>”部分，选择“<strong class="jp ir"><em class="kl"/></strong>”按钮。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nm"><img src="../Images/f12b4c0b36d73f07169e1885ff7645f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qnXcwv--V-80wu5_dnXiug.png"/></div></div></figure><p id="85a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里，转到您最喜欢的终端，导航到项目目录的根目录，粘贴您刚刚复制的命令，并运行它。</p><blockquote class="mu mv mw"><p id="736c" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">抬头！</strong> <br/>如果你的项目还没有被初始化为Git项目，你需要在粘贴上面的命令之前运行<strong class="jp ir"> git init </strong>。这当然假设您的机器上已经安装了Git，如果没有，您将需要安装它。下载<a class="ae lc" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">并安装</a> Git后，查看官方tutoria  l。</p><p id="cbe6" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">抬头！</strong> <br/>如果您还没有为您的Git配置设置Azure DevOps repositories授权，您需要这样做，以便将您的代码从您的本地机器推送到Azure DevOps repos。事实上，你上面<code class="fe nn no np nq b"><strong class="jp ir"><em class="iq">git remote add origin</em></strong></code>的方式可能会在此基础上改变。查看<a class="ae lc" href="https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops" rel="noopener ugc nofollow" target="_blank">官方文档</a>中的<strong class="jp ir">个人访问令牌</strong> (PATs)了解如何做到这一点。</p></blockquote><p id="eea8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦库被推送(在<strong class="jp ir">“从命令行推送现有库”</strong>部分<code class="fe nn no np nq b"><strong class="jp ir">git push -u origin --all</strong></code>中的第二个命令)，在项目面板上选择“<strong class="jp ir"> <em class="kl">文件</em> </strong>”。</p><p id="cb2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在需要设置一个集成分支，这样我们就可以将变更推送到我们的工作分支，然后在我们的集成分支中创建pull请求，我们将设置它来触发我们的构建！所以，选择"<strong class="jp ir"> <em class="kl">主</em> </strong>"下拉列表上方的"<strong class="jp ir"> <em class="kl">文件</em> </strong>"页面，然后选择选项为"<strong class="jp ir"> <em class="kl">"新建分支"</em> </strong>"。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nr"><img src="../Images/b8a5e9fd9b297df7837e08b384ef5e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Z-xHVkGR2QCHcyJyEKVhw.png"/></div></div></figure><p id="7870" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在弹出的对话框中，在“<strong class="jp ir"><em class="kl"/></strong>”框下输入“<strong class="jp ir"> <em class="kl">集成</em> </strong>”，然后选择“<strong class="jp ir"> <em class="kl">创建</em> </strong>”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/6aa68a7a7bbdd3d8dc03d3ae2b9710be.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*IbzDtvEUJpa1BOO6a-1gLQ.png"/></div></figure></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><h1 id="4d55" class="ld le iq bd lf lg oa li lj lk ob lm ln lo oc lq lr ls od lu lv lw oe ly lz ma bi translated"><strong class="ak">设置构建过程</strong></h1><h2 id="97c3" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">创建版本</strong></h2><p id="74ed" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">既然我们已经创建了项目，我们的分支也准备好了，我们需要设置构建过程来构建我们的项目(在本文的例子中:运行NodeJS应用程序的docker容器),并将其发送到容器注册中心。</p><blockquote class="mu mv mw"><p id="f9cd" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong> <br/> NodeJS应用程序离唯一可以这样部署的应用程序<strong class="jp ir">很远</strong>。事实上，天空才是极限。在这个过程中，您可以构建用C、C#、C++、Java、Kotlin、Objective C、Python、Swift和许多其他语言编写的应用程序(既可以在Docker容器中也可以是独立的)。</p></blockquote><p id="8ed4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在您创建了主分支的集成分支后，您需要继续选择<strong class="jp ir"> <em class="kl">“设置构建”</em> </strong>按钮</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi of"><img src="../Images/8f239779124bebf954e6cc3909b37bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjmfwmewHVWNW152ODsSsA.png"/></div></div></figure><p id="8e87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一页上，将会提示您使用一个模板来帮助您创建构建。在本文使用的示例中，我们将选择“<strong class="jp ir"> <em class="kl"> Docker —构建并推送一个映像到Azure容器注册表</em> </strong>”。然而，如果你使用不同的构建过程(比如说在docker容器之外，或者你没有把你的容器推到Azure容器注册表)，你总是可以选择<strong class="jp ir"><em class="kl">“Starter pipeline”</em></strong>然后从那里开始！</p><blockquote class="mu mv mw"><p id="8021" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">抬头！</strong> <br/>可用的选项可能因您而异，但您可以通过滚动到底部并选择“<strong class="jp ir">显示更多</strong>按钮来查看所有可用的模板。如果您没有看到您的场景的模板，您可以选择“<strong class="jp ir"> Starter pipeline </strong>”并手动配置。</p><p id="210e" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">抬头！</strong> <br/>如果系统提示您选择要使用的订阅(如果您的组织有多个订阅)，请选择包含您将部署到的资源的订阅(如果您遵循整个文章系列，这将是您在第1部分中创建资源的订阅— <a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/up-and-running-with-azure-kubernetes-service-aks-and-devops-pipelines-2208c24378ff">使用Azure Kubernetes Service (AKS)和DevOps Pipelines </a>)。</p></blockquote><p id="cc08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我们选择了“<strong class="jp ir"><em class="kl">”Docker—构建并推送一个映像到Azure容器注册表</em> </strong>”模板，因此我们可以选择Azure订阅中的所有容器注册表。选择“<strong class="jp ir">容器注册表</strong>”下拉菜单，并选择我们在上面的<strong class="jp ir"> <em class="kl">先决条件</em> </strong>中创建的“<strong class="jp ir"> <em class="kl"> companycr01 </em> </strong>”容器注册表。</p><p id="f3bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里，输入我们将要部署的"<strong class="jp ir"> <em class="kl">映像名称</em> </strong>"。然后，选择<strong class="jp ir"> <em class="kl">验证并配置</em> </strong>。给它一些时间来验证。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ffb6a972712ec20498f29bcd81bd379e.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*2_TO2B2wyCDC87HSopwXtw.png"/></div></figure><p id="a36b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看那个！Azure DevOps自动创建了YAML文件，并让我们准备好构建和上传到我们的容器注册表——就这样！<br/>选择<strong class="jp ir"> <em class="kl">保存并运行</em> </strong>。</p><p id="352a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Azure DevOps还保留了一个管道变更库，就像您保留了一个源代码库一样。将显示一个<strong class="jp ir"> <em class="kl">“保存并运行”</em> </strong>面板，让您能够更改该构建配置的提交消息。输入您想要的内容，然后选择“<strong class="jp ir"> <em class="kl">”保存并运行</em> </strong>”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/f015de96fb5644f13bec47229cd0f6d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*f1SxtTxGuVGMmzPuSXE4_w.png"/></div></figure><blockquote class="mu mv mw"><p id="0eb9" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">抬头！</strong> <br/>如果您设置了分支策略(例如，不直接提交到集成分支——例如，仅提交请求),您可能需要选择<strong class="jp ir">“为此提交创建一个新分支”</strong>。如果您只是跟随本教程，您可以将它留为<strong class="jp ir">“直接提交到集成分支”</strong>。</p></blockquote><p id="353d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Azure DevOps将创建管道，并运行它。在下一页上，您将看到关于构建的信息，例如<strong class="jp ir"> <em class="kl">构建名称</em> </strong>和<strong class="jp ir"> <em class="kl">提交消息</em> </strong>，触发该构建的<strong class="jp ir"> <em class="kl">分支</em> </strong>和<strong class="jp ir"> <em class="kl">提交</em> </strong>，以及该流程的<strong class="jp ir"> <em class="kl">作业</em> </strong>的状态(是的，您可以有多个作业—或者任务—作为构建的一部分运行。这些可以并行或异步运行。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oi"><img src="../Images/f5e0323e33cd193dd258983d08fe9c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MFtg0JWz5_je9bUAf65Itg.png"/></div></div></figure><p id="0790" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一切顺利，你的<strong class="jp ir"> <em class="kl">构建</em> </strong>的状态应该在一会儿之后变为<strong class="jp ir"> <em class="kl">成功</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oj"><img src="../Images/7a43d7be8e504bb5daeb96872a3b07fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xv7MOWluf16gNDOQssizQw.png"/></div></div></figure><blockquote class="mu mv mw"><p id="9110" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">注</strong> <br/>通过选择显示整体状态的作业，您可以查看作为作业一部分执行的每个活动的状态。</p></blockquote><h2 id="6473" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">在容器注册表中验证容器</strong></h2><p id="68d1" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">在我们继续之前，让我们先验证一下我们的容器确实在我们的容器注册表中！</p><p id="68d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次打开<a class="ae lc" href="https://portal.azure.com" rel="noopener ugc nofollow" target="_blank"> Azure门户</a>，在上面<strong class="jp ir"> <em class="kl">先决条件</em> </strong>中创建的Azure容器注册中心内，选择“<strong class="jp ir"> <em class="kl">服务</em> </strong>”下的“<strong class="jp ir"> <em class="kl">存储库</em> </strong>，然后选择存储库(在我们的例子中，它是<strong class="jp ir"> <em class="kl"> companycr01 </em> </strong>)，然后选择标签</p><p id="a95a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里，您应该能够看到集装箱的所有信息，包括货单。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ok"><img src="../Images/531fc4236f6d5757de6c6ab5fd0d5f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GXpg1nIcSJNhGlimoAf1-A.png"/></div></div></figure><p id="a205" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">测试管道触发器</strong></p><p id="9e58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，这太棒了，我们现在有了要构建的管道，并在提交时自动发送到容器注册表。但是，您可能想测试一下这是否可行。</p><p id="b047" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在您的代码编辑器(Visual Studio代码？)或者喜欢的终端，从我们在Azure DevOps的代码库中下拉我们的集成分支:<br/> <code class="fe nn no np nq b"><strong class="jp ir">git pull origin integration</strong></code> <br/>然后，切换到集成分支:<br/> <code class="fe nn no np nq b"><strong class="jp ir">git checkout integration</strong></code></p><p id="51ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们需要从集成it分支到我们的特性分支(这将是您正在工作的代码的工作分支——无论它是一个故事、一个任务、一个冲刺，还是您的团队的任何分支策略)。<br/>对于这篇文章，我们称它为<strong class="jp ir"> <em class="kl">【特征-a】</em></strong>:<br/><code class="fe nn no np nq b"><strong class="jp ir">git branch integration feature-a</strong></code><br/>然后检查新的分支:<br/> <code class="fe nn no np nq b"><strong class="jp ir">git checkout feature-a</strong></code></p><p id="55e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，对代码中的任何文件进行您想要的任何更改并保存它(只要更改不是在<strong class="jp ir"> <em class="kl">中列出的文件中进行的)。git ignore</em>T22！).</strong></p><p id="d9d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，让我们提交我们的更改，并将其推送到Azure DevOps中的远程存储库。<code class="fe nn no np nq b"><strong class="jp ir">git commit -a -m "Added info to README"</strong></code></p><blockquote class="mu mv mw"><p id="0f9a" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong><br/>git commit命令中的<code class="fe nn no np nq b"><strong class="jp ir">-a</strong></code>选项告诉git在一个步骤中提交<strong class="jp ir">和</strong>阶段。<code class="fe nn no np nq b"><strong class="jp ir">-m</strong></code>命令应该是不言自明的——它提供了提交消息！</p></blockquote><p id="952e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们需要推送到Azure DevOps中的远程存储库。<br/>T7】</p><p id="5cf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们返回到Azure DevOps，并在左侧面板上的“<strong class="jp ir"><em class="kl">【Repos】</em></strong>”下选择“<strong class="jp ir"> <em class="kl">文件</em> </strong>”，我们应该会看到“<strong class="jp ir"> <em class="kl">功能-a </em> </strong>”刚刚已经更新，并提示我们创建一个拉取请求。因此，让我们继续并选择“<strong class="jp ir"> <em class="kl">创建一个拉动式请求</em> </strong>”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ol"><img src="../Images/a45316cd19d08b0b25f24b6c562c25ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yAXh51eXA-v9QFbfY1prBA.png"/></div></div></figure><p id="292b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一页，确保合并方向是从<strong class="jp ir"> <em class="kl">特征-a </em>到<em class="kl">集成</em> </strong>。如果不是，请选择适用的下拉列表来纠正这一点(如果您没有在Azure DevOps中进行我们在此设置之外的任何操作，它很可能会显示<strong class="jp ir"> <em class="kl">功能-将</em>转换为<em class="kl">main</em></strong>-这是您想要更改的！).</p><p id="69e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦这一点得到验证并根据需要进行更改，选择“<strong class="jp ir"> <em class="kl">创建</em> </strong>”按钮。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi om"><img src="../Images/1b18cbf44921556f819d9838ecbbf32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s0ncv_abQeqJrZDHizQ1BQ.png"/></div></div></figure><blockquote class="mu mv mw"><p id="e39a" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong> <br/>一些额外的项目有点超出了本文的范围，但是仍然非常有用:<br/> <strong class="jp ir"> - Reviewers </strong> <br/>允许您选择一个或多个用户和/或组，作为可选或必需的评审者添加到这个提交中。</p><p id="425e" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir"> -添加必需的评审者</strong> <br/>将所有提交的必需评审者添加到该分支(集成)。这对于首席开发人员、架构师、QA或其他人在构建和管道开始之前所要求的审查非常有用。</p><p id="622a" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir"> -要链接的工作项</strong> <br/>将Azure DevOps板中的工作项交叉链接到此提交。这将显示板中适用工作项的提交，并将显示提交中的适用工作项。看，我告诉过你这是现成的！</p></blockquote><p id="94e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧！下一页是我们批准和完成合并请求的地方(随后启动我们的自动构建过程)。选择<strong class="jp ir"> <em class="kl">批准</em> </strong>按钮，然后选择<strong class="jp ir"> <em class="kl">【完成】</em> </strong>按钮，打开<strong class="jp ir"> <em class="kl">完成拉动请求</em> </strong>面板。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi on"><img src="../Images/5309f8695b396a1a60f029ae1d6fdfd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vjL6jMTTz40vwIyw1p2khw.png"/></div></div></figure><p id="ccc5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在打开的“<strong class="jp ir"> <em class="kl">完成拉动请求</em> </strong>”面板上，保留所有选项不变(除非你知道自己在做什么，需要改变一些东西)，然后选择“<strong class="jp ir"> <em class="kl">完成合并</em> </strong>”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/be952704a419e856e6d8568b237205bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*wjJEDlVLOHEvrp3MjV44sw.png"/></div></figure><blockquote class="mu mv mw"><p id="384e" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong> <br/>如果您是审批者，您可以选择<strong class="jp ir">批准</strong>按钮或使用那里的下拉菜单选择其他操作，如“<strong class="jp ir">拒绝</strong>”。当然，你可能想在“<strong class="jp ir">添加注释</strong>”框中添加注释，以帮助编写代码的人修复问题！</p><p id="e5aa" class="jn jo kl jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">抬头！</strong> <br/>如果合并完成前需要审批，必须选择<strong class="jp ir">审批</strong>按钮，并选择在<strong class="jp ir">完成</strong>前完成的流程。</p></blockquote><p id="423b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，导航到左侧面板上“<strong class="jp ir"> <em class="kl">管道</em> </strong>”下的“<strong class="jp ir"> <em class="kl">管道</em> </strong>”来查看管道运行中自动构建的结果。它将显示触发它的合并、它被触发的时间以及完成它所花费的时间。您还可以选择管道来查看更多细节，就像我们之前在初始设置该管道时所做的那样。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi op"><img src="../Images/5e33823b3cc3da40aae6e9a02664d370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVlhjPLTqnvpYlD7WZxVHw.png"/></div></div></figure></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><h1 id="35b5" class="ld le iq bd lf lg oa li lj lk ob lm ln lo oc lq lr ls od lu lv lw oe ly lz ma bi translated"><strong class="ak">释放它</strong></h1><p id="9442" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">我知道这是一个漫长的旅程，但信不信由你，我们几乎完成了！下一步是进入发布渠道，创造一些真正的奇迹。</p><h2 id="7525" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">设置发布管道</strong></h2><p id="17d2" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">导航到Azure DevOps左侧面板上的“<strong class="jp ir"> <em class="kl">管道</em> </strong>”然后“<strong class="jp ir"> <em class="kl">释放</em> </strong>”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/5b4a6e55323aaba29a0e54c6656813f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*btcO6KeuUWMZf-b1PSNZOw.png"/></div></figure><p id="5561" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在主页面上选择<strong class="jp ir"> <em class="kl">新建管道</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi or"><img src="../Images/3f900b8eb3c8109d23044f399280e265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JUpGfxN50vGixqzUWIAE0g.png"/></div></div></figure><p id="7568" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，您将被带到一个页面，显示新的发布管道设置。从自动弹出的<strong class="jp ir"> <em class="kl">“选择模板”</em> </strong>面板中，滚动到底部，选择<strong class="jp ir"> <em class="kl">“空作业”</em> </strong>，然后选择<strong class="jp ir"> <em class="kl">“应用”</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi os"><img src="../Images/111ac7b96c04d1dcf8a18a534a26bce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxgBHZxzodA5ObCHZ116ig.png"/></div></div></figure><p id="b7f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一个打开的面板上，在“<strong class="jp ir"> <em class="kl">艺名</em> </strong>下，输入“<strong class="jp ir"> <em class="kl"> Dev </em> </strong>”巧妙地引用开发环境！然后，简单的收尾这个面板(这个面板上没有其他按钮来“<strong class="jp ir"> <em class="kl">保存</em> </strong>”，你只要关闭就可以了)。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi os"><img src="../Images/1091b1bb1b4ef195d7f737a1e277a12f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fylTDooizIysXhxh1gtpqw.png"/></div></div></figure><h2 id="8121" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">添加一个神器</strong></h2><p id="4d2a" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">让我们选择<strong class="jp ir"> <em class="kl">添加一个神器</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/33f305c5f934cd0e3af1b16ed25b1c41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*n88JMaxs2g_CtPjNzJ8m9w.png"/></div></figure><p id="b76d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在打开的"<strong class="jp ir"> <em class="kl">添加一个工件</em> </strong>面板上，留下"<strong class="jp ir"> <em class="kl">构建</em> </strong>"作为选择选项在"<strong class="jp ir"> <em class="kl">源类型</em> </strong>下，选择你的"<strong class="jp ir"> <em class="kl">项目</em> </strong>"和"<strong class="jp ir"> <em class="kl">源</em> </strong>"(这应该是我们之前创建的构建管道)。然后，确保“<strong class="jp ir"> <em class="kl">默认版本</em> </strong>”设置为“<strong class="jp ir"> <em class="kl">最新</em> </strong>”，并输入“<strong class="jp ir"> <em class="kl">降</em> </strong>”为“<strong class="jp ir"> <em class="kl">源别名</em> </strong>”。最后，选择<strong class="jp ir"> <em class="kl">添加</em> </strong>。通过选择<strong class="jp ir"><em class="kl">【Build】</em></strong>，我们告诉发布程序从先前的管道构建中获取它所引用和发布的工件。<strong class="jp ir"> <em class="kl">【源别名】</em> </strong>仅仅是一个名字，帮助区分不同的工件进行触发。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ou"><img src="../Images/ee4dfdf2c92c865bac150cb6ccce369b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*DxhnB0G3mAbXeiHJ06dtYw.png"/></div></div></figure><h2 id="351c" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">设置阶段</strong></h2><p id="88f2" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">继续选择我们之前创建的"<strong class="jp ir"><em class="kl">" 1 job，0 task</em></strong>" text on "<strong class="jp ir"><em class="kl">Dev</em></strong>" stage(不要只是单击"<strong class="jp ir"><em class="kl">【Dev】</em></strong>stage，它会将您带到一个与我们希望的不同的地方！).</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ov"><img src="../Images/0d3b21a2f5d47daf8239541fe4a9f825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VuvYgp8P_SBnUh4sguYD5w.png"/></div></div></figure><p id="c1fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这应该会打开一个相当无聊的页面，但我们肯定会改变这一点！<br/>选择<strong class="jp ir"> <em class="kl">代理工作</em> </strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ow"><img src="../Images/f9c90631614e860396da397abde6d795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85QleZukS2LLwMZFz1IDyA.png"/></div></div></figure><p id="5c07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在打开的“<strong class="jp ir"> <em class="kl">代理作业</em> </strong>”面板上，您需要做几件事情。首先，在<strong class="jp ir"> <em class="kl">代理规格</em> </strong>下选择首选代理。对于大多数情况来说，“<strong class="jp ir"><em class="kl">-Ubuntu-latest</em></strong>”就足够了。但是，如果您有特定的代理需求，比如MacOS版本(比如iOS应用程序？)或本机Windows应用程序，您可以根据自己的特定需求选择合适的应用程序。</p><p id="a979" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个面板的下面，您会发现另一个选项，如果您正在使用来自安全位置的变量，您会想要检查这个选项:“允许脚本访问OAuth令牌 ”。这样做，然后选择面板顶部的<strong class="jp ir"> <em class="kl">保存</em> </strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ox"><img src="../Images/9aa3df65497e8f7bb274f21884797fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7pzfrzGC1JB4_BqLM6H7eA.png"/></div></div></figure><p id="98a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦选择了“<strong class="jp ir"> <em class="kl">【保存】</em> </strong>”，系统会提示您保存的文件夹。保留默认设置，选择<strong class="jp ir"> <em class="kl">确定</em> </strong>。</p><h2 id="f0e2" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">生成Kubernetes清单文件</strong></h2><p id="07a5" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">对于此任务，我们将使用PowerShell。所以，选择“<strong class="jp ir"> <em class="kl"> + </em> </strong>”按钮旁边的“<strong class="jp ir"> <em class="kl">”代理作业</em> </strong>”。然后，搜索“<strong class="jp ir"> <em class="kl">电源</em> </strong>或“<strong class="jp ir"> <em class="kl"> powershell </em> </strong>”并选择“<strong class="jp ir"> <em class="kl"> PowerShell </em> </strong>”选项，然后选择“<strong class="jp ir"> <em class="kl">添加</em> </strong>”。</p><p id="16b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，选择左侧的新任务。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oy"><img src="../Images/acc2c952fbbd28a86da1af97b68a19b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r2ZjH4pZqOIK7vU-D6EqYg.png"/></div></div></figure><ul class=""><li id="a2b3" class="oz pa iq jp b jq jr ju jv jy pb kc pc kg pd kk pe pf pg ph bi translated"><strong class="jp ir">任务版本<br/> </strong>将此设置为<strong class="jp ir"> <em class="kl"> "2。*" </em> </strong>(或您可用的最新版本)。</li><li id="f675" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">显示名称<br/> </strong>将此改为对任务有意义的名称，如<strong class="jp ir"/><strong class="jp ir"><em class="kl">生成Kubernetes清单文件</em> </strong></li><li id="12c0" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">键入</strong> <br/>选择“<strong class="jp ir"> <em class="kl">内联</em> </strong>”表示我们将内联输入我们的脚本信息，而不是从文件中提取。</li><li id="057c" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">脚本</strong> <br/>输入下面的脚本，并记下带有<code class="fe nn no np nq b"><strong class="jp ir">#</strong></code>符号的注释。</li></ul><pre class="kn ko kp kq gt pn nq po pp aw pq bi"><span id="1747" class="mb le iq nq b gy pr ps l pt pu"><strong class="nq ir">'# demoapp/deployment.yaml<br/># Deployment<br/>apiVersion: apps/v1<br/>kind: Deployment<br/># Provide some metadata for help referring to our containers<br/>metadata:<br/>  name: demo-app<br/>  labels:<br/>    app: demo-app<br/>spec:<br/>  # Tell Kubernetes how many replicas to create initially<br/>  replicas: $(REPLICAS__TO__USE)<br/>  # Enter a selector name (again for reference)<br/>  selector:<br/>    matchLabels:<br/>      app: demo-app<br/>  template:<br/>    # More metadata<br/>    metadata:<br/>      labels:<br/>        app: demo-app<br/>    spec:<br/>      containers:<br/>        # Tell Kubernetes where to get the container from<br/>        - name: demo-app<br/>          image: companycr01.azurecr.io/demo-app:$(Build.BuildId)<br/># Set the port for which the container will run on<br/>        # This should be the same as the port in your app config         <br/>          ports:<br/>            - name: http<br/>              containerPort: $(HTTP_LISTEN_PORT)<br/>              protocol: TCP<br/>          env:<br/>            - name: REPLICAS<br/>              value: "$(REPLICAS__TO__USE)"<br/>            - name: HTTP_LISTEN_PORT<br/>              value: "$(HTTP_LISTEN_PORT)" <br/>---<br/># demoapp/service.yaml<br/># Service<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: demo-app<br/>  labels:<br/>    app: demo-app<br/>spec:<br/>  type: LoadBalancer<br/>  ports:<br/>    - port: $(HTTP_LISTEN_PORT)<br/>      targetPort: http<br/>      protocol: TCP<br/>      name: http<br/>  selector:<br/>    app: demo-app' | Set-Content $(Agent.TempDirectory)/manifest.yaml'#</strong></span></pre><p id="8ae4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">保存<br/> </strong>选择<em class="kl">【保存】</em> ，然后在出现的对话框中选择<strong class="jp ir"> <em class="kl">【确定】</em> </strong>。</p><h2 id="a220" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">部署Kubernetes清单</strong></h2><p id="0eb3" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">既然我们的清单已经生成，我们就可以部署它了(这会告诉Kubernetes拉容器并进行部署)。对于这个任务，我们将使用“<strong class="jp ir"> <em class="kl">部署到Kubernetes </em> </strong>”。所以，再次选择“<strong class="jp ir"> <em class="kl"> + </em> </strong>”按钮旁边的“<strong class="jp ir"> <em class="kl">”代理作业</em> </strong>。然后，搜索“<strong class="jp ir"> <em class="kl">部署</em> </strong>，选择“<strong class="jp ir"> <em class="kl">部署到Kubernetes </em> </strong>”选项，然后选择“<strong class="jp ir"> <em class="kl">添加</em> </strong>”。</p><p id="b32f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里，选择左侧的新任务，然后在打开的新面板中:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pv"><img src="../Images/abc864d9f699ddeb2c50e30c2c031e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PWKp7r8vqm97V9ThzUI7kg.png"/></div></div></figure><ul class=""><li id="ea08" class="oz pa iq jp b jq jr ju jv jy pb kc pc kg pd kk pe pf pg ph bi translated"><strong class="jp ir">任务版本</strong> <br/>设置此项为" 0。*(或您可用的最新版本)</li><li id="5b9f" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">显示名称</strong> <br/>输入一个有意义的名称，你懂的……类似于<strong class="jp ir"> <em class="kl">【部署到Kubernetes】</em></strong>。</li><li id="c153" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">动作</strong> <br/>选择<strong class="jp ir"> <em class="kl">【部署】</em> </strong>进行动作。</li><li id="303f" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir"> Kubernetes服务连接</strong> <br/>选择我们之前创建的服务连接<strong class="jp ir"><em class="kl">" PrimarySC _ AKS "</em></strong></li><li id="ceda" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">命名空间</strong> <br/>在<strong class="jp ir"> <em class="kl">【命名空间】</em> </strong>字段中输入变量<code class="fe nn no np nq b"><strong class="jp ir">$(KUBERNETES__NAMESPACE__DEMO_APP)</strong></code>。</li><li id="69da" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">策略</strong> <br/>将此设置保留为<strong class="jp ir"> <em class="kl">【无】</em> </strong></li><li id="5010" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">清单</strong> <br/>在此字段中，您需要选择我们将部署清单的位置。这恰好是我们在前一个任务中生成的，所以输入/选择<code class="fe nn no np nq b"><strong class="jp ir">$(Agent.TempDirectory)/manifest.yaml</strong></code></li><li id="c18d" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">容器</strong> <br/>在本栏位输入“demo-app”。</li><li id="9549" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">ImagePullSecrets</strong>T73】在这里输入变量<code class="fe nn no np nq b"><strong class="jp ir">$(DOCKER__AUTH__SECRET__NAME)</strong></code>。</li><li id="4ae0" class="oz pa iq jp b jq pi ju pj jy pk kc pl kg pm kk pe pf pg ph bi translated"><strong class="jp ir">展示状态超时</strong> <br/>您可以将此设置为该任务被视为失败之前等待的秒数。请记住，有几个因素可能会导致此任务运行的时间比预期的长。在这个练习中，我们将它保留在<strong class="jp ir"><em class="kl">【0】</em></strong>，这意味着没有超时。</li></ul><p id="01b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">继续选择<strong class="jp ir"> <em class="kl">“保存”</em> </strong>，然后根据需要提供注释，然后选择<strong class="jp ir"> <em class="kl">“确定”。</em>T88】</strong></p><h2 id="2a32" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated"><strong class="ak">变量</strong></h2><p id="6d6b" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">因为我们在那些任务中使用了一些变量，所以我们需要配置它们，以便部署可以找到它们。要做到这一点，头转向左侧导航面板上的<strong class="jp ir"> <em class="kl">【库】</em> </strong>选项。</p><p id="c3b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在那里，你需要使用出现的页面上的<strong class="jp ir"> <em class="kl">【变量组】</em> </strong>选项创建一个新的变量组。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pw"><img src="../Images/0ba72a7ef4a6768799469d133b261a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmJVGih7f7ZMkLSS4-3F_Q.png"/></div></div></figure><p id="8351" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在变量组屏幕上，输入一个<strong class="jp ir"> <em class="kl">【变量组名称】</em> </strong>(这里我用的是<strong class="jp ir"> <em class="kl">【初级】</em> </strong>)。</p><p id="3f2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，选择页面左下方的<strong class="jp ir"> <em class="kl"> "+添加"</em> </strong>选项，然后开始输入变量名和值。您将希望使用与我在这里列出的相同的名称，或者如果您更改它们—在我们在前面的步骤中所做的清单和任务设置中更改它们！</p><p id="d38d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是将为我们创建的容器存储库机密的名称，主要用于参考。</p><p id="e042" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nn no np nq b"><strong class="jp ir">HTTP_LISTEN_PORT</strong></code>这是我们的容器将侦听的端口(这需要与您的应用程序中的docker文件中配置的端口相同！).</p><p id="6cc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nn no np nq b"><strong class="jp ir">KUBERNETES__NAMESPACE__DEMO_APP</strong></code>这是部署容器的Kubernetes名称空间。我们将它设置为<strong class="jp ir"><em class="kl">“financial”</em></strong>，因为这是我们之前创建的名称空间。</p><p id="b01d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nn no np nq b"><strong class="jp ir">REPLICAS__TO__USE</strong></code>这个数字表示我们的容器有多少个副本(不是我们可能拥有的容器数量)。如果我们的标准是用两个容器来管理工作量，那么我们将从<strong class="jp ir"><em class="kl">【2】</em></strong>开始。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi px"><img src="../Images/6336b73091a5d17e34bb118b66fca85b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kCFfbZ0tI3gRwYqdmH91gQ.png"/></div></div></figure><h2 id="85bf" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated">试验</h2><p id="9330" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">现在我们已经设置好了一切，我们可以测试发布了！<br/>返回到版本，然后选择您的版本(Demo-App - CD)。<br/>然后，选择<strong class="jp ir"> <em class="kl">【创建发布】</em> </strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi py"><img src="../Images/a9a100f10a0a905dae9aa6f6642baa8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kfM0A4Ak7NHIIAYzOsBUEw.png"/></div></div></figure><p id="0bf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在打开的面板上，只需选择<strong class="jp ir"> <em class="kl">【创建】</em> </strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/7669475cf58b7dbf654427fc73fc562d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*sB3Ae6iROoomf3seoPwpYw.png"/></div></figure><p id="2686" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦创建了发布，选择发布的阶段(在我们的例子中:<strong class="jp ir"> <em class="kl">【开发】</em> </strong>)来查看细节。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi qa"><img src="../Images/356f945cc79a7d634246a19edbec3302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U9InHWrdiQWBZRtLgDf5HA.png"/></div></div></figure><p id="1342" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代理将完成其步骤，并在发生时提供日志。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi qb"><img src="../Images/d23e422f488206cd5b761f7553fadeae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzRRbV-k2P-oh4E7txglgA.png"/></div></div></figure><p id="a525" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一切顺利，您的发布应该是这样的！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi qc"><img src="../Images/ca5c9f013cc4dd3a8ed18cdd1139498b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OMGy2t5BzvEgv-p2eX9gqg.png"/></div></div></figure><h1 id="f2a5" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">打电话</h1><p id="9eb2" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">一段很长的旅程，我知道…</p><p id="e0fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们终于准备好从Kubernetes调用我们的服务了！</p><p id="484d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将使用从您的Kubernetes部署中创建的IP地址，最快的方法之一是回到我们的老朋友:<strong class="jp ir"> <em class="kl"> kubectl </em> </strong>。<br/>转到终端或命令提示符，输入以下命令将名称空间切换到financial: <code class="fe nn no np nq b"><strong class="jp ir">kubectl config set-context --current --namespace=financial</strong></code></p><p id="de40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，获取包含我们公共IP的服务信息进行调用:<code class="fe nn no np nq b"><strong class="jp ir">kubectl get service</strong></code></p><p id="c8cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个命令应该会返回类似这样的内容，包括您的<strong class="jp ir"> <em class="kl">外部IP </em> </strong>:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi qd"><img src="../Images/7ff8b7a78b467bd200d5351f35301d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgqqYMuaSFVrsYjyNTYd7w.png"/></div></div></figure><p id="e5cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了进行测试，我们所要做的就是打开我们最喜欢的web浏览器(或API测试工具，如Postman)并输入<strong class="jp ir"><em class="kl">http://&lt;EXTERNAL-IP地址&gt; :8800 </em> </strong>(因此，使用上面的例子，这将是<a class="ae lc" href="http://20.75.25.111:8800)" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="kl">http://20.75.25.111:8800</em></strong>)</a></p><h2 id="b259" class="mb le iq bd lf mc md dn lj me mf dp ln jy mg mh lr kc mi mj lv kg mk ml lz mm bi translated">最后的结果</h2><p id="d7c8" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">甜蜜的胜利！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi qe"><img src="../Images/2414cd2c15572c52c3329567b680eca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6LQbasMFkMgFM6BxPuur9w.png"/></div></div></figure><p id="7add" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">感谢你坚持和我在一起，我希望你喜欢这些文章！</strong></p></div></div>    
</body>
</html>