<html>
<head>
<title>Syntax Highlighting in Gatsby MDX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Gatsby MDX中的语法高亮</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/syntax-highlighting-in-gatsby-mdx-f0187ce51f4f?source=collection_archive---------11-----------------------#2020-06-22">https://levelup.gitconnected.com/syntax-highlighting-in-gatsby-mdx-f0187ce51f4f?source=collection_archive---------11-----------------------#2020-06-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f8160860e1dfdaf26739aa76bb3edfa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qxKwr5ISnsCMljMeZEtTEg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@esteejanssens" rel="noopener ugc nofollow" target="_blank">埃斯特扬森斯</a>拍摄</figcaption></figure><p id="4153" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本帖中，我们将探讨如何使用<a class="ae kf" href="https://github.com/FormidableLabs/prism-react-renderer" rel="noopener ugc nofollow" target="_blank"> prism-react-renderer </a>为Gatsby MDX文件启用语法高亮显示。</p><p id="554d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们需要安装几个模块</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="00c5" class="ln lo it lj b gy lp lq l lr ls">npm i prism-react-renderer @mdx-js/react</span></pre></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><p id="5fd2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们创建将在<code class="fe ma mb mc lj b">&lt;MDXProvider/&gt;</code>中使用的组件，它将为我们的应用程序提供包装器替换。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="8ad8" class="ln lo it lj b gy lp lq l lr ls">const component = {<br/>  pre: props =&gt; {<br/>    const className = props.children.props.className || '';<br/>    const matches = className.match(/language-(?&lt;lang&gt;.*)/);<br/>    return (<br/>      &lt;Highlight<br/>        {...defaultProps}<br/>        code={props.children.props.children}<br/>        language={<br/>          matches &amp;&amp; matches.groups &amp;&amp; matches.groups.lang<br/>            ? matches.groups.lang<br/>            : ''<br/>        }<br/>      &gt;<br/>        {({ className, style, tokens, getLineProps, getTokenProps }) =&gt; (<br/>          &lt;pre className={className} style={style}&gt;<br/>            {tokens.map((line, i) =&gt; (<br/>              &lt;div {...getLineProps({ line, key: i })}&gt;<br/>                {line.map((token, key) =&gt; (<br/>                  &lt;span {...getTokenProps({ token, key })} /&gt;<br/>                ))}<br/>              &lt;/div&gt;<br/>            ))}<br/>          &lt;/pre&gt;<br/>        )}<br/>      &lt;/Highlight&gt;<br/>    );<br/>  },<br/>};</span></pre><p id="a4d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了呈现我们在MDX文件中添加的代码块以显示在页面上，我们将访问<code class="fe ma mb mc lj b">&lt;pre/&gt;</code>组件的子组件的props，因为markdown代码块被编译成包装代码组件的<code class="fe ma mb mc lj b">&lt;pre/&gt;</code>组件。<br/>我们可以通过使用<code class="fe ma mb mc lj b">props.children.props.children</code>更深入地获取代码，正如你从下面的截图中看到的。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/cb9a160c3467b32da629485a8f7f3249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8-i4SK-hnlcrjBQQOTVgQ.png"/></div></div></figure><p id="cecd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了获得代码块的语言属性，而不是硬编码值，我们查看MDX代码块，因为它是一个类名，看起来像language-className(例如language-javascript)。</p><p id="2f88" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了获得MDX文件中代码组件中定义的语言，我们将在<code class="fe ma mb mc lj b">props.children.props.className</code>处向下钻取，如果没有类名，那么我们可能没有在代码块中放置语言，在这种情况下，我们将默认为空字符串。<br/>然后我们在regex中使用一个名为lang的名称捕获组来获取language-className的语言。如果有匹配的</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="8050" class="ln lo it lj b gy lp lq l lr ls">const matches = className.match(/language-(?&lt;lang&gt;.*)/);</span></pre><p id="a4a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过在下面的<code class="fe ma mb mc lj b">gatsby-browser.js</code>中添加以下代码片段，在MDX文件中启用语法高亮显示</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="7b51" class="ln lo it lj b gy lp lq l lr ls">import React from 'react';<br/>import { MDXProvider } from '@mdx-js/react';<br/>import Highlight, { defaultProps } from 'prism-react-renderer';</span><span id="78d9" class="ln lo it lj b gy me lq l lr ls">/* eslint-disable */<br/>const component = {<br/>  pre: props =&gt; {<br/>    const className = props.children.props.className || '';<br/>    const matches = className.match(/language-(?&lt;lang&gt;.*)/);<br/>    return (<br/>      &lt;Highlight<br/>        {...defaultProps}<br/>        code={props.children.props.children}<br/>        language={<br/>          matches &amp;&amp; matches.groups &amp;&amp; matches.groups.lang<br/>            ? matches.groups.lang<br/>            : ''<br/>        }<br/>      &gt;<br/>        {({ className, style, tokens, getLineProps, getTokenProps }) =&gt; (<br/>          &lt;pre className={className} style={style}&gt;<br/>            {tokens.map((line, i) =&gt; (<br/>              &lt;div {...getLineProps({ line, key: i })}&gt;<br/>                {line.map((token, key) =&gt; (<br/>                  &lt;span {...getTokenProps({ token, key })} /&gt;<br/>                ))}<br/>              &lt;/div&gt;<br/>            ))}<br/>          &lt;/pre&gt;<br/>        )}<br/>      &lt;/Highlight&gt;<br/>    );<br/>  },<br/>};</span><span id="1af6" class="ln lo it lj b gy me lq l lr ls">export const wrapRootElement = ({ element }) =&gt; {<br/>  return &lt;MDXProvider components={component}&gt;{element}&lt;/MDXProvider&gt;;<br/>};</span></pre><p id="3568" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">在这篇文章之后，你可以在这里</strong>  <strong class="ki iu">找到一个starter repo </strong> <a class="ae kf" href="https://github.com/gabroun/gatsby-mdx-starter" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">，它显示了MDX页面的用法和语法高亮显示</strong></a></p><h1 id="ee11" class="mf lo it bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">如果你觉得这篇文章有帮助</h1><p id="9d1c" class="pw-post-body-paragraph kg kh it ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">如果你想进一步了解《盖茨比》中的MDX，请阅读以下内容:</p><div class="nh ni gp gr nj nk"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-create-pages-dynamically-in-gatsby-using-mdx-66faa175944e"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">如何使用MDX在Gatsby中动态创建页面</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">在本帖中，我们将探讨如何在Gatsby中使用MDX以编程方式创建页面。</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny jz nk"/></div></div></a></div></div></div>    
</body>
</html>