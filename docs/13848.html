<html>
<head>
<title>How to Format Code With Symfony PHP-CS-Fixer and Laravel Pint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Symfony PHP-CS-Fixer和Laravel Pint格式化代码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/code-quality-right-with-symfony-php-cs-fixer-and-laravel-pint-1e4c6a79a1be?source=collection_archive---------7-----------------------#2022-10-11">https://levelup.gitconnected.com/code-quality-right-with-symfony-php-cs-fixer-and-laravel-pint-1e4c6a79a1be?source=collection_archive---------7-----------------------#2022-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9eea" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">并自动修复PHP编码标准问题！</h2></div><p id="df5a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我之前的职业生涯中，我是PrestaShop和Symfony开源项目的积极贡献者。当人们校对我的稿件时，没有什么比看到时间浪费在无用的评论上更让我恼火的了，比如:</p><p id="27c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">"<em class="le">请在文件</em>的末尾添加一个空行，"或</p><p id="82e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">"<em class="le">你必须回到右括号</em>后的那一行."</p><blockquote class="lf lg lh"><p id="da0d" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">特别献给某个Pierre，他浪费了我这么多可用的大脑时间来辩论这个<em class="it">🤡</em></p></blockquote><p id="3b59" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最令人沮丧的是看到代码校对者在讨论贡献的兴趣之前<strong class="kk iu">做出这样的评论:</strong></p><ul class=""><li id="cd03" class="ll lm it kk b kl km ko kp kr ln kv lo kz lp ld lq lr ls lt bi translated">这个功能有帮助吗？</li><li id="39a9" class="ll lm it kk b kl lu ko lv kr lw kv lx kz ly ld lq lr ls lt bi translated">这个“错误修复”产生的问题比它修复的少吗？等等。</li></ul><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi lz"><img src="../Images/6fd20fe220360e4e12fdc1d6b01831d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ktPWuzKTIJBWwMKJ"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">照片由<a class="ae mp" href="https://unsplash.com/@mimithian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米米·蒂安</a>在<a class="ae mp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="c3ec" class="mq mr it bd ms mt mu dn mv mw mx dp my kr mz na nb kv nc nd ne kz nf ng nh ni bi translated">但是我们为什么要有代码标准呢？</h2><p id="e81c" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">在一个项目的团队中工作是很常见的；在现实世界中，我们花在阅读和理解代码上的时间和生产代码的时间一样多。</p><p id="7f76" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果每个人都按照自己的意愿编码，那么阅读和理解项目就更有挑战性了。</p><p id="0dbc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果有人接手项目，那就白费劲了！</p><p id="8366" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后PSR标准出现了。也就是说，PHP生态系统中最杰出的参与者同意了一组建议。</p><p id="ed96" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">开始时，它相当美观，并且是所有项目的共同需求，比如加载PHP类或日志。</p><blockquote class="lf lg lh"><p id="c946" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">当这个小组开始尝试在更大的框架上强加通用的高级设计规则时，许多人离开了这个项目，但这将是未来更“巨魔”风格文章的主题<em class="it">😜</em></p></blockquote><blockquote class="no"><p id="892a" class="np nq it bd nr ns nt nu nv nw nx ld dk translated">长话短说，你必须尊重标准。</p></blockquote><p id="0999" class="pw-post-body-paragraph ki kj it kk b kl ny ju kn ko nz jx kq kr oa kt ku kv ob kx ky kz oc lb lc ld im bi translated">建议<a class="ae mp" href="https://www.php-fig.org/psr/psr-1/" rel="noopener ugc nofollow" target="_blank"> PSR-1 </a>和<a class="ae mp" href="https://www.php-fig.org/psr/psr-12/" rel="noopener ugc nofollow" target="_blank"> PSR-12 </a>记录了如何编写你的PHP代码，所谓的“基本编码标准”和“扩展编码风格”</p><p id="703a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">在Python生态系统中，这些被称为</strong><a class="ae mp" href="https://peps.python.org/" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">PEPS</strong></a><strong class="kk iu">，我想象大部分编程语言都有类似的规则。</strong></p><p id="6426" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是一些PHP推荐(PSR-1)的具体例子:</p><ul class=""><li id="8e85" class="ll lm it kk b kl km ko kp kr ln kv lo kz lp ld lq lr ls lt bi translated">必须使用StudlyCaps表示法声明类名；</li><li id="0bc5" class="ll lm it kk b kl lu ko lv kr lw kv lx kz ly ld lq lr ls lt bi translated">必须使用camelCase表示法命名方法；</li></ul><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="fab8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">我懒得学这个，再加上我的代码管用🤔</strong></p><p id="d682" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我明白了！你并没有决定成为一名用代码进行设计的开发人员。</p><p id="0991" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是为什么一群工具迅速出现来重新格式化代码以遵循标准。其中，我建议你使用<a class="ae mp" href="https://cs.symfony.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> PHP-CS-Fixer </strong> </a>。</p><h1 id="f2f2" class="of mr it bd ms og oh oi mv oj ok ol my jz om ka nb kc on kd ne kf oo kg nh op bi translated">PHP-CS-Fixer自动遵循编码标准</h1><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi oq"><img src="../Images/59faf5c2769fd73ced14e6ba63cb2cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRPf8PYc_aElrKrqYofP3Q.jpeg"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">演职员表:<a class="ae mp" href="https://cs.symfony.com/" rel="noopener ugc nofollow" target="_blank">https://cs.symfony.com/</a></figcaption></figure><p id="941b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它是由Symfony PHP框架的创建者(法比安·✨)用PHP开发的软件，可以用Composer安装。</p><p id="295f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将自己定位在PHP项目的根目录，并安装PHP-CS-Fixer <em class="le">作为开发依赖</em>。</p><p id="19f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里建议根据文档将其安装在单独的文件夹中:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">您必须将它安装在项目的tools/php-cs-fixer文件夹中</figcaption></figure><blockquote class="lf lg lh"><p id="a025" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">另一个有效的替代方法是安装<a class="ae mp" href="https://github.com/PHP-CS-Fixer/shim" rel="noopener ugc nofollow" target="_blank"> shim </a>作为一个独立的php-cs-fixer。</p></blockquote><p id="99a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，你有两个选择:</p><ul class=""><li id="90ff" class="ll lm it kk b kl km ko kp kr ln kv lo kz lp ld lq lr ls lt bi translated">要求工具执行实际的错误纠正；</li><li id="71d5" class="ll lm it kk b kl lu ko lv kr lw kv lx kz ly ld lq lr ls lt bi translated">或者显示它想要进行的修正而不执行它们；</li></ul><p id="3186" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">两种情况下的执行指令是相同的:“fix”命令！</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="3420" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在修复命令中，点(“.”)指的是当前文件夹:您可以为PHPStan决定哪些文件夹应该遵循标准。</p><blockquote class="lf lg lh"><p id="1427" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">理论上，<strong class="kk iu">所有文件夹</strong>都应该适用。</p></blockquote><p id="e317" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">我运行这个命令时会出错🥺 </strong></p><p id="0223" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请不要惊慌，我的朋友！</p><p id="cb6d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将与您分享我的懒惰的提示，因为我不记得这种冗长的命令:在您项目的Composer配置文件中编写一个定制命令。</p><blockquote class="lf lg lh"><p id="869c" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">请注意，我们谈论的是项目根目录下的文件<strong class="kk iu"> composer.json </strong>而不是文件夹【工具/php-cs-fixer  <em class="it">中的文件<strong class="kk iu">🔴</strong></em></p></blockquote><p id="2ad2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仔细看看更新前后Composer配置文件的内容:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="f3fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要在您的项目中运行PHP-CS-Fixer，您必须直接使用Composer:</p><pre class="ma mb mc md gt or os ot ou aw ov bi"><span id="fd06" class="mq mr it os b gy ow ox l oy oz">composer cs-fix</span></pre><p id="0c1d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看我的<a class="ae mp" href="https://github.com/mickaelandrieu/legacy-php-app" rel="noopener ugc nofollow" target="_blank"> PHP遗留项目</a>的输出:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/834319c3c4638f79d02d20114eee2be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*qBSQMk0xg7lVwt9e4i9jxg.jpeg"/></div></figure><p id="da71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你再也不用担心“编码标准”了😉</p><p id="dfc3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是PHP-CS-Fixer的小演示！</p><h1 id="7d4c" class="of mr it bd ms og oh oi mv oj ok ol my jz om ka nb kc on kd ne kf oo kg nh op bi translated">Laravel品脱是PHP-CS-Fixer对类固醇</h1><p id="5d31" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">如果你是Laravel的开发者，你可能听说过Pint，因为Laravel 9.0和更高版本从Laravel 9.0开始默认安装它。</p><p id="3a32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pint是建立在PHP-CS-Fixer之上的，它使确保您的代码风格保持干净和一致变得简单。</p><blockquote class="lf lg lh"><p id="2c46" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">默认情况下，Pint不需要任何配置，并会通过遵循Laravel 的<strong class="kk iu">固执己见的编码风格来修复您代码中的代码风格问题。</strong></p></blockquote><h2 id="fe32" class="mq mr it bd ms mt mu dn mv mw mx dp my kr mz na nb kv nc nd ne kz nf ng nh ni bi translated">安装Laravel Pint并开始修复您的代码</h2><p id="546d" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">您通过Composer安装Laravel Pint:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="4bdb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以通过调用项目的<strong class="kk iu"> vendor/bin </strong>目录中的<code class="fe pb pc pd os b">pint</code>二进制文件来指示Pint修复代码风格问题:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div></figure><blockquote class="lf lg lh"><p id="18ef" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">作为PHP-CS-Fixer，默认情况下会忽略<strong class="kk iu">供应商</strong>文件夹</p></blockquote><p id="e50a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看我的PHP遗留项目的输出:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi pe"><img src="../Images/8a1d233bd69e1ca24b116d714a8dbe98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Edsni6IFlNwGdaY7VkrMZg.jpeg"/></div></div></figure><ul class=""><li id="a64b" class="ll lm it kk b kl km ko kp kr ln kv lo kz lp ld lq lr ls lt bi translated">UI比PHP-CS-Fixer更漂亮，对Pint更有帮助；</li><li id="c4b3" class="ll lm it kk b kl lu ko lv kr lw kv lx kz ly ld lq lr ls lt bi translated">你不需要记住任何复杂的命令；</li></ul><p id="852a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您希望看到Pint完成的修复，而不将它们应用到您的文件中，您必须使用参数"<strong class="kk iu"> test </strong>"来完成您的指令:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="5135" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于以下输出:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi pf"><img src="../Images/29ac8ddf73a9cb76789eb5e922853a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHh33VNRRN_IZSNRE_NQcQ.jpeg"/></div></div></figure><h2 id="d79d" class="mq mr it bd ms mt mu dn mv mw mx dp my kr mz na nb kv nc nd ne kz nf ng nh ni bi translated">如何为Symfony项目配置Laravel Pint</h2><p id="decc" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">如果你想在Symfony项目上使用Pint或者配置应用于你的项目的规则列表，该怎么办？</p><p id="8a00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以在项目的根目录下创建一个名为<strong class="kk iu"> pint.json </strong>的文件，内容如下:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="c536" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pint目前支持的预置有:<code class="fe pb pc pd os b">laravel</code>、<code class="fe pb pc pd os b">psr12</code>和<code class="fe pb pc pd os b">symfony</code>。</p><blockquote class="lf lg lh"><p id="3267" class="ki kj le kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">现在是时候在你的PHP项目上安装你最喜欢的工具，彻底解决代码风格的问题了<em class="it"> ✅ </em></p></blockquote></div><div class="ab cl pg ph hx pi" role="separator"><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl"/></div><div class="im in io ip iq"><p id="5252" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这篇文章，<a class="ae mp" href="https://medium.com/@mickael-andrieu/" rel="noopener">关注我</a>，我会在以后的文章发布时通知你！</p><div class="pn po gp gr pp pq"><a href="https://medium.com/@mickael-andrieu/membership" rel="noopener follow" target="_blank"><div class="pr ab fo"><div class="ps ab pt cl cj pu"><h2 class="bd iu gy z fp pv fr fs pw fu fw is bi translated">通过我的推荐链接加入Medium-mickal Andrieu</h2><div class="px l"><h3 class="bd b gy z fp pv fr fs pw fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="py l"><p class="bd b dl z fp pv fr fs pw fu fw dk translated">medium.com</p></div></div><div class="pz l"><div class="qa l qb qc qd pz qe mj pq"/></div></div></a></div></div></div>    
</body>
</html>