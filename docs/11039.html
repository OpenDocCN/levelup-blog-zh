<html>
<head>
<title>How To Reduce Size Of Docker Data Volume In Docker Desktop For Windows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何减少Docker桌面的Docker数据量</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-reduce-size-of-docker-data-volume-in-docker-desktop-for-windows-c9545984bae4?source=collection_archive---------1-----------------------#2022-02-10">https://levelup.gitconnected.com/how-to-reduce-size-of-docker-data-volume-in-docker-desktop-for-windows-c9545984bae4?source=collection_archive---------1-----------------------#2022-02-10</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="b37a" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">超级简单</h2><div class=""/><div class=""><h2 id="a290" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">用一个命令调整Docker数据卷的大小，并在硬盘上回收大量空间</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/b04e57cf580f42faaeb90e17128d8e3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4UEZR5i9sOoPjC7HwrA6Q.jpeg"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@chuttersnap?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> CHUTTERSNAP </a>在<a class="ae li" href="https://unsplash.com/collections/8865261/docker%2Fcontainer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="780f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果您使用Docker Desktop for Windows，它使用WSL2，那么您的所有图像和容器文件都存储在一个单独的虚拟卷(vhdx)中。</p><p id="e371" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">这种虚拟硬盘能够在需要更多空间时自动增长，直到达到一定的限制。但是，如果您使用<code class="fe mf mg mh mi b">docker system prune --all</code>或<code class="fe mf mg mh mi b">docker volume prune</code>来回收空间，vhdx不会自动收缩。Windows提供了两种手动收缩虚拟磁盘的方法，以便释放未使用的空间。</p><h1 id="9c4c" class="mj mk iu bd ml mm mn mo mp mq mr ms mt kj mu kk mv km mw kn mx kp my kq mz na bi translated">1.使用优化VHD</h1><p id="73c2" class="pw-post-body-paragraph lj lk iu ll b lm nb ke lo lp nc kh lr ls nd lu lv lw ne ly lz ma nf mc md me in bi translated">Optimize-VHD cmdlet可用于优化一个或多个虚拟硬盘文件中的空间分配。它回收未使用的数据块，并重新排列这些数据块以便更有效地打包，这将减少虚拟硬盘文件的整体大小。但是不能调整<strong class="ll je"> <em class="ng">固定虚拟硬盘</em> </strong>的大小。</p><p id="c86f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">要启动该流程，请切换到PowerShell(以管理员身份)并执行:</p><pre class="kt ku kv kw gu nh mi ni nj aw nk bi"><span id="2278" class="nl mk iu mi b gz nm nn l no np">Optimize-VHD -Path "path to your ext4.vhdx" -Mode Full</span></pre><p id="24b0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果您没有将docker-desktop-data移动到新的位置(<a class="ae li" href="https://medium.com/geekculture/beginner-friendly-introduction-into-devops-with-docker-on-windows-6aac2de2db33#ca2c" rel="noopener">阅读我文章的这一部分以了解如何移动它</a>)您可以在这个位置找到它:</p><pre class="kt ku kv kw gu nh mi ni nj aw nk bi"><span id="21e6" class="nl mk iu mi b gz nm nn l no np">%LOCALAPPDATA%\Docker\wsl\data\ext4.vhdx</span></pre><h1 id="3837" class="mj mk iu bd ml mm mn mo mp mq mr ms mt kj mu kk mv km mw kn mx kp my kq mz na bi translated">2.使用Diskpart调整VHD的大小</h1><p id="be2a" class="pw-post-body-paragraph lj lk iu ll b lm nb ke lo lp nc kh lr ls nd lu lv lw ne ly lz ma nf mc md me in bi translated">如果你不能在你的Windows上使用优化VHD(通常这不能在Windows Home中完成)，你可以使用另一种方法来调整你的docker-desktop-data ext4.vhdx虚拟磁盘的大小。</p><p id="fad6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">您将使用diskpart压缩虚拟磁盘。</p><p id="0133" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">为此，打开一个终端并关闭Linux的Windows子系统</p><pre class="kt ku kv kw gu nh mi ni nj aw nk bi"><span id="b4d9" class="nl mk iu mi b gz nm nn l no np">wsl --shutdown</span></pre><p id="90ee" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">之后，你可以启动<code class="fe mf mg mh mi b">diskpart </code>并选择你的docker-desktop ext4.vhdx</p><pre class="kt ku kv kw gu nh mi ni nj aw nk bi"><span id="c400" class="nl mk iu mi b gz nm nn l no np">diskpart<br/>select dockhdd file="path to your ext4.vhdx"</span></pre><p id="ea49" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">作为一个标识符，我选择了<code class="fe mf mg mh mi b">vdisk</code>，但是你可以随意命名。</p><p id="a57a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">现在，您可以附加、压缩、分离虚拟磁盘，并关闭diskpart。</p><pre class="kt ku kv kw gu nh mi ni nj aw nk bi"><span id="dfe2" class="nl mk iu mi b gz nm nn l no np">attach dockhdd readonly<br/>compact dockhdd</span><span id="a199" class="nl mk iu mi b gz nq nn l no np">[ ... this could take some time ]</span><span id="6f1d" class="nl mk iu mi b gz nq nn l no np">detach dockhdd<br/>close</span></pre><h1 id="c1c4" class="mj mk iu bd ml mm mn mo mp mq mr ms mt kj mu kk mv km mw kn mx kp my kq mz na bi translated">结束语</h1><p id="38e9" class="pw-post-body-paragraph lj lk iu ll b lm nb ke lo lp nc kh lr ls nd lu lv lw ne ly lz ma nf mc md me in bi translated">我希望这篇关于调整Docker虚拟硬盘大小的文章对你有所帮助，并且能够复制它。</p><p id="73c4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我很想听听你对这些方法的想法和想法。如果你知道另一种方法或有任何问题，请写在下面。如果可能的话，我试着回答他们。</p></div><div class="ab cl nr ns hy nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="in io ip iq ir"><p id="c94f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><em class="ng"> ✍️写的</em></p><p id="434b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> <em class="ng">保罗·克努斯</em></strong><em class="ng">T5】丈夫，两个孩子的父亲，极客，终身学习者，科技爱好者&amp;软件工程师</em></p><p id="a8ec" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><em class="ng">本文最初发表在我的博客上</em><a class="ae li" href="https://www.paulsblog.dev/how-to-reduce-size-of-docker-data-volume-in-docker-desktop-for-windows/" rel="noopener ugc nofollow" target="_blank"><em class="ng">https://www . paulsblog . dev/how-to-reduce-size-of-docker-data-volume-in-docker-desktop-for-windows/</em></a></p><p id="f3c5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> <em class="ng">问好</em> </strong> <em class="ng">🙌</em><strong class="ll je"><em class="ng"/></strong><em class="ng">:</em><a class="ae li" href="https://www.twitter.com/paulknulst" rel="noopener ugc nofollow" target="_blank"><em class="ng">Twitter</em></a><em class="ng">，</em><a class="ae li" href="https://www.linkedin.com/in/paulknulst/" rel="noopener ugc nofollow" target="_blank"><em class="ng">LinkedIn</em></a><em class="ng">，</em> <a class="ae li" href="https://github.com/paulknulst" rel="noopener ugc nofollow" target="_blank"> <em class="ng"> GitHub </em> </a></p></div></div>    
</body>
</html>