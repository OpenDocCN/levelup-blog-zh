# 面向对象编程中的上下文是什么？

> 原文：<https://levelup.gitconnected.com/what-is-the-context-in-object-oriented-programming-9dda02d3328d>

![](img/109d2432b1c624c268002888fa56a8f2.png)

塞萨尔·卡利瓦里诺·阿拉贡在 [Unsplash](https://unsplash.com/s/photos/tools?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍照

**这个问题永远改变了我对面向对象编程的看法。**那是几年前，我意外地找到了我甚至都没有寻找过的答案。然而，最终，它出乎意料地简单，却很有启发性。与那时的我不同，我假设你不是因为错误而出现在这里，所以我希望阐明上下文的概念，并且，理想情况下，**激发你构建设计更好的软件**。

在我开始之前，让我提一下**你不应该期待太多的学术理论**(事实上，你根本不应该期待)和他们严格的书籍定义中使用的术语。我的目的不是做一个缺乏实际用途的枯燥讲座，而是分享我对 OOP 环境的知识和理解，以及它如何帮助设计更清晰的架构和更用户友好的 API、库等。让我强调“分享”,因为我远没有“教”你理解这个话题的唯一方法。

所有代码样本都用 Kotlin 编写有两个原因。第一——目前它是我写得最多的编程语言。此外，我是在开发我的 Android 库[集](https://github.com/Kwezal/Kandy)时得到这篇文章的灵感的，因此更容易找到/想出真实世界的例子。第二个原因是 Kotlin 的语法以我所见过的最令人印象深刻和友好的方式处理使用上下文和定义类似 DSL 的工具。是的，柯特林·凡博伊证实了。😅好吧，这是一个很长的序言。让我们开始吧。

# 定义

我知道我刚刚承诺要避免学术理论，但实际上，字典定义是一个很好的起点，所以请原谅我。《剑桥英语词典》为我们提供了两个定义:

> 与特定事件或情况相关的影响和事件。
> 
> 紧接在一个特定短语或一段文字前后的文字或话语，影响着它的用法和意义。

后者更符合我们在这里试图把握的东西。至于现在，我们可以试着把它逐字翻译成极客语言:

> **围绕特定语句或表达式并影响其语法和实现的代码块。**

(请在评论中告知我是翻译正确还是犯了一些语法错误。极客不是我的母语。)如果我们到这里就结束了，你基本上就和我在真正理解之前的理解一样了。基本的。如果你想了解更多，欢迎来到下一部分。

# 那一刻

那时我已经用 Java 编程 5 年了。总的来说，我非常喜欢面向对象编程的概念。我的中间名是抽象，第三名是封装，第四名是继承，第五名是多态。是的，那时我的名字很长。所以我还能学到什么？

很多。

当他来的时候，我正在开发另一个 SQL 查询构建器库(不要谷歌它，我已经想出了这个名字)

*进入高级开发者*

*把 YASQLQBL 的代码拆分成两个显示屏，用一只眼睛从上到下读，另一只眼睛从下到上读。同时。*

![](img/445328e1d3d41356e1a382199e958fef.png)

由 [Max Duzij](https://unsplash.com/@max_duz?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 在 [Unsplash](https://unsplash.com/s/photos/code?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

> “嘿，真漂亮。但你看，你的阶级等级制度几乎完全是平的，”他注意到。
> 
> “嗯。是的，它是。但是，除了一个类和一组方法之外，查询构建器还需要什么呢？”我好奇地问。
> 
> “正常工作吗？没什么。**更加用户友好，更少出错，设计更体面？背景。**”
> 
> “语境？什么意思？”
> 
> "你能在 SQL 的“where”子句前写“having”子句吗？"
> 
> “不，这会导致语法错误…”
> 
> "你能在你的生成器中把“having”从句写在“where”从句之前吗？"
> 
> “嗯……是的，但是谁会写这样的声明呢？…"
> 
> "任何一个没有足够咖啡的程序员."
> 
> “……此外，它还会导致语法错误！但是嗯…在…运行时？”我很尴尬。
> 
> “一点不错。在这种情况下，有一个编译时错误不是很好吗？
> 
> 我点点头，“那么上下文将如何解决这个问题？”
> 
> “又快又容易。呆一会儿，听听。上下文是**而不是**仅仅是一段带有可访问变量、参数等的代码。背景决定了你能做什么和不能做什么。上下文告诉你**如何**执行特定的操作。**一整节课就是一个语境。**一个方法就是一点上下文。所有作用域本身都是上下文！”
> 
> “哇，我从来没有这样想过！看来我比电脑还不懂。我认为类可能是字段和方法的可扩展容器。不多不少。我使用它们主要是为了坚持干燥原则。我没看出这背后有什么想法。毕竟只是一串比特而已。”
> 
> “真的。这就是编程语言被发明的原因。为人类提供一个可读且相当容易理解的界面。由于我们通常更喜欢用文字、概念和想法来思考，而不是用数字、方程式和数学公式，所以我们有了面向对象的程序设计

…是的，我承认我涂了一点颜色。😉

# 履行

受高级开发人员 I **的启发，我将 SQL 子句划分为单独的类**，从而**为它们中的每一个提供适当的上下文**。结果非常令人满意。虽然方法只能强制传递兼容类型的参数，但类可以强制调用适当上下文的方法。该库的最终版本看起来或多或少如下所示:

上下文感知的另一个巨大优势是**接口不会被污染**。尽管在 Kotlin 和 C#中使用扩展函数/方法非常有用并且值得推荐，但它可能会导致过度使用的诱惑。这里有一个例子来说明我的意思:

虽然它可能是一些与时间相关的类似 DSL 的库中非常好的一部分，但是让这些扩展函数在任何使用`Int`的地方都可以全局访问是一个坏主意。让我们扩展一下前面的例子，这样你就能明白为什么了:

![](img/717acf73b829bd5036bc17741dbd5836.png)

保罗·费尔伯鲍尔在 [Unsplash](https://unsplash.com/s/photos/swiss-knife?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

最后没有任何意义。这两种扩展都很好，但是只有当它们存在于专用的上下文中时。否则，它会产生误导，容易被误用。时间可以用数字来表示，但不是每个数字都代表时间。这同样适用于信息单元。

在为 Kandy 设计 Android 对话框管理库时，我决定遵循这条规则，不要用大量的扩展函数污染标准的`Context`类。最终，我只添加了两个扩展功能:`create`和`show`。它们都隐式地构造了一个`DialogContext`的实例，并允许您使用其特定于对话框的 API。下面是一个显示简单退出确认对话框的示例:

# 结论

虽然我尽了最大努力给出了简单的例子，并以各种方式和从各种角度清楚地解释了上下文的想法，但简明扼要的要点总结可能仍然是有帮助的。

*   语境是围绕陈述和表达的跨度
*   上下文定义了您可以采取的一组操作，即要调用的方法、要使用的变量等。
*   其中，下面的创建了一个上下文:一个类，一个方法(或者一个函数，一个过程，等等。)，一段代码
*   通常，所有作用域都没有自己的上下文
*   在某些情况下，您可以使用上下文的思想来提供逻辑和数据一致性的编译时验证
*   您可以通过提供最少的动作集合，利用上下文来保持界面整洁和简单
*   一些责任明确的小背景比一个巨大的、被污染的宇宙背景要好

# 编后记

像往常一样，非常感谢你看到我文章的结尾。希望你没觉得无聊(太无聊？)而是发现了一些有趣的，对自己有用的东西。如果你喜欢，可以考虑拍手👏写评论。**非常感谢任何形式的反馈**(是的，包括建设性的批评。)

如果你是安卓开发者，你也可以试试[康提](https://github.com/Kwezal/Kandy)。这是一组开源库，旨在使 Android 开发中一些过于复杂/冗长的方面变得更加友好。

[](https://github.com/Kwezal/Kandy) [## 奎扎尔/康提

### 一个专门用于 Android 平台的 Kotlin 库集，它将使编程再次变得甜蜜！所有模块都可用…

github.com](https://github.com/Kwezal/Kandy) 

# 下一步是什么

[](https://kajetansuchanski.medium.com/you-can-have-your-cake-and-eat-it-type-safe-collection-of-elements-of-any-type-in-kotlin-46252417eb5c) [## 你可以鱼与熊掌兼得——kot Lin 中任何类型元素的类型安全集合

### 在任何类型的元素列表中保留类型安全和实际类型信息的模式。基于…

kajetansuchanski.medium.com](https://kajetansuchanski.medium.com/you-can-have-your-cake-and-eat-it-type-safe-collection-of-elements-of-any-type-in-kotlin-46252417eb5c) [](/the-pursuit-of-the-cross-platform-holy-grail-part-1-ionic-2d56b640a6b3) [## 对跨平台圣杯的追求。第一部分:离子

### 这是寻找最佳跨平台应用程序开发框架系列文章的第一部分。的…

levelup.gitconnected.com](/the-pursuit-of-the-cross-platform-holy-grail-part-1-ionic-2d56b640a6b3)