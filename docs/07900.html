<html>
<head>
<title>Creating a Dropdown Picker in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中创建下拉选择器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-a-dropdown-picker-1067c509b327?source=collection_archive---------1-----------------------#2021-03-20">https://levelup.gitconnected.com/creating-a-dropdown-picker-1067c509b327?source=collection_archive---------1-----------------------#2021-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e4f0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让-马克·布里安内</h2></div><p id="c5c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">SwiftUI中的默认选择器不会给你留下太多的机会进行样式化或定制。今天，我将创建一个自定义下拉选择器，您可以在下一个iOS项目中使用它。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/8bdd97f27dbc0d07cb8cf3c520f69b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wbojnCGFEv9_kxzH.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">DropdownPicker展开的屏幕截图</figcaption></figure><blockquote class="lu lv lw"><p id="2d5a" class="ki kj lx kk b kl km ju kn ko kp jx kq ly ks kt ku lz kw kx ky ma la lb lc ld im bi translated">如果你觉得这个教程有帮助，请考虑使用这个<a class="ae mb" href="https://trailingclosure.com/signup/?utm_source=trailing_closure&amp;utm_medium=blog_post&amp;utm_campaign=custom_tabbar" rel="noopener ugc nofollow" target="_blank">链接</a>订阅，如果你没有在<a class="ae mb" href="https://trailingclosure.com/?utm_source=trailing_closure&amp;utm_medium=blog_post&amp;utm_campaign=custom_tabbar" rel="noopener ugc nofollow" target="_blank">TrailingClosure.com</a>上阅读这篇文章，请有空来看看我们！</p></blockquote><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mc md l"/></div></figure><h2 id="6c24" class="me mf it bd mg mh mi dn mj mk ml dp mm kr mn mo mp kv mq mr ms kz mt mu mv mw bi translated">正在创建<code class="fe mx my mz na b">DropdownPicker</code></h2><p id="0171" class="pw-post-body-paragraph ki kj it kk b kl nb ju kn ko nc jx kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">首先创建一个名为<code class="fe mx my mz na b">DropdownPicker</code>的新SwiftUI视图。像内置的iOS picker一样，我们需要跟踪一些事情。首先是提货人的<code class="fe mx my mz na b">title</code>，用户可以选择的可用<code class="fe mx my mz na b">options</code>，最后是用户当前的<code class="fe mx my mz na b">selection</code>。<code class="fe mx my mz na b">selection</code>变量将是一个绑定，这样父视图可以跟踪用户的选择。</p><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="2a49" class="me mf it na b gy nk nl l nm nn">struct DropdownPicker: View {<br/>    <br/>    var title: String<br/>    @Binding var selection: Int<br/>    var options: [String]<br/>	<br/>}</span></pre><p id="c498" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是开始构建视图的<code class="fe mx my mz na b">body</code>。下图是<code class="fe mx my mz na b">DropdownPicker</code>关闭后的样子。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi no"><img src="../Images/0a55c511ac6fbb876739c60cb44e0e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dXbrYs69ZEAUq7Tp.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">关闭时的DropdownPicker</figcaption></figure><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="39f8" class="me mf it na b gy nk nl l nm nn">var body: some View {<br/>    HStack {<br/>        Text(title)<br/>        Spacer()<br/>        Text(options[selection])<br/>            .foregroundColor(Color.black.opacity(0.6))<br/>        Image(systemName: "chevron.right")<br/>            .resizable()<br/>            .aspectRatio(contentMode: .fit)<br/>            .frame(width: 10, height: 10)<br/>    }<br/>    .font(Font.custom("Avenir Next", size: 16).weight(.medium))<br/>    .padding(.horizontal, 12)<br/>    .padding(.vertical, 8)<br/>    .background(Color.white)<br/>}</span></pre><p id="cd81" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们将<code class="fe mx my mz na b">title</code>和当前选择的拾取器放在<code class="fe mx my mz na b">HStack</code>中。我已经添加了一些样式来美化这一行，比如定制字体、添加填充，以及在后缘放置一个v形符号来表示我们的行是可选的。</p><h2 id="d204" class="me mf it bd mg mh mi dn mj mk ml dp mm kr mn mo mp kv mq mr ms kz mt mu mv mw bi translated">添加下拉选项</h2><p id="be46" class="pw-post-body-paragraph ki kj it kk b kl nb ju kn ko nc jx kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">下一步是构建视图，向用户显示可供选择的选项。对于<code class="fe mx my mz na b">DropdownPicker</code>，我们将使用<code class="fe mx my mz na b">ZStack</code>覆盖选项，并使用名为<code class="fe mx my mz na b">showOptions</code>的<code class="fe mx my mz na b">@State</code>变量动态显示它们。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi np"><img src="../Images/023f80783cbd96452899b24175627790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SNkplTQv-mnivgVc.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">DropdownPicker视图层次结构</figcaption></figure><p id="f66b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先在<code class="fe mx my mz na b">DropdownPicker</code>结构中声明名为<code class="fe mx my mz na b">showOptions</code>的新状态变量。</p><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="5a61" class="me mf it na b gy nk nl l nm nn">struct DropdownPicker: View {<br/>    <br/>    var title: String<br/>    @Binding var selection: Int<br/>    var options: [String]<br/>    <br/>    @State private var showOptions: Bool = false<br/>    <br/>    // Body below...<br/>    // ...<br/>}</span></pre><p id="c0a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后用一个<code class="fe mx my mz na b">ZStack</code>把<code class="fe mx my mz na b">body</code>里面的东西都包起来。</p><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="4e53" class="me mf it na b gy nk nl l nm nn">var body: some View {<br/>    ZStack {<br/>        HStack {<br/>            Text(title)<br/>            Spacer()<br/>            Text(options[selection])<br/>                //.foregroundColor(Color(red: 2/255, green: 99/255, blue: 195/255))<br/>                .foregroundColor(Color.black.opacity(0.6))<br/>            Image(systemName: "chevron.right")<br/>                .resizable()<br/>                .aspectRatio(contentMode: .fit)<br/>                .frame(width: 10, height: 10)<br/>        }<br/>        .font(Font.custom("Avenir Next", size: 16).weight(.medium))<br/>        .padding(.horizontal, 12)<br/>        .padding(.vertical, 8)<br/>        .background(Color.white)<br/>        <br/>        // Dropdown options here...<br/>    }<br/>}</span></pre><p id="e5ba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将添加下拉菜单的代码。因为我们想要动态显示选项，所以我们将使用<code class="fe mx my mz na b">showOptions</code>作为<code class="fe mx my mz na b">if</code>语句的条件。</p><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="686f" class="me mf it na b gy nk nl l nm nn">var body: some View {<br/>    ZStack {<br/>        // ...<br/>        // View code for closed row above<br/>        <br/>    	// Dropdown view code<br/>    	if showOptions {<br/>        <br/>    	}<br/>    }<br/>}</span></pre><p id="ffc5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后添加标题和选项的<code class="fe mx my mz na b">VStack</code>...</p><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="5778" class="me mf it na b gy nk nl l nm nn">var body: some View {<br/>    ZStack {<br/>        // ...<br/>        // View code for closed row above<br/>        <br/>    	// Dropdown view code<br/>    	if showOptions {<br/>            VStack(alignment: .leading, spacing: 4) {<br/>                Text(title)<br/>                    .font(Font.custom("Avenir Next", size: 16).weight(.semibold))<br/>                    .foregroundColor(.white)<br/>                HStack {<br/>                    // options here<br/>                }<br/>                .padding(.vertical, 2)<br/>                .transition(AnyTransition.move(edge: .top).combined(with: .opacity))<br/>            }<br/>    	}<br/>    }<br/>}</span></pre><p id="5d6e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们可以用<code class="fe mx my mz na b">options</code>数组构建出<code class="fe mx my mz na b">HStack</code>。我的代码下面是我在模型中使用的所有样式。请随意定制您喜欢的，并与它一起玩。</p><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="fa5c" class="me mf it na b gy nk nl l nm nn">var body: some View {<br/>    ZStack {<br/>        // ...<br/>        // View code for closed row above<br/>        <br/>    	// Dropdown view code<br/>    	if showOptions {<br/>            VStack(alignment: .leading, spacing: 4) {<br/>                Text(title)<br/>                    .font(Font.custom("Avenir Next", size: 16).weight(.semibold))<br/>                    .foregroundColor(.white)<br/>                HStack {<br/>                    Spacer()<br/>                    ForEach(options.indices, id: \.self) { i in<br/>                        if i == selection {<br/>                            Text(options[i])<br/>                                .font(.system(size: 12))<br/>                                .padding(.vertical, 8)<br/>                                .padding(.horizontal, 12)<br/>                                .background(Color.white.opacity(0.2))<br/>                                .cornerRadius(4)<br/>                        } else {<br/>                            Text(options[i])<br/>                                .font(.system(size: 12))<br/>                        }<br/>                        Spacer()<br/><br/>                    }<br/>                }<br/>                .padding(.vertical, 2)<br/>                .transition(AnyTransition.move(edge: .top).combined(with: .opacity))<br/>            }<br/>    	}<br/>    }<br/>}</span></pre><h2 id="f9f3" class="me mf it bd mg mh mi dn mj mk ml dp mm kr mn mo mp kv mq mr ms kz mt mu mv mw bi translated">添加点击手势</h2><p id="3a91" class="pw-post-body-paragraph ki kj it kk b kl nb ju kn ko nc jx kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">我们的<code class="fe mx my mz na b">DropdownPicker</code>只缺少一样东西。我们实际上还没有给它向用户显示下拉选项的能力。现在如果你点击这一行，什么也不会发生。最后一部分是向静态行和下拉列表中的选项添加点击手势。这是<code class="fe mx my mz na b">DropdownPicker</code>的最终视图代码。</p><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="66f8" class="me mf it na b gy nk nl l nm nn">import SwiftUI<br/><br/>struct DropdownPicker: View {<br/>    <br/>    var title: String<br/>    @Binding var selection: Int<br/>    var options: [String]<br/>    <br/>    @State private var showOptions: Bool = false<br/>    <br/>    var body: some View {<br/>        ZStack {<br/>            // Static row which shows user's current selection<br/>            HStack {<br/>                Text(title)<br/>                Spacer()<br/>                Text(options[selection])<br/>                    .foregroundColor(Color.black.opacity(0.6))<br/>                Image(systemName: "chevron.right")<br/>                    .resizable()<br/>                    .aspectRatio(contentMode: .fit)<br/>                    .frame(width: 10, height: 10)<br/>            }<br/>            .font(Font.custom("Avenir Next", size: 16).weight(.medium))<br/>            .padding(.horizontal, 12)<br/>            .padding(.vertical, 8)<br/>            .background(Color.white)<br/>            .onTapGesture {<br/>                // show the dropdown options<br/>                withAnimation(Animation.spring().speed(2)) {<br/>                    showOptions = true<br/>                }<br/>            }<br/>            <br/>            // Drop down options<br/>            if showOptions {<br/>                VStack(alignment: .leading, spacing: 4) {<br/>                    Text(title)<br/>                        .font(Font.custom("Avenir Next", size: 16).weight(.semibold))<br/>                        .foregroundColor(.white)<br/>                    HStack {<br/>                        Spacer()<br/>                        ForEach(options.indices, id: \.self) { i in<br/>                            if i == selection {<br/>                                Text(options[i])<br/>                                    .font(.system(size: 12))<br/>                                    .padding(.vertical, 8)<br/>                                    .padding(.horizontal, 12)<br/>                                    .background(Color.white.opacity(0.2))<br/>                                    .cornerRadius(4)<br/>                                    .onTapGesture {<br/>                                        // hide dropdown options - user selection didn't change<br/>                                        withAnimation(Animation.spring().speed(2)) {<br/>                                            showOptions = false<br/>                                        }<br/>                                    }<br/>                            } else {<br/>                                Text(options[i])<br/>                                    .font(.system(size: 12))<br/>                                    .onTapGesture {<br/>                                        // update user selection and close options dropdown<br/>                                        withAnimation(Animation.spring().speed(2)) {<br/>                                            selection = i<br/>                                            showOptions = false<br/>                                        }<br/>                                    }<br/>                            }<br/>                            Spacer()<br/>                        }<br/>                    }<br/>                    .padding(.vertical, 2)<br/>                    .transition(AnyTransition.move(edge: .top).combined(with: .opacity))<br/>                    <br/>                }<br/>                .padding(.horizontal, 12)<br/>                .padding(.vertical, 8)<br/>                .background(Color.black)<br/>                .foregroundColor(.white)<br/>                .transition(.opacity)<br/>                <br/>            }<br/>            <br/>        }<br/>    }<br/>}</span></pre><h2 id="68eb" class="me mf it bd mg mh mi dn mj mk ml dp mm kr mn mo mp kv mq mr ms kz mt mu mv mw bi translated">示例使用</h2><pre class="lf lg lh li gt ng na nh ni aw nj bi"><span id="27f5" class="me mf it na b gy nk nl l nm nn">DropdownPicker(title: "Size", selection: $selection, options: ["Small", "Medium", "Large", "X-Large"])</span></pre><h2 id="85f2" class="me mf it bd mg mh mi dn mj mk ml dp mm kr mn mo mp kv mq mr ms kz mt mu mv mw bi translated">喜欢这个教程？</h2><h2 id="b2d1" class="me mf it bd mg mh mi dn mj mk ml dp mm kr mn mo mp kv mq mr ms kz mt mu mv mw bi translated">让我们看看你做了什么！</h2><p id="4e1c" class="pw-post-body-paragraph ki kj it kk b kl nb ju kn ko nc jx kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">给我们发照片！给我们一个链接！任何事！在推特<a class="ae mb" href="https://twitter.com/TrailingClosure" rel="noopener ugc nofollow" target="_blank"> @TrailingClosure </a>、Instagram 上找到我们，或者发邮件到howdy@TrailingClosure.com<!-- --><!-- -->联系我们。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="651b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由<a class="ae mb" href="https://unsplash.com/@brigittetohm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">布里吉特·托姆</a>在<a class="ae mb" href="/s/photos/coffee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的SwiftUI模型中的咖啡照片</p></div></div>    
</body>
</html>