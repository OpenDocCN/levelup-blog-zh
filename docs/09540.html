<html>
<head>
<title>Why I Redesigned My SwiftUI App In UIKit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我在UIKit中重新设计了SwiftUI应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/why-i-redesigned-my-swiftui-app-in-uikit-6fd63a00e02c?source=collection_archive---------1-----------------------#2021-08-19">https://levelup.gitconnected.com/why-i-redesigned-my-swiftui-app-in-uikit-6fd63a00e02c?source=collection_archive---------1-----------------------#2021-08-19</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/e5e10f71e1d6d7faea711a8111e54f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Gxlt2Akl5lr_k6Xv"/></div></div><figcaption class="kc kd gk gi gj ke kf bd b be z dk translated">布雷特·乔丹在<a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="1bae" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">SwiftUI很棒。这是毫无疑问的。真正的差异制造者，只要使用代码原理制作的<strong class="kj iv"> UI。</strong></p><p id="5e8a" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">如果你问任何人为什么喜欢SwiftUI，你会得到这样的回答:“这是一个声明式UI。到处都是。”</p><p id="69e9" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">“那是什么意思？”你问。</p><p id="64c1" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">“这意味着你可以使用所见即所得的源文件来定义你的用户界面，而不是像过去那样所见即所得。那些令人讨厌的、不可分的故事板和东西。</p><p id="f7e1" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我很兴奋。我已经尝试过了，但我从心底里感到后悔。然而，我对Flutter的问题与社区驱动的劣质软件有关，而不是UI制作方法本身。老实说，我从来没有机会用Flutter设计丰富的UI。但是当读到那些经历过的人的经历时，我并不十分乐观。</p><p id="9ba2" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">但对于SwiftUI，我持乐观态度。至少，不是跨平台的。这不是假的土著，像扑和RN与他们深不可测的依赖地狱。</p><p id="2ae8" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">然而，我失望了。</p><p id="af77" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">事情是这样的。</p><h1 id="eaa9" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">#1:这是一个很好的开始</h1><p id="b149" class="pw-post-body-paragraph kh ki iu kj b kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la mi lc ld le in bi translated">SwiftUI在XCode中提供了实时预览，与故事板/XIB方法相比，感觉轻而易举。</p><p id="4da9" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我讨厌为每个设备特性定义自动布局的步骤。这是一个简单的UI道具层次被复杂的UX搞砸了。也许苹果校园里的某个守旧派觉得让开发者意识到他们想要做什么是很困难的:UI——苹果体验中最重要的部分。</p><p id="e819" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">有UI声明的自动布局DSL(故事板替换)比如<a class="ae kg" href="https://github.com/SnapKit/SnapKit" rel="noopener ugc nofollow" target="_blank"> SnapKit </a>，是的。但是在设计阶段，视觉反馈的缺失会使它们变得更糟。如果你是单独开发的话，未来的可维护性是一个很有争议的问题。</p><p id="b891" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我也成功地使用SwiftUI完成了面试代码分配。不是因为我很擅长SwiftUI，而是因为面试官也是SwiftUI的实验者。我的类设计，更不用说我创建的UI了，简直糟透了。然而，他们给了我尝试的分数。</p><p id="3763" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">当他们拒绝我时，绝不是因为我以错误的方式使用了某种状态或绑定。他们也没有发现任何错位的元素。他们不得不举出非程序性的原因。</p><p id="3f36" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我比他们强，只要斯威夫特去了。</p><p id="c0da" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">到那时我应该已经意识到了。如果他们中的大多数人也很糟糕，那么我就用错了工具。</p><h1 id="9a60" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">#2:我掌握了伟大的建筑:</h1><p id="ff3f" class="pw-post-body-paragraph kh ki iu kj b kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la mi lc ld le in bi translated">受到最初灰色区域成功的鼓舞，我决定尝试使用SwiftUI进行个人项目。</p><p id="a0ae" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">一个额外的激励是，一位雇主有兴趣在面试中看到我的SwiftUI爱好项目。(他拒绝了我，还是因为非SwiftUI的原因，但这不是重点)。</p><p id="61d1" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我开始在互联网上寻找一个适合我的多功能应用程序的伟大架构。如果我在面试中被拒绝，我仍然会有一个很棒的副业项目在我的指尖上的app store上推出。</p><p id="d05f" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">而且我偶然看到了<a class="ae kg" href="https://www.pointfree.co/collections/composable-architecture" rel="noopener ugc nofollow" target="_blank">可组合架构SwiftUI视频系列</a>。它完全改变了我对函数式反应式编程的许多想法。我开始了解Swift语言是如何丰富地设计的，以及它是如何从它的前辈那里继承最好的。</p><p id="8747" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">Combine，SwiftUI背后默默无闻的主心骨，至今我都不知道。尽管我在Flutter上失败了，但我还没有触及Rx的核心。这个视频系列是我从头开始学习它的一个很好的动力。</p><p id="5e53" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">有了更强大的架构支持，我已经准备好设计无限UI了。</p><h1 id="eb05" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">#3:混乱的开始:</h1><p id="0133" class="pw-post-body-paragraph kh ki iu kj b kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la mi lc ld le in bi translated">可组合架构解决了状态突变的最大问题:它将状态突变集中在一个被标识为<strong class="kj iv">存储</strong>的类下。这是一门学问，是解决大型代码库项目中出现的许多问题的瑞士军刀。我永远不会放弃它，不管我是否使用SwiftUI。</p><p id="718b" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">但是船开始在水最浅的地方下沉:UI。</p><p id="8889" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">接下来，我开始发现SwiftUI没有产生使用固有SwiftUI结构定义的Navbar外观。我开始看到自己创建由<strong class="kj iv">UIViewControllerRepresentable</strong>主持的精心制作的UIKit Viewcontrollers。在几乎所有这些Viewcontrollers中，我都编写了代码来创建工具栏按钮项目，因为由于项目的混合性质，通常的方法<strong class="kj iv">uinavigationbar . appearance</strong>也不起作用。</p><p id="3bc6" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我去StackOverflow的次数太多了，因为在UIKit的世界里，我已经知道了一些问题的解决方案。</p><p id="06ce" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">这对我来说还是可以的。我的项目不是太大。我可以处理它们，只要它能产生我所希望的UI。</p><h1 id="4086" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">#4:终极减速:</h1><p id="f019" class="pw-post-body-paragraph kh ki iu kj b kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la mi lc ld le in bi translated">我的整个应用程序严重依赖于一个视图——在SwiftUI中制作，故意利用它的好处——尤其是不可预见的动画。</p><p id="3736" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">没有它，它永远不会是我所希望的牛逼项目。</p><p id="9810" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">这个视图很好地从存储中获得了所需的状态更新。业务逻辑完美运行。唯一需要的就是锦上添花。我有一个很棒的工具，它以其独特的动画功能而闻名，我非常有信心。</p><p id="9416" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">但是当视图中的UI动作(视图的本地)开始增加时，事情就开始变得混乱了。</p><p id="28c1" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">尽管我试图从最好的动画资源中学习和组合，我还是没有找到我想要的方式来链接动画。我可以在几分钟内用UIKit编码。在SwiftUI，我战斗了将近一个星期。</p><p id="7dbb" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">动画被实现为效果的事实(用SwiftUI的点符号)使得事情变得无法表达，如果不是更糟的话。</p><p id="4059" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">即使在将我的状态变量减少到互斥枚举之后，我还是收到了太多的UI更新。我无法追踪是哪种状态突变导致了它们。到目前为止，在任何FRP库/框架中，没有IDE提供这种调用栈——至少据我所知是这样。我在使用Flutter时也有过同样的挣扎，而且知道SwiftUI仍然让它们击垮了我。</p><p id="a388" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">就是在那个时候，我想到我已经在这个<em class="lf">爱好</em>项目上浪费了多少时间。如果我想的话，我肯定能以MVP的身份发布它。</p><p id="2f6f" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">但是我的经历在其他方面挑战了我:我已经在特定的技术上工作了将近十年。现在，我大胆地用同样的技术尝试了一个新的范例。一个小小的任务让我做噩梦。我应该放弃我的目标吗？</p><p id="c51a" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">为什么我不能放弃我最近的大胆，用旧武器完成我想要的呢？</p><p id="0e83" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我问自己两个难题:</p><ul class=""><li id="6c47" class="mj mk iu kj b kk kl ko kp ks ml kw mm la mn le mo mp mq mr bi translated">为什么我还在使用SwiftUI？对此，我没有找到答案。(如果你还记得的话，我的雇主已经拒绝了我。)</li><li id="0de4" class="mj mk iu kj b kk ms ko mt ks mu kw mv la mw le mo mp mq mr bi translated">使用Swift UIKit重做所有工作需要多长时间？对此，我自信地回答“不超过3天。”</li></ul><p id="74fd" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我是多么正确！</p><p id="2105" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">仅用了2.5天，我就用旧而难看的故事板重新创建了整个东西(使用IBDesignable和IBInspectable，这比缓慢加载的SwiftUI预览要神奇得多，尽管我承认如果我的项目更大，它会慢得多)。</p><p id="66fc" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">再加上普通的Swift + UIKit。几乎不费吹灰之力，我就可以整合我预先创建的库中的动画。(我创建了这些库来观察丰富的WWDCs，再加上围绕UIKit的<a class="ae kg" href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514" rel="noopener ugc nofollow" target="_blank">伟大的苹果文档</a>，SwiftUI仍然缺乏这些丰富的内容)。</p><p id="b6a4" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">在我偶然发现的地方，我愉快地浏览了大量的开源回购，这些回购给了我100倍于我所需要的。</p><p id="7339" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我的项目只用了5天就完成了，包括后端集成，现在我正准备使用iTunesConnect和云后端进行前期制作工作。</p><h1 id="5029" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">要点:</h1><p id="6f6a" class="pw-post-body-paragraph kh ki iu kj b kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la mi lc ld le in bi translated">当我读到“<strong class="kj iv">将视图定义为状态的函数</strong>”的核心FRP原则时，我想不出UI制作的任何其他定义。</p><p id="3567" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">这个定义在我过去的许多面试中让我觉得很棒——相信我吧</p><p id="b6f4" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">但是经过这次经历，我不得不问自己:这和UIKit做的完全一样，比任何现存的FRP框架都更加透明。人们喜欢FRP(以及围绕它构建的UI渲染)的唯一原因是它能够从不属于它的地方带走“不受欢迎的状态突变”</p><p id="7f35" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">这是更好的解耦。从这个角度来说，FRP是一个很好的工具来执行一个原则，但不是必须的，如果你能以另一种方式做好的话。</p><p id="0f17" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">随着时间的推移，苹果有很大的能力来改进它的框架。从Swift 1.0到5.x，Swift走过了漫长的道路，如今，在社区的不断升级下，它似乎不可征服。也许SwiftUI可以模仿它的轨迹。但这样做，可能会疏远一代擅长利用硬件，但不擅长被塑造成固执己见的架构的程序员。</p><p id="3372" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">React更好的程序员会用客观点反驳我(<em class="lf">你烂，不是框架！</em>)，而我会愉快地接受我的失败。但是，同样的论点也可以用于非声明性方法，它们也不会错。</p><p id="7c1d" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">如果一种方法对新进入者构成了很高的障碍，并且不能解决许多问题，只是为了确保将来更好的可维护性这一逃避的目标，那么欢呼这种方法有什么意义呢？</p><p id="ec52" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">如果一个框架用更新的工具(和预先存在的范例)实现新奇的东西，<strong class="kj iv">是最好的</strong>。UIKit用当时流行的OOP做到了这一点。UIKit团队在NextStep的几年里花了很大的精力来设计它，然后将其移植到iDevices，并在过去10年里将它与围绕核心动画的深入解释文档和WWDCs一起带给开发人员。</p><p id="0c89" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">如果一个框架用更新的范例实现了新奇的东西(当开发人员也必须尽自己的努力去学习的时候)，<strong class="kj iv">它是好的</strong>。所有对FRP和声明式UI的尝试都属于这一类——无论是React、Flutter还是SwiftUI。</p><p id="0605" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">但在后一种情况下，它最好更简单——解决比“Hello world”对等物更复杂的问题。</p><p id="52c4" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">而且做的远不止这些:</strong>用预先建立的框架瞄准已知问题，同时不完成他们已经擅长的999件事情。</p></div><div class="ab cl mx my hy mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="in io ip iq ir"><p id="49d8" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><a class="ae kg" href="https://tipsnguts.medium.com/subscribe" rel="noopener">https://tipsnguts.medium.com/subscribe</a></p><p id="f13a" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><a class="ae kg" href="https://tipsnguts.medium.com/membership" rel="noopener">https://tipsnguts.medium.com/membership</a></p></div></div>    
</body>
</html>