<html>
<head>
<title>JavaScript Code Smells — Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript代码闻起来像函数</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-code-smells-functions-22920481564b?source=collection_archive---------3-----------------------#2020-02-14">https://levelup.gitconnected.com/javascript-code-smells-functions-22920481564b?source=collection_archive---------3-----------------------#2020-02-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6d2cfe7c5294f613957e5e92b7f02bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pIo22f9z8GaEF4-m"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@conklincreates?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚伦·康克林</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="9b3b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在编程中，代码气味是一段代码的特征，表明可能有更深层次的问题。这是一种主观特征，用于通过观察代码来判断代码是否质量良好。</p><p id="548f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将看到JavaScript函数的一些代码味道，包括过多的参数、过长的方法、标识符长度、返回过多的数据以及过长的代码行。</p><h1 id="ed1a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">参数太多</h1><p id="c080" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">函数可以有太多的参数。如果它们有太多，在读取和调用函数时，会使函数变得更加复杂。这可能意味着我们可以以某种方式清理代码，使其更易于阅读。</p><p id="9d09" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，以下函数有许多参数:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="dc31" class="mq lf it mm b gy mr ms l mt mu">const describeFruit = (color, name, size, price, numSeeds, type) =&gt; {<br/>  return `${fruitName} is ${fruitColor}. It's ${fruitSize}. It costs ${price}. It has ${numSeeds}. The type if ${type}`;<br/>}</span></pre><p id="26dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6个参数可能太多了。我们可以通过传入一个对象来解决这个问题:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="42a6" class="mq lf it mm b gy mr ms l mt mu">const describeFruit = (fruit) =&gt; {<br/>  return `${fruit.name} is ${fruit.color}. It's ${fruit.size}. It costs ${fruit.price}. It has ${fruit.numSeeds}. The type if ${fruit.type}`;<br/>}</span></pre><p id="be77" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如我们所见，它干净多了。我们不必担心传入许多参数。</p><p id="df6d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它也更适合屏幕，因为它更短。</p><p id="3b0e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5个参数可能是函数中应该有的最大值。</p><h1 id="8a7a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">过长的标识符</h1><p id="d9db" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">太长的标识符很难阅读。如果它们可以更短而不丢失任何信息，那么就让它们更短。</p><p id="b8de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以缩短下面的变量声明:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="50d3" class="mq lf it mm b gy mr ms l mt mu">let colorOfAFruit = 'red';</span></pre><p id="450c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">变成:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="2d44" class="mq lf it mm b gy mr ms l mt mu">let fruitColor = 'red';</span></pre><p id="96ec" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过移除<code class="fe mv mw mx mm b">Of</code>和<code class="fe mv mw mx mm b">A</code>使其变短。它不会改变意义或删除任何信息。然而，它更短，所以我们输入更少，并得到相同的结果。</p><h1 id="197f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">标识符过短</h1><p id="e20f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">标识符太短也是一个问题。这是因为太短的标识符不能捕捉我们定义的实体的所有含义。</p><p id="c152" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，以下变量名太短:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="ab4c" class="mq lf it mm b gy mr ms l mt mu">let x = 'red';</span></pre><p id="e83a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，<code class="fe mv mw mx mm b">x</code>太短了，因为我们不知道查看变量名是什么意思。</p><p id="a413" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相反，我们应该写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="0770" class="mq lf it mm b gy mr ms l mt mu">let fruitColor = 'red';</span></pre><p id="9ed2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我们知道变量是水果的颜色。</p><h1 id="ac56" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><em class="my">数据返回过多</em></h1><p id="658a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">返回我们不需要的数据的函数不好。一个函数应该只返回外部代码需要的东西，这样我们就不会暴露多余的不需要的东西。</p><p id="dd2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有以下函数:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="7eae" class="mq lf it mm b gy mr ms l mt mu">const getFruitColor = (fruit) =&gt; {<br/>  return {<br/>    ...fruit,<br/>    size: 'big'<br/>  };<br/>}</span></pre><p id="4eeb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有带有<code class="fe mv mw mx mm b">size</code>属性的<code class="fe mv mw mx mm b">getFruitColor</code>函数，它与水果的颜色无关。因此，它不需要也不应该随对象一起返回。</p><p id="1245" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相反，我们应该返回一个带有水果颜色的字符串，如下所示:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="3450" class="mq lf it mm b gy mr ms l mt mu">const getFruitColor = (fruit) =&gt; fruit.color;</span></pre><p id="4959" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的代码要干净得多，只返回函数名所暗示的水果颜色。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/a445c8a182327d33dddb8b7c1c73b538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DX_pofn05qq8zHG2"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">威尔·马洛特在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h1 id="29a6" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><em class="my">过长的代码行</em></h1><p id="d723" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">过长的代码行使得代码库难以阅读、理解和调试。</p><p id="33fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码太长以至于不适合在屏幕上显示，可能应该分成多行。</p><p id="3779" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，不要写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="45ce" class="mq lf it mm b gy mr ms l mt mu">$("p").html("This is a paragraph").css("color", "red").css("text-align", "center").slideUp(1000).slideDown(1000);</span></pre><p id="fbf1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该改为写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="b283" class="mq lf it mm b gy mr ms l mt mu">$("p")<br/>  .html("This is a paragraph")<br/>  .css("color", "red")<br/>  .css("text-align", "center")<br/>  .slideUp(1000)<br/>  .slideDown(1000);</span></pre><p id="d763" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样干净多了，不会溢出屏幕。</p><p id="2b47" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每行代码不应该超过100个字符，这样就可以不用在任何屏幕上滚动就可以阅读。</p><p id="634e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在大多数情况下，代码格式化程序可以重新排列代码行，使它们更短。</p><h1 id="5cd6" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="86a0" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在一个方法中有太多的参数会使传递数据变得困难，因为很容易遗漏一些项目。这也使得方法签名过长。</p><p id="e0de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">标识符的长度应该足以识别我们需要的信息。此外，它不应该太短，以至于我们无法从标识符中获得足够的信息。</p><p id="fe39" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个函数应该只返回我们需要的项目，而不是更多。这使得使用该函数变得容易，因为需要处理的数据更少，并且不会暴露我们不想暴露的额外信息。</p><p id="e041" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，长代码行应该分成多行，这样更容易阅读和修改。代码格式化程序可以自动将代码分成多行。</p></div></div>    
</body>
</html>