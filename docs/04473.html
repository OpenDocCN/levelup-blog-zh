<html>
<head>
<title>Introduction to Deno — The Next Level of NodeJS Runtime</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Deno介绍NodeJS运行时的下一个级别</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/introduction-to-deno-the-next-level-of-nodejs-runtime-eacaf2966d94?source=collection_archive---------17-----------------------#2020-06-28">https://levelup.gitconnected.com/introduction-to-deno-the-next-level-of-nodejs-runtime-eacaf2966d94?source=collection_archive---------17-----------------------#2020-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/22c42e0a7e75bcaf8266d4cd34e1fe51.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*HVcqMKR0rfseH_PMcCwLbQ.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">德诺</figcaption></figure><p id="3915" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> Deno </strong>是<strong class="kd iu"> JavaScript </strong>和<strong class="kd iu"> TypeScript </strong>的安全运行时。它是由开发NodeJS运行时的同一个人开发的，<strong class="kd iu"> Ryan Dahl </strong>。Deno使用<strong class="kd iu"> V8 </strong>发动机，内置<strong class="kd iu"> Rust </strong>。</p><p id="3fc6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Deno在默认情况下是安全的，这意味着除非在运行程序时明确指定，否则不能访问网络、文件系统或环境等。</p><p id="959d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Deno还支持开箱即用的TypeScript，所有标准模块都从HTTP服务器导入并缓存在本地，这与nodeJS不同，NodeJS在node_modules中维护模块，如果程序需要特定的模块，Node将遍历整个树结构来解析该模块。</p><h1 id="9fbe" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">安装Deno: </strong></h1><p id="c8b9" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果您在Mac上使用自制软件，请执行:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="71ca" class="ml la it mh b gy mm mn l mo mp">brew install deno</span></pre><p id="5244" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">或者在Mac/Linux上使用shell:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="6c72" class="ml la it mh b gy mm mn l mo mp">curl -fsSL <a class="ae mq" href="https://deno.land/x/install/install.sh" rel="noopener ugc nofollow" target="_blank">https://deno.land/x/install/install.sh</a> | sh</span></pre><p id="fc4f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于Windows，使用PowerShell，执行:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="c22f" class="ml la it mh b gy mm mn l mo mp">iwr <a class="ae mq" href="https://deno.land/x/install/install.ps1" rel="noopener ugc nofollow" target="_blank">https://deno.land/x/install/install.ps1</a> -useb | iex</span></pre><p id="1c56" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在让我们使用Deno runtime编写一个简单的web服务器JavaScript程序。</p><p id="b0f1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> server.js </strong></p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="bf80" class="ml la it mh b gy mm mn l mo mp">import { serve } from "https://deno.land/std@0.59.0/http/server.ts";</span><span id="25ba" class="ml la it mh b gy mr mn l mo mp">console.log('App is listening on Port: 5000');</span><span id="efc4" class="ml la it mh b gy mr mn l mo mp">async function main(){</span><span id="1da9" class="ml la it mh b gy mr mn l mo mp"> for await ( let request of serve(":5000")){</span><span id="42f2" class="ml la it mh b gy mr mn l mo mp"> const resBody = new TextEncoder().encode("Hello Deno\n");</span><span id="086b" class="ml la it mh b gy mr mn l mo mp"> request.respond( { resBody });</span><span id="d173" class="ml la it mh b gy mr mn l mo mp"> }</span><span id="bd67" class="ml la it mh b gy mr mn l mo mp">}</span><span id="c902" class="ml la it mh b gy mr mn l mo mp">main();</span></pre><p id="f189" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要运行该程序，请执行</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="f654" class="ml la it mh b gy mm mn l mo mp">deno run server.js</span></pre><p id="ce07" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Deno将开始从互联网下载标准模块server.ts到本地机器，并将缓存在/Users/<userid>/Library/Caches/deno(对于Mac)</userid></p><h1 id="32c6" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">控制台输出:- </strong></h1><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="cf59" class="ml la it mh b gy mm mn l mo mp">vinod827@Vinods-MacBook-Pro deno % deno run server.js<br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/http/server.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/http/server.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/encoding/utf8.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/encoding/utf8.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/io/bufio.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/io/bufio.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/_util/assert.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/_util/assert.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/async/mod.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/async/mod.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/http/_io.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/http/_io.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/async/deferred.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/async/deferred.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/async/delay.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/async/delay.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/async/mux_async_iterator.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/async/mux_async_iterator.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/textproto/mod.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/textproto/mod.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/http/http_status.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/http/http_status.ts</a><br/>Download <a class="ae mq" href="https://deno.land/std@0.59.0/bytes/mod.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/bytes/mod.ts</a><br/>Compile file:///Users/vinod827/go/mywork/mydevelopment/deno/server.js<br/>App is listening on Port: 5000<br/>error: Uncaught PermissionDenied: network access to “:5000”, run again with the — allow-net flag<br/> at unwrapResponse ($deno$/ops/dispatch_json.ts:43:11)<br/> at Object.sendSync ($deno$/ops/dispatch_json.ts:72:10)<br/> at Object.listen ($deno$/ops/net.ts:51:10)<br/> at Object.listen ($deno$/net.ts:155:22)<br/> at serve (<a class="ae mq" href="https://deno.land/std@0.59.0/http/server.ts:256:25" rel="noopener ugc nofollow" target="_blank">https://deno.land/std@0.59.0/http/server.ts:256:25</a>)<br/> at main (file:///Users/vinod827/go/mywork/mydevelopment/deno/server.js:6:32)<br/> at file:///Users/vinod827/go/mywork/mydevelopment/deno/server.js:12:1<br/>vinod827@Vinods-MacBook-Pro deno %</span></pre><p id="17e2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您还会遇到权限错误。就像我上面说的，Deno在默认情况下是安全的，所以您需要明确地给出在您的机器上运行HTTP服务器的许可。</p><p id="2a9e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用标志<code class="fe ms mt mu mh b">--allow-net</code>重新运行相同的程序，如下所示:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="c059" class="ml la it mh b gy mm mn l mo mp">deno run --allow-net server.js</span></pre><h1 id="e220" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">新增</strong> <strong class="ak">控制台输出:</strong></h1><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="83bf" class="ml la it mh b gy mm mn l mo mp">vinod827@Vinods-MacBook-Pro deno % deno run — allow-net server.js<br/>Compile file:///Users/vinod827/go/mywork/mydevelopment/deno/server.js<br/>App is listening on Port: 5000</span></pre><p id="44f7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在让我们调用我们的API。</p><p id="e08c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">执行GET curl操作，您将看到输出</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="f89a" class="ml la it mh b gy mm mn l mo mp">curl http://localhost:5000 </span><span id="fc1d" class="ml la it mh b gy mr mn l mo mp">HTTP Request:: ServerRequest {<br/> done: Promise { &lt;pending&gt; },<br/> _contentLength: undefined,<br/> _body: null,<br/> finalized: false,<br/> conn: ConnImpl {<br/> rid: 4,<br/> remoteAddr: { hostname: “127.0.0.1”, port: 56280, transport: “tcp” },<br/> localAddr: { hostname: “127.0.0.1”, port: 5000, transport: “tcp” }<br/> },<br/> r: BufReader {<br/> r: 78,<br/> w: 78,<br/> eof: false,<br/> buf: Uint8Array(4096) [<br/> 71, 69, 84, 32, 47, 32, 72, 84, 84, 80, 47, 49, 46, 49, 13,<br/> 10, 72, 111, 115, 116, 58, 32, 108, 111, 99, 97, 108, 104, 111, 115,<br/> 116, 58, 53, 48, 48, 48, 13, 10, 85, 115, 101, 114, 45, 65, 103,<br/> 101, 110, 116, 58, 32, 99, 117, 114, 108, 47, 55, 46, 54, 52, 46,<br/> 49, 13, 10, 65, 99, 99, 101, 112, 116, 58, 32, 42, 47, 42, 13,<br/> 10, 13, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> … 3996 more items<br/> ],<br/> rd: ConnImpl {<br/> rid: 4,<br/> remoteAddr: { hostname: “127.0.0.1”, port: 56280, transport: “tcp” },<br/> localAddr: { hostname: “127.0.0.1”, port: 5000, transport: “tcp” }<br/> }<br/> },<br/> method: “GET”,<br/> url: “/”,<br/> proto: “HTTP/1.1”,<br/> protoMinor: 1,<br/> protoMajor: 1,<br/> headers: Headers { host: localhost:5000, user-agent: curl/7.64.1, accept: */* },<br/> w: BufWriter {<br/> usedBufferBytes: 0,<br/> err: null,<br/> writer: ConnImpl {<br/> rid: 4,<br/> remoteAddr: { hostname: “127.0.0.1”, port: 56280, transport: “tcp” },<br/> localAddr: { hostname: “127.0.0.1”, port: 5000, transport: “tcp” }<br/> },<br/> buf: Uint8Array(4096) [<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> … 3996 more items<br/> ]<br/> }<br/>}</span></pre><p id="07ab" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们深入研究一下，看看Deno在运行这个程序时是如何缓存依赖项的，以及缓存在哪里。</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="54fe" class="ml la it mh b gy mm mn l mo mp">deno info server.js</span></pre><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/3fa917b8fa030a41a41db52257c587f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnwzcD-aIdf2fKNJ-PVWLw.png"/></div></div></figure><p id="45f1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你看到上面的截图，我们的程序server.js依赖于server.ts，而server . ts又依赖于其他各种类。</p><p id="9e73" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在Mac上，导航到/Users/<userid>/Library/Caches/deno，这是Deno的根文件夹，用于缓存本地机器上的资源。如果你注意到，有两个主文件夹:<strong class="kd iu"> gen </strong>和<strong class="kd iu"> deps </strong>。从互联网上下载的所有资源都缓存在本地的<strong class="kd iu"> deps </strong>文件夹中(在我们的程序中，我们只使用了HTTP，它缓存在这里) :</userid></p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi na"><img src="../Images/0fe7324413b69b8f0156ed1d74c5e9c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G6RUxBEEG-FdVZyzh6ZdcA.png"/></div></div></figure><p id="c034" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<strong class="kd iu"> gen </strong>文件夹中，保存了所有编译好的类型脚本文件和源文件。</p><p id="9291" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我希望你对Deno有所了解！</p><p id="7a5d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请分享你的反馈。</p><p id="9927" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="nb">欢呼</em></p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><div class="mc md me mf gt nj"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">编写面试问题</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">掌握编码面试的过程</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">技术开发</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jv nj"/></div></div></a></div></div></div>    
</body>
</html>