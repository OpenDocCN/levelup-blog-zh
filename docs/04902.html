<html>
<head>
<title>Deep Learning for Alzheimer’s Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">针对阿尔茨海默氏症分类的深度学习</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deep-learning-for-alzheimers-classification-57611161e442?source=collection_archive---------6-----------------------#2020-07-22">https://levelup.gitconnected.com/deep-learning-for-alzheimers-classification-57611161e442?source=collection_archive---------6-----------------------#2020-07-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8a00e60e1bebbd3490c121ccc761786a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Wbmrxcwmr5Ld9kXdV0ioA.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">(ref:<a class="ae kf" href="https://www.ox.ac.uk/news/2018-05-01-how-decisions-form-brain-physical-basis-cognitive-process#" rel="noopener ugc nofollow" target="_blank">Y</a>ur chanka Siarhei via<a class="ae kf" href="https://www.shutterstock.com/image-illustration/human-brain-digital-illustration-electrical-activity-719796733?src=0qMPwIzLEtNMAGGfywpNHw-1-23" rel="noopener ugc nofollow" target="_blank">Shutterstock</a></figcaption></figure><h1 id="5efe" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">1.介绍</h1><p id="be00" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">到2050年，阿尔茨海默氏病将影响9000万人，这相当于英国的人口。这是一种特殊形式的痴呆症，会导致情节性记忆丧失、健忘和视觉空间定向问题。没有人希望自己爱的人忘记自己的名字。</p><p id="1ac4" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">虽然治愈阿尔茨海默氏症还有一段时间，但我们可以通过尽早治疗来减缓疾病的发展速度。疾病发现得越早，就能越早地为受试者提供治疗。自动化这样的诊断任务在整个医学科学中也有许多积极的意义。</p><p id="4660" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">当然，检测一个人是否已经患有阿尔茨海默病并不是很有用，相反，我们希望预测一个人在未来几年内患该病的概率。为了实现这一点，医生主要依靠受试者接受的认知测试，并通过查看他们的MRI扫描。因此，这两个输入都将被输入我们的自动化系统。</p><h1 id="6940" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">2.要求</h1><p id="c1d4" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在开始这个项目之前，建议您对卷积神经网络有一些了解，并且您可能已经理想地实现了一个更简单的神经网络来完成诸如猫对狗这样的任务。</p><p id="0922" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们将使用python和PyTorch进行深度学习。你将需要一台强大的计算机或云gpu集群在合理的时间内训练代码。谷歌云或AWS是两个很好的服务，但可能会变得昂贵，所以要小心。</p><h2 id="b63a" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">2.1克隆GitHub repo</h2><p id="b3fc" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">幸运的是，所有必要的代码都已经为您编写好了。您可以通过以下方式克隆回购</p><blockquote class="mt mu mv"><p id="2e19" class="le lf mw lg b lh mc lj lk ll md ln lo mx me lr ls my mf lv lw mz mg lz ma mb im bi translated">https://github.com/McSpooder/camull-net.git的git克隆<a class="ae kf" href="https://github.com/McSpooder/camull-net.git" rel="noopener ugc nofollow" target="_blank"/></p></blockquote><h2 id="a155" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">2.2 Python库</h2><p id="2b51" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们将使用下面的库，这些库必须使用像pip这样的包管理器来安装。然而，我强烈建议您安装conda，用<a class="ae kf" href="https://github.com/McSpooder/camull-net" rel="noopener ugc nofollow" target="_blank"> environment.yml </a>文件自动完成这个过程。</p><p id="5542" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Pytorch 1.4.0—张量变换深度学习库</p><p id="e12e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Numpy 1.18.1—用于在python中创建和操作数组的数据科学库</p><p id="b1b0" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Pandas 0.25.3—用于检查和预处理医疗数据的数据科学库。</p><p id="3ede" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">ni Abel 3 . 0 . 0—用于将MRI扫描加载到python中的库</p><p id="c673" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Tqdm 4.42.1—用于向控制台输出进度的库。</p><p id="f891" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果您有conda，您可以执行以下操作:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="696c" class="mh kh it nf b gy nj nk l nl nm">conda env create -f environment.yml</span></pre><h2 id="ddb9" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">2.3数据</h2><p id="a3e4" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">会有多个数据流进入这个神经网络。一个用于3D MRI数据，另一个用于对象的临床数据。MRI数据将是3D张量，而临床数据将是2D值向量。临床数据包含患者的人口统计学、认知和遗传信息。</p><p id="1994" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">数据应该从<a class="ae kf" href="http://adni.loni.usc.edu/data-samples/access-data/" rel="noopener ugc nofollow" target="_blank"> ADNI </a>获得。你需要用大学的电子邮件地址注册这个网站才能访问。从那里获取数据的好处是MRI体积已经被预处理和配准，这意味着体积被对准到共同的中心。在<a class="ae kf" href="https://github.com/McSpooder/camull-net/wiki/Data-Requirements" rel="noopener ugc nofollow" target="_blank">这里</a>可以找到检索用于这个项目的准确数据的说明。</p><h1 id="ebd4" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">3.数据探索</h1><p id="f982" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">看一看我们将输入神经网络的数据是很重要的。这一阶段是可选的，但您至少应该通读一遍，以便更好地理解网络所需的层架构。</p><h2 id="24c3" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">3.1磁共振成像体积</h2><p id="ef6d" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">MRI体积存储在“漂亮的”文件中。“nii”文件扩展名。可以使用nibabel加载它们，并使用matplotlib库显示它们。</p><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="7936" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">运行此代码后，您将能够看到MRI体积的前8个切片。</p><figure class="na nb nc nd gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/fed58e60d417b9d69a9a24b8c582aeac.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*IxCjtwudzZy657TnwsokdA.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">矢状面上MRI体积的切片</figcaption></figure><p id="e9fe" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">你还应该看到每个体积的尺寸都是110x110x110。就像2D图像的最小单位是像素一样，3D体积的最小单位是体素。</p><h2 id="ec33" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">3.2临床数据</h2><p id="7800" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">临床数据包括认知评估、人口统计和遗传信息。最终，它只是一组数字，将与MRI张量一起输入神经网络。</p><p id="420d" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">为了更好地理解它，我们将加载原始的csv文件并用pandas可视化它。该文件保留了原始的分类变量值。</p><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="6da2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">您将看到数据主要包含数字属性和4个分类属性。</p><figure class="na nb nc nd gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/edb2f3c85a5c663707b84ddd79aaca42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MbaFh_sOQWqaySsFWryLbg.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">前五名受试者的临床数据</figcaption></figure><p id="fadc" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这是两个标签的正态分布图。它表明，患有进行性轻度认知障碍的人往往年龄较大。</p><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="na nb nc nd gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/aada44f956fe69041abf5965e6bba813.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*fBqLHSQibS-6be6SEi5LrA.png"/></div></figure><h1 id="678d" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">4.体系结构</h1><p id="268d" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">该项目的架构是由Simeon Spasov等人开发的。艾尔。这不是我的功劳。然而，由于训练数据不同，一些内核变得更小，因此略有不同。</p><p id="a14c" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">该架构由卷积块、3d可分离卷积和全连接块组成。块只是神经网络层的分组，例如批量标准化、指数线性单元和丢失。</p><figure class="na nb nc nd gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/4f31eec7f450ff6db1c90a762d862f0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*guvHPIlisovNCCltm5W8-w.png"/></div></div></figure><p id="4ed6" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">conv块中的最大池将是负责MRI数据降维的主要层。而可分离卷积块将用于将输入映射到不同的特征空间。</p><figure class="na nb nc nd gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/b3c7a26a268be19c2775aac109d11c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hbOeKu1qpQXQYA1RNWzkJA.png"/></div></div></figure><h2 id="b468" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">4.1可分离卷积</h2><p id="fc46" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">可分离卷积是这种实现的亮点之一。他们将卷积矩阵分解成两个张量，实现相同的计算。这减少了参数的数量，但是以卷积的可能性为代价。换句话说，不是每一个卷积都可以被一个单独的卷积复制，但足以使它仍然是一种有效的技术。</p><h2 id="bbad" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">4.2激活</h2><p id="27c7" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最终输出将是0和1之间的数字，其中前者代表静态轻度认知障碍，后者代表进行性轻度认知障碍。为了强制输出在此范围内，使用了sigmoid激活。</p><p id="943f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">将使用Adam优化器和可变学习率对网络进行150个时期的训练。为了更好地理解为什么使用以下排列和超参数，您应该阅读<a class="ae kf" href="https://www.sciencedirect.com/science/article/abs/pii/S105381191930031X" rel="noopener ugc nofollow" target="_blank">这篇</a>论文。</p><h1 id="eeb6" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">5.PyTorch实现</h1><p id="c161" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下面的架构将以面向对象的方式在PyTorch中实现，以提高可读性。每个块将从nn继承。模块类，并且将有一个forward方法，该方法指示应该如何使用这些层来转换输入。同样，整个项目的完整代码可以在<a class="ae kf" href="https://github.com/McSpooder/camull_net/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="f530" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">5.1数据集</h2><p id="bbfc" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">深度学习需要将数据放到GPU上进行并行计算。否则，执行线性转换会花费很长时间。幸运的是，只要我们定义一个数据加载器和一个数据集，PyTorch就能为我们做到这一点。这些类指定了数据在放到GPU上之前如何被解释和处理。</p><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="a667" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这里的要点是，整个临床数据csv一次加载并存储在一个属性中。然后是MRI的训练目录列表。nii文件是为以后获取它们而建立的。</p><p id="e97a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在，MRI获取方法应该添加到数据集。pytorch数据加载器将使用它将数据放到GPU上。</p><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="d7d1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">请注意idx参数。它将始终介于零和数据集长度之间(不包括零和数据集长度)。当从列表中获取MRI数据时，它被用作索引。</p><p id="2c72" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">while循环确实存在，以防MRI扫描被破坏。</p><h2 id="58a6" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">5.2数据加载器</h2><h2 id="252f" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">5.3 Conv街区示例</h2><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="e6f1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">正向方法中的x将是存储在3D张量中的MRI体积。每一层将一个接一个地应用。</p><h2 id="7707" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">5.4串联和加法连接跳过</h2><p id="aa63" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">连接跳过是在主架构图中可以看到的多个层上的跳跃。他们所做的是将输入保存在一个单独的变量中，然后在转换原始变量后，将它添加或连接到结果中。这种行为是在模型的正向函数中规定的。</p><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">将原件添加到结果中</figcaption></figure><figure class="na nb nc nd gt ju"><div class="bz fp l di"><div class="nn no l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">将原始内容连接到结果</figcaption></figure><p id="b569" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">串联方法中的第二个参数表示连接两个张量的轴。索引0对应于批处理大小，因此索引1用于连接。</p><h2 id="ff2f" class="mh kh it bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">5.5列车环路</h2><h1 id="deb0" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">6.结果</h1><figure class="na nb nc nd gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/333ce4d277dcb99b2e8512d7f4bdae70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*_hQFTGH1kHoO4jEEOmBPCQ.png"/></div></figure><p id="9166" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">最接近1的区域是最佳的。</p><p id="8cc4" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">参考文献</strong></p><p id="9a48" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><a class="ae kf" href="https://www.sciencedirect.com/science/article/abs/pii/S105381191930031X" rel="noopener ugc nofollow" target="_blank">https://www . science direct . com/science/article/ABS/pii/s 105381191930031 x</a></p></div></div>    
</body>
</html>