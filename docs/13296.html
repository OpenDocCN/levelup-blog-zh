<html>
<head>
<title>Bloom Filters: Visuals for explanation and applied systems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">布鲁姆过滤器:解释和应用系统的视觉效果</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/bloom-filters-visuals-for-explanation-and-applied-systems-b58fb3cf524?source=collection_archive---------2-----------------------#2022-08-24">https://levelup.gitconnected.com/bloom-filters-visuals-for-explanation-and-applied-systems-b58fb3cf524?source=collection_archive---------2-----------------------#2022-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="db21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">bloom filter数据结构允许您添加元素和检查包含性，就像集合一样。他们保证有0%的假阴性率。然而，问题是它们的假阳性率非常低(0-2%)，这取决于添加元素的量。简而言之，当bloom filter告诉你它不包含元素时，你可以相信它是正确的，但当它说是的，它确实包含元素时，它实际上只是一种可能。</p><p id="6d51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么为什么会有人用布隆滤镜而不用set呢？被配置成支持大量独特元素的布隆过滤器将具有比容纳相同数量的独特元素的集合更小的空间占用量数量级。这种为节省大量空间而进行的精度上的小折衷最终对某些系统优化非常有用。</p><p id="ce43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们探索一些视觉效果，展示它们是如何工作的，以及它们可以应用于何处来提供价值的例子。</p><h1 id="322a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">添加元素</h1><p id="7b89" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在我们的例子中，我们将使用一个bloom filter并添加“Peter”和“Sam”字符串元素。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/24da67c4b3d0d81f44787c1e0d764dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5HDQo5wWGBgPj_7QDFiVA.png"/></div></div></figure><p id="87a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">bloom filter的工作方式是获取元素，将它们运行N个不同的哈希函数，每个函数都带有一个伴随的位向量，然后根据观察到的哈希将伴随向量中的位置设置为真。一旦位置翻转为真(1)，就不会再设置回假(0)。</p><p id="df97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于Peter来说，这些函数产生散列2、6和7。它将从0 → 1设置这些位置。对于位置5、2和5的Sam也是如此。</p><p id="4e24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不同散列函数的数量N以及位向量的长度通常在实现中基于配置的容量和最大允许错误率进行反向工程。容量是我们期望布隆过滤器能够看到的不同元素的数量。</p><h1 id="ed7f" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">密封检查</h1><p id="c118" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">现在让我们看看它如何确定它是否包含一个元素。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ma"><img src="../Images/814bdf9c97d295a211a79abbd511609d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hCwivv91BuskNzZ1ebq6jw.png"/></div></div></figure><p id="1e1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Mary的例子中，当我们通过散列函数运行它时，我们得到散列值3、8和1。在我们添加的内容中，没有一个位置被设置为True，所以我们为包含报告False。这是正确的回答。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ma"><img src="../Images/5990d697c895bf665cf42363e01c53fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n0KWDhz-Hu0m_UTt0r7frQ.png"/></div></div></figure><p id="536e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于Steve，我们得到散列9、2和6。第二个函数为Steve生成的散列与我们之前添加Sam时生成的散列冲突，这导致该检查报告为True。</p><p id="3b9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，因为其他两个函数产生的散列在它们各自的向量位置上显示了假值，所以bloom filter仍然会正确地为整体包含检查报告假值。在我们的例子中，所有三个检查必须在逻辑上结合在一起，以产生一个整体的遏制真值。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mb"><img src="../Images/754753c97d41e2d6c080cca1a6adb3f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l5W7rw7zyP97SEnoR34UJQ.png"/></div></div></figure><p id="96c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在马克的例子中，由于运气不好，2、6和5的哈希值恰好与彼得和萨姆的早期添加相冲突。在这种情况下，布隆过滤器将在每个位向量上看到真，并错误地报告包含为真，而事实上布隆过滤器从未看到元素“标记”。</p><p id="fc24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是小错误率产生的原因。</p><p id="ffe7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们正在检查Peter或Sam，检查将看到这些实体的所有位置都设置为True，并正确地响应包含的True。然而，在一般情况下，向量位置可能已经被具有冲突散列的某个其他元素设置为真，所以我们不一定相信任何答案是100%准确的。</p><p id="fdf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好消息是，该结构根据其设计，绝不会意外地声明某个元素实际上不在系统中(假阴性)。一旦我们添加了一个元素，正确的向量位置就会翻转为真，并且永远不会翻转回假。</p><p id="fe6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，当您不能总是信任正匹配的包含准确性时，这种结构对实际系统有什么用呢？</p><p id="c036" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有时可以利用bloom filter的小空间需求和零假阴性承诺来尝试和避免做不必要的工作。</p><h1 id="a38a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">布隆过滤器应用的几个例子</h1><h1 id="616e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">1.内部连接/半连接欺骗</h1><p id="f970" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">如果在Spark中内部连接两个数据集，一个是大型数据集，一个是中型数据集，其中混洗连接是不可避免的，我们可以使用bloom filter来避免从大型表中混洗在中型表中没有匹配的行。使用一个集合来包含所有的密钥可能不适合机器内存，所以这是bloom filter可以大放异彩的地方。</p><p id="6184" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何通过布隆过滤器的误报都将在内部连接过程中被丢弃。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mc"><img src="../Images/488e98f303d1454954c1145706511e8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLAZWC9DpivGvhXa8bbJtA.png"/></div></div></figure><h1 id="7354" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">2.Chrome不安全/恶意网址客户端检查。</h1><p id="1fd0" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">Chrome有一个bloom过滤器来检查客户端的URL是否绝对没有恶意。任何误报(bloom filter认为是恶意的URL，但实际上不是)将只需要后续的远程服务检查，并浪费一点时间来验证它们。</p><p id="687e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这比每次检查远程服务都被频繁告知URL是安全的要好。将不安全的URL存储在驻留在浏览器内存中的集合中是不切实际的，因为需要空间来保存每个唯一的URL。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi md"><img src="../Images/c7f23f820b962bbdd5e2b22dec2d51c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yznn9f-x-uLuVUrFFh3YcQ.png"/></div></div></figure><h1 id="5537" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">3.通过跳过存储文件来节省行磁盘I/O。</h1><p id="30ca" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">检索给定行的列族详细信息有时需要读取磁盘上的多个存储文件。bloom filter可以省去扫描存储文件的麻烦，这些文件没有任何与给定行相关的信息。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/69ac13a4d2c909aa8ad58bfe0869a0e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nox0cp_oSY-k8Bl9IkTLMg.png"/></div></div></figure><h1 id="9215" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">来源:</h1><ol class=""><li id="4718" class="mf mg iq jp b jq lj ju lk jy mh kc mi kg mj kk mk ml mm mn bi translated">布隆过滤器连接。https://issues.apache.org/jira/browse/SPARK-32268<a class="ae mo" href="https://issues.apache.org/jira/browse/SPARK-32268" rel="noopener ugc nofollow" target="_blank"/></li><li id="52ff" class="mf mg iq jp b jq mp ju mq jy mr kc ms kg mt kk mk ml mm mn bi translated">谷歌安全浏览:【https://developers.google.com/safe-browsing/ T4】</li><li id="5948" class="mf mg iq jp b jq mp ju mq jy mr kc ms kg mt kk mk ml mm mn bi translated">Nice Bloom Filter应用程序<a class="ae mo" href="https://web.archive.org/web/20101027012345/http://blog.alexyakunin.com/2010/03/nice-bloom-filter-application.html" rel="noopener ugc nofollow" target="_blank">https://web . archive . org/web/2010 10 27012345/http://blog . alexyakunin . com/2010/03/nice-Bloom-Filter-Application . html</a></li><li id="ab5d" class="mf mg iq jp b jq mp ju mq jy mr kc ms kg mt kk mk ml mm mn bi translated">阿帕奇h base:<a class="ae mo" href="https://hbase.apache.org/" rel="noopener ugc nofollow" target="_blank">https://hbase.apache.org/</a></li><li id="bf7f" class="mf mg iq jp b jq mp ju mq jy mr kc ms kg mt kk mk ml mm mn bi translated">HBase布鲁姆过滤器:【https://issues.apache.org/jira/browse/HBASE-1200 T2】</li><li id="d687" class="mf mg iq jp b jq mp ju mq jy mr kc ms kg mt kk mk ml mm mn bi translated">布鲁姆滤镜是如何用在h base:【https://www.quora.com/How-are-bloom-filters-used-in-HBase T4】</li></ol></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="660a" class="kl km iq bd kn ko nb kq kr ks nc ku kv kw nd ky kz la ne lc ld le nf lg lh li bi translated">分级编码</h1><p id="42b0" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="3bb4" class="mf mg iq jp b jq jr ju jv jy ng kc nh kg ni kk nj ml mm mn bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="7c15" class="mf mg iq jp b jq mp ju mq jy mr kc ms kg mt kk nj ml mm mn bi translated">📰查看<a class="ae mo" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="b8b8" class="mf mg iq jp b jq mp ju mq jy mr kc ms kg mt kk nj ml mm mn bi translated">🔔关注我们:<a class="ae mo" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae mo" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae mo" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="cb02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">🚀👉<a class="ae mo" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>