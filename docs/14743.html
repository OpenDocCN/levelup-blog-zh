<html>
<head>
<title>How To Build A NPM Package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建NPM包</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-build-an-npm-package-4158347e7fbf?source=collection_archive---------14-----------------------#2022-12-20">https://levelup.gitconnected.com/how-to-build-an-npm-package-4158347e7fbf?source=collection_archive---------14-----------------------#2022-12-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1426" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从创建我的第一个Javascript包中学到的经验</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/faf0ee16e5f201aab49af5adc38b2de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*3dflltxefAAYTYQVxIj5FQ.png"/></div></div></figure><p id="78d3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">作为开发人员，我们总是试图找出如何使我们的解决方案可扩展和可重用。我们讨厌一遍又一遍地重写相同的代码。在最高产量和自动化之间游走需要做大量的工作。有时，很明显，解决方案可以从当前项目之外抽象出来，直接从第三方引入。我想分享一个最近的解决方案，它非常合理地创建了一个NPM包，并直接在我们的应用程序中使用该解决方案。到目前为止，我从未创建过NPM包，所以我希望在这篇文章中分享我的经验会有所帮助。</p><h2 id="3654" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">为什么要构建NPM包？</h2><p id="2ad9" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我们可以直接在我们构建的应用程序中编写解决方案，这就足够了。但是伟大的解决方案减少了重复，并且遵循了实现<a class="ae ml" href="https://www.digitalocean.com/community/tutorials/what-is-dry-development" rel="noopener ugc nofollow" target="_blank">干</a>代码所必需的代码模式。</p><p id="9a02" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如“<a class="ae ml" href="https://pragprog.com/titles/tpp20/the-pragmatic-programmer-20th-anniversary-edition/" rel="noopener ugc nofollow" target="_blank">务实的程序员</a>所说:</p><blockquote class="mm mn mo"><p id="4a8c" class="kr ks mp kt b ku kv jr kw kx ky ju kz mq lb lc ld mr lf lg lh ms lj lk ll lm ij bi translated">每一项知识都必须在系统中有一个单一的、明确的、权威的表示。</p></blockquote><p id="feda" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有时，我们可以在应用程序之外创建一个明确的解决方案，并将模块放入应用程序中以达到目的。这对开发人员来说是一个很好的练习，也是对编程社区的回馈，因为您的解决方案可能会解决其他人的问题。编写一个可以在任何地方使用的解决方案迫使开发人员明确地解决问题；仅此一点对我来说就是一个卖点。我不是说每个解决方案都应该变成一个包，但是我们应该在需要的时候配备工具和技术。</p><p id="2ce9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，我不会涉及所有的细节，但是我认为对创建和使用你的第一个NPM包的必要步骤做一个高层次的概述是有帮助的。</p><h1 id="ef75" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">如何建立一个NPM包？</h1><p id="2d77" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">这些是我创建第一个NPM包的步骤。T9】</p><h1 id="195b" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">第一步:向NPM注册</h1><p id="5fb8" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">这一步是发布准备好的包所必需的。我可以带你看一下这一部分，但是NPM已经有了很好的心流文档:</p><div class="ne nf gp gr ng nh"><a href="https://docs.npmjs.com/getting-started" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">开始| npm文档</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">国家预防机制登记册、网站和命令行界面的文件</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">docs.npmjs.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv kp nh"/></div></div></a></div><p id="bbc3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦完成，我们就可以进入有趣的部分了。</p><h1 id="7cd2" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">第二步:有一个要解决的问题或想法</h1><p id="9185" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我工作的应用程序有一个双因素登录流程。登录流程的最后一步是为用户提供一次性密码输入。第一次迭代使用了一个尽可能美观的数字输入。尽管如此，我们的设计者想要一个输入，将每个数字的输入分成六个独立的输入。下面是一些图片，让它更简单明了:</p><h2 id="b55c" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">原始输入</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a14f549f88f1a8dac2b5901fbd738800.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/1*hD6Bh8v5oCVbLZj9kGOcyA.gif"/></div></figure><h2 id="46a5" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">由我的NPM包创建的输入</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/7cbe68de7302361554e442b9928e1a22.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/1*RX_8HYkK2xRKCY3hn7a8kA.gif"/></div></figure><p id="3902" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从头开始构建这个输入很有挑战性，但是当我开始这个过程时，我很快意识到这个解决方案作为一个可重用的模块是有意义的，它应该作为一个NPM包存在。这种输入需要相当多的Javascript来处理边缘情况，并确保用户在输入时有流畅的体验。下面是我如何创建我的第一个NPM包<a class="ae ml" href="https://github.com/cameronbass/honeycrisp" rel="noopener ugc nofollow" target="_blank"> Honeycrisp </a>。</p><p id="0a55" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="mp">注:</em> </strong> <em class="mp">你可以在这里演示我创建的包-&gt;</em><a class="ae ml" href="https://codepen.io/cambass23/pen/wvxwJKY" rel="noopener ugc nofollow" target="_blank"><em class="mp">Codepen</em></a></p><h1 id="4173" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">步骤3:创建“package.json”文件</h1><p id="1ce6" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">创建<code class="fe ny nz oa ob b">package.json</code>文件最简单的方法是从项目根目录运行<code class="fe ny nz oa ob b">npm init</code>命令:</p><pre class="kg kh ki kj gt oc ob od bn oe of bi"><span id="b656" class="og lo iq ob b be oh oi l oj ok">&gt; mkdir path-to-project/honeycrisp<br/>&gt; cd path-to-project/honeycrisp<br/>&gt; npm init </span></pre><p id="6a13" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ny nz oa ob b">npm init</code>将引导您完成定义package.json文件的选项。以下是我运行npm init后的结果:</p><pre class="kg kh ki kj gt oc ob od bn oe of bi"><span id="3759" class="og lo iq ob b be oh oi l oj ok">{<br/>  "name": "honeycrisp",<br/>  "version": "1.0.0",<br/>  "description": "A crispy input",<br/>  "main": "app.js",<br/>  "scripts": {<br/>    "test": "test"<br/>  },<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="42e6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里的兴趣点是<code class="fe ny nz oa ob b">main</code>字段。正如NPM医生描述的那样:</p><blockquote class="mm mn mo"><p id="013b" class="kr ks mp kt b ku kv jr kw kx ky ju kz mq lb lc ld mr lf lg lh ms lj lk ll lm ij bi translated">“main”字段是一个模块ID，它是程序的主要入口点。也就是说，如果你的包被命名为<code class="fe ny nz oa ob b">foo</code>，一个用户安装了它，然后执行<code class="fe ny nz oa ob b">require("foo")</code>，那么你的主模块的导出对象将被返回。</p></blockquote><p id="1557" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上面的<code class="fe ny nz oa ob b">package.json</code>文件是所需的package.json文件的最简单版本。还有相当多的字段可以用来定义您的项目。在这里查阅官方文件很有帮助—</p><h2 id="67fb" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">Package.json文档:</h2><div class="ne nf gp gr ng nh"><a href="https://docs.npmjs.com/cli/v7/configuring-npm/package-json" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">package.json | npm文档</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">关于package.json文件中需要的内容，您只需要知道这个文档。它必须是实际的JSON，而不仅仅是…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">docs.npmjs.com</p></div></div><div class="nq l"><div class="ol l ns nt nu nq nv kp nh"/></div></div></a></div><h1 id="f611" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">步骤4:编写入口点文件:</h1><p id="1f86" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我用名字<code class="fe ny nz oa ob b">app.js</code>作为我的主文件。为了本教程的简单，我将所有代码保存在一个文件中。理解这段代码的所有内容并不重要。我只是想分享这个演示的目的。</p><p id="395d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="mp">这是创建上面演示的输入所需的所有代码。这个项目仍在积极更新，因为有大量的升级要做。最新版本可以随意咨询GitHub上的包:</em><a class="ae ml" href="https://github.com/cameronbass/honeycrisp" rel="noopener ugc nofollow" target="_blank"><em class="mp">GitHub上的honey crisp</em></a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="4564" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">写完这个文件后，我在package.json文件中更新了我的版本，并测试了我的解决方案。</p><h1 id="606e" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">第五步:用NPM包测试你的包</h1><p id="b2e1" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated"><code class="fe ny nz oa ob b">NPM Pack</code>是一个不用发布就能测试你的包的优秀工具。NPM使用<a class="ae ml" href="https://semver.org/" rel="noopener ugc nofollow" target="_blank">语义版本化</a>，而不是每次你想测试一个变化就发布一个新版本到NPM，你可以创建一个TAR文件，保存在本地，并针对你正在应用它的应用程序进行测试。</p><p id="5d12" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="mp">如何使用</em></strong><code class="fe ny nz oa ob b"><strong class="kt ir"><em class="mp">npm pack</em></strong></code><strong class="kt ir"><em class="mp">—</em></strong></p><p id="3a18" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，将package.json文件更新到新版本。版本是任意的，但是你应该对流程有逻辑。我的现在是这样的:</p><pre class="kg kh ki kj gt oc ob od bn oe of bi"><span id="a810" class="og lo iq ob b be oh oi l oj ok">{<br/>  "name": "honeycrisp",<br/>  "version": "1.0.1", // &lt;- update version<br/>  "description": "A crispy input",<br/>  "main": "app.js",<br/>  "scripts": {<br/>    "test": "test"<br/>  },<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="e0a7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">其次，从项目的根目录下，运行NPM打包命令:</p><pre class="kg kh ki kj gt oc ob od bn oe of bi"><span id="eed1" class="og lo iq ob b be oh oi l oj ok">&gt; npm pack<br/><br/>npm notice<br/>npm notice 📦  honeycrisp@1.0.1<br/>npm notice === Tarball Contents ===<br/>npm notice 173B package.json<br/>npm notice === Tarball Details ===<br/>npm notice name:          honeycrisp<br/>npm notice version:       1.0.1<br/>npm notice filename:      test-1.0.1.tgz<br/>npm notice package size:  204 B<br/>npm notice unpacked size: 173 B<br/>npm notice shasum:        2c069041cc1d121d0a0a0286b60fe86e80b5a<br/>npm notice integrity:     sha512-X6RzbgcmgYeb/[...]gQoUMy2H3QyiA==<br/>npm notice total files:   1<br/>npm notice<br/>test-1.0.0.tgz</span></pre><p id="b23d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第三，将文件复制到计算机的根目录:</p><pre class="kg kh ki kj gt oc ob od bn oe of bi"><span id="dd8c" class="og lo iq ob b be oh oi l oj ok">cp honeycrisp-1.0.1.tgz</span></pre><p id="db2b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，从您正在使用的应用程序的根目录，安装软件包的本地版本:</p><pre class="kg kh ki kj gt oc ob od bn oe of bi"><span id="d198" class="og lo iq ob b be oh oi l oj ok">&gt; cd path/to/application<br/>&gt; npm install ~/honeycrisp-1.0.1.tgz</span></pre><p id="9d01" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，您可以在预期的应用程序中测试您的更改。如果有些东西不能正常工作，对你的包进行修改，修改版本并再次运行<code class="fe ny nz oa ob b">npm pack</code>。</p><p id="f2ef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是NPM包的一些附加文档:</p><div class="ne nf gp gr ng nh"><a href="https://docs.npmjs.com/cli/v7/commands/npm-pack" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">npm-pack | npm文档</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">表示您不希望npm进行任何更改，并且它应该只报告它本来会做的事情。这可以…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">docs.npmjs.com</p></div></div><div class="nq l"><div class="oo l ns nt nu nq nv kp nh"/></div></div></a></div><h1 id="446b" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">步骤6:发布您的包</h1><p id="3473" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在您对您的包的实现感到满意之后。进行过程中最令人满意的一步，出版！</p><p id="d226" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从项目运行的根目录开始:</p><pre class="kg kh ki kj gt oc ob od bn oe of bi"><span id="db5d" class="og lo iq ob b be oh oi l oj ok">&gt; npm publish</span></pre><p id="ce6a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该命令将创建一个TAR文件，NPM会自动将它推送到一个公共注册中心。您的软件包现在可以被您和任何有权限访问NPM的人使用！</p><h1 id="acc8" class="mt lo iq bd lp mu mv mw ls mx my mz lv jw na jx ly jz nb ka mb kc nc kd me nd bi translated">总结一下—</h1><p id="33cf" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">希望这可以作为构建您的第一个NPM包的一个有用的演练。NPM做了一件很棒的工作，让你卸下了繁重的工作，让你专注于项目的技术细节。</p><h2 id="f98a" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">完成软件包的第一个版本后的其他注意事项:</h2><ol class=""><li id="0acc" class="op oq iq kt b ku mg kx mh la or le os li ot lm ou ov ow ox bi translated">在你的自述里做一段精彩的自述。解释如何使用这个包，以及为什么开发者应该使用你的包。</li><li id="32c9" class="op oq iq kt b ku oy kx oz la pa le pb li pc lm ou ov ow ox bi translated">我们的解决方案需要随着时间的推移而改变。定义贡献准则，以便社区可以帮助您改进实施。</li><li id="3bd1" class="op oq iq kt b ku oy kx oz la pa le pb li pc lm ou ov ow ox bi translated">推广一下！</li></ol><h2 id="2769" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">看看我的第一个包Honeycrisp</h2><p id="05d7" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">这是我的NPM套餐的链接:<a class="ae ml" href="https://github.com/cameronbass/honeycrisp" rel="noopener ugc nofollow" target="_blank"> Honeycrisp </a></p><p id="a5d3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">随着时间的推移，我计划做大量的更新。就目前的情况来看，它非常简单，所以用它作为开始项目的例子可能会很好。当然，我也喜欢反馈或贡献。</p></div></div>    
</body>
</html>