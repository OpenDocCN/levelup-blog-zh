<html>
<head>
<title>Simple URL shortener app in Python for Beginners (🔥 FastAPI Demo)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的简单URL shortener应用程序，适合初学者(🔥FastAPI演示)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/simple-url-shortener-app-in-python-for-beginners-fastapi-demo-7978049f3532?source=collection_archive---------3-----------------------#2022-06-15">https://levelup.gitconnected.com/simple-url-shortener-app-in-python-for-beginners-fastapi-demo-7978049f3532?source=collection_archive---------3-----------------------#2022-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5f4aa9cf4942c3545e4b2c18b1810f4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qVs2NtMgaiY0sIWcXNEITQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">fastapi-url-shortener-app</figcaption></figure><h1 id="8d28" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">介绍</h1><p id="f232" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">这是一个用Python FastAPI开发的简单的url缩写应用程序。<br/> <a class="ae ly" href="https://github.com/rahul-yr/learn-fastapi-simple-url-shortner" rel="noopener ugc nofollow" target="_blank">点击此处</a>进入Github repo。<br/> <a class="ae ly" href="https://www.postman.com/rahul-public/workspace/fastapi-simple-url-shortner-crud/collection/8974578-e4dd76aa-0334-47c3-ba64-c84e27ff58f6" rel="noopener ugc nofollow" target="_blank">点击此处</a>访问Postman API集合。</p><p id="10a3" class="pw-post-body-paragraph la lb iq lc b ld lz lf lg lh ma lj lk ll mb ln lo lp mc lr ls lt md lv lw lx ij bi translated">在本教程中，我们将主要关注3件事</p><ul class=""><li id="0f71" class="me mf iq lc b ld lz lh ma ll mg lp mh lt mi lx mj mk ml mm bi translated">它是初学者友好的。</li><li id="a5d2" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">专注于行业最佳实践。</li><li id="af00" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">部署到云。</li></ul><p id="294c" class="pw-post-body-paragraph la lb iq lc b ld lz lf lg lh ma lj lk ll mb ln lo lp mc lr ls lt md lv lw lx ij bi translated">本教程的范围主要集中在构建API上，而不是Python基础。如果你对Python完全陌生，我强烈建议你在阅读本文之前，对Python的基础知识有一个很好的了解。</p><h1 id="8f07" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">先决条件</h1><ul class=""><li id="0fba" class="me mf iq lc b ld le lh li ll ms lp mt lt mu lx mj mk ml mm bi translated">从<a class="ae ly" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank">这里</a>下载并安装VS代码</li><li id="d399" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">从<a class="ae ly" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">这里</a>下载并安装Python</li></ul><h2 id="18a4" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">什么是虚拟环境？</h2><p id="1e97" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">虚拟环境是一个隔离的环境，用于保持您的项目依赖关系独立于任何其他项目或系统配置。这有助于避免不同版本之间的依赖冲突。</p><h1 id="d368" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">现场演示</h1><p id="3dff" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">点击此处测试<a class="ae ly" href="https://learn-fastapi-url-shortener.herokuapp.com/url-shortener/list" rel="noopener ugc nofollow" target="_blank">实时端点</a></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h1 id="db45" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">开发URL缩写API</h1><h2 id="9eb3" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">设置</h2><ul class=""><li id="89e6" class="me mf iq lc b ld le lh li ll ms lp mt lt mu lx mj mk ml mm bi translated">打开VS代码，在根文件夹中创建一个名为<code class="fe nn no np nq b">main.py</code>的新文件。</li><li id="881f" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">这个<code class="fe nn no np nq b">main.py</code>文件负责运行您的应用程序，并作为应用程序的入口点。</li><li id="f8a5" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">使用这个命令<code class="fe nn no np nq b">python -m venv virtual_env_name</code>创建一个Python虚拟环境</li><li id="f0f0" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">使用各自的操作系统命令激活您的虚拟环境。</li></ul><pre class="nh ni nj nk gt nr nq ns nt aw nu bi"><span id="9630" class="mv kd iq nq b gy nv nw l nx ny"># Linux<br/>source virtual_env_name/bin/activate</span><span id="462b" class="mv kd iq nq b gy nz nw l nx ny"># Windows<br/>virtual_env_name\Scripts\activate.bat</span><span id="7b30" class="mv kd iq nq b gy nz nw l nx ny">#Mac<br/>source virtual_env_name/bin/activate</span></pre><ul class=""><li id="e21a" class="me mf iq lc b ld lz lh ma ll mg lp mh lt mi lx mj mk ml mm bi translated">在Python虚拟环境中安装所有必需的依赖项。</li></ul><pre class="nh ni nj nk gt nr nq ns nt aw nu bi"><span id="3a8d" class="mv kd iq nq b gy nv nw l nx ny"># add fast api package<br/>pip install fastapi</span><span id="c131" class="mv kd iq nq b gy nz nw l nx ny"># add web server for running fast api<br/>pip install "uvicorn[standard]"</span><span id="018a" class="mv kd iq nq b gy nz nw l nx ny"># add package for cleaning cache files<br/>pip install pyclean</span></pre><p id="cbbb" class="pw-post-body-paragraph la lb iq lc b ld lz lf lg lh ma lj lk ll mb ln lo lp mc lr ls lt md lv lw lx ij bi translated">将下面的代码片段添加到<code class="fe nn no np nq b">main.py</code>文件中。这个代码片段有两个GET请求方法类型的端点。一个端点返回<code class="fe nn no np nq b">{"hello" : "world"}</code> json响应，另一个返回您作为<code class="fe nn no np nq b">item_id</code>传递的动态参数</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="oa nm l"/></div></figure><ul class=""><li id="278a" class="me mf iq lc b ld lz lh ma ll mg lp mh lt mi lx mj mk ml mm bi translated">使用下面的命令运行应用程序。默认的主机url是<code class="fe nn no np nq b"><a class="ae ly" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank">http://localhost:8000</a></code></li></ul><pre class="nh ni nj nk gt nr nq ns nt aw nu bi"><span id="0722" class="mv kd iq nq b gy nv nw l nx ny">uvicorn main:app --reload</span></pre><p id="f99b" class="pw-post-body-paragraph la lb iq lc b ld lz lf lg lh ma lj lk ll mb ln lo lp mc lr ls lt md lv lw lx ij bi translated">打开默认端点，如果您看到类似这样的内容，那么您已经成功地🔥在本地部署您的应用程序。</p><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/4c5d74328bfa2fa98a91f0c46acff923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*8R_Ayt9JXErcmA-W2oKWsw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">示例-fast API-端点</figcaption></figure><ul class=""><li id="a9e8" class="me mf iq lc b ld lz lh ma ll mg lp mh lt mi lx mj mk ml mm bi translated">与GET方法类似，您可以定义您需要的任何支持的请求方法。</li><li id="9297" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">删除您添加的两个方法，即<code class="fe nn no np nq b">read_root</code>、<code class="fe nn no np nq b">read_item</code>，现在是实现真正的url缩短端点的时候了。</li></ul><h2 id="5f51" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">创建URL缩写端点。</h2><ul class=""><li id="ba28" class="me mf iq lc b ld le lh li ll ms lp mt lt mu lx mj mk ml mm bi translated">在根文件夹中创建以下文件和目录。</li></ul><pre class="nh ni nj nk gt nr nq ns nt aw nu bi"><span id="b51b" class="mv kd iq nq b gy nv nw l nx ny"># folder : <br/>url_shortener</span><span id="5c2e" class="mv kd iq nq b gy nz nw l nx ny"># files<br/>url_shortener/__init__.py<br/>url_shortener/database.py<br/>url_shortener/router.py<br/>url_shortener/models.py</span></pre><ul class=""><li id="1225" class="me mf iq lc b ld lz lh ma ll mg lp mh lt mi lx mj mk ml mm bi translated"><code class="fe nn no np nq b">__init__.py</code> file用于将当前文件夹表示为一个包。以便它可以在其他包中被引用。</li><li id="73a0" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated"><code class="fe nn no np nq b">router.py</code>文件负责处理url捷径路由。</li><li id="3503" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated"><code class="fe nn no np nq b">models.py</code>是一个通用文件，用于定义所有必要的url缩写模型。</li><li id="607a" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated"><code class="fe nn no np nq b">database.py</code>文件负责处理数据库操作。由于互联网上有数百种数据库选项，为了简单起见，这里我们用sleep命令模拟数据库操作，并将数据存储在内存变量中。</li></ul><h2 id="7efc" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">定义模型</h2><ul class=""><li id="0f04" class="me mf iq lc b ld le lh li ll ms lp mt lt mu lx mj mk ml mm bi translated">下面是<code class="fe nn no np nq b">models.py</code>的片段。正如您在代码中看到的，它有两个模型。</li><li id="ae16" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated"><code class="fe nn no np nq b">CreateUrlShortener</code>模型负责验证短URL的创建。</li><li id="8073" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated"><code class="fe nn no np nq b">CreateUrlShortenerResponse</code>模型被用作json响应模型。</li></ul><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="oa nm l"/></div></figure><h2 id="4652" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">定义数据库操作</h2><ul class=""><li id="4dc8" class="me mf iq lc b ld le lh li ll ms lp mt lt mu lx mj mk ml mm bi translated">下面是<code class="fe nn no np nq b">database.py</code>文件的代码片段。它有一个成员变量<code class="fe nn no np nq b">all_data</code>，将所有数据存储在内存中。在这里，您可以定义各自的数据库实例，而不是<code class="fe nn no np nq b">in memory</code>变量。以及它有3个功能，创建一个短网址，删除一个短网址和获取所有的短网址。</li><li id="3a95" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">这个代码片段有定义明确的注释，可以帮助您详细理解逻辑。</li></ul><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="oa nm l"/></div></figure><h2 id="b363" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">创建端点</h2><ul class=""><li id="2d18" class="me mf iq lc b ld le lh li ll ms lp mt lt mu lx mj mk ml mm bi translated">下面是<code class="fe nn no np nq b">router.py</code>文件的代码片段。</li><li id="7821" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">在这里，我们定义了一个名为<code class="fe nn no np nq b">url_shortener</code>的api路由器和一个名为<code class="fe nn no np nq b">mock_db_operations</code>的数据库实例。</li><li id="6641" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated"><code class="fe nn no np nq b">url_shortener</code>用于将这些端点安装到主路由器上。</li><li id="d8a3" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated"><code class="fe nn no np nq b">mock_db_operations</code>用于执行数据库操作。</li><li id="761c" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">它为创建、删除、列出端点定义了3个方法，为测试url重定向定义了1个方法。使用行内注释来详细理解逻辑。</li></ul><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="oa nm l"/></div></figure><h2 id="7019" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">更新主文件</h2><ul class=""><li id="15ed" class="me mf iq lc b ld le lh li ll ms lp mt lt mu lx mj mk ml mm bi translated">下面是安装了url路由器的<code class="fe nn no np nq b">main.py</code>文件片段，即<code class="fe nn no np nq b">url_shortener</code>。</li></ul><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="oa nm l"/></div></figure><h1 id="87a6" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用以下命令在本地运行应用程序</h1><pre class="nh ni nj nk gt nr nq ns nt aw nu bi"><span id="9331" class="mv kd iq nq b gy nv nw l nx ny">uvicorn main:app --reload</span></pre><ul class=""><li id="efd8" class="me mf iq lc b ld lz lh ma ll mg lp mh lt mi lx mj mk ml mm bi translated">使用<a class="ae ly" href="https://www.postman.com/rahul-public/workspace/fastapi-simple-url-shortner-crud/collection/8974578-e4dd76aa-0334-47c3-ba64-c84e27ff58f6" rel="noopener ugc nofollow" target="_blank">这个postman集合</a>作为API规范并测试端点。</li><li id="149b" class="me mf iq lc b ld mn lh mo ll mp lp mq lt mr lx mj mk ml mm bi translated">下面是使用Postman的API请求和响应的一些快照。</li></ul><h2 id="2a32" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">创建URL缩写快照</h2><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/e24327414506f219815c43a0529c489f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*58xL1Wm0AGkyy0EkbRI1bg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建短网址</figcaption></figure><h2 id="7d65" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">列出所有短URL</h2><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/89c63785e17bb4757d4f4edf1ea1d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TyoZsFiU7FFMYl0SJNx2vw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">列表-短网址</figcaption></figure><h2 id="f3f5" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">实际测试重定向</h2><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/40795067befd44aa5442ee9031f5d27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ISSZj_fh1VlWHPqV2bP6Pg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">测试-重定向-URL</figcaption></figure><h2 id="b46f" class="mv kd iq bd ke mw mx dn ki my mz dp km ll na nb kq lp nc nd ku lt ne nf ky ng bi translated">删除短网址</h2><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/44a11282051ff17d61373efcb3048906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*grj0DoFy6VbUrP0E6-EsKA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">删除短网址</figcaption></figure><h1 id="a49b" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">部署到云</h1><p id="99a7" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">知道如何将这个回购部署到Heroku吗？<a class="ae ly" href="https://blog.devgenius.io/how-to-deploy-any-backend-to-heroku-easily-3194d48dd810" rel="noopener ugc nofollow" target="_blank">点击这里找到正确的方法</a></p><h1 id="53ec" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">摘要</h1><p id="0f76" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">可怕的🔥，您已经成功完成了本教程。我会💝听听你的反馈和意见，看看你能用它做些什么。如果你被困在某个地方，请随意评论。我随时都有空。</p><p id="8b6f" class="pw-post-body-paragraph la lb iq lc b ld lz lf lg lh ma lj lk ll mb ln lo lp mc lr ls lt md lv lw lx ij bi translated">请在<a class="ae ly" href="https://github.com/rahul-yr/learn-fastapi-simple-url-shortner" rel="noopener ugc nofollow" target="_blank"> github </a>找到完整的代码</p></div><div class="ab cl og oh hu oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="ij ik il im in"><h1 id="f7d6" class="kc kd iq bd ke kf on kh ki kj oo kl km kn op kp kq kr oq kt ku kv or kx ky kz bi translated">分级编码</h1><p id="b80e" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">感谢您成为我们社区的一员！更多内容请参见<a class="ae ly" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>。<br/>跟随:<a class="ae ly" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a>，<a class="ae ly" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">领英</a>，<a class="ae ly" href="https://newsletter.levelup.dev/" rel="noopener ugc nofollow" target="_blank">通迅</a> <br/> <strong class="lc ir">升一级正在改造理工大招聘➡️ </strong> <a class="ae ly" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir">加入我们的人才集体</strong> </a></p></div></div>    
</body>
</html>