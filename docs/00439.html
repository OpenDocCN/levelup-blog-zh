<html>
<head>
<title>A no-nonsense guide to environment variables in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Go中环境变量的实用指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-no-nonsense-guide-to-environment-variables-in-go-55d7661f09b0?source=collection_archive---------0-----------------------#2019-03-02">https://levelup.gitconnected.com/a-no-nonsense-guide-to-environment-variables-in-go-55d7661f09b0?source=collection_archive---------0-----------------------#2019-03-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="67b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">环境变量是为软件应用程序设置配置值的最佳方式，因为它们可以在系统级定义，与软件无关。这是<a class="ae kl" href="https://12factor.net/config" rel="noopener ugc nofollow" target="_blank">十二因素应用</a>方法学的原则之一，它使应用程序的构建具有可移植性。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/bd0392d0c1bea91a84f7998dc15b86d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tDU_1Y2x7eLGX9hQQHbTAg.png"/></div></figure><h1 id="c35f" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">使用环境变量</h1><p id="e0f8" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">在Go中使用与环境变量交互所需要的只是标准的<code class="fe lx ly lz ma b"><a class="ae kl" href="https://golang.org/pkg/os/" rel="noopener ugc nofollow" target="_blank">os</a></code>包。下面是访问环境变量<code class="fe lx ly lz ma b">PATH</code>的方法。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="c241" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设置环境变量同样简单:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><h2 id="ed1d" class="md kv iq bd kw me mf dn la mg mh dp le jy mi mj li kc mk ml lm kg mm mn lq mo bi translated">从. env文件加载环境变量</h2><p id="e0cf" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">在运行多个项目的开发机器上设置环境变量并不总是可行的。</p><p id="6fdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/joho/godotenv" rel="noopener ugc nofollow" target="_blank"> godotenv </a>是Ruby <a class="ae kl" href="https://github.com/bkeepers/dotenv" rel="noopener ugc nofollow" target="_blank"> dotenv </a>库的一个Go端口。这允许您在一个<code class="fe lx ly lz ma b">.env</code>文件中定义应用程序的环境变量。</p><p id="8abc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要安装软件包，请运行:</p><pre class="kn ko kp kq gt mp ma mq mr aw ms bi"><span id="1de3" class="md kv iq ma b gy mt mu l mv mw">$ go get github.com/joho/godotenv</span></pre><p id="99c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将您的配置值添加到项目根目录下的<code class="fe lx ly lz ma b">.env</code>文件中:</p><pre class="kn ko kp kq gt mp ma mq mr aw ms bi"><span id="6382" class="md kv iq ma b gy mt mu l mv mw">GITHUB_USERNAME=craicoverflow<br/>GITHUB_API_KEY=TCtQrZizM1xeo1v92lsVfLOHDsF7TfT5lMvwSno</span></pre><p id="fa60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，您可以在应用程序中使用这些值:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="27ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">需要注意的是，如果系统中已经定义了一个环境变量，那么Go将使用这个变量而不是<code class="fe lx ly lz ma b">.env</code>中的值。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="3fa9" class="ku kv iq bd kw kx ne kz la lb nf ld le lf ng lh li lj nh ll lm ln ni lp lq lr bi translated">将环境变量包装在配置包中</h1><p id="7fdc" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">直接访问环境变量很好，但是现在不太容易维护，不是吗？每个值都是一个字符串，想象一下当环境键被修改时必须更新每个引用！</p><p id="1d6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了解决这个问题，让我们创建一个配置包，以更加集中和可维护的方式访问环境变量。</p><p id="a7ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个简单的<code class="fe lx ly lz ma b">config</code>包，它将在一个<code class="fe lx ly lz ma b">Config</code>结构中返回配置值。我们可以选择定义一个缺省值，所以当一个环境变量不存在时，将使用这个缺省值。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><ol class=""><li id="1582" class="nj nk iq jp b jq jr ju jv jy nl kc nm kg nn kk no np nq nr bi translated">接下来，我们应该向“配置结构”添加不同的类型。当前的实现只能处理<code class="fe lx ly lz ma b">string</code>类型，这对于较大的应用程序来说不太实用。</li></ol></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="ec9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们添加处理<code class="fe lx ly lz ma b">bool</code>、<code class="fe lx ly lz ma b">slice</code>和<code class="fe lx ly lz ma b">integer</code>类型的函数。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="d1fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用这些环境变量更新您的<code class="fe lx ly lz ma b">.env</code>文件。</p><pre class="kn ko kp kq gt mp ma mq mr aw ms bi"><span id="fc9f" class="md kv iq ma b gy mt mu l mv mw">GITHUB_USERNAME=craicoverflow<br/>GITHUB_API_KEY=TCtQrZizM1xeo1v92lsVfLOHDsF7TfT5lMvwSno<br/>MAX_USERS=10<br/>USER_ROLES=admin,super_admin,guest<br/>DEBUG_MODE=false</span></pre><p id="9cf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您可以从应用程序的其余部分访问这些值:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><h1 id="b6ee" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">现在你知道了</h1><p id="41fc" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">有几个库声称可以为您的Go应用程序提供配置“解决方案”。但是，当你自己也很容易做出一个解决方案时，这真的是一个解决方案吗？</p><p id="2e97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您如何管理Go应用程序中的配置？</p><p id="2d3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你喜欢这篇文章吗？请务必在<a class="ae kl" href="https://endaphelan.me" rel="noopener ugc nofollow" target="_blank"> https://endaphelan.me </a>查看更多类似内容。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><figure class="kn ko kp kq gt kr gh gi paragraph-image"><a href="https://levelup.gitconnected.com"><div class="gh gi ns"><img src="../Images/ff5028ba5a0041d2d76d2a155f00f05e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JaoZbi7tTKJ5vL7i2OAYMQ.png"/></div></a></figure><div class="nt nu gp gr nv nw"><a href="https://gitconnected.com/learn/golang" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">学习围棋-最佳围棋教程(2019) | gitconnected</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">23大围棋教程-免费学习围棋。课程由开发者提交和投票，使您能够找到…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">gitconnected.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div></div></div>    
</body>
</html>