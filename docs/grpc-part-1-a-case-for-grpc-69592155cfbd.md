# gRPC 的一个案例

> 原文：<https://levelup.gitconnected.com/grpc-part-1-a-case-for-grpc-69592155cfbd>

![](img/7265090bb41ffe8fc946dae8bf152dfe.png)

图片由 Renee French 提供

## GRPC:第一部分

## gRPC 将继续存在，这就是原因。

从 REST/HTTP 1.x 到 gRPC 的服务间通信点的*进度方向箭头*，这是从 Josh Wolfe 借用的术语，我希望在本系列中向您展示为什么。以下大部分评测是由 Kasun Indrasiri 和 Danesh Kuruppu 编写的 *gRPC Up & Running* 的总结。您将会看到，gRPC 克服了 REST 的许多缺点，并且通过对 gRPC 进行少量扩展，REST 的一些优点也变得可用。

# 休息

代表性状态转移(REST)是 Roy Fielding 博士论文提出的一组最佳实践。它是一种架构风格，提供了通过 HTTP 动词改变资源状态的最佳实践。例如，维护**人员**资源的服务通常会支持以下 API 来改变人员**的状态。**

*   **岗位**/人员
    /创建一个新人
*   **PUT /** person
    >更新现有人员
*   **GET/**person/:id
    >检索人员
*   **删除/** 人员/:id
    >删除一个人员

## RESTful 服务的优势

1.  人类可读资源
    RESTful 服务在 HTTP 1.x 上运行，这需要发送文本消息。本质上，这种需求使得我们与 RESTful 服务交互变得很熟悉，因为我们可以直观地读写服务存储的资源数据。
2.  **丰富的交互工具** HTTP 1 . x 世界中的工具生态系统是多样的。比如你可以用 cURL、Postman、失眠等与任何 HTTP 1.x 服务进行交互。
3.  RESTful 服务不是强类型的，所以不需要单独的构建步骤来向客户端发布类型。

## RESTful 服务的缺点

1.  低效的基于文本的消息协议 HTTP 1.x 服务，例如 RESTful 服务，需要在客户端和服务器之间发送人类可读的基于文本的消息。对于客户端和服务器之间的每个通信流，服务器必须将二进制转换为人类可读的文本，并发送给客户端，然后客户端必须将文本转换为二进制并继续。这个过程会降低性能。在微服务的世界里，通信流中没有人类。因此，不需要将数据转换为人类可读文本的额外步骤。任何坚持在服务间通信中使用人类可读文本来减轻人类工作的观点都应该用更好的工具来粉碎。
2.  缺乏强类型接口
    RESTful 服务可以通过 Swagger 之类的事后技术广播它们的服务定义。虽然这些技术允许人们阅读服务的模式并根据它进行开发，但它们没有与架构风格和消息协议紧密集成。由于松散耦合的客户机-服务器服务定义，客户机面临着运行时错误的风险。要回答这个问题，“*客户是否了解最新的服务？”变得极其困难。*
3.  REST 仅仅是对最佳实践的一个建议。因此，维护 RESTful 服务很困难。许多原本打算成为 RESTful 的服务失去了对其结构的跟踪，变成了简单地通过 HTTP 1.x 发送文本消息的服务。

# gRPC

2015 年，Google 发布了 gRPC 作为开源的远程过程调用(RPC)框架。这个项目被业界领袖网飞、Square、Lyft、Docker 等采用。并加入了云原生计算基金会。gRPC 旨在克服其前身的许多缺点，并且越来越受欢迎。

## gRPC 的优势

1.  **高效的进程间通信** gRPC 以协议缓冲区的形式在客户端和服务器之间发送数据。整个协议缓冲区事务中的数据保持二进制形式，这消除了 REST 中文本消息转换的开销。此外，这些协议缓冲区是在比 HTTP 1.x 更快的 HTTP/2 之上发送的。协议缓冲区和 HTTP/2 的结合使 gRPC 成为传输数据最快的技术。
2.  **有形成本节约** 随着容器、微服务的广泛采用以及应用程序在公共云中必须达到的运行规模，计算的经济性变得越来越重要。与 HTTP1.x 通信协议相比，gRPC 在 CPU 级别上的[性能提升是非常明显的，可能会节省大量资金。仅此一点可能就足以让市场向 gRPC 靠拢。](https://medium.com/@EmperorRXF/evaluating-performance-of-rest-vs-grpc-1b8bdf0b22da)
3.  **界面优先构建** gRPC 要求界面优先的方法，没有如果和但是！
4.  gRPC 协议缓冲区需要一个强类型的服务定义。这些服务定义被版本化和编码。因此，运行时互操作性错误基本上被消除了。
5.  gRPC 服务定义是语言不可知的，也就是说，一旦你定义了接口，你就可以利用自动代码生成工具以你选择的语言创建客户端和服务器 gRPC 代码。[网飞采用了 gRPC](https://www.cncf.io/case-studies/netflix/) ，将客户端构建时间从数周缩短至数秒，并且提高了一致性。

## gRPC 的缺点

1.  **人类可读问题** 在实践中，会有一些客户因为许多不同的有效原因而无法与 gRPC 服务进行交互。此外，许多生产问题不是由计算机，而是由人来解决的。也就是说，重要的是人类可以与服务进行交互，而他们不能直接通过 gRPC 进行交互。像 grpc-gateway 这样的技术可以解决这个问题。
2.  **一个小的(但正在增长的)生态系统** 随着时间的推移，gRPC 生态系统将大幅增长。然而，如果你现在开发一个 gRPC 服务，你将会看到生态系统的实时发展。支持可能是有限的，Github 问题很多。也就是说，gRPC 经过了世界上最大的公司的大量测试，这表明如果你掌握了 gRPC 知识的基础，开发肯定是可行的。

# 摘要

*   REST 是一种方便的、人类可读的服务间通信方法，这种方法已经变得过时和缓慢。
*   gRPC 是 REST 的后继者，它克服了 REST 的大部分缺点，并且稍加努力就保持了它的优点。

# 延伸阅读…

本文是四篇系列文章中的第一篇，它将带您步入 gRPC 的正轨。点击下面的链接查看本系列的下一篇文章。

[](/grpc-part-2-declaring-a-grpc-service-definition-df9ae0847e4c) [## 声明 gRPC 服务定义

### 服务定义是 gRPC 开发的基础部分，所以让我们从正确的方面开始。

levelup.gitconnected.com](/grpc-part-2-declaring-a-grpc-service-definition-df9ae0847e4c)