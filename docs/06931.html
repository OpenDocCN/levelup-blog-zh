<html>
<head>
<title>Reading and Editing PDF’s Documents Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python阅读和编辑PDF文档</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-work-with-a-pdf-in-python-a1e0c1d127a4?source=collection_archive---------18-----------------------#2021-01-12">https://levelup.gitconnected.com/how-to-work-with-a-pdf-in-python-a1e0c1d127a4?source=collection_archive---------18-----------------------#2021-01-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5b06d87a75fb0ae5424c00cfaf13101e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5XRqcTZR9QEwNuyPYVb3g.jpeg"/></div></div></figure><p id="9d77" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我们将了解如何使用python pdf模块来读取和修改pdf文件。PyPDF2是PyPDF模块的更新版本，支持python版本3及更高版本。我们将通过PyPDF2的每个函数来处理PDF文件。</p><h1 id="c95a" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">安装程序安装:</h1><p id="9c25" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">你可以在保存python模块文件的网站<code class="fe mc md me mf b">PyPI</code>上找到<code class="fe mc md me mf b">PyPdf2</code>模块。当您安装python时，会预先安装一个pip模块。使用下面的命令将在你的系统中安装<code class="fe mc md me mf b">Pypdf2</code>。该命令对于所有操作系统都是相同的。</p><p id="9c57" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe mc md me mf b">pip install PyPDF2</code></p><h1 id="facd" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">正在读取PDF文件:</h1><p id="660d" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">在本节中，我们将学习如何读写pdf文件。首先，我们需要在程序中加载Pypdf2模块。</p><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="7c41" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">第2行显示我们已经在程序中加载了它们<code class="fe mc md me mf b">PyPDF2</code>，然后我们使用python <code class="fe mc md me mf b">open()</code>读取方法读取pdf文件。但是我们做的一个改变是，我们不是在正常模式下读取，而是使用<code class="fe mc md me mf b">rb</code>在字节模式下读取，接下来我们将具有字节形式文件的变量传递给<code class="fe mc md me mf b">PdfFileReader()</code>函数，该函数将读取pdf内容。在下一行，为了验证我们是否成功地读取了pdf文件，我们使用了<code class="fe mc md me mf b">numpages</code>和<code class="fe mc md me mf b"> Pypdf2</code>的方法来计算pdf的页数并返回一个整数。最后，我们关闭pdf文件。</p><p id="8aeb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以使用<code class="fe mc md me mf b">PyPDF2</code>从PDF中提取元数据和一些文本。当您对预先存在的PDF文件执行某些类型的自动化时，这很有用。</p><p id="0341" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">以下是当前可以提取的数据类型:</p><ul class=""><li id="4443" class="mm mn it kd b ke kf ki kj km mo kq mp ku mq ky mr ms mt mu bi translated">作者</li><li id="50e0" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">创造者</li><li id="4329" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">生产者</li><li id="30a2" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">科目</li><li id="8e35" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">标题</li><li id="d2cb" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">页数</li></ul><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h2 id="32c4" class="na la it bd lb nb nc dn lf nd ne dp lj km nf ng ln kq nh ni lr ku nj nk lv nl bi translated">输出:</h2><pre class="mg mh mi mj gt nm mf nn no aw np bi"><span id="04d6" class="na la it mf b gy nq nr l ns nt">    Information about sample.pdf:<br/>    Author: None<br/>    Creator: Rave (<a class="ae nu" href="http://www.nevrona.com/rave" rel="noopener ugc nofollow" target="_blank">http://www.nevrona.com/rave</a>)<br/>    Producer: Nevrona Designs<br/>    Subject: None<br/>    Title: None<br/>    Number of pages: 2</span></pre><h1 id="1ca8" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">从Pdf中提取内容</h1><p id="52af" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">通过使用PyPDF 2，我们可以使用它的提取功能提取任何PDF的内容。检查下面的代码</p><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="6f5f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如你所看到的，我们已经实现了reading方法，我们将调整我们的程序，使用<code class="fe mc md me mf b">extractText()</code>函数提取reading pdf文件的内容，但在此之前，我们通过使用<code class="fe mc md me mf b">getPage()</code> a函数获取特定页面，并将其存储在变量名<code class="fe mc md me mf b">pageObj</code>中，然后调用<code class="fe mc md me mf b">extractText()</code> a方法。检查下面的输入和输出pdf文件。</p><figure class="mg mh mi mj gt ju gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/f544f4653c0d2cc12aebf4ee35bd39d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*J3Va62bxWC2Zxw_hJL3LHA.png"/></div></figure><h2 id="1fc1" class="na la it bd lb nb nc dn lf nd ne dp lj km nf ng ln kq nh ni lr ku nj nk lv nl bi translated">输出:</h2><pre class="mg mh mi mj gt nm mf nn no aw np bi"><span id="9ceb" class="na la it mf b gy nq nr l ns nt">A Simple PDF File This is a small demonstration .pdf file — just for use in the Virtual Mechanics tutorials. More text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. Boring, zzzzz. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. And more text. Even more. Continued on page 2</span></pre><p id="e54e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以通过迭代每个pdf页面并执行相同的第10行和第13行来提取pdf的所有页面。我们需要页面计数，以便我们的循环知道在哪里停止。记住我们在阅读部分看到的方法。我们将使用它来计算pdf页面，然后我们将通过设置<code class="fe mc md me mf b"> i&lt;pagecount</code>来使用while循环，在循环体中我们将第10行和第13行。我们要做的一个简单的改变是将getPage(0)改为getPage(i)。每次迭代值<code class="fe mc md me mf b"> i </code>都会增加1，所以我们可以迭代整个pdf。</p><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h1 id="b080" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">逐页拆分文档:</h1><p id="d706" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">通过使用<code class="fe mc md me mf b">PyPdf2</code>，我们可以一页一页地分割pdf文件。简单来说，我们可以拆分pdf，将每一页存储为一个pdf。检查下面的代码。</p><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="2a10" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们导入了pydf2的读写方法，在下一行中，我们实现了一个函数。其中传递了pdf文件名，在第6行，我们使用getNumPages()根据页数迭代Pdf文件。如果你看到getNumPages()做了与NumPages相同的工作，但是在循环区域中，getNumPages()方法为python范围函数提供了更多的好处。在循环体中，我们设置PdfWriter并在Writer中添加当前迭代页面，然后像在编写部分中一样编写pdf文件。现在，循环将迭代到最后一页，并再次执行所有行。通过这种方式，我们将pdf文档页面分割成多个pdf页面。</p><h1 id="26e6" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">逐页合并文档:</h1><p id="4f8e" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">到目前为止，我们学习了如何分割pdf文档。在本节中，我们将学习如何使用python中的Pypdf2将两个pdf合并成一个pdf。检查下面的代码。</p><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="9bef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你看过这段代码，你会发现这段代码有点类似于分割pdf的代码。有一点小小的变化，我们使用了两个循环，第一个循环将通过逐个读取pdf文档来迭代它们，因为我们传递了一个包含所有pdf文件名称的列表表单变量。在当前的例子中，我传递了2个pdf文件。接下来，在阅读pdf后，我们用pdf writer编写pdf的每一页，在<code class="fe mc md me mf b">line # 13</code>上迭代所有Pdf文档后，我们编写Pdf文件。我们可以把这个过程分成三个步骤</p><ol class=""><li id="a48c" class="mm mn it kd b ke kf ki kj km mo kq mp ku mq ky nw ms mt mu bi translated">逐一阅读pdf</li><li id="1ea2" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky nw ms mt mu bi translated">撰写pdf的每一页</li><li id="dc98" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky nw ms mt mu bi translated">输出pdf文件</li></ol><h1 id="d382" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">旋转PDF:</h1><p id="235d" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated"><code class="fe mc md me mf b">PyPdf 2</code>提供任意角度旋转pdf文档的功能。通过使用<code class="fe mc md me mf b">rotateClockwise</code>方法，我们需要传递一个整数值。如果我们在方法中传递90个数字，就会将pdf文档中的每一页旋转90度。检查下面的代码</p><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h2 id="35b4" class="na la it bd lb nb nc dn lf nd ne dp lj km nf ng ln kq nh ni lr ku nj nk lv nl bi translated">输出:</h2><figure class="mg mh mi mj gt ju gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1752cd1f3ddf591f7b35de187681b03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*xKWJ1ekxgQrjxeJaw3RS3Q.png"/></div></figure><h1 id="bd6d" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">加密PDF文件:</h1><p id="9ea4" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">有时您需要为您的文档增加一些安全性，因为没有人希望与任何人共享重要信息。您可以使用Pypdf2的加密方法为您的pdf文件添加加密。</p><figure class="mg mh mi mj gt ju"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="449e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们做了一个函数名加密，作为参数，我们传递输入文件名、输出文件名和密码，我们希望在我们的文件上设置一个<code class="fe mc md me mf b">line # 10</code>，我们使用了<code class="fe mc md me mf b">encrypt()</code>。如果您查看代码行，我们给出了3个参数user_pass、owner_pass和use_128bit。默认情况下，打开128位加密。如果将其设置为False，则将应用40位加密。</p><h1 id="7334" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">结论:</h1><p id="b665" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">这个<code class="fe mc md me mf b">PyPDF2</code>包非常有用，而且通常很快。您可以使用<code class="fe mc md me mf b">PyPDF2</code> it来自动化大型工作，其功能可以帮助您更好地完成工作！你可以在<a class="ae nu" href="https://pythonhosted.org/PyPDF2/" rel="noopener ugc nofollow" target="_blank"> PyPDF2官网</a>了解更多关于它的功能。</p><p id="bb36" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本教程中，您学习了如何执行以下操作:</p><ul class=""><li id="c733" class="mm mn it kd b ke kf ki kj km mo kq mp ku mq ky mr ms mt mu bi translated">阅读PDF文件</li><li id="43f2" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">从PDF中提取元数据</li><li id="9c44" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">旋转页面</li><li id="9082" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">合并和分割pdf</li><li id="53fe" class="mm mn it kd b ke mv ki mw km mx kq my ku mz ky mr ms mt mu bi translated">添加加密</li></ul><p id="9e9f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">python中还有很多其他的PDF模块。您可以了解它们的功能，并在您的项目或程序中使用它们。希望你觉得这篇文章有用，并随时分享你的回应。</p></div></div>    
</body>
</html>