<html>
<head>
<title>Brython: On replacing JavaScript with Python for front-end development</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Brython:关于用Python代替JavaScript进行前端开发</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/brython-on-replacing-javascript-with-python-for-front-end-development-5baf3064a067?source=collection_archive---------16-----------------------#2020-05-05">https://levelup.gitconnected.com/brython-on-replacing-javascript-with-python-for-front-end-development-5baf3064a067?source=collection_archive---------16-----------------------#2020-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8951" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文最初发布于<code class="fe ko kp kq kr b"><a class="ae ks" href="https://blog.rajivabraham.com/posts/brython" rel="noopener ugc nofollow" target="_blank">https://blog.rajivabraham.com/posts/brython</a></code></p><h1 id="78f5" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">目的。</h1><p id="bdaa" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">这篇博客文章将简要介绍如何使用<a class="ae ks" href="https://brython.info/" rel="noopener ugc nofollow" target="_blank"> Brython </a>，这是一个用于浏览器前端开发的Python实现。</p><p id="e92c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">整个项目在这里是<a class="ae ks" href="https://github.com/RAbraham/brython-blog" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="f9e2" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">介绍</h1><p id="4ef7" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">出于对JavaScript程序员的嫉妒，一群Python程序员秘密开会讨论Python在这个世界末日的未来。JavaScript无处不在，吃着Python的午餐。随着Node.js的出现，JavaScript入侵了Python的领地，结束了它作为继Ruby之后每个人都喜欢的语言的统治地位(那时不是很占优势，对吧？作者先生)。是时候进军JavaScript领域的心脏了:浏览器。</p><h1 id="10e4" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">不要忘记你的历史(和未来)</h1><p id="97f8" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">阴谋集团并不是唯一关心这个困境的绅士。Transcrypt的作者相信毒药和间谍活动。他决定编写一个Python编译器来编译JavaScript代码。像上好的毒药一样，没有蟒蛇的踪迹。看起来很有希望。但是这篇无聊帖子的作者认为他发现了一个错误，但后来发现并非如此。不明智的是，他把Transcrypt放到了一个次要的地方，现在必须把它放在那里。</p><p id="d7b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其他人想从历史中学习。干脆全家移民。至少，<a class="ae ks" href="https://hacks.mozilla.org/2019/04/pyodide-bringing-the-scientific-python-stack-to-the-browser/" rel="noopener ugc nofollow" target="_blank"> Pyodide </a>是这么想的。他们的策略是创建一个附带完整Python解释器的飞地，该解释器可以运行Python代码。因此，您可以运行任何Python代码，包括包含C语言绑定的大部分数据科学堆栈(例如Numpy、Pandas)。</p><p id="0568" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这看起来也很有希望。但是在作者最初的懒惰测试中，最初的页面加载有点慢(真正的原因是作者也找不到一种简单的方法来完成这项工作，并且很高兴不再进一步追求它。)</p><p id="4553" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以阴谋集团决定做每个阴谋集团应该做的事情，即创建另一个Python到JavaScript的编译器，但这一次，在页面加载时将其编译成JavaScript(不像Transcrypt提前编译成JavaScript)。这样，布里逊联谊会就成立了。一条蛇来统治他们。</p><h1 id="322a" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">你好世界</h1><p id="53e0" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">让我们把习惯的“你好，世界”编码起来</p><p id="293a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">布里森伞兵(编译器)在这里。</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="cb05" class="me ku it kr b gy mf mg l mh mi">&lt;script type="text/javascript"<br/>       src="https://cdn.jsdelivr.net/npm/brython@3.8.9/brython.min.js"&gt;<br/>&lt;/script&gt;</span></pre><p id="09b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们在页面加载时激活它</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="eb79" class="me ku it kr b gy mf mg l mh mi">&lt;body onload="brython()"&gt;<br/>...<br/>&lt;/body&gt;</span></pre><p id="f1cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面的<code class="fe ko kp kq kr b">body</code>标签中，我们编写了Brython代码:</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="cf7c" class="me ku it kr b gy mf mg l mh mi">&lt;script type="text/python"&gt;<br/>from browser import document</span><span id="5a1a" class="me ku it kr b gy mj mg l mh mi">document &lt;= "Hello World"<br/>&lt;/script&gt;</span></pre><p id="8e2c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们只是将<code class="fe ko kp kq kr b">Hello World</code>添加到文档元素中。嗯。那很容易。</p><p id="ca06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完整的形式如下所示。</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="fd7e" class="me ku it kr b gy mf mg l mh mi">&lt;!doctype html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;script type="text/javascript"<br/>        src="https://cdn.jsdelivr.net/npm/brython@3.8.8/brython.min.js"&gt;<br/>    &lt;/script&gt;<br/>&lt;/head&gt;</span><span id="df22" class="me ku it kr b gy mj mg l mh mi">&lt;body onload="brython()"&gt;</span><span id="9759" class="me ku it kr b gy mj mg l mh mi">&lt;script type="text/python"&gt;<br/>from browser import document</span><span id="81ff" class="me ku it kr b gy mj mg l mh mi">document &lt;= "Hello World"<br/>&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e85f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将简单地在页面上打印“Hello World”。</p><h1 id="d0dc" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">计算器</h1><p id="ee28" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">现在让我们制作一个计算器(代码提供:Brython)。完整的代码是<a class="ae ks" href="https://github.com/RAbraham/brython-blog/blob/master/calculator.html" rel="noopener ugc nofollow" target="_blank">这里</a></p><figure class="lw lx ly lz gt ml gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/59155864510d8eb3776bab7e97c61b60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*g4hdNnVnZ4RfxpSH.png"/></div></figure><p id="06ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是的，你是对的。我们确实需要一张桌子。我们做一个吧。</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="3b8e" class="me ku it kr b gy mf mg l mh mi">from browser import document, html<br/>calc = html.TABLE()</span></pre><p id="b008" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们只添加第一行。只有显示框(我们将其命名为<code class="fe ko kp kq kr b">result</code>)和<code class="fe ko kp kq kr b">C</code>。</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="419f" class="me ku it kr b gy mf mg l mh mi">calc &lt;= html.TR(html.TH(html.DIV("0", id="result"), colspan=3) +<br/>                html.TD("C"))</span></pre><p id="99e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是的，我也不是很确定这个<code class="fe ko kp kq kr b">&lt;=</code>语法。不过嘿，这么可爱的图书馆，我也将就一下:)。</p><p id="8b29" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们添加数字键盘</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="a024" class="me ku it kr b gy mf mg l mh mi">lines = ["789/", "456*", "123-", "0.=+"]<br/>calc &lt;= (html.TR(html.TD(x) for x in line) for line in lines)</span></pre><p id="abb9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们将<code class="fe ko kp kq kr b">calc</code>添加到<code class="fe ko kp kq kr b">document</code></p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="6c1d" class="me ku it kr b gy mf mg l mh mi">document &lt;= calc</span></pre><p id="45b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在一切都好了。我们如何让它工作？首先，我们需要捕获对<code class="fe ko kp kq kr b">result</code>元素的引用，以便在按下数字键盘时对其进行操作。</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="3eb9" class="me ku it kr b gy mf mg l mh mi">result = document["result"] # direct access to an element by its id</span></pre><p id="c3fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，每当数字键盘中的任何元素被点击时，我们需要更新<code class="fe ko kp kq kr b">result</code>。让我们创建一个事件处理程序。我们相信Brython开发人员的代码是有效的。注意基于您点击的按钮对<code class="fe ko kp kq kr b">result</code>的操作。</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="6524" class="me ku it kr b gy mf mg l mh mi">def action(event):<br/>    """Handles the "click" event on a button of the calculator."""<br/>    # The element the user clicked on is the attribute "target" of the<br/>    # event object<br/>    element = event.target<br/>    # The text printed on the button is the element's "text" attribute<br/>    value = element.text<br/>    if value not in "=C":<br/>        # update the result zone<br/>        if result.text in ["0", "error"]:<br/>            result.text = value<br/>        else:<br/>            result.text = result.text + value<br/>    elif value == "C":<br/>        # reset<br/>        result.text = "0"<br/>    elif value == "=":<br/>        # execute the formula in result zone<br/>        try:<br/>            result.text = eval(result.text)<br/>        except:<br/>            result.text = "error"</span></pre><p id="a145" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们将上面的事件处理程序与所有按钮的<code class="fe ko kp kq kr b">click</code>事件关联起来。</p><pre class="lw lx ly lz gt ma kr mb mc aw md bi"><span id="43aa" class="me ku it kr b gy mf mg l mh mi">for button in document.select("td"):<br/>    button.bind("click", action)</span></pre><p id="ded4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看到了吧，别人写代码是多么容易:p .但是说真的，Brython是工程学的一个奇葩，也许是程序员对他们钟爱的Python语言热爱的最好展示。请支持开发者，至少在他们的Github <a class="ae ks" href="https://github.com/brython-dev/brython" rel="noopener ugc nofollow" target="_blank"> repo </a>上打上一颗星！</p><h1 id="d2eb" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">对于高级读者来说</h1><ul class=""><li id="2e4b" class="mo mp it js b jt lr jx ls kb mq kf mr kj ms kn mt mu mv mw bi translated">也可以集成像Vue.js这样的第三方库，如此处的<a class="ae ks" href="https://brython.info/gallery/test_vue.html" rel="noopener ugc nofollow" target="_blank">所示</a>。</li><li id="0c6e" class="mo mp it js b jt mx jx my kb mz kf na kj nb kn mt mu mv mw bi translated">可以在<a class="ae ks" href="https://anvil.works/blog/python-in-the-browser-talk" rel="noopener ugc nofollow" target="_blank">这里</a>找到对这些概念的深入解释</li></ul></div></div>    
</body>
</html>