<html>
<head>
<title>Getting started with ESLint + development workflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ESLint +开发工作流程入门</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/getting-started-with-eslint-development-workflow-f59165fa9735?source=collection_archive---------2-----------------------#2019-05-23">https://levelup.gitconnected.com/getting-started-with-eslint-development-workflow-f59165fa9735?source=collection_archive---------2-----------------------#2019-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a535b5112c54da4fdfd2ec0ae8fc51ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jFyfsakE2WBv5sFjBQUsuw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">埃斯林，礼貌埃斯林</figcaption></figure><p id="9515" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">什么是ESLint？</strong></p><p id="d4ff" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">它是Javascript的林挺工具。它分析你的代码来执行标准和防止错误。</p><p id="0551" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">ESLint解决了什么问题？</strong></p><p id="f43b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">它基于受JS中一些最佳实践启发的预定义模式，自动识别JS代码中涉及的一些常见错误/挑剔。</p><p id="9453" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">为什么需要使用？</strong></p><p id="b853" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我相信你已经在PR上留下了评论，类似于:</p><blockquote class="la lb lc"><p id="306a" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><em class="iq">“请在此使用ES6字符串文字。”</em></p><p id="49f2" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><em class="iq">“请确保将该变量作为常量使用，因为它在声明后不会被重新赋值。”</em></p><p id="cb69" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><em class="iq">“请在此使用ES6扩展运算符。”</em></p></blockquote><p id="4483" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这样的例子不胜枚举！</p><p id="c57f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">埃斯林特来救援了！这将确保你再也不用担心在公关上留下这样的评论了。很酷，不是吗！</p><p id="1130" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我在这里试图传达的是，ESLint将帮助你在JS代码库期间采用某种编码标准。</p><p id="0a2e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">如何快速上手</strong></p><p id="d8e6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">相信我，在您令人敬畏的代码库中开始使用ESLint比您想象的要容易。是时候让它变得更棒了！</p><p id="3286" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您需要首先安装ESLint:</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="3303" class="lq lr iq lm b gy ls lt l lu lv">npm i --save-dev eslint</span></pre><p id="a8da" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这将保存ESLint作为您的开发依赖项。您只需要为您的开发目的使用ESLint。</p><p id="fb4c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">是时候在你的代码库上运行ESLint来检查到目前为止你可能犯的错误了。</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="a016" class="lq lr iq lm b gy ls lt l lu lv">npx eslint .</span><span id="2f52" class="lq lr iq lm b gy lw lt l lu lv">or</span><span id="e044" class="lq lr iq lm b gy lw lt l lu lv">./node_modules/.bin/eslint .</span></pre><p id="8fdc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以上命令将确保您始终运行安装在您的代码库中的ESLint的本地版本，而不是ESLint的全局安装版本(如果有的话)。</p><p id="92a8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="ld">注意:我将在这篇文章中进一步使用</em> <code class="fe lx ly lz lm b"><em class="ld">npx</em></code> <em class="ld">的做事方式。</em></p><p id="1d25" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在你可能会得到一个错误，</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="190b" class="lq lr iq lm b gy ls lt l lu lv">No ESLint configuration found.</span></pre><p id="6259" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">没有必要惊慌，因为ESLint需要设置一个配置文件来显示它。让我们现在创建一个:</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="73e5" class="lq lr iq lm b gy ls lt l lu lv">npx eslint --init</span></pre><p id="7f21" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这将会问你一些问题，关于你想如何在你的代码库中使用ESLint。我给你抓了一个，</p><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/d58dfd54ae66ac11156507d168f25ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKevey4GRTgYWHeqTHmCIQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ESLint配置生成示例。</figcaption></figure><p id="9bf5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我认为这将适合你的项目，如果你现在不知道你到底想从ESLint得到什么，这绝对是一个好的开始。</p><p id="eaf8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">生成的配置如下所示:</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="2529" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在假设我们有一些如下的Javascript代码，看看ESLint是怎么做的。</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="2b6d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在让我们试着运行ESLint</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="5b1a" class="lq lr iq lm b gy ls lt l lu lv">// this will run ESLint on this file only<br/>npx eslint ./eslinttest.js</span><span id="e056" class="lq lr iq lm b gy lw lt l lu lv">// this will run ESLint on all JS files in your project directory<br/>npx eslint **/*.js</span></pre><p id="38f5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下面是ESLint的输出</p><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/057894f91627eb5a73a683bdb2d0d937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-vP5l7PUNY63XVCZrbz-GA.png"/></div></div></figure><p id="ee12" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们只是发现了一些需要您的评论来修复的问题！呜哇！</p><p id="8f8d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">好了，现在我们知道我们的代码有一些问题，我们如何修复它？埃斯林也支持你。它可以为您修复上面的一些问题，这可以通过运行</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="eeb8" class="lq lr iq lm b gy ls lt l lu lv">npx eslint --fix ./eslinttest.js</span></pre><p id="6086" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe lx ly lz lm b">--fix</code> <em class="ld"> </em>选项将命令ESLint自动修复在传递过程中捕捉到的错误。</p><p id="a5f2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="ld">注意:ESLint可能不会自动修复代码中遇到的所有错误。</em></p><p id="f04f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们看看让ESLint自己修复错误后，我们的JS代码是什么样子。</p><figure class="lh li lj lk gt jr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="64cb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">太好了！ESLint让我们了解了一些地方，比如它用ES6字符串模板功能修复了字符串连接，并用双引号替换了单引号(这是ESLint的默认设置，您可以将其更改为使用单引号)。但是它没有自己删除控制台语句，因为ESLint知道它的局限性！；)</p><p id="ec70" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">到目前为止一切都很好。现在，如果您想将所有的<code class="fe lx ly lz lm b">var</code> <em class="ld"> </em>声明替换为ES6 <code class="fe lx ly lz lm b">let</code> / <code class="fe lx ly lz lm b">const</code>声明，该怎么办呢？</p><p id="525c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有了ESLint，就像修改配置中的规则一样简单。如果您检查我们之前创建的配置并搜索<a class="ae me" href="https://eslint.org/docs/rules/no-var" rel="noopener ugc nofollow" target="_blank"><strong class="ke ir"><em class="ld">no-var</em></strong></a><strong class="ke ir"><em class="ld"/></strong>，您会发现:</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="b153" class="lq lr iq lm b gy ls lt l lu lv">rule: {<br/> ...<br/> ...<br/> no-var: "off",<br/> ...<br/> ...<br/>}</span></pre><p id="43f0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">嗯，这意味着规则<a class="ae me" href="https://eslint.org/docs/rules/no-var" rel="noopener ugc nofollow" target="_blank"><strong class="ke ir"><em class="ld">no-var</em></strong></a><strong class="ke ir"><em class="ld"/></strong>在传递期间被ESLint从检查中关闭。在我们打开这个规则之前，我们需要了解一下ESLint规则。</p><p id="c9fb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ESLint规则可能有3个以下的值:</p><p id="c909" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">0 =关，1 =警告，2 =错误。</p><p id="04ca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以我们希望ESLint在遇到<strong class="ke ir"> <em class="ld"> var </em> </strong>声明时抛出错误。为此，我们将配置更改为:</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="7739" class="lq lr iq lm b gy ls lt l lu lv">rule: {<br/> ...<br/> ...<br/> no-var: "error",<br/> ...<br/> ...<br/>}</span></pre><p id="4f8e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，当我们运行ESLint时，它将按照您预期的方式运行，并在遇到<code class="fe lx ly lz lm b">var</code>时抛出一个错误。<strong class="ke ir"> <em class="ld"> I </em> </strong>如果你用<em class="ld"> fix </em>选项运行它，那么它会根据代码中的用法自动将所有<code class="fe lx ly lz lm b">var</code> <strong class="ke ir"> <em class="ld"> </em> </strong>替换为<code class="fe lx ly lz lm b">const</code> / <code class="fe lx ly lz lm b">let</code> <strong class="ke ir"> <em class="ld"> </em> </strong>。太酷了！</p><p id="c183" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">将ESLint融入您的开发工作流程</strong></p><p id="364e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，这是一件很重要的事情，它会影响你的开发工作流程，尤其是当你在一个团队中工作的时候，大多数时候都是这样。</p><p id="4fa0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里的重点是，当你在读这篇文章的时候，你的代码库有多大，你想引入ESLint。对于大代码库，我指的是代码中JS的行数和开发人员的数量。</p><p id="c649" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你刚刚开始，那么从第一天开始你就选择使用ESLint是很容易的。如果不是，那么在使用ESLint之前，您需要考虑两个因素:</p><ol class=""><li id="5f56" class="mf mg iq ke b kf kg kj kk kn mh kr mi kv mj kz mk ml mm mn bi translated">您将如何解决代码库中现有的ESLint错误？这可能是最疯狂的。例如，当使用<code class="fe lx ly lz lm b"><a class="ae me" href="https://eslint.org/docs/user-guide/configuring#using-eslintrecommended" rel="noopener ugc nofollow" target="_blank">eslint:recommended</a></code>配置时，我们的代码库中有大约600个奇怪的错误(在ESLint为我们自动修复一些错误之后)。</li><li id="dadf" class="mf mg iq ke b kf mo kj mp kn mq kr mr kv ms kz mk ml mm mn bi translated">你如何在你的代码库中强制使用ESLint，使它成为你日常开发工作流程的一部分？</li></ol><p id="5cec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我会解释我们进行的方式。</p><ol class=""><li id="3435" class="mf mg iq ke b kf kg kj kk kn mh kr mi kv mj kz mk ml mm mn bi translated">首先，我们生成了一个HTML lint报告，其中包含了我们的代码库中所有被ESLint捕获的错误。这可以通过以下方式产生</li></ol><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="b9aa" class="lq lr iq lm b gy ls lt l lu lv">npx eslint --ext .js -f html -o ./lint-report/errors.html **/*.js</span></pre><p id="a53f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">报告看起来像这样。</p><figure class="lh li lj lk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/ad99f0edaa9d1c5a0c9812a384bf93a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2D6VSy74RxNk0WptByKzaw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">lint报告— HTML</figcaption></figure><p id="e71f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用它是直截了当和不言自明的。如果没有，您可以访问关于该规则的官方文档以了解更多详细信息，本报告中也提供了这些信息。</p><p id="c026" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2.我们决定先修复这些错误，然后再在我们的开发工作流程中实施ESLint。</p><p id="cb73" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">3.所有的错误都在这一点上得到解决。现在，我们在代码提交期间放置了lint检查，这将确保即将进入我们代码库的代码通过所有lint检查。这可以在我们称之为<strong class="ke ir"> <em class="ld">的预提交钩子的帮助下完成。</em> </strong>实现这一点也很简单，遵循以下步骤。</p><p id="f7a0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">安装<a class="ae me" href="https://www.npmjs.com/package/husky" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"> <em class="ld">哈士奇</em></strong>T11】</a></p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="aecf" class="lq lr iq lm b gy ls lt l lu lv">npm i husky --save-dev </span></pre><p id="bc0d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在<code class="fe lx ly lz lm b">package.json</code>文件中创建一个类似下面的预提交钩子</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="2c2a" class="lq lr iq lm b gy ls lt l lu lv">"husky": {</span><span id="9147" class="lq lr iq lm b gy lw lt l lu lv">  "hooks": {</span><span id="fb8f" class="lq lr iq lm b gy lw lt l lu lv">     "pre-commit": "./node_modules/.bin/eslint --ext .js **/*.js --fix"</span><span id="6191" class="lq lr iq lm b gy lw lt l lu lv">   }</span><span id="a1ba" class="lq lr iq lm b gy lw lt l lu lv">}</span></pre><p id="9914" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这将确保您的所有暂存代码都被发送进行lint测试。现在您已经成功地自动化了这个过程，确保没有代码带着lint错误进入您的代码库。</p><p id="38ad" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你成功了！正如我前面提到的，与ESLint打交道并不复杂。</p><p id="ebcf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">希望这篇文章对你有用！</p><p id="113d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一起说吧-&gt; <strong class="ke ir"> <em class="ld"> ESLint rocks！</em>T15】</strong></p></div></div>    
</body>
</html>