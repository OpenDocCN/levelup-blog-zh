<html>
<head>
<title>“Where Shall I Put That?”— Core vs Shared Module in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“我该把它放在哪里？”—核心模块与角度共享模块</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/where-shall-i-put-that-core-vs-shared-module-in-angular-5fdad16fcecc?source=collection_archive---------1-----------------------#2020-04-06">https://levelup.gitconnected.com/where-shall-i-put-that-core-vs-shared-module-in-angular-5fdad16fcecc?source=collection_archive---------1-----------------------#2020-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6f7c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Angular中核心和共享模块的主要特征，pro提示和技巧，以及确定将Angular代码放入哪个模块的经验法则</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e27b14827b44290cfb188208cdccab94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Chi_t5BlDtu2KPrMxE8NPA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@kovalrk?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">罗曼·科瓦尔</a>从<a class="ae ky" href="https://www.pexels.com/photo/brown-wooden-blocks-on-dark-blue-surface-3783425/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</figcaption></figure><p id="b9e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">决定未来可维护性和代码清晰性的每个系统的一个重要方面是它的模块化结构，不管系统大小如何。本文将快速总结Angular应用程序中<code class="fe lv lw lx ly b">core</code>和<code class="fe lv lw lx ly b">shared</code>模块的用途，回答一些更深层次的相关问题，并介绍一条开发Angular应用程序时可以使用的经验法则。</p><p id="718f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于它的模块化结构，Angular是固执己见的，至少在其默认的代码生成器配置中是这样。Angular Style Guide来自Angular states的创建者，他们提供了编写他们认为制作精良的单页应用程序所需的所有哲学和指导方针。</p><p id="3b40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lz">现在，遵循风格指南的理由是什么？</em></p><ol class=""><li id="7cf7" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu mf mg mh mi bi translated">大量的应用程序随之而来— <em class="lz">如果你遵循风格指南，新的团队成员在加入你的团队时不会有问题</em>,因为他们可能在过去也遵循过。这一点很重要，尤其是在人员变动很大的团队中，不管原因是什么。</li><li id="9885" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated">这份风格指南是由软件开发领域的专家整理出来的——在一句简单的话“用那种方式写/做X”背后，肯定隐藏着许多事实和经验。</li><li id="c136" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><em class="lz"> Angular CLI、linter和Angular周围的更多工具将为您开箱即用</em>，无需任何额外的麻烦、定制生成器和浪费在重新发明轮子上的时间。</li></ol><h1 id="7068" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">📦核心模块</h1><p id="de61" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">你的<code class="fe lv lw lx ly b">core</code>模块应该包含特定于你的应用程序的代码，并且实现你的应用程序的横切关注点——也就是你的房子的<em class="lz">“管道、电力和供暖”</em>,如果你愿意的话，可以把构建一个应用程序比作建造一座房子。这种代码例如可以是:</p><ul class=""><li id="09af" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu nl mg mh mi bi translated">自定义错误处理程序，</li><li id="7938" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu nl mg mh mi bi translated">用于特定于授权/环境的头的HTTP拦截器，</li><li id="e2d9" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu nl mg mh mi bi translated">包装核心Angular APIs的服务，如<code class="fe lv lw lx ly b">HttpClient</code>(一种常用于减少未来Angular接口变化影响的技术)，</li><li id="505b" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu nl mg mh mi bi translated">日志服务。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/5d01651884c5898ac3219ae0738c45db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cia01-A62Njrs_jKAqUkeg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">贯穿各领域的问题。来自edureka的code.reaper12！。</figcaption></figure><p id="d62b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后但同样重要的是，<code class="fe lv lw lx ly b">core</code>模块应该被单独导入到你的根Angular模块中，比如<code class="fe lv lw lx ly b">AppModule</code>，不管你给它起什么名字。</p><h2 id="a097" class="nn mp it bd mq no np dn mu nq nr dp my li ns nt na lm nu nv nc lq nw nx ne ny bi translated">💂‍♀️核心模块输入防护装置</h2><p id="629c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">记住，<em class="lz"/><code class="fe lv lw lx ly b"><em class="lz">core</em></code><em class="lz">模块应该单独导入到你的</em>根角模块中。</p><p id="3038" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实现这条规则的一个简单方法是在你的<code class="fe lv lw lx ly b">CoreModule</code>类的代码中添加所谓的<em class="lz">导入保护</em>。下面的代码片段描述了一个示例实现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">可重复使用的进口保护级</figcaption></figure><p id="4d98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码声明了一个类，该类封装了一个行为，用于在模块被导入到根应用程序模块之外的其他地方时抛出运行时异常。其用法相当简单，如下所示:</p><pre class="kj kk kl km gt ob ly oc od aw oe bi"><span id="264b" class="nn mp it ly b gy of og l oh oi"><a class="ae ky" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>    declarations: [...],<br/>    imports: [...],<br/>    exports: [...],<br/>    entryComponents: [...],<br/>    providers: [...]<br/>})<br/>export class CoreModule <strong class="ly iu">extends EnsureImportedOnceModule</strong> {<br/>    public constructor(<a class="ae ky" href="http://twitter.com/SkipSelf" rel="noopener ugc nofollow" target="_blank"><strong class="ly iu">@SkipSelf</strong></a><strong class="ly iu">() </strong><a class="ae ky" href="http://twitter.com/Optional" rel="noopener ugc nofollow" target="_blank"><strong class="ly iu">@Optional</strong></a><strong class="ly iu">()</strong> parent: CoreModule) {<br/>        super(parent);<br/>    }<br/>}</span></pre><p id="baac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">@SkipSelf</code>注释确保使用 <code class="fe lv lw lx ly b"><em class="lz">CoreModule</em></code>的模块的父模块<em class="lz">被Angular DI注入到<code class="fe lv lw lx ly b">CoreModule</code>的构造函数中，而<code class="fe lv lw lx ly b">@Optional</code>注释消除错误并强制Angular DI在该模块不可用的情况下提供<code class="fe lv lw lx ly b">null</code>(即我们将<code class="fe lv lw lx ly b">CoreModule</code>导入的模块位于Angular模块层次结构树的顶部)。总而言之，这意味着如果注入到<code class="fe lv lw lx ly b">parent</code>参数中的值不是<code class="fe lv lw lx ly b">null</code>，那么模块没有被导入到根应用程序模块中，代码将抛出一个运行时异常。</em></p><p id="5e91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这只是实现导入保护的许多方法之一，其他方法本质上非常相似。</p><h1 id="96f2" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">🧰共享模块</h1><p id="c3ac" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">你的<code class="fe lv lw lx ly b">shared</code>模块应该包含有可能在你的应用中重用的代码，通常是你的<em class="lz">组件</em>、<em class="lz">指令</em>和<em class="lz">管道</em>。当把建造一个应用程序比作建造一所房子时，这可以比作你房子的装饰——家具可以在其他地方重复使用，而且可以在房子里四处移动。</p><p id="7c49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与<code class="fe lv lw lx ly b">core</code>模块相反，您的<code class="fe lv lw lx ly b">shared</code>模块可以多次导入到您的应用程序中的许多不同模块。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/42783f2a8291a1337c02bd6fe1ec7a19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9mc6m7EWdgRzOfwkkRdfeA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">共享与核心模块导入结构。来自Angular Academy的Bartosz Pietrucha】。</figcaption></figure><p id="9f43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为你的<code class="fe lv lw lx ly b">shared</code>模块中的代码可以被多次重用，并且将来可能在一个完全不同的应用程序中重用，所以向你的共享模块中引入更多的子模块是有利的——只要记住保持模块较小并分配它们各自的职责(例如一个模块用于<em class="lz">表单</em>、<em class="lz"> </em>另一个模块用于<em class="lz">货币兑换</em>，另一个模块用于<em class="lz">数字格式化</em>等等)。).将你的<code class="fe lv lw lx ly b">shared</code>模块的一部分用这样的模块化结构提取到一个单独的库中，在未来将是轻而易举的事情！</p><h2 id="d361" class="nn mp it bd mq no np dn mu nq nr dp my li ns nt na lm nu nv nc lq nw nx ne ny bi translated">等等…核心模块里没有组件？</h2><p id="debb" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">嗯，这就是整个决策过程的模糊性<em class="lz"/><code class="fe lv lw lx ly b"><em class="lz">core</em></code><em class="lz">或者</em><code class="fe lv lw lx ly b"><em class="lz">shared</em></code><em class="lz"/>发挥作用的地方。是的，<em class="lz">就其本质而言，这些组件通常是可以重复使用的。但是——他们真的会被重用吗？那是你应该考虑的问题。像导航条、页脚、导航条/页脚布局、侧菜单等等。可能不会被重用，但所有这些都是组件。</em></p><p id="a46d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何特定于应用程序的代码，没有项目内的依赖性，在功能模块范围之外，即使它是一个组件、指令或管道，最有可能在<code class="fe lv lw lx ly b">core</code>模块中结束。</p><p id="0604" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里只需要注意一点——项目内依赖关系是放在同一个项目(即应用程序)中但在不同(非核心)模块中的依赖关系。这个"<em class="lz">无项目内依赖"</em>条件是为了避免你在模块间声明循环依赖。</p><h2 id="6685" class="nn mp it bd mq no np dn mu nq nr dp my li ns nt na lm nu nv nc lq nw nx ne ny bi translated">那应该去特征模块还是共享模块？</h2><p id="4188" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">如果你问自己这个问题，你通常应该考虑两件事:</p><ol class=""><li id="180b" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu mf mg mh mi bi translated">我们使用哪种开发方法？</li><li id="11cf" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated">我的解决方案是否符合/违反我们团队的审核规则？</li></ol><p id="8555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，在敏捷的工作环境中，如果你是一名开发人员，通常只考虑当前的功能需求来构建系统是有利的，也就是说<em class="lz">永远不要提前计划，而是使你的系统的模块化结构相对于当前的系统需求来说是正确的</em>——哦，当然了，<em class="lz">拥抱未来的持续重构</em>。</p><p id="cbdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在非敏捷环境中，你绝对应该<em class="lz">考虑未来可能发生在你的系统上的事情</em>。比如技术方面的东西(谁以及如何整合我们——哪些模块可能会被整合？我们应该公开一个库还是一个支持iframe的部件？)或功能性的东西(我们对软件使用的看法在短期内会如何发展<em class="lz">？).如果很难做出这样的考虑，那么在软件设计阶段的最后，总是有可能回到这个问题。</em></p><p id="82b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，如果您的模块化结构在评审阶段因为任何原因被拒绝，在您的团队中讨论这个问题总是最好的主意。</p><h1 id="3507" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">🎁总结</h1><p id="cf71" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">您刚刚阅读了一些关于将代码放置到Angular应用程序的<code class="fe lv lw lx ly b">core</code> / <code class="fe lv lw lx ly b">shared</code>模块中的技巧。实际上，在某些场景<em class="lz">中，您关于将代码放入系统的这类模块的决定可能是模糊的</em>。这完全没问题！</p><p id="a0d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，真正重要的是，整个团队理解你的决定，并且<em class="lz">在你的应用程序的模块化结构方面也是一样的</em>——毕竟，这都是团队合作的结果。</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><p id="b1b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后但同样重要的是，简介中承诺的经验法则:</p><ul class=""><li id="efaf" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu nl mg mh mi bi translated">代码是我的app <em class="lz"> (navbar，footer等)独占的吗？)</em>它是否没有来自其他模块的项目内依赖关系？→ <code class="fe lv lw lx ly b">core</code></li><li id="d111" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu nl mg mh mi bi translated">是不是“管道代码”<em class="lz"> (Angular core API包装器，错误处理程序，HTTP拦截器等。)</em>？→ <code class="fe lv lw lx ly b">core</code></li><li id="15d6" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu nl mg mh mi bi translated">代码的职责<em class="lz">是打算</em>在许多地方重用吗？→ <code class="fe lv lw lx ly b">shared</code></li><li id="d75c" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu nl mg mh mi bi translated">这些规则对我的案子有冲突吗？→ <em class="lz">和队友讨论一下:)</em></li></ul><h1 id="4b50" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">👓值得一看的文章</h1><div class="or os gp gr ot ou"><a rel="noopener  ugc nofollow" target="_blank" href="/auto-unsubscribing-in-angular-components-like-a-pro-742220b01d0c"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">像专业人士一样自动退订角度组件</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">快速处理unsubscribe()调用的5个技巧</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ks ou"/></div></div></a></div><div class="or os gp gr ot ou"><a rel="noopener  ugc nofollow" target="_blank" href="/handling-loading-indicators-in-angular-applications-the-right-way-11ff8b8896ba"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">正确处理角度应用中的负载指示器</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">一个优雅的，没有麻烦的方式来摆脱无意义的技术管道在您的业务角组件。</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pd l"><div class="pj l pf pg ph pd pi ks ou"/></div></div></a></div><div class="or os gp gr ot ou"><a rel="noopener  ugc nofollow" target="_blank" href="/this-angular-technique-will-significantly-lower-code-duplication-in-big-projects-28fd62c3eadd"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">这种角度技术将显著降低大型项目中的代码重复</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">告别大型项目中ng模板的代码重复和性能问题</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pd l"><div class="pk l pf pg ph pd pi ks ou"/></div></div></a></div></div></div>    
</body>
</html>