<html>
<head>
<title>Publish Your First Package With Gradle and GitLab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Gradle和GitLab发布你的第一个包</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/publish-your-first-package-with-gradle-and-gitlab-1993e4405629?source=collection_archive---------2-----------------------#2021-12-27">https://levelup.gitconnected.com/publish-your-first-package-with-gradle-and-gitlab-1993e4405629?source=collection_archive---------2-----------------------#2021-12-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="347c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">与您的团队共享周到的API库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/53fa2490699eea6027c7429022610927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TSRX0QgzlEhmAgrY"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@izgubljenausvemiru?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Tijana Drndarski </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="fee7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们正处于假日季节的中期，如果你想庆祝一下，很可能你不得不彻底考虑今年的礼物以及如何取悦家人和朋友。我承认，我有时觉得消费主义有点破坏了送礼仪式的纯真。最起码，我觉得我应该亲自包装我的礼盒，给他们一点个人的感动，把捐东西的喜悦赚回来。</p><p id="350f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们能处理好礼物的物理信封，为什么不学习如何用神奇的软件包做同样的事情，与我们的团队分享呢？毕竟，众所周知，我们应该最大限度地重用代码，以加快开发，最重要的是，改善我们同事的生活。</p><p id="023e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您的团队在GitLab上合作，并且热衷于构建Gradle项目，这是学习软件包发布这一令人尊敬的技术的时候了。</p><h1 id="a236" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">先决条件</h1><p id="9566" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在开始我们的装箱任务之前，请确保您手头上有所有需要的材料:</p><ul class=""><li id="5eb0" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">Gradle v7.2.0+(如果你使用的是v6，你仍然可以理解，只是要注意具体的注释)</li><li id="0920" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">维护者访问GitLab项目或组</li><li id="50ed" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">与你的团队分享一个奇妙的API库</li></ul><h1 id="3fdc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">建立一个项目</h1><p id="d084" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果你已经清楚地知道该把哪个项目放进你的包里，就跳过这一部分，继续选择一些花哨的丝带。</p><p id="00ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，如果您是从零开始，导航到一个新的目录并将命令<code class="fe nd ne nf ng b">gradle init</code>提交到您的首选命令行中。然后，当提示输入项目类型时，选择<code class="fe nd ne nf ng b">3. library</code>。使用最适合项目的设置完成初始配置。对于本指南，我用<code class="fe nd ne nf ng b">Kotlin</code>语言和<code class="fe nd ne nf ng b">Groovy DSL</code>构建脚本生成了一个库(是的，它在GitLab上，你可以在这里<a class="ae kv" href="https://gitlab.com/loris.occhipinti2/kotlin-library-tutorial" rel="noopener ugc nofollow" target="_blank">浏览</a>)。</p><p id="d2d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，您可能还想建立一个新的GitLab项目来托管库源代码及其包工件。</p><h1 id="c6f2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">认证到包存储库</h1><p id="2b80" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在发布私有包时，GitLab允许几种不同的授权方法:</p><ul class=""><li id="b364" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated"><code class="fe nd ne nf ng b">personal access token</code></li><li id="f07b" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><code class="fe nd ne nf ng b">deploy token</code></li><li id="ee49" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><code class="fe nd ne nf ng b">CI_JOB_TOKEN</code></li></ul><p id="b4af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个<code class="fe nd ne nf ng b">personal access token</code>链接到一个特定的账户，所以你可能不应该与你的团队分享。另一方面，一个<code class="fe nd ne nf ng b">CI_JOB_TOKEN</code>通常用于CI/CD管道，所以您可能对它们不感兴趣，因为我们将在本文中手动发布我们的库。</p><p id="8374" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于我们的用例，一个<code class="fe nd ne nf ng b">deploy token</code>似乎是最好的选择。要生成令牌，导航到所需的GitLab组或项目(需要维护者角色)，然后浏览<code class="fe nd ne nf ng b">Settings&gt;Repository</code>并展开<code class="fe nd ne nf ng b">Deploy Tokens</code>部分。为令牌选择名称、到期日期(可选)和用户名(可选)，并分配<code class="fe nd ne nf ng b">read_package_registry</code>、<code class="fe nd ne nf ng b">write_package_registry</code>范围。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/432f39ebd46aca55b878e382db0e4df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9qipPKJqc7sitEHMaeeWsA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">确保在创建令牌时分配正确的范围</figcaption></figure><p id="d6f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后按下满意的<code class="fe nd ne nf ng b">Create deploy token</code> <em class="ni"> </em>蓝色按钮，安全保存结果，因为新生成的令牌无法再次访问。</p><p id="ddc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您可以将您的库连接到包存储库了。只需在<code class="fe nd ne nf ng b">build.gradle</code>脚本中添加一个<code class="fe nd ne nf ng b">publishing</code>部分，并启用<code class="fe nd ne nf ng b">publishing</code>插件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Gradle v7.2的发布部分</figcaption></figure></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">不要忘记启用发布插件</figcaption></figure><p id="cb63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将项目名称下的<code class="fe nd ne nf ng b">PROJECT_ID</code>占位符替换为GitLab存储库中显示的项目ID。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/73495f148d642782de9b943ef198d1e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lj4OAUAkmrYgsEpCPJ77Yg.png"/></div></div></figure></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h2 id="e02e" class="nt lt iq bd lu nu nv dn ly nw nx dp mc lf ny nz me lj oa ob mg ln oc od mi oe bi translated">关于早期Gradle版本的注释</h2><p id="a37f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">对于Gradle的早期版本，<code class="fe nd ne nf ng b">publishing</code>部分的布局略有不同，如下面的代码片段所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h1 id="f20f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">出版</h1><p id="6056" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">运行任务<code class="fe nd ne nf ng b">gradle publish</code>。打包的库可以在所选项目的<code class="fe nd ne nf ng b">Packages &amp; Registries</code>页面中浏览，并且现在可以由外部项目下载。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/1e9f9c3c927a04badb8f4f0c41454a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQo6kTJFgm9t9tfT_sVdfQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">项目的包注册表包含多个版本</figcaption></figure><p id="1410" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">记得正确更新<code class="fe nd ne nf ng b">build.gradle</code>文件中的<code class="fe nd ne nf ng b">version</code>字段，以跟踪您的所有更改。</p><h1 id="cb5b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">导入包</h1><p id="beaf" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">已发布的包可以作为依赖项导入到项目中。但是，有必要更新依赖于依赖关系的项目的<code class="fe nd ne nf ng b">build.gradle</code>中的存储库部分:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="d2ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要导入库，请更新项目依赖关系:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="2e9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，您的API和类可以在项目中自由使用！</p><h1 id="045a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="c590" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我希望你喜欢用彩色包装纸和华丽的蝴蝶结弄脏你的手。</p><p id="f97e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请记住:当然是心意，但是请不要让任何粘糊糊的虫子进入你的包裹！</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="d7af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://blog.lorisocchipinti.com" rel="noopener ugc nofollow" target="_blank">加入我的时事通讯，了解更多类似的故事</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/ed57485a06522d6d9c7bee3fb8ccbdb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wbIGpMf2YkvlYFAf"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@iamchang?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">张阳</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="0180" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><ul class=""><li id="3590" class="mp mq iq ky b kz mk lc ml lf oh lj oi ln oj lr mu mv mw mx bi translated">GitLab资源库:<a class="ae kv" href="https://gitlab.com/loris.occhipinti2/kotlin-library-tutorial" rel="noopener ugc nofollow" target="_blank">https://git lab . com/loris . occhipinti 2/kot Lin-library-tutorial</a></li><li id="ed43" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">官方文档:<a class="ae kv" href="https://docs.gitlab.com/ee/user/packages/maven_repository/index.html" rel="noopener ugc nofollow" target="_blank">https://docs . git lab . com/ee/user/packages/maven _ repository/index . html</a></li></ul></div></div>    
</body>
</html>