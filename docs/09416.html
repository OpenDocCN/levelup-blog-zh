<html>
<head>
<title>3 Techniques to Extract Tables as Pandas Dataframe from PDF / HTML files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从PDF / HTML文件中提取表格作为Pandas数据框架的3种技术</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/3-techniques-to-extract-tables-as-pandas-dataframe-from-pdf-html-files-9a95c0b55f74?source=collection_archive---------1-----------------------#2021-08-09">https://levelup.gitconnected.com/3-techniques-to-extract-tables-as-pandas-dataframe-from-pdf-html-files-9a95c0b55f74?source=collection_archive---------1-----------------------#2021-08-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d5e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用一行Python代码从PDF、HTML、网页中抓取表格</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6f63cfe912e8be0877bb6c6b7d0297cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HPcS7o1RGvtANPsigvM3A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/photos/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=801921" rel="noopener ugc nofollow" target="_blank">免费提供-照片</a>来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=801921" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></figcaption></figure><p id="987d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据收集是数据科学模型开发生命周期的第一步。数据集可以以任何格式呈现，数据工程师或数据科学家需要对原始数据集进行预处理，以使其适合建模。许多结构化或半结构化数据集可以以PDF、HTML文件、网页或图像格式呈现。从这样的非结构化文档中抓取数据集或表格是一项单调乏味的任务。开发一个定制的表格提取工具也需要大量的工作。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="b70e" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">Checklist:<br/>(1) Pandas read_html() function<br/>(2) Tabula-py library<br/>(3) Camelot</strong></span></pre><p id="2843" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论3个这样的开源包，它们可以从PDF、HTML文件或网页中删除或提取表格，并将它们转换为Pandas数据框。</p><h1 id="5e08" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">(1.)熊猫read_html():</h1><p id="1d0d" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">可以使用Beautiful Soup之类的库从网页中抓取信息，但是当我们在网页上有了结构化的表格之后，就有可能使用<code class="fe nc nd ne lw b"><strong class="lb iu">read_html()</strong></code>函数将表格提取为Pandas数据帧。</p><h2 id="cacd" class="ma mb it bd mh nf ng dn ml nh ni dp mp li nj nk mr lm nl nm mt lq nn no mv np bi translated">用法:</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7d74" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">import pandas as pd<br/>df = pd.read_html('-- web address --')</strong></span></pre><p id="b6ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫的read_html()函数从网页中拉出所有的表格。表格是按照它在网页的HTML代码中的书写顺序读取的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/c4330746216dd8490db0ce72979654be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*UQbu6Fsj2Lgvg6f9lRjneQ.png"/></div></figure><p id="83b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述网页上有4个表格。每个表都可以通过索引显示为熊猫数据框。</p><div class="kj kk kl km gt ab cb"><figure class="nr kn ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/0513d50b6dc025d958dafaa92670f4db.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*TsHIEw775QqcUfpgnX178w.png"/></div></figure><figure class="nr kn nx nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ebf8525cb05b05dc2b2c17ead66e3e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*1ZeBAi7eZGrPRkdyTONTTg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk ny di nz oa translated">(图片由作者提供)，使用read_html()作为Pandas数据框提取表格</figcaption></figure></div><h1 id="948e" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">(2.)白板:</h1><p id="46b4" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">Tabula-py是一个开源的Python库，允许从PDF文档中抓取表格或将整个PDF文档转换为CSV、TSV、JSON格式。它是tabula-java包的python包装器。</p><h2 id="455e" class="ma mb it bd mh nf ng dn ml nh ni dp mp li nj nk mr lm nl nm mt lq nn no mv np bi translated">安装和使用:</h2><p id="c82b" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated"><code class="fe nc nd ne lw b"><strong class="lb iu">tabula-py</strong></code>可以从PyPI安装软件包，使用</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="266a" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">pip install tabula-py</strong></span></pre><p id="a381" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要读取PDF文档并将表格转换为数据框列表，请使用:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0a25" class="ma mb it lw b gy mc md l me mf">import tabula<br/>tables = tabula.read_pdf('file.pdf', pages = "all")</span></pre><p id="1f47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">tabula-py可以从一个PDF文档中提取表格，并将其保存为CSV格式。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4187" class="ma mb it lw b gy mc md l me mf"># convert PDF into CSV file<br/><strong class="lw iu">tabula.convert_into("test.pdf", "output.csv", output_format="csv", pages='all')</strong></span></pre><h1 id="0565" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">(3.)卡梅洛特:</h1><p id="3ef7" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">Camelot是另一个Python库，它从PDF文档中提取表格，这些表格可以导出为CSV、TSV、JSON数据格式。Camelot最适合基于文本的PDF文档，而不是扫描的文档或图像。</p><p id="a4f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Camelot基本上使用两种解析技术从PDF文档中提取表格:</p><ul class=""><li id="f2af" class="ob oc it lb b lc ld lf lg li od lm oe lq of lu og oh oi oj bi translated">流解析</li><li id="fff2" class="ob oc it lb b lc ok lf ol li om lm on lq oo lu og oh oi oj bi translated">点阵解析</li></ul><blockquote class="op oq or"><p id="5f84" class="kz la os lb b lc ld ju le lf lg jx lh ot lj lk ll ou ln lo lp ov lr ls lt lu im bi translated">阅读<a class="ae ky" href="https://towardsdatascience.com/extract-tables-from-pdf-file-in-a-single-line-of-python-code-5b572cd9fbe5" rel="noopener" target="_blank">这篇文章</a>以获得上述解析技术的分步方法。</p></blockquote><h2 id="2a99" class="ma mb it bd mh nf ng dn ml nh ni dp mp li nj nk mr lm nl nm mt lq nn no mv np bi translated">安装和使用:</h2><p id="b7d2" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">Camelot需要Ghostscript依赖项，这两个库都可以从PyPI安装:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="bc45" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">!pip install "camelot-py[cv]"<br/>!apt install python3-tk ghostscript</strong></span></pre><p id="4bf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导入Camelot库<code class="fe nc nd ne lw b"><strong class="lb iu">import camelot</strong></code>后，可以使用<code class="fe nc nd ne lw b"><strong class="lb iu">read_pdf()</strong></code>功能从PDF文档中提取表格。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f41d" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">df_table = camelot.read_pdf('file.pdf', pages='1,2,4-5')</strong></span></pre><p id="ec64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，表格将从PDF文档的第一页提取。使用参数<code class="fe nc nd ne lw b">pages</code>，可以提取页码列表中提到的表格。在清理完这些表之后，可以使用索引号来访问每个表。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e8e9" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#To display the ith table as Pandas Data frame<br/>tables[i].df</strong></span></pre></div><div class="ab cl ow ox hx oy" role="separator"><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb"/></div><div class="im in io ip iq"><h1 id="dbd6" class="mg mb it bd mh mi pd mk ml mm pe mo mp jz pf ka mr kc pg kd mt kf ph kg mv mw bi translated">结论:</h1><p id="2270" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">在本文中，我们讨论了3个开源Python库，它们可以从PDF、HTML文档或web页面中提取或抓取表格作为Pandas data frame。这些都是方便的工具，可以用很少几行Python代码来加速数据收集工作流。</p><p id="eaf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有各种其他这样的库，包括pdftables、pdf-table-extract、pdfplumber，它们执行类似的功能。</p><h1 id="783d" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">参考资料:</h1><p id="b876" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">[1]Tabula-py GitHub:<a class="ae ky" href="https://github.com/chezou/tabula-py" rel="noopener ugc nofollow" target="_blank">https://github.com/chezou/tabula-py</a></p><p id="0dac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]卡梅洛特文献:<a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank">https://camelot-py.readthedocs.io/en/master/</a></p><blockquote class="pi"><p id="5f5e" class="pj pk it bd pl pm pn po pp pq pr lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>