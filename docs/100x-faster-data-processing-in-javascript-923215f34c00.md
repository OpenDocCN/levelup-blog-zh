# Javascript 中的数据处理速度提高 100 倍

> 原文：<https://levelup.gitconnected.com/100x-faster-data-processing-in-javascript-923215f34c00>

ode.js 有一个非常广泛的生态系统，几乎所有东西都有它的工具。然而，与其他语言相比，数据处理工具&框架总是有点暗淡。像 Apache Spark 和 Pandas 这样的框架为处理复杂的数据转换提供了优秀的接口。出于这样或那样的原因，JS 生态系统中总是缺少这种框架。

在 Javascript & Node 中，从来没有一个成熟的库有类似的功能。

***到现在…***

> 为了填补节点生态系统中的这一空白，Polars 扩展了其官方支持的语言，包括 Node.js。
> 
> NPM 现在有了一个名为`[nodejs-polars](https://www.npmjs.com/package/nodejs-polars)`的 Node.js 库

# Polars 是一个非常快的数据帧库，在 Rust 中实现，使用 Apache Arrow Columnar 格式作为内存模型。

*   懒惰|渴望执行
*   多线程
*   SIMD
*   查询优化
*   强大的表达式 API

# Polars 由两个主要部分组成。

## 系列

系列类似于数组，只是它只能包含一种数据类型。

## 数据帧

一个数据帧包含多个系列。

## **什么是数据框架？**

> **DataFrame** 是一种数据结构，它将数据组织成由行和列组成的二维表格，很像电子表格。数据帧是现代数据分析中最常用的数据结构之一，因为它们是存储和处理数据的一种灵活而直观的方式。

## 这些和性能有什么关系呢？

# Polars DataFrame &系列提供无与伦比的性能

演示 Polars 如何将代码性能提高 100 倍或更多。我们进行了一系列基准测试，将 Polars 与 NPM 的其他常用库进行比较。

# **系列基准**

**库测试了** nodejs-polars、ramda、lodash
数据集**随机生成的 100 万条记录数据**

系列基准

> 在最糟糕的情况下，系列赛的表现比亚军高出约 2 倍
> 
> 最好的情况下，Series 的性能超过 80 倍。
> 
> 总的来说，Series 在每个测试的操作中都比其他产品表现更好

# CSV 基准

**图书馆测试** nodejs-polars，csv，fast-csv
数据集:以太坊交易数据 10k-1M 记录**

CSV 基准

> 将一个 *CSV 文件*读入 Polars 中 16 列 500k 行的内存显示出比本机`fs`模块快 114 倍的执行时间，比最慢的执行程序快 170 倍以上
> 
> 10k 数据集读取操作快了大约 40 倍。过滤速度比原生`*fs*`模块快 15 倍。
> 
> 用于 1M 记录的 fs 过滤器是唯一一个耗尽内存的过滤器。作为基线，我使用了`*fs.readFileSync*`方法来获取数据。这可能是内存不足错误的原因，因为这是唯一不使用流或数据帧的测试。
> 
> Polars 通过利用多线程 Rust 后端提供了这种惊人的性能。如果你想了解更多关于库背后的算法，请阅读这篇[文章](https://www.ritchievink.com/blog/2021/02/28/i-wrote-one-of-the-fastest-dataframe-libraries/)！

# 使用极坐标

除了令人难以置信的性能之外，Dataframe & Series 还提供了富有表现力的 API，允许您对数据进行操作，而不必为常见操作编写样板文件。

Polars 有广泛的内置操作。从累积和、滚动平均、标准偏差等统计操作，到 base64 解码、正则表达式替换、字符串包含等基于字符串的操作

**…还有更多**

# 举几个例子。

## **过滤** `**input !== '0x'**` **中的记录，并将结果作为排序列表**

***旧方式通过流式 csv 库***

***采用极化方式***

极地之路

# **从单个字段中提取唯一值并写入 JSON**

***一种分流方式*一种分流方式**

老办法

***中极化方式***

极地之路

# 连接一个键

***一种程序方法***

***中极化方式***

# 结束了。

> Polars 提供了出色的性能，包装简单易用。

*   Polars 可以加速简单的操作，比如数组排序。
*   **它可以同时简化和加速复杂的流管道。**
*   Polars 可以作为 Ramda、下划线和 Lodash 等库的高性能替代品

## =========================

## **基准测试硬件规格**

## =========================

*   处理器:AMD 锐龙 7 微软 Surface 版 2.00 GHz
*   安装的内存:16.0 GB
*   系统类型:64 位操作系统，x64 处理器
*   Linux 版本:Ubuntu 18.04
*   Polars 版本:0.0.8