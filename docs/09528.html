<html>
<head>
<title>Your Domain Classes Are Not REST Resources, Period.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的域类不是休息资源，句号。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/your-domain-classes-are-not-rest-resources-period-5a62ba8875b9?source=collection_archive---------4-----------------------#2021-08-18">https://levelup.gitconnected.com/your-domain-classes-are-not-rest-resources-period-5a62ba8875b9?source=collection_archive---------4-----------------------#2021-08-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6cd2" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">固执己见的观点</h2><div class=""/><div class=""><h2 id="96d3" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">以“良好实践”为幌子的任意的、自我强加的约束不应该限制您表达自己领域的能力。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/6758ee4b297a9c18668ad35530f7e4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tdDAwv1iFmYSnIGNkiWHig.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="lh li ep" href="https://medium.com/u/7c7a43b3d9de?source=post_page-----5a62ba8875b9--------------------------------" rel="noopener" target="_blank">尼可拉斯·米勒德</a>提供</figcaption></figure><p id="d5a9" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">因此，<a class="ae mf" rel="noopener ugc nofollow" target="_blank" href="/whats-wrong-with-your-crudy-interfaces-besides-everything-bde4f4c8cb8a"> REST显然没有按照我们希望的方式运行</a>。大公司很好地营销了REST来销售他们的软件，开启了所谓的<a class="ae mf" href="https://www2.deloitte.com/content/dam/Deloitte/us/Documents/financial-services/us-fsi-api-economy.pdf" rel="noopener ugc nofollow" target="_blank"> API经济。</a></p><p id="e8a4" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">但我们应该知道事情不会像预期的那样发展。</p><p id="e967" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">一路上有一大堆迹象表明…普遍缺乏标准的实践。这一切的普遍性。专注于遵循任意的、合成的规则，而不是构建特定于业务的API。</p><p id="fa36" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">然后我们有了可能是最明显的迹象REST在现代DDD驱动的应用程序中不起作用:</p><blockquote class="mg"><p id="28f4" class="mh mi it bd mj mk ml mm mn mo mp me dk translated">将面向文档的范例应用到业务领域的复杂现实中，在实践中是行不通的。</p></blockquote><p id="6b7a" class="pw-post-body-paragraph lj lk it ll b lm mq kd lo lp mr kg lr ls ms lu lv lw mt ly lz ma mu mc md me im bi translated">像我一样，其他开发人员也注意到了这一点。但是理论上说，休息是好的，但是在今天的实践中只有部分是好的。</p><h1 id="0db0" class="mv mw it bd mx my mz na nb nc nd ne nf ki ng kj nh kl ni km nj ko nk kp nl nm bi translated">我觉得休息时经常会有些尴尬。</h1><p id="c224" class="pw-post-body-paragraph lj lk it ll b lm nn kd lo lp no kg lr ls np lu lv lw nq ly lz ma nr mc md me im bi translated">我对REST的一个主要问题是，我们如何突然变得“面向资源”而不是面向业务。</p><p id="9e0d" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">如果您真的只是在处理可以存储、检索、更新、替换和删除的资源，那么(CRUDy) REST可能是好的。</p><p id="af80" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">一些粗糙的REST约定也适用于您的业务领域，比如创建或检索一个聊天通道实体，如下所示。</p><p id="fc31" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><code class="fe ns nt nu nv b">GET api/channel</code>检索和<code class="fe ns nt nu nv b">POST api/channel</code>创建。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/15b61141775999049733e44fe2fc6706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LIy7neAhIi0XQ1sC4bSx1Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">简单粗暴的REST API。</figcaption></figure><p id="bcf6" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">但是在基本的实体交互之外，REST显示了它的笨拙。</p><p id="578c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">显然，上面的例子太简单了，以至于不允许在产品代码中使用。我很清楚这一点。至少，我希望没有人会直接从他们的控制器访问存储库类。</p><h2 id="b1b1" class="nx mw it bd mx ny nz dn nb oa ob dp nf ls oc od nh lw oe of nj ma og oh nl iz bi translated">对于外行来说，RESTful端点没有什么意义。</h2><p id="b278" class="pw-post-body-paragraph lj lk it ll b lm nn kd lo lp no kg lr ls np lu lv lw nq ly lz ma nr mc md me im bi translated">隐式或有点隐式的规则实际上是管理REST API的规则。例如，我们只需知道对根资源的<code class="fe ns nt nu nv b">GET</code>请求获取该资源的所有条目。另一方面，对同一个端点的<code class="fe ns nt nu nv b">POST</code>请求将创建一个实体或资源。</p><p id="07d6" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们花了很多时间学习通过代码清楚地表达我们的意图。我们阅读关于<a class="ae mf" rel="noopener ugc nofollow" target="_blank" href="/writing-cleaner-code-with-examples-69be2160b4c1">清洁代码</a>和<a class="ae mf" rel="noopener ugc nofollow" target="_blank" href="/writing-readable-code-exemplified-bd387cd93b6b">如何编写可读代码</a>的文章。但是，出于某种原因，我们可以对所有事情使用相同的端点，只改变请求动词，就像这足以解释我们在API服务器上调用什么功能一样。</p><p id="8c9e" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">顺便说一下，对于REST的实现方式有一个常见的误解。REST API公开的模型既不是域中的实体，也不是数据库中的行。从资源到数据库行没有一对一的映射。让它深入人心。</p><h1 id="4a63" class="mv mw it bd mx my mz na nb nc nd ne nf ki ng kj nh kl ni km nj ko nk kp nl nm bi translated">强大的API可能是我们所需要的。</h1><p id="3171" class="pw-post-body-paragraph lj lk it ll b lm nn kd lo lp no kg lr ls np lu lv lw nq ly lz ma nr mc md me im bi translated">所以，我显然没有所有的答案。差远了。但我确实喜欢质疑现状，尤其是当似乎每个人都在盲目地向同一个方向行进，仅仅因为前面有人开始走。</p><p id="b17c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我有一个疯狂的想法——而且不止我一个人有这种想法。老实说，这种想法很古老了。</p><p id="da4b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们把同样的原则应用到我们的HTTP端点，就像我们写我们通常的代码一样，怎么样？不如我们把事情说清楚…</p><p id="9d85" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">不说<code class="fe ns nt nu nv b">GET api/channel/{id}</code>，说<code class="fe ns nt nu nv b">api/channel/{id}/ViewDetails</code>，不说<code class="fe ns nt nu nv b">POST api/channel</code>，说<code class="fe ns nt nu nv b">api/channel/StartNew</code>怎么样？</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/b36a8587a98766936e7b6f84831c1f80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D4fYXjWrrYfx3I630GIGXg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">基于任务的强大API。</figcaption></figure><p id="c409" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我把新API的帽子撕下来了。HATEOAS可能是我在设计RESTful APIs时遇到的最笨拙的概念之一。</p><p id="155c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">此外，请注意，我使用基于任务的方法来设计端点是多么容易地捕捉到了其他意图。其中一些端点在粗糙的REST接口中难以实现。</p><p id="4cb2" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">根据用户实际感兴趣的操作来建模你的界面。根据您的领域如何工作来对它们建模。基于任务的界面也与领域驱动设计(DDD)中无处不在的语言概念相一致。</p><p id="e8a0" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我很确定你的领域专家和产品负责人不会说“后聊天频道”—他们宁愿说“开始一个新的聊天频道。”您需要在界面中捕捉这种意图。</p><h2 id="9d15" class="nx mw it bd mx ny nz dn nb oa ob dp nf ls oc od nh lw oe of nj ma og oh nl iz bi translated">“但那只是RPC！”</h2><p id="17a3" class="pw-post-body-paragraph lj lk it ll b lm nn kd lo lp no kg lr ls np lu lv lw nq ly lz ma nr mc md me im bi translated">不，不是的。但是差不多了。我们可以把它扩展到称之为RPC-like。</p><p id="6980" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">基于任务的API的伟大之处在于绝对没有猜测。它公开了一个接口，该接口是按照您在业务领域的上下文中对某个实体的思考和交互方式设计的。</p><p id="7f89" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">一个类似RPC的接口——如果我们选择这样称呼它的话——不仅与这种无处不在的语言很好地结合在一起，它还与现代的<a class="ae mf" rel="noopener ugc nofollow" target="_blank" href="/replacing-if-else-with-commands-and-handlers-527e0abe2147">命令和查询分离(CQS)模式</a>几乎完美地映射在一起。</p><h1 id="56dd" class="mv mw it bd mx my mz na nb nc nd ne nf ki ng kj nh kl ni km nj ko nk kp nl nm bi translated">总之…</h1><p id="b4e1" class="pw-post-body-paragraph lj lk it ll b lm nn kd lo lp no kg lr ls np lu lv lw nq ly lz ma nr mc md me im bi translated">你不需要<em class="oj">盲目地认为一个架构模式是实现你的领域的标准。</em></p><p id="a87a" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">常见的是将REST实现为HTTP上的CRUD，但是这样做的话，最多只能得到一个过于普通的应用程序。</p><p id="9da0" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">考虑你的业务领域和你的客户的意图，以及他们实际上想如何与你的实体互动。</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><h1 id="be60" class="mv mw it bd mx my or na nb nc os ne nf ki ot kj nh kl ou km nj ko ov kp nl nm bi translated">让我们保持联系！</h1><p id="3a68" class="pw-post-body-paragraph lj lk it ll b lm nn kd lo lp no kg lr ls np lu lv lw nq ly lz ma nr mc md me im bi translated"><a class="ae mf" href="https://nmillard.medium.com/subscribe" rel="noopener">点击这里</a>订阅时事通讯，获得类似文章的通知，并查看新的YouTube频道<em class="oj"/><a class="ae mf" href="https://www.youtube.com/channel/UCaUy83EAkVdXsZjF3xGSvMw" rel="noopener ugc nofollow" target="_blank">(@ Nicklas Millard)</a></p><p id="4f46" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><em class="oj">连接上</em><a class="ae mf" href="https://www.linkedin.com/in/nicklasmillard/" rel="noopener ugc nofollow" target="_blank"><em class="oj">LinkedIn</em></a></p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><h1 id="cb20" class="mv mw it bd mx my or na nb nc os ne nf ki ot kj nh kl ou km nj ko ov kp nl nm bi translated">好奇者的资源</h1><ul class=""><li id="d5cb" class="ow ox it ll b lm nn lp no ls oy lw oz ma pa me pb pc pd pe bi translated">📚<a class="ae mf" href="https://github.com/NMillard/SimpleWebApps/tree/master/src/GeneralPractices/CrudOrTaskBased/CrudApp" rel="noopener ugc nofollow" target="_blank">源代码【GitHub】</a>作者<a class="lh li ep" href="https://medium.com/u/7c7a43b3d9de?source=post_page-----5a62ba8875b9--------------------------------" rel="noopener" target="_blank">尼可拉斯·米勒德</a>，作者</li><li id="b8e0" class="ow ox it ll b lm pf lp pg ls ph lw pi ma pj me pb pc pd pe bi translated">架构风格和T21基于网络的软件架构的设计</li><li id="4b75" class="ow ox it ll b lm pf lp pg ls ph lw pi ma pj me pb pc pd pe bi translated">除此之外，你的CRUD APIs有什么问题吗？作者简介</li><li id="a45c" class="ow ox it ll b lm pf lp pg ls ph lw pi ma pj me pb pc pd pe bi translated">微软的RESTful API设计</li><li id="b85b" class="ow ox it ll b lm pf lp pg ls ph lw pi ma pj me pb pc pd pe bi translated"><a class="ae mf" href="https://www.infoq.com/news/2009/07/CRUDREST/" rel="noopener ugc nofollow" target="_blank">Crud对休息不好吗？鲍里斯·卢布林斯基</a></li><li id="c265" class="ow ox it ll b lm pf lp pg ls ph lw pi ma pj me pb pc pd pe bi translated">特洛伊·格里菲兹的《为什么休息很糟糕》</li></ul><h1 id="e14c" class="mv mw it bd mx my mz na nb nc nd ne nf ki ng kj nh kl ni km nj ko nk kp nl nm bi translated">我想你也会喜欢这些文章的。</h1><ul class=""><li id="8ce2" class="ow ox it ll b lm nn lp no ls oy lw oz ma pa me pb pc pd pe bi translated"><a class="ae mf" rel="noopener ugc nofollow" target="_blank" href="/writing-cleaner-code-with-examples-69be2160b4c1">编写更干净的代码(附例子)</a></li><li id="a006" class="ow ox it ll b lm pf lp pg ls ph lw pi ma pj me pb pc pd pe bi translated"><a class="ae mf" rel="noopener ugc nofollow" target="_blank" href="/remove-your-if-else-and-switch-cases-1ed2b625b4cf">拿掉你的If-Else和Switch Cases </a></li></ul></div></div>    
</body>
</html>