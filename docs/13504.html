<html>
<head>
<title>Filebeat : Ship logs to local Elasticsearch using the Redis module</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Filebeat:使用Redis模块将日志发送到本地Elasticsearch</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/filebeat-ship-logs-to-local-elasticsearch-using-the-redis-module-1cd67b357dc0?source=collection_archive---------3-----------------------#2022-09-10">https://levelup.gitconnected.com/filebeat-ship-logs-to-local-elasticsearch-using-the-redis-module-1cd67b357dc0?source=collection_archive---------3-----------------------#2022-09-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/dc55d69842f08d118c70a801f41dec40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qKE-fgf80HbusoX9XSjtRw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@euwars?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">法尔扎德</a>在<a class="ae kc" href="https://unsplash.com/s/photos/monitor-data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="ac65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大家好吗😁，欢迎回到这个弹性堆栈学习系列。今天，我们继续Filebeat和模块的冒险。</p><p id="9895" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如前面所看到的，Beats家族的主要特点是简单，其背后的想法是减少用户的实现和编码时间，同时尽可能最简单和最有效地将数据传输到Elasticsearch或任何其他输出。</p><p id="be43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">弹性堆栈通过引入模块来满足这一需求。<strong class="kf ir">模块</strong>是可供用户使用的可重用扩展，用于管理日志(如MySQL数据库日志)的解析，然后将它们发送到配置好的目的地。</p><p id="a3bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">模块的根本好处是它们可以处理几乎所有众所周知的技术，包括虚拟化、网络、消息传递和数据库。此外，还有社区定制的扩展，进一步扩展了可用模块库。</p><p id="eeeb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们通过一个例子来看看如何实现所有这些胡言乱语。<br/>在本例中，我们将解析Redis数据库中的日志，并将它们发送到Elasticsearch。</p><p id="4367" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须做到以下几点:</p><ul class=""><li id="3076" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">激活一个知道如何管理Redis日志的模块</li><li id="4f60" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">更新我们的Filebeat配置</li><li id="4946" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">重启我们的代理</li></ul><p id="1476" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦关于日志的所有信息都在Elasticsearch上，我们也应该可以在Kibana上使用其他仪表板。</p><p id="7dce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在实现了本文中<a class="ae kc" href="https://medium.com/@mhdabdel151/ship-logs-to-local-elasticsearch-using-filebeat-36e7fe1bff83" rel="noopener">所解释的配置之后，如果你还没有完成，我强烈建议你参考一下，我们将首先激活Redis模块。</a></p><p id="2d9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过启动以下命令，您将能够看到可供您使用的模块列表:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="b125" class="ly lz iq lu b gy ma mb l mc md">./filebeat modules list</span></pre><p id="09c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您看一下Filebeat文件夹结构，您会注意到一个名为<code class="fe me mf mg lu b">modules.d</code>的文件夹，其中有许多预构建的模块可供您使用。我们要使用的模块在最底部。找到并打开<code class="fe me mf mg lu b">redis.yml.disabled</code>文件，您会看到没有太多关于如何解析日志的信息，更多的是关于在哪里寻找日志文件。这里有两种方法可供我们使用，<em class="mh"> Main logs </em>用于写入磁盘的日志，S <em class="mh"> low logs </em>用于通过Redis API检索日志。</p><p id="f220" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不会干预解析数据的方式，模块会处理它，这里要做的只是配置我们的<em class="mh">浏览者</em>，也就是说，通知<em class="mh">变量路径</em>字段中的日志的访问路径(<em class="mh">取决于您的操作系统，这里我们在Windows </em>上工作)，并通过将<em class="mh">启用</em>设置为<em class="mh">真</em>来启用模块。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="0d6d" class="ly lz iq lu b gy ma mb l mc md">- module: redis</span><span id="2538" class="ly lz iq lu b gy mi mb l mc md">  # Main logs<br/>  log:<br/>    enabled: true<br/>    var.paths: ['C:\Users\elastic\demo\redis-server-1.log']</span></pre><p id="8de1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:包含Redis数据库返回的日志的文件已经放在上述位置。您可以根据本文将Redis作为docker容器运行，并从生成的日志中创建该文件。</p><p id="c453" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成后，我们现在需要在Filebeat上激活那个模块。您始终可以手动执行此操作，但最简单、最安全的方法无疑是运行以下命令:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="bf23" class="ly lz iq lu b gy ma mb l mc md">./filebeat module enable redis</span></pre><p id="0e44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模块将被激活，并知道在哪里可以找到日志。您会注意到上面修改过的文件已经将其名称改为<code class="fe me mf mg lu b">redis.yml </code>,让我们再次运行命令来创建所有的资源和工件:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="abc7" class="ly lz iq lu b gy ma mb l mc md">./filebeat setup</span></pre><p id="5015" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦设置完成，让我们运行Filebeat:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="c508" class="ly lz iq lu b gy ma mb l mc md">./filebeat -e</span></pre><p id="8285" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在日志中，我们可以看到采集器被实例化，这并不奇怪，我们需要的是一行代码，告诉我们已经为Redis日志实例化了一个新的采集器。我们来看看这是不是基巴纳的严重病例。在<em class="mh">仪表板选项卡</em>中，转到<em class="mh">搜索栏</em>，键入<em class="mh"> Redis </em>并打开生成的仪表板。在表格的最底部，显示了我们的日志。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/92c5fa32e2169f040903e02f2c632e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCkd7GV9LtU6AmmtSxwMuQ.png"/></div></div></figure><p id="96b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天到此为止，感谢阅读，请随时查看关于此主题的<a class="ae kc" href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-installation-configuration.html#enable-modules" rel="noopener ugc nofollow" target="_blank">官方文档</a>以了解更多详细信息。如果您对本文有任何问题或评论，请在下面留下您的评论。</p><p id="14f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们下次再见，看更多的帖子🚀。</p><p id="875f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">阿卜杜尔-巴吉</p></div></div>    
</body>
</html>