<html>
<head>
<title>Setting up Development Environment in Visual Studio Codespaces</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Visual Studio代码空间中设置开发环境</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setting-up-development-environment-in-visual-studio-codespaces-9e003e3ece61?source=collection_archive---------7-----------------------#2020-06-17">https://levelup.gitconnected.com/setting-up-development-environment-in-visual-studio-codespaces-9e003e3ece61?source=collection_archive---------7-----------------------#2020-06-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="358b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">在Visual Studio代码中用VNC服务器设置代码空间</em></p><h1 id="9c31" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">介绍</h1><p id="ab0a" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Visual Studio Codespaces是一个基于云的开发环境。由于这完全在云中，我们可以从任何地方使用Visual Studio代码或任何浏览器连接到它。如果你在Azure中创建云托管的代码空间，代码空间是基于<a class="ae lp" href="https://aka.ms/vso-pricing" rel="noopener ugc nofollow" target="_blank">订阅</a>的环境，按使用量收费。您还可以在您的机器上设置自托管代码空间，这是免费的。</p><h1 id="3569" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">在Windows 10上安装和设置VS代码，如果你没有的话</h1><p id="7151" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在Windows 10上安装VS代码和集成MobaXterm终端的说明可以在我的<a class="ae lp" href="https://medium.com/@nsanka/create-development-environment-with-vs-code-fe66f3892159" rel="noopener">上一篇文章</a>中找到。</p><h1 id="8cfe" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">在VS代码中安装代码空间插件</h1><p id="125c" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">使用<code class="fe lq lr ls lt b">Ctrl+Shift+X</code>键盘快捷键打开扩展市场，搜索“Visual Studio Codespaces”扩展并点击安装。安装后，在远程资源管理器中打开代码空间面板。同时安装“Azure帐户”扩展，并使用您的Microsoft帐户登录。</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lu"><img src="../Images/580cb0254f4eec219bff6d192a616d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4JdTJUZXNxqJ2-2PC_ybA.png"/></div></div></figure><p id="6a7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe lq lr ls lt b">Ctrl+Shift+P</code>键盘快捷键打开命令面板，搜索“代码空间:创建计划”并继续输入。首先选择此代码空间计划将关联的Azure订阅。为此计划的资源组名称输入任意名称。如果您已经有资源组，最好保留一个不同的名称，这样，如果您在<a class="ae lp" href="https://portal.azure.com/" rel="noopener ugc nofollow" target="_blank"> Azure portal </a>中删除该资源组，所有关联的资源将被一次性删除。选择您最常使用代码空间的地区。最后输入创建的代码空间计划的名称。</p><h1 id="b586" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">在代码空间中创建开发环境</h1><p id="d808" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">让我们为开发创建一个新的代码空间环境。在代码空间面板中点击“创建新代码空间”。选择“默认设置”，即4个内核、8GB内存和30分钟自动暂停时间。将Repository留空，并输入新代码空间的名称。创建基于Linux的环境只需几秒钟，它支持最流行的工具和SDK，如Python、Node.js、PHP、Java、Docker、nvm、nvs等。，当这个新环境准备就绪时，您会看到一个通知。单击Connect，这将重新打开VS代码窗口并连接到新环境。打开新终端查看流行的bash终端。</p><h1 id="ac84" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">断开并挂起代码空间</h1><p id="cffa" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在此环境中完成任务后，您可以断开连接，然后从离开的地方重新开始。使用Codespace环境的主要好处是，你可以在任何时间任何地点使用任何浏览器。它将在30分钟不活动时暂停，因此我们将只收取存储费用，而不收取计算资源费用。</p><h1 id="e6b2" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">安装VNC服务器</h1><p id="f3be" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们可以使用代码空间环境来开发控制台和web应用程序。我们可以使用代码空间中的端口转发特性在本地计算机中打开web应用程序，以查看和测试该应用程序。如果您想将此环境用于需要GUI的桌面应用程序，我们可以安装vnc服务器，并在任何VNC查看器中打开进行调试/测试。让我们看看下面安装VNC服务器的说明。</p><p id="c6f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们刚刚创建了Linux环境，所以让我们在终端中使用下面的命令来确保首先安装所有的更新。请注意，获得所有升级需要一些时间。</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="5b34" class="mk kn iq lt b gy ml mm l mn mo">sudo apt update &amp;&amp; sudo apt dist-upgrade</span></pre><p id="a4af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以为VNC创建一个新用户，并将该用户添加到sudoers，用您的选择替换USER_NAME:</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="bbe2" class="mk kn iq lt b gy ml mm l mn mo">sudo adduser USER_NAME<br/>usermod -a -G sudo USER_NAME</span></pre><p id="a2c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在安装VNC服务器之前，我们需要一些桌面环境。代码空间环境没有自带桌面环境，所以我们安装开源轻量级桌面环境<a class="ae lp" href="https://opensource.com/article/18/6/xfce-desktop" rel="noopener ugc nofollow" target="_blank"> XFCE </a>如下:</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="e2c5" class="mk kn iq lt b gy ml mm l mn mo">sudo apt install xfce4 xfce4-goodies</span></pre><p id="9c63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装时，它会要求选择键盘布局。根据您的键盘选择。安装XFCE桌面环境后，安装VNC服务器，如下所示:</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="ee5b" class="mk kn iq lt b gy ml mm l mn mo">sudo apt install tightvncserver</span></pre><p id="20c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装VNC服务器后，以用户名登录来配置VNC服务器。您可能需要创建用户环境变量，如下所示:</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="d363" class="mk kn iq lt b gy ml mm l mn mo">export USER="USER_NAME"</span></pre><h1 id="1d28" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">配置VNC服务器</h1><p id="ba33" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">使用<code class="fe lq lr ls lt b">vncserver</code>命令设置安全密码，创建初始配置文件并启动服务器。您可以忽略只读密码。</p><p id="a32b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我们将修改配置文件以使用XFCE桌面环境，请按照以下方式停止vncserver:</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="c390" class="mk kn iq lt b gy ml mm l mn mo">vncserver -kill :1</span></pre><p id="8431" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将创建为初始配置的原始xstartup文件备份为:</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="00a3" class="mk kn iq lt b gy ml mm l mn mo">mv ~/.vnc/xstartup ~/.vnc/xstartup.bak</span></pre><p id="31fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建另一个文件(<code class="fe lq lr ls lt b">~/.vnc/xstartup</code>)并输入下面的命令，这些命令将在我们启动/重启VNC服务器时执行。</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="4977" class="mk kn iq lt b gy ml mm l mn mo">#!/bin/bash<br/>xrdb $HOME/.Xresources<br/>startxfce4 &amp;</span></pre><p id="210a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将上述文件设为可执行文件</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="0758" class="mk kn iq lt b gy ml mm l mn mo">sudo chmod +x ~/.vnc/xstartup</span></pre><p id="cf23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下列方式重新启动VNC服务器:</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="54cc" class="mk kn iq lt b gy ml mm l mn mo">vncserver</span></pre><p id="4932" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在VS代码远程资源管理器窗口中，单击代码空间详细信息中的“转发端口”，输入“5901”作为要转发的TCP端口。您可以保留建议的显示名称并输入。</p><p id="291a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用MobaXterm VNC会话连接到VNC服务器。在MobaXterm中创建一个新的VNC会话，远程主机名为“localhost”，端口为“5901”。连接到这个新的VNC会话，并输入您在上面选择的密码。当您第一次连接时，它会要求选择面板设置配置，您可以选择默认配置。你会在VNC服务器上看到XFCE桌面。</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mp"><img src="../Images/713b7c5527589bc136fe42eedd3af75e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BsSQuNf8cnfg0pbKu40FOA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">VNC服务器中的XFCE桌面环境</figcaption></figure><h1 id="5ba3" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">将VNC服务器作为服务启动</h1><p id="2dcb" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">要在每次代码空间环境启动时启动VNC服务器，让我们配置服务。创建一个文件<code class="fe lq lr ls lt b">/etc/init.d/vncserver</code>,通过替换用户、几何图形和名称，添加以下行。</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="2e9f" class="mk kn iq lt b gy ml mm l mn mo">#!/bin/bash -e<br/><br/># The Username:Group that will run VNC<br/>export USER="vsonline"<br/><br/># The display that VNC will use<br/>DISPLAY="1"<br/><br/># Color depth (between 8 and 32)<br/>DEPTH="16"<br/><br/># The Desktop geometry to use.<br/>#GEOMETRY="&lt;WIDTH&gt;x&lt;HEIGHT&gt;"<br/>GEOMETRY="1280x1024"<br/><br/># The name that the VNC Desktop will have.<br/>NAME="vsc-vnc-server"<br/><br/>OPTIONS="-name ${NAME} -depth ${DEPTH} -geometry ${GEOMETRY} :${DISPLAY}"<br/><br/>. /lib/lsb/init-functions<br/><br/>case "$1" in<br/>start)<br/>log_action_begin_msg "Starting vncserver for user '${USER}' on localhost:${DISPLAY}"<br/>su ${USER} -c "/usr/bin/vncserver ${OPTIONS}"<br/>;;<br/><br/>stop)<br/>log_action_begin_msg "Stoping vncserver for user '${USER}' on localhost:${DISPLAY}"<br/>su ${USER} -c "/usr/bin/vncserver -kill :${DISPLAY}"<br/>;;<br/><br/>restart)<br/>$0 stop<br/>$0 start<br/>;;<br/>esac<br/><br/>exit 0</span></pre><p id="4395" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将上述文件设为可执行文件，并更新服务</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="7fcf" class="mk kn iq lt b gy ml mm l mn mo">sudo chmod +x /etc/init.d/vncserver<br/>sudo update-rc.d vncserver defaults 99</span></pre><p id="74f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在要启动VNC服务器，我们可以暂停代码空间并连接或开始使用下面的命令</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="05e3" class="mk kn iq lt b gy ml mm l mn mo">sudo service vncserver start</span></pre><p id="87af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以使用以下命令检查所有服务及其状态</p><pre class="lv lw lx ly gt mg lt mh mi aw mj bi"><span id="4339" class="mk kn iq lt b gy ml mm l mn mo">sudo service --status-all</span></pre><h1 id="8ca5" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">结论</h1><p id="502e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Visual Studio Codespaces对于开发者来说是一个非常棒的基于云的环境，我们可以快速创建一个环境，测试一个应用程序，然后删除它。让VNC支持开发/测试基于GUI的应用程序也很有帮助。</p></div></div>    
</body>
</html>