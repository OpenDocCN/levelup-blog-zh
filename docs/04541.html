<html>
<head>
<title>Bundle a CSS Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">捆绑一个CSS库</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/bundle-a-css-library-6e9ff1ff8a2c?source=collection_archive---------2-----------------------#2020-07-01">https://levelup.gitconnected.com/bundle-a-css-library-6e9ff1ff8a2c?source=collection_archive---------2-----------------------#2020-07-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b863" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何用SASS、postcss和clean-css构建自己的自定义CSS库</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/63a5193e8c1180a11265b825f9f73dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktUiN4HuCz_nkRrL96xfFg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@kobuagency?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> KOBU机构</a>在<a class="ae ky" href="/s/photos/css?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d64f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们以相对分散的方式构建了DeckDeckGo😅。这是我们的网络编辑器，可以用来创建和展示幻灯片，还可以自动与我们的遥控器同步。还有一个开发者工具包，它支持HTML或markdown，甚至还有另一个版本，我们只用于在线部署您的演示文稿作为渐进式网络应用程序。</p><p id="184f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些多种应用程序和套件都有一个共同点，即它们共享完全相同的核心和功能，而不管它们的技术如何，这要归功于使用<a class="ae ky" href="https://stenciljs.com/" rel="noopener ugc nofollow" target="_blank">模板</a>制作的Web组件。</p><p id="7823" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些也必须共享相同的布局功能。例如，如果我们在全屏模式下定义了一个32px的根字体大小，它应该可以应用到任何地方，因此，应该可以在我们的eco系统中容易且一致地传播。</p><p id="2fa5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是为什么我们必须创建我们自己的自定义CSS库，也是为什么我要与你分享，你如何也可以为你自己的项目捆绑这样一个实用程序。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1ae5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">信用</h1><p id="3a94" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这个方案是由CSS框架<a class="ae ky" href="https://bulma.io/" rel="noopener ugc nofollow" target="_blank">布尔玛</a>实现的。没有必要重新发明轮子，当它已经被奇妙地解决的时候。感谢布尔玛<a class="ae ky" href="https://github.com/jgthms/bulma" rel="noopener ugc nofollow" target="_blank">开源</a>🙏。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d124" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">入门指南</h1><p id="9456" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了初始化我们的库，我们创建了一个新文件夹，例如<code class="fe mz na nb nc b">bundle-css</code>，并用一个新的<code class="fe mz na nb nc b">package.json</code>文件来描述它。它应该包含库的名称、版本、主文件，在我们的例子中是一个(即将到来的)<code class="fe mz na nb nc b">sass</code>入口文件、作者和许可证。当然，您可以添加更多的细节，但这些给了我们一个快速的基础。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="bd97" class="nh md it nc b gy ni nj l nk nl">{<br/>  "name": "bundle-css",<br/>  "version": "1.0.0",<br/>  "main": "index.scss",<br/>  "author": "David",<br/>  "license": "MIT"<br/>}</span></pre><p id="18a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一个新文件夹<code class="fe mz na nb nc b">src</code>中，我们创建了样式表文件<code class="fe mz na nb nc b">index.scss</code>。正如我在介绍中提到的<code class="fe mz na nb nc b">fullscreen</code>模式，我们可以在文件中添加一个全屏样式，将蓝色背景应用到“main”元素的子段落中。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="666a" class="nh md it nc b gy ni nj l nk nl">:fullscreen #main {<br/>  p {<br/>    background: #3880ff;<br/>  }<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="496e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">干净输出</h1><p id="87f5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可能希望确保每次构建库时，结果都不包含我们之前删除的任何样式。</p><p id="bde2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是为什么我们首先将<a class="ae ky" href="https://github.com/isaacs/rimraf" rel="noopener ugc nofollow" target="_blank"> rimraf </a>添加到我们的项目中，以便在每次构建开始时删除输出文件夹。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="f015" class="nh md it nc b gy ni nj l nk nl">npm i rimraf -D</span></pre><p id="2506" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">请注意，我们添加到项目中的所有依赖项都必须作为开发依赖项添加，因为它们都不是输出的一部分。</em></p><p id="a67a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦安装了rimraf，我们就可以通过编辑<code class="fe mz na nb nc b">package.json</code>中的<code class="fe mz na nb nc b">scripts</code>来启动我们的<code class="fe mz na nb nc b">build</code>。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="8f75" class="nh md it nc b gy ni nj l nk nl">"scripts": {<br/>  "build": "rimraf css"<br/>}</span></pre><p id="bbe2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我选择了<code class="fe mz na nb nc b">css</code>作为包含CSS输出的输出文件夹的名称。你可以使用另一个名字，重要的是将它添加到文件<code class="fe mz na nb nc b">package.json</code>中，以便将其包含在最终的包中，你可以稍后安装在你的应用程序中或发布到<a class="ae ky" href="http://npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="9070" class="nh md it nc b gy ni nj l nk nl">"files": [<br/>  "css"<br/>]</span></pre><p id="6004" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至此，合起来，我们的<code class="fe mz na nb nc b">package.json</code>应该包含以下内容:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="7b6d" class="nh md it nc b gy ni nj l nk nl">{<br/>  "name": "bundle-css",<br/>  "version": "1.0.0",<br/>  "main": "index.scss",<br/>  "scripts": {<br/>    "build": "rimraf css"<br/>  },<br/>  "files": [<br/>    "css"<br/>  ],<br/>  "author": "David",<br/>  "license": "MIT",<br/>  "devDependencies": {<br/>    "rimraf": "^3.0.2"<br/>  }<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1c1a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">厚颜无耻</h1><p id="2d88" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们正在使用<a class="ae ky" href="https://sass-lang.com/" rel="noopener ugc nofollow" target="_blank"> SASS </a>扩展来编辑样式。所以，我们要把它编译成CSS。为此，我们使用了<a class="ae ky" href="https://github.com/sass/node-sass" rel="noopener ugc nofollow" target="_blank"> node-sass </a>编译器。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="ef86" class="nh md it nc b gy ni nj l nk nl">npm i node-sass -D</span></pre><p id="e77d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们用一个新的脚本增强了我们的<code class="fe mz na nb nc b">package.json</code>,它应该负责编译成CSS，我们用我们的主<code class="fe mz na nb nc b">build</code>脚本链接它。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="6c04" class="nh md it nc b gy ni nj l nk nl">"scripts": {<br/>  "build": "rimraf css &amp;&amp; npm run build-sass",<br/>  "build-sass": "node-sass --output-style expanded src/index.scss ./css/index.css"<br/>}</span></pre><p id="6ff4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们提供输入文件，并将输出指定为编译参数。我们还使用选项<code class="fe mz na nb nc b">expanded</code>来确定CSS的输出格式。它使它具有可读性，而且，由于我们将在管道的后期缩小它，我们还没有多余的新行大小。</p><p id="17bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们通过运行<code class="fe mz na nb nc b">npm run build</code>来尝试我们的构建脚本，我们应该会发现一个从<code class="fe mz na nb nc b">SASS</code>转换成<code class="fe mz na nb nc b">CSS</code>的输出文件<code class="fe mz na nb nc b">/css/index.css</code>。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="eb74" class="nh md it nc b gy ni nj l nk nl">:fullscreen #main p {<br/>  background: #3880ff;<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="39a9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">自动修复</h1><p id="ad6e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了支持更老的浏览器和Safari，有必要给选择器<code class="fe mz na nb nc b">:fullscreen</code>加上前缀<a class="ae ky" href="https://caniuse.com/#search=fullscreen" rel="noopener ugc nofollow" target="_blank">。其他选择器也可能是这种情况。为了自动解析CSS并将供应商前缀添加到CSS规则中，使用来自</a><a class="ae ky" href="https://caniuse.com/" rel="noopener ugc nofollow" target="_blank">的值，我可以使用</a>吗，我们正在使用<a class="ae ky" href="https://github.com/postcss/autoprefixer" rel="noopener ugc nofollow" target="_blank"> autoprefixer </a>。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="aef3" class="nh md it nc b gy ni nj l nk nl">npm i autoprefixer postcss-cli -D</span></pre><p id="549b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在再次添加一个新的构建脚本到我们的<code class="fe mz na nb nc b">package.json</code>中，并且在我们已经声明的两个步骤之后链接这个步骤，因为我们的目标是一旦CSS被创建，就在值前面加上前缀。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="03ee" class="nh md it nc b gy ni nj l nk nl">"scripts": {<br/>  "build": "rimraf css &amp;&amp; npm run build-sass &amp;&amp; npm run build-autoprefix",<br/>   ...<br/>  "build-autoprefix": "postcss --use autoprefixer --map --output ./css/index.css ./css/index.css"<br/>}</span></pre><p id="42bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这个新命令，我们用新值覆盖了CSS文件，并生成了一个<code class="fe mz na nb nc b">map</code>文件，这对调试非常有用。</p><p id="f24a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们运行我们的构建管道<code class="fe mz na nb nc b">npm run build</code>，输出<code class="fe mz na nb nc b">css</code>文件夹现在应该包含一个<code class="fe mz na nb nc b">map</code>文件和我们的<code class="fe mz na nb nc b">index.css</code>输出，其前缀应该如下:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="09a3" class="nh md it nc b gy ni nj l nk nl">:-webkit-full-screen #main p {<br/>  background: #3880ff;<br/>}<br/>:-ms-fullscreen #main p {<br/>  background: #3880ff;<br/>}<br/>:fullscreen #main p {<br/>  background: #3880ff;<br/>}<br/><br/>/*# sourceMappingURL=index.css.map */</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="af99" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">最佳化</h1><p id="8463" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">越少越好，这就是为什么我们在<a class="ae ky" href="https://github.com/jakubpawlowicz/clean-css" rel="noopener ugc nofollow" target="_blank"> clean-css </a>的帮助下优化我们的CSS库。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="cd32" class="nh md it nc b gy ni nj l nk nl">npm i clean-css-cli -D</span></pre><p id="d7db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将最后一个脚本添加到我们的链中，我们能够创建一个缩小版的CSS文件。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="634f" class="nh md it nc b gy ni nj l nk nl">"scripts": {<br/>  "build": "rimraf css &amp;&amp; npm run build-sass &amp;&amp; npm run build-autoprefix &amp;&amp; npm run build-cleancss",<br/>  ...<br/>  "build-cleancss": "cleancss -o ./css/index.min.css ./css/index.css"<br/>}</span></pre><p id="c5d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们最后一次运行<code class="fe mz na nb nc b">npm run build</code>，我们现在应该在输出文件夹<code class="fe mz na nb nc b">css</code>中发现输入CSS的缩小版本。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="9beb" class="nh md it nc b gy ni nj l nk nl">:-webkit-full-screen #main p{background:#3880ff}:-ms-fullscreen #main p{background:#3880ff}:fullscreen #main p{background:#3880ff}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6851" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">总共</h1><p id="262f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">概括来说，这里的<code class="fe mz na nb nc b">package.json</code>包含了创建我们自己的定制CSS库的所有依赖项和构建步骤。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="dfc1" class="nh md it nc b gy ni nj l nk nl">{<br/>  "name": "bundle-css",<br/>  "version": "1.0.0",<br/>  "main": "index.scss",<br/>  "scripts": {<br/>    "build": "rimraf css &amp;&amp; npm run build-sass &amp;&amp; npm run build-autoprefix &amp;&amp; npm run build-cleancss",<br/>    "build-sass": "node-sass --output-style expanded src/index.scss ./css/index.css",<br/>    "build-autoprefix": "postcss --use autoprefixer --map --output ./css/index.css ./css/index.css",<br/>    "build-cleancss": "cleancss -o ./css/index.min.css ./css/index.css"<br/>  },<br/>  "files": [<br/>    "css"<br/>  ],<br/>  "author": "David",<br/>  "license": "MIT",<br/>  "devDependencies": {<br/>    "autoprefixer": "^9.8.4",<br/>    "clean-css-cli": "^4.3.0",<br/>    "node-sass": "^4.14.1",<br/>    "postcss-cli": "^7.1.1",<br/>    "rimraf": "^3.0.2"<br/>  }<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8f4d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">摘要</h1><p id="8214" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">多亏了许多开源项目，我们可以快速轻松地为自定义CSS创建一个库，这太棒了。</p><p id="2669" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的下一次演讲中尝试一下<a class="ae ky" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>，如果您准备对我们常见的<a class="ae ky" href="https://github.com/deckgo/deckdeckgo/tree/master/utils/deck" rel="noopener ugc nofollow" target="_blank"> deck </a>风格做出一些改进，我们将非常欢迎您的帮助😃。</p><p id="6287" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到无限和更远的地方！大卫</p></div></div>    
</body>
</html>