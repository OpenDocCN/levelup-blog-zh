<html>
<head>
<title>How to Use Data Binding in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android中使用数据绑定</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-use-data-binding-in-android-658fb0d139c3?source=collection_archive---------10-----------------------#2022-04-18">https://levelup.gitconnected.com/how-to-use-data-binding-in-android-658fb0d139c3?source=collection_archive---------10-----------------------#2022-04-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c0d1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你的代码更具可读性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0302f9d3751f3ca9467090c2dac90026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PCpy0yWE8pSm9lF7"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Emil Widlund 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="066c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据绑定被认为是现代android开发中的最佳实践之一。它是android jetpack的一部分。它消除了有时成本高昂的操作<code class="fe lv lw lx ly b">findViewById()</code>。数据绑定有很多好处。它使我们的代码简洁，易于维护，可读性强。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="942c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们会知道什么是数据绑定。根据官方文件</p><blockquote class="mg mh mi"><p id="5072" class="kz la mj lb b lc ld ju le lf lg jx lh mk lj lk ll ml ln lo lp mm lr ls lt lu im bi translated">数据绑定库是一个支持库，允许您使用声明性格式而非编程方式将布局中的UI组件绑定到应用程序中的数据源。</p></blockquote><h1 id="1ee8" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">我们在读什么</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/659163b658806756f50228c7ee201ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JnRXP6oQH-GPs5n8FCjpZg.jpeg"/></div></div></figure><p id="a9f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个很棒的应用程序。不是吗？</p><p id="dfa2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个应用程序是使用MVVM结构和许多其他现代android组件制作的。今天我们将看到我是如何在这个项目中实现数据绑定的。</p><p id="8b72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本文，使用这个<a class="ae ky" href="https://github.com/Farhandroid/Pexel" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> GitHub </strong> </a>存储库。请随意检查。我们开始吧</p><h1 id="8ca7" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">数据绑定在起作用</h1><p id="e0cb" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">首先，在你的应用程序模块的<code class="fe lv lw lx ly b">build.gradle</code>文件中启用<code class="fe lv lw lx ly b">dataBinding</code>构建选项。</p><pre class="kj kk kl km gt nl ly nm nn aw no bi"><span id="206a" class="np mo it ly b gy nq nr l ns nt">android {<br/>    ...<br/>    buildFeatures {<br/>        dataBinding true<br/>    }<br/>}</span></pre><p id="1013" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了生成一个绑定类，我们需要将我们的布局包装在<code class="fe lv lw lx ly b">&lt;layout&gt;&lt;/layout&gt;</code>标签中。举个例子，让我们看看下面的<code class="fe lv lw lx ly b">fragment_image_viewer.xml</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="236e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到，我不是从<code class="fe lv lw lx ly b">ConstraintLayout</code>开始，而是从<code class="fe lv lw lx ly b">&lt;layout&gt;&lt;/layout&gt;</code>标签开始。稍后我会谈到<code class="fe lv lw lx ly b">&lt;data&gt;&lt;/data&gt;</code>标签。现在设置已经完成，如果我们构建我们的项目，将会生成绑定类。</p><p id="d1a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">绑定有一个命名约定。它接受XML布局的名称，删除下划线，并使每个名称以大写字母开头。然后在末尾加上绑定。迷茫？举个例子，</p><blockquote class="mg mh mi"><p id="6632" class="kz la mj lb b lc ld ju le lf lg jx lh mk lj lk ll ml ln lo lp mm lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">fragment_image_viewer.xml -&gt; FragmentImageViewerBinding</code></p></blockquote><p id="0ad7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望现在清楚了。</p><h1 id="f1d3" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">如何访问绑定</h1><p id="a57f" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">由于构建已经完成，现在我们可以像下面这样访问绑定。</p><pre class="kj kk kl km gt nl ly nm nn aw no bi"><span id="628a" class="np mo it ly b gy nq nr l ns nt">private var _binding: FragmentImageViewerBinding? = null<br/>private val binding get<em class="mj">() </em>= _binding!!</span></pre><p id="33f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到<code class="fe lv lw lx ly b">_binding</code>的数据类型是<code class="fe lv lw lx ly b"><em class="mj"> </em>FragmentImageViewerBinding</code>。你可能会问，我们不能像正常变量一样访问<code class="fe lv lw lx ly b">FragmentImageViewerBinding</code>吗？。是的，你可以。但是在这种情况下，有可能会发生内存泄漏。如果你想知道更多关于android内存泄漏的信息，请查看这篇<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-handle-a-memory-leak-in-android-d6e7e1ea435b">文章</a>。</p><p id="a490" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之前我们使用<code class="fe lv lw lx ly b">setContentView</code>来设置布局，但是我们可以像下面这样做</p><pre class="kj kk kl km gt nl ly nm nn aw no bi"><span id="033c" class="np mo it ly b gy nq nr l ns nt">override fun onCreateView(<br/>    inflater: LayoutInflater, container: ViewGroup?,<br/>    savedInstanceState: Bundle?,<br/>): View? {<br/>    // Inflate the layout for this fragment<br/>    _binding = FragmentImageViewerBinding.inflate(inflater, container, false)<br/>    return binding.root<br/>}</span></pre><p id="57d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以使用<code class="fe lv lw lx ly b">binding</code>变量来访问我们的布局组件，并执行与布局相关的操作。例如，我们可以使用<code class="fe lv lw lx ly b">binding.textView.text = "text"</code>在文本视图中设置文本。</p><h1 id="aabd" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">什么是数据标签</h1><p id="2c8c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">前面我已经说过，我将在后面讨论<code class="fe lv lw lx ly b">&lt;data&gt;&lt;/data&gt;</code>标签。现在是时候谈谈了。</p><p id="e741" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单地说，<code class="fe lv lw lx ly b">&lt;data&gt;</code>声明有一个数据，而<code class="fe lv lw lx ly b">&lt;variable&gt;</code>标签描述了数据的名称和类型。您可以通过简单的<code class="fe lv lw lx ly b">"@{variable_name}"</code>来访问XML中的值。您可以在<code class="fe lv lw lx ly b">&lt;variable&gt;</code>标签中传递任何类型的数据以及自定义对象。这就是数据绑定的美妙之处。</p><p id="b1e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，你可以看到如下</p><pre class="kj kk kl km gt nl ly nm nn aw no bi"><span id="3516" class="np mo it ly b gy nq nr l ns nt"><em class="mj">&lt;</em>data<em class="mj">&gt;<br/>    &lt;</em>variable<br/>        name="imageSrc"<br/>        type="com.farhan.tanvir.pexels.data.model.Src" <em class="mj">/&gt;<br/>&lt;/</em>data<em class="mj">&gt;</em></span></pre><p id="e88a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里变量名是<code class="fe lv lw lx ly b">imageSrc</code>，类型是一个定制对象(在本例中是数据类)。您可以通过<code class="fe lv lw lx ly b">binding.imageSrc = imageSrc</code>从<code class="fe lv lw lx ly b">ImageViewerFragment</code>设置变量<code class="fe lv lw lx ly b">imageSrc</code>。现在你可以通过<code class="fe lv lw lx ly b">"@{imageSrc}"</code>访问布局中的<code class="fe lv lw lx ly b">imageSrc</code>变量。</p><h1 id="1a29" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">如何使用自定义数据绑定</h1><p id="0c5c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">数据绑定的另一个优点是定制。让我们创建一个自定义数据绑定，它将在ImageView中加载图像。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="31ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我创建了一个自定义绑定名称<code class="fe lv lw lx ly b">loadImageFromUrl</code>，它将在<code class="fe lv lw lx ly b">ImageView</code>中加载图像。我们可以在XML布局的ImageView中使用这个自定义绑定，如下所示。</p><pre class="kj kk kl km gt nl ly nm nn aw no bi"><span id="f0a7" class="np mo it ly b gy nq nr l ns nt"><em class="mj">&lt;</em>ImageView<br/>    loadImageFromUrl="@{imageUrl}"<br/>    android:id="@+id/wallpaperImageView"<br/>   <em class="mj">/&gt;</em></span></pre><p id="4e09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它现在将在<code class="fe lv lw lx ly b">ImageView</code>中加载图像。太棒了。不是吗？</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="058f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天到此为止。希望你学到了有用的东西。</p><p id="c3cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有什么建议，请在评论中分享。直到我们再次见面…干杯！</p><pre class="kj kk kl km gt nl ly nm nn aw no bi"><span id="5a78" class="np mo it ly b gy nq nr l ns nt"><strong class="ly iu">Want to Connect?</strong>If you want to, you can connect with me on <a class="ae ky" href="https://twitter.com/FarhanT99598254" rel="noopener ugc nofollow" target="_blank"><strong class="ly iu">Twitter</strong></a> or <a class="ae ky" href="https://www.linkedin.com/in/farhan-tanvir-b08520151/" rel="noopener ugc nofollow" target="_blank"><strong class="ly iu">LinkedIn</strong></a>.</span></pre></div></div>    
</body>
</html>