<html>
<head>
<title>How to Squeeze 50% More Memory Out of Your Raspberry Pi with zram</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用zram从您的树莓Pi中多挤出50%的内存</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-zram-to-squeeze-more-out-of-your-raspberry-pi-55be552e309a?source=collection_archive---------1-----------------------#2020-08-18">https://levelup.gitconnected.com/using-zram-to-squeeze-more-out-of-your-raspberry-pi-55be552e309a?source=collection_archive---------1-----------------------#2020-08-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0639" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我演示了如何使用zram将Raspberry Pi的可用内存增加50%以上，而性能影响可以忽略不计。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5596b6f5e41ce68414c96ea33e724af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a-EJ7Rc7wVMkxVUQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">最初发布于2020年8月17日<a class="ae ky" href="https://ikarus.sg/using-zram-to-get-more-out-of-your-raspberry-pi/" rel="noopener ugc nofollow" target="_blank"> ikarus.sg </a></figcaption></figure><p id="741c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Raspberry Pi和其他单板计算机(SBC)的内存一直很小。在<em class="lv"> Raspberry Pi 3 </em>中最大1GB，只够运行轻量级程序和脚本。这种趋势一直持续到<em class="lv">的Raspberry Pi 4 </em>和<em class="lv">的2GB </em>、<em class="lv"> 4GB </em>以及几个月后的<em class="lv"> 8GB </em>型号的出现，为运行数据库和其他内存密集型应用程序打开了大门。</p><p id="f45a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种转变在很大程度上是由于数据行业的爆炸式增长，以前SBCs的重点是物联网和嵌入式应用，现在重点正慢慢转向数据应用。近年来，内存也变得越来越便宜，允许新的SBC拥有更多内存，同时保持类似的价格范围。</p><h1 id="3591" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">我的担忧</h1><p id="d61a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">随着Raspberry Pi 3趋于过时，我开始担心我的<a class="ae ky" href="https://ikarus.sg/how-i-built-kraken/" rel="noopener ugc nofollow" target="_blank"> 28核北海巨妖集群</a>如何能够至少再保持一年的相关性和有用性。</p><p id="3113" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，我私下期待着放弃北海巨妖集群，因为我遇到过无数尴尬的情况，系统耗尽内存，所有SSH会话都被锁定，而内核在死机和强制重启之前挣扎了好<strong class="lb iu"> 10分钟</strong>。</p><blockquote class="mt mu mv"><p id="fc82" class="kz la lv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated">事实上，这种情况每周都会发生在我身上一次！如果你以前在Raspberry Pi 3上运行过很多应用程序，我相信你会和我一样痛苦。</p></blockquote><p id="f586" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过在树莓Pi论坛深处的一轮挖掘，我为树莓Pi 3即将过时和限制性内存容量的问题找到了一丝希望。</p><blockquote class="mt mu mv"><p id="4d25" class="kz la lv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated">解决方案是<strong class="lb iu"> <em class="it"> zram互换</em> </strong>。</p></blockquote><div class="mz na gp gr nb nc"><a href="https://github.com/StuartIanNaylor/zram-swap-config" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">StuartIanNaylor/zram-swap-config</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">和zram-config-0.5一样，zram-config-0.5是一个残破的包，出于许多原因不应该使用。Zram-swap-config是…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq ks nc"/></div></div></a></div><p id="b276" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将演示如何使用zram来增加大约50%的可用内存，而对性能的影响可以忽略不计。</p><h1 id="e808" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">zram是什么？</h1><blockquote class="mt mu mv"><p id="3d4e" class="kz la lv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated"><strong class="lb iu"> zram </strong>，原名<strong class="lb iu"> compcache </strong>，是一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Linux_kernel_module" rel="noopener ugc nofollow" target="_blank"> Linux内核模块</a>，用于在ram中创建一个压缩的<a class="ae ky" href="https://en.wikipedia.org/wiki/Block_device" rel="noopener ugc nofollow" target="_blank">块设备</a>，即一个<a class="ae ky" href="https://en.wikipedia.org/wiki/RAM_disk" rel="noopener ugc nofollow" target="_blank"> RAM磁盘</a>，但是带有动态“磁盘”压缩。用zram创建的块设备可以用于交换或作为通用ram磁盘。(<a class="ae ky" href="https://en.wikipedia.org/wiki/Zram" rel="noopener ugc nofollow" target="_blank">维基百科</a>)</p></blockquote><p id="2b40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在英语中，zram背后的思想基本上是留出一部分可用内存，将其用作传统<em class="lv">磁盘</em>存储的块设备，并对写入/读取的所有数据执行压缩/解压缩。</p><h1 id="f94f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">有没有性能打击？</h1><blockquote class="mt mu mv"><p id="e4a1" class="kz la lv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated">能力越大，责任越大</p></blockquote><p id="b066" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这句被广泛滥用的蜘蛛侠名言适用于大多数情况，但这是个例外。事实上，无论何时使用压缩，都会增加计算需求。但压缩是一项成熟的技术，多年来已经取得了进步，在现代处理器中，额外的计算负载是最小的，允许实时应用，如随机存取存储器。</p><p id="54d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在SBC(如Raspberry Pi 3)的情况下，在大多数自托管场景中，你更可能受到内存而不是CPU的限制，因为自托管应用程序往往相对来说CPU较少而内存较多。由于有4个可用内核和1 GB的RAM，如果不先耗尽内存，您不太可能长时间保持所有4个内核的充分利用。</p><p id="e4e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设总有一些CPU资源可用，以增加CPU利用率为代价来增加内存肯定不会产生明显的性能影响。</p><h1 id="442b" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">你能从中得到什么？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e33ea8ede04f27792f2bc9b9d6a6a547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*FG_vFJWdmHVQx5XC.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Raspberry Pi设备的内存带宽从0到4 ( <a class="ae ky" href="https://magpi.raspberrypi.org/articles/raspberry-pi-3bplus-specs-benchmarks" rel="noopener ugc nofollow" target="_blank">来源</a>)</figcaption></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="9a48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上表(<a class="ae ky" href="https://github.com/StuartIanNaylor/zram-swap-config" rel="noopener ugc nofollow" target="_blank"> Github </a>)中，我们看到了每种压缩算法的压缩比和性能。通过这些性能数据，我们可以很容易地看到，大多数压缩算法都符合实时使用条件，因为它们的压缩/解压缩吞吐量分别超过或接近所有Raspberry Pi型号的最大内存写入/读取吞吐量。</p><p id="0945" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使在最保守的情况下，仅单独使用压缩也会产生一个<em class="lv">额外的</em> <strong class="lb iu"> <em class="lv"> 108% </em> </strong> <em class="lv">的空间</em>，甚至这个估计本身也是保守的。这是因为测试假设混合了要压缩的数据类型、不可压缩的二进制数据以及文本。在内存中，大部分数据可以<em class="lv">安全地假设为文本</em>，因此真实世界的空间产量预计会大得多。</p><h2 id="6fe8" class="nu lx it bd ly nv nw dn mc nx ny dp mg li nz oa mi lm ob oc mk lq od oe mm of bi translated">例子</h2><p id="e1ef" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">假设为zram交换留出了512MiB的RAM，并假设保守的压缩率为2，那么我们将获得500MB的额外内存。</p><p id="920e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于RPi 3来说，这使得总内存达到了相对舒适的1.5GiB！</p><h1 id="b9fe" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">安装zram-swap-config</h1><p id="57a7" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">废话说够了，让我们言归正传。安装zram-swap-config只需要几个步骤。</p><p id="4c62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保安装了git:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="7ae5" class="nu lx it oh b gy ol om l on oo">$ sudo apt-get install git<!-- --> </span></pre><p id="b0aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">克隆zram-swap-config存储库:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="7387" class="nu lx it oh b gy ol om l on oo">$ git clone https://github.com/StuartIanNaylor/zram-swap-config \ &amp;&amp; cd zram-swap-config</span></pre><p id="f94c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装zram-swap-config:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="2cb1" class="nu lx it oh b gy ol om l on oo">$ chmod +x install.sh &amp;&amp; sudo ./install.sh</span></pre><p id="80ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">清理安装文件</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="439d" class="nu lx it oh b gy ol om l on oo">$ cd .. &amp;&amp; rm -r zram-swap-config</span></pre><h1 id="dea3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">配置zram交换配置</h1><p id="c699" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">zram-swap-config以相同的缺省值安装。但是如果你是那种不摆弄每一个旋钮和控制杆就绝对睡不着觉的人，你很幸运。以下是你可以调整它的方法。</p><p id="efd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编辑<code class="fe op oq or oh b">/etc/zram-swap-config.conf</code>并根据您的喜好修改以下参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="1722" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>配置中的数值仅为<strong class="lb iu">整数</strong>。</p><p id="c5eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一般来说，除了<code class="fe op oq or oh b">MEM_FACTOR</code>、<code class="fe op oq or oh b">DRIVE_FACTOR</code>和<code class="fe op oq or oh b">COMP_ALG</code>之外，你不需要关心其他任何设置。</p><p id="712b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里调整配置的想法是不要给zram-swap分配太多的内存，这样机器就不会花费太多的CPU来尝试压缩和解压缩数据，同时分配足够的内存来产生大小合适的交换空间。你可以根据自己的需要通过调整<code class="fe op oq or oh b">MEM_FACTOR</code>来微调分配。</p><p id="c47d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">配置<code class="fe op oq or oh b">DRIVE_FACTOR</code>的预计压缩比:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="5521" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，这些值是保守的，如果内存中的数据主要是文本(如日志)，实际压缩比可能会更高。</p><h1 id="5b5b" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">警告:压缩算法的可用性</h1><p id="5d81" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">查看上面的压缩算法表，人们很容易推测出<em class="lv"> zstd </em>给出了性能和压缩比的最佳平衡。然而，恐怕我不得不在这里失望了，因为<em class="lv"> zstd </em>和许多其他列出的压缩算法一样，<em class="lv">不一定在您的Linux发行版</em>中提供。</p><p id="5788" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要检查可用的压缩算法，请运行以下命令:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="0c27" class="nu lx it oh b gy ol om l on oo">$ modprobe zram &amp;&amp; cat /sys/block/zram0/comp_algorithm<br/>lzo [lz4] deflate</span></pre><p id="0e82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出将显示可用的压缩算法以及用方括号括起来的当前选择的压缩算法。</p><h1 id="ed1c" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">我的配置为Raspbian对树莓派3B</h1><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="dd63" class="nu lx it oh b gy ol om l on oo">MEM_FACTOR=25<br/>DRIVE_FACTOR=300<br/>COMP_ALG=lz4<br/>SWAP_DEVICES=1<br/>SWAP_PRI=75<br/>PAGE_CLUSTER=0<br/>SWAPPINESS=80</span></pre><ul class=""><li id="4cb2" class="os ot it lb b lc ld lf lg li ou lm ov lq ow lu ox oy oz pa bi translated"><code class="fe op oq or oh b">MEM_FACTOR</code>被设置为25，这意味着<em class="lv"> 256MiB </em>内存将被留出用于zram交换。</li><li id="8863" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><code class="fe op oq or oh b">DRIVE_FACTOR</code>被设置为300，这意味着我估计净压缩比为<em class="lv"> 3.00 </em>(仍然相对保守)。</li><li id="0b23" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><code class="fe op oq or oh b">COMP_ALG</code>被设置为<em class="lv"> lz4 </em>，因为它是Raspbian lzo、lz4和deflate中可用算法中最好的。</li></ul><h2 id="8de2" class="nu lx it bd ly nv nw dn mc nx ny dp mg li nz oa mi lm ob oc mk lq od oe mm of bi translated">此配置的快速说明</h2><ul class=""><li id="ba1a" class="os ot it lb b lc mo lf mp li pg lm ph lq pi lu ox oy oz pa bi translated"><code class="fe op oq or oh b">MEM_FACTOR</code>被设置为25，这意味着<em class="lv"> 256MiB </em>内存将被留出用于zram交换。</li><li id="a9e2" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><code class="fe op oq or oh b">DRIVE_FACTOR</code>被设置为300，这意味着我估计净压缩比为<em class="lv"> 3.00 </em>(仍然相对保守)。</li><li id="1ab3" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><code class="fe op oq or oh b">COMP_ALG</code>被设置为<em class="lv"> lz4 </em>，因为它是Raspbian lzo、lz4和deflate中可用算法中最好的。</li></ul><p id="324f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种配置将产生25%×1gb的总内存× 3.00 = 0.75GiB的交换空间。</p><h1 id="6df3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">Raspberry Pi 4B 4GB上Raspbian的配置</h1><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="cea5" class="nu lx it oh b gy ol om l on oo">MEM_FACTOR=10<br/>DRIVE_FACTOR=300<br/>COMP_ALG=lz4<br/>SWAP_DEVICES=1<br/>SWAP_PRI=75<br/>PAGE_CLUSTER=0<br/>SWAPPINESS=80</span></pre><p id="b21a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种配置将产生10%×4gb的总内存×3.00 = 1.2 GB的交换空间。</p><h1 id="f1db" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">Raspberry Pi 4B 2GB上Raspbian的推荐配置</h1><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="a497" class="nu lx it oh b gy ol om l on oo">MEM_FACTOR=15<br/>DRIVE_FACTOR=300<br/>COMP_ALG=lz4<br/>SWAP_DEVICES=1<br/>SWAP_PRI=75<br/>PAGE_CLUSTER=0<br/>SWAPPINESS=80</span></pre><p id="6d4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种配置将产生15%×2gb的总内存× 3.00 = 0.9GiB的交换空间。</p><h2 id="d68b" class="nu lx it bd ly nv nw dn mc nx ny dp mg li nz oa mi lm ob oc mk lq od oe mm of bi translated">需要注意的几点</h2><ul class=""><li id="e42d" class="os ot it lb b lc mo lf mp li pg lm ph lq pi lu ox oy oz pa bi translated">通常我的目标是大约1GB的zram交换，这是一个很好的折衷方案，你可能已经从我目前的配置中看出来了。</li><li id="b1af" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated">我发现300的<code class="fe op oq or oh b">DRIVE_FACTOR</code>对我的设置来说是最理想的，但是如果你觉得冒险或者幸运，无论如何，把<code class="fe op oq or oh b">DRIVE_FACTOR</code>增加到400。</li><li id="f469" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated">如果你没有使用Raspbian，那么你也有一个很好的机会可以使用其他压缩算法，所以一定要检查和调整！</li></ul><h1 id="6486" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">当你这么做的时候</h1><p id="a080" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果您正在安装zram-swap-config，您可能希望在您的Raspberry Pi上禁用swap。</p><p id="5456" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一般来说，无论您是否使用zram swap，都建议禁用Raspbian安装的默认swap，原因如下:</p><ol class=""><li id="fc61" class="os ot it lb b lc ld lf lg li ou lm ov lq ow lu pj oy oz pa bi translated">它会缩短您的SD卡的预期寿命，因为交换设备会受到大量和频繁的写入。</li><li id="192c" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu pj oy oz pa bi translated">考虑到SD卡糟糕的随机I/O性能，它的性能非常差。</li></ol><p id="b2c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要禁用默认交换设备:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="40d3" class="nu lx it oh b gy ol om l on oo">$ dphys-swapfile swapoff \<br/>&amp;&amp; dphys-swapfile uninstall \<br/>&amp;&amp; update-rc.d dphys-swapfile disable</span></pre><p id="cf8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，你就可以用你的树莓派3Bs在接下来的一年左右做好准备了！</p><h2 id="1616" class="nu lx it bd ly nv nw dn mc nx ny dp mg li nz oa mi lm ob oc mk lq od oe mm of bi translated">下一步是什么？</h2><p id="5c7c" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">接下来，我将介绍<em class="lv"> log2ram </em>，一种将日志写入内存以减少SD卡磨损的方法，更不用说，它还可以与zram-swap-config配合使用。回头见！</p></div><div class="ab cl pk pl hx pm" role="separator"><span class="pn bw bk po pp pq"/><span class="pn bw bk po pp pq"/><span class="pn bw bk po pp"/></div><div class="im in io ip iq"><p id="0c66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最初发表于2020年8月17日<a class="ae ky" href="https://ikarus.sg/using-zram-to-get-more-out-of-your-raspberry-pi/" rel="noopener ugc nofollow" target="_blank"> ikarus.sg </a>。</p></div></div>    
</body>
</html>