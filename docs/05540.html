<html>
<head>
<title>Angular 10 NgRX Store by Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度10 NgRX存储示例</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/angular-10-ngrx-store-by-example-afec6929bbf9?source=collection_archive---------17-----------------------#2020-09-07">https://levelup.gitconnected.com/angular-10-ngrx-store-by-example-afec6929bbf9?source=collection_archive---------17-----------------------#2020-09-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9f02552db3e7c2defe10e039c44295b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WpmAE8yXF1lkRXal"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@mikepetrucci?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Mike Petrucci </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="45aa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本教程中，我们将学习如何在Angular 10示例应用程序中使用NgRX store。我们将看到如何创建动作、减少器和分派动作。</p><p id="4e7f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Angular NgRx store是一个客户端数据管理模式，它使用RxJS observables实现了脸书发明的Redux模式。</p><p id="36f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为先决条件，您需要在本地开发机器上安装Node.js和Angular CLI，</p><h1 id="8421" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">角度10 NgRx存储示例</h1><p id="b754" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">打开一个新的命令行界面，并运行以下命令:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="6191" class="mq lf it mm b gy mr ms l mt mu">$ ng new angular10ngrx<br/>$ cd angular10ngrx</span></pre><p id="7648" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CLI将询问您几个问题—如果<strong class="ki iu">您想要添加角度路由？</strong>键入<strong class="ki iu"> y </strong>表示是，键入<strong class="ki iu">表示您希望使用哪种样式表格式？</strong>选择<strong class="ki iu"> CSS </strong>。</p><p id="29d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，使用以下命令创建一个新的角度组件:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="94eb" class="mq lf it mm b gy mr ms l mt mu">$ ng g c product</span></pre><p id="bc0e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，<code class="fe mv mw mx mm b">src/app/product</code>文件夹中的一个文件名为<code class="fe mv mw mx mm b">product.model.ts</code>的文件如下:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="85f7" class="mq lf it mm b gy mr ms l mt mu">export interface Product {<br/>  name: string;<br/>  price: number;<br/>}</span></pre><h1 id="df30" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">安装NgRx库</h1><p id="2f94" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">接下来，运行下面的命令从npm安装<code class="fe mv mw mx mm b">ngrx</code>到您的项目中，如下所示:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="cdf9" class="mq lf it mm b gy mr ms l mt mu">$ npm install @ngrx/core<br/>$ npm install @ngrx/store<br/>$ npm install @ngrx/effects</span></pre><h1 id="cb23" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">创建NgRx减速器</h1><p id="ce57" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">用下面的代码创建一个<code class="fe mv mw mx mm b">src/app/reducers</code>文件夹和一个名为<code class="fe mv mw mx mm b">product.reducer.ts</code>的文件:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="2b5e" class="mq lf it mm b gy mr ms l mt mu">// product.reducer.ts</span><span id="4c18" class="mq lf it mm b gy my ms l mt mu">import { Product } from './../product/product.model';<br/>import { Action } from '@ngrx/store';</span><span id="4ebe" class="mq lf it mm b gy my ms l mt mu">export const ADD_PRODUCT = 'ADD_PRODUCT';</span><span id="b0ac" class="mq lf it mm b gy my ms l mt mu">export function addProductReducer(state: Product[] = [], action) {<br/>  switch (action.type) {<br/>    case ADD_PRODUCT:<br/>        return [...state, action.payload];<br/>    default:<br/>        return state;<br/>    }<br/>}</span></pre><h1 id="8f70" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">配置NgRx存储</h1><p id="46a4" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">接下来，打开<code class="fe mv mw mx mm b">src/app/app.module.ts</code>文件并更新如下:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="6206" class="mq lf it mm b gy mr ms l mt mu">// app.module.ts</span><span id="fbdb" class="mq lf it mm b gy my ms l mt mu">import { StoreModule } from '@ngrx/store';<br/>import { addProductReducer } from './reducers/product.reducer';</span><span id="ffe7" class="mq lf it mm b gy my ms l mt mu"> imports: [<br/>    BrowserModule,<br/>    StoreModule.forRoot({product: addProductReducer})<br/>],</span></pre><p id="f806" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们只需将减速器送到商店。我们可以通过将动作分派给商店来更新应用程序状态。</p><p id="4bbd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，打开<code class="fe mv mw mx mm b">src/app/product/product.component.ts</code>文件，并更新如下:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="82f5" class="mq lf it mm b gy mr ms l mt mu">// src/app/product/product.component.ts</span><span id="0287" class="mq lf it mm b gy my ms l mt mu">import { Product } from './product.model';<br/>import { AppState } from './../app.state';<br/>import { Component, OnInit } from '@angular/core';<br/>import { Store } from '@ngrx/store';</span><span id="807c" class="mq lf it mm b gy my ms l mt mu">@Component({<br/>  selector: 'app-product',<br/>  templateUrl: './product.component.html',<br/>  styleUrls: ['./product.component.css']<br/>})<br/>export class ProductComponent implements OnInit {</span><span id="7c10" class="mq lf it mm b gy my ms l mt mu">  products: Observable&lt;Product[]&gt;;</span><span id="47c4" class="mq lf it mm b gy my ms l mt mu">  constructor(private store: Store&lt;AppState&gt;) {<br/>    this.products = this.store.select(state =&gt; state.product);<br/>   }</span><span id="f092" class="mq lf it mm b gy my ms l mt mu">  addProduct(name, price) {<br/>    this.store.dispatch({<br/>      type: 'ADD_PRODUCT',<br/>      payload: &lt;Product&gt; {<br/>        name: name,<br/>        price: price<br/>      }<br/>    });<br/>  }</span><span id="3eba" class="mq lf it mm b gy my ms l mt mu">  ngOnInit() {<br/>  }</span><span id="9ef4" class="mq lf it mm b gy my ms l mt mu">}</span></pre><p id="6b26" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们首先订阅商店并获取产品，然后添加一个向商店添加产品的操作。</p><p id="683c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，创建一个<code class="fe mv mw mx mm b">src/app/app.state.ts</code>文件并添加以下代码:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="0a60" class="mq lf it mm b gy mr ms l mt mu">// src/app/app.state.ts</span><span id="3e25" class="mq lf it mm b gy my ms l mt mu">import { Product } from './product/product.model';</span><span id="2b05" class="mq lf it mm b gy my ms l mt mu">export interface AppState {<br/>  readonly product: Product[];<br/>}</span></pre><h1 id="828f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">显示NgRx操作</h1><p id="5a92" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">接下来，打开<code class="fe mv mw mx mm b">src/app/product/product.component.html</code>文件，并按如下方式更新它:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="f836" class="mq lf it mm b gy mr ms l mt mu">&lt;div class="panel panel-primary"&gt;<br/>    &lt;div class="panel-body"&gt;<br/>      &lt;form&gt;<br/>        &lt;div class="form-group"&gt;<br/>          &lt;label class="col-md-4"&gt;Product Name&lt;/label&gt;<br/>          &lt;input type="text" class="form-control" #productName/&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="form-group"&gt;<br/>          &lt;label class="col-md-4"&gt;Product Price&lt;/label&gt;<br/>          &lt;input type="text" class="form-control" #productPrice /&gt;<br/>          &lt;/div&gt;<br/>          &lt;div class="form-group"&gt;<br/>            &lt;button (click) = "addProduct(productName.value, productPrice.value)" class="btn btn-primary"&gt;Add Product&lt;/button&gt;<br/>          &lt;/div&gt;<br/>      &lt;/form&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="1040" class="mq lf it mm b gy my ms l mt mu">&lt;table class="table table-hover" *ngIf="products != 0"&gt;<br/>  &lt;thead&gt;<br/>  &lt;tr&gt;<br/>      &lt;td&gt;Product Name&lt;/td&gt;<br/>      &lt;td&gt;Product Price&lt;/td&gt;<br/>  &lt;/tr&gt;<br/>  &lt;/thead&gt;<br/>  &lt;tbody&gt;<br/>      &lt;tr *ngFor="let product of products | async"&gt;<br/>          &lt;td&gt;&lt;/td&gt;<br/>          &lt;td&gt;&lt;/td&gt;<br/>      &lt;/tr&gt;<br/>  &lt;/tbody&gt;<br/>  &lt;/table&gt;</span></pre><p id="0db9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们首先创建一个表单，通过将相应的动作分派给商店来创建新产品，然后创建一个表来显示我们在商店中创建的产品。<code class="fe mv mw mx mm b">products</code>变量是一个可观察变量，所以我们使用<code class="fe mv mw mx mm b"><a class="ae kf" href="https://www.techiediaries.com/angular-10-async-pipe-observable-promise-example/" rel="noopener ugc nofollow" target="_blank">async</a></code> <a class="ae kf" href="https://www.techiediaries.com/angular-10-async-pipe-observable-promise-example/" rel="noopener ugc nofollow" target="_blank">管道来订阅</a>它。</p><p id="0f7c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用Bootstrap 4向我们的应用程序添加样式。阅读如何<a class="ae kf" href="https://www.techiediaries.com/angular-bootstrap/" rel="noopener ugc nofollow" target="_blank">将引导程序添加到Angular 10应用程序</a>。</p><p id="264f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以使用以下命令为您的应用程序提供服务:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="ea46" class="mq lf it mm b gy mr ms l mt mu">$ ng serve --open</span></pre><h1 id="4cdd" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="7202" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在这个简单的例子中，我们学习了如何在Angular 10示例应用程序中使用ngrx store。我们已经看到了如何分派动作，以及如何创建reducers。</p><p id="0011" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章最初发表在<a class="ae kf" href="https://www.techiediaries.com/angular-10-ngrx-store-example/" rel="noopener ugc nofollow" target="_blank">技术资料</a>上。</p></div></div>    
</body>
</html>