<html>
<head>
<title>Listening to Random Available Port in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Go中监听随机可用端口</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/listening-to-random-available-port-in-go-3541dddbb0c5?source=collection_archive---------4-----------------------#2022-01-04">https://levelup.gitconnected.com/listening-to-random-available-port-in-go-3541dddbb0c5?source=collection_archive---------4-----------------------#2022-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1d3908b6bba2054473a907754d7e964c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*666lh6awnAxLM2I2"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Unsplash上<a class="ae kc" href="https://unsplash.com/@mbaumi" rel="noopener ugc nofollow" target="_blank"> @mbaumi </a>的照片</figcaption></figure><p id="fd85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用Golang中随机可用的端口，可以使用<code class="fe lb lc ld le b">:0</code>。我相信端口<code class="fe lb lc ld le b">0</code>可以适用于另一种语言，就像我在python中尝试的那样。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="89a1" class="ln lo iq le b gy lp lq l lr ls">$ python -m SimpleHTTPServer 0<br/>Serving HTTP on 0.0.0.0 port 43481 ...</span></pre><p id="9091" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据<a class="ae kc" href="https://www.lifewire.com/port-0-in-tcp-and-udp-818145" rel="noopener ugc nofollow" target="_blank"> lifewire </a>，端口<code class="fe lb lc ld le b">0</code>是一个<code class="fe lb lc ld le b">non-ephemeral port</code>，它作为通配符告诉系统<strong class="kf ir">寻找任何可用的端口，特别是在Unix操作系统</strong>中。</p><h1 id="77d7" class="lt lo iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">Go代码</h1><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="13d8" class="ln lo iq le b gy lp lq l lr ls">package main</span><span id="2a1d" class="ln lo iq le b gy mq lq l lr ls">import (<br/>    "log"<br/>    "net"<br/>    "net/http"<br/>)</span><span id="2e1a" class="ln lo iq le b gy mq lq l lr ls">func createListener() (l net.Listener, close func()) {<br/>    l, err := net.Listen("tcp", ":0")<br/>    if err != nil {<br/>        panic(err)<br/>    }</span><span id="f4de" class="ln lo iq le b gy mq lq l lr ls">return l, func() {<br/>        _ = l.Close()<br/>    }<br/>}</span><span id="4401" class="ln lo iq le b gy mq lq l lr ls">func main() {<br/>    l, close := createListener()<br/>    defer close()</span><span id="6426" class="ln lo iq le b gy mq lq l lr ls">http.Handle("/", http.HandlerFunc(func(rw http.ResponseWriter, r *http.Request) {<br/>        // handle like normal<br/>    }))</span><span id="f834" class="ln lo iq le b gy mq lq l lr ls">log.Println("listening at", l.Addr().(*net.TCPAddr).Port)<br/>    http.Serve(l, nil)<br/>}</span></pre><p id="e060" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">执行它:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="4682" class="ln lo iq le b gy lp lq l lr ls">$ go run main.go <br/>2022/01/04 17:40:16 listening at 33845</span></pre><p id="1dde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读！</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><p id="618b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="my">原载于2022年1月4日</em><a class="ae kc" href="https://clavinjune.dev/en/blogs/listening-to-random-available-port-in-go/" rel="noopener ugc nofollow" target="_blank"><em class="my">https://clavinjune . dev</em></a><em class="my">。</em></p></div></div>    
</body>
</html>