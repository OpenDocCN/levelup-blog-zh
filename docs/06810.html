<html>
<head>
<title>Automatically Manage Your Fantasy Premier League Team with Python, FPL, Pandas, Docker and AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python，FPL，熊猫，Docker和AWS自动管理你的梦幻英超球队</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/automatically-manage-your-fantasy-premier-league-team-with-python-fpl-pandas-docker-and-aws-ea373097a3c7?source=collection_archive---------4-----------------------#2021-01-04">https://levelup.gitconnected.com/automatically-manage-your-fantasy-premier-league-team-with-python-fpl-pandas-docker-and-aws-ea373097a3c7?source=collection_archive---------4-----------------------#2021-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/b238992d95192302a6694719d277d0d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/0*fL9UsDvhHFw0u5P4.jpg"/></div></figure></div><div class="ab cl ju jv hu jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ij ik il im in"><p id="a9ba" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我已经更新了这个项目，使代码更简单，更容易遵循，以及使用AWS Lambda代替Fargate。你可以在这里找到更新版本<a class="ae kz" href="https://conor-aspell.medium.com/updated-automatically-manage-your-fantasy-premier-league-team-with-python-and-aws-lambda-e92eebacd93f" rel="noopener">。</a></p><p id="ee03" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我将把这个故事作为使用FPL图书馆的指南。</p></div><div class="ab cl ju jv hu jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ij ik il im in"><p id="93df" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">每年的这个时候又来了，我厌倦了更新我的幻想队，我没有和我心爱的富勒姆一起在降级区好好跑，我的幻想队在我的朋友联盟中排名最后。</p><p id="8d83" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">幸运的是，有一个很棒的Python库，<a class="ae kz" href="https://fpl.readthedocs.io/en/latest/user/installation.html" rel="noopener ugc nofollow" target="_blank"> FPL </a>，由<a class="ae kz" href="https://github.com/amosbastian" rel="noopener ugc nofollow" target="_blank">阿莫斯巴斯迪安</a>维护，用于与梦幻英超API交互。这让我们很容易获得梦幻英超联赛的数据，决定我们想要换进和换出哪些球员，并执行转会。我将通过Docker和AWS ECS Fargate向您展示如何在本赛季剩余的时间里为您管理您的团队。</p><p id="608c" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">本教程的所有代码都可以在我的Github上找到，<a class="ae kz" href="https://github.com/ConorAspell/FPL" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="aa03" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">先决条件</h1><ul class=""><li id="d9a2" class="ly lz iq kd b ke ma ki mb km mc kq md ku me ky mf mg mh mi bi translated">一支<a class="ae kz" href="https://fantasy.premierleague.com/my-team" rel="noopener ugc nofollow" target="_blank">梦幻英超</a>球队</li><li id="4261" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated"><a class="ae kz" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python </a></li><li id="a8dc" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated"><a class="ae kz" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">码头工人</a>。</li><li id="2544" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">一个<a class="ae kz" href="https://portal.aws.amazon.com/billing/signup#/start" rel="noopener ugc nofollow" target="_blank">免费AWS账户</a>。</li></ul><h1 id="fede" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">假想足球赛</h1><p id="a7d7" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">幻想足球是一种游戏，参与者担任虚拟职业英超足球队的总经理。</p><p id="a7f7" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">竞争者通过参加所有英超球员都可以参加的选秀来选择他们的球队。</p><p id="2e46" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">团队由以下人员组成:</p><ul class=""><li id="cea5" class="ly lz iq kd b ke kf ki kj km mr kq ms ku mt ky mf mg mh mi bi translated">2名守门员</li><li id="730e" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">5名防守队员</li><li id="8b4e" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">5名中场队员</li><li id="845a" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">3名前锋</li></ul><p id="02bf" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">每个球员都有一个分配给他们的值，球队的值不得超过100。球员的价值在整个赛季都在波动。每位玩家只能从一队中选择3名玩家。11名球员入选首发，4名替补。</p><p id="9948" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">然后，球员根据他们在每场比赛中的表现得分，如果一名首发球员不上场，他们将与一名替补球员交换。所有先发球员得分的总和就是比赛周比赛者的得分。所有比赛周数的总和就是一个竞争者得分的总和。</p><p id="cbaf" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">在每个比赛周之间，参赛者可以用一名球员交换另一名球员，选择一名新队长，并更换他们的首发阵容和替补队员。</p><h1 id="2a5a" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">战略</h1><p id="ab31" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">我们需要决定的第一件事是我们决定如何评价玩家的策略。我们需要两个策略，一个是选择哪个玩家退出，另一个是选择哪个玩家加入。</p><p id="db83" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">根据对去年冠军约书亚·布尔的采访，你需要的4个主要数据点是状态、比赛难度、可用性和主场/客场。你应该把那些状态不佳，不能上场，即将到来的比赛很艰难并且正在客场比赛的球员转移出去，你应该把那些状态良好，可以上场，比赛很轻松并且正在主场比赛的球员转移进来。</p><p id="9cf5" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">他还建议将表现差的球员转出，而不是转入表现好的球员。因为这个原因，我们会在球员转入之前计算出被转出的球员。</p><p id="4d7b" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">在本教程中，我们将制作一个加权指数，就像我在<a class="ae kz" href="https://conor-aspell.medium.com/how-to-use-python-and-pandas-to-pick-a-fantasy-sports-team-4fe9afe18b2d" rel="noopener">之前的一篇关于梦幻橄榄球的帖子</a>中所做的那样，并使用加权随机性来挑选出要转出和转入的球员。如果您想使用不同的策略，如神经网络，或者想包含更多的数据点，如天气预报，请随意。</p><h2 id="af17" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤1:设置FPL</h2><p id="aa9f" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">创建一个新的Python项目，激活您的<a class="ae kz" href="https://docs.python.org/3/library/venv.html" rel="noopener ugc nofollow" target="_blank">虚拟环境</a>，运行以下命令来安装FPL:</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="ed13" class="mu lb iq nl b gy np nq l nr ns">pip install fpl</span></pre><p id="2b4d" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们还需要<a class="ae kz" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>进行数据操作，以及Datetime来计算当前的游戏周:</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="7a58" class="mu lb iq nl b gy np nq l nr ns">pip install pandas<br/>pip install datetime</span></pre><h2 id="e56b" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤2:设置环境变量</h2><p id="1f12" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">为了访问我们团队的详细信息，我们需要在环境变量中存储我们的用户名、密码和用户id。你可以通过进入<a class="ae kz" href="https://fantasy.premierleague.com/" rel="noopener ugc nofollow" target="_blank">https://fantasy.premierleague.com/</a>找到你的用户id，然后选择团队&gt;游戏周历史，网址应该是这样的:<a class="ae kz" href="https://fantasy.premierleague.com/entry/6452204/transfers" rel="noopener ugc nofollow" target="_blank">https://fantasy.premierleague.com/entry/1234567/transfers</a>其中1234567是你的用户id。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi nt"><img src="../Images/5e8cc061e49d5f08a480f24b55282aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IU-QIAqeH_5gW_RdUr3QIg.png"/></div></div></figure><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="c31f" class="mu lb iq nl b gy np nq l nr ns">export EMAIL=YOUR_EMAIL<br/>export PASSWORD=YOUR_PASSWORD<br/>export USER_ID=YOUR_USER_ID</span></pre><p id="0858" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们将把代码分成main.py和update_team.py两个部分。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="cd19" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤3:认证</h2><p id="ba72" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">现在我们有了变量，我们可以使用FPL图书馆来获得我们需要的数据。FPL使用异步请求，所以所有方法都必须用“async”声明，所有请求都必须有“await”。</p><p id="6b66" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们的代码应该是这样的:</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="63b5" class="mu lb iq nl b gy np nq l nr ns">from fpl import FPL<br/>import aiohttp<br/>import asyncio</span><span id="b45a" class="mu lb iq nl b gy oa nq l nr ns">async def update(email, password,user_id):<br/>  async with aiohttp.ClientSession() as session:<br/>     fpl = FPL(session)<br/>     login = await fpl.login(email, password)<br/>     user = await fpl.get_user(user_id)</span></pre><h2 id="463a" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">第四步:获得我们当前的选择</h2><p id="1b4b" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">FPL为用户提供了一个名为“get_picks”的方法，但是我们需要当前的游戏周来调用它。为了获得当前游戏周，我们将调用另一个名为“get_gameweeks”的方法来获得所有游戏周的开始日期，然后选择未来最接近的一个作为当前游戏周。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="701a" class="mu lb iq nl b gy np nq l nr ns">gw = await fpl.get_gameweeks(return_json=True)<br/>df = pd.DataFrame(gw)<br/>today = datetime.now().timestamp()<br/>df = df.loc[df.deadline_time_epoch&gt;today]<br/>gameweek= df.iloc[0].id<br/>picks = await user.get_picks(gameweek-1)</span></pre><p id="1dc2" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">不幸的是，picks只返回球员的id，他们的位置，如果他们是队长/副队长。然而，如果我们存储id，即返回的“元素”字段，我们可以使用“get_player”方法来获得关于每个玩家的更多数据。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="92e3" class="mu lb iq nl b gy np nq l nr ns">players = [x['element'] for x in picks[gameweek-1]]<br/>picked_players = []<br/>for player in players:<br/>    p = await fpl.get_player(player, return_json=True)<br/>    picked_players.append(p.copy())<br/>picked_players = pd.DataFrame(picked_players)</span></pre></div><div class="ab cl ju jv hu jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ij ik il im in"><p id="9b33" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们现在有了一个数据框，其中包含了更多的数据，为了便于查看，我过滤掉了一些列，但这只是我当前团队的一个示例。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="a1e3" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">这里可用的数据非常有用，但是，API中有一个错误，如果一个球员本赛季没有受伤，他们就没有价值。为了避免任何错误，请使用fillna来填写任何NaNs到100。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="8a21" class="mu lb iq nl b gy np nq l nr ns">picked_players.chance_of_playing_this_round= picked_players.chance_of_playing_this_round.fillna(100)</span></pre><p id="ed8a" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们还需要一个数据，在我们选择哪个球员离开之前，这是即将到来的比赛周的设备难度等级(FDR)。</p><h2 id="ad6d" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">第四步:获得下周的日程安排</h2><p id="9396" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">FPL图书馆有一个方法叫做“get_fixtures_by_gameweek ”,我们将会用到它。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="dad2" class="mu lb iq nl b gy np nq l nr ns">fixtures = await fpl.get_fixtures_by_gameweek(gameweek, return_json=True)</span><span id="f0b1" class="mu lb iq nl b gy oa nq l nr ns">fixtures = pd.DataFrame(fixtures)</span></pre><p id="6851" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">这提供了很多信息，包括每个团队的难度等级，我们将在下一步使用。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="8618" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">第五步:计算玩家下一局游戏难度</h2><p id="c02f" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">要计算即将到来的游戏难度，我们只需从对手的难度中减去玩家团队的难度。你需要在计算玩家时再做一次，所以这应该是它自己的方法。</p><p id="cbd1" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">由于两个帧都有一个“id”字段，我们从fixes数据帧中删除了所有不必要的字段。</p><p id="af02" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">为了让球员在客场比赛，我们做了一个内部的<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html" rel="noopener ugc nofollow" target="_blank">连接</a>球员队和球队客场比赛的赛程，对主队重复，然后<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html" rel="noopener ugc nofollow" target="_blank">把两个数据帧追加</a>在一起。</p><p id="fbb5" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">在客场比赛的球员会被罚1分，在主场比赛的球员会得到1分的奖励。</p><p id="9ca4" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">由于append操作不更新索引，我们重置索引以避免该方法的任何副作用。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="7122" class="mu lb iq nl b gy np nq l nr ns">def calc_fdr_diff(players, fixes):<br/>    fixes = fixes[['team_a', "team_h", "team_h_difficulty", "team_a_difficulty"]]</span><span id="e548" class="mu lb iq nl b gy oa nq l nr ns">    away_df = pd.merge(players, fixes, how="inner", left_on=["team"], right_on=["team_a"])</span><span id="71ec" class="mu lb iq nl b gy oa nq l nr ns">    home_df = pd.merge(players, fixes, how="inner", left_on=["team"], right_on=["team_h"])</span><span id="c19b" class="mu lb iq nl b gy oa nq l nr ns">    away_df['fdr'] = away_df['team_a_difficulty']-home_df['team_h_difficulty']-1</span><span id="2272" class="mu lb iq nl b gy oa nq l nr ns">    home_df['fdr'] = home_df['team_h_difficulty']-home_df['team_a_difficulty']+1</span><span id="c62c" class="mu lb iq nl b gy oa nq l nr ns">    df = away_df.append(home_df)<br/>    df.index = range(len(df))<br/>    return df</span></pre><h2 id="1769" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">第六步:挑选一名球员转出</h2><p id="a566" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">我们将根据我们的数据创建一个指数，数值越高，意味着玩家被替换的可能性越大。我们将使它成为一个独立的方法。首先，我们要检查一名球员是否是本周比赛的球队的一员。</p><p id="1d97" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们使用<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.ravel.html" rel="noopener ugc nofollow" target="_blank"> ravel </a>将球队放在一个列表中，然后检查其球队不在该列表中的球员。我们还可以使用list comprehension来检查一个球队是否打了两场比赛，并使用<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html" rel="noopener ugc nofollow" target="_blank"> Pandas "loc" </a>函数获得一周内有两场比赛的球员。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="3592" class="mu lb iq nl b gy np nq l nr ns">def calc_player_out(players, fixtures):<br/>    teams_playing = fixtures[["team_a", "team_h"]].values.ravel()<br/>    teams_playing = pd.unique(teams_playing)<br/>    ps_not_playing = players.loc[~players.team.isin(teams_playing)]<br/>    teams_playing_twice = [x for x in teams_playing if list(teams_playing).count(x)&gt;1]<br/>    ps_playing_twice=<br/>players.loc[players.team.isin(teams_playing_twice)]</span></pre><p id="0730" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们现在将使用“<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iterrows.html" rel="noopener ugc nofollow" target="_blank"> iterrows </a>”遍历我们的玩家，并根据他们的数据计算“权重”。你可以见机行事，根据你认为合适的来改变数值，但是你应该把那些状态不好，不能上场，即将到来的比赛很艰难，正在客场比赛的球员转移出去。</p><p id="90e0" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">你也可以把它变得更加个人化，例如，如果我想让更多的富勒姆球员转会，我可以更多地为富勒姆效力。</p><p id="daf0" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们使用Pandas的“<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sample.html" rel="noopener ugc nofollow" target="_blank"> sample </a>”方法返回新的数据帧，其中包含权重和基于权重选择的行。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="3639" class="mu lb iq nl b gy np nq l nr ns">df1 = pd.DataFrame(columns=players.columns.tolist())<br/>for x in players.iterrows():</span><span id="1677" class="mu lb iq nl b gy oa nq l nr ns">weight = 25<br/>    weight-= x[1]['fdr']*3<br/>    weight-= float(x[1]['form'])*4<br/>    weight += (100-float(x[1]['chance_of_playing_this_round']))*0.2<br/>    if x[1]['id'] in ps_not_playing['id']:<br/>         weight+=25<br/>    if x[1]['id'] in ps_playing_twice['id']:<br/>         weight -=25<br/>    if weight &lt; 0:<br/>        weight = 0<br/>    x[1]['weight'] = weight<br/>    df1 = df1.append(x[1])<br/>return df1,df1.sample(1, weights=df1.weight)</span></pre><p id="e569" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">这就产生了这样的重量:</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="d34d" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">价值越高，他们被替换的可能性越大，所以若日尼奥、谢尔维和拉卡塞特最有可能被替换。</p><h2 id="5d93" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">第七步:过滤掉不合格的玩家</h2><p id="bd2e" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">在我们挑选球员转会之前，我们应该移除所有不合格的球员。如果一名球员使我们的预算超过了100米的限制，如果他们与我们现有的3名球员为同一支球队效力，如果他们是我们现有的球员之一，或者如果他们踢的位置与我们被转移出去的球员不同，那么这名球员就没有资格。</p><p id="bdc1" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们可以通过使用user的“last_deadline_bank”方法，然后加上我们替换的球员的成本，来获得我们的剩余预算。</p><p id="f297" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们可以通过制作一个<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html" rel="noopener ugc nofollow" target="_blank">数据透视表</a>并统计所有有三个条目的团队来得到无效团队。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="d932" class="mu lb iq nl b gy np nq l nr ns">budget = user.last_deadline_bank+player_out.now_cost.iloc[0]</span><span id="f5b0" class="mu lb iq nl b gy oa nq l nr ns">dups_team = picked_players.pivot_table(index=['team'], aggfunc='size')</span><span id="132d" class="mu lb iq nl b gy oa nq l nr ns">invalid_teams = dups_team.loc[dups_team==3].index.tolist()</span></pre><h2 id="db0e" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated"><strong class="ak">步骤8:在</strong>中选择要转会的球员</h2><p id="c9b9" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">FPL有一个叫“获取球员”的方法，让我们可以得到所有可用的球员。我们将使用它来获得所有可用的球员，但是，API将它作为一个对象返回，所以我们需要使用一个list comprehension来将其转换为一个字典列表，然后我们使用前面步骤中的变量来过滤掉不符合条件的球员。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="be21" class="mu lb iq nl b gy np nq l nr ns">potential_players = await fpl.get_players()<br/>player_dict = [dict(vars(x)) for x in potential_players]<br/>df=  pd.DataFrame(player_dict)<br/>df = df[~df['team'].isin(invalid_teams)]<br/>df = df[(df.now_cost&lt;budget)]<br/>df= df.loc[~df['id'].isin(picked_players['id'].tolist())]<br/>df = df.loc[df.element_type==player_out.element_type.iloc[0]]</span></pre><p id="0a48" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">这个数据有一个相同的错误，如果一个球员在赛季中没有受伤，它将有一个“这一轮比赛机会”的NaN值。这可以用<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html" rel="noopener ugc nofollow" target="_blank"> fillna </a>修复。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="d41b" class="mu lb iq nl b gy np nq l nr ns">df.chance_of_playing_this_round = df.chance_of_playing_this_round.fillna(100.0)</span></pre><p id="ff66" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们可以重新使用我们之前制作的“calc_fdr_diff”方法来获得所有没有被过滤掉的玩家的难度。在此之前，我们应该重置索引并删除播放器</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="f198" class="mu lb iq nl b gy np nq l nr ns">picked_players.index = range(15)<br/>rows_to_drop=player_out.index.values.astype(int)[0]<br/>picked_players=picked_players.drop(rows_to_drop)<br/>df = calc_fdr_diff(df, fixtures)</span></pre><p id="1eb7" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">接下来，我们需要对所有球员进行称重。我们将使用一种类似的方法来衡量球员，但我们希望更好的球员的价值更高，此外，由于有200+潜在的选择，将有一个合理的机会，其中一个底部的选择将被选中，所以我们将过滤掉除了前10名以外的所有人。</p><p id="790b" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">数据框架中有大量数据，如果你想将你的权重建立在其他东西的基础上，比如提供的“影响力、创造力、威胁”指数，你可以这样做。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="818a" class="mu lb iq nl b gy np nq l nr ns">def calc_player_in(df, fixtures):</span><span id="9194" class="mu lb iq nl b gy oa nq l nr ns">    df1 = pd.DataFrame(columns=df.columns.tolist())<br/>    teams_playing = fixtures[["team_a", "team_h"]].values.ravel()<br/>    teams_playing = pd.unique(teams_playing)</span><span id="d446" class="mu lb iq nl b gy oa nq l nr ns">    teams_playing_twice = [x for x in teams_playing if list(teams_playing).count(x)&gt;1]</span><span id="a291" class="mu lb iq nl b gy oa nq l nr ns">    ps_not_playing = df.loc[~df.team.isin(teams_playing)]<br/>    ps_playing_twice=df.loc[df.team.isin(teams_playing_twice)]<br/>    for x in df.iterrows():<br/>        weight = 0.1<br/>        weight+= x[1]['fdr']*3<br/>        weight+= float(x[1]['form'])*4<br/>        weight -= (100-float(x[1]['chance_of_playing_this_round'])) * 0.2</span><span id="553a" class="mu lb iq nl b gy oa nq l nr ns">        if weight &lt; 0:<br/>            weight = 0<br/>        if x[1]['id'] in ps_not_playing['id']:<br/>            weight+=5<br/>        if x[1]['id'] in ps_playing_twice['id']:<br/>            weight -=5<br/>        if float(x[1]['form']) ==0:<br/>            weight=0<br/>        if weight &lt; 0:<br/>            weight = 0<br/>        x[1]['weight'] = weight<br/>        df1 = df1.append(x[1])</span><span id="46c9" class="mu lb iq nl b gy oa nq l nr ns">    df1=df1.sort_values('weight', ascending=False).iloc[0:10]<br/>    return df1.sample(1, weights=df1.weight)</span></pre><p id="92ec" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">这导致这10名球员被选中考虑。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="35f1" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">这些玩家之间的体重差异很小，所以很可能评分最高的玩家不会被选中，随机抽样为我选择了Neto。</p><h2 id="8b52" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤9:执行转移</h2><p id="9767" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">FPL图书馆有一个执行球员转会的方法，叫做“转会”,你可以把球员外出和球员进入的id作为一个列表传入。如果你想进行多次转移，你可以传递多个玩家id。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="e4e5" class="mu lb iq nl b gy np nq l nr ns">transfer= await user.transfer(player_out.id.tolist(), player_in.id.tolist())</span></pre><p id="06e8" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">API有一个问题，它有时会无缘无故地抛出一个错误，如果它不起作用，就将代码包装在try/except块中。</p><h2 id="a9a9" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤9a:选择队长</h2><p id="6fba" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">不幸的是，由于你的用户团队直到下一个游戏周开始才在API中更新，如果你想改变你的队长或替补，你将无法选择你已经替补的球员。您可以不将您的球员添加到您的“挑选的球员”数据框中，并运行以下代码行来确定该轮的最佳队长，使用选择被替换的球员的权重。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="8c57" class="mu lb iq nl b gy np nq l nr ns">captain=picked_players.sort_values(by=['weight']).iloc[0].id</span></pre><h2 id="c226" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤9b:选择接头</h2><p id="a982" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">制定替补名单有点麻烦，因为FPL直到比赛周开始才会更新你选择的球队，所以你需要将你的球员编号分配给你的球员编号，计算出你的球员编号的权重，并将你的球员编号附加到你选择的球员中。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="85b0" class="mu lb iq nl b gy np nq l nr ns">player_in['id'] =player_out['id'].iloc[0]<br/>player_in, null_value=calc_player_out(player_in, fixtures)<br/>picked_players=picked_players.append(player_in)</span></pre><p id="311f" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">然后，我们需要将我们挑选的球员分为守门员和外场球员，并选出最佳守门员和10名最佳外场球员。</p><p id="6187" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">然后，我们将比较应该首发的球员和已经首发的球员，并列出两份名单，一份是替补球员名单，另一份是替补球员名单。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="4b6a" class="mu lb iq nl b gy np nq l nr ns">players_to_sub_in, players_to_sub_out = calc_subs(picked_players, players[0:11], players[11:15])</span><span id="ebfc" class="mu lb iq nl b gy oa nq l nr ns">for i in range(0, len(players_to_sub_in)):<br/>    s = await user.substitute([players_to_sub_in[i]],[players_to_sub_out[i]])</span><span id="64f8" class="mu lb iq nl b gy oa nq l nr ns">def calc_subs(picked_players, current_starters, current_subs):<br/>    goalkeepers=picked_players.loc[picked_players.element_type=="1"]<br/>    outfield = picked_players.loc[picked_players.element_type!=1]<br/>    goalie = goalkeepers.sort_values(by=['weight']).iloc[0].id<br/>    goalie_out = goalkeepers.sort_values(by=['weight']).iloc[1].id<br/>    squad=outfield.sort_values(by=['weight']).iloc[0:10].id.tolist()<br/>    squad.append(goalie)<br/>    players_to_sub_in = []<br/>    players_to_sub_out = []<br/>    for player in picked_players.id.tolist():<br/>        if player in squad and player in current_subs:<br/>            players_to_sub_in.append(player)<br/>        if player not in squad and player in current_starters:<br/>            players_to_sub_out.append(player)<br/>    return players_to_sub_in, players_to_sub_out</span></pre><h2 id="0b6a" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤10:添加检查以查看代码是否应该运行:</h2><p id="3640" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">AWS使用Rates和CRON表达式来触发任务。这些用于每X天/小时/年运行一次代码。由于梦幻英超联赛的比赛周是不一致的，有时需要3天，有时7天，我们将每天运行我们的代码，如果比赛周在第二天开始，我们将运行代码。</p><p id="c90c" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们将使用“get_gameweeks”函数，就像我们之前需要查找当前游戏周时所做的那样。然后我们得到今天的时间戳，加上一天得到明天的时间戳。找到下一个截止日期时间戳，如果截止日期比明天更近，检查将通过，我们的团队将更新。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="71c4" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤10:记录代码</h2><p id="62ee" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">Docker是一种将代码放入容器的方式。容器允许开发人员将应用程序与它需要的所有部分打包在一起，比如库和其他依赖项，并作为一个包进行部署。在将容器部署到AWS ECS Fargate之前，我们将制作容器并让它运行。</p><p id="15c6" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">在制作Dockerfile文件之前，您需要用pip定义一个requirements.txt文件。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="a001" class="mu lb iq nl b gy np nq l nr ns">pip freeze &gt; requirements.txt </span></pre><p id="ae7a" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">此外，有一个env.list文件使得本地测试变得更容易，因为它定义了您需要的所有环境变量，所以您不必在命令行中定义它们。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="38fc" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">docker文件应该是这样的。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="6ef8" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">我们只需要复制相关文件，设置工作目录并声明环境变量。</p><p id="12d1" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">要构建Dockerfile文件，请运行以下命令</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="06b2" class="mu lb iq nl b gy np nq l nr ns">docker build -t fantasy .</span></pre><p id="23e1" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">然后使用这个命令运行程序。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="3143" class="mu lb iq nl b gy np nq l nr ns">docker run --env-file env.list -it fantasy python main.py Docker</span></pre><p id="ac85" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">如果由于任何原因遇到问题，运行以下命令进入docker shell。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="3fa5" class="mu lb iq nl b gy np nq l nr ns">docker run -it fantasy-premier-league bash</span></pre><p id="b226" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">然后您可以运行这些命令来运行容器中的代码。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="3390" class="mu lb iq nl b gy np nq l nr ns">cd code<br/>python main.py</span></pre><h2 id="a5d6" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤11:将容器推送到AWS弹性容器注册中心</h2><p id="fa1b" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">有了AWS，你可以登录并使用菜单，也可以使用命令行界面，我已经在之前介绍过如何用<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/creating-twitch-highlights-and-posting-daily-to-reddit-with-python-docker-and-aws-ecs-fargate-c9127eeb72bd">命令行界面做类似的事情。如果你想的话，你可以照着做，但是在这篇文章中，我会告诉你如何让代码按照菜单的时间表运行。</a></p><p id="adc4" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">进入<a class="ae kz" href="https://eu-west-1.console.aws.amazon.com/ecr/repositories?region=eu-west-1" rel="noopener ugc nofollow" target="_blank">弹性容器注册中心</a>，点击“创建存储库”。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ob"><img src="../Images/e3f321f506c3d1832a5df652679c7b62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6Am9AIPaVYbd5Yu7N9jzQ.png"/></div></div></figure><p id="2922" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">在表单中，将您的存储库命名为“fantasy ”,并将其他内容保留为默认值。单击表单末尾的“创建存储库”。</p><p id="758b" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">您应该在ECR主页上看到类似这样的内容。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oc"><img src="../Images/ac37f8a194d06aaf83122fed7ce2ef4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQWzbFWX64elzEmUrgOX4A.png"/></div></div></figure><p id="3ebe" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">点击你的存储库，你会看到右上角有一个“推送命令”的图片。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi od"><img src="../Images/aad57bcc0f2fc6734df3754dae9031a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VShQ2HvbD8h7z5gVg1mIKw.png"/></div></div></figure><p id="3e71" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">在这里运行4个命令，您的映像将被推送到ECR。</p><h2 id="d7f8" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤12:创建集群和任务定义</h2><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oe"><img src="../Images/b51e2801606abeff5fff801674714b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNEV8MC8_0_Lk_e7lKumEA.png"/></div></div></figure><p id="4e6a" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">在左侧菜单中，单击“群集”，选择“仅联网”，然后点击“下一步”。将你的集群命名为“幻想”，选中“创建一个新的VPC”并点击“创建”。当它完成时，进入侧边导航的“任务定义”并点击“创建一个新的任务定义”。</p><ul class=""><li id="f318" class="ly lz iq kd b ke kf ki kj km mr kq ms ku mt ky mf mg mh mi bi translated">选择“Fargate”发射类型</li><li id="4a3c" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">给你的任务命名，我把它命名为“幻想”</li><li id="ed99" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">对于任务角色，选择“无”</li><li id="07cb" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">对于任务执行角色，让Amazon为您创建一个新角色</li><li id="f295" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">对于任务内存，选择1GB，vCPU选择. 5</li><li id="0fb5" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">单击“添加容器”按钮</li><li id="9c36" class="ly lz iq kd b ke mj ki mk km ml kq mm ku mn ky mf mg mh mi bi translated">使用您的容器存储库中的值填写如下</li></ul><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi of"><img src="../Images/833ac616b76f09bd3306a7e7bbf83c69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7nlMiDCvvdncUrpATdtklg.png"/></div></div></figure><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi og"><img src="../Images/e6784bb52bb155cbcc760e102eba2968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JgAptk-4hZpbbZ_MpcmnVg.png"/></div></div></figure><p id="4a56" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">点击表格末尾的“创建”。</p><h2 id="655b" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤13:运行任务</h2><p id="b2f2" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">在屏幕开始处选择操作-&gt;运行任务。将所有内容保留为默认值，然后单击“运行任务”。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oh"><img src="../Images/35cfad9f1943af8137c8ea6c62795d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7TA1716RIJUmo2ZacRYpVA.png"/></div></div></figure><p id="1168" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">您应该会看到这样的菜单:</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oi"><img src="../Images/63340efc20f6b36b7ddfe73c853e970b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2d57McpFkfYPJZZaFS1anA.png"/></div></div></figure><p id="b587" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">如果您单击该任务，您可以看到它正在打印的日志及其状态。</p><h2 id="fb98" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">步骤14:创建计划任务</h2><p id="8d03" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">回到“幻想”集群菜单，从菜单中选择“预定任务”并点击“创建”</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oc"><img src="../Images/2eb5333cbb410093bbf6d42dddebd299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrUqHHEM1kNok8j07dtB_w.png"/></div></div></figure><p id="b217" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">填写姓名和id为“幻想”，选择幻想任务定义。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oj"><img src="../Images/867f613d1a0a8654479c3d2ee237d293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p6a6ZqwSunZL9D9LE2wWFg.png"/></div></div></figure><p id="1927" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">点击“创建预定任务”,如果一切都已经设置好了，你应该会看到这个页面。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ok"><img src="../Images/110be9445bae5e648a698ca6908eb8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQYL-3CmzRcH_9mVbek4cA.png"/></div></div></figure><p id="9daa" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">如果你回到“幻想”集群，你应该看到“任务计划”下的任务。</p><figure class="ng nh ni nj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ol"><img src="../Images/38da9d524394b2ae6f32b067bb7a0b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fv0GzNxhSF5rsc42kxF4g.png"/></div></div></figure><h2 id="4ce5" class="mu lb iq bd lc mv mw dn lg mx my dp lk km mz na lo kq nb nc ls ku nd ne lw nf bi translated">结束语</h2><p id="5b63" class="pw-post-body-paragraph kb kc iq kd b ke ma kg kh ki mb kk kl km mo ko kp kq mp ks kt ku mq kw kx ky ij bi translated">你的梦幻团队现在应该可以安全离开了，它会在每个游戏周之前持续更新，你不需要做任何事情。我们使用了FPL图书馆、熊猫、Docker和AWS。</p></div><div class="ab cl ju jv hu jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ij ik il im in"><p id="3fe9" class="pw-post-body-paragraph kb kc iq kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ij bi translated">如果你觉得这很有用，请随意鼓掌或在LinkedIn上与我联系。</p></div></div>    
</body>
</html>