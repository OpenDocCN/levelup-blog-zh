<html>
<head>
<title>Learn How to Create Chainable Methods in Javascript With a Practical Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过一个实际的例子了解如何用Javascript创建可链接的方法</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/learn-how-to-create-chainable-methods-in-javascript-with-a-practical-example-da8ed81d560d?source=collection_archive---------4-----------------------#2020-01-22">https://levelup.gitconnected.com/learn-how-to-create-chainable-methods-in-javascript-with-a-practical-example-da8ed81d560d?source=collection_archive---------4-----------------------#2020-01-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2c28f61b08ebc7ce0ed026edf9e84eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1ioMvhxv605YxHpN1agnQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">来自<a class="ae kc" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3481377" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae kc" href="https://pixabay.com/users/analogicus-8164369/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3481377" rel="noopener ugc nofollow" target="_blank">类比</a>图像</figcaption></figure><blockquote class="kd ke kf"><p id="3827" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这篇文章最初出现在我的博客上</p></blockquote><p id="9517" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">链接是编程中一个强大的概念。当您在返回的对象上调用方法而没有重新赋值时，就会发生这种情况。假设您有一个<code class="fe li lj lk ll b">users</code>对象:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="09be" class="lu lv iq ll b gy lw lx l ly lz">const users = [<br/>  {fname: ‘Joseph’, lname: ‘Ada’, age: 12},</span><span id="44b5" class="lu lv iq ll b gy ma lx l ly lz">  {fname: ‘Bernard’, lname: ‘Rutsell’, age: 81},</span><span id="de86" class="lu lv iq ll b gy ma lx l ly lz">  {fname: ‘Thompson’, lname: ‘Josaih’, age: 41},</span><span id="f56e" class="lu lv iq ll b gy ma lx l ly lz">  {fname: ‘Dayo’, lname: ‘Adeoye’, age: 17}</span><span id="5d56" class="lu lv iq ll b gy ma lx l ly lz">]</span></pre><p id="2436" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">你的任务是过滤掉18岁以上的用户。我们可以用下面不使用方法链接的代码做到这一点:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="86ab" class="lu lv iq ll b gy lw lx l ly lz">// get all the ages from the user objects<br/>const ages = users.map(user =&gt; user.age)</span><span id="9dfa" class="lu lv iq ll b gy ma lx l ly lz">// only retain ages that are less than 18<br/>const under18 = ages.filter(age =&gt; age &lt; 18);</span><span id="476e" class="lu lv iq ll b gy ma lx l ly lz">console.log(ages); // [ 12, 81, 41, 17 ]</span><span id="d058" class="lu lv iq ll b gy ma lx l ly lz">console.log(under18) // [ 12, 17 ]</span></pre><p id="bf8e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">(如果你不知道<code class="fe li lj lk ll b">map</code>或<code class="fe li lj lk ll b">filter</code>是做什么的，请查看我的另一个帖子，在那里我用简单的英语解释了这些方法，<a class="ae kc" href="https://solathecoder.hashnode.dev/a-common-sense-explanation-of-javascript-array-methods-ck2gq53m200jjwks1hedlpeb5" rel="noopener ugc nofollow" target="_blank">Javascript数组方法的常识解释</a>。)</p><p id="2059" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">Javascript数组方法可以链接在一起，这意味着我们可以执行<code class="fe li lj lk ll b">map</code>操作和<code class="fe li lj lk ll b">filter</code>操作，而不必先重新分配返回值:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="4e47" class="lu lv iq ll b gy lw lx l ly lz">const under18Chained = users<br/>                         .map(user =&gt; user.age)<br/>                         .filter(age =&gt; age &lt; 18);</span><span id="845f" class="lu lv iq ll b gy ma lx l ly lz">console.log(under18Chained); // [ 12, 17 ]</span></pre><p id="7b9a" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">由于<code class="fe li lj lk ll b">map</code>返回一个数组，我们可以在返回的数组上调用<code class="fe li lj lk ll b">filter</code>,而不必重新分配<code class="fe li lj lk ll b">map</code>返回的内容。</p><p id="ce98" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">最流行的JavaScript框架也实现了链接。例如，我们可以在jQuery中这样做:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="6ed1" class="lu lv iq ll b gy lw lx l ly lz">_$(‘button’)<br/>         .mousover(function () { console.log(‘mouse over’) })</span><span id="229f" class="lu lv iq ll b gy ma lx l ly lz">         .click(() =&gt; alert(‘clicked’));</span></pre><p id="a97b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在这篇文章中，我们将编写一个<code class="fe li lj lk ll b">Validator</code>函数，它也允许方法链接，在这篇文章结束时，我们将能够做到这一点:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="20c0" class="lu lv iq ll b gy lw lx l ly lz">Validator(40)<br/>   .num().min(0).max(5)</span></pre><p id="5d33" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">validator函数接受一个数字(40)并检查它是否是一个数字，是否不小于0，以及是否不大于5。在这种情况下，<code class="fe li lj lk ll b">40</code>无法通过第二次测试(<code class="fe li lj lk ll b">max(5)</code>)</p><p id="bfe8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kj ir">注意</strong>:要跟进，你可以在任何现代浏览器的控制台中输入代码，或者使用JS Bin。或者您所知道的任何其他执行JavaScript代码的方式:)。</p><h1 id="1cd6" class="mb lv iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated"><strong class="ak">方法链接是如何工作的</strong></h1><p id="3ab2" class="pw-post-body-paragraph kg kh iq kj b kk my km kn ko mz kq kr lf na ku kv lg nb ky kz lh nc lc ld le ij bi translated">当我们在上面的例子中链接<code class="fe li lj lk ll b">map</code>和<code class="fe li lj lk ll b">filter` </code>时。我们可以这样做，因为<code class="fe li lj lk ll b">map</code>函数返回了一个数组——所有的数组都有一个可以在其上调用的<code class="fe li lj lk ll b">filter </code>方法。<code class="fe li lj lk ll b">filter</code>也返回一个数组，我们也可以将其他数组方法链接到它。所以链接方法的关键是方法返回什么。</p><p id="979d" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">JavaScript中的每个数组都从<code class="fe li lj lk ll b">Array.prototype</code>对象继承方法，所以我们可以访问这些数组方法(<code class="fe li lj lk ll b">filter</code>、<code class="fe li lj lk ll b">map</code>、<code class="fe li lj lk ll b">reduce</code>等等)，即使我们没有定义它们！JavaScript中的数组也是一个对象。</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="4307" class="lu lv iq ll b gy lw lx l ly lz">users<br/>  .map(user =&gt; user.age) // returns an array with `filter` as a property</span><span id="1d27" class="lu lv iq ll b gy ma lx l ly lz">  .filter(age =&gt; age &lt; 18); // returns an array too!</span></pre><p id="13dd" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">如果我们想实现我们的验证器函数，用一个参数(在本例中是一个数字)调用<code class="fe li lj lk ll b">Validator</code>应该返回一个属性为<code class="fe li lj lk ll b">num()</code>的<em class="ki">对象</em>。当我们调用<code class="fe li lj lk ll b">num()</code>时，它也应该返回一个属性为<code class="fe li lj lk ll b">min() </code>的对象，而<code class="fe li lj lk ll b">min()</code>应该返回一个属性为<code class="fe li lj lk ll b">max()</code>的对象。这里的技巧是让它们返回同一个对象，这个对象将有<code class="fe li lj lk ll b">min</code>、<code class="fe li lj lk ll b">num</code>和<code class="fe li lj lk ll b">max</code>作为它的属性！</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="964f" class="lu lv iq ll b gy lw lx l ly lz">Validator(40) // returns an object with ‘num’ as a property<br/>   .num() // returns an object with ‘min’ as a property</span><span id="6a33" class="lu lv iq ll b gy ma lx l ly lz">   .min(0) // returns an object with ‘max’ as a property</span><span id="1270" class="lu lv iq ll b gy ma lx l ly lz">   .max(5)</span></pre><h1 id="6d3c" class="mb lv iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated"><strong class="ak">分步实施</strong></h1><p id="978c" class="pw-post-body-paragraph kg kh iq kj b kk my km kn ko mz kq kr lf na ku kv lg nb ky kz lh nc lc ld le ij bi translated">让我们定义一个<code class="fe li lj lk ll b">Validator</code>函数，它返回一个将<code class="fe li lj lk ll b">num </code>作为方法的对象:</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8ee5" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这个<code class="fe li lj lk ll b">num</code>方法返回真或假，这实际上没有什么帮助。我们希望<code class="fe li lj lk ll b">num </code>返回与<code class="fe li lj lk ll b">Validator</code>相同的对象。为此，重新编写<code class="fe li lj lk ll b">Validator</code>如下:</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4afd" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在我们可以链<code class="fe li lj lk ll b">num</code>而不破坏东西！—但这仅发生在第一个<code class="fe li lj lk ll b">num</code>通过时，我们目前正在返回失败时的<code class="fe li lj lk ll b">false</code>，调用<code class="fe li lj lk ll b">false.num()</code>将导致错误。要理解我的意思，试试这个:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="9406" class="lu lv iq ll b gy lw lx l ly lz">// the first num() returns false, the second `num` call results in an error<br/>console.log(Validator(“A”).num().num());</span><span id="b8e8" class="lu lv iq ll b gy ma lx l ly lz">// TypeError: Validator(…).num(…).num is not a function…</span></pre><p id="ae8e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">为了解决这个问题，当测试失败时，我们也需要返回<code class="fe li lj lk ll b">actions</code>——但是当测试失败时，我们也会包含错误消息。</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="9efa" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">酷毙了。任何使用我们函数的人都可以检查<code class="fe li lj lk ll b">errors</code>数组是否为空以进行验证。例如，假设我们使用这个函数来验证用户输入:</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="d527" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">将变量age更改为类似于<code class="fe li lj lk ll b">const age = ‘hello’</code>的字符串，然后运行代码，您会得到:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="a91a" class="lu lv iq ll b gy lw lx l ly lz">Error: Expected elem to be a number!</span></pre><p id="66d8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在你明白了，让我们实现<code class="fe li lj lk ll b">min</code>方法。</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b7a1" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">酷:)</p><p id="0d11" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">你能实施<code class="fe li lj lk ll b">max</code>方法吗？它与<code class="fe li lj lk ll b">min</code>方法非常相似。在检查以下解决方案之前，请先试用一下:</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0b49" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">你现在明白了。我们已经成功地编写了可链接的方法！我们正在成为JavaScript忍者！:)</p><h1 id="54e5" class="mb lv iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated"><strong class="ak">增加更多功能</strong></h1><p id="8c0b" class="pw-post-body-paragraph kg kh iq kj b kk my km kn ko mz kq kr lf na ku kv lg nb ky kz lh nc lc ld le ij bi translated">在约鲁巴语中，<code class="fe li lj lk ll b">jara</code>这个词的意思是添加超过严格必要的东西，我们已经完成了这个帖子想要做的，但我们还可以做得更多。再来补充一下<code class="fe li lj lk ll b">jara</code>:)。</p><p id="60f7" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们将让该函数的使用者能够指定一个可选的错误消息，如下所示:</p><pre class="lm ln lo lp gt lq ll lr ls aw lt bi"><span id="87e5" class="lu lv iq ll b gy lw lx l ly lz">Validator(5)<br/> .num(‘Please input a number’)</span><span id="cb2f" class="lu lv iq ll b gy ma lx l ly lz"> .min(5, ‘Make sure the number is at least 5’)</span><span id="436c" class="lu lv iq ll b gy ma lx l ly lz"> .max(20, ‘Too big! The number should not be more than 20’)</span></pre><p id="1ed1" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">如果没有给出错误消息，那么我们返回默认的错误消息。请在检查解决方案之前尝试实现这一点！一..2..走吧。</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2f08" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">你想出了同样的解决方案吗？还是用了条件语句(<code class="fe li lj lk ll b">if…else</code>)？Javascript现在支持默认参数，我已经在上面使用过了！条件语句也解决了这个问题，但是缺省参数方法更简洁。</p><h1 id="bf2d" class="mb lv iq bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated"><strong class="ak">结论</strong></h1><p id="90b7" class="pw-post-body-paragraph kg kh iq kj b kk my km kn ko mz kq kr lf na ku kv lg nb ky kz lh nc lc ld le ij bi translated">感谢您读到这里！我打赌这是值得的。如果你像我喜欢写这篇文章一样喜欢读这篇文章，(打字…对吗？:) )请在社交媒体上分享，你可以在twitter上关注我<a class="ae kc" href="https://twitter.com/solathecoder" rel="noopener ugc nofollow" target="_blank"> @solathecoder </a>。</p><h2 id="2cae" class="lu lv iq bd mc nf ng dn mg nh ni dp mk lf nj nk mo lg nl nm ms lh nn no mw np bi translated">介意加点捷瑞吗？</h2><p id="9b7b" class="pw-post-body-paragraph kg kh iq kj b kk my km kn ko mz kq kr lf na ku kv lg nb ky kz lh nc lc ld le ij bi translated">你能扩展<code class="fe li lj lk ll b">Validator</code>函数来验证电子邮件、布尔或/和字母数字吗？试试看，你可以在下面的评论区放下你的代码，我会很高兴看到你想出什么。</p><p id="a43c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">黑客快乐！</p></div></div>    
</body>
</html>