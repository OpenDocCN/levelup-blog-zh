<html>
<head>
<title>Why Your Python Version (or other apps) Don’t Work on the Apple MacBook M1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么你的Python版本(或其他应用)不能在苹果MacBook M1上运行</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/why-your-python-version-or-other-apps-dont-work-on-the-apple-macbook-m1-416af07de57b?source=collection_archive---------0-----------------------#2021-07-14">https://levelup.gitconnected.com/why-your-python-version-or-other-apps-dont-work-on-the-apple-macbook-m1-416af07de57b?source=collection_archive---------0-----------------------#2021-07-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="effb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等等，不要后悔你的购买！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4e744debfc8889e8f99b448dd2daf363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jiJ5Cmlaef8OmR9rqlI9kA.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">来源:<a class="ae lb" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2F9to5mac.com%2F2020%2F11%2F11%2Fapples-m1-chip-analysis%2F&amp;psig=AOvVaw3S5WNLXL1ZdzWndnpjkxJ9&amp;ust=1626349970947000&amp;source=images&amp;cd=vfe&amp;ved=0CAoQjRxqFwoTCJCrlPS_4vECFQAAAAAdAAAAABAE" rel="noopener ugc nofollow" target="_blank"> 9to5Mac </a></figcaption></figure><p id="7edc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">苹果MacBooks太神奇了。在过去几年中，它们提供了一致的性能和效率，使它们成为开发人员的首选(尽管它们有点💰昂贵的💰比其他选择更好)。这篇文章不会深入比较不同的选择，但是如果你买了新的苹果MacBook和M1芯片，你可能想通读一下。</p><p id="e1fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">昨天，我买了一台装有新M1芯片的苹果MacBook Pro，在为我的开发项目进行设置时，我立即遇到了一个问题。我的一个项目使用Python 3.6 &amp;因为它是一个已部署的项目，仅仅为了与我时髦的新伙伴兼容而改变Python版本将是一个灾难💥！</p><p id="570d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们开始解决这个问题之前，让我们更详细地了解一下新的M1芯片。</p><h1 id="2c63" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">什么是新的M1芯片&amp;是什么让它与众不同？</h1><p id="af28" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">苹果硅M1芯片是该公司的第一个片上系统(SoC)，也是苹果硅芯片家族中第一个基于ARM的芯片。</p><p id="e6a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">M1是一款8核5纳米处理器，采用统一内存架构。这使得使用M1的Mac电脑比使用单独的CPU、GPU、RAM和其他组件的Mac电脑性能更快。M1还声称在使用过程中具有更高的性能和更好的能效。此外，该芯片将首次允许iPhone和iPad应用程序在Mac上运行。</p><p id="0de1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到目前为止，您可能已经使用了基于Intel的MAC或基于x86_64架构的笔记本电脑。这意味着您可能习惯使用的所有应用程序或软件都是使用针对这些英特尔或AMD (x86_64)处理器编写的指令编写的。</p><p id="2939" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是有了M1芯片，事情就变了。处理器无法再理解x86_64指令，因此，您的一些程序可能无法使用M1。</p><p id="75c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mf">尽管值得注意的是，越来越多的应用程序正在与新的M1芯片兼容。</em></p><h1 id="9112" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">你现在可以在装有M1芯片的苹果MacBook上运行Python了</h1><p id="e2e8" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">Python 3.9.1成为第一个支持macOS 11 Big Sur的语言版本，进而支持M1驱动的MacBooks。</p><p id="ef54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我完全知道你在想什么:</p><blockquote class="mg"><p id="9590" class="mh mi iq bd mj mk ml mm mn mo mp kk dk translated">但是等等，Python 3.9.1还挺新的，我升级的话我的app可能会坏。这是否意味着我的新MacBook不好？</p></blockquote><p id="4c87" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">绝对不行。</p><h1 id="9ca2" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">你好，罗塞塔2号！</h1><p id="47aa" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">Rosetta 2是一款仿真器，旨在为英特尔和苹果处理器之间的过渡搭建桥梁。简而言之，它翻译为英特尔构建的应用程序，以便它们可以在苹果芯片上运行。</p><p id="b94f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">耶！所以我的旧应用&amp;我将来可能开发的任何应用，无论如何都能在新芯片上运行？别急，伙计。以下是苹果对Rosetta的评价:</p><blockquote class="mg"><p id="c2e8" class="mh mi iq bd mj mk ml mm mn mo mp kk dk translated">Rosetta旨在简化向Apple silicon的过渡，给你时间为你的应用程序创建一个通用的二进制文件。它不能替代创建应用程序的本地版本。</p></blockquote><p id="5564" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">那么，罗塞塔到底是做什么的？据苹果公司称，</p><blockquote class="mg"><p id="0f56" class="mh mi iq bd mj mk ml mm mn mo mp kk dk translated">如果可执行文件只包含英特尔指令，macOS会自动启动Rosetta并开始翻译过程。翻译完成后，系统会启动翻译后的可执行文件来代替原始文件。然而，翻译过程需要时间，因此用户可能会感觉到翻译后的应用程序启动或运行速度有时会变慢。</p></blockquote><p id="61ad" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">更多关于Rosetta翻译环境<a class="ae lb" href="https://developer.apple.com/documentation/apple-silicon/about-the-rosetta-translation-environment" rel="noopener ugc nofollow" target="_blank">的信息请点击这里</a>。</p><p id="03eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以通过运行以下命令来安装Rosetta环境:</p><pre class="km kn ko kp gt mv mw mx my aw mz bi"><span id="d0fe" class="na ld iq mw b gy nb nc l nd ne">softwareupdate —-install-rosetta</span></pre><p id="b8ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">值得一提的是，您可以在Rosetta下运行整个终端，尽管我不确定这样做是否明智。</p><p id="6195" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前往Finder &gt;应用程序&gt;实用程序&gt;右键单击终端应用程序并选择“显示简介”。选中“使用Rosetta打开”复选框，然后关闭。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6d75e60d45576a90c419483b32662cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*uptbM95w2d4Ejzdi39dPFA.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">来源:我的MacBook Pro</figcaption></figure><p id="313a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mf">在文章的最后，我有一个关于罗塞塔的有趣事实要告诉你。让我们专注于让我们的Python 3.6环境在新的MacBook上工作。</em></p><h1 id="258d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">创建Python 3.6虚拟环境</h1><p id="22f7" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">为了实现这一点，我们将使用Nix包管理器。Nix是一个跨平台的包管理器，它利用了一个纯粹的功能性部署模型，在这个模型中，软件被安装到通过加密哈希生成的唯一目录中。</p><p id="7a76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们按照下面的步骤。</p><h2 id="e3f7" class="na ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">1.启用Rosetta</h2><p id="c958" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">通过运行上面给出的几行命令来安装Rosetta。</p><h2 id="1631" class="na ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">2.安装Nix</h2><p id="fc60" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">这将在您的Mac上安装Nix。下一步是在您的<code class="fe nr ns nt mw b">.zprofile</code>中创建一个条目——您的shell的环境配置。这使我们能够通过shell使用nix。</p><pre class="km kn ko kp gt mv mw mx my aw mz bi"><span id="819d" class="na ld iq mw b gy nb nc l nd ne">sh &lt;(curl -L <a class="ae lb" href="https://nixos.org/nix/install" rel="noopener ugc nofollow" target="_blank">nixos.org/nix/install</a>) — darwin-use-unencrypted-nix-store-volume</span></pre><h2 id="434d" class="na ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">3.设置Nix以用于您的shell</h2><p id="95b4" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">如果您的主目录中还没有<code class="fe nr ns nt mw b">.zprofile</code>，请使用touch命令创建一个。执行此操作时，请确保您在主目录中。</p><pre class="km kn ko kp gt mv mw mx my aw mz bi"><span id="3203" class="na ld iq mw b gy nb nc l nd ne">touch .zprofile</span></pre><p id="c6a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后打开它，将这一行添加到文件中。</p><pre class="km kn ko kp gt mv mw mx my aw mz bi"><span id="a011" class="na ld iq mw b gy nb nc l nd ne">source ~/.nix-profile/etc/profile.d/nix.sh</span></pre><p id="4546" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很好，现在您应该能够从shell访问nix了。我建议重新启动终端，以确保一切正常！</p><h2 id="395d" class="na ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">4.用Nix获得一个临时的Python 3.6 Shell</h2><p id="cbbd" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">使用以下命令启动Python 3.6的Nix Shell。</p><pre class="km kn ko kp gt mv mw mx my aw mz bi"><span id="370b" class="na ld iq mw b gy nb nc l nd ne">nix-shell -p python36</span></pre><p id="f64f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将创建一个Python 3.6环境，您可以使用它来安装包。还有最后一步！</p><h2 id="a4a6" class="na ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">5.在您的IDE中配置Python解释器</h2><p id="3ac0" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">一旦你安装了这些包，剩下唯一要做的事情就是将你的IDE Python解释器指向我们在上一步中创建的那个。</p><p id="725f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用PyCharm，所以我按照下面的步骤配置了python解释器。</p><pre class="km kn ko kp gt mv mw mx my aw mz bi"><span id="b3bf" class="na ld iq mw b gy nb nc l nd ne">PyCharm &gt; Preferences &gt; Project &gt; Python Interpreter &gt; Add New &gt; Existing Environment</span></pre><p id="1688" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您需要额外的帮助来为PyCharm配置Python解释器，这里有到<a class="ae lb" href="https://www.jetbrains.com/help/pycharm/creating-virtual-environment.html" rel="noopener ugc nofollow" target="_blank">文档</a>的链接。</p><p id="10f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于Visual Studio代码，请查看这篇<a class="ae lb" href="https://code.visualstudio.com/docs/python/environments" rel="noopener ugc nofollow" target="_blank">文章</a>。</p><p id="eb18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，这就是这篇文章的全部内容。等等，我之前答应过你一个关于罗塞塔的有趣事实，不是吗？对…</p><h1 id="1796" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">罗塞塔，我以前听过这个名字！</h1><p id="371f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">苹果以前用过Rosetta这个名字。当它将Mac从PowerPC处理器迁移到英特尔芯片时，它使用相同的名称来执行相同的功能——使PowerPC应用程序能够在英特尔芯片上运行。</p><p id="58f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然名称和目标保持不变，但旧版本的Rosetta和我们今天使用的版本之间有很大的不同，因为苹果已经开发了目标处理器，这意味着它完全知道Rosetta需要做什么。</p><p id="3d61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是不是很牛逼？😍</p></div></div>    
</body>
</html>