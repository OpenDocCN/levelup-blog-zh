<html>
<head>
<title>5 Tricks For Better Debugging in Visual Studio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Visual Studio中更好地调试的5个技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/5-tricks-for-better-debugging-in-visual-studio-1f4b896577c1?source=collection_archive---------10-----------------------#2020-10-28">https://levelup.gitconnected.com/5-tricks-for-better-debugging-in-visual-studio-1f4b896577c1?source=collection_archive---------10-----------------------#2020-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ea22c96d904aed986df0791b5b712078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fiQMXGj3BUWdU9cf"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">安德烈斯·西蒙在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0975" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于大多数开发人员来说，调试往往是一种痛苦的经历。在本文中，我将向您展示一些技巧，它们将使您的调试体验更加舒适。我将用C#做例子，但是这些方法也应该适用于Visual Studio支持的其他语言。</p><h1 id="e8e0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">重写ToString方法:</h1><p id="80fc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Visual Studio调试器将实际使用此方法在IDE中显示对象的字符串表示形式。因此，让我们假设您已经实现了一个Name类，它具有名和姓的属性，看起来可能像这样。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="5d4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在您想在调试器中检查示例数组。您可能会看到类似这样的内容:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/40bc23de2ce0646af08f1f7b5a486329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sdfc81Dw_y88TjMN0PZhRQ.png"/></div></div></figure><p id="f5fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然您可以选择展开所有name对象并检查字段是否包含您期望的值，但这有点乏味。相反，让我们覆盖Name类上的ToString方法，这样代码看起来像这样:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="278c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们再次调试相同的代码路径时，我们的“局部变量”窗口提供了一个更好的概览，显示正在发生的事情:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/32fef48e55378772e9feab60ab21d50b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PfBOd5Vi-CI1c5fW_iZl_Q.png"/></div></div></figure><p id="2088" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，数组中的每个元素都提供了对象所包含内容的描述性字符串，您不需要展开它就可以看到内容。选择一个描述性的文本并不总是简单的，特别是当你有很多属性的复杂对象的时候。对于简单的对象，我一般推荐这种方法。这是因为它也将很好地复合。当检查更复杂的对象时，如果这些对象的属性已被ToString方法覆盖，则不必在对象结构中深入几层来查找要查找的数据。您越快了解数据的大致情况，就能越快地进行调试。</p><h1 id="f454" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用条件断点:</h1><p id="3153" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在你作为软件开发人员的职业生涯中，你可能设置了很多断点，但是其中有多少是有条件的呢？顾名思义，条件断点是一个只有在执行到达断点时某个条件成立时才会中断的断点。</p><p id="50ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这对于那些令人讨厌的情况非常有用，在这些情况下，您在一个循环中有一个断点，然后必须在每次迭代中检查数据。所以最后你自己做了一个循环，检查，F5，检查，F5，检查，F5…哎呀，你是不是不小心按了F5，跳过了相关的点？请重试并重新开始。这是一个麻烦，条件断点将把你从这个麻烦中解救出来。</p><p id="f361" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要设置条件断点，请放置常规断点，然后右键单击它，选择conditions，输入您的条件，最后点击close。注意你的断点现在有一个加号，表示它是有条件的。在本例中，只有当Name对象的LastName属性与“Lohmann”匹配时，循环中的断点才会中断执行。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/1f52af7d4726ef5551352e7f828df1c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YehBAlEjiLF-9Mlyy1TTdw.png"/></div></div></figure><p id="4a7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用条件断点还可以省去在循环中编写空条件的麻烦，这些条件只用于触发简单的断点。完成调试会话后，必须再次移除的代码。</p><h1 id="7e8e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用手表</h1><p id="9cb9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">监视是一项功能，调试器将在执行过程中跟踪对象的某些属性的变化。如果您在一个代码库上工作，其中复杂的对象被传递给许多不同的方法，这些方法改变了这些对象的状态，那么这就特别有用。在调试会话期间，当执行在断点处停止时，可以放置一个监视器。手表至少有两种摆放方式。第一种是在调试会话期间右键单击变量或字段，然后选择Add Watch。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/30b51a4216b164bcf7cfd3b50f578fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*teDKwUzDUF3B9BhsqsE6eQ.png"/></div></div></figure><p id="6e06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本例中，我为Name变量的FirstName属性添加了一个监视。但是，我可能没有确切的属性来直接监视代码中断点附近的访问，在断点处停止执行。这就是放置手表的第二种方式变得方便的地方。你可以在你的本地窗口放置一块手表。假设我们想要监视LastName属性，该属性在断点所在的代码中不存在。在这种情况下，我们在调试器中向前跳几步，直到name变量被初始化，并使用“局部变量”窗口检查它。这里我们找到了LastName属性，右键单击并选择Add Watch。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/82eba4227d9741a5285e85b26b0290e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJLdYZuDpsl9h1VpEL7BbQ.png"/></div></div></figure><p id="60ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将在LastName属性上放置一个监视，然后您可以对其进行跟踪。一旦为给定的变量或属性创建了监视，它将出现在监视选项卡中，在上面的示例中也可以看到。每次该值改变时，该窗口都会用新值更新。这允许您简单地单步执行代码，并在值发生变化时进行调查。您也可以右键单击监视，让调试器在监视值发生变化时中断执行。</p><h1 id="e5e4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在执行中来回跳转</h1><p id="7a22" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当您在调试器中运行代码时，控制流不是单行道。您可以随意在当前方法中来回移动指令指针。通过向左前后拖动黄色小箭头，可以跳过部分代码，或者重复已经执行过的部分。这对于重新运行你知道没有副作用的部分可能是有用的，你想更好地理解它。它对于检查代码的某一部分是否显示幂等属性也很有用。</p><h1 id="3a24" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">修改本地数据</h1><p id="7f79" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">您的调试器还赋予您修改数据的能力，您可以右键单击可修改的局部变量，并为它们选择另一个值。这允许您试验您的代码在不同环境下的行为，或者快速跟踪执行到有趣的事情发生的状态。请注意，这里您并不局限于原语。要为上一示例中的name变量指定一个新值，您可以输入:</p><pre class="me mf mg mh gt mp mq mr ms aw mt bi"><span id="b356" class="mu lc iq mq b gy mv mw l mx my">new Name("Claes Jacob", "Baunspieler")</span></pre><p id="2ad7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">name变量将被赋给一个用上面使用的参数构造的新对象。您还可以引用执行上下文中的现有变量，包括数组中的元素，这些变量可以使用索引器来访问。</p><h1 id="7900" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">额外提示:编写一个单元测试</h1><p id="5256" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">既然您已经深入研究了您的代码，并且确定了您要寻找的bug最初是在哪里以及如何出现的，那么深呼吸一下。在您着手修复它之前，您应该考虑为它编写一个测试用例。首先，通过为这个问题编写一个测试用例，并观察它的失败，您验证了您已经正确地识别了这个问题，以及导致它的输入。第二，如果有人后来不小心重新引入了这个bug，它现在会显示为一个小的失败测试用例。这应该有望让开发人员清楚地识别出他或她破坏了什么，从而消除了长时间调试会话的需要。记住，毕竟最好的调试会话是那些你不必做的。</p><h2 id="0cea" class="mu lc iq bd ld mz na dn lh nb nc dp ll ko nd ne lp ks nf ng lt kw nh ni lx nj bi translated">结论</h2><p id="ee68" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Visual Studio调试器是一个强大的工具，它提供了相当多的功能，可以帮助您跟踪代码中的问题。其中一些我看到人们经常使用，其他的不太常用。我希望这个简短的指南已经用足够的新知识武装了你，这样你将会有更短但更有成效的调试会话。</p></div></div>    
</body>
</html>