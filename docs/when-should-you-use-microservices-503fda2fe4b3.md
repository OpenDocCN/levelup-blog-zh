# 什么时候应该使用微服务？

> 原文：<https://levelup.gitconnected.com/when-should-you-use-microservices-503fda2fe4b3>

## 软件架构的圣杯可能不是神圣的

![](img/fb16a6ff2dcbd5c03819e7f39385ae14.png)

费德里科·贝卡里在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

在过去的十年里，软件在我们的日常生活中扮演的角色大大增加了。计算机越来越成为我们生活中几乎每一个方面的固有部分。我们使用手机与全球各地的人们进行交流和互动，位于全球数据中心的数百万台计算机处理我们所有的财务流量，并帮助我们有效地运营我们的业务。

以前，软件系统必须处理成百上千的用户，而现在，一些系统可以处理数百万甚至数十亿的用户。十年前，没有多少系统能够处理这些负载。

可伸缩性成为热门话题。为了让应用程序更好地扩展，一系列技术和架构创新被推向世界。MongoDB 出现了，这是一个真正的，NoSQL，*网络规模的*数据库，它将缓解许多大公司在使用传统数据库时遇到的规模问题。

除了这些技术创新，微服务、最终一致性和事件源等架构模式在软件工程社区中也获得了支持。这些架构模式为传统的、单一的应用程序所面临的扩展问题提供了一个解决方案，承诺使公司能够向他们的客户交付高性能、可扩展的解决方案，同时减少开发时间。

一晃十年过去了，你几乎听不到任何人惊呼“*让我们建造一个庞然大物！*“再也不会了。微服务已经成为现代软件架构事实上的标准。但是它们总是正确的选择吗？

在本文中，我们将讨论选择软件架构时的一些考虑因素。微服务是默认的好选择吗？

# 你需要秤吗？

虽然单块应用程序不能很好地伸缩的说法是正确的，但人们可以提出相反的论点，即大多数应用程序并不真正需要伸缩。

像[网飞这样的公司已经精心撰写了关于他们如何运行微服务](https://www.nginx.com/blog/microservices-at-netflix-architectural-best-practices/)来解决他们遇到的扩展问题的文章，并描述了运行它们的最佳实践。这些都是可以使用的优秀资源，通过彻底理解它们的架构可以学到很多东西。

我们必须意识到，这些架构选择在像网飞这样的公司环境中是有意义的。这些公司同时为全球数百万甚至数十亿用户提供服务。

为了让他们做到这一点，他们需要设计他们的软件，使其在水平和垂直两个方向上不断扩展。如果做不到这一点，他们可能真的会破产。

然而，大多数公司不像谷歌或网飞。它们同时为数百、数千甚至数万用户提供服务。与大公司服务的用户数量相比，这只是一小部分。

在选择架构时，*仔细考虑你的领域是否面临微服务可以解决的规模问题*。对于大多数领域和项目来说，monoliths 实际上是一个非常好的选择。

![](img/0c62520eb2e2134edb15d50d3023aa61.png)

照片由[马修·施瓦茨](https://unsplash.com/@cadop?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄

# 你能负担得起开销吗？

权力越大，责任越大。开发任何规模的微服务都会带来其他类型的应用程序所没有的开销。

例如，在单一应用程序中，数据库通常是共享的。可能有一两个抽象来标准化数据库访问，但通常从任何其他模块获取一条信息只不过是注入一个依赖项(如果有的话)并进行一次方法调用。

微服务之间的交互通常通过消息或 API 进行编排。这些都需要仔细设计，版本化，并与其余的景观一起推出。更改消息契约可能会导致另一个完全不相关的系统崩溃，而您的团队在开发时并不知道这一点。

另一件要考虑的事情是，虽然在应用程序之间发送消息相对来说是微不足道的，但是有成百上千的框架、库和其他东西来实际发送消息。消息协议、格式和命名的某种形式的标准化可能是有用的。

这些考虑对开发团队的影响是相当大的。向系统添加特性与实际设计系统是完全不同的，当系统是一个更大的系统的一部分时更是如此。团队需要能够承担这一重任，因此需要有足够经验和知识的人来指导他们完成这一重任。或者把它留给架构师，随着环境的发展，他们将花费越来越多的时间来设计服务之间的交互。

在选择架构时，*考虑您的架构选择对您的团队为他们所服务的业务提供高质量、有价值的特性的能力的影响*。如果拥有一个架构减慢了开发速度，那么它可能不是正确的架构。

# 您是否遵循最佳实践？

最佳实践是伟大的。它们是一种在特定情况下该做什么的集体知识。问题是，即使没有几百个，也有几十个，它们在给定的上下文中都是有意义的。盲目地遵循和应用它们是没有任何意义的。这适用于代码级和架构设计决策。

如果决定采用微服务的主要原因之一是因为它遵循了最佳实践，那么退一步，三思而后行。

当决定软件架构时，架构师的工作是为给定的问题设计最佳的解决方案。如果一个应用程序不需要伸缩，但是架构师选择了一个允许它强烈伸缩的架构，那么他们就没有做好工作。一点也不。

你看，无论何时决定一个架构，开发团队都必须跟着做。他们不能心血来潮就决定改变整个设计。这是一种锁定。因此，架构决策很有分量。

需要仔细考虑那些不能轻易恢复的架构决策。除非在架构师工作的领域内建立了最佳实践，否则不应该盲目地遵循它。因为它适用于不同的公司和不同的问题，并不意味着它适用于所有的问题。

在选择架构时，*仔细考虑哪些最佳实践是适用的，以及它们如何应用于您在*中操作的领域中的一系列问题。因为被广泛认为是最佳实践而选择错误的架构可能会导致在国际象棋中被称为失策的一步棋。

# 结论

当然，本文只是触及了做出大型架构决策时所涉及内容的表面。比我更有经验、专业知识和智慧的人已经写了关于这个主题的整本书。这篇文章的关键要点是，不应该轻视架构设计的选择。它们应该是定制的，以解决特定于最终将使用它们的领域、业务和开发团队的问题。

这就是挑战所在——如果做得好，会有巨大的回报！—关于软件架构。任何架构师都需要拥有关于可用模式、最佳实践的广泛知识，以及足够的工程知识，以做出正确的架构决策。

如果说有什么不同的话，一个好的架构师不会把自己局限在大公司的流行事物上，或者在简历或工作清单上什么样的技术会看起来有趣。有时候，无聊的选择可能是正确的。不要害怕提出来。如果一个给定的问题最好由 SQL 数据库支持的单一应用程序来解决，那么尽一切办法去做吧。

无论你做出什么样的设计决定，都要确保你仔细考虑了它们，写下你做出这些决定的理由，并和其他能给你提供高质量反馈的人讨论你的决定和理由。好的架构决策就是这样做出的。