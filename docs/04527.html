<html>
<head>
<title>Grouping Array Elements With Dictionary in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中用字典对数组元素分组</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/grouping-array-elements-with-dictionary-in-swift-db2be2f0332b?source=collection_archive---------14-----------------------#2020-06-30">https://levelup.gitconnected.com/grouping-array-elements-with-dictionary-in-swift-db2be2f0332b?source=collection_archive---------14-----------------------#2020-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0780" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">只有一行代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e4a2d2b6ebee7347c04e8d41112cc729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*onnh6A5TFnROhyxQ"/></div></div></figure><p id="e8c5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq">本文原载于2020年6月30日</em><a class="ae lr" href="https://swiftsenpai.com/swift/group-array-elements-with-dictionary/" rel="noopener ugc nofollow" target="_blank"><em class="lq">https://swiftsenpai.com</em></a><em class="lq">。</em></p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="a668" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">假设您有一个由<code class="fe lz ma mb mc b">Device</code>个对象组成的数组，您想按类别对它们进行分组，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi md"><img src="../Images/39d5f3e2a48419013dd380bdeecfc1b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*anemrMe8H1FYgUzy"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">按类别对设备对象分组</figcaption></figure><p id="2e1a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你应该怎样着手解决这个问题？</p><p id="b43c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在Swift 5之前，最直接的方法是遍历阵列中的每个设备，并手动将每个元素分配到其各自的类别。在Swift 5中，苹果公司引入了一个通用字典初始化器，帮助开发者只用一行代码就能处理这种情况。</p><p id="505c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">想知道如何做到这一点？请继续阅读，了解更多信息。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="bedf" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">初始化简介(分组:依据:)</h1><p id="f18e" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">在Swift 5中，苹果引入了“分组依据”字典初始化器。根据<a class="ae lr" href="https://developer.apple.com/documentation/swift/dictionary/3127163-init" rel="noopener ugc nofollow" target="_blank">文档</a>，初始化器具有以下定义:</p><blockquote class="nf"><p id="64fb" class="ng nh it bd ni nj nk nl nm nn no lp dk translated"><em class="np">创建一个新字典，其键是给定闭包返回的分组，其值是返回每个键的元素的数组。</em></p></blockquote><p id="e260" class="pw-post-body-paragraph ku kv it kw b kx nq ju kz la nr jx lc ld ns lf lg lh nt lj lk ll nu ln lo lp im bi translated">为了更好地理解这个定义，让我们重温一下在本文开头看到的例子。</p><p id="d38f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">假设您有一个<code class="fe lz ma mb mc b">Device</code>结构和一个<code class="fe lz ma mb mc b">Device</code>对象数组，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="ade8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了按类别对所有的<code class="fe lz ma mb mc b">Device</code>对象进行分组，我们可以通过给字典的初始化器一个源数组和一个返回分组键的闭包来初始化字典。看看下面的代码片段:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="961f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如你所见，我们只需要传入<code class="fe lz ma mb mc b">Device</code>数组并返回类别作为分组键，初始化器会为我们处理分组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/a2bf295c3d47039d75d4ef9c1c46ff81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qRLIxFqWGpoz6TMd"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated"><code class="fe lz ma mb mc b">Dictionary.init(grouping:by:)</code>在行动</figcaption></figure><p id="b368" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们甚至可以通过使用Swift中的<a class="ae lr" href="https://www.hackingwithswift.com/sixty/6/8/shorthand-parameter-names" rel="noopener ugc nofollow" target="_blank">速记参数名称</a>将上述代码片段进一步简化为一行代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3068" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很整洁不是吗？</p><p id="9273" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上面的例子展示了使用初始化器的最标准的方式。然而，因为初始化器允许我们定义一个闭包来决定分组键，所以比这灵活得多。</p><p id="f5e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过使用相同的<code class="fe lz ma mb mc b">deviceArray</code>，假设我们想要将所有苹果产品分组在一起，我们实际上可以定义一个闭包来检查设备的名称，并将所有名称包含“Macbook”和“iPhone”的设备分组在一起。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="c265" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">按自定义对象分组</h1><p id="7dfd" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">在这一节中，我们将看看如何使用自定义对象作为<code class="fe lz ma mb mc b">init(grouping:by:)</code>初始化器的分组键。</p><p id="770a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">出于演示的目的，让我们通过定义一个<code class="fe lz ma mb mc b">Company</code>结构并向<code class="fe lz ma mb mc b">Device</code>结构添加一个<code class="fe lz ma mb mc b">company</code>变量来更新前面的例子。稍后，我们将尝试按公司对所有设备进行分组。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="1001" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，让我们检查一下<code class="fe lz ma mb mc b">Dictionary</code>结构的定义，找出成为字典键需要满足的要求。</p><pre class="kj kk kl km gt ny mc nz oa aw ob bi"><span id="02b1" class="oc mj it mc b gy od oe l of og">public struct Dictionary&lt;Key, Value&gt; where Key : Hashable</span></pre><p id="443d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从上面的定义可以看出，任何符合<a class="ae lr" href="https://developer.apple.com/documentation/swift/hashable" rel="noopener ugc nofollow" target="_blank"> Hashable </a>协议的对象都可以作为字典键使用。</p><blockquote class="oh oi oj"><p id="7e8a" class="ku kv lq kw b kx ky ju kz la lb jx lc ok le lf lg ol li lj lk om lm ln lo lp im bi translated"><strong class="kw iu">亲提示:</strong></p><p id="0d6f" class="ku kv lq kw b kx ky ju kz la lb jx lc ok le lf lg ol li lj lk om lm ln lo lp im bi translated"><em class="it">查看这篇伟大的</em> <a class="ae lr" href="https://medium.com/better-programming/what-is-hashable-in-swift-6a51627f904" rel="noopener"> <em class="it">文章</em> </a> <em class="it">了解更多关于</em> <code class="fe lz ma mb mc b"><em class="it">Hashable</em></code> <em class="it">协议的信息。</em></p></blockquote><p id="8a09" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，我们可以继续让<code class="fe lz ma mb mc b">Company</code>结构符合<code class="fe lz ma mb mc b">Hashable</code>协议，并利用<code class="fe lz ma mb mc b">init(grouping:by:)</code>初始化器按公司对所有设备进行分组。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7d97" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就这样，我们成功地将所有的<code class="fe lz ma mb mc b">Device</code>对象按公司分组。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="b04d" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">包扎</h1><p id="117d" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated"><code class="fe lz ma mb mc b">init(grouping:by:)</code>初始化器非常有用，也非常容易使用。</p><p id="1aae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我想将一组数据分组到一个字典中，以便在一个表视图或具有多个部分的集合视图中显示它们时，我发现它特别方便。</p><p id="27c4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下次当您想创建一个包含多个部分的表格视图时，一定要尝试一下这种方法。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="c196" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望这篇文章能让你清楚地知道如何正确使用<code class="fe lz ma mb mc b">Dictionary.init(grouping:by:)</code>初始化器。</p><p id="07ec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你喜欢这篇文章，可以随意查看我的其他与Swift 相关的<a class="ae lr" href="https://swiftsenpai.com/category/swift/" rel="noopener ugc nofollow" target="_blank">文章。</a></p><p id="b70f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你有任何问题，请在下面的评论区留下，或者你可以在推特上联系我。</p><p id="5d56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读。🧑🏻‍💻</p></div></div>    
</body>
</html>