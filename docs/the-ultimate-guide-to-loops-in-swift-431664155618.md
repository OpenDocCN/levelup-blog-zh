# Swift 环路终极指南

> 原文：<https://levelup.gitconnected.com/the-ultimate-guide-to-loops-in-swift-431664155618>

## 掌握编程中最基本的构件之一

![](img/5a9d035d33e057249b31efe9899234ea.png)

在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上由[Tine ivani](https://unsplash.com/@tine999?utm_source=medium&utm_medium=referral)拍摄的照片

所有编程语言都是独一无二的。他们至少在某些方面不同于所有的同龄人。

例如，Swift 有可选、类型别名和不透明返回类型。

然而，有一些几乎每种语言都使用的基本构件。条件允许你仅在条件评估为真时运行代码的某一部分。大多数语言使用 if 子句来实现这种条件逻辑。

[](https://medium.com/swlh/the-ultimate-guide-to-swift-conditionals-297f17fd5c1f) [## 快速条件句终极指南

### 深入探究 Swift 的核心构件之一。今天，我们来看看条件句。

medium.com](https://medium.com/swlh/the-ultimate-guide-to-swift-conditionals-297f17fd5c1f) 

但是条件并不是大多数编程语言使用的唯一基本构件。我们有类、对象、函数、变量、常量、访问控制等等。

我们开发人员经常想快速学习新的东西，看一门语言为我们提供的所有高级特性是很有诱惑力的。因此，我们经常忘记首先掌握基础知识。在我们继续前进之前，建立一个坚实的基础是很重要的。这将帮助我们以更快的速度获取知识，因为我们理解了语言本身的核心。

这就是为什么今天我想讨论编程语言 Swift 中的一个基础部分。

**循环往复。**

在阅读这篇文章时，你会学到以下几点:

1.  什么是循环？
2.  while 循环。
3.  重复循环。
4.  斯威夫特经典 for-loop 的再现。
5.  基于范围的 for-in-loop。
6.  用 for-in-loop 迭代序列。
7.  使用循环的替代方法。

本文试图成为您全面理解 Swift 中所有类型环路所需的唯一资源。我将添加个人建议以及技巧和诀窍，以充分利用每种类型的循环。遗憾的是，我不能涵盖这个话题的每一个细微差别。但是在你完成之后，你将会为你将要面对的循环挑战做好充分的准备。

## 什么是循环？

循环包含的代码不仅要运行一次，还要运行多次。

想象一个没有循环的世界，你会想打印从 0 到 100 的数字。

你需要写 100 份打印声明！现在考虑更动态的行为，您希望根据用户拥有的数据项的数量来运行某些代码。那是不可能实现的！

循环允许您指定一个条件，并在尽可能多的迭代中运行一些代码，以使条件评估为假。

举个例子，让我们假设你从用户那里得到一个不确定数目的整数，然后你想把它们加倍。通过一个循环，您可以迭代这些数字，并将每个数字乘以 2。您只需编写一次代码，但要多次执行。

有像递归这样的循环的替代方法。但稍后会详细介绍。

有了这个更一般的解释，让我们看一个具体的例子，看一些代码来理解它背后的理论。

## Swift 中的 while 循环

如果你像我一样幸运，拥有计算机科学学位，你就会知道这种类型的循环。

这是你将在许多典型的“编程入门”课上看到的第一个循环。我第一次遇到它是在 C 语言中，后来是在 Java 中。

在进一步讨论这个问题之前，我们先来看一个 Swift 中的代码示例。

上面的循环将从 10 到 0(包括 10 和 0)的数字打印到控制台。

while 循环基本上执行以下操作:

> 如果条件的计算结果为真，运行这段代码，运行的次数与条件的计算结果相同。

变量`countdown`用于 while 循环的条件部分。在第一次迭代中，值是 10，因此，while 块中的代码被执行。

在程序块的末尾，变量`countdown`将被减 1。所以下一次迭代是 9。

> **注意:**不要忘记这最后一行代码！关于循环，最容易犯的一个错误是忘记改变用于计算的变量。如果没有 while 块的最后一行，我们将无限次地执行代码。每次迭代，变量`countdown`都是 10。这将导致我们的应用程序冻结，并最终崩溃。

只要条件评估为真，就将执行循环，在这种情况下，只要变量`countdown`大于或等于 0。

一旦条件评估为假(`countdown`变得小于 0)，while 块将不再执行，我们将继续执行循环后面的代码。

这里我还想指出两件事:

1.  在块内的什么地方改变用于条件的变量并不重要。当前迭代将一直运行到完成，然后在下一次迭代之前检查条件。因此，改变变量的行为不像一个`break` -、`continue` -或`return`-语句。**然而，如果你想在下面的代码中使用它，这就很重要了！**
2.  你不必像我一样使用计数器。这是最常见的场景，但是您也可以使用任何其他可用于条件的内容。例如，你也可以使用一个在开始时为真的变量，当循环中发生某些事情时，这个变量变为假。

**相关性:**就我个人而言，我不再经常使用 while 循环了。当你从旧的编程语言进入 Swift 时，你可能会经常使用它。但是 while 循环有一个很大的缺点。你必须自己改变影响条件的变量！如果你忘记了或者犯了一个错误，这个循环将会无休止地运行。Swift 正尽力避免这种人为错误，这就是为什么我认为其他循环更适合 Swift 和您的应用程序。

## Swift 中的 repeat while 循环

你可能也知道这种类型的循环。通常，它有一个不同的名字。do-while 循环。

> **注意:**在 Swift 的早期，这也被称为 do-while。在 Swift 2.0 中，他们将命名约定改为 repeat-while。

它非常类似于 while 循环，但是在第一次迭代时表现不同。让我们看另一个例子。

> **注意:**在两个例子中，我们都没有使用递增或递减操作符(例如`howManyIterationsLeft--`、`--countdown`)。这些运算符在 Swift 中已不复存在，在语言版本 2.2 中已被弃用。

你能猜出这个循环多久运行一次吗？你可以假设它根本不会运行，因为条件说`howManyIterationsLeft`需要大于 0。

这就是 repeat-while 循环的问题。它总是至少执行一次！在上面的代码片段中，变量`howManyIterationsLeft`的值将被打印到控制台。那样的话就是 0。

重复循环基本上执行以下操作:

> 运行这段代码，并在每次迭代后检查条件是否仍然为真。如果是这种情况，继续另一个迭代。

所以让我们回顾一下 while 循环和 repeat-while 循环之间的区别。

While 循环:

1.  在运行循环迭代之前评估条件。
2.  在 0 和无限次数之间运行。

循环时重复:

1.  在运行循环迭代后计算条件。
2.  在 1 和无限次数之间运行。

**相关性:**while 循环和 repeat-while 循环在 Swift 中同样常见。repeat-while 循环可能更少使用，因为它在第一次迭代后检查，这很少有用。两者都有一个缺点，就是必须记住正确地改变用于条件的变量。如果你在这里犯了一个编程错误，代价是一个崩溃的应用程序。对我来说，这似乎很容易出错，这不是 Swift 的全部。

## 斯威夫特经典 for-loop 的再现

这是几乎所有编程语言都有的最后一种循环。但是 Swift 对此并没有真正的支持。许多编程语言中的经典 for 循环包括以下部分:

1.  初始化语句。
2.  一个条件。
3.  增量/减量。

我们先来看一个 c 中的例子。

初始化语句是`int counter = 1`。用分号分隔，然后是条件，之后是用于条件的变量的增量。

我们仍然需要自己改变条件变量，但是语法迫使我们记住它。

Swift 没有提供这样的 for 循环，但是我们可以用 [stride](https://developer.apple.com/documentation/swift/1641347-stride) 函数重新创建它。

它实际上已经是一个 for-in-loop 了，但是我想先给你们展示一个更经典的变体。

> **注意:**注意，stride 函数不包括序列的结尾(第二个参数`to`)。因此，为了打印从 1 到 10 的值，我们必须传递 11。

**相关性:**我想跟你说实话，在 6 年多的 Swift 编程中，我还没有见过或使用过带 stride 函数的 for-in-loop。如果你想忘记这篇文章中的一条信息，那么很明显是这个解决方案。我看到的唯一原因是当你想要一个不同于 1 的增量时。您可以将 2、-5 或 10 传递给`by`参数。尽管如此，Swift 还有一种更常见的循环类型，我们接下来要看一看。

## Swift 中基于范围的 for-in-loop

我们研究了许多可用的选项，它们的相关性都很低。Swift 为我们提供了一种 for-in-loop，它可以采用多种不同的形状，绝对是所有循环类型中最重要的一种。

让我们从一个循环开始，我们只对索引或者计数器感兴趣。这一次是以一种更快捷的方式。

它更容易阅读，而且完全符合你的想法。它在我们提供的范围内迭代，包括下限和上限。在上面的例子中，它将迭代从 1 到 10 的数字，并将它们全部打印到控制台。

我已经告诉过您，Swift 中的 for-in-loop 非常通用。那么我们是否也可以排除上界呢？

控制台会看到从 0 到 59 的数字。

如您所见，半开范围操作符(`..<`)在快速循环中也能工作。您甚至可以为范围操作符使用常量或变量。

同样，我们不需要自己处理计数。

在 for 循环中递减怎么样？

您可以像这样简单地反转范围:

这仍然会打印出 0 到 59 的数字。但顺序颠倒了，所以这正是我们要找的。

**相关性:**我并不是每天都使用这种方法，因为我们接下来会看到一个更常见的解决方案。除此之外，我认为你应该知道如何使用 for-in-loop 的变体，因为你会不时地需要它。我倾向于每月使用 2-3 次，在这种情况下知道这一点是有好处的。

## 用 for-in-loop 迭代序列

现在让我们来看看我在 Swift 中处理循环时最常用的解决方案。

所以，我们先来了解一下，在用循环编程的时候，我们大部分时间都在做什么。

为什么我们首先要循环？大多数时候，这是因为我们希望对经常来自外部来源(例如，用户输入或网络请求)的一定数量的元素反复执行操作。

我们现在可以获得元素的数量，然后使用上面基于索引的解决方案。让我们看看代码:

在上面的代码片段中，我们有 3 只动物。我们用一个索引对它们进行迭代，访问数组索引处的元素，并用字符串插值将其打印出来。

然而，这仍然容易出错。想象一下，我们会不小心使用了以下范围:

```
1..<animals.count
```

这将导致我们不打印狗到控制台。或者这样如何:

```
0...animals.count
```

这甚至会使我们的应用程序崩溃，因为我们试图访问索引中不可用的元素。

当然，在打印数值时，所有这些都不那么重要。无论如何，这同样适用于关键的业务逻辑，比如从一个银行账户到另一个账户的转账。当你没有对其中一项交易应用货币汇率时，就会出现问题。

所以让我们用一种更好的方法来重温上面的例子。

那看起来更好！但是它是如何工作的呢？它实际上遍历序列(在本例中是一个数组)，并为每次迭代创建一个这些值的常数，然后我们可以在循环中使用它。

这里我们不需要处理索引。我们可以简单地使用元素。

这和字典有什么关系？这是代码。

你可以看到，我们使用了相同的循环，但是这一次，我们可以用`key`属性访问动物的键，用`value`属性访问值。

> **你知道吗:**你可以在 Swift 中使用表情符号。您甚至可以将它们用作变量名，但是我建议避免这样做。这使得访问它们变得更加困难。

我将省略[集合](https://developer.apple.com/documentation/swift/set)，因为从循环的角度来看，它们与数组的工作方式相同。你只需要知道，集合没有重复。但是要小心！他们也没有被命令！这可能会产生一些意想不到的副作用。

但是如果你仍然需要元素的索引呢？如果要打印出类似 *0:狗*、 *1:猫*、 *2:鱼*的东西怎么办？或者其他什么原因，还需要知道元素的索引？

for-in-loop 是非常通用的，也有一个解决方案！您可以在数组上使用函数[枚举](https://developer.apple.com/documentation/swift/enumeratedsequence)，并访问索引和元素。

枚举函数将创建一个具有结构 *(n，x)* 的元组，其中 *n* 是从零开始的元素的索引， *x* 是元素本身。

这样，我们可以访问实际元素旁边的索引，并在同一个循环中使用这两个值，而无需修改索引或访问原始元素数组。

相关性:我已经提到过，与其他循环类型相比，我更喜欢这个变体中的循环。它非常通用，你可以访问索引和元素，或者同时访问两者。请确保您已经习惯了该语法，因为您会一遍又一遍地看到它。

## 在 Swift 中使用循环的替代方案

对于循环，有两种选择，你应该知道。

**递归:**

首先，有递归。递归意味着你有一个调用自己的函数，但是有不同的输入参数。这样，你就可以创建一个循环，而不需要真正的循环。

让我们看一个代码示例。

我们只调用一次`printAnimal`函数(在第 12 行)。但是，它仍然会通过调用自己来打印出所有的动物。当我们到达动物数组的最后一个索引时，它停止，并简单地打印出它的值。你会发现没有循环。

相关性:对我来说，递归更难理解和思考。不时挑战自己，尝试不同的方法来解决一个共同的问题是有意义的。这拓宽了我们的思维，让我们能够接受新的解决方案。无论如何，在生产代码中，我倾向于使用循环而不是递归。

**高阶函数:**

如今，第二种选择更加普遍。随着函数式编程的兴起，循环的替代方案也以高阶函数的形式出现了。我不能涵盖所有的，但我想给你看一个地图功能的例子。

它实际上会打印出所有的动物，就像我们之前打印循环一样。

map 函数对于转换集合的元素很有用。高阶函数可以一个接一个地链接在一起，你甚至可以将映射函数传递给它们。

如果这让您的问题多于答案，我强烈推荐这本关于 Swift 高阶函数的优秀指南:

[](https://abhimuralidharan.medium.com/higher-order-functions-in-swift-filter-map-reduce-flatmap-1837646a63e8) [## Swift 中的高阶函数:Filter、Map、Reduce、flatmap、compactMap

### 自从我详细了解了函数和闭包之后，我想知道更多关于…的优点和用法

abhimuralidharan.medium.com](https://abhimuralidharan.medium.com/higher-order-functions-in-swift-filter-map-reduce-flatmap-1837646a63e8) 

相关性:随着我最近的项目大量使用函数式反应式编程(FRP)，我也越来越经常地使用这些高阶函数。无论如何，当我真的很难让一些东西工作时，我仍然试图在切换到高阶函数之前先在一个循环中解决它。然而，这绝对是你需要知道的一件事，这样你才能称自己为快速开发专家。

## 结论

我的 Swift 循环指南到此结束。因为你会经常见到他们，所以真正对他们感到舒适是很重要的。不管怎样，如果你是一个 macOS，iOS，tvOS，watchOS，或者任何其他开发者，你会在你进入的许多项目中发现循环。

即使随着函数式反应式编程的兴起，循环，尤其是它们背后的思想仍然是一个核心的构建模块，你需要理解它才能掌握你的技能。

感谢您的时间，并与循环玩得开心！