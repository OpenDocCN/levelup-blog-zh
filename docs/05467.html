<html>
<head>
<title>Substitution Cipher in Python and JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python和JS中的替代密码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/substitution-encoder-and-solver-in-python-19984a6b8d5d?source=collection_archive---------3-----------------------#2020-09-01">https://levelup.gitconnected.com/substitution-encoder-and-solver-in-python-19984a6b8d5d?source=collection_archive---------3-----------------------#2020-09-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="fa2b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">替代密码的实现及一些统计分析</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="22b0" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">动机</h1><p id="fe75" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">你来这里是因为担心你所有的流量都被政府嗅探分析吗？你来对地方了！在这里，您将学习加密您的文本和阅读别人的秘密聊天，这是加密的替代密码。</p><p id="ea98" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">糟糕的是，最终，你会确定你在WhatsApp中的所有聊天都能被轻易解码(确定这不是真的，脸书在大约40年前就决定不对WhatsApp使用替代密码)。</p><p id="887b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将在Python中实现一个替代密码，然后我们将尝试使用统计来破解代码。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi ly"><img src="../Images/ec31275664dbb0bfc5352547a794d35b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cx82E1KpE5755tuhHDD4Qg.jpeg"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">《美丽心灵》</figcaption></figure></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="0f1d" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">替代密码</h1><p id="c400" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">维基百科说:</p><blockquote class="mo mp mq"><p id="da5c" class="jq jr mr js b jt ju jv jw jx jy jz ka ms kc kd ke mt kg kh ki mu kk kl km kn im bi translated">在<a class="ae mv" href="https://en.wikipedia.org/wiki/Cryptography" rel="noopener ugc nofollow" target="_blank">密码学</a>中，<strong class="js iu">替代密码</strong>是一种<a class="ae mv" href="https://en.wikipedia.org/wiki/Encrypting" rel="noopener ugc nofollow" target="_blank">加密</a>的方法，通过这种方法，按照固定的系统，将<a class="ae mv" href="https://en.wikipedia.org/wiki/Plaintext" rel="noopener ugc nofollow" target="_blank">明文</a>的单元替换为<a class="ae mv" href="https://en.wikipedia.org/wiki/Ciphertext" rel="noopener ugc nofollow" target="_blank">密文</a>；“单元”可以是单个字母(最常见的)、成对字母、三个字母、以上的混合等等。接收者通过执行反向替换来解密文本。</p></blockquote><p id="49fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">换句话说，所有的字母“A”都用“B”代替，所有的“B”都用别的东西代替。我们简单地混合所有的字母。接收加密文本的人知道字母是如何混合的。</p><p id="4f86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看一个例子。</p><p id="367e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你有这样的文字:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="7c9e" class="nb kw it mx b gy nc nd l ne nf">On a dark desert highway<br/>Cool wind in my hair<br/>Warm smell of colitas<br/>Rising up through the air<br/>Up ahead in the distance<br/>I saw a shimmering light<br/>My head grew heavy and my sight grew dim<br/>I had to stop for the night</span><span id="885c" class="nb kw it mx b gy ng nd l ne nf">There she stood in the doorway<br/>I heard the mission bell<br/>And I was thinkin' to myself<br/>'This could be heaven or this could be hell<br/>Then she lit up a candle<br/>And she showed me the way<br/>There were voices down the corridor<br/>I thought I heard them say</span></pre><p id="48b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们替换这些字母:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="7cd4" class="nb kw it mx b gy nc nd l ne nf">abcdefghijklmnopqrstuvwxyz</span></pre><p id="a344" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过这些:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="d6a2" class="nb kw it mx b gy nc nd l ne nf">fcpevqkzgmtrayonujdlwhbxsi</span></pre><p id="5f3e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以，我们不写“a”，而是写“f”，不写“b”，而是写“c”，以此类推。</p><p id="6abc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我们得到这个加密文本:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="1988" class="nb kw it mx b gy nc nd l ne nf">oy f efjt evdvjl zgkzbfs<br/>poor bgye gy as zfgj<br/>bfja davrr oq porglfd<br/>jgdgyk wn lzjowkz lzv fgj<br/>wn fzvfe gy lzv egdlfypv<br/>g dfb f dzgaavjgyk rgkzl<br/>as zvfe kjvb zvfhs fye as dgkzl kjvb ega<br/>g zfe lo dlon qoj lzv ygkzl<br/>lzvjv dzv dlooe gy lzv eoojbfs<br/>g zvfje lzv agddgoy cvrr<br/>fye g bfd lzgytgy' lo asdvrq<br/>'lzgd powre cv zvfhvy oj lzgd powre cv zvrr<br/>lzvy dzv rgl wn f pfyerv<br/>fye dzv dzobve av lzv bfs<br/>lzvjv bvjv hogpvd eoby lzv pojjgeoj<br/>g lzowkzl g zvfje lzva dfs</span></pre><p id="7427" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了简单起见，现在所有的字母都是小写的。当然，这不是必需的。</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="4e30" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">用Python实现</h1><p id="ad0c" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">Python中的实现很简单:我们查看每个字母，如果该字母在字母表中，那么我们用密钥替换它:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="0487" class="nb kw it mx b gy nc nd l ne nf">alphabet = <strong class="mx iu">"abcdefghijklmnopqrstuvwxyz"<br/></strong>key = <strong class="mx iu">"fcpevqkzgmtrayonujdlwhbxsi"<br/></strong>text = <strong class="mx iu">"On a dark desert highway Cool wind in my hair"<br/><br/></strong>result = <strong class="mx iu">""<br/>for </strong>letter <strong class="mx iu">in </strong>text:<br/>    <strong class="mx iu">if </strong>letter.lower() <strong class="mx iu">in </strong>alphabet:<br/>        result += key[alphabet.find(letter.lower())]<br/>    <strong class="mx iu">else</strong>:<br/>        result += letter<br/><br/>print(result)</span></pre><p id="537f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">没错。我们完了。但这是Python，为什么不简化一下呢？</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="ea4f" class="nb kw it mx b gy nc nd l ne nf">alphabet = <strong class="mx iu">"abcdefghijklmnopqrstuvwxyz"<br/></strong>key = <strong class="mx iu">"fcpevqkzgmtrayonujdlwhbxsi"<br/></strong>text = <strong class="mx iu">"On a dark desert highway Cool wind in my hair"</strong><br/>print(<strong class="mx iu">""</strong>.join([key[alphabet.find(a)] <strong class="mx iu">if </strong>a <strong class="mx iu">in </strong>alphabet <strong class="mx iu">else </strong>a <strong class="mx iu">for </strong>a <strong class="mx iu">in </strong>text.lower() ]))</span></pre></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="fcef" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">用JavaScript实现</h1><p id="c514" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">JavaScript中的实现包括一些HTML结构和其他结构，所以稍微长一点，尽管想法是一样的:</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="nh ni l"/></div></figure></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="7c7a" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">分析一下:)</h1><p id="7ff9" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">那么，为什么脸书决定不用替代密码加密所有的聊天记录呢？破解密码真的很简单吗？</p><p id="cfc2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你会怎么做？</p><p id="83eb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">暴力破解需要一些时间，检查你是否已经解码了文本是很重要的，你需要检查每个单词，并与一些词汇进行比较。另一个问题是，有些单词可能是名字，比如“California”，你会找不到。</p><p id="04ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">既然我们是一个字母一个字母的加密，那么用同样的方式解密也是有意义的。我们计算“正常文本”中的字母数量，并找出哪些字母出现的频率更高。比方说，如果字母“e”是最常遇到的，我们就在我们的加密文本中找到最常出现的字母，并用“e”代替它。很可能，我们是对的。</p><p id="7807" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好的。我们如何计数？我拿着女王著名的《波西米亚狂想曲》的歌词，数着字母:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="cfb2" class="nb kw it mx b gy nc nd l ne nf">import matplotlib.pyplot as plt<br/>alphabet = "abcdefghijklmnopqrstuvwxyz"<br/>plt.bar(list(alphabet), [corpus.lower().count(letter) for letter in alphabet])</span></pre><p id="d289" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里的语料库变量包含完整的歌词。最后，我们得到了这张图表:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/d7021054d477040822afdbe6ad10ec43.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*Cjo4nObwW7S2QtH13eEKoQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">《波西米亚狂想曲》中的字母频率</figcaption></figure><p id="f0e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我们加密文本中字母的出现频率:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/cd01d3f404b331366083e0b6faa12860.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*YMfSUwx6PK_pW3bzdrPLpQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">加密文本中的字母频率</figcaption></figure><p id="bba3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以，从这里，我们可以猜测“e”很可能是用“v”加密的，“o”是用“z”加密的。</p><p id="620b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们对这两个图表进行排序:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="f144" class="nb kw it mx b gy nc nd l ne nf">import pandas as pd<br/>df = pd.DataFrame({<br/>    "letter": list(alphabet),<br/>    "count": [corpus.lower().count(letter) for letter in alphabet]<br/>})<br/>df = df.sort_values("count")<br/>plt.bar(df["letter"], df["count"])</span></pre><p id="3c9c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是文集(《波西米亚狂想曲》):</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/b4ac331c93300352c9e6070a91f529fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*42glyPltonHGWVnEYIBMbg.png"/></div></figure><p id="f8b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是加密文本:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/fdd9eeb270ab75014adc4dd9a1678b7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*l3IToJ8EqC15qjHxIUUiPQ.png"/></div></figure><p id="a8db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我们得到下面的密钥:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="6d57" class="nb kw it mx b gy nc nd l ne nf">gpnkvqayftioedzcxbjlshwmru</span></pre><p id="41f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">vs原始密钥:</p><pre class="lz ma mb mc gt mw mx my mz aw na bi"><span id="3c18" class="nb kw it mx b gy nc nd l ne nf">fcpevqkzgmtrayonujdlwhbxsi</span></pre><p id="a2f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，这当然是不准确的:(但我们已经猜到了至少几个字母。可能是猜测其他的起点。</p><p id="f476" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以，我们成功地破解了这个密码。我太天真了，没想到会有这种方法。因此，我很快在互联网上寻找一种算法，并发现它要复杂得多。</p><p id="eee1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你需要做的是收集二元图、四元图等的统计数据。所以，我们应该学一些类似“字母A后面经常跟着字母T”的东西。为此，我们需要一个更大的语料库。也许下次吧。</p><p id="c407" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有时我们会失败，是的:)我希望你仍然喜欢这个旅程。</p></div></div>    
</body>
</html>