<html>
<head>
<title>Do not blindly implement the Serializable Interface</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要盲目地实现可序列化接口</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/do-not-blindly-implement-the-serializable-interface-12b596d49687?source=collection_archive---------8-----------------------#2020-12-21">https://levelup.gitconnected.com/do-not-blindly-implement-the-serializable-interface-12b596d49687?source=collection_archive---------8-----------------------#2020-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6b25" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">消除常见误解的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d9e79cf6b2690fa8a785c88a090e90e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1PgGHFb9tidu8YVx"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@benwhitephotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">本·怀特</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><blockquote class="kw"><p id="ef03" class="kx ky iq bd kz la lb lc ld le lf lg dk translated">"没有理由在你编写的任何新系统中使用Java序列化."——约书亚·布洛赫。</p></blockquote><p id="7928" class="pw-post-body-paragraph lh li iq lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb lg ij bi translated">1997年，Java中就有了序列化。其中一个众所周知的机制是通过网络发送对象的状态。虽然听起来很方便，但弊远远大于利。</p><p id="4062" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">幸运的是，现在有了我们称之为跨平台结构化数据表示的替代方案。虽然有些人称之为序列化系统，但我们避免使用这个术语，以免与Java序列化混淆。</p><p id="bb8a" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">在本文中，我们将讨论序列化。接下来，我们将仔细看看它的一个缺点。最后，我们将快速浏览备选方案，以澄清一个常见的误解。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="0620" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated"><strong class="ak">什么是序列化？</strong></h1><p id="1b1d" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">简单来说，<strong class="lj ir">序列化就是把一个对象变成一个字节流。给定这个字节流，我们可以做几件事:通过网络发送它，将它存储在数据库中，保存到文件中，等等。一旦一切就绪，我们总是可以反序列化这个字节流，将其转换回对象。</strong></p><p id="1707" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">为了进行演示，让我们尝试模拟将对象列表序列化到一个文件中。之后，使用反序列化，让我们将其转换回对象列表。</p><p id="5921" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">首先，让我们创建一个<code class="fe nl nm nn no b">Person</code>类并实现<code class="fe nl nm nn no b">Serializable</code>接口。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="9008" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">接下来，让我们快速创建一个<code class="fe nl nm nn no b">PersonSerializationUtil</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="50ed" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">最后，让我们创建一个简单的测试来模拟person类型列表的序列化和将其字节流反序列化回对象列表。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="1bd9" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">正如我们所看到的，我们已经成功地使用文件执行了序列化和反序列化。如前所述，有了字节流，我们还可以通过网络发送它或将其存储在数据库中。不管怎样，序列化和反序列化的过程是相似的。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="3ded" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated"><strong class="ak">使用序列化的缺点</strong></h1><p id="8b81" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">使一个类可序列化确实不费吹灰之力。相比之下，它更有理由保持谨慎，因为其长期成本往往是有害的。话虽如此，让我们来看看实现<code class="fe nl nm nn no b">Serializable</code>的主要成本之一。</p><blockquote class="nr ns nt"><p id="f557" class="lh li nu lj b lk mc jr lm ln md ju lp nv me ls lt nw mf lw lx nx mg ma mb lg ij bi translated">实现<code class="fe nl nm nn no b">Serializable</code>降低了更改类实现的灵活性。</p></blockquote><p id="4e35" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">引入更改可能会导致反序列化时出现<code class="fe nl nm nn no b">InvalidClassException</code>。</p><p id="0759" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">再次使用我们之前创建的<code class="fe nl nm nn no b">Person</code>类进行模拟，让我们尝试添加一个<code class="fe nl nm nn no b">middleName</code>字段:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="7508" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">现在，让我们试着反序列化前一个文件中的字节流:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="952d" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">在控制台中运行测试时，我们可以看到在运行时遇到了InvalidClassException:</p><pre class="kg kh ki kj gt ny no nz oa aw ob bi"><span id="1f8e" class="oc mp iq no b gy od oe l of og">org.apache.commons.lang3.SerializationException: java.io.InvalidClassException: com.emyasa.Person; local class incompatible: ...</span></pre><p id="beac" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">另一方面，一般来说，盲目地反序列化数据是危险的，可能会导致安全问题。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="57cc" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated"><strong class="ak">电子监管的替代方案</strong></h1><p id="bcff" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">让我们来看看两个领先的<em class="nu">跨平台结构化数据表示</em> : <em class="nu"> JSON </em>和<em class="nu">协议缓冲区</em>。如前所述，这些有时也被认为是<em class="nu">序列化系统</em>。这通常会导致一个常见的误解，即暗示需要序列化<em class="nu">数据传输对象</em>。</p><p id="f5dd" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">相比之下，<em class="nu">跨平台结构化数据表示</em>和<em class="nu"> Java序列化</em>是相互独立的。例如，使用JSON就足以进行浏览器-服务器通信。因此，在这个用例中，不需要对<em class="nu">数据传输对象</em>进行Java序列化。</p><p id="7a7e" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">像往常一样，这篇文章的完整源代码可以在<a class="ae kv" href="https://github.com/emyasa/medium-articles/tree/master/core-concepts" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><p id="0235" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">如果您正在寻找另一篇与Java相关的有趣文章，请随意查看:</p><div class="oh oi gp gr oj ok"><a rel="noopener  ugc nofollow" target="_blank" href="/never-swallow-exceptions-5e01c6bb5b8a"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ir gy z fp op fr fs oq fu fw ip bi translated">永远不要吞下异常</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">避免不必要的头痛——无论是象征性的还是字面上的</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy kp ok"/></div></div></a></div></div></div>    
</body>
</html>