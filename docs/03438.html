<html>
<head>
<title>Render dynamic content in Node.js using templates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用模板在Node.js中呈现动态内容</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/render-dynamic-content-in-nodejs-using-templates-a58cae681148?source=collection_archive---------0-----------------------#2020-05-09">https://levelup.gitconnected.com/render-dynamic-content-in-nodejs-using-templates-a58cae681148?source=collection_archive---------0-----------------------#2020-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ea41" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何通过构建真实的应用程序从Node.js呈现UI</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5080c05f61d5048cee65aa656fb0c21f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BJudVovek7zrfkve"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@goran_ivos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">戈兰·艾沃斯</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="df2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将看到如何使用Node.js呈现前端，这对于显示静态或动态内容非常有帮助。</p><p id="db03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">什么是模板？</p><blockquote class="ls lt lu"><p id="fe60" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">模板允许我们在html中呈现动态内容，使我们能够使用循环、if条件和其他功能。它允许我们在运行时注入动态数据。</p></blockquote><p id="6d83" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以只使用Node.js中的模板构建一个完整的前端，而不使用前端库。</p><p id="f28e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以生成动态html并将动态生成的内容保存在一个文件中。有各种各样的模板库。一些流行的选项有<code class="fe lz ma mb mc b">handlebars</code>、<code class="fe lz ma mb mc b">pug/jade</code>、<code class="fe lz ma mb mc b">EJS</code>等。</p><p id="75fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用<code class="fe lz ma mb mc b">express.js</code>来处理路由和<code class="fe lz ma mb mc b">EJS</code>(嵌入式JavaScript模板)，这是一个非常受欢迎的库，每周下载约600万次。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi md"><img src="../Images/f44172ba96def37b2938ef6e6542ad10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B3KNUQX3Hki34M4OwRIsOA.png"/></div></div></figure><p id="903b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">EJS</code>如此受欢迎的原因之一是因为它允许直接在模板中编写JavaScript代码，所以我们可以使用<code class="fe lz ma mb mc b">loops</code>、<code class="fe lz ma mb mc b">if conditions</code>和JavaScript提供的所有东西。其他模板库使用自己的语法，不直接写JavaScript。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><p id="5180" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个名为<code class="fe lz ma mb mc b">templating-nodejs</code>的新文件夹，从终端导航到该文件夹，并通过运行以下命令初始化<code class="fe lz ma mb mc b">package.json</code>:</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="f304" class="mp mq iq mc b gy mr ms l mt mu">npm init -y</span></pre><p id="bc9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运转安装<code class="fe lz ma mb mc b">express</code>和<code class="fe lz ma mb mc b">ejs</code>:</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="0eed" class="mp mq iq mc b gy mr ms l mt mu">npm install express@4.17.1 ejs@3.1.2</span></pre><p id="f2aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过运行以下命令将<code class="fe lz ma mb mc b">nodemon</code>安装为开发依赖项:</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="4efa" class="mp mq iq mc b gy mr ms l mt mu">npm install nodemon@2.0.3  --save-dev</span></pre><p id="d976" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个新文件<code class="fe lz ma mb mc b">index.js</code>，并在其中添加以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="03f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe lz ma mb mc b">package.json</code>中添加一个启动脚本</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="2233" class="mp mq iq mc b gy mr ms l mt mu">"start": "nodemon index.js"</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/4e1b366be73d0b12cdd36bab08a35908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XtAfirFtk3VLSynKRp-k2g.png"/></div></div></figure><p id="62bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在通过从命令行执行<code class="fe lz ma mb mc b">npm start</code>命令来启动express服务器:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/43ea6f097f26cd770544cca93bb14be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KlZzfhFDmLvbYfG7NpgWQ.png"/></div></div></figure><p id="a1b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您现在可以通过导航到<a class="ae kv" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>来访问该应用程序</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/1acd623e05142a82f0087ca97511baf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fn9Vqw9QW78zdFRLaXw41w.png"/></div></div></figure><p id="6587" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们将ejs功能添加到应用程序中。</p><p id="97ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">新建一个<code class="fe lz ma mb mc b">views</code>文件夹，并在其中添加一个<code class="fe lz ma mb mc b">index.ejs</code>文件，内容如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">索引. ejs</figcaption></figure><p id="96de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了渲染这个文件，我们需要在我们的express应用程序中添加一些代码。</p><p id="eaf1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过在<code class="fe lz ma mb mc b">index.js</code>文件中添加以下代码来指定渲染引擎</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="fe77" class="mp mq iq mc b gy mr ms l mt mu">app.set("view engine", "ejs");</span></pre><p id="465a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了呈现<code class="fe lz ma mb mc b">index.ejs</code>，我们需要使用<code class="fe lz ma mb mc b">res</code>对象的<code class="fe lz ma mb mc b">render</code>方法，并传递ejs文件的名称，而不提供。ejs扩展。</p><p id="5052" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Express将使用自动搜索文件。默认的<code class="fe lz ma mb mc b">views</code>目录中的ejs扩展名</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="49d9" class="mp mq iq mc b gy mr ms l mt mu">app.get("/", (req, res) =&gt; {<br/> res.render("index"); // index refers to index.ejs<br/>});</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/a57b042badc6e90c0000c76b765073a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PXoXEFU8F9MWKcIqXfyvDA.png"/></div></div></figure><p id="238b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，现在如果您导航到<a class="ae kv" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>，您将看到来自<code class="fe lz ma mb mc b">index.ejs</code>的内容正在呈现</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/f6f214caed07fe70b80be990230e12cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFgbnHeh2xRHjJbp_gpTMg.png"/></div></div></figure><h2 id="a228" class="mp mq iq bd nc nd ne dn nf ng nh dp ni lf nj nk nl lj nm nn no ln np nq nr ns bi translated"><strong class="ak">添加CSS和JavaScript支持</strong></h2><p id="9672" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">现在，我们将看看如何将<code class="fe lz ma mb mc b">css</code>和<code class="fe lz ma mb mc b">JavaScript</code>添加到我们的模板中。</p><p id="d87b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个名为<code class="fe lz ma mb mc b">public</code>的新文件夹，并在其中添加一个<code class="fe lz ma mb mc b">css</code>文件夹</p><p id="d327" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在其中添加<code class="fe lz ma mb mc b">styles.css</code>，内容如下</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="3eaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您的文件夹结构将如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/977367d72dac6c0fd0231eb9817f0568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*jW7TWZAPLtu8_qPLhHQmYQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">文件夹结构</figcaption></figure><p id="6a07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe lz ma mb mc b">views/index.ejs</code>文件中添加到<code class="fe lz ma mb mc b">css</code>文件的链接</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="df5c" class="mp mq iq mc b gy mr ms l mt mu">&lt;link rel="stylesheet" href="/css/styles.css" /&gt;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/3af7984b253b4bf86a726d326dd7974f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZS4rWbmvSBmAMHHxqM_jWg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">索引. ejs</figcaption></figure><p id="9346" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还在<code class="fe lz ma mb mc b">index.js</code>中添加以下代码，以便我们可以从<code class="fe lz ma mb mc b">public</code>文件夹中加载所有的<code class="fe lz ma mb mc b">html</code>、<code class="fe lz ma mb mc b">css</code>和<code class="fe lz ma mb mc b">javacript</code>文件。</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="a386" class="mp mq iq mc b gy mr ms l mt mu">app.use(express.static(path.join(__dirname, "public")));</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/6c65653f8248c6c8741be9e8e22f846d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wQnXRl6fnSrfxreIiDFB3w.png"/></div></div></figure><p id="b09c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您现在检查应用程序，您将看到CSS正在被应用</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/eb2f720111e4f3ffdd8088d949a766ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5QmpEK-kOHukpL6nOfcYbA.png"/></div></div></figure><p id="1018" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要添加JavaScript文件，在<code class="fe lz ma mb mc b">public</code>文件夹中创建一个新的<code class="fe lz ma mb mc b">js</code>文件夹，并使用一个简单的<code class="fe lz ma mb mc b">console.log</code>语句在其中添加<code class="fe lz ma mb mc b">script.js</code></p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="f1a5" class="mp mq iq mc b gy mr ms l mt mu">console.log("This is coming from script.js");</span></pre><p id="0784" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在主体结束标记前的<code class="fe lz ma mb mc b">views/index.ejs</code>文件中包含<code class="fe lz ma mb mc b">script.js</code></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/b3ea9ab089b7d780b945e0c8f96edafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dk64MtGTi0q67zocnwjjyw.png"/></div></div></figure><p id="dde4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您保存文件，您将会看到<code class="fe lz ma mb mc b">nodemon</code>没有自动重启，因此我们的更改没有反映在应用程序中。</p><p id="205b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是因为我们在<code class="fe lz ma mb mc b">package.json</code>中指定只观看<code class="fe lz ma mb mc b">index.js</code>到<code class="fe lz ma mb mc b">nodemon</code>。</p><p id="78ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要解决这个问题，打开<code class="fe lz ma mb mc b">package.json</code>并将启动脚本从</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="68fd" class="mp mq iq mc b gy mr ms l mt mu">"start": "nodemon index.js"</span></pre><p id="86c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">到</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="0342" class="mp mq iq mc b gy mr ms l mt mu">"start": "nodemon -e js,ejs"</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/1b1589fc975e4153f998752f73d4c9a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1r-6md_L_1XZ8RpENdjFA.png"/></div></div></figure><p id="5e58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们通过传递一个<code class="fe lz ma mb mc b">-e</code>标志来通知<code class="fe lz ma mb mc b">nodemon</code>如果<code class="fe lz ma mb mc b">.js</code>或<code class="fe lz ma mb mc b">.ejs</code>文件中有任何更改，就重新加载更改。</p><p id="bfd8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，通过从终端重新运行<code class="fe lz ma mb mc b">npm start</code>命令来重启<code class="fe lz ma mb mc b">nodemon</code>脚本，现在如果您保存<code class="fe lz ma mb mc b">views/index.ejs</code>文件，您将看到<code class="fe lz ma mb mc b">nodemon</code>在保存时自动重启。</p><p id="02cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，导航到<a class="ae kv" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>并刷新页面。你会在控制台上看到来自<code class="fe lz ma mb mc b">script.js</code>的日志:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/cf2235ef84f88c4d5c06eb73cfbfd2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkxaBEbDdSDzDPwxKnyVHA.png"/></div></div></figure><h2 id="2ec9" class="mp mq iq bd nc nd ne dn nf ng nh dp ni lf nj nk nl lj nm nn no ln np nq nr ns bi translated"><strong class="ak">更好地组织文件</strong></h2><p id="2246" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">EJS还允许我们将单个文件分割成单独的文件，这样我们就可以在所有页面上显示共同的页眉和页脚。</p><p id="2be9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要将一个文件包含在另一个文件中，我们使用以下语法</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="8b12" class="mp mq iq mc b gy mr ms l mt mu">&lt;%- include('header.ejs') %&gt;</span></pre><p id="31f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，<code class="fe lz ma mb mc b">&lt;%</code>和<code class="fe lz ma mb mc b">minus</code>符号用于包含文件。</p><p id="bbb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们将把我们的<code class="fe lz ma mb mc b">index.js</code>代码分割成<code class="fe lz ma mb mc b">header.ejs</code>、<code class="fe lz ma mb mc b">footer.ejs</code>和<code class="fe lz ma mb mc b">content.ejs</code>，并将它们包含到我们的<code class="fe lz ma mb mc b">index.ejs</code>中</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">内容. ejs</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">header.ejs</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">页脚. ejs</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">索引. ejs</figcaption></figure><p id="a36d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，我们在<code class="fe lz ma mb mc b">header.ejs</code>中没有结束<code class="fe lz ma mb mc b">body</code>和<code class="fe lz ma mb mc b">html</code>标记，因为我们已经在<code class="fe lz ma mb mc b">footer.ejs</code>中添加了它们</p><p id="507d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您在VS代码中安装了一些格式化程序，并且它会在保存时自动添加缺少的标签，那么您可以删除该结束标签并保存文件，而不进行格式化，如下所示</p><p id="485e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">按<code class="fe lz ma mb mc b">Control + Shift + P</code>或<code class="fe lz ma mb mc b">Command + Shift + P (Mac)</code>打开命令面板，输入<code class="fe lz ma mb mc b">save</code>然后选择<code class="fe lz ma mb mc b">File: Save without Formatting</code>选项</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/491cb209b281dade12ad58a5e31fc5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/1*jq22krjfPP8t6UHCyqi3DA.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">禁用自动格式化</figcaption></figure><p id="e2c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将使用ejs模板创建一个简单的登录应用程序，其中我们将显示登录时的成功消息和登录失败时的失败消息。</p><p id="52c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">打开<code class="fe lz ma mb mc b">content.ejs</code>并在其中添加以下代码</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">内容. ejs</figcaption></figure><p id="1bb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们允许用户输入姓名和<code class="fe lz ma mb mc b">password</code>，一旦用户提交表单，我们就调用表单标签中指定的<code class="fe lz ma mb mc b">index.js</code>中添加的<code class="fe lz ma mb mc b">/login</code>路线</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="982d" class="mp mq iq mc b gy mr ms l mt mu">&lt;form action="/login" method="post"&gt;</span></pre><p id="0db7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe lz ma mb mc b">views</code>文件夹下新建一个文件<code class="fe lz ma mb mc b">success.ejs</code>并添加以下内容</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">成功. ejs</figcaption></figure><p id="4ab6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们显示登录用户的用户名和成功消息。</p><p id="0375" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了显示<code class="fe lz ma mb mc b">ejs</code>文件中的任何值，我们在<code class="fe lz ma mb mc b">&lt;%=</code>和<code class="fe lz ma mb mc b">%&gt;</code>之间使用变量名</p><p id="ad0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">&lt;%=</code>用于通过将任何值转换成字符串来显示它。</p><p id="19ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe lz ma mb mc b">views</code>文件夹下新建一个文件<code class="fe lz ma mb mc b">failure.ejs</code>，添加以下内容</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">失败. ejs</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">更新的styles.css</figcaption></figure><p id="0ec0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了解析表单的输入，从终端运行下面的命令来安装<code class="fe lz ma mb mc b">body-parser</code> npm包</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="ce2e" class="mp mq iq mc b gy mr ms l mt mu">npm install body-parser@1.19.0</span></pre><p id="6838" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并通知express将输入解析为JSON对象导入到<code class="fe lz ma mb mc b">index.js</code>中</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="b5e7" class="mp mq iq mc b gy mr ms l mt mu">const bodyParser = require("body-parser");</span><span id="8916" class="mp mq iq mc b gy og ms l mt mu">const app = express();</span><span id="43a0" class="mp mq iq mc b gy og ms l mt mu">app.use(bodyParser.urlencoded({ extended: false }));</span></pre><p id="27ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，表单数据将在<code class="fe lz ma mb mc b">/login</code>路径内的<code class="fe lz ma mb mc b">req.body</code>对象中可用</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">index.js中的登录路径</figcaption></figure><p id="3f22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们检查登录数据。如果<code class="fe lz ma mb mc b">name</code>和<code class="fe lz ma mb mc b">password</code>匹配，则显示<code class="fe lz ma mb mc b">success.ejb</code>模板，否则显示<code class="fe lz ma mb mc b">failure.ejb</code>。</p><p id="9a85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，为了将数据传递给<code class="fe lz ma mb mc b">success.ejb</code>模板，我们在第二个参数中将它作为一个对象传递给render方法，因此它将在该模板中可用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">更新的index.js</figcaption></figure><p id="9ed9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您的应用程序将如下所示工作</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/18cba560cfb5a576f2a60ed5eac02b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*wv-zdnVBK1QFfX64voShbA.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">登录应用程序</figcaption></figure><h2 id="46c6" class="mp mq iq bd nc nd ne dn nf ng nh dp ni lf nj nk nl lj nm nn no ln np nq nr ns bi translated"><strong class="ak">使用EJS模板构建Github存储库列表应用</strong></h2><p id="289b" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">现在，我们将构建一个应用程序，显示作为URL中的查询字符串传递的任何用户的存储库。</p><p id="b38d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过运行以下命令从命令行安装<code class="fe lz ma mb mc b">axios</code></p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="66b4" class="mp mq iq mc b gy mr ms l mt mu">npm install axios@0.19.2</span></pre><p id="212f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe lz ma mb mc b">index.js</code>内添加以下路线</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="b6f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们从查询字符串中获取<code class="fe lz ma mb mc b">username</code>,因此URL将是这样的<a class="ae kv" href="http://localhost:3000/repos?username=your_github_username" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/repos？用户名= your _ github _用户名</a></p><p id="1330" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有指定<code class="fe lz ma mb mc b">username</code>,将采用路线中提供的默认值。</p><p id="6511" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们获取存储库数据并将其发送到<code class="fe lz ma mb mc b">repos.ejb</code>模板，我们循环遍历它并显示结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">更新的index.js</figcaption></figure><p id="091b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用下面的代码在<code class="fe lz ma mb mc b">views</code>文件夹中创建一个新的<code class="fe lz ma mb mc b">repos.ejs</code>文件</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">repos.ejs</figcaption></figure><p id="ceb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你在这里看到的，我们在<code class="fe lz ma mb mc b">&lt;%</code>和<code class="fe lz ma mb mc b">%&gt;</code>之间写了JavaScript代码。在本例中，我们添加了一个JavaScript <code class="fe lz ma mb mc b">forEach</code>循环来遍历从<code class="fe lz ma mb mc b">index.js</code>传递来的repos对象。</p><p id="b819" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你可以看到GitHub用户提供的资源库:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/899db71d7aafc6016bfb5bc07f31c535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xjdpsLe1QW9c0HlKOcLL3Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">存储库列表应用程序</figcaption></figure><h2 id="ac83" class="mp mq iq bd nc nd ne dn nf ng nh dp ni lf nj nk nl lj nm nn no ln np nq nr ns bi translated"><strong class="ak">自定义默认模板目录</strong></h2><p id="dc7f" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">默认情况下，EJS会在项目的<code class="fe lz ma mb mc b">views</code>文件夹中寻找<code class="fe lz ma mb mc b">.ejs</code>文件，如果没有找到，它会抛出一个错误。我们还可以为<code class="fe lz ma mb mc b">views</code>目录提供自定义路径。</p><p id="cd6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，如果我们想在<code class="fe lz ma mb mc b">templates</code>文件夹中存储一个<code class="fe lz ma mb mc b">views</code>文件夹，我们可以通过将其设置为express app来指定路径。</p><pre class="kg kh ki kj gt ml mc mm mn aw mo bi"><span id="e989" class="mp mq iq mc b gy mr ms l mt mu">const path = require("path");</span><span id="41b5" class="mp mq iq mc b gy og ms l mt mu">const viewsDirPath = path.join(__dirname, "templates", "views");</span><span id="ffc4" class="mp mq iq mc b gy og ms l mt mu">app.set("views", viewsDirPath);</span></pre><p id="7412" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里找到这个应用程序的完整源代码<a class="ae kv" href="https://github.com/myogeshchavan97/templating-nodejs" rel="noopener ugc nofollow" target="_blank">和现场演示</a><a class="ae kv" href="https://templating-nodejs.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">这里</a></p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><p id="b05a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看看我最近出版的<a class="ae kv" href="https://master-redux.yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank">掌握Redux </a>课程。</p><p id="c684" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本课程中，您将构建3个应用程序以及一个点餐应用程序，您将了解:</p><ul class=""><li id="5391" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated">基本和高级冗余</li><li id="9b0f" class="oj ok iq ky b kz os lc ot lf ou lj ov ln ow lr oo op oq or bi translated">如何管理数组和对象的复杂状态</li><li id="c39a" class="oj ok iq ky b kz os lc ot lf ou lj ov ln ow lr oo op oq or bi translated">如何使用多个减速器管理复杂的冗余状态</li><li id="4faf" class="oj ok iq ky b kz os lc ot lf ou lj ov ln ow lr oo op oq or bi translated">如何调试Redux应用程序</li><li id="4c20" class="oj ok iq ky b kz os lc ot lf ou lj ov ln ow lr oo op oq or bi translated">如何在React中使用Redux使用react-redux库让你的app反应性。</li><li id="3315" class="oj ok iq ky b kz os lc ot lf ou lj ov ln ow lr oo op oq or bi translated">如何使用redux-thunk库处理异步API调用等等</li></ul><p id="64d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们将从头开始构建一个完整的<a class="ae kv" href="https://www.youtube.com/watch?v=2zaPDfCKAvM" rel="noopener ugc nofollow" target="_blank">订餐应用</a>，集成stripe以接受支付，并将其部署到生产中。</p><p id="af0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">别忘了订阅我的每周简讯，里面有惊人的技巧、诀窍和文章，直接在这里的收件箱</strong> <a class="ae kv" href="https://yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">订阅。</strong> </a></p></div></div>    
</body>
</html>