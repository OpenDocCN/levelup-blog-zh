<html>
<head>
<title>Meet the Beyonce of Python Graphing Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">认识一下Python图形库的碧昂斯</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/meet-the-beyonce-of-python-graphing-libraries-1e068cb6076d?source=collection_archive---------9-----------------------#2021-04-02">https://levelup.gitconnected.com/meet-the-beyonce-of-python-graphing-libraries-1e068cb6076d?source=collection_archive---------9-----------------------#2021-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="76fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6周前，我辞去了管理咨询的工作，创办了一个数据科学训练营。我的世界从漂亮的幻灯片和连续的微软团队会议到行星、动物和死亡语言(阅读:Jupyter笔记本、Python、熊猫和数学符号中的统计)。</p><p id="9c4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的咨询生涯中，有一件事我会一直坚持，那就是讲故事的重要性。如果没有人知道如何使用它们以及它们为什么重要，谁会关心我能建立多少模型呢？正如谚语所说，一幅画胜过千言万语。</p><blockquote class="kl km kn"><p id="cfc7" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">在数据科学和分析领域，干净、清晰、简单的视觉效果的重要性怎么强调都不为过。</p></blockquote><h1 id="6c88" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">Matplotlib</h1><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="lv lw l"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">如果matplotlib是一个人，他们可能看起来像这样</figcaption></figure><p id="c885" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何对数据科学有所涉猎的人都可能已经了解过Matplotlib，这是一个标准的免费绘图库，其灵感来自于更复杂/更难访问的MATLAB。它使用起来简单直观，非常适合初学者。</p><p id="39ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题是… <strong class="jp ir">它很丑</strong>，美学定制会占用大量代码。</p><h1 id="c3ed" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">输入:Plotly</h1><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="mb lw l"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">Plotly是图形库的碧昂斯</figcaption></figure><p id="82d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Plotly是一个免费的开源图形库，可用于多种编码语言，包括Python、Javascript和r。虽然plotly和matplotlib在结构和功能上相似，但plotly优于matplotlib的三个明显优势是:</p><ol class=""><li id="7adb" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mh mi mj mk bi translated">更容易做出更具美感的视觉效果</li><li id="5b54" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">默认情况下，Plotly图形是交互式的</li><li id="0532" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">只用一行代码就可以实现动画</li></ol><h1 id="97f6" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">对比时间！</h1><p id="e4a2" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">让我们演示一些简单的例子。</p><p id="965b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，导入我们将在整个示例中使用的标准包。</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="d370" class="na kt iq mw b gy nb nc l nd ne">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import plotly.express as px<br/>import plotly.graph_objects as go<br/>from plotly.subplots import make_subplots</span></pre><h2 id="a016" class="na kt iq bd ku nf ng dn ky nh ni dp lc jy nj nk lg kc nl nm lk kg nn no lo np bi translated">1.美学:</h2><p id="deb8" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">我们将从一个非常简单的散点图开始，展示每个库的基本美学。</p><p id="0680" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为二维曲线创建一些样本数据，并使用matplotlib绘图:</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="ded5" class="na kt iq mw b gy nb nc l nd ne">xaxis = np.linspace(0, 10, 100)<br/>yaxis = np.sin(xaxis)</span><span id="6e74" class="na kt iq mw b gy nq nc l nd ne">mat_scatter = plt.scatter(x=xaxis, y=yaxis)<br/>plt.title('Basic Matplotlib Scatter')<br/>plt.show();</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e84dc5fed00529b203814de79a5031b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*d778IJvXoawIJRwBM2V3Wg.png"/></div></figure><p id="7ae6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用plotly的express模块绘制相同的样本数据:</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="388d" class="na kt iq mw b gy nb nc l nd ne">plotly_scatter = px.scatter(x=xaxis, y=yaxis, title='Basic Plotly Scatter')<br/>plotly_scatter.show()</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f0d52a41280ff6b78ca6fe5df297130c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKACWB_0-9neXBEncRk16Q.png"/></div></figure><p id="dfab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">马上，plotly的数字在视觉上更令人愉快，虽然我认为这是主观的简单程度。Plotly还会根据使用的变量自动添加轴标签，而我必须在matplotlib中编写代码。您还可以看到，plotly使用较少的方法接受更多的参数(例如:设置绘图的标题)。</p><h2 id="278d" class="na kt iq bd ku nf ng dn ky nh ni dp lc jy nj nk lg kc nl nm lk kg nn no lo np bi translated">2.交互性:</h2><p id="8859" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">直方图是展示plotly的开箱即用交互性的一种很好的方式。</p><p id="ba1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用熊猫的一个数据集创建一个数据框架，然后根据分类“物种”列分割出3个不同的数据框架。这将为我们演示如何在一个图形上创建多个图。</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="91c8" class="na kt iq mw b gy nb nc l nd ne">df = px.data.iris()<br/>setosa_df = df[df['species'] == 'setosa']<br/>versicolor_df = df[df['species'] == 'versicolor']<br/>virginica_df = df[df['species'] == 'virginica']</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/7f0ec0f171f03d7ab61bc2731aeb00b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*iCYgviqQMruUKxBDFgzMQQ.jpeg"/></div></figure><p id="0dba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用matplotlib绘制setosa物种花瓣长度直方图:</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="6007" class="na kt iq mw b gy nb nc l nd ne">mat_hist = plt.hist(x=setosa_df['petal_length'])<br/>plt.title('Matplotlib Histogram - Setosa Petal Lengths')<br/>plt.xlabel('Petal Length')<br/>plt.ylabel('Count')</span><span id="3846" class="na kt iq mw b gy nq nc l nd ne">plt.savefig('images/mat_hist.png')<br/>plt.show();</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/813954b046b21eb4c518cff8e0382239.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*H5zCDK_BacTRxGLTe4mzFw.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">根据上面的代码编写的PNG文件</figcaption></figure><p id="0ec7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用plotly express绘制相同的直方图:</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="f5de" class="na kt iq mw b gy nb nc l nd ne">plotly_hist = px.histogram(setosa_df, x='petal_length', title='Plotly Histogram - Setosa Petal Lengths', labels={'petal_length': 'Petal Length'})</span><span id="746a" class="na kt iq mw b gy nq nc l nd ne">plotly_hist.write_html('images/plotlyhistogram.html')<br/>plotly_hist.write_image('images/plotly_hist.png')<br/>plotly_hist.show()</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/baf7f0e963f4516a9e0c51eb4bed406e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w2dzicCNzWloVfKOdvQuNg.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">PNG文件由上面的plotly代码编写</figcaption></figure><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="nw lw l"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">演示用上面的plotly代码编写的交互式HTML</figcaption></figure><p id="1f58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是比较变得更好的地方。</p><p id="21c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，Plotly图形是交互式的，这意味着您可以将鼠标悬停在图形上以查看底层数据的详细信息，放大/缩小等。不需要添加任何代码。在我们的setosa花瓣长度直方图示例中，用户可以将鼠标悬停在每个条柱上，以查看在该条柱中捕获的x值的范围(在本例中，是花瓣长度的范围)，以及落入该条柱的元素的计数。使用数据框中的列标题自动标记x轴。向“labels”参数传递一个original value: desired label的字典，对于可能不太熟悉底层数据集的用户来说，我可以轻松地使这些标签更加直观。您可以将图形保存为静态PNG/JPG文件或在web浏览器中打开的交互式HTML文件。图形的交互版本在Jupyter Notebook中自动渲染。</p><h2 id="8da6" class="na kt iq bd ku nf ng dn ky nh ni dp lc jy nj nk lg kc nl nm lk kg nn no lo np bi translated">快速旁白——支线剧情:</h2><p id="4482" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">matplotlib和plotly都可以在一个图形上绘制多个支线剧情来显示对比。我们将演示在虹膜上使用相同的数据。</p><p id="2ed5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用matplotlib，创建一个有3列的图形，然后在图形上绘制每个物种花瓣长度的直方图。</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="2dcd" class="na kt iq mw b gy nb nc l nd ne">mat_hist_fig, axes = plt.subplots(ncols=3, figsize=(15,5), sharex=True, sharey=True)<br/>mat_hist_fig.set_tight_layout(tight=True)<br/>mat_hist_fig.suptitle('Matplotlib Histograms - Iris Petal Lengths by Species')</span><span id="3522" class="na kt iq mw b gy nq nc l nd ne">axes[0].hist(setosa_df['petal_length'], bins=5, color='navy')<br/>axes[0].set_title('Setosa')<br/>axes[0].set(ylabel='Count')<br/>axes[0].set(xlabel='Petal Length')</span><span id="0805" class="na kt iq mw b gy nq nc l nd ne">axes[1].hist(versicolor_df['petal_length'], bins=5, color='purple')<br/>axes[1].set_title('Versicolor')<br/>axes[1].set(xlabel='Petal Length')</span><span id="095b" class="na kt iq mw b gy nq nc l nd ne">axes[2].hist(virginica_df['petal_length'], bins=5, color='cornflowerblue')<br/>axes[2].set_title('Virginica')<br/>axes[2].set(xlabel='Petal Length')</span><span id="1d0a" class="na kt iq mw b gy nq nc l nd ne">mat_hist_fig.savefig('images/mat_hist_fig.png');</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi nx"><img src="../Images/2db3a8dc9551b72993da7ef2aeb2aebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*azwO-QvanF_iMhRLac7kLQ.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">上面代码写的PNG文件</figcaption></figure><p id="6114" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样的，使用plotly的支线剧情模块，制作一个有3个支线剧情的人物，并给他们标题。然后，更新地物标题，关闭图例以节省空间，并设置x轴和y轴标签。使用plotly的图形对象模块将轨迹添加到图形中的每个子图形。</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="1b68" class="na kt iq mw b gy nb nc l nd ne">plotly_hist_fig = make_subplots(rows=1, cols=3, subplot_titles=('Setosa', 'Versicolor', 'Virginica'), shared_yaxes=True, shared_xaxes=True, horizontal_spacing=.02)</span><span id="e07a" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_fig.update_layout(title_text='Plotly Histograms - Iris Petal Lengths by Species', showlegend=False, height=400)</span><span id="2f1d" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_fig.update_xaxes(title_text='Petal Length', range=[0,8])<br/>plotly_hist_fig.update_yaxes(title_text='Count', col=1)</span><span id="4a23" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_fig.add_trace(<br/>    go.Histogram(x=setosa_df['petal_length'], name='Setosa', marker_color='navy', nbinsx=5),<br/>    1, 1)</span><span id="5581" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_fig.add_trace(<br/>    go.Histogram(x=versicolor_df['petal_length'], name='Versicolor', marker_color='purple', nbinsx=5),<br/>    1, 2)</span><span id="cd80" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_fig.add_trace(<br/>    go.Histogram(x=virginica_df['petal_length'], name='Virginica', marker_color='cornflowerblue', nbinsx=5),<br/>    1, 3)</span><span id="6606" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_fig.write_image('images/plotly_hist_fig.png')<br/>plotly_hist_fig.show()</span></pre><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/da62a0266290d1ccc7016d5ee61e5b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMJ2-H1GHUr6Ey2sJj4ncQ.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">上面用plotly代码写的PNG文件</figcaption></figure><p id="3767" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总的来说，这两个库使用了非常相似的概念。我发现在plotly中定制更容易，因为有更多参数的方法更少，与matplotlib相反，matplotlib通过直接在图形/子图形上调用更多方法来应用定制。正如这里所看到的，使用plotly进行调整更容易实现。</p><h2 id="db8a" class="na kt iq bd ku nf ng dn ky nh ni dp lc jy nj nk lg kc nl nm lk kg nn no lo np bi translated">3.动画:</h2><p id="8e9d" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">我发现使用plotly最酷的事情是它的绝对防呆动画定制。</p><p id="305a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用与上图相同的数据和场景，通过将“animation_frame”参数设置为分类元素(在本例中为物种)，在plotly中创建动画直方图。</p><pre class="lq lr ls lt gt mv mw mx my aw mz bi"><span id="6da9" class="na kt iq mw b gy nb nc l nd ne">plotly_hist_anim = px.histogram(df, x='petal_length', nbins=5, title='Plotly Histogram - Iris Petal Lengths', labels={'petal_length': 'Petal Length'}, <strong class="mw ir">animation_frame='species'</strong>, color='species', color_discrete_sequence=['navy', 'purple', 'cornflowerblue'])</span><span id="fdd5" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_anim.update_layout(xaxis_range=(0, df['petal_length'].max()), yaxis_range=(0, 25))</span><span id="3c19" class="na kt iq mw b gy nq nc l nd ne">plotly_hist_anim.write_html('images/plotly_hist_anim.html')<br/>plotly_hist_anim.show()</span></pre><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="oc lw l"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">演示由上面的plotly代码生成的动画图形</figcaption></figure><p id="ac1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这张图表的复杂程度令人难以置信，因为它只需要很少的几行代码。几乎任何分类数据元素(最多可能有10-15个唯一值)都可以传递到动画参数中，以快速显示比较结果，并包括用户友好的过滤功能。</p></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><h1 id="a114" class="ks kt iq bd ku kv ok kx ky kz ol lb lc ld om lf lg lh on lj lk ll oo ln lo lp bi translated">结论</h1><p id="b84b" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">从几个简单的例子中可以看出，plotly在简单性、优雅性、交互性和动画方面远远超过了matplotlib的图形库，因此即使您的ETL也可以很漂亮。</p><p id="2d2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来要探索的是:plotly的<a class="ae op" href="https://dash.plotly.com/introduction" rel="noopener ugc nofollow" target="_blank"> Dash </a>，用它可以用纯Python代码创建基于web的交互式数据可视化应用。</p><h1 id="8040" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">其他资源:</h1><p id="7c13" class="pw-post-body-paragraph jn jo iq jp b jq mq js jt ju mr jw jx jy ms ka kb kc mt ke kf kg mu ki kj kk ij bi translated">Badreesh Shetty写了一篇精彩的博客详细介绍Matplotlib库。</p><p id="5b22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae op" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank"> Plotly的文档</a>很好，也很容易浏览，尽管我偶然发现了一些过时的东西，所以请做好反复试验的准备。他们展示了很多更高级的例子和图表类型。</p></div></div>    
</body>
</html>