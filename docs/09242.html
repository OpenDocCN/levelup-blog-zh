<html>
<head>
<title>Build a Page Control using SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SwiftUI构建页面控件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-a-page-control-using-swiftui-7e87c7be3028?source=collection_archive---------4-----------------------#2021-07-20">https://levelup.gitconnected.com/build-a-page-control-using-swiftui-7e87c7be3028?source=collection_archive---------4-----------------------#2021-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e151" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将SwiftUI与Maths结合起来，用几行代码构建一个页面控件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0108442af31c7f9e5f8559ac4c852fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*43AP-TtJoP0HvXRz5Wwetw.png"/></div></div></figure><p id="e3cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，您将学习构建一个非常常见的应用程序组件:页面控件。这将通过SwiftUI来实现。此外，我们将使用数学来提供一个简洁明了的解决方案。</p><p id="0b39" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们首先创建一个名为<code class="fe lq lr ls lt b">PageControl</code>的新SwiftUI视图。我们希望组件尽可能具有动态性和可配置性，因此我们使用以下参数来定义视图方面:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="c5d2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当前选择的页面(<code class="fe lq lr ls lt b">selectedPage</code>)将随着用户在页面中前进而改变。出于这个原因，我们用<code class="fe lq lr ls lt b">@Binding</code>来包装它。请注意，总页数(<code class="fe lq lr ls lt b">pages</code>)、圆直径和边距不应改变，因此我们在这些情况下不包括包装纸。</p><p id="eca5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您不确定为什么这里需要这个包装器，我建议您查看以下关于SwiftUI中数据流的文章:</p><div class="lw lx gp gr ly lz"><a href="https://medium.com/swlh/data-flow-in-swiftui-getting-started-with-state-and-binding-da3ba97fb144" rel="noopener follow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">SwiftUI中的数据流—状态和绑定入门</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">从头开始学习如何在SwiftUI中连接数据</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">medium.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ks lz"/></div></div></a></div><p id="1d03" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">继续查看。我们可以很容易地创建一个页面控件组件，只需使用如下的<code class="fe lq lr ls lt b">Circle</code>形状:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="fa6c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">正如你所看到的，我们使用<code class="fe lq lr ls lt b">circleDiameter</code>来设置圆圈的框架。填充的那个代表当前页面索引。为了显示这组页面，我们使用了一个带有笔画圆的<code class="fe lq lr ls lt b">ForEach</code>循环。</p><p id="159c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们预览此视图，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="86b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">结果将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/212d3b4904274a2339ca2e0aa74611a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*AsPcqXx1_epzm9HJxfwzoA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">页面控制预览</figcaption></figure><p id="f724" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此时，代表当前页面索引的圆居中。如果我们想要一个页面控制功能，那么我们就必须改变它的位置。为此，我们将使用数学。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="e158" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">基本上，我们要计算第一个圆的位置和它们之间的距离。知道了这一点，我们就可以很容易地使用以下方法获得页面索引位置:</p><ul class=""><li id="90a1" class="na nb it kw b kx ky la lb ld nc lh nd ll ne lp nf ng nh ni bi translated"><em class="nj">索引位置=初始位置+(距离下一点</em> ✕ <em class="nj">页面索引)</em></li></ul><p id="cd81" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了计算初始位置，首先我们需要堆栈的总宽度。为此，我们将使用圆圈的数据，如:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/c2b86bbddf0e6b038a223a6cb9ca3e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QyEMHELIj6OinWqXOiAVCQ.png"/></div></div></figure><pre class="kj kk kl km gt nl lt nm nn aw no bi"><span id="57f5" class="np nq it lt b gy nr ns l nt nu"><strong class="lt iu">let</strong> stackWidth = circleDiameter * CGFloat(pages) <br/>                 + circleMargin * CGFloat(pages - 1)</span></pre><p id="4e6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们之前说过，当前页面索引居中。所以如果我们把它的位置延迟一段相当于一半<code class="fe lq lr ls lt b">stackWidth</code>的距离，那么它就会被放在栈的开头。类似于:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/e6638c5fe6ab3c0ff9f333b60f705e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LmrgKBhW-ouHxmGuCNPb6A.png"/></div></div></figure><p id="06ab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，使用圆的半径，我们可以把它放在想要的位置。因此，我们可以将其定义为初始点位置。这是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/e4db9deea953f996a98c1f2a8f905b62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zG8mYEUsRtYvnjLHhzvLpQ.png"/></div></div></figure><pre class="kj kk kl km gt nl lt nm nn aw no bi"><span id="8b22" class="np nq it lt b gy nr ns l nt nu"><strong class="lt iu">let</strong> halfStackWidth = stackWidth / 2</span><span id="1968" class="np nq it lt b gy nw ns l nt nu"><strong class="lt iu">let</strong> iniPosition = -halfStackWidth + circleRadius</span></pre><p id="6b57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意d<em class="nj">istancenext point</em>是直径和边缘圆的总和；</p><pre class="kj kk kl km gt nl lt nm nn aw no bi"><span id="d765" class="np nq it lt b gy nr ns l nt nu"><strong class="lt iu">let</strong> distanceToNextPoint = circleDiameter + circleMargin</span></pre><p id="48d7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了所有这些信息和<code class="fe lq lr ls lt b">pageIndex</code>，我们可以得到当前圆的位置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/de082d01cdebce65844ddba576db1f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5KWNscTQ353wDLDq3c6ew.png"/></div></div></figure><p id="3c83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将把所有这些计算设置为私有计算属性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="47fe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回到视图，我们只需要给页面索引圈添加一些修饰符。它将根据那个<code class="fe lq lr ls lt b">currentPosition</code>属性改变它的<code class="fe lq lr ls lt b">x</code>位置。此外，我们将添加一个动画块:</p><pre class="kj kk kl km gt nl lt nm nn aw no bi"><span id="9471" class="np nq it lt b gy nr ns l nt nu">.offset(x: currentPosition)</span><span id="1836" class="np nq it lt b gy nw ns l nt nu">.animation(.linear(duration: 0.3))</span></pre><p id="2a57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">综上所述，最终结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/6450267b383cb426658c1ce0cacb75e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/1*Yr2OYTpLjkKay7UI9NxZug.gif"/></div></figure><p id="ee2e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在我的<a class="ae ny" href="https://github.com/KeatoonMask/SwiftUI-Animation/blob/master/SwiftUI-Animation/Animations/PageControl/PageControl.swift" rel="noopener ugc nofollow" target="_blank">库</a>上找到完整的代码。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="3c87" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您对这些内容感兴趣，并希望看到更多内容，您可以开始该项目或在Instagram中关注我:</p><ul class=""><li id="a889" class="na nb it kw b kx ky la lb ld nc lh nd ll ne lp nf ng nh ni bi translated">【https://github.com/KeatoonMask/SwiftUI-Animation T4】</li><li id="0f5a" class="na nb it kw b kx nz la oa ld ob lh oc ll od lp nf ng nh ni bi translated"><a class="ae ny" href="https://www.instagram.com/finsi.code" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/finsi.code</a></li></ul><p id="7105" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢您的阅读，下次再见😁</p></div></div>    
</body>
</html>