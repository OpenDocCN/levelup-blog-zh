<html>
<head>
<title>Web Scraping Made Simple with Octoparse</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Octoparse简化了网页抓取</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/web-scraping-made-simple-with-octoparse-9a966d888414?source=collection_archive---------7-----------------------#2021-04-27">https://levelup.gitconnected.com/web-scraping-made-simple-with-octoparse-9a966d888414?source=collection_archive---------7-----------------------#2021-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9dc6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">轻松提取数据并将其存储在Google Sheets文档中</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4ac615536bbd9cd0bcd154c1fcbe4110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ctkVLtsDTp-FpA756Am5A.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">迪安·普在<a class="ae ky" href="https://unsplash.com/s/photos/python?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="5c79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，我在寻找一种从网站上轻松抓取数据的方法。事实上，众所周知，<a class="ae ky" href="https://codeburst.io/how-to-build-an-api-to-perform-web-scraping-in-spring-boot-e8bfaaa4622e" rel="noopener" target="_blank">手动抓取网页会变成一项繁琐耗时的任务</a>。当我在网上搜索更智能的解决方案来避免这些缺点时，我遇到了Octoparse。</p><div class="lv lw gp gr lx ly"><a href="https://codeburst.io/how-to-build-an-api-to-perform-web-scraping-in-spring-boot-e8bfaaa4622e" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">如何在Spring Boot建立一个API来执行网页抓取</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">动态抓取网页以检索公共数据</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">codeburst.io</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="c8ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Octoparse是一个网页抓取服务，它允许你从多个网站中提取数据，而不需要任何代码。因此，任何人都可以使用这个无代码工具。如果你想了解更多关于网页抓取的信息，请点击<a class="ae ky" href="https://www.octoparse.com/blog/what-is-web-scraping-basics-and-use-cases" rel="noopener ugc nofollow" target="_blank">链接。</a></p><div class="lv lw gp gr lx ly"><a href="https://www.octoparse.com/blog/what-is-web-scraping-basics-and-use-cases" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">什么是网络抓取-基础和实际用途</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">带领你进入网络抓取世界的基本介绍。什么是网页抓取？它是如何工作的，如何使用的？什么…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.octoparse.com</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm ks ly"/></div></div></a></div><p id="68dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，它提供了<a class="ae ky" href="https://helpcenter.octoparse.com/hc/en-us/articles/360026820692-Data-Export-API-and-Advanced-API" rel="noopener ugc nofollow" target="_blank">官方API</a>来按需执行之前定义的抓取任务，并将提取的数据保存在CSV、TXT、Excel、HTML或数据库中。这样，您可以同时拥有无代码工具和高级手动工具的优点。</p><p id="c12d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何使用Octoparse创建一个抓取任务，从Python脚本执行它，并将提取的数据保存在Google Sheets文档中。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="251b" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">什么是八解析</h1><blockquote class="nn no np"><p id="cf27" class="kz la nq lb b lc ld ju le lf lg jx lh nr lj lk ll ns ln lo lp nt lr ls lt lu im bi translated">“Octoparse是一个极其强大的数据提取工具，它优化并推动了我们的数据抓取工作到了一个新的水平”——<a class="ae ky" href="https://www.octoparse.com/" rel="noopener ugc nofollow" target="_blank">Octoparse官网</a></p></blockquote><p id="43b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Octoparse是一个强大的网站爬虫,旨在从网络上提取你需要的各种数据。它提供了大量的功能，包括<a class="ae ky" href="https://www.octoparse.com/blog/extract-data-with-auto-detection" rel="noopener ugc nofollow" target="_blank">自动检测</a>、<a class="ae ky" href="https://service.octoparse.com/webscrapingtemplates" rel="noopener ugc nofollow" target="_blank">任务模板</a>和<a class="ae ky" href="https://helpcenter.octoparse.com/hc/en-us/articles/900003268086-Advanced-Mode-Build-your-own-crawler-using-point-and-click-Version-8-" rel="noopener ugc nofollow" target="_blank">高级模式</a>。</p><p id="c519" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一种是基于自动检测算法，设计用于自动抓取包含嵌套在列表或表格中的项目的页面。第二种是一种简单的方法，它基于许多预先构建的模板收集数据，任何人都可以毫不费力地使用这些模板。而第三种是为那些需要更多定制需求的用户设计的灵活而强大的模式。</p><p id="431f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每种情况下，Octoparse都包含一个用户友好的点击式界面，旨在指导您完成整个数据提取过程。然后，从多个网站提取的数据可以很容易地以多种格式保存和组织。</p><p id="afff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，它还提供了一个<a class="ae ky" href="https://www.octoparse.com/blog/extracting-dynamic-data-with-octoparse" rel="noopener ugc nofollow" target="_blank">预定云提取功能</a>来实时提取动态数据。然后，它还附带了一个API程序，我将很快向您展示如何使用。</p><p id="32a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，尽管该工具再现了人类活动以与网页通信并避免在抓取时被检测到，但它也提供了IP代理服务器。它们可用于攻击性网站<a class="ae ky" href="https://betterprogramming.pub/building-a-rotating-ip-and-user-agent-web-scraping-script-in-php-277bde659d20" rel="noopener ugc nofollow" target="_blank">隐藏IP并避免IP拦截</a>。</p><div class="lv lw gp gr lx ly"><a href="https://betterprogramming.pub/building-a-rotating-ip-and-user-agent-web-scraping-script-in-php-277bde659d20" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">用PHP构建一个旋转的IP和用户代理Web抓取脚本</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">强大、先进、现代的网络抓取</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">better编程. pub</p></div></div><div class="mh l"><div class="nu l mj mk ml mh mm ks ly"/></div></div></a></div><p id="b28d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总之，Octoparse满足了大多数用户的抓取需求，无论是基本的还是高级的，不需要任何编码技能。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="3b4d" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">创建数据提取任务</h1><p id="8238" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">假设我们想从维基百科页面的<a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_countries_and_dependencies_by_population" rel="noopener ugc nofollow" target="_blank">列表中抓取数据。这是一个很好的例子，一个网页的数据随着时间的推移频繁更新。</a></p><p id="9274" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将看到如何安装Octoparse。然后，我们将定义一个旨在从该网页的主表中提取数据的抓取任务。</p><h2 id="9d70" class="oa mw it bd mx ob oc dn nb od oe dp nf li of og nh lm oh oi nj lq oj ok nl ol bi translated">1.Octoparse入门</h2><p id="9c53" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">首先，你需要安装Octoparse。在本教程中，我将使用<strong class="lb iu"> Octoparse 8.x </strong>，可以从这里下载:<a class="ae ky" href="https://www.octoparse.com/download" rel="noopener ugc nofollow" target="_blank">https://www.octoparse.com/download</a>。</p><p id="61d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，遵循以下几个步骤:</p><ol class=""><li id="cfd9" class="om on it lb b lc ld lf lg li oo lm op lq oq lu or os ot ou bi translated">解压缩下载的安装程序文件</li><li id="6a98" class="om on it lb b lc ov lf ow li ox lm oy lq oz lu or os ot ou bi translated">运行<em class="nq">octoparsetup . MSI</em>文件</li><li id="e2ab" class="om on it lb b lc ov lf ow li ox lm oy lq oz lu or os ot ou bi translated">遵循安装说明</li><li id="8ad1" class="om on it lb b lc ov lf ow li ox lm oy lq oz lu or os ot ou bi translated">用你的Octoparse帐户登录，或者如果你还没有帐户，在这里注册<a class="ae ky" href="https://www.octoparse.com/signup" rel="noopener ugc nofollow" target="_blank"/>。</li></ol><p id="1bb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，注册是免费的，但是为了访问API特性，需要一个标准计划。你可以在这里找到Octoparse <a class="ae ky" href="https://www.octoparse.com/pricing" rel="noopener ugc nofollow" target="_blank">提供的所有计划信息。</a></p><p id="8c86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经具备了开始利用Octoparse的能力所需的一切。</p><h2 id="e592" class="oa mw it bd mx ob oc dn nb od oe dp nf li of og nh lm oh oi nj lq oj ok nl ol bi translated">2.创建任务</h2><p id="141e" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">因为目标是提取存储在表中的数据，所以强烈建议按照官方文档中的<a class="ae ky" href="https://helpcenter.octoparse.com/hc/en-us/articles/900001295403" rel="noopener ugc nofollow" target="_blank">指南来完成。</a></p><p id="ede2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">启动Octoparse，登录，在主字段中输入您想要的URL，然后单击<em class="nq">开始</em>按钮。通过这种方式，系统将使用自动检测算法，这种算法非常适合由表组成的页面，例如:<code class="fe pa pb pc pd b"><a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_countries_and_dependencies_by_population" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/List_of_countries_and_dependencies_by_population</a></code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9b82e688e9dc9c6b8e2951c2c9181493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mEkqyfV93cb9is7NiY4e3A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">输入输入URL</figcaption></figure><p id="b88c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">等待加载页面并检测数据。当自动检测完成时，按照<em class="nq">提示</em>面板上的指示，在预览部分检查您的数据。最后，重命名数据字段或删除不需要的数据字段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fb997dfe95e8d5c4cffbfb50d1d9ee28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRBYidljztGSNHI_DvP1SQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">最终提取数据任务</figcaption></figure><p id="ec4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，点击提示面板上的<em class="nq">创建工作流程</em>按钮。其次，点击<em class="nq">保存</em>按钮<em class="nq">顶栏中的</em>。然后，转到<em class="nq">仪表板</em>视图，您应该会看到您刚刚定义的任务，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0070cbe0463646a7ff800a7ed7a2bb00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7N_rAwCCBzmtkIj_zMfZkw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">“仪表板”视图</figcaption></figure><p id="8881" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，您可以重命名您的任务，在本地或云中执行它们。任务完成！您现在可以访问提取的数据了。教程现在可以结束了，但是如果你想通过API运行这个任务，你需要从<em class="nq">更多&gt;云运行</em>菜单中点击<em class="nq"> API </em>选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/35d6bb6d0b12abe5ae8adcee2d214326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WqCw4sbQFcPLlA8eJvbk-Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">访问“API”选项</figcaption></figure><p id="3301" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，将出现另一个显示您的任务ID的窗口。你以后会需要它，所以记得把它保存在一个安全的地方。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/5cedbf34eda04b00116d9b7300d31d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*RsQLu9JJk5o9V7aJm3evOQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">“任务ID”窗口</figcaption></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="8c4e" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">使用Python以编程方式运行任务</h1><p id="3fe5" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">现在，是时候深入研究如何使用Octoparse APIs创建一个脚本，旨在以编程方式运行之前定义的任务，并将提取的数据保存在Google Sheets文档中。</p><p id="f88c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，正如官方文件中所述，最后一个目标只能通过API来实现。具体而言，您可以使用以下Python脚本来实现这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="14e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，执行登录，然后调用<a class="ae ky" href="http://advancedapi.octoparse.com/help#_actions_AllDataGetDataOfTaskByOffset" rel="noopener ugc nofollow" target="_blank"><em class="nq">Get Data By Offset</em>API</a>来启动所需的任务并检索JSON格式的提取数据。这些数据被转换成CSV格式，最后使用<code class="fe pa pb pc pd b"><a class="ae ky" href="https://gspread.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">gspread</a></code>库导入到Google Sheets文档中。</p><p id="f067" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行该脚本后，您将能够看到由Octoparse任务提取的数据保存在您选择的Google Sheets文档中，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/414965ec719b7234a5d2becf6b470bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TxnKaXH4JNlcZJHzuImbog.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">填充了数据的Google Sheets文档</figcaption></figure><p id="fea2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊！只用几行代码就实现了目标。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="b15d" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">结论</h1><p id="eb2c" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">在本文中，我们研究了如何使用Octoparse(一个强大的数据提取工具)来轻松创建一个抓取任务。然后，我们看到了如何将这样的任务集成到Python脚本中，以编程方式运行，并将提取的数据保存在Google Sheets文档中。如图所示，由于官方的Octoparse API程序，这是可能的，它将Octoparse变成了一个无代码但非常先进的工具。</p><p id="e975" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！我希望这篇文章对你有所帮助。如果有任何问题、意见或建议，请随时联系我。</p></div></div>    
</body>
</html>