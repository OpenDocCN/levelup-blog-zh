<html>
<head>
<title>JavaScript Events Handlers — Input Events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript事件处理程序—输入事件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-events-handlers-input-events-2f9f8a336e4b?source=collection_archive---------15-----------------------#2020-01-15">https://levelup.gitconnected.com/javascript-events-handlers-input-events-2f9f8a336e4b?source=collection_archive---------15-----------------------#2020-01-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1c99ae8c1658da3224101ab28a319fb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*US45EWARyUwXs47s"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">斯科特·布雷克在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f93d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在JavaScript中，事件是应用程序中发生的动作。它们是由各种事情触发的，比如输入、提交表单、调整大小等元素变化，或者应用程序运行时发生的错误等。我们可以分配一个事件处理程序来响应和处理这些事件。发生在DOM元素上的事件可以通过为相应事件的DOM对象的属性分配一个事件处理程序来处理。在本文中，我们将看看如何使用可编辑输入元素的<code class="fe le lf lg lh b">oninput</code>和<code class="fe le lf lg lh b">oninvalid</code>属性。</p><h1 id="cd49" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">oninput</h1><p id="709a" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">DOM元素的<code class="fe le lf lg lh b">oninput</code>属性允许我们分配一个事件处理程序来处理<code class="fe le lf lg lh b">input</code>事件，当<code class="fe le lf lg lh b">input</code>、<code class="fe le lf lg lh b">select</code>或<code class="fe le lf lg lh b">textarea</code>元素的值被更改时，该事件被触发。当启用了<code class="fe le lf lg lh b">contenteditable</code>属性的元素中有任何内容时，它也会被触发；当<code class="fe le lf lg lh b">designMode</code>打开时，它也会被触发。在<code class="fe le lf lg lh b">contentEditable</code>和<code class="fe le lf lg lh b">designMode</code>的情况下，事件目标是编辑主机。如果这些属性应用于多个元素，则编辑宿主是其父元素不可编辑的最近的祖先元素。</p><p id="2a98" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于<code class="fe le lf lg lh b">type</code>属性设置为<code class="fe le lf lg lh b">checkbox</code>或<code class="fe le lf lg lh b">radio</code>的<code class="fe le lf lg lh b">input</code>元素，每当用户切换控件时，将触发<code class="fe le lf lg lh b">input</code>事件。然而，并非每个浏览器都是如此。</p><p id="5be6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当值改变时，触发<code class="fe le lf lg lh b">input</code>事件，不像<code class="fe le lf lg lh b">change</code>事件只在输入值被提交时触发，例如当用户按下回车键或从选项列表中选择一个值时，等等。</p><p id="a310" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以分配一个事件处理函数来记录输入事件的输入值，如下面的HTML代码所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="f0bb" class="mt lj it lh b gy mu mv l mw mx">&lt;input placeholder="Enter some text" name="name"/&gt;<br/>&lt;p id="value-log"&gt;&lt;/p&gt;</span></pre><p id="dfab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在JavaScript代码中，我们可以写:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="1f14" class="mt lj it lh b gy mu mv l mw mx">const input = document.querySelector('input');<br/>const log = document.getElementById('value-log');</span><span id="ed8c" class="mt lj it lh b gy my mv l mw mx">const updateValue = (e) =&gt; {<br/>  log.textContent = e.target.value;<br/>}</span><span id="0ea4" class="mt lj it lh b gy my mv l mw mx">input.oninput = updateValue;</span></pre><p id="6bad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们应该看到一个带有<code class="fe le lf lg lh b">p</code>元素的输入文本框，显示输入的值，因为它已经改变。</p><p id="ff63" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，我们可以将它用于一个<code class="fe le lf lg lh b">select</code>元素。首先，我们编写以下HTML代码:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="962f" class="mt lj it lh b gy mu mv l mw mx">&lt;select name="name"&gt;<br/>  &lt;option value='Apple'&gt;Apple&lt;/option&gt;<br/>  &lt;option value='Orange'&gt;Orange&lt;/option&gt;<br/>  &lt;option value='Grape'&gt;Grape&lt;/option&gt;<br/>&lt;/select&gt;<br/>&lt;p id="value-log"&gt;&lt;/p&gt;</span></pre><p id="9725" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后JavaScript与我们之前的非常相似:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="2bbd" class="mt lj it lh b gy mu mv l mw mx">const select = document.querySelector('select');<br/>const log = document.getElementById('value-log');</span><span id="18ae" class="mt lj it lh b gy my mv l mw mx">const updateValue = (e) =&gt; {<br/>  log.textContent = e.target.value;<br/>}</span><span id="6b73" class="mt lj it lh b gy my mv l mw mx">select.oninput = updateValue;</span></pre><p id="f31f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，该值仅在我们进行选择时显示，因此当我们第一次加载页面时不会显示任何值，因为我们没有选择任何内容。</p><p id="ff0d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于复选框，代码将与文本输入有很大的不同。如果我们想要记录选中的值，我们必须检查复选框是否被选中，然后获取值。</p><p id="004b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有下面的一些复选框的HTML代码:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="d183" class="mt lj it lh b gy mu mv l mw mx">&lt;input type='checkbox' value='Apple' name="name" id='0' /&gt; Apple<br/>&lt;input type='checkbox' value='Grape' name="name" id='1' /&gt; Grape<br/>&lt;input type='checkbox' value='Banana' name="name" id='2' /&gt; Banana<br/>&lt;p id="value-log"&gt;&lt;/p&gt;</span></pre><p id="b319" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们必须为每个复选框附加一个<code class="fe le lf lg lh b">oninput</code>事件处理函数，如下面的代码所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="d9c9" class="mt lj it lh b gy mu mv l mw mx">const checkboxes = document.querySelectorAll('input');<br/>const log = document.getElementById('value-log');</span><span id="b85b" class="mt lj it lh b gy my mv l mw mx">let choices = [];</span><span id="8cda" class="mt lj it lh b gy my mv l mw mx">const updateValue = (e) =&gt; {  <br/>  choices[e.target.id] = e.target.checked ? e.target.value : undefined;<br/>  log.textContent = choices.join(' ');<br/>}</span><span id="b7de" class="mt lj it lh b gy my mv l mw mx">checkboxes.forEach((c, i) =&gt; {<br/>  c.oninput = updateValue;<br/>})</span></pre><p id="cd59" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们遍历了所有的复选框元素，并将<code class="fe le lf lg lh b">updateValue</code>事件处理函数设置为每个复选框元素的<code class="fe le lf lg lh b">oninput</code>属性，然后在<code class="fe le lf lg lh b">updateValue</code>函数中，我们通过检查具有给定ID的复选框的<code class="fe le lf lg lh b">checked </code>值来设置<code class="fe le lf lg lh b">choices</code>数组中的条目，然后我们仅在通过检查<code class="fe le lf lg lh b">e.target.checked</code>属性来检查<code class="fe le lf lg lh b">choices</code>数组中的<code class="fe le lf lg lh b">value</code>时设置它。</p><p id="37de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于单选按钮，这比处理复选框更容易，因为一组单选按钮只有一个可能的选择。HTML代码类似于下面代码中的复选框:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="1ed3" class="mt lj it lh b gy mu mv l mw mx">&lt;input type='radio' value='Apple' name="name" id='0' /&gt; Apple<br/>&lt;input type='radio' value='Grape' name="name" id='1' /&gt; Grape<br/>&lt;input type='radio' value='Banana' name="name" id='2' /&gt; Banana<br/>&lt;p id="value-log"&gt;&lt;/p&gt;</span></pre><p id="6232" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，在JavaScript代码中，我们将一个事件处理函数附加到每个单选按钮元素，如下面的代码所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="bd40" class="mt lj it lh b gy mu mv l mw mx">const radioButtons = document.querySelectorAll('input');<br/>const log = document.getElementById('value-log');</span><span id="186d" class="mt lj it lh b gy my mv l mw mx">const updateValue = (e) =&gt; {  <br/>  log.textContent = e.target.value;<br/>}</span><span id="471d" class="mt lj it lh b gy my mv l mw mx">radioButtons.forEach((c, i) =&gt; {<br/>  c.oninput = updateValue;<br/>})</span></pre><p id="d678" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们直接在<code class="fe le lf lg lh b">value-log</code>元素中设置值，因为我们只需要当前选中的选项。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/c9201f8a9b8b3959212b8d79ccef1618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CgH5Q2Kgql-tsFYm"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@trommelkopf?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">史蒂夫·哈维</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="c7e9" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">on无效</h1><p id="fb21" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">我们可以通过设置DOM元素的<code class="fe le lf lg lh b">oninvalid</code>属性来分配一个事件处理程序来处理<code class="fe le lf lg lh b">invalid</code>事件。当submittable元素被检查并且输入验证失败时，触发<code class="fe le lf lg lh b">invalid</code>属性。例如，当一个<code class="fe le lf lg lh b">input</code>元素的输入不符合HTML代码中定义的要求时，它将被触发。通过检查<code class="fe le lf lg lh b">input</code>或<code class="fe le lf lg lh b">textarea</code>元素的<code class="fe le lf lg lh b">required</code>和<code class="fe le lf lg lh b">pattern</code>属性来完成验证。</p><p id="00f7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以用它来验证一个<code class="fe le lf lg lh b">form</code>元素的输入:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="edd7" class="mt lj it lh b gy mu mv l mw mx">&lt;form id="form"&gt;<br/>  &lt;label for="city"&gt;First Name&lt;/label&gt;<br/>  &lt;input type="text" id="first-name" required&gt;<br/>  &lt;p id="first-name-error" hidden&gt;Please fill out first name.&lt;/p&gt;<br/>  &lt;br&gt;</span><span id="78f3" class="mt lj it lh b gy my mv l mw mx">  &lt;label for="city"&gt;Last Name&lt;/label&gt;<br/>  &lt;input type="text" id="last-name" required&gt;<br/>  &lt;p id="last-name-error" hidden&gt;Please fill out last name.&lt;/p&gt;<br/>  &lt;br&gt;</span><span id="c1e1" class="mt lj it lh b gy my mv l mw mx">  &lt;label for="city"&gt;Email&lt;/label&gt;<br/>  &lt;input type="text" id="email" required pattern='[^@]+@[^\.]+\..+'&gt;<br/>  &lt;p id="email-error" hidden&gt;Please fill out email.&lt;/p&gt;<br/>  &lt;br&gt;</span><span id="5b3e" class="mt lj it lh b gy my mv l mw mx">  &lt;button type="submit"&gt;Submit&lt;/button&gt;<br/>&lt;/form&gt;</span></pre><p id="3ea5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在相应的JavaScript代码中，我们可以设置每个<code class="fe le lf lg lh b">input</code>元素的<code class="fe le lf lg lh b">oninvalid</code>属性来处理每个<code class="fe le lf lg lh b">input</code>元素的<code class="fe le lf lg lh b">invalid</code>事件，如下面的代码所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="d47d" class="mt lj it lh b gy mu mv l mw mx">const form = document.querySelector('form');<br/>const inputs = document.querySelectorAll('input');</span><span id="4829" class="mt lj it lh b gy my mv l mw mx">inputs.forEach(input =&gt; {<br/> input.oninvalid = (e) =&gt; {    <br/>    document.getElementById(`${e.target.id}-error`).removeAttribute('hidden');<br/>  }<br/>})</span><span id="bce6" class="mt lj it lh b gy my mv l mw mx">form.onsubmit = (e) =&gt; {<br/>  console.log(e);<br/>  e.preventDefault();<br/>}</span></pre><p id="705d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们必须调用<code class="fe le lf lg lh b">onsubmit</code>事件处理程序上的<code class="fe le lf lg lh b">preventDefault()</code>,因为我们不想在本例中的任何地方提交表单值。为了将<code class="fe le lf lg lh b">invalid</code>事件处理程序附加到所有的<code class="fe le lf lg lh b">input</code>元素，我们使用<code class="fe le lf lg lh b">document.querySelectorAll</code>方法获取所有的<code class="fe le lf lg lh b">input</code>元素，然后我们循环每个DOM元素对象，然后将<code class="fe le lf lg lh b">oninvalid</code>属性设置为我们的事件处理程序函数。在事件处理函数中，每当为<code class="fe le lf lg lh b">input</code>元素触发<code class="fe le lf lg lh b">invalid</code>事件时，我们只需关闭<code class="fe le lf lg lh b">hidden</code>属性。</p><p id="66fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">DOM元素的<code class="fe le lf lg lh b">oninput</code>属性允许我们分配一个事件处理程序来处理<code class="fe le lf lg lh b">input</code>事件，当<code class="fe le lf lg lh b">input</code>、<code class="fe le lf lg lh b">select</code>或<code class="fe le lf lg lh b">textarea</code>元素的值被更改时，该事件被触发。当元素中的任何内容启用了<code class="fe le lf lg lh b">contenteditable</code>属性时，它也会被触发；当<code class="fe le lf lg lh b">designMode</code>打开时，它也会被触发。我们可以用它来处理输入或选择值的情况。在提交输入之前，只要输入发生变化，就会运行事件处理函数。</p><p id="e35e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过设置DOM元素的<code class="fe le lf lg lh b">oninvalid</code>属性来分配一个事件处理程序来处理<code class="fe le lf lg lh b">invalid</code>事件。当submittable元素被检查并且输入验证失败时，触发<code class="fe le lf lg lh b">invalid</code>属性。例如，当一个<code class="fe le lf lg lh b">input</code>元素的输入不符合HTML代码中定义的要求时，它将被触发。通过检查<code class="fe le lf lg lh b">input</code>或<code class="fe le lf lg lh b">textarea</code>元素的<code class="fe le lf lg lh b">required</code>和<code class="fe le lf lg lh b">pattern</code>属性来完成验证。</p></div></div>    
</body>
</html>