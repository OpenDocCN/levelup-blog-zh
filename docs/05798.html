<html>
<head>
<title>Python Web Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Web应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-web-applications-75b0d04db677?source=collection_archive---------10-----------------------#2020-10-02">https://levelup.gitconnected.com/python-web-applications-75b0d04db677?source=collection_archive---------10-----------------------#2020-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4fff7e1326d24ac2c6b58c3aaea93f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idkRhYPDcieisGmdxPFyKw.jpeg"/></div></div></figure><p id="9dcd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Python是一种高级后端编程语言，旨在易于阅读和使用。根据Statista的数据，2020年全球44.1%的程序员使用Python，这使其成为第四大最常用的编程语言。不用说，学习python的基础知识对任何软件工程师来说都是一个有用的补充。</p><p id="9f91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇博客中，我将带您使用Flask库创建您的第一个python web应用程序。该演练基于Mac OS，如果您使用不同的操作系统，可能会略有不同。我们也将使用Visual Studio代码，和一些插件来使事情变得更容易。如果你完全照着做，在本教程结束时，你应该可以在你的机器上运行你自己的web服务器了！</p><h1 id="f780" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">建立</h1><p id="6492" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如前所述，一些插件将使使用python变得更容易。我推荐使用<em class="lz"> Chromodynamics </em>(主要是为了更容易管理配色)<em class="lz"> </em>和<em class="lz"> MagicPython </em>(可能已经安装在你的VS代码上)和<em class="lz"> Python </em>。在我看来，这两个扩展使得在VS中阅读和调试python代码更加容易。在构建这个应用程序的过程中，可能会提示您根据当前的环境设置安装其他插件，您可以根据需要随意安装。</p><p id="b421" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于本教程，我们将使用<em class="lz"> Flask </em>库来帮助响应和处理web请求。python和flask将共同构成这个应用程序的后端。您可以使用python的依赖管理器pip安装flask。在mac终端中运行以下命令来安装pip:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/e7f39b77350f0c04dcec4c0834348d71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*nqu1zmKEj-41iq1xmtGEkA.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">Mac pip安装命令</figcaption></figure><p id="ce27" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们已经安装了pip，我们可以用它来安装flask，命令如下:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/0e0b6b48f574633275185ef6620327c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*D_USSrmUuSmHU_dNE_d2ZA.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">Mac烧瓶注入命令</figcaption></figure><p id="d97b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们创建一个新的文件夹，使用<em class="lz"> mkdir folder_name </em>命令或您的GUI，无论哪种您更喜欢。Cd(更改目录)到该文件夹中，我们将运行以下命令来创建一个python虚拟环境:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/efee6e8f263007ec2fa74dee3d673db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*YzdFcH-wVo2ZQXcZmj5J8g.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">创建一个名为venv的python3 venv</figcaption></figure><p id="1626" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在python中创建我们称之为虚拟环境的东西。这使得我们创建的每个单独的python应用程序都有自己的依赖项，并允许不同的应用程序以不同的方式运行和行为。运行该命令后，您将创建一个名为<em class="lz"> venv的虚拟环境(venv)。</em>屏幕底部也会提示此通知，请务必点击<em class="lz">是</em>！</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/793303f3b14d3e6cec5355b9444daeb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JWqOIiNh03CiHuSdNdl5hg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">点击是！</figcaption></figure><h1 id="2191" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">我们拥有的</h1><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/e6665d6c6c372f19ea11ae67d8f4e8ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*BXNdF9ahttXQWZ5dod9fUA.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">默认情况下，README.md文件不会出现在您的文件夹中，这是我在创建GitHub资源库时添加到我的文件夹中的</figcaption></figure><p id="1566" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们的工作区内，我们将创建两个文件夹。vscode”和“venv”。vscode文件夹包含我们的settings.json文件，出于我们今天的目的，我们不需要编辑这个文件。venv文件夹包括依赖项和许多我们今天也不会看到的其他文件。我们需要关注的是“bin”文件夹。bin文件夹将包含一个名为“激活”的文件。它应该是第一个文件。Activate是允许我们激活虚拟环境的文件。所以在终端中，我们可以运行以下命令:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/685b40c096889ddc3c9c44ec93be82f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YyrVOXgPG9TAV9j7hUliMw.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">请注意蓝色文本venv，它表示我们正在运行名为venv的虚拟环境</figcaption></figure><p id="845d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用这个命令，我们可以访问嵌套在venv文件夹的bin文件夹中的激活文件，并运行脚本来激活虚拟环境。现在我们准备开始编码了！</p><h1 id="2fef" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">开始构建我们的应用程序</h1><p id="a16c" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">和大多数语言一样，我们从导入依赖项开始。让我们创建一个文件，我们可以把它命名为sample.py。py扩展名，以指示它是python文件。然后在文件的顶部，我们将开始从flask依赖项导入Flask和jsonify。这些将允许我们使用Flask对象并jsonify我们的数据。如果您不熟悉json化数据，这是将我们的数据转换成JSON对象的一种奇特方式，这种方式通常更容易阅读和导航。</p><p id="39f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来我们将实例化名为的类flask，它是一个内置变量。我们将以这种方式创建app对象。到目前为止，我们的文件应该如下所示:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/de0de5dfa8072c2e0d20a39109cc189a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GeLgSZf3ofiu0cHSgWC34g.png"/></div></div></figure><h2 id="5666" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">关于名字的一个题外话:</h2><p id="73dd" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">Name是一个内置变量，python用它来告诉你在哪个模块或包中。在这种情况下，我们位于从终端运行的包中，即主包中。将它传递给flask可以让flask知道它在什么上下文中运行。这是用于设置烧瓶应用程序的锅炉板。注意:如果这一切不太有意义，不要担心，你不需要完全理解这个项目中__name__的用法。</p><h1 id="7c0c" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">路线</h1><p id="12c0" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">我们已经导入了依赖项并创建了app对象。现在让我们使用我们的app对象。我们可以将应用程序中的路线附加到将返回数据的函数中。我们可以从一个简单的函数开始，我们称之为主页。这个函数将返回字符串“欢迎来到我的Python页面！”然后，我们附加路由并定义它，在这种情况下，我们可以只使用'/'作为我们的路由，以表明它将是默认或起始路由。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/c036b27dd231a6fe712f41d6068aa478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3L35BBhFPC7998xs7Xj6xA.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">该路径可以是您喜欢的任何名称，但必须以反斜杠(/)开头</figcaption></figure><p id="5aa1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经创建了我们的第一条路线，但我们需要测试它！我们可以遵循以下步骤，用<em class="lz"> flask run </em>命令打开一个服务器。</p><ol class=""><li id="0f6b" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">告诉flask使用哪个文件来运行环境变量</li></ol><p id="6b0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">$export FLASK_APP=sample.py</p><p id="7181" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.告诉flask以什么模式运行项目</p><p id="561c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">$ export FLASK _ ENV =开发</p><p id="dd7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.运行烧瓶应用程序</p><p id="4ba5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">$烧瓶运行</p><p id="3367" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在终端中这样做，一旦我们设置了这些环境变量，它们将跟随虚拟环境并持续存在，即使我们离开文件夹并回来。我们已经告诉flask运行sample.py，这是我们的文件名，我们希望在开发模式下运行，这意味着当我们更改代码时，它会自动重新启动。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/1e745c8d0f529ec207059b3216bdc022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqNoo2XmYMeYhMrX32UiEA.png"/></div></div></figure><h2 id="1b87" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">放在烧瓶和pip上</h2><p id="b782" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">到目前为止，在设置flask环境后运行<em class="lz"> flask run </em>命令时，遵循这些步骤最初导致了一个错误。如果您遇到诸如<em class="lz"> flask command not found之类的错误，</em>我建议用下面的命令更新您的flask。这立即解决了我的问题，并允许我运行我的烧瓶。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/db60a40981a606a185a082acdc4e3eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*ss3O69iFr-zZAkwbyBXOqQ.png"/></div></figure><p id="ba74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们在终端中点击http链接，我们将会看到一个如下所示的页面:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/81d250e802c2a27cada63d2ae5004ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*8DlPo_ucQd_l_xB54lbCxA.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">127.0.0.1:5000是运行我们应用的本地服务器</figcaption></figure><p id="430c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这不完全是web开发的巅峰，但这是创建python应用程序的开始。</p><h1 id="2b15" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建对象和字典来传递数据</h1><p id="56a6" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">Python有一种叫做字典的东西，它非常类似于ruby中的hash，但是它不能写任意的键。所有的键都必须用引号括起来。Python也有一个列表，它的行为与其他语言中的数组非常相似。</p><p id="eac5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们创建一个对象列表，作为数据传递给我们的python应用程序。记住python不需要用关键字来声明变量，所以我们只需写变量的名字，后跟它的值。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/a9ce03ea5317355b3d38bfbdd5641cf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgiSI_Gdp-tLOCiQJpvGNQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">航空公司物品清单</figcaption></figure><p id="b24a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为列表不是字符串，所以我们不能直接将它返回给浏览器。但是，我们可以将列表字符串化，并作为json数据返回！我们使用从flask导入的jsonify方法，并将我们在第9到19行定义的airlines对象传递给它。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/daab6317199ef73cf88bd0412ca03392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BeyUyJcFxK0lqVuPWs1JAQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">到'/航空公司'的路线</figcaption></figure><p id="be10" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，如果我们在浏览器中输入<a class="ae no" href="http://127.0.0.1:5000/airlines" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:5000/airlines</a>，我们将会收到一个代表我们所有航空公司的JSON对象。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/feb57a578307fc4c354a7938ee4a0ac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*PeBL-S-y-YAsIvaFTPaegw.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">sample.py文件中的航空公司列表</figcaption></figure><p id="57d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我的chrome浏览器中，我使用了一个名为Awesome JSON Viewer的扩展，这就是为什么我的JSON数据是以这种格式和配色方案构建的。我发现像这样读取JSON数据更容易，但是你不需要为你的python应用程序做任何扩展就能把数据发送到你的浏览器。如果你决定要这个扩展，它对chrome是免费的。</p><p id="4a97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们想访问特定的航空公司呢？我们可以创建一个动态路由，它将接受一个参数，在本例中是一个id，并返回带有该id的航线。为此，我们必须首先改变航空公司列表的结构，为每个航空公司添加一个带有数字值的id键。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/f65b9f7e8bbdf5752ef6cdfb01aa97d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nap4LXQ-6QhODPCTIA8uAg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">ID号没有包装在字符串中，因为它是一个整数</figcaption></figure><p id="4f7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我们创建新路线:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/cbffa95c86fc3d13ece86635ee1d1028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fmFg1jZoWP-_8VRO0TQ39A.png"/></div></div></figure><p id="e657" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我解释一下这里发生了什么。我们将一条路线附加到我们的应用程序对象上，并将其命名为“/airlines/ <id>”。id周围的&lt;&gt;告诉我们，<id>将是一个变量，不会是每次到达同一地点的静态路线。然后，我们定义了一个名为airline (singular)的函数，它将id作为参数。该id将与路线中的id相同，这是将在Web浏览器搜索栏中输入的内容。</id></id></p><p id="c47a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在函数内部，我们有一个简单的for循环，它遍历airlines对象中的每一家航空公司，如果该航空公司的id等于我们在URL中输入的id(解析为整数),那么我们返回该航空公司的jsonified版本。</p><p id="5da7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以通过在搜索栏中输入“airlines/1”来测试这一点，以查找id为1的航空公司，正如所料，它返回id为1的航空公司列表中的对象！</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b685d0dbe94ec1e1bd60aa526a237b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*eb-UKJ_d7FWSGUa4APOpOg.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">请注意，初始的“127.0.0.1:5000”对于任何路由都是相同的，随后会发生变化</figcaption></figure><h1 id="72bb" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">包装它</h1><p id="c706" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果您完全按照这些步骤操作，您将创建一个python web应用程序和一个作为API的python后端。在以后的博客中，我计划讨论除了获取这个API之外，如何发出其他请求，比如POST和DELETE。用你现有的知识创造。尝试弄清楚如何向浏览器返回不仅仅是一个字符串，或者为JSON数据创建更复杂的数据结构。享受你的编码，永远不要停止学习！</p></div></div>    
</body>
</html>