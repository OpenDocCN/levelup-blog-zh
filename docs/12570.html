<html>
<head>
<title>Automatic CHANGELOG with commit and version standardization in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中带提交和版本标准化的自动变更日志</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/version-control-and-automatic-changelog-python-4d193ec90427?source=collection_archive---------4-----------------------#2022-06-20">https://levelup.gitconnected.com/version-control-and-automatic-changelog-python-4d193ec90427?source=collection_archive---------4-----------------------#2022-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e6a6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何为您的Python项目自动创建CHANGELOG并设置提交和版本标准化指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/66c1688013bf221f4f977c204db8ef1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6wE0Y6I8LgbK4Y6B"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">凯拉·霍泽尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="8b96" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">摘要</h2><ul class=""><li id="74ee" class="ls lt iq lu b lv lw lx ly lf lz lj ma ln mb mc md me mf mg bi translated">语义版本化；</li><li id="8ab5" class="ls lt iq lu b lv mh lx mi lf mj lj mk ln ml mc md me mf mg bi translated">常规提交；</li><li id="fff8" class="ls lt iq lu b lv mh lx mi lf mj lj mk ln ml mc md me mf mg bi translated">自动变更日志生成器；</li><li id="18de" class="ls lt iq lu b lv mh lx mi lf mj lj mk ln ml mc md me mf mg bi translated">结论。</li></ul></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><h1 id="fbe2" class="mt kx iq bd ky mu mv mw lb mx my mz le jw na jx li jz nb ka lm kc nc kd lq nd bi translated">语义版本控制</h1><p id="fb0b" class="pw-post-body-paragraph ne nf iq lu b lv lw jr ng lx ly ju nh lf ni nj nk lj nl nm nn ln no np nq mc ij bi translated">语义版本化是在软件管理领域内创建的一种规则结构，这种结构旨在控制标签并避免一种称为“依赖地狱”的问题，这种问题会阻止发布给定应用程序的新版本或对依赖问题的研究，这种问题会随着项目的复杂性而增长。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/3e449c394c5fcaf00554cf4b2db5567f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aqMUUGvVkPMrUehKKzzdmQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">随着复杂性的增长而增长的依赖性。</figcaption></figure><p id="5c89" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">简而言之，用于映射标签的建议结构由X.Y.Z (Major。Minor.Patch)，如下图所示，其中不再与先前版本兼容的更改导致了对MAJOR的更改。添加或更改当前版本，但仍然兼容的次要更改，增加次要版本。最后，仅与错误修复相关的版本会增加补丁的价值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/3311f22bcce7cf948863d1c259b5d964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*mbXo-if9ySOJlJRjLwuzbw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">语义版本化结构。</figcaption></figure><p id="e17d" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">这种结构是由<a class="ae kv" href="https://tom.preston-werner.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lu ir">Tom Preston-Werner</strong></a><a class="ae kv" href="https://github.com/" rel="noopener ugc nofollow" target="_blank">GitHub</a>的联合创始人和<a class="ae kv" href="https://pt.gravatar.com/" rel="noopener ugc nofollow" target="_blank"> Gravatar </a>的创建者提出的，通过遵循<a class="ae kv" href="https://semver.org/#semantic-versioning-specification-semver" rel="noopener ugc nofollow" target="_blank">语义版本化</a>的规则，开发者获得了好处，例如<strong class="lu ir">映射代码</strong>、<strong class="lu ir">按时间顺序控制变更</strong>、<strong class="lu ir">版本间导航的可能性</strong>和<strong class="lu ir">依赖管理。</strong></p><div class="ny nz gp gr oa ob"><a href="https://semver.org/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">语义版本2.0.0</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">给定主要版本号。补丁，增加:主要版本当你做不兼容的API改变，次要…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">semver.org</p></div></div></div></a></div><h1 id="e5ea" class="mt kx iq bd ky mu ok mw lb mx ol mz le jw om jx li jz on ka lm kc oo kd lq nd bi translated">常规提交</h1><p id="0a8e" class="pw-post-body-paragraph ne nf iq lu b lv lw jr ng lx ly ju nh lf ni nj nk lj nl nm nn ln no np nq mc ij bi translated">当想到科学家或开发人员已经应用了与版本化他们的代码或研究笔记本相关的最佳实践时，留出空间来交流提交对于Git用户的重要性是值得的，因为提交由携带在存储库中应用的变更的消息组成，以便有助于理解变更。然而，趋势是随着项目的增长，提交变得不标准，消息失去了真正的意义，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/8043deb9cf37624b810e89ae58f9ac56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PiEvYrKaXWV583_W1XeGbg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">没有提交模式的存储库历史示例。</figcaption></figure><p id="98b4" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">在这一点上，我们提出了<a class="ae kv" href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener ugc nofollow" target="_blank">常规提交</a>作为“为提交消息添加人类和机器可读含义的规范”的建议。这个约定通过为提交建立一个结构来工作，这可以在下面演示。</p><pre class="kg kh ki kj gt oq or os ot aw ou bi"><span id="de00" class="kw kx iq or b gy ov ow l ox oy">&lt;type&gt;[optional scope]: &lt;description&gt;</span><span id="f0c6" class="kw kx iq or b gy oz ow l ox oy">[optional body]</span><span id="94c6" class="kw kx iq or b gy oz ow l ox oy">[optional footer(s)]</span></pre><p id="7185" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">基本上，约定内的提交开始使用一个类型(可以是<code class="fe pa pb pc or b">fix</code>、<code class="fe pa pb pc or b">feat</code>、<code class="fe pa pb pc or b">build</code>、<code class="fe pa pb pc or b">chore</code>、<code class="fe pa pb pc or b">ci</code>、<code class="fe pa pb pc or b">docs</code>、<code class="fe pa pb pc or b">style</code>、<code class="fe pa pb pc or b">refactor</code>、<code class="fe pa pb pc or b">perf</code>或<code class="fe pa pb pc or b">test</code>)，后跟主消息。其他参数是可选的。</p><p id="4503" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">因此，举例来说，公约结构内的一些承诺将是:</p><pre class="kg kh ki kj gt oq or os ot aw ou bi"><span id="129b" class="kw kx iq or b gy ov ow l ox oy">1) docs: correct spelling of CHANGELOG</span><span id="39b5" class="kw kx iq or b gy oz ow l ox oy">2) feat(lang): add Polish language</span><span id="f6f1" class="kw kx iq or b gy oz ow l ox oy">3) fix: prevent racing of requests</span><span id="6627" class="kw kx iq or b gy oz ow l ox oy">   Introduce a request id and a reference to latest request. Dismiss<br/>   incoming responses other than from latest request.</span><span id="e6c2" class="kw kx iq or b gy oz ow l ox oy">   Remove timeouts which were used to mitigate the racing issue but are obsolete now.</span><span id="6b22" class="kw kx iq or b gy oz ow l ox oy">   Reviewed-by: Z<br/>   Refs: #123</span></pre><p id="1791" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">采用这种结构后，传统的提交格言变成了现实，为机器和项目的受益者带来了语义。</p><div class="ny nz gp gr oa ob"><a href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">常规提交</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">为提交消息添加人类和机器可读含义的规范</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">www.conventionalcommits.org</p></div></div></div></a></div><h2 id="6fbd" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">承诺</h2><p id="0ab1" class="pw-post-body-paragraph ne nf iq lu b lv lw jr ng lx ly ju nh lf ni nj nk lj nl nm nn ln no np nq mc ij bi translated">有助于采用传统提交的工具是<a class="ae kv" href="https://commitizen-tools.github.io/commitizen/" rel="noopener ugc nofollow" target="_blank"> Commitizen </a>。在这个工具的功能中，提到了它用用户界面格式化提交，所以它不需要记住提交的默认结构。</p><p id="ed67" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">在安装Python 3.6+和Git 1.8.5.2+作为先决条件后，可以通过在终端中使用以下命令轻松安装该工具:</p><pre class="kg kh ki kj gt oq or os ot aw ou bi"><span id="7b94" class="kw kx iq or b gy ov ow l ox oy">sudo pip3 install -U Commitizen (Linux)</span><span id="521a" class="kw kx iq or b gy oz ow l ox oy">brew install commitizen(macOS)</span></pre><p id="dc38" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">它的常见用途是格式化提交，可以通过以下方式执行:</p><pre class="kg kh ki kj gt oq or os ot aw ou bi"><span id="a959" class="kw kx iq or b gy ov ow l ox oy">cz commit</span></pre><p id="fe97" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">上面的命令将在终端中演示一些帮助格式化提交的选项，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/13219ba695b4f296b9f9229ca90558f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GodLEU-FOZnCGiImKClYWQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">使用commitizen的示例。</figcaption></figure><div class="ny nz gp gr oa ob"><a href="https://commitizen-tools.github.io/commitizen/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">承诺</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">文档:https://commitizen-tools.github.io/commitizen/ commit izen是一个为团队设计的工具。它的主要目的…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">提交-tools.github.io</p></div></div></div></a></div><h1 id="cfb6" class="mt kx iq bd ky mu ok mw lb mx ol mz le jw om jx li jz on ka lm kc oo kd lq nd bi translated">自动变更日志生成器</h1><p id="d04b" class="pw-post-body-paragraph ne nf iq lu b lv lw jr ng lx ly ju nh lf ni nj nk lj nl nm nn ln no np nq mc ij bi translated">在标准化了提交以及存储库中的版本控制之后，就可以自动创建和更新CHANGELOG，它对应于一个包含所有变更记录的列表。这个变更列表的好处是，有了它，就有了一个特定的地方来查找项目中所做的变更，就有可能将它们呈现给项目领导以及所有相关方。</p><p id="f080" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">为了实现这种自动化，有必要使用commitzen工具，尽管也有其他工具可以实现相同的目标，例如<a class="ae kv" href="https://pypi.org/project/auto-changelog/" rel="noopener ugc nofollow" target="_blank">自动变更日志</a>库。</p><p id="7b97" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">第一步是启动存储库中的commitzen配置文件，这可以通过在终端中运行以下命令来完成:</p><pre class="kg kh ki kj gt oq or os ot aw ou bi"><span id="a41d" class="kw kx iq or b gy ov ow l ox oy">cz init</span></pre><p id="e21f" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">执行此命令后，将显示终端中要选择的选项列表，以便建立版本配置。随意使用下图作为配置示例，放置所有参数后，一个<code class="fe pa pb pc or b">pyproject.toml</code>文件将被插入到项目中，以便建立版本控制。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/3d7d5ca08f56ef6eb8b4e61ca452a727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JLHLibJytXqQ5GeUGfwww.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">正在配置提交设置。</figcaption></figure><p id="ad2e" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">在终端中运行的下一个命令将是:</p><pre class="kg kh ki kj gt oq or os ot aw ou bi"><span id="2093" class="kw kx iq or b gy ov ow l ox oy">cz bump --files-only</span></pre><p id="5e71" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">此命令将更新项目的版本，并假设版本控制文件已随本教程的演练一起创建，将建立项目的第一个版本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/7c33652358f32f03900b953efa3c655f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*Re1n0fRM--l-g-YhcB1BuA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">创建第一个项目版本。</figcaption></figure><p id="431c" class="pw-post-body-paragraph ne nf iq lu b lv ns jr ng lx nt ju nh lf nu nj nk lj nv nm nn ln nw np nq mc ij bi translated">最后，下一个命令将创建一个CHANGELOG.md文件，这样它将包含所有标准化的提交，并由提交类型分隔。</p><pre class="kg kh ki kj gt oq or os ot aw ou bi"><span id="9225" class="kw kx iq or b gy ov ow l ox oy">cz changelog</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/a378da88b1cbd4faa8bc1d9b74a200a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uFHFLUGIhexbjJQmC8soAg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">自动生成的变更日志示例。</figcaption></figure><h1 id="d2b8" class="mt kx iq bd ky mu ok mw lb mx ol mz le jw om jx li jz on ka lm kc oo kd lq nd bi translated">结论</h1><p id="6e3b" class="pw-post-body-paragraph ne nf iq lu b lv lw jr ng lx ly ju nh lf ni nj nk lj nl nm nn ln no np nq mc ij bi translated">通过为我们工作的项目建立代码标准、语义版本化和常规提交，我们提高了所呈现的专业水平，因此我们能够发展为自动化，向所有对项目感兴趣的人交付价值，这在今天的文章中得到证明，当时我们用几个命令行生成了一个changelog。这对于开发人员和数据科学家来说都是可以实现的，因为当应用这些实践时，可以更好地组织项目。</p></div></div>    
</body>
</html>