<html>
<head>
<title>Replace Excel with Python for Financial Statement Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python替代Excel进行财务报表分析</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/replace-excel-with-python-for-financial-statement-analysis-855f6cc7305a?source=collection_archive---------3-----------------------#2022-07-28">https://levelup.gitconnected.com/replace-excel-with-python-for-financial-statement-analysis-855f6cc7305a?source=collection_archive---------3-----------------------#2022-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="db61" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">fibooks的初学者友好概述</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6b88f1d643e32906810e844151ad1b08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rZwVujO2-PTRn4IPGg2uw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者创造的形象</figcaption></figure><p id="a7d7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当Excel在1985年推出时，它很快成为世界上使用最多的软件程序之一。事实上，其多样化的现实世界应用(从华尔街财务报表到高中时间表)使其成为全球公司的数字基石。</p><p id="8b01" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，对于今天的大多数数据科学家来说，Excel可能只不过是众多工具中的一个。事实上，即使是商界也在慢慢淘汰Excel，部分原因是它的数据分析选项比Python少。</p><p id="9dfc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，<a class="ae lr" href="https://www.cfo.com/technology/spreadsheets/2022/04/excel-survive-finance-departments/" rel="noopener ugc nofollow" target="_blank">在金融领域，这种向Python的转变还没有发生</a>。因此，很大一部分财务报表分析(这对投资者很有用)是手工完成的。</p><p id="a634" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么他们为什么不使用Python呢？两个原因。首先，因为Python不支持财务报表(即资产负债表、损益表和现金流量表)作为数据对象。其次，因为Python无法读取存储这些财务报表的大部分混乱的电子表格。</p><p id="f7b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">令人欣慰的是，这些问题通过一个名为<em class="ls"> fibooks的新库得到了解决。</em>本文将通过一些基本的例子对这个库做一个简短的概述。</p><h2 id="8272" class="lt lu iq bd lv lw lx dn ly lz ma dp mb le mc md me li mf mg mh lm mi mj mk ml bi translated">加载电子表格</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/e5278f310c4436b29b712b14f01329c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BEzpqIrTRQMNlvo7AUYyjQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">本文的Excel电子表格</figcaption></figure><p id="e1c9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在fibooks中加载Excel电子表格(见上文)首先需要创建一个对象来存放财务报表。在这种情况下，我们希望加载现金流量表。因此，我们导入了<code class="fe mn mo mp mq b">statement_of_cashflows</code>类。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="0367" class="lt lu iq mq b gy mv mw l mx my"><strong class="mq ir">from</strong> fibooks <strong class="mq ir">import</strong> statement_of_cashflows</span></pre><p id="b66d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们可以导入Excel电子表格。这是通过<code class="fe mn mo mp mq b">load_excel </code>功能完成的。这个函数有几个可选参数，可以帮助加载极其混乱的电子表格(将来会写一篇关于这个问题的文章)，但是对于这个电子表格，我们可以保留所有的默认值。(注意，fibooks也可以加载csv文件和pandas数据帧。)</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="697f" class="lt lu iq mq b gy mv mw l mx my">company_d = statement_of_cashflows('company d')<br/>company_d.load_excel('statement_of_cashflows.xlsx')</span></pre><p id="5cf8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从Excel加载数据后，我们可以使用<code class="fe mn mo mp mq b">statement_of_cashflows</code>类中的函数来处理它。该函数返回来自运营的<em class="ls">现金流的总值。(注意fibooks中的值与前面显示的电子表格中的值是如何对应的。)</em></p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="b91a" class="lt lu iq mq b gy mv mw l mx my">&gt;&gt;&gt; company_d.get_total('operations')</span><span id="7bdf" class="lt lu iq mq b gy mz mw l mx my"><em class="ls">[61450]</em></span></pre><p id="a107" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">既然电子表格中的数据已经加载，我们几乎可以用它做任何事情。比如我们可以用来估值，这是财务报表分析的很大一部分。在引入fibooks之前，这必须在Excel中手动完成。</p><h2 id="61f9" class="lt lu iq bd lv lw lx dn ly lz ma dp mb le mc md me li mf mg mh lm mi mj mk ml bi translated">估价</h2><p id="55e8" class="pw-post-body-paragraph kv kw iq kx b ky na jr la lb nb ju ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">财务报表分析的很大一部分围绕着对公司的估值。Fibooks通过将估价方法作为标准函数来支持这一点。</p><p id="3150" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面的例子通过<em class="ls">基于收入的估值</em>证明了这一点，该估值(对于金融狂热分子而言)采用所有未来自由现金流的贴现总和。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="80be" class="lt lu iq mq b gy mv mw l mx my">&gt;&gt;&gt; <strong class="mq ir">from</strong> fibooks <strong class="mq ir">import</strong> income_based_valuation<br/>&gt;&gt;&gt; income_based_valuation(company_d, r=0.05)</span><span id="411a" class="lt lu iq mq b gy mz mw l mx my"><em class="ls">58523.80952380952 &lt;- company value according to this method</em></span></pre><p id="10e9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意，在这个例子中，贴现率(r)等于5%，但是它不是很相关，因为只有一年的数据。通常这种类型的评估是通过多年的数据来完成的，fibooks也支持这一点。事实上，fibooks支持组合多个电子表格/数据集，即使它们有不同的帐户名。</p><h2 id="9b40" class="lt lu iq bd lv lw lx dn ly lz ma dp mb le mc md me li mf mg mh lm mi mj mk ml bi translated">熊猫集成</h2><p id="e11c" class="pw-post-body-paragraph kv kw iq kx b ky na jr la lb nb ju ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">Pandas是使用最多的Python库之一。尤其是在数据分析领域，熊猫是必不可少的。因此，fibooks支持与熊猫的全面集成。要利用这一点，只需使用<code class="fe mn mo mp mq b">.content</code>属性。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="e42a" class="lt lu iq mq b gy mv mw l mx my">&gt;&gt;&gt; company_d.content</span><span id="df21" class="lt lu iq mq b gy mz mw l mx my"><em class="ls">This outputs a pandas dataframe with the values from the spreadsheet</em></span></pre><p id="d039" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在可以使用pandas语法选择财务报表的一个帐户(或列)。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="ffdd" class="lt lu iq mq b gy mv mw l mx my">&gt;&gt;&gt; company_d.content['customers']</span><span id="2630" class="lt lu iq mq b gy mz mw l mx my">0    123 <br/>Name: customers, dtype: int64</span></pre><h2 id="3143" class="lt lu iq bd lv lw lx dn ly lz ma dp mb le mc md me li mf mg mh lm mi mj mk ml bi translated">最后</h2><p id="0293" class="pw-post-body-paragraph kv kw iq kx b ky na jr la lb nb ju ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">这篇文章非常简短地介绍了财务分析和fibooks。不用说，还有比这更多的可能性。有兴趣的请访问fibooks的<a class="ae lr" href="https://timokats.github.io/fibooksdocs/" rel="noopener ugc nofollow" target="_blank">文档</a>或完成<a class="ae lr" href="https://github.com/TimoKats/fibooks/blob/977e71dcdbe87e68162cc415f59ee720af4bc0fe/demo/demo.ipynb" rel="noopener ugc nofollow" target="_blank">演示</a> (python笔记本)。</p><p id="0a42" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，这个库是开源的，并且总是对新的贡献者开放。因此，如果您有任何想法<em class="ls">或</em>如果您想接一个副业项目，请随时联系GitHub上的开发团队。</p><div class="nf ng gp gr nh ni"><a href="https://github.com/TimoKats/fibooks" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">GitHub - TimoKats/fibooks:用于财务报表分析的Python库。</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">Fibooks是一个用于财务报表分析的python库。该库支持所有3种主要财务报表…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">github.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw kp ni"/></div></div></a></div></div></div>    
</body>
</html>