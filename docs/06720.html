<html>
<head>
<title>How to Deploy a Netlify Website with Azure DevOps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Azure DevOps部署Netlify网站</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-deploy-a-netlify-website-with-azure-devops-38839a787daf?source=collection_archive---------11-----------------------#2020-12-22">https://levelup.gitconnected.com/how-to-deploy-a-netlify-website-with-azure-devops-38839a787daf?source=collection_archive---------11-----------------------#2020-12-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d64a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用Azure Pipelines实现web开发和部署的自动化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5db45748faadf9bdba768062acb2f6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aitq0btnDjQri7_GAXWstg.png"/></div></div></figure><h1 id="ede3" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">介绍</h1><p id="8072" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在我之前的一个<a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/a-website-with-a-custom-domain-for-less-then-1-for-a-year-fb1fff6f7759">故事</a>中，我解释了如何使用Netlify免费托管网站——只需1美元就可以创建一个域名。然而，通常你也想用新的特性更新你的站点，或者在博客的情况下，添加新的故事。不幸的是，部署这个网站需要时间。那么，为什么不自动化您的网站部署过程呢？</p><p id="49f6" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">当你在GitHub或BitBucket上托管你的源代码时，为你的网站创建一个Netlify发布管道是非常简单的。您从Git 点击<strong class="lo iu"> New site，选择您的存储库，定义构建过程，您就完成了。</strong></p><p id="ffe6" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">但是如果您为您的项目选择了一个不同的版本控制提供者呢？然后你需要做更多的研究。在这个故事中，我将向您解释如何使用Azure DevOps部署Netlify网站。</p><div class="mo mp gp gr mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/a-website-with-a-custom-domain-for-less-then-1-for-a-year-fb1fff6f7759"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">一个自定义域名的网站，一年的费用不到1美元</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">你刚刚编写了有史以来最好的网站，但是你如何发布你的网站和它的自定义域名，同时考虑…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ks mr"/></div></div></a></div><h1 id="4c04" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">假设</h1><p id="9126" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在继续之前，让我们假设一些事情:</p><ul class=""><li id="6c0b" class="ng nh it lo b lp mj ls mk lv ni lz nj md nk mh nl nm nn no bi translated">我们知道如何使用Azure DevOps。</li><li id="d602" class="ng nh it lo b lp np ls nq lv nr lz ns md nt mh nl nm nn no bi translated">我们已经在Azure DevOps中建立了一个构建管道，它在每次代码签入时运行，并创建一个部署包作为管道的输出。</li><li id="15e7" class="ng nh it lo b lp np ls nq lv nr lz ns md nt mh nl nm nn no bi translated">我们已经创建了一个发布管道，它有一个空的阶段，当主分支上发生新的提交时就会触发这个阶段。这个发布管道需要提取在构建管道中作为部署包发布的产品。</li></ul><h1 id="1f6e" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">台阶</h1><p id="f832" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">本指南分为三个不同的部分:</p><ul class=""><li id="0b52" class="ng nh it lo b lp mj ls mk lv ni lz nj md nk mh nl nm nn no bi translated">第1部分:在发布管道中使用Netlify</li><li id="42ee" class="ng nh it lo b lp np ls nq lv nr lz ns md nt mh nl nm nn no bi translated">第2部分:从Netlify获取访问令牌和站点ID</li><li id="5463" class="ng nh it lo b lp np ls nq lv nr lz ns md nt mh nl nm nn no bi translated">第3部分:将所有东西放在一起</li></ul><p id="2443" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">我们走吧！</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="46cd" class="ku kv it bd kw kx ob kz la lb oc ld le jz od ka lg kc oe kd li kf of kg lk ll bi translated">第1部分:在发布管道中使用Netlify</h1><p id="afe6" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在新的空工单中，我们需要添加我们的净任务。这可以通过点击“代理作业”旁边的<code class="fe og oh oi oj b">+</code>图标，然后在搜索栏中输入“Netlify”来完成。您将从Marketplace 弹出窗口中看到<a class="ae mi" href="https://marketplace.visualstudio.com/items?itemName=aliencube.netlify-cli-extensions" rel="noopener ugc nofollow" target="_blank">该任务，您的组织需要安装该任务。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/b63e223848be8dd1e0ea92fd89b22bbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0TfyTzLCK_Tj4gnUey4T8g.png"/></div></div></figure><p id="e6e7" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">这个扩展只不过是一个封装了<a class="ae mi" href="https://docs.netlify.com/cli/get-started/" rel="noopener ugc nofollow" target="_blank"> Netlify CLI </a>的包装器。在引擎盖下，这将运行命令行中的一切。因此，如果您喜欢自己运行脚本，请继续😊。然而，如果你喜欢用户界面，那么这个扩展就是为你准备的。</p><p id="7d02" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">安装完扩展后，我们需要依次添加两个任务；<strong class="lo iu">安装Netlify CLI </strong>和<strong class="lo iu">部署网站</strong>。第一项任务将确保Netlify CLI安装在部署计算机上。该任务将在后台运行以下命令<code class="fe og oh oi oj b">npm install netlify-cli -g</code>。确保安装了Netlify CLI后，我们就可以发布我们的网站了。Netlify <strong class="lo iu">部署网站</strong>任务将请求两个参数来部署您的网站，一个站点ID和一个认证令牌。对于这些值，当我们从Netlify收到它们时，我们将在“变量”选项卡中使用发布变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/bcdee2e3256836355c5b01294691bb26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NSzShOrZ0S7G530WFivvaw.png"/></div></div><figcaption class="om on gj gh gi oo op bd b be z dk translated">要部署到Netlify的发布管道</figcaption></figure><p id="0c71" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">在下一部分中，我们将从Netlify获得令牌，也称为个人访问令牌(PAT)。现在，您可以将该值留空。站点ID也是如此。为<code class="fe og oh oi oj b">siteID</code>创建一个release变量，现在将其留空，因为我们将在下一部分中获得这个变量。</p><p id="16e7" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">我们还需要填写另一个字段，即“源目录”字段。这将是包含您已经从构建管道发布的网站的目录。对我来说是<code class="fe og oh oi oj b">$(System.DefaultWorkingDirectory)/_koenvanzeijl/drop</code>。您可以选择添加部署消息，以便在Netlify仪表板中更好地了解您的版本。</p><p id="7bb4" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated"><strong class="lo iu">部署网站</strong>任务将在后台运行以下命令:</p><p id="1bbb" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated"><code class="fe og oh oi oj b">netlify deploy "--auth={YOUR_TOKEN}" "--site={YOUR_SITE_ID}" "--dir={YOUR_DEFAULT_WORKING_DIRECTORY}\_koenvanzeijl\drop" --prod</code></p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="838c" class="ku kv it bd kw kx ob kz la lb oc ld le jz od ka lg kc oe kd li kf of kg lk ll bi translated">第2部分:从Netlify获取访问令牌和站点ID</h1><p id="bf9a" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在这一节中，我们将重点关注从Netlify仪表板获取令牌和站点ID的部分。</p><h2 id="dfac" class="oq kv it bd kw or os dn la ot ou dp le lv ov ow lg lz ox oy li md oz pa lk pb bi translated">创建网络生活网站</h2><p id="c8f9" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">如果你还没有Netlify帐户，不要担心。您可以点击此处的创建一个。登录后，您将看到一个包含您的网站的仪表板，但现在可能是空的。如果你点击“从Git新建站点”按钮，你可以链接你的GitHub/GitLab/BitBucket库。</p><p id="850b" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">因为我们想从DevOps上传我们的网站，我们需要找到一种不同的方式。为此，我们需要在自己的机器上安装Netlify CLI。您可以通过运行下面的命令来做到这一点:<code class="fe og oh oi oj b">npm install netlify-cli -g</code>。安装完CLI后，我们需要通过运行下一个命令<code class="fe og oh oi oj b">netlify login</code>来验证自己。这将打开一个浏览器窗口，要求您使用Netlify登录并授予对<strong class="lo iu"> Netlify CLI </strong>的访问权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/0c2955f923daf8956d34d1e97ea0569d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wiQ80nFUuqoM43Pn.png"/></div></div></figure><h2 id="763d" class="oq kv it bd kw or os dn la ot ou dp le lv ov ow lg lz ox oy li md oz pa lk pb bi translated">站点ID</h2><p id="3bff" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我们现在准备在Netlify中创建我们的网站，并获得我们的站点ID。要创建一个站点，运行以下命令:<code class="fe og oh oi oj b">netlify sites:create --name &lt;YOUR SITE NAME&gt;</code>。在我的例子中，我创建了站点koenvanzeijl-demo。运行该命令后，它会询问您要将站点添加到哪个团队。由于您可能只有一个团队，因此您可以选择第一个团队。输入回车，你的站点就创建好了！把这个<code class="fe og oh oi oj b">Site ID</code>留着以后用。如果出于某种原因，你错过了这个ID，不要担心，你可以随时从他们的仪表板上得到它。在仪表板中，它被称为<strong class="lo iu"> API ID。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/cc6c77d19a63a6fd10b8738c5ed73d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*ZRK49Z1m1SDVsBnI_z9dOA.png"/></div></figure><h2 id="749a" class="oq kv it bd kw or os dn la ot ou dp le lv ov ow lg lz ox oy li md oz pa lk pb bi translated">代币</h2><p id="955f" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">现在，我们需要做的就是得到我们的令牌。我们可以在Netlify仪表板上轻松实现这一点。首先，点击你的头像，进入<strong class="lo iu">用户设置</strong>，然后点击<strong class="lo iu">应用</strong>，向下滚动到<strong class="lo iu">个人访问令牌</strong>。您可以在这里创建新的令牌。我建议给它起一个描述性的名字，这样你就可以知道它的用途，我把我的命名为“DevOps release token”。把这个令牌留给下一部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/5d51d0e0abca38ca05e6bde6fddf7c56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uBwCQMWMD95Ml-lmMgCbgA.png"/></div></div></figure></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="eeca" class="ku kv it bd kw kx ob kz la lb oc ld le jz od ka lg kc oe kd li kf of kg lk ll bi translated">第3部分:将所有东西放在一起</h1><p id="c58e" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在我们的最后一步，我们将结合一切来创建一个顺利工作的部署机器！我们将在发布管道的空变量中插入令牌和siteID——您刚刚从Netlify获得的。</p><h2 id="ab6b" class="oq kv it bd kw or os dn la ot ou dp le lv ov ow lg lz ox oy li md oz pa lk pb bi translated">注意！</h2><p id="f94d" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">将这个变量隐藏起来很重要，所以我建议通过单击锁图标来隐藏这个变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/fda6f051307c017c6a92f5526552a9ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cEFjSj73YeK0k4kdh-gFQw.png"/></div></div><figcaption class="om on gj gh gi oo op bd b be z dk translated">调整DevOps版本变量</figcaption></figure><h2 id="e873" class="oq kv it bd kw or os dn la ot ou dp le lv ov ow lg lz ox oy li md oz pa lk pb bi translated">部署时间到了</h2><p id="bc35" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">现在是时候尝试您新创建的管道并部署您令人惊叹的网站了！创建一个发布，看看会发生什么。这是我的网站部署后的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/39e05826ae4aa71ec74d4ddd85ec5918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fhz8ixK5Q_pOJW9ovQntjA.png"/></div></div><figcaption class="om on gj gh gi oo op bd b be z dk translated">www.koenvanzeijl.nl</figcaption></figure><p id="5aa2" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">仅此而已！我们刚刚创建了一个Azure DevOps发布管道来将我们自己的网站部署到Netlify。</p><h1 id="90af" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">结论</h1><p id="d9c4" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">Netlify提供了一些非常简洁的开箱即用的选项来自动发布你的网站。不幸的是，Azure DevOps没有。这意味着我们需要创造自己的自动化机器。结果证明这是可以实现的。我们在Netlify中创建了一个网站，并使用个人访问令牌来推送我们的网站内容。</p><p id="a9a0" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">如果你在这个过程中遇到任何问题，请在评论区留下你的评论，我会尽力帮助你。</p><p id="76b0" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">编码快乐！</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/095d3d82a769bfc84cc3b54b1e73c6d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hVfgU40RCMeP9Wq-HfSUlg@2x.png"/></div></div><figcaption class="om on gj gh gi oo op bd b be z dk translated"><a class="ae mi" href="https://ko-fi.com/koenvanzeijl" rel="noopener ugc nofollow" target="_blank">https://ko-fi.com/koenvanzeijl</a></figcaption></figure></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><div class="kj kk kl km gt mr"><a rel="noopener  ugc nofollow" target="_blank" href="/a-website-with-a-custom-domain-for-less-then-1-for-a-year-fb1fff6f7759"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">一个自定义域名的网站，一年的费用不到1美元</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">你刚刚编写了有史以来最好的网站，但是你如何发布你的网站和它的自定义域名，同时考虑…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ks mr"/></div></div></a></div></div></div>    
</body>
</html>