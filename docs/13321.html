<html>
<head>
<title>Google Pay in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">摇摆中的Google Pay</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/google-pay-in-flutter-1d9a848cc11a?source=collection_archive---------2-----------------------#2022-08-26">https://levelup.gitconnected.com/google-pay-in-flutter-1d9a848cc11a?source=collection_archive---------2-----------------------#2022-08-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e459" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">飘起的Google Pay</em></p><p id="328f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">【T2篇】此处:<a class="ae kp" href="https://flatteredwithflutter.com/google-pay-in-flutter/" rel="noopener ugc nofollow" target="_blank"><em class="ko">【https://flatteredwithflutter.com/google-pay-in-flutter/】</em></a></p><p id="14f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将简要介绍:</p><ol class=""><li id="e1fa" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn kv kw kx ky bi translated">什么是Google Pay</li><li id="219c" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">整合Google Pay</li><li id="4082" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">支付结果</li><li id="3c02" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">UI元素</li></ol><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="lj lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">摇摆中的Google Pay</figcaption></figure><h1 id="8b89" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">什么是Google Pay</h1><p id="70d6" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated"><strong class="js iu"> Google Pay </strong>(被称为<strong class="js iu"> G Pay </strong>)是谷歌开发的一个<a class="ae kp" href="https://en.wikipedia.org/wiki/Digital_wallet" rel="noopener ugc nofollow" target="_blank">数字钱包</a>平台和<a class="ae kp" href="https://en.wikipedia.org/wiki/E-commerce_payment_system" rel="noopener ugc nofollow" target="_blank">在线支付</a>系统，用于在移动设备上实现应用内、在线和面对面<a class="ae kp" href="https://en.wikipedia.org/wiki/Contactless_payment" rel="noopener ugc nofollow" target="_blank">非接触式购买</a>。美国和印度的用户也可以使用iOS设备，尽管功能有限。除此之外，该服务还支持优惠券、登机牌、校园ID卡、车钥匙、活动门票、电影票、公共交通票、商店卡、健康记录和积分卡等通行证。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/ea184a94b7ae32cde08209b71d59cf1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*Ks13MatS9oAHG1pK"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">Google Pay标志</figcaption></figure><h2 id="0d5c" class="mv lq it bd lr mw mx dn lv my mz dp lz kb na nb md kf nc nd mh kj ne nf ml ng bi translated"><strong class="ak">工作原理</strong></h2><p id="185c" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">在应用程序中，当用户点击谷歌支付按钮时，他们会看到一张支付单，显示保存到他们谷歌账户的支付方式。用户可以快速选择付款方式，添加可选的送货地址，或在完成付款前添加新信息。</p><div class="nh ni gp gr nj nk"><a href="https://youtube.com/shorts/oYtSnXq5xVA" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">摇摆中的Google Pay🤑👨‍💻# googlepay # flutter #短裤</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">Google Pay(被称为G Pay)是一个数字钱包平台和在线支付系统，由Google开发，用于支持应用内…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">youtube.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny mt nk"/></div></div></a></div><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/66d49ace92ce33e6c8d8b6a2b2bf1699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*rZOj9-Q1oGbxo7qLKWHbfg.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">Google Pay支付流程</figcaption></figure><ol class=""><li id="cbe7" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn kv kw kx ky bi translated">用户点击G Pay按钮，会看到一张付款单，上面列有支持的付款方式。</li><li id="f2b5" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">用户选择一种支付方式，G Pay向应用程序返回所选方式的支付令牌。</li><li id="8dac" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">该应用程序向后端提交支付令牌</li><li id="6db4" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">后端处理购买，并将支付令牌发送给支付服务提供商(PSP)</li></ol><blockquote class="oa ob oc"><p id="4680" class="jq jr ko js b jt ju jv jw jx jy jz ka od kc kd ke oe kg kh ki of kk kl km kn im bi translated">G Pay 与这些支付处理器整合。</p></blockquote><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="oh oi di oj bf ok"><div class="gh gi og"><img src="../Images/83ef353679d5a2140da7b7c704ec1089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qeKMp4Yot5OJToBI0DDWVQ.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">摇摆中的Google Pay</figcaption></figure><h1 id="b2fa" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">整合Google Pay</h1><p id="8929" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">我们将期待谷歌支付整合的<a class="ae kp" href="https://pub.dev/packages/pay" rel="noopener ugc nofollow" target="_blank">支付</a>方案。这个包兼顾了<a class="ae kp" href="https://www.apple.com/sg/apple-pay/" rel="noopener ugc nofollow" target="_blank"> Apple Pay </a>和<a class="ae kp" href="https://pay.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Pay </a>。</p><p id="1b51" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在引擎盖下，这个包使用了<a class="ae kp" href="https://developers.google.com/pay/api" rel="noopener ugc nofollow" target="_blank"> Google Pay API </a>。设置支付API所需的东西最终将被集成到<a class="ae kp" href="https://pub.dev/packages/pay" rel="noopener ugc nofollow" target="_blank">支付</a>包中</p><h2 id="24ea" class="mv lq it bd lr mw mx dn lv my mz dp lz kb na nb md kf nc nd mh kj ne nf ml ng bi translated"><strong class="ak">设置:</strong></h2><ul class=""><li id="f22d" class="kq kr it js b jt mn jx mo kb ol kf om kj on kn oo kw kx ky bi translated">点击查看他们的集成需求<a class="ae kp" href="https://developers.google.com/pay/api/android/overview" rel="noopener ugc nofollow" target="_blank">。它基本上提到了他们的环境、品牌指南和其他东西。</a></li><li id="c6f2" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated">点击这里查看他们的生产访问请求<a class="ae kp" href="https://developers.google.com/pay/api/android/guides/test-and-deploy/request-prod-access" rel="noopener ugc nofollow" target="_blank">，在这里您可以设置对Google Wallet API和其他清单的访问。</a></li></ul><blockquote class="oa ob oc"><p id="5f4a" class="jq jr ko js b jt ju jv jw jx jy jz ka od kc kd ke oe kg kh ki of kk kl km kn im bi translated">现在开始设置您的代码。</p></blockquote><ul class=""><li id="09ef" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">在内部，Google API需要以下Gradle依赖关系(<strong class="js iu">来自android native </strong>)，由<strong class="js iu">支付包</strong>处理</li></ul><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="394f" class="mv lq it oq b gy ou ov l ow ox">implementation "com.google.android.gms:play-services-wallet:18.0.0"</span></pre><p id="c2f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，我们需要在您的应用程序的<code class="fe oy oz pa oq b">build.gradle</code>中更改以下内容</p><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="8e4b" class="mv lq it oq b gy ou ov l ow ox">minSdkVersion 19</span><span id="be8f" class="mv lq it oq b gy pb ov l ow ox">compileSdkVersion 31</span></pre><ul class=""><li id="d0cf" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">在你的<code class="fe oy oz pa oq b">pubspec.yaml</code>中包含<a class="ae kp" href="https://pub.dev/packages/pay" rel="noopener ugc nofollow" target="_blank">包</a></li></ul><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="4013" class="mv lq it oq b gy ou ov l ow ox"># pubspec.yaml<br/>dependencies:<br/>  pay: ^<!-- -->1.0.10</span></pre><p id="109d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，你可以访问<a class="ae kp" href="https://pub.dev/documentation/pay/latest/pay/GooglePayButton-class.html" rel="noopener ugc nofollow" target="_blank">谷歌支付按钮</a>和<a class="ae kp" href="https://pub.dev/documentation/pay/latest/pay/ApplePayButton-class.html" rel="noopener ugc nofollow" target="_blank">苹果支付按钮</a></p><h2 id="179e" class="mv lq it bd lr mw mx dn lv my mz dp lz kb na nb md kf nc nd mh kj ne nf ml ng bi translated">GooglePayButton</h2><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="oh oi di oj bf ok"><div class="gh gi pc"><img src="../Images/5fcaa16c3f803c2f9d44884b263453e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*nemAUFeDd-dH97qmeOecTg.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">谷歌支付按钮</figcaption></figure><p id="3b20" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是一个小部件，根据<a class="ae kp" href="https://pub.dev/documentation/pay/latest/pay/PayButton-class.html" rel="noopener ugc nofollow" target="_blank"> PayButton </a>中指定的规则和约束显示Google Pay按钮。</p><p id="d868" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个小部件提供了另一种基于UI的集成路径，它包装了支付库的API调用，并将它们作为小部件生命周期的一部分。因此:</p><ul class=""><li id="b7a5" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">小部件仅显示<a class="ae kp" href="https://pub.dev/documentation/pay/latest/pay/Pay/userCanPay.html" rel="noopener ugc nofollow" target="_blank"> Pay.userCanPay </a>方法是否返回true。</li></ul><p id="94bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，如果代码在iOS上运行，那么将显示<strong class="js iu">apple pay按钮</strong>(假设您已经设置了<a class="ae kp" href="https://developer.apple.com/documentation/passkit/apple_pay/setting_up_apple_pay_requirements" rel="noopener ugc nofollow" target="_blank"> ApplePay配置</a>)。</p><ul class=""><li id="24ff" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">点击按钮会自动触发<a class="ae kp" href="https://pub.dev/documentation/pay/latest/pay/Pay/showPaymentSelector.html" rel="noopener ugc nofollow" target="_blank">pay . showpaymentselector</a>方法，开始支付过程。</li></ul><p id="2b25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就是<strong class="js iu">Google pay按钮</strong>的样子。</p><blockquote class="oa ob oc"><p id="96c3" class="jq jr ko js b jt ju jv jw jx jy jz ka od kc kd ke oe kg kh ki of kk kl km kn im bi translated">注意:GooglePayButton从PayButton扩展而来</p></blockquote><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="4f09" class="mv lq it oq b gy ou ov l ow ox">GooglePayButton(<br/>  paymentConfigurationAsset: 'google_pay_config.json',<br/>  paymentItems: _paymentItems,<br/>  style: GooglePayButtonStyle.black,<br/>  type: GooglePayButtonType.pay,<br/>  margin: <strong class="oq iu">const</strong> EdgeInsets.only(top: 15.0),<br/>  onPaymentResult: onGooglePayResult,<br/>  loadingIndicator: <strong class="oq iu">const</strong> Center(<br/>    child: CircularProgressIndicator(),<br/>  ),<br/>)</span></pre><h2 id="2ba8" class="mv lq it bd lr mw mx dn lv my mz dp lz kb na nb md kf nc nd mh kj ne nf ml ng bi translated">支付配置</h2><p id="eadc" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">在上面的代码片段中，我们看到<code class="fe oy oz pa oq b">PaymentConfiguration</code>是一个必需的参数。此参数保存有关支付交易的信息。</p><p id="6fed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它加载支付交易所需的配置信息，该信息基于来源。对此有两种选择:</p><ul class=""><li id="bff9" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">从这样的远程服务器</li></ul><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="f42d" class="mv lq it oq b gy ou ov l ow ox">PaymentConfiguration.fromJsonString(<br/>    '{"provider": "apple_pay", "data": {}}');</span></pre><ul class=""><li id="ce6e" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">像这样从资产文件夹中</li></ul><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/46de8f78be2252f0b61aa5d89a1c34ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*73ep_gQo_uxMH9ixuyp5EQ.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">资产的付款配置</figcaption></figure><p id="3377" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">内部支付配置</strong></p><ul class=""><li id="4b87" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">PaymentConfiguration是一个JSON，按照Google Pay API，其中每个参数代表一个请求对象。</li></ul><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="ab86" class="mv lq it oq b gy ou ov l ow ox">{<br/>   "provider":"google_pay",<br/>   "data":{<br/>      "environment":"TEST",<br/>      "apiVersion":2,<br/>      "apiVersionMinor":0,<br/>      "allowedPaymentMethods":[<br/>         {<br/>            "type":"CARD",<br/>            "tokenizationSpecification":{<br/>               "type":"PAYMENT_GATEWAY",<br/>               "parameters":{<br/>                  "gateway":"example",<br/>                  "gatewayMerchantId":"gatewayMerchantId"<br/>               }<br/>            },<br/>            "parameters":{<br/>               "allowedCardNetworks":[<br/>                  "VISA",<br/>                  "MASTERCARD"<br/>               ],<br/>               "allowedAuthMethods":[<br/>                  "PAN_ONLY",<br/>                  "CRYPTOGRAM_3DS"<br/>               ],<br/>               "billingAddressRequired":true,<br/>               "billingAddressParameters":{<br/>                  "format":"FULL",<br/>                  "phoneNumberRequired":true<br/>               }<br/>            }<br/>         }<br/>      ],<br/>      "merchantInfo":{<br/>         "merchantId":"01234567890123456789",<br/>         "merchantName":"Example Merchant Name"<br/>      },<br/>      "transactionInfo":{<br/>         "countryCode":"US",<br/>         "currencyCode":"USD"<br/>      }<br/>   }<br/>}</span></pre><ul class=""><li id="8fad" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">provider</code>:这个可以是<strong class="js iu"> apple_pay </strong>也可以是<strong class="js iu"> google_pay </strong></li><li id="3dad" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">data</code>:这是PaymentRequest的核心，它本身就是一个JSONObject</li><li id="b52c" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">environment</code>:这可以是<strong class="js iu">测试</strong>或<strong class="js iu">生产</strong></li></ul><p id="b206" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有Google提供的测试卡套件，只能在<strong class="js iu">测试</strong>环境内部使用。要访问这些测试卡，请在此处加入<a class="ae kp" href="https://groups.google.com/forum/#!forum/googlepay-test-mode-stub-data" rel="noopener ugc nofollow" target="_blank"><strong class="js iu"/></a></p><p id="36d8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">测试环境支持</p><ol class=""><li id="ade8" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn kv kw kx ky bi translated">Visa、Mastercard、Discover和Amex卡网络</li><li id="63d1" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated"><code class="fe oy oz pa oq b">PAN_ONLY</code>和<code class="fe oy oz pa oq b">CRYPTOGRAM_3DS</code>认证方式</li></ol><ul class=""><li id="9822" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">apiVersion</code>:该规格的值为<code class="fe oy oz pa oq b">2</code>。</li><li id="47a7" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">apiVersionMinor</code>:该规格值为<code class="fe oy oz pa oq b">0</code>。</li><li id="1056" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">allowedPaymentMethods</code>:这是类型<strong class="js iu"> PaymentMethod </strong>，指定了对G Pay API支持的一种或多种支付方式的支持。</li></ul></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><p id="0c31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">支付方式</strong></p><p id="7f0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这包括3个属性:</p><ol class=""><li id="f393" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn kv kw kx ky bi translated"><code class="fe oy oz pa oq b">type</code> : <strong class="js iu">卡</strong>是该参数唯一支持的值</li></ol><p id="ba3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.<code class="fe oy oz pa oq b">tokenizationSpecification</code>这是类型<strong class="js iu">tokenization specification</strong>并且有两个属性</p><p id="3a2e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">标记化规范</strong></p><ul class=""><li id="3a86" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">type</code>:对于<code class="fe oy oz pa oq b">CARD</code>支付方式，使用PAYMENT_GATEWAY。</li><li id="6946" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">parameters</code>:包含一个Gateway对象，该对象有两个属性<strong class="js iu"> gateway </strong>和<strong class="js iu"> gatewayMerchantId。</strong></li></ul><blockquote class="oa ob oc"><p id="8df6" class="jq jr ko js b jt ju jv jw jx jy jz ka od kc kd ke oe kg kh ki of kk kl km kn im bi translated">注意:网关的值取决于支持的<a class="ae kp" href="https://developers.google.com/pay/api/android/reference/request-objects#gateway" rel="noopener ugc nofollow" target="_blank">网关</a></p></blockquote><p id="0122" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.<code class="fe oy oz pa oq b">parameters</code>这是<strong class="js iu">卡参数</strong>类型，有<strong class="js iu"> 2必需</strong>和<strong class="js iu"> 5可选</strong>参数</p><p id="8c81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">卡片参数</strong></p><ul class=""><li id="6757" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">allowedAuthMethods</code> ( <strong class="js iu">必选</strong>):支持验证卡交易的字段的字符串数组。<strong class="js iu"> PAN_ONLY </strong>和<strong class="js iu"> CRYPTOGRAM_3DS </strong></li></ul><blockquote class="oa ob oc"><p id="f263" class="jq jr ko js b jt ju jv jw jx jy jz ka od kc kd ke oe kg kh ki of kk kl km kn im bi translated">注意:我们只能在测试环境下使用这两个</p></blockquote><ul class=""><li id="7dc4" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">allowedCardNetworks</code> ( <strong class="js iu">必选</strong>):您和Google Pay API支持的一个或多个卡网络。例如<strong class="js iu">美国运通、DISCOVER、INTERAC、JCB、万事达卡、VISA </strong></li><li id="81d4" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">billingAddressRequired</code>:如果需要账单地址，请设置为<code class="fe oy oz pa oq b">true</code>。这会增加摩擦。</li><li id="5658" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">billingAddressParameters</code>:这是类型<strong class="js iu">计费地址参数</strong>，有两个参数</li></ul><p id="8aca" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">计费地址参数</strong></p><ul class=""><li id="3976" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">format</code>:完成交易所需的账单地址格式。例如<strong class="js iu"> MIN( </strong>名称、国家代码和邮政编码<strong class="js iu"> ) </strong>和<strong class="js iu"> FULL </strong>(长参数列表)</li><li id="f2c8" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">phoneNumberRequired</code>:如果处理交易需要电话号码，则设置为<code class="fe oy oz pa oq b">true</code>。</li></ul></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><ul class=""><li id="a0aa" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">merchantInfo</code>:这个<strong class="js iu"> MerchantInfo </strong>对象提供请求支付数据的商家的信息，包括</li></ul><p id="5d50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">商品名称</strong>:该名称出现在付款单中。在<code class="fe oy oz pa oq b">TEST</code>环境中，或者如果商户未被识别，支付单上会显示“支付未验证商户”消息。</p><ul class=""><li id="8f3f" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">transactionInfo</code>:这个<strong class="js iu"> TransactionInfo </strong>对象用于呈现支付授权对话框。它包括</li></ul><p id="904e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">货币代码(必填):</strong> ISO 4217字母货币代码</p><p id="2e27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">国家代码:</strong>ISO 3166-交易处理地的1 alpha-2国家代码。</p></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="1655" class="lp lq it bd lr ls pl lu lv lw pm ly lz ma pn mc md me po mg mh mi pp mk ml mm bi translated">支付结果</h1><p id="5efa" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">一旦点击了G Pay按钮，就会触发付款单的显示。一旦用户做出选择，工作表就会关闭，您会在<strong class="js iu"> onPaymentResult </strong>中收到结果</p><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="ca24" class="mv lq it oq b gy ou ov l ow ox">{<br/>   "apiVersion":2,<br/>   "apiVersionMinor":0,<br/>   "paymentMethodData":{<br/>      "description":"YOUR CARD DESCRIPTION",<br/>      "info":{<br/>         "billingAddress":{<br/>            "address1":"YOUR ADDRESS1",<br/>            "address2":"YOUR ADDRESS2",<br/>            "address3":"",<br/>            "administrativeArea":"YOUR AREA",<br/>            "countryCode":"YOUR COUNTRY",<br/>            "locality":"YOUR LOCALITY",<br/>            "name":"YOUR NAME",<br/>            "phoneNumber":"YOUR PHONE NUMBER",<br/>            "postalCode":YOUR POSTAL CODE,<br/>            "sortingCode":""<br/>         },<br/>         "cardDetails":YOUR CARD DETAILS,<br/>         "cardNetwork":"VISA"<br/>      },<br/>      "tokenizationData":{<br/>         "token":"examplePaymentMethodToken",<br/>         "type":"PAYMENT_GATEWAY"<br/>      },<br/>      "type":"CARD"<br/>   }<br/>}</span></pre><ul class=""><li id="79af" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">apiVersion</code>:该规格的值为<code class="fe oy oz pa oq b">2</code></li><li id="a644" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">apiVersionMinor</code>:该规格值为<code class="fe oy oz pa oq b">0</code></li><li id="3800" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">paymentMethodData</code>:该值的类型为<strong class="js iu"> PaymentMethodData </strong>，包含4个参数</li></ul><p id="cdd8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">支付方法数据</strong></p><p id="d956" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果选择成功，结果由一个<a class="ae kp" href="https://developers.google.com/pay/api/android/reference/object#PaymentData" rel="noopener ugc nofollow" target="_blank"> PaymentData </a>对象完成，该对象包含所选支付方式的相关信息:</p><ul class=""><li id="0df2" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">type</code>:在G Pay支付单中选择的支付方式类型</li><li id="d44f" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">description</code>:包含描述支付方式的面向用户的消息</li><li id="40c2" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">tokenizationData</code>:该值的类型为<strong class="js iu">paymentmethotokentizationdata</strong>，由两个参数组成</li></ul><p id="65ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe oy oz pa oq b">type</code>:应用于所选支付方式的令牌化类型</p><p id="c825" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe oy oz pa oq b">token</code>:生成的支付方式令牌。例如<strong class="js iu">支付_网关</strong>，<strong class="js iu">直接</strong></p><ul class=""><li id="457f" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated"><code class="fe oy oz pa oq b">info</code>:包含3个参数<strong class="js iu">账单地址、卡片详情、</strong>和<strong class="js iu">卡片网络</strong></li></ul><p id="eb44" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">计费地址以<a class="ae kp" href="https://developers.google.com/pay/api/android/reference/response-objects#Address" rel="noopener ugc nofollow" target="_blank">地址对象</a>的形式出现。CardDetails存在于一个表示卡的详细信息的字符串中。该值通常是所选支付账号的最后四位数字。</p><p id="4c8e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">CardNetwork也是一个字符串，表示所选支付的支付卡网络。该值是<a class="ae kp" href="https://developers.google.com/pay/api/android/reference/request-objects#CardParameters" rel="noopener ugc nofollow" target="_blank"> CardParameters </a>中<code class="fe oy oz pa oq b">allowedCardNetworks</code>格式内的值之一。</p><h2 id="0a77" class="mv lq it bd lr mw mx dn lv my mz dp lz kb na nb md kf nc nd mh kj ne nf ml ng bi translated">付款后结果</h2><p id="d0e5" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">现在，您可以使用此付款方式信息来执行实际交易。例如，您可以从上面的响应中获得<code class="fe oy oz pa oq b">tokenizationData</code>并从中提取<code class="fe oy oz pa oq b">token</code>。</p><p id="5e79" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，使用此令牌通过您的支付网关进行支付。查看受支持处理器的<a class="ae kp" href="https://developers.google.com/pay/api/#participating-google-pay-processors" rel="noopener ugc nofollow" target="_blank">列表</a>，了解每个处理器的具体实现细节。</p></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="5c75" class="lp lq it bd lr ls pl lu lv lw pm ly lz ma pn mc md me po mg mh mi pp mk ml mm bi translated">UI元素</h1><p id="57df" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">GooglePayButton在其定义中公开了一个名为<code class="fe oy oz pa oq b">type</code>(这是一个枚举)的参数。我们可以使用这个参数来按照要求显示按钮。以下是提供的选项:</p><ol class=""><li id="de2b" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn kv kw kx ky bi translated">GooglePayButtonType.pay(这是默认值)</li><li id="abef" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">GooglePayButtonType.book</li><li id="2689" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">GooglePayButtonType.buy</li><li id="2d7c" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">GooglePayButtonType.checkout</li><li id="aced" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">GooglePayButtonType.donate</li><li id="a647" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">GooglePayButtonType.order</li><li id="f217" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">GooglePayButtonType.plain</li><li id="35ea" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn kv kw kx ky bi translated">GooglePayButtonType.subscribe</li></ol><p id="b47c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，如果您希望类型为<code class="fe oy oz pa oq b">GooglePayButtonType.subscribe</code>，那么结果将是</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/08795d7f0b620e9bfaba52b624fa8181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*Y3Mt4ZVjyKWXGIKTQdMwDg.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">使用GPay订阅</figcaption></figure><p id="732e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢对每个请求和按钮分别有更多的控制，你可以使用<a class="ae kp" href="https://pub.dev/documentation/pay_android/latest/pay_android/RawGooglePayButton-class.html" rel="noopener ugc nofollow" target="_blank"> RawGooglePayButton </a>实例化一个支付客户端并独立地将按钮添加到你的布局中。</p><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="0dec" class="mv lq it oq b gy ou ov l ow ox">RawGooglePayButton(<br/>  onPressed: <!-- -->onGooglePayPressed<!-- -->,<br/>  style: GooglePayButtonStyle.white,<br/>  type: GooglePayButtonType.plain,<br/>)</span></pre><p id="0fcf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此按钮的结果是</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/36a44bd57d0314c8dfdcf3318f470723.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*T8ZGoo2ZCW2fAhGzXD_DQQ.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">RawGooglePayButton</figcaption></figure><p id="adb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦用户点击这个按钮，您就可以使用<a class="ae kp" href="https://pub.dev/documentation/pay/latest/pay/Pay/Pay.withAssets.html" rel="noopener ugc nofollow" target="_blank"> Pay.withAssets </a>来发起请求，它是一个带有字符串格式的配置列表的<a class="ae kp" href="https://pub.dev/documentation/pay/latest/pay/Pay-class.html" rel="noopener ugc nofollow" target="_blank"> Pay </a>对象的替代对象。</p><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="7aaa" class="mv lq it oq b gy ou ov l ow ox">// PayClient</span><span id="475f" class="mv lq it oq b gy pb ov l ow ox">Pay _payClient = Pay.withAssets([<br/>  'YOUR_GOOGLE_PAY_JSON_FILE',<br/>])</span><span id="da40" class="mv lq it oq b gy pb ov l ow ox">// On the Button Pressed</span><span id="34b6" class="mv lq it oq b gy pb ov l ow ox">void onGooglePayPressed() async {<br/>  final result = await _payClient.showPaymentSelector(<br/>    provider: PayProvider.google_pay,<br/>    paymentItems: _paymentItems,<br/>  );  <br/>}</span></pre><p id="1561" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">作为Google Pay令牌的响应可以发送到您的服务器/ PSP</p><p id="1e17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其他文章:</p><div class="nh ni gp gr nj nk"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-add-flutter-to-android-app-4d80d9820686"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">如何给安卓App添加Flutter</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">如何给安卓App添加Flutter</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">如何给安卓Applevelup.gitconnected.com添加Flutter</p></div></div><div class="nt l"><div class="ps l nv nw nx nt ny mt nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a href="https://medium.com/flutter-community/using-mockito-in-flutter-cd015d338277" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">在Flutter中使用Mockito</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">在Flutter中使用Mockito</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">在Fluttermedium.com使用Mockito</p></div></div><div class="nt l"><div class="pt l nv nw nx nt ny mt nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a href="https://medium.com/flutter-community/dart-on-aws-lambda-3a46aad38335" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">AWS Lambda上的Dart</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">AWS Lambda上的Dart</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">AWS Lambdamedium.com上的Dart</p></div></div><div class="nt l"><div class="pu l nv nw nx nt ny mt nk"/></div></div></a></div><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/39d76048c382ae85eb0cb1deb00ba9d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*BL1tck33bkM0yhxD.gif"/></div></figure><pre class="le lf lg lh gt op oq or os aw ot bi"><span id="bfd3" class="mv lq it oq b gy ou ov l ow ox"><a class="ae kp" href="https://github.com/AseemWangoo/dynamism/tree/feature/gpay" rel="noopener ugc nofollow" target="_blank">Source Code</a></span></pre></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="dfa8" class="lp lq it bd lr ls pl lu lv lw pm ly lz ma pn mc md me po mg mh mi pp mk ml mm bi translated">分级编码</h1><p id="c24e" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="9be0" class="kq kr it js b jt ju jx jy kb ks kf kt kj ku kn oo kw kx ky bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="63fd" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated">📰查看<a class="ae kp" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="4c25" class="kq kr it js b jt kz jx la kb lb kf lc kj ld kn oo kw kx ky bi translated">🔔关注我们:<a class="ae kp" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kp" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kp" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="06af" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🚀👉<a class="ae kp" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>