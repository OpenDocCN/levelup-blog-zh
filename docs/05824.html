<html>
<head>
<title>Build and Deploy a Spam Classifier using ML,NLP and Heroku🚀</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ML、NLP和Heroku构建和部署垃圾邮件分类器🚀</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/end-to-end-project-on-spam-classifier-from-training-to-deployment-fd9232cb1323?source=collection_archive---------12-----------------------#2020-10-05">https://levelup.gitconnected.com/end-to-end-project-on-spam-classifier-from-training-to-deployment-fd9232cb1323?source=collection_archive---------12-----------------------#2020-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6bfc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">端到端NLP项目，直到部署</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/ee39548301f0f4fc92cf4e5fbdbaeb61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cgYVpLWi5Rk5tzK-"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@lephunghia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Nghia Le </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="fc0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据《福布斯》上的一篇文章，我们每天产生大约2.5万亿字节的数据，并且这些数据在未来五年内将增加5倍。在如此庞大的数据量中，几乎90%的数据是未标记的和无用的。它是无用的，因为我们不知道如何使用它。数据科学家和机器学习专家的角色来了。数据科学家有能力将无用的数据转换成有用的形式，以便任何人都能理解。</p><p id="919d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些数据中很大一部分是文本数据，无论是评论、消息、投诉还是其他形式。目前，主要任务之一是设计某种技术，使用该技术我们可以容易地对数据进行分类并更好地理解它。<a class="ae le" href="https://medium.com/swlh/basics-of-natural-language-processing-in-10-minutes-2ed51e6d5d32" rel="noopener">的作用来了<strong class="js iu">自然语言处理</strong> </a>。自然语言处理可以让我们很好地理解文本数据。它给了我们将文本分类到不同类别的能力。如果你从事计算机科学的职业，那么你必须很好地学习这些东西和它们的概念。</p><p id="be1e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不要等待合适的时机到来，无论你什么时候开始，那个时机都会成为你合适的时机。</p><p id="1631" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当你开始学习和进入人工智能领域时，你经常会看到许多教程和博客向你解释不同的算法和方法，但你很难找到一些博客或教程会教你使用一些项目的概念。好吧，我不是所有这些人。</p><p id="3141" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇博客中，我们将从头开始实现一个垃圾邮件分类器。首先，我们训练我们的模型，然后我们测试我们的模型，之后使用flask和journal HTML和CSS，我们为我们的模型创建一个web应用程序，稍后我们还将使用Heroku部署它。</p><p id="c9f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以如果我们对自然语言处理一无所知，先去看看我的博客吧。</p><div class="lf lg gp gr lh li"><a href="https://medium.com/swlh/basics-of-natural-language-processing-in-10-minutes-2ed51e6d5d32" rel="noopener follow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">10分钟自然语言处理基础</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">你也想尽快学会NLP吗？？？</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">medium.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw ky li"/></div></div></a></div><h2 id="4afe" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">我们将分四步完成我们的项目。</h2><ol class=""><li id="9c67" class="mq mr it js b jt ms jx mt kb mu kf mv kj mw kn mx my mz na bi translated"><strong class="js iu"> <em class="nb">使用ML和NLP创建模型</em> </strong></li><li id="dd8a" class="mq mr it js b jt nc jx nd kb ne kf nf kj ng kn mx my mz na bi translated"><strong class="js iu"> <em class="nb">使用flask创建一个web应用程序并将其与模型</em> </strong>连接</li><li id="bf61" class="mq mr it js b jt nc jx nd kb ne kf nf kj ng kn mx my mz na bi translated"><strong class="js iu"> <em class="nb">将项目提交给Github </em> </strong></li><li id="f09f" class="mq mr it js b jt nc jx nd kb ne kf nf kj ng kn mx my mz na bi translated"><strong class="js iu"> <em class="nb">使用Heroku </em> </strong>部署我们的模型</li></ol></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="57c4" class="no ly it bd lz np nq nr mc ns nt nu mf nv nw nx mi ny nz oa ml ob oc od mo oe bi translated">在开始之前，我们先来设置一下我们的环境</h1><ol class=""><li id="c27e" class="mq mr it js b jt ms jx mt kb mu kf mv kj mw kn mx my mz na bi translated"><strong class="js iu"> <em class="nb">下载最新版本的Python </em> </strong></li></ol><div class="lf lg gp gr lh li"><a href="https://www.python.org/downloads/" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">下载Python</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">关于特定端口的信息、开发人员信息来源和二进制可执行文件由发布经理或……</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">www.python.org</p></div></div><div class="lr l"><div class="of l lt lu lv lr lw ky li"/></div></div></a></div><p id="539a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.<strong class="js iu"> <em class="nb">安装需要的包</em> </strong></p><p id="b440" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有软件包都可以使用cmd(终端)中的pip进行安装。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="9288" class="lx ly it oh b gy ol om l on oo">pip install pandas,numpy,scikit-learn,matplotlib,nltk,seaborn</span></pre><p id="c418" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.<strong class="js iu"> <em class="nb">安装Jupyter笔记本</em> </strong></p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="c209" class="lx ly it oh b gy ol om l on oo">pip install jupyter-notebook</span><span id="f4c9" class="lx ly it oh b gy op om l on oo">jupyter notebook ## For running</span></pre><p id="e5f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完成所有三个步骤后，现在让我们开始我们的项目。</p><h1 id="2ea1" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">在jupyter中打开一个新笔记本，按照以下步骤操作</h1></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="a1bb" class="no ly it bd lz np nq nr mc ns nt nu mf nv nw nx mi ny nz oa ml ob oc od mo oe bi translated">1.使用ML和NLP创建模型</h1><h2 id="eaab" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated"><strong class="ak">导入必要的库</strong></h2><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="1582" class="lx ly it oh b gy ol om l on oo">import numpy as np <strong class="oh iu">## scientific computation</strong></span><span id="2fdf" class="lx ly it oh b gy op om l on oo">import pandas as pd <strong class="oh iu">## loading dataset file</strong></span><span id="c2c7" class="lx ly it oh b gy op om l on oo">import matplotlib.pyplot as plt <strong class="oh iu">## Visulization</strong></span><span id="2179" class="lx ly it oh b gy op om l on oo">import nltk  <strong class="oh iu">## Preprocessing our text</strong></span><span id="d7b0" class="lx ly it oh b gy op om l on oo">from nltk.corpus import stopwords <strong class="oh iu">## <em class="nb">removing all the stop words</em></strong></span><span id="a6b5" class="lx ly it oh b gy op om l on oo">from nltk.stem.porter import PorterStemmer <strong class="oh iu">## stemming of words</strong></span></pre><p id="6b3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> NLTK: </strong>自然语言处理工具包是一个python库，用于执行所有的自然语言处理任务，如词干提取、词汇化或删除停用词等。</p><p id="5251" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">波特·斯特梅尔:这是一种用于堵塞的去梗器。词干提取基本上是一种将单词转换成其词根的技术。<br/>例:学习→学习</p><h1 id="089f" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">数据集</h1><p id="80f2" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">我们将要使用的数据集是Kaggle上的开源数据集。</p><p id="de6d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">数据集:<a class="ae le" href="https://www.kaggle.com/venky73/spam-mails-dataset" rel="noopener ugc nofollow" target="_blank"> spam_ham_dataset.csv </a></p><h2 id="3ce5" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated"><strong class="ak">关于数据集</strong></h2><p id="34bb" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">数据集包含三列。数据集的大小约为5.65mb，总共约有5000行。</p><h2 id="7c02" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">列</h2><p id="44a6" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">Label: ham，spam <br/> Text:文本或电子邮件的集合<br/> Label_num: 0表示火腿，1表示垃圾邮件</p><h2 id="2461" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">工作</h2><blockquote class="oy oz pa"><p id="f7b3" class="jq jr nb js b jt ju jv jw jx jy jz ka pb kc kd ke pc kg kh ki pd kk kl km kn im bi translated">我们的任务是创建一个机器学习模型，可以准确预测一封电子邮件是否是垃圾邮件。</p></blockquote><h2 id="cc5d" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">将数据集加载到笔记本中</h2><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="a82d" class="lx ly it oh b gy ol om l on oo">df = pd.read_csv("spam_ham_dataset.csv")</span></pre><h1 id="fa92" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">数据集上的EDA</h1><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="9c9c" class="lx ly it oh b gy ol om l on oo">print(data.shape)  ### Return the shape of data <br/>print(data.ndim)   ### Return the n dimensions of data<br/>print(data.size)   ### Return the size of data <br/>print(data.isna().sum())  ### Returns the sum fo all na values<br/>print(data.info())  ### Give concise summary of a DataFrame<br/>print(df.head())  ## top 5 rows of the dataframe<br/>print(df.tail()) ## bottom 5 rows of the dataframe</span></pre><p id="feb2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行上述代码块后，您将会看到我们的数据集中没有任何空值。另外，需要注意的一点是，我们的中只有一列有数值，所以我们只能可视化该列。</p><h2 id="16f7" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">让我们可视化列<em class="pe"> label_num </em></h2><p id="3cdf" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">我们只能看到列中两个类别的数量。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="239a" class="lx ly it oh b gy ol om l on oo">df["label_num"].value_counts().plot(kind="bar",figsize=(12,6))<br/>plt.xticks(np.arange(2), ('Non spam', 'spam'),rotation=0);</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/ff387df71462e67fffe9db21c9937ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSyNjYDm4cUKpEKHmAGKWQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">“作者提供的图像”</figcaption></figure><p id="4c04" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在该图中，我们可以看到几乎3500条不是垃圾邮件，大约1500条是垃圾邮件。</p><h1 id="9e06" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">清理文本</h1><p id="f747" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">在任何NLP问题中，最重要的步骤是清理文本。清理文本意味着删除所有标点符号、删除停用词、执行词干分析、词汇化，并将文本转换为向量。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="bbcc" class="lx ly it oh b gy ol om l on oo">import re<br/>corpus = []<br/>length = len(df)<br/>for i in range(0,length):<br/>    text = re.sub("[^a-zA-Z0-9]"," ",df["text"][i])<br/>    text = text.lower()<br/>    text = text.split()<br/>    pe = PorterStemmer()<br/>    stopword = stopwords.words("english")<br/>    text = [pe.stem(word) for word in text if not word in set(stopword)]<br/>    text = " ".join(text)<br/>    corpus.append(text)</span><span id="0b48" class="lx ly it oh b gy op om l on oo">print(corpus)</span></pre><p id="35fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">解释:</strong></p><p id="749a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第1行:我们正在导入re库，它用于在python中执行regex。第2行:定义一个空的语料库列表，可以用来存储所有清理后的文本。<br/>第3行:用数据帧的长度初始化var length。<br/>第4行:运行一个从0到数据帧长度的循环。<br/>第5行:删除除小写字母、大写字母和数字之外的所有字符。<br/>第6行:将文本转换为小写。<br/>第7行:按空格分割文本。<br/>第8行:创建porter stemmer的对象。<br/>第9行:将英语词典中的所有停用词初始化为var停用词<br/>第10行:在句子的长度上运行一个循环，然后对句子中的每个词在停用词中进行检查，如果在停用词中没有找到，则对文本应用词干并将其添加到列表中。<br/>第11行:将所有单词连接起来组成一个句子<br/>第12行:将句子附加到语料库列表<br/>第13行:打印语料库列表。</p><p id="3de9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在清理过程中，下一步是将句子列表(语料库)转换为向量，以便我们可以将这些数据输入到我们的机器学习模型中。为了将文本转换成向量，我们将使用一个单词包，它将文本转换成二进制形式。'</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="b790" class="lx ly it oh b gy ol om l on oo">from sklearn.feature_extraction.text import CountVectorizer</span><span id="7dc7" class="lx ly it oh b gy op om l on oo">cv = CountVectorizer(max_features=35000)</span><span id="eb29" class="lx ly it oh b gy op om l on oo">X = cv.fit_transform(corpus).toarray()</span></pre><p id="8cb9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第1行:我们从sklearn导入CountVectorizer。<br/>第2行:为计数矢量器创建一个对象，最大特征数为35000，这意味着我们只获取前35000列。<br/>第3行:使用CV，我们正在拟合are语料库，并将其转换为向量。</p><h2 id="bcd6" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated"><strong class="ak">转储简历以备将来使用</strong></h2><p id="2118" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">为了预测新邮件，我们需要保存我们的模型和计数矢量器。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="c222" class="lx ly it oh b gy ol om l on oo">import pickle ## importing pickle used for dumping models</span><span id="c458" class="lx ly it oh b gy op om l on oo">pickle.dump(cv, open('cv.pkl', 'wb')) ## saving to into cv.pkl file</span></pre><h1 id="ccc6" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">建模和培训</h1><h2 id="9d62" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">使用train_test_split将数据拆分为训练集和验证集</h2><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="3a4c" class="lx ly it oh b gy ol om l on oo">from sklearn.model_selection import train_test_split</span><span id="05d3" class="lx ly it oh b gy op om l on oo">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20, random_state = 0)</span><span id="e316" class="lx ly it oh b gy op om l on oo">##train size 80% and test size 20%</span></pre><h2 id="8e92" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">使用多项式贝叶斯方法创建模型</h2><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="9ba5" class="lx ly it oh b gy ol om l on oo">from sklearn.naive_bayes import MultinomialNB</span><span id="5e49" class="lx ly it oh b gy op om l on oo">model = MultinomialNB()</span></pre><h2 id="0bb6" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">将模型拟合到训练集</h2><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="2f04" class="lx ly it oh b gy ol om l on oo">model.fit(X_train, y_train)</span></pre><h2 id="1685" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">预言；预测；预告</h2><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="59bb" class="lx ly it oh b gy ol om l on oo">y_pred=model.predict(X_test)</span><span id="06fb" class="lx ly it oh b gy op om l on oo">y_pred</span></pre><h1 id="8e34" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">评估模型</h1><p id="d889" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">我们将使用混淆矩阵和准确度分数来评估我们的模型。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="7d12" class="lx ly it oh b gy ol om l on oo">from sklearn.metrics import confusion_matrix,accuracy_score</span><span id="b099" class="lx ly it oh b gy op om l on oo">cm = confusion_matrix(y_test, y_pred)</span><span id="ef28" class="lx ly it oh b gy op om l on oo">score = accuracy_score(y_test,y_pred)</span><span id="d611" class="lx ly it oh b gy op om l on oo">print(cm,score*100)</span></pre><p id="b7e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="nb">输出:</em> </strong></p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="1bec" class="lx ly it oh b gy ol om l on oo">[[716  16]<br/> [ 18 285]] 96.71497584541063</span></pre><blockquote class="oy oz pa"><p id="7636" class="jq jr nb js b jt ju jv jw jx jy jz ka pb kc kd ke pc kg kh ki pd kk kl km kn im bi translated"><strong class="js iu">太好了，我们得到了96.71%的准确率</strong></p></blockquote><h1 id="4aa5" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">保存我们的模型</h1><p id="8348" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">为了保存我们的模型，我们将使用pickle。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="22dc" class="lx ly it oh b gy ol om l on oo">import pickle<br/>pickle.dump(model, open("spam.pkl", "wb"))</span></pre><p id="a2d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，让我们通过加载和测试测试数据来测试我们的保存模型。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="f260" class="lx ly it oh b gy ol om l on oo">loaded_model = pickle.load(open("spam.pkl", "rb"))<br/>loaded_model.predict(X_test)<br/>loaded_model.score(X_test,y_test)</span><span id="d57e" class="lx ly it oh b gy op om l on oo">#####OUTPUT######<br/>96.71497584541063</span></pre><h1 id="9e3e" class="no ly it bd lz np oq nr mc ns or nu mf nv os nx mi ny ot oa ml ob ou od mo oe bi translated">新邮件的预测</h1><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="b2fa" class="lx ly it oh b gy ol om l on oo">def new_review(new_review):<br/>  new_review = new_review<br/>  new_review = re.sub('[^a-zA-Z]', ' ', new_review)<br/>  new_review = new_review.lower()<br/>  new_review = new_review.split()<br/>  ps = PorterStemmer()<br/>  all_stopwords = stopwords.words('english')<br/>  all_stopwords.remove('not')</span><span id="098a" class="lx ly it oh b gy op om l on oo">  new_review = [ps.stem(word) for word in new_review if not word in   set(all_stopwords)]<br/>  new_review = ' '.join(new_review)<br/>  new_corpus = [new_review]<br/>  new_X_test = cv.transform(new_corpus).toarray()<br/>  new_y_pred = loaded_model.predict(new_X_test)<br/>return new_y_pred</span><span id="d4e5" class="lx ly it oh b gy op om l on oo">new_review = new_review(str(input("Enter new review...")))<br/>if new_review[0]==1:<br/>  print("SPAM")<br/>else :<br/>  print("NOT SPAM")</span></pre><p id="d52f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">尝试运行上面的代码，键入一封随机的电子邮件，并检查我们的模型将如何正确地预测垃圾邮件和非垃圾邮件。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="d4aa" class="lx ly it oh b gy ol om l on oo">Enter new review...<br/>IMPORTANT - You could be entitled up to £3,160 in compensation from mis-sold PPI on a credit card or loan. Please reply PPI for info or STOP to opt out. </span><span id="d6a7" class="lx ly it oh b gy op om l on oo">SPAM</span><span id="ee78" class="lx ly it oh b gy op om l on oo">Enter new review...<br/>hi scott, i was wondering you have submitted your project or not</span><span id="ecee" class="lx ly it oh b gy op om l on oo">NOT SPAM</span></pre></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="0067" class="no ly it bd lz np nq nr mc ns nt nu mf nv nw nx mi ny nz oa ml ob oc od mo oe bi translated">2.使用flask创建web应用程序并将其与模型连接</h1><p id="7fbe" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">因此，要创建一个web应用程序，让我们首先准备一个如下所示的文件夹结构</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="6727" class="lx ly it oh b gy ol om l on oo">email_spam(root)<br/>    |____templates<br/>            |___index.html  ## homepage file<br/>            |___result.html ## to show prediction<br/>    |____static<br/>            |____style.css  ## css file <br/>    |____app.py  ## main flask file<br/>    |_____spam.pkl ## ml model<br/>    |______cv.pkl  ## count vectorizer</span></pre><p id="7e43" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"><em class="nb">index . html:<br/></em></strong>创建一个供用户输入新邮件的输入框，以及一个将文本发送到服务器的按钮。</p><p id="ce3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"><em class="nb">result . html:<br/></em></strong>你想显示gif还是纯文本还是两者都显示来代替垃圾邮件和非垃圾邮件，这是你的愿望。</p><p id="5936" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"><em class="nb">style . css<br/></em>T5】它是一个CSS文件，用来让网页好看。这取决于你，只要按照你的意愿去设计。</strong></p><p id="97a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以从我的Github帐户下载并使用我的模板和静态目录。</p><div class="lf lg gp gr lh li"><a href="https://github.com/Abhayparashar31/email_spam" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">Abhayparashar31/email_spam</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">通过在GitHub上创建一个帐户，为Abhayparashar31/email_spam开发做贡献。</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">github.com</p></div></div><div class="lr l"><div class="pg l lt lu lv lr lw ky li"/></div></div></a></div><p id="b1a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="nb"> app.py: </em> </strong></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ph pi l"/></div></figure><p id="3ed1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们在本地主机上运行代码</p><p id="8172" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开CMD并转到根(email_spam)文件夹，然后使用<code class="fe pj pk pl oh b">python app.py</code>运行app.py，然后您会看到如下消息👇</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/03776b6868ee7141b27c75d5adebf688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LHKX_zmLOrI7LijX6HKFQ.png"/></div></div></figure><p id="4d1d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">只需在任意浏览器中打开网址(<a class="ae le" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>)，使用一些新的随机邮件测试web app即可。</p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="8fca" class="no ly it bd lz np nq nr mc ns nt nu mf nv nw nx mi ny nz oa ml ob oc od mo oe bi translated">3.将项目提交给Github</h1><p id="df96" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">在将项目提交给Github之前，我们还要创建两个文件。</p><p id="86ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 1。Profile: </strong> Heroku应用程序包含一个Procfile，它指定了应用程序在启动时执行的命令。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="cef2" class="lx ly it oh b gy ol om l on oo">web: gunicorn app:app</span></pre><p id="3c20" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 2。requires . txt:</strong>要求。txt文件用于指定运行项目所需的python包。</p><pre class="kp kq kr ks gt og oh oi oj aw ok bi"><span id="1828" class="lx ly it oh b gy ol om l on oo">Flask==1.1.1<br/>gunicorn==19.9.0<br/>itsdangerous==1.1.0<br/>Jinja2==2.10.1<br/>MarkupSafe==1.1.1<br/>Werkzeug==0.15.5<br/>numpy&gt;=1.9.2<br/>scipy&gt;=0.15.1<br/>scikit-learn&gt;=0.18<br/>matplotlib&gt;=1.4.3<br/>pandas&gt;=0.19</span></pre><p id="0056" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在之后，去你的Github账户上传文件，然后提交给分支机构。</p><p id="8d65" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你不知道怎么做，就按照下面的步骤去做。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/27f7904e28e62aa7699b3efbaf0aa682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YDOUmsNjvOga9jM5ib-RjA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">“作者提供的图像”</figcaption></figure></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="fe14" class="no ly it bd lz np nq nr mc ns nt nu mf nv nw nx mi ny nz oa ml ob oc od mo oe bi translated">4.使用Heroku部署模型</h1><p id="34f5" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">访问<a class="ae le" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>并创建一个免费帐户，然后登录您的帐户。</p><p id="b14f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">登录后，创建一个新的应用程序，并连接到你的Github，然后手动部署。您将看到一个URL，您可以通过该URL访问您的应用程序。</p><p id="2246" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你不知道怎么做，就按照图中所示的步骤去做。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/a40a48c1d7a4dec3ef7b24ada6b1865d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvtPhqT_6fC23iepljaHCA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">“作者提供的图像”</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi po"><img src="../Images/fb269d9f5ff023271510236f817e007c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*1KZla1IxjEJWolcsn50oZQ.gif"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">“作者图片:</figcaption></figure><p id="ad12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="nb">你可以在我的Github简介里找到所有的源代码</em></strong><a class="ae le" href="https://github.com/Abhayparashar31/Diabetes-prediction" rel="noopener ugc nofollow" target="_blank"><strong class="js iu"><em class="nb">abhayparashar 31</em></strong></a></p><h2 id="96ce" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">感谢阅读😃</h2></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="88bf" class="no ly it bd lz np nq nr mc ns nt nu mf nv nw nx mi ny nz oa ml ob oc od mo oe bi translated">关于作者</h1><p id="6032" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb ov kd ke kf ow kh ki kj ox kl km kn im bi translated">我是Abhay Parashar，一个迷上AI的python爱好者。我是一名计算机专业的学生。一个狂热的作家和程序员。我发布关于python，机器学习，NLP，以及更多与AI相关的文章。我也张贴不同种类的关于机器学习的端到端项目。</p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="62a0" class="no ly it bd lz np nq nr mc ns nt nu mf nv nw nx mi ny nz oa ml ob oc od mo oe bi translated">未来读物</h1><div class="lf lg gp gr lh li"><a href="https://towardsdatascience.com/build-deploy-diabetes-prediction-app-using-flask-ml-and-heroku-2de07cbd902d" rel="noopener follow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">使用Flask、ML和Heroku构建和部署糖尿病预测应用程序</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">面向机器学习爱好者的端到端项目部署👍</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">towardsdatascience.com</p></div></div><div class="lr l"><div class="pp l lt lu lv lr lw ky li"/></div></div></a></div><div class="lf lg gp gr lh li"><a href="https://medium.com/10-minutes-data-science/cuda-installation-in-windows-2020-638b008b4639" rel="noopener follow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">windows中的Cuda安装(2020)-逐步过程</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">使用GPU训练您的深度学习模型</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">medium.com</p></div></div><div class="lr l"><div class="pq l lt lu lv lr lw ky li"/></div></div></a></div></div></div>    
</body>
</html>