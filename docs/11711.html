<html>
<head>
<title>Deploy lambda using serverless</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用无服务器部署lambda</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploy-lambda-using-serverless-a44a66f3d603?source=collection_archive---------7-----------------------#2022-04-08">https://levelup.gitconnected.com/deploy-lambda-using-serverless-a44a66f3d603?source=collection_archive---------7-----------------------#2022-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="262d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">使用无服务器部署lambda</em></p><p id="baa9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">文章在此:</em><a class="ae kp" href="https://flatteredwithflutter.com/deploy-lambda-using-serverless/" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://flatteredwithfutter . com/deploy-lambda-using-server less/</em></a></p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="kv kw l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">使用无服务器部署lambda</figcaption></figure><p id="5198" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将简要介绍:</p><ol class=""><li id="a558" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn lg lh li lj bi translated">部署lambda的选项</li><li id="ecf8" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">设置无服务器</li><li id="6605" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">使用无服务器创建lambda(将映像上传到s3存储桶)</li><li id="5337" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">使用无服务器部署lambda</li></ol><blockquote class="lp lq lr"><p id="819d" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">注意:本文假设读者已经设置了<a class="ae kp" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2-mac.html" rel="noopener ugc nofollow" target="_blank"> AWS cli </a>并且了解golang</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lv"><img src="../Images/032fdeef65d866dc4367bf7ae9640c42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uoXX1CcF2qxAFe5HZfrgSg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">使用无服务器部署lambda</figcaption></figure><h1 id="d614" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">部署lambda的选项</h1><p id="26d4" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">在撰写本文时，有两种方式将lambdas部署到AWS上</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/e50020b7c42d0ab7e74083f8e759bc1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*WvQBPtKe5MJ0FGKsvseYIQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">使用无服务器部署lambda</figcaption></figure><ul class=""><li id="240c" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated"><a class="ae kp" href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/what-is-sam.html" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">使用AWS SAM </strong> </a></li></ul><p id="a15d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AWS无服务器应用程序模型(AWS SAM)是一个开源框架，可以用来在AWS上构建无服务器应用程序</p><p id="98c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> SAM </strong>的主要好处之一是<strong class="js iu">本地调试和测试</strong></p><p id="eb1b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它允许您在本地构建、测试和调试由AWS SAM模板定义的无服务器应用程序。它通过提供与实际Lambda执行环境的对等性来帮助您提前发现问题</p><ul class=""><li id="b7cf" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated"><a class="ae kp" href="https://www.serverless.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">使用无服务器</strong> </a></li></ul><p id="702b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过使用无服务器框架，以极低的开销和成本开发、部署、故障排除和保护您的无服务器应用程序。无服务器框架由一个开源CLI组成。</p><p id="1b2a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">无服务器允许我们专注于代码，而它负责设置策略，并在AWS上提供所需的基础设施。</p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="7479" class="mc md it bd me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv ns mx my mz bi translated">设置无服务器</h1><p id="8d9d" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">要安装<code class="fe nt nu nv nw b">serverless</code>，请按此处的<a class="ae kp" href="https://www.serverless.com/framework/docs/getting-started" rel="noopener ugc nofollow" target="_blank">安装</a>。就个人而言，我使用下面的配置</p><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="f05d" class="ob md it nw b gy oc od l oe of">npm install -g serverless</span></pre><ul class=""><li id="6e10" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">安装完成后，您可以在终端上输入<code class="fe nt nu nv nw b">sls</code>来访问它</li><li id="7beb" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">我们现在可以通过这个命令访问多个模板</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="1bfb" class="ob md it nw b gy oc od l oe of">sls create --help</span></pre><p id="185a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将把重点放在Go特有的一个上，也就是<code class="fe nt nu nv nw b">aws-go-dep</code>让我们使用这个模板来创建一个简单的lambda。最后的命令是</p><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="7603" class="ob md it nw b gy oc od l oe of">sls create --template aws-go-dep --path upload-s3</span></pre><p id="a0f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nt nu nv nw b">--template</code>用于指定模板名称</p><p id="32d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nt nu nv nw b">--path</code> <strong class="js iu">(可选)</strong>用于指定放置代码的目录</p><ul class=""><li id="7cf0" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们应该会看到这样的文件夹结构</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi og"><img src="../Images/5f0d0d1586ca1641ca4daf1a609fed70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*XlUZ6DCr_GLUY4MLBBjs3w.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Golang无服务器文件夹结构</figcaption></figure><ul class=""><li id="9743" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">默认情况下，<code class="fe nt nu nv nw b">aws-go-dep</code> a模板为我们提供了两个基于<code class="fe nt nu nv nw b">http (GET)</code>的端点，这可以在<code class="fe nt nu nv nw b">serverless.yml</code>中看到</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="1755" class="ob md it nw b gy oc od l oe of">functions:<br/>  hello:<br/>    handler: bin/hello<br/>    events:<br/>      - httpApi:<br/>          path: /hello<br/>          method: get<br/>  world:<br/>    handler: bin/world<br/>    events:<br/>      - httpApi:<br/>          path: /world<br/>          method: get</span></pre><p id="bc82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">等效文件对应于<code class="fe nt nu nv nw b">hello/main.go</code>和<code class="fe nt nu nv nw b">world/main.go</code></p><ul class=""><li id="47e2" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">如果您看到错误，请尝试运行以下命令</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="db7a" class="ob md it nw b gy oc od l oe of">go mod init &lt;SOME NAME HERE&gt;</span><span id="4d10" class="ob md it nw b gy oh od l oe of">go mod tidy</span></pre><p id="8aba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将有助于设置任何go程序所需的<code class="fe nt nu nv nw b">go.mod</code>。</p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="4897" class="mc md it bd me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv ns mx my mz bi translated">使用无服务器创建lambda(将映像上传到s3存储桶)</h1><p id="498d" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">我们将修改我们的lambda来上传图像到S3桶。</p><ul class=""><li id="a683" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们从<code class="fe nt nu nv nw b">serverless.yml</code>中删除不必要的端点，以及不需要的文件夹，如<code class="fe nt nu nv nw b">hello/main.go</code>和<code class="fe nt nu nv nw b">world/main.go</code></li><li id="ec22" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">创建一个名为<code class="fe nt nu nv nw b">upload</code>的新文件夹，并在其中创建一个文件<code class="fe nt nu nv nw b">main.go</code></li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/8755f19083302d0d25d896f17c5d0706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*IcqK4hy3lI9FcxU4beWXiw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">我们最终上传的lambda结构</figcaption></figure><ul class=""><li id="0d5c" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们将定义一个请求体结构，它将接受<code class="fe nt nu nv nw b">filename</code>和<code class="fe nt nu nv nw b">body</code>作为输入。(注意:主体将是图像的base64编码器)</li></ul><blockquote class="lp lq lr"><p id="2425" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">要获取任何图像的base64，<a class="ae kp" href="https://base64.guru/converter/encode/image" rel="noopener ugc nofollow" target="_blank">查看此处</a></p></blockquote><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="490a" class="ob md it nw b gy oc od l oe of">type ImageRequestBody struct {<br/> FileName string `json:"filename"`<br/> Body     string `json:"body"`<br/>}</span></pre><ul class=""><li id="34d4" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们将从输入中解析主体，并使用返回由base64字符串表示的字节的<code class="fe nt nu nv nw b">DecodeString</code>对其进行解码</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="ab61" class="ob md it nw b gy oc od l oe of">decoded, err := base64.StdEncoding.DecodeString(bodyRequest.Body)</span></pre><ul class=""><li id="3f35" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们所有与图像相关的函数都在<a class="ae kp" href="https://github.com/AseemWangoo/golang-programs/blob/master/upload-s3/upload/structs.go" rel="noopener ugc nofollow" target="_blank"> img_utils.go </a>里面。在前一步将图像解码成字节后，我们现在获取这些字节并形成一个临时文件。</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="a6ba" class="ob md it nw b gy oc od l oe of">func imageUpload(data []byte) {</span><span id="92ec" class="ob md it nw b gy oh od l oe of">  tmpFileName := fmt.Sprintf(`/tmp/%s`, bodyRequest.FileName)</span><span id="e484" class="ob md it nw b gy oh od l oe of">  fileErr := ioutil.WriteFile(tmpFileName, []byte(data), 0644)<br/>  <br/>  // CALL THE UPLOAD FUNCTION<br/>  UploadImage(tmpFileName)<br/>}</span></pre><p id="ebb6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在第一行，我们在位置<code class="fe nt nu nv nw b">tmp</code>指定文件。根据AWS文档，这是一个重要的步骤</p><blockquote class="lp lq lr"><p id="0b9e" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">Lambda执行环境为您的代码在/ <strong class="js iu"> tmp </strong>提供了一个文件系统。该空间的固定大小为512 MB。每次创建新的执行环境时，都会删除这个区域。</p></blockquote><p id="7556" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们使用<code class="fe nt nu nv nw b">WriteFile</code>用字节写文件</p><blockquote class="lp lq lr"><p id="14ec" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated"><strong class="js iu"> WriteFile </strong>将数据写入文件名命名的文件。如果文件不存在，WriteFile用perm权限创建它(在umask之前)；否则，WriteFile会在写入前截断它，而不更改权限。</p></blockquote><p id="91f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们已经创建了临时文件！</p><ul class=""><li id="83a1" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">现在，我们将上传文件，到自动气象站S3桶。为此，我们将使用<a class="ae kp" href="https://github.com/aws/aws-sdk-go" rel="noopener ugc nofollow" target="_blank"> AWS GO SDK </a>，如果您没有安装它，请遵循以下步骤</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="0832" class="ob md it nw b gy oc od l oe of">go get github.com/aws/aws-sdk-go</span></pre><p id="1c23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将把我们的文件传递给<a class="ae kp" href="https://github.com/AseemWangoo/golang-programs/blob/master/upload-s3/upload/upload_s3.go" rel="noopener ugc nofollow" target="_blank">上传函数</a></p><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="ae2d" class="ob md it nw b gy oc od l oe of">func uploadToS3Bucket(file io.Reader, fileName string) {</span><span id="71ac" class="ob md it nw b gy oh od l oe of"> bucketName := os.Getenv("bucket_name")<br/> region := "us-east-2"</span><span id="9f62" class="ob md it nw b gy oh od l oe of"> conf := aws.Config{Region: &amp;region}<br/> sess, _ := session.NewSession(&amp;conf)<br/> uploader := s3manager.NewUploader(sess)</span><span id="d13e" class="ob md it nw b gy oh od l oe of"> upParams := &amp;s3manager.UploadInput{<br/>   Bucket: &amp;bucketName,<br/>   Key:    &amp;fileName,<br/>   Body:   file,<br/> }</span><span id="067d" class="ob md it nw b gy oh od l oe of"> result, err := uploader.Upload(upParams)<br/>}</span></pre><ul class=""><li id="8e15" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们需要使用<code class="fe nt nu nv nw b">aws.Config</code>来指定区域。在我们的情况下，它是美国东部2。</li></ul><p id="8003" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nt nu nv nw b">session.Newsession</code>返回从SDK默认值、配置文件、环境和用户提供的配置文件创建的新会话。</p><p id="78da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nt nu nv nw b">aws-sdk-go</code>给了我们<code class="fe nt nu nv nw b">s3Manager</code>，这有助于上传文件。它吸收了</p><p id="0100" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nt nu nv nw b">Bucket</code>:你的AWS桶名，在我的例子中我从<code class="fe nt nu nv nw b">serverless.yml </code>环境变量中得到</p><p id="f5fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nt nu nv nw b">Key</code>:PUT动作启动的对象键。在我们的例子中，它是文件名。</p><p id="d6f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nt nu nv nw b">Body</code>:要发送到S3的主体有效载荷是什么。在我们的例子中，它是文件本身</p><ul class=""><li id="3f77" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">最后，使用上面的参数，我们调用<code class="fe nt nu nv nw b">Uploader.Upload</code></li><li id="cc59" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">我们将来自<code class="fe nt nu nv nw b">main.go</code>的响应返回给调用者。</li></ul></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="a04f" class="mc md it bd me mf no mh mi mj np ml mm mn nq mp mq mr nr mt mu mv ns mx my mz bi translated">使用无服务器部署lambda</h1><p id="2803" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">到目前为止，我们一直在创建我们的lambda，但现在是时候将它部署到AWS上了。</p><ul class=""><li id="aee1" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">让我们重温一下我们的<code class="fe nt nu nv nw b">serverless.yml</code>并做一些改变</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="62d7" class="ob md it nw b gy oc od l oe of">functions:<br/>  upload:<br/>    handler: bin/upload<br/>    events:<br/>      - httpApi:<br/>          path: /uploadImage<br/>          method: post</span></pre><p id="7e9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们为lambda添加了后端点<code class="fe nt nu nv nw b">uploadImage</code></p><ul class=""><li id="5374" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">接下来，因为我们在lambda内部使用S3桶，所以我们将添加一些IAMRoleStatements</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="4821" class="ob md it nw b gy oc od l oe of">custom:<br/>  s3Bucket: test-bucket--aseem<br/>  <br/>iamRoleStatements:<br/>    - Effect: Allow<br/>      Action:<br/>        - s3:*<br/>      Resource: "arn:aws:s3:::${self:custom.s3Bucket}/*"</span></pre><p id="0657" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这使用<code class="fe nt nu nv nw b">s3Bucket</code>指定了存储桶名称，并允许在该存储桶上执行操作</p><ul class=""><li id="43bc" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">最后，为了指定环境变量，我们利用</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="ee85" class="ob md it nw b gy oc od l oe of">environment:<br/>    bucket_name: test-bucket--aseem</span></pre><ul class=""><li id="e250" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们将创建一个<code class="fe nt nu nv nw b"><a class="ae kp" href="https://github.com/AseemWangoo/golang-programs/blob/master/upload-s3/Makefile" rel="noopener ugc nofollow" target="_blank">Makefile</a></code>并放置以下内容</li></ul><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="30d9" class="ob md it nw b gy oc od l oe of">.PHONY: build clean deploy</span><span id="aa65" class="ob md it nw b gy oh od l oe of">deploy: clean build<br/> sls deploy --verbose</span><span id="909c" class="ob md it nw b gy oh od l oe of">remove:<br/> sls remove</span></pre><p id="cf31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将有助于简化lambda部署，只需调用</p><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="cc05" class="ob md it nw b gy oc od l oe of">make deploy</span></pre><p id="a85b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果一切都很成功，您应该会看到类似这样的内容</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi oj"><img src="../Images/de64e42d07b51b822696b285b67a827f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2A91zXbPpcGTtomCRq4hnA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">使用无服务器部署lambda</figcaption></figure><p id="cb45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了删除lambda，我们可以调用</p><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="0b55" class="ob md it nw b gy oc od l oe of">make remove</span></pre><p id="2ad9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要测试lambda，请使用</p><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="61cb" class="ob md it nw b gy oc od l oe of">curl -X POST -H "Content-Type: application/json" \<br/>-d '{"filename": "xyz.png", "body": "BASE_64_ENCODING_OF_AN_IMAGE"}' \<br/>&lt;YOUR_LAMBDA_URL&gt;</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi ok"><img src="../Images/d0da2f0831d05a8d7a2ea06fe000441a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PuQQSVHG8Dd-GJTPivTSPw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">图片上传到S3</figcaption></figure><p id="24f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其他文章:</p><div class="ol om gp gr on oo"><a rel="noopener  ugc nofollow" target="_blank" href="/using-kafka-in-2022-f22602830e09"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">在2022年使用卡夫卡</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">在2022年使用卡夫卡</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">在2022levelup.gitconnected.com使用卡夫卡</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ma oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="https://medium.com/flutter-community/dart-on-aws-lambda-3a46aad38335" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">AWS Lambda上的Dart</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">AWS Lambda上的Dart</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">AWS Lambdamedium.com上的Dart</p></div></div><div class="ox l"><div class="pd l oz pa pb ox pc ma oo"/></div></div></a></div><div class="ol om gp gr on oo"><a rel="noopener  ugc nofollow" target="_blank" href="/deploy-react-and-aws-amplify-1db36c625d73"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">部署React和AWS Amplify</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">部署React和AWS Amplify</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">部署React和AWS Amplifylevelup.gitconnected.com</p></div></div><div class="ox l"><div class="pe l oz pa pb ox pc ma oo"/></div></div></a></div><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/fa02697cee52c44230ee832d47b13493.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*zaGfOnIotHO2v9JO.gif"/></div></figure><pre class="kq kr ks kt gt nx nw ny nz aw oa bi"><span id="62db" class="ob md it nw b gy oc od l oe of"><a class="ae kp" href="https://github.com/AseemWangoo/golang-programs/tree/master/upload-s3" rel="noopener ugc nofollow" target="_blank">Source Code</a></span></pre></div></div>    
</body>
</html>