<html>
<head>
<title>Python and Linux I/O Redirection for Managing Investments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于管理投资的Python和Linux I/O重定向</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-and-linux-i-o-redirection-for-managing-investments-ef009be30f39?source=collection_archive---------16-----------------------#2020-11-30">https://levelup.gitconnected.com/python-and-linux-i-o-redirection-for-managing-investments-ef009be30f39?source=collection_archive---------16-----------------------#2020-11-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="82e2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用谷歌云平台(GCP)上的Linux虚拟机获得每日投资结果表</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a160928de34b695d2c5c8be8ce3d50f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LHIZT3F_VExjB39T"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Emile Perron 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将看到如何在Linux虚拟机上存储一个文件，该文件包含最初在Google Sheets上提供的股票列表的每日结果。</p><p id="525d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个人都认识一个朋友，他/她也在抱怨，他/她需要关注他们的银行或投资经纪平台，以便全天跟踪他们的金融投资结果。</p><p id="68c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，每个人都想知道自己的钱是怎么回事。然而，在这篇文章中，我们将探索一种方法来轻松跟踪您的投资的当前表现，并在一天结束时生成它们的每日视图。</p><p id="e0e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，你可以随心所欲地个性化一切。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="6e95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我之前关于Medium的文章中，我探索了谷歌云平台(GCP)上可用的<a class="ae ky" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">计算引擎服务</a>的一部分。在这篇提到的文章中，我在一个Linux虚拟机上部署了一个Python脚本，它有一个链接，链接到我自己的个人Google Sheets上的一些数据。</p><p id="3d0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上一篇文章是继续本文的基本条件，因为它解释了如何设置整个环境，以便能够访问和处理所有相关数据。在这个意义上，我强烈邀请你去看看。</p><div class="mc md gp gr me mf"><a href="https://towardsdatascience.com/this-virtual-machine-is-saving-my-time-23076f592b94" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">这个虚拟机节省了我的时间</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">在Google云平台之上的Linux虚拟机中部署您的Python脚本，以便与您的……</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">towardsdatascience.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt ks mf"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="640f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在最初的简报之后，让我列举一下我们将要讨论的主题:</p><ol class=""><li id="0aec" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">环境设置</li><li id="d01c" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">谷歌工作表数据</li><li id="1343" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">Linux文件结构</li><li id="e9fb" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">Linux调度服务</li><li id="298b" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">Python文件</li><li id="6055" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">最后的想法</li></ol><p id="d3b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事不宜迟，让我们最后看看我们在这里得到了什么。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b75f" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">1.环境设置</h1><p id="eb16" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">如前所述，让我们在前进之前先弄清楚需要采取哪些行动:</p><ol class=""><li id="7217" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">启用对Google工作表的访问</li><li id="cc0e" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">在GCP上实例化您的Linux虚拟机</li><li id="42cc" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">在Linux虚拟机上安装Python</li></ol><p id="5a4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些都是需要完成的主要步骤。都可以在之前通知的帖子上查到。</p><p id="940b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="of">同样重要的是要提到，虽然这些步骤据说是继续本文所必需的，但是如果你喜欢使用本地安装的Linux VM和Microsoft Excel(而不是使用GCP和Google Sheets ),你至少可以从理解Python和Linux的关系中受益。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fc44" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">2.谷歌工作表数据</h1><p id="c0b6" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">您可能已经注意到，我在这里准备了一个与上一篇文章中的表格非常相似的表格。考虑到列出的所有代码和一些列名，有一些小的变化:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/e179640e307843e5e7515b0a5628671d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1RSTHZ__y8IKg3uhrqhcQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Google Sheets的数据(11月23日上午10点)</figcaption></figure><p id="fcbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只是为了强调一下，“价格”是指当前的股票价格。这与“账面价格”相比较，账面价格是股票被买入的价格。</p><p id="abc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“Stock”列包含本例中所有的报价机。你愿意为你考虑的每一个报价机都应该有一行。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e498" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">3.Linux文件结构</h1><p id="dbea" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">所有这些文件在我们的虚拟机中是如何构建的？下面，我从我的CLI拍摄了一个快照，在“pythonScript”目录下运行<code class="fe oh oi oj ok b">tree</code>命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="1559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以注意到有4个<code class="fe oh oi oj ok b">py</code>文件和1个<code class="fe oh oi oj ok b">json</code>文件。</p><p id="578e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oh oi oj ok b">py</code>文件将在接下来的会话中描述。<code class="fe oh oi oj ok b">json</code>文件是一个包含Google Sheets API认证和授权过程所需的Google凭证的文件。您可以注意到，<code class="fe oh oi oj ok b">json</code>文件是文件“15m_script.py”(会话5)上的python脚本的一部分。</p><p id="4c5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我创建了一个名为“log”的目录，只是为了拆分由“main one”(“15m _ script . py”)生成的文件。这不是强制性的，只是确保相应地调整文件的路径。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3758" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">4.Linux调度服务</h1><p id="c5ca" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">下图考虑了分析中涉及的所有Python脚本文件及其相互关系:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/51db810e34159b3e803e611ef44a6c2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*_pSpfD1MMFvnPzpCAu1eKw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Python文件I/O重定向关系</figcaption></figure><p id="d63b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在描述Linux服务时间表本身之前，让我们先了解一下每个目标:</p><ul class=""><li id="0f95" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu oo na nb nc bi translated">“15m_script.py”是每15分钟运行一次的脚本，用于更新Google Sheets表</li><li id="d14f" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated">“result_script.py”是股票市场收盘后运行的脚本，用于考虑股票每天的收盘价。“15m_output.py”也用作“result_script.py”的输入</li></ul><p id="4b4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了达到提到的频率，我们将使用<code class="fe oh oi oj ok b">cron</code> job Linux服务。键入<code class="fe oh oi oj ok b">crontab -e</code>，您将看到类似于以下内容的内容(直到第25行，如果您没有用户的crontab作业):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="cf53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将3个预定的<code class="fe oh oi oj ok b">cron</code>任务分开:</p><ol class=""><li id="4b76" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">第28行:</li></ol><ul class=""><li id="c9e5" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">*/15 10–17 * * MON-FRI</code>:调度规则；</li><li id="ca75" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/usr/bin/python3.7</code> : python解释器位置；</li><li id="6bbd" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/home/lucasnunesfe9/pythonScript/15m_script.py</code>:。py文件位置</li></ul><p id="0d9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.第31行:</p><ul class=""><li id="553c" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">00 18 * * MON-FRI</code>:与先验定义相同；</li><li id="9ecd" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/usr/bin/python3.7</code>:与先验定义相同；</li><li id="f8d6" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/home/lucasnunesfe9/pythonScript/15m_script.py</code>:与先验定义相同；</li><li id="3a75" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">&gt;</code>:标准输出语句(指示系统发送“15m_script.py”到“15m _ output . py”)；</li><li id="aff0" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/home/lucasnunesfe9/pythonScript/log/15m_output.py</code>:。输出文件位置。</li></ul><p id="3037" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.第34行:</p><ul class=""><li id="865e" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">05 18 * * MON-FRI</code>:与先验定义相同；</li><li id="47f2" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/usr/bin/python3.7</code>:与先验的定义相同；</li><li id="829e" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/home/lucasnunesfe9/pythonScript/log/result_script.py</code>:与先验定义相同；</li><li id="8690" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/home/lucasnunesfe9/pythonScript/log/15m_output.py</code>:“15m _ output”正被用作“result_script.py”的输入；</li><li id="6b25" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">&gt;</code>:与先验定义相同；</li><li id="516d" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated"><code class="fe oh oi oj ok b">/home/lucasnunesfe9/pythonScript/log/result_output.py</code>:与先验定义相同。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3360" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">5.Python文件</h1><p id="0e6b" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">让我们深入了解一下每个Python文件的作用。</p><h2 id="0564" class="op nj it bd nk oq or dn no os ot dp ns li ou ov nu lm ow ox nw lq oy oz ny pa bi translated">15m(分钟)文件:</h2><ul class=""><li id="e9ff" class="mu mv it lb b lc oa lf ob li pb lm pc lq pd lu oo na nb nc bi translated">“15m_script.py”脚本的主要目标是为“股票”列中列出的每个报价器更新“价格”列。为了实现这一点，脚本将根据<a class="ae ky" href="https://www.google.com/finance/" rel="noopener ugc nofollow" target="_blank"> Google Finance </a> API语法编写一个字符串。这个字符串为我们提供了每个股票的当前价格:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="6221" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="of">*这段代码已经写在知情的上一篇帖子里了。我在这里做了一些改动，主要是将脚本结构从函数式的改为面向对象的。</em></p><ul class=""><li id="7f59" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu oo na nb nc bi translated">“15m_output.py”是一个打印声明，包括:脚本运行的时间(<code class="fe oh oi oj ok b">dt_string</code>)、报价机列表(<code class="fe oh oi oj ok b">ticker_list</code>)及其当前价格(<code class="fe oh oi oj ok b">value_list</code>)。让我们使用Linux的<code class="fe oh oi oj ok b">cat</code>命令来检查“15m_output.py”内容:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h2 id="a600" class="op nj it bd nk oq or dn no os ot dp ns li ou ov nu lm ow ox nw lq oy oz ny pa bi translated">结果文件:</h2><ul class=""><li id="f172" class="mu mv it lb b lc oa lf ob li pb lm pc lq pd lu oo na nb nc bi translated">“result_script.py”脚本的主要目标是使其报价器与其当前价格相匹配，这两个价格都存储在“15m_output.py”中，同时添加标题和总行数:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><ul class=""><li id="a6b6" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu oo na nb nc bi translated">“result_output.py”是包含我们的<strong class="lb iu">想要的</strong> <strong class="lb iu">结果</strong>的打印语句。一个包含所有报价机及其收盘价格的表格。让我们再次使用Linux的<code class="fe oh oi oj ok b">cat</code>命令来检查“15m_output.py”内容:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7201" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">6.最后的想法</h1><p id="c7eb" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">我们已经设法制定了一个定期的Linux时间表，给你一个每日投资结果的摘要。</p><p id="9268" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一成果主要用于考虑两种情况。想象一下…</p><ul class=""><li id="6bf9" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu oo na nb nc bi translated">…您需要处理多个用户的投资数据。通过设置像这样的循环机制，您可以轻松地生成他们的每个信息并与他们共享。</li><li id="8723" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu oo na nb nc bi translated">…您需要以历史的方式汇总每天的结果。因为您已经生成了一个包含每天结果的文件，所以您可以设法附加每天结果的数据，以便对它们进行比较，然后将合并的结果与一些投资的基准进行比较。</li></ul><p id="37b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这里提供的示例并不是万能的解决方案，但是，它可以为您通过管理一些计算资源来开始处理数据铺平道路，而不依赖于一些银行或投资经纪人服务来管理您的财务数据。</p></div></div>    
</body>
</html>