<html>
<head>
<title>Tip for Swift: from async to sync in function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift提示:在功能上从异步到同步</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tip-for-swift-from-async-to-sync-in-function-1-c1337f0d60b3?source=collection_archive---------1-----------------------#2021-10-01">https://levelup.gitconnected.com/tip-for-swift-from-async-to-sync-in-function-1-c1337f0d60b3?source=collection_archive---------1-----------------------#2021-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e97d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我之前的故事<a class="ae ko" href="https://medium.com/@zhuyp/12-tips-to-make-swift-more-concise-4f4ed63f3063" rel="noopener"> <strong class="js iu"> 12个让Swift少代码的小技巧</strong> </a>一直受到开发者的喜爱，不断鼓励我分享更多的经验。这个故事是关于多任务的，我期待着帮助开发人员。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/ff14a99ef5554575f01c45a6c2a4dda6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VsqDeLM1PyUDsEHjBYHlJg.jpeg"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">苹果公司</figcaption></figure><p id="10bc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="lf">问:如何实现多个异步任务之间的同步？</em></p><p id="6032" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，我们有一个登录任务。此任务需要3个异步子任务，它们之间有一个序列。任务2将在任务1成功后执行，任务3将在任务2成功后执行，登录操作将在三个子任务全部成功执行后完成。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h1 id="0c0b" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated"><strong class="ak">第一部分</strong></h1><p id="37f6" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">在早期，我通常这样做:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">使用块</figcaption></figure><p id="b8aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然做到了以上要求，但是会带来一个问题，就是代码难读，以至于后期很难排错。想象一下，未来会有更多的异步方法需要同步，这是一场灾难。我们可以在上面的代码片段中看到被称为<strong class="js iu">末日金字塔</strong>的可怕东西，这是我们作为开发者不喜欢做/看到的事情。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h1 id="2fba" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">第二部分</h1><p id="1181" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">是的，代码应该是为人类写的，而不是机器。</p><p id="0b71" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以我们可以:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">使用调度信号量</figcaption></figure><p id="16d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如您所见，这将减少代码。<strong class="js iu">使用<em class="lf">调度信号量</em>阻塞异步操作实现同步</strong>。请注意，不要在主队列中直接调用这些方法，否则您的应用程序将不会响应UI的事件。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h1 id="9c9b" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">较好的</h1><p id="f5c8" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">上面的代码确实变得更容易阅读，但是功能还不够强大。例如，如果您需要显示确切的错误信息。从上面来看，方法只返回一个Bool类型的值，显然不能满足需求。</p><p id="0dc7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以使用异常抛出。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mq mr l"/></div></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h1 id="78eb" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">请跟我来。让我们在接下来的帖子中见面。</h1><p id="d98b" class="pw-post-body-paragraph jq jr it js b jt ml jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn im bi translated">以前的故事:</p><ol class=""><li id="7613" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn mx my mz na bi translated"><a class="ae ko" href="https://medium.com/@zhuyp/uicollectionview-an-error-that-often-occurs-a494ca70fc4b" rel="noopener"> <strong class="js iu"> UICollectionView:经常出现的错误</strong> </a></li><li id="9bde" class="ms mt it js b jt nb jx nc kb nd kf ne kj nf kn mx my mz na bi translated"><a class="ae ko" href="https://medium.com/@zhuyp/12-tips-to-make-swift-more-concise-4f4ed63f3063" rel="noopener"> <strong class="js iu"> 12招使迅捷少码</strong> </a></li><li id="7603" class="ms mt it js b jt nb jx nc kb nd kf ne kj nf kn mx my mz na bi translated"><a class="ae ko" href="https://medium.com/@zhuyp/ios-or-ios-7c7d23905c35" rel="noopener"> <strong class="js iu"> IOS还是IOS？</strong>T25】</a></li></ol><blockquote class="ng nh ni"><p id="06ee" class="jq jr lf js b jt ju jv jw jx jy jz ka nj kc kd ke nk kg kh ki nl kk kl km kn im bi translated"><strong class="js iu"> <em class="it">关于我:</em> </strong> <em class="it"> <br/> </em>我是iOS的开发者，曾经在XAG工作。现在我想在medium上分享故事，总结自己的经验来帮助别人。如果你有任何问题，请给我反馈，我会积极给你我的答复。目前，我的期望是获得100名追随者。需要你的善意支持，谢谢。</p></blockquote></div></div>    
</body>
</html>