<html>
<head>
<title>Manage Go Dependencies with Go Dep within Docker and VS Code Remote-Containers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Docker和VS代码远程容器中的Go Dep管理Go依赖关系</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/manage-go-dependencies-with-dep-within-docker-and-vscode-remote-containers-cc0fedd627f2?source=collection_archive---------4-----------------------#2019-09-09">https://levelup.gitconnected.com/manage-go-dependencies-with-dep-within-docker-and-vscode-remote-containers-cc0fedd627f2?source=collection_archive---------4-----------------------#2019-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/4788c8e31bc4a864596aabe4a8a09688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7xQqlWxFzC0kkh7ObbAijg.png"/></div></div></figure><h2 id="54ee" class="iz ja jb bd b dl jc jd je jf jg jh dk ji translated" aria-label="kicker paragraph"><a class="ae ep" rel="noopener ugc nofollow" target="_blank" href="/go-restful-series-a7addbfef5b1">安息吧</a> — #4</h2><div class=""/><p id="5e88" class="pw-post-body-paragraph kh ki jb kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">有了一个全时本地质量的VSCode驱动的容器化开发环境，在本文中，我将建立一个Go依赖管理机制，它可以与现有技术、Docker和VS Code远程容器很好地集成。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="1842" class="ln lo jb bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">依赖性管理</h1><p id="3551" class="pw-post-body-paragraph kh ki jb kj b kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le ij bi translated">使用开源或第三方组件可以节省数月或数年的开发时间。然而，由于依赖于外部包，您必须控制是否将一些包升级到较新的版本以修复安全问题，或者将它们锁定在某个版本以避免不兼容。第三方组件也有其依赖性，这确实会让您在管理它们时遇到麻烦。</p><p id="b9e7" class="pw-post-body-paragraph kh ki jb kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">因此，现代编程语言通常会有一个依赖管理工具来帮助解决上述问题，例如Javascript有<code class="fe mq mr ms mt b">npm</code>或<code class="fe mq mr ms mt b">yarn</code>。我在围棋中寻找类似的东西。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="7f53" class="ln lo jb bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">go-dep —“官方实验”go依赖管理</h1><p id="1bcd" class="pw-post-body-paragraph kh ki jb kj b kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le ij bi translated">幸运的是，谷歌正在开发和试验<code class="fe mq mr ms mt b">go-dep</code>作为他们官方的依赖管理工具。虽然是实验性的，<code class="fe mq mr ms mt b">go-dep</code>很稳定。</p><p id="0203" class="pw-post-body-paragraph kh ki jb kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">简而言之，<code class="fe mq mr ms mt b">go-dep</code>是在<code class="fe mq mr ms mt b">Go</code>中实现的，所以您可以使用<code class="fe mq mr ms mt b">go get</code>命令轻松安装它。作为依赖管理工具，<code class="fe mq mr ms mt b">go-dep</code>帮助开发者解决典型的依赖管理用例:</p><ul class=""><li id="49db" class="mu mv jb kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated">自动检测依赖关系图并获取适当的依赖关系。</li><li id="7cd7" class="mu mv jb kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">自动锁定依赖项的版本，以生成可重现的版本。</li><li id="349a" class="mu mv jb kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">允许开发人员升级和降级依赖项的版本，并自动重新生成锁。</li></ul><p id="0561" class="pw-post-body-paragraph kh ki jb kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">如何使用<code class="fe mq mr ms mt b">go-dep</code>超出了本文的范围。更多详情请参考其<a class="ae lf" href="https://golang.github.io/dep/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="d26d" class="ln lo jb bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">将go-dep安装到开发容器</h1><p id="8418" class="pw-post-body-paragraph kh ki jb kj b kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le ij bi translated">决定使用<code class="fe mq mr ms mt b">go-dep</code>，我将它预安装到开发映像中。很简单，我只是在当前的<code class="fe mq mr ms mt b">Dockerfile</code>上加上<code class="fe mq mr ms mt b">go get github.com/golang/dep/cmd/dep</code>。</p><figure class="ni nj nk nl gt is"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="53b7" class="ln lo jb bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">用go-dep初始化项目</h1><p id="fa63" class="pw-post-body-paragraph kh ki jb kj b kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le ij bi translated">要开始使用<code class="fe mq mr ms mt b">go-dep</code>，我必须用一些必需的文件预填充项目。幸运的是，<code class="fe mq mr ms mt b">go-dep</code>实现了一个有助于做到这一点的命令。</p><pre class="ni nj nk nl gt no mt np nq aw nr bi"><span id="46dd" class="ns lo jb mt b gy nt nu l nv nw">dep init</span></pre><p id="3003" class="pw-post-body-paragraph kh ki jb kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在项目的根目录下运行上述命令将创建两个新文件<code class="fe mq mr ms mt b">Gopkg.toml</code>和<code class="fe mq mr ms mt b">Gopkg.lock</code>，其中包含一些初始内容。这已经足够好了，我正在将它们提交到存储库中。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="7746" class="ln lo jb bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">更新VS代码. devcontainer.json</h1><p id="54bc" class="pw-post-body-paragraph kh ki jb kj b kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le ij bi translated">接下来，我将更新<code class="fe mq mr ms mt b">.devcontainer.json</code>以便在开发容器启动后运行<code class="fe mq mr ms mt b">dep ensure</code>，这样当我第一次打开它时，项目的所有依赖项都将被正确地预填充。我只是把<code class="fe mq mr ms mt b">"postCreateCommand": "dep ensure"</code>加到<code class="fe mq mr ms mt b">.devcontainer.json</code>上。</p><figure class="ni nj nk nl gt is"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="befc" class="pw-post-body-paragraph kh ki jb kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">还有另外两个重要的更新字段，<code class="fe mq mr ms mt b">workspaceMount</code>和<code class="fe mq mr ms mt b">workspaceFolder</code>。默认情况下，VS代码将在默认工作区目录<code class="fe mq mr ms mt b">/root/workspaces/go-restful</code>中发出<code class="fe mq mr ms mt b">postCreateCommand</code>，这不是一个带有<code class="fe mq mr ms mt b">go-dep</code>的有效位置，它必须在<code class="fe mq mr ms mt b">$GOPATH</code> ( <code class="fe mq mr ms mt b">/go</code>)内。所以我也必须适当地更改这些字段。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="41ec" class="ln lo jb bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">更新。gitignore和VC代码配置</h1><p id="63d8" class="pw-post-body-paragraph kh ki jb kj b kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le ij bi translated">添加<code class="fe mq mr ms mt b">go-dep</code>引入了一些应该从Git或VS代码中忽略的新组件:</p><ul class=""><li id="7411" class="mu mv jb kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated"><code class="fe mq mr ms mt b">Gopkg.lock</code>是自动生成的锁定文件，不得手动编辑。我从VS代码里忽略了。</li><li id="0af0" class="mu mv jb kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><code class="fe mq mr ms mt b">vendor</code>目录存储依赖关系。我从VS代码和<code class="fe mq mr ms mt b">.gitignore</code>两方面都忽略了。</li></ul><pre class="ni nj nk nl gt no mt np nq aw nr bi"><span id="ef3e" class="ns lo jb mt b gy nt nu l nv nw"><em class="nx"># .vscode/settings.json</em><br/>{<br/>   "files.exclude": {<br/>      ... others,<br/>     "Gopkg.lock": <strong class="mt jl">true</strong>,<br/>     "vendor": <strong class="mt jl">true</strong><br/>}</span><span id="b87b" class="ns lo jb mt b gy ny nu l nv nw"><br/><em class="nx"># .gitignore</em><br/>... others<br/>vendor/</span></pre></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="4c40" class="ln lo jb bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">我可以走了！</h1><p id="c607" class="pw-post-body-paragraph kh ki jb kj b kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le ij bi translated">现在，与开发环境相关的一切看起来都足够好了。关于一些初始实现，下次再见。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="ec10" class="pw-post-body-paragraph kh ki jb kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">本文的完整源代码发布在<a class="ae lf" href="https://github.com/the-evengers/go-restful/tree/41b3172af912a36643f9b578bdcf242fccabccf6" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div></div>    
</body>
</html>