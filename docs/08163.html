<html>
<head>
<title>Predicting House Sale Prices using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习预测房屋销售价格</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/predicting-house-sale-prices-using-ml-30b829fd9556?source=collection_archive---------10-----------------------#2021-04-06">https://levelup.gitconnected.com/predicting-house-sale-prices-using-ml-30b829fd9556?source=collection_archive---------10-----------------------#2021-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7d93" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用机器学习预测房屋销售价格的数据科学方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eaba924b5be1208fa07a94c46587361b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YT7GW1WWlP7MGFvDK0hjCQ.jpeg"/></div></div></figure><p id="4d30" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我通过退休一直在哥伦比亚工程学习<a class="ae lq" href="https://online-exec.cvn.columbia.edu/applied-machine-learning" rel="noopener ugc nofollow" target="_blank">应用机器学习</a>。这是一个为期5个月的课程，我真的很喜欢，并会推荐。</p><p id="e9df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">教练都很好，很有帮助，尤其是罗伯特·曼里克兹和普内特·萨拉斯瓦特。他们举办“办公时间”网络研讨会，帮助完成复杂的作业，同时也提供我们所学内容的实际演练。</p><p id="8d73" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有一个很棒的数据科学和机器学习资源叫做<a class="ae lq" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>。他们为数据科学家提供免费的数据集进行实践。还有比较机器学习的分析和建模的比赛。</p><p id="3365" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在一些“办公时间”网络研讨会中，Robert向我们介绍了“<a class="ae lq" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">房价—高级回归技术</a>”数据集。目标是预测爱荷华州埃姆斯市的房屋销售价格。</p><p id="3128" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将提供数据科学和机器学习的实用介绍，而不是深入幕后的数学(数学很复杂！).虽然这些名字听起来很花哨，但实际上它们分别是统计学家和统计学的现代名称。我们不要在这里自欺欺人，这主要是复杂的数学。</p><h2 id="33e5" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">步骤1:确定项目范围</h2><p id="453b" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">这个项目的目标是确定爱荷华州埃姆斯市的房屋销售价格。那将是我们的"<strong class="kw iu">决定因素</strong>"变量(我们正试图预测的)。我们将使用一个或多个"<strong class="kw iu">不确定的</strong>变量或"<strong class="kw iu">特性</strong>is输入。</p><p id="c6a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">理解我们的数据很重要。除了实际数据，Kaggle还提供了数据集的描述。这对于分析和特征工程来说肯定会派上用场。</p><h2 id="e251" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">数据字段</h2><ul class=""><li id="227c" class="mp mq it kw b kx mk la ml ld mr lh ms ll mt lp mu mv mw mx bi translated"><strong class="kw iu">销售价格</strong> —以美元计算的房产销售价格。这是你试图预测的目标变量。</li><li id="168f" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> MSSubClass </strong>:建筑类</li><li id="971b" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> MSZoning </strong>:通用分区分类</li><li id="5c4c" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">地段临街面</strong>:与物业相连的街道的直线英尺</li><li id="eb4e" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> LotArea </strong>:以平方英尺为单位的批量</li><li id="681c" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">街道</strong>:道路通道类型</li><li id="f46b" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">小巷</strong>:小巷通道类型</li><li id="3bd0" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> LotShape </strong>:物业的大致形状</li><li id="a646" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">土地等高线</strong>:房产的平整度</li><li id="92fe" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">实用程序</strong>:可用的实用程序类型</li><li id="98a1" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> LotConfig </strong>:批次配置</li><li id="32da" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">陆坡</strong>:房产的坡度</li><li id="15c1" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">街区</strong>:艾姆斯城范围内的物理位置</li><li id="8e1c" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">靠近主干道或铁路</li><li id="11d1" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">条件2 :靠近主干道或铁路(如果有第二条)</li><li id="104d" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">建筑类型</strong>:住宅类型</li><li id="4820" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">住宅风格</strong>:居住风格</li><li id="1ffd" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">整体质量</strong>:整体材料和表面质量</li><li id="4d3e" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">总体条件</strong>:总体条件评级</li><li id="34b0" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">建造年份</strong>:原建造日期</li><li id="2c39" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">年改装日期:改装日期</li><li id="b94d" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">屋顶样式</strong>:屋顶的类型</li><li id="9e77" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">屋顶材料</strong>:屋顶材料</li><li id="601e" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">外部第一层</strong>:房屋外部覆盖物</li><li id="170b" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">外部第二层</strong>:房屋外部覆盖物(如果不止一种材料)</li><li id="3970" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> MasVnrType </strong>:圬工贴面类型</li><li id="a8ba" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">MasVnrArea :以平方英尺为单位的砌体饰面面积</li><li id="0bba" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">外观质量</strong>:外观材质</li><li id="e7be" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">外部</strong>:外部材料的现状</li><li id="48f0" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">基础</strong>:基础类型</li><li id="c5ff" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> BsmtQual </strong>:地下室的高度</li><li id="334d" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">第二次</strong>:地下室概况</li><li id="bd16" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> BsmtExposure </strong>:步行或花园水平地下室墙</li><li id="85a9" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> BsmtFinType1 </strong>:地下室完工面积质量</li><li id="d177" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">bsmtfinsf 1</strong>:1型成品平方英尺</li><li id="2bd9" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> BsmtFinType2 </strong>:第二个完工区域的质量(如果存在)</li><li id="991d" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">bsmtfinsf 2:2型成品平方英尺</li><li id="127c" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">BsmtUnfSF :未完工的地下室面积平方英尺</li><li id="7d51" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">TotalBsmtSF :地下室总面积平方英尺</li><li id="5147" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">加热</strong>:加热类型</li><li id="1c33" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">加热QC </strong>:加热质量和条件</li><li id="b2d8" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">中央空调</strong>:中央空调</li><li id="6ca7" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">电气</strong>:电气系统</li><li id="6fae" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">第一层平方英尺</li><li id="7e80" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">2ndFlrSF :二楼平方英尺</li><li id="c222" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">低质量成品平方英尺(所有楼层)</li><li id="a39a" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">GrLivArea :地面以上居住面积平方英尺</li><li id="1fa6" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">BsmtFullBath :地下室全浴室</li><li id="dee2" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">bsmt半浴室:地下室半浴室</li><li id="bf10" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">全浴室:地面以上的全浴室</li><li id="6553" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">半浴室</strong>:地面以上的半浴室</li><li id="3e1c" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">卧室</strong>:地下室层以上的卧室数量</li><li id="275f" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">厨房</strong>:厨房数量</li><li id="b4cc" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">厨房质量</strong></li><li id="0fd8" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> TotRmsAbvGrd </strong>:地上客房总数(不包括卫生间)</li><li id="e40f" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">功能</strong>:家庭功能评级</li><li id="37d5" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">壁炉</strong>:壁炉数量</li><li id="4db4" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">壁炉质量</strong></li><li id="e661" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">车库类型</strong>:车库位置</li><li id="7e1b" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">车库建造年份</strong></li><li id="1d87" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">车库饰面</strong>:车库内部饰面</li><li id="64c3" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> GarageCars </strong>:车库容量的大小</li><li id="6d70" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">车库面积:车库的面积，平方英尺</li><li id="0910" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> GarageQual </strong>:车库质量</li><li id="e1c6" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">车库状态</strong>:车库状态</li><li id="f077" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">铺装车道</strong>:铺装车道</li><li id="f77b" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">木材甲板面积(平方英尺)</li><li id="5b6d" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> OpenPorchSF </strong>:以平方英尺为单位的开放门廊面积</li><li id="84ac" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">封闭门廊</strong>:封闭门廊面积，平方英尺</li><li id="8932" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">三季门廊面积(平方英尺)</li><li id="a2f8" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">屏风帐</strong>:屏风帐面积平方英尺</li><li id="f47e" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">池面积:以平方英尺为单位的池面积</li><li id="b5db" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">池QC </strong>:池质量</li><li id="f45f" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">栅栏</strong>:栅栏质量</li><li id="0c70" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">杂项</strong>:不包含在其他类别中的杂项</li><li id="f120" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">误算</strong>:其他特性的$值</li><li id="b28f" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">售出</strong>:月售出</li><li id="6d41" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">售出年份</strong>:售出年份</li><li id="1ea0" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu">销售类型</strong>:销售类型</li><li id="98f1" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">销售条件:销售条件</li></ul><p id="1355" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将不同于我以前的文章:</p><div class="nd ne gp gr nf ng"><a href="https://medium.com/analytics-vidhya/predicting-titanic-survivors-using-ml-8570ef4e89e8" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd iu gy z fp nl fr fs nm fu fw is bi translated">用最大似然法预测泰坦尼克号幸存者</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">我通过荣誉退休一直在哥伦比亚工程学习应用机器学习。这是一个5个月的课程，我…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu ks ng"/></div></div></a></div><p id="fa03" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">…在泰坦尼克号数据集上，我们试图预测谁幸存了下来，并且有一个布尔输出(1或0)。有了这个数据集，我们将尝试尽可能精确地估计数字销售价格。泰坦尼克号数据集也只有11个特征，而爱荷华州的艾姆斯数据集有80个。我们将需要使用技术来挑选出最相关的功能，因为80太多了。关于如何做到这一点，我将提供三个不同的选项。</p><h2 id="673a" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">第二步:收集数据</h2><p id="faa5" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">在这种特殊情况下，这是非常容易的。Kaggle上已经提供给我们了，所以你只需要下载文件。我们将大部分使用“<strong class="kw iu"> train.csv </strong>”进行工作。</p><h2 id="ce13" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">步骤3:清理数据</h2><p id="a363" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">第一步是加载我们的数据。我正在使用Python 3(带有<strong class="kw iu"> pandas </strong>、<strong class="kw iu"> numpy </strong>、<strong class="kw iu"> seaborn </strong>、<strong class="kw iu"> matplotlib </strong>和<strong class="kw iu"> sklearn </strong>库)和Jupyter notebooks "<strong class="kw iu">jupyterlab</strong>"如果你想继续的话。</p><p id="0b61" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">加载必要的库。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="711e" class="lr ls it nw b gy oa ob l oc od">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt</span></pre><p id="bc29" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Jupyter笔记本电脑的定制。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="a1f6" class="lr ls it nw b gy oa ob l oc od">%matplotlib inline</span><span id="97a1" class="lr ls it nw b gy oe ob l oc od">plt.rc('xtick', labelsize=15)     <br/>plt.rc('ytick', labelsize=15)<br/>plt.rc('axes', titlesize=16)</span><span id="1543" class="lr ls it nw b gy oe ob l oc od">sns.set_style('darkgrid')</span><span id="d78b" class="lr ls it nw b gy oe ob l oc od">pd.set_option("max.columns", 100)<br/>pd.set_option("display.max_rows", 100)</span></pre><p id="8a7b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从Kaggle加载我们的"<strong class="kw iu"> train.csv </strong>"和"<strong class="kw iu"> test.csv </strong>"数据集。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="c866" class="lr ls it nw b gy oa ob l oc od">train = pd.read_csv('./train.csv')<br/>test = pd.read_csv('./test.csv')</span></pre><p id="26d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们看看数据集的形状。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="8a8f" class="lr ls it nw b gy oa ob l oc od">train.shape, test.shape<br/>((1460, 81), (1459, 80))</span></pre><p id="1069" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">“<strong class="kw iu">训练</strong>数据集具有1460行和81列/特征。这包括我们将要预测的"<strong class="kw iu">确定性</strong>"可变"<strong class="kw iu">销售价格</strong>。“<strong class="kw iu">测试</strong>数据集有1459行和80列/特征。这是我们的数据集，没有我们的“<strong class="kw iu">销售价格</strong>”功能。看起来<strong class="kw iu">训练/测试</strong>的比例大致是<strong class="kw iu">50%</strong>。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="b422" class="lr ls it nw b gy oa ob l oc od">train.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/fcb28e276288ca889431ef96a312bcc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RgCDHGC6OH5IdjCQ1G2gMw.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="a84c" class="lr ls it nw b gy oa ob l oc od">train.dtypes</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/524c0f054818ade98bd813270eac6cf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*5bKP4nwumQsP4HlBpaZnPw.png"/></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="3fa7" class="lr ls it nw b gy oa ob l oc od">train.isnull().sum()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/ba46b95b597c041ac4d12d8e09857786.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*mv0y-S__0KnVF14SLEjWJA.png"/></div></figure><p id="10d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们只能处理数值。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="08a5" class="lr ls it nw b gy oa ob l oc od">train._get_numeric_data().shape, test._get_numeric_data().shape<br/>((1460, 38), (1459, 37))</span></pre><p id="1235" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有几种方法可以降低维数(减少特征/列的数量)。一种方法是提取数据集中前6个相关要素。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="f62a" class="lr ls it nw b gy oa ob l oc od">top_6_w_target = train.corr()['SalePrice'].sort_values(ascending = False).keys()[0:7]</span><span id="5a2a" class="lr ls it nw b gy oe ob l oc od">print(top_6_w_target)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/b367b554dfe2f9bfa5b94e5ddca474dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fdssaE9yKzo3qmwyoxUu6g.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="e151" class="lr ls it nw b gy oa ob l oc od">top_6_df = train.loc[:, top_6_w_target].copy()</span><span id="5e56" class="lr ls it nw b gy oe ob l oc od">top_6_df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/469a6fce16d24e0d027eb24cfbd6e768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cm2SpQPbyemhnrMSscQb0g.png"/></div></div></figure><h2 id="b99f" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">步骤4:探索性数据分析(EDA)</h2><p id="ab9c" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">现在我们的数据已经清理干净，我们可以尝试闪烁一些见解。我们还有38个功能，还是太多了。让我们看看有多少特性与“销售价格”有很高的相关性。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="286d" class="lr ls it nw b gy oa ob l oc od">train.corr()['SalePrice'].sort_values(ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/7bd51c008261d28abc30e1799ace0f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*8hqnC4Y6qLH4SbY2-WV6QA.png"/></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="52f6" class="lr ls it nw b gy oa ob l oc od">plt.figure(figsize = (12,10))<br/>train.corr()['SalePrice'].sort_values(ascending=True).plot(kind='barh')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/a349b7d22b83baac6d7779e6efe4f6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WgPvpWNykRq81kQ0fuZh8g.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="a69c" class="lr ls it nw b gy oa ob l oc od">sns.pairplot(top_6_df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/a27720463425809225340b85d147d1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z6Hm_toWASr0MmjUYif3uQ.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="491d" class="lr ls it nw b gy oa ob l oc od">top_6_df['SalePrice'].hist(bins=40)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/b0a18eefa8eacac0dadc9ef6b8bd1b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dW6CjLQExzOy95WXVzoPEg.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="ae20" class="lr ls it nw b gy oa ob l oc od">top_6_df.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/b3b78718db6ced43d6b214482fd63558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9d4NE5_RXqt6jBVM0QWtpg.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="f0ba" class="lr ls it nw b gy oa ob l oc od">sns.regplot(data=train, x='OverallQual', y='SalePrice')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/06fd6de421b45ea4a31e9c052171c46b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0V6iwzA-Y2-fA73es6rlA.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="f4ce" class="lr ls it nw b gy oa ob l oc od">top_6_df['GrLivArea'].hist(bins=30)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/d92d87144379a63903718186c0b4330d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D05O3yByJlb4z_KLCisw-Q.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="2412" class="lr ls it nw b gy oa ob l oc od">sns.regplot(data=train, x='GrLivArea', y='SalePrice')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/e8e67ea447464c650d5f559dd360568d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfjdICV1kYKEvLnAuN1GVA.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="7f88" class="lr ls it nw b gy oa ob l oc od">top_6_df['GarageCars'].hist(bins=4)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/e9d11eb55cc1196d116021caa48eede3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H67xzAr7Hh90jNFUg1IjOg.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="1f84" class="lr ls it nw b gy oa ob l oc od">sns.regplot(data=train, x='GarageCars', y='SalePrice')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/3765277985910a90c08c18c6256cfdde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDYFmvNnJDLrposPPvaB9w.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="2bad" class="lr ls it nw b gy oa ob l oc od">top_6_df['TotalBsmtSF'].hist(bins=20)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/f560fe21a50f146b608e53c93e6851ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vaAUpGz4y7OO5NuJlp3oNA.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="66bd" class="lr ls it nw b gy oa ob l oc od">sns.regplot(data=train, x='TotalBsmtSF', y='SalePrice')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/ad4316f267538c0e52d0c801a7676b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oExGOwflVCcbsYwCVWeJ2Q.png"/></div></div></figure><h2 id="5b74" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">步骤5:建立数据模型</h2><h2 id="9e65" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">线性回归</h2><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="0e5e" class="lr ls it nw b gy oa ob l oc od">from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LinearRegression<br/>from sklearn.metrics import mean_squared_error</span></pre><p id="b9bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">创建我们的“<strong class="kw iu"> X </strong>”和“<strong class="kw iu"> y </strong>”轴，拆分出我们的“<strong class="kw iu">训练</strong>”和“<strong class="kw iu">测试</strong>”集合，对数据进行缩放，进行“<strong class="kw iu">线性回归</strong>”，做一些预测，最后计算“<strong class="kw iu">训练</strong>”和“<strong class="kw iu">测试</strong>”分数。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="a972" class="lr ls it nw b gy oa ob l oc od">X = top_6_df.drop('SalePrice', axis=1)<br/>y = top_6_df['SalePrice']</span><span id="84ce" class="lr ls it nw b gy oe ob l oc od">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=5)</span></pre><p id="e66e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据集中的每个数字要素都有不同的比例。由于回归模型是基于距离的，您可能希望公平地比较所有特征。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="ad75" class="lr ls it nw b gy oa ob l oc od"># train<br/>scaler = preprocessing.StandardScaler().fit(X_train)<br/>X_scaled = scaler.transform(X_train)<br/>X_train = pd.DataFrame(X_scaled, columns=[X_train.columns])<br/>X_train</span><span id="1a44" class="lr ls it nw b gy oe ob l oc od"># test<br/>scaler = preprocessing.StandardScaler().fit(X_test)<br/>X_scaled = scaler.transform(X_test)<br/>X_test = pd.DataFrame(X_scaled, columns=[X_test.columns])<br/>X_test</span></pre><p id="3d8b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个例子，展示了我们的缩放数据现在的样子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/77a16f6c4cf03e3a24d0270b9f5664a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vGVPtLXH8WBk28IxoGiylg.png"/></div></div></figure><p id="71f2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">符合我们的线性回归模型。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="4585" class="lr ls it nw b gy oa ob l oc od">linreg = LinearRegression()<br/>linreg.fit(X_train, y_train)</span></pre><p id="8672" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">做一些预测:)</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="cc53" class="lr ls it nw b gy oa ob l oc od">y_train_predicted = linreg.predict(X_train)<br/>y_test_predicted = linreg.predict(X_test)</span></pre><p id="6b26" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对我们的“<strong class="kw iu">训练</strong>和“<strong class="kw iu">测试</strong>”结果进行评分。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="dc03" class="lr ls it nw b gy oa ob l oc od">linreg_train_r2 = linreg.score(X_train, y_train)<br/>linreg_test_r2 = linreg.score(X_test, y_test)</span><span id="c4fc" class="lr ls it nw b gy oe ob l oc od">print("Training R^2")<br/>print(linreg_train_r2)<br/>print("Test R^2")<br/>print(linreg_test_r2)</span><span id="63fa" class="lr ls it nw b gy oe ob l oc od"><strong class="nw iu">Training R^2<br/>0.7632504749539565<br/>Test R^2<br/>0.7546592040484126</strong></span></pre><p id="ccaa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">均方根误差(RMSE)是衡量模型在预测定量数据时的误差的标准方法。有其他方法可以做到这一点，但我喜欢这个方法，因为它的结果与你试图预测的结果是一样的。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="a700" class="lr ls it nw b gy oa ob l oc od">linreg_train_rmse = np.sqrt(mean_squared_error(y_train, y_train_predicted))<br/>linreg_test_rmse = np.sqrt(mean_squared_error(y_test, y_test_predicted))</span><span id="b4b1" class="lr ls it nw b gy oe ob l oc od">print("Training RMSE, Test RMSE")<br/>print(linreg_train_rmse, linreg_test_rmse)</span><span id="9200" class="lr ls it nw b gy oe ob l oc od"><strong class="nw iu">Training RMSE, Test RMSE<br/>39456.44162219146 37312.96843897494</strong></span></pre><p id="041e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上面的意思是，训练集是39，456美元，测试集是37，312美元。在其他作品中，预测可能会“超出”这个数量。</p><p id="b2bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里只是重新概括一下我们用作输入的不确定变量或特征。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="bb90" class="lr ls it nw b gy oa ob l oc od">X.columns</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/2f5b509ac66be62ab7fe1288c0c6a0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ji27Rod71EOsxjzlccjr0g.png"/></div></div></figure><p id="eb44" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在线性回归中，系数是与预测值相乘的值。每个系数的符号表示预测变量和响应变量之间关系的方向。正号表示随着预测变量的增加，响应变量也增加。查看这些系数的方式如下:</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="bb6a" class="lr ls it nw b gy oa ob l oc od">linreg.coef_</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/86909fb38278e215e94dbca16b138fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PwHl3kdCN4AFx02ItLekXA.png"/></div></div></figure><p id="c253" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在将基于“<strong class="kw iu"> top_6_df </strong>”的副本创建一个新的结果数据帧。这个新的数据框架将包含两个新列。"<strong class="kw iu"> y_predicted </strong>"表示预测销售价格，"<strong class="kw iu"> y_diff </strong>"表示实际销售价格与预测价格之间的差异。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="3ef4" class="lr ls it nw b gy oa ob l oc od">result_df = top_6_df.iloc[top_6_df.index.isin(X_train.index),:].copy()<br/>result_df['y_predicted'] = np.round(linreg.predict(X_train))<br/>result_df['y_diff'] = result_df['SalePrice'] - result_df['y_predicted']</span><span id="07a3" class="lr ls it nw b gy oe ob l oc od">result_df.columns</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/30826b1a8791d160d118f8d4eabc72f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rzl2HU1FwvCiEV-EvogaqA.png"/></div></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="e1f4" class="lr ls it nw b gy oa ob l oc od">result_df.loc[:, ['OverallQual', 'GrLivArea', 'GarageCars', 'GarageArea', 'TotalBsmtSF', '1stFlrSF', 'SalePrice', 'y_predicted', 'y_diff']].head(20)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/e78bc2e296a41d6698543001aa36be72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNVdERsO4iuEkAculB1iZA.png"/></div></div></figure><p id="9f83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">结果:</p><ul class=""><li id="51c9" class="mp mq it kw b kx ky la lb ld pb lh pc ll pd lp mu mv mw mx bi translated">我们可以假设总性能的70 ~ 80%</li><li id="a344" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">从RMSE，我们可以预期我们所做的每个预测将提供35，000美元到40，000美元。</li></ul><h2 id="8679" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">套索和岭回归</h2><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="7816" class="lr ls it nw b gy oa ob l oc od">from sklearn.preprocessing import StandardScaler<br/>from sklearn.linear_model import Ridge, RidgeCV, Lasso, LassoCV</span></pre><p id="8b24" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在上一节中，我们手动将维度减少到6个特征。在本节中，我们将需要制作一份完整的“<strong class="kw iu">系列</strong>”副本。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="7312" class="lr ls it nw b gy oa ob l oc od">train_df = train._get_numeric_data().copy()</span><span id="8646" class="lr ls it nw b gy oe ob l oc od">train_df.drop('Id', axis = 1, inplace = True)<br/>train_df.dropna(inplace = True, axis = 0)</span><span id="197b" class="lr ls it nw b gy oe ob l oc od">X = train_df.drop("SalePrice", axis=1)<br/>y = train_df['SalePrice']</span><span id="db0f" class="lr ls it nw b gy oe ob l oc od">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=5)</span></pre><p id="4c8f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们需要定义一组alphas来测试山脊和套索模型。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="feb3" class="lr ls it nw b gy oa ob l oc od">test_alphas = [0.001, 0.01, 0.1, 1, 10, 100, 300, 500, 700, 1000, 10000, 100000]</span></pre><p id="213f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用RidgeCV和LassoCV调整alpha hyper参数。这些“CV”模型将选择在预测中产生最小误差的α。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="7975" class="lr ls it nw b gy oa ob l oc od">ridge = RidgeCV(alphas=test_alphas, cv=3)<br/>lasso = LassoCV(alphas=test_alphas, cv=3)</span></pre><p id="d888" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们希望像线性回归一样进行标准缩放。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="dd71" class="lr ls it nw b gy oa ob l oc od">ss = StandardScaler()<br/>ss.fit(X_train)<br/>ss.fit(X_test)</span></pre><h2 id="2889" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">里脊回归</h2><p id="ebf2" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">现在我们想让数据符合我们的模型。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="b7da" class="lr ls it nw b gy oa ob l oc od">ridge.fit(X_train_scaled, y_train)</span></pre><p id="3216" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">模型选择了什么样的alpha值为最佳值？</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="083a" class="lr ls it nw b gy oa ob l oc od">ridge.alpha_<br/><strong class="nw iu">100.0</strong></span></pre><p id="a291" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">岭回归做的怎么样？</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="b7a4" class="lr ls it nw b gy oa ob l oc od">ridge_train_r2 = ridge.score(X_train_scaled, y_train)<br/>ridge_test_r2  = ridge.score(X_test_scaled, y_test)</span><span id="2a6a" class="lr ls it nw b gy oe ob l oc od">print("Ridge Results\n Training R^2 : {} \n Test R^2     : {}\n".format(round(ridge_train_r2,2),<br/>                                                                       round(ridge_test_r2,2)))</span><span id="0abd" class="lr ls it nw b gy oe ob l oc od">ridge_train_pred = ridge.predict(X_train_scaled)<br/>ridge_test_pred = ridge.predict(X_test_scaled)</span><span id="5527" class="lr ls it nw b gy oe ob l oc od">print("Ridge Train RMSE:", round(np.sqrt(mean_squared_error(y_train, ridge_train_pred))) )     <br/>print("Ridge Test RMSE:", round(np.sqrt(mean_squared_error(y_test, ridge_test_pred))))</span><span id="3982" class="lr ls it nw b gy oe ob l oc od"><strong class="nw iu">Ridge Results<br/> Training R^2 : 0.8 <br/> Test R^2     : 0.81<br/><br/>Ridge Train RMSE: 37907<br/>Ridge Test RMSE: 33659</strong></span></pre><p id="37ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">组装一个数据框架来比较系数。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="96b6" class="lr ls it nw b gy oa ob l oc od">pd.DataFrame(data = {<br/>    "features" : X.columns,<br/>    "coefs"    : ridge.coef_<br/>}).sort_values(by = 'coefs', ascending = False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/64f0366bfb5c87739c573f2ad3daed57.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*NSQKvOBkQ-xDADu1-cyMFw.png"/></div></figure><p id="7bc3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可视化alpha与系数趋势(当我们增加alpha时，我们增加正则化强度，迫使可变系数更接近零)。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="5aa8" class="lr ls it nw b gy oa ob l oc od">alphas_list = np.linspace(1,5000, 30)<br/>coefs_list = []<br/>for i in alphas_list:<br/>    model = Ridge(alpha = i)<br/>    model.fit(X_train_scaled, y_train)<br/>    coefs_list.append(model.coef_)<br/>    <br/>plt.figure(figsize = (10,10))<br/>plt.plot(alphas_list, coefs_list, lw = '3')<br/>plt.title("Regularization (Ridge)", fontsize = 15)<br/>plt.legend(X.columns, loc='right', bbox_to_anchor= (1.2, 0.5));</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/a6b80081f41a5d7a2704a06cbf330218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NjbSSZokcMjtSMF53ZkpvQ.png"/></div></div></figure><h2 id="b6e9" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">套索回归</h2><p id="4b3b" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">现在我们想让数据适合我们的下一个模型。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="775b" class="lr ls it nw b gy oa ob l oc od">lasso.fit(X_train_scaled, y_train)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/f65ae11090fd9da555eea6cd12f4d698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sge21MSYpKMYDXwaT2gSyg.png"/></div></div></figure><p id="da0b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">模型选择了什么样的alpha值为最佳值？</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="2ed7" class="lr ls it nw b gy oa ob l oc od">lasso.alpha_<br/><strong class="nw iu">700.0</strong></span></pre><p id="385b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">套索回归做的怎么样？</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="cf10" class="lr ls it nw b gy oa ob l oc od">lasso_train_r2 = lasso.score(X_train_scaled, y_train)<br/>lasso_test_r2  = lasso.score(X_test_scaled, y_test)</span><span id="c10a" class="lr ls it nw b gy oe ob l oc od">print("LASSO Results\n Training R^2: {} \n Test R^2    : {}\n".format(round(lasso_train_r2,2),round(lasso_test_r2,2)))</span><span id="d725" class="lr ls it nw b gy oe ob l oc od">lasso_train_pred = lasso.predict(X_train_scaled)<br/>lasso_test_pred = lasso.predict(X_test_scaled)</span><span id="3d1b" class="lr ls it nw b gy oe ob l oc od">print("LASSO Train RMSE:", round(np.sqrt(mean_squared_error(y_train, lasso_train_pred))) )     <br/>print("LASSO Test RMSE:", round(np.sqrt(mean_squared_error(y_test, lasso_test_pred))))</span><span id="1696" class="lr ls it nw b gy oe ob l oc od"><strong class="nw iu">LASSO Results<br/> Training R^2: 0.8 <br/> Test R^2    : 0.8<br/><br/>LASSO Train RMSE: 37797<br/>LASSO Test RMSE: 33830</strong></span></pre><p id="d3cd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">组装一个数据框架来比较系数。请注意Lasso是如何将许多不太重要的变量减少到0的，因为我们使用了一个大的alpha(这是更高的正则化强度)</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="d732" class="lr ls it nw b gy oa ob l oc od">pd.DataFrame(data = {<br/>    "features" : X.columns,<br/>    "coefs"    : lasso.coef_<br/>}).sort_values(by = 'coefs', ascending = False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/1d751da7d4e33ea2697c253999656ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*jU1MoGm55LGi7i6Sbgw8bw.png"/></div></figure><p id="2270" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可视化阿尔法与拉索系数，以查看系数，因为他们得到正则化为0。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/d987742402f82b1cb75a10872e2cde76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qF2P-s8MA1FlnQ0vh0rV_w.png"/></div></div></figure><h2 id="c11e" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">模型比较</h2><p id="2fc0" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">我们来看一下作为模型对比。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="8de3" class="lr ls it nw b gy oa ob l oc od">print("LinReg Results\n Training R^2: {} \n Test R^2    : {}\n".format(<br/>    round(linreg_train_r2,2),round(linreg_test_r2,2)))<br/>print("LinReg Train RMSE:", round(linreg_train_rmse)) <br/>print("LinReg Test RMSE:", round(linreg_test_rmse))<br/>print("------------------------------\n")<br/>print("Ridge Results\n Training R^2: {} \n Test R^2    : {}\n".format(round(ridge_train_r2,2),round(ridge_test_r2,2)))<br/>print("Ridge Train RMSE:", round(np.sqrt(mean_squared_error(y_train, ridge_train_pred))) )     <br/>print("Ridge Test RMSE:", round(np.sqrt(mean_squared_error(y_test, ridge_test_pred))))<br/>print("------------------------------\n")<br/>print("\nLASSO Results\n Training R^2: {} \n Test R^2    : {}\n".format(round(lasso_train_r2,2),round(lasso_test_r2,2)))<br/>print("LASSO Train RMSE:", round(np.sqrt(mean_squared_error(y_train, lasso_train_pred))) )     <br/>print("LASSO Test RMSE:", round(np.sqrt(mean_squared_error(y_test, lasso_test_pred))))<br/>print("------------------------------")</span><span id="8820" class="lr ls it nw b gy oe ob l oc od"><strong class="nw iu">LinReg Results<br/> Training R^2: 0.76 <br/> Test R^2    : 0.75<br/><br/>LinReg Train RMSE: 39456<br/>LinReg Test RMSE: 37508<br/>------------------------------<br/><br/>Ridge Results<br/> Training R^2: 0.8 <br/> Test R^2    : 0.81<br/><br/>Ridge Train RMSE: 37907<br/>Ridge Test RMSE: 33659<br/>------------------------------<br/><br/><br/>LASSO Results<br/> Training R^2: 0.8 <br/> Test R^2    : 0.8<br/><br/>LASSO Train RMSE: 37797<br/>LASSO Test RMSE: 33830<br/>------------------------------</strong></span></pre><p id="87a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Rob的一些有趣的收获…</p><ul class=""><li id="9b7a" class="mp mq it kw b kx ky la lb ld pb lh pc ll pd lp mu mv mw mx bi translated">我们的“幼稚”线性回归方法在只有几个高度相关变量的情况下表现惊人地好。</li><li id="9008" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">Ridge在测试集上具有最低的RMSE，但是有点“过拟合”(测试集性能优于训练集，通常“过拟合”在训练分数高于测试分数的情况下是常见的)</li><li id="bc56" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">总的来说，正则化的实现比标准线性回归有所改进。</li><li id="9599" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated">可能影响结果的因素可能是我们使用的random_site，也可能是由于采样。</li></ul><h2 id="5b7d" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">模型持久性</h2><p id="877a" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">在模型上花了很多时间之后，你可能想要保存你的进度。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="de19" class="lr ls it nw b gy oa ob l oc od">from joblib import dump, load<br/>dump(lasso,  './lasso.joblib')<br/>dump(ridge,  './ridge.joblib')<br/>dump(linreg, './linreg.joblib')</span></pre><p id="3f56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以按如下方式加载它们。</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="68b8" class="lr ls it nw b gy oa ob l oc od">loaded_lasso = load('./lasso.joblib')<br/>print(loaded_lasso)<br/>print("\nUsing the loaded model to generate predictions:\n", loaded_lasso.predict(X_train_scaled)[:10])</span><span id="27c2" class="lr ls it nw b gy oe ob l oc od"><strong class="nw iu">LassoCV(alphas=[0.001, 0.01, 0.1, 1, 10, 100, 300, 500, 700, 1000, 10000,<br/>                100000],<br/>        cv=3)<br/><br/>Using the loaded model to generate predictions:<br/> [108052.00073693  75944.45975011 228875.9011433  345470.07560924<br/> 215239.85926407 113736.22360514 125167.70342725 193878.73499501<br/> 236425.08656162 115124.0657801 ]</strong></span></pre><p id="ff4b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望您对此感兴趣，并再次特别感谢Robert Manriquez的出色培训和课程支持。</p><p id="8759" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望你喜欢这篇文章。如果你这样做了，请考虑关注我以后的文章，并为这篇文章鼓掌，因为这有助于回报我的努力:)</p><h1 id="301c" class="pj ls it bd lt pk pl pm lw pn po pp lz jz pq ka mc kc pr kd mf kf ps kg mi pt bi translated">迈克尔·惠特尔</h1><ul class=""><li id="8643" class="mp mq it kw b kx mk la ml ld mr lh ms ll mt lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="pu">如果你喜欢这个，请</em> </strong> <a class="ae lq" href="https://whittle.medium.com/" rel="noopener"> <strong class="kw iu"> <em class="pu">跟我上媒</em> </strong> </a></li><li id="3eea" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="pu">更多有趣的文章，请</em> </strong> <a class="ae lq" href="https://medium.com/trading-data-analysis" rel="noopener"> <strong class="kw iu"> <em class="pu">关注我的刊物</em> </strong> </a></li><li id="2e4b" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="pu">对通敌感兴趣？</em> </strong> <a class="ae lq" href="https://www.linkedin.com/in/miwhittle/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="pu">我们上LinkedIn </em> </strong> </a>连线吧</li><li id="e635" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="pu">支持我和其他媒体作者</em> </strong> <a class="ae lq" href="https://whittle.medium.com/membership" rel="noopener"> <strong class="kw iu"> <em class="pu">在此报名</em> </strong> </a></li><li id="872e" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="pu">请别忘了为文章鼓掌:)←谢谢！</em> </strong></li></ul></div></div>    
</body>
</html>