<html>
<head>
<title>How to Convert your JSON to Swift?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何把你的JSON转换成Swift？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-convert-your-json-to-swift-235965d71ee?source=collection_archive---------9-----------------------#2020-05-25">https://levelup.gitconnected.com/how-to-convert-your-json-to-swift-235965d71ee?source=collection_archive---------9-----------------------#2020-05-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="af11" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用工具和可解码</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7febad6114a73c9f1b204c5e61fc6a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8CZAz-z9YLNQfjq0gw2xMg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者JSON至Swift照片</figcaption></figure><h1 id="f00a" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">JSON是什么？</h1><p id="1bab" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">JSON——JavaScript对象符号——是一种轻量级数据交换格式。它也是独立于任何语言的，但使用程序员已经熟悉的相同约定。JSON建立在两种基本的数据结构之上，</p><ol class=""><li id="e11d" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">名称/值对的集合。我们可以把这些对看作一个对象、结构或字典。</li><li id="c0fd" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">值的有序列表。简单地放一个数组，向量，列表，或者序列。</li></ol><p id="c2f1" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">几乎所有的现代语言都支持上述两种数据结构。这就是JSON流行的原因。这是人类可读的，同时，非常轻量级。一个100，000字符的JSON文件大约有100KB大。对于100KB来说，这已经是很大的信息量了。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="9cd3" class="kv kw iq bd kx ky nj la lb lc nk le lf jw nl jx lh jz nm ka lj kc nn kd ll lm bi translated">工具</h1><ol class=""><li id="42eb" class="mj mk iq lp b lq lr lt lu lw no ma np me nq mi mq mr ms mt bi translated">quick type—<a class="ae nr" href="https://app.quicktype.io/" rel="noopener ugc nofollow" target="_blank">https://app . quick type . io</a></li><li id="8bef" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">JSON cafe—<a class="ae nr" href="http://www.jsoncafe.com/" rel="noopener ugc nofollow" target="_blank">http://www.jsoncafe.com</a></li><li id="14bd" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">https://www.json4swift.com/</li></ol><p id="dae1" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">可能还有更多，但这些是我目前遇到的。来说说我的一个最爱吧。</p><h2 id="1f6e" class="ns kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">QuickType</h2><p id="5421" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">这个工具是我非常喜欢的。只需复制你的JSON并粘贴到<a class="ae nr" href="https://app.quicktype.io/" rel="noopener ugc nofollow" target="_blank">https://app . quick type . io</a>上。它应该立即生成Swift代码，我们可以复制/粘贴到Xcode的权利。我们还可以在右侧获得过多的定制选项。</p><p id="f2cf" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">你也可以从<a class="ae nr" href="https://apps.apple.com/us/app/paste-json-as-code-quicktype/id1330801220?mt=12" rel="noopener ugc nofollow" target="_blank">这里</a>下载macOS应用和Xcode扩展。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/23f000499726f00c5c9560e816356052.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6M0PivvYIbn6Q73y41wwWg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者<a class="ae nr" href="https://app.quicktype.io/" rel="noopener ugc nofollow" target="_blank">https://app.quicktype.io/</a>的照片</figcaption></figure></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="b52f" class="kv kw iq bd kx ky nj la lb lc nk le lf jw nl jx lh jz nm ka lj kc nn kd ll lm bi translated">JSON到Swift对象，可解码</h1><h2 id="3ca5" class="ns kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">我们的Swift模型</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">使用QuickType生成</figcaption></figure><p id="27d1" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">我喜欢将模型和协议一致性的基本声明分开。它清楚地表明了模型并不100%依赖于协议一致性。</p><h2 id="81f3" class="ns kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">使用URLSession的示例</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="876f" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">在这里，我们从<a class="ae nr" href="http://jsonplaceholder.typicode.com" rel="noopener ugc nofollow" target="_blank">http://jsonplaceholder.typicode.com</a>获取帖子。这里没有什么特别的，只是一个常规的<code class="fe oh oi oj ok b">URLSession</code>用于从REST API获取数据，并使用<code class="fe oh oi oj ok b">JSONDecoder</code>从JSON转换到Swift模型。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h2 id="bc8e" class="ns kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">使用Alamofire的示例</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="aa23" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">代码少了很多！Alamofire提供了一种支持开箱即用的<code class="fe oh oi oj ok b">Decodable</code>的方法。只需接入<code class="fe oh oi oj ok b">response</code>的<code class="fe oh oi oj ok b">value</code>，就可以了！</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="e98c" class="kv kw iq bd kx ky nj la lb lc nk le lf jw nl jx lh jz nm ka lj kc nn kd ll lm bi translated">破解常见错误</h1><h2 id="49e6" class="ns kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">类型不匹配</h2><p id="4aae" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">应该解码字符串，但却找到一个数字。</p><p id="959b" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">尽管有可互换性的好处，但还是会出现一个常见的错误，即期望的和接收的不匹配。我们的模型需要一个字符串值，但它收到了一个数字值。例如，在我们的<code class="fe oh oi oj ok b">Post</code>模型中，如果我们将<code class="fe oh oi oj ok b">userID</code>类型改为<code class="fe oh oi oj ok b">String</code>，然后再次运行代码，Alamofire就会抛出这个错误，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/d6bd8cf853c874ec4aa377451906cf97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-8oNcSYgsTjNhFTl3pQLjw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</figcaption></figure><p id="1820" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">正如你所看到的，错误的要点是下划线。实际误差和什么有关，也就是<code class="fe oh oi oj ok b">userId</code>。简而言之，这意味着<code class="fe oh oi oj ok b">userId</code>在JSON中作为<code class="fe oh oi oj ok b">number</code>被接收，但我们正试图将其解码为<code class="fe oh oi oj ok b">String</code>。</p><p id="e110" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">当使用URLSession实例调用REST API时，会出现相同的错误输出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/c19f5d0a8bb673cc5e867983b7c59673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTpsrTOEozBgoiFZujPB7Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</figcaption></figure><h2 id="ec73" class="ns kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">JSON文本没有以数组或对象开头，并且没有设置允许片段的选项。</h2><p id="8c35" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">这也是使用JSON时非常常见的错误之一。大多数情况下，这意味着你收到的JSON是一个错误的。最好使用类似于<a class="ae nr" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>的工具来查看REST API是否正常工作，然后在项目中继续实现。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="bf59" class="kv kw iq bd kx ky nj la lb lc nk le lf jw nl jx lh jz nm ka lj kc nn kd ll lm bi translated">参考</h1><div class="on oo gp gr op oq"><a href="https://www.json.org/json-en.html" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">JSON</h2><div class="ox l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">www.json.org</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd kp oq"/></div></div></a></div></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="cf0f" class="kv kw iq bd kx ky nj la lb lc nk le lf jw nl jx lh jz nm ka lj kc nn kd ll lm bi translated">下载代码</h1><div class="on oo gp gr op oq"><a href="https://github.com/akshitzaveri/JSONtoSwift" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">akshitzaveri/jsontoswitf</h2><div class="ox l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">github.com</p></div></div><div class="oy l"><div class="pe l pa pb pc oy pd kp oq"/></div></div></a></div><p id="9c3c" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">感谢您的阅读。如果你想让我写点什么，请告诉我。</p></div></div>    
</body>
</html>