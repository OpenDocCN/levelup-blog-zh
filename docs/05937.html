<html>
<head>
<title>Amazon AWS EC2 Auto Scaling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊AWS EC2自动缩放</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/implementing-and-testing-aws-ec2-auto-scaling-13db17be1161?source=collection_archive---------6-----------------------#2020-10-13">https://levelup.gitconnected.com/implementing-and-testing-aws-ec2-auto-scaling-13db17be1161?source=collection_archive---------6-----------------------#2020-10-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b6f5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Amazon AWS中实现和测试EC2自动缩放</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ae2b67cdcca555909ede140f11844abd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B2Y3XrFJMRNfVx4laD4IcA.jpeg"/></div></div></figure><p id="c340" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用云基础设施的好处之一是能够非常轻松地部署和扩展。<a class="ae lq" href="http://console.aws.amazon.com/ec2" rel="noopener ugc nofollow" target="_blank"> AWS EC2 </a>中的自动扩展允许您根据需求灵活配置基础设施。您还可以在<a class="ae lq" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_AutoScaling.html" rel="noopener ugc nofollow" target="_blank"> AWS CloudFormation </a>模板中包含自动缩放组。</p><p id="6c30" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本教程将带你了解自动缩放的配置，并测试它是否真的有效。虽然配置自动缩放是相当简单的，一旦你知道如何做，有一系列的步骤，你需要做的顺序，我会涵盖这些了。</p><h1 id="9a9e" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">步骤1: </strong>构建一个EC2实例并创建一个Amazon机器映像(AMI)</h1><p id="4e78" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我想为本教程创建一个非常快速的实例和图像。如果你要和我一起遵循这些步骤，这是你需要做的…</p><ul class=""><li id="8fc3" class="mo mp it kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">点击<strong class="kw iu">启动实例</strong></li><li id="6c18" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">在步骤1:选择“<strong class="kw iu"> Ubuntu Server 20.04 LTS (HVM)，SSD卷类型</strong></li><li id="2538" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">在步骤2:选择<strong class="kw iu"> t2.micro </strong>(自由层)</li><li id="5cb4" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">在步骤3:确保“<strong class="kw iu">自动分配公共IP </strong>”设置为“<strong class="kw iu">启用</strong></li><li id="12e9" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">在步骤3:在“<strong class="kw iu">高级详细信息</strong>”和“<strong class="kw iu">用户数据</strong>”下包含此预配脚本:</li></ul><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="153f" class="nh ls it nd b gy ni nj l nk nl">#!/bin/bash</span><span id="a594" class="nh ls it nd b gy nm nj l nk nl">apt-get update -y<br/>apt-get upgrade -y<br/>apt-get install apache2 stress -y<br/>systemctl start apache2<br/>systemctl enable --now apache2</span></pre><p id="aaca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装“压力”对本教程很重要，但通常你不会包括它。它将允许您对实例施加压力，以允许触发自动缩放。</p><p id="87b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然我自己没有用过，但我知道网飞有他们自己的压力测试工具，叫做“<a class="ae lq" href="https://netflix.github.io/chaosmonkey/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">混沌猴</strong> </a>”。它看起来很有趣，值得一试。</p><ul class=""><li id="c8e8" class="mo mp it kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">步骤4和5: <strong class="kw iu">保留默认值</strong></li><li id="534b" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">步骤6:使用相同的描述创建一个名为“<strong class="kw iu"> acl-web-in </strong>”的安全组。保留默认的SSH规则以允许您访问您的实例，但是也添加一个HTTP规则。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/a399b10105a672d9b0622862ff269298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7RJv8JzJajqOH1Ka8zZHqQ.png"/></div></div></figure><ul class=""><li id="5293" class="mo mp it kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">第七步:<strong class="kw iu">发射</strong></li><li id="f39b" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated"><strong class="kw iu">选择一个现有的密钥对或创建一个密钥对</strong>(您也可以访问)。</li></ul><p id="82c6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以现在的问题是，一旦我们登录到我们的实例，我们如何知道我们的“<strong class="kw iu">用户数据</strong>”脚本何时结束运行？</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="f790" class="nh ls it nd b gy ni nj l nk nl">ubuntu@ip-172-31-40-74:~$ ls -la<br/>total 28<br/>drwxr-xr-x 4 ubuntu ubuntu 4096 Oct 13 08:43 .<br/>drwxr-xr-x 3 root   root   4096 Oct 13 08:42 ..<br/>-rw-r--r-- 1 ubuntu ubuntu  220 Feb 25  2020 .bash_logout<br/>-rw-r--r-- 1 ubuntu ubuntu 3771 Feb 25  2020 .bashrc<br/>drwx------ 2 ubuntu ubuntu 4096 Oct 13 08:43 .cache<br/>-rw-r--r-- 1 ubuntu ubuntu  807 Feb 25  2020 .profile<br/>drwx------ 2 ubuntu ubuntu 4096 Oct 13 08:42 .ssh<br/>-rw-r--r-- 1 ubuntu ubuntu    0 Oct 13 08:43 <strong class="nd iu">.sudo_as_admin_successful</strong></span></pre><p id="8f6a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那个“<strong class="kw iu">。一旦预配脚本完成，将在“<strong class="kw iu"> ubuntu </strong>”用户主目录中创建sudo_as_admin_successful </strong>”隐藏文件。</p><p id="64c4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们还可以确认我们的Apache web服务器运行在<a class="ae lq" href="http://localhost" rel="noopener ugc nofollow" target="_blank"> http://localhost </a>上，并提供默认的“【index.html】T2”页面，我们将使用该页面进行测试。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="34d7" class="nh ls it nd b gy ni nj l nk nl">ubuntu@ip-172-31-40-74:~$ <strong class="nd iu">curl -s http://localhost | head -n 3</strong></span><span id="3d9c" class="nh ls it nd b gy nm nj l nk nl">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br/>&lt;html &gt;</span></pre><p id="0769" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们还可以通过在浏览器中打开“http:// <strong class="kw iu"> PUBLIC_IP </strong>”来测试我们的web服务器是否正常工作。通过在控制台中单击AWS EC2实例，可以找到“<strong class="kw iu">公共IPv4地址</strong>”。</p><h1 id="621c" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">步骤2:创建一个Amazon机器映像(AMI)</h1><p id="dea3" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">一旦我们构建了模板EC2实例，我们现在需要为它创建一个图像。在EC2控制台中选择您的实例，点击"<strong class="kw iu"> Actions </strong>"菜单，点击"<strong class="kw iu"> Image </strong>"选项，然后"<strong class="kw iu"> Create image </strong>"。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/11298437d3d82da7e484d160ce550829.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZSpbJjNvL_u-ADJaddhnA.png"/></div></div></figure><p id="a1ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">给你的图像起一个合适的名字(<em class="np">我称我的为“Apache-we b-server”</em>)，然后点击“<strong class="kw iu">创建图像</strong>”。我们将使用这个AMI图像作为我们的缩放图像，但是如果您以前没有使用过这些图像，您也可以在“<strong class="kw iu"> Launch instance </strong>”中使用它们。如果你正在启动一个新的实例，你会在左边看到“<strong class="kw iu">我的朋友</strong>”。如果您选择您的映像，您将能够使用Apache提供一个Ubuntu服务器实例。</p><h1 id="4356" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">第三步</strong>:创建一个“启动模板”</h1><p id="41dc" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">实际上有两种方法可以做到这一点。您可以点击EC2控制台中实例下的“<strong class="kw iu">启动模板</strong>”菜单选项。然后点击<strong class="kw iu">创建启动模板</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/3e541bdb992292008a0aa1b0bc709fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*fmbC_nN1IEQr_QcXy0MQng.png"/></div></figure><p id="894d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者您可以选择您将用作模板的实例，点击“<strong class="kw iu">操作</strong>”菜单，然后转到“<strong class="kw iu">从实例</strong>创建模板”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/1e2782c4ff9c5a38dbf26ace7d5fd718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*jiiAcNavt1aHjaHQAJexkQ.png"/></div></figure><p id="6ba5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这两种方式都会将您引导到同一个位置，即“<strong class="kw iu">创建启动模板</strong>”配置页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/b295db6657acdcdeef30ce57ff42ea06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lrouRRZ7OoqoGP5-IEH8vw.png"/></div></div></figure><p id="b4d0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里没有什么复杂的…只是给你的模板一个名称和描述，我喜欢添加一个“项目”标签，但这是可选的，并选择您在第3步创建的AMI图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/05564e43d5167bf855e9d6e534b1ab4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g9B4lRH2MYnYj9VSg1iEsA.png"/></div></div></figure><p id="8fcb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将实例类型保持为"<strong class="kw iu"> t2.micro </strong>"，为我的"<strong class="kw iu">密钥对</strong>"赋值，选择"<strong class="kw iu"> EC2-Classic </strong>"，并附加我的"<strong class="kw iu">安全组</strong>"以允许HTTP连接入站。我在本教程中使用了“<strong class="kw iu"> EC2-Classic </strong>”，但是如果你想在VPC中配置它，这里就是你要做的地方。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/6364b1f8b033bdf3e116103b8e208848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMDv15iK0iaUOd-KBJidHw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/428f14b9802fd397e97086bab82731fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2hVmPgbrL4ZU_20LGpk0w.png"/></div></div></figure><p id="8821" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可选设置，根据需要进行配置。</p><p id="f8e9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后点击<strong class="kw iu">创建启动模板</strong>。</p><p id="c959" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，您应该可以看到您的启动模板。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/6be1117419da318b43b1d55552ef2d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EY25fVUMvxOgmFKlYtnzhQ.png"/></div></div></figure><h1 id="c6c9" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">步骤3:创建一个“目标群体”</h1><p id="77c4" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在加载过程中灵活使用基础设施固然很好，但是仅仅添加额外的实例并不意味着它们会被使用。这就是负载平衡器发挥作用的地方。我不打算在这里讨论部署负载平衡器。重要的部分是负载平衡器将使用的目标组。当在自动扩展期间添加或删除实例时，我们希望将它们添加到目标组或从目标组中删除，负载平衡器将处理其余的工作。</p><p id="a21a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击EC2控制台中“<strong class="kw iu">负载均衡</strong>下的“<strong class="kw iu">目标组</strong>，然后点击“<strong class="kw iu">创建目标组</strong>”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/a107914b8c8ce6c2a7828e27e961a6ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gaezeGan29Nw7n_Xiw57g.png"/></div></div></figure><p id="fd53" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">选择“<strong class="kw iu">实例</strong>作为“<strong class="kw iu">目标类型</strong>”，并将您的“<strong class="kw iu">目标组命名为</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/ba8cbdc94bff749c0b3bbdfacb9d4365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MRryCJ4tDhoGnctvsFFYWA.png"/></div></div></figure><p id="0dae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以将这些选项保留为默认选项，然后单击“<strong class="kw iu">下一步”</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/49efc65c6c3ad4ca7cab4383c9d84c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cZlnTmRsKari7bRFpC-0NA.png"/></div></div></figure><p id="50e2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在“<strong class="kw iu"> Register targets </strong>”页面上，您将看到我们正在运行的实例。您需要选择它，然后单击“<strong class="kw iu">在</strong>下面包含为待定”，将其添加到“<strong class="kw iu">目标</strong>”中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/83eec9e8071e0dd257af08b806194a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FTkLec7V3g-bjhNjA2y6zQ.png"/></div></div></figure><p id="5a88" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您将看到我的实例是如何"<strong class="kw iu">待定</strong>并被注册为"<strong class="kw iu">目标</strong>"的。点击<strong class="kw iu">创建目标组</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/a8bfdc8dc786252550368596f9648c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jnZht9O_HkfjBeH4F6m8FA.png"/></div></div></figure><h1 id="1c6e" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">步骤4:创建一个“启动配置”</h1><p id="dc2f" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在EC2控制台中的“<strong class="kw iu">自动缩放</strong>下，您会看到一个名为“<strong class="kw iu">启动配置</strong>的菜单选项。点击它，然后点击“<strong class="kw iu">创建启动配置</strong>”。下面的所有选项应该是不言自明的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/51445c8378de437f126d4e71824c2b71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dCxO5AYLZHNd8NOICNY5eQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/51aed42c8cb7acec6ceca4ba2b6e1657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uV8pPWRgCQtByDN29N_6Q.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/9acb6f6de9606598988fc7c7a952becb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngkPLvs7MDw6dgQyn-Y5Ug.png"/></div></div></figure><p id="1cda" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完成后，点击“<strong class="kw iu">创建启动配置</strong>”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/1fe2a8f930ab1b6d3ef3c375f573f921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDuaB_0aFFrkmzV_MyhuEw.png"/></div></div></figure><h1 id="21c8" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">步骤5:创建“自动缩放组”</h1><p id="8ea0" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">所有的构建模块都完成了，现在来配置我们的自动缩放组。在EC2控制台的“<strong class="kw iu">自动缩放</strong>菜单选项下，选择“<strong class="kw iu">自动缩放组</strong>”。然后点击<strong class="kw iu">创建自动缩放组</strong>。</p><p id="9ec1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在步骤1中，给你的自动缩放组命名，并选择“<strong class="kw iu">启动模板</strong>”。版本应该是“<strong class="kw iu">默认(1) </strong>”如果你正在遵循这个教程。然后点击<strong class="kw iu">下一个</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/feeb2d0677457f75e58d47f8b1bd10d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-hJBMVUcRHqSYDeWACL9hw.png"/></div></div></figure><p id="4a57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在步骤2中，选择“<strong class="kw iu">坚持启动模板</strong>”。然后单击将在其中创建实例的VPC和子网。它应该位于部署模板实例的同一个VPC和子网中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/20854cdab0f32292fb299f25e2c54391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gbLOSAy76PmagTn0j8fZdw.png"/></div></div></figure><p id="3bc1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第3步中，您需要"<strong class="kw iu">启用负载平衡</strong>，并选择"<strong class="kw iu">应用负载平衡器或网络负载平衡器</strong>"。这是我们添加之前创建的目标群体的重要部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/d37cdfb96c24280cfb4761cfd98dd43c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f5omyY0DQHpQjonU1Y3eTw.png"/></div></div></figure><p id="f8d2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第4步中，您将在这里设置“<strong class="kw iu">期望容量</strong>”、“<strong class="kw iu">最小容量</strong>和“<strong class="kw iu">最大容量</strong>”。对于本教程，我将从1开始作为最小值，并允许在需要时创建一个额外的实例。</p><p id="4716" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您还可以在这里配置您的扩展策略。您需要选择“<strong class="kw iu">目标跟踪比例策略</strong>”。有几个选项可以触发自动扩展，例如CPU、吞吐量、请求等。我真的不认为CPU是一个在现实世界中使用的好指标。请求数量可能更合理，但是我在这里使用CPU，因为我能够"<strong class="kw iu">强调</strong>"我们的实例并触发自动缩放。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/509911483b3447b0ed902d33779b8ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FoRU70z1c86YU93C3dVr9g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/f74a20c7eae84795d59fca2d885ad8ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hpB7aFFnsrz1P16btEMFfQ.png"/></div></div></figure><p id="09ea" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第5步，您可以使用<a class="ae lq" href="http://console.aws.amazon.com/sns" rel="noopener ugc nofollow" target="_blank"> AWS简单通知服务</a> ( <a class="ae lq" href="http://console.aws.amazon.com/sns" rel="noopener ugc nofollow" target="_blank"> SNS </a>)配置电子邮件通知。这是本教程的范围，但在现实世界中实现这一点是个好主意。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/2561b2c7a39733fef8f87bd6e3fc854a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZHYD0qrRNHJbpdwFz1mEg.png"/></div></div></figure><p id="41c4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在步骤6中，您可以选择配置标签。我通常喜欢包含一个“<strong class="kw iu">项目</strong>”标签，它可以让你在计费时正确地识别它，但是我现在不包含它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/723e20a337514c51d88857c354409c0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2i3xWdf9yG5hsWNfDPROtQ.png"/></div></div></figure><p id="01ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第7步，您将检查您的所有配置，并单击“<strong class="kw iu">创建自动缩放组</strong>”。</p><h1 id="af40" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">第六步:尝试一下…</h1><p id="e94c" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">现在你可能会觉得这很奇怪…为什么一个实例已经启动了，而我们只要求它以10%以上的CPU创建1并扩展到2？在创建自动缩放组后的5分钟内，也不应该添加额外的实例。原因是我们在开始时为AMI创建的初始模板实例不包括在自动缩放管理中。AWS auto scaling现在正在提供第一个受管实例。这意味着我们可以终止我们创建的第一个实例，因为它不在自动缩放范围内。就AWS自动缩放而言，这是我们最小的第一个实例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/72ff4f402a1912b290b6c55865a8b807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R3V6lOLygUU2X-XP70PrPQ.png"/></div></div></figure><p id="b8a8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们看看我们的目标组，它将由我们提供的负载平衡器配置(不在本教程中)，我们可以看到新的自动伸缩实例被自动添加到目标组。我们还可以在那里看到我们的初始模板实例。因此，这证明了当一个实例被启动时，它将被自动添加到目标组或从目标组中删除。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/642938144d7fbd73ab149653b4d250e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qq9zNVbCC3BNIoNsw71--Q.png"/></div></div></figure><p id="7a8c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们看看我们的自动缩放组，有两个主要的兴趣点。“<strong class="kw iu">实例</strong>”显示它已经提供了2个实例中的1个。“<strong class="kw iu">活动史</strong>进一步证实了这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/b7cf422e1b5dfa8e5e698d4f73a9ab76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2X42Y267pYJhy8TLGnm4mQ.png"/></div></div></figure><p id="e195" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可能已经注意到在本教程的开始，我在我的Ubuntu实例中安装了“<strong class="kw iu"> stress </strong>”。这将允许我加载实例来触发自动缩放。这是一个非常简单的工具。我只是运行“<strong class="kw iu">压力-c 50 </strong>”然后等待。<strong class="kw iu">请注意，在自动缩放组创建后的前5分钟，它不会添加额外的实例</strong>。</p><p id="d949" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">确实，在运行我的实例超过50%的CPU 5分钟后，我能够确认自动伸缩启动了我的新实例。你会在下面看到“<strong class="kw iu">实例</strong>现在是2。如果您在5分钟后停止在实例上运行“<strong class="kw iu"> stress </strong>”，该实例将被删除。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/70c908ea75a1124377abfbe7f178acdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmOTUTSWEvU_xFa6zVBtHw.png"/></div></div></figure><h1 id="ac0c" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">迈克尔·惠特尔</h1><ul class=""><li id="45ca" class="mo mp it kw b kx mj la mk ld om lh on ll oo lp mt mu mv mw bi translated"><strong class="kw iu"> <em class="np">如果你喜欢这个，请</em> </strong> <a class="ae lq" href="https://whittle.medium.com/" rel="noopener"> <strong class="kw iu"> <em class="np">跟我上媒</em> </strong> </a></li><li id="fb7c" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated"><strong class="kw iu"> <em class="np">更多有趣的文章，请</em> </strong> <a class="ae lq" href="https://medium.com/trading-data-analysis" rel="noopener"> <strong class="kw iu"> <em class="np">关注我的刊物</em> </strong> </a></li><li id="477c" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated"><strong class="kw iu"> <em class="np">有兴趣合作吗？</em> </strong> <a class="ae lq" href="https://www.linkedin.com/in/miwhittle/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="np">我们来连线LinkedIn上的</em> </strong> </a></li><li id="49c7" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated"><strong class="kw iu"> <em class="np">支持我和其他媒体作者</em> </strong> <a class="ae lq" href="https://whittle.medium.com/membership" rel="noopener"> <strong class="kw iu"> <em class="np">在此报名</em> </strong> </a></li><li id="ebb8" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated"><strong class="kw iu"> <em class="np">请别忘了为文章鼓掌:)←谢谢！</em>T53】</strong></li></ul></div></div>    
</body>
</html>