<html>
<head>
<title>Kotlin: Prefer clarity over concise</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">科特林:喜欢清晰胜过简洁</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/kotlin-prefers-clarity-over-concise-a5a2088536b6?source=collection_archive---------2-----------------------#2020-04-10">https://levelup.gitconnected.com/kotlin-prefers-clarity-over-concise-a5a2088536b6?source=collection_archive---------2-----------------------#2020-04-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c9ed592e325b961d3ba202f0ba7862b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Oy61JQmSBWFlg2Jh"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图片由<a class="ae kf" href="https://unsplash.com/@element5digital" rel="noopener ugc nofollow" target="_blank">元素5数码</a>在<a class="ae kf" href="https://unsplash.com/photos/OyCl7Y4y0Bk" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上显示</figcaption></figure><p id="4168" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">K  otlin为我们提供了很多便利的工具，比如<code class="fe ln lo lp lq b">takeIf</code>等。它可以帮助使代码更加简洁，删除临时变量等。</p><div class="lr ls gp gr lt lu"><a href="https://medium.com/@elye.project/using-kotlin-takeif-or-takeunless-c9eeb7099c22" rel="noopener follow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">使用Kotlin takeIf(或takeUnless)</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">在科特林的标准函数中，有两个函数，即takeIf和takeUnless，乍一看，这是什么…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">medium.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi jz lu"/></div></div></a></div><p id="f20a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，如果我们对此投入过多，就会使代码的可读性变得复杂。</p><p id="6b42" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下面的为例。</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="98a3" class="mr ms it lq b gy mt mu l mv mw">savedStateHandle.get&lt;String&gt;(KEY).<em class="mx">takeIf </em><strong class="lq iu">{<br/>    </strong>!<strong class="lq iu">it</strong>.<em class="mx">isNullOrEmpty</em>()<br/><strong class="lq iu">}</strong>?.<em class="mx">let </em><strong class="lq iu">{ </strong>setValue(<strong class="lq iu">it</strong>) <strong class="lq iu">} </strong>?: removeValue()</span></pre><p id="598d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样做可能感觉很棒，因为它:</p><ul class=""><li id="c96d" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated">消除if-else</li><li id="624f" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated">将代码链接在一起</li><li id="de25" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated">消除临时变量</li></ul><p id="512f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，这种代码的缺点是:</p><ol class=""><li id="99b2" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nm ne nf ng bi translated">理解代码的流程需要一些时间。它掩盖了代码背后的简单逻辑。</li><li id="f6ae" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nm ne nf ng bi translated">如果我们反编译代码，它会生成大量的临时变量和逻辑，如下所示。</li></ol><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="512e" class="mr ms it lq b gy mt mu l mv mw">Object var2 = this.savedStateHandle.get("Key");<br/>boolean var3 = false;<br/>boolean var4 = false;<br/>String it = (String)var2;<br/>int var6 = false;<br/>CharSequence var7 = (CharSequence)it;<br/>boolean var8 = false;<br/>boolean var9 = false;<br/>String var10000 = (String)(var7 != null &amp;&amp; var7.length() != 0 ? var2 : null);<br/>if (var10000 != null) {<br/>   String var10 = var10000;<br/>   var3 = false;<br/>   var4 = false;<br/>   var6 = false;<br/>   Intrinsics.<em class="mx">checkExpressionValueIsNotNull</em>(var10, "it");<br/>   this.setValue(var10);<br/>} else {<br/>   this.removeValue();<br/>}</span></pre><h2 id="5a66" class="mr ms it bd nn no np dn nq nr ns dp nt kr nu nv nw kv nx ny nz kz oa ob oc od bi translated">简化版</h2><p id="534f" class="pw-post-body-paragraph kg kh it ki b kj oe kl km kn of kp kq kr og kt ku kv oh kx ky kz oi lb lc ld im bi translated">让我们回到旧的Java写作方式，简单的IF-ELSE。看起来没那么优雅，但是一看，一切都明白了。</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="19ed" class="mr ms it lq b gy mt mu l mv mw">val savedMessage = savedStateHandle.get&lt;String&gt;(KEY)<br/>if (savedMessage.<em class="mx">isNullOrBlank</em>()) {<br/>    removeValue()<br/>} else {<br/>    setValue(savedMessage)<br/>}</span></pre><p id="7bbb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，如果我们反编译，它看起来也很整洁，只有很少的生成变量。</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="9d4f" class="mr ms it lq b gy mt mu l mv mw">String savedMessage = (String)this.savedStateHandle.get("Key");<br/>CharSequence var3 = (CharSequence)savedMessage;<br/>boolean var4 = false;<br/>boolean var5 = false;<br/>if (var3 == null || StringsKt.<em class="mx">isBlank</em>(var3)) {<br/>   this.removeValue();<br/>} else {<br/>   this.setValue(savedMessage);<br/>}</span></pre><p id="34df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">使用</strong>T1】</p><p id="d465" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然，如果我们愿意，我们可以用<code class="fe ln lo lp lq b">when</code>对它进行一点改进，与IF-ELSE相比，缩短一行</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="63a1" class="mr ms it lq b gy mt mu l mv mw">val savedMessage = savedStateHandle.get&lt;String&gt;(KEY)<br/>when {<br/>    savedMessage.<em class="mx">isNullOrBlank</em>() -&gt; removeValue()<br/>    else -&gt; setValue(savedMessage)<br/>}</span></pre><p id="491b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">反编译的代码看起来也不错。</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="0642" class="mr ms it lq b gy mt mu l mv mw">String savedMessage = (String)this.savedStateHandle.get("Key");<br/>CharSequence var3 = (CharSequence)savedMessage;<br/>boolean var4 = false;<br/>boolean var5 = false;<br/>if (var3 == null || StringsKt.<em class="mx">isBlank</em>(var3)) {<br/>   this.removeValue();<br/>} else {<br/>   this.setValue(savedMessage);<br/>}</span></pre><p id="4127" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">使用</strong>T3】</p><p id="2b8d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是如果我们需要对临时变量<code class="fe ln lo lp lq b">savedMessage</code>进行编码，我们可以使用<code class="fe ln lo lp lq b">run</code>(或者其他作用域函数)来消除它。像下面这样…</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="2d28" class="mr ms it lq b gy mt mu l mv mw">savedStateHandle.get&lt;String?&gt;(KEY).<em class="mx">run </em><strong class="lq iu">{<br/>    </strong>when {<br/>        this.<em class="mx">isNullOrBlank</em>() -&gt; removeValue()<br/>        else -&gt; setValue(this)<br/>    }<br/><strong class="lq iu">}</strong></span></pre><p id="0455" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">反编译后的代码如下所示。没那么好，但还是比第一部好。</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="5b2f" class="mr ms it lq b gy mt mu l mv mw">Object var2 = this.savedStateHandle.get("Key");<br/>boolean var3 = false;<br/>boolean var4 = false;<br/>String $this$run = (String)var2;<br/>int var6 = false;<br/>CharSequence var7 = (CharSequence)$this$run;<br/>boolean var8 = false;<br/>boolean var9 = false;<br/>if (var7 == null || StringsKt.<em class="mx">isBlank</em>(var7)) {<br/>   this.removeValue();<br/>} else {<br/>   this.setValue($this$run);<br/>}</span></pre></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="669e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总之，在这些例子中，我最喜欢这个:</p><pre class="mj mk ml mm gt mn lq mo mp aw mq bi"><span id="6a7d" class="mr ms it lq b gy mt mu l mv mw">val savedMessage = savedStateHandle.get&lt;String&gt;(KEY)<br/>when {<br/>    savedMessage.<em class="mx">isNullOrBlank</em>() -&gt; removeValue()<br/>    else -&gt; setValue(savedMessage)<br/>}</span></pre><p id="0d2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">即使它不是最简洁的，并且需要一个临时变量，它仍然是最容易理解的。反编译的代码也很简洁。</p><p id="6364" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我的代码审查规则是:<strong class="ki iu">比简洁更喜欢清晰</strong></p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="5c2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读。你可以在这里查看我的其他话题<a class="ae kf" href="https://medium.com/@elye.project/" rel="noopener">。</a></p><p id="8a3b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关注我的<a class="ae kf" href="https://medium.com/@elye.project" rel="noopener"><em class="mx"/></a><em class="mx"/><a class="ae kf" href="https://twitter.com/elye_project" rel="noopener ugc nofollow" target="_blank"><em class="mx">Twitter</em></a><em class="mx"/><a class="ae kf" href="https://www.facebook.com/elyeproj/" rel="noopener ugc nofollow" target="_blank"><em class="mx">脸书</em> </a>或<a class="ae kf" href="https://www.reddit.com/user/elyeproj/" rel="noopener ugc nofollow" target="_blank"> <em class="mx"> Reddit </em> </a>获取移动开发等相关话题的小技巧和学习。~Elye~</p><figure class="mj mk ml mm gt ju"><div class="bz fp l di"><div class="oq or l"/></div></figure></div></div>    
</body>
</html>