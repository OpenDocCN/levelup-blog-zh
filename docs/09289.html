<html>
<head>
<title>How to Break Your Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何破解你的代码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-break-your-code-ef64620df26a?source=collection_archive---------11-----------------------#2021-07-23">https://levelup.gitconnected.com/how-to-break-your-code-ef64620df26a?source=collection_archive---------11-----------------------#2021-07-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="fb7e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Python中单元测试的快速介绍</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/00ca14030b33960aca0e22cc19ba4047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q8pJauNgreqIH91A"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Joshua Woroniecki 在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9f7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://media.giphy.com/media/Jy51gZnlPcAFi/giphy.gif" rel="noopener ugc nofollow" target="_blank">最好在用户之前发现程序中的错误，这是一条举世公认的真理。</a></p><p id="ab6e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://www.reddit.com/r/Jokes/comments/a4a4jc/a_software_qa_engineer_walks_into_a_bar/" rel="noopener ugc nofollow" target="_blank">正如一个古老的编程笑话所说:</a>一个程序员走进一家酒吧，点了一杯啤酒。99瓶啤酒。0.999999啤酒。点了0瓶啤酒。点了一只鬣蜥。</p><p id="cc3c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后一个顾客走进来，问洗手间在哪里——整个酒吧突然着火了。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">经由吉菲和tenor.com</figcaption></figure><p id="a2ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当然，当用户输入任何数字时，您的代码都会运行——但是如果他们输入一串无意义的字母呢？一个随机符号？什么都没有？如果您希望程序打开的文件打不开，或者被重命名了，该怎么办？<em class="lh">如果顾客问洗手间在哪里怎么办？</em></p><p id="b18a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文解释了使用Python中的unittest进行单元测试的基础知识——该做的事、不该做的事和请不要做的事。</p><p id="3ec5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们开始吧。(记住:永远在吧台后面放一个灭火器。)</p></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><h1 id="7c08" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">探索性测试与单元测试</h1><p id="5eda" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">如果你正在读这篇文章，很可能你a)以前写过一个程序，b)已经对它做过探索性的测试。这意味着你已经输入了一个值到一个函数中，看看输出会是什么。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ms lg l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">via Giphy原件</figcaption></figure><p id="bf13" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你的程序很小，探索性测试是很棒的。</p><p id="77db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，如果你正在编写一个更复杂的程序，并且希望它是“厨师之吻”的完美之作，你可能会想对你的程序进行一些更结构化的测试，看看到底哪里出错了。</p><p id="70e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就是<a class="ae le" href="https://docs.python.org/3/library/unittest.html" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">unittest</strong></a><strong class="js iu"/>出现的原因。</p><p id="789e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它是一个内置的Python框架和测试运行器，这意味着它为我们构造自动测试提供了工具。它也很快——通常在几分之一秒内运行多个测试——并在测试失败时提供有用的反馈。</p><p id="05d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好了，介绍够了。我们去做测试吧。</p><h1 id="c875" class="lp lq it bd lr ls mt lu lv lw mu ly lz ma mv mc md me mw mg mh mi mx mk ml mm bi translated">让我们从测试一些基本功能开始。</h1><p id="8d7d" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">我们将这三个函数保存为一个模块(记住，模块只是一个Python文件)。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="53ca" class="nd lq it mz b gy ne nf l ng nh"><strong class="mz iu">#1) Returns x raised to the power of y<br/></strong>def raise_to(x, y):<br/>    return x ** y</span><span id="64d1" class="nd lq it mz b gy ni nf l ng nh"><strong class="mz iu">#2) Returns the result of x divided by y<br/></strong>def divide_by(x, y):<br/>    return x / y</span><span id="e8d6" class="nd lq it mz b gy ni nf l ng nh"><strong class="mz iu">#3) Returns a string created by concatenating first_name and last_name</strong><br/>def concat_names(first_name, last_name):<br/>    return first_name + last_name</span></pre><p id="d851" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> **注意:</strong>不要忘记将所有文件保存在同一个文件夹/目录中！**</p><h1 id="4b22" class="lp lq it bd lr ls mt lu lv lw mu ly lz ma mv mc md me mw mg mh mi mx mk ml mm bi translated">现在，让我们测试这些功能。</h1><h2 id="9c34" class="nd lq it bd lr nj nk dn lv nl nm dp lz kb nn no md kf np nq mh kj nr ns ml nt bi translated">步骤1)创建一个测试模块</h2><p id="f2e4" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">创建一个新的Python文件，并使用以下命名约定保存它:<strong class="js iu"> test_filename.py. </strong>(如果没有这个‘test _’前缀，模块将不会按照我们想要的方式运行。)</p><h2 id="dec7" class="nd lq it bd lr nj nk dn lv nl nm dp lz kb nn no md kf np nq mh kj nr ns ml nt bi translated">步骤2)导入单元测试和测试模块</h2><p id="a1ce" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">接下来，我们需要导入两个模块:unittest和我们的测试模块。(我们的模块叫做‘project . py’，这就是我们导入‘project’的原因。)</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="6b61" class="nd lq it mz b gy ne nf l ng nh">import unittest<br/>import project</span></pre><h2 id="185a" class="nd lq it bd lr nj nk dn lv nl nm dp lz kb nn no md kf np nq mh kj nr ns ml nt bi translated">步骤3)创建一个从unittest继承的类。测试案例</h2><p id="7e0a" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated"><strong class="js iu">为什么？</strong>这允许我们使用unittest的所有酷的<a class="ae le" href="https://www.youtube.com/watch?v=6tNS--WetLI&amp;t=1438s" rel="noopener ugc nofollow" target="_blank">测试特性</a>。测试用例必须提供。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="928f" class="nd lq it mz b gy ne nf l ng nh">class ExampleTest(unittest.TestCase)</span></pre><h2 id="15bd" class="nd lq it bd lr nj nk dn lv nl nm dp lz kb nn no md kf np nq mh kj nr ns ml nt bi translated">步骤4)使用“assertEqual”关键字创建测试用例</h2><p id="65bb" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">因为我们有三个函数要测试，所以我们将创建总共九个测试用例(每个函数三个)——都使用特殊的‘assert equal’关键字。</p><p id="6023" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Python在unittest中有几个内置的assert关键字，允许我们测试给定的语句是否为真。你可以在这里看到它们的完整列表。</p><p id="c8e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于我们的第一个测试用例，我们将测试我们的“raise_to”函数。记住，这个函数应该把x提升到y的值。</p><p id="f35e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是我们将使用的通用格式:</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="3394" class="nd lq it mz b gy ne nf l ng nh">def test_[functionName](self):<br/>      self.assertEqual(filename.functionName(argument1, argument2), expectedResult)</span></pre><p id="cdaa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您以前使用过面向对象编程(OOP ),这种格式可能看起来很熟悉。这是因为unittest创建了TestCast类的一个实例——这就是它将“self”作为参数的原因。</p><h2 id="b362" class="nd lq it bd lr nj nk dn lv nl nm dp lz kb nn no md kf np nq mh kj nr ns ml nt bi translated">关于创建测试用例的注释</h2><p id="1341" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">这是你想仔细考虑如果你的代码中有一个错误，什么会影响你的程序的地方。例如，在下面的代码中，我们的测试用例断言，如果我们将“3”和“2”作为参数传递给raise_to函数，该函数应该返回9。或者，如果你把两个负数相乘，结果应该是正数。</p><p id="f49e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了提高效率，您可以一次运行多个测试用例。这里，我们运行三个测试用例:</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="9d5a" class="nd lq it mz b gy ne nf l ng nh"><strong class="mz iu"># Define our class<br/></strong>class TestProject(unittest.TestCase):</span><span id="ac38" class="nd lq it mz b gy ni nf l ng nh"><strong class="mz iu">#Create our testcase<br/>        </strong>def test_raise_to(self):<br/>        self.assertEqual(project.raise_to(3, 2), 9)<br/>        self.assertEqual(project.raise_to(4, 0), 1)<br/>        self.assertEqual(project.raise_to(4, -2), 0.0625)</span></pre><p id="e943" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就个人而言，我喜欢在IDE中运行测试，但是您也可以使用命令提示符。(如果你想走后一条路，我强烈推荐科里·斯查费的这篇教程<a class="ae le" href="https://www.youtube.com/watch?v=6tNS--WetLI" rel="noopener ugc nofollow" target="_blank">。)</a></p><h2 id="e678" class="nd lq it bd lr nj nk dn lv nl nm dp lz kb nn no md kf np nq mh kj nr ns ml nt bi translated">现在，让我们运行我们的第一个测试！</h2><p id="7c42" class="pw-post-body-paragraph jq jr it js b jt mn jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn im bi translated">为此，只需像在IDE中一样运行代码。在我们的例子中，下面是测试运行程序返回的内容:</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="d0eb" class="nd lq it mz b gy ne nf l ng nh">.<br/>__________________________________<br/>Ran 1 test in 0.001s</span><span id="1b28" class="nd lq it mz b gy ni nf l ng nh">OK</span></pre><p id="23c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这意味着我们的测试通过了——我们的功能正常工作！</p><p id="8cdd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看，如果我们改变测试用例，使其中一个失败，会发生什么。我们将更新我们的测试用例，如果4和2分别是我们的x和y参数，我们的输出应该是20。</p><p id="775e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是我们运行测试时发生的情况:</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="7871" class="nd lq it mz b gy ne nf l ng nh">F<br/>====================================================================<br/>FAIL: test_raise_to (__main__.TestProject)<br/>--------------------------------------------------------------------<br/>Traceback (most recent call last):<br/>  File "/Applications/test_example.py", line 6, in test_raise_to<br/>    self.assertEqual(project.raise_to(4, 2), 20)<br/>AssertionError: 16 != 20</span><span id="f0b7" class="nd lq it mz b gy ni nf l ng nh">--------------------------------------------------------------------<br/>Ran 1 tests in 0.001s</span><span id="c0c2" class="nd lq it mz b gy ni nf l ng nh">FAILED (failures=1)</span></pre><p id="d276" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">测试运行人员不仅告诉我们a)问题在哪里(哪个断言失败了)，还告诉我们为什么(16！= 20).这是快速有效隔离问题的好方法。</p><p id="6ac6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是我们最终的测试模块代码:</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="e72b" class="nd lq it mz b gy ne nf l ng nh"><strong class="mz iu"># Import modules</strong></span><span id="71b6" class="nd lq it mz b gy ni nf l ng nh">import unittest<br/>import project</span><span id="c071" class="nd lq it mz b gy ni nf l ng nh"><strong class="mz iu"># Define our class</strong></span><span id="f433" class="nd lq it mz b gy ni nf l ng nh">class TestProject(unittest.TestCase):<br/>    def test_raise_to(self):<br/>        self.assertEqual(project.raise_to(3, 2), 9)<br/>        self.assertEqual(project.raise_to(4, 0), 1)<br/>        self.assertEqual(project.raise_to(4, -2), 0.0625)</span><span id="eca2" class="nd lq it mz b gy ni nf l ng nh">def test_divide_by(self):<br/>        self.assertEqual(project.divide_by(9, 3), 3)<br/>        self.assertEqual(project.divide_by(-1, 1), -1)<br/>        self.assertEqual(project.divide_by(-1, -2), 0.5)</span><span id="b077" class="nd lq it mz b gy ni nf l ng nh">def test_concat_names(self):<br/>        self.assertEqual(project.concat_names('Jay', 'Reyes'), 'JayReyes')<br/>        self.assertEqual(project.concat_names('Elina', 'Chen'), 'ElinaChen')<br/>        self.assertEqual(project.concat_names('Cori', 'Malone'), 'CoriMalone')</span><span id="7425" class="nd lq it mz b gy ni nf l ng nh">if __name__ == "__main__":<br/>    unittest.main()</span></pre></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><p id="0a17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">和往常一样，学习单元测试的最好方法是实验——用你自己的代码做实验！这是一个很好的方法来找出你自己知识中的差距，并更深入地理解这个概念。</p><p id="b733" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想了解更多关于unittest的知识，我强烈建议查看下面的参考资料。</p><p id="c7e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">科里·斯查费视频:</strong> <a class="ae le" href="https://www.youtube.com/watch?v=6tNS--WetLI" rel="noopener ugc nofollow" target="_blank"> Python教程:用unittest模块对你的代码进行单元测试</a></p><p id="569e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Python.org文档 : <a class="ae le" href="https://docs.python.org/3/library/unittest.html" rel="noopener ugc nofollow" target="_blank">用unittest进行单元测试</a></p><p id="364c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">真正的Python教程</strong>:<a class="ae le" href="https://realpython.com/python-testing/" rel="noopener ugc nofollow" target="_blank">Python测试入门</a></p><p id="7382" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">祝你好运，并快乐编码！</p></div></div>    
</body>
</html>