<html>
<head>
<title>MobX for Angular and Ionic Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向角度和离子应用的MobX</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-manage-state-in-ionic-2-apps-with-mobx-df659de6a8aa?source=collection_archive---------3-----------------------#2019-01-16">https://levelup.gitconnected.com/how-to-manage-state-in-ionic-2-apps-with-mobx-df659de6a8aa?source=collection_archive---------3-----------------------#2019-01-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e6d4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">本教程涵盖了在Angular和Ionic 3 (v2+)应用程序中使用MobX管理状态</h2></div><p id="015c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在本教程中创建的Ionic应用程序是一个简单的生日追踪器。你可以<code class="fe lb lc ld le b">add</code> / <code class="fe lb lc ld le b">update</code> / <code class="fe lb lc ld le b">delete</code>生日，它还会显示当天人的生日。</p><h1 id="194b" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">MobX是什么？</h1><p id="d1b8" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">MobX是一个帮助您管理应用程序状态的库，重点是简单性。与Redux相比，MobX的一个优势是它不需要那么多样板代码。</p><p id="bdf4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MobX和Redux都是由React社区的成员开发的，用于管理React应用程序中的状态，但两者都可以在用其他框架(如Angular或Vue)构建的应用程序中使用。</p><p id="906f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了理解MobX，在阅读本教程时最好记住它的理念:</p><blockquote class="mc"><p id="4070" class="md me iq bd mf mg mh mi mj mk ml la dk translated"><strong class="ak"> <em class="mm">任何可以从应用程序状态中派生出来的东西，都应该被派生出来。自动地。</em> </strong></p></blockquote><h1 id="3248" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw mn jx lr jz mo ka lt kc mp kd lv lw bi translated">商店</h1><p id="4081" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">使用MobX时的一个<a class="ae mq" href="https://mobx.js.org/best/store.html" rel="noopener ugc nofollow" target="_blank">良好实践</a>是将任何管理状态的逻辑移出组件，并移入一个<strong class="kh ir">存储库</strong>。例如，在我们的应用程序中，商店将包含生日数组。这不是必需的——您仍然可以在组件中管理状态，但是在商店中这样做更具可伸缩性。</p><p id="618b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让MobX检测状态的变化，我们需要告诉它要跟踪哪些属性。我们可以通过使用以下装饰器来做到这一点:<code class="fe lb lc ld le b">@observable</code>和<code class="fe lb lc ld le b">@computed</code>。</p><h2 id="1e28" class="mr lg iq bd lh ms mt dn ll mu mv dp lp ko mw mx lr ks my mz lt kw na nb lv nc bi translated">@可观察</h2><p id="7c36" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated"><code class="fe lb lc ld le b">@observable</code>应该用于可以改变的属性。例如，在这个应用程序中，我们将在商店中有一个生日对象数组，我们可以在数组中添加/更新/删除项目。</p><p id="e2a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过用<code class="fe lb lc ld le b">@observable</code>修饰数组，MobX将自动检测数组中发生的变化，并提醒组件应该更新它们的视图。正因为如此，我们可以将<code class="fe lb lc ld le b">ChangeDetectionStrategy</code>设置为<code class="fe lb lc ld le b">OnPush</code>，这样会提高app的性能。</p><blockquote class="nd ne nf"><p id="f7d6" class="kf kg ng kh b ki kj jr kk kl km ju kn nh kp kq kr ni kt ku kv nj kx ky kz la ij bi translated"><em class="iq">为了更好地理解变化检测</em> <a class="ae mq" href="http://blog.angular-university.io/how-does-angular-2-change-detection-really-work/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">阅读本</em> </a> <em class="iq">。</em></p></blockquote><h2 id="3ab5" class="mr lg iq bd lh ms mt dn ll mu mv dp lp ko mw mx lr ks my mz lt kw na nb lv nc bi translated">@computed</h2><p id="7424" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated"><code class="fe lb lc ld le b">@computed</code>用于可以从<code class="fe lb lc ld le b">@observable</code>属性派生的属性。</p><p id="f858" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，今天的生日列表可以从所有生日列表中导出。我们可以为<code class="fe lb lc ld le b">birthdaysToday</code>属性编写一个getter方法，它将包含过滤所有生日列表所需的逻辑。</p><p id="85b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MobX将检测getter中使用了哪些<code class="fe lb lc ld le b">@observable</code>属性，当这些属性发生变化时，它将更新计算出的值。</p><h2 id="598c" class="mr lg iq bd lh ms mt dn ll mu mv dp lp ko mw mx lr ks my mz lt kw na nb lv nc bi translated">TL；速度三角形定位法(dead reckoning)</h2><p id="f55d" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">综上所述，您只需要在代码中添加一些装饰器，您的应用程序就会在状态改变时神奇地自我更新。</p><p id="0906" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">不相信我？让我们开始构建我们的应用程序，你会发现它真的那么简单！:)</strong></p><h1 id="f455" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">创建应用程序</h1><p id="7cea" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">我们将从创建Ionic 3应用程序开始</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="4126" class="mr lg iq le b gy ns nt l nu nv">$ ionic start ionic3-tutorial-mobx blank<br/>$ cd ionic3-tutorial-mobx</span></pre><h1 id="0bab" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">安装依赖项</h1><p id="18c7" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">我们需要安装<code class="fe lb lc ld le b">mobx</code>和<code class="fe lb lc ld le b">mobx-angular</code>。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="5e93" class="mr lg iq le b gy ns nt l nu nv">$ npm install mobx mobx-angular --save</span></pre><p id="c0cc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用的另一个依赖项是<code class="fe lb lc ld le b">angular-uuid</code>来生成唯一的id。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="f768" class="mr lg iq le b gy ns nt l nu nv">$ npm install angular2-uuid --save</span></pre><h1 id="1db8" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">定义生日</h1><p id="709a" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">我们先来定义一下什么是生日对象。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="8b06" class="mr lg iq le b gy ns nt l nu nv">// location: src/models/birthday.ts</span><span id="c57a" class="mr lg iq le b gy nw nt l nu nv">import { observable, computed } from 'mobx-angular';</span><span id="67cd" class="mr lg iq le b gy nw nt l nu nv">export class Birthday {  <br/>    id: string;<br/>    @observable name: string;<br/>    @observable date: string;</span><span id="b3d9" class="mr lg iq le b gy nw nt l nu nv">    constructor() { }</span><span id="feaa" class="mr lg iq le b gy nw nt l nu nv">    @computed get parsedDate(): Date {<br/>        return new Date(this.date);<br/>    }<br/>}</span></pre><p id="3b5b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如你所见，我用<code class="fe lb lc ld le b">@observable</code>装饰了<code class="fe lb lc ld le b">name</code>和<code class="fe lb lc ld le b">date</code>。用户可以更改这些值，因为有了<code class="fe lb lc ld le b">@observable</code>装饰器，MobX知道它需要跟踪这些属性的变化。</p><p id="33c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">date</code>将包含ISO格式的生日，但是我们稍后需要它作为一个实际的<code class="fe lb lc ld le b">Date</code>对象，所以我为它创建了一个<code class="fe lb lc ld le b">@computed</code>属性。</p><p id="1bb6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我之前提到过，这意味着每次<code class="fe lb lc ld le b">date</code>的值发生变化，MobX都会自动更新<code class="fe lb lc ld le b">parsedDate</code>的值。</p><h1 id="23b6" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">定义生日商店</h1><p id="efd4" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated"><code class="fe lb lc ld le b">BirthdayStore</code>将包含<code class="fe lb lc ld le b">birthdays</code>数组和在该数组中添加/更新/删除项的方法。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="915a" class="mr lg iq le b gy ns nt l nu nv">// location: src/stores/birthday.store.ts</span><span id="29bc" class="mr lg iq le b gy nw nt l nu nv">import { observable, action, computed } from 'mobx-angular';  <br/>import { Injectable } from "@angular/core";  <br/>import { Birthday } from '../models/birthday';  <br/>import { UUID } from 'angular2-uuid';</span><span id="2ec4" class="mr lg iq le b gy nw nt l nu nv">@Injectable()<br/>export class BirthdayStore {  <br/>    @observable birthdays: Birthday[] = [];</span><span id="08d9" class="mr lg iq le b gy nw nt l nu nv">    @action addBirthday(birthday: Birthday) {<br/>        birthday.id = UUID.UUID();<br/>        this.birthdays.push(birthday);<br/>    }</span><span id="c834" class="mr lg iq le b gy nw nt l nu nv">    @action deleteBirthday(birthday: Birthday) {<br/>        let index = this.birthdays.findIndex(b =&gt; b.id == birthday.id);<br/>        this.birthdays.splice(index, 1);<br/>    }</span><span id="48c6" class="mr lg iq le b gy nw nt l nu nv">    @action updateBirthday(birthday: Birthday) {<br/>        let index = this.birthdays.findIndex(b =&gt; b.id == birthday.id);<br/>        this.birthdays[index] = birthday;<br/>    }<br/>}</span></pre><p id="1906" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可能注意到我们正在使用另一个MobX装饰器:<code class="fe lb lc ld le b">@action</code>。您不需要使用这个装饰器，没有它MobX仍然可以工作，但是使用这个装饰器明确定义可观察属性的突变发生在哪里是一个好的实践。</p><blockquote class="nd ne nf"><p id="d508" class="kf kg ng kh b ki kj jr kk kl km ju kn nh kp kq kr ni kt ku kv nj kx ky kz la ij bi translated"><em class="iq">如果要强制使用</em> <code class="fe lb lc ld le b"><em class="iq">@action</em></code> <em class="iq">，可以告诉MobX到</em> <a class="ae mq" href="https://mobx.js.org/refguide/action.html" rel="noopener ugc nofollow" target="_blank"> <em class="iq">使用严格模式</em> </a> <em class="iq">。</em></p></blockquote><p id="e089" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的应用程序还需要今天的生日列表。由于这可以从<code class="fe lb lc ld le b">birthdays</code>数组中导出，我们将使它成为一个<code class="fe lb lc ld le b">@computed</code>属性，并将其添加到<code class="fe lb lc ld le b">BirthdayStore</code>。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="d816" class="mr lg iq le b gy ns nt l nu nv">@computed get birthdaysToday() {<br/>    let today = new Date();</span><span id="57a6" class="mr lg iq le b gy nw nt l nu nv">    return this.birthdays<br/>        .filter(b =&gt; b.parsedDate.getMonth() == today.getMonth() &amp;&amp;<br/>                     b.parsedDate.getDate() == today.getDate())<br/>        .map(b =&gt; ({<br/>            name: b.name,<br/>            age: today.getFullYear() - b.parsedDate.getFullYear()<br/>        }));<br/>}</span></pre><p id="1e57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MobX将知道getter使用了<code class="fe lb lc ld le b">birthdays</code>数组，因此每当该数组发生变化时，它将为<code class="fe lb lc ld le b">birthdaysToday</code>重新运行getter。</p><h1 id="b60d" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">构建用户界面</h1><p id="f576" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">我们将为我们的应用程序创建2个页面，一个显示生日列表(主页)，一个添加/编辑/删除生日(详细信息页面)。</p><h1 id="e28e" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">主页</h1><p id="d0dc" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">我们将首先实现模板<strong class="kh ir">home.html</strong>，它将显示两个列表:今天的生日和来自<code class="fe lb lc ld le b">BirthdayStore</code>的所有生日。</p><p id="b643" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让MobX自动更新页面，我们需要使用<code class="fe lb lc ld le b">*mobxAutorun</code>指令(由mobx-angular提供)。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="eb77" class="mr lg iq le b gy ns nt l nu nv">&lt;ion-header&gt;  <br/>  &lt;ion-navbar&gt;<br/>    &lt;ion-title&gt;<br/>      🎂 Birthdays 🎉<br/>    &lt;/ion-title&gt;<br/>    &lt;ion-buttons end&gt;<br/>      &lt;button ion-button (click)="showDetail()"&gt;<br/>          &lt;ion-icon name="add"&gt;&lt;/ion-icon&gt;<br/>      &lt;/button&gt;<br/>    &lt;/ion-buttons&gt;<br/>  &lt;/ion-navbar&gt;<br/>&lt;/ion-header&gt;</span><span id="a03a" class="mr lg iq le b gy nw nt l nu nv">&lt;ion-content class="home" *mobxAutorun&gt;  <br/>  &lt;ion-item-group&gt;<br/>    &lt;ion-item-divider color="light"&gt;{{ today | date:'fullDate' }}&lt;/ion-item-divider&gt;<br/>    &lt;ion-item *ngIf="store.birthdaysToday.length == 0"&gt;<br/>      &lt;div&gt;No cake 🎂 today...&lt;/div&gt;<br/>    &lt;/ion-item&gt;<br/>    &lt;ion-item *ngFor="let birthday of store.birthdaysToday"&gt;<br/>      {{ birthday.name }} is {{ birthday.age}} years old today 🎂<br/>    &lt;/ion-item&gt;<br/>  &lt;/ion-item-group&gt;</span><span id="7f40" class="mr lg iq le b gy nw nt l nu nv">  &lt;ion-item-group&gt;<br/>    &lt;ion-item-divider color="light"&gt;All Birthdays&lt;/ion-item-divider&gt;<br/>    &lt;button ion-item *ngFor="let birthday of store.birthdays" (click)="showDetail(birthday)"&gt;<br/>        &lt;div&gt;{{ birthday.name }}&lt;/div&gt;<br/>        &lt;div item-end&gt;{{ birthday.date | date:'yMMMMd' }}&lt;/div&gt;<br/>    &lt;/button&gt;<br/>  &lt;/ion-item-group&gt;<br/>&lt;/ion-content&gt;</span></pre><p id="a40b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<strong class="kh ir"> home.ts </strong>中，我们需要注入<code class="fe lb lc ld le b">BirthdayStore</code>以便能够在模板中使用它。</p><p id="0644" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如前所述，我们现在可以将变化检测策略设置为<code class="fe lb lc ld le b">OnPush</code>，这将提高我们应用程序的性能。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="7ad3" class="mr lg iq le b gy ns nt l nu nv">import { Component, ChangeDetectionStrategy } from "@angular/core";  <br/>import { ModalController, NavController } from 'ionic-angular';  </span><span id="ad4b" class="mr lg iq le b gy nw nt l nu nv">import { Birthday } from '../../models/birthday';  <br/>import { BirthdayStore } from '../../stores/birthday.store';  <br/>import { DetailsPage } from '../details/details';  </span><span id="e475" class="mr lg iq le b gy nw nt l nu nv">@Component({<br/>  selector: 'page-home',<br/>  templateUrl: 'home.html',<br/>  changeDetection: ChangeDetectionStrategy.OnPush<br/>})<br/>export class HomePage {  <br/>    public today = new Date();</span><span id="bbf8" class="mr lg iq le b gy nw nt l nu nv">    constructor(<br/>        public nav: NavController,<br/>        public modalCtrl: ModalController,<br/>        public store: BirthdayStore) {<br/>    }</span><span id="0399" class="mr lg iq le b gy nw nt l nu nv">    showDetail(birthday: Birthday) {  <br/>        let modal = this.modalCtrl.create(DetailsPage, { birthday: birthday });<br/>        modal.present();<br/>    }<br/>}</span></pre><h1 id="7161" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">详细信息页面</h1><p id="ad10" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">使用以下命令添加新页面:</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="829c" class="mr lg iq le b gy ns nt l nu nv">$ ionic g page details</span></pre><p id="0ad3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为<strong class="kh ir">details.html</strong>中的模板添加以下代码。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="ef9d" class="mr lg iq le b gy ns nt l nu nv">&lt;ion-header&gt;  <br/>  &lt;ion-navbar&gt;<br/>    &lt;ion-title&gt;{{ action }} Birthday&lt;/ion-title&gt;<br/>    &lt;ion-buttons end *ngIf="!isNew"&gt;<br/>      &lt;button ion-button (click)="delete()"&gt;<br/>          &lt;ion-icon name="trash"&gt;&lt;/ion-icon&gt;<br/>      &lt;/button&gt;<br/>    &lt;/ion-buttons&gt;<br/>  &lt;/ion-navbar&gt;<br/>&lt;/ion-header&gt;</span><span id="0239" class="mr lg iq le b gy nw nt l nu nv">&lt;ion-content padding class="details"&gt;  <br/>  &lt;ion-list inset&gt;<br/>    &lt;ion-item&gt;<br/>      &lt;ion-label&gt;Name&lt;/ion-label&gt;<br/>      &lt;ion-input text-right type="text" [(ngModel)]="birthday.name"&gt;&lt;/ion-input&gt;<br/>    &lt;/ion-item&gt;<br/>    &lt;ion-item&gt;<br/>      &lt;ion-label&gt;Birthday&lt;/ion-label&gt;<br/>      &lt;ion-datetime displayFormat="MMMM D, YYYY" pickerFormat="MMMM D YYYY" [(ngModel)]="birthday.date"&gt;&lt;/ion-datetime&gt;<br/>    &lt;/ion-item&gt;<br/>  &lt;/ion-list&gt;<br/>  &lt;button ion-button block (click)="save()"&gt;Save&lt;/button&gt;<br/>&lt;/ion-content&gt;</span></pre><p id="301d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将以下代码添加到<code class="fe lb lc ld le b">details.ts</code>。我们在这里再次注入了<code class="fe lb lc ld le b">BirthdayStore</code>，这样我们就可以调用添加/更新/删除方法。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="ada8" class="mr lg iq le b gy ns nt l nu nv">import { Component } from '@angular/core';  <br/>import { NavController, NavParams, ViewController } from 'ionic-angular';  <br/>import { Birthday } from '../../models/birthday';  <br/>import { BirthdayStore } from '../../stores/birthday.store';</span><span id="eeb5" class="mr lg iq le b gy nw nt l nu nv">@Component({<br/>    selector: 'page-details',<br/>    templateUrl: 'details.html',<br/>})<br/>export class DetailsPage {</span><span id="1d8e" class="mr lg iq le b gy nw nt l nu nv">    public birthday: Birthday = new Birthday();<br/>    public isNew: boolean;<br/>    public action: string;</span><span id="5ea9" class="mr lg iq le b gy nw nt l nu nv">    constructor(public navCtrl: NavController,<br/>        public viewCtrl: ViewController,<br/>        public navParams: NavParams,<br/>        public store: BirthdayStore) {<br/>    }</span><span id="de62" class="mr lg iq le b gy nw nt l nu nv">    ionViewWillEnter() {<br/>        let selectedBirthday = this.navParams.get('birthday');</span><span id="d39b" class="mr lg iq le b gy nw nt l nu nv">        if (selectedBirthday) {<br/>            this.birthday = Object.assign(new Birthday(), selectedBirthday);<br/>            this.isNew = false;<br/>            this.action = 'Edit';<br/>        }<br/>        else {<br/>            this.isNew = true;<br/>            this.action = 'Add';<br/>        }<br/>    }</span><span id="55c9" class="mr lg iq le b gy nw nt l nu nv">    save() {<br/>        if (this.isNew) {<br/>            this.store.addBirthday(this.birthday);<br/>        }<br/>        else {<br/>            this.store.updateBirthday(this.birthday);<br/>        }</span><span id="70ae" class="mr lg iq le b gy nw nt l nu nv">        this.dismiss();<br/>    }</span><span id="e07f" class="mr lg iq le b gy nw nt l nu nv">    delete() {<br/>        this.store.deleteBirthday(this.birthday);<br/>        this.dismiss();<br/>    }</span><span id="de92" class="mr lg iq le b gy nw nt l nu nv">    dismiss() {<br/>        this.viewCtrl.dismiss(this.birthday);<br/>    }<br/>}</span></pre><h1 id="db7a" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">配置所有依赖关系</h1><p id="1f4e" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">不要忘记修改<strong class="kh ir"> app.module.ts </strong>来导入<code class="fe lb lc ld le b">MobxAngularModule</code>并将<code class="fe lb lc ld le b">BirthdayStore</code>添加到提供者中。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="57c3" class="mr lg iq le b gy ns nt l nu nv">import { BrowserModule } from '@angular/platform-browser';  <br/>import { ErrorHandler, NgModule } from '@angular/core';  <br/>import { IonicApp, IonicErrorHandler, IonicModule } from 'ionic-angular';  <br/>import { SplashScreen } from '@ionic-native/splash-screen';  <br/>import { StatusBar } from '@ionic-native/status-bar';</span><span id="9230" class="mr lg iq le b gy nw nt l nu nv">import { MyApp } from './app.component';  <br/>import { HomePage } from '../pages/home/home';  <br/>import { DetailsPage } from './../pages/details/details';</span><span id="e05f" class="mr lg iq le b gy nw nt l nu nv">import { MobxAngularModule } from 'mobx-angular';  <br/>import { BirthdayStore } from '../stores/birthday.store';</span><span id="ca79" class="mr lg iq le b gy nw nt l nu nv">@NgModule({<br/>  declarations: [<br/>    MyApp,<br/>    HomePage,<br/>    DetailsPage<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    IonicModule.forRoot(MyApp),<br/>    MobxAngularModule<br/>  ],<br/>  bootstrap: [IonicApp],<br/>  entryComponents: [<br/>    MyApp,<br/>    HomePage,<br/>    DetailsPage<br/>  ],<br/>  providers: [<br/>    StatusBar,<br/>    SplashScreen,<br/>    {provide: ErrorHandler, useClass: IonicErrorHandler},<br/>    BirthdayStore<br/>  ]<br/>})<br/>export class AppModule {}</span></pre><h1 id="10f3" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">我们完了！</h1><p id="ae35" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">现在，您可以在浏览器中测试该应用程序。</p><pre class="nk nl nm nn gt no le np nq aw nr bi"><span id="94e2" class="mr lg iq le b gy ns nt l nu nv">$ ionic serve</span></pre><h1 id="be6d" class="lf lg iq bd lh li lj lk ll lm ln lo lp jw lq jx lr jz ls ka lt kc lu kd lv lw bi translated">MobX vs Redux</h1><p id="85a4" class="pw-post-body-paragraph kf kg iq kh b ki lx jr kk kl ly ju kn ko lz kq kr ks ma ku kv kw mb ky kz la ij bi translated">当您将本教程中的代码与<a class="ae mq" href="https://gonehybrid.com/a-beginners-guide-to-using-ngrx-in-an-ionic-2-app-part-1/" rel="noopener ugc nofollow" target="_blank"> ngrx (Redux)教程</a>中的代码进行比较时，您会发现使用MobX的代码要简单得多。</p><p id="ab08" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我真正做的只是在代码中添加一些装饰器和一个指令，仅此而已。神奇！:)你真的不需要学习很多新的东西，你仍然可以按照你想的方式编写你的代码。</p><p id="9647" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我提到过几次，MobX并不真的关心你如何构建你的代码，而Redux有非常清晰的定义规则，包括它的动作、reducers等等。</p><p id="af89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">实际上，我并不介意Redux，即使这意味着你最终会得到所有的样板代码。一旦您理解了Redux模式，您总是知道数据的任何更改发生在哪里。因此，如果其他开发人员需要开发你的应用程序，并且他们知道Redux，他们理解代码不会有任何问题。</p><p id="640e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用MobX，代码可以分散在整个应用程序中，它仍然可以工作，但可能不容易维护。完全由应用程序的开发者决定他们如何构建代码。</p><figure class="nk nl nm nn gt ny gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi nx"><img src="../Images/154a079eb495447c3a3b25bf3fe4acdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxRoqE8GxXLkJQK8EaL3uQ.jpeg"/></div></div></figure><p id="90f2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MobX和Redux的另一个很大的区别是MobX使用可变对象，而Redux则完全是关于不变性的。</p><p id="46dc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我认为对于复杂的应用程序，考虑使用Redux而不是MobX是一个好主意，但这真的取决于你自己在应用程序中使用哪一个的偏好。</p><p id="12ec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你们喜欢，并想分享一杯咖啡，然后请成为我的Patreon如下:</p><div class="of og gp gr oh oi"><a href="https://www.patreon.com/touqeeraslamkhan" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">Touqeer Aslam正在创建博客，从事开源工作，并为社区服务</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">今天就成为Touqeer Aslam的赞助人:在世界上最大的…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">www.patreon.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow od oi"/></div></div></a></div></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><figure class="nk nl nm nn gt ny gh gi paragraph-image"><a href="https://levelup.gitconnected.com"><div class="gh gi pe"><img src="../Images/ff5028ba5a0041d2d76d2a155f00f05e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JaoZbi7tTKJ5vL7i2OAYMQ.png"/></div></a></figure><div class="of og gp gr oh oi"><a href="https://gitconnected.com/learn/ionic" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">学习离子-最佳离子教程(2019) | gitconnected</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">6大离子教程-免费学习离子。课程由开发人员提交并投票，使您能够…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">gitconnected.com</p></div></div><div class="or l"><div class="pf l ot ou ov or ow od oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://gitconnected.com/learn/angular" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">学习角度-最佳角度教程(2019) | gitconnected</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">前47角教程-免费学习角。课程由开发人员提交和投票，使您能够…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">gitconnected.com</p></div></div><div class="or l"><div class="pg l ot ou ov or ow od oi"/></div></div></a></div></div></div>    
</body>
</html>