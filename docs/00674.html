<html>
<head>
<title>Repeating image gallery layout with CSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CSS重复图像库布局</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/repeating-gallery-layout-for-infinite-images-with-css-9de6ba6e37cf?source=collection_archive---------6-----------------------#2019-06-24">https://levelup.gitconnected.com/repeating-gallery-layout-for-infinite-images-with-css-9de6ba6e37cf?source=collection_archive---------6-----------------------#2019-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="df25" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">n-child魔术生成无限的CSS布局🎩</h2></div><p id="8dff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> TLDR: </strong>下面是最终的解决方案，它基于这篇<a class="ae le" href="https://alistapart.com/article/quantity-queries-for-css/" rel="noopener ugc nofollow" target="_blank"> A List Apart </a>的文章，并使用n:child伪选择器的组合来为任意数量的图像生成重复布局。因为我们不能使用CSS网格，因为还必须支持IE。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lk ll l"/></div></figure><h2 id="d2d3" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated">崩溃</h2><p id="ec18" class="pw-post-body-paragraph ki kj it kk b kl mf ju kn ko mg jx kq kr mh kt ku kv mi kx ky kz mj lb lc ld im bi translated">我最近参与的一个项目需要一个用户可以上传的图片库。这意味着未知的图像数量。然而，布局需要保持不变。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/525d0f5b1c4416fa9a043a93b9b86d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*PyqYggPsf59RHEcPRsBqmg.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">重复库布局</figcaption></figure><p id="5912" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以前我使用砖石库来动态生成布局。然而，它们可能会很慢，感觉有点笨拙，并且还需要运行许多样板代码。</p><p id="5bfe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实证明，你可以用一点时髦的CSS n-child逻辑来做到这一点。<a class="ae le" href="https://alistapart.com/article/quantity-queries-for-css/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>从一个单独的列表中详细解释了这个概念，并且真正推动了我所认为的CSS可能性的边界。</p><p id="3a5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最终解决方案<a class="ae le" href="https://codesandbox.io/s/qm7ylwzk6" rel="noopener ugc nofollow" target="_blank"/>，一开始可能看起来有点奇怪，但是一旦分解一点，逻辑就很简单了。</p><h2 id="f4db" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated"><strong class="ak">工作原理</strong></h2><p id="f40b" class="pw-post-body-paragraph ki kj it kk b kl mf ju kn ko mg jx kq kr mh kt ku kv mi kx ky kz mj lb lc ld im bi translated">设计的布局是一个3行的重复模式，总共有6个图像。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/39c80b1efdaaf9ef982302894f806e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*kioz-2oqaqXYUKFPNZPfhQ.png"/></div></figure><p id="acbb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，开始时，所有图像的默认宽度都是100%。这是较小屏幕的后备，也是第三行的图像。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/0f936b2533c6f760f994d6f0b5614ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*13f7eV6Y7WO5uChgQlf3_w.png"/></div></div></figure><p id="ae42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于布局的第一行，我们需要应用50%。对于每六个图像重复的这种模式，这可以通过从第一个(+1)和第二个(+2)孩子开始选择每第六个孩子(6n)来完成。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/f43e72441d47766f8ddca0022fcf4c84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtmwuCDY1Rc2pcS18O6bxw.png"/></div></div></figure><p id="27ea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该选择器将无限期地继续下去，每六幅图像选择第一个和第二个孩子。</p><p id="6e3c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于第二行，我们需要将第三个、第四个和第五个孩子作为目标，为他们提供33.33%的宽度。</p><p id="63b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这以相同的方式完成，并使用第n个子元素从第三、第四和第五个子元素开始选择每第六个元素。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/62b9286cb08943255d84f70757bd2916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2cLbZpoIty9u63afRA8d_g.png"/></div></div></figure><p id="6dc2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后一行只有一个100%宽度的图像，它将从我们在开始时声明的回退中继承。</p><p id="065a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">哇哦。🙌一个不错的重复库布局。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mx"><img src="../Images/e64d390c164abe5b5e8d7ced7214b646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wo-yaG6j1o9aUnNcpbA2gA.png"/></div></div></figure><p id="438c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嗯，差不多…有一些小的改进会让这个布局看起来更好。</p><h2 id="d506" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated">奇数个图像</h2><p id="1e34" class="pw-post-body-paragraph ki kj it kk b kl mf ju kn ko mg jx kq kr mh kt ku kv mi kx ky kz mj lb lc ld im bi translated">奇数个图像导致最后两行变成全幅，因为它们都被我们在开始定义的默认<code class="fe my mz na nb b">flex-grow</code>选中。</p><p id="0d46" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是因为倒数第二个图像将是我们的模式中的第六个，我们的默认目标是让它按照设计的100%宽度。奇数组图像中的最后一个图像将是我们的模式中的第一个图像，即50%。然而，全局<code class="fe my mz na nb b">flex-grow</code>将导致它也是全幅的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/98037ef2598bb523713356038d9917bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*TnWWHYXQ8vm0k853aN_bzA.png"/></div></figure><p id="9260" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了解决这个问题，我们需要检测是否有奇数个图像。我们可以通过检查最后一个元素是否是奇数<code class="fe my mz na nb b">:last-child:nth-child(odd)</code>以及之前的子元素是否是偶数<code class="fe my mz na nb b">picture:nth-last-child(2):nth-child(even)</code>来做到这一点，然后如果适用，给这两个元素添加50%的宽度。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/e9525c8f95c2da6d9b997b9b4f638a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzlywC-xxsKVDwsnir-QNg.png"/></div></div></figure><h2 id="446e" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated">只有3张图片</h2><p id="9686" class="pw-post-body-paragraph ki kj it kk b kl mf ju kn ko mg jx kq kr mh kt ku kv mi kx ky kz mj lb lc ld im bi translated">当只有3个图像时，最后一个图像是全幅的。虽然这在技术上是正确的(因为第一行是前两个50%宽度的图片)，但是如果我们把它们都放在一行，宽度为33%，看起来会更好。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/0e754d1ffc9ee3319ce106aa39751edd.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*3S2IyijB9Fqb9JTAs-6WHw.png"/></div></figure><p id="d843" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我们需要创建一个选择器，如果它只有三个子元素，那么它只针对元素。我们可以使用<code class="fe my mz na nb b">nth-last-of-type(3)</code>来做到这一点。当给定一个数字时，它将从最后一个孩子开始倒计数。然后我们可以通过使用<code class="fe my mz na nb b">nth-child(1)</code>来检查倒数第三个元素是否也是第一个子元素。如果两个选择器都匹配，我们就知道这个元素是第三个子元素。然后我们只需要做第二个和第一个</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/3458f2e83617e5cecc8fe36af9600455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdJooKliVK9EN6-t32gB1g.png"/></div></div></figure><h2 id="c29a" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated">5张图片</h2><p id="6161" class="pw-post-body-paragraph ki kj it kk b kl mf ju kn ko mg jx kq kr mh kt ku kv mi kx ky kz mj lb lc ld im bi translated">这只是一种边缘情况，只有五个图像会导致最后两个图像被我们用于奇数图像的选择器以及一行三个图像的选择器作为目标(如上)。但是我们可以用同样的方法解决这个问题，就像我们处理只有三个图像的集合一样。</p><p id="097a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该规则检查最后一个元素是否也是从开始算起的第五个元素<code class="fe my mz na nb b">nth-last-of-type(1):nth-child(5)</code>，我们对第三个和第四个孩子也是这样做的。一旦我们选择了最后三张图片，我们给它们33%的空间，把它们放在一行。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/0b41e500cc75eb1a81c82c0c85bab41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S7DxXn8aPoR2V5KqE2Tvgg.png"/></div></div></figure><p id="cd6c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而且，就是这样…🙌</p><h2 id="ea6a" class="lm ln it bd lo lp lq dn lr ls lt dp lu kr lv lw lx kv ly lz ma kz mb mc md me bi translated">包装它</h2><p id="abf5" class="pw-post-body-paragraph ki kj it kk b kl mf ju kn ko mg jx kq kr mh kt ku kv mi kx ky kz mj lb lc ld im bi translated">这确实花了我一段时间来理解它，但是我发现让它“点击”的最好方法就是反复试验。</p><p id="ad1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然这并不是每个图库布局的最佳解决方案，但它完全符合我们的项目需求，并且很好地尝试了CSS选择器，超越了我认为可能的范围。因为解决方案是纯CSS，所以它也是高性能的。</p><p id="afd0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望这有助于作为参考，解决方案或作为一个有趣的阅读✌️</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nc"><img src="../Images/6e05dc1bb3b4ad4166b5368e4879b701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*klzyChygVtInlUN1"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">José Alejandro Cuffia 在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div></div>    
</body>
</html>