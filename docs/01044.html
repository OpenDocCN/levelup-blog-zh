<html>
<head>
<title>Add Keyboard Shortcuts to Your Angular App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向Angular应用程序添加键盘快捷键</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/add-keyboard-shortcut-feature-to-your-angular-app-caed227d24cf?source=collection_archive---------2-----------------------#2019-10-28">https://levelup.gitconnected.com/add-keyboard-shortcut-feature-to-your-angular-app-caed227d24cf?source=collection_archive---------2-----------------------#2019-10-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d225faf0cf129990ffecea07699300e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDs3Np03TmzxkuIMt1TF3w.png"/></div></div></figure><p id="5979" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">键盘快捷键对用户来说是非常方便的功能。这使得他们无需点击鼠标就能完成工作，从而提高了工作效率。使用<a class="ae kz" href="https://www.npmjs.com/package/angular2-hotkeys" rel="noopener ugc nofollow" target="_blank">Angular 2-热键库</a>，可以轻松将键盘快捷键操作添加到Angular应用程序中。</p><p id="7b8f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我们将编写一个饮食跟踪器应用程序，让用户输入他们在给定的一天里摄入的卡路里。他们可以使用键盘快捷键来打开模式以添加条目，也可以删除最新的条目。为了启动这个项目，我们通过运行<code class="fe la lb lc ld b">npm i -g @angular/cli</code>来安装Angular CLI。接下来，我们通过键入以下命令运行Angular CLI来创建项目:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="14c7" class="lm ln it ld b gy lo lp l lq lr">ng new diet-tracker</span></pre><p id="4d88" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在设置向导中，我们选择包含路由并使用SCSS作为我们的CSS预处理器。</p><p id="6925" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我们安装一些软件包。我们需要上面提到的<a class="ae kz" href="https://www.npmjs.com/package/angular2-hotkeys" rel="noopener ugc nofollow" target="_blank"> angular2-hotkeys </a>包，用于样式化的Ngx-Bootstrap，以及用于在共享存储中存储数据的MobX。要安装它们，我们运行:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="e721" class="lm ln it ld b gy lo lp l lq lr">npm i ngx-bootatrap angular2-hotkeys mobx mobx-angular</span></pre><p id="f3ea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们创建我们的组件和服务。为此，我们运行:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="1d57" class="lm ln it ld b gy lo lp l lq lr">ng g component dietForm<br/>ng g component homePage<br/>ng g service diet<br/>ng g class calorie<br/>ng g class dietStore</span></pre><p id="f103" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们准备写一些代码。在<code class="fe la lb lc ld b">diet-form.component.html</code>中，我们将现有代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="cd75" class="lm ln it ld b gy lo lp l lq lr">&lt;form (ngSubmit)="save(dietForm)" #dietForm="ngForm"&gt;<br/>  &lt;div class="form-group"&gt;<br/>    &lt;label&gt;Date&lt;/label&gt;<br/>    &lt;input<br/>      type="text"<br/>      class="form-control"<br/>      placeholder="Date"<br/>      #date="ngModel"<br/>      name="date"<br/>      [(ngModel)]="form.date"<br/>      required<br/>      pattern="([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))"<br/>    /&gt;<br/>    &lt;div *ngIf="date?.invalid &amp;&amp; (date.dirty || date.touched)"&gt;<br/>      &lt;div *ngIf="date.errors.required"&gt;<br/>        Date is required.<br/>      &lt;/div&gt;<br/>      &lt;div *ngIf="date.invalid"&gt;<br/>        Date is invalid.<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="29ec" class="lm ln it ld b gy ls lp l lq lr">  &lt;div class="form-group"&gt;<br/>    &lt;label&gt;Amount of Calories&lt;/label&gt;<br/>    &lt;input<br/>      type="text"<br/>      class="form-control"<br/>      placeholder="Amount"<br/>      #amount="ngModel"<br/>      name="amount"<br/>      [(ngModel)]="form.amount"<br/>      required<br/>      pattern="^(\d*\.)?\d+$"<br/>    /&gt;<br/>    &lt;div *ngIf="amount?.invalid &amp;&amp; (amount.dirty || amount.touched)"&gt;<br/>      &lt;div *ngIf="amount.errors.required"&gt;<br/>        Amount is required.<br/>      &lt;/div&gt;<br/>      &lt;div *ngIf="amount.invalid"&gt;<br/>        Amount is invalid.<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="c6f4" class="lm ln it ld b gy ls lp l lq lr">  &lt;button class="btn btn-primary"&gt;Save&lt;/button&gt;<br/>&lt;/form&gt;</span></pre><p id="df58" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们添加了一个表单，让用户输入他们吃东西的日期和当天摄入的卡路里量。我们使用Angular的模板驱动表单验证来检查所有内容是否都已填写，验证日期是否为YYYY-MM-DD格式，并检查卡路里计数是否为非负数。我们还有一个保存按钮，当点击它时保存数据。该表单用于添加和编辑条目。</p><p id="6097" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来在<code class="fe la lb lc ld b">diet-form.component.ts</code>中，我们将现有代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="06b8" class="lm ln it ld b gy lo lp l lq lr">import { Component, OnInit, Output, EventEmitter, Input, SimpleChanges } from '<a class="ae kz" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { NgForm } from '<a class="ae kz" href="http://twitter.com/angular/forms" rel="noopener ugc nofollow" target="_blank">@angular/forms</a>';<br/>import { DietService } from '../diet.service';<br/>import { caloriesStore } from '../diet-store';<br/>import { Calorie } from '../calorie';</span><span id="7fbc" class="lm ln it ld b gy ls lp l lq lr"><a class="ae kz" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-diet-form',<br/>  templateUrl: './diet-form.component.html',<br/>  styleUrls: ['./diet-form.component.scss']<br/>})<br/>export class DietFormComponent implements OnInit {<br/>  form: any = &lt;any&gt;{};<br/>  <a class="ae kz" href="http://twitter.com/Output" rel="noopener ugc nofollow" target="_blank">@Output</a>('saved') saved = new EventEmitter();<br/>  <a class="ae kz" href="http://twitter.com/Input" rel="noopener ugc nofollow" target="_blank">@Input</a>() edit: boolean;<br/>  <a class="ae kz" href="http://twitter.com/Input" rel="noopener ugc nofollow" target="_blank">@Input</a>() selectedCalorie: any;<br/>  store = caloriesStore;</span><span id="6774" class="lm ln it ld b gy ls lp l lq lr">constructor(private dietService: DietService) { }</span><span id="1603" class="lm ln it ld b gy ls lp l lq lr">  ngOnInit() {<br/>  }</span><span id="2da6" class="lm ln it ld b gy ls lp l lq lr">  ngOnChanges(changes: SimpleChanges) {<br/>    this.form = Object.assign({}, this.selectedCalorie);<br/>  }</span><span id="1bee" class="lm ln it ld b gy ls lp l lq lr">  save(dietForm: NgForm) {<br/>    if (dietForm.invalid) {<br/>      return;<br/>    }<br/>    if (this.edit) {<br/>      this.dietService.editCaloriesEaten(this.form)<br/>        .subscribe(res =&gt; {<br/>          this.getCaloriesEaten()<br/>          this.saved.emit();<br/>        })<br/>    }<br/>    else {<br/>      this.dietService.addCaloriesEaten(this.form)<br/>        .subscribe(res =&gt; {<br/>          this.getCaloriesEaten()<br/>          this.saved.emit();<br/>        })<br/>    }<br/>  }</span><span id="70df" class="lm ln it ld b gy ls lp l lq lr">  getCaloriesEaten() {<br/>    this.dietService.getCaloriesEaten()<br/>      .subscribe((res: Calorie[]) =&gt; {<br/>        res = res.sort((a, b) =&gt; +new Date(a.date) - +new Date(b.date));<br/>        this.store.setCalories(res);<br/>      })<br/>  }</span><span id="27fe" class="lm ln it ld b gy ls lp l lq lr">}</span></pre><p id="57dc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个文件包含了我们在之前的模板中调用的函数，比如<code class="fe la lb lc ld b">save</code>函数。我们还有从主页获取数据的输入，以及向主页发出<code class="fe la lb lc ld b">saved</code>事件的输出。因为我们使用表单进行编辑，所以我们还需要用<code class="fe la lb lc ld b">selectedCalorie</code>输入来传递选中的条目，这样它就可以被编辑了。为了用<code class="fe la lb lc ld b">selectedCalorie</code>值更新<code class="fe la lb lc ld b">form</code>对象，每当<code class="fe la lb lc ld b">selectedCalorie</code>输入改变时，我们复制该值。</p><p id="ecf6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe la lb lc ld b">save</code>函数中，我们验证表单，并根据表单是用于添加还是编辑条目来调用不同的函数进行保存。通过调用<code class="fe la lb lc ld b">getCaloriesEaten</code>函数，最新的条目将被填充到我们的MobX存储中，一旦完成，将发出<code class="fe la lb lc ld b">saved</code>事件。</p><p id="e07c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来在<code class="fe la lb lc ld b">home-page.component.html</code>中，我们将代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="12bb" class="lm ln it ld b gy lo lp l lq lr">&lt;ng-template #addTemplate&gt;<br/>  &lt;div class="modal-header"&gt;<br/>    &lt;h2 class="modal-title pull-left"&gt;Add Calories Eaten&lt;/h2&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="modal-body"&gt;<br/>    &lt;app-diet-form (saved)="closeModals()"&gt;&lt;/app-diet-form&gt;<br/>  &lt;/div&gt;<br/>&lt;/ng-template&gt;</span><span id="2c9d" class="lm ln it ld b gy ls lp l lq lr">&lt;ng-template #editTemplate&gt;<br/>  &lt;div class="modal-header"&gt;<br/>    &lt;h2 class="modal-title pull-left"&gt;Edit Calories Eaten&lt;/h2&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="modal-body"&gt;<br/>    &lt;app-diet-form<br/>      [edit]="true"<br/>      (saved)="closeModals()"<br/>      [selectedCalorie]="selectedCalorie"<br/>    &gt;&lt;/app-diet-form&gt;<br/>  &lt;/div&gt;<br/>&lt;/ng-template&gt;</span><span id="03da" class="lm ln it ld b gy ls lp l lq lr">&lt;h1 class="text-center"&gt;Diet Tracker&lt;/h1&gt;</span><span id="6904" class="lm ln it ld b gy ls lp l lq lr">&lt;div class="btn-group" role="group"&gt;<br/>  &lt;button<br/>    type="button"<br/>    class="btn btn-secondary"<br/>    (click)="openAddModal(addTemplate)"<br/>  &gt;<br/>    Add Calories Eaten<br/>  &lt;/button&gt;<br/>&lt;/div&gt;</span><span id="cb50" class="lm ln it ld b gy ls lp l lq lr">&lt;div class="table-responsive"&gt;<br/>  &lt;br /&gt;<br/>  &lt;table class="table"&gt;<br/>    &lt;thead&gt;<br/>      &lt;tr&gt;<br/>        &lt;th scope="col"&gt;Date&lt;/th&gt;<br/>        &lt;th scope="col"&gt;Calories Eaten&lt;/th&gt;<br/>        &lt;th scope="col"&gt;Edit&lt;/th&gt;<br/>        &lt;th scope="col"&gt;Delete&lt;/th&gt;<br/>      &lt;/tr&gt;<br/>    &lt;/thead&gt;<br/>    &lt;tbody&gt;<br/>      &lt;tr *ngFor="let c of store.calories"&gt;<br/>        &lt;th scope="row"&gt;{{ c.date | date }}&lt;/th&gt;<br/>        &lt;td&gt;{{ c.amount }}&lt;/td&gt;<br/>        &lt;td&gt;<br/>          &lt;button<br/>            type="button"<br/>            class="btn btn-secondary"<br/>            (click)="openEditModal(editTemplate, c)"<br/>          &gt;<br/>            Edit<br/>          &lt;/button&gt;<br/>        &lt;/td&gt;<br/>        &lt;td&gt;<br/>          &lt;button<br/>            type="button"<br/>            class="btn btn-secondary"<br/>            (click)="deleteCaloriesEaten(c.id)"<br/>          &gt;<br/>            Delete<br/>          &lt;/button&gt;<br/>        &lt;/td&gt;<br/>      &lt;/tr&gt;<br/>    &lt;/tbody&gt;<br/>  &lt;/table&gt;<br/>&lt;/div&gt;</span></pre><p id="7694" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将创建用于添加、编辑和删除条目的按钮，以及用于显示条目的表格。此外，我们有用于添加和编辑条目的模态，我们分别用添加和编辑按钮打开它们。</p><p id="1593" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来在<code class="fe la lb lc ld b">home-page.component.ts</code>中，我们将现有代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="7995" class="lm ln it ld b gy lo lp l lq lr">import { Component, OnInit, TemplateRef, ViewChild } from '<a class="ae kz" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { BsModalService, BsModalRef } from 'ngx-bootstrap/modal';<br/>import { caloriesStore } from '../diet-store';<br/>import { DietService } from '../diet.service';<br/>import { HotkeysService, Hotkey } from 'angular2-hotkeys';<br/>import { Calorie } from '../calorie';</span><span id="65f4" class="lm ln it ld b gy ls lp l lq lr"><a class="ae kz" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-home-page',<br/>  templateUrl: './home-page.component.html',<br/>  styleUrls: ['./home-page.component.scss']<br/>})<br/>export class HomePageComponent implements OnInit {<br/>  addModalRef: BsModalRef;<br/>  editModalRef: BsModalRef;<br/>  selectedCalorie: any = &lt;any&gt;{};<br/>  store = caloriesStore;<br/>  <a class="ae kz" href="http://twitter.com/ViewChild" rel="noopener ugc nofollow" target="_blank">@ViewChild</a>('addTemplate', undefined) addTemplate: TemplateRef&lt;any&gt;;</span><span id="6e91" class="lm ln it ld b gy ls lp l lq lr">  constructor(<br/>    private modalService: BsModalService,<br/>    private dietService: DietService,<br/>    private _hotkeysService: HotkeysService<br/>  ) { }</span><span id="5fd0" class="lm ln it ld b gy ls lp l lq lr">  ngOnInit() {<br/>    this.getCaloriesEaten();<br/>    this.addHotKeys();<br/>  }</span><span id="7706" class="lm ln it ld b gy ls lp l lq lr">  addHotKeys() {<br/>    this._hotkeysService.add(new Hotkey(['ctrl+shift+a', 'ctrl+shift+d'], (event: KeyboardEvent, combo: string): boolean =&gt; {<br/>      if (combo === 'ctrl+shift+a') {<br/>        this.openAddModal(this.addTemplate);<br/>      }</span><span id="604e" class="lm ln it ld b gy ls lp l lq lr">      if (combo === 'ctrl+shift+d') {<br/>        if (Array.isArray(this.store.calories) &amp;&amp; this.store.calories[0]) {<br/>          this.deleteCaloriesEaten(this.store.calories[0].id);<br/>        }</span><span id="20c7" class="lm ln it ld b gy ls lp l lq lr">}<br/>      return false;<br/>    }));<br/>  }</span><span id="e94e" class="lm ln it ld b gy ls lp l lq lr">  getCaloriesEaten() {<br/>    this.dietService.getCaloriesEaten()<br/>      .subscribe((res: any[]) =&gt; {<br/>        res = res.sort((a, b) =&gt; +new Date(a.date) - +new Date(b.date));<br/>        this.store.setCalories(res);<br/>      })<br/>  }</span><span id="c83c" class="lm ln it ld b gy ls lp l lq lr">  openAddModal(template: TemplateRef&lt;any&gt;) {<br/>    this.addModalRef = this.modalService.show(template);<br/>  }</span><span id="8143" class="lm ln it ld b gy ls lp l lq lr">  openEditModal(template: TemplateRef&lt;any&gt;, calorie) {<br/>    this.editModalRef = this.modalService.show(template);<br/>    this.selectedCalorie = calorie;<br/>  }</span><span id="7988" class="lm ln it ld b gy ls lp l lq lr">  closeModals() {<br/>    this.addModalRef &amp;&amp; this.addModalRef.hide();<br/>    this.editModalRef &amp;&amp; this.editModalRef.hide();<br/>  }</span><span id="f51d" class="lm ln it ld b gy ls lp l lq lr">  deleteCaloriesEaten(id) {<br/>    this.dietService.deleteCaloriesEaten(id)<br/>      .subscribe((res: Calorie[]) =&gt; {<br/>        this.getCaloriesEaten();<br/>      })<br/>  }<br/>}</span></pre><p id="259a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们有<code class="fe la lb lc ld b">openAddModal</code>和<code class="fe la lb lc ld b">openEditModal</code>函数来打开添加和编辑模式。<code class="fe la lb lc ld b">closeModals</code>功能用于在<code class="fe la lb lc ld b">app-diet-form</code>组件中保存东西时关闭模态。<code class="fe la lb lc ld b">deleteCaloriesEaten</code>功能用于删除卡路里，<code class="fe la lb lc ld b">getCaloriesEaten</code>用于在页面加载和项目删除时获取条目。它还将项目放在我们的存储中，这样每个组件都可以访问它。</p><p id="35dd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们也有<code class="fe la lb lc ld b">addHotKeys</code>功能来添加热键到我们的应用程序，方便用户。<code class="fe la lb lc ld b">HotKeyService</code>来自angular2热键库。我们注入它，然后定义热键。我们定义了Ctrl+Shift+A来打开添加模式，定义了Ctrl+Shift+D组合来删除列表中的第一个条目。回调中的<code class="fe la lb lc ld b">return false</code>语句是为了防止事件冒泡。</p><p id="a8c4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe la lb lc ld b">app-routing.module.ts</code>中，我们输入:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="8169" class="lm ln it ld b gy lo lp l lq lr">import { NgModule } from '<a class="ae kz" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { Routes, RouterModule } from '<a class="ae kz" href="http://twitter.com/angular/router" rel="noopener ugc nofollow" target="_blank">@angular/router</a>';<br/>import { HomePageComponent } from './home-page/home-page.component';</span><span id="80c7" class="lm ln it ld b gy ls lp l lq lr">const routes: Routes = [<br/>  { path: '', component: HomePageComponent }<br/>];</span><span id="758c" class="lm ln it ld b gy ls lp l lq lr"><a class="ae kz" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>  imports: [RouterModule.forRoot(routes)],<br/>  exports: [RouterModule]<br/>})<br/>export class AppRoutingModule { }</span></pre><p id="f298" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是为了让用户在点击链接或输入URL时可以看到我们刚刚添加的页面。</p><p id="704f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来在<code class="fe la lb lc ld b">app.component.html</code>中，我们输入:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="5524" class="lm ln it ld b gy lo lp l lq lr">&lt;nav class="navbar navbar-expand-lg navbar-light bg-light"&gt;<br/>  &lt;a class="navbar-brand" routerLink="/"&gt;Diet Tracker&lt;/a&gt;<br/>  &lt;button<br/>    class="navbar-toggler"<br/>    type="button"<br/>    data-toggle="collapse"<br/>    data-target="#navbarSupportedContent"<br/>    aria-controls="navbarSupportedContent"<br/>    aria-expanded="false"<br/>    aria-label="Toggle navigation"<br/>  &gt;<br/>    &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;<br/>  &lt;/button&gt;</span><span id="e0c8" class="lm ln it ld b gy ls lp l lq lr">  &lt;div class="collapse navbar-collapse" id="navbarSupportedContent"&gt;<br/>    &lt;ul class="navbar-nav mr-auto"&gt;<br/>      &lt;li class="nav-item active"&gt;<br/>        &lt;a class="nav-link" routerLink="/"&gt;Home &lt;/a&gt;<br/>      &lt;/li&gt;<br/>    &lt;/ul&gt;<br/>  &lt;/div&gt;<br/>&lt;/nav&gt;</span><span id="a154" class="lm ln it ld b gy ls lp l lq lr">&lt;div class="page"&gt;<br/>  &lt;router-outlet&gt;&lt;/router-outlet&gt;<br/>&lt;/div&gt;</span></pre><p id="1853" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将链接添加到我们的页面，并公开<code class="fe la lb lc ld b">router-outlet</code>以便用户可以看到我们的页面。</p><p id="cfc2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后在<code class="fe la lb lc ld b">app.component.scss</code>中，我们添加:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="de5a" class="lm ln it ld b gy lo lp l lq lr">.page {<br/>  padding: 20px;<br/>}</span><span id="c87b" class="lm ln it ld b gy ls lp l lq lr">nav {<br/>  background-color: lightsalmon !important;<br/>}</span></pre><p id="81e4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这给我们的页面添加了填充，并改变了引导导航栏的颜色。</p><p id="4590" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe la lb lc ld b">app.module.ts</code>中，我们将现有代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="5a9d" class="lm ln it ld b gy lo lp l lq lr">import { BrowserModule } from '<a class="ae kz" href="http://twitter.com/angular/platform-browser" rel="noopener ugc nofollow" target="_blank">@angular/platform-browser</a>';<br/>import { NgModule } from '<a class="ae kz" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';</span><span id="82f2" class="lm ln it ld b gy ls lp l lq lr">import { AppRoutingModule } from './app-routing.module';<br/>import { AppComponent } from './app.component';<br/>import { HomePageComponent } from './home-page/home-page.component';<br/>import { DietFormComponent } from './diet-form/diet-form.component';<br/>import { ModalModule } from 'ngx-bootstrap/modal';<br/>import { FormsModule } from '<a class="ae kz" href="http://twitter.com/angular/forms" rel="noopener ugc nofollow" target="_blank">@angular/forms</a>';<br/>import { HttpClientModule } from '<a class="ae kz" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>/http';<br/>import { MobxAngularModule } from 'mobx-angular';<br/>import { HotkeyModule } from 'angular2-hotkeys';</span><span id="eca5" class="lm ln it ld b gy ls lp l lq lr"><a class="ae kz" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>  declarations: [<br/>    AppComponent,<br/>    HomePageComponent,<br/>    DietFormComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    AppRoutingModule,<br/>    ModalModule.forRoot(),<br/>    MobxAngularModule,<br/>    FormsModule,<br/>    HttpClientModule,<br/>    HotkeyModule.forRoot()<br/>  ],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</span></pre><p id="9569" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这增加了我们在应用程序中使用的组件、服务和库。</p><p id="3bb4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe la lb lc ld b">calorie.ts</code>中，我们添加:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="42ad" class="lm ln it ld b gy lo lp l lq lr">export class Calorie {<br/>    public date: string;<br/>    public amount: string;<br/>}</span></pre><p id="9fc3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这给我们的卡路里形式模型增加了种类。</p><p id="782b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后在<code class="fe la lb lc ld b">dietStore.ts</code>中，我们添加:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="04b2" class="lm ln it ld b gy lo lp l lq lr">import { observable, action } from 'mobx-angular';</span><span id="cd3a" class="lm ln it ld b gy ls lp l lq lr">class CaloriesStore {<br/>    <a class="ae kz" href="http://twitter.com/observable" rel="noopener ugc nofollow" target="_blank">@observable</a> calories = [];<br/>    <a class="ae kz" href="http://twitter.com/action" rel="noopener ugc nofollow" target="_blank">@action</a> setCalories(calories) {<br/>        this.calories = calories;<br/>    }<br/>}</span><span id="1519" class="lm ln it ld b gy ls lp l lq lr">export const caloriesStore = new CaloriesStore();</span></pre><p id="0311" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这就创建了MobX store来获取我们的组件并共享数据。每当我们在组件中调用<code class="fe la lb lc ld b">this.store.setCalories</code>时，我们设置这个商店中的卡路里数据，因为我们在它之前添加了<code class="fe la lb lc ld b">@action</code>装饰器。当我们在组件代码中调用<code class="fe la lb lc ld b">this.store.calories</code>时，我们总是从这个商店获取最新的值，因为它有<code class="fe la lb lc ld b">@observable</code>装饰器。</p><p id="f6c3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后在<code class="fe la lb lc ld b">diet.service.ts</code>中，我们将现有代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="c208" class="lm ln it ld b gy lo lp l lq lr">import { Injectable } from '<a class="ae kz" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { HttpClient } from '<a class="ae kz" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>/http';<br/>import { environment } from 'src/environments/environment';</span><span id="3212" class="lm ln it ld b gy ls lp l lq lr"><a class="ae kz" href="http://twitter.com/Injectable" rel="noopener ugc nofollow" target="_blank">@Injectable</a>({<br/>  providedIn: 'root'<br/>})<br/>export class DietService {</span><span id="a425" class="lm ln it ld b gy ls lp l lq lr">  constructor(private http: HttpClient) { }</span><span id="4634" class="lm ln it ld b gy ls lp l lq lr">  getCaloriesEaten() {<br/>    return this.http.get(`${environment.apiUrl}/calories`);<br/>  }</span><span id="f8f3" class="lm ln it ld b gy ls lp l lq lr">  addCaloriesEaten(data) {<br/>    return this.http.post(`${environment.apiUrl}/calories`, data);<br/>  }</span><span id="4489" class="lm ln it ld b gy ls lp l lq lr">  editCaloriesEaten(data) {<br/>    return this.http.put(`${environment.apiUrl}/calories/${data.id}`, data);<br/>  }</span><span id="cb8e" class="lm ln it ld b gy ls lp l lq lr">  deleteCaloriesEaten(id) {<br/>    return this.http.delete(`${environment.apiUrl}/calories/${id}`);<br/>  }<br/>}</span></pre><p id="3a8c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是为了让我们可以向后端发出HTTP请求，以获取、保存和删除用户的条目。</p><p id="9b52" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来在<code class="fe la lb lc ld b">environment.prod.ts</code>和<code class="fe la lb lc ld b">environment.ts</code>中，我们将现有代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="07e4" class="lm ln it ld b gy lo lp l lq lr">export const environment = {<br/>  production: true,<br/>  apiUrl: '<a class="ae kz" href="http://localhost:3000'" rel="noopener ugc nofollow" target="_blank">http://localhost:3000'</a><br/>};</span></pre><p id="60e8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将添加我们的API的URL。</p><p id="bcd8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，在<code class="fe la lb lc ld b">index.html</code>中，我们将代码替换为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="8dc0" class="lm ln it ld b gy lo lp l lq lr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;title&gt;Diet Tracker&lt;/title&gt;<br/>    &lt;base href="/" /&gt;</span><span id="68d8" class="lm ln it ld b gy ls lp l lq lr">&lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>    &lt;link rel="icon" type="image/x-icon" href="favicon.ico" /&gt;<br/>    &lt;link<br/>      href="<a class="ae kz" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css</a>"<br/>      rel="stylesheet"<br/>    /&gt;<br/>    &lt;script<br/>      src="<a class="ae kz" href="https://code.jquery.com/jquery-3.3.1.slim.min.js" rel="noopener ugc nofollow" target="_blank">https://code.jquery.com/jquery-3.3.1.slim.min.js</a>"<br/>      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"<br/>      crossorigin="anonymous"<br/>    &gt;&lt;/script&gt;<br/>    &lt;script<br/>      src="<a class="ae kz" href="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js</a>"<br/>      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"<br/>      crossorigin="anonymous"<br/>    &gt;&lt;/script&gt;<br/>    &lt;script<br/>      src="<a class="ae kz" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" rel="noopener ugc nofollow" target="_blank">https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js</a>"<br/>      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"<br/>      crossorigin="anonymous"<br/>    &gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;app-root&gt;&lt;/app-root&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="14e1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将引导CSS和JavaScript依赖项添加到我们的应用程序中，并更改标题。</p><p id="e472" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">做完所有工作，我们就可以运行<code class="fe la lb lc ld b">ng serve</code>来运行app了。</p><p id="0474" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了启动后端，我们首先通过运行<code class="fe la lb lc ld b">npm i json-server</code>来安装<code class="fe la lb lc ld b">json-server</code>包。然后，转到我们的项目文件夹并运行:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="9c31" class="lm ln it ld b gy lo lp l lq lr">json-server --watch db.json</span></pre><p id="e100" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe la lb lc ld b">db.json</code>中，将文本改为:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="d789" class="lm ln it ld b gy lo lp l lq lr">{<br/>  "calories": [<br/>  ]<br/>}</span></pre><p id="45ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以我们有了在可用的<code class="fe la lb lc ld b">requests.js</code>中定义的<code class="fe la lb lc ld b">calories </code>端点。</p><p id="2139" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">那么我们应该得到:</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d225faf0cf129990ffecea07699300e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDs3Np03TmzxkuIMt1TF3w.png"/></div></div></figure><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0ba8f100dc5b7628c2eb41c0c0e566fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64gXA7t42AR4PLgbK9G3Og.png"/></div></div></figure><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/dbb69aee379e747db2e3728a1850efcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLTo8dXFjU6r1gTcm9oAjQ.png"/></div></div></figure></div></div>    
</body>
</html>