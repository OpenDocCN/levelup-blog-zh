<html>
<head>
<title>Simple MVVM to Improve coding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">改进编码的简单MVVM</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/simple-mvvm-to-improve-coding-2eb06d0a5e7c?source=collection_archive---------12-----------------------#2022-07-03">https://levelup.gitconnected.com/simple-mvvm-to-improve-coding-2eb06d0a5e7c?source=collection_archive---------12-----------------------#2022-07-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="ef4a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">无束缚，简单，轻便，灵活</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/0d0079ebac2785f99240b8ca61dcaa76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yTFwI5n0Fmn3oOiS"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@romiem?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Rohit </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="5f9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从一个公式开始:</p><blockquote class="lf lg lh"><p id="f5d0" class="jq jr li js b jt ju jv jw jx jy jz ka lj kc kd ke lk kg kh ki ll kk kl km kn im bi translated">程序=数据结构+算法</p></blockquote><p id="4cb6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将数据作为输入、处理数据并在视图上显示数据的程序。</p><p id="4369" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个故事中，我分享了如何在项目中实现MVVM。这是我在几个项目中总结出来的。看完这个故事你可以知道:<strong class="js iu">一个简单的MVVM是如何实现的。</strong>在故事的结尾，有一个源代码的链接。</p><p id="5724" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="li">重要:这个故事可能比较主观，希望大家可以参考一下。</em></p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><p id="e978" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">demo的作用是什么？</p><p id="c6a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它可以:</p><ul class=""><li id="9438" class="lt lu it js b jt ju jx jy kb lv kf lw kj lx kn ly lz ma mb bi translated">显示图书列表</li><li id="6dab" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn ly lz ma mb bi translated">显示图书详细信息</li><li id="a5a9" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn ly lz ma mb bi translated">删除图书</li></ul><p id="c486" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它需要2页:</p><ul class=""><li id="d630" class="lt lu it js b jt ju jx jy kb lv kf lw kj lx kn ly lz ma mb bi translated">MainVC负责显示图书列表</li><li id="fd8a" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn ly lz ma mb bi translated">BookDetailVC负责显示图书的详细信息</li></ul><p id="9c3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这两个页面都将使用MVVM组织，但我将主要关注MainVC页面。</p><p id="6644" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">示例代码主要通过HTTP请求获取书籍相关的信息，然后显示在页面上。</p><p id="1529" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是应用程序的整体架构:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mh"><img src="../Images/8ee17d7c10329bd1561060c85b0aee32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hEj8Ux54YyQ4IZ8LdeQ_uA.png"/></div></div></figure></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><p id="f9d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">显示图书列表的事件流:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mi"><img src="../Images/0bbd45f4f850084050c29a299457007e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_B0u3c_FJG37wh-5j9LTsw.png"/></div></div></figure><ol class=""><li id="7fb5" class="lt lu it js b jt ju jx jy kb lv kf lw kj lx kn mj lz ma mb bi translated">当<code class="fe mk ml mm mn b">MainVC</code>收到系统事件<code class="fe mk ml mm mn b">ViewDidLoad</code>时，调用<code class="fe mk ml mm mn b">MainVM</code>；</li><li id="e08a" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><code class="fe mk ml mm mn b">MainVM</code>打电话给<code class="fe mk ml mm mn b">HTTPClient</code>获取图书清单；</li><li id="a0ef" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><code class="fe mk ml mm mn b">HTTPClient</code>通过网络请求数据并将其返回给<code class="fe mk ml mm mn b">MainVM</code></li><li id="d76c" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated">原始数据经过<code class="fe mk ml mm mn b">MainVM</code>处理后，会生成适合UI显示的数据；</li><li id="36f7" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated">在<code class="fe mk ml mm mn b">View</code>上更新和显示数据</li></ol><p id="f7be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里有一个非常重要的数据转换，<code class="fe mk ml mm mn b">MainVM</code>将原始数据转换成适合视图显示的数据。(在源代码中，从<code class="fe mk ml mm mn b">HttpClient.Book</code>到<code class="fe mk ml mm mn b">MainView.Info</code>)</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><p id="f084" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，用户点击屏幕的事件也可以是这样的(删书):</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mo"><img src="../Images/0f7a80c88df05021c7684466e6194db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBZEgLW8qGTQqR8XwroJzg.png"/></div></div></figure><p id="e833" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mn b">MainVM</code>负责将<code class="fe mk ml mm mn b">View Events</code>转换为外部发起的请求事件。最后更新视图。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><p id="71a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">您可以在源代码中获得更多详细信息:</strong> <a class="ae le" href="https://github.com/zhuyuping/SimpleMVVM" rel="noopener ugc nofollow" target="_blank">代码链接</a></p><p id="b322" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总结:</p><ul class=""><li id="fad1" class="lt lu it js b jt ju jx jy kb lv kf lw kj lx kn ly lz ma mb bi translated"><code class="fe mk ml mm mn b">Model</code>:存储各种形式的数据，像一个盒子。</li><li id="00af" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn ly lz ma mb bi translated"><code class="fe mk ml mm mn b">View</code>:像电脑显示器一样显示和互动</li><li id="3f73" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn ly lz ma mb bi translated"><code class="fe mk ml mm mn b">VC</code>:顶级业务控制，拥有<code class="fe mk ml mm mn b">View</code>和<code class="fe mk ml mm mn b">VM</code></li><li id="d924" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn ly lz ma mb bi translated"><code class="fe mk ml mm mn b">VM</code>:帮助<code class="fe mk ml mm mn b">VC</code>搬运重物，数据处理，将原始数据转换成适合视图显示的数据。()</li></ul><p id="72b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它们之间的通信通过直接调用方法和<code class="fe mk ml mm mn b">delegate</code>回调来完成。不再需要事件流绑定，也不需要依赖反应式编程库。<code class="fe mk ml mm mn b">View</code>和<code class="fe mk ml mm mn b">VM</code>互不依赖。这种模式水平扩展。</p><p id="aaaf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我把这种模式称为简单MVVM，它有以下优点:</p><ol class=""><li id="da86" class="lt lu it js b jt ju jx jy kb lv kf lw kj lx kn mj lz ma mb bi translated">简单。这就像是MVC的一个超集。开发者沟通更容易；</li><li id="05c2" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated">轻量级，低门槛。没有绑定操作。无需学习RxSwift</li><li id="40de" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated">要灵活。<code class="fe mk ml mm mn b">Views</code>可以重复使用。<code class="fe mk ml mm mn b">VM</code>可重复使用；</li></ol></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="493a" class="mp mq it bd mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm bi translated">请跟我来。让我们在接下来的帖子中见面。</h1><p id="7a62" class="pw-post-body-paragraph jq jr it js b jt nn jv jw jx no jz ka kb np kd ke kf nq kh ki kj nr kl km kn im bi translated">在我之前的故事中，我介绍了一些swift技巧和代码简单性的建议:</p><ol class=""><li id="f020" class="lt lu it js b jt ju jx jy kb lv kf lw kj lx kn mj lz ma mb bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/swift-6-tips-to-make-code-more-swift-a8ff9f8fd919?source=your_stories_page-------------------------------------"> <strong class="js iu">迅捷:让代码更迅捷的6个小技巧</strong> </a></li><li id="368a" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/6-tips-to-improve-coding-of-swift-1498bcc45f63"> <strong class="js iu">改进Swift编码的6个技巧</strong> </a></li><li id="159d" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/12-tips-to-make-swift-more-concise-4f4ed63f3063"> <strong class="js iu"> 12招使迅捷少码</strong> </a></li><li id="3c3b" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/swift-a-few-tips-for-improving-code-quality-ae39c1220c9"> <strong class="js iu"> Swift:提高代码质量的几个技巧</strong> </a></li></ol><p id="b303" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其他故事:</p><ol class=""><li id="b1b6" class="lt lu it js b jt ju jx jy kb lv kf lw kj lx kn mj lz ma mb bi translated"><a class="ae le" href="https://medium.com/@zhuyp/ios-or-ios-7c7d23905c35" rel="noopener"> <strong class="js iu"> IOS还是IOS？</strong>T29】</a></li><li id="8e2f" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><a class="ae le" href="https://medium.com/@zhuyp/tip-for-swift-from-async-to-sync-in-function-1-c1337f0d60b3" rel="noopener"><strong class="js iu">Swift提示:函数</strong> </a>中从异步到同步</li><li id="1461" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><a class="ae le" href="https://medium.com/@zhuyp/uicollectionview-an-error-that-often-occurs-a494ca70fc4b" rel="noopener"> <strong class="js iu"> UICollectionView:经常出现的错误</strong> </a></li><li id="c9d5" class="lt lu it js b jt mc jx md kb me kf mf kj mg kn mj lz ma mb bi translated"><a class="ae le" href="https://medium.com/@zhuyp/simple-error-system-in-app-f72278168634" rel="noopener"><strong class="js iu">App中的简单错误系统</strong> </a></li></ol><blockquote class="lf lg lh"><p id="5b21" class="jq jr li js b jt ju jv jw jx jy jz ka lj kc kd ke lk kg kh ki ll kk kl km kn im bi translated"><strong class="js iu"> <em class="it">关于我:</em> </strong> <em class="it"> <br/>我是iOS的开发者，曾经在XAG工作。现在我想在medium上分享故事，总结自己的经验来帮助别人。如果你有任何问题，请给我反馈，我会积极给你我的答复。</em></p></blockquote></div></div>    
</body>
</html>