<html>
<head>
<title>Introduction to the Structural Vector Autoregression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">结构向量自回归简介</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/structural-vector-autoregression-in-r-5d6dbfc56499?source=collection_archive---------0-----------------------#2020-06-17">https://levelup.gitconnected.com/structural-vector-autoregression-in-r-5d6dbfc56499?source=collection_archive---------0-----------------------#2020-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1d4341fe0b8453da2b2a67ab5569a701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7TL8hAqYi0Qcwyej9xh7Bg.png"/></div></div></figure><h2 id="9859" class="kb kc it bd kd ke kf dn kg kh ki dp kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">结构向量自回归</strong>是一个非常灵活的工具，特别是对于分析实体经济的政策行为。</h2><h1 id="a0bc" class="kx kc it bd kd ky kz la kg lb lc ld kj le lf lg kn lh li lj kr lk ll lm kv ln bi translated">概观</h1><p id="72b0" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly kk lz ma mb ko mc md me ks mf mg mh mi im bi translated">结构风险值是无限制风险值模型的一种变体，它是一种预测系统中多个变量的方法。在常规的无限制风险值中，我们允许数据自己说话和行动，而另一方面，结构性风险值会施加关键限制，为某些变量的行为设定条件。</p><h1 id="ec35" class="kx kc it bd kd ky kz la kg lb lc ld kj le lf lg kn lh li lj kr lk ll lm kv ln bi translated">结构风险值的用途</h1><p id="990f" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly kk lz ma mb ko mc md me ks mf mg mh mi im bi translated">结构风险值用于两个主要的宏观经济政策考虑，即财政政策和货币政策。</p><p id="fb8c" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated"><strong class="lq iu">财政政策</strong>:假设政府预计封锁或隔离措施会导致私人需求减少。它可能试图对影响关键变量的事件序列进行建模，因此，该结构本质上是对反应时间线进行建模。例如，假设检疫措施减少了私人需求。政府将增加公共开支，从而增加赤字。然而，产量继续下降。增加一个结构可以防止得出政府支出增加导致产出下降的结论，这是一个错误的结论。这是你在常规无限制VAR中可以预期的一些结论。</p><p id="1a5d" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated"><strong class="lq iu">对于货币政策</strong>:假设央行预期通货膨胀会有所上升。为了抑制这种增长，央行可以提高其主要政策利率。然而，恰好通货膨胀继续增加。与财政政策一样，使用SVAR可以防止我们得出结论，即提高政策利率会增加通胀，这也是错误的。增加一个结构就增加了限制，这实质上创建了一个先验的时间线，我们的模型通过这个时间线来表现。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><p id="6e0f" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">我们将使用与VAR大致相似的方法，但是增加了一些对值的限制和更多的条件。这些限制基于经济基础或支撑直觉或理论。幸运的是，R中有一个用于这个目的的命令库。对于我们的例子，我们将处理三个变量，即产出缺口(y)，通货膨胀率(pi)和利率(RRP)即(r)。</p><h1 id="ed32" class="kx kc it bd kd ky kz la kg lb lc ld kj le lf lg kn lh li lj kr lk ll lm kv ln bi translated">预赛</h1><p id="174b" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly kk lz ma mb ko mc md me ks mf mg mh mi im bi translated">和往常一样，我们首先加载和安装包，将变量转换为时间序列对象，以图形方式查看这些变量，并检查一些一般条件。我们从加载和安装所需的包开始。像往常一样，我们将使用<em class="mv"> library() </em>命令加载包，并使用<em class="mv"> install.packages() </em>命令进行安装。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="f113" class="kb kc it nb b gy nf ng l nh ni">library(urca)<br/>library(vars)<br/>library(tseries)<br/>library(TSstudio)<br/>library(forecast)<br/>library(tidyverse)<br/>library(svars)</span></pre><p id="b8d7" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">我们加载我们的数据集，这是SVAR _菲律宾. csv文件。这包含了我们从2000年Q1到2020年第一季度的研究数据。该数据的频率是每季度一次。除了作者使用卡尔曼滤波技术估计的输出差距之外，所有数据点均可在BSP网站上获得。该文件可以在下面的链接中找到。<a class="ae nj" href="https://drive.google.com/drive/folders/11mAXh0trxjuf1y_yh-AJXgxulHQwcBEn?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://drive . Google . com/drive/folders/11 max h0 trxjuf 1y _ yh-AJXgxulHQwcBEn？usp =共享</a></p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="b369" class="kb kc it nb b gy nf ng l nh ni">macro &lt;- read_csv(file.choose())<br/>head(macro)</span></pre><p id="9e68" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">加载数据集后，我们需要将变量转换成可用于SVAR的时间序列变量。像往常一样，我们使用ts()命令来做这件事。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="be45" class="kb kc it nb b gy nf ng l nh ni">y &lt;- ts(macro\$`Output Gap`, start = c(2000,1,1), frequency = 4)<br/>pi &lt;- ts(macro\$CPI, start = c(2000,1,1), frequency = 4)<br/>r &lt;- ts(macro\$RRP, start = c(2000,1,1), frequency = 4)</span></pre><p id="2e96" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">和往常一样，我们可以使用<em class="mv"> ts_plot() </em>命令绘制每个时间序列。重要的是将系列可视化，以验证系列的加载，并获得对某些特征的感觉。您可以选择使用<em class="mv"> ts_decompose() </em>命令来查看更好的分解。在标题图像中可以看到系列图。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="c308" class="kb kc it nb b gy nf ng l nh ni">ts_plot(y, title = "Output Gap", Xtitle = "Time", Ytitle = "Output Gap")</span><span id="4b34" class="kb kc it nb b gy nk ng l nh ni">ts_plot(pi, title = "Inflation Rate", Xtitle = "Time", Ytitle = "Inflation Rate")</span><span id="ad4b" class="kb kc it nb b gy nk ng l nh ni">ts_plot(r, title = "Overnight Reverse Repurchase Rate", Xtitle = "Time", Ytitle = "RRP")</span></pre><h1 id="17e4" class="kx kc it bd kd ky kz la kg lb lc ld kj le lf lg kn lh li lj kr lk ll lm kv ln bi translated">在SVAR设置限制</h1><p id="c409" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly kk lz ma mb ko mc md me ks mf mg mh mi im bi translated">我们现在将通过添加限制来区分VAR。我们需要建立约束矩阵，然后通过使用上一节讨论的递归排序法来估计结构系数。</p><p id="c770" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">我们现在到了SVAR分析的关键部分，即设定限制矩阵的值。正如我们已经说过的，这个矩阵是影响系统中变量的同期冲击的矩阵。在确定系数时，我们需要设置限制条件，而这些限制条件是由经济学原理定义的。在我们将要构建的矩阵中，我们将施加这样的行为:如果<em class="mv"> r </em>是政策利率，我们可以说<em class="mv"> r </em>的反应或变动将归因于同一时期<em class="mv"> pi </em>和<em class="mv"> y </em>的冲击。我们将构建矩阵，使得政策利率<em class="mv"> r </em>仅滞后影响<em class="mv"> pi </em>和<em class="mv"> y </em>。因此，我们将矩阵公式化为以下形式。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/6429d68da98051880bf918b104a7b869.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*HxElfIOyslLYf55veHTs1Q.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">限制矩阵</figcaption></figure><p id="da1e" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">这一限制表明，<em class="mv"> y </em>的同期冲击会影响同期的<em class="mv"> pi </em>和$r$以及系统中的滞后值。此外，<em class="mv"> pi </em>冲击只会同时影响<em class="mv"> r </em>而不会影响<em class="mv"> y </em>。同样，它也会影响系统中的滞后值。最后<em class="mv"> r </em>不会同时影响<em class="mv"> y </em>和<em class="mv"> pi </em>但会影响系统中的滞后值。我们首先将一个矩阵定义为对象“amat”，并在代码中设置条件。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="d3df" class="kb kc it nb b gy nf ng l nh ni">amat &lt;- diag(3)<br/>amat[2,1] &lt;- NA<br/>amat[3,1] &lt;- NA<br/>amat[3,2] &lt;- NA<br/>amat</span></pre><p id="d68e" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">命令创建一个3×3的单位矩阵。接下来的三个命令修改下面的三角形，使其值为NA。本质上，我们是在识别可以任意取值的参数。因此，在我们估计之后，NA将被填满。同时，我们将上面的三角形保留为零，它代表我们施加的限制，类似于我们在矩阵中预先指定的经济直觉。</p><h1 id="b311" class="kx kc it bd kd ky kz la kg lb lc ld kj le lf lg kn lh li lj kr lk ll lm kv ln bi translated">构建模型</h1><p id="e68c" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly kk lz ma mb ko mc md me ks mf mg mh mi im bi translated">在此之后，我们现在将指定我们想要的排序。为了反映我们限制的经济直觉，我们必须首先遵循产出缺口的顺序，然后是通货膨胀，最后是政策利率。再一次，把这个Choleskey排序想象成事件的时间线或者事件的顺序。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="2bba" class="kb kc it nb b gy nf ng l nh ni">sv &lt;- cbind(y, pi, r)<br/>colnames(sv) &lt;- cbind(“OutputGap”, “Inflation”, “RRP”)</span></pre><p id="f7b9" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">我们现在继续使用<em class="mv"> VARselect() </em>命令来确定滞后排序。由于这是季度数据，我们预计滞后顺序约为4到6。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="2f07" class="kb kc it nb b gy nf ng l nh ni">lagselect &lt;- VARselect(sv, lag.max = 8, type = "both")<br/>lagselect$selection<br/>lagselect$criteria</span></pre><p id="986e" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">根据AIC、SBIC、HQIC和FPE的情况，似乎主要的滞后顺序是五个滞后。因此，让我们建立一个有5个滞后的模型。</p><p id="031f" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">为了估计SVAR，我们首先需要估计一个简化形式的VAR，这就是为什么我们在这里有一个VAR()估计。同样，我们将滞后的数量设置为5。之后，我们使用SVAR()命令，并将amat选项设置为我们的Amat对象。这样做应该会产生我们估计的SVAR限制矩阵。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="8090" class="kb kc it nb b gy nf ng l nh ni">Model1 &lt;- VAR(sv, p = 5, season = NULL, exog = NULL, type = "const") </span><span id="fae4" class="kb kc it nb b gy nk ng l nh ni">SVARMod1 &lt;- SVAR(Model1, Amat = amat, Bmat = NULL, hessian = TRUE, estmethod = c("scoring", "direct"))</span><span id="ca94" class="kb kc it nb b gy nk ng l nh ni">SVARMod1</span></pre><p id="b0e9" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">如果你这样做是正确的，你应该看到，我们估计我们的结构参数为0.21，0.09和-0.11，这可以作为估计的限制矩阵。</p><h1 id="c21e" class="kx kc it bd kd ky kz la kg lb lc ld kj le lf lg kn lh li lj kr lk ll lm kv ln bi translated">政策应用</h1><p id="f777" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly kk lz ma mb ko mc md me ks mf mg mh mi im bi translated">我们现在将继续SVAR的应用。在此之前，您应该首先诊断VAR，类似于我们在上一节中使用的步骤。在这一部分，我们将主要关注两个主要的应用，即脉冲响应函数和预测误差方差分解。</p><p id="aba6" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">我们将聚焦于直觉如何在构建IRF中发挥作用，并观察政策利率<em class="mv"> r </em>将如何应对系统中的冲击。要运行IRF，我们只需使用<em class="mv"> irf() </em>命令，按照我们的意愿设置脉冲和响应。由于系统中有三个变量，因此总共有九(3)个可能的IRF。我们将聚焦在三个问题上，我希望你能清楚地理解基于我们强加的限制的反应。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="c2b2" class="kb kc it nb b gy nf ng l nh ni">SVARog &lt;- irf(SVARMod1, impulse = "OutputGap", response = "OutputGap")</span><span id="bd5f" class="kb kc it nb b gy nk ng l nh ni">plot(SVARog)</span><span id="b3c5" class="kb kc it nb b gy nk ng l nh ni">SVARinf &lt;- irf(SVARMod1, impulse = "OutputGap", response = "Inflation")</span><span id="feb4" class="kb kc it nb b gy nk ng l nh ni">plot(SVARinf)</span><span id="da22" class="kb kc it nb b gy nk ng l nh ni">SVARrrp &lt;- irf(SVARMod1, impulse = "Inflation", response = "RRP")</span><span id="9c89" class="kb kc it nb b gy nk ng l nh ni">plot(SVARrrp)</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/5df7dc3af7e7f1c5a3e6c82635f2e195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-avz-s9CQg-OTPr1a5MTUA.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">脉冲响应函数</figcaption></figure><p id="73e0" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">脉冲响应非常直观。如果产出缺口中的冲击启动了这一序列，预计会加大产出缺口。产出缺口的增加增加了通胀缺口，这意味着经济产出超过了潜在预期，这可能导致经济过热。随着生产率继续提高，这种高于预期的产出缺口将推高通胀。由于中央银行看到产出缺口增加和通货膨胀增加，它可以通过增加RRP来适应这些，这正是在窗口(c)中看到的。这是典型的中央银行的货币反应，并得到了我们的SVAR的证实。</p><p id="3e13" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">我们将转向SVAR的FEVD分解。为此，我们使用<em class="mv"> fevd() </em>命令并提前设置一个地平线。在这种情况下，我们将其设置为提前十个周期。然后我们使用<em class="mv"> plot() </em>命令绘制数值，如下图所示。</p><pre class="mw mx my mz gt na nb nc nd aw ne bi"><span id="b561" class="kb kc it nb b gy nf ng l nh ni">SVARfevd &lt;- fevd(SVARMod1, n.ahead = 10)<br/>SVARfevd<br/>plot(SVARfevd)</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/3ce4d26ad0c4874251114d1ea9b8f4a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-83FOK4DrBnYtVV_6nc_w.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">预测误差方差分解</figcaption></figure><p id="9e63" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">如果你会注意到，产出缺口的FEVD纯粹是由产出缺口来解释的。这只是因为我们先点了这个。如果你会看到其他变量的冲击，它们反映了预测误差方差分解的大部分是因为我们将该变量作为顺序中的第一个。</p><p id="530a" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">总的来说，我希望你能看到如何添加一个结构到VAR中，这是我们施加的不同限制，能够产生一个关键的政策结果。因此，我希望你能够认识到SVARs是政府在执行政策和控制不可观测事物时非常有用的政策工具。</p><p id="e1ca" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly kk ml ma mb ko mm md me ks mn mg mh mi im bi translated">为了获得更多的实践经验，我制作了一个YouTube视频来更好地指导你这个概念。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ns nt l"/></div></figure></div></div>    
</body>
</html>