<html>
<head>
<title>Developing my first financial app using React Native, Redux, Figma and FastAPI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native、Redux、Figma和FastAPI开发我的第一个金融应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/developing-my-first-financial-app-using-react-native-redux-figma-and-fastapi-4a6b911845d0?source=collection_archive---------4-----------------------#2022-03-02">https://levelup.gitconnected.com/developing-my-first-financial-app-using-react-native-redux-figma-and-fastapi-4a6b911845d0?source=collection_archive---------4-----------------------#2022-03-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d079" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如今，拥有多个银行账户很正常，尤其是像Revolut这样的应用程序在爱尔兰取得了巨大成功。我和我的朋友发现拥有多个银行账户的问题是，很难轻松管理我们的财务。我决定通过设计和开发我的第一个名为“银行余额”的应用程序来解决这个问题，它将立即告诉我在多家银行的余额，包括我的存款。</p><p id="fe02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定使用的技术栈是Expo React-Native的跨平台功能，Redux用于状态管理，FastAPI用于编排层。Figma用于UI/UX原型开发。除了FastAPI之外，我以前没有使用这些技术的经验，但是我总是准备迎接挑战。</p><div class="kl km kn ko gt ab cb"><figure class="kp kq kr ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><img src="../Images/eeb7fd5cf7155d77f0af2f090261cae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*nRzUmQHiUHZ4VHeNcaRiNw.png"/></div></figure><figure class="kp kq kr ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><img src="../Images/423f2d0a56bfe9ccc22135cfc557f94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*eXCcZ6K0Ge3MmbcsQ_FzGQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk lg di lh li translated">银行余额的初始Figma原型</figcaption></figure></div><p id="b022" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最初的原型是使用Figma设计的，有两个屏幕。登录屏幕有一个启动授权过程的按钮，授权成功后，主屏幕将显示用户的银行账户及其相应的余额。</p><p id="e331" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我开始应用程序开发之前，我需要使用FastAPI(一个现代的、快速的、使用Python构建API的web框架)创建一个编排层，以保护我的由TrueLayer提供的密钥，因为应用程序可以被逆向工程。银行平衡使用TrueLayer安全地访问用户的财务数据，因为TrueLayer遵守所有开放的银行法规。认证后提供的访问令牌通过iOS上的Keychain和Android上的Keystore安全存储。</p><figure class="kl km kn ko gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/d1c94ac092e37d5e26342363afe37d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*Yh3KaxgW8J2BpnFeU2ECBw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">Python编排层</figcaption></figure><p id="b68c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">编排层有两个端点，<code class="fe lk ll lm ln b">/exchange</code>和<code class="fe lk ll lm ln b">/refresh</code>。交换端点向所请求的银行账户返回访问令牌，并且一旦访问令牌过期，刷新就更新访问令牌。每个银行对于它们的访问令牌的有效时间有不同的阈值。</p><p id="3bd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，iPhone将阻止任何不使用SSL的请求(<a class="ae lo" href="https://developer.apple.com/forums/thread/3544" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/forums/thread/3544</a>)，这意味着应用程序被阻止向编排层发出请求。因此，我使用<a class="ae lo" href="https://github.com/FiloSottile/mkcert" rel="noopener ugc nofollow" target="_blank"> mkcert </a>生成了一个SSL证书来提供这个层，mkcert 是一个制作本地可信开发证书的简单工具。</p><figure class="kl km kn ko gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lp"><img src="../Images/04e6e60558899cc5278b7ce948caf3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PvLsY1D7UQGQ1s9qyFjcZw.png"/></div></div></figure><p id="426c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为您的IPv4地址检索和创建SSL证书非常重要，因为这是应用程序将用来访问编排层的IP地址。此外，需要安装mkcert根证书并信任它。运行<code class="fe lk ll lm ln b">mkcert -CAROOT</code>可以找到证书。</p><figure class="kl km kn ko gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lq"><img src="../Images/ed33e6c3527f8e2183d84fe4504fe953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpYbzOC8Z_EzSKkqvRJJaA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">带有SSL的FastApi的业务流程部署命令。</figcaption></figure><p id="f9d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在编排层部署之后，我实现了与真正的层API和编排层通信的逻辑。使用<code class="fe lk ll lm ln b">@reduxjs/toolkit</code>库提供的函数<code class="fe lk ll lm ln b">createSlice</code>，我创建了两个reducers，<code class="fe lk ll lm ln b">token</code>和<code class="fe lk ll lm ln b">account</code>。<code class="fe lk ll lm ln b">createSlice</code>隐藏了Redux的一些复杂性，删除了样板代码。<code class="fe lk ll lm ln b">token</code> reducer负责处理编排层提供的令牌,<code class="fe lk ll lm ln b">account</code>负责处理银行余额等账户信息。</p><figure class="kl km kn ko gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lr"><img src="../Images/4dfd94925b3920f5673321428486dfac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rm5nUHg1Uj76ViXHJOjVpw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">令牌缩减器代码片段</figcaption></figure><p id="951d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lk ll lm ln b">fetchAccessToken</code>函数使用<code class="fe lk ll lm ln b">createAsyncThunk</code>返回一个<a class="ae lo" href="https://redux.js.org/usage/writing-logic-thunks" rel="noopener ugc nofollow" target="_blank"> thunk action creator </a>,意思是“一段做一些延迟工作的代码”,包装在一个承诺中，通过使用<code class="fe lk ll lm ln b">.then()</code>实现链接。<code class="fe lk ll lm ln b">token</code>缩减器使用<code class="fe lk ll lm ln b">expo-secure-store</code>库安全地存储令牌信息，而<code class="fe lk ll lm ln b">account</code>缩减器使用<code class="fe lk ll lm ln b">@react-native-async-storage/async-storage</code>库存储帐户信息。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="efbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实现逻辑屏幕相当困难，因为Expo的认证库<code class="fe lk ll lm ln b">expo-auth-session</code>在被测试TrueLayer环境重定向后不会触发其链接回调(它会在沙盒TrueLayer环境中触发，因为该应用程序从未打开另一个应用程序，即Revolut)。因此，我创建了一个具有回调链接功能的可定制授权组件。</p><figure class="kl km kn ko gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lz"><img src="../Images/8095d12292a1f09decdb737b91755b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zMwKsttw51hIyBeP5o2Mlw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">可定制的银行授权组件代码</figcaption></figure><p id="73ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CSS样式通过属性<code class="fe lk ll lm ln b">buttonStyle</code>传递给授权组件，并且它的子组件也被呈现。例如，登录屏幕使用授权组件，如下所示:</p><figure class="kl km kn ko gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lp"><img src="../Images/c9280199cd892dc403492f191d7aaff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ws35LuIum1B3R-qMtXIc1w.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">登录屏幕授权配置代码片段</figcaption></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><div class="kl km kn ko gt ab cb"><figure class="kp kq kr ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><img src="../Images/1538c5826a339b5f859ee7ac950a107a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Fhl4GehWkxlHfOF9ciCbmA.png"/></div></figure><figure class="kp kq kr ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><img src="../Images/f0997ab35cd9d55b0b749f9da15295d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*jkgjhBR3xU_D9YpP_ktwiw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk lg di lh li translated">最终Figma原型</figcaption></figure></div><p id="d237" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">主屏幕是最后实现的。我决定对最初的原型稍加修改，使其看起来更像一张资产负债表。显示相关帐户需要API请求的链接和转换。API链接工作如下，对于每个访问令牌(银行帐户)，检索允许的帐户，并且对于每个允许的帐户，检索其银行余额。然后，将每个银行账户与其相关银行余额合并，并转换所需信息，即将余额转换为当地货币。</p><figure class="kl km kn ko gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ma"><img src="../Images/346e786a713da679d85ac0767be86dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJVgyT8NFw8B_asDxKFwgA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">链接API请求和转换的代码片段。</figcaption></figure><p id="c606" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到目前为止，用户只能选择通过登录屏幕链接一个银行账户。我在右上角添加了一个加号按钮，实现了以前用于登录屏幕的授权，重用了功能，坚持了DRY ( <em class="mb">不要重复自己</em>)软件开发原则，节省了开发时间，但稍微增加了复杂性。</p><figure class="kl km kn ko gt kq"><div class="bz fp l di"><div class="mc md l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="8503" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总之，这个项目很有趣，但我决定不部署它，因为涉及到成本(苹果开发者项目费和编排层API费)。我对下一次迭代有更多的想法/特性:</p><ul class=""><li id="9e52" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">删除链接的银行帐户。</li><li id="6f94" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">洞察，如跨账户的日常支出、预测支出等。</li><li id="67f0" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">用户配置文件。</li><li id="8d9c" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">首次登录时链接多个银行账户。</li></ul><p id="45ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用所有这些新技术非常有趣，但我会在未来的应用程序中使用Typescript，因为随着代码库的增长，代码的可读性和可维护性是一个问题。Redux的旧代码示例有很多重复的代码，但是<code class="fe lk ll lm ln b">@reduxjs/toolkit</code>库删除了大量重复的代码。我发现Redux对于这个应用程序来说是多余的，而且不必要的复杂，但是如果我继续开发，它会变得非常有益，因为给孩子传递道具将成为维护的噩梦。最后，我发现Expo是在IOS/Android两个移动平台上快速开发的一个很好的解决方案。</p><p id="1542" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读，如果您想与我联系，您可以在<a class="ae lo" href="https://www.linkedin.com/in/shanenullain/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>或<a class="ae lo" href="https://github.com/ShaneNolan" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到我。</p></div></div>    
</body>
</html>