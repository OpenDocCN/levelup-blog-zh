<html>
<head>
<title>Setup Your Own Kubernetes Cluster with K3s — k3sup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用K3s — k3sup设置您自己的Kubernetes集群</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setup-your-own-kubernetes-cluster-with-k3s-take-2-k3sup-a5d9453f709f?source=collection_archive---------3-----------------------#2021-02-12">https://levelup.gitconnected.com/setup-your-own-kubernetes-cluster-with-k3s-take-2-k3sup-a5d9453f709f?source=collection_archive---------3-----------------------#2021-02-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e06be365e89097d42713820351dfa642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XzWU9BZ6cINV66ZR"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">Joshua Sortino 在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a514" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管建立一个<code class="fe le lf lg lh b">k3s</code>集群就像吃馅饼一样简单，但是使用一个名为<code class="fe le lf lg lh b">k3s</code>的小助手会使它变得更加简单。</p><h2 id="72f0" class="li lj it bd lk ll lm dn ln lo lp dp lq kr lr ls lt kv lu lv lw kz lx ly lz ma bi translated">清除</h2><p id="4fa5" class="pw-post-body-paragraph kg kh it ki b kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz mf lb lc ld im bi translated">请注意:在一个<code class="fe le lf lg lh b">k3s</code>集群就位的情况下，可能是因为<a class="ae kf" href="https://twissmueller.medium.com/setup-your-own-kubernetes-cluster-with-k3s-b527bf48e36a" rel="noopener">这个岗位</a>，也很容易摆脱一切。</p><p id="c4a8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在服务器上，必须运行以下脚本:</p><pre class="mg mh mi mj gt mk lh ml mm aw mn bi"><span id="65f1" class="li lj it lh b gy mo mp l mq mr">/usr/local/bin/k3s-uninstall.sh</span></pre><p id="9507" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与此类似，在代理上:</p><pre class="mg mh mi mj gt mk lh ml mm aw mn bi"><span id="f6cb" class="li lj it lh b gy mo mp l mq mr">/usr/local/bin/k3s-agent-uninstall.sh</span></pre><p id="bf94" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本地机器上，<code class="fe le lf lg lh b">~/.kube/config</code>下的Kubernetes配置也需要清理。</p><h2 id="cd0d" class="li lj it bd lk ll lm dn ln lo lp dp lq kr lr ls lt kv lu lv lw kz lx ly lz ma bi translated">先决条件</h2><p id="215d" class="pw-post-body-paragraph kg kh it ki b kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz mf lb lc ld im bi translated">除了拥有一堆虚拟机或裸机服务器之外，还需要已经设置了两个无密码SSH登录和无密码sudo，以便使用<code class="fe le lf lg lh b">k3sup</code>。</p><p id="1e6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是我快速整理的两篇解释这一点的文章:</p><ul class=""><li id="5916" class="ms mt it ki b kj kk kn ko kr mu kv mv kz mw ld mx my mz na bi translated"><a class="ae kf" href="https://twissmueller.medium.com/ssh-key-914fa5e9b4c1" rel="noopener">无密码SSH登录</a></li><li id="8883" class="ms mt it ki b kj nb kn nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae kf" href="https://twissmueller.medium.com/passwordless-sudo-9573f5fb1b6a" rel="noopener">无通行证的sudo </a></li></ul><p id="13ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然，工具<code class="fe le lf lg lh b">k3sup</code>也是需要的。它可以通过执行以下命令来安装:</p><pre class="mg mh mi mj gt mk lh ml mm aw mn bi"><span id="4b6d" class="li lj it lh b gy mo mp l mq mr">curl -sLSf https://get.k3sup.dev | sh<br/>sudo install -m k3sup /usr/local/bin/</span></pre><h2 id="aa92" class="li lj it bd lk ll lm dn ln lo lp dp lq kr lr ls lt kv lu lv lw kz lx ly lz ma bi translated">集群安装</h2><p id="e966" class="pw-post-body-paragraph kg kh it ki b kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz mf lb lc ld im bi translated">一切就绪后，<code class="fe le lf lg lh b">k3s</code>服务器可以安装</p><pre class="mg mh mi mj gt mk lh ml mm aw mn bi"><span id="e4c7" class="li lj it lh b gy mo mp l mq mr">k3sup install --ip &lt;ip-of-server&gt; --user &lt;user-name&gt; --local-path ~/.kube/config --context &lt;mycontext&gt;</span></pre><p id="bbc5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者，如果您想提供主机名而不是IP</p><pre class="mg mh mi mj gt mk lh ml mm aw mn bi"><span id="17f6" class="li lj it lh b gy mo mp l mq mr">k3sup install --host &lt;hostname-of-server&gt; --user &lt;user-name&gt; --local-path ~/.kube/config --context &lt;mycontext&gt;</span></pre><p id="15b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出于某种原因，<code class="fe le lf lg lh b">.kube/config</code>中的服务器地址是<code class="fe le lf lg lh b">server: https://127.0.0.1:6443</code>，我已经手动将其更改为我的主机。</p><p id="ea75" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过执行以下语句来联接代理:</p><pre class="mg mh mi mj gt mk lh ml mm aw mn bi"><span id="4c5a" class="li lj it lh b gy mo mp l mq mr">k3sup join --host &lt;agent-hostname&gt; --server-host &lt;server-hostname&gt; --user &lt;username&gt;</span></pre><p id="2bce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本地机器上的一个好的测试是用</p><pre class="mg mh mi mj gt mk lh ml mm aw mn bi"><span id="c4b6" class="li lj it lh b gy mo mp l mq mr">kubectl get nodes -o wide</span></pre><p id="2cf6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽情享受吧！</p><p id="3de2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这篇文章，请随时给我买杯咖啡！ </p><h2 id="2856" class="li lj it bd lk ll lm dn ln lo lp dp lq kr lr ls lt kv lu lv lw kz lx ly lz ma bi translated">资源</h2><ul class=""><li id="789d" class="ms mt it ki b kj mb kn mc kr ng kv nh kz ni ld mx my mz na bi translated"><a class="ae kf" href="https://github.com/alexellis/k3sup" rel="noopener ugc nofollow" target="_blank"> K3sup </a></li></ul></div></div>    
</body>
</html>