<html>
<head>
<title>Enterprise Serverless 🚀 Security</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">企业无服务器🚀安全性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/enterprise-serverless-security-170d1aeefc22?source=collection_archive---------7-----------------------#2020-07-06">https://levelup.gitconnected.com/enterprise-serverless-security-170d1aeefc22?source=collection_archive---------7-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/3fdaf4541433e44abf05e8a436062be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YM_T6Xgh7mwG-0b9mbGhTQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/@brizmaker" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@brizmaker</a></figcaption></figure><div class=""/><p id="8e57" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从我自己的角度来看，企业无服务器系列中的这一部分专门讨论了无服务器应用程序的一些安全方面和工具。你可以点击下面的“<em class="le">系列介绍</em>链接阅读该系列背后的想法。</p><p id="7c0b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该系列分为以下几个部分:</p><ol class=""><li id="eddc" class="lf lg jj ki b kj kk kn ko kr lh kv li kz lj ld lk ll lm ln bi translated"><a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-series-358be237b510" rel="noopener">系列介绍</a>🚀</li><li id="24b5" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-tooling-aa2b84d932de" rel="noopener">工装</a>🚀</li><li id="dac8" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-architecture-39c4f4ae5aff" rel="noopener">建筑</a>🚀</li><li id="6215" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://leejamesgilmore.medium.com/enterprise-serverless-databases-208b8790998" rel="noopener">数据库</a>🚀</li><li id="59c4" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-hints-tips-32a41cdabc0d" rel="noopener">提示&amp;提示</a>🚀</li><li id="77dc" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-aws-limits-limitations-ce99e20432be" rel="noopener"> AWS限制&amp;限制</a>🚀</li><li id="f9ed" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="ki jk">安全</strong>🚀</li><li id="898b" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-useful-resources-cd8e987f6d69" rel="noopener">有用的资源</a>🚀</li></ol><h1 id="3a95" class="lt lu jj bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">安全性</h1><p id="eadc" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">以下是我个人根据之前的大型云项目想到的一些关键领域，但不限于此(<em class="le">我会在想到这些领域时添加更多内容</em>):</p><h2 id="8175" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">API验证✅</h2><p id="16d4" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">在大规模的无服务器项目中，提前验证传入的API请求非常重要，因为这通常是针对不良参与者和攻击者的面向公众的API(在发布/过度发布/不良有效载荷等下<em class="le">)。通常使用的AWS无服务器服务有<a class="ae jg" href="https://aws.amazon.com/api-gateway/" rel="noopener ugc nofollow" target="_blank">AWS API Gateway</a>(<em class="le">REST</em>)和<a class="ae jg" href="https://aws.amazon.com/appsync/" rel="noopener ugc nofollow" target="_blank">AWS app sync</a>(<em class="le">graph QL</em>)。</em></p><p id="100d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> AWS AppSync </strong></p><p id="3bf1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于AWS AppSync，我通常为管道中的每个端点添加一个validate方法，例如在一个虚构的“get customer”查询中:</p><p id="ccb4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">映射模板</em></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="7b4d" class="mw lu jj nn b gy nr ns l nt nu">{<br/>   type: 'Query',<br/>   field: 'getCustomer',<br/>   request: resolve(<br/>'src/customer/resolvers/pipelines/Before.req.vtl'<br/>   ),<br/>   response: resolve(<br/>   'src/customer/resolvers/pipelines/After.res.vtl'<br/>   ),<br/>   kind: 'PIPELINE',<br/>   functions: ['<strong class="nn jk">validateGetCustomer</strong>', 'getCustomer'],<br/>},</span></pre><p id="e98f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">验证获取客户(基本示例)</em></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="52a8" class="mw lu jj nn b gy nr ns l nt nu">#set($errors = [])<br/>#set($valid = $util.matches("${<em class="le">customerId</em>}", $ctx<em class="le">.args.customerId</em>))<br/>#if (!$valid)<br/>   #if ($util.isNullOrEmpty($ctx<em class="le">.args.customerId</em>))<br/>      #set($propertyRequiredError = "${propertyRequiredError}")<br/>      $util.qr($errors.add($propertyRequiredError.replace("{0}", "Customer ID")))<br/>   #else<br/>      #set($propertyNotValidError = "${propertyNotValidError}")<br/>      $util.qr($errors.add($propertyNotValidError.replace("{0}",<br/>      $ctx<em class="le">.args.customerId</em>).replace("{1}", "customer ID")))<br/>   #end<br/>#end<br/>#if ($errors.size() &gt; 0)<br/>   $utils.error($util.toJson("${validationError}"), null, null, $errors)<br/>#end<br/>{}</span></pre><p id="7428" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这确保我们在传递到管道的下一部分(可能是DynamoDB或Lambda解析器)之前，使用正则表达式、长度、类型等预先验证请求的有效负载和/或参数。GraphQL通常会在调用API之前提供一些基本的预验证，但你不能依赖它。</p><blockquote class="nv nw nx"><p id="f6dc" class="kg kh le ki b kj kk kl km kn ko kp kq ny ks kt ku nz kw kx ky oa la lb lc ld im bi translated"><em class="jj">💡</em>我通常使用管道的before步骤来设置相关id(共享VTL文件)，如果需要，使用after步骤来进行任何post错误转置。</p></blockquote><p id="f056" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> AWS API网关</strong></p><p id="3ea3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过API Gateway，您可以使用JSON模式和请求验证器预先执行<a class="ae jg" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-method-request-validation.html" rel="noopener ugc nofollow" target="_blank">基本请求验证</a>，尽管在选择与lambda的<a class="ae jg" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-integration-types.html" rel="noopener ugc nofollow" target="_blank">集成</a>类型时，这可能是一个雷区——值得花一些时间尝试每种类型，以了解它们如何工作以及什么适合您的解决方案(<em class="le">这是一篇独立的文章</em>)。</p><h2 id="cada" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">我是最小的特权</h2><p id="2cc2" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">当谈到在AWS上构建任何云服务时，我认为一个基本的安全任务是确保特定的服务只有IAM权限来完成手头的任务(<strong class="ki jk">仅此而已！</strong>)。</p><p id="9c94" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果您允许lambda将消息放入一个队列，请确保您绑定了lambda角色，以便它只能将消息添加到特定的队列，而不是帐户中的每个SQS队列。</p><p id="d351" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">📖<em class="le"/><strong class="ki jk"><em class="le"/></strong><em class="le">对于Lambda函数，建议您遵循最低特权访问，并且只允许执行给定操作所需的访问。赋予一个角色过多的权限可能会导致系统被滥用。在安全上下文中，使用较小的函数来执行限定范围的活动有助于构建更好的无服务器应用程序。关于IAM角色，在多个Lambda函数中共享一个IAM角色可能会违反最低特权访问。</em><strong class="ki jk"/>—<strong class="ki jk">AWS无服务器应用镜头</strong></p><p id="9c42" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个真实的例子可以是<a class="ae jg" href="https://aws.amazon.com/appsync/" rel="noopener ugc nofollow" target="_blank"> AWS AppSync </a>中的<a class="ae jg" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank"> DynamoDB </a>解析器，其中与数据源相关联的服务角色只具有特定表的DynamoDB策略和所需的动作类型(<em class="le">查询、扫描、更新等</em>)。</p><p id="9edf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这可能是用于查询特定订单的GraphQL端点，例如:</p><p id="825a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">数据来源</em></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="ce18" class="mw lu jj nn b gy nr ns l nt nu">{<br/>   type: 'AMAZON_DYNAMODB',<br/>   name: '<strong class="nn jk">OrderDataSource</strong>',<br/>   description: 'Order Data Source',<br/>   config: {<br/>      tableName: {<br/>         'Fn::ImportValue': '<strong class="nn jk">order-table-${self:custom.prefix}</strong>',<br/>      },<br/>      serviceRoleArn: {<br/>         'Fn::GetAtt': ['<strong class="nn jk">OrderServiceRole</strong>', 'Arn'],<br/>      },<br/>   },<br/>}</span></pre><p id="95ea" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">服务角色</em></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="5e75" class="mw lu jj nn b gy nr ns l nt nu"><strong class="nn jk">OrderServiceRole</strong>: {<br/>   Type: 'AWS::IAM::Role',<br/>   Properties: {<br/>   RoleName: '${self:custom.prefix}-order-sr',<br/>   AssumeRolePolicyDocument: {<br/>      Version: '2012-10-17',<br/>      Statement: [<br/>      {<br/>         Effect: 'Allow',<br/>         Principal: {<br/>         Service: ['appsync.amazonaws.com'],<br/>      },<br/>         Action: ['sts:AssumeRole'],<br/>      }],<br/>   },<br/>   Policies: [<br/>      {<br/>         PolicyName: '${self:custom.prefix}-order-sr-policy',<br/>         PolicyDocument: {<br/>         Version: '2012-10-17',<br/>         Statement: [<br/>         {<br/>            Effect: 'Allow',<br/>            <strong class="nn jk">Action: ['dynamodb:Query'],</strong><br/>            Resource: [<br/>            {<br/>               'Fn::ImportValue':<br/>               <strong class="nn jk">'order-table-${self:custom.prefix}-arn'</strong>,<br/>            },</span><span id="af63" class="mw lu jj nn b gy ob ns l nt nu">...</span></pre><p id="cb2a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这确保了在本例中，当<a class="ae jg" href="https://docs.aws.amazon.com/appsync/latest/APIReference/API_DataSource.html" rel="noopener ugc nofollow" target="_blank">数据源</a>链接到<a class="ae jg" href="https://docs.aws.amazon.com/appsync/latest/APIReference/API_FunctionConfiguration.html" rel="noopener ugc nofollow" target="_blank">功能配置</a>时，GraphQL <a class="ae jg" href="https://docs.aws.amazon.com/appsync/latest/APIReference/API_Resolver.html" rel="noopener ugc nofollow" target="_blank">解析器</a>在本例中仅作为在特定<em class="le">订单</em>表上执行手头的特定<em class="le">查询</em>任务所需的权限；而且不能再做了(<em class="le">不慎损坏</em>)。</p><blockquote class="nv nw nx"><p id="bdb4" class="kg kh le ki b kj kk kl km kn ko kp kq ny ks kt ku nz kw kx ky oa la lb lc ld im bi translated"><em class="jj">💡</em>在上面这个具体的例子中，您在大型项目中可能面临的一个问题是，在具有这种细粒度访问级别的帐户上，IAM角色不够用——限制可以在这里<a class="ae jg" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_iam-quotas.html" rel="noopener ugc nofollow" target="_blank">找到</a>。假设您的解决方案中有100个单独的GraphQL端点，20名开发人员在短期环境中工作，那么在任何给定的时间点都有2K个潜在的IAM角色(不包括您的解决方案中的其他角色)。</p></blockquote><h2 id="d398" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">AWS白皮书和资源</h2><p id="adfb" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">我个人觉得以下几点很有用:</p><ol class=""><li id="92b3" class="lf lg jj ki b kj kk kn ko kr lh kv li kz lj ld lk ll lm ln bi translated"><a class="ae jg" href="https://aws.amazon.com/products/security/?nc=sn&amp;loc=2" rel="noopener ugc nofollow" target="_blank">AWS概述中的安全性、身份和合规性</a></li><li id="7871" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://d1.awsstatic.com/whitepapers/architecture/AWS-Serverless-Applications-Lens.pdf" rel="noopener ugc nofollow" target="_blank"> AWS无服务器应用镜头白皮书</a></li><li id="6077" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><a class="ae jg" href="https://d1.awsstatic.com/whitepapers/architecture/AWS-Security-Pillar.pdf" rel="noopener ugc nofollow" target="_blank"> AWS安全支柱白皮书</a></li></ol><h2 id="1444" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">运行时和包版本</h2><p id="e17c" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">任何大型云项目的一个关键方面是确保您的包、项目依赖项和运行时版本没有任何已知的漏洞。</p><p id="9405" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">AWS Lambda的伟大之处在于Amazon管理运行时的底层补丁；然而，如果您使用容器，例如使用<a class="ae jg" href="https://aws.amazon.com/fargate/" rel="noopener ugc nofollow" target="_blank"> AWS Fargate </a>，您将需要自己管理基本映像版本的使用。</p><p id="99d9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还必须使用开源解决方案将包和项目依赖项作为CI/CD管道的一部分进行扫描，以使团队意识到任何安全漏洞，从而可以减轻它们。</p><h2 id="b069" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">不要记录秘密！</h2><p id="bfee" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">说到记录，一定不要记录秘密或个人身份信息，如电子邮件地址或银行信息，因为这是一个坏演员的金矿😈。这也可能违反您公司的政策、GDPR或您为客户提供服务的条款和条件。</p><p id="9fef" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将<a class="ae jg" href="https://aws.amazon.com/appsync/" rel="noopener ugc nofollow" target="_blank"> AWS AppSync </a>与<a class="ae jg" href="https://github.com/sid88in/serverless-appsync-plugin" rel="noopener ugc nofollow" target="_blank">server less-app sync-plugin</a>一起使用的一个例子是根据您部署到的阶段来更改您的serverless YAML/JSON中的日志记录级别:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="070a" class="mw lu jj nn b gy nr ns l nt nu">logConfig:<br/>      loggingRoleArn: { Fn::GetAtt: [AppSyncLoggingServiceRole, Arn] } # Where AppSyncLoggingServiceRole is a role with CloudWatch Logs write access<br/>      level: ERROR # Logging Level: NONE | ERROR | ALL<br/>      excludeVerboseContent: false</span></pre><p id="e293" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这张地图通过云层映射到之后的<a class="ae jg" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-appsync-graphqlapi-logconfig.html" rel="noopener ugc nofollow" target="_blank">。我倾向于根据我们是处于暂时/QA/PP还是Prod来切换日志记录的详细程度和级别，因为之前在默认情况下，我们可以在AppSync CloudWatch请求日志中看到记录的不记名令牌..🙈在短暂的环境和QA中，额外的日志记录可能对调试有用。</a></p><p id="b63f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">📖<em class="le"> </em> <strong class="ki jk"> <em class="le"> " </em> </strong> <em class="le">我们严格建议不要发送、记录和存储未加密的敏感数据，无论是作为HTTP请求路径/查询字符串的一部分还是在Lambda函数的标准输出中。</em><strong class="ki jk"/>—<strong class="ki jk">AWS无服务器应用镜头</strong></p><h2 id="34c6" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">vpc配置</h2><p id="728d" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">在处理大型无服务器云项目时，您可能需要将lambda等资源连接到驻留在<a class="ae jg" href="https://aws.amazon.com/vpc/" rel="noopener ugc nofollow" target="_blank"> VPC </a> ( <em class="le">例如RDS或DocumentDB </em>)中的AWS服务。在这种情况下，正确设置入站和出站流量规则等非常重要。</p><h2 id="debc" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">限速</h2><p id="f6f7" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">根据客户的使用情况在API上正确设置速率限制是任何大型项目中的一项重要任务，不应被遗忘，这可以在基础设施的各个级别完成(<a class="ae jg" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-request-throttling.html#apigateway-how-throttling-limits-are-applied" rel="noopener ugc nofollow" target="_blank"> <em class="le"> API网关</em></a><em class="le">/</em><a class="ae jg" href="https://aws.amazon.com/waf/" rel="noopener ugc nofollow" target="_blank"><em class="le">AWS WAF</em></a><em class="le">/CloudFront/</em><a class="ae jg" href="https://www.serverless.com/aws-appsync" rel="noopener ugc nofollow" target="_blank"><em class="le">AWS app sync</em></a><em class="le">/cloud flare等</em>)，并且可以防止拒绝服务和<a class="ae jg" href="https://www.cequence.ai/use-cases/denial-of-wallet/#:~:text=Denial%20of%20Wallet%20attacks%20typically,an%20application%20denial%20of%20service." rel="noopener ugc nofollow" target="_blank">钱包</a></p><blockquote class="nv nw nx"><p id="28d1" class="kg kh le ki b kj kk kl km kn ko kp kq ny ks kt ku nz kw kx ky oa la lb lc ld im bi translated"><em class="jj">💡</em>在之前的AWS AppSync项目中，我就默认速率限制联系了AWS，因为它在早期的文档中没有指定。现在是<a class="ae jg" href="https://docs.aws.amazon.com/general/latest/gr/appsync.html" rel="noopener ugc nofollow" target="_blank">现在是</a>，设置为整个账户每秒1000个请求，尽管可以通过与亚马逊对话来增加。</p></blockquote><h2 id="df96" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">AWS帐户上的MFA所有团队成员始终！</h2><p id="23c6" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">创建新的AWS帐户时，您应该做的首要任务之一是确保您将MFA作为标准来启用，但这不仅仅止于管理员设置它，这应该在项目和帐户的整个生命周期中对所有团队成员强制执行！</p><p id="cdc7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您的安全性取决于您最薄弱的环节——一名未启用MFA的团队成员被黑客攻击会向黑客公开您的所有资产——以及通过使用您的帐户进行流氓活动来拒绝钱包攻击等，无论团队的其他成员有多严格。😈</p><h2 id="2f88" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">S3铲斗配置</h2><p id="36c2" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">检查您的“私有”存储桶是否是公共的…🙏🏼</p><h2 id="5676" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">连续威胁建模</h2><p id="c005" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">在之前的大规模云项目中，我管理过的一个工作出色的关键领域是在整个项目中持续进行<a class="ae jg" href="https://martinfowler.com/articles/agile-threat-modelling.html" rel="noopener ugc nofollow" target="_blank">威胁建模</a>，即在开发阶段以及上线后服务的任何部分发生重大变化时。</p><p id="4b87" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种方法之所以行之有效，是因为根据我的经验，这通常是一项留到项目结束时，在完全安全签核之前完成的任务——对于大型项目来说，这可能是一项艰巨的任务，因为项目结束时需要一次完成许多活动部分。</p><p id="921f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与项目结束时的大量潜在返工相比，在当时(<em class="le">之前或期间</em>)在该代码区域工作时减少任何问题也是有益的。它还让安全部门有信心知道您在整个SDLC过程中都将这一点融入到您的流程中。</p><h2 id="3da0" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">预算</h2><p id="a524" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">在AWS控制台中为您的帐户设置预算，以便在成本由于某种原因开始上升时得到主动提醒..</p><h2 id="f011" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">静态和传输中的加密</h2><p id="77f4" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">存储客户数据时，考虑静态和传输中的数据加密非常重要。存储静态加密数据的很好的例子有<a class="ae jg" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html" rel="noopener ugc nofollow" target="_blank"> DynamoDB </a>、<a class="ae jg" href="https://docs.aws.amazon.com/documentdb/latest/developerguide/encryption-at-rest.html" rel="noopener ugc nofollow" target="_blank"> AWS DocumentDB </a>、<a class="ae jg" href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Overview.Encryption.html" rel="noopener ugc nofollow" target="_blank"> AWS Aurora </a>、<a class="ae jg" href="https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html" rel="noopener ugc nofollow" target="_blank"> AWS Elasticsearch </a>、<a class="ae jg" href="https://docs.aws.amazon.com/kms/latest/developerguide/services-parameter-store.html" rel="noopener ugc nofollow" target="_blank"> AWS参数存储</a>和<a class="ae jg" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/bucket-encryption.html" rel="noopener ugc nofollow" target="_blank"> AWS S3 </a>等等。</p><p id="2a1f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，为什么要加密静态数据呢？本质上，在基本层面上，这意味着当数据被存储时，使用加密密钥将其加密成不同的格式，因此在数据泄露中变得无用(<em class="le">,当然，除非攻击者能够通过某种方式解密数据</em>🔐 ).</p><p id="290f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">传输中的数据本质上是在服务之间传输的“实时数据”。许多AWS服务，如AWS EFS、AWS Glue和AWS Redshift，允许默认配置来防止窥探、访问或修改传输中的数据。默认情况下，许多服务使用SSL/TLS进行通信。</p><h2 id="8cfc" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">早期渗透测试</h2><p id="1908" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">在大规模云项目的开发阶段运行<a class="ae jg" href="https://portswigger.net/burp" rel="noopener ugc nofollow" target="_blank"> Burp Suite </a>等工具，可以像上述威胁建模一样，防止项目结束时的返工，因为根据我的经验，在项目结束时让专业外包公司运行渗透测试之前，您可以在早期发现大多数问题，并通过开发工作缓解这些问题。这可能包括解决围绕速率限制、响应头等的问题——根据我的经验，解决一个端点的问题通常会解决所有端点的问题👍</p><blockquote class="nv nw nx"><p id="48e4" class="kg kh le ki b kj kk kl km kn ko kp kq ny ks kt ku nz kw kx ky oa la lb lc ld im bi translated"><em class="jj">💡</em>通过查看特性文档，BurpSuite Pro可以作为您的<a class="ae jg" href="https://portswigger.net/burp#ci-integration" rel="noopener ugc nofollow" target="_blank"> CI集成的一部分运行</a>，尽管这不是我迄今为止在项目中做过的事情——这是我需要研究的事情。(在项目工作的不同阶段，总是在管道之外手工完成)</p></blockquote><h2 id="c18f" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">负载测试</h2><p id="9d52" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">说到对你的系统的信心，我认为必须在负载下测试，利用预期数字加上未来增长，并考虑季节性高峰(<em class="le">销售、假期等)</em>。如果可能的话，在项目的早期进行测试也是有益的，这样可以避免如上所述的返工。根据我的经验，安全问题通常可以在负载测试和设置速率限制时发现，以确保攻击者无法使您的系统停止运行。</p><p id="94a3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在使用API时，有许多工具可以使用，例如JMeter或<a class="ae jg" href="https://artillery.io/" rel="noopener ugc nofollow" target="_blank">火炮</a>；但是测试下游流程或后端集成也很重要，它们不是面向公众的；也许是使用队列或由CloudWatch事件触发的批处理的集成，以确保它们也像预期的那样在高负载下工作。</p><blockquote class="nv nw nx"><p id="0517" class="kg kh le ki b kj kk kl km kn ko kp kq ny ks kt ku nz kw kx ky oa la lb lc ld im bi translated"><em class="jj">💡</em>负载测试的结果可能会显示峰值负载下或事件驱动系统中的客户响应时间，例如，当异步流程完成且向客户发送电子邮件时。在我看来，它不仅仅需要考虑API在什么样的负载下变得没有响应..一切都是为了客户体验。</p></blockquote><h2 id="daef" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">结论</h2><p id="c8d3" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">关于安全性，我要说的一件事是，在我看来，这是团队中每个人的职责，需要从项目的第一天开始考虑，并且贯穿始终。</p><p id="01a3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">下一节:</strong> <a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-useful-resources-cd8e987f6d69" rel="noopener">有用资源</a>🚀<br/> <strong class="ki jk">上一节</strong> : <a class="ae jg" href="https://medium.com/@leejamesgilmore/enterprise-serverless-aws-limits-limitations-ce99e20432be" rel="noopener"> AWS限制&amp;限制</a>🚀</p><h1 id="fba6" class="lt lu jj bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">包扎</h1><p id="965c" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">让我们连接以下任何一项:</p><p id="feab" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae jg" href="https://www.linkedin.com/in/lee-james-gilmore/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/lee-james-gilmore/</a>T21<a class="ae jg" href="https://twitter.com/LeeJamesGilmore" rel="noopener ugc nofollow" target="_blank">https://twitter.com/LeeJamesGilmore</a></p><p id="b8b1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你觉得这些文章鼓舞人心或有用，请随时用虚拟咖啡<a class="ae jg" href="https://www.buymeacoffee.com/leegilmore" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/leegilmore</a>来支持我，不管怎样，让我们联系和聊天吧！☕️</p><p id="2840" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这些帖子，请关注我的简介<a class="ae jg" href="https://medium.com/u/2906c6def240?source=post_page-----39c4f4ae5aff----------------------" rel="noopener">李·詹姆斯·吉尔摩</a>以获取更多的帖子/系列，不要忘记联系并说<strong class="ki jk">嗨</strong>👋</p><h2 id="9a83" class="mw lu jj bd lv mx my dn lz mz na dp md kr nb nc mh kv nd ne ml kz nf ng mp nh bi translated">关于我</h2><p id="5688" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated"><strong class="ki jk"> " </strong> <em class="le">大家好，我是Lee，英国的AWS认证技术架构师和多语言软件工程师，是一名技术云架构师和无服务器主管，过去5年来主要从事AWS上的全栈JavaScript工作。</em></p><p id="b5ef" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">我认为自己是一个热爱AWS、创新、软件架构和技术的无服务器布道者。</em><strong class="ki jk"/></p><p id="444c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> ** </strong>所提供的信息是我个人的观点，我对这些信息的使用不承担任何责任。</p></div></div>    
</body>
</html>