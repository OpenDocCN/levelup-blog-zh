# 有用的角度提示和技巧

> 原文：<https://levelup.gitconnected.com/useful-angular-tips-and-tricks-f38df8276cc0>

![](img/b02ee6e79519af86fae5ebf1325a0be0.png)

官方的 Angular 文档包含了一些有效开发的最佳实践，但是还有其他的技巧可以帮助你使你的应用程序更容易维护和优化。

这里列出了我每天在 Angular 中使用的**技巧和诀窍**，它们将帮助你开发更好的应用程序。

# 使用服务来处理副作用

在构建你的应用程序时，**减少诸如 HTTP 请求、基于时间的事件等副作用总是有用的。**

将这些类型的操作从组件抽象为服务将会**降低组件的复杂性**，并且还会确保服务的可重用性**。**

一个典型的例子是从外部服务器获取数据:

这是一种显示远程端点收到的项目列表的合理方式，我们有一个专用的方法， **getItems()** ，它将进行 HTTP GET 调用并将结果保存在一个本地变量中。

就功能而言，这段代码没有任何问题，代码完成了它的工作并向用户显示了列表，但是**获取项目所使用的方法是组件本地的，不能重用** *，*，如果在其他组件中获取项目，将重复整个过程*。*

> *Angular 给了我们一个有用的工具来避免所有这些与使用服务有关的事情。*

让我们创建一个专用的 Angular 服务，并重构组件以用于外部请求:

然后我们将在组件中使用它:

> 该服务可用于获取应用程序范围内的项目。

# 使用 ng add

这个在 Angular 版本 6 中引入的工具可以用来**将一个发布的包添加到您的工作环境**中，它将在后台运行 schematics 来更新您的应用程序的功能。

使用此命令下载软件包时，它还会安装运行所需的额外依赖项，如 polyfills 等。

Ng add 为您的 Angular 应用程序提供了一些实用程序，例如使用服务工作将它转换为渐进式 web 应用程序，并提供离线功能。

例如，如果您想在应用程序中实现渐进式 web 应用程序功能，只需运行以下命令:

```
ng add @angular/pwa
```

你可以很容易地用 ng add 安装任何类型的包

```
ng add @angular/material
```

# 对导入语句使用别名

如果你正在开发复杂的组件，使得你的代码更加难以阅读，那么导入语句可能会非常混乱。

当你导入一个组件、一个服务或者任何你想导入到你的组件中的东西时，**你需要明确地写出资源所在的完整路径**

```
import { ThatComponent } from '../../../components/this-component/child-component'import { ThisService } from '../../../../services/this-service'
```

如果您为`components`和`services`路径使用别名会更有帮助，**这将使这些导入相对容易读取和导入**。

为了在你的 Angular 应用中实现这一点，你需要更新`tsconfig.json`文件:

在`compilerOptions`下，你可以找到具有默认值`./`的`baseUrl`属性，我们所做的是更新该值以指向`src`目录

然后添加一个名为`paths`的新属性，它是一个包含键值对的对象，这些键值对表示在我们的应用程序中为路径定义的别名，在上面的例子中，我们为`components`文件夹和`services`文件夹定义了别名。

现在，让我们改变之前的例子

```
import { ThatComponent } from '@components/this-component/child-component';import { ThisService } from '@services/this-service';
```

正如你现在所看到的，更加清晰易读。

# 字符串插值的安全导航运算符

当使用角度模板中的对象时，您会遇到这样的情况:变量被声明而没有默认值— **变量只是作为类型定义**出现。

当试图访问变量上不可用的属性时， **Angular 将抛出一个错误，称该变量未定义**。

例如，您的模板如下所示，您正在读取一个`student`对象的`name`属性:

```
<p>{{ student.name }}</p>
```

这就是变量在组件文件中的声明方式:

> Angular 会在这里抛出一个错误。

使用**安全导航操作符**，我们可以保护`name`属性不受任何`null`和`undefined`值的影响。

Angular 中的安全导航操作符是这个语法`?.`，我们可以更新模板来使用它:

```
<p> {{ student?.name }} </p>
```

> 当你运行这个，Angular 不会抛出任何错误，你的控制台是清晰的。

避免这种错误的另一个有用的技术是使用 and ( `&&`)操作符**在读取属性路径**之前检查该值是否存在。

我们可以更新示例以使用以下语法:

```
<p> {{ student && student.name }} </p>
```

如果该值不存在，Angular 将避免计算表达式，并且标记之间不会呈现任何内容。

# 使用错误处理程序正确处理错误

> Angular 附带了一个异常处理服务，可以用来管理应用程序范围内的错误。

> 当服务检测到错误时，它会捕获错误并将其记录到控制台。

该服务可以扩展，以添加我们的应用程序独有的附加功能，如使用错误监控平台记录错误或将错误发送到您的服务器进行分析。

这很容易扩展:我们需要创建一个`class`来扩展`ErrorHandler`的属性，并覆盖用于显示错误的内置`handleError`方法。

创建一个名为`error-handler.class.ts`的文件:

在上面的代码片段中，我们使用了一个虚构的错误报告和监控库，名为`@error-reporters`。

在扩展了`ErrorHandler`服务之后，我们将在用 ErrorHandler 的`handleError`方法处理错误之前，用`handleError`方法报告来自应用程序的错误。

之后，我们应该在`app.module.ts:`中注册我们的自定义`AppErrorHandler`

你可以通过 Angular [点击](https://angular.io/api/core/ErrorHandler)阅读更多关于默认错误处理程序的信息。

# 延迟加载非重要组件

如果你不想有无限的负载或者 UI 冻结，那么使用大型应用程序需要更多的关注性能。

Angular 应用程序由模块组成，您可以管理它们的加载，以确保应用程序初始渲染不需要的组件是延迟加载的。

> 惰性加载可以有效地减少你的应用程序的包大小，从而减少应用程序在浏览器上的加载时间。

要开始使用延迟加载，你至少需要两个模块，一个是你的应用程序的起点，通常是 **app.module** ，其他的可以代表用户可以导航的不同页面。

例如，让我们创建一个**功能模块**，当用户导航到路径…/功能时，必须加载该功能模块。

这是我的功能模块的外观

它是一个基本模块，包含一个组件`FeatureComponent`和一个与之相连的路由模块`FeatureRoutingModule`。

为了延迟加载特性模块及其组件，**我们将在应用程序的根模块**中注册它的路由模块，在我的例子中是 app.module:

通过这些简单的步骤，将在主应用捆绑包之外构建一个单独的捆绑包，当用户导航到`/feature`路线时，它将被加载。

这种体验可能会有点不愉快，因为用户需要等待**路线的包被加载**，这可能需要一段时间，具体取决于包的**大小。**

为了解决这个问题，我们将在初始页面完全加载后在后台预取其他包。

我们可以使用 Angular 提供的名为`preloadStrategy`的内置标志来做到这一点。

> 这告诉 Angular 在加载闲置的包时使用哪种策略。

让我们更新当前的实现以使用`PreloadAllModules`策略:

通过此次更新，Angular 将在后台处理功能包的预取，以便于导航。

# 结论

Angular 是一个框架，有它做事和产生结果的方式。

它有这么多流行和未知的特性，使用 Angular **发现完成困难任务的技巧的最简单方法是更多地使用 Angular，并在过程中进行更多的研究**。

上面列出的提示和技巧并没有完全涵盖使用 Angular 的广泛功能可以做的事情。

感谢阅读！