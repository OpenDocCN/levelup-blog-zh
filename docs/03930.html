<html>
<head>
<title>Performing Data Analytics on the Covid-19 Dataset using Python, NumPy and Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python、NumPy和Pandas对新冠肺炎数据集执行数据分析</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/performing-data-analytics-on-the-covid-19-dataset-using-python-numpy-and-pandas-bdfc352c61e9?source=collection_archive---------9-----------------------#2020-06-02">https://levelup.gitconnected.com/performing-data-analytics-on-the-covid-19-dataset-using-python-numpy-and-pandas-bdfc352c61e9?source=collection_archive---------9-----------------------#2020-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/710ed420510c0ca129bbc983233e3e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SR1rPtFckC5hSYTD"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kf" href="https://unsplash.com/@fusion_medical_animation?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">融合医学动画</a>拍摄的照片</figcaption></figure><p id="1d19" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我将利用位于<a class="ae kf" href="https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/sudalairajkumar/Novel-Corona-Virus-2019-Dataset</a>的<strong class="ki iu">小说电晕病毒2019数据集</strong>，进行一些数据分析。</p><p id="7c7b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">特别是，我将使用Jupyter笔记本，以及Python、NumPy和Pandas。</p><p id="8347" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该数据集由几个文件组成:</p><ul class=""><li id="63c1" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu"> covid_19_data.csv </strong> —包含每个国家所有各州/省的观察结果列表。它包含对确诊、死亡和恢复病例的观察。</li><li id="c84c" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">covid 19 _ line _ list _ data . CSV</strong>—包含病例的详细列表，包括位置、症状、医院就诊以及信息来源等细节。</li><li id="f02d" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">covid 19 _ open _ line _ list . CSV</strong>—类似于之前的文件(<strong class="ki iu">covid 19 _ line _ list _ data . CSV</strong>)。</li><li id="3007" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">time _ series _ covid _ 19 _ confirmed _ US</strong>—美国所有确诊病例的详细分类。包含位置、城市和州等详细信息。</li><li id="7794" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">time _ series _ covid _ 19 _ deaths _ US . CSV</strong>—美国所有死亡病例的详细分类。包含位置、城市和州等详细信息。</li><li id="5c4a" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">time _ series _ covid _ 19 _ confirmed . CSV</strong>—包含全球所有国家的所有确诊病例列表。它列出了每个国家的省/州，以及每个位置的地理位置。</li><li id="f311" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">time _ series _ covid _ 19 _ deaths . CSV</strong>—包含世界上所有国家的所有死亡病例列表。它列出了每个国家的省/州，以及每个位置的地理位置。</li><li id="8f27" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">time _ series _ covid _ 19 _ recovered . CSV</strong>—包含全球所有国家/地区的所有已恢复病例列表。它列出了每个国家的省/州，以及每个位置的地理位置。</li></ul><p id="4d2b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我有兴趣探究受新冠肺炎影响的每个国家的各种统计数据。因此，我对这三个CSV文件特别感兴趣:</p><ul class=""><li id="8ff3" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">时间序列_covid_19_confirmed.csv </strong></li><li id="55fe" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">时间序列_ covid _ 19 _死亡人数. csv </strong></li><li id="96d9" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">time _ series _ covid _ 19 _ recovered . CSV</strong></li></ul><blockquote class="ls lt lu"><p id="249d" class="kg kh lv ki b kj kk kl km kn ko kp kq lw ks kt ku lx kw kx ky ly la lb lc ld im bi translated">事实上，我也可以使用<strong class="ki iu"> covid_19_data.csv文件</strong>，因为它方便地将所有确诊、康复和死亡病例合并在一个文件中。不幸的是，它不包含每个位置的纬度和经度(我想用它在地图上标出)。因此，我决定使用3个单独的CSV文件。</p></blockquote><p id="7f79" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，使用Excel打开上述CVS文件并浏览每个文件中的各个列是一个好主意。</p><h1 id="cc34" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak">导入包</strong></h1><p id="2511" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">对于所有项目，首先要做的是导入相关的模块和包:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="346f" class="nl ma it nh b gy nm nn l no np">import pandas as pd<br/>import numpy as np</span></pre><h1 id="cb5f" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">加载CSV文件</h1><p id="36f4" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">对于这篇文章，我使用的数据集的日期是2020年5月26日<strong class="ki iu">。</strong></p><blockquote class="ls lt lu"><p id="3a87" class="kg kh lv ki b kj kk kl km kn ko kp kq lw ks kt ku lx kw kx ky ly la lb lc ld im bi translated">对于您自己的实验，我建议您下载最新的数据集并跟随。</p></blockquote><p id="1bb7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我将CSV文件保存在名为“<strong class="ki iu">数据集—2020年5月26日</strong>”的文件夹下。</p><p id="0e4d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在不要将CSV文件加载到Pandas数据帧中:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="075e" class="nl ma it nh b gy nm nn l no np">dataset_path   = "./Dataset - 26 May 2020/"</span><span id="b4d5" class="nl ma it nh b gy nq nn l no np">df_conf      = pd.read_csv(dataset_path + <br/>               "time_series_covid_19_confirmed.csv")<br/>df_death     = pd.read_csv(dataset_path + <br/>               "time_series_covid_19_deaths.csv")<br/>df_recovered = pd.read_csv(dataset_path + <br/>               "time_series_covid_19_recovered.csv")</span><span id="9894" class="nl ma it nh b gy nq nn l no np">print(df_conf.shape)<br/>print(df_death.shape)<br/>print(df_recovered.shape)</span></pre><p id="ca05" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">观察每个数据帧的形状:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="c50f" class="nl ma it nh b gy nm nn l no np">(266, 129)<br/>(266, 129)<br/>(253, 129)</span></pre><p id="9f33" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，请注意<strong class="ki iu"> df_recovered </strong>数据帧的形状与其他两个不同。让我们进一步挖掘，看看为什么它的行数比其他两个少。</p><p id="e683" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看<strong class="ki iu"> df_conf </strong>数据帧是什么样子的:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="d643" class="nl ma it nh b gy nm nn l no np">df_conf</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/30dca1c2cdcdb12e34b59cf2f8d871a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygZEEy8hoBqqlW7eecAN-A.png"/></div></div></figure><h1 id="fb31" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">排序和查看数据帧</h1><p id="eacf" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">现在让我们按照<strong class="ki iu">省/州</strong>和<strong class="ki iu">国家/地区</strong>对数据帧进行排序:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="9a53" class="nl ma it nh b gy nm nn l no np">df_conf = df_conf.sort_values(<br/>    by=['Province/State','Country/Region'])<br/>df_conf = df_conf.reset_index(drop=True)</span><span id="23df" class="nl ma it nh b gy nq nn l no np">df_death = df_death.sort_values(<br/>    by=['Province/State','Country/Region'])<br/>df_death = df_death.reset_index(drop=True)</span><span id="91f6" class="nl ma it nh b gy nq nn l no np">df_recovered = df_recovered.sort_values(<br/>    by=['Province/State','Country/Region'])<br/>df_recovered = df_recovered.reset_index(drop=True)</span></pre><p id="500b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们快速看一下数据帧的样子。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="eb03" class="nl ma it nh b gy nm nn l no np">df_conf</span></pre><p id="fe22" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将看到以下内容:</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/879ae2ab4a95b32c2256c2f4c835f6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H34iorIB6--1LCj4pTiBrA.png"/></div></div></figure><p id="3a83" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其他两个数据帧(<strong class="ki iu"> df_death </strong>和<strong class="ki iu"> df_recovered </strong>)看起来相似。请注意以下事项—每个报告案例的日期都存储在列中。从第4列开始，它列出了每天报告的案例—<em class="lv">2020年1月22日</em>、<em class="lv">2020年1月23日</em>等等。在我们的分析中，我们需要将所有这些日期转换成一列，另一列表示每天的实际数字。但在此之前，让我们比较三个数据帧，看看它们是否包含相同的行:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="5155" class="nl ma it nh b gy nm nn l no np"># check if two dfs columns are the same<br/>print(df_conf[["Province/State","Country/Region"]].equals(<br/>      df_death[["Province/State","Country/Region"]]))<br/>'''<br/>True<br/>'''</span><span id="5c1b" class="nl ma it nh b gy nq nn l no np">print(df_conf[["Province/State","Country/Region"]].equals(<br/>      df_recovered[["Province/State","Country/Region"]]))<br/>'''<br/>False<br/>'''</span></pre><p id="4cd6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上面的输出中可以看到，<strong class="ki iu"> df_conf </strong>和<strong class="ki iu"> df_death </strong> dataframes包含两列相同的项目，即<strong class="ki iu">省/州</strong>和<strong class="ki iu">国家/地区</strong>。但是，它们不同于<strong class="ki iu"> df_recovered </strong>数据帧。</p><p id="f032" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">原因是因为<strong class="ki iu">time _ series _ covid _ 19 _ recovered . csv</strong>将<em class="lv">加拿大</em>记录为一个国家，而另外两个CSV文件记录<em class="lv">加拿大</em>及其各个州:</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/c893eeeddfab1f1a134bc028b53705f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*IgY8_0p7xV7BA3W7anthyQ.png"/></div></div></figure><p id="e15b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出于这个原因(为了使本文简单起见)，我将省略已恢复案例的数据集(<strong class="ki iu">time _ series _ covid _ 19 _ recovered . CSV</strong>)。</p><h1 id="14dc" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">提取包含日期和时间的列的名称</h1><p id="4da3" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">现在让我们提取CSV文件中记录的各种日期:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="457b" class="nl ma it nh b gy nm nn l no np">dates_conf = df_conf.columns[4:]<br/>dates_death = df_death.columns[4:]</span><span id="4cb3" class="nl ma it nh b gy nq nn l no np">print(dates_conf)<br/>print(dates_death)</span><span id="df6d" class="nl ma it nh b gy nq nn l no np"># make sure the dates are all the same for the 2 dfs<br/>if dates_conf.equals(dates_death): <br/>    print("Dates are the same")</span></pre><p id="0b51" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您应该会看到以下输出:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="c94c" class="nl ma it nh b gy nm nn l no np">Index(['1/22/20', '1/23/20', '1/24/20', '1/25/20', '1/26/20', '1/27/20',<br/>       '1/28/20', '1/29/20', '1/30/20', '1/31/20',<br/>       ...<br/>       '5/16/20', '5/17/20', '5/18/20', '5/19/20', '5/20/20', '5/21/20',<br/>       '5/22/20', '5/23/20', '5/24/20', '5/25/20'],<br/>      dtype='object', length=125)</span><span id="facd" class="nl ma it nh b gy nq nn l no np">Index(['1/22/20', '1/23/20', '1/24/20', '1/25/20', '1/26/20', '1/27/20',<br/>       '1/28/20', '1/29/20', '1/30/20', '1/31/20',<br/>       ...<br/>       '5/16/20', '5/17/20', '5/18/20', '5/19/20', '5/20/20', '5/21/20',<br/>       '5/22/20', '5/23/20', '5/24/20', '5/25/20'],<br/>      dtype='object', length=125)<br/>Dates are the same</span></pre><h1 id="0332" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">将数据帧从宽格式取消透视为长格式</h1><p id="a4d1" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">我现在想取消数据帧的透视，这样日期就不再用列来表示了。相反，日期应该存储为新列下的值，比如说<strong class="ki iu"> Date </strong>。病例数(<strong class="ki iu">确诊</strong>、<strong class="ki iu">死亡</strong>)应该保存为相应的一栏，比如说<strong class="ki iu">确诊</strong>、<strong class="ki iu">死亡</strong>。为此，我可以使用<strong class="ki iu"> melt() </strong>函数:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="432c" class="nl ma it nh b gy nm nn l no np">df_conf_melted = df_conf.melt(id_vars=['Province/State', <br/>                              'Country/Region', 'Lat', 'Long'], <br/>                              value_vars=dates_conf, <br/>                              var_name='Date',<br/>                              value_name='Confirmed')</span><span id="eab6" class="nl ma it nh b gy nq nn l no np">df_death_melted = df_death.melt(id_vars=['Province/State', <br/>                                'Country/Region', 'Lat', 'Long'],                                <br/>                                value_vars=dates_death,<br/>                                var_name='Date', <br/>                                value_name='Deaths')</span></pre><h1 id="2b65" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">查看未透视的数据帧</h1><p id="0f5d" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">您现在可以查看未透视的数据帧。让我们先从<strong class="ki iu"> df_conf_melted </strong>开始:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="4cfb" class="nl ma it nh b gy nm nn l no np">df_conf_melted</span></pre><p id="8f4e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将看到以下内容:</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/407d4830a715ecdce50e995f6dc1dff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lB5pdVTHWektJE17jWyzQ.png"/></div></div></figure><p id="1595" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们来看看<strong class="ki iu"> df_death_melted </strong>:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="a1a8" class="nl ma it nh b gy nm nn l no np">df_death_melted</span></pre><p id="09bd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将看到以下内容:</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/9eecd5f99b74098fa2cf2a7ab6bf3062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*toYeLU-4Rxonm3SDkTJJrg.png"/></div></figure><p id="6b7b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只是为了确保两个数据帧具有相同的形状:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="0fae" class="nl ma it nh b gy nm nn l no np">print(df_conf_melted.shape)<br/>print(df_death_melted.shape)<br/>'''<br/>(33250, 6)<br/>(33250, 6)<br/>'''</span></pre><h1 id="615e" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">将所有非透视数据帧合并成一个数据帧</h1><p id="f0bf" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">现在，我想将这两个独立的数据帧合并为一个数据帧，以便将来更容易执行分析:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="f236" class="nl ma it nh b gy nm nn l no np">df_combined = pd.concat([df_conf_melted, <br/>                         df_death_melted["Deaths"]], <br/>                         axis = 1, <br/>                         sort = False)<br/>df_combined</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nw"><img src="../Images/66ed74be2824c01ec981c6d72e43ca96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yiUYAL36MbKxgBmQdhdB0g.png"/></div></div></figure><p id="1eb8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，计算相对于确诊病例数的死亡百分比是有用的:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="795f" class="nl ma it nh b gy nm nn l no np">df_combined["Percentage"] = <br/>    df_combined["Deaths"]/df_combined["Confirmed"]</span><span id="c673" class="nl ma it nh b gy nq nn l no np">df_combined</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nx"><img src="../Images/2349a396007d7ab5d70c114dcea2a920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*umzeto72UW3G23wQzbXzlw.png"/></div></div></figure><p id="3501" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为有些单元格是NaNs(由被零除引起)，所以用0替换它们很重要:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="600a" class="nl ma it nh b gy nm nn l no np">df_combined.fillna(0, inplace=True)</span><span id="6bbf" class="nl ma it nh b gy nq nn l no np">df_combined</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ny"><img src="../Images/66ce7150763cb303626e4ad136f91e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*obew4it7Laa_orfWCqd4MA.png"/></div></div></figure><p id="f22c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查数据帧中各列的数据类型非常有用:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="5c35" class="nl ma it nh b gy nm nn l no np">df_combined.dtypes<br/>'''<br/>Province/State     object<br/>Country/Region     object<br/>Lat               float64<br/>Long              float64<br/>Date               object<br/>Confirmed           int64<br/>Deaths              int64<br/>Percentage        float64<br/>'''</span></pre><p id="a825" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">特别是对象类型中的<strong class="ki iu">日期</strong>列(即字符串)。</p><h1 id="b6a0" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">将日期列更改为日期时间格式</h1><p id="7625" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">我们需要将日期列转换成<strong class="ki iu"> datetime.date </strong>格式，以便稍后我们可以基于日期执行排序。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="488e" class="nl ma it nh b gy nm nn l no np">import datetime</span><span id="6ed3" class="nl ma it nh b gy nq nn l no np">def format_time(datetime_str):    <br/>    d = datetime.datetime.strptime(datetime_str, '%m/%d/%y')    <br/>    return d.date()</span><span id="b351" class="nl ma it nh b gy nq nn l no np">df_combined["Date"] = df_combined["Date"].apply(format_time)<br/>df_combined</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/e895b9dbd48b22c0c3436bfa8a4650d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uwSRsP9AGJRWGugYIlcVA.png"/></div></div></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="d588" class="lz ma it bd mb mc oh me mf mg oi mi mj mk oj mm mn mo ok mq mr ms ol mu mv mw bi translated">显示每日确诊和死亡病例数</h1><p id="95d0" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">现在，数据帧已经合并为一个，并经过了大量清理，我们可以开始执行一些分析，以便从数据帧中获取一些有用的信息。</p><p id="39e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从显示每日确诊和死亡病例数开始:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="eac9" class="nl ma it nh b gy nm nn l no np">grouped_by_date = df_combined.groupby("Date")<br/>for date, group in grouped_by_date:<br/>    print("==========")<br/>    print(date)<br/>    print("==========")<br/>    print(group[["Province/State","Country/Region", "Confirmed", <br/>        "Deaths"]])</span></pre><p id="63fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您现在将看到每天的确诊和死亡病例数:</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi om"><img src="../Images/958963c9cc446a8957c6e5cc9d54cf34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7MfkoXnJoPd6PaYF7WDpg.png"/></div></div></figure><h1 id="0a63" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">显示每个国家每天确诊和死亡的总人数</h1><p id="a4d2" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">之前的结果显示了每个国家每个省/州的数量。如果您只想知道每个国家的总数，您可以执行汇总:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="88d1" class="nl ma it nh b gy nm nn l no np">df_daily = df_combined.groupby(["Date","Country/Region"]).aggregate(<br/>    {'Confirmed': 'sum', 'Deaths': 'sum'})</span><span id="1878" class="nl ma it nh b gy nq nn l no np">df_daily</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi on"><img src="../Images/73624f3f32e35ba352867a29ffa3d3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*MHUWBsqY2x49YB8eyE6vcg.png"/></div></div></figure><h1 id="4213" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">获取特定一天的数据</h1><p id="265c" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">如果你想得到某一天的数字，你可以使用<strong class="ki iu"> loc[] </strong>索引器:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="676f" class="nl ma it nh b gy nm nn l no np">df_day = df_daily.loc[<strong class="nh iu">format_time('3/22/20')</strong>]</span><span id="3224" class="nl ma it nh b gy nq nn l no np">df_day</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oo"><img src="../Images/288262d1581e00673a673c0a97d1cfa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*SltDEu_XG899PeyI2BdDvw.png"/></div></div></figure><h1 id="ea26" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">获取特定国家特定日期的数据</h1><p id="f4cf" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">您还可以检索特定国家的号码:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="2054" class="nl ma it nh b gy nm nn l no np">df_day_country = df_daily.loc[(<strong class="nh iu">format_time('5/22/20')</strong>,<strong class="nh iu">'US'</strong>)]<br/>df_day_country<br/>'''<br/>Confirmed    1600937<br/>Deaths         95979<br/>Name: (2020-05-22, US), dtype: int64<br/>'''</span></pre><h1 id="9ea4" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">显示最近一天的数据</h1><p id="46d2" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">要获取最近一天的数字，首先获取数据帧中的最后一个日期，然后使用它提取该日期的数据:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="4183" class="nl ma it nh b gy nm nn l no np"># get the most recent date<br/>most_recent_date = df_combined['Date'].max()<br/>print(most_recent_date)<br/>'''<br/>2020-05-25<br/>'''</span><span id="3c5d" class="nl ma it nh b gy nq nn l no np"># get all the data on the most recent date<br/>df_most_recent = df_daily.loc[most_recent_date,:]<br/>df_most_recent</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi op"><img src="../Images/aa16744ffaf68ff5f1ef7d83fcd95863.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*DymTwpKW3EAy2xnBO58Sjg.png"/></div></figure><h1 id="a3d5" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">确诊病例最多的10个国家</h1><p id="36e6" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">要获得确诊病例最多的10个国家，按<strong class="ki iu">确诊</strong>列对<strong class="ki iu"> df_most_recent </strong>数据框进行排序，然后显示前10行:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="af5f" class="nl ma it nh b gy nm nn l no np">df_most_confirmed_recent_sorted = <br/>    df_most_recent.sort_values(by="Confirmed", ascending=False)</span><span id="59ed" class="nl ma it nh b gy nq nn l no np">df_most_confirmed_recent_sorted.head(10)</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/03a5cb1af154dd56d9b62e7d5aaef9da.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*Ou327it_iFKgfdQaABUUmQ.png"/></div></figure><h1 id="2c4b" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">显示特定国家的最新数字</h1><p id="1a50" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">您可以使用<strong class="ki iu"> input() </strong>功能要求用户输入他/她想知道的国家:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="d23e" class="nl ma it nh b gy nm nn l no np">df_most_recent[df_most_recent.index == <br/>    input("Enter the country name: ")]</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi or"><img src="../Images/c6acd3427c0d323aec529343e9ea6588.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*NTxBXqeebu8hIJQq9G4snw.png"/></div></figure><h1 id="f98a" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">报告死亡人数最多的10个国家</h1><p id="1d20" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">要获得报告死亡人数最多的10个国家，首先使用<strong class="ki iu">死亡人数</strong>列对<strong class="ki iu"> df_most_recent </strong>数据帧进行排序。然后，过滤掉那些没有死亡报告的国家。最后，显示前10行:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="6a02" class="nl ma it nh b gy nm nn l no np">df_most_deaths_recent_sorted = <br/>    df_most_recent.sort_values(by="Deaths", ascending=False)</span><span id="651b" class="nl ma it nh b gy nq nn l no np">df_most_deaths_recent_sorted = <br/>    df_most_deaths_recent_sorted[<br/>        df_most_deaths_recent_sorted.Deaths&gt;0]</span><span id="2ce9" class="nl ma it nh b gy nq nn l no np">df_most_deaths_recent_sorted.head(10)</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi os"><img src="../Images/f8d7699d8d71c04ce983e0a265a784dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*bI9PLWgwjk6Q9oVtg2lmiw.png"/></div></figure><h1 id="0428" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">显示Mainland China的最新数据</h1><p id="4b9e" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">早在新冠肺炎早期，中国相当多的省份都受到了感染。所以看看中国各省的数据会很有趣:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="d50e" class="nl ma it nh b gy nm nn l no np"># get all the rows for Mainland China<br/>df_combined_china = <br/>    df_combined[df_combined['Country/Region'] == "China"]</span><span id="4d21" class="nl ma it nh b gy nq nn l no np"># using the china dataframe, group by date and province<br/>df_combined_china_date = <br/>    df_combined_china.groupby(["Date","Province/State"]).aggregate(<br/>        {'Confirmed': 'sum', 'Deaths': 'sum'})</span><span id="8084" class="nl ma it nh b gy nq nn l no np"># find the data for the most recent date<br/>df_combined_china_most_recent = <br/>    df_combined_china_date.loc[most_recent_date,:]</span><span id="e5c8" class="nl ma it nh b gy nq nn l no np">df_combined_china_most_recent</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi os"><img src="../Images/e3a19ced0245bec15216e0950f465ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*jUznamQcUK3DYbzuuPkJeA.png"/></div></figure><h1 id="551d" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">显示中国确诊病例最多的10个省份</h1><p id="b25b" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">要获得中国确诊病例最多的前10个省份，请按<strong class="ki iu">确诊</strong>列对<strong class="ki iu">df _ combined _ China _ most _ recent</strong>数据帧进行排序，并返回其前10行:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="bac1" class="nl ma it nh b gy nm nn l no np">df_combined_china_most_recent_sorted = <br/>    df_combined_china_most_recent.sort_values(by="Confirmed",                                                                                <br/>        ascending=False).head(10)</span><span id="314b" class="nl ma it nh b gy nq nn l no np">df_combined_china_most_recent_sorted</span></pre><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/d5be64ae22b6218db86ca4bb83b02de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*IeQ9kLoxQgbpL2Png_HA9Q.png"/></div></figure><p id="bbb5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，<strong class="ki iu">湖北</strong>是中国受灾最严重的省份。</p><blockquote class="ls lt lu"><p id="d660" class="kg kh lv ki b kj kk kl km kn ko kp kq lw ks kt ku lx kw kx ky ly la lb lc ld im bi translated">新冠肺炎的爆发首先是在武汉(武汉是中华人民共和国湖北省的省会城市)发现的。</p></blockquote><h1 id="05cb" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">摘要</h1><p id="b996" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">这就是本文的全部内容。我希望这篇文章对您有用，并帮助您开始使用Python进行数据分析。在下一篇文章中，我将向您展示如何使用<strong class="ki iu"> matplotlib </strong>库在新冠肺炎数据集上执行可视化。回头见！</p><p id="5aec" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章的第二部分已经完成。</p><div class="ot ou gp gr ov ow"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">加入媒介与我的介绍链接-李伟孟</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">weimenglee.medium.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk jz ow"/></div></div></a></div></div></div>    
</body>
</html>