<html>
<head>
<title>How To Add Netlify Redirects To A Gatsby Site</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Netlify重定向添加到Gatsby站点</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-add-netlify-redirects-to-a-gatsby-site-ae678518cc91?source=collection_archive---------1-----------------------#2019-12-23">https://levelup.gitconnected.com/how-to-add-netlify-redirects-to-a-gatsby-site-ae678518cc91?source=collection_archive---------1-----------------------#2019-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/98fbb6347194823086066ec8e5c16bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NUMywiwxz5KPJBcr"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@bdchu614?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布伦丹·丘奇</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="bedb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用Netlify托管你的Gatsby站点是一个完美的组合。使用这两者，整个开发工作流程变得非常顺畅。然而，例如，重定向还不能开箱即用，或者至少不能按照您期望的方式工作。因此，本文应该向您展示两种方法，如何向Netlify上托管的Gatsby站点添加重定向。</p><p id="91d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">选项1 </strong> <br/>通过<code class="fe le lf lg lh b">_redirects</code>文件添加重定向</p><p id="29ca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">选项2 <br/> </strong>通过<code class="fe le lf lg lh b">createRedirect</code>动作添加重定向</p><p id="de8f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你选择哪一个取决于你，无论你喜欢什么。然而，由于这两者在《盖茨比》中都不能开箱即用，我们首先必须安装一个名为<a class="ae kf" href="https://www.gatsbyjs.org/packages/gatsby-plugin-netlify/" rel="noopener ugc nofollow" target="_blank"> gatsby-plugin-netlify </a>的插件。它是一个官方的Gatsby插件，将处理我们在构建过程中设置的重定向。您可以查看链接了解更多信息。要安装插件，使用以下命令:<code class="fe le lf lg lh b">npm install gatsby-plugin-netlify</code></p><p id="72f3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">安装完成后，不要忘记将插件添加到您的<code class="fe le lf lg lh b">gatsby-config.js</code>文件中。只需将<code class="fe le lf lg lh b">`gatsby-plugin-netlify`</code>添加到你的插件阵列中。完成这些后，您就可以从其中一个选项开始了。</p><h1 id="62ed" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">选项1 —通过_redirects文件添加重定向</h1><blockquote class="mg mh mi"><p id="367f" class="kg kh mj ki b kj kk kl km kn ko kp kq mk ks kt ku ml kw kx ky mm la lb lc ld im bi translated">确保您已经安装了<code class="fe le lf lg lh b">gatsby-plugin-netlify</code> ( <a class="ae kf" href="#de8f" rel="noopener ugc nofollow">参见此处</a>)</p></blockquote><p id="5ca0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的第一个选择是通过一个<code class="fe le lf lg lh b">_redirects</code>文件添加重定向。如果您以前使用过Netlify，那么您很可能对此很熟悉。这是用Netlify处理重定向的最常见方式。通常，您会将该文件添加到您的构建目录中。但是由于Gatsby是在构建过程中动态创建这个目录的，所以以前没有办法在其中放入任何东西。</p><p id="17d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了绕过这个问题，我们可以使用Gatsby提供的<code class="fe le lf lg lh b">static</code>文件夹。在构建过程中，我们放入该文件夹的所有内容都将被复制到我们的构建目录中。因此，我们可以创建一个<code class="fe le lf lg lh b">_redirects</code>文件，将其放在<code class="fe le lf lg lh b">static</code>文件夹中，之前安装的插件将处理其他一切。因此，我们需要做的是:</p><ol class=""><li id="b2d7" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">如果你还没有完成，在你的Gatsby站点的根目录下创建一个名为<code class="fe le lf lg lh b">static</code>的文件夹(所以直接在<code class="fe le lf lg lh b">src</code>文件夹旁边)。</li><li id="34c1" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">在<code class="fe le lf lg lh b">static</code>文件夹中，创建一个名为<code class="fe le lf lg lh b">_redirects</code>的文件</li><li id="bd92" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">在<code class="fe le lf lg lh b">_redirects</code>文件中，你可以写下你所有的重定向。这些重定向应该遵循Netlify使用的重定向语法。你可以在<a class="ae kf" href="https://play.netlify.com/redirects" rel="noopener ugc nofollow" target="_blank">网络游戏场</a>检查你的重定向是否正确。</li><li id="3e69" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">将您的项目部署到Netlify并享受您的重定向！</li></ol><h2 id="bb78" class="nb lj it bd lk nc nd dn lo ne nf dp ls kr ng nh lw kv ni nj ma kz nk nl me nm bi translated">示例:</h2><p id="08eb" class="pw-post-body-paragraph kg kh it ki b kj nn kl km kn no kp kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">Netlify上重定向的一个常见用例是将所有访问者从您的默认Netlify子域转发到您的自定义主域。如果您想这样做，您的<code class="fe le lf lg lh b">_redirects</code>文件应该是这样的:</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h1 id="a6c1" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">选项2-通过createRedirect操作添加重定向</h1><blockquote class="mg mh mi"><p id="5efd" class="kg kh mj ki b kj kk kl km kn ko kp kq mk ks kt ku ml kw kx ky mm la lb lc ld im bi translated">确保你已经安装了<code class="fe le lf lg lh b"><em class="it">gatsby-plugin-netlify</em></code> ( <a class="ae kf" href="#de8f" rel="noopener ugc nofollow">看这里</a>)</p></blockquote><p id="092e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通常在Gatsby中，客户端重定向是在构建过程中通过<code class="fe le lf lg lh b">createRedirect</code>动作创建的。但是使用我们之前安装的插件，我们也可以使用相同的操作来创建服务器端重定向。因此，您可以使用相同的类似Gatsby的语法来创建Netlify重定向。</p><p id="878b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要开始创建重定向，我们需要做以下工作:</p><ol class=""><li id="5be8" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">导航到您的<code class="fe le lf lg lh b">gatsby-node.js</code>文件。这里的代码在构建过程中运行一次，因此是创建重定向的完美地方。</li><li id="2e2f" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">通常，在创建页面时会创建重定向。所以我们必须先用<code class="fe le lf lg lh b">exports.createPages = ({ actions }) =&gt; {}</code>调用<code class="fe le lf lg lh b">gatsby-node.js</code>文件里面的<code class="fe le lf lg lh b">createPages</code>动作</li><li id="d764" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">在<code class="fe le lf lg lh b">createPages</code>函数内部，我们可以销毁<code class="fe le lf lg lh b">actions</code>参数，从而访问<code class="fe le lf lg lh b">createRedirect</code>方法。</li><li id="bfb3" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">通过使用<code class="fe le lf lg lh b">createRedirect</code>方法，我们最终可以创建重定向！</li></ol><h2 id="f4fd" class="nb lj it bd lk nc nd dn lo ne nf dp ls kr ng nh lw kv ni nj ma kz nk nl me nm bi translated">例子</h2><p id="78dd" class="pw-post-body-paragraph kg kh it ki b kj nn kl km kn no kp kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">听起来复杂的事情实际上非常简单。让我们坚持我们已经在选项1中使用的例子。在那里，我们创建了一个重定向，将所有访问者从我们的默认Netlify子域转发到我们的自定义主域。我们现在想对<code class="fe le lf lg lh b">createRedirect</code>动作做同样的事情。</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="4aa0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，我们可以在<code class="fe le lf lg lh b">createPages</code>动作中访问<code class="fe le lf lg lh b">createRedirect</code>方法。<code class="fe le lf lg lh b">createRedirect</code>方法将一个具有以下属性的对象作为参数:</p><p id="b029" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">fromPath</code>:从<br/> <code class="fe le lf lg lh b">toPath</code>重定向的旧URL:重定向到<br/> <code class="fe le lf lg lh b">isPermanent</code>的新URL:将状态代码设置为301 <br/> <code class="fe le lf lg lh b">force</code>:一个特定于网络的属性，我们在这里需要它来创建域名别名重定向</p><p id="0d55" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想更深入地了解一下，<code class="fe le lf lg lh b">createRedirect</code>动作还有几个属性，你可以在Gatsby文档中查看<a class="ae kf" href="https://www.gatsbyjs.org/docs/actions/#createRedirect" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="f69f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总之，Gatsby中的Netlify重定向还不能开箱即用，但无论如何都很容易实现。您可以通过一个<code class="fe le lf lg lh b">_redirects</code>文件选择类似Netlify的方式，或者坚持使用Gatsby方法，该方法利用了<code class="fe le lf lg lh b">gatsby-node.js</code>中的<code class="fe le lf lg lh b">createRedirect</code>动作。</p><p id="c7ec" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望这个简短的教程对你有所帮助，你可以跟着做。如果您有任何进一步的问题或发现一些错误，请让我知道！</p></div></div>    
</body>
</html>