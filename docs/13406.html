<html>
<head>
<title>How to use the Router-Store in NgRx</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用NgRx中的路由器存储</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-use-the-router-store-in-ngrx-24f6ae37290a?source=collection_archive---------5-----------------------#2022-09-02">https://levelup.gitconnected.com/how-to-use-the-router-store-in-ngrx-24f6ae37290a?source=collection_archive---------5-----------------------#2022-09-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e1cb231111eeb329cf27f37380ad95ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*phoIp_QHSlsihY4e.png"/></div></div></figure><h1 id="0ea3" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">NgRx中路由器存储的目的是什么？</h1><p id="fbfb" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">正如我在<a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/ngrx-explained-3891da35eeea">上一篇关于NgRx </a>的文章中所解释的，NgRx的目的是分离我们前端应用程序的数据管理部分，以便代码更容易管理。我们不必使用发射器和输入来在组件之间传递数据，但是我们使用动作和选择器直接引用NgRx存储来满足任何数据需求。而有时候我们需要的数据就是来自路由器，比如路由的标题。我们肯定可以创建<code class="fe lv lw lx ly b">states</code>和<code class="fe lv lw lx ly b">selectors</code>来使用正常的NgRx方式检索数据，但是，NgRx提供了<a class="ae lu" href="https://ngrx.io/guide/router-store" rel="noopener ugc nofollow" target="_blank">路由器存储库</a>来使检索导航数据变得更容易。</p><p id="8b7e" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">但是，请注意，来自路由器存储的所有数据实际上都可以在<a class="ae lu" href="https://angular.io/api/router/ActivatedRoute" rel="noopener ugc nofollow" target="_blank"> ActivateRoute </a>中找到。但是如果您已经在使用NgRx，那么从ActivatedRoute获取路线数据就违背了将数据从用户界面中分离出来的目的。</p><h1 id="f574" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">装置</h1><pre class="me mf mg mh gt mi ly mj mk aw ml bi"><span id="1424" class="mm jz iq ly b gy mn mo l mp mq">ng add @ngrx/router-store@latest</span></pre><h1 id="7ddb" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">使用</h1><blockquote class="mr ms mt"><p id="c6e4" class="kw kx mu ky b kz lz lb lc ld ma lf lg mv mb lj lk mw mc ln lo mx md lr ls lt ij bi translated">请注意，<code class="fe lv lw lx ly b">@ngrx/store</code>是必需的，<code class="fe lv lw lx ly b">@ngrx/router-store</code>是一个附加组件，并不是独立的。</p></blockquote><p id="0d5d" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">将<code class="fe lv lw lx ly b">StoreRouterConnectingModule.forRoot()</code>添加到模块的<code class="fe lv lw lx ly b">imports</code>数组中。当您执行上面的安装命令时，应该已经完成了。</p><p id="7c6b" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">然后添加一个新文件<code class="fe lv lw lx ly b">router.selectors.ts</code>到你所有其他NgRx文件的同一个文件夹中。</p><pre class="me mf mg mh gt mi ly mj mk aw ml bi"><span id="ae1a" class="mm jz iq ly b gy mn mo l mp mq">import { getSelectors, RouterReducerState } from '@ngrx/router-store';</span><span id="a549" class="mm jz iq ly b gy my mo l mp mq">// `router` is used as the default feature name. You can use the feature name<br/>// of your choice by creating a feature selector and pass it to the `getSelectors` function<br/>// export const selectRouter = createFeatureSelector&lt;RouterReducerState&gt;('yourFeatureName');</span><span id="da80" class="mm jz iq ly b gy my mo l mp mq">export const {<br/>  selectCurrentRoute, // select the current route<br/>  selectFragment, // select the current route fragment<br/>  selectQueryParams, // select the current route query params<br/>  selectQueryParam, // factory function to select a query param<br/>  selectRouteParams, // select the current route params<br/>  selectRouteParam, // factory function to select a route param<br/>  selectRouteData, // select the current route data<br/>  selectUrl, // select the current url<br/>  selectTitle, // Select the title if available<br/>} = getSelectors();</span></pre><p id="0819" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">上述代码也可以在NgRx路由器官方商店页面上找到—<a class="ae lu" href="https://ngrx.io/guide/router-store/selectors" rel="noopener ugc nofollow" target="_blank">https://ngrx.io/guide/router-store/selectors</a>。这提供了路由器存储中所有可用的选择器来获取您需要的导航数据。</p><p id="e2b6" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">然后，您可以在组件中订阅您需要的选择器并显示它。例如，如果您只想从router-store中获取标题，那么您可以从<code class="fe lv lw lx ly b">store</code>中订阅<code class="fe lv lw lx ly b">selectTitle</code>选择器，并在收到数据时将它分配给一个局部变量(在我们的例子中也称为<code class="fe lv lw lx ly b">title</code>)。</p><pre class="me mf mg mh gt mi ly mj mk aw ml bi"><span id="1791" class="mm jz iq ly b gy mn mo l mp mq">export class ChildComponent implements OnInit {</span><span id="202a" class="mm jz iq ly b gy my mo l mp mq">  title?: string;<br/>  <br/>  constructor(private store: Store) { }</span><span id="77e5" class="mm jz iq ly b gy my mo l mp mq">  ngOnInit(): void {<br/>  	this.store.select(selectTitle).subscribe(title =&gt; this.title = title);<br/>  }</span><span id="a00f" class="mm jz iq ly b gy my mo l mp mq">}</span></pre><p id="6957" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">然后在html模板中显示出来。</p><pre class="me mf mg mh gt mi ly mj mk aw ml bi"><span id="3c69" class="mm jz iq ly b gy mn mo l mp mq">&lt;b&gt;Title: &lt;/b&gt;&lt;div *ngIf="title"&gt;&lt;/div&gt;</span></pre><p id="d8e6" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">我的<a class="ae lu" href="https://github.com/thecodinganalyst/NgRxRouterDemo" rel="noopener ugc nofollow" target="_blank"> NgRxRouterDemo </a>上有一个其他选择器的工作演示。</p></div></div>    
</body>
</html>