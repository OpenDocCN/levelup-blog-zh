<html>
<head>
<title>A Basic Introduction To Stored Procedures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">存储过程的基本介绍</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-basic-introduction-to-stored-procedures-7f5d5a99c11d?source=collection_archive---------9-----------------------#2022-11-29">https://levelup.gitconnected.com/a-basic-introduction-to-stored-procedures-7f5d5a99c11d?source=collection_archive---------9-----------------------#2022-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f6b9c3603063a3c522b978b2ed0ea805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cpWJJo96Vb2ls33O"/></div></div></figure><p id="3d4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">SQL Server存储过程用于将Transact-SQL语句分组为可重用的逻辑单元。在SQL Server数据库上工作时，存储过程存储为命名对象。</p><h2 id="b092" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">存储过程的好处</h2><p id="8b69" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">在程序中使用存储过程有很多好处。其中包括:</p><ul class=""><li id="0980" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">SQL Server中的存储过程可以接受几个输入参数，并返回多个值作为输出参数。</li><li id="39eb" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">存储过程在用户界面和数据库之间提供了一个重要而可靠的安全层。它通过控制数据访问来提供安全性，因为最终用户可以输入或更改数据，但不能编写过程。它有助于保持数据的完整性，因为输入的信息是一致的。</li><li id="b432" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">使用存储过程可以大大减少客户端和服务器之间的网络流量，因为命令是作为一批(或一组)代码执行的。这意味着唯一发送到网络的是执行过程的调用，而不是昂贵的单独发送每一行代码。</li><li id="ce3e" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">此外，它还有助于提高整体性能。因为当您第一次调用存储过程时，它会创建一个<em class="mi">执行计划</em>并将其存储在缓存中。在存储过程的后续执行中，SQL Server重用该计划以非常快速和可靠的性能执行存储过程。</li></ul></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h2 id="87e9" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">存储过程基础</h2><p id="409b" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">创建简单的存储过程</p><p id="1453" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用一个返回select语句的存储过程的示例，您可以按如下方式使用<code class="fe mq mr ms mt b">CREATE PROCEDURE</code>语句:</p><pre class="mu mv mw mx gt my mt mz bn na nb bi"><span id="b915" class="nc kx iq mt b be nd ne l nf ng">CREATE PROCEDURE sp_name<br/>AS<br/>BEGIN<br/>    SELECT <br/>        column1, column2<br/>    FROM <br/>        table1<br/>    ORDER BY <br/>        column1;<br/>END;</span></pre><p id="3c39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">理解上面的语法:</p><ul class=""><li id="b38d" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">usp_PersonData是我们的存储过程的名称。</li><li id="6a46" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">关键字<code class="fe mq mr ms mt b">AS</code>分隔了存储过程的标题和主体。</li><li id="9bbc" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">语句周围的<code class="fe mq mr ms mt b">BEGIN</code>和<code class="fe mq mr ms mt b">END</code>关键字是我们存储过程的主体，也有助于使代码清晰。</li></ul><p id="5081" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">快速注意，代替<code class="fe mq mr ms mt b">CREATE PROCEDURE</code>关键字，你可以使用<code class="fe mq mr ms mt b">CREATE PROC</code>来使语句更短。</p><p id="84c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您在SSMS (SQL Server Management Studio)中，可以在对象资源管理器中找到存储过程。就在可编程性&gt;存储过程下面。有时，您需要单击刷新按钮来更新数据库对象。</p><p id="ed15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要执行一个存储过程，可以使用<code class="fe mq mr ms mt b">EXECUTE</code>或<code class="fe mq mr ms mt b">EXEC</code>语句，后跟存储过程的名称:</p><pre class="mu mv mw mx gt my mt mz bn na nb bi"><span id="3be4" class="nc kx iq mt b be nd ne l nf ng">EXECUTE sp_name;<br/>EXEC sp_name;</span></pre><p id="4fed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要修改现有的存储过程，可以使用<code class="fe mq mr ms mt b">ALTER PROCEDURE</code>语句。</p><pre class="mu mv mw mx gt my mt mz bn na nb bi"><span id="bc48" class="nc kx iq mt b be nd ne l nf ng">ALTER PROCEDURE sp_name<br/>AS<br/>BEGIN<br/>    SELECT <br/>        column1, column2<br/>    FROM <br/>        table1<br/>    ORDER BY <br/>        column2; <br/>END;</span></pre><p id="0072" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要删除一个存储过程，可以使用<code class="fe mq mr ms mt b">DROP PROCEDURE</code>或<code class="fe mq mr ms mt b">DROP PROC</code>语句:</p><pre class="mu mv mw mx gt my mt mz bn na nb bi"><span id="1080" class="nc kx iq mt b be nd ne l nf ng">DROP PROCEDURE sp_name;<br/>DROP PROC sp_name;</span></pre></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h2 id="2da1" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated"><strong class="ak">存储过程中的参数</strong></h2><p id="03d5" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">另一件需要知道的事情是，你可以将一个参数传递给一个存储过程。允许代码更加通用和可重用的特性。</p><pre class="mu mv mw mx gt my mt mz bn na nb bi"><span id="b986" class="nc kx iq mt b be nd ne l nf ng">CREATE PROCEDURE sp_name<br/>    (@parameter1 varchar(50))<br/>AS<br/>BEGIN<br/>    SELECT <br/>        column1, column2<br/>    FROM <br/>        table1<br/>    WHERE<br/>        column1 = @parameter1; <br/>END;</span></pre><p id="b4bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本例中，我们将@ pafameter1传递给存储过程，并使用它来过滤我们的select语句。请注意，为了执行我们的存储过程，我们现在应该编写:(我们将' Example '作为参数传递)</p><pre class="mu mv mw mx gt my mt mz bn na nb bi"><span id="3939" class="nc kx iq mt b be nd ne l nf ng">EXEC sp_name 'Example'</span></pre></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><p id="5d6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要掌握存储过程并有效地使用它们，需要更多的东西。这是一个简短的介绍，希望能鼓励你进一步研究。</p><p id="c2b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望您首先理解了Sored过程为什么有用，然后理解了使用它们的基础知识。您已经学习了如何管理SQL Server存储过程，包括创建、执行、修改和删除它们。</p><p id="9a5e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢您的阅读，祝您度过愉快的一天！继续编码。</p></div></div>    
</body>
</html>