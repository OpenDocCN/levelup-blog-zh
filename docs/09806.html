<html>
<head>
<title>Things to keep in mind while deploying to Elastic Beanstalk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署到Elastic Beanstalk时需要记住的事项</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/things-to-keep-in-mind-while-deploying-to-elastic-beanstalk-b5742a7561a?source=collection_archive---------3-----------------------#2021-09-16">https://levelup.gitconnected.com/things-to-keep-in-mind-while-deploying-to-elastic-beanstalk-b5742a7561a?source=collection_archive---------3-----------------------#2021-09-16</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="7892" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Elastic Beanstalk是AWS的PaaS(平台即服务)解决方案。它可以部署Java、Python、Golang、NodeJS、Docker应用。作为AWS的旗舰产品，它拥有AWS提供的所有软件架构特性。</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj kp"><img src="../Images/e998d2ff029aebe32f68253bcb3e2a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QTAtvHNU4TQqDj2a1-sW0A.jpeg"/></div></div><figcaption class="lb lc gk gi gj ld le bd b be z dk translated">照片由来自<a class="ae lf" href="https://www.pexels.com/photo/woman-wearing-white-top-while-doing-thumbs-up-3790805/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae lf" href="https://www.pexels.com/@olly?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">安德里亚·皮亚卡迪奥</a>拍摄</figcaption></figure><p id="d00f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">当部署一个应用程序的时候，要记住所有的事情，这真的很容易让人不知所措。AWS文档很好，但是很庞大。当我们将应用程序上传到Elastic Beanstalk时，会发生很多事情。</p><p id="e031" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在这篇文章中，我将试着指出一些要点，这些要点在解决任何问题或检查Elastic Beanstalk中的问题时非常有用。</p><h1 id="0b5c" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">1.应用程序文件夹</h1><p id="7c2d" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">ec2框中的应用程序文件夹(代码将在其中提供)是:</p><pre class="kq kr ks kt gu mj mk ml mm aw mn bi"><span id="563b" class="mo lh iu mk b gz mp mq l mr ms">/var/app</span></pre><p id="6629" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">将有2个文件夹。</p><h2 id="8b10" class="mo lh iu bd li mt mu dn lm mv mw dp lq kc mx my lu kg mz na ly kk nb nc mc nd bi translated">当前(/var/app/current)</h2><p id="fe51" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">当前部署在EB环境中的代码。</p><h2 id="4b99" class="mo lh iu bd li mt mu dn lm mv mw dp lq kc mx my lu kg mz na ly kk nb nc mc nd bi translated">暂存(/var/app/staging)</h2><p id="67d0" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">当部署任何新代码版本时，将创建此目录来承载新代码，如果代码部署成功完成，此文件夹将被重命名为当前文件夹，旧的当前文件夹将被移除。</p><p id="fe62" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">如果由于某种原因，代码部署无法成功完成，这个文件夹将可供我们调试。</p><h1 id="5351" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">2.应用程序生命周期</h1><p id="651b" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">为了提供在应用程序部署期间运行的平台挂钩，将文件/脚本放在您的源代码包中的<code class="fe ne nf ng mk b">.platform/hooks</code>目录下，在以下子目录之一中。</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div class="gi gj nh"><img src="../Images/7e7f0dd148e314a7fb68c08dd3682543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*n0v6xMBsCQvqNQVR42CD8w.png"/></div><figcaption class="lb lc gk gi gj ld le bd b be z dk translated"><a class="ae lf" href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/platforms-linux-extend.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/elastic beanstalk/latest/DG/platforms-Linux-extend . html</a></figcaption></figure><ul class=""><li id="8403" class="ni nj iu jt b ju jv jy jz kc nk kg nl kk nm ko nn no np nq bi translated"><code class="fe ne nf ng mk b"><strong class="jt iv">prebuild</strong></code><strong class="jt iv"/>–下载和解压缩之后，应用服务器设置之前。</li><li id="8a71" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated"><code class="fe ne nf ng mk b"><strong class="jt iv">predeploy</strong></code><strong class="jt iv"/>–在应用服务器设置之后，在最终运行时位置部署之前。</li><li id="bb27" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated"><code class="fe ne nf ng mk b"><strong class="jt iv">postdeploy</strong></code><strong class="jt iv"/>–应用程序和代理服务器部署后。</li></ul><blockquote class="nw"><p id="18ba" class="nx ny iu bd nz oa ob oc od oe of ko dk translated">钩子文件可以是二进制文件，也可以是以包含解释器路径的<code class="fe ne nf ng mk b">#!</code>行开始的脚本文件，比如<code class="fe ne nf ng mk b">#!/bin/bash</code>。所有文件都必须有执行权限。使用<code class="fe ne nf ng mk b">chmod +x</code>来设置你的钩子文件的执行权限。</p></blockquote><h1 id="0993" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr og lt lu lv oh lx ly lz oi mb mc md bi translated">3.日志</h1><p id="8f5d" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">确保在配置中启用日志流。默认情况下，它不启用。在此启用它:</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj oj"><img src="../Images/607c2005129f504c2a2f6d11f7a6a167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqARLMe2VN_O0Pcg6NChGw.png"/></div></div></figure><p id="ec5c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">每个beanstalk环境将创建几个日志组。这是他们在云中的观察</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj oj"><img src="../Images/7156312db179526b91526c5ce1e6a95b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cNcGaubNKBouoQGXnyT5lA.png"/></div></div></figure><p id="a9b4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv"> eb-engine.log </strong>:提供平台日志。从下载开始到部署。这是调试最重要的日志文件。</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj ok"><img src="../Images/68df5f0baa5b260b4a34de968bac86c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0QJOheTVIJNJj8fqJUaR6w.gif"/></div></div></figure><blockquote class="ol om on"><p id="398e" class="jr js oo jt b ju jv jw jx jy jz ka kb op kd ke kf oq kh ki kj or kl km kn ko in bi translated"><strong class="jt iv"> <em class="iu">从Elastic beanstalk环境中访问日志时，会显示上述所有日志组的日志。</em> </strong></p></blockquote><h1 id="5b8b" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">4.对服务器的SSH访问</h1><p id="0f87" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">总是有理由登录到服务器并查看其中的日志或检查应用程序文件夹。<strong class="jt iv"> <em class="oo"> ssh </em> </strong>访问b默认不启用。</p><p id="dd9e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">要启用对服务器的<strong class="jt iv"> <em class="oo"> ssh </em> </strong>访问，请在此处选择<strong class="jt iv"> <em class="oo"> ssh </em> </strong>键。</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj ok"><img src="../Images/d061bee5433d7df35afd384b6641c44b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3YnSf7jo_FshI6i1MWskww.gif"/></div></div><figcaption class="lb lc gk gi gj ld le bd b be z dk translated">启用对EC2服务器的ssh访问</figcaption></figure><h1 id="1782" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">5.应用程序版本生命周期</h1><p id="1146" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">当我们部署一个新代码时，Elastic Beanstalk会创建一个新版本。在新代码部署中出现任何问题时，让代码的运行版本具有适当的标记并恢复到它是一个好的做法。</p><p id="eca2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">请访问此处了解更多信息:</p><div class="os ot gq gs ou ov"><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/applications-versions.html" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fp"><div class="ox ab oy cl cj oz"><h2 class="bd iv gz z fq pa fs ft pb fv fx it bi translated">管理应用程序版本</h2><div class="pc l"><h3 class="bd b gz z fq pa fs ft pb fv fx dk translated">每当您上传源代码时，Elastic Beanstalk都会创建一个应用程序版本。这通常发生在您创建…</h3></div><div class="pd l"><p class="bd b dl z fq pa fs ft pb fv fx dk translated">docs.aws.amazon.com</p></div></div></div></a></div><h1 id="6ed5" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">6.部署</h1><h2 id="1c0b" class="mo lh iu bd li mt mu dn lm mv mw dp lq kc mx my lu kg mz na ly kk nb nc mc nd bi translated">一次完成(一次性完成部署)</h2><ul class=""><li id="36a3" class="ni nj iu jt b ju me jy mf kc pe kg pf kk pg ko nn no np nq bi translated">最快的</li><li id="34ff" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">需要停机，因为有一段时间没有可用的实例</li><li id="2d68" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">非常适合开发中的快速迭代</li><li id="04bc" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">没有额外费用</li></ul><h2 id="95b5" class="mo lh iu bd li mt mu dn lm mv mw dp lq kc mx my lu kg mz na ly kk nb nc mc nd bi translated">旋转</h2><ul class=""><li id="6a32" class="ni nj iu jt b ju me jy mf kc pe kg pf kk pg ko nn no np nq bi translated">一次更新几个实例，然后继续下一步</li><li id="0951" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">不需要停机</li><li id="bc7a" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">有时会部署两个版本的代码</li><li id="5db1" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">没有额外费用</li><li id="17a9" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">部署时间长</li></ul><h2 id="ec51" class="mo lh iu bd li mt mu dn lm mv mw dp lq kc mx my lu kg mz na ly kk nb nc mc nd bi translated">与其他批次一起滚动</h2><ul class=""><li id="3b83" class="ni nj iu jt b ju me jy mf kc pe kg pf kk pg ko nn no np nq bi translated">像上面一样，但是旋转新的实例来移动批处理</li><li id="e1ab" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">不需要停机</li><li id="4014" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">应用程序总是满负荷运行，有时会超负荷运行</li><li id="7c08" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">更长的部署</li><li id="6b29" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">额外实例的一些额外成本</li><li id="88cc" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">有利于生产</li></ul><h2 id="94a6" class="mo lh iu bd li mt mu dn lm mv mw dp lq kc mx my lu kg mz na ly kk nb nc mc nd bi translated">不变的</h2><ul class=""><li id="8d5c" class="ni nj iu jt b ju me jy mf kc pe kg pf kk pg ko nn no np nq bi translated">在新ASG构建新实例，将版本部署到这些新实例，然后在运行状况良好时交换所有内容</li><li id="d9c9" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">不需要停机</li><li id="5f73" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">应用程序永远不会耗尽容量，有时它会以两倍的容量运行</li><li id="39ef" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">新ASG一段时间的高成本</li><li id="cdbe" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">最长部署</li><li id="035a" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">一个很大的优势是我们可以在出现故障时快速回滚(只需终止新的ASG)</li></ul><h2 id="c29b" class="mo lh iu bd li mt mu dn lm mv mw dp lq kc mx my lu kg mz na ly kk nb nc mc nd bi translated">蓝色/绿色部署</h2><ul class=""><li id="2c1b" class="ni nj iu jt b ju me jy mf kc pe kg pf kk pg ko nn no np nq bi translated">零停机时间和释放设施</li><li id="21ef" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">创建一个新的登台环境，并在那里部署v2</li><li id="e95f" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">新环境可以单独进行验证</li><li id="886c" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">可以设置53号路线来执行加权策略，将少量流量重定向到舞台环境</li><li id="015a" class="ni nj iu jt b ju nr jy ns kc nt kg nu kk nv ko nn no np nq bi translated">完成环境测试后，使用Beanstalks“交换url”</li></ul></div><div class="ab cl ph pi hy pj" role="separator"><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm"/></div><div class="in io ip iq ir"><p id="16b0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">学习愉快，感谢您的访问。</p><p id="0463" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">以下是AWS上的一些相关帖子:</p><div class="os ot gq gs ou ov"><a rel="noopener  ugc nofollow" target="_blank" href="/deploy-an-application-in-elastic-beanstalk-with-nginx-with-ssl-without-acm-d7216a2956d5"><div class="ow ab fp"><div class="ox ab oy cl cj oz"><h2 class="bd iv gz z fq pa fs ft pb fv fx it bi translated">使用Nginx和SSL在Elastic Beanstalk中部署应用程序，不使用ACM</h2><div class="pc l"><h3 class="bd b gz z fq pa fs ft pb fv fx dk translated">我喜欢弹性豆茎。这是一个非常棒的PaaS解决方案，它使应用程序部署变得轻而易举，并具有自动…</h3></div><div class="pd l"><p class="bd b dl z fq pa fs ft pb fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="po l"><div class="pp l pq pr ps po pt kz ov"/></div></div></a></div><div class="os ot gq gs ou ov"><a href="https://medium.com/geekculture/debug-lambdas-locally-without-sam-docker-or-anythin-eb68761dd9c4" rel="noopener follow" target="_blank"><div class="ow ab fp"><div class="ox ab oy cl cj oz"><h2 class="bd iv gz z fq pa fs ft pb fv fx it bi translated">在本地调试lambdas，不需要SAM、Docker或任何东西</h2><div class="pc l"><h3 class="bd b gz z fq pa fs ft pb fv fx dk translated">最近我在AWS中做了很多lambda编码。在做了很多网络服务后，我真的很想念…</h3></div><div class="pd l"><p class="bd b dl z fq pa fs ft pb fv fx dk translated">medium.com</p></div></div><div class="po l"><div class="pu l pq pr ps po pt kz ov"/></div></div></a></div></div></div>    
</body>
</html>