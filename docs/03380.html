<html>
<head>
<title>What You Should Know About NPM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于NPM你应该知道什么</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-you-should-know-about-npm-2b198dab6e9d?source=collection_archive---------6-----------------------#2020-05-05">https://levelup.gitconnected.com/what-you-should-know-about-npm-2b198dab6e9d?source=collection_archive---------6-----------------------#2020-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0281" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你应该掌握的命令和核心原则。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/43b989009012f8292c105474abab1bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uMNlX4gEbbnk0w0h"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">由<a class="ae lb" href="https://unsplash.com/@pinjasaur?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Paul Esch-Laurent </a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d004" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">NPM或节点包管理器是当今web开发的基石。无论您是使用Node.js还是使用React或Angular之类的库构建前端，这项技能都是不可避免的。</p><p id="0571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我无法想象不使用NPM开发一个应用程序(但我很肯定有办法)。它允许您管理包，并提供一个有用的界面来使用它们。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="8005" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">NPM的安装</h1><p id="513b" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">如果要为项目初始化NPM，需要在计算机上安装Node.js。这包括你开始需要的一切。</p><p id="9011" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以从<a class="ae lb" href="https://nodejs.org" rel="noopener ugc nofollow" target="_blank">官方页面</a>下载节点。只要按照说明做，你就可以开始了。</p><p id="06c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，要确保NPM在您的计算机上，您可以打开终端并键入以下命令:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="82ad" class="mr lk iq mn b gy ms mt l mu mv">npm -v</span></pre><p id="0168" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它应该显示已安装软件包的当前版本，例如6.13.4。</p><h1 id="fe4d" class="lj lk iq bd ll lm mw lo lp lq mx ls lt lu my lw lx ly mz ma mb mc na me mf mg bi translated">npm初始化</h1><p id="defe" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">为了安装、更新或删除项目中的包，您必须初始化<code class="fe nb nc nd mn b">package.json</code>。Create React App等大部分首发包都已经有这个文件了。在这种情况下，可以跳过这一步。</p><p id="ed24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">否则，您可以使用以下命令初始化npm:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="8a7c" class="mr lk iq mn b gy ms mt l mu mv">npm init -y</span></pre><p id="a2ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:</strong>如果想更快的生成<code class="fe nb nc nd mn b">package.json</code>，可以在命令中添加<code class="fe nb nc nd mn b">-y</code>标志。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="1470" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">拆解包. json</h1><p id="fdf6" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">现在，为了很好地理解NPM是如何工作的，以及如何正确地处理项目的配置，你应该知道<code class="fe nb nc nd mn b">package.json</code>包括什么。</p><p id="4fce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看一个创建React应用程序包的例子:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">package.json</figcaption></figure><ul class=""><li id="4482" class="ng nh iq jp b jq jr ju jv jy ni kc nj kg nk kk nl nm nn no bi translated">您可以在<code class="fe nb nc nd mn b">dependencies</code>和<code class="fe nb nc nd mn b">devDependencies</code>中看到所有已安装的软件包。有什么区别？</li><li id="ab78" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated"><code class="fe nb nc nd mn b">dependencies</code>应该包含构建你的应用的库和框架，比如Vue、React、Angular、Express等。很明显，这些包既用于生产，也用于开发。</li><li id="2df6" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">应该包含开发过程中使用的包或者用来构建你的包的包，例如，测试库、jest、gulp-jade等。只有在开发项目时，这些包才是必需的。</li><li id="6e6d" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">您可以在<code class="fe nb nc nd mn b">scripts</code>中定义自己的命令。例如，通过运行<code class="fe nb nc nd mn b">npm start</code>你将在本地运行React app，或者通过运行<code class="fe nb nc nd mn b">npm test</code>所有编写的单元测试。</li></ul><p id="b978" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:</strong>小心运行<code class="fe nb nc nd mn b">npm eject</code>，因为这是单向运行！</p><p id="da1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nb nc nd mn b">npm eject</code>将复制所有的配置文件和可传递的依赖项(Webpack，Babel，ESLint等。)作为<code class="fe nb nc nd mn b">package.json</code>中的依赖项。如果您想自己配置捆绑和构建项目，这可能很有用。</p><h1 id="65ff" class="lj lk iq bd ll lm mw lo lp lq mx ls lt lu my lw lx ly mz ma mb mc na me mf mg bi translated">依赖项的版本控制</h1><p id="1cd8" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated"><code class="fe nb nc nd mn b">package.json</code>中的每个包都是用键值对编写的。键是包的名称，值是版本。</p><p id="5a6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">版本号在S <a class="ae lb" href="http://semver.org/" rel="noopener ugc nofollow" target="_blank"> emVer语法</a>(语义版本规范)中，它用不同的含义指定每个部分。SemVer分为三个部分，由一个点分隔:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="ff02" class="mr lk iq mn b gy ms mt l mu mv">"react-scripts": "3.3.0"</span><span id="1c49" class="mr lk iq mn b gy nu mt l mu mv">// "react-scripts": major.minor.patch</span></pre><p id="0419" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">主要版本、次要版本和修补程序代表软件包的不同版本:</p><ul class=""><li id="0425" class="ng nh iq jp b jq jr ju jv jy ni kc nj kg nk kk nl nm nn no bi translated"><em class="nv">主要</em> —如果发布了主要版本，它包括对依赖关系的重大更改，这可能会导致应用程序的意外行为。</li><li id="3f00" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated"><em class="nv">次要</em> —包括向后兼容的新特性。app的运行应该不会受到影响。</li><li id="4723" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">补丁 —包括向后兼容的错误修复。</li></ul><h2 id="228b" class="mr lk iq bd ll nw nx dn lp ny nz dp lt jy oa ob lx kc oc od mb kg oe of mf og bi translated">~和^呢？</h2><p id="cbbe" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">npm使用波浪符号(~)和插入符号(^)来分别指定要使用的修补程序和次要版本。</p><p id="76fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以如果看到<code class="fe nb nc nd mn b">~1.0.2</code>就表示安装版本<code class="fe nb nc nd mn b">1.0.2</code>或者最新补丁版本比如<code class="fe nb nc nd mn b">1.0.4</code>。如果看到<code class="fe nb nc nd mn b">^1.0.2</code>表示安装版本<code class="fe nb nc nd mn b">1.0.2</code>或最新的次要或补丁版本如<code class="fe nb nc nd mn b">1.1.0</code>。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="a025" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">npm安装</h1><p id="e5bb" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">现在，既然您已经知道了<code class="fe nb nc nd mn b">package.json</code>包含了什么，那么您可能想在您的项目中安装其他的依赖项。你可以这样做:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="01d5" class="mr lk iq mn b gy ms mt l mu mv">npm i lodash --save</span></pre><p id="aaec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nb nc nd mn b">i</code>代表安装，<code class="fe nb nc nd mn b">lodash</code>是包的名称。还应该添加标志<code class="fe nb nc nd mn b">--save</code>保存到<code class="fe nb nc nd mn b">dependencies</code>中。</p><p id="f255" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想安装一个包作为devDependency，你应该添加标志<code class="fe nb nc nd mn b">--save-dev</code>或者仅仅是<code class="fe nb nc nd mn b">-D</code>。</p><p id="1b37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要在您的机器上全局安装依赖项，添加<code class="fe nb nc nd mn b">-g</code>标志，您就可以开始了。</p><p id="b9b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:</strong>无论是安装在<code class="fe nb nc nd mn b">dependencies</code>还是<code class="fe nb nc nd mn b">devDependencies</code>中，您都应该阅读软件包的文档。</p><h1 id="f85c" class="lj lk iq bd ll lm mw lo lp lq mx ls lt lu my lw lx ly mz ma mb mc na me mf mg bi translated">npm更新</h1><p id="b12f" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">NPM依赖的常见问题是新版本经常发布，出于各种安全和漏洞原因，它们应该保持最新。那么什么才是合适的更新策略呢？</p><p id="71d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们探索哪些依赖项应该更新:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="a988" class="mr lk iq mn b gy ms mt l mu mv">npm outdated</span></pre><p id="0a0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将得到一个类似如下的表格:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oh"><img src="../Images/abfc841502fc67f98f95459d90273864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnrVyQOoe5kGCzpHEZPmQw.png"/></div></div></figure><p id="6bfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此表显示软件包应该更新到“需要的”列中给出的版本。您可以通过以下命令修复它:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="9d20" class="mr lk iq mn b gy ms mt l mu mv">npm update</span><span id="51d5" class="mr lk iq mn b gy nu mt l mu mv">// or</span><span id="dcb3" class="mr lk iq mn b gy nu mt l mu mv">npm update &lt;dependency_name&gt;</span></pre><p id="99a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，如果依赖项需要重大更新，它将无法使用此命令，因为它包含了重大更改。</p><p id="dd66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些案例应该通过在<code class="fe nb nc nd mn b">package.json</code>中重写版本并运行<code class="fe nb nc nd mn b">npm install</code>来手动更新。之后，您应该检查您的代码并测试应用程序。</p><h1 id="a008" class="lj lk iq bd ll lm mw lo lp lq mx ls lt lu my lw lx ly mz ma mb mc na me mf mg bi translated">npm审计</h1><p id="3104" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">如果你安装了你想要的包，在最后一行你会看到这个，这可能会很烦人:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oi"><img src="../Images/ebc29d04e9e6a2c3b096c0b4c9faef02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B11eiq8XmSAnyXBUmFHhqQ.png"/></div></div></figure><p id="3a4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要查看更多细节，您可以运行命令<code class="fe nb nc nd mn b">npm audit</code>:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oj"><img src="../Images/0fbb63f00478f12ecb322cf544ff2c9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oc5bve9Ccvdgu6O1nQH9LQ.png"/></div></div></figure><p id="9b67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你会得到一个有漏洞的包的详细列表。如果您查看<code class="fe nb nc nd mn b">Path</code>字段，它显示了依赖路径。所以，在这种情况下，<em class="nv"> react-scripts </em>依赖于<em class="nv"> jest </em>，jest 依赖于<em class="nv"> jest-cli </em>等等。最后，<em class="nv">类</em>依赖包含一个应该被修复的漏洞。</p><p id="30fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">许多漏洞可以通过运行上面提到的或下面提到的更新依赖项来修复:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="f69b" class="mr lk iq mn b gy ms mt l mu mv">npm audit fix</span></pre><p id="bd14" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，有些依赖关系可能不会自动修复。如果您使用的包发生了重大变化，更新后可能会破坏您当前的项目，就会发生这种情况。在这种情况下，您应该手动检查您的代码。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="9221" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">最后的话</h1><p id="84a4" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">随着每个新版本的发布，NPM正在向前端开发领域大步迈进。<a class="ae lb" href="https://frontendhappyhour.com/episodes/npm-install-beer-save-in-mouth/" rel="noopener ugc nofollow" target="_blank">据其联合创始人Laurie Voss </a>称，其用户群正在发生变化，大多数用户根本不用它来编写Node。</p><p id="31d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更确切地说，它正在成为人们用来在前端组装JavaScript的工具，并且正在成为编写现代JavaScript不可或缺的一部分。</p><p id="308e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，它的缺点是定期的依赖关系更新，这会在维护项目时带来很多麻烦。因此，并行地定义开发和维护策略是一个很好的实践。</p><p id="06e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>