<html>
<head>
<title>GraphQL Server/API in Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Golang中的GraphQL服务器/API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/graphql-server-api-in-golang-601e41408d03?source=collection_archive---------1-----------------------#2021-02-19">https://levelup.gitconnected.com/graphql-server-api-in-golang-601e41408d03?source=collection_archive---------1-----------------------#2021-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3fd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">GraphQL是一种用于API的<strong class="jp ir">开源查询语言</strong>，也是一个用现有数据完成这些查询的运行时。自2012年以来，脸书的移动应用一直由GraphQL <strong class="jp ir">提供支持。</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/8051f54f797b102f46d6c45a96114b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wP6QQGZ4pZ2yzb9b9G1asA.jpeg"/></div></div></figure><p id="c844" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用GraphQL，您可以根据客户需求定义数据的结构。因此<strong class="jp ir">服务器声明什么资源是可用的，而客户机询问它需要什么。</strong>您可以在一个请求或查询中访问多个资源。还有一点<strong class="jp ir">它只有一个端点，不像REST API。</strong>如果你想了解更多关于Golang的REST API，请点击这里:</p><div class="kx ky gp gr kz la"><a href="https://ankithans1947.medium.com/your-first-rest-api-in-golang-with-mux-b87a84746d00" rel="noopener follow" target="_blank"><div class="lb ab fo"><div class="lc ab ld cl cj le"><h2 class="bd ir gy z fp lf fr fs lg fu fw ip bi translated">Golang中的第一个REST API(使用mux)</h2><div class="lh l"><h3 class="bd b gy z fp lf fr fs lg fu fw dk translated">Go由两名谷歌软件工程师创建。这是一种相当新的语言，在某种意义上是新的(与其他语言相比)</h3></div><div class="li l"><p class="bd b dl z fp lf fr fs lg fu fw dk translated">ankithans1947.medium.com</p></div></div><div class="lj l"><div class="lk l ll lm ln lj lo kv la"/></div></div></a></div><p id="3c95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，让我们完成初始设置吧！</p><h1 id="40c0" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">创建Github存储库</h1><p id="6ad2" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">来存储我们的代码，这也有助于初始化Go模块。为<code class="fe ms mt mu mv b"><strong class="jp ir">.gitignore</strong></code>文件选择语言为<code class="fe ms mt mu mv b"><strong class="jp ir">Go</strong></code>。如果需要，您可以添加许可证或自述文件。</p><p id="3261" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在您的本地系统中克隆repo，并在您喜欢的代码编辑器中打开它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mw"><img src="../Images/60ea419a64fab939c2c71d110ddb36b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lMtOTU0rBbtfr_i3EjOMOA.png"/></div></div></figure></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="c083" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以在这里我们开始编写我们的GraphQL API。</p><h1 id="dda1" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">第一步</h1><p id="3289" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">现在<strong class="jp ir">在你的项目目录中初始化Go模块</strong>，在终端中打开文件夹。你必须打字</p><pre class="km kn ko kp gt ne mv nf ng aw nh bi"><span id="eadf" class="ni lq iq mv b gy nj nk l nl nm">go mod init github.com/&lt;YOUR_GITHUB_USERNAME&gt;/&lt;REPOSITORY_NAME&gt;</span></pre><p id="97a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的情况是这样的</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nn"><img src="../Images/2fa0a36c9d3b58d7d05ddaaab6f4903e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PeWyIQ7kyNbLKohvRlaF_g.png"/></div></div></figure><h1 id="f52e" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">第二步</h1><p id="4d89" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">我们使用<code class="fe ms mt mu mv b"><strong class="jp ir">gqlgen</strong></code> <strong class="jp ir"> </strong>来设置我们的GraphQL服务器。因此，将gqlgen安装到您的项目中，并初始化GraphQL服务器。</p><pre class="km kn ko kp gt ne mv nf ng aw nh bi"><span id="8892" class="ni lq iq mv b gy nj nk l nl nm">go get github.com/99designs/gqlgen<br/>go run github.com/99designs/gqlgen init</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi no"><img src="../Images/108bc1473ae9b2ade67e133104d2e70f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D5Fj6PVAOxAV5oNHJlaDWg.png"/></div></div></figure><p id="cb61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述步骤将为您生成一些代码，这些代码将包含以下文件和文件夹。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi np"><img src="../Images/78dee76ff2d38069f772d7872033d8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1m_Cn0el3tUod5Dkm0kfA.png"/></div></div></figure><p id="3254" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ms mt mu mv b"><strong class="jp ir">go.mod</strong></code>和<code class="fe ms mt mu mv b"><strong class="jp ir">go.sum</strong></code>将包含你所有的安装包。<code class="fe ms mt mu mv b"><strong class="jp ir">gqlgen.yml</strong></code>文件将具有自动生成的GraphQL配置。<code class="fe ms mt mu mv b"><strong class="jp ir">server.go</strong></code>是我们服务器的入口点。</p><p id="6f84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于本教程，您不必弄乱<code class="fe ms mt mu mv b">graph</code>文件夹之外的任何文件😀。</p><p id="ddfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将创建一个<strong class="jp ir">字符API </strong>，其中用户可以<strong class="jp ir">添加一个字符，搜索一个字符，并获得所有字符</strong>。</p><p id="6376" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在进入<code class="fe ms mt mu mv b"><strong class="jp ir">graph/schema.graphqls</strong></code> <strong class="jp ir"> </strong>文件。清理文件，现在我们将为API定义GraphQL模式。下面是为Characters API定义的模式。我们将进行查询和突变。</p><p id="4292" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">常规:</strong></p><ul class=""><li id="00f6" class="nq nr iq jp b jq jr ju jv jy ns kc nt kg nu kk nv nw nx ny bi translated"><code class="fe ms mt mu mv b">Query</code> —用于查询数据(<code class="fe ms mt mu mv b">SELECT</code>操作)</li><li id="9f04" class="nq nr iq jp b jq nz ju oa jy ob kc oc kg od kk nv nw nx ny bi translated"><code class="fe ms mt mu mv b">Mutation</code> —用于新建和更新/删除现有数据(<code class="fe ms mt mu mv b">INSERT</code>、<code class="fe ms mt mu mv b">UPDATE</code>、<code class="fe ms mt mu mv b">DELETE</code>)</li></ul><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="142c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在删除<code class="fe ms mt mu mv b"><strong class="jp ir">graph/schema.resolvers.go</strong></code> <strong class="jp ir">。在<code class="fe ms mt mu mv b"><strong class="jp ir">resolver.go</strong></code>文件中，在<strong class="jp ir">解析器</strong>结构上方添加以下注释:</strong></p><pre class="km kn ko kp gt ne mv nf ng aw nh bi"><span id="5aeb" class="ni lq iq mv b gy nj nk l nl nm"><strong class="mv ir">//go:generate go run github.com/99designs/gqlgen</strong><br/>type Resolver struct{}</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi og"><img src="../Images/2e5e3c459c9ef932f17f52e1bb4fe1fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QxCNY-nzZTY3QqYrK5tOkA.png"/></div></div></figure><p id="325f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将为我们在<code class="fe ms mt mu mv b">schema.graphqls</code>中编写的模式自动生成代码。下一步是删除<code class="fe ms mt mu mv b"><strong class="jp ir">schema.resolvers.go</strong></code> <strong class="jp ir">、</strong>，以便<strong class="jp ir"> gqlgen </strong>可以为我们最新的模式生成代码。</p><p id="ddb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要生成代码，请进入终端中的图形文件夹并键入:</p><pre class="km kn ko kp gt ne mv nf ng aw nh bi"><span id="6096" class="ni lq iq mv b gy nj nk l nl nm">$ cd graph<br/>$ go generate</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oh"><img src="../Images/554c036f050b24e6d3e81fd53e611e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFM8TwLzmRiSNrgSRoAS_g.png"/></div></div></figure><p id="57e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将能够看到一些文件中的更改。你的<code class="fe ms mt mu mv b"><strong class="jp ir">models_gen.go</strong></code>看起来会像这样。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oi"><img src="../Images/d32b3c2e47f3dc549fb48799742126b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3xPKzsRQACAzSnp_KjnmSA.png"/></div></div></figure><p id="8711" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe ms mt mu mv b"><strong class="jp ir">schema.resolvers.go</strong></code> <strong class="jp ir"> </strong>中，您将看到三个未实现的功能。这些只是我们在编写GraphQL模式时指定的函数。</p><ol class=""><li id="81c1" class="nq nr iq jp b jq jr ju jv jy ns kc nt kg nu kk oj nw nx ny bi translated"><strong class="jp ir">添加</strong>(添加字符)</li><li id="0d11" class="nq nr iq jp b jq nz ju oa jy ob kc oc kg od kk oj nw nx ny bi translated"><strong class="jp ir">字符</strong>(获取所有字符)</li><li id="c3ad" class="nq nr iq jp b jq nz ju oa jy ob kc oc kg od kk oj nw nx ny bi translated"><strong class="jp ir">搜索</strong>(按名称搜索角色)</li></ol><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ok"><img src="../Images/24b001c2bdac9ac5d6fbcb8f6b3348c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6fJyIXHiDAvmaR3jCQVsdA.png"/></div></div></figure><p id="48c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们需要实现这些功能，我们的API将准备好测试！</p><p id="37c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用一个<strong class="jp ir">假数据库(切片)</strong>作为我们的数据库。Slice是Go中动态调整大小的数组。</p><p id="4f9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要使用它，我们必须在我们的<strong class="jp ir">解析器结构</strong>中添加字符片:</p><pre class="km kn ko kp gt ne mv nf ng aw nh bi"><span id="2ccc" class="ni lq iq mv b gy nj nk l nl nm"><strong class="mv ir">type Resolver struct {</strong></span><span id="fcbb" class="ni lq iq mv b gy ol nk l nl nm"><strong class="mv ir">       characters []*model.Character</strong></span><span id="c6bd" class="ni lq iq mv b gy ol nk l nl nm"><strong class="mv ir">}</strong></span></pre><p id="2c6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ms mt mu mv b"><strong class="jp ir">resolver.go</strong></code>文件应该是这样的</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi om"><img src="../Images/d5289e8c8fdaac11a98ce883446ef572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KBoKo1STDji8dN9e4jCKOg.png"/></div></div></figure><p id="4153" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们必须编写API 的<strong class="jp ir">业务逻辑，我们就完成了。下面是对<code class="fe ms mt mu mv b"><strong class="jp ir">schema.resolvers.go</strong></code> <strong class="jp ir"> </strong>文件功能的修改。</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="61a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的，我们已经正式写完代码了。现在让我们测试我们的GraphQL API吧！要运行服务器，你必须进入项目所在的根目录并键入<code class="fe ms mt mu mv b"><strong class="jp ir">go run server.go</strong></code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi on"><img src="../Images/4388a60b161230ed5737b9169583e9a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fliGw1oeeoJvi0AGOiRi-g.png"/></div></div></figure><p id="1114" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在你的浏览器中打开<code class="fe ms mt mu mv b"><strong class="jp ir">http://localhost:8080/</strong></code>，你会看到一个漂亮的用户界面与GraphQL API交互。<strong class="jp ir">下面是如何在GraphQL中写出查询和变异来测试它！</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oo"><img src="../Images/b2e060769aa622d272c4f5d54d240f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xBe8-WhikmLLPk9QHqGtug.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oo"><img src="../Images/55b06be4e11762a394ce8a44056ef2d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVvgAOJE6cWtAmKfpeL4OA.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oo"><img src="../Images/b34f7c2c35bede740fd05438ad02ce9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNLwpFFolQFAaywHIEjWEw.png"/></div></div></figure><p id="df24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至此，您终于成功创建了第一个GraphQL API。希望你能从中吸取教训。有疑问吗？请在评论中给我留言。<strong class="jp ir">如果你已经做到这一步，那么请为这篇文章鼓掌吧！</strong></p><p id="5106" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想和我联系，这是我的联系方式</p><div class="kx ky gp gr kz la"><a href="https://github.com/ankithans" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab fo"><div class="lc ab ld cl cj le"><h2 class="bd ir gy z fp lf fr fs lg fu fw ip bi translated">ankithans -概述</h2><div class="lh l"><h3 class="bd b gy z fp lf fr fs lg fu fw dk translated">const { Node，Golang，Python，React，Flutter，DSA } = @ ankithans这个项目是在2021年Treehacks期间建造的…</h3></div><div class="li l"><p class="bd b dl z fp lf fr fs lg fu fw dk translated">github.com</p></div></div><div class="lj l"><div class="op l ll lm ln lj lo kv la"/></div></div></a></div><div class="kx ky gp gr kz la"><a href="https://linkedin.com/in/ankithans" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab fo"><div class="lc ab ld cl cj le"><h2 class="bd ir gy z fp lf fr fs lg fu fw ip bi translated">Ankit Hans -开源开发者- LibreHealth | LinkedIn</h2><div class="lh l"><h3 class="bd b gy z fp lf fr fs lg fu fw dk translated">经验丰富的全栈工程师，具有开发领域的工作经历。熟练的MERN…</h3></div><div class="li l"><p class="bd b dl z fp lf fr fs lg fu fw dk translated">linkedin.com</p></div></div><div class="lj l"><div class="oq l ll lm ln lj lo kv la"/></div></div></a></div></div></div>    
</body>
</html>