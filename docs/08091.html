<html>
<head>
<title>Making Custom Select Field with Alpine.js and Tailwindcss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Alpine.js和Tailwindcss制作自定义选择字段</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/making-custom-form-fields-with-alpinejs-and-tailwind-select-field-d633cd2b82bc?source=collection_archive---------3-----------------------#2021-04-02">https://levelup.gitconnected.com/making-custom-form-fields-with-alpinejs-and-tailwind-select-field-d633cd2b82bc?source=collection_archive---------3-----------------------#2021-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/07672dae57beaba52311b3fa3384f3e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*rVaOad4Qc2LKMziHagNAwg.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">照片由<a class="ae jy" href="https://unsplash.com/@halacious?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">HalGatewood.com</a>在<a class="ae jy" href="https://unsplash.com/s/photos/website?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="186b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我很喜欢写我的上一个故事，在那里我分享了关于在<a class="ae jy" href="https://medium.com/swlh/simple-color-theme-implementation-with-css-and-alpine-js-ab8bb09f843f" rel="noopener">颜色方案切换</a>中使用Alpine.js。现在，我将分享另一个Alpine.js + Tailwind系列，但这一次——创建一个自定义选择字段。</p><p id="e990" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">一旦你完成了这篇文章，你会看到类似这样的东西。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kx"><img src="../Images/c9663553f3f2e8dd34dfee82f50bcf45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OXt8kgOpvwHsadtdhq6ohw.gif"/></div></div></figure></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="4c7e" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kk lw lx ly ko lz ma mb ks mc md me mf bi translated">HTML</h2><p id="db94" class="pw-post-body-paragraph jz ka iq kb b kc mg ke kf kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ij bi translated">让我们从形成视图部分开始。不要忘记首先在你的主html文件中包含tailwind css。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="15d6" class="ln lo iq mm b gy mq mr l ms mt">&lt;link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet"&gt;</span></pre><p id="6804" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">此外，我们需要一些额外的CSS来定位输入字段。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="5878" class="ln lo iq mm b gy mq mr l ms mt">&lt;style&gt;<br/>.top-100 {top: 100%}<br/>.bottom-100 {bottom: 100%}<br/>.max-h-select {<br/>    max-height: 300px;<br/>}<br/>&lt;/style&gt;</span></pre><p id="8cff" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我最初从https://tailwindcomponents.com的<a class="ae jy" href="https://tailwindcomponents.com/" rel="noopener ugc nofollow" target="_blank">复制了一部分，只是为了帮助我开始。</a></p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="e4c9" class="ln lo iq mm b gy mq mr l ms mt">&lt;div class="flex flex-col items-center"&gt;<br/>    &lt;div class="w-full md:w-1/2 flex flex-col items-center h-64"&gt;<br/>        &lt;div class="w-full px-4"&gt;<br/>            &lt;div class="flex flex-col items-center relative"&gt;<br/>                &lt;div class="w-full"&gt;<br/>                    &lt;div class="my-2 p-1 bg-white flex border border-gray-200 rounded"&gt;<br/>                        &lt;input class="p-1 px-2 appearance-none outline-none w-full text-gray-800"&gt;<br/>                        &lt;div class="text-gray-300 w-8 py-1 pl-2 pr-1 border-l flex items-center border-gray-200"&gt;<br/>                            &lt;button class="cursor-pointer w-6 h-6 text-gray-600 outline-none focus:outline-none"&gt;<br/>                                &lt;svg  ae jy" href="http://www.w3.org/2000/svg" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/2000/svg" width="100%" height="100%" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;<br/>                                    &lt;polyline points="18 15 12 20 6 15"&gt;&lt;/polyline&gt;<br/>                                &lt;/svg&gt;<br/>                              <br/>                            &lt;/button&gt;<br/>                        &lt;/div&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>                &lt;div class="absolute shadow bg-white top-100 z-40 w-full lef-0 rounded max-h-select overflow-y-auto svelte-5uyqqj"&gt;<br/>                    &lt;div class="flex flex-col w-full"&gt;<br/>                      &lt;div class="flex w-full items-center p-2 pl-2 border-transparent border-l-2 relative hover:border-teal-100"&gt;<br/>                        &lt;div class="w-6 flex flex-col items-center"&gt;<br/>                          &lt;div class="flex relative w-5 h-5 bg-orange-500 justify-center items-center m-1 mr-2 w-4 h-4 mt-1 rounded-full "&gt;&lt;img class="rounded-full"&gt; &lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                        &lt;div class="w-full items-center flex"&gt;<br/>                          &lt;div class="mx-2 -mt-1"&gt;<br/>                            &lt;div class="text-xs truncate w-full normal-case font-normal -mt-1 text-gray-500"&gt;&lt;/div&gt;<br/>                          &lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                      &lt;/div&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;<br/></span></pre><p id="b08d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">上面的代码将为您提供这种视图。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mu"><img src="../Images/827e3d78867ed04796127e8645c2e107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ihe855H60k2Iy3GLnynxhQ.gif"/></div></div></figure><h2 id="5e71" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kk lw lx ly ko lz ma mb ks mc md me mf bi translated">Alpine.js洒</h2><p id="701c" class="pw-post-body-paragraph jz ka iq kb b kc mg ke kf kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ij bi translated">目前，我们只有一个非常裸露的视图。让我们用AlpineJs的魔法点亮它。但是首先，确保包含AlpineJs文件。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="54be" class="ln lo iq mm b gy mq mr l ms mt">&lt;script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer&gt;&lt;/script&gt;</span></pre><p id="5a3b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">初始化</strong></p><p id="9b74" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">现在，在一个单独的js文件中，让我们添加这段代码。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="e412" class="ln lo iq mm b gy mq mr l ms mt">function selectConfigs() {<br/>  return {<br/>    filter: '',<br/>    show: false,<br/>    options: null,<br/>    open() { <br/>      this.show = true; <br/>      this.filter = '';<br/>    },<br/>    close() { <br/>      this.show = false;<br/>    },<br/>    toggle() { <br/>      if (this.show) {<br/>        this.close();<br/>      }<br/>      else {<br/>        this.open()<br/>      }<br/>    },<br/>    isOpen() { return this.show === true },<br/>  }<br/>}</span></pre><p id="0ad2" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><code class="fe mv mw mx mm b">selectConfigs()</code>函数非常简单明了。我们只是返回一个初始属性——<code class="fe mv mw mx mm b">filter</code>、<code class="fe mv mw mx mm b">show</code>、<code class="fe mv mw mx mm b">options</code>和一些函数——<code class="fe mv mw mx mm b">open()</code>、<code class="fe mv mw mx mm b">close()</code>、<code class="fe mv mw mx mm b">toggle()</code>、<code class="fe mv mw mx mm b">isOpen()</code>。在下面的代码片段中，看看我们如何在AlpineJs指令中使用它们。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="a78b" class="ln lo iq mm b gy mq mr l ms mt">&lt;div class="flex flex-col items-center"&gt;<br/>    &lt;div class="w-full md:w-1/2 flex flex-col items-center h-64"&gt;<br/>        &lt;div class="w-full px-4"&gt;<br/>            &lt;div x-data="selectConfigs()" class="flex flex-col items-center relative"&gt;<br/>                &lt;div class="w-full"&gt;<br/>                    &lt;div <a class="ae jy" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>.away="close()" class="my-2 p-1 bg-white flex border border-gray-200 rounded"&gt;<br/>                        &lt;input <br/>                               x-model="filter"<br/>                               x-transition:leave="transition ease-in duration-100"<br/>                               x-transition:leave-start="opacity-100"<br/>                               x-transition:leave-end="opacity-0"<br/>                               x-cloak<br/>                               <a class="ae jy" href="http://twitter.com/mousedown" rel="noopener ugc nofollow" target="_blank">@mousedown</a>="open()"<br/>                               class="p-1 px-1 appearance-none outline-none w-full text-gray-800"&gt;<br/>                        &lt;div class="text-gray-300 w-8 py-1 pl-2 pr-1 border-l flex items-center border-gray-200"&gt;<br/>                            &lt;button <a class="ae jy" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="toggle()" class="cursor-pointer w-6 h-6 text-gray-600 outline-none focus:outline-none"&gt;<br/>                                &lt;svg  ae jy" href="http://www.w3.org/2000/svg" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/2000/svg" width="100%" height="100%" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;<br/>                                    &lt;polyline x-show="!isOpen()" points="18 15 12 20 6 15"&gt;&lt;/polyline&gt;<br/>                                    &lt;polyline x-show="isOpen()" points="18 15 12 9 6 15"&gt;&lt;/polyline&gt;<br/>                                &lt;/svg&gt;<br/>                              <br/>                            &lt;/button&gt;<br/>                        &lt;/div&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>                &lt;div x-show="isOpen()" class="absolute shadow bg-white top-100 z-40 w-full lef-0 rounded max-h-select overflow-y-auto svelte-5uyqqj"&gt;<br/>                    &lt;div class="flex flex-col w-full"&gt;<br/>                      &lt;div class="flex w-full items-center p-2 pl-2 border-transparent border-l-2 relative hover:border-teal-100"&gt;<br/>                        &lt;div class="w-6 flex flex-col items-center"&gt;<br/>                          &lt;div class="flex relative w-5 h-5 bg-orange-500 justify-center items-center m-1 mr-2 w-4 h-4 mt-1 rounded-full "&gt;&lt;img class="rounded-full"&gt; &lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                        &lt;div class="w-full items-center flex"&gt;<br/>                          &lt;div class="mx-2 -mt-1"&gt;<br/>                            &lt;div class="text-xs truncate w-full normal-case font-normal -mt-1 text-gray-500"&gt;&lt;/div&gt;<br/>                          &lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                      &lt;/div&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="79ac" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">注意，我们在<code class="fe mv mw mx mm b">x-data</code>指令中调用<code class="fe mv mw mx mm b">selectConfigs()</code>。这将为元素提供所有可用的属性和函数。您还可以看到我们使用了<code class="fe mv mw mx mm b">filter</code>属性。这将成为用户搜索字符串的占位符。此外，我们还利用了我们在<code class="fe mv mw mx mm b">selectConfigs()</code>中定义的函数。它们是使用不同的鼠标和键盘事件执行下拉打开和关闭效果的主要功能— <code class="fe mv mw mx mm b">click</code>、<code class="fe mv mw mx mm b">mousedown</code>、<code class="fe mv mw mx mm b">click.away</code>。此时，它应该是这样的。—</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi my"><img src="../Images/18990ef00fd68a456ad2ae5a5c48447e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Oh41E6AgJBnBWMP16TVvMQ.gif"/></div></div></figure><p id="2922" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">制作下拉列表</strong></p><p id="4122" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">让我们通过更新<code class="fe mv mw mx mm b">selectConfigs()</code>——在下拉列表中抓取并显示样本数据</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="9c42" class="ln lo iq mm b gy mq mr l ms mt">function selectConfigs() {<br/>  return {<br/>    filter: '',<br/>    show: false,<br/>    options: null,<br/>    selected: null,<br/>    focusedOptionIndex: null,<br/>    open() { <br/>      this.show = true; <br/>      this.filter = '';<br/>    },  <br/>    close() { <br/>      this.show = false;<br/>    },<br/>    toggle() { <br/>      if (this.show) {<br/>        this.close();<br/>      }<br/>      else {<br/>        this.open()<br/>      }<br/>    },<br/>    isOpen() { return this.show === true },<br/>    fetchOptions() {<br/>      fetch('<a class="ae jy" href="https://randomuser.me/api/?results=5'" rel="noopener ugc nofollow" target="_blank">https://randomuser.me/api/?results=5'</a>)<br/>        .then(response =&gt; response.json())<br/>        .then(data =&gt; this.options = data);<br/>    },<br/>    filteredOptions() {<br/>      return this.options<br/>        ? this.options.results.filter(option =&gt; {<br/>        return (option.name.first.toLowerCase().indexOf(this.filter) &gt; -1) <br/>        || (option.name.last.toLowerCase().indexOf(this.filter) &gt; -1)<br/>        || (option.email.toLowerCase().indexOf(this.filter) &gt; -1)<br/>      })<br/>      : {}<br/>    },<br/>    classOption(id, index) {<br/>      const isSelected = this.selected ? (id == this.selected.login.uuid) : false;<br/>      const isFocused = (index == this.focusedOptionIndex);<br/>      return {<br/>        'cursor-pointer w-full border-gray-100 border-b hover:bg-blue-50': true,<br/>        'bg-blue-100': isSelected,<br/>        'bg-blue-50': isFocused<br/>      };<br/>    },<br/>  }<br/>}</span></pre><p id="f9b2" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">所以我们只是添加了两个新的属性:<code class="fe mv mw mx mm b">selected</code>和<code class="fe mv mw mx mm b">focusedOptionIndex</code>——用来存储当前选中的选项及其对应的索引，该索引位于鼠标指针聚焦的位置或上/下键当前选择的位置。您还会看到我们添加了一个函数<code class="fe mv mw mx mm b">fetchOption()</code>来从<a class="ae jy" href="http://randomuser.me" rel="noopener ugc nofollow" target="_blank"><em class="mz">random user . me</em></a>API中检索一个样本数据。我们可以使用其他资源，但这要简单得多。然后，我们有另一个功能<code class="fe mv mw mx mm b">filteredOptions()</code>，这将用于显示用户列表。该功能还将根据输入字段中输入的内容过滤列表。<code class="fe mv mw mx mm b">classOption()</code>函数是一种基于选择或聚焦的内容来设置列表项上的元素类的方法。</p><p id="86d1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在HTML端，增加了<code class="fe mv mw mx mm b">x-translation</code>指令。它们允许我们在特定的动画阶段应用CSS类。此外，为了实际显示用户列表，我们将循环指令放在一个模板中。这使用来自<code class="fe mv mw mx mm b">filteredOptions()</code>的计算数据并迭代它们。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="7f83" class="ln lo iq mm b gy mq mr l ms mt">&lt;div class="flex flex-col items-center"&gt;<br/>    &lt;div class="w-full md:w-1/2 flex flex-col items-center h-64"&gt;<br/>        &lt;div class="w-full px-4"&gt;<br/>            &lt;div x-data="selectConfigs()" x-init="fetchOptions()" class="flex flex-col items-center relative"&gt;<br/>                &lt;div class="w-full"&gt;<br/>                    &lt;div <a class="ae jy" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>.away="close()" class="my-2 p-1 bg-white flex border border-gray-200 rounded"&gt;<br/>                        &lt;input <br/>                               x-model="filter"<br/>                               x-transition:leave="transition ease-in duration-100"<br/>                               x-transition:leave-start="opacity-100"<br/>                               x-transition:leave-end="opacity-0"<br/>                               <a class="ae jy" href="http://twitter.com/mousedown" rel="noopener ugc nofollow" target="_blank">@mousedown</a>="open()"<br/>                               class="p-1 px-2 appearance-none outline-none w-full text-gray-800"&gt;<br/>                        &lt;div class="text-gray-300 w-8 py-1 pl-2 pr-1 border-l flex items-center border-gray-200"&gt;<br/>                            &lt;button <a class="ae jy" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="toggle()" class="cursor-pointer w-6 h-6 text-gray-600 outline-none focus:outline-none"&gt;<br/>                                &lt;svg  ae jy" href="http://www.w3.org/2000/svg" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/2000/svg" width="100%" height="100%" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;<br/>                                    &lt;polyline x-show="!isOpen()" points="18 15 12 20 6 15"&gt;&lt;/polyline&gt;<br/>                                    &lt;polyline x-show="isOpen()" points="18 15 12 9 6 15"&gt;&lt;/polyline&gt;<br/>                                &lt;/svg&gt;<br/>                              <br/>                            &lt;/button&gt;<br/>                        &lt;/div&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>                &lt;div x-show="isOpen()" class="absolute shadow bg-white top-100 z-40 w-full lef-0 rounded max-h-select overflow-y-auto svelte-5uyqqj"&gt;<br/>                    &lt;div class="flex flex-col w-full"&gt;<br/>                      &lt;template x-for="(option, index) in filteredOptions()" :key="index"&gt;<br/>                        &lt;div :class="classOption(option.login.uuid, index)" :aria-selected="focusedOptionIndex === index"&gt;<br/>                            &lt;div class="flex w-full items-center p-2 pl-2 border-transparent border-l-2 relative hover:border-teal-100"&gt;<br/>                                &lt;div class="w-6 flex flex-col items-center"&gt;<br/>                                    &lt;div class="flex relative w-5 h-5 bg-orange-500 justify-center items-center m-1 mr-2 w-4 h-4 mt-1 rounded-full "&gt;&lt;img class="rounded-full" alt="A" x-bind:src="option.picture.thumbnail"&gt; &lt;/div&gt;<br/>                                &lt;/div&gt;<br/>                                &lt;div class="w-full items-center flex"&gt;<br/>                                    &lt;div class="mx-2 -mt-1"&gt;&lt;span x-text="option.name.first + ' ' + option.name.last"&gt;&lt;/span&gt;<br/>                                        &lt;div class="text-xs truncate w-full normal-case font-normal -mt-1 text-gray-500" x-text="option.email"&gt;&lt;/div&gt;<br/>                                    &lt;/div&gt;<br/>                                &lt;/div&gt;<br/>                            &lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                      &lt;/template&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;</span><span id="e452" class="ln lo iq mm b gy na mr l ms mt">&lt;/div&gt;</span></pre><p id="5381" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这应该是更新后的结果。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nb"><img src="../Images/a895a14657334f46ba588120961cf027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*GCAC_X1vL6SruxvufPCTIQ.gif"/></div></div></figure><p id="1351" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">至此，我们几乎完成了自定义选择字段，缺少的部分非常明显——那就是选择选项或项目的功能。现在让我们更新我们的脚本来应用这个功能。这里我们有<code class="fe mv mw mx mm b">onOptionClick()</code>、<code class="fe mv mw mx mm b">selectOption()</code>、<code class="fe mv mw mx mm b">focusPrevOption()</code>和<code class="fe mv mw mx mm b">focusNextOption()</code>。点击列表中的选项时会调用<code class="fe mv mw mx mm b">onOptionClick()</code>。当您试图用键盘上的向上/向下键移动选择时，使用<code class="fe mv mw mx mm b">focusPrevOption()</code>和<code class="fe mv mw mx mm b">focusNextOption()</code>。而<code class="fe mv mw mx mm b">selectOption()</code>是我们设置所选项目的地方，它在前面提到的函数中被调用。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="239c" class="ln lo iq mm b gy mq mr l ms mt">function selectConfigs() {<br/>   return {<br/>            filter: '',<br/>            show: false,<br/>            selected: null,<br/>            focusedOptionIndex: null,<br/>            options: null, <br/>            open() { <br/>              this.show = true; <br/>              this.filter = '';<br/>            },            <br/>            close() { <br/>              this.show = false;<br/>              this.filter = this.selectedName();<br/>              this.focusedOptionIndex = this.selected ? this.focusedOptionIndex : null;<br/>            },<br/>            toggle() { <br/>              if (this.show) {<br/>                this.close();<br/>              }<br/>              else {<br/>                this.open()<br/>              }<br/>            },<br/>            isOpen() { return this.show === true },<br/>            selectedName() { return this.selected ? this.selected.name.first + ' ' + this.selected.name.last : this.filter; },<br/>            classOption(id, index) {<br/>              const isSelected = this.selected ? (id == this.selected.login.uuid) : false;<br/>              const isFocused = (index == this.focusedOptionIndex);<br/>              return {<br/>                'cursor-pointer w-full border-gray-100 border-b hover:bg-blue-50': true,<br/>                'bg-blue-100': isSelected,<br/>                'bg-blue-50': isFocused<br/>              };<br/>            },<br/>            fetchOptions() {<br/>              fetch('<a class="ae jy" href="https://randomuser.me/api/?results=5'" rel="noopener ugc nofollow" target="_blank">https://randomuser.me/api/?results=5'</a>)<br/>                .then(response =&gt; response.json())<br/>                .then(data =&gt; this.options = data);<br/>            },<br/>            filteredOptions() {<br/>              return this.options<br/>                ? this.options.results.filter(option =&gt; {<br/>                    return (option.name.first.toLowerCase().indexOf(this.filter) &gt; -1) <br/>                      || (option.name.last.toLowerCase().indexOf(this.filter) &gt; -1)<br/>                      || (option.email.toLowerCase().indexOf(this.filter) &gt; -1)<br/>                })<br/>               : {}<br/>            },<br/>            onOptionClick(index) {<br/>              this.focusedOptionIndex = index;<br/>              this.selectOption();<br/>            },<br/>            selectOption() {<br/>              if (!this.isOpen()) {<br/>                return;<br/>              }<br/>              this.focusedOptionIndex = this.focusedOptionIndex ?? 0;<br/>              const selected = this.filteredOptions()[this.focusedOptionIndex]<br/>              if (this.selected &amp;&amp; this.selected.login.uuid == selected.login.uuid) {<br/>                this.filter = '';<br/>                this.selected = null;<br/>              }<br/>              else {<br/>                this.selected = selected;<br/>                this.filter = this.selectedName();<br/>              }<br/>              this.close();<br/>            },<br/>            focusPrevOption() {<br/>              if (!this.isOpen()) {<br/>                return;<br/>              }<br/>              const optionsNum = Object.keys(this.filteredOptions()).length - 1;<br/>              if (this.focusedOptionIndex &gt; 0 &amp;&amp; this.focusedOptionIndex &lt;= optionsNum) {<br/>                this.focusedOptionIndex--;<br/>              }<br/>              else if (this.focusedOptionIndex == 0) {<br/>                this.focusedOptionIndex = optionsNum;<br/>              }<br/>            },<br/>            focusNextOption() {<br/>              const optionsNum = Object.keys(this.filteredOptions()).length - 1;<br/>              if (!this.isOpen()) {<br/>                this.open();<br/>              }<br/>              if (this.focusedOptionIndex == null || this.focusedOptionIndex == optionsNum) {<br/>                this.focusedOptionIndex = 0;<br/>              }<br/>              else if (this.focusedOptionIndex &gt;= 0 &amp;&amp; this.focusedOptionIndex &lt; optionsNum) {<br/>                this.focusedOptionIndex++;<br/>              }<br/>            }<br/>        }<br/>    }</span></pre><p id="9cfd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">正如你所看到的，我们已经用键盘事件和鼠标点击事件调用了这些函数。</p><pre class="ky kz la lb gt ml mm mn mo aw mp bi"><span id="c3ba" class="ln lo iq mm b gy mq mr l ms mt">&lt;div class="flex flex-col items-center"&gt;<br/>    &lt;div class="w-full md:w-1/2 flex flex-col items-center h-64"&gt;<br/>        &lt;div class="w-full px-4"&gt;<br/>            &lt;div x-data="selectConfigs()" x-init="fetchOptions()" class="flex flex-col items-center relative"&gt;<br/>                &lt;div class="w-full"&gt;<br/>                    &lt;div <a class="ae jy" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>.away="close()" class="my-2 p-1 bg-white flex border border-gray-200 rounded"&gt;<br/>                        &lt;input <br/>                               x-model="filter"<br/>                               x-transition:leave="transition ease-in duration-100"<br/>                               x-transition:leave-start="opacity-100"<br/>                               x-transition:leave-end="opacity-0"<br/>                               <a class="ae jy" href="http://twitter.com/mousedown" rel="noopener ugc nofollow" target="_blank">@mousedown</a>="open()"<br/>                               <a class="ae jy" href="http://twitter.com/keydown" rel="noopener ugc nofollow" target="_blank">@keydown</a>.enter.stop.prevent="selectOption()"<br/>                               <a class="ae jy" href="http://twitter.com/keydown" rel="noopener ugc nofollow" target="_blank">@keydown</a>.arrow-up.prevent="focusPrevOption()"<br/>                               <a class="ae jy" href="http://twitter.com/keydown" rel="noopener ugc nofollow" target="_blank">@keydown</a>.arrow-down.prevent="focusNextOption()"<br/>                               class="p-1 px-2 appearance-none outline-none w-full text-gray-800"&gt;<br/>                        &lt;div class="text-gray-300 w-8 py-1 pl-2 pr-1 border-l flex items-center border-gray-200"&gt;<br/>                            &lt;button <a class="ae jy" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="toggle()" class="cursor-pointer w-6 h-6 text-gray-600 outline-none focus:outline-none"&gt;<br/>                                &lt;svg  ae jy" href="http://www.w3.org/2000/svg" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/2000/svg" width="100%" height="100%" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;<br/>                                    &lt;polyline x-show="!isOpen()" points="18 15 12 20 6 15"&gt;&lt;/polyline&gt;<br/>                                    &lt;polyline x-show="isOpen()" points="18 15 12 9 6 15"&gt;&lt;/polyline&gt;<br/>                                &lt;/svg&gt;<br/>                              <br/>                            &lt;/button&gt;<br/>                        &lt;/div&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>                &lt;div x-show="isOpen()" class="absolute shadow bg-white top-100 z-40 w-full lef-0 rounded max-h-select overflow-y-auto svelte-5uyqqj"&gt;<br/>                    &lt;div class="flex flex-col w-full"&gt;<br/>                      &lt;template x-for="(option, index) in filteredOptions()" :key="index"&gt;<br/>                        &lt;div <a class="ae jy" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="onOptionClick(index)" :class="classOption(option.login.uuid, index)" :aria-selected="focusedOptionIndex === index"&gt;<br/>                            &lt;div class="flex w-full items-center p-2 pl-2 border-transparent border-l-2 relative hover:border-teal-100"&gt;<br/>                                &lt;div class="w-6 flex flex-col items-center"&gt;<br/>                                    &lt;div class="flex relative w-5 h-5 bg-orange-500 justify-center items-center m-1 mr-2 w-4 h-4 mt-1 rounded-full "&gt;&lt;img class="rounded-full" alt="A" x-bind:src="option.picture.thumbnail"&gt; &lt;/div&gt;<br/>                                &lt;/div&gt;<br/>                                &lt;div class="w-full items-center flex"&gt;<br/>                                    &lt;div class="mx-2 -mt-1"&gt;&lt;span x-text="option.name.first + ' ' + option.name.last"&gt;&lt;/span&gt;<br/>                                        &lt;div class="text-xs truncate w-full normal-case font-normal -mt-1 text-gray-500" x-text="option.email"&gt;&lt;/div&gt;<br/>                                    &lt;/div&gt;<br/>                                &lt;/div&gt;<br/>                            &lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                      &lt;/template&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="28d0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">终于，我们完成了！应该是这样的。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nc"><img src="../Images/a778a2f615156e02e69fe12d513edc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TDGwwG8D7klyELHYZhxUTA.gif"/></div></div></figure><p id="c4a1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我希望你也喜欢这个。如果你想看到自定义选择字段的所有来源，并在现场试用，你可以访问<a class="ae jy" href="https://codepen.io/dixie0704/pen/jOVxGXL" rel="noopener ugc nofollow" target="_blank">https://codepen.io/dixie0704/pen/jOVxGXL</a></p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="3b67" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="mz">如果你喜欢这篇文章并想表达爱意，那就太棒了，如果你能……</em></p><figure class="ky kz la lb gt jr gh gi paragraph-image"><a href="https://www.buymeacoffee.com/dxcgrl"><div class="gh gi nd"><img src="../Images/ea331fba7209df5cded0b88763719f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*ZmVCvBuQvluffs7mZ8BFCw.png"/></div></a></figure></div></div>    
</body>
</html>