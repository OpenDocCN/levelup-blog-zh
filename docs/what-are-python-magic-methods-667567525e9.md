# Python é­”æœ¯æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/what-are-python-magic-methods-667567525e9>

## Python é­”æœ¯æ–¹æ³•çš„ç®€è¦æ¦‚è¿°ä»¥åŠäº†è§£å®ƒä»¬çš„é‡è¦æ€§

![](img/5d6e473082fb62145beff478f4890752.png)

åœ¨ [Unsplash](https://unsplash.com) ä¸Šç”± [Aditya Saxena](https://unsplash.com/@adityaries) å‘å£°

é­”æœ¯æ–¹æ³•ï¼Œä¹Ÿç§°ä¸º *Dunder* æ–¹æ³•ï¼Œæ˜¯ Python åœ¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„ç‰¹å®šæ—¶é—´è°ƒç”¨çš„ç‰¹æ®Šå‡½æ•°ã€‚è¿™äº›æ–¹æ³•çš„åå­—ä¸¤è¾¹éƒ½æœ‰ä¸¤ä¸ªä¸‹åˆ’çº¿ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚

## æ„é€ å‡½æ•°åˆå§‹å€¼è®¾å®šé¡¹:__init__

å¦‚æœä½ åœ¨ Python ä¸­åšè¿‡é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP ),ä½ å¯èƒ½ç†Ÿæ‚‰ *__init__* æ–¹æ³•ã€‚ä¸ºäº†é‚£äº›æ–°çš„é¢å‘å¯¹è±¡æ¦‚å¿µçš„å¥½å¤„ï¼Œç±»æœ‰æ„é€ å‡½æ•°ï¼Œå®ƒä»¬åœ¨å®ä¾‹åŒ–æ—¶è°ƒç”¨ã€‚åœ¨ Python ä¸­ï¼Œæ„é€ å‡½æ•°æ˜¯ *__init__* æ–¹æ³•ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ ·æœ¬ä»£ç ã€‚

```
**class** Book:
    **def** __init__(self, title, author):
        self.title = title
        self.author = author
        print(f"{title} was written by {author}")
```

ä¸Šé¢çš„ä»£ç ç‰‡æ®µæ˜¯ä¸€ä¸ªç®€å•çš„ Book ç±»ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œtitle å’Œ authorã€‚æˆ‘ä»¬åˆå§‹åŒ–å‚æ•°ï¼Œç„¶ååœ¨æ§åˆ¶å°ä¸Šæ‰“å°ä¸€äº›ä¸œè¥¿ã€‚

å¯¹äºè¿™å ‚è¯¾ï¼Œè®©æˆ‘ä»¬å‡è®¾æ–¹æ³•å®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•° *self* æ˜¯ä¸€ä¸ªæˆ‘ä»¬ä¸å¿…æ‹…å¿ƒçš„å¼ºåˆ¶å­—æ®µã€‚Python éœ€è¦å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä¼šä¸ºå®ƒè´¹å¿ƒå¤ªå¤šã€‚é™„å¸¦è¯´æ˜ä¸€ä¸‹ï¼Œåå­—å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼Œä½†æ˜¯ç¤¾åŒºå·²ç»æŒ‰ç…§æƒ¯ä¾‹é€‰æ‹©äº†è‡ªå·±ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª book ç±»çš„å¯¹è±¡ã€‚

æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­å®ä¾‹åŒ–äº† book ç±»ï¼Œæ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬ç”¨å®ä¾‹åŒ–è¿‡ç¨‹ä¸­ä¼ é€’çš„å˜é‡å¡«å……äº† print è¯­å¥ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ __init__ æ–¹æ³•ï¼Œä½†æ˜¯ Python ä»¥æŸç§æ–¹å¼è°ƒç”¨äº†å®ƒã€‚è¿™æ˜¯å› ä¸ºå½“ä½ å®ä¾‹åŒ–ä¸€ä¸ªç±»æ—¶ï¼Œå®ƒçš„æ„é€ å‡½æ•°ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œå› æ­¤è¾“å‡ºã€‚

## å¯¹è±¡åˆ›å»º:__ æ–°å»º _ _

åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æš‚åœä¸€ä¸‹ã€‚å¦‚æœä½ æ¥è‡ª C/C++å’Œå®ƒä»¬çš„è¡ç”Ÿç‰©ï¼Œä½ ä¼šæƒ³ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬å®ä¾‹åŒ–å¯¹è±¡æ—¶æ²¡æœ‰æ–°çš„å…³é”®å­—ã€‚Python åšäº‹æƒ…æœ‰ç‚¹ä¸åŒã€‚å®ƒéšå¼è°ƒç”¨ __new__ magic æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨ __init__ åˆå§‹åŒ–ä¹‹å‰è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ã€‚å°±åœ¨ Book ç±»ä¸­çš„ __init__ æ–¹æ³•å®šä¹‰ä¹‹å‰ï¼Œæˆ‘ä»¬æ·»åŠ ä»¥ä¸‹å†…å®¹:

```
def __new__(cls, title, author):
    print("A new instance of book")
    instance = object.__new__(cls)
    return instance
```

è¿˜æ˜¯é‚£å¥è¯ï¼Œä¸è¦å¤ªåœ¨æ„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä»¥åŠä¸ºä»€ä¹ˆè¿™é‡Œå« clsï¼Œè€Œä¸æ˜¯ selfï¼Œå°±åƒæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ã€‚åœ¨ Python çš„ OOP æ–¹æ³•ä¸­å‘½åç¬¬ä¸€ä¸ªå‚æ•°æœ‰ç»†å¾®å·®åˆ«ï¼Œä½†æ˜¯ä¸ºäº†æœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œå‡è®¾ cls å’Œ self åˆ†åˆ«æ˜¯ç±»å’Œå®ä¾‹æ–¹æ³•çš„å‘½åçº¦å®šã€‚ç”±äºè¿™ä¸æ˜¯å…³äº OOP çš„æ•™ç¨‹ï¼Œæˆ‘å°†æŠŠç±»å’Œå®ä¾‹æ–¹æ³•ä¹‹é—´çš„åŒºåˆ«æ¨è¿Ÿåˆ°åé¢çš„åšå®¢ä¸­ã€‚ç°åœ¨ï¼Œå½“æˆ‘ä»¬é‡æ–°è¿è¡Œä»£ç æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°:

```
A new instance of book is created
Things Fall Apart Chinua Achebe
```

æˆ‘ä»¬æœ‰å®Œæ•´çš„æºä»£ç å¦‚ä¸‹:

```
**class** Book:
    **def** __new__(cls, title, author):
        print("A new instance of book")
        instance = object.__new__(cls)
        return instance **def** __init__(self, title, author):
        self.title = title
        self.author = author
        print(f"{title} was written by {author}")book = Book(â€œThings Fall Apartâ€, â€œChinua Achebeâ€)
# A new instance of book is created
# Things Fall Apart was written by Chinua Achebe
```

Python ä¸­æœ‰è®¸å¤šç¥å¥‡çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸ä¼šèŠ±æ—¶é—´ä¸€ä¸€ä»‹ç»ï¼Œä½†æ˜¯å¦‚æœæ‚¨è¶³å¤Ÿå¥½å¥‡ï¼Œå¯ä»¥è¿è¡Œ dir(int)æ¥æŸ¥æ‰¾ int ç±»çš„ç¥å¥‡æ–¹æ³•ã€‚æˆ‘ä»¬å°†çœ‹çœ‹å…¶ä»–ç¥å¥‡çš„æ–¹æ³•ï¼Œä» __add__ å¼€å§‹ã€‚

## åŠ æ³•ä¸­ç¼€è¿ç®—ç¬¦:__add__

è¯´åˆ° intï¼Œè®©æˆ‘ä»¬é€šè¿‡åšä¸€äº›åŸºæœ¬çš„æ•°å­¦æ¥è·å¾—ä¹è¶£ã€‚åœ¨ç»ˆç«¯ä¸Šè¾“å…¥ python æ‰“å¼€ REPLï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚æˆ‘å‡è®¾æ‚¨å·²ç»å®‰è£…äº† Pythonã€‚

æ³¨æ„:ä¸‹é¢ä»£ç ç‰‡æ®µä¸­å‰é¢çš„ä¸‰ä¸ªå³å°–æ‹¬å·è¡¨ç¤ºæç¤ºã€‚

```
>>> balance = 3
>>> balance + 2
5
```

å¦‚ä½ æ‰€æ–™ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç­”æ¡ˆ 5ã€‚ä½†æ˜¯ç­‰ç­‰ï¼ŒPython æ˜¯æ€ä¹ˆè§£è¯»æ–¹ç¨‹çš„ï¼Ÿä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»è°ƒæŸ¥åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚int ç±»æœ‰ä¸€ä¸ª __add__ magic æ–¹æ³•æ¥è®¡ç®—ç­‰å¼ã€‚æ¯å½“ Python çœ‹åˆ°+è¿ç®—ç¬¦æ—¶ï¼Œå®ƒé¦–å…ˆæ£€æŸ¥ä¸¤ä¸ªæ“ä½œæ•°æ˜¯å¦éƒ½æ˜¯ int ç±»å‹ï¼Œå¹¶è°ƒç”¨å®ƒçš„ __add__ã€‚

```
>>> balance = 3
>>> balance.__add__(2)
5
```

ä¸Šé¢çš„ä»£ç ç‰‡æ®µç»™äº†æˆ‘ä»¬å’Œä»¥å‰ä¸€æ ·çš„ç»“æœï¼Œä½†æ˜¯ __add__ æ–¹æ³•å¹¶ä¸åƒçœ‹ä¸Šå»é‚£æ ·ç®€å•ã€‚Python å¦‚ä½•ä½¿ç”¨åŒä¸€ä¸ª+è¿ç®—ç¬¦è¿›è¡Œå­—ç¬¦ä¸²ä¸²è”ï¼Ÿæˆ‘ä¹‹å‰æäº¤çš„ææ–™é‡Œæœ‰ä¸ªæš—ç¤ºã€‚å› ä¸º Python æ˜¯ä¸€ç§åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œæ‰€ä»¥+è¿ç®—ç¬¦ä¸ä¼šç›´æ¥å°†æ“ä½œæ•°ç›¸åŠ ã€‚å®ƒé¦–å…ˆæ£€æŸ¥å®ƒä»¬ï¼Œå¦‚æœå®ƒä»¬ä¸å±äºåŒä¸€ç±»å‹ï¼Œå°±åœ¨å¯¹å®ƒä»¬é‡‡å–è¡ŒåŠ¨ä¹‹å‰å¼ºåˆ¶å®ƒä»¬é‡‡ç”¨æ­£ç¡®çš„æ ¼å¼ã€‚

ä¸ int ç±»ä¸€æ ·ï¼Œstr ç±»ä¸­ä¹Ÿæœ‰ä¸€ä¸ª __add__ æ–¹æ³•ï¼Œè¿™ä½¿å¾—è¿æ¥æˆä¸ºå¯èƒ½ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„å®é™…æƒ…å†µ:

```
>>> name = â€œJohnâ€
>>> name + â€œSnowâ€
â€˜JohnSnowâ€™
>>> name.__add__("Doe")
'JohnDoe'
```

ä¸Šé¢çš„ä»£ç ç‰‡æ®µå±•ç¤ºäº† Python ä¸­çš„ä¸€äº›åŸºæœ¬è¿æ¥ã€‚

## ä½¿ç”¨é­”æ³•æ–¹æ³•çš„å¥½å¤„

ä½¿ç”¨ Python çš„ç¥å¥‡æ–¹æ³•çš„æœ€å¤§å¥½å¤„ä¹‹ä¸€æ˜¯ï¼Œå®ƒä»¬æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥ä½¿å¯¹è±¡è¡¨ç°å¾—åƒå†…ç½®ç±»å‹ä¸€æ ·ã€‚è¿™æ ·ï¼Œæ‚¨å¯ä»¥å¾ˆå®¹æ˜“åœ°æ•æ‰æ½œåœ¨çš„é”™è¯¯ï¼Œå¹¶å°½æ—©ä¿®å¤å®ƒä»¬ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¸¤ç§ä¸åŒçš„ç±»å‹ä¸Šå°è¯•ä½¿ç”¨ __add__ æ–¹æ³•ã€‚è®©æˆ‘ä»¬ç¨å¾®ä¿®æ”¹ä¸€ä¸‹åŠ æ³•ä»£ç ã€‚

```
>>> balance = 3
>>> name = "John"
>>> balance + name
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unsupported operand type(s) for +: 'int' and 'str'
```

ä»ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œå½“æˆ‘ä»¬è¯•å›¾å‘å­—ç¬¦ä¸²æ·»åŠ æ•´æ•°æ—¶ï¼ŒPython å¼•å‘äº†ä¸€ä¸ªå¼‚å¸¸ï¼Œç”šè‡³åœ¨ TypeError ç»†èŠ‚ä¸­å‘Šè¯‰äº†æˆ‘ä»¬åŸå› ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªæ–¹æ³•æ˜¯é‡å†™ add æ–¹æ³•ï¼Œè¿™è¶…å‡ºäº†æˆ‘ä»¬çš„æ”¯ä»˜çº§åˆ«ã€‚

## ç»“è®º

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä»€ä¹ˆæ˜¯é­”æ³•æ–¹æ³•åŠå…¶ç”¨æ³•ã€‚ç°åœ¨å»å†™ä¸€äº› python ä»£ç ã€‚

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·å…³æ³¨æˆ‘çš„ handle [Bright](https://medium.com/@jessebrite) äº†è§£æ›´å¤šå…³äºè½¯ä»¶å¼€å‘å’Œä¸€èˆ¬æŠ€æœ¯çš„æ•…äº‹ã€‚

# åˆ†çº§ç¼–ç 

æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼åœ¨ä½ ç¦»å¼€ä¹‹å‰:

*   ğŸ‘ä¸ºæ•…äº‹é¼“æŒï¼Œè·Ÿç€ä½œè€…èµ°ğŸ‘‰
*   ğŸ“°æ›´å¤šå†…å®¹è¯·æŸ¥çœ‹[å‡çº§ç¼–ç åˆŠç‰©](https://levelup.gitconnected.com/?utm_source=pub&utm_medium=post)
*   ğŸ””å…³æ³¨æˆ‘ä»¬:[Twitter](https://twitter.com/gitconnected)|[LinkedIn](https://www.linkedin.com/company/gitconnected)|[æ—¶äº‹é€šè®¯](https://newsletter.levelup.dev)

ğŸš€ğŸ‘‰ [**åŠ å…¥å‡çº§è¾¾äººé›†ä½“ï¼Œæ‰¾åˆ°ä¸€ä»½æƒŠè‰³çš„å·¥ä½œ**](https://jobs.levelup.dev/talent/welcome?referral=true)