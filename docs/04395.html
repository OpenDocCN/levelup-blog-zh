<html>
<head>
<title>Web Scraping With R (Part 1 — Static Webpages)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用R进行网页抓取(第1部分—静态网页)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/web-scraping-with-r-part-1-static-webpages-37e6d4f11d07?source=collection_archive---------6-----------------------#2020-06-24">https://levelup.gitconnected.com/web-scraping-with-r-part-1-static-webpages-37e6d4f11d07?source=collection_archive---------6-----------------------#2020-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/7fd443edac05657d8b2ca7c5b9205c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ri8W3LSfnLHSFVd-ghUbw.jpeg"/></div></div></figure><p id="b15d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有一段时间了，我很高兴回来了！在这整个期间，我花了很多时间在网上冲浪，我意识到那里的信息太多了。然而，当我们不得不手动滚动和阅读特定网站上的所有内容时，使用几行简单的代码来获取我们感兴趣的信息会有多好呢？</p><p id="7adb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我之前的帖子中，我写了一篇关于通过Python进行web抓取的文章，所以我决定做一些不同的事情，尝试用另一种编程语言r进行web抓取。</p><div class="kz la gp gr lb lc"><a href="https://medium.com/@lzpdatascience/web-scraping-and-text-summarization-of-news-articles-using-python-2ecfb3e71050" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">使用Python实现新闻文章的Web抓取和文本摘要</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">在这篇文章中，我想用Python从一个新闻中抓取并总结一个新闻文章链接的故事…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">medium.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq jz lc"/></div></div></a></div><p id="51d1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">事不宜迟，让我们开始吧，希望你喜欢这篇文章。</p><p id="532f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本教程中，我们将抓取静态网页。静态和动态网页的主要区别在于，后者忽略了Javascript。因此，您可以抓取信息，而不需要服务器。</p><p id="7e0b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用本教程中的步骤，您可能会遇到错误，这些错误可能不允许您抓取动态网页上的任何数据。在这种情况下，我们需要一个不同的解决方法，我将很快为此写另一个指南。</p><p id="bead" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们从安装和加载必要的库开始:</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/df301b19d9521ac874b36929f8421177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*15hpHxVcWSmWNX4iPCE6hg.png"/></div></figure><p id="dce4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">加载完库之后，我们可以首先将URL分配给一个对象，并检查网站的抓取权限。阅读网站的robots.txt文件是一个好习惯，以便在抓取特定网站之前了解所需的权限。</p><p id="87ed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我的例子中，我将从https://scrapethissite.com/pages/simple/的T2获取国家数据。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/4e0132ba5db5c0ac4cf3950b5bc3e03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*0pc-VXG5LYe7ku26wgBvtg.png"/></div></figure><p id="bb93" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">get_robotstxt()函数允许我们获取我们计划抓取的特定网站的抓取权限。在这种情况下，对于我感兴趣的链接，似乎没有很多限制来禁止用户代理进行web抓取。</p><p id="ef07" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了更好地理解robotstxt()的工作原理，下面的链接可能会有所帮助:【https://moz.com/learn/seo/robotstxt<a class="ae lw" href="https://moz.com/learn/seo/robotstxt" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/e19b8b816ce587fb3b531805c46210cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DhTV_jqc-u4TT8jCSeWzMQ.png"/></div></div></figure><p id="befe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">但是，有时该函数可能无法准确返回给定网站的权限。因此，您也可以在网站的扩展名后面添加/robots.txt，以获得更好的结果。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/e7d8c40eb834fe005e02b0750676f72f.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*UuS5FFD0JgxJowsPe_c1CA.png"/></div></figure><p id="c794" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">太好了！看起来我们可以继续抓取，但是不需要请求任何许可就可以避开课程和FAQ链接。</p><p id="3171" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们可以使用read_html()函数读取静态HTML页面的内容。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ma"><img src="../Images/cadd799fd6ff2aedcbf956853eb2720e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQA90GoN_qUt82i8gXu85g.png"/></div></div></figure><p id="9406" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从输出中，我们可以看到HTML格式的网页内容。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mb"><img src="../Images/d4248d817c5e0c069c5ae517715b2235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tEcA860q23vl77-BaSnrVA.png"/></div></div></figure><p id="fc5a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这可能看起来有点令人不知所措，但是不要担心，因为我们只对获取国家信息感兴趣，我们将继续使用html_nodes()和html_text()函数来获取包含我们感兴趣的内容的特定节点。</p><p id="3874" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有两种方法来识别我们感兴趣的对象。第一种使用右键单击-&gt; inspect -&gt;定位包含我们想要抓取的元素的字符串。我们可以看到，我们感兴趣的信息似乎属于“国家信息”类。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mc"><img src="../Images/c65fb391108867eb3f51126a0a4c7521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWSFtQUWh5hcNjII83nshw.png"/></div></div></figure><p id="908f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">另一个我更喜欢的方法是使用SelectorGadget chrome扩展。使用这个工具，只需单击一下就可以返回我们想要的特定元素。它还提供了非常有用的XPath / CSS选择器输出。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/3e234cf75862637f20b332ebf418fa59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5HN7ePcs9SfhH5U-4W6Glw.png"/></div></div></figure><p id="daa2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">抓取元素后的输出</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi me"><img src="../Images/1a1316588913b61dfa16ff41a1f851f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzEsWN8qL7E8FdhFyE7keA.png"/></div></div></figure><p id="f236" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如我们所看到的，字符串包含许多换行符“\n”和不必要的空格，这可能会使输出看起来有点混乱。因此，我们可以应用“stringr”库中的函数。</p><p id="a77d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以首先使用str_remove_all()函数删除换行符。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mf"><img src="../Images/6eca147c18ad5d99134a21023b3d588b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8eeWEGWYRqGlKPWrDMTPhA.png"/></div></div></figure><p id="636c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，输出中似乎仍有许多空白。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mg"><img src="../Images/dadca1d877495e55ac66ef60685b569e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*okhe7GZg_c-mJY-Wo_aqEA.png"/></div></div></figure><p id="f31a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们可以使用str_squish()函数来修剪空白。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/b0266fffbea692f4438fd6e0615f8c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ff3qLOoqVlCnbJfUrCKwBQ.png"/></div></div></figure><p id="e4ed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在输出看起来整洁多了！</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mi"><img src="../Images/a3856ff18e28a377b5d3a11b9ec4a848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YrjZi0zJcvxyMiecm37rfA.png"/></div></div></figure><p id="f4a1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，根据需要，我们还可以将文档转换为数据框，并将文档导出为Excel CSV文件，以便在本地计算机上使用。</p><p id="4d26" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意:记住使用setwd()函数设置您想要导出CSV文件的工作目录，以便轻松定位您导出的文件！</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mj"><img src="../Images/e7be186f5d48d80c3e64206e9b095aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v16BIBcnsq5reJaROH_ApQ.png"/></div></div></figure><p id="57fc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这就结束了关于使用R！在未来，我们将在第2部分中寻找抓取动态网页的方法。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="75ea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">好奇的学习者？释放你在媒体上学习的全部潜力，用不到一杯咖啡的钱支持像我这样的作家。</p><div class="kz la gp gr lb lc"><a href="https://lzpdatascience.medium.com/membership" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">通过我的推荐链接加入媒体——杰森·LZP</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">lzpdatascience.medium.com</p></div></div><div class="ll l"><div class="mr l ln lo lp ll lq jz lc"/></div></div></a></div><p id="e2af" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">刚接触R编程，不知道从哪里开始？看看我的电子书一步一步的指南！</p><div class="kz la gp gr lb lc"><a href="https://link.medium.com/oPliK2gNZbb" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">数据科学入门指南(PDF /电子书</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">有一段时间了，我希望每个人都保持安全和健康。本月初，由于封锁，我刚刚…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">link.medium.com</p></div></div><div class="ll l"><div class="ms l ln lo lp ll lq jz lc"/></div></div></a></div></div></div>    
</body>
</html>