<html>
<head>
<title>Building a Slack Block Kit app with Serverless and Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用无服务器和Go构建松弛块套件应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-a-slack-block-kit-app-with-serverless-and-go-cd62445db177?source=collection_archive---------8-----------------------#2021-03-06">https://levelup.gitconnected.com/building-a-slack-block-kit-app-with-serverless-and-go-cd62445db177?source=collection_archive---------8-----------------------#2021-03-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5521" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">新员工在Twitter上发布全公司名单，询问我们为什么不能改变“办公室里有狗”的政策，这是一个笑话。在Clever，我们提出了一种理论，认为高管团队中有人对持续抵制带狗上班过敏。我很乐意在LaunchDarkly一个对狗友好的办公室工作，但自从2020年5月我开始工作以来，我们(和我们的狗)都是WFH。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/221eccda9cf8289b249a2f8ec5e7b35d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_dyDpFmoQ4jyqme0PFAzPw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Pupster Slack应用程序主页</figcaption></figure><p id="efd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我建造了<a class="ae le" href="https://pupster.app/" rel="noopener ugc nofollow" target="_blank"> Pupster </a>来让远程团队很容易遇见彼此的狗。这是一个Slack应用程序，您可以将其添加到共享狗狗照片的频道中。您可以创建“小狗档案”来了解您团队的宠物。我的灵感来自于Clever基于Tumblr和Hubot构建的低代码系统，但我想对它进行技术升级:</p><ul class=""><li id="8903" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><a class="ae le" href="https://www.serverless.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">无服务器</strong> </a>，这使得在AWS上部署HTTPS API变得很容易</li><li id="8568" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><a class="ae le" href="https://github.com/slack-go/slack" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> slack-go </strong> </a>，因为我一直在用go，以前也用过这个SDK</li><li id="f2f1" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><a class="ae le" href="https://api.slack.com/block-kit" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">Slack Block Kit</strong></a>，我在现代Slack应用中见过，支持消息内UI控件，如按钮、选择菜单等。</li></ul><p id="8ccc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇文章中，我想分享用Go设置无服务器Slack Block Kit应用程序背后的有趣之处。这并没有进入<a class="ae le" href="https://api.slack.com/start" rel="noopener ugc nofollow" target="_blank">创建Slack app </a>的过程，所以如果你要跟进，你会想先这么做。</p><p id="ea31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我需要为我的Slack应用程序支持四个API:</p><ul class=""><li id="9e44" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">POST /interactions</code>被<a class="ae le" href="https://api.slack.com/interactivity" rel="noopener ugc nofollow" target="_blank"> Slack Block Kit交互API </a>调用来构建UI</li><li id="b35b" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">POST /events</code>由<a class="ae le" href="https://api.slack.com/apis/connections/events-api" rel="noopener ugc nofollow" target="_blank">松弛事件API </a>调用，以响应与Block Kit应用程序交互之外的松弛事件</li><li id="658f" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">GET /auth_callback</code>用于响应<a class="ae le" href="https://api.slack.com/authentication/oauth-v2" rel="noopener ugc nofollow" target="_blank"> OAuth 2授权码授予流程</a>当有人添加你的Slack app时</li><li id="7039" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">POST /select</code>用于返回<a class="ae le" href="https://api.slack.com/reference/block-kit/block-elements#external_multi_select" rel="noopener ugc nofollow" target="_blank">动态外部数据选择下拉式菜单控件</a></li></ul><p id="d15c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面的<code class="fe lt lu lv lw b">serverless.yml</code>片段展示了基于Go二进制文件定义这些端点的有趣部分。支持不同的无服务器<a class="ae le" href="https://serverless-stack.com/chapters/stages-in-serverless-framework.html" rel="noopener ugc nofollow" target="_blank">阶段</a> <em class="lx"> </em>(如<code class="fe lt lu lv lw b">dev</code>、<code class="fe lt lu lv lw b">prod</code>)。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="fa8e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">构建和部署逻辑存在于一个<code class="fe lt lu lv lw b">Makefile</code>中:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="a4ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lt lu lv lw b">interactions/main.go</code>代码需要处理不同的用户交互:按钮点击、模态提交和快捷方式。您可以依靠slack-go型号来完成大部分繁重的工作。不要忘记使用松弛签名令牌来验证每个请求。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="402f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lt lu lv lw b">eventhandler/main.go</code>代码需要处理不同的事件:<a class="ae le" href="https://api.slack.com/events/url_verification" rel="noopener ugc nofollow" target="_blank"> URL验证</a>、“应用主页打开”、“应用提及”等。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="40db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lt lu lv lw b">authcallback/main.go</code>代码在OAuth 2舞蹈中扮演自己的角色，以获得一个API令牌:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="43e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后一部分是<code class="fe lt lu lv lw b">selectmenu/main.go</code>代码，您只需要支持<a class="ae le" href="https://api.slack.com/reference/block-kit/block-elements#external_multi_select" rel="noopener ugc nofollow" target="_blank">外部选择菜单</a>:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="898e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就是你开始工作所需要的全部样板文件。你可以在下面的公开报道中看到一些使用Block Kit和slack-go构建Slack应用的例子:</p><div class="ma mb gp gr mc md"><a href="https://github.com/bushelpowered/slackbot" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd iu gy z fp mi fr fs mj fu fw is bi translated">bushelpowered/slackbot</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">一个Go Slack机器人框架。在GitHub上创建一个帐户，为bushelpowered/slackbot开发做贡献。</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">github.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ky md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://github.com/Aristat/slack-bot" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd iu gy z fp mi fr fs mj fu fw is bi translated">Aristat/slack-bot</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">松弛机器人Golang。在GitHub上创建一个帐户，为Aristat/slack-bot开发做贡献。</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">github.com</p></div></div><div class="mm l"><div class="ms l mo mp mq mm mr ky md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://github.com/ogidow/gobot" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd iu gy z fp mi fr fs mj fu fw is bi translated">奥吉多/戈博特</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">gobot是一个使用松弛交互消息的bot框架。在gobot中，一系列的交互被称为机器…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">github.com</p></div></div><div class="mm l"><div class="mt l mo mp mq mm mr ky md"/></div></div></a></div><p id="3636" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以开始<a class="ae le" href="https://api.slack.com/block-kit/building" rel="noopener ugc nofollow" target="_blank">构建Slack Blocks </a>，对事件做出响应，并最终部署到<a class="ae le" href="https://launchdarkly.slack.com/apps" rel="noopener ugc nofollow" target="_blank"> Slack应用商店</a>来取悦成千上万快乐的客户，或者对我来说，狗主人。玩得开心！</p></div></div>    
</body>
</html>