<html>
<head>
<title>Build NodeJS server application with express using typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用typescript通过express构建NodeJS服务器应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-node-js-server-application-with-express-using-typescript-b8caa0a68755?source=collection_archive---------7-----------------------#2021-12-18">https://levelup.gitconnected.com/build-node-js-server-application-with-express-using-typescript-b8caa0a68755?source=collection_archive---------7-----------------------#2021-12-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="f255" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">今天让我们学习使用express framework构建nodeJS应用程序。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/999f74d983626ccce3d9ebdf75a6fd64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OKxVTRPes_u785WxFSqpw.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">图片来自<a class="ae lf" href="https://pixabay.com/vectors/node-js-logo-nodejs-javascript-736399/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae lf" href="https://pixabay.com/users/copyrightfreepictures-203/" rel="noopener ugc nofollow" target="_blank"> CopyrightFreePictures </a></figcaption></figure><p id="e3fc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">NodeJS是一个开源的、跨平台的运行时环境，构建在Google Chrome网络浏览器中使用的相同JavaScript引擎上。它允许开发人员构建服务器端应用程序中间层，包括用于平台API的web服务器和web服务。</p><p id="7a75" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">Express是Node之上的最基本的web应用程序框架。可用于快速构建web应用、RESTFUL APIs等的JS。</p><p id="fb50" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">现在让我们开始构建我们的第一个nodeJS应用程序。</p><h1 id="0c97" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">先决条件</h1><p id="eaef" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">节点是必须安装在我们的机器上，其次让我们确保我们有一个用户友好的编辑器来处理我们的项目。</p><h2 id="af01" class="mm lk iq bd ll mn mo dn lp mp mq dp lt lg mr ms lx lh mt mu mb li mv mw mf mx bi translated">安装节点</h2><p id="0978" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">首先，我们必须确保节点安装在我们的机器上。</p><p id="128b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">我们可以通过从终端运行命令<code class="fe my mz na nb b">node --version</code>来验证它。如果已经安装在计算机上，此命令应该显示已安装的节点版本。</p><p id="d7b4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">否则，要安装节点，请访问<a class="ae lf" href="https://nodejs.org" rel="noopener ugc nofollow" target="_blank">节点网站</a>并点击绿色大安装按钮。</p><h2 id="1299" class="mm lk iq bd ll mn mo dn lp mp mq dp lt lg mr ms lx lh mt mu mb li mv mw mf mx bi translated"><strong class="ak">代码编辑器</strong></h2><p id="1a28" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">我们可以使用任何我们喜欢的代码编辑器。但是如果你的系统上还没有安装任何代码编辑器，那么我强烈推荐使用<a class="ae lf" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank"> VS代码编辑器</a>。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="69ce" class="lj lk iq bd ll lm nj lo lp lq nk ls lt lu nl lw lx ly nm ma mb mc nn me mf mg bi translated">1.设置项目</h1><p id="7547" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">首先，让我们创建一个保存源代码的目录。</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="1425" class="mm lk iq nb b gy ns nt l nu nv">mkdir my-nodejs-app</span><span id="671b" class="mm lk iq nb b gy nw nt l nu nv">cd my-nodejs-app</span></pre><p id="2eda" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">这里<code class="fe my mz na nb b">my-nodejs-app</code>是我们的项目名称。</p><h1 id="8b93" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">2.正在初始化项目</h1><p id="7e96" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">一旦我们进入项目文件夹<code class="fe my mz na nb b">my-nodejs-app</code>，我们将使用命令<code class="fe my mz na nb b">npm init</code>为我们的应用程序创建package.json文件。该命令提示一些与应用程序的名称、版本和入口点相关的问题。现在我们可以通过传递选项<code class="fe my mz na nb b">-y</code>来保持简单，它将所有值设置为默认值。</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="c3f1" class="mm lk iq nb b gy ns nt l nu nv">npm init -y</span></pre><p id="a3dd" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">接下来，我们将通过使用以下命令创建<code class="fe my mz na nb b">tsconfig.json</code>来初始化我们的项目:</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="d99d" class="mm lk iq nb b gy ns nt l nu nv">npx tsc --init</span></pre><p id="30c6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">上面的命令在我们的项目目录中生成一个<code class="fe my mz na nb b">tsconfig.json</code>文件。这个<code class="fe my mz na nb b">tsconfig.json</code>文件允许我们配置和定制TypeScript和<code class="fe my mz na nb b">tsc</code>编译器如何交互。在这个项目中，我们将使用默认配置。</p><h1 id="226a" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">3.安装依赖项</h1><p id="daf5" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">现在，我们将通过运行以下命令<strong class="jt ir"> : </strong>来安装项目中所需的所有依赖项</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="f7bd" class="mm lk iq nb b gy ns nt l nu nv">npm install express —S</span><span id="ad00" class="mm lk iq nb b gy nw nt l nu nv">npm i typescript ts-node nodemon @types/express @types/node -D</span></pre><p id="9d05" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">选项<code class="fe my mz na nb b">-D</code>用于安装仅在开发期间需要的模块，选项<code class="fe my mz na nb b">-S</code>用于安装运行时需要的模块。</p><p id="7f24" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">模块<code class="fe my mz na nb b">@types/node</code>和<code class="fe my mz na nb b">@types/express</code>是节点和快速模块的类型定义。</p><p id="bcc1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">在我们应用程序的开发过程中，我们将使用<code class="fe my mz na nb b">nodemon</code>模块进行热重装。</p><h1 id="e0fa" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">4.创建服务器文件</h1><p id="d9e2" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">现在，当我们的项目设置完成后，我们可以开始实现我们的实际服务器。</p><p id="0acb" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">让我们在项目中创建<code class="fe my mz na nb b">index.ts</code>文件，并将下面的代码复制到其中。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="1817" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">这里我们已经导入了express，并使用一个简单的回调函数在端口<code class="fe my mz na nb b">8000</code>上初始化了我们的服务器，以记录我们的应用程序的状态。</p><p id="dd3a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">我们创建了一个简单的GET route，它的基本路径为空，应该会返回一个简单的字符串作为响应。</p><h1 id="7131" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">5.构建并运行应用程序</h1><p id="01ac" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">现在让我们更新我们的<code class="fe my mz na nb b">package.json</code>文件。首先，我们将通过添加脚本来构建和运行我们的应用程序，从而更新<code class="fe my mz na nb b">scripts</code>块。</p><p id="28dd" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">我们还需要确保应用程序的入口点<code class="fe my mz na nb b">main</code>指向我们的<code class="fe my mz na nb b">index.ts</code>文件</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="0ae9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">现在，为了构建和运行应用程序，我们将使用这个命令，</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="b9c5" class="mm lk iq nb b gy ns nt l nu nv">npm run start</span></pre><p id="9a12" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">现在，当我们点击浏览器上的<code class="fe my mz na nb b">http://localhost:8000</code>时，我们应该会看到从GET API路径返回的响应<code class="fe my mz na nb b">Welcome to node world!!</code>。</p><h2 id="e5b7" class="mm lk iq bd ll mn mo dn lp mp mq dp lt lg mr ms lx lh mt mu mb li mv mw mf mx bi translated">用nodemon开发</h2><p id="6392" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">现在让我们看看如何在开发阶段运行和测试我们的应用程序。我们将使用<code class="fe my mz na nb b">nodemon</code>为我们提供热重载特性，这使我们能够在编码的同时进行测试。对于运行以下命令，</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="2f04" class="mm lk iq nb b gy ns nt l nu nv">npm run start:dev</span></pre><p id="80af" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">现在让我们在<code class="fe my mz na nb b">index.ts</code>中更改我们的路线</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="aa2c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">这里我们可以看到，随着保存在我们的<code class="fe my mz na nb b">index.ts</code>文件中的每个更改，我们的应用程序都在重建，新的更改也反映在我们的应用程序中。</p><h1 id="7779" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">6.测试节点应用程序</h1><p id="bdd2" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">我们当然不希望依靠手动测试来保证我们的应用程序没有错误。在本节中，我们将学习在节点应用程序中合并单元测试和集成测试。</p><p id="84df" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">在本文中，我们将依靠jest和supertest来编写我们的测试。因此，让我们继续安装所需的依赖项。</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="84cb" class="mm lk iq nb b gy ns nt l nu nv">npm i jest ts-jest supertest @types/supertest @types/jest -D</span></pre><h2 id="09d4" class="mm lk iq bd ll mn mo dn lp mp mq dp lt lg mr ms lx lh mt mu mb li mv mw mf mx bi translated">单元测试</h2><p id="c599" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">单元测试用于测试孤立的小块代码或功能。为了简单起见，我们将考虑一个简单的add函数进行测试。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="5a1d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">在这里，我们为上面提到的简单的add函数编写一个单元测试。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="14ad" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">要运行测试，请将以下命令添加到脚本块中的package.json。</p><pre class="kq kr ks kt gt no nb np nq aw nr bi"><span id="a6c9" class="mm lk iq nb b gy ns nt l nu nv">“test:unit”: “jest”</span></pre><h2 id="3bc1" class="mm lk iq bd ll mn mo dn lp mp mq dp lt lg mr ms lx lh mt mu mb li mv mw mf mx bi translated">整合测试</h2><p id="ca28" class="pw-post-body-paragraph jq jr iq jt b ju mh jw jx jy mi ka kb lg mj ke kf lh mk ki kj li ml km kn ko ij bi translated">集成测试用于测试交互中多个更大的单元(组件),这反过来有助于确保系统作为一个整体正常工作。</p><p id="eb71" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">我们将使用<a class="ae lf" href="https://www.npmjs.com/package/supertest" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir"> supertest </strong> </a>，这是一个通过另一个库superagent帮助断言网络请求的库。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">节点应用程序</figcaption></figure><p id="5417" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">在下面的集成测试中，我们将测试网络请求的各个方面，如状态代码和响应数据。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="0f70" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">我们使用jest来运行我们的测试。我们可以用jest命令给出测试文件的路径，以便从特定的测试文件夹中运行测试。现在，我们将使用测试命令的脚本标记来更新package.json。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="9cc9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">我们的第一个Node.js应用程序已经准备就绪，热烈欢迎来到Node world！！</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="1f44" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">祝你黑客愉快，并在评论中留下更多问题。</p></div></div>    
</body>
</html>