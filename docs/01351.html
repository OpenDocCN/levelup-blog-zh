<html>
<head>
<title>Understand the Nullish coalescing operator coming in ES2020</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解ES2020中的Nullish合并运算符</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/understand-the-nullish-coalescing-operator-coming-in-es2020-2d1c6df1765f?source=collection_archive---------6-----------------------#2019-12-16">https://levelup.gitconnected.com/understand-the-nullish-coalescing-operator-coming-in-es2020-2d1c6df1765f?source=collection_archive---------6-----------------------#2019-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5ad8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解第三阶段提案中即将推出的JavaScript运算符。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/219287354246be5c1812ede6701b1b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dq9wZFLrNPLINqyLN4nBjw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd kv">无效合并运算符</strong></figcaption></figure><p id="b4a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">??</code> →无效合并运算符。</p><p id="903f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无效合并运算符<code class="fe ls lt lu lv b">??</code>，<strong class="ky ir"> </strong>是一个<strong class="ky ir"> </strong>短路运算符，与<code class="fe ls lt lu lv b">&amp;&amp;</code>和<code class="fe ls lt lu lv b">||</code>一样，如果左侧操作数是<code class="fe ls lt lu lv b"><strong class="ky ir">null</strong></code>或<code class="fe ls lt lu lv b"><strong class="ky ir">undefined</strong></code>，它将返回右侧操作数。否则，它返回左侧操作数。</p><p id="1950" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe ls lt lu lv b">??</code>时，falsy值(空字符串<code class="fe ls lt lu lv b">('')</code>、<code class="fe ls lt lu lv b">0</code>、<code class="fe ls lt lu lv b">false</code>、<code class="fe ls lt lu lv b">NaN</code>)仍将返回左操作数。而在<code class="fe ls lt lu lv b">||</code>或<code class="fe ls lt lu lv b">&amp;&amp;</code>中，它将返回右侧操作数。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="81fb" class="ma mb iq lv b gy mc md l me mf">let data = {};</span><span id="de44" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">let name = data.name ?? "Anonymous";</strong> // returns "Anonymous"</span><span id="a76e" class="ma mb iq lv b gy mg md l me mf">data = {name : "John"};</span><span id="6957" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">name = data.name ?? "Anonymous";</strong> <strong class="lv ir">// return "John"</strong></span><span id="1968" class="ma mb iq lv b gy mg md l me mf">data = {name : ""};</span><span id="7aae" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">name = data.name ?? "Anonymous";</strong> <strong class="lv ir">// return ""</strong></span></pre><p id="5dc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">nullish合并操作符将取代我们为变量设置默认值的方式。考虑功能:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="cb74" class="ma mb iq lv b gy mc md l me mf">function printName(user) {<br/>   console.log(`Hi ${user.name} From JavaScript Jeep`);<br/>}</span></pre><p id="9491" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的函数中，我们有一个<code class="fe ls lt lu lv b">user</code>参数。如果<code class="fe ls lt lu lv b">user</code>对象不包含<code class="fe ls lt lu lv b">name</code>，那么它将导致<code class="fe ls lt lu lv b">undefined</code>。在旧版本的JavaScript中，我们用以下模式处理这个问题:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="c2d8" class="ma mb iq lv b gy mc md l me mf">function printName(user = {}) {<br/>   <br/>   const name = user.name ? user.name : "Anonymous";</span><span id="af18" class="ma mb iq lv b gy mg md l me mf">    // Or another way<br/>   <br/>    // const name = user.name || "Anonymous";</span><span id="a09a" class="ma mb iq lv b gy mg md l me mf">   console.log(`Hi ${name} From JavaScript Jeep`);</span><span id="e6b2" class="ma mb iq lv b gy mg md l me mf">}</span></pre><p id="ad30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是使用零化合并:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="8609" class="ma mb iq lv b gy mc md l me mf">function printName(user = {}) {</span><span id="9fa7" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">    const name = user.name ?? "Anonymous";</strong></span><span id="8bf2" class="ma mb iq lv b gy mg md l me mf">    console.log(`Hi ${name} From JavaScript Jeep`);</span><span id="c524" class="ma mb iq lv b gy mg md l me mf">}</span></pre><h1 id="4ef2" class="mh mb iq bd kv mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">为什么我们需要零化合并？</h1><p id="d52e" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">当使用短路运算符<code class="fe ls lt lu lv b">&amp;&amp;</code>和<code class="fe ls lt lu lv b">||</code>时，我们需要处理所有的falsy值。</p><p id="dc9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">||</code> →这将返回它找到的第一个真值。否则，它返回最后一个falsy值。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="8a0a" class="ma mb iq lv b gy mc md l me mf">var a = 10, b = 0, c = null;</span><span id="de30" class="ma mb iq lv b gy mg md l me mf">a || b; // 10 (first truthy value)</span><span id="8ed6" class="ma mb iq lv b gy mg md l me mf">b || c; // null (last falsy value)</span></pre><p id="d080" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">&amp;&amp;</code> →这将返回它找到的第一个错误值。否则，它返回最后一个真值。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="43aa" class="ma mb iq lv b gy mc md l me mf">var a = 10, b = 0, c = null, d = 20;</span><span id="5a70" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">a &amp;&amp; b &amp;&amp; c ;  // 0 (first falsy value)</strong></span><span id="81e1" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">a &amp;&amp; d; // 20 (last truthy value)</strong></span></pre><p id="e8d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些短路操作符的问题在于，在JavaScript中:</p><p id="1f09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">0, false, '', NaN</code> →也是虚伪的价值观</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="a37c" class="ma mb iq lv b gy mc md l me mf">var name ;</span><span id="4e8a" class="ma mb iq lv b gy mg md l me mf">name = name || “Anonymous”; <!-- -->// <!-- -->Anonymous.</span></pre><p id="577c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">但是考虑到我们允许空字符串作为有效名称，那么:</strong></p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="86e7" class="ma mb iq lv b gy mc md l me mf">var name = '';</span><span id="7730" class="ma mb iq lv b gy mg md l me mf">name = name || “Anonymous”<!-- -->; // <!-- -->Anonymous.</span></pre><p id="0c1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以对于这种情况，最好的解决方案是nullish合并操作符，它只在左操作数是<code class="fe ls lt lu lv b">undefined</code>或<code class="fe ls lt lu lv b">null</code>时设置默认值。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="b67c" class="ma mb iq lv b gy mc md l me mf">var name = ''; </span><span id="43b3" class="ma mb iq lv b gy mg md l me mf">name ?? "Anonymous"; // <strong class="lv ir">''</strong></span></pre><p id="5029" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">评估示例:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="8c8d" class="ma mb iq lv b gy mc md l me mf"><strong class="lv ir">false ?? true; </strong>  //false</span><span id="4a00" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">0 ?? 1;   </strong>       // 0</span><span id="1782" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">'' ?? 'Anonymous';</strong> //''<br/><br/><strong class="lv ir">null ?? 0 ;</strong>      // 0</span><span id="3b73" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">undefined ?? 0 ;</strong> //0</span></pre><p id="e0fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一个:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="75fd" class="ma mb iq lv b gy mc md l me mf">function returnNull() {<br/>   return null;<br/>}</span><span id="6a52" class="ma mb iq lv b gy mg md l me mf">function returnZero() {<br/>   return 0;<br/>}</span><span id="9829" class="ma mb iq lv b gy mg md l me mf"><strong class="lv ir">returnNull() ?? returnZero(); // 0</strong></span></pre></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="ba7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与OR和and逻辑运算符一样，如果左侧既不是<code class="fe ls lt lu lv b">null</code>也不是<code class="fe ls lt lu lv b">undefined</code>，则不对右侧表达式求值。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="1ce6" class="ma mb iq lv b gy mc md l me mf">var a = 0;</span><span id="b568" class="ma mb iq lv b gy mg md l me mf">var b = 0;</span><span id="5963" class="ma mb iq lv b gy mg md l me mf">var c = a ?? ++b; </span><span id="48d2" class="ma mb iq lv b gy mg md l me mf">a; // 0</span><span id="83f0" class="ma mb iq lv b gy mg md l me mf">b; // 0</span><span id="bacf" class="ma mb iq lv b gy mg md l me mf">c; // 0</span></pre><h1 id="bc07" class="mh mb iq bd kv mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">没有使用<code class="fe ls lt lu lv b">&amp;&amp;</code>和<code class="fe ls lt lu lv b">||</code>运算符的链接。</h1><p id="6b4b" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">不能将AND ( <code class="fe ls lt lu lv b">&amp;&amp;</code>)和OR(<code class="fe ls lt lu lv b">||</code>)运算符直接与<code class="fe ls lt lu lv b">??</code>结合使用。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="3f01" class="ma mb iq lv b gy mc md l me mf">// incorrect way</span><span id="ac7d" class="ma mb iq lv b gy mg md l me mf">null || undefined ?? 0 ;</span><span id="8f3f" class="ma mb iq lv b gy mg md l me mf">// correct way</span><span id="2fd5" class="ma mb iq lv b gy mg md l me mf">(null || undefined) ?? 0;</span></pre><div class="nj nk gp gr nl nm"><a href="https://www.sitepoint.com/?ref=jagathishsaravanan" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">学习HTML、CSS、JavaScript、PHP、Ruby和响应式设计</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">通过SitePoint教程、课程和书籍学习网页设计和开发——html 5、CSS3、JavaScript、PHP、移动应用程序…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">www.sitepoint.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa kp nm"/></div></div></a></div><h2 id="e1a1" class="ma mb iq bd kv ob oc dn ml od oe dp mp lf of og mr lj oh oi mt ln oj ok mv ol bi translated">参考:<a class="ae om" href="https://v8.dev/features/nullish-coalescing" rel="noopener ugc nofollow" target="_blank"> V8 </a>，<a class="ae om" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator" rel="noopener ugc nofollow" target="_blank"> MDN </a>。</h2><p id="5256" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">跟随<a class="on oo ep" href="https://medium.com/u/f9ffc26e7e69?source=post_page-----2d1c6df1765f--------------------------------" rel="noopener" target="_blank"> Javascript吉普🚙💨</a></p></div></div>    
</body>
</html>