<html>
<head>
<title>Database seeding in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js中的数据库播种</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/database-seeding-in-node-js-2b2eec5bfaa1?source=collection_archive---------0-----------------------#2021-08-21">https://levelup.gitconnected.com/database-seeding-in-node-js-2b2eec5bfaa1?source=collection_archive---------0-----------------------#2021-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/aad6838d941e32478a3c5169e5f73d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDAJkca6jF2WEBGe7TikgQ.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://www.pexels.com/de-de/foto/person-die-eine-grune-pflanze-halt-1072824/" rel="noopener ugc nofollow" target="_blank">https://www . pexels . com/de-de/foto/person-die-eine-grune-pflanze-halt-1072824/</a></figcaption></figure><div class=""/><p id="322d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我想谈谈使用Node.js和MySQL的数据库播种:它是什么以及如何实现它。你会注意到它实际上非常简单明了。对于本教程，我选择MySQL作为数据库系统，但这个过程也应该与任何其他工作。在这种情况下，可能需要对SQL查询执行进行一些小的修改。</p><p id="7616" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从解释数据库播种开始。<a class="ae jd" href="https://en.wikipedia.org/wiki/Database_seeding" rel="noopener ugc nofollow" target="_blank">来源</a></p><blockquote class="lb lc ld"><p id="d497" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">数据库播种是用数据对数据库进行初始播种。设定数据库种子是一个过程，在此过程中，在安装数据库时会向数据库提供一组初始数据。当我们希望用将来要开发的数据填充数据库时，它特别有用。</p></blockquote><p id="2345" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们的目标是在初始化时向数据库“输入”虚拟数据。这非常有帮助，尤其是在开发过程中，或者对于在本地机器上运行开发环境(数据库)的新员工来说。</p></div><div class="ab cl li lj hu lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ij ik il im in"><p id="c8de" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们创建一个新的SQL脚本，其中包含插入虚拟数据的查询。稍后将使用Node.js执行该脚本。</p><p id="b897" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">播种脚本:<code class="fe lp lq lr ls b">./db/seeding.sql</code></p><figure class="lu lv lw lx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lt"><img src="../Images/ba1ca28334e9b486fbed02f8b2dbc951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GX0igsO4uoyOzWLCbfLkuQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">SQL代码片段</figcaption></figure><p id="a9e2" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个SQL命令将新的数据集插入到<code class="fe lp lq lr ls b">user</code>表中。<code class="fe lp lq lr ls b">?</code>是一个占位符，当使用Node.js调用脚本时，它会被一个变量(初始密码)替换。</p><p id="e20e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">确保在运行脚本之前创建了数据库表，否则将会失败。大多数形式都会处理好这一点。</p></div><div class="ab cl li lj hu lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ij ik il im in"><p id="db3f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们编写Node.js脚本，这是建立数据库连接和执行我们刚刚创建的SQL片段所必需的。</p><p id="8aa4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Node.js脚本:<code class="fe lp lq lr ls b">./db/index.js</code></p><figure class="lu lv lw lx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ly"><img src="../Images/f4689329902d9734577fd7cbe7367a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5w4x_2spGx4bhlH8pAW81w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Node.js脚本</figcaption></figure><p id="fe6f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里发生了什么？</p><ol class=""><li id="2be7" class="lz ma jg kf b kg kh kk kl ko mb ks mc kw md la me mf mg mh bi translated">使用<code class="fe lp lq lr ls b">dotenv</code>加载环境变量</li><li id="3ae7" class="lz ma jg kf b kg mi kk mj ko mk ks ml kw mm la me mf mg mh bi translated">阅读SQL片段</li><li id="255d" class="lz ma jg kf b kg mi kk mj ko mk ks ml kw mm la me mf mg mh bi translated">连接到数据库(MySQL)</li><li id="a1c4" class="lz ma jg kf b kg mi kk mj ko mk ks ml kw mm la me mf mg mh bi translated">生成随机密码(哈希)</li><li id="634b" class="lz ma jg kf b kg mi kk mj ko mk ks ml kw mm la me mf mg mh bi translated">执行SQL片段</li></ol><p id="9f79" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，如果一切正常，管理员密码将被记录到控制台。除了使用<code class="fe lp lq lr ls b">dotenv</code>，您还可以使用<code class="fe lp lq lr ls b">fs.readFileSync</code>从任何其他文件加载您的数据库凭证。</p><p id="f44d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您没有使用MySQL，您只需修改数据库连接设置。我确信有一个适用于您的数据库系统的npm包可以处理这个问题。</p><p id="11f9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后但同样重要的是，让我们扩展<code class="fe lp lq lr ls b">package.json</code>脚本来简化节点脚本的执行。</p><pre class="lu lv lw lx gt mn ls mo mp aw mq bi"><span id="685a" class="mr ms jg ls b gy mt mu l mv mw">{<br/>  "scripts": {<br/>    // ...<br/>    "seed": "node db/index.js"<br/>    // ...<br/>  }<br/>}</span></pre><p id="3b06" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您可以从终端使用一个命令运行数据库播种:<code class="fe lp lq lr ls b">npm run seed</code>。就是这样！你的数据库充满了虚拟数据，你可以专注于重要的东西。</p><p id="f823" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一个GitHub存储库，包括一个使用数据库播种的示例应用程序。看一看。</p><div class="ip iq gp gr ir mx"><a href="https://github.com/larswaechter/expressjs-api" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd jh gy z fp nc fr fs nd fu fw jf bi translated">GitHub-larswaechter/express js-API:用TypeScript &amp; Express.js构建的Node.js REST-API示例</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">这个存储库是一个用TypeScript和Express构建的虚拟Node.js REST-API。您可能希望将它用作…的代码库</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">github.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ix mx"/></div></div></a></div></div></div>    
</body>
</html>