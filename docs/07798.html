<html>
<head>
<title>Migrating React table from v6 to v7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将React表从版本6迁移到版本7</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/migrating-react-table-from-v6-to-v7-dc840eb7ad7?source=collection_archive---------7-----------------------#2021-03-11">https://levelup.gitconnected.com/migrating-react-table-from-v6-to-v7-dc840eb7ad7?source=collection_archive---------7-----------------------#2021-03-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9c5e8f1faf8d230b02cf64a63105703b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-Zvx4gKhaWUyqcqRP0_zg.jpeg"/></div></div></figure><p id="19d1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">React Table 是React的一个轻量级、快速且可扩展的datagrid包。最新版本即v7是一个无头工具，这意味着它不呈现或提供任何实际的UI元素。您可以构建和设计强大的数据网格体验，同时保持对标记和样式的100%控制。以前的版本(即v6)是一个表格组件，您不能100%控制表格标记和样式。最新版本使它更容易集成到任何现有的主题或现有的表格标记中。但是对于那些正在使用v6并希望迁移到v7的人来说，本指南将帮助您保持相同的风格和功能。</p><p id="79a0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">由于两个版本之间的差异是巨大的，我建议你安装<code class="fe la lb lc ld b"><a class="ae kz" href="https://www.npmjs.com/package/react-table-6" rel="noopener ugc nofollow" target="_blank">react-table-6</a></code>和<code class="fe la lb lc ld b">react-table</code>包(如果你有一个大的代码库或者复杂的用例)并且一个一个地迁移。要升级到最新版本，您必须安装React v16.8或更高版本。</p><p id="8ef0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是你使用版本<strong class="kd iu"> <em class="le"> 6时的样子。* </em> </strong>:</p><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="lj lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">反应表v6示例</figcaption></figure><p id="cb9d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">而迁移到<strong class="kd iu">版本<em class="le"> 7之后。* </em> </strong>它会是这样的:</p><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="lj lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">反应表v7示例</figcaption></figure><p id="7fd2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">没有改变用户界面/UX，这是我们想要的，但有代码或我们如何渲染它的变化。</p><h1 id="cc44" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">我们开始吧</h1><ul class=""><li id="f2e9" class="mn mo it kd b ke mp ki mq km mr kq ms ku mt ky mu mv mw mx bi translated"><strong class="kd iu">安装React表用</strong><a class="ae kz" href="https://npmjs.com/" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">NPM</strong></a><strong class="kd iu">或</strong> <a class="ae kz" href="https://yarnpkg.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">纱</strong> </a></li></ul><p id="2978" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">NPM</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="73af" class="nc lq it ld b gy nd ne l nf ng">npm install react-table --save</span></pre><p id="9768" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">或者纱线</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="3480" class="nc lq it ld b gy nd ne l nf ng">yarn add react-table</span></pre><ul class=""><li id="cbd1" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">创建一个新组件来渲染React表</strong></li></ul><figure class="lf lg lh li gt ju"><div class="bz fp l di"><div class="nk lk l"/></div></figure><p id="5a74" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如你所知，与旧版本不同，你负责在新版本的React Table中呈现包括标记和样式在内的UI。在上面的渲染代码中，我使用了<code class="fe la lb lc ld b">react-table-6</code>正在使用的精确结构(包括类名和标记)。这将确保没有视觉变化。</p><p id="3b9a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe la lb lc ld b">useTable</code>是构建React表时需要使用的主要钩子。传递给<code class="fe la lb lc ld b">useTable</code>的选项按照提供的顺序被提供给其后的每个插件挂钩，最终产生一个最终的<code class="fe la lb lc ld b">instance</code>对象，您可以用它来构建您的表格UI并与表格的状态进行交互。在上面的组件中，我使用的是<code class="fe la lb lc ld b"><a class="ae kz" href="https://react-table.tanstack.com/docs/api/useFlexLayout" rel="noopener ugc nofollow" target="_blank">flex</a></code> <a class="ae kz" href="https://react-table.tanstack.com/docs/api/useFlexLayout" rel="noopener ugc nofollow" target="_blank"> </a>布局，您可以将其更改为<code class="fe la lb lc ld b"><a class="ae kz" href="https://react-table.tanstack.com/docs/api/useBlockLayout" rel="noopener ugc nofollow" target="_blank">block</a></code>或<code class="fe la lb lc ld b"><a class="ae kz" href="https://react-table.tanstack.com/docs/api/useAbsoluteLayout" rel="noopener ugc nofollow" target="_blank">absolute</a></code>布局。</p><ul class=""><li id="126a" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">改变自定义</strong> <code class="fe la lb lc ld b"><strong class="kd iu">Cell</strong></code> <strong class="kd iu">组件</strong></li></ul><p id="8aa3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在v6中，它看起来是这样的:</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="a8c0" class="nc lq it ld b gy nd ne l nf ng">Cell: row =&gt; &lt;span className='number'&gt;{row.original.value}&lt;/span&gt;</span></pre><p id="8559" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">更改为:</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="98af" class="nc lq it ld b gy nd ne l nf ng">Cell: ({row}) =&gt; &lt;span className='number'&gt;{row.original.value}&lt;/span&gt;<br/>//You need to use the object destructuring for the props</span></pre><ul class=""><li id="2be0" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">使用块布局、灵活布局或绝对布局挂钩</strong></li></ul><p id="16ed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe la lb lc ld b"><a class="ae kz" href="https://react-table.tanstack.com/docs/api/useBlockLayout" rel="noopener ugc nofollow" target="_blank">useBlockLayout</a></code>是一个插件钩子，它增加了对标题和单元格的支持，这些标题和单元格被渲染为带有显式<code class="fe la lb lc ld b">width</code>的<code class="fe la lb lc ld b">inline-block</code> <code class="fe la lb lc ld b">div</code>(或其他非表格元素)。类似于<code class="fe la lb lc ld b">useAbsoluteLayout</code>钩子，如果您需要虚拟化行和单元格以提高性能，这将非常有用。</p><p id="9f86" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe la lb lc ld b"><a class="ae kz" href="https://react-table.tanstack.com/docs/api/useAbsoluteLayout" rel="noopener ugc nofollow" target="_blank">useAbsoluteLayout</a> </code>是一个插件钩子，它增加了对标题和单元格的支持，这些标题和单元格被呈现为具有显式<code class="fe la lb lc ld b">width</code>的绝对定位<code class="fe la lb lc ld b">div</code> s(或其他非表格元素)。类似于<code class="fe la lb lc ld b">useBlockLayout</code>钩子，如果您需要虚拟化行和单元格以提高性能，这将非常有用。</p><p id="c1fe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe la lb lc ld b"><a class="ae kz" href="https://react-table.tanstack.com/docs/api/useFlexLayout" rel="noopener ugc nofollow" target="_blank">useFlexLayout</a></code>是一个插件钩子，增加了对标题和单元格渲染为<code class="fe la lb lc ld b">inline-block</code> <code class="fe la lb lc ld b">div</code>(或其他非表格元素)的支持，其中<code class="fe la lb lc ld b">width</code>用作flex-basis和flex-grow。当实现虚拟化和可调整大小的表时，这个钩子变得很有用，这些表还必须能够扩展以填充所有可用空间。</p><ul class=""><li id="f7ae" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">添加</strong>T4】</li></ul><p id="c771" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这对于添加全局列属性很有用。比如你可以把一列的<code class="fe la lb lc ld b">minWidth</code>加到一定的px宽。请记住，特定于列的属性将覆盖该对象中的属性。如果你在列中定义了<code class="fe la lb lc ld b">minWidth</code>，那将被作为第一选择。</p><ul class=""><li id="9970" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">添加可调整大小的挂钩</strong></li></ul><p id="33dc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe la lb lc ld b"><a class="ae kz" href="https://react-table.tanstack.com/docs/api/useResizeColumns" rel="noopener ugc nofollow" target="_blank">useResizeColumns</a></code>是一个插件钩子，当布局使用非表格元素时，增加了对调整标题和单元格大小的支持，例如<code class="fe la lb lc ld b">useBlockLayout</code>、<code class="fe la lb lc ld b">useAbsoluteLayout</code>和<code class="fe la lb lc ld b">useGridLayout</code>钩子。它甚至支持调整列组的大小。这需要添加样式来显示调整图标大小，这已经在上述组件中完成。</p><ul class=""><li id="d51d" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">添加加载叠加</strong></li></ul><p id="0e48" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果使用API从服务器获取数据，可以显示加载覆盖图，直到在React表中填充完数据。上面的组件包含类似于v6的加载属性、标记和样式。</p><ul class=""><li id="5081" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">改</strong> <code class="fe la lb lc ld b"><strong class="kd iu">getTdProps</strong></code></li></ul><p id="379f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在v6中，它看起来是这样的:</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="c40a" class="nc lq it ld b gy nd ne l nf ng">getTdProps={(state, rowInfo, column, instance) =&gt; {</span><span id="ca99" class="nc lq it ld b gy nl ne l nf ng"> return {</span><span id="9bc4" class="nc lq it ld b gy nl ne l nf ng">  onClick:(e, handleOriginal) =&gt;{<br/>    ...<br/>  }<br/>  ...<br/> }      <br/><br/>}</span></pre><p id="27e2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将此更改为:</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="7855" class="nc lq it ld b gy nd ne l nf ng">getTdProps={({column, row}) =&gt; {<br/>         <br/>   return {<br/>    onClick: (e) =&gt; {<br/>     ...         <br/>    }</span><span id="d7e8" class="nc lq it ld b gy nl ne l nf ng">    ...     <br/>   };<br/>  }<br/>}</span></pre><p id="c0c3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">参数被改变。</p><ul class=""><li id="d10c" class="mn mo it kd b ke kf ki kj km nh kq ni ku nj ky mu mv mw mx bi translated"><strong class="kd iu">展开行(子组件)</strong></li></ul><p id="f7c2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在v6中，如果您添加一个<code class="fe la lb lc ld b">SubComponent</code> props，它将很容易地为所有根级别行添加一个扩展级别。它还为行扩展开关添加了一个单独的列。</p><p id="a819" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在v7中，您需要自己添加列。要做到这一点，您可以在toggler后面追加或前置tog gler。</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="3e1c" class="nc lq it ld b gy nd ne l nf ng">//This will add the expander column at the beginning<br/>columns.unshift({<br/>            Header: () =&gt; null, <br/>            id: 'expander', <br/>            resizable: false,<br/>            className: "text-center",<br/>            Cell: ({ row }) =&gt; (<br/>               <br/>                &lt;div {...row.getToggleRowExpandedProps()} title="Click here to see more information" className="rt-td rt-expandable p-0"&gt;<br/>                    &lt;div className={classnames("rt-expander", row.isExpanded ? "-open": "")}&gt;•&lt;/div&gt;<br/>                &lt;/div&gt;<br/>                <br/>            )<br/>        })</span><span id="7e38" class="nc lq it ld b gy nl ne l nf ng">//You can use push if you want this column at the end</span></pre><p id="64d3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您还需要添加渲染标记或逻辑，即如果行被展开，则显示<code class="fe la lb lc ld b">SubComponent</code>，否则不显示。</p><pre class="lf lg lh li gt my ld mz na aw nb bi"><span id="d1c4" class="nc lq it ld b gy nd ne l nf ng">{ row.isExpanded ? ( SubComponent({ row }) ) : null }</span></pre><p id="58ad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">希望以上步骤能帮助你开始将React Table升级到最新版本7。*.因为这个库有大量的功能，所以还有很多东西需要考虑。如果您在迁移过程中需要帮助，请在下面留言。</p></div></div>    
</body>
</html>