# 对 Array.splice()函数的深入探讨

> 原文：<https://levelup.gitconnected.com/an-in-depth-exploration-of-the-array-splice-function-6b60bb8554c1>

## Javascript 数组方法完全指南

![](img/0b683800084f44a95a965531295b3446.png)

马库斯·斯皮斯克在 [Unsplash](https://unsplash.com/s/photos/javascript?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

在过去的几年中，Javascript `Array`全局对象中增加了各种各样的函数，为开发人员编写使用数组的代码提供了新的令人兴奋的可能性。这些新功能的一个主要优点是，它们为开发人员提供了一组功能，以前他们不得不在遇到每个新代码库时自己实现这些功能。现在，已经不再需要这种自行开发的实现，取而代之的是所有这些新功能。本文将探讨的有用函数之一是`[splice()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice)`函数。

# 功能概述

`splice()`函数提供了改变数组内容的能力，既可以从数组中删除现有的条目，也可以向数组中添加新的条目。函数完成后，从原始数组中删除的任何项都将返回到一个全新的数组中。这个函数不仅产生了一个全新的数组，还修改了调用`splice()`函数的原始数组。

如果您选择使用这个函数，请记住，如果不事先制作一个全新的副本，您将无法维护原始数组。使用`splice()`函数时需要记住的一件非常重要的事情是，如果指定的要从数组中删除的项目数和指定的要添加到数组中的项目数不同，那么一旦函数完成，数组的长度可能会不同。这意味着您的逻辑应该预测数组大小的变化，并能够相应地处理这种情况。

`splice()`功能能够接受无限数量的参数，只有第一个参数*是必需的*，之后的所有参数*是可选的*。第一个参数是`start`参数，它是数组开始改变的索引。根据该参数的指定值，`splice()`功能的工作方式会有所不同。当此参数的值大于数组的长度时，该值将自动设置为数组的长度。在这种情况下，该函数只会将指定的项添加到数组中，而不会从数组中删除任何项。当此参数为负值时，该值将从数组的末尾开始计数，而不是从开始计数。这意味着参数值`-3`实际上会导致值`3`小于数组长度(`Array.length + -3`)。如果参数的负值很大，以至于参数值和数组长度之和为负数，那么`start`参数的值将自动设置为`0`。

第二个参数是`deleteCount`参数，它是一个整数，表示从`start`索引开始应该从数组中删除的项目数。因为它是第一个可选参数，所以可以在任何`splice()`函数调用中省略这个值。这样做将导致从`start`索引到数组末尾的所有项目被删除。如果参数值大于从`start`索引到数组末尾的项目数，也会出现这种情况。当该参数为负值或值为`0`时，不会从数组中删除任何项目。

从第三个参数开始的其余参数被命名为`item1`、`item2`，依此类推，直到`itemN`。这些参数是从`start`索引开始添加到数组中的所有项目。如果没有指定项目，那么项目将只从数组中删除。

# 正开始，正删除计数

在介绍了一般的函数行为之后，让我们来看一些例子，看看`splice()`函数在实践中是如何工作的。以下示例演示了指定正的`start`和`deleteCount`参数值的情况:

```
var array = ['abc', **'def', 'ghi'**, 'jkl', 'mno'];
var deletedItems = array.splice(1, 2);
// array: ['abc', 'jkl', 'mno']
// deletedItems: [**'def', 'ghi'**]
```

使用`1`的`start`参数值和`2`的`deleteCount`参数值调用`splice()`函数。因此，从原始数组中删除并返回到`deletedItems`数组中的项目是从索引`1`开始的两个项目。原始数组仍然包含未指定删除的三个项目，并且数组的长度已经减少了`2`。

# 负开始，正删除计数

以下示例演示了指定负`start`参数值和正`deleteCount`参数值的情况:

```
var array = ['abc', 'def', **'ghi', 'jkl'**, 'mno'];
var deletedItems = array.splice(-3, 2);
// array: ['abc', 'def', 'mno']
// deletedItems: [**'ghi', 'jkl'**]
```

使用参数值为`-3`的`start`和参数值为`2`的`deleteCount`调用`splice()`函数。考虑如何计算负的`start`参数值，该函数调用与`splice(2, 2)`相同。因此，从原始数组中删除并返回到`deletedItems`数组中的项目是从索引`2`开始的两个项目。原始数组仍然包含未指定删除的三个项目，并且数组的长度已经减少了`2`。

# 正开始，无删除计数

以下示例演示了仅指定正`start`参数值的情况:

```
var array = ['abc', 'def', **'ghi', 'jkl', 'mno'**];
var deletedItems = array.splice(2);
// array: ['abc', 'def']
// deletedItems: [**'ghi', 'jkl', 'mno'**]
```

使用`2`的`start`参数值调用`splice()`函数。考虑到如何计算一个省略的`deleteCount`参数值，从索引`2`开始一直到数组末尾的原始数组中的所有项都被删除并返回到`deletedItems`数组中。原始数组仍然包含未指定删除的两个项目，在这种情况下，数组的长度已经减少了`3`。

# 正开始，零删除计数

以下示例演示了指定正的`start`参数值和`0`的`deleteCount`参数值的情况:

```
var array = ['abc', 'def', 'ghi', 'jkl', 'mno'];
var deletedItems = array.splice(2, 0);
// array: ['abc', 'def', 'ghi', 'jkl', 'mno']
// deletedItems: []
```

使用参数值为`2`的`start`和参数值为`0`的`deleteCount`调用`splice()`函数。根据函数在指定了`0`的`deleteCount`参数值时的行为，不会从原始数组中删除任何项目，也不会在`deletedItems`数组中返回任何项目。原始数组仍然包含它的所有原始项，并且数组的长度没有改变。

# 正开始，零删除计数，单个项目

以下示例演示了指定正`start`参数值、`0`的`deleteCount`参数值和单个`itemN`参数值的情况:

```
var array = ['abc', 'def', 'ghi', 'jkl', 'mno'];
var deletedItems = array.splice(2, 0, *'pqr'*);
// array: ['abc', 'def', *'pqr'*, 'ghi', 'jkl', 'mno']
// deletedItems: []
```

调用`splice()`函数时有一个`start`参数值`2`，一个`deleteCount`参数值`0`，以及一个要添加到数组中的单个项目。根据函数在指定了`0`的`deleteCount`参数值时的行为，不会从原始数组中删除任何项目，也不会在`deletedItems`数组中返回任何项目。相反，指定的单个项目被添加到索引`2`，并且数组的长度增加了`1`。

# 正开始、正删除计数、多个项目

以下示例演示了指定正`start`和`deleteCount`参数值和多个`itemN`参数值的情况:

```
var array = ['abc', **'def', 'ghi'**, 'jkl', 'mno'];
var deletedItems = array.splice(1, 2, *'pqr'*, *'stu'*, *'vwx'*);
// array: ['abc', *'pqr'*, *'stu'*, *'vwx'*, 'jkl', 'mno']
// deletedItems: [**'def', 'ghi'**]
```

调用`splice()`函数时使用了一个`start`参数值`1`，一个`deleteCount`参数值`2`，以及三个要添加到数组中的项目。结果，索引`1`和`2`处的两个项目被删除并返回到`deletedItems`数组中。此外，从索引`1`开始，三个指定的项目被添加到原始数组中，并且数组的长度增加了`1`。

# 经验教训

关于`splice()`函数，从这篇文章中得到的最重要的教训是它如何在一个小的包中提供多种类型的功能。使用该函数，同时提供一个`0`的`deleteCount`参数值和一个或多个要添加到调用该函数的数组中的项目，将该函数变成一个纯粹的*加法*函数。使用该函数，同时提供一个正的`deleteCount`参数值，并且不向调用该函数的数组添加任何项目，这将使该函数变成一个纯粹的*减法*函数。使用该函数，同时提供一个正的`deleteCount`参数值和一个匹配的项目数，以添加到调用该函数的数组中，从而将该函数变成一个纯*替换*函数。

最后，如上面`splice()`函数用法的几个例子所示，函数可以同时是这三个，这取决于为每个函数参数指定的值。通过充当加法函数、减法函数和替换函数，`splice()`函数实际上提供了与添加到 Javascript `Array`全局对象中的许多其他函数相同的功能。

作为附加和替换功能，`splice()`功能实现了与`concat()`、`push()`和`unshift()`功能相同的功能。`concat()`函数允许你添加任意数量的单个数组项和整个数组的内容到数组的末尾，而`splice()`函数允许你添加任意数量的单个数组项到数组的开头或末尾。

这里明显的区别是，`splice()`函数需要单独指定所有新的数组项，而`concat()`函数可以混合使用单个数组项和整个数组。类似地，`unshift()`函数允许您将任意数量的单个数组项添加到数组的*开头的*中，而`push()`函数允许您将任意数量的单个数组项添加到数组的*结尾的*中，所有操作都按照指定的顺序进行。`splice()`函数以完全相同的方式提供了这两种行为。

作为减法功能，`splice()`功能实现了与`pop()`和`shift()`功能相同的功能。`shift()`函数允许您从数组的*开始的*中移除一个项目，并在函数完成时返回该项目。`splice()`函数允许您从一个数组的开头移除任意数量的项，直到并包括数组的总长度，并在函数完成时将这些项返回到一个全新的数组中。从这个意义上来说，`splice()`功能相当于面向单个项目的`shift()`功能的多项目版本。`pop()`函数允许您从数组的*端*移除一个项目，并在函数完成时返回该项目。`splice()`函数允许你从一个数组的末尾移除任意数量的项，直到并包括数组的总长度，并在函数完成时将这些项返回到一个全新的数组中。从这个意义上说，`splice()`函数充当了面向单个项目的`pop()`函数的多项目版本。

在本节描述的所有方法中，`splice()`函数基本上相当于一把瑞士军刀，在您发现自己需要一次对一个数组执行多个操作的情况下最有用。您可以在一次函数调用中添加新项、替换现有项以及从数组中移除项，而不是进行多次函数调用，可能需要使用一些循环逻辑来确保所有正确的项都受到影响。`splice()`函数将您从所有这些麻烦中解救出来，并清理您的代码，使其不仅更简洁，而且可读性更好。

# 结论

非常感谢您阅读这篇文章。我希望这次对 Javascript `Array`全局对象上的`splice()`函数的探索能够提供一些信息，并且我希望在获得一些关于它的知识之后，你能够在你自己的代码中很好地使用它。如果您对`splice()`功能的工作方式还有其他问题，我鼓励您参考下面的资源链接，以获得所有与该功能相关的信息。请在将来停下来阅读更多关于 Javascript `Array`全局对象上有趣且有用的函数的文章。

# 资源

[Javascript Array.splice()函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice)