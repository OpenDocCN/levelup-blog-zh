<html>
<head>
<title>My team’s code review guidelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的团队的代码审查指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/my-teams-code-review-guidelines-c5db5d95ae1b?source=collection_archive---------0-----------------------#2021-12-04">https://levelup.gitconnected.com/my-teams-code-review-guidelines-c5db5d95ae1b?source=collection_archive---------0-----------------------#2021-12-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq"><p id="7dda" class="jr js it bd jt ju jv jw jx jy jz ka dk translated">你必须愿意阅读别人的代码，然后写你自己的代码，然后让别人审查你的代码。</p><p id="e2ab" class="jr js it bd jt ju kb kc kd ke kf ka dk translated">—比尔·盖茨</p></blockquote><p id="9afc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ka im bi translated">在我们的团队中，对主分支的每个提交都必须经过拉请求(PR)。而且每一份PR都要经过同行的审核和批准(至少其中一人)。这篇文章包含了我们遵循的代码审查指南。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/dc5b8f70a635029d657cede772f3ff09.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/1*b4XA47YitexiIoqirViN7Q.gif"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">我们的代码审查指南</figcaption></figure><h1 id="065c" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">什么是代码审查？</h1><p id="0441" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">它是关于你的同事审查和同意你的代码，这些代码是有目的的，不会给使用你的系统的用户带来任何问题，有公认的标准和最佳实践。</p><h1 id="83c1" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">公关应该包括哪些内容？</h1><h1 id="324e" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">功能或目的</h1><p id="20dd" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">提交的每份PRs都必须涵盖特定的功能或有意完成，例如修复bug、偿还技术债务、实现某项功能等。参考JIRA机票是必须的，以便审查人员可以参考它进行审查。</p><h1 id="f79d" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">试验</h1><p id="38cb" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">对于推送的新代码块，应该提供足够的测试。建议对新代码块进行100%的测试覆盖(最低:80% —如果需要，可以在SonarQube中指定从测试覆盖中排除的内容)。</p><p id="6da2" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated"><strong class="ki iu">测试应该是高质量的</strong>确保所有的代码路径和边缘案例都被覆盖。如果有的话，潜在的未来错误应该通过这些测试来识别。</p><h1 id="69e8" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">小重构</h1><p id="2ee1" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated"><strong class="ki iu">小的重构或改进可以作为PRs的一部分来完成</strong>。但是要确保它被恰当地传达，并且为评审者设置了关于要评审的内容的期望。如果是重大的重构，包含的改动太多，还是单独做一个PR比较好。</p><h1 id="7ea6" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">要复习哪些方面？</h1><p id="d431" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated"><strong class="ki iu">PR中的每一行都要审核</strong>。但是也有一些例外。如果你被邀请以专家的身份回顾某些部分的变化，你可以彻底地回顾那个特定的部分，给它一个“好的开始”。</p><h1 id="19b0" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">编码标准和最佳实践</h1><p id="7422" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">坚持我们的编码标准和最佳实践:<a class="ae mx" href="https://ananthanarayanan-r.medium.com/my-teams-coding-standards-and-best-practices-2c5c2838d5f6" rel="noopener">https://ananthanarayanan-r . medium . com/my-teams-coding-standards-and-best-practices-2c 5 c 2838 D5 F6</a>提交采购申请时需要</p><h1 id="fc3a" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">架构和系统设计</h1><p id="bf9b" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">在审查拉取请求时，应记住整体架构和系统设计。不应该损害可伸缩性、可用性等主要体系结构特征</p><h1 id="fb96" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">功能</h1><p id="6a63" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">应该满足预期的功能。如果不是这样，可以在回顾中分享。</p><h1 id="8872" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">数据库查询</h1><p id="7881" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">数据库查询应该易于理解，优化和不消耗太多的CPU资源。数据库通常是一种关键资源，所以要小心处理。</p><h1 id="4ee1" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">迭代次数</h1><p id="9ba3" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">太多的迭代或无限循环会产生内存或cpu问题。尽可能少做迭代。</p><h1 id="a63c" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">设计模式的使用</h1><p id="e5da" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">所使用的设计模式，对于手头的问题是正确的吗？有时候，一个完整的设计模式可能看起来过于工程化。为适当的场景使用适当的设计模式</p><h1 id="e35e" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">可维护性</h1><p id="09d0" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">将被推向生产的代码应该是可维护的，并且在将来易于重构。</p><h1 id="c0f6" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">质量测试</h1><p id="ee15" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">应该提供足够的单元测试和高质量的单元测试</p><h1 id="a9c7" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">命名</h1><p id="8a6a" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">命名不应该被低估。命名对于理解代码是至关重要的，未来的开发人员会感谢您使用了合适的命名。</p><h1 id="3892" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">复杂性</h1><p id="9f67" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">固有的复杂性在某些情况下是不可避免的，但是新代码中不应该引入意外的复杂性</p><h1 id="df4e" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">代码审查的速度</h1><p id="defc" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">执行代码评审的速度对于整个团队的交付度量是至关重要的。各种变化，如错误修复、新功能和重构，都有不同的速度要求。</p><p id="286c" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated">一般来说，一旦被请求(在几个小时之内)，代码审查就会被期望完成<strong class="ki iu">。但是第一套代码评审至少要在一天之内</strong>移交<strong class="ki iu">。同一PR的后续审查预计会以更快的速度完成，因为它的一些部分已经过审查，只有新的更改符合要求。</strong></p><p id="e520" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated">如果每个人都审查其他人的PRs，会进一步阻碍代码审查速度。我们可以确保一个公关是由1或2个审查平均审查。一次。</p><p id="b0da" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated">Bug修复/hot fix是最高优先级，应该尽快审查。</p><h1 id="9c40" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">PR大小</h1><p id="9a62" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">PR大小不要太大。这使得审稿人的生活变得困难，因为在一份庞大的公关中，仔细检查每一个变化都很麻烦。在这种情况下，审查的质量和完成审查所花的时间都不会很好，这将导致很长的PR交付时间，并使其成为长期的PR交付时间(将永远处于审查中)。</p><p id="e332" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated">可以做以下事情来保持PR小而集中:</p><ul class=""><li id="5d69" class="my mz it ki b kj ms kn mt kr na kv nb kz nc ka nd ne nf ng bi translated">不要在一个PR中偷偷加入不相关的变化</li><li id="f53f" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ka nd ne nf ng bi translated">将一个大的任务/用户故事分解成子任务，并通过小的和可管理的PRs增量地交付它们</li><li id="c129" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ka nd ne nf ng bi translated">不要缩短测试来弥补大的PRs。取而代之的是分割功能，并通过测试来交付它们</li></ul><h1 id="f064" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">通信/文件</h1><p id="ea41" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">为了使审阅者的生活更容易，添加关于PR的足够信息。如果有重大变更或添加适当的PR描述，则需要一份文档来支持您的PR,这将极大地帮助审阅者更好地理解上下文。</p><h1 id="6efc" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">冗长的讨论</h1><p id="d49e" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">冗长的讨论不会给我们带来任何好处。有时这可能是谁对谁错的问题。这不是关于有问题的个人，而是被审查的代码。确保你们<strong class="ki iu">进行一对一的讨论，以解决建议中的任何冲突</strong>,如果时间太长，请中间人来解决问题。</p><h1 id="5486" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">处理公关建议</h1><p id="c38d" class="pw-post-body-paragraph kg kh it ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ka im bi translated">建议审核人<strong class="ki iu">优先</strong>验证建议。例如，如果建议的优先级较低，则可以添加前缀“较低”。作者可以根据自己的意见决定是否解决这个问题。<strong class="ki iu">并不是每一个公关建议都要由作者来处理</strong>。有时候，我们不得不采用不同的方法来解决同一个问题。</p><p id="b1d6" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated">“阻止者”的建议必须由作者来处理，因为它可能成为对代码库的真正威胁。在这种情况下，使用Github中的“请求更改”功能。</p><h1 id="5483" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">PR评论怎么写？</h1><ul class=""><li id="399b" class="my mz it ki b kj mn kn mo kr nm kv nn kz no ka nd ne nf ng bi translated"><strong class="ki iu"><em class="np"/></strong>——以问题的形式写评论听起来很有礼貌，并给作者思考的空间</li><li id="d876" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ka nd ne nf ng bi translated"><strong class="ki iu"> <em class="np">平衡黑白细节和模糊</em> </strong>。不要太详细，同时也不要太模糊。努力解释你的建议并添加一些参考资料可能会帮助作者</li><li id="a8f1" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ka nd ne nf ng bi translated"><strong class="ki iu"> <em class="np">以建设性的方式分享评论</em> </strong>这有助于作者改善代码健康状况，而不是抨击它们</li><li id="89f3" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ka nd ne nf ng bi translated"><strong class="ki iu"> <em class="np">不要忘了欣赏</em> </strong>的一些好作品</li></ul><h1 id="b884" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">参考</h1><ul class=""><li id="64f5" class="my mz it ki b kj mn kn mo kr nm kv nn kz no ka nd ne nf ng bi translated">https://google.github.io/eng-practices/review/reviewer/——谷歌的代码审查标准是关于如何进行代码审查的极好参考。我们的代码审查指南与他们的有惊人的相似之处。</li></ul></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="e065" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated">暂时就这样了。一个月前，我写了另一篇文章来掌握代码审查技术。如果你喜欢这篇文章，你也会喜欢那篇文章。请阅读并告诉我您的想法:<a class="ae mx" href="https://ananthanarayanan-r.medium.com/mastering-the-art-of-code-review-1eaf3a8f5577" rel="noopener">https://ananthanarayanan-r . medium . com/mastering-the-art-of-code-review-1 EAF 3a 8 f 5577</a></p><p id="f380" class="pw-post-body-paragraph kg kh it ki b kj ms kl km kn mt kp kq kr mu kt ku kv mv kx ky kz mw lb lc ka im bi translated">你对我们的代码审查指南有什么看法，什么是最重要的，你的团队应该遵循什么？—很想知道你的想法。</p></div></div>    
</body>
</html>