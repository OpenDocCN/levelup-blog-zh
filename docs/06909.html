<html>
<head>
<title>Writing Code in Assembly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在程序集中编写代码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/writing-code-in-assembly-7898a3492561?source=collection_archive---------29-----------------------#2021-01-11">https://levelup.gitconnected.com/writing-code-in-assembly-7898a3492561?source=collection_archive---------29-----------------------#2021-01-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6ebce7694a9cb0a19d5194db482b3e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*--BzVG-5rImiNE15.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">大声喊出来到维基百科了解早期计算的所有细节</figcaption></figure><p id="246f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，我的每周媒体文章中的几乎所有代码都是用JavaScript编写的。这有几个原因——在我的训练营中，JavaScript是函数式编程的主要语言，所以我每天都很熟悉它。另一个同样重要的原因是，Google的DevTools使得在浏览器中运行JavaScript代码变得非常容易。我经常创建函数和变量，并在将代码片段粘贴到我的文章之前测试我的代码。</p><p id="b0b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个原因是，坦率地说，JavaScript是一种非常简单的语言。这可能是最简单的OOP语言了。这些命令是自描述的。处理数据非常容易，因为您不必声明变量的数据类型(不像C、C++和其他语言)，并且您可以轻松地操作数组和对象，而不必调用可怕的(至少对于像我这样的非CS专业的笨蛋来说)指针。这使得它成为编写训练营代码的理想语言；一个没有编码知识的人，在几个小时的教程后，可以编写带有循环、条件语句、映射…的函数，这些函数真的能做事情！用JavaScript(或者Python、Ruby、R……)编程并不需要什么天赋。</p><p id="b8a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于低级汇编语言来说就不一样了。老实说，我认为你必须是某种天才才能用汇编语言编程。</p><p id="3a76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据维基百科…</p><blockquote class="lb lc ld"><p id="2879" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated"><a class="ae kc" href="https://en.wikipedia.org/wiki/Kathleen_Booth" rel="noopener ugc nofollow" target="_blank">凯瑟琳·布斯</a>“被认为发明了汇编语言”基于她1947年开始的理论工作，当时她在伦敦大学<a class="ae kc" href="https://en.wikipedia.org/wiki/Birkbeck,_University_of_London" rel="noopener ugc nofollow" target="_blank">伯克贝克</a>从事<a class="ae kc" href="https://en.wikipedia.org/wiki/APEXC" rel="noopener ugc nofollow" target="_blank"> ARC2 </a>的研究，咨询了<a class="ae kc" href="https://en.wikipedia.org/wiki/Andrew_Donald_Booth" rel="noopener ugc nofollow" target="_blank">安德鲁·布斯</a>(后来她的丈夫)和<a class="ae kc" href="https://en.wikipedia.org/wiki/John_von_Neumann" rel="noopener ugc nofollow" target="_blank">高级研究所</a>的数学家约翰·冯·诺依曼<a class="ae kc" href="https://en.wikipedia.org/wiki/Herman_Goldstine" rel="noopener ugc nofollow" target="_blank">和物理学家</a>赫尔曼·戈德斯汀。</p></blockquote><p id="f158" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，约翰·冯·诺依曼，世界历史上最杰出的人的热门候选人——也就是真正的天才。当强尼五世牵涉其中时，你知道你在处理一些令人兴奋的事情！</p><p id="6e1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个20世纪70年代中期摩托罗拉6800微处理器使用的<a class="ae kc" href="https://en.wikipedia.org/wiki/Motorola_6800" rel="noopener ugc nofollow" target="_blank">装配示例</a>:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="b597" class="lr ls iq ln b gy lt lu l lv lw"><em class="le">; memcpy --</em><br/><em class="le">; Copy a block of memory from one location to another.</em><br/><em class="le">; Called as a subroutine, note return to saved PC addr on exit</em><br/><em class="le">; Entry parameters</em><br/><em class="le">;      cnt - Number of bytes to copy</em><br/><em class="le">;      src - Address of source data block</em><br/><em class="le">;      dst - Address of target data block</em><br/><br/>cnt         dw      $0000       <em class="le">; sets aside space for memory addr</em><br/>src         dw      $0000       <em class="le">; sets aside space for memory addr</em><br/>dst         dw      $0000       <em class="le">; sets aside space for memory addr</em><br/><br/>memcpy      public<br/>            ldab    cnt+1       <em class="le">;Set B = cnt.L</em><br/>            <strong class="ln ir">beq</strong>     check       <em class="le">;If cnt.L=0, goto check</em><br/>loop        <strong class="ln ir">ldx</strong>     src         <em class="le">;Set IX = src</em><br/>            <strong class="ln ir">lda</strong>     ix          <em class="le">;Load A from (src)</em><br/>            <strong class="ln ir">inx</strong>                 <em class="le">;Set src = src+1</em><br/>            <strong class="ln ir">stx</strong>     src<br/>            <strong class="ln ir">ldx</strong>     dst         <em class="le">;Set IX = dst</em><br/>            <strong class="ln ir">sta</strong>     ix          <em class="le">;Store A to (dst)</em><br/>            <strong class="ln ir">inx</strong>                 <em class="le">;Set dst = dst+1</em><br/>            <strong class="ln ir">stx</strong>     dst<br/>            decb                <em class="le">;Decr B</em><br/>            <strong class="ln ir">bne</strong>     loop        <em class="le">;Repeat the loop</em><br/>            stab    cnt+1       <em class="le">;Set cnt.L = 0</em><br/>check       tst     cnt+0       <em class="le">;If cnt.H=0,</em><br/>            <strong class="ln ir">beq</strong>     done        <em class="le">;Then quit</em><br/>            <strong class="ln ir">dec</strong>     cnt+0       <em class="le">;Decr cnt.H</em><br/>            <em class="le">; loop back and do 256*(cnt.H+1) more copies (B=0) </em><br/>            bra     loop        <em class="le">;Repeat the loop</em><br/>done        <strong class="ln ir">rts</strong>                 <em class="le">;Return</em></span></pre><p id="437d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">显然，这个子程序把一块内存从一个地方转移到另一个地方。如果没有这些有用的评论，我会猜测这是百万只猴子和它们的百万台打字机中的一只试图重现莎士比亚的作品。如果我用JavaScript重新创建它，它可能看起来像这样…提前为不可理解性道歉，但是我自己几乎不能理解这个代码！</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="d683" class="lr ls iq ln b gy lt lu l lv lw">function memcpy(cnt, src, dst) {<br/>    let B = cnt.L;<br/>    while (true) {<br/>        let ix = src;<br/>        src++;<br/>        ix = dst;<br/>        A = dst;<br/>        dst++;<br/>        B--;<br/>        if (cnt.L===0) {<br/>            if (cnt.H===0) return;<br/>            cnt.H--;<br/>        }<br/>    }<br/>    return;<br/>}</span></pre><p id="0575" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">显然，这个循环执行了256*(cnt。H+1)次。256 = 2⁸ =一个字节可能值的个数，对吗？谁知道呢。</p><p id="9ed9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然这个例子完全不连贯，但这里还有一个汇编代码的例子，比较容易理解，它的输出(字符串“Hello，world！”)要明智得多。感谢TutorialsPoint.com的<a class="ae kc" href="https://www.tutorialspoint.com/compile_assembly_online.php" rel="noopener ugc nofollow" target="_blank">片段</a>:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="8684" class="lr ls iq ln b gy lt lu l lv lw">section .text<br/> global _start       ;must be declared for using gcc<br/>_start:                     ;tell linker entry point<br/> mov edx, len    ;message length<br/> mov ecx, msg    ;message to write<br/> mov ebx, 1     ;file descriptor (stdout)<br/> mov eax, 4     ;system call number (sys_write)<br/> int 0x80        ;call kernel<br/> mov eax, 1     ;system call number (sys_exit)<br/> int 0x80        ;call kernel</span><span id="9945" class="lr ls iq ln b gy lx lu l lv lw">section .data</span><span id="9033" class="lr ls iq ln b gy lx lu l lv lw">msg db 'Hello, world!',0xa ;our dear string<br/>len equ $ - msg   ;length of our dear string</span></pre><p id="fc78" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以基本上，程序接受消息的长度(len)、消息本身(msg)、几个“系统调用号”,然后循环并打印消息的每个字符，循环的长度等于消息的长度，如len所指定的。</p><h2 id="039c" class="lr ls iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">结论</h2><p id="6620" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我希望您喜欢这次简短的汇编编程尝试。与低级语言一样，这些关键字远不如高级语言直观。尽管你可以浏览一下JS、C++、Java或Python代码片段，或多或少地了解正在发生的事情，但是汇编语言即使是逐行注释也完全令人困惑。感谢所有杰出的数学家、物理学家和计算机科学家，这些年来，他们让编程变得更加容易理解和用户友好。为天才们干杯！</p><p id="3110" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">附注<a class="ae kc" href="https://www.madwizard.org/programming/snippets" rel="noopener ugc nofollow" target="_blank">这里有</a>一个非常好的更具挑战性的汇编代码库。警告程序设计员！</p></div></div>    
</body>
</html>