<html>
<head>
<title>Lesser-Known Ways to Build Advanced Flutter Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建高级Flutter应用的鲜为人知的方法</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/lesser-known-ways-to-build-advanced-flutter-apps-74d2af638e2?source=collection_archive---------2-----------------------#2022-09-18">https://levelup.gitconnected.com/lesser-known-ways-to-build-advanced-flutter-apps-74d2af638e2?source=collection_archive---------2-----------------------#2022-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b4cc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让Flutter超越Dart生态系统</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/29d76a6364f7039f03ac69ffd0b26daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-4ZAo6pVVJ70GVitRe0uPA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@jefflssantos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰佛森·桑多斯</a>在<a class="ae ky" href="https://unsplash.com/s/photos/programming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片，由Canva编辑</figcaption></figure><p id="c59b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，Flutter和React Native成为应用程序开发行业最推荐的构建跨平台移动应用程序的方法。喜欢JavaScript、React和特定于平台的UI元素的开发团队选择React Native。同时，喜欢Dart和Material UI元素的开发者倾向于使用Flutter。两种框架各有利弊，但Flutter由于其令人印象深刻的性能优先的架构基础，无疑在性能因素上表现更好。</p><p id="c1bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数开发人员通常以同样的方式使用Flutter。他们搭建应用程序，使用内置的小部件和Dart APIs，并生成特定于平台的二进制文件或web应用程序包(通过Flutter web)。此外，他们倾向于使用Flutter插件来加快应用程序开发过程。</p><p id="97b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Flutter提供了一种使用平台无关的Dart语言开发高性能跨平台应用程序的简单方法，但它保持了其架构的灵活性，以访问平台相关的代码。因此，我们可以超越Dart生态系统，整合各种模块来构建高级Flutter应用程序。在这个故事中，我将解释超越Dart层开发Flutter应用程序的几种鲜为人知的方法。这些方法可以帮助您重用现有代码，加快开发时间，并为独特的用例提供令人印象深刻的架构解决方案。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f7f0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从Dart调用特定于平台的本机代码</h1><p id="880a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Flutter框架是用Dart编写的，但是它不能在操作系统上单独运行，因为操作系统本身不支持Dart。因此，Flutter团队创建了特定于平台的Flutter引擎模块，以在所有支持的操作系统上托管基于Dart的应用程序。Flutter引擎实现了在每个平台上运行Flutter应用程序所需的运行时。另一方面，Flutter CLI支持使用Flutter引擎的特定于平台的主机应用程序(嵌入式应用程序)。您可以在应用程序目录中看到这些动态生成的主机应用程序源:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/ddbe28660b1f7ed89fce3d88d2e1f39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*ChWWDlAYZE6QfWNboG8JzA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">android、ios、linux等。目录包含主机app源码，作者截图。</figcaption></figure><p id="3d09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">毫无疑问，我们可以使用特定于平台的Flutter引擎API来修改这些主机应用程序源。可以在每个主机应用程序上使用<a class="ae ky" href="https://docs.flutter.dev/development/platform-integration/platform-channels" rel="noopener ugc nofollow" target="_blank">平台通道API </a>从Dart端调用特定于平台的语言。例如，您可以使用Android平台通道API从Dart调用Java/Kotlin，因此在Flutter中使用已经开发的Java包很容易。</p><p id="64e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我修改了Flutter演示应用程序，并在下面的项目中从Java <code class="fe na nb nc nd b">Random</code>类生成了一个随机数:</p><div class="ne nf gp gr ng nh"><a href="https://github.com/codezri/flutter-call-java-example" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">GitHub-codez ri/flutter-call-java-示例:在Flutter中从Dart代码调用Java代码</h2><div class="no l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu ks nh"/></div></div></a></div><p id="8af0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，你可以在Linux、iOS、macOS、Windows和<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/will-flutter-and-fushia-replace-your-favourite-operating-system-2653384b186f"> Fuchsia </a>上调用原生平台特定代码。这种开发方法是重用现有的特定于平台的代码或调用原生SDK的更好方法。Flutter插件使用平台通道调用原生SDK。检查<a class="ae ky" href="https://github.com/rodydavis/flutter_vibrate" rel="noopener ugc nofollow" target="_blank"> flutter_vibrate </a>包源代码，查看最小插件实现。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="20f0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在Flutter应用中嵌入Go/Python模块</h1><p id="21c5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">早些时候，我们从Dart中学习了如何调用原生平台特定的代码，那么如果有一种方法可以在原生应用程序中嵌入其他编程语言运行时呢？<a class="ae ky" href="https://github.com/golang/mobile" rel="noopener ugc nofollow" target="_blank"> Go mobile </a>项目让开发者在Android和iOS应用中嵌入Go，在移动设备上运行Go模块。因此，我们可以使用Go mobile从特定于平台的本地语言调用Go代码，并通过Flutter平台通道从Dart调用特定于平台的代码。因此，我们可以从Dart调用Go代码。</p><p id="c093" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数开发人员选择Go构建web服务是因为它的性能、简单性和受欢迎程度。Flutter也有同样的竞争因素，所以现在大多数开发者倾向于使用Flutter。现在，他们有了一种节省时间的方法，直接在Flutter中使用基于Go的后端模块，而不是从头开始在Dart中重写。</p><p id="a369" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我修改了Flutter演示应用程序，并在下面的项目中通过Go的<code class="fe na nb nc nd b">math/rand</code>包生成了一个随机数:</p><div class="ne nf gp gr ng nh"><a href="https://github.com/codezri/flutter-gomobile" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">GitHub-codez ri/flutter-gomobile:在Flutter中使用Go模块</h2><div class="nv l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">这个样例Flutter应用程序通过Flutter平台通道调用一个用Go编写的函数，并使用Go mobile bind。已实施…</h3></div><div class="no l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="np l"><div class="nw l nr ns nt np nu ks nh"/></div></div></a></div><p id="26c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于Android，Go mobile生成了一个包含CPU专用共享库的<a class="ae ky" href="https://developer.android.com/studio/projects/android-library" rel="noopener ugc nofollow" target="_blank"> Android库</a>。您可以使用以下Go mobile命令生成Android库:</p><pre class="kj kk kl km gt nx nd ny nz aw oa bi"><span id="f0bc" class="ob md it nd b gy oc od l oe of">gomobile bind --target android</span></pre><p id="7d45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的命令从您的Go模块源生成一个<code class="fe na nb nc nd b">aar</code>文件(一个Android库文件)。另一方面，我们可以在Android项目中使用它作为依赖包:</p><pre class="kj kk kl km gt nx nd ny nz aw oa bi"><span id="57bc" class="ob md it nd b gy oc od l oe of">// app/build.gradle</span><span id="c632" class="ob md it nd b gy og od l oe of">repositories{<br/>    flatDir{<br/>         dirs 'src/main/libs'<br/>    }<br/>}</span><span id="79c4" class="ob md it nd b gy og od l oe of">dependencies {<br/>  api(name:'gomobilelib', ext:'aar')<br/>}</span></pre><p id="699d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Kivy 框架也提供了一种类似的在移动应用上嵌入Python的方法，所以从Dart调用Python代码也是可能的。<a class="ae ky" href="https://github.com/kivy/python-for-android" rel="noopener ugc nofollow" target="_blank"> python-for-android </a>项目让你用python模块生成apk。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1b4e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在Flutter应用中使用特定于平台的原生UI元素</h1><p id="31de" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">正如我们已经知道的，Flutter提供了自己的widgets工具包，它使用<a class="ae ky" href="https://github.com/google/skia" rel="noopener ugc nofollow" target="_blank"> Skia </a>作为底层图形库。因此，当你在移动应用程序中显示内置的Flutter小工具时，Flutter不会呈现原生的Android或iOS元素。因此，您可以在所有支持的操作系统上设计相同的外观。使用相同的外观和感觉对于构建现代的跨平台应用程序来说是非常好的，但是用户通常希望应用程序具有操作系统的设计概念。因此，Flutter为iOS提供了库比蒂诺风格的小工具。</p><p id="6c11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，在某些场景中，我们需要依赖于平台的真正的原生GUI元素，而不是呈现人工风格的独立于平台的UI元素。例如，如果我们可以使用官方平台特定的Google Maps SDK或Webview，而不是用Dart从头实现一个专用元素，这确实很棒。</p><p id="1766" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看下面这个项目。在这里，我在一个典型的Flutter应用程序中呈现了一个原生的Android文本输入，以及一个Flutter文本字段小部件:</p><div class="ne nf gp gr ng nh"><a href="https://github.com/codezri/flutter-platform-views-example" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">GitHub-codez ri/flutter-platform-views-example:学习使用Android特有的原生UI元素…</h2><div class="no l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="np l"><div class="oh l nr ns nt np nu ks nh"/></div></div></a></div><p id="6814" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们在Android设备上运行上述项目，您将在同一个应用程序视图中看到Android EditText元素和Flutter TextField小部件，如以下预览所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/657c402253d14aa17b8935fad064611a.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*Nl6fWSZ0y6sDqu2Vbf4rIA.gif"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在Flutter应用中使用Android EditText和Flutter TextField，作者截图</figcaption></figure><p id="0f8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果Flutter等价物不可用或者基于Dart的重写非常耗时，这种方法是直接使用预实现的特定于平台的复杂元素的好方法。官方文档解释说平台视图伴随着<a class="ae ky" href="https://docs.flutter.dev/development/platform-integration/ios/platform-views#performance" rel="noopener ugc nofollow" target="_blank">性能权衡</a>，所以首先检查一个本地颤振等价。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="59ff" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">用Flutter开发混合应用</h1><p id="ffac" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如今，大多数企业投资于混合移动应用程序开发，因为项目交付速度快，开发成本低，并且有可能实现基于web的平台集成。大多数基于网络应用的公司将他们现有的网络应用转化为带有Cordova或类似电容器框架的移动应用。</p><p id="d203" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于web资源解析/加载缓慢，与完全原生的、基于Flutter的或基于Kivy的应用程序相比，混合应用程序确实有更多的性能权衡。但是，现代高端设备可以隐藏这些性能问题，并向用户提供类似本机的应用程序。几年前，我写了下面的故事来解释这种情况:</p><div class="ne nf gp gr ng nh"><a href="https://shalithasuranga.medium.com/goodbye-native-apps-2ffcbd2773e7" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">再见，本地应用</h2><div class="nv l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">混合应用正在取代在低端和高端电脑上都能流畅运行的原生应用。</h3></div><div class="no l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">shalithasuranga.medium.com</p></div></div><div class="np l"><div class="oj l nr ns nt np nu ks nh"/></div></div></a></div><p id="866f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">官方的<a class="ae ky" href="https://pub.dev/packages/webview_flutter" rel="noopener ugc nofollow" target="_blank"> webview_flutter </a>插件允许你通过平台视图功能将原生webviews添加到你的flutter应用程序中——这样你就可以在Flutter中创建混合应用程序。此外，使用webview_flutter软件包，您可以在创纪录的时间内将现有的web应用程序转变为混合移动应用程序:</p><pre class="kj kk kl km gt nx nd ny nz aw oa bi"><span id="10aa" class="ob md it nd b gy oc od l oe of"><a class="ae ky" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/>   Widget build(BuildContext context) {<br/>     return WebView(<br/>       initialUrl: 'https://example.com',<br/>     );<br/>   }</span></pre><p id="fa6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">webview_flutter插件支持在Dart和JavaScript之间建立一个消息传递接口，因此您可以通过结合原生flutter小部件和HTML/Web组件来构建类似原生的混合应用程序。想象一下，如果您为现有的web应用程序使用Material主题，并将其嵌入到Flutter应用程序中，而不是在Dart中重写所有内容，那么项目交付速度会有多快。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f0b6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="12d4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Flutter正变得越来越受欢迎，因为它对开发人员友好，接近本地的性能，以及通用平台支持。但是，有些开发人员不选择Flutter，因为Dart对于开发人员社区来说是一种陌生的语言。一些开发人员认为，Flutter用Dart运行时制作了一个沙箱(就像web浏览器一样),从而降低了应用程序开发的灵活性。</p><p id="c600" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Flutter提供了平台通道的概念，就像go中的<a class="ae ky" href="https://pkg.go.dev/cmd/cgo" rel="noopener ugc nofollow" target="_blank"> cgo </a>或者Java中的<a class="ae ky" href="https://en.wikipedia.org/wiki/Java_Native_Interface" rel="noopener ugc nofollow" target="_blank"> JNI </a>。因此，在Flutter中使用特定于平台的代码是如此简单和高效。此外，我们有几种通过Dart使用其他语言的实用方法。尝试上述方法，通过重用现有的特定平台或web应用程序代码来构建高级Flutter应用程序。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="96f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e80c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">分级编码</h1><p id="a96e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="0b71" class="ok ol it lb b lc ld lf lg li om lm on lq oo lu op oq or os bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="bebe" class="ok ol it lb b lc ot lf ou li ov lm ow lq ox lu op oq or os bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="7e27" class="ok ol it lb b lc ot lf ou li ov lm ow lq ox lu op oq or os bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="c8f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>