<html>
<head>
<title>Create a React component library with TypeScript and Storybook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用类型脚本和故事书创建一个React组件库</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-a-react-component-library-with-typescript-and-storybook-ed28fc7511f2?source=collection_archive---------0-----------------------#2019-12-24">https://levelup.gitconnected.com/create-a-react-component-library-with-typescript-and-storybook-ed28fc7511f2?source=collection_archive---------0-----------------------#2019-12-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a394a5049a82007531767acee1ff1225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fcVDMhspDnhR2-eHBauDbQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://www.pexels.com/@mccutcheon?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">莎伦·麦卡琴</a>从<a class="ae kf" href="https://www.pexels.com/photo/art-materials-art-supplies-blocks-blur-1148496/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>拍摄</figcaption></figure><p id="e690" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码的可重用性很重要，而组件的可重用性在用户界面开发中非常重要。用户对用户界面的变化非常敏感。跨应用程序重用组件会给它们带来更好的整体体验。</p><p id="094b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您不一定需要TypeScript来创建React组件库，但是添加它将使您的库更加健壮，并且拥有类型定义肯定会提高可重用性因素和开发人员体验。此外，您的库用户将更容易将它集成到他们的应用程序中。</p><h1 id="e109" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">起始基地</h1><p id="dc15" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">组件库就像任何其他的NPM模块。我们可以从常规的打字稿NPM模块开始。(<a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/create-a-npm-module-with-typescript-c99bd0686f69?source=friends_link&amp;sk=c10eeafdb7f21d713245be87b30e35b6">像这样&gt; </a>)</p><p id="44b7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据上一篇文章，我将重新创建这些步骤:</p><ul class=""><li id="4b54" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">创建文件夹:<code class="fe mq mr ms mt b">my-components</code></li><li id="de89" class="mh mi it ki b kj mu kn mv kr mw kv mx kz my ld mm mn mo mp bi translated">创建<code class="fe mq mr ms mt b">package.json</code>:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="7761" class="nh lf it mt b gy ni nj l nk nl">$ mkdir my-components<br/>$ cd my-components<br/>$ echo '{<br/>  "name": "my-components",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "build/index.js",<br/>  "module": "build/index.es.js",<br/>  "jsnext:main": "build/index.es.js",<br/>  "scripts": {<br/>    "build": "rollup -c", <br/>    "lint": "standard",<br/>    "format": "prettier-standard --format",<br/>    "test": "jest --coverage"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "@types/jest": "^24.0.24",<br/>    "jest": "^24.9.0",<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "standard": "^14.3.1",<br/>    "standard-prettier": "^1.0.1",<br/>    "ts-jest": "^24.2.0",<br/>    "typescript": "^3.7.3"<br/>  },<br/>  "jest": {<br/>    "preset": "ts-jest",<br/>    "testEnvironment": "node"<br/>  },<br/>  "standard": {<br/>    "ignore": [<br/>      "node_modules/",<br/>      "build/"<br/>    ]<br/>  }<br/>}' &gt; package.json</span></pre><ul class=""><li id="701e" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">安装依赖项</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="6db2" class="nh lf it mt b gy ni nj l nk nl">$ yarn install<br/>[1/4] 🔍  Resolving packages...</span><span id="42b7" class="nh lf it mt b gy nm nj l nk nl">...</span><span id="96b6" class="nh lf it mt b gy nm nj l nk nl">✨  Done in 19.03s.</span></pre><ul class=""><li id="3437" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">添加<code class="fe mq mr ms mt b">tsconfig.json</code>文件:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="b923" class="nh lf it mt b gy ni nj l nk nl">$ echo '{<br/>  "compilerOptions": {<br/>    "outDir": "build",<br/>    "module": "esnext",<br/>    "target": "es5",<br/>    "lib": ["es6", "dom", "es2016", "es2017"],<br/>    "sourceMap": true,<br/>    "allowJs": false,<br/>    "declaration": true, <br/>    "moduleResolution": "node",<br/>    "forceConsistentCasingInFileNames": true,<br/>    "noImplicitReturns": true,<br/>    "noImplicitThis": true,<br/>    "noImplicitAny": true,<br/>    "strictNullChecks": true,<br/>    "suppressImplicitAnyIndexErrors": true,<br/>    "noUnusedLocals": true,<br/>    "noUnusedParameters": true,<br/>    "esModuleInterop": true<br/>  },<br/>  "include": ["src"],<br/>  "exclude": ["node_modules", "build"]<br/>}' &gt; tsconfig.json</span></pre><ul class=""><li id="a798" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">添加<code class="fe mq mr ms mt b">rollup.config.js</code>文件:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="6ce0" class="nh lf it mt b gy ni nj l nk nl">$ echo "import typescript from 'rollup-plugin-typescript2'<br/>import commonjs from 'rollup-plugin-commonjs'<br/>import external from 'rollup-plugin-peer-deps-external'<br/>import resolve from 'rollup-plugin-node-resolve'<br/><br/>import pkg from './package.json'<br/><br/>export default {<br/>  input: 'src/index.ts',<br/>  output: [<br/>    {<br/>      file: pkg.main,<br/>      format: 'cjs',<br/>      exports: 'named',<br/>      sourcemap: true<br/>    },<br/>    {<br/>      file: pkg.module,<br/>      format: 'es',<br/>      exports: 'named',<br/>      sourcemap: true<br/>    }<br/>  ],<br/>  plugins: [<br/>    external(),<br/>    resolve(),<br/>    typescript({<br/>      rollupCommonJSResolveHack: true,<br/>      exclude: [<br/>        '**/__tests__/**'<br/>      ],<br/>      clean: true<br/>    }),<br/>    commonjs({<br/>      include: ['node_modules/**']<br/>    })<br/>  ]<br/>}" &gt; rollup.config.js</span></pre><ul class=""><li id="2c56" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">添加一个<code class="fe mq mr ms mt b">.prettierignore</code>文件:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="1677" class="nh lf it mt b gy ni nj l nk nl">echo 'build/' &gt; .prettierignore</span></pre><ul class=""><li id="c292" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">创建<code class="fe mq mr ms mt b">src/</code>文件夹和一个<code class="fe mq mr ms mt b">src/index.ts</code>文件:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="9503" class="nh lf it mt b gy ni nj l nk nl">$ mkdir src<br/>$ echo "export function sum (a: number, b: number): number { return a + b }" &gt; src/index.ts</span></pre><ul class=""><li id="5677" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">构建应该在这一点上工作:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="1ef2" class="nh lf it mt b gy ni nj l nk nl">$ yarn build<br/>yarn run v1.17.3<br/>$ rollup -c</span><span id="8d56" class="nh lf it mt b gy nm nj l nk nl">src/index.ts → build/index.js, build/index.es.js...<br/>created build/index.js, build/index.es.js in 995ms<br/>✨  Done in 1.46s.</span></pre><ul class=""><li id="a4b1" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">创建一个测试文件<code class="fe mq mr ms mt b">src/__tests__/index.spec.ts</code>:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="d09f" class="nh lf it mt b gy ni nj l nk nl">$ echo "import { sum } from '../index'<br/>test('sum 4 + 7 = 11', () =&gt; {<br/>  expect(sum(4, 7)).toEqual(11)<br/>})" &gt; src/__tests__/index.spec.ts</span></pre><ul class=""><li id="cc54" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">测试也应该有效:</li></ul><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="9e1a" class="nh lf it mt b gy ni nj l nk nl">$ yarn test<br/>yarn run v1.17.3<br/>$ jest --coverage<br/>PASS  src/__tests__/index.spec.ts<br/> ✓ sum 4 + 7 = 11 (6ms)</span><span id="2905" class="nh lf it mt b gy nm nj l nk nl">----------|----------|----------|----------|----------|-------------------|<br/>File      |  % Stmts | % Branch |  % Funcs |  % Lines | Uncovered Line #s |<br/>----------|----------|----------|----------|----------|-------------------|<br/>All files |      100 |      100 |      100 |      100 |                   |<br/>index.ts |      100 |      100 |      100 |      100 |                   |<br/>----------|----------|----------|----------|----------|-------------------|<br/>Test Suites: 1 passed, 1 total<br/>Tests:       1 passed, 1 total<br/>Snapshots:   0 total<br/>Time:        1.787s<br/>Ran all test suites.<br/>✨  Done in 2.71s.</span></pre><p id="26ea" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">初始化git repo并添加一个<code class="fe mq mr ms mt b">.gitignore</code>文件:</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="dae0" class="nh lf it mt b gy ni nj l nk nl">$ git init<br/>$ echo 'node_modules/<br/>coverage/' &gt; .gitignore</span><span id="04c8" class="nh lf it mt b gy nm nj l nk nl">$ git status<br/>On branch master</span><span id="f559" class="nh lf it mt b gy nm nj l nk nl">No commits yet</span><span id="26d5" class="nh lf it mt b gy nm nj l nk nl">Untracked files:<br/> (use "git add &lt;file&gt;..." to include in what will be committed)</span><span id="ae00" class="nh lf it mt b gy nm nj l nk nl">    .gitignore<br/>    .prettierignore<br/>    build/<br/>    package.json<br/>    rollup.config.js<br/>    src/<br/>    tsconfig.json<br/>    yarn.lock</span><span id="fbef" class="nh lf it mt b gy nm nj l nk nl">nothing added to commit but untracked files present (use "git add" to track)</span></pre><h1 id="0719" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">转换为ReactJS模块</h1><p id="e75e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">首先添加ReactJS作为对等依赖项。这将向您的模块用户表明这个包依赖于ReactJS的这个版本:</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="2fca" class="nh lf it mt b gy ni nj l nk nl">$ yarn add --peer <strong class="mt iu">react@^16 react-dom@^16</strong></span></pre><p id="4073" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nn">首先添加对等依赖项，否则如果同一个包已经安装为开发依赖项，yarn不会添加它们(</em><a class="ae kf" href="https://github.com/yarnpkg/yarn/issues/5287" rel="noopener ugc nofollow" target="_blank"><em class="nn">https://github.com/yarnpkg/yarn/issues/5287</em></a><em class="nn">)</em></p><p id="f1fb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">添加反应堆开发依赖项+类型:</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="ec69" class="nh lf it mt b gy ni nj l nk nl">$ yarn add -dev <strong class="mt iu">react react-dom</strong> <strong class="mt iu">@types/react @types/react-dom</strong></span></pre><h2 id="8d6a" class="nh lf it bd lg no np dn lk nq nr dp lo kr ns nt ls kv nu nv lw kz nw nx ma ny bi translated">汇总设置</h2><p id="dbbf" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Rollup需要一些更改来支持外部依赖项。因为我们不想将react库代码与我们自己的代码一起发布。</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="114b" class="nh lf it mt b gy ni nj l nk nl">import typescript from 'rollup-plugin-typescript2'<br/>import commonjs from 'rollup-plugin-commonjs'<br/>import external from 'rollup-plugin-peer-deps-external'<br/>import resolve from 'rollup-plugin-node-resolve'</span><span id="a122" class="nh lf it mt b gy nm nj l nk nl">import pkg from './package.json'</span><span id="28c3" class="nh lf it mt b gy nm nj l nk nl">export default {<br/>  input: 'src/index.ts',<br/>  output: [<br/>    {<br/>      file: pkg.main,<br/>      format: 'cjs',<br/>      exports: 'named',<br/>      sourcemap: true<br/>    },<br/>    {<br/>      file: pkg.module,<br/>      format: 'es',<br/>      exports: 'named',<br/>      sourcemap: true<br/>    }<br/>  ],<br/>  plugins: [<br/>    external(),<br/>    resolve(),<br/>    typescript({<br/>      rollupCommonJSResolveHack: true,<br/>      exclude: [<br/>        '**/__tests__/**'<br/>      ],<br/>      clean: true<br/>    }),<br/>    commonjs({<br/>      include: ['node_modules/**'],<br/>      <strong class="mt iu">namedExports: {<br/>        'node_modules/react/react.js': [<br/>          'Children',<br/>          'Component',<br/>          'PropTypes',<br/>          'createElement'<br/>        ],<br/>        'node_modules/react-dom/index.js': ['render']<br/>      }</strong><br/>    })<br/>  ]<br/>}</span></pre><h2 id="8103" class="nh lf it bd lg no np dn lk nq nr dp lo kr ns nt ls kv nu nv lw kz nw nx ma ny bi translated">添加第一个组件:</h2><p id="ad26" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为组件创建一个文件夹:</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="7afa" class="nh lf it mt b gy ni nj l nk nl">$ mkdir src/components</span></pre><p id="a970" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个组件代码:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/components/MyComponent.tsx</figcaption></figure><p id="f5cf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们也修改一下<code class="fe mq mr ms mt b">index.ts</code>文件，只导入/导出我们仅有的一个组件:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/索引. ts</figcaption></figure><p id="e213" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，我们可以构建我们的模块，并将组件(从<code class="fe mq mr ms mt b">index.ts</code>导出)构建到<code class="fe mq mr ms mt b">build</code>文件夹中，包括类型化。</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="45b3" class="nh lf it mt b gy ni nj l nk nl">$ yarn build</span></pre><h2 id="8253" class="nh lf it bd lg no np dn lk nq nr dp lo kr ns nt ls kv nu nv lw kz nw nx ma ny bi translated">当然是测试。</h2><p id="ac28" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了测试React组件，我们将使用惊人的:<code class="fe mq mr ms mt b">@react-testing</code>库:</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="b188" class="nh lf it mt b gy ni nj l nk nl">$ yarn add --dev <strong class="mt iu">@testing-library/react @testing-library/jest-dom</strong></span></pre><p id="8032" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更改<code class="fe mq mr ms mt b">package.json</code>文件的几个设置:</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="9622" class="nh lf it mt b gy ni nj l nk nl">{<br/>  "name": "my-module",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "build/index.js",<br/>  "module": "build/index.es.js",<br/>  "jsnext:main": "build/index.es.js",<br/>  "scripts": {<br/>    "build": "rollup -c",<br/>    "lint": "standard",<br/>    "format": "prettier-standard --format",<br/>    "test": "jest --coverage"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "<a class="ae kf" href="http://twitter.com/testing" rel="noopener ugc nofollow" target="_blank">@testing</a>-library/jest-dom": "^4.2.4",<br/>    "<a class="ae kf" href="http://twitter.com/testing" rel="noopener ugc nofollow" target="_blank">@testing</a>-library/react": "^9.4.0",<br/>    "<a class="ae kf" href="http://twitter.com/types/jest" rel="noopener ugc nofollow" target="_blank">@types/jest</a>": "^24.0.24",<br/>    "<a class="ae kf" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank">@types/react</a>": "^16.9.17",<br/>    "<a class="ae kf" href="http://twitter.com/types/react-dom" rel="noopener ugc nofollow" target="_blank">@types/react-dom</a>": "^16.9.4",<br/>    "jest": "^24.9.0",<br/>    "react": "^16.12.0",<br/>    "react-dom": "^16.12.0",<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "standard": "^14.3.1",<br/>    "standard-prettier": "^1.0.1",<br/>    "ts-jest": "^24.2.0",<br/>    "typescript": "^3.7.3"<br/>  },<br/>  "peerDependencies": {<br/>    "react": "^16",<br/>    "react-dom": "^16"<br/>  },<br/>  "jest": {<br/>    "preset": "ts-jest",<br/>    <strong class="mt iu">"testEnvironment": "jsdom",<br/>    "testPathIgnorePatterns": [<br/>      "build/"<br/>    ]</strong><br/>  },<br/>  "standard": {<br/>    "ignore": [<br/>      "node_modules/",<br/>      "build/"<br/>    ],<br/>    <strong class="mt iu">"globals": [<br/>      "describe",<br/>      "it",<br/>      "test",<br/>      "expect",<br/>      "afterAll",<br/>      "jest"<br/>    ]</strong><br/>  }<br/>}</span></pre><p id="d5be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里最重要的是:</p><ul class=""><li id="f28d" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">jsdom是一个类似浏览器的测试环境</li><li id="d73f" class="mh mi it ki b kj mu kn mv kr mw kv mx kz my ld mm mn mo mp bi translated"><code class="fe mq mr ms mt b">testPathIgnorePatterns=[build/]</code>:因此<code class="fe mq mr ms mt b">build</code>文件夹在测试中被忽略</li><li id="0d4c" class="mh mi it ki b kj mu kn mv kr mw kv mx kz my ld mm mn mo mp bi translated">标准的<code class="fe mq mr ms mt b">globals</code>:这些是我们测试中使用的全局词，所以林挺标准不会抱怨它们。</li></ul><p id="e44d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还有对我们<code class="fe mq mr ms mt b">MyComponent</code>的一个考验:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/components/_ _ tests _ _/my component . spec . tsx</figcaption></figure><p id="7727" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nn">删除包含旧测试的旧</em> <code class="fe mq mr ms mt b"><em class="nn">src/__tests__</em></code> <em class="nn">文件夹，因为我们不再拥有旧模块功能。</em></p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="fd80" class="nh lf it mt b gy ni nj l nk nl">$ yarn test<br/>yarn run v1.17.3<br/>$ jest --coverage<br/> PASS  src/components/__tests__/MyComponent.spec.tsx<br/>  ✓ Renders (55ms)</span><span id="84cb" class="nh lf it mt b gy nm nj l nk nl">------------------|----------|----------|----------|----------|-------------------|<br/>File              |  % Stmts | % Branch |  % Funcs |  % Lines | Uncovered Line #s |<br/>------------------|----------|----------|----------|----------|-------------------|<br/>All files         |      100 |      100 |      100 |      100 |                   |<br/> src              |      100 |      100 |      100 |      100 |                   |<br/>  index.ts        |      100 |      100 |      100 |      100 |                   |<br/> src/components   |      100 |      100 |      100 |      100 |                   |<br/>  MyComponent.tsx |      100 |      100 |      100 |      100 |                   |<br/>------------------|----------|----------|----------|----------|-------------------|<br/>Test Suites: 1 passed, 1 total<br/>Tests:       1 passed, 1 total<br/>Snapshots:   0 total<br/>Time:        1.297s, estimated 2s<br/>Ran all test suites.<br/>✨  Done in 2.01s.</span></pre><h1 id="e602" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">故事书</h1><p id="a7db" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Storybook是一个为React(<a class="ae kf" href="https://storybook.js.org/" rel="noopener ugc nofollow" target="_blank">https://storybook.js.org/</a>)开发独立UI组件的开源工具</p><p id="9b7d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在开发组件库时，拥有一个可以用不同的属性集和上下文实例化和可视化组件的工作台是非常有用的。此外，完成后，您还可以记录组件的使用情况。</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="1801" class="nh lf it mt b gy ni nj l nk nl">$ yarn add --dev <strong class="mt iu">babel-loader @babel/core @storybook/react awesome-typescript-loader</strong></span></pre><p id="bcf1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在根文件夹上创建一个. storybook文件夹来保存配置。</p><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="4476" class="nh lf it mt b gy ni nj l nk nl">$ mkdir .storybook</span></pre><p id="5857" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建以下文件:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">。故事书/config.js</figcaption></figure><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">。storybook/webpack.config.js</figcaption></figure><p id="f8cf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一个故事:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/components/my components . stories . tsx</figcaption></figure><pre class="mz na nb nc gt nd mt ne nf aw ng bi"><span id="81fa" class="nh lf it mt b gy ni nj l nk nl">$ yarn storybook</span></pre><p id="1cb7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将自动打开:</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/b568a8a1d2489cd3703a0ec0ed835fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y5PxgNSm1039_xqUm7g1-Q.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">故事书</figcaption></figure><h1 id="291c" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><ul class=""><li id="6eb9" class="mh mi it ki b kj mc kn md kr oc kv od kz oe ld mm mn mo mp bi translated">从常规的NPM模块开始，添加ReactJS依赖项</li><li id="bce7" class="mh mi it ki b kj mu kn mv kr mw kv mx kz my ld mm mn mo mp bi translated">总是添加测试。使用<code class="fe mq mr ms mt b">@testing-library</code>会有所帮助。</li><li id="3f61" class="mh mi it ki b kj mu kn mv kr mw kv mx kz my ld mm mn mo mp bi translated">添加故事书是可选的，但完全推荐。</li></ul><p id="5e19" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">黑客快乐…</p><p id="f065" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更新:你可以重用这个帖子的代码:<a class="ae kf" href="https://github.com/outsrc/my-components" rel="noopener ugc nofollow" target="_blank">https://github.com/outsrc/my-components</a>(设置为模板回购更容易重用)</p></div></div>    
</body>
</html>