<html>
<head>
<title>How to re-order a comma-separated list in Oracle SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Oracle SQL中对逗号分隔的列表重新排序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-re-order-a-comma-separated-list-in-oracle-sql-eb5f9733c5cd?source=collection_archive---------2-----------------------#2021-07-21">https://levelup.gitconnected.com/how-to-re-order-a-comma-separated-list-in-oracle-sql-eb5f9733c5cd?source=collection_archive---------2-----------------------#2021-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8e7f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设您有一个由数字组成的逗号分隔列表，并且您希望它按从小到大的顺序排序。继续阅读，看看我在继续学习Oracle SQL时想到的一个工作示例…</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/afe2890b09611895345cd6165b74e71c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/0*iIoYzWSTbp3JMsnA.png"/></div></figure><p id="b31b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">自我推销:</p><p id="fb3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这里写的内容，尽一切办法，把这个博客和你最喜欢的帖子分享给其他可能从中受益或喜欢它的人。既然咖啡是我最喜欢的饮料，如果你愿意，你甚至可以给我买一杯！</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="9fb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">注意</strong>:和任何事情一样，<em class="le">你能做某件事并不一定意味着你应该去做</em>。这篇文章主要是对我将来学习Oracle数据库提供的一些regex函数的反思和记录。</p><p id="dcab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我有一个简单的表，其中一列的数据类型为<code class="fe lf lg lh li b">VARCHAR2</code>:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/7b9c38886c11611f18ec6801e08df693.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/0*MPgPEBaQgnY8spLn"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">存储在VARCHAR2列中的逗号分隔列表。</figcaption></figure><p id="14ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">单行数据是逗号分隔的非连续数字列表。如果您想对数字进行排序，可能有几种方法可以实现。我在这个例子中使用了一些regexp(正则表达式)函数。</p><h2 id="d515" class="lq lr it bd ls lt lu dn lv lw lx dp ly kb lz ma mb kf mc md me kj mf mg mh mi bi translated">使用REGEXP_COUNT()确定元素的数量</h2><p id="2296" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated">首先你需要知道列表中有多少个元素。您可以通过计算逗号的数量并将该值加1来确定这一点。在下面的查询中，我使用了<code class="fe lf lg lh li b">REGEXP_COUNT()</code>函数并返回列表中逗号的数量。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/6c3f5ed04cf0559c5a51e7b30c990512.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/0*-FgcdboS8KhkGLml"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">使用REGEXP_COUNT()计算逗号的数量。</figcaption></figure><p id="1e84" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了遍历数字列表并每行返回一个元素，我使用了<code class="fe lf lg lh li b">CONNECT BY</code>子句和<code class="fe lf lg lh li b">REGEXP_COUNT()</code>返回的逗号数。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/576b91a2099ebdca4944bcc27d70bb8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/0*QYj2ncmbRicL5Mkd"/></div></figure><p id="74e0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请注意，查询结果中缺少一个元素。因为我使用<code class="fe lf lg lh li b">REGEXP_COUNT()</code>遍历列表的次数等于逗号数，所以我需要给这个值加1。回想一下，有6个逗号，但有7个元素。</p><p id="28f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与上面相同的查询，但是这次我在由<code class="fe lf lg lh li b">REGEXP_COUNT()</code>返回的总数上加1，以便迭代正确的次数。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/7f513f1209cd775d44a7ddbfb84edc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/0*W02e5uS62dRjysI2"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">将REGEXP_COUNT()返回值加1。</figcaption></figure><h2 id="ca6d" class="lq lr it bd ls lt lu dn lv lw lx dp ly kb lz ma mb kf mc md me kj mf mg mh mi bi translated">使用REGEXP_SUBSTR()将列表分割成单独的元素</h2><p id="472a" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated">在下一个查询中，<code class="fe lf lg lh li b">REGEXP_SUBSTR()</code> <strong class="js iu"> </strong>函数用于<em class="le">分割</em>逗号上的列表，返回每个单独的数字元素。使用<code class="fe lf lg lh li b">to_number()</code>函数，我将每个元素转换成一个实际的整数值。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/ff21bb220531c7b7c8d84c18220a55b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/0*YmrNxRPNEwVrOar-"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">使用to_number()函数转换单个元素。</figcaption></figure><p id="b013" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了更容易处理，我使用了一个<code class="fe lf lg lh li b">WITH</code>子句并创建了一个临时结果集来进一步从<code class="fe lf lg lh li b">SELECT</code>开始，并按照<code class="fe lf lg lh li b">ASC</code>顺序对列表元素进行排序:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/bdc77a4d228e5b44c398736fe3775c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/0*PPlea_XPXUtqwYTF"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">对数字元素排序。</figcaption></figure></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="e181" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我坚持每周写一封关于我正在学习并感兴趣的SQL/PHP的邮件。如果这听起来像是你想参与的事情，请使用此<a class="ae kw" href="https://digitalowlsprose.ck.page/1b35a06295" rel="noopener ugc nofollow" target="_blank">注册</a>表格进行订阅。谢谢大家！</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><h2 id="1c5c" class="lq lr it bd ls lt lu dn lv lw lx dp ly kb lz ma mb kf mc md me kj mf mg mh mi bi translated">使用LISTAGG()重新构建逗号分隔的列表</h2><p id="c48a" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated">我现在使用<code class="fe lf lg lh li b">LISTAGG()</code>和<code class="fe lf lg lh li b"><strong class="js iu">to_char()</strong></code>函数创建一个逗号分隔的排序数字列表。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2f7fec1167621a08347b8cf940d0b06e.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/0*LcCghlb1_JCuzekD"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">按顺序排序的逗号分隔列表。</figcaption></figure><h2 id="1c76" class="lq lr it bd ls lt lu dn lv lw lx dp ly kb lz ma mb kf mc md me kj mf mg mh mi bi translated">好处:使用WITH子句插入数据</h2><p id="a8eb" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated"><code class="fe lf lg lh li b">WITH</code>子句(公共表表达式或子查询分解子句)的一个重要特性是，通过用逗号分隔每个<code class="fe lf lg lh li b">AS</code>部分，我们可以在同一个CTE中拥有多个子查询。我在下面的<code class="fe lf lg lh li b">INSERT</code>语句中利用这个特性，使用<code class="fe lf lg lh li b">WITH</code>子句作为带有<code class="fe lf lg lh li b">SELECT</code>类型查询的<code class="fe lf lg lh li b">INSERT</code>的数据源:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="f4ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦执行了<code class="fe lf lg lh li b">INSERT</code>，我现在就有了按顺序排序的原始逗号分隔列表，并存储在<code class="fe lf lg lh li b">A_STR_TBL</code>表中:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/c07572baad50a28232c7dfdb81212268.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/0*p0y6d82-qx1tDbwV"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">存储在表A_STR_TBL中的逗号分隔的排序列表。</figcaption></figure></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="de7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我<em class="le">第一次接触</em>甲骨文的<code class="fe lf lg lh li b">REGEXP_SUBSTR()</code>和<code class="fe lf lg lh li b">REGEXP_COUNT()</code>功能。我知道随着我更多地使用数据库，我可能会再次使用它们。如果你看到任何错误或对代码有疑问，请在评论中自由分享。建设性的反馈帮助我提供准确的文章，非常感谢！</p><p id="6a37" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">喜欢你读过的？看到什么不正确的吗？请在下面评论，感谢阅读！！！</p><h1 id="4996" class="mv lr it bd ls mw mx my lv mz na nb ly nc nd ne mb nf ng nh me ni nj nk mh nl bi translated">行动的号召！</h1><p id="8034" class="pw-post-body-paragraph jq jr it js b jt mj jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj mn kl km kn im bi translated">感谢你花时间阅读这篇文章。我真心希望你发现了一些有趣和有启发性的东西。请在这里与你认识的其他人分享你的发现，他们也会从中获得同样的价值。</p><p id="9119" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">访问<a class="ae kw" href="https://wp.me/P28ctb-3KD" rel="noopener ugc nofollow" target="_blank">投资组合-项目页面</a>查看我为客户完成的博客帖子/技术写作。</p><p id="27e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae kw" href="https://ko-fi.com/joshlovescoffee" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">咖啡是我绝对喜欢的饮料！！！</strong>T24】</a></p><p id="f255" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要在最新的博客文章发表时收到来自本博客(“数字猫头鹰散文”)的电子邮件通知(绝不是垃圾邮件)，请点击“点击订阅！”按钮在首页的侧边栏！(如有任何问题，请随时查看<a class="ae kw" href="https://wp.me/P28ctb-3gI" rel="noopener ugc nofollow" target="_blank"> Digital Owl的散文隐私政策页面</a>:电子邮件更新、选择加入、选择退出、联系表格等)</p><p id="3c27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请务必访问<a class="ae kw" href="https://joshuaotwell.com/where-blog_post-in-digital-owls-prose-best-of/" rel="noopener ugc nofollow" target="_blank">“最佳”</a>页面，收集我的最佳博文。</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="6b83" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae kw" href="https://joshuaotwell.com/about/" rel="noopener ugc nofollow" target="_blank">作为一名SQL开发人员和博客写手，Josh Otwell </a>热衷于学习和成长。其他最喜欢的活动是让他埋头于一本好书、一篇文章或Linux命令行。其中，他喜欢桌面RPG游戏，阅读奇幻小说，并与妻子和两个女儿共度时光。</p><p id="5a84" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">免责声明:本文中的例子是关于如何实现类似结果的假设。它们不是最好的解决方案。所提供的大多数(如果不是全部)示例都是在个人发展/学习工作站环境中执行的，不应被视为生产质量或就绪。您的特定目标和需求可能会有所不同。使用那些最有利于你的需求和目标的实践。观点是我自己的。</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="c5b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="le">原载于2021年7月21日https://joshuaotwell.com</em><em class="le"/><a class="ae kw" href="https://joshuaotwell.com/how-to-re-order-a-comma-separated-list-in-oracle-sql/" rel="noopener ugc nofollow" target="_blank"><em class="le">。</em></a></p></div></div>    
</body>
</html>