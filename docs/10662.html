<html>
<head>
<title>Connect ArgoCD to your private GitHub repository</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将ArgoCD连接到您的私有GitHub存储库</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/connect-argocd-to-your-private-github-repository-493b1483c01e?source=collection_archive---------1-----------------------#2021-12-31">https://levelup.gitconnected.com/connect-argocd-to-your-private-github-repository-493b1483c01e?source=collection_archive---------1-----------------------#2021-12-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7b15" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一步一步的指南，让您在Kubernetes上的ArgoCD设置能够连接到您的私有GitHub存储库。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/0daca44d906e2aa5ff883b2eb5a59c43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9v-L_3DMpo74PxUfDJQUA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">让我们把东西部署好</figcaption></figure><h2 id="5ed4" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">先决条件</h2><p id="12eb" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">如果您想一步一步地学习本教程，您必须有一个启动并运行的Kubernetes集群，并安装一个工作ArgoCD。</p><p id="8d15" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您还没有，请随意阅读我的另一篇文章，在这篇文章中，我指导您一步一步地完成正确的设置过程，并帮助您连接到您的公共GitHub资源库。</p><div class="mc md gp gr me mf"><a rel="noopener  ugc nofollow" target="_blank" href="/getting-started-with-argocd-on-your-kubernetes-cluster-552ca5d8cf41"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">Kubernetes集群上的ArgoCD入门</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">在Kubernetes集群上设置ArgoCD并与GitHub同步资源的分步指南…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt ky mf"/></div></div></a></div><p id="396c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，我在前一篇教程的基础上构建了本教程，所以我不会再重复原来的设置，所以请确保您查看了前一篇文章。</p><p id="d4bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">除此之外，我还在下面的<a class="ae mu" href="https://github.com/Abszissex/medium-argocd-private-repo" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中准备了本教程所需的所有资源:</p><div class="mc md gp gr me mf"><a href="https://github.com/Abszissex/medium-argocd-private-repo" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">GitHub-abszisex/medium-argocd-private-repo</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">github.com</p></div></div><div class="mo l"><div class="mv l mq mr ms mo mt ky mf"/></div></div></a></div><p id="35a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该存储库包含:</p><ul class=""><li id="546b" class="mw mx it js b jt ju jx jy kb my kf mz kj na kn nb nc nd ne bi translated">一个可以快速开始使用现成的Kubernetes集群的漫游文件</li><li id="2685" class="mw mx it js b jt nf jx ng kb nh kf ni kj nj kn nb nc nd ne bi translated">舵图ArgoCD应部署到集群</li><li id="06f0" class="mw mx it js b jt nf jx ng kb nh kf ni kj nj kn nb nc nd ne bi translated">清单来设置我们的ArgoCD应用程序、服务和机密配置</li></ul><p id="ad1d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">记住，由于显而易见的原因，这个存储库是公共的，所以如果您想学习本教程，您可以自由地将它转到一个私有存储库，并在那里调整存储库的URL。</p><h2 id="877c" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">您将在本教程中学到什么</h2><p id="1988" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">在上一个教程中，我们已经学习了如何连接到一个公共的GitHub库。但是，当然，您不希望将您的所有代码公开，主要是如果它包含您的业务的生产代码。</p><p id="44e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ArgoCD使用基于拉的同步方法来保持集群和存储库同步。不幸的是，这导致ArgoCD需要向您的GitHub存储库认证以获取最新的更改，这使它变得稍微复杂了一点。但是不要担心，这并没有听起来那么复杂。</p><p id="fa8c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，在本教程中，我们将学习如何启用ArgoCD设置，使用SSH密钥从私有存储库中提取变更。</p><h2 id="fcba" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">生成新的SSH密钥对</h2><p id="b14e" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">ArgoCD与GitHub通信检查更改有两种可能。一种是通过HTTPS使用用户名和密码。另一种推荐的方法是使用私有-公共密钥对来使用SSH。</p><p id="2fde" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，我们将检查SSH之一。</p><p id="1ddf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以，首先，我们需要一个SSH密钥来使用。我们可以使用以下命令轻松地创建一个新的SSH密钥对。</p><pre class="kp kq kr ks gt nk nl nm nn aw no bi"><span id="3e21" class="le lf it nl b gy np nq l nr ns">ssh-keygen -t ed25519 -C "some comment"</span></pre><p id="5701" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您不必添加密码短语。按几次回车键，使用默认值。终端中的输出应该如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/f1ccc3894d8cd8edd119ee657542411f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*-VejuJNzB1iqJquTeuowTg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ssh-keygen</figcaption></figure><p id="c429" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要验证一切正常，您可以使用以下命令:</p><pre class="kp kq kr ks gt nk nl nm nn aw no bi"><span id="0995" class="le lf it nl b gy np nq l nr ns"># Show content of public key<br/>cat /home/vagrant/.ssh/id_ed25519.pub</span><span id="0adb" class="le lf it nl b gy nu nq l nr ns"># Show content of private key<br/>cat /home/vagrant/.ssh/id_ed25519</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nv"><img src="../Images/02f6e5d14f52217eea983c81c66f9642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ze_YCCbTI78T5TPtLjiaBw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">显示公钥的内容</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/f3bbe1a50f55b4669a207cbc3e68e51f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZpl0aHBsj4LepF6JjCOfA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">显示私钥的内容</figcaption></figure><p id="e623" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请记住，如果您不使用我在上一篇教程中提供的漫游设置，您的机器上的路径可能会不同。但是,<code class="fe nx ny nz nl b">ssh-keygen</code>命令会向您显示它保存密钥的位置。</p><h2 id="8ef5" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">在GitHub存储库上添加新的部署密钥</h2><p id="d679" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">既然我们已经生成了想要使用的新的SSH密钥对，我们必须将公钥告诉GitHub。然后，GitHub可以验证稍后将获取存储库内容的连接是我们经过身份验证的ArgoCD服务。</p><p id="20e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在GitHub中，这很简单。在下面的例子中，我使用了我的“private-demo”GitHub存储库，顾名思义，这是我为这个演示创建的私有存储库。在存储库设置中，您可以导航到“部署密钥”,然后“添加部署密钥”来添加一个新密钥，GitHub可以使用它来验证ArgoCD服务与存储库的连接。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/fdcdbc9fcbfeef00db83060d93ce661e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwJrE-Tonyg-8GilBNNGLg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">GitHub |部署密钥</figcaption></figure><p id="75ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们可以添加在上一步中生成的公钥。对于“标题”，你可以选择任何你想要的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/338e8f56bfc2864fc2f056b919f6849b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HxIR9sppi6BFOWJ9a_4BPw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">GitHub |添加部署密钥</figcaption></figure><p id="7030" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果一切顺利，这里没有太多可能出错的地方，您应该会看到一个新条目，用于您的私有GitHub存储库的部署密钥。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/5117099f26ba42975054df9a2f431c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O97f3O1_K86no-YjHDgIKw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">GitHub |部署密钥概述</figcaption></figure><h2 id="2a5f" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">为ArgoCD设置SSH验证</h2><p id="adeb" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">我们必须使ArgoCD能够使用我们生成的私钥向GitHub认证自己，以便从存储库中提取最近的更改。</p><p id="3ea9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你应该有我在<a class="ae mu" rel="noopener ugc nofollow" target="_blank" href="/getting-started-with-argocd-on-your-kubernetes-cluster-552ca5d8cf41">之前的ArgoCD文章</a>中提供的相同的设置来遵循接下来的步骤，因为我们现在需要在它的基础上构建。目前，唯一的区别应该是将ArgoCD应用程序的<code class="fe nx ny nz nl b">repoURL</code>更改为私有存储库。</p><p id="b9f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您的ArgoCD应用程序指向您的私有存储库，您应该会看到ArgoCD应用程序上有一个错误:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/81e743f7c874b65364384f9120aa66b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFdfGAiEcyTAVwTORMla1g.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ArgoCD UI |应用程序详细信息中的错误</figcaption></figure><p id="0b35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你点击错误，你会看到更多的细节。我们预计会出现一个“需要认证”的错误，这是有意义的，因为ArgoCD还不知道如何对这个存储库进行认证。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/0c7eb6f31a4a42bb8e9cb6e1ed691f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvC9qYuABhyNURrB3MH6oQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ArgoCD UI |详细错误</figcaption></figure><p id="efc3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在有两种可能来创建有效的连接。要么使用ArgoCD UI创建一个新的存储库连接，要么通过Kubernetes清单文件使用声明性方法。我检查了两者，两者都可以工作，但是出于可再现性的原因和尽可能多的代码，我更喜欢并且将展示声明性方法。</p><p id="2893" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于声明性方法，我们使用Kubernetes配置图和秘密资源。ArgoCD已经在设置中创建了一个带有空<code class="fe nx ny nz nl b">data</code>条目的配置映射。我们将在后面的步骤中覆盖此配置映射，以指向我们的机密数据进行身份验证。</p><p id="6ec9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您以前已经使用过Kubernetes Secret资源，您会知道它需要base64编码的数据条目值。因此，让我们对我们的私钥进行base64编码，以将其提供给我们的声明。</p><p id="56e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用CLI通过base64编码也非常简单:</p><pre class="kp kq kr ks gt nk nl nm nn aw no bi"><span id="ad5f" class="le lf it nl b gy np nq l nr ns">cat /home/vagrant/.ssh/id_ed25519 | base64</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/d37fca267be1b43cb5971c00f444712e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYT0lnrCmoL_nkraVHR3dw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">base64编码私钥</figcaption></figure><h2 id="c0a5" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated"><strong class="ak">秘密</strong></h2><p id="6e59" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">我们必须把秘密藏在某个地方。为此，我们使用了Kubernetes的秘密资源。</p><p id="40cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">危险:</strong>我们不加密我们在此提供的数据，因此这不是100%的最佳做法。但是加密，例如通过sop或类似的方法，对于本文来说就太多了。不过不用担心，我稍后会就这个话题奉献一整篇文章。敬请关注！</p><div class="mc md gp gr me mf"><a rel="noopener  ugc nofollow" target="_blank" href="/encrypting-your-yaml-files-using-mozilla-sops-and-gcp-kms-b1fcd22cf40f"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">加密您的YAML文件使用Mozilla SOPS和GCP KMS</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">使用Mozilla SOPS和谷歌云KMS加密YAML文件的分步指南。</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mo l"><div class="of l mq mr ms mo mt ky mf"/></div></div></a></div><div class="mc md gp gr me mf"><a rel="noopener  ugc nofollow" target="_blank" href="/securing-your-secrets-in-git-the-safe-way-using-gcp-kms-ada49e8386af"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">保护你的秘密在git，安全的方式使用GCP KMS</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">将秘密和凭证提交到git中，而不会产生安全问题。</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mo l"><div class="og l mq mr ms mo mt ky mf"/></div></div></a></div><p id="a104" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下面的片段中，您可以看到我们新的秘密资源。出于可读性的原因，我只是缩短了<code class="fe nx ny nz nl b">privateKey</code>的值。在这里，您必须插入base64编码的私钥。请注意，它应该在一行中，没有您的终端可能显示的换行符。你可以自由选择<code class="fe nx ny nz nl b">name</code>，但是<code class="fe nx ny nz nl b">namespace</code>应该和我们其他ArgoCD资源一样是<code class="fe nx ny nz nl b">argocd</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="12c4" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated"><strong class="ak">配置图</strong></h2><p id="c3e6" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">在定义了我们的秘密之后，我们需要告诉ArgoCD它应该为哪个存储库使用这个秘密来建立连接。</p><p id="db88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以在下面的代码片段中看到我们将应用于集群的配置图。你不应该在这里搞乱<code class="fe nx ny nz nl b">metadata</code>，但是唯一重要的部分是<code class="fe nx ny nz nl b">data.repositories</code>属性。在这个属性中，我们可以定义多个存储库。在我的例子中，我通过<code class="fe nx ny nz nl b">url: git@github.com:Abszissex/private-demo</code>定义我的私有存储库，并通过定义<code class="fe nx ny nz nl b">sshPrivateKeySecret</code>对象告诉ArgoCD我想通过SSH进行认证。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="3b69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下图中，您可以看到ConfigMap 秘密映射是如何发生的。ArgoCD将ConfigMap中的<code class="fe nx ny nz nl b">name</code>映射到现有机密的<code class="fe nx ny nz nl b">name</code>。而<code class="fe nx ny nz nl b">key</code>属性定义了ArgoCD应该从Secret的<code class="fe nx ny nz nl b">data</code>对象中读取的键的名称。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oj"><img src="../Images/bd56a5c094ac9ea582d4fd7b924bc76a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0nSmWCdI4Otc5k2jVgGwg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">配置映射秘密映射</figcaption></figure><h2 id="b195" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated"><strong class="ak"> ArgoCD应用</strong></h2><p id="6fdc" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">最后但同样重要的是，在我们的声明性方法中，我们还必须将您现有的ArgoCD应用程序的<code class="fe nx ny nz nl b">repoURL</code>从HTTPS更改为SSH，如果还没有这样做的话，因为我们现在将尝试使用之前定义的ConfigMap和Secret通过SSH进行身份验证。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/8f76133863b559dfb1107695ba185bd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*an1jhYwyyw3csCoqndJzsg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ArgoCD应用程序|报告Git中的更改</figcaption></figure><p id="3f7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在创建/更新配置映射、秘密和应用程序之后，是时候通过<code class="fe nx ny nz nl b">kubectl apply -f ...</code>应用清单，并检查ArgoCD UI中是否一切如预期工作。</p><h2 id="a8e3" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated"><strong class="ak">验证GitHub连接</strong></h2><p id="5e05" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">首先，我们应该在ArgoCD UI的“Repositories”部分检查我们有一个包含我们的存储库的新条目，并且“Connection status”标记为“Successful”:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/b0498b6aecb318e896a26fe8e9db17de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ul07nO8Gxn0zxbwCbZArIA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ArgoCD UI |存储库</figcaption></figure><p id="6a9d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们可以检查我们的应用程序，并注意到我们看到所有的资源都丢失了，而不是抛出错误，并且我们的应用程序不同步。我们已经可以点击“同步”按钮，并确保ArgoCD应用最新的更改。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/b03c5ed787343b35abb39423408d50a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FyF-DwHjIYDFY3Aph5-B6w.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ArgoCD UI |应用程序</figcaption></figure><p id="d61c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，作为最后一步，我们可以查看GitHub存储库中的“部署密钥”部分。在这里，我们将看到我们创建的密钥，ArgoCD刚刚使用它。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/8a8f52579ae89da52674f0432685f0f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O-qfB9NHq2r3fA4f-zg4cQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">GitHub |部署密钥</figcaption></figure><h1 id="92cb" class="ol lf it bd lg om on oo lj op oq or lm os ot ou lp ov ow ox ls oy oz pa lv pb bi translated">摘要</h1><p id="f9a4" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">本教程向我们介绍了连接ArgoCD和我们的私有GitHub库的几个步骤。如果你是新手，可能会有点不知所措，但是你应该会很快上手，通过这篇教程，你应该会很快上手并且跑得很快😊。</p><h2 id="10c4" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">你想联系吗？</h2><p id="6350" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">如果你想联系我，请通过<a class="ae mu" href="https://www.linkedin.com/in/pascal-zwikirsch-3a95a1177/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="c598" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另外，请随意查看我的书籍推荐📚。</p></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><div class="kp kq kr ks gt mf"><a href="https://mr-pascal.medium.com/my-book-recommendations-4b9f73bf961b" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">我的书籍推荐</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">在接下来的章节中，你可以找到我对所有日常生活话题的书籍推荐，它们对我帮助很大。</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="mo l"><div class="pj l mq mr ms mo mt ky mf"/></div></div></a></div><div class="mc md gp gr me mf"><a href="https://mr-pascal.medium.com/membership" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">通过我的推荐链接加入Medium—Pascal Zwikirsch</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="mo l"><div class="pk l mq mr ms mo mt ky mf"/></div></div></a></div></div></div>    
</body>
</html>