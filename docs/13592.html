<html>
<head>
<title>Feedback on Electron JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对电子JS的反馈</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/feedback-on-electron-js-d8812c25f003?source=collection_archive---------15-----------------------#2022-09-18">https://levelup.gitconnected.com/feedback-on-electron-js-d8812c25f003?source=collection_archive---------15-----------------------#2022-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d313" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">IT建议</h2><div class=""/><div class=""><h2 id="6f2d" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">两年前，我有机会发现了电子框架，允许我在使用web语言创建界面的同时开发桌面应用程序。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/e479cb750595cef885192c146c66b658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wmuiwm5K6wucsz9mQNa4cQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">未画插图</figcaption></figure><p id="6f23" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">举个例子，在我上学的最后一年，在一个六人团队中，我们为校外的一个客户开发了一个票务应用程序。该应用程序的标准之一是它必须是一个桌面应用程序(必须在Windows上运行)。从历史上看，他们想要取代的应用程序是用C++开发的，并且使用了Qt库。然而，我们这个项目只有四周的开发时间，而且我们都不习惯这种语言。然后，我们寻找一种解决方案，允许我们使用我们更了解的技术。</p><p id="0307" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们发现了电子！</p><p id="5dd9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">然后，我们能够用Angular开发桌面应用程序的界面，用Java开发后端。由于电子只封装正面，背面的选择没有影响。注意，在这里，由于项目的需要，我们在本地有我们的后端，但是很可能调用外部API。我们选择使用Angular，但是Electron允许使用其他JS框架，比如React或Vue。</p><h1 id="3e76" class="md me it bd mf mg mh mi mj mk ml mm mn ki mo kj mp kl mq km mr ko ms kp mt mu bi translated">初始化项目</h1><p id="58cc" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">先决条件安装:<br/>如果您还没有安装Node.js，那么您必须安装它。</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="83ec" class="nf me it nb b gy ng nh l ni nj">npm install -g @angular/cli<br/>npm install electron-packager --save-dev</span></pre><p id="ced9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">第一个命令用于安装Angular CLI，用于创建和构建Angular应用程序。<br/>第二个用于安装一个电子打包程序，它允许您将电子应用程序的源代码打包成一个可执行文件。</p><p id="0ed7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">要初始化项目，请执行以下操作:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="7005" class="nf me it nb b gy ng nh l ni nj">ng new projet-angular<br/>cd projet-angular<br/>npm install electron --save-dev</span></pre><p id="be33" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这些命令用于创建Angular项目并在开发环境中安装electronic。</p><p id="84d7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">要用Electron配置Angular项目，您必须向项目的根目录添加一个这样的文件<code class="fe nk nl nm nb b">main.js</code>(文件的内容将在下面详述):</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="e422" class="nf me it nb b gy ng nh l ni nj">const { app, BrowserWindow, screen, ipcRenderer, ipcMain } = require('electron');</span><span id="7c21" class="nf me it nb b gy nn nh l ni nj">let primary;<br/>let secondary;</span><span id="8cd2" class="nf me it nb b gy nn nh l ni nj">app.on('ready', () =&gt; {<br/>  let displays = screen.getAllDisplays();<br/>  let externalDisplay = displays.find((display) =&gt; {<br/>    return display.bounds.x !== 0 || display.bounds.y !== 0<br/>  });</span><span id="aaf5" class="nf me it nb b gy nn nh l ni nj">  if (externalDisplay) {<br/>    secondary = new BrowserWindow({<br/>      fullscreen : true,<br/>      x: externalDisplay.bounds.x,<br/>      y: externalDisplay.bounds.y,<br/>      webPreferences: {<br/>        nodeIntegration: true,<br/>        nodeIntegrationInWorker: true<br/>      }<br/>    });</span><span id="2dd7" class="nf me it nb b gy nn nh l ni nj">    ipcMain.on('fromOne', (event, arg)  =&gt; {<br/>      secondary.webContents.send('toTwo', arg);<br/>    });</span><span id="55c1" class="nf me it nb b gy nn nh l ni nj">    secondary.setMenuBarVisibility(false);<br/>    secondary.loadURL(`file://${__dirname}/dist/frontend/index.html#/welcome-second-screen`);<br/>    secondary.on('closed', function () {<br/>      secondary = null<br/>    })<br/>  }</span><span id="a0db" class="nf me it nb b gy nn nh l ni nj">  primary = new BrowserWindow({<br/>    fullscreen : true,<br/>    webPreferences: {<br/>      nodeIntegration: true,<br/>      nodeIntegrationInWorker: true<br/>    }<br/>  });<br/>  primary.setMenuBarVisibility(false);</span><span id="82e3" class="nf me it nb b gy nn nh l ni nj">  primary.loadURL(`file://${__dirname}/dist/frontend/index.html#/auth`);</span><span id="cd23" class="nf me it nb b gy nn nh l ni nj">  primary.on('closed', function () {<br/>    primary = null<br/>  });<br/>});</span></pre><p id="b9bd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这个文件是Electron的入口点，定义了桌面应用程序如何对各种窗口事件做出反应。您还必须修改项目根目录下的文件<code class="fe nk nl nm nb b">package.json</code>添加以下几行:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="f18e" class="nf me it nb b gy ng nh l ni nj">[...]<br/>"main": "main.js",<br/>"description": "description de l'application",<br/>"scripts": {<br/>  [...]<br/>  "electron": "electron .",<br/>  "electron-build": "ng build &amp;&amp; electron .",<br/>  "electron-build-prod": "ng build --prod &amp;&amp; electron .",<br/>  "create-win-installer": "ng build --prod &amp;&amp; electron-packager . --platform=win32 --overwrite --asar=true &amp;&amp; node build.js"<br/>}<br/>[...]</span></pre><p id="6cc8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">注意，如果没有描述，应用程序的打包将不起作用。</p><p id="a0f1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">添加的不同脚本是示例。第一个用于运行包装在Electron中的应用程序，而不构建它。接下来的两个用于编译应用程序(使用dev环境的属性(默认情况下)或prod环境的属性)。第四个用于打包应用程序并为Windows创建安装介质。</p><p id="3f25" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">您还可以在web浏览器中运行应用程序(无需电子设备)，这允许热重新加载(修改后无需重新构建甚至刷新页面):</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="bf48" class="nf me it nb b gy ng nh l ni nj">npm run start</span></pre><h1 id="c410" class="md me it bd mf mg mh mi mj mk ml mm mn ki mo kj mp kl mq km mr ko ms kp mt mu bi translated">管理第二个屏幕</h1><p id="047f" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">电子允许管理多个窗口和多个屏幕。为此，通过模块<code class="fe nk nl nm nb b">screen</code>, Electron允许以如下方式恢复连接到计算机的屏幕:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="8f0d" class="nf me it nb b gy ng nh l ni nj">let displays = screen.getAllDisplays();<br/>let externalDisplay = displays.find((display) =&gt; {<br/>  return display.bounds.x !== 0 || display.bounds.y !== 0<br/>});</span><span id="1257" class="nf me it nb b gy nn nh l ni nj">if (externalDisplay) {<br/>... }</span></pre><p id="eaa0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从那里，我们可以检索第二个连接的屏幕并加载应用程序。</p><p id="4207" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如上面的文件所示，为了创建一个窗口，我们使用了<code class="fe nk nl nm nb b">BrowserWindow</code>。您可以指定与大小、位置和全屏模式相关的属性。</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="eb13" class="nf me it nb b gy ng nh l ni nj">secondary = new BrowserWindow({<br/>  width :800,<br/>  height : 480,<br/>  x: externalDisplay.bounds.x ,<br/>  y: externalDisplay.bounds.y ,<br/>  fullscreen : true<br/>});</span></pre><p id="fe54" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们还使用对象<code class="fe nk nl nm nb b">BrowserWindow</code> <em class="no"> </em>上的函数<code class="fe nk nl nm nb b">loadUrl</code>指定窗口必须加载的资源:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="858b" class="nf me it nb b gy ng nh l ni nj">secondary.loadURL(`file://${__dirname}/dist/angular-electron/index.html#/second-route`)</span></pre><p id="9bd3" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有可能我们需要让两个屏幕进行通信。为此，您可以通过此命令<code class="fe nk nl nm nb b">npm install ngx-electron --save</code>使用模块<code class="fe nk nl nm nb b">ngx-electron</code>。</p><p id="6369" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们首先向由<code class="fe nk nl nm nb b">BrowserWindow</code> <em class="no"> </em>实例化的窗口添加属性<code class="fe nk nl nm nb b">webPreferences</code>:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="6056" class="nf me it nb b gy ng nh l ni nj">secondary = new BrowserWindow({<br/>  width :800,<br/>  height : 480,<br/>  x: externalDisplay.bounds.x ,<br/>  y: externalDisplay.bounds.y ,<br/>  fullscreen : true,<br/>  webPreferences: {<br/>    nodeIntegration: true,<br/>    nodeIntegrationInWorker: true<br/>  }<br/>});</span></pre><p id="5e9c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们通过电子模块<code class="fe nk nl nm nb b">ipcMain</code> <em class="no"> </em>和<code class="fe nk nl nm nb b">ipcRenderer</code>实现信息的交换。我们考虑屏幕<code class="fe nk nl nm nb b">primary</code>和<code class="fe nk nl nm nb b">secondary</code>。我们在文件<code class="fe nk nl nm nb b">main.js</code>中添加了以下函数:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="9a92" class="nf me it nb b gy ng nh l ni nj">ipcMain.on('fromOne', (event, arg)  =&gt; {<br/>  secondary.webContents.send('toTwo', arg);<br/>});</span></pre><p id="2077" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">假设我们有一个如下所示的应用程序:<br/>这个窗口出现在第一个屏幕上:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi np"><img src="../Images/15af7428d79999829d227a8655f17b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/0*sDIlmrvWHq4_K7B7.png"/></div></figure><p id="3de9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这个出现在第二个屏幕上:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/5a2193eb7e1c07ac858143f4d8e98894.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/0*dbgH2sbqL6DSsEN-.png"/></div></figure><p id="b097" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">请注意，在这里我保留了应用程序的窗口，并保留了菜单栏的可见性，但是可以使用<code class="fe nk nl nm nb b">main.js</code>中<code class="fe nk nl nm nb b">BrowserWindow</code>的属性<code class="fe nk nl nm nb b">fullscreen</code>和<code class="fe nk nl nm nb b">setMenuBarVisibility</code> <em class="no"> </em>来初始化全屏窗口。</p><p id="f5f9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">此时，配置已经设置好，但是窗口之间还没有交互。为此，在屏幕使用的组件<code class="fe nk nl nm nb b">primary</code> <em class="no">，</em>中，我们添加了我们在构造函数中初始化的服务<code class="fe nk nl nm nb b">ngx-electron</code>的导入:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="21c9" class="nf me it nb b gy ng nh l ni nj">import {ElectronService} from 'ngx-electron';<br/>...<br/>constructor(private _electronService: ElectronService) { }</span></pre><p id="1915" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了从主窗口发送消息，我们定义了以下函数，当点击<em class="no">发送到第二个屏幕</em>按钮时将调用该函数:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="0b26" class="nf me it nb b gy ng nh l ni nj">toSend(){<br/>  this._electronService.ipcRenderer.send("fromOne",this.data);<br/>}</span></pre><p id="6497" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在屏幕<code class="fe nk nl nm nb b">secondary</code>使用的组件中，我们为屏幕<code class="fe nk nl nm nb b">primary</code>添加了使用服务<code class="fe nk nl nm nb b">ngx-electron</code>的导入和构造器:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="1b65" class="nf me it nb b gy ng nh l ni nj">import {ElectronService} from 'ngx-electron';<br/>...<br/>constructor(private _electronService: ElectronService) { }</span></pre><p id="dcc7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们定义以下函数来接收消息:</p><pre class="ks kt ku kv gt na nb nc nd aw ne bi"><span id="2eb2" class="nf me it nb b gy ng nh l ni nj">ngOnInit() {<br/>  this._electronService.ipcRenderer.on("toTwo", (event, args) =&gt; {<br/>    this.zone.run(() =&gt; {<br/>      this.message = args;<br/>    });<br/>  });<br/>}</span></pre><p id="5b3e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在添加这些内容之后，当单击按钮时，消息被发送到另一个屏幕，并显示出来。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/0f6e9cdaf6a76d873dee6cc11becaacf.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/0*lM5Al4jlP8kr3j_H.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/6514603c507a0c87fba973dc45a0405a.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/0*Rwa4SBmLry2AbUTJ.png"/></div></figure><p id="7017" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从安全角度来看，通过电子进行开发需要更加小心，因为电子不是网络浏览器。在这里，用户可以访问文件系统、用户外壳等。因此，确保您的应用程序不运行来自不受信任的外部来源的代码非常重要。有关电子安全的更多信息和建议，请参考电子文档:<a class="ae nt" href="https://www.electronjs.org/docs/latest/tutorial/security" rel="noopener ugc nofollow" target="_blank">https://www.electronjs.org/docs/latest/tutorial/security</a></p><p id="73cb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对电子的一个普遍批评是它很重。事实上，它装载了大量的铬，所以没有办法让一个电子应用程序真正轻量级。因此，如果你的问题之一是使用很少的内存，电子可能不是最好的解决方案。</p><h1 id="530c" class="md me it bd mf mg mh mi mj mk ml mm mn ki mo kj mp kl mq km mr ko ms kp mt mu bi translated">最后</h1><p id="f65e" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">如果您还不熟悉Electron，您很可能知道一个或多个使用该框架的桌面应用程序，比如Discord、Atom、Visual Studio Code或Twitch。</p><p id="aea0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本文中，我们看到了如何初始化一个电子包裹的角度项目。这个框架允许你做各种各样的事情，就像我们看到的第二个屏幕的管理一样。在继续使用web语言的同时开发桌面应用是一个非常好的解决方案。然而，像任何技术一样，在选择它之前，有必要考虑所面临的问题(例如，内存的使用)。</p><p id="a16b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> <em class="no">附言</em> </strong> <em class="no">在过去的3个月里，我已经挣了1000多美元。如果你也想在媒体上写作赚钱，我们建议你注册成为一名会员。</em>  <em class="no">每月只需5美元。这样，你不仅有机会写作和赚钱，还可以无限制地接触像这样的故事。</em></p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="6c2b" class="md me it bd mf mg ob mi mj mk oc mm mn ki od kj mp kl oe km mr ko of kp mt mu bi translated">分级编码</h1><p id="b1be" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="7d46" class="og oh it lj b lk ll ln lo lq oi lu oj ly ok mc ol om on oo bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="e000" class="og oh it lj b lk op ln oq lq or lu os ly ot mc ol om on oo bi translated">📰查看<a class="ae nt" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="523c" class="og oh it lj b lk op ln oq lq or lu os ly ot mc ol om on oo bi translated">🔔关注我们:<a class="ae nt" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae nt" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae nt" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="2453" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">🚀👉<a class="ae nt" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">加入升级人才集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>