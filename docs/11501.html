<html>
<head>
<title>How to Fix UnicodeEncodeError: 'ascii' codec can't encode character in Python and Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何修复unicode encoded error:“ascii”编解码器无法对Python和Pandas中的字符进行编码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/fix-unicodeencodeerror-ascii-codec-pandas-e525d26fa6ed?source=collection_archive---------4-----------------------#2022-03-22">https://levelup.gitconnected.com/fix-unicodeencodeerror-ascii-codec-pandas-e525d26fa6ed?source=collection_archive---------4-----------------------#2022-03-22</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="acec" class="pw-subtitle-paragraph jv it iu bd b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dk translated">了解如何摆脱<code class="fe jr js jt ju b">UnicodeEncodeError when working with strings in Python and Pandas</code></h2></div><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gi gj kn"><img src="../Images/5c6b7e8f0a7de7486b21fef7d281dc53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GQkmlGDH8-KALtr693gXLw.jpeg"/></div></div><figcaption class="kz la gk gi gj lb lc bd b be z dk translated">Philipp Katzenberger 在<a class="ae ld" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="dbb5" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">介绍</h2><p id="9984" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">使用unicode字符时出现的一个非常常见的Python错误是<code class="fe jr js jt ju b">UnicodeEncodeError</code>。</p><pre class="ko kp kq kr gu mt ju mu mv aw mw bi"><span id="9e9c" class="le lf iu ju b gz mx my l mz na">UnicodeEncodeError: 'ascii' codec can't encode character u'\u03b1' in position 20: ordinal not in range(128)</span></pre><p id="0da3" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">此外，当将熊猫数据帧写入<code class="fe jr js jt ju b">csv</code>文件时，一个常见的缺陷是字符编码。特别是，<code class="fe jr js jt ju b">to_csv()</code>也可能触发<code class="fe jr js jt ju b">UnicodeEncodeError</code>。</p><p id="f28a" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">在今天的简短指南中，我们将讨论字符编码以及如何在使用<code class="fe jr js jt ju b">to_csv</code>将dfs写入CSV文件时指定字符编码。此外，我们将探索几种不同的解决上述错误的方法。</p><p id="d52a" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">请注意，这个问题主要与Python 2 用户有关。</p></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="e832" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">重现错误</h2><p id="31bf" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">现在让我们启动Python 2终端并创建一个unicode字符串。</p><pre class="ko kp kq kr gu mt ju mu mv aw mw bi"><span id="15da" class="le lf iu ju b gz mx my l mz na">&gt;&gt;&gt; my_str = u'Hey y\u00E0'<br/>&gt;&gt;&gt; my_str<br/>u'Hey y\xe0'</span></pre><p id="7742" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">现在，如果我们试图用<code class="fe jr js jt ju b">my_str</code>调用<code class="fe jr js jt ju b">str()</code>方法，就会出现一个错误:</p><pre class="ko kp kq kr gu mt ju mu mv aw mw bi"><span id="b7af" class="le lf iu ju b gz mx my l mz na">&gt;&gt;&gt; str(my_str)<br/>Traceback (most recent call last):<br/>  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br/><strong class="ju iv">UnicodeEncodeError: 'ascii' codec can't encode character u'\xe0' in position 5: ordinal not in range(128)</strong></span></pre></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="cf12" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">检查您的Python版本</h2><p id="49e6" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">您可能想使用Python 3，但是您运行的是Python 2，这可能就是您的代码会出现上述问题的原因。</p><p id="4107" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">您可以使用<code class="fe jr js jt ju b">python --version</code>命令来检查您正在本地运行的Python版本。举个例子，</p><pre class="ko kp kq kr gu mt ju mu mv aw mw bi"><span id="f3f1" class="le lf iu ju b gz mx my l mz na">$ python --version<br/>Python 3.7.7</span></pre><p id="d9c7" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">如果您错误地使用了Python 2，那么请确保将默认版本更改为3。或者，您可以通过调用<code class="fe jr js jt ju b">python3 ...</code>来使用Python 3。</p></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="7449" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">编码字符串</h2><p id="9e74" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">现在，如果您仍然希望(或者无法避免)使用Python 2，那么您需要对您的字符串进行适当的编码。我们之前再现的<code class="fe jr js jt ju b">UnicodeEncodeError</code>是由于这样一个事实:当调用<code class="fe jr js jt ju b">str()</code>方法时，解释器将使用默认的字符编码来编码输入字节(在我们的例子中，这些是unicode字符)。</p><p id="5e48" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">为了消除错误，您应该显式指定所需的编码。这可以通过使用<code class="fe jr js jt ju b"><a class="ae ld" href="https://docs.python.org/3/library/stdtypes.html#str.encode" rel="noopener ugc nofollow" target="_blank">encode()</a></code>方法来实现，如下所示。在大多数情况下，<code class="fe jr js jt ju b">utf-8</code>编码会起作用。</p><pre class="ko kp kq kr gu mt ju mu mv aw mw bi"><span id="0a60" class="le lf iu ju b gz mx my l mz na">&gt;&gt;&gt; my_str.encode('utf-8')<br/>&gt;&gt;&gt; print(my_str.encode('utf-8'))<br/>Hey yà</span></pre></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="958f" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">与熊猫一起工作时处理UnicodeError错误</h2><p id="0a6d" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">现在，当使用<code class="fe jr js jt ju b"><a class="ae ld" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html" rel="noopener ugc nofollow" target="_blank">pandas.DataFrame.to_csv()</a></code>方法将熊猫数据帧写入CSV文件时，您也有机会获得<code class="fe jr js jt ju b">UnicodeEncodeError</code>。</p><p id="6c6a" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">如果是这种情况，那么您需要做的就是在调用对应于输出文件中使用的编码的<code class="fe jr js jt ju b">to_csv</code>时传递<code class="fe jr js jt ju b">encoding</code>参数。</p><pre class="ko kp kq kr gu mt ju mu mv aw mw bi"><span id="268f" class="le lf iu ju b gz mx my l mz na">my_df.to_csv('output.csv', encoding='utf-8')</span></pre></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="d810" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">在今天的文章中，我们讨论了最常见的错误之一，即<code class="fe jr js jt ju b">UnicodeEcnodeError</code>的潜在解决方案，以及如何通过正确处理unicode字符和字符串来消除它。</p><p id="2fd6" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated">此外，我们展示了如何在pandas的上下文中解决这个问题，使用了一个示例，其中负责将pandas数据帧写入CSV文件的<code class="fe jr js jt ju b">to_csv()</code>方法可能会引发这个错误。</p></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated"><a class="ae ld" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="mc iv">成为会员</strong> </a> <strong class="mc iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="nn no gq gs np nq"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="nr ab fp"><div class="ns ab nt cl cj nu"><h2 class="bd iv gz z fq nv fs ft nw fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="nx l"><h3 class="bd b gz z fq nv fs ft nw fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ny l"><p class="bd b dl z fq nv fs ft nw fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe kx nq"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph ma mb iu mc b md nb jz mf mg nc kc mi ln nd mk ml lr ne mn mo lv nf mq mr ms in bi translated"><strong class="mc iv">你可能也会喜欢</strong></p><div class="nn no gq gs np nq"><a href="https://towardsdatascience.com/fix-pandas-parser-error-tokenizing-data-889167292d38" rel="noopener follow" target="_blank"><div class="nr ab fp"><div class="ns ab nt cl cj nu"><h2 class="bd iv gz z fq nv fs ft nw fv fx it bi translated">如何修复pandas.parser.CParserError:标记数据时出错</h2><div class="nx l"><h3 class="bd b gz z fq nv fs ft nw fv fx dk translated">了解在pandas中读取CSV文件时出现错误的原因以及如何处理该错误</h3></div><div class="ny l"><p class="bd b dl z fq nv fs ft nw fv fx dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="of l ob oc od nz oe kx nq"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><div class="ko kp kq kr gu nq"><a href="https://towardsdatascience.com/augmented-assignments-python-caa4990811a0" rel="noopener follow" target="_blank"><div class="nr ab fp"><div class="ns ab nt cl cj nu"><h2 class="bd iv gz z fq nv fs ft nw fv fx it bi translated">Python中的扩充赋值</h2><div class="nx l"><h3 class="bd b gz z fq nv fs ft nw fv fx dk translated">了解增强赋值表达式在Python中的工作方式，以及为什么在使用它们时要小心…</h3></div><div class="ny l"><p class="bd b dl z fq nv fs ft nw fv fx dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="og l ob oc od nz oe kx nq"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><div class="ko kp kq kr gu nq"><a href="https://towardsdatascience.com/python-linked-lists-c3622205da81" rel="noopener follow" target="_blank"><div class="nr ab fp"><div class="ns ab nt cl cj nu"><h2 class="bd iv gz z fq nv fs ft nw fv fx it bi translated">如何在Python中实现链表</h2><div class="nx l"><h3 class="bd b gz z fq nv fs ft nw fv fx dk translated">探索如何使用Python从头开始编写链表和节点对象</h3></div><div class="ny l"><p class="bd b dl z fq nv fs ft nw fv fx dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="oh l ob oc od nz oe kx nq"/></div></div></a></div></div></div>    
</body>
</html>