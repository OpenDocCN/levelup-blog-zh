<html>
<head>
<title>iOS App As a Microservice. Modularize Your App With Tuist</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS App即微服务。使用Tuist模块化您的应用</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ios-app-as-a-microservice-modularize-your-app-with-tuist-f706e8fae650?source=collection_archive---------3-----------------------#2022-10-10">https://levelup.gitconnected.com/ios-app-as-a-microservice-modularize-your-app-with-tuist-f706e8fae650?source=collection_archive---------3-----------------------#2022-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="26a3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这是模块化应用程序架构系列的第二篇文章。在这篇文章中，我将介绍使用Tuist的实现细节</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f986780fdc8b5d58b32a8e13dee29c7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQ2-jsGE2odZUY_TNyV__w.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">弗拉多·保诺维奇 / <a class="ae kv" href="https://unsplash.com/?utm_source=ghost&amp;utm_medium=referral&amp;utm_campaign=api-credit" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>摄影</figcaption></figure><p id="f6c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是模块化应用程序架构系列的第二篇文章。在这篇文章中，我将使用<strong class="ky ir"> Tuist </strong>讲述实现细节。这是一个优秀的命令行工具，可以帮助您生成、维护Xcode项目并与之交互。</p><blockquote class="ls lt lu"><p id="a7ff" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💥我在上一篇文章中介绍了模块化架构的核心思想。<br/>如果你还没有，就去看看吧！</p></blockquote><div class="lz ma gp gr mb mc"><a href="https://alexdremov.me/ios-app-as-a-microservice-build-robust-app-architecture/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">iOS App即微服务。构建强大的应用架构</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">MVVM，MVC，毒蛇，你会怎么选择？这些都是局部的和特定的问题…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">alexdremov.me</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq kp mc"/></div></div></a></div><h1 id="893b" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">下一步是什么？</h1><p id="9c2c" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">在本系列的下一篇也是最后一篇文章中，我将介绍SwiftUI的实现技巧。订阅吧，这样你就不会错过了</p><p id="7e89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">UPD:活在当下！</p><div class="lz ma gp gr mb mc"><a href="https://alexdremov.me/ios-app-as-a-microservice-using-swiftui-in-modular-app/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">iOS App即微服务。在模块化应用中使用SwiftUI</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">Alex Dremov iniOS &amp; Swift——模块化架构非常出色。但是如何用SwiftUI有效实现呢…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">alexdremov.me</p></div></div><div class="ml l"><div class="no l mn mo mp ml mq kp mc"/></div></div></a></div><h1 id="eaa0" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">为什么是Tuist？</h1><p id="8c91" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">它鼓励您进一步代码模块化，因为它提供了一种优雅的方式来为不同的模块创建单独的Xcode项目，使得紧密耦合或隐式依赖变得不太可行</p><p id="7d11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，这对团队合作也很有好处。你有没有尝试过将Xcode项目委托给GitHub这样的VCS？</p><p id="cd7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">真是一团糟</p><p id="0e44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">修改后的Xcode项目的Diff不是人类可读的。根本不可能追踪变更或审查PR。如果可以在一个简单的配置文件中定义Xcode项目会怎么样？Tuist就是这么做的。而且<strong class="ky ir">tuist</strong>T11】配置文件是用Swift 编写的。</p><h1 id="6bdc" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">我们的目标</h1><p id="433b" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">我们希望根据我在上一篇文章中提出的架构，将我们的项目划分为单独的Xcode项目。</p><p id="bba5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再次重申，我们的应用程序将由模块的组合组成，对于每个模块或功能，我们将创建一个新的Tuist项目。</p><blockquote class="ls lt lu"><p id="83db" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💡请记住，每个功能不应该依赖于其他功能的实现。只有接口应该是公共的</p></blockquote><p id="8d6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，对于每个特性，我们将创建几个与特性接口、实现以及测试或模拟目标(如果需要的话)相对应的目标。</p><h1 id="d8a1" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">定义项目</h1><blockquote class="ls lt lu"><p id="8a0d" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💥这篇文章的来源发表在GitHub上。因此，在阅读本文之前，您可以看到使用Tuist描述项目是多么优雅</p></blockquote><div class="lz ma gp gr mb mc"><a href="https://github.com/AlexRoar/TuistExample" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">GitHub-Alex roar/Tuist示例:将Tuist用于模块化应用架构</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">github.com</p></div></div><div class="ml l"><div class="np l mn mo mp ml mq kp mc"/></div></div></a></div><h1 id="4694" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">结构</h1><p id="b175" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">Tuist项目是一个简单的文件夹，包含描述工作空间结构的配置文件</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><blockquote class="ls lt lu"><p id="eae6" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💥使用<code class="fe ns nt nu nv b">tuist edit</code>编辑您的Tuist文件。这将为您生成并打开一个临时Xcode项目</p></blockquote><p id="e61a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是正如我前面所说的，<em class="lv">每个</em>模块至少应该有一个实现和接口目标</p><blockquote class="ls lt lu"><p id="2f42" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💡可能存在包含公共工具并且不依赖于任何其他模块的模块。那么，它可能只有实现</p></blockquote><p id="b93a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，让我们据此修改结构</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="ae04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在定义模块之前，我们需要定义Tuist应该在哪里搜索这些模块。这可以在<code class="fe ns nt nu nv b">Workspace.swift</code>文件中完成</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h2 id="fd77" class="nw ms iq bd mt nx ny dn mx nz oa dp nb lf ob oc nd lj od oe nf ln of og nh oh bi translated">项目文件</h2><p id="e197" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">Tuist用一个简单的Swift文件定义了Xcode项目。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="6ade" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是这篇文章不仅仅是对Tuist的评论</p><p id="60c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们定义一个项目，知道我们需要有一个接口和实现目标。同样，让我们为特性名创建一个枚举，这样我们就不必使用字符串并记住所有的命名</p><blockquote class="ls lt lu"><p id="d639" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💡由于config是在Swift中定义的，因此在定义项目结构时，您可以使用Xcode中的建议和自动完成功能。<br/> <br/>例如，Xcode在使用枚举时会建议其他模块的名称</p></blockquote><p id="1668" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过几个简单的助手，我们可以用Swift的魅力定义项目结构:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="4d4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特性将成为独立的框架。</p><blockquote class="ls lt lu"><p id="8c32" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💡所有有助于描述tuist配置的<code class="fe ns nt nu nv b">swift</code>文件都应放在<code class="fe ns nt nu nv b">ProjectDescriptionHelpers</code>文件夹中</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="72fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们可以定义什么是特征</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="bd28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们在一个应用程序目标中组合模块。它的定义是一样的</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="bcd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样。</p><p id="6466" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以创建不同的特征和它们之间的状态依赖关系。之后，我们只需使用<code class="fe ns nt nu nv b">tuist generate</code>命令，它就会为我们生成Xcode工作空间和Xcode项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/dfc538a3f424c9af61485ce3c61f57e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KK0mSz30YICplyIQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Tuist生成的工作空间</figcaption></figure><p id="aa0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！</p><p id="2eab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经启动了我们的项目，它在漂亮的Swift文件中被完全定义，具有清晰的结构和明确的依赖关系。你可以将所有的<code class="fe ns nt nu nv b">.xcodeproj</code>和<code class="fe ns nt nu nv b">.xcworkspace</code>添加到gitignore，忘记GitHub仓库中的混乱。</p><blockquote class="ls lt lu"><p id="9781" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">💥为了这篇文章的简洁，一些细节没有涉及。完整的例子发布在GitHub上，请不要犹豫在评论中问我任何问题！</p></blockquote><div class="lz ma gp gr mb mc"><a href="https://github.com/AlexRoar/TuistExample" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">GitHub-Alex roar/Tuist示例:将Tuist用于模块化应用架构</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">github.com</p></div></div><div class="ml l"><div class="np l mn mo mp ml mq kp mc"/></div></div></a></div><h1 id="7a6a" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">使用Tuist创建应用程序</h1><p id="b3bc" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">我已经在上面的例子中展示了如何定义项目结构。让我们更具体地编写一个简单的应用程序，显示一个范围内的随机值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/510f28cf93a0175f5db6ffe2ff3b0f18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*VR1jUN92eQ7etBxZzWaPoA.png"/></div></figure><p id="a40c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> RandomProvider </strong>定义了生成随机数的协议及其几种实现</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b87d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> RandomScreen </strong>定义了几个UI屏幕来显示随机数并重新生成。请注意，它仅取决于<strong class="ky ir">随机提供者接口</strong>，而不取决于作为实现的<strong class="ky ir">随机提供者</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="5db5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">常用</strong>是提供常用工具的模块。实际上，它只被应用程序模块使用，但是我想展示许多模块可以依赖它</p><p id="9363" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> ExampleApp </strong>是一个App模块，结合其他模块，构建最终的app</p><p id="d981" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是唯一可以依赖于其他模块实现的模块。此外，它会根据场景选择使用哪种实现。在示例应用程序中，<code class="fe ns nt nu nv b">NumberProvider</code>实现在运行时被更改</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h1 id="a7a4" class="mr ms iq bd mt mu or mw mx my os na nb jw ot jx nd jz ou ka nf kc ov kd nh ni bi translated">最终注释</h1><p id="ac92" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">因此，在这篇文章中，我们使用Tuist构建了微功能或模块化应用程序。在示例项目中，我添加了有用的工具，如</p><ul class=""><li id="4b63" class="ow ox iq ky b kz la lc ld lf oy lj oz ln pa lr pb pc pd pe bi translated">对默认信息列表的补充</li><li id="f247" class="ow ox iq ky b kz pf lc pg lf ph lj pi ln pj lr pb pc pd pe bi translated">用于创建可由<br/> <code class="fe ns nt nu nv b">tuist scaffold framework --name ModuleName</code>调用的新特征的模板。这将创建新的模块文件夹Project.swift文件</li><li id="bc12" class="ow ox iq ky b kz pf lc pg lf ph lj pi ln pj lr pb pc pd pe bi translated">为发布模式而构建。您可以使用环境变量调用生成，这将使所有模块成为静态的。使用静态框架提高了应用程序的速度，有利于生产。<br/> <code class="fe ns nt nu nv b">TUIST_BUILD_TYPE_RELEASE=TRUE tuist generate --no-cache</code></li></ul><p id="e2a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，如果您还没有读过我关于模块化架构概述的文章，请查看一下！</p><div class="lz ma gp gr mb mc"><a href="https://alexdremov.me/ios-app-as-a-microservice-build-robust-app-architecture/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">iOS App即微服务。构建强大的应用架构</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">MVVM，MVC，毒蛇，你会怎么选择？这些都是局部的和特定的问题…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">alexdremov.me</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq kp mc"/></div></div></a></div><p id="62f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要犹豫，在评论中提出任何问题</p><pre class="kg kh ki kj gt pk nv pl pm aw pn bi"><span id="e5ee" class="nw ms iq nv b gy po pp l pq pr">This post was originally published on <a class="ae kv" href="https://alexdremov.me/ios-app-as-a-microservice-modularize-your-app-with-tuist/" rel="noopener ugc nofollow" target="_blank">alexdremov.me</a></span><span id="8905" class="nw ms iq nv b gy ps pp l pq pr">Check out my blog!</span></pre><h1 id="1efe" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">参考</h1><div class="lz ma gp gr mb mc"><a href="https://tuist.io/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">类固醇上的xcode | Tuist</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">Tuist是一个通过利用项目生成来帮助开发人员管理大型Xcode项目的工具。此外，它…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">tuist.io</p></div></div><div class="ml l"><div class="pt l mn mo mp ml mq kp mc"/></div></div></a></div></div></div>    
</body>
</html>