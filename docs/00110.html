<html>
<head>
<title>Making a submit button with loader — WotW</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用加载器制作提交按钮— WotW</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/making-a-submit-button-with-loader-wotw-85d7aaddd148?source=collection_archive---------1-----------------------#2018-04-11">https://levelup.gitconnected.com/making-a-submit-button-with-loader-wotw-85d7aaddd148?source=collection_archive---------1-----------------------#2018-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a68ac68df03f2506b3d74506ab6b1f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pWmpqfs5uEBCoItT8w7xig.jpeg"/></div></div></figure><p id="ceee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">欢迎来到本周系列<strong class="ka ir">小部件的第二部分。</strong></p><blockquote class="kw kx ky"><p id="232a" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">查看本周所有的<a class="ae ld" rel="noopener ugc nofollow" target="_blank" href="https://levelup.gitconnected.com/wotw/home"> Widget文章</a>，关注gitconnected，确保你不会错过任何Widget教程。</p></blockquote><p id="82f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这次我将向您展示制作一个<strong class="ka ir">提交按钮</strong>的过程，该按钮会转换成一个<strong class="ka ir">加载器</strong>，然后确认您的提交。</p><p id="7125" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个小工具的灵感来自于<a class="ae ld" href="https://uimovement.com/ui/2380/submit-button/" rel="noopener ugc nofollow" target="_blank"> this </a>，其表现类似于下面的礼物:</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/43d5650e76b847438ba25678583d6efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/0*tjk7e3KP2qoE8mcQ.gif"/></div></div></figure><h2 id="8a68" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">准备</h2><p id="7d90" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">对于今天的小工具，我们将使用<a class="ae ld" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> vue.js </a>和<a class="ae ld" href="https://greensock.com/tweenlite" rel="noopener ugc nofollow" target="_blank"> tweenlite </a>制作动画。两个库都有一个cdn链接，可以导入到任何项目中。</p><h2 id="ac60" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">HTML结构</h2><p id="c7d7" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">这个小部件的标记非常简单。我们只需要一个容器来装载我们的Vue实例，在这个容器中，将有一个按钮和几个SVG圆圈用于加载动画:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="c64d" class="lj lk iq mi b gy mm mn l mo mp">&lt;div id="submit-button" class="submit-container"&gt;<br/>  &lt;div class="submit-btn"&gt;<br/>    &lt;span&gt;Submit&lt;/span&gt;    <br/>  &lt;/div&gt;<br/>  <br/>  &lt;!--  grey circle  --&gt;<br/>  &lt;svg class="loader-svg"&gt;<br/>    &lt;path stroke="#CCCCCC" fill="none" stroke-width="4" d="M25,2.5A22.5,22.5 0 1 1 2.5,25A22.5,22.5 0 0 1 25,2.5"&gt;&lt;/path&gt;<br/>  &lt;/svg&gt;<br/>  <br/>  &lt;!--  green circle  --&gt;<br/>  &lt;svg class="loader-svg"&gt;<br/>    &lt;path stroke="#20BF7E" fill="none" stroke-width="4" d="M25,2.5A22.5,22.5 0 1 1 2.5,25A22.5,22.5 0 0 1 25,2.5"&gt;&lt;/path&gt;<br/>  &lt;/svg&gt;<br/>&lt;/div&gt;</span></pre><p id="06dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们开始将按钮的样式与这些CSS规则相匹配:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="4a05" class="lj lk iq mi b gy mm mn l mo mp">.submit-container {<br/>  position: relative;<br/>  margin: 80px;<br/>}<br/><br/>.submit-btn {<br/>  width: 100px;<br/>  color: #20BF7E;<br/>  font-size: 20px;<br/>  font-family: Arial;<br/>  text-align: center;<br/>  text-decoration: none;<br/>  padding: 10px 20px 10px 20px;<br/>  border: solid #20BF7E 4px;<br/>  text-decoration: none;<br/>  cursor: pointer;<br/>  border-radius: 25px;<br/>  transition: background-color .3s, color .3s;<br/>}<br/><br/>.submit-btn:hover {<br/>  background-color: #20BF7E;<br/>  color: white;<br/>}</span></pre><p id="19f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在有一个按钮，它有一个<em class="kz">悬停</em>动画，可以在绿色背景和白色字体之间交换颜色。还要注意25px的边框半径属性——当我们需要按钮变成一个圆形时，这非常重要。</p><h2 id="b4b9" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">互动逻辑</h2><p id="5798" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">在我们初始化Vue实例之前，我想检查一下按钮的状态。我们可以忽略悬停，因为我们的CSS已经解决了这个问题，留给我们三种状态:点击，加载和已加载。要处理这些问题，我们可以从以下内容开始:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="e444" class="lj lk iq mi b gy mm mn l mo mp">new Vue({<br/>  el: '#submit-button',<br/>  data: {<br/>    clicked: false,    <br/>    loading: false,<br/>    loaded: false<br/>  }<br/>})</span></pre><p id="d823" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可能会问“为什么是三个布尔值，而不是一个包含三个值的字符串或数字？”，原因是因为它们不是互斥的，换句话说，按钮可以同时被“点击”和“加载”。</p><h2 id="2988" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">点击互动</h2><p id="4d37" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">在准备单击动画时，我们首先需要为按钮创建一个CSS规则。当点击它时，它会变成一个圆，准确地说是一个50px乘50px的圆(还记得25px的边框半径吗？).问题是它已经声明了一个填充，我们还需要补偿按钮的边框，所以我们需要一点数学知识:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="af9c" class="lj lk iq mi b gy mm mn l mo mp">.submit-btn {<br/>  ... other rules<br/>  /* more CSS transitions for the props we need to animate */<br/>  transition: width .3s, margin .3s, background-color .3s, color .3s;<br/>}<br/>.submit-btn.round {<br/>  margin-left: 50px;<br/>  border-color: #CCCCCC;<br/>  background: white;<br/>  <br/>  /*  circle should be 50px width &amp; height */<br/>  /* borderLeft + paddingLeft + paddingRight + borderRight  */<br/>  /* 4 + 20 + 20 + 4 = 48 + 2 = 50 */<br/>  width: 2px; <br/>  /* borderTop + paddingTop + paddingBottom + borderBottom  */<br/>  /* 4 + 10 + 10 + 4 = 28 + 22 = 50 */<br/>  height: 22px;<br/>}</span></pre><p id="8d8c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以开始将按钮绑定到Vue，我们首先将click绑定到一个方法，将round类绑定到一个计算属性，并且当我们单击按钮时，提交文本需要消失:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="84c5" class="lj lk iq mi b gy mm mn l mo mp">...<br/>&lt;div <br/>  @click="clickedSubmit" <br/>  :class="buttonClass"<br/>  class="submit-btn"&gt;<br/>    &lt;span v-show="!clicked"&gt;Submit&lt;/span&gt;  <br/>...<br/>```<br/>Then in our js:<br/>``` js<br/>...<br/>methods: {<br/>  clickedSubmit () {<br/>    this.clicked = true<br/>  }<br/>},<br/>computed: {<br/>  buttonClass () {<br/>    if (this.clicked) {<br/>      return 'round'<br/>    }<br/>    return ''<br/>  }<br/>}</span></pre><p id="f2e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很简单，对吧？现在到了棘手的部分。</p><h2 id="86d3" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">装载</h2><p id="184b" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">就在我们的按钮变成一个圆之后，我们需要把我们的SVG圆放在上面——为什么？—因为HTML边框不能像我们需要的那样动画化，但是SVG可以！</p><p id="994a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们将圆圈的位置与CSS匹配起来:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="6994" class="lj lk iq mi b gy mm mn l mo mp">.loader-svg {<br/>  pointer-events: none;<br/>  position: absolute;<br/>  top: 0px;<br/>  left: 50px;<br/>  width: 50px; <br/>  height: 50px; <br/>  transform-origin: 25px 25px 25px;<br/>}</span></pre><p id="5fd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，两个SVG圆都将有这个vue绑定，使它们在按钮开始加载时出现:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="9195" class="lj lk iq mi b gy mm mn l mo mp">&lt;!--  grey circle  --&gt;<br/>  &lt;svg v-if="loading" class="loader-svg"&gt;<br/>    ...<br/>  &lt;/svg&gt;<br/>  <br/>  &lt;!--  green circle  --&gt;<br/>  &lt;svg v-if="loading" class="loader-svg"&gt;<br/>    ...<br/>  &lt;/svg&gt;</span></pre><p id="2912" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要知道按钮动画何时结束，这样我们就可以开始加载动画，根据<a class="ae ld" href="https://developer.mozilla.org/en-US/docs/Web/Events/transitionend" rel="noopener ugc nofollow" target="_blank"> MDN web docs </a>我们可以使用<code class="fe mq mr ms mi b">transitionend</code>事件。要在Vue中为该事件添加一个监听器，我们需要有一个对submit按钮的引用，所以我们需要将这一行添加到我们的按钮HTML:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="c3ca" class="lj lk iq mi b gy mm mn l mo mp">&lt;div class="submit-btn" <br/>  ref="submit-btn"<br/>  ...<br/>&gt;</span></pre><p id="530c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以像这样在我们的<code class="fe mq mr ms mi b">clickedSubmit</code>方法中引用它:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="d354" class="lj lk iq mi b gy mm mn l mo mp">...<br/>clickedSubmit () {<br/>this.clicked = true<br/>this.$refs['submit-btn']<br/>.addEventListener("transitionend", this.animateLoader, false);<br/>}<br/>...</span></pre><p id="22aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在动画结束时触发<code class="fe mq mr ms mi b">animateLoader</code>方法，所以让我们创建方法:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="70b3" class="lj lk iq mi b gy mm mn l mo mp">animateLoader () {<br/>  this.loading = true<br/>  this.$refs['submit-btn']<br/>    .removeEventListener("transitionend", this.animateLoader, false);<br/>  // TODO animate circles<br/>}</span></pre><p id="2a96" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将把<code class="fe mq mr ms mi b">loading</code>标志设置为真，并删除之前添加的监听器。</p><h2 id="6372" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">制作绿色圆圈的动画</h2><p id="d9f4" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">在下一部分，我们将使用<code class="fe mq mr ms mi b">stroke-dasharray</code>和<code class="fe mq mr ms mi b">stroke-dashoffset</code>属性来制作一个<a class="ae ld" href="https://css-tricks.com/svg-line-animation-works/" rel="noopener ugc nofollow" target="_blank"> SVG动画特效</a>。</p><p id="f1ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了使这个技巧起作用，<code class="fe mq mr ms mi b">stroke-dasharray</code>必须有一个圆的周长值，为了计算它，我们可以回到我们的几何课笔记本，看到公式是<em class="kz">圆周率乘以圆的直径</em>。<br/>我们的是50px宽度，所以会是<code class="fe mq mr ms mi b">3.1416 * 50 = ~157</code>。我们还将把<code class="fe mq mr ms mi b">stroke-dashoffset</code>绑定到一个新的Vue数据变量:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="037d" class="lj lk iq mi b gy mm mn l mo mp">...<br/>&lt;!--  green circle  --&gt;<br/>&lt;svg v-if="loading" class="loader-svg"&gt;<br/>  &lt;path stroke="#20BF7E" fill="none" stroke-width="4" d="M25,2.5A22.5,22.5 0 1 1 2.5,25A22.5,22.5 0 0 1 25,2.5" <br/>  stroke-dasharray="157" :stroke-dashoffset="loaderOffset"&gt;<br/>  &lt;/path&gt;<br/>&lt;/svg&gt;<br/>...</span></pre><p id="5517" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在我们的Vue实例中，我们将在数据对象中声明loaderOffset属性，并用相同的值<code class="fe mq mr ms mi b">157</code>初始化它:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="099f" class="lj lk iq mi b gy mm mn l mo mp">data: {<br/>  clicked: false,<br/>  loading: false,<br/>  loaded: false,<br/>  loaderOffset: 157<br/>}</span></pre><p id="eb5b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这样做之后，我们可以开始用TweenLite来制作加载器的动画。</p><p id="d1e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们使用<code class="fe mq mr ms mi b">TweenLite.to()</code>方法在<em class="kz">两秒</em>内将<code class="fe mq mr ms mi b">loaderOffset</code>属性从其初始值插值到<em class="kz">零</em>。</p><p id="4f46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当它完成动画制作后，<code class="fe mq mr ms mi b">onComplete</code>钩子将执行<code class="fe mq mr ms mi b">completeLoading</code>方法，在这里我们设置<code class="fe mq mr ms mi b">loading</code>和<code class="fe mq mr ms mi b">loaded</code>属性:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="5724" class="lj lk iq mi b gy mm mn l mo mp">...<br/>animateLoader () {<br/>  this.loading = true<br/>  this.$refs['submit-btn']<br/>    .removeEventListener("transitionend", this.animateLoader, false);<br/>      <br/>  // animate the loaderOffset property,<br/>  // on production this should be replaced <br/>  // with the real loading progress<br/>  TweenLite.to(this, 2, {<br/>    loaderOffset: 0, // animate from 157 to 0<br/>    ease: Power4.easeInOut,<br/>    onComplete: this.completeLoading // execute this method when animation ends<br/>  })<br/>},<br/>completeLoading () {<br/>  this.loading = false<br/>  this.loaded = true<br/>}<br/>...</span></pre><h2 id="77e9" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">负载状态</h2><p id="1de4" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">对于最后一部分，我们只需要创建另一个CSS规则，它将在我们的按钮被加载时使用:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="9e54" class="lj lk iq mi b gy mm mn l mo mp">.submit-btn.loaded {<br/>  color: white;<br/>  background-color: #20BF7E;<br/>}</span></pre><p id="504e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后<code class="fe mq mr ms mi b">buttonClass</code> computed属性也应该处理这种情况:</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="3ec0" class="lj lk iq mi b gy mm mn l mo mp">...<br/>buttonClass () {<br/>  if (this.loaded) {<br/>    return 'loaded'<br/>  }<br/>      <br/>  if (this.clicked) {<br/>    return 'round'<br/>  }<br/>     <br/>  return ''<br/>}<br/>...</span></pre><p id="137e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经为这些属性声明了CSS转换，所以我们不需要做任何其他事情。</p><p id="369f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">而现在最后的结果！</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9391" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是本周第二个<strong class="ka ir">小部件</strong>的内容。</p><p id="b0b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你没有检查过上一个，<a class="ae ld" href="http://ederdiaz.com/blog/2018/04/04/smiley-toggle-wotw/" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><p id="c9d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另外，如果你想看下周的某个小部件，可以在评论区发表。</p><p id="029c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下周见，关注<a class="ae ld" href="https://levelup.gitconnected.com" rel="noopener ugc nofollow" target="_blank"> gitconnected </a>获取每周小工具！</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="4a4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kz">最初发表于</em><a class="ae ld" href="http://ederdiaz.com/blog/2018/04/11/making-a-submit-button-with-loader-wotw/" rel="noopener ugc nofollow" target="_blank"><em class="kz">Eder Diaz</em></a><em class="kz">。</em></p></div></div>    
</body>
</html>