<html>
<head>
<title>Detecting Focus of a Browser Tab in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在JavaScript中检测浏览器标签的焦点</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/detecting-the-focus-of-browser-tab-in-javascript-d4460bc579ac?source=collection_archive---------5-----------------------#2019-11-24">https://levelup.gitconnected.com/detecting-the-focus-of-browser-tab-in-javascript-d4460bc579ac?source=collection_archive---------5-----------------------#2019-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="08bd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">确定选项卡是否已从用户处获得焦点，以及焦点改变时如何处理事件</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a56e6beef727d7f036138b296561d9a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vMie7n3VyeEC29tIf6mCRw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片由<a class="ae kv" href="https://unsplash.com/@sincerelymedia?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">真心媒体</a></figcaption></figure><p id="3e7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">Page Visibility API</code>给了我们决定页面何时有焦点的能力。当页面的焦点改变时，API也会触发<code class="fe ls lt lu lv b">visibilitychange</code>事件。</p><p id="e5b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们需要在以下情况下节省资源时，页面可见性API非常有用:</p><ul class=""><li id="9c9c" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">当用户不使用该页面时，不发送任何网络请求。</li><li id="49a9" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">不在没有焦点的页面上执行动画。</li><li id="0b76" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">不更新非焦点页面上的任何用户界面。</li><li id="f73b" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">如果用户不在页面上，则阻止媒体播放。</li></ul><p id="0e32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我觉得Medium也是用这个API来决定一个故事的阅读时间。</p><p id="703c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">页面可见性API在文档对象下公开了<strong class="ky ir">两个属性:</strong></p><pre class="kg kh ki kj gt mk lv ml mm aw mn bi"><span id="58dd" class="mo mp iq lv b gy mq mr l ms mt">document.hidden</span></pre><p id="fdac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">返回一个布尔值，表示文档是否隐藏。</p><pre class="kg kh ki kj gt mk lv ml mm aw mn bi"><span id="7e79" class="mo mp iq lv b gy mq mr l ms mt">document.visibilityState</span></pre><p id="de11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可见性状态的字符串表示:</p><ul class=""><li id="e415" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated"><code class="fe ls lt lu lv b">visible</code> →标签有焦点。</li><li id="3f72" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">hidden</code> <strong class="ky ir"> → </strong>选项卡隐藏。</li><li id="6146" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">prerender</code> <strong class="ky ir"> → </strong>页面在后台加载，用户不访问。</li><li id="55e3" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">unloaded</code> <strong class="ky ir"> → </strong>页面正在从内存中卸载。</li></ul><p id="30b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并非所有浏览器都支持<code class="fe ls lt lu lv b">prerender</code>和<code class="fe ls lt lu lv b">unloaded</code>状态。</p><p id="e548" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了上述属性，我们还有一个事件<code class="fe ls lt lu lv b">visibilitychange</code>。当浏览器选项卡获得或失去焦点时，将触发此事件。</p><h1 id="01ec" class="mu mp iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated">例子</h1><pre class="kg kh ki kj gt mk lv ml mm aw mn bi"><span id="15b9" class="mo mp iq lv b gy mq mr l ms mt">document.addEventListener('visibilitychange', function(ev) {<br/>  console.log(`Tab state : ${document.<!-- -->visibilityState<!-- -->}`);<strong class="lv ir"><br/></strong>});</span></pre><p id="d1d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的例子中，我们简单地记录了状态。但是，当选项卡的可见性改变时，我们可以使用该事件来节省资源或执行任何所需的代码。</p><pre class="kg kh ki kj gt mk lv ml mm aw mn bi"><span id="3d87" class="mo mp iq lv b gy mq mr l ms mt">document.addEventListener('visibilitychange', function(ev) {<br/>     <br/><strong class="lv ir">   // Stop animation <br/>   // Stop unwanted request<br/>   // Stop unwanted UI update</strong></span><span id="6a24" class="mo mp iq lv b gy nl mr l ms mt">});</span></pre><p id="5ff8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用页面可见性API，<a class="ae kv" href="https://codepen.io/matt-west" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">马特-韦斯特</strong> </a>创建了一个视频播放器，当页面失去焦点时暂停视频，当页面获得焦点时自动再次播放。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="aa2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读📖。我希望你喜欢这个。如果你发现任何错别字或错误，给我发一封私信📝谢谢🙏 😊。</p><p id="ea95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关注我<a class="ae kv" href="https://medium.com/u/f9ffc26e7e69?source=post_page-----98efbae5e8aa----------------------" rel="noopener"> JavaScript Jeep🚙💨</a>。</p><p id="df3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">请捐款</strong> <a class="ae kv" href="https://www.paypal.com/paypalme2/jagathishSaravanan" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里</strong> </a> <strong class="ky ir">。你捐款的98%都捐给了需要食物的人🥘。提前感谢。</strong></p></div></div>    
</body>
</html>