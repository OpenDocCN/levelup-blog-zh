<html>
<head>
<title>What can go wrong when using custom fonts in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中使用自定义字体时会出现什么问题</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-can-go-wrong-when-using-custom-fonts-in-swiftui-93d6252600e6?source=collection_archive---------16-----------------------#2022-05-23">https://levelup.gitconnected.com/what-can-go-wrong-when-using-custom-fonts-in-swiftui-93d6252600e6?source=collection_archive---------16-----------------------#2022-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bc34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇博客文章的目标是SDK开发人员，他们将自定义字体捆绑在他们的包/库/框架中，这些<a class="ae kl" href="https://developer.apple.com/documentation/swiftui/applying-custom-fonts-to-text" rel="noopener ugc nofollow" target="_blank">字体将用于可重用的SwiftUI视图</a>。</p><p id="0a6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将解释一个在未注册的自定义字体上使用字体粗细相关的视图修饰符(如<code class="fe km kn ko kp b">bold</code>)时观察到的问题。</p><p id="261f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们假设您将<a class="ae kl" href="https://fonts.google.com/specimen/Open+Sans" rel="noopener ugc nofollow" target="_blank"> Open Sans </a> true type字体文件添加到您的包中</p><ul class=""><li id="e9e7" class="kq kr iq jp b jq jr ju jv jy ks kc kt kg ku kk kv kw kx ky bi translated">OpenSans-Regular.ttf</li><li id="477e" class="kq kr iq jp b jq kz ju la jy lb kc lc kg ld kk kv kw kx ky bi translated">OpenSans-Bold.ttf</li><li id="065b" class="kq kr iq jp b jq kz ju la jy lb kc lc kg ld kk kv kw kx ky bi">…</li></ul><p id="4515" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还可以提供可重用的SwiftUI视图，这些视图将自动利用自定义字体。为此，你可以将<code class="fe km kn ko kp b">Font.custom(:size)</code>的结果传递给<code class="fe km kn ko kp b">font</code>视图修改器。</p><pre class="le lf lg lh gt li kp lj lk aw ll bi"><span id="f4b6" class="lm ln iq kp b gy lo lp l lq lr">struct ReusableView: View {<br/>    var body: some View {<br/>        Text("Use Font.custom directly")<br/>            .font(.custom("OpenSans-Regular", size: 17))<br/>            .bold()<br/>    }<br/>}</span></pre><p id="b629" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你使用<code class="fe km kn ko kp b">bold</code>视图修改器，那么SwiftUI足够智能来加载OpenSans-Bold。</p><figure class="le lf lg lh gt lt gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/e7e65ec5ea618f848ca9d29b29035c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/0*QbehgEhRnFIa87Xn"/></div></figure><p id="93ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要应用程序开发人员没有忘记在应用程序中注册要使用的字体，这一切都很好。</p><pre class="le lf lg lh gt li kp lj lk aw ll bi"><span id="a352" class="lm ln iq kp b gy lo lp l lq lr">Font.registerOpenSans()</span><span id="639b" class="lm ln iq kp b gy lw lp l lq lr">extension Font {<br/>    static func registerOpenSans() {<br/>        self.register(name: "OpenSans-Regular", withExtension: "ttf")<br/>        self.register(name: "OpenSans-Bold", withExtension: "ttf")<br/>        // ...<br/>    }</span><span id="e3ef" class="lm ln iq kp b gy lw lp l lq lr">    static func register(name: String, withExtension: String) {<br/>        let fontURL = Bundle.main.url(forResource: name, withExtension: withExtension)!<br/>        var error: Unmanaged&lt;CFError&gt;?<br/>        CTFontManagerRegisterFontsForURL(fontURL as CFURL, .process, &amp;error)<br/>        if let error = error {<br/>            print(error.takeUnretainedValue())<br/>        }<br/>    }<br/>}</span></pre><p id="8c73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么app开发者忘记注册字体了怎么办？</p><figure class="le lf lg lh gt lt gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/7744a3383770c1b7064f66b40b192a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/0*ppOMw6kBcJVK2bzp"/></div></figure><p id="be34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可能会认为仍然会应用<strong class="jp ir">粗体</strong>字体粗细。但事实并非如此。苹果虫？</p><p id="0b3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了确保字体粗细得到应用，无论如何，我建议使用扩展。这个扩展要么加载字体，要么回退到系统字体。</p><pre class="le lf lg lh gt li kp lj lk aw ll bi"><span id="f50c" class="lm ln iq kp b gy lo lp l lq lr">extension Font {<br/>    /// get "Open Sans" font or fallbacks to the system font in case the custom font was not registered<br/>    /// - Parameter size: size of font<br/>    /// - Returns: "Open Sans" font (or sytem font as fallback)<br/>    static func openSans(size: CGFloat) -&gt; Font {<br/>        guard UIFont.familyNames.contains("Open Sans") else {<br/>            return Font.system(size: size)<br/>        }<br/>        return .custom("OpenSans-Regular", size: size)<br/>    }<br/>}</span></pre><p id="0be7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将确保SwiftUI能够对后备字体应用字体权重。</p><figure class="le lf lg lh gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ly"><img src="../Images/d408aafb0fb394798c6171a352c03469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/0*3Bfj15aKztbMW9Y3"/></div></div></figure><pre class="le lf lg lh gt li kp lj lk aw ll bi"><span id="7773" class="lm ln iq kp b gy lo lp l lq lr">struct ReusableView: View {<br/>    var body: some View {<br/>        VStack(alignment: .leading) {<br/>            Text("Use extension with fallback handling")<br/>                .font(.openSans(size: 17))<br/>                .bold()</span><span id="9a28" class="lm ln iq kp b gy lw lp l lq lr">        Text("Use Font.custom directly")<br/>                .font(.custom("OpenSans-Regular", size: 17))<br/>                .bold()<br/>        }<br/>    }<br/>}</span></pre><p id="42d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，在注册字体的情况下，结果是相同的。</p><figure class="le lf lg lh gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi md"><img src="../Images/c2f116034c7da60ea7b071a8b1ef58b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7lDSTvHI9q6QaMx4"/></div></div></figure></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><p id="68da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ml">最初发布于</em><a class="ae kl" href="https://blog.eidinger.info/what-can-go-wrong-when-using-custom-fonts-in-swiftui" rel="noopener ugc nofollow" target="_blank"><em class="ml">https://blog . ei dinger . info</em></a><em class="ml">。</em></p></div></div>    
</body>
</html>