<html>
<head>
<title>Build your own AutoML Text Classification using spaCy &amp; Firebase. (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用spaCy &amp; Firebase建立你自己的自动文本分类。(第一部分)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-your-own-automl-text-classification-using-spacy-firebase-part-1-6093a59dd32c?source=collection_archive---------22-----------------------#2020-06-08">https://levelup.gitconnected.com/build-your-own-automl-text-classification-using-spacy-firebase-part-1-6093a59dd32c?source=collection_archive---------22-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6fee14b1340969573e9b7fddf1b2eec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z2i966AdNLbp6ET6NNpfLQ.jpeg"/></div></div></figure><p id="83c7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">AutoML是谷歌的一套出色的产品，为那些想要利用机器学习(ML)的人降低了准入门槛。它允许您上传数据集，并负责为您创建机器学习模型。然后，它托管模型供您使用。可以想象，这对那些想利用机器学习但在创建和部署模型方面经验有限的人来说非常有用。然而，正如我从惨痛的教训中了解到的那样，运营成本可能会变得很高。谷歌对托管模型的使用收费，随着时间的推移，这可能会增加。</p><p id="1471" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">考虑到这一点，<a class="ae kz" href="https://www.linkedin.com/in/andrew-hayes-belfast/" rel="noopener ugc nofollow" target="_blank">我</a>认为用一些现成的工具和库创建我自己版本的AutoML会很有趣。我的目标是创造一个简单易用、低成本的AutoML替代品，几乎和T2的一样好。而AutoML涵盖了许多内容，如计算机视觉和一些类型的自然语言处理(NLP)。这个版本将只关注NLP的文本分类部分。在这些文章中，我将解释我是如何做到的，并带您构建自己的。</p><p id="01eb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">第1部分(本文)将解释我使用的工具、项目架构以及如何配置它。<a class="ae kz" href="https://medium.com/@adhayes88/build-your-own-automl-text-classification-using-spacy-firebase-part-2-3cd08e4298da" rel="noopener">第2部分</a>将着眼于将它们粘合在一起的代码，并带你完成代码的部署。完整的源代码可以在GitHub页面上找到:<a class="ae kz" href="https://github.com/Andrew-Hayes/diy-auto-ml-with-spacy-and-gcp/tree/v1.0.0" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Andrew-Hayes/DIY-auto-ml-with-spacy-and-GCP/tree/v 1 . 0 . 0</a>，我建议您创建它的一个分支，并在您的本地机器上克隆它，因为我在整篇文章中经常提到它。为了保持一致，本文引用分支“v1.0.0”。您还应该安装javascript包管理器:'<a class="ae kz" href="https://www.npmjs.com/get-npm" rel="noopener ugc nofollow" target="_blank"> npm </a>'。</p><h1 id="96eb" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">分解问题</h1><p id="9ee0" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">为了重新创建AutoML，我们必须分解它的各个方面，并依次解决它们。那么，我认为制作我自己版本的AutoML需要解决的主要问题是什么呢？</p><ol class=""><li id="fa74" class="md me it kd b ke kf ki kj km mf kq mg ku mh ky mi mj mk ml bi translated">上传数据集的能力</li><li id="188e" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">分析数据集注释并向用户显示它们的统计数据</li><li id="e6cd" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">在数据集上训练文本分类机器学习模型</li><li id="8720" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">部署模型</li><li id="e2d1" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">告知用户如何使用该模型</li></ol><p id="6231" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">虽然有些问题比其他问题更容易解决，但没有一个是不可克服的。问题1、2和5很容易解决，而3和4是比较难的部分。</p><h1 id="ad01" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">解决简单的问题</h1><p id="5b04" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">当创建一个web应用程序时，我的首要解决方案是将<a class="ae kz" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>和<a class="ae kz" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>结合起来。Firebase是谷歌的另一个工具套件，它使创建和部署大多数web应用程序变得容易。React是一个javascript库，当与<a class="ae kz" href="https://react.semantic-ui.com/" rel="noopener ugc nofollow" target="_blank">语义UI </a>结合使用时，使得web应用UI的创建变得简单。</p><p id="5966" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据经验，我知道这种组合可以解决大多数需要的东西。Firebase为云存储提供了库，为处理后端请求提供了云函数，并提供了一个数据库来存储所需的统计/数据。所以剩下的就是模型训练和部署，这能有多难？</p><h1 id="b147" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">解决困难的部分…</h1><p id="9c6c" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">机器学习并不容易，然而，有很多聪明人在制作工具，帮助我们其他人变得更容易。谈到自然语言处理，我的首要解决方案是<a class="ae kz" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank"> spaCy </a>。SpaCy是一个生产就绪的python库，速度非常快，更重要的是，它具有机器学习功能。所以它非常适合我们的AutoML版本。我们可以使用SpaCy来创建我们需要的文本分类ML模型，然后您需要担心的就是部署它。为此，你可以使用谷歌的“云构建”和“云运行”。Cloud Build是一个持续集成工具，您可以使用它将我们的模型放入docker容器，然后它可以将该容器部署到Cloud Run。Cloud Run是一种无服务器的容器运行方式，因此是托管我们模型的最佳场所。</p><h1 id="ff6e" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">体系结构</h1><p id="4f74" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">这张图应该有助于形象化我使用的设置。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mr"><img src="../Images/aa10eb4730fd1ef7d0e74fec838f3846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-gVNzjlp2D3gKhdDKWomg.jpeg"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">DIY AutoML的基本架构</figcaption></figure><p id="5b1d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">AutoML工作流适合项目，如下所示:</p><ol class=""><li id="6b53" class="md me it kd b ke kf ki kj km mf kq mg ku mh ky mi mj mk ml bi translated">使用firebase存储库，用户可以将他们的数据集上传到谷歌的云存储中。</li><li id="b29d" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">当上传完成时，它会触发一个云函数来分析上传的数据集，并将统计数据保存到数据库中。</li><li id="400c" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">如果用户对数据集满意，他们可以触发云功能开始训练。这将把数据集发送到云构建，云构建将从代码存储库中获取空间代码，并使用它来训练容器中的文本分类模型。</li><li id="e9b8" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">一旦构建了包含模型的容器，Cloud Build将使用新构建的容器部署云运行服务。然后，Cloud Run将提供一个服务URL，用户可以调用它来对文档进行分类</li><li id="6e32" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">将URL保存到DB，DB将使用如何使用该模型的说明来更新UI</li></ol><p id="e5f8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如你所看到的，Firebase和spaCy完成了大部分繁重的工作。Firebase还附带了一个慷慨的免费层，这将有助于保持低运行成本。因此，让我们开始设置！</p><h1 id="6280" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">配置</h1><p id="7b93" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">要运行这个项目，您需要配置一些东西。一旦完成，您就可以部署代码并开始使用您自己的AutoML了。您需要配置的是:</p><ol class=""><li id="0e38" class="md me it kd b ke kf ki kj km mf kq mg ku mh ky mi mj mk ml bi translated">创建一个Firebase项目，启用Firestore数据库、Firebase功能、Firebase托管和Firebase存储</li><li id="3bf5" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">Firebase会自动创建一个GCP项目，在这个项目中，您需要启用云运行、云构建和其他一些功能</li><li id="5a49" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">最后，您需要在GCP项目上启用源代码库，并将其链接到这个项目的GitHub分支。</li></ol><p id="ed2f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要创建Firebase项目，请转到<a class="ae kz" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>。单击add new project并为其命名，在本例中为“Make your own AutoML”。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/c41668b31479593632acdbaf1186d73e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITMnnKIcUqtNUwi1tJE19g.png"/></div></div></figure><p id="74d5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">项目创建完成后，点击左侧的“数据库”选项卡。在这里，您可以创建Firestore数据库。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/ee329e0ed13a4f2ebea25b8bcb2182e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ln7oTs7v3cDRJJ2LkLk53Q.png"/></div></div></figure><p id="498e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我选择以“生产模式”开始我的工作，并把它放在欧洲，因为那里离我更近，但是你可以选择最适合你的方式。创建好数据库后，单击“认证”,这样就可以启用登录了。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/dd6fbcdf9d2852f63433655c7ae2816a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*oojobwTQEZzMko8ovEpoTg.png"/></div></figure><p id="6416" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后点击“登录方式”选项卡，并启用“电子邮件/密码”登录选项。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/f2bf6804cee1df6f9bab8fbcba46e6ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFAVeJ1OrPxQl9fJokKDyg.png"/></div></div></figure><p id="fabe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后导航回“用户”选项卡，将自己添加为用户。</p><p id="9e33" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">设置好登录方法后，在左侧菜单中单击“存储”部分，导航至该部分。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/08fed59c147a1a74b32b259f14b2a32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*LWt6bjxE16j7ottR0UKbWw.png"/></div></figure><p id="b23d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">点击“开始”设置存储，现在只接受默认设置。这将为您创建一个默认桶，并初始化所需的基本设置。存储设置完成后，单击“项目概述”返回主控制面板。在这里，您可以创建一个“web应用程序”:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/d6ca08a62c55fb3d6e25227ff0623332.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*0XwnNpPWi3xRiwKbDFyF5Q.png"/></div></figure><p id="c8ca" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我将我的网络应用命名为“DIY AutoML网络应用”,并勾选了“Firebase托管”选项。它在这一点上提供了一些配置代码，但是我现在忽略了它。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/5472627996c1aaf04e1538918c873e1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*Y15V8pUA9lRPejSB0XvZlA.png"/></div></figure><p id="fabc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">之后，它解释了如何在CLI中安装Firebase:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/43c16f81469425e4109f4402f4ca7326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yauqZ09-lYe1H3qVjH_8CQ.png"/></div></div></figure><p id="5da2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">安装完成后，您就可以在您的机器上启动Firebase项目了:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/1f8a8e2543d90ad3cce5f8acf7317305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-98B6SyjZsaquV6FxBxyA.png"/></div></div></figure><p id="df97" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">确保您位于“v1.0.0”分支，并运行“DIY-auto-ml-with-spacy-and-GCP/DIY-auto-ml-ui”目录中的“firebase init”。它会询问要激活哪些firebase服务，您应该选择'<em class="nj"> Firestore </em>'、<em class="nj"> Functions </em>'、<em class="nj"> Hosting </em>和'<em class="nj"> Storage </em>。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/bccec454ffa4ade47d831c5823176a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u0XgZTZlBK4EmoAy4Ie_gA.png"/></div></div></figure><p id="e0c3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦你选择了这些，选择“<em class="nj">使用现有的项目</em>”并选择你刚刚创建的项目。然后会询问Firestore规则使用什么文件，只需按回车键。然后它会询问你是否想要覆盖本地文件，键入'<em class="nj"> N </em>'。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/65ba05ee0caf7835e374d2c164508008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCHqdkhvDEsk7FB6xD0IZw.png"/></div></div></figure><p id="db37" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它将对"<em class="nj"> Firestore indexes </em>"进行同样的操作，同样只使用默认文件，并在询问您是否要覆盖它时输入'<em class="nj"> N </em>'。然后它会询问函数使用什么语言，选择“<em class="nj"> Javascript </em>”。之后它会问你是否想使用ESLint，我选择了'<em class="nj"> N </em>'。当询问是否要覆盖'<em class="nj"> functions/package.json </em>'文件时，输入'<em class="nj"> N </em>'。然后，当它询问您是否要覆盖'<em class="nj"> functions/index.js </em>'时，再次输入'<em class="nj"> N </em>'，当它要求覆盖' functions/时，再次输入'<em class="nj"> N </em>'。gitignore。它还会询问“<em class="nj">您是否希望现在安装与npm的依赖关系</em>”，您应该键入“<em class="nj"> Y </em>”。</p><p id="c797" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦安装了依赖项，它将询问'<em class="nj">您希望使用什么作为您的公共目录？</em>你应该把它设置为<em class="nj">构建</em>。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/2da6989d1f126e5d08d30dc3bb1b426d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JoM2RFAxh8uT1bHJH6CiA.png"/></div></div></figure><p id="6150" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，它会问'<em class="nj">配置为单页app(将所有网址重写为/index.html)？</em>而你应该输入<em class="nj"> Y </em>。最后，它将询问‘什么文件应该用于存储规则？<strong class="kd iu"> ' </strong>你只要按下回车键就可以使用默认。现在你的firebase项目已经设置好了！</p><p id="08a9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，您需要为Firebase添加一些权限，以生成“签名的URL”(将数据集发送到容器)，启动云构建并部署到云运行。当你创建一个Firebase项目时，它会自动创建一个GCP项目。所以打开<a class="ae kz" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> GCP控制台</a>，从顶部的下拉菜单中选择你创建的项目。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/c7083f0b3ba30e9dbfe3128238f41c73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xxNEEFq1Zzuj8ymagxByhg.png"/></div></div></figure><p id="2117" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，您可以启动一个“云外壳”终端来配置Firebase服务帐户的权限。为此，请单击控制台右上角的“激活云外壳按钮”:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi no"><img src="../Images/808c6f71b0848bc7bd5432f6ca2acb6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*bBpFnBRGu2n5m71qgor5bg.png"/></div></figure><p id="072a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这可能需要一段时间来启动，但是一旦启动，您就可以运行这些命令(用您的项目ID替换<project_id>:</project_id></p><pre class="ms mt mu mv gt np nq nr ns aw nt bi"><span id="2b0b" class="nu lb it nq b gy nv nw l nx ny">gcloud projects add-iam-policy-binding &lt;PROJECT_ID&gt; --member=serviceAccount:&lt;PROJECT_ID&gt;@appspot.gserviceaccount.com --role=roles/iam.serviceAccountTokenCreator</span><span id="81c0" class="nu lb it nq b gy nz nw l nx ny">gcloud projects add-iam-policy-binding &lt;PROJECT_ID&gt; --member=serviceAccount:&lt;PROJECT_ID&gt;@appspot.gserviceaccount.com --role=roles/cloudbuild.builds.builder</span></pre><p id="0eea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将向Firebase服务帐户添加“serviceAccountTokenCreator”、“cloudBuildBuilder”和“cloudRunAdmin”角色，并允许它生成签名的URL、启动云构建并部署到云运行。您还需要启用一些API:IAM API、云资源管理器API、容器注册API和云运行API。为此，在您的云终端中运行以下命令:</p><pre class="ms mt mu mv gt np nq nr ns aw nt bi"><span id="4a21" class="nu lb it nq b gy nv nw l nx ny">gcloud services enable iam.googleapis.com</span><span id="60ef" class="nu lb it nq b gy nz nw l nx ny">gcloud services enable cloudresourcemanager.googleapis.com</span></pre><p id="64dd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，您需要启用“云构建”，这样您就可以构建您的模型了。单击左侧菜单中的“云构建&gt;仪表板”:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/dc6a49057d758f74a13a598698fc5f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFW0dBYz2g6OkPB1avMU4g.png"/></div></div></figure><p id="e88a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后点击“启用”:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/d64e56b9686927f84a12a3b22bc44c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jmNuACqNQrAcktgx0BqCFQ.png"/></div></div></figure><p id="4c50" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">恼人的是，云构建需要一个计费账户才能工作，所以你应该启用它。好消息是，你每天有120分钟的免费构建时间，这将使你能够免费构建模型，如果你把它们间隔几天的话。启用API后，您需要设置一些权限来允许云构建服务部署到云运行。为此，请单击左侧的云构建设置</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/61d8dfe82f3a8fbb6c7993dfd2d939d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*wvaxPH8_9mWQr8qozhqd_w.png"/></div></figure><p id="b5e1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后启用“云运行管理员”角色:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/ad867c794638c347a6900cad0241be5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnPAZfrHGzPb57zSPoMmjQ.png"/></div></div></figure><p id="487e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它可能会要求额外的权限，所以也要启用它们:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oe"><img src="../Images/cd11ba7c76012f074f4ea6a873945660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yN-5kGnwUkcmh4SR5zR7_w.png"/></div></div></figure><p id="fc60" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">云构建现在将能够部署云运行服务。然后，您需要启用云运行。点击左侧菜单中的“云运行”</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1d9899f8f71ff255c0d769f5f606b91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*-J6LWC792xfMm0CnVDNPxw.png"/></div></figure><p id="77d7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦加载，点击“开始使用云运行”,这将启用云运行API。</p><p id="de9a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后的配置步骤是将我们的GitHub repo链接到我们的GCP项目，这样您就可以在云构建中使用代码了。这样做的第一步是在GitHub中派生存储库。转到GitHub 上的<a class="ae kz" href="https://github.com/Andrew-Hayes/diy-auto-ml-with-spacy-and-gcp/tree/v1.0.0" rel="noopener ugc nofollow" target="_blank">库，点击右上角的‘Fork’</a></p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi og"><img src="../Images/41cfb2dd3c49f7046871ce15e7ab08d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MdEz-CaA1QNtIyRnwBd4Ow.png"/></div></div></figure><p id="8e92" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这样，它将位于您自己的名称空间下，当您将GitHub帐户链接到GCP时就可以使用了。一旦你有回购分叉，回到GCP控制台点击左侧菜单中的“源库”。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ace02d74c9b24641dfe0b2b92658331e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*Gjz0zYNV6vgKH9DkKX96bQ.png"/></div></figure><p id="d903" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，您可以单击屏幕右上角的“添加存储库”:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/23a8fc4533c2c27dcb4961ade8dcb903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*HzZJbmSQGicxAEkGdR3AZA.png"/></div></figure><p id="5f19" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将打开一个模式来创建一个新的存储库或选择一个现有的存储库。选择“连接外部存储库”:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oi"><img src="../Images/65855c1c0173abb2b757c8c42f0a886a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zCksD51Iic-fbbWdwxuacQ.png"/></div></div></figure><p id="d70e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后你需要让GCP访问你的GitHub库。一旦它被链接，它会显示一个你的库列表，选择你刚刚创建的diy-auto-ml-with-spacy-and-gcp分支，然后点击“连接选择的库”。一旦连接上，您就拥有了需要配置的一切！</p><h1 id="1af9" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">摘要</h1><p id="3fdf" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">在本文中，您了解了DIY AutoML项目的体系结构。您还在GCP配置了一些东西，即:</p><ol class=""><li id="1bb8" class="md me it kd b ke kf ki kj km mf kq mg ku mh ky mi mj mk ml bi translated">设置一个具有DB、托管、云存储和云功能的Firebase项目。这将允许您托管项目的web界面并上传数据集以进行模型训练。</li><li id="3e1d" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">在您的项目上启用云运行和云构建。这将允许您训练和部署模型。</li><li id="03f1" class="md me it kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">将您的项目链接到GitHub上的资源库。这将允许您利用空间代码并快速构建您的模型。</li></ol><p id="7b25" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在一切都配置好了，你可以前往<a class="ae kz" href="https://medium.com/@adhayes88/build-your-own-automl-text-classification-using-spacy-firebase-part-2-3cd08e4298da" rel="noopener">第二部分</a>。在<a class="ae kz" href="https://medium.com/@adhayes88/build-your-own-automl-text-classification-using-spacy-firebase-part-2-3cd08e4298da" rel="noopener">第2部分</a>中，我将讨论用于将关键组件粘合在一起的代码以及如何部署它们。</p></div></div>    
</body>
</html>