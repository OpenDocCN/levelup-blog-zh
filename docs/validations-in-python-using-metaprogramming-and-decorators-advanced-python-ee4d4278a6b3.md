# 使用 Python 中的元编程装饰器进行验证—高级 Python

> 原文：<https://levelup.gitconnected.com/validations-in-python-using-metaprogramming-and-decorators-advanced-python-ee4d4278a6b3>

![](img/8854734f4063ce8d6265e6321272d37f.png)

作者: [*杜克森*](https://www.artstation.com/dukson)

装饰器是一种特殊类型的声明，可以应用于一个函数来改进它的功能。这也是**元编程**的一种类型。我们试图在编译时改变函数的功能。在任何编程语言中，元编程都是一个迷人的概念。它可用于在执行实际功能之前执行某些检查。
让我们看一个例子来更好地理解用例。

假设我们有一个接受分子和分母的函数 [divide](https://en.wikipedia.org/wiki/Division_(mathematics)) 。在这种情况下，分子和分母应该是实数。分子和分母不能为零。让我们将该功能付诸实施。

**说明:**

如果您查看上面的示例函数，您会注意到我们添加了一些额外的检查来验证传递的参数。这些额外的检查可以通过元编程实现，而不需要修改实际的函数。

## 你应该知道

在继续之前，您应该了解一些概念。这些想法将有助于装饰者的理解。

1.  一切都是事物。
2.  该类是可调用的。

**在 Python 中一切都是对象** : Python 把一切都当作对象。是的，类也是一个对象。一个名字可以与多个变量相关联，包括函数。考虑下面的例子。

我们也可以将函数作为参数传递并使用该函数。

一个函数也可以返回另一个函数。

**类是可调用的:**你可以通过添加`**def** **__call__**(self, *args, **kwargs)`函数使类成为可调用的对象。可调用对象是一个对象，但可以被称为函数。当我们执行或调用可调用对象时，它会在内部调用方法`**__call__**`

既然我们已经讨论了基础知识，让我们看看装饰者。

## 使用功能的装饰者

装饰函数是只有一个参数的函数。它将一个函数作为参数，并返回一个帮助函数。

从上面的例子中可以看出，**装饰器**函数将 **func** 作为函数，并添加前/后语句。一个**装饰器**功能可以使用`@decorator`表达式来实现。

你也可以返回一个接受**变量**作为参数**的函数。**这对于覆盖功能行为非常有用，但仍能提供充分的灵活性。

## **装修工使用类**

可以像创建函数装饰器一样创建可调用的对象装饰器。与函数式装饰器相比，创建基于类的装饰器的主要优点是它看起来更具声明性和更简洁。

为了更好地理解这个概念，让我们回到前面的**加法**和**除法**函数的例子。您可能已经注意到，它们都是实数的通用验证。我们可以创建一个通用的验证器装饰类。

现在我们有两个参数验证器。让我们把这个用在实函数上。

当您查看函数时，您会注意到它们比以前的版本要干净得多。

## 结论

**装饰师**涉及的话题很广。我刚刚接触到水面。作为一个例子，考虑装饰者的**链接。这对于共享和应用可重用验证非常有用。跟踪函数调用、窥探函数调用、编写自定义解析器等等都是元编程的常见应用。你可以调查一下，让我知道你在评论里发现了什么。**

## 参考资料:

*   [https://python-course . eu/advanced-python/decorators-decoration . PHP](https://python-course.eu/advanced-python/decorators-decoration.php)
*   [https://realpython.com/python-metaclasses](https://realpython.com/python-metaclasses)