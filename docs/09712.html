<html>
<head>
<title>Monorepo Solutions in 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2021年的Monorepo解决方案</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/different-monorepo-solutions-in-2021-1d6f5e5fb95b?source=collection_archive---------3-----------------------#2021-09-07">https://levelup.gitconnected.com/different-monorepo-solutions-in-2021-1d6f5e5fb95b?source=collection_archive---------3-----------------------#2021-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8067" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用这些工具轻松管理您的Monorepo</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c06e7e560701610eea710928c9d2a713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AGbZNWE4nlK4mhr6vxd8OQ.jpeg"/></div></div></figure><p id="66c9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Monorepo是一个单一的存储库，其中存储了属于一个项目的所有代码。例如，Monorepo会将网站代码和移动应用程序代码放在一个地方。然而，它不同于单一的应用程序，因为模块在存储库中有清晰的边界。</p><p id="fec8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">而且，对于任何开始使用Monorepos的人来说，适当的工具是避免已知陷阱的关键。因此，让我们来看看其中的一些工具，以找到最适合您的使用情形的工具。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><h1 id="f310" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">1.少量</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/6eb16e4faadbd243ebcf6cb7d8fdc863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GWtoYRVryQOIIW88OXnxxQ.png"/></div></div></figure><p id="2b5b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Bit 是Monorepos可用的最佳工具之一。它试图通过对构建代码的方式进行一些根本性的改变来避免Monorepos出现的大多数挑战。其中一个变化是:</p><blockquote class="mo"><p id="1845" class="mp mq iq bd mr ms mt mu mv mw mx lm dk translated">Bit自动将组件从项目中分离出来，包括它们的依赖关系。</p></blockquote><p id="b256" class="pw-post-body-paragraph kr ks iq kt b ku my jr kw kx mz ju kz la na lc ld le nb lg lh li nc lk ll lm ij bi translated">你可能会想，它有什么特别的，对吧？想一想，如果你能把你的Monorepo安排成一个组件的集合，</p><ul class=""><li id="59e2" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">根据您的选择分组为多个集合。</li><li id="fa7e" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">在这些组之间共享(具有完全管理的依赖版本)。</li><li id="d7c4" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">能够跟踪依赖关系，并在整个依赖关系树发生变化时自动测试它们。</li><li id="71a9" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">团队可以在这些组件上并行协作，以提高生产率。</li><li id="3bc7" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">甚至能够共享Monorepo之外的组件。</li></ul><p id="a9dc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是比特的力量。你也可以用它来构建模块化的应用，设计系统，创作和交付微前端，甚至在应用之间共享组件。</p><p id="213f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是，如果您不熟悉Bit，可能需要一些时间来熟悉这些概念。所以快速入门的最好方法就是尝试一下。您可以使用以下指南逐步开始。</p><div class="nr ns gp gr nt nu"><a href="https://harmony-docs.bit.dev/getting-started/installing-bit/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">正在安装位|位文档</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">要使用Bit，需要全局安装。你可以首先安装BVM，一个用于Bit和…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">和谐-docs.bit.dev</p></div></div><div class="od l"><div class="oe l of og oh od oi kp nu"/></div></div></a></div><p id="0d77" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您想更深入地了解它的全部功能，请参考下面的文章。</p><div class="nr ns gp gr nt nu"><a href="https://blog.bitsrc.io/monorepo-architecture-simplified-with-bit-and-npm-b1354be62870" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">用Bit简化Monorepos</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">如何利用位+ NPM简化monorepo架构，有和没有Lerna和朋友。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">blog.bitsrc.io</p></div></div><div class="od l"><div class="oj l of og oh od oi kp nu"/></div></div></a></div><h1 id="cec7" class="lu lv iq bd lw lx ok lz ma mb ol md me jw om jx mg jz on ka mi kc oo kd mk ml bi translated">2.巴泽尔</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/4c5dfb84e382d2009c653509b189fa5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sOB3JtIvnr7ZQMil2Iquvw.png"/></div></div></figure><p id="64fe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">谷歌是早期采用Monorepos的众多大公司之一。<a class="ae mn" href="https://bazel.build/" rel="noopener ugc nofollow" target="_blank"> Bazel </a>是谷歌面向单一回购的构建系统。大多数Monorepo工具只支持JavaScript，然而，Bazel超越了这一点。</p><p id="1e5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Bazel使用标语“{快速，正确} —选择两个”来展示自己，我认为这非常准确。Bazel的构建速度极快，只需花费很少的时间就可以处理非常大的构建。这是通过运行<strong class="kt ir">分布式构建</strong>实现的。这是Bazel的一个关键特征。</p><h2 id="46ca" class="oq lv iq bd lw or os dn ma ot ou dp me la ov ow mg le ox oy mi li oz pa mk pb bi translated">巴泽尔的一些特点</h2><ul class=""><li id="019b" class="nd ne iq kt b ku pc kx pd la pe le pf li pg lm ni nj nk nl bi translated">快速准确——就像他们的标语所说的那样！</li><li id="c9d1" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">高级构建语言—提供人类可读的定义语言</li><li id="2f88" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">支持JavaScript、Java、Go、C+等多种语言。(大多数构建工具都没有提供)</li><li id="0cd7" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">可以在并行机上运行</li><li id="f951" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">可扩展—能够大规模构建和测试，并支持大型代码库</li><li id="b3cb" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">确定性增量构建</li><li id="90b8" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">构建是沙箱化的—提供密封(如果构建规则未声明为依赖于特定文件，它将无法打开该文件)</li><li id="d4b7" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">为多个平台生成输出</li></ul><p id="0f76" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Bazel利用本地和分布式缓存以及依赖关系分析，只重建由于新的更改而受到影响的构建部分。我发现这比大多数其他工具使用的机制更有效。此外，Bazel在创建依赖关系图时，通过使用内容摘要而不是时间戳来确定过时的工件，从而继续提高效率。这实现了什么？</p><p id="d873" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它有助于避免不必要的目标重建，即使分布在多个主机上，也能实现可预测的构建。由于Bazel使用内容摘要，它能够缓存中间构建步骤的输出，并在必要时重用它们。</p><p id="6256" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Bazel中用来定义新规则的语言叫做<a class="ae mn" href="https://docs.bazel.build/versions/1.0.0/skylark/language.html" rel="noopener ugc nofollow" target="_blank"> Starlark </a>。它受Python 3语法的启发，但不包括所有Python特性。Bazel可用于macOS、Ubuntu、Fedora/CentOS和Windows。</p><h2 id="dfe6" class="oq lv iq bd lw or os dn ma ot ou dp me la ov ow mg le ox oy mi li oz pa mk pb bi translated">巴泽尔是如何工作的？</h2><ol class=""><li id="b6af" class="nd ne iq kt b ku pc kx pd la pe le pf li pg lm ph nj nk nl bi translated">加载与定义的目标相关的构建文件</li><li id="3104" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ph nj nk nl bi translated">然后，它分析输入及其依赖关系，应用指定的构建规则，并生成一个动作图</li><li id="a529" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ph nj nk nl bi translated">最后，通过对输入执行构建操作来生成构建输出。</li></ol><h2 id="1785" class="oq lv iq bd lw or os dn ma ot ou dp me la ov ow mg le ox oy mi li oz pa mk pb bi translated">谁用巴泽尔？</h2><p id="f5bf" class="pw-post-body-paragraph kr ks iq kt b ku pc jr kw kx pd ju kz la pi lc ld le pj lg lh li pk lk ll lm ij bi translated">像Google，Dropbox，华为，Stripe，Braintree等大公司。利用巴泽尔。随着公司的成长，谷歌扩大了其单一回购的规模。到2015年，谷歌Monorepo拥有86tb的数据和20亿行代码。优步使用Bazel构建了他们的Go Monorepo。关于他们是如何做到的详细信息可以在<a class="ae mn" href="https://eng.uber.com/go-monorepo-bazel/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="e737" class="lu lv iq bd lw lx ok lz ma mb ol md me jw om jx mg jz on ka mi kc oo kd mk ml bi translated">3.莱尔纳</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/0f4e6f0109bcd42517fc20095f0e6f36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g53Gd28mktaL7UGh-XmOoQ.png"/></div></div></figure><p id="4fbc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae mn" href="https://github.com/lerna/lerna" rel="noopener ugc nofollow" target="_blank"> Lerna </a>是一个使用Git和NPM优化基于JavaScript的Monorepo中多个包之间工作流的工具。Lerna集成了流行的框架和语言，如TypeScript、React、Angular、Babel等。</p><h2 id="1160" class="oq lv iq bd lw or os dn ma ot ou dp me la ov ow mg le ox oy mi li oz pa mk pb bi translated">Lerna能达到什么目的？</h2><ul class=""><li id="ed0b" class="nd ne iq kt b ku pc kx pd la pe le pf li pg lm ni nj nk nl bi translated">有助于处理语义版本——假设您的Monorepo中有许多模块使用相同的包。增加这个版本将需要您在所有模块上运行相同的命令。使用Lerna，这可以简化，因为您可以一次在所有模块上更新同一个包的版本。</li><li id="93f6" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">帮助设置构建工作流</li><li id="8d06" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">能够轻松推动包装</li><li id="e3ba" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">允许链接项目之间的依赖关系—如果项目A依赖于项目B，则可以共享依赖关系并一起测试两个项目。这不会影响Monorepo中没有直接依赖关系的其他项目</li></ul><h2 id="5135" class="oq lv iq bd lw or os dn ma ot ou dp me la ov ow mg le ox oy mi li oz pa mk pb bi translated">使用Lerna命令</h2><ul class=""><li id="e7ef" class="nd ne iq kt b ku pc kx pd la pe le pf li pg lm ni nj nk nl bi translated"><code class="fe pm pn po pp b">lerna init</code> —创建新的Lerna repo或将现有的repo升级到Lerna的当前版本。这可以在固定/锁定模式或独立模式下完成。要在独立模式下启动Lerna，必须使用标志<code class="fe pm pn po pp b">--independent</code></li><li id="ab7a" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><code class="fe pm pn po pp b">lerna bootstrap</code> —通过安装软件包的依赖项并链接交叉依赖项(如果有)，将当前Lerna repo中的软件包捆绑在一起。</li><li id="a5cf" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><code class="fe pm pn po pp b">lerna publish</code> —创建已更新软件包的新版本。</li><li id="4aad" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><code class="fe pm pn po pp b">lerna changed</code> —检查自上次发布以来哪些软件包发生了变化</li><li id="d984" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><code class="fe pm pn po pp b">lerna run &lt;script&gt;</code> —在每个包含脚本的包中运行指定的脚本</li><li id="9cf8" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><code class="fe pm pn po pp b">lerna ls</code> —列出当前Lerna repo中的所有公共包</li></ul><p id="98eb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以在<code class="fe pm pn po pp b">lerna.json</code>文件中定义所有的Lerna配置。示例文件如下所示。</p><pre class="kg kh ki kj gt pq pp pr ps aw pt bi"><span id="13e0" class="oq lv iq pp b gy pu pv l pw px">{<br/>   "packages": ["packages/*"],<br/>   "npmClientArgs": ["--no-lockfile"],<br/>   "version": "independent",<br/>   "command": {<br/>      "version": {<br/>         "ignoreChanges": ["*.md"],<br/>         "npmClient": "npm",<br/>         "message": "chore(release): publish"<br/>      },<br/>      "publish": {<br/>         "npmClient": "npm"<br/>      }<br/>   }<br/>}</span></pre><p id="2d03" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通常，我们在应用程序中使用<code class="fe pm pn po pp b">yarn build</code>或<code class="fe pm pn po pp b">yarn lint</code>来构建或运行lint命令。由于Monorepo有多个应用程序，我们可以使用Lerna来代替<code class="fe pm pn po pp b">yarn</code>。在Monorepo中构建每个模块的示例构建脚本是<code class="fe pm pn po pp b">lerna run build --stream</code>。<code class="fe pm pn po pp b">--stream</code>标志将在终端显示构建输出。</p><p id="dfbf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Lerna还有一个GUI，它会带您完成设置Lerna Monorepo和相关活动所需的步骤。这被称为<a class="ae mn" href="https://github.com/szarouski/lerna-wizard" rel="noopener ugc nofollow" target="_blank"> lerna向导</a>。根据synk.io趋势统计，Lerna在很多开发者中非常受欢迎。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi py"><img src="../Images/4c0ccc83ed1a901480f3931375a2b0d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*UXEjwyHuMeYptoSQ4yQHCw.png"/></div><figcaption class="pz qa gj gh gi qb qc bd b be z dk translated">来源:<a class="ae mn" href="https://snyk.io/advisor/npm-package/lerna" rel="noopener ugc nofollow" target="_blank"> synk.io </a></figcaption></figure><h1 id="ba35" class="lu lv iq bd lw lx ok lz ma mb ol md me jw om jx mg jz on ka mi kc oo kd mk ml bi translated">4.（同nonexpendable）非消耗品</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qd"><img src="../Images/498613607d0e39847c746e9d93da74df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFJGmWVqj8AAIMbnlrHxSQ.png"/></div></div></figure><p id="9a94" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae mn" href="https://nx.dev/" rel="noopener ugc nofollow" target="_blank"> NX </a>为Monorepos提供了一套开发工具。它强调现代全栈网络技术。这是一个基于类型脚本的Monorepo工具。它提供了，</p><ul class=""><li id="be13" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">工作区</li><li id="c468" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">命令行界面</li><li id="0b85" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">基于云的计算缓存</li><li id="0413" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">强大的语言级IDE支持</li></ul><p id="26d3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Nx帮助建立Monorepo的构建管道，并提供其他工具来帮助开发过程。它提供了在模块之间共享代码的指南，使代码共享变得更加容易。</p><p id="2d66" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">与Bazel类似，Nx也分析repo来识别哪些模块受到某个变更的影响，并只构建、运行和测试受影响的模块。使用<code class="fe pm pn po pp b">affected</code>命令完成该识别。这是运行构建的有效方式，尤其是当您的模块中有大量共享库时。Nx的分享代码指南相当固执己见。然而，如果大量开发人员参与开发过程，这就很方便了。虽然有些人可能不喜欢固执己见的指南，但在某些情况下，这可能是有效和有用的。</p><p id="e541" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将Nx添加到现有的Monorepo非常容易。只需使用一个命令<code class="fe pm pn po pp b">npx add-nx-to-monorepo</code>就可以完成。如果你有兴趣学习这个过程，参考<a class="ae mn" href="https://blog.nrwl.io/adding-nx-to-an-existing-monorepo-by-running-one-command-426fa519d943" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。</p><h1 id="9d01" class="lu lv iq bd lw lx ok lz ma mb ol md me jw om jx mg jz on ka mi kc oo kd mk ml bi translated">5.纱线工作空间</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qe"><img src="../Images/7cee21719d727eabad7172f165b93f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UocxbN18Yz1TAvRYm6SXbw.jpeg"/></div></div></figure><p id="9ed1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe pm pn po pp b">yarn</code>众所周知是一个JavaScript依赖管理工具。它通过工作区支持Monorepos。Workspace也是一个包含一组构建规则的包，有自己的<code class="fe pm pn po pp b">package.json</code>。</p><p id="94bf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Yarn工作空间具有以下特征。</p><ul class=""><li id="3f29" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">在Monorepo中为您的所有软件包共享<code class="fe pm pn po pp b">node_modules</code>。</li><li id="a5c2" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">一个单独的锁文件(例如:<code class="fe pm pn po pp b">yarn.lock</code>)适用于所有包</li><li id="a7f9" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">提供依赖符号链接以允许包的本地开发</li><li id="3e22" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">如果您只需要更新一个包的依赖关系，您可以通过使用<code class="fe pm pn po pp b">-focus</code>标志来实现。这被称为集中依赖关系更新。</li><li id="db1b" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">可以轻松地与Lerna集成——在这种情况下，Yarn工作区将处理安装/符号链接，而Lerna将处理发布和版本控制。</li></ul><blockquote class="mo"><p id="a158" class="mp mq iq bd mr ms qf qg qh qi qj lm dk translated">Yarn Workspaces可以用一个命令安装和更新Monorepo中所有包的依赖项。</p></blockquote><p id="b750" class="pw-post-body-paragraph kr ks iq kt b ku my jr kw kx mz ju kz la na lc ld le nb lg lh li nc lk ll lm ij bi translated">关于如何使用Yarn工作空间的更多信息，可以参考他们的<a class="ae mn" href="https://classic.yarnpkg.com/en/docs/workspaces/" rel="noopener ugc nofollow" target="_blank">官方文档</a>。</p><p id="7222" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用yarn工作区，创建新的包是非常容易的。代码变得更加模块化和优雅。我们节省了大量的磁盘空间，也加快了软件包的安装过程。</p><h1 id="1de3" class="lu lv iq bd lw lx ok lz ma mb ol md me jw om jx mg jz on ka mi kc oo kd mk ml bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="cafd" class="pw-post-body-paragraph kr ks iq kt b ku pc jr kw kx pd ju kz la pi lc ld le pj lg lh li pk lk ll lm ij bi translated">在本文中，我们讨论了不同的Monorepo解决方案。我们上面探讨的解决方案可以帮助您以各种方式轻松管理Monorepo。这些解决方案中的大多数主要有助于跨多个模块的依赖性管理，而不必经历很多麻烦。</p><ul class=""><li id="80e6" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">Bazel —在Monorepos中实现快速、正确的分布式构建</li><li id="e336" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">Lerna —优化Monorepo中多个包之间的工作流</li><li id="ea9b" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">bit—mono repo模块间可共享的组件库</li><li id="b294" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">Nx —为Monorepos提供开发工具</li><li id="3f22" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">Yarn工作区—通过一个命令即可跨Monorepo模块安装和符号链接软件包</li></ul><p id="555c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们来看一下这些工具的对比。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qk"><img src="../Images/02febca3752e28a2380b9d8a87614408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rr1a0fS6PtEuloJznv4CWA.png"/></div></div></figure><p id="d47f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此外，这些工具中的大多数也具有相互集成的能力。比如Bit + Yarn工作空间，Lerna + Yarn工作空间等。</p><p id="b1e4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>