<html>
<head>
<title>Stream and RxDart in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">颤振中的流和RxDart</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/streams-and-rxdart-in-flutter-9135ef64912e?source=collection_archive---------0-----------------------#2022-12-17">https://levelup.gitconnected.com/streams-and-rxdart-in-flutter-9135ef64912e?source=collection_archive---------0-----------------------#2022-12-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="199b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本主题中，我们将了解Flutter中的<strong class="jp ir">流</strong>以及<strong class="jp ir"> RxDart </strong>。在本指南中，我们将介绍流和RxDart的基础知识，然后创建应用程序来验证表单字段。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk translated">抖动中的RxDart</figcaption></figure><p id="e71a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的用户界面应该如下所示:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/ecbdfcc21642eaa366396888b325f9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*zgsNyMNq-LN0Ls0HqC96yw.png"/></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk translated">RxDart</figcaption></figure><p id="3d0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们来讨论一下本指南的主题。</p><h2 id="5e3c" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated"><strong class="ak">流</strong></h2><p id="9b61" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">流是一系列异步事件。简单地说，流也可以描述为管道。你在一端输入一个值，如果另一端有一个监听器，这个监听器就会收到这个值。</p><p id="77bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个流可以有多个侦听器，当它被放入管道时，所有这些侦听器将接收相同的值。将值放在流上的方法是使用StreamController。</p><p id="0ac3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两种类型的流:单个订阅或广播。</p><h2 id="92c0" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">RxDart</h2><p id="b7bc" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">RxDart是一个结合了react vex(Rx)流的强大功能和Dart语言优点的库。这是一个用于Dart和Flutter的反应式编程库，允许您以声明方式表达应用程序中的数据流。</p><p id="a16a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">RxDart为Streams API添加了额外的功能，包括去抖动、节流和重试失败事件的能力，以及添加了处理单值(可观察)流的能力。</p><p id="57ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">RxDart有一些科目。</p><blockquote class="lx ly lz"><p id="5dbd" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">这些主题类型有一些不同，特别是在如何存储和传递给侦听器方面。然而，它们都是广播(热)控制器，这意味着流可以监听多次。它们都使用Dart的StreamController，并具有将传递给StreamController的onListen、onCancel和sync参数。</p></blockquote><ul class=""><li id="bf8c" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated"><strong class="jp ir"> PublishSubject: </strong>这就像一个标准的streamController，但是Stream返回一个Observable而不是Stream。</li><li id="1a9c" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated"><strong class="jp ir"> BehaviorSubject: </strong>它只捕获最新添加的项目。当新的侦听器开始侦听控制器时，它将接收存储的项。之后，任何新事件都将被发送给所有侦听器。或者，您可以设置一个种子值，该值仅在没有项目添加到主题时使用。</li><li id="cd30" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated"><strong class="jp ir"> ReplaySubject: </strong>它捕获所有已添加的项目。当新的监听器开始监听控制器时，它将接收所有项目。之后，任何新事件都将被发送给所有侦听器。</li></ul><p id="9817" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这些主题之后，让我们回到一些编码。</p><p id="f727" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们在<strong class="jp ir"> lib </strong>文件夹中创建名为<code class="fe ms mt mu mv b"><strong class="jp ir"><em class="ma">validator.dart</em></strong></code> <strong class="jp ir"> <em class="ma"> </em> </strong>的新文件。</p><p id="2691" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在内部，让我们创建<strong class="jp ir"> <em class="ma">行为主题</em> </strong>，因为根据UI，我们有两个字段需要验证。</p><pre class="kl km kn ko gt mw mv mx bn my mz bi"><span id="5611" class="na la iq mv b be nb nc l nd ne">final _email = BehaviorSubject&lt;String&gt;.seeded('@');<br/>final _message = BehaviorSubject&lt;String&gt;.seeded('');</span></pre><p id="40b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在<strong class="jp ir">流</strong>和<strong class="jp ir">沉</strong>田。</p><pre class="kl km kn ko gt mw mv mx bn my mz bi"><span id="0a69" class="na la iq mv b be nb nc l nd ne">Stream&lt;String&gt; get email =&gt; _email.stream;<br/>Sink&lt;String&gt; get sinkEmail =&gt; _email.sink;<br/><br/>Stream&lt;String&gt; get message =&gt; _message.stream;<br/>Sink&lt;String&gt; get sinkMessage =&gt; _message.sink;</span></pre><p id="0f3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将需要两个<strong class="jp ir"><em class="ma">stream transformers</em></strong>，因为我们将用我们的逻辑转换流中的数据。</p><blockquote class="lx ly lz"><p id="5773" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">StreamTransformer是Dart编程语言的一个类。它代表一个转换器，接受一个数据流并将其转换为另一个数据流。</p><p id="9011" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">StreamTransformer类通常用于在将流发出的数据传递给流的侦听器之前对其进行修改。这对于您希望在侦听器接收到流发出的数据之前对其进行某种转换的情况非常有用。</p></blockquote><pre class="kl km kn ko gt mw mv mx bn my mz bi"><span id="df3e" class="na la iq mv b be nb nc l nd ne">final validateEmail =<br/>      StreamTransformer&lt;String, String&gt;.fromHandlers(handleData: (value, sink) {<br/>    if (value.length != 1) {<br/>      isEmail(value)<br/>          ? sink.add(value)<br/>          : sink.addError('Please enter valid email');<br/>    }<br/>  });<br/><br/><br/>  final validateMessage =<br/>      StreamTransformer&lt;String, String&gt;.fromHandlers(handleData: (value, sink) {<br/>    if (value.length != 0) {<br/>      value.length &gt;= 8<br/>          ? sink.add(value)<br/>          : sink.addError('Message should be 8 characters long');<br/>    }<br/>  });</span></pre><p id="8919" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们会经过我们溪流中的两个变压器。</p><pre class="kl km kn ko gt mw mv mx bn my mz bi"><span id="016f" class="na la iq mv b be nb nc l nd ne">  Stream&lt;String&gt; get email =&gt; _email.stream.transform(validateEmail);<br/>  Sink&lt;String&gt; get sinkEmail =&gt; _email.sink;<br/><br/>  Stream&lt;String&gt; get message =&gt; _message.stream.transform(validateMessage);<br/>  Sink&lt;String&gt; get sinkMessage =&gt; _message.sink;</span></pre><p id="86ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的流中传递了转换器之后，我们需要另一个流来获得上面两个流的结果。如果两个条件都满足，这个新的流将向按钮发送一个布尔值true，并使其可点击。</p><pre class="kl km kn ko gt mw mv mx bn my mz bi"><span id="14a3" class="na la iq mv b be nb nc l nd ne">Stream&lt;bool&gt; get submitValid =&gt; <br/>Rx.combineLatest2(email, message, (e, m) =&gt; true);</span></pre><p id="3b5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以用验证器接收我们的UI，如下所示:</p><pre class="kl km kn ko gt mw mv mx bn my mz bi"><span id="3581" class="na la iq mv b be nb nc l nd ne">StreamBuilder(<br/>              stream: validation.email,<br/>              builder: (_, snapShot) =&gt; TextField(<br/>                onChanged: (val) =&gt; validation.sinkEmail.add(val),<br/>                decoration: InputDecoration(<br/>                    hintText: 'Email',<br/>                    errorText:<br/>                        snapShot.hasError ? snapShot.error.toString() : null),<br/>                keyboardType: TextInputType.emailAddress,<br/>              ),<br/>            ),</span></pre><p id="0397" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们结束了。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="nf kr l"/></div></figure><h1 id="313c" class="ng la iq bd lb nh ni nj le nk nl nm lh nn no np lk nq nr ns ln nt nu nv lq nw bi translated">结论</h1><p id="6215" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">您已经学习了Flutter中Streams和Rxdart的概念和用法。这个主题对你来说可能是新的，但是在你的应用中应用起来非常简单和有效。</p><p id="ff14" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，请点击👏图标，为您提供传递所有新事物的动力。</p><p id="bf41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，关注令人兴奋的文章和项目的更新。</p><h1 id="fa07" class="ng la iq bd lb nh ni nj le nk nl nm lh nn no np lk nq nr ns ln nt nu nv lq nw bi translated">让我们连接起来</h1><p id="a6bb" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">我们可以成为朋友。在<a class="ae nx" href="https://www.facebook.com/nabin.dhakal.714/" rel="noopener ugc nofollow" target="_blank">脸书</a>、<a class="ae nx" href="https://www.linkedin.com/in/nabindhakal/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>、<a class="ae nx" href="https://github.com/nbnD" rel="noopener ugc nofollow" target="_blank"> Github </a>、<a class="ae nx" href="https://www.youtube.com/channel/UCW6oYt_3QSl7J2HSHNqwXWw" rel="noopener ugc nofollow" target="_blank"> Youtube </a>、<a class="ae nx" href="https://www.buymeacoffee.com/nabindhakal" rel="noopener ugc nofollow" target="_blank"> BuyMeACoffee </a>和<a class="ae nx" href="https://www.instagram.com/nbn_d_/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上查找。</p><p id="f968" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">访问:<a class="ae nx" href="https://flutterjunction.com/" rel="noopener ugc nofollow" target="_blank">颤振连接</a></p><p id="36ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">投稿:</strong> <a class="ae nx" href="https://www.buymeacoffee.com/nabindhakal" rel="noopener ugc nofollow" target="_blank"> BuyMeACoffee </a></p><p id="a039" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">完整代码:</strong></p><div class="ny nz gp gr oa ob"><a href="https://github.com/nbnD/streams_rxdart" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">GitHub - nbnD/streams_rxdart</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">一个新的颤振项目。这个项目是颤振应用的起点。一些帮助您入门的资源…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">github.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op kx ob"/></div></div></a></div><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi oq"><img src="../Images/fa0908710a29b900d1e2d04535c923e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-4hBf2KI0Yvl_JvEl5yVQ.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk translated">抖动中的RxDart</figcaption></figure></div></div>    
</body>
</html>