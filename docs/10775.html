<html>
<head>
<title>Get Redis Up and Running on Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让Redis在Docker上运行</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/get-redis-up-and-running-on-docker-4af011db9bc7?source=collection_archive---------12-----------------------#2022-01-10">https://levelup.gitconnected.com/get-redis-up-and-running-on-docker-4af011db9bc7?source=collection_archive---------12-----------------------#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f3cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过CLI和Docker Compose在本地机器上设置Redis Docker容器的分步指南。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b61eeff5f9d2cad7ea797fcd258c7582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AKLsWqF_Yq5PIINw"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@exdigy" rel="noopener ugc nofollow" target="_blank">张秀坤·吕克曼</a>在<a class="ae le" href="https://www.unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="b554" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">先决条件</p><ul class=""><li id="5ecc" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><a class="ae le" href="https://www.docker.com/get-started" rel="noopener ugc nofollow" target="_blank">码头工人</a></li></ul><h2 id="183c" class="lo lp it bd lq lr ls dn lt lu lv dp lw kb lx ly lz kf ma mb mc kj md me mf mg bi translated">我们将在本教程中做什么</h2><p id="884a" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">本教程将教你如何直接通过CLI启动我们的本地<a class="ae le" href="https://hub.docker.com/_/redis" rel="noopener ugc nofollow" target="_blank"> Redis Docker映像</a>作为Docker容器，并准备一个Docker组合文件来设置它。</p><p id="abc0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">和往常一样，您可以在链接的GitHub资源库中找到本教程中使用的代码:</p><div class="mm mn gp gr mo mp"><a href="https://github.com/Abszissex/medium-docker-redis" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd iu gy z fp mu fr fs mv fu fw is bi translated">GitHub-abszisex/medium-docker-redis</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">github.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd ky mp"/></div></div></a></div><h2 id="7420" class="lo lp it bd lq lr ls dn lt lu lv dp lw kb lx ly lz kf ma mb mc kj md me mf mg bi translated">通过CLI在Docker容器中运行Redis</h2><p id="b280" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">在本地机器上运行Redis最简单的方法是使用一个<a class="ae le" href="https://hub.docker.com/_/redis" rel="noopener ugc nofollow" target="_blank">预构建的Docker映像</a>。</p><p id="d69e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用Docker，您可以使用两种不同的方式来启动您的容器。要么通过<code class="fe ne nf ng nh b">docker run ...</code> CLI命令直接运行它，要么使用<a class="ae le" href="https://docs.docker.com/compose/" rel="noopener ugc nofollow" target="_blank"> Docker Compose </a>并采用声明式方法。</p><p id="b288" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将向您展示这两种方法，但是我总是推荐声明性方法(Docker Compose)而不是命令性方法(Docker CLI)。</p><p id="0fc4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">以附加模式运行Redis容器</strong></p><p id="bcc8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第一种也是最直接的方法是通过Docker CLI直接运行Redis。以下命令就是这样做的:</p><pre class="kp kq kr ks gt ni nh nj nk aw nl bi"><span id="7997" class="lo lp it nh b gy nm nn l no np">docker run -p 6379:6379 --rm --name dRedis redis:6.2.6-alpine</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/21fa4879f39fb14405a0a2df9a739474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDlbBJCEdD1X5wraDS3UVA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">通过Docker CLI运行Redis</figcaption></figure><p id="6663" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们一步一步地检查上面提到的命令，看看各个参数是做什么的。</p><ul class=""><li id="5882" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><code class="fe ne nf ng nh b">docker run</code> —我们正在触发<code class="fe ne nf ng nh b">run</code>命令来启动一个新的容器</li><li id="99f5" class="lf lg it js b jt nr jx ns kb nt kf nu kj nv kn lk ll lm ln bi translated"><code class="fe ne nf ng nh b">-p 6379:6379</code> —我们通过将docker容器的端口<code class="fe ne nf ng nh b">6379</code>转发到主机的端口<code class="fe ne nf ng nh b">6379</code>来进行端口映射。Redis在端口<code class="fe ne nf ng nh b">6379</code>上默认运行。</li><li id="f772" class="lf lg it js b jt nr jx ns kb nt kf nu kj nv kn lk ll lm ln bi translated"><code class="fe ne nf ng nh b">--rm</code> —我们希望在中断命令时删除Docker容器。如果您只想运行容器一次，并且不想在运行后留下“浪费”,那么<code class="fe ne nf ng nh b">—-rm </code>参数非常好。</li><li id="30df" class="lf lg it js b jt nr jx ns kb nt kf nu kj nv kn lk ll lm ln bi translated"><code class="fe ne nf ng nh b">--name dRedis</code> —指定容器名称。如果以后要引用容器，命名容器非常有用，这样就不必使用自动生成的哈希值/id。请记住，容器名称需要在您的系统中是唯一的。</li><li id="4a1b" class="lf lg it js b jt nr jx ns kb nt kf nu kj nv kn lk ll lm ln bi translated"><code class="fe ne nf ng nh b">redis:6.2.6-alpine</code> —我们要运行的Docker映像。在这种情况下，我们希望在版本6.2.6中运行Redis的alpine版本。</li></ul><p id="4a39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可能已经注意到，如果中断该命令，Redis容器会被删除。所以<code class="fe ne nf ng nh b">--rm</code>变体对于开发来说是极好的，但是如果你想让你的Redis容器继续运行的话，就相当糟糕了。</p><p id="e844" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">以分离模式运行Redis容器</strong></p><p id="0d1d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以通常你会用<code class="fe ne nf ng nh b">-d</code>代替<code class="fe ne nf ng nh b">--rm</code>参数。<code class="fe ne nf ng nh b">-d</code>参数是“detached”的简称，表示容器要从终端脱离，在后台运行。</p><p id="35e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用以下命令，您可以在后台运行Redis容器:</p><pre class="kp kq kr ks gt ni nh nj nk aw nl bi"><span id="6de7" class="lo lp it nh b gy nm nn l no np">docker run -p 6379:6379 -d --name dRedis redis:6.2.6-alpine</span></pre><p id="37cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是现在，您需要另一种方法来停止并再次移除容器。幸运的是，我们为Docker容器添加了一个名称，以便于引用它。</p><p id="0c76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下命令停止并删除创建的Redis容器</p><pre class="kp kq kr ks gt ni nh nj nk aw nl bi"><span id="150a" class="lo lp it nh b gy nm nn l no np">docker stop dRedis<br/>docker rm dRedis</span></pre><p id="1cdf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下一张图中，你可以看到我是如何</p><ul class=""><li id="31e6" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">通过<code class="fe ne nf ng nh b">docker run</code>启动一个分离的Redis Docker容器</li><li id="51f0" class="lf lg it js b jt nr jx ns kb nt kf nu kj nv kn lk ll lm ln bi translated">使用<code class="fe ne nf ng nh b">docker ps -a</code>检查运行中的容器</li><li id="4918" class="lf lg it js b jt nr jx ns kb nt kf nu kj nv kn lk ll lm ln bi translated">通过<code class="fe ne nf ng nh b">docker stop</code>和<code class="fe ne nf ng nh b">docker rm</code>停止并移除创建的容器</li><li id="e417" class="lf lg it js b jt nr jx ns kb nt kf nu kj nv kn lk ll lm ln bi translated">检查码头工人是否通过<code class="fe ne nf ng nh b">docker ps -a</code>移除了容器</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/6ebccd3031b61480d336960faef1d44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D8-kPu5Uj3Pypp6zmJVxw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">处于分离状态的Redis Docker容器</figcaption></figure><p id="3ddc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ne nf ng nh b">docker ps</code>命令的<code class="fe ne nf ng nh b">-a</code>参数显示所有容器。因为默认情况下，<code class="fe ne nf ng nh b">docker ps</code>命令只显示当前正在运行的，所以我们可以验证我们的容器不仅仅是被停止了，而是被删除了。</p><h2 id="3778" class="lo lp it bd lq lr ls dn lt lu lv dp lw kb lx ly lz kf ma mb mc kj md me mf mg bi translated">通过Docker Compose在Docker容器中运行Redis</h2><p id="c476" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">除了通过Docker CLI运行Redis之外，一种更容易再现的方法是使用Docker Compose。此外，它使其具有声明性，您还可以将它添加到VCS中，这对于命令式命令来说并不总是那么容易。</p><p id="2d60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下面的<code class="fe ne nf ng nh b">docker-compose.yaml</code>中，您可以看到与Docker CLI相同的定义。我们通过<code class="fe ne nf ng nh b">image</code>定义我们想要运行的图像，通过<code class="fe ne nf ng nh b">container_name</code>定义我们容器的名称，尽管我们在这里选择了一个不同的名称，并通过<code class="fe ne nf ng nh b">ports</code>定义端口映射。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="e97b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在剩下的唯一一件事就是使用下面的命令运行这个声明:</p><p id="58c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ne nf ng nh b">docker-compose up -d</code></p><p id="9f96" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里的<code class="fe ne nf ng nh b">-d</code>也是“detached”的简称，所以我们不把容器的运行与我们的终端联系起来。</p><p id="3809" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我们不再需要我们的容器时，我们可以使用<code class="fe ne nf ng nh b">down</code>命令再次关闭它:</p><p id="eb50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ne nf ng nh b">docker-compose down</code></p><p id="78a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，让我们验证Docker是否正确设置了所有内容，并且运行正常:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nz"><img src="../Images/ec3ac8d90be75d2bc0608bd3ff4fb578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3DtqqGYdoiDpmAj8QvMTKQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">通过“docker-compose”重新分发Docker容器</figcaption></figure><p id="9e1b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如你所看到的，当你选择<code class="fe ne nf ng nh b">docker-compose</code>而不是<code class="fe ne nf ng nh b">docker run</code>时，理解发生了什么变得超级容易和容易。特别是当它变得更复杂时，比如在一个Docker合成文件中定义多个容器或添加卷，CLI方式很快就会变得混乱。</p><h2 id="adda" class="lo lp it bd lq lr ls dn lt lu lv dp lw kb lx ly lz kf ma mb mc kj md me mf mg bi translated">摘要</h2><p id="1eda" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">几乎所有的东西都应该在Docker容器中运行以方便使用，尤其是考虑到本地开发。我希望本教程能够为您提供一个在本地机器上运行自己的Redis实例的快速入门。</p><h2 id="cfc9" class="lo lp it bd lq lr ls dn lt lu lv dp lw kb lx ly lz kf ma mb mc kj md me mf mg bi translated">你想联系吗？</h2><p id="6350" class="pw-post-body-paragraph jq jr it js b jt mh jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj ml kl km kn im bi translated">如果你想联系我，请在LinkedIn上打电话给我。</p><p id="c598" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另外，请随意查看我的书籍推荐📚。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><div class="kp kq kr ks gt mp"><a href="https://mr-pascal.medium.com/my-book-recommendations-4b9f73bf961b" rel="noopener follow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd iu gy z fp mu fr fs mv fu fw is bi translated">我的书籍推荐</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">在接下来的章节中，你可以找到我对所有日常生活话题的书籍推荐，它们对我帮助很大。</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="my l"><div class="oh l na nb nc my nd ky mp"/></div></div></a></div><div class="mm mn gp gr mo mp"><a href="https://mr-pascal.medium.com/membership" rel="noopener follow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd iu gy z fp mu fr fs mv fu fw is bi translated">通过我的推荐链接加入Medium—Pascal Zwikirsch</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="my l"><div class="oi l na nb nc my nd ky mp"/></div></div></a></div></div></div>    
</body>
</html>