# å½“ Python é™·é˜±å¯¼è‡´é”™è¯¯ç»“æœæ—¶

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/when-a-python-gotcha-leads-to-wrong-results-2447f379fdfe>

## ä¸€ä¸ªå¥‡æ€ªçš„éš¾ä»¥è°ƒè¯•çš„å¸¦æœ‰èˆå…¥æ•°å­—çš„ Python æ•…éšœ

![](img/37bc24ec8d755f3a620f2f34f142cf75.png)

ä½œè€…ç…§ç‰‡

æˆ‘å¿—æ„¿æ‹…ä»» [Dataquest](https://www.dataquest.io/) çš„ç¤¾åŒºç‰ˆä¸»ã€‚æœ‰ä¸€æ¬¡ï¼Œæˆ‘åœ¨å›ç­”ä¸€ä½å­¦å‘˜æå‡ºçš„ä¸€ä¸ªçœ‹ä¼¼ç®€å•çš„é—®é¢˜ã€‚ä»»åŠ¡æ˜¯å†™ä¸€ä¸ªå‡½æ•°`divide_apples`,ç»™å®šä¸¤ä¸ªæ•°å­—(è‹¹æœå’Œäºº),è¿”å›æ¯ä¸ªäººçš„è‹¹æœæ•°é‡å’Œå‰©ä¸‹çš„è‹¹æœæ•°é‡ã€‚è¯¥å­¦ç”Ÿç¼–å†™äº†ä¸‹é¢çš„å‡½æ•°(ä¸ºäº†æ›´å¥½çš„å¯è¯»æ€§ï¼Œæˆ‘å¯¹å®ƒè¿›è¡Œäº†è½»å¾®çš„é‡æ„ï¼Œå¹¶æ›´æ”¹äº†å˜é‡å):

```
def divide_apples(num_apples, num_people):    
    apples_each = num_apples // num_people
    apples_divided_strictly = num_apples / num_people
    leftovers_per_person = apples_divided_strictly - apples_each
    apples_left = int(leftovers_per_person * num_people)
    return apples_each, apples_left
```

è¿™å¯èƒ½ä¸æ˜¯æœ€ç›´æ¥çš„è§£å†³æ–¹æ¡ˆ(ç¨åï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€ä¸ªæ›´ç®€æ´çš„æ–¹æ¡ˆ)ï¼Œä½†æ— è®ºå¦‚ä½•ï¼Œæ‰€æœ‰æ­¥éª¤ä¼¼ä¹åœ¨æŠ€æœ¯ä¸Šéƒ½æ˜¯æ­£ç¡®çš„ã€‚äº‹å®ä¸Šï¼Œå®ƒåœ¨å‡ ä¸ªè¾“å…¥å¯¹è‹¹æœ-äººçš„æƒ…å†µä¸‹å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†æ˜¯åœ¨ 37 ä¸ªè‹¹æœå’Œ 7 ä¸ªäººçš„æƒ…å†µä¸‹å‡ºç°äº†é—®é¢˜:

```
num_apples = 37
num_people = 7print(divide_apples(num_apples, num_people))**Output:** (5, 1)
```

ä½†å¾ˆæ˜æ˜¾ï¼Œè¿™ç§æƒ…å†µä¸‹å‰©ä¸‹çš„è‹¹æœæ•°åº”è¯¥æ˜¯ 2ï¼Œè€Œä¸æ˜¯ 1ã€‚ä¸ºäº†è°ƒè¯•ä»£ç ï¼Œè®©æˆ‘ä»¬å†æ·»åŠ ä¸¤ä¸ªä»æˆ‘ä»¬çš„å‡½æ•°è¿”å›çš„å€¼:`apples_divided_strictly`(å½“å‰©ä½™çš„è‹¹æœä»¥å¤–ç§‘åŒ»ç”Ÿçš„ç²¾åº¦è¢«åˆ‡å¼€ï¼Œå¹¶ä¸”è¿™äº›è‹¹æœå—è¢«å¹³å‡åˆ†é…ç»™æ‰€æœ‰å‚ä¸è€…)å’Œ`leftovers_per_person`ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å†æ¬¡å¯¹ 37 ä¸ªè‹¹æœå’Œ 7 ä¸ªäººè¿è¡Œä¿®æ”¹åçš„å‡½æ•°:

```
def divide_apples(num_apples, num_people):    
    apples_each = num_apples // num_people
    apples_divided_strictly = num_apples / num_people
    leftovers_per_person = apples_divided_strictly - apples_each
    apples_left = int(leftovers_per_person * num_people)
    return apples_each, apples_left, apples_divided_strictly, leftovers_per_person 

print(divide_apples(num_apples, num_people))**Output:** (5, 1, 5.285714285714286, 0.2857142857142856)
```

æˆ‘ä»¬æ¥çœ‹çœ‹`apples_divided_strictly`çš„ç»“æœå€¼ã€‚å¦‚æœæˆ‘ä»¬ç”¨é«˜ç²¾åº¦è®¡ç®—å™¨[å°† 37 é™¤ä»¥ 7ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªå¾ªç¯åè¿›åˆ¶æ•°:5ã€‚**285714**285714285714285714285714(æ­¤å¤„ç²¾åº¦ä¸º 31)ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒPython é‡‡ç”¨äº†è¿™ä¸ªå€¼å¹¶å°†å…¶å››èˆäº”å…¥åˆ° 16 ä½å°æ•°:5.285714285714286ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬è·³è¿‡ä¸ºä»€ä¹ˆæ­£å¥½æ˜¯ 16 çš„é—®é¢˜ï¼Œè¿™é‡Œé‡è¦çš„æ˜¯å®ƒæ­£ç¡®åœ°åšäº†ã€‚](https://apfloat.appspot.com/)

ä¸‹ä¸€æ­¥æ˜¯è®¡ç®—`leftovers_per_person`ï¼Œè¿™é‡Œæˆ‘ä»¬æœŸæœ›ä»`apples_divided_strictly`(ä¹Ÿæ˜¯ 5)çš„æ•´ä¸ªéƒ¨åˆ†ä¸­æå–æ•´æ•°(5)ã€‚è¯¥æ“ä½œçš„é€»è¾‘ç»“æœæ˜¯`leftovers_per_person`çš„å°æ•°éƒ¨åˆ†ï¼Œå³ 0.285714285714286ã€‚ç„¶è€Œï¼Œ`leftovers_per_person`çš„**å®é™…**å€¼ç•¥æœ‰ä¸åŒ:

```
Expected value: 0.285714285714286
Actual value:   0.2857142857142856
```

æˆ‘ä»¬çœ‹åˆ°å®é™…å€¼å¤šäº†ä¸€ä½å°æ•°ã€‚**æ›´é‡è¦çš„æ˜¯:**è€ƒè™‘åˆ°è®¡ç®—è¯¥å€¼çš„åˆå§‹å¾ªç¯åè¿›åˆ¶æ•° 5.285714285714ï¼Œè¯¥å€¼åœ¨æ•°å­¦ä¸Šèˆå…¥æœ‰è¯¯ï¼è®°ä½è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è®¡ç®—`apples_left`çš„é‚£æ¡çº¿:

```
apples_left = int(leftovers_per_person * num_people)
```

è¯•ç€è®¡ç®—æ‹¬å·ä¸­çš„ä»£ç æ®µï¼ŒåŒ…æ‹¬`leftovers_per_person`çš„å€¼(é¢„æœŸå€¼å’Œå®é™…å€¼)ä»¥åŠæˆ‘ä»¬é‡åˆ°æŠ€æœ¯æ•…éšœçš„ 7 ä¸ªäºº:

```
print(0.285714285714286 * 7)
print(0.2857142857142856 * 7)**Output:**
2.0000000000000018
1.9999999999999991
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°é—®é¢˜æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼å½“ç„¶ï¼Œ`int(1.9999999999999991)=1`ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å‡½æ•°ä¼šè¿”å›å‰©ä¸‹çš„ 1 ä¸ªè‹¹æœï¼Œç»™å®š 37 ä¸ªè‹¹æœå’Œ 7 ä¸ªäººã€‚å¦åˆ™ï¼Œä½¿ç”¨æ­£ç¡®èˆå…¥çš„å€¼`leftovers_per_person`(é¢„æœŸå€¼)ï¼Œæˆ‘ä»¬å°†å¾—åˆ° 2 ä¸ªè‹¹æœï¼Œè¿™æ˜¯æ­£ç¡®çš„ç­”æ¡ˆã€‚

ç„¶è€Œï¼Œè¿™ä»ç„¶ä¸æ˜¯æ•…äº‹çš„ç»“å°¾ã€‚Python å¦‚æ­¤ç³Ÿç³•åœ°èˆå…¥äº†è¿™ä¸ªå€¼ï¼Œéš¾é“æˆ‘ä»¬åªæ˜¯è¿æ°”ä¸å¥½å—ï¼Ÿ

è®©æˆ‘ä»¬åšä¸€ä¸ªå°å®éªŒã€‚æ•°å­— 0.285714285714285714 ä¹Ÿæ˜¯ä¸€ä¸ªå¾ªç¯åè¿›åˆ¶æ•°ï¼Œå®ƒå®é™…ä¸Šæ˜¯`leftovers_per_person`çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥(è¿™æ¬¡æ˜¯æ­£ç¡®çš„)èˆå…¥åˆ°ä»»ä½•å°æ•°ç‚¹ã€‚çš„ç¡®ï¼Œæˆ‘ä»¬çš„å®éªŒä¼šæ˜¯åœ¨ä¸åŒçš„å°æ•°ç‚¹ä¸Šå››èˆäº”å…¥(æ¯”å¦‚ä» 18 ä¸ªå°æ•°ç‚¹å¼€å§‹é€’å‡)ï¼Œå†ä¹˜ä»¥ 7(åŒæ ·çš„ 7 ä¸ªäºº)ã€‚å¯¹äºæ¯ä¸ªèˆå…¥å€¼ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä¸¤æ¬¡è¯¥æ“ä½œ:æ•°å­¦ä¸Šçš„å’Œâ€œpython åŒ–çš„â€ã€‚æ‚¨å¯ä»¥åœ¨[è®¡ç®—å™¨](https://apfloat.appspot.com/)ä¸­è¿è¡Œæ¯ä¸ªè¿ç®—ï¼Œæ£€æŸ¥ä¸‹é¢æŠ¥å‘Šçš„æ•°å­¦ç»“æœã€‚

```
print(  f'1\. Python: {0.285714285714285714*7} \n   Maths:  1.999999999999999998\n'
      f'\n2\. Python: {0.28571428571428571*7} \n   Maths:  1.99999999999999997\n'    
      f'\n3\. Python: {0.2857142857142857*7} \n   Maths:  1.9999999999999999\n'
      f'\n4\. Python: {0.285714285714286*7} \n   Maths:  2.000000000000002\n'
      f'\n5\. Python: {0.28571428571429*7} \n   Maths:  2.00000000000003\n'
      f'\n6\. Python: {0.2857142857143*7} \n   Maths:  2.0000000000001\n'
      f'\n7\. Python: {0.285714285714*7} \n   Maths:  1.999999999998\n'
      f'\n8\. Python: {0.28571428571*7} \n   Maths:  1.99999999997\n'
      f'\n9\. Python: {0.2857142857*7} \n   Maths:  1.9999999999\n'
      f'\n10.Python: {0.285714286*7} \n   Maths:  2.000000002\n')**Output:** 1\. Python: 2.0 
   Maths:  1.999999999999999998

2\. Python: 2.0 
   Maths:  1.99999999999999997

3\. Python: 2.0 
   Maths:  1.9999999999999999

4\. Python: 2.0000000000000018 
   Maths:  2.000000000000002

5\. Python: 2.0000000000000298 
   Maths:  2.00000000000003

6\. Python: 2.0000000000001004 
   Maths:  2.0000000000001

7\. Python: 1.9999999999979998 
   Maths:  1.999999999998

8\. Python: 1.99999999997 
   Maths:  1.99999999997

9\. Python: 1.9999999999 
   Maths:  1.9999999999

10.Python: 2.0000000019999997 
   Maths:  2.000000002
```

æˆ‘ä»¬å¯ä»¥åšå‡ºå¦‚ä¸‹è§‚å¯Ÿ:

*   Python å°†å…·æœ‰ 16 ä¸ªæˆ–æ›´å¤šå°æ•°ç‚¹çš„å€¼çš„ç»“æœå››èˆäº”å…¥ä¸º 2.0(ä¾‹ 1â€“3)ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œç›¸åŒæƒ…å†µä¸‹çš„æ•°å­¦ç»“æœå°äº 2(å› æ­¤ï¼Œå®ƒä»¬ä¸­æ¯ä¸€ä¸ªçš„æ•´ä¸ªéƒ¨åˆ†éƒ½æ˜¯ 1)ã€‚
*   å‡ ä¹åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼ŒPython èˆå…¥éƒ½ä¸åŒäºæ•°å­¦èˆå…¥ã€‚è¿™æ˜¯ç”±äº Python åœ¨å¤„ç†æµ®ç‚¹æ•°æ—¶çš„ä¸å®Œå–„ã€‚åœ¨[è¿™ç¯‡æ•™ç¨‹](https://docs.python.org/3/tutorial/floatingpoint.html)ä¸­ï¼Œä½ å¯ä»¥è¯»åˆ°æ›´å¤šå…³äºå®ƒçš„å†…å®¹ï¼Œä½†ç®€è€Œè¨€ä¹‹ï¼Œå®ƒè¯•å›¾å°†åè¿›åˆ¶æ•°æ¸²æŸ“æˆäºŒè¿›åˆ¶æ•°ï¼Œè¿™æœ‰æ—¶ä¼šå¯¼è‡´æ€ªå¼‚çš„ç»“æœï¼Œç¼ºä¹ç²¾åº¦ã€‚
*   å³ä½¿åªè€ƒè™‘**çš„æ•°å­¦èˆå…¥ï¼Œæˆ‘ä»¬çœ‹åˆ°å¯¹äºç›¸åŒçš„è¿ç®—ï¼Œæ ¹æ®æ‰€é€‰çš„ç²¾åº¦ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªå°äº 2 æˆ–å¤§äº 2 çš„æ•°ã€‚è¿™å¯¹äºæˆ‘ä»¬åœ¨ 7 ä¸ªäººä¹‹é—´åˆ†é… 37 ä¸ªè‹¹æœçš„åˆå§‹ä»»åŠ¡æ¥è¯´æ˜¯ä¸åŒçš„:æˆ‘ä»¬éœ€è¦è·å¾— 2ï¼Œè€Œä¸æ˜¯ 1 ä½œä¸ºæœ€ç»ˆçš„æ•´æ•°å€¼ã€‚**

è®©æˆ‘ä»¬è¿”å›åˆ°`leftovers_per_person`çš„**é¢„æœŸ**å€¼ï¼Œå³ 0.2828528526865 åœ¨ä¸Šé¢çš„åˆ—è¡¨ä¸­ï¼Œå®ƒå¯¹åº”äºæƒ…å†µ 4ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œåœ¨æ•°å­¦ä¸Šå’Œ than åŒ–ä¸Šï¼Œæˆ‘ä»¬å°†æ”¶åˆ°ä¸€ä¸ªå¤§äº 2 çš„åè¿›åˆ¶æ•°ï¼Œå› æ­¤æ˜¯ä¸€ä¸ªæ•´æ•° 2ï¼Œå³æ­£ç¡®çš„ç»“æœã€‚è¿™æ„å‘³ç€åœ¨è¿™é‡Œæˆ‘ä»¬å°†æ˜¯å¹¸è¿çš„ï¼Œåªæ˜¯ Python å†æ¬¡å‡ºé”™ï¼Œå¢åŠ äº†ä¸€ä¸ªé¢å¤–çš„å°æ•°ç‚¹ï¼Œå¹¶ä¸”èˆå…¥ä¸æ­£ç¡®ã€‚

å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨[åœ°æ¿åˆ’åˆ†](https://www.educative.io/edpresso/floor-division)å’Œ[æ¨¡æ•°](https://en.wikipedia.org/wiki/Modulo_operation)ä»¥ä¸€ç§æ— é™·é˜±(ä¹Ÿæ›´ä¼˜é›…)çš„æ–¹å¼ä¿®æ”¹æˆ‘ä»¬çš„å‡½æ•°:

```
def divide_apples(num_apples, num_people):
    return num_apples // num_people, num_apples % num_peopleprint(divide_apples(num_apples, num_people))**Output:** (5, 2)
```

# ç»“è®º

åƒæœ¬æ–‡ä¸­è®¨è®ºçš„å°æ•…éšœé€šå¸¸å¾ˆéš¾å‘ç°å’Œè°ƒè¯•ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæœ‰æ—¶å®ƒä»¬ä¼šå¯¼è‡´å¥‡æ€ªçš„ç»“æœï¼Œä»è€Œå¾—å‡ºé”™è¯¯çš„ç»“è®ºã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ¢è®¨äº† Python ä¸­èˆå…¥çš„ä¸€äº›æ½œåœ¨é™åˆ¶ï¼Œä»¥åŠä¸€èˆ¬æ•°å­¦ä¸­çš„é™åˆ¶ã€‚

æ„Ÿè°¢é˜…è¯»ï¼

ä½ å¯èƒ½ä¹Ÿä¼šå¯¹è¿™äº›æ–‡ç« æ„Ÿå…´è¶£

[](https://medium.com/geekculture/creating-toyplots-in-python-49de0bb27ec1) [## åœ¨ Python ğŸ§¸ä¸­åˆ›å»ºç©å…·å›¾

### é«˜è´¨é‡çš„æç®€äº¤äº’å¼å¯è§†åŒ–ï¼Œéå¸¸é€‚åˆç”µå­å‡ºç‰ˆ

medium.com](https://medium.com/geekculture/creating-toyplots-in-python-49de0bb27ec1) [](https://betterprogramming.pub/read-your-horoscope-in-python-91ca561910e1) [## å¦‚ä½•ç”¨ Python é˜…è¯»ä½ çš„æ˜Ÿåº§è¿åŠ¿

### ç”¨ Python æ‰¾ä¹å­

better ç¼–ç¨‹. pub](https://betterprogramming.pub/read-your-horoscope-in-python-91ca561910e1) [](https://towardsdatascience.com/the-easiest-ways-to-perform-logical-operations-on-two-dictionaries-in-python-88c120fa0c8f) [## åœ¨ Python ä¸­å¯¹ä¸¤ä¸ªå­—å…¸æ‰§è¡Œé€»è¾‘è¿ç®—çš„æœ€ç®€å•æ–¹æ³•

towardsdatascience.com](https://towardsdatascience.com/the-easiest-ways-to-perform-logical-operations-on-two-dictionaries-in-python-88c120fa0c8f)