<html>
<head>
<title>Saving Images From an Object Detector Using TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TensorFlow保存来自对象检测器的图像</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/saving-images-from-an-object-detector-using-tensorflow-3f2d058568ba?source=collection_archive---------10-----------------------#2020-06-03">https://levelup.gitconnected.com/saving-images-from-an-object-detector-using-tensorflow-3f2d058568ba?source=collection_archive---------10-----------------------#2020-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f9b2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用TensorFlow对象检测API构建对象跟踪器，并保存您喜欢的对象类型的图像</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a41a4e00727882d0344ccb1f9b0a1e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Yn0HOega7e6-fVIpqnGS2w.gif"/></div></div></figure><h1 id="c53b" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">介绍</h1><p id="ac83" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在本文中，我将使用<a class="ae mi" href="https://github.com/tensorflow/models/tree/master/research/object_detection" rel="noopener ugc nofollow" target="_blank"> TensorFlow对象检测API </a>，它使用预训练的卷积神经网络并执行对象检测。有几个<a class="ae mi" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md#coco-trained-models" rel="noopener ugc nofollow" target="_blank">预先训练好的CNN模型</a>是从API给我们的，基于地图(平均平均精度)评级。在本教程中，我将使用<code class="fe mj mk ml mm b"><a class="ae mi" href="http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_coco_2018_01_28.tar.gz" rel="noopener ugc nofollow" target="_blank"><strong class="lo iu">ssd_mobilenet_v1_coco</strong></a></code> <strong class="lo iu"> </strong>模型。它是最快的，但与其他方法相比，它的准确性较低。</p><blockquote class="mn mo mp"><p id="21e7" class="lm ln mq lo b lp mr ju lr ls ms jx lu mt mu lx ly mv mw mb mc mx my mf mg mh im bi translated">可选-如果你有一个好的GPU，尝试一个更高的地图值CNN模型</p></blockquote><p id="e010" class="pw-post-body-paragraph lm ln it lo b lp mr ju lr ls ms jx lu lv mu lx ly lz mw mb mc md my mf mg mh im bi translated">现在，我们将继续讨论TensorFlow对象检测API的配置部分:</p><ol class=""><li id="5151" class="mz na it lo b lp mr ls ms lv nb lz nc md nd mh ne nf ng nh bi translated">下载API(克隆或以zip格式下载)——<a class="ae mi" href="https://github.com/tensorflow/models" rel="noopener ugc nofollow" target="_blank"><strong class="lo iu"><em class="mq">点击此处</em> </strong> </a></li><li id="7c2e" class="mz na it lo b lp ni ls nj lv nk lz nl md nm mh ne nf ng nh bi translated">安装所有需要的依赖项— <a class="ae mi" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/installation.md" rel="noopener ugc nofollow" target="_blank"> <strong class="lo iu"> <em class="mq">点击这里</em> </strong> </a></li><li id="bcbe" class="mz na it lo b lp ni ls nj lv nk lz nl md nm mh ne nf ng nh bi translated">从这里下载我的代码— <a class="ae mi" href="https://github.com/ravindu9701/Object-Detection" rel="noopener ugc nofollow" target="_blank"> <strong class="lo iu"> <em class="mq">点击这里</em> </strong> </a></li><li id="4416" class="mz na it lo b lp ni ls nj lv nk lz nl md nm mh ne nf ng nh bi translated">现在复制第三步<strong class="lo iu"><em class="mq"/></strong><em class="mq"/>中的所有文件，粘贴到第一步<strong class="lo iu"><em class="mq"/></strong><em class="mq"/>目录<code class="fe mj mk ml mm b">models-master/research</code></li><li id="64c1" class="mz na it lo b lp ni ls nj lv nk lz nl md nm mh ne nf ng nh bi translated">然后我们必须编译<code class="fe mj mk ml mm b">models-master/research/object_detection</code>中的<code class="fe mj mk ml mm b">.protos</code>文件，为此，您需要打开<code class="fe mj mk ml mm b">models-master/research</code>目录中的命令提示符并运行以下代码片段</li></ol><pre class="kj kk kl km gt nn mm no np aw nq bi"><span id="7afb" class="nr kv it mm b gy ns nt l nu nv">for /f %i in ('dir /b object_detection\protos\*.proto') do protoc object_detection\protos\%i --python_out=.</span></pre></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="02d6" class="nr kv it bd kw od oe dn la of og dp le lv oh oi lg lz oj ok li md ol om lk on bi translated">现在一切都设置好了，让我们检查一下代码</h2><p id="77f3" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">下面的函数用于加载模型。如果你是第一次运行，模型会自动下载。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="9a40" class="pw-post-body-paragraph lm ln it lo b lp mr ju lr ls ms jx lu lv mu lx ly lz mw mb mc md my mf mg mh im bi translated">这部分代码，我已经定义了我们需要使用的模型版本，并将其传递给<code class="fe mj mk ml mm b">load_model</code>函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="f469" class="pw-post-body-paragraph lm ln it lo b lp mr ju lr ls ms jx lu lv mu lx ly lz mw mb mc md my mf mg mh im bi translated">在这部分代码中，首先我将图像从BRG颜色模型转换为RGB颜色模型。因为<code class="fe mj mk ml mm b">ssd_mobilenet_v1_coc_2017_11_11</code>使用了BRG颜色模型。转换后的图像将传递给<code class="fe mj mk ml mm b">person_detect</code>函数。</p><p id="eced" class="pw-post-body-paragraph lm ln it lo b lp mr ju lr ls ms jx lu lv mu lx ly lz mw mb mc md my mf mg mh im bi translated"><code class="fe mj mk ml mm b">output_dict</code>由TensorFlow对象检测API在一张图片通过时给出。这个output_dict主要包含3个键。</p><ul class=""><li id="1dd5" class="mz na it lo b lp mr ls ms lv nb lz nc md nd mh oq nf ng nh bi translated">detection_scores —检测到的100个对象的精确度</li><li id="6278" class="mz na it lo b lp ni ls nj lv nk lz nl md nm mh oq nf ng nh bi translated">detection_classes —检测到的100个对象的类别id</li><li id="eef8" class="mz na it lo b lp ni ls nj lv nk lz nl md nm mh oq nf ng nh bi translated">detection _ boxes检测到的100个对象的边界矩形的尺寸</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="ae1c" class="pw-post-body-paragraph lm ln it lo b lp mr ju lr ls ms jx lu lv mu lx ly lz mw mb mc md my mf mg mh im bi translated">了解了检测类别、方框和分数后，我们要做的是，当检测到一个人时，我们要在检测到的人的边框中间打印一个红点，并将该图像保存在一个文件夹中。我们可以这样写这个函数，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/eba3c3dda83ca2af8a23823f4efb3c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJXYOgGeRl6VFnR5JmvkIA.png"/></div></div><figcaption class="os ot gj gh gi ou ov bd b be z dk translated">类别id</figcaption></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="af44" class="pw-post-body-paragraph lm ln it lo b lp mr ju lr ls ms jx lu lv mu lx ly lz mw mb mc md my mf mg mh im bi translated">最后，我们将从您的网络摄像头捕捉视频，并通过<code class="fe mj mk ml mm b">while</code>循环逐帧运行。然后将所有图像传递给<code class="fe mj mk ml mm b">show_inference</code>功能。</p><p id="4420" class="pw-post-body-paragraph lm ln it lo b lp mr ju lr ls ms jx lu lv mu lx ly lz mw mb mc md my mf mg mh im bi translated">您也可以通过为<code class="fe mj mk ml mm b">video=cv2.VideoCapture(r'<strong class="lo iu">PATH</strong>')</code>输入视频的路径来输入存储的视频</p><blockquote class="mn mo mp"><p id="fcb0" class="lm ln mq lo b lp mr ju lr ls ms jx lu mt mu lx ly mv mw mb mc mx my mf mg mh im bi translated">可选——您可以通过将<a class="ae mi" href="https://www.dev47apps.com/" rel="noopener ugc nofollow" target="_blank"> DroidCam </a>应用程序下载到PC和手机上来使用您的手机摄像头。然后改变<code class="fe mj mk ml mm b">cv2.VideoCapture(1)</code></p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="f462" class="nr kv it bd kw od oe dn la of og dp le lv oh oi lg lz oj ok li md ol om lk on bi translated">下面是完整的代码。</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow op l"/></div></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="c82c" class="ku kv it bd kw kx ox kz la lb oy ld le jz oz ka lg kc pa kd li kf pb kg lk ll bi translated">结论</h1><p id="7ced" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">大多数物体探测器都是用YOLO制造的。这是构建对象检测器的另一种方法。文章到此为止。希望对某个人有用。谢谢，注意安全！</p><h2 id="8d01" class="nr kv it bd kw od oe dn la of og dp le lv oh oi lg lz oj ok li md ol om lk on bi translated">资源</h2><div class="pc pd gp gr pe pf"><a href="https://github.com/ravindu9701/Object-Detection.git" rel="noopener  ugc nofollow" target="_blank"><div class="pg ab fo"><div class="ph ab pi cl cj pj"><h2 class="bd iu gy z fp pk fr fs pl fu fw is bi translated">ravindu 9701/对象检测</h2><div class="pm l"><h3 class="bd b gy z fp pk fr fs pl fu fw dk translated">在GitHub上创建一个帐户，为ravindu 9701/对象检测开发做出贡献。</h3></div><div class="pn l"><p class="bd b dl z fp pk fr fs pl fu fw dk translated">github.com</p></div></div><div class="po l"><div class="pp l pq pr ps po pt ks pf"/></div></div></a></div></div></div>    
</body>
</html>