<html>
<head>
<title>Rendering 3D Objects/Animation in React using Three Fiber</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用三根纤维在React中渲染3D对象/动画</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/rendering-3d-objects-and-animation-in-react-using-three-fiber-bf0255e642be?source=collection_archive---------2-----------------------#2020-12-21">https://levelup.gitconnected.com/rendering-3d-objects-and-animation-in-react-using-three-fiber-bf0255e642be?source=collection_archive---------2-----------------------#2020-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/73304c3936cd9ba3f1505dabe0137fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BM6fHV4_rnOH3eFD.jpg"/></div></div></figure><p id="b736" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Three.js 是一个<strong class="ka ir"> 3D渲染/动画</strong>库，它整合了<strong class="ka ir"> WebGL </strong>来在画布上显示模型。如果您有兴趣深入了解Three.js可以为JavaScript环境提供的实用工具，请参考我就此主题撰写的前一篇文章<a class="ae kw" href="https://medium.com/nerd-for-tech/rendering-3d-models-and-animation-using-threejs-ded9088b40a0" rel="noopener">。然而，在这篇博客中，我们将介绍一个库，它进一步简化了环境中Three.js的使用。</a></p><p id="74a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">今天，我将提供一个快速演示，展示可用于通过<strong class="ka ir"> React三纤维组件</strong>渲染3D模型的简化功能。让我们开始吧。</p><h1 id="1bae" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">设置场景:</h1><p id="7cad" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在我们继续这篇博客之前，首先需要安装下面列出的核心依赖项:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="939a" class="mj ky iq mf b gy mk ml l mm mn">npm i react react-dom react-three-fiber three drei</span></pre><p id="b060" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当涉及到在web环境中渲染3D模型时，首先必须有一个为模型渲染设置的场景。让我们从创建一个基本的react组件开始，它将存储我们在这个博客中的工作。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="0ce5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面代码片段的内容中，我们首先想要创建一个场景。但这如何实现呢？网站上的3D模型实际上是从画布上投影出来的，所以我们应该从那里开始。这可以通过调用React三纤维库提供的<strong class="ka ir"> &lt;画布/ &gt; </strong>组件来完成。就是这样！现在，如果我们看一下我们的应用程序，我们会看到一个白色的窗口。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/fcd037197900acf24c7b726791b08b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUxyCL4mm5l7Te-FOsgToA.png"/></div></div></figure><p id="c594" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这可能看起来好像场景没有在我们的网页上渲染，但这是由于白色背景。</p><h1 id="7c4a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">渲染3D形状</strong></h1><p id="0b66" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">现在场景已经成功地在网页上渲染了，让我们在那里添加一个基本的形状。为了呈现一个形状，我们首先必须创建一个新的函数来保存我们的形状的属性。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="8f1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的代码中，我们返回了创建基本形状所需的HTML。三个j中的形状被称为网格，网格在被称为几何图形的计算数据中保存3D对象的所有属性。现在，我们可以通过声明刚刚在画布场景范围内创建的<strong class="ka ir"> &lt; Mesh / &gt; </strong>函数来渲染我们的3D模型。</p><p id="1966" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们的网页看起来会像这样:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/ff2b55746eca3c55afefdce16009ac26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJklT7C-AdShhrJPOsRv-g.png"/></div></div></figure><p id="9c4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不完全是我们想要的，但这并不意味着我们的形状没有正确渲染。我们只是没有添加任何照明，所以形状被完全黑暗包围。让我们通过在HTML中添加灯光和聚光灯来改变这一点:</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="0090" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们来分析一下上面的代码片段:</p><p id="2ddb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的代码中，我们声明<strong class="ka ir"> ambientLight </strong>在周围的场景中创建一个光源，并使用这个<strong class="ka ir">方向光</strong>使环境光照在一个特定的方向上。最后一个组件，<strong class="ka ir">聚光灯</strong>，将在环境中渲染一个聚光灯，以特定的位置/角度照射物体。最后，我们添加了<strong class="ka ir">轨道控制</strong>来允许光标在3D环境中移动/旋转。</p><p id="a809" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们来看看我们的对象:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/2eb3a46208848f05894928d804c0a902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0cxG5TrSefau7t9z2PDtg.png"/></div></div></figure><p id="1306" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好多了。物体现在被我们产生的光照亮了。现在，如果我们愿意，我们可以将网格的形状更改为<a class="ae kw" href="https://threejs.org/docs/#api/en/objects/Mesh" rel="noopener ugc nofollow" target="_blank"> Three.js文档</a>中提供的众多网格之一，以及对象的材质。</p><h1 id="763b" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">导入预制网格:</h1><p id="8424" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">之前，我们刚刚创建了一个场景实例，并使用适当的光照在该场景中渲染了一个3D模型。然而，如果我们更进一步，将一个模型从网上导入到我们的本地环境中，会怎么样呢？为了实现这一点，我们需要将新的依赖项导入到我们的组件中，但是不要担心，不需要安装任何新的包。</p><p id="6a40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们想将这张桌子导入到场景中:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/b757c3ac1b410cedafbd2293e257525b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qTBsGzt8s69xWBbduHUYzA.png"/></div></div></figure><p id="a6db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了将这个表导入到我们的环境中，我们首先必须创建一个新函数。在新函数的范围内，应该包含作为变量的导入的3D对象的纹理覆盖，以及用于持久保存3D对象的组。此外，您还会注意到对<strong class="ka ir"> GLTFLoader </strong>的调用，这是一个链接到Three.js的导入包，允许从GLTF文件中检索数据。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="1ba6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的代码片段中，网格组件还接受了一个新选项，<strong class="ka ir"> geometry </strong>。该选项将呈现传递到范围中的任何模型的几何图形。此外，<strong class="ka ir">网格材质</strong>标签还包含一个纹理选项，该选项可将任何纹理图像应用于特定网格的表面。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="c9f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，如果网格<strong class="ka ir">异步</strong>渲染，我们希望有一个备份模型来代替我们试图导入的3D对象。这可以通过创建一个新的网格函数作为占位符，并用一个悬念方法包围导入的网格来实现。如果组件的<strong class="ka ir">范围</strong>中的网格在调用时不执行，暂停方法将调用备份网格<em class="mu">(回退选项中的网格)</em>。</p><h1 id="24de" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论:</h1><p id="0edc" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">通过本博客的课程，我们已经介绍了什么是Three.js库，Three Fiber如何在react环境中渲染3D模型，以及如何将3D模型从外部源导入到场景中。希望这个博客被认为是一个有用的资源，任何未来的开发者碰巧对以最有效的方式为他们的网站整合3D模型/动画感到好奇。</p></div></div>    
</body>
</html>