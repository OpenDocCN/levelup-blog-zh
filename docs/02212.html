<html>
<head>
<title>Converting a video to a GIF on a local machine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在本地机器上将视频转换为GIF</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/converting-a-video-to-a-gif-on-a-local-machine-aec9bfc666cd?source=collection_archive---------8-----------------------#2020-02-26">https://levelup.gitconnected.com/converting-a-video-to-a-gif-on-a-local-machine-aec9bfc666cd?source=collection_archive---------8-----------------------#2020-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/185539d6d78f6d74198c0a956ff2a72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbTK6OndVFgoug0HgOEniA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">来自<a class="ae kc" href="https://www.pexels.com/photo/woman-wearing-denim-jacket-holding-camera-3626623/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kc" href="https://www.pexels.com/@daria?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Daria Shevtsova </a>摄影</figcaption></figure><p id="35bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您在一家对产品实施严格隐私和保密的公司工作，那么很难使用本地录制的视频在内部组织Github存储库上演示功能，并且保持在文件大小限制内。当然，你可以录制功能的视频，并在内部非Github频道上传播，但这需要额外的链接和知识来记录和传播。</p><blockquote class="lb lc ld"><p id="c6e4" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">如果需要的话，把视频直接复制到你组织的Github上不是更好吗？</p></blockquote><p id="7744" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然会，但你的组织的Github可以限制视频的文件大小，而你的本地记录经常会违反这一点。此外，Github允许以GIF格式嵌入视频。你可以将视频转换成GIF格式，但大多数视频转GIF工具都是在线的，提交一些内部功能的视频可能会损害你自己的科技公司的隐私/保密标准。</p><blockquote class="lb lc ld"><p id="8a41" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">你知道在线服务对视频有所有权吗？</p><p id="5b22" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">条款和条件是否允许无条件公开共享？</p><p id="a903" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">您是否在不知情的情况下将敏感信息传递给第三方？</p></blockquote><p id="a173" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将视频在本地转换成GIF格式，然后复制/粘贴到你的组织的Github上会更容易。</p><h1 id="9e72" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">那么，我如何将本地视频转换成GIF呢？</h1><p id="2322" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">带命令行/终端和<em class="le">ffmpeg</em>；</p><h2 id="eecc" class="ml lj iq bd lk mm mn dn lo mo mp dp ls ko mq mr lw ks ms mt ma kw mu mv me mw bi translated">TL；速度三角形定位法(dead reckoning)</h2><p id="7c2d" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">这个脚本(安装了<em class="le"> ffmpeg </em>)会将你的视频文件转换成一个优化的GIF格式，其观看比例应该在Github组织的文件上传许可范围之内(当然取决于长度)</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="6ce2" class="ml lj iq nc b gy ng nh l ni nj">inputFile="./MyDemo.mov"<br/>outputFile="./MyDemo.gif"</span><span id="da6f" class="ml lj iq nc b gy nk nh l ni nj">palette="./palette.png"<br/>filters="fps=15,scale=640:-1:flags=lanczos"<br/>ffmpeg -v warning -i $inputFile -vf "$filters,palettegen=stats_mode=diff" -y $palette<br/>ffmpeg -i $inputFile -i $palette -lavfi "$filters,paletteuse=dither=bayer:bayer_scale=5:diff_mode=rectangle" -y $outputFile</span></pre><h1 id="29f0" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">细节</h1><h2 id="78e7" class="ml lj iq bd lk mm mn dn lo mo mp dp ls ko mq mr lw ks ms mt ma kw mu mv me mw bi translated">什么是ffmpeg？</h2><p id="735b" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">ffmpeg 自称是<em class="le">领先的多媒体框架，能够解码、编码、转码、多路复用、多路分解、流式传输、过滤和播放人类和机器创造的几乎任何东西</em>。它可以在多种环境下跨平台运行(微软、Mac、Linux等)。</p><h2 id="6d9b" class="ml lj iq bd lk mm mn dn lo mo mp dp ls ko mq mr lw ks ms mt ma kw mu mv me mw bi translated">我如何安装它？</h2><p id="526e" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">您可以<a class="ae kc" href="https://www.ffmpeg.org/download.html" rel="noopener ugc nofollow" target="_blank">为您的操作系统下载</a>可执行文件。如果你在Mac上，你也可以选择运行<code class="fe nl nm nn nc b">brew install ffmpeg</code>来使用<a class="ae kc" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制软件</a></p><h2 id="384d" class="ml lj iq bd lk mm mn dn lo mo mp dp ls ko mq mr lw ks ms mt ma kw mu mv me mw bi translated">转换脚本实际上做什么？</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f491" class="ml lj iq nc b gy ng nh l ni nj">inputFile="./MyDemo.mov"<br/>outputFile="./MyDemo.gif"</span></pre><p id="e29c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些是在转换过程的输入/输出中使用的文件的名称和位置。我们可以将脚本进一步细化为一个shell/批处理文件，作为一个接受参数并去掉这些参数的函数(即替换为<code class="fe nl nm nn nc b">$1</code> / <code class="fe nl nm nn nc b">$2</code>),但是为了透明起见，我们在这里包含了这些参数。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="611f" class="ml lj iq nc b gy ng nh l ni nj">palette="./palette.png"</span></pre><p id="6226" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这定义了作为第一个ffmpeg命令的一部分生成的调色板文件的文件和位置</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="a882" class="ml lj iq nc b gy ng nh l ni nj">filters="fps=15,scale=640:-1:flags=lanczos"</span></pre><p id="4597" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这为转换过程定义了特定的过滤器。1.每秒帧数设置为15(在大多数情况下已经足够，可以减小文件大小；默认值为25)。2.该比例强制一个维度上的输出显示纵横比为640，同时保持另一个维度上的比例(-1)。3.<em class="le"> lanczos </em>是一种结合了清晰度和平滑动画的重新缩放算法。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c7b3" class="ml lj iq nc b gy ng nh l ni nj">ffmpeg -v warning -i $inputFile -vf "$filters,palettegen=stats_mode=diff" -y $palette</span></pre><p id="1b3f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一次执行<em class="le"> ffmpeg </em> : 1。将日志级别设置为<em class="le">警告</em>。2.将输入文件设置为先前定义的参数。3.从输入视频中创建一个调色板文件，该文件是下一步编码中使用的256色代表性调色板。4.设置输出调色板文件名&amp;的位置。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0f44" class="ml lj iq nc b gy ng nh l ni nj">ffmpeg -i $inputFile -i $palette -lavfi "$filters,paletteuse=dither=bayer:bayer_scale=5:diff_mode=rectangle" -y $outputFile</span></pre><p id="247a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后一次执行<em class="le"> ffmpeg </em> : 1。设置要使用的输入视频文件。2.设置要使用的输入调色板文件。3.使用<em class="le"> Libavfilter </em>从filtergraph中读取数据。4.设置我们之前定义的过滤器，并重用输入中给定的调色板文件。—选择一个<em class="le">抖动</em>模式，并指定<em class="le">拜尔</em>算法，以低于交叉阴影图案的默认比例选项使用。—<em class="le">diff _ mode</em>将变化的<em class="le">矩形</em>设置为重新处理的区域，这样可以获得更好的压缩效果。5.设置输出GIF文件名&amp;的位置。</p><h2 id="aabb" class="ml lj iq bd lk mm mn dn lo mo mp dp ls ko mq mr lw ks ms mt ma kw mu mv me mw bi translated">那里有很多我不明白的地方…</h2><p id="e90f" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">我也是，所以不丢人。除非你是视频编码/转码/过滤(等等)方面的专家。)，如果不阅读<a class="ae kc" href="https://ffmpeg.org/documentation.html" rel="noopener ugc nofollow" target="_blank">文档</a>和摆弄它，很多术语会让你摸不着头脑。然而，如果你的目标是将视频转换成GIF文件，并避免使用在线服务，上面的方法应该可以帮你实现。</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="1a20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个故事最初出现在格雷格·伯恩的博客上——https://www.gregbyrne.ie/</p></div></div>    
</body>
</html>