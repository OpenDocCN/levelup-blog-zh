<html>
<head>
<title>Understanding the Delegation Pattern with Kotlin on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Android上的Kotlin了解委托模式</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/understanding-the-delegation-pattern-with-kotlin-on-android-8d7698524939?source=collection_archive---------4-----------------------#2022-11-10">https://levelup.gitconnected.com/understanding-the-delegation-pattern-with-kotlin-on-android-8d7698524939?source=collection_archive---------4-----------------------#2022-11-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f98d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这是一个如何帮助你编写更简洁的代码的例子</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dda5ab33be7727ac29b63bf35158e971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vGrjdrly1g1cUIZC"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@masjidmaba?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">MABA清真寺</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="6c01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Kotlin中高度集成的模式之一是委托模式。它帮助开发人员轻松地重用代码，并保持语言的可读性优雅而简单。</p><p id="7038" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你写Kotlin代码已经有一段时间了，你可能见过<code class="fe lv lw lx ly b">by lazy</code>表达式。</p><blockquote class="lz ma mb"><p id="d593" class="kz la mc lb b lc ld ju le lf lg jx lh md lj lk ll me ln lo lp mf lr ls lt lu im bi translated">惰性委托提供了一个setter和一个getter，但是在这种情况下，它只计算一次变量。之后，该值只在读取时传递，因为计算出的值保存在内存中。</p></blockquote><p id="1af8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一天结束的时候，这个委托所做的是使用关键字<code class="fe lv lw lx ly b">by</code>将提供getter和setter的责任交给另一个类。</p><h1 id="65c8" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">实现自定义委托</h1><p id="63b5" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我最喜欢的自定义代理用例是使用LiveData。这个想法是，不需要使用<em class="mc">值</em>变量来读取或写入内容，就可以访问<code class="fe lv lw lx ly b">LiveData</code>对象中的内容存储。</p><p id="7222" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，我们会有这样的东西。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/7b4f814d8b594544e4709792244da894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u7nl8OYN3ZJ6LNy5AHMu_A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用LiveData的传统方式</figcaption></figure><p id="0205" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，<code class="fe lv lw lx ly b">MutableLiveData</code>是隐藏的，因此只能从<code class="fe lv lw lx ly b">ViewModel</code>访问，而<code class="fe lv lw lx ly b">LiveData</code>对象是暴露的。每次我们需要修改它的内容时，我们需要使用带下划线的变量(在我看来很难看)，然后读取或覆盖<em class="mc"> value </em>属性。</p><p id="f753" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用委托来避免这种情况。首先，我们需要一个类来承担我们之前讨论过的责任，这是一个我们将要委托给getter和setter的类。</p><p id="556b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个类中，我们需要覆盖操作符<code class="fe lv lw lx ly b">getValue</code>和<code class="fe lv lw lx ly b">setValue</code>，这样它们就可以写入或读取包含在<code class="fe lv lw lx ly b">LiveData</code>对象中的值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/79a207132eacbb14dc6d1fc01bdc898d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k3uwjyx80LCwbxAG1wR_FA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">LiveData代表</figcaption></figure><p id="6d5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在使用我们之前创建的类，我们可以用它来委托<code class="fe lv lw lx ly b">LiveData</code>对象的getter和setter，并以一种更简洁的方式访问它，如下例所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/86f77b42ea2fd2b25916d468a7618358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQ5_TUMRqnElNXjIwak5sA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用LiveData委托</figcaption></figure><p id="9d87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可能看起来是一个小变化，但是一旦你已经编写了数千次这样的代码，你就会开始欣赏它。</p><blockquote class="lz ma mb"><p id="9dc3" class="kz la mc lb b lc ld ju le lf lg jx lh md lj lk ll me ln lo lp mf lr ls lt lu im bi translated">如果你对这个话题感兴趣的话，我还有一篇关于科特林具体化和 <code class="fe lv lw lx ly b"><em class="it">inline </em></code> <em class="it">关键词的文章。</em></p></blockquote><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/understand-kotlin-reified-and-type-erasure-8b3ee30932d0"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">理解科特林具体化和类型擦除</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">这是一个关于它如何提高可读性以及如何在幕后工作的例子</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw ks ni"/></div></div></a></div><h1 id="c606" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">额外小费</h1><p id="e555" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">如果您使用<code class="fe lv lw lx ly b">map</code>对象，您可以使用委托以更具语义的方式用它们填充一个类，而不是使用定制的解决方案，例如循环。</p><p id="3fa7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，您需要像这样定义类。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/77604ad980e7aafda10e26a30fd598d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfEMsXog2YudXv5c67rsbg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">用地图填充对象</figcaption></figure><blockquote class="lz ma mb"><p id="cbdd" class="kz la mc lb b lc ld ju le lf lg jx lh md lj lk ll me ln lo lp mf lr ls lt lu im bi translated">注意，映射的值属于<code class="fe lv lw lx ly b"><em class="it">Any?</em></code>类型，因此可以插入任何需要的类型，包括它们的可空对应物。</p></blockquote><p id="f9fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，当您填充类时，键必须与类属性的名称具有相同的值，就像这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/c8c4ebd47bb3ca353c0e0f12f8e4c3c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PULTGTIMOYI1wD8XJ6K4bQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">创建用地图填充的实例</figcaption></figure></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="3388" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想阅读更多这样的内容，并支持我，不要忘记检查我的个人资料，或给媒体一个机会，成为会员，以获得我和其他作家的无限故事。这只是5美元一个月，如果你使用这个链接，我会得到一小笔佣金。</p><div class="nf ng gp gr nh ni"><a href="https://medium.com/@molidev8/membership" rel="noopener follow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">通过我的推荐链接加入Medium—Miguel</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">阅读米格尔的每一个故事(以及媒体上成千上万的其他作家)。你的会员费直接支持米盖尔…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">medium.com</p></div></div><div class="nr l"><div class="of l nt nu nv nr nw ks ni"/></div></div></a></div></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h1 id="c721" class="mg mh it bd mi mj og ml mm mn oh mp mq jz oi ka ms kc oj kd mu kf ok kg mw mx bi translated">分级编码</h1><p id="f521" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="4d5d" class="ol om it lb b lc ld lf lg li on lm oo lq op lu oq or os ot bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="3293" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="2eac" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="9c92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>