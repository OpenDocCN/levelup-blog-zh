<html>
<head>
<title>Printing in Node.js with Electron (ElectronForge + node-printer + webpack)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用电子在Node.js中打印(Electron forge+node-printer+web pack)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/printing-in-node-js-with-electron-electronforge-node-printer-webpack-5f106073aefc?source=collection_archive---------4-----------------------#2022-05-21">https://levelup.gitconnected.com/printing-in-node-js-with-electron-electronforge-node-printer-webpack-5f106073aefc?source=collection_archive---------4-----------------------#2022-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="35f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在电子应用中遇到一些关于<a class="ae kl" href="https://www.npmjs.com/package/printer" rel="noopener ugc nofollow" target="_blank">节点打印机</a>的问题——在开发期间或者甚至在安装期间——这篇文章可以给你提供帮助。</p><p id="0199" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，在node.js中打印，嗯？<br/>实际上，在node.js中单独使用节点打印机应该是一件容易的事情，当你在一个电子应用程序中尝试同样的方法时，挑战就开始了(或者也许我只是一个不幸的家伙)。</p><h2 id="c58a" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">关于图书馆</h2><p id="5525" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">目前我写这篇文章给你，据我所知，node中唯一现存的打印库是<a class="ae kl" href="https://www.npmjs.com/package/printer" rel="noopener ugc nofollow" target="_blank"> node-printer </a>。坏消息是它是一个无人维护的库，但好消息是我们有一个很棒的社区和许多分支😊。</p><p id="4922" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">据我所知，目前维护最多的fork是<a class="ae kl" href="https://www.npmjs.com/package/@thiagoelg/node-printer" rel="noopener ugc nofollow" target="_blank"> @thiagoelg/node-printer </a>。因此，现在当提到术语“节点打印机”时，我将讨论这个分支。</p><h2 id="b080" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">第一层</h2><p id="23a8" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">还没有谈到我们的主要目的，但已经谈到了电子节点打印机的警告，我们必须小心游戏中3个角色的版本之间的兼容性:节点打印机，node.js和电子。您必须使用node.js版本，该版本既可以与node-printer版本一起使用，也可以与您将使用的电子版本一起使用。</p><p id="9e53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于node-printer是一个比electron更老的库，您可能应该开始匹配它与node.js的兼容性— <a class="ae kl" href="https://github.com/thiagoelg/node-printer/commits/main" rel="noopener ugc nofollow" target="_blank">您可以在lib </a>的提交中搜索——然后找到一个合适的electron版本(大多数最新版本应该可以工作)。</p><p id="8031" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">匹配的版本，你应该能够得到节点打印机安装。要让它运行起来，你还需要一个步骤——只有在不使用Electron Forge时才需要，因为它会自动处理它——关于electron 中的<a class="ae kl" href="https://www.electronjs.org/pt/docs/latest/tutorial/using-native-node-modules" rel="noopener ugc nofollow" target="_blank">原生模块(安装后脚本中的electron-rebuild)。</a></p><h2 id="38b9" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">第二层，老板已经</h2><p id="c5fc" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">这篇文章的真正意义在于当我们想要使用我们亲爱的节点打印机和<a class="ae kl" href="https://www.electronforge.io/templates/webpack-template" rel="noopener ugc nofollow" target="_blank">电子锻造模板和webpack </a>(例如在react应用程序中)。你会看到，即使做了我们上面看到的所有事情，你仍然会得到一个“找不到模块节点-打印机”(或类似的东西)。</p><p id="74c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">webpack构建可能没有正确处理lib包中的node_printer.node文件。为了解决这个问题，我们必须进行两种不同的配置，以便在开发模式和生产模式下都可以解决这个问题。</p><p id="6e18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要让它在开发模式下工作，首先你必须让webpack忽略整个lib包，这很简单，只需将它添加到你的main.webpack.js:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="7d3c" class="km kn iq lp b gy lt lu l lv lw">...<br/>externals: {</span><span id="b918" class="km kn iq lp b gy lx lu l lv lw">  '@thiagoelg/node-printer': 'commonjs @thiagoelg/node-printer',</span><span id="78a3" class="km kn iq lp b gy lx lu l lv lw">},<br/>...</span></pre><p id="5dae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就我的研究而言，当webpack将一些库的内部路径转换成新的编译文件夹时，问题就出现了。webpack”，使该包成为外部包将阻止webpack这样做，并且该包将能够正常地从node_modules恢复其路径。</p><p id="9bd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，要在生产模式下解决这一点更具体，问题是我们现在的外部包不会被添加到”。webpack "文件夹中，在可执行文件生成过程结束时不会被添加到asar文件中。</p><p id="132d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们手动添加这些文件，首先安装<a class="ae kl" href="https://www.npmjs.com/package/copy-webpack-plugin" rel="noopener ugc nofollow" target="_blank"> copy-webpack-plugin </a>，然后将以下代码添加到main.webpack.js:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="2c20" class="km kn iq lp b gy lt lu l lv lw">const CopyPlugin = require('copy-webpack-plugin');</span><span id="0be2" class="km kn iq lp b gy lx lu l lv lw"><em class="ly">module</em>.<em class="ly">exports</em> = {<br/>  ...</span><span id="0f55" class="km kn iq lp b gy lx lu l lv lw">  plugins: [<br/>    <strong class="lp ir">new</strong> CopyPlugin({</span><span id="d659" class="km kn iq lp b gy lx lu l lv lw">      patterns: [</span><span id="c3f4" class="km kn iq lp b gy lx lu l lv lw">        {</span><span id="4d7e" class="km kn iq lp b gy lx lu l lv lw">          from: 'node_modules/@thiagoelg/node-printer/lib/',</span><span id="75eb" class="km kn iq lp b gy lx lu l lv lw">          to: 'node_modules/@thiagoelg/node-printer/lib/',</span><span id="af3f" class="km kn iq lp b gy lx lu l lv lw">        },</span><span id="815b" class="km kn iq lp b gy lx lu l lv lw">        {</span><span id="5829" class="km kn iq lp b gy lx lu l lv lw">           from: 'node_modules/@thiagoelg/node-printer/build/',</span><span id="64ce" class="km kn iq lp b gy lx lu l lv lw">           to: 'node_modules/@thiagoelg/node-printer/build/',</span><span id="788e" class="km kn iq lp b gy lx lu l lv lw">         },</span><span id="5878" class="km kn iq lp b gy lx lu l lv lw">         {</span><span id="fe32" class="km kn iq lp b gy lx lu l lv lw">            from: 'node_modules/@thiagoelg/node-             printer/package.json',</span><span id="83af" class="km kn iq lp b gy lx lu l lv lw">            to: 'node_modules/@thiagoelg/node-printer/package.json',<br/>          },</span><span id="22ec" class="km kn iq lp b gy lx lu l lv lw">      ],</span><span id="9e2a" class="km kn iq lp b gy lx lu l lv lw">    }),</span><span id="eddd" class="km kn iq lp b gy lx lu l lv lw">  ],<br/>...</span><span id="f73b" class="km kn iq lp b gy lx lu l lv lw">}</span></pre><p id="3333" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在一系列的尝试和失败中，我发现只需要将“lib/”、“build/”和“package.json”复制到最终的构建中，我想这是有意义的。</p><p id="b936" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我希望您可以运行make脚本，然后执行应用程序，不会看到任何错误。</p><p id="00db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这些，谢谢你给我一些时间。<br/> <em class="ly"> PS:这是我的第二个帖子，我为任何愚蠢的事情道歉(在第三个帖子里，我会停止给那个借口)</em></p></div></div>    
</body>
</html>