<html>
<head>
<title>AWS Event-driven Serverless Patterns via the AWS CDK — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过AWS CDK的AWS事件驱动的无服务器模式—第1部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/aws-event-driven-serverless-patterns-via-the-aws-cdk-part-1-bb5dfd348372?source=collection_archive---------10-----------------------#2019-12-11">https://levelup.gitconnected.com/aws-event-driven-serverless-patterns-via-the-aws-cdk-part-1-bb5dfd348372?source=collection_archive---------10-----------------------#2019-12-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c6d2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何从AWS简单队列服务触发AWS Lambda函数(SQS)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0ca43d04c3923dd2c6d7957cbe56bec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kMmr62x-inmURVH3.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者通过<a class="ae kv" href="https://www.kapwing.com/" rel="noopener ugc nofollow" target="_blank">https://www.kapwing.com</a>提供</figcaption></figure><p id="88fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本帖中，我们将使用AWS CDK构建一个从AWS SQS消息触发的AWS Lambda函数。</p><p id="ba92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有的代码<a class="ae kv" href="https://github.com/alexkates/how-to-trigger-lambda-from-sqs" rel="noopener ugc nofollow" target="_blank">都可以在这个库</a>中找到。</p><h1 id="6bc3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">设置</h1><p id="d0b8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们需要运行一些命令来设置我们的CDK应用程序，并安装我们需要的CDK模块。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="a3b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将为您提供以下目录结构。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/3c84f4220e72bf0bc1666fe735b8f8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*23fPCcHvSUUntMyPCkCmAg.jpeg"/></div></div></figure><p id="775a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，确保您已经配置了AWS CLI。有关更多信息，请遵循<a class="ae kv" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html" rel="noopener ugc nofollow" target="_blank">AWS CLI快速入门指南</a>。</p><p id="4cd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，如果这是您在AWS帐户中的第一个CDK应用程序，您将需要执行一次性命令来引导CDK。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="6940" class="ls lt iq bd lu lv mz lx ly lz na mb mc jw nb jx me jz nc ka mg kc nd kd mi mj bi translated">构建堆栈</h1><p id="ae6f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，创建src/index.js，它只记录每个传入的事件记录。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="b7db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，用下面的CDK代码更新lib/how-to-trigger-lambda-from-SQS-stack . ts。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="bbf0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，使用CDK CLI部署您的堆栈</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="d7db" class="ls lt iq bd lu lv mz lx ly lz na mb mc jw nb jx me jz nc ka mg kc nd kd mi mj bi translated">测试</h1><p id="3e50" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将利用AWS CLI来测试我们的堆栈。</p><p id="489c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要SQS队列的队列URL，您可以使用下面的命令获得它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="cdc1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，使用上一个命令中的队列URL，使用AWS CLI发送新消息。您的队列URL可能会有所不同，但对我来说，这个命令看起来像这样。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="d78a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过查看CloudWatch来验证Lambda是否已执行。找到名为<code class="fe ne nf ng nh b">/aws/lambda/SqsMessageHandler</code>的日志组，打开最新的日志流。您应该会看到类似如下的一些日志消息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/bf78c2af54a77721ed6ed26290e73e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dx1dW0drxOdtNv2wfQvblw.png"/></div></div></figure><h1 id="3158" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">打扫</h1><p id="afe2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">完成后不要忘记删除您的堆栈！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="9bef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ni">原发布于2019年12月11日</em><a class="ae kv" href="https://dev.to/aws-builders/how-to-trigger-an-aws-lambda-from-sqs-2lkc" rel="noopener ugc nofollow" target="_blank"><em class="ni">https://dev . to</em></a><em class="ni">。</em></p></div></div>    
</body>
</html>