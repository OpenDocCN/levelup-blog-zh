<html>
<head>
<title>Predict Boston House Prices Using Python &amp; Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和线性回归预测波士顿房价</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/predict-boston-house-prices-using-python-linear-regression-90469e0a341?source=collection_archive---------0-----------------------#2019-06-07">https://levelup.gitconnected.com/predict-boston-house-prices-using-python-linear-regression-90469e0a341?source=collection_archive---------0-----------------------#2019-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fff3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用机器学习算法预测房价</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ef26d77a85cc396be53bf4b6374ca623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NNdn--M4nbZxf04Tlo39Zw.png"/></div></div></figure><p id="d5b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我将编写一个Python程序，使用一个名为<strong class="kw iu">线性回归</strong>的机器学习算法来预测波士顿的房价。线性回归是一种建模标量响应(或因变量)和一个或多个解释变量(或自变量)之间关系的线性方法。</p><h1 id="1ee0" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">线性回归优点:</h1><ol class=""><li id="fb0d" class="mi mj it kw b kx mk la ml ld mm lh mn ll mo lp mp mq mr ms bi translated">实现简单。</li><li id="716f" class="mi mj it kw b kx mt la mu ld mv lh mw ll mx lp mp mq mr ms bi translated">用于预测数值。</li></ol><h1 id="f684" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">线性回归缺点:</h1><ol class=""><li id="dcb1" class="mi mj it kw b kx mk la ml ld mm lh mn ll mo lp mp mq mr ms bi translated">容易过度拟合。</li><li id="5229" class="mi mj it kw b kx mt la mu ld mv lh mw ll mx lp mp mq mr ms bi translated">当自变量和因变量之间的关系为非线性时，不能使用。</li></ol><p id="39d2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你不想读这篇文章，想要一个视频演示，你可以看看下面的<a class="ae my" href="https://youtu.be/gOXoFDrseis" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">视频</strong> </a>。它以更详细的方式介绍了本文中的所有内容，即使您的计算机上没有安装编程语言Python，它也会帮助您轻松地开始编写自己的线性回归机器学习模型。或者两者都可以作为学习线性回归的辅助材料！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="b9d8" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated"><strong class="ak">开始编程:</strong></h1><p id="b54a" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">首先，我将导入依赖项，这将使这个程序更容易编写。我在导入机器学习库<strong class="kw iu"> sklearn </strong>、<strong class="kw iu"> numpy </strong>和<strong class="kw iu">熊猫</strong>。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="b64e" class="nj lr it nf b gy nk nl l nm nn"><strong class="nf iu">import</strong> <strong class="nf iu">pandas</strong> <strong class="nf iu">as</strong> <strong class="nf iu">pd</strong><br/><strong class="nf iu">import</strong> <strong class="nf iu">numpy</strong> <strong class="nf iu">as</strong> <strong class="nf iu">np</strong><br/><strong class="nf iu">from</strong> <strong class="nf iu">sklearn</strong> <strong class="nf iu">import</strong> linear_model<br/><strong class="nf iu">from</strong> <strong class="nf iu">sklearn.model_selection</strong> <strong class="nf iu">import</strong> train_test_split</span></pre><p id="87cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我将从<strong class="kw iu"> sklearn.datasets </strong>中加载Boston Housing数据集，并在通过使用一个名为<code class="fe no np nq nf b">load_boston()</code>的函数/方法将其存储到变量<code class="fe no np nq nf b">boston</code>中后打印出来，但首先我将导入库<code class="fe no np nq nf b">sklearn.datasets</code> <strong class="kw iu">。</strong>该方法将返回一个类似字典的对象，有趣的属性有:<code class="fe no np nq nf b">data</code>要学习的数据，<code class="fe no np nq nf b">target</code>回归目标，<code class="fe no np nq nf b">DESCR</code>数据集的完整描述，<code class="fe no np nq nf b">filename</code>Boston CSV数据集的物理位置，以及<code class="fe no np nq nf b">feature_names</code>列或特性的名称。请注意，此数据集已经是干净的，这意味着没有损坏、不准确或丢失的数据。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="3fe0" class="nj lr it nf b gy nk nl l nm nn"><em class="nr">#Load the Boston Housing Data Set from sklearn.datasets and print it</em><br/><strong class="nf iu">from</strong> <strong class="nf iu">sklearn.datasets</strong> <strong class="nf iu">import</strong> load_boston<br/>boston = load_boston()<br/>print(boston)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/01ddb988dc708fd4a6e491975e0a70bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*k_pLmVPN-1pXyF67o1AoAA.png"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated"><strong class="bd ls">图1: </strong>从load_boston()返回的数据的部分图像，突出显示“数据”</figcaption></figure><p id="f162" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上图<strong class="kw iu">图1，</strong>看起来很乱，我很难读懂，所以我会用熊猫图书馆把数据转换成更容易管理的东西，比如数据框。当我这样做的时候，我会把数据分成自变量(X)和因变量(Y)数据集。数据将存储在因变量的<code class="fe no np nq nf b">df_x</code>和因变量的<code class="fe no np nq nf b">df_y</code>中。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="613a" class="nj lr it nf b gy nk nl l nm nn"><em class="nr">#Transform the data set into a data frame </em><br/><em class="nr">#NOTE: boston.data = the data we want, </em><br/><em class="nr">#      boston.feature_names = the column names of the data</em><br/><em class="nr">#      boston.target = Our target variable or the price of the houses</em><br/>df_x = pd.DataFrame(boston.data, columns = boston.feature_names)<br/>df_y = pd.DataFrame(boston.target)</span></pre><p id="e582" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我想从<code class="fe no np nq nf b">df_x</code>数据集中获得一些统计数据，比如每列数据包含的行数、每列的最小值、每列的最大值以及每列的平均值。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="55e4" class="nj lr it nf b gy nk nl l nm nn"><em class="nr">#Get some statistics from our data set, count, mean standard deviation etc.</em><br/>df_x.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/d3f1befc52de88d485d6887c557c653f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lYlZTLHHhGDd80YnyJpYbw.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated"><strong class="bd ls">图2: </strong>对df_x数据集中几列的统计</figcaption></figure><p id="bbea" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将继续初始化线性回归模型，将数据分为67%的训练数据和33%的测试数据，然后使用包含独立变量的训练数据集来训练模型。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="80ab" class="nj lr it nf b gy nk nl l nm nn"><em class="nr">#Initialize the linear regression model</em><br/>reg = linear_model.LinearRegression()</span><span id="0a0b" class="nj lr it nf b gy ny nl l nm nn"><em class="nr">#Split the data into 67% training and 33% testing data</em><br/><em class="nr">#NOTE: We have to split the dependent variables (x) and the target or independent variable (y)</em><br/>x_train, x_test, y_train, y_test = train_test_split(df_x, df_y, test_size=0.33, random_state=42)</span><span id="7454" class="nj lr it nf b gy ny nl l nm nn"><em class="nr">#Train our model with the training data</em><br/>reg.fit(x_train, y_train)</span></pre><p id="f61b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">获取线性回归模型的估计系数</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="75d8" class="nj lr it nf b gy nk nl l nm nn"><em class="nr">#Print the coefecients/weights for each feature/column of our model</em><br/>print(reg.coef_)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/ef73a0faaad9b105833b1b9f67133527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*PHfTbAmcR-x6eSo_btgTZA.png"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated"><strong class="bd ls">图3: </strong>线性回归模型的系数</figcaption></figure><p id="6a77" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们已经完成了线性回归模型的训练，并查看了描述线性函数的系数，让我们将模型的预测(它认为房屋的值将是什么)打印在测试数据上。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="eb7a" class="nj lr it nf b gy nk nl l nm nn"><em class="nr">#print our price predictions on our test data</em><br/>y_pred = reg.predict(x_test)<br/>print(y_pred)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/44d5e43f5f7ce7e71306a1c1ded4b675.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/format:webp/1*zbTU2jFb9xd1POHPW23k2Q.png"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated"><strong class="bd ls">图4: </strong>预测值的小样本</figcaption></figure><p id="55ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我想知道那个测试数据集的实际值是多少，所以我将把这些值打印到屏幕上，但是首先我将打印模型预测中的至少一行，只是为了使比较数据更容易一些。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="c6c5" class="nj lr it nf b gy nk nl l nm nn"><em class="nr">#Print the the prediction for the third row of our test data actual price = 13.6</em><br/>y_pred[2]</span><span id="790e" class="nj lr it nf b gy ny nl l nm nn"><em class="nr">#print the actual price of houses from the testing data set</em><br/>y_test[0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/932233999e3d7d3b91aa50c349f4171e.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*u7qxHg8EsNM2uIJSfalC3w.png"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated"><strong class="bd ls">图4.1: </strong>测试数据集第3行的打印预测值</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/863aea4c06e43f16bd6acfd8ef1a880b.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/format:webp/1*WJSeX4MYZYeXikDeG7aMVg.png"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated"><strong class="bd ls">图4.2: </strong>突出显示测试数据集的打印实际值</figcaption></figure><p id="717f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过查看模型得出的预测值和测试数据集的实际值，看起来该模型非常擅长进行预测。这不确切，但它是非常接近的，比猜测好得多。但是我想用一种更数学的方法来检验模型的性能。</p><p id="a24a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了检查模型的性能/准确性，我将使用一个名为<strong class="kw iu">均方差(MSE) </strong>的指标。这种测量方法实施简单，易于理解。MSE是对估计量质量的一种度量，它总是非负的，越接近零的值表示越合适。通常，您还想用其他指标来评估您的模型，以真正了解您的模型执行得有多好。我将用两种不同的方式来做这件事，一种使用<strong class="kw iu"> numpy </strong>，另一种使用<strong class="kw iu"> sklearn.metrics </strong>。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="d74a" class="nj lr it nf b gy nk nl l nm nn"><em class="nr"># Two different ways to check model performance/accuracy using,</em><br/><em class="nr"># mean squared error which tells you how close a regression line is to a set of points.</em><br/><br/><em class="nr"># 1. Mean squared error by numpy</em><br/>print(np.mean((y_pred-y_test)**2))<br/><br/><em class="nr"># 2. Mean squared error by sklearn </em><br/><em class="nr"># Resource: https://stackoverflow.com/questions/42453875/precision-score-and-accuracy-score-showing-value-error?rq=1</em><br/><strong class="nf iu">from</strong> <strong class="nf iu">sklearn.metrics</strong> <strong class="nf iu">import</strong> mean_squared_error<br/>print(mean_squared_error(y_test, y_pred))</span></pre><p id="b40e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">均方误差函数返回值约为<strong class="kw iu"> 20.72。</strong>这个真好！如果我们的模型预测了实际值的精确值，那么均方误差函数将返回值0。</p><p id="bede" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在上面的视频中看到我是如何编写这个程序和代码的，还有一些更详细的解释，或者你也可以点击YouTube上的<a class="ae my" href="https://youtu.be/gOXoFDrseis" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">链接这里的</strong> </a>。</p><p id="200b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您也有兴趣阅读更多关于机器学习的内容，以便立即开始处理问题和示例，那么我强烈建议您查看<a class="ae my" href="https://www.amazon.com/gp/product/1491962291?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;linkCode=xm2&amp;creativeASIN=1491962291" rel="noopener ugc nofollow" target="_blank">使用Scikit-Learn和TensorFlow进行机器学习实践:构建智能系统的概念、工具和技术</a>。这是一本帮助初学者学习如何编写机器学习程序和理解机器学习概念的好书。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://www.amazon.com/gp/product/1491962291/ref=as_li_tl?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=1491962291&amp;linkId=b7cc2001f37665b84139089c59ef8571"><div class="gh gi od"><img src="../Images/1c76ef57958bdd4cc146d282c7210ac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*3lz1m4uotU9HRQNNFMftIw.png"/></div></a><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated"><a class="ae my" href="https://www.amazon.com/gp/product/1491962291?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;linkCode=xm2&amp;creativeASIN=1491962291" rel="noopener ugc nofollow" target="_blank">使用Scikit-Learn和TensorFlow进行机器实践学习:构建智能系统的概念、工具和技术</a></figcaption></figure><p id="cb62" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢你阅读这篇文章，希望对你有所帮助！如果你喜欢这篇文章，并发现它很有帮助，请留下一些掌声，以示感谢。坚持学习，如果你喜欢机器学习、数学、计算机科学、编程或算法分析，请访问并订阅我的<a class="ae my" href="https://www.youtube.com/channel/UCaV_0qp2NZd319K4_K8Z5SQ" rel="noopener ugc nofollow" target="_blank"> YouTube </a>频道(<a class="ae my" href="https://www.youtube.com/channel/UCaV_0qp2NZd319K4_K8Z5SQ" rel="noopener ugc nofollow" target="_blank">randers 112358</a>&amp;<a class="ae my" href="https://www.youtube.com/channel/UCbmb5IoBtHZTpYZCDBOC1CA" rel="noopener ugc nofollow" target="_blank">compsci 112358</a>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/02f98f83371517072cc6562b48ee2bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3r3cqJ3Q875mQXVV"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated">波士顿住房公司</figcaption></figure></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><div class="kj kk kl km gt om"><a href="https://gitconnected.com/learn/python" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">学习Python -最佳Python教程(2019) | gitconnected</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">80大Python教程-免费学习Python。课程由开发人员提交并投票，使您能够…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">gitconnected.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ks om"/></div></div></a></div></div></div>    
</body>
</html>