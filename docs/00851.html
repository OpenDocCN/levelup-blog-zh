<html>
<head>
<title>Getting to Know Go, Python, and Benchmarks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解Go、Python和基准</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/getting-to-know-go-python-and-benchmarks-2dc8bbaae402?source=collection_archive---------2-----------------------#2019-08-23">https://levelup.gitconnected.com/getting-to-know-go-python-and-benchmarks-2dc8bbaae402?source=collection_archive---------2-----------------------#2019-08-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6c06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，我叫Vadym，这是我开始学习围棋的故事，与Python(我目前在工作中使用的语言)相比是什么感觉，以及基准测试。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/3823dfd9538627fcf4cc2fbd388267a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0nuJjZGaVFmP9_lWq67Pg.png"/></div></div></figure><p id="fc7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我相信每个开发人员都应该不断学习如何做好自己的工作。这不仅仅是了解新的框架、数据库或平台，如AWS Lambda。它是关于了解你每天使用的服务是如何相互交互的，区分你最喜欢的语言何时使用一个对象的链接或对象的副本，以及许多其他事情。</p><p id="b28d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">10年来，我一直使用Python作为我编写产品代码的主要语言。但是即使作为一名忠诚的<a class="ae ky" href="https://djangostars.com/services/python-django-development/?utm_source=levelup.gitconnected.com&amp;utm_medium=medium&amp;utm_campaign=getting%20to%20know%20go%2C%20python%20and%20benchmarks&amp;utm_content=python%20developer" rel="noopener ugc nofollow" target="_blank"> Python开发者</a>，我也尝试过不同的语言。我喜欢学习新的语言，因为我可能会在日常工作中学到一些东西——即使是从我不会使用的语言或我不喜欢的语言中，比如Ruby或Java。另外，仅仅学习新的语言对我来说并不重要。我也喜欢花时间在旧的和很少使用的语言上。例如，除了为Emacs编写配置之外，我还尝试过Lisp。我也很喜欢Erlang，但是现在不太流行了。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kz"><img src="../Images/72be846fff3ae6437f2cc6a678206bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kkjrfrQkSCQlY_xb.png"/></div></div></figure><h1 id="3c86" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">了解围棋</h1><p id="67cf" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">几周前，我开始寻找一种新的语言来学习。首先，我开始研究长生不老药，因为我喜欢Erlang，但看了教程后我并不真的喜欢它。几天后，我选择了围棋，因为我从不同的渠道听到了很多关于这门语言的知识。乍一看，这种语言似乎并不复杂，但是它需要一种不同于Python的应用程序架构方法。于是决定深入钻研围棋。</p><h1 id="7f3f" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">第一步</h1><p id="6328" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">我首先做的是去看看围棋社区。Go社区有一个很棒的教程，可以马上教你很多关于这门语言的知识。我相信这是一个伟大的起点:【www.tour.golang.org<a class="ae ky" href="https://tour.golang.org/" rel="noopener ugc nofollow" target="_blank">。本教程分为三个部分，外加一个欢迎部分:</a></p><ul class=""><li id="d013" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated"><strong class="jp ir"> Basic </strong>向您展示Go语法的基础，如何使用变量和函数、流控制语句和更复杂的类型。</li><li id="c4a7" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated"><strong class="jp ir">方法和接口</strong>解释了如何创建和实现接口。</li><li id="dae6" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated"><strong class="jp ir">Go中的并发</strong>解释了这个主题的所有基础知识。</li></ul><p id="6b80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些部分都有简单的实践任务，涵盖了你所学的内容。</p><h1 id="d9e4" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">第二步</h1><p id="c02e" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">学习围棋的下一步是观看演示。最好的(在我看来)是Rob Pike的<a class="ae ky" href="https://www.youtube.com/watch?v=f6kdp27TYZs" rel="noopener ugc nofollow" target="_blank"> Go Concurrency Patterns </a>。这个演示很容易观看，非常激励人心。我也推荐看基于这个视频的YouTube建议。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mr"><img src="../Images/4318022ae21a8bb8ea9efd7986cc581b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3hIfPFYE7S7S5hEw.png"/></div></div></figure><h1 id="66f6" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">第三步</h1><p id="98a1" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">在我尝试创建自己的简单应用程序之前，我已经学习了另一个很棒的教程<a class="ae ky" href="https://github.com/pityonline/learn-go-with-tests" rel="noopener ugc nofollow" target="_blank">——带着测试学习Go</a>。本教程解释了Go以及如何使用测试驱动开发的方法来编写代码。</p><p id="4a8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在浏览了所有这些教程和视频之后，我决定最终尝试自己用Go编写一个简单的应用程序。我选择写一个URL-shortener服务，类似于bit.ly或者goo.gl，但是更简单，没有统计和UI。(以后可能会补充。)</p><p id="0b97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我试图用一组准备好的短字符串创建一个通道来识别长URL。这是与渠道和goroutines一起工作的一个极好的练习。但是现在，我没有在服务中使用这些代码，每次我需要存储一个长的URL时都生成短的字符串。接下来，我开始为应用程序编写代码——首先是带测试的短字符串生成代码。当我开始考虑存储时，我陷入了困境。发生这种情况是因为我不明白如何正确地拆分我的代码。对我来说，答案就在Go标准库的<a class="ae ky" href="https://github.com/golang-standards/project-layout" rel="noopener ugc nofollow" target="_blank">项目布局</a>和查看一些流行的Go库和应用程序中。此外，我发现<a class="ae ky" href="https://github.com/golang/go/wiki/Modules" rel="noopener ugc nofollow" target="_blank"> Go模块</a>在任何教程中都没有突出显示。</p><pre class="kn ko kp kq gt ms mt mu mv aw mw bi"><span id="81a3" class="mx lb iq mt b gy my mz l na nb">.<br/>├── api<br/>│   └── openapi.yaml<br/>├── build<br/>│   ├── ci<br/>│   │ └── .travis.yml<br/>│   ├── Dockerfile<br/>│   └── docker-compose.yml<br/>├── internal<br/>│   ├── generator<br/>│   │ ├── generator.go<br/>│   │ └── generator_test.go<br/>│   └── storage<br/>│       ├── redis_storage.go<br/>│       ├── redis_storage_test.go<br/>│       ├── simple_storage.go<br/>│       ├── simple_storage_test.go<br/>│       └── storage.go<br/>├── third_party<br/>│   ├── locustfile.py<br/>│   ├── redoc-static.html<br/>│   └── wrk_post.lua<br/>├── .gitignore<br/>├── .travis.yml -&gt; build/ci/.travis.yml<br/>├── LICENSE<br/>├── README.md<br/>├── go.mod<br/>├── go.sum<br/>└── main.go</span></pre><p id="cdfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我通过描述我的API的OpenAPI模式开始了我的第二次尝试。然后，我从前面的代码中复制了生成函数，并开始处理URL存储。在我研究Go应用程序的项目布局时，我发现了Bolt——一个用Go编写的简单的键值存储库。这个库的描述说存储可以用来存储大量的数据。我决定尝试一下，因为我使用的方法允许我轻松地用不同的数据存储替换这个库，而无需更改大量代码。</p><h2 id="6b91" class="mx lb iq bd lc nc nd dn lg ne nf dp lk jy ng nh lo kc ni nj ls kg nk nl lw nm bi translated">您可能还喜欢:</h2><div class="nn no gp gr np nq"><a href="https://djangostars.com/blog/configuring-django-settings-best-practices/?utm_source=levelup.gitconnected.com&amp;utm_medium=medium&amp;utm_campaign=getting%20to%20know%20go%2C%20python%20and%20benchmarks&amp;utm_content=you%20may%20also%20like" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">配置Django设置:最佳实践</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">本文面向使用Django框架的工程师。它对配置Django有深刻的见解…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">djangostars.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe kw nq"/></div></div></a></div><h1 id="ae32" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">基准测试和Python与Golang的性能比较</h1><p id="4c0a" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">我在Go中的第一个应用已经准备好了，我想做一个基准测试。通常，我使用wrk来这样做，但这次我决定使用蝗虫。使用Locust，可以更容易地创建一个同时使用所有端点的测试。当结果是大约每秒43个请求时，我感到很惊讶，这是一个相当小的数字。我的第一个假设是这个数字很小，因为存储只使用我磁盘上的文件。我决定用asyncio 、aiohttp和aioredis作为存储用<a class="ae ky" href="https://djangostars.com/blog/asynchronous-programming-in-python-asyncio/" rel="noopener ugc nofollow" target="_blank"> Python写同样的应用，检查结果，然后在一个Go应用中实现使用redis的存储。</a></p><p id="b70e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而且成功了！我在Python和Go中对这两个应用程序进行了基准测试，得到了相同的结果。首先我运行wrk测试API端点通过短字符串检索长URL。这是一个正确的决定，因为我得到了不同的结果。Go应用程序的速度提高了9倍，Python一秒钟处理超过43个请求。对于Python来说，这个数字现在是每秒280个请求，对于Go来说是每秒2500个请求。在我看来，这更接近事实。Locust可能建议让slaves进行适当的测试，而不是使用fork/threads，这就是为什么在当前设置中每秒43个请求是Locust的极限。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi of"><img src="../Images/b9a15691db29b92882160d8607051f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q5ec-KwtY00OqFMKQu2fdw.png"/></div></div><figcaption class="og oh gj gh gi oi oj bd b be z dk translated">*最终测试的打印输出</figcaption></figure><p id="f329" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个测试是关于存储长URL的API。它表明我的Go应用程序每秒可以处理大约20个请求。这证实了我的预期。在这个测试之后，我使用Redis进行了存储实现，并使用wrk再次运行了所有测试。</p><p id="abef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面，你可以看到测试结果的图表。我使用Raspberry Pi 3 B+作为应用程序的平台，并使用一台带有i7和16 Gb内存的笔记本电脑来运行wrk (Locust具有相同的配置)。使用Raspberry Pi是一个有意的决定，以便给我运行测试的笔记本电脑更多的功能。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kz"><img src="../Images/044cc7295e53072836dd2d7e247ee39e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZVNp0-_QZbIkasyv.png"/></div></div></figure><p id="41e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些结果都来自wrk，它已经使用12个线程和400个连接工作了30秒。这些数字是所有线程的总数，而不仅仅是一个线程。如果你对原始的wrk结果感兴趣，请点击<a class="ae ky" href="https://gist.github.com/Quard/74861f27fb956bbe088c002a8574ffbe" rel="noopener ugc nofollow" target="_blank">这个链接</a>。</p><p id="412c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">阅读还:</strong> <a class="ae ky" href="https://djangostars.com/blog/rest-apis-django-development/?utm_source=levelup.gitconnected.com&amp;utm_medium=medium&amp;utm_campaign=getting%20to%20know%20go%2C%20python%20and%20benchmarks&amp;utm_content=you%20may%20also%20like" rel="noopener ugc nofollow" target="_blank">如何用Django REST框架开发APIs】</a></p><h1 id="68f8" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">我的个人结果</h1><p id="01dc" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">说实话，我用Python写的，从一开始就在Gunicorn的帮助下运行的应用，结果比我给你看的还要差。它给出了大约。每秒360个请求。但是当我将Gunicorn的工人数量从2个(默认)增加到4个时，结果翻倍了。Raspberry Pi上有4个CPU，拥有比CPU更多的工作线程可能会导致更糟糕的结果。</p><p id="1d5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可能在Go应用程序上获得了更好的结果，但是我不太了解如何在生产环境中运行Go应用程序。</p><p id="9576" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我想说我对围棋感到非常兴奋。上一次我对一门编程语言如此兴奋是在我开始学习Python的时候。对于一个开发web应用程序的敏捷公司来说，随着越来越多的开发人员了解Python，Python现在可能是更好的选择。Python给人印象最深的是它庞大的社区。</p><p id="dc11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，我认为要用Go编写应用程序，开发人员应该比使用Python等其他语言时更多地考虑应用程序设计。否则，他们将来将无法进行更改和扩展应用程序功能。或者可能会非常困难。顺便说一下，这是我的Go应用程序的存储库，我希望在未来继续工作和扩展:<a class="ae ky" href="https://github.com/Quard/gosh" rel="noopener ugc nofollow" target="_blank">https://github.com/Quard/gosh</a>。</p><p id="619c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一件事。你们当中有谁在学习这两种语言时有过类似的经历吗？你有什么见解？</p><blockquote class="ok ol om"><p id="cc2f" class="jn jo kl jp b jq jr js jt ju jv jw jx on jz ka kb oo kd ke kf op kh ki kj kk ij bi translated">这篇关于<a class="ae ky" href="https://djangostars.com/blog/my-story-with-golang/?utm_source=levelup.gitconnected.com&amp;utm_medium=medium&amp;utm_campaign=getting%20to%20know%20go%2C%20python%20and%20benchmarks&amp;utm_content=originally%20posted" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Golang和Python </strong> </a>的文章最初发布于<a class="ae ky" href="https://djangostars.com/blog/?utm_source=levelup.gitconnected.com&amp;utm_medium=medium&amp;utm_campaign=getting%20to%20know%20go%2C%20python%20and%20benchmarks&amp;utm_content=ds%20blog" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Django Stars博客</strong> </a>。</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><a href="https://djangostars.com/services/python-django-development/?utm_source=levelup.gitconnected.com&amp;utm_medium=medium&amp;utm_campaign=getting%20to%20know%20go%2C%20python%20and%20benchmarks&amp;utm_content=banner_end"><div class="gh gi oq"><img src="../Images/6d17f1f498aa416fd7fa01921bc012f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_uHZvyUk2wIql_cXIsZcw.png"/></div></a></figure></div></div>    
</body>
</html>