<html>
<head>
<title>Designing Accessible Components for the Web</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Web设计可访问的组件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/designing-accessible-components-for-web-301691c96465?source=collection_archive---------22-----------------------#2022-02-07">https://levelup.gitconnected.com/designing-accessible-components-for-web-301691c96465?source=collection_archive---------22-----------------------#2022-02-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8250" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在React中编写一个符合WCAG标准的自定义列表框</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/15d40327e8f6b71df67cb3c19a7777dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9RTsfKUysy1_KKdE"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@elizabeth_woolner?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">伊丽莎白·伍尔纳</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="083a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="#a2e8" rel="noopener ugc nofollow"> <em class="ls">我不需要后台，直接带我去代码</em> </a></p><h1 id="0924" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated"><strong class="ak"> <em class="ml">谁应该读这个？</em>T15】</strong></h1><p id="3a27" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">出于本文的目的，我们假设如下:</p><ul class=""><li id="91bc" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">您对前端web开发有一定的了解，或者对React框架有一定的了解</li><li id="f90e" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">不管你目前的知识如何，你都想学习更多关于易访问性编码的知识。也许它对你的工作变得很重要，或者只是你想获得更多专业知识的一个领域。</li></ul><p id="7891" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我不会深入探讨可访问性遵从的复杂性；其他人已经就这个话题写了很棒的<a class="ae kv" href="https://krisrivenburgh.medium.com/the-ada-checklist-website-compliance-guidelines-for-2019-in-plain-english-123c1d58fad9" rel="noopener">篇</a>。但是，对于那些刚接触软件工程的人来说，如果一个网站可以被残疾人成功地使用，那么它就是可访问的。例如，有视力问题的人可能需要屏幕阅读器将屏幕上的信息传递给他们，或者不能使用鼠标或触控板的人可能需要使用键盘浏览网站。</p><p id="740c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大多数时候，易访问的编码并不困难。有几条主要规则可以帮你解决大部分问题:</p><ol class=""><li id="cfd4" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr nf mx my mz bi translated">总是使用正确和精确的HTML5语义元素。如果你的网站需要一个按钮，使用<code class="fe ng nh ni nj b">&lt;button&gt;</code>标签。是的，可以将一个<code class="fe ng nh ni nj b">&lt;div&gt;</code>标签设计成按钮的样子，并添加一个事件监听器，这样它的行为就完全像一个按钮。一个有视力的用户不会知道区别。然而，你还需要添加ARIA标签来告诉屏幕阅读器这应该是一个按钮。您需要添加一个<code class="fe ng nh ni nj b">tabindex</code>属性，以便让<code class="fe ng nh ni nj b">&lt;div&gt;</code>表现得像一个交互元素，如果用户用键盘在页面上移动，它将获得焦点。要使您的自定义元素可访问，您必须付出很大的努力。当您使用精确的语义元素时，您可以免费获得可访问性。</li><li id="0c9a" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">使用您精确的HTML5语义元素创建一个逻辑和层次结构的页面。每一页都有一个标签，并确保较小的标题只出现在它的后面。将主要内容包装在一个&lt;主&gt;标签中，并用<code class="fe ng nh ni nj b">&lt;section&gt;</code>标签填充。<code class="fe ng nh ni nj b">&lt;h1&gt;</code>标签与<code class="fe ng nh ni nj b">&lt;main&gt;</code>一起出现。CSS可以改变网站上几乎所有内容的外观，但是可访问性仅仅依赖于页面的简单结构来解释需要传达给用户的信息类型，并使页面便于残障人士导航。</li></ol><p id="456a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这两个规则(实际上是一个扩展的规则)可能在编码时考虑了80%的可访问性问题。</p><h1 id="2fe8" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">构建自定义可访问组件的原因</h1><p id="dd5c" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">当你不能轻易地应用上面的简单规则时会发生什么？我的要求是开发一个功能，用户将与下拉互动。一些来自UX的模拟包括提出了明确的样式下拉菜单。为了在小屏幕上利用浏览器特有的风格，还要求在移动网络上使用原生的<code class="fe ng nh ni nj b">&lt;select&gt;</code>标签。只有桌面浏览器会使用被UX嘲笑的显式下拉菜单。</p><p id="b1d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有几件事需要注意…</p><ol class=""><li id="d373" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr nf mx my mz bi translated">我的门票承认，一个原生<code class="fe ng nh ni nj b">&lt;select&gt;</code>标签将在每个浏览器上有不同的风格，尤其是移动浏览器。开发人员几乎没有直接控制样式的选择。我花了一点时间研究这个问题，没有发现任何新的东西，但我无法找到一种方法来哄一个本地的<code class="fe ng nh ni nj b">&lt;select&gt;</code>标签来匹配我的UX模仿。</li><li id="0f14" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">不使用原生的<code class="fe ng nh ni nj b">&lt;select&gt;</code>标签会自动给这个特性的可访问性带来风险，因为我必须打破可访问性编码的第一条规则——使用语义元素。对于这个用例，没有现成的HTML5元素。我需要建立我自己的。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/3ecfcf26ef874dfba9162385cf58749d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LavDgQWa3Whr3Cc1v_H0TA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Android(左)和iPhone(右)上相同的原生选择标签</figcaption></figure><h1 id="3990" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">可访问的创作指南</h1><h2 id="9bb0" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">目标</h2><p id="44a2" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">在构建可访问的web应用程序时，有两个主要方面需要关注:</p><ol class=""><li id="ec24" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr nf mx my mz bi translated">键盘导航——用户能否只用键盘浏览网页？在元素间导航时，焦点意外丢失了吗？键盘导航行为是否遵循预期的模式？</li><li id="2f59" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">屏幕阅读器声明—辅助技术(AT)的用户是否可以访问同样的可视信息？AT用户会被告知页面的错误或其他重大变化吗？</li></ol><p id="c9fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">万维网联盟(W3C)提供全面的<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/" rel="noopener ugc nofollow" target="_blank">网络无障碍资源</a>。链接层次结构中包含了<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/" rel="noopener ugc nofollow" target="_blank">创作指南</a>，它们精确地描述了每个组件的预期行为。(注意:W3C站点会提到<em class="ls"> widgets </em>，而React中常用的术语是<em class="ls"> component。</em>我觉得这些术语可以互换使用。底线是，我们正在建立一个具有特定功能的网页互动部分。)</p><p id="3236" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在浏览了选项之后，没有提到一个<code class="fe ng nh ni nj b">&lt;select&gt;</code>标签，但是那是因为这个站点没有涵盖本地HTML元素的行为。它涵盖了我们在创建自己的可访问元素时需要包含的内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/daac97e3ad6b20a0d7071c730a8b9ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*F9OW74eMcBpIp34rkS4-xg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来自<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/" rel="noopener ugc nofollow" target="_blank"> WAI-ARIA创作实践</a>的设计模式和小部件列表</figcaption></figure><p id="58f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们进一步探究这些设计模式，我们会发现一个<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/#Listbox" rel="noopener ugc nofollow" target="_blank">列表框</a>描述了一个本地<code class="fe ng nh ni nj b">&lt;select&gt;</code>元素的功能，所以这就是我们要编写的代码。实际上，根据组件的编写方式，可以实现不同的功能。例如，我们可能希望用户能够进行多项选择，或者能够在选择中滚动。该网站详细解释了如何通俗易懂地编写这些变化。对于这个例子，我们特别要编写一个<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/examples/listbox/listbox-collapsible.html" rel="noopener ugc nofollow" target="_blank">可折叠列表框</a>。</p><p id="bf90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该网站为我们提供了两个图表，每个主要关注领域一个，这些图表精确地列出了我们需要编码的内容，以使列表框按照预期的方式工作。</p><p id="9712" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，就完成了可访问列表框的所有背景。继续编码！</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><h2 id="a2e8" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">对可访问列表框进行编码</h2><p id="f095" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">在深入研究之前，总结一下，挑战在于设计和构建一个可访问的组件，其行为将与本机<code class="fe ng nh ni nj b">&lt;select&gt;</code>标签完全相同。</p><p id="0d58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在React中构建可访问的自定义listbox，但是无论使用什么样的框架或库，我们想要实现的可访问性目标都是一样的。</p><h2 id="3297" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">键盘导航</h2><p id="8ed6" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">这个图表向我们展示了我们需要支持的键盘交互。让我们开始分解它。通读需求，我们看到我们将有一个按钮，将切换列表框状态之间的折叠和展开。特定的键根据状态具有特定的功能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/affe704c1dc67d08a8698fc2b28453a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9epFUQ3UQieLXzaPM_0NA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来自<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/examples/listbox/listbox-collapsible.html" rel="noopener ugc nofollow" target="_blank"> WAI-ARIA创作实践</a>的可访问列表框的键盘支持规则</figcaption></figure><p id="a46f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是我们将要建造的:</p><ul class=""><li id="a99c" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">带有按钮的组件，可以在显示和隐藏下拉列表之间切换。</li><li id="35f0" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">下拉菜单将显示作为道具传入的字符串数组中的选项，并包含一个<code class="fe ng nh ni nj b">&lt;ul&gt;</code>标签，该标签将映射每个选项的列表项。</li><li id="b1db" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">我们需要一些辅助函数和状态来处理切换。</li></ul><h2 id="2767" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">React中的聚焦</h2><p id="dc0a" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">由于这是一个React项目，我们将在主DOM元素上设置<code class="fe ng nh ni nj b">Refs</code>来管理焦点。这被认为是React中<code class="fe ng nh ni nj b">Refs</code>的主要<a class="ae kv" href="https://reactjs.org/docs/refs-and-the-dom.html" rel="noopener ugc nofollow" target="_blank">可接受用法</a>之一。我们将需要对每个元素的直接DOM访问——外部列表框<code class="fe ng nh ni nj b">&lt;div&gt;</code>、按钮和列表项元素——以便能够对它们调用<code class="fe ng nh ni nj b">focus</code>方法。</p><h2 id="a508" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">初始代码</h2><p id="c56c" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">下面的代码是Listbox组件的起始结构。<code class="fe ng nh ni nj b">Refs</code>被设置在所有必要的元素上，但是我们只管理在<code class="fe ng nh ni nj b">toggleDropdown</code>函数中点击按钮时的焦点。事实上，由于我们使用的是原生HTML <code class="fe ng nh ni nj b">&lt;button&gt;</code>，浏览器确实为我们处理了这个问题。如果不在第43行设置明确的焦点，代码仍然可以工作。然而，其余的元素需要显式地管理焦点，以便表现得像本地的<code class="fe ng nh ni nj b">&lt;select&gt;</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">元素上设置了引用的初始代码</figcaption></figure><h2 id="fdc0" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">管理焦点</h2><p id="47df" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">Listbox有一个<code class="fe ng nh ni nj b">onSelected</code>方法，当用户与按钮交互时，该方法需要一个<code class="fe ng nh ni nj b">MouseEvent</code>或一个<code class="fe ng nh ni nj b">KeyboardEvent</code>。无论事件类型如何，都会执行<code class="fe ng nh ni nj b">onChange</code>和<code class="fe ng nh ni nj b">toggleDropdown</code>方法。</p><p id="a078" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要一些只响应键盘事件的焦点处理方法。下面的函数将实现W3C为<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/examples/listbox/listbox-collapsible.html" rel="noopener ugc nofollow" target="_blank">可折叠列表框</a>定义的键盘行为，如键盘支持图表中所述。</p><p id="0ae0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">重要注意事项</em> </strong></p><ul class=""><li id="9b72" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">使用<code class="fe ng nh ni nj b">event.preventDefault()</code>在这里尤其重要，这样就只实现了指定的键盘行为，尽管不是所有的键都需要它。</li><li id="05cd" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">我们还需要考虑列表项是<em class="ls">而不是</em>本地交互元素，所以它们通常不能接收浏览器焦点。这意味着我们需要控制他们的注意力。当需要焦点时，我们可以通过有条件地将每个列表项的<code class="fe ng nh ni nj b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex" rel="noopener ugc nofollow" target="_blank">tabindex</a></code> <a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex" rel="noopener ugc nofollow" target="_blank">属性</a>设置为<code class="fe ng nh ni nj b">-1</code>来做到这一点。</li></ul><p id="950e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ng nh ni nj b">handleButtonPress</code>在按钮上触发，以在单击按钮时切换下拉列表，并将焦点返回到按钮</p><p id="aa8b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ng nh ni nj b">handleKeyPress</code>触发具有特定键的特定行为的单个列表项。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">键盘焦点管理功能</figcaption></figure><p id="5612" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">列表项中的键盘交互现在可以处理了，但是对于键盘用户来说，仍然没有办法将焦点从按钮转移到列表项上。在检查了需求之后，我们看到，当列表框展开时，我们总是希望聚焦在选中的选项上，所以我们可以在<code class="fe ng nh ni nj b">useEffect</code>中自动聚焦。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="68b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，<code class="fe ng nh ni nj b">focusedValue</code>将被一个<code class="fe ng nh ni nj b">Ref</code>跟踪，所以我们可以在渲染之间保持这个值。我们不能在这里使用<code class="fe ng nh ni nj b">state</code>,否则每当下拉列表被折叠和再次展开时，值将被重置。如果用户多次打开和关闭下拉列表，我们希望列表框中的焦点总是反映选定的选项。如果这是一个应用程序通过这个列表框从后端获取和改变数据，我们可以依靠<code class="fe ng nh ni nj b">state</code>来完成。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="b2c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">键盘导航现在可以工作了！仅使用键盘，用户可以使用与本机<code class="fe ng nh ni nj b">&lt;select&gt;</code>标签所期望的相同的键来执行所有以下动作:</p><ul class=""><li id="6f1a" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">打开和关闭下拉菜单</li><li id="f8eb" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">遍历下拉选项</li><li id="0ee3" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">离开列表框</li></ul><h2 id="6e6e" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">管理ARIA</h2><p id="b4fb" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">但是就浏览器而言，这个组件仍然不是一个列表框，因为键盘导航暗示了一个列表框。对于浏览器来说，这仍然只是一个通用元素的集合。ARIA提供了一种方式让浏览器知道它正在呈现一个列表框。如<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA" rel="noopener ugc nofollow" target="_blank"> MDN Web文档</a>中所定义:</p><blockquote class="oi oj ok"><p id="49b2" class="kw kx ls ky b kz la jr lb lc ld ju le ol lg lh li om lk ll lm on lo lp lq lr ij bi translated">可访问的富互联网应用程序<strong class="ky ir"> (ARIA) </strong>是一组属性，定义了使web内容和web应用程序(尤其是那些用JavaScript开发的)对残障人士更易访问的方法。</p></blockquote><p id="5eff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回到<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/examples/listbox/listbox-collapsible.html" rel="noopener ugc nofollow" target="_blank">可折叠列表框的创作实践</a>,有另一个图表说明了预期的属性。我们实际上已经讨论了一个属性，键盘导航中焦点所需的<code class="fe ng nh ni nj b">tabindex</code>。</p><p id="7107" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其余的属性是ARIA属性，图表中的<strong class="ky ir">用法</strong>列引用了站点上的HTML，如果我们检查列表框中的元素，那么在我们自己的列表框中设置这些属性时，提供了一个清晰的示例。</p><p id="c52a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">用法</strong>列也提供了每个属性用途的一些指示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/d409d2ae6485bb979e5f3e68d4eb35c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IW4FsF6pX-pYljyuVn9fmg.png"/></div></div></figure><p id="2508" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要在一些元素上设置id，以便在设置ARIA属性值时可以引用它们。我们还需要确保页面上的id是唯一的，即使我们呈现了listbox的多个实例，所以让我们添加一个属性来确保我们可以传递一个唯一的值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="76da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加这些ARIA属性后，屏幕阅读器将宣布按钮的用途和状态。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/9faf722a6fe3c11f426e8ec75a244382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vf1VCCbjOlv87egl3UZeWw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">向按钮添加ARIA属性后的屏幕阅读器公告</figcaption></figure><p id="80d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们继续使用<code class="fe ng nh ni nj b">&lt;ul&gt;</code>和<code class="fe ng nh ni nj b">&lt;li&gt;</code>元素。在设置各种ARIA属性的同时，我们需要将<code class="fe ng nh ni nj b">listbox</code>的角色分配给<code class="fe ng nh ni nj b">&lt;ul&gt;</code>，将<code class="fe ng nh ni nj b">option</code>的角色分配给每个<code class="fe ng nh ni nj b">&lt;li&gt;</code>，以向浏览器表明它们作为这个小部件的一部分的用途。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="ae35" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">活动中的可访问列表框</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/0dab64444e209873e58605f1bc2a11fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*tJaw3RZeGc8mqGfstO2V5A.gif"/></div></figure><h2 id="17d7" class="nl lu iq bd lv nm nn dn lz no np dp md lf nq nr mf lj ns nt mh ln nu nv mj nw bi translated">包扎</h2><p id="062e" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">列表框现在可以访问了！它仍然缺少很多我们可能希望为视力正常的用户提供的功能(也许是为了通过自定义样式的类而提供的道具？)，但它适用于使用屏幕阅读器或键盘导航的人。</p><p id="aeba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是所涵盖内容的摘要:</p><ul class=""><li id="b476" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">尽可能使用语义HTML5元素。</li><li id="fb96" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">如果<em class="ls">不可能使用语义元素:</em></li></ul><ol class=""><li id="05db" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr nf mx my mz bi translated">找到<a class="ae kv" href="https://www.w3.org/TR/wai-aria-practices-1.1/" rel="noopener ugc nofollow" target="_blank"> WAI-ARIA创作指南</a>为你想要建立什么。</li><li id="b1e0" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">在React中，通过在元素上设置<code class="fe ng nh ni nj b">Refs</code>来管理焦点。这也可以用普通的JavaScript来处理。</li><li id="ab40" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">将<code class="fe ng nh ni nj b">-1</code>的<code class="fe ng nh ni nj b">tabindex</code>属性设置为允许非交互元素以编程方式接收焦点。</li><li id="8a2d" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">为特定按键编写功能代码时，请注意该按键的默认行为，并在适当的时候使用<code class="fe ng nh ni nj b">preventDefault</code>。</li><li id="b1f7" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">为ARIA属性设置引用元素的唯一id(并确保它们对于网页是唯一的)。</li><li id="7100" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">在元素上设置ARIA属性和角色。</li></ol><p id="43f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请访问这个<a class="ae kv" href="https://codesandbox.io/s/accessible-listbox-pxytx?file=/src/components/listbox.tsx" rel="noopener ugc nofollow" target="_blank">代码沙箱</a>查看完整的项目，感谢您的阅读！</p></div></div>    
</body>
</html>