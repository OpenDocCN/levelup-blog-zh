<html>
<head>
<title>Instead of a Comment, Use a Well-Named Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用一个命名良好的函数来代替注释</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/instead-of-a-comment-use-a-well-named-function-448eabb45607?source=collection_archive---------18-----------------------#2021-01-17">https://levelup.gitconnected.com/instead-of-a-comment-use-a-well-named-function-448eabb45607?source=collection_archive---------18-----------------------#2021-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f79b696a2e8e06a700b58a1901ef231b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6jNVvIOoD-0QI4Qq02ooHw.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@clementchai?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Clement Chai </a>在<a class="ae jg" href="https://unsplash.com/s/photos/craftsman?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="0088" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">发展中的开发商</h2><div class=""/><div class=""><h2 id="c097" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">用解释自身的代码替换解释性注释</h2></div><p id="714c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">回想一下你的第一堂编程课。你的第一门编程语言。也许是c，也许是Java。可能是HTML。当您学习语法规则时，<strong class="lj jt">您首先学习的事情之一是如何在代码中添加注释</strong>。无论是<code class="fe md me mf mg b">//</code>或<code class="fe md me mf mg b">/* */</code>或<code class="fe md me mf mg b">&lt;!-- //--&gt;</code>或<code class="fe md me mf mg b">#</code>或者甚至是<code class="fe md me mf mg b">c</code>或<code class="fe md me mf mg b">*</code>，这个新工具开启了一个令人兴奋的新可能性:</p><blockquote class="mh mi mj"><p id="d18a" class="lh li mk lj b lk ll kt lm ln lo kw lp ml lr ls lt mm lv lw lx mn lz ma mb mc im bi translated">如果(对我或其他任何人)不清楚这些代码行是做什么的，我可以用注释来解释。</p></blockquote><p id="73cd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有了这个闪亮的新工具，我们变得懒惰了。</p><p id="e981" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当我作为<a class="ae jg" href="https://www.pullrequest.com/" rel="noopener ugc nofollow" target="_blank">拉请求</a>的评审员工作时，我偶尔会遇到类似这样的代码:</p><pre class="mo mp mq mr gt ms mg mt mu aw mv bi"><span id="5a63" class="mw mx jj mg b gy my mz l na nb">const prepareMemberList = async (listName, fetchOptions) =&gt; {</span><span id="21cb" class="mw mx jj mg b gy nc mz l na nb">  // We need the list ID in order to get the members list,<br/>  // so check the mapping of list names to ids.<br/>  const mapping = require('../mappings/listToId.json')<br/>  const id = mapping[listName]</span><span id="6ceb" class="mw mx jj mg b gy nc mz l na nb">  const list = await DB.getMembersForList(id)<br/>  <br/>  // Make sure that we only get members from the database who joined<br/>  // between the startDate and the endDate<br/>  const filteredList = list.filter(member =&gt; {<br/>    return (member.joinDate &gt;= fetchOptions.startDate &amp;&amp;<br/>            member.joinDate &lt;= fetchOptions.endDate)<br/>  }</span><span id="dca0" class="mw mx jj mg b gy nc mz l na nb">  return filteredList.map(member =&gt; {<br/>    // Older member ids had spaces, but the newer format<br/>    // uses dashes. Convert everything to the newer format.<br/>    const formattedId = member.id.replace(' ', '-')</span><span id="dbf0" class="mw mx jj mg b gy nc mz l na nb">    return {<br/>      id: formattedId,<br/>      firstName: member.firstName,<br/>      lastName: member.lastName,<br/>      joinDate: member.joinDate<br/>    }<br/>  })<br/>}</span></pre><h2 id="e91c" class="mw mx jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated"><strong class="ak">如此。很多。评论。</strong></h2><p id="2d9c" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">事实上，你真的需要付出精神上的努力来将代码行从注释中分离出来。注释<em class="mk">对</em>很有帮助，因为它们解释了后面几行的一些错综复杂之处；但是它们也碍事，完全破坏了代码的可读性。</p><p id="c9d1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如何解决这个问题？我们很快就会谈到这一点。</p><h1 id="8777" class="ny mx jj bd nd nz oa ob ng oc od oe nj ky of kz nm lb og lc np le oh lf ns oi bi translated">解释性的评论会让我们变得懒惰</h1><p id="4155" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">想出编程问题的解决方案是一项工作。想出一个可读的解决方案是很难的工作。</p><p id="1af3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你可能经历了试图解决问题的第一次迭代，留下了嵌套在<code class="fe md me mf mg b">while</code>循环中的<code class="fe md me mf mg b">for</code>循环，你知道你已经找到了一种方法来覆盖那边的边缘情况。</p><p id="d640" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你已经解决了你的问题，你退后一步看看你的代码。太丑了。但这很有效。看这段代码的其他人不可能理解它。你现在理解它<em class="mk">因为你刚刚写了它，但你未来的自己不会。</em></p><blockquote class="mh mi mj"><p id="3ba2" class="lh li mk lj b lk ll kt lm ln lo kw lp ml lr ls lt mm lv lw lx mn lz ma mb mc im bi translated">我是不是应该在这段代码中多下点功夫，清理一下，让它更具可读性？那鸿我只会写评论来解释发生了什么。</p></blockquote><h1 id="e631" class="ny mx jj bd nd nz oa ob ng oc od oe nj ky of kz nm lb og lc np le oh lf ns oi bi translated">不需要解释的代码非常令人愉快</h1><p id="0895" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">让我们用一个简单重构指南来清理上面的代码示例。这条指导方针将是你从这篇文章中得到的唯一可行的东西:</p><blockquote class="mh mi mj"><p id="cd3d" class="lh li mk lj b lk ll kt lm ln lo kw lp ml lr ls lt mm lv lw lx mn lz ma mb mc im bi translated"><strong class="lj jt"> <em class="jj">如果可能的话，通过提取注释所引用的代码行，将它们提取到自己的函数中，这个函数的名字很棒。</em> </strong></p></blockquote><p id="af71" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">是的，名字很棒。像这样:</p><pre class="mo mp mq mr gt ms mg mt mu aw mv bi"><span id="f81a" class="mw mx jj mg b gy my mz l na nb">const prepareMemberList = async (listName, fetchOptions) =&gt; {</span><span id="ef16" class="mw mx jj mg b gy nc mz l na nb">  const listId = getListIdFromName(listName)<br/>  const list = await DB.getMembersForList(listId)</span><span id="eed0" class="mw mx jj mg b gy nc mz l na nb">  const filteredList = list.filter(<br/>    joinDateIsWithin(fetchOptions.startDate, fetchOptions.endDate)<br/>  )</span><span id="74e7" class="mw mx jj mg b gy nc mz l na nb">  return filteredList.map(member =&gt; {<br/>    return {<br/>      id: standardizeId(member.id),<br/>      firstName: member.firstName,<br/>      lastName: member.lastName,<br/>      joinDate: member.joinDate<br/>    }<br/>  })<br/>}</span></pre><p id="89db" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上面的代码示例中没有注释。我提取了注释和代码行，并用几个函数替换它们:</p><ul class=""><li id="a366" class="oj ok jj lj b lk ll ln lo lq ol lu om ly on mc oo op oq or bi translated"><code class="fe md me mf mg b">getListIdFromName(listName)</code></li><li id="d02c" class="oj ok jj lj b lk os ln ot lq ou lu ov ly ow mc oo op oq or bi translated"><code class="fe md me mf mg b">joinDateIsWithin(fetchOptions.startDate, fetchOptions.endDate)</code></li><li id="49cf" class="oj ok jj lj b lk os ln ot lq ou lu ov ly ow mc oo op oq or bi translated"><code class="fe md me mf mg b">standardizeId(member.id)</code></li></ul><p id="1722" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我甚至还没有提供这些函数的实现，但是你已经对这些函数可能做什么有了一个概念，这是因为它们的名字很好。</p><p id="b2b0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你不觉得这个版本更容易阅读吗？从一行到下一行发生了什么非常清楚。还有…没有评论。</p><p id="058a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Jeff Atwood有一篇很棒的博客文章，题为“<a class="ae jg" href="https://blog.codinghorror.com/code-tells-you-how-comments-tell-you-why/" rel="noopener ugc nofollow" target="_blank">代码告诉你如何做，评论告诉你为什么做</a>”他在第一段写道(我完全同意):</p><blockquote class="mh mi mj"><p id="d91a" class="lh li mk lj b lk ll kt lm ln lo kw lp ml lr ls lt mm lv lw lx mn lz ma mb mc im bi translated">你应该首先努力使你的代码尽可能简单易懂，而不是依赖注释。只有在代码无法变得更容易理解的时候，你才应该开始添加注释。</p></blockquote><h1 id="6ca6" class="ny mx jj bd nd nz oa ob ng oc od oe nj ky of kz nm lb og lc np le oh lf ns oi bi translated">找个更好的方式告诉我</h1><figure class="mo mp mq mr gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/f7407f05a13ba8acaa7b50d9b51faeda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*cVzYNKZNgXaI8iRTPRVcVA.jpeg"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">啊，好旧的灭火器<strong class="bd nd">盒</strong> <em class="oy">。</em></figcaption></figure><p id="7f65" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当我住在中国的时候，我看到这些灭火器箱无处不在——在商场、博物馆、学校。但是我总是很喜欢看到它们，因为它们贴着“灭火器<strong class="lj jt"> <em class="mk">箱</em> </strong>”的标签你可能会认为明亮的白色标签是为了提醒人们，如果你需要的话，这里有一个灭火器。当然，这是事实。但是，<strong class="lj jt">你为什么需要告诉我盒子的事？我需要灭火器。我不在乎那个盒子。</strong></p><p id="2ca3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">第一，没必要。如果你省略“盒子”这个词，你仍然可以达到提醒我灭火器在哪里的目的。</p><p id="5dd2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">另一方面，你<em class="mk">可能</em>有一个空盒子(灭火器被移除)，标签——这是一个“灭火器盒子”——仍然是正确的。你的标签可能在技术上是准确的，我会死于火灾。</p><p id="e4b0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有什么更好的方式来告诉我？也许只是一个大的灭火器图形或图标。或者盒子前面有一个透明的塑料面，这样我就可以从远处看到盒子里面有一个灭火器。你可以用很多更好的方式与我沟通<em class="mk">而不用</em>涂上白色的解释性注释。</p><h1 id="67fd" class="ny mx jj bd nd nz oa ob ng oc od oe nj ky of kz nm lb og lc np le oh lf ns oi bi translated">必要时进行评论</h1><p id="0ac6" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">如果你想让你的代码充满注释，那么你的注释需要是<strong class="lj jt">必需的</strong>。如果可以用提取到命名良好的函数中的代码来替换它们，那么它们就没有必要了。</p><p id="070e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">浏览你的代码。你是否看到贯穿始终的解释性注释？每隔几行代码就有解释打断吗？清理它，使你的代码更具可读性。将这些行提取到它们自己的名字令人惊叹的函数中，你将会得到解释自身的代码。</p><p id="088f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">编码快乐，朋友们！</p></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><p id="93af" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="mk">阿尔文·李</em>是亚利桑那州凤凰城的一名全栈开发人员和远程工作者，担任<a class="ae jg" href="https://www.pullrequest.com/" rel="noopener ugc nofollow" target="_blank"> PullRequest </a>的高级评审。他专门从事web开发、API构建以及为初创公司和小型企业提供服务集成。他在Moonlight上有空，在那里你可以<a class="ae jg" href="https://www.moonlightwork.com/app/users/2862/profile" rel="noopener ugc nofollow" target="_blank">查看他的个人资料</a>或者<a class="ae jg" href="https://www.moonlightwork.com/r/2862" rel="noopener ugc nofollow" target="_blank">请求雇佣他提供服务</a>。</p></div></div>    
</body>
</html>