# ä»å¤´å¼€å§‹ä½œæ›²ã€å¹ç¬›å­å’Œå’–å–±

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/compose-pipe-and-curry-from-scratch-99b417608d57>

![](img/e311cb91e9443b3ad05fafb1bd884f58.png)

[https://unsplash.com/photos/ImcUkZ72oUs](https://unsplash.com/photos/ImcUkZ72oUs)

æœ‰å¾ˆå¤šæ–‡ç« è§£é‡Šä»€ä¹ˆæ˜¯çƒ¹é¥ªå’Œä½œæ›²ã€‚ç”šè‡³è¿˜æœ‰æˆ‘å†™çš„[ä¸€ä¸ª](https://medium.com/@rolandpeelen/function-composition-currying-in-real-life-e74c86302205)ã€‚

ä½†æ˜¯ï¼Œè™½ç„¶æˆ‘è§‰å¾—æˆ‘çš„æ–‡ç« å¾ˆå…¨é¢ï¼Œä½†æˆ‘è®¤ä¸ºä»æœ‰ä¸€äº›è§£é‡Šçš„ä½™åœ°ã€‚å½“çœ‹ç€å’–å–±å’Œç»„æˆï¼Œä»¥åŠå®é™…çš„å®ç°ï¼Œä»–ä»¬ä¼¼ä¹å¾ˆç®€æ´ï¼Œå¯èƒ½å¾ˆéš¾ç†è§£åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚æœ¬æ–‡çš„ç›®çš„æ˜¯å»ºç«‹ä¸€äº›ç›´è§‰ï¼Œä»å¤´å¼€å§‹åˆ›å»ºä¸€ä¸ª`compose`ã€`pipe`ã€**ã€**å’Œ`curry`å‡½æ•°ã€‚ä»æœ€åŸºæœ¬çš„ç‰ˆæœ¬å¼€å§‹ï¼Œåˆ°æœ€ç®€æ´/å¤æ‚ä½†ä¹Ÿæœ€çµæ´»çš„ç‰ˆæœ¬ç»“æŸã€‚

# å’–å–±

> è®©å‡½æ•°ä¸€æ¬¡æ¥å—ä¸€ä¸ªå‚æ•°çš„è¿‡ç¨‹ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€äº›ä»£ç ã€‚

```
// Uncurried
const add = (x, y) => x + y;
[1,2,3].map(x => add(x, 4)); // [5, 6, 7]// Curried
const add = x => y => x + y;
[1,2,3].map(add(4)); // [5, 6, 7]
```

å¦‚æ‚¨æ‰€è§ï¼Œè¿™æœ‰ä¸€äº›ä¼˜ç‚¹ï¼Œä¸é‚£ä¹ˆå†—é•¿ã€‚ç„¶è€Œï¼Œä»¥è¿™ç§æ–¹å¼ç¼–å†™å‡½æ•°æ˜¯ä»¤äººè®¨åŒçš„ï¼Œå¹¶ä¸”ä¸æ˜¯ç‰¹åˆ«çµæ´»(ç›¸å½“æç«¯çš„ä¾‹å­)ï¼›

```
// Curried
const add5args = a => b => c => d => e => a + b + c + d + e;
add5args(1)(2)(3)(4)(5); // 15// Possible uncurried variant
const add5args = (a,b,c,d,e) => a + b + c + d + e;
add5args(1, 2, 3, 4, 5); // 15
```

æœ‰ä¸€ä¸ªå‡½æ•°ä¼šå°†æˆ‘ä»¬çš„ç¬¬äºŒä¸ªå˜é‡è½¬æ¢æˆä¸€ä¸ªå¯ä»¥ä¸€æ¬¡æ¥å—ä¸€ä¸ªå˜é‡çš„å˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ä¾‹å¦‚`Array.map`ä¸­ä½¿ç”¨å®ƒã€‚

# åˆæˆå’Œç®¡é“åŠŸèƒ½(0 çº§)

> å°†å¤šä¸ªå‡½æ•°é“¾æ¥åœ¨ä¸€èµ·ä»¥åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°è¿‡ç¨‹ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ä¸€äº›ä»£ç ã€‚

```
const add5 = x => x + 5;
const multiply6 = x => x * 6;const multiply6Add5 = compose(add, multiply);multiply6Add5(2); // 17 ğŸ˜
```

æ‰€ä»¥ä»`add5`å’Œ`multiply6`ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå®ƒæ˜¯ä¸¤è€…çš„**ç»„åˆ**ã€‚ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæ—¢èƒ½ä¹˜ä»¥ 6 åˆèƒ½åŠ ä¸Š 5 çš„æ–°å‡½æ•°ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªæ˜¯åçš„å‘¢ï¼Ÿ

å‡½æ•°åˆæˆçš„æ¦‚å¿µæ¥æºäºæ•°å­¦ã€‚åœ¨åŠ ã€ä¹˜ã€é™¤ä¹‹ç±»çš„ä¸œè¥¿æ—è¾¹ï¼Œæœ‰ä¸€ä¸ª`composition`æ“ä½œç¬¦ã€‚å®ƒæ˜¯ä¸€ä¸ªç‚¹ï¼Œä¸Šé¢æœ‰ä¸€ä¸ªæ´ã€‚

```
(f Â° g)(x) = f(g(x));
```

è¿™æ ·è¯»çš„è¯å°±æ˜¯ x çš„ g åçš„**f**å’Œå–`x`ï¼Œåº”ç”¨åˆ°`g`ï¼Œå†åº”ç”¨åˆ°`f`æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°çš„æ˜¯ï¼Œåˆæˆä»¥ç›¸åçš„é¡ºåºè¿›è¡Œã€‚ç¬¬äºŒä¸ªåŠŸèƒ½(`g`)åœ¨ç¬¬ä¸€ä¸ªåŠŸèƒ½ä¹‹å‰åº”ç”¨ã€‚è¿™ä¹Ÿæ˜¯å‡½æ•°ç»„åˆåœ¨ç¼–ç¨‹ä¸­è½åçš„åŸå› ã€‚åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†`pipe`å‡½æ•°çš„æ¦‚å¿µï¼Œè¯¥å‡½æ•°åè½¬åº”ç”¨ç¨‹åºï¼Œä½¿å…¶æˆä¸ºæˆ‘ä»¬ç›´è§‰è®¤ä¸ºçš„æ ·å­ã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬ç¼–å†™è‡ªå·±çš„ç»„åˆå’Œç®¡é“å‡½æ•°ã€‚

```
// Uncurried
const composeU = (f, g, x) => f(g(x));
const pipeU = (f, g, x) => g(f(x));// Curried
const compose = f => g => x => f(g(x));
const pipe = f => g => x => g(f(x));// Or reverse arguments for the pipe function
const pipe = f => g => x => compose(g)(f)(x);
```

å¦‚ä½ æ‰€è§ï¼Œè¿™ä¸æ•°å­¦ç¬¦å·éå¸¸ç›¸ä¼¼ã€‚æˆ‘ç”¨ä¸€ä¸ª`U`åœ¨åé¢å›ºå®šäº†æœªç»‘å®šçš„å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬ä»¥åå¯ä»¥åŒºåˆ†å®ƒä»¬ã€‚è®©æˆ‘ä»¬è¯•ç”¨ä¸€ä¸‹ã€‚

```
const add5 = x => x + 5;
const multiply6 = x => x * 6;// Uncurried
composeU(add, multiply, 2); // 17
pipeU(add, multiply, 2); // 42// Curried
const multiply6Add5 = compose(add)(multiply);
const add5Multiply6 = pipe(add)(multiply);multiply6Add5(2); // 17
add5Multiply6(2); // 42[1,2,3].map(multiply6Add5) // [11, 17, 23]
```

æœ‰æ—¶å€™ï¼Œèƒ½å¤Ÿå°†[çš„ä¸¤ä¸ªå‡½æ•°éƒ¨åˆ†åº”ç”¨åˆ°](https://en.wikipedia.org/wiki/Partial_application#:~:text=In%20computer%20science%2C%20partial%20application,producing%20a%20function%20of%20type%20.)çš„ä½œå“ä¸­çœŸçš„å¾ˆå¥½ï¼Œè¿™æ ·ä»¥åå°±å¯ä»¥åœ¨`map`ä¸­ä½¿ç”¨å®ƒä»¬äº†ã€‚ç„¶è€Œï¼Œæœ‰æ—¶å€™ï¼Œèƒ½å¤Ÿåœ¨å®ƒä»¬çš„æœªå—å½±å“çš„å˜ä½“ä¸­ä½¿ç”¨å®ƒä»¬ä¹Ÿæ˜¯å¾ˆå¥½çš„ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ‹¥æœ‰ä¸¤ä¸ªä¸–ç•Œçš„ä¼˜ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³å†™ä¸¤æ¬¡å‡½æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬æ¥åšä¸ªå¸®æ‰‹å§ã€‚

# å’–å–±åŠŸèƒ½(0 çº§)

æˆ‘ä»¬å°†ç›´æ¥è¿›å…¥æˆ‘ä»¬çš„åŸºæœ¬å’–å–±åŠŸèƒ½ã€‚

```
const curry = fn => x => y => fn(x, y);const addU = (x, y) => x + y;
const add = curry(addU);addU(4, 2); // 6
add(4)(2); // 6const add4 = add(4);
add4(10) // 14
```

æˆ‘ä»¬çš„ curry å‡½æ•°åªæ˜¯æ¥å—å¦ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åæ¥å—ä¸€äº›å‚æ•°ï¼Œå¹¶å°†å®ƒä»¬åº”ç”¨åˆ°å‚æ•°ä¸­ã€‚æ‰€ä»¥ç°åœ¨æˆ‘ä»¬åªéœ€è¦å®šä¹‰æˆ‘ä»¬çš„ addU å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æ ¹æ®å¦ä¸€ä¸ªå‡½æ•°æ¥å®šä¹‰æˆ‘ä»¬çš„ curried ç‰ˆæœ¬ã€‚ä¸é”™ï¼

## ä½†æ˜¯ç­‰ç­‰â€¦

å¦‚æœæˆ‘ä»¬æƒ³è¦ç»„åˆä¸¤ä¸ªä»¥ä¸Šçš„å‡½æ•°å‘¢ï¼Ÿè¿˜æ˜¯åº“é‡Œä¸€ä¸ªæœ‰ä¸‰ä¸ªå‚æ•°çš„å‡½æ•°ï¼Ÿ

# æ’°å†™åŠŸèƒ½(ç¬¬ 1 çº§)

å†è¡¥å……å‡ ä¸ªç‰ˆæœ¬å§ã€‚

```
const compose = f => g => x => f(g(x));
const compose3 = f => g => h => x => f(g(h(x)));
const compose4 = f => g => h => i => x => f(g(h(i(x))));
// â€¦
```

è™½ç„¶è¿™å¯è¡Œï¼Œä½†å¹¶ä¸ç†æƒ³ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ [rest è¿ç®—ç¬¦](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameter)ã€‚

```
const composeU = (...fns) => x => {
 let val = x;
   for (const fn of fns.reverse()) {
     val = fn(val)
   }
 return val;
};const add3 = x => x + 3;
const add4 = x => x + 4;
const add5 = x => x + 5;const add12 = compose(add3, add4, add5);add12(2); // 14 ğŸ˜
```

æ‰€ä»¥è¿™å¤ªæ£’äº†ï¼æˆ‘ä»¬å–æˆ‘ä»¬çš„å‡½æ•°ï¼Œä»¥ç›¸åçš„é¡ºåºä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ£€æŸ¥å®ƒä»¬ï¼Œå¹¶å°†å‡½æ•°åº”ç”¨åˆ°æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„å€¼ä¸Šã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„å‡½æ•°æ˜¯éå¸¸å¿…è¦çš„ï¼Œæˆ‘ä»¬åœ¨åšä»»ä½•æ“ä½œä¹‹å‰éƒ½è¦åè½¬æ•´ä¸ªæ•°ç»„â€¦ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥åšäº›ä»€ä¹ˆã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œæˆ‘ä»¬æ¥å—ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„ä¸œè¥¿ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°éå†å®ƒï¼ŒæŠŠå®ƒç®€åŒ–æˆä¸€ä¸ªå€¼ã€‚å—¯â€¦â€¦`reduce`â€¦â€¦

```
const compose = (...fns) => x => fns.reduceRight((acc, fn) => fn(acc), x);
```

é‚£æ›´å¥½ã€‚æˆ‘ä»¬ä»å³åˆ°å·¦å‡å°‘æ•°ç»„ï¼Œå°†æ¯ä¸ªå‡½æ•°åº”ç”¨åˆ°ç´¯åŠ å™¨ï¼Œä»è¾“å…¥å€¼å¼€å§‹ã€‚ä½†æ˜¯ç°åœ¨æœ‰ä¸€ä¸ªé—®é¢˜â€¦

```
const composeU = (...fns) => x => fns.reduceRight((acc, fn) => fn(acc), x);
const compose = curry(composeU);const add3 = x => x + 3;
const add4 = x => x + 4;
const add5 = x => x + 5;const add12 = compose(add3, add4, add5);add12(2); // [Function] ğŸ˜¥
```

ä¼¼ä¹æˆ‘ä»¬çš„å’–å–±åŠŸèƒ½åäº†ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å®ƒä¸ç»„æˆâ€¦

# å’–å–±åŠŸèƒ½(1 çº§)

å†è¡¥å……å‡ ä¸ªç‰ˆæœ¬å§ã€‚

```
const curry = fn => x => y => fn(x, y);
const curry3 = fn => x => y => z => fn(x, y, z);
const curry4 = fn => x => y => => z => a => fn(x, y, z, a);
// â€¦
```

è™½ç„¶è¿™ä¹Ÿå¯è¡Œï¼Œä½†ä¹Ÿè®¸æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ rest å‚æ•°åšäº›ä»€ä¹ˆâ€¦

```
const curry = fn => {
 return function curried (...args) {
   if(args.length >= fn.length) {
     return fn.apply(null, args);
   }
   return curried.bind(null, ...args);
 };
};
```

è¿™åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿæˆ‘ä»¬çš„ curry å‡½æ•°éœ€è¦ä¸€ä¸ªå‡½æ•°ã€‚æ£€æŸ¥â€¦ä½†æ˜¯ç„¶åâ€¦ä»æ¦‚å¿µä¸Šæ¥è¯´ï¼Œå³ä½¿å®ƒä¸æ˜¯è¿™æ ·å®ç°çš„ï¼Œä¹Ÿè¦æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªç¼“å†²åŒºã€‚æˆ‘ä»¬çš„`â€¦args`æ˜¯æ ¹æ®å®ƒä»¬çš„`length`(æˆ‘ä»¬å·²ç»æä¾›çš„æ•°é‡)æ¥æ£€æŸ¥çš„ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»è¾¾åˆ°äº†æˆ‘ä»¬éœ€è¦çš„æ•°é‡(æˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥`fn`çš„å‚æ•°æ•°é‡â€”æˆ–è€… [arity](https://en.wikipedia.org/wiki/Arity#:~:text=Arity%20(%2F%CB%88%C3%A6r%C9%AAt,also%20called%20adicity%20and%20degree.) â€”æ¥æ£€æŸ¥)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ‰€æœ‰çš„å‚æ•°åº”ç”¨åˆ°æœ€åˆæä¾›çš„å‡½æ•°(`fn`)å¹¶è¿”å›å®ƒã€‚å¦‚æœæ²¡æœ‰ï¼Œè¿”å›å†…éƒ¨å‡½æ•°ï¼Œä½†æ˜¯å°†æˆ‘ä»¬å·²ç»æ”¶åˆ°çš„å‚æ•°ç»‘å®šåˆ°å®ƒ(å‡†å¤‡æ¥æ”¶æ›´å¤š)ã€‚

æ¢å¥è¯è¯´ï¼Œé€’å½’åœ°è¿”å›`curried`ï¼Œç›´åˆ°æˆ‘ä»¬é‡åˆ°æœ€åˆæä¾›çš„å‡½æ•°çš„ arityã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªæ¼‚äº®ç®€æ´çš„ es6 ç­‰ä»·ç‰©ã€‚

```
const curry = fn => {
 const curried = (...args) =>
   args.length >= fn.length
     ? fn.apply(null, args)
     : curried.bind(null, ...args);
 return curried;
};
```

è®©æˆ‘ä»¬ç”¨ä¹‹å‰çš„`add5args`å‡½æ•°æ¥çœ‹çœ‹å®ƒçš„ä½œç”¨ã€‚

```
const add5argsU = (a, b, c, d, e) => a + b + c + d + e;
const add5args = curry(add5argsU);const a = add5args(1); // [Function] â€” 4 arguments left
const b = a(2); // [Function] â€” 3 arguments left
const c = b(3); // [Function] â€” 2 arguments left
const d = c(4); // [Function] â€” 1 arguments lefta(2,3,4,5) // 15
b(3,4,5) // 15
c(4,5) // 15
d(5); // 15
```

å¤ªæ£’äº†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸€æ¬¡æä¾›æ‰€æœ‰çš„å‚æ•°ï¼Œæˆ–è€…ä¸€åŠï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªï¼Œå¹¶ç»§ç»­æ·»åŠ ï¼Œç›´åˆ°æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„å‡½æ•°ã€‚ä¸é”™ï¼è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦å¯ä»¥åœ¨æˆ‘ä»¬çš„ compose å‡½æ•°ä¸­ä½¿ç”¨å®ƒã€‚

```
// From earlier
const composeU = (...fns) => x => fns.reduceRight((acc, fn) => fn(acc), x);
const compose = curry(composeU);const add1 = x => x + 1;
const add2 = x => x + 2;
const add3 = x => x + 3;
const add4 = x => x + 4;const add5 = compose(add2, add3);
const add7 = compose(add3, add4);
const add11 = compose(add4, add4, add3);add5(4); // 9
add7(4); // 11
add11(4); // 15const add12 = compose(add5, add7); // Already composed functions ğŸ˜
add12(4); // 16
```

ä¸é”™ï¼æ— è®ºæˆ‘ä»¬æä¾›å¤šå°‘å‚æ•°ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æŒ‰ç…§è‡ªå·±å–œæ¬¢çš„æ–¹å¼ç»„åˆå‡½æ•°ï¼Œå¹¶åœ¨ä»¥åä½¿ç”¨å®ƒä»¬ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥ç”¨å¦ä¸€ç¯‡ä½œæ–‡æ¥å®šä¹‰æˆ‘ä»¬çš„ä½œæ–‡ã€‚

# ç®¡é“åŠŸèƒ½(1 çº§)

æˆ‘ä»¬å¤ªå…´å¥‹äº†ï¼Œå®Œå…¨å¿˜è®°äº†æˆ‘ä»¬çš„`pipe`åŠŸèƒ½ã€‚è¿™å¾ˆå®¹æ˜“å®šä¹‰ã€‚

```
const composeU = (...fns) => x => fns.reduceRight((acc, fn) => fn(acc), x);
const pipeU = (...fns) => x => fns.reduce((acc, fn) => fn(acc), x);
const compose = curry(composeU);
const pipe = curry(pipeU);
```

å¾ˆå¥½ã€‚å¯¹å—ï¼Ÿå—¯ï¼Œanal-retentive-me æœ‰ç‚¹æ¼ç«ï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šåœ¨ç®¡é“å‡½æ•°ä¸­é‡å¤äº†æˆ‘ä»¬çš„ compose å‡½æ•°ï¼Œä½†åªæ˜¯å‚æ•°é¢ å€’äº†ã€‚ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥æ ¹æ®å½¼æ­¤æ¥å®šä¹‰å®ƒä»¬ã€‚æˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿç®€å•åœ°åè½¬å‡½æ•°çš„å‚æ•°ï¼Œå¹¶ä¸”åšå¾—å¾ˆå¥½ã€‚å¯¹å—ï¼Ÿ

```
const composeU = (...fns) => x => fns.reduceRight((acc, fn) => fn(acc), x);
const pipeU = (...fns) => x => composeU(...fns.reverse())(x)
const compose = curry(composeU);
const pipe = curry(pipeU);
```

å¥½å¤šäº†ã€‚æˆ‘ä»¬ä¹Ÿæ¥è¿‘äº`pipeU`æ‹¥æœ‰å¦‚æ­¤å°‘çš„è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹çœç•¥å®ƒçš„ä¸€äº›æµ‹è¯•â€¦
ä½†ä¸æ˜¯ç°åœ¨ã€‚æˆ‘è®¤ä¸ºæˆ‘ä»¬å¯ä»¥èµ°å¾—æ›´è¿œã€‚

# å¥–é‡‘æ°´å¹³

è¿˜æœ‰ä¸€ä»¶äº‹å¾ˆçƒ¦ã€‚æˆ‘ä»¬æœ‰è¿™ä¸ªæ¼‚äº®çš„ curry å‡½æ•°ï¼Œå½“æˆ‘ä»¬ç”¨å®ƒæŠŠæˆ‘ä»¬çš„`composeU`å˜æˆä¸€ä¸ª curry å‡½æ•°æ—¶ï¼Œå®ƒå·²ç»ä»¥å•ç‹¬æ¥å—â€˜æ•°æ®â€™å‚æ•°çš„æ–¹å¼è¢« curry åŒ–äº†ã€‚å¦‚æœæˆ‘ä»¬èƒ½è®©å®ƒç›´æ¥å˜æˆ curriedï¼Œæˆ–è€…ç«‹åˆ»æ¥å—å®ƒçš„æ‰€æœ‰å‚æ•°ï¼Œé‚£å°±å¤ªå¥½äº†ï¼Œè¿™æ ·æˆ‘ä»¬è‡³å°‘æ„Ÿè§‰åˆ°æˆ‘ä»¬çš„`curry`å‡½æ•°åšäº†ä¸€äº›å¥½äº‹ã€‚æˆ–è®¸æˆ‘ä»¬å¯ä»¥è¯•è¯•:

```
const composeU = (...fns, x) => fns.reduceRight((acc, fn) => fn(acc), x);
```

ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½â€¦

> è¯­æ³•é”™è¯¯:Rest å‚æ•°å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå½¢å‚ã€‚é‚£æ˜¯ä»¤äººå¤±æœ›çš„ã€‚

ç„¶è€Œã€‚è¿™è¿˜æ²¡å®Œâ€¦å¦‚æœæˆ‘ä»¬é˜…è¯»æ•°ç»„çš„å½’çº¦å‡½æ•°çš„[æ–‡æ¡£ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä»¥ä¸‹å†…å®¹:](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)

> initialValue **å¯é€‰**
> ä¸€ä¸ªå€¼ï¼Œç”¨ä½œå›è°ƒçš„ç¬¬ä¸€æ¬¡è°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚å¦‚æœæœªæä¾› initialValueï¼Œæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å°†ç”¨ä½œåˆå§‹ç´¯åŠ å™¨å€¼ï¼Œå¹¶ä½œä¸º currentValue è·³è¿‡ã€‚åœ¨æ²¡æœ‰ initialValue çš„ç©ºæ•°ç»„ä¸Šè°ƒç”¨ reduce()å°†å¼•å‘ TypeErrorã€‚

å•Šå“ˆã€‚æ‰€ä»¥æ˜¯**å¯é€‰**ã€‚å¦‚æœæˆ‘ä»¬ä¸æä¾›å‚æ•°ï¼Œå®ƒä¼šè‡ªåŠ¨ä»æ•°ç»„ä¸­å–å‡ºç¬¬**ä¸ª**é¡¹ã€‚ä¹ä¸€çœ‹ï¼Œè¿™ä¼¼ä¹å¯¹æˆ‘ä»¬æ²¡æœ‰å¸®åŠ©ï¼Œå› ä¸ºæˆ‘ä»¬æä¾›çš„å‚æ•°æ˜¯æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„ **last** ï¼Œæ‰€ä»¥å®ƒå°†æ˜¯æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªã€‚ä½†æ˜¯ï¼Œä»”ç»†ç ”ç©¶ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä»å³è¾¹å¼€å§‹å‡å°‘çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åˆ°è¾¾é‚£é‡Œæ—¶ï¼Œå®ƒå®é™…ä¸Šæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼

æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æŠŠ`x`æ”¾åœ¨ç¬¬äºŒä¸ªä½ç½®ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å®Œå…¨å¿½ç•¥å®ƒã€‚ç”šè‡³æ›´å¥½ï¼

```
const compose = (...fns) => fns.reduceRight((acc, fn) => fn(acc));
const pipe = (...fns) => compose(...fns.reverse());
```

å¾ˆå¥½â€¦é‚£æ­£åˆæˆ‘æ„ã€‚ç°åœ¨æˆ‘ä»¬çš„å‡½æ•°æœ‰äº†ä¸€ä¸ªå¯å˜çš„ arityï¼Œæˆ‘ä»¬å°±ä¸ç”¨å»ä¿®é¥°å®ƒäº†ï¼

# ç»“æŸçš„

å› æ­¤ï¼Œæˆ‘ä»¬å·²ç»ç»å†äº†å‡ æ¬¡`compose`ã€`pipe`å’Œ`curry` å‡½æ•°çš„è¿­ä»£ã€‚ä»æœ€ç®€å•çš„å˜ä½“å¼€å§‹ï¼Œå»ºç«‹ä¸€äº›ç›´è§‰ï¼Œä»¥éå¸¸çµæ´»çš„æŠ½è±¡å˜ä½“ç»“æŸã€‚

```
const compose = (...fns) => fns.reduceRight((acc, fn) => fn(acc));
const pipe = (...fns) => compose(...fns.reverse());const curry = fn => {
 const curried = (...args) =>
   args.length >= fn.length
     ? fn.apply(null, args)
     : curried.bind(null, ...args);
 return curried;
};
```