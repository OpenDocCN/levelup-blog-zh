<html>
<head>
<title>API Testing with Insomnia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">失眠时的API测试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/api-testing-with-insomnia-a090db3dbde6?source=collection_archive---------6-----------------------#2021-08-30">https://levelup.gitconnected.com/api-testing-with-insomnia-a090db3dbde6?source=collection_archive---------6-----------------------#2021-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="98e3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提高您的生产力，使测试更容易重现</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4ec4a362a883fc255f9eda10765825ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1pGaDDqO0BHUHkm4ENaug.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">失眠概述。例如，StackExchange API是通过这个<a class="ae ky" href="https://github.com/openapis/api-specs/tree/master/stackexchange" rel="noopener ugc nofollow" target="_blank"> OpenAPI规范</a>导入的。截图由马丁·托马斯拍摄。</figcaption></figure><p id="42e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">T2:测试是软件开发的关键部分。它有不同的风格，比如单元测试、压力测试、验收测试、冒烟测试。“试一试”可能是所有方法中最简单的一种，但是对于确信事情按照它们应该的方式运行是至关重要的。</p><p id="e626" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看完这篇文章，你就知道如何使用失眠进行API测试了。我们将浏览失眠的请求收集接口，查看环境，以及请求链接。我们开始吧！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="d9f5" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">基础知识</h1><p id="2579" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">如果您不知道什么是端点、HTTP方法或状态代码，请随时刷新您的知识:</p><div class="ni nj gp gr nk nl"><a rel="noopener  ugc nofollow" target="_blank" href="/api-testing-with-httpie-2d2d0dbe71ab"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd iu gy z fp nq fr fs nr fu fw is bi translated">使用HTTPie进行API测试</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">测试是软件开发的关键部分。它有不同的风格，比如单元测试、压力测试…</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ks nl"/></div></div></a></div></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="2636" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">失眠入门</h1><p id="3534" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">可以免费下载安装失眠(<a class="ae ky" href="https://insomnia.rest/download" rel="noopener ugc nofollow" target="_blank">链接</a>)。有一个附加功能的付费版本，但你现在不需要它。</p><p id="79a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，创建一个“请求集合”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/25d1ee6fcf4df5f6db74387c536299cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*4QskupR-f1EWzlxLZp8bBg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">创建新的“请求集合”。如果你有一个OpenAPI / Swagger规范YAML文件，你可以在这里导入它。截图摘自马丁·托马斯《失眠》</figcaption></figure><h1 id="5674" class="ml mm it bd mn mo ob mq mr ms oc mu mv jz od ka mx kc oe kd mz kf of kg nb nc bi translated">创建获取请求</h1><p id="1b72" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">单击“新请求”或按Ctrl + N，输入“获取姓名性别”作为请求名称。输入“https://api.genderize.io/”作为URL，然后转到“查询”选项卡。输入“名称”作为“新名称”，输入“Andreas”作为值。点击紫色的“发送”按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/a0cda213f178985a1da6ccd490cb440d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vPd4P1tvXhsakRSfsUWt0A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">您可以在左侧看到请求的名称。它向您显示这是一个GET请求。查询参数也很容易看到。服务器的响应代码以亮绿色显示。旁边是响应时间和响应内容的大小。马丁·托马斯截图。</figcaption></figure><h1 id="fa03" class="ml mm it bd mn mo ob mq mr ms oc mu mv jz od ka mx kc oe kd mz kf of kg nb nc bi translated">标题选项卡</h1><p id="9e8b" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">点击“标题”选项卡查看回复标题:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/7706bcff752618c3b5757b64df5ee94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDhOqArLA_42RHBvzbgxeA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">响应头通常显示关于服务器及其配置的元数据，例如nginx/1.16.1、日期和一些限速标签。“X-”表示这是一种可能不普遍的习俗。标题显示了关于内容的元数据，例如内容类型、内容长度。马丁·托马斯截图。</figcaption></figure><h1 id="89bb" class="ml mm it bd mn mo ob mq mr ms oc mu mv jz od ka mx kc oe kd mz kf of kg nb nc bi translated">时间线标签</h1><p id="7fc0" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">时间轴ab显示了请求和响应的顺序。我实际上从来没有用过这个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/2d5366bdc0f8373b980c8135a6baf41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jeDZeaL7snbk6qtHC4e_ug.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">截图由马丁·托马斯拍摄</figcaption></figure><h1 id="c098" class="ml mm it bd mn mo ob mq mr ms oc mu mv jz od ka mx kc oe kd mz kf of kg nb nc bi translated">响应历史概述</h1><p id="a5a4" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">用不同的名字再发送几个请求。然后查看亮绿色的状态代码——在最右边，有类似“一分钟前”/“刚才”的内容。如果您点击它，您可以看到响应历史:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/f2e49f9af469b364b1805cd61f140186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YGmBbAgXlMpxN4i70NEAzg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">如果您一次又一次地测试同一个端点，那么响应历史是非常有用的。在这里，您可以看到响应是否变得异常缓慢，或者响应体是否增加了很多。马丁·托马斯截图。</figcaption></figure><p id="5eb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您点击其中任何一个回复，您可以看到实际的回复、标题和时间表。</p><h1 id="ee88" class="ml mm it bd mn mo ob mq mr ms oc mu mv jz od ka mx kc oe kd mz kf of kg nb nc bi translated">使用环境</h1><p id="e058" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">既然您已经看到了UI的一些基础知识，那么是时候使用一个核心特性了:环境。如果你看左上方，就在“仪表板”下面，你可以看到“无环境”。让我们单击它，然后点击“管理环境”。或者，按Ctrl+E。查看“子环境”，单击“+”，然后单击“环境”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/8dc6732cb5c3bc181f284085dcb72604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_KWpZsXd74nORRe_ETRIFA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">我们将环境命名为“Peter ”,并在其中添加了值为“Peter”的变量“name”。您可以看到这3行内容只是一个普通的JSON字典。截图由马丁·托马斯拍摄。</figcaption></figure><p id="4d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在复制环境并创建一个“Karen”环境:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/05c02bff9153c95c7b591978dbd27cc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGvNwtSjOwRDe39dzlo6_A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">截图由马丁·托马斯拍摄。</figcaption></figure><p id="7adc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关闭“管理环境”窗口。使用“Peter”环境:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/7b7eb390a10f3d0cb54deadd9efde378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*WBQT3TflbD8fhttAPDb2gw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">截图由马丁·托马斯拍摄。</figcaption></figure><p id="4694" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在转到“查询”选项卡的“名称”键。该值可能是“Peter”——删除它。按Ctrl +空格键。您应该会看到大量选项:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/a68d617430f0da2b7e0ecbf27e1d3bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IGCgmHWWPsK7smO04lKu1A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">自动完成选项。截图由马丁·托马斯拍摄。</figcaption></figure><p id="6796" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择“_”。名”。您可以输入“_”。“名字也直接。现在，当您发送请求时，它使用您的环境中“name”变量的值。</p><p id="88cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着如果你改变环境，你发送的请求也会改变。</p><p id="6a24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这非常有用。您可能想要测试不同的运行时环境，例如开发、试运行、集成、预生产、生产。您可能想要测试不同用户的响应。只是为这些情况创造环境。</p><h1 id="0d5b" class="ml mm it bd mn mo ob mq mr ms oc mu mv jz od ka mx kc oe kd mz kf of kg nb nc bi translated">链接请求</h1><p id="8734" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">大多数API都需要某种形式的认证。通常，这意味着您登录并收到一个不记名令牌。该令牌必须在所有进一步的请求中发送。</p><p id="d60b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，请转到“标题”并输入密钥“认证”。作为一个值，您输入“Bearer”并按Ctrl+Space。然后输入“响应→体属性”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/11b20b6d23a3537468090aeb963660b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HDCfxK2-7sn1CgyqpK7dww.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">未填写响应正文属性。马丁·托马斯截图</figcaption></figure><p id="7e7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你点击红色方块时，你会看到这个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/81d71d0df2cf7fe0071cea994a8148d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjZV67YZfKiBXhFZ-Sfqjg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">马丁·托马斯截图</figcaption></figure><p id="0b19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我们只有一个“请求”,没有需要身份验证的API，但这对于演示来说已经足够好了。选择请求。在“过滤器”字段中，输入<code class="fe op oq or os b">$</code>。现在，您应该可以在实时预览中看到一些内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/9c8d85d0004c210e3f6eaf984d42e9c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtKfynpCHWDvu5VIucbAgA.png"/></div></div></figure><p id="1642" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们这里使用的语法叫做<a class="ae ky" href="https://restfulapi.net/json-jsonpath/" rel="noopener ugc nofollow" target="_blank"> JSONPath </a>。如果输入<code class="fe op oq or os b">$.gender</code>，这个宏将得到的值将是“男性”。对于访问令牌，您可以使用类似于<code class="fe op oq or os b">$.access</code>的东西。这取决于服务器的响应和您想要重用的内容。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="c6db" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">共享请求</h1><p id="dc52" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">失眠既可以导入又可以导出<code class="fe op oq or os b">curl</code>命令。<code class="fe op oq or os b">curl</code>是一个非常强大的发送HTTP请求的工具。它是免费的，几乎每个开发者都会知道。很多工具都依赖于它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/61313579e5ebfa7676fd260ec23a79cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VC1tCmhA3EK6XFzFnTOStQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">右键单击请求会显示“以Curl形式复制”和“生成代码”部分，以共享请求</figcaption></figure><p id="34e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管“Copy as Curl”是一个不错的选择，但是您的开发人员可能更喜欢其他的。例如，我喜欢Python代码和<code class="fe op oq or os b">requests</code>库。为此，请点击“生成代码”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/23e78dfe09bc4689c41aa07c9ce8a9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJkkv7GCavCWisYJR0zEPg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">生成代码来发送刚刚由失眠症患者发送的请求。问问你的开发者他们更喜欢什么。在“Shell”下面是选项“HTTPie ”,这也很好。</figcaption></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="f1c2" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">摘要</h1><p id="6ba0" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">您已经看到了如何创建定制请求。使用环境和请求链，您可以从单个请求中获得更多。我们已经研究了不同的元信息，比如请求时间表。最后，您已经看到了如何与开发人员共享请求。</p></div></div>    
</body>
</html>