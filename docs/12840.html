<html>
<head>
<title>How to Write a Pandas Dataframe as a PDF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•æŠŠç†ŠçŒ«æ•°æ®æ¡†å†™æˆPDFæ ¼å¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/how-to-write-a-pandas-dataframe-as-a-pdf-5cdf7d525488?source=collection_archive---------1-----------------------#2022-07-14">https://levelup.gitconnected.com/how-to-write-a-pandas-dataframe-as-a-pdf-5cdf7d525488?source=collection_archive---------1-----------------------#2022-07-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b799" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">ä½¿ç”¨matplotlibå°†ç†ŠçŒ«æ•°æ®æ¡†ç»˜åˆ¶æˆä¸€ä¸ªå¤§PDFæˆ–å¤šé¡µPDF</h2></div><p id="e670" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™æ˜¯æˆ‘æœ€è¿‘é¢ä¸´çš„ä¸€ä¸ªé—®é¢˜â€”â€”æˆ‘æœ‰ä¸€ä¸ªç»è¿‡ä»”ç»†è®¡ç®—çš„ç†ŠçŒ«æ•°æ®æ¡†æ¶ï¼Œéœ€è¦å°†å®ƒä»¬â€œæ‰“å°â€æˆPDFæ ¼å¼ã€‚è™½ç„¶Pandasä¸­æœ‰to_markdown()å’Œto_html()ï¼Œä½†æ˜¯æ²¡æœ‰ç®€å•çš„æ–¹æ³•æ¥åˆ›å»ºPDFæ–‡ä»¶ã€‚</p><h2 id="49d8" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">ç›®æ ‡</h2><p id="9bfc" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">æˆ‘æƒ³è¦çš„æ˜¯ä¸¤ç§æ ¼å¼çš„æ•°æ®:</p><ol class=""><li id="27f1" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">ä¸€ä¸ªæ˜¯åŒ…å«æ•´ä¸ªè¡¨æ ¼çš„å¤§PDFï¼Œé€‚åˆç”µå­æŸ¥çœ‹</li></ol><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mi"><img src="../Images/9b21b028fc6d9ef6c76403050a82351a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hOkbHXKVbOSOhdRVH3_0FA.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">ä¸€ä¸ªåŒ…å«æ•°æ®çš„å¤§PDF</figcaption></figure><p id="bee0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.ä¸€ç§å¤šé¡µPDFï¼Œé€‚ç”¨äºå°†è¡¨æ ¼åˆ†è§£ä¸ºå¤šé¡µçš„æ‰“å°ã€‚</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi my"><img src="../Images/58bed3e70f740c4412b68ad1d79454a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r7o7N9oI-npzoW-WAqYb7Q.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">ç†ŠçŒ«æ•°æ®æ¡†æ¶åˆ†å¸ƒåœ¨å¤šä¸ªé¡µé¢ä¸Šã€‚è¿™æ˜¯ç¬¬ä¸‰é¡µã€‚</figcaption></figure><p id="56cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦‚æ‚¨æ‰€è§ï¼Œè¯¥è¡¨è¿˜éœ€è¦ä¸ºè¡Œæä¾›äº¤æ›¿çš„é¢œè‰²ï¼Œå¹¶ä¸ºè¡Œåå’Œåˆ—åæä¾›ç‰¹æ®Šçš„é¢œè‰²ã€‚</p><h2 id="a3bd" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">Matplotlibæ‹¯æ•‘ä¸–ç•Œ</h2><p id="0e5a" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Matplotlibç»˜åˆ¶ä¸€ä¸ªè¡¨ï¼Œå…¶ä¸­è¡Œæ ‡ç­¾æ˜¯Pandasæ•°æ®å¸§ç´¢å¼•ï¼Œåˆ—æ ‡ç­¾æ˜¯åˆ—çš„åç§°:</p><pre class="mj mk ml mm gt mz na nb nc aw nd bi"><span id="1856" class="lb lc iq na b gy ne nf l ng nh">the_table = ax.table(cellText=df.values,<br/>                        rowLabels=df.index,<br/>                        colLabels=df.columns)</span></pre><p id="bc26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Matplotlibå…è®¸æ‚¨å•ç‹¬è®¾ç½®æ¯ä¸ªå•å…ƒæ ¼çš„é¢œè‰²ã€‚æˆ‘ä»¬å¸Œæœ›æ¯è¡Œåœ¨ç™½è‰²å’Œç°è‰²ä¹‹é—´äº¤æ›¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åšåˆ°äº†:</p><pre class="mj mk ml mm gt mz na nb nc aw nd bi"><span id="ebba" class="lb lc iq na b gy ne nf l ng nh">alternating_colors = ([['white'] * len(df.columns), ['lightgray'] * len(df.columns)] * len(df)[:len(df)]</span><span id="6cf6" class="lb lc iq na b gy ni nf l ng nh">the_table = ax.table(cellText=df.values,<br/>                        rowLabels=df.index,<br/>                        colLabels=df.columns,<br/>                        <strong class="na ir">rowColours=['lightblue']*len(df),<br/>                        colColours=['lightblue']*len(df.columns),<br/>                        cellColours=alternating_colors</strong>,<br/>                        loc='center')</span></pre><p id="660f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒå†™æˆPDFã€‚ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨Matplotlibä¸­çš„PDFPagesåç«¯:</p><pre class="mj mk ml mm gt mz na nb nc aw nd bi"><span id="3bd0" class="lb lc iq na b gy ne nf l ng nh">with PdfPages(filename) as pdf:<br/>     fig = _draw_as_table(page, pagesize)<br/>     pdf.savefig(fig, bbox_inches='tight')   <br/>     plt.close()</span></pre><p id="e192" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸ºäº†åˆ†é¡µï¼Œæˆ‘ä»¬åªéœ€æ¯é¡µè°ƒç”¨ä¸€æ¬¡savefig()ï¼Œæ³¨æ„ä½¿ç”¨iloc()é€‚å½“åœ°åˆ†è§£Pandasæ•°æ®å¸§ã€‚è¿˜è¦æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨æ–‡æœ¬æ³¨é‡Šåœ¨ç”Ÿæˆçš„PDFä¸­å†™å…¥é¡µç :</p><pre class="mj mk ml mm gt mz na nb nc aw nd bi"><span id="7f3b" class="lb lc iq na b gy ne nf l ng nh">with PdfPages(filename) as pdf:<br/>    nh, nv = numpages<br/>    rows_per_page = len(df) // nh<br/>    cols_per_page = len(df.columns) // nv<br/>    for i in range(0, nh):<br/>        for j in range(0, nv):<br/>            page = <strong class="na ir">df.iloc</strong>[<br/>             (i*rows_per_page):min((i+1)*rows_per_page, len(df)),<br/>                          <br/>             (j*cols_per_page):min((j+1)*cols_per_page, len(df.columns))]<br/>            fig = _draw_as_table(page, pagesize)<br/>            if nh &gt; 1 or nv &gt; 1:<br/>                # Add a part/page number at bottom-center of page<br/>                <strong class="na ir">fig.text</strong>(0.5, 0.5/pagesize[0],<br/>                         "Part-{}x{}: Page-{}".format(i+1, j+1, i*nv + j + 1),<br/>                         ha='center', fontsize=8)<br/>            pdf.savefig(fig, bbox_inches='tight')<br/>            <br/>            plt.close()</span></pre><h2 id="ef38" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">å®Œæ•´ä»£ç </h2><p id="dff0" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç :</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="0b53" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">ä½¿ç”¨</h2><p id="2517" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">åœ¨ç”Ÿæˆçš„æ•°æ®å¸§ä¸Šä½¿ç”¨å®ƒçš„ç¤ºä¾‹:</p><pre class="mj mk ml mm gt mz na nb nc aw nd bi"><span id="a3fa" class="lb lc iq na b gy ne nf l ng nh">import string<br/>nrows = 100<br/>df = pd.DataFrame(np.random.randint(0,100,size=(nrows, 26)), <br/>         columns=list(string.ascii_uppercase), index=range(nrows))</span><span id="2c35" class="lb lc iq na b gy ni nf l ng nh"><strong class="na ir">dataframe_to_pdf(df, 'test_1.pdf')<br/>dataframe_to_pdf(df, 'test_6.pdf', numpages=(3, 2))</strong></span></pre><p id="6ff0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae nl" href="https://github.com/lakshmanok/lakblogs/blob/main/dataframe_to_pdf.ipynb" rel="noopener ugc nofollow" target="_blank">å®Œæ•´ç¤ºä¾‹ç¬”è®°æœ¬</a>åœ¨GitHubä¸Šã€‚</p><p id="8a7f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å°½æƒ…äº«å—å§ï¼</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h1 id="39c8" class="nt lc iq bd ld nu nv nw lg nx ny nz lj jw oa jx lm jz ob ka lp kc oc kd ls od bi translated">åˆ†çº§ç¼–ç </h1><pre class="mj mk ml mm gt mz na nb nc aw nd bi"><span id="59cb" class="lb lc iq na b gy ne nf l ng nh">Thanks for being a part of our community! More content in the <a class="ae nl" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">Level Up Coding publication</a>.</span><span id="d1d7" class="lb lc iq na b gy ni nf l ng nh">Follow: <a class="ae nl" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>, <a class="ae nl" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="ae nl" href="https://newsletter.levelup.dev/" rel="noopener ugc nofollow" target="_blank">Newsletter</a></span><span id="4c77" class="lb lc iq na b gy ni nf l ng nh">Level Up is transforming tech recruiting ğŸ‘‰ <a class="ae nl" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"><strong class="na ir">Join our talent collective</strong></a></span></pre></div></div>    
</body>
</html>