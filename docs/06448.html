<html>
<head>
<title>Connect to Elasticsearch using Python — A quick-ish guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python连接到Elasticsearch快速指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/connect-to-elasticsearch-using-python-a-quick-ish-guide-c632c09b382a?source=collection_archive---------7-----------------------#2020-11-25">https://levelup.gitconnected.com/connect-to-elasticsearch-using-python-a-quick-ish-guide-c632c09b382a?source=collection_archive---------7-----------------------#2020-11-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5f41cb4affda1129c7983365447be48c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yy-cXx2PhZJIURanwC8gLA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">想使用Python进行Elasticsearch吗？不要再看了！</figcaption></figure><p id="eeeb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你在这里，你可能听说过Elasticsearch，也许你想知道为什么你更喜欢Elasticsearch来检索文档，而不是普通的SQL数据库。</p><p id="243b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Elasticsearch(或简称ES)很容易扩展以处理大量文档，并提供了广泛的功能，不仅与SQL数据库功能相匹配，而且在某些情况下还超过了SQL数据库。例如，ES在基于文本的搜索方面做得非常好，最初是作为搜索引擎开发的。</p><p id="0e9c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">它也是开源的，所以如果你只是想尝试一下，你就不必担心许可证什么的。如果你想认真对待它，并需要更多的果汁，<a class="ae la" href="https://www.elastic.co/" rel="noopener ugc nofollow" target="_blank">elastic.co</a>已经为你提供了他们的麋鹿栈，它还带有Kibana analytics等等。</p><p id="3aa6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">至此，让我们来看一个如何使用Python连接到Elasticsearch的简单示例！</p><h1 id="b516" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在我们开始之前做一点准备…</h1><p id="6037" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">因为我的主要工作是Django，所以我将使用Django Rest框架向您展示如何使用Django服务器向ES索引添加文档，以及运行真正基本的搜索。这对于在典型的HTTP服务器中利用ES的能力非常方便。</p><p id="f746" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">幸运的是，您不必使用Django或它的Rest框架库！您只需替换Rest框架组件来提供一个字典，该字典包含您想要上传到ES索引的源数据，但是我们稍后会谈到这一点。</p><h1 id="e8ab" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">而现在…</h1><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/304005d0e787d9ee5338cdd554abb289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D5mEhNzhpKbADUr0BJ3i1w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">该编码了。</figcaption></figure><p id="2db9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们来看看一个非常简单的实现。注意，您必须将<code class="fe mj mk ml mm b">elasticsearch</code>包安装到您的虚拟环境中(如果您使用Docker，则安装到容器中)。</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="3ae6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为此，我们将假设接收Elasticsearch服务器已经设置好并准备好接收命令。</p><h1 id="72bb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">哇，那它是怎么工作的？</h1><p id="20a8" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">我们的ES helper类使得索引任何Django模型对象变得非常方便，比如:</p><pre class="mf mg mh mi gt mp mm mq mr aw ms bi"><span id="e2e1" class="mt lc iq mm b gy mu mv l mw mx">def index(obj):<br/>    es_handler = Es() <br/>      # make sure your DRF serializer handles the object type.<br/>    es_handler.index_obj(obj)</span></pre><p id="7726" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您没有使用Django或Rest框架，您可以这样索引文档:</p><pre class="mf mg mh mi gt mp mm mq mr aw ms bi"><span id="25bb" class="mt lc iq mm b gy mu mv l mw mx">def index(dict_like):<br/>    es_handler = Es() <br/>    # accepts a dictionary with at least one item 'id'.<br/>    es_handler.index_dict(dict_like)</span></pre><h1 id="2ee8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">那么助手里到底是怎么回事呢？</h1><p id="7b0c" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">正如您所料，函数的真正内容在<code class="fe mj mk ml mm b">self.es.index()</code>中，它需要几个参数:</p><ol class=""><li id="84df" class="my mz iq ke b kf kg kj kk kn na kr nb kv nc kz nd ne nf ng bi translated"><code class="fe mj mk ml mm b">index</code>，索引的名称/别名</li><li id="1258" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated"><code class="fe mj mk ml mm b">id</code>，您将要在Elasticsearch上存储的文档的主键</li><li id="6896" class="my mz iq ke b kf nh kj ni kn nj kr nk kv nl kz nd ne nf ng bi translated"><code class="fe mj mk ml mm b">body</code>，一个包含文档数据的字典(这个东西在Elasticsearch上运行，并在搜索结果中返回)。</li></ol><p id="d4f7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您对ES不熟悉，可以把索引想象成Windows中的一个文件夹，其中包含一大堆文档。文档包含您通过<code class="fe mj mk ml mm b">body</code>输入的数据，并根据您给出的<code class="fe mj mk ml mm b">id</code>命名。再次使用相同的<code class="fe mj mk ml mm b">id</code>进行索引将会覆盖第一个文档。</p><h1 id="fc81" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">感谢您的阅读！</h1><p id="efa4" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">在本文中，我们介绍了如何使用Python/Django连接到Elasticsearch，以及如何索引文档。然而，我没有涉及搜索，因为这需要更多的解释。如果有足够的需求，我可能会讨论这个话题，但是现在，谢谢你再次通读这篇文章！</p></div></div>    
</body>
</html>