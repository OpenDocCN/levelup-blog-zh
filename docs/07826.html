<html>
<head>
<title>How to Query Blocks on the TRON Blockchain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在TRON区块链上查询区块</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-query-blocks-on-the-tron-blockchain-2ee3c46156ec?source=collection_archive---------6-----------------------#2021-03-14">https://levelup.gitconnected.com/how-to-query-blocks-on-the-tron-blockchain-2ee3c46156ec?source=collection_archive---------6-----------------------#2021-03-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3bfa" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">就用R包tronr</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/61d31980a5a5abc338a929f5f3ffa03a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D92GHT4xnosfH618NmNTsg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">谢尔盖·马斯蒂斯基摄影</figcaption></figure><p id="97e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi lu translated">与任何其他区块链一样，TRON网络上的事务被组织成块。块是逻辑单元，可以看作是分类帐中的页面。每个块都有一个ID和一个时间戳，并且包含在某个时间段内发生的事务的信息。在创区块链上，区块覆盖3秒的间隔。</p><p id="8ced" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">获取一个区块或一组区块的信息通常是分析区块链数据的起点。本文演示了如何使用R包<code class="fe me mf mg mh b"><a class="ae md" href="https://github.com/next-game-solutions/tronr" rel="noopener ugc nofollow" target="_blank">tronr</a></code>来收集这些信息，这是一个探索创区块链的工具箱。</p><div class="mi mj gp gr mk ml"><a rel="noopener  ugc nofollow" target="_blank" href="/introducing-tronr-an-r-package-to-explore-the-tron-blockchain-f0413f38b753"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd iu gy z fp mq fr fs mr fu fw is bi translated">介绍tronr，一个探索TRON区块链的R包</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">查询账户余额、交易、代币转账等等。</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz ks ml"/></div></div></a></div><h1 id="7089" class="na nb it bd nc nd ne nf ng nh ni nj nk jz nl ka nm kc nn kd no kf np kg nq nr bi translated">查询单个块</h1><p id="11e7" class="pw-post-body-paragraph ky kz it la b lb ns ju ld le nt jx lg lh nu lj lk ll nv ln lo lp nw lr ls lt im bi translated">可用<code class="fe me mf mg mh b">get_block_info()</code>功能查询单个程序块(详见<a class="ae md" href="https://next-game-solutions.github.io/tronr/reference/get_block_info.html" rel="noopener ugc nofollow" target="_blank">在线文档</a>)。默认情况下，此函数返回最新生成的块的数据:</p><pre class="kj kk kl km gt nx mh ny nz aw oa bi"><span id="46d0" class="ob nb it mh b gy oc od l oe of">library(dplyr)<br/>library(tidyr)<br/>library(tronr)</span><span id="2a62" class="ob nb it mh b gy og od l oe of">#&gt; R toolbox to explore the TRON blockchain<br/>#&gt; Developed by Next Game Solutions (<a class="ae md" href="http://nextgamesolutions.com" rel="noopener ugc nofollow" target="_blank">http://nextgamesolutions.com</a>)</span><span id="dab7" class="ob nb it mh b gy og od l oe of">latest &lt;- get_block_info()</span><span id="3fb2" class="ob nb it mh b gy og od l oe of">glimpse(latest)</span><span id="46af" class="ob nb it mh b gy og od l oe of">#&gt; Rows: 1<br/>#&gt; Columns: 11<br/>#&gt; $ request_time    &lt;dttm&gt; 2021-03-14 16:29:36<br/>#&gt; $ block_number    &lt;chr&gt; "28449202"<br/>#&gt; $ timestamp       &lt;dttm&gt; 2021-03-14 16:28:36<br/>#&gt; $ hash            &lt;chr&gt; "0000000001b219b2d39d0fef84...<br/>#&gt; $ parent_hash     &lt;chr&gt; "0000000001b219b1b45025d87b...<br/>#&gt; $ tx_trie_root    &lt;chr&gt; "TAiDWyo2xFwWPAJGk6nHeDRoLy...<br/>#&gt; $ confirmed       &lt;lgl&gt; TRUE<br/>#&gt; $ size            &lt;int&gt; 28535<br/>#&gt; $ witness_address &lt;chr&gt; "TMG95kirH4cKW5GnKoCcCye1dB...<br/>#&gt; $ tx_count        &lt;int&gt; 117<br/>#&gt; $ tx              &lt;list&gt; [&lt;tbl_df[117 x 4]&gt;]</span></pre><p id="ee88" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据以<a class="ae md" href="https://tidyr.tidyverse.org/articles/nest.html" rel="noopener ugc nofollow" target="_blank">嵌套表</a>的形式返回。从<code class="fe me mf mg mh b">tx</code>列可以看出这个表的嵌套性质，这是一个包含单个元素的列表——另一个表包含属于这个块的事务的基本数据:</p><pre class="kj kk kl km gt nx mh ny nz aw oa bi"><span id="1bac" class="ob nb it mh b gy oc od l oe of">latest %&gt;% select(tx) %&gt;% unnest(cols = tx)</span><span id="6a4d" class="ob nb it mh b gy og od l oe of">#&gt; # A tibble: 117 x 4<br/>#&gt;    tx_id      contract_type  from_address   to_address  <br/>#&gt;    &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;       <br/>#&gt;  1 68ec65ea8~ TransferAsset~ TNA16cAySySgH~ TTbZWd1oWsi~<br/>#&gt;  2 f57a3223c~ TransferAsset~ TCqBZyPC9cXHt~ TUy87XWuwLm~<br/>#&gt;  3 e4a1030cd~ TriggerSmartC~ THtbMw6byXuiF~ TK5qKN9xJoL~<br/>#&gt;  4 6d1308bb5~ TransferAsset~ TQ1DnUTJ2Rp1i~ THWtE67AFDo~<br/>#&gt;  5 aa8974c97~ TransferAsset~ TDPPyq7NYE1pz~ TV6z2FS4dtu~<br/>#&gt;  6 2268325a6~ TransferContr~ TAK9Ms2HMfeuq~ TGtLNH2UFnC~<br/>#&gt;  7 564099e2c~ TransferContr~ TZCVhWWYweyC1~ TPmWzzLMHzY~<br/>#&gt;  8 e00fb3e87~ TransferAsset~ TJnrpbNpJwVhz~ TCDwjF4ich1~<br/>#&gt;  9 11e84be40~ TransferAsset~ TWJMJbiweMzQi~ TSg1NCBD44D~<br/>#&gt; 10 6d7a37fe4~ TransferAsset~ TDSVqaDqCxTba~ TVamy8pNphv~<br/>#&gt; # ... with 107 more rows</span></pre><p id="0e02" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要获得特定块的数据，必须提供它的编号(作为一个字符值)并将参数<code class="fe me mf mg mh b">latest</code>切换到<code class="fe me mf mg mh b">FALSE</code>:</p><pre class="kj kk kl km gt nx mh ny nz aw oa bi"><span id="a82f" class="ob nb it mh b gy oc od l oe of">block &lt;- get_block_info(latest = FALSE, block_number = "28449202")</span><span id="e904" class="ob nb it mh b gy og od l oe of">glimpse(block)</span><span id="7d0c" class="ob nb it mh b gy og od l oe of">#&gt; Rows: 1<br/>#&gt; Columns: 11<br/>#&gt; $ request_time    &lt;dttm&gt; 2021-03-14 16:52:03<br/>#&gt; $ block_number    &lt;chr&gt; "28449202"<br/>#&gt; $ timestamp       &lt;dttm&gt; 2021-03-14 16:28:36<br/>#&gt; $ hash            &lt;chr&gt; "0000000001b219b2d39d0fef84...<br/>#&gt; $ parent_hash     &lt;chr&gt; "0000000001b219b1b45025d87b...<br/>#&gt; $ tx_trie_root    &lt;chr&gt; "TAiDWyo2xFwWPAJGk6nHeDRoLy...<br/>#&gt; $ confirmed       &lt;lgl&gt; TRUE<br/>#&gt; $ size            &lt;int&gt; 28535<br/>#&gt; $ witness_address &lt;chr&gt; "TMG95kirH4cKW5GnKoCcCye1dB...<br/>#&gt; $ tx_count        &lt;int&gt; 117<br/>#&gt; $ tx              &lt;list&gt; [&lt;tbl_df[117 x 4]&gt;]</span></pre><h1 id="bef1" class="na nb it bd nc nd ne nf ng nh ni nj nk jz nl ka nm kc nn kd no kf np kg nq nr bi translated">查询时间范围</h1><p id="932a" class="pw-post-body-paragraph ky kz it la b lb ns ju ld le nt jx lg lh nu lj lk ll nv ln lo lp nw lr ls lt im bi translated">另一个功能<code class="fe me mf mg mh b"><a class="ae md" href="https://next-game-solutions.github.io/tronr/reference/get_blocks_for_time_range.html" rel="noopener ugc nofollow" target="_blank">get_blocks_for_time_range()</a></code>，允许用户收集一段时间内生成的几个块的数据。与其他<code class="fe me mf mg mh b">tronr</code>函数类似，该时间段的开始和结束必须作为Unix时间戳提供(要将R的POSIXct datetime值转换成这样的时间戳，请使用<code class="fe me mf mg mh b"><a class="ae md" href="https://next-game-solutions.github.io/tronr/reference/to_unix_timestamp.html" rel="noopener ugc nofollow" target="_blank">to_unix_timestamp()</a></code>):</p><pre class="kj kk kl km gt nx mh ny nz aw oa bi"><span id="6bed" class="ob nb it mh b gy oc od l oe of">range &lt;- get_blocks_for_time_range(<br/>    min_timestamp = "1551715200000",<br/>    max_timestamp = "1551715210000"<br/>)</span><span id="47b1" class="ob nb it mh b gy og od l oe of">glimpse(range)</span><span id="58bc" class="ob nb it mh b gy og od l oe of">#&gt; Rows: 4<br/>#&gt; Columns: 13<br/>#&gt; $ block_number    &lt;chr&gt; "7203852", "7203851", "7203...<br/>#&gt; $ timestamp       &lt;dttm&gt; 2019-03-04 16:00:09, 2019-...<br/>#&gt; $ hash            &lt;chr&gt; "00000000006dec0cd76d5eee4b...<br/>#&gt; $ parent_hash     &lt;chr&gt; "00000000006dec0b36bce19a10...<br/>#&gt; $ tx_trie_root    &lt;chr&gt; "2Y3SaM5CxAEM1LAKw9F2sCHKU4...<br/>#&gt; $ confirmed       &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE<br/>#&gt; $ revert          &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE<br/>#&gt; $ size            &lt;int&gt; 22632, 20701, 21046, 19363<br/>#&gt; $ witness_address &lt;chr&gt; "TJ2aDMgeipmoZRuUEru2ri8t7T...<br/>#&gt; $ witness_name    &lt;chr&gt; "Huobi_pool", "BlockchainOr...<br/>#&gt; $ tx_count        &lt;int&gt; 83, 72, 75, 61<br/>#&gt; $ net_usage       &lt;int&gt; 36919, 24628, 34877, 22663<br/>#&gt; $ energy_usage    &lt;int&gt; 1996195, 1488224, 1307323, ...</span></pre><p id="ca97" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">结果是一个简单的(即非嵌套的)tibble，其内容与<code class="fe me mf mg mh b">get_block_info()</code>返回的内容有些不同。该表中特别令人感兴趣的是诸如<code class="fe me mf mg mh b">tx_count</code>(与一个块相关联的事务数量)、<code class="fe me mf mg mh b">net_usage</code>和<code class="fe me mf mg mh b">energy_usage</code>(事务成本的指示符)、<code class="fe me mf mg mh b">size</code>(块大小，以字节为单位)等列。(详见<a class="ae md" href="https://next-game-solutions.github.io/tronr/reference/get_blocks_for_time_range.html" rel="noopener ugc nofollow" target="_blank">在线文档</a>)。</p><h1 id="b000" class="na nb it bd nc nd ne nf ng nh ni nj nk jz nl ka nm kc nn kd no kf np kg nq nr bi translated">结论</h1><p id="1aed" class="pw-post-body-paragraph ky kz it la b lb ns ju ld le nt jx lg lh nu lj lk ll nv ln lo lp nw lr ls lt im bi translated">本文展示了使用R包<code class="fe me mf mg mh b">tronr</code>在TRON区块链上查询块是多么容易。我将非常感谢来自这个包的用户的任何反馈、错误报告和贡献——在项目的<a class="ae md" href="https://github.com/next-game-solutions/tronr" rel="noopener ugc nofollow" target="_blank"> Github库</a>找到进一步的细节。</p><p id="7a85" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另请参阅本系列教程的其他文章:</p><div class="mi mj gp gr mk ml"><a rel="noopener  ugc nofollow" target="_blank" href="/show-me-the-money-how-to-query-tron-account-balances-4d62ff54c67b"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd iu gy z fp mq fr fs mr fu fw is bi translated">给我钱看:如何查询TRON账户余额</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">就用R包tronr</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mu l"><div class="oh l mw mx my mu mz ks ml"/></div></div></a></div><div class="mi mj gp gr mk ml"><a rel="noopener  ugc nofollow" target="_blank" href="/an-easy-way-to-collect-market-data-for-tronix-trx-41e6e7c52555"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd iu gy z fp mq fr fs mr fu fw is bi translated">为Tronix (TRX)收集市场数据的简单方法</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">就用R包tronr</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mu l"><div class="oi l mw mx my mu mz ks ml"/></div></div></a></div></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h1 id="e40e" class="na nb it bd nc nd oq nf ng nh or nj nk jz os ka nm kc ot kd no kf ou kg nq nr bi translated">在你走之前</h1><p id="453c" class="pw-post-body-paragraph ky kz it la b lb ns ju ld le nt jx lg lh nu lj lk ll nv ln lo lp nw lr ls lt im bi translated">我提供数据科学咨询服务。<a class="ae md" href="mailto:sergey@nextgamesolutions.com" rel="noopener ugc nofollow" target="_blank">取得联系</a>！</p></div></div>    
</body>
</html>