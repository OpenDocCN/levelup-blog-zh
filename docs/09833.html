<html>
<head>
<title>Use Encoding Japanese to Convert Shift JIS characters to Unicode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用日语编码将JIS字符转换为Unicode</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/use-encoding-japanese-to-convert-shift-jis-characters-to-unicode-8945d31f4906?source=collection_archive---------7-----------------------#2021-09-20">https://levelup.gitconnected.com/use-encoding-japanese-to-convert-shift-jis-characters-to-unicode-8945d31f4906?source=collection_archive---------7-----------------------#2021-09-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="24cb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在React中创建CSV文件导入器:第三部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fa95a7a28df2549878f6d142b1ee3ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GxhH_WjBS4RLw2WY"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@stocktrader?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马尔科·祖彭</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="9697" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">逗号分隔值(CSV)文件是包含数据列表的文本文件。它通常用于在不同的应用程序之间交换数据。</p><p id="1547" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一系列文章中，我们将了解如何在React中创建CSV文件导入程序。这是一个由三部分组成的系列，我们将了解如何做到以下几点:</p><ol class=""><li id="dc9e" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/use-react-dropzone-to-create-a-drag-n-drop-zone-for-files-f9c32dc722fc">使用React Dropzone为文件创建一个拖放区</a></li><li id="9ef5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/use-papa-parse-to-parse-a-csv-file-in-a-react-application-da570e0c346a">使用Papa Parse解析React应用程序中的CSV文件</a></li><li id="e9fc" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">使用编码日语将Shift JIS字符转换为Unicode </strong></li></ol><p id="fe92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第三篇文章中，我们将看看编码日语库。这个库将允许我们检测和转换JavaScript中的字符编码。如果你正在处理日本字符，这将是有帮助的。本文假设您对React有基本的了解。这个例子将从一个<code class="fe mj mk ml mm b">create-react-app</code> starter应用程序中创建。</p><p id="b540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文结束时，您应该对如何执行以下操作有所了解:</p><ul class=""><li id="b33c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mn mb mc md bi translated">使用FileReader API</li><li id="fb32" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mn mb mc md bi translated">检测字符的编码类型</li><li id="012a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mn mb mc md bi translated">转换字符的编码类型</li><li id="71f5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mn mb mc md bi translated">使用文件API创建一个新的CSV文件</li></ul><h2 id="617e" class="mo mp it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated">首先，什么是日语编码？</h2><p id="1d9e" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">编码日语是一个库，帮助您转换JavaScript中的字符编码。它在NPM<a class="ae ky" href="https://www.npmjs.com/package/encoding-japanese" rel="noopener ugc nofollow" target="_blank">上的周下载量接近20万次。</a></p><p id="fa52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您不熟悉，<a class="ae ky" href="https://en.wikipedia.org/wiki/Character_encoding" rel="noopener ugc nofollow" target="_blank"> <em class="nm">“在计算、数据存储和数据传输中，</em> <strong class="lb iu"> <em class="nm">字符编码</em> </strong> <em class="nm">用于通过某种编码系统来表示一系列字符，该编码系统为每个字符分配一个数字表示。”</em> </a></p><p id="e520" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着你在电脑上看到的每个字符都有某种字符编码类型。标准编码是UTF-8，它使用Unicode作为字符集。但是，在使用日语时，您可能会遇到另一种字符编码类型，称为移位JIS。</p><p id="2e64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不会试图解释两者的区别；它变得相当专业，我自己对这个话题也没有最好的理解。对于本文，您只需要知道有各种类型的字符编码，有时您可能需要检测或转换它们。</p><p id="e9db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本系列的第一和第二部分中，我们已经创建了一个接受CSV文件的dropzone。然后解析这个CSV文件，数据以基本表格的形式呈现在屏幕上。但是，根据字符编码类型的不同，您可能会看到类似这样的内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/16facf3fb0fbdf5094e9e82330cf3d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*sfGI2iKAASiTbio7oyKrDg.gif"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/a9acdb1458f91629a2bcbdcd60ce6387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*OSwDQm03Uj2i0yT-AFd6PQ.png"/></div></figure></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="cb9c" class="nw mp it bd mq nx ny nz mt oa ob oc mw jz od ka mz kc oe kd nc kf of kg nf og bi translated">使用FileReader API</h1><p id="71e9" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">首先，我们将添加我们在第一部分中创建的<code class="fe mj mk ml mm b">onDrop</code>函数。当使用React Dropzone时，可以使用<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/FileReader/FileReader" rel="noopener ugc nofollow" target="_blank"> FileReader </a> API访问文件内容。</p><p id="d169" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将创建FileReader的一个新实例。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="ce23" class="mo mp it mm b gy ol om l on oo">const reader = new <em class="nm">FileReader</em>();</span></pre><p id="e678" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将调用<code class="fe mj mk ml mm b">readAsArrayBuffer</code>方法，将接受的文件作为参数传入。这将允许结果包含一个代表文件数据的<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" rel="noopener ugc nofollow" target="_blank"> ArrayBuffer </a>。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="99cf" class="mo mp it mm b gy ol om l on oo">const file = <em class="nm">acceptedFiles</em>[0];</span><span id="ed96" class="mo mp it mm b gy op om l on oo">reader.readAsArrayBuffer(file);</span></pre><p id="2893" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们可以访问FileReader的<code class="fe mj mk ml mm b">onload()</code>事件处理程序。每次成功完成读取操作时，都会触发此事件。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="ba50" class="mo mp it mm b gy ol om l on oo">reader.onload = () =&gt; {<br/>  <em class="nm">// do something</em><br/>};</span></pre><p id="68ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，每当我们将一个已接受的文件放入dropzone时，<code class="fe mj mk ml mm b">onload</code>函数中的任何内容都将在文件加载后运行。</p><h1 id="35a9" class="nw mp it bd mq nx oq nz mt oa or oc mw jz os ka mz kc ot kd nc kf ou kg nf og bi translated">检测字符的编码类型</h1><p id="6c1d" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">在<code class="fe mj mk ml mm b">onload</code>函数中，我们可以在FileReader的result属性上访问添加文件的结果。有了结果，我们将首先创建一个<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" rel="noopener ugc nofollow" target="_blank"> Uint8Array </a>对象。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="4e0e" class="mo mp it mm b gy ol om l on oo">const contents = new <em class="nm">Uint8Array</em>(reader.result);</span></pre><p id="d74e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将使用编码日语库来检测字符编码类型。我们将把<code class="fe mj mk ml mm b">contents</code>变量作为参数传递给<code class="fe mj mk ml mm b">detect</code>方法。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="9318" class="mo mp it mm b gy ol om l on oo">const encodingType = Encoding.detect(contents);</span></pre><h1 id="85fa" class="nw mp it bd mq nx oq nz mt oa or oc mw jz os ka mz kc ot kd nc kf ou kg nf og bi translated">转换字符的编码类型</h1><p id="ce25" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">接下来，我们可以使用编码日语中的<code class="fe mj mk ml mm b">convert</code>方法将字符编码从任何类型转换为Unicode。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="b0d3" class="mo mp it mm b gy ol om l on oo">const unicodeArray = Encoding.convert(contents, {<br/>  to: 'UNICODE',<br/>  from: encodingType,<br/>});</span></pre><p id="2018" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将把Unicode数组转换成一个字符串。我们可以使用日语编码中的<code class="fe mj mk ml mm b">codeToString</code>方法，并将<code class="fe mj mk ml mm b">unicodeArray</code>变量作为参数传递。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="6eff" class="mo mp it mm b gy ol om l on oo">const unicodeString = Encoding.codeToString(unicodeArray);</span></pre><h1 id="5c1f" class="nw mp it bd mq nx oq nz mt oa or oc mw jz os ka mz kc ot kd nc kf ou kg nf og bi translated">使用文件API创建一个新的CSV文件</h1><p id="00cd" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">最后，我们需要将它转换回CSV文件，这样我们就可以解析它。我们可以使用<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/File/File" rel="noopener ugc nofollow" target="_blank">文件</a> API创建一个新文件。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="6143" class="mo mp it mm b gy ol om l on oo">const newFile = new <em class="nm">File</em>([unicodeString], 'prefectures.txt', {<br/>  type: 'text/csv',<br/>});</span></pre><p id="5e2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将调用我们在第二部分中创建的<code class="fe mj mk ml mm b">parseFile</code>函数。这一次，我们将传递带有转换后的字符编码类型的<code class="fe mj mk ml mm b">newFile</code>。</p><pre class="kj kk kl km gt oh mm oi oj aw ok bi"><span id="6e9c" class="mo mp it mm b gy ol om l on oo">parseFile(newFile);</span></pre><p id="c2fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，无论您的文件使用哪种类型的字符编码，数据都将首先被转换为Unicode，然后被解析。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/545edbeddc53ba512a3eab90466b033e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*fsemSRSz6Aqm5if1BfxqiQ.gif"/></div></figure></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="e1d1" class="nw mp it bd mq nx ny nz mt oa ob oc mw jz od ka mz kc oe kd nc kf of kg nf og bi translated">结论</h1><p id="da38" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">感谢阅读！我希望这篇文章对您开始编码日语有所帮助。当我试图解决这个问题时，我找不到太多的内容。如果你知道另一个库或者处理字符编码的方法，请告诉我！</p><p id="70e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想看这个项目的完整源代码，请点击这里查看我的GitHub库<a class="ae ky" href="https://github.com/chadmuro/medium-csv-import/tree/part-three" rel="noopener ugc nofollow" target="_blank"/>。请务必查看名为<em class="nm">“第三部分”</em>的分支。</p><p id="d91e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您错过了该系列的第一部分或第二部分，请查看下面的内容。</p><div class="ov ow gp gr ox oy"><a rel="noopener  ugc nofollow" target="_blank" href="/use-react-dropzone-to-create-a-drag-n-drop-zone-for-files-f9c32dc722fc"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">使用React Dropzone为文件创建拖放区</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">如何在React中创建CSV文件导入程序:第一部分</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm ks oy"/></div></div></a></div><div class="ov ow gp gr ox oy"><a rel="noopener  ugc nofollow" target="_blank" href="/use-papa-parse-to-parse-a-csv-file-in-a-react-application-da570e0c346a"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">使用Papa Parse在React应用程序中解析CSV文件</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">如何在React中创建CSV文件导入器:第二部分</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ph l"><div class="pn l pj pk pl ph pm ks oy"/></div></div></a></div></div></div>    
</body>
</html>