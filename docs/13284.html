<html>
<head>
<title>Couchbase with Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Java的Couchbase</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/couchbase-with-java-ff87bf995a26?source=collection_archive---------10-----------------------#2022-08-23">https://levelup.gitconnected.com/couchbase-with-java-ff87bf995a26?source=collection_archive---------10-----------------------#2022-08-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/83aecca219a012c694134c8a3271c1bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*FFqut7ftv4nNlOYFL2j_KA.png"/></div></figure><p id="3d64" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我今天要讨论一下Couchbase。首先，我想提供一些关于Couchbase的简短信息，例如:这是什么？它是用来做什么的？为什么它更喜欢？。然后，我想添加一段代码，如何使用Java和Springboot的Couchbase。</p><h2 id="ea5b" class="ks kt iq bd ku kv kw dn kx ky kz dp la kf lb lc ld kj le lf lg kn lh li lj lk bi translated">什么是Couchbase？</h2><p id="6aba" class="pw-post-body-paragraph ju jv iq jw b jx ll jz ka kb lm kd ke kf ln kh ki kj lo kl km kn lp kp kq kr ij bi translated">Couchbase是一个通用数据库，适合大型企业，可用于各种用例。Couchbase Server是一个面向NoSQL文档的现代云原生分布式数据库，它结合了关系数据库和NoSQL。您将获得SQL和ACID事务的强大功能以及JSON的无限可伸缩性和灵活性。</p><h2 id="faad" class="ks kt iq bd ku kv kw dn kx ky kz dp la kf lb lc ld kj le lf lg kn lh li lj lk bi translated">它是用来做什么的？</h2><p id="ae6d" class="pw-post-body-paragraph ju jv iq jw b jx ll jz ka kb lm kd ke kf ln kh ki kj lo kl km kn lp kp kq kr ij bi translated">Couchbase广泛用于</p><ul class=""><li id="1ba5" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated">网</li><li id="6c71" class="lq lr iq jw b jx lz kb ma kf mb kj mc kn md kr lv lw lx ly bi translated">移动的</li><li id="332d" class="lq lr iq jw b jx lz kb ma kf mb kj mc kn md kr lv lw lx ly bi translated">物联网应用</li></ul><h2 id="6ab9" class="ks kt iq bd ku kv kw dn kx ky kz dp la kf lb lc ld kj le lf lg kn lh li lj lk bi translated">我们为什么要用它？</h2><ul class=""><li id="373a" class="lq lr iq jw b jx ll kb lm kf me kj mf kn mg kr lv lw lx ly bi translated"><strong class="jw ir">快</strong></li></ul><p id="8c89" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于大型企业应用程序来说，它的速度非常快，并且返回数据的延迟时间很短。</p><ul class=""><li id="bd35" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir">灵活</strong></li></ul><p id="51ea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是一个基于NoSQL或文档的数据库，这里没有严格的模式。JSON模式的灵活性欢迎任何业务变化的需求。</p><ul class=""><li id="7135" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir"> N1QL(SQL++):像SQL查询一样熟悉的查询</strong></li></ul><p id="9d07" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">N1QL为开发人员和企业提供了一种富有表现力的、强大的、完整的语言，用于查询、转换和操作JSON数据。</p><p id="cfd6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以像查询遗留RDBMS应用程序一样查询JSON文档数据模型。</p><ul class=""><li id="b7e3" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir">全文搜索</strong></li></ul><p id="b89f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以搜索全文，这是指在存储的大量文本数据中搜索一些文本，并返回包含部分或全部查询单词的结果。相比之下，传统搜索将返回精确匹配。或者您可以使用“LIKE”操作进行类似的搜索。但是这个操作相当慢。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/9d82f4f6bbb237853e7fe8f6c362caee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/0*H0n891tEn7kXRBm9"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">全文搜索示例:图片作者<a class="ae mu" href="https://www.mongodb.com/basics/full-text-search" rel="noopener ugc nofollow" target="_blank">https://www.mongodb.com/basics/full-text-search</a></figcaption></figure><p id="189d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在给出一些信息后，我想展示一下我们如何在Java和Springboot中使用它。</p><h2 id="bc20" class="ks kt iq bd ku kv kw dn kx ky kz dp la kf lb lc ld kj le lf lg kn lh li lj lk bi translated">实施部分</h2><ul class=""><li id="5c90" class="lq lr iq jw b jx ll kb lm kf me kj mf kn mg kr lv lw lx ly bi translated"><strong class="jw ir">安装Couchbase服务器</strong></li></ul><p id="1d73" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，我运行以下脚本，在我的Docker上安装和运行Couchbase服务器。</p><pre class="mi mj mk ml gt mv mw mx my aw mz bi"><span id="1afd" class="ks kt iq mw b gy na nb l nc nd">docker run -d - name db -p 8091–8096:8091–8096 -p 11210–11211:11210–11211 couchbase</span></pre><p id="ca20" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后当我在浏览器上打开以下地址时；</p><pre class="mi mj mk ml gt mv mw mx my aw mz bi"><span id="bffa" class="ks kt iq mw b gy na nb l nc nd">http://localhost:8091/ui/index.html</span></pre><p id="b350" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果安装成功，那么用户界面如下所示；</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ne"><img src="../Images/179d6f462ba3ef5befb580bf976e259c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rf56j3Gc_SveOM0Vq9uBBQ.png"/></div></div></figure><p id="8393" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我以前没有创建过任何集群，所以我需要用以下信息创建一个新的集群。如果您没有任何集群，您也应该创建它。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nf"><img src="../Images/915b98eae9f3302341b2d92c8f2066b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HB0mOJO8w5xv2wu0t2IQLA.png"/></div></div></figure><p id="525b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我用默认设置配置了集群。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ng"><img src="../Images/96a43e2f187a77ebd5241fb251b9b2b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7wH6Y_ry_ylOCZdPrpjGlg.png"/></div></div></figure><p id="796d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我也没有任何存储桶，所以我通过“存储桶”选项卡下的“添加存储桶”创建了一个新存储桶。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nh"><img src="../Images/c468b361070ed31813b6f64627d2f7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yEyeLIgWua-EaFVQs0L3Dw.png"/></div></div></figure><p id="2766" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我刚给那个桶取了个名字。我把它命名为“书”。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ng"><img src="../Images/85771a9280f6319aebf27d8940730cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rhvSTrDuoSoq7PrrK7o6oA.png"/></div></div></figure><p id="5b0d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">编码部分</strong></p><ul class=""><li id="aa17" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir">依赖关系</strong></li></ul><p id="24fe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我用的是<em class="ni">spring-boot-starter-data-couch base</em><strong class="jw ir"/>和<em class="ni"> spring-boot-starter-web </em>(这是为了创建RESTful API) <strong class="jw ir"> </strong> 2.7.1版本和<em class="ni"> Java </em> 11版本。</p><p id="a989" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，和往常一样，我使用<em class="ni"> Lombok </em>进行更好的代码设计。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><ul class=""><li id="c440" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir">配置床座</strong></li></ul><p id="7a01" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从AbstractCouchbaseConfiguration扩展。正确配置你的沙发底座。我对它的配置非常简单，如下所示。用户和密码信息应该与您的存储桶凭据相同。除非它不会连接到您的服务器。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><ul class=""><li id="dee5" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir">实体模型</strong></li></ul><p id="4928" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我创建了一个图书模型。我添加了一些字段，如id、标题、作者和标签。以下是我使用的一些<em class="ni">注释</em>的一些信息；</p><p id="3397" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="ni"> @Document </em> : </strong>这个指定了我们的实体应该进入哪个索引。</p><p id="2918" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="ni"> @Id </em> : </strong>使该字段成为您的文档的<code class="fe nl nm nn mw b">id</code>。这是该索引中的唯一标识符。</p><p id="066a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="ni"> @Field </em> : </strong>配置字段的类型。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><ul class=""><li id="c48c" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir">服务等级</strong></li></ul><p id="d71c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我用<strong class="jw ir"> <em class="ni"> findById() </em> </strong>，<strong class="jw ir"> <em class="ni"> save() </em> </strong>和<strong class="jw ir"> deleteById() </strong>方法创建了一个服务类。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><ul class=""><li id="0510" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated"><strong class="jw ir">控制器类别</strong></li></ul><p id="77d1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，我用<strong class="jw ir"> <em class="ni"> findById() </em> </strong>，<strong class="jw ir"> <em class="ni"> save() </em> </strong>和<strong class="jw ir"> deleteById() </strong>端点创建了一个控制器类，以使用服务类的方法。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="dfc1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">完成我的API后，我构建并运行它。然后我使用<strong class="jw ir"> Postman </strong>调用端点。</p><p id="3ef7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了保存数据，我多次调用端点。</p><pre class="mi mj mk ml gt mv mw mx my aw mz bi"><span id="f4cc" class="ks kt iq mw b gy na nb l nc nd">POST http://localhost:8080/books</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi no"><img src="../Images/0bff6021f4a616ea827adf349e84cfa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Gg1PjuIh8_hPHy9XFjcog.png"/></div></div></figure><p id="1f16" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后我用GET by Id查数据。</p><pre class="mi mj mk ml gt mv mw mx my aw mz bi"><span id="b174" class="ks kt iq mw b gy na nb l nc nd">GET http://localhost:8080/books/1231415-f785b-4c794--2134bffcd3</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi np"><img src="../Images/9182376398d6bae73499ca525cbbe661.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8_PDM4ljhniwaC3sBbjaA.png"/></div></div></figure><p id="0437" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者您也可以在Couchbase Server上的Documents选项卡下检查记录。例如，我创建了两个记录，当我检查它们时，我看到如下内容:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nq"><img src="../Images/c3a7bafc6e788f58a7eb8a8f9435b08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGF4KmrPg6-pCQw1gDPZbA.png"/></div></div></figure><p id="01db" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你可以在我的<a class="ae mu" href="https://github.com/atesibrahim/couchbase" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到全部代码。</p><p id="1e26" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">希望有帮助。</p><p id="a897" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">感谢阅读…</p><p id="a1c0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="ni">参考文献:</em> </strong></p><div class="nr ns gp gr nt nu"><a href="https://docs.couchbase.com/server/current/install/getting-started-docker.html" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">使用Docker安装Couchbase服务器</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Couchbase服务器可以使用Docker Hub的官方Couchbase映像来安装。如果您正在尝试Couchbase服务器…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">docs.couchbase.com</p></div></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://docs.spring.io/spring-data/couchbase/docs/current/reference/html/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">Spring数据库参考文档</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">class Product {(1)monetary amount getPrice(){...} } @ RequiredArgsConstructor(static name = " of ")类产品…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">docs.spring.io</p></div></div></div></a></div></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><h1 id="1796" class="ok kt iq bd ku ol om on kx oo op oq la or os ot ld ou ov ow lg ox oy oz lj pa bi translated">分级编码</h1><p id="8a8c" class="pw-post-body-paragraph ju jv iq jw b jx ll jz ka kb lm kd ke kf ln kh ki kj lo kl km kn lp kp kq kr ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="228c" class="lq lr iq jw b jx jy kb kc kf ls kj lt kn lu kr lv lw lx ly bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="41c7" class="lq lr iq jw b jx lz kb ma kf mb kj mc kn md kr lv lw lx ly bi translated">📰查看<a class="ae mu" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>中的更多内容</li><li id="3284" class="lq lr iq jw b jx lz kb ma kf mb kj mc kn md kr lv lw lx ly bi translated">🔔关注我们:<a class="ae mu" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae mu" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae mu" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="934e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">🚀👉<a class="ae mu" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">加入升级人才集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>