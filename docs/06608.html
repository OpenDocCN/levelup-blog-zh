<html>
<head>
<title>Python Pandas Quick Reference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python熊猫快速参考</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/python-pandas-quick-reference-574a874f21bd?source=collection_archive---------2-----------------------#2020-12-11">https://levelup.gitconnected.com/python-pandas-quick-reference-574a874f21bd?source=collection_archive---------2-----------------------#2020-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d78" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有用的Python熊猫功能的介绍性指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/85f0f8efd506b4c1f83787fc758c64d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gB36jMhbJZ16NVlDaM9wgA.png"/></div></div></figure><p id="b19f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我最近一直在使用Python Pandas库，这是一个如此巨大和令人印象深刻的库。我想记录我到目前为止学到和发现的东西，以供将来参考，我认为这对其他人也有帮助，特别是在数据科学领域。我假设你已经熟悉Python和熊猫了。</p><p id="9650" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我想介绍Pandas中的两种主要数据类型。一个“系列”和一个“数据框架”。“系列”相当于Python列表。这是一组一维数据。“数据框架”可以与Python字典相提并论。一个“数据帧”由两个或多个“系列”(列)组成。</p><h2 id="910f" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">首字母缩写熊猫</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="19db" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">import pandas as pd</strong></span></pre><h2 id="380e" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">创建系列</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="ad7a" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_series = pd.Series([0,1,2,3,4,5,6,7,8,9])<br/>print (type(my_series))<br/>print (my_series)</strong></span><span id="a222" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.series.Series'&gt;<br/>0    0<br/>1    1<br/>2    2<br/>3    3<br/>4    4<br/>5    5<br/>6    6<br/>7    7<br/>8    8<br/>9    9<br/>dtype: int64</span><span id="ea49" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_series = pd.Series(range(0,10))<br/>print (type(my_series))<br/>print (my_series)</strong></span><span id="fce1" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.series.Series'&gt;<br/>0    0<br/>1    1<br/>2    2<br/>3    3<br/>4    4<br/>5    5<br/>6    6<br/>7    7<br/>8    8<br/>9    9<br/>dtype: int64</span><span id="8242" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_series = pd.Series(['a','b','c','d','e','f','g','h','i','j'])<br/>print (type(my_series))<br/>print (my_series)</strong></span><span id="8efe" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.series.Series'&gt;<br/>0    a<br/>1    b<br/>2    c<br/>3    d<br/>4    e<br/>5    f<br/>6    g<br/>7    h<br/>8    i<br/>9    j<br/>dtype: object</span><span id="bf23" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_index = list('abcde')<br/>my_series = pd.Series([1,2,3,4,5], index=my_index)<br/>print (type(my_series))<br/>print (my_series)</strong></span><span id="80f7" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.series.Series'&gt;<br/>a    1<br/>b    2<br/>c    3<br/>d    4<br/>e    5<br/>dtype: int64</span><span id="7e17" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dict = { <br/>    'K1': 'V1',<br/>    'K2': 'V2',<br/>    'K3': 'V3',<br/>    'K4': 'V4',<br/>    'K5': 'V5',<br/>}</strong></span><span id="87a2" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_series = pd.Series(my_dict)<br/>print (type(my_series))<br/>print (my_series)</strong></span><span id="0fcb" class="lq lr it mk b gy ms mp l mq mr">class 'pandas.core.series.Series'&gt;<br/>K1    V1<br/>K2    V2<br/>K3    V3<br/>K4    V4<br/>K5    V5<br/>dtype: object</span><span id="95d5" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([['a','b','c'],['d','e','f'],['g','h','i']], columns = ['col1','col2','col3'])<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="3af4" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_series = my_dataframe['col2']<br/>print (type(my_series))<br/>print (my_series)</strong></span><span id="5465" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>  col1 col2 col3<br/>0    a    b    c<br/>1    d    e    f<br/>2    g    h    i</span><span id="ce97" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.series.Series'&gt;<br/>0    b<br/>1    e<br/>2    h<br/>Name: col2, dtype: object</span></pre><h2 id="11bc" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">创建数据框架</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="b555" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([['a','b','c'],['d','e','f'],['g','h','i']])<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="d49e" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>   0  1  2<br/>0  a  b  c<br/>1  d  e  f<br/>2  g  h  i</span><span id="a1b9" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([['a','b','c'],['d','e','f'],['g','h','i']], columns = ['col1','col2','col3'])<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="cd5e" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>  col1 col2 col3<br/>0    a    b    c<br/>1    d    e    f<br/>2    g    h    i</span><span id="e203" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([['a','b','c'],['d','e','f'],['g','h','i']], columns = ['col1','col2','col3'], index = ['row1', 'row2', 'row3'])<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="607d" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>     col1 col2 col3<br/>row1    a    b    c<br/>row2    d    e    f<br/>row3    g    h    i</span><span id="1c2a" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([['a','b','c'],['d','e','f'],['g','h','i']])<br/>my_dataframe.columns = ['col1','col2','col3']<br/>my_dataframe.index = ['row1', 'row2', 'row3']<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="a2ff" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>     col1 col2 col3<br/>row1    a    b    c<br/>row2    d    e    f<br/>row3    g    h    i</span><span id="0bc1" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame({<br/>    'numbers': [ 'one', 'two', 'three', 'four', 'five' ],<br/>    'letters': [ 'a', 'b', 'c', 'd', 'e' ]<br/>})<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="bf57" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>  numbers letters<br/>0     one       a<br/>1     two       b<br/>2   three       c<br/>3    four       d<br/>4    five       e</span><span id="e134" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">import numpy as np<br/>nparray = np.array([1, 2, 3, 4, 5])<br/>my_dataframe = pd.Series(nparray)<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="4861" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.series.Series'&gt;<br/>0    1<br/>1    2<br/>2    3<br/>3    4<br/>4    5<br/>dtype: int64</span><span id="d7f6" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.read_csv('./pandas.csv')</strong><br/><strong class="mk iu"># optionally: df = pd.read_csv('./pandas.csv', encoding='utf-8')</strong></span><span id="c764" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># pathlib adds support for Windows, OSX and Linux<br/>from pathlib import Path<br/>file_path = Path('C:/Example') / 'pandas.csv'<br/>df = pd.read_csv(file_path)</strong></span></pre><p id="4e4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意DataFrame列实际上是一个系列。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="4741" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([['a','b','c'],['d','e','f'],['g','h','i']], columns = ['col1','col2','col3'])<br/>print (type(my_dataframe['col1']))<br/>print (my_dataframe['col1'])</strong></span><span id="3506" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.series.Series'&gt;<br/>0    a<br/>1    d<br/>2    g<br/>Name: col1, dtype: object</span></pre><h2 id="5883" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">编辑数据帧</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="e8c4" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame({<br/>    'name': [ 'Mike', 'Eva', 'George' ]<br/>})</strong></span><span id="12e9" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)</strong></span><span id="acc5" class="lq lr it mk b gy ms mp l mq mr">name<br/>0    Mike<br/>1     Eva<br/>2  George</span><span id="e6fd" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># add new column 'age'<br/>my_dataframe['age'] = [ 41, 34, 3 ]</strong></span><span id="6be5" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)</strong></span><span id="3e9a" class="lq lr it mk b gy ms mp l mq mr">    name   age<br/>0    Mike   41<br/>1     Eva   34<br/>2  George    3</span><span id="1bd5" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># drops column 'age'<br/>my_dataframe = my_dataframe.drop(columns=['age'])</strong></span><span id="e87f" class="lq lr it mk b gy ms mp l mq mr">name<br/>0    Mike<br/>1     Eva<br/>2  George</span><span id="ba24" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">columns = list('abcdef')<br/>data = [[False for j in columns] for i in range(0, 10)]<br/>my_dataframe = pd.DataFrame(data, columns=columns)<br/>print (my_dataframe)</strong></span><span id="c410" class="lq lr it mk b gy ms mp l mq mr">       a      b      c      d      e      f<br/>0  False  False  False  False  False  False<br/>1  False  False  False  False  False  False<br/>2  False  False  False  False  False  False<br/>3  False  False  False  False  False  False<br/>4  False  False  False  False  False  False<br/>5  False  False  False  False  False  False<br/>6  False  False  False  False  False  False<br/>7  False  False  False  False  False  False<br/>8  False  False  False  False  False  False<br/>9  False  False  False  False  False  False</span><span id="f29b" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">columns = list('abcdef')<br/>data = [[False for j in columns] for i in range(0, 10)]<br/>my_dataframe = pd.DataFrame(data, columns=columns)<br/>my_dataframe.loc[0, 'a'] = True<br/>print (my_dataframe)</strong></span><span id="1a51" class="lq lr it mk b gy ms mp l mq mr">       a      b      c      d      e      f<br/>0   True  False  False  False  False  False<br/>1  False  False  False  False  False  False<br/>2  False  False  False  False  False  False<br/>3  False  False  False  False  False  False<br/>4  False  False  False  False  False  False<br/>5  False  False  False  False  False  False<br/>6  False  False  False  False  False  False<br/>7  False  False  False  False  False  False<br/>8  False  False  False  False  False  False<br/>9  False  False  False  False  False  False</span><span id="759f" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">columns = list('abcdef')<br/>data = [[False for j in columns] for i in range(0, 10)]<br/>my_dataframe = pd.DataFrame(data, columns=columns)<br/>my_dataframe.loc[3] = True</strong></span><span id="22d2" class="lq lr it mk b gy ms mp l mq mr">       a      b      c      d      e      f<br/>0  False  False  False  False  False  False<br/>1  False  False  False  False  False  False<br/>2  False  False  False  False  False  False<br/>3   True   True   True   True   True   True<br/>4  False  False  False  False  False  False<br/>5  False  False  False  False  False  False<br/>6  False  False  False  False  False  False<br/>7  False  False  False  False  False  False<br/>8  False  False  False  False  False  False<br/>9  False  False  False  False  False  False</span><span id="aabb" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">columns = list('abcdef')<br/>data = [[False for j in columns] for i in range(0, 10)]<br/>my_dataframe = pd.DataFrame(data, columns=columns)<br/>my_dataframe.loc[7, ['a', 'c', 'f']] = True<br/>print (my_dataframe)</strong></span><span id="e902" class="lq lr it mk b gy ms mp l mq mr">       a      b      c      d      e      f<br/>0  False  False  False  False  False  False<br/>1  False  False  False  False  False  False<br/>2  False  False  False  False  False  False<br/>3  False  False  False  False  False  False<br/>4  False  False  False  False  False  False<br/>5  False  False  False  False  False  False<br/>6  False  False  False  False  False  False<br/>7   True  False   True  False  False   True<br/>8  False  False  False  False  False  False<br/>9  False  False  False  False  False  False</span><span id="82bd" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">columns = list('abcdef')<br/>data = [[False for j in columns] for i in range(0, 10)]<br/>my_dataframe = pd.DataFrame(data, columns=columns)<br/>my_dataframe.loc[9] = [True, False, True, False, True, False]<br/>print (my_dataframe)</strong></span><span id="501a" class="lq lr it mk b gy ms mp l mq mr">       a      b      c      d      e      f<br/>0  False  False  False  False  False  False<br/>1  False  False  False  False  False  False<br/>2  False  False  False  False  False  False<br/>3  False  False  False  False  False  False<br/>4  False  False  False  False  False  False<br/>5  False  False  False  False  False  False<br/>6  False  False  False  False  False  False<br/>7  False  False  False  False  False  False<br/>8  False  False  False  False  False  False<br/>9   True  False   True  False   True  False</span><span id="d516" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">columns = list('abcdef')<br/>data = [[False for j in columns] for i in range(0, 10)]<br/>my_dataframe = pd.DataFrame(data, columns=columns)<br/>my_dataframe.loc[3:4, 'd':'f'] = [['a','a','a'], ['b','b','b']]<br/>print (my_dataframe)</strong></span><span id="6441" class="lq lr it mk b gy ms mp l mq mr">       a      b      c      d      e      f<br/>0  False  False  False  False  False  False<br/>1  False  False  False  False  False  False<br/>2  False  False  False  False  False  False<br/>3  False  False  False      a      a      a<br/>4  False  False  False      b      b      b<br/>5  False  False  False  False  False  False<br/>6  False  False  False  False  False  False<br/>7  False  False  False  False  False  False<br/>8  False  False  False  False  False  False<br/>9  False  False  False  False  False  False</span><span id="8de8" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># following on from above<br/>print (my_dataframe[my_dataframe.d.isin(['a','b'])])</strong></span><span id="29e5" class="lq lr it mk b gy ms mp l mq mr">       a      b      c  d  e  f<br/>3  False  False  False  a  a  a<br/>4  False  False  False  b  b  b</span><span id="e873" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = my_dataframe[my_dataframe.d.isin(['a','b'])]<br/>print('Number of rows: {}, number of columns: {}'.format(my_dataframe.shape[0],my_dataframe.shape[1]))</strong></span><span id="d64e" class="lq lr it mk b gy ms mp l mq mr">Number of rows: 2, number of columns: 6</span></pre><h2 id="3933" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">处理南的</h2><p id="3b44" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">使用数据帧的最大问题之一是NaN值。我认为有两种主要的方法来处理这个问题。从数据集中排除它们或用默认值填充它们。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="b826" class="lq lr it mk b gy mo mp l mq mr"># remove NaN values<br/># <a class="ae my" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html" rel="noopener ugc nofollow" target="_blank">refer to official docs for options</a><br/>my_dataframe['col1'] = mydataframe['col1'].dropna()</span><span id="dc3f" class="lq lr it mk b gy ms mp l mq mr"># default NaN values to 0<br/>my_dataframe['col1'] = mydataframe['col1'].fillna(0)</span></pre><h2 id="fcc6" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">处理不正确的数据类型(列数据类型)</h2><p id="adde" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">您可能遇到的另一个问题是DataFrame列类型被错误地标识。我在做的一个项目中遇到了这个问题。我有一个数据列被检测为字符串，但我不得不将其重新转换为“日期时间”。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="7880" class="lq lr it mk b gy mo mp l mq mr">my_dataframe['datetime'] = pd.to_datetime(my_dataframe['datetime'])</span></pre><h2 id="a820" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">转换数据帧</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="6d4e" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame({<br/>    'names': [ 'Mike', 'Eva', 'George' ],<br/>    'gender': [ 'Male', 'Female', 'Male' ]<br/>})</strong></span><span id="2273" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)</strong></span><span id="cc63" class="lq lr it mk b gy ms mp l mq mr">     names   gender<br/>0    Mike    Male<br/>1     Eva  Female<br/>2  George    Male</span><span id="24d1" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe['gender_letter'] = my_dataframe.gender.map(lambda g: 'f' if g == 'Female' else 'm')</strong></span><span id="8938" class="lq lr it mk b gy ms mp l mq mr">names        gender    gender_letter<br/>0    Mike    Male      m<br/>1     Eva  Female      f<br/>2  George    Male      m</span></pre><h2 id="ebf6" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">连接数据帧</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="837b" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe1 = pd.DataFrame([<br/>    [1,1,1],<br/>    [2,2,2],<br/>    [3,3,3]<br/>])</strong></span><span id="c447" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe1)</strong></span><span id="a324" class="lq lr it mk b gy ms mp l mq mr">0  1  2<br/>0  1  1  1<br/>1  2  2  2<br/>2  3  3  3</span><span id="f6ea" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe2 = pd.DataFrame([<br/>    [4,4,4],<br/>    [5,5,5],<br/>    [6,6,6]<br/>])</strong></span><span id="4c81" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe2)</strong></span><span id="fcfb" class="lq lr it mk b gy ms mp l mq mr">0  1  2<br/>0  4  4  4<br/>1  5  5  5<br/>2  6  6  6</span><span id="73ea" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.concat([my_dataframe1, my_dataframe2]).reset_index(drop = True)</strong></span><span id="b764" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)</strong></span><span id="f279" class="lq lr it mk b gy ms mp l mq mr">   0  1  2<br/>0  1  1  1<br/>1  2  2  2<br/>2  3  3  3<br/>3  4  4  4<br/>4  5  5  5<br/>5  6  6  6</span></pre><h2 id="068a" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">连接数据框架</h2><p id="7141" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">这与SQL内部、外部、左侧和右侧连接非常相似。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="bbfb" class="lq lr it mk b gy mo mp l mq mr">pd.merge(left_df, right_df, on = "ID_COLUMN", how = "inner")<br/>pd.merge(left_df, right_df, on = "ID_COLUMN", how = "outer")<br/>pd.merge(left_df, right_df, on = "ID_COLUMN", how = "left")<br/>pd.merge(left_df, right_df, on = "ID_COLUMN", how = "right")</span></pre><h2 id="d3a6" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">检查数据帧</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="811a" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">print (my_dataframe.info())</strong></span><span id="1c2f" class="lq lr it mk b gy ms mp l mq mr">class 'pandas.core.frame.DataFrame'&gt;<br/>Index: 4 entries, R1 to R4<br/>Data columns (total 4 columns):<br/> #   Column  Non-Null Count  Dtype <br/>---  ------  --------------  ----- <br/> 0   C1      4 non-null      object<br/> 1   C2      4 non-null      object<br/> 2   C3      4 non-null      object<br/> 3   C4      4 non-null      object<br/>dtypes: object(4)<br/>memory usage: 160.0+ bytes<br/>None</span><span id="623c" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.head(2))</strong></span><span id="08c2" class="lq lr it mk b gy ms mp l mq mr">    C1 C2 C3 C4<br/>R1  a  b  c  d<br/>R2  e  f  g  h</span><span id="2211" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.tail(2))</strong></span><span id="08a9" class="lq lr it mk b gy ms mp l mq mr">    C1 C2 C3 C4<br/>R3  i  j  k  l<br/>R4  m  n  o  p</span><span id="ccf2" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># 3 rows, 4 columns<br/>print (my_dataframe.shape)</strong></span><span id="0a7a" class="lq lr it mk b gy ms mp l mq mr">(3, 4)</span><span id="9f29" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.describe())</strong></span><span id="ab76" class="lq lr it mk b gy ms mp l mq mr">C1 C2 C3 C4<br/>count   3  3  3  3<br/>unique  3  3  3  3<br/>top     a  j  g  h<br/>freq    1  1  1  1</span></pre><h2 id="8336" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">切片系列</h2><p id="0d4a" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">这与使用Python列表非常相似。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="1b9c" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_series = pd.Series(['a','b','c','d','e','f','g','h','i','j'])</strong></span><span id="1ae4" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># all rows<br/>print (my_series[:])</strong></span><span id="a317" class="lq lr it mk b gy ms mp l mq mr">0    a<br/>1    b<br/>2    c<br/>3    d<br/>4    e<br/>5    f<br/>6    g<br/>7    h<br/>8    i<br/>9    j<br/>dtype: object</span><span id="a176" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># first row<br/>print (my_series[0])</strong></span><span id="0206" class="lq lr it mk b gy ms mp l mq mr">a</span><span id="3758" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># first four rows<br/>print (my_series[0:4])</strong></span><span id="9ea0" class="lq lr it mk b gy ms mp l mq mr">0    a<br/>1    b<br/>2    c<br/>3    d<br/>dtype: object</span><span id="7bf2" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># last row<br/>print (my_series[-1:])</strong></span><span id="a8f3" class="lq lr it mk b gy ms mp l mq mr">9    j<br/>dtype: object</span><span id="b6fc" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># last 4 rows<br/>print (my_series[-4:])</strong></span><span id="953a" class="lq lr it mk b gy ms mp l mq mr">6    g<br/>7    h<br/>8    i<br/>9    j<br/>dtype: object</span><span id="6c06" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># middle four rows<br/>print (my_series[3:7])</strong></span><span id="f838" class="lq lr it mk b gy ms mp l mq mr">3    d<br/>4    e<br/>5    f<br/>6    g<br/>dtype: object</span></pre><h2 id="e7d4" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">分割数据帧</h2><p id="1658" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">您拥有与系列相同的功能来对行进行切片，但是现在您还拥有列维度。这就是你要用<strong class="kw iu">的地方。锁定</strong>和<strong class="kw iu">。iloc </strong>“大部分是。</p><p id="c525" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我创建了这个数据框架，我将把它作为一个例子。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="b8d7" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([['a','b','c','d'],['e','f','g','h'],['i','j','k','l'],['m','n','o','p']], columns = ['A','B','C','D'])<br/>print (type(my_dataframe))<br/>print (my_dataframe)</strong></span><span id="df08" class="lq lr it mk b gy ms mp l mq mr">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>   A  B  C  D<br/>0  a  b  c  d<br/>1  e  f  g  h<br/>2  i  j  k  l<br/>3  m  n  o  p</span></pre><p id="c528" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">选择行和列…</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="3893" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu"># columns C2 and C3</strong><br/><strong class="mk iu">print (my_dataframe[['C2','C3']])</strong></span><span id="888f" class="lq lr it mk b gy ms mp l mq mr">    C2 C3<br/>R1  b  c<br/>R2  f  g<br/>R3  j  k<br/>R4  n  o</span><span id="2c38" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># rows R2 and R3<br/>print (my_dataframe[1:3])</strong></span><span id="18b6" class="lq lr it mk b gy ms mp l mq mr">    C1 C2 C3 C4<br/>R2  e  f  g  h<br/>R3  i  j  k  l</span><span id="9957" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># all rows, columns C2 and C3<br/>print (my_dataframe.loc[:,'C2':'C3'])</strong></span><span id="7a52" class="lq lr it mk b gy ms mp l mq mr">    C2 C3<br/>R1  b  c<br/>R2  f  g<br/>R3  j  k<br/>R4  n  o</span><span id="3666" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># rows R3 and R4, columns C2 and C3<br/>print (my_dataframe.loc['R3':'R4','C2':'C3'])</strong></span><span id="5814" class="lq lr it mk b gy ms mp l mq mr">    C2 C3<br/>R3  j  k<br/>R4  n  o</span><span id="7342" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># all rows, column 2<br/>print (my_dataframe.iloc[:,1])</strong></span><span id="5fd5" class="lq lr it mk b gy ms mp l mq mr">R1    b<br/>R2    f<br/>R3    j<br/>R4    n<br/>Name: C2, dtype: object</span><span id="3b96" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># rows 2 and 3, columns 2 and 4<br/>print (my_dataframe.iloc[1:3,2:4])</strong></span><span id="bd90" class="lq lr it mk b gy ms mp l mq mr">    C3 C4<br/>R2  g  h<br/>R3  k  l</span><span id="518a" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu"># Dynamic selecting of columns by name<br/>year_data = my_dataframe[[col for col in my_dataframe.columns if col.startswith('Year')]]</strong></span></pre><h2 id="ec03" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">过滤系列</h2><p id="64e7" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">您可以通过创建布尔序列并将其传递给序列来添加筛选器。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="4c8c" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_series = pd.Series(range(1,10))<br/>print(my_series)</strong></span><span id="bc25" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">is_over_5 = my_series &gt; 5<br/>print (is_over_5)</strong></span><span id="ed44" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_series[is_over_5])</strong></span><span id="ea76" class="lq lr it mk b gy ms mp l mq mr">1<br/>1    2<br/>2    3<br/>3    4<br/>4    5<br/>5    6<br/>6    7<br/>7    8<br/>8    9<br/>dtype: int64</span><span id="24f5" class="lq lr it mk b gy ms mp l mq mr">0    False<br/>1    False<br/>2    False<br/>3    False<br/>4    False<br/>5     True<br/>6     True<br/>7     True<br/>8     True<br/>dtype: bool</span><span id="88c3" class="lq lr it mk b gy ms mp l mq mr">5    6<br/>6    7<br/>7    8<br/>8    9<br/>dtype: int64</span></pre><h2 id="a657" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">过滤数据帧</h2><p id="10a6" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">您可以通过创建布尔序列并将其传递给数据帧来添加过滤器。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="a9fd" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame([<br/>    [1,1,1,1,1],<br/>    [2,2,2,2,2],<br/>    [3,3,3,3,3],<br/>    [4,4,4,4,4],<br/>    [5,5,5,5,5]<br/>])</strong></span><span id="3fd9" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)</strong></span><span id="ed6d" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.loc[my_dataframe[1] &gt; 2])</strong></span><span id="8616" class="lq lr it mk b gy ms mp l mq mr">   0  1  2  3  4<br/>0  1  1  1  1  1<br/>1  2  2  2  2  2<br/>2  3  3  3  3  3<br/>3  4  4  4  4  4<br/>4  5  5  5  5  5</span><span id="00d8" class="lq lr it mk b gy ms mp l mq mr">   0  1  2  3  4<br/>2  3  3  3  3  3<br/>3  4  4  4  4  4<br/>4  5  5  5  5  5</span></pre><h2 id="4355" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">重塑数据帧</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="5696" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame({<br/>    'year': [ 2020, 2020, 2020, 2019, 2019, 2019 ],<br/>    'temp': [ 'H', 'M', 'L', 'H', 'M', 'L' ],<br/>    'month': [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun' ] <br/>})</strong></span><span id="5b83" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)<br/>print (my_dataframe.pivot(index = 'year', columns = 'temp', values='month'))</strong></span><span id="1358" class="lq lr it mk b gy ms mp l mq mr">   year    temp   month<br/>0  2020    H      Jan<br/>1  2020    M      Feb<br/>2  2020    L      Mar<br/>3  2019    H      Apr<br/>4  2019    M      May<br/>5  2019    L      Jun</span><span id="04b5" class="lq lr it mk b gy ms mp l mq mr">temp    H     L     M<br/>year               <br/>2019    Apr   Jun   May<br/>2020    Jan   Mar   Feb</span><span id="5526" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.melt(id_vars = ['year'], value_vars = ['month']))</strong></span><span id="7533" class="lq lr it mk b gy ms mp l mq mr">   year    variable value<br/>0  2020    month    Jan<br/>1  2020    month    Feb<br/>2  2020    month    Mar<br/>3  2019    month    Apr<br/>4  2019    month    May<br/>5  2019    month    Jun</span><span id="25da" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.melt(id_vars = ['year'], value_vars = ['month'], var_name = 'Variable Column', value_name = 'Value Column'))</strong></span><span id="1067" class="lq lr it mk b gy ms mp l mq mr">   year           Variable Column    Value Column<br/>0  2020           month              Jan<br/>1  2020           month              Feb<br/>2  2020           month              Mar<br/>3  2019           month              Apr<br/>4  2019           month              May<br/>5  2019           month              Jun</span></pre><h2 id="ba1e" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">分组和聚集数据帧</h2><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="4a76" class="lq lr it mk b gy mo mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame({<br/>    'year': [ 2020, 2020, 2020, 2019, 2019, 2019 ],<br/>    'temp': [ 'H', 'M', 'L', 'H', 'M', 'L' ],<br/>    'month': [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun' ] <br/>})</strong></span><span id="193c" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)</strong></span><span id="5b82" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">df_group = my_dataframe.groupby('year')<br/>print (df_group.first())</strong></span><span id="2b0a" class="lq lr it mk b gy ms mp l mq mr">   year    temp   month<br/>0  2020    H      Jan<br/>1  2020    M      Feb<br/>2  2020    L      Mar<br/>3  2019    H      Apr<br/>4  2019    M      May<br/>5  2019    L      Jun</span><span id="bacb" class="lq lr it mk b gy ms mp l mq mr">        temp  month<br/>year           <br/>2019    H     Apr<br/>2020    H     Jan</span><span id="dbc7" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (df_group.get_group('H'))</strong></span><span id="ade6" class="lq lr it mk b gy ms mp l mq mr">   year   month<br/>0  2020   Jan<br/>3  2019   Apr</span><span id="d26d" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">df_group = my_dataframe.groupby(['year','temp'])<br/>print (df_group.first())</strong></span><span id="903f" class="lq lr it mk b gy ms mp l mq mr">year temp   month      <br/>2019 H      Apr<br/>     L      Jun<br/>     M      May<br/>2020 H      Jan<br/>     L      Mar<br/>     M      Feb</span><span id="3769" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">my_dataframe = pd.DataFrame({<br/>    'C1': [ 1, 2, 3, 4, 5 ],<br/>    'C2': [ 6, 7, 8, 9, 10 ],<br/>    'C3': [ 11, 12, 13, 14, 15 ] <br/>})</strong></span><span id="9209" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe)</strong></span><span id="5415" class="lq lr it mk b gy ms mp l mq mr">    C1  C2  C3<br/>0   1   6  11<br/>1   2   7  12<br/>2   3   8  13<br/>3   4   9  14<br/>4   5  10  15</span><span id="676b" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.aggregate(['sum','min','max']))</strong></span><span id="a34f" class="lq lr it mk b gy ms mp l mq mr">     C1  C2  C3<br/>sum  15  40  65<br/>min   1   6  11<br/>max   5  10  15</span><span id="e2db" class="lq lr it mk b gy ms mp l mq mr"><strong class="mk iu">print (my_dataframe.aggregate({ 'C1': ['min','max'], 'C2': ['sum'] }))</strong></span><span id="75d9" class="lq lr it mk b gy ms mp l mq mr">     C1    C2<br/>max  5.0   NaN<br/>min  1.0   NaN<br/>sum  NaN  40.0</span></pre><p id="dec4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望你觉得这篇文章有趣并且有用。如果您想随时了解情况，请不要忘记关注我，注册我的<a class="ae my" href="https://whittle.medium.com/subscribe" rel="noopener">电子邮件通知</a>。</p><h1 id="c110" class="mz lr it bd ls na nb nc lv nd ne nf ly jz ng ka mb kc nh kd me kf ni kg mh nj bi translated">迈克尔·惠特尔</h1><ul class=""><li id="5f59" class="nk nl it kw b kx mt la mu ld nm lh nn ll no lp np nq nr ns bi translated"><strong class="kw iu"> <em class="nt">如果你喜欢这个，请</em> </strong> <a class="ae my" href="https://whittle.medium.com/" rel="noopener"> <strong class="kw iu"> <em class="nt">跟我上媒</em> </strong> </a></li><li id="08b9" class="nk nl it kw b kx nu la nv ld nw lh nx ll ny lp np nq nr ns bi translated"><strong class="kw iu"> <em class="nt">更多有趣的文章，请</em> </strong> <a class="ae my" href="https://medium.com/trading-data-analysis" rel="noopener"> <strong class="kw iu"> <em class="nt">关注我的刊物</em> </strong> </a></li><li id="92fb" class="nk nl it kw b kx nu la nv ld nw lh nx ll ny lp np nq nr ns bi translated"><strong class="kw iu"> <em class="nt">有兴趣合作？</em> </strong> <a class="ae my" href="https://www.linkedin.com/in/miwhittle/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="nt">咱们上领英</em> </strong> </a>连线</li><li id="df10" class="nk nl it kw b kx nu la nv ld nw lh nx ll ny lp np nq nr ns bi translated"><strong class="kw iu"> <em class="nt">支持我和其他媒体作者</em> </strong> <a class="ae my" href="https://whittle.medium.com/membership" rel="noopener"> <strong class="kw iu"> <em class="nt">在此报名</em> </strong> </a></li><li id="872e" class="nk nl it kw b kx nu la nv ld nw lh nx ll ny lp np nq nr ns bi translated"><strong class="kw iu"> <em class="nt">请别忘了为文章鼓掌:)←谢谢！</em> </strong></li></ul></div></div>    
</body>
</html>