<html>
<head>
<title>Using NetCat To Debug Postman</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NetCat调试Postman</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-netcat-to-debug-postman-9cb68ee073f0?source=collection_archive---------3-----------------------#2021-08-13">https://levelup.gitconnected.com/using-netcat-to-debug-postman-9cb68ee073f0?source=collection_archive---------3-----------------------#2021-08-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="3600" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用NetCat服务器和自定义HTTP消息对Postman的Cookie管理器进行分类。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/61d655e86fc667ac97b740c192a6af33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XksVsuSWjTyd-cIvsAC47Q.jpeg"/></div></div></figure><p id="66c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一位Postman用户来信询问Postman应用程序中的一个潜在错误。从他们的角度来看，HTTP头并不像HTTP规范中描述的那样不区分大小写。如果它们的头有小写的set-cookie,那么在响应返回后，它们在cookie管理器中看不到cookie。这种与预期行为的差异可能是Postman本身或其服务器实现的问题。我想设计一个最简单快捷的测试，而不需要创建或建立一个完整的服务器来确定错误来自哪一端。</p><p id="b682" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我决定使用NetCat并创建一个定制的原始HTTP消息。</p><p id="ab9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lb" href="http://netcat.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> NetCat </a>是一个UDP和TCP消息的美工刀。您可以通过端口监听服务器或将数据发送到服务器。当我说发送数据时，我指的是从键盘发送或在传输层通过管道输入的原始数据。然而，Postman只能在应用层读取数据，这意味着我们需要为Postman创建HTTP消息来呈现输出。你可以尝试发送回键盘输入，但你会看到邮递员有问题。</p><p id="12bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我制作了一个HTTP响应消息，标题如下，你可以从这些<a class="ae lb" href="https://developer.mozilla.org/en-US/docs/Web/HTTP" rel="noopener ugc nofollow" target="_blank"> MDN文档</a>中找到HTTP消息需要什么。如您所见，我有协议、状态代码、设置为JSON的内容类型、一些JSON数据，以及我正在测试的Set-Cookie标题。</p><pre class="kp kq kr ks gt lc ld le lf aw lg bi"><span id="f8af" class="lh li it ld b gy lj lk l ll lm">HTTP/1.1 200 OK</span><span id="7b30" class="lh li it ld b gy ln lk l ll lm">Server: netcat!</span><span id="df07" class="lh li it ld b gy ln lk l ll lm">Content-type: application/json</span><span id="41da" class="lh li it ld b gy ln lk l ll lm">Access-Control-Allow-Origin: *</span><span id="e2de" class="lh li it ld b gy ln lk l ll lm">Connection: Keep-Alive</span><span id="3c8d" class="lh li it ld b gy ln lk l ll lm">Set-Cookie: yummy_cookie=choco; HttpOnly</span><span id="5e79" class="lh li it ld b gy ln lk l ll lm">{</span><span id="04de" class="lh li it ld b gy ln lk l ll lm">"message": "check your new cookies!"</span><span id="cf7f" class="lh li it ld b gy ln lk l ll lm">}</span></pre><p id="d5f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我建立了一个NetCat监听服务器。</p><pre class="kp kq kr ks gt lc ld le lf aw lg bi"><span id="27e2" class="lh li it ld b gy lj lk l ll lm">while true; do cat cookies.http | nc localhost -lv -p 8000; done</span></pre><p id="2a31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的bash行要求无限循环，并通过管道将<em class="la"> cookies.http </em>的内容发送到端口8000上的NetCat侦听服务器。当我们向<em class="la"> localhost:8000 </em>发送请求时，我们应该在<em class="la"> cookies.http </em>中创建HTTP响应消息。</p><p id="f824" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有关上述命令行的更深入解释，请阅读shell结果中的<a class="ae lb" href="https://explainshell.com/explain?cmd=while+true%3B+do+cat+cookies.http+%7C+nc+-l+8000%3B+done" rel="noopener ugc nofollow" target="_blank">解释。</a></p><p id="c618" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在向我的<em class="la"> localhost:8000上的netcat发送请求后，</em>我们可以看到我的HTTP主体数据被返回了。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lo"><img src="../Images/80e5f0207e92763d14c3d284559e39dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hQb_2DJZf0vXC-Ub3XSxTQ.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">我们的自定义HTTP消息从NetCat返回</figcaption></figure><p id="a2cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们检查一下我们的cookie的cookie管理器。现在我们可以看到我有大写字母的set-cookie，它能够存储cookie。我的下一个测试是简单地将<em class="la"> Set-Cookie </em>变成小写。在这两种情况下，Postman都能够用适当的cookie更新它的cookie管理器。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lt"><img src="../Images/b722551b025d09efad7d98c2a8ae1369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5RF_IyQ8KcaxJY-THaUrA.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">在这里，我们可以看到我们的cookie已设置！</figcaption></figure><p id="9ac3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是将微调过的响应返回给应用程序进行测试的好方法。您可以看到您的应用程序是如何处理各种各样的头或损坏的HTTP响应的。</p><p id="dc30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">继续玩这个吧！这是了解HTTP层如何在底层工作的好方法。</p><h1 id="af41" class="lu li it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">TL；速度三角形定位法(dead reckoning)</h1><ul class=""><li id="4e86" class="mr ms it js b jt mt jx mu kb mv kf mw kj mx kn my mz na nb bi translated">Postman用户的HTTP头有问题，但无法判断是服务器还是Postman应用程序的问题</li><li id="88fe" class="mr ms it js b jt nc jx nd kb ne kf nf kj ng kn my mz na nb bi translated">创建了一个NetCat服务器，它使用set-cookie用我们自己的HTTP消息响应一个HTTP文件</li><li id="7b7b" class="mr ms it js b jt nc jx nd kb ne kf nf kj ng kn my mz na nb bi translated">向Postman发送了一个对NetCat服务器的请求，现在我们可以完全按照自己的意愿控制响应</li></ul></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="ed9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢你所阅读的内容，请在Twitter或T2 LinkedIn上关注我</p></div></div>    
</body>
</html>