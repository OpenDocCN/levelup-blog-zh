<html>
<head>
<title>Creating a Browser Notification in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript创建浏览器通知</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-browser-notification-in-javascript-79e91bfb76c8?source=collection_archive---------0-----------------------#2020-05-29">https://levelup.gitconnected.com/creating-browser-notification-in-javascript-79e91bfb76c8?source=collection_archive---------0-----------------------#2020-05-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f96c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">了解如何在JavaScript中创建浏览器通知。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/677e08fc3a4d88b42afac6138c4d91f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0o30wQBLld_Wf4uUtzaug.png"/></div></div></figure><p id="6b67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe kx ky kz la b">Notification API</code>按钮，您可以在网站上显示通知。</p><p id="887a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">显示系统通知的三个简单步骤</p><ul class=""><li id="5b3c" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated">检查浏览器是否支持通知</li><li id="1937" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated">向用户请求显示通知的权限。</li><li id="d346" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated">一旦用户授予权限，创建<code class="fe kx ky kz la b">Notification</code>对象</li><li id="14c4" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated">显示带有自定义消息的通知</li></ul><h1 id="f2aa" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">检查浏览器支持</h1><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="2822" class="mr lq iq la b gy ms mt l mu mv"> typeof Notification !== "undefined"</span></pre><h1 id="0aa0" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">询问用户权限</h1><p id="4642" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">在请求许可之前，让我们检查一下许可是否已经被授予。要获取通知权限，您可以使用:</p><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="b97b" class="mr lq iq la b gy ms mt l mu mv">Notification.permission</span></pre><p id="b1f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它可以有3个值</p><ul class=""><li id="feab" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated"><code class="fe kx ky kz la b">denied</code> →许可</li><li id="ac83" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated"><code class="fe kx ky kz la b">granted</code> →许可授予</li><li id="6832" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated"><code class="fe kx ky kz la b">default</code>→用户选择未知，因此浏览器会表现得好像该值被拒绝一样。</li></ul><p id="754d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">认为<code class="fe kx ky kz la b">Notification.permission</code>就是<code class="fe kx ky kz la b">default</code>。现在，您需要请求用户允许显示通知。</p><p id="0c10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kx ky kz la b">Notification</code>中的<code class="fe kx ky kz la b">requestPermission</code>方法用于向用户提出请求。这将返回<code class="fe kx ky kz la b">promise</code>，解析为三个权限之一。</p><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="cdb3" class="mr lq iq la b gy ms mt l mu mv">Notification.requestPermission().then(function (permission) {</span><span id="40fa" class="mr lq iq la b gy nb mt l mu mv">    console.log(permission);</span><span id="30dd" class="mr lq iq la b gy nb mt l mu mv">});</span></pre><h1 id="2f5e" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">显示通知</h1><p id="f72c" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">要显示通知，我们需要两件事:</p><ul class=""><li id="3041" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated">标题→要在通知中显示的标题</li><li id="48b4" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated">消息→通知的正文，显示在标题下方。</li></ul><p id="54cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，我们可以包括</p><ul class=""><li id="0d45" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated">图标→要在通知中显示的图标的URL。</li></ul><p id="6a04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上选项是最常用的，在这里<a class="ae nc" href="https://developer.mozilla.org/en-US/docs/Web/API/Notification/Notification" rel="noopener ugc nofollow" target="_blank"/>可以看到完整的列表。</p><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="dec4" class="mr lq iq la b gy ms mt l mu mv">var title = "JavaScript Jeep";</span><span id="ba88" class="mr lq iq la b gy nb mt l mu mv">icon = '<a class="ae nc" href="https://homepages.cae.wisc.edu/~ece533/images/airplane.png" rel="noopener ugc nofollow" target="_blank">https://homepages.cae.wisc.edu/~ece533/images/airplane.png</a>';</span><span id="913b" class="mr lq iq la b gy nb mt l mu mv">var body = "It's Your boarding time";</span><span id="f5f0" class="mr lq iq la b gy nb mt l mu mv">var notification = new Notification(title, { body, icon });</span></pre><p id="e46f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仅当用户不在当前选项卡中时显示通知。要检查当前标签是否可以用户<code class="fe kx ky kz la b">document.visibilityState</code>。</p><p id="cbbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果<code class="fe kx ky kz la b">visiblityState</code>！= <code class="fe kx ky kz la b">visible</code>则显示通知</p><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="a6e1" class="mr lq iq la b gy ms mt l mu mv">let showNotification = document.visibilityState !== "visible";</span><span id="4f4f" class="mr lq iq la b gy nb mt l mu mv">if(showNotification) { <br/>   // Notification code<br/>}</span></pre><h2 id="1084" class="mr lq iq bd lr nd ne dn lv nf ng dp lz jy nh ni md kc nj nk mh kg nl nm ml nn bi translated">关闭通知</h2><p id="ae0c" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">如果用户回到触发通知的浏览器标签，需要使用<code class="fe kx ky kz la b">close</code>关闭通知。</p><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="c0d0" class="mr lq iq la b gy ms mt l mu mv">var notification = new Notification('Travel');</span><span id="8691" class="mr lq iq la b gy nb mt l mu mv">notification.close();</span></pre><h1 id="8d69" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">通知时的事件</h1><ul class=""><li id="9fb3" class="lb lc iq jp b jq mw ju mx jy no kc np kg nq kk lg lh li lj bi translated"><code class="fe kx ky kz la b">click</code> →用户点击通知。</li><li id="9cac" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated"><code class="fe kx ky kz la b">close</code> →通知关闭。</li><li id="5804" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated"><code class="fe kx ky kz la b">error</code> →通知因某种原因无法显示。</li><li id="3986" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated"><code class="fe kx ky kz la b">show</code> →向用户显示通知。</li></ul><h1 id="3caf" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">焦点选项卡点击通知。</h1><p id="1534" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">您可以使用<code class="fe kx ky kz la b">window.parent.focus()</code>将当前标签更改为显示通知的标签</p><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="349e" class="mr lq iq la b gy ms mt l mu mv">var notification = new Notification('Travel');</span><span id="f0bf" class="mr lq iq la b gy nb mt l mu mv">notification.onclick = function(){<br/>                         window.parent.focus();<br/>                         notification.close();<br/>                        }</span></pre><p id="9733" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">把这一切放在一起</p><pre class="km kn ko kp gt mn la mo mp aw mq bi"><span id="b6ee" class="mr lq iq la b gy ms mt l mu mv">let permission = Notification.permission;</span><span id="7741" class="mr lq iq la b gy nb mt l mu mv">if(permission === "granted") {</span><span id="479b" class="mr lq iq la b gy nb mt l mu mv">   showNotification();</span><span id="3450" class="mr lq iq la b gy nb mt l mu mv">} else if(permission === "default"){</span><span id="291b" class="mr lq iq la b gy nb mt l mu mv">   requestAndShowPermission();</span><span id="7664" class="mr lq iq la b gy nb mt l mu mv">} else {</span><span id="c0ad" class="mr lq iq la b gy nb mt l mu mv">  alert("Use normal alert");</span><span id="ffd1" class="mr lq iq la b gy nb mt l mu mv">}</span><span id="f864" class="mr lq iq la b gy nb mt l mu mv">function showNotification() {</span><span id="d87c" class="mr lq iq la b gy nb mt l mu mv">   if(document.visibilityState === "visible) {<br/>       return;<br/>   }</span><span id="dfde" class="mr lq iq la b gy nb mt l mu mv">   var title = "JavaScript Jeep";</span><span id="bc94" class="mr lq iq la b gy nb mt l mu mv">   icon = "image-url"</span><span id="5986" class="mr lq iq la b gy nb mt l mu mv">   var body = "Message to be displayed";</span><span id="e8b9" class="mr lq iq la b gy nb mt l mu mv">   var notification = new Notification('Title', { body, icon });</span><span id="ac41" class="mr lq iq la b gy nb mt l mu mv">   notification.onclick = () =&gt; { <br/>          notification.close();<br/>          window.parent.focus();<br/>   }</span><span id="be70" class="mr lq iq la b gy nb mt l mu mv">}</span><span id="b4c2" class="mr lq iq la b gy nb mt l mu mv">function requestAndShowPermission() {<br/>   Notification.requestPermission(function (permission) {<br/>      if (permission === "granted") {<br/>            showNotification();<br/>      }<br/>   });<br/>}</span></pre><p id="8940" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">项目理念。</p><ul class=""><li id="28d6" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated">待办事项→显示待办事项通知</li><li id="efab" class="lb lc iq jp b jq lk ju ll jy lm kc ln kg lo kk lg lh li lj bi translated">番茄钟→显示时间到通知。</li></ul><div class="nr ns gp gr nt nu"><a href="https://www.buymeacoffee.com/Jagathish" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">Jagathish Saravanan</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">你好👋。我是Jagathish。爱写关于JavaScript的文章。你的支持就像夏天吃冰淇淋一样。我…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="od l"><div class="oe l of og oh od oi kv nu"/></div></div></a></div></div><div class="ab cl oj ok hu ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ij ik il im in"><h1 id="81e5" class="lp lq iq bd lr ls oq lu lv lw or ly lz ma os mc md me ot mg mh mi ou mk ml mm bi translated">分级编码</h1><p id="247d" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">感谢您成为我们社区的一员！<a class="ae nc" href="https://www.youtube.com/channel/UC3v9kBR_ab4UHXXdknz8Fbg?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">订阅我们的YouTube频道</strong> </a>或者加入<a class="ae nc" href="https://skilled.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Skilled.dev编码面试课程</strong> </a>。</p><div class="nr ns gp gr nt nu"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">编写面试问题+获得开发工作</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">掌握编码面试的过程</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">技术开发</p></div></div><div class="od l"><div class="ov l of og oh od oi kv nu"/></div></div></a></div></div></div>    
</body>
</html>