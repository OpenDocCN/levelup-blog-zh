<html>
<head>
<title>Joker Virus — Analyzing the Unobtrusive Performance of the Intriguing Bread Virus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">小丑病毒——分析耐人寻味的面包病毒的隐蔽表现</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/joker-virus-analyzing-the-unobtrusive-performance-of-the-intriguing-bread-virus-9e4804ec482b?source=collection_archive---------20-----------------------#2021-09-07">https://levelup.gitconnected.com/joker-virus-analyzing-the-unobtrusive-performance-of-the-intriguing-bread-virus-9e4804ec482b?source=collection_archive---------20-----------------------#2021-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ca25" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解黑客的编码思维</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2b5f664677fc8cf8893c623f786b25e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eEEGWgpSOor73wKs"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@bermixstudio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Bermix工作室</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="a5c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">名为<strong class="ky ir">小丑病毒</strong>的有趣的木马恶意软件再次在舞台上找到了自己的位置，在Play Store的更多应用中蔓延。该病毒于2017年首次出现在Play Store应用程序中，然后在去年2020年再次出现，目前再次成为辩论的话题。</p><p id="3d08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然它的名字听起来有趣又令人震惊，但它背后的动机绝对不是什么有趣的事情。相反，它有能力吃掉被感染的安卓手机用户的全部银行或信用卡余额。</p><p id="ac64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">什么是小丑病毒，它如何对您的银行帐户和信用卡造成威胁？在我的另一篇文章中了解它:</p><div class="ls lt gp gr lu lv"><a href="https://medium.com/geekculture/silently-unobtrusively-are-your-bank-accounts-becoming-a-victim-to-the-joker-virus-a1d31f688173" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">悄悄的，不引人注意的，你的银行账户正在成为小丑病毒的受害者吗？</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">当心你安装的应用程序，小丑病毒又回来了，它可能会暗中干扰你的银行账号。</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">medium.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="ea9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更糟糕的是，小丑病毒是一种大多数反恶意软件都无法检测到的恶意软件，因为黑客在包含实际病毒的代码片段中采用了经典而先进的创新加密技术。</p><p id="5fa9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从Play Store中截至2021年被感染的8个应用程序列表中，我们将考虑一个Easy QR Scanner，这是一个Android扫描应用程序，并分析黑客如何隐藏一段代码，对您辛苦赚来的面包和黄油构成威胁。</p><p id="ed7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你还没有阅读我上面提到的前一篇文章，这里有一个关于该病毒如何工作的小概述:你在你的Android设备上安装这8个受感染应用程序中的一个(对该病毒一无所知)。安装后，在第一次运行时，它会请求几个权限，其中访问短信，联系人，电话设备信息是需要你注意的，但通常情况下，我们都会忽略它们，只需点击“允许”来拒绝每个请求。</p><p id="2818" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你点击了“允许”按钮，病毒就可以在你不知情情况下向供应商发送短信，并以你的名义进行可疑的订阅。这些可疑的订阅费用会在月底出现在运营商收费的“附加费用”部分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/7966867c774064349d52e2b9f3c3b57d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YIVYSaxOndX2VSkHxQZYJQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者在Canva中设计的图像</figcaption></figure><p id="4815" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了短信计费混淆之外，Joker病毒黑客还利用收费计费欺诈，通过网页向用户提供支付端点。当用户点击黑客通过他们的“运营商”(SIM卡公司)提供给他们的URL embed，并在支付完成时添加他们的电话号码时，黑客了解到电话号码，甚至通过以下两种方法中的任何一种来验证进入的请求是否来自同一用户:</p><ol class=""><li id="8333" class="ml mm iq ky b kz la lc ld lf mn lj mo ln mp lr mq mr ms mt bi translated">当用户点击嵌入的URL时，他们设备的数据连接会切换(在他们不知道的情况下)，这样用户就可以连接到移动数据，而不是Wifi。这样，因为服务提供商直接处理移动运营商的连接，所以可以容易地追踪和验证电话号码。</li><li id="0352" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated">用户需要将通过SMS发送给他们的密码检索到网页中，当用户点击嵌入的URL时，该网页就会打开。这样，用户自己验证SMS发送到的电话号码的接入。</li></ol><p id="c9f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">迄今为止，小丑病毒背后的黑客一直使用长途电话计费和短信计费这两种技术。无论他们采用何种技术，他们的目标都是获取运营商信息和用户的电话号码，以自动化可疑的订阅，这些订阅将在用户不知情的情况下代表用户不断累积附加费。</p><h1 id="001f" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">解析黑客的编码思维</h1><p id="0dc9" class="pw-post-body-paragraph kw kx iq ky b kz nr jr lb lc ns ju le lf nt lh li lj nu ll lm ln nv lp lq lr ij bi translated">那么，黑客如何将代码片段组合在一起，使病毒对反恶意软件隐藏起来，同时在后台持续运行呢？我们来看看被小丑病毒感染的<strong class="ky ir">易二维码扫描app </strong>的网络日志报告(这里正在进行的收费账单欺诈)。</p><h2 id="fa6e" class="nw na iq bd nb nx ny dn nf nz oa dp nj lf ob oc nl lj od oe nn ln of og np oh bi translated">第1步—安装后首次启动应用程序</h2><p id="4f43" class="pw-post-body-paragraph kw kx iq ky b kz nr jr lb lc ns ju le lf nt lh li lj nu ll lm ln nv lp lq lr ij bi translated">应用程序在首次启动时会请求以下四种权限:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/da52777b3e560cb4e95d84487209c1e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoYAUJtXbVQzJvA3VOncyQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片(Canva设计)</figcaption></figure><ol class=""><li id="14cb" class="ml mm iq ky b kz la lc ld lf mn lj mo ln mp lr mq mr ms mt bi translated">进入<strong class="ky ir">摄像头</strong></li><li id="5d4f" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated">访问<strong class="ky ir">联系人</strong></li><li id="3361" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated">访问<strong class="ky ir">手机存储器</strong></li><li id="8f39" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated">访问<strong class="ky ir">短信通知</strong></li></ol><p id="7c5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你允许以上所有操作，应用程序就会启动一个<strong class="ky ir">摄像头</strong>来扫描应用程序本身提供的<strong class="ky ir">二维码</strong>。QR码包含嵌入URL的信息，当扫描时，会在浏览器选项卡中打开该嵌入URL。无论页面是否完全加载，它都会在用户不知情的情况下，通过一个接一个地下载有效载荷来触发病毒。</p><p id="504f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，应用程序的这一行为不会被安装在您设备上的反病毒软件注意到，因为黑客已经利用了<a class="ae kv" href="https://blog.quarkslab.com/a-glimpse-into-tencents-legu-packer.html" rel="noopener ugc nofollow" target="_blank">腾讯打包器</a>，它基本上隐藏了恶意代码，因此反病毒引擎(甚至是Play Store)无法检测到它们。以下是从Play Store下载的应用程序包的外观:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/8f132af3994c71cac31ee427e94aeff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*hnozsdJZHF1FnoFu9iwveQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">下载的应用程序内容(图片由作者提供)</figcaption></figure><p id="2492" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看到那个腾讯。StubShell文件？这是包含隐藏恶意活动代码的加密数据包，恶意活动是在用户不知情的情况下在后台下载有效载荷。应用安装程序下载的第一运行时间运行第一网络日志条目。当腾讯。StubShell文件被解压缩，它包含连续下载三个有效载荷的指令，每个有效载荷都有一个自动下载下一个有效载荷的指令请求。以下是通过APK分析软件获得的活动截图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/bd4591deaac94c6867a316c262219cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKnsTJfzBEYpfh5ibS0OJg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">总共下载了3个有效载荷(图片由作者提供)</figcaption></figure><p id="5ee7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有三个有效载荷都是使用<em class="ol"> GET方法/命令</em>从同一个域下载的，但是路径不同。第一个有效载荷被命名为<strong class="ky ir"><em class="ol"/></strong><em class="ol">xiwa . doc</em><strong class="ky ir"/>，它的<strong class="ky ir"> </strong>包含下载下一个有效载荷的代码片段。</p><p id="eecc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是第一个有效载荷的编程情况:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/36c70522327f5dbc4a9beca35f7fd413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ci2zzzjD1eREhzf81zudpA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="a46e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在成功执行第一有效载荷之后，执行第二有效载荷，其首先检查SIM运营商类型。这是使用<em class="ol">getsimooperator</em>命令完成的。一旦<em class="ol">getsimooperator</em>命令被成功执行，它将返回移动国家代码和移动网络代码。收到该信息后，应用程序代码会发送一个OTP请求确认，以验证流程并获得对电话号码的访问权。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/cce0041588117ee2a0fe1bdc3aee9e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onxZ3eUsM-OaeiavyftKTg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">第二个有效负载的代码片段(图片由作者提供)</figcaption></figure><p id="ef0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当用户通过发回OTP来批准确认请求时，他们的电话号码以及运营商信息都容易受到病毒的攻击。然后，它继续为用户订阅高级服务，这是小丑病毒的主要动作。这是通过隐藏在最终阶段(第三阶段)有效载荷中的代码片段来完成的，一旦用户发回OTP以确认对设备的访问，就会自动完成。</p><p id="65b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ol"> onReceive()命令</em>用于从来自广播接收机的确认消息中收集所有用户信息(带有完整运营商信息的手机号码+设备信息)。</p><p id="564a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是黑客用于简单QR应用的<em class="ol"> onReceive命令</em>的代码片段。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/a116a7599bd7aff1cc868070df145451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOOKNVZZ-LhTsTivIvM2pg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">收集收到的文本、用户设备和运营商信息(图片由作者提供)</figcaption></figure><p id="57c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后阶段的有效载荷还包含字符串混淆，以防止基于模式的签名检测，这也有助于隐藏病毒的恶意活动。基于模式的检测是一种安全检查，它分析源代码中先前已知的威胁；这些威胁的唯一标识符在被发现后就已确定。通过使用字符串混淆，黑客可以绕过这些标识符的相似性检查，因此不会被基于模式的签名检测检测到。</p><p id="49d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是字符串混淆如何出现在Easy QR扫描仪应用程序的源代码中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/b3ddc86d4a3d54a48ab64757d47ed474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXGiG8hCuIHSLeFG2l1Lyg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">绕过基于模式的签名检测的代码片段(图片由作者提供)</figcaption></figure><p id="ce6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是你对黑客如何恶意编码以达到他们想要的结果的一个小小的了解。大多数情况下，这些应用程序看起来运行平稳、高效，而且绝对是良性的，直到用户意识到他们每月的账单上有附加费，或者变得足够好奇，去探索APK分析软件中应用程序的幕后过程。</p><p id="0692" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，建议通过已知和可靠的来源下载应用程序，以避免成为网络犯罪的受害者。</p></div><div class="ab cl oq or hu os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="ij ik il im in"><p id="7648" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">披露:</strong> <em class="ol">写这个内容的唯一目的是教育和学习，而不是说服任何人去接受黑客的野心或职业。</em></p></div><div class="ab cl oq or hu os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="ij ik il im in"><p id="dc72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">阅读更多我的故事内容和许多其他由杰出作者在媒体上写的无限有趣的文章。只需5美元即可获得<a class="ae kv" href="https://safoorawrites.medium.com/membership" rel="noopener"> Medium的月度订阅</a>,并立即获得平台上无限有趣的内容。</p><p id="d838" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注:</strong> <em class="ol">上面的链接是会员链接，意思是如果你通过这个链接以读者或者作家的身份加入medium platform，我会给你赚一小笔佣金，绝对不会额外收费。</em></p></div></div>    
</body>
</html>