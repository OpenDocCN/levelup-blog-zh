<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://levelup.gitconnected.com/introducing-react-native-web-storybook-3c56d48a6508?source=collection_archive---------3-----------------------#2022-03-30">https://levelup.gitconnected.com/introducing-react-native-web-storybook-3c56d48a6508?source=collection_archive---------3-----------------------#2022-03-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/411167242dd7436952341dbb15821849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXBkf_4sJdUuKrlJI974zw.png"/></div></div></figure><p id="e402" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">Storybook是针对组件和页面的UI开发研讨会。由于各种原因，它被许多团队使用。您可以独立开发组件，运行可视化测试，甚至验证UI的可访问性。</p><p id="82cd" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">Storybook以网络为中心，从那时起已经扩展到许多不同的平台。其中一个平台是React Native。</p><p id="a6fa" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">React Native story book是一个目录，包含所有组件和状态，可以在移动设备上的iOS或Android应用程序中运行。这对于在产品设置中查看您的React原生组件非常有用，但与Storybook的web UI相比也有一些缺点。</p><p id="347e" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">这就是为什么我很兴奋地宣布React Native Web 的<a class="ae jy" href="https://www.npmjs.com/package/@storybook/addon-react-native-web" rel="noopener ugc nofollow" target="_blank"> Storybook，这是一种在Storybook中开发和共享React Native组件的新的补充方法。</a></p><h1 id="3d3d" class="jz ka jb bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">React Native对故事书的不同看法</h1><p id="b1ae" class="pw-post-body-paragraph iz ja jb jc b jd kx jf jg jh ky jj jk jl kz jn jo jp la jr js jt lb jv jw jx ij bi translated">我一直在和<a class="ae jy" href="https://twitter.com/mshilman" rel="noopener ugc nofollow" target="_blank">迈克尔·希尔曼</a>一起工作，为React Native Storybook开发一种新的方法，它拥有网上Storybook的所有功能。这是通过使用我们构建的<a class="ae jy" href="https://www.npmjs.com/package/@storybook/addon-react-native-web" rel="noopener ugc nofollow" target="_blank">插件</a>来实现的，该插件使用react-native-web库使您的组件在浏览器中可用。你所要做的就是在你的项目中设置插件。</p><p id="cc1b" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">在下面的视频中，我直接在浏览器中与React本地组件进行交互。显示的组件使用流行的React本地库的功能，如动画库react-native-reanimated和用于处理交互的通用库react-native-gesture-handler。</p><figure class="lc ld le lf gt is"><div class="bz fp l di"><div class="lg lh l"/></div></figure><p id="85c4" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">下面是嵌入的<a class="ae jy" href="https://618d44792e48fd003a482f88-fgqejyulkb.chromatic.com/?path=/story/libraries-gesture-handler-draggable--basic" rel="noopener ugc nofollow" target="_blank">示例故事书</a>(如果嵌入不起作用，请使用链接)</p><figure class="lc ld le lf gt is"><div class="bz fp l di"><div class="li lh l"/></div></figure><h1 id="fde2" class="jz ka jb bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">反应本土的挑战</h1><p id="9bba" class="pw-post-body-paragraph iz ja jb jc b jd kx jf jg jh ky jj jk jl kz jn jo jp la jr js jt lb jv jw jx ij bi translated">React Native在<a class="ae jy" href="https://github.com/storybookjs/react-native" rel="noopener ugc nofollow" target="_blank"> @storybook/react-native </a>有自己的Storybook实现，但是有一些限制。</p><p id="ecb4" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">React Native的故事书与web框架的故事书(React、Vue、Angular等)建立在不同的架构上。)，并且它是作为一个单独的项目来构建的。由于这种架构上的差异，要实现与Storybook for web的功能对等需要付出大量的努力。</p><p id="a870" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">React Native Storybook只支持web平台上story book的一小部分插件和特性。这也意味着像Storybook的可视化测试这样的外部工具需要一个定制的实现来支持react native。不幸的是，与web相比，这导致用户对React Native的体验不完整</p><p id="c7bb" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">理想情况下，React Native story book应该支持所有流行的插件和Storybook for Web上使用的现有工具。这可能吗？</p><p id="8f9a" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">如果你在这里，你可能会猜到答案是肯定的。当然有一些限制，但是我认为对于许多用例来说这是值得的。想到的主要用例是UI库维护者，他们希望以交互的方式展示他们的React本地组件。</p><h2 id="27c5" class="lj ka jb bd kb lk ll dn kf lm ln dp kj jl lo lp kn jp lq lr kr jt ls lt kv lu bi translated">在Web上反应原生组件？</h2><p id="195d" class="pw-post-body-paragraph iz ja jb jc b jd kx jf jg jh ky jj jk jl kz jn jo jp la jr js jt lb jv jw jx ij bi translated">您可能会对已经完全支持web平台的React本地库的数量感到惊讶。此外，如果你一直关注React Native，你可能会知道facebook非常重视多平台愿景。</p><p id="b767" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">以下是React Native的一些热门下载库(基于npm数量):</p><ul class=""><li id="4bb1" class="lv lw jb jc b jd je jh ji jl lx jp ly jt lz jx ma mb mc md bi translated">反应-导航</li><li id="aa94" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">反应-本机-屏幕</li><li id="95a8" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">react-native-手势处理器</li><li id="811a" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">反应-原生-svg</li><li id="255f" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">反应-原生-复活</li><li id="bafd" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">反应-本地-矢量-图标</li></ul><p id="ec82" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">所有这些库都以某种方式支持web平台。事实上，我已经用这个新插件测试了许多这些流行的库，它们在网络上都工作得很好。</p><p id="6f80" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在，我想与你分享我一直在做的项目，它应该有助于弥合React Native和Storybook之间的差距，让你拥有Storybook for web的全部功能，你知道并喜欢这些功能。</p><h2 id="540f" class="lj ka jb bd kb lk ll dn kf lm ln dp kj jl lo lp kn jp lq lr kr jt ls lt kv lu bi translated">介绍@ story book/addon-react-native-web</h2><p id="8071" class="pw-post-body-paragraph iz ja jb jc b jd kx jf jg jh ky jj jk jl kz jn jo jp la jr js jt lb jv jw jx ij bi translated">这个插件为您在React本地项目中使用ReactJS故事书提供了一个简单的设置。您可以在本地运行它，或者轻松地将其部署为网站供他人查看。最好的部分是，因为它是在ReactJS配置的网络上运行的，所以大多数插件不需要任何修改就可以工作。</p><p id="5b6c" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">这意味着:</p><ul class=""><li id="bc9d" class="lv lw jb jc b jd je jh ji jl lx jp ly jt lz jx ma mb mc md bi translated">更好的用户界面/UX。</li><li id="6afd" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">受欢迎的插件如<a class="ae jy" href="https://storybook.js.org/addons/@storybook/addon-docs/" rel="noopener ugc nofollow" target="_blank">文档</a>支持开箱即用。</li><li id="a98d" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">支持<a class="ae jy" href="https://www.chromatic.com/" rel="noopener ugc nofollow" target="_blank">色度</a>等视觉测试工具。</li><li id="1a7e" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">轻松发布您的故事书，并与设计者和产品所有者等利益相关者共享。</li><li id="e7d0" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">完全支持最新的故事书功能。</li></ul><p id="998a" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">然而，存在一些缺点:</p><ul class=""><li id="5fb8" class="lv lw jb jc b jd je jh ji jl lx jp ly jt lz jx ma mb mc md bi translated">一些图书馆没有网络支持</li><li id="cbf7" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">组件可能不会像在本机设备上那样精确显示</li><li id="1837" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">没有传输的库需要一些额外的配置</li></ul><p id="4b6e" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">如果这些缺点不是决定性因素，那么我认为你会对结果感到满意。然而，如果你因为需要本地移动体验而无法使用这个包，那么可以考虑使用<a class="ae jy" href="https://github.com/storybookjs/react-native" rel="noopener ugc nofollow" target="_blank"> @storybook/react-native </a>。如果对您的用例有意义，您甚至可以两者都用。</p><p id="b96b" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">如果你担心网页上的组件会有所不同，请参见<a class="ae jy" href="https://github.com/storybookjs/addon-react-native-web/blob/main/FAQ.md" rel="noopener ugc nofollow" target="_blank"> FAQ </a>，我曾试图解决这个问题。</p><p id="bc72" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">我还在<a class="ae jy" href="https://github.com/storybookjs/addon-react-native-web#configuring-popular-libraries" rel="noopener ugc nofollow" target="_blank">项目自述文件</a>中提供了一些示例配置</p><p id="6a75" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在是有趣的部分！</p><h1 id="ddc2" class="jz ka jb bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">入门指南</h1><p id="0208" class="pw-post-body-paragraph iz ja jb jc b jd kx jf jg jh ky jj jk jl kz jn jo jp la jr js jt lb jv jw jx ij bi translated">如果你想亲自尝试一下，下面是几个步骤。</p><p id="c103" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">如果您还没有创建react原生项目，请创建它</p><pre class="lc ld le lf gt mj mk ml mm aw mn bi"><span id="5206" class="lj ka jb mk b gy mo mp l mq mr">npx react-native init AwesomeApp --template react-native-template-typescript<br/>cd AwesomeApp</span></pre><p id="63ac" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">初始化故事书。</p><pre class="lc ld le lf gt mj mk ml mm aw mn bi"><span id="c898" class="lj ka jb mk b gy mo mp l mq mr">npx sb init --type react</span></pre><p id="ec16" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">如果你愿意，你可以删除例子故事(不必要)。</p><pre class="lc ld le lf gt mj mk ml mm aw mn bi"><span id="623f" class="lj ka jb mk b gy mo mp l mq mr">rm -rf stories/*</span></pre><p id="96bb" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在添加@ story book/addon-react-native-web及其依赖项</p><pre class="lc ld le lf gt mj mk ml mm aw mn bi"><span id="758b" class="lj ka jb mk b gy mo mp l mq mr">yarn add --dev react-dom react-native-web babel-plugin-react-native-web @storybook/addon-react-native-web</span></pre><p id="a5a1" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">开门。storybook/main.js并将插件添加到插件列表中。</p><pre class="lc ld le lf gt mj mk ml mm aw mn bi"><span id="0e3b" class="lj ka jb mk b gy mo mp l mq mr">module.exports = {<br/>  /* existing config */<br/>  addons: [/*existing addons,*/ "@storybook/addon-react-native-web"],<br/>};</span></pre><p id="ed59" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在设置已经完成，让我们在stories文件夹中添加一个React本地组件和一个故事。</p><p id="853a" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">下面是一个按钮组件的示例:</p><pre class="lc ld le lf gt mj mk ml mm aw mn bi"><span id="a309" class="lj ka jb mk b gy mo mp l mq mr">// stories/MyButton.tsx<br/>import React from "react";<br/>import { StyleSheet, Text, TouchableOpacity, View } from "react-native";<br/><br/>export type ButtonProps = {<br/>  onPress: () =&gt; void;<br/>  text: string;<br/>  color?: string;<br/>  textColor?: string;<br/>};<br/><br/>const styles = StyleSheet.create({<br/>  button: {<br/>    paddingVertical: 8,<br/>    paddingHorizontal: 16,<br/>    borderRadius: 4,<br/>    alignSelf: "flex-start",<br/>    flexGrow: 0,<br/>    backgroundColor: "purple",<br/>  },<br/>  buttonText: {<br/>    color: "white",<br/>    fontSize: 16,<br/>    fontWeight: "bold",<br/>  },<br/>  buttonContainer: {<br/>    alignItems: "flex-start",<br/>    flex: 1,<br/>  },<br/>});<br/><br/>export const MyButton = ({ text, onPress, color, textColor }: ButtonProps) =&gt; (<br/>  &lt;View style={styles.buttonContainer}&gt;<br/>    &lt;TouchableOpacity<br/>      style={[styles.button, !!color &amp;&amp; { backgroundColor: color }]}<br/>      onPress={onPress}<br/>      activeOpacity={0.8}<br/>    &gt;<br/>      &lt;Text style={[styles.buttonText, !!textColor &amp;&amp; { color: textColor }]}&gt;<br/>        {text}<br/>      &lt;/Text&gt;<br/>    &lt;/TouchableOpacity&gt;<br/>  &lt;/View&gt;<br/>);</span></pre><p id="83e9" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">和这个组件的故事:</p><pre class="lc ld le lf gt mj mk ml mm aw mn bi"><span id="62ed" class="lj ka jb mk b gy mo mp l mq mr">// stories/MyButton.stories.tsx<br/>import React from "react";<br/>import { ComponentMeta, ComponentStory } from "@storybook/react";<br/><br/>import { MyButton } from "./MyButton";<br/><br/>export default {<br/>  title: "components/MyButton",<br/>  component: MyButton,<br/>} as ComponentMeta&lt;typeof MyButton&gt;;<br/><br/>export const Basic: ComponentStory&lt;typeof MyButton&gt; = (args) =&gt; (<br/>  &lt;MyButton {...args} /&gt;<br/>);<br/><br/>Basic.args = {<br/>  text: "Hello World",<br/>  color: "purple",<br/>};</span></pre><p id="5d20" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在用<code class="fe ms mt mu mk b">yarn storybook</code>运行故事书，它应该会在你的浏览器中打开。</p><p id="2cc8" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">您应该会看到类似这样的内容:</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/b78cf5c4acb22c5daf56db8d20cea035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NHWynmBKwhIFKf06.png"/></div></div></figure><p id="a509" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">在web上运行，看不到一个div或span！🎉</p><p id="4698" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">谢谢你读到这里，我很希望听到你对此的想法！如果你想看一个展示React Native和web故事书的示例项目，使用reanimated和手势处理程序等库，请确保查看这个<a class="ae jy" href="https://github.com/dannyhw/addon_react_native_web_example" rel="noopener ugc nofollow" target="_blank">库</a>。</p><p id="7998" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">我是@storybook/react-native的维护人员之一，目前正在努力改进，准备6.0版本，敬请关注！我很乐意在未来的帖子中更多地谈论我对即将发布的React Native故事书的看法，所以如果你感兴趣，请告诉我！</p><p id="bfba" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">你可以在twitter上找到我，或者在Storybook discord服务器的#react-native频道找到discord:</p><ul class=""><li id="8079" class="lv lw jb jc b jd je jh ji jl lx jp ly jt lz jx ma mb mc md bi translated">推特:<a class="ae jy" href="https://twitter.com/Danny_H_W" rel="noopener ugc nofollow" target="_blank"> @Danny_H_W </a></li><li id="f1d6" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">Github: <a class="ae jy" href="https://github.com/dannyhw" rel="noopener ugc nofollow" target="_blank"> dannyhw </a></li><li id="4038" class="lv lw jb jc b jd me jh mf jl mg jp mh jt mi jx ma mb mc md bi translated">故事书不和:<a class="ae jy" href="https://discord.gg/sMFvFsG" rel="noopener ugc nofollow" target="_blank">故事书</a></li></ul><p id="ea1e" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">非常感谢<a class="ae jy" href="https://twitter.com/mshilman" rel="noopener ugc nofollow" target="_blank">迈克尔·希尔曼</a>建立了知识库，并帮助我解决了所有的故事书配置。也为所花的时间和指导。没有他的努力，这是不可能的！</p><p id="e57d" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">感谢所有帮助我编辑这个帖子并给予反馈的人。</p></div></div>    
</body>
</html>