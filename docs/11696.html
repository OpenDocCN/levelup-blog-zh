<html>
<head>
<title>Build a Mail Spam Classifier Using Tensorflow and Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Tensorflow和Keras构建垃圾邮件分类器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-a-mail-spam-classifier-using-tensorflow-and-keras-9bc687d2a1d3?source=collection_archive---------7-----------------------#2022-04-06">https://levelup.gitconnected.com/build-a-mail-spam-classifier-using-tensorflow-and-keras-9bc687d2a1d3?source=collection_archive---------7-----------------------#2022-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/42581b91bc20c8f625f12f9cdee953f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8WjgVq27FBW-9E8M"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">杰斯温·托马斯在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="93bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自然语言处理是深度学习的主要应用之一。在深度学习的帮助下，我们赋予机器理解自然语言的能力。使用深度学习，我们可以解决一系列问题，如文本翻译、测试自动完成、拼写检查、情感分析等。</p><p id="257c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我希望给出一个关于如何使用深度学习技术制作垃圾邮件分类器的教程。我们将使用TensorFlow和Keras深度学习框架。在这里我只是提供了一个详细的事情解释，查看代码请参考我的GitHub回购<a class="ae kc" href="https://github.com/nerdylabs/Mail-Spam-detection-using-NLP" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="b388" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">为什么要深度学习？</h1><p id="95d1" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在我们回答这个问题之前。我们来问为什么机器学习？你可以用传统的软件工程技术来解决这个问题。您收集了一些包含垃圾邮件和非垃圾邮件的数据。您观察到一些事情，如垃圾邮件包含许多不必要的感叹号“！！！!"，邮件中包含“优惠、出售、%、紧急、限时交易”等字样。现在，您可以编写一个算法，在其中保存一个在垃圾邮件中常见的单词和事物的列表。现在，每当一封新邮件包含您的观察列表中的任何单词，您就将该邮件标记为垃圾邮件。这种解决方案的问题是，这不是问题的永久解决方案，也就是说，垃圾邮件发送者现在理解了您的垃圾邮件分类器的工作方式，您只是从数据中寻找某些单词，垃圾邮件发送者现在用更改修改他们的邮件，现在您的算法失败了。你必须不断手动更新你的系统。</p><p id="ba1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在机器学习的帮助下，我们说，“这些是我的一些邮件，一些是垃圾邮件，一些不是垃圾邮件，请想出一种方法来分类这些邮件”。然后你的机器会浏览这些邮件，并学习一些相关性来对邮件进行分类。这样做的好处是，如果垃圾邮件发送者现在改变了邮件的结构，你的机器会主动学习这些变化，因为你没有像第一种情况那样对它进行显式编程。因此，机器学习的定义是"<em class="ml">机器学习</em>包括计算机发现它们如何在没有明确编程的情况下执行任务。"</p><p id="7cff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在深度学习是机器学习算法的子集。在将机器学习应用于图像、文本、音频等非结构化数据时，深度学习非常有用。因此，为了构建我们的垃圾邮件分类器，我们使用深度学习技术。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="b592" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">一些额外的阅读</h1><ul class=""><li id="2c92" class="mm mn iq kf b kg mg kk mh ko mo ks mp kw mq la mr ms mt mu bi translated">现在，为了构建这个分类器，我使用了<a class="ae kc" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> <em class="ml"> TensorFlow </em> </a>库。现在TensorFlow是Google开发的深度学习框架。使用TensorFlow，您可以轻松构建这些深度学习模型。</li><li id="2ccd" class="mm mn iq kf b kg mv kk mw ko mx ks my kw mz la mr ms mt mu bi translated">Keras — Keras是构建在TensorFlow之上的高级API。最初的Keras和TensorFlow是独立的库。在TensorFlow 2.0之后，Keras现在集成在TensorFlow本身中。</li><li id="e684" class="mm mn iq kf b kg mv kk mw ko mx ks my kw mz la mr ms mt mu bi translated">Colab——Google Colab是一个免费的基于云的虚拟环境，在这里你可以访问免费的GPU来训练你的深度学习模型。你得到python，Jupyter笔记本UI等。</li></ul><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/cf05651a0ba44daf27a4894a14281618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-hXwHsJFNyxmbnygv7a1g.png"/></div></div></figure><ul class=""><li id="0b7d" class="mm mn iq kf b kg kh kk kl ko nf ks ng kw nh la mr ms mt mu bi translated">长短期记忆(LSTM)是一种特殊类型的神经结构。它来自一个叫做循环神经网络(RNN)的基础结构。如果你不知道LSTMs和RNN <a class="ae kc" href="https://www.youtube.com/watch?v=qjrad0V0uJE&amp;list=PLtBw6njQRU-rwp5__7C0oIVt26ZgjG9NI&amp;index=3" rel="noopener ugc nofollow" target="_blank"> <em class="ml">参考这个视频</em> </a> <em class="ml">。</em></li></ul><figure class="nb nc nd ne gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="c7a4" class="li lj iq bd lk ll nk ln lo lp nl lr ls lt nm lv lw lx nn lz ma mb no md me mf bi translated">解决问题</h1><p id="78a3" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">“你可以用机器做任何事情，只要你能把它转换成数字，并对它进行编程以找到模式”这是我在YouTube视频上看到的评论，让我们来分析一下。</p><p id="06cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以你可以应用机器学习，只要你能把你的输入转换成数字，你看当你用机器学习或深度学习解决计算机图像问题时，你把你的图像转换成数字，现在计算机本来就以矩阵和像素数字的形式存储图像，所以不用担心。但是，对于文本来说，计算机本来就把文本存储为文本，而不是以数字的形式存储，现在你可能会争论ASCII值之类的东西，但这不是我的意思。我的意思是你的程序应该把文本看作数字，而不是原生文本。</p><p id="b865" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，第二个陈述是“对它编程以找到模式”，而不是你已经将你的数据(输入/输出)转换为数字，现在你需要对它编程以找到模式，这就是深度学习的作用。你看，机器学习就是在数据中寻找相关性和模式。借助这些在数据中发现的相关性，你的程序可以了解数据是如何发展的，因此当你提供新数据时，它可以根据以前学习的相关性预测一些事情。</p><p id="b9ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然我们了解了问题以及如何解决问题，我们现在可以尝试解决它。</p><h1 id="d48f" class="li lj iq bd lk ll nk ln lo lp nl lr ls lt nm lv lw lx nn lz ma mb no md me mf bi translated">1.学习单词嵌入</h1><p id="f378" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">解决问题的第一步是将原始文本转换成数字。这可以通过使用某种频率采样方法来实现。例如，假设你有这样一句话，“我喜欢狗！”，你可以用1 - I，2 - love，3 - dogs把这个转换成“1 2 3”。现在，假设你有另外一句话，比如“<em class="ml">我喜欢猫！</em>”，你可以把这个从上面的例子1 - I，2 - love，4 - cats转换成“1 2 4”。所以像这样，每当你发现一个新单词，你就赋予它一个新的值，然后继续。这叫做标记化。</p><p id="0f00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在仅仅将单词转换成数字是不够的，你的神经网络必须理解单词之间的含义和相关性。例如，像猫和狗这样的词必须是高度相关的，因为它们指向同一个事物，例如，宠物、四条腿的动物等等。像人类和狗这样的词不应该高度相关。</p><p id="d468" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，为了学习这种相关性，我们需要学习一种叫做单词嵌入的东西。这只是一个数字矩阵，包含了这些学习到的嵌入。详细解释参考视频。</p><figure class="nb nc nd ne gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="a120" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在有一些预先训练好的单词嵌入可以使用，<a class="ae kc" href="https://keras.io/examples/nlp/pretrained_word_embeddings/" rel="noopener ugc nofollow" target="_blank"> <em class="ml">参考Keras docs了解同样的</em> </a> <em class="ml">。</em></p><p id="3065" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Keras有它的嵌入层。<a class="ae kc" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Embedding" rel="noopener ugc nofollow" target="_blank"> <em class="ml">参考嵌入层文档。</em>T13】</a></p><h1 id="2113" class="li lj iq bd lk ll nk ln lo lp nl lr ls lt nm lv lw lx nn lz ma mb no md me mf bi translated">到目前为止，这个想法</h1><ol class=""><li id="740c" class="mm mn iq kf b kg mg kk mh ko mo ks mp kw mq la np ms mt mu bi translated">我们做的第一件事就是加载数据集。</li><li id="1323" class="mm mn iq kf b kg mv kk mw ko mx ks my kw mz la np ms mt mu bi translated">然后我们将文本转换成数字。</li><li id="1be8" class="mm mn iq kf b kg mv kk mw ko mx ks my kw mz la np ms mt mu bi translated">然后我们生成了一个矩阵来解释这些数字。</li><li id="a357" class="mm mn iq kf b kg mv kk mw ko mx ks my kw mz la np ms mt mu bi translated">现在，我们准备将这个新生成的矩阵输入到我们的神经网络中。</li></ol><blockquote class="nq nr ns"><p id="fa82" class="kd ke ml kf b kg kh ki kj kk kl km kn nt kp kq kr nu kt ku kv nv kx ky kz la ij bi translated">要查看代码，请参考我的GitHub repo。</p></blockquote><h1 id="6e36" class="li lj iq bd lk ll nk ln lo lp nl lr ls lt nm lv lw lx nn lz ma mb no md me mf bi translated">2.建设LSTM网络</h1><p id="cc5b" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">简单RNN的思想是获取顺序数据并按顺序通过每个时间步。现在的问题是，RNN受到梯度消失问题的困扰，对于长句子表现不佳。</p><p id="eede" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">想想这些句子，“没有什么技术是伟大的”和“现在什么也做不了”。在第一句话中，我指的是虚无品牌，在第二句话中，我指的是一种情况。</p><p id="1b22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无论如何，单词“nothing”在句子的上下文中是什么意思是至关重要的。该信息必须被保存，并且必须被传递到神经网络的后面的层，这是简单的RNN模型所不能实现的。</p><p id="7118" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们使用LSTM，其中LSTM计算与句子上下文相关的某些门值。</p><figure class="nb nc nd ne gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="02d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用TensorFlow提供的LSTM层。</p><blockquote class="nq nr ns"><p id="a413" class="kd ke ml kf b kg kh ki kj kk kl km kn nt kp kq kr nu kt ku kv nv kx ky kz la ij bi translated">查看代码请<a class="ae kc" href="https://github.com/nerdylabs/Mail-Spam-detection-using-NLP" rel="noopener ugc nofollow" target="_blank">参考我的GitHub回购。</a></p></blockquote><p id="891e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们已经来到了教程的结尾。我希望你学到了一些东西。感谢您的阅读！</p><p id="14e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ml">更多内容看</em> <a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="ml">说白了就是</em> </strong> </a> <em class="ml">。报名参加我们的</em> <a class="ae kc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="ml">免费周报</em> </strong> </a> <em class="ml">。关注我们关于</em><a class="ae kc" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="ml">Twitter</em></strong></a><em class="ml">和</em><a class="ae kc" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="ml">LinkedIn</em></strong></a><em class="ml">。加入我们的</em> <a class="ae kc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="ml">社区</em> </strong> </a> <em class="ml">。</em></p></div></div>    
</body>
</html>