<html>
<head>
<title>How to solve the Apriori algorithm in a simple way from scratch?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从零开始用简单的方法求解Apriori算法？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-solve-the-apriori-algorithm-in-a-simple-way-from-scratch-9540cfc5c11a?source=collection_archive---------7-----------------------#2022-06-19">https://levelup.gitconnected.com/how-to-solve-the-apriori-algorithm-in-a-simple-way-from-scratch-9540cfc5c11a?source=collection_archive---------7-----------------------#2022-06-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8c0a994e92ebf5af02de1c44978c6211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jAv5qpTW930FA629StRcUA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图像<a class="ae kc" href="https://www.journaldev.com/44792/apriori-algorithm" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><blockquote class="kd ke kf"><p id="f3d1" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">注意:图片的所有内容，包括表格、计算和代码都已经被我研究过了，没有必要引用任何参考资料。</p></blockquote><h1 id="b2c8" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">介绍</h1><p id="f8d1" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated"><a class="ae kc" href="https://www.javatpoint.com/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>有几种方法，如<a class="ae kc" href="https://deepai.org/machine-learning-glossary-and-terms/association-learning" rel="noopener ugc nofollow" target="_blank">关联</a>、<a class="ae kc" href="https://medium.com/analytics-vidhya/what-is-correlation-4fe0c6fbed47" rel="noopener">关联</a>、<a class="ae kc" href="https://towardsdatascience.com/machine-learning-classifiers-a5cc4e1b0623" rel="noopener" target="_blank">分类</a> &amp; <a class="ae kc" href="https://machinelearningmastery.com/clustering-algorithms-with-python/" rel="noopener ugc nofollow" target="_blank">聚类</a>，本教程主要侧重于使用关联规则进行学习。通过关联规则，我们可以识别在一个表中同时出现的项目或属性的集合[1]。</p><h1 id="6abc" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">关联规则学习</h1><p id="6885" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated"><a class="ae kc" href="https://deepai.org/machine-learning-glossary-and-terms/association-learning" rel="noopener ugc nofollow" target="_blank">关联</a>规则学习是<a class="ae kc" href="https://www.javatpoint.com/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>中非常重要的概念之一，应用于<strong class="kj ir">购物篮分析、Web使用挖掘、连续生产等。</strong>这里的购物篮分析是各大零售商用来发现商品之间关联的一种技术。我们可以以超市为例来理解，因为在超市里，所有一起购买的产品都放在一起[2]。</p><p id="dedc" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">关联规则学习可以分为三类算法[2]:</p><ol class=""><li id="e9bb" class="ml mm iq kj b kk kl ko kp mf mn mh mo mj mp le mq mr ms mt bi translated"><strong class="kj ir">先验</strong></li><li id="a8c8" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated">Eclat </li><li id="e8d0" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated"><strong class="kj ir"> F-P增长算法</strong></li></ol><h1 id="d539" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">先验导论</h1><p id="c6b7" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">Apriori是一个用于关联规则学习的<a class="ae kc" href="https://www.britannica.com/science/computer-science/Algorithms-and-complexity" rel="noopener ugc nofollow" target="_blank">算法</a>。它在数据集中搜索一系列频繁出现的项目集。它建立在项目集之间的关联和相关性上。这就是你在推荐平台上常见的“你可能也会喜欢”背后的算法[3]。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/e9bc25573b00c62ea0d571279599f5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ivVrrcaltUDoVzWdw0748A.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图1。</strong>先验[3]</figcaption></figure><h2 id="08c4" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">什么是Apriori算法？</h2><p id="0da5" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">Apriori <a class="ae kc" href="https://www.britannica.com/science/computer-science/Algorithms-and-complexity" rel="noopener ugc nofollow" target="_blank">算法</a>假设一个频繁项集的任何子集一定是频繁的。比方说，包含{牛奶，鸡蛋，面包}的交易也包含{鸡蛋，面包}。所以，根据先验原理，如果{牛奶，鸡蛋，面包}是频繁的，那么{鸡蛋，面包}也一定是频繁的[4]。</p><h1 id="30f2" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">Apriori算法是如何工作的？</h1><p id="e5bb" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">为了从这个小型企业场景的多个可能规则中选择出感兴趣的规则，我们将使用以下方法[4]:</p><ul class=""><li id="e925" class="ml mm iq kj b kk kl ko kp mf mn mh mo mj mp le nq mr ms mt bi translated"><strong class="kj ir">支持</strong></li><li id="b453" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated"><strong class="kj ir">信心</strong></li><li id="0caa" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated"><strong class="kj ir">抬起</strong></li><li id="2bad" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated"><strong class="kj ir">定罪</strong></li></ul><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3f07f013a9ad72d4bd1731330b6edaf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*xMlBaEFymfCS7JtFDg3svQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图2。Apriori算法工作[7] </strong></figcaption></figure><h1 id="4d9a" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">支持</h1><p id="f871" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">对项目<em class="ki"> x </em>的支持无非是项目<em class="ki"> x </em>出现的交易数占总交易数的比例。</p><h1 id="cc3c" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">信心</h1><p id="4e8a" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">置信度(<em class="ki"> x </em> = &gt; <em class="ki"> y </em>)表示购买物品<em class="ki"> x </em>时，物品<em class="ki"> y </em>被购买的可能性。该方法考虑了项目<em class="ki"> x </em>的流行度。</p><h1 id="7531" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">电梯</h1><p id="665e" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">lift(<em class="ki">x</em>=&gt;<em class="ki">y</em>)无非是物品<em class="ki"> x </em>卖出时，物品<em class="ki"> y </em>被购买的‘兴趣度’或可能性。与置信度(<em class="ki"> x </em> = &gt; <em class="ki"> y </em>)不同，这种方法考虑了物品<em class="ki"> y </em>的流行度。</p><ul class=""><li id="d189" class="ml mm iq kj b kk kl ko kp mf mn mh mo mj mp le nq mr ms mt bi translated"><strong class="kj ir">Lift(<em class="ki">x</em>=&gt;T43】y)</strong>= 1表示项集内没有相关性。</li><li id="203d" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated"><strong class="kj ir">Lift(<em class="ki">x</em>=&gt;<em class="ki">y</em>)</strong>&gt;1表示项目集内部存在正<a class="ae kc" href="https://medium.com/analytics-vidhya/what-is-correlation-4fe0c6fbed47" rel="noopener">相关性</a>，即项目集中的产品，<em class="ki"> x </em>和<em class="ki"> y </em>更有可能被一起购买。</li><li id="b175" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated"><strong class="kj ir">Lift(<em class="ki">x</em>=&gt;<em class="ki">y</em>)</strong>&lt;1表示项集内部存在负的<a class="ae kc" href="https://medium.com/analytics-vidhya/what-is-correlation-4fe0c6fbed47" rel="noopener">相关性</a>，即项集、<em class="ki"> x </em>和<em class="ki"> y </em>中的产品不太可能一起购买。</li></ul><h1 id="f126" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">定罪</h1><p id="7bb3" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">对规则的确信可以定义如下:</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/3dfb067351b0d6fd6d8e91a5362ff7f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:218/format:webp/0*BirEb6MzYN2WP8-i.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图三。</strong>定罪公式[4]</figcaption></figure><p id="633b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">其取值范围为[0，+∞]。</p><ul class=""><li id="ab8c" class="ml mm iq kj b kk kl ko kp mf mn mh mo mj mp le nq mr ms mt bi translated"><strong class="kj ir">conv(<em class="ki">x</em>=&gt;<em class="ki">y</em>)= 1</strong>表示<em class="ki"> x </em>与<em class="ki"> y </em>没有关系。</li><li id="c7ce" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated">信念越强，对规则的兴趣就越高。</li></ul><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/b133e32cb8f47dc51c3a7e632167a6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3eQ7CesIRbMiZ2JePUdpjA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图4。关联规则X ⟹ Y [5]的支持度、置信度和提升度公式</strong></figcaption></figure><h1 id="9f7e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">现在，我们想用一种简单的方法来解决Apriori算法的一个问题:</h1><h2 id="6262" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">部分(a):将先验<a class="ae kc" href="https://www.britannica.com/science/computer-science/Algorithms-and-complexity" rel="noopener ugc nofollow" target="_blank">算法</a>应用于以下数据集:</h2><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/cbea7a90c95a85f03cc96c85e01fb2b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_wzA0N-ytk6ya9R9nNi3A.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图五。这套物品包括牛奶、面包、鸡蛋、饼干、咖啡和果汁</strong></figcaption></figure><h2 id="2142" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第一步:</h2><p id="f9ed" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">在第一步中，我们索引数据，然后计算每个数据的支持度，如果支持度小于最小值，我们就从表中删除它。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/87ddf26b53506cb2d5436845f47ad3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sZy0tdalHYz3AXYDqfMfA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图六。索引数据</strong></figcaption></figure><h2 id="0513" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第二步:</h2><p id="cf7d" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">计算每一项的支持度</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/2d35bc76962cb01e12b02d8b75d5b264.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xiO6tZqDLeHOc1ED5XyMTg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图7。计算每个人的支持度</strong></figcaption></figure><h2 id="777c" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第三步:</h2><p id="e452" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">继续计算支持度并选择最佳答案</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/2d8401b3e5a9fe9f8b76801717366ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhKcwrfIPAlvsVIpXUYiJQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图8。继续计算支持度并选择最佳答案</strong></figcaption></figure><h2 id="36fc" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第(b)部分:显示对于包含第a部分中三个项目的项目集，置信度为70%或更高的两个规则。</h2><h2 id="fb51" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第一步:</h2><p id="a458" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">计算置信度并遵循(b)部分的问题规则</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/420fd739f458256aad43a4f69b0872a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hr34WAD1r3QMyEdJt31Mdg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图9。计算置信度</strong></figcaption></figure><h2 id="4b24" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第二步:</h2><p id="da28" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">除了上面的规则，还可以考虑下面的，但是问题中只需要两个规则进行计算。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/0a2ea417752ebf99c61d1a7fefe354c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*spVbFUgjYhFu_aS9UHoSRw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图10。置信度为70%或更高的规则</strong></figcaption></figure><h1 id="d346" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">动手操作:Python中的Apriori算法——购物篮分析</h1><h2 id="135a" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">问题陈述:</h2><p id="c4e0" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">对于Apriori算法的实现，我们使用从超市收集的数据，其中每一行表示在特定交易中购买的所有商品。</p><blockquote class="kd ke kf"><p id="55fe" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">一家零售店的经理试图找出物品之间的关联规则，以找出哪些物品更经常一起购买，以便他可以将这些物品放在一起以增加销售额。<br/>数据集有7500个条目。驱动链接下载<a class="ae kc" href="https://drive.google.com/file/d/1nGzgX2cq8R4AT-9cMq_puzB1XgPnb6Pf/view" rel="noopener ugc nofollow" target="_blank"> <strong class="kj ir">数据集</strong></a>【4】【6】。</p></blockquote><h1 id="2d37" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">环境设置:</h1><p id="d731" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">在我们继续之前，我们需要首先在命令提示符下安装‘a pyori’包。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b1377de736155969794d94e8495d0667.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*BuwVTV6dcOW1PuzKiriuJA.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图11。环境设置</strong></figcaption></figure><h1 id="0115" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">Python中的购物篮分析实现</h1><p id="5d83" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">在Apriori包的帮助下，我们将实现Apriori算法，以帮助经理进行购物篮分析。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/c2e808dc8641b6a0bc30e6282d0c9de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uUTyXbR7RgRsfoJ4LBmP1A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图12。哪些物品应该放在一起？[4] </strong></figcaption></figure><h2 id="67bb" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">步骤1:我们导入实现所需的必要库</h2><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="8ef4" class="ne lg iq oc b gy og oh l oi oj">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><h2 id="3b88" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">步骤2:加载数据集</h2><p id="01f5" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">现在，我们必须继续读取现有的数据集，即csv格式的数据集。我们使用pandas模块的read_csv函数[6]来实现。</p><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="a27e" class="ne lg iq oc b gy og oh l oi oj">dataset = pd.read_csv("Market_Basket_Optimisation.csv")</span></pre><h2 id="1130" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第三步:看一眼记录</h2><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="1527" class="ne lg iq oc b gy og oh l oi oj">dataset</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/55f49dc6b2a5130ad2324e5eff914bc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mrpqFNkKU-ZWYI34Q1NXtw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图13。看一眼记录</strong></figcaption></figure><h2 id="870a" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第四步:看形状</h2><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="2630" class="ne lg iq oc b gy og oh l oi oj">dataset.shape</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/17e0557d16f823a0849c726f0afb9153.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*swSlLVk1x8N0uvadS8IBJg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图十四。数据集形状</strong></figcaption></figure><h2 id="9144" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">步骤5:将熊猫数据帧转换成一个列表列表</h2><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="b897" class="ne lg iq oc b gy og oh l oi oj">transactions = []<br/>for i in range(0, 7501):<br/> transactions.append([str(dataset.values[i,j]) for j in range(0,20)])</span></pre><h2 id="a8ea" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">步骤6:构建先验模型</h2><p id="819a" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">我们从apriori模块导入apriori函数。我们将先验函数的结果输出存储在“rules”变量中。<br/>对于apriori函数，我们传递6个参数:</p><ol class=""><li id="d2ed" class="ml mm iq kj b kk kl ko kp mf mn mh mo mj mp le mq mr ms mt bi translated">交易清单作为主要输入</li><li id="c102" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated">最小支持，我们将其设置为0.003，我们通过考虑一个产品应该在一天内至少出现3次交易来获得该值。我们的数据是在一周内收集的。因此，支持值应该是3*7/7500 = 0.0028</li><li id="2b83" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated">最小置信度，我们选择为0.2(通过分析各种结果获得)</li><li id="f883" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated">最小升力，我们设置为3</li><li id="59de" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated">最小长度设置为2，因为我们在计算购买商品B的提升值时，假设购买了另一个商品A，所以我们考虑2个商品。</li><li id="f5fb" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated">使用相同的逻辑[6]将最小长度设置为2。</li></ol><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="516a" class="ne lg iq oc b gy og oh l oi oj">from apyori import apriori<br/>rules = apriori(transactions = transactions, min_support = 0.003, min_cinfidence = 0.2, min_lift = 3, min_length = 2, max_length = 2)</span></pre><h2 id="6d89" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第7步:打印出列表中的规则数</h2><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="4fa2" class="ne lg iq oc b gy og oh l oi oj">results = list(rules)</span></pre><h2 id="8f23" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">第八步:浏览一下规则</h2><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="8c97" class="ne lg iq oc b gy og oh l oi oj">results</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/2ae6635fa674c87b0bb51fb03c217e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9yP3WCtRQqm5omDNuqDEFg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图15。我们将结果打印成一个列表</strong></figcaption></figure><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/c13d11104133f5b01ccb781f9070171e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0xyxcrJhOTncryWyJ7BJyQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图十六。购物篮分析[4] </strong></figcaption></figure><h2 id="70b9" class="ne lg iq bd lh nf ng dn ll nh ni dp lp mf nj nk lt mh nl nm lx mj nn no mb np bi translated">步骤9:可视化结果</h2><p id="865c" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">在<strong class="kj ir"> LHS </strong>变量中，我们存储所有结果中的第一个项目，从中我们获得在该项目已经被购买之后购买的第二个项目，该项目现在存储在<strong class="kj ir"> RHS </strong>变量中。<br/><strong class="kj ir">支持度、置信度和升力</strong>存储来自结果【6】的所有支持度、置信度和升力值。</p><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="8fd0" class="ne lg iq oc b gy og oh l oi oj">def inspect(results):<br/>    lhs         =[tuple(result[2][0][0])[0] for result in results]<br/>    rhs         =[tuple(result[2][0][1])[0] for result in results]<br/>    supports    =[result[1] for result in results]<br/>    confidences =[result[2][0][2] for result in results]<br/>    lifts        =[result[2][0][3] for result in results]<br/>    return list (zip(lhs, rhs, supports, confidences, lifts))<br/>resultsinDataFrame = pd.DataFrame(inspect(results), columns = ["Left hand side", "Right hand side", "Support", "Confidence", "Lift"])</span></pre><p id="215c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">最后，我们将这些变量存储到一个数据帧中，这样它们更容易可视化。</p><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="5214" class="ne lg iq oc b gy og oh l oi oj">resultsinDataFrame</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/4cef9a763add1d57983c5d97bf965674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*ul8ANc0j0DRUOyY7K57R8Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图17。变量放入一个数据帧</strong></figcaption></figure><p id="b4d9" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><strong class="kj ir">现在</strong>，我们按照电梯的降序对这些最终输出进行排序。</p><pre class="na nb nc nd gt ob oc od oe aw of bi"><span id="3bed" class="ne lg iq oc b gy og oh l oi oj">resultsinDataFrame.nlargest(n = 10, columns = "Lift")</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/339ff714bea2a76d1946ed3f637f4543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*q7WRCVGcxpRTv0WFhlETMA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图18。对这些最终输出进行排序</strong></figcaption></figure><p id="b5d1" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">这是我们用python实现apriori的最终结果。超市将利用这些数据来促进他们的销售，并优先考虑提供具有更大提升值的一对商品[6]。</p><h1 id="0f3f" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">为什么是先验的？</h1><ol class=""><li id="15a3" class="ml mm iq kj b kk md ko me mf oq mh or mj os le mq mr ms mt bi translated">是一种易于实现，易于理解的算法。</li><li id="b09c" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le mq mr ms mt bi translated">它可以很容易地在大型数据集上实现。</li></ol><h1 id="f514" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">Apriori算法的局限性</h1><p id="6e6c" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">尽管Apriori算法很简单，但它也有一些局限性，包括:</p><ul class=""><li id="ed52" class="ml mm iq kj b kk kl ko kp mf mn mh mo mj mp le nq mr ms mt bi translated">处理大量具有频繁项集的候选项时浪费时间。</li><li id="6423" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated">当通过有限的存储器容量进行大量事务时，该算法的效率下降。</li><li id="54fd" class="ml mm iq kj b kk mu ko mv mf mw mh mx mj my le nq mr ms mt bi translated">需要高计算能力，需要扫描整个数据库[4]。</li></ul><h1 id="b816" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">摘要</h1><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ot"><img src="../Images/757f34cf69615b44e0c625980858b5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MIXTYPvJwc7uU01LR397jQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd lh">图19。Apriori算法流程图[8] </strong></figcaption></figure><p id="a2a9" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">关联规则学习是一种无监督学习技术，它检查一个数据项对另一个数据项的依赖性，并相应地进行映射，以便它可以更有利可图。它试图在数据集的变量之间找到一些有趣的关系或关联。它基于不同的规则来发现数据库中变量之间的有趣关系。上面的流程图将有助于总结算法的整个工作过程[2]。</p><blockquote class="kd ke kf"><p id="2248" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><a class="ae kc" href="https://github.com/parisa-ahmadi/DataScience-MachineLearning-Projects" rel="noopener ugc nofollow" target="_blank"> Github完整代码库</a></p></blockquote><h1 id="6f95" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">参考资料:</h1><p id="0b6a" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">[1]https://www.softwaretestinghelp.com/apriori-algorithm/<a class="ae kc" href="https://www.softwaretestinghelp.com/apriori-algorithm/" rel="noopener ugc nofollow" target="_blank"/></p><p id="ab9a" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">[2]https://www.javatpoint.com/association-rule-learning<a class="ae kc" href="https://www.javatpoint.com/association-rule-learning" rel="noopener ugc nofollow" target="_blank"/></p><p id="a960" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">[3]<a class="ae kc" href="https://towardsdatascience.com/underrated-machine-learning-algorithms-apriori-1b1d7a8b7bc" rel="noopener" target="_blank">https://towardsdatascience.com/underrated-machine-learning-算法-apriori-1b1d7a8b7bc </a></p><p id="f8b5" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">[4]<a class="ae kc" href="https://intellipaat.com/blog/data-science-apriori-algorithm/" rel="noopener ugc nofollow" target="_blank">https://intelli paat . com/blog/data-science-apriori-algorithm/</a></p><p id="6c47" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">[5]用户参与实验驱动软件开发的模式，作者。(s .亚曼)，(f .法格霍尔姆)，(m .穆尼塞罗)，(T .马尼斯特)。2019年12月，<a class="ae kc" href="https://www.journals.elsevier.com/information-and-software-technology" rel="noopener ugc nofollow" target="_blank">https://www . journals . Elsevier . com/information-and-software-technology</a></p><p id="c04d" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">[6]<a class="ae kc" href="https://djinit-ai.github.io/2020/09/22/apriori-algorithm.html#understanding-our-used-case" rel="noopener ugc nofollow" target="_blank">https://djinit-ai . github . io/2020/09/22/apriori-algorithm . html # understanding-our-use-case</a></p><p id="0f39" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><a class="ae kc" href="https://www.datacamp.com/tutorial/market-basket-analysis-r" rel="noopener ugc nofollow" target="_blank">https://www.datacamp.com/tutorial/market-basket-analysis-r</a></p><p id="aaa3" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">[8]<a class="ae kc" href="https://www.researchgate.net/figure/Flowchart-of-Apriori-algorithm_fig2_351361530" rel="noopener ugc nofollow" target="_blank">https://www . researchgate . net/fig/flow-of-Apriori-algorithm _ fig 2 _ 351361530</a></p><h1 id="2fc8" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak">作者:帕里桑·艾哈迈迪</strong></h1><p id="3cdd" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">联系人:<a class="ae kc" href="https://medium.com/@parisan.ahmadi" rel="noopener">中</a>、<a class="ae kc" href="https://github.com/parisa-ahmadi" rel="noopener ugc nofollow" target="_blank"> Github </a>、<a class="ae kc" href="https://www.kaggle.com/parisanahmadi" rel="noopener ugc nofollow" target="_blank"> Kaggle </a></p><div class="ou ov gp gr ow ox"><a href="https://medium.com/@parisan.ahmadi" rel="noopener follow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ir gy z fp pc fr fs pd fu fw ip bi translated">Parisan Ahmadi -中型</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">解决Apriori算法问题a .将Apriori算法应用于以下数据集:答案:在第一个…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">medium.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl jw ox"/></div></div></a></div><div class="ou ov gp gr ow ox"><a href="https://github.com/parisa-ahmadi" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ir gy z fp pc fr fs pd fu fw ip bi translated">parisa-ahmadi -概述</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">github.com</p></div></div><div class="pg l"><div class="pm l pi pj pk pg pl jw ox"/></div></div></a></div><div class="ou ov gp gr ow ox"><a href="https://www.kaggle.com/parisanahmadi" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ir gy z fp pc fr fs pd fu fw ip bi translated">Parisan Ahmadi |新手</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">Parisan Ahmadi的Kaggle简介</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">www.kaggle.com</p></div></div><div class="pg l"><div class="pn l pi pj pk pg pl jw ox"/></div></div></a></div></div></div>    
</body>
</html>