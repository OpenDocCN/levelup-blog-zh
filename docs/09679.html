<html>
<head>
<title>Debugging Scripts in Unity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Unity中调试脚本</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/debugging-code-in-unity-cf6d7d46037?source=collection_archive---------10-----------------------#2021-09-01">https://levelup.gitconnected.com/debugging-code-in-unity-cf6d7d46037?source=collection_archive---------10-----------------------#2021-09-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="34d5" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">进入奥金人</h2><div class=""/><div class=""><h2 id="c260" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">//超越调试。登录并进入代码编辑器</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/89fc88551457e035cf795504488c4be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HuX45wC2usPLCYvWdQpW0A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">我们有一只虫子要踩扁</figcaption></figure><p id="347c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你上过任何关于如何在Unity中制作游戏的在线课程或看过YouTube视频，你会遇到使用<strong class="lj jd"> Debug的建议。Log() </strong>或<strong class="lj jd">调试。LogError() </strong>以便对您正在制作的游戏进行故障排除。现在我不是在这里告诉你停止使用它们，当你意识到在哪里寻找时，它们在孤立的小问题上是有帮助的，但是你会发现自己浪费了很多时间在脚本中放入和删除它们。它们使用起来很贵，而且会造成不必要的混乱。</p><p id="1001" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">还有更好的办法！</strong></p><p id="652d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果您以前从未编写过代码，那么调试的概念对您来说可能是陌生的。没关系。这真的不是很难开始，这就是我们今天要做的。</p><h2 id="3300" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">概观</h2><p id="8733" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">调试代码是在代码运行时遍历代码以查看是否出现预期结果的实践。当您不确定问题的确切来源时，这尤其方便。</p><p id="5b4c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">大多数现代ide都允许您使用调试工具。今天的文章不是关于选择最好的IDE。我将使用JetBrains Rider，因为它是我的首选编辑器，可以轻松地与Unity集成。然而，如果你安装了合适的插件，VS代码也可以调试Unity脚本。Visual Studio也有能力执行这些相同的功能。</p><p id="d07a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你可以在<a class="ae na" href="https://docs.unity3d.com/Manual/ManagedCodeDebugging.html" rel="noopener ugc nofollow" target="_blank">Unity-Manual:调试Unity(unity3d.com)中的C#代码</a>上阅读更多关于设置你最喜欢的over的细节</p><h2 id="7121" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">开始—添加断点</h2><p id="5d8e" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">我假设你已经安装了你选择的IDE，并且正在使用Unity。如前所述，我正在使用JetBrains Rider 2021，因此从现在开始的所有步骤都将使用JetBrains。</p><p id="b800" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先，我们需要打开想要调试的脚本，并设置一些断点。</p><p id="7fd5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> <em class="nb">断点</em></strong><em class="nb">——这是代码自动停止执行的地方，需要你一行一行的逐步执行。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/90d5c8ec4f0090e7c7b1da8f4e9a4d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9I01-SeLGS5xupmvDykxaA.gif"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">设置断点</figcaption></figure><p id="6b4c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">设置断点很简单，并且在大多数代码编辑器中都是一样的。</p><p id="65cb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里有一个我想调试的方法。现在我可以添加调试。在我想查看的每个位置将Log()消息记录到控制台，但是正如我提到的，这太慢了。因此，我将设置一个断点，以便进行调试。</p><p id="8f84" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">断点表示为添加到窗口中的小红圈。我移动鼠标找到我想要的点，然后左键点击添加断点。</p><p id="8b40" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">好，这就是我要停止代码执行的地方，这样我就可以调试了。</p><p id="32d8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们继续之前，请注意我们可以在整个代码中添加多个断点。这在以后会变得很方便。</p><h2 id="a61f" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">在调试模式下运行场景</h2><p id="40cd" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">断点在哪里？检查。让我们调试这个坏男孩，并确保事情按预期运行。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/c7b876e5a6442611e39911bfc82c5127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZoxnPXfHuU6-RAZCBxTUjw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">工具栏中的调试按钮</figcaption></figure><p id="deba" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先，我们可以按下位于右上角工具栏中的<strong class="lj jd">调试</strong>按钮。这与在Unity中点击播放按钮是一样的。编辑器将连接到Unity并告诉它运行，你的游戏将正常运行，直到它到达断点。这恰好是我的玩家的伤害方法被调用的时候，所以让我们看看实际情况。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e40e96cb1bbb99355e827076fa5a223e.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*PSKB-B1IUar9vcyEoldJGA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">Unity引擎询问你想做什么</figcaption></figure><p id="10e8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果这是你第一次使用脚本调试，那么Unity会提示你选择一个选项。仅针对此会话，下次重新打开Unity并尝试调试时会询问您，并且所有项目将始终调试而不显示此窗口。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nf"><img src="../Images/65863fab9e9d2b03b924695ae1e0c6a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hwrNE4ln9Ccgks9te6YBzQ.gif"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">运行直到停止</figcaption></figure><p id="3721" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">游戏一直运行到玩家受到伤害。当飞船撞上玩家模型时就会发生这种情况。注意到游戏如何冻结了吗？这是我们希望发生的。现在，如果我们跳回我们选择的编辑器，我们应该注意到一些变化。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ng"><img src="../Images/7179d16a32f1f9a4a98af8299f71a70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*30o1NxzdM2PR14wtHXpESA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">代码在断点处停止</figcaption></figure><p id="d5ff" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">注意到箭头了吗？选中标记的断点和突出显示的行？这意味着我们的代码目前停止在这个位置。它不能继续下去，直到我们告诉它这样做。我们在屏幕上也有一个新的窗口(还是JetBrains Rider ),叫做Debugger。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nh"><img src="../Images/02f84ae057c0ba31f1507c55ba1b0fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQBYFqVSJk8wVW0lj_99Vg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">调试器</figcaption></figure><p id="f2c1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">让我们从左到右分解这个屏幕，我们将最后覆盖顶部工具栏。</p><p id="29ed" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最左边的按钮是程序的主要控件。您可以将鼠标悬停在这些按钮上，查看每个按钮的作用，但对于我们的目的来说，唯一重要的是看起来像暂停/播放按钮的绿色按钮。这是“恢复代码”按钮，如果我们单击此按钮，代码将自动重新开始运行。</p><p id="2e44" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">第二个面板是堆栈，上面是我们的相关代码片段。栈不在本文讨论范围之内，请注意，您可以通过它来查看许多东西的当前状态。突出显示的项目在下一个面板中为我们提供了有关它的详细信息。</p><p id="66e3" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">第三个面板是堆栈中所选项目的详细信息。在这种情况下，恰好是我的<strong class="lj jd">玩家移动。</strong>法伤害()。注意，我还可以看到关于调用我的断点的方法的信息，即<strong class="lj jd"> EnemyAI。OnTriggerEnter() </strong>方法。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ni"><img src="../Images/16f5bfab7710f013e4fb4e164ae9bfda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M19AN2hYJbIUrKUuFzXCzw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">展开当前项目的信息。</figcaption></figure><p id="42ca" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，我可以在最后一个面板中看到关于该方法的信息。这些信息是断点时刻的数据，所以当我单步执行代码时，它可能会改变。如果我展开<em class="nb">这个</em>项，它会告诉我关于当前脚本的所有信息。这些项目中的许多也可以向下钻取。</p><p id="fa2c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，我们有顶部菜单栏。我们将更详细地讨论这一点。我们关心的部分是这一小部分:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/58c287cac8a640322cfd9c3ca28b36da.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*noqfK5GdQg2mbcpwecJocA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">调试控件</figcaption></figure><p id="b78e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里也有几个按钮，出于我们的目的，我们将只看这篇文章需要的基础知识。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1dda4d63dc365be0c889f3114a1dba50.png" data-original-src="https://miro.medium.com/v2/resize:fit:58/format:webp/1*SlnXszk_sG4gOrWrbJ9Qrg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">跳到光标处</figcaption></figure><p id="b295" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">跳转到光标处按钮正如它所说的那样，它将代码跳转到光标处。它不会执行断点和光标之间的任何代码。如果您认为是一行代码导致了问题，并想跳过它，这是很方便的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/3194c6482c0e50f1b7904991adc899bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:44/format:webp/1*-JiXKIDO1_8jVw3SnTcmzA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">运行到光标处</figcaption></figure><p id="8fc1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">同样，如果您认为光标和断点之间的代码行是问题所在，这也很方便。这将只运行允许您查看问题在执行时是否重现的代码部分。</p><p id="de16" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你认为你知道问题在哪里，这两个很好。如果你迷路了就不会了。这就是这些的来源。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/f48dab03bbed8e6970c625375531fee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:254/format:webp/1*6znnFG3jlAV0yceKUZLJTA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">踩过去，用力踩过去，踩进去，聪明的踩进去，踩出来</figcaption></figure><p id="eee1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">跨过</strong>——弯曲的蓝色箭头，移动到方法中的下一行代码。连续单击此按钮或按下键盘快捷键将一行一行地通过代码。如果你有一个非常简单的代码块，不会跳转到其他任何地方，这很有帮助。这将跳过其他脚本中的其他方法，因此得名。</p><p id="96bf" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">进入</strong> —直接向下的单箭头，可以跳转到其他脚本。使用它会让您进入另一个脚本来调试该脚本。使用时要小心，因为如果你什么都不做，你会很快发现自己在引擎代码或网络代码中。只有在需要跳转到其他代码进行调试时才使用它。</p><p id="4ab9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">步出</strong> —直上箭头。当你在你不想进入的其他代码中，或者在你已经调试了你需要在那个方法中调试的代码部分之后，这是很方便的。“单步执行”会将您带回到最初的起始位置，因此您不必单步执行额外的代码。</p><p id="a260" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其他两个按钮有他们的用途，但我们现在不担心这些。</p><h2 id="023a" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">在活动</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nn"><img src="../Images/7edf1f12e2813685695af63b3dfe747d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AqTG3mKf0j3W3Zse7AUw9A.gif"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">在行动中超越</figcaption></figure><p id="d0c4" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先，我们单步执行一些代码，然后使用鼠标来查看是否发生了预期的变化。生命值确实被设定为力量等级的值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi no"><img src="../Images/44aebd3bb17a8543dd8a77a3fbe6e33b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ltPyeAvlUOJd1pY_fTgNaw.gif"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">运行到光标处</figcaption></figure><p id="1123" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在这里，我使用内联控件中的Run to Cursor来跳过switch语句。然后检查之后的值。我的异能水平是-1所以0确实是我想要的结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi np"><img src="../Images/3fc13580bdcf30dc8386b2f1f8b8c7d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wjT4QULteLoHlZE0Ojg9Kg.gif"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">走进走出</figcaption></figure><p id="f35e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，我使用Step Into跳转到UpdatePlayerState()方法，意识到这不是一个问题，并退出以返回到我的代码。</p><p id="d22b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在，这个代码不是最好的代码。但是我也没有在里面追踪什么特别的bug。这只是向您展示控件的演示。</p><h2 id="9d10" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">结论</h2><p id="d42a" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">使用您最喜欢的IDE中的调试工具可以让您比Debug.Log更快地定位错误。我在JetBrains Rider中使用的所有控件都可以在Visual Studio和VS代码中使用。使用这些控件以及鼠标悬停信息和堆栈中的详细信息是快速修复问题的有效方法。你调试得越多，你就能更好地修复和预防它们。</p><p id="f676" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">作为一名Unity游戏开发者，希望这能给你的工具箱增加更多的东西。</p></div></div>    
</body>
</html>