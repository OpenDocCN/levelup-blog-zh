<html>
<head>
<title>The ultimate guide to modern web application performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代web应用程序性能的终极指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-ultimate-guide-to-modern-web-application-performance-ec4eec9939?source=collection_archive---------1-----------------------#2020-10-15">https://levelup.gitconnected.com/the-ultimate-guide-to-modern-web-application-performance-ec4eec9939?source=collection_archive---------1-----------------------#2020-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5055f02803a951558d5ec49eb350ec0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tYVhmkjI0cbH6Yc3.jpg"/></div></div></figure><p id="1448" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我开始写这篇文章的时候，我没有想到它会这么长。无论如何，我希望它能帮助你提高应用程序的性能。祝你好运！</p><h1 id="9bdf" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">目录</h1><p id="ca7f" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><em class="lz">在这里，您只能找到主要部分，因为所有子部分的列表太长了，大约有107个。</em></p><p id="5744" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 1。压缩算法</strong></p><p id="015f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 2。代码拆分和延迟加载</strong></p><p id="3c86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 3。懒惰或部分水合</strong></p><p id="e451" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 4。树抖动—死码消除</strong></p><p id="bfc0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 5。Javascript缩小和优化工具</strong></p><p id="33bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 6。库交换</strong></p><p id="3ec2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 7。图像</strong></p><p id="0cf7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 8。字体</strong></p><p id="b608" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 9。布局重新计算</strong></p><p id="296f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 10。外部脚本</strong></p><p id="07b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">11。前期战略</p><p id="d4b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">12。协议</p><p id="28fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">13。缓存</p><p id="a398" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">14。有用的工具</p><h1 id="0662" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">1.压缩算法</h1><p id="7208" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">为了最小化提供给客户端的文件的大小，你可以使用不同的压缩算法。在<a class="ae ma" href="https://developers.google.com/web/tools/lighthouse" rel="noopener ugc nofollow" target="_blank">灯塔</a>里面有一个叫做<code class="fe mb mc md me b">Enable text compression</code>的部分。在这里，您可以找到您提供了额外压缩的文件，或者您的第三方脚本是否提供了压缩。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/dabbd44740da199f08d3da3065181385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xhhoq_B6VKZaKagQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://web.dev/uses-text-compression/" rel="noopener ugc nofollow" target="_blank">https://web.dev/uses-text-compression/</a></figcaption></figure><h2 id="c705" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">1.1.Gzip</h2><p id="e27c" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae ma" href="https://tools.ietf.org/html/rfc1952" rel="noopener ugc nofollow" target="_blank"> Gzip </a>采用了<a class="ae ma" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wusp/fb98aa28-5cd7-407f-8869-a6cef1ff1ccb" rel="noopener ugc nofollow" target="_blank"> LZ77 </a>和<a class="ae ma" href="https://web.stanford.edu/class/archive/cs/cs106b/cs106b.1126/handouts/220%20Huffman%20Encoding.pdf" rel="noopener ugc nofollow" target="_blank">霍夫曼编码</a>压缩技术。大多数web浏览器和客户端都支持它。您可以设置服务器使用动态或静态压缩。与动态压缩您的文件被压缩的飞。使用静态压缩，您需要在构建过程中压缩文件。</p><p id="4fc1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Gzip的压缩率大约为44%,如下一节所示。</p><h2 id="daa6" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">无压缩</h2><p id="5657" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">传输了445.57 KB，加载时间为329毫秒</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/c393028b809ddb5790fca0d134696bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zAZKceubFgw8gWyC.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://www.pingdom.com/blog/can-gzip-compression-really-improve-web-performance/" rel="noopener ugc nofollow" target="_blank">https://www . pingdom . com/blog/can-gzip-compression-really-improve-web-performance/</a></figcaption></figure><h2 id="a5c0" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated"><strong class="ak">动态压缩</strong></h2><p id="7af2" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">传输197.6 KB，加载时间为281毫秒</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/7f7c2d38d24f5db845bbc8afddc43ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*q7FwgaqivQeRod0N.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://www.pingdom.com/blog/can-gzip-compression-really-improve-web-performance/" rel="noopener ugc nofollow" target="_blank">https://www . pingdom . com/blog/can-gzip-compression-really-improve-web-performance/</a></figcaption></figure><h2 id="a682" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">静态压缩</h2><p id="ba88" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">传输197.2 KB，加载时间为287毫秒</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/c75d27c605c665797cc3ec9581aeb9ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WNruZRg-OaSwgmuw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://www.pingdom.com/blog/can-gzip-compression-really-improve-web-performance/" rel="noopener ugc nofollow" target="_blank">https://www . pingdom . com/blog/can-gzip-compression-really-improve-web-performance/</a></figcaption></figure><p id="0cc4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了实现更好的静态压缩，你可以使用像<a class="ae ma" href="https://github.com/google/zopfli" rel="noopener ugc nofollow" target="_blank"> Zopfli </a>或<a class="ae ma" href="https://www.7-zip.org/" rel="noopener ugc nofollow" target="_blank"> 7zip </a>这样的高级压缩器来生成你的gzip文件。</p><h2 id="48f4" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">1.2.布罗特利</h2><p id="0df9" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae ma" href="https://tools.ietf.org/html/rfc7932" rel="noopener ugc nofollow" target="_blank"> Brotli </a>是Google 开发的无损数据压缩算法<a class="ae ma" href="https://github.com/google/brotli" rel="noopener ugc nofollow" target="_blank">，最适合文本压缩。它使用了LZ77算法的现代变体、霍夫曼编码和二阶上下文建模的组合。</a></p><p id="6047" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据<a class="ae ma" href="https://certsimple.com/blog/nginx-brotli" rel="noopener ugc nofollow" target="_blank">证书样本</a>，</p><ul class=""><li id="3ba8" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">用Brotli压缩的Javascript文件比gzip小14%。</li><li id="4521" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">HTML文件比gzip小21%。</li><li id="6b44" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">CSS文件比gzip小17%。</li></ul><p id="9b07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">浏览器对Brotli算法的支持有点有限，因为它不支持IE11，但不要气馁，有一个解决方案。您可以设置一个回退到gzip的选项，如下一节所述。还有NodeJs &gt;11.7。在<a class="ae ma" href="https://nodejs.org/api/zlib.html#zlib_zlib_createbrotlicompress_options" rel="noopener ugc nofollow" target="_blank"> zlib </a>模块中有对brotli压缩的本地支持。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/f4c9698c110f666f8f4dbcbe8e39e9a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8xBe9OVDEywq-F1fKHbpfg.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/#feat=brotli" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/#feat=brotli</a></figcaption></figure><h2 id="48bc" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">在NodeJs服务器中实现静态Brotli压缩，并回退到gzip</h2><p id="3530" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><em class="lz">所描述的功能目前对express服务器有用，在这些服务器中，我们在</em> <a class="ae ma" href="https://www.npmjs.com/package/compression" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="lz">压缩</em> </strong> </a> <em class="lz">包中没有启用动态brotli压缩的选项。</em> <a class="ae ma" href="https://www.npmjs.com/package/compression" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="lz">压缩</em> </strong> </a> <em class="lz">库中接受brotli压缩的PR仍然打开:</em><a class="ae ma" href="https://github.com/expressjs/compression/pull/156" rel="noopener ugc nofollow" target="_blank"><em class="lz">【https://github.com/expressjs/compression/pull/156】</em></a><em class="lz">。</em></p><p id="5e62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了实现这一功能，我们需要完成两个步骤:</p><ol class=""><li id="a972" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv nq nh ni nj bi translated">用webpack生成<strong class="ka ir"> gzip </strong>和<strong class="ka ir"> brotli </strong>压缩文件</li><li id="091e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">根据请求头发送正确的文件</li></ol><p id="6292" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一步，我们需要使用两个webpack插件。<a class="ae ma" href="https://www.npmjs.com/package/compression-webpack-plugin" rel="noopener ugc nofollow" target="_blank">压缩-网络包插件</a>和<a class="ae ma" href="https://www.npmjs.com/package/brotli-webpack-plugin" rel="noopener ugc nofollow" target="_blank">brotli-网络包插件</a>。</p><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/compression-webpack-plugin" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">压缩-web pack-插件</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">准备资产的压缩版本，通过内容编码为它们服务。首先，您需要安装…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="oe l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/brotli-webpack-plugin" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">brot Li-web pack-插件</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">此插件使用Brotli压缩算法压缩资源，使用zlib、iltorb或brotli.js库提供…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="oj l of og oh od oi jw nu"/></div></div></a></div><p id="befd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">设置如下:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="53c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们需要完成第二步。根据我们使用的服务器，我们应该从以下工具中进行选择:</p><ul class=""><li id="dc6e" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">快递<a class="ae ma" href="https://www.npmjs.com/package/express-static-gzip" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/express-static-gzip</a></li><li id="a6ac" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">KOA<a class="ae ma" href="https://github.com/koajs/static" rel="noopener ugc nofollow" target="_blank">https://github.com/koajs/static</a></li></ul><p id="9b5e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下示例显示了<a class="ae ma" href="https://www.npmjs.com/package/express-static-gzip" rel="noopener ugc nofollow" target="_blank"> express-static-gzip </a>库的用法。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="f2ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过这两个步骤，我们现在能够根据请求头发送正确的压缩文件。</p><h2 id="270e" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">1.4.用于不同nodeJS服务器的压缩库</h2><ul class=""><li id="805e" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">快递<a class="ae ma" href="https://www.npmjs.com/package/compression" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/compression</a>支持gzip和deflate</li><li id="55e3" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">KOA<a class="ae ma" href="https://www.npmjs.com/package/koa-compress" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/koa-compress</a>支持gzip、deflate和brotli</li><li id="9cbb" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">fastify<a class="ae ma" href="https://www.npmjs.com/package/fastify-compress" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/fastify-compress</a>支持gzip、deflate和brotli</li></ul><h1 id="9e0f" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">2.代码分割和延迟加载</h1><p id="1559" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">通过代码分割，您的包可以被分割成更小的块。然后，您可以使用惰性加载技术来控制块加载。这也适用于CSS文件。</p><h2 id="df04" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.1.动态导入</h2><p id="cbf0" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果你使用动态导入，默认情况下web pack<strong class="ka ir">支持代码分割</strong>。这有助于您根据某些情况按需加载代码。动态导入返回一个承诺。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><div class="nr ns gp gr nt nu"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">进口</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">静态导入语句用于导入由另一个模块导出的只读活动绑定。已导入…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">developer.mozilla.org</p></div></div><div class="od l"><div class="op l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://webpack.js.org/guides/code-splitting/#dynamic-imports" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">代码分割| webpack</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">本指南扩展了入门和输出管理中提供的示例。请确保您至少…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">webpack.js.org</p></div></div><div class="od l"><div class="oq l of og oh od oi jw nu"/></div></div></a></div><p id="b03c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你正在使用<strong class="ka ir"> babel </strong>，你需要确保它能够通过使用<a class="ae ma" href="https://babeljs.io/docs/en/babel-plugin-syntax-dynamic-import" rel="noopener ugc nofollow" target="_blank">@ babel/plugin-syntax-dynamic-import</a>来解析<strong class="ka ir">动态导入语法</strong>。</p><div class="nr ns gp gr nt nu"><a href="https://babeljs.io/docs/en/babel-plugin-syntax-dynamic-import" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">@ babel/plugin-syntax-dynamic-导入Babel</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">NPM install-save-dev @ babel/plugin-syntax-dynamic-import { " plugins ":[" @ babel/plugin-syntax-dynamic-import "]} babel…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">babeljs.io</p></div></div></div></a></div><h2 id="86d6" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.2.粒状组块</h2><p id="9af5" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在Webpack 3中，引入了<a class="ae ma" href="https://webpack.js.org/plugins/commons-chunk-plugin/" rel="noopener ugc nofollow" target="_blank"> CommonsChunkPlugin </a>,使得在单个块中输出不同入口点之间共享的模块成为可能。这是一个很好的特性，但是它也有一些缺点。没有在每个入口点共享的模块也会被下载，即使它们没有被使用。</p><p id="9369" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">出于这个原因，在Webpack 4中，他们移除了那个插件，取而代之的是一个名为<a class="ae ma" href="https://webpack.js.org/plugins/split-chunks-plugin/" rel="noopener ugc nofollow" target="_blank"> SplitChunksPlugin </a>的新插件。这个插件的默认配置对大多数用户来说都很好。如果你喜欢实现更高级的配置，Next.js团队推出了一个名为粒度分块的特定配置。这意味着:</p><ul class=""><li id="7990" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">大型第三方模块(大于160 KB)被分割成各自独立的块</li><li id="1ff7" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">为框架依赖关系(<code class="fe mb mc md me b">react</code>、<code class="fe mb mc md me b">react-dom</code>等)创建一个单独的<code class="fe mb mc md me b">frameworks</code>块。)</li><li id="a4ff" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">根据需要创建尽可能多的共享块(最多25个)</li><li id="c318" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">要生成的块的最小大小更改为20 KB</li></ul><div class="nr ns gp gr nt nu"><a href="https://github.com/vercel/next.js/pull/7696" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">通过at castle Pull Request # 7696 ver cel/next . js实现粒度块</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">此PR在新的实验标志后面实现了#7631中描述的新Webpack SplitChunksPlugin配置…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="or l of og oh od oi jw nu"/></div></div></a></div><p id="1304" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这一策略提供了以下好处:</p><ul class=""><li id="5775" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><strong class="ka ir">改进页面加载时间</strong>。对于任何入口点来说，不需要的或重复的代码量被最小化。</li><li id="39d3" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir">改进了导航时的缓存</strong>。大型库和框架依赖项的缓存失效减少了，因为它们被分成了独立的块。</li></ul><p id="ea21" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<a class="ae ma" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>团队成功整合这一配置后<a class="ae ma" href="https://www.gatsbyjs.org/" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>曾经遵循同样的方法。</p><p id="21e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mb mc md me b">splitChunks</code>的webpack配置如下所示:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="aab4" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.3.React内置延迟加载</h2><p id="faad" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><strong class="ka ir"> React.lazy </strong>和<strong class="ka ir">悬念</strong>是您可以在React应用程序中使用的内置功能。React.lazy接受一个函数，该函数应该返回动态导入的组件。那么这个懒惰组件应该呈现在悬念组件内部。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><div class="nr ns gp gr nt nu"><a href="https://reactjs.org/docs/code-splitting.html#reactlazy" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">代码拆分—反应</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">大多数React应用程序会使用Webpack、Rollup或Browserify等工具“捆绑”文件。捆绑是一个过程…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">reactjs.org</p></div></div><div class="od l"><div class="os l of og oh od oi jw nu"/></div></div></a></div><p id="c868" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，只有当用户登录时，您才可以使用它来加载应用程序，否则显示登录页面:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="e19a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不幸的是，React.lazy和带有动态导入的悬念不能用于服务器端渲染。为此，还有其他几个软件包。</p><h2 id="afd9" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.4.用SSR应对延迟加载</h2><p id="f605" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">React官方文档推荐的包是<a class="ae ma" href="https://github.com/gregberge/loadable-components" rel="noopener ugc nofollow" target="_blank">可加载组件</a>库。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/gregberge/loadable-components" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">gregberge/可加载组件</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">React代码分割变得简单。在没有压力的情况下减少你的包裹尺寸，✂️ ✨.npm install @loadable/component参见…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="ot l of og oh od oi jw nu"/></div></div></a></div><p id="7783" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要使服务器端渲染工作，您需要安装以下软件包:</p><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="7a22" class="mo kx iq me b gy oy oz l pa pb"><em class="lz">npm</em> <em class="lz">install</em> @loadable/server &amp;&amp; <em class="lz">npm</em> <em class="lz">install</em> --save-dev @loadable/babel-plugin @loadable/webpack-plugin</span><span id="dac6" class="mo kx iq me b gy pc oz l pa pb"><em class="lz"># or using yarn</em></span><span id="c86d" class="mo kx iq me b gy pc oz l pa pb"><em class="lz">yarn</em> <em class="lz">add</em> @loadable/server &amp;&amp; <em class="lz">yarn</em> <em class="lz">add</em> --dev @loadable/babel-plugin @loadable/webpack-plugin</span></pre><p id="55af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后你需要设置babel配置，webpack配置，服务器端渲染和客户端初始化。</p><p id="67f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">。babelrc </strong></p><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="377e" class="mo kx iq me b gy oy oz l pa pb">{</span><span id="8167" class="mo kx iq me b gy pc oz l pa pb">"plugins": ["@loadable/babel-plugin"]</span><span id="7fe0" class="mo kx iq me b gy pc oz l pa pb">}</span></pre><p id="1fc4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> webpack.config.js </strong></p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="5633" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">服务器端设置</strong></p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="c4be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">客户端设置</strong></p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="e56f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其他类似的库—其中一些不再维护:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/theKashey/react-imported-component" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">kashey/react-导入组件</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">它真的永远不会让你失望。一切都归功于你的bundler。阅读有关此表显示的内容的更多信息关键…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pd l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://github.com/faceyspacey/react-universal-component" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">面空间/反应通用组件</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">🚀React通用组件的最终答案:同步SSR +代码拆分…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pe l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/react-loadable" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">可反应加载的</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">用于加载动态导入组件的高阶组件。如果您的公司或项目正在使用React…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="pf l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/react-async-component" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">反应异步组件</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">创建异步解析的组件，支持服务器端呈现和代码拆分。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="pg l of og oh od oi jw nu"/></div></div></a></div><h2 id="ddfb" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.5.本机img和iframe延迟加载</h2><p id="4ef4" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">基于chromium的浏览器有<strong class="ka ir">原生支持</strong>屏幕外的图像延迟加载。它只从每个img加载2Kb，以获取必要的信息。您可以通过将每个图像的<code class="fe mb mc md me b">loading</code>属性设置为<code class="fe mb mc md me b">lazy</code>来实现这一点。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ph"><img src="../Images/d733cc4f97e59b5d499aa1c206699050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPJVoTTPz_n4TTzu7DrZlw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/loading-lazy-attr" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/loading-lazy-attr</a></figcaption></figure><p id="24fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mb mc md me b">loading</code>属性支持三个值:</p><ul class=""><li id="62ba" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><code class="fe mb mc md me b">lazy</code>:惰性加载内容</li><li id="4257" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><code class="fe mb mc md me b">eager</code>:马上加载内容</li><li id="5f44" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><code class="fe mb mc md me b">auto</code>:浏览器将决定是否延迟加载内容</li></ul><p id="42f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">幸运的是，我们有一个<strong class="ka ir">解决方案，适用于旧浏览器或者不基于chromium的浏览器</strong>。我们需要做一个特征检测，并为此特征使用聚合填充。</p><p id="f58c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当浏览器不支持<code class="fe mb mc md me b">loading</code>属性时，为了防止加载文件夹上方的图像(不在视窗中),我们在图像上设置了<code class="fe mb mc md me b">data-src</code>属性，而不是<code class="fe mb mc md me b">src</code>属性。然后，我们检查<code class="fe mb mc md me b">loading</code>特征，并决定加载所需的polyfill或从上述元素的<code class="fe mb mc md me b">data-src</code>属性设置<code class="fe mb mc md me b">src</code>属性。</p><p id="14d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">作为聚合填充，您可以使用<a class="ae ma" href="https://github.com/aFarkas/lazysizes" rel="noopener ugc nofollow" target="_blank"> lazysizes </a>库。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/aFarkas/lazysizes" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">aFarkas/lazysizes</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">lazysizes是一个快速的(免费的)，搜索引擎友好的和自我初始化的lazyloader，用于图像(包括响应图像…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pi l of og oh od oi jw nu"/></div></div></a></div><p id="e952" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设您的代码中有这些图像:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="8989" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，您可以执行以下操作:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="21d3" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.6.图像自定义延迟加载</h2><p id="515a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">为此，你可以使用不同的库，比如<a class="ae ma" href="https://github.com/bluebill1049/react-simple-img" rel="noopener ugc nofollow" target="_blank"> react-simple-img </a>或者<a class="ae ma" href="https://www.npmjs.com/package/react-lazyload" rel="noopener ugc nofollow" target="_blank"> react-lazyload </a>。</p><p id="27b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ma" href="https://github.com/bluebill1049/react-simple-img" rel="noopener ugc nofollow" target="_blank"> react-simple-img </a>的用法非常简单:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="b962" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">开箱即用，它支持在文件夹下延迟加载图像——在用户视口之外。</p><h2 id="5193" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.7.交叉点观察器API</h2><p id="fb67" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">当页面的某个部分进入用户视口时，您可以使用交叉点观察器API延迟加载资源——通常是通过滚动。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="59ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以在此处更深入地了解交叉点观察点的用法:</p><div class="nr ns gp gr nt nu"><a href="https://www.smashingmagazine.com/2018/01/deferring-lazy-loading-intersection-observer-api/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">现在你看我:如何推迟，偷懒和行动与跨部门观察-粉碎杂志</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">很多原因都需要交集信息，比如图像的延迟加载。但是还有更多。这是…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.smashingmagazine.com</p></div></div><div class="od l"><div class="pj l of og oh od oi jw nu"/></div></div></a></div><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/52a5930d358da2b638734e87826a190b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cMD7f2lp2NvJRwu_dw-fxQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/intersectionobserver" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/intersectionobserver</a></figcaption></figure><h2 id="8f3a" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.8.聚合填充延迟加载</h2><p id="8908" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果您直接从<a class="ae ma" href="https://github.com/zloirock/core-js" rel="noopener ugc nofollow" target="_blank"> core-js </a>导入您的poly fill，或者您使用<a class="ae ma" href="https://babeljs.io/docs/en/babel-preset-env" rel="noopener ugc nofollow" target="_blank"> @babel/preset-env </a>插件根据<a class="ae ma" href="https://babeljs.io/docs/en/babel-preset-env#browserslist-integration" rel="noopener ugc nofollow" target="_blank">浏览器列表</a>设置所需的poly fill，您可以在您的包中找到您的poly fill。即使它们不是每次都被执行，它们也会被解析——这意味着你的应用程序的启动被推迟了。对于如何避免加载不必要的代码，我们没有多少选择。</p><ol class=""><li id="ff52" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv nq nh ni nj bi translated">您可以使用<a class="ae ma" href="https://polyfill.io/v3/" rel="noopener ugc nofollow" target="_blank">https://polyfill.io/v3/</a>来检查用户代理头，并提供专门针对浏览器的聚合填充</li><li id="a054" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">或者你可以偷懒加载你的聚合填充</li></ol><p id="1de8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">延迟加载聚合填充的设置如下:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="f319" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.9.CSS延迟加载</h2><p id="bf20" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">CSS文件仍然只是文件，因此您可以像处理聚合填充、模块、块等一样处理它们。您还可以使用一些DOM事件或交叉点观察器API来确定何时加载特定的CSS文件。</p><p id="9cb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它可能看起来像这样:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="76e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者，您可以使用如下库:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/filamentgroup/loadCSS" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">细丝组/负载</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">异步加载CSS。在GitHub上创建一个帐户，为filamentgroup/loadCSS的开发做出贡献。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pl l of og oh od oi jw nu"/></div></div></a></div><h2 id="300f" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.10.CSS代码分割</h2><p id="3aae" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">最佳实践之一是通过确定在折叠上方使用什么选择器来对CSS文件进行代码分割，这意味着为用户可见的页面部分加载CSS文件。之后，在用户交互中加载剩余的样式。</p><p id="7b4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种确定可以通过使用以下库之一来自动进行:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/filamentgroup/criticalCSS" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">纤维组/临界</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">找到你的页面的CSS文件夹，并输出到一个文件中</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pm l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://github.com/pocketjoso/penthouse" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">pocket joso/顶层公寓</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">关键路径css生成器Penthouse是原有的关键路径CSS生成器，帮助您加快出页速度…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pn l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://github.com/addyosmani/critical" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">addyosmani/危急</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">从HTML中提取并内联关键路径(在文件夹之上)CSS。最新1.x版本的文档可以…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="po l of og oh od oi jw nu"/></div></div></a></div><h1 id="28b1" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">3.懒惰或部分水合</h1><p id="9c97" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">服务器端呈现的React应用程序的水合可能很重。在某些情况下，你甚至不需要对应用程序的某些部分进行水化，因为只有静态内容，没有交互性。</p><p id="7485" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，你有一个大菜单，因为搜索引擎优化需要渲染器，但它有超过1500个元素。这里唯一的交互是下拉式打开。这个功能可以重写，只使用css下拉菜单，跳过整个菜单的水合，或者只水合交互部分，但跳过链接本身的水合。</p><p id="3ac3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要做到这一点，你可以使用<a class="ae ma" href="https://github.com/hadeeb/react-lazy-hydration" rel="noopener ugc nofollow" target="_blank"> react-lazy-hydration </a>库。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/hadeeb/react-lazy-hydration" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">hadeeb/react-lazy-水合作用</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">服务器渲染反应组件的惰性水合作用npm i反应-惰性水合作用或纱线添加反应-惰性水合作用基于…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pp l of og oh od oi jw nu"/></div></div></a></div><p id="6f0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">React团队计划在库本身中实现这一功能:</p><ul class=""><li id="0999" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">https://github.com/facebook/react/pull/14717<a class="ae ma" href="https://github.com/facebook/react/pull/14717" rel="noopener ugc nofollow" target="_blank"/></li><li id="c2d2" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">【https://github.com/reactjs/rfcs/pull/46 T4】</li></ul><p id="3fbf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用当前的React版本，您可以轻松实现这一点，如下所示:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="0b31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过这种设置，您可以跳过客户端SSR不匹配的警告，并且完全跳过水合作用。</p><p id="8aa4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你正在使用Next.js，有一个<a class="ae ma" href="https://github.com/LukasBombach/next-super-performance" rel="noopener ugc nofollow" target="_blank"> next-super-performance </a>库用于部分水合和一些其他特性来提高你的应用程序性能。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/LukasBombach/next-super-performance" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">LukasBombach/next-超级性能</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">使用Preact X为Next.js进行部分水合。解释:在spring，我们正在为报纸创建网站，我们…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pq l of og oh od oi jw nu"/></div></div></a></div><h1 id="57d1" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">4.树抖动—死代码消除</h1><h2 id="b51c" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">4.1.java描述语言</h2><p id="75be" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">树抖动是javascript中常用的一种方法或术语，意思是死代码消除。它依赖于静态代码分析。每个更大的模块捆绑器都实现了这一功能。</p><div class="nr ns gp gr nt nu"><a href="https://webpack.js.org/guides/tree-shaking/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">摇树|网络包</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">webpack是一个模块捆绑器。它的主要目的是捆绑JavaScript文件以便在浏览器中使用，但它也…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">webpack.js.org</p></div></div><div class="od l"><div class="pr l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://medium.com/@devongovett/parcel-v1-9-0-tree-shaking-2x-faster-watcher-and-more-87f2e1a70f79" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">摇树|包裹v1.9.0</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">今天，我非常兴奋地发布了package v 1 . 9 . 0，这是一个巨大的版本，包含了一些非常棒的特性！请查看…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">medium.com</p></div></div><div class="od l"><div class="ps l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://rollupjs.org/guide/en/#tree-shaking" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">树摇动|卷起</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Rollup是JavaScript的一个模块捆绑器，它将小段代码编译成更大更复杂的代码…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">rollupjs.org</p></div></div><div class="od l"><div class="pt l of og oh od oi jw nu"/></div></div></a></div><h2 id="fdf4" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">4.2.半铸钢ˌ钢性铸铁(Cast Semi-Steel)</h2><p id="e620" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">为了消除死的CSS代码，你可以使用一些在线工具或库，它们可以很容易地与你的构建工具集成。</p><h2 id="6c97" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">手动操作</h2><ol class=""><li id="d664" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv nq nh ni nj bi translated">打开<a class="ae ma" href="https://www.keycdn.com/blog/chrome-devtools" rel="noopener ugc nofollow" target="_blank"> Chrome DevTools </a></li><li id="c38f" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">点击右上角的三个点</li><li id="a9fe" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">转至“更多工具”,然后选择“覆盖范围”</li><li id="23a1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">单击重新加载图标</li><li id="58cb" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">从Coverage选项卡中选择一个CSS文件，这将在Sources选项卡中打开该文件</li></ol><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pu"><img src="../Images/7c28ec4d4bcb9a42979084c47de5b94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SuftyEJhujDXAokhadcLsw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://www.keycdn.com/" rel="noopener ugc nofollow" target="_blank">https://www.keycdn.com/</a></figcaption></figure><h2 id="45a5" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">未使用的CSS</h2><div class="nr ns gp gr nt nu"><a href="https://unused-css.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">移除未使用的CSS |未使用的CSS</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">发现UnusedCSS如何帮助你的网站平均来说，大约35%的CSS代码是完全不必要的。我们…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">unused-css.com</p></div></div><div class="od l"><div class="pv l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="a5a5" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">带付费计划的在线工具</li><li id="9d8f" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">您应该手动配置所有页面，在这些页面中应该寻找使用过的css选择器</li></ul><h2 id="c928" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">纯化CSS</h2><div class="nr ns gp gr nt nu"><a href="https://purifycss.online/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">在线净化CSS删除未使用的CSS</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">关于这个工具使用PurifyCSS，这是Ilias Ismanalijev制作的JS库，可以扫描你的源代码(HTML和…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">purifycss.online</p></div></div><div class="od l"><div class="pw l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="02ef" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">这是一个免费的在线工具，而且它有一个构建时集成</li><li id="4efc" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">您必须手动指定要逐一扫描的文件</li></ul><h2 id="a29e" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">采购</h2><div class="nr ns gp gr nt nu"><a href="https://purgecss.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">移除未使用的CSS —清除CSS</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">提示该文档适用于PurgeCSS 3.0及更高版本。要查看PurgeCSS 2.x的文档，请单击此处PurgeCSS是…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">purgecss.com</p></div></div><div class="od l"><div class="px l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="8025" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">建立时间整合的免费图书馆</li></ul><h2 id="8517" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">JS库中的CSS</h2><p id="65a6" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">JS库中有大量的CSS，其中一些不再被维护。以下是一些例子:</p><ul class=""><li id="8c2c" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae ma" href="https://cssinjs.org/" rel="noopener ugc nofollow" target="_blank"> JSS </a></li><li id="6d9a" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://styled-components.com/" rel="noopener ugc nofollow" target="_blank">风格化组件</a></li><li id="37ae" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/FormidableLabs/radium" rel="noopener ugc nofollow" target="_blank">镭</a></li><li id="0422" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/Khan/aphrodite" rel="noopener ugc nofollow" target="_blank">阿芙罗狄蒂</a></li><li id="d93b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/emotion-js/emotion" rel="noopener ugc nofollow" target="_blank">情感</a></li><li id="a631" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/threepointone/glamor" rel="noopener ugc nofollow" target="_blank">魅力</a></li><li id="615a" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/paypal/glamorous" rel="noopener ugc nofollow" target="_blank">光鲜亮丽</a></li><li id="e1e4" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/robinweser/fela" rel="noopener ugc nofollow" target="_blank">费拉</a></li><li id="eed9" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/styletron/styletron" rel="noopener ugc nofollow" target="_blank">电子管</a></li><li id="dc88" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/gajus/react-css-modules" rel="noopener ugc nofollow" target="_blank">反应CSS模块</a></li><li id="35c0" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/airbnb/react-with-styles" rel="noopener ugc nofollow" target="_blank">对风格做出反应</a></li><li id="04d9" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/callstack/linaria" rel="noopener ugc nofollow" target="_blank">利纳瑞</a></li><li id="7583" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">等等。</li></ul><p id="e7fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过在JS库中使用CSS，你可以从你的页面中消除所有死的CSS代码，但是请记住，其中一些库可能会有大量的运行时代码，这些代码会降低你的应用程序的速度。</p><h1 id="8aa0" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">5.Javascript缩小和优化工具</h1><p id="b20e" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">以下工具通过删除不必要的字符、重命名变量甚至执行应用程序的某些部分来生成更高效的代码，从而减小javascript文件的大小。</p><h2 id="50ee" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.1.预先包装</h2><div class="nr ns gp gr nt nu"><a href="https://prepack.io/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">预先包装</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">开箱即用，Prepack并不完全建模浏览器或node.js环境:Prepack没有内置的知识…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">prepack.io</p></div></div><div class="od l"><div class="py l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="e541" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">通过在构建时运行javascript代码来优化它</li><li id="969b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">Webpack插件:<a class="ae ma" href="https://github.com/gajus/prepack-webpack-plugin" rel="noopener ugc nofollow" target="_blank">https://github.com/gajus/prepack-webpack-plugin</a></li></ul><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="9343" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.2.关闭</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/google/closure-compiler" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">google/closure编译器</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">闭包编译器是一个让JavaScript下载和运行更快的工具。这是一个真正的JavaScript编译器…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="pz l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="7756" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">它从javascript编译成更好的javascript</li><li id="52df" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">删除死代码，重写并最小化剩下的代码</li><li id="e8c3" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">Webpack插件:【https://github.com/webpack-contrib/closure-webpack-plugin T2】</li></ul><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="69c5" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.3.包装工人</h2><div class="nr ns gp gr nt nu"><a href="http://dean.edwards.name/packer/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">/packer/</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Javascript压缩器。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">迪安·爱德华兹名字</p></div></div></div></a></div><ul class=""><li id="b230" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">缩小您的javascript代码</li><li id="cb26" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">复制粘贴服务</li></ul><h2 id="c294" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.4.丑陋的JS</h2><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/uglify-js" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">丑陋-js</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">JavaScript解析器、处理器/压缩器和美化工具包</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="qa l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="9e76" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">CLI和节点API工具包</li><li id="89b8" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">缩小和压缩您的javascript代码</li><li id="a094" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">Webpack插件:【https://www.npmjs.com/package/uglifyjs-webpack-plugin T4】</li></ul><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="37d0" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.5.简洁的</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/terser/terser" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">特塞尔/特塞尔</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">用于ES6+ - terser/terser的🗜 JavaScript解析器、处理器和压缩器工具包</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="qb l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="742b" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">webpack的默认生产尺寸</li><li id="e38f" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://webpack.js.org/plugins/terser-webpack-plugin/" rel="noopener ugc nofollow" target="_blank">https://webpack.js.org/plugins/terser-webpack-plugin/</a></li></ul><h2 id="575d" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.6.使变小</h2><div class="nr ns gp gr nt nu"><a href="http://coderaiser.github.io/minify/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">使变小</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">js，css，html和img的Minifier找错别字？帮忙修一下。一个js，css，html和img文件的缩小器，用在…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">coderaiser.github.io</p></div></div><div class="od l"><div class="qc l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="0c9d" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">js，css，html和img文件的迷你化</li></ul><h2 id="e5f8" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.7.巴别塔迷你化</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/babel/minify" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">巴别塔/迷你</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">一个基于巴别塔工具链的ES6+感知迷你器。babel-minify可通过API、CLI或babel预设来使用。试试看…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="qd l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="8751" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">巴别塔迷你机</li><li id="193e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">尚未做好生产准备</li></ul><h2 id="d8d1" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.8.生产</h2><div class="nr ns gp gr nt nu"><a href="https://producify.js.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">生产</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">安装命令行工具:NPM-g I Prodi fy它将在您的终端上显示“Prodi fy”命令。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">producify.js.org</p></div></div></div></a></div><ul class=""><li id="0f17" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">CLI和节点API工具包</li></ul><h2 id="9f92" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.9.时髦的</h2><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/snappy" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">时髦的</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Nodejs绑定到snappy compression库压缩输入，它可以是一个缓冲区或字符串。回拨…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="qe l of og oh od oi jw nu"/></div></div></a></div><ul class=""><li id="7def" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">压缩和解压缩库</li></ul><h1 id="7861" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">6.图书馆交换</h1><h2 id="12a9" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">6.1.预先行动而不是反应</h2><div class="nr ns gp gr nt nu"><a href="https://preactjs.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">提前</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">快速3kB替代方案，可与相同的现代API一起使用开始切换到Preact函数Counter ( ) { const…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">preactjs.com</p></div></div><div class="od l"><div class="qf l of og oh od oi jw nu"/></div></div></a></div><p id="4674" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Preact基本上是react的轻量级版本。当性能、速度和尺寸是优先考虑的因素时，您可以选择使用它。</p><p id="5551" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">优点:</strong></p><ul class=""><li id="2883" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">压缩后只有3KB大小</li><li id="ba59" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">比反应更快(见这些<a class="ae ma" href="https://developit.github.io/preact-perf/" rel="noopener ugc nofollow" target="_blank">测试</a>)</li><li id="c2c9" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">它在很大程度上与React兼容，因此出于性能原因，很容易将React与p React替换为现有项目</li><li id="89d1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">官方网站上有很好的文档和示例</li><li id="ea09" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">它有一个强大的官方命令行界面</li></ul><p id="40f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">缺点:</strong></p><ul class=""><li id="4887" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">仅支持无状态功能组件和基于ES6类的组件定义</li><li id="9c2e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">不支持上下文</li><li id="4878" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">不支持属性类型</li><li id="78ee" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">比React小的社区</li></ul><h2 id="0187" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">6.2.Linaria而不是styled-components</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/callstack/linaria" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">调用堆栈/linaria</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">JS库中的零运行时CSS。在GitHub上创建一个帐户，为callstack/linaria开发做贡献。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="qg l of og oh od oi jw nu"/></div></div></a></div><p id="6aff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">样式化组件可能需要很长时间才能将页面与大量样式融合在一起:</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qh"><img src="../Images/2a11afcf7420e2d6c0fb5f40bd003dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTvP3c94YhyU7ROtm8WkKA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">CPU i9 2,4Ghz 6x倍减速</figcaption></figure><p id="363e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">styled-components库附带了一个开销和运行时代码，它会降低页面解析水合过程的速度，如上所示。</p><p id="0f99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">幸运的是，这个包有一个类似API的替代品。它叫做<a class="ae ma" href="https://github.com/callstack/linaria" rel="noopener ugc nofollow" target="_blank"> Linaria </a>。这些包之间的主要区别是Linaria在构建时将CSS提取到单独的文件中，而样式化组件在运行时提取CSS。这意味着Linaria的运行时间<strong class="ka ir">为零。</strong></p><p id="903a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">优点</strong>:</p><ul class=""><li id="943f" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">缩短了加载时间，因为CSS和JavaScript可以并行加载，不像JS库中的运行时CSS，CSS和JS在同一个包中</li><li id="0786" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">提高运行时性能，因为在运行时不需要做额外的工作，如解析CSS</li><li id="6bc3" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">服务器端呈现的CSS和JavaScript包之间没有样式重复</li><li id="5a80" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">因为Linaria在构建时工作，所以不需要通过SSR设置来缩短首次绘图的时间，也不需要在没有JS的情况下让页面工作</li></ul><p id="64c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">限制</strong>:</p><ul class=""><li id="e6a2" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">在使用<code class="fe mb mc md me b">styled</code>的组件中使用动态样式时不支持IE11，因为它使用CSS自定义属性</li><li id="6215" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><code class="fe mb mc md me b">css</code>标签不支持动态样式</li><li id="6cf1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">CSS规则中使用的模块不能有副作用。例如:</li></ul><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="a5d5" class="mo kx iq me b gy oy oz l pa pb">import { css } from 'linaria';<br/>import colors from './colors';</span><span id="45cc" class="mo kx iq me b gy pc oz l pa pb">const title = css`<br/>  color: ${colors.text};<br/>`;</span></pre><p id="9516" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe mb mc md me b">colors.js</code>文件或者它导入的任何文件中应该没有副作用。您应该在没有任何副作用的情况下将助手和共享配置移动到文件中。</p><h2 id="91f6" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">6.4.lodash-es代替lodash</h2><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/lodash-es" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">洛达什-埃斯</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Lodash作为ES模块导出。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="qi l of og oh od oi jw nu"/></div></div></a></div><p id="31cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过更多的实用程序，我们可以使用<a class="ae ma" href="https://www.npmjs.com/package/lodash-es" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">lodash-es</strong></a><strong class="ka ir"/>而不是<a class="ae ma" href="https://www.npmjs.com/package/lodash" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> lodash </strong> </a>来节省大小。下面是一个表格，对提到的包进行了比较。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="0a3a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，一些包使用了这样或那样的方法，所以在webpack配置中创建一个别名来在任何地方使用<strong class="ka ir"> lodash-es </strong>来防止两次捆绑这些库。</p><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="4af8" class="mo kx iq me b gy oy oz l pa pb">module.exports = {<br/>  resolve: {<br/>    alias: {<br/>      'lodash-es': 'lodash',<br/>    },<br/>  },<br/>};</span></pre><h2 id="c8d3" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">6.5.解开而不是腋窝，等等。</h2><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/unfetch" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">放开</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Tiny 500b fetch“勉强填充”Minimal:仅fetch()带有熟悉的头和文本/json响应:是…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="qj l of og oh od oi jw nu"/></div></div></a></div><p id="1c1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ma" href="https://www.npmjs.com/package/axios" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Axios </strong> </a>可能为我们提供了很多功能，但在大多数情况下我们甚至都没有使用它。另一方面，这个包的未压缩大小接近350Kb。如果你只使用它的基本功能，这就太多了。</p><p id="eb02" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个包的替代方案是<a class="ae ma" href="https://www.npmjs.com/package/unfetch" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> unfetch </strong> </a>，它只有大约<strong class="ka ir"> 30Kb </strong>未压缩，可以提供我们需要的一切。这个包的大小节省了大约90%。</p><p id="30a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于那些使用<a class="ae ma" href="https://www.npmjs.com/package/isomorphic-fetch" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">同构获取</strong> </a>为节点环境和前端实现相同功能的人来说，有一个<a class="ae ma" href="https://github.com/developit/unfetch/tree/master/packages/isomorphic-unfetch" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">同构解锁</strong> </a>包。</p><h2 id="801e" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">6.6.date-fns代替moment.js</h2><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/date-fns" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">日期-fns</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">现代JavaScript日期实用程序库</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="qk l of og oh od oi jw nu"/></div></div></a></div><p id="9c86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一眼看上去，如果你检查缩小的文件，你可以说date-fns比moment.js大。</p><ul class=""><li id="c64f" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae ma" href="https://cdnjs.cloudflare.com/ajax/libs/date-fns/1.29.0/date_fns.min.js" rel="noopener ugc nofollow" target="_blank"> date-fns.min.js </a> — 68 Kb</li><li id="b428" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js" rel="noopener ugc nofollow" target="_blank"> moment.min.js </a> — 50 Kb</li></ul><p id="96ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，这是正确的，但在现实世界的应用程序中，你不会使用这些软件包提供的所有功能，所以树抖动和丑化可以完成这项工作。</p><p id="f076" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们从moment.js中取出一些常用函数，比如说<code class="fe mb mc md me b">format()</code>、<code class="fe mb mc md me b">duration()</code>、<code class="fe mb mc md me b">humanize()</code>和<code class="fe mb mc md me b">utc()</code>，并将其替换为date-fns中的等效函数，我们将得到如下块大小:</p><ul class=""><li id="8f2b" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">日期-fns.js — 29.3 Kb</li><li id="87c6" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">moment.js — 57.1 Kb</li></ul><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9e6190d181bc10a5012be4ec1194287c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e_HHpw8GTvIZU15Q"/></div></div></figure><p id="e9a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">示例代码为<a class="ae ma" href="https://github.com/artemdemo/date-fns-vs-moment" rel="noopener ugc nofollow" target="_blank">的回购此处为</a>。</p><h1 id="daf8" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">7.形象</h1><p id="4f4d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">根据HTTP存档，图片占所有请求的30%。那么我们来谈谈如何优化这些资源。</p><h2 id="3264" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.1.正确的图像尺寸</h2><p id="3dd7" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">你应该总是使用完全填满其容器的图像，没有溢出的确切尺寸。因此，对于200像素宽200像素高的容器，使用相同尺寸的重新调整图像。使用这种方法，浏览器不需要在调整图像大小时做额外的工作。</p><h2 id="cd60" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.2.使用srcset、大小和媒体属性</h2><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ql"><img src="../Images/5f6674e1fb471627bea866acd37a1b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AZZPWrruo1dxGnQ2OESHKw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">【https://caniuse.com/srcset】</figcaption></figure><p id="0183" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些属性允许您根据显示器的大小提供不同比例的图像。没有必要为手机和电脑提供相同的图像。</p><h2 id="636b" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">srcset</h2><p id="6b7d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><code class="fe mb mc md me b">srcset</code>属性可以用在<code class="fe mb mc md me b">&lt;img&gt;</code>和<code class="fe mb mc md me b">&lt;source&gt;</code>元素中。在这种情况下，我们只依赖浏览器的视窗。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="d1ac" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">大小</h2><p id="58ca" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">属性定义了一组媒体条件，它告诉浏览器如果某些条件成立，应该选择什么样的图像尺寸。可以和<code class="fe mb mc md me b">srcset</code>结合使用。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="686a" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">媒体</h2><p id="1610" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><code class="fe mb mc md me b">media</code>属性类似于<code class="fe mb mc md me b">sizes</code>属性。当<code class="fe mb mc md me b">&lt;source&gt;</code>元素是<code class="fe mb mc md me b">&lt;picture&gt;</code>元素的子元素时，可以在该元素上使用它。不同之处在于，使用<code class="fe mb mc md me b">media</code>属性，您可以定义媒体条件，而无需定义视窗宽度。然后，如果满足条件，则使用正确的图像大小。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="0a54" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">像素密度描述符</h2><p id="8c93" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">除了视窗之外，还可以根据显示器的像素密度来定义使用什么图像。使用<code class="fe mb mc md me b">1x</code>、<code class="fe mb mc md me b">2x</code>和<code class="fe mb mc md me b">3x</code>定义这些描述符。因此，您可以使用比原始图像更大的图像，同时保持相同的尺寸。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="9583" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.3.正确的图像格式</h2><p id="b83f" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">有很多图像格式可以使用。我将描述最常见的几种。</p><h2 id="2b40" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated"><strong class="ak"> JPEG </strong></h2><ul class=""><li id="3972" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">不支持透明</li><li id="adc9" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">可以支持大约1600万种颜色</li><li id="7e58" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">将它用于包含自然场景的所有图像或颜色和强度变化平滑的照片</li></ul><h2 id="fa55" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">PNG</h2><ul class=""><li id="897e" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">支持透明度</li><li id="9226" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">PNG8最多可支持256种颜色</li><li id="b1df" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">PNG24可以处理多达1600万种颜色</li><li id="082c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">将它用于需要透明度的图像或带有鲜明对比边缘(如徽标)的图像</li></ul><h2 id="6255" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">GIF格式</h2><ul class=""><li id="f2a0" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">图像支持透明</li><li id="0083" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">仅限于256种颜色</li><li id="608d" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">支持动画</li><li id="760b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">将它用于包含动画的图像</li></ul><h2 id="ddf1" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">WEBP</h2><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qm"><img src="../Images/b45987ba45038d322fc72ad514b48fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j69xT8kcXEBTXiUUnvxfcQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/webp" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/webp</a></figcaption></figure><ul class=""><li id="1cbf" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">试图将已经提到的格式中最好的部分与更好的压缩率结合起来</li><li id="e313" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">比巴布亚新几内亚小约26%</li><li id="9d8a" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">比JPEG小25% — 34%</li></ul><p id="a434" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了用HTML提供WEBP格式，你可以使用<code class="fe mb mc md me b">&lt;picture&gt;</code>和<code class="fe mb mc md me b">&lt;source&gt;</code>元素。不支持这些元素的浏览器会跳过它们，只读取<code class="fe mb mc md me b">&lt;img&gt;</code>元素。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="699e" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">AVIF</h2><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qn"><img src="../Images/ef79c568f0f2e082ec0ba4b6e6a60cbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TEiQXVsXJaw979U7VrUhbQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/avif" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/avif</a></figcaption></figure><p id="7252" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">AVIF图像格式还不被真正支持。这是因为这是一个真正的新技术，你可以感到兴奋。相应于<a class="ae ma" href="https://www.ctrl.blog/entry/webp-avif-comparison.html" rel="noopener ugc nofollow" target="_blank"> ctrl.blog </a> AVIF是:</p><ul class=""><li id="b590" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">比WEBP小约20%</li><li id="0676" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">比JPEG小约50%</li></ul><p id="2cf9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种格式是由开放媒体联盟开发的。它被创建为一种开源且免版税图像格式。</p><p id="8867" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尽管支持很差，我们仍然可以使用带有<code class="fe mb mc md me b">&lt;picture&gt;</code>元素的原生HTML格式。<code class="fe mb mc md me b">&lt;picture&gt;</code>元素允许渐进式支持，因此浏览器将从提供的列表中加载它支持的第一个。</p><h2 id="bf86" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">渐进JPEG</h2><p id="1e28" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">JPEG图像的<strong class="ka ir">基线渲染</strong>是从上到下高质量的加载。</p><p id="14d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">渐进式渲染</strong>意味着首先加载一个低质量的JPEG图像，然后不断添加更多像素，直到加载完整质量的图像。这可以显著改善你的网站的用户体验。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/cd39742333541d14fcf9acd26325b908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/0*NPHand3QIlOmG8SX.jpeg"/></div></figure><p id="6873" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以通过转换标准JPEG图像来实现渐进式JPEG格式。</p><h2 id="b476" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">挽救（saving的简写）</h2><ul class=""><li id="8cb3" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">可缩放矢量格式</li><li id="2c02" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">非常适合徽标、图标、文本和简单图像</li><li id="4c49" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">与JPEG或PNG相比，简单的SVG图像(可以转换为矢量)的大小可以小90%</li></ul><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qp"><img src="../Images/50a2d0bcf79f3c9ac4b9bdf79d108683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m1sk2quAB9dqwLM7.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">节省高达90%的示例图像</figcaption></figure><h2 id="6a59" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.5.压缩您的图像</h2><p id="2340" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">即使选择了正确的图像格式或尺寸，仍有压缩的空间。一种方法是从图像中删除所有不必要的元数据，而不改变图像质量。这叫做<strong class="ka ir">无损压缩</strong>。</p><p id="0d37" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一方面，也可以使用<strong class="ka ir">有损</strong>压缩，这可以移除几乎所有的元数据并降低图像质量。对于人眼来说，这种质量降低在大多数情况下是不明显的，并且尺寸上的节省可以高达25%。</p><p id="fb04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一些压缩算法包括:</p><ul class=""><li id="d7c0" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.prepressure.com/library/compression-algorithm/flate-deflate" rel="noopener ugc nofollow" target="_blank">充气/放气</a></li><li id="bed1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.prepressure.com/library/compression-algorithm/jpeg" rel="noopener ugc nofollow" target="_blank"> JPEG </a></li><li id="730e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.prepressure.com/library/compression-algorithm/jpeg2000" rel="noopener ugc nofollow" target="_blank"> JPEG2000 </a></li><li id="c0b1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.prepressure.com/library/compression-algorithm/huffman" rel="noopener ugc nofollow" target="_blank">霍夫曼</a></li><li id="b171" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.prepressure.com/library/compression-algorithm/lzw" rel="noopener ugc nofollow" target="_blank"> LZW </a></li><li id="1004" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.prepressure.com/library/compression-algorithm/rle" rel="noopener ugc nofollow" target="_blank"> RLE </a></li></ul><h2 id="c2e2" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.6.从无cookie域传送图像</h2><p id="7099" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">静态图像文件应该从不使用cookies的不同域或子域(例如<em class="lz">static.your-domain.com</em>)交付。</p><p id="4bff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种方法有两个好处:</p><ul class=""><li id="eee4" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">有效缓存</li><li id="cdd0" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">传输的数据较少</li></ul><h2 id="31a7" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.7.从CDN传送图像</h2><p id="b1af" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">内容交付网络(cdn)是分布在世界各地的多台服务器，您的静态文件就存储在这里。根据需要，它从离用户最近的服务器上传送文件。</p><p id="4fd8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通常cdn是付费服务。几乎所有这些都为您提供了图像处理选项。这意味着它们会自动优化您的图像以获得更好的性能。</p><p id="b67b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，在<a class="ae ma" href="https://www.cloudflare.com/" rel="noopener ugc nofollow" target="_blank"> Cloudflare </a>上，你可以启用<a class="ae ma" href="https://support.cloudflare.com/hc/en-us/articles/360000607372-Using-Cloudflare-Polish-to-compress-images" rel="noopener ugc nofollow" target="_blank">抛光选项</a>来压缩你的图像。</p><h2 id="7876" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.8.图像修改工具</h2><ul class=""><li id="277e" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.pixelmator.com/pro/" rel="noopener ugc nofollow" target="_blank">像素化器</a></li><li id="7839" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.irfanview.com/" rel="noopener ugc nofollow" target="_blank"> Irfanview </a></li><li id="a7ba" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.xnview.com/en/xnconvert/" rel="noopener ugc nofollow" target="_blank"> Xnview </a></li><li id="d68b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://imagecompressor.com/" rel="noopener ugc nofollow" target="_blank">优化器</a></li><li id="f232" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://riot-optimizer.com/" rel="noopener ugc nofollow" target="_blank">暴乱</a></li><li id="e867" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://www.photoshop.com/" rel="noopener ugc nofollow" target="_blank"> Adobe Photoshop </a></li><li id="c2ec" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://www.gimp.org/" rel="noopener ugc nofollow" target="_blank"> Gimp </a></li><li id="1c1b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://www.getpaint.net/index.html" rel="noopener ugc nofollow" target="_blank">Paint.NET</a></li><li id="a5e8" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://www.lcdf.org/gifsicle/" rel="noopener ugc nofollow" target="_blank">礼品</a></li><li id="2af5" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://jpegclub.org/jpegtran/" rel="noopener ugc nofollow" target="_blank"> JPEGtran </a></li><li id="6210" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://www.jpegmini.com/" rel="noopener ugc nofollow" target="_blank"> JPEG Mini </a></li><li id="571b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://optipng.sourceforge.net/" rel="noopener ugc nofollow" target="_blank">选项</a></li><li id="69d1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://pngquant.org/" rel="noopener ugc nofollow" target="_blank"> pngquant </a></li><li id="c00d" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://netm.ag/optimize-263" rel="noopener ugc nofollow" target="_blank">文件优化器</a></li><li id="452c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://imageoptim.com/" rel="noopener ugc nofollow" target="_blank"> ImageOptim </a></li><li id="39a0" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://trimage.org/" rel="noopener ugc nofollow" target="_blank">三位一体</a></li><li id="6686" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://imageresize.org/compress-images" rel="noopener ugc nofollow" target="_blank">ImageResize.org</a></li><li id="af04" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#imagify" rel="noopener ugc nofollow" target="_blank">图像优化器</a></li><li id="f449" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#shortpixel" rel="noopener ugc nofollow" target="_blank">短像素图像优化器</a></li><li id="353c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#optimole" rel="noopener ugc nofollow" target="_blank">最佳摩尔</a></li><li id="4b76" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#ewww-cloud" rel="noopener ugc nofollow" target="_blank"> EWWW图像优化器云</a></li><li id="9119" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#optimus" rel="noopener ugc nofollow" target="_blank"> Optimus图像优化器</a></li><li id="c96f" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#wp-smush" rel="noopener ugc nofollow" target="_blank"> WP Smush </a></li><li id="6e44" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#tinypng" rel="noopener ugc nofollow" target="_blank"> TinyPNG </a></li><li id="d41c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://kinsta.com/blog/optimize-images-for-web/#imagerecycle" rel="noopener ugc nofollow" target="_blank">图像回收</a></li></ul><h2 id="51aa" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">7.9.Webpack加载器</h2><p id="3f93" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">有几个工具可以包含在您的构建过程中。下面就来说说其中的一些。</p><h2 id="0b36" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">图像网络包加载器</h2><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/image-webpack-loader" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">图像-网络包-加载器</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">webpack Minify PNG、JPEG、GIF、SVG和WEBP图像的图像加载器模块，带有imagemin输出问题，应该…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="qq l of og oh od oi jw nu"/></div></div></a></div><p id="148c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">把这个加载器放在你的<a class="ae ma" href="https://github.com/webpack-contrib/url-loader" rel="noopener ugc nofollow" target="_blank"> url加载器</a>或<a class="ae ma" href="https://www.npmjs.com/package/file-loader" rel="noopener ugc nofollow" target="_blank">文件加载器</a>前面，它会压缩和优化你的图像。</p><h2 id="909b" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">SVG URL加载程序</h2><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/svg-url-loader" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">svg-url-loader</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">一个webpack加载器，它以utf-8编码的DataUrl字符串的形式加载SVG文件。现有始终为…进行Base64编码</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="qr l of og oh od oi jw nu"/></div></div></a></div><p id="f7ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">标准的<a class="ae ma" href="https://github.com/webpack-contrib/url-loader" rel="noopener ugc nofollow" target="_blank"> url加载器</a>总是对数据uri使用base64编码。base64编码的资源平均比原始资源大37%。svg-url-loader使用UTF-8编码对svg进行编码。好处如下:</p><ul class=""><li id="21a9" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">结果更小(最多小2倍)</li><li id="430b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">使用gzip压缩可以更好地压缩结果</li><li id="7316" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">浏览器解析器UTF-8编码字符串速度更快</li></ul><h1 id="d605" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">8.字体</h1><h2 id="c25d" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">8.1.自定义web字体</h2><p id="0c86" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果您从自己的服务器提供字体，您可以创建您正在使用的字符的子集。这将有助于加载你的字体更快。为此，可以使用以下库:</p><ul class=""><li id="47ba" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.npmjs.com/package/subfont" rel="noopener ugc nofollow" target="_blank">子字体</a></li><li id="ea56" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/filamentgroup/glyphhanger" rel="noopener ugc nofollow" target="_blank"> glyphhanger </a></li></ul><h2 id="f6f7" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">8.2.福伊特</h2><p id="99ff" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">网页字体加载时间过长时，可能会出现不可见文本闪烁。</p><h2 id="ef12" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">字体显示属性</h2><p id="1728" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">为了支持用户体验和第一次内容丰富的绘画，如果您使用自定义字体，请使用<code class="fe mb mc md me b">font-display: swap;</code> CSS属性。这将确保在加载自定义字体时显示默认字体。Google fonts也支持这个特性，只需在fonts URL中添加<code class="fe mb mc md me b">&amp;display=swap</code>查询参数。这将导致无样式文本的闪烁(<em class="lz"> FOUT </em>)，但这是为更好的UX所付出的小小代价。</p><h2 id="a7ad" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">字体加载事件</h2><p id="45af" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">这个问题还有另一个解决方案，就是检测你的字体何时被加载，并控制显示过程。可以通过使用<a class="ae ma" href="https://developer.mozilla.org/en-US/docs/Web/API/CSS_Font_Loading_API" rel="noopener ugc nofollow" target="_blank"> CSS字体加载API </a>来完成。由于不是每个浏览器都支持它，您可以使用一些替代方法:</p><ul class=""><li id="6a2f" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/bramstein/fontfaceobserver" rel="noopener ugc nofollow" target="_blank"> fontfaceobserver </a></li><li id="8493" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">webfontloader </li></ul><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/3df2ff0229781b0491a1e31194af251b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jjL5VJtnXo8MYGTZJ84Fw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/mdn-api_fontfacesetloadevent" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/mdn-api_fontfacesetloadevent</a></figcaption></figure><p id="0375" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了展示一些例子，我将使用<a class="ae ma" href="https://github.com/bramstein/fontfaceobserver" rel="noopener ugc nofollow" target="_blank"> fontfaceobserver </a>库。</p><ul class=""><li id="20df" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">首先——加载你的字体，不做任何修改</li><li id="c8cc" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">第二步—创建CSS类:</li></ul><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><ul class=""><li id="62b9" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">第三，为每个使用的字体系列设置字体外观观察器，并在它们加载后设置正文类:</li></ul><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="dbe5" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">将字体保存到本地存储</h2><p id="1d52" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">由于本地缓存经常刷新，尤其是在移动设备上，一个好的方法是将你的字体存储到客户端<code class="fe mb mc md me b">localStorage</code>。</p><p id="b08c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用与字体观察者相同的CSS类。那么我们将使用下面的代码:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="2fd5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们检查对<code class="fe mb mc md me b">localStorage</code>的支持，以及是否有自定义键<code class="fe mb mc md me b">webFonts</code>的值。如果是，我们用该值注入一个样式标签，如果不是，我们用该字体加载CSS，并将该值插入本地存储。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/213278cf1711aeebfb824d9aa8ab0b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0yaHET-9z1zZ_5zcVG0u3Q.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/mdn-api_window_localstorage" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/mdn-api_window_localstorage</a></figcaption></figure><h2 id="912c" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">8.3.字体预加载</h2><p id="b2df" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">当你预加载你的字体时，使用链接标签的<code class="fe mb mc md me b">crossorigin=anonymous</code>属性。没有该属性，预装的字体将被忽略(<a class="ae ma" href="https://github.com/w3c/preload/issues/32" rel="noopener ugc nofollow" target="_blank">https://github.com/w3c/preload/issues/32</a>)。</p><h2 id="c18c" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">8.4.Google字体预加载</h2><p id="361d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果你使用谷歌字体更好地自托管这些字体，以更快地加载它们——因为浏览器不必建立新的连接。您可以使用<a class="ae ma" href="https://www.npmjs.com/package/google-fonts-webpack-plugin" rel="noopener ugc nofollow" target="_blank">Google-fonts-web pack-plugin</a>在构建期间下载这些字体。</p><h2 id="4881" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">8.5.字体格式</h2><p id="30c7" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><strong class="ka ir"> TrueType字体(TTF) </strong>由苹果和微软在80年代后期开发。这是最常见的字体格式。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qs"><img src="../Images/931395044a70095b056d6ab6e08f3bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJUwKRG8ZkN3_Ch2PuG8Nw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/ttf" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/ttf</a></figcaption></figure><p id="ca15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Web开放字体格式(WOFF) </strong>于2009年开发，用于网页。<em class="lz"> WOFF </em>基本上就是<em class="lz"> OpenType </em>或者<em class="lz"> TrueType </em>加上压缩和额外的元数据。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qt"><img src="../Images/6df4248bc2e5e816ffa86a8bd2371800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WEmiMUnLKKRJ-G9KrtUdnw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/woff" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/woff</a></figcaption></figure><p id="d78a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">Web Open Font Format 2(woff 2)</strong>比<em class="lz"> WOFF有更好的压缩效果。</em></p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qs"><img src="../Images/6d373c36a5195b04944753ce4890190e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LsfKx8_otyL5vERhqZMBWg.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/woff2" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/woff2</a></figcaption></figure><p id="e51d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">嵌入式开放字体(EOT) </strong>是微软设计的<em class="lz"> OpenType </em>字体的精简形式，用作网页上的嵌入式字体。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qu"><img src="../Images/939e678f0c8bb9b5a7d1685f88d20511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vVxa_aXp1XkJTBK9WeVNug.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/eot" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/eot</a></figcaption></figure><h2 id="fccd" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">选什么？</h2><p id="29ab" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">这里最好的选择是为WOFF和WOFF2格式提供web安全字体的后备。web安全字体是用户计算机上预先安装的字体。你可以在<a class="ae ma" href="https://www.cssfontstack.com/" rel="noopener ugc nofollow" target="_blank">cssfontstack.com</a>上查看报道。</p><p id="3b24" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">前5种<strong class="ka ir">无衬线字体</strong> web安全字体是:</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qv"><img src="../Images/6dd7cf457bda6c25a83b8d3ab682df6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OH8WnRCvnLJUI3ev1Vj4MA.png"/></div></div></figure><p id="bf0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">前5种<strong class="ka ir">衬线字体</strong> web安全字体是:</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qw"><img src="../Images/4fe5c180d8b9ab22f0008f1af3fcb57f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yU3BCzQ2qVeqiwNqfvogkQ.png"/></div></div></figure><p id="0722" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用CSS提供WOFF和WOFF2格式:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="5a82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有退路:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h1 id="8e4b" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">9.布局重新计算</h1><p id="237d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在Firefox的世界里，他们称之为<strong class="ka ir"> DOM reflow </strong>，在Chrome/Opera/IE/Safari的世界里，这是<strong class="ka ir">布局转移</strong>。</p><p id="de4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些术语指的是同一个东西—布局重新计算。这是一个用户阻塞操作，它重新计算元素的尺寸和在文档中的位置。</p><p id="4dcb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种事经常发生:</p><ul class=""><li id="8fa4" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">移动，动画，删除，插入，更新一个DOM元素</li><li id="506c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">修改页面内容，例如在输入框中写入内容</li><li id="6e3d" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">更改CSS样式</li><li id="b2ff" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">滚动，调整窗口大小</li><li id="b8ed" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">测量一个元素——例如<code class="fe mb mc md me b">offsetHeight</code></li></ul><p id="8658" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有关触发布局重新计算的javascript操作的详细列表，请查看此<a class="ae ma" href="https://gist.github.com/paulirish/5d52fb081b3570c81e3a" rel="noopener ugc nofollow" target="_blank">列表</a>。还有一个CSS属性的列表。</p><h2 id="974c" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">9.1.如何避免它的一些提示</h2><ul class=""><li id="9f4d" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">对于变化太频繁的元素，使用<code class="fe mb mc md me b">fixed</code> / <code class="fe mb mc md me b">absolute</code>位置</li><li id="739a" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">把<code class="fe mb mc md me b">display</code>换成<code class="fe mb mc md me b">visibility</code></li><li id="c2fc" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">对布局使用伸缩框</li><li id="2337" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">使用<code class="fe mb mc md me b">cssText</code>进行多个布局更改</li><li id="f356" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">用<code class="fe mb mc md me b">textContent</code>代替<code class="fe mb mc md me b">innerText</code></li></ul><h2 id="c362" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">9.2.<code class="fe mb mc md me b">contain</code> CSS属性</h2><p id="af39" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果有很多样式重新计算，请使用<code class="fe mb mc md me b">container: content</code> CSS属性。它告诉浏览器，该元素与周围的文档是隔离的，所以如果其中有什么变化，就不需要重新计算整个布局。</p><h2 id="5df5" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">9.3.累积布局偏移— CLS</h2><p id="43e7" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">下图非常恰当地描述了累积布局偏移的含义:</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8f541a195dd44c424c1ba4bae6d5f227.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F87Ue6qQHSdpT7st.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://web.dev/optimize-cls/" rel="noopener ugc nofollow" target="_blank">https://web.dev/optimize-cls/</a></figcaption></figure><p id="ea5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">CLS是谷歌定义的<a class="ae ma" href="https://web.dev/vitals/" rel="noopener ugc nofollow" target="_blank">核心网络要素</a>之一。它衡量视觉稳定性和意想不到的布局变化量。每当一个可见实体在两个框架之间改变其起始位置时，就会发生布局移动。</p><p id="ae30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如图所示，这会让用户体验变得非常糟糕。它可能由以下原因引起:</p><ul class=""><li id="927e" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">不可见文本的闪烁</li><li id="fe7a" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">FOUT —无样式文本的闪现</li><li id="f14b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">FOUC —未样式化内容的flash</li><li id="b9ce" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">使用图像、嵌入、横幅广告等。没有具体的尺寸</li><li id="c3c1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">任何动态注入的内容</li></ul><p id="18d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了提高CLS或将其从您的第一次装载中完全移除，您可以使用以下策略:</p><ul class=""><li id="4728" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">显示白页，直到应用程序完全加载</li><li id="a90d" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">实现框架屏幕——页面中填充了具有预定义尺寸和一些加载指示器的框</li><li id="7e70" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">对于字体，使用<code class="fe mb mc md me b">display: swap;</code>属性并通过链接标签预加载它们</li></ul><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qx"><img src="../Images/e35356894a4f2c24fa5057f2f5d6bcc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qn6FQERW2ryN-t88gHiWTQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">媒体主页骨架屏幕的实现</figcaption></figure><h1 id="abe0" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">10.外部脚本</h1><p id="d907" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在页面解析过程中，当浏览器遇到一个<code class="fe mb mc md me b">&lt;script&gt;</code>元素时，它开始下载并执行它。这将停止HTML页面的解析过程。这可能导致两个主要问题:</p><ul class=""><li id="5085" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">在这些脚本加载和执行之前，用户可能只能看到白页</li><li id="f708" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">被执行的脚本不能访问它下面的DOM元素，因为它们还没有被解析</li><li id="4f87" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">该页面在很长一段时间内是不交互的</li></ul><p id="eaed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在现代网页上，通常javascript是最重要的东西——就其大小和执行时间而言。对于GTM、Adobe发布会、营销脚本、A/B测试库、嵌入视频等第三方脚本来说更是如此。</p><h2 id="64e4" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">10.1.延迟和异步脚本标记</h2><p id="346a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">为了避免HTML解析的阻塞，可以在外部脚本标签上使用<code class="fe mb mc md me b">defer</code>和<code class="fe mb mc md me b">async</code>属性。它们不适用于内联脚本。</p><h2 id="1257" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">正常(同步)执行</h2><p id="de2e" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">默认情况下，javascript文件会中断HTML文档的解析，以便获取和执行它们。</p><p id="b976" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">避免白页和DOM元素访问问题的一个方法是，你可以把你的脚本放在<code class="fe mb mc md me b">&lt;/body&gt;</code>标签之前，但另一方面，页面加载时间仍然会更长。</p><div class="mg mh mi mj gt ab cb"><figure class="qy jr qz ra rb rc rd paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/671d86ed85e5e939574f581dfe19e2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/0*MsmGX53qdZm_666G.png"/></div></figure><figure class="qy jr re ra rb rc rd paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/6f79a8e501b52efda002b506009d768e.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/0*Xt6OlJ9fpg5sCD4o.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk rf di rg rh translated"><a class="ae ma" href="https://flaviocopes.com/javascript-async-defer/" rel="noopener ugc nofollow" target="_blank">https://flaviocopes.com/javascript-async-defer/</a></figcaption></figure></div><h2 id="9266" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">异步ˌ非同步(asynchronous)</h2><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="3f7f" class="mo kx iq me b gy oy oz l pa pb">&lt;script <strong class="me ir">async</strong> src="script.js"&gt;&lt;/script&gt;</span></pre><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/caf6305f92dc191477a28411381f0e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gVh23wLofcHGvJlDk0lXkQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">异步属性<a class="ae ma" href="https://caniuse.com/script-async" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/script-async</a></figcaption></figure><p id="5b6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mb mc md me b">async</code>属性向浏览器指示脚本可以与HTML解析并行提取，但是在提取之后开始执行——在执行期间，HTML解析暂停。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ri"><img src="../Images/2c040158e8584bcd8f1059261981c0bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*W40fW8s1OlrgyHJ3.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://flaviocopes.com/javascript-async-defer/" rel="noopener ugc nofollow" target="_blank">https://flaviocopes.com/javascript-async-defer/</a></figcaption></figure><p id="a258" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为获取和执行是异步的，所以不保留<code class="fe mb mc md me b">async</code>脚本的顺序。</p><h2 id="8af6" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">推迟</h2><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="6280" class="mo kx iq me b gy oy oz l pa pb">&lt;script <strong class="me ir">defer</strong> src="script.js"&gt;&lt;/script&gt;</span></pre><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qs"><img src="../Images/029b87812b17eee62f40b14735a47445.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bsOm-stDU26kZnQ1-jd1qw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">延期属性<a class="ae ma" href="https://caniuse.com/script-defer" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/script-defer</a></figcaption></figure><p id="effb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mb mc md me b">defer</code>属性在获取方式上与<code class="fe mb mc md me b">async</code>属性类似，但是下载的脚本只有在HTML解析完成之后，就在<code class="fe mb mc md me b">domInteractive</code>事件之后执行。它还确保了这些脚本的执行顺序。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi rj"><img src="../Images/b34f4e9ffd2cbef1c415b2c4185fa1fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*K3ulsUz-GkXCyTb6.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://flaviocopes.com/javascript-async-defer/" rel="noopener ugc nofollow" target="_blank">https://flaviocopes.com/javascript-async-defer/</a></figcaption></figure><h2 id="a04b" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">选什么？</h2><p id="b7be" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">我的建议是对您自己的脚本使用<code class="fe mb mc md me b">defer</code>属性。它确保您更快的页面加载和保持脚本执行的顺序。</p><h2 id="7330" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">可供选择的事物</h2><p id="6f1b" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">有一个凯尔·辛普森写的小库叫做<a class="ae ma" href="https://github.com/getify/LABjs" rel="noopener ugc nofollow" target="_blank"> LABjs </a>。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/getify/LABjs" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">getify/labj</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">重要:这个项目正在经历一个完整的3.0重写。请跟踪进度。LABjs是一个动态脚本…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rk l of og oh od oi jw nu"/></div></div></a></div><p id="ebee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个库通过全面的跨浏览器支持对加载过程提供了更多的控制，并试图并行下载尽可能多的代码。</p><h2 id="a5d7" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">10.2.自定义延迟脚本</h2><p id="7bf1" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">为了允许页面完全加载并具有交互性，我们可以为GTM、Adobe launch等第三方创建自定义的延迟脚本。</p><p id="9083" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">目标很明确——只有在页面加载后才加载第三方脚本。这可以通过以下脚本实现:</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="2b7b" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">10.3.第三方资源阻止</h2><p id="55f9" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">对于更高级的脚本加载操作，您可以结合不同的技术。</p><p id="efc2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，您可以使用一些库来阻止第三方脚本，如<a class="ae ma" href="https://github.com/elbywan/yett" rel="noopener ugc nofollow" target="_blank"> yett </a>，然后，当用户进行交互时或在TTI(交互时间)后，您可以取消阻止这些脚本。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/elbywan/yett" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">埃尔比万/耶特</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">只需将yett放在html的顶部，它将允许您阻止和延迟其他脚本的执行。[ ❓]…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rl l of og oh od oi jw nu"/></div></div></a></div><p id="751d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">TTI是通过监控性能API和CPU活动周期在客户端计算的。这样做的好处是，谷歌灯塔不会监控TTI之后执行的代码。对于TTI活动，您可以使用谷歌的<a class="ae ma" href="https://github.com/GoogleChromeLabs/tti-polyfill" rel="noopener ugc nofollow" target="_blank"> tti-polyfill </a>库或其他一些库，例如<a class="ae ma" href="https://github.com/gauravbehere/time-to-interactive" rel="noopener ugc nofollow" target="_blank">互动时间</a>库。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/GoogleChromeLabs/tti-polyfill" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">GoogleChromeLabs/tti-polyfill</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">用于交互时间度量的聚合填充。有关深入的实施细节，请参见指标定义。你可以…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rm l of og oh od oi jw nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://github.com/gauravbehere/time-to-interactive" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">gauravbehere/互动时间</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">为web应用程序演示的真实用户监控(RUM)报告交互时间(tti)的实用程序…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rn l of og oh od oi jw nu"/></div></div></a></div><h2 id="39dc" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">10.4.适应性计算</h2><p id="c5ce" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">另一种方法是自适应计算。与TTI类似，您可以获得设备容量和网络速度。根据这些指标，您可以解锁被阻止的第三方资源。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ro"><img src="../Images/0747ad141827b831daaa4301607c3c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bcSmigOL0fp1rdnbjejqyA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/mdn-api_networkinformation" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/mdn-api_networkinformation</a></figcaption></figure><p id="1b40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了获得所需的度量，可以使用<a class="ae ma" href="https://developer.mozilla.org/en-US/docs/Web/API/Network_Information_API" rel="noopener ugc nofollow" target="_blank">网络信息API </a>。不幸的是，它在浏览器中的支持很差。解决方法是使用聚合填料:</p><div class="nr ns gp gr nt nu"><a href="https://mattsnider.com/network-information-api-polyfill/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">网络信息API poly fill MattSnider.com</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">浏览器正在慢慢实现许多新的HTML5 APIs，其中之一是网络信息API。它暴露了…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">mattsnider.com</p></div></div></div></a></div><p id="3f83" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">React还有一个名为<a class="ae ma" href="https://github.com/GoogleChromeLabs/react-adaptive-hooks" rel="noopener ugc nofollow" target="_blank"> react-adaptive-hooks </a>的库。通过这种方式，您可以控制在连接速度较慢的设备上加载组件，或者根据设备速度进行加载。</p><p id="fa94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，您可以查看google开发人员提供的一些自适应加载示例:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/GoogleChromeLabs/adaptive-loading" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">Google chrome labs/自适应加载</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">探索如何基于暴露于web的信号加载和呈现最合适的组件版本…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rp l of og oh od oi jw nu"/></div></div></a></div><h1 id="8475" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">11.前期战略</h1><p id="225a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">让我们看看如何在解析期间预加载、预取一些资源，甚至是用户将来可能导航的整个页面，以改善用户体验和未来页面的速度指标。</p><h2 id="2ac6" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">11.1.链接标签前置属性</h2><p id="2468" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">应用预策略最简单的解决方案是对link元素的<code class="fe mb mc md me b">rel</code>属性使用特定的值。</p><h2 id="8905" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">DNS预取</h2><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="03c6" class="mo kx iq me b gy oy oz l pa pb">&lt;link <strong class="me ir">rel="dns-prefetch"</strong> href="//example.com"&gt;</span></pre><p id="e794" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">DNS预取用于指示将用于获取所需资源的来源，并且用户代理应该尽早解析该来源。这确保了当浏览器需要开始下载一些资源时，DNS查找将会完成，或者至少已经在进行中。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi rq"><img src="../Images/a281f7e0b41b5d66da31f93f13683756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQwnIYLWobhzp7quY96w7w.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/link-rel-dns-prefetch" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/link-rel-dns-prefetch</a></figcaption></figure><h2 id="045a" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated"><strong class="ak">预连接</strong></h2><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="d7b3" class="mo kx iq me b gy oy oz l pa pb">&lt;link <strong class="me ir">rel="preconnect"</strong> href="https://example.com"&gt;</span></pre><p id="4da6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">类似于<em class="lz"> dns预取</em>，但是当<em class="lz">预连接</em>时，它将执行dns查找、TLS协商和TCP握手。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi rr"><img src="../Images/09ce23284dc9842923933cee35920a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x3Y5H_794qT9AsrvECqyBA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/link-rel-preconnect" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/link-rel-preconnect</a></figcaption></figure><h2 id="8ffe" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">事先装好</h2><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="7952" class="mo kx iq me b gy oy oz l pa pb">&lt;link <strong class="me ir">rel="preload"</strong> href="image.png"&gt;</span></pre><p id="b81a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">告诉浏览器<em class="lz">预加载</em>特定的静态资产(js、css、图片等)。)您知道它将需要它们，但是在解析期间浏览器对此一无所知。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qs"><img src="../Images/982f3bbdac14b51b2f5b8b302553be6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMbxwXKVIAPlL8GZBcDJCQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/link-rel-preload" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/link-rel-preload</a></figcaption></figure><p id="88d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有一个用于生成预加载标签的webpack插件叫做<a class="ae ma" href="https://www.npmjs.com/package/preload-webpack-plugin" rel="noopener ugc nofollow" target="_blank"> webpack-preload-plugin </a>。</p><h2 id="4fdd" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">预取</h2><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="964c" class="mo kx iq me b gy oy oz l pa pb">&lt;link <strong class="me ir">rel="prefetch"</strong> href="image.png"&gt;</span></pre><p id="035e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz">预取</em>也仅适用于静态资产，因为<em class="lz">预载</em>。这里的主要区别是，它预取未来页面所需的资源。这意味着当用户导航到使用先前预取的资产的特定页面时，它会被立即交付。</p><p id="ca90" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在不同的浏览器中，此功能的实现可能会有所不同。例如，Firefox只会在浏览器空闲时预取资源<a class="ae ma" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Link_prefetching_FAQ" rel="noopener ugc nofollow" target="_blank"/>。链接预取也没有同源限制。</p><p id="da28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用这种类型的功能时要小心。因为它是下载一些网页所需的资源，而浏览你的网站的用户可能不会访问这些网页。这只会为它们创造额外的带宽。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi rq"><img src="../Images/65a7fb232a38f698e4701f588e7cbaae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIbhKjkWN1k5Yqmr0FrK4A.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/link-rel-prefetch" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/link-rel-prefetch</a></figcaption></figure><h2 id="66f3" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">前置放大器</h2><pre class="mg mh mi mj gt ou me ov ow aw ox bi"><span id="da07" class="mo kx iq me b gy oy oz l pa pb">&lt;link <strong class="me ir">rel="prerender"</strong> href="https://example.com"&gt;</span></pre><p id="c7e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz">预渲染</em>比其他提到的选项更强大。你可以把它想象成一个隐藏的标签，预先呈现整个页面——下载静态资产，应用CSS，执行JS。因此，当用户导航到该页面时，它会立即出现。</p><p id="7b5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">至于预取，同样的规则也适用于此——额外的带宽有时是不必要的。当涉及到google analytics时，这也很棘手——事件被触发，但用户可能不会访问该网站。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi rs"><img src="../Images/bd05b143e40e99f94b0f0bad33cd7bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qyNSSKhFryMBgttmdsUgFg.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/link-rel-prerender" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/link-rel-prerender</a></figcaption></figure><h2 id="0055" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">11.2.预测预取</h2><p id="f7f5" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">预测抓取是一种加速导航的技术，它巧妙地预测用户未来将去的页面，并根据该信息下载下一页资源。为了实现这一功能，您可以使用我们将要深入研究的一些库的组合。</p><h2 id="04a1" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">瞬间点击</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/dieulot/instantclick" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">死亡/瞬间点击</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">使用InstantClick所需的所有信息都在上面的链接中。本自述文件的目的是关于如何使用和…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rt l of og oh od oi jw nu"/></div></div></a></div><p id="8c07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz"> InstantClick </em>是一个不再维护的库。它的主要概念是预加载用户悬停的链接。通常在悬停和点击之间是200毫秒到300毫秒。</p><p id="de46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不幸的是，如果服务器在300毫秒内没有响应，那么TTFB(到第一个字节的时间)比这个时间长，用户可能不会注意到任何差异。</p><h2 id="64a2" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">即时页面</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/instantpage/instant.page" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">instantpage/instant.page</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">ℹ️信息在网站上。📜源代码在instantpage.js中。🌟启动该存储库以跟踪其发展。与……</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="ru l of og oh od oi jw nu"/></div></div></a></div><p id="0f1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz"> Instant.page </em>在做和<em class="lz"> InstantClick </em>库一样的事情，但是这个项目还是被保留了下来。它应用了65毫秒的延迟——正如他们所说的，如果用户在页面上停留的时间超过65毫秒，用户很有可能也会点击它。TTFB的规则在这里也适用。</p><h2 id="9cf2" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">快速链接</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/GoogleChromeLabs/quicklink" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">Google chrome labs/快速链接</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">通过在空闲时间预取视窗内链接来加快后续页面加载速度快速链接尝试进行导航…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rv l of og oh od oi jw nu"/></div></div></a></div><p id="1233" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz">快速链接</em>略有不同。它预加载了视口中的所有链接，因此用户不必将鼠标悬停在任何链接上。<em class="lz">快速链接</em>的功能如下:</p><ul class=""><li id="a6f2" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">通过使用交叉点观察器API，它检测视口内的链接</li><li id="d973" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">使用requestIdleCallback等待浏览器空闲</li><li id="86c4" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">检查用户是否不在慢速连接上(<em class="lz">navigator . connection . effective type</em>)或者是否启用了数据保护程序(<em class="lz">navigator . connection . savedata</em>)</li><li id="862c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">将URL预取到链接(<em class="lz"> &lt; link rel=prefetch &gt;或XHR </em>)</li></ul><p id="4884" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于这在某些情况下很有用，如果视窗中有大量链接，请小心，因为<em class="lz">快速链接</em>告诉浏览器同时预取所有链接。这将造成高服务器负载。</p><p id="292f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设你有100个活跃用户，比如说在viewport中有20个链接。服务器将在那时加载2000页——如果你的服务器没有准备好，它将崩溃，这不是你想要的。</p><p id="ea3b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，它不预取动态注入的链接，因为<em class="lz">快速链接</em>仅在初始加载期间找到网页上的所有链接。</p><p id="eede" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于React，你可以使用<a class="ae ma" href="https://github.com/ibrahimcesar/react-quicklink" rel="noopener ugc nofollow" target="_blank"> react-quicklink </a>库。</p><h2 id="c2e9" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">飞扬的书页</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/gijo-varghese/flying-pages" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">gijo-varghese/飞行页面</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">快速入门:带选项:飞行页面注入一个微小的JavaScript代码(1KB gzipped)，等待直到浏览器变成…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="rw l of og oh od oi jw nu"/></div></div></a></div><p id="a54d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz"> Flying pages </em>试图结合来自<em class="lz"> Quicklink </em>和<em class="lz"> Instant.page. </em>的最佳链接，它检测视窗中的所有链接，然后将它们添加到队列中。队列中的链接每秒最多处理3个请求，这可以防止服务器崩溃。类似于<em class="lz"> Instant.page </em>它在悬停时预加载链接。当它检测到一个缓慢的连接或崩溃的服务器，它停止预加载过程。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi rx"><img src="../Images/c4be35a9cd63d3d91f23e2f69138c6fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZeytElHaaZks7VuhxCCRNA.png"/></div></div></figure><h2 id="763e" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">Guess.js</h2><div class="nr ns gp gr nt nu"><a href="https://github.com/guess-js/guess" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">guess-js/guess</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">用于在web上实现数据驱动的用户体验的库和工具。安装和配置GuessPlugin - the…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="ry l of og oh od oi jw nu"/></div></div></a></div><p id="a114" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz"> Guess.js </em>是Google在2018年宣布开发的用于自动化<em class="lz">预测预取</em>的专用库。文件上说:</p><blockquote class="rz sa sb"><p id="7499" class="jy jz lz ka b kb kc kd ke kf kg kh ki sc kk kl km sd ko kp kq se ks kt ku kv ij bi translated">Guess.js提供了一个库集合，用于为Web提供机器学习驱动的体验。</p></blockquote><p id="2d98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它使用谷歌分析API和机器学习模型来预测用户可能从当前页面进入的未来页面。</p><p id="15b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它还有一个webpack插件:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/guess-js/guess/tree/master/packages/guess-webpack" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">guess-js/guess</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">🔮用于在web上实现机器学习驱动的用户体验的库和工具</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="sf l of og oh od oi jw nu"/></div></div></a></div><h2 id="8ab3" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">11.3.预热</h2><p id="4c0d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">其概念是将代码获取与其执行分离开来。这种策略缩短了初始绘制和渲染时间，因为主线程不需要在同一个节拍上执行代码。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="fd6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这可能会使你的绘画和渲染时间低于50毫秒。</p><h1 id="4ca6" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">12.协议</h1><h2 id="91d8" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">12.1.HTTP/1.1</h2><p id="0418" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">该协议较旧，有更新的替代协议。缺点是:</p><ul class=""><li id="af98" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">文本协议—应使用文件串联来跟上</li><li id="aefa" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">浏览器在每个原点打开4到8个连接</li><li id="71cd" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">每个连接一个客户端-服务器请求</li><li id="dc4b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">没有压缩的较大标题</li></ul><h2 id="20e8" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">12.2.HTTP/2</h2><p id="2065" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">更喜欢使用这个协议。相对于<em class="lz"> HTTP/1.1 </em>的好处是:</p><ul class=""><li id="c64b" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">二进制协议—无需连接文件</li><li id="7cd1" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">支持多路复用—可以同时发送多个请求和响应</li><li id="0990" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">使用比称为<a class="ae ma" href="https://tools.ietf.org/html/rfc7541" rel="noopener ugc nofollow" target="_blank"> HPACK </a>的<em class="lz"> HTTP/1.1 </em>更高级的头压缩</li><li id="a3a2" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">每个原点使用一个连接</li><li id="7f1c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">启用服务器推送</li><li id="1fd9" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">不要求使用加密(例如TLS)，但是没有浏览器支持未加密的<em class="lz"> HTTP/2 </em></li></ul><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/c18798331d12ece382cb8b6d12880ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avpPgthhNJcT80lfj3_cZw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/http2" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/http2</a></figcaption></figure><p id="07c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢自己动手看看HTTP/1.1和HTTP/2有什么不同，你可以在这里查看一下:</p><div class="nr ns gp gr nt nu"><a href="https://http2.golang.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">Go + HTTP/2</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">欢迎来到Go语言的HTTP/2演示和互操作服务器。恭喜你，你现在正在使用HTTP/2。此服务器…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">http2.golang.org</p></div></div></div></a></div><h2 id="e529" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">12.3.HTTP上的QUIC(HTTP/3草案)</h2><p id="3961" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">与之前版本的主要区别在于<em class="lz"> HTTP/3 </em>使用了<a class="ae ma" href="https://tools.ietf.org/html/draft-ietf-quic-http-29" rel="noopener ugc nofollow" target="_blank"> <em class="lz"> QUIC </em> </a>而不是<em class="lz"> TCP </em>。这提高了同时获取多个对象的性能。</p><p id="3d1d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了<em class="lz"> HTTP/2 </em>，在<em class="lz"> TCP </em>连接中的任何丢包都会阻塞所有流(这被称为<em class="lz">线头阻塞</em>)。因为<em class="lz"> HTTP/3 </em>是基于<a class="ae ma" href="https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/" rel="noopener ugc nofollow" target="_blank"> UDP的</a>，如果一个包被丢弃，那只会中断一个流，而不是所有的流。</p><p id="bbb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它还提供0次往返(0-RTT)恢复，这意味着后续连接在建立连接时消除了来自服务器的TLS确认，因此它们可以更快地启动。</p><div class="mg mh mi mj gt ab cb"><figure class="qy jr sg ra rb rc rd paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/9059e929a35ebfc1abdcd71dd6e6d8f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/0*QBMOTLQ4FCKruziE.png"/></div></figure><figure class="qy jr sh ra rb rc rd paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/851e3965d4626cfda2eb5e0c93383f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/0*Oy2YotN__7PTdrCw.png"/></div></figure></div><p id="8951" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于HTTP/3的好处听起来很大，目前几乎没有对它的支持。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi si"><img src="../Images/044d836480c59bef94db84723b70535f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VqFA2bHsodc48Uj0VnXuJQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/http3" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/http3</a></figcaption></figure><h2 id="a866" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">12.4.HTTPS和HSTS</h2><p id="a98a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如前所述，没有浏览器支持不加密的HTTP/2，因此需要启用它。</p><p id="a7db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一方面，浏览器默认使用HTTP协议而不是HTTPS。通常，这可以通过重定向用户服务器端以使用HTTPS协议来解决。</p><p id="732c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了提高性能，应该避免这种重定向。而不是重定向使用HSTS，它代表HTTP严格传输安全T21。您可以使用响应头来实现它。这告诉浏览器将协议从HTTP更改为HTTPS有效，并要求浏览器对每个请求都这样做。</p><p id="927c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你也可以在hstspreload.org注册你的网站，这将确保如果一个新用户来到你的页面，它会使用HTTPS服务。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qu"><img src="../Images/5d9074af040073e1d0702735fb423509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lqO7PPz2DIYIYaVofcHdA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/stricttransportsecurity" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/stricttransportsecurity</a></figcaption></figure><h1 id="a76b" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">13.贮藏</h1><p id="cff7" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">缓存很重要，原因如下:</p><ul class=""><li id="38c5" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated">有助于减轻数据库—服务器缓存—的压力</li><li id="f21f" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">提供更好的UX，因为缓存的资源或内容会立即提供给最终用户—浏览器缓存</li></ul><h2 id="9257" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">13.1.服务器缓存</h2><p id="b31d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">服务器缓存是一种主要用于动态页面的技术。你应该缓存整个HTML页面，把它保存到某个数据库中，而不是在服务器上呈现并从数据库中接收所有需要的信息，你只需要加载保存的模板并把它提供给用户。</p><p id="a4b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，您可以使用支持此功能的不同开源工具。其中一些是:</p><ul class=""><li id="900e" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae ma" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank"> Redis </a></li><li id="13fa" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://memcached.org/" rel="noopener ugc nofollow" target="_blank"> Memcached </a></li><li id="72b8" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://ignite.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇点燃</a></li><li id="3ffd" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.couchbase.com/" rel="noopener ugc nofollow" target="_blank"> Couchbase服务器</a></li><li id="5c8b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://hazelcast.org/" rel="noopener ugc nofollow" target="_blank">哈泽卡斯特IMDG </a></li><li id="7227" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/facebook/mcrouter" rel="noopener ugc nofollow" target="_blank"> Mcrouter </a></li><li id="a723" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://varnish-cache.org/" rel="noopener ugc nofollow" target="_blank">上光液缓存</a></li><li id="9910" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://www.squid-cache.org/" rel="noopener ugc nofollow" target="_blank">鱿鱼</a></li><li id="9f47" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://nginx.org/en/" rel="noopener ugc nofollow" target="_blank"> NGINX </a></li><li id="8722" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://trafficserver.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇交通服务器</a></li><li id="ddb5" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://cloud.google.com/apigee" rel="noopener ugc nofollow" target="_blank">阿皮亚吉</a></li></ul><h2 id="281f" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">13.2.HTTP缓存头</h2><p id="2357" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">使用缓存头，您可以通过建立确保内容新鲜度的最佳缓存策略来控制您的缓存策略。</p><h2 id="c273" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated"><strong class="ak">缓存控制指令</strong></h2><ul class=""><li id="b38d" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated"><strong class="ka ir"> public </strong> —资源可以被任何缓存器缓存</li><li id="0310" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir"> private </strong> —表示资源是特定于用户的，因此仍然可以缓存，但只能在用户的设备上缓存</li><li id="a95f" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir">无缓存</strong> —浏览器可以缓存响应，但必须首先提交验证请求</li><li id="a3c2" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir">无存储</strong> —完全禁用缓存，每次请求时都必须下载资源</li><li id="922c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir"> max-age=[seconds] — </strong>设置缓存资源需要刷新后的时间限制(秒)</li><li id="94ff" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir">必须重新生效</strong> —表示必须严格遵守<em class="lz">最大年龄</em>和<em class="lz">过期</em>标头—禁止为过期资源提供服务</li><li id="301c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir">无转换— </strong>告知任何边缘服务器(缓存、代理)不要对原始资产进行任何修改—例如，如果资源是以未压缩的形式接收的，则不允许边缘服务器以压缩的形式发送</li></ul><h2 id="a7c2" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">扩展缓存控制指令</h2><ul class=""><li id="352e" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated"><strong class="ka ir">不可变</strong>——一旦资源被缓存，浏览器将永远不会发送条件请求来检查更改</li><li id="d1c9" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir">stale-while-re validate =[seconds]—</strong>浏览器使用缓存的文件，但在以秒为单位的过期时间过后在后台更新它们</li><li id="8013" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><strong class="ka ir"> stale-if-error </strong> —类似于<em class="lz"> stale-while-revalidate </em>，但它仅在源服务器返回错误代码时返回陈旧内容</li></ul><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi sj"><img src="../Images/aedcdcea60725c6e700cb0f73290e72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEmvuRFp97zSZXNGA5Ypag.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTTP/Headers/Cache-Control</a></figcaption></figure><h2 id="ac4d" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated"><code class="fe mb mc md me b"><strong class="ak">Expires</strong></code></h2><p id="e029" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">类似于<em class="lz"> Cache-Control: max-age，</em>但是这里你需要设置一个具体的日期，而不仅仅是秒。它指示内容过期和删除的时间。然而，当提供了<em class="lz">缓存控制:最大年龄</em>指令时，将忽略<em class="lz">过期</em>头。</p><h2 id="aca3" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">ETag</h2><p id="0e5c" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">根据哈希或令牌标识所提供内容的版本。如果令牌或哈希发生变化，缓存将失效。</p><p id="7f4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如<a class="ae ma" href="http://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>库自动生成<a class="ae ma" href="http://expressjs.com/en/5x/api.html#etag.options.table" rel="noopener ugc nofollow" target="_blank"> <em class="lz"> ETag </em>头</a>。</p><h2 id="a417" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">最后修改的</h2><p id="1962" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">该头指定了上次修改资源的时间。这可用作验证策略的一部分，以确保内容新鲜。</p><h2 id="5923" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">变化</h2><p id="6591" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">这最常用于告诉缓存也通过<code class="fe mb mc md me b">Accept-Encoding</code>头进行键操作，以便缓存知道如何区分压缩和未压缩的内容。如果使用得当，Vary可以成为管理多个文件版本交付的强大工具。例如，标题<code class="fe mb mc md me b">Vary: Accept-Language, User-Agent</code>指定对于用户代理和语言的每种组合，必须存在一个缓存版本。</p><h2 id="c4c6" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">13.3.有哪些标题使用建议？</h2><ul class=""><li id="6274" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">不要对静态资产使用动态生成的URL</li><li id="4454" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">尽可能使用CSS图像精灵——它减少了往返次数，并允许浏览器长时间缓存图像</li><li id="605d" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">为您的文件添加唯一标识符—就像webpack生成块或模块时所做的那样，您可以为其设置文件/块名模板。这有助于您最大化缓存持续时间，并且当文件内容改变时，标识符也会改变，因此浏览器将下载该新文件</li><li id="def9" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">对所有公共资产使用<code class="fe mb mc md me b">public</code>缓存控制指令</li><li id="8015" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">允许浏览器也缓存用户特定的资产</li><li id="56c0" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">如果您有时间敏感的内容，如购物车，请为它破例，因为您不想在关键情况下提供过时的内容。这可以通过<code class="fe mb mc md me b">no-cache</code>或<code class="fe mb mc md me b">no-store</code>指令来实现。</li><li id="2863" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">总是提供验证器作为<code class="fe mb mc md me b">ETag</code>或<code class="fe mb mc md me b">Last-Modified</code>头</li></ul><h2 id="b33c" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">13.4.服务人员</h2><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ro"><img src="../Images/89cabce89f06f6749cc162249037481a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AkVfxWsaLv0J0IWfzqHsqg.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://caniuse.com/mdn-api_serviceworker" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/mdn-api_serviceworker</a></figcaption></figure><p id="464d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">服务工作者与渐进式web应用程序略有关联，因为它们提供了良好的缓存功能，可以预加载内容并在用户离线时提供服务。服务人员实际上是一个在浏览器后台运行的脚本，因此它在执行时不会影响用户体验。</p><p id="f3e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下图描述了服务工作者生命周期的工作方式。</p><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi sk"><img src="../Images/8e28487034a4e7a8715233be29e2c9e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HpfS979pzz871SJ4.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae ma" href="https://developers.google.com/web/fundamentals/primers/service-workers" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/web/fundamentals/primers/service-workers</a></figcaption></figure><ol class=""><li id="fa0f" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv nq nh ni nj bi translated">要安装服务人员，您需要注册它——这是通过javascript完成的</li><li id="2520" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">注册之后，浏览器开始安装步骤——这里您想要缓存静态资产</li><li id="fe93" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">如果缓存失败，将不会安装该工作进程</li><li id="0995" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">如果所有东西都被成功缓存，浏览器将进入激活步骤——这里您需要重新验证您的旧缓存</li><li id="e38a" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv nq nh ni nj bi translated">在它被激活后，服务工作者将控制其范围内的所有页面——这仅发生在第二次页面加载之后</li></ol><p id="a043" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了简化配置和生成服务工作者的过程，google提出了一个名为Workbox的javascript库集合。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/GoogleChrome/workbox/tree/master" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">谷歌浏览器/工具箱</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Workbox是一个用于渐进式Web应用程序的JavaScript库集合。npm上提供工具箱。我们有…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="sl l of og oh od oi jw nu"/></div></div></a></div><p id="c6f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它主要用于创建一个渐进式web应用程序，但是您可以只使用几个包来实现您的目标。</p><p id="3727" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一方面，你也可以使用他们的webpack插件包，<a class="ae ma" href="https://github.com/GoogleChrome/workbox/tree/master/packages/workbox-webpack-plugin" rel="noopener ugc nofollow" target="_blank">工具箱-webpack-plugin </a>，在那里你可以找到两个插件。一个(<em class="lz"> GenerateSW </em>)用于生成一个完整的服务工作器来缓存所有的webpack资产，另一个(<em class="lz"> InjectManifest </em>)用于只生成预缓存的资产列表。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h1 id="922b" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">14.有用的工具</h1><ul class=""><li id="c3b6" class="nb nc iq ka b kb lu kf lv kj om kn on kr oo kv ng nh ni nj bi translated">绩效预算<a class="ae ma" href="https://web.dev/use-lighthouse-for-performance-budgets/" rel="noopener ugc nofollow" target="_blank">https://web.dev/use-lighthouse-for-performance-budgets/</a></li><li id="4448" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">得分计算器<a class="ae ma" href="https://googlechrome.github.io/lighthouse/scorecalc/" rel="noopener ugc nofollow" target="_blank">https://googlechrome.github.io/lighthouse/scorecalc/</a></li><li id="9a3e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">业绩描述<a class="ae ma" href="https://web.dev/performance-scoring/" rel="noopener ugc nofollow" target="_blank">https://web.dev/performance-scoring/</a></li><li id="5a23" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">通过确定代码重复调整代码分割<a class="ae ma" href="https://www.npmjs.com/package/bundle-buddy" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/bundle-buddy</a></li><li id="643b" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">自动网页性能推荐<a class="ae ma" href="https://varvy.com/" rel="noopener ugc nofollow" target="_blank">https://varvy.com/</a></li><li id="dcf0" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">https://tools.pingdom.com/<a class="ae ma" href="https://tools.pingdom.com/" rel="noopener ugc nofollow" target="_blank">监控服务</a></li><li id="211e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">webpack性能提示【https://webpack.js.org/configuration/performance/ T4】</li><li id="dda5" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">检查您的包裹大小<a class="ae ma" href="https://github.com/siddharthkp/bundlesize" rel="noopener ugc nofollow" target="_blank">https://github.com/siddharthkp/bundlesize</a></li><li id="ef84" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">测量JS尺寸<a class="ae ma" href="https://github.com/ai/size-limit" rel="noopener ugc nofollow" target="_blank">https://github.com/ai/size-limit</a></li><li id="d77a" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated">负载测试工具<a class="ae ma" href="https://github.com/loadimpact/k6" rel="noopener ugc nofollow" target="_blank">https://github.com/loadimpact/k6</a></li></ul><p id="b3c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">性能和速度测试:</p><ul class=""><li id="b64f" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.uptrends.com/tools/website-speed-test" rel="noopener ugc nofollow" target="_blank">https://www.uptrends.com/tools/website-speed-test</a></li><li id="3bf8" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://gtmetrix.com/" rel="noopener ugc nofollow" target="_blank">https://gtmetrix.com/</a></li><li id="f269" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://tools.keycdn.com/speed" rel="noopener ugc nofollow" target="_blank">https://tools.keycdn.com/speed</a></li><li id="c86c" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.webpagetest.org/" rel="noopener ugc nofollow" target="_blank">https://www.webpagetest.org/</a></li><li id="bbb5" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://developers.google.com/speed/pagespeed/insights/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/speed/pagespeed/insights/</a></li><li id="4b48" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://www.dotcom-tools.com/website-speed-test.aspx" rel="noopener ugc nofollow" target="_blank">https://www.dotcom-tools.com/website-speed-test.aspx</a></li><li id="983e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://yellowlab.tools/" rel="noopener ugc nofollow" target="_blank">https://yellowlab.tools/</a></li><li id="ae24" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://developer.chrome.com/devtools" rel="noopener ugc nofollow" target="_blank">https://developer.chrome.com/devtools</a></li><li id="642e" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://performance.sucuri.net/" rel="noopener ugc nofollow" target="_blank">https://performance.sucuri.net/</a></li><li id="62e3" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://pagelocity.com/" rel="noopener ugc nofollow" target="_blank">http://pagelocity.com/</a></li><li id="94e3" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="http://yslow.org/" rel="noopener ugc nofollow" target="_blank">http://yslow.org/</a></li><li id="48c6" class="nb nc iq ka b kb nk kf nl kj nm kn nn kr no kv ng nh ni nj bi translated"><a class="ae ma" href="https://github.com/devbridge/Performance" rel="noopener ugc nofollow" target="_blank">https://github.com/devbridge/Performance</a></li></ul></div><div class="ab cl sm sn hu so" role="separator"><span class="sp bw bk sq sr ss"/><span class="sp bw bk sq sr ss"/><span class="sp bw bk sq sr"/></div><div class="ij ik il im in"><p id="1de1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">非常感谢你的阅读！</p></div></div>    
</body>
</html>