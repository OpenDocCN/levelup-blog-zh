<html>
<head>
<title>Running amd64 Linux On Apple M1 With qemu/utm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用qemu/utm在苹果M1上运行amd64 Linux</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/running-amd64-linux-on-apple-m1-with-qemu-utm-64d67cccd6f8?source=collection_archive---------1-----------------------#2021-11-09">https://levelup.gitconnected.com/running-amd64-linux-on-apple-m1-with-qemu-utm-64d67cccd6f8?source=collection_archive---------1-----------------------#2021-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="810e" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">M1 |苹果芯片| MAC OS | x86 _ 64 | amd64 | QEMU | UTM | Linux VM</h2><div class=""/><div class=""><h2 id="e8e5" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">哪种qemu CPU设置提供最佳性能。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3a034bcb179e69898cfaa8d29a9ffe8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNRoXWyd9W2-wv7C9jyYVw.png"/></div></div></figure><h1 id="1783" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">总结(TL；博士)</h1><p id="bbcc" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">这不是最好的体验——如果你只需要Linux，用arm64版本会好得多——但它工作得很好。但是，它比本机或arm64仿真慢得多。</p><h2 id="4132" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">更新(MacBook Pro 16“M1”)</h2><p id="4c83" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">没有显著差异。我的规格:10个CPU核心，32GB内存。但是<code class="fe mz na nb nc b">sysbench</code>配置为使用2核，所以没有区别。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="01f9" class="la lb iq bd lc ld nk lf lg lh nl lj lk kf nm kg lm ki nn kj lo kl no km lq lr bi translated">先决条件</h1><p id="3123" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">开始前安装<code class="fe mz na nb nc b">qemu</code>和<code class="fe mz na nb nc b">utm</code>。后者不是必需的，但会使生活变得容易得多。这假设你已经安装了自制软件。</p><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="8359" class="mo lb iq nc b gy nt nu l nv nw">brew install qemu utm</span></pre><h1 id="9fec" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">设置虚拟机</h1><p id="2ef3" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">启动<code class="fe mz na nb nc b">utm</code>并“创建一个新的虚拟机”，给它你想要的名字。</p><p id="c8dd" class="pw-post-body-paragraph ls lt iq lu b lv nx ka lx ly ny kd ma mb nz md me mf oa mh mi mj ob ml mm mn ij bi translated">转到驱动器，创建一个至少10GB大小的驱动器，越大越好。然后<code class="fe mz na nb nc b">import disk</code>从你选择的发行版中添加一个可引导的ISO。</p><h2 id="2afd" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">系统设置</h2><ul class=""><li id="1e88" class="oc od iq lu b lv lw ly lz mb oe mf of mj og mn oh oi oj ok bi translated">建筑:<code class="fe mz na nb nc b">x86_64</code></li><li id="751d" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">系统:<code class="fe mz na nb nc b">Standard PC (Q35....) (q35)</code></li><li id="5380" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">内存:<code class="fe mz na nb nc b">2048MB</code>以上(我用的是2048MB)</li><li id="d256" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><strong class="lu ja">高级设置</strong>:</li><li id="183f" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">CPU: <code class="fe mz na nb nc b">qemu64</code>对<code class="fe mz na nb nc b">Skylake-Client</code>对……</li><li id="683f" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">CPU内核:<code class="fe mz na nb nc b">4</code>或更多(我用了8个)</li><li id="dc3d" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">强制多核:✅(这显著提高了性能)</li></ul><p id="6562" class="pw-post-body-paragraph ls lt iq lu b lv nx ka lx ly ny kd ma mb nz md me mf oa mh mi mj ob ml mm mn ij bi translated"><strong class="lu ja">更新</strong>:使用新的<code class="fe mz na nb nc b">utm</code>用户界面，遵循以下步骤:</p><ul class=""><li id="a80a" class="oc od iq lu b lv nx ly ny mb oq mf or mj os mn oh oi oj ok bi translated">创建虚拟机→模拟</li><li id="a052" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">选择“Linux”</li><li id="72b6" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">浏览Linux安装ISO</li><li id="1c3a" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">…然后同上:架构、系统…</li><li id="4b89" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">完成后，再次进入虚拟机的设置:转到<code class="fe mz na nb nc b">System</code>并检查强制多核:✅</li></ul><h2 id="9336" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">安装操作系统</h2><p id="9663" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">从ISO映像启动后，在磁盘上安装操作系统。完成后，停止机器并从驱动器中删除ISO，然后启动新的虚拟机。你已经准备好玩它了。(提示:安装会比你预期的慢得多，所以请耐心等待。最好选择<code class="fe mz na nb nc b">qemu64</code>作为安装的CPU类型)。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="8a0e" class="la lb iq bd lc ld nk lf lg lh nl lj lk kf nm kg lm ki nn kj lo kl no km lq lr bi translated">基准</h1><ul class=""><li id="1459" class="oc od iq lu b lv lw ly lz mb oe mf of mj og mn oh oi oj ok bi translated">MacBook Air M1，16GB内存</li><li id="6a30" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">qemu + utm</li><li id="245a" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">来宾系统:Ubuntu 20.04桌面(最小安装)</li><li id="675e" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">sysbench cpu --threads=2 run</code></li></ul><h2 id="ea52" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">CPU sky lake-客户端(默认)</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="cbfa" class="mo lb iq nc b gy nt nu l nv nw"># cpu = Skylake-Client<br/>~$ </span><span id="fa24" class="mo lb iq nc b gy ot nu l nv nw">sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="21f2" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:   507.37</span><span id="1b57" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0039s<br/>    total number of events:              5080</span><span id="31c7" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    3.76<br/>         avg:                                    3.93<br/>         max:                                    5.82<br/>         95th percentile:                        4.18<br/>         sum:                                19962.08</span><span id="2e5c" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           2540.0000/5.00<br/>    execution time (avg/stddev):   9.9810/0.00</span></pre><h2 id="e6e5" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">CPU Penryn</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="a3ec" class="mo lb iq nc b gy nt nu l nv nw"># cpu = Penryn<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="62b9" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:  1455.74</span><span id="4f74" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0032s<br/>    total number of events:              14571</span><span id="7349" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    1.25<br/>         avg:                                    1.37<br/>         max:                                   52.02<br/>         95th percentile:                        1.52<br/>         sum:                                19948.56</span><span id="a89a" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           7285.5000/2.50<br/>    execution time (avg/stddev):   9.9743/0.00</span></pre><h2 id="f98a" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">CPU qemu64</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="3806" class="mo lb iq nc b gy nt nu l nv nw"># cpu = qemu64<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="5e1d" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:  1505.28</span><span id="4e7f" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0012s<br/>    total number of events:              15059</span><span id="63f4" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    1.24<br/>         avg:                                    1.32<br/>         max:                                    3.37<br/>         95th percentile:                        1.47<br/>         sum:                                19938.66</span><span id="0ce4" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           7529.5000/2.50<br/>    execution time (avg/stddev):   9.9693/0.00</span></pre><h2 id="bdc7" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">更新:M1 16英寸CPU qemu64</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="8899" class="mo lb iq nc b gy nt nu l nv nw"># cpu = qemu64<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="cac8" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:  1605.28</span><span id="91be" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0019s<br/>    total number of events:              16048</span><span id="063a" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    1.18<br/>         avg:                                    1.24<br/>         max:                                    3.83<br/>         95th percentile:                        1.32<br/>         sum:                                19931.65</span><span id="a1bf" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           8024.0000/10.00<br/>    execution time (avg/stddev):   9.9658/0.00</span></pre><h2 id="5f8a" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">CPU qemu64-v1</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="a232" class="mo lb iq nc b gy nt nu l nv nw"># cpu = qemu64-v1<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="8764" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:  1474.44</span><span id="0a0a" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0016s<br/>    total number of events:              14751</span><span id="8773" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    1.27<br/>         avg:                                    1.35<br/>         max:                                   21.82<br/>         95th percentile:                        1.55<br/>         sum:                                19923.12</span><span id="f286" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           7375.5000/30.50<br/>    execution time (avg/stddev):   9.9616/0.00</span></pre><h2 id="a2f0" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">CPU EPYC</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="ed47" class="mo lb iq nc b gy nt nu l nv nw"># cpu = EPYC<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="a94e" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:  1403.61</span><span id="a6d1" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0024s<br/>    total number of events:              14045</span><span id="d36a" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    1.36<br/>         avg:                                    1.42<br/>         max:                                    3.68<br/>         95th percentile:                        1.52<br/>         sum:                                19938.08</span><span id="47a9" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           7022.5000/1.50<br/>    execution time (avg/stddev):   9.9690/0.00</span></pre><h2 id="19bc" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">CPU Haswell</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="f239" class="mo lb iq nc b gy nt nu l nv nw"># cpu = Haswell<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="314a" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:   491.29</span><span id="0d99" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0044s<br/>    total number of events:              4919</span><span id="c253" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    3.74<br/>         avg:                                    4.06<br/>         max:                                   53.05<br/>         95th percentile:                        4.33<br/>         sum:                                19955.25</span><span id="4182" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           2459.5000/3.50<br/>    execution time (avg/stddev):   9.9776/0.00</span></pre><h2 id="625e" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">中央处理器kvm64</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="b9de" class="mo lb iq nc b gy nt nu l nv nw"># cpu = kvm64<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.18 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="b9e6" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second:  1506.38</span><span id="c13d" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0021s<br/>    total number of events:              15076</span><span id="0f5a" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    1.24<br/>         avg:                                    1.32<br/>         max:                                    2.83<br/>         95th percentile:                        1.44<br/>         sum:                                19951.28</span><span id="7d47" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           7538.0000/6.00<br/>    execution time (avg/stddev):   9.9756/0.00</span></pre><h1 id="15c9" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">当地的</h1><p id="370d" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">本机运行基准测试会产生以下结果:</p><p id="8c76" class="pw-post-body-paragraph ls lt iq lu b lv nx ka lx ly ny kd ma mb nz md me mf oa mh mi mj ob ml mm mn ij bi translated"><code class="fe mz na nb nc b">brew install sysbench</code></p><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="490f" class="mo lb iq nc b gy nt nu l nv nw">~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.20 (using system LuaJIT 2.1.0-beta3)<br/>[...]</span><span id="3e9a" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second: 21974674.98</span><span id="7cfa" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0001s<br/>    total number of events:              219755276</span><span id="82ae" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    0.00<br/>         avg:                                    0.00<br/>         max:                                    5.28<br/>         95th percentile:                        0.00<br/>         sum:                                 6512.92</span><span id="7457" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           109877638.0000/249382.00<br/>    execution time (avg/stddev):   3.2565/0.00</span></pre><h2 id="def9" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">M1的ARM64:</h2><pre class="kp kq kr ks gt np nc nq nr aw ns bi"><span id="ad8b" class="mo lb iq nc b gy nt nu l nv nw"># cpu = cortex-a72<br/>~$ sysbench cpu --threads=2 run<br/>sysbench 1.0.20 (using system LuaJIT 2.1.0-beta3)</span><span id="0e8c" class="mo lb iq nc b gy ot nu l nv nw">Running the test with following options:<br/>Number of threads: 2<br/>Initializing random number generator from current time</span><span id="8d13" class="mo lb iq nc b gy ot nu l nv nw">Prime numbers limit: 10000</span><span id="827d" class="mo lb iq nc b gy ot nu l nv nw">Initializing worker threads...</span><span id="8882" class="mo lb iq nc b gy ot nu l nv nw">Threads started!</span><span id="f3fd" class="mo lb iq nc b gy ot nu l nv nw">CPU speed:<br/>    events per second: 16194.69</span><span id="5697" class="mo lb iq nc b gy ot nu l nv nw">General statistics:<br/>    total time:                          10.0001s<br/>    total number of events:              161958</span><span id="8c59" class="mo lb iq nc b gy ot nu l nv nw">Latency (ms):<br/>         min:                                    0.12<br/>         avg:                                    0.12<br/>         max:                                    1.46<br/>         95th percentile:                        0.13<br/>         sum:                                19968.36</span><span id="52ea" class="mo lb iq nc b gy ot nu l nv nw">Threads fairness:<br/>    events (avg/stddev):           80979.0000/11.00<br/>    execution time (avg/stddev):   9.9842/0.00</span></pre></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="9c43" class="la lb iq bd lc ld nk lf lg lh nl lj lk kf nm kg lm ki nn kj lo kl no km lq lr bi translated">摘要</h1><p id="f821" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">所有基准测试都从<code class="fe mz na nb nc b">sysbench cpu --threads=2 run</code>开始</p><ul class=""><li id="d588" class="oc od iq lu b lv nx ly ny mb oq mf or mj os mn oh oi oj ok bi translated">本机(macOS): <strong class="lu ja"> ~每秒2400万</strong>个事件</li><li id="670d" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">Skylake-Client(默认):每秒约500个事件👎</li><li id="9b54" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">qemu64-v1:每秒约1500个事件</li><li id="0da7" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><strong class="lu ja"> qemu64 </strong> : <strong class="lu ja"> ~每秒1500 </strong>个事件👍</li><li id="9499" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">qemu64 + ssse3，sse4.1，sse4.2:每秒约1450个事件</li><li id="cc8a" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">每秒大约1500个事件</li><li id="9e62" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">Penryn + ssse3，sse4.1，sse4.2:每秒约1400个事件</li><li id="7c40" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">Haswell:每秒约500个事件👎</li><li id="8258" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">EPYC:每秒大约1400个事件</li><li id="f319" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">kvm64:每秒约1500个事件</li><li id="70d3" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">现象:每秒约1400个事件</li><li id="c01c" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">Nehalem:每秒约1400个事件</li><li id="cbea" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">禅那:每秒约500个事件👎</li><li id="137c" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">Opteron_G5: —不工作</li><li id="0a3d" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">马克斯:—不起作用</li><li id="d9fe" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">qemu64: ~1500(无变化)</li></ul></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="2d62" class="la lb iq bd lc ld nk lf lg lh nl lj lk kf nm kg lm ki nn kj lo kl no km lq lr bi translated">为了比较</h1><p id="d7a5" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">容器和arm64的一些基准测试。</p><h2 id="611f" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">系统设置</h2><ul class=""><li id="6cbb" class="oc od iq lu b lv lw ly lz mb oe mf of mj og mn oh oi oj ok bi translated">架构:<code class="fe mz na nb nc b">ARM64 (aarch64)</code></li><li id="2890" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">系统:<code class="fe mz na nb nc b">QEMU 6.1 ARM ... (virt)</code></li><li id="0537" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">操作系统:Fedora 35</li></ul><h2 id="190d" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">结果</h2><ul class=""><li id="da9a" class="oc od iq lu b lv lw ly lz mb oe mf of mj og mn oh oi oj ok bi translated">cortex-a72(默认):<strong class="lu ja"> ~每秒16200 </strong>个事件</li><li id="e4e7" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">默认值:每秒约16000个事件</li><li id="fd51" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">cortex-a8/a9/a15: —不工作</li><li id="0ea9" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated">马克斯:—不起作用</li></ul><h2 id="36e1" class="mo lb iq bd lc mp mq dn lg mr ms dp lk mb mt mu lm mf mv mw lo mj mx my lq iw bi translated">或者和Docker或Lima一起</h2><div class="ou ov gp gr ow ox"><a href="https://github.com/lima-vm/lima" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ja gy z fp pc fr fs pd fu fw iz bi translated">GitHub - lima-vm/lima: Linux虚拟机，在macOS上(又名“Linux-on-Mac”，“macOS子系统用于…</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">Lima推出了具有自动文件共享、端口转发和容器的Linux虚拟机。利马可以是…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">github.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl ky ox"/></div></div></a></div><ul class=""><li id="2797" class="oc od iq lu b lv nx ly ny mb oq mf or mj os mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">docker run -it --rm --platform=linux/amd64 ubuntu</code>:每秒约550个事件</li><li id="b02d" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">docker run -it --rm ubuntu</code> : (arm64) ~每秒550个事件‼️</li><li id="8e8a" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">lima</code> (arm64): <strong class="lu ja"> ~20200 </strong>每秒事件数🤘</li><li id="71d6" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">lima</code> (x86_64):每秒约260个事件</li><li id="9a02" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">lima container</code>(arm64 VM中的arm 64容器):<strong class="lu ja"> ~每秒21000 </strong>个事件🤘</li><li id="cbf6" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">lima container</code>(<a class="ae pm" href="https://github.com/lima-vm/lima/blob/master/docs/multi-arch.md" rel="noopener ugc nofollow" target="_blank">arm 64 VM</a>中的x86_64容器):每秒约570个事件</li><li id="0c13" class="oc od iq lu b lv ol ly om mb on mf oo mj op mn oh oi oj ok bi translated"><code class="fe mz na nb nc b">multipass</code> (arm64):每秒大约11000个事件(我没有找到一个选项来安装带有multipass的x86_64 VM)</li></ul></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="c44b" class="la lb iq bd lc ld nk lf lg lh nl lj lk kf nm kg lm ki nn kj lo kl no km lq lr bi translated">结论</h1><p id="338e" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">你可以在M1 Mac上运行x86_64 Linux虚拟机。但是，如果你依赖它的可用性类似于本地体验，那么苹果硅机不是你的正确选择。我仍然需要在一个新的M1 Max上测试这个，但是我怀疑在不久的将来这将会是一个有趣的经历。</p><p id="21b6" class="pw-post-body-paragraph ls lt iq lu b lv nx ka lx ly ny kd ma mb nz md me mf oa mh mi mj ob ml mm mn ij bi translated">然而，当你可以在一个Linux虚拟机上运行你所需要的一切时，你应该会很好。它离原生体验还很远，但比x86_64流畅得多(快10倍)。</p><p id="e16b" class="pw-post-body-paragraph ls lt iq lu b lv nx ka lx ly ny kd ma mb nz md me mf oa mh mi mj ob ml mm mn ij bi translated">我不是铁杆开发者，但我用MacBook Air做了很多事情。到目前为止，我还没有遇到大的障碍，因为我使用远程“真正的”Linux机器来处理工作负载，所以我不需要Linux VM。此外，到目前为止，我在docker中运行的一切都像预期的那样工作(除了这样一个事实，即当您需要x86_64或arm64还没有映像时，您必须提供<code class="fe mz na nb nc b">--platform=linux/amd64</code>)。</p><p id="f9a6" class="pw-post-body-paragraph ls lt iq lu b lv nx ka lx ly ny kd ma mb nz md me mf oa mh mi mj ob ml mm mn ij bi translated">Lima是新的，似乎是Mac Docker的一个很好的替代品。没有跨平台，它比Docker for Mac更容易。</p><div class="ou ov gp gr ow ox"><a href="https://medium.com/nttlabs/containerd-and-lima-39e0b64d2a59" rel="noopener follow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ja gy z fp pc fr fs pd fu fw iz bi translated">container d &amp; Lima:Mac版Docker的开源替代方案</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">今天，社区被一个突然的消息震惊了，Mac/Win版Docker桌面不再免费提供给…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">medium.com</p></div></div><div class="pg l"><div class="pn l pi pj pk pg pl ky ox"/></div></div></a></div><h1 id="1df5" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">谢谢你</h1><p id="2e3b" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">因为看了我的文章！支持或关注我在<a class="ae pm" href="http://github.com/drpsychick" rel="noopener ugc nofollow" target="_blank"> GitHub </a>、<a class="ae pm" href="https://drpsychick.org" rel="noopener ugc nofollow" target="_blank"> Medium </a>或<a class="ae pm" href="https://drpsychick.org/drpsychick-on-the-web-a9ccfb0df17e" rel="noopener ugc nofollow" target="_blank">别处</a>。</p><p id="cd4f" class="pw-post-body-paragraph ls lt iq lu b lv nx ka lx ly ny kd ma mb nz md me mf oa mh mi mj ob ml mm mn ij bi translated">我的相关文章</p><div class="ou ov gp gr ow ox"><a rel="noopener  ugc nofollow" target="_blank" href="/im-not-an-apple-fan-but-there-is-no-better-alternative-d1d5250de3d4"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ja gy z fp pc fr fs pd fu fw iz bi translated">我不是苹果粉丝，但没有更好的选择。</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">为什么Linux和Windows无法抗衡苹果生态系统。</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pg l"><div class="po l pi pj pk pg pl ky ox"/></div></div></a></div></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="c8d9" class="la lb iq bd lc ld nk lf lg lh nl lj lk kf nm kg lm ki nn kj lo kl no km lq lr bi translated">分级编码</h1><p id="9489" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">感谢您成为我们社区的一员！升级正在改变技术招聘。<a class="ae pm" href="https://jobs.levelup.dev/talent" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ja">在最好的公司找到你的完美工作</strong></a><strong class="lu ja"/>。</p><div class="ou ov gp gr ow ox"><a href="https://jobs.levelup.dev/talent" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ja gy z fp pc fr fs pd fu fw iz bi translated">提升——改变招聘流程</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">🔥让软件工程师找到他们热爱的完美角色🧠寻找人才是最痛苦的部分…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">作业. levelup.dev</p></div></div><div class="pg l"><div class="pp l pi pj pk pg pl ky ox"/></div></div></a></div></div></div>    
</body>
</html>