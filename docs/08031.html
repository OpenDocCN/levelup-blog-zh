<html>
<head>
<title>Upgrading to Gatsby 3.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">升级到Gatsby 3.0</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/upgrading-to-gatsby-3-0-864773decf1b?source=collection_archive---------10-----------------------#2021-03-29">https://levelup.gitconnected.com/upgrading-to-gatsby-3-0-864773decf1b?source=collection_archive---------10-----------------------#2021-03-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/80520b2578a32953aaa09c53cee594aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CIOyS6PLWm2x6MW4W61eew.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">来自unspash，由Lucas Benjamin绘制</figcaption></figure><p id="f369" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">来自我的<a class="ae la" href="https://fek.io/blog/upgrading-to-gatsby-3-0" rel="noopener ugc nofollow" target="_blank">博客</a></p><p id="cf9e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我把我的网站升级到了最新版本的<a class="ae la" href="https://www.gatsbyjs.com" rel="noopener ugc nofollow" target="_blank">盖茨比JS </a>。如果你不熟悉<a class="ae la" href="https://www.gatsbyjs.com" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>或<a class="ae la" href="https://jamstack.org/" rel="noopener ugc nofollow" target="_blank"> JAMSTACK </a>，它是一个使用<a class="ae la" href="https://reactjs.org" rel="noopener ugc nofollow" target="_blank"> React </a>框架创建静态网站的框架。上个月发布了盖茨比3.0，这是自2018年2.0以来的首次重大升级。</p><p id="8f2d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">他们在他们的文档中包含了一个<a class="ae la" href="https://www.gatsbyjs.com/docs/reference/release-notes/migrating-from-v2-to-v3/" rel="noopener ugc nofollow" target="_blank"> Gatsby 3.0迁移指南</a>，但是我想涵盖我为了将mu站点升级到3.0所做的更改。</p><p id="6af3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我做的第一步是为升级创建一个git分支，如果升级失败的话，我可以将它销毁。一旦创建了新的分支，我就按照迁移指南中的说明进行操作。第一步是升级节点package.json文件中的依赖项。我运行了以下命令；</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="3807" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在我升级了gatsby模块之后，我通过运行以下命令来检查哪些依赖项需要升级；</p><blockquote class="lh li lj"><p id="ed13" class="kc kd lk ke b kf kg kh ki kj kk kl km ll ko kp kq lm ks kt ku ln kw kx ky kz ij bi translated">npm已过时</p></blockquote><p id="6e3a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此命令将为您提供项目中哪些依赖项需要升级的报告；</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="2535" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">突变变化</strong></p><p id="630b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有许多需要代码升级的突破性变化。一个例子是<em class="lk">导航到</em>功能已经被重命名为仅<em class="lk">导航</em>。这里有一个例子:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="0876" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我遇到的一个问题是如何导入css样式模块，这是我在他们的指南中没有发现的。在Gatsby中编写组件时，您可以只为一个单独的模块编写样式模块。例如，如果你有一个名为<em class="lk"> header.js </em>的header组件，你可以为这个名为<em class="lk"> header.module.css </em>的组件设置一组样式。以前，您可以像这样在模块中导入样式；</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="834e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在必须使用` * '通配符导入它；</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="0631" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Graphql升级</strong></p><p id="ab1c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Gatsby早期版本中的Graphql不需要导入才能使用graphql函数。我没有将它导入我的“gatsby_node.js”文件。为了使用graphql函数，我必须添加这个导入；</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="1b8b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我还使用了一个额外的frontmatter变量来为“cover_image”指定一个额外的变量。这让我可以在每篇文章的标题中指定一个独特的封面图片。我可以通过在“gatsby_node.js”文件中添加以下模式来添加它；</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="10bf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Node.js版本需求</strong></p><p id="e7b9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我目前正在使用<a class="ae la" href="http://netlify.com" rel="noopener ugc nofollow" target="_blank"> Netlify </a>来托管我的网站。Netlify默认为Node v10，但是Gatsby 3.0现在要求您至少拥有不低于12.13.0的最低版本Node.js。您可以使用`. nvmrc '文件在Netlify上指定新版本的节点。我创建了一个如下图所示的:</p><blockquote class="lh li lj"><p id="ca15" class="kc kd lk ke b kf kg kh ki kj kk kl km ll ko kp kq lm ks kt ku ln kw kx ky kz ij bi">14.16.0</p></blockquote><p id="b1b9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">总结</strong></p><p id="fcaf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这次升级并不是完全没有痛苦，但是我能够按照他们的指导在大约一个小时内完成升级。盖茨比增加了很多新东西，你现在可以通过升级来利用它们。我希望这篇文章对你的升级有所帮助。</p></div></div>    
</body>
</html>