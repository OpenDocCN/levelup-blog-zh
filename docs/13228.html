<html>
<head>
<title>Error Handling Style Guide in Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Golang中的错误处理风格指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/error-handling-style-guide-in-golang-9761a5a1434d?source=collection_archive---------12-----------------------#2022-08-18">https://levelup.gitconnected.com/error-handling-style-guide-in-golang-9761a5a1434d?source=collection_archive---------12-----------------------#2022-08-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f27e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">错误处理是Golang中的一项基本技术。这篇文章将讨论Golang中的错误处理代码风格指南。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/97ecaed891ede41788a09eaa290ad420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RkeHCrliUJLPYtt1"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">马克·弗莱彻·布朗在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="7b2b" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">声明错误</h1><p id="fb33" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">错误内置接口类型是表示错误条件的常规接口，零值表示没有错误。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="0233" class="mn lg it mj b gy mo mp l mq mr">type error interface {<br/>    Error() string<br/>}</span></pre><p id="f881" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">声明错误的选项很少。</p><h2 id="7dab" class="mn lg it bd lh ms mt dn ll mu mv dp lp kb mw mx lt kf my mz lx kj na nb mb nc bi translated"><code class="fe nd ne nf mj b"><strong class="ak">error.New</strong></code></h2><p id="c0b1" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">函数<code class="fe nd ne nf mj b">New</code>返回一个格式为给定文本的错误。即使文本完全相同，对它的每次调用都会返回不同的错误值。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="16d6" class="mn lg it mj b gy mo mp l mq mr">func bar() error {<br/>    return errors.New("error: an error occurred")<br/>}</span></pre><h2 id="65ff" class="mn lg it bd lh ms mt dn ll mu mv dp lp kb mw mx lt kf my mz lx kj na nb mb nc bi translated">fmt。错误f</h2><p id="f45d" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">函数<code class="fe nd ne nf mj b">Errorf</code>根据格式说明符格式化，并返回满足<code class="fe nd ne nf mj b">error</code>的字符串值。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="a003" class="mn lg it mj b gy mo mp l mq mr">func foo() error {<br/>    return fmt.Errorf("foo: %s", "an error occurred")<br/>}</span></pre><p id="d994" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果格式说明符包含带有错误操作数的%w动词，则返回的错误将实现返回操作数的<strong class="js iu"> Unwrap </strong>方法。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="c918" class="mn lg it mj b gy mo mp l mq mr">func foo() error {<br/>   return fmt.Errorf("foo: %w", errors.New("an error occurred"))<br/>}</span></pre><h2 id="908b" class="mn lg it bd lh ms mt dn ll mu mv dp lp kb mw mx lt kf my mz lx kj na nb mb nc bi translated">自定义错误类型</h2><p id="52a1" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">有时候，我们需要创建一个自定义的<code class="fe nd ne nf mj b">error</code>来处理错误。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="7806" class="mn lg it mj b gy mo mp l mq mr">type NotFoundError struct {<br/>  File string<br/>}</span><span id="2bf7" class="mn lg it mj b gy ng mp l mq mr">func (e *NotFoundError) Error() string {<br/>  return fmt.Sprintf("file %q not found", e.File)<br/>}</span></pre><h1 id="18f2" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">风格指南</h1><p id="d5cc" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在为您的用例选择最佳错误选项之前，请考虑之后的<a class="ae le" href="https://github.com/uber-go/guide/blob/master/style.md#errors" rel="noopener ugc nofollow" target="_blank">。</a></p><ul class=""><li id="49c6" class="nh ni it js b jt ju jx jy kb nj kf nk kj nl kn nm nn no np bi translated">调用者需要匹配错误以便处理它吗？如果是，我们必须通过声明顶级错误变量或自定义类型来支持<code class="fe nd ne nf mj b"><a class="ae le" href="https://golang.org/pkg/errors/#Is" rel="noopener ugc nofollow" target="_blank">errors.Is</a></code>或<code class="fe nd ne nf mj b"><a class="ae le" href="https://golang.org/pkg/errors/#As" rel="noopener ugc nofollow" target="_blank">errors.As</a></code>函数。</li><li id="1a2b" class="nh ni it js b jt nq jx nr kb ns kf nt kj nu kn nm nn no np bi translated">错误消息是静态字符串，还是需要上下文信息的动态字符串？对于前者，我们可以使用<code class="fe nd ne nf mj b"><a class="ae le" href="https://golang.org/pkg/errors/#New" rel="noopener ugc nofollow" target="_blank">errors.New</a></code>，但对于后者，我们必须使用<code class="fe nd ne nf mj b"><a class="ae le" href="https://golang.org/pkg/fmt/#Errorf" rel="noopener ugc nofollow" target="_blank">fmt.Errorf</a></code>或自定义错误类型。</li><li id="9dbb" class="nh ni it js b jt nq jx nr kb ns kf nt kj nu kn nm nn no np bi translated">我们是在传播下游函数返回的新错误吗？如果是这样，请使用错误包装。</li></ul><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="11c9" class="mn lg it mj b gy mo mp l mq mr">+-----------------+---------------+-------------------------------+<br/>| Error matching? | Error Message |           Guidance            |<br/>+-----------------+---------------+-------------------------------+<br/>| No              | static        | errors.New                    |<br/>| No              | dynamic       | fmt.Errorf                    |<br/>| Yes             | static        | top-level var with errors.New |<br/>| Yes             | dynamic       | custom error type             |<br/>+-----------------+---------------+-------------------------------+</span></pre></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><p id="1350" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">发现这篇文章很有帮助👏？看看我下面的其他文章吧！</p><div class="oc od gp gr oe of"><a rel="noopener  ugc nofollow" target="_blank" href="/error-handling-functions-in-golang-159ae73164b3"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">Golang中的错误处理函数</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">在本文中，我将演示在Go中处理错误函数的基础知识以及如何使用它们。</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ky of"/></div></div></a></div><div class="oc od gp gr oe of"><a rel="noopener  ugc nofollow" target="_blank" href="/error-handling-strategies-in-go-7759b3f73d0"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">围棋中的错误处理策略</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">在Go中，当函数调用返回错误时，调用者有责任检查错误并采取适当的措施…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oo l"><div class="ou l oq or os oo ot ky of"/></div></div></a></div></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="6772" class="lf lg it bd lh li ov lk ll lm ow lo lp lq ox ls lt lu oy lw lx ly oz ma mb mc bi translated">分级编码</h1><p id="28a6" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="d7e4" class="nh ni it js b jt ju jx jy kb nj kf nk kj nl kn nm nn no np bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="c96f" class="nh ni it js b jt nq jx nr kb ns kf nt kj nu kn nm nn no np bi translated">📰查看<a class="ae le" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>中的更多内容</li><li id="a447" class="nh ni it js b jt nq jx nr kb ns kf nt kj nu kn nm nn no np bi translated">🔔关注我们:<a class="ae le" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae le" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae le" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="a207" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🚀👉<a class="ae le" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">加入升级人才集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>