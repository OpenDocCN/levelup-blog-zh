# 为什么您应该保持宽松的代码评审策略

> 原文：<https://levelup.gitconnected.com/why-you-should-keep-loose-code-review-policies-bb7e92493399>

![](img/451fbf2ddd7aabbcb631c11b6817d913.png)

有时让行标志比停车标志更有意义

当我第一次加入我现在的公司时，我对他们的 Github 审批政策感到惊讶。只要您有一个单一的拉请求批准，您就可以推送附加的变更并合并到主分支，而不需要另一个批准。

在我之前工作过的公司，新的变化需要重新批准，所以这似乎不太寻常。然而，令我惊讶的是，这个更宽松的政策给了我们**更高的速度**、**更小的 PRs** ，以及**更好的代码质量**。原因如下:

# 代码审查是昂贵的

**要求*任何事情*总是前进的绊脚石。**PR 审批也是如此。如果一个公关坐在那里等待批准，那就是它没有与其他代码一起“生活”或者为客户创造价值的时候了。

**对于审核者来说，上下文切换代价很高。**如果他们在该区域，他们可能会等到该集中期结束时再审查 PR。这反过来让作者等待。即使是简单的评论或橡皮图章的上下文切换也可能是昂贵的。

# 但是代码审查(通常)会增加价值

虽然代码评审是昂贵的，但是它们可以增加重要的价值。我寻求 3 个方面的反馈:

*   获得对更大的想法或策略的反馈
*   在我不太了解的领域获得反馈
*   获得关于次要模式、偏好或惯例的反馈

**我撰写的大约 80%的 PRs 都属于第三类**，所以我通常只是寻求一些轻微反馈的认可。有时我甚至不寻求任何反馈，只要公关够基本就行了。

只有前两个区域应被视为有价值区块。然后只有在有重大事情需要和他们一起改变的情况下。如果公关好到足以出货，那么我会留下我的反馈，但仍然给予批准。

我相信作者会评估我的评论，并做出自己的判断，决定是否做出建议的修改。毕竟，作者比我更了解公关的主题。

留下反馈和批准会让作者畅通无阻。他们可以选择他们同意的意见/更改，然后合并，而不必请求重新审核(尽管如果更改很大，他们通常会这样做)。

虫子呢？测试和 CI 为我捕捉到的错误比任何评论者都多。测试的目的是捕捉错误，他们做得很好。评审的主要目的不应该是捕捉错误，而是提供关于策略和想法的反馈。

这个过程很大程度上基于信任。我和我的团队有着共同的目标，并随着时间的推移建立了信任。我依靠他们为团队和公司做出正确的决定。我不能参与每一个决定，否则就不会有生产力。

# 更严格的政策会发生什么？

让我们来讨论一下当您添加更严格的策略时会发生什么，例如更改后的重新批准，或者来自多方的批准。

如上所述，公关审查是昂贵的。因此，**合并单个公关的成本变得更高**。

通常我会运送只做一件事的小型 PRs。通常，当构建一个更大的特征时，一个 PR 可能依赖于它之前的 PR。由于运输单个公关的成本更高，这变得更加困难，并有公关交通堵塞的风险。因此，**我有动力去运送更大的 pr**来做更多的事情。这会导致各种各样的问题:

*   更大的 PRs**更难理解和审查**。更多的问题以失败告终。
*   更大的 PRs 需要更长的时间来审查。这更多的是一种环境转换，评审者会更加犹豫，等待更长的时间来评审。想想你对 10 英镑的班轮和 500 英镑的班轮的急切心情。**这进一步减缓了开发周期**。

合并公关的成本更高，这让我不太可能实施反馈。如果有我同意的小反馈，但不是关键任务，我必须权衡做出改变和发布的成本。如果等待的成本高于从中获得的收益，我就要出货了。

**这会导致更差的代码质量**。我可以举出无数的 PRs 的例子，在这些例子中，我实施了基本的建议，因为进行这些更改和合并的成本很低，但是如果我需要额外的审查，就不会这样做了。

# 结论

在运输中添加任何阻碍因素都会减缓产品开发的速度。通常这些阻滞剂是必要的。但有时政策的意图会产生相反的效果。每个组织都应该审视自己的政策，在仍然能够运营的情况下尽可能减少阻碍因素。

*作者注:这篇作品是看了* [*默认无代码评审*](https://www.raycast.com/blog/no-code-reviews-by-default/?fbclid=IwAR286xv4i5gVWqC6niH1s5Z8iUTHKuqiQxjrHfEg_4ZD6tU4fujBqonLtRo) *后得到的启发。从那以后，Gusto 出于法规遵从性的原因，采取了更严格的审查政策(这对企业来说是一个积极的举措，即使它带来了我上面描述的缺点)。*

*这是我的* [*做法的一部分，以工程师的身份快速推出新的软件产品*](https://vonkunesnewton.medium.com/practices-to-rapidly-ship-new-software-products-as-an-engineer-296319e9d39c) *系列。*