<html>
<head>
<title>Consuming the Plaid API with React and Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React and Go使用Plaid API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-and-go-f0e8d958d4a2?source=collection_archive---------2-----------------------#2021-01-22">https://levelup.gitconnected.com/react-and-go-f0e8d958d4a2?source=collection_archive---------2-----------------------#2021-01-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="764d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个现代的全栈REST应用</h2></div><p id="dcc9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Plaid是一个流行的API，它通过REST端点公开用户的银行信息。我们将利用他们的服务创建一个REST API来创建授权信息。然后，我们将创建一个react应用程序，该应用程序使用API为用户创建身份验证令牌。记住，你可以点击view raw按钮来复制你需要的任何代码。本教程假设您熟悉React和fullstack开发。此回购可在此处找到:</p><div class="lb lc gp gr ld le"><a href="https://github.com/qweliant/BetterPlaidQuickstart" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">qweliant/BetterPlaidQuickstart</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">设置plaid服务器和react客户端的快速入门</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls lt le"/></div></div></a></div><p id="1f29" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们需要前往<a class="ae lu" href="https://dashboard.plaid.com/signin" rel="noopener ugc nofollow" target="_blank"> Plaid </a>获取我们的API键。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi lv"><img src="../Images/19c53cff06991864861826567b6855cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rtyj7K0yQktM2vIvbJOgTw.jpeg"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">登录格子后的登陆页面</figcaption></figure><p id="09ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">导航到“设置”选项卡并单击“密钥”以查看您的API密钥。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mk"><img src="../Images/a8a10e1fca30cec622a4bed8a5a9e70f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50zEiVsbAZN609EG8uEGvQ.jpeg"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">格子花呢的信用</figcaption></figure><p id="927a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用沙盒环境，该环境使用不同于开发的测试密钥。注意在左边栏有一个标签，写着API。点击它，您将看到关于Plaid的重定向uri的部分。点击add new uri，添加<a class="ae lu" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:80 </a>和<a class="ae lu" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost: </a> 3000。这将控制链接发生后重定向的位置。如果您单击登录页面中的“在沙盒中测试”按钮，您将被带到显示测试用户凭据的页面。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ml"><img src="../Images/9977af3312cb77c5156b5a01cc770a77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*skcZieM4R9HNQOLjjJ2AzA.jpeg"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">针对多种语言的快速入门资料库。因为客户端是后端不可知的，所以你可以为这个项目使用你选择的语言</figcaption></figure><p id="36ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不一定要运行他们的确切设置，但接下来我们将通过go not so quickstart repo来设置后端。</p><h2 id="6960" class="mm mn iq bd mo mp mq dn mr ms mt dp mu ko mv mw mx ks my mz na kw nb nc nd ne bi translated">后端</h2><p id="deb4" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">为您的项目创建一个项目目录。那就跑</p><pre class="lw lx ly lz gt nk nl nm nn aw no bi"><span id="2cfc" class="mm mn iq nl b gy np nq l nr ns">git clone <a class="ae lu" href="https://github.com/plaid/quickstart.git" rel="noopener ugc nofollow" target="_blank">https://github.com/plaid/quickstart.git</a></span></pre><p id="698a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">删除Makefile、Readme和除go以外的所有文件夹。</p><p id="4ee0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以前</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi nt"><img src="../Images/dd8529338fd2de9cc929703ee0f31681.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*xBSLkxz1_abvpwfXGsiWfg.jpeg"/></div></div></figure><p id="b21c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在...之后</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/ab35d314d94735d689d799e18d6db997.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*mTyyUPTYktH1cwKtPtH1Xg.jpeg"/></div></figure><p id="0c72" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些预配置了docker文件，使部署变得容易。我们不会讨论docker容器的部署，但是我们会使用docker for desktop来部署它们。如果您需要安装，请查看<a class="ae lu" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> Docker </a>获取您的操作系统的安装说明。这将是一个非常简单的docker设置，是noob友好的，所以你应该能够理解下面的基础知识。下一步我们应该做的是编辑docker-compose.yml文件，我们需要删除其他示例的容器设置过程，并从. env文件中获取环境变量。编辑后，文件应该如下所示。</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="c5bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">跑步:</p><pre class="lw lx ly lz gt nk nl nm nn aw no bi"><span id="c584" class="mm mn iq nl b gy np nq l nr ns">docker-compose up -d --build </span></pre><p id="017a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将构建图像并启动一个容器。如果我们查看docker文件，我们可以看到我们的应用程序是如何构建的。go版本是为官方go形象指定的。然后创建一个目录，我们将所有内容复制到其中。将根目录更改为go文件夹后，我们获得所需的包并构建二进制文件。接下来，我们提取二进制文件将在其上运行的映像，将二进制文件复制到映像中，并通过端口8000公开应用程序。顺便说一下，你应该删除复制html和静态信息的行。我们的docker文件应该如下所示:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="d7a3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您运行了上面的docker-compose命令，如果您还没有删除html和静态副本，您应该会看到关于env变量或错误的警告。让我们创建一个。env文件与docker-compose文件在同一个文件夹中。该文件将定义您的格子凭证。结果应该是这样的:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="c5aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在进入前端之前，我们应该做的最后一件事是编辑server.go中的部分代码。这是因为quickstart repo的行为不像预期的那样。这可能是因为我自己的无知，但按照官方回购的步骤会导致环境错误。</p><pre class="lw lx ly lz gt nk nl nm nn aw no bi"><span id="b1d7" class="mm mn iq nl b gy np nq l nr ns">Attaching to quickstart_go_1</span><span id="3985" class="mm mn iq nl b gy nx nq l nr ns">go_1 | 2021/01/21 18:05:14 Error loading .env file. Did you copy .env.example to .env and fill it out?</span></pre><p id="45ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也许你不能运行Makefiles，所以如果你尝试一个普通的设置，可能会有一个问题。将客户机放在init函数中也有一个问题。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ny"><img src="../Images/d1d7f3164ca0add9fba21acc7a237c02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4FxxwM4zudwtaP-RbohMLw.jpeg"/></div></div></figure><p id="16e4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，如果env变量留在init中，您将得到一个API错误。</p><pre class="lw lx ly lz gt nk nl nm nn aw no bi"><span id="121d" class="mm mn iq nl b gy np nq l nr ns">{</span><span id="01a4" class="mm mn iq nl b gy nx nq l nr ns">"error": "Post /link/token/create: unsupported protocol scheme \"\""</span><span id="7032" class="mm mn iq nl b gy nx nq l nr ns">}</span></pre><p id="a799" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将在init函数之外设置环境变量和客户机。</p><p id="8144" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以不要</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3651" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="6556" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二，如果我们看一下主函数的开头，我们应该把它从</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="abc3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="2554" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">再次运行docker-compose命令将启动API。现在是出去喝水或快速散步的好时机。接下来，我们将完成react设置。我们倒数第二个创造将产生一个按钮，执行数千个银行账户的Oauth。</p><h2 id="0465" class="mm mn iq bd mo mp mq dn mr ms mt dp mu ko mv mw mx ks my mz na kw nb nc nd ne bi translated">反应</h2><p id="b6eb" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">好了，我们回来了，恢复了精神，补充了水分，为前端做好了准备。通过在我们的go文件夹所在的父目录中运行<code class="fe nz oa ob nl b">npx create-react-app plaid </code>来启动应用程序</p><p id="a68a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将首先为前端设置docker文件，并将客户端服务添加到docker合成文件中。让我们通过再次打开docker-compose文件来开始后面的部分。要为客户机添加服务，只需将其添加到go部分之后。该文件将更改为如下所示:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7ccc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们想在plaid目录中添加一个Dockerfile文件。在其中，我们定义了构建production react应用程序并将其放在nginx服务器上的步骤。这方面的文档将是:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3ede" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们需要为配置服务器的nginx创建一个文件夹。将文件夹命名为nginx，并添加一个名为conf.d的文件。这将我们的服务器配置为在容器的端口80上提供静态构建(html、js、cs等)。</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5cbc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在尝试运行docker-compose，看看hello world react应用程序是否托管在端口80上。需要注意的是我们的应用所服务的端口。因为登录后浏览器导航需要重定向uri，所以您需要为dev和container环境解析uri。这可能需要进行单独的docker-compose和Dockerfile设置，或者将env中的uri从80更改为3000。我将把它留给你</p><p id="a0b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在需要添加axios和react-plaid库来处理状态和客户机/服务器通信。确保您在plaid目录下创建并运行:</p><pre class="lw lx ly lz gt nk nl nm nn aw no bi"><span id="633a" class="mm mn iq nl b gy np nq l nr ns">yarn add axios <!-- -->react-plaid-link</span></pre><p id="0b97" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们打开src文件夹，添加一个名为Link.js的文件。react plaid hooks库中的链接过程使得执行auth变得非常容易。有了它，我们将调用<code class="fe nz oa ob nl b">/api/create_link_token</code>从Plaid获取一个链接令牌。这将为用户的银行帐户初始化Plaid验证链接流。如果用户成功链接，将生成一个访问令牌。访问令牌需要永久保存在您选择的DB中，以便访问不同的Plaid端点。现在，它作为一个值存储在服务器上。将下面的代码复制到Link.js文件中。</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="1392" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行完<code class="fe nz oa ob nl b">docker-compose up -d --build</code>之后，您应该能够转到localhost:80并连接一个虚拟帐户。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi oc"><img src="../Images/538b345e2ce1cda7f3d964c408e33e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wGKHACj8VA5KXdnx2sT6ZQ.gif"/></div></div></figure><p id="62fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">恭喜你。您现在正在实施金融科技银行即服务应用程序。有点像…咩咩…好吧好吧。感谢您的观看。请随时通过我的<a class="ae lu" href="https://twitter.com/Qwelian_Tanner" rel="noopener ugc nofollow" target="_blank">社交网站</a>联系我，或者通过<a class="ae lu" href="https://www.linkedin.com/in/qdt/" rel="noopener ugc nofollow" target="_blank"> linkedin </a>联系我。祝你有美好的一天！</p></div></div>    
</body>
</html>