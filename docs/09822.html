<html>
<head>
<title>Use Swiftlint and Detekt to Check Cyclomatic Complexity in iOS, Android Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Swiftlint和Detekt检查iOS和Android项目中的圈复杂度</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/use-swiftlint-and-detekt-to-check-cyclomatic-complexity-on-ios-and-android-5b98f62597e8?source=collection_archive---------1-----------------------#2021-09-19">https://levelup.gitconnected.com/use-swiftlint-and-detekt-to-check-cyclomatic-complexity-on-ios-and-android-5b98f62597e8?source=collection_archive---------1-----------------------#2021-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/182fb8e3e9043f6adb8df13afbba93ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KrHsT08UfP5kxkMM"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">伊恩·施耐德在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="3c74" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">什么是圈复杂度？</strong></h1><blockquote class="lb lc ld"><p id="23d0" class="le lf lg lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated">圈复杂度是由Thomas McCabe开发的一种度量方法，用于确定程序的稳定性和置信度。它测量通过程序模块的线性独立路径的数量。</p><p id="765d" class="le lf lg lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated">其公式为:<strong class="lh ir"> M = E — N + 2P </strong>，其中E =边数，N =节点数，P =连通分量数</p></blockquote><p id="2b52" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">让我们通过这个例子来理解如何计算这个指标。</p><p id="32bd" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">例如，我们有一个函数，它执行一些逻辑，如下图所示</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/24bb48087b336381de66e30d442ac4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BX9lVAJ9xHuwPBdFhU-uaw.jpeg"/></div></div></figure><p id="16f9" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">我们有<strong class="lh ir"> 7个节点和8条边</strong>和1个连通分量，因此基于公式我们有</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="73fe" class="mq ke iq mm b gy mr ms l mt mu"><strong class="mm ir">M = E — N + 2P = 8-7 + 2 * 1 = 3</strong></span></pre><h1 id="21db" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">一个函数圈复杂度的极限是多少？</strong></h1><p id="bbc6" class="pw-post-body-paragraph le lf iq lh b li mv lk ll lm mw lo lp md mx ls lt me my lw lx mf mz ma mb mc ij bi translated"><a class="ae kc" href="https://en.wikipedia.org/wiki/Cyclomatic_complexity" rel="noopener ugc nofollow" target="_blank"> McCabe建议</a>一个函数的圈复杂度应该<strong class="lh ir">小于或等于10。</strong></p><p id="1c60" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">除此之外，我们还有关于软件度量的<a class="ae kc" href="https://www.exida.com/Blog/software-metrics-iso-26262-iec-61508" rel="noopener ugc nofollow" target="_blank"> ISO-2626 </a>，它也建议圈复杂度应该从<strong class="lh ir"> 1到10。</strong></p><ul class=""><li id="cda7" class="na nb iq lh b li lj lm ln md nc me nd mf ne mc nf ng nh ni bi translated">圈复杂度<strong class="lh ir">小于10: </strong>写得好的代码，可测试性高，花费和精力较少</li><li id="afe4" class="na nb iq lh b li nj lm nk md nl me nm mf nn mc nf ng nh ni bi translated">圈复杂度<strong class="lh ir">从11到20: </strong>代码复杂，可测性中等，成本和工作量中等</li><li id="a0a8" class="na nb iq lh b li nj lm nk md nl me nm mf nn mc nf ng nh ni bi translated">圈复杂度<strong class="lh ir">从21到40: </strong>非常复杂的代码，可测性低，成本和工作量高</li><li id="67b1" class="na nb iq lh b li nj lm nk md nl me nm mf nn mc nf ng nh ni bi translated">圈复杂度超过40:根本不可测试，成本和工作量非常高</li></ul><h1 id="553c" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">我们该如何解决这类问题？</h1><p id="087c" class="pw-post-body-paragraph le lf iq lh b li mv lk ll lm mw lo lp md mx ls lt me my lw lx mf mz ma mb mc ij bi translated"><strong class="lh ir">将你的高圈复杂度函数</strong>拆分成一些更小的函数。如果你有一个圈复杂度等于30的函数，你应该把它分成至少3个圈复杂度等于或小于10的函数。</p><h1 id="ae22" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">iOS Swift项目如何检查圈复杂度？</strong></h1><p id="6d52" class="pw-post-body-paragraph le lf iq lh b li mv lk ll lm mw lo lp md mx ls lt me my lw lx mf mz ma mb mc ij bi translated"><a class="ae kc" href="https://github.com/realm/SwiftLint" rel="noopener ugc nofollow" target="_blank"> Swiftlint </a>是检查您的Swift代码风格和惯例的绝佳工具。你可以用这个来检查很多规则，以确保你的代码是好的。但我只想提一下圈复杂度。</p><p id="29c6" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">通过<strong class="lh ir">自制:</strong>安装<strong class="lh ir"> Swiftlint </strong></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="6448" class="mq ke iq mm b gy mr ms l mt mu">brew install swiftlint</span></pre><p id="a3f1" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">然后，在项目目录中创建一个名为“. swiftlint.yml”的文件。</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/0b4020d267be87d1211a16e5593e14af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaOtJ1TlQbBfPgiYPA4e3Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">针对圈复杂度在. swiftlint.yml文件中配置</figcaption></figure><p id="a78b" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">现在，打开你的终端，进入一个项目目录，运行<code class="fe np nq nr mm b">swiftlint lint</code>或者只运行简单的<code class="fe np nq nr mm b">swiftlint</code></p><p id="4988" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">这是一个错误的例子，我在我的项目中限制圈复杂度只有10，但我有这个函数有20。那是气味。</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/f0c7da2c604aafc83faf0435f339ac28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NT9AtOhwrwFzW2nKcuPGFw.png"/></div></div></figure><p id="68ad" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">您还可以将Swiftlint实施到您的项目中，并通过以下方式在您构建应用程序时检查这些规则</p><ul class=""><li id="2624" class="na nb iq lh b li lj lm ln md nc me nd mf ne mc nf ng nh ni bi translated">转到您的项目设置，然后选择<strong class="lh ir">构建阶段</strong></li><li id="a6f1" class="na nb iq lh b li nj lm nk md nl me nm mf nn mc nf ng nh ni bi translated">点击左上角项目应用名称旁边的<strong class="lh ir"> + </strong>按钮，然后选择<strong class="lh ir">新运行脚本阶段</strong></li><li id="fdae" class="na nb iq lh b li nj lm nk md nl me nm mf nn mc nf ng nh ni bi translated">将该脚本粘贴到<strong class="lh ir">运行脚本阶段</strong></li></ul><figure class="mh mi mj mk gt jr"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e444" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">在那之后，无论何时你构建你的应用程序，你都会得到这样的警告</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/38fe839b0a89eb1c20ee3eca38e3ebb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8l898H8XG0ms7rwEDETAA.png"/></div></div></figure><h1 id="3033" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">如何检查Android Kotlin项目的圈复杂度？</strong></h1><p id="33d0" class="pw-post-body-paragraph le lf iq lh b li mv lk ll lm mw lo lp md mx ls lt me my lw lx mf mz ma mb mc ij bi translated">Detekt 将做与Swiftlint相同的事情。</p><p id="acf0" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">通过<strong class="lh ir">自制</strong>安装<strong class="lh ir">探测器</strong></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="85f3" class="mq ke iq mm b gy mr ms l mt mu">brew install detekt</span></pre><p id="8da3" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">然后，必须在你的项目目录中创建一个文件名<code class="fe np nq nr mm b">detekt.yml</code>来设置规则。</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/509db1adb6763721669e1f1f3f552cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0X-jY73B7pioDmEmh8Ovg.png"/></div></div></figure><p id="77c4" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">设置<code class="fe np nq nr mm b">threshold: 11</code>以确保它仍然适用于圈复杂度= 10的函数</p><p id="dfaa" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">之后，打开终端并转到您的项目目录，然后运行</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/bb154a16bed774083aaa3cd3dd7e77fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CKIbAsB9ahlehFZzkl83UA.png"/></div></div></figure><p id="565c" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">一分钟后，你会在你的项目目录中得到文件名<code class="fe np nq nr mm b">cyclomatic_complexity_report.html</code>，打开它你会得到这样的报告</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/1ea4658573dc34bc812a7042b41b4c09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LwdhrsebJP2s8mm4_APkWA.png"/></div></div></figure></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="6071" class="pw-post-body-paragraph le lf iq lh b li lj lk ll lm ln lo lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">有了<strong class="lh ir"> Swiftlint </strong>和<strong class="lh ir">detek</strong>现在你可以发现你的代码味道并改进它，除此之外还有一些高级规则，你应该在他们的文档页面上阅读，因为Swiftlint在这里是<a class="ae kc" href="https://realm.github.io/SwiftLint/rule-directory.html" rel="noopener ugc nofollow" target="_blank">这里是</a>，detek在这里是<a class="ae kc" href="https://detekt.github.io/detekt/complexity.html" rel="noopener ugc nofollow" target="_blank">这里是</a></p><h1 id="f78b" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">参考</h1><div class="of og gp gr oh oi"><a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">圈复杂度-维基百科</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">圈复杂度是一种软件度量，用于表示程序的复杂度。这是一个定量的衡量标准…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">en.wikipedia.org</p></div></div><div class="or l"><div class="os l ot ou ov or ow jw oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://github.com/realm/SwiftLint" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">GitHub - realm/SwiftLint:一个加强Swift风格和惯例的工具。</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">一个加强Swift风格和惯例的工具，大致基于现已存档的GitHub Swift风格指南。SwiftLint…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">github.com</p></div></div><div class="or l"><div class="ox l ot ou ov or ow jw oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://detekt.github.io/detekt/" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">检测</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">基于代码逻辑行、McCabe复杂性和…的Kotlin项目复杂性报告的代码味道分析</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">detekt.github.io</p></div></div><div class="or l"><div class="oy l ot ou ov or ow jw oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://www.guru99.com/cyclomatic-complexity.html" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">Mccabe的圈复杂度:用流图计算(示例)</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">为了理解圈复杂度，让我们首先理解——度量只不过是大小的定量表示…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">www.guru99.com</p></div></div><div class="or l"><div class="oz l ot ou ov or ow jw oi"/></div></div></a></div></div></div>    
</body>
</html>