<html>
<head>
<title>Road to Go Pro — Flow control &amp; Loop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pro之路—流量控制和环路</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/road-to-go-pro-flow-control-dfcc7b9a5395?source=collection_archive---------13-----------------------#2020-09-24">https://levelup.gitconnected.com/road-to-go-pro-flow-control-dfcc7b9a5395?source=collection_archive---------13-----------------------#2020-09-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="ebb4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">开始前的几句话。你可以在这个</em> <a class="ae kp" href="https://github.com/songx23/RoadToGoPro" rel="noopener ugc nofollow" target="_blank"> <em class="ko">资源库</em> </a> <em class="ko">中找到本教程使用的代码。你可以在这里</em>  <em class="ko">找到《路要走》Pro </em> <a class="ae kp" href="https://medium.com/@songx/road-to-go-pro-f9d1f8a51fad" rel="noopener"> <em class="ko">的全部内容。如果你错过了最后一个，可以通过这个</em> </a><a class="ae kp" href="https://medium.com/swlh/road-to-go-pro-types-structures-21e5fedc5fe0" rel="noopener"> <em class="ko">链接</em> </a> <em class="ko">找到。</em></p><p id="a8f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们在教程的最后一部分讨论了基本类型和数据结构。在这一篇中，我们将讨论流量控制、循环和<code class="fe kq kr ks kt b">fmt</code>包。</p><h1 id="3abb" class="ku kv it bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">流控制</h1><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ls"><img src="../Images/43d9b3f11da0e59afff3f4b90a527789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5trGGDm0mYjiMwmF"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">照片由<a class="ae kp" href="https://unsplash.com/@igalness?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Igal Ness </a>在<a class="ae kp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="a513" class="mi kv it bd kw mj mk dn la ml mm dp le kb mn mo li kf mp mq lm kj mr ms lq mt bi translated">如果</h2><p id="921a" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">首先，我们来看一下<code class="fe kq kr ks kt b">if</code>语句。最基本的流控制之一是if和else语句。它们控制程序根据条件执行不同的代码块。<code class="fe kq kr ks kt b">if</code>语句的语法如下。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">if…else… condition伪代码</figcaption></figure><p id="cc56" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当if语句中的conditionA返回true时，就会执行<code class="fe kq kr ks kt b">if</code>括号内的代码。否则，将依次评估以下条件，直到到达最后一个<code class="fe kq kr ks kt b">else</code>代码块。Go接下来计算conditionB，如果conditionB返回true，将执行里面的代码。如果conditionB返回false，那么将执行最后一个代码块。在<code class="fe kq kr ks kt b">if</code>、<code class="fe kq kr ks kt b">else if</code>和<code class="fe kq kr ks kt b">else</code>语句的组合中，求值的顺序总是从上到下。所以最后用<code class="fe kq kr ks kt b">else</code>作为通吃块。当然，如果不需要一个包罗万象的函数，可以省略最后一个<code class="fe kq kr ks kt b">else</code>块。</p><p id="5af8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那么条件是什么样的呢？任何返回布尔值的语句都可以放在条件中。这里有一个例子。顺便说一下，我们已经使用<code class="fe kq kr ks kt b">fmt.Println</code>有一段时间了，但我还没有正式介绍它。在本教程的最后一节，我们将讨论<code class="fe kq kr ks kt b">fmt</code>包。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">如果…否则…举例</figcaption></figure><p id="09a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您也可以在条件中使用逻辑运算符。有三种逻辑运算符，即and ( <code class="fe kq kr ks kt b">&amp;&amp;</code>)、or ( <code class="fe kq kr ks kt b">||</code>)、not( <code class="fe kq kr ks kt b">!</code>)。可以通过逻辑运算符将条件链接在一起，形成复杂的条件。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">复杂条件示例</figcaption></figure><p id="7327" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在一个<code class="fe kq kr ks kt b">if…else if … else</code>链中，你可以写多少个<code class="fe kq kr ks kt b">else if</code>语句是没有限制的。然而为了可读性，我们不建议使用很长的if/else语句列表。<code class="fe kq kr ks kt b">switch</code>是处理这种情况的正确选择。在我们开始之前，我想在Go to you中介绍一种特殊语法的<code class="fe kq kr ks kt b">if</code>语句。</p><p id="7a61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Go可以在<code class="fe kq kr ks kt b">if</code> / <code class="fe kq kr ks kt b">else if</code>语句中的条件前接受一个“短语句”。这种语法使代码更加简洁。它广泛用于错误处理，我们将在后面的教程中介绍。让我们来看看这个语法的一个例子。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">if中的简短语句</figcaption></figure><p id="1a36" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">“短语句”是一个或多个变量的声明:它们是短暂的，只能在最近的括号内访问。在上面的例子中，如果我们试图访问<code class="fe kq kr ks kt b">if</code>代码块之外的短语句中的变量，我们将得到一个错误返回。Go中一个常见的错误处理模式是使用短语句来检查函数是否返回了错误。由于返回的错误只与<code class="fe kq kr ks kt b">if</code>条件相关，我们可以使用“短语句”语法使代码更简洁，避免变量范围的混淆。</p><p id="7d4b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">变量范围</strong></p><p id="9c23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我快速解释一下变量的范围是什么。并非所有的变量都被同等地声明。它们的可访问性取决于声明的位置。例如，如果一个变量在<code class="fe kq kr ks kt b">if</code>块中声明，我们只能在同一个代码块中访问它，而不能从外部访问。一个通用的经验法则是:变量的范围以它最近的括号(<code class="fe kq kr ks kt b">{}</code>)为界。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">可变范围示例</figcaption></figure><p id="a2c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面的例子中，<code class="fe kq kr ks kt b">anotherPlace</code>和<code class="fe kq kr ks kt b">newPlace</code>只能在最近的括号内访问。如果变量周围没有括号，那么它就是包内的全局变量。我们将在谈到包时讨论可访问性。目前，记住括号规则就足够了。</p><h2 id="694a" class="mi kv it bd kw mj mk dn la ml mm dp le kb mn mo li kf mp mq lm kj mr ms lq mt bi translated">转换</h2><p id="29da" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">好了，分心够了。让我们回到流量控制。我提到过，当我们有一个很长的条件列表时，最好使用<code class="fe kq kr ks kt b">switch</code>语句，而不是<code class="fe kq kr ks kt b">if</code>语句。<code class="fe kq kr ks kt b">switch</code>是<code class="fe kq kr ks kt b">if</code>更干净的形式，看起来是这样的。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">开关示例</figcaption></figure><p id="6f08" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">示例switch语句可以转换为下面的if语句。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">转换开关到if…else…</figcaption></figure><p id="c911" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">switch语句将其关联变量与内部的<code class="fe kq kr ks kt b">case</code>语句中的值进行比较。如果找到匹配，将执行该<code class="fe kq kr ks kt b">case</code>块中的代码。一旦该程序块完成，程序就退出切换程序块，而不检查其他情况。最后一个<code class="fe kq kr ks kt b">default</code>块类似于<code class="fe kq kr ks kt b">else</code>语句。</p><p id="e5cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果只检查3个条件，您可能不会觉得编写<code class="fe kq kr ks kt b">switch</code>语句更容易。但是想象一下，如果你需要像这样写10个条件。<code class="fe kq kr ks kt b">switch</code>看起来会比<code class="fe kq kr ks kt b">if</code>干净简洁很多。</p><p id="a5d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kq kr ks kt b">switch</code>也有一个更通用的形式，我们不需要在它后面指定变量。相反，可以在<code class="fe kq kr ks kt b">case</code>语句中指定条件。例如:</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">通用开关语句</figcaption></figure><p id="eff4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是的，通用switch语句中的case条件可以是符合<code class="fe kq kr ks kt b">if</code>语句的任何条件(不包括特殊的短语句语法)。</p><p id="bfa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那么什么时候该用<code class="fe kq kr ks kt b">if</code>什么时候该用<code class="fe kq kr ks kt b">switch</code>？在我看来，它们在很多情况下是可以互换的。就我个人而言，我会选择视觉上更干净、代码行更少的那种。</p><h1 id="b6d9" class="ku kv it bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">环</h1><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ls"><img src="../Images/8f12fd54c06b82e26889051573c6b576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tcVYmPv-q2FTrpHS"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">照片由<a class="ae kp" href="https://unsplash.com/@tine999?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tine ivani</a>在<a class="ae kp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="7d05" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我们需要重复执行逻辑时，循环就是最好的帮手。没有人想一遍又一遍地复制粘贴重复的代码。在其他语言中，你可能见过像<code class="fe kq kr ks kt b">for</code>循环和<code class="fe kq kr ks kt b">while</code>循环这样的循环。但在围棋中，只有<code class="fe kq kr ks kt b">for</code>循环。</p><h2 id="7e63" class="mi kv it bd kw mj mk dn la ml mm dp le kb mn mo li kf mp mq lm kj mr ms lq mt bi translated">为</h2><p id="0a14" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">For循环在Go中有四种形式。</p><p id="012f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">基本形式</strong></p><p id="eca4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最基本的循环形式在许多语言中看起来完全一样。供您参考，我在实际项目中很少使用这种形式。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">for循环—基本形式</figcaption></figure><p id="a3b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们快速浏览一下基本的表单语法。</p><p id="93cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的for循环中有三个短语句，它们由<code class="fe kq kr ks kt b">;</code> s分隔。第一个短语句用于启动循环索引。通常，它以0开头。第二个简短的语句是循环条件。只要满足循环条件，循环就一直执行，直到循环条件返回<code class="fe kq kr ks kt b">false</code>。最后一个语句是步进函数。我们指定在每次迭代中要改变什么。大多数时候，它会增加/减少循环索引。上面的例子向我们展示了如何循环遍历一个切片。我们从将循环索引设置为0开始。循环应该在到达切片中的最后一个元素后退出。因此，我们将条件设置为“循环索引需要小于切片的长度”。最后，我们将步进函数设置为“将索引增加1”。</p><p id="2f73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">需要注意的是，这三个简短的语句都是可选的。我们将在下面看到它的不同含义。</p><p id="eefd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">而表格</strong></p><p id="4683" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">围棋中没有<code class="fe kq kr ks kt b">while</code>这个关键词。而form只是基本<code class="fe kq kr ks kt b">for</code>循环的一个变种。如果我们从基本形式中省略初始化和步进函数，我们将得到while形式。因此，只要满足循环条件，循环就会一直执行。上面的例子可以很容易地转换成这样的while形式。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">for循环— while形式</figcaption></figure><p id="7c14" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">无尽形态</strong></p><p id="9e01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">死循环(Endless loop)，又称“死循环”，是一种危险的循环。通常情况下，如果我们有一个死循环，它会破坏程序，因为它会吞噬程序可以获得的所有资源，从而导致主机系统崩溃。这通常是一件非常糟糕的事情。然而，在Go中，有一些特殊的用例，我们可以使用无限循环。例如，当您想要运行一个异步后台进程时，您可以创建一个无限循环并让它在后台运行。我保证，那不会产生灾难性的结果。要编写一个无限循环，只需省略基本形式中的所有三个语句。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">for循环—无限形式</figcaption></figure><p id="7ead" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当然，我不会让你直接在main函数中运行一个死循环来弄坏你的电脑。我们在这里做的是在一个goroutine中运行它(将在以后介绍)。Goroutine支持异步处理，因此我们的无限循环与主进程并行运行。当主进程休眠5秒钟时，异步进程应该连续执行无限循环，直到主进程退出。这就是为什么我们看到“我是一个死循环。”在控制台中打印5次。</p><p id="7f70" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">范围运算符</strong></p><p id="5586" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们来谈谈范围运算符。它有助于轻松迭代切片/数组、映射、通道和字符串等类型。让我们看看如何简化基本形式。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">for循环-范围运算符(切片/数组)</figcaption></figure><p id="7697" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当在切片或数组上应用范围运算符时，它为每次迭代提供两个变量，即当前迭代的索引和值。请注意，这些变量是短暂的，只限于每次迭代，并且只能在循环内部访问。通常，我们不需要索引，所以我们可以通过使用<code class="fe kq kr ks kt b">_</code>省略对变量的赋值。会是这个样子的<code class="fe kq kr ks kt b">for _, value := range slice {…}</code>。事实上，如果你不使用循环内部的任何变量，Go会强迫你省略它们。</p><p id="0fcd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用range操作符遍历地图也会返回两个变量。不同的是，它返回映射的键而不是索引。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">for循环-范围运算符(映射)</figcaption></figure><p id="0dee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">类似地，如果我们不使用范围操作符返回的变量，我们需要省略它们。</p><p id="c633" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">应用于字符串或字符串类型时，范围运算符返回两个变量。第一个和slice/array一样，都是索引。第二个是字符的Unicode(以<code class="fe kq kr ks kt b">int32</code>为代表)。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">for循环—范围运算符(字符串)</figcaption></figure><p id="c2c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个例子中，你可以看到我们使用了<code class="fe kq kr ks kt b">fmt</code>包中的一个新函数。是时候解释一下<code class="fe kq kr ks kt b">fmt</code>包的格式化功能了。你可以跳到最后一节先睹为快。</p><p id="fca9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">继续&amp;中断</strong></p><p id="8b9d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kq kr ks kt b">continue</code>和<code class="fe kq kr ks kt b">break</code>是跳过迭代的短路语句。使用<code class="fe kq kr ks kt b">continue</code>时，程序会跳过<code class="fe kq kr ks kt b">continue</code>后的代码执行，开始下一次迭代。虽然<code class="fe kq kr ks kt b">break</code>更有力，但程序在看到<code class="fe kq kr ks kt b">break</code>时会跳过整个循环。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">继续和中断示例</figcaption></figure><p id="6172" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">转到&amp;标签</strong></p><p id="bce3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kq kr ks kt b">goto</code>和<code class="fe kq kr ks kt b">label</code>允许在同一个函数中从一个语句跳转到另一行代码。标签名称的惯例是全部使用大写字母。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">转到标签示例</figcaption></figure><p id="428e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kq kr ks kt b">goto</code>和<code class="fe kq kr ks kt b">label</code>在那里没有最好的名声。误用它们可能是意大利面条代码的标志，这是每个人都想避免的。然而，他们并不是天生邪恶的。它们确实有特定的用途。例如，在内置的<a class="ae kp" href="https://golang.org/src/math/gamma.go" rel="noopener ugc nofollow" target="_blank">数学</a>包中，我们可以找到<code class="fe kq kr ks kt b">goto</code>语句的正确用法。</p><p id="1b27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">延期</strong></p><p id="8928" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kq kr ks kt b">defer</code>是我想在本教程中介绍的最后一个流控制语句。它用于推迟函数执行，直到最近的周围函数退出。这里有一个例子。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">延期示例</figcaption></figure><p id="5016" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如示例所示，最后在退出主函数时执行了<code class="fe kq kr ks kt b">defer</code>之后的语句。需要注意的是，一系列<code class="fe kq kr ks kt b">defer</code>语句的执行顺序是相反的。换句话说，最后声明的<code class="fe kq kr ks kt b">defer</code>将在退出功能时首先执行。另外，<code class="fe kq kr ks kt b">defer</code>语句中的参数是内联计算的。这是唯一不能推迟的事情。</p><p id="a9cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我们创建最好在函数结束时关闭或删除的东西时,<code class="fe kq kr ks kt b">defer</code>很有用。没有<code class="fe kq kr ks kt b">defer</code>，我们需要在开头写一个open语句，然后在结尾关闭它。这很容易出错，因为很容易忘记关闭它。使用<code class="fe kq kr ks kt b">defer</code>，我们可以在打开后立即编写一个<code class="fe kq kr ks kt b">defer Close()</code>语句。这样，就不太可能忘记。我们将在高级主题中讨论数据库连接和HTTP服务器时使用它。</p><h1 id="4c06" class="ku kv it bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">奖励内容:</strong> <code class="fe kq kr ks kt b"><strong class="ak">fmt</strong></code> <strong class="ak">套餐</strong></h1><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ls"><img src="../Images/82eb3aea94ba3780ae0945747884b275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Js4N5j_0smce6Yf8"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated"><a class="ae kp" href="https://unsplash.com/@ninjason?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">梁杰森</a>在<a class="ae kp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9f11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我相信你见过很多<code class="fe kq kr ks kt b">fmt.Println</code>函数。我们经常使用它在控制台中打印结果。<code class="fe kq kr ks kt b">fmt</code>是Go强大的内置格式化包。<code class="fe kq kr ks kt b">Println</code>是软件包中的功能之一。你可以在这里找到<code class="fe kq kr ks kt b">fmt</code>包<a class="ae kp" href="https://golang.org/pkg/fmt/" rel="noopener ugc nofollow" target="_blank">的文档。那里的内容还真不少。在本教程中，我不打算逐一介绍它们。我想指出的是这个包里的格式化程序。当操作字符串时，使用格式化程序可以节省我们的时间和代码行。</a></p><p id="a494" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你会发现一些函数的名字后面有一个“f”。这表明这些函数接受formatter作为参数。那么我们如何使用格式化程序呢？让我们来看看这个<code class="fe kq kr ks kt b">Printf </code>函数的例子。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">格式化程序—基本用法</figcaption></figure><p id="1c6f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kq kr ks kt b">Printf</code>中的第一个参数是格式字符串，后面的参数是将替换格式“动词”的自变量。在上面的例子中，格式动词<code class="fe kq kr ks kt b">%s</code>被替换为<code class="fe kq kr ks kt b">whoami</code>值。您可以在格式字符串后放置任意数量的参数。但是，唯一的要求是格式谓词的数量需要与参数的数量相匹配。</p><p id="7922" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个格式器的核心在于格式动词，下面我们来看看不同类型的格式动词，如果你想看格式动词的完整列表，你可以在<code class="fe kq kr ks kt b">fmt</code>包的文档中找到它们。</p><h2 id="033c" class="mi kv it bd kw mj mk dn la ml mm dp le kb mn mo li kf mp mq lm kj mr ms lq mt bi translated"><strong class="ak">布尔型</strong></h2><p id="1a96" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">布尔值唯一可用的格式动词是<code class="fe kq kr ks kt b">%t</code>，它将布尔值格式化为字符串值(“真”或“假”)。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">格式化程序—布尔值</figcaption></figure><h2 id="e9ba" class="mi kv it bd kw mj mk dn la ml mm dp le kb mn mo li kf mp mq lm kj mr ms lq mt bi translated">数字</h2><p id="fcf6" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">数字有更多的格式动词。下面是一些使用最广泛的方法。</p><ul class=""><li id="a71a" class="nb nc it js b jt ju jx jy kb nd kf ne kj nf kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%b</code>:基数2的数字</li><li id="4156" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%d</code>:十进制数</li><li id="033b" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%U</code> : Unicode格式</li><li id="ab3b" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%e</code> / <code class="fe kq kr ks kt b">%E</code>:科学记数法</li><li id="1e54" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%f</code>:小数点数字</li></ul><p id="d007" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看他们的行动。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">格式化程序—数字</figcaption></figure><p id="9b44" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">注意:用反勾号括起来的格式字符串与普通双引号相同。然而，反勾号允许在多行中写入单个字符串。</em></p><h2 id="1578" class="mi kv it bd kw mj mk dn la ml mm dp le kb mn mo li kf mp mq lm kj mr ms lq mt bi translated"><strong class="ak">琴弦</strong></h2><p id="cc0f" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">字符串的格式谓词:</p><ul class=""><li id="5287" class="nb nc it js b jt ju jx jy kb nd kf ne kj nf kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%s</code>:字符串</li><li id="5650" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%q</code>:字符串用双引号括起来，安全转义</li></ul><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">格式化程序—字符串</figcaption></figure><h2 id="62d6" class="mi kv it bd kw mj mk dn la ml mm dp le kb mn mo li kf mp mq lm kj mr ms lq mt bi translated"><strong class="ak">一般</strong></h2><p id="37b7" class="pw-post-body-paragraph jq jr it js b jt mu jv jw jx mv jz ka kb mw kd ke kf mx kh ki kj my kl km kn im bi translated">上面提到的动词是针对特定类型的。也有通用的格式动词，适用于任何类型。</p><ul class=""><li id="8762" class="nb nc it js b jt ju jx jy kb nd kf ne kj nf kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%v</code>`:默认格式的值</li><li id="3c18" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%+v</code>:当值为结构时打印字段名称</li><li id="b670" class="nb nc it js b jt nk jx nl kb nm kf nn kj no kn ng nh ni nj bi translated"><code class="fe kq kr ks kt b">%#v</code>:打印值的Go语法表示</li></ul><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">格式化程序—一般值</figcaption></figure><p id="47f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更多时候，我们并不真的需要在控制台中打印出字符串。我们只需要格式化字符串并在程序中使用它们。幸运的是，还有一个函数叫做<code class="fe kq kr ks kt b">Sprintf</code>。它与<code class="fe kq kr ks kt b">Printf</code>相同，唯一的区别是<code class="fe kq kr ks kt b">Sprintf</code>将格式化的字符串作为变量返回。</p><h1 id="061a" class="ku kv it bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">下一步是什么？</h1><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi np"><img src="../Images/d3ac6875264fce2204700a92b4ee764f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jT9Po2SyzF5LB4Kr"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">照片由<a class="ae kp" href="https://unsplash.com/@lsgr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Olesya Grichina </a>在<a class="ae kp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="4a0d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下一个教程中，我们将讨论指针和函数。敬请期待，下一集再见。</p><p id="5351" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你遇到任何问题或者需要帮助，请在下面留下你的评论。随时欢迎反馈。感谢您的阅读！</p><p id="9a7e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">特别感谢</em> </strong> <a class="ae kp" href="https://medium.com/@mhumecook" rel="noopener"> <strong class="js iu"> <em class="ko">马克谟-库克</em> </strong> </a> <strong class="js iu"> <em class="ko">对本教程的点评。</em>T15】</strong></p></div></div>    
</body>
</html>