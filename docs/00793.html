<html>
<head>
<title>This Nest Is A Bit Drafty — Utilizing Nested Lists In Draft.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这个嵌套有点通风——利用了Draft.js中的嵌套列表</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/this-nest-is-a-bit-drafty-709ef8b79073?source=collection_archive---------3-----------------------#2019-07-30">https://levelup.gitconnected.com/this-nest-is-a-bit-drafty-709ef8b79073?source=collection_archive---------3-----------------------#2019-07-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b52e12e2b80ab6d1dc2f5f2c53da10b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8G4LEA2sbNjtGVGdt6wz6A.jpeg"/></div></div></figure><div class=""/><p id="ec87" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://draftjs.org/" rel="noopener ugc nofollow" target="_blank"> Draft.js </a>是在React应用程序中创建富文本编辑器的一个非常好的工具，但是理解如何释放其全部潜力是一项具有挑战性的任务。</p><p id="7ec4" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我最近设计了一个应用程序，可以帮助用户引用研究项目的参考资料，并允许他们在这些参考资料上做笔记和存储笔记。我想让笔记功能尽可能无缝，我知道允许用户使用嵌套列表是这样做的关键。然而，事实证明这项任务比我预想的要困难得多。虽然Draft.js的文档说明了<a class="ae kz" href="https://draftjs.org/docs/advanced-topics-nested-lists" rel="noopener ugc nofollow" target="_blank">它提供了对嵌套列表的支持</a>，但是对于如何实现这一点却没有给出多少提示。</p><p id="9c9b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我希望通过演示如何为Draft.js文本编辑器创建有序和无序列表切换，以及如何在按下Tab键时赋予这些列表嵌套的能力，来阐明Draft.js的这一方面。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><p id="604b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将从设置一个基本的Draft.js编辑器开始。由于<a class="ae kz" href="https://draftjs.org/docs/getting-started" rel="noopener ugc nofollow" target="_blank"> Draft.js文档很好地解释了如何进行这个</a>，所以我不会详细介绍这一步。下面是我们的初始设置:</p><figure class="lh li lj lk gt iv"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="b86f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下一步是为有序列表和无序列表创建切换。为此，我们将创建另一个名为<code class="fe ln lo lp lq b">EditorToolbar</code>的组件，并将其呈现在<code class="fe ln lo lp lq b">TextEditor</code>组件中。接下来，我们将在工具栏中添加按钮来切换列表。由于<code class="fe ln lo lp lq b">EditorToolbar</code>将会更换<code class="fe ln lo lp lq b">editorState</code>，我们需要将<code class="fe ln lo lp lq b">editorState</code>和<code class="fe ln lo lp lq b">setEditorState</code>作为道具传递给<code class="fe ln lo lp lq b">EditorToolbar</code>。完成后，我们的应用程序将如下所示:</p><figure class="lh li lj lk gt iv"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="733b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们的按钮需要切换列表样式的能力。为了帮助完成这项任务，Draft.js有一个名为<code class="fe ln lo lp lq b">RichUtils</code>的模块，它提供了向编辑器添加文本样式的功能。它提供的一个名为<code class="fe ln lo lp lq b">toggleBlockType</code>的函数将当前的<code class="fe ln lo lp lq b">editorState</code>更改为指定的html元素块类型(<code class="fe ln lo lp lq b">&lt;ul&gt;</code> <code class="fe ln lo lp lq b">&lt;ol&gt;</code> <code class="fe ln lo lp lq b">&lt;h1&gt;</code> <code class="fe ln lo lp lq b">&lt;blockquote&gt;</code>等)。).让我们在<code class="fe ln lo lp lq b">EditorToolbar</code>中导入<code class="fe ln lo lp lq b">RichUtils</code>。</p><p id="b949" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">之后，我们将构建一个名为<code class="fe ln lo lp lq b">toggleBlockType</code>的函数，并将<code class="fe ln lo lp lq b">onMouseDown</code>事件处理程序添加到按钮中。这些事件处理器将调用<code class="fe ln lo lp lq b">toggleBlockType</code>，并向其传递事件和指定的块类型(或者<code class="fe ln lo lp lq b">'ordered-list-item'</code>或者<code class="fe ln lo lp lq b">'unordered-list-item'</code>)。</p><p id="506e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">默认情况下，当按下按钮时，文本编辑器中的光标将从文本编辑器中消失，按钮将被选中。这就是为什么我们对按钮使用<code class="fe ln lo lp lq b">onMouseDown</code>而不是<code class="fe ln lo lp lq b">onClick</code>事件。<code class="fe ln lo lp lq b">onMouseDown</code>允许使用<code class="fe ln lo lp lq b">preventDefault</code>，通过调用<code class="fe ln lo lp lq b">preventDefault</code>光标将不再选择按钮。相反，它将保留在文本编辑器中的同一位置。</p><p id="d314" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在<code class="fe ln lo lp lq b">EditorToolbar</code>看起来是这样的:</p><figure class="lh li lj lk gt iv"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="af63" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果单击按钮，可以看到编辑器将显示指定的块类型。</p><p id="fb43" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们需要添加当Tab键被按下时嵌套列表的功能。</p><p id="5bd6" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Draft.js <code class="fe ln lo lp lq b">Editor</code>有一个名为<code class="fe ln lo lp lq b">onTab</code>的属性，当Tab键被按下时，它将允许我们执行指定的功能。我们将以与任何React事件处理程序相同的方式使用它。我们将在名为<code class="fe ln lo lp lq b">handleTab</code>的<code class="fe ln lo lp lq b">TextEditor</code>组件中创建一个事件处理函数，并将其传递给<code class="fe ln lo lp lq b">onTab</code> prop。</p><p id="095a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">默认情况下，当按下Tab键时，光标将选择下一个交互式元素。在填写表单时，这是一个很有用的默认设置，但是对于做笔记来说，这一点帮助都没有。这就是为什么我们必须在我们的<code class="fe ln lo lp lq b">handleTab</code>函数中使用<code class="fe ln lo lp lq b">preventDefault</code>。</p><p id="b3c8" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们将把<code class="fe ln lo lp lq b">RichUtils</code>导入到我们的<code class="fe ln lo lp lq b">TextEditor</code>中。<code class="fe ln lo lp lq b">RichUtils</code>还有一个<code class="fe ln lo lp lq b"><a class="ae kz" href="https://draftjs.org/docs/api-reference-rich-utils#ontab" rel="noopener ugc nofollow" target="_blank">onTab</a></code>函数，它接受事件<code class="fe ln lo lp lq b">editorState</code>和一个间隔深度的整数。我们将把<code class="fe ln lo lp lq b">editorState</code>设置为这个函数的返回值，也就是当前的<code class="fe ln lo lp lq b">editorState</code>，在已经显示的列表中嵌套了一个添加的列表。然后我们需要返回字符串<code class="fe ln lo lp lq b">'handled'</code>，这样编辑器就知道这个键盘命令已经被处理了，不需要做其他任何事情。</p><p id="e53d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，为了在按下Tab键时显示嵌套，我们需要导入Draft.js默认CSS库。完成所有这些后，我们的<code class="fe ln lo lp lq b">TextEditor</code>看起来会像这样:</p><figure class="lh li lj lk gt iv"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="0773" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就是这样！我们的文本编辑器具有嵌套列表功能。您可以通过单击其中一个列表开关并按Tab键来测试它。您也可以通过按Shift + Tab来删除嵌套。</p><p id="39fd" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您感兴趣，您可以在此处查看该应用程序的存储库:</p><div class="is it gp gr iu lr"><a href="https://github.com/Lige-w/draftjs-lists" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jf gy z fp lw fr fs lx fu fw jd bi translated">李哥-w/draft js-列表</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">Draft.js嵌套列表</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">github.com</p></div></div></div></a></div></div></div>    
</body>
</html>