<html>
<head>
<title>OAuth in Compose for Desktop with Auth0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Auth0为桌面撰写OAuth</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/oauth-in-compose-for-desktop-with-auth0-9990075606a1?source=collection_archive---------3-----------------------#2022-03-23">https://levelup.gitconnected.com/oauth-in-compose-for-desktop-with-auth0-9990075606a1?source=collection_archive---------3-----------------------#2022-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/fd424b38444084d367fef167d538f09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*xqhaFY34lPV1j8oU6kAa2A.jpeg"/></div></figure><p id="fb01" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在桌面应用程序中使用OAuth似乎不是最流行的用例，但是我们在这里。我目前正在移植一个Android应用程序，以便与Compose for Desktop一起构建。除了Auth0之外，几乎所有东西都有多平台选择。这就引出了今天的文章。</p><p id="b661" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">问题:我们想登录Auth0，最好支持OIDC，这样我们可以使用谷歌或脸书连接器等。基本步骤是:将用户发送到Auth0托管的网页，当用户登录时侦听重定向，从Auth0请求访问令牌。简单吧？</p><p id="27ac" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于这个例子，我使用的是Compose for Desktop。这里没有太多特定于Compose的内容，所以只需做很少的修改，它就可以用于任何Java UI工具包。这个例子是用Kotlin编写的，但是如果您从使用Ktor客户机切换到Java HTTP客户机，它可以很容易地移植到Java。</p><p id="0322" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">事不宜迟，第一步:打开浏览器进入登录页面。</p><figure class="ks kt ku kv gt jr"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="dd3d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里有相当多的东西需要打开。首先，我们按照Auth0在其指南中指定的方式创建一个验证器和挑战码。我不打算解释这些方法，只是提到您需要添加对Apache Commons编解码器的依赖，它们使用两个不同的Base64模块。行“Desktop.getDesktop()。browse()"在用户的默认浏览器中打开指定的URL。</p><p id="c333" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">第二步:我们等待来自浏览器的HTTP请求。</p><figure class="ks kt ku kv gt jr"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="f1e8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在上一步中，我使用“http://localhost:5789/callback”作为重定向URI。在这一步中，我们监听浏览器以“code”作为参数重定向到该URL。我们必须解析查询字符串(可以在GitHub存储库中找到)以获得Auth0返回的代码。重定向URI需要在Auth0中的允许回拨URIs列表中。您可以将它更改为您想要的任何URI，但是您需要一种将其绑定到您的应用程序的方法。</p><p id="cf64" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，我们需要将代码发送回Auth0以获取我们的访问令牌。</p><figure class="ks kt ku kv gt jr"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="17ea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里我使用Ktor客户机发送一个访问令牌的请求。我们需要传递我们在步骤1中创建的验证器和在步骤2中收到的代码。客户端id和重定向URI也是必需的参数。</p><p id="e0c3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你可以在https://github.com/sproctor/AuthCompose找到一个工作样本。您需要有一个Auth0租户和客户端设置，并在Main.kt中填写适当的详细信息。</p></div></div>    
</body>
</html>