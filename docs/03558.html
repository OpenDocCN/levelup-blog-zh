<html>
<head>
<title>Implementing an e-mail service using Amazon SES.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Amazon SES实现电子邮件服务。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/implementing-an-e-mail-service-using-amazon-ses-7219440821de?source=collection_archive---------3-----------------------#2020-05-16">https://levelup.gitconnected.com/implementing-an-e-mail-service-using-amazon-ses-7219440821de?source=collection_archive---------3-----------------------#2020-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/7877072e0fa9be3fe87b7dd8038b8a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*hxgRJe0bU91JIhKo7zS-dQ.png"/></div></figure><h2 id="ba4a" class="jx jy it bd jz ka kb dn kc kd ke dp kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">介绍</h2><p id="794f" class="pw-post-body-paragraph kt ku it kv b kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln im bi translated">Amazon <a class="ae lo" href="https://aws.amazon.com/ses/" rel="noopener ugc nofollow" target="_blank"> SES </a>或简单电子邮件服务是一种基于云的电子邮件服务，主要由开发人员和数字营销人员用于发送电子邮件以进行营销、交易和通知。在本文中，我们将介绍在Amazon SES上构建电子邮件服务来发送电子邮件通知的过程。</p><h2 id="d1e8" class="jx jy it bd jz ka kb dn kc kd ke dp kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用SES的先决条件</h2><ul class=""><li id="ede6" class="lp lq it kv b kw kx la lb kg lr kk ls ko lt ln lu lv lw lx bi translated">AWS帐户</li><li id="28bf" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated">SES验证的发件人电子邮件地址</li></ul><h2 id="77d7" class="jx jy it bd jz ka kb dn kc kd ke dp kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">过程</h2><p id="877f" class="pw-post-body-paragraph kt ku it kv b kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln im bi translated">应用程序将触发队列，该队列将向lambda函数发送消息。这个lambda函数将触发SES，SES将向接收者发送一封邮件。我们将上传一个压缩文件到lambda函数中。在本文中，我们将使用控制台和CFT创建资源。资源包括一个<a class="ae lo" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank">λ</a>和一个<a class="ae lo" href="https://aws.amazon.com/sqs/" rel="noopener ugc nofollow" target="_blank"> SQS </a>。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi md"><img src="../Images/be9a9d0d75b490e0e55d02b7f293f067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrmRnodXaWbanoBVlorglg.png"/></div></div></figure><h2 id="ea04" class="jx jy it bd jz ka kb dn kc kd ke dp kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">最佳实践</h2><p id="9b35" class="pw-post-body-paragraph kt ku it kv b kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln im bi translated">在开始设置和实现之前，让我们看一下在构建服务组件时应该遵循的一些最佳实践。我想强调的编程原则之一是DRY，它代表不要重复自己。这可以用来维护一个干净的代码库，以便更好地维护，最重要的是避免错误。</p><p id="5fb5" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">想象一个场景，您在五个组件中实现了相同的代码功能。现在，当需要改变这个功能的行为时，您必须改变所有五个组件中的代码。如果您错过了至少一个组件，要么整个系统会崩溃，要么相同的功能在未更改的组件中会有不同的行为。有几种方法可以维护遵循DRY原则的代码库。下一节解释了电子邮件服务实现遵循DRY原则的几种方式。更多其他方式的细节可以在<a class="ae lo" href="https://metova.com/dry-programming-practices/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><ol class=""><li id="4fc2" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln mu lv lw lx bi translated"><strong class="kv iu">抽象</strong>——这样做的目的是将代码分解成可重用的部分，从而避免代码重复。换句话说，构建包含公共逻辑的模块或组件应该被隔离，以便在必要时重用。该服务的另一个重要因素是，实现的复杂性对使用该组件的开发人员来说是隐藏的。要利用这一点，只需将消息推送到队列的主体。关于这一点的进一步解释可以在文章的<a class="ae lo" href="#e480" rel="noopener ugc nofollow">这一</a>部分找到。</li><li id="2978" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln mu lv lw lx bi translated"><a class="ae lo" href="https://medium.com/machine-words/separation-of-concerns-1d735b703a60" rel="noopener"> <strong class="kv iu">分离关注点</strong></a>——维护和分离各个层并确保它们是松散耦合的，这一点很重要。一个组件应该负责一个动作。这将使重构、错误处理和维护更加简单。在这种情况下，电子邮件组件单独负责发送电子邮件。多个组件可以使用这个电子邮件服务，而不必重复SES代码。事实上，这可以被认为是一个微服务，因为这是一个松散耦合的组件，可以独立部署，也可以单独维护和测试。如果要添加任何增强功能，甚至完全从SES转移到另一个服务，也不会有任何麻烦，因为应用程序中断的可能性非常低。</li></ol><h2 id="7a17" class="jx jy it bd jz ka kb dn kc kd ke dp kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">建立基础设施</h2><p id="623e" class="pw-post-body-paragraph kt ku it kv b kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln im bi translated">基础设施可以通过多种方式建立。我使用了AWS管理控制台和CFT来创建资源。你可以在这里找到CFT<a class="ae lo" href="#fa6c" rel="noopener ugc nofollow"/>。</p><p id="0550" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">使用AWS管理控制台</strong></p><p id="08ba" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">在SQS创建一个队列。</p><p id="d680" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">步骤1 </strong>:从AWS服务中选择简单队列服务(SQS)，输入队列名称，并选择FIFO队列选项。</p><ul class=""><li id="b8b6" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated">为此，我使用了一个FIFO队列，以确保消息发送和接收的顺序一致，并确保队列中不包含任何重复项。因为我们使用的是FIFO队列，所以名称必须以后缀<em class="mv">结尾。fifo </em>。</li></ul><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mw"><img src="../Images/2dd8f553ec9ce3cea388ac445226d386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LWYJ_O3EQIlgX2KLj-tY_w.png"/></div></div></figure><p id="ff70" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">单击配置队列继续执行步骤2。</p><p id="f9a6" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">第二步</strong>:设置队列属性。</p><ul class=""><li id="7fec" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated"><strong class="kv iu"> Visibility timeout </strong>是我们的应用程序从队列中处理和删除消息所花费的最长时间。</li><li id="4579" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated"><strong class="kv iu">基于内容的重复数据删除</strong>可确保在重复数据删除间隔期间，SQS会将内容相同的消息视为重复消息，并且仅提供该消息的一份副本。</li></ul><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mx"><img src="../Images/88c66bef8f01b2382b10800dcbc62a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HHYmWDetLjgKhdowT4p6hw.png"/></div></div></figure><p id="ecfc" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">在创建队列之后，您将会看到这一点。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi my"><img src="../Images/19fcd9cef4e8d860ab6eaf8f504b2b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I7U4obEZuiqMa72I4D0Viw.png"/></div></div></figure><p id="21cb" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">二。创建IAM角色。</p><p id="9993" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">大多数AWS服务需要角色来允许服务代表我们访问其他服务中的资源。这称为服务角色。更多细节可以在<a class="ae lo" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="24b7" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">步骤1 </strong>:从AWS服务中选择身份和访问管理(IAM)。选择角色&gt;创建角色。如下所示，从列表中选择AWS服务和Lambda。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mz"><img src="../Images/3f486b27e2d0e9e81330959f53702586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMyD77bKnZd_5loPQjoGZw.png"/></div></div></figure><p id="b9dc" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">第二步:</strong>从策略列表中选择<strong class="kv iu">awslambdabasiceexecutionrole</strong>。</p><ul class=""><li id="af4a" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated">该策略允许lambda将日志上传到<a class="ae lo" href="https://aws.amazon.com/cloudwatch/" rel="noopener ugc nofollow" target="_blank"> CloudWatch </a>。</li></ul><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi na"><img src="../Images/24b998ef604f03bf7a10e5882e90bea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHmgnwn77c8i3gxV-1eqlA.png"/></div></div></figure><p id="9723" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">该角色需要访问其他AWS服务(如SQS和SES)的权限。为此，必须创建另一个策略。</p><p id="68a1" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">步骤3: </strong>创建另一个策略</p><ol class=""><li id="8857" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln mu lv lw lx bi translated">我首先附加了SES权限。</li></ol><ul class=""><li id="9ae9" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated">动作:我已经在“写”类别中提供了对下面显示的动作的访问。</li><li id="2beb" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated">资源:提供对所有资源的访问</li></ul><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nb"><img src="../Images/1d8366b977c02c6cc4204dbe32aa466a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rakTEhr9EfiZDN4EJnc2RQ.png"/></div></div></figure><p id="9869" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">2.接下来，我们将附加SQS权限。</p><ul class=""><li id="18f2" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated">动作:我提供了对下面“读取”和“写入”类别中显示的动作的访问。</li><li id="03ce" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated">资源:提供我们创建的特定队列。从我们之前创建的队列中添加亚马逊资源名称(<a class="ae lo" href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html" rel="noopener ugc nofollow" target="_blank"> ARN </a>)。(创建队列后，可以在“详细信息”选项卡中找到)。</li></ul><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nc"><img src="../Images/e798b08311dd1fb99d6838f1254c4539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cDsuAwrKd80g8kSiiqTp_g.png"/></div></div></figure><p id="64af" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">3.通过输入策略的名称和描述(非强制性)来查看和创建策略。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nd"><img src="../Images/d7caf62b4ab2c6d5dd98c0e3412252a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47FKE3cfpLNhBdxx6pb96g.png"/></div></div></figure><p id="bd06" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">第4步:</strong>将我们在上面创建的策略附加到角色，输入名称和描述(不是强制的)并创建角色。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ne"><img src="../Images/c39479b1c3a3470dc6fde65a78b9ae91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrXMLVfb5qv_BuD2ZEd5Uw.png"/></div></div></figure><p id="6303" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">三。创建Lambda函数。</p><p id="4cb5" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">AWS中的Lambda允许您在不提供或管理服务器的情况下运行代码。更多细节可以在<a class="ae lo" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="1afe" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">步骤1 </strong>:从AWS服务&gt;创建函数中选择Lambda</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nf"><img src="../Images/6845689fc146cc544b2f31d53c3a12ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99Hfz4AHtoa1QuwYTzcdrQ.png"/></div></div></figure><p id="d104" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated"><strong class="kv iu">第二步</strong>:提供Lambda的基本信息。我已经使用Node.js 12 x作为运行时。附加我们之前创建的角色。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ng"><img src="../Images/19b823ea468f83462db13f0ad9a693bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBgsUzEU-yZVDESng5cBhw.png"/></div></div></figure><p id="acba" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">最后一步，我们需要配置队列来触发lambda。导航到队列&gt;配置Lambda函数的触发器&gt;选择Lambda函数的名称&gt;单击保存。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nh"><img src="../Images/c0d9d6684dd02b8cb1eb0ad4effa3df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HO3jKaQSreJWmPYQ4q-jTw.png"/></div></div></figure><p id="3755" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">现在我们已经连接了我们所有的AWS资源。这整个过程也可以通过运行CloudFormationTemplate来完成。我在本文的最后加入了自动创建资源的CFT。</p><h2 id="e480" class="jx jy it bd jz ka kb dn kc kd ke dp kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">履行</h2><p id="9f00" class="pw-post-body-paragraph kt ku it kv b kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln im bi translated">电子邮件可以通过三种方式发送。</p><ol class=""><li id="a9ef" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln mu lv lw lx bi translated">SES控制台</li><li id="8c49" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln mu lv lw lx bi translated">SES简单邮件传输协议(SMTP)接口。</li><li id="37a1" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln mu lv lw lx bi translated">SES API。</li></ol><p id="c3a4" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">API可以通过其他三种方式调用。我在这篇文章中使用了AWS SDK。关于其他方式的更多细节可以在<a class="ae lo" href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/send-email-api.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。在本文中，我使用了SDK和NodeJs。该实现需要以下格式的对象。</p><pre class="me mf mg mh gt ni nj nk nl aw nm bi"><span id="1822" class="jx jy it nj b gy nn no l np nq">{<br/>    "recipientAddress":"recipient@example.com",<br/>    "subject":"Email subject",<br/>    "body":"Email body"<br/>}</span></pre><p id="ca0d" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">为了向任何收件人地址发送电子邮件，应该将AWS帐户移出沙箱。默认情况下，每个账户都放在亚马逊沙箱中。AWS对沙箱中的帐户应用某些限制。这里的文档<a class="ae lo" href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/request-production-access.html" rel="noopener ugc nofollow" target="_blank">解释了如何将帐户移出沙箱的步骤。但是，要使用此服务，必须在ses上验证源、发送方和返回路径地址。</a></p><p id="2987" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">下面的代码需要一个如上所述的带有收件人地址、主题和正文的对象。根据收件人的电子邮件客户端，正文可以以三种格式发送。</p><ul class=""><li id="4460" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated">如果电子邮件客户端可以解释HTML，正文可以包含格式化文本和超链接。</li><li id="d9a1" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated">如果电子邮件客户端是基于文本的，确保用文本替换HTML。文本格式不应包含任何不可打印的字符。</li><li id="06f1" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated">如果邮件发给一群人，用两种格式发送相同的内容是有意义的。电子邮件客户端根据其功能决定显示哪种格式。</li></ul><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2a30" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">这个文件包含Lambda函数的handler方法。Lambda函数中的这个方法处理事件。变量'<em class="mv"> emailInput' </em>包含作为JSON对象从队列发送的消息体。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="bc67" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">要在本地测试该功能，请编辑<em class="mv"> email_lambda.js </em>，如下所示。为收件人地址、主题和正文分配适当的值。</p><pre class="me mf mg mh gt ni nj nk nl aw nm bi"><span id="6821" class="jx jy it nj b gy nn no l np nq">const sesClient = require(‘./EmailNotifications’);</span><span id="85c6" class="jx jy it nj b gy nt no l np nq">const emailInput = <!-- -->{<br/>    "recipientAddress":"recipient@example.com",<br/>    "subject":"Email subject",<br/>    "body":"Email body"<br/>}</span><span id="0c52" class="jx jy it nj b gy nt no l np nq">sesClient.sendEmail(emailInput);</span></pre><p id="584d" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">运行下面给出的命令。</p><pre class="me mf mg mh gt ni nj nk nl aw nm bi"><span id="2ee5" class="jx jy it nj b gy nn no l np nq">node fileName.js</span></pre><p id="20ea" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">压缩文件代码可以通过两种方式添加到lambda中。通过将zip文件直接上传到lambda函数，或者通过将zip文件移动到S3桶中，并将<a class="ae lo" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> S3 </a>桶的URL提供给lambda函数。</p><ul class=""><li id="b7d7" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated">重要的是，zip文件直接包含文件，而不是包含文件的文件夹</li></ul><p id="fd2c" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">正确的格式</p><pre class="me mf mg mh gt ni nj nk nl aw nm bi"><span id="0927" class="jx jy it nj b gy nn no l np nq">email_lambda.zip &gt; email_lambda.js<br/>                   EmailNotifications.js<br/>                   package.json<br/>                   package-lock.json<br/>                   node_modules</span></pre><ol class=""><li id="a0ad" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln mu lv lw lx bi translated">通过直接将zip文件上传到lambda函数。</li></ol><p id="d3c6" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">处理程序名应该是代码中包含处理程序方法的文件的名称，后跟后缀<em class="mv">。处理器</em>。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nu"><img src="../Images/2250bbb212fce80db9c115b17e8b0a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HsB0vGYX97LqKVn5DDY1dg.png"/></div></div></figure><p id="05cb" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">现在，要测试代码是否工作，导航到队列&gt;队列操作&gt;发送消息。添加以下内容作为消息正文。用有效的电子邮件地址替换收件人地址，并添加消息组id。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nv"><img src="../Images/2edf3442503067240146324e4924b612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dhTCp8ugZoKGil6oqscb7g.png"/></div></div></figure><p id="4f52" class="pw-post-body-paragraph kt ku it kv b kw mm ky kz la mn lc ld kg mo lf lg kk mp li lj ko mq ll lm ln im bi translated">当你点击<em class="mv">发送消息，</em>你应该会收到一封邮件。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nw"><img src="../Images/ec51165e80a794c8b6e9bdffd445fba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zbicOFa5yyI83lYbuvP8zA.png"/></div></div></figure></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><h2 id="fa6c" class="jx jy it bd jz ka kb dn kc kd ke dp kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">CFT</h2><p id="33d9" class="pw-post-body-paragraph kt ku it kv b kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln im bi translated">在运行CFT之前，用您自己的替换以下内容。</p><ul class=""><li id="e338" class="lp lq it kv b kw mm la mn kg mr kk ms ko mt ln lu lv lw lx bi translated">S3桶名</li><li id="5f39" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated">帐户ID</li><li id="bec5" class="lp lq it kv b kw ly la lz kg ma kk mb ko mc ln lu lv lw lx bi translated">地区</li></ul><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div></div>    
</body>
</html>