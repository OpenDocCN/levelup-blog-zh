<html>
<head>
<title>Git Outta Trouble</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">摆脱困境</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/git-outta-trouble-56aba6672cb8?source=collection_archive---------8-----------------------#2020-12-19">https://levelup.gitconnected.com/git-outta-trouble-56aba6672cb8?source=collection_archive---------8-----------------------#2020-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/68714d2b1b82d3e48138a716293fbafe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebFw-BsV2SAvjR9j0wXNqg.jpeg"/></div></div></figure><div class=""/><p id="3991" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你和Git去了森林，通常有办法回来。这里有一些命令行技巧可以帮助您重新找到线索。</p><h1 id="3239" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">证明</h1><p id="a4b1" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">第一次在命令行上使用Git时，它可能会要求您在浏览器中完成身份验证:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="7d86" class="ml la je mh b gy mm mn l mo mp">$ git push<br/>info: please complete authentication in your browser...<br/>Everything up-to-date</span></pre><p id="f8be" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果发生这种情况，进入浏览器，Git将帮助您创建一个令牌，在您每次键入命令时对您进行身份验证。</p><p id="f0d5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">旧的身份验证方法需要在您键入命令时输入用户名和密码:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="b828" class="ml la je mh b gy mm mn l mo mp">$ git push<br/>Username for 'https://github.com':</span></pre><p id="02ba" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果发生这种情况，这意味着您的存储库还没有更新到新的方式。如果您使用的是GitHub之类的主机，那么您的存储库应该已经配置为使用令牌。</p><p id="0b6d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您的回购仍然使用旧的身份验证方法，您可以存储您的用户名和密码，这样就不必每次都输入:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="dbd6" class="ml la je mh b gy mm mn l mo mp">$ git config credential.helper store<br/>$ git push<br/>Everything up-to-date</span></pre><p id="9563" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将您的凭据以纯文本形式存储在您的计算机上，远不如使用令牌的新身份验证方法安全。</p><h1 id="52df" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">在错误的分支中编辑</h1><p id="ebba" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">您在错误的分支中编辑了一个文件。您希望能够做的是撤销这些更改，切换分支，然后重新进行。实际上，更好的方法是从错误的分支中取出这些变化，轻轻地放在你想要的分支上。幸运的是，Git提供了一个名为<code class="fe mq mr ms mh b">stash</code>的命令来做这件事。</p><p id="7b42" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您不仅进行了编辑，而且错误地提交了更改，请在继续以下步骤之前，首先取消提交更改(请参见下面的“错误提交”)。</p><ol class=""><li id="15ea" class="mt mu je kd b ke kf ki kj km mv kq mw ku mx ky my mz na nb bi translated">确保您在正确的目录中。</li><li id="cc9b" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git status</code>检查你在哪个分支上，以确保你确实在错误的分支上。</li><li id="c374" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">隐藏你未提交的修改:<br/> <code class="fe mq mr ms mh b">$ git stash</code></li><li id="387e" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">切换到你希望一直工作的分支:<br/> <code class="fe mq mr ms mh b">$ git checkout the-right-branch<br/>Switched to branch ‘the-right-branch’</code></li><li id="aac5" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">stash pop</code>来应用那里的变化:<br/> <code class="fe mq mr ms mh b">$ git stash pop</code></li></ol><h1 id="6c58" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">编辑了错误的文件</h1><p id="d875" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">你打开一个文件来看，但是你的猫走过了键盘。</p><p id="2753" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您不确定添加或删除了什么。你只是想回到上次提交时的样子。为此，使用<code class="fe mq mr ms mh b">checkout</code>—它不仅仅用于切换分支！</p><ol class=""><li id="189b" class="mt mu je kd b ke kf ki kj km mv kq mw ku mx ky my mz na nb bi translated">确保您在正确的目录中。</li><li id="ff34" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git status</code>查看哪些文件被意外修改。例如:<br/> <code class="fe mq mr ms mh b">$ git status<br/>On branch main<br/>Changes not staged for commit:<br/> (use “git add &lt;file&gt;…” to update what will be committed)<br/> (use “git checkout — &lt;file&gt;…” to discard changes<br/>in working directory)<br/><br/> modified: dont-change-this.md</code></li><li id="ef11" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git checkout -- &lt;file&gt;</code>撤销更改。例如:<br/> <code class="fe mq mr ms mh b">git checkout -- dont-change-this.md</code></li></ol><p id="eb98" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe mq mr ms mh b">git status</code>命令的输出告诉你如何这样使用<code class="fe mq mr ms mh b">git checkout</code>。</p><h1 id="be24" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">合并冲突</h1><p id="468a" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">当同一个文件的同一个地方发生了两个变化时，没有您的帮助，Git无法合并。您需要编辑该文件，并决定保留这两个更改中的哪一个。</p><p id="0819" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当您打开文件时，合并冲突如下所示:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="0b3f" class="ml la je mh b gy mm mn l mo mp">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD<br/>Changed content from the point of view of the current commit<br/>=======<br/>Conflicting changed content<br/>&gt;&gt;&gt;&gt;&gt;&gt;&gt; 9af9d3b</span></pre><p id="f6e5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe mq mr ms mh b">HEAD</code>是一个指针，指向你所在的分支中最近的提交。另一个标签可以是另一个分支名称或代表另一个提交的数字。</p><p id="c48c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您需要做的就是决定您想要保留哪个版本的内容，然后删除合并冲突标记(<code class="fe mq mr ms mh b">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>、<code class="fe mq mr ms mh b">=======</code>、<code class="fe mq mr ms mh b">#&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>)。</p><p id="977c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在你以那种方式解决了所有的改变之后，再提交一次。</p><h1 id="1a3e" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">错误上演</h1><p id="9499" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">您以正确的方式编辑了正确的文件，但是您过于匆忙地将它添加到了临时区域。您不想撤销对文件的更改，但希望在下次提交时将其删除。这是<code class="fe mq mr ms mh b">reset</code>的用途之一。您还可以使用<code class="fe mq mr ms mh b">reset</code>进行更剧烈的回滚——如果需要，您可以撤销整个提交。</p><ol class=""><li id="daff" class="mt mu je kd b ke kf ki kj km mv kq mw ku mx ky my mz na nb bi translated">确保您在正确的目录中。</li><li id="5244" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git status</code>查看哪些文件被意外修改。例如:<br/> <code class="fe mq mr ms mh b">$ git status <br/>On branch main <br/>Changes to be committed: <br/> (use “git reset HEAD &lt;file&gt;…” to unstage)<br/> <br/> renamed: README.md -&gt; README <br/> modified: dont-commit-this.md</code></li><li id="496f" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git reset</code>从下一次提交中删除文件。例如:<br/> <code class="fe mq mr ms mh b">$ git reset HEAD dont-commit-this.md</code></li></ol><p id="d37e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe mq mr ms mh b">git status</code>命令的输出告诉您如何使用<code class="fe mq mr ms mh b">reset</code>取消变更。</p><h1 id="14e5" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">误犯</h1><p id="884c" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果你提交得太匆忙，只要你还没有提交它们，你就可以取消提交。</p><ol class=""><li id="d8fa" class="mt mu je kd b ke kf ki kj km mv kq mw ku mx ky my mz na nb bi translated">确保您在正确的目录中。</li><li id="d008" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git status</code>检查你在哪个分支上。如有必要，切换到您错误提交的分支。例如:<br/> <code class="fe mq mr ms mh b">$ git checkout the-wrong-branch <br/>Switched to branch ‘the-wrong-branch’</code></li><li id="85b1" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git reset</code>取消提交更改:<br/>T19】</li></ol><p id="5939" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果愿意，您可以稍后重新提交更改。</p><p id="4946" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你想先将更改移动到另一个分支，你可以使用<code class="fe mq mr ms mh b">git stash</code>(见下面的“在错误的分支中编辑”)。</p><h1 id="f5cc" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">误推</h1><p id="0e7a" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果您错误地提交了一个commit，您的错误现在会被其他人发现。幸运的是，有一种方法可以“撤销”推送。</p><p id="33e3" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">登录git主机查看实际推送的内容可能会很有用。</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/1d38034f2c14a3af762c0b897702d1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xq30xbkPAzU_ddQKKktfHw.png"/></div></div></figure><h2 id="fb49" class="ml la je bd lb ni nj dn lf nk nl dp lj km nm nn ln kq no np lr ku nq nr lv ns bi translated">反击一次糟糕的进攻</h2><p id="fcaa" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">以下是恢复错误推送的步骤:</p><ol class=""><li id="9ca3" class="mt mu je kd b ke kf ki kj km mv kq mw ku mx ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git log</code>显示最近提交的列表，并确定您错误推送的内容。<code class="fe mq mr ms mh b">--oneline</code>选项使列表更容易阅读。该列表从最新到最早排序。例:<br/> <code class="fe mq mr ms mh b">$ git log --oneline <br/>d9fa1d2 (HEAD -&gt; master, origin/master, origin/HEAD) This commit is a mistake! <br/>d555f66 Committing some lovely changes</code></li><li id="3b90" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git revert</code>和提交号(或提交<em class="nt">散列</em>)创建一个新的提交，该提交不做坏提交中的任何事情。例:<br/> <code class="fe mq mr ms mh b">$ git revert d9fa1d2</code></li><li id="4e10" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">出现一个屏幕，您可以在其中键入提交消息，或者只保留默认消息。保存和退出是不同的，这取决于Git使用哪个编辑器。如果你在屏幕底部看到一个命令列表，你可能正在使用Nano。按下<code class="fe mq mr ms mh b">Control-o</code>，然后按下<code class="fe mq mr ms mh b">Control-x</code>。<br/> -否则，你可能会使用<code class="fe mq mr ms mh b">vi</code>或Vim。键入一个冒号(<code class="fe mq mr ms mh b">:</code>)。如果你在屏幕底部看到一个冒号，你现在可以输入<code class="fe mq mr ms mh b">wq</code>并按回车键。</li><li id="1156" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">您可以使用<code class="fe mq mr ms mh b">git status</code>来查看您有一个新的提交，准备推送:<br/> <code class="fe mq mr ms mh b">$ git status <br/>On branch master <br/>Your branch is ahead of ‘origin/master’ by 1 commit. <br/> (use “git push” to publish your local commits)</code></li><li id="e178" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">用<code class="fe mq mr ms mh b">git push</code>命令推提交:<br/> <code class="fe mq mr ms mh b">$ git push</code></li></ol><p id="c566" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">负责修复回购协议。任何退出的人现在都将获得整个历史，包括错误和修复，并且世界都将是正确的。</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/2c38cc4aa53c30dacb7dc48b81905dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDtF4Ft8EDuK1WtM0atr9A.png"/></div></div></figure><p id="e01e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该操作将事情保持在您错误地推动更改之前的状态。换句话说，您的文件看起来就像您提交“一些可爱的更改”之后的样子，并且您在“这是一个错误”中所做的所有工作都已被撤消。</p><h2 id="529a" class="ml la je bd lb ni nj dn lf nk nl dp lj km nm nn ln kq no np lr ku nq nr lv ns bi translated">从旧提交中检索更改</h2><p id="2eb4" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如果您想要检索更改以便可以再次处理它们，请返回到旧的提交(例如，<code class="fe mq mr ms mh b">d9fa1d2</code>)并保存它们:</p><ol class=""><li id="affb" class="mt mu je kd b ke kf ki kj km mv kq mw ku mx ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git checkout</code>检查旧的提交。例:<br/> <code class="fe mq mr ms mh b">$ git checkout d9fa1d2</code></li><li id="9134" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">进行软复位，取消所有的修改:<br/> <code class="fe mq mr ms mh b">$ git reset --soft HEAD~1</code></li><li id="7ff7" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">如果您愿意，可以使用<code class="fe mq mr ms mh b">git status</code>来查看您现在有哪些未提交的更改。</li><li id="ec63" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git stash</code>来隐藏变化。</li><li id="5c0f" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git checkout</code>再次检查分支的<code class="fe mq mr ms mh b">HEAD </code>。如果你一直在主分支机构工作，使用<code class="fe mq mr ms mh b">git checkout main</code>:<br/>:<code class="fe mq mr ms mh b">$ git checkout main <br/>Previous HEAD position was d555f66 Committing some lovely changes <br/>Switched to branch ‘main’ <br/>Your branch is up to date with ‘origin/main’.</code></li><li id="7d6c" class="mt mu je kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">使用<code class="fe mq mr ms mh b">git stash pop</code>应用更改。</li></ol><p id="1a68" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以继续进行更改，然后在准备好的时候提交和推送。</p><h1 id="063c" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">更多…</h1><p id="eec7" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated"><strong class="kd jf">更新:</strong>我认为<em class="nt"> Git不一定很难</em>可能是一个足够有趣的主题，可以写一整本书。<a class="ae nv" href="https://www.amazon.com/dp/B095NPFJFR" rel="noopener ugc nofollow" target="_blank">于是我做了</a>:</p><figure class="mc md me mf gt iv gh gi paragraph-image"><a href="https://www.amazon.com/dp/B095NPFJFR"><div class="gh gi nw"><img src="../Images/e423d9e3cc3830d98ea5c2b006a5faf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/0*_XhpSRFCTh8QhugR.jpg"/></div></a></figure><p id="d649" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你没有时间读完一整本书，你可以看一个简短的视频:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="nx ny l"/></div></figure></div></div>    
</body>
</html>