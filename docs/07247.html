<html>
<head>
<title>Practical C# Attributes For Beginners and Intermediate Developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者和中级开发人员的实用C#属性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/practical-c-attributes-for-beginners-and-intermediate-developers-cf916bfd1194?source=collection_archive---------6-----------------------#2021-02-03">https://levelup.gitconnected.com/practical-c-attributes-for-beginners-and-intermediate-developers-cf916bfd1194?source=collection_archive---------6-----------------------#2021-02-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="27a7" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">C#教程</h2><div class=""/><div class=""><h2 id="588c" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">了解如何使用属性编写简单、干净且易于维护的代码。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/272df1f67f9b8d52e7843056cf7f46e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJLD6oM98c5X5KRYM1vyFw.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="lh li ep" href="https://medium.com/u/7c7a43b3d9de?source=post_page-----cf916bfd1194--------------------------------" rel="noopener" target="_blank">尼克拉斯·米勒德</a></figcaption></figure><p id="247a" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">你可能已经对什么是属性，什么时候使用它们以及为什么你应该关心它们做了大量的研究。让我猜猜，你已经一遍又一遍地遇到了相同的旧属性</p><p id="c025" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">让我们做一些完全不同的事情。</p><p id="a24d" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我记得几年前当我第一次遇到属性和反射时，我完全不知道它们是如何工作的，但是仍然能够从根本上改变我的应用程序的行为。</p><p id="bb8b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">消耗属性这个简单的行为对我来说是一个谜…</p><p id="0acc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">快进5-6年，我每天都在使用自定义属性来完成我的任务。</p><blockquote class="mj"><p id="ad65" class="mk ml it bd mm mn mo mp mq mr ms me dk translated">在本文结束时，您将能够轻松地使用定制属性和反射。</p></blockquote></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="0bde" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">属性在C#中非常有用，因为它们提供了一种简单的方法来将元信息附加到类、属性、方法甚至程序集。此外，属性通常可以代替标记接口——你知道，那些接口只是用来表示某种东西——其中没有声明方法或属性。</p><p id="7cb8" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">学习C#属性的最好方法就是深入研究如何使用它们的真实例子。</p><h2 id="8ad5" class="na nb it bd nc nd ne dn nf ng nh dp ni ls nj nk nl lw nm nn no ma np nq nr iz bi translated">我们将构建一个基于属性的CSV生成器。</h2><p id="4755" class="pw-post-body-paragraph lj lk it ll b lm ns kd lo lp nt kg lr ls nu lu lv lw nv ly lz ma nw mc md me im bi translated">但是，在一头扎进代码之前，让我花一点时间做一下准备。</p><p id="1045" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">CSV生成器并不是最令人兴奋的东西，但是我相信您会从下面的例子中学到一些东西。</p><p id="a7db" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我选择CSV生成器，因为在某些时候，您很可能需要以某种方式生成或解析CSV。此外，CSV很容易理解，因此，理解代码的意图是最小的开销。</p><p id="17fc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在我们的示例中，我们需要生成一个包含财务交易的CSV文件，如下图所示，但不应用属性——我们将在一分钟内创建并应用它。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/d66c1879162e518b0f8bdc5f4ccb6afe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OKvQQElNBNMUPWAS4AgBnA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">简单的交易模型。</figcaption></figure><p id="3ec3" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们对CSV文件的外观有一些要求。</p><ol class=""><li id="5352" class="ny nz it ll b lm ln lp lq ls oa lw ob ma oc me od oe of og bi translated">标题必须大写，单词之间用下划线分隔。</li><li id="c0e7" class="ny nz it ll b lm oh lp oi ls oj lw ok ma ol me od oe of og bi translated">我们希望在将属性写入CSV输出之前对其进行格式化。</li></ol><p id="04b5" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">例如，<code class="fe mf mg mh mi b">TransactionDate</code>变成了<code class="fe mf mg mh mi b">TRANSACTION_DATE</code>，应该格式化为<code class="fe mf mg mh mi b">yyyy/MM/dd</code>。</p><p id="6c74" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">任何熟悉C#的人都知道，简单地读取属性名和值不会允许这种转换…</p><p id="1858" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在本文的最后，使用上面的<code class="fe mf mg mh mi b">TransactionRow</code>模型生成一个CSV应该会给我们这样的结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/d0347f8ae9f0b57822aeffe72c5f278a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0ooG1ss3aOkrrUtae3qIA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">金融交易CSV输出。</figcaption></figure><h2 id="c736" class="na nb it bd nc nd ne dn nf ng nh dp ni ls nj nk nl lw nm nn no ma np nq nr iz bi translated">让我们创建属性。</h2><p id="263d" class="pw-post-body-paragraph lj lk it ll b lm ns kd lo lp nt kg lr ls nu lu lv lw nv ly lz ma nw mc md me im bi translated">创建属性就像创建一个继承自<code class="fe mf mg mh mi b">Attribute</code>的类一样简单，仅此而已。</p><p id="a6f4" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">对于我们的示例，我们将赋予属性一些自己的属性，比如我们希望标题字段被称为什么，它应该出现在哪个索引处，以及所需的格式。</p><p id="5077" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">此外，我们定义了一个<code class="fe mf mg mh mi b">Format</code>方法，它将按照指定的方式格式化传递给它的任何值。</p><p id="70c9" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">花几秒钟时间通读代码。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/7827e837eed1892d8229a05bd8bdb10e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1iri5yn4fF8RDLki3elWg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">简单的自定义属性。</figcaption></figure><p id="63a6" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">任何熟悉我的写作的人都知道我支持使用<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/if-else-is-a-poor-mans-polymorphism-ab0b333b7265">多态</a>而不是<a class="ae oo" href="https://medium.com/swlh/stop-using-if-else-statements-f4d2323e6e4" rel="noopener"> if-else和switch cases </a>。但是，因为我们只看属性，<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/write-shameless-garbage-code-ba6f79d46ed9">我将做一些快速和肮脏的分支，这有时是没问题的。</a>但是，一旦你发现自己不得不添加更多的分支——在本例中是格式化选项——我强烈建议你使用面向对象的方法进行重构。</p><p id="eaf5" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">使用我们的新属性非常简单。我们所做的就是将它应用到我们希望包含在CSV输出中的每个属性。提供给<code class="fe mf mg mh mi b">FieldInfo</code>属性的值充当它所修饰的属性的元信息。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/8846f8f9cad568ceef5daacee1827908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2m1l9qJRqtr4pgUjxyQy0w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">应用了属性的事务记录。</figcaption></figure><p id="ae06" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">您可能已经发现了记录所继承的<code class="fe mf mg mh mi b">StorageBase</code>。我们一会儿就会谈到这个问题。</p><h2 id="fffa" class="na nb it bd nc nd ne dn nf ng nh dp ni ls nj nk nl lw nm nn no ma np nq nr iz bi translated">消耗属性并使其工作的时间。</h2><p id="1d15" class="pw-post-body-paragraph lj lk it ll b lm ns kd lo lp nt kg lr ls nu lu lv lw nv ly lz ma nw mc md me im bi translated">读取我们应用于每个属性的属性只需要使用一点点反射。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/4e386af41610383a15ed549ad9339c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Qn6KGzFslg55Rs5bBak7Q.png"/></div></div></figure><p id="36f0" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这段代码真的没什么，但是，如果你是反射的新手，这就像第一次看到火一样。</p><p id="1879" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">因此，本质上，这个小代码片段只是获取T的类型，读取它自己的属性，并只选择那些应用了我们的自定义属性的属性。最后，返回包含属性信息和自定义属性的元组列表。</p><h2 id="d154" class="na nb it bd nc nd ne dn nf ng nh dp ni ls nj nk nl lw nm nn no ma np nq nr iz bi translated">最后，生成CSV输出。</h2><p id="9745" class="pw-post-body-paragraph lj lk it ll b lm ns kd lo lp nt kg lr ls nu lu lv lw nv ly lz ma nw mc md me im bi translated">把这些放在一起，我们得到了这个最后的类，它接受了一个必须继承<code class="fe mf mg mh mi b">StorageBase</code>的对象列表。</p><p id="775c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">同样，花一些时间来正确地浏览代码。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/061a0bcafb953edfae1a52289fc28455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPxRpnXFaMOtZOqdhBBq1A.png"/></div></div></figure><p id="49ae" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们基本上只是遍历对象列表，然后遍历每个对象的所有属性来获取相应的FieldInfo，并将属性值传递给FieldInfo <code class="fe mf mg mh mi b">Format(object)</code>方法。</p><p id="3521" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">下面我们的同事会这样使用我们的类。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/2bc3192f62783e1960b4e49ffc1e050a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5kFhvORbHIv_DM_-PcpjQ.png"/></div></div></figure><p id="e1f5" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">最后的<code class="fe mf mg mh mi b">csvResult</code>包含我们想要的CSV，如本演示开始时所示。</p><h1 id="e1c9" class="os nb it bd nc ot ou ov nf ow ox oy ni ki oz kj nl kl pa km no ko pb kp nr pc bi translated">离别词。</h1><p id="63fd" class="pw-post-body-paragraph lj lk it ll b lm ns kd lo lp nt kg lr ls nu lu lv lw nv ly lz ma nw mc md me im bi translated">现在，您应该对如何创建您自己的定制属性、如何使用它们以及它们带来的价值有了一个初步的、相当好的理解。</p><p id="fd46" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">当有意识地创建和应用自定义属性时，您可以用其他专门化类可能使用的元信息来修饰您的类。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><pre class="ks kt ku kv gt pd mi pe pf aw pg bi"><span id="88c0" class="na nb it mi b gy ph pi l pj pk"><strong class="mi jd">Resources for the curious</strong><br/>-------------------------<br/><a class="ae oo" href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/attributes/" rel="noopener ugc nofollow" target="_blank">Attributes (C#) in Microsoft Docs</a></span></pre></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="8f62" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll jd"> Nicklas Millard </strong>是一名软件开发工程师，供职于一家发展最快的银行，负责构建关键金融服务基础设施。</p><p id="7bfa" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">此前，他是Big4的高级技术顾问，为商业客户和政府机构开发软件。</p><blockquote class="pl pm pn"><p id="71d7" class="lj lk po ll b lm ln kd lo lp lq kg lr pp lt lu lv pq lx ly lz pr mb mc md me im bi translated"><a class="ae oo" href="https://www.youtube.com/channel/UCaUy83EAkVdXsZjF3xGSvMw" rel="noopener ugc nofollow" target="_blank">新的YouTube频道(@Nicklas Millard) </a></p><p id="3bea" class="lj lk po ll b lm ln kd lo lp lq kg lr pp lt lu lv pq lx ly lz pr mb mc md me im bi translated"><em class="it">连接上</em> <a class="ae oo" href="https://www.linkedin.com/in/nicklasmillard/" rel="noopener ugc nofollow" target="_blank"> <em class="it"> LinkedIn </em> </a></p></blockquote></div></div>    
</body>
</html>