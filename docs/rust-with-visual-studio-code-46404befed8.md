# ä½¿ç”¨ Visual Studio ä»£ç  Rust

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/rust-with-visual-studio-code-46404befed8>

## ç®€å•çš„æ“ä½œæ–¹æ³•

R ust è¶Šæ¥è¶Šå—æ¬¢è¿ï¼Œåœ¨å¼€å‘äººå‘˜ä¸­è¢«å¤§é‡é‡‡ç”¨ã€‚è¿™ç¯‡æ–‡ç« å°†å¸®åŠ©ä»»ä½•æƒ³åœ¨ 2020 å¹´ä½¿ç”¨ Visual Studio ä»£ç (VS ä»£ç )å¼€å‘ Rust åº”ç”¨ç¨‹åºçš„äººã€‚

æˆ‘ä¸æ˜¯ VIM å’Œ basic ç¼–è¾‘å™¨çš„å¿ å®ç²‰ä¸ã€‚å¤šå¹´æ¥ï¼Œæˆ‘å¼€å§‹æ¥è§¦åŸºæœ¬çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå¹¶å¾ˆå¿«é€‚åº”äº†å„ç§ ideï¼Œå› ä¸ºå®ƒä»¬æœ‰åŠ©äºåŠ å¿«å·¥ä½œæµç¨‹ã€‚ä»Šå¤©æˆ‘çš„åå¥½æ˜¯ IntelliJ å’Œ VS ä»£ç ã€‚

è¿™ç¯‡æ–‡ç« æ˜¯å…³äºé…ç½® VS ä»£ç æ¥ç¼–å†™ã€æ„å»ºå’Œè°ƒè¯• Rust åº”ç”¨ç¨‹åºçš„ã€‚å¤–é¢æœ‰å¾ˆå¤šä¿¡æ¯ï¼Œæˆ‘ä¸è®¤ä¸ºè¿™æ˜¯æœ€å¥½çš„æˆ–è€…å”¯ä¸€çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒæ˜¯å¤§é‡ä¾èµ–äºå®˜æ–¹æ–‡æ¡£çš„å„ç§æ–‡ç« çš„èåˆï¼Œå¯¹æˆ‘æ¥è¯´å¾ˆæœ‰ç”¨ã€‚

æˆ‘ä½¿ç”¨ä¸¤ç§ä¸åŒçš„ç¯å¢ƒè¿›è¡Œå¼€å‘ï¼Œä¸€ç§æ˜¯ Macbook Proï¼Œæˆ‘ç”¨å®ƒæ¥åšæœ€åˆçš„è„šæ‰‹æ¶ã€ä¾¿ç¬ºç°¿å’Œæ¦‚å¿µéªŒè¯ï¼Œå› ä¸ºæˆ‘å–œæ¬¢åœ¨å·¥ä½œæ—¶åœ¨å®¶é‡Œå››å¤„èµ°åŠ¨â€”â€”åœ¨å®¤å†…å’Œå®¤å¤–å·¥ä½œï¼Œè¯•å›¾æ•æ‰å¤§è‡ªç„¶çš„ä¸€äº›æ²»æ„ˆèƒ½åŠ›ğŸ˜„ã€‚å¯¹äºè¾ƒå¤§çš„åç«¯é¡¹ç›®ï¼Œé€šå¸¸æ˜¯åç«¯æœåŠ¡å™¨æˆ–äº¤å‰å¼€å‘é¡¹ç›®ï¼Œæˆ‘æ›´å–œæ¬¢åœ¨æˆ‘çš„ Linux æœºå™¨ä¸Šå¼€å‘ã€‚

> æœ¬æ–‡æ˜¯å…³äºåœ¨ MacOS ç¯å¢ƒä¸‹è®¾ç½® Visual Studio ä»£ç çš„ã€‚

# é˜²é”ˆè£…ç½®

æˆ‘æ¨èå®‰è£… *rustup* ï¼Œå› ä¸ºå®ƒå…è®¸åœ¨ä¸åŒç‰ˆæœ¬çš„ rust ä¹‹é—´åˆ‡æ¢â€”â€”å¯¹æˆ‘æ¥è¯´å¾ˆé‡è¦ï¼Œå› ä¸ºæˆ‘æƒ³ä¸º ARM å¤„ç†å™¨è¿›è¡Œäº¤å‰ç¼–è¯‘ã€‚

å®˜æ–¹ç¬”è®°å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°:[https://www.rust-lang.org/tools/install](https://www.rust-lang.org/tools/install)

## ä½¿ç”¨ brew å®‰è£… rustã€‚

*å¦‚æœä½ çš„ Mac ä¸Šæ²¡æœ‰å®‰è£…å®¶é…¿è½¯ä»¶ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä½ çŠ’åŠ³ä¸€ä¸‹è‡ªå·±ï¼Œå»å®‰è£…å®ƒâ€”â€”æŸ¥çœ‹* [*å®¶é…¿è½¯ä»¶*](https://brew.sh)

åœ¨ç»ˆç«¯çš„å‘½ä»¤è¡Œæç¤ºç¬¦ä¸‹:

```
â¯ brew install rustup
```

***æ³¨æ„:*** *å¦‚æœ rust å·²ç»å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨* ***rustup æ›´æ–°*** *è¿›è¡Œæ›´æ–°ã€‚*

## å®‰è£…ç¼–è¯‘å™¨å’ŒåŒ…ç®¡ç†å™¨ã€‚

åœ¨ç»ˆç«¯çš„å‘½ä»¤è¡Œæç¤ºç¬¦ä¸‹:

```
â¯ rustup-init
```

*æ‚¨å¯ä»¥ä½¿ç”¨ rustup self uninstall éšæ—¶å¸è½½ï¼Œè¿™äº›æ›´æ”¹å°†è¢«æ¢å¤ã€‚*

è¿è¡Œå®Œ`rustup-init`åï¼Œä½ ä¼šçœ‹åˆ°ä¸åŒçš„é€‰é¡¹â€”â€”ç»§ç»­ä½¿ç”¨é»˜è®¤é€‰é¡¹â€”â€”é€‰é¡¹ 1

```
1) Proceed with installation (default)
```

## éªŒè¯å®‰è£…

åœ¨ç»ˆç«¯çš„å‘½ä»¤è¡Œæç¤ºç¬¦ä¸‹:

```
â¯ rustc â€” version
rustc 1.46.0 (04488afe3 2020-08-24)
```

å®ƒåº”è¯¥è¿”å›å¸¦æœ‰ç‰ˆæœ¬å·çš„`rustc`ã€‚

***æ³¨æ„:*** *æ‚¨å¯èƒ½éœ€è¦é€€å‡ºå¹¶é‡æ–°åŠ è½½ç»ˆç«¯ä»¥ä½¿è·¯å¾„æ›´æ–°ç”Ÿæ•ˆã€‚*

# ç¬¬ä¸€ä¸ªä½ å¥½ä¸–ç•Œé¡¹ç›®

## å®‰è£… VS ä»£ç 

å¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼Œé‚£ä¹ˆå‰å¾€[https://code.visualstudio.com](https://code.visualstudio.com)å®‰è£… VS ä»£ç ã€‚

> å¦‚æœæ‚¨æƒ³é€šè¿‡æ‰§è¡Œ**ä»£ç **ä»å‘½ä»¤è¡Œå¯åŠ¨ VS ä»£ç ï¼Œå®‰è£… VS ä»£ç åï¼Œåœ¨ Mac ä¸Šä½¿ç”¨ *Shift+Command+p* æˆ–åœ¨ Linux ä¸Šä½¿ç”¨ *Shift+Control+p* æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œå¹¶æœç´¢ *Shell å‘½ä»¤:åœ¨è·¯å¾„é€‰é¡¹ä¸­å®‰è£…â€˜Codeâ€™*å‘½ä»¤ã€‚

## è®¾ç½®ä¸ä»£ç 

Rust å¯¹ VS ä»£ç å®˜æ–¹ç½‘ç«™çš„æ”¯æŒå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°:[https://marketplace.visualstudio.com/items?itemName=rust-lang.rust](https://marketplace.visualstudio.com/items?itemName=rust-lang.rust)

ä¸ºäº†åœ¨ VS ä»£ç ä¸­å¯ç”¨ rust æ”¯æŒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ rust è¯­è¨€æœåŠ¡å™¨(RLS)ã€‚

*   ä½¿ç”¨ *Shift+Command+p* as(æˆ–è€… Linux/Windows ä¸Šçš„ *Control+p* æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œè¾“å…¥`ext install rust-lang.rust`ï¼ŒæŒ‰*è¿›å…¥*ã€‚

å¦‚æœä½ æŒ‰ç…§ä¸Šè¿°æ­¥éª¤å®‰è£… rustï¼Œé‚£ä¹ˆä½ åº”è¯¥å¯ä»¥è®¿é—® cargoï¼ŒRust çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚ä¸ºäº†æ£€æŸ¥å®‰è£…ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹æ‰§è¡Œ*è´§ç‰©ç‰ˆæœ¬*ã€‚

```
â¯ cargo --version
cargo 1.46.0 (149022b1d 2020-07-17)
```

## ä½¿ç”¨ Cargo åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚

ä½¿ç”¨ cargoï¼ŒRust çš„åŒ…ç®¡ç†å™¨ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„ HelloWorld é¡¹ç›®ã€‚

```
â¯ mkdir -p ~/coding/rust
â¯ cd ~/coding/rust
â¯ cargo new HelloWorld
Created binary (application) `HelloWorld` package
```

*   è½¬åˆ°ç›®å½• HelloWorld `cd HelloWorld`
*   é€šè¿‡æ‰§è¡Œ`code .`ä»å‘½ä»¤è¡Œå¯åŠ¨ VS ä»£ç 

åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ° *src* å’Œ *Cargo.toml* æ¡ç›®

æ‰“å¼€ src æ–‡ä»¶å¤¹ä¸‹çš„ rust æ–‡ä»¶ *main.rs* ï¼Œç³»ç»Ÿä¼šæç¤ºæ‚¨å®‰è£… rust extensionâ€”â€”ç‚¹å‡» **Yes** ç»§ç»­ã€‚

å®Œæˆåï¼ŒVS ä»£ç ç°åœ¨åº”è¯¥æ˜¾ç¤ºæ¶ˆæ¯
'**Rust components successfully installed '**

å¦‚æœå®‰è£…æ­£ç¡®ï¼ŒRLS åº”è‡ªåŠ¨åˆ†ææºä»£ç å¹¶æ˜¾ç¤ºä»¥ä¸‹è­¦å‘Šæ¶ˆæ¯:

```
crate `HelloWorld` should have a snake case name
note: `#[warn(non_snake_case)]` on by default
help: convert the identifier to snake case: `hello_world`
```

è¦çº æ­£è¿™ä¸ªé—®é¢˜ï¼Œæ‰“å¼€ *Cargo.toml* å¹¶å°†*åç§°*æ¡ç›®æ”¹ä¸º snake case

```
[package]
name = â€œhello_worldâ€
....
```

è­¦å‘Šç°åœ¨åº”è¯¥ä¼šè‡ªåŠ¨æ¶ˆå¤±ã€‚

ç¼–è¾‘ main.rs æ–‡ä»¶ï¼Œæ·»åŠ è¦åœ¨è¾“å‡ºå­—ç¬¦ä¸²ä¸­æ˜¾ç¤ºçš„å˜é‡ã€‚

```
fn main() {
  let somevalue = 123;
  println!("Hello, world! {}", somevalue);
}
```

# æ„å»ºå’Œæ‰§è¡Œé¡¹ç›®ã€‚

æ ¹æ®æ‚¨çš„å–œå¥½ï¼Œæ‚¨å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæˆ–ä½¿ç”¨ VS ä»£ç çš„ä»»åŠ¡ç‰¹æ€§æ¥æ„å»ºæˆ–æ‰§è¡Œã€‚

## é€šè¿‡å‘½ä»¤è¡Œ

é€šè¿‡èœå•é¡¹â€œç»ˆç«¯â€æˆ–ä½¿ç”¨å¿«æ·é”® *Cntrl+~* æ‰“å¼€ç»ˆç«¯

**æ„å»ºé¡¹ç›®å¹¶åˆ›å»ºäºŒè¿›åˆ¶æ–‡ä»¶**

åœ¨å‘½ä»¤è¡Œä¸­ï¼Œæ‰§è¡Œ:

```
â¯ cargo build
 **Finished** dev [unoptimized + debuginfo] target(s) in 0.02s
```

**æ‰§è¡ŒäºŒè¿›åˆ¶**

```
**â¯** cargo run
**Finished** dev [unoptimized + debuginfo] target(s) in 0.00s
**Running** `target/debug/hello_world`Hello, world! 123
```

## ä½¿ç”¨ä»»åŠ¡

è¦è¿è¡Œ VS ä»£ç ä»»åŠ¡çš„ç‰¹æ€§ï¼Œä½¿ç”¨*å‘½ä»¤+Shift+B* ã€‚

å‚ç…§ https://code.visualstudio.com/docs/editor/tasks#vscode[çš„](https://code.visualstudio.com/docs/editor/tasks#vscode)æ¥è®¾ç½®ä»»åŠ¡åˆ›å»º*ã€‚vscode/tasks.json* æ–‡ä»¶ï¼Œå¹¶ç”¨ä¸‹é¢æä¾›æ„å»ºå’Œè¿è¡Œä»»åŠ¡çš„æ–‡æœ¬å¡«å……ã€‚

```
{
    "version": "2.0.0",
    "tasks": [{
     "label": "cargo build",
     "type": "shell",
     "command": "cargo build",
     "args": [],
     "group": {
       "kind": "build",
       "isDefault": true
     }
    },
    {
        "label": "cargo run",
        "type": "shell",
        "command": "cargo",
        "args": [
          "run"
          // "--release",
          // "--",
          // "arg1"
        ],
        "group": {
          "kind": "build",
          "isDefault": true
        }
       }]
  }
```

# **è°ƒè¯•é¡¹ç›®**

## **å®‰è£…åŠ é•¿ä»¶**

*   å¦‚æœ CodeLLDB(VS ä»£ç çš„ä¸€ä¸ª[æœ¬æœºè°ƒè¯•å™¨æ‰©å±•](https://github.com/vadimcn/vscode-lldb))å°šæœªå®‰è£…ï¼Œåˆ™ä½¿ç”¨ä¸Šè¿° *Command+p* as(æˆ– *Control+p* )é€šè¿‡æ‰“å¼€çš„å‘½ä»¤é¢æ¿å®‰è£…è¯¥æ‰©å±•ï¼Œå¹¶è¾“å…¥
    `ext install vadimcn.vscode-lldb`å’Œ*è¾“å…¥*ã€‚
*   åœ¨ MAC ä¸ŠæŒ‰ä¸‹åŠŸèƒ½ F5 æˆ–é€šè¿‡èœå•ä½¿ç”¨*è¿è¡Œ- >å¼€å§‹è°ƒè¯•*å¹¶é€‰æ‹© **LLDB** é€‰é¡¹ã€‚VS ä»£ç å°†æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ï¼Œè¯´æ˜**æ— æ³•å¼€å§‹è°ƒè¯•ï¼Œå› ä¸ºæ²¡æœ‰æä¾›å¯åŠ¨é…ç½®ã€‚**é€‰æ‹©é»˜è®¤é€‰é¡¹ä»¥ç”Ÿæˆå¯åŠ¨æ–‡ä»¶ã€‚
*   æ‰“å¼€ *src/main.rs* å¹¶å°†æ–­ç‚¹ç½®äºç¬¬ 3 è¡Œ`println!(â€œHello, world!â€)`çš„å·¦ä¾§ï¼ŒæŒ‰ *F5* æˆ–*Run->Start Debugging*å¯åŠ¨è°ƒè¯•å™¨ã€‚

![](img/b079a6d40c860ded429245a9c30ec44a.png)

å›¾ç‰‡ç”± BesterDesigns LLC æä¾›

å°±è¿™æ ·â€”â€”äº«å—å§ï¼