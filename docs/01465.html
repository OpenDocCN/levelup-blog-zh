<html>
<head>
<title>Generate Unique Id in the Browser Without a Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在没有库的浏览器中生成唯一Id</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/generate-unique-id-in-the-browser-without-a-library-50618cdc3cb1?source=collection_archive---------3-----------------------#2020-01-05">https://levelup.gitconnected.com/generate-unique-id-in-the-browser-without-a-library-50618cdc3cb1?source=collection_archive---------3-----------------------#2020-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/edcf2b1b4399ffac6a0621e147547d06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J_nxCJjypvrObv0aDqJXVQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">布雷特·乔丹在Unsplash上拍摄的照片。</figcaption></figure><p id="f717" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每当我需要在客户端使用一个随机的、唯一的值时，我发现自己都在以前的项目中寻找这个函数。您可能没有听说过Web Crypto API，它提供了一组处理加密的底层原语。对于一个相当冷门的API，Web Crypto API在现代浏览器和IE 11中都得到了很好的支持。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="5397" class="lk ll iq lg b gy lm ln l lo lp">// random.ts<br/>function randomId(): string {<br/>  const uint32 = window.crypto.getRandomValues(new Uint32Array(1))[0];<br/>  return uint32.toString(16);<br/>}</span></pre><p id="879f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有多个包可以实现类似的目的，尽管这种特定的浏览器本地解决方案比nanoid、shortid或uuid等包有一些优势。使用原生加密模块不会导致项目中不断增长的依赖项列表。输出也很短，易于阅读。如果您的用户能够看到id，并且您的支持人员可能会要求您提供id(例如订单号)，那么最后一点就变得尤为重要。</p><p id="7e9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要测试Node.js中的randomId，您需要模仿Crypto.getRandomValues。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="bc49" class="lk ll iq lg b gy lm ln l lo lp">// setup.ts<br/>import crypto from "crypto";<br/><br/>function getRandomValuesMock&lt;<br/>  T extends<br/>    | Int8Array<br/>    | Int16Array<br/>    | Int32Array<br/>    | Uint8Array<br/>    | Uint16Array<br/>    | Uint32Array<br/>    | Uint8ClampedArray<br/>    | Float32Array<br/>    | Float64Array<br/>    | DataView<br/>&gt;(array: T) {<br/>  return crypto.randomFillSync(array);<br/>}<br/><br/>global.crypto = { getRandomValues: getRandomValuesMock };</span></pre><p id="4da1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试随机值可能很棘手。在某些用例中，您可能需要确定性的结果，而在其他情况下，您需要在一系列函数调用中传递一个唯一的值。这就是为什么我不会去嘲笑从一开始就产生的价值。</p><h1 id="6bd9" class="lq ll iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">包裹</h1><p id="207e" class="pw-post-body-paragraph kd ke iq kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">我希望这篇文章对你有用，并让你的用户下载更多的字节。请记住，尽管getRandomValues提供了加密安全的随机值，但它仍然是客户端的，您不应该在安全关键的用例中依赖它。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/01451ebd589f1106fe8ec218ba83ac1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bHXw81011BGR7FojmXFQ5Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://michalzalecki.com/ebooks/mastering-jest-tips-tricks-for-javascript-developers.html" rel="noopener ugc nofollow" target="_blank">现在只需9美元就能买到！</a></figcaption></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="5c25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">【https://michalzalecki.com】最初发表于<a class="ae kc" href="https://michalzalecki.com/generate-unique-id-in-the-browser-without-a-library/" rel="noopener ugc nofollow" target="_blank"><em class="na"/></a><em class="na">。</em></p></div></div>    
</body>
</html>