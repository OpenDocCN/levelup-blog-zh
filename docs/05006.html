<html>
<head>
<title>Build a Full Stack App using GraphQL as Backend API (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GraphQL作为后端API构建一个全栈应用程序(第3部分)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-a-full-stack-app-using-graphql-as-backend-api-part-3-4af6489112e0?source=collection_archive---------10-----------------------#2020-07-29">https://levelup.gitconnected.com/build-a-full-stack-app-using-graphql-as-backend-api-part-3-4af6489112e0?source=collection_archive---------10-----------------------#2020-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e912" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用MongoDB + GraphQL + React + Node.js栈构建App。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4a2893bc2e0a926b1b3633587c885821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JhwpsrhVeiP0N3ET"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">由<a class="ae lb" href="https://unsplash.com/@goumbik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢卡斯·布拉塞克</a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="5d31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是使用GraphQL API构建全栈应用程序系列的最后一部分。如果你错过了第一部<a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/learn-the-basics-of-graphql-4740d76d5e8a?source=friends_link&amp;sk=e9880f30dcce3dcaf2d555ecfc5d5e11">这里</a>和第二部<a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/part-2-build-a-full-stack-app-using-graphql-as-backend-api-a1231753cdd4?source=friends_link&amp;sk=72994322563130fc174b05b55020b33c">这里</a>看看吧。</p><p id="cdcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在最后一部分中，我们已经创建了所有需要的GraphQL APIs。在本文中，我们将创建一个React应用程序来使用这些GraphQL APIs。</p><h2 id="f37a" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">我们开始吧</h2><p id="4e5c" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在这里从<a class="ae lb" href="https://github.com/myogeshchavan97/graphql-fullstack-app/tree/part2_full_stack_app" rel="noopener ugc nofollow" target="_blank">克隆前一篇文章的存储库代码</a></p><p id="b5c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">切换到代码分支</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="7232" class="lc ld iq mb b gy mf mg l mh mi">git checkout part2_full_stack_app</span></pre><p id="05c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过执行以下命令，创建并切换到新的git分支</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="231e" class="lc ld iq mb b gy mf mg l mh mi">git checkout -b part3_full_stack_app</span></pre><p id="3a2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从主项目文件夹(<code class="fe mj mk ml mb b">graphql-fullstack-app</code>文件夹)执行以下命令</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="60a2" class="lc ld iq mb b gy mf mg l mh mi">create-react-app client</span></pre><p id="12e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在项目中有两个文件夹，<code class="fe mj mk ml mb b">server</code>和<code class="fe mj mk ml mb b">client</code>。</p><p id="7961" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">删除<code class="fe mj mk ml mb b">client/src</code>文件夹中的所有文件，在<code class="fe mj mk ml mb b">src</code>文件夹中创建<code class="fe mj mk ml mb b">index.js</code>和<code class="fe mj mk ml mb b">styles.scss</code>文件。另外，在<code class="fe mj mk ml mb b">src</code>文件夹中创建<code class="fe mj mk ml mb b">actions</code>、<code class="fe mj mk ml mb b">components</code>、<code class="fe mj mk ml mb b">reducers</code>、<code class="fe mj mk ml mb b">router</code>、<code class="fe mj mk ml mb b">store</code>和<code class="fe mj mk ml mb b">utils</code>文件夹。</p><p id="c4ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从客户端文件夹安装必要的依赖项</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="3ce0" class="lc ld iq mb b gy mf mg l mh mi">yarn add axios@0.19.2 bootstrap@4.5.0 graphql@15.3.0 lodash@4.17.19 moment@2.27.0 node-sass@4.14.1 react-bootstrap@1.2.2 react-modal@3.11.2 react-redux@7.2.0 react-router-dom@5.2.0 redux@4.0.5 redux-thunk@2.3.0 apollo-boost@0.4.9</span></pre><p id="d48f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe mj mk ml mb b">styles.scss</code>文件，从<a class="ae lb" href="https://github.com/myogeshchavan97/graphql-fullstack-app/tree/part3_full_stack_app/client/src/styles.scss" rel="noopener ugc nofollow" target="_blank">这里添加内容到</a>里面。</p><p id="236b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">utils</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">constants.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="e10c" class="lc ld iq mb b gy mf mg l mh mi">export const API_URL = 'http://localhost:4000/graphql';<br/>export const GET_ERROR = 'GET_ERROR';<br/>export const CLEAR_ERROR = 'CLEAR_ERROR';<br/>export const GET_PRODUCTS = 'GET_PRODUCTS';<br/>export const ADD_PRODUCT = 'ADD_PRODUCT';<br/>export const EDIT_PRODUCT = 'EDIT_PRODUCT';<br/>export const DELETE_PRODUCT = 'DELETE_PRODUCT';<br/>export const ADD_REVIEW = 'ADD_REVIEW';<br/>export const GET_REVIEWS = 'GET_REVIEWS';<br/>export const DELETE_REVIEW = 'DELETE_REVIEW';<br/>export const CLEAR_REVIEWS = 'CLEAR_REVIEWS';</span></pre><p id="4c4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">src/reducers</code>文件夹中新建一个文件<code class="fe mj mk ml mb b">error.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="769e" class="lc ld iq mb b gy mf mg l mh mi">import { GET_ERROR, CLEAR_ERROR } from '../utils/constants';</span><span id="e003" class="lc ld iq mb b gy mm mg l mh mi">const errorReducer = (state = '', action) =&gt; {<br/>  switch (action.type) {<br/>    case GET_ERROR:<br/>      return action.error;<br/>    case CLEAR_ERROR:<br/>      return '';<br/>    default:<br/>      return state;<br/>  }<br/>};</span><span id="88d3" class="lc ld iq mb b gy mm mg l mh mi">export default errorReducer;</span></pre><p id="97e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，我们正在设置和清除redux存储中的错误，该错误来自我们在上一部分中创建的GraphQL APIs。</p><p id="fcc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">src/reducers</code>文件夹下创建一个新文件<code class="fe mj mk ml mb b">products.js</code>，内容如下</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="7051" class="lc ld iq mb b gy mf mg l mh mi">import {<br/>  GET_PRODUCTS,<br/>  ADD_PRODUCT,<br/>  EDIT_PRODUCT,<br/>  DELETE_PRODUCT<br/>} from '../utils/constants';</span><span id="ccac" class="lc ld iq mb b gy mm mg l mh mi">const productsReducer = (state = [], action) =&gt; {<br/>  switch (action.type) {<br/>    case GET_PRODUCTS:<br/>      return action.products;<br/>    case ADD_PRODUCT:<br/>      return [...state, action.product];<br/>    case EDIT_PRODUCT:<br/>      return state.map((product) =&gt; {<br/>        if (product.skuId === action.product.skuId) {<br/>          return {<br/>            ...product,<br/>            ...action.product<br/>          };<br/>        } else {<br/>          return product;<br/>        }<br/>      });<br/>    case DELETE_PRODUCT:<br/>      return state.filter((product) =&gt; product.skuId !== action.product.skuId);<br/>    default:<br/>      return state;<br/>  }<br/>};</span><span id="4628" class="lc ld iq mb b gy mm mg l mh mi">export default productsReducer;</span></pre><p id="cfc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，对于<code class="fe mj mk ml mb b">GET_PRODUCTS</code>开关案例，我们将从商店退回所有产品。</p><p id="5b17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<code class="fe mj mk ml mb b">ADD_PRODUCT</code>开关的情况，我们展开状态对象，它是一个<code class="fe mj mk ml mb b">products</code>对象的数组，然后使用<code class="fe mj mk ml mb b">[...state, action.product]</code>在末尾添加一个新产品。</p><p id="b9ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<code class="fe mj mk ml mb b">EDIT_PRODUCT</code>开关的情况，我们使用一个数组<code class="fe mj mk ml mb b">map</code>方法，并从products数组中找到其<code class="fe mj mk ml mb b">skuId</code>与传递的<code class="fe mj mk ml mb b">skuId</code>匹配的元素，如果匹配，我们将展开两个对象的属性以合并它们。如果没有匹配，那么我们只是返回来自<code class="fe mj mk ml mb b">map</code>方法的原始产品，而不做任何更改。</p><p id="9e6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其工作原理是，当我们扩展对象属性时，新属性将覆盖旧属性，未更改的属性将保持原样。</p><p id="5f5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，考虑下面的代码，其中我们只覆盖了<code class="fe mj mk ml mb b">name</code>、<code class="fe mj mk ml mb b">description</code>和<code class="fe mj mk ml mb b">price</code>字段。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="4ad3" class="lc ld iq mb b gy mf mg l mh mi">const products = [<br/>  {<br/>    skuId: '1234',<br/>    name: 'Shoes',<br/>    description: 'Nice Shoes',<br/>    price: 3900,<br/>    updatedAt: '1595847215961'<br/>  }<br/>];</span><span id="a929" class="lc ld iq mb b gy mm mg l mh mi">const action = {<br/>  product: {<br/>    name: 'Shoes!',<br/>    description: 'Nice Shoes!',<br/>    price: 3900<br/>  }<br/>};</span><span id="29ad" class="lc ld iq mb b gy mm mg l mh mi">console.log({ ...products[0], ...action.product });</span><span id="861c" class="lc ld iq mb b gy mm mg l mh mi">/* output</span><span id="67bb" class="lc ld iq mb b gy mm mg l mh mi">{<br/>  skuId: '1234',<br/>  name: 'Shoes!',<br/>  description: 'Nice Shoes!',<br/>  price: 3900,<br/>  updatedAt: '1595847215961'<br/>}</span><span id="24c2" class="lc ld iq mb b gy mm mg l mh mi">*/</span></pre><p id="b8da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要了解更多关于析构的知识，请查看我以前的文章<a class="ae lb" href="https://medium.com/javascript-in-plain-english/what-is-so-special-about-es6-destructuring-6be45fbec52c" rel="noopener">这里</a></p><p id="4270" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<code class="fe mj mk ml mb b">DELETE_PRODUCT</code>开关的情况，我们使用数组<code class="fe mj mk ml mb b">filter</code>的方法移除带有匹配<code class="fe mj mk ml mb b">skuId</code>的产品。</p><p id="fadd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要了解更多关于最有用的数组方法，请查看这篇文章。</p><p id="4341" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">src/reducers</code>文件夹中新建一个文件<code class="fe mj mk ml mb b">reviews.js</code>，内容如下</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="0d29" class="lc ld iq mb b gy mf mg l mh mi">import {<br/>  ADD_REVIEW,<br/>  GET_REVIEWS,<br/>  DELETE_REVIEW,<br/>  CLEAR_REVIEWS<br/>} from '../utils/constants';</span><span id="b6a2" class="lc ld iq mb b gy mm mg l mh mi">const reviewsReducer = (state = {}, action) =&gt; {<br/>  switch (action.type) {<br/>    case ADD_REVIEW:<br/>      const { skuId, review } = action;<br/>      return { skuId, list: [review, ...state.list] };<br/>    case GET_REVIEWS: {<br/>      const { skuId, reviews } = action;<br/>      return { skuId, list: reviews };<br/>    }<br/>    case DELETE_REVIEW:<br/>      return {<br/>        skuId: state.skuId,<br/>        list: state.list.filter((review) =&gt; review._id !== action.reviewId)<br/>      };<br/>    case CLEAR_REVIEWS:<br/>      return {};<br/>    default:<br/>      return state;<br/>  }<br/>};</span><span id="9209" class="lc ld iq mb b gy mm mg l mh mi">export default reviewsReducer;</span></pre><p id="ae18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，对于<code class="fe mj mk ml mb b">ADD_REVIEW</code> switch案例，我们在评论列表中添加了一个新的评论。<code class="fe mj mk ml mb b">reviews</code>状态是一个具有以下格式的对象</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="747a" class="lc ld iq mb b gy mf mg l mh mi">{<br/>  skuId: product_sku_id,<br/>  list: array_of_reviews<br/>}</span></pre><p id="93f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们将新的评论添加到列表的开头，这样我们可以在顶部显示最新添加的评论。所以我们首先将评论添加到开头，然后从<code class="fe mj mk ml mb b">list</code>开始传播已经添加的评论，就像这样<code class="fe mj mk ml mb b">{list: [review, ...state.list]}</code></p><p id="8011" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<code class="fe mj mk ml mb b">GET_REVIEWS</code>开关的情况，我们只是返回<code class="fe mj mk ml mb b">reviews</code>状态对象。</p><p id="ba64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，我们在<code class="fe mj mk ml mb b">GET_REVIEWS</code>的开关案例中添加了花括号，因为我们已经在第一个开关案例中将<code class="fe mj mk ml mb b">skuId</code>声明为常量，所以我们不能在相同的范围内创建另一个同名的常量，所以我们使用花括号为<code class="fe mj mk ml mb b">GET_REVIEWS</code>开关案例创建了一个新的块。</p><p id="8b88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<code class="fe mj mk ml mb b">DELETE_REVIEW</code>切换情况，我们只是从列表中删除匹配的评论。</p><p id="1011" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于<code class="fe mj mk ml mb b">CLEAR_REVIEWS</code> switch案例，我们返回空对象，因此所有评论都将从redux store中删除。</p><p id="b186" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">src/store</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">store.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="4f84" class="lc ld iq mb b gy mf mg l mh mi">import { createStore, combineReducers, applyMiddleware, compose } from 'redux';<br/>import productsReducer from '../reducers/products';<br/>import reviewsReducer from '../reducers/reviews';<br/>import errorReducer from '../reducers/error';<br/>import thunk from 'redux-thunk';</span><span id="644c" class="lc ld iq mb b gy mm mg l mh mi">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;<br/>const store = createStore(<br/>  combineReducers({<br/>    products: productsReducer,<br/>    reviews: reviewsReducer,<br/>    error: errorReducer<br/>  }),<br/>  composeEnhancers(applyMiddleware(thunk))<br/>);</span><span id="af23" class="lc ld iq mb b gy mm mg l mh mi">export default store;</span></pre><p id="31f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，我们通过调用<code class="fe mj mk ml mb b">createStore</code>函数并提供所有的redux来创建一个redux存储。我们还添加了<code class="fe mj mk ml mb b">thunk</code>中间件，这样我们就可以在使用redux时发出异步API请求。</p><p id="891e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看我以前的文章<a class="ae lb" href="https://medium.com/javascript-in-plain-english/how-to-integrate-redux-thunk-into-your-react-application-cd92b87c1629" rel="noopener">这里</a>了解如何将<code class="fe mj mk ml mb b">redux-thunk</code>集成到React应用程序中，以及如何配置redux devtool以查看实时调度的操作。</p><p id="ef31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">actions</code>文件夹中创建一个新文件<code class="fe mj mk ml mb b">error.js</code>,内容如下</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="21ae" class="lc ld iq mb b gy mf mg l mh mi">import { GET_ERROR, CLEAR_ERROR } from '../utils/constants';</span><span id="a850" class="lc ld iq mb b gy mm mg l mh mi">export const getError = (error) =&gt; ({<br/>  type: GET_ERROR,<br/>  error<br/>});</span><span id="15e4" class="lc ld iq mb b gy mm mg l mh mi">export const clearError = () =&gt; ({<br/>  type: CLEAR_ERROR<br/>});</span></pre><p id="c596" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们添加了action creator函数，用于从redux存储中获取和清除错误消息。</p><p id="b733" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">utils</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">queries.js</code>，并在其中添加以下内容。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="f26e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">utils</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">client.js</code>，并在其中添加以下内容</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="2452" class="lc ld iq mb b gy mf mg l mh mi">import ApolloClient from 'apollo-boost';<br/>import { API_URL } from './constants';<br/>import { getError } from '../actions/error';</span><span id="be0f" class="lc ld iq mb b gy mm mg l mh mi">export const getClient = (dispatch) =&gt; {<br/>  const client = new ApolloClient({<br/>    uri: API_URL,<br/>    onError({ graphQLErrors, networkError }) {<br/>      if (graphQLErrors) {<br/>        const [error] = graphQLErrors;<br/>        dispatch(getError(error.message));<br/>      } else if (networkError) {<br/>        dispatch(getError('Network error. Error connecting to the server.'));<br/>      }<br/>    }<br/>  });</span><span id="fb67" class="lc ld iq mb b gy mm mg l mh mi">return client;<br/>};</span></pre><p id="e4fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">actions</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">products.js</code>，将<a class="ae lb" href="https://github.com/myogeshchavan97/graphql-fullstack-app/tree/part3_full_stack_app/client/src/actions/products.js" rel="noopener ugc nofollow" target="_blank">中的内容添加到</a>文件夹中。</p><p id="31c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，最初，我们有一些简单的动作生成器函数。</p><p id="7200" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在<code class="fe mj mk ml mb b">initiateGetProducts</code>函数中，我们首先从<code class="fe mj mk ml mb b">utils/client.js</code>调用<code class="fe mj mk ml mb b">getClient</code>方法，在这里我们创建了一个<code class="fe mj mk ml mb b">ApolloClient</code>对象，使用它我们可以向我们的后端GraphQL APIs发送请求。对于ApolloClient构造函数，我们正在传递GraphQL端点<code class="fe mj mk ml mb b">http://localhost:4000/graphql</code>，它对于我们所有的API调用都是相同的。</p><p id="3724" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们添加了<code class="fe mj mk ml mb b">onError</code>错误处理程序。如果GraphQL APIs抛出任何错误，那么它将出现在我们正在解构的<code class="fe mj mk ml mb b">graphQLErrors</code>数组中。如果连接到我们的GraphQL API有问题，那么我们将在<code class="fe mj mk ml mb b">networkError</code>参数中得到那个错误。</p><p id="4196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当<code class="fe mj mk ml mb b">graphQLErrors</code>或<code class="fe mj mk ml mb b">networkError</code>发生时，我们调用<code class="fe mj mk ml mb b">getError</code>动作生成器函数，通过调用<code class="fe mj mk ml mb b">dispatch(getError(error.message));</code>将错误添加到redux存储中</p><p id="7f02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们从<code class="fe mj mk ml mb b">getClient</code>函数中返回<code class="fe mj mk ml mb b">ApolloClient</code>对象。</p><p id="1c18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我们使用来自<code class="fe mj mk ml mb b">actions/products.js</code>文件的<code class="fe mj mk ml mb b">initiateGetProducts</code>函数中的<code class="fe mj mk ml mb b">client.query</code>函数对GraphQL服务器进行查询，并传递在<code class="fe mj mk ml mb b">utils/queries.js</code>文件中定义的<code class="fe mj mk ml mb b">GET_PRODUCTS_QUERY</code>。</p><p id="bec8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，我们编写的查询与我们在GraphQL Playground中编写的完全相同</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="4329" class="lc ld iq mb b gy mf mg l mh mi">export const GET_PRODUCTS_QUERY = gql`<br/>  query {<br/>    products {<br/>      skuId<br/>      name<br/>      description<br/>      price<br/>      updatedAt<br/>    }<br/>  }<br/>`;</span></pre><p id="ef6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用来自<code class="fe mj mk ml mb b"> apollo-boost</code>库的<code class="fe mj mk ml mb b">gql</code>来处理查询。</p><p id="7372" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mj mk ml mb b">apollo-boost</code>是一种使用apollo客户端的零配置方式，也是使用apollo客户端库的首选方式。</p><p id="3699" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我们将<code class="fe mj mk ml mb b">.then</code>处理程序添加到<code class="fe mj mk ml mb b">client.query</code>方法中，以获得来自API的响应。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="a082" class="lc ld iq mb b gy mf mg l mh mi">.then((response) =&gt; {<br/>  if (response) {<br/>    dispatch(clearError());<br/>    return dispatch(getProducts(response.data.products));<br/>  }<br/>})</span></pre><p id="dcea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们通过调度<code class="fe mj mk ml mb b">getProducts</code>动作生成器函数将产品添加到redux存储中，否则我们通过调度<code class="fe mj mk ml mb b">getError</code>动作生成器函数将错误消息添加到<code class="fe mj mk ml mb b">.catch</code>处理程序中的redux存储中。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="e683" class="lc ld iq mb b gy mf mg l mh mi">.catch(<br/>  (error) =&gt; error.response &amp;&amp; dispatch(getError(error.response.data))<br/>);</span></pre><p id="8018" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，在<code class="fe mj mk ml mb b">initiateAddProduct</code>函数中，我们让GraphQL API调用添加新产品。它与<code class="fe mj mk ml mb b">initiateGetProducts</code>相同，除了我们在这里通过发送<code class="fe mj mk ml mb b">query</code>和<code class="fe mj mk ml mb b">variables</code>而不是<code class="fe mj mk ml mb b">client.query</code>来调用<code class="fe mj mk ml mb b">client.mutate</code>。</p><p id="4679" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你检查一下<code class="fe mj mk ml mb b">ADD_PRODUCT_QUERY</code>，你会发现它与我们在GraphQL playground中使用的查询略有不同。</p><p id="378e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在GraphQL playground中使用的查询如下所示</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="9fdb" class="lc ld iq mb b gy mf mg l mh mi">mutation {<br/>  addProduct(<br/>    skuId: "1234",<br/>    data: {<br/>      name: "Shoes", description: "Nice Shoes",<br/>      price: 3900<br/>    }) {<br/>    skuId<br/>    name<br/>    description<br/>    price<br/>    updatedAt<br/>  }<br/>}</span></pre><p id="c7fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我们需要传递用户在表单中输入的动态数据，我们稍后会创建这个表单，所以我们在这里使用的查询是这样的</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="cf5f" class="lc ld iq mb b gy mf mg l mh mi">export const ADD_PRODUCT_QUERY = gql`<br/>  mutation($skuId: ID!, $name: String!, $description: String!, $price: Float!) {<br/>    addProduct(<br/>      skuId: $skuId<br/>      data: {<br/>          name: $name, description: $description, <br/>          price: $price<br/>      }) {<br/>      skuId<br/>      name<br/>      description<br/>      price<br/>      updatedAt<br/>    }<br/>  }<br/>`;</span></pre><p id="ad5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，变量是使用<code class="fe mj mk ml mb b">$</code>符号声明的，它们的确切类型在突变后被提及，然后在实际的突变中，我们使用这些变量来传递动态数据。这是将动态数据传递给突变的标准方式。</p><p id="de64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在<code class="fe mj mk ml mb b">initiateEditProduct</code>和<code class="fe mj mk ml mb b">initiateDeleteProduct</code>函数内部，我们做的和<code class="fe mj mk ml mb b">initiateAddProduct</code>一样，只是变异查询不同。</p><p id="4267" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">actions</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">reviews.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="390c" class="lc ld iq mb b gy mf mg l mh mi">import {<br/>  ADD_REVIEW,<br/>  GET_REVIEWS,<br/>  DELETE_REVIEW,<br/>  CLEAR_REVIEWS<br/>} from '../utils/constants';<br/>import {<br/>  GET_REVIEWS_QUERY,<br/>  ADD_REVIEW_QUERY,<br/>  DELETE_REVIEW_QUERY<br/>} from '../utils/queries';<br/>import { getClient } from '../utils/common';<br/>import { getError, clearError } from './error';</span><span id="01a5" class="lc ld iq mb b gy mm mg l mh mi">export const addReview = (skuId, review) =&gt; {<br/>  return {<br/>    type: ADD_REVIEW,<br/>    skuId,<br/>    review<br/>  };<br/>};</span><span id="d3d8" class="lc ld iq mb b gy mm mg l mh mi">export const getReviews = ({ skuId, reviews }) =&gt; {<br/>  return {<br/>    type: GET_REVIEWS,<br/>    skuId,<br/>    reviews<br/>  };<br/>};</span><span id="bf0c" class="lc ld iq mb b gy mm mg l mh mi">export const deleteReview = (reviewId) =&gt; {<br/>  return {<br/>    type: DELETE_REVIEW,<br/>    reviewId<br/>  };<br/>};</span><span id="57ee" class="lc ld iq mb b gy mm mg l mh mi">export const clearReviews = () =&gt; {<br/>  return {<br/>    type: CLEAR_REVIEWS<br/>  };<br/>};</span><span id="0b1b" class="lc ld iq mb b gy mm mg l mh mi">export const initiateGetReviews = (skuId) =&gt; {<br/>  return (dispatch) =&gt; {<br/>    const client = getClient(dispatch);</span><span id="2fed" class="lc ld iq mb b gy mm mg l mh mi">    const variables = {<br/>      skuId<br/>    };</span><span id="2402" class="lc ld iq mb b gy mm mg l mh mi">    return client<br/>      .query({<br/>        query: GET_REVIEWS_QUERY,<br/>        variables<br/>      })<br/>      .then((response) =&gt; {<br/>        if (response) {<br/>          dispatch(clearError());<br/>          return dispatch(<br/>            getReviews({<br/>              skuId,<br/>              reviews: response.data.reviews<br/>            })<br/>          );<br/>        }<br/>      })<br/>      .catch(<br/>        (error) =&gt; error.response &amp;&amp; dispatch(getError(error.response.data))<br/>      );<br/>  };<br/>};</span><span id="9108" class="lc ld iq mb b gy mm mg l mh mi">export const initiateAddReview = (skuId, review) =&gt; {<br/>  return (dispatch) =&gt; {<br/>    const { title, comment } = review;</span><span id="da4d" class="lc ld iq mb b gy mm mg l mh mi">    const client = getClient(dispatch);</span><span id="647b" class="lc ld iq mb b gy mm mg l mh mi">    const variables = {<br/>      skuId,<br/>      title,<br/>      comment<br/>    };</span><span id="5c30" class="lc ld iq mb b gy mm mg l mh mi">    return client<br/>      .mutate({<br/>        mutation: ADD_REVIEW_QUERY,<br/>        variables<br/>      })<br/>      .then((response) =&gt; {<br/>        if (response) {<br/>          dispatch(clearError());<br/>          dispatch(addReview(skuId, response.data.addReview));<br/>        }<br/>      })<br/>      .catch(<br/>        (error) =&gt; error.response &amp;&amp; dispatch(getError(error.response.data))<br/>      );<br/>  };<br/>};</span><span id="5e8d" class="lc ld iq mb b gy mm mg l mh mi">export const initiateDeleteReview = (reviewId) =&gt; {<br/>  return (dispatch) =&gt; {<br/>    const client = getClient(dispatch);</span><span id="a316" class="lc ld iq mb b gy mm mg l mh mi">    const variables = {<br/>      reviewId<br/>    };</span><span id="5079" class="lc ld iq mb b gy mm mg l mh mi">    return client<br/>      .mutate({<br/>        mutation: DELETE_REVIEW_QUERY,<br/>        variables<br/>      })<br/>      .then((response) =&gt; {<br/>        if (response &amp;&amp; response.data.deleteReview) {<br/>          dispatch(clearError());<br/>          return dispatch(deleteReview(reviewId));<br/>        }<br/>      })<br/>      .catch(<br/>        (error) =&gt; error.response &amp;&amp; dispatch(getError(error.response.data))<br/>      );<br/>  };<br/>};</span></pre><p id="6277" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个文件中的代码与<code class="fe mj mk ml mb b">products.js</code>文件非常相似，唯一的区别是使用的查询。</p><p id="f8be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹中新建一个文件<code class="fe mj mk ml mb b">Header.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="6660" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { Link } from 'react-router-dom';</span><span id="d036" class="lc ld iq mb b gy mm mg l mh mi">const Header = () =&gt; {<br/>  return (<br/>    &lt;div className="header"&gt;<br/>      &lt;h1 className="title"&gt;<br/>        &lt;Link to="/"&gt;Graphql App&lt;/Link&gt;<br/>      &lt;/h1&gt;<br/>      &lt;div className="links"&gt;<br/>        &lt;Link to="/add"&gt;Add Product&lt;/Link&gt;<br/>        &lt;Link to="/"&gt;Products List&lt;/Link&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span><span id="5947" class="lc ld iq mb b gy mm mg l mh mi">export default Header;</span></pre><p id="5f56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">Layout.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="fed5" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';</span><span id="768d" class="lc ld iq mb b gy mm mg l mh mi">const Layout = (props) =&gt; {<br/>  return &lt;div className="layout container"&gt;{props.children}&lt;/div&gt;;<br/>};</span><span id="b738" class="lc ld iq mb b gy mm mg l mh mi">export default Layout;</span></pre><p id="83d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">ProductsList.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="ed6a" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { connect } from 'react-redux';<br/>import _ from 'lodash';<br/>import {<br/>  initiateGetProducts,<br/>  initiateDeleteProduct<br/>} from '../actions/products';<br/>import Product from './Product';<br/>import Layout from './Layout';</span><span id="2268" class="lc ld iq mb b gy mm mg l mh mi">class ProductsList extends React.Component {<br/>  state = {<br/>    products: [],<br/>    errorMsg: '',<br/>    isLoading: false<br/>  };</span><span id="5d94" class="lc ld iq mb b gy mm mg l mh mi">componentDidMount() {<br/>    this.setState({ isLoading: true });<br/>    this.props.dispatch(initiateGetProducts()).then(() =&gt; {<br/>      this.setState({<br/>        products: this.props.products,<br/>        isLoading: false<br/>      });<br/>    });<br/>  }</span><span id="7a0a" class="lc ld iq mb b gy mm mg l mh mi">componentDidUpdate(prevProps, prevState) {<br/>    if (prevProps.products.length !== this.props.products.length) {<br/>      this.setState({ products: this.props.products });<br/>    }<br/>    if (prevProps.error !== this.props.error) {<br/>      this.setState({ errorMsg: this.props.error });<br/>    }<br/>  }</span><span id="72e2" class="lc ld iq mb b gy mm mg l mh mi">handleActionBtnClick = (type, skuId, name) =&gt; {<br/>    if (type === 'edit') {<br/>      // TODO: add code for edit<br/>    } else if (type === 'view') {<br/>      // TODO: add code for view<br/>    } else if (type === 'delete') {<br/>      const shouldDelete = window.confirm(<br/>        `Are you sure you want to delete product with name ${name}?`<br/>      );<br/>      if (shouldDelete) {<br/>        this.setState({ errorMsg: '' });<br/>        this.props.dispatch(initiateDeleteProduct(skuId));<br/>      }<br/>    }<br/>  };</span><span id="4611" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const { products, errorMsg, isLoading } = this.state;</span><span id="7d47" class="lc ld iq mb b gy mm mg l mh mi">const propsToPass = {<br/>      handleActionBtnClick: this.handleActionBtnClick<br/>    };</span><span id="377b" class="lc ld iq mb b gy mm mg l mh mi">return (<br/>      &lt;Layout&gt;<br/>        {errorMsg !== '' &amp;&amp; &lt;p className="errorMsg"&gt;{errorMsg}&lt;/p&gt;}<br/>        {isLoading ? (<br/>          &lt;p className="loading"&gt;Loading...&lt;/p&gt;<br/>        ) : (<br/>          &lt;React.Fragment&gt;<br/>            {!_.isEmpty(products) ? (<br/>              products.map((product, index) =&gt; {<br/>                return (<br/>                  &lt;React.Fragment key={product.skuId}&gt;<br/>                    {index === 0 ? (<br/>                      &lt;React.Fragment&gt;<br/>                        &lt;div className="product product-header"&gt;<br/>                          &lt;div className="name"&gt;Product Name&lt;/div&gt;<br/>                          &lt;div className="description"&gt;Description&lt;/div&gt;<br/>                          &lt;div&gt;Price&lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                        &lt;Product {...product} {...propsToPass} /&gt;<br/>                      &lt;/React.Fragment&gt;<br/>                    ) : (<br/>                      &lt;Product {...product} {...propsToPass} /&gt;<br/>                    )}<br/>                  &lt;/React.Fragment&gt;<br/>                );<br/>              })<br/>            ) : (<br/>              &lt;p className="no-result"&gt;<br/>                No products found. Please add some products.<br/>              &lt;/p&gt;<br/>            )}<br/>          &lt;/React.Fragment&gt;<br/>        )}<br/>      &lt;/Layout&gt;<br/>    );<br/>  }<br/>}</span><span id="42dd" class="lc ld iq mb b gy mm mg l mh mi">const mapStateToProps = (state) =&gt; {<br/>  return {<br/>    products: state.products,<br/>    error: state.error<br/>  };<br/>};</span><span id="3c36" class="lc ld iq mb b gy mm mg l mh mi">export default connect(mapStateToProps)(ProductsList);</span></pre><p id="d687" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，我们在状态中添加了<code class="fe mj mk ml mb b">products</code>数组来存储来自redux商店的产品列表。另外，<code class="fe mj mk ml mb b">errorMsg</code>显示错误信息，<code class="fe mj mk ml mb b">isLoading</code>显示API调用时的加载信息。</p><p id="2357" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">componentDidMount</code>方法中，我们使用GraphQL API调用<code class="fe mj mk ml mb b">initiateGetProducts</code>函数从MongoDB数据库中获取产品列表。在发送请求之前，我们将<code class="fe mj mk ml mb b">isLoading</code>设置为<code class="fe mj mk ml mb b">true</code>，一旦请求完成，我们将设置<code class="fe mj mk ml mb b">products</code>数组并将<code class="fe mj mk ml mb b">isLoading</code>设置为<code class="fe mj mk ml mb b">false</code>。</p><p id="7835" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原因是，我们能够将<code class="fe mj mk ml mb b">.then</code>处理程序添加到调度调用中，因为我们对<code class="fe mj mk ml mb b">initiateGetProducts</code>函数使用了承诺链，我们已经添加了<code class="fe mj mk ml mb b">return client</code>语句，并且在<code class="fe mj mk ml mb b">.then</code>处理程序中，我们正在返回被调度的动作。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="a33f" class="lc ld iq mb b gy mf mg l mh mi">// inside initiateGetProducts function from actions/products.js</span><span id="ff1b" class="lc ld iq mb b gy mm mg l mh mi">.then((response) =&gt; {<br/>  if (response) {<br/>    dispatch(clearError());<br/>    return dispatch(getProducts(response.data.products));<br/>  }<br/>})</span></pre><p id="67fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原因是，我们能够在像<code class="fe mj mk ml mb b">this.props.dispatch(initiateGetProducts())</code>一样的<code class="fe mj mk ml mb b">ProductsList.js</code>组件中的<code class="fe mj mk ml mb b">props</code>对象上调用<code class="fe mj mk ml mb b">initiateGetProducts</code>函数是因为我们已经使用文件末尾的下面一行将<code class="fe mj mk ml mb b">ProductsList</code>组件连接到redux store</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="56f3" class="lc ld iq mb b gy mf mg l mh mi">export default connect(mapStateToProps)(ProductsList);</span></pre><p id="e89f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此我们可以访问<code class="fe mj mk ml mb b">ProductsList</code>组件中的<code class="fe mj mk ml mb b">dispatch</code>。</p><p id="e628" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在<code class="fe mj mk ml mb b">componentDidUpdate</code>方法中，我们从redux store中获取产品和错误消息的更新数据，并将其设置为state。</p><p id="c707" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mj mk ml mb b">products</code>和<code class="fe mj mk ml mb b">error</code>在<code class="fe mj mk ml mb b">this.props</code>上可用，因为我们在文件末尾添加了<code class="fe mj mk ml mb b">mapStateToProps</code>方法，在<code class="fe mj mk ml mb b">componentDidUpdate</code>中添加产品和错误检查的原因是当使用删除按钮点击删除产品时，获取更新的redux store数据以刷新列表。</p><p id="8258" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在render方法中，我们根据状态值显示<code class="fe mj mk ml mb b">error</code>消息和<code class="fe mj mk ml mb b">loading</code>消息，并遍历<code class="fe mj mk ml mb b">products</code>数组，我们将道具传递给<code class="fe mj mk ml mb b">Product</code>组件来显示数据。</p><p id="9ecc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经使用<code class="fe mj mk ml mb b">propsToPass</code>对象来存储所需的道具，因为稍后我们将有更多的道具传递给<code class="fe mj mk ml mb b">Product</code>组件，因此为了避免代码重复，我们将其存储在变量中，并使用spread操作符来传递这些道具。</p><p id="46ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">handleActionBtnClick</code>事件处理函数中，我们调用<code class="fe mj mk ml mb b">initiateDeleteProduct</code>函数从MongoDB数据库中删除产品。</p><p id="ceeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">Product.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="925a" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { Button } from 'react-bootstrap';</span><span id="6b91" class="lc ld iq mb b gy mm mg l mh mi">const Product = (props) =&gt; {<br/>  const { name, skuId, description, price, handleActionBtnClick } = props;<br/>  return (<br/>    &lt;React.Fragment&gt;<br/>      &lt;div className="product-item"&gt;<br/>        &lt;div className="product" data-skuid={skuId}&gt;<br/>          &lt;div className="name"&gt;{name}&lt;/div&gt;<br/>          &lt;div className="description"&gt;{description}&lt;/div&gt;<br/>          &lt;div&gt;{price}&lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;div className="buttons"&gt;<br/>          &lt;div className="btn"&gt;<br/>            &lt;Button<br/>              variant="info"<br/>              type="submit"<br/>              size="sm"<br/>              onClick={() =&gt; handleActionBtnClick('view', skuId)}<br/>            &gt;<br/>              View<br/>            &lt;/Button&gt;<br/>          &lt;/div&gt;<br/>          &lt;div className="btn"&gt;<br/>            &lt;Button<br/>              variant="secondary"<br/>              type="submit"<br/>              size="sm"<br/>              onClick={() =&gt; handleActionBtnClick('edit', skuId)}<br/>            &gt;<br/>              Edit<br/>            &lt;/Button&gt;<br/>          &lt;/div&gt;<br/>          &lt;div className="btn"&gt;<br/>            &lt;Button<br/>              variant="danger"<br/>              type="submit"<br/>              size="sm"<br/>              onClick={() =&gt; handleActionBtnClick('delete', skuId, name)}<br/>            &gt;<br/>              Delete<br/>            &lt;/Button&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    &lt;/React.Fragment&gt;<br/>  );<br/>};</span><span id="2297" class="lc ld iq mb b gy mm mg l mh mi">export default Product;</span></pre><p id="d8e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，我们显示作为道具传递的产品数据，根据哪个按钮被点击，我们调用在<code class="fe mj mk ml mb b">ProductsList.js </code>文件中定义的<code class="fe mj mk ml mb b">handleActionBtnClick</code>事件处理函数。</p><p id="ed3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在<code class="fe mj mk ml mb b">router</code>文件夹中创建一个新文件<code class="fe mj mk ml mb b">AppRouter.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="6894" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { BrowserRouter, Route, Switch } from 'react-router-dom';<br/>import ProductsList from '../components/ProductsList';<br/>import Header from '../components/Header';</span><span id="991f" class="lc ld iq mb b gy mm mg l mh mi">const AppRouter = () =&gt; {<br/>  return (<br/>    &lt;BrowserRouter&gt;<br/>      &lt;div&gt;<br/>        &lt;Header /&gt;<br/>        &lt;Switch&gt;<br/>          &lt;Route component={ProductsList} path="/" exact={true} /&gt;<br/>        &lt;/Switch&gt;<br/>      &lt;/div&gt;<br/>    &lt;/BrowserRouter&gt;<br/>  );<br/>};</span><span id="e763" class="lc ld iq mb b gy mm mg l mh mi">export default AppRouter;</span></pre><p id="6313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，打开<code class="fe mj mk ml mb b">src/index.js</code>文件，在里面添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="3665" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import { Provider } from 'react-redux';<br/>import store from './store/store';<br/>import AppRouter from './router/AppRouter';<br/>import 'bootstrap/dist/css/bootstrap.min.css';<br/>import './styles.scss';</span><span id="a764" class="lc ld iq mb b gy mm mg l mh mi">ReactDOM.render(<br/>  &lt;Provider store={store}&gt;<br/>    &lt;AppRouter /&gt;<br/>  &lt;/Provider&gt;,<br/>  document.getElementById('root')<br/>);</span></pre><p id="fca9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，通过从<code class="fe mj mk ml mb b">client</code>文件夹运行<code class="fe mj mk ml mb b">yarn start</code>命令来启动React应用程序。从GraphQL playground添加一些产品，您会看到这些产品显示在页面上。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mp"><img src="../Images/0f6b2db0405a86d96f5d25a3b086a2d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HxXJTY-epIC_IQBQYWfbUQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">产品清单</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mq"><img src="../Images/75c0a3cda6a36aff3478323fa189b5f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k97GuKHXoYBKQ5COAd1gOw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">悬停时的动作按钮</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mr"><img src="../Images/de5b7f0e7e87ef30326e2dfb77bcbb14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*U_Nmr2TOb2VqUWaiU0AFDA.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">鼠标悬停操作按钮显示</figcaption></figure><p id="0285" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们添加添加和编辑产品的功能。</p><p id="e879" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">ProductForm.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="dc28" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { Form, Button } from 'react-bootstrap';</span><span id="df94" class="lc ld iq mb b gy mm mg l mh mi">export default class ProductForm extends React.Component {<br/>  state = {<br/>    skuId: this.props.skuId ? this.props.skuId : '',<br/>    name: this.props.name ? this.props.name : '',<br/>    description: this.props.description ? this.props.description : '',<br/>    price: this.props.price ? this.props.price : '',<br/>    errorMsg: this.props.errorMsg ? this.props.errorMsg : ''<br/>  };</span><span id="c374" class="lc ld iq mb b gy mm mg l mh mi">componentDidUpdate(prevProps, prevState) {<br/>    if (prevProps.errorMsg !== this.props.errorMsg) {<br/>      this.setState({ errorMsg: this.props.errorMsg });<br/>    }<br/>  }</span><span id="f9c1" class="lc ld iq mb b gy mm mg l mh mi">handleInputChange = (event) =&gt; {<br/>    const { name, value } = event.target;</span><span id="195f" class="lc ld iq mb b gy mm mg l mh mi">    if (name === 'price') {<br/>      if (!value || value.match(/^\d{1,}(\.\d{0,2})?$/)) {<br/>        this.setState({<br/>          [name]: value<br/>        });<br/>      }<br/>    } else {<br/>      this.setState({<br/>        [name]: value<br/>      });<br/>    }<br/>  };</span><span id="1739" class="lc ld iq mb b gy mm mg l mh mi">handleSubmit = (event) =&gt; {<br/>    event.preventDefault();<br/>    const fields = ['skuId', 'name', 'description', 'price'];</span><span id="80a9" class="lc ld iq mb b gy mm mg l mh mi">    const isValid = fields.every((input) =&gt; {<br/>      return this.state[input] !== '';<br/>    });<br/>    if (isValid) {<br/>      this.setState({ errorMsg: '' });<br/>      this.props.handleFormSubmit(this.state);<br/>    } else {<br/>      this.setState({ errorMsg: 'Please enter all the fields.' });<br/>    }<br/>  };</span><span id="cd9c" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const { skuId, name, description, price, errorMsg } = this.state;<br/>    const { page } = this.props;<br/>    return (<br/>      &lt;Form onSubmit={this.handleSubmit}&gt;<br/>        {errorMsg !== '' &amp;&amp; &lt;p className="errorMsg"&gt;{errorMsg}&lt;/p&gt;}<br/>        {page === 'add' ? (<br/>          &lt;Form.Group controlId="skuId"&gt;<br/>            &lt;Form.Label&gt;Sku Id&lt;/Form.Label&gt;<br/>            &lt;Form.Control<br/>              type="text"<br/>              name="skuId"<br/>              value={skuId}<br/>              placeholder="Enter sku Id"<br/>              onChange={this.handleInputChange}<br/>              autoComplete="off"<br/>            /&gt;<br/>          &lt;/Form.Group&gt;<br/>        ) : (<br/>          &lt;Form.Group controlId="skuId"&gt;<br/>            &lt;Form.Label&gt;<br/>              Sku Id: &lt;strong&gt;{skuId}&lt;/strong&gt;<br/>            &lt;/Form.Label&gt;<br/>          &lt;/Form.Group&gt;<br/>        )}<br/>        &lt;Form.Group controlId="product_name"&gt;<br/>          &lt;Form.Label&gt;Name&lt;/Form.Label&gt;<br/>          &lt;Form.Control<br/>            type="text"<br/>            name="name"<br/>            value={name}<br/>            placeholder="Enter product name"<br/>            onChange={this.handleInputChange}<br/>            autoComplete="off"<br/>          /&gt;<br/>        &lt;/Form.Group&gt;<br/>        &lt;Form.Group controlId="description"&gt;<br/>          &lt;Form.Label&gt;Description&lt;/Form.Label&gt;<br/>          &lt;Form.Control<br/>            type="text"<br/>            name="description"<br/>            value={description}<br/>            placeholder="Enter product description"<br/>            onChange={this.handleInputChange}<br/>            autoComplete="off"<br/>          /&gt;<br/>        &lt;/Form.Group&gt;<br/>        &lt;Form.Group controlId="product_name"&gt;<br/>          &lt;Form.Label&gt;Price&lt;/Form.Label&gt;<br/>          &lt;Form.Control<br/>            type="text"<br/>            name="price"<br/>            value={price}<br/>            placeholder="Enter product price"<br/>            onChange={this.handleInputChange}<br/>            autoComplete="off"<br/>          /&gt;<br/>        &lt;/Form.Group&gt;<br/>        &lt;Button variant="primary" type="submit"&gt;<br/>          {page === 'add' ? 'Add Product' : 'Update Product'}<br/>        &lt;/Button&gt;<br/>      &lt;/Form&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="3dbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">AddProduct.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="e4ec" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { connect } from 'react-redux';<br/>import Layout from './Layout';<br/>import ProductForm from './ProductForm';<br/>import { initiateAddProduct } from '../actions/products';</span><span id="f5f7" class="lc ld iq mb b gy mm mg l mh mi">class AddProduct extends React.Component {<br/>  state = {<br/>    errorMsg: ''<br/>  };</span><span id="d9dd" class="lc ld iq mb b gy mm mg l mh mi">componentDidUpdate(prevProps, prevState) {<br/>    if (prevProps.error !== this.props.error) {<br/>      this.setState({ errorMsg: this.props.error });<br/>    }<br/>  }</span><span id="59aa" class="lc ld iq mb b gy mm mg l mh mi">handleFormSubmit = (product) =&gt; {<br/>    this.setState({ errorMsg: '' });<br/>    this.props<br/>      .dispatch(<br/>        initiateAddProduct({ ...product, price: parseFloat(product.price) })<br/>      )<br/>      .then(() =&gt; {<br/>        const { errorMsg } = this.state;<br/>        if (errorMsg === '') {<br/>          const { history } = this.props;</span><span id="0d61" class="lc ld iq mb b gy mm mg l mh mi">          history.push('/');<br/>        }<br/>      });<br/>  };</span><span id="37e4" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    return (<br/>      &lt;Layout&gt;<br/>        &lt;ProductForm<br/>          handleFormSubmit={this.handleFormSubmit}<br/>          page="add"<br/>          errorMsg={this.state.errorMsg}<br/>        /&gt;<br/>      &lt;/Layout&gt;<br/>    );<br/>  }<br/>}</span><span id="0ff5" class="lc ld iq mb b gy mm mg l mh mi">const mapStateToProps = (state) =&gt; {<br/>  return {<br/>    error: state.error<br/>  };<br/>};</span><span id="4578" class="lc ld iq mb b gy mm mg l mh mi">export default connect(mapStateToProps)(AddProduct);</span></pre><p id="b694" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">EditProduct.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="24cd" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { connect } from 'react-redux';<br/>import Layout from './Layout';<br/>import ProductForm from './ProductForm';<br/>import { initiateEditProduct } from '../actions/products';<br/>import { Redirect } from 'react-router-dom';</span><span id="3e6b" class="lc ld iq mb b gy mm mg l mh mi">class EditProduct extends React.Component {<br/>  state = {<br/>    errorMsg: ''<br/>  };</span><span id="f363" class="lc ld iq mb b gy mm mg l mh mi">componentDidUpdate(prevProps, prevState) {<br/>    if (prevProps.error !== this.props.error) {<br/>      this.setState({ errorMsg: this.props.error });<br/>    }<br/>  }</span><span id="60c0" class="lc ld iq mb b gy mm mg l mh mi">handleFormSubmit = (product) =&gt; {<br/>    this.setState({ errorMsg: '' });<br/>    this.props<br/>      .dispatch(<br/>        initiateEditProduct({ ...product, price: parseFloat(product.price) })<br/>      )<br/>      .then(() =&gt; {<br/>        const { errorMsg } = this.state;<br/>        if (errorMsg === '') {<br/>          const { history } = this.props;</span><span id="2420" class="lc ld iq mb b gy mm mg l mh mi">          history.push('/');<br/>        }<br/>      });<br/>  };</span><span id="d8bc" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const { product } = this.props;<br/>    return (<br/>      &lt;Layout&gt;<br/>        {product ? (<br/>          &lt;ProductForm<br/>            handleFormSubmit={this.handleFormSubmit}<br/>            {...product}<br/>            page="edit"<br/>            errorMsg={this.state.errorMsg}<br/>          /&gt;<br/>        ) : (<br/>          &lt;Redirect to="/" /&gt;<br/>        )}<br/>      &lt;/Layout&gt;<br/>    );<br/>  }<br/>}</span><span id="17c5" class="lc ld iq mb b gy mm mg l mh mi">const mapStateToProps = (state, props) =&gt; {<br/>  return {<br/>    product: state.products.find(<br/>      (product) =&gt; product.skuId === props.location.state.skuId<br/>    ),<br/>    error: state.error<br/>  };<br/>};</span><span id="facf" class="lc ld iq mb b gy mm mg l mh mi">export default connect(mapStateToProps)(EditProduct);</span></pre><p id="aa99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们明白我们在这里做什么。</p><p id="756f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">ProductForm.js</code>文件中，我们已经创建了一个通用的表单来显示在<code class="fe mj mk ml mb b">Edit</code>和<code class="fe mj mk ml mb b">Add</code>产品页面上。</p><p id="06e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">AddProduct.js</code>和<code class="fe mj mk ml mb b">EditProduct.js</code>文件中，我们通过发送<code class="fe mj mk ml mb b">handleFormSubmit</code>和<code class="fe mj mk ml mb b">page</code>道具来显示<code class="fe mj mk ml mb b">ProductForm</code>组件。</p><p id="8a25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只有在<code class="fe mj mk ml mb b">EditProduct.js</code>内部，对于<code class="fe mj mk ml mb b">ProductForm</code>组件，我们通过使用spread操作符来传递产品细节。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="a0d0" class="lc ld iq mb b gy mf mg l mh mi">&lt;ProductForm<br/>  handleFormSubmit={this.handleFormSubmit}<br/>  {...product}<br/>  page="edit"<br/>  errorMsg={this.state.errorMsg}<br/>/&gt;</span></pre><p id="6c9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们在<code class="fe mj mk ml mb b">ProductForm.js</code>状态中添加了一个条件检查来设置编辑产品的值，如下所示</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="ad84" class="lc ld iq mb b gy mf mg l mh mi">state = {<br/> skuId: this.props.skuId ? this.props.skuId : ''<br/>}</span></pre><p id="49f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，如果页面是<code class="fe mj mk ml mb b">edit</code>产品，那么我们将所选产品的值设置为状态，否则将其设置为空，然后我们使用该状态值来设置每个输入字段的值，如下所示</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="efc7" class="lc ld iq mb b gy mf mg l mh mi">&lt;Form.Control<br/>  type="text"<br/>  name="skuId"<br/>  value={skuId} // skuId here is from the state<br/>  placeholder="Enter sku Id"<br/>  onChange={this.handleInputChange}<br/>/&gt;</span></pre><p id="3c0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在<code class="fe mj mk ml mb b">router/AppRouter.js</code>文件中添加两条新路线</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="dbb9" class="lc ld iq mb b gy mf mg l mh mi">&lt;Route component={EditProduct} path="/edit/:id" /&gt;<br/>&lt;Route component={AddProduct} path="/add" /&gt;</span></pre><p id="5e82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此您的<code class="fe mj mk ml mb b">AppRouter.js</code>文件将如下所示</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="2947" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { BrowserRouter, Route, Switch } from 'react-router-dom';<br/>import ProductsList from '../components/ProductsList';<br/>import Header from '../components/Header';</span><span id="a750" class="lc ld iq mb b gy mm mg l mh mi">const AppRouter = () =&gt; {<br/>  return (<br/>    &lt;BrowserRouter&gt;<br/>      &lt;div&gt;<br/>        &lt;Header /&gt;<br/>        &lt;Switch&gt;<br/>          &lt;Route component={ProductsList} path="/" exact={true} /&gt;<br/>          &lt;Route component={EditProduct} path="/edit/:id" /&gt;<br/>          &lt;Route component={AddProduct} path="/add" /&gt;<br/>        &lt;/Switch&gt;<br/>      &lt;/div&gt;<br/>    &lt;/BrowserRouter&gt;<br/>  );<br/>};</span><span id="43fb" class="lc ld iq mb b gy mm mg l mh mi">export default AppRouter;</span></pre><p id="9b0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，打开<code class="fe mj mk ml mb b">ProductsList.js</code>文件，添加一个新的状态变量<code class="fe mj mk ml mb b">selectedProduct</code>，初始值为<code class="fe mj mk ml mb b">null</code>。你的州现在会是这个样子</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="8d1e" class="lc ld iq mb b gy mf mg l mh mi">state = {<br/>  products: [],<br/>  errorMsg: '',<br/>  isLoading: false,<br/>  selectedProduct: null<br/>};</span></pre><p id="cd43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并将<code class="fe mj mk ml mb b">handleActionBtnClick</code>事件处理程序更改为</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="2343" class="lc ld iq mb b gy mf mg l mh mi">handleActionBtnClick = (type, skuId, name) =&gt; {<br/>  if (type === 'edit') {<br/>    this.props.history.push({<br/>      pathname: `/edit/${skuId}`,<br/>      state: { type, skuId }<br/>    });<br/>  } else if (type === 'view') {<br/>    this.setState((prevState) =&gt; ({<br/>      selectedProduct: prevState.products.find(<br/>        (product) =&gt; product.skuId === skuId<br/>      )<br/>    }));<br/>  } else if (type === 'delete') {<br/>    const shouldDelete = window.confirm(<br/>      `Are you sure you want to delete product with name ${name}?`<br/>    );<br/>    if (shouldDelete) {<br/>      this.setState({ errorMsg: '' });<br/>      this.props.dispatch(initiateDeleteProduct(skuId));<br/>    }<br/>  }<br/>};</span></pre><p id="f94b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，当我们单击产品的编辑按钮时，我们通过发送选择的产品<code class="fe mj mk ml mb b">type</code>和<code class="fe mj mk ml mb b">skuId</code>来路由到<code class="fe mj mk ml mb b">EditProduct</code>组件</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="5a4a" class="lc ld iq mb b gy mf mg l mh mi">this.props.history.push({<br/>  pathname: `/edit/${skuId}`,<br/>  state: { type, skuId }<br/>});</span></pre><p id="e86d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们为pathname属性指定了在<code class="fe mj mk ml mb b">AppRouter.js</code>文件中提到的路径。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="1c5a" class="lc ld iq mb b gy mf mg l mh mi">&lt;Route component={EditProduct} path="/edit/:id" /&gt;</span></pre><p id="7471" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看本文以了解更多关于在重定向到不同路由时传递数据的信息。</p><p id="dbd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，如果我们单击查看按钮，我们将通过使用匹配的<code class="fe mj mk ml mb b">skuId</code>来设置<code class="fe mj mk ml mb b">selectedProduct</code>状态</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="6e90" class="lc ld iq mb b gy mf mg l mh mi">this.setState((prevState) =&gt; ({<br/>  selectedProduct: prevState.products.find(<br/>    (product) =&gt; product.skuId === skuId<br/>  )<br/>}));</span></pre><p id="930b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，首先从<code class="fe mj mk ml mb b">server</code>文件夹执行<code class="fe mj mk ml mb b">yarn start</code>命令，然后从终端的<code class="fe mj mk ml mb b">client</code>文件夹执行<code class="fe mj mk ml mb b">yarn start</code>命令，启动服务器和客户端。</p><p id="f1ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦两个服务器都启动，导航到<a class="ae lb" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>并检查<code class="fe mj mk ml mb b">add</code>、<code class="fe mj mk ml mb b">edit</code>和<code class="fe mj mk ml mb b">delete</code>功能。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/939821791db96cf00bd64c52cf3910f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zl7WXLA1Z6aYJMO6C8NRFw.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">添加、编辑和删除功能</figcaption></figure><p id="cdff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们将开始集成查看按钮功能，以显示产品详细信息和评论，以及在模式中添加评论的选项。</p><p id="ef1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe mj mk ml mb b">ProductsList.js</code>并添加两个状态变量</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="0288" class="lc ld iq mb b gy mf mg l mh mi">reviews: null,<br/>isOpen: false</span></pre><p id="049c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">componentDidUpdate</code>中添加一个条件以获取更新的评论</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="4280" class="lc ld iq mb b gy mf mg l mh mi">if (<br/>  prevProps.reviews.skuId !== this.props.reviews.skuId ||<br/>  (this.props.reviews.list &amp;&amp;<br/>    prevProps.reviews.list.length !== this.props.reviews.list.length)<br/>) {<br/>  this.setState({ reviews: this.props.reviews });<br/>}</span></pre><p id="66c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">mapStateToProps</code>接受州政府的审查</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="af98" class="lc ld iq mb b gy mf mg l mh mi">const mapStateToProps = (state) =&gt; {<br/>  return {<br/>    products: state.products,<br/>    error: state.error,<br/>    reviews: state.reviews<br/>  };<br/>};</span></pre><p id="f515" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将<code class="fe mj mk ml mb b">handleActionBtnClick</code>功能更改为以下代码</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="a376" class="lc ld iq mb b gy mf mg l mh mi">handleActionBtnClick = (type, skuId, name) =&gt; {<br/>  if (type === 'edit') {<br/>    this.props.history.push({<br/>      pathname: `/edit/${skuId}`,<br/>      state: { type, skuId }<br/>    });<br/>  } else if (type === 'view') {<br/>    this.setState(<br/>      (prevState) =&gt; ({<br/>        isOpen: !prevState.isOpen,<br/>        selectedProduct: prevState.products.find(<br/>          (product) =&gt; product.skuId === skuId<br/>        )<br/>      }),<br/>      () =&gt; {<br/>        this.props.dispatch(<br/>          initiateGetReviews(this.state.selectedProduct.skuId)<br/>        );<br/>      }<br/>    );<br/>  } else if (type === 'delete') {<br/>    const shouldDelete = window.confirm(<br/>      `Are you sure you want to delete product with name ${name}?`<br/>    );<br/>    if (shouldDelete) {<br/>      this.setState({ errorMsg: '' });<br/>      this.props.dispatch(initiateDeleteProduct(skuId)).then(() =&gt; {<br/>        const { errorMsg } = this.state;<br/>        if (errorMsg === '') {<br/>          const { history } = this.props;</span><span id="ab64" class="lc ld iq mb b gy mm mg l mh mi">history.push('/');<br/>        }<br/>      });<br/>    }<br/>  }<br/>};</span></pre><p id="1162" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，当类型为<code class="fe mj mk ml mb b">view</code>时，一旦<code class="fe mj mk ml mb b">selectedProduct</code>状态被更新，我们将调用<code class="fe mj mk ml mb b">initiateGetReviews</code>函数来获取所选产品的评论。</p><p id="4957" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们使用<code class="fe mj mk ml mb b">setState</code>的替代语法，其中<code class="fe mj mk ml mb b">setState</code>的第一个参数是一个描述要改变哪个状态的函数，第二个参数是另一个在状态更新时执行的函数，这样我们就可以获得状态的更新值来获取评论，因为<code class="fe mj mk ml mb b">setState</code>是异步的，所以它接受两个参数。</p><p id="5650" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在将<code class="fe mj mk ml mb b">initiateGetReviews</code>的导入添加到文件的顶部</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="3e9f" class="lc ld iq mb b gy mf mg l mh mi">import { initiateGetReviews } from '../actions/reviews';</span></pre><p id="1854" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，通过访问<a class="ae lb" href="http://localhost:4000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:4000/ </a>从GraphQL playground添加一条评论，一旦添加，当我们单击添加评论的产品的view按钮时，您将在redux store中看到添加的评论。</p><p id="b1a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要在chrome <code class="fe mj mk ml mb b">devtools</code>中获得Redux标签，你需要安装redux <code class="fe mj mk ml mb b">devtools</code>扩展，我之前已经解释过了<a class="ae lb" href="https://medium.com/javascript-in-plain-english/how-to-integrate-redux-thunk-into-your-react-application-cd92b87c1629#7120" rel="noopener">这里是</a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/1cc17d2a1d73f560d3d9e827cc4b049d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*W0ruaMh0lQ1WqWJDc474bg.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">更新商店以增加评论</figcaption></figure><p id="4389" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在<code class="fe mj mk ml mb b">ProductsList.js</code>文件中添加<code class="fe mj mk ml mb b">handleProductModalClose</code>事件处理程序</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="2991" class="lc ld iq mb b gy mf mg l mh mi">handleProductModalClose = () =&gt; {<br/>  this.props.dispatch(clearError());<br/>  this.setState({ isOpen: false });<br/>};</span></pre><p id="e6bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">render</code>方法中，将<code class="fe mj mk ml mb b">propsToPass</code>对象改为</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="b64d" class="lc ld iq mb b gy mf mg l mh mi">const propsToPass = {<br/>  selectedProduct,<br/>  isOpen,<br/>  reviews,<br/>  handleActionBtnClick: this.handleActionBtnClick,<br/>  handleProductModalClose: this.handleProductModalClose<br/>};</span></pre><p id="4d2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并把这些价值从州政府中拿出来</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="934e" class="lc ld iq mb b gy mf mg l mh mi">const {<br/>  products,<br/>  errorMsg,<br/>  isLoading,<br/>  isOpen,<br/>  reviews,<br/>  selectedProduct<br/>} = this.state;</span></pre><p id="74a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，你的<code class="fe mj mk ml mb b">ProductsList.js</code>将看起来像这样</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="e70e" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { connect } from 'react-redux';<br/>import _ from 'lodash';<br/>import {<br/>  initiateGetProducts,<br/>  initiateDeleteProduct<br/>} from '../actions/products';<br/>import { initiateGetReviews } from '../actions/reviews';<br/>import { clearError } from '../actions/error';<br/>import Product from './Product';<br/>import Layout from './Layout';</span><span id="d6a6" class="lc ld iq mb b gy mm mg l mh mi">class ProductsList extends React.Component {<br/>  state = {<br/>    products: [],<br/>    errorMsg: '',<br/>    isLoading: false,<br/>    selectedProduct: null,<br/>    reviews: null,<br/>    isOpen: false<br/>  };</span><span id="5c65" class="lc ld iq mb b gy mm mg l mh mi">componentDidMount() {<br/>    this.setState({ isLoading: true });<br/>    this.props.dispatch(initiateGetProducts()).then(() =&gt; {<br/>      this.setState({<br/>        products: this.props.products,<br/>        isLoading: false<br/>      });<br/>    });<br/>  }</span><span id="f7c1" class="lc ld iq mb b gy mm mg l mh mi">componentDidUpdate(prevProps, prevState) {<br/>    if (prevProps.products.length !== this.props.products.length) {<br/>      this.setState({ products: this.props.products });<br/>    }<br/>    if (prevProps.error !== this.props.error) {<br/>      this.setState({ errorMsg: this.props.error });<br/>    }<br/>    if (<br/>      prevProps.reviews.skuId !== this.props.reviews.skuId ||<br/>      (this.props.reviews.list &amp;&amp;<br/>        prevProps.reviews.list.length !== this.props.reviews.list.length)<br/>    ) {<br/>      this.setState({ reviews: this.props.reviews });<br/>    }<br/>  }</span><span id="5a9d" class="lc ld iq mb b gy mm mg l mh mi">handleProductModalClose = () =&gt; {<br/>    this.props.dispatch(clearError());<br/>    this.setState({ isOpen: false });<br/>  };</span><span id="90ed" class="lc ld iq mb b gy mm mg l mh mi">handleActionBtnClick = (type, skuId, name) =&gt; {<br/>    if (type === 'edit') {<br/>      this.props.history.push({<br/>        pathname: `/edit/${skuId}`,<br/>        state: { type, skuId }<br/>      });<br/>    } else if (type === 'view') {<br/>      this.setState(<br/>        (prevState) =&gt; ({<br/>          isOpen: !prevState.isOpen,<br/>          selectedProduct: prevState.products.find(<br/>            (product) =&gt; product.skuId === skuId<br/>          )<br/>        }),<br/>        () =&gt; {<br/>          this.props.dispatch(<br/>            initiateGetReviews(this.state.selectedProduct.skuId)<br/>          );<br/>        }<br/>      );<br/>    } else if (type === 'delete') {<br/>      const shouldDelete = window.confirm(<br/>        `Are you sure you want to delete product with name ${name}?`<br/>      );<br/>      if (shouldDelete) {<br/>        this.setState({ errorMsg: '' });<br/>        this.props.dispatch(initiateDeleteProduct(skuId)).then(() =&gt; {<br/>          const { errorMsg } = this.state;<br/>          if (errorMsg === '') {<br/>            const { history } = this.props;</span><span id="1dc9" class="lc ld iq mb b gy mm mg l mh mi">history.push('/');<br/>          }<br/>        });<br/>      }<br/>    }<br/>  };</span><span id="1595" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const {<br/>      products,<br/>      errorMsg,<br/>      isLoading,<br/>      isOpen,<br/>      reviews,<br/>      selectedProduct<br/>    } = this.state;</span><span id="9e9c" class="lc ld iq mb b gy mm mg l mh mi">const propsToPass = {<br/>      selectedProduct,<br/>      isOpen,<br/>      reviews,<br/>      handleActionBtnClick: this.handleActionBtnClick,<br/>      handleProductModalClose: this.handleProductModalClose<br/>    };</span><span id="80a7" class="lc ld iq mb b gy mm mg l mh mi">return (<br/>      &lt;Layout&gt;<br/>        {errorMsg !== '' &amp;&amp; &lt;p className="errorMsg"&gt;{errorMsg}&lt;/p&gt;}<br/>        {isLoading ? (<br/>          &lt;p className="loading"&gt;Loading...&lt;/p&gt;<br/>        ) : (<br/>          &lt;React.Fragment&gt;<br/>            {!_.isEmpty(products) ? (<br/>              products.map((product, index) =&gt; {<br/>                return (<br/>                  &lt;React.Fragment key={product.skuId}&gt;<br/>                    {index === 0 ? (<br/>                      &lt;React.Fragment&gt;<br/>                        &lt;div className="product product-header"&gt;<br/>                          &lt;div className="name"&gt;Product Name&lt;/div&gt;<br/>                          &lt;div className="description"&gt;Description&lt;/div&gt;<br/>                          &lt;div&gt;Price&lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                        &lt;Product {...product} {...propsToPass} /&gt;<br/>                      &lt;/React.Fragment&gt;<br/>                    ) : (<br/>                      &lt;Product {...product} {...propsToPass} /&gt;<br/>                    )}<br/>                  &lt;/React.Fragment&gt;<br/>                );<br/>              })<br/>            ) : (<br/>              &lt;p className="no-result"&gt;<br/>                No products found. Please add some products.<br/>              &lt;/p&gt;<br/>            )}<br/>          &lt;/React.Fragment&gt;<br/>        )}<br/>      &lt;/Layout&gt;<br/>    );<br/>  }<br/>}</span><span id="6bdf" class="lc ld iq mb b gy mm mg l mh mi">const mapStateToProps = (state) =&gt; {<br/>  return {<br/>    products: state.products,<br/>    error: state.error,<br/>    reviews: state.reviews<br/>  };<br/>};</span><span id="49b5" class="lc ld iq mb b gy mm mg l mh mi">export default connect(mapStateToProps)(ProductsList);</span></pre><p id="97af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">ProductModal.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="7add" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import Modal from 'react-modal';<br/>import { connect } from 'react-redux';<br/>import ProductReviews from './ProductReviews';<br/>import { initiateAddReview, clearReviews } from '../actions/reviews';</span><span id="0ed0" class="lc ld iq mb b gy mm mg l mh mi">Modal.setAppElement('#root');</span><span id="b198" class="lc ld iq mb b gy mm mg l mh mi">class ProductModal extends React.Component {<br/>  state = {<br/>    showAddReview: this.props.isOpen ? false : true,<br/>    errorMsg: ''<br/>  };</span><span id="b948" class="lc ld iq mb b gy mm mg l mh mi">componentDidUpdate(prevProps, prevState) {<br/>    if (prevProps.error !== this.props.error) {<br/>      this.setState({ errorMsg: this.props.error });<br/>    }<br/>    if (prevProps.isOpen !== this.props.isOpen) {<br/>      const { dispatch, isOpen } = this.props;<br/>      dispatch(clearReviews());<br/>      this.setState({ showAddReview: isOpen ? false : true });<br/>    }<br/>  }</span><span id="8eac" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const {<br/>      handleProductModalClose,<br/>      isOpen,<br/>      name,<br/>      skuId,<br/>      description,<br/>      price,<br/>      reviews<br/>    } = this.props;</span><span id="6664" class="lc ld iq mb b gy mm mg l mh mi">const { showAddReview, errorMsg } = this.state;</span><span id="91f0" class="lc ld iq mb b gy mm mg l mh mi">const customStyles = {<br/>      content: {<br/>        top: '50%',<br/>        left: '50%',<br/>        right: 'auto',<br/>        bottom: 'auto',<br/>        transform: 'translate(-50%, -50%)',<br/>        width: '700px',<br/>        height: '600px',<br/>        display: 'flex',<br/>        boxShadow: '0 0 7px 2px #444'<br/>      }<br/>    };</span><span id="316d" class="lc ld iq mb b gy mm mg l mh mi">return (<br/>      &lt;div&gt;<br/>        &lt;Modal<br/>          isOpen={isOpen}<br/>          onRequestClose={handleProductModalClose}<br/>          style={customStyles}<br/>          contentLabel="Product Details"<br/>        &gt;<br/>          &lt;div className="product-details"&gt;<br/>            &lt;div className="close" onClick={handleProductModalClose}&gt;<br/>              x<br/>            &lt;/div&gt;<br/>            &lt;h3 className="heading"&gt;Product Details&lt;/h3&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Sku Id:&lt;/strong&gt;<br/>              &lt;span&gt;{skuId}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Name:&lt;/strong&gt;<br/>              &lt;span&gt;{name}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Description:&lt;/strong&gt;<br/>              &lt;span&gt;{description}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Price:&lt;/strong&gt;<br/>              &lt;span&gt;{price}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            {errorMsg &amp;&amp; &lt;p className="errorMsg"&gt;{errorMsg}&lt;/p&gt;}</span><span id="0294" class="lc ld iq mb b gy mm mg l mh mi">            &lt;ProductReviews reviews={reviews} /&gt;<br/>          &lt;/div&gt;<br/>        &lt;/Modal&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span><span id="3ef0" class="lc ld iq mb b gy mm mg l mh mi">const mapStateToProps = (state) =&gt; {<br/>  return {<br/>    error: state.error<br/>  };<br/>};</span><span id="3443" class="lc ld iq mb b gy mm mg l mh mi">export default connect(mapStateToProps)(ProductModal);</span></pre><p id="4e94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们使用<code class="fe mj mk ml mb b">react-modal</code>库来显示一个模态。它需要一个用于显示或隐藏模态的<code class="fe mj mk ml mb b">isOpen</code>道具。在<code class="fe mj mk ml mb b">npmjs</code>查看他们的示例，了解如何使用<a class="ae lb" href="https://www.npmjs.com/package/react-modal#user-content-examples" rel="noopener ugc nofollow" target="_blank">这里</a></p><p id="9cf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在打开<code class="fe mj mk ml mb b">Product.js</code>文件，取出通过的道具</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="7aa1" class="lc ld iq mb b gy mf mg l mh mi">const {<br/>  name,<br/>  skuId,<br/>  description,<br/>  price,<br/>  handleActionBtnClick,<br/>  handleProductModalClose,<br/>  isOpen,<br/>  selectedProduct,<br/>  reviews<br/>} = props;</span></pre><p id="909c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在顶部添加对<code class="fe mj mk ml mb b">ProductModal</code>文件的导入</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="faba" class="lc ld iq mb b gy mf mg l mh mi">import ProductModal from './ProductModal';</span></pre><p id="7f91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并在<code class="fe mj mk ml mb b">&lt;React.Fragment&gt;</code>标签的末尾之前添加<code class="fe mj mk ml mb b">ProductModal</code>组件，并向其传递所需的道具。</p><p id="ac35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你的<code class="fe mj mk ml mb b">Product.js</code>文件将会是这样的</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="25c4" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { Button } from 'react-bootstrap';<br/>import ProductModal from './ProductModal';</span><span id="0466" class="lc ld iq mb b gy mm mg l mh mi">const Product = (props) =&gt; {<br/>  const {<br/>    name,<br/>    skuId,<br/>    description,<br/>    price,<br/>    handleActionBtnClick,<br/>    handleProductModalClose,<br/>    isOpen,<br/>    selectedProduct,<br/>    reviews<br/>  } = props;<br/>  return (<br/>    &lt;React.Fragment&gt;<br/>      &lt;div className="product-item"&gt;<br/>        &lt;div className="product" data-skuid={skuId}&gt;<br/>          &lt;div className="name"&gt;{name}&lt;/div&gt;<br/>          &lt;div className="description"&gt;{description}&lt;/div&gt;<br/>          &lt;div&gt;{price.toFixed(2)}&lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;div className="buttons"&gt;<br/>          &lt;div className="btn"&gt;<br/>            &lt;Button<br/>              variant="info"<br/>              type="submit"<br/>              size="sm"<br/>              onClick={() =&gt; handleActionBtnClick('view', skuId)}<br/>            &gt;<br/>              View<br/>            &lt;/Button&gt;<br/>          &lt;/div&gt;<br/>          &lt;div className="btn"&gt;<br/>            &lt;Button<br/>              variant="secondary"<br/>              type="submit"<br/>              size="sm"<br/>              onClick={() =&gt; handleActionBtnClick('edit', skuId)}<br/>            &gt;<br/>              Edit<br/>            &lt;/Button&gt;<br/>          &lt;/div&gt;<br/>          &lt;div className="btn"&gt;<br/>            &lt;Button<br/>              variant="danger"<br/>              type="submit"<br/>              size="sm"<br/>              onClick={() =&gt; handleActionBtnClick('delete', skuId, name)}<br/>            &gt;<br/>              Delete<br/>            &lt;/Button&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>      &lt;ProductModal<br/>        isOpen={isOpen}<br/>        handleProductModalClose={handleProductModalClose}<br/>        {...selectedProduct}<br/>        reviews={reviews}<br/>      /&gt;<br/>    &lt;/React.Fragment&gt;<br/>  );<br/>};</span><span id="7aa0" class="lc ld iq mb b gy mm mg l mh mi">export default Product;</span></pre><p id="de74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹下新建一个文件<code class="fe mj mk ml mb b">Review.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="4e8f" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import moment from 'moment';</span><span id="9125" class="lc ld iq mb b gy mm mg l mh mi">export default class Review extends React.Component {<br/>  handleDeleteReview = (event) =&gt; {<br/>    event.preventDefault();<br/>    this.props.handleDeleteReview(this.props._id);<br/>  };</span><span id="c865" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const { title, comment, updatedAt } = this.props;</span><span id="b352" class="lc ld iq mb b gy mm mg l mh mi">return (<br/>      &lt;div className="review"&gt;<br/>        &lt;div className="updated_time"&gt;<br/>          &lt;div&gt;{moment(+updatedAt).format('dddd, MMMM Do, YYYY h:mma')}&lt;/div&gt;<br/>          &lt;div className="delete-review"&gt;<br/>            &lt;a href="/#" onClick={this.handleDeleteReview}&gt;<br/>              Delete<br/>            &lt;/a&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;div className="main-section"&gt;<br/>          &lt;p className="title"&gt;{title}&lt;/p&gt;<br/>          &lt;p&gt;{comment}&lt;/p&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="31eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在components文件夹中创建一个新文件ProductReviews.js，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="f2d1" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { connect } from 'react-redux';<br/>import _ from 'lodash';<br/>import Review from './Review';<br/>import { initiateDeleteReview } from '../actions/reviews';</span><span id="dda0" class="lc ld iq mb b gy mm mg l mh mi">class ProductReviews extends React.Component {<br/>  handleDeleteReview = (id) =&gt; {<br/>    this.props.dispatch(initiateDeleteReview(id));<br/>  };</span><span id="2099" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    let { reviews } = this.props;</span><span id="2c20" class="lc ld iq mb b gy mm mg l mh mi">    if (reviews) {<br/>      reviews = reviews.list;</span><span id="8672" class="lc ld iq mb b gy mm mg l mh mi">return (<br/>        &lt;div className="reviews"&gt;<br/>          &lt;h4 className="title"&gt;Reviews&lt;/h4&gt;<br/>          {!_.isEmpty(reviews) ? (<br/>            reviews.map((review) =&gt; (<br/>              &lt;Review<br/>                key={review._id}<br/>                {...review}<br/>                handleDeleteReview={this.handleDeleteReview}<br/>              /&gt;<br/>            ))<br/>          ) : (<br/>            &lt;p&gt;No reviews added. Be the first one to add review.&lt;/p&gt;<br/>          )}<br/>        &lt;/div&gt;<br/>      );<br/>    } else {<br/>      return null;<br/>    }<br/>  }<br/>}</span><span id="fb91" class="lc ld iq mb b gy mm mg l mh mi">export default connect()(ProductReviews);</span></pre><p id="112e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，重新启动<code class="fe mj mk ml mb b">server</code>和<code class="fe mj mk ml mb b">client</code>，首先从<code class="fe mj mk ml mb b">server</code>文件夹执行<code class="fe mj mk ml mb b">yarn start </code>命令，然后从<code class="fe mj mk ml mb b">client</code>文件夹执行，如果MongoDB服务器没有运行，也要执行，然后检查查看产品功能。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/b24442454eec8038e87128de1db5089b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-NtkWVjXoAG_RiWkaOBL1Q.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">查看按钮功能的产品模式</figcaption></figure><p id="b40d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们添加选项，从modal本身添加一个新的评论。</p><p id="283a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mj mk ml mb b">components</code>文件夹中新建一个文件<code class="fe mj mk ml mb b">ReviewForm.js</code>，并在其中添加以下内容。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="61a4" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import { Form, Button } from 'react-bootstrap';</span><span id="cef6" class="lc ld iq mb b gy mm mg l mh mi">export default class ReviewForm extends React.Component {<br/>  state = {<br/>    title: '',<br/>    comment: '',<br/>    errorMsg: ''<br/>  };</span><span id="b71a" class="lc ld iq mb b gy mm mg l mh mi">handleSubmitReview = (event) =&gt; {<br/>    event.preventDefault();<br/>    const { skuId } = this.props;<br/>    const { title, comment } = this.state;</span><span id="235a" class="lc ld iq mb b gy mm mg l mh mi">    if (title.trim() !== '' &amp;&amp; comment.trim() !== '') {<br/>      this.props<br/>        .handleSubmitReview(skuId, {<br/>          title,<br/>          comment<br/>        })<br/>        .then((response) =&gt; {<br/>          if (response) {<br/>            this.setState({<br/>              title: '',<br/>              comment: '',<br/>              errorMsg: ''<br/>            });<br/>          }<br/>        });<br/>    } else {<br/>      this.setState({ errorMsg: 'Please enter all the fields.' });<br/>    }<br/>  };</span><span id="d549" class="lc ld iq mb b gy mm mg l mh mi">handleInputChange = (event) =&gt; {<br/>    const { name, value } = event.target;</span><span id="7014" class="lc ld iq mb b gy mm mg l mh mi">    this.setState({<br/>      [name]: value<br/>    });<br/>  };</span><span id="4555" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const { showAddReview, toggleReview } = this.props;<br/>    const { title, comment, errorMsg } = this.state;</span><span id="113c" class="lc ld iq mb b gy mm mg l mh mi">    return (<br/>      &lt;React.Fragment&gt;<br/>        &lt;Button<br/>          variant="secondary"<br/>          type="submit"<br/>          size="sm"<br/>          onClick={toggleReview}<br/>        &gt;<br/>          {showAddReview ? 'Hide add review' : 'Add a review'}<br/>        &lt;/Button&gt;<br/>        {errorMsg !== '' &amp;&amp; &lt;p className="errorMsg"&gt;{errorMsg}&lt;/p&gt;}<br/>        &lt;div className={`add-review ${showAddReview ? '' : 'hide'}`}&gt;<br/>          &lt;Form onSubmit={this.handleSubmitReview}&gt;<br/>            &lt;Form.Group controlId="review_title"&gt;<br/>              &lt;Form.Label&gt;Title&lt;/Form.Label&gt;<br/>              &lt;Form.Control<br/>                type="text"<br/>                name="title"<br/>                value={title}<br/>                placeholder="Enter title for your review"<br/>                onChange={this.handleInputChange}<br/>                autoComplete="off"<br/>              /&gt;<br/>            &lt;/Form.Group&gt;<br/>            &lt;Form.Group controlId="review_comment"&gt;<br/>              &lt;Form.Label&gt;Write your review&lt;/Form.Label&gt;<br/>              &lt;Form.Control<br/>                as="textarea"<br/>                name="comment"<br/>                value={comment}<br/>                rows="3"<br/>                placeholder="Enter your review"<br/>                onChange={this.handleInputChange}<br/>                autoComplete="off"<br/>              /&gt;<br/>            &lt;/Form.Group&gt;<br/>            &lt;Button variant="secondary" type="submit" size="sm"&gt;<br/>              Publish<br/>            &lt;/Button&gt;<br/>          &lt;/Form&gt;<br/>        &lt;/div&gt;<br/>      &lt;/React.Fragment&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="86a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开<code class="fe mj mk ml mb b">ProductModal.js</code>文件，在<code class="fe mj mk ml mb b">ProductReview</code>组件之前导入并使用<code class="fe mj mk ml mb b">ReviewForm</code>组件。</p><p id="a812" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另外，在其中添加<code class="fe mj mk ml mb b">toggleReview</code>和<code class="fe mj mk ml mb b">handleSubmitReview</code>功能</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="55b8" class="lc ld iq mb b gy mf mg l mh mi">handleSubmitReview = (skuId, review) =&gt; {<br/>  return this.props.dispatch(initiateAddReview(skuId, review)).then(() =&gt; {<br/>    const { errorMsg } = this.state;</span><span id="0604" class="lc ld iq mb b gy mm mg l mh mi">    if (errorMsg === '') {<br/>      this.setState({ showAddReview: false });<br/>      return true;<br/>    }<br/>  });<br/>};</span><span id="7d7c" class="lc ld iq mb b gy mm mg l mh mi">toggleReview = () =&gt; {<br/>  this.setState((prevState) =&gt; ({ showAddReview: !prevState.showAddReview }));<br/>};</span></pre><p id="30e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为文件顶部的<code class="fe mj mk ml mb b">initiateAddReview</code>添加导入。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="077c" class="lc ld iq mb b gy mf mg l mh mi">import { clearReviews, initiateAddReview } from '../actions/reviews';</span></pre><p id="57b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你的<code class="fe mj mk ml mb b">ProductModal.js</code>文件现在会是这样的。</p><pre class="km kn ko kp gt ma mb mc md aw me bi"><span id="8704" class="lc ld iq mb b gy mf mg l mh mi">import React from 'react';<br/>import Modal from 'react-modal';<br/>import { connect } from 'react-redux';<br/>import ReviewForm from './ReviewForm';<br/>import ProductReviews from './ProductReviews';<br/>import { clearReviews, initiateAddReview } from '../actions/reviews';</span><span id="f345" class="lc ld iq mb b gy mm mg l mh mi">Modal.setAppElement('#root');</span><span id="2749" class="lc ld iq mb b gy mm mg l mh mi">class ProductModal extends React.Component {<br/>  state = {<br/>    showAddReview: this.props.isOpen ? false : true,<br/>    errorMsg: ''<br/>  };</span><span id="4513" class="lc ld iq mb b gy mm mg l mh mi">componentDidUpdate(prevProps, prevState) {<br/>    if (prevProps.error !== this.props.error) {<br/>      this.setState({ errorMsg: this.props.error });<br/>    }<br/>    if (prevProps.isOpen !== this.props.isOpen) {<br/>      const { dispatch, isOpen } = this.props;<br/>      dispatch(clearReviews());<br/>      this.setState({ showAddReview: isOpen ? false : true });<br/>    }<br/>  }</span><span id="6c23" class="lc ld iq mb b gy mm mg l mh mi">handleSubmitReview = (skuId, review) =&gt; {<br/>    return this.props.dispatch(initiateAddReview(skuId, review)).then(() =&gt; {<br/>      const { errorMsg } = this.state;</span><span id="3be7" class="lc ld iq mb b gy mm mg l mh mi">      if (errorMsg === '') {<br/>        this.setState({ showAddReview: false });<br/>        return true;<br/>      }<br/>    });<br/>  };</span><span id="a943" class="lc ld iq mb b gy mm mg l mh mi">toggleReview = () =&gt; {<br/>    this.setState((prevState) =&gt; ({ showAddReview: !prevState.showAddReview }));<br/>  };</span><span id="292a" class="lc ld iq mb b gy mm mg l mh mi">render() {<br/>    const {<br/>      handleProductModalClose,<br/>      isOpen,<br/>      name,<br/>      skuId,<br/>      description,<br/>      price,<br/>      reviews<br/>    } = this.props;</span><span id="257c" class="lc ld iq mb b gy mm mg l mh mi">    const { showAddReview, errorMsg } = this.state;</span><span id="6c90" class="lc ld iq mb b gy mm mg l mh mi">    const customStyles = {<br/>      content: {<br/>        top: '50%',<br/>        left: '50%',<br/>        right: 'auto',<br/>        bottom: 'auto',<br/>        transform: 'translate(-50%, -50%)',<br/>        width: '700px',<br/>        height: '600px',<br/>        display: 'flex',<br/>        boxShadow: '0 0 7px 2px #444'<br/>      }<br/>    };</span><span id="aa20" class="lc ld iq mb b gy mm mg l mh mi">    return (<br/>      &lt;div&gt;<br/>        &lt;Modal<br/>          isOpen={isOpen}<br/>          onRequestClose={handleProductModalClose}<br/>          style={customStyles}<br/>          contentLabel="Product Details"<br/>        &gt;<br/>          &lt;div className="product-details"&gt;<br/>            &lt;div className="close" onClick={handleProductModalClose}&gt;<br/>              x<br/>            &lt;/div&gt;<br/>            &lt;h3 className="heading"&gt;Product Details&lt;/h3&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Sku Id:&lt;/strong&gt;<br/>              &lt;span&gt;{skuId}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Name:&lt;/strong&gt;<br/>              &lt;span&gt;{name}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Description:&lt;/strong&gt;<br/>              &lt;span&gt;{description}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            &lt;p&gt;<br/>              &lt;strong&gt;Price:&lt;/strong&gt;<br/>              &lt;span&gt;{price}&lt;/span&gt;<br/>            &lt;/p&gt;<br/>            {errorMsg &amp;&amp; &lt;p className="errorMsg"&gt;{errorMsg}&lt;/p&gt;}<br/>            &lt;ReviewForm<br/>              showAddReview={showAddReview}<br/>              handleSubmitReview={this.handleSubmitReview}<br/>              toggleReview={this.toggleReview}<br/>              skuId={skuId}<br/>            /&gt;<br/>            &lt;ProductReviews reviews={reviews} /&gt;<br/>          &lt;/div&gt;<br/>        &lt;/Modal&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span><span id="5ec3" class="lc ld iq mb b gy mm mg l mh mi">const mapStateToProps = (state) =&gt; {<br/>  return {<br/>    error: state.error<br/>  };<br/>};</span><span id="b5ac" class="lc ld iq mb b gy mm mg l mh mi">export default connect(mapStateToProps)(ProductModal);</span></pre><p id="559a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在检查应用程序。我们将能够添加新的评论并立即看到它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/908ca0a2169c6a73754383cb9c34987c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sGaNI42IfDK_1vM6OLyqVA.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">添加审阅功能</figcaption></figure><p id="6bc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样。我们已经完成了全栈应用的全部功能。</p><p id="f667" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在<a class="ae lb" href="https://github.com/myogeshchavan97/graphql-fullstack-app/tree/part2_full_stack_app" rel="noopener ugc nofollow" target="_blank">这个分支</a>和主分支<a class="ae lb" href="https://github.com/myogeshchavan97/graphql-fullstack-app" rel="noopener ugc nofollow" target="_blank">这里</a>找到这篇文章的完整源代码</p><p id="1a0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天到此为止。我希望你学到了新东西。</p><p id="320e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">别忘了直接在你的收件箱</strong> <a class="ae lb" href="https://yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">订阅我的每周时事通讯，里面有惊人的技巧、诀窍和文章。</strong> </a></p></div></div>    
</body>
</html>