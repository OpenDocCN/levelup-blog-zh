<html>
<head>
<title>Solving Common Vue Problems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决常见的Vue问题</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/solving-common-vue-problems-8018095804b9?source=collection_archive---------22-----------------------#2020-06-23">https://levelup.gitconnected.com/solving-common-vue-problems-8018095804b9?source=collection_archive---------22-----------------------#2020-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b4d4e2b6d63bde016c42213474a570fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VDD8MCDB0g7JjDJ3"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@memoreno?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马丁·莫雷诺</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="5467" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="06ca" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">这是未定义的</h1><p id="5607" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们偶尔会看到“无法读取未定义的属性‘prop’”错误。</p><p id="b69f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是因为我们只能在组件对象的常规方法中引用<code class="fe mh mi mj mk b">this</code></p><p id="ac2a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="f9f8" class="mt lf it mk b gy mu mv l mw mx">mounted() {<br/>  console.log(this);<br/>}</span></pre><p id="c6f2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="bb99" class="mt lf it mk b gy mu mv l mw mx">new Vue({<br/>  el:'#app',<br/>  created(){<br/>    console.log(this)<br/>  }<br/>});</span></pre><p id="86c4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们总是在方法中使用常规函数来访问<code class="fe mh mi mj mk b">this</code>。箭头函数没有绑定到<code class="fe mh mi mj mk b">this</code>，我们无法访问其中<code class="fe mh mi mj mk b">this</code>的正确值。</p><h1 id="8531" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">属性内插值已被删除错误</h1><p id="a8a1" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过在模板中使用<code class="fe mh mi mj mk b">v-bind</code>或<code class="fe mh mi mj mk b">:</code>语法来解决这个错误。我们不能再使用插值向props传递值了。</p><p id="bb6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们不能写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="de97" class="mt lf it mk b gy mu mv l mw mx">&lt;div id="purchase-{{ item.id }}"&gt;&lt;/div&gt;</span></pre><p id="8b7c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相反，我们必须写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="9483" class="mt lf it mk b gy mu mv l mw mx">&lt;div :id="`purchase-${item.id}`"&gt;&lt;/div&gt;</span></pre><p id="ea66" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="70a4" class="mt lf it mk b gy mu mv l mw mx">&lt;div v-bind:id="`purchase-${item.id}`"&gt;&lt;/div&gt;</span></pre><p id="6781" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">冒号是<code class="fe mh mi mj mk b">v-bind</code>的简写。</p><h1 id="d942" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从子组件更新父数据</h1><p id="95ba" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了从子组件更新父数据，我们可以调用<code class="fe mh mi mj mk b">this.$emit</code>从子组件发出一个事件，并监听父组件中的事件。</p><p id="a17f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:“</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="739b" class="mt lf it mk b gy mu mv l mw mx">Vue.component('child', {<br/>  template: '#child',<br/>  <br/>  props: ['value'],<br/>  methods: {<br/>    updateValue(value) {<br/>      this.$emit('input', value);<br/>    }<br/>  }<br/>});</span></pre><p id="daeb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用值<code class="fe mh mi mj mk b">value</code>发出<code class="fe mh mi mj mk b">input</code>事件。</p><p id="2e79" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以监听<code class="fe mh mi mj mk b">input</code>事件，并通过编写以下内容来设置父状态的值:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="da1d" class="mt lf it mk b gy mu mv l mw mx">&lt;child @input="parentValue = $event"&gt;&lt;/child&gt;</span></pre><p id="4493" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">$event</code>是来自<code class="fe mh mi mj mk b">child</code>的<code class="fe mh mi mj mk b">value</code>的值，并且<code class="fe mh mi mj mk b">parentValue</code>被设置为<code class="fe mh mi mj mk b">$event</code>的值。</p><p id="13f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此<code class="fe mh mi mj mk b">value</code>的值被设置为<code class="fe mh mi mj mk b">parentValue</code>的值。如果我们的组件发出一个<code class="fe mh mi mj mk b">input</code>事件并接受一个<code class="fe mh mi mj mk b">value</code>道具。然后我们可以将两者与<code class="fe mh mi mj mk b">v-model</code>指令结合起来。</p><p id="f75c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，不要写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="7afd" class="mt lf it mk b gy mu mv l mw mx">&lt;child @input="parentValue = $event" :value='parentValue'&gt;&lt;/child&gt;</span></pre><p id="ff59" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="5708" class="mt lf it mk b gy mu mv l mw mx">&lt;child v-model='parentValue'&gt;&lt;/child&gt;</span></pre><h1 id="7718" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">箭头函数不能用作计算属性函数</h1><p id="36fb" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们不能使用对计算属性无效的箭头函数，因为它们没有绑定到<code class="fe mh mi mj mk b">this</code>的正确值。</p><p id="78d5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了在计算的属性函数中获得正确的值<code class="fe mh mi mj mk b">this</code>,我们必须使用常规函数。</p><p id="c1ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，不要写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="a549" class="mt lf it mk b gy mu mv l mw mx">computed:{<br/>  switchRed: () =&gt; {<br/>    return { red: this.turnRed }<br/>  },<br/>}</span></pre><p id="1466" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们写道:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="d019" class="mt lf it mk b gy mu mv l mw mx">computed:{<br/>  switchRed(){<br/>    return { red: this.turnRed }<br/>  },<br/>}</span></pre><h1 id="0313" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">向Vue组件添加外部JS脚本</h1><p id="a41a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过使用<code class="fe mh mi mj mk b">Vue.loadScript</code>方法将外部脚本添加到我们的Vue组件中。</p><p id="68e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="635c" class="mt lf it mk b gy mu mv l mw mx">Vue.loadScript("https://maps.googleapis.com/maps/api/js")</span></pre><h1 id="2ed0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">让VueJS和jQuery玩得更好</h1><p id="c6bd" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们应该只在指令中使用jQuery来操作DOM。</p><p id="7cd7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在其他地方，我们使用Vue的内置功能来呈现我们的页面。</p><p id="89a8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以这样写一个指令:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="7944" class="mt lf it mk b gy mu mv l mw mx">Vue.directive('focus', {<br/>  inserted(el) {<br/>    $(el).focus()<br/>  }<br/>})</span></pre><p id="01fd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将<code class="fe mh mi mj mk b">el</code>DOM element传入<code class="fe mh mi mj mk b">$</code>函数，这样我们就可以对它调用<code class="fe mh mi mj mk b">focus</code>。</p><p id="a953" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以通过写来使用它:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="1a0f" class="mt lf it mk b gy mu mv l mw mx">&lt;input v-focus&gt;</span></pre><h1 id="909b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在同级组件之间通信</h1><p id="418a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以使用mixin来创建一个发出事件的Vue实例。</p><p id="bf17" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="d103" class="mt lf it mk b gy mu mv l mw mx">const eventHub = new Vue();</span><span id="6dd3" class="mt lf it mk b gy my mv l mw mx">Vue.mixin({<br/>  data() {<br/>    return {<br/>        eventHub: eventHub<br/>    }<br/>  }<br/>})</span></pre><p id="adb6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以用它发出一个事件:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="e3a7" class="mt lf it mk b gy mu mv l mw mx">this.eventHub.$emit('update', data)</span></pre><p id="fd78" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我们用<code class="fe mh mi mj mk b">Vue.mixin</code>全局定义了mixin。</p><p id="3b1c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以通过写来听事件:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="0cea" class="mt lf it mk b gy mu mv l mw mx">this.eventHub.$on('update', data =&gt; {<br/>  // do your thing<br/>})</span></pre><p id="8c26" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个更简单的解决方案是使用<code class="fe mh mi mj mk b">thus.$root.$emit</code>发出一个具有给定值的事件:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="2013" class="mt lf it mk b gy mu mv l mw mx">this.$root.$emit('event', data);</span></pre><p id="8a81" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们可以在任何组件中监听它，方法是在组件挂载时向组件添加一个事件监听器:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="aede" class="mt lf it mk b gy mu mv l mw mx">mounted() {<br/>  this.$root.$on('event', data =&gt; {<br/>    console.log(data);<br/>  });<br/>}</span></pre><p id="b893" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，组件将侦听事件。</p><p id="f3e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回调函数有一个<code class="fe mh mi mj mk b">data</code>参数，这个参数包含了发出的数据。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/cc16251697378b145b62f040dc1fb8c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3Y4FzjGP7X2PxY8b"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">亚历山大·杜默在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="9a5a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="50ce" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过使用正则函数来解决<code class="fe mh mi mj mk b">this</code>的很多问题。</p><p id="fa07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<code class="fe mh mi mj mk b">this.$root.$emit</code>可以全局发出事件。</p><p id="f0b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们可以通过从子节点发出事件并在父节点中监听它来在子节点和父节点之间进行交流。</p></div></div>    
</body>
</html>