<html>
<head>
<title>How to Handle States in Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Jetpack撰写中处理状态</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-handle-states-in-jetpack-compose-63e82af2cf4?source=collection_archive---------12-----------------------#2022-03-24">https://levelup.gitconnected.com/how-to-handle-states-in-jetpack-compose-63e82af2cf4?source=collection_archive---------12-----------------------#2022-03-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="930c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有效地使用状态</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d80aab97d1466b71a5bc140487e102e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w746NgXKlWTgNoP-"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@lazycreekimages?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Michael Dziedzic </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="a7b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jetpack compose成为Android家族的重要组成部分之一。这是一个用于构建原生UI的现代工具包。它简化并加速了UI开发，用更少的代码让您的应用变得生动。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e56a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是国家？</h1><p id="9caf" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">根据官方文件:</p><blockquote class="mz na nb"><p id="7b64" class="kz la nc lb b lc ld ju le lf lg jx lh nd lj lk ll ne ln lo lp nf lr ls lt lu im bi translated">应用程序中的状态是可以随时间变化的任何值。这是一个非常宽泛的定义，涵盖了从房间数据库到类变量的所有内容。</p></blockquote><p id="a861" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">向用户显示状态的基本示例是Snackbar，它显示网络错误何时发生。</p><h1 id="910e" class="mc md it bd me mf ng mh mi mj nh ml mm jz ni ka mo kc nj kd mq kf nk kg ms mt bi translated">行动状态</h1><p id="acd8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在Jetpack compose中，像<code class="fe nl nm nn no b">TextField</code>这样的东西不会像在命令式的基于XML的视图中那样自动更新。为了让可组合组件更新，必须明确地告诉它新的状态。例如，如果您运行下面的代码，什么也不会发生。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="0a82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们没有更新<code class="fe nl nm nn no b">TextField</code>的<code class="fe nl nm nn no b">value</code>参数。</p><h1 id="92d8" class="mc md it bd me mf ng mh mi mj nh ml mm jz ni ka mo kc nj kd mq kf nk kg ms mt bi translated">如何处理状态</h1><p id="cad6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以通过使用<code class="fe nl nm nn no b">remember</code> composable来保存值。<code class="fe nl nm nn no b">remember</code>将在初始化期间存储值，并在重组期间返回值。</p><pre class="kj kk kl km gt nr no ns nt aw nu bi"><span id="02c1" class="nv md it no b gy nw nx l ny nz">var name by <em class="nc">remember </em><strong class="no iu">{ </strong><em class="nc">mutableStateOf</em>("") <strong class="no iu">}</strong></span></pre><p id="f5e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nl nm nn no b">by</code>关键字表示Kotlin的属性委托语法。它将允许你把可变的状态字符串展开成一个常规的字符串。因此，名称变量的类型将是字符串。如果我们现在运行下面的代码，我们可以看到值将会改变。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="3ca1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为我们正在更新<code class="fe nl nm nn no b">value</code>参数。</p><p id="2a4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以通过用<code class="fe nl nm nn no b">=</code>符号替换<code class="fe nl nm nn no b">by</code>关键字来使用<code class="fe nl nm nn no b">remember</code> composable。在这种情况下，名称变量的类型将是<code class="fe nl nm nn no b">MutableState&lt;String&gt;</code>。现在，如果我们想要访问<code class="fe nl nm nn no b">name</code>名称变量的值，我们必须使用<code class="fe nl nm nn no b">name.value</code>。</p><pre class="kj kk kl km gt nr no ns nt aw nu bi"><span id="f0ec" class="nv md it no b gy nw nx l ny nz">var name = <em class="nc">remember </em><strong class="no iu">{ </strong><em class="nc">mutableStateOf</em>("") <strong class="no iu">}</strong></span></pre><p id="9276" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我个人喜欢用<code class="fe nl nm nn no b">by</code>关键词。所以我需要写<code class="fe nl nm nn no b">name.value</code>来得到这个值。</p><p id="b42e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nl nm nn no b">remember</code>帮助您在重组过程中保持状态，但是它不会在配置改变时改变状态。为此，必须使用<code class="fe nl nm nn no b">rememberSaveable</code>。<code class="fe nl nm nn no b">rememberSaveable</code>将自动保存任何可以保存在<code class="fe nl nm nn no b">Bundle</code>中的值。</p><h1 id="685d" class="mc md it bd me mf ng mh mi mj nh ml mm jz ni ka mo kc nj kd mq kf nk kg ms mt bi translated">有状态VS无状态</h1><p id="5db4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">顾名思义，Stateful意味着composable内部有一个状态(就像上面的例子)。与此相反的是无状态。这意味着composable中没有状态。有状态可组合总是难以重用和测试。所以你应该总是尝试使用无状态。为了使它无状态，我们将使用状态提升。</p><h1 id="064f" class="mc md it bd me mf ng mh mi mj nh ml mm jz ni ka mo kc nj kd mq kf nk kg ms mt bi translated">状态提升</h1><p id="cee3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">状态提升是一种编程模式，在这种模式下，您可以将可组合的状态移动到该可组合的调用者，从而使可组合成为无状态的。状态提升有很多好处，比如单一的真理源<strong class="lb iu">、</strong>封装、解耦等。实现这一点的简单方法是用一个参数替换状态。现在让我们修改上面的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="7d4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到在我们的<code class="fe nl nm nn no b">Content</code>函数中没有任何状态。我们已经在可组合组件的调用者中移动了状态。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="825a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天到此为止。我希望你学到了新的东西。你的建议对我很有价值。如果你分享你的建议，我将不胜感激。直到我们再次见面…干杯！</p><pre class="kj kk kl km gt nr no ns nt aw nu bi"><span id="74f7" class="nv md it no b gy nw nx l ny nz"><strong class="no iu">Want to Connect? </strong>If you want to, you can connect with me on <a class="ae ky" href="https://twitter.com/FarhanT99598254" rel="noopener ugc nofollow" target="_blank"><strong class="no iu">Twitter</strong></a><strong class="no iu"> </strong>or <a class="ae ky" href="https://www.linkedin.com/in/farhan-tanvir-b08520151/" rel="noopener ugc nofollow" target="_blank"><strong class="no iu">LinkedIn</strong></a></span></pre></div></div>    
</body>
</html>