<html>
<head>
<title>Create tooling to understand AppleScript better— Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建工具以更好地理解AppleScript第2部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tooling-to-explore-applescript-part-2-ed44f511fcb5?source=collection_archive---------10-----------------------#2021-12-02">https://levelup.gitconnected.com/tooling-to-explore-applescript-part-2-ed44f511fcb5?source=collection_archive---------10-----------------------#2021-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d094" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://gentille.us/applescript-articles-7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank"> AppleScript课程</a></h2><div class=""/><div class=""><h2 id="4206" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">让我们再写一些工具来帮助我们理解AppleScript。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5964c8719cc61c044981658875690f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQm4QPXhz-MXxuENNoUD3A.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">AppleScript的更多工具</figcaption></figure><p id="ff2d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">本文显示的所有代码都可以通过</em> <a class="ae mb" href="https://github.com/Rolias/discover-applescript/tree/main/02-Tooling" rel="noopener ugc nofollow" target="_blank"> <em class="ma">关联的GitHub repo </em> </a> <em class="ma">获得。</em></p><h1 id="28a1" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">前情提要…</h1><p id="dde6" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated"><a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/create-tooling-to-understand-applescript-better-part-1-2727d6dbac83?sk=81bc5660e39d50cd0c3b67031b627d9f">在第一部分</a>中，我们见到了脚本编辑器、字典，并了解了系统偏好设置应用程序中的顶层面板。在本文中，我们将继续探索系统首选项，并构建更多的工具来检查窗口、类和锚。</p><h1 id="7d83" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">Windows容器</h1><p id="be01" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">系统偏好词典提到顶层对象包含窗口。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/ddc5f43d6465b755c71cbcc318fcf278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*VLQdrDX6Z0n2Yc-2TwchHw.png"/></div></figure><p id="49c2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们进一步了解这个容器。如果您使用多台显示器，这可以证明是非常宝贵的。输入以下脚本，启动显示器系统偏好设置，然后运行脚本。你的结果会和我的不同。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0231ff86201eda454053055f8e216e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*y7MsaMwaiLSeuRv11W-fqQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">列出“系统偏好设置”的窗口和窗口1。</figcaption></figure><p id="aa40" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这段代码应该看起来很熟悉，我们没有列出<code class="fe nb nc nd ne b">panes</code>，而是列出了<code class="fe nb nc nd ne b">windows</code>。我们没有使用<code class="fe nb nc nd ne b">display dialog</code>，而是使用一个简单的<code class="fe nb nc nd ne b">log</code>命令。如果您有多台显示器，请尝试单击不同显示器上的不同显示首选项窗口。然后运行脚本，注意<code class="fe nb nc nd ne b">window 1</code>返回不同的结果。</p><p id="c889" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">橙色箭头突出显示的行正在进行隐式的<a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW21" rel="noopener ugc nofollow" target="_blank">强制</a>。变量<code class="fe nb nc nd ne b">nameList</code>的类类型为<code class="fe nb nc nd ne b">list</code>，我们希望它的类型为<code class="fe nb nc nd ne b">string</code>或<code class="fe nb nc nd ne b">text.</code>，这允许换行符被用作分隔符。将指示行更改为<code class="fe nb nc nd ne b">log nameList</code>，注意每个条目不再由换行符分隔。最后，试着将那一行改为<code class="fe nb nc nd ne b">log nameList as string</code>，你又得到了一个换行符分隔的列表，这次是通过使用显式强制。</p><h1 id="4438" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">类运算符</h1><p id="244b" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">在这个例子中这似乎并不重要，但是当你得到形式为<code class="fe nb nc nd ne b"><em class="ma">Can’t make «some-name-here» … into type string</em></code> <em class="ma"> </em>的错误时，你就会知道发生了什么。解决这类问题可能需要确切地知道您正在处理的是什么类。幸运的是,<code class="fe nb nc nd ne b"><a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCFEDGB" rel="noopener ugc nofollow" target="_blank">class</a></code>操作符给了我们需要的东西。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/f54b40b6648262334ba864db84b136e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*wjcX2rPVWDoWgEtOvcGcAw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">获取对象或值的类</figcaption></figure><h1 id="55f6" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">锚</h1><p id="a9dc" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">锚允许我们以更精细的粒度操作元素。如果我们返回到系统偏好设置的字典并点击<code class="fe nb nc nd ne b">panes</code>链接，它将向下滚动到<code class="fe nb nc nd ne b">pane</code>部分。我们可以看到一个窗格包含了<code class="fe nb nc nd ne b">anchors</code>。向下滚动到<code class="fe nb nc nd ne b">anchor</code>条目，我们可以看到锚点有一个<code class="fe nb nc nd ne b">name</code>属性，并响应<code class="fe nb nc nd ne b">reveal.</code>让我们使用该信息编写一个新的脚本。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a934d7ee9d7ccae749ffcb4025d39aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*tSreKFstmVBSYzjMajqdfw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">通过名称查找和显示锚点</figcaption></figure><p id="3ecf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这一次，我通过保存和恢复<code class="fe nb nc nd ne b">text item delimiters.</code>成为了一个更好的AppleScript公民。这个脚本使用<code class="fe nb nc nd ne b"><a class="ae mb" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_reference_forms.html#//apple_ref/doc/uid/TP40000983-CH4g-BBCJFIIH" rel="noopener ugc nofollow" target="_blank">every</a></code>引用表单关键字来提取窗格中的每个锚点。因为我想将它们记录为一个可消化的换行分隔列表，所以我只要求锚的<code class="fe nb nc nd ne b">name</code>属性，然后我显式地将它强制为<code class="fe nb nc nd ne b">text.</code>我运行了一次脚本来获取锚的名称，然后我调用应用程序提供的<code class="fe nb nc nd ne b">reveal</code>命令来切换到使用发现的名称的对话框的Arrangement选项卡。</p><h2 id="f168" class="nh md iq bd me ni nj dn mi nk nl dp mm ln nm nn mo lr no np mq lv nq nr ms iw bi translated">🔥小费</h2><p id="5a8e" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">由于我们已经编写了较长的脚本，您可能已经注意到脚本编辑器提供了省略号或浅灰色的代码补全。要查看更多，或接受提供的完成信息，请按<code class="fe nb nc nd ne b">esc</code>键。——<em class="ma">喂，别射信使！</em></p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="d5b9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在下一篇文章的<a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/tooling-to-explore-applescript-part-3-4da8f82fbfa5?sk=8485aceff834ab6eec34d7ad4df85b22">中，我们将讨论嵌套的tell语句、系统事件应用程序和系统事件应用程序的UI元素。参见本系列</a>(目前)所有文章的<a class="ae mb" href="https://gentille.us/7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank">概述。</a></p></div></div>    
</body>
</html>