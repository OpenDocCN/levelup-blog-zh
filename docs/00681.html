<html>
<head>
<title>Classify Hand-Written Digits Using Python and Artificial Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和人工神经网络对手写数字进行分类</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/classify-hand-written-digits-5fdbe5d99ee7?source=collection_archive---------3-----------------------#2019-06-26">https://levelup.gitconnected.com/classify-hand-written-digits-5fdbe5d99ee7?source=collection_archive---------3-----------------------#2019-06-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/87c6133e5e72f41ec88886b421b39d55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ee5sr4o6lAJ6qcdKXhGoFg.png"/></div></div></figure><p id="767c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我将向您展示如何使用<strong class="kd iu"> python编程语言</strong>和一种叫做<strong class="kd iu">人工神经网络的机器学习技术<strong class="kd iu">对来自<strong class="kd iu"> MNIST数据库</strong>的手写数字</strong>进行分类！</strong></p><p id="d61d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于任何想学习神经网络和图像分类如何工作的人来说，这是一个很好的入门程序。当然，有很多文章和程序都非常相似，比如https://keras.io/examples/vision/mnist_convnet/。</p><p id="6c65" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以，你可能会说，为什么要就这个话题再写一篇文章呢？之所以这样，是因为我相信，从不同的人那里获得不同的观点、看法和解释，有助于真正理解一个话题、主题或问题。话虽如此，这段代码的全部功劳归于<a class="ae kz" href="https://victorzhou.com/" rel="noopener ugc nofollow" target="_blank">维克托·周</a>。</p><p id="4c3d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你不想读这篇文章，想要一个视频演示，你可以看看下面的<a class="ae kz" href="https://www.youtube.com/watch?v=kOFUQB7u5Ck" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">视频</strong> </a>。它详细介绍了本文中的所有内容，并且将有助于您轻松地开始编写自己的人工神经网络(ANN)模型，即使您的计算机上没有安装编程语言Python。或者你可以把视频和这篇文章都作为学习安氏症的补充材料！</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><h1 id="8726" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">开始编程:</h1><p id="206d" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated">首先我会写一份这个程序将会做什么的描述。这样当我将来回头看它的时候，我或者其他人就知道它到底在做什么。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="5fc1" class="mo lh it mk b gy mp mq l mr ms"># Description: This program classifies the MNIST handwritten digit images as a number 0 - 9</span></pre><p id="5641" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我需要<strong class="kd iu">安装依赖项/包</strong>。如果您还没有安装这些包，请在您的终端、命令提示符或Google Colab网站(取决于您安装python编程语言的位置)中运行以下命令。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="2852" class="mo lh it mk b gy mp mq l mr ms">pip install tensorflow keras numpy mnist matplotlib</span></pre><p id="9083" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我已经安装完了所有必要的包，我想把这些包导入到我的程序中。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="8d76" class="mo lh it mk b gy mp mq l mr ms">#Import the packages / dependencies<br/>import numpy as np <br/>import mnist #Get data set from <br/>import matplotlib.pyplot as plt #Graph<br/>from keras.models import Sequential #ANN architecture<br/>from keras.layers import Dense #The layers in the ANN<br/>from keras.utils import to_categorical</span></pre><p id="788a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，<strong class="kd iu">将数据集</strong>加载到变量<code class="fe mt mu mv mk b">train_images</code>(包含要训练的图像的变量)、<code class="fe mt mu mv mk b">train_labels</code>(包含训练集中图像的标签的变量)、<code class="fe mt mu mv mk b">test_images</code>(包含要测试的图像的变量)和<code class="fe mt mu mv mk b">test_labels</code>(包含测试集中图像的标签的变量)。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="6ce9" class="mo lh it mk b gy mp mq l mr ms">#Load the data set<br/>train_images = mnist.train_images() #training data images<br/>train_labels = mnist.train_labels() #training data labels<br/>test_images = mnist.test_images() #training data images<br/>test_labels = mnist.test_labels() #training data labels</span></pre><p id="9dbb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">数据被加载到变量中，现在<strong class="kd iu">操纵数据</strong>使其更容易训练模型。这可以通过首先将像素值原始范围值从[0，255]更改为[-0.5，0.5]来实现，然后将图像从二维28 x 28像素展平为28 = 784一维向量。然后打印火车的新形状和测试图像。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="8aac" class="mo lh it mk b gy mp mq l mr ms">#Normalize the images. Normalize the pixel values from [0, 255] to<br/># [-0.5 , 0.5] to make our network easier to train<br/>train_images = (train_images/255) - 0.5<br/>test_images = (test_images/255) - 0.5<br/>#Flatten the images. Flatten each 28x28 image into a 28^2 = 784 dimensional vector <br/>#to pass into the neural network<br/>train_images = train_images.reshape((-1,784))<br/>test_images = test_images.reshape((-1,784))<br/>#Print the shape <br/>print(train_images.shape)# 60,000 rows and 784 cols<br/>print(test_images.shape) # 10,000 rows and 784 cols</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/6f13aed418a1ce9a2c6476566823083d.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*6w_c2cecHcxO_KvM-O60Jg.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated"><strong class="bd li">顶部:</strong> train_images = 60，000行784列<strong class="bd li">底部:</strong> test_images = 10，000行784列</figcaption></figure><p id="cb0c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">建立3层模型</strong>(2层64个神经元和ReLu函数&amp; 1层10个神经元和Softmax函数)。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="cf7c" class="mo lh it mk b gy mp mq l mr ms">#Build the model<br/># 3 layers, 2 layers with 64 neurons and the relu function<br/># 1 layer with 10 neurons and softmax function<br/>model = Sequential()<br/>model.add( Dense(64, activation='relu', input_dim=784))<br/>model.add( Dense(64, activation='relu'))<br/>model.add(Dense(10, activation='softmax'))</span></pre><p id="806b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">使用损失函数<code class="fe mt mu mv mk b">categorical_crossentropy</code>编译模型</strong>，该函数用于大于2的类，因为我们将有10个类，所以我们将使用该函数。这些类是从0到9的数字，例如:0，1，2，3，…9。我还将添加一个指标来显示模型的准确性。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="3f20" class="mo lh it mk b gy mp mq l mr ms">#Compile the model<br/>#The loss function measures how well the model did on training , and then tries <br/>#to improve on it using the optimizer<br/>model.compile(<br/>  optimizer='adam',<br/>    loss = 'categorical_crossentropy', #(classes that are greater than 2) <br/>    metrics = ['accuracy']<br/>)</span></pre><p id="3bca" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">使用<code class="fe mt mu mv mk b">train_images</code>和<code class="fe mt mu mv mk b">train_labels</code>变量(包含训练数据的变量/数据集)训练模式</strong> l。我将在整个数据集上迭代5次进行训练，每次梯度更新32个样本进行训练。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="ac51" class="mo lh it mk b gy mp mq l mr ms">#Train the model<br/>model.fit(<br/>  train_images,<br/>    to_categorical(train_labels), # Ex. 2 it expects [0, 0 ,1,0, 0, 0,0,0,0,0]<br/>    epochs = 5, #The number of iterations over the entire dataset to train on<br/>    batch_size=32 #the number of samples per gradient update for training<br/>)</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/efc1ad8c91b96ab20d062d951255b456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wsGPP44o_lef_0VD8Klq-Q.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">每个训练步骤/时期的模型损失和准确性</figcaption></figure><p id="68ec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在是时候<strong class="kd iu">评估模型</strong>了，看看它在测试数据集上的表现如何。该模型表现良好，准确率约为96.33%。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="e5df" class="mo lh it mk b gy mp mq l mr ms">#Evaluate the model<br/>model.evaluate(<br/>  test_images, <br/>  to_categorical(test_labels)<br/>)</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nc"><img src="../Images/208c175250390650803e1d422a739967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4V3Z3mnKg2WQO4gLMOEV0A.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">图像显示损失约为0.125，准确度约为96.33%</figcaption></figure><p id="6a6b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">注意:</strong>您可以将该模型保存在一个. h5文件中，以便以后在另一个程序中使用该模型/模型权重。确保包括您想要保存模型/文件的位置。例如'<strong class="kd iu"> Desktop/model.h5 </strong>'。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="c751" class="mo lh it mk b gy mp mq l mr ms">#model.save_weights('model.h5')</span></pre><p id="535f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">利用模型做出预测。我将使用这个模型预测前5个测试图像的类别，以及实际的标签。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="61f9" class="mo lh it mk b gy mp mq l mr ms">#predict on the first 5 test images<br/>predictions = model.predict(test_images[:5])<br/>#print our models prediction <br/>print(np.argmax(predictions, axis = 1))<br/>print(test_labels[:5])</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/3bdfac4d77e2f2c201b7e600fdb24811.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*GSRJn7tt5NSUnLmJ0UxVrg.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">模型的预测和实际标签</figcaption></figure><p id="f0ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，我会将手写图像打印到屏幕上。更具体地说，我将把测试数据的前5幅图像以28 x 28像素的灰色打印到屏幕上。</p><pre class="la lb lc ld gt mj mk ml mm aw mn bi"><span id="5b71" class="mo lh it mk b gy mp mq l mr ms"><strong class="mk iu">import</strong> <strong class="mk iu">matplotlib.pyplot</strong> <strong class="mk iu">as</strong> <strong class="mk iu">plt</strong><br/><strong class="mk iu">for</strong> i <strong class="mk iu">in</strong> range(0,5):<br/>  first_image = test_images[i]<br/>  first_image = np.array(first_image, dtype='float')<br/>  pixels = first_image.reshape((28, 28))<br/>  plt.imshow(pixels, cmap='gray')<br/>  plt.show()</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2431d9855bd86a49e872e4d3dc3a43f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*saxaPzJEzixRFmCrEODUxQ.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">手写数字7的图像</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ad82e84bdc2f9f46a45e324dc42b09f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*7Q9-lT0vyEYjZ6uZ6S_XNA.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">手写数字2的图像</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/ba84b8821449fae82c628816c2a9e85e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*9MeIo3PCZBRqwr-UnKMZkg.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">手写数字1的图像</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0465d3d333b02ca936934a64795b8a4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*IM08ujJT_XOu621-ut4_xg.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">手写数字0的图像</figcaption></figure><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/570f67b256f75aca1ef5c4e7389d22b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*KBue-jN2Z2hxvIW8T963yA.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">手写数字4的图像</figcaption></figure><p id="b5f9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可以看上面的视频，了解我是如何编写这个程序的，并和我一起编写一些更详细的解释，或者你可以点击这里的<a class="ae kz" href="https://www.youtube.com/watch?v=kOFUQB7u5Ck" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu"> YouTube链接</strong> </a>。</p><p id="200b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您也有兴趣阅读更多关于机器学习的内容，以便立即开始处理问题和示例，那么我强烈建议您查看<a class="ae kz" href="https://www.amazon.com/gp/product/1491962291?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;linkCode=xm2&amp;creativeASIN=1491962291" rel="noopener ugc nofollow" target="_blank">使用Scikit-Learn和TensorFlow进行机器学习实践:构建智能系统的概念、工具和技术</a>。这是一本帮助初学者学习如何编写机器学习程序和理解机器学习概念的好书。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><a href="https://www.amazon.com/gp/product/1491962291/ref=as_li_tl?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=1491962291&amp;linkId=b7cc2001f37665b84139089c59ef8571"><div class="gh gi ni"><img src="../Images/1c76ef57958bdd4cc146d282c7210ac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*3lz1m4uotU9HRQNNFMftIw.png"/></div></a><figcaption class="mx my gj gh gi mz na bd b be z dk translated"><a class="ae kz" href="https://www.amazon.com/gp/product/1491962291?ie=UTF8&amp;tag=medium074-20&amp;camp=1789&amp;linkCode=xm2&amp;creativeASIN=1491962291" rel="noopener ugc nofollow" target="_blank">使用Scikit-Learn和TensorFlow进行机器实践学习:构建智能系统的概念、工具和技术</a></figcaption></figure><p id="cb62" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢你阅读这篇文章，希望对你有所帮助！如果你喜欢这篇文章，并发现它很有帮助，请留下一些掌声，以示感谢。坚持学习，如果你喜欢机器学习、数学、计算机科学、编程或算法分析，请访问并订阅我的<a class="ae kz" href="https://www.youtube.com/channel/UCaV_0qp2NZd319K4_K8Z5SQ" rel="noopener ugc nofollow" target="_blank"> YouTube </a>频道(<a class="ae kz" href="https://www.youtube.com/channel/UCaV_0qp2NZd319K4_K8Z5SQ" rel="noopener ugc nofollow" target="_blank">randers 112358</a>&amp;<a class="ae kz" href="https://www.youtube.com/channel/UCbmb5IoBtHZTpYZCDBOC1CA" rel="noopener ugc nofollow" target="_blank">compsci 112358</a>)。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/2a89248dffd216add5796b8f86401da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/0*LqqAeB4YcubTeHu7.png"/></div></figure><h1 id="0618" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">功劳归于:</h1><p id="1fbe" class="pw-post-body-paragraph kb kc it kd b ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku mi kw kx ky im bi translated">[1]<a class="ae kz" href="https://victorzhou.com/blog/keras-neural-network-tutorial/" rel="noopener ugc nofollow" target="_blank">https://victorzhou.com/blog/keras-neural-network-tutorial/</a></p></div></div>    
</body>
</html>