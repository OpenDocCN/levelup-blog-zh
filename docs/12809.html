<html>
<head>
<title>Building a Conflict-free UI with Leasing and Heartbeat using Django REST and Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Django REST和Vue.js构建带有租赁和心跳的无冲突UI</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-a-conflict-free-ui-with-leasing-and-heartbeat-using-django-rest-and-vue-js-e7027c37e688?source=collection_archive---------14-----------------------#2022-07-11">https://levelup.gitconnected.com/building-a-conflict-free-ui-with-leasing-and-heartbeat-using-django-rest-and-vue-js-e7027c37e688?source=collection_archive---------14-----------------------#2022-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="89b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于如何实现无冲突UI的概念证明(POC)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/7490dd04a98129e1f9b2dae9cc54649f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vjHNI7RXKHrG2ycfYX6aiw.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">DALL-E生成的图像</figcaption></figure><h1 id="3c6c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">背景</h1><p id="fd42" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">设想一个系统，其中有许多用户需要编辑队列中的几个表单。还可以想象这些表单有多个冗长的部分。可能会出现多个用户开始编辑同一个表单并填写大量字段的情况。当他们点击save时，其中一个人会得到一个错误消息，说有一个“过时的异常”,因为表单已经被其他人编辑过了。或者更糟的是，用户的一个更改丢失了，用户甚至没有得到一个异常。所以用户的所有工作都白费了。这是不理想的，因为事倍功半，所以我们想找到解决这个问题的方法。</p><p id="368e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种冗长表格的一个真实例子是政府机构可能有的申请批准表格。这些文档通常会分配给多个需要审查外部应用程序并向应用程序添加更多元数据的应用程序评估员。</p><h1 id="db8c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">解决办法</h1><p id="3a01" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">这个问题的一个很好的解决方案是使用“带心跳的租赁”算法，这种算法通常用在分布式系统中，用于维护对任何给定实体的锁定。使用这种算法的分布式系统的一个例子是Google文件系统(GFS) <a class="ae me" href="https://static.googleusercontent.com/media/research.google.com/en//archive/gfs-sosp2003.pdf" rel="noopener ugc nofollow" target="_blank"> paper </a>。</p><p id="b21f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其思想是，更新文档的用户也将保持该文档的锁，并将定期向服务器发送心跳消息以延长该锁。这样，只要用户的页面保持打开，用户就可以保持锁定状态，并可以继续更新文档。如果在配置的超时期限内没有心跳发送到服务器，服务器不会延长租期，因此锁将自动过期。那么下一个用户可以获得锁。</p><blockquote class="mf mg mh"><p id="f6de" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">如果用户“Alice”正在编辑文档“A ”,那么数据库将有一个条目，文档“A”被锁定直到某个时间段。<br/>如果用户“鲍勃”在锁定未过期的情况下打开页面，“鲍勃”甚至不被允许开始编辑表单，他将看到一条消息，表明表单已被锁定。如果“Alice”关闭了她的网页，那么一段时间后锁定被释放，因此“Bob”可以在以后需要时开始处理该文档。</p></blockquote><p id="2097" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这解决了浪费用户精力的问题，因为我们先发制人地用一个明确的信息告诉用户这个页面正被其他人编辑。我们的clear消息还可以包含正在编辑页面的其他用户的姓名，以及页面被锁定为扩展的时间。</p><p id="e623" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面，我们将深入探讨如何实现这一概念验证的技术细节。我们使用一个示例项目，用户可以在其中添加/编辑/创建注释。</p><p id="f65f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">概念验证的代码可以在GitHub的资源库中找到，可以在<a class="ae me" href="https://github.com/fatse/django-vuejs-heartbeat" rel="noopener ugc nofollow" target="_blank">这个链接</a>中找到。</p><p id="95f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">使用的技术:</strong></p><blockquote class="mf mg mh"><p id="7e97" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><a class="ae me" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">Python 3.10</a><br/><a class="ae me" href="https://docs.djangoproject.com/en/4.0/intro/install/" rel="noopener ugc nofollow" target="_blank">Django 4.0<br/></a><a class="ae me" href="https://v2.vuejs.org/v2/guide/installation.html" rel="noopener ugc nofollow" target="_blank">vue . js 2 . 7 . 0</a><br/>T14】Django REST框架 (DRF)</p></blockquote><p id="4e80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mi">注意:本文假设你已经了解了Django和DRF的基础知识。</em></p><p id="a562" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将按照以下步骤创建Notes web应用程序:</p><ol class=""><li id="7ec0" class="mm mn iq jp b jq jr ju jv jy mo kc mp kg mq kk mr ms mt mu bi translated"><a class="ae me" href="#594e" rel="noopener ugc nofollow">建立Django项目</a></li><li id="d2f2" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><a class="ae me" href="#a1eb" rel="noopener ugc nofollow">创建数据库模型</a></li><li id="9240" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><a class="ae me" href="#3867" rel="noopener ugc nofollow">创建CRUD API</a></li><li id="2ba3" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><a class="ae me" href="#8359" rel="noopener ugc nofollow">创建心跳API </a></li></ol><blockquote class="na"><p id="ab60" class="nb nc iq bd nd ne nf ng nh ni nj kk dk translated">对于只对使用heartbeat实现租赁感兴趣的读者，请阅读第<a class="ae me" href="#8359" rel="noopener ugc nofollow"> 4节。创建心跳API </a>。</p></blockquote></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="594e" class="lb lc iq bd ld le nr lg lh li ns lk ll lm nt lo lp lq nu ls lt lu nv lw lx ly bi translated">1.建立Django项目</h1><p id="8039" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">在这一步，我们将构建一个基本的Django应用程序。当开始一个Django项目时，会涉及到一些样板代码，所以我将使用下面的<a class="ae me" href="https://github.com/fatse/django-vuejs-heartbeat/blob/main/django_boilerplate.sh" rel="noopener ugc nofollow" target="_blank"> shell脚本</a>包含建立一个Django项目的所有样板步骤。</p><p id="ada3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mi">请注意，您可以按照相同的顺序在终端上运行这些命令。</em></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="da6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，我们的基本Django项目应该已经启动并运行，当您在浏览器中打开<code class="fe ny nz oa ob b"><a class="ae me" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/</a></code>并看到火箭时，一切都很好:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oc"><img src="../Images/e530b07291e20f87ee21894df96161de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*u24HhdH46uGxyrNHKSuToA.gif"/></div></div></figure><p id="a4e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">成功创建新应用程序后，我们必须将其添加到<strong class="jp ir"> settings.py </strong>文件中的<strong class="jp ir"> INSTALLED_APPS </strong>中。</p><p id="3d1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mi">注:</em>我们还得在INSTALLED_APPS中添加<em class="mi"/><strong class="jp ir">‘rest _ framework’</strong>。因此，此时INSTALLED_APPS列表将如下所示:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="d6d9" class="oh lc iq ob b gy oi oj l ok ol">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',    <br/>    <br/><strong class="ob ir">    'rest_framework',<br/>    'notes_app',</strong><br/>]</span></pre><p id="6a64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">项目树应该是这样的:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="b84d" class="oh lc iq ob b gy oi oj l ok ol">django-vuejs-heartbeat<br/>├── notes_app<br/>│   ├── __init__.py<br/>│   ├── admin.py<br/>│   ├── apps.py<br/>│   ├── migrations<br/>│   │   └── __init__.py<br/>│   ├── models.py<br/>│   ├── tests.py<br/>│   └── views.py<br/>├── manage.py<br/>├── notes_heartbeat_project<br/>│   ├── __init__.py<br/>│   ├── asgi.py<br/>│   ├── settings.py<br/>│   ├── urls.py<br/>│   └── wsgi.py<br/>└── env</span></pre><h1 id="a1eb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">2.创建数据库模型</h1><p id="3fe8" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我们需要创建一个名为Note的模型</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="9890" class="oh lc iq ob b gy oi oj l ok ol">from django.db import models<br/><br/><br/>class Note(models.Model):<br/>    title = models.CharField(max_length=255, blank=True, null=True)<br/>    content = models.TextField(blank=True, null=True)<br/>    last_updated_on = models.DateTimeField(auto_now=True)<br/><br/>    def __str__(self):<br/>        return self.title</span></pre><p id="c45a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建一个名为serializers.py的新python文件，并添加序列化模型</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="d559" class="oh lc iq ob b gy oi oj l ok ol">from rest_framework import serializers<br/><br/>from notes_heartbeat.notes_app.models import Note<br/><br/><br/>class NoteSerializer(serializers.ModelSerializer):<br/>    class Meta:<br/>        model = Note<br/>        fields = ('id', 'title', 'content', 'last_updated_on',)</span></pre><p id="7199" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行迁移以在数据库中创建新的注释模型</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="6941" class="oh lc iq ob b gy oi oj l ok ol">python manage.py makemigrations<br/>python manage.py migrate</span></pre><p id="7a32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您在运行以上命令后看到类似这样的内容，您就知道迁移成功运行了:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="9c4f" class="oh lc iq ob b gy oi oj l ok ol">~django-vuejs-heartbeat/notes_heartbeat_project ❯ <strong class="ob ir">python manage.py makemigrations</strong>                                                                                                      <br/>Migrations for 'notes_app':<br/>  notes_app/migrations/0001_initial.py<br/>    - <strong class="ob ir">Create model Note</strong></span><span id="60f9" class="oh lc iq ob b gy om oj l ok ol">~/django-vuejs-heartbeat/notes_heartbeat_project ❯ <strong class="ob ir">python manage.py migrate</strong>                                                                                                             <br/>Operations to perform:<br/>  Apply all migrations: admin, auth, contenttypes, notes_app, sessions<br/>Running migrations:<br/>  <strong class="ob ir">Applying notes_app.0001_initial... OK</strong></span></pre><h1 id="3867" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">3.创建CRUD APIs</h1><p id="273e" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">现在让我们创建API来创建新的注释、编辑注释、删除注释或查看注释。</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="c75c" class="oh lc iq ob b gy oi oj l ok ol">from rest_framework.viewsets import ModelViewSet<br/><br/>from .models import Note<br/>from .serializers import NoteSerializer<br/><br/><br/>class NoteViewSet(ModelViewSet):<br/>    queryset = Note.objects.all()<br/>    serializer_class = NoteSerializer</span></pre><p id="f3c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，我们只编写了几行代码，并且创建了基本的创建、检索、更新和删除API。姜戈太棒了！！！为了访问这些API，我们必须将路由器添加到URL中。我们可以如下图所示。</p><blockquote class="mf mg mh"><p id="7220" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">在</em> <strong class="jp ir"> <em class="iq">下新建一个文件</em><strong class="jp ir"><em class="iq">routers . py</em></strong><em class="iq">并添加下面的代码。</em></strong></p></blockquote><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="44e2" class="oh lc iq ob b gy oi oj l ok ol">from rest_framework import routers<br/><br/>from notes_app.views import NoteViewSet<br/><br/>router = routers.DefaultRouter()<br/>router.register(r'note', NoteViewSet, basename='note')</span></pre><blockquote class="mf mg mh"><p id="0f5f" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">在</em><strong class="jp ir"><em class="iq">notes _ app</em></strong><em class="iq">文件夹下新建一个</em><strong class="jp ir"><em class="iq">URLs . py</em></strong><em class="iq">文件，并将新建的路由器添加到其中。</em></p></blockquote><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="00fc" class="oh lc iq ob b gy oi oj l ok ol">from django.urls import path, include<br/><br/>from notes_heartbeat_project.routers import router<br/><br/>urlpatterns = [<br/>    path('api/', include(router.urls)),<br/>]</span></pre><blockquote class="mf mg mh"><p id="baa2" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">将</em><strong class="jp ir"><em class="iq">notes _ app</em></strong><em class="iq">的网址追加到</em><strong class="jp ir"><em class="iq">notes _ heart beat _ project</em></strong><em class="iq">文件夹下的</em><strong class="jp ir"><em class="iq">URLs . py</em></strong><em class="iq">中。</em></p><p id="49ae" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">里面的代码</em><strong class="jp ir"><em class="iq">notes _ heart beat _ project/URLs . py</em></strong><em class="iq">现在看起来是这样的:</em></p></blockquote><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="9396" class="oh lc iq ob b gy oi oj l ok ol">from django.contrib import admin<br/>from django.urls import path, include<br/><br/>urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('', include('notes_app.urls'))<br/>]</span></pre><p id="848d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至此，我们已经准备好使用可浏览的DRF API测试我们的API。这些是我们的API:</p><ul class=""><li id="4278" class="mm mn iq jp b jq jr ju jv jy mo kc mp kg mq kk on ms mt mu bi translated">GET:<a class="ae me" href="http://127.0.0.1:8090/api/note/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/API/note/</a></li><li id="c1ae" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk on ms mt mu bi translated">POST:<a class="ae me" href="http://127.0.0.1:8090/api/note/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/API/note/</a></li><li id="1a3f" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk on ms mt mu bi translated">放:<a class="ae me" href="http://127.0.0.1:8090/api/note/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/API/note/</a>{ note _ id }/</li><li id="5233" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk on ms mt mu bi translated">删除:<a class="ae me" href="http://127.0.0.1:8090/api/note/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/API/note/</a>{ note _ id }/</li></ul><p id="b056" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用新创建的API链接添加、更新或删除新的注释。例如，如果您想要更新或删除一个现有的注释，您可以使用Django REST可浏览API来完成，如下图所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oo"><img src="../Images/2fe3c8f88e3a2b342cfe4f1deebea31b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*isz7LG4hIoJfKBC7Uph7Kw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">用于上传/删除方法的DRF可浏览API</figcaption></figure><p id="a4d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面的截图来看:</p><p id="4ae7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 1 → </strong>显示了允许我们访问id=2的注释的上传/删除方法API的URL:<a class="ae me" href="http://127.0.0.1:8000/api/note/2/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/API/note/2/</a><br/><strong class="jp ir">2→</strong>使用上传按钮，我们可以更新id=2的注释<br/> <strong class="jp ir"> 3 → </strong>使用删除按钮，我们可以删除注释</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="f782" class="lb lc iq bd ld le nr lg lh li ns lk ll lm nt lo lp lq nu ls lt lu nv lw lx ly bi translated">3.1前端代码</h1><p id="4b84" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">让我们为到目前为止已经构建好的后端添加UI并使用它。<br/>Notes应用的前端部分我会用Vue.js。现在我们已经有了可以工作的API，我们将添加Django模板，以便于我们添加新的注释或者编辑/删除它们。</p><p id="ac3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是<strong class="jp ir"> notes_app/views.py </strong>中“笔记更新”视图的代码:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="7040" class="oh lc iq ob b gy oi oj l ok ol">class NoteUpdateView(UpdateView):<br/>    template_name = 'notes_app/note_edit.html'<br/>    model = Note<br/>    fields = ['title', 'content']</span></pre><p id="90e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并将网址添加到<strong class="jp ir"> notes_app/urls.py </strong>，网址现在如下所示:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="7529" class="oh lc iq ob b gy oi oj l ok ol">urlpatterns = [<br/>    path('', TemplateView.as_view(template_name='notes_app/notes.html')),<br/>    path('api/', include(router.urls)),<br/>    path('note/&lt;int:pk&gt;/update/', NoteUpdateView.as_view(), name='note_update'),<br/>]</span></pre><p id="4176" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在将添加Vue.js部分，在这里我们将创建使用UI执行CRUD操作所需的函数。我们获取所有注释并用所有注释填充登录页面的代码如下所示:</p><p id="4c2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1.1 </strong> <strong class="jp ir">用Django配置vue . js</strong></p><p id="4351" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用我们的项目配置Vue.js最简单的方法是将Vue.js的CDN添加到notes _ app/templates/notes _ app/index . html中。</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="5673" class="oh lc iq ob b gy oi oj l ok ol">&lt;script src="https://cdn.jsdelivr.net/npm/vue@2.7.0/dist/vue.js"&gt;&lt;/script&gt;</span></pre><p id="9882" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mi">index.html的完整代码可以在</em> <a class="ae me" href="https://github.com/fatse/django-vuejs-heartbeat/blob/main/notes_heartbeat_project/notes_app/templates/notes_app/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="mi">这里</em> </a> <em class="mi">找到。</em></p><p id="a606" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1.2添加Vue实例以使用Django </strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="e28e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1.3为更新注释API添加Vue.js功能</strong></p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="ee21" class="oh lc iq ob b gy oi oj l ok ol">BASE_URL = 'http://127.0.0.1:8090/'<br/>BACKEND_PATH = 'api/note/'<br/>new Vue({<br/>    el: '#note_edit',<br/>    delimiters: ['[[', ']]'],<br/>    data: {<br/>        <strong class="ob ir">current_note</strong>: <em class="mi">note_obj</em>,<br/>        message: false,<br/>    },<br/>    methods: {<br/>        <strong class="ob ir">updateNote</strong>: function () {<br/>            this.loading = true;<br/>            <strong class="ob ir">this.$http.put(`${BASE_URL + BACKEND_PATH + this.current_note.id}/`, this.current_note)<br/>                .then((response) =&gt; {<br/>                    this.current_note = response.data;<br/>                    this.message = true;<br/>                })<br/>                .catch((err) =&gt; {<br/>                    this.message = false;<br/>                    <em class="mi">console</em>.log(err);<br/>                })</strong><br/>        },<br/>        closeWindow: function () {<br/>            <em class="mi">window</em>.close()<br/>        }<br/>    },<br/>});</span></pre><p id="d865" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1.4添加Django模板以在登录页面显示注释列表。</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="ed97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1.5添加模板更新单数备注。</strong></p><p id="6de9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在notes_app/templates/notes_app文件夹下添加这个<strong class="jp ir"> note_edit.html </strong>模板。</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="18dd" class="oh lc iq ob b gy oi oj l ok ol">{% extends 'notes_app/index.html' %}<br/><br/>{% block content %}<br/>    &lt;div id="note_edit"&gt;<br/><strong class="ob ir">        {% include 'notes_app/partials/edit.html' %}</strong><br/>    &lt;/div&gt;<br/>{% endblock content %}<br/><br/>{% block scripts %}<br/>    {% load static %}<br/>    &lt;script&gt;<br/>        let <strong class="ob ir"><em class="mi">note_obj </em></strong>= {<br/>            id: '<strong class="ob ir">{{ object.id }}</strong>',<br/>            title: '<strong class="ob ir">{{ object.title|escapejs }}</strong>',<br/>            content: '<strong class="ob ir">{{ object.content|escapejs }}</strong>'<br/>        };<br/>    &lt;/script&gt;<br/>    <strong class="ob ir">&lt;script src="{% static 'notes_app/js/note_edit.js' %}"&gt;&lt;/script&gt;</strong><br/>{% endblock scripts %}</span></pre><p id="8cf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在partials文件夹中添加<em class="mi">编辑partial </em> : <br/>，即notes _ app/templates/notes _ app/<strong class="jp ir">partials</strong>添加<strong class="jp ir">edit.html</strong>partial，代码为:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="93ca" class="oh lc iq ob b gy oi oj l ok ol">&lt;div v-if="message"&gt;<br/>    &lt;div class="container"&gt;<br/>        &lt;div class="alert alert-success alert-dismissable" role="alert"&gt;<br/>            &lt;button type="button" class="close" data-dismiss="alert" aria-label="Close"&gt;<br/>                &lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt;<br/>            &lt;/button&gt;<br/>            Note updated successfully.<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;<br/><br/>{% csrf_token %}<br/>&lt;form <strong class="ob ir">v-on:submit.prevent="updateNote()"</strong>&gt;<br/>    &lt;div class="modal-body"&gt;<br/>        &lt;div class="form-group"&gt;<br/>            &lt;label for="note_title"&gt;Title&lt;/label&gt;<br/>            &lt;input<br/>                    type="text"<br/>                    class="form-control"<br/>                    id="note_title"<br/>                    placeholder="Enter Note Title"<br/>                    <strong class="ob ir">v-model="current_note.title"</strong><br/>                    required="required"&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="form-group"&gt;<br/>            &lt;label for="note_content"&gt;Content&lt;/label&gt;<br/>            &lt;textarea<br/>                    class="form-control"<br/>                    id="note_content"<br/>                    placeholder="Enter Note Content"<br/>                    <strong class="ob ir">v-model="current_note.content"</strong><br/>                    required="required"<br/>                    rows="3"&gt;&lt;/textarea&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="modal-footer"&gt;<br/>        &lt;button type="button" class="btn btn-secondary m-progress" @click="closeWindow()"&gt;<br/>            Close<br/>        &lt;/button&gt;<br/>        &lt;button type="submit" class="btn btn-primary"&gt;Save changes&lt;/button&gt;<br/>    &lt;/div&gt;<br/>&lt;/form&gt;</span></pre><p id="9975" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经添加了使用UI添加/编辑/删除注释所需的所有功能，我们的应用程序如下面的屏幕截图所示。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi op"><img src="../Images/5f05a3c67f15d8caeaa0a1801c8c7974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qOYYyeYYM1Y7XNVU323hEA.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">编辑注释—冲突的用户界面</figcaption></figure><p id="149c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述场景中发生了什么？</p><blockquote class="mf mg mh"><p id="0469" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">1.登录页面显示笔记列表</p><p id="deda" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">2.用户1打开note_id=1并编辑它</p><p id="02fc" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">3.User2也打开note_id=1并编辑它</p><p id="ba16" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">4.用户1不知道用户2的动作，因此认为他们有note_id=1的更新版本</p><p id="7e7f" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">5.用户2也不知道用户1正在更新note_id=1</p><p id="5c92" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">6.用户1和用户2提交表单并保存更改</p><p id="2648" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">7.数据库保存note_1=1的最后更新版本</p><p id="5a52" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">8.用户1的更改已丢失或用户2的更改已丢失，这取决于哪个数据库保存操作先成功。</p></blockquote><blockquote class="na"><p id="33b5" class="nb nc iq bd nd ne nf ng nh ni nj kk dk translated">“心跳租赁”来拯救。</p></blockquote><h1 id="8359" class="lb lc iq bd ld le lf lg lh li lj lk ll lm oq lo lp lq or ls lt lu os lw lx ly bi translated">4.创建心跳API</h1><p id="5c8d" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">在本节中，我们将创建心跳API并修复上述问题。</p><p id="9395" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.1将“last_updated_on”字段添加到笔记模型</strong></p><p id="541b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们在<strong class="jp ir"> notes_app/models.py </strong>中的模型看起来如下:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="31d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.2向序列化添加字段</strong></p><p id="b08d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还必须更新注释模型的序列化，并向其中添加新的字段。<strong class="jp ir">notes _ app/serializer . py</strong>中更新后的序列化器类如下:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="5c12" class="oh lc iq ob b gy oi oj l ok ol">from rest_framework import serializers<br/><br/>from .models import Note<br/><br/><br/>class NoteSerializer(serializers.ModelSerializer):<br/>    class Meta:<br/>        model = Note<br/>        fields = ('id', 'title', 'content', 'last_updated_on', '<strong class="ob ir">locked_at</strong>', '<strong class="ob ir">is_locked</strong>',)</span></pre><p id="a6d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.3向视图添加心跳API</strong></p><p id="6d2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们在<strong class="jp ir"> notes_app/view.py </strong>中的心跳API:</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="9e62" class="oh lc iq ob b gy oi oj l ok ol">class LockNoteAPI(APIView):<br/>    def post(self, request, **kwargs):<br/>        note = get_object_or_404(Note, id=self.kwargs['pk'])<br/>        note.lock()<br/>        return HttpResponse(status=status.HTTP_200_OK)</span></pre><p id="61a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还想在UI中添加一些消息，让用户知道有人正在编辑这个便笺，他们必须等到便笺被解锁。更新后的<strong class="jp ir"> notes_app/view.py </strong>现在看起来是这样的:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">心跳API</figcaption></figure><p id="abe0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.4向URL添加心跳API</strong></p><p id="47e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们也更新一下<strong class="jp ir"> notes_app/urls.py </strong>以反映新的变化。</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="844a" class="oh lc iq ob b gy oi oj l ok ol">from django.urls import path, include<br/>from django.views.generic import TemplateView<br/><br/>from notes_heartbeat_project.routers import router<br/><br/>from .views import NoteUpdateView, LockNoteAPI<br/><br/>urlpatterns = [<br/>    path('', TemplateView.as_view(template_name='notes_app/notes.html')),<br/>    path('api/', include(router.urls)),<br/><strong class="ob ir">    path('api/note/lock-note/&lt;int:pk&gt;/', LockNoteAPI.as_view()),<br/></strong>    path('note/&lt;int:pk&gt;/update/', NoteUpdateView.as_view(), name='note_update'),<br/><br/>]</span></pre><p id="b7dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.5添加前端更改以将此功能落实到位</strong></p><p id="e529" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将在<strong class="jp ir">notes _ app/js/note _ edit . js</strong>中添加负责延长锁60秒的方法<strong class="jp ir"> "lockNoteHeartbeat" </strong>。我们将使用JavaScript的<strong class="jp ir"> setInterval() </strong>方法在<strong class="jp ir"> mounted() </strong>钩子中定期调用这个方法。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="f42f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.6添加视图模板</strong></p><p id="f823" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要添加一个view.html部分，不允许用户编辑别人正在编辑的笔记。</p><p id="b6ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们的<strong class="jp ir">notes _ app/templates/notes _ app/partials/view . py</strong></p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="64d1" class="oh lc iq ob b gy oi oj l ok ol">&lt;div id="note_view"&gt;<br/>    &lt;div class="modal-body"&gt;<br/>        &lt;div class="form-group"&gt;<br/>            &lt;label for="note_title"&gt;Title&lt;/label&gt;<br/>            &lt;input<br/>                    type="text"<br/>                    class="form-control"<br/>                    id="note_title"<br/><strong class="ob ir">                    value="{{ object.title }}"<br/></strong>                    required="required"<br/>                    <strong class="ob ir">readonly</strong>&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="form-group"&gt;<br/>            &lt;label for="note_content"&gt;Content&lt;/label&gt;<br/>            &lt;textarea<br/>                    class="form-control"<br/>                    id="note_content"<br/>                    required="required"<br/>                    rows="3"<br/>                    <strong class="ob ir">readonly&gt;{{ object.content }}</strong>&lt;/textarea&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="modal-footer"&gt;<br/>        &lt;button type="button" class="btn btn-secondary m-progress" onclick="window.close()"&gt;<br/>            Close<br/>        &lt;/button&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="38ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终版本的<strong class="jp ir"> note_edit.html </strong>现在看起来如下:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="fb57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.7运行迁移</strong></p><p id="985e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在剩下的就是再次运行迁移，以反映对注释模型所做的更改，并将新字段<strong class="jp ir">‘locked _ at’</strong>添加到数据库的注释表中。</p><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="9228" class="oh lc iq ob b gy oi oj l ok ol">~/django-vuejs-heartbeat/notes_heartbeat_project ❯ <strong class="ob ir">python manage.py makemigrations</strong>                                                                                         <br/>Migrations for 'notes_app':<br/>  notes_app/migrations/0002_note_locked_at.py<br/>    <strong class="ob ir">- Add field locked_at to note</strong><br/>~/Desktop/django-vuejs-heartbeat/notes_heartbeat_project ❯ <strong class="ob ir">python manage.py migrate</strong>                                                                                                             <br/>Operations to perform:<br/>  Apply all migrations: admin, auth, contenttypes, notes_app, sessions<br/>Running migrations:<br/><strong class="ob ir">  Applying notes_app.0002_note_locked_at... OK</strong></span></pre></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="d2e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们的示例如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ot"><img src="../Images/bd91eaac2071b514a12f6e0a9d9493f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jydODFxgOOoV1JqjoMT7eg.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">无冲突用户界面</figcaption></figure><p id="23f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面的例子中我们可以看到，我们已经解决了多个用户编辑笔记的突出问题。</p><blockquote class="mf mg mh"><p id="d089" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">1.登录页面显示笔记列表</p><p id="019a" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">2.用户1打开note_id=1并成功编辑它，因为note_id=1未被锁定</p><p id="4bfa" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">3.用户1将锁延长60秒</p><p id="1657" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">4.用户2也打开note_id=1</p><p id="ca34" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">5.用户2被重定向到注释的只读版本</p><p id="6a7b" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">6.用户2看到消息说“此便笺正被其他人更新。请稍后再试！”</p><p id="d8cf" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">7.数据库保存用户1的note_1=1的更新版本</p><p id="cf15" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">8.用户1的更改已保存</p></blockquote></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="80c7" class="lb lc iq bd ld le nr lg lh li ns lk ll lm nt lo lp lq nu ls lt lu nv lw lx ly bi translated">结论</h1><p id="f8ba" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">在本教程中，我们展示了如何使用heartbeat with lease机制来确保多个用户的无冲突编辑体验。我希望你觉得这个教程有用，我很乐意在评论中听到你的反馈！</p><h1 id="3967" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak"> <em class="ou">参考文献及资源:</em> </strong></h1><div class="ov ow gp gr ox oy"><a href="https://www.django-rest-framework.org/" rel="noopener  ugc nofollow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd ir gy z fp pd fr fs pe fu fw ip bi translated">Home - Django REST框架</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">Django REST框架是一个用于构建Web APIs的强大而灵活的工具包。您可能想使用REST的一些原因…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">www.django-rest-framework.org</p></div></div></div></a></div><div class="ov ow gp gr ox oy"><a href="https://vuejs.org/" rel="noopener  ugc nofollow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd ir gy z fp pd fr fs pe fu fw ip bi translated">Vue.js -渐进式JavaScript框架| Vue.js</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">一个可接近的，高性能的和通用的框架，用于构建web用户界面。建立在标准HTML之上…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">vuejs.org</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm kv oy"/></div></div></a></div><p id="5b0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae me" href="https://static.googleusercontent.com/media/research.google.com/en//archive/gfs-sosp2003.pdf" rel="noopener ugc nofollow" target="_blank">https://static . Google user content . com/media/research . Google . com/en//archive/GFS-sosp 2003 . pdf</a></p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="a506" class="lb lc iq bd ld le nr lg lh li ns lk ll lm nt lo lp lq nu ls lt lu nv lw lx ly bi translated">分级编码</h1><pre class="km kn ko kp gt od ob oe of aw og bi"><span id="2137" class="oh lc iq ob b gy oi oj l ok ol">Thanks for being a part of our community! More content in the <a class="ae me" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">Level Up Coding publication</a>.<br/>Follow: <a class="ae me" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>, <a class="ae me" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="ae me" href="https://newsletter.levelup.dev/" rel="noopener ugc nofollow" target="_blank">Newsletter</a></span><span id="01e3" class="oh lc iq ob b gy om oj l ok ol">Level Up is transforming tech recruiting<strong class="ob ir"> </strong>👉<strong class="ob ir"> </strong><a class="ae me" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"><strong class="ob ir">Join our talent collective</strong></a></span></pre></div></div>    
</body>
</html>