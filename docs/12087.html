<html>
<head>
<title>Custom dynamic sized bottom sheet (iOS)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自定义动态尺寸底板(iOS)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/custom-dynamic-sized-bottom-sheet-ios-fbae44485255?source=collection_archive---------0-----------------------#2022-05-14">https://levelup.gitconnected.com/custom-dynamic-sized-bottom-sheet-ios-fbae44485255?source=collection_archive---------0-----------------------#2022-05-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="876a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建您自己的自定义动态大小的底部表单，并通过滑动手势使其消失。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3ffb5518c7d05a0e67aec0b3775f2a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*x1XI8Hr9EeVZHKDZdofbMQ.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">滑动和扩展动态大小的底部表单。</figcaption></figure><p id="bf24" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇文章中，我们将看看如何实现你自己的交互式动态大小的底部表单。底部的表格可以用来展示各种各样的视图，并且给你的应用程序添加一个非常好的风格！</p><p id="7d4f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lr">更新:现在同拉伸！</em> </strong></p><p id="6ce8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">我现在已经给底部的工作表添加了拉伸，使它在被滑动/拖动时拉伸超过它的边界👏所有代码示例都应该更新。编码快乐！</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1f4271805cd2f9300e32eab8ba236470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ugQHm3AXI_K7xTNhE1cIuA.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">滑动和扩展一个动态大小的底层与拉伸！</figcaption></figure><p id="9de3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将把底部的表单实现为自定义的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontroller" rel="noopener ugc nofollow" target="_blank"> UIViewController </a>，它提供自己的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">uiviewcontrollertransitiondelegate</a>，在<code class="fe lt lu lv lw b">modalPresentationStyle</code>设置为<code class="fe lt lu lv lw b">.custom</code>的情况下(使用<code class="fe lt lu lv lw b">present(_:animated:completion:)</code>)以模态方式呈现时使用。<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>将为<a class="ae ls" href="https://developer.apple.com/documentation/uikit" rel="noopener ugc nofollow" target="_blank"> UIKit </a>提供一个自定义的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>和用于视图控制器转换的转换对象(<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>和<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>)。</p><blockquote class="lx ly lz"><p id="781d" class="kv kw lr kx b ky kz jr la lb lc ju ld ma lf lg lh mb lj lk ll mc ln lo lp lq ij bi translated"><strong class="kx ir">注意:</strong>如果你打算只支持iOS 15及以上版本，你最好使用新的和令人敬畏的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uisheetpresentationcontroller" rel="noopener ugc nofollow" target="_blank">UISheetPresentationController</a>！</p></blockquote><h2 id="e509" class="md me iq bd mf mg mh dn mi mj mk dp ml le mm mn mo li mp mq mr lm ms mt mu mv bi translated">关键要点</h2><ul class=""><li id="93ff" class="mw mx iq kx b ky my lb mz le na li nb lm nc lq nd ne nf ng bi translated">创建<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontroller" rel="noopener ugc nofollow" target="_blank"> UIViewController </a>(例如<em class="lr"> BottomSheetController) </em>的子类，并公开方法/属性来配置底部表单。如大小(例如:动态、小、中、大)、拐角半径、拖动以消除启用/禁用等。此视图控制器将作为您在应用程序中创建的所有自定义底部表单的基础。</li><li id="38cb" class="mw mx iq kx b ky nh lb ni le nj li nk lm nl lq nd ne nf ng bi translated">创建<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>(例如<em class="lr">BottomSheetTransitioningDelegate</em>)的实现，并将其提供给<em class="lr"> BottomSheetController </em>的<code class="fe lt lu lv lw b">transitioningDelegate</code>属性。<strong class="kx ir">提示:</strong>覆盖<em class="lr"> BottomSheetController </em>的属性(<code class="fe lt lu lv lw b">transitioningDelegate</code>，并从getter返回您对<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>的实现。还要记住将<em class="lr"> BottomSheetController </em>的<code class="fe lt lu lv lw b">modalPresentationStyle</code>设置为<code class="fe lt lu lv lw b">.custom</code>(这也可以通过覆盖属性的getter来完成)。</li><li id="817c" class="mw mx iq kx b ky nh lb ni le nj li nk lm nl lq nd ne nf ng bi translated">创建自己的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>的子类(例如<em class="lr">BottomSheetPresentationController</em>)，并从自己的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>中返回。该对象将控制<em class="lr">底层控制器</em>的显示和取消。覆盖其方法(如<code class="fe lt lu lv lw b">presentationTransitionWillBegin()</code>和<code class="fe lt lu lv lw b">dismissalTransitionWillBegin()</code>)以挂钩到演示和解散过渡，并添加装饰视图(如背景视图)或手势识别器以实现其他行为(如滑动/拖动以解散)。如果你想让<em class="lr"> BottomSheetController </em>有一个动态高度(基于它的内容视图大小)，你需要给显示的视图添加约束，允许它根据它的内容自己调整大小。您通常会在<code class="fe lt lu lv lw b">presentationTransitionWillBegin()</code>方法中这样做。</li><li id="379a" class="mw mx iq kx b ky nh lb ni le nj li nk lm nl lq nd ne nf ng bi translated">如果您想要提供自定义演示和/或消除动画，请创建自己的实现<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>和<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>。如果您希望能够交互式地消除<em class="lr"> BottomSheetController </em>(例如滑动/拖动以消除)，您将必须实现<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>，并让您的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>实现提供一个可中断的动画器(例如<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" rel="noopener ugc nofollow" target="_blank">uiviewpropertyinteanimator</a>)。您可以创建自己的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractivetransition</a>实现，或者使用现有的实现，如<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipercentdriveninteractivetransition" rel="noopener ugc nofollow" target="_blank">UIPercentDrivenInteractiveTransition</a>来驱动基于手势的交互式过渡/动画。通过与提供的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollercontexttransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerContextTransitioning</a>对象交互，过渡/动画被向前驱动。如果你使用一个实例uipercentdriveninteractive transition你就不需要手动这么做。相反，你将与UIPercentDrivenInteractiveTransition对象进行交互，并让它为你驱动过渡/动画。</li></ul><p id="b4d8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您想马上获得一些示例代码，您可以在这里找到本文中使用的示例应用程序的完整代码:<a class="ae ls" href="https://github.com/thomsmed/ios-examples/tree/main/BottomSheetController" rel="noopener ugc nofollow" target="_blank">https://github . com/thoms med/IOs-examples/tree/main/bottom sheet controller</a>。</p><h1 id="c161" class="nm me iq bd mf nn no np mi nq nr ns ml jw nt jx mo jz nu ka mr kc nv kd mu nw bi translated">示例应用程序</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/4d8b024d9a8bfd6befd9d4aebae1793b.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/1*xshUSHeYlita8VeeC-64UQ.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">带有各种尺寸底板的示例应用程序。</figcaption></figure><p id="9154" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将创建一个超级简单的应用程序来展示自定义底部表单控制器的神奇之处。它将包含一个根视图控制器，以及我们的<em class="lr"> BottomSheetController </em>的几个示例子类。我们不会详细讨论这些<em class="lr"> BottomSheetController </em>子类，但是示例应用程序的完整代码可以在这里找到:<a class="ae ls" href="https://github.com/thomsmed/ios-examples/tree/main/BottomSheetController" rel="noopener ugc nofollow" target="_blank">https://github . com/thoms med/IOs-examples/tree/main/BottomSheetController</a>。</p><p id="0659" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">底层控制器</em>的基本用法如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="bb90" class="md me iq bd mf mg mh dn mi mj mk dp ml le mm mn mo li mp mq mr lm ms mt mu mv bi translated">底板控制器</h2><p id="1803" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le oa lg lh li ob lk ll lm oc lo lp lq ij bi translated">为了表示底部工作表控制器，我们将创建一个名为<em class="lr"> BottomSheetController </em>的视图控制器。这个类将作为我们应用程序中所有底层工作表的基类/超类。我们希望呈现为底部表单的每个视图控制器都将是<em class="lr"> BottomSheetController </em>的子类。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="9e5d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr"> BottomSheetController </em>将公开属性，让我们配置底部表单的外观。比如它的首选大小，以及是否可以使用滑动手势来消除它。它还将管理<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>(<em class="lr">BottomSheetTransitioningDelegate</em>)的自定义实现，该实现将由被覆盖的<code class="fe lt lu lv lw b">transitioningDelegate</code>属性返回。我们还将覆盖<code class="fe lt lu lv lw b">modalPresentationStyle</code>，让getter总是返回<code class="fe lt lu lv lw b">.custom</code>。</p><p id="2a21" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们在使用<code class="fe lt lu lv lw b">present(_:animated:completion)</code>呈现时将视图控制器的<code class="fe lt lu lv lw b">modalPresentationStyle</code>设置为<code class="fe lt lu lv lw b">.custom</code>，UIKit将仅使用我们的自定义<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>(来自<code class="fe lt lu lv lw b">transitioningDelegate</code>属性)。</p><h2 id="4107" class="md me iq bd mf mg mh dn mi mj mk dp ml le mm mn mo li mp mq mr lm ms mt mu mv bi translated"><strong class="ak">BottomSheetTransitioningDelegate</strong></h2><p id="b5da" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le oa lg lh li ob lk ll lm oc lo lp lq ij bi translated">UIKit让我们通过实现<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>来挂钩呈现和取消视图控制器的过程。当使用<code class="fe lt lu lv lw b">present(_:animated:completion)</code>呈现视图控制器时，我们可以将呈现的视图控制器的<code class="fe lt lu lv lw b">modalPresentationStyle</code>设置为<code class="fe lt lu lv lw b">.custom</code>，然后UIKit将使用<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>来分配呈现的视图控制器的<code class="fe lt lu lv lw b">transitioningDelegate</code>属性。</p><p id="930d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将定义自己的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>(<em class="lr">BottomSheetTransitioningDelegate</em>)UIKit可以查询一个<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>和转换对象(<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>和<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>)以在<em class="lr"> BottomSheetController </em>的呈现和解除下使用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="0476" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>会将在<em class="lr"> BottomSheetController </em>上所做的任何配置转发给我们的自定义<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>，以便它可以进一步配置<em class="lr"> BottomSheetController </em>的视图的呈现等。</p><blockquote class="lx ly lz"><p id="1484" class="kv kw lr kx b ky kz jr la lb lc ju ld ma lf lg lh mb lj lk ll mc ln lo lp lq ij bi translated"><strong class="kx ir">注意:</strong>我们的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>将只提供转换对象(<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>和<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>)如果解散是使用手势发起的。否则它将返回<code class="fe lt lu lv lw b">nil</code>来指示UIKit应该使用默认的解散动画。由于我们的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>没有实现为视图控制器的表示提供转换对象的方法，UIKit将使用默认的表示动画。</p></blockquote><h2 id="3143" class="md me iq bd mf mg mh dn mi mj mk dp ml le mm mn mo li mp mq mr lm ms mt mu mv bi translated">bottom sheet presentation controller</h2><p id="7c3a" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le oa lg lh li ob lk ll lm oc lo lp lq ij bi translated">在视图控制器的呈现过程中，UIKit使用一个<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>来控制视图控制器的呈现和取消。通过创建我们自己的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>(<em class="lr">BottomSheetPresentationController</em>)的子类，我们可以挂钩到流程中并添加定制的装饰视图等。我们甚至可以添加手势识别器来支持视图控制器的交互式解除。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="1a4d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>子类将定义手势识别器，使其能够轻敲和轻扫<em class="lr"> BottomSheetController </em>。为了支持动态调整底部表单的大小，它将向呈现的视图(<em class="lr"> BottomSheetController </em>的视图)添加<a class="ae ls" href="https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/AutolayoutPG/index.html" rel="noopener ugc nofollow" target="_blank">自动布局约束</a>，这样它就可以根据其内容自行调整大小。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1649a5a5b6be830da581a2207d3c2617.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/1*lb7Q-0XD5sYX6PB7kYsl5Q.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">自动布局使创建扩展和动态大小的底板变得容易。</figcaption></figure><blockquote class="lx ly lz"><p id="5d5f" class="kv kw lr kx b ky kz jr la lb lc ju ld ma lf lg lh mb lj lk ll mc ln lo lp lq ij bi translated"><strong class="kx ir">注意:</strong>我们的动态自调整底部表单的技巧是使用<a class="ae ls" href="https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/AutolayoutPG/index.html" rel="noopener ugc nofollow" target="_blank">自动布局约束</a>来将呈现的视图控制器的视图约束到用于呈现的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller/1618332-containerview" rel="noopener ugc nofollow" target="_blank">容器视图</a>。通过指定一个具有非常低优先级的高度约束(<code class="fe lt lu lv lw b">.fittingSizeLevel</code>的优先级为50)，所呈现的视图控制器的视图只有在不中断其任何内部约束的情况下才会遵守该约束。如果出现这种情况，视图将简单地拉伸超过(或收缩到)高度限制，并停留在合适的高度。</p></blockquote><h2 id="637d" class="md me iq bd mf mg mh dn mi mj mk dp ml le mm mn mo li mp mq mr lm ms mt mu mv bi translated">BottomSheetInteractiveDismissalTransition</h2><p id="4969" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le oa lg lh li ob lk ll lm oc lo lp lq ij bi translated">作为创建自定义动态调整大小的底部表单控制器的最后一部分，我们将定义一个符合<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>和<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>的类。我们称之为<em class="lr">BottomSheetInteractiveDismissalTransition</em>。</p><p id="7a6d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当<em class="lr"> BottomSheetController </em>使用滑动(向下)手势消除时，该类的对象将负责驱动消除动画。</p><p id="b8f1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>负责创建动画并提供可中断的动画对象(如<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" rel="noopener ugc nofollow" target="_blank">uiviewpropertyimator</a>)<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>负责驱动动画向前(通过与<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollercontexttransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerContextTransitioning</a>对象交互)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><blockquote class="lx ly lz"><p id="5dd2" class="kv kw lr kx b ky kz jr la lb lc ju ld ma lf lg lh mb lj lk ll mc ln lo lp lq ij bi translated"><strong class="kx ir">注意:</strong>可以使用<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipercentdriveninteractivetransition" rel="noopener ugc nofollow" target="_blank">UIPercentDrivenInteractiveTransition</a>的一个实例——它实现了<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractivetransition</a>——让你免去自己手动驱动交互动画的工作。然后，在处理滑动手势时，您将与<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipercentdriveninteractivetransition" rel="noopener ugc nofollow" target="_blank">UIPercentDrivenInteractiveTransition</a>对象的方法进行交互，而<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipercentdriveninteractivetransition" rel="noopener ugc nofollow" target="_blank">UIPercentDrivenInteractiveTransition</a>对象将处理与<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollercontexttransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerContextTransitioning</a>对象的交互。</p></blockquote><p id="d150" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就结束了我们的自定义动态大小的底部表。要创建各种底部工作表视图，您只需子类化<em class="lr"> BottomSheetController </em>并像在任何其他视图控制器上一样配置视图。在根据您的需求进行配置后，可以通过调用<code class="fe lt lu lv lw b">present(_:animated:completion:)</code>来显示底部表单。</p><p id="0166" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本文中展示的示例代码也可以很容易地构成任何其他定制视图控制器表示的基础。使用定制的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>你可以修改视图控制器的视图在呈现时的外观。如果需要，您甚至可以在演示文稿中添加额外的装饰视图。通过修改<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>和<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>协议，您可以轻松添加自己的过渡动画(交互式和非交互式)。</p><h1 id="5209" class="nm me iq bd mf nn no np mi nq nr ns ml jw nt jx mo jz nu ka mr kc nv kd mu nw bi translated">摘要</h1><p id="8f75" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le oa lg lh li ob lk ll lm oc lo lp lq ij bi translated">在本文中，我们已经看到了如何创建一个定制的动态大小的底层控制器，它利用<a class="ae ls" href="https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/AutolayoutPG/index.html" rel="noopener ugc nofollow" target="_blank">自动布局约束</a>的能力来调整它自己的大小以适合高度。我们还使底部表单具有交互性，并添加了一个手势识别器，使其可以通过滑动(向下)手势来消除。</p><p id="0965" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过向<a class="ae ls" href="https://developer.apple.com/documentation/uikit" rel="noopener ugc nofollow" target="_blank"> UIKit </a>提供我们自己的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>的实现，我们可以进入呈现和取消视图控制器的过程。我们的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollertransitioningdelegate" rel="noopener ugc nofollow" target="_blank">UIViewControllerTransitioningDelegate</a>实现为<a class="ae ls" href="https://developer.apple.com/documentation/uikit" rel="noopener ugc nofollow" target="_blank"> UIKit </a>提供了一个定制的<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uipresentationcontroller" rel="noopener ugc nofollow" target="_blank">UIPresentationController</a>和转换对象(<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrolleranimatedtransitioning" rel="noopener ugc nofollow" target="_blank">UIViewControllerAnimatedTransitioning</a>和<a class="ae ls" href="https://developer.apple.com/documentation/uikit/uiviewcontrollerinteractivetransitioning" rel="noopener ugc nofollow" target="_blank">uiviewcontrollerinteractive transitioning</a>)来操纵所呈现的视图控制器的视图应该如何显示和行为。我们添加了背景视图和手势识别器，使<em class="lr"> BottomSheetController </em>看起来和感觉上都像一个合适的底部表单。</p><p id="2bf8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完整的示例代码可以在这里找到:<a class="ae ls" href="https://github.com/thomsmed/ios-examples/tree/main/BottomSheetController" rel="noopener ugc nofollow" target="_blank">https://github . com/thoms med/IOs-examples/tree/main/bottom sheet controller</a></p><p id="694e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">编码快乐！</p></div></div>    
</body>
</html>