<html>
<head>
<title>The power of Django Render function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django渲染功能的威力</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-power-of-django-render-function-fc890e82b279?source=collection_archive---------11-----------------------#2020-08-15">https://levelup.gitconnected.com/the-power-of-django-render-function-fc890e82b279?source=collection_archive---------11-----------------------#2020-08-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="b3ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用Django中的模板渲染函数可以做什么？</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="599b" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">动机</h1><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/d44e5592cdac6777db4082c527b4d069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*xz1vMkcyYtTSkaR4GZF3Sg.jpeg"/></div></figure><p id="1cc0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们为教授编写了一个小型测试平台，允许向我们大学的学生自动发送电子邮件。一位教授可能需要发送大约100封包含不同数据的电子邮件。</p><p id="fa4d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以，我们决定让教授们自己编写邮件模板。一封电子邮件看起来像这样:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="8985" class="mg kw it mc b gy mh mi l mj mk"><strong class="mc iu">you need to pass the following test: <br/>Linear Algebra I</strong></span><span id="873f" class="mg kw it mc b gy ml mi l mj mk"><strong class="mc iu">You will have 60 minutes. Once time is over, the test will be stopped automatically. <br/><br/>The number of question in the test is 30. <br/><br/>To enter the system, you need these credentials:<br/>Login: john123<br/>Password: 37823</strong></span><span id="7cc1" class="mg kw it mc b gy ml mi l mj mk"><strong class="mc iu">Test URL: someurl.com</strong></span><span id="67e8" class="mg kw it mc b gy ml mi l mj mk"><strong class="mc iu">We wish you a good luck!</strong></span></pre><p id="f85f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">问题是，登录名和密码是由系统生成的，因此我们需要将这些凭据发送给学生。如你所见，有很多地方的课文是学生专用的。</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="1f25" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">天真的方式</h1><p id="8378" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">首先，我们认为这个任务非常简单，我们所需要的只是Python中的一个“替换”函数。</p><p id="70d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，代码看起来像这样:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="fb80" class="mg kw it mc b gy mh mi l mj mk">template = Template(template_text)<br/>template_filled = template.replace(<strong class="mc iu">"first_name"</strong>, assignment.student.first_name)<br/>template_filled = template.replace(<strong class="mc iu">"boyfriend_girlfriend"</strong>, assignment.student.boyfriend_girlfriend)<br/>template_filled = template.replace(<strong class="mc iu">"whatever_else"</strong>, assignment.student.whatever_else)<br/>send_email(assignment.student.email, template_filled)</span></pre><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/218953c93de8188d1a433fd2c252f991.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*VjJsGc9SXLDE5QRmoTVgsw.jpeg"/></div></figure><p id="48b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">问题是我们的教授每天都想包含越来越多不同的变量。此外，如果名字在文本中出现两次，这段代码也不起作用。而且有太多的硬编码。讨厌那个！</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="f2a9" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">Django模板</h1><p id="683d" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">然后我们意识到这看起来很熟悉。我们在Django中生成HTML输出时也是这样做的！为什么不重用这个？令人惊讶的是，这是如此简单！</p><p id="574e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">代码现在看起来像这样:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="7561" class="mg kw it mc b gy mh mi l mj mk"><strong class="mc iu">from </strong>django.shortcuts <strong class="mc iu">import </strong>render<br/><strong class="mc iu">from </strong>django.template <strong class="mc iu">import </strong>Template, Context<br/><strong class="mc iu">for</strong> assignment <strong class="mc iu">in</strong> assignments:<br/>  template = Template(template_text)<br/>  context = Context({<strong class="mc iu">'assignment'</strong>: assignment})<br/>  send_email(assignment.student.email, template.render(context))</span></pre><p id="2e93" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那不是很美吗？</p><p id="894e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，我们的template_text现在看起来像这样:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="404e" class="mg kw it mc b gy mh mi l mj mk"><strong class="mc iu">Dear {{assignment.person.first_name}}, /n /n</strong></span><span id="4cb7" class="mg kw it mc b gy ml mi l mj mk"><strong class="mc iu">you need to pass the following test: /n<br/>{{assignment.quiz_structure.name}}/n</strong></span><span id="9e26" class="mg kw it mc b gy ml mi l mj mk"><strong class="mc iu">You will have {{assignment.quiz_structure.minutes}} minutes. Once time is over, the test will be stopped automatically. /n<br/>/n<br/>The number of question in the test is {{assignment.quiz_structure.quantity}}/n /n</strong></span><span id="ab36" class="mg kw it mc b gy ml mi l mj mk"><strong class="mc iu">To enter the system, you need these credentials:<br/>Login: {{assignment.person.user.username}}/n<br/>Password: {{assignment.person.password}}/n</strong></span><span id="d645" class="mg kw it mc b gy ml mi l mj mk"><strong class="mc iu">Test URL: someurl.com/n /n<br/>We wish you a good luck!</strong></span></pre><p id="dce0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果教授们愿意，他们现在可以使用“for-loops”。是的，他们希望:)</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="cc7c" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">对该函数的进一步研究</h1><p id="8e0b" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">让我们看看更多的寺庙渲染的例子，以便更好地理解它是如何工作的。</p><p id="efa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要做两件事:</p><ol class=""><li id="9ccf" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn mx my mz na bi translated">使用“模板”功能写一些文本并创建一个模板</li><li id="86f1" class="ms mt it js b jt nb jx nc kb nd kf ne kj nf kn mx my mz na bi translated">将上下文数据传递给呈现器。</li></ol><p id="9f5f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里有一个简单的例子:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="47ab" class="mg kw it mc b gy mh mi l mj mk">template = Template(<strong class="mc iu">"Hello, {{var1}}!"</strong>)<br/>context = Context({<strong class="mc iu">"var1"</strong>: <strong class="mc iu">"world"</strong>})<br/><strong class="mc iu">print</strong>(self.style.SUCCESS(template.render(context)))</span></pre><p id="4201" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这导致“你好，世界！”，很明显。</p><p id="2442" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是一个for循环的例子:</p><pre class="lu lv lw lx gt mb mc md me aw mf bi"><span id="3146" class="mg kw it mc b gy mh mi l mj mk">template = Template(<br/><strong class="mc iu">"""<br/>{% for student in students %}<br/>Hello, {{student}}! <br/>{% endfor %}<br/>"""</strong>)<br/>context = Context({<strong class="mc iu">"students"</strong>: [<strong class="mc iu">"John"</strong>, <strong class="mc iu">"Andrew"</strong>, <strong class="mc iu">"Victor"</strong>]})<br/><strong class="mc iu">print</strong>(self.style.SUCCESS(template.render(context)))</span></pre><p id="98c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如你所看到的，教授们甚至能够提前发送每个学生的所有问题:)我确信他们没有这样做。</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><p id="440f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读！</p><p id="acab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你的Django项目运行太慢了吗？看看这篇文章:</p><div class="ng nh gp gr ni nj"><a rel="noopener  ugc nofollow" target="_blank" href="/optimizing-django-queries-28e96ad204de"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">优化Django查询</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">使用批量查询、预加载外键等。</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx lz nj"/></div></div></a></div></div></div>    
</body>
</html>