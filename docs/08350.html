<html>
<head>
<title>How to setup React with Webpack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Webpack设置React</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-setup-a-react-application-with-webpack-f781b5c4a4ab?source=collection_archive---------0-----------------------#2021-04-24">https://levelup.gitconnected.com/how-to-setup-a-react-application-with-webpack-f781b5c4a4ab?source=collection_archive---------0-----------------------#2021-04-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b887" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对于那些一直想在不使用create-react-app的情况下构建React应用程序的初学者</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5f30c797984711d80b2e6c578e6f2d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gK9iJ3K5w9Nupks0DwoSYQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Webpack徽标</figcaption></figure><p id="b48a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Create-react-app 让我们所有人的生活变得更加轻松，绝对是快速开始构建react应用程序的绝佳工具。然而，你有没有想过从头开始制作这样一个应用程序可能会涉及到什么？</p><p id="981b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我一直用CRA做我自己的爱好项目，但是最近我收到了一个定制webpack配置的应用程序。这给了我一个很好的机会，在我投入到这个项目并开始贡献之前，我可以学习一些webpack的基础知识。</p><p id="034b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Webpack有很多特性，文档虽然很有帮助，但可能会让人不知所措。我花了很多时间浏览文档，还在YouTube上看了很多教学视频。在这里，我想记录和分享我学到的东西，我希望任何有类似经历的人都会觉得这很有用。</p><h1 id="8c0f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">初始化项目</h1><p id="e3df" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">首先，让我们创建一个空项目，并安装一些依赖项。创建一个目录，然后运行</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="10e8" class="mu lt iq mq b gy mv mw l mx my">npm init -y</span></pre><p id="863d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">初始化您的新项目。这应该会创建一个默认的package.json清单文件。</p><blockquote class="mz na nb"><p id="85df" class="kv kw nc kx b ky kz jr la lb lc ju ld nd lf lg lh ne lj lk ll nf ln lo lp lq ij bi translated">请随意省略-y标志，并根据您的需要初始化项目。</p></blockquote><p id="241f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们安装一些我们将使用的基本软件包:</p><ul class=""><li id="9aaf" class="ng nh iq kx b ky kz lb lc le ni li nj lm nk lq nl nm nn no bi translated">react —主react库</li><li id="6d93" class="ng nh iq kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">react-DOM——允许我们在浏览器中使用react的包</li><li id="eaea" class="ng nh iq kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">web pack——JavaScript bundler，我们将在下面深入探讨</li><li id="1568" class="ng nh iq kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">webpack-cli —允许我们从命令行运行webpack命令的工具。</li></ul><p id="1189" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要安装所有这些程序，请运行以下命令:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="1378" class="mu lt iq mq b gy mv mw l mx my">npm i react react-dom<br/>npm i -D webpack webpack-cli</span></pre><blockquote class="mz na nb"><p id="9831" class="kv kw nc kx b ky kz jr la lb lc ju ld nd lf lg lh ne lj lk ll nf ln lo lp lq ij bi translated">注意，webpack和webpack-cli是作为开发依赖项安装的，因为我们只在开发过程中需要它们。整个教程中唯一的运行时包是react和react-dom。</p></blockquote><h1 id="8c3c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">设置项目结构</h1><p id="ab2c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">此时，您应该已经在根目录中直接拥有了package.json和package-lock.json文件。现在创建几个空文件，我们稍后将填充这些文件，并设置您的项目，使其模仿如下所示的目录结构:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="5ce5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">学习基本的Webpack术语</h1><p id="cb83" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在我们开始配置webpack和制作我们的小应用程序之前，让我们了解一些关于webpack的事情。</p><p id="0253" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">webpack是一个JavaScript代码捆绑器，它遍历项目的依赖图(您在JS文件中使用的导入链)，并创建一个静态JavaScript文件，准备附加到您的HTML。</p><p id="301b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们开始使用webpack之前，有几个关于它的术语必须介绍一下:</p><ul class=""><li id="7ff7" class="ng nh iq kx b ky kz lb lc le ni li nj lm nk lq nl nm nn no bi translated">Entry —这是依赖关系树(通常是src/index.js)的顶部，webpack从这里开始捆绑过程。</li><li id="cbfc" class="ng nh iq kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">输出—输出文件。又名捆绑。</li><li id="4be6" class="ng nh iq kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">加载器——默认情况下，webpack只支持JavaScript文件，但是我们显然希望能够导入其他文件类型(CSS、JSX等)。).这就是装载机发挥作用的地方。它们是帮助我们将非JavaScript文件直接导入JavaScript的包(不包含在Webpack中)。</li><li id="39dd" class="ng nh iq kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">插件——插件也是其他第三方包，可以与webpack一起使用以扩展其功能。有很多插件，但在这里，我们将只处理html-webpack-plugin。稍后将详细介绍。</li></ul><h1 id="aa63" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建一个最小的React应用程序</h1><p id="a4a1" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这就是我们开始学习webpack所需要了解的全部内容。现在让我们继续用一些代码填充我们之前创建的那些文件，这样我们就可以在浏览器上进行测试了。</p><blockquote class="mz na nb"><p id="dbba" class="kv kw nc kx b ky kz jr la lb lc ju ld nd lf lg lh ne lj lk ll nf ln lo lp lq ij bi translated">我假设你们熟悉React，并且不会在本文中解释React代码。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="d6aa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个应用程序应该做的就是呈现一个标题标签，这个标签向页面显示“Hello World”。但是，如果您尝试使用</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="61c7" class="mu lt iq mq b gy mv mw l mx my">...<br/>&lt;script src="index.js" /&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="d470" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它不起作用。如果你在浏览器中打开它，你只会看到一个空白页。</p><p id="e26d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是因为浏览器不知道如何从“”导入App。/App”。浏览器只能加载静态JS文件，所以让我们最后配置webpack，将我们的应用程序转换成浏览器可以理解的东西。</p><h1 id="214b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">安装装载机</h1><p id="e22e" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们首先安装babel-loader，它允许我们将JSX编译成浏览器兼容的JavaScript。为此，请运行以下命令:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="1b28" class="mu lt iq mq b gy mv mw l mx my">npm i -D @babel/core @babel/preset-env @babel/preset-react babel-loader</span></pre><p id="5ee7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们所做的是安装巴别塔，两个预置，然后最后加载程序需要加载我们的JSX文件。请浏览babel的<a class="ae lr" href="https://babeljs.io/docs/en/babel-preset-env" rel="noopener ugc nofollow" target="_blank">文档</a>以了解更多关于这些预设功能的信息。</p><h1 id="0d7f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">配置Webpack</h1><p id="8910" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">现在我们准备请求webpack在捆绑期间友好地使用Babel来理解任何JSX文件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="d0ca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">根据我们上面的讨论，入口和输出应该是清楚的，但是什么是module.rules呢？</p><p id="5b2a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从<a class="ae lr" href="https://webpack.js.org/configuration/module/#modulerules" rel="noopener ugc nofollow" target="_blank">文件</a>来看，是:</p><blockquote class="mz na nb"><p id="6447" class="kv kw nc kx b ky kz jr la lb lc ju ld nd lf lg lh ne lj lk ll nf ln lo lp lq ij bi translated">一组<a class="ae lr" href="https://webpack.js.org/configuration/module/#rule" rel="noopener ugc nofollow" target="_blank">规则</a>，在创建模块时与请求相匹配。这些规则可以修改模块的创建方式。他们可以向模块应用加载器，或者修改解析器。</p></blockquote><p id="cb6f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的配置文件中，我们要求webpack使用babel-loader，只要它看到任何以js或jsx结尾的文件。了解更多关于正则表达式(/\。(js|jsx)$/以上)工作，请把<a class="ae lr" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" rel="noopener ugc nofollow" target="_blank">这个</a>查出来。</p><h1 id="28d7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">捆绑应用程序</h1><p id="8a71" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">现在让我们向package.json添加一个脚本，这样我们就可以随时轻松地构建我们的应用程序。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><blockquote class="mz na nb"><p id="5965" class="kv kw nc kx b ky kz jr la lb lc ju ld nd lf lg lh ne lj lk ll nf ln lo lp lq ij bi translated">请随意从命令行运行webpack-cli。我添加了一个脚本，这样如果你想为开发、生产、登台等添加不同的脚本，也许可以在你的脚本中添加<a class="ae lr" href="https://webpack.js.org/configuration/mode/" rel="noopener ugc nofollow" target="_blank">模式</a>，你现在将知道如何以及在哪里添加。</p></blockquote><p id="c694" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">终于我们准备好跑了</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="1757" class="mu lt iq mq b gy mv mw l mx my">npm run build</span></pre><p id="d3c3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您已经完全理解了我的意思，那么这应该会在项目根目录下的dist文件夹中创建一个main.js文件。我们现在可以将这个捆绑的JavaScript附加到我们的html中。</p><h1 id="3f76" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">运行捆绑的应用程序</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="6b75" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">按照上面的建议添加脚本标签后，在浏览器中打开你的index.html，瞧，你会看到“Hello World”！就是这样。您已经捆绑了您的第一个应用程序。很简单，对吧？</p><h1 id="64af" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">设置HtmlWebpackPlugin</h1><p id="4ba3" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">手动附加捆绑的JS，就像我们上面做的那样，都很好，如果我们的捆绑包中只有一个JavaScript文件，那么我们最好就此打住。但是在一个真实的应用程序中，你将使用各种webpack <a class="ae lr" href="https://webpack.js.org/plugins/split-chunks-plugin/" rel="noopener ugc nofollow" target="_blank">插件</a>来分块你的JavaScript文件，甚至可能为了缓存的目的而散列它们。所有这一切意味着，我们不想手动将我们的捆绑脚本导入到我们的HTML中。</p><p id="3144" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了自动化这个过程，让我们使用以下命令安装html-webpack-plugin:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="2a31" class="mu lt iq mq b gy mv mw l mx my">npm i -D html-webpack-plugin</span></pre><p id="a013" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们修改我们的配置文件来包含这个插件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="e3d1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们所做的是包含插件，并为其提供一个模板html，webpack将在构建后将捆绑的JavaScript附加到该模板html中。</p><p id="e417" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以继续从src/index.html中删除<script>标签&lt;/root&gt;</script></p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="1d5e" class="mu lt iq mq b gy mv mw l mx my">npm build</span></pre><p id="52ee" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您会注意到，不仅main.js是在dist文件夹中创建的，而且还有一个index.html——main . js会自动包含在内！</p><h1 id="7252" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">下一步是什么？</h1><p id="d8b6" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">您可能已经注意到，我们没有对“index.css”文件做任何事情。我想把这个留给你们做练习。查找style-loader和css-loader，看看能否将index.css导入到App.js文件中。这个过程与我们使用babel-loader非常相似。您需要首先编写一个测试来过滤掉。css文件，然后使用样式和css加载器。</p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="0a41" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我更进一步，用webpack-dev-server配置了我的应用程序。你可以在我的<a class="ae lr" href="https://github.com/Schapagain/tutorial-react-webpack" rel="noopener ugc nofollow" target="_blank"> github </a>里找到完成的项目。要启动dev服务器，只需运行(当然是在安装npm之后):</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="6637" class="mu lt iq mq b gy mv mw l mx my">npm run start</span></pre><p id="141d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为dev-server设置了热重装，所以在对应用程序进行任何更改后，您不再需要刷新浏览器。</p><p id="b31f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>