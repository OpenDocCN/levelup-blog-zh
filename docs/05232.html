<html>
<head>
<title>UTF: The Reason You Can Read This Medium Story 👀</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">UTF:你之所以能读到这个媒介故事👀</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/utf-the-reason-you-can-read-this-medium-story-63bb37f18280?source=collection_archive---------12-----------------------#2020-08-13">https://levelup.gitconnected.com/utf-the-reason-you-can-read-this-medium-story-63bb37f18280?source=collection_archive---------12-----------------------#2020-08-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="deb0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这是每个开发人员都需要知道的最低要求。👨🏽‍💻</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8194d9253761a496be695aba18342ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9BEssBZB_vbjSgn3ODbkeA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">UTF——由皮尤什·科赫哈尔创作</figcaption></figure><h1 id="67e1" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">什么是Unicode❓</h1><p id="e85a" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Unicode是一套表示字符的标准。这只是一个巨大的字符列表，包含国际语言、表情符号、字形等的标准。它甚至包含了尚不存在的角色标准。每个字符由十六进制的“U+xxxx”表示(不要担心，以后会有意义)。有许多编码可用于表示字符，但我们将把范围限制在ASCII和UTF (Unicode转换格式)编码，如UTF-8、UTF-16和UTF-32。</p><p id="3969" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在我们深入研究ASCII和UTF之前，让我们先来看看理解这些概念所需的一些术语。</p><p id="9d85" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">请记住，我们在设备上看到的一切最终都会转化为二进制代码。类似地，使用不同的字符编码将字符编码成二进制。</p><p id="5322" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">对字符进行编码和解码的基本过程是，我们将<strong class="lp ir">字节/八位字节</strong>转换为<strong class="lp ir">代码单元</strong>，代码单元转换为<strong class="lp ir">代码点</strong>，代码点再转换为<strong class="lp ir">字符</strong>，反之亦然。让我们来理解这些术语。</p><h2 id="ad5b" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">字节/字/八位字节</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/c39b8801a8e1f337c76c767d57c7f009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q4ww1MefzYTG-qTqk7dc7g.png"/></div></div></figure><p id="d9c2" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这些是8位的集合，如→10010011</p><h2 id="e475" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">代码单位</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/55690dbbf952afa0a71d591bbd754f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LrcgwvxLweqhESVAW4au8Q.png"/></div></div></figure><p id="ff25" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">它是固定大小、固定数量的八位字节的二进制数据。这只是意味着对于每种编码，我们都有一些固定数量的八位字节。以下是一些例子:</p><p id="cae9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">对于UTF-8，1个代码单元→8位→1个八位字节</p><p id="8e7f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">对于UTF-16，1个代码单元→16位→ 2个八位字节</p><p id="a139" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">对于UTF-32，1个代码单元→32位→ 4个八位字节</p><h2 id="2909" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">代码点</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/4f90a9debbd7dcd773026c6bfda2b0da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BFp6t2mNG8idEFwHjnFEQ.png"/></div></div></figure><p id="fabb" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">它是唯一标识给定字符的整数值。根据字符，代码点可以由一个或多个代码单元组成。</p><p id="4b07" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">例如:对于字符“A”码位→UTF中的U+0041-8→11000011 10101001</p><p id="702a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在上面的例子中，第一个八位字节是一个代码单元，第二个八位字节是另一个代码单元。所以，我们用了2个代码单位来表示字符“A”。</p><p id="34b8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">注意:</strong>您可能想知道我们是如何得到代码点值的，为什么是这些特定的值。老实说，这没什么逻辑可言。代码点只是一个抽象的概念，它描述了我们人类希望如何表示每个字符，以便让计算机理解。这就是全部了。</p><h2 id="e316" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">字符集</strong></h2><p id="b5fc" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">要表示的字符列表。</p><h2 id="53ca" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">编码</strong></h2><p id="cbb3" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">它是将字符转换成字节的过程。点击了解更多关于编码的信息。</p><h2 id="f770" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">代码页</strong></h2><p id="60d4" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">它是字符集和编码的结合。</p><h1 id="9f0e" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">美国信息交换标准代码</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/efc5d11b6832cbc9c8272c2a3fa1142e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZbZQbTA4POFfuyUrT9AnQ.png"/></div></div></figure><p id="5c83" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">它不是一种编码。这是一个代码页，即类似UTF的字符集，但字符有限。你问几个人物？才128。足够的英语语言字符(a-z和A-Z)，数字(0-9)和一些控制字符，如退格等。正如我们所看到的，这个字符集甚至没有考虑我们使用的数千种其他语言。但是这个字符集是Unicode的基础，Unicode是一个比ASCII优越得多的字符集。Unicode也是ASCII的超集。这意味着Unicode的前128个字符与ASCII匹配。这里有一些有趣的东西。如果我们突然改变说英语的人的字符集，他们甚至不会注意到任何变化，但世界上其他人将不得不改变他们的字符编码。事情就是这样！当我们从ASCII转换到Unicode时，说英语的人没有注意到，但是其他国家(尽管花了一些时间)必须将他们的字符编码成Unicode。随着互联网的发展，信息传递变得更加迅速，我们需要每个人都遵循相同的字符编码，这样每个人都能收到想要的信息。</p><h1 id="826c" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">UTF</h1><p id="5304" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">它代表“<strong class="lp ir"> Unicode转换格式</strong>”这是一个总括术语，指不同类型的字符编码。我们有UTF-7、UTF-8、UTF-16和UTF-32。末尾的数字表示代表每个字符所需的位数。此外，我们将只讨论UTF-32、UTF-16和UTF-8，因为它们更常见。</p><h1 id="b8ce" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">UTF-32</h1><p id="89f7" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">如上所述，具有UTF的数字表示代表一个字符所需的位数。这里是32，这意味着每个代码点有一个32位的字。如此大的空间足以代表地球上任何已知的字符/符号。很迷人，不是吗？虽然一切都可以用UTF-32表示，但这并不意味着我们应该这样做。这是因为表示每个字符需要很大的空间，即32位，这是很浪费的。例如，字母8可以仅用8位来表示。我们不需要32位。这就是它没有被广泛使用的原因。您可能还会看到UTF-32被称为USC-4(通用字符集-4)。关于原因，我们不会涉及太多细节。但简短的回答是，该标准最初被命名为USC-4，UTF-32只是它的一个子集，但经过多年的修订，它们基本上被认为是相同的。</p><h1 id="e9b9" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">UTF-16</h1><p id="05e4" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">用16位来表示一个字符，即每个代码单元是16位。每个码点可以有一到两个码单元。与UTF-32不同，在UTF-32中，我们只有一个代码单元来表示一切，而UTF-16可能需要一个或两个代码单元，这取决于字符。</p><p id="99e4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">它有以下代码单元:</p><h2 id="3c45" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">→单个16位代码单元</h2><p id="e587" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">这些字符只需要一个16位代码单元来表示一个字符。代码点U+0000到U+DTFF和U+E000到U+FFFF由单个代码单元表示，在这种情况下它等于代码点。我们很快就会调查此事，请耐心等待！😬</p><h2 id="e6a6" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">→两个16位代码单元</h2><p id="6fd1" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">为了用2个代码单元表示一个字符，我们需要<strong class="lp ir">代理</strong>。</p><p id="3013" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">代理是两个代码单元的序列，它们一起形成单个代码点。这些是代码单元的前6位。这些有两种类型:</p><ul class=""><li id="e59d" class="ne nf iq lp b lq mj lt mk lw ng ma nh me ni mi nj nk nl nm bi translated"><strong class="lp ir">高代</strong> →这些都在U+D800到U+D8FF的范围内。分别表示如下:<br/>11011<strong class="lp ir">0</strong>xxxxxxxxxxxxxxx</li><li id="bc72" class="ne nf iq lp b lq nn lt no lw np ma nq me nr mi nj nk nl nm bi translated">低代理人 →这些在U+DC00到U+DCFF的范围内。分别表示如下:<br/>11011<strong class="lp ir">1</strong>xxxxxxxxxxxx</li></ul><p id="66de" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">仔细看，高代理的第6位是0，低代理的第6位是1。</p><p id="3fe4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">让我们看看第一个使用UTF-16的例子。</p><p id="7d3c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们如何得到这些任意的代码点值U+xxxx？作为开发人员，我们给每个字符一个特定的十六进制代码，然后我们使用下面的过程来获得代码点值。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="ea42" class="mo kw iq nt b gy nx ny l nz oa">+-----------+-----------+----------------+<br/>| Character | Hex Code  | Character Name |<br/>+-----------+-----------+----------------+<br/>|     💩    | D83D DCA9 |   PILE OF POO  |<br/>+-----------+-----------+----------------+</span></pre><p id="59c5" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">步骤1:将十六进制转换为二进制</p><p id="e151" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi">→ 110110000011110 1101110010101001</p><p id="2d45" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">第二步:获得高低代理人</p><p id="0cab" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">→110110</strong>000011110<strong class="lp ir">110111</strong>0010101001</p><p id="7b3a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">第三步:放弃代理人</p><p id="0b4d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi">→ 000011110 0010101001</p><p id="912d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">第四步:组合代理人</p><p id="2b0e" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi">→ 0000111100010101001</p><p id="5b65" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">步骤5:将二进制转换回十六进制</p><p id="0e0e" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">→ F4A9</p><p id="9831" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">第六步:添加0x10000</p><p id="462a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">注意</strong>:由两个代码单元组成的字符总是在10000以上。因此，我们将它加到十六进制中，以获得正确的码位值。</p><p id="2666" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">F4A9 + 0x10000 → 1F4A9。</p><p id="9f27" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">因此，码位= <strong class="lp ir"> U+1F4A9 </strong></p><p id="d56c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">现在，如果我们看到一些东西，我们将从两个16位代码单元中丢弃两个6位代理。这样我们就剩下32–12 = &gt; 20位了。这意味着2 ⁰是可以用UTF-16表示的最高代码位。</p><h2 id="f633" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">UTF-16用在哪里？</h2><p id="93d7" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">它被JavaScript、Java、纯文本文字处理器和一些其他应用程序使用。</p><p id="1dce" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">那么，我们完成UTF-16了吗？还没有，我们只需要担心一件非常小的事情，那就是<strong class="lp ir">大端(BE) </strong>和<strong class="lp ir">小端(LE) </strong>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="f1ba" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">很简单。</p><p id="3e56" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">大端(BE) </strong> →当高位代理人在前，低位代理人在后。</p><p id="e04d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">小端(了)</strong> →低代在前，高代在后。</p><p id="7228" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">为什么我们需要这个“<strong class="lp ir"><em class="nd"/></strong>”？嗯，因为开发者对如何处理他们的数据有自己的看法。一些人选择了big(仍然是最常见的),其他人选择了little endian。</p><p id="77d3" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">回到我们的💩举例！</p><p id="5262" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">UTF-16BE</strong>→D8<strong class="lp ir">3D</strong>DC<strong class="lp ir">A9</strong></p><p id="d172" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">UTF-16LE</strong>→<strong class="lp ir">3D</strong>D8<strong class="lp ir">A9</strong>DC</p><p id="d6d8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">Amiga 6800和TCP(通过互联网发送数据)使用Big Endian。</p><p id="7378" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">x86计算机体系结构使用Little Endian。</p><p id="3087" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">因此，您应该知道您要将数据传输到哪台机器，以及该机器使用什么编码。</p><h1 id="5b2d" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">UTF-8</h1><p id="b236" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在UTF-8中，代码单元是八位字节，即8比特。与UTF-16不同，在UTF-16中，我们用一个或两个代码点来表示一个字符，在UTF-8中，一个字符可以用每个代码点一到四个代码单元来表示。</p><p id="6f02" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">它也与ASCII兼容。如果数据流被破坏或者丢失了一个字节，我们也可以恢复UTF-8编码的数据，这在UTF-16和UTF-32中是不可能的。</p><p id="1259" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">UTF-8有3种类型的代码单元:</p><h2 id="c554" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">→单个8位代码单元</h2><p id="5b92" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">这里，一个字符由一个字节表示。</p><p id="e2ba" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">示例:</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="46ae" class="mo kw iq nt b gy nx ny l nz oa">+-----------+------------+-----+------------------------+<br/>| Character | Code-point | hex | Name                   |<br/>+-----------+------------+-----+------------------------+<br/>|     A     |   U+0041   |  41 | LATIN CAPITAL LETTER A |<br/>+-----------+------------+-----+------------------------+</span><span id="52dd" class="mo kw iq nt b gy od ny l nz oa">+----------+-----+----------+------------------------+<br/>| Encoding | Hex | Binary   | Name                   |<br/>+----------+-----+----------+------------------------+<br/>|   UTF-8  |  41 | 01000001 | LATIN CAPITAL LETTER A |<br/>+----------+-----+----------+------------------------+</span></pre><h2 id="fded" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">→N的第一个代码单元(N = 2，3，4)</h2><h2 id="d888" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">→非第一代码单元</h2><p id="8b2d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">第一代码单元和非第一代码单元都给出了表示一个字符的八位字节数的信息。</p><p id="87db" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">让我们举个例子来更好地理解它。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="29bf" class="mo kw iq nt b gy nx ny l nz oa">+-----------+------------+-------+---------------------------------+<br/>| Character | Code Point | Hex   | Name                            | <br/>+-----------+------------+-------+----------------------------------<br/>|     é     |   U+00E9   | C3 A9 | LATIN SMALL LETTER E WITH ACUTE | <br/>+-----------+------------+-------+---------------------------------+</span></pre><p id="69e8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">UTF-8 = &gt;<strong class="lp ir">11</strong>000011<strong class="lp ir">10</strong>101001</p><p id="33c7" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">第一个八位字节中1的数量表示存在多少个八位字节，非第一个八位字节由<em class="nd">10 xxxxxxxx</em>表示。剩下的位用来表示字符。</p><p id="060c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">将十六进制转换为码位的过程与我们在UTF-16中所做的一样，但是在这个特殊的例子中，因为我们有一个码位，所以我们不需要添加<em class="nd"> 0x10000 </em>。</p><p id="b641" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">步骤1:将十六进制转换为二进制</p><p id="719b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">→<strong class="lp ir">11</strong>000011<strong class="lp ir">10</strong>101001</p><p id="b8b4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">步骤2:丢弃第一个和非第一个N个代码单元。</p><p id="e913" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi">→ 000011 101001</p><p id="9bc9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">步骤3:合并八位字节</p><p id="8496" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi">→ 000011101001</p><p id="fa1c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">步骤4:转换回十六进制</p><p id="5cc7" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">→ 00E9</p><p id="e33c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">因此，代码点是<strong class="lp ir"> U+00E9 </strong>。</p><p id="1160" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">让我们看另一个例子，我们的朋友💩。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="6d44" class="mo kw iq nt b gy nx ny l nz oa">+-----------+------------+-------------+-------------+<br/>| Character | Code Point | Hex         | Name        |<br/>+-----------+------------+-------------+-------------+<br/>|     💩    |   U+1F4A9  | F0 9F 92 A9 | PILE OF POO |<br/>+-----------+------------+-------------+-------------+</span></pre><p id="4062" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">UTF-8→<strong class="lp ir">1111</strong>0000<strong class="lp ir">10</strong>011111<strong class="lp ir">10</strong>010010<strong class="lp ir">10</strong>101001</p><p id="5eb7" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在上面的例子中，我们第一个代码单元有4个1。因此，我们有4个八位字节，对于每个非第一个八位字节，它由10后跟字符位来表示。<br/> <br/>当我们按照步骤从十六进制中获取码位时，我们得到。<br/>000011111010010101001→<strong class="lp ir">0F49A</strong>。<br/>现在，由于它使用2个以上的代码点来表示这个字符，我们像在UTF-16中一样添加0x10000来获得值:<br/>0F49A+0x 10000 = 1F49A→<strong class="lp ir">U+1F49A</strong></p><h2 id="2e9c" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">为什么使用UTF-8？</h2><p id="67c0" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">UTF-8正在成为各地默认的字符编码系统(像万维网和Linux/UNIX)。它可以使用可变代码单元表示所有已知可用的字符，从而提高效率。它还消除了服务器端逻辑为提供的每个页面或每个输入表单提交单独确定字符编码的需要。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/9a3bedad95691597f9cbc18ea901e2da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AvjKv-s1ZVte_am7gBYGPA.png"/></div></div></figure><p id="389f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">上图向我们展示了UTF八号协议的日益普及</p><h1 id="7784" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">JavaScript和Unicode</h1><p id="8e50" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">不要把字符串看作是字符的集合，而要把它们看作是代码单元值的集合。需要注意的一点是，我们不能仅仅从一个字符串中确定代表一个代码点的代码单元。</p><p id="2db1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">例如:</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="9021" class="mo kw iq nt b gy nx ny l nz oa">console.log(‘trés’);        //=&gt; ‘trés’</span><span id="e403" class="mo kw iq nt b gy od ny l nz oa">`console.log(‘tre\u0301s’) //=&gt; ‘trés’</span></pre><p id="141b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在这里，<em class="nd">' tre \u s '</em>和'<em class="nd"> tre\u0301s' </em>都被呈现为相同的字符序列，但是具有不同的代码单元。</p><p id="6698" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">要在JavaScript中呈现Unicode，我们有以下选项:</p><p id="e18f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">十六进制转义序列</strong></p><p id="5f56" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">要表示一个Unicode字符，我们只需使用格式:\x <hex>，其中\x是一个前缀，后跟一个固定长度为2位数的十六进制数<hex>。它的范围有限:从U+00到U+FF</hex></hex></p><p id="7b83" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">例子</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="7593" class="mo kw iq nt b gy nx ny l nz oa">const js = ‘\x4a\x41\x56\x41\x53\x43\x52\x49\x50\x54’</span><span id="451d" class="mo kw iq nt b gy od ny l nz oa">console.log(js,js.length,‘JAVASCRIPT’===js) //=&gt; JAVASCRIPT 10 true</span></pre><p id="a451" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">为了表示字符串'<em class="nd"> JAVASCRIPT </em>'，我们可以将十六进制序列组合在一起。此外，转义序列等同于只用普通字符编写的文本。这是因为这些普通字符最终被解码得到正确的二进制序列，因此它们是匹配的。</p><h2 id="604a" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak"> Unicode转义序列</strong></h2><p id="3dc7" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">为了表示一个Unicode字符，我们只需使用格式:\u <hex>。其中<hex>的固定长度为4。它只有从U+0000到U+FFFF的有限范围。</hex></hex></p><p id="7079" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">像在<em class="nd">例子中一样，我们使用Unicode转义序列来呈现字符。</em></p><p id="8186" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">另一个例子</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="b73f" class="mo kw iq nt b gy nx ny l nz oa">const poo = ‘\uD83D\uDCA9’;</span><span id="1718" class="mo kw iq nt b gy od ny l nz oa">console.log(poo);         // =&gt; ‘💩’</span><span id="b43d" class="mo kw iq nt b gy od ny l nz oa">console.log(poo.length); // =&gt; 2</span></pre><p id="1cf7" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们的便便表情符号的长度是2，因为它由2个代码单元表示。<strong class="lp ir">(记得我们计算过UTF-16段的码位！)</strong></p><p id="530d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">现在，当我们试图删除由2-4个代码单元表示的字符时，事情开始变得奇怪了。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="965d" class="mo kw iq nt b gy nx ny l nz oa">console.log(‘🧑🏾’);</span><span id="934f" class="mo kw iq nt b gy od ny l nz oa">console.log(‘🧑🏾’.length); // =&gt; 4</span><span id="3867" class="mo kw iq nt b gy od ny l nz oa">console.log(‘🧑’)</span><span id="9612" class="mo kw iq nt b gy od ny l nz oa">console.log(‘🧑’.length) // =&gt; 2</span></pre><p id="4224" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在第2行，我们有一个成年黑皮肤表情符号人，他的长度等于4，因为它由4个代码单元表示。为什么？这是因为这个表情符号包含两条信息:表情符号本身和颜色信息。更具体地说，它是“<strong class="lp ir">成人</strong>角色和“<strong class="lp ir">表情符号修饰符FITZPATRICK TYPE-6 </strong>角色”的组合。</p><p id="bcd9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">现在，将第1行复制并粘贴到第3行，并尝试使用backspace/delete删除该字符。我们会看到这个角色没有被删除，而是变成了更浅肤色的表情符号。这是因为我们删除了由2个代码单元表示的颜色信息。因此，我们只剩下一个长度为2的普通表情符号。</p><h2 id="d034" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">码位转义序列</strong></h2><p id="16c5" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">它类似于Unicode转义序列，但<hex>的可变长度为1-6。它可以表示U+0000到U+10FFFF之间的字符。其格式为:\u{ <hex> }</hex></hex></p><p id="bd49" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">示例:</p><p id="e19d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">🧑的代码是U+1F9D1。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="8bbd" class="mo kw iq nt b gy nx ny l nz oa">console.log(‘\u{1F9D1}’) //=&gt; ‘🧑’</span></pre><h2 id="3082" class="mo kw iq bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">标准化长度</h2><p id="cd5c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">规范化字符串会返回序列中正确的字符数。我们为什么需要它？因为直到现在，我们都是基于代码单元来计算长度的。</p><p id="bf02" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">问题来了。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="3c70" class="mo kw iq nt b gy nx ny l nz oa">console.log(‘tre\u0301s’.length); //=&gt; 5</span></pre><p id="ac9a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们得到5是因为‘e’与另一个锐字符<strong class="lp ir"> </strong>组合在一起。这些有不同的代码点。因此，当我们为每个字符{t:1}、{r:1}、{e:1}、{<strong class="lp ir">:1 }、{s:1}添加1个码位时，我们得到5个码位。</strong></p><p id="5208" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">如果我们想将重音视为字符的一部分，我们使用normalize()。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="00e3" class="mo kw iq nt b gy nx ny l nz oa">console.log(‘tre\u0301s’.normalize().length); // =&gt; 4</span></pre><p id="ff80" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">但是这种标准化有其局限性。它不能处理一个以上的组合字符。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="d700" class="mo kw iq nt b gy nx ny l nz oa">const str = ‘tre\u0327\u0301s’</span><span id="987e" class="mo kw iq nt b gy od ny l nz oa">console.log(str);                    //=&gt; trȩ́s</span><span id="060d" class="mo kw iq nt b gy od ny l nz oa">console.log(str.length);             //=&gt; 6</span><span id="a0f9" class="mo kw iq nt b gy od ny l nz oa">console.log(str.normalize().length); // =&gt; 5</span></pre><p id="f8b1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这里规范化的值应该是4，但是由于normalize()的工作方式，我们得到了5。</p><p id="f120" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">因此，在计算其他国际语言的带重音的字符长度时要小心。</p><h1 id="ad7a" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak"> HTML和Unicode </strong></h1><p id="cd48" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在我们的HTML文档中，我们写。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="2fde" class="mo kw iq nt b gy nx ny l nz oa">&lt;head&gt;<br/>  &lt;meta charset="UTF-8"&gt;<br/>&lt;/head&gt;</span></pre><p id="dd03" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这意味着该网页将呈现任何可以用Unicode表示的字符，并将使用UTF-8编码来表示它。要了解更多，请看我在meta <a class="ae nc" rel="noopener ugc nofollow" target="_blank" href="/you-dont-know-meta-a1ee7e381bc1">上的故事。</a></p><h1 id="53e1" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">包裹</h1><p id="bead" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">字符编码是怪异的，迷人的，有趣的。不同的字符编码将呈现不同的字符。应该根据代码点而不是单个字符来理解字符串。Unicode和UTF是你，我亲爱的读者，能够阅读这篇文章的原因。</p><p id="5d58" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir"> <em class="nd">那都是乡亲们！</em>T11】🚀</strong></p></div></div>    
</body>
</html>