<html>
<head>
<title>Modifying PDF Files Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python修改PDF文件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/modifying-pdf-files-using-python-64374fd0da2c?source=collection_archive---------2-----------------------#2020-07-13">https://levelup.gitconnected.com/modifying-pdf-files-using-python-64374fd0da2c?source=collection_archive---------2-----------------------#2020-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6925" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">指南提取数据，连接，合并，加密和解密PDF文件</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/79018c9f2f974921260517f5722e5cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*01OHmJw9Egr_C4gO"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">维克多·塔拉舒克在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="fd88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过互联网共享信息的最常见的文档格式之一是PDF或可移植文档格式。了解如何使用Python修改PDF文件是很有用的。</p><p id="43af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，您需要在系统上安装一个<strong class="ky ir"> <em class="ls"> PyPDF2 </em> </strong>包。如果没有，请在您的控制台上运行以下命令-</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="5679" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; pip3 install PyPDF2</span></pre><p id="3d00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将通过简单的操作来开始。</p><h1 id="b58f" class="me lz iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">使用<em class="mv"> PdfFileReader类</em>提取数据</h1><p id="cf44" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">您需要一个来自接受PDF文件路径的<em class="ls"> PyPDF2 </em>的<em class="ls"> PdfFileReader </em>类的实例。该实例将允许您使用访问PDF文件中的数据所需的所有必要方法和属性。</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="bf54" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; <!-- -->from PyPDF2 import PdfFileReader<br/>&gt;&gt; pdf_reader = PdfFileReader("<!-- -->SamplePDFDocument.pdf<!-- -->")</span></pre><h2 id="2ae1" class="ly lz iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">A.提取元数据</h2><p id="8ea0" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">创建时嵌入的每个PDF文件都有关联的元数据。您可以使用<em class="ls"> documentInfo </em>属性来获取它。</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="de74" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; <!-- -->pdf_reader<!-- -->.documentInfo<br/>{'/Author': 'Amit Randive', '/Creator': 'Microsoft® Word for Office 365', '/CreationDate': "D:20200708221150+05'30'", '/ModDate': "D:20200708221150+05'30'", '/Producer': 'Microsoft® Word for Office 365'}</span></pre><p id="dd1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出可能看起来像一本字典，但它不是。您可以将每个项目作为一个属性来访问。</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="f930" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; <!-- -->pdf_reader<!-- -->.documentInfo.producer<br/>Microsoft® Word for Office 365</span></pre><p id="45b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你也可以得到PDF文件的页数信息-</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="7760" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; <!-- -->pdf_reader<!-- -->.<!-- -->getNumPages()<br/>3</span></pre><h2 id="a5a4" class="ly lz iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">B.提取文本数据</h2><p id="6ddd" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated"><em class="ls"> PyPDF2 </em>包中的每个页面都由<em class="ls"> PageObject </em>类表示。您可以使用此类的实例与PDF页面进行交互。这个实例可以使用<em class="ls"> PdfFileReader </em>类的<em class="ls"> getPage() </em>方法捕获。</p><ul class=""><li id="8418" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">要获得准确的页面对象，您需要将页面索引号传递给该方法。</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="d1e7" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; pdf_page = pdf.getPage(0)</span></pre><ul class=""><li id="4e11" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">现在我们有了页面对象，是时候从中提取文本数据了。</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="722a" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; pdf_page.extractText()<br/>This is a sample pdf document generated to give a demo for PDF modification using python package PyPDF2.</span></pre><ul class=""><li id="28d0" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">如果你想一次遍历所有的页面，那么<em class="ls"> PdfFileReader </em>有<em class="ls"> pages </em>属性可以帮助你做到这一点</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="43b7" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;for page in <!-- -->pdf_reader<!-- -->.pages:<br/>      print(page.extractText())</span></pre></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h1 id="a9b8" class="me lz iq bd mf mg oc mi mj mk od mm mn jw oe jx mp jz of ka mr kc og kd mt mu bi translated">使用PDF writer类创建新的PDF文件</h1><p id="cc69" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">PdfFileWriter 类允许你创建新的PDF文件。这个类的实例就像空白的PDF文件。在继续保存之前，您需要添加空白页。</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="cb7f" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; from PyPDF2 import PdfFileWriter<br/>&gt;&gt; pdf_writer = PdfFileWriter()<br/>&gt;&gt; pdf_writer.addBlankPage(width=72,height=72)</span></pre><ul class=""><li id="395d" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">对于一个新的空白页，你需要指定宽度和高度，这决定了页面的尺寸，单位叫做<strong class="ky ir">点</strong>。一点等于1/72英寸，所以上面的代码向pdf_writer 的<em class="ls">添加了一个一英寸见方的空白页。</em></li><li id="e70c" class="nm nn iq ky b kz oh lc oi lf oj lj ok ln ol lr nr ns nt nu bi translated">要将<em class="ls"> pdf_writer </em>的内容写入pdf文件，以二进制写入模式将文件对象传递给<em class="ls"> pdf_writer.write()。</em></li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="3c4e" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; from pathlib import Path<br/>&gt;&gt;&gt; with Path("NewFile.pdf").open(mode="wb") as output_file:<br/>        pdf_writer.write(output_file)</span></pre><p id="007f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将在您当前的工作目录中创建一个新的PDF文件。如果你打开它，你会看到一个只有一英寸见方的空白页面的文档。</p><blockquote class="om on oo"><p id="31f4" class="kw kx ls ky b kz la jr lb lc ld ju le op lg lh li oq lk ll lm or lo lp lq lr ij bi translated">PdfFileWriter有一个很大的问题，它的对象可以写入新的PDF文件，但是除了空白页之外，它们不能从头开始创建新的内容。为此，您可以使用另一个名为<strong class="ky ir"> reportlab的包。</strong></p></blockquote><p id="6c4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以添加多个页面，并使用从另一个PDF中提取的数据进行书写。使用<em class="ls">的PdfFileReader </em>类对象来读写它，使用<em class="ls">的pdffilerwriter</em>类对象是如此简单。搞定了。</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h1 id="4fcb" class="me lz iq bd mf mg oc mi mj mk od mm mn jw oe jx mp jz of ka mr kc og kd mt mu bi translated">使用PdfFileMerger类连接和合并</h1><p id="95ec" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">让我们向前一步，看看我们如何连接和合并pdf。为此，<em class="ls"> PyPDF2 </em>为<em class="ls">提供了一个PdfFileMerger </em>类，它也能够编写PDF文件。但是它与<em class="ls"> PdfFileWriter </em>类有什么不同呢？</p><p id="a9dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">两者的主要区别在于，<em class="ls"> PdfFileWriter </em>类只能将页面追加或连接到末尾，而<em class="ls"> PdfFileMerger </em>可以在任何位置插入或合并页面。</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="6392" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; from PyPDF2 import PdfFileMerger<br/>&gt;&gt; pdf_merge = PdfFileMerger()</span></pre><p id="9c18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls"> PdfFileMerger </em>实例最初为空。您需要添加一些页面来做其他事情。</p><h2 id="cfe2" class="ly lz iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">A.串联</h2><p id="ccfa" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated"><em class="ls"> PdfFileMerger </em>类允许使用<em class="ls"> append() </em>方法将一个或多个pdf连接到现有文件。</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="cba9" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; list_of_pdfs=['Sample1.pdf','Sample2.pdf', 'Sample3.pdf']<br/>&gt;&gt; for path in list_of_pdfs:<br/>       pdf_merge.append(path)</span></pre><p id="0b9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，<em class="ls">list _ of _ pdf</em>中的所有pdf被连接到<em class="ls"> pdf_merge </em>对象中。您需要将它写入输出文件。以二进制写模式打开一个新文件，然后将file对象传递给<em class="ls"> pdf_merge.write() </em>方法。</p><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="f987" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; <!-- -->with Path("concatenated.pdf").open(mode="wb") as output_file:<br/>        pdf_merge.write(output_file)</span></pre><p id="f858" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在你当前的工作目录中，你会有一个concatenated.pdf文件。</p><h2 id="5a8f" class="ly lz iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">B.合并</h2><p id="7acb" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">使用<em class="ls"> PdfFileMerger </em>类的<em class="ls"> merge() </em>方法合并或插入另一个PDF到现有文件。该方法需要您想要插入另一个PDF的页面的索引号和包含其路径的字符串。</p><ul class=""><li id="9522" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">创建一个PdfFileMerger类对象，它只是一个空对象。您需要添加一个想要插入或合并另一个PDF的PDF文件。</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="6473" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; pdf_merge = PdfFileMerger()<br/>&gt;&gt;&gt; pdf_merge.append("Sample1.pdf")</span></pre><ul class=""><li id="5388" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">对<em class="ls"> pdf_merge </em>对象调用<em class="ls"> merge </em>()方法，并传递另一个pdf的索引和路径。</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="49b4" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; pdf_merge.merge(2,"Sample3.pdf")</span></pre><p id="42bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">Sample3.pdf</em>中的每一页都被插入到索引2处的页面之前。当前索引为2的页面将被Sample3.pdf<em class="ls">的页面数量所移动。</em></p><ul class=""><li id="9e78" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">将合并的PDF写入输出文件:</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="5fe7" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; with Path("Merged.pdf").open(mode="wb") as output_file:<br/>         pdf_merger.write(output_file)</span></pre><p id="4f97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">连接和合并pdf是非常有用和常见的场景。自动化可以节省大量的时间和人力。</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h1 id="8e73" class="me lz iq bd mf mg oc mi mj mk od mm mn jw oe jx mp jz of ka mr kc og kd mt mu bi translated">PDF文件的加密和解密</h1><p id="cbc3" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">加密的PDF文件在互联网上共享机密信息非常流行。<em class="ls"> PyPDF2 </em>不仅允许您使用受密码保护的文件，还允许您为PDF文件添加密码保护。</p><h2 id="8d4a" class="ly lz iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">A.加密</h2><p id="4254" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated"><em class="ls"> PdfFileWriter </em>类的<em class="ls"> encrypt() </em>方法用于给PDF文件添加密码保护。该方法允许设置两种类型的密码-</p><ol class=""><li id="737a" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr os ns nt nu bi translated"><strong class="ky ir">用户密码</strong> -允许PDF以只读模式打开，可以使用<em class="ls"> user_pwd </em>参数设置。</li><li id="4b05" class="nm nn iq ky b kz oh lc oi lf oj lj ok ln ol lr os ns nt nu bi translated"><strong class="ky ir">所有者密码</strong> -允许PDF不受任何限制地打开。您可以阅读甚至编辑打开的文档。可以使用<em class="ls"> owner_pwd </em>参数设置该密码</li></ol><p id="51cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们为<em class="ls">SecretDocument.pdf-</em>添加密码保护</p><ul class=""><li id="e138" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">打开文档。</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="ff7c" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt; pdf_reader = PdfFileReader("SecretDocument.pdf")</span></pre><ul class=""><li id="0734" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">由于<em class="ls"> encrypt() </em>方法属于<em class="ls"> PdfFileWriter </em>类，我们需要它的实例，它最初是空的。您可以使用<em class="ls">appendPagesFromReader()</em>方法将页面从pdf_reader直接添加到这个新创建的实例中</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="2373" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; pdf_writer = PdfFileWriter()<br/>&gt;&gt;&gt; pdf_writer.appendPagesFromReader(pdf_reader)</span></pre><ul class=""><li id="f42f" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">是时候添加密码了</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="0cc9" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; pdf_writer.encrypt(user_pwd="M@yTheF0rceBeWithU")</span></pre><p id="cc18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，由于我没有给<em class="ls"> owner_pwd </em>，默认值将设置为与<em class="ls"> user_pwd相同。</em></p><ul class=""><li id="7487" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">将加密文件写入输出文件-</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="9472" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; with Path("<!-- -->SecretDocument<!-- -->.pdf").open(mode="wb") as output_file:<br/>         pdf_writer.write(output_file)</span></pre><p id="dfdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您有了密码保护的PDF文件。无论何时打开它，系统都会提示您输入密码来访问它。</p><h2 id="7324" class="ly lz iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">B.[通信]解密</h2><p id="9d45" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated"><em class="ls"> PdfFileReader </em>类提供了<em class="ls"> decrypt() </em>方法对PDF文件进行解密。</p><p id="9542" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls"> decrypt() </em>方法接受<em class="ls">一个可以用来解密的密码</em>参数。打开PDF时您拥有的权限取决于您传递给<em class="ls">密码</em>参数的参数。</p><p id="367e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用相同的PDF，我们刚刚加密的密码，即<em class="ls">SecretDocument.pdf</em>。</p><ul class=""><li id="e52c" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">创建<em class="ls"> PdfFileReader </em>实例-</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="6f23" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; pdf_reader = PdfFileReader("SecretDocument.pdf")</span></pre><ul class=""><li id="27d7" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">如果你试图在不提供密码的情况下访问任何页面或提取数据，看看会发生什么</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="027f" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt; pdf_reader.getPage(0)</span><span id="8a31" class="ly lz iq lu b gy ot mb l mc md">Traceback (most recent call last):<br/>File "..\Python\Python38\lib\site-packages\PyPDF2\pdf.py", line 1150, in getNumPages<br/>    raise utils.PdfReadError("File has not been decrypted")<br/>PyPDF2.utils.PdfReadError: File has not been decrypted</span></pre><p id="b18f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个<strong class="ky ir"><em class="ls"/></strong><em class="ls">pypdf 2 . utils . pdfreadererror</em><strong class="ky ir"><em class="ls"/></strong>异常会直接抛出，告诉你“<strong class="ky ir">文件还没有被解密</strong>”。</p><p id="70e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们解密我们的文档之前，您应该知道由<em class="ls"> decrypt() </em>方法返回的解密状态码。</p><ul class=""><li id="3f67" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">0-密码不正确。</li><li id="40f4" class="nm nn iq ky b kz oh lc oi lf oj lj ok ln ol lr nr ns nt nu bi translated">1-用户密码匹配。</li><li id="dce0" class="nm nn iq ky b kz oh lc oi lf oj lj ok ln ol lr nr ns nt nu bi translated">2-所有者密码匹配。</li></ul><pre class="kg kh ki kj gt lt lu lv lw aw lx bi"><span id="531c" class="ly lz iq lu b gy ma mb l mc md">&gt;&gt;&gt;<!-- -->pdf_reader.decrypt(password="<!-- -->M@yTheF0rceBeWithU<!-- -->")<br/>1</span></pre><p id="1321" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你可以自由地访问你解密的PDF文件的内容了:-)</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="0d74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这并不是PyPDF2功能的终结。还有更多！<em class="ls"> </em>它<em class="ls"> </em>使您能够执行复杂的操作，如旋转和裁剪PDF文件的页面。</p><p id="71ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你到达这里并理解了这篇文章中的一切，那么恭喜你！！您已经准备好开始自动化PDF文件修改任务。</p><p id="6ff5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">干杯！！</strong></p></div></div>    
</body>
</html>