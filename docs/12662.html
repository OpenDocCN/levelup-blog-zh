<html>
<head>
<title>Web App Page Crashed but No Exception Was Reported</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Web应用程序页面崩溃，但未报告异常</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/web-app-page-crashed-but-no-exception-was-reported-f9fa14c294b7?source=collection_archive---------12-----------------------#2022-06-27">https://levelup.gitconnected.com/web-app-page-crashed-but-no-exception-was-reported-f9fa14c294b7?source=collection_archive---------12-----------------------#2022-06-27</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="1301" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">未设置脚本标记的crossorigin属性，无法获取异常信息的详细信息。</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/e58c7865842c08cd107bc0bcdf24f00c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KthPvL2q2AuOMuWNum-tSQ.png"/></div></div></figure><h1 id="abd1" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">介绍</h1><p id="17e3" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">一个新的模块被添加到web应用程序页面，只做了很小的改动。但上线后，有用户反映页面崩溃。经过长时间的调试，发现页面崩溃是因为数据格式不正确，导致了JavaScript的执行。</p><p id="7847" class="pw-post-body-paragraph lk ll ir lm b ln mg js lp lq mh jv ls lt mi lv lw lx mj lz ma mb mk md me mf ik bi translated">当事后回顾这个问题时，它影响了许多用户，但是监控系统没有相应的错误日志。这让我非常焦虑，我们无法确定web app页面是否正常工作。</p><h1 id="11dd" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">为什么没有报告错误日志</h1><p id="7463" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">项目中错误日志报告的流程步骤为:<br/> 1。捕捉JavaScript运行时异常<br/> 2。过滤无效的异常日志<br/> 3。上报异常日志<br/>调试代码时发现可以捕获异常日志，但是过滤掉了。当日志内容为“脚本错误”时，它将被过滤。</p><p id="928d" class="pw-post-body-paragraph lk ll ir lm b ln mg js lp lq mh jv ls lt mi lv lw lx mj lz ma mb mk md me mf ik bi translated">一旦你知道了原因，解决问题就更容易了。发现<a class="ae ml" href="https://sentry.io/answers/script-error/" rel="noopener ugc nofollow" target="_blank">的哨兵</a>已经通过谷歌解决了:</p><blockquote class="mm mn mo"><p id="bc21" class="lk ll mp lm b ln mg js lp lq mh jv ls mq mi lv lw mr mj lz ma ms mk md me mf ik bi translated">这不是一个错误——出于安全原因，浏览器有意隐藏来自不同来源的脚本文件的错误。这是为了避免脚本无意中向不受其控制的onerror回调泄露潜在的敏感信息。出于这个原因，浏览器只让window.onerror了解来自同一个域的错误。我们只知道发生了一个错误—没有别的了！</p></blockquote><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mt"><img src="../Images/2ffbbfc0c0930363f800c2e1fc791b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*69nJBIQ_z6hRmqBzYxLmjA.png"/></div></div><figcaption class="mu mv gk gi gj mw mx bd b be z dk translated">脚本错误演示。</figcaption></figure><h1 id="f0dc" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">解决方案</h1><p id="c1c2" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">如果引用的Javascript文件是CDN资源，为了获取异常日志的细节，只需要添加一个crossorigin属性。</p><pre class="kh ki kj kk gu my mz na nb aw nc bi"><span id="3882" class="nd kt ir mz b gz ne nf l ng nh">&lt;script src="example.js" crossorigin="<!-- -->anonymous<!-- -->"&gt;&lt;/script&gt;</span></pre><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ni"><img src="../Images/9d1d5b97f5b3f325d422537454035183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DvPLZWK3xivq-KkE1n3Ndg.png"/></div></div><figcaption class="mu mv gk gi gj mw mx bd b be z dk translated">脚本增加了crossorigin属性，我们可以捕捉错误的细节。</figcaption></figure><p id="668f" class="pw-post-body-paragraph lk ll ir lm b ln mg js lp lq mh jv ls lt mi lv lw lx mj lz ma mb mk md me mf ik bi translated">如果您有一个静态服务器，您的服务器应该添加一个响应头</p><pre class="kh ki kj kk gu my mz na nb aw nc bi"><span id="fd3b" class="nd kt ir mz b gz ne nf l ng nh">Access-Control-Allow-Origin: *</span></pre><p id="a945" class="pw-post-body-paragraph lk ll ir lm b ln mg js lp lq mh jv ls lt mi lv lw lx mj lz ma mb mk md me mf ik bi translated">如果您使用Webpack来编译您的项目，您可以使用<a class="ae ml" href="https://www.npmjs.com/package/script-ext-html-webpack-plugin" rel="noopener ugc nofollow" target="_blank">script-ext-html-web pack-plugin</a>来添加crossorigin属性。</p><h1 id="8530" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">参考</h1><ol class=""><li id="436d" class="nj nk ir lm b ln lo lq lr lt nl lx nm mb nn mf no np nq nr bi translated"><a class="ae ml" href="https://sentry.io/answers/script-error/" rel="noopener ugc nofollow" target="_blank">什么是“脚本错误”？</a></li><li id="28bc" class="nj nk ir lm b ln ns lq nt lt nu lx nv mb nw mf no np nq nr bi translated"><a class="ae ml" href="https://www.npmjs.com/package/script-ext-html-webpack-plugin" rel="noopener ugc nofollow" target="_blank">script-ext-html-web pack-plugin</a></li><li id="dd2d" class="nj nk ir lm b ln ns lq nt lt nu lx nv mb nw mf no np nq nr bi translated"><a class="ae ml" href="https://codepen.io/bitbug/pen/WNzeyGb?editors=1011" rel="noopener ugc nofollow" target="_blank">codepen . io上的演示</a></li></ol></div><div class="ab cl nx ny hv nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ik il im in io"><h1 id="b0a9" class="ks kt ir bd ku kv oe kx ky kz of lb lc jx og jy le ka oh kb lg kd oi ke li lj bi translated">分级编码</h1><p id="ed1c" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">感谢您成为我们社区的一员！更多内容见<a class="ae ml" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>。<br/>跟随:<a class="ae ml" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a>，<a class="ae ml" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">领英</a>，<a class="ae ml" href="https://newsletter.levelup.dev/" rel="noopener ugc nofollow" target="_blank">通迅</a> <br/> <strong class="lm is">升一级正在改造理工大招聘➡️ </strong> <a class="ae ml" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lm is">加入我们的人才集体</strong> </a></p></div></div>    
</body>
</html>