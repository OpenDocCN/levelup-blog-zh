<html>
<head>
<title>React Native + Redux: Implementing Redux Saga For An Asynchronous Flow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native + Redux:为异步流实现Redux Saga</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-native-redux-implementing-redux-saga-for-an-asynchronous-flow-90a0e9d7d8e8?source=collection_archive---------1-----------------------#2019-07-09">https://levelup.gitconnected.com/react-native-redux-implementing-redux-saga-for-an-asynchronous-flow-90a0e9d7d8e8?source=collection_archive---------1-----------------------#2019-07-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="489f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">作者:杰夫·刘易斯</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/90ae580df40592264d1f83acdf744eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QK20wkJvzICXTH1m3lh27Q.png"/></div></div></figure><p id="1294" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">备注:</strong></p><ul class=""><li id="7194" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">本指南假设你知道一些<strong class="kt ir">反应原生</strong>和<strong class="kt ir">还原。</strong></li><li id="9ca3" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><strong class="kt ir"> Github回购:</strong><a class="ae mb" href="https://github.com/jefelewis/redux-saga-demo" rel="noopener ugc nofollow" target="_blank">https://github.com/jefelewis/redux-saga-demo</a></li></ul><h1 id="8e5e" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">Redux Saga是什么？</h1><p id="60c5" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">Redux Saga是一个用作Redux中间件的库。Redux中间件是通过<code class="fe mz na nb nc b">dispatch()</code>方法拦截进入商店的动作的代码，并且可以根据接收到的动作执行任务<strong class="kt ir">。</strong> Sagas监视商店分派的所有行动(观察者/监视者)。在动作被传递给<code class="fe mz na nb nc b">props</code>之前，另一个函数(worker)将在异步流中处理如何处理动作。</p><p id="b6bb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> Redux Saga使用了一个名为</strong> <a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">生成器</strong> </a> <strong class="kt ir">的ES6特性，可以让你编写异步代码。了解Redux传奇的流程是如何工作的很重要，特别是传奇发生了什么<a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator" rel="noopener ugc nofollow" target="_blank">(生成器功能)</a>。<strong class="kt ir">生成器功能允许使用</strong> <code class="fe mz na nb nc b"><strong class="kt ir">yield</strong></code> <strong class="kt ir">进行排队操作，使其异步。</strong></strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/61e891c925f1f9e4bdb8c474a341d6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zuYB7frl0mE7sMPVa6lGdQ.png"/></div></div></figure><h1 id="bb84" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">为什么要用Redux Saga？</h1><p id="7ee0" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">Redux Saga帮助Redux管理应用程序副作用。这使得您的代码更有效地执行，更容易测试，并允许更好的错误处理。</p><h2 id="8e23" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">1.<strong class="ak">更好地处理动作和异步操作</strong></h2><p id="8251" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">生成器异步排队，这在处理API请求/响应、与Firebase通信或对时间敏感的流程时非常重要。</p><h2 id="a03a" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated"><strong class="ak"> 2。更容易阅读，没有回调地狱</strong></h2><p id="145d" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">Redux Saga使用生成器对任务进行排队，这消除了使用Promises时Redux-Thunk带来的回调问题。</p><h2 id="443e" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">3.更好的错误处理</h2><p id="3ba1" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">Redux Saga需要2个Saga(生成器函数)用于每个状态:工人和观察者。管理流程的saga负责处理错误，因此Redux存储状态的每个部分都有自己的错误。</p><h2 id="6bee" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">4.管理复杂的流程</h2><p id="0133" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">Redux Saga作为一个中间件，允许我们在动作被<code class="fe mz na nb nc b">mapStateToProps</code>传递给组件之前拦截它们。Sagas(生成器函数)协同工作，以模块化方式异步执行。</p><h2 id="405d" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">5.声明效果</h2><p id="680d" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">Redux Saga Watchers用户<a class="ae mb" href="https://redux-saga.js.org/docs/basics/DeclarativeEffects.html" rel="noopener ugc nofollow" target="_blank">声明效果</a> ( <code class="fe mz na nb nc b">takeEvery</code>、<code class="fe mz na nb nc b">takeLatest</code>、<code class="fe mz na nb nc b">takeLeading</code>等)。)，它允许控制请求的数量。例如，一个用户正在尝试登录，并且一直在按登录按钮。每次发出请求时都会发送一个请求。</p><p id="d72d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以使用声明性效果，比如<code class="fe mz na nb nc b">takeLatest</code>，只接受最后一个请求。</p><h2 id="dcdd" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">6.易于测试</h2><p id="c3cc" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">使用ES6发生器和<strong class="kt ir"> </strong> <a class="ae mb" href="https://redux-saga.js.org/docs/basics/DeclarativeEffects.html" rel="noopener ugc nofollow" target="_blank">宣告效果</a> ( <code class="fe mz na nb nc b">takeEvery</code>、<code class="fe mz na nb nc b">takeLatest</code>、<code class="fe mz na nb nc b">takeLeading</code>等。)，构建测试要容易得多，也干净得多。</p><h1 id="204a" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">示例应用+代码</h1><p id="115e" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated"><strong class="kt ir"> Github回购:</strong><a class="ae mb" href="https://github.com/jefelewis/redux-saga-test" rel="noopener ugc nofollow" target="_blank">https://github.com/jefelewis/redux-saga-test</a></p><h2 id="3301" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">A.应用概述</h2><p id="030b" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">App会有一个减速器:<code class="fe mz na nb nc b">counterReducer</code>。在我们的<code class="fe mz na nb nc b">store.js</code>文件中，我们将导入root reducer和root saga，并用<code class="fe mz na nb nc b"><a class="ae mb" href="https://redux.js.org/api/applymiddleware" rel="noopener ugc nofollow" target="_blank">applyMiddleware</a>()</code> <strong class="kt ir">将它们集成到我们的Redux存储中。</strong></p><p id="2c7b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了测试Redux Saga是否在我们的应用程序中工作，我们可以按下<strong class="kt ir">“-”按钮(减少)</strong>任意多次，我们的计数将会减少。我们的<strong class="kt ir">“+”按钮(增加)</strong>不同，因为我们有4秒的异步延迟。由于Sagas，我们的增加和减少功能都是异步的，但是4秒的延迟是为了演示的目的。</p><p id="f11d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">另外，我们在<strong class="kt ir"/><code class="fe mz na nb nc b">watchIncreaseCounter</code><strong class="kt ir"/>中使用了<code class="fe mz na nb nc b"><a class="ae mb" href="https://redux-saga.js.org/docs/api/" rel="noopener ugc nofollow" target="_blank">takeLatest</a></code>，所以只使用最后一个动作。您可以点击<strong class="kt ir">“+”按钮(增加)</strong>任意多次，但只有在最后一次点击按钮后4秒钟，计数器才会增加1。</p><h2 id="91fa" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">B.App截图</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/d06297ea9b5728938464e47020b30eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p92yzOO6I-mjDWcl9aCuqw.png"/></div></div><figcaption class="nr ns gj gh gi nt nu bd b be z dk translated">Counter.js</figcaption></figure><h2 id="71d0" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">C.应用程序文件结构</h2><p id="a793" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">本例将使用7个文件:</p><ol class=""><li id="fcab" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm nv lt lu lv bi translated">App.js (React原生应用)</li><li id="967d" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nv lt lu lv bi translated">Counter.js(计数器屏幕)</li><li id="fbaf" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nv lt lu lv bi translated">store.js (Redux商店)</li><li id="3d31" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nv lt lu lv bi translated">index.js (Redux Root Reducer)</li><li id="61c0" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nv lt lu lv bi translated">counterReducer.js (Redux计数器Reducer)</li><li id="fede" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nv lt lu lv bi translated">index.js (Redux根传奇)</li><li id="3ec5" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nv lt lu lv bi translated">反萨加</li></ol><h2 id="fddc" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">D.应用程序文件</h2><p id="34aa" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated"><strong class="kt ir"> App.js </strong></p><pre class="kg kh ki kj gt nw nc nx ny aw nz bi"><span id="887e" class="ne md iq nc b gy oa ob l oc od"><em class="oe">// Imports: Dependencies<br/></em>import React from 'react';<br/>import { Provider } from 'react-redux';</span><span id="3f8a" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Imports: Screens<br/></em>import Counter from './screens/Counter';</span><span id="8281" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Imports: Redux Store<br/></em>import { store } from './store/store';</span><span id="6be0" class="ne md iq nc b gy of ob l oc od"><em class="oe">// React Native App<br/></em>export default function App() {<br/>  return (<br/>    <em class="oe">// Redux: Global Store<br/>    </em>&lt;Provider store={store}&gt;<br/>      &lt;Counter /&gt;<br/>    &lt;/Provider&gt;<br/>  );<br/>}</span></pre><p id="f8b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> Counter.js </strong></p><pre class="kg kh ki kj gt nw nc nx ny aw nz bi"><span id="c8e4" class="ne md iq nc b gy oa ob l oc od"><em class="oe">// Imports: Dependencies<br/></em>import React, { Component } from 'react';import { Button, Dimensions, SafeAreaView, StyleSheet, Text, TouchableOpacity, View } from 'react-native';<br/>import { connect } from 'react-redux';</span><span id="2ace" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Screen Dimensions<br/></em>const { height, width } = Dimensions.get('window');</span><span id="2d67" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Screen: Counter<br/></em>class Counter extends React.Component {<br/>  render() {<br/>    return (<br/>      &lt;SafeAreaView style={styles.container}&gt;<br/>        &lt;Text style={styles.counterTitle}&gt;Counter&lt;/Text&gt;</span><span id="0f6d" class="ne md iq nc b gy of ob l oc od">        &lt;View style={styles.counterContainer}&gt;<br/>          &lt;TouchableOpacity onPress={this.props.reduxIncreaseCounter}&gt;<br/>            &lt;Text style={styles.buttonText}&gt;+&lt;/Text<br/>          &lt;/TouchableOpacity&gt;</span><span id="8f23" class="ne md iq nc b gy of ob l oc od">          &lt;Text style={styles.counterText}&gt;{this.props.counter}&lt;/Text&gt;</span><span id="7290" class="ne md iq nc b gy of ob l oc od">          &lt;TouchableOpacity onPress={this.props.reduxDecreaseCounter}&gt;<br/>            &lt;Text style={styles.buttonText}&gt;-&lt;/Text<br/>          &lt;/TouchableOpacity&gt;<br/>        &lt;/View&gt;<br/>      &lt;/SafeAreaView&gt;<br/>    )<br/>  }<br/>}</span><span id="cf8a" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Styles<br/></em>const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    justifyContent: 'center',<br/>    alignItems: 'center',<br/>  },<br/>  counterContainer: {<br/>    display: 'flex',<br/>    flexDirection: 'row',<br/>    justifyContent: 'center',<br/>    alignItems: 'center',<br/>  },<br/>  counterTitle: {<br/>    fontFamily: 'System',<br/>    fontSize: 32,<br/>    fontWeight: '700',<br/>    color: '#000',<br/>  },<br/>  counterText: {<br/>    fontFamily: 'System',<br/>    fontSize: 36,<br/>    fontWeight: '400',<br/>    color: '#000',<br/>  },<br/>  buttonText: {<br/>    fontFamily: 'System',<br/>    fontSize: 50,<br/>    fontWeight: '300',<br/>    color: '#007AFF',<br/>    marginLeft: 40,<br/>    marginRight: 40,<br/>  },<br/>});</span><span id="13ea" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Map State To Props (Redux Store Passes State To Component)<br/></em>const mapStateToProps = (state) =&gt; {<br/>  console.log('State:');<br/>  console.log(state);</span><span id="4cd7" class="ne md iq nc b gy of ob l oc od"><em class="oe">  // Redux Store --&gt; Component<br/>  </em>return {<br/>    counter: state.counter.counter,<br/>  };<br/>};</span><span id="e765" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Map Dispatch To Props (Dispatch Actions To Reducers. Reducers Then Modify The Data And Assign It To Your Props)<br/></em>const mapDispatchToProps = (dispatch) =&gt; {<br/>  <em class="oe">// Action<br/>  </em>return {<br/>    <em class="oe">// Increase Counter<br/>    </em>reduxIncreaseCounter: () =&gt; dispatch({<br/>      type: 'INCREASE_COUNTER',<br/>      value: 1,<br/>    }),<br/>    <em class="oe">// Decrease Counter<br/>    </em>reduxDecreaseCounter: () =&gt; dispatch({<br/>      type: 'DECREASE_COUNTER',<br/>      value: 1,<br/>    }),<br/>  };<br/>};</span><span id="dedf" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Exports<br/></em>export default connect(mapStateToProps, mapDispatchToProps)(Counter);</span></pre><p id="3921" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> store.js </strong></p><pre class="kg kh ki kj gt nw nc nx ny aw nz bi"><span id="6668" class="ne md iq nc b gy oa ob l oc od"><em class="oe">// Imports: Dependencies<br/></em>import { createStore, applyMiddleware } from 'redux';<br/>import { createLogger } from 'redux-logger';<br/><strong class="nc ir">import createSagaMiddleware from 'redux-saga';</strong></span><span id="c593" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Imports: Redux Root Reducer<br/></em>import rootReducer from '../reducers/index';</span><span id="a719" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Imports: Redux Root Saga<br/></em><strong class="nc ir">import { rootSaga } from '../sagas/index';</strong></span><span id="375c" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Middleware: Redux Saga<br/></em><strong class="nc ir">const sagaMiddleware = createSagaMiddleware();</strong></span><span id="8e27" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Redux: Store<br/></em>const store = createStore(<br/>  rootReducer,<br/>  applyMiddleware(<br/><strong class="nc ir">    sagaMiddleware,<br/></strong>    createLogger(),<br/>  ),<br/>);</span><span id="1cd8" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Middleware: Redux Saga<br/></em><strong class="nc ir">sagaMiddleware.run(rootSaga);</strong></span><span id="f780" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Exports<br/></em>export {<br/>  store,<br/>}</span></pre><p id="2fee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> index.js (Root Reducer) </strong></p><pre class="kg kh ki kj gt nw nc nx ny aw nz bi"><span id="b7ce" class="ne md iq nc b gy oa ob l oc od"><em class="oe">// Imports: Dependencies<br/></em>import { combineReducers } from 'redux';</span><span id="625b" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Imports: Reducers<br/></em>import counterReducer from './counterReducer';</span><span id="b0ac" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Redux: Root Reducer<br/></em>const rootReducer = combineReducers({<br/>  counter: counterReducer,<br/>});</span><span id="f08f" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Exports<br/></em>export default rootReducer;</span></pre><p id="cb10" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> counterReducer.js </strong></p><pre class="kg kh ki kj gt nw nc nx ny aw nz bi"><span id="01e7" class="ne md iq nc b gy oa ob l oc od"><em class="oe">// Initial State<br/></em>const initialState = {<br/>  counter: 0,<br/>};</span><span id="53d9" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Redux: Counter Reducer<br/></em>const counterReducer = (state = initialState, action) =&gt; {<br/>  switch (action.type) {<br/>    case 'INCREASE_COUNTER_ASYNC': {<br/>      return {<br/>        ...state,<br/>        counter: state.counter + action.value,<br/>      };<br/>    }</span><span id="bd28" class="ne md iq nc b gy of ob l oc od">    case 'DECREASE_COUNTER': {<br/>      return {<br/>        ...state,<br/>        counter: state.counter - action.value,<br/>      };<br/>    }</span><span id="edbe" class="ne md iq nc b gy of ob l oc od">    default: {<br/>      return state;<br/>    }<br/>  }<br/>};</span><span id="70c2" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Exports<br/></em>export default counterReducer;</span></pre><p id="b9db" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> index.js(根传奇)</strong></p><pre class="kg kh ki kj gt nw nc nx ny aw nz bi"><span id="5b3e" class="ne md iq nc b gy oa ob l oc od"><em class="oe">// Imports: Dependencies<br/></em><strong class="nc ir">import { all, fork} from 'redux-saga/effects';</strong></span><span id="8f78" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Imports: Redux Sagas<br/></em><strong class="nc ir">import { watchIncreaseCounter, watchDecreaseCounter } from './counterSaga';</strong></span><span id="2215" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Redux Saga: Root Saga<br/></em><strong class="nc ir">export function* rootSaga () {<br/>  yield all([<br/>    fork(watchIncreaseCounter),<br/>    fork(watchDecreaseCounter),<br/>  ]);<br/>};</strong></span></pre><p id="a0d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> counterSaga.js </strong></p><pre class="kg kh ki kj gt nw nc nx ny aw nz bi"><span id="6cbf" class="ne md iq nc b gy oa ob l oc od"><em class="oe">// Imports: Dependencies<br/></em><strong class="nc ir">import { delay, takeEvery, takeLatest, put } from 'redux-saga/effects';</strong></span><span id="6709" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Worker: Increase Counter Async (Delayed By 4 Seconds)<br/></em><strong class="nc ir">function* increaseCounterAsync() {<br/></strong>  try {<strong class="nc ir"><br/></strong>    <em class="oe">// Delay 4 Seconds<br/></em><strong class="nc ir"><em class="oe">    </em>yield delay(4000);</strong></span><span id="7998" class="ne md iq nc b gy of ob l oc od"><em class="oe">    // Dispatch Action To Redux Store<br/></em><strong class="nc ir"><em class="oe">    </em>yield put({<br/>      type: 'INCREASE_COUNTER_ASYNC',<br/>      value: 1,<br/>    });<br/></strong>  }<br/>  catch (error) {<br/><em class="oe">    </em>console.log(error);<br/>  }<strong class="nc ir"><br/>};</strong></span><span id="c6ce" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Watcher: Increase Counter Async<br/></em><strong class="nc ir">export function* watchIncreaseCounter() {<br/></strong>  <em class="oe">// Take Last Action Only<br/></em><strong class="nc ir"><em class="oe">  </em>yield takeLatest('INCREASE_COUNTER', increaseCounterAsync);<br/>};</strong></span><span id="c4c6" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Worker: Decrease Counter<br/></em><strong class="nc ir">function* decreaseCounter() {<br/></strong>  try {<strong class="nc ir"><br/></strong>    <em class="oe">// Dispatch Action To Redux Store<br/></em><strong class="nc ir"><em class="oe">    </em>yield put({<br/>      type: 'DECREASE_COUNTER_ASYNC',<br/>      value: 1,<br/>    });<br/></strong>  }<br/>  catch (error) {<br/>    console.log(error);<br/>  }<strong class="nc ir"><br/>};</strong></span><span id="a152" class="ne md iq nc b gy of ob l oc od"><em class="oe">// Watcher: Decrease Counter<br/></em><strong class="nc ir">export function* watchDecreaseCounter() {<br/></strong>  <em class="oe">// Take Last Action Only<br/></em><strong class="nc ir"><em class="oe">  </em>yield takeLatest('DECREASE_COUNTER', decreaseCounter);<br/>};</strong></span></pre><h1 id="c17c" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">传奇仍在继续</h1><p id="7eba" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">就是这样！Redux Saga现在可以在您的应用程序中工作，您的Redux商店现在是异步的。</p><p id="16e1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">没有人是完美的。如果您发现了任何错误，想要提出改进建议，或者扩展某个主题，请随时给我发消息。我一定会包括任何改进或纠正任何问题。</p></div></div>    
</body>
</html>