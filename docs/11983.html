<html>
<head>
<title>How to Make a PDF Text-to-Speech Reader in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python制作PDF文本到语音阅读器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-make-a-pdf-reader-in-python-579f0e7330b2?source=collection_archive---------8-----------------------#2022-05-04">https://levelup.gitconnected.com/how-to-make-a-pdf-reader-in-python-579f0e7330b2?source=collection_archive---------8-----------------------#2022-05-04</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="e5ca" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">您可以使用Python将任何PDF转换成有声读物。以下是如何使用各种音量、声音和速度调制进行文本到语音转换。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/dc55d675383187b80f30d0fe009a8bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZ3wfqkYmdcTTZRhWwVhrw.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">安德烈亚<a class="ae kz" href="https://www.pexels.com/photo/man-in-red-polo-shirt-sitting-near-chalkboard-3779448/" rel="noopener ugc nofollow" target="_blank">皮亚卡夸迪奥</a>从<a class="ae kz" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>拍摄的照片</figcaption></figure><p id="c578" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">PDF非常适合分发，因为我们可以在任何PDF阅读器设备上阅读它们。然而，许多读者更喜欢听他们的内容，而不是读它。幸运的是，您可以使用Python将任何PDF转换成音频文件，我们可以在几种流行的设备上播放。</p><p id="5833" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用Python创建PDF阅读器的第一步是下载并安装正确的库。在本教程中，我们将使用<a class="ae kz" href="https://pypi.org/project/PyPDF2/" rel="noopener ugc nofollow" target="_blank"> PyPDF2 </a>和<a class="ae kz" href="https://pypi.org/project/pyttsx3/" rel="noopener ugc nofollow" target="_blank"> pyttsx3 </a>。PyPDF2是一个读取和操作PDF文件的库，而pyttsx3会将它们转换成音频文件。</p><p id="37a5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">关联:</strong> <a class="ae kz" href="https://www.the-analytics.club/download-youtube-videos-in-python" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv"> <em class="lw">如何用Python下载YouTube视频？</em> </strong> </a></p><p id="d704" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这些库不是默认安装的，所以我们需要使用pip来安装它们。为此，我们可以打开命令提示符或终端，输入以下命令:</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="71fe" class="mc md iu ly b gz me mf l mg mh">pip install PyPDF2 pyttsx3</span></pre><h1 id="03f6" class="mi md iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">1.使用Python读取PDF文件</h1><p id="f79d" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">用Python读取文件很简单。我们需要使用<a class="ae kz" href="https://www.w3schools.com/python/ref_func_open.asp" rel="noopener ugc nofollow" target="_blank"> open() </a>函数打开文件。</p><p id="10db" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然而，要阅读PDF的内容，我们需要安装PyPDF2库。我们可以通过创建一个PdfFileReader对象并将PDF文件的文件路径传递给它来做到这一点。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="bfac" class="mc md iu ly b gz me mf l mg mh">from PyPDF2 import PdfFileReader<br/><br/># create a PdfFileReader object<br/>reader = PdfFileReader("/path/to/file.pdf")</span></pre><h1 id="0b0d" class="mi md iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">2.获取要阅读的页面</h1><p id="6bf8" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">一个PDF文件可能包含多个页面。所以我们需要指定我们想读哪一页。</p><p id="483b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">PyPDF2模块提供了两种处理页面的方法。我们可以使用<code class="fe ne nf ng ly b">numPages</code>属性找到PDF的页数。属性返回PDF中所有页面的列表。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="3430" class="mc md iu ly b gz me mf l mg mh">number_of_pages = reader.numPages<br/>page = reader.pages[0]</span></pre><p id="3af7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您要将一个大的PDF文件转换成有声读物，您可以使用它来循环浏览页面。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="0190" class="mc md iu ly b gz me mf l mg mh">for page in reader.pages:<br/>    # do the rest<br/><br/>#or<br/>for i in range(reader.numPages):<br/>    page = reader.pages[i]<br/>    <br/>    #do the rest</span></pre><h1 id="cab8" class="mi md iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">3.使用Python将PDF转换为文本</h1><p id="887f" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">一旦我们决定阅读哪一页，我们就需要从那一页中提取文本内容。在PyPDF2中，我们可以使用<code class="fe ne nf ng ly b">extractText</code>属性。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="cfd5" class="mc md iu ly b gz me mf l mg mh">text = page.extractText()</span></pre><h1 id="8f19" class="mi md iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">4.配置pyttsx3引擎</h1><p id="d842" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">现在我们有了PDF的文本内容，我们需要将它转换成音频。为此，我们将使用pyttsx3库。</p><p id="b36c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Pyttsx3是Python中的文本到语音转换库。它可以离线工作，兼容多种平台，包括Windows、Linux和MacOSX。</p><p id="ae6d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一步是创建pyttsx3引擎类的实例。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="7a63" class="mc md iu ly b gz me mf l mg mh">import pyttsx3<br/>engine = pyttsx3.init()</span></pre><p id="426c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一旦引擎准备好，我们就可以设置声音(男，女)，音量和语速。但这些都是可选的。</p><h2 id="3052" class="mc md iu bd mj nh ni dn mn nj nk dp mr lj nl nm mt ln nn no mv lr np nq mx nr bi translated">设置声音—男声/女声</h2><p id="d0ce" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">我们需要得到引擎中可用的东西来设置声音。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="06db" class="mc md iu ly b gz me mf l mg mh">voices = engine.getProperty('voices')</span></pre><p id="d471" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，我们可以在引擎上设置语音属性。使用0设置男声，使用1设置女声。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="1050" class="mc md iu ly b gz me mf l mg mh">#Male<br/>engine.setProperty('voice', voices[0].id)  <br/><br/>#Female<br/>engine.setProperty('voice', voices[1].id)</span></pre><h2 id="fda2" class="mc md iu bd mj nh ni dn mn nj nk dp mr lj nl nm mt ln nn no mv lr np nq mx nr bi translated">设置阅读速度</h2><p id="2441" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">我们可以通过将rate属性设置为您想要的每分钟字数来改变阅读速度。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="eb19" class="mc md iu ly b gz me mf l mg mh">engine.setProperty('rate', 150)</span></pre><p id="17e5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你只想加快(或减慢)阅读速度，而不是设定一个特定的速度，你可以参考当前的速度并进行调整。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="1014" class="mc md iu ly b gz me mf l mg mh"># refer to the current value<br/>rate = engine.getProperty('rate') <br/><br/>engine.setProperty('rate', rate+50)</span></pre><h2 id="8743" class="mc md iu bd mj nh ni dn mn nj nk dp mr lj nl nm mt ln nn no mv lr np nq mx nr bi translated">改变音量</h2><p id="38da" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">在pyttsx3中，可以在0和1之间设置音量。0表示静音，1表示将音量设置为最大。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="d58d" class="mc md iu ly b gz me mf l mg mh">engine.setProperty('volume',.75)</span></pre><h1 id="1e30" class="mi md iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">5.阅读或保存音频</h1><p id="48e9" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">我们已经做了所有的背景工作。现在让我们开始行动吧。在pyttsx3中，您必须调用<code class="fe ne nf ng ly b">say</code>方法，然后调用<code class="fe ne nf ng ly b">runAndWait</code>方法来进行实际的语音。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="792f" class="mc md iu ly b gz me mf l mg mh">engine.say(text)<br/>engine.runAndWait()</span></pre><p id="9b27" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，我们可以使用pyttsx3的Engine类的save_to_file()方法将音频保存为MP3格式。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="063a" class="mc md iu ly b gz me mf l mg mh">engine.save_to_file(text, 'test.mp3')</span></pre><h1 id="c753" class="mi md iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">把所有的放在一起</h1><p id="4c0d" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">为了更好地理解代码，我们一行一行地浏览了代码。现在，转换pdf并将其保存到文件的完整版本如下所示。</p><pre class="kk kl km kn gu lx ly lz ma aw mb bi"><span id="c928" class="mc md iu ly b gz me mf l mg mh">import pyttsx3<br/>from PyPDF2 import PdfFileReader<br/><br/><br/># create a PdfFileReader object<br/>reader = PdfFileReader("/path/to/file.pdf")<br/><br/><br/># extract text from page 1 (index 0)<br/>page = reader.pages[0]<br/>text = page.extractText()<br/><br/><br/># Create a pyttsx3 engine<br/>engine = pyttsx3.init()<br/><br/><br/># set the voice<br/>voices = engine.getProperty('voices')<br/>engine.setProperty('voice', voices[1].id)  #Female<br/><br/><br/># set the speed/rate of speech<br/>engine.setProperty('rate', 150)<br/><br/><br/># set the volume<br/>engine.setProperty('volume',.75)<br/><br/><br/>engine.save_to_file(text, 'test.mp3')</span></pre><h1 id="5f94" class="mi md iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">最后的想法</h1><p id="2807" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">pdf到处都是。但是读者的偏好也会发生巨大的变化。</p><p id="6d57" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">想听的人比想读的人多。因为在听的时候有可能做别的事情。我们在阅读时没有这种灵活性。还有，听力对于视力障碍的人来说更方便。</p><p id="481f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是我们并没有为我们在互联网上看到的每一个PDF资源找到音频版本。但是Python程序员可以通过几行代码轻松地将它们转换成音频文件。</p><p id="4bc2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本文中，我们讨论了如何将pdf转换成音频文件。我们也在寻找用不同的音量、声音和速度来修改演讲的方法。</p></div><div class="ab cl ns nt hy nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="in io ip iq ir"><blockquote class="nz oa ob"><p id="82b7" class="la lb lw lc b ld le jv lf lg lh jy li oc lk ll lm od lo lp lq oe ls lt lu lv in bi translated"><em class="iu">感谢阅读，向我问好</em><a class="ae kz" href="https://www.linkedin.com/in/thuwarakesh/" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv"><em class="iu">LinkedIn</em></strong></a><em class="iu">，</em><a class="ae kz" href="https://twitter.com/Thuwarakesh" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv"><em class="iu">Twitter</em></strong></a><em class="iu">，</em><a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener"><strong class="lc iv"><em class="iu">Medium</em></strong></a><em class="iu">。</em></p><p id="9a87" class="la lb lw lc b ld le jv lf lg lh jy li oc lk ll lm od lo lp lq oe ls lt lu lv in bi translated"><em class="iu">还不是中等会员？请使用此链接到</em> <a class="ae kz" href="https://thuwarakesh.medium.com/membership" rel="noopener"> <strong class="lc iv"> <em class="iu">成为会员</em> </strong> </a> <em class="iu">因为，在没有额外费用的情况下，我为你引荐赚取一小笔佣金。</em></p></blockquote></div></div>    
</body>
</html>