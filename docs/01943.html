<html>
<head>
<title>A Simple Guide to Making Fetch API Requests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">发出获取API请求的简单指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-simple-guide-to-making-fetch-api-requests-710b831cbd98?source=collection_archive---------14-----------------------#2020-02-07">https://levelup.gitconnected.com/a-simple-guide-to-making-fetch-api-requests-710b831cbd98?source=collection_archive---------14-----------------------#2020-02-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="da0d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习使用基本获取操作DOM</h2></div><p id="a632" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您发现自己正在构建一个典型的网站或应用程序，那么您很可能想要为您的用户实现一些基本的CRUD(<em class="le">Create Read Update Delete</em>)功能，包括对所有必要数据的多个HTTP请求。在JavaScript(和大多数浏览器)中工作时，这些请求可以通过使用一个叫做<code class="fe lf lg lh li b">fetch</code>的小东西来完成。<a class="ae lj" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" rel="noopener ugc nofollow" target="_blank">获取API请求</a>有点像你和你的小狗玩的同名游戏:</p><ul class=""><li id="b0eb" class="lk ll it kk b kl km ko kp kr lm kv ln kz lo ld lp lq lr ls bi translated">某物(<em class="le">一个球，一根棍子，对数据的请求等。</em>)被抛向选定的方向，</li><li id="77fe" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld lp lq lr ls bi translated">然后从空间中取回某物(<em class="le">公园，URL… </em>)，</li><li id="094f" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld lp lq lr ls bi translated">稍加修饰(<em class="le">满身口水？</em>)，</li><li id="ee3c" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld lp lq lr ls bi translated">然后返回给你(摆着尾巴<em class="le">)让你下一步行动。</em></li></ul><p id="f896" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些获取请求是异步的，这意味着您的代码将为数据返回一个<a class="ae lj" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener ugc nofollow" target="_blank"> <em class="le">承诺</em> </a>并继续运行其他任务，同时等待实际数据返回并完成请求。(想象一下，你把那根棍子扔给你的小狗，它/她跑去捡回来，在等待的时候，你拿出手机录下一段视频，你的小狗带着一个大大的、快乐的、流口水的笑容跑回来。)</p><p id="0d48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今天，我将带您浏览一个简单的基本获取请求指南，使用…<em class="le">drum roll</em>T21【请 …GIBBONS！！(你可能认为这是再一次谈论狗的绝佳机会，但是哈！骗了你。)</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/7e3ad0e08596e2392f452b3c880fe5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*CFDTw9znrSRDgujtsW2_EQ.gif"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">长臂猿是可爱、滑稽、濒临灭绝的灵长类动物，被称为“小猿”，以其令人难以置信的和谐歌唱天赋和杰出的臂力而闻名……但我跑题了。</figcaption></figure><p id="786c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出于教学目的，让我们假设我们有一个位于“http://allthegibbons.com”(不是一个真正的网站)的API，其中包含了某个特定保护区中所有长臂猿的嵌套信息。我们可以访问所有长臂猿的数组(<code class="fe lf lg lh li b">gibbonsArray</code>)，我们将为每只长臂猿创建一个HTML列表元素(<code class="fe lf lg lh li b">gibbonLi</code>)。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="4abc" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">提出“获取”请求</h1><p id="8f15" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">假设您想要显示一个主页，上面有目前居住在我们保护区的所有长臂猿。为了获取所有长臂猿的详细信息，您需要发出一个HTTP 'GET '请求。(你得到了信息，但没有改变它。)在这种情况下，您会:</p><ol class=""><li id="77ad" class="lk ll it kk b kl km ko kp kr lm kv ln kz lo ld no lq lr ls bi translated"><code class="fe lf lg lh li b">fetch</code>来自URL的信息。</li><li id="aaf2" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">抓住那个回应(<code class="fe lf lg lh li b">r</code>)。</li><li id="6111" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">将这种反应转化为我们可以利用的东西(<code class="fe lf lg lh li b">r.json()</code>)。在这种情况下，我们将把这个响应重新格式化为JSON，或者JavaScript对象符号。</li><li id="a070" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">将返回的<code class="fe lf lg lh li b">data</code>传递给你的下一个动作。在这种情况下，我们将把数据传递到我们的空<code class="fe lf lg lh li b">gibbonsArray</code>中，并把它传递到一个单独的回调函数中，以呈现页面上的所有长臂猿(<code class="fe lf lg lh li b">renderAllGibbons(gibbonsArray)</code>)。</li></ol><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi np"><img src="../Images/ce66abada93ca123f4f87738ee492205.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*1DeCzX_R6p0TvCTg5aNHZw.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">示例“GET”请求</figcaption></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi nq"><img src="../Images/2975209cb93e3479abd573ec41c7ca6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aqFzF0XH5zFzv-Wew0Wp5A.jpeg"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">吉本斯都在这里！🎉</figcaption></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="83a9" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">发出“发布”请求</h1><p id="eb9d" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">假设我们的避难所刚刚接收了一只新的长臂猿！他的名字叫诺伊，他喜欢挠背。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi nq"><img src="../Images/560c27794558e466f37a916d5f0e3544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CM5c4yL2W2O0dX4td1cm_Q.jpeg"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">看那张可爱的脸👼</figcaption></figure><p id="1fc9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了将Noi添加到我们的长臂猿保护区网站，我们需要提交一个HTTP 'POST '请求。(您正在创建一个新对象，并将该新信息“发送”到数据库。)对于这个请求，我们需要指定更多的信息，以确保所有的数据都得到正确处理。以下是我们的步骤:</p><ol class=""><li id="db04" class="lk ll it kk b kl km ko kp kr lm kv ln kz lo ld no lq lr ls bi translated">您要将长臂猿添加到的URL。</li><li id="29be" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">声明您正在实现哪种类型的<code class="fe lf lg lh li b">method</code>。(在这种情况下，我们使用“POST”方法。)上次我们不需要声明“GET”方法，因为这个方法在没有声明的时候是假定的。</li><li id="7cea" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">声明您将在<code class="fe lf lg lh li b">headers</code>内发送和接收什么类型的数据(如果需要)。在这个例子中，我们需要使用<code class="fe lf lg lh li b">‘application/json’</code>。</li><li id="61dc" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">声明您将在这个新gibbon数据的<code class="fe lf lg lh li b">body</code>中以键/值对的形式包含哪些信息。</li><li id="e0c3" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">用<code class="fe lf lg lh li b">JSON.stringify</code>将主体数据转换成JSON字符串，因为服务器只能读取字符串格式的数据。</li><li id="5414" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">为了将这个新的长臂猿保存到DOM，获取响应，将其转换为JSON，并将转换后的数据(<code class="fe lf lg lh li b">gibbon</code>)传递到一个新的回调函数中，就像我们上次使用“GET”方法所做的那样。这个回调函数必须将最新的长臂猿Noi添加到所有长臂猿的列表中，这样数据才能持久。</li></ol><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/55050102c0063115a1a55b622a96423e.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*aLwKJ9sJICDrTRHhTvFgow.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">示例“发布”请求</figcaption></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="dd46" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">发出“上传”/“修补”请求</h1><p id="ac0e" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">假设您想要更新其中一只长臂猿的信息。也许在避难所过得舒适之后，你会发现诺伊不仅仅喜欢背部抓痕。他也爱牵手！多可爱啊。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi nq"><img src="../Images/acd60392e3d9e7f21f6f62e1d7f02792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vEWf55ydTUPt7YLkS51Pg.jpeg"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">哦，我的心❤️</figcaption></figure><p id="e53c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了更新Noi的数据，我们需要向服务器发出一个HTTP‘PUT’或‘PATCH’请求。“上传”请求将删除Noi的所有信息并用新的副本替换，但“修补”请求将只更新必要的部分，保留Noi的完整存在。为了我们的演示(以及Noi的安全)，我们将发出一个“补丁”请求。这看起来与“POST”请求非常相似，但有以下区别:</p><ol class=""><li id="5c32" class="lk ll it kk b kl km ko kp kr lm kv ln kz lo ld no lq lr ls bi translated">我们从中获取的URL必须包含我们希望更新的长臂猿的id。为了使这个动态请求可以被未来的长臂猿重用，我们可以使用模板文字插入长臂猿的id。确保您的URL用反斜线而不是引号括起来，并在末尾插入这个占位符:<code class="fe lf lg lh li b">${gibbon.id}</code>。</li><li id="a177" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">将您的方法设置为“修补”。</li><li id="4add" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">没有必要把这只长臂猿添加到你的长臂猿列表中——它已经存在了！</li></ol><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/06ecd5024c8d8e75314d5ea9c5a68e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*NEtRG3cn02HjwzkrZelj9Q.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">示例“补丁”请求</figcaption></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="251f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">发出“删除”请求</h1><p id="c719" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">假设您意外地创建了同一个长臂猿两次，因此您需要删除多余的长臂猿(复制！)从你的圣所。(显然，否则我们<em class="le">永远不会</em>删除一只长臂猿。)您将采取的完成此任务的步骤与我们之前为“修补”所做的非常相似。</p><ol class=""><li id="6f34" class="lk ll it kk b kl km ko kp kr lm kv ln kz lo ld no lq lr ls bi translated">一旦您将获取URL设置为目标gibbon id，就将您的<code class="fe lf lg lh li b">method</code>设置为‘DELETE’。</li><li id="d99a" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">不需要头或体，因为我们不创建或更新这个gibbon实例。</li><li id="f3de" class="lk ll it kk b kl lt ko lu kr lv kv lw kz lx ld no lq lr ls bi translated">在响应被返回并转换成JSON之后，从数据库中删除它。</li></ol><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/6199c4114c8bce8b3734264be59539a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*I-bzTh6U4Rcm7UCq9V34Aw.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">示例“删除”请求</figcaption></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="756c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在你知道了！现在，您已经有了一些基本的JavaScript工具，可以在您的网站或应用程序中完成一些简单的CRUD功能。</p><p id="5e42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">编码快乐！</p><p id="d873" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">又及:拯救长臂猿！<a class="ae lj" href="https://www.ippl.org/gibbon/" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae lj" href="https://www.gibbonathighlandfarm.org/en/" rel="noopener ugc nofollow" target="_blank">这里</a>:)</p></div></div>    
</body>
</html>