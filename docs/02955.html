<html>
<head>
<title>Learn Docker Swarm with Vagrant</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习码头工人与流浪者的结合</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/learn-docker-swarm-with-vagrant-47dd52b57bcc?source=collection_archive---------2-----------------------#2020-04-12">https://levelup.gitconnected.com/learn-docker-swarm-with-vagrant-47dd52b57bcc?source=collection_archive---------2-----------------------#2020-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="03ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">ocker Swarm是一个简单的Docker编排框架，它是Kubernetes之前讨论和使用最热的工具，现在在小规模应用中仍然非常流行。今天，我们将演示如何在不提供云和物理环境的情况下，使用vagger在您的本地机器上设置Docker Swarm。</p><h1 id="d137" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">流浪汉简介</h1><p id="a0c7" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di">V</span>T12】a grant是一个在单个工作流中构建和管理虚拟机环境的工具。凭借易于使用的工作流和对自动化的关注，vanguard降低了开发环境设置时间，提高了生产效率，并使“在我的机器上工作”的借口成为过去的遗迹。<a class="ae lx" href="https://www.vagrantup.com/intro/index.html" rel="noopener ugc nofollow" target="_blank">向哈希公司学习流浪汉</a>。由于vagger本身使用Ruby，因此你可以用vagger动态地构建你的环境。</p><h1 id="65fa" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">要求</h1><p id="6758" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">我们将设置以下环境和应用程序:</p><p id="8d2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2个管理节点</p><p id="068c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2个工人节点</p><p id="9b18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在码头群中部署码头集装箱</p><p id="3fe5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Docker Swarm中部署8个NGINX副本</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="df43" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">安装流浪者</h1><p id="ee00" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">您可以从brew安装vagger，或者如果您使用的不是macOS，请遵循<a class="ae lx" href="https://www.vagrantup.com/downloads.html" rel="noopener ugc nofollow" target="_blank">官方安装指南</a>:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="070d" class="mt kv iq mp b gy mu mv l mw mx">brew cask install vagrant</span></pre></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="4e0e" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">安装VirtualBox</h1><p id="460e" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">游民支持相当多的虚拟化提供商，在我们的例子中我们将使用虚拟盒子，运行以下brew命令来安装虚拟盒子:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="6d8b" class="mt kv iq mp b gy mu mv l mw mx">brew cask install virtualbox</span></pre></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="908a" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">用流浪文件创建一个工作目录</h1><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="6dd4" class="mt kv iq mp b gy mu mv l mw mx">mkdir vagrant-docker-swarm<br/>cd vagrant-docker-swarm<br/>touch Vagrantfile<br/>code . #We use visual studio code to edit the file, you can use any other editor</span></pre></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="aeec" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">添加安装Docker脚本</h1><p id="434a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">为了简化Docker的安装，我们创建了一个通用的安装脚本，供所有机器运行，稍后会用到，将以下脚本添加到<strong class="jp ir">浮动文件</strong>中:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="ebc0" class="mt kv iq mp b gy mu mv l mw mx"># -*- mode: ruby -*-<br/># vi: set ft=ruby :</span><span id="e360" class="mt kv iq mp b gy my mv l mw mx">$install_docker_script = &lt;&lt;SCRIPT<br/>echo "Installing dependencies ..."<br/>sudo apt-get update<br/>echo Installing Docker...<br/>curl -sSL https://get.docker.com/ | sh<br/>sudo usermod -aG docker vagrant<br/>SCRIPT</span></pre></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="47cb" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">添加要在流浪者文件中使用的变量</h1><p id="cd21" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">就像其他编程语言一样，我们将使用变量在<strong class="jp ir">流浪文件</strong>中保存一个公共实体或常量，在<strong class="jp ir">流浪文件</strong>中添加以下脚本:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="bf74" class="mt kv iq mp b gy mu mv l mw mx">BOX_NAME = "ubuntu/xenial64"<br/>MEMORY = "512"<br/>CPUS = 2<br/>MANAGERS = 2<br/>MANAGER_IP = "172.20.20.1"<br/>WORKERS = 2<br/>WORKER_IP = "172.20.20.10"<br/>VAGRANTFILE_API_VERSION = "2"</span></pre><p id="d64b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们为我们的机器使用映像<code class="fe mz na nb mp b">ubuntu/xenial64</code>，我们将在我们的所有机器中使用<code class="fe mz na nb mp b">512</code> MB内存和<code class="fe mz na nb mp b">2 CPU</code>，我们将启动<code class="fe mz na nb mp b">2 manager nodes</code>，管理器IP将被分配从<code class="fe mz na nb mp b">172.20.20.1X</code>开始的IP地址，我们将启动从<code class="fe mz na nb mp b">172.20.20.10X</code>开始的<code class="fe mz na nb mp b">2 woker nodes</code>，最后，我们将使用版本<code class="fe mz na nb mp b">2</code>作为<strong class="jp ir">流浪者</strong>文件API版本。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="f9d3" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">配置浮动配置块和公共参数</h1><p id="f02a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">将以下脚本添加到<strong class="jp ir">流浪者文件</strong>，如果你注意到，它使用我们之前定义的变量来配置所有的机器</p><figure class="mk ml mm mn gt nc"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="59a5" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated"><strong class="ak">配置管理机</strong></h1><p id="7ffd" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">现在，我们将添加管理器节点的设置，我们循环通过<code class="fe mz na nb mp b">MANAGERS</code>计数，为机器提供我们分配的IP和主机名，为了简化设置，我们将分配3个可从主机访问的端口，在前面脚本的公共设置的end部分后添加以下脚本，但必须放在<a class="ae lx" href="https://gist.github.com/jazztong/bdc815dd3a550f607bc575832ac546fb" rel="noopener ugc nofollow" target="_blank">vagger</a>configure部分中。</p><figure class="mk ml mm mn gt nc"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="200e" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">配置工作机</h1><p id="482b" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">最后，我们在前面的脚本之后添加了一个类似于下面的脚本到<strong class="jp ir">的浮动文件</strong>中，它只是用指定的IP和主机名启动了2台机器，这里是一个完整的<a class="ae lx" href="https://gist.github.com/jazztong/f3c95a51c54800544a703f0598fa0f56" rel="noopener ugc nofollow" target="_blank">浮动文件的例子。</a></p><figure class="mk ml mm mn gt nc"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="e8bd" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">用流浪者启动所有机器</h1><p id="4bed" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">在文件夹中运行以下命令来启动所有计算机</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="83fa" class="mt kv iq mp b gy mu mv l mw mx">vagrant up</span></pre><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nf"><img src="../Images/8810c5b0ca9f7f014f62b7975cb48b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2p8wXmzWC5Td9H9AJBt_TQ.png"/></div></div></figure><p id="3e33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">资源调配完成后，它可能需要一段时间来下载依赖项。运行以下命令以列出所有计算机。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="3312" class="mt kv iq mp b gy mu mv l mw mx">vagrant status</span></pre><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nm"><img src="../Images/37c35c7f031f283d51342273c1aa57a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBmv251uA2JW7txu2kqa0g.png"/></div></div></figure><p id="d95c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用以下命令登录manager01并验证Docker</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="1541" class="mt kv iq mp b gy mu mv l mw mx">vagrant ssh manager01<br/>docker info</span></pre><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nn"><img src="../Images/13c8d8e8a51be2bb110e621236e52703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8UohsHKt8lQ7_grmAWt0Eg.png"/></div></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="1318" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">在管理器01中初始化停靠站群</h1><p id="b19f" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">在manager01中运行以下命令来初始化Docker Swarm</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="0728" class="mt kv iq mp b gy mu mv l mw mx">docker swarm init --listen-addr 172.20.20.11:2377 --advertise-addr 172.20.20.11:2377</span></pre><p id="bf1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将获得以下输出，该命令和令牌将用于加入worker，将其记录在某个地方供以后使用。</p><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi no"><img src="../Images/b078c42dd90a848cc45d50f569cfef18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jiigfSS2GxaYbjiSrUdYvw.png"/></div></div></figure><p id="f7b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行以下命令获取令牌以加入管理器</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="fc5c" class="mt kv iq mp b gy mu mv l mw mx">docker swarm join-token manager</span></pre><p id="091b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将获得以下输出，记录命令和令牌</p><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi np"><img src="../Images/e513f427492ac3dfc445252ab9f17c6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUBRsMDq3BMHQapLMzJ6AA.png"/></div></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="8a3a" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">将Manager02添加到Manager节点</h1><p id="639d" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">打开另一个终端，登录到manager02机器，运行从manager01复制的命令，作为manager节点加入</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="c447" class="mt kv iq mp b gy mu mv l mw mx">docker swarm join --token SWMTKN-1-4yi710ldjxghquve97fgfh6551vsi7xvlzihbs6ag8tgil9w1a-eqx1i4qfnye7ucjwbvbn6glrw 172.20.20.11:2377</span></pre><p id="955c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将获得以下输出，表明您成功加入了管理器</p><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nq"><img src="../Images/1bf5b404693db7e721656aad167799b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*is8l9B6zZQfzj17VWAKTBw.png"/></div></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="78f3" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">将Worker01、Worker02添加到Worker节点</h1><p id="f1a9" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">现在，我们将把worker节点添加到Docker Swarm中，使用来自manager01的worker token命令，并在worker01机器中运行该命令。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="86d1" class="mt kv iq mp b gy mu mv l mw mx">docker swarm join --token SWMTKN-1-4yi710ldjxghquve97fgfh6551vsi7xvlzihbs6ag8tgil9w1a-6vo52j42hx7r6c06yb0gif7me 172.20.20.11:2377</span></pre><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nr"><img src="../Images/9c3ae4dd90f1cff9e00e10554d4573d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gxUIbqe5NzmlNTGQTfIFfg.png"/></div></div></figure><p id="fcda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在worker02中重复相同的过程以作为worker节点加入，最后在manager节点中运行以下命令以列出所有节点</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="e9d7" class="mt kv iq mp b gy mu mv l mw mx">docker node ls</span></pre><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ns"><img src="../Images/9d6cbe88ed751723473aef37d960ceac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yrBPOoKH6UieCClCjmZMFQ.png"/></div></div></figure><p id="852e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">恭喜你，你拥有了一个功能齐全的Docker Swarm集群。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="adb0" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">部署门户网站</h1><p id="dc52" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">Portainer是一个简单的轻量级Docker管理工具，我们将部署Portainer来可视化我们集群中的所有应用程序状态。在Docker Swarm中，所有供应都必须在管理节点中执行。登录manager01或manager02并运行以下命令。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="57d5" class="mt kv iq mp b gy mu mv l mw mx">curl -L https://downloads.portainer.io/portainer-agent-stack.yml -o portainer-agent-stack.yml</span><span id="b2c0" class="mt kv iq mp b gy my mv l mw mx">docker stack deploy --compose-file=portainer-agent-stack.yml portainer</span></pre><p id="3c75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们正在将容器部署到分布式节点中，所以我们不能使用普通的<code class="fe mz na nb mp b">docker ps</code>来检查所有容器，您可以使用另一个简单的命令来列出所有节点<code class="fe mz na nb mp b">docker node ps $(docker node ls -q)</code>中的所有容器。</p><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nt"><img src="../Images/d48b9efec8a2c658503fedf338434774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxbdowMQerbRvXrCwvaEeg.png"/></div></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="ec94" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">部署NGINX</h1><p id="a6d6" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">为了进一步形象化Docker Swarm如何工作，我们将把Nginx部署到所有节点中，包括管理节点<em class="nu">(除非我们配置了放置约束)和</em>运行以下命令来创建NGINX服务。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="c9be" class="mt kv iq mp b gy mu mv l mw mx">docker service create --name my_nginx --replicas 8 --publish published=8080,target=80 nginx</span></pre><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nv"><img src="../Images/a042cdc6aec30f35229867f357b947b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JT1GHn73VduN4Q7KSSfHw.png"/></div></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="014f" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">测试时间</h1><p id="b8dd" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">最后，导航到<a class="ae lx" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://localhost:8080/</strong></a><strong class="jp ir"/>验证Nginx，导航到<a class="ae lx" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://localhost:9000/</strong></a><strong class="jp ir"/>打开Portainer。导航到<a class="ae lx" href="http://localhost:9000/#/swarm/visualizer" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://localhost:9000/#/swarm/visualizer</strong></a>来可视化您的所有应用。</p><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nw"><img src="../Images/faf30dfc98645912e9a994191cd54d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEXjkPFxFRJhYER_CYYo0w.png"/></div></div></figure><figure class="mk ml mm mn gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nx"><img src="../Images/d8b56299beabbcb046565a7dccd61bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8sPXkooWXSN_fKUIQXB7IQ.png"/></div></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="6fca" class="ku kv iq bd kw kx mf kz la lb mg ld le lf mh lh li lj mi ll lm ln mj lp lq lr bi translated">拿走</h1><p id="6946" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">在本节结束时，您应该能够在本地设置一台机器来配置Docker Swarm playground，并且如果您愿意，您可以使用<strong class="jp ir">vagger</strong>ruby脚本来自动化整个Docker Swarm设置。最后，运行<code class="fe mz na nb mp b">Vagrant destroy</code>来清理你的虚拟环境或者<code class="fe mz na nb mp b">Vagrant suspend</code>来停止它们，快乐码头。</p></div></div>    
</body>
</html>