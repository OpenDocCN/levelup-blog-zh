<html>
<head>
<title>How to Proxy HTTPS Traffic to Your Development Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将HTTPS流量代理到您的开发服务器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-proxy-https-traffic-to-your-development-server-63c9980d5899?source=collection_archive---------7-----------------------#2021-10-30">https://levelup.gitconnected.com/how-to-proxy-https-traffic-to-your-development-server-63c9980d5899?source=collection_archive---------7-----------------------#2021-10-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4215" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">启用临时SSL支持的单个命令</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/0858fdf93075330c14d8b761209c0d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6cosRqcuxb8JQRUjK7ynw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@flyd2069?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">飞:D </a>在<a class="ae le" href="https://unsplash.com/s/photos/security?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="dcf8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过阅读这篇文章，您将了解到只需一个命令就可以将HTTPS流量代理到任何现有的HTTP服务器。这很方便，尤其是当你在一个远程机器上开发一个只在安全环境下工作的原型时(HTTPS)。</p><p id="8f3e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设您正在构建一个在前端应用程序中使用<code class="fe lf lg lh li b">MediaDevices.getUserMedia()</code>的流媒体平台。只有当且仅当应用程序通过HTTPS提供服务或通过本地主机访问时，此功能才起作用。对于位于远程机器上的开发服务器，您可以利用<code class="fe lf lg lh li b"><a class="ae le" href="https://github.com/suyashkumar/ssl-proxy" rel="noopener ugc nofollow" target="_blank">ssl-proxy</a></code>作为临时解决方案，并将剩余的精力和时间用于开发。</p><p id="420e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据官方文献记载，<code class="fe lf lg lh li b"><a class="ae le" href="https://github.com/suyashkumar/ssl-proxy" rel="noopener ugc nofollow" target="_blank">ssl-proxy</a></code>是一个</p><blockquote class="lj lk ll"><p id="f76d" class="jq jr lm js b jt ju jv jw jx jy jz ka ln kc kd ke lo kg kh ki lp kk kl km kn im bi translated">“…将SSL添加到在虚拟机上运行的东西的方便而简单的方法—无论是您的个人jupyter笔记本电脑还是您的团队jenkins实例。ssl代理在一个命令中自动生成SSL证书，并将HTTPS流量代理到现有的HTTP服务器。”</p></blockquote><p id="fadd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请注意，这种方法非常适合远程测试您的开发服务器。对于生产级应用程序，您应该使用标准的部署方法。这包括:</p><ul class=""><li id="5ba9" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">运行在Nginx之后</li><li id="4d7b" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">跑在CDN后面</li><li id="fb9c" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">使用由<a class="ae le" href="https://letsencrypt.org/" rel="noopener ugc nofollow" target="_blank">生成的证书和私钥运行，让我们加密</a>。</li></ul><p id="ba16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们继续下一节的设置和安装。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="4aa9" class="ml mm it bd mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bi translated">设置</h1><p id="c650" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">您可以选择:</p><ul class=""><li id="d1cb" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">根据您的操作系统下载预构建的二进制文件</li><li id="1d5e" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">从源代码构建包</li></ul><h2 id="32c1" class="no mm it bd mn np nq dn mr nr ns dp mv kb nt nu mz kf nv nw nd kj nx ny nh nz bi translated">预建二进制</h2><p id="e8e7" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">您可以根据您的操作系统从<a class="ae le" href="https://github.com/suyashkumar/ssl-proxy/releases/" rel="noopener ugc nofollow" target="_blank">官方存储库</a>下载预构建的二进制文件:</p><ul class=""><li id="0e84" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated"><a class="ae le" href="https://github.com/suyashkumar/ssl-proxy/releases/download/v0.2.6/ssl-proxy-darwin-amd64.tar.gz" rel="noopener ugc nofollow" target="_blank">ssl-proxy-darwin-amd64.tar.gz</a></li><li id="4430" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated"><a class="ae le" href="https://github.com/suyashkumar/ssl-proxy/releases/download/v0.2.6/ssl-proxy-linux-amd64.tar.gz" rel="noopener ugc nofollow" target="_blank">ssl-proxy-linux-amd64.tar.gz</a></li><li id="b7a0" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated"><a class="ae le" href="https://github.com/suyashkumar/ssl-proxy/releases/download/v0.2.6/ssl-proxy-windows-amd64.exe.zip" rel="noopener ugc nofollow" target="_blank">SSL-proxy-windows-amd64 . exe . zip</a></li></ul><p id="f1f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">只需解压缩文件，您就可以通过以下方式正常使用它:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="6a09" class="no mm it li b gy oe of l og oh">./ssl-proxy</span></pre><p id="1a69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">除此之外，您可以使用<code class="fe lf lg lh li b">wget</code>来获取基于您的操作系统的正确的二进制文件:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="5927" class="no mm it li b gy oe of l og oh">wget -qO- "<a class="ae le" href="https://getbin.io/suyashkumar/ssl-proxy" rel="noopener ugc nofollow" target="_blank">https://getbin.io/suyashkumar/ssl-proxy</a>" | tar xvz</span></pre><p id="b225" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者，<code class="fe lf lg lh li b">curl</code>命令可以用来直接拉取特定的二进制文件</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="1652" class="no mm it li b gy oe of l og oh">curl -LJ "<a class="ae le" href="https://getbin.io/suyashkumar/ssl-proxy?os=linux" rel="noopener ugc nofollow" target="_blank">https://getbin.io/suyashkumar/ssl-proxy?os=linux</a>" | tar xvz</span></pre><p id="de9d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它接受以下选项:</p><ul class=""><li id="3f35" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">达尔文</li><li id="a371" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">窗子</li><li id="a7ff" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">Linux操作系统</li></ul><h2 id="ac56" class="no mm it bd mn np nq dn mr nr ns dp mv kb nt nu mz kf nv nw nd kj nx ny nh nz bi translated">从源代码构建</h2><p id="d7cb" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">如果您的操作系统中已经安装了<code class="fe lf lg lh li b">docker-compose</code>，您可以按照如下方式构建它:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="ad15" class="no mm it li b gy oe of l og oh">docker-compose -f docker-compose.build.yml up</span></pre><p id="1b00" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它将在当前工作目录下的<code class="fe lf lg lh li b">build</code>文件夹中创建一个新的二进制文件。</p><p id="d96a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以选择用<code class="fe lf lg lh li b">make</code>和<code class="fe lf lg lh li b">dep</code>在本地建造。您所需要做的就是克隆存储库并运行<code class="fe lf lg lh li b">make</code>命令来构建它。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="92f0" class="ml mm it bd mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bi translated">履行</h1><p id="b940" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">一旦您的工作目录中有了<code class="fe lf lg lh li b">ssl-proxy</code>二进制文件，您就可以选择运行它:</p><ul class=""><li id="d6ed" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">自动自签名证书</li><li id="eee0" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">让我们加密SSL证书</li></ul><h2 id="0c92" class="no mm it bd mn np nq dn mr nr ns dp mv kb nt nu mz kf nv nw nd kj nx ny nh nz bi translated">自签名证书</h2><p id="445d" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">假设在当前工作目录中有Linux预构建的二进制文件，运行以下命令开始代理HTTPS流量:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="ab35" class="no mm it li b gy oe of l og oh">./ssl-proxy-linux-amd64 -from 0.0.0.0:4430 -to 127.0.0.1:8000</span></pre><ul class=""><li id="a2bc" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated"><code class="fe lf lg lh li b">from</code>:表示HTTPS路由为反向代理</li><li id="951c" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated"><code class="fe lf lg lh li b">to</code>:指你的开发应用(服务器、jupyter笔记本等)的HTTP路由。)</li></ul><p id="017d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这种情况下，它会将运行在端口<code class="fe lf lg lh li b">4430</code>上的外部URL代理到运行在端口<code class="fe lf lg lh li b">8000</code>上的网络URL。</p><p id="ff71" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">只需根据自己的需求修改网址即可。您可以省略<code class="fe lf lg lh li b">http/https</code>前缀，因为它将默认为以下内容:</p><ul class=""><li id="33fe" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated"><code class="fe lf lg lh li b">from</code> : https</li><li id="5510" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated"><code class="fe lf lg lh li b">to</code> : http</li></ul><p id="ff32" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在初始运行期间，它将在当前目录中生成一个自签名证书和一个私钥:</p><ul class=""><li id="9160" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">cert.pem</li><li id="1fbc" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">key.pem</li></ul><p id="36e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它将在后续运行中重复使用相同的文件。</p><p id="8125" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，您还可以通过以下参数提供自己的证书和私钥:</p><ul class=""><li id="fa75" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">确实的事情</li><li id="a79f" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">键</li></ul><p id="9b0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="0b9f" class="no mm it li b gy oe of l og oh">./ssl-proxy-linux-amd64 -cert cert.pem -key key.pem -from 0.0.0.0:4430 -to 127.0.0.1:8000</span></pre><h2 id="c798" class="no mm it bd mn np nq dn mr nr ns dp mv kb nt nu mz kf nv nw nd kj nx ny nh nz bi translated">让我们加密SSL证书</h2><p id="25f9" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">通常，您不应该使用此工具在多个服务器或生产服务器上进行负载平衡。如果需要临时SSL支持，请确保您有以下物品:</p><ul class=""><li id="4e1e" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">为您的应用程序保护一个域(运行并可公开访问)</li><li id="2ef3" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">可以绑定到端口443</li></ul><p id="f37f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完成后，您可以运行以下命令来获取和提供加密证书(假设您的域位于<code class="fe lf lg lh li b">mydomain.com</code>):</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="808b" class="no mm it li b gy oe of l og oh">./ssl-proxy-linux-amd64 -from 0.0.0.0:443 -to 127.0.0.1:8000 -domain=mydomain.com</span></pre></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="f2c0" class="ml mm it bd mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bi translated">试验</h1><p id="dfcd" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">假设您正在运行以下命令，通过自签名证书为您的应用程序提供服务:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="62d1" class="no mm it li b gy oe of l og oh">./ssl-proxy-linux-amd64 -from 0.0.0.0:4430 -to 127.0.0.1:8000</span></pre><p id="bcc9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该在终端上看到以下输出:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="2c05" class="no mm it li b gy oe of l og oh">Assuming -to URL is using http://<br/>Proxying calls from https://0.0.0.0:4430 (SSL/TLS) to http://127.0.0.1:8080<br/>...</span></pre><p id="e88e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，您可以通过(<code class="fe lf lg lh li b">hostname</code>指远程机器的公共IP)正常访问您的应用程序:</p><pre class="kp kq kr ks gt oa li ob oc aw od bi"><span id="eaed" class="no mm it li b gy oe of l og oh">https://&lt;hostname&gt;:4430</span></pre><p id="054d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在初始运行期间，您应该会看到“<code class="fe lf lg lh li b">Your Connection is Not Secure</code>”用户界面。只需点击<code class="fe lf lg lh li b">Advanced</code>按钮，接受证书。如果一切顺利，应用程序应该完全在安全的环境中运行(HTTPS)。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="787c" class="ml mm it bd mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bi translated">结论</h1><p id="6ef5" class="pw-post-body-paragraph jq jr it js b jt nj jv jw jx nk jz ka kb nl kd ke kf nm kh ki kj nn kl km kn im bi translated">让我们回顾一下你今天所学的内容。</p><p id="d31b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文首先简要介绍了问题陈述以及如何使用<code class="fe lf lg lh li b">ssl-proxy</code>来解决问题。</p><p id="2d73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，它继续一步一步的指导，以获得基于操作系统的可执行二进制文件。</p><p id="ce47" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来是实现部分，分为自签名证书和加密证书。</p><p id="21a2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，它讲述了在浏览器上访问和测试您的应用程序。</p><p id="8c03" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读。祝你有美好的一天！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="b322" class="ml mm it bd mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bi translated">参考</h1><ol class=""><li id="da5d" class="lq lr it js b jt nj jx nk kb oi kf oj kj ok kn ol lw lx ly bi translated"><a class="ae le" href="https://github.com/suyashkumar/ssl-proxy" rel="noopener ugc nofollow" target="_blank"> Github — ssl代理</a></li></ol></div></div>    
</body>
</html>