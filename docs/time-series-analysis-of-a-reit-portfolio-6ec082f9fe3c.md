# 房地产投资信托组合的时间序列分析

> 原文：<https://levelup.gitconnected.com/time-series-analysis-of-a-reit-portfolio-6ec082f9fe3c>

作者安德鲁·科尔

![](img/2e6a29727015fbef9ca2fdc82f14d1d4.png)

金融建模是一项与金融本身一样古老的技术应用。传统上是通过 excel 表格和各种 DCF 模型来执行的，我想开始并使用机器学习来建立一个资产价格运动的预测模型。在为期两周的项目时间内，我着手分析并建立预测 SARIMAX(**S**easonal**A**uto-**R**EI**M**Iintegrated**M**v**A**average with E**x**ogeneity)模型，以捕捉八个不同房地产投资信托基金(REITs)的动向。

我们首先将分析时间序列数据，以便在建立模型时考虑正确的输入参数。一旦我们选择了最佳参数，将引入多个外生变量，以查看金融行业中的外部变量对我们预测的目标变量的影响。最后，相对于每一个房地产投资信托基金的最重要的变量将被选择用于最终的 SARIMAX 模型。所附的 GitHub 库将提供对模型构建的底层代码的进一步了解，可以在这里找到。

# **房地产投资信托**

在我们进入数据之前，有必要先了解房地产投资信托基金的性质。房地产投资信托基金就像任何其他金融资产一样，所有权代表着公司利润的“份额”。这些公司拥有并经营创收的房地产，通常集中在房地产类型的特定领域(数据中心、零售物业、老年/辅助生活社区、医疗保健等)。房地产投资信托基金主要有两种类型:

*   **股权:**硬房地产资产投资。收入通常来自传统的房地产来源，如租金和物业管理费。他们还通过在以产业为中心的空间获得被低估的房地产来创造利润。
*   **抵押贷款(mREITs):** 这些房地产投资信托基金只投资于抵押贷款，只占房地产投资信托基金的一小部分。收入主要来自抵押贷款的利息。

与任何其他类型的创收资产相比，它们还拥有历史上最高的资本回报率。下图显示了多种资产类别的年回报率，从 1972 年至今，房地产投资信托基金的复合回报率最高，接近 12%。

![](img/b6718520285e3452d632af5decd453ef.png)

来源:晨星

房地产投资信托基金的运作确实与你正常的收益型股票或共同基金有所不同。证券交易委员会实际上要求房地产投资信托公司将其年度应税收入的 90%以股息的形式分配给股东。这使得投资者能够获得多样化和流动性的有形资产投资，并有成功的记录。因此，自然地，尝试并产生一个可以给 REIT 投资带来优势的预测性机器学习模型是有意义的。

# **时间序列分析**

我首先使用 AlphaVantage 提供的 API 收集了从 2000 年到现在的八个不同 REITs(股票代码:AMT、ELS、PLD、FR、MAA、SUI、BXMT、RHP)的财务数据。返回的数据是每日的，但是每日的数据会导致非常嘈杂(大量方差)的时间序列数据，因此我们对指数进行重新采样，以得到每个值的月平均值。对月度指数的重新采样也将使我们能够考虑到模型中后期数据中出现的任何季节性。

由于金融资产的高价格和低价格可能会因一天中的市场周期而大相径庭，因此计算每月的中间(平均)价格作为预测的目标变量。通过使用月平均值，我们还降低了执行这些计算的计算成本(不幸的是，我的 MacBook Air 无法在分配的时间段内运行太深的数据模型)。最后，除了日期时间索引和“mid”内生变量，我们删除了其余的数据帧特性。

我们现在有 254 个月平均中间价，如下所示:

![](img/a4d06e91b7d7df28920e0dd7a81a8146.png)

# 选择模型参数

在构建模型时，我们将调整输入以反映系列的潜在变化，因此执行分解将允许我们深入了解实际发生的情况。为了分解该模型，我们首先采用该序列的对数来解释我们从 2000 年到 2020 年看到的价格指数上升(和下降)。然后，我们来看一下该系列的三个独立组件，它们在构建模型时将具有参数输入含义:

*   **趋势:**系列随时间的持续增加或减少。我们需要系列在运动中保持静止，以便我们能够识别和评估系列的未来变化。去除后的余数可以看作是不规则的，这可能揭示未来预测序列的变化。在我们的案例中，我们看到 FR 在 2008 年经济衰退之前有轻微的上升趋势，然后急剧下降，然后回到目前逐渐上升的趋势。

![](img/47ad05e7b807b0d64a5e2a56d41b30e2.png)

*   **季节性:**时间序列自然会包含随时间重复的周期(每月、每年、季节性)。当足够频繁时，这种重复模式可以向模型提供强信号，这可能影响未来的不规则运动。对季节性进行识别和建模是必要的，以便作为参数输入到我们的 SARIMAX 模型中，分解过程将向我们显示它是否存在。下面，我们看到序列中存在显著的**月度季节性**，我们将在模型中将其作为参数输入进行记录和说明。

![](img/c239fb52ca206b33996b23a089fc6c68.png)

*   **残差:**残差是从时间序列中去除趋势性和季节性后剩下的东西。这些残差显示了时间序列运动中的任何异常，特别是我们可以看看 2008 年实际上是否是时间序列运动中的异常值。下图显示，衰退导致了系列持续时间内的不规则运动，这表明这些值是异常值，从图上平均值 0.0 线的剧烈变化可以明显看出。通常，这些异常值将从时间序列中剔除。然而，在对投资组合的所有八个房地产投资信托基金的分析中，我们并不一致认为 2008 年表现为异常值，因此我们将在所有八个房地产投资信托基金模型的时间序列中保留它。

![](img/2d580e923b81dafec588bbfbfb3756e1.png)

既然我们已经对时间序列数据中存在的潜在影响进行了深层次的解释，我们希望从统计上证明该模型是稳定的。同样，我们必须有一个稳定的时间序列，这意味着随着时间的推移，存在恒定的均值、方差和自相关性。我们采用模型的一个周期差异(意味着我们在当前值和上个月值之间采用一个月的周期差异)，以消除中间月份中可能改变这些恒定假设的任何影响。

尽管我们已经通过指数对数和差分解释了其中的大部分，但在我们继续建模之前，我们必须从统计上证明该序列是稳定的。为此，我们将进行 Dickey-Fuller 测试(零假设:序列是**而不是**平稳的)。如果返回的 p 值小于 0.05，我们可以有效地**拒绝**零假设。该特定序列返回的 p 值为 0.005，远低于临界值，这使我们可以断定时间序列**是稳定的，可以进行建模。**

# 选择模型参数:自回归和移动平均订单

也许 SARIMAX 模型的两个主要组成部分是 AR(自回归)和 MA(移动平均)项。

*   **自回归项:**说明变量对自身的回归，说明变量的滞后值(中间价)加上常数和白噪声(无方差序列)。这个输入参数允许我们考虑系列中的某个特定实例在之前的某个时间点以及这两个时间点之间的所有时间点将如何影响当前的模型。更简单地说，如果今天是 2020 年 1 月 31 日，那么从 2019 年 1 月 31 日到今天发生的一切会如何影响 2020 年 2 月的变量运动。
*   **移动平均项:**说明回归模型中过去的误差。这基本上说明了前几年 1 月份的变动，所有中间的变动都被删除了。

这些参数通过查看 Statsmodels Python 库中的自相关和偏自相关图来确定。为了选择适当的自回归和移动平均阶，现在用先前选择的最佳参数执行 SARIMAX 模型。我们将用于模型选择的 SARIMAX 模型指标是 AIC 和 BIC 分数。这些分数基本上允许您查看您的模型与可用数据的拟合程度，而不会过度拟合数据。

# **内生模型选择**

对于机器学习模型的建模，我们必须将数据分为训练和测试数据集。训练数据集是数据的大部分百分比(2000-2017)。我们建立的模型将使用这些训练数据来预测 2017-2020 年的价格走势。因为我们已经知道 2017-2020 年的数据**实际上**是什么，我们将把预测的价格变动叠加到实际数据上，看看我们在捕捉这些变动方面有多有效。这就是所谓的验证。如果我们要包括 2000 年至今的所有数据，该模型将 100%基于以前的数据进行训练，因此将**过度拟合。**过拟合数据集会将模型解释为 100%依赖于完整数据集，因此当引入新的未来数据时，它不知道如何反应。

现在，使用以下代码构建和计算模型:

```
model = sm.tsa.statespace.SARIMAX(FR_train, 
                                  order = (0,1,5), 
                                  seasonal_parameters = (0,1,5,12))results = model.fit() 
```

*   **FR_train:** 来自(2000–2017)的 FR 中间价训练数据集。通常情况下，训练集占数据的 70–80 %,但是因为我们对每月时间段进行了重新采样，所以我们将数据减少了 12 倍，并且需要通过增加训练集的大小来解决这个问题。
*   **顺序:**(自回归顺序、差分顺序、移动平均顺序)
*   **季节性参数:**与 Order 相同，但包括一个最终季节性项= 12，以告诉模型该时间序列存在月度季节性(这是我们在分解过程中发现的)。

我们通过 AIC 和 BIC 评分来评估我们模型的性能。这些分数本质上告诉我们，我们的模型在没有过度拟合的情况下，与数据集的拟合程度如何。分数越低，您的模型在表示数据的实际移动方面就越有效。在模型中执行多个自回归和移动平均顺序参数，并相互比较得分，返回的最低 AIC 得分是我们将选择向前推进的模型，用于带有外生变量的 SARIMAX 建模。

# 外生变量的收集和选择

我们刚刚建立的模型只包含内部信息。然而，正如我们所知，有大量的影响金融工具的运动。我们想看看房地产投资信托基金的走势是否与各种金融工具有任何联系，因为向模型中添加更多信息将会改善模型的性能。为了做到这一点，从美联储经济数据库(FRED)中收集了 55 个不同性质的外生变量。所有的外生变量被重新采样为类似于内生变量的月均值，并被分成训练和测试数据框架。收集的外部变量分为以下几类:

*   一、**利率(48.3%):** 联邦最优惠贷款利率、30 年期抵押贷款利率等。
*   **商业银行(22.4%):** 所有国内商业银行机构的总资产、总负债等。
*   **金融指标(15.5%):** CBOE 波动指数、消费价格指数等。
*   **汇率(6.9%):** 美元/欧元外汇、美国/中国外汇等。
*   **学术数据(5.2%):** 任何数学推导出来的指标，如金融不确定性指数等。
*   **价格(1.7%):** 各行业平均价格指数

# 外生变量选择:套索回归

即使我们现在有了所有的外生变量，但几乎不可能每个变量都会对房地产投资信托基金的内生价格变量产生影响。为了减少模型中使用的变量，我们将执行套索回归，以查看哪些变量对我们预测的价格变量影响最大。这被称为“L1”正则化惩罚，其本质上仅识别哪些变量系数对预测变量具有显著影响。这种套索回归适用于投资组合中的每一个房地产投资信托基金，因为房地产投资信托基金来自不同的行业，可能有不同的影响变量。套索回归返回:

![](img/7d0be7ade6fd336fe391912817955504.png)

y 轴表示变量的名称，x 轴表示回归系数的值。在确定特征重要性时，我们看绝对值。在这种情况下，FR 时间序列受两个变量的影响最大:

*   **美元:**新加坡/美国汇率
*   **dexusuk:** 英国/美国汇率

# **最终的 SARIMAX 模型**

既然我们已经根据房地产投资信托基金选择了外生变量，我们现在可以在最终外生变量到位的情况下运行模型。代码如下:

```
model = sm.tsa.statespace.SARIMAX(FR_train,
                                  exog = exog_train,
                                  order = (0,1,5),
                                  seasonal_order = (0,1,5,12),
                                  enforce_stationarity = False,
                                  enforce_invertability = False,
                                  trend = 't')
results = model.fit()
predictions = results.get_prediction(start = pd.todatetime('2015-01-01),
                                     end = pd.todatetime('2020-01-01'),
                                     dynamic = False,
                                     exog = exog_test)
pred_conf = predictions.conf_int()
```

内生模型的参数将保持不变，我们将外生变量训练集添加到模型中。该模型使用“一步预测”，即预测一个月(一个时间序列步)，然后重新计算下一步。该模型在绘制时看起来像这样:

![](img/6a025d4f8ab905e23de1842a1b9d72b7.png)

橙色线是最初的中间价变动，蓝色虚线是模型的预测价格。蓝色预测线周围的蓝色阴影区域表明，如果发生意外事件，我们有 95%的把握认为该值会落在该区域内。

# 结论

模型结果是积极的，因为我们通常很好地捕捉了价格的运动，但并不准确。事实证明，这一特定序列的自回归项不如移动平均项有用，这突出表明，2008 年的衰退是一种统计异常，这无疑严重影响了模型的性能。此外，该模型缺乏足够的数据量。当我们对月度时间框架进行重新采样时，我们极大地减少了数据量，因此作为结果，对股票中间价的实际运动的一般捕捉是足够的，但是我不会在不增加数据量的情况下将该模型应用到应用程序中。

此外，如果获得更多的计算能力，参数选择将大大增强。给定一两个 GPU，在自动 ARIMA 模型上使用网格搜索方法，该方法将遍历所有可能的 AR & MA 项并返回最优项。在我的电脑上，迭代这些模型中的一个大约需要三个小时，结果并不理想。

投资组合中所有八个房地产投资信托基金的模型预测如下，请注意，在捕捉数据移动方面，一些比另一些更有效。

**金额:**

![](img/f873e0da50243ce77a1347f48baf93ea.png)

**ELS:**

![](img/f7d1ccbc65cd941eb112177a0440de65.png)

**PLD:**

![](img/d5fad655d556dd3d39bca96073f6b80d.png)

**MAA:**

![](img/ff36956fa4c77ee7bb5a844205e5faf0.png)

**BXMT:**

![](img/13b5fa8bb2f089667c24be061cc9b30c.png)

**隋:**

![](img/c00e2f815dc3f35612fd11790aa22e8f.png)

**RHP:**

![](img/0e5e3254cef61dd73da47bf65cfa39ef.png)