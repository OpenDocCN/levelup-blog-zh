<html>
<head>
<title>Training an ML.NET Image Classification Model on GPUs using Google Colab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Colab在GPU上训练Model图像分类模型</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/training-an-ml-net-image-classification-model-on-gpus-using-google-colab-ee40b38af7e5?source=collection_archive---------4-----------------------#2021-12-29">https://levelup.gitconnected.com/training-an-ml-net-image-classification-model-on-gpus-using-google-colab-ee40b38af7e5?source=collection_archive---------4-----------------------#2021-12-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ff22261b41b765f55f356c42b5c8a991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fXBYEoQlNJcxE5ZisDQPQ.jpeg"/></div></div></figure><p id="e46f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你是一个ML.NET用户，并希望在GPU上训练你的模型，你可能会发现你有有限的易于使用的选项。如果你的台式机支持Nvidia GPU显卡，那么你很幸运！如果你碰巧在一个“普通”的台式机或笔记本电脑上，你会陷入CPU训练，这可不好玩。当然有一些选择，比如在云中运行虚拟机或者使用Azure Machine Learning Studio之类的服务，但即使这样，也有一些困难需要克服。在本帖中，我们将看看如何利用Google Colab不仅训练你的ML.NET模型，而且训练得更快。</p><p id="d150" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这篇文章将直接探讨在Colab上运行ML.NET。我们不会考虑您为什么要这样做，尽管有许多很好的理由说明Colab对您的ML.NET工作负载有意义。</p><p id="e170" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可以在<a class="ae kz" href="https://www.youtube.com/channel/UCyLZieUSKFGLBOibC7xB1zg" rel="noopener ugc nofollow" target="_blank">实用ML.NET用户群YouTube页面</a>找到这篇文章的完整视频。<em class="la">请喜欢并订阅！</em> <a class="ae kz" href="https://github.com/atkinsonbg/training-mlnet-using-google-colab-on-gpus" rel="noopener ugc nofollow" target="_blank"> GitHub回购可以在这里找到</a>。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="1eae" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">ML。Google Colab快速入门</h1><p id="d695" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">Colab与其他一些更受欢迎的免费机器学习平台略有不同，如Kaggle或Gradient Notebooks。Colab提供了一个稍微宽松的环境，这意味着我们可以安装。NET和ML.NET合并成一个Colab会话。例如，这在Kaggle或Gradient中是不可能的。然而，不要认为你可以在那里安装任何东西。例如，你不能安装Docker和运行容器，所以它不是免费的。</p><p id="0bf5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你是Colab的新手，这非常简单明了。一切都是从你的谷歌驱动器上运行的，所以只需打开你的驱动器，从“新建”按钮，从下拉列表中选择“更多”选项，然后选择“谷歌协作”。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ml"><img src="../Images/e85e1977db6896deaa76b1910b411fed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8wgia--RhcviOFM1XsPXw.png"/></div></div></figure><p id="14fa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将创造一个新的”。ipynb”笔记本，并在Colab中打开它。正在安装。NET和ML.NET就像创建一个新的笔记本并运行以下命令一样简单:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="1472" class="mv lj it mr b gy mw mx l my mz">! wget -q https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb \</span><span id="4500" class="mv lj it mr b gy na mx l my mz">&amp;&amp; dpkg -i packages-microsoft-prod.deb \</span><span id="af8a" class="mv lj it mr b gy na mx l my mz">&amp;&amp; add-apt-repository universe \</span><span id="6ccc" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get update \</span><span id="a0a0" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get install apt-transport-https \</span><span id="b34e" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get update \</span><span id="55d2" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get install dotnet-sdk-6.0 \</span><span id="463a" class="mv lj it mr b gy na mx l my mz">&amp;&amp; dotnet tool install -g mlnet</span></pre><p id="386d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些命令将会安装。在我们的例子中是NET。NET 6，以及最新版本的ML.NET。这些应该会成功运行，然后您可以发出一个<code class="fe nb nc nd mr b">dotnet --version</code>命令来确保一切正常工作。这非常简单，现在，您已经有了一个可以开始做的Colab环境。网络工作。例如，如果你只是想开始一些自动ML工作，你都准备好了。唯一的缺点是…您只能在CPU上这样做。我们希望利用Colab中可用的GPU的全部能力。因此，让我们深入探讨如何做到这一点。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="800a" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">GitHub报告和代码</h1><p id="1eda" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">我们使用的代码报告是来自。NET机器学习样本GitHub报告。该代码基本上将混凝土表面的图像分为两类，有裂缝的和无裂缝的。这是一个简单的二元分类示例，他们的数据集中有大约400张图像。你可以<a class="ae kz" href="https://github.com/atkinsonbg/training-mlnet-using-google-colab-on-gpus" rel="noopener ugc nofollow" target="_blank">在这里</a>查看这个帖子的代码。</p><p id="be9e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们不会分解代码，因为这篇文章是关于在GPU上运行这些代码，而不是实际上写它需要什么。然而，在我的回购和微软的例子之间，你已经准备好学习更好的细节。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="eb53" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">使用GPU的先决条件</strong></h1><p id="9838" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">我们将在接下来的部分中简要介绍每个项目，一旦我们查看我们的Colab笔记本，您将再次看到它们，它在每个部分中都有详细的注释。</p><p id="c546" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用ML.NET对GPU进行培训有几个要求。如上所述，关于CPU的培训非常容易，只需安装ML.NET并开始。对于GPU来说，有几个困难需要克服，幸运的是它们不是太大。</p><h2 id="0473" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">CUDA v10.1和CUDNN v7.6.4</h2><p id="22f4" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">在<a class="ae kz" href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.ml.vision.imageclassificationtrainer?view=ml-dotnet#gpu-support" rel="noopener ugc nofollow" target="_blank">图像分类文档</a>中，你会发现第一个需求是CUDA和CUDNN。您需要确保在您的环境中安装了<a class="ae kz" href="https://developer.nvidia.com/cuda-10.1-download-archive-update2" rel="noopener ugc nofollow" target="_blank"> CUDA v10.1 </a>和<a class="ae kz" href="https://developer.nvidia.com/rdp/cudnn-download" rel="noopener ugc nofollow" target="_blank"> CUDNN v7.6.4 </a>或更高版本。重要的是要注意，这些是最低要求，如果你有一个更高的版本是可以的。例如，在撰写本文时，Google Colab已经安装了CUDA版本11.2。从CUDA文档<a class="ae kz" href="https://docs.nvidia.com/deploy/cuda-compatibility/" rel="noopener ugc nofollow" target="_blank">来看</a>“驱动程序总是向后兼容CUDA”。<em class="la">同样重要的是要注意，这很可能仅在使用ML.NET API时出现，因为Auto ML似乎对10.1有要求，很可能是由于与其相关的</em> Tensorflow <em class="la">的版本。</em></p><h2 id="2a7b" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">SciSharp。TensorFlow.Redist-Linux-GPU</h2><p id="5bad" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">Google Colab在Ubuntu环境下运行，所以我们需要确保我们有正确的<a class="ae kz" href="https://github.com/SciSharp/TensorFlow.NET/tree/master/tensorflowlib#gpu-for-linux" rel="noopener ugc nofollow" target="_blank"> SciSharp。TensorFlow.Redist包安装</a>。让我们看看代码的<code class="fe nb nc nd mr b">.csproj</code>文件:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="a8bb" class="mv lj it mr b gy mw mx l my mz">&lt;ItemGroup&gt;<br/>    &lt;!-- CPU version, use on MacOS or Windows without GPU card --&gt;<br/>    &lt;!-- &lt;PackageReference Include="SciSharp.TensorFlow.Redist" Version="2.3.1" /&gt; --&gt;</span><span id="8201" class="mv lj it mr b gy na mx l my mz">&lt;!-- Windows GPU version, use on Windows with GPU card --&gt;<br/>    &lt;!-- &lt;PackageReference Include="SciSharp.TensorFlow.Redist-Windows-GPU" Version="2.6.0" /&gt; --&gt;</span><span id="5af9" class="mv lj it mr b gy na mx l my mz">&lt;!-- Linux GPU version, use on Linux with GPU card --&gt;<br/>    &lt;PackageReference Include="SciSharp.TensorFlow.Redist-Linux-GPU" Version="2.5.0" ExcludeAssets="native" /&gt;<br/>  &lt;/ItemGroup&gt;</span></pre><p id="57b1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如你所见，我们引用了SciSharp的所有版本。TensorFlow.Redist，主要帮助支持本地开发以及在Colab中运行。所有其他版本都被注释掉了，除了<code class="fe nb nc nd mr b">Linux GPU</code>包，我们需要构建它来在Colab中运行。</p><p id="fd06" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请注意包参考中的<code class="fe nb nc nd mr b">ExcludeAssets="native"</code>。这说明。NET不包括Tensorflow的任何版本。这样做的原因是，当您启动一个新的Colab会话时，您很可能会在您的环境中获得最新版本的Tensorflow。在这篇文章发表的时候，我们得到了Tensorflow 2.7。我们需要控制安装的Tensorflow的版本，以匹配SciSharp软件包的预期。当没有额外的二进制文件出现时，这样做更容易。我们将在稍后的Colab笔记本中对此进行更深入的探讨。</p><h2 id="2f0c" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">Libtensorflow C库</h2><p id="b1f7" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">这些库是SciSharp 正常运行所必需的，并且不会在您的Colab环境中自然存在。幸运的是，这些可以很容易地从<a class="ae kz" href="https://www.tensorflow.org/install/lang_c" rel="noopener ugc nofollow" target="_blank"> Tensorflow网站</a>下载。一旦我们下载并安装了库，我们必须使用<code class="fe nb nc nd mr b">ldconfig</code>配置链接器，并设置几个环境变量。</p><h2 id="fcf4" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">libgdiplus &amp; libc6-dev</h2><p id="0503" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated"><a class="ae kz" href="https://github.com/SciSharp/TensorFlow.NET/tree/master/tensorflowlib#run-in-linux" rel="noopener ugc nofollow" target="_blank">最后，我们需要确保安装另外两个包</a>来支持图像分类。幸运的是，libc6-dev应该已经存在了，但是如果你想再次安装这两个程序，也不会有什么问题。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="64fe" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">升级我们的代码</h1><p id="68c2" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">在我们深入研究Colab笔记本之前，让我们先来讨论一下如何将代码转移到Colab中运行。</p><h2 id="0f29" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">使用Google Drive</h2><p id="ef9b" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">由于我们将使用Google Colab，所以我们将代码存放在Google Drive中也就不足为奇了。正如我们之前看到的那样，从驱动器启动笔记本电脑非常容易，而且将我们的驱动器连接到我们的Colab会话也很简单，稍后我们将会看到这一点。你需要登录谷歌并打开你的硬盘。为您的代码创建一个新文件夹，并上传位于此处的笔记本。这是我们将用于代码的培训笔记本。</p><h2 id="284c" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">为Linux发布</h2><p id="f1bf" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">我们需要为我们的Linux环境发布我们的训练代码。由于我们将四处移动代码(上传到驱动器)，我更喜欢使用单个文件发布。以下命令将在发布模式下发布单个文件，不带调试符号:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="8221" class="mv lj it mr b gy mw mx l my mz">dotnet publish -o ColabOutput -c Release -r linux-x64 --self-contained true -p:PublishSingleFile=true /p:DebugType=None /p:DebugSymbols=false</span></pre><p id="a577" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个命令还将发布到一个名为“ColabOutput”的文件夹中，这使得上传更加容易。只需进入驱动器中的新文件夹，右键单击任意位置，然后选择“上传文件夹”。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/b01cb998d33cdde3a6a4ce26ca80a987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*Fezz7r3rWCMjf9pgVbOjLw.png"/></div></figure><h2 id="b9cd" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">图像数据集</h2><p id="3706" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">由于我们正在做图像分类训练练习，我们将需要图像！这个<a class="ae kz" href="https://github.com/atkinsonbg/training-mlnet-using-google-colab-on-gpus/tree/main/App/Data/Images" rel="noopener ugc nofollow" target="_blank">例子需要的所有图像都在这里</a>。这些直接来自。NET深度学习示例，无需任何修改。只需压缩整个“图像”目录，其中包括UD和CD的子目录。将这个zip文件也上传到您的驱动器，因为我们稍后将在我们的Colab笔记本中需要它。</p><h2 id="65af" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">图像数据集CSV</h2><p id="9894" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">你可以在repo中找到一个Jupyter笔记本，它被用来创建我们的数据集CSV文件，或者简单地使用位于这里的<a class="ae kz" href="https://github.com/atkinsonbg/training-mlnet-using-google-colab-on-gpus/blob/main/App/Data/Notebooks/training_data.csv" rel="noopener ugc nofollow" target="_blank">预建的一个</a>。笔记本是所有图像及其标签的一个非常简单(非优化)的集合。生成的CSV有两列:ImagePath和Label。正如您在下面的ImagePath列中看到的，所有图像路径都有“../Images ”,所以在这个级别压缩整个“Images”目录很重要。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/372361ed949d5c05bbcccf70bd7188e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nn4CJ9RZq_u_Vg42u4M6vA.png"/></div></div></figure><p id="62b0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们现在不需要将CSV上传到Drive。这样做的原因是，任何通过Google UI上传到Drive的CSV文件都会自动转换成Google Sheets格式。这对我们的代码不起作用。幸运的是，Jupyter笔记本提供了一种上传文件的方式，所以我们可以绕过这一步，轻松发布。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="c8ff" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">Colab笔记本</h1><p id="faa9" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">现在我们的代码已经发布，所有的数据都已经暂存，我们可以进入位于这里的<a class="ae kz" href="https://github.com/atkinsonbg/training-mlnet-using-google-colab-on-gpus/blob/main/App/Data/Colab/colab-training.ipynb" rel="noopener ugc nofollow" target="_blank">Colab笔记本。一旦上传到你的硬盘上，只需右键点击并选择“打开方式= &gt; Google协同实验室”。这将在Colab中启动笔记本，如下所示:</a></p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/36122b4f4618488325d262ccfcfbc0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n8DjI0rTTS3hdubgN45iVg.png"/></div></div></figure><h2 id="578b" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">设置您的环境</h2><p id="482c" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">在我们在本笔记本中进行任何操作之前，我们需要确保我们设置为使用GPU。您可以从页面顶部的菜单中选择“运行时= &gt;更改运行时类型”。这将打开如下所示的模式对话框:</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/03a72558de66aebb7d32e9a8edc86266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E2zemzIUX5ewLPs_hlJM2Q.png"/></div></div></figure><p id="e311" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在“硬件加速器”下，确保选择了GPU。您应该有无(CPU)、GPU和TPU的选项。我们需要GPU，所以选择这个。注意:我使用的是Colab Pro，它提供了“运行时形状”选项。如果你在免费版上可能看不到这个，但是如果你可以选择"高内存"，我的意思是…为什么不呢？</p><h2 id="32c1" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">检查您的CUDA设置</h2><p id="facf" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">我们需要做的第一件事是在我们的Colab会话中检查我们的CUDA设置，我们可以通过运行以下命令来完成:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="1739" class="mv lj it mr b gy mw mx l my mz">! uname -m</span><span id="49ea" class="mv lj it mr b gy na mx l my mz">! lscpu</span><span id="2929" class="mv lj it mr b gy na mx l my mz">! cat /proc/meminfo</span><span id="8440" class="mv lj it mr b gy na mx l my mz">! nvcc --version</span><span id="91ff" class="mv lj it mr b gy na mx l my mz">! nvidia-smi</span></pre><p id="37a5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将向我们展示的不仅仅是CUDA版本，如果这是您唯一想看到的，那么您可以简单地运行<code class="fe nb nc nd mr b">! nvidia-smi</code>进行检查，如果一切安装正确，您应该会看到以下内容:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="efd3" class="mv lj it mr b gy mw mx l my mz">+-----------------------------------------------------------------------------+ | NVIDIA-SMI 495.44       Driver Version: 460.32.03    CUDA Version: 11.2     | |-------------------------------+----------------------+----------------------+ | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC | | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. | |                               |                      |               MIG M. | |===============================+======================+======================| |   0  Tesla P100-PCIE...  Off  | 00000000:00:04.0 Off |                    0 | | N/A   37C    P0    28W / 250W |      0MiB / 16280MiB |      0%      Default | |                               |                      |                  N/A | +-------------------------------+----------------------+----------------------+                                                                                 +-----------------------------------------------------------------------------+ | Processes:                                                                  | |  GPU   GI   CI        PID   Type   Process name                  GPU Memory | |        ID   ID                                                   Usage      | |=============================================================================| |  No running processes found                                                 | +-----------------------------------------------------------------------------+</span></pre><p id="e889" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从这些信息中，我们可以看到我们的CUDA版本11.2，我们也可以访问特斯拉P100 GPU。如果您没有得到这样的输出，只需进入菜单并选择“Runtime =&gt; Reset factory runtime”。这将清除您所做的一切，并重置您的Colab会话。这一步非常重要，因为有时环境会启动，CUDA对您不可用。这是您希望立即发现并解决的问题，而不是在您准备运行培训代码时！</p><h2 id="c66d" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">移除Tensorflow 2.7并安装Tensorflow 2.3.1</h2><p id="759d" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">如前所述，我们需要控制环境中安装的Tensorflow的版本。在撰写本文时，SciSharp预计将安装tensor flow 2 . 3 . 1版。如果您没有安装Tensorflow或安装了不正确的版本，您将在训练过程中得到一个错误，即找不到Tensorflow。因此，确保您安装了正确的版本非常重要。我们可以使用以下命令来实现这一点:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="88be" class="mv lj it mr b gy mw mx l my mz">! pip uninstall --yes tensorflow</span><span id="9793" class="mv lj it mr b gy na mx l my mz">! pip install tensorflow==2.3.1</span><span id="6d91" class="mv lj it mr b gy na mx l my mz">! pip install tensorflow-gpu==2.3.1</span></pre><p id="9a99" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，我们卸载当前安装的Tensorflow版本，在我们的例子中是2.7。一旦完成，我们安装2.3.1以及2.3.1 GPU版本。运行这些程序后，您可能会收到一条警告消息，提示您需要重新启动才能使用新的Tensorflow版本。您可以放心地忽略这一点。我们可以通过运行以下命令来验证这一点:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="273a" class="mv lj it mr b gy mw mx l my mz">! pip show tensorflow</span><span id="d5b5" class="mv lj it mr b gy na mx l my mz">import tensorflow as tf</span><span id="7358" class="mv lj it mr b gy na mx l my mz">print(tf.__version__)</span><span id="9a20" class="mv lj it mr b gy na mx l my mz">print(tf.test.gpu_device_name())</span><span id="2eb0" class="mv lj it mr b gy na mx l my mz">print("Num GPUs Available: ", len(tf.config.experimental.list_physical_devices('GPU')))</span></pre><p id="141e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些命令只是进行健全性检查，以确保安装了正确版本的Tensorflow。运行这些命令应该会产生以下输出:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="2399" class="mv lj it mr b gy mw mx l my mz">Name: tensorflow<br/>Version: 2.3.1<br/>Summary: TensorFlow is an open source machine learning framework for everyone.<br/>Home-page: <a class="ae kz" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/</a><br/>Author: Google Inc.<br/>Author-email: <a class="ae kz" href="mailto:packages@tensorflow.org" rel="noopener ugc nofollow" target="_blank">packages@tensorflow.org</a><br/>License: Apache 2.0<br/>Location: /usr/local/lib/python3.7/dist-packages<br/>Requires: numpy, protobuf, keras-preprocessing, tensorflow-estimator, absl-py, astunparse, tensorboard, h5py, gast, grpcio, six, opt-einsum, wrapt, google-pasta, termcolor, wheel<br/>Required-by: kapre<br/>2.3.1<br/>/device:GPU:0<br/>Num GPUs Available:  1</span></pre><p id="7714" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如您所见，我们现在已经安装了版本2.3.1，并且不需要重新启动我们的会话。这也表明我们有1个GPU可供使用。现在已经安装了Tensorflow的正确版本，我们可以继续了。</p><h2 id="9955" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">libgdiplus &amp; libc6-dev</h2><p id="7bc3" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">如上所述，我们需要安装libgdiplus &amp; libc6-dev来进行图像分类，这可以通过以下命令来完成:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="2bc5" class="mv lj it mr b gy mw mx l my mz">! sudo apt install libc6-dev</span><span id="cf96" class="mv lj it mr b gy na mx l my mz">! sudo apt install libgdiplus</span></pre><h2 id="a8fb" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">Libtensorflow C库</h2><p id="195c" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">接下来，我们如上所述安装Libtensorflow C库。这可以通过以下命令完成:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="bafd" class="mv lj it mr b gy mw mx l my mz">! wget -q https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-gpu-linux-x86_64-2.3.1.tar.gz</span><span id="061c" class="mv lj it mr b gy na mx l my mz">! sudo tar -C /usr/local -xzf libtensorflow-gpu-linux-x86_64-2.3.1.tar.gz</span><span id="0886" class="mv lj it mr b gy na mx l my mz">! sudo ldconfig</span><span id="1144" class="mv lj it mr b gy na mx l my mz">%env LIBRARY_PATH=$LIBRARY_PATH:/usr/local</span><span id="801e" class="mv lj it mr b gy na mx l my mz">%env LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local</span></pre><p id="2751" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，我们简单地将压缩库下载到当前目录。接下来，我们将它们解压缩到<code class="fe nb nc nd mr b">/usr/local</code>目录。你应该可以把它们放在任何你想放的地方，但是这个对我很有效。接下来，我们通过运行<code class="fe nb nc nd mr b">ldconfig</code>来配置链接器，然后我们将<code class="fe nb nc nd mr b">/user/local</code>添加到<code class="fe nb nc nd mr b">LIBRARY_PATH</code>环境变量中，以便Tensorflow能够找到它们。至此，我们所有的Tensorflow设置都已完成，我们可以继续安装了。NET和ML.NET。</p><h2 id="048f" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">。NET &amp; ML。网</h2><p id="e412" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">我们已经看到了这些命令，但为了保持连续性，我们将再次查看它们:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="d2e4" class="mv lj it mr b gy mw mx l my mz">! wget -q https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb \</span><span id="c555" class="mv lj it mr b gy na mx l my mz">&amp;&amp; dpkg -i packages-microsoft-prod.deb \</span><span id="3afc" class="mv lj it mr b gy na mx l my mz">&amp;&amp; add-apt-repository universe \</span><span id="8437" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get update \</span><span id="1eb9" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get install apt-transport-https \</span><span id="2b26" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get update \</span><span id="0db5" class="mv lj it mr b gy na mx l my mz">&amp;&amp; apt-get install dotnet-sdk-6.0 \</span><span id="0cef" class="mv lj it mr b gy na mx l my mz">&amp;&amp; dotnet tool install -g mlnet</span></pre></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="2299" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">暂存数据</h1><p id="9d07" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">接下来，我们需要将我们的训练数据转移到我们的Colab会话中。我们需要做的第一件事是通过运行以下命令将驱动器装载到会话中:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="6c59" class="mv lj it mr b gy mw mx l my mz">from google.colab import drive</span><span id="1e34" class="mv lj it mr b gy na mx l my mz">drive.mount('/content/drive')</span></pre><p id="de88" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">运行该命令将产生一个模式对话框，询问您是否希望允许访问您的Google Drive文件:</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/5f331c86c76ae643406c2808227508f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0PFy4EDUeWHf8AzC4P4G0g.png"/></div></div></figure><p id="ba8a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">单击“连接到Google Drive”选项开始OAuth尝试，在这里您需要选择您想要连接的Google帐户，并同意Colab连接所需的权限。完成后，我们现在可以将图像数据集解压缩到我们的会话中:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="1aab" class="mv lj it mr b gy mw mx l my mz">! unzip -qq /content/drive/MyDrive/YOUR_FOLDER/Images.zip</span></pre><p id="f0d1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一个简单的<code class="fe nb nc nd mr b">unzip</code>命令，通过<code class="fe nb nc nd mr b">-qq</code>来避免任何输出，因为这取决于你拥有的图像数量，这可能会很繁琐。由于我们压缩了“Images”目录，这个命令将在我们的Colab会话中为我们留下一个相同的“Images”目录，其中包含我们所有的图像。为了进行健全性检查，我们可以对图像进行计数，以确保我们得到了预期的结果:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="63d6" class="mv lj it mr b gy mw mx l my mz">! ls Images/CD/ | wc -l</span><span id="c1cb" class="mv lj it mr b gy na mx l my mz">! ls Images/UD/ | wc -l</span></pre><p id="8849" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我们的例子中，这应该输出200 &amp; 200，因为我们总共有400个图像，每个文件夹中有200个。现在我们有了图像，让我们把CSV文件也放入Colab。我们可以使用以下命令来实现这一点:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="19e0" class="mv lj it mr b gy mw mx l my mz">from google.colab import files</span><span id="80d7" class="mv lj it mr b gy na mx l my mz">uploaded = files.upload()</span></pre><p id="4160" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是上传您可能需要的任何附加文件的便捷方式，在我们的例子中，这是绕过Google Sheets对<code class="fe nb nc nd mr b">.csv</code>文件转换的一种方式。运行此命令将打开以下选项来上传文件:</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/ab6a785516ed2c8268d30a9e263a112b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jALxht74F0nauyGrRLPu5A.png"/></div></div></figure><p id="78e3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">单击“选择文件”按钮，选择包含数据集数据的CSV。上传后，我们现在需要将<code class="fe nb nc nd mr b">.csv</code>文件移动到“图像”文件夹中:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="e33a" class="mv lj it mr b gy mw mx l my mz">! mv training_data.csv Images/</span></pre><p id="4c1d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的培训代码希望CSV文件位于Images文件夹的根目录下，如果您未能移动它，一旦您开始培训，您将得到一个“文件未找到”错误。既然我们的图像和CSV文件已经暂存，我们现在可以暂存我们的代码。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="ed28" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">准备代码</h1><p id="bed5" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">暂存代码非常类似于移动图像数据。由于我们的驱动器连接到我们的Colab会话，我们可以发出以下命令:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="eeea" class="mv lj it mr b gy mw mx l my mz">! rm -rf ColabOutput/</span><span id="78bd" class="mv lj it mr b gy na mx l my mz">! cp -a /content/drive/MyDrive/YOUR_FOLDER/ColabOutput/ .</span><span id="06a3" class="mv lj it mr b gy na mx l my mz">! chmod -R 777 ColabOutput/</span><span id="41c5" class="mv lj it mr b gy na mx l my mz">! ls ColabOutput/</span></pre><p id="52bb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们一个一个地分解这些:</p><ul class=""><li id="b293" class="nv nw it kd b ke kf ki kj km nx kq ny ku nz ky oa ob oc od bi translated">首先，我们删除任何以前的暂存代码。在我们的例子中，我们在本地将代码发布到一个名为“ColabOutput”的输出目录中，这是我们将复制到Colab中的内容。为了干净和安全，我们发出一个<code class="fe nb nc nd mr b">rm</code>命令来删除这个目录，如果它已经存在的话。</li><li id="74c4" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated">接下来，我们复制整个“ColabOutput”目录，这样对我们自己来说更容易。</li><li id="1ea2" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated">我们必须执行一个<code class="fe nb nc nd mr b">chmod</code>,否则当我们试图启动我们的训练代码时，会得到一个“权限被拒绝”的错误。</li><li id="c3e0" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated">最后，我们用一个<code class="fe nb nc nd mr b">ls</code>命令执行健全性检查，从视觉上确保我们的所有代码都通过了检查。</li></ul></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="3327" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">训练模型</h1><p id="c748" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">现在我们的数据和代码已经准备好了，我们可以使用下面的命令开始训练:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="0bd3" class="mv lj it mr b gy mw mx l my mz">! ./ColabOutput/App --train --folder="Images" --file="training_data.csv"</span></pre><p id="a55e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的应用程序是一个简单的控制台应用程序，我们可以按需运行来执行培训。我们使用<a class="ae kz" href="https://www.nuget.org/packages/CommandLineParser" rel="noopener ugc nofollow" target="_blank"> CommandLineParser NuGet包</a>来简化参数的传递。在这种情况下，我们有以下论点:</p><ul class=""><li id="55e2" class="nv nw it kd b ke kf ki kj km nx kq ny ku nz ky oa ob oc od bi translated"><code class="fe nb nc nd mr b">train</code>:这是基本命令，简单地指示代码执行训练。</li><li id="7d3b" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><code class="fe nb nc nd mr b">folder</code>:表示图像和CSV文件所在的目录。</li><li id="9bd9" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><code class="fe nb nc nd mr b">file</code>:提供CSV文件的名称，以防您想要提供具有不同数据的多个CSV文件等。</li></ul><p id="8422" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">发出此命令将开始训练，我们希望查看一些关键细节，以确保GPU训练确实在进行:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="4dfe" class="mv lj it mr b gy mw mx l my mz">2021-12-15 17:36:47.138748: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1<br/>2021-12-15 17:36:47.174564: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA<br/>To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.<br/>2021-12-15 17:36:47.188574: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2299995000 Hz<br/>2021-12-15 17:36:47.188898: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c2b3c15d40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:<br/>2021-12-15 17:36:47.188924: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version<br/>2021-12-15 17:36:47.190962: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1<br/>2021-12-15 17:36:47.195377: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br/>2021-12-15 17:36:47.195571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: <br/>pciBusID: 0000:00:04.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0<br/>coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s</span></pre><p id="0e8f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您应该会看到许多Tensorflow日志开始出现，以及一行关于代码所连接的GPU设备的内容。在这种情况下:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="86d1" class="mv lj it mr b gy mw mx l my mz">Tesla P100-PCIE-16GB computeCapability: 6.0<br/>coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s</span></pre><p id="cde3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">假设一切都已准备就绪，您应该开始看到培训日志被打印出来，最终，根据您拥有的数据量，将会构建一个模型。</p><p id="d2e1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">代码会将最终模型放入名为<code class="fe nb nc nd mr b">ud-cd-classifier.mdl</code>的“ColabOutput”目录中，您可以使用以下命令将它复制回您的驱动器:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="2ae5" class="mv lj it mr b gy mw mx l my mz">! cp -a ColabOutput/ud-cd-classifier.mdl /content/drive/MyDrive/YOUR_FOLDER/Models/ud-cd-classifier.mdl</span></pre><p id="8ac9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从这里开始，你的Google Drive中会有一个ML.NET图像分类模型，你可以下载并在任何你喜欢的地方使用它！</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="f7ee" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">包装它</h1><p id="a745" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">在这篇文章中，我们看到了如何利用谷歌Colab来执行与ML.NET的GPU培训。我可以诚实地说，我已经使用这个设置几个星期了，非常满意。肯定有一些困难要克服，但它们不是主要的，对于你所得到的来说，比麻烦更值得。我目前使用的是Colab Pro，每月支付10美元的服务费。很高兴知道这是一个硬成本上限，我几乎可以随时进入并使用它。</p><p id="b15c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这可能不是每个人的正确设置，但对于主要在MacBook Pro上工作的我(无法访问GPU)，这是一个很好的训练选择。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h2 id="18b3" class="mv lj it bd lk ne nf dn lo ng nh dp ls km ni nj lw kq nk nl ma ku nm nn me no bi translated">参考</h2><ul class=""><li id="b1a9" class="nv nw it kd b ke mg ki mh km oj kq ok ku ol ky oa ob oc od bi translated"><strong class="kd iu">谷歌实验室</strong>——【https://research.google.com/colaboratory/ T2】</li><li id="7b8a" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><strong class="kd iu"> ImageClassificationTrainer类文档</strong>—<a class="ae kz" href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.ml.vision.imageclassificationtrainer?view=ml-dotnet" rel="noopener ugc nofollow" target="_blank">https://Docs . Microsoft . com/en-us/dot net/API/Microsoft . ml . vision . ImageClassificationTrainer？view=ml-dotnet </a></li><li id="35b6" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><strong class="kd iu"> SciSharp/TensorFlow。NET Docs</strong>—<a class="ae kz" href="https://github.com/SciSharp/TensorFlow.NET/tree/master/tensorflowlib" rel="noopener ugc nofollow" target="_blank">https://github.com/SciSharp/TensorFlow.NET/tree/master/tensorflowlib</a></li><li id="695c" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><strong class="kd iu">为C文档安装tensor flow</strong>—<a class="ae kz" href="https://www.tensorflow.org/install/lang_c" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/install/lang_c</a></li><li id="47f9" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><strong class="kd iu">代码示例</strong>—<a class="ae kz" href="https://github.com/atkinsonbg/training-mlnet-using-google-colab-on-gpus" rel="noopener ugc nofollow" target="_blank">https://github . com/atkinsonbg/training-mlnet-using-Google-colab-on-GPU</a></li><li id="865c" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><strong class="kd iu"> YouTube演示文稿</strong>—<a class="ae kz" href="https://www.youtube.com/channel/UCyLZieUSKFGLBOibC7xB1zg/videos" rel="noopener ugc nofollow" target="_blank">https://www . YouTube . com/channel/ucylzieuskflboibc 7 XB 1 ZG/videos</a></li><li id="7b12" class="nv nw it kd b ke oe ki of km og kq oh ku oi ky oa ob oc od bi translated"><strong class="kd iu"> GitHub关于ExcludeAssets的问题</strong>—<a class="ae kz" href="https://github.com/dotnet/machinelearning/issues/871" rel="noopener ugc nofollow" target="_blank">https://github.com/dotnet/machinelearning/issues/871</a></li></ul></div></div>    
</body>
</html>