<html>
<head>
<title>How to Add a JSON Editor to a React + Next.js Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何向React + Next.js应用程序添加JSON编辑器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/simplest-way-to-add-json-editor-to-nextjs-application-6baa71b5b4dd?source=collection_archive---------8-----------------------#2020-02-25">https://levelup.gitconnected.com/simplest-way-to-add-json-editor-to-nextjs-application-6baa71b5b4dd?source=collection_archive---------8-----------------------#2020-02-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a4f8" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">反应</h2><div class=""/><p id="e971" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">向使用React和Next.js构建的服务器端呈现应用程序添加JSON编辑器的简单指南</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/b86d64b6f0bac59f5bdebb9fb1067ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpTz9zBSJmO9CKo-rhJrjg.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">由<a class="ae ln" href="https://unsplash.com/@heftiba?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Toa Heftiba </a>在<a class="ae ln" href="https://unsplash.com/s/photos/coffee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8bb1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在本文中，我将一步一步地指导您将JSON编辑器添加到应用程序的UI中。</p><ol class=""><li id="cd52" class="lo lp it kb b kc kd kg kh kk lq ko lr ks ls kw lt lu lv lw bi translated">介绍</li><li id="bf99" class="lo lp it kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">示范</li><li id="ce19" class="lo lp it kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">综合</li></ol><p id="153d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="mc">更多类似内容，请查看</em><a class="ae ln" href="https://betterfullstack.com" rel="noopener ugc nofollow" target="_blank"><em class="mc">https://betterfullstack.com</em></a></p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="6711" class="mk ml it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">介绍</h1><p id="35bb" class="pw-post-body-paragraph jz ka it kb b kc ni ke kf kg nj ki kj kk nk km kn ko nl kq kr ks nm ku kv kw im bi translated">最近，我添加了JSON编辑器来编辑JSON类型的数据，并将其发送到服务器以存储在数据库中。</p><p id="2607" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">应用程序使用的是React框架<a class="ae ln" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>。在本文中，我不会对这个框架进行更多的讨论。我将重点介绍如何向服务器端呈现应用程序添加JSON编辑器。</p><p id="6c6a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我使用了<a class="ae ln" href="https://github.com/json-editor/json-editor" rel="noopener ugc nofollow" target="_blank"> json-editor </a>库来构建一个json编辑器。这个库将帮助您格式化UI中的JSON数据，并允许用户对其进行修改。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="2bb0" class="mk ml it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">示范</h1><p id="5183" class="pw-post-body-paragraph jz ka it kb b kc ni ke kf kg nj ki kj kk nk km kn ko nl kq kr ks nm ku kv kw im bi translated">这是演示。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nn"><img src="../Images/cf2123ac0c5af9cedd2d7604ee23d1ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*50QK4ZKohrBNfeeQXlcp1Q.gif"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">演示加载JSON编辑器并将数据设置到编辑器中</figcaption></figure><p id="6f4b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在上面的演示中，我做了两件事:</p><ul class=""><li id="4662" class="lo lp it kb b kc kd kg kh kk lq ko lr ks ls kw no lu lv lw bi translated">在开始时加载JSON编辑器</li><li id="e7b3" class="lo lp it kb b kc lx kg ly kk lz ko ma ks mb kw no lu lv lw bi translated">当用户点击编辑按钮时，在JSON编辑器中设置数据</li></ul><p id="81e4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">下一条路径将更详细地介绍我是如何做到的。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="980c" class="mk ml it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">综合</h1><p id="818c" class="pw-post-body-paragraph jz ka it kb b kc ni ke kf kg nj ki kj kk nk km kn ko nl kq kr ks nm ku kv kw im bi translated">为了将它添加到Nextjs应用程序中，我们需要做3件事:</p><ol class=""><li id="c33a" class="lo lp it kb b kc kd kg kh kk lq ko lr ks ls kw lt lu lv lw bi translated">将CSS和JS添加到head</li><li id="4eed" class="lo lp it kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">添加HTML</li><li id="9cdf" class="lo lp it kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">添加JavaScript代码来初始化编辑器</li></ol><p id="d0cd" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">在头部添加CSS和JS</strong></p><p id="3b35" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">当npm使用以下命令安装时，可以选择从<code class="fe np nq nr ns b">node_modules</code>获取所有资源:</p><pre class="ky kz la lb gt nt ns nu nv aw nw bi"><span id="e103" class="nx ml it ns b gy ny nz l oa ob">npm install @json-editor/json-editor</span></pre><p id="aa7a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我没有遵循这个方法。我将<code class="fe np nq nr ns b">jsoneditor.min.js</code>和<code class="fe np nq nr ns b">jsoneditor.min.css</code>复制到Next.js中的<code class="fe np nq nr ns b">public</code>文件夹，这样可以更容易地从<strong class="kb jd"> head </strong>标签中获取资产。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/c1c73541dbb51952cbc7bb200c7400de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*lHwULZYjHDlodGoYdh4Mog.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">为jsoneditor添加样式和js</figcaption></figure><p id="b8ed" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">添加HTML </strong></p><p id="a61a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在我将按照库的<a class="ae ln" href="https://github.com/josdejong/jsoneditor" rel="noopener ugc nofollow" target="_blank">自述文件中的指导添加HTML。</a></p><pre class="ky kz la lb gt nt ns nu nv aw nw bi"><span id="9692" class="nx ml it ns b gy ny nz l oa ob">&lt;div id="jsoneditor" style="width: 400px; height: 400px;"&gt;&lt;/div&gt;</span></pre><p id="b4fd" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我仍然保留着<code class="fe np nq nr ns b">style</code>的属性在那里。我想快速完成这项工作，但如果你喜欢，你可以采用更优雅的造型方法。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi od"><img src="../Images/9c829147cadcff3e610242b0d09d723c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ricqtm0E2QbU2jQZL6fFMQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">添加html以加载json编辑器视图</figcaption></figure><p id="322a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">添加JavaScript代码来初始化编辑器</strong></p><p id="82cf" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">根据页面上的逻辑，此路径可能会有所不同。在我的例子中，为了加载编辑器，我在React中使用了<a class="ae ln" href="https://reactjs.org/docs/hooks-effect.html" rel="noopener ugc nofollow" target="_blank">效果挂钩</a>，这在16.8版本中可用。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oe"><img src="../Images/055e3d3f6b261e0acf327caa4aa7095a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-NRJMKiBSVSOXryKpX-lPg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">使用效果挂钩来加载JSON编辑器</figcaption></figure><p id="c17b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我必须使用Effect钩子的原因是确保钩子内的代码段将从客户端运行，因为<code class="fe np nq nr ns b">window is undefined</code>在服务器端。</p><p id="65a0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">对于上面的效果挂钩，我将第二个参数作为<code class="fe np nq nr ns b">[]</code>传递。我这样做是因为我只想让这个钩子只运行一次来创建JSON编辑器。</p><p id="277b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在<a class="ae ln" href="https://reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects" rel="noopener ugc nofollow" target="_blank">的React文档</a>中，他们说:</p><blockquote class="of og oh"><p id="0c5d" class="jz ka mc kb b kc kd ke kf kg kh ki kj oi kl km kn oj kp kq kr ok kt ku kv kw im bi translated">如果您想运行一个效果并只清理一次(在挂载和卸载时)，您可以传递一个空数组(<code class="fe np nq nr ns b">[]</code>)作为第二个参数。这告诉React你的效果不依赖于道具或状态的任何值，所以它不需要重新运行。这不是作为特例来处理的——它直接源于依赖关系数组的工作方式。</p></blockquote><p id="2212" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我在React上贴了这篇短文，因为我看到一些人在使用效果挂钩时犯了这个错误，这会降低你的应用程序的速度，并导致一些意想不到的错误。</p><p id="d712" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">有些人在StackOverflow中问道:</p><p id="c21f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><a class="ae ln" href="https://stackoverflow.com/questions/57859484/useeffect-runs-infinite-loop-despite-no-change-in-dependencies" rel="noopener ugc nofollow" target="_blank"> useEffect运行无限循环，尽管依赖关系没有变化</a></p><p id="b28b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><a class="ae ln" href="https://stackoverflow.com/questions/57023074/why-is-the-cleanup-function-from-useeffect-called-on-every-render" rel="noopener ugc nofollow" target="_blank">为什么每次渲染都调用“useEffect”中的清理函数？</a></p><p id="4b4a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">确保只运行一次<code class="fe np nq nr ns b">[]</code>，或者将一些特定的值从组件范围传递给第二个参数。这将只在值改变时触发钩子，避免钩子无限运行。</p><p id="6c4f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如何设置编辑器:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/b549c2579eb583636748f1bea6abd931.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*3lwe1pUhTultdjy4ebRlrA.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">将数据设置到JSON编辑器</figcaption></figure><p id="7994" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如何向服务器发送数据:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi om"><img src="../Images/085db20c95f6035dff0885490349f082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*o2LgqDlwLqxfRTtfqhTfOA.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">在JSON编辑器中获取数据</figcaption></figure><p id="959f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">你可以从<a class="ae ln" href="https://github.com/josdejong/jsoneditor/blob/master/docs/api.md" rel="noopener ugc nofollow" target="_blank">这里</a>阅读更多方法。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="2b63" class="mk ml it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">结论</h1><p id="e1d3" class="pw-post-body-paragraph jz ka it kb b kc ni ke kf kg nj ki kj kk nk km kn ko nl kq kr ks nm ku kv kw im bi translated">本文包含了向应用程序添加JSON编辑器所需的所有信息。这些结果可以转移到任何UI框架，比如Vuejs、Angular和React。</p><p id="5f9f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我希望这篇文章对你有用！你可以在<a class="ae ln" href="https://medium.com/@transonhoang?source=post_page---------------------------" rel="noopener">媒体</a>上关注我。我也在<a class="ae ln" href="https://twitter.com/transonhoang" rel="noopener ugc nofollow" target="_blank">推特</a>上。欢迎在下面的评论中留下任何问题。我很乐意帮忙！</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><div class="ky kz la lb gt on"><a href="https://betterfullstack.com/stories/" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd jd gy z fp os fr fs ot fu fw jc bi translated">故事-更好的全栈</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">关于JavaScript、Python和Wordpress的有用文章，有助于开发人员减少开发时间并提高…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">betterfullstack.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb lh on"/></div></div></a></div></div></div>    
</body>
</html>