<html>
<head>
<title>Microfrontend Module Federation: Exposing Remote from Legacy React Webpack4 Created by create-react-app</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微前端模块联合:公开由create-react-app创建的遗留React Webpack4的远程</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/microfrontends-module-federation-exposing-remote-from-legacy-react-webpack4-created-by-f3753d70d34e?source=collection_archive---------0-----------------------#2021-09-23">https://levelup.gitconnected.com/microfrontends-module-federation-exposing-remote-from-legacy-react-webpack4-created-by-f3753d70d34e?source=collection_archive---------0-----------------------#2021-09-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/843880507af6d6da324345c208dfa503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lVmdVaeUY1ybl5NXiSCQmg.gif"/></div></div></figure><p id="3d31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在用Webpack 5、React和Module Federation构建新的门户时，我想在Webpack 5上的create-react-app创建的遗留React组件中包含一个组件。在本文中，我将解释我是如何在一个用create-react-app制作的React-APP上成功做到这一点的</p><p id="256d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi">===================</p><h1 id="9f5d" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建新的react应用程序</h1><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="fcf2" class="md kx iq lz b gy me mf l mg mh">npx create-react-app new-react-app</span><span id="12cf" class="md kx iq lz b gy mi mf l mg mh">cd new-react-app</span><span id="ee56" class="md kx iq lz b gy mi mf l mg mh">mkdir module-federation</span><span id="ca57" class="md kx iq lz b gy mi mf l mg mh">code .</span><span id="1836" class="md kx iq lz b gy mi mf l mg mh">yarn start</span></pre><p id="a102" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你应该看看普通的CRA页面。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/e58e3f5afcdaa39c4e631c47a32bffc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*ZoLv3F1ceMDCZ5TvleupFw.png"/></div></figure><p id="dd42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们需要将这个页面导入到模块联合容器中</p><h1 id="b7a9" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">作为遥控器公开</h1><ol class=""><li id="56c0" class="mk ml iq ka b kb mm kf mn kj mo kn mp kr mq kv mr ms mt mu bi translated">请在new-react-app中创建一个新目录，并给它一个名字(我给它取了module-federation)</li></ol><p id="6c33" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.创建一个名为<code class="fe mv mw mx lz b">webpack.config.js</code>的文件</p><p id="05fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.创建一个src目录，并在其中创建一个空的index.js</p><p id="fba2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以将以下步骤复制到new-react-app目录中的终端</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="90c9" class="md kx iq lz b gy me mf l mg mh">mkdir module-federation</span><span id="36b5" class="md kx iq lz b gy mi mf l mg mh">cd module-federation</span><span id="c0f8" class="md kx iq lz b gy mi mf l mg mh">touch <!-- -->webpack.config.js</span><span id="886a" class="md kx iq lz b gy mi mf l mg mh">touch package.json</span><span id="e016" class="md kx iq lz b gy mi mf l mg mh">mkdir src</span><span id="672a" class="md kx iq lz b gy mi mf l mg mh">touch src/index.js</span><span id="71a6" class="md kx iq lz b gy mi mf l mg mh">yarn add webpack webpack-cli html-webpack-plugin babel-loader <a class="ae my" href="http://twitter.com/babel/plugin-transform-runtime" rel="noopener ugc nofollow" target="_blank">@babel/plugin-transform-runtime</a> style-loader css-loader sass-loader </span></pre><p id="58bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在module-Federation/web pack . config . js中添加以下内容(<a class="ae my" href="https://github.com/ranyelhousieny/microfrontend-template/blob/main/webpack.config.js" rel="noopener ugc nofollow" target="_blank">https://github . com/ranyelhousieny/micro frontend-template/blob/main/web pack . config . js</a></p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/3fe87a32204aada353274bfb965aef37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*El-cqUu_0dUZ_O77aiilPw.png"/></div></div></figure><p id="3e05" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请确保保存该文件。</p><p id="1e42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi">====</p><p id="67f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在module-federation/package.json中添加以下内容</p><p id="d8a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">(<a class="ae my" href="https://github.com/ranyelhousieny/microfrontend-template/blob/main/package.json" rel="noopener ugc nofollow" target="_blank">https://github . com/ranyelhousieny/micro frontend-template/blob/main/package . JSON</a>)</p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/65e62143719ee404df631b021dd56d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9qbMXUhIGNHK9aGpiAq3dA.png"/></div></div></figure><p id="d06c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请确保保存该文件。</p><p id="e387" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi">=======</p><p id="d20e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在安装依赖项。从模块内部联合运行<code class="fe mv mw mx lz b">yarn install</code></p><p id="6a0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">构建目录，从内部模块-联邦运行<code class="fe mv mw mx lz b">yarn webpack build</code></p><p id="0170" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在模块联邦内部创建一个包含少量文件的目录区</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2b7af9990d450797d6c2f1e481a8e347.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*6TzT--L4DK2WbBQ5jSP3qQ.png"/></div></figure><p id="7daa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只需要remoteEntry.js</p><p id="4d5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们通过跑步来服务这个遥控器。<code class="fe mv mw mx lz b">yarn webpack serve</code></p><p id="9184" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当您浏览到<a class="ae my" href="http://localhost:8001/remoteEntry.js" rel="noopener ugc nofollow" target="_blank">http://localhost:8001/remote entry . js</a>时，您应该能够看到该文件。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/b1e229cd72e974d409f8dfc3185c7836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jdvnIJfY440rnUyTEDr8-g.png"/></div></div></figure><p id="6bab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是您应该从微前端容器远程访问的文件。</p><p id="6add" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi">===================</p><h1 id="9716" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">将遥控器添加到Microfrontend容器。</h1><p id="9cec" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj nf kl km kn ng kp kq kr nh kt ku kv ij bi translated">现在，让我们将它添加到我们之前创建的微前端主机中。您可以从<a class="ae my" href="https://github.com/ranyelhousieny/react-microfrontends.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ranyelhousieny/react-microfrontends.git</a>处获得，如下所示:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9996" class="md kx iq lz b gy me mf l mg mh">git clone <a class="ae my" href="https://github.com/ranyelhousieny/react-microfrontends.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ranyelhousieny/react-microfrontends.git</a></span><span id="ff71" class="md kx iq lz b gy mi mf l mg mh">cd react-microfrontends</span><span id="4e2a" class="md kx iq lz b gy mi mf l mg mh">cd mfe2</span><span id="8d7e" class="md kx iq lz b gy mi mf l mg mh">yarn install</span><span id="3e38" class="md kx iq lz b gy mi mf l mg mh">code .</span><span id="5f74" class="md kx iq lz b gy mi mf l mg mh">yarn webpack serve</span></pre><p id="902f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您浏览到<a class="ae my" href="http://localhost:8082/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8082/ </a>，您应该会看到以下内容</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/b16dc061ab30e5759ef5106ab2f0867d.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*i6ZL0dknJQjWlsN_Vz7pVQ.png"/></div></figure><p id="89b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们将用我们在<a class="ae my" href="http://localhost:8001/remoteEntry.js" rel="noopener ugc nofollow" target="_blank">http://localhost:8001/remote entry . js</a>从CRA创建的遥控器替换MFE1</p><p id="8607" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在mfe2/webpack.config.js中替换远程到<a class="ae my" href="http://localhost:8001/remoteEntry.js" rel="noopener ugc nofollow" target="_blank">http://localhost:8001/remote entry . js</a>如下。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/75172a9325bd7b938364c9bac528995e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IK_Dxxtr6AlEXsrO5JT7CA.png"/></div></div></figure><p id="6558" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在mfe2/src/App.js中，将导入从MFE1/Button更改为MFE1/MFE1，如下所示:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/ab25c4311d5ea93fd8f890195c000636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTKg1JK2elFbunLAOSHXOw.png"/></div></div></figure><p id="a096" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是总体思路。我们仍然需要添加一些依赖项和共享组件来实现这一点，我将在以后的文章中讨论。</p></div></div>    
</body>
</html>