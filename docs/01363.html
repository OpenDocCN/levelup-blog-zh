<html>
<head>
<title>A Guide to Building a PWA in Angular 8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular 8中构建PWA的指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-guide-to-building-a-pwa-in-angular-acea27ae708d?source=collection_archive---------0-----------------------#2019-12-18">https://levelup.gitconnected.com/a-guide-to-building-a-pwa-in-angular-acea27ae708d?source=collection_archive---------0-----------------------#2019-12-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="23ed" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Angular创建渐进式web应用程序的分步教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c2518fe4763b95088e939e529b65bb73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*axVS65EUkXBlywkg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@freestocks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">freestocks.org</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="8da6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将使用最新的Angular 8创建一个PWA。我们将首先创建一个前端web应用程序，它将请求一个从<a class="ae ky" href="https://github.com/HugoGiraudel/SJSJ" rel="noopener ugc nofollow" target="_blank">简化Javascript行话</a>生成的JSON API。为了构建UI，我们将通过Angular材质包使用材质设计。</p><p id="9ffb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了根据PWA的核心原则分析我们的web应用程序，我们将在本教程的最后运行Chrome developer tools中的审计面板(Lighthouse)。</p><p id="8c49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们先来了解一下什么是PWA。</p><h1 id="e8b9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是PWA？</h1><p id="1944" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">progress Web Application(PWA)是一套使用现代浏览器功能的指南，旨在创建更像本地应用程序的用户体验。基本上，它仍然是一个网站，但它看起来和感觉上都像一个应用程序，并提供正常网站所不具备的功能。当用户在浏览器中访问您的网址上的PWA时，他们会得到一个提示，如果他们想“添加到主屏幕”，而不需要从应用商店下载和安装。当他们从主屏幕打开PWA时，没有浏览器UI控件，它显示为一个应用程序。</p><h1 id="f42c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">PWA的特点</h1><p id="397e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">以下是PWA的特点以及我们应该关注的原因。</p><p id="ed18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 1。渐进式</strong></p><p id="5b4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论用户选择什么样的浏览器，这款应用都应该适用，因为它是以渐进增强为核心原则构建的。</p><p id="db5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。反应灵敏</strong></p><p id="18a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该应用程序可以根据屏幕大小、平台和方向来响应用户的行为和环境。</p><p id="8509" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3。独立连接</strong></p><p id="2688" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当网络不可用或太慢时，应用程序应该仍然可以在设备上工作。</p><p id="17eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 4。类app</strong></p><p id="ffaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它看起来和感觉像一个应用程序，但不需要下载和安装。</p><p id="5204" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 5。新鲜的</strong></p><p id="4e86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务人员更新流程将始终保持应用程序最新。</p><p id="8734" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 6。安全</strong></p><p id="4969" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过HTTPS访问，以允许授权、安全交易，并防止未经授权的访问</p><p id="39d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 7。闪屏</strong></p><p id="574a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用程序启动时会添加闪屏。感觉更像是原生app。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="b3a9" class="lv lw it bd lx ly mz ma mb mc na me mf jz nb ka mh kc nc kd mj kf nd kg ml mm bi translated">安装Angular CLI并生成项目</h1><p id="92d4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本节中，我们将安装Angular CLI的最新版本，即当前稳定版本的版本8。对于Angular 8项目，建议使用最新的Node.js稳定版(即12.x.x)。</p><p id="be5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要检查节点版本，请输入以下命令:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="1261" class="nj lw it nf b gy nk nl l nm nn">node -v</span></pre><p id="fb72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，使用以下命令安装Angular CLI:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="15a8" class="nj lw it nf b gy nk nl l nm nn">npm i -g @angular/cli</span></pre><p id="fd09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要生成新的角度项目，只需运行以下命令:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="5211" class="nj lw it nf b gy nk nl l nm nn">ng new pwatest</span></pre><p id="93a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加角形材料只需要一个命令，命令如下:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="d045" class="nj lw it nf b gy nk nl l nm nn">cd pwatest<br/>ng add @angular/material</span></pre><p id="3d98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Angular Material安装过程中，我们可以选择预建主题或选择“自定义”来使用我们自己的自定义主题。在这里，我选择“深紫色/琥珀色”作为预建主题。</p><p id="e08e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，输入“Y”来设置HammerJS的手势识别和浏览器动画的角度材料。</p><h1 id="9b5c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置HttpClient和API服务</h1><p id="175b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将使用HttpClient发送HTTP请求。首先，我们需要在<code class="fe no np nq nf b">app.module.ts</code>文件中导入HttpClientModule。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="dfa9" class="nj lw it nf b gy nk nl l nm nn">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';</span><span id="8266" class="nj lw it nf b gy nr nl l nm nn">import { AppRoutingModule } from './app-routing.module';<br/>import { AppComponent } from './app.component';<br/>import { BrowserAnimationsModule } from '@angular/platform-browser/animations';<br/>import { HttpClientModule } from '@angular/common/http';</span><span id="6ecb" class="nj lw it nf b gy nr nl l nm nn">@NgModule({<br/>  declarations: [<br/>    AppComponent<br/>  ],</span><span id="04f4" class="nj lw it nf b gy nr nl l nm nn">  imports: [<br/>    BrowserModule,<br/>    AppRoutingModule,<br/>    BrowserAnimationsModule,<br/>    HttpClientModule<br/>  ],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</span></pre><p id="debd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本教程，我们将使用从<a class="ae ky" href="https://github.com/HugoGiraudel/SJSJ" rel="noopener ugc nofollow" target="_blank"> <em class="ns">简化JavaScript行话</em> GitHub库</a>中静态生成的<a class="ae ky" href="https://www.techiediaries.com/api/data.json" rel="noopener ugc nofollow" target="_blank"> JSON API </a>。如果您想要使用任何其他资源，请确保您启用了CORS，这样浏览器就不会因为<strong class="lb iu">同源策略</strong>而不允许读取远程资源。</p><p id="d745" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将创建一个与API交互的服务。在我们的项目根文件夹中，执行以下命令:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="ba01" class="nj lw it nf b gy nk nl l nm nn">ng g service services/api</span></pre><p id="e86d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe no np nq nf b">api.service.ts</code>并用以下更改更新文件。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="911c" class="nj lw it nf b gy nk nl l nm nn">import { Injectable } from '@angular/core';<br/>import { HttpClient } from '@angular/common/http';<br/>import { Observable } from 'rxjs';</span><span id="4cdc" class="nj lw it nf b gy nr nl l nm nn">export interface Item {<br/>  name: string;<br/>  description: string;<br/>  url: string;<br/>  html: string;<br/>  markdown: string;<br/>}</span><span id="5a4b" class="nj lw it nf b gy nr nl l nm nn">@Injectable({<br/>  providedIn: 'root'<br/>})</span><span id="8438" class="nj lw it nf b gy nr nl l nm nn">export class ApiService {<br/> private baseURL: string = "https://www.techiediaries.com/api/data.json";</span><span id="b544" class="nj lw it nf b gy nr nl l nm nn"> constructor(private httpClient: HttpClient) { }</span><span id="6207" class="nj lw it nf b gy nr nl l nm nn"> fetch(): Observable&lt;Item[]&gt; {<br/>   return &lt;Observable&lt;Item[]&gt;&gt;this.httpClient.get(this.baseURL);<br/> }<br/>}</span></pre><p id="f215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们声明了<code class="fe no np nq nf b">Item</code>接口，它表示返回的JSON数据的一个条目。然后我们创建了一个<code class="fe no np nq nf b">fetch()</code>方法，它将向声明的<code class="fe no np nq nf b">baseURL</code>变量中的JSON端点发送一个HTTP GET请求。</p><p id="8105" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，打开<code class="fe no np nq nf b">app.component.ts</code>并添加以下代码:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="5591" class="nj lw it nf b gy nk nl l nm nn">import { Component, OnInit } from '@angular/core';<br/>import { Item, ApiService } from './services/api.service';</span><span id="c6a6" class="nj lw it nf b gy nr nl l nm nn">@Component({<br/>  selector: 'app-root',<br/>  templateUrl: './app.component.html',<br/>  styleUrls: ['./app.component.scss']<br/>})</span><span id="eaf2" class="nj lw it nf b gy nr nl l nm nn">export class AppComponent implements OnInit{<br/>  title = 'firstpwa';<br/>  items: Array&lt;Item&gt;;</span><span id="481f" class="nj lw it nf b gy nr nl l nm nn">  constructor(private apiService: ApiService) {}</span><span id="6ab3" class="nj lw it nf b gy nr nl l nm nn">  ngOnInit() {<br/>    this.fetchData();<br/>  }</span><span id="28d0" class="nj lw it nf b gy nr nl l nm nn">  fetchData() {<br/>    this.apiService.fetch().subscribe(<br/>      (data: Array&lt;Item&gt;) =&gt; {<br/>         console.log(data);<br/>         this.items = data;<br/>      }, (err) =&gt; {<br/>        console.log(err);<br/>      }<br/>    );<br/>  }<br/>}</span></pre><h1 id="06a8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">添加用户界面</h1><p id="449e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对于我们的应用程序页面，我们将通过使用有角度的材料添加一个导航栏和页面的框架。</p><p id="1735" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要在我们的<code class="fe no np nq nf b">app.module.ts</code>中导入有角度的材质组件。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="ddae" class="nj lw it nf b gy nk nl l nm nn">/*...*/<br/>import { MatToolbarModule, MatCardModule, MatButtonModule } from  '@angular/material';</span><span id="7911" class="nj lw it nf b gy nr nl l nm nn">@NgModule({<br/>  declarations: [<br/>    AppComponent<br/>  ],<br/>  imports: [<br/>    /*...*/<br/>    MatToolbarModule,<br/>    MatCardModule,<br/>    MatButtonModule<br/>  ],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</span></pre><p id="70e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，打开<code class="fe no np nq nf b">app.component.html</code>，用下面的代码替换里面的内容。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="82f0" class="nj lw it nf b gy nk nl l nm nn">&lt;mat-toolbar color="primary"&gt;<br/>  &lt;mat-toolbar-row&gt;<br/>    &lt;span&gt;JS-jargon&lt;/span&gt;<br/>  &lt;/mat-toolbar-row&gt;<br/>&lt;/mat-toolbar&gt;</span><span id="03fb" class="nj lw it nf b gy nr nl l nm nn">&lt;main&gt;<br/>  &lt;mat-card *ngFor="let item of items"&gt;<br/>    &lt;mat-card-header&gt;<br/>     &lt;mat-card-title&gt;{{item.name}}&lt;/mat-card-title&gt;<br/>    &lt;/mat-card-header&gt;</span><span id="e9a3" class="nj lw it nf b gy nr nl l nm nn">    &lt;mat-card-content&gt;<br/>     {{item.description}}<br/>    &lt;/mat-card-content&gt;</span><span id="66ec" class="nj lw it nf b gy nr nl l nm nn">    &lt;mat-card-actions&gt;<br/>     &lt;a mat-raised-button href="{{item.url}}" color="primary"&gt;More&lt;/a&gt;<br/>    &lt;/mat-card-actions&gt;<br/>  &lt;/mat-card&gt;<br/>&lt;/main&gt;</span></pre><p id="9e4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是应用程序的屏幕截图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/2e300097acdcdedaaf36a6ae998cf507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PY7m5vtMVQ6B5FiN1K558A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">网络应用</figcaption></figure><h1 id="8fee" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">为生产构建应用程序</h1><p id="2d7e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了检查我们的应用程序的PWA特性，我们应该首先为生产构建它，因为大多数PWA特性在开发期间并不使用。例如，我们不希望在开发中启用服务工作者和缓存，因为我们需要定期更新文件。</p><p id="856e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用以下命令为生产构建应用程序。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="25b3" class="nj lw it nf b gy nk nl l nm nn">ng build --prod</span></pre><p id="688d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的生产构建将在文件夹<code class="fe no np nq nf b">dist/pwatest</code>中可用，我们可以使用<code class="fe no np nq nf b">http-server</code>来服务它。</p><p id="4fc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行下面的命令来安装http-server。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="0abe" class="nj lw it nf b gy nk nl l nm nn">npm i -g http-server</span></pre><p id="9d2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用以下命令运行http-server。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="92f7" class="nj lw it nf b gy nk nl l nm nn">cd dist/pwatest<br/>http-server -o</span></pre><p id="8777" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过<code class="fe no np nq nf b">-o</code>选项，您的浏览器将自动打开，并导航至<a class="ae ky" href="http://127.0.0.1:8080." rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">http://127 . 0 . 0 . 1:8080</strong></a>。</p><p id="476b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还没有添加任何PWA功能，所以在我们这样做之前，让我们看看Lighthouse的分析。</p><h1 id="eb22" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">分析应用程序</h1><p id="9035" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将使用<strong class="lb iu"> Lighthouse </strong>来分析我们的应用程序。Lighthouse是Google创建的一个开源审计工具，可用于审计网站和应用程序的可访问性性能、SEO、最佳实践和PWA功能。</p><p id="4c38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要访问Lighthouse，点击<code class="fe no np nq nf b">F12</code>或<code class="fe no np nq nf b">Ctrl</code> + <code class="fe no np nq nf b">Shift</code> + <code class="fe no np nq nf b">I</code>打开Chrome DevTools，点击<strong class="lb iu">审计</strong>标签。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/e5ec26baa8135b51d37b098d50f89b4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*ZxLc2XfaoV2jD5Iy6t3rFg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">来自Chrome DevTools的灯塔</figcaption></figure><p id="f7f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要将设备选项设置为<strong class="lb iu"> <em class="ns">移动</em> </strong>而不是桌面的<em class="ns">来模拟移动环境，并选中<strong class="lb iu"> <em class="ns">渐进式Web应用</em> </strong>复选框作为我们想要执行的审计类型。接下来，点击<strong class="lb iu"> <em class="ns">运行审计</em> </strong>按钮。</em></p><p id="cb8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是目前阶段的结果截图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/aa583ad63395a3b005a33ec94fb8518c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*fCBGVFq6BH1oFQzrjxIIiQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">第一份审计报告</figcaption></figure><p id="597a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的应用程序未能通过审核，主要与服务人员、渐进增强、HTTPS和Web应用清单有关，这些都是PWA的核心方面。</p><h1 id="9d26" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">实施PWA功能</h1><p id="9cb5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们可以通过运行以下命令将我们的应用程序转换成PWA。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="7ade" class="nj lw it nf b gy nk nl l nm nn">ng add @angular/pwa</span></pre><p id="b34a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">新增的PWA功能包括:</p><ol class=""><li id="3ee5" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ob oc od oe bi translated"><code class="fe no np nq nf b">manifest.json</code>文件。</li><li id="18cc" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">src/assets/icons文件夹中图标的大小不同。</li><li id="d2a2" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">服务人员— <code class="fe no np nq nf b"> ngsw-worker.js</code></li></ol><p id="3fe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务工作器是现代浏览器中的一个特性，可以用作网络代理，让你的应用程序拦截网络请求来缓存资产和数据。这可用于实现PWA功能，如离线支持、推送通知等。</p><p id="4f1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">两个失败的审核(“未注册服务工作者”和“离线时未响应200”)与<strong class="lb iu">服务工作者</strong>和缓存有关。</p><p id="aad6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要设置一个服务工作器，并使用它在本地缓存文件，以通过这些审核。离线时，服务人员应该返回文件的本地缓存版本。</p><p id="7400" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将为生产重新构建并重新运行Lighthouse，以检查本地托管的应用程序。</p><p id="422f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们新的审计报告。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/0e512487ef2c470a69455247bb96211f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*Z4OVmG9ofN1AU8-oAW4rqw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">第二份审计报告</figcaption></figure><p id="933e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只有两个失败的审计是与HTTPS和一个有效的苹果触摸图标。对于HTTPS，我们需要托管应用程序并配置<a class="ae ky" href="https://stackoverflow.com/questions/4083221/how-to-redirect-all-http-requests-to-https" rel="noopener ugc nofollow" target="_blank"> HTTP到HTTPS重定向</a>。</p><p id="5fed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了修复无效的苹果触摸图标，我们可以简单地在<code class="fe no np nq nf b">&lt;head&gt;</code>中的<strong class="lb iu">index.html</strong>中添加以下更改。我们需要指向一个不透明的192px(或180px)正方形PNG。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="f516" class="nj lw it nf b gy nk nl l nm nn">&lt;link rel="apple-touch-icon" href="assets/icons/icon-192x192.png"&gt;</span></pre><p id="e1e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重新运行审核，如果我们遵循上述所有步骤，我们将通过所有审核。</p><p id="28e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一部分:<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/pwa-add-button-to-home-screen-and-remote-debugging-in-android-devices-with-angular-8-3dbaec772a1?source=your_stories_page---------------------------"> PWA“主屏幕添加按钮”以及在带Angular 8的Android设备中的远程调试</a></p><h1 id="b4d4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="ad16" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们学习了如何构建Angular 8应用程序，并使用Angular CLI将其转换为PWA。</p><p id="936c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还使用Google的Lighthouse来审核我们的PWA特性应用程序。</p><p id="233f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你认为这篇文章是有帮助的，不要忘记与你的朋友分享。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="5c52" class="lv lw it bd lx ly mz ma mb mc na me mf jz nb ka mh kc nc kd mj kf nd kg ml mm bi translated">资源</h1><ol class=""><li id="4664" class="nw nx it lb b lc mn lf mo li ol lm om lq on lu ob oc od oe bi translated"><a class="ae ky" href="https://alligator.io/angular/angular-pwa/" rel="noopener ugc nofollow" target="_blank">https://alligator.io/angular/angular-pwa/</a></li><li id="858f" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><a class="ae ky" href="https://www.smashingmagazine.com/2018/09/pwa-angular-6/" rel="noopener ugc nofollow" target="_blank">https://www.smashingmagazine.com/2018/09/pwa-angular-6/</a></li><li id="4e8e" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><a class="ae ky" href="https://dev.to/ronakpatel70/creating-pwa-using-angular-7-step-by-step-guide-1mb3" rel="noopener ugc nofollow" target="_blank">https://dev . to/ronak Patel 70/creating-pwa-using-angular-7-step-by-step-guide-1mb 3</a></li></ol></div></div>    
</body>
</html>