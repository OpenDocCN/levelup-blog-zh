<html>
<head>
<title>Combining D3.js with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将D3.js与React结合使用</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/combining-d3-js-with-react-1c15c41429a6?source=collection_archive---------3-----------------------#2019-12-13">https://levelup.gitconnected.com/combining-d3-js-with-react-1c15c41429a6?source=collection_archive---------3-----------------------#2019-12-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/63a8a0f33809e440b4797fdbb5c8cea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*q15GeQtcsQ1_t3U9.jpg"/></div></div></figure><p id="1715" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">3.js代表数据驱动文档，它是一个很棒的库，有很多很棒的特性。D3.js是一个Javascript库，它利用SVGs与CSS和其他HTML标签的结合来帮助你创建漂亮的图形。从高层次来看，D3将您提供的数据合并到DOM元素中。有了它，您就可以操纵DOM，并以您的数据为基础在屏幕上执行转换。</p><h2 id="29b7" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">为什么要用D3？</h2><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="ab gu cl mc"><img src="../Images/759309c0605080844416f4af80c3a86f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*IEwZ5DJLCPmoHPieqTCsdg.png"/></div></figure><p id="c210" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有许多数据可视化库，你不应该只局限于一个。我相信D3是最好的数据可视化库之一，因为它非常健壮，具有许多内置特性，并为开发人员提供了许多工具来创建令人惊叹的图形和图表。</p><p id="d9f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从众多的数据可视化库中，D3客观上是最受欢迎的。GitHub 上有超过<a class="ae md" href="https://github.com/d3/d3" rel="noopener ugc nofollow" target="_blank"> 89k颗星星，是使用最广泛的库之一。正因为如此，这个库已经被审查了好几年，并被监控以尽可能地保持更新。</a></p><h2 id="8126" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">有什么问题？</h2><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/a6ad5ef7b76495edd4e430d9c988e4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y_XstQGcrOnrGp9I.jpg"/></div></div></figure><p id="48b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为图书馆年代久远，它是在反应时代诞生之前建造的。React是最流行和最强大的前端框架之一，将D3与React结合是一个自然的转变。不幸的是，将D3与React结合使用并不是一个无缝的组合。</p><p id="4b99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，网上没有明确的指导，让你一步一步地演练如何实现这两个。与其他流行的React库不同，如Bootstrap React，没有明确的例子说明如何实现在React之前构建的库，也没有任何好的指南。</p><p id="8cb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其次，由于对D3一无所知，这是一条陡峭的学习曲线。原始文档和大部分在线教程都是用普通的JavaScript编写的——因为D3是在React之前创建的。所以你不仅要学习如何使用D3，还要在React中实现它的时候重新学习。这给2019年学习web开发的人造成了一个自然令人沮丧的问题。</p><h2 id="0c9b" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">解决方法是什么？</h2><p id="11f9" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv ij bi translated">解决这个问题很简单，但不容易。</p><blockquote class="mk ml mm"><p id="0141" class="jy jz mn ka b kb kc kd ke kf kg kh ki mo kk kl km mp ko kp kq mq ks kt ku kv ij bi translated">Y <!-- -->你需要学习D3.js并学会使用它的内置函数。之后，您需要学习将结果插入React组件。</p></blockquote><p id="60eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正因为如此，你需要理解在D3的引擎盖下到底发生了什么。基本上D3所做的是为你创建DOM元素，并将你给它的数据附加到这些元素上。如果你想和React一起使用，这不是一个好主意。您实际上是将DOM的控制权交给了D3，并从React那里拿走了它。</p><p id="4454" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">相反，您想要做的是学习D3具有的健壮的内置函数，并使用React使用解析的数据创建前端。下面是一个非常简单的例子，展示了将D3.js与React结合起来的效果:</p><pre class="ly lz ma mb gt mr ms mt mu aw mv bi"><span id="a3a8" class="lf lg iq ms b gy mw mx l my mz">export default const Graph = props =&gt; {</span><span id="a076" class="lf lg iq ms b gy na mx l my mz">const xScale = d3<br/>    .scaleLinear()<br/>    .domain(d3.extent(data.dataset, d =&gt; d.x))<br/>    .range([data.margin, data.width])</span><span id="441c" class="lf lg iq ms b gy na mx l my mz">const yScale = d3<br/>    .scaleLinear()<br/>    .domain([0, d3.max(data.dataset, d =&gt; d.y)])<br/>    .range([data.height, data.margin])</span><span id="6e47" class="lf lg iq ms b gy na mx l my mz">const line = d3.line()<br/>    .x(d =&gt; xScale(d.x))<br/>    .y(d =&gt; yScale(d.y))<br/>    .curve(d3.curveCatmullRom.alpha(0.7))</span><span id="bdec" class="lf lg iq ms b gy na mx l my mz">return &lt;div&gt;<br/>      &lt;svg height={data.height} width={data.width}&gt;</span><span id="9103" class="lf lg iq ms b gy na mx l my mz">      &lt;line className="axis" x1={data.margin} x2={data.width} y1={data.height} y2={data.height}/&gt;</span><span id="44c5" class="lf lg iq ms b gy na mx l my mz">       &lt;line className="axis" x1={data.margin} x2={data.margin} y1={data.margin} y2={data.height}/&gt;</span><span id="035b" class="lf lg iq ms b gy na mx l my mz">        &lt;path d={click.clicked ? line(data.dataset) : 0}/&gt;</span><span id="f78e" class="lf lg iq ms b gy na mx l my mz">      &lt;/svg&gt;<br/>   &lt;/div&gt;<br/>}</span><span id="db5c" class="lf lg iq ms b gy na mx l my mz">const data = {<br/>  dataset: [<br/>    {x: 0, y: 0},<br/>    {x: 1, y: 1},<br/>    {x: 2, y: 1},<br/>    {x: 3, y: 2},<br/>    {x: 4, y: 3},<br/>    {x: 5, y: 5},<br/>    {x: 6, y: 8},<br/>    {x: 7, y: 13},<br/>    {x: 8, y: 21},<br/>    {x: 9, y: 34},<br/>    {x: 10, y: 55},<br/>  ],<br/>  width: 500,<br/>  height: 500,<br/>  margin: 20,<br/>}</span></pre><p id="55b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过组合<code class="fe nb nc nd ms b">xScale</code>、<code class="fe nb nc nd ms b">yScale</code>和<code class="fe nb nc nd ms b">line</code>中的D3.js函数，当您将数据输入到SVG元素<code class="fe nb nc nd ms b">svg, line and path</code>时，D3可以创建正确的数据格式。</p><h2 id="be47" class="lf lg iq bd lh li lj dn lk ll lm dp ln kj lo lp lq kn lr ls lt kr lu lv lw lx bi translated">结论</h2><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/b7b627630be87f5a171720e59becb061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iuH9FD60L7o0lJ6R.png"/></div></div></figure><p id="0888" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用D3.js可以让你看到它是多么的可定制。结合React的强大功能，您就拥有了一个强大的工具。</p></div></div>    
</body>
</html>