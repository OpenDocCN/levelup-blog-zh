<html>
<head>
<title>Is Python Spark Really 10x Slower Than Scala Spark?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Spark真的比Scala Spark慢10倍吗？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/is-python-spark-really-being-10x-slower-than-scala-spark-8a76c907adc8?source=collection_archive---------0-----------------------#2022-02-09">https://levelup.gitconnected.com/is-python-spark-really-being-10x-slower-than-scala-spark-8a76c907adc8?source=collection_archive---------0-----------------------#2022-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="da8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">字数统计用例的执行时间</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/d14f27cc1624d4e3ee0d8448519d7f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cn1inAsii2kOVOSlXjVVFw.png"/></div></div></figure><p id="36bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Apache Spark </strong>是最流行的大数据分析框架之一。Spark是用<strong class="jp ir"> Scala </strong>编写的，也可以用Scala 编写，但它也有用于<strong class="jp ir"> Python </strong>、<strong class="jp ir"> Java、</strong>和<strong class="jp ir"> R </strong>的API。</p><p id="8be4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Scala </strong>和<strong class="jp ir"> Python </strong>是最流行的API。关于<strong class="jp ir">Scala</strong>vs<strong class="jp ir">Python</strong>以及哪个更适合<strong class="jp ir"> Apache Spark </strong>一直有很多争论。对于Spark来说Python比Scala慢10倍吗？这篇博文对Python Spark和Scala Spark进行了测试，并将它们的性能(执行时间)与字数用例进行了比较。因此，在我们进一步讨论这个主题之前，让我们先来看看本文中将要使用的用例。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="fbeb" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">测试数据生成</h1><p id="019f" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">字数统计用例是大数据行业中的<code class="fe mh mi mj mk b">print("HELLO WORLD !")</code>，目标是获得给定文本文件中单词的频率。为了生成我们的测试文件，我们将使用<strong class="jp ir"> random_text.py </strong>脚本。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">随机文本脚本</figcaption></figure><p id="021f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以调整<code class="fe mh mi mj mk b">n</code>和<code class="fe mh mi mj mk b">p</code>来增加或减少生成文件的大小。在我们的测试中，我们将使用一个1.17GB的文件<strong class="jp ir">。</strong></p><h1 id="242d" class="le lf iq bd lg lh mr lj lk ll ms ln lo lp mt lr ls lt mu lv lw lx mv lz ma mb bi translated"><strong class="ak">执行环境</strong></h1><p id="c004" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">这些测试在同一台机器上执行:</p><ul class=""><li id="59f8" class="mw mx iq jp b jq jr ju jv jy my kc mz kg na kk nb nc nd ne bi translated">处理器i7</li><li id="22ef" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">32 GB内存</li><li id="7158" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">总共4个内核</li><li id="2ee0" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">总共8个线程</li><li id="c910" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">Python 3.10.2</li><li id="42df" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">Scala 2.12.8</li><li id="ee02" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">Java 8</li><li id="d465" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">火花3.0.3</li></ul><h1 id="c71c" class="le lf iq bd lg lh mr lj lk ll ms ln lo lp mt lr ls lt mu lv lw lx mv lz ma mb bi translated"><strong class="ak"> Python火花字数</strong></h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="70ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常简单的代码，我们读取一个文本文件。我们使用空格<code class="fe mh mi mj mk b">" "</code>作为分隔符来拆分每一行，我们将每个单词映射到一个元组(word，1)，1是该单词出现的次数，我们基于关键字减少所有单词，然后我们基于关键字进行排序。我们将结果保存在本地文件中。</p><p id="52d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以验证我们已经计算了唯一的单词，如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1a21f78ee04b4ee2a0e588963592d78d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*LpvIEG5_8GTpn3qD0OmTzA.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">十大常用词汇</figcaption></figure><p id="a340" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个程序的执行时间是<code class="fe mh mi mj mk b">274290 ms = 4 min 34 s</code></p><pre class="km kn ko kp gt nl mk nm nn aw no bi"><span id="6929" class="np lf iq mk b gy nq nr l ns nt">Elapsed Time in mili seconds:  274290</span></pre><h1 id="8887" class="le lf iq bd lg lh mr lj lk ll ms ln lo lp mt lr ls lt mu lv lw lx mv lz ma mb bi translated">Scala火花字数</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="35a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常类似于Python版本。我们有相同的结果。</p><p id="d591" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该程序的执行时间为<code class="fe mh mi mj mk b">89660 ms = 1 min 28 s</code></p><pre class="km kn ko kp gt nl mk nm nn aw no bi"><span id="22e4" class="np lf iq mk b gy nq nr l ns nt">Elapsed Time in mili seconds: 89660</span></pre><h1 id="99c6" class="le lf iq bd lg lh mr lj lk ll ms ln lo lp mt lr ls lt mu lv lw lx mv lz ma mb bi translated">结论</h1><p id="66de" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">在这些情况下，我们在Scala程序和Python程序之间有一个<code class="fe mh mi mj mk b">274290/89660 = 3.06</code>的分割比。Scala无疑提供了比Python更好的性能，但它并不总是快10倍，随着内核数量的增加，Scala的性能优势开始减弱。</p><p id="5c8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Spark选择Scala还是Python取决于最适合项目需求的特性，因为每种特性都有自己的优缺点。在选择用Apache Spark编程的语言之前，开发人员有必要学习Scala和Python来熟悉它们的特性。学习了Python和Scala之后，决定什么时候用Scala做Spark，什么时候用Python做Spark应该是很容易的。</p><p id="3aa9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望这些信息是有帮助的和有趣的，如果你有任何问题，或者你只是想打个招呼，我很乐意连接并回复你对我的博客的任何问题！欢迎访问我的<a class="ae nu" href="https://mohamedkhey.ml/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">网站</strong> </a> <strong class="jp ir">了解更多</strong>！</p></div></div>    
</body>
</html>