<html>
<head>
<title>Smart Text Listeners Using Flows on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android上使用流的智能文本监听器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/smart-text-listeners-using-flows-on-android-a37dd5444216?source=collection_archive---------7-----------------------#2020-11-29">https://levelup.gitconnected.com/smart-text-listeners-using-flows-on-android-a37dd5444216?source=collection_archive---------7-----------------------#2020-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/eb5d477d9af730617e9864cd22b873a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YJilDKNPy0JeDkd6bbTUxg.jpeg"/></div></figure><p id="8c7f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当您希望在编辑输入文本时触发一个网络请求时，您将最终为每个添加或删除的字母发出大量请求。(例如谷歌搜索)</p><p id="50ca" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要解决这个问题，您需要等待一段时间，直到用户输入完整个单词，从而减少请求的数量。例如，当用户输入“Et”…“Eter”…..“永恒”…..《永恒》。当用户键入整个单词“永恒”时，您智能地只想触发一个请求。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/91f7e3680a4e3b68e3e9c57e7de4205d.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/1*JlPsX6ag6mHp3IPvu0P0MQ.gif"/></div></figure><h1 id="0cce" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">设置视图模型</h1><p id="5805" class="pw-post-body-paragraph ju jv iq jw b jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ij bi translated">设置一个模拟函数，当一个查询文本被传递给它时，它需要1秒钟返回一个结果。把这个函数想象成一个网络请求。</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="dd5f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在设置一个<strong class="jw ir"> _searchQuery </strong>和一个setter函数<strong class="jw ir"> setSearchQuery() t </strong>来设置它的值。</p><p id="f611" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">将一个<em class="mc">de bouse()</em>操作符附加到<strong class="jw ir"> _searchQuery </strong>流。<em class="mc">de bouse(1000)</em>操作符将从原始的<strong class="jw ir"> _searchFlow </strong>中过滤出值，并且仅发出在发出后有1秒延迟的值。</p><p id="7645" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在在map latest中返回<em class="mc"> longNetworkOperation() </em>的结果。</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="ma mb l"/></div></figure><h1 id="a86a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">设置活动/视图</h1><p id="a6ce" class="pw-post-body-paragraph ju jv iq jw b jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ij bi translated">向EditText添加一个文本更改侦听器，并在文本更改时调用viewModel中的setSearchquery()。</p><p id="b383" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您还可以从我们之前在viewModel中定义的<em class="mc"> longNetworkOperation() </em>中收集流并打印结果。</p><figure class="kt ku kv kw gt jr"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="05fe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以在Github上找到整个项目以及更多使用流的用例。另一篇关于使用<a class="ae md" rel="noopener ugc nofollow" target="_blank" href="/using-flows-for-form-validation-in-android-79016b00c079">的类似文章在这里使用流表单验证</a>。</p><div class="me mf gp gr mg mh"><a href="https://github.com/Shivamdhuria/stateFlows" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">shivamdhuria/Stateflow</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">一个完全用Kotlin编写的Android应用程序，探索了流和协程在真实应用程序中的各种用法…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">github.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv js mh"/></div></div></a></div></div></div>    
</body>
</html>