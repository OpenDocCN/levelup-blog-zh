<html>
<head>
<title>Implementing â€œRedux-styleâ€ state management with Reactâ€™s useContext &amp; useReducer Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Reactçš„useContext &amp; useReduceré’©å­å®ç°â€œReduxé£æ ¼â€çš„çŠ¶æ€ç®¡ç†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/implementing-redux-style-state-management-with-reacts-usecontext-usereducer-hooks-c1c5596d9619?source=collection_archive---------1-----------------------#2019-01-27">https://levelup.gitconnected.com/implementing-redux-style-state-management-with-reacts-usecontext-usereducer-hooks-c1c5596d9619?source=collection_archive---------1-----------------------#2019-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/66ea292bf6e84040ff0c25e8fd49ff40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*bCr9TeAoPaIT5L5VheAvGQ.png"/></div></figure><p id="615b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">å¯¹äºé‚£äº›è¿˜ä¸çŸ¥é“çš„äººï¼ŒReactå›¢é˜Ÿæœ€è¿‘<a class="ae ks" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">å¼•å…¥äº†é’©å­</a>ä½œä¸ºä¸€ç§é‡‡ç”¨æ›´åŠŸèƒ½åŒ–çš„æ–¹æ³•æ¥ç¼–å†™ç»„ä»¶çš„æ–¹å¼ï¼Œå®ƒä»¬å·²ç»åœ¨v 16 . 8 . 0-alpha 1ä¸­å­˜åœ¨äº†å‡ ä¸ªæœˆã€‚ä¸è¿‡ï¼Œä»–ä»¬ç°åœ¨å·²ç»å¾—åˆ°äº†<a class="ae ks" href="https://github.com/facebook/react/pull/14679" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">å’Œ</strong> </a>çš„æ­£å¼æ‰¹å‡†ï¼Œå°†ä¼šåŒ…å«åœ¨Reactå³å°†æ¨å‡ºçš„ç‰ˆæœ¬ä¸­ğŸ‰</p><p id="d199" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">(å¦‚æœæœ‰ä¸€ä¸ªè§†é¢‘æ˜¯ä½ <em class="kt">æœ‰</em>å¯ä»¥çœ‹çš„ï¼Œé‚£å°±æ˜¯è¿™ä¸ª<a class="ae ks" href="https://www.youtube.com/watch?v=dpw9EHDh2bM&amp;feature=youtu.be" rel="noopener ugc nofollow" target="_blank">ä¸€ä¸ª</a>)</p><p id="09ad" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">å…³äºé’©å­å°†å¦‚ä½•å½±å“Reactç”Ÿæ€ç³»ç»Ÿæœ‰å¾ˆå¤šè§‚ç‚¹ï¼Œç‰¹åˆ«æ˜¯å…³äºæˆ‘ä»¬åœ¨Reactåº”ç”¨ç¨‹åºä¸­ç®¡ç†çŠ¶æ€çš„æ–¹å¼ã€‚å¦‚æœä½ å¯¹Reactæœ€è¿‘çš„æ´»åŠ¨æœ‰æ‰€äº†è§£ï¼Œæˆ‘æ•¢è‚¯å®šä½ å·²ç»çœ‹åˆ°äº†ä¸€ç¯‡åä¸ºâ€œ<em class="kt">é’©å­æ˜¯å†—ä½™æ€æ‰‹å—ï¼Ÿï¼Ÿï¼Ÿ</em>â€æˆ–å¤§æ„å¦‚æ­¤çš„è¯ã€‚æˆ‘çš„çœ‹æ³•ï¼Œä¸æ˜¯ã€‚</p><p id="4488" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Reduxè‚¯å®šæœ‰å®ƒçš„å­¦ä¹ æ›²çº¿ï¼Œåœ¨ä¸çœŸæ­£éœ€è¦å®ƒçš„å°è§„æ¨¡åº”ç”¨ç¨‹åºä¸­å¾ˆéš¾ç†è§£å®ƒçš„ç¥å¥‡ä¹‹å¤„ã€‚æœ‰å¾ˆå¤šæ ·æ¿æ–‡ä»¶å’Œæˆ‘æƒ³ç§°ä¹‹ä¸ºâ€œä»ªå¼åŒ–â€çš„ä»£ç ï¼Œä½ å¿…é¡»ç¼–å†™è¿™äº›ä»£ç æ¥ç”¨Reduxè®¾ç½®å¥½ä¸€åˆ‡ï¼Œä½†æ˜¯ä¸€æ—¦å®ƒè¢«æ­£ç¡®åœ°é…ç½®ï¼Œå®ƒæ˜¯éå¸¸æƒŠäººçš„ã€‚å›´ç»•Reduxçš„å·¥å…·ï¼Œå°¤å…¶æ˜¯å®ƒçš„<a class="ae ks" href="https://www.npmjs.com/package/redux-devtools-extension" rel="noopener ugc nofollow" target="_blank">å¼€å‘è€…å·¥å…·</a>ï¼Œä¹Ÿæ˜¯éå¸¸å‡ºè‰²çš„ï¼Œåœ¨Reduxå®ç°ä¹‹åï¼Œè°ƒè¯•Reactåº”ç”¨ç¨‹åºä¼šå˜å¾—æ›´åŠ å®¹æ˜“ã€‚ç„¶è€Œï¼Œå¯¹äºå¯èƒ½æ— æ³•ä¿è¯Reduxçš„å°å‹åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨æ›¿ä»£æ–¹æ³•(å°±åƒæˆ‘ä¸‹é¢å°†è¦æè¿°çš„)ã€‚</p><p id="2396" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">é€šè¿‡ä»æˆ‘åœ¨æ•™ç¨‹å’Œå…³äºé’©å­çš„æ¼”ç»ƒä¸­çœ‹åˆ°çš„æ–¹æ³•ä¸­æŒ‘é€‰å’Œæå–ï¼Œæˆ‘å·²ç»ç²¾å¿ƒåˆ¶ä½œäº†ä¸€ç§æ–¹æ³•æ¥åº”ç”¨æˆ‘ä»¬åœ¨Reduxä¸­çœ‹åˆ°ä½¿ç”¨çš„çŠ¶æ€ç®¡ç†é£æ ¼ï¼Œä½†æ˜¯åªä½¿ç”¨äº†<em class="kt">å’Œ</em> Reactã€‚å®Œå…¨é€æ˜ï¼Œæˆ‘åœ¨å…¶ä¸­ä½¿ç”¨è¯¥ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºè§„æ¨¡ç›¸å¯¹è¾ƒå°ï¼Œæˆ‘è®¤ä¸ºæœ‰è®¸å¤šå¼€å‘äººå‘˜çš„å¤§å‹åº”ç”¨ç¨‹åºè‚¯å®šä¼šä»ä½¿ç”¨Reduxä¸­å—ç›Šæ›´å¤šã€‚</p><p id="3de3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">è¯¥ç³»ç»Ÿåˆ©ç”¨<code class="fe ku kv kw kx b"><a class="ae ks" href="https://www.npmjs.com/package/redux-devtools-extension" rel="noopener ugc nofollow" target="_blank">useContext</a></code>å’Œ<code class="fe ku kv kw kx b"><a class="ae ks" href="https://reactjs.org/docs/hooks-reference.html#usereducer" rel="noopener ugc nofollow" target="_blank">useReducer</a></code>æŒ‚é’©ã€‚å‰è€…ï¼Œå¦‚Reactæ–‡æ¡£ä¸­æ‰€è¿°ï¼Œâ€œ<em class="kt">æ¥å—ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡(ä»</em> <code class="fe ku kv kw kx b"><em class="kt">React.createContext</em></code> <em class="kt">è¿”å›çš„å€¼)å¹¶è¿”å›å½“å‰ä¸Šä¸‹æ–‡å€¼ï¼Œè¯¥å€¼ç”±ç»™å®šä¸Šä¸‹æ–‡</em>çš„æœ€è¿‘ä¸Šä¸‹æ–‡æä¾›è€…ç»™å‡ºâ€ï¼Œè€Œåè€…â€œ<em class="kt">æ¥å—ä¸€ä¸ªç±»å‹ä¸º</em> <code class="fe ku kv kw kx b"><em class="kt">(state, action) =&gt; newState</em></code> <em class="kt">çš„ç¼©å‡å™¨ï¼Œå¹¶è¿”å›ä¸ä¸€ä¸ª</em> <code class="fe ku kv kw kx b"><em class="kt">dispatch</em></code> <em class="kt">æ–¹æ³•é…å¯¹çš„å½“å‰çŠ¶æ€ã€‚(å¦‚æœä½ ç†Ÿæ‚‰Reduxï¼Œä½ å·²ç»çŸ¥é“è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚).</em>â€</p><p id="3466" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘çš„è¿™äº›é¡¹ç›®çš„æ–‡ä»¶ç»“æ„å¦‚ä¸‹æ‰€ç¤º:</p><pre class="ky kz la lb gt lc kx ld le aw lf bi"><span id="b49b" class="lg lh iq kx b gy li lj l lk ll">&gt; public<br/>&gt; src<br/> - components/<br/> - state/<br/>   - actions/<br/>   - reducers/<br/>   - context/<br/>   - constants.js<br/> - hooks/</span></pre><p id="f6c9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">åœ¨<code class="fe ku kv kw kx b">context/index.js</code>ä¸­ï¼Œæˆ‘ä½¿ç”¨<code class="fe ku kv kw kx b">React.createContext</code>åˆ›å»ºäº†ä¸€ä¸ªä¸Šä¸‹æ–‡å®ä¾‹:</p><pre class="ky kz la lb gt lc kx ld le aw lf bi"><span id="8de4" class="lg lh iq kx b gy li lj l lk ll">import { createContext } from "react";</span><span id="c009" class="lg lh iq kx b gy lm lj l lk ll">const UserContext = createContext({<br/>  currentUser: localStorage.getItem("authenticated-user")<br/>  ? JSON.parse(localStorage.getItem("authenticated-user"))<br/>  : {}<br/> });</span><span id="2230" class="lg lh iq kx b gy lm lj l lk ll">export default UserContext;</span></pre><p id="9e59" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ç„¶åï¼Œåœ¨<code class="fe ku kv kw kx b">App.js</code>ä¸­ï¼Œæˆ‘å®šä¹‰äº†æˆ‘çš„<code class="fe ku kv kw kx b">initialState</code>ï¼Œåœ¨å…¶ä¸­å­˜å‚¨äº†<code class="fe ku kv kw kx b">useContext</code>é’©å­çš„è¿”å›å€¼:</p><pre class="ky kz la lb gt lc kx ld le aw lf bi"><span id="02c7" class="lg lh iq kx b gy li lj l lk ll">const App = () =&gt; {<br/>const initialState = useContext(UserContext);<br/>const [{ currentUser }, dispatch] = useReducer(<br/>UserReducer,<br/>initialState<br/>);</span><span id="e36c" class="lg lh iq kx b gy lm lj l lk ll">return (<br/>&lt;UserContext.Provider <em class="kt">value</em>={{ currentUser, dispatch }}&gt;<br/>  &lt;Nav /&gt;<br/>  &lt;Router&gt;<br/>    &lt;Login <em class="kt">path</em>="/" /&gt;<br/>    &lt;Register <em class="kt">path</em>="/register" /&gt;<br/>    &lt;Dashboard <em class="kt">path</em>="/user/:id" /&gt;<br/>  &lt;/Router&gt;<br/>&lt;/UserContext.Provider&gt;<br/>)};</span></pre><p id="9766" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">è¯·æ³¨æ„ï¼Œåœ¨æˆ‘çš„<code class="fe ku kv kw kx b">App</code>ç»„ä»¶çš„é¡¶éƒ¨ï¼Œæˆ‘ä»ä»<code class="fe ku kv kw kx b">useReducer</code>çš„è¿”å›å€¼ä¸­è§£æ„çš„çŠ¶æ€ä¸­è§£æ„äº†<code class="fe ku kv kw kx b">currentUser</code>(~<em class="kt">è§£æ„å¯å§‹</em> ~)ã€‚ç„¶åï¼Œæˆ‘å°†ä»<code class="fe ku kv kw kx b">useReducer</code>æ¥æ”¶åˆ°çš„<code class="fe ku kv kw kx b">currentUser</code>å’Œ<code class="fe ku kv kw kx b">dispatch</code>å‡½æ•°(æˆ‘ä»¬å°†åœ¨ä¸€åˆ†é’Ÿåè®¨è®º)ä¼ é€’ç»™ä¸Šä¸‹æ–‡æä¾›è€…ï¼Œä½¿å…¶å¯ç”¨äºæˆ‘çš„åº”ç”¨ç¨‹åºä¸­çš„æ¯ä¸ªç»„ä»¶ã€‚å¯¹äºä¸ç†Ÿæ‚‰è§£æ„çš„äººï¼ŒåŒæ ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®Œæˆ:</p><pre class="ky kz la lb gt lc kx ld le aw lf bi"><span id="bfa2" class="lg lh iq kx b gy li lj l lk ll">const [state, dispatch] = useReducer(UserReducer, initialState)<br/>...<br/>&lt;UserContext.Provider value={{ currentUser: state.currentUser, dispatch }}</span></pre><p id="6f92" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘åœ¨<code class="fe ku kv kw kx b">reducer/index.js</code>ä¸­çš„å‡é€Ÿå™¨:</p><pre class="ky kz la lb gt lc kx ld le aw lf bi"><span id="a78e" class="lg lh iq kx b gy li lj l lk ll">import { REGISTER_USER, LOGIN_USER, LOGOUT_USER } from "./constants";</span><span id="415c" class="lg lh iq kx b gy lm lj l lk ll">const initialState = {<br/>  currentUser: localStorage.getItem("authenticated-user")<br/>  ? JSON.parse(localStorage.getItem("authenticated-user"))<br/>  : {},<br/>  errorMessage: ""<br/>};</span><span id="131a" class="lg lh iq kx b gy lm lj l lk ll">const UserReducer = (state = initialState,<br/>{ type, registeredUser, loggedInUser, success, message, boards }<br/>) =&gt; {</span><span id="75f3" class="lg lh iq kx b gy lm lj l lk ll">switch (type) {<br/>  case REGISTER_USER:<br/>    console.log(<br/>     `%c {type: REGISTER_USER, registeredUser: ${JSON.stringify(<br/>       registeredUser )}}`, "color: yellow; font-weight: bold");</span><span id="0012" class="lg lh iq kx b gy lm lj l lk ll">return success ? { ...state, newUser: true }<br/> : { ...state, errorMessage: message };<br/>  <br/>  case LOGIN_USER:<br/>    console.log(`%c {type: LOGIN_USER, loggedInUser:<br/>      ${JSON.stringify(loggedInUser)}}`, "color: teal; font-weight:<br/>       bold");</span><span id="b457" class="lg lh iq kx b gy lm lj l lk ll"> return success ? { ...state, currentUser: loggedInUser }<br/>  : { ...state, errorMessage: message } </span><span id="f591" class="lg lh iq kx b gy lm lj l lk ll">case LOGOUT_USER:<br/>  console.log(<br/>    `%c {type: LOGOUT_USER, currentUser: {}} `,<br/>      "color: pink; font-weight: bold" );</span><span id="12e9" class="lg lh iq kx b gy lm lj l lk ll">return { ...state, currentUser: {} };</span><span id="a8f4" class="lg lh iq kx b gy lm lj l lk ll">default:<br/>  return state;<br/>}<br/>};</span><span id="de17" class="lg lh iq kx b gy lm lj l lk ll">export default UserReducer;</span></pre><p id="7746" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æœ‰å‡ ä»¶äº‹éœ€è¦æ³¨æ„â€¦é¦–å…ˆï¼Œä¸ºä»€ä¹ˆæˆ‘åœ¨æ–‡ä»¶é¡¶éƒ¨å®šä¹‰æˆ‘çš„<code class="fe ku kv kw kx b">initialState</code>æ—¶è¦é‡å¤ä»£ç ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½åƒä»¥å‰ä¸€æ ·ç»™<code class="fe ku kv kw kx b">initialState</code>èµ‹å€¼<code class="fe ku kv kw kx b">useContext(UserContext)</code>çš„è¿”å›å€¼ï¼Œæˆ–è€…ä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½åœ¨åˆ«å¤„å®šä¹‰å®ƒï¼Œå¯¼å‡ºå®ƒï¼Œç„¶åå¯¼å…¥åˆ°æˆ‘çš„reduceræ–‡ä»¶ä¸­ï¼Ÿå…³äºè°ƒç”¨é’©å­çš„ä¸€ä¸ªé‡è¦è­¦å‘Š(æ¥è‡ªReactæ–‡æ¡£):"<strong class="jw ir"> <em class="kt">ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨é’©å­ã€‚ç›¸åï¼Œæ€»æ˜¯åœ¨Reactå‡½æ•°çš„é¡¶å±‚ä½¿ç”¨é’©å­ã€‚é€šè¿‡éµå¾ªè¿™æ¡è§„åˆ™ï¼Œæ‚¨å¯ä»¥ç¡®ä¿æ¯æ¬¡ç»„ä»¶å‘ˆç°æ—¶éƒ½ä»¥ç›¸åŒçš„é¡ºåºè°ƒç”¨é’©å­ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆReactèƒ½å¤Ÿæ­£ç¡®ä¿å­˜å¤šä¸ª</em> <code class="fe ku kv kw kx b"><em class="kt">useState</em></code> <em class="kt">å’Œ</em> <code class="fe ku kv kw kx b"><em class="kt">useEffect</em></code> <em class="kt">è°ƒç”¨ä¹‹é—´çš„é’©å­çŠ¶æ€ã€‚</em>â€æ¢å¥è¯è¯´ï¼Œä½ åªèƒ½åœ¨<em class="kt"> React </em>å‡½æ•°çš„é¡¶å±‚è°ƒç”¨ä¸€ä¸ªé’©å­ï¼Œè€Œä¸æ˜¯æ™®é€šçš„JavaScriptå‡½æ•°ã€‚</strong></p><p id="7952" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">è¿˜æœ‰ï¼Œè¿™ä¸ªconsole.logåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿå¥½å§ï¼Œå¦‚æœä½ æ›¾ç»ä½¿ç”¨è¿‡<a class="ae ks" href="https://www.npmjs.com/package/redux-logger" rel="noopener ugc nofollow" target="_blank"> redux-logger </a>ä¸­é—´ä»¶ï¼Œè¿™æ˜¯æˆ‘æ¨¡ä»¿è¯¥åŠŸèƒ½çš„å»‰ä»·å°è¯•ï¼Œè®©æˆ‘çŸ¥é“æ¯ä¸ªç¼©å‡å™¨ä½•æ—¶è¢«è°ƒç”¨ã€‚</p><p id="6921" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">å¦‚æœä½ è¿˜ä¸çŸ¥é“ï¼Œæˆ‘æ˜¯ä¸€ä¸ªè§£æ„ä¸»ä¹‰çš„è¶…çº§ç²‰ä¸ï¼Œæˆ‘å·²ç»åœ¨æˆ‘çš„reducerå‡½æ•°çš„å‚æ•°ä¸­è§£æ„äº†æˆ‘çš„â€œæœ‰æ•ˆè½½è·â€(å¦‚æœä½ ç†Ÿæ‚‰Reduxçš„è¯)ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæ€»çš„æ¥è¯´ï¼Œè¿™éµå¾ªäº†ä¸Redux reduceréå¸¸ç›¸ä¼¼çš„ç»“æ„â€”â€”ä¸»è¦æ˜¯å› ä¸ºå®ƒåªæ˜¯æ™®é€šçš„JavaScriptã€‚</p><p id="795c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ä¸‹é¢æ˜¯æˆ‘åœ¨<code class="fe ku kv kw kx b">actions/index.js</code>ä¸­çš„ä¸€ä¸ªåŠ¨ä½œ:</p><pre class="ky kz la lb gt lc kx ld le aw lf bi"><span id="07ce" class="lg lh iq kx b gy li lj l lk ll"><em class="kt">//user registration<br/></em>export const registerUser = async (user, dispatch) =&gt; {<br/>  const { username, email, password } = user;</span><span id="3754" class="lg lh iq kx b gy lm lj l lk ll">try {<br/> const registerRes = await fetch("/user/register", { method: "POST",<br/>  mode: "cors", cache: "no-cache", headers: { "Content-Type":<br/>  "application/json"<br/> },<br/> redirect: "follow", referrer: "no-referrer", body: JSON.stringify({<br/>   username, email, password })<br/> });</span><span id="9ac7" class="lg lh iq kx b gy lm lj l lk ll">const { token, success, user: registeredUser } = await <br/> registerRes.json();</span><span id="0954" class="lg lh iq kx b gy lm lj l lk ll">if (success) {<br/>  dispatch({ type: REGISTER_USER, registeredUser, success });<br/>   console.log(`${user.username}'s account was REGISTERED and set in <br/>   localstorage`);</span><span id="6109" class="lg lh iq kx b gy lm lj l lk ll">return localStorage.setItem( "authenticated-user", JSON.stringify({<br/>  token, username: registeredUser.username, id: registeredUser._id<br/> })<br/>);<br/>}</span><span id="4e6d" class="lg lh iq kx b gy lm lj l lk ll">} catch (error) {<br/>  console.error(error);<br/>  return dispatch({ type: ERROR, message: error.message });<br/> }<br/>};</span></pre><p id="1ddd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">å¦‚æœä½ æ›¾ç»ä½¿ç”¨è¿‡redux-thunksï¼Œé‚£åŸºæœ¬ä¸Šæ˜¯æˆ‘çš„æ¯ä¸ªåŠ¨ä½œåˆ›å»ºè€…çš„å½¢å¼ã€‚æ³¨æ„æˆ‘æ˜¯å¦‚ä½•æ¥å—<code class="fe ku kv kw kx b">dispatch</code>å‡½æ•°ä½œä¸ºå‚æ•°çš„ï¼Œå®ƒä»è°ƒç”¨å®ƒçš„ç»„ä»¶ä¼ é€’ç»™åŠ¨ä½œã€‚</p><p id="7726" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">é‚£ä¹ˆï¼Œä½ åˆ°åº•æ˜¯æ€ä¹ˆåˆ©ç”¨è¿™äº›çš„å‘¢ï¼Ÿå—¯ï¼Œä¸‹é¢æ˜¯æˆ‘å¦‚ä½•åœ¨æˆ‘çš„<code class="fe ku kv kw kx b">components/Register.js</code>ä¸­ä½¿ç”¨å®ƒ(åˆ©ç”¨ä¸Šé¢å®šä¹‰çš„åŠ¨ä½œåˆ›å»ºå™¨):</p><pre class="ky kz la lb gt lc kx ld le aw lf bi"><span id="589c" class="lg lh iq kx b gy li lj l lk ll">import React, { useState } from "react";<br/>import { navigate } from "@reach/router";<br/>import { registerUser } from "../state/actions/user_actions";<br/>import { useContext } from "react";<br/>import UserContext from "../state/context";</span><span id="fa3c" class="lg lh iq kx b gy lm lj l lk ll">const initialFormState = {<br/>  username: "",<br/>  email: "",<br/>  password: "",<br/>  organization: ""<br/>};</span><span id="de78" class="lg lh iq kx b gy lm lj l lk ll">const Register = () =&gt; {<br/>  const [user, setUser] = useState(initialRegisterFormState);<br/>  const { dispatch } = useContext(UserContext);</span><span id="4f58" class="lg lh iq kx b gy lm lj l lk ll">  const handleInput = e =&gt; {<br/>    setUser({ ...user, [e.target.name]: e.target.value });<br/>  };</span><span id="52fa" class="lg lh iq kx b gy lm lj l lk ll">  const handleSubmit = e =&gt; {<br/>    e.preventDefault();<br/>    setUser(initialFormState);<br/>    registerUser(user, dispatch);<br/>    navigate("/");<br/> };</span><span id="7723" class="lg lh iq kx b gy lm lj l lk ll">...</span></pre><p id="e6cb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘èƒ½å¤Ÿä»<code class="fe ku kv kw kx b">useContext</code>é’©å­çš„è¿”å›å€¼ä¸­è§£æ„æˆ‘çš„<code class="fe ku kv kw kx b">dispatch</code>å‡½æ•°ï¼Œç„¶åå°†å®ƒä¼ é€’ç»™æˆ‘çš„<code class="fe ku kv kw kx b">registerUser</code>åŠ¨ä½œã€‚å¾ˆç®€å•ã€‚æ³¨æ„æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨<code class="fe ku kv kw kx b"><a class="ae ks" href="https://reactjs.org/docs/hooks-state.html" rel="noopener ugc nofollow" target="_blank">useState</a></code>é’©å­æ¥ç®¡ç†ç»„ä»¶çš„æœ¬åœ°çŠ¶æ€çš„ã€‚</p><p id="dc7d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ä¹Ÿå°±è¿™æ ·äº†ï¼é™¤äº†Reactï¼Œä¸éœ€è¦å…¶ä»–ä¾èµ–ã€‚æé†’ä¸€ä¸‹ï¼Œè¿™æ˜¯æˆ‘ä¸€ç›´åœ¨ç©çš„ä¸€ä¸ªç³»ç»Ÿï¼Œæˆ‘è‡ªå·±ä¹Ÿè¿˜åœ¨å­¦ä¹ å¦‚ä½•ä½¿ç”¨é’©å­ï¼Œå°¤å…¶æ˜¯åœ¨ç®¡ç†çŠ¶æ€çš„æ—¶å€™ã€‚æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œå½“æ¶‰åŠåˆ°å¤§è§„æ¨¡åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä¼šè¯´Reduxå¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯æˆ‘é¼“åŠ±æ‚¨æ¢ç´¢é’©å­çš„ä¸–ç•Œï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•å…è®¸æ‚¨ä»¥å¤šç§æ–¹å¼ç®¡ç†åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼</p><p id="d129" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ„Ÿè°¢æ‚¨çš„å€¾å¬ã€‚</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><figure class="ky kz la lb gt jr gh gi paragraph-image"><a href="https://levelup.gitconnected.com"><div class="gh gi lu"><img src="../Images/9914c5dd23ac08b70eea6f4f9ba6fed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E6CoI_MRyZ1JInNPsBSHtA.png"/></div></a></figure><div class="lv lw gp gr lx ly"><a href="https://gitconnected.com/learn/react" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">å­¦ä¹ React -æœ€ä½³Reactæ•™ç¨‹(2019) | gitconnected</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">æ’åå‰49çš„Reactæ•™ç¨‹-å…è´¹å­¦ä¹ Reactã€‚è¯¾ç¨‹ç”±å¼€å‘äººå‘˜æäº¤å¹¶æŠ•ç¥¨ï¼Œä½¿æ‚¨èƒ½å¤Ÿâ€¦</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">gitconnected.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm js ly"/></div></div></a></div></div></div>    
</body>
</html>