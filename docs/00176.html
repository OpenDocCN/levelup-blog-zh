<html>
<head>
<title>🏞 How to Send Image with Dialogflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">🏞如何用Dialogflow发送图像</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-send-image-via-dialogflow-f74c7dc72a8e?source=collection_archive---------0-----------------------#2018-07-23">https://levelup.gitconnected.com/how-to-send-image-via-dialogflow-f74c7dc72a8e?source=collection_archive---------0-----------------------#2018-07-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/c64975a9281913145370585ae2d86d71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*BwI6Mm0OfJXYsJWESbNxvg.png"/></div></figure><p id="5795" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我在建造在<strong class="jw ir">恒星</strong>上的售票平台上工作🚀需要发送图像的区块链。这应该是简单任务，但是由于糟糕的文档、反对和限制，它变得很困难。本文将描述如何使用Dialogflow发送图像</p><h2 id="77e8" class="ks kt iq bd ku kv kw dn kx ky kz dp la kf lb lc ld kj le lf lg kn lh li lj lk bi translated">方式1:使用Dialogflow</h2><p id="a4b0" class="pw-post-body-paragraph ju jv iq jw b jx ll jz ka kb lm kd ke kf ln kh ki kj lo kl km kn lp kp kq kr ij bi translated">使用以下命令获取<a class="ae lq" href="https://github.com/dialogflow/dialogflow-fulfillment-nodejs" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">对话流</strong>代理履行库(NodeJS) </a>:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="3a98" class="ks kt iq lw b gy ma mb l mc md">yarn add dialogflow-fulfillment<br/>// OR<br/>npm i --save dialogflow-fulfillment</span></pre><p id="c0c1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后<code class="fe me mf mg lw b">require</code>将其放入您的项目，并使用URL添加图像:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="b11f" class="ks kt iq lw b gy ma mb l mc md">const { WebhookClient, Image } = require('dialogflow-fulfillment')<br/>const agent = new WebhookClient({ request, response })</span><span id="2946" class="ks kt iq lw b gy mh mb l mc md">agent.add(<br/>  new Image('<a class="ae lq" href="https://avatars1.githubusercontent.com/u/36980416?s=200&amp;v=4" rel="noopener ugc nofollow" target="_blank">https://avatars1.githubusercontent.com/u/36980416</a>')<br/>)</span></pre><h2 id="d4e8" class="ks kt iq bd ku kv kw dn kx ky kz dp la kf lb lc ld kj le lf lg kn lh li lj lk bi translated">方式2:使用脸书API</h2><p id="754b" class="pw-post-body-paragraph ju jv iq jw b jx ll jz ka kb lm kd ke kf ln kh ki kj lo kl km kn lp kp kq kr ij bi translated">2.2上传图像到<strong class="jw ir">脸书</strong></p><blockquote class="mi mj mk"><p id="5d94" class="ju jv ml jw b jx jy jz ka kb kc kd ke mm kg kh ki mn kk kl km mo ko kp kq kr ij bi translated">用您的url替换<strong class="jw ir"> url </strong>和<strong class="jw ir"> $PAGE_ACCESS_TOKEN </strong></p></blockquote><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="6e63" class="ks kt iq lw b gy ma mb l mc md">curl -X POST -H "Content-Type: application/json" -d '{<br/>  "message": {<br/>    "attachment": {<br/>      "type": "image",<br/>      "payload": {<br/>        "is_reusable": true,<br/>        "url": "<a class="ae lq" href="https://avatars1.githubusercontent.com/u/36980416?s=200&amp;v=4" rel="noopener ugc nofollow" target="_blank"><strong class="lw ir">https://avatars1.githubusercontent.com/u/36980416</strong></a>"<br/>      }<br/>    }<br/>  }<br/>}' "<a class="ae lq" href="https://graph.facebook.com/v2.6/me/message_attachments?access_token=$PAGE_ACCESS_TOKEN" rel="noopener ugc nofollow" target="_blank">https://graph.facebook.com/v2.6/me/message_attachments?access_token=<strong class="lw ir">$PAGE_ACCESS_TOKEN</strong></a>"</span></pre><p id="4f59" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">响应应该如下所示</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="3ef0" class="ks kt iq lw b gy ma mb l mc md">{"attachment_id":"<strong class="lw ir">210118692982122</strong>"}</span></pre><p id="e832" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">2.2通过webhook从请求中获取<strong class="jw ir">sender id</strong>(<strong class="jw ir">2238896416126713</strong>for me)</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="3a87" class="ks kt iq lw b gy ma mb l mc md">request.body.originalDetectIntentRequest.payload.data.sender.id</span></pre><p id="0ea6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">2.3通过messenger发送</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="30fd" class="ks kt iq lw b gy ma mb l mc md">curl -X POST -H "Content-Type: application/json" -d '{<br/>  "messaging_type": "NON_PROMOTIONAL_SUBSCRIPTION",<br/>  "recipient": {<br/>    "id": "<strong class="lw ir">2238896416126713</strong>"<br/>  },<br/>  "message":{<br/>    "attachment":{<br/>      "type":"image", <br/>      "payload":{<br/>        "attachment_id": "<strong class="lw ir">210118692982122</strong>"<br/>      }<br/>    }<br/>  }<br/>}' "<a class="ae lq" href="https://graph.facebook.com/v2.6/me/messages?access_token=$PAGE_ACCESS_TOKEN" rel="noopener ugc nofollow" target="_blank">https://graph.facebook.com/v2.6/me/messages?access_token=<strong class="lw ir">$PAGE_ACCESS_TOKEN</strong></a>"</span></pre><p id="2c65" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">挑一个就搞定了，耶！</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><a href="https://levelup.gitconnected.com"><div class="gh gi mp"><img src="../Images/439094b9a664ef0239afbc4565c6ca49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9uYu-fFL3hIQLGVu0o-EQ.png"/></div></a></figure></div></div>    
</body>
</html>