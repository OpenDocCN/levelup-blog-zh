<html>
<head>
<title>Build a custom Nginx image using Dockerfile and push it to ECR!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Dockerfile构建自定义Nginx映像，并将其推送到ECR！</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-custom-nginx-image-using-dockerfile-and-push-it-to-ecr-7aced9ced256?source=collection_archive---------1-----------------------#2022-11-30">https://levelup.gitconnected.com/build-custom-nginx-image-using-dockerfile-and-push-it-to-ecr-7aced9ced256?source=collection_archive---------1-----------------------#2022-11-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ab21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">了解Docker，并通过使用Dockerfile部署自定义Nginx映像，并将其推送到Amazon ECR。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4a6055c3057f40d22db95c4ff32be277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rj873JwqNCpIPVQGhBaUzw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Docker ECR工作在进行中</figcaption></figure><h1 id="f115" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Docker是什么？</h1><p id="d844" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">Docker是一个开源的容器化平台，用于在轻量级可视化环境中开发、部署和管理应用程序。将每个应用程序打包到独立的容器中也使得开发、部署、维护和使用应用程序变得更加容易。它使用类似于虚拟机的虚拟化，但以一种非常轻量级的方式处理它，用单个进程来处理容器，该容器处理它自己部署的应用程序。</p><h2 id="0107" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">Docker和虚拟机的区别？</h2><p id="f6c0" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated"><em class="mr"> a) Docker在几毫秒内启动，而VM需要一分钟或更长时间<br/> b)存储大小可能被限制在几百MB，VM需要的空间超过GB即使在较轻的操作系统版本中，也高达20–80gb。<br/> c)容器是内核虚拟化，VM做硬件虚拟化。d) Docker占用很少的内存，但VM占用大量内存。<br/> e)像本机应用程序一样运行，虚拟机性能可能会受到操作系统及其硬件的限制。容器共享主机操作系统，但是每个虚拟机都在自己的操作系统中运行。</em></p><p id="8e09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> docker架构</strong> —这是一种客户端-服务器架构，Docker客户端与Docker守护进程对话，后者的作用类似于服务器。Docker客户端与Docker引擎交互，Docker引擎包含<strong class="jp ir">守护进程、containerd </strong>和<strong class="jp ir"> runc </strong>。</p><h2 id="7e5a" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">码头工人</h2><p id="cd75" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">Docker守护进程(<strong class="jp ir"><em class="mr">Docker</em></strong>)<strong class="jp ir">监听Docker API请求并管理Docker对象，如图像、容器、网络和卷。一个守护进程也可以与其他守护进程通信来管理Docker服务。它安装在一台主机上，本质上充当Docker的大脑，它代表您创建和管理您的Docker映像。它的全部目的是<strong class="jp ir">执行客户端发出的命令</strong>。Docker <strong class="jp ir">卷</strong>是一个持久文件，Docker可以在附加时存储和检索数据。</strong></p><h2 id="766e" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">集装箱d</h2><p id="8b35" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">容器管理生命周期，如开始、停止、暂停和删除。</p><h2 id="9a0e" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">runC</h2><p id="9201" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">runC是一个轻量级、可移植的容器运行时。它包括Docker用来与容器相关的系统特性进行交互的所有管道代码</p><h2 id="8fb1" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">Docker图像</h2><p id="824c" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">Docker映像是一个<strong class="jp ir">只读模板</strong>，它包含一组用于创建可以在Docker平台上运行的容器的指令。它提供了一种方便的方法来打包应用程序并创建一个配置好的服务器系统。</p><p id="6e76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Docker file→Docker image→Docker Container→隔离(单独)代码运行</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="3bea" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">什么是亚马逊(ECR)弹性容器注册表？</h2><p id="2045" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated"><a class="ae me" href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/what-is-ecr.html" rel="noopener ugc nofollow" target="_blank">Amazon Elastic Container Registry(Amazon ECR)</a>是一个AWS托管的容器映像注册服务，它是安全的、可伸缩的和可靠的。Amazon ECR使用AWS IAM支持基于资源的权限的私有存储库。这是为了让指定的用户或Amazon EC2实例可以访问您的容器存储库和映像。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="1f89" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">小贴士:</h2><p id="e185" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">如果你想在docker周围玩而不免费安装任何东西，那么你有docker <a class="ae me" href="https://labs.play-with-docker.com/" rel="noopener ugc nofollow" target="_blank">游乐场</a>。它是基于docker本身构建的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/de51f4169e958311023563f0c993949b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gfdaYtJSnHRbkGBxJbMRjQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">码头游乐场</figcaption></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="a088" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">要完成的任务:-</h2><p id="8f10" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated"><em class="mr"> 1。使用Nginx创建您自己的映像，并添加一个文件来告诉您容器的部署日期。<br/> 2。在端口8080打开的情况下部署容器<br/> 3。将容器数据保存到AWS弹性容器注册表(ECR) </em></p><h2 id="9381" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated"><strong class="ak">先决条件:</strong></h2><ol class=""><li id="29c5" class="na nb iq jp b jq lz ju ma jy nc kc nd kg ne kk nf ng nh ni bi translated">使用您的AWS帐户凭据配置的AWS CLI。</li><li id="4b47" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">vscode或您选择的代码编辑器。</li></ol><p id="b340" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意</strong>:该任务在Ubuntu上执行，vscode已经配置了AWS CLI和GitHub。唯一后来安装的是docker。所以开始工作前一定要安装。</p><h1 id="51d0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">任务:1</h1><blockquote class="no np nq"><p id="c449" class="jn jo mr jp b jq jr js jt ju jv jw jx nr jz ka kb ns kd ke kf nt kh ki kj kk ij bi translated"><strong class="jp ir">使用Nginx创建您自己的映像，并添加一个文件来告诉您容器的部署日期。</strong></p></blockquote><p id="a71a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们必须创建一个文件夹，然后将Nginx和html文件放在一起，这样我们就可以用它来创建一个自定义图像。为了完成这项任务，我们使用<strong class="jp ir"> dockerfile </strong>。</p><p id="9936" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个<code class="fe nu nv nw nx b"><a class="ae me" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">Dockerfile</strong></a></code> <a class="ae me" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> </strong> </a>是一个文本文档，它包含用户可以在命令行上调用的所有命令来组合一个图像。本页描述了您可以在<code class="fe nu nv nw nx b">Dockerfile</code>中使用的命令。我们将使用docker文件来构建我们的自定义映像。</p><blockquote class="no np nq"><p id="7d12" class="jn jo mr jp b jq jr js jt ju jv jw jx nr jz ka kb ns kd ke kf nt kh ki kj kk ij bi translated"><strong class="jp ir">我们要做这个任务:1以更小的步骤:</strong></p></blockquote><h2 id="a935" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">步骤1:为你的docker镜像创建文件夹/目录</h2><p id="ed5f" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我在Ubuntu中使用的是vscode，所以我已经用GitHub配置了它，所以所有的更改都被推送到Git库。让我们从mkdir开始创建目录并移动到它。</p><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="6a5a" class="oc lc iq nx b be od oe l of og">mkdir &lt;DIRECTORY/FOLDER NAME&gt;<br/>cd &lt;DIRECTORY/FOLDER NAME&gt;</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/84dd1e503b79e975c49ff353477e1141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*v6iBEV2gOotv1xNMGbAbwg.png"/></div></figure><h2 id="611a" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">步骤2-拉docker图像</h2><p id="f8f1" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">让我们把docker图片放到我们的目录中。</p><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="d73c" class="oc lc iq nx b be od oe l of og">docker pull nginx:latest</span></pre><p id="476f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">糟糕，在开始这项任务之前，我忘记在我的系统中安装docker了。让我们安装它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oi"><img src="../Images/a958ff7f185d60d629af481c1b65d9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IwcYzmvYt_HDRM-D5x0x0Q.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">已安装码头</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oj"><img src="../Images/34131fab59a8696b60f209344db7361b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WxgN7JrqB_won5JBqb6QIw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">用sudo做码头拉</figcaption></figure><p id="d44e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在我们在本地目录中有了nginx映像。让我们检查一下。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/ca3d3efd489313b417572e961e4066d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*NLG5WL0GSFTNopLNstXRew.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">nginx图像</figcaption></figure><p id="6e56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了解决我所面临的docker许可问题，我必须做一些整理工作。创建一个docker组并在其中添加用户。</p><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="67ea" class="oc lc iq nx b be od oe l of og">sudo groupadd docker<br/>sudo usermod -aG docker $USER</span></pre><p id="eb0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请在登出后立即返回，以反映我们在Ubuntu中的变化。让我们看看已经解决了我们的问题。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ol"><img src="../Images/4fdb064b479624ba54273c6451efbeac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SmKLHMaEKZzX5ReDfTFfLw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">是的，它修复了权限问题</figcaption></figure><h2 id="1b0d" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">步骤3-创建index.html，打印出容器部署的日期和时间。</h2><p id="e08e" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">现在让我们集中创建显示日期和时间的index.html文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi om"><img src="../Images/e43f85b408795a21669a90df457fe71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1rK22Lig44ddrkFexZUeYg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">创建并编辑了我们的索引文件</figcaption></figure><h2 id="cb92" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">第4步:创建一个Dockerfile文件来包含索引文件和nginx</h2><p id="d4b9" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">让我们创建一个docker文件来包含index和nginx，以构建我们的自定义图像。确保移出当前目录来创建dockerfile。第一张<strong class="jp ir"> $cd </strong>..然后触摸dockerfile。</p><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="6cd9" class="oc lc iq nx b be od oe l of og">touch dockerfile</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi on"><img src="../Images/9c5d3df792998031cac394fd8a1d8a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LFMHjjtYpOqfBrG4K5W9lg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">在父目录中创建了dockerfile</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/22c06f2f8652d97d3552374b82459b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*HWSmVvlPBkvIqETcnOZ_tQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">dockerfile包含代码</figcaption></figure><h2 id="588b" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">步骤5-构建docker映像</h2><p id="83ed" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">现在是构建它的时候了，让我们从docker文件中构建图像。需要注意的是。末尾带空格的表示当前目录。</p><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="5a14" class="oc lc iq nx b be od oe l of og">docker build -t &lt;nameofcontainer&gt; .</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi op"><img src="../Images/b97f416b8d500b7bb6b9a12538323f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQiMd1VROFjG0K6ACoAZ1Q.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">在一些错误之后，它被执行</figcaption></figure><p id="a136" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们面对的是文件没有找到，所以我给它一个完整的路径→<em class="mr">COPY/docker 2 ECR/index . html/usr/share/nginx/html</em>。所以修好了，让我们再检查一遍。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/35f237e7862fba5945b4cab89da234aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*kQtus63E7g84pYpta5CQ8w.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">这是一个成功——我们可以看到nginxweek16</figcaption></figure><blockquote class="no np nq"><p id="f85d" class="jn jo mr jp b jq jr js jt ju jv jw jx nr jz ka kb ns kd ke kf nt kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">任务二。打开端口8080部署您的容器</em> </strong></p></blockquote><p id="685f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们用这个cmd从我们的映像创建我们的容器。</p><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="7485" class="oc lc iq nx b be od oe l of og">docker run -d --name &lt;container-name&gt; -p 8080:80 nginxweek16<br/>docker run -d --name itsjoescontainer -p 8080:80 nginxweek16<br/>docker ps</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi or"><img src="../Images/60b1b0c28b0f1354f6a1820ce0540c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyfFq-9eG-BTHtccYQEaSw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">检查一下docker ps，它显示在名字下面</figcaption></figure><p id="28f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查容器是否正常工作。让我们转到localhost:8080，检查我们是否有index.html</p><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="ed54" class="oc lc iq nx b be od oe l of og">curl loclhost:8080</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi os"><img src="../Images/9e705d3f348e61831576e731dbd786da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*gOtrWWorgElbwF_IqOvcMQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">它在工作，我们可以看到我们的index.html</figcaption></figure><p id="a7dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在在浏览器中检查相同的内容。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ot"><img src="../Images/b150c90adb1aac49a89d3d140b784b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0IvXBbNOEwu8S_4jq0qjQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">它工作正常。</figcaption></figure><blockquote class="no np nq"><p id="0d68" class="jn jo mr jp b jq jr js jt ju jv jw jx nr jz ka kb ns kd ke kf nt kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">任务三。</em>将您的容器数据保存到AWS弹性容器注册表(ECR) </strong></p></blockquote><ol class=""><li id="a4f4" class="na nb iq jp b jq jr ju jv jy ou kc ov kg ow kk nf ng nh ni bi translated">要将我们的映像推送到AWS ECR，我们必须首先创建一个存储库。为此，我们使用此命令来初始化一个新的存储库:</li></ol><pre class="km kn ko kp gt ny nx nz bn oa ob bi"><span id="6d96" class="oc lc iq nx b be od oe l of og">aws ecr create-repository --repository-name &lt;name&gt; --region &lt;region&gt;<br/>aws ecr create-repository --repository-name nginxweek16 --region us-east-1</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ox"><img src="../Images/f5a9fa931b6fef0218a8c17dc3c50548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1soYxKgyqbIpW_Zutje_Eg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">创建的存储库</figcaption></figure><p id="5013" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们去AWS控制台检查一下。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oy"><img src="../Images/339889eabb0e87dc033b022b01e57381.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ut64wIzmJEFx1aP_QgGXXg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">参见nginxweek16</figcaption></figure><p id="639e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，单击存储库名称继续下一步。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oz"><img src="../Images/a089cf21a9f2c5b182c13e5b020c6416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKdYjrjpLRoX8GTs6gBpqQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">点击查看按钮命令按钮</figcaption></figure><p id="45d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，单击view push commands查看我们需要执行的cmd。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi pa"><img src="../Images/9d6e9956b41339b729c43ed0dc8e6f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ckFtZf0INV3_lEFfZj460g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">将cmd复制到这里并粘贴到aws cli中</figcaption></figure><p id="f88b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以按照这里给出的说明，将每一个复制并粘贴到aws CLI上。结果很好。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi pb"><img src="../Images/f474f5a99f3988e8d7a8c747e0a65208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bPk9PL4OdmDcInzQiU7Xuw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">看到我们的sha256以浅绿色突出显示</figcaption></figure><p id="bd9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在去检查我们的仓库。两处见sha256:18f604d57。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi pc"><img src="../Images/1a899f72c6ba186e3acf8a230f1ac3f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_y7Skc3mnjazMt_2VvIK_Q.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">它有相同的sha256键，用于我们推入ECR的图像</figcaption></figure><p id="4fbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">万岁！！！，我们终于做到了。</p><h2 id="4af2" class="mf lc iq bd ld mg mh dn lh mi mj dp ll jy mk ml lp kc mm mn lt kg mo mp lx mq bi translated">总结:</h2><p id="6ecf" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我们在这里所做的是，首先我们简要地看了一下docker，然后开始构建自定义映像，并使用自定义端口对其进行部署。然后我们把我们的图片推送到亚马逊ECR。希望你学习了一些docker的概念，并学会了如何将图像推送到ECR。谢谢你评论我的文章。我感谢你的好意。</p><p id="c3d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">参考资料:</strong><br/>Docker—<a class="ae me" href="https://docs.docker.com/get-started/overview/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/get-started/overview/</a><br/>Docker runC—<a class="ae me" href="https://www.docker.com/blog/runc/" rel="noopener ugc nofollow" target="_blank">https://www.docker.com/blog/runc/</a><br/>Docker file—<a class="ae me" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/engine/reference/builder/</a></p></div></div>    
</body>
</html>