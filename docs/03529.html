<html>
<head>
<title>Installing Mozilla TTS on a Raspberry Pi 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在覆盆子Pi 4上安装Mozilla TTS</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/installing-mozilla-tts-on-a-raspberry-pi-4-e6af16459ab9?source=collection_archive---------4-----------------------#2020-05-14">https://levelup.gitconnected.com/installing-mozilla-tts-on-a-raspberry-pi-4-e6af16459ab9?source=collection_archive---------4-----------------------#2020-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ca94" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在最少痛苦的情况下完成此操作的分步说明！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2d000c77000539674ed59933941b8523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OHb-542chqECrSo0o3cb9w.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">覆盆子Pi 4准备好安装TTS了！</figcaption></figure><p id="424b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文的标题应该给出一个相当明确的概念，但在我们深入研究说明之前。我将简要概述一些背景，并解释自己尝试的动机。</p><p id="6c34" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">考虑到高质量语音合成所需的计算机和覆盆子Pi相对较低的功率，你可能想知道为什么地球上有人会决定尝试这个。这个想法最近闪过我的脑海，但它是那些“T0”之一，因为它在那里“T1”类的挑战，我发现自己拥有一个闪亮的新的<a class="ae lu" href="https://www.raspberrypi.org/products/raspberry-pi-4-model-b/" rel="noopener ugc nofollow" target="_blank">覆盆子Pi 4 </a>，面对一个长周末，我会花很多时间在室内(和最近的全球环境，我不孤独在最后一个方面，我敢肯定！).所以，在一顿丰盛的早餐后，我出发了，下面的内容浓缩了我在努力让它成功安装和工作的同时找到的解决方案。</p><p id="945e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://github.com/mozilla/TTS" rel="noopener ugc nofollow" target="_blank"> Mozilla TTS </a>是一个了不起的项目，自2018年初以来一直作为其共同声音计划的一部分进行，旨在开放声音软件和资源。实际上，它意味着任何拥有计算机的人都可以用数据训练合成语音模型，然后让系统输出你想要的任何语音。随着项目的进展，最佳模型的输出在质量上变得越来越像人类。</p><p id="fcb3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文展示的是，即使在一个低级的覆盆子Pi上，你也可以使用一个预先训练好的模型生成高质量的语音。诚然，目前的实现运行相当缓慢，但事实上，像这样一个合理的计算密集型任务可以在一台便宜的55美元的计算机上完成，这本身就很了不起。</p><blockquote class="lv"><p id="a5c5" class="lw lx it bd ly lz ma mb mc md me lt dk translated">目前，语音生成速度比实时慢6倍左右，但仍有许多实际用途</p></blockquote><p id="c379" class="pw-post-body-paragraph ky kz it la b lb mf ju ld le mg jx lg lh mh lj lk ll mi ln lo lp mj lr ls lt im bi translated">虽然这种速度排除了交互式语音场景，但仍有许多场景可以增加价值。有了批量制作的演讲，你可以输出任何你想要的东西:阅读新闻文章，私人笔记，任何你喜欢的东西。</p><p id="9a15" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你的口语句子落入一个可预测的模式，你可能只需要用一个圆周率就能提前计算出来。随着未来的发展，速度很可能会提高，尤其是TFLite的实现工作已经在进行中，尽管用目前的算法在有限的硬件上不可能达到实时性。</p><blockquote class="lv"><p id="0dca" class="lw lx it bd ly lz ma mb mc md me lt dk translated">一个主要好处是，这一切都可以在当地发生</p></blockquote><p id="2592" class="pw-post-body-paragraph ky kz it la b lb mf ju ld le mg jx lg lh mh lj lk ll mi ln lo lp mj lr ls lt im bi translated">你的数据不会与云中的第三方共享:尽管他们的服务令人印象深刻，但你可能不想分享一切，或者你可能只是不想向他们付费。</p><p id="3f74" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">显然，对于更大容量的演讲，一台更强大的计算机会更好地满足你的需求，但这是一个有趣的开始。</p><p id="dc87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的细节是截至2020年年中，随着项目的发展，步骤可能会改变，但通过分享这些，我希望它能帮助其他人克服我面临的一些障碍。如果/当可靠的<a class="ae lu" href="https://www.piwheels.org/" rel="noopener ugc nofollow" target="_blank">车轮</a>可用于某些所需的包装时，有一些简化的步骤和可能的进一步优化。最慢的步骤是安装PyTorch和librosa(这又需要llvmlite)。总时间是四个小时多一点(<em class="mk">，但是你可以在相当长的一段时间里不去管它</em>)。</p><h1 id="c9d2" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">说明</h1><h2 id="7c4c" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">先决条件</h2><ol class=""><li id="1e34" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt nw nx ny nz bi translated">一个RPi4(理想4Gb未经其他型号测试)</li><li id="2364" class="np nq it la b lb oa le ob lh oc ll od lp oe lt nw nx ny nz bi translated">拉斯边巴斯特精简版(版本:2020年2月)</li></ol><h2 id="15b5" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">安装前准备</h2><ul class=""><li id="f54e" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">做所有常识性的事情:保护你的设备(passwd)，设置网络访问，通过raspi-config的任何调整等等。</li><li id="3ccc" class="np nq it la b lb oa le ob lh oc ll od lp oe lt of nx ny nz bi translated">更新所有标准包</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="9686" class="nd mm it oh b gy ol om l on oo">sudo apt update<br/>sudo apt full-upgrade</span></pre><ul class=""><li id="d281" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated"><em class="mk">可选地:</em>安装<a class="ae lu" href="https://medium.com/@tholex/what-is-tmux-and-why-would-you-want-it-for-frontend-development-e43e8f370ef2" rel="noopener"> tmux </a>(或者使用screen或者你喜欢的任何东西)——如果连接到headless并且你想在它编译的时候分离会话，这是明智的，但是如果直接访问Pi，这不是真正必要的</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="3eac" class="nd mm it oh b gy ol om l on oo">sudo apt install tmux</span></pre><ul class=""><li id="3bed" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">在完成准备步骤后，重启是值得的</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="c6de" class="nd mm it oh b gy ol om l on oo">sudo reboot</span></pre><ul class=""><li id="f78a" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">通过ssh(和tmux等，如果你愿意)连接</li></ul><h2 id="a9d0" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">一起运行所有apt安装步骤</h2><ul class=""><li id="a0e7" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">如果您在这里一步完成所有这些操作，会更容易</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="8c18" class="nd mm it oh b gy ol om l on oo">sudo apt install git python3-venv libopenblas-dev libblas-dev m4 cmake cython python3-dev python3-yaml python3-setuptools libatomic-ops-dev llvm espeak libsndfile1 libzstd1 liblcms2–2 libjbig0 libopenjp2–7 libwebpdemux2 libtiff5 libwebpmux3 libwebp6 libatlas3-base</span></pre><ul class=""><li id="d760" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">在下面的相关章节中，我保留了单独的等价步骤，但是用前面的散列符号注释掉了(这样你就知道不会再运行它们)。将它们留在那里可以让您看到它们整体上是如何组合在一起的，如果您将来需要修改指令，例如某些东西发生变化或损坏，这可能会很有帮助！</li></ul><h2 id="4950" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">从Github签出TTS</h2><ul class=""><li id="7b86" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">如上所述，下面是注释掉的步骤之一:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="df8c" class="nd mm it oh b gy ol om l on oo"># sudo apt install git</span></pre><ul class=""><li id="f105" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">这些指令建议使用一个特定的提交(<strong class="la iu"> 2e2221f </strong>)，以便它们在后续的回购更新中继续工作</li><li id="71c5" class="np nq it la b lb oa le ob lh oc ll od lp oe lt of nx ny nz bi translated">如果你不介意事情被破坏的风险，那么尽一切办法尝试其他的提交(<em class="mk">如果在你遵循这些指令的时候有一个更晚的提交存在；截至发稿</em><a class="ae lu" href="https://github.com/mozilla/TTS/tree/2e2221f146f1ca301a3b2b547d8f26b9009676de" rel="noopener ugc nofollow" target="_blank"><em class="mk">2e 2221 f</em></a><em class="mk">为最新</em></li><li id="98da" class="np nq it la b lb oa le ob lh oc ll od lp oe lt of nx ny nz bi translated">并非绝对必要，但我们可以通过只检查一个分支来节省SD卡上的空间:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="a4f2" class="nd mm it oh b gy ol om l on oo">git clone — single-branch — branch master <a class="ae lu" href="https://github.com/mozilla/TTS.git" rel="noopener ugc nofollow" target="_blank">https://github.com/mozilla/TTS.git</a></span><span id="dbca" class="nd mm it oh b gy os om l on oo">cd TTS</span><span id="9473" class="nd mm it oh b gy os om l on oo">git checkout 2e2221f</span></pre><h2 id="40ef" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">创建虚拟环境</h2><ul class=""><li id="0b17" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">有几种方法可以做到这一点，我将使用内置的</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="cd4c" class="nd mm it oh b gy ol om l on oo"># sudo apt install python3-venv</span><span id="3a09" class="nd mm it oh b gy os om l on oo">python3 -m venv venv<br/>source venv/bin/activate</span></pre><ul class=""><li id="52e5" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">为了确保您使用的是正确的python和pip，请使用下面的命令。从现在开始，我将省去“3 ”,因为在虚拟环境中，您将不再需要它</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="f3bb" class="nd mm it oh b gy ol om l on oo">which python<br/>python --version<br/>which pip<br/>pip --version</span></pre><ul class=""><li id="8d75" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">我建议将pip更新到最新版本</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="c5af" class="nd mm it oh b gy ol om l on oo">pip install -U pip</span></pre><ul class=""><li id="8197" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">为了进一步简化，我建议这一个pip安装步骤包括所有需要的底层包，除了那些我们需要手动安装的包</li><li id="d48e" class="np nq it la b lb oa le ob lh oc ll od lp oe lt of nx ny nz bi translated">为了与apt安装步骤保持一致，为了清楚起见，我在下面的相关地方注释掉了这些步骤</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="eb54" class="nd mm it oh b gy ol om l on oo">pip install numpy==1.16.1 matplotlib==3.2.1 bokeh==1.4.0 Flask pyyaml attrdict segments scipy tensorboard tensorboardX Pillow Unidecode&gt;=0.4.20 tqdm soundfile phonemizer</span></pre><p id="63d2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> NB: </strong>上面的命令几乎重复了setup.py中的内容(加上一些依赖项)，但是由于我们稍后需要在没有依赖项的情况下运行setup.py(为了避免it试图安装与此处所需版本不同的numpy版本的问题),这种方法是一种变通方法。还有其他方法可以解决这个问题。</p><h2 id="ac9d" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">安装PyTorch</h2><ul class=""><li id="e80e" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">如果PiWheels成功地为PyTorch ( <a class="ae lu" href="https://www.piwheels.org/project/pytorch/" rel="noopener ugc nofollow" target="_blank">查看此处的最新状态</a>)制造出一个轮子，这将大大加快安装速度并简化安装</li><li id="f6bb" class="np nq it la b lb oa le ob lh oc ll od lp oe lt of nx ny nz bi translated">PyTorch有由个人分发的轮子——如果您对使用您在1.0.0版中找到的轮子没有问题，那么您可以自由地这样做(这将比这一步中的方法快得多，尽管除了下面的方法之外，我没有测试过)</li><li id="050a" class="np nq it la b lb oa le ob lh oc ll od lp oe lt of nx ny nz bi translated">本节的说明是受这篇文章的启发:<a class="ae lu" href="https://medium.com/hardware-interfacing/how-to-install-pytorch-v4-0-on-raspberry-pi-3b-odroids-and-other-arm-based-devices-91d62f2933c7" rel="noopener">https://medium . com/hardware-interfacing/how-to-install-py torch-v4-0-on-raspberry-pi-3 b-o droids-and-other-arm-based-devices-91d 62 f 2933 c 7</a></li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="4577" class="nd mm it oh b gy ol om l on oo">cd .. # gets you out of TTS directory</span><span id="6199" class="nd mm it oh b gy os om l on oo">git clone --recursive <a class="ae lu" href="https://github.com/pytorch/pytorch" rel="noopener ugc nofollow" target="_blank">https://github.com/pytorch/pytorch</a> -- branch=v1.0.0</span><span id="dbf5" class="nd mm it oh b gy os om l on oo">cd pytorch</span></pre><ul class=""><li id="7952" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">设置各种环境变量</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="8c05" class="nd mm it oh b gy ol om l on oo">export NO_CUDA=1<br/>export NO_DISTRIBUTED=1<br/>export NO_MKLDNN=1 <br/>export NO_NNPACK=1<br/>export NO_QNNPACK=1</span></pre><ul class=""><li id="992e" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">如果你在一个更受限制的Pi ( <em class="mk"> YMMV </em>)上，你可能需要建议的交换指令，但是在4Gb Pi上，你似乎可以跳过这个细节</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="1c9d" class="nd mm it oh b gy ol om l on oo"># pip install pyyaml</span><span id="bec0" class="nd mm it oh b gy os om l on oo"># sudo apt install libopenblas-dev libblas-dev m4 cmake cython python3-dev python3-yaml python3-setuptools # for PyTorch</span></pre><ul class=""><li id="cfdc" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">似乎需要对此进行设置以允许其完成编译(基于<a class="ae lu" href="https://github.com/pytorch/pytorch/issues/22898#issuecomment-549877452" rel="noopener ugc nofollow" target="_blank">https://github . com/py torch/py torch/issues/22898 # issue comment-549877452</a>)</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="17c3" class="nd mm it oh b gy ol om l on oo"># sudo apt install libatomic-ops-dev<br/>## above is for PyTorch. Note the package is libatomic-ops-dev<br/>## and not libatomics-ops-dev (with an s)</span><span id="15d1" class="nd mm it oh b gy os om l on oo">sed -i ‘/set(CMAKE_EXPORT_COMPILE_COMMANDS ON)/a set(CMAKE_CXX_FLAGS “${CMAKE_CXX_FLAGS} -latomic”)’ CMakeLists.txt</span></pre><ul class=""><li id="c439" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">下面是两个非常长的步骤，大约需要四个小时</li></ul><blockquote class="lv"><p id="8af8" class="lw lx it bd ly lz ot ou ov ow ox lt dk translated">在这个阶段，您可能希望看到命令正在工作，然后休息一下！</p></blockquote><pre class="oy oz pa pb pc og oh oi oj aw ok bi"><span id="39b3" class="nd mm it oh b gy ol om l on oo">python setup.py build<br/>python setup.py install<br/>cd ..</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/4f9a60f23504cfc25565b8a11aa77314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dp_meVyGLRo4rBIoemdhA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">安装PyTorch时终端的典型输出</figcaption></figure><p id="46f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您现在应该已经安装了PyTorch 1.0.0😃</p><h2 id="2c9e" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">安装LLVM和llvmlite</h2><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="dd76" class="nd mm it oh b gy ol om l on oo"># sudo apt install llvm</span><span id="c6c9" class="nd mm it oh b gy os om l on oo">llvm-config — version<br/>llvm-config — libdir<br/>which llvm-config<br/>LLVM_CONFIG=/usr/bin/llvm-config pip install llvmlite</span></pre><ul class=""><li id="54b8" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">使用以下工具进行测试:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="15ea" class="nd mm it oh b gy ol om l on oo">python -m llvmlite.tests</span></pre><h2 id="b000" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">安装numba</h2><ul class=""><li id="f923" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">注意，要实现这一点，我们需要一个特定版本的numpy(不是0.15.x，所以用0.16.1，因为它最接近TTS requirements.txt)</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="49be" class="nd mm it oh b gy ol om l on oo"># sudo apt install libatlas3-base</span></pre><ul class=""><li id="bea6" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">这在以前是不可能的，因为它需要llvmlite:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="c5aa" class="nd mm it oh b gy ol om l on oo">pip install numba==0.49.0</span></pre><ul class=""><li id="e6f3" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">通过进入python并运行以下代码来测试它:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="f7d8" class="nd mm it oh b gy ol om l on oo">import numba</span></pre><ul class=""><li id="d2a8" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">应该会成功(不显示错误，只显示下一个提示)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/cd6e4941c2d51cf29a5387256f33315c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXto5mulITQBToCCKApsdw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">安装PyTorch、llvmlite和numba的步骤，并快速检查导入numba是否有效！</figcaption></figure><h2 id="b7ec" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">安装librosa</h2><ul class=""><li id="2c74" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">这在以前是做不到的，因为它需要numba和llvmlite:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="7f57" class="nd mm it oh b gy ol om l on oo">pip install librosa==0.6.2</span></pre><h2 id="dd2d" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">其他包</h2><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="a791" class="nd mm it oh b gy ol om l on oo"># sudo apt install espeak libsndfile1</span><span id="20b9" class="nd mm it oh b gy os om l on oo"># sudo apt install libzstd1 liblcms2–2 libjbig0 libopenjp2–7 libwebpdemux2 libtiff5 libwebpmux3 libwebp6 # these are for Pillow</span></pre><ul class=""><li id="6c29" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">下面的setup.py会发现这些问题，但是直接安装可以避免setup.py试图安装不同版本的numpy而导致的问题</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="638b" class="nd mm it oh b gy ol om l on oo"># pip install matplotlib==3.2.1<br/># pip install Flask<br/># pip install attrdict<br/># pip install segments<br/># pip install tensorboard<br/># pip install tensorboardX<br/># pip install scipy<br/># pip install Pillow<br/># pip install Unidecode&gt;=0.4.20<br/># pip install tqdm<br/># pip install soundfile<br/># pip install bokeh==1.4.0</span></pre><h2 id="7d56" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">完成TTS本身的最终安装</h2><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="ddab" class="nd mm it oh b gy ol om l on oo">cd TTS<br/>python setup.py develop — no-deps</span></pre><ul class=""><li id="03d3" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">这是获得合适的检查点的一种简单方法(你可以通过其他更聪明的方法找到兼容的检查点)</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="18c7" class="nd mm it oh b gy ol om l on oo">mkdir wheels<br/>cd wheels/</span><span id="7644" class="nd mm it oh b gy os om l on oo">wget <a class="ae lu" href="https://github.com/reuben/TTS/releases/download/ljspeech-fwd-attn-pwgan/TTS-0.0.1+92aea2a-py3-none-any.whl" rel="noopener ugc nofollow" target="_blank">https://github.com/reuben/TTS/releases/download/ljspeech-fwd-attn-pwgan/TTS-0.0.1+92aea2a-py3-none-any.whl</a></span><span id="3f7b" class="nd mm it oh b gy os om l on oo">unzip TTS-0.0.1+92aea2a-py3-none-any.whl</span><span id="c90d" class="nd mm it oh b gy os om l on oo">cd .. # so you’re back in TTS directory<br/>mkdir -p server/model/tts<br/>cp wheels/TTS/server/model/tts/checkpoint.pth.tar ../server/model/tts/<br/>cp wheels/TTS/server/model/tts/config.json ../server/model/tts/</span></pre><ul class=""><li id="4e18" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">您不需要做任何必要的更改，但是可以在这里检查服务器配置文件:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="f685" class="nd mm it oh b gy ol om l on oo">nano config.json</span></pre><h2 id="7dec" class="nd mm it bd mn ne nf dn mr ng nh dp mv lh ni nj mx ll nk nl mz lp nm nn nb no bi translated">测试一下</h2><ul class=""><li id="c0be" class="np nq it la b lb nr le ns lh nt ll nu lp nv lt of nx ny nz bi translated">您可以在Pi上运行它，然后通过本地网络上的浏览器访问它:</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="71e4" class="nd mm it oh b gy ol om l on oo">python -m TTS.server.server</span></pre><ul class=""><li id="3494" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">在您的终端中，您会看到一些numba弃用警告，然后您应该会看到:</li></ul><p id="f7e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> &gt;加载TTS模型… </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/c8201fe139f1f0d0813476e773bfd7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ycpQnPuVR7Yc1vmEEetaIg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">服务器启动时的终端输出</figcaption></figure><ul class=""><li id="5da4" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">在出现一些其他配置详细信息后，现在应该可以从可以访问同一网络上的Pi的浏览器中使用它了</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/cb9889a494cb779dfff4a0f92d1d8bfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XGTvh-mA8fFnLtvDoTqWLw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">演示服务器的简单web界面。</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/50a1fcb68b1df4a38d15db44f7e27641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6nO49H63NoObk0uQ8xksA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通过web表单或API调用请求后，您将在终端中看到的输出</figcaption></figure><ul class=""><li id="3f64" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">除了使用浏览器，您还可以向服务器API发送请求，如下所示:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pi pj l"/></div></figure><ul class=""><li id="e8bb" class="np nq it la b lb lc le lf lh op ll oq lp or lt of nx ny nz bi translated">幸运的话，你现在应该有一个可用的工作装置，你的可以免费运行(除了象征性的电费)。</li></ul><h1 id="7a5a" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">后续步骤</h1><p id="5cfc" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh pk lj lk ll pl ln lo lp pm lr ls lt im bi translated">如果你想进一步探索它，可以看看这里的回购自述文件:【https://github.com/mozilla/TTS】T4，其中有各种选项的丰富信息，以及如何了解更多关于这个项目的信息，包括如何训练语音模型——尽管这肯定需要比树莓Pi提供的能力多一个数量级！</p><p id="b87d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，为了证明它确实有效，这里有一个在Pi上生成的样本😃：</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn pj l"/></div></figure></div></div>    
</body>
</html>