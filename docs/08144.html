<html>
<head>
<title>Stencil Component Translations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模具组件翻译</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/stencil-component-translations-4efc44018b1d?source=collection_archive---------5-----------------------#2021-04-05">https://levelup.gitconnected.com/stencil-component-translations-4efc44018b1d?source=collection_archive---------5-----------------------#2021-04-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="47b4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为没有依赖关系的模具组件设置i18n的快速方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/da7fb57f05c1de70450b21982da50a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXe3RbssR10n4RGMVGoZVg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">卢卡斯·乔治·温迪特在<a class="ae ky" href="https://unsplash.com/s/photos/internationalization?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="4190" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我一直在使用相同的策略来快速国际化各种项目中没有依赖关系的<a class="ae ky" href="https://stenciljs.com/" rel="noopener ugc nofollow" target="_blank">模板</a>组件。其中包括项目<a class="ae ky" href="https://owlly.ch/" rel="noopener ugc nofollow" target="_blank">owly</a>或<a class="ae ky" href="https://bonjour.help/" rel="noopener ugc nofollow" target="_blank"> Bonjour foundation </a>。</p><p id="8b0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于所有这些项目都是开源的，我将与你分享我的食谱🧑‍🍳。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3046" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">目标</h1><p id="c573" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我最近在社区的帮助下国际化了我们的项目<a class="ae ky" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>，但是这篇文章的目标是将翻译添加到一个相对较小的组件或一组组件中，而没有依赖性。</p><p id="229f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我创建包含一些带有默认值的<code class="fe mz na nb nc b">slot</code>的组件时，我使用这种解决方案，这些组件的主要市场是我们可爱的“默认四种语言+英语”瑞士🇨🇭.</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="75d6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置</h1><p id="0555" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在您的项目中创建一个新的实用程序<code class="fe mz na nb nc b">translations.util.ts</code>并添加声明。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="af56" class="nh md it nc b gy ni nj l nk nl">interface Translation {<br/>  [key: string]: string;<br/>}<br/><br/>interface Translations {<br/>  de: Translation;<br/>  en: Translation;<br/>}</span></pre><p id="96a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个例子，我将“只”使用德语和英语。对于现实生活中的用例，用你的需求来扩展它。</p><p id="de20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我声明了一个<code class="fe mz na nb nc b">interface Translation</code>，但是，它可以被替换为一个打字稿<code class="fe mz na nb nc b">Record&lt;string, string&gt;</code>。结果是一样的，正如你所愿。</p><p id="b453" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在声明之后，添加一个默认(后备)语言的常量和一个受支持语言的列表。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="147c" class="nh md it nc b gy ni nj l nk nl">const DEFAULT_LANGUAGE: 'en' = 'en';<br/><br/>const SUPPORTED_LANGUAGES: string[] = ['de', 'en'];</span></pre><p id="6ce3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，添加有效的翻译。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="88bd" class="nh md it nc b gy ni nj l nk nl">const TRANSLATIONS: Translations = {<br/>  de: {<br/>    question: 'Wie fühlen Sie sich heute?',<br/>    super: 'Sehr gut',<br/>    bad: 'Nicht gut'<br/>  },<br/>  en: {<br/>    question: 'How do you feel today?',<br/>    super: 'Super',<br/>    bad: 'Bad'<br/>  }<br/>};</span></pre><p id="f0f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个解决方案中，因为我的目标是保持快速和简单，所以我对翻译进行编码。</p><p id="cf24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以在单独的<code class="fe mz na nb nc b">json</code>文件中处理这些，并在运行时动态处理<code class="fe mz na nb nc b">import</code>。这是我为更复杂的用例开发的两个特性。毕竟，我可能真的需要把这件事写在博客上？如果你认为那会是一个有趣的主题，请告诉我！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7ead" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">检测语言</h1><p id="5e63" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我没有重新发明轮子。我查看了广泛使用的开源库<a class="ae ky" href="https://github.com/ngx-translate/core" rel="noopener ugc nofollow" target="_blank"> ngx-translate </a>并实现了对浏览器语言的检测。</p><p id="c4fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在同一个文件中，添加下面的函数和默认语言的初始化。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2f17" class="nh md it nc b gy ni nj l nk nl">const initBrowserLang = (): string | undefined =&gt; {<br/>  if (typeof window === 'undefined' <br/>      || typeof window.navigator === 'undefined') {<br/>    return undefined;<br/>  }<br/><br/>  let browserLang: string | null =<br/>    window.navigator.languages <br/>    &amp;&amp; window.navigator.languages.length &gt; 0 ? <br/>              window.navigator.languages[0] : null;</span><span id="1c53" class="nh md it nc b gy nm nj l nk nl">  // @ts-ignore<br/>  browserLang = browserLang || window.navigator.language || window.navigator.browserLanguage || window.navigator.userLanguage;<br/><br/>  if (typeof browserLang === 'undefined') {<br/>    return undefined;<br/>  }<br/><br/>  if (browserLang.indexOf('-') !== -1) {<br/>    browserLang = browserLang.split('-')[0];<br/>  }<br/><br/>  if (browserLang.indexOf('_') !== -1) {<br/>    browserLang = browserLang.split('_')[0];<br/>  }<br/><br/>  return browserLang;<br/>}<br/><br/>const browserLang: string | undefined = initBrowserLang();</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ef89" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">功能</h1><p id="c369" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">设置和检测都准备好了，我们需要一个函数来呈现翻译。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="ccee" class="nh md it nc b gy ni nj l nk nl">export const translate = <br/>             (key: string, customLang?: 'de' | 'en'): string =&gt; {<br/>  const lang: string | undefined = customLang || browserLang;</span><span id="db85" class="nh md it nc b gy nm nj l nk nl">  return TRANSLATIONS[lang !== undefined <br/>                      &amp;&amp; SUPPORTED_LANGUAGES.includes(lang) ? <br/>                         lang : DEFAULT_LANGUAGE][key];<br/>};</span></pre><p id="26b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它使用浏览器或参数语言，对照支持的语言列表进行检查，或者返回默认语言，并返回相关的翻译。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9671" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用</h1><p id="1126" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们的组件中，上述函数可用于呈现翻译。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="57d3" class="nh md it nc b gy ni nj l nk nl">import {Component, h, Host} from '@stencil/core';<br/><br/>import {translate} from './translations.utils';<br/><br/>@Component({<br/>  tag: 'question',<br/>  shadow: true<br/>})<br/>export class Question {<br/>  render() {<br/>    return &lt;Host&gt;<br/>      &lt;p&gt;{translate('question')}&lt;/p&gt;<br/>      &lt;slot name="answer"&gt;{translate('super', 'de')}&lt;/slot&gt;<br/>    &lt;/Host&gt;;<br/>  }<br/>}</span></pre><p id="0236" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它渲染文本，指定或不指定语言，也可以与<code class="fe mz na nb nc b">slot</code>一起使用。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1a96" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">摘要</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/659feb33c8aa210cccf9dbed5521802e.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/1*Ud0o0tsLPyP76VNbKw-mvg.gif"/></div></figure><p id="e856" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我将i18n设置到一个相对较小的组件集的小窍门。我希望这是有用的，如果你认为我应该在另一篇文章中分享更复杂的解决方案，请告诉我。</p><p id="3cb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到无限和更远的地方！</p><p id="de26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大卫</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="13e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以通过<a class="ae ky" href="https://twitter.com/daviddalbusco" rel="noopener ugc nofollow" target="_blank">推特</a>或我的<a class="ae ky" href="https://daviddalbusco.com/" rel="noopener ugc nofollow" target="_blank">网站</a>联系我。</p><p id="900b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为您的下一张幻灯片尝试一下<a class="ae ky" href="https://deckdeckgo.com/" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>🤟。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://deckdeckgo.com"><div class="gh gi no"><img src="../Images/6fb98ff4c0bba1406d5988f880c127f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U8ovSW7vdVsLczwX.png"/></div></a></figure></div></div>    
</body>
</html>