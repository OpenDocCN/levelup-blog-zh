<html>
<head>
<title>User Defaults in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中的用户默认值</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/user-defaults-in-swift-dfe228f684c6?source=collection_archive---------7-----------------------#2020-05-16">https://levelup.gitconnected.com/user-defaults-in-swift-dfe228f684c6?source=collection_archive---------7-----------------------#2020-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/30170c9b841f3920b3fd24c18bbdbca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6_KzN8_SEi_uf5vh.jpg"/></div></div></figure><p id="279c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所有iOS应用程序都有一个内置的数据字典，只要安装了应用程序，它就会存储少量的用户设置。这个系统叫做UserDefault。</p><h1 id="c2d6" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">什么是用户默认值？</h1><p id="8b82" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">根据苹果的文档，UserDefaults是用户默认数据库的一个接口，你可以在应用程序启动时持久存储键值对。</p><p id="f4ba" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">UserDefault可以保存整数、布尔值、字符串、数组、字典、日期等等，但是你要注意不要保存太多的数据，因为这会减慢你的应用程序的启动速度。</p><p id="f6d3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">UserDefaults就像字典一样，由键和值组成。例如:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="73a3" class="ml la it mh b gy mm mn l mo mp">var dict = [<br/>    "Name": "Yafonia",<br/>    "Age" : 21,<br/>    "Language": "Indonesian"<br/>]</span></pre><p id="5a7e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">用户默认值保存在<code class="fe mq mr ms mh b">.plist</code>文件中，在这种情况下保存在<code class="fe mq mr ms mh b">Info.plist</code>中。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/1090701051555e7c8ccde3ccb01bb02f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mXhXVzPFqU0cfmsmbrqWJA.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">Info.plist文件上的用户默认值</figcaption></figure><h1 id="f138" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">何时使用用户默认值</h1><p id="5d6e" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">用户默认值最适用于简单的数据。如果需要存储多个对象，最好使用真正的数据库。以下是保存在用户默认值中的几个数据示例:</p><ul class=""><li id="0dfc" class="my mz it kd b ke kf ki kj km na kq nb ku nc ky nd ne nf ng bi translated">用户信息，如姓名、电子邮件地址、年龄、职业</li><li id="7556" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">应用程序设置，如用户界面语言、应用程序颜色主题或字体</li><li id="1c13" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">flags(is loggin，用于检查用户是否登录，等等。)</li></ul><h1 id="0753" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">将数据保存在用户默认值中</h1><p id="dfe7" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">我们可以在用户默认值上保存几种变量类型:</p><ul class=""><li id="fd85" class="my mz it kd b ke kf ki kj km na kq nb ku nc ky nd ne nf ng bi translated">布尔值用<code class="fe mq mr ms mh b">Bool</code>，整数用<code class="fe mq mr ms mh b">Int</code>，浮点用<code class="fe mq mr ms mh b">Float</code>，双精度用<code class="fe mq mr ms mh b">Double</code></li><li id="b964" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">带有<code class="fe mq mr ms mh b">String</code>的字符串，带有<code class="fe mq mr ms mh b">Data</code>的二进制数据，带有的<a class="ae nm" href="https://learnappmaking.com/swift-date-datecomponents-dateformatter-how-to/" rel="noopener ugc nofollow" target="_blank">日期，带有<code class="fe mq mr ms mh b">URL</code>类型的URL</a></li><li id="22ec" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">带有<code class="fe mq mr ms mh b">Array</code>和<code class="fe mq mr ms mh b">Dictionary</code>的集合类型</li></ul><p id="eb6a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在内部，<code class="fe mq mr ms mh b">UserDefaults</code>类只能存储<code class="fe mq mr ms mh b">NSData</code>、<code class="fe mq mr ms mh b">NSString</code>、<code class="fe mq mr ms mh b">NSNumber</code>、<code class="fe mq mr ms mh b">NSDate</code>、<code class="fe mq mr ms mh b">NSArray</code>和<code class="fe mq mr ms mh b">NSDictionary</code>类。</p><p id="6146" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，在这个项目中，我想保存几个帐户的信息，如电子邮件，代码，姓名，令牌和用户ID。所以我将loginResponse中的值设置为键的值(Email、LawyerCode、LawyerName、Token、UserID)。所有的值都是字符串。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/edc216c67a7dce47e855fade2c0b81d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ib1Wh7T8llBLq50fMuVfrA.png"/></div></figure><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/e648e779f4450972fa4b0f219f60694a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yudXhvkyriw_lS1efU3o6Q.png"/></div></div></figure><p id="5470" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">除了帐户信息，还有一个名为<code class="fe mq mr ms mh b">"Token"</code>的键用于登录信息。如果该键上有值，则用户已登录，反之亦然。你也可以使用标志，例如你可以用<code class="fe mq mr ms mh b">boolean</code>值来调用它<code class="fe mq mr ms mh b">"isLoggedIn"</code>。</p><h1 id="fb59" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">获取用户默认值中的数据</h1><p id="d86f" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">获取用户默认值中的数据就像保存数据一样简单。让我们看看下面的例子。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/58912d9ebb0c05e9dae832b25370c8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*iddCb3-eth4W0BcpQITCVA.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">我的项目上的帐户页面</figcaption></figure><p id="09d4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于上面的这个页面，我需要帐户的名称(例如:lawyer_staging)和电子邮件(例如:lawyer_staging@justika.com)，这是保存在用户默认设置中的关键字<code class="fe mq mr ms mh b">"Email"</code>和<code class="fe mq mr ms mh b">"LawyerName"</code>。所以我们接下来要做的是:</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/72609ac7820eafcc1535ba96013631e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1RNdSsvWvQxwj8tqFeYww.png"/></div></div></figure><p id="369d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要显示帐户的名称和电子邮件，您可以将标签的文本设置为您从UserDefaults获得的数据。对，就这么简单！</p><h1 id="95bd" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">重置用户默认值中的数据</h1><p id="27c5" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">也许你一直在想，既然我不使用标志来显示登录信息，那么当用户没有登录时会是什么情况呢？</p><p id="cec1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果用户注销了，那么我们可以重置用户默认值上的键和值。我们如何做到这一点？</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/fa0db313a8da2780a9fe176d0659ed4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TGG_S-wQRAm_W7zCJyXNzg.png"/></div></div></figure><p id="1b27" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，当用户点击“Keluar”按钮时，我们可以重置所有用户默认的登录信息的键和值。当用户登录时，在用户默认值中再次设置密钥和值。</p><h1 id="921f" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">用户默认的用户界面语言</h1><p id="31ab" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">如上所述，我们也可以保存应用程序设置，如用户界面语言的用户默认设置。例如，字体信息保存在用户默认值中。</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/6a0835713781a25ecd81971a66629cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ixk7iG6wdvGSWCx8ciyWhA.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">信息列表</figcaption></figure><p id="d169" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在上图中，你可以看到有一个名为<code class="fe mq mr ms mh b">"Fonts provided by application"</code>的键，那是我们保存字体的地方。</p><h1 id="e97c" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">结论</h1><p id="c2bc" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">我们可以轻松地使用用户默认设置来保存简单的数据，如用户信息、应用程序设置和字符串、布尔、整数、数组、字典、日期等形式的标志。</p></div></div>    
</body>
</html>