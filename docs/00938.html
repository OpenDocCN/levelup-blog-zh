<html>
<head>
<title>AEM: Conditionally show or hide fields in TouchUI dialogs with Coral 3 (ie: AEM 6.3+)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AEM:在Coral 3的TouchUI对话框中有条件地显示或隐藏字段(例如:AEM 6.3+)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/aem-conditionally-show-or-hide-fields-in-touchui-dialogs-with-coral-3-ie-aem-6-3-bfd48c261012?source=collection_archive---------1-----------------------#2019-09-24">https://levelup.gitconnected.com/aem-conditionally-show-or-hide-fields-in-touchui-dialogs-with-coral-3-ie-aem-6-3-bfd48c261012?source=collection_archive---------1-----------------------#2019-09-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="2f32" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如何创建一个可以根据用户输入动态显示或隐藏字段的TouchUI对话框是一个经常出现在<a class="ae ko" href="https://forums.adobe.com/community/experience-cloud/marketing-cloud/experience-manager/content" rel="noopener ugc nofollow" target="_blank"> AEM体验联盟论坛</a>上的话题。</p><p id="2579" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，我将向您展示如何为基本AEM组件构建以下TouchUI对话框:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/267a2cd8b321c8bb4bc286354669e1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ui4Sd6AoivYrZOVdYveawA.gif"/></div></div></figure><h1 id="4c5a" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">珊瑚2对珊瑚3</h1><p id="b569" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">网上似乎有许多教程描述了如何使用Coral 2实现这一特性，其中包括一个官方的Adobe指南:</p><ol class=""><li id="6b0b" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated"><strong class="js iu"> Adobe指南</strong>:<a class="ae ko" href="https://helpx.adobe.com/experience-manager/using/dynamic_touchui.html" rel="noopener ugc nofollow" target="_blank">https://helpx . Adobe . com/experience-manager/using/dynamic _ touch ui . html</a></li><li id="4a8c" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated"><strong class="js iu">来自SGAEM的教程:</strong><a class="ae ko" href="http://www.sgaemsolutions.com/2019/01/showhide-tabs-and-fields-based-on-drop.html" rel="noopener ugc nofollow" target="_blank">http://www . sgaemsolutions . com/2019/01/showhide-tabs-and-fields-based-on-drop . html</a></li><li id="be66" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated"><strong class="js iu">视频图图利亚</strong>l:<a class="ae ko" href="https://www.youtube.com/watch?v=JZFFxxiFpGY" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=JZFFxxiFpGY</a></li></ol><p id="418c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是，Coral 2已经过时，在AEM的未来版本中可能会被弃用和/或删除。因此，尽可能考虑迁移到Coral 3，因为它具有新的更好的特性，当您决定迁移到新版本时，它将使您的项目经得起未来的考验。你可以在这里了解更多关于Coral 3的信息:<a class="ae ko" href="https://forums.adobe.com/external-link.jspa?url=https%3A%2F%2Fhelpx.adobe.com%2Fexperience-manager%2F6-4%2Fsites%2Fdeveloping%2Fusing%2Freference-materials%2Fgranite-ui%2Fapi%2Fjcr_root%2Flibs%2Fgranite%2Fui%2Fcomponents%2Flegacy%2Fcoral2%2Fmigration.html" rel="noopener ugc nofollow" target="_blank">基于CoralUI 3的迁移指南——Granite UI 1.0文档</a>。</p><p id="e22f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，如果你决定开始使用Coral 3组件，避免创建混合了Coral 2和Coral 3的ui/对话框，我已经看到了许多奇怪的副作用。您可以通过Coral 2和Coral 3在JCR中的位置来区分它们:</p><p id="ee0d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">珊瑚2</strong>:/libs/granite/ui/components/foundation<br/><strong class="js iu">珊瑚3</strong>:/libs/granite/ui/components/<strong class="js iu">珊瑚</strong> /foundation</p><p id="e802" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Coral 3 PSA已经过时，让我们来看看我们的使用案例。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="458b" class="lb lc it bd ld le mz lg lh li na lk ll lm nb lo lp lq nc ls lt lu nd lw lx ly bi translated">使用案例</h1><p id="5346" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">你在一家多媒体零售公司工作，销售不同类型的硬件:电视、电话和笔记本电脑。他们希望您为他们的AEM网站创建一个组件，列出每个产品的技术规格。但是，根据产品的<em class="ne">类型</em>，技术规格会有所不同。</p><p id="1d7e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了简化营销团队的工作，您决定创建一个可以适应每种产品类型的单一组件。组件的编辑对话框将允许用户选择产品类型并显示适当的技术规范字段。</p><p id="dcb5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">事不宜迟，让我们建立一个对话！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="a309" class="lb lc it bd ld le mz lg lh li na lk ll lm nb lo lp lq nc ls lt lu nd lw lx ly bi translated">1.创建对话</h1><p id="de7a" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">首先，我们需要一个组件来附加我们的编辑对话框，所以在apps下创建一个。我只是简单地将我的组件称为dynamicComponent。给它一个HTML文件，现在，我们只是让它呈现一个简单的“Hello world”:</p><pre class="kq kr ks kt gt nf ng nh ni aw nj bi"><span id="5f2b" class="nk lc it ng b gy nl nm l nn no">&lt;pre&gt;Hello world&lt;/pre&gt;</span></pre><p id="aa31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将您的组件添加到组件组中，并创建一个模板策略，以允许它在您选择的页面模板上以创作模式使用。</p><p id="a740" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在创建一个页面并将组件放在上面，您应该会看到以下内容:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi np"><img src="../Images/0c5872aac4676e3c3aa8c25d29a54fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6Q0wXFCMeoheIYI_EaskA.png"/></div></div></figure><p id="72c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们有了组件，让我们构建没有显示/隐藏功能的编辑对话框。结果如下:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/dd6e03848586c354559ac9b7c9d59ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*Zq-uEJnfQ_qCB2NwkRUV-A.png"/></div></figure><p id="8df6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">节点结构如下所示:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/9482efbdecf4b31fac6851682dda98a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*mwwWRk6HqpsuhxPjZ7jHog.png"/></div></figure><p id="0c96" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是XML:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h1 id="3ba1" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">2.添加显示/隐藏功能</h1><p id="3fb9" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">下一步是根据用户选择的产品类型显示和隐藏某些字段:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nu"><img src="../Images/952f27ffb9dce9774c9af375315f60e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vfXkORqZHkBkbrxD67ZPtQ.png"/></div></div></figure><p id="e9a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了做到这一点，我们需要告诉AEM:</p><ol class=""><li id="7019" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">哪个输入将决定显示或隐藏什么。在我们的例子中，它是<strong class="js iu">产品类型</strong>下拉菜单。</li><li id="ff08" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">哪些字段将对应于下拉列表中的每个输入。</li></ol><p id="1091" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开CRX DE中的productType节点，并添加以下属性:</p><pre class="kq kr ks kt gt nf ng nh ni aw nj bi"><span id="14f8" class="nk lc it ng b gy nl nm l nn no">granite:class - String - cq-dialog-dropdown-showhide</span></pre><p id="c5c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这基本上“激活”了显示/隐藏功能(下面进一步解释)。现在添加一个名为<strong class="js iu"> granite:data </strong>的节点，类型为<strong class="js iu"> nt:unstructured </strong>到<strong class="js iu"> productType </strong>。</p><p id="1530" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将类型为<strong class="js iu">字符串</strong>的a<strong class="js iu">CQ-dialog-drop down-show hide-target</strong>属性添加到<strong class="js iu"> granite:data </strong>节点中。该属性的值可以是您想要的任何值，我选择了<strong class="js iu">。产品类型-显示隐藏-目标</strong>。基本上，这里你提供了一个<a class="ae ko" href="https://www.w3schools.com/cssref/css_selectors.asp" rel="noopener ugc nofollow" target="_blank"> CSS选择器</a>来定位要显示或隐藏的字段。简单地说，这意味着<em class="ne">“显示或隐藏任何带有</em><strong class="js iu"><em class="ne">product type-Show hide-target</em></strong><em class="ne">class</em><strong class="js iu"><em class="ne">”</em>。</strong></p><p id="e706" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们已经告诉AEM <em class="ne">如何</em>显示或隐藏我们的字段，让我们告诉它<em class="ne">哪些</em>字段应该受到影响。您会从步骤1中注意到，每种产品类型有两个字段要显示。我没有每次显示/隐藏两个字段，而是将这些字段分成3个容器(每个容器对应一种产品类型),我们将显示/隐藏这些容器。</p><p id="fa1a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将以下属性添加到<strong class="js iu">电话</strong>、<strong class="js iu">笔记本电脑</strong>和<strong class="js iu">电视</strong>容器节点中:</p><pre class="kq kr ks kt gt nf ng nh ni aw nj bi"><span id="79e9" class="nk lc it ng b gy nl nm l nn no">granite:class - String - productType-showhide-target</span></pre><p id="7502" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您刷新编辑器对话框，您应该会看到除了<strong class="js iu"> productType </strong>下拉列表之外的所有字段都消失了。这是因为我们已经给了AEM<em class="ne">how</em>和<em class="ne"> what </em>，而不是<em class="ne"> when </em>。我们想告诉AEM <em class="ne">“选择选项Y时显示容器X”</em>。</p><p id="5466" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这3个容器下分别添加一个类型为<strong class="js iu"> nt:unstructured </strong>的<strong class="js iu"> granite:data </strong>节点。将以下属性添加到这些节点中:</p><pre class="kq kr ks kt gt nf ng nh ni aw nj bi"><span id="6742" class="nk lc it ng b gy nl nm l nn no">showhidetargetvalue - String - {x}</span></pre><p id="3cd9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中{x}是要与每个容器关联的productType下拉列表的子项的值。例如:对于<strong class="js iu"> phone </strong>容器，<strong class="js iu"> granite:data </strong>节点将包含以下属性:</p><pre class="kq kr ks kt gt nf ng nh ni aw nj bi"><span id="5203" class="nk lc it ng b gy nl nm l nn no">showhidetargetvalue - String - <strong class="ng iu">phone</strong></span></pre><p id="69e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在返回到您的对话框，您应该会看到根据下拉选择出现和消失的字段:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nv"><img src="../Images/fb5234515fc29d23e87578d8ee80a00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Xv7RZX891WyVO1nLUf31gw.gif"/></div></div></figure><p id="35e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是granite的节点结构:数据节点:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/e93641ae4113eb3346191940d81cfdba.png" data-original-src="https://miro.medium.com/v2/resize:fit:294/format:webp/1*MwnmfD48M0vFZnoqZAIHxA.png"/></div></figure><p id="1bd7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是XML:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="0be3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，用以下代码替换<strong class="js iu">dynamicComponent.html</strong>的内容:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="cf21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将导致组件根据产品类型呈现技术规格。</p><blockquote class="nx ny nz"><p id="6539" class="jq jr ne js b jt ju jv jw jx jy jz ka oa kc kd ke ob kg kh ki oc kk kl km kn im bi translated"><strong class="js iu">注意</strong>:如果布尔<strong class="js iu"> hdr </strong>值的处理看起来很奇怪，请查看<a class="ae ko" href="https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/reference-materials/granite-ui/api/jcr_root/libs/granite/ui/components/coral/foundation/form/checkbox/index.html" rel="noopener ugc nofollow" target="_blank">官方花岗岩文档</a> n中的复选框，并查看<a class="ae ko" href="https://gist.github.com/nateyolles" rel="noopener ugc nofollow" target="_blank">Nate yoles</a>的<a class="ae ko" href="https://gist.github.com/nateyolles/e5eed811dc9c35961c23" rel="noopener ugc nofollow" target="_blank">要点</a>。</p></blockquote><h1 id="cfb6" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">说明</h1><p id="0502" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">显示/隐藏功能由<em class="ne">/libs/CQ/GUI/components/authoring/dialog/dropdownshohide/client libs/dropdownshohide/js/dropdownshohide . js</em>脚本实现。</p><p id="56e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该脚本简单地使用CSS选择器从具有目标类的元素中添加或移除<strong class="js iu"> hide </strong>类(在我们的例子中是<strong class="js iu">product type-show hide-target</strong>)。</p><p id="e3fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">属性让我们向一个元素添加类。<strong class="js iu"> granite:data </strong>节点让我们向元素添加<strong class="js iu"> data- </strong>属性。如果您检查<strong class="js iu"> productType </strong> dropdown元素，您会看到这样的效果:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi od"><img src="../Images/256f3b01dd05819eebdb36073420613b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tXhf44zCoWglZuCC_X5sIA.png"/></div></div></figure><p id="9309" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">CQ-dialog-drop down-show hide</strong>类是由<strong class="js iu"> granite:class </strong>属性和<strong class="js iu">data-CQ-dialog-drop down-show hide-target = "添加的。product type-show hide-target "</strong>属性是由<strong class="js iu"> granite:data </strong>节点的<strong class="js iu">data-CQ-dialog-drop down-show hide-target</strong>属性添加的。</p><p id="40b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">需要记住的一件重要事情是，字段的显示/隐藏纯粹是UI的事情，<em class="ne">对JCR </em>没有任何影响，这意味着如果您隐藏了<strong class="js iu"> tv </strong>容器的<strong class="js iu"> hdr </strong>和<strong class="js iu">分辨率</strong>字段，然后再隐藏它们，您的组件将仍然具有<strong class="js iu"> hdr </strong>和<strong class="js iu">分辨率</strong>属性。在实现组件时，不要忘记处理这种可能性。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="73c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在这里找到这个教程<a class="ae ko" href="https://github.com/theopendle/aem-dynamic-dialog-fields" rel="noopener ugc nofollow" target="_blank">的源代码。</a></p><p id="3a56" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想下载并安装本教程第一步或第二步的软件包，你可以在这里找到它们。</p></div></div>    
</body>
</html>