<html>
<head>
<title>An Easy Method To Set Up Android CI/CD Workflows In GitHub Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在GitHub Actions中设置Android CI/CD工作流的简单方法</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/an-easy-method-to-set-up-android-ci-cd-workflows-in-github-actions-bfff5f197d2b?source=collection_archive---------9-----------------------#2022-08-03">https://levelup.gitconnected.com/an-easy-method-to-set-up-android-ci-cd-workflows-in-github-actions-bfff5f197d2b?source=collection_archive---------9-----------------------#2022-08-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="041d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">今天我分享我是如何在GitHub Actions中为一个Android项目实现CI/CD工作流的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7aa9a095ecec75afd0166806e633b536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w7rTOX70vt1Yqlbz"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@synkevych?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">罗曼·辛克维奇·🇺🇦</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="60d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">当开发软件时，测试的价值是不可估量的。不仅在更改了小部分代码或整个组件后更容易找到bug，而且有了代码覆盖率，它给了开发团队额外的信心，带来了所有的好处。</p><p id="2652" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近在我的工作中，我被分配了一些特别适合DevOps职位的任务，虽然我专门从事移动开发，但了解每个领域都是有好处的。</p><p id="7eee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我一直在与Jenkins一起开发一些CI/CD管道，以便在Firebase测试实验室中运行单元和仪器测试，并生成不同的应用程序变体，aab和apk，准备发布到商店或通过Firebase应用程序分发功能自动上传。</p><p id="7b76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jenkins虽然很棒，但是主要用的是bash脚本，大家都知道，网上到处都有资源。这提供了很多定制，但我想为我的个人项目尝试GitHub动作，因为我真的不需要太大的东西，大多数时候我更喜欢简单。</p><h1 id="6087" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">让我们从一些重要的信息开始</h1><p id="4d1f" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">GitHub Actions是一个允许开发人员更容易实现CI/CD管道的系统，特别是对于初学者，例如，与前面提到的Jenkins相比。</p><p id="2cd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它提供已经配置为使用Linux、Windows和Mac的机器，但根据机器的不同，免费时间有限。对于较小的项目，我认为这是一个很好的起点，特别是如果你只需要Linux，这是最便宜的。</p><p id="204f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它的基本工作原理是使用一个YAML文件来指示机器将要执行什么操作。该文件存储在项目存储库中，位于存储库根目录下的<code class="fe nb nc nd ne b">.github/workflows</code>文件夹中。</p><p id="cec0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitHub还为GitHub操作可以访问的密钥提供存储。例如，在一个Android项目中，如果需要对APK或AAB文件进行签名，并且密钥需要被混淆并且在存储库文件中不可用，那么这一点就很重要，这样就没有人能够窃取它们。</p><h1 id="a456" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">代码</h1><p id="e1a6" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">如前所述，我们需要一个主要由三部分组成的YAML文件。</p><ul class=""><li id="3a63" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">工作流名称</li><li id="a317" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">触发条件</li><li id="bf08" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">要做的工作</li></ul><p id="f0a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">工作流名称将显示在GitHub存储库的Actions选项卡中的工作流摘要中，如下图所示，位于触发工作流的提交消息下方。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/fb3ce471677a6f1a726ee37d4241fead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y5mJmnqrwq_iAlfOSHsTLg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">工作流摘要</figcaption></figure><p id="ff43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">触发器可以配置为在不同的情况下工作。在这个例子中，我展示了如果我们想要对主分支上的推送进行操作，它是如何完成的，但是它是超级可配置的。你可以在这里勾选所有选项<a class="ae ky" href="https://docs.github.com/en/github-ae@latest/actions/using-workflows/events-that-trigger-workflows" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/0614331e93206e19b2f678fbea464b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*KErHwuw7UScZphxcWaiaRg.jpeg"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">触发条件</figcaption></figure><p id="c993" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作业部分是我们指定要使用的机器和要做的工作的地方。您可以同时运行两个作业，也可以按顺序运行它们，以便一个作业依赖于另一个作业。</p><p id="928b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的示例中，您可以看到我如何配置一个构建Android应用程序并运行单元测试的作业。如果这些成功了，一个发布的AAB将被编译并作为一个可下载的工件更新到存储库中。</p><p id="d965" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于作业，您可以直接在机器上运行Gradle命令，或者使用其他用户开发的GitHub操作。在本例中，我使用这两个选项向您展示这是可能的，有时这样做比我们自己运行整个命令更容易。</p><p id="143b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他用户开发的GitHub动作从我们可以在GitHub配置文件中设置的秘密中获取密钥来签署应用程序，并输出准备发布到商店的文件。如果你知道GitHub的秘密，设置起来超级容易，但是如果你不知道，你可以查看<a class="ae ky" href="https://github.com/r0adkll/sign-android-release" rel="noopener ugc nofollow" target="_blank">这个库</a>来学习如何实现这个。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/ef4babb348f46c3b210188269d7d8e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1CJz32psUr8C4PRJJgBIMg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">签署AAB</figcaption></figure><p id="6850" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想快速复制粘贴，我会在这里留下GitHub的要点和完整的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h1 id="d81f" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="c1cf" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">根据我的经验，我认为我更喜欢Jenkins，因为我不需要专门在GitHub中拥有存储库，我也喜欢bash脚本来定义CI/CD管道的步骤，并且我不局限于GitHub为机器提供的价格，我可以评估其他选项。</p><p id="8164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但如果项目较小，我不会考虑如何扩展它，我也不想考虑Docker和Jenkins配置，这可能会令人头痛，GitHub Actions是最佳选择。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="f567" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想阅读更多这样的内容，并支持我，不要忘记检查我的个人资料，或给媒体一个机会，成为会员，以获得我和其他作家的无限故事。每月只有5美元，如果你使用这个<a class="ae ky" href="https://medium.com/@molidev8/membership" rel="noopener">链接</a>，我会得到一小笔佣金。</p><div class="of og gp gr oh oi"><a href="https://medium.com/@molidev8/membership" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">通过我的推荐链接加入Medium—Miguel</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">阅读米格尔的每一个故事(以及媒体上成千上万的其他作家)。你的会员费直接支持米盖尔…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">medium.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow ks oi"/></div></div></a></div></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="2027" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="493a" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="098e" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>中的更多内容</li><li id="05b5" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="6e31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入升级人才集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>