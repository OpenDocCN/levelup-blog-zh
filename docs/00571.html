<html>
<head>
<title>Pull to refresh animation with Vanilla JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用普通的JavaScript拉动以刷新动画</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/pull-to-refresh-animation-with-vanilla-javascript-6574d7c4ad24?source=collection_archive---------2-----------------------#2019-05-12">https://levelup.gitconnected.com/pull-to-refresh-animation-with-vanilla-javascript-6574d7c4ad24?source=collection_archive---------2-----------------------#2019-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi jx"><img src="../Images/14ae5ed24c0e19c2244a2f3e05863bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bFYHQKU0140m7xHlpp_TJQ.jpeg"/></div></div><figcaption class="kj kk gj gh gi kl km bd b be z dk translated">照片由<a class="ae kn" href="https://www.pexels.com/photo/bokeh-photography-of-person-holding-turned-on-iphone-1440727/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kn" href="https://www.pexels.com/@daria?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Daria Shevtsova </a>拍摄</figcaption></figure><p id="257e" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">拉动刷新是智能手机上非常流行的滑动手势，允许用户在数据列表上加载新内容。它被用于大多数流行的智能手机应用程序和网络应用程序中，已经成为UX的一个主要部分。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/046c4e01a1f8bf1182d356f302326f85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*LQyAh34n_sk4jTmAbGvF5A.gif"/></div><figcaption class="kj kk gj gh gi kl km bd b be z dk translated"><a class="ae kn" href="https://codepen.io/Vijit_Ail/full/pmbypw" rel="noopener ugc nofollow" target="_blank">https://codepen.io/Vijit_Ail/full/pmbypw</a>(打开devtools尝试动画)</figcaption></figure></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><p id="a100" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">几天前我在<a class="ae kn" href="https://dribbble.com/shots/4963449-Pull-to-Refresh-Animation" rel="noopener ugc nofollow" target="_blank"> dribbble </a>上看到了上面的动画，所以我想我应该拿出我的版本。</p><p id="ce2d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">你猜怎么着，我设法不用库或jQuery插件，只用普通的JavaScript就完成了这个。😎</p><p id="85d8" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一个非常简单的标记——一个顶部装载容器，它将包含装载器和一堆卡片。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi ln"><img src="../Images/fad8f15295b04f6d5be9c7d1bad0def8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Ih6pqytK38ZhOJ_anWDuw.png"/></div></div></figure><p id="2630" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们开始有趣的事情吧😁。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi ln"><img src="../Images/10614ff27f8cee60614baec52f555c56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BuVmdgooGuq8bNUs97wDOw.png"/></div></div></figure><p id="ab4e" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个想法是默认隐藏加载容器，当用户向下滑动时向下滑动。<code class="fe lo lp lq lr b"><strong class="kq iu">transform-style : preserve-3d</strong></code> <strong class="kq iu"> </strong>将使卡片能够在3D空间中定位，并且卡片包装上的<strong class="kq iu">透视</strong>属性将决定用户将如何从他们的视角观看；较低的值将产生更强烈的3D效果。<em class="ls">注意</em>透视图没有在子元素上设置。<a class="ae kn" href="https://3dtransforms.desandro.com/" rel="noopener ugc nofollow" target="_blank">关于CSS 3D动画和变换的更多信息</a>。</p><p id="0bbf" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这就是我们需要的所有CSS。现在让我们开始添加滑动手势。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi ln"><img src="../Images/4ea3d29fd3efc0abb4d2083a17ad7c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpDoJNqjDREy9U5uXE2Kxw.png"/></div></div></figure><p id="ec80" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">JS中的触摸事件由触摸事件监听器处理。这些事件类似于鼠标事件，只是它们允许在触摸表面上进行多次触摸。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi ln"><img src="../Images/06d9fa5840182717f2c6802c81f83c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qtypiV59daSkoDAdaZ3VBQ.png"/></div></div></figure><p id="a623" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe lo lp lq lr b">pStart</code>和<code class="fe lo lp lq lr b">pCurrent</code>对象将存储开始和当前触摸的触摸位置。我们需要这些来找到Y坐标的变化，来计算卡片的旋转。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi ln"><img src="../Images/cdec64706f220eb6fb790ec3d06ac3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5HSwcCE7va1TREQ-Rj4u7w.png"/></div></div></figure><p id="7772" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在<code class="fe lo lp lq lr b">swipeStart()</code>函数中，我们将捕捉触摸坐标并将其分配给<code class="fe lo lp lq lr b">pStart</code>对象。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi lt"><img src="../Images/aead91706004a3c2b0eef0db68a58072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_yDlEjxwPY82fVqm90JnmQ.png"/></div></div></figure><p id="ede4" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在<code class="fe lo lp lq lr b">swipe()</code>函数中，我们用当前触摸坐标设置<code class="fe lo lp lq lr b">pCurrent</code>对象。下一步是找到开始位置和当前Y位置之间的差异，以计算滑动的距离，并基于30%的距离进行旋转。只有当距离大于100时，装载容器才会出现。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi lu"><img src="../Images/14f2e18059108bb21409db4115da1564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vl8xswbts96XM06u5CtQlA.png"/></div></div></figure><p id="67d1" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果触摸已经开始，但没有启用加载，则<code class="fe lo lp lq lr b">swipeEnd()</code>功能将取消旋转。</p><figure class="jy jz ka kb gt kc gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi ln"><img src="../Images/46863a10d4e81cd21e8d89c7cc9674d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cdXAjW9Ge8RMSZl7afiOPg.png"/></div></div></figure><p id="7b46" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在加载时，加载容器将向下滑动2秒钟，用于本演示，但在实际示例中，根据服务器的响应，这可能需要更多或更少的时间。一旦装载完成，装载容器和卡片将移回到初始状态。</p><p id="a96c" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我从<a class="ae kn" href="https://stackoverflow.com/questions/46190436/how-to-detect-pull-to-refresh" rel="noopener ugc nofollow" target="_blank">这个</a> stackoverflow问题中引用了JavaScript。</p><p id="099b" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我的<a class="ae kn" href="https://codepen.io/Vijit_Ail/pen/pmbypw" rel="noopener ugc nofollow" target="_blank"> codepen </a>中的完整源代码。打开devtools查看动画效果。</p></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><p id="1fa1" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我希望你今天能学到一些新东西😄。如果您有任何问题或对改进代码有任何建议，请随时写下您的回复。</p><p id="ef3b" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">干杯，快乐编码🍻 ✌</p></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><div class="jy jz ka kb gt lv"><a href="https://gitconnected.com/learn/javascript" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd iu gy z fp ma fr fs mb fu fw is bi translated">学习JavaScript -最佳JavaScript教程(2019) | gitconnected</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">68大JavaScript教程-免费学习JavaScript。课程由开发人员提交并投票，从而实现…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">gitconnected.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kh lv"/></div></div></a></div></div></div>    
</body>
</html>