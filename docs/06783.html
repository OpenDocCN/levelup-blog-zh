<html>
<head>
<title>Working with the Array Data Type in PostgreSQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在PostgreSQL中使用数组数据类型</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/working-with-the-array-data-type-in-postgresql-1e6fecdb51fe?source=collection_archive---------1-----------------------#2020-12-31">https://levelup.gitconnected.com/working-with-the-array-data-type-in-postgresql-1e6fecdb51fe?source=collection_archive---------1-----------------------#2020-12-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b387" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据库提示</h2><div class=""/><div class=""><h2 id="38ad" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">创建、获取(作为列表和行)、修改、添加和删除数组中的数据</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi kr"><img src="../Images/8b1c63f93d6cf241fc2d77b857ce89e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*A_Ef98cGWvgBCjhuisZWiQ.png"/></div></figure><p id="1cc1" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PostgreSQL是一个开源的关系数据库，支持一些惊人的数据类型。在以前的文章中，我们看到了<a class="ae lv" rel="noopener ugc nofollow" target="_blank" href="/working-with-a-jsonb-array-of-objects-in-postgresql-d2b7e7f4db87">在jsonb数据类型</a>上执行类似CRUD的操作，以及将一个<a class="ae lv" rel="noopener ugc nofollow" target="_blank" href="/how-to-query-a-json-array-of-objects-as-a-recordset-in-postgresql-a81acec9fbc5"> jsonb对象数组转换成一个记录集</a>以便于查询。</p><h1 id="fe1e" class="lw lx it bd ly lz ma mb mc md me mf mg ki mh kj mi kl mj km mk ko ml kp mm mn bi translated">我们将做什么</h1><p id="a8bd" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在本文中，我想关注另一种数据类型，即<strong class="lb jd">数组</strong>数据类型。为什么？因为数组对于至少存储列表来说是很棒的。文本、数字等列表。</p><blockquote class="mt mu mv"><p id="27f5" class="kz la mw lb b lc ld kd le lf lg kg lh mx lj lk ll my ln lo lp mz lr ls lt lu im bi translated">数组类型</p><p id="23bb" class="kz la mw lb b lc ld kd le lf lg kg lh mx lj lk ll my ln lo lp mz lr ls lt lu im bi translated">PostgreSQL提供了将表中的列定义为可变长度的一维或多维数组的机会。可以创建任何内置或用户定义的基类型、枚举类型或复合类型的数组。</p></blockquote><blockquote class="na"><p id="4248" class="nb nc it bd nd ne nf ng nh ni nj lu dk translated">我们将特别关注一种数据类型，即文本数组<strong class="ak"> text[] </strong>。</p></blockquote><p id="473f" class="pw-post-body-paragraph kz la it lb b lc nk kd le lf nl kg lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">如果您使用pgAdmin的表创建工具，您还会看到其他数据类型的数组:text，text[]；integer，integer[]，bit，bit[]，等等。</p><p id="817c" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb jd">具体将探讨如何，</strong></p><ul class=""><li id="9426" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">创建一个数组。</li><li id="7846" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">向数组中输入值。</li><li id="8fbd" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">以列表和行的形式从数组中获取数据。</li><li id="3d57" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">通过在数组中添加和删除数据来修改数组。</li></ul><p id="3022" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mw">类似CRUD的操作。</em></p><p id="16bc" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb jd">重要提示</strong> : <em class="mw">您可能习惯于在JavaScript或其他编程语言中使用数组。在这些情况下，数组通常是从0开始的。第一项的索引为0。</em></p><blockquote class="na"><p id="a451" class="nb nc it bd nd ne od oe of og oh lu dk translated">在PostgreSQL中，数组是从1开始的。第一项的索引为1。</p></blockquote></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="a897" class="lw lx it bd ly lz op mb mc md oq mf mg ki or kj mi kl os km mk ko ot kp mm mn bi translated">假设</h1><p id="9d16" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我假设你有<a class="ae lv" href="https://www.postgresql.org/" rel="noopener ugc nofollow" target="_blank"> PostgreSQL </a>和类似<a class="ae lv" href="https://www.pgadmin.org/" rel="noopener ugc nofollow" target="_blank"> pgAdmin </a>的东西。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="a345" class="lw lx it bd ly lz op mb mc md oq mf mg ki or kj mi kl os km mk ko ot kp mm mn bi translated">我们开始吧！</h1><h1 id="e8e2" class="lw lx it bd ly lz ma mb mc md me mf mg ki mh kj mi kl mj km mk ko ml kp mm mn bi translated">构建具有数组数据类型的表</h1><p id="58ae" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们将创建一个人和他们拥有的汽车的表。汽车列表将是一个文本数组。</p><ol class=""><li id="590f" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu ou nv nw nx bi translated">打开<strong class="lb jd"> pgAdmin </strong>并创建一个数据库。根据需要命名。</li><li id="2ba1" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu ou nv nw nx bi translated">右击数据库名称，选择<strong class="lb jd">查询工具</strong>。</li></ol><p id="b42b" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.输入下面的代码并执行它来构建我们的<strong class="lb jd"> people_cars </strong>表。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="e54e" class="pa lx it ow b gy pb pc l pd pe">CREATE TABLE people_cars (<br/> id Serial Primary Key NOT NULL,<br/> person Varchar(50) NOT NULL,<br/><strong class="ow jd"> cars text[]</strong><br/>);</span></pre><p id="f3e5" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意<strong class="lb jd">文本[] </strong>数据类型。[]告诉PostgresSQL您需要一个数组。</p><p id="2c52" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个<strong class="lb jd"> <em class="mw">备选</em> </strong>语法如果你想试试的话会是，</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="1819" class="pa lx it ow b gy pb pc l pd pe">DROP TABLE people_cars;</span><span id="d389" class="pa lx it ow b gy pf pc l pd pe">CREATE TABLE people_cars (<br/> id Serial Primary Key NOT NULL,<br/> person Varchar(50) NOT NULL,<br/><strong class="ow jd"> cars text ARRAY</strong><br/>);</span></pre><blockquote class="na"><p id="3c94" class="nb nc it bd nd ne nf ng nh ni nj lu dk translated">我最初使用text[]语法是因为如果您要使用pgAdmin的表创建工具，这是您会选择的。</p></blockquote><p id="9dcc" class="pw-post-body-paragraph kz la it lb b lc nk kd le lf nl kg lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated"><em class="mw">使用SQL构建表的一个优点是可以指定一个多维数组，比如</em> <strong class="lb jd"> <em class="mw"> text[][] </em> </strong> <em class="mw">。我们将继续关注一维数组，并在工作中使用SQL。</em></p><p id="e9c3" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样值得注意的是，您可以指定数组的大小，text[4]。<strong class="lb jd">但是PostgreSQL忽略了大小。</strong></p><h1 id="ae30" class="lw lx it bd ly lz ma mb mc md me mf mg ki mh kj mi kl mj km mk ko ml kp mm mn bi translated">将数据插入数组</h1><p id="9dfb" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在我们已经有了一个可以接受列表的表，我们将想要向其中插入数据。</p><p id="2f61" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用SQL向数组中插入数据有两种不同的语法。</p><p id="d36c" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些是，</p><ol class=""><li id="3f64" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu ou nv nw nx bi translated">{ "第1项"，"第2项"，"第3项" } '</li><li id="4eed" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu ou nv nw nx bi translated">数组['项目1 '，'项目2 '，'项目3']</li></ol><p id="607d" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mw">注意在第二个例子中，我们用括号代替大括号，用单引号代替双引号。</em></p><ol class=""><li id="43d3" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu ou nv nw nx bi translated">输入下面的代码并执行它，为Bob创建一个汽车列表。</li></ol><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="f22f" class="pa lx it ow b gy pb pc l pd pe">INSERT INTO people_cars (person, cars)<br/>VALUES ('Bob', <br/>'{"Ferrari", "Lamborghini", "Lexus LX470"}'<br/>);</span></pre><p id="6c88" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并使用<strong class="lb jd"> <em class="mw">的第二个语法</em> </strong>来表示卡罗尔的汽车。执行下面的代码。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="37e3" class="pa lx it ow b gy pb pc l pd pe">INSERT INTO people_cars (person, cars)<br/>VALUES ('Carol', <br/><strong class="ow jd">ARRAY</strong>['BMW', 'Lexus LX470', 'Tesla']<br/>);</span></pre><p id="5e38" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.现在，让我们通过执行以下代码来查看数据。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="28a0" class="pa lx it ow b gy pb pc l pd pe">SELECT * FROM people_cars;</span></pre><p id="172b" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会得到，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/37a02b8952726ef9dd8e6f9e539b89a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*jS8EeQJPKYkLVHrTbvc4Vw.jpeg"/></div><figcaption class="ph pi gj gh gi pj pk bd b be z dk translated">一排排汽车</figcaption></figure></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><p id="f155" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您仔细观察，您会发现，不管语法如何，<strong class="lb jd"> PostgreSQL在包含空格的条目周围加上了双引号</strong>。这不是错误，也不是问题。当我们选择该特定值时，它们会被删除，我们稍后会看到。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="28fd" class="lw lx it bd ly lz op mb mc md oq mf mg ki or kj mi kl os km mk ko ot kp mm mn bi translated">选择数组数据</h1><p id="ce9a" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">一旦阵列中有了数据，我们当然会希望访问全部或部分数据。</p><p id="056c" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mw">我们已经看到了如何使用SELECT *(或仅选择汽车)。</em></p><p id="1ccf" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们专注于选择我们想要的特定数据。</p><ol class=""><li id="a8cd" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu ou nv nw nx bi translated">假设我们想要每个人的第一辆汽车。执行下面的代码。</li></ol><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="dc71" class="pa lx it ow b gy pb pc l pd pe">SELECT cars[1] FROM people_cars;</span></pre><p id="10fd" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.假设我们想要卡罗尔的第二辆车，雷克萨斯LX470。执行下面的代码。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="e959" class="pa lx it ow b gy pb pc l pd pe">SELECT cars[2] FROM people_cars<br/>WHERE person='Carol';</span></pre><p id="7223" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mw">注意数组条目两边的双引号被移除了。</em></p><h2 id="ca02" class="pa lx it bd ly pl pm dn mc pn po dp mg li pp pq mi lm pr ps mk lq pt pu mm iz bi translated">选择范围</h2><p id="2d8f" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们也可以通过使用，<strong class="lb jd">起始索引:结束索引来指定数据项的范围。你也可以省略起始或结束索引。</strong></p><p id="cc13" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行以下每个示例。</p><p id="efaa" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拿到卡罗尔的前两辆车，宝马和雷克萨斯LX470。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="e3d7" class="pa lx it ow b gy pb pc l pd pe">SELECT cars[1:2] FROM people_cars<br/>WHERE person='Carol';</span></pre><p id="247e" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者相当于，</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="60c7" class="pa lx it ow b gy pb pc l pd pe">SELECT cars[:2] FROM people_cars<br/>WHERE person='Carol';</span></pre><p id="4fa1" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拿到卡萝尔的最后两辆车，雷克萨斯LX470和特斯拉。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="4113" class="pa lx it ow b gy pb pc l pd pe">SELECT cars[2:3] FROM people_cars<br/>WHERE person='Carol';</span></pre><p id="2818" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者相当于，</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="22f1" class="pa lx it ow b gy pb pc l pd pe">SELECT cars[2:] FROM people_cars<br/>WHERE person='Carol';</span></pre><p id="211f" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是等等！如果我想要行中的数组数据怎么办？</p><h2 id="0ee2" class="pa lx it bd ly pl pm dn mc pn po dp mg li pp pq mi lm pr ps mk lq pt pu mm iz bi translated">不需要救援</h2><p id="c2bf" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要将某人的汽车列表显示为行而不仅仅是列表，使用<strong class="lb jd"> UNNEST </strong>操作符。</p><p id="4206" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">找到卡罗尔所有的车，每辆都列在各自的行上。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="4a6d" class="pa lx it ow b gy pb pc l pd pe">SELECT <strong class="ow jd">UNNEST</strong>(cars) FROM people_cars<br/>WHERE person='Carol';</span></pre><h1 id="da35" class="lw lx it bd ly lz ma mb mc md me mf mg ki mh kj mi kl mj km mk ko ml kp mm mn bi translated">修改数组数据</h1><p id="3785" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在我们有了数据并可以提取它，我们希望能够从数组中更新、添加和删除数据。</p><p id="944e" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行以下每个步骤。使用SELECT在每次执行后检查数据。</p><h2 id="cdb7" class="pa lx it bd ly pl pm dn mc pn po dp mg li pp pq mi lm pr ps mk lq pt pu mm iz bi translated">更新整个数组</h2><p id="aa8f" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在这里我们把<strong class="lb jd"> <em class="mw">全部换成卡罗尔的</em> </strong>。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="08a8" class="pa lx it ow b gy pb pc l pd pe">UPDATE people_cars<br/>SET cars = ARRAY['Mazda','Honda CRV','Toyota Corolla','Volkswagen']<br/>WHERE person = 'Carol';</span></pre><h2 id="c8ea" class="pa lx it bd ly pl pm dn mc pn po dp mg li pp pq mi lm pr ps mk lq pt pu mm iz bi translated">更新单个条目</h2><p id="0216" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这里我们替换卡萝尔的<strong class="lb jd">第三辆</strong>车(错别字故意。)</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="5ce0" class="pa lx it ow b gy pb pc l pd pe">UPDATE people_cars<br/>SET cars[3] = 'Toyota Camy'<br/>WHERE person = 'Carol';</span></pre><p id="5779" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以为此使用一个PostgreSQL函数，<strong class="lb jd"> array_replace() </strong>如下将Toyota Camy改为Toyota Camry。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="cc3d" class="pa lx it ow b gy pb pc l pd pe">UPDATE people_cars<br/>SET cars = array_replace(cars, 'Toyota Camy', 'Toyota Camry')<br/>WHERE person = 'Carol';</span></pre><h2 id="e070" class="pa lx it bd ly pl pm dn mc pn po dp mg li pp pq mi lm pr ps mk lq pt pu mm iz bi translated">更新数组中的连续条目</h2><p id="e4c9" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这里我们要同时为Carol更换<em class="mw">第二辆</em>和<em class="mw">第三辆</em>汽车。为此，我们需要提供ARRAY关键字。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="f010" class="pa lx it ow b gy pb pc l pd pe">UPDATE people_cars<br/>SET cars[2:3] = ARRAY['Tesla','Ford F150']<br/>WHERE person = 'Carol';</span></pre><h1 id="6b77" class="lw lx it bd ly lz ma mb mc md me mf mg ki mh kj mi kl mj km mk ko ml kp mm mn bi translated">数组函数</h1><p id="cf11" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要在数组中添加和删除数据，最简单的方法是使用数组函数。</p><h2 id="7748" class="pa lx it bd ly pl pm dn mc pn po dp mg li pp pq mi lm pr ps mk lq pt pu mm iz bi translated">向数组中添加数据</h2><ul class=""><li id="c143" class="np nq it lb b lc mo lf mp li pv lm pw lq px lu nu nv nw nx bi translated">要将数据追加到数组的末尾，使用<strong class="lb jd"> array_append </strong>()函数。</li><li id="94cf" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">要将数据添加到数组的开头，使用<strong class="lb jd"> array_prepend </strong>()函数。</li></ul><p id="0f6b" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Bob的汽车列表末尾添加一辆汽车。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="c316" class="pa lx it ow b gy pb pc l pd pe">UPDATE people_cars<br/>SET cars = <strong class="ow jd">array_append</strong>(<strong class="ow jd">cars</strong>, 'GTO')<br/>WHERE person = 'Bob';</span></pre><p id="62be" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Bob的汽车列表的开头添加一辆汽车。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="157e" class="pa lx it ow b gy pb pc l pd pe">UPDATE people_cars<br/>SET cars = <strong class="ow jd">array_prepend</strong>('Toyota', <strong class="ow jd">cars</strong>)<br/>WHERE person = 'Bob';</span></pre><p id="bfc4" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mw">注意到数组字段的名称cars位于append的开头，位于prepend的结尾。</em></p><h2 id="9827" class="pa lx it bd ly pl pm dn mc pn po dp mg li pp pq mi lm pr ps mk lq pt pu mm iz bi translated">从数组中删除数据</h2><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="1385" class="pa lx it ow b gy pb pc l pd pe">UPDATE people_cars<br/>SET cars = <strong class="ow jd">array_remove</strong>(cars, 'Honda CRV')<br/>WHERE person = 'Bob';</span></pre><h1 id="0f30" class="lw lx it bd ly lz ma mb mc md me mf mg ki mh kj mi kl mj km mk ko ml kp mm mn bi translated">结论</h1><p id="2f50" class="pw-post-body-paragraph kz la it lb b lc mo kd le lf mp kg lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在本教程中，我们探索了数组数据类型的基础。如何构造数组类型的列，从数组中获取数据，替换数组中的数据，向数组中添加数据以及从数组中移除数据。基本上执行类似CRUD的操作。</p><p id="1f92" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们能做得更多吗？当然可以。下面是PostgreSQL数组文档的链接。在那里，您将找到用于操作和搜索数组的附加函数和操作符。</p><p id="3f15" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae lv" href="https://www.postgresql.org/docs/current/functions-array.html" rel="noopener ugc nofollow" target="_blank"> PostgreSQL数组函数和运算符</a></p><p id="ddd8" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb jd">感谢您的阅读和编码！</strong></p><p id="3e9c" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mw">想看就看，加入Medium帮我继续写</em></p><div class="py pz gp gr qa qb"><a href="https://bobtomlin-70659.medium.com/membership" rel="noopener follow" target="_blank"><div class="qc ab fo"><div class="qd ab qe cl cj qf"><h2 class="bd jd gy z fp qg fr fs qh fu fw jc bi translated">通过我的推荐链接加入灵媒——重力井(罗伯·汤姆林)</h2><div class="qi l"><h3 class="bd b gy z fp qg fr fs qh fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="qj l"><p class="bd b dl z fp qg fr fs qh fu fw dk translated">bobtomlin-70659.medium.com</p></div></div><div class="qk l"><div class="ql l qm qn qo qk qp kx qb"/></div></div></a></div><p id="f18a" class="pw-post-body-paragraph kz la it lb b lc ld kd le lf lg kg lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以享受，</p><div class="py pz gp gr qa qb"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-query-a-json-array-of-objects-as-a-recordset-in-postgresql-a81acec9fbc5"><div class="qc ab fo"><div class="qd ab qe cl cj qf"><h2 class="bd jd gy z fp qg fr fs qh fu fw jc bi translated">如何在PostgreSQL中将JSONB对象数组作为记录集进行查询</h2><div class="qi l"><h3 class="bd b gy z fp qg fr fs qh fu fw dk translated">使用jsonb_to_recordset()函数将对象数组转换为行</h3></div><div class="qj l"><p class="bd b dl z fp qg fr fs qh fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="qk l"><div class="qq l qm qn qo qk qp kx qb"/></div></div></a></div><div class="py pz gp gr qa qb"><a rel="noopener  ugc nofollow" target="_blank" href="/working-with-a-jsonb-array-of-objects-in-postgresql-d2b7e7f4db87"><div class="qc ab fo"><div class="qd ab qe cl cj qf"><h2 class="bd jd gy z fp qg fr fs qh fu fw jc bi translated">在PostgreSQL中使用JSONB对象数组</h2><div class="qi l"><h3 class="bd b gy z fp qg fr fs qh fu fw dk translated">从数组中获取、添加和移除JSON对象</h3></div><div class="qj l"><p class="bd b dl z fp qg fr fs qh fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="qk l"><div class="qr l qm qn qo qk qp kx qb"/></div></div></a></div></div></div>    
</body>
</html>