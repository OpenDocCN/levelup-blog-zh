# Python ä¸­çš„ç†ŠçŒ«æ•°æ®é€è§†è¡¨æŒ‡å—

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/pivot-tables-in-pandas-7b672e6d8f47>

## å¦‚ä½•åœ¨ Python ä¸­ä½¿ç”¨ç†ŠçŒ«æ•°æ®é€è§†è¡¨ï¼Ÿ

![](img/1ddcc431e89bf1c296ed72b891a9b8ec.png)

å¨å»‰Â·è‰¾æ–‡åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

æ•°æ®åˆ†æçš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†æ˜¯å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ã€æ€»ç»“ã€æ±‡æ€»å’Œè®¡ç®—ç»Ÿè®¡çš„è¿‡ç¨‹ã€‚**ç†ŠçŒ«æ•°æ®é€è§†è¡¨æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·æ¥ç”¨ Python æ‰§è¡Œè¿™äº›åˆ†ææŠ€æœ¯ã€‚**æœ‰æ—¶æ•°æ®é€è§†è¡¨å’Œåˆ†ç»„ä¾æ®ä¹‹é—´çš„åŒºåˆ«ä»¤äººå›°æƒ‘ã€‚æ‚¨å¯ä»¥å°†æ•°æ®é€è§†è¡¨è§†ä¸ºå¤šç»´å½¢å¼çš„åˆ†ç»„ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘å°†åœ¨è¿™ç¯‡æ–‡ç« ä¸­è§£é‡Šä»¥ä¸‹ä¸»é¢˜ã€‚

*   ä»€ä¹ˆæ˜¯ groupby æ–¹æ³•ï¼Ÿ
*   pivot_table å’Œ groupby æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
*   å¦‚ä½•ä½¿ç”¨ pivot_tableï¼Ÿ
*   ä»€ä¹ˆæ˜¯å¤šçº§é€è§†è¡¨ï¼Ÿ
*   ä»€ä¹ˆæ˜¯äº¤å‰è¡¨ï¼Ÿ
*   å¦‚ä½•ç”¨çœŸå®æ•°æ®é›†åšä¸€ä¸ªæ ·æœ¬åº”ç”¨ï¼Ÿ

åœ¨å¼€å§‹ä¹‹å‰ï¼Œåˆ«å¿˜äº†è®¢é˜…[æˆ‘çš„ youtube é¢‘é“](https://youtube.com/c/tirendazacademy)ï¼Œæˆ‘åœ¨é‚£é‡Œåˆ›å»ºå…³äºäººå·¥æ™ºèƒ½ã€æ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„å†…å®¹ã€‚

# ä»€ä¹ˆæ˜¯ groupby æ–¹æ³•ï¼Ÿ

ä¸ºäº†è§£é‡Š groupbyï¼Œè®©æˆ‘ä»¬å¯¼å…¥ Pandas å’Œ NumPy åº“ã€‚

![](img/a93e035ae848873a04ec9df197d07652.png)

ä¸ºäº†å±•ç¤ºç†ŠçŒ«æ•°æ®é€è§†è¡¨ï¼Œè®©æˆ‘åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ã€‚

![](img/da8d31beca63c14fad363b822d4b4067.png)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ•°æ®é›†ã€‚

![](img/8e0040d7a0c63fa5a87551b56c7dd2b5.png)

æ­£å¦‚æˆ‘åœ¨è¿™ç¯‡æ–‡ç« ä¸­è§£é‡Šçš„ï¼Œä½ å¯ä»¥ç”¨ groupby æ–¹æ³•å¯¹ç±»åˆ«è¿›è¡Œåˆ†ç»„ã€‚è®©æˆ‘å±•ç¤ºç»™ä½ çœ‹ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æ ¹æ®è¯¾ç¨‹çš„ç±»åˆ«è¿›è¡Œåˆ†ç»„ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ ¹æ®è¿™ä¸€è¯¾æ æ‰¾å‡ºå¹³å‡åˆ†æ•°ã€‚

![](img/7e383793c6c156249ca5ba3adca2da88.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†è·å¾—ä¸€ä¸ªåˆ†ç±»åˆ—ï¼Œå¹¶æ ¹æ®è¿™ä¸¤ä¸ªåˆ†ç±»åˆ—çš„å€¼æ‰¾åˆ°å¹³å‡å€¼ã€‚

![](img/9045c3f0e72199c87ba6ca3a1ee85bd0.png)

# pivot_table å’Œ groupby æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

groupby æ–¹æ³•ä¸€èˆ¬å¯¹äºäºŒç»´æ“ä½œå°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯ pivot_table ç”¨äºå¤šç»´åˆ†ç»„æ“ä½œã€‚

# å¦‚ä½•ä½¿ç”¨ pivot_tableï¼Ÿ

DataFrame æœ‰ä¸€ä¸ª pivot_table æ–¹æ³•ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ pivot_table åˆ›å»ºæˆ‘ä»¬ç”¨ groupby åˆ›å»ºçš„è¡¨ã€‚

![](img/5433ccf02ba72208858aa603f004bea6.png)

ç»™ä½ ã€‚ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å±‚æ¬¡ç´¢å¼•çš„æ•°æ®é€è§†è¡¨ã€‚

![](img/597d3ae526c06d81c6df5d5a6afaa658.png)

è¯·æ³¨æ„ï¼Œç¼ºå¤±æ•°æ®æ˜¯ä¸ºè¡¨ä¸­ä¸å¯¹åº”çš„å€¼å†™å…¥çš„ã€‚å½“ Margins = True æ—¶ï¼Œå¯ä»¥å°†åˆ—å’Œè¡Œçš„å¹³å‡å€¼æ·»åŠ åˆ°è¡¨æ ¼ä¸­ã€‚è®©æˆ‘å±•ç¤ºä¸€ä¸‹ã€‚

![](img/4d199f0e1871182e2a212b784c3856c7.png)

å¦‚æœè¦èµ‹å€¼è€Œä¸æ˜¯ç¼ºå¤±å€¼ï¼Œå¯ä»¥ä½¿ç”¨ fill_valueã€‚

![](img/d5d6ee9f31254d0f17b69873dc8fbffa.png)

# å¤šçº§æ•°æ®é€è§†è¡¨

æ‚¨è¿˜å¯ä»¥åˆ›å»ºå¤šçº§æ•°æ®é€è§†è¡¨ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ç”¨ cut æ–¹æ³•å°†å…„å¼Ÿå˜é‡åˆ’åˆ†ä¸ºåŒºé—´ã€‚

![](img/937c253778a9c73ec93bdb515fc74cf4.png)

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå…„å¼Ÿå˜é‡åˆ›å»ºä¸€ä¸ªå¤šçº§æ•°æ®é›†ã€‚

![](img/58b2dc313cb7b628cdb52dd0ce973549.png)

æ‚¨å¯ä»¥å¢åŠ çº§åˆ«æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œaggfunc é€‰é¡¹é‡‡ç”¨å‡å€¼å‡½æ•°ã€‚æ‚¨å¯ä»¥æ›´æ”¹æ­¤åŠŸèƒ½ã€‚è®©æˆ‘å±•ç¤ºä¸€ä¸‹ã€‚

![](img/151cc13e1804fecf47f82a6fdccbeeed.png)

ä¹Ÿå¯ä»¥ä½¿ç”¨ sum å‡½æ•°ä»£æ›¿ mean å‡½æ•°ã€‚

![](img/f94fdb8c5bc0af97a1e12f5112b5e1ab.png)

å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨å­—å…¸ç»“æ„ï¼Œä½¿ç”¨å•ç‹¬çš„å‡½æ•°æ¥ä¸ºæ¯ä¸€åˆ—å®ç°ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬å¯¹å…„å¼Ÿä½¿ç”¨ max å‡½æ•°ï¼Œå¯¹åˆ†æ•°ä½¿ç”¨ sum å‡½æ•°ã€‚

![](img/e1424d0f166a82edd55d4068b73af155.png)

# äº¤å‰è¡¨

æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹äº¤å‰è¡¨æ–¹æ³•ã€‚äº¤å‰è¡¨æ˜¯è®¡ç®—åˆ†ç»„é¢‘ç‡çš„æ•°æ®é€è§†è¡¨çš„ç‰¹ä¾‹ã€‚è®©æˆ‘ä»¬å°†äº¤å‰è¡¨ç”¨äºå…„å¼Ÿå’Œè¯¾ç¨‹åˆ—ã€‚

![](img/c02c535cf047c8cd5fb03ed1ab52a403.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†å˜é‡æ€§åˆ«æ·»åŠ åˆ°ç´¢å¼•ä¸­ã€‚

![](img/d20d7dfa7271fb24883d3f2ce9d67bfa.png)

# å…·æœ‰çœŸå®æ•°æ®é›†çš„åº”ç”¨ç¨‹åº

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨çœŸå®çš„æ•°æ®é›†æ¥å±•ç¤ºæˆ‘æ‰€è¯´çš„å†…å®¹ã€‚è¿™ä¸ªæ•°æ®é›†æ˜¯å…³äºåœ¨ç¾å›½å‡ºç”Ÿçš„å©´å„¿çš„ã€‚é¦–å…ˆï¼Œè®©æˆ‘å¯¼å…¥æ•°æ®é›†ã€‚ä½ å¯ä»¥ä»[è¿™é‡Œ](https://github.com/TirendazAcademy/pandas-tutorial)ä¸‹è½½è¿™ä¸ªæ•°æ®é›†ã€‚

![](img/6529ec84929abba721bf45d651785058.png)

è®©æˆ‘ä»¬ä½¿ç”¨ head æ–¹æ³•æ¥æŸ¥çœ‹è¿™ä¸ªæ•°æ®é›†çš„å‰äº”è¡Œã€‚

![](img/db78975be9a9ea053d202a34e57165b7.png)

è¯¥æ•°æ®é›†æ˜¾ç¤ºäº†æŒ‰å‡ºç”Ÿå©´å„¿æ€§åˆ«åˆ†åˆ—çš„å‡ºç”Ÿäººæ•°ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ pivot_table æ–¹æ³•æ¥ç†è§£è¿™ä¸ªæ•°æ®é›†ã€‚æˆ‘å°†åˆ›å»ºä¸€ä¸ªåä¸º ten_year çš„åˆ—æ¥æŸ¥æ‰¾æ¯åå¹´å‡ºç”Ÿçš„å­©å­çš„æ•°é‡ã€‚

![](img/3185eb4bd2e77fd8aac1a02e7aaad0fa.png)

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç”·å¥³ç”Ÿè‚²çš„è¶‹åŠ¿ã€‚ä¸ºæ­¤ï¼Œæˆ‘å°†ä½¿ç”¨ matplotlibã€‚é¦–å…ˆï¼Œè®©æˆ‘ä½¿ç”¨% matplotlib inline magic å‘½ä»¤æ¥å†…è”æŸ¥çœ‹å›¾å½¢ã€‚

![](img/193836432369eca007c7e97846e9961b.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¼å…¥ Matplotlib å’Œ Seabornã€‚

![](img/cb04847bdca3c117f81ab5f15d605ec0.png)![](img/92c9ba6ebd1ec5760ed60c6fd3f1ad56.png)

ä¹‹åï¼Œæˆ‘å°†ä½¿ç”¨ pivot_table æ–¹æ³•æ¥æŸ¥çœ‹æ¯å¹´çš„å˜åŒ–ï¼Œå¹¶ç»˜åˆ¶ä¸€ä¸ªçº¿å›¾æ¥æ˜¾ç¤ºç”·æ€§å’Œå¥³æ€§å‡ºç”Ÿç‡çš„å˜åŒ–ã€‚

![](img/86cfd0165e7dad2b768d0145a0a514be.png)

ç»™ä½ ã€‚ä»è¿™å¼ å›¾ä¸Šä½ å¯ä»¥çœ‹åˆ°æ¯å¹´çš„å˜åŒ–ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è®¨è®ºäº†æ•°æ®é€è§†è¡¨ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•å°†æ•°æ®é€è§†è¡¨ç”¨äºç°å®ä¸–ç•Œçš„æ•°æ®é›†ã€‚å°±æ˜¯è¿™æ ·ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°è¿™æœ¬ç¬”è®°æœ¬[ã€‚](https://github.com/TirendazAcademy/PANDAS-TUTORIAL)

å¦‚æœä½ è¿˜æ²¡çœ‹è¿‡ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ çœ‹ä¸‹é¢è¿™äº›å…³äºç†ŠçŒ«çš„æ–‡ç« ã€‚ğŸ‘‡ğŸ‘‡ğŸ‘‡

*   [ç†ŠçŒ«ç®€ä»‹](https://ai.plainenglish.io/introduction-to-the-pandas-library-a3a557c8d094?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„é‡è¦æ–¹æ³•](https://ai.plainenglish.io/important-methods-in-pandas-2d4c774fcac9?source=your_stories_page-------------------------------------)
*   [åœ¨ç†ŠçŒ«èº«ä¸Šè¯»å†™æ•°æ®](https://ai.plainenglish.io/reading-and-writing-in-pandas-2d83dc538aff?source=your_stories_page-------------------------------------)
*   [å¦‚ä½•ä¿®å¤ç†ŠçŒ«ä¸¢å¤±çš„æ•°æ®](https://ai.plainenglish.io/missing-data-in-pandas-d41cbcec04e0?source=your_stories_page-------------------------------------)
*   [åœ¨ç†ŠçŒ«é‡Œå’Œ Groupby ä¸€èµ·å·¥ä½œ](/working-with-groupby-in-pandas-7e7823414537?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„åˆ†ç±»æ•°æ®](https://tirendazacademy.medium.com/categorical-data-in-pandas-9eaaff71e6f3?source=your_stories_page-------------------------------------)
*   [åœ¨ Pandas ä¸­å¤„ç†æ–‡æœ¬æ•°æ®](https://tirendazacademy.medium.com/working-with-text-data-in-pandas-f78aa368e1a?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«å®ç”¨æ•°æ®åˆ†æ](/practical-data-analysis-with-pandas-c40fbd2955fa?source=your_stories_page-------------------------------------)

è¯·é¼“æŒğŸ‘å¦‚æœä½ å–œæ¬¢è¿™ç¯‡åšæ–‡ã€‚å¦å¤–ï¼Œåˆ«å¿˜äº†å…³æ³¨æˆ‘ä»¬çš„ [*è’‚ä¼¦è¾¾å…¹å­¦é™¢ YouTube*](https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw) ğŸ“ºï¼Œ [*ç¢ç¢å¿µ*](https://twitter.com/TirendazAcademy) ğŸ˜*ã€*ã€[ã€*ä¸­ç­‰*ã€](https://tirendazacademy.medium.com/)ğŸ“šï¼Œ[*LinkedIn*](https://www.linkedin.com/in/tirendaz-academy)*ğŸ‘*

*ä¸‹ä¸€ç¯‡æ–‡ç« å†è§â€¦*