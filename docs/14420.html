<html>
<head>
<title>How To Create Excel Functions With R Programming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用R编程创建Excel函数</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-create-excel-functions-with-r-programming-fa26cf9be698?source=collection_archive---------3-----------------------#2022-11-27">https://levelup.gitconnected.com/how-to-create-excel-functions-with-r-programming-fa26cf9be698?source=collection_archive---------3-----------------------#2022-11-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/92d579ac53caeeb279860351ec7fa783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_kxF4lDJoR6zG8AsXc8EQ.png"/></div></div></figure><p id="0926" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated"><span class="l kx ky kz bm la lb lc ld le di">在</span>文章<a class="ae lf" href="https://medium.com/codex/how-to-create-excel-functions-with-python-6c6da75082e8?source=your_stories_page-------------------------------------" rel="noopener">如何用Python创建Excel函数</a>中，我谈到了如何在Excel中使用Python创建自己的Excel函数，也称为用户定义函数(U.D.F)。</p><p id="9c59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于Python和R在数据科学领域很受欢迎，我们现在有插件来支持它们在Excel中的使用，以使那些来自编程背景的人的生活更容易。</p><p id="81b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，您将学习如何用r中的知识创建Excel函数。</p><h1 id="0aa2" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">开始使用B.E.R.T</h1><p id="f452" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">没有来自Transformers  <em class="mj">的<em class="mj"> t </em> <a class="ae lf" href="https://en.wikipedia.org/wiki/BERT_(language_model)" rel="noopener ugc nofollow" target="_blank">双向编码器表示，而是基本的Excel R Toolkit </a></em>，一个连接Excel和R的工具，让您有机会在Excel中创建自己的用户定义函数(UDF)。</p><p id="0bed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在这里下载BERT安装程序<a class="ae lf" href="https://bert-toolkit.com/download-bert" rel="noopener ugc nofollow" target="_blank">并安装它。</a></p><p id="c851" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装后，启动Excel并单击Excel加载项选项卡，您将看到BERT控制台按钮。</p><p id="71cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击按钮打开控制台，</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/ae79c1a66f338ddd92190459655e0cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bB-4Xbjswo_8pQ7neLAXMw.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/f784c3e773483bf3421b11c50653fc04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-IWbIjkfeLROzKr9_Rjtg.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><p id="7d5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">控制台左边有一个代码编辑器，右边有一个R shell，就像R Studio中的一样。</p><p id="e09f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，在BERT上运行这段代码，</p><pre class="ml mm mn mo gt mu mv mw bn mx my bi"><span id="712a" class="mz lh iq mv b be na nb l nc nd">head(iris)<br/>print("hello world")</span></pre><p id="b2c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你得到了，</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/809a9acfae1dfd6d3d8b8a1ec023dfc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*bSuM2OB2mpftAKtp8bK-yg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><h1 id="a2f2" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建您自己的Excel函数</h1><p id="4271" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">在Excel中打开BERT控制台时，您会看到一个默认打开的文件<code class="fe nf ng nh mv b">functions.R</code>，它位于启动文件夹<code class="fe nf ng nh mv b">Documents\BERT2\functions.</code>中</p><p id="e95a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以在这个文件中创建您的函数，也可以在文件夹中创建其他文件。</p><p id="9296" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们创建一个在两个矩阵之间执行矩阵乘法的函数。</p><pre class="ml mm mn mo gt mu mv mw bn mx my bi"><span id="7904" class="mz lh iq mv b be na nb l nc nd">MAT_MULT &lt;- function(mat_a,mat_b){<br/>  return(mat_a%*%mat_b)<br/>}</span></pre><p id="a3ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保存文件并关闭控制台，不要担心您的文件保存在BERT目录中，</p><p id="d65d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">去excel创建一个3x3的矩阵，</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/12e83d59cd846b12abf0782e1957adf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*iQOgYU_QucjVdtQnVSE-rw.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><p id="62e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就像你会调用一个常规的excel函数一样，在Excel中调用以<code class="fe nf ng nh mv b">R.MAT_MULT()</code>开头的<code class="fe nf ng nh mv b">MAT_MULT()</code>。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/97176b1d05a242918b646c92c4637326.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*qeW-RSTCnF3671sGCQbe0g.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ae5632f642b7c9247044025d779e1dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*seFuniWMzN9i3NBbCrF4Ow.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><h1 id="57f5" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">记录您的功能</h1><p id="5cac" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">您可以通过进入<code class="fe nf ng nh mv b">functions.R </code>文件并添加下面的代码并保存来记录<code class="fe nf ng nh mv b">MAT_MULT() </code>函数。</p><pre class="ml mm mn mo gt mu mv mw bn mx my bi"><span id="49b6" class="mz lh iq mv b be na nb l nc nd">attr(MAT_MULT, "category") &lt;- "Matrix"<br/>attr(MAT_MULT, "description") &lt;- "Input Matrix"</span></pre><p id="344f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将为您创建的函数提供一个类别和描述。</p><p id="613e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你回到Excel，点击公式栏上的函数图标，浏览类别，你会看到新添加的类别矩阵。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/6fbfafe528b7c3b2b60ac40ff6f9f662.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*jN2jxBO1BobGj08RNcQTYg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><p id="d1d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击确定，您将看到<code class="fe nf ng nh mv b">MAT_MUL()</code>功能交互文档。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/0f9b4377d2a9e47e71b1bc1946e8bc67.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*qp_NfundTVkaKv1M4I4S2w.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">作者图片</figcaption></figure><h1 id="22e4" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结论</h1><p id="3de3" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">这篇文章只是你可以在Excel中使用R做的事情的表面，你可以通过进入官方文档阅读更多内容，也可以从Julia阅读如何与Excel交互。</p><h1 id="506a" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">相关阅读</h1><div class="nn no gp gr np nq"><a href="https://medium.com/codex/how-to-combine-multiple-plots-in-one-page-f17c21bf930b" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">R编程中如何在一页中组合多个图</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">我工作的一个客户最近告诉我，他提交文章的一个出版物，只接受6个情节，他…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe jw nq"/></div></div></a></div><div class="nn no gp gr np nq"><a href="https://medium.com/codex/using-r-programming-on-power-bi-desktop-9db9492d7aad" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">在Power BI桌面上使用R编程</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">了解如何结合R和BI的力量</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="of l ob oc od nz oe jw nq"/></div></div></a></div></div><div class="ab cl og oh hu oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="ij ik il im in"><h1 id="6ecd" class="lg lh iq bd li lj on ll lm ln oo lp lq lr op lt lu lv oq lx ly lz or mb mc md bi translated">分级编码</h1><p id="44b1" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="aa9f" class="os ot iq ka b kb kc kf kg kj ou kn ov kr ow kv ox oy oz pa bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="0a7f" class="os ot iq ka b kb pb kf pc kj pd kn pe kr pf kv ox oy oz pa bi translated">📰更多内容请查看<a class="ae lf" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码刊物</a></li><li id="172e" class="os ot iq ka b kb pb kf pc kj pd kn pe kr pf kv ox oy oz pa bi translated">🔔关注我们:<a class="ae lf" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae lf" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae lf" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="2ce0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">🚀👉<a class="ae lf" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>