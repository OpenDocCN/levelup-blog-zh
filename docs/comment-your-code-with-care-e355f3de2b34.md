# 小心注释您的代码

> 原文：<https://levelup.gitconnected.com/comment-your-code-with-care-e355f3de2b34>

*评论代码容易过头。学会何时发表评论是一项重要的，但经常被忽视的技能。*

![](img/2f4a2cd54e8513309296b007a1e2ab3a.png)

【https://unsplash.com/@markrabephotography 号

当我开始开发时，我犯了许多学习型开发人员的错误。这包括大量的代码注释，因为我对未来的自己缺乏信心，不知道我的代码在做什么，更不用说我打算让它做什么了。

虽然不断的注释似乎是向未来的我和其他程序员解释我的代码在做什么的合理方式，但我也是在假设注释最多是嘈杂和多余的情况下编码的。事实证明，大量的评论总是成为维护的负担，所以它们没有被维护。

这就是我如何了解到一个重要的真理:**过时的评论只是谎言。没有持续的警惕和维护，评论会变得陈旧，使曾经描述一段代码意图的有思想的英语变成只会混淆和欺骗的谎言。**

我从早期注释重代码中得到的另一个认识是，他们通常是我试图解释什么是真正糟糕的代码。我非常喜欢 Stack Overflow 的联合创始人杰夫·阿特伍德对这个问题的描述:

“初级开发人员依靠评论来讲述故事，而他们应该依靠*代码*来讲述故事。评论是叙述性的旁白；以自己的方式很重要，但绝不意味着取代情节、人物塑造和背景。”[*https://blog.codinghorror.com/coding-without-comments/*](https://blog.codinghorror.com/coding-without-comments/)

作为一名初级开发人员，我总是发现使用注释来描述一段代码的*如何*和*为什么*非常有吸引力，因为大多数时候这两种特性都可以通过代码来解释。我甚至没有意识到我是在用注释来解释代码中应该解释什么。Robert C. Martin 在他的开创性著作 *Clean Code* 中也用文学术语描述了好的代码:

“干净的代码简单而直接。干净的代码读起来像写得很好的散文。干净的代码永远不会掩盖设计者的意图，而是充满了清晰的抽象和直截了当的控制线。”

事实上，马丁宣称“注释的唯一恰当用途是弥补我们无法用代码表达自己的缺陷。”通过非常小心地命名变量、类和函数，我们几乎总是能够不带注释地表达自己。如果您觉得有必要添加一个注释来解释您的函数正在做什么，可以考虑重命名该函数来描述它正在做什么。从在 forrent.com 的[运行我们的租金计算器的管理员那里摘录如下:](http://forrent.com)

虽然这是一小段无伤大雅的注释代码，但也许它可以被重构为不需要任何注释？

上面的代码现在更加冗长，但是一旦幻数被标记(0.15)并且函数以它们的用途命名，注释的需要就消失了。根据具体情况，`percentOfIncome`可能与更长的`percentOfIncomeUsedForRent`一样有用；不管怎样，现在的责任是用代码来表达我们自己，而不是懒洋洋地发表评论。如果企业后来将低租金收入的百分比确定为 12%，而不是 15%，会发生什么情况？在原始版本中，注释和代码都需要更新以反映这种变化。如果实现百分比更改的开发人员没有更新注释，那么对于未来的开发人员来说，这将是一个关于代码在做什么的谎言。以删除注释为目标重构上面的代码，现在实际上提高了 Math.round()调用的可重用性。现在，midRent 和 highRent 的函数也可以使用 caluclateMonthlyRent，而不是重复 3 次计算月租金的代码。

虽然这种重构在孤立的上下文中看起来有些矫枉过正，但是用代码本身解释*如何*和*为什么*的价值怎么强调都不为过。代码中的注释越多，将来您和其他开发人员就越有可能一起浏览注释，这进一步增加了过时信息作为文档传播的可能性。

总会有一些情况需要注释。我们代码中的一些东西仅仅用代码是无法解释的。但是下一次你觉得需要在代码中添加注释时，问问自己同样的注释是否可以只用代码来表达。如果答案是肯定的，那就帮你自己、你未来的自己和你的开发伙伴一个忙。遵循作者 Brian Kernighan 在*编程风格的要素*中的话，“不要评论糟糕的代码——重写它。”

如果你对学习如何将注释转化为更好的代码感兴趣，可以看看我的后续文章 [*将注释重构为更好的代码*](https://medium.com/gitconnected/refactoring-comments-into-better-code-f17671bee0f6) 。

*如果您喜欢这篇文章，请点击👏！*

如果你是一名正在寻找在线社区或 GitHub 集成配置文件的开发人员，请加入我们 gitconnected.com 的[](http://gitconnected.com)**！**