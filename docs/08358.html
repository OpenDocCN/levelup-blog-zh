<html>
<head>
<title>Fastest Redis Client Library for Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向Go的最快Redis客户端库</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/fastest-redis-client-library-for-go-7993f618f5ab?source=collection_archive---------3-----------------------#2021-04-25">https://levelup.gitconnected.com/fastest-redis-client-library-for-go-7993f618f5ab?source=collection_archive---------3-----------------------#2021-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5a8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对一些流行的Redis客户端库进行基准测试，以找到最快的一个。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/601994016c2ff78bcd4be115bc153cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0tgriAVkRhjyDMA8.png"/></div></div></figure><h1 id="f8b3" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">动机</h1><p id="bd6b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">提高RPS(每秒请求数)不是一件容易的事情。更改代码以提高性能更具挑战性。有几个流行的库，几乎每一个都声称是最快的。当基准测试结果过时时，问题就出现了。更糟糕的是，进行基准测试的人以非通用的方式调优库。因此，对于普通用户来说，达到同样的性能几乎是不可能的。</p><p id="3510" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基准测试的目的是在一个受控的环境中找到最快的Redis客户端库，并且不需要任何<em class="ma">魔法来调整任何库。</em></p><h1 id="9138" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">环境</h1><p id="aa57" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">使用的Go客户端库:</p><ul class=""><li id="6fc9" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/gomodule/redigo" rel="noopener ugc nofollow" target="_blank"> gomodule/redigo </a> v1.8.4</li><li id="b1f0" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/go-redis/redis" rel="noopener ugc nofollow" target="_blank"> go-redis/redis </a> v8.8.2</li><li id="f8e3" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/mediocregopher/radix" rel="noopener ugc nofollow" target="_blank">mediocregopher/radix</a>v 3 . 7 . 0</li><li id="e1cd" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated">joomcode/re disppe v 0 . 9 . 4</li></ul><p id="7652" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最大连接池大小为100和1000。</p><p id="b619" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">副本大小为5时打开和关闭群集模式。除了<a class="ae mk" href="https://github.com/gomodule/redigo" rel="noopener ugc nofollow" target="_blank"> gomodule/redigo </a>目前不支持集群客户端模式。</p><h1 id="5b4e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">基准测试结果</h1><p id="802e" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">下面的结果是运行基准测试25次后的平均结果。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h1 id="9a7c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">了解结果</h1><p id="68d0" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">每个Redis操作的右边有四列，就像上面结果中的<em class="ma"> GET </em>一样。它们中每一个的含义是:</p><ul class=""><li id="68aa" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated"><strong class="jp ir">迭代</strong> = &gt;运算运行的迭代次数，<strong class="jp ir">一个</strong> <strong class="jp ir">值越高越好</strong>。</li><li id="7ea7" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><strong class="jp ir"> ns/op </strong> = &gt;这是每个函数调用完成的平均时间，<strong class="jp ir"/><strong class="jp ir">值越小越好</strong>。</li><li id="68eb" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><strong class="jp ir"> B/op </strong> = &gt;这是每次函数调用使用的平均内存，<strong class="jp ir">值越小越好。</strong></li><li id="cbd1" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><strong class="jp ir"> allocs/o </strong> = &gt;这是每个函数调用的平均内存分配，<strong class="jp ir">值越小越好。</strong></li></ul><p id="5aae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到<strong class="jp ir"><em class="ma">go-redis/redis/V8/cluster-pool:1000</em></strong>几乎在所有的运行基准<em class="ma">上都优于其他库。</em>不包括<em class="ma">到期</em>操作，其中<strong class="jp ir"><em class="ma">mediocregopher/radix/v3/cluster-pool:1000</em></strong>实际上以微弱优势超过它。</p><p id="9417" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个有趣的结果是，<strong class="jp ir"><em class="ma">gomodule/redigo-pool:100</em></strong>实际上在类似HGET的某个操作上胜过了<strong class="jp ir"><em class="ma">gomodule/redigo-pool:1000</em></strong>。这很可能是因为连接池的增加增加了在有限资源环境中对资源分配的竞争。拥有一个小连接池允许在处理下一个操作之前先完成上一个操作。由于没有资源分配竞争，它实际上比具有更高连接池的服务器性能更好。这意味着我们不应该盲目地增加最大连接池，并相信操作会更快。</p><h1 id="153d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="5ad4" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">通过查看上面的结果，我们可以得出结论，<strong class="jp ir"> <em class="ma"> go-redis/redis/v8在</em> </strong>上使用集群模式是go的总体最快的redis客户端库。建议在集群模式打开的情况下使用它，并根据您自己的环境使用专用的最大连接池大小。根据您最繁重的操作，需要进行一些测试来找到平衡最大连接池大小。</p></div></div>    
</body>
</html>