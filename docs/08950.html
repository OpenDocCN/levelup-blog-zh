<html>
<head>
<title>Django: Customize 404 Error Page</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django:自定义404错误页面</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/django-customize-404-error-page-72c6b6277317?source=collection_archive---------3-----------------------#2021-06-22">https://levelup.gitconnected.com/django-customize-404-error-page-72c6b6277317?source=collection_archive---------3-----------------------#2021-06-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7dce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">定制404错误页面是Django项目中的最佳实践之一。让我们学习如何使用自定义的404 Not Found页面处理404错误。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8128d3061accfc4dc08e9928c30fef61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EC9515hoJ-2wVf0p"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Erik Mclean 在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="e1c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">404未找到页面应该是最著名的状态代码。在生产中，一个好的Django项目必须用自己定制的页面来处理这个错误。我将向您展示如何通过简单的步骤实现这一点。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="c391" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们不失时机地创建一个Django项目。</p><p id="1018" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开您的控制台，写下这些行:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="d4f2" class="lr ls it ln b gy lt lu l lv lw">$ cd Desktop<br/>$ mkdir mysite<br/>$ cd mysite</span></pre><p id="6320" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后创建一个Django项目:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="0d99" class="lr ls it ln b gy lt lu l lv lw">$ django-admin startproject mysite .</span></pre><p id="25d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将执行这一行来运行服务器:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="1068" class="lr ls it ln b gy lt lu l lv lw">$ python manage.py runserver</span></pre><p id="2de3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你访问<a class="ae le" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8000/ </a>你会看到Django欢迎页面。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lx"><img src="../Images/2454b6bc2caf9e317554017b61451c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cloJRlcY3m3YFygwZBwYTg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Django欢迎页面(图片由作者提供)</figcaption></figure><p id="72e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们试着去我们网站上一个不存在的页面。比如我会去<a class="ae le" href="http://127.0.0.1:8000/page" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/page</a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ly"><img src="../Images/3846ee91da1fd136330a62ff3c5ef236.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TGnVcn2HYoEU8Qqwv-Y_-Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">默认Django未找到页面(图片由作者提供)</figcaption></figure><p id="8eb9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这一页的底部，信息说:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="9473" class="lr ls it ln b gy lt lu l lv lw">You’re seeing this error because you have <!-- -->DEBUG = True<!-- --> in your Django settings file. Change that to <!-- -->False<!-- -->, and Django will display a standard 404 page.</span></pre><p id="ddd2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们通过关闭Django调试模式来做到这一点。为此，我们需要更新<code class="fe lz ma mb ln b">settings.py</code>文件。</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="309b" class="lr ls it ln b gy lt lu l lv lw">DEBUG = False</span><span id="02b7" class="lr ls it ln b gy mc lu l lv lw">ALLOWED_HOSTS = ['127.0.0.1']</span></pre><p id="2228" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注:生产中需要将<code class="fe lz ma mb ln b">ALLOWED_HOSTS</code>改为<code class="fe lz ma mb ln b">'mydomain.com'</code>。</p><p id="3fbd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">刷新页面。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lx"><img src="../Images/7c3ba48e705fba21804c0911b3d94e44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yUSupCJp0G735f6QS53VYQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">DEBUG = True后未找到Django页面(图片由作者提供)</figcaption></figure><p id="1552" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我们要用模板定制的页面。</p><p id="9fcf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用该命令，在<code class="fe lz ma mb ln b">mysite</code>文件夹下创建一个文件。</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="ad48" class="lr ls it ln b gy lt lu l lv lw">$ touch mysite/views.py</span></pre><p id="62e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我知道在项目目录下有一个<code class="fe lz ma mb ln b">views.py</code>文件很奇怪。我们总是被告知<code class="fe lz ma mb ln b">views.py</code>是每个app目录下的文件，而不是项目本身。但这是<a class="ae le" href="https://docs.djangoproject.com/en/3.2/topics/http/views/#customizing-error-views" rel="noopener ugc nofollow" target="_blank">公文</a>中建议的方式。</p><p id="1592" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您的Django项目应该如下所示:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="571a" class="lr ls it ln b gy lt lu l lv lw">.<br/>├── db.sqlite3<br/>├── manage.py<br/>└── mysite<br/>    ├── __init__.py<br/>    ├── __pycache__<br/>    ├── asgi.py<br/>    ├── settings.py<br/>    ├── urls.py<br/>    ├── views.py<br/>    └── wsgi.py</span></pre><p id="675c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们将添加一个处理404错误的函数，将这些行放到<code class="fe lz ma mb ln b">mysite/views.py</code>文件中:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="574a" class="lr ls it ln b gy lt lu l lv lw">from django.shortcuts import render</span><span id="5813" class="lr ls it ln b gy mc lu l lv lw">def page_not_found_view(request, exception):<br/>    return render(request, '404.html', status=404)</span></pre><p id="1b72" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不要忘记将该函数添加到<code class="fe lz ma mb ln b">mysite/urls.py</code>文件的底部:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="425d" class="lr ls it ln b gy lt lu l lv lw">handler404 = "<!-- -->mysite<!-- -->.views.page_not_found_view"</span></pre><p id="5dcf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，<code class="fe lz ma mb ln b">mysite/urls.py</code>文件变成了:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="ad97" class="lr ls it ln b gy lt lu l lv lw">from django.contrib import admin<br/>from django.urls import path</span><span id="2fb7" class="lr ls it ln b gy mc lu l lv lw">urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>]</span><span id="7314" class="lr ls it ln b gy mc lu l lv lw">handler404 = "django_404_project.views.page_not_found_view"</span></pre><p id="b28e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们需要创建一个<code class="fe lz ma mb ln b">templates</code>文件夹，然后我们将向该文件夹添加一个<code class="fe lz ma mb ln b">404.html</code>文件。</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="c39b" class="lr ls it ln b gy lt lu l lv lw">$ mkdir templates<br/>$ touch templates/404.html</span></pre><p id="a16d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您需要告诉Django您的<code class="fe lz ma mb ln b">templates</code>文件夹在哪里，以便更新<code class="fe lz ma mb ln b">settings.py</code>文件。</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="fb0b" class="lr ls it ln b gy lt lu l lv lw">import os</span><span id="0ef0" class="lr ls it ln b gy mc lu l lv lw">TEMPLATES <strong class="ln iu">=</strong> [<br/>    {<br/>        ...<br/>        'DIRS': [os.path.join(BASE_DIR, 'templates')],<br/>        ...<br/>    },<br/>]</span></pre><p id="95e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe lz ma mb ln b">404.html</code>中，你现在可以随意定制错误信息页面。我保持简单:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="6e1e" class="lr ls it ln b gy lt lu l lv lw">&lt;h1&gt;404 Page Not Found&lt;/h1&gt;<br/>&lt;p&gt;My Custom 404 Page Not Found!&lt;/p&gt;</span></pre><p id="2e8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在刷新页面之前，请确保您的项目结构如下所示:</p><pre class="kp kq kr ks gt lm ln lo lp aw lq bi"><span id="425a" class="lr ls it ln b gy lt lu l lv lw">.<br/>├── db.sqlite3<br/>├── manage.py<br/>├── mysite<br/>│   ├── __init__.py<br/>│   ├── __pycache__<br/>│   ├── asgi.py<br/>│   ├── settings.py<br/>│   ├── urls.py<br/>│   ├── views.py<br/>│   └── wsgi.py<br/>└── templates<br/>    └── 404.html</span></pre><p id="73fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在你可以去你网站上不存在的任何页面。<code class="fe lz ma mb ln b">404.html</code>模板将处理所有这些。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lx"><img src="../Images/e98fea29c6b9e1d865157f7a5193260e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3BQ7g23oEvfSHkodQpg6Og.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">自定义的404未找到页面(图片由作者提供)</figcaption></figure><p id="f54a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">瞧啊。我们的自定义404页面找不到可见的任何不存在的网页在您的网站上。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="28df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢您阅读我的文章。我希望你喜欢它！</p><p id="da23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可能还会对以下内容感兴趣:</p><div class="md me gp gr mf mg"><a href="https://python.plainenglish.io/9-python-tricks-to-become-a-better-data-scientist-eb26970b4160" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">成为更好的数据科学家的9个Python技巧</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">你应该知道这些可怕的技巧，以便拥有更好的数据科学家职业生涯</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">python .平原英语. io</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu ky mg"/></div></div></a></div></div></div>    
</body>
</html>