<html>
<head>
<title>How to kill server when seeing “EADDRINUSE: address already in use”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当看到“EADDRINUSE:地址已被使用”时如何杀死服务器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-kill-server-when-seeing-eaddrinuse-address-already-in-use-16c4c4d7fe5d?source=collection_archive---------0-----------------------#2020-03-05">https://levelup.gitconnected.com/how-to-kill-server-when-seeing-eaddrinuse-address-already-in-use-16c4c4d7fe5d?source=collection_archive---------0-----------------------#2020-03-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="282b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">关于如何在Mac/Linux和Windows上发生“EADDRINUSE”时手动<strong class="js iu">终止进程</strong>的教程。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/84b1f887d74d2acd6bbb6ea3608df975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fIFI9o-wpcGl-k8qXD2mTg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Nodejs监听EADDRINUSE:地址已被使用</figcaption></figure><h1 id="5da4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">问题是</h1><p id="31f1" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">当尝试重新启动一个节点应用程序时，前一个没有正常关闭，您可能会看到一个“<strong class="js iu">listen EADDRINUSE:address in use</strong>”错误，例如:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mh mi l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">听着EADDRINUSE:地址已经被使用</figcaption></figure><h2 id="2e9b" class="mj lf it bd lg mk ml dn lk mm mn dp lo kb mo mp ls kf mq mr lw kj ms mt ma mu bi translated">这个问题背后的原因</h2><p id="e19b" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">这背后的原因是</p><blockquote class="mv mw mx"><p id="fbd8" class="jq jr my js b jt ju jv jw jx jy jz ka mz kc kd ke na kg kh ki nb kk kl km kn im bi translated">当进程崩溃或终止时，不调用。它只在事件循环结束时被调用，因为<code class="fe nc nd ne nf b">server.close()</code> <em class="it">类似于</em>结束事件循环(它仍然需要等待当前正在运行的堆栈),所以把它放在退出事件中是没有意义的。</p></blockquote><h2 id="e522" class="mj lf it bd lg mk ml dn lk mm mn dp lo kb mo mp ls kf mq mr lw kj ms mt ma mu bi translated">解决办法</h2><p id="1d25" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">对该应用程序的正确修复应该是</p><ul class=""><li id="a975" class="ng nh it js b jt ju jx jy kb ni kf nj kj nk kn nl nm nn no bi translated">崩溃时，做<code class="fe nc nd ne nf b"><em class="my">process.on('uncaughtException', ..)</em></code></li><li id="8d0d" class="ng nh it js b jt np jx nq kb nr kf ns kj nt kn nl nm nn no bi translated">并且在杀做<code class="fe nc nd ne nf b"><em class="my">process.on('SIGTERM', ..)</em></code></li></ul><p id="c304" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当这个<strong class="js iu"> EADDRINUSE </strong>问题已经发生时，为了解决它，您需要<strong class="js iu">手动终止进程</strong>。为此，您需要找到进程的进程id (PID)。您知道该进程正在占用您的机器或服务器上的特定端口。</p><h1 id="9bc3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">手动终止进程</h1><h2 id="b70d" class="mj lf it bd lg mk ml dn lk mm mn dp lo kb mo mp ls kf mq mr lw kj ms mt ma mu bi translated">适用于Mac/Linux</h2><p id="fd05" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">为了找到与端口相关联的进程id (PID)</p><pre class="kp kq kr ks gt nu nf nv nw aw nx bi"><span id="d9ec" class="mj lf it nf b gy ny nz l oa ob">⇒ lsof -i tcp:3000 <br/>COMMAND PID   USER  FD  TYPE DEVICE             SIZE/OFF NODE NAME <br/>node    44475 chen5 31u IPv4 0x8b1721168764e4bf 0t0 TCP *:strexec-s (LISTEN)</span></pre><p id="667f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后终止该进程</p><pre class="kp kq kr ks gt nu nf nv nw aw nx bi"><span id="2061" class="mj lf it nf b gy ny nz l oa ob">kill -9 44475</span></pre><p id="43b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用<code class="fe nc nd ne nf b">-9</code>选项确保进程立即终止</p><p id="7bd0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你得到权限错误，你可能需要使用<code class="fe nc nd ne nf b">sudo</code>关键字，例如:</p><pre class="kp kq kr ks gt nu nf nv nw aw nx bi"><span id="0c6e" class="mj lf it nf b gy ny nz l oa ob">sudo kill -9 44475</span></pre><h2 id="c2d3" class="mj lf it bd lg mk ml dn lk mm mn dp lo kb mo mp ls kf mq mr lw kj ms mt ma mu bi translated">对于Windows</h2><p id="4a99" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated"><strong class="js iu">解决方案1:任务管理器</strong></p><p id="5f03" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从<strong class="js iu">进程</strong>或<strong class="js iu">服务</strong>选项卡中打开任务管理器应用程序(<strong class="js iu">taskman.exe</strong>)，按<strong class="js iu"> PID </strong>列排序。要显示<strong class="js iu"> PID </strong>栏，右击标题行并从列表中选择<strong class="js iu"> PID </strong>。右键单击想要停止的流程并选择<strong class="js iu">结束任务</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/80d9780560418f23e601e419493d28d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nRjkL_Cm5QwPPSrUdu3aRA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Windows中的示例，来源于互联网</figcaption></figure><p id="6ab2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">解决方案2:使用命令提示符</strong></p><p id="3a9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">导航到<strong class="js iu">开始&gt;运行&gt; </strong>键入<strong class="js iu">命令</strong> <strong class="js iu"> &gt; </strong>右键单击<strong class="js iu">命令提示符</strong>，然后选择<strong class="js iu">以管理员身份运行</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/3573d6798bee4c109cfc75d65f418202.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*_PL2rkGu4NMCAZVxrXdM5g.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来源于谷歌搜索</figcaption></figure><p id="7dfe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用<a class="ae oe" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/netstat" rel="noopener ugc nofollow" target="_blank"> netstat </a>命令列出所有活动端口。<code class="fe nc nd ne nf b">-a</code>开关显示所有正在使用的端口，而不仅仅是与当前用户相关的端口。<code class="fe nc nd ne nf b">-n</code>选项停止主机名查找(这需要很长时间)。<code class="fe nc nd ne nf b">-o</code>选项列出了负责端口活动的进程ID。<code class="fe nc nd ne nf b">findstr</code>命令匹配包含PID字符串的标题行，您正在寻找的端口，在前面带有冒号的端口格式中，是<strong class="js iu"> :3000 </strong>。</p><pre class="kp kq kr ks gt nu nf nv nw aw nx bi"><span id="6052" class="mj lf it nf b gy ny nz l oa ob">C:\Users\admin&gt;netstat -ano|findstr "PID :3000" <br/>Proto Local Address Foreign Address State PID <br/>TCP 0.0.0.0:3000 0.0.0.0:0 LISTENING 18264</span></pre><p id="85df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要杀死这个进程(其中<strong class="js iu"> /f </strong>是force):</p><pre class="kp kq kr ks gt nu nf nv nw aw nx bi"><span id="8b2c" class="mj lf it nf b gy ny nz l oa ob">taskkill /pid 18264 /f</span></pre><h1 id="3f23" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">尽情享受吧！</h1><p id="554b" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">大概就是这样。感谢阅读</p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><h1 id="5659" class="le lf it bd lg lh om lj lk ll on ln lo lp oo lr ls lt op lv lw lx oq lz ma mb bi translated">分级编码</h1><p id="bcaf" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">感谢您成为我们社区的一员！升级正在改变技术招聘。<a class="ae oe" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">在最好的公司找到你的完美工作</strong></a><strong class="js iu"/>。</p><div class="or os gp gr ot ou"><a href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener  ugc nofollow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">升级—转变技术招聘</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">升级—转变技术招聘🔥使软件工程师能够找到完美的角色…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">作业. levelup.dev</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ky ou"/></div></div></a></div></div></div>    
</body>
</html>