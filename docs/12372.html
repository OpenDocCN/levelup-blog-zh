<html>
<head>
<title>DataTables: A C++ Tabular Data Structure (v2.0)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据表:一个C++表格数据结构(v2.0)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/datatables-a-c-tabular-data-structure-v2-0-1d2e7ba1c287?source=collection_archive---------13-----------------------#2022-06-05">https://levelup.gitconnected.com/datatables-a-c-tabular-data-structure-v2-0-1d2e7ba1c287?source=collection_archive---------13-----------------------#2022-06-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="af0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<a class="ae ko" href="https://medium.com/analytics-vidhya/datatables-a-c-tabular-data-structure-project-d2d928b1c579" rel="noopener">的前一篇文章</a>中，我介绍并发布了一个名为<a class="ae ko" href="https://github.com/anthonymorast/DataTables" rel="noopener ugc nofollow" target="_blank">数据表</a>的开源项目，这是一个面向C++用户的表格数据结构。在创建一个基本的机器学习库的过程中，我发现自己需要一种在C++中存储表格数据的有效方法，就像如何使用Pandas或R数据帧来完成这项任务一样。作为那个项目的一部分，我用C++创建了一个基本的表格数据结构，虽然非常原始，但很像熊猫。从那以后，机器学习项目就半途而废了，但是在效率和有用性方面的许多改进都被添加到了数据表项目中。这篇文章的目的是重新介绍DataTables项目的功能和用法，因为刚刚发布的2.0版本与1.x版本不兼容，但包含许多改进，使其更接近流行的表格数据结构库。</p><p id="7b0a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<a class="ae ko" href="https://github.com/anthonymorast/DataTables/pull/16" rel="noopener ugc nofollow" target="_blank">拉动请求</a>中可以找到这些变化的简要概述。</p><p id="86f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">示例用法和其他文档可以在<a class="ae ko" href="https://github.com/anthonymorast/DataTables/tree/master/examples" rel="noopener ugc nofollow" target="_blank">示例目录</a>和<a class="ae ko" href="https://github.com/anthonymorast/DataTables/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> GitHub库的自述文件</a>中找到。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/d225f034ab1d042505c99db44d87c503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qqsKZbFok695SGsD"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="314c" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">日期时间支持</h1><p id="f63a" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">实际上，在1.0版本的最新更新中添加了日期/时间列支持。为此，将对照一小组正则表达式检查每列中的值，以确定它们是否采用以下日期/时间格式之一</p><ul class=""><li id="b21d" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">年-月-日</li><li id="064d" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">年/月/日</li><li id="b876" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">年/月/日</li><li id="898f" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">年月日日</li><li id="96b6" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">年/月/日时:分:秒</li><li id="d178" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">yyyy-mm-dd hh:mm:ss</li></ul><p id="9777" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">目前，这些是数据表支持的唯一格式，但该框架是非常可扩展的，所以如果你想看到其他格式的添加，只需<a class="ae ko" href="https://github.com/anthonymorast/DataTables/issues" rel="noopener ugc nofollow" target="_blank">打开一个问题</a>。这些格式的列被自动视为日期/时间，并在处理过程中被视为日期/时间。</p><h1 id="07ce" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">面向用户</h1><h2 id="004c" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">增强的数据表形状</h2><ul class=""><li id="d483" class="mi mj it js b jt md jx me kb ni kf nj kj nk kn mn mo mp mq bi translated">我创建了一个DT_SHAPE_TYPE C++对象，它覆盖了&lt;</li><li id="e940" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">行为与熊猫相似。熊猫的数据帧.形状</li></ul><p id="7529" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是该增强功能的一些使用示例。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="fa70" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">改进的文件I/O</h2><p id="8f3b" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">我在个人项目中使用数据表时遇到的一个主要障碍是读/写时间。这与其他语言的类似项目根本无法相比。因此，我在v2.0中花了相当多的时间来增强文件I/O，这导致了文件写入的显著改进。例如，对于<em class="nn"> mnist_train.csv </em>数据集，文件写入时间从大约30秒减少到大约16秒，几乎快了一倍。</p><p id="e40e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，还添加了从具有指定分隔符的文件中导入数据的功能。在1.0版本中，仅支持CSV文件，但在最新版本中，任何字符都可以被视为分隔符。但是，为了方便起见，项目中保留了<em class="nn"> from_csv(…) </em>方法。对于使用<em class="nn"> to_csv(…) </em>和<em class="nn"> to_delimited(…) </em>方法<em class="nn">的文件写入也是如此。</em></p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="a12f" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">运行时异常处理</h2><p id="3a5b" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">这一改变非常简单，当对数据表执行非法操作时，将会抛出运行时异常。以前，输出消息被发送到stdout，代码将停止执行。这是一个幼稚的方法，但很容易实现，并获得了这一点。现在，如果某个操作不被允许，就会抛出一个DataTableException实例，并显示一条有用的消息，以确定问题来自逻辑中的哪个部分。</p><h2 id="d9ed" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">改进的数据表查看</h2><p id="7866" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">做了许多改进来增强DataTable对象的可见性。此外，删除了一些方法，因为它们在其他增强中变得多余。下面列出了一些变化。</p><ul class=""><li id="4e46" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">添加了两个查看数据的新方法，<code class="fe no np nq nr b">head()</code>和<code class="fe no np nq nr b">tail()</code>，它们分别返回数据表中顶部和底部的10行。</li><li id="db8f" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">移除了<code class="fe no np nq nr b">dt.print_row(std::ostream&amp; stream, int row)</code>功能，支持<code class="fe no np nq nr b">std::cout &lt;&lt; dt.select_row_range(row, row+1) &lt;&lt; std::endl;</code>(或任何其他输出流)。</li><li id="f1fe" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><code class="fe no np nq nr b">get_column_names()</code>方法返回一个可以打印的列名向量(一个<a class="ae ko" href="https://github.com/anthonymorast/DataTables/blob/master/include/DataTable/ColumnNames.hpp" rel="noopener ugc nofollow" target="_blank"> ColumnNames </a>类的实例)，例如<code class="fe no np nq nr b">ostream &lt;&lt; dt.get_column_names() &lt;&lt; std::endl;</code></li><li id="937d" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">删除了<code class="fe no np nq nr b">void print_column(std::ostream&amp; stream, int column);</code>和<code class="fe no np nq nr b">void print_column(std::ostream&amp; stream, std::string column_name);</code>，分别支持<code class="fe no np nq nr b">ostream &lt;&lt; dt.select_columns(col_numbers);</code>或<code class="fe no np nq nr b">ostream &lt;&lt; dt.select_columns(col_names);</code>。</li><li id="8dbf" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">增加了通过方括号按名称选择列的能力，例如<code class="fe no np nq nr b">dt[“colname”]</code>，它返回一个数据表对象。</li></ul><p id="49f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面的代码演示了其中的一些更改。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="1f46" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">一些新功能</h2><p id="6a90" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">最后，添加了一些有用的新方法来提供数据表中单个列的更多细节。</p><ul class=""><li id="5561" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">添加了<code class="fe no np nq nr b">min()</code>、<code class="fe no np nq nr b">max()</code>、<code class="fe no np nq nr b">mean()</code>和<code class="fe no np nq nr b">sum()</code>函数，对于多列数据表，这些函数要么接受列号，要么不接受单列数据表的参数。</li></ul><p id="2b94" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们有一个单列数据表，那么我们可以使用接受0个参数的方法版本，例如<code class="fe no np nq nr b">dt["colname"].max()</code>，因为列select <code class="fe no np nq nr b">dt["colname"]</code>返回另一个只有“colname”列的数据表。如果我们有一个多列的数据表，需要指定从0开始的列号。未来的工作将允许使用字符串代替数字，这样就可以传递列名而不是数字。</p><h1 id="44a7" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">在幕后</h1><p id="c6f4" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">下面是项目开发人员的一些细节，但不应该以视觉方式直接影响最终用户。</p><h2 id="4ac6" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">改进的单元测试</h2><p id="5fb4" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">添加了一些Catch2单元测试，以确保进一步更新来打破当前的实现。这些是通过<a class="ae ko" href="https://github.com/anthonymorast/DataTables/tree/master/test" rel="noopener ugc nofollow" target="_blank">测试/目录中的<a class="ae ko" href="https://github.com/anthonymorast/DataTables/blob/master/test/Makefile" rel="noopener ugc nofollow" target="_blank"> Makefile </a>构建和运行的。</a>运行example/目录中的Makefile也将间接测试构建到数据表中的许多功能。</p><p id="c1c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更彻底的单元测试需要进一步的工作。</p><h2 id="6367" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">常数正确性</h2><p id="ef3c" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated"><a class="ae ko" href="https://isocpp.org/wiki/faq/const-correctness" rel="noopener ugc nofollow" target="_blank">坚持Const correctance</a>原则，以确保不应该改变数据的方法不会改变，并确保不可变对象不会发生变异。这对库的用户来说并没有什么直接的好处，但是让这个项目使用起来更安全了。</p></div></div>    
</body>
</html>