<html>
<head>
<title>Create an App from scratch with Dropwizard, Maven, and Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Dropwizard、Maven和Kotlin从头开始创建应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-an-app-with-dropwizard-maven-and-kotlin-24a6277b946c?source=collection_archive---------4-----------------------#2020-10-16">https://levelup.gitconnected.com/create-an-app-with-dropwizard-maven-and-kotlin-24a6277b946c?source=collection_archive---------4-----------------------#2020-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/91b65a0d583f3e4e2687209e48af5689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YlRNvHWdnQSVsmGrkaWgSA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@mreichelt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马克·赖歇尔</a>在<a class="ae kc" href="https://unsplash.com/s/photos/kotlin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="730d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我将向你展示如何创建一个简单的Dropwizard应用程序。<br/>代码是用<a class="ae kc" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>编写的，但是你也可以用Java做同样的事情。</p><p id="32fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本教程结束时，您的应用程序将公开一个RESTful API。</p><p id="2b16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我先简单解释一下Dropwizard和Maven。</p><h2 id="1dfc" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">下拉向导</h2><p id="fd4f" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">Dropwizard 是一个用于构建RESTful web服务的轻量级Java框架。<br/> Dropwizard将Jersey、Jackson和JDBI等稳定的库收集到一个轻量级的包中。</p><h2 id="c979" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">专家</h2><p id="6d6b" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">Maven是一个用于Java的构建自动化和管理工具。<br/>使用Maven，很容易定义软件的构建和依赖关系。POM是一个描述Maven项目及其依赖项的XML文件。</p><p id="454e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">意第绪语中的Maven是“有悟性的人，专家”。这就是该工具名称的由来。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="1e87" class="mg lc iq bd ld mh mi mj lg mk ml mm lj mn mo mp lm mq mr ms lp mt mu mv ls mw bi translated">创建新项目</h1><p id="d5f3" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在本教程中，我将使用IntelliJ Community Edition IDE。</p><p id="0256" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击文件–&gt;新建–&gt;项目–&gt; Maven<br/>,您将看到以下屏幕:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/c11c9e66072901148d589737b4f1f618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Vr6lBoH6QvcCrW8QOv7EA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">新Maven项目</figcaption></figure><p id="0eb9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击“下一步”。现在您已经准备好定义POM文件了。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="8686" class="mg lc iq bd ld mh mi mj lg mk ml mm lj mn mo mp lm mq mr ms lp mt mu mv ls mw bi translated">定义POM文件</h1><p id="23ea" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">正如我在开始时所描述的，我们必须在POM.xml文件中定义项目的依赖关系。让我们一起来做吧。</p><h2 id="ef16" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">性能</h2><p id="1f81" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在properties标签中，定义您想要使用的Dropwizard和Kotlin的版本。<br/>你也可以通过属性定义Kotlin编译器配置。<br/>在这种情况下，我定义了languageVersion(您希望确保源代码与Kotlin的指定版本兼容)和jvmTarget(生成的JVM字节码的目标版本)。</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h2 id="c38f" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">属国</h2><p id="8d7e" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">为了编译、构建、运行和测试，您的项目需要依赖项。在dependencies标签中，我们将定义drowizard-core和kotlin-stdlib-jdk8。</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="e2d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">广义地说，dropwizard-core模块包括:</p><ul class=""><li id="0df7" class="ne nf iq kf b kg kh kk kl ko ng ks nh kw ni la nj nk nl nm bi translated">Jetty — HTTP服务器。</li><li id="d739" class="ne nf iq kf b kg nn kk no ko np ks nq kw nr la nj nk nl nm bi translated">Jersey — RESTful web框架。</li><li id="6ce2" class="ne nf iq kf b kg nn kk no ko np ks nq kw nr la nj nk nl nm bi translated">用于JVM的JSON库。</li><li id="9390" class="ne nf iq kf b kg nn kk no ko np ks nq kw nr la nj nk nl nm bi translated">度量——应用度量库。</li></ul><h2 id="834e" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">汇编</h2><p id="71a6" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">首先，我们将在<code class="fe ns nt nu nv b">&lt;sourceDirectory&gt;</code>和<code class="fe ns nt nu nv b">&lt;testSourceDirectory&gt;</code>中指定源目录，以便编译源代码。<br/>这个部分负责Kotlin插件的配置，以便编译我们的源代码。</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="6271" class="mg lc iq bd ld mh mi mj lg mk ml mm lj mn mo mp lm mq mr ms lp mt mu mv ls mw bi translated">项目结构和配置文件</h1><p id="39e2" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">这是我的项目结构，您可以创建相同的结构。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/6a619e291ac81312253f45ad417bf517.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*J4P0UhSzXgbSY2zD__Nd5A.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">项目结构</figcaption></figure><p id="198a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在YAML配置文件中定义参数，该文件被反序列化为我们的配置类的实例。<br/>让我们创建它们两个。在src/main/resources中创建my-app-config.yml，并向该文件添加一个参数，如下所示:</p><pre class="my mz na nb gt nx nv ny nz aw oa bi"><span id="8e33" class="lb lc iq nv b gy ob oc l od oe">configTest: Ron</span></pre><p id="69cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们定义我们的配置类，它扩展了Dropwizard配置类。<br/>在配置包中创建MyAppConfig.kt。代码如下:</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="f7ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用JsonProperty允许Jackson将属性(在我们的例子中是configTest)从YAML文件反序列化到应用程序的配置实例中。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="320c" class="mg lc iq bd ld mh mi mj lg mk ml mm lj mn mo mp lm mq mr ms lp mt mu mv ls mw bi translated">创建应用程序类</h1><p id="65b5" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">要运行Dropwizard RESTful服务器的实例，我们必须实现我们的应用程序类。<br/>在mydropwizardapp中创建一个新的MyApp类，并实现如下:</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="660a" class="mg lc iq bd ld mh mi mj lg mk ml mm lj mn mo mp lm mq mr ms lp mt mu mv ls mw bi translated">创建和注册资源类</h1><p id="001c" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">现在我们可以添加第一个端点了！<br/>为此，我们需要创建一个新泽西REST资源。<br/>在mydropwizardapp/resources中创建一个新类— HelloWorldResource.kt</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="6fa0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您所看到的，一个资源与一个URI模板相关联，在我们的例子中是“/helloWorld”。@Path注释告诉Jersey这个资源在URI“/hello world”是可用的。</p><p id="a2e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们已经准备好完成MyApp代码并将我们的资源注册到应用程序中。<br/>在run方法中，编写以下代码来注册HelloWorldResource。</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="a58a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，我们正在使用配置YAML并将属性传递给资源(myAppConfig.configTest)。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="4374" class="mg lc iq bd ld mh mi mj lg mk ml mm lj mn mo mp lm mq mr ms lp mt mu mv ls mw bi translated">运行应用程序</h1><p id="d1bd" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我们准备好运行我们的应用程序了！<br/>为此，您应该编辑MyApp运行配置中的“程序参数”,如下所示:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/7e66b588908cca19398452c26095477f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fjE1kXOhWMej-_kZMYWUKg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">配置</figcaption></figure><p id="4fb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它告诉Dropwizard应用程序作为服务器运行，并指定配置文件的位置。</p><p id="0105" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在你可以点击运行:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/03b7500060b923aab49ca0edfd4ae6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*q0lZzzu81ApSL7iFga3IuA.png"/></div></figure><p id="cec0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您应该会在“运行”选项卡上看到以下信息消息:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/af2a13ba8bc3af3a41c98fbe76d0822f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dus2c6XcEDl1nsX5EEt_UA.png"/></div></div></figure><p id="d21a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们的资源被正确地注册为/helloWorld路径上的GET请求。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/81439b0f6ef8d028bb27f183670013c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZeHs9R2PEpZo1Lwf9egP1A.png"/></div></div></figure><p id="35b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们的应用程序运行在端口8080上。</p><p id="ed3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了调用和测试我们的资源，您可以编写:<br/> <code class="fe ns nt nu nv b">curl HTTP://localhost:8080/helloWorld</code> <br/>，您应该会看到下面的预期输出:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/c048a0525dcbabff41a4edca464a6c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*3487uMsvDT5irYTwWCsQZQ.png"/></div></figure><p id="b27e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个选择是打开浏览器，在地址栏中键入<a class="ae kc" href="http://localhost:8080/helloWorld" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/hello world</a>。</p><p id="dd60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如您所见，我们获得了所需的输出，包括config属性。<strong class="kf ir">恭喜你！</strong></p></div></div>    
</body>
</html>