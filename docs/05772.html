<html>
<head>
<title>Improve Raspberry Pi 4 disc read speed with 64-bit Raspbian OS and USB mass storage boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过64位Raspbian操作系统和USB大容量存储启动提高Raspberry Pi 4光盘读取速度</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/improve-raspberry-pi-4-disc-read-speed-with-64-bit-raspbian-os-with-usb-mass-storage-boot-4a22ff2d34e1?source=collection_archive---------17-----------------------#2020-09-29">https://levelup.gitconnected.com/improve-raspberry-pi-4-disc-read-speed-with-64-bit-raspbian-os-with-usb-mass-storage-boot-4a22ff2d34e1?source=collection_archive---------17-----------------------#2020-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f473" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">微型SD卡是将操作系统添加到Raspberry Pi的默认方式。但是如果你想让你的系统更可靠，你需要考虑一个替代方案。SD卡速度不是很快，当你向光盘写入大量数据时，sd卡可能会损坏。</p><p id="d0e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Raspberry Pi论坛上有一个很长的帖子<a class="ae kl" href="https://www.raspberrypi.org/forums/viewtopic.php?f=29&amp;t=44177" rel="noopener ugc nofollow" target="_blank">“STICKY:how to:Move the file system to a USB stick/Drive”</a>，在那里你可以找到很多额外的信息，但是这篇帖子包含了一个简短的版本，它为我将我的8GB内存的<strong class="jp ir"> Raspberry Pi 4变成一个真正的工作狂</strong>。</p><p id="95d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的过程在<a class="ae kl" href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/msd.md" rel="noopener ugc nofollow" target="_blank">“USB大容量存储引导”</a>中有描述，但这些是树莓Pi 4所需的唯一步骤:</p><ul class=""><li id="4e40" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">在PC、苹果或Raspberry Pi上，从Raspberry Pi网站下载<a class="ae kl" href="https://www.raspberrypi.org/downloads/" rel="noopener ugc nofollow" target="_blank">“成像仪”工具</a></li><li id="7973" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">使用“成像仪”将最新的引导程序写入SD卡(注意:这不是真正的引导程序，而是替代板载引导程序)</li></ul><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/e1e63f77b5c872b833e02bba203978e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/0*EbjXSgnxuHIsbeXV.png"/></div></div></figure><ul class=""><li id="c230" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">关掉树莓派的电源</li><li id="af83" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">插入sd卡。</li><li id="ead9" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">上电树莓Pi</li><li id="ad03" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">等待至少10秒钟</li><li id="0017" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">如果成功:绿色LED灯将快速闪烁(永久闪烁),如果连接了HDMI显示器，屏幕将显示绿色</li><li id="27aa" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">如果不成功:将显示错误模式，如果连接了HDMI显示器，屏幕将显示红色</li></ul><h1 id="fe97" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">Raspbian操作系统64位(测试版)</h1><p id="9a82" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">Raspbian OS是Raspberry Pi提供的操作系统，基于Debian。由于只有最新的Raspberry Pi-boards有64位芯片，Raspbian OS的官方版本只有32位。但是有一个正在开发的64位Raspbian操作系统版本！让我们用那一个…</p><p id="fc18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我将这个64位测试版写到三张不同的光盘上来比较结果。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/2ca57b3cf94a2eb58b5394c019ad9d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*WqrhLF29tQeAQ_hE.jpg"/></div></figure><ul class=""><li id="f3cd" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">从树莓派论坛下载OS-img文件<a class="ae kl" href="https://www.raspberrypi.org/forums/viewtopic.php?f=117&amp;t=275370" rel="noopener ugc nofollow" target="_blank"/></li><li id="ebce" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">再次使用“成像仪”工具，并通过“使用自定义”选项选择您刚刚下载的文件</li></ul><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/307f8cdcc4f6d12adecf0b6e8f9ebe90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/0*rZclPRHqbs4s1cp5.png"/></div></figure><p id="700f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个64位操作系统版本仍在开发中，尚未完全完成。如果你对此有疑问和评论，可以看看这个论坛帖子<a class="ae kl" href="https://www.raspberrypi.org/forums/viewtopic.php?f=63&amp;t=275372" rel="noopener ugc nofollow" target="_blank">“STICKY:Raspberry Pi OS(64 bit)beta测试版反馈”</a>。</p><h1 id="c3e8" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">微型SD卡</h1><p id="dada" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated"><a class="ae kl" href="https://www.kiwi-electronics.nl/transcend-64GB-class-10-microsd-sdxc-met-adapter" rel="noopener ugc nofollow" target="_blank">“创见64GB microSD”</a>的第一次测试如预期般顺利开始。</p><h1 id="16e3" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">闪存盘</h1><p id="9962" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">第二个测试，去掉SD卡，用的是<a class="ae kl" href="https://www.kiwi-electronics.nl/32gb-transcend-jetflash-780-usb-30-flash-drive-mlc-210mbs" rel="noopener ugc nofollow" target="_blank">“32GB创见JetFlash 780 USB 3.0闪存盘”</a>…而<strong class="jp ir">我们有了赢家！无需配置或其他更改！只需将闪存盘插入USB 3(蓝色)端口，Raspberry Pi就会像SD卡一样启动</strong>。</p><h1 id="72e0" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">固态硬盘</h1><p id="e757" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">挑战极限……如果有一个500Gb的硬盘，大小和树莓派差不多，那该有多好？我们用一个<a class="ae kl" href="https://www.coolblue.be/nl/product/853658/wd-black-p50-game-drive-ssd-500gb.html" rel="noopener ugc nofollow" target="_blank">“WD BLACK P50游戏硬盘SSD 500 GB”</a>试试吧。</p><p id="2aad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但没有运气…连接到USB 3的Pi无法启动。当连接到USB 2时，它可以工作，但速度比预期低很多。重新启动几次后，我似乎把光盘搞砸了，因为我又一次看到了同样的错误屏幕…</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/342a2f8cbf774fcbe669d6580df595d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*qT549muzoNxmg5kU.jpg"/></div></figure><p id="79cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">显然，<strong class="jp ir">不是所有的固态硬盘都支持在Raspberry Pi上进行USB引导，所以我需要进一步调查这个问题…如果你有如何解决这个问题的想法，请告诉我！</strong></p><p id="dc42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是“dmesg”信息，该信息是在主板使用另一张光盘启动时连接该驱动器时记录的:</p><pre class="lb lc ld le gt mr ms mt mu aw mv bi"><span id="6bc7" class="mw ln iq ms b gy mx my l mz na">[  567.261232] usb 2-2: new SuperSpeed Gen 1 USB device number 8 using xhci_hcd<br/>[  567.282283] usb 2-2: New USB device found, idVendor=1058, idProduct=2642, bcdDevice=10.03<br/>[  567.282293] usb 2-2: New USB device strings: Mfr=2, Product=3, SerialNumber=1<br/>[  567.282298] usb 2-2: Product: Game Drive<br/>[  567.282302] usb 2-2: Manufacturer: Western Digital<br/>[  567.293640] scsi host1: uas</span></pre><p id="c734" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章<a class="ae kl" href="https://www.shellhacks.com/disk-speed-test-read-write-hdd-ssd-perfomance-linux/" rel="noopener ugc nofollow" target="_blank">“磁盘速度测试(读/写):Linux中的HDD、SSD性能(shellhacks . com)”</a>中，我找到了几个测试磁盘速度的测试命令。让我们在不同的光盘上使用它们。</p><h1 id="2545" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">使用的命令</h1><p id="45f4" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">写文件:<br/> <code class="fe nb nc nd ms b">$ sync; dd if=/dev/zero of=tempfile bs=1M count=1024; sync</code></p><p id="cdd6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">读取一个文件，但是使用了缓存的文件，所以没有真正的速度:<br/> <code class="fe nb nc nd ms b">$ sync; dd if=/dev/zero of=tempfile bs=1M count=1024; sync</code></p><p id="2025" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">读取一个文件，但是先清空缓存获得真实速度:<br/> <code class="fe nb nc nd ms b">$ sudo /sbin/sysctl -w vm.drop_caches=3<br/>$ dd if=tempfile of=/dev/null bs=1M count=1024</code></p><p id="b905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用hdparm作为读取速度的基准工具进行测试:<br/> <code class="fe nb nc nd ms b">$ sudo apt-get install hdparm<br/>$ sudo hdparm -Tt /dev/sda # For the USB disc<br/>$ sudo hdparm -Tt /dev/mmcblk0 # For the SD card</code></p><h1 id="0a8d" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">结果</h1><p id="d054" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">如果你有一个受支持的闪存盘，从SD切换到USB启动是非常容易的，而且读取速度要快得多！与更高的可靠性相结合，这使交换机成为一个go go go…；——)</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="f9c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nl">原载于</em><a class="ae kl" href="https://webtechie.be/post/2020-09-29-64bit-raspbianos-on-raspberrypi4-with-usbboot/" rel="noopener ugc nofollow" target="_blank"><em class="nl">https://web techie . be</em></a><em class="nl">。</em></p></div></div>    
</body>
</html>