<html>
<head>
<title>Ten lessons learned from coding in scientific research</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">科学研究中编码的十个教训</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ten-lessons-learned-from-coding-in-scientific-research-8f1e00280b57?source=collection_archive---------8-----------------------#2022-12-19">https://levelup.gitconnected.com/ten-lessons-learned-from-coding-in-scientific-research-8f1e00280b57?source=collection_archive---------8-----------------------#2022-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="48c4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在我作为一名天体物理学研究生学习编程时，关于Python编码的简单事实给了我很大的帮助</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/166ea56be03d24f2853c91f2604acaa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsQEAgCWpWwk3OboXRxDqw.jpeg"/></div></div></figure><p id="1a43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于那些从事科学研究的人来说，编码经验主要是通过与我们不同领域相关的各种问题解决任务来交付的。作为一名年轻的天文学家，这对我来说是千真万确的，因为我已经度过了我学术生涯的研究生和博士后阶段。我自学了如何用Python编码，这是有益的，但也有一些陷阱。对于专业软件程序员来说，我早期的一些代码可能看起来像是妈妈做的意大利面条。此外，我似乎花了更多的时间阅读StackOverflow论坛，而不是真正的Python文档…不幸的是。然而，即使没有正式的计算机科学课程的指导，我也在成为一名合格的Python程序员的道路上取得了一些不错的进展。以下是我学到的最突出的十条经验。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="7071" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">1.pandas非常适合处理列表数据</h2><p id="90ef" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">观测天文学家经常以源目录的形式处理列表数据。用无线电、中红外和光学进行巡天的望远镜能够在有限的积分时间内(从几分钟到几天)探测天空中一个观察区域内的多个物体。当我作为学生开始我的第一次真实数据分析时，它涉及到一个包含数千个射电源的目录，由甚大阵列(<a class="ae mw" href="https://public.nrao.edu/telescopes/vla/" rel="noopener ugc nofollow" target="_blank"> VLA </a>)观测。我需要编写一个软件管道来计算源的几个物理属性。</p><p id="44bf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最初，我为循环写了一系列<em class="lq">来遍历目录，我的代码似乎运行得相当……慢。然后我发现了<em class="lq">熊猫</em>的神奇世界，经过几次尝试后，我很明显地发现，表格数据在<em class="lq">数据框架</em>格式<em class="lq">中更容易处理。</em>结果，我变得相当好奇，想知道为什么<em class="lq">熊猫</em>在</em>循环上比<em class="lq">有优势。参加Python meetup ( <em class="lq"> PyMunich </em>)为我提供了我需要的答案——主要原因是<em class="lq"> pandas </em>使用<em class="lq"> NumPy </em>数组操作来处理数据帧，这通常比传统的<em class="lq"> for </em>循环执行得快得多。</em></p><div class="mx my gp gr mz na"><a href="https://www.appsloveworld.com/pandas/100/15/why-is-pandas-so-madly-fast-how-to-define-such-functions" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">[代码]-为什么熊猫的速度如此之快？如何定义这样的函数？熊猫</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">从产生正确结果的意义上来说，您的代码是正确的。显式迭代一个…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">www.appsloveworld.com</p></div></div></div></a></div><h2 id="6a1d" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">2.列表理解非常漂亮</h2><p id="c0cb" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">通过一些奇迹，我发现了理解列表的优雅。当我不知道什么更好的时候，我会为循环写一个<em class="lq">(他们又来了！)在Python列表上执行单个操作。正如你所想象的，这相当…慢。一旦我发现了list comprehensions，我就明白了，一个包含200行不必要代码的Python脚本可以通过简单地调用list comprehensions而被简化为50行。</em></p><p id="4176" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这一小块代码…</p><pre class="kj kk kl km gt nj nk nl bn nm nn bi"><span id="c487" class="no lz it nk b be np nq l nr ns">some_list = list(range(100))<br/>sq_root = []<br/>for x in some_list: <br/>    sq_root.append(x**0.5)<br/>print(sq_root)</span></pre><p id="ada9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在列表理解的帮助下，可以转换为:</p><pre class="kj kk kl km gt nj nk nl bn nm nn bi"><span id="00b1" class="no lz it nk b be np nq l nr ns">some_list = list(range(100))<br/>sq_root = [ x**0.5 for x in some_list ]<br/>print(sq_root)</span></pre><p id="cd63" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">相当漂亮和…时髦！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/0652091248b926a118640a87180b86f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*aT6NQVPEbmrUv8QG1U5_7w.gif"/></div></figure><h2 id="9641" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">3.重复的代码块应该是一个函数</h2><p id="a006" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">这太尴尬了！在我早期，我经常想复制和粘贴需要在一个脚本中多次执行的代码行。重复的代码块可能是一个编程新手最明显的迹象之一，我显然就是这样。复制和粘贴大块的代码显然是低效的，而且会占用不必要的内存。时间教会了我(也教会了很多人)，重复的代码块应该被正确地插入到一个<em class="lq">函数中。</em></p><p id="aa3f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">举个例子，一个完全不了解Python函数的新手，可能会写出类似下面这样的东西:</p><pre class="kj kk kl km gt nj nk nl bn nm nn bi"><span id="bf80" class="no lz it nk b be np nq l nr ns">x1,y2 = 4,5<br/>h1 = x**2 + y**2<br/><br/>x2,y2 = 6,7<br/>h2 = x**2 + y**2 </span></pre><p id="e404" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你的常识会告诉你这很可怕(当你了解Python函数的时候)。</p><p id="5a16" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将主运算(勾股定理)写成一个函数可以立即改善这一点。</p><pre class="kj kk kl km gt nj nk nl bn nm nn bi"><span id="765e" class="no lz it nk b be np nq l nr ns">def pythag(x,y): <br/>    return x**2 + y**2<br/><br/>values = [ (4,5), (6,7), (8,9), (9,10) ]<br/>h = [ pythag(x,y) for (x,y) in values ]</span></pre><h2 id="5167" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">4.这些类是什么，我们为什么需要它们？</h2><p id="5e7b" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">在我理解“面向对象编程”的含义之前，为什么需要定义一个<em class="lq">类</em>对我来说并不总是显而易见的。我会检查我在Python发行版中安装的包的源代码，并想知道所有的<em class="lq">类</em>是关于什么的。</p><p id="f837" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">直到有一天，我需要组织工作流进行分析，并感到有一种冲动，要整齐地安排我进行数据分析所需的所有功能。我试图定义一个我自己的<em class="lq">类</em>。阅读Python文档和Python大师卢西亚诺·拉马尔霍写的令人惊叹的书<a class="ae mw" href="https://www.fluentpython.com/" rel="noopener ugc nofollow" target="_blank"> <em class="lq">流利的Python </em> </a> <em class="lq"> </em>，我学会了如何在一个<em class="lq">类中设置模块(或函数)。</em>一旦我定义了这个<em class="lq">类</em>对象，我就可以将定义的模块导入到Python脚本中，并随意使用它们。现在这似乎是常识，但在当时，这是关于Python的一个相当微妙的细节，我对此一无所知。</p><p id="454a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个例子受到Brett Slatkin的<a class="ae mw" href="https://www.oreilly.com/library/view/effective-python-59/9780134034416/" rel="noopener ugc nofollow" target="_blank"> <em class="lq">有效Python </em> </a>的第3章的启发，我定义了一个名为<em class="lq"> Apartment </em>的<em class="lq">类</em>对象，其中创建了一个名为<em class="lq"> desk </em>的空字典。我们可以向这个字典中添加键/值对。模块<em class="lq"> add_item </em>可以向字典中添加条目。模块<em class="lq"> define_use </em>然后将值分配给字典中的项目<em class="lq"> </em>键。现在，创建了一个<em class="lq">类</em>对象，它包含对我们定义的变量执行操作的模块。</p><pre class="kj kk kl km gt nj nk nl bn nm nn bi"><span id="f1a5" class="no lz it nk b be np nq l nr ns">Class Apartment(object):<br/>    def _init_(self): <br/>        self._desk = {}<br/><br/>    def add_item(self, item): <br/>        self._desk[item] = []<br/><br/>    def define_use(self, item, purpose):<br/>        self._desk.append[item].append(purpose)</span></pre><h2 id="13f2" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">5.现在跟我一起说，“虚拟…环境”</h2><p id="5c63" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">好吧，哇，我曾经在我的机器上安装带有冲突的<a class="ae mw" href="https://stackoverflow.com/questions/36500141/python-packages-with-conflicting-dependencies" rel="noopener ugc nofollow" target="_blank"> Python依赖关系</a>的Python包弄得一团糟。如果我需要运行我在GitHub上找到的Python包，而不干扰我的常规<em class="lq"> anaconda </em>发行版中的安装，该怎么办？这是一个虚拟环境会派上用场的场景。在一个P <a class="ae mw" href="https://docs.python.org/3/library/venv.html" rel="noopener ugc nofollow" target="_blank"> ython虚拟环境</a>中，完全可以安装一个独立于安装在计算机上的Python包发行版的包及其依赖项。在Unix命令行中创建并激活Python虚拟环境的简单方法是:</p><pre class="kj kk kl km gt nj nk nl bn nm nn bi"><span id="fcf9" class="no lz it nk b be np nq l nr ns">mkdir ./my_project   <br/>cd 'my project'<br/>python3 -m venv project_container<br/>source project_container/bin/activate</span></pre><p id="9759" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就这样，您创建了一个有用的容器，可以在其中安装Python包及其所有依赖包(和版本),而不会中断机器上Python包的分发。</p><h2 id="42e9" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">6.可以在Matplotlib.rcParams中编辑matplotlib默认设置</h2><p id="75a7" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">数据可视化在科学研究中至关重要。天文学也不例外。无论一个人是理论家还是观测天文学家，都必须以清晰的视觉形式展示自己的结果——这通常是一个情节。对于科学派的python来说，matplotlib和PyPlot仍然是必不可少的。</p><p id="5506" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在编写了几个脚本来创建图之后，人们可能会意识到他们已经开发了一种签名风格，如果你愿意的话，可以选择字体、刻度长度、刻度方向、填充、线宽、线条样式、标记大小等。您可以通过更改名为<em class="lq"> matplotlib.rcParams </em>的字典类型对象中的条目来创建新的默认设置，而不是在您编写的每个新绘图脚本中更改所有这些变量。新设置将在运行时或Python解释器运行脚本时被采用。假设你选择的默认设置保持不变，那么每次你使用<em class="lq"> matplotlib </em>创建图形时，你都可以看到自己定制的绘图设置。</p><div class="mx my gp gr mz na"><a href="https://matplotlib.org/stable/tutorials/introductory/customizing.html" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">使用样式表和rcParams自定义Matplotlib-Matplotlib 3 . 6 . 2文档</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">您可以在python脚本中动态更改默认rc(运行时配置)设置，也可以从…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">matplotlib.org</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ks na"/></div></div></a></div><h2 id="923e" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">7.哦，亲爱的，另一个绝对文件路径！</h2><p id="7a52" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">从长远来看，绝对文件路径显然会使代码不可用。我是吃了苦头才知道的。随着时间的推移，文件被删除，文件夹被重新排列或重命名，一个人的目录结构很少保持不变。因此，脚本中的绝对文件路径不可能长久有效。在对目录结构进行修改后运行脚本会导致Python解释器抛出一个<em class="lq"> FileNotFoundError。</em></p><p id="d3e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq"> AskPython </em>已经提供了关于<em class="lq"> FileNotFoundError </em>有时由绝对文件路径引起的综合指南。</p><div class="mx my gp gr mz na"><a href="https://www.askpython.com/python/examples/python-filenotfounderror" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">[已解决] Python filenotfounderror -快速指南- AskPython</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">在本文中，我们将解决Python中一个非常常见的错误——file not found error。如果您曾与……</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">www.askpython.com</p></div></div><div class="nu l"><div class="oa l nw nx ny nu nz ks na"/></div></div></a></div><p id="220a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用绝对文件路径的另一个不幸的后果是你的代码变得对用户不友好，这就引出了下一点。</p><h2 id="e290" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">8.硬编码的值使代码对用户不友好</h2><p id="37d3" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">我有故事要讲！有一次，我为一个软件工程面试过程提交Python编码脚本。该脚本有大量的硬代码值。我面试失败了，面试官在我的反馈表中称我为“初学者”。故事结束了。</p><p id="f0d4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当然，当我意识到在工业界(或者学术泡沫之外)，我可能最终会写一些由别人而不是我和我桌上的小妖精来运行和开发的代码时，我开始努力学习让代码变得对用户友好的艺术。在这个艰难的旅程中，一个很好的起点是PEP-8，这里制定了正确编写Python代码的规则(甚至在我还在上小学的时候)。</p><h2 id="ecc3" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">9.考虑参加MOOC</h2><p id="fafb" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">大规模在线开放课程(MOOCs)是用新鲜信息补充个人学习和编码经验的绝佳方式。我通过Coursera 免费学习机器学习课程，度过了一段美好的时光。<a class="ae mw" href="https://www.khanacademy.org/" rel="noopener ugc nofollow" target="_blank">可汗学院</a>、<a class="ae mw" href="https://www.edx.org/" rel="noopener ugc nofollow" target="_blank"> edX </a>和<a class="ae mw" href="https://www.udemy.com/" rel="noopener ugc nofollow" target="_blank"> uDemy </a>是其他几个知名网站，它们开设了MOOCs课程，教授从新手到高级水平的Python编程。</p><h2 id="b9a8" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">10.编码当然可以自学</h2><p id="6410" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">你需要一个计算机科学的博士学位才能成为一名编程专家吗？很可能不会。天文学家花大部分时间开发工具来处理望远镜数据，编写模拟天体物理过程的代码，并开发工具来帮助其他天文学家分析他们的数据，他们是一些最精通的程序员。任何从事物理现象建模和数据分析领域工作的学者都是如此。大多数有经验的程序员可能已经知道，当谈到学习如何编写更好的代码时，经常练习可能是一个人进步的最基本的关键。</p></div></div>    
</body>
</html>