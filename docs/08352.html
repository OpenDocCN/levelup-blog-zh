<html>
<head>
<title>Safari (Webkit) about to release support for JS modules inside the worker scope</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Safari (Webkit)即将在worker范围内发布对JS模块的支持</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/safari-webkit-about-to-release-support-for-js-modules-inside-the-worker-scope-9dd33fc20190?source=collection_archive---------2-----------------------#2021-04-24">https://levelup.gitconnected.com/safari-webkit-about-to-release-support-for-js-modules-inside-the-worker-scope-9dd33fc20190?source=collection_archive---------2-----------------------#2021-04-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bec7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是让UI开发回到它所属的地方的一大步:<br/>进入浏览器。</p><h1 id="5bcb" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">内容</h1><ol class=""><li id="7145" class="lj lk iq jp b jq ll ju lm jy ln kc lo kg lp kk lq lr ls lt bi translated">相关票证</li><li id="99e6" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">安装“Safari技术预览版”</li><li id="14fa" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">如何从JS模块创建一个worker？</li><li id="3056" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">在大型用例中验证逻辑</li><li id="cfb2" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">比较Chrome、Safari和Firefox的渲染性能</li><li id="06e9" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">Safari (Webkit)缺什么？</li><li id="0fb2" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">最后的想法</li></ol><h1 id="28e2" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">1.相关票证</h1><p id="77c3" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">当我打开票的时候，我非常兴奋，看到它变成了“已解决”。</p><div class="mc md gp gr me mf"><a href="https://bugs.webkit.org/show_bug.cgi?id=164860" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">164860-Workers中的JS模块</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">编辑描述</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">bugs.webkit.org</p></div></div></div></a></div><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/81d17445986b2b804ec9a92db24a4b3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*7kdKSDkn6bep0ka4sQ3h5Q.png"/></div></figure><h1 id="297e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">2.安装“Safari技术预览版”</h1><p id="4f31" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">安装极其简单:</p><div class="mc md gp gr me mf"><a href="https://developer.apple.com/safari/download/" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">下载— Safari —苹果开发者</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">由WebKit引擎支持，Safari提供了领先的性能、兼容性和一组出色的内置web…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">developer.apple.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb mu mf"/></div></div></a></div><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/e40a8d07b268f341c359503444fcee38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XlGvWEK4n4Mqvd58XpEc9Q.png"/></div></div></figure><h1 id="c5ac" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">3.如何从JS模块创建一个worker？</h1><p id="83c3" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">您可以像这样创建一个非基于模块的工作线程:</p><pre class="mp mq mr ms gt nh ni nj nk aw nl bi"><span id="7331" class="nm km iq ni b gy nn no l np nq">const worker = new Worker('worker.js');</span></pre><p id="b84b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您确实想要一个JS模块作为起点，只需使用type选项:</p><pre class="mp mq mr ms gt nh ni nj nk aw nl bi"><span id="0d4d" class="nm km iq ni b gy nn no l np nq">const worker = new Worker('worker.mjs', {<br/>  type: 'module'<br/>});</span></pre><h1 id="6405" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">4.在大型用例中验证逻辑</h1><p id="dce0" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">neo.mjs 很可能是最大的项目，它依赖于在worker范围内使用js模块。毕竟，你的应用和组件都在那里。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/eb12d351e1af2a7a456898625887fa7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*d4S7Ay9a9kP3ldq8BfgXMg.png"/></div></figure><p id="b5ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到目前为止，在Chromiun (Chrome &amp; Edge)中，只有在没有任何构建和编译的情况下，才可能使用开发模式→真实代码。</p><p id="e78a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，我们以前也可以在Safari中使用基于webpack的dist/development和dist/production输出，但如果您想为Webkit设计或修复特定的东西，这并不有趣。</p><p id="5655" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的测试案例是Covid Dashboard，这是一个相当复杂的应用程序。</p><p id="b2e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里找到源代码:<a class="ae nr" href="https://github.com/neomjs/neo/tree/dev/apps/covid" rel="noopener ugc nofollow" target="_blank"> apps/covid </a></p><div class="mc md gp gr me mf"><a href="https://neomjs.github.io/pages/node_modules/neo.mjs/apps/covid/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">数字中的新冠肺炎</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">编辑描述</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">neomjs.github.io</p></div></div></div></a></div><p id="0196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在普通Safari版本中打开它会导致:</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nt"><img src="../Images/ddab7801cf6ccd33ba14dc56146c190e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*62rFsnW4DXtm_x81DvL_aw.png"/></div></div></figure><p id="4188" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果我们使用技术预览再次打开它:</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nu"><img src="../Images/9c63e800f8ee69e431e10f52e27d9c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cZS7phHKMjO39cxUz9iAqw.png"/></div></div></figure><p id="ecb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(我正在使用本地版本删除自定义警告文本)</p><p id="0d15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您在这里可以看到:</p><ol class=""><li id="e0a2" class="lj lk iq jp b jq jr ju jv jy nv kc nw kg nx kk lq lr ls lt bi translated">我们可以在app worker范围内打开一个文件</li><li id="f8a4" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">这是一个真正的JS模块</li><li id="fcad" class="lj lk iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">没有源地图</li></ol><h1 id="ecdf" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">5.比较Chrome、Safari和Firefox的渲染性能</h1><p id="f420" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">我已经有一段时间没有在Safari中测试性能了。我不得不承认:<br/>我印象深刻。和现在的铬绝对是一个级别的。</p><p id="e437" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我创建螺旋和3d画廊主要是为了真正强调浏览器的渲染引擎。我的目标是看看使用neo.mjs workers设置可以实现多少dom操作。</p><p id="a760" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">两种视图都使用dom节点和css-transform。没有画布，SVG或webGL。在Chromium中，我可以在本地每秒进行超过30，000次dom操作。</p><p id="b1fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我现在没有在这里做任何真正的基准测试，但想给你一个感觉，它显示了3个短视频。请记住，录制视频会影响性能。</p><p id="c592" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">铬合金:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="47a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Safari技术预览:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="oa nz l"/></div></figure><p id="d2d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">干得好！我注意到，在Chrome中，将“翻转项目”旋转180度仍然更好:不是性能，而是旋转方向感觉随机。</p><p id="3387" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一张新票，还不确定它最适合哪一类。</p><p id="a512" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">火狐每夜:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="8428" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Firefox还不支持worker范围内的JS模块。</p><div class="mc md gp gr me mf"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1247687" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">1247687 -实施工人模块</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">核心领域的新成员:工人。最后更新于2021年4月8日。</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">bugzilla.mozilla.org</p></div></div></div></a></div><p id="a3a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们需要使用该应用的dist/production版本:<a class="ae nr" href="https://neomjs.github.io/pages/node_modules/neo.mjs/dist/production/apps/covid/index.html#mainview=table" rel="noopener ugc nofollow" target="_blank">dist/production/apps/covid/</a></p><p id="9994" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的渲染表现感觉真的很差，所以还有工作要做！</p><h1 id="cb3e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">6.Safari (Webkit)缺什么？</h1><p id="9375" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">我们仍然需要对共享工作者的支持:</p><div class="mc md gp gr me mf"><a href="https://bugs.webkit.org/show_bug.cgi?id=149850" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">149850 -恢复对共享工作者的支持</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">错误149850:恢复对共享工作人员的支持</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">bugs.webkit.org</p></div></div></div></a></div><p id="8ec4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Chromium和Firefox都支持它们。</p><p id="2a79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一点尤其重要，因为iOS上的所有浏览器都必须使用它。</p><p id="adb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也希望看到多窗口covid应用程序在这里运行:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="oa nz l"/></div></figure><p id="5c98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">共享工作者对移动设备也很重要，因为许多应用程序使用包含多个web视图的本机外壳(无头浏览器)。</p><p id="37d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以在他们之间直接交流。</p><h1 id="ae9c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">7.最后的想法</h1><p id="e864" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">不知道哪个Safari发布版本会包含这个新功能。</p><p id="6d6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我会密切关注它，一旦它将Safari添加到neo.mjs开发模式支持的浏览器列表中。</p><div class="mc md gp gr me mf"><a href="https://github.com/neomjs/neo" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">近地天体</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">neo.mjs使您能够使用一个以上的CPU创建可扩展的高性能应用程序，而无需使用…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">github.com</p></div></div><div class="mw l"><div class="ob l my mz na mw nb mu mf"/></div></div></a></div><p id="3e15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【边节点】neo.mjs刚刚发布版本2:</p><div class="mc md gp gr me mf"><a href="https://itnext.io/the-webworkers-driven-ui-framework-neo-mjs-version-2-release-announcement-b91b476d6f16" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">webworkers驱动的UI框架neo.mjs第2版发布公告</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">新产品的概念必须是颠覆性的，否则就没什么必要。然而，使用它们的方法…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">itnext.io</p></div></div><div class="mw l"><div class="oc l my mz na mw nb mu mf"/></div></div></a></div><p id="5ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢<a class="ae nr" href="https://www.linkedin.com/in/yusukes/" rel="noopener ugc nofollow" target="_blank">铃木佑介</a>和Webkit团队完成了这一切！</p><p id="44f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问候&amp;快乐编码，<br/>托拜厄斯</p></div></div>    
</body>
</html>