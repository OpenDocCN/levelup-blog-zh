<html>
<head>
<title>Setup PostgreSQL in 10 seconds</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在10秒内设置PostgreSQL</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setup-postgresql-in-10-seconds-c22f7a1369cf?source=collection_archive---------22-----------------------#2020-05-26">https://levelup.gitconnected.com/setup-postgresql-in-10-seconds-c22f7a1369cf?source=collection_archive---------22-----------------------#2020-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e38e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上个月，我写了一篇关于如何在Docker 中设置PostgreSQL+pg admin+PostGraphile的文章，有一种更简单的方法。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/7adf8ce88febacc3398ce84f1155dab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMfETeBhovCiOVsfR_zy5g.jpeg"/></div></div></figure><p id="06a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了启动我在前面的故事中提到的三个容器，我们将使用docker-compose。</p><p id="45a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Compose是一个定义和运行多容器Docker应用程序的工具。使用Compose，您可以使用YAML文件来配置应用程序的服务。然后，只需一个命令，您就可以从您的配置中创建并启动所有服务</p><p id="6153" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Compose基本上是一个三步的过程:</p><ol class=""><li id="0617" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">用一个<code class="fe lh li lj lk b">Dockerfile</code>来定义你的应用环境，这样它可以在任何地方被复制，在这种情况下，我们将使用来自<a class="ae kl" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> dockerhub </a>的图像。</li><li id="74ef" class="ky kz iq jp b jq ll ju lm jy ln kc lo kg lp kk ld le lf lg bi translated">在<code class="fe lh li lj lk b">docker-compose.yml</code>中定义组成你的应用的服务，这样它们可以在一个隔离的环境中一起运行。</li><li id="ea62" class="ky kz iq jp b jq ll ju lm jy ln kc lo kg lp kk ld le lf lg bi translated">运行<code class="fe lh li lj lk b">docker-compose up</code>，Compose会启动并运行你的整个应用程序。</li></ol><h2 id="a426" class="lq lr iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">让我们开始黑吧:</h2><ul class=""><li id="1290" class="ky kz iq jp b jq mj ju mk jy ml kc mm kg mn kk mo le lf lg bi translated">创建一个名为<code class="fe lh li lj lk b">docker-compose.yml</code>的文件</li><li id="847a" class="ky kz iq jp b jq ll ju lm jy ln kc lo kg lp kk mo le lf lg bi translated">在您喜欢的文本编辑器中打开该文件，然后粘贴以下代码:</li></ul><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="a7b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在docker-compose中，我们正在定义我们的服务，它们具有我在上一篇文章中所写的相同配置。</p><ul class=""><li id="b69e" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk mo le lf lg bi translated">创建一个名为<code class="fe lh li lj lk b">.env</code>的文件。该文件将包含您对容器的配置。应该是这样的:</li></ul><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="05a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是所有配置的服务！</p><h2 id="3779" class="lq lr iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">来运行服务</h2><pre class="kn ko kp kq gt mr lk ms mt aw mu bi"><span id="6bb7" class="lq lr iq lk b gy mv mw l mx my"># Run containers for all services in docker-compose.yml<br/>$ docker-compose up<br/><br/># Run containers as daemon (in background)<br/>$ docker-compose up -d</span></pre><h2 id="d37a" class="lq lr iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">重新初始化数据库</h2><p id="e459" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">如果您通过修改<code class="fe lh li lj lk b">/db/init</code>中的文件对数据库模式进行更改，您将需要重新初始化数据库以查看这些更改。这意味着您需要删除Docker卷、数据库Docker映像并重建它。</p><pre class="kn ko kp kq gt mr lk ms mt aw mu bi"><span id="d7dc" class="lq lr iq lk b gy mv mw l mx my"># Stop running containers<br/>$ docker-compose down</span><span id="20a4" class="lq lr iq lk b gy nc mw l mx my"># List Docker volumes<br/>$ docker volume ls</span><span id="e70a" class="lq lr iq lk b gy nc mw l mx my"># Delete volume<br/>$ docker volume rm &lt;your_repository_name&gt;_db</span><span id="df92" class="lq lr iq lk b gy nc mw l mx my"># Delete database image to force rebuild<br/>$ docker rmi db</span><span id="d086" class="lq lr iq lk b gy nc mw l mx my"># Run containers (will automatically rebuild the image)<br/>$ docker-compose up</span></pre><h2 id="08b8" class="lq lr iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">关闭容器</h2><pre class="kn ko kp kq gt mr lk ms mt aw mu bi"><span id="c268" class="lq lr iq lk b gy mv mw l mx my"># Shut down containers<br/>$ docker-compose down</span></pre><p id="5fea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也就是说，用pgAdmin和PostgreSQL运行和部署PostgreSQL数据库的方法更简单了。</p><p id="3241" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想克隆这个库或者做一些修改，所有的代码都在我的Github中。</p></div></div>    
</body>
</html>