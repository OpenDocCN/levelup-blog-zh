# 3 行代码不应该花一整天的时间

> 原文：<https://levelup.gitconnected.com/3-lines-of-code-shouldnt-take-all-day-ce3cd67f6f79>

![](img/e212e56097bc80b129f2682cc43db786.png)

当你进入心流状态时，写代码会更有趣

我在 5 家不同的软件公司工作过，混合了游戏开发、移动开发和网页开发。在所有这些问题中，有一个突出的问题没有得到应有的关注:迭代的时间。最初我计划写构建时间，但是我认为迭代时间更准确地描述了全貌。出于本文的目的，我将迭代时间定义为**看到代码按预期工作的变化所需的时间量**。

这篇文章的目的是帮助提醒你反思你当前的发展过程。您的管道中是否有某个部分花费了过多的时间？有没有一种方法可以创建一些调试工具，使测试变更变得更加容易？单元测试会带来好处吗，但是你一直避免它，因为你认为它有很大的前期成本？

# 电子艺术

我在 2014 年以实习生的身份加入了国际足联团队。对 AAA 游戏开发世界完全陌生。我记得当我看到我的桌面有 16 个(也许更多？)可用的 CPU 内核。然后我记得我按照指示做了准备，并被告知至少要为初始构建准备 30 分钟。有人告诉我，在这之后，增量构建会快得多。

虽然增量编译确实快得多，但是一行代码的编译仍然需要 10 秒以上的时间。当时作为一名相对较新的 C++开发人员，我犯的语法错误很多。**每次我修改代码时，我都要等待 15 秒，看看我做错了什么**。

# 三行代码不应该花一整天来写

这是你在等待的时候想要“做点别的事情”的最佳时机。我可能谷歌了一些随机的东西，试图做另一个改变，或者检查我的即时消息。不可避免地，我会分心，很容易过了整整一分钟才检查我的编译状态。

编译只是第一步。现在，需要将应用程序捆绑并部署到我正在使用的任何控制台上。当我第一次开始工作时，我用的是 PS Vita、任天堂 3DS 和任天堂 Wii。再过 30 秒钟左右，游戏可能已经进入了主机。现在我需要启动游戏，导航到我正在工作的特定游戏区域，最后我可能能够看到我的改变。

我经常在竞争逻辑领域工作。这里的测试变化可能意味着通过几个赛季的职业模式来测试一个变化。

不开玩笑，**要改变 3 行代码**并知道它实际上能正确工作需要一整天的时间。

# 调试工具

我最终转向了较新的控制台，并被介绍给“试验台”。这些精简的包试图通过只关注特定的代码区域来减少迭代次数。一旦我找到了职业模式，我几乎再也没有运行这个游戏。这个测试床将在几秒钟内建立起来，并具有所有类型的调试功能。这一切都在电脑上运行，这使得事情更快。

我兴奋极了！但是我观察了我周围的人，我很清楚很多人不知道如何使用这个工具。相反，他们沿用了启动整个游戏的老方法，通过 UI 手动导航到他们需要测试变化的地方。我很快成为了测试平台的拥护者，并频繁地添加新特性，使得开发新事物变得更加容易。

我仍然偶尔不得不运行完整的游戏，但是这个测试床**拯救了我的理智**，因为它允许我**快速实验**和**学习代码如何工作**。它还允许我以合理的(按我的标准)速度解决实际问题。

# 单元测试

最终，我再次移动了团队，这一次我发现单元测试已经在这个团队中启动了。虽然当时我有一些单元测试的经验，但我从未在游戏开发中使用过。

我得到了关于代码、不同测试以及如何运行的介绍。我发现测试包基本上只包含我们团队工作的游戏特定区域的代码。一个干净的构建可能需要 10 秒，之后的增量构建可能不到一秒。

很难强调这个门槛有多重要。在不到一秒钟的时间内编译(并运行)测试，我现在实际上可以持续关注任务。编译和逻辑错误是不可避免的。但是当我能很快发现错误并重新编译时，我就能进入一种流畅的状态。

我第一次开始喜欢在工作中写代码。重构和移动大块代码轻而易举。修改别人的代码变得容易多了，并且知道我没有完全破坏一切。对修改代码的焦虑消失了。

我继续重写竞争逻辑以加快速度，并添加单元测试。有各种各样的边缘情况，使得单元测试成为确保覆盖所有基础的完美方法。当我最终离开公司时，我感觉好多了，因为我离开了一个有自己检查机制的系统。我花了几个小时弄清楚某样东西应该如何工作，这些时间被编入了测试规范。

# 结束语

我在很多方面都很感激我在艺电的时光。这是我能够看到长期工程计划扎根并提供真正的日常利益的许多次之一。在某些时候，必须有人站出来说**“测试这些变化需要太长的时间，有更好的方法吗？”**这是我们每天都应该问自己的问题。在未来的一篇文章中，我将回顾 web 开发人员需要如何开始更认真地对待迭代时间，因为新工具和框架的涌入开始增加构建时间。

*原载于 2021 年 12 月 14 日*[*https://devtails . XYZ*](https://devtails.xyz/3-lines-of-code-shouldnt-take-all-day)*。*