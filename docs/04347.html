<html>
<head>
<title>Tower : A React-Native Device-Motion Example App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tower:一个React-Native设备运动示例应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tower-a-react-native-device-motion-example-app-8a8e81d333c3?source=collection_archive---------7-----------------------#2020-06-22">https://levelup.gitconnected.com/tower-a-react-native-device-motion-example-app-8a8e81d333c3?source=collection_archive---------7-----------------------#2020-06-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/857d02418a1bfc34cfa51995cad54e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*HtX4YHARtU2-gpr0KvLm1w.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">Tower:一个React-Native设备运动示例应用程序</figcaption></figure><div class=""/><div class=""><h2 id="358f" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">一个简单的例子，说明如何在expo中使用设备动作。</h2></div><p id="4717" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我在研究苹果的指南针应用程序，它也有调平功能。我想到创建相同的应用程序作为例子来理解移动设备运动的物理学。经过多次思考，我想创建一个应用程序，将显示一个圆柱塔的阴影，我们的运动是从不同角度看圆柱的相机视图。</p></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><p id="1e7a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">从这个简单的项目开始，首先，让我们从我们将在项目中使用的不同库的概述开始。</p><h1 id="5aea" class="lw lx je bd ly lz ma mb mc md me mf mg kk mh kl mi kn mj ko mk kq ml kr mm mn bi translated">反应-自然</h1><p id="47f1" class="pw-post-body-paragraph kt ku je kv b kw mo kf ky kz mp ki lb lc mq le lf lg mr li lj lk ms lm ln lo im bi translated">React Native是一个JavaScript框架，用于为iOS和Android编写真实的、本地呈现的移动应用程序。</p><h1 id="8560" class="lw lx je bd ly lz ma mb mc md me mf mg kk mh kl mi kn mj ko mk kq ml kr mm mn bi translated">世博会</h1><p id="d9b3" class="pw-post-body-paragraph kt ku je kv b kw mo kf ky kz mp ki lb lc mq le lf lg mr li lj lk ms lm ln lo im bi translated"><a class="ae mt" href="http://expo.io" rel="noopener ugc nofollow" target="_blank"> Expo </a>是一个通用React应用的框架和平台。它是一套围绕React原生和原生平台构建的工具和服务，帮助您从相同的JavaScript/Typescript代码库开发、构建、部署和快速迭代iOS、Android和web应用程序。</p><h1 id="8f83" class="lw lx je bd ly lz ma mb mc md me mf mg kk mh kl mi kn mj ko mk kq ml kr mm mn bi translated">Expo传感器</h1><p id="e796" class="pw-post-body-paragraph kt ku je kv b kw mo kf ky kz mp ki lb lc mq le lf lg mr li lj lk ms lm ln lo im bi translated"><a class="ae mt" href="https://docs.expo.io/versions/latest/sdk/sensors/" rel="noopener ugc nofollow" target="_blank"> Expo-Sensors </a>提供各种API来访问设备传感器，以测量运动、方向、压力、磁场和步数。我们将使用这个库中的<a class="ae mt" href="https://docs.expo.io/versions/latest/sdk/devicemotion/" rel="noopener ugc nofollow" target="_blank"> DeviceMotion </a>。</p><h1 id="432c" class="lw lx je bd ly lz ma mb mc md me mf mg kk mh kl mi kn mj ko mk kq ml kr mm mn bi translated">反应-原生-SVG</h1><p id="3da5" class="pw-post-body-paragraph kt ku je kv b kw mo kf ky kz mp ki lb lc mq le lf lg mr li lj lk ms lm ln lo im bi translated">React-Native-SVG为iOS和Android上的React Native提供了SVG支持，并为web提供了一个兼容层。我们将使用这个库通过圆和线来设计一个圆柱体的幻象。</p></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><h1 id="7254" class="lw lx je bd ly lz mu mb mc md mv mf mg kk mw kl mi kn mx ko mk kq my kr mm mn bi translated"><strong class="ak">创建项目文件夹</strong></h1><p id="bf07" class="pw-post-body-paragraph kt ku je kv b kw mo kf ky kz mp ki lb lc mq le lf lg mr li lj lk ms lm ln lo im bi translated">如果您是一名React-Native开发人员，您已经知道如何创建Expo项目。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="d448" class="ni lx je ne b gy nj nk l nl nm">expo init tower</span></pre></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><h1 id="b61d" class="lw lx je bd ly lz mu mb mc md mv mf mg kk mw kl mi kn mx ko mk kq my kr mm mn bi translated">安装库</h1><ul class=""><li id="e737" class="nn no je kv b kw mo kz mp lc np lg nq lk nr lo ns nt nu nv bi translated"><code class="fe nw nx ny ne b">react-native-svg</code> — <a class="ae mt" href="https://github.com/react-native-community/react-native-svg" rel="noopener ugc nofollow" target="_blank"> React-Native-SVG </a></li><li id="ba68" class="nn no je kv b kw nz kz oa lc ob lg oc lk od lo ns nt nu nv bi translated"><code class="fe nw nx ny ne b">expo-sensors</code> — <a class="ae mt" href="https://docs.expo.io/versions/latest/sdk/sensors/" rel="noopener ugc nofollow" target="_blank">曝光传感器</a></li></ul><p id="e212" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">您必须使用<strong class="kv jf"> expo install </strong>来确保您下载的包是与您的项目正在运行的SDK版本兼容的合适的包。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="531d" class="ni lx je ne b gy nj nk l nl nm">expo install react-native-svg expo-sensors</span></pre></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><p id="b4b5" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在向您展示代码之前，我必须解释如何使用DeviceMotion库。我们首先像这样从<code class="fe nw nx ny ne b">expo-sensors</code>导入库:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="02d9" class="ni lx je ne b gy nj nk l nl nm">import { DeviceMotion } from 'expo-sensors';<!-- --> </span></pre><blockquote class="oe of og"><p id="ef05" class="kt ku oh kv b kw kx kf ky kz la ki lb oi ld le lf oj lh li lj ok ll lm ln lo im bi translated"><code class="fe nw nx ny ne b"><a class="ae mt" href="https://docs.expo.io/versions/latest/sdk/devicemotion/#devicemotionaddlistenerlistener" rel="noopener ugc nofollow" target="_blank">DeviceMotion.addListener(listener)</a></code></p></blockquote><p id="083d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">DeviceMotion提供了一个名为addListener的函数来订阅DeviceMotion的更新。这里我们添加了侦听器函数，它接收一个对象作为单个参数。</p><figure class="mz na nb nc gt iv"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="ae67" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在这个对象中，我们感兴趣的是旋转对象，它是设备在空间中作为具有alpha、beta、gamma键的对象的方向，其中alpha表示绕Z轴旋转，beta表示X轴旋转，gamma表示Y轴旋转。</p><p id="dde0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">为了解释这些值和轴旋转，下面是来自<a class="ae mt" href="https://developers.google.com/web/fundamentals/native-hardware/device-orientation" rel="noopener ugc nofollow" target="_blank"> developers.google </a>的文档:</p><h1 id="7431" class="lw lx je bd ly lz ma mb mc md me mf mg kk mh kl mi kn mj ko mk kq ml kr mm mn bi translated">设备坐标框架</h1><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/5d546e434b30e16e2457f48e9c01658a.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*GGf1ofkx8u-TWFTj29Q0QA.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">设备坐标框架图</figcaption></figure><p id="ae5a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">由值<code class="fe nw nx ny ne b">x</code>、<code class="fe nw nx ny ne b">y</code>和<code class="fe nw nx ny ne b">z</code>描述的器件坐标框架基于器件中心对齐。</p><p id="b540" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">注意:</strong>在给定的文档和我们的listener对象中，alpha，beta &amp; gamma的值是不同的格式，取值范围从-π到π，因此浮点值为-3.14到3.14</p><h2 id="0f40" class="ni lx je bd ly oo op dn mc oq or dp mg lc os ot mi lg ou ov mk lk ow ox mm oy bi translated">希腊字母的第一个字母</h2><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/158b3b0aeaac4bc6ddda2c532aa0aca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*fJfl8gG2l0qt6DAcOmtg9A.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">设备坐标框架中alpha的图示</figcaption></figure><p id="3c53" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">绕z轴的旋转。当设备顶部直接指向北方时，<code class="fe nw nx ny ne b">alpha</code>值为0。随着设备逆时针旋转，<code class="fe nw nx ny ne b">alpha</code>值增加。</p><h2 id="7409" class="ni lx je bd ly oo op dn mc oq or dp mg lc os ot mi lg ou ov mk lk ow ox mm oy bi translated">贝塔</h2><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/74b70f2ff7454b32e2b1a915895c0aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*td7cUUXYDLv573LimqN5PQ.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">器件坐标框架中的β图</figcaption></figure><p id="ece6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">绕x轴的旋转。当设备的顶部和底部与地球表面距离相等时,<code class="fe nw nx ny ne b">beta</code>值为0。该值随着设备顶部向地球表面倾斜而增加。</p><h2 id="dfb6" class="ni lx je bd ly oo op dn mc oq or dp mg lc os ot mi lg ou ov mk lk ow ox mm oy bi translated">微克</h2><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/8699489ef1b27f42caf639ecb86ea067.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*nfQs-dSEae0Xub1vYzO7hw.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">设备坐标框架中的gamma图</figcaption></figure><p id="840a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">绕y轴的旋转。当设备的左右边缘与地球表面距离相等时，<code class="fe nw nx ny ne b">gamma</code>值为0。该值随着右侧向地球表面倾斜而增加。</p><p id="14f1" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在这个项目中，我们只需要beta和gamma值，因为我们试图创建一个摄像头视图来查看位于屏幕中心的对象，所以Z轴上的数据没有用。</p><p id="30d9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下面是如何添加侦听器并存储旋转数据:</p><figure class="mz na nb nc gt iv"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><p id="5c9f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们将使用这些数据来渲染我们的圆柱体。为了绘制圆柱体，我们使用react-native-svg库，它提供了基本元素，如圆形、矩形、直线等等。我们将创建一个固定的阴影元素和一个移动的圆柱元素。</p><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/6805753a93b7e23ef2cbf0793163574a.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*bnPTrf9PkRpC5q_A-ZNMeQ.jpeg"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">阴影元素</figcaption></figure><p id="1cc0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">阴影元素是用一条线和一个圆绘制的。在绘制这个元素时，元素的堆叠并不重要，因为它们具有相同的颜色，并且是固定的元素。阴影将从中间投射到左上角的中间。</p><p id="1ccf" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下面是阴影元素的代码:</p><figure class="mz na nb nc gt iv"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="b4f6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于圆柱体元素，我们将使用beta和gamma值来放置坐标系中的对象。在这里，我们如何定位对象中的元素很重要，因为它们处于运动中，并且具有不同的颜色。最上面的子元素位于绘制堆栈的底部。气缸中使用了四个元件:</p><ul class=""><li id="3d40" class="nn no je kv b kw kx kz la lc pb lg pc lk pd lo ns nt nu nv bi translated">充当塔身的线。</li><li id="313b" class="nn no je kv b kw nz kz oa lc ob lg oc lk od lo ns nt nu nv bi translated">作为塔底的固定圆。</li><li id="d8f1" class="nn no je kv b kw nz kz oa lc ob lg oc lk od lo ns nt nu nv bi translated">塔体上的细线，表明它是塔的前面。</li><li id="5875" class="nn no je kv b kw nz kz oa lc ob lg oc lk od lo ns nt nu nv bi translated">一个充当塔顶的圆圈。</li></ul><p id="77d0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我已经改变了颜色，让你明白每个元素，否则真正的元素将看起来像在主图像的顶部。</p><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/8d86fb38d16ca2524145201920a8f4f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*CrTV5GEzPySgz2OMkS326w.jpeg"/></div></figure><p id="407d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">以下是圆柱体元素的代码:</p><figure class="mz na nb nc gt iv"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="fad9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">beta和gamma值四舍五入到小数点后两位。只有当beta为正时，beta也用于显示前线，这意味着从面向天空的屏幕到面向您屏幕的屏幕的角度。</p></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><p id="075a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">还有一个gamma align布尔值来检查屏幕是否在顶视图上，如果不是，则屏幕会显示文本“保持屏幕在顶部！”。现在，结合所有的代码，这里是代码将如何。</p><figure class="mz na nb nc gt iv"><div class="bz fp l di"><div class="ol om l"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk translated">塔式应用程序— App.js</figcaption></figure></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><h1 id="e94a" class="lw lx je bd ly lz mu mb mc md mv mf mg kk mw kl mi kn mx ko mk kq my kr mm mn bi translated">结论</h1><p id="fe05" class="pw-post-body-paragraph kt ku je kv b kw mo kf ky kz mp ki lb lc mq le lf lg mr li lj lk ms lm ln lo im bi translated">这就是这个项目的全部，但许多事情可以在这方面进一步工作，如使用alpha值根据太阳的位置来定位阴影，或使用DeviceMotion和three.js的3D模型。这只是一个例子，供初学者检查如何用简单详细的解释代码实现DeviceMotion。</p><blockquote class="oe of og"><p id="8368" class="kt ku oh kv b kw kx kf ky kz la ki lb oi ld le lf oj lh li lj ok ll lm ln lo im bi translated">你可以在GitHub上查看这个项目。</p></blockquote><div class="is it gp gr iu pe"><a href="https://github.com/tejas77/tower" rel="noopener  ugc nofollow" target="_blank"><div class="pf ab fo"><div class="pg ab ph cl cj pi"><h2 class="bd jf gy z fp pj fr fs pk fu fw jd bi translated">tejas 77/塔</h2><div class="pl l"><h3 class="bd b gy z fp pj fr fs pk fu fw dk translated">一个简单的例子，说明如何在expo中使用设备动作。我在看苹果的…</h3></div><div class="pm l"><p class="bd b dl z fp pj fr fs pk fu fw dk translated">github.com</p></div></div><div class="pn l"><div class="po l pp pq pr pn ps iw pe"/></div></div></a></div><p id="f949" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf"> <em class="oh">谢谢。</em>🤗</strong></p></div></div>    
</body>
</html>