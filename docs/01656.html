<html>
<head>
<title>JavaScript Array sort method and its gotchas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript数组排序方法及其陷阱</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/array-sort-method-and-its-gotchas-5859ece92e8d?source=collection_archive---------5-----------------------#2020-01-20">https://levelup.gitconnected.com/array-sort-method-and-its-gotchas-5859ece92e8d?source=collection_archive---------5-----------------------#2020-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2b9b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解数组排序方法及其令人惊讶的行为</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/46eaf2499e8108ad92b17d05a4de2689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Np6GoNlLl9LBzeg5"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@helloquence?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">hello queue</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="41cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Array sort方法对数组进行排序，而不考虑其数据类型，无论是编号数组、字符串数组还是复杂的对象数组。</p><p id="a707" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">排序方法具有以下语法:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="e6d7" class="lx ly iq lt b gy lz ma l mb mc">array.sort([compareFunction])</span></pre><p id="65b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，<code class="fe md me mf lt b">compareFunction</code>是可选的。</p><p id="1955" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">需要注意的一点是，数组排序方法并不返回一个新的排序后的数组，而是改变原来的数组。</strong></p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="814e" class="lx ly iq lt b gy lz ma l mb mc">const months = ["Nov", "Feb", "Jan", "Dec" ];<br/>const sorted = months.sort(); // sort the original array and return reference to it<br/><br/>console.log(months); // ["Dec", "Feb", "Jan", "Nov"]<br/>console.log(sorted); // ["Dec", "Feb", "Jan", "Nov"]</span></pre><p id="8451" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/yLyQbMJ?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/yLyQbMJ?editors=0011</a></p><p id="0281" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您使用<code class="fe md me mf lt b">===</code>比较月份和排序变量，您可以看到它们指向同一个数组，即原始排序数组。</p><p id="2b89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mg">这是一个很有名的面试问题，用来检验应聘者是否知道数组排序方法。</em></p><p id="e420" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果不想改变原来的数组，可以在sort方法前加一个slice方法。</p><p id="0f82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">slice方法返回数组的一个新的浅表副本。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="aa3f" class="lx ly iq lt b gy lz ma l mb mc">const months = ["Nov", "Feb", "Jan", "Dec" ];<br/>const sorted = months.slice().sort(); // returns a new sorted array<br/><br/>console.log(months); // ["Nov", "Feb", "Jan", "Dec"]<br/>console.log(sorted); // ["Dec", "Feb", "Jan", "Nov"]<br/>console.log(months === sorted); // false</span></pre><p id="043d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/zYxMwPE?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/zYxMwPE?editors=0011</a></p><p id="a52e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">默认情况下，sort方法将数组排序为字符串。</strong></p><p id="e931" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这对于按字母顺序排序的字符串来说没问题，但是当我们对数字进行排序时会产生不正确的结果。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="cd55" class="lx ly iq lt b gy lz ma l mb mc">const numbers = [100, 25, 1, 5 ];<br/>const sorted = numbers.slice().sort(); // returns a new sorted array</span><span id="b397" class="lx ly iq lt b gy mh ma l mb mc">console.log(numbers); // [100, 25, 1, 5 ]<br/>console.log(sorted); // [1, 100, 25, 5]</span></pre><p id="4db6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/MWYzmQp?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/MWYzmQp?editors=0011</a></p><p id="808a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如您在排序后的数组中看到的，5排在最后，100排在25之前，尽管100大于25和5。</p><p id="7c0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是因为在对数字进行排序时，每个数字都被转换为一个字符串。排序方法逐个字符进行比较，因此“100”中的“1”比“25”中的“2”小，因此在按升序排序时，100在25之前。</p><p id="f949" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是程序员经常忘记的常见问题。</p><p id="82f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以通过将比较函数传递给排序方法来解决这个问题</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="815e" class="lx ly iq lt b gy lz ma l mb mc">const numbers = [100, 25, 1, 5];<br/>const sorted = numbers.slice().sort(function(a, b) { <br/> return a - b; <br/>}); // returns a new sorted array</span><span id="24ed" class="lx ly iq lt b gy mh ma l mb mc">console.log(numbers); // [100, 25, 1, 5]<br/>console.log(sorted); // [1, 5, 25, 100]</span></pre><p id="3ad9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/MWYzmQp?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/MWYzmQp?editors=0011</a></p><p id="8898" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当比较100和25时，<code class="fe md me mf lt b">sort()</code>方法将100 - 25计算为75，这是一个正值，所以它将25放在100之前。</p><p id="0ee2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将按升序对数组进行排序。</p><p id="d85d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了按降序排序，我们需要对compare函数做一点小小的修改。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="9058" class="lx ly iq lt b gy lz ma l mb mc">const numbers = [100, 25, 1, 5];<br/>const sorted = numbers.slice().sort(function(a, b) { <br/> return <strong class="lt ir">b - a; </strong><br/>}); // returns a new sorted array</span><span id="8122" class="lx ly iq lt b gy mh ma l mb mc">console.log(numbers); // [100, 25, 1, 5]<br/>console.log(sorted); // [100, 25, 5, 1]</span></pre><p id="48cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/bGNQRdB?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/bGNQRdB?editors=0011</a></p><p id="c048" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">所以在对数字进行排序时，一定要传递compare函数，否则你会得到一个不想要的结果。</strong></p><h2 id="c6f2" class="lx ly iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">排序函数排序时使用的规则:</strong></h2><p id="e250" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">1.如果第一个值按字母顺序排在第二个值之前，则返回负值。<br/> 2。如果第一个值按字母顺序排在第二个值之后，则返回正值。<br/> 3。如果第一个和第二个值相等，则返回零。</p><p id="94f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们编写一个代码，按照用户的姓氏对他们进行排序</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="f1f8" class="lx ly iq lt b gy lz ma l mb mc">const users = ["David Jonhnson", "Tim Lindholm", "David Beckham", "Johnny Depp" ];<br/>const sorted = users.slice().sort(function(firstUser, secondUser) { <br/> const firstLastName = firstUser.split(" ")[1];<br/> const secondLastName = secondUser.split(" ")[1];<br/> if(firstLastName &lt; secondLastName) return -1;<br/> if(firstLastName &gt; secondLastName) return 1;<br/> return 0;<br/>});<br/><br/>console.log(users); // ["David Jonhnson", "Tim Lindholm", "David Beckham", "Johnny Depp"]<br/>console.log(sorted); // ["David Beckham", "Johnny Depp", "David Jonhnson", "Tim Lindholm"]</span></pre><p id="7be2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/XWJyRoZ?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/XWJyRoZ?editors=0011</a></p><p id="d460" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要对数组进行随机排序，我们可以使用Math.random方法</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="efa5" class="lx ly iq lt b gy lz ma l mb mc">const numbers = [100, 25, 1, 5 ];<br/>const sorted = numbers.slice().sort(function(a, b) { <br/> return 0.5 - Math.random() <br/>}); // returns a new sorted array</span><span id="6e79" class="lx ly iq lt b gy mh ma l mb mc">console.log(numbers); // [100, 25, 1, 5]<br/>console.log(sorted); // array in random order</span></pre><p id="9ea0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/MWYzoKQ?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/MWYzoKQ?editors=0011</a></p><p id="ec40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">对对象数组进行排序:<br/> </strong>假设我们有一个用户数组，其中每个用户对象都包含一个姓名和年龄属性，我们希望根据用户的年龄对数组进行升序排序。我们可以这样做:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="7eae" class="lx ly iq lt b gy lz ma l mb mc">const users = [{<br/>  name: 'David',<br/>  age: 30<br/>},<br/>{<br/>  name: 'Mike',<br/>  age: 40<br/>},<br/>{<br/>  name: 'John',<br/>  age: 25<br/>}];<br/>const sorted = users.slice().sort(function(firstUser, secondUser) { <br/> if(firstUser.age &lt; secondUser.age) return -1;<br/> if(firstUser.age &gt; secondUser.age) return 1;<br/> return 0;<br/>});<br/><br/>console.log(users); // [{'name':'David','age':30},{'name':'Mike','age':40},{'name':'John','age':25}]<br/>console.log(sorted); // [{'name':'John','age':25},{'name':'David','age':30},{'name':'Mike','age':40}]</span></pre><p id="7abc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/bGNQRwg?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/bGNQRwg?editors=0011</a></p><p id="9971" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要按年龄降序对数组进行排序:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="e6d4" class="lx ly iq lt b gy lz ma l mb mc">const users = [{<br/>  name: 'David',<br/>  age: 30<br/>},<br/>{<br/>  name: 'Mike',<br/>  age: 40<br/>},<br/>{<br/>  name: 'John',<br/>  age: 25<br/>}];</span><span id="1716" class="lx ly iq lt b gy mh ma l mb mc">const sorted = users.slice().sort(function(firstUser, secondUser) { <br/> if(firstUser.age &lt; secondUser.age) <strong class="lt ir">return 1;</strong><br/> if(firstUser.age &gt; secondUser.age) <strong class="lt ir">return -1;</strong><br/> return 0;<br/>});</span><span id="6db6" class="lx ly iq lt b gy mh ma l mb mc">console.log(users); // [{'name':'David','age':30},{'name':'Mike','age':40},{'name':'John','age':25}]<br/>console.log(sorted); // [{'name':'Mike','age':40},{'name':'David','age':30},{'name':'John','age':25}]</span></pre><p id="a7c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示:<a class="ae kv" href="https://codepen.io/myogeshchavan97/pen/bGNQrGv?editors=0011" rel="noopener ugc nofollow" target="_blank">https://codepen.io/myogeshchavan97/pen/bGNQrGv?editors=0011</a></p><p id="ff58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天到此为止。希望你今天学到了新东西。</p><p id="2ae6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">别忘了直接在你的收件箱</strong> <a class="ae kv" href="https://yogeshchavan.dev" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里</strong> </a> <strong class="ky ir">订阅我的每周时事通讯，里面有惊人的技巧、诀窍和文章。</strong></p></div></div>    
</body>
</html>