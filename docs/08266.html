<html>
<head>
<title>Make your first neural network with TensorFlow!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TensorFlow构建您的第一个神经网络！</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/make-your-first-neural-network-with-tensorflow-f4571dc0f58e?source=collection_archive---------14-----------------------#2021-04-15">https://levelup.gitconnected.com/make-your-first-neural-network-with-tensorflow-f4571dc0f58e?source=collection_archive---------14-----------------------#2021-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e4f4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不需要经验！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d034053c9c2840661ff6ff3c520503a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v6a68Zzn4oVTLcqI"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@alinnnaaaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alina Grubnyak </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">unplash</a>上拍摄</figcaption></figure><h1 id="b68f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">包和设置</h1><p id="b4f6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们只需要TensorFlow和NumPy。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="1edd" class="ms la it mo b gy mt mu l mv mw"><strong class="mo iu"># In terminal or command line:</strong></span><span id="4511" class="ms la it mo b gy mx mu l mv mw">pip install tensorflow<br/>pip install numpy</span><span id="5b1e" class="ms la it mo b gy mx mu l mv mw"><strong class="mo iu"># Or, if you are in a Colab notebook (to install) :</strong></span><span id="062e" class="ms la it mo b gy mx mu l mv mw">! pip install numpy</span><span id="09fd" class="ms la it mo b gy mx mu l mv mw">! pip install tensorflow</span><span id="6d3e" class="ms la it mo b gy mx mu l mv mw"><strong class="mo iu"># In project:</strong></span><span id="7a75" class="ms la it mo b gy mx mu l mv mw">import numpy as np <br/>import tensorflow as tf<br/>from tensorflow import keras</span></pre><p id="7066" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们使用的是TensorFlow的最新版本，TensorFlow 2.0。</p><h1 id="fc60" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是神经网络？</h1><p id="2fdb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">神经网络使用数据来随着时间的推移改善自己。他们就像几代人一样，随着时间的推移会逐渐变好。每个节点都有其输入数据、权重、偏差和输出，其公式如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/07eb43303f24e462437f2a3b45670228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Bbek0FJ9EY_WjCZj.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://www.ibm.com/cloud/learn/neural-networks" rel="noopener ugc nofollow" target="_blank">https://www.ibm.com/cloud/learn/neural-networks</a></figcaption></figure><p id="b650" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我将非常简要地介绍这些概念，但是如果您想了解更多信息。我强烈推荐这些资源:</p><ul class=""><li id="80b6" class="ne nf it lt b lu my lx mz ma ng me nh mi ni mm nj nk nl nm bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=bfmFfD2RIcg" rel="noopener ugc nofollow" target="_blank">5分钟神经网络|通过:simple learn</a></li><li id="05a4" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated"><a class="ae ky" href="https://databricks.com/glossary/neural-network" rel="noopener ugc nofollow" target="_blank">神经网络类型| By:databrick</a></li><li id="390a" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=aircAruvnKk" rel="noopener ugc nofollow" target="_blank">但什么是神经网络呢？|作者:3Blue1Brown </a></li></ul><h1 id="b828" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">生成数据</h1><p id="4d13" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们定义我们的数据集。</p><p id="ddf1" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们可以用一个线性方程<code class="fe ns nt nu mo b">y = mx + b</code>来建立一个方程，为我们的阵列提供一个模式。</p><p id="5b34" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">假设<code class="fe ns nt nu mo b">y = 9x + 2</code>，现在我们可以用这些值代替另一个值。</p><p id="10dd" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">例如，</p><p id="bd84" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated"><code class="fe ns nt nu mo b">x = 1, y = 11</code>、<code class="fe ns nt nu mo b"> x = 2, y = 20</code>、<code class="fe ns nt nu mo b">x = 3, y = 29.0</code>。</p><p id="d8fc" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们将把它存储在一个NumPy数组中。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="e622" class="ms la it mo b gy mt mu l mv mw">xs = np.array([1.0, 2.0, 3.0, 4.0, 5.0, 6.0], dtype=float)</span><span id="e8c5" class="ms la it mo b gy mx mu l mv mw">ys = np.array([11.0, 20.0, 29.0, 38.0, 47.0, 56.0], dtype=float)</span></pre><h1 id="05cd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">定义我们的模型</h1><p id="482d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有趣的部分！</p><p id="f287" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">在这种情况下，我们将使用顺序模型。这将一个线性堆叠的层组成一个张量流模型。但是，这仅适用于具有一个输入张量和一个输出张量的情况，这就是我们现在所拥有的。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="7f04" class="ms la it mo b gy mt mu l mv mw">model = tf.keras.Sequential(<br/>[keras.layers.Dense(units=1, input_shape=[1])]<br/>)</span></pre><p id="f456" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated"><code class="fe ns nt nu mo b">input_shape=[1]</code>我们的数据只有一个输入，一个值。</p><p id="e47c" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated"><code class="fe ns nt nu mo b">units=1</code>这是我们唯一的一层，所以我们只需要1个神经元/细胞。</p><p id="a1ef" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们现在需要编译我们的模型，我们可以使用随机梯度下降或<code class="fe ns nt nu mo b">SGD</code>作为我们的优化器。这样，我们可以分析和更新我们的模型，并以更快的速度改进它。</p><p id="9cf5" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我真的很喜欢Sujan Dutta 解释它的方式:</p><p id="4879" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated"><em class="nx">“假设你做了一个应用程序，想通过收集100个客户的反馈来改进它。你可以用两种方法来做这件事。在第一种方式中，你可以将应用程序交给第一个客户，然后将他的反馈交给第二个客户，然后是第三个，以此类推。从他们那里收集反馈后，你可以改进你的应用程序。但是第二种方式，你可以在得到第一个客户的反馈后，马上对app进行改进。然后你把它给第二个，在给第三个之前你又提高了一次。请注意，通过这种方式，您可以以更快的速度改进您的应用程序，并且可以更早地达到最佳状态。”</em></p><p id="127d" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们可以通过误差平均值的平方来计算损失。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="7855" class="ms la it mo b gy mt mu l mv mw">model.compile(optimizer='sgd', loss='mean_squared_error')</span></pre><h2 id="f43d" class="ms la it bd lb ny nz dn lf oa ob dp lj ma oc od ll me oe of ln mi og oh lp oi bi translated">让我们训练我们的模型！</h2><p id="94e3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们通过用数据拟合模型来训练模型。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="d83b" class="ms la it mo b gy mt mu l mv mw">model.fit(xs, ys, epochs=100)</span></pre><p id="4f68" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">您可以增加/减少时期以获得不同的结果。</p><p id="464e" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">运行它会用这些数据填满您的终端</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="cf16" class="ms la it mo b gy mt mu l mv mw">Epoch 1/100 1/1 [==============================] - 0s <strong class="mo iu">x </strong>ms/step - loss: <strong class="mo iu">x</strong></span></pre><p id="9d9a" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这种损失表明模型的预测在单次迭代中有多大缺陷。</p><p id="9a65" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">在我的训练中，我在第一个纪元的损失大约是1480，但是到第100个纪元时，我的损失下降到了惊人的0.030！</p><h1 id="753e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">做预测</h1><p id="cb7e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以通过调用<code class="fe ns nt nu mo b">model.predict()</code>简单地调用我们的模型来预测一些事情。</p><p id="ad76" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我试着预测10个。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="5ab8" class="ms la it mo b gy mt mu l mv mw">print(model.predict([10.0]))</span></pre><p id="25ee" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们可以通过将它代入我们前面提到的等式<code class="fe ns nt nu mo b">y = 9x + 2</code>来找到实际的答案。</p><p id="ea22" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们会发现准确的输出应该是92。</p><p id="4e92" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">模特会怎么想？</p><p id="41e4" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">原来，真的很近！</p><p id="0d9a" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">模型预测91.8272，刚好差92。</p><h1 id="6f57" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">完成的代码:</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><h1 id="d1d1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="4813" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">谢谢！</p><p id="a0e2" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我希望你喜欢读这篇文章，并且它教会了你更多关于张量流和神经网络的知识。如果您有任何问题、建议、一般反馈或您的代码不工作，请在评论中提出！</p><p id="797c" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">继续编码！</p></div></div>    
</body>
</html>