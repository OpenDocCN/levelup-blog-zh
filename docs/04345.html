<html>
<head>
<title>How to Manage Multiple GitHub/GitLab/Bitbucket Accounts Using SSH Keys</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用SSH密钥管理多个GitHub/GitLab/Bitbucket帐户</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-manage-multiple-github-gitlab-bitbucket-accounts-using-ssh-keys-1c5d75ab3345?source=collection_archive---------5-----------------------#2020-06-22">https://levelup.gitconnected.com/how-to-manage-multiple-github-gitlab-bitbucket-accounts-using-ssh-keys-1c5d75ab3345?source=collection_archive---------5-----------------------#2020-06-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b3f20dd2c04ee28da1a1894aa1ddd248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k7SKKyyBpytE9jw4.jpg"/></div></div></figure><p id="0803" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您使用过Git命令行实用程序，您可能已经注意到Git经常需要用户凭证来通过HTTP执行操作，尤其是当存储库是私有的时候。可以将用户凭证永久存储在Git凭证存储中，以避免反复输入，但是如果您必须在另一个帐户上的远程存储库上工作，这种方法就行不通了。对于采用双因素身份验证的系统来说，这变得更加复杂，因为您用于密码的令牌是随机生成的，并且无法发音。</p><p id="7485" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以通过使用SSH(安全外壳)来解决这个问题。SSH使用一对密钥来启动远程方之间的安全握手。此外，它比基于密码的认证更安全。</p><p id="9fa6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我将解释在一台机器上设置多个基于Git的代码托管平台帐户的步骤——GitHub、GitLab、Bitbucket等。我将要描述的方法依赖于将属于不同帐户的工作分离到不同的目录中，并编辑<code class="fe kz la lb lc b">~/.gitconfig</code>文件，这样Git可以自动识别哪个目录属于哪个帐户。所以，让我们开始吧！</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="62e0" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">1.生成新的SSH密钥对</h1><p id="33c6" class="pw-post-body-paragraph kb kc it kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">您可以在macOS、Linux和Windows上使用以下命令生成新的SSH密钥对:</p><pre class="mn mo mp mq gt mr lc ms mt aw mu bi"><span id="1b96" class="mv ll it lc b gy mw mx l my mz">$ ssh-keygen -t rsa -b 4096 -C "<a class="ae na" href="mailto:your_email2@example.com" rel="noopener ugc nofollow" target="_blank">your_email@example.com</a>" -f ~/.ssh/id_rsa_github_personal</span></pre><p id="587e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你在Windows上，你必须在<em class="nb"> Git Bash </em>中运行这个命令。并且记住在生成密钥时提供一个有意义的文件名。如果你不使用<code class="fe kz la lb lc b">-f</code>选项，程序会提示你输入一个文件名。上述命令将生成两个密钥:</p><ul class=""><li id="65a8" class="nc nd it kd b ke kf ki kj km ne kq nf ku ng ky nh ni nj nk bi translated">公钥:<code class="fe kz la lb lc b">~/.ssh/id_rsa_github_personal.pub</code></li><li id="5025" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">私钥:<code class="fe kz la lb lc b">~/.ssh/id_rsa_github_personal</code></li></ul><p id="c60e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">公钥类似于物理锁，您与远程服务器共享它来加密您的数据，而私钥存储在您的文件系统中的一个安全位置，稍后将用于“解锁”受保护的数据。唯一的区别是SSH使用公钥加密算法(RSA、DSA)来执行这些任务。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="c689" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak"> 2。将SSH公钥添加到您的帐户</strong></h1><p id="343f" class="pw-post-body-paragraph kb kc it kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">与远程服务器共享公钥(以<code class="fe kz la lb lc b">.pub</code>结尾)。通过在文本编辑器中打开文件，将公钥的内容复制到剪贴板。或者您可以像这样直接从终端将其复制到剪贴板:</p><ul class=""><li id="e1bf" class="nc nd it kd b ke kf ki kj km ne kq nf ku ng ky nh ni nj nk bi translated"><strong class="kd iu"> macOS </strong> : <code class="fe kz la lb lc b">pbcopy &lt; ~/.ssh/id_rsa_github_personal.pub</code></li><li id="dd91" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated"><strong class="kd iu"> Linux </strong> : <code class="fe kz la lb lc b">xclip -sel clip &lt; ~/.ssh/id_rsa_github_personal.pub</code></li><li id="a8bb" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated"><strong class="kd iu"> Windows (Git Bash) </strong> : <code class="fe kz la lb lc b">cat ~/.ssh/id_rsa_github_personal.pub | clip</code></li></ul><p id="37e4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在将您的SSH公钥粘贴到您的帐户中。在GitHub上，用户界面是这样的:</p><figure class="mn mo mp mq gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/00f8a5c515b36452689a1f0a4be1969d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCnBovqeX3UhdcJT6KILqQ.png"/></div></div><figcaption class="nr ns gj gh gi nt nu bd b be z dk translated">在GitHub上添加新的SSH密钥</figcaption></figure><p id="e70d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将您的公钥粘贴到上面的文本框后，单击“添加SSH密钥”。您可以通过这些直接链接向您的帐户添加新的SSH密钥:</p><ul class=""><li id="fa04" class="nc nd it kd b ke kf ki kj km ne kq nf ku ng ky nh ni nj nk bi translated"><strong class="kd iu"> GitHub </strong> : <a class="ae na" href="https://github.com/settings/ssh/new" rel="noopener ugc nofollow" target="_blank">给你的GitHub账号添加一个SSH密钥</a></li><li id="59d3" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated"><strong class="kd iu"> GitLab </strong> : <a class="ae na" href="https://docs.gitlab.com/ee/ssh/README.html#adding-an-ssh-key-to-your-gitlab-account" rel="noopener ugc nofollow" target="_blank">向您的GitLab帐户添加SSH密钥</a></li><li id="7e79" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated"><strong class="kd iu"> Bitbucket </strong> : <a class="ae na" href="https://support.atlassian.com/bitbucket-cloud/docs/set-up-an-ssh-key/" rel="noopener ugc nofollow" target="_blank">给你的Bitbucket账户添加一个SSH密钥</a></li></ul></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><p id="4c0d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> <em class="nb">对于你所有的个人和专业账户，按照前两步操作，记得给你的密钥使用有意义的文件名(这样你就能认出哪个密钥属于哪个账户/网站)。</em> </strong></p><h1 id="64e5" class="lk ll it bd lm ln nv lp lq lr nw lt lu lv nx lx ly lz ny mb mc md nz mf mg mh bi translated">3.编辑gitconfig文件</h1><p id="76ec" class="pw-post-body-paragraph kb kc it kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">在这一步，你必须编辑<code class="fe kz la lb lc b">.gitconfig</code>文件。您可以在以下位置找到该文件:</p><ul class=""><li id="67f2" class="nc nd it kd b ke kf ki kj km ne kq nf ku ng ky nh ni nj nk bi translated"><strong class="kd iu"> Linux和macOS </strong> : <code class="fe kz la lb lc b">~/.gitconfig</code></li><li id="e0b8" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated"><strong class="kd iu">视窗</strong> : <code class="fe kz la lb lc b">C:\Users\&lt;username&gt;\.gitconfig</code></li></ul><p id="0335" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在文本编辑器中打开该文件，以定义目录和Git配置文件之间的多个一对一映射。Git有一个<code class="fe kz la lb lc b">[includeIf]</code>指令，允许您在指定的条件评估为<code class="fe kz la lb lc b">True</code>时使用不同的配置文件。这个指令是在Git版本2.13.0中引入的，所以在继续之前请检查您的版本:<code class="fe kz la lb lc b">git --version</code>。如果需要，升级您的Git客户端。</p><p id="e28d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是我的<code class="fe kz la lb lc b">.gitconfig</code>文件的样子:</p><figure class="mn mo mp mq gt ju"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="nr ns gj gh gi nt nu bd b be z dk translated">用于管理多个账户的示例<code class="fe kz la lb lc b">.gitconfig</code>文件</figcaption></figure><p id="ced5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在文件的开头定义全局(默认)配置。使用<code class="fe kz la lb lc b">sshCommand</code>变量设置SSH私有密钥的路径。设置该变量后，<code class="fe kz la lb lc b">git fetch</code>和<code class="fe kz la lb lc b">git push</code>需要连接到远程系统时将使用指定的命令。全局配置将在执行Git操作的任何地方使用，除非您位于与<code class="fe kz la lb lc b">[includeIf]</code>指令匹配的目录中。</p><p id="2b88" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为其他帐户创建一个单独的Git配置文件，并在<code class="fe kz la lb lc b">[includeIf]</code>指令中指定它们的文件系统路径。只有当您当前的工作目录与在<code class="fe kz la lb lc b">gitdir:</code>之后指定的glob模式匹配时，才会使用这个文件中的配置。阅读<a class="ae na" href="https://git-scm.com/docs/git-config#_includes" rel="noopener ugc nofollow" target="_blank"> git-config文档</a>了解更多细节。</p><p id="4f14" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是一个<code class="fe kz la lb lc b">~/.gitconfig_github_work </code>文件的例子:</p><figure class="mn mo mp mq gt ju"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="b04e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为您的所有帐户创建配置文件。</p><p id="fab3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，您可以通过克隆一个私有存储库，或者在现有存储库中调用<code class="fe kz la lb lc b">git config user.email</code>来验证这个设置。</p><p id="8f38" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">注意:</strong> <code class="fe kz la lb lc b">[includeIf]</code>条件配置只适用于git仓库。它不会反映普通目录中的任何更改，并使用全局配置作为后备。</p><h1 id="80dd" class="lk ll it bd lm ln nv lp lq lr nw lt lu lv nx lx ly lz ny mb mc md nz mf mg mh bi translated">结论</h1><p id="3fb8" class="pw-post-body-paragraph kb kc it kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">伙计们，这就是了！这没什么太复杂的，在执行Git操作时，您不再需要手动修改任何配置文件。希望你觉得这有用！请在下面的评论区分享你的观点和建议。</p></div></div>    
</body>
</html>