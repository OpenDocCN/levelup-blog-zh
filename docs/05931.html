<html>
<head>
<title>Solving 2D Heat Equation Numerically using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python数值求解2D热方程</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/solving-2d-heat-equation-numerically-using-python-3334004aa01a?source=collection_archive---------0-----------------------#2020-10-13">https://levelup.gitconnected.com/solving-2d-heat-equation-numerically-using-python-3334004aa01a?source=collection_archive---------0-----------------------#2020-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e938" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几年前在大学学物理的时候，记得有一个任务是对一些简单的问题解析求解热方程。在下一个学期，我们学习了解决一些偏微分方程的数值方法。看到我们如何用数字来解决这些问题，并将解决方案可视化为热图，这真的很有趣，而且真的很酷(双关语)。我还记得，上个学期我们学了C编程语言，所以用C数值求解偏微分方程对我们来说是很自然的，尽管有些学生很难掌握C，而不是解决偏微分方程本身。如果我当时知道如何用Python编码，我会用它来代替C(我不是说C不好)。在这里，我将展示我们如何用数值方法求解2D热方程，并看看将方程“翻译”成Python代码是多么容易。</p><p id="0383" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们做Python代码之前，让我们先谈谈热方程和有限差分法。热量方程基本上是一个偏微分方程，它</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/b8a5e3a0019a64b8b43ee587a7ff34c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/0*9b0DUwZUDJeC8MBt"/></div></figure><p id="6a44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们想在2D(笛卡尔)中求解，我们可以这样写上面的热方程</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/fe949d2e6a30c91f3d076cc4e3e3afc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/0*5ZpgnjK93fv7ZTJs"/></div></figure><p id="d029" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中<em class="ku"> u </em>是我们想要知道的量，<em class="ku"> t </em>是时间变量，<em class="ku"> x </em>和<em class="ku"> y </em>是空间变量，<em class="ku"> α </em>是扩散系数常数。所以基本上我们要在<em class="ku"> x </em>和<em class="ku"> y </em>中处处寻找<em class="ku"> u </em>的解，并且随着时间的推移<em class="ku"> t </em>。</p><p id="a315" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们简单地看看有限差分法(FDM)。有限差分法是一种用有限差分逼近导数来求解微分方程的数值方法。记住导数的定义是</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/2b0245475a84452a005dc26a2e7e5a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/0*DjBWFV3Jik0r9yg9"/></div></figure><p id="321e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在有限差分法中，我们近似它并去掉极限。因此，我们不使用微分和极限符号，而是使用delta符号，即有限差分。请注意，这过于简单，因为我们必须使用泰勒级数展开，并通过假设某些项足够小来推导它，但我们得到了这种方法背后的粗略想法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/7e58bda626ccf2bf8413e790ebc869a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/0*qwdNofUUe10EA8p7"/></div></figure><p id="d9ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在有限差分法中，我们将对空间域和时间间隔<em class="ku"> x </em>、<em class="ku"> y </em>、<em class="ku"> t </em>进行“离散化”。我们可以这样写</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/50e20aee1a3c8957d8382e0c290d95ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*Ex3BXypE-d8Ur1Si_h_5ew.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">笛卡尔坐标，其中x和y轴代表空间变量，<em class="lc"> t </em>代表时间变量(坐标轴来自<a class="ae ld" href="https://www.geogebra.org/" rel="noopener ugc nofollow" target="_blank"> GeoGebra </a>，作者编辑)</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi le"><img src="../Images/8cc05f489dcc6d49063fb9a836880d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:142/0*kR5atsHArP_xkxgT"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/4ccf68fe92b6aa94348a5ce54cc5beb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/0*4kX7Uk20ixnEZ4M9"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/c793fd2b42276a2bb8728ef71d41f28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:138/0*binwKIc_GdTmV93s"/></div></figure><p id="1c47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到，<em class="ku"> i </em>、<em class="ku"> j </em>、<em class="ku"> k </em>分别是<em class="ku"> x </em>、<em class="ku"> y </em>和<em class="ku"> t </em>的每个差值的步长。我们想要的是解决方案<em class="ku"> u </em>，也就是</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/51b0be188bb45279ce4ed520ed41043d.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/0*Y1WNTdLHF6DQIP47"/></div></figure><p id="22e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意<em class="ku"> k </em>是上标，表示<em class="ku"> u </em>的时间步长。我们可以用有限差分法写出上面的热方程，就像这样</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi li"><img src="../Images/bb3634796cdd060cbcb9c9ba93073ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/0*yLExapWINvMqOJQa"/></div></figure><p id="8c4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们用δ<em class="ku">x</em>=δ<em class="ku">y</em>来排列上面的等式，我们得到这个最终的等式</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/a9afb7f68d720ae6a80c18017bcaac45.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/0*QQPVeEe8Yv8KI6lk"/></div></figure><p id="b3d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在哪里</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/75a71ed8cb60cfa05b4e3e7a9313a5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:162/0*eFVGX_4kVUKlJFJ8"/></div></figure><p id="9f80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以使用这个模板来记住上面的等式(空间步长见下标<em class="ku"> i </em>，<em class="ku"> j </em>，时间步长见上标<em class="ku"> k </em></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/d55a4158beba80949cf4760d90eee43f.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*JA3GwIrdTiz2u7zkRV7JcA.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">显式方法模具(图片由作者提供)</figcaption></figure><p id="c0b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用显式方法来得到热方程的解，所以它在任何时候都是数值稳定的</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/83bc44a6b357100cbe8c996a85516378.png" data-original-src="https://miro.medium.com/v2/resize:fit:162/0*RMeGjAtgL-xLYp1s"/></div></figure><p id="a751" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一切准备就绪。现在我们可以求解上面代数方程近似的原始热方程，这是计算机友好的。对于一个习题，我们假设一个边长为50个单位长度的薄正方形板。板内各处的温度原本是0度(在<em class="ku"> t </em> = 0)，让我们看看下图(这不太现实，但有利于锻炼)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/7659f9e9ae4744be9f7e516bde8c1a60.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*X0Cb0W6ug5AQA8gO-R-g2g.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">我们练习的边界和初始条件(图片来自作者)</figcaption></figure><p id="704e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于我们的模型，我们取δ<em class="ku">x</em>= 1，α<em class="ku"/>= 2.0。现在我们可以用Python代码来数值解决这个问题，以查看各处的温度(用<em class="ku"> i </em>和<em class="ku"> j </em>表示)以及随时间的变化(用<em class="ku"> k </em>表示)。让我们首先导入所有必要的库，然后设置边界和初始条件。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="892e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经设置了初始条件和边界条件，让我们根据上面推导的有限差分法来编写计算函数。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="afdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们准备绘图函数，这样我们可以将解决方案(对于每个<em class="ku"> k </em>)可视化为热图。我们使用Matplotlib库，它很容易使用。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="73d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要的另一件事是将结果动画化，因为我们希望看到板内的温度点随时间的变化。因此，让我们创建函数来激活解决方案。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="0369" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们完成了！让我们看看下面的完整代码并运行它。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="1a1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！这是结果</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/78d383b2a6ec3755972e0dd715d9d4b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*8h4MOW_Oy7sXdidBJQ1p8g.gif"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">我们简单热方程练习的数值解</figcaption></figure><p id="a477" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很酷不是吗？顺便说一下，您可以使用这个Python在线编译器<a class="ae ld" href="https://repl.it/languages/python3" rel="noopener ugc nofollow" target="_blank">https://repl.it/languages/python3</a>来尝试上面的代码，确保您在运行代码之前将<em class="ku"> max_iter_time </em>更改为50，以使迭代结果更快。</p><p id="08f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，我们现在有了代码，让我们玩一些更有趣的东西，让我们把所有的边界条件设置为0，然后把内部网格的初始条件随机化。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="1c44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是结果</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/a1ffd4d7556a8bf3173184243b1e928f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*MYSpzoKxBlAX0ohtfiFOPw.gif"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">网格内所有边界条件均为0且初始条件随机的数值解</figcaption></figure><p id="e80e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与其他编程语言相比，Python对于初学者来说相对容易学习。我建议使用Python来解决计算问题，就像我们在这里所做的那样，至少对于原型来说是这样，因为它有非常强大的数字和科学库。这个社区也在变得越来越大，当我们陷入困境时，这可以让谷歌搜索变得更容易。Python可能没有C或C++快，但使用Python我们可以更专注于解决问题本身而不是语言，当然我们仍然需要在某种程度上了解Python语法及其简单的数组操作，但一旦我们掌握了它，它将非常强大。</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="91c5" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">分级编码</h1><p id="9489" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">感谢您成为我们社区的一员！升级正在改变技术招聘。<a class="ae ld" href="https://jobs.levelup.dev/talent" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">在最好的公司</strong>找到你最理想的工作 </a> <strong class="jp ir">。</strong></p><div class="na nb gp gr nc nd"><a href="https://jobs.levelup.dev/talent" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">提升——改变招聘流程</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">🔥让软件工程师找到他们热爱的完美角色🧠寻找人才是最痛苦的部分…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">作业. levelup.dev</p></div></div><div class="nm l"><div class="nn l no np nq nm nr kr nd"/></div></div></a></div></div></div>    
</body>
</html>