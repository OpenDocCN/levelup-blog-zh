<html>
<head>
<title>Building the Instagram Story Auto Play UX in Vue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Vue中构建Instagram故事自动播放UX</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-the-instagram-story-auto-play-ux-in-vue-347670e979ba?source=collection_archive---------0-----------------------#2019-02-09">https://levelup.gitconnected.com/building-the-instagram-story-auto-play-ux-in-vue-347670e979ba?source=collection_archive---------0-----------------------#2019-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9d14" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用Anime.js和Hammer.js</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cca6a88e0105e84ae58f3cb0b8975778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*j4UW63IBoy_goMJSRprIGQ.gif"/></div></div></figure><p id="f5ac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上周，我分享了我在CSS grid中为一个客户项目创建一个简单的<a class="ae ln" href="https://medium.com/@leemartin/building-a-damn-simple-calendar-layout-with-css-grid-moment-and-vue-65698e5e277e" rel="noopener">日历</a>的方法。事实证明，这个项目的UX还有另一面，我很乐意与大家分享。首先，一点背景。</p><p id="f179" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该项目本身是一个<a class="ae ln" href="https://twitter.com/leemartin/status/1093148914490978304" rel="noopener ugc nofollow" target="_blank">简单的应用程序</a>，用于即将上线的摩城唱片公司60周年庆典。当摩城与我分享他们所有令人难以置信的内容时，我被一个充满摩城历史日常事实的文档吸引住了。客户和我一致认为，一个简单的移动友好的网络应用程序浮出水面“今天”的事实将是完美的。我很快构建了一个基本版本，并遇到了一个简单的UX问题。如果一天包括多个事实，我该如何在故事间导航？我跳进<a class="lo lp ep" href="https://medium.com/u/bf1152b11387?source=post_page-----347670e979ba--------------------------------" rel="noopener" target="_blank"> Figma </a>想出一个解决方案，先呈现了一个小“点”<a class="ae ln" href="https://bashooka.com/inspiration/single-page-websites-with-dot-navigation/" rel="noopener ugc nofollow" target="_blank">导航</a>但觉得感觉很无聊。</p><p id="f4c3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，我想到了可以借用的现有用户模式，并锁定了Instagram Story Auto-Play UX或他们管它叫什么。这是Instagram故事顶部的一组进度条，显示你当前正在关注的故事。此外，它还显示当前故事的进度和持续时间，以及将跳转到下一个故事的时间点。我还认为，在模拟这种体验时，包含触摸事件也很重要:</p><ul class=""><li id="3c16" class="lq lr iq kt b ku kv kx ky la ls le lt li lu lm lv lw lx ly bi translated">在屏幕左侧轻按会跳转到上一篇文章</li><li id="5be6" class="lq lr iq kt b ku lz kx ma la mb le mc li md lm lv lw lx ly bi translated">点击屏幕右侧的按钮，跳转到下一个故事</li><li id="37c3" class="lq lr iq kt b ku lz kx ma la mb le mc li md lm lv lw lx ly bi translated">按住可暂停当前播放的故事</li><li id="0377" class="lq lr iq kt b ku lz kx ma la mb le mc li md lm lv lw lx ly bi translated">放开按键会恢复故事回放</li></ul><p id="5579" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们使用<a class="ae ln" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue </a>、<a class="ae ln" href="https://animejs.com/" rel="noopener ugc nofollow" target="_blank"> Anime.js </a>和<a class="ae ln" href="https://hammerjs.github.io/" rel="noopener ugc nofollow" target="_blank"> Hammer.js </a>重新创建这个UX的简单版本。你可以查看<a class="ae ln" href="https://codepen.io/leemartin/pen/VgQyra" rel="noopener ugc nofollow" target="_blank">代码栏</a>并继续阅读。</p><h1 id="59f6" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">设置应用程序</h1><p id="a400" class="pw-post-body-paragraph kr ks iq kt b ku mw jr kw kx mx ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">让我们首先向我们的页面添加一个id为“app”的<code class="fe nb nc nd ne b">&lt;main&gt;</code>元素，并包含Vue.js CDN <a class="ae ln" href="https://vuejs.org/v2/guide/installation.html" rel="noopener ugc nofollow" target="_blank">链接</a>。然后，您可以按如下方式初始化Vue应用程序:</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="fd74" class="nj mf iq ne b gy nk nl l nm nn">const app = new Vue({<br/>  el: '#app',<br/>  data() {<br/>    return {<br/>      colors: ['#D53738', '#638867', '#FAF429']<br/>    }<br/>  }<br/>})</span></pre><p id="7b09" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于这个例子，我们将根据颜色数组从一种颜色跳到另一种颜色。因此，让我们在<code class="fe nb nc nd ne b">&lt;main&gt;</code>中添加一个<a class="ae ln" href="https://vuejs.org/v2/guide/list.html" rel="noopener ugc nofollow" target="_blank"> v-for </a>循环，为每种颜色创建一组部分。</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="81ee" class="nj mf iq ne b gy nk nl l nm nn">&lt;section <br/>  v-for="(color, index) in colors" <br/>  :key="index" <br/>  :style="{ background: color }"<br/>  &gt;<br/>  {{ color }}<br/>&lt;/section&gt;</span></pre><p id="9c34" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个来自Vue的方便的v-for指令可以呈现一个数组中的项目列表。在我们的例子中，我们为每种颜色创建一个<code class="fe nb nc nd ne b">&lt;section&gt;</code>,并使用Vue <a class="ae ln" href="https://vuejs.org/v2/guide/class-and-style.html" rel="noopener ugc nofollow" target="_blank">样式绑定</a>给它一个相关颜色的背景。太棒了。就像Instagram故事一样，我们一次只想展示其中一种颜色。首先，我们向名为current的数据对象添加一个新参数，并赋予它值0。然后，您可以扩展您的<code class="fe nb nc nd ne b">&lt;section&gt;</code>以包含一个<a class="ae ln" href="https://vuejs.org/v2/guide/conditional.html#v-if" rel="noopener ugc nofollow" target="_blank"> v-if </a>指令，如果的索引等于当前值，该指令仅显示部分<em class="no">。</em></p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="f9d3" class="nj mf iq ne b gy nk nl l nm nn">v-if="current == index"</span></pre><p id="513f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦你添加了颜色，就应该只显示第一种颜色。现在让我们添加一点CSS来调整<code class="fe nb nc nd ne b">&lt;section&gt;</code>的大小以填充屏幕。类似这样的事情应该会起作用:</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="ea00" class="nj mf iq ne b gy nk nl l nm nn">html, body, main, section{<br/>  height: 100%;<br/>  width: 100%;<br/>}</span></pre><p id="eefb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="no">注意:我总是在我的代码笔中包含一个</em> <a class="ae ln" href="https://cdnjs.com/libraries/meyer-reset" rel="noopener ugc nofollow" target="_blank"> <em class="no">重置</em> </a> <em class="no">，它可以快速移除浏览器默认带来的任何填充或边距样式。你还会想把这个加到你的头部，这样在手机上看起来会很漂亮。</em></p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="2a84" class="nj mf iq ne b gy nk nl l nm nn">&lt;meta name=”viewport” content=”width=device-width, initial-scale=1"&gt;</span></pre><p id="7069" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于一些Vue指令和CSS样式，现在我们有了一整页的颜色。很好。现在您可以从该部分中移除<code class="fe nb nc nd ne b">{{ color }}</code>变量，因为我们不需要它。接下来我们要做的是创建进度条的小导航。原来我们可以使用一个非常相似的<code class="fe nb nc nd ne b">v-for</code>循环来完成这个任务。</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="c39b" class="nj mf iq ne b gy nk nl l nm nn">&lt;nav&gt;<br/>  &lt;div v-for="color in colors"&gt;<br/>    &lt;div&gt;&lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/nav&gt;</span></pre><p id="1f37" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">简单的东西。真正的奇迹发生在CSS中。首先，让我们来设计我们的<code class="fe nb nc nd ne b">&lt;nav&gt;</code>。</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="5aed" class="nj mf iq ne b gy nk nl l nm nn">nav{<br/>  box-sizing: border-box;<br/>  display: grid;<br/>  grid-column-gap: 1em;<br/>  grid-template-columns: repeat(3, 1fr);<br/>  height: 0.5em;<br/>  padding: 0 1em;<br/>  position: fixed;<br/>  top: 1em;<br/>  width: 100%;<br/>}</span></pre><p id="b5ed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将<code class="fe nb nc nd ne b">nav</code>固定在页面的顶部，并告诉内部div在一个三列网格中呈现，每列之间的间距为1m。现在你可能想知道如果多于或少于三种颜色会发生什么。好问题。这将打破。在我的生产应用程序中，我决定添加一个样式绑定，它可以根据故事数量<em class="no">或颜色</em>动态改变网格列。</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="47b7" class="nj mf iq ne b gy nk nl l nm nn">&lt;nav<br/>  :style="{ gridTemplateColumns: `repeat(${colors.length}, 1fr)` }"<br/>&gt;</span></pre><p id="f5af" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">谢谢你Vue。接下来，我们需要设计内部div的样式，但这很简单。首先，将它添加到您的CSS中:</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="26f6" class="nj mf iq ne b gy nk nl l nm nn">nav &gt; div{<br/>  background: rgba(0,0,0,0.25);<br/>  height: 100%;<br/>}</span><span id="2fdb" class="nj mf iq ne b gy np nl l nm nn">nav &gt; div &gt; div{<br/>  background: black;<br/>  height: 100%;<br/>  width: 0%;<br/>}</span></pre><p id="e1f8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最初的内部div将获得透明的黑色背景，其中每个div都是不透明的黑色。不透明的div最初将被设置为0%的宽度，但会随着时间的推移而调整。</p><p id="4e6a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是HTML和CSS的内容。让我们跳到Javascript开始制作动画。</p><h1 id="c9d2" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">动画</h1><p id="beec" class="pw-post-body-paragraph kr ks iq kt b ku mw jr kw kx mx ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">首先，在你的项目中加入<a class="ae ln" href="https://animejs.com/" rel="noopener ugc nofollow" target="_blank"> Anime.js </a>。Anime.js一个轻量级但功能强大的javascript动画库。我通常不会在我的项目中使用这些工具，但是当我使用的时候，我更喜欢使用Anime.js进行简单的补间。首先，我们将创建一个时间表:</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="2772" class="nj mf iq ne b gy nk nl l nm nn">mounted() {<br/>  let timeline = anime.timeline({<br/>    autoplay: true,<br/>    duration: 10000,<br/>    easing: 'linear',<br/>    loop: true<br/>  })<br/>}</span></pre><p id="007a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这很简单。时间轴将自动播放，默认持续时间为10秒，以线性速率循环播放。现在让我们为每种颜色的时间轴添加一个动画，就在<code class="fe nb nc nd ne b">mounted()</code>中时间轴初始化的下面。</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="1f71" class="nj mf iq ne b gy nk nl l nm nn">this.colors.forEach((color, index) =&gt; {<br/>  timeline.add({<br/>    targets: document.querySelector('nav &gt; div')[index].children[0],<br/>    width: '100%',<br/>    changeBegin: (a) =&gt; {<br/>      this.current = index<br/>    }<br/>  })<br/>})</span></pre><p id="00e3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这告诉Anime.js为每个不透明的div添加一个时间轴动画，动画显示它们的宽度为100%。当每个动画开始时，我们将当前颜色参数调整为当前动画的索引。这允许颜色随着动画的播放而改变。你已经很接近了！让我们添加一些触摸事件来控制时间轴。</p><h1 id="475a" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">触摸事件</h1><p id="759a" class="pw-post-body-paragraph kr ks iq kt b ku mw jr kw kx mx ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">Hammer.js 是一个rad库，可以为你的应用程序添加触摸手势。它也是以MC Hammer的名字命名的，他曾经在推特上对我说过友好的话。真实故事！包括在您的项目中，让我们首先添加新闻事件。</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="cbc8" class="nj mf iq ne b gy nk nl l nm nn">let hammertime = new Hammer(document.querySelector('#app'))</span><span id="7c5d" class="nj mf iq ne b gy np nl l nm nn">hammertime.on('press', (e) =&gt; {<br/>  timeline.pause()<br/>})</span><span id="f5ff" class="nj mf iq ne b gy np nl l nm nn">hammertime.on('pressup', (e) =&gt; {<br/>  timeline.play()<br/>})</span></pre><p id="3043" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这再简单不过了，多亏了Hammer的监听器事件和Anime.js <a class="ae ln" href="https://animejs.com/documentation/#playPause" rel="noopener ugc nofollow" target="_blank">控件</a>函数。尝试通过点击并按住暂停，然后释放恢复播放。最后，如果我们的应用程序根据我们点击屏幕的哪一侧来导航下一个和上一个颜色，那就太好了。让我们使用Hammer.js tap事件来实现这一点。</p><pre class="kg kh ki kj gt nf ne ng nh aw ni bi"><span id="541e" class="nj mf iq ne b gy nk nl l nm nn">hammertime.on('tap', (e) =&gt; {<br/>  if (e.center.x &gt; window.innerWidth / 2) {<br/>    if (this.current &lt; this.colors.length - 1) {<br/>      this.current += 1<br/>      <br/>      this.timeline.pause()<br/>      this.timeline.seek(this.current * 10000)<br/>      this.timeline.play()<br/>    }<br/>  } else {<br/>    if (this.current &gt; 0) {<br/>      this.current -= 1<br/>      <br/>      this.timeline.pause()<br/>      this.timeline.seek(this.current * 10000)<br/>      this.timeline.play()<br/>    }<br/>  }<br/>})</span></pre><p id="b4ee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当点击事件被调用时，我们检查点击的x位置，看看它是出现在屏幕的左边还是右边。如果它在屏幕的右侧，并且我们还没有到达最后一个故事，我们将首先把当前的颜色变量加1。然后，我们将寻找时间轴动画到颜色进程的起始点，您可以通过将颜色索引乘以动画持续时间来声明。我们将对屏幕左侧做同样的操作，确保用户不会进入不存在的负面颜色。</p></div></div>    
</body>
</html>