<html>
<head>
<title>Loading CSV Data into Elasticsearch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将CSV数据加载到Elasticsearch</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/load-csv-data-into-elasticsearch-fdb562a7abd9?source=collection_archive---------1-----------------------#2019-06-21">https://levelup.gitconnected.com/load-csv-data-into-elasticsearch-fdb562a7abd9?source=collection_archive---------1-----------------------#2019-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bc420cf1e1388a2113685adccb0f92f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YYR7MrxWqC0_AuxYMsp2Dg.png"/></div></div></figure><p id="98ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇博客中，我将解释如何将公开的CSV数据导入到Elasticsearch中。Elastic Stack使我们能够轻松地分析任何数据，并帮助我们创建具有关键性能指标的仪表板。医疗保健、犯罪、农业等不同领域的CSV数据可在不同的政府网站上获得，我们可以轻松下载。下载CSV文件后，我们可以将它放入Elasticsearch，在数据的基础上进行搜索和分析。我见过很多次，人们不知道如何将这些CSV数据导入到Elasticsearch中，这就是为什么我在这篇博客中一步一步地解释了这个过程。</p><p id="6375" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据导入后，您可以使用这些数据进行数据分析或创建不同的仪表板。这里我以data.gov网站(<a class="ae kw" href="https://catalog.data.gov/dataset/crimes-2001-to-present-398a4" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="kx">https://catalog . data . gov/dataset/Crimes-2001-to-present-398 a4</em></strong></a>)的‘犯罪——2001年至今’为例。从这个网站上，你可以下载不同类型的CSV格式的数据。这个CSV文件的大小约为1.6 GB。</p><p id="508a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们开始将这些数据导入到Elasticsearch中。您需要执行以下操作:</p><ul class=""><li id="0790" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">从"https://catalog.data.gov/dataset下载CSV文件(crimes_2001.csv)？res_format=CSV "网站。该文件包含以下字段:</li></ul><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="9637" class="lq lr iq lm b gy ls lt l lu lv">ID | Case Number | Date | Block | IUCR | Primary Type | Description | Location | Description | Arrest | Domestic | Beat | District | Ward | Community Area | FBI Code | X Coordinate | Y Coordinate | Year | Updated On | Latitude | Longitude | Location</span></pre><ul class=""><li id="bd7d" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">创建一个Logstash配置文件，用于读取CSV数据并将其写入Elasticsearch。您需要在Logstash配置文件(crimes.conf)中编写以下表达式:</li></ul><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="5513" class="lq lr iq lm b gy ls lt l lu lv">input {<br/>    file {<br/>        path =&gt; "/home/user/Downloads/crimes_2001.csv"<br/>        start_position =&gt; beginning<br/>    }<br/>}<br/>filter {<br/>    csv {<br/>        columns =&gt; [<br/>                "ID",<br/>                "Case Number",<br/>                "Date",<br/>                "Block",<br/>                "IUCR",<br/>                "Primary Type",<br/>                "Description",<br/>                "Location Description",<br/>                "Arrest",<br/>                "Domestic",<br/>                "Beat",<br/>                "District",<br/>                "Ward",<br/>                "Community Area",<br/>                "FBI Code",<br/>                "X Coordinate",<br/>                "Y Coordinate",<br/>                "Year",<br/>                "Updated On",<br/>                "Latitude",<br/>                "Longitude",<br/>                "Location"<br/>        ]<br/>        separator =&gt; ","<br/>        }<br/>}<br/>output {<br/>    stdout<br/>    {<br/>        codec =&gt; rubydebug<br/>    }<br/>     elasticsearch {<br/>        action =&gt; "index"<br/>        hosts =&gt; ["127.0.0.1:9200"]<br/>        index =&gt; "crimes"<br/>    }<br/>}</span></pre><ul class=""><li id="6e9a" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">创建Logstash配置文件后，使用以下命令执行配置:</li></ul><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="4afc" class="lq lr iq lm b gy ls lt l lu lv">/usr/share/logstash/bin/logstash -f /etc/logstash/conf.d/crimes.conf</span></pre><p id="a9c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该命令将创建管道来读取CSV数据并将其写入Elasticsearch。</p><ul class=""><li id="1dee" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">您可以通过在浏览器中列出索引来验证Elasticsearch中“犯罪”索引的创建:</li></ul><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="a2a3" class="lq lr iq lm b gy ls lt l lu lv"><a class="ae kw" href="http://localhost:9200/_cat/indices?v" rel="noopener ugc nofollow" target="_blank">http://localhost:9200/_cat/indices?v</a></span></pre><ul class=""><li id="0a0d" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">如果您的索引“犯罪”被列出，您可以在Elasticsearch中查看数据:</li></ul><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="3516" class="lq lr iq lm b gy ls lt l lu lv"><a class="ae kw" href="http://localhost:9200/crimes/_search?pretty" rel="noopener ugc nofollow" target="_blank">http://localhost:9200/crimes/_search?pretty</a></span></pre><p id="f386" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在浏览器中或通过Curl打开上述URL后，您可以看到以下格式的数据:</p><pre class="lh li lj lk gt ll lm ln lo aw lp bi"><span id="cda9" class="lq lr iq lm b gy ls lt l lu lv">{<br/>        "_index" : "crimes",<br/>        "_type" : "_doc",<br/>        "_id" : "BTTXFWoB75utKkMR2zRC",<br/>        "_score" : 1.0,<br/>        "_source" : {<br/>          "Case Number" : "HY190059",<br/>          "Block" : "066XX S MARSHFIELD AVE",<br/>          "FBI Code" : "26",<br/>          "IUCR" : "4625",<br/>          "X Coordinate" : "1166468",<br/>          "Ward" : "15",<br/>          "Y Coordinate" : "1860715",<br/>          "Beat" : "0725",<br/>          "Location Description" : "STREET",<br/>          "Domestic" : "false",<br/>          "Community Area" : "67",<br/>          "Updated On" : "02/10/2018 03:50:01 PM",<br/>          "Primary Type" : "OTHER OFFENSE",<br/>          "Year of Crime" : "2015",<br/>          "host" : "KELLGGNLPTP0305",<br/>          "Date" : "03/18/2015 11:00:00 PM",<br/>          "path" : "/home/user/Downloads/crimes.csv",<br/>          "Arrest" : "true",<br/>          "Longitude" : "-87.665319468",<br/>          "id" : "10000094",<br/>          "Description" : "PAROLE VIOLATION",<br/>          "@timestamp" : "2019-04-13T08:37:05.351Z",<br/>          "District" : "007",<br/>          "Latitude" : "41.773371528",<br/>          "@version" : "1"<br/>        }<br/>}</span></pre><p id="fc50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以上来自“犯罪”索引的Elasticsearch文档表示CSV文件中的单个记录。</p><p id="b37b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过这种方式，您可以将任何CSV数据推入Elasticsearch，然后可以使用这些数据执行搜索、分析或创建仪表板。如果您有任何疑问，请评论。</p><p id="6d92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在推特上关注我:<a class="ae kw" href="https://twitter.com/anu4udilse" rel="noopener ugc nofollow" target="_blank">https://twitter.com/anu4udilse</a></p><p id="0dfe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Learning Kibana 7 </strong>本书荣登最佳新弹性搜索书籍</p><figure class="lh li lj lk gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/e9e34d3e2f02455225f888e14a19a28c.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*YISEo8biYXvUHFf3"/></div></figure><p id="6190" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我很高兴地宣布，我的书《学习Kibana 7:用Kibana的数据可视化功能构建强大的弹性仪表板，第二版》获得了https://bookauthority.org/books/new-elasticsearch-books?<a class="ae kw" href="https://bookauthority.org/books/new-elasticsearch-books?t=11vp86&amp;s=award&amp;book=1838550364" rel="noopener ugc nofollow" target="_blank">book authority的最佳新弹性搜索书籍</a> : <br/> <a class="ae kw" href="https://bookauthority.org/books/new-elasticsearch-books?t=11vp86&amp;s=award&amp;book=1838550364" rel="noopener ugc nofollow" target="_blank">t = 11vp 86&amp;s = award&amp;book = 1838550364</a><br/>book authority收集并排名世界上最好的书籍，能得到这种认可是莫大的荣幸。谢谢大家的支持！这本书在亚马逊上<a class="ae kw" href="https://www.amazon.com/dp/1838550364?tag=uuid10-20" rel="noopener ugc nofollow" target="_blank">有售。</a></p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><p id="dd6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">如果你觉得这篇文章很有趣，那么你可以探索一下“</em> <a class="ae kw" href="https://www.amazon.com/Mastering-Kibana-6-x-Visualize-histograms/dp/1788831039/ref=olp_product_details?_encoding=UTF8&amp;me=" rel="noopener ugc nofollow" target="_blank"> <em class="kx">掌握基巴纳6.0 </em> </a> <em class="kx">”、“</em> <a class="ae kw" href="https://www.amazon.com/Kibana-Quick-Start-Guide-Elasticsearch/dp/1789804035" rel="noopener ugc nofollow" target="_blank"> <em class="kx">基巴纳7快速入门指南</em> </a> <em class="kx">”、“</em> <a class="ae kw" href="https://www.amazon.com/Learning-Kibana-dashboards-visualization-capabilities-ebook/dp/B07V4SQR6T" rel="noopener ugc nofollow" target="_blank"> <em class="kx">学习基巴纳7 </em> </a> <em class="kx">”和“</em> <a class="ae kw" href="https://www.amazon.com/gp/product/1789803322?pf_rd_p=2d1ab404-3b11-4c97-b3db-48081e145e35" rel="noopener ugc nofollow" target="_blank"> <em class="kx">弹性搜索7快速入门指南</em> </a> <em class="kx"/></p><p id="8ffe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其他博客:</p><p id="ed81" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://faun.pub/introduction-to-logstash-afe109b886f0" rel="noopener ugc nofollow" target="_blank">Logstash简介</a></p><p id="50b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/introduction-to-kibana-5ce16ae7244b">基巴纳简介</a></p><p id="ff3a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://faun.pub/log-analysis-with-elastic-stack-2a493c113084" rel="noopener ugc nofollow" target="_blank">弹性叠加测井分析</a></p><p id="1dd8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://medium.com/swlh/introduction-to-openapi-specification-10c9d6fb0c8a" rel="noopener">open API规范介绍</a></p><p id="90fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/geo-distance-search-using-elasticsearch-7e2e69d76343">使用弹性搜索进行地理距离搜索</a></p><p id="7390" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/load-csv-data-into-elasticsearch-fdb562a7abd9">将CSV数据加载到Elasticsearch </a></p><p id="a5d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://faun.pub/configure-sonarqube-scanner-with-jenkins-27c23e7758fd" rel="noopener ugc nofollow" target="_blank">用Jenkins配置SonarQube扫描仪</a></p><p id="1a47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/configure-logstash-to-send-mongodb-data-into-elasticsearch-49cc0e9c2a8d">配置Logstash将MongoDB数据发送到Elasticsearch </a></p></div></div>    
</body>
</html>