<html>
<head>
<title>How to Setup User Authentication for Dash Apps using Python and Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python和Flask为Dash应用程序设置用户认证</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-setup-user-authentication-for-dash-apps-using-python-and-flask-6c2e430cdb51?source=collection_archive---------0-----------------------#2020-12-13">https://levelup.gitconnected.com/how-to-setup-user-authentication-for-dash-apps-using-python-and-flask-6c2e430cdb51?source=collection_archive---------0-----------------------#2020-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7036" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建用户帐户并保护对仪表板的访问</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a4b2ddace6ef9ac3bcba749913caa97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DGQl6exFN2NRm2k5"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">卢卡斯·布拉塞克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="9d26" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">保护您的数据</h1><p id="3dfd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">不久前，有人宣称数据是数字经济中的新石油[ <a class="ae ky" href="https://www.wired.com/insights/2014/07/data-new-oil-digital-economy/" rel="noopener ugc nofollow" target="_blank"> 1 </a> ]。自那次声明以来，理解网络安全和如何保护数据已经成为全球企业的头等大事。作为每天与敏感教育数据打交道的人，我亲身体会到保护记录的严重性。</p><p id="d42b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在分析部门工作，我的一个常用仪表盘工具是<a class="ae ky" href="https://plotly.com/dash/" rel="noopener ugc nofollow" target="_blank"> Dash </a> by <a class="ae ky" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>。Dash是基于Flask、Plotly.js和React.js编写的Python框架。它将这些技术的复杂性抽象为易于应用的组件。任何有一点Python和HTML经验的人都会觉得Dash使他们能够毫不费力地创建强大的、交互式的基于web的仪表板。</p><blockquote class="ms mt mu"><p id="6c8f" class="lr ls mv lt b lu mn ju lw lx mo jx lz mw mp mc md mx mq mg mh my mr mk ml mm im bi translated">Dash &amp; Plotly每月被下载400万次，是世界生产Python分析的方式。—<a class="ae ky" href="http://plotly.com" rel="noopener ugc nofollow" target="_blank">p</a>T12】lotly.com</p></blockquote><p id="ec75" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">在本文中，我将介绍两种通过基于用户的认证来保护Dash应用的方法</strong>:</p><ol class=""><li id="d6e3" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">如何使用<a class="ae ky" href="https://dash.plotly.com/authentication" rel="noopener ugc nofollow" target="_blank"> Dash-Auth </a>(简单的例子)。</li><li id="9656" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">如何使用<a class="ae ky" href="https://flask-login.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">烧瓶-登录</a>(高级示例)。</li></ol><blockquote class="nn"><p id="fcd0" class="no np it bd nq nr ns nt nu nv nw mm dk translated">示例2的完整代码可以在文章的底部找到。</p></blockquote><h1 id="7e9b" class="kz la it bd lb lc ld le lf lg lh li lj jz nx ka ll kc ny kd ln kf nz kg lp lq bi translated">仪表板框架复习工具</h1><p id="68f9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在描述示例应用程序和起始代码时，我将非常简短地向您介绍Dash的核心概念。然而，如果你是Dash新手或者需要深入复习基础知识，可以从我的<a class="ae ky" href="https://medium.com/swlh/dashboards-in-python-for-beginners-and-everyone-else-using-dash-f0a045a86644" rel="noopener"><em class="mv">Dash</em></a>入门教程开始，或者查看我的网站<a class="ae ky" href="http://pythondashboards.com" rel="noopener ugc nofollow" target="_blank"><em class="mv">pythondashboards.com</em></a>。</p><div class="oa ob gp gr oc od"><a href="https://medium.com/swlh/dashboards-in-python-for-beginners-and-everyone-else-using-dash-f0a045a86644" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">Python中的仪表盘，适用于初学者和使用Dash的其他人</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">使用Python中的Dash初学者教程构建一个基本的和高级的仪表板</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><p id="c838" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在创建应用程序之前，从安装依赖项开始。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="973b" class="ox la it ot b gy oy oz l pa pb">pip install dash<br/>pip install dash-auth</span></pre><p id="599c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为本文的重点是保护仪表板，所以我将从一个简单的Dash应用程序示例开始，它由下拉列表和图表组成。接下来，我将添加身份验证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/2067e2fce9f531b21922a4848c514fd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sY9IPg_mLU__8CClRemhhw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">一个简单的Dash应用程序示例</figcaption></figure><p id="16a1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想要一个高级Dash应用程序的例子，<a class="ae ky" href="https://medium.com/swlh/how-to-create-a-dashboard-to-dominate-the-stock-market-using-python-and-dash-c35a12108c93" rel="noopener">看看我用来主宰股票市场的仪表板</a>！</p><div class="oa ob gp gr oc od"><a href="https://medium.com/swlh/how-to-create-a-dashboard-to-dominate-the-stock-market-using-python-and-dash-c35a12108c93" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">如何使用Python和Dash创建控制股市的仪表板</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">自由期权订单流、价格、基本面、聊天集于一身</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div><div class="om l"><div class="pd l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="4552" class="kz la it bd lb lc pl le lf lg pm li lj jz pn ka ll kc po kd ln kf pp kg lp lq bi translated">Dash应用</h1><p id="fe17" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Dash应用由<strong class="lt iu">布局</strong>和<strong class="lt iu">回调</strong>组成:</p><h2 id="503a" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">布局</h2><p id="578e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">布局由一个组件树组成，描述了应用程序的外观以及用户如何体验内容。Dash自带了几个组件库。</p><h2 id="d8de" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">复试</h2><p id="59a8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://dash.plot.ly/getting-started-part-2" rel="noopener ugc nofollow" target="_blank">回调</a>使Dash应用程序具有交互性。回调是Python函数，每当<em class="mv">输入</em>属性改变时，就会自动调用。</p><h1 id="4320" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">仪表板应用程序启动代码</h1><p id="79a8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下面是认证演练的Dash应用程序启动代码。高级示例将使用相同的下拉菜单和图形功能，但明显增加了复杂性。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="c308" class="ox la it ot b gy oy oz l pa pb"><em class="mv">#dependencies </em><br/>import dash<br/>import dash_core_components as dcc<br/>import dash_html_components as html<br/>import plotly</span><span id="78b6" class="ox la it ot b gy qb oz l pa pb"><em class="mv">#instantiate Dash</em><br/>app = dash.Dash(__name__)</span><span id="11ca" class="ox la it ot b gy qb oz l pa pb"><em class="mv">#Set the layout</em><br/>app.layout = html.Div([<br/>    <strong class="ot iu">html.H1</strong>('A Simple Dash App')<br/>    , <strong class="ot iu">dcc.Dropdown</strong>(<br/>        id='dropdown'<br/>        , options=[{'label': i, 'value': i} <br/>                for i in ['Day 1', 'Day 2']]<br/>        , value='Day 1')<br/>    , <strong class="ot iu">dcc.Graph</strong>(id='graph')<br/>    ]) #end div</span><span id="b7d2" class="ox la it ot b gy qb oz l pa pb"><em class="mv">#set the callback for the dropdown interactivity</em><br/><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank"><strong class="ot iu">@app</strong></a><strong class="ot iu">.callback</strong>(<br/>    dash.dependencies.Output('graph', 'figure')<br/>    , [dash.dependencies.Input('dropdown', 'value')])<br/>def update_graph(dropdown_value):<br/>    if dropdown_value == 'Day 1':<br/>        return {'layout': {'title': 'Graph of Day 1'}<br/>                , 'data': [{'x': [1, 2, 3, 4]<br/>                    , 'y': [4, 1, 2, 1]}]}<br/>    else:<br/>        return {'layout': {'title': 'Graph of Day 2'}<br/>                ,'data': [{'x': [1, 2, 3, 4]<br/>                    , 'y': [2, 3, 2, 4]}]}</span><span id="7a55" class="ox la it ot b gy qb oz l pa pb">if __name__ == '__main__':<br/>    app.run_server(debug=True)</span></pre><p id="07c3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，应用程序布局由三个组件组成(<a class="ae ky" href="https://dash.plotly.com/dash-html-components/h1" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> html)。H1 </strong> </a>，<a class="ae ky" href="https://dash.plotly.com/dash-core-components/dropdown" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> dcc。下拉</strong> </a>，<a class="ae ky" href="https://dash.plotly.com/dash-core-components/graph" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> dcc。Graph </strong> </a>)和一个回调来使它有点交互性。用户可以在下拉列表中的两个项目之间进行选择，图形会相应地更新。</p><p id="b024" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当app在终端运行时，可以通过浏览器使用这个URL在本地访问:<a class="ae ky" href="http://127.0.0.1:8050/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8050/ </a>。如果它被托管在某个地方，任何人都可以访问它并查看图表。因为我只希望某些人访问仪表板，所以我将使用<strong class="lt iu"> Dash-Auth </strong>来设置<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication" rel="noopener ugc nofollow" target="_blank">基本HTTP认证</a>。</p><h1 id="f208" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">使用破折号验证的基本验证</h1><p id="b78f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用Dash-Auth库很容易，但是它有一些限制。例如，使用基本身份验证，我必须在字典中硬编码用户名和密码，并将用户名/密码对发送给我希望访问应用程序的用户。用户不能创建自己的帐户或更改密码，也不能注销。在使用Flask-Login的高级示例中，我将让用户创建自己的用户名和密码！</p><p id="2b3f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">警告</strong>:像对待API密钥一样对待用户名/密码对，把它们放在源代码库之外！<a class="ae ky" href="https://towardsdatascience.com/a-simple-git-workflow-for-github-beginners-and-everyone-else-87e39b50ee08" rel="noopener" target="_blank">记得将文件添加到您的。gitignore </a>。</p><h2 id="0bac" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">文件结构</h2><p id="9e6b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该应用程序使用两个文件。我将用户名/密码对作为文本存储在python文件中，与应用程序代码分开。在高级示例中，我将使用SQLite数据库来存储用户数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/e71d5e75be822d3527a9f69126ec21e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*hKD7YFybC50wqUP3CX7RZw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">文件结构</figcaption></figure><h2 id="b1ca" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">文件用户. py</h2><p id="3d6f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">文件<strong class="lt iu"> users.py </strong>包含用户名/密码字典。如果我需要让三个人访问Dash应用程序，我需要创建三个用户名/密码对，如下所示:</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="116b" class="ox la it ot b gy oy oz l pa pb"><strong class="ot iu"><em class="mv">#user dictionary</em></strong><br/>USERNAME_PASSWORD_PAIRS = {<br/>     'user1': 'test1'<br/>    , 'user2': 'test2'<br/>    , 'user3': 'test3'<br/>}</span></pre><h2 id="0cd4" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">文件app.py</h2><p id="b42e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">文件<strong class="lt iu"> app.py </strong>包含Dash应用程序的代码。对于依赖项，从<strong class="lt iu"> users.py </strong>文件导入<strong class="lt iu"> <em class="mv"> dash_auth </em> </strong>库和用户字典。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="2c2c" class="ox la it ot b gy oy oz l pa pb"><strong class="ot iu"><em class="mv">#import dash-auth and users dictionary</em></strong><br/>import dash_auth<br/>from users import USERNAME_PASSWORD_PAIRS</span></pre><p id="4d6b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，在app.py文件中实例化应用程序后，添加这一小段样板代码:</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="1615" class="ox la it ot b gy oy oz l pa pb">auth = dash_auth.BasicAuth(app, USERNAME_PASSWORD_PAIRS)</span></pre><p id="3b79" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">它应该是这样的:</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="bc89" class="ox la it ot b gy oy oz l pa pb"><strong class="ot iu"><em class="mv">#import dependencies</em></strong><br/>import dash_auth<br/>from users import USERNAME_PASSWORD_PAIRS</span><span id="6696" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#instantiate Dash</em></strong><br/>app = dash.Dash(__name__)<br/>auth = dash_auth.BasicAuth(<br/>    app,<br/>    USERNAME_PASSWORD_PAIRS<br/>)</span><span id="8a20" class="ox la it ot b gy qb oz l pa pb">### layout and callbacks ###<br/>...</span></pre><p id="86ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">就是这样！现在已经设置了基本身份验证。打开Dash应用程序时，会提示用户输入用户名和密码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/f6b1dea91ba5986e8dd3050846627157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3KxKa1NX7P-Y7rLdLMhrNw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Dash认证提示</figcaption></figure><p id="0c95" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从<strong class="lt iu"> users.py </strong>文件中输入一个用户/密码组合来访问仪表板。</p><p id="1c59" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在幕后，HTTP身份验证框架正在挑战客户机请求，迫使它提供身份验证信息。该过程开始于服务器以未授权的响应状态响应客户端(401)。想要向服务器进行身份验证的客户端必须包含带有凭据的授权请求标头。</p><p id="5e0c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">注意</strong>，交换<strong class="lt iu"> <em class="mv">必须</em> </strong> <em class="mv"> </em>发生在HTTPS (TLS)连接上才安全。该流程由<a class="ae ky" href="https://tools.ietf.org/html/rfc7235" rel="noopener ugc nofollow" target="_blank"> RFC 7235 </a>定义。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/c9fe1606a85db5e97a81982fd5d9e498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*2yyFfM2jkI6Cb3s4iLqQmQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通用HTTP认证框架(Mozilla Contributors)<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTTP/authentic ation</a></figcaption></figure><h1 id="a44c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">使用Flask-Login的高级身份验证</h1><p id="1a80" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> Dash-Auth </strong>库为用户访问仪表板提供了一种简单的方法，但是在会话管理方面提供的很少。对于更健壮的认证解决方案，我推荐使用<a class="ae ky" href="https://flask-login.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Flask-Login库</a>。它将活动用户的ID存储在会话中，允许他们登录和注销，同时保护用户的会话不被cookie窃贼窃取。根据文件:</p><blockquote class="ms mt mu"><p id="3f08" class="lr ls mv lt b lu mn ju lw lx mo jx lz mw mp mc md mx mq mg mh my mr mk ml mm im bi translated">它处理登录、注销和长时间记住用户会话的常见任务。</p></blockquote><p id="846a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然Flask-Login功能强大，但也有一些限制。它没有固有的方法来注册用户或恢复帐户。我将解释如何创建这些函数。此外，该库只处理登录或注销，不处理其他权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qf"><img src="../Images/d32a6f72fb183548e6f5a7e03f9ddd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6OIuYzhA0JxOTpjT2keKyQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通过Dash应用程序进行身份验证的工作流程</figcaption></figure><h1 id="b021" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">属国</h1><p id="9c2b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个高级示例使用了几个强大的Python库。深入解释它们超出了本教程的范围，但是我会尽最大努力从高层次解释每个组件。</p><p id="18aa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用<strong class="lt iu"> pip </strong>安装这些必要的库:<em class="mv"> sqlalchemy、flask-sqlalchemy、flask-login、werkzeug和configparser。</em></p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="9eab" class="ox la it ot b gy oy oz l pa pb"><strong class="ot iu"><em class="mv">#import dependencies</em></strong></span><span id="a13e" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#manage database and users<br/></em></strong>import sqlite3<br/>from sqlalchemy import Table, create_engine<br/>from sqlalchemy.sql import select<br/>from flask_sqlalchemy import SQLAlchemy<br/>from flask_login import login_user, logout_user, current_user, LoginManager, UserMixin</span><span id="d445" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#manage password hashing</em></strong><br/>from werkzeug.security import generate_password_hash, check_password_hash</span><span id="0a80" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#use to config server</em></strong><br/>import warnings<br/>import configparser<br/>import os</span><span id="5490" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#dash dependencies</em></strong><br/>import dash_core_components as dcc<br/>import dash_html_components as html<br/>import dash<br/>from dash.dependencies import Input, Output, State</span></pre><h1 id="b22e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">文件结构</h1><p id="651d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">文件结构类似于第一个例子，因为它只包含两个文件。文件<strong class="lt iu"> app.py </strong>包含Dash应用程序的代码，将由几个不同的布局组成，以适应创建用户帐户、登录和显示图表数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/422a65798f1c3a5f1183fd4ef9d5209c.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*9RilifowmDycaLq0yC3ywg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">文件结构</figcaption></figure><h1 id="1432" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">文件data.sqlite</h1><p id="cfd1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我建议在创建Dash应用程序之前，用一个<em class="mv"> Users </em>表创建数据库。</p><p id="c482" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> data.sqlite </strong>文件是数据库，在<em class="mv"> Users </em>表中存储用户名、密码和电子邮件地址。为了保护用户密码，将使用<a class="ae ky" href="https://werkzeug.palletsprojects.com/en/1.0.x/" rel="noopener ugc nofollow" target="_blank"> werkzeug库</a>对密码进行<a class="ae ky" href="https://www.wired.com/2016/06/hacker-lexicon-password-hashing/" rel="noopener ugc nofollow" target="_blank">散列</a>。Werkzeug是一个高级的<a class="ae ky" href="https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface" rel="noopener ugc nofollow" target="_blank"> web服务器网关接口</a> ( <a class="ae ky" href="https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface" rel="noopener ugc nofollow" target="_blank"> WSGI </a>)实用程序库。</p><h2 id="4a8a" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">设置数据库和用户表</h2><p id="f82d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果数据库尚不存在，连接时将自动创建。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="0f5e" class="ox la it ot b gy oy oz l pa pb">conn = sqlite3.connect('data.sqlite')</span></pre><p id="c1b1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如上面的<em class="mv">认证工作流程</em>图所示，我希望用户创建自己的账户。用于将用户帐户写入数据库的数据库连接和插入语句将由<a class="ae ky" href="https://www.sqlalchemy.org/" rel="noopener ugc nofollow" target="_blank"> SQLAlchemy库</a>管理。此外，由于Dash构建在Flask之上，我将使用<a class="ae ky" href="https://flask-sqlalchemy.palletsprojects.com/en/2.x/" rel="noopener ugc nofollow" target="_blank"> Flask-SQLAlchemy </a>来配置服务器与数据库进行交互。</p><p id="e100" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://www.sqlalchemy.org/" rel="noopener ugc nofollow" target="_blank"> SQLAlchemy </a>是一个强大而灵活的企业级SQL工具包和用于Python的<a class="ae ky" href="https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping#:~:text=Object%2Drelational%20mapping%20(ORM%2C,from%20within%20the%20programming%20language." rel="noopener ugc nofollow" target="_blank">对象关系映射器</a>。<a class="ae ky" href="https://flask-sqlalchemy.palletsprojects.com/en/2.x/" rel="noopener ugc nofollow" target="_blank"> Flask-SQLAlchemy </a>是对<a class="ae ky" href="http://flask.pocoo.org/" rel="noopener ugc nofollow" target="_blank"> Flask </a>的扩展，为Flask应用程序增加了对<a class="ae ky" href="https://www.sqlalchemy.org/" rel="noopener ugc nofollow" target="_blank"> SQLAlchemy </a>的支持。由于Dash是基于Flask构建的，所以一切都可以完美地协同工作。</p><h2 id="a252" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">创建用户表</h2><p id="35d4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了在数据库中存储用户帐户，我需要一个表，其中包含用户名<em class="mv">、<em class="mv">密码</em>和<em class="mv">电子邮件</em>列。SQLAlchemy可以处理表的创建。使用下面的模板创建<strong class="lt iu"> <em class="mv">用户</em> </strong>表。</em></p><p id="73d2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，这可以使用原始SQL而不是SQLAlchemy来完成。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="d04a" class="ox la it ot b gy oy oz l pa pb">conn = sqlite3.connect('data.sqlite')</span><span id="fb13" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#connect to the database</em></strong><br/>engine = create_engine('sqlite:///data.sqlite')<br/>db = SQLAlchemy()</span><span id="4239" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#class for the table Users</em></strong><br/>class Users(db.Model):<br/>    id = db.Column(db.Integer, primary_key=True)<br/>    username = db.Column(db.String(15), unique=True, nullable = False)<br/>    email = db.Column(db.String(50), unique=True)<br/>    password = db.Column(db.String(80))</span><span id="5084" class="ox la it ot b gy qb oz l pa pb">Users_tbl = Table('users', Users.metadata)</span><span id="154c" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#fuction to create table using Users class<br/></em></strong>def create_users_table():<br/>    Users.metadata.create_all(engine)</span><span id="bd7b" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#create the table</em></strong><br/>create_users_table()</span></pre><p id="4c7d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，该表是通过运行<strong class="lt iu"> create_users_table </strong>函数创建的。</p><p id="21c1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我发现使用pandas库检查表格数据是最容易的，因为dataframes以列和行的形式漂亮地呈现了数据。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="22ed" class="ox la it ot b gy oy oz l pa pb">import pandas as pd<br/>c = conn.cursor()<br/>df = pd.read_sql('select * from users', conn)<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/1c6e66be03ff37eebb3c05a90cfc167d.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*4wgEAL69Ehyld-unDIQjDg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">查询用户表</figcaption></figure><p id="7c8f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，数据库和表已经设置好了，是时候创建Dash应用程序了！</p></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="369e" class="kz la it bd lb lc pl le lf lg pm li lj jz pn ka ll kc po kd ln kf pp kg lp lq bi translated">配置Dash应用服务器</h1><p id="4476" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">由于我使用的是Flask和SQLAlchemy，所以配置这个应用程序比简单的Dash应用程序要复杂一些。使用这段boiler-plate代码为Dash应用程序配置Flask服务器，并让它通过SQLAlchemy与数据库交互。如果您使用SQLAlchemy来构建Users表，那么这些代码的大部分应该已经很熟悉了。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="4731" class="ox la it ot b gy oy oz l pa pb">warnings.filterwarnings("ignore")</span><span id="1f60" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#connect to SQLite database</em></strong><br/>conn = sqlite3.connect('data.sqlite')<br/>engine = create_engine('sqlite:///data.sqlite')<br/>db = SQLAlchemy()</span><span id="d2ea" class="ox la it ot b gy qb oz l pa pb">config = configparser.ConfigParser()</span><span id="5181" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#create users class for interacting with users table<br/></em></strong>class Users(db.Model):<br/>    id = db.Column(db.Integer, primary_key=True)<br/>    username = db.Column(db.String(15), unique=True, nullable = False)<br/>    email = db.Column(db.String(50), unique=True)<br/>    password = db.Column(db.String(80))</span><span id="af82" class="ox la it ot b gy qb oz l pa pb">Users_tbl = Table('users', Users.metadata)</span><span id="a4b3" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#instantiate dash app</em></strong><br/>app = dash.Dash(__name__)<br/>server = app.server<br/>app.config.suppress_callback_exceptions = True</span><span id="dc4e" class="ox la it ot b gy qb oz l pa pb"><strong class="ot iu"><em class="mv">#config the server to interact with the database<br/>#Secret Key is used for user sessions</em></strong><br/>server.config.update(<br/>    SECRET_KEY=os.urandom(12),<br/>    SQLALCHEMY_DATABASE_URI='sqlite:///data.sqlite',<br/>    SQLALCHEMY_TRACK_MODIFICATIONS=False<br/>)</span><span id="a2d4" class="ox la it ot b gy qb oz l pa pb">db.init_app(server)</span></pre><p id="d305" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意<strong class="lt iu"> os.urandom </strong>用于生成<strong class="lt iu"> <em class="mv"> SECRET_KEY </em> </strong>。这将在下一节解释，因为它与Flask-Login功能相关。</p><p id="1798" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有关配置应用程序的更深入的信息，我建议查看Flask-SQLAlchemy配置文档。</p><div class="oa ob gp gr oc od"><a href="https://flask-sqlalchemy.palletsprojects.com/en/2.x/config/" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">配置-烧瓶-SQLAlchemy文档(2.x)</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">Flask-SQLAlchemy有以下配置值。Flask-SQLAlchemy从您的主Flask加载这些值…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">flask-sqlalchemy.palletsprojects.com</p></div></div><div class="om l"><div class="qi l oo op oq om or ks od"/></div></div></a></div><h1 id="7554" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在Dash应用中配置Flask-Login</h1><p id="300a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Flask-Login是一个强大的库，在本教程中我只触及了皮毛。<a class="ae ky" href="https://flask-login.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">阅读文档，获取Flask-Login </a>提供的所有高级功能列表。</p><p id="3ebe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用<a class="ae ky" href="https://flask-login.readthedocs.io/en/latest/#flask_login.LoginManager" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> LoginManager </strong> </a>类允许Dash应用程序使用Flask-Login。默认情况下，Flask-Login使用<a class="ae ky" href="https://flask.palletsprojects.com/en/1.1.x/quickstart/#sessions" rel="noopener ugc nofollow" target="_blank">会话</a>进行身份验证。这意味着配置必须包含密钥。这就是为什么<a class="ae ky" href="https://flask.palletsprojects.com/en/1.1.x/quickstart/#sessions" rel="noopener ugc nofollow" target="_blank"> SECERET_KEY </a>在前面的部分被设置。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="44db" class="ox la it ot b gy oy oz l pa pb">login_manager = LoginManager<strong class="ot iu">()</strong></span></pre><p id="7420" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">登录管理器让Dash应用程序做一些事情，比如从ID加载用户，并在登录过程中验证用户。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="b8ca" class="ox la it ot b gy oy oz l pa pb"><strong class="ot iu"><em class="mv">#This provides default implementations for the methods that Flask-#Login expects user objects to have</em></strong><br/>login_manager.init_app<strong class="ot iu">(</strong>app<strong class="ot iu">)<br/></strong>class Users(UserMixin, Users):<br/>    pass</span></pre><p id="c083" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">需要回调<strong class="lt iu"> login_manager </strong>来完成登录过程。这个回调将与Dash回调的其余部分一起进行。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="0df2" class="ox la it ot b gy oy oz l pa pb"><strong class="ot iu"><em class="mv"># callback to reload the user object<br/></em></strong><a class="ae ky" href="http://twitter.com/login_manager" rel="noopener ugc nofollow" target="_blank">@login_manager</a>.user_loader<br/>def load_user(user_id):<br/>    return Users.query.get(int(user_id))</span></pre><p id="552b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">恭喜你！Flask-Login已配置。现在是时候构建Dash应用程序的其余部分了。</p></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="9b81" class="kz la it bd lb lc pl le lf lg pm li lj jz pn ka ll kc po kd ln kf pp kg lp lq bi translated">创建仪表板应用程序布局</h1><p id="4db7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">身份验证工作流程中的每个步骤都对应于app.py文件中的一个布局。在认证和Dash应用程序内容之间，总共使用了六种布局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/72fc465938b033e0dbf3555caf1b31b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*zvOPT38La8O6xFZGMXuomw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Dash应用程序中的六种布局</figcaption></figure><h2 id="bfe5" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">创建布局</h2><p id="01e8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">此布局用于让用户创建他们的用户帐户。它使用依赖于<em class="mv">输入的</em> <a class="ae ky" href="https://dash.plotly.com/dash-core-components" rel="noopener ugc nofollow" target="_blank">破折号核心组件</a>来接收用户输入。当用户点击<strong class="lt iu">创建用户</strong>按钮时，会触发一个回调，并将用户的输入写入数据库。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="3dea" class="ox la it ot b gy oy oz l pa pb">create = html.Div([ html.H1('Create User Account')<br/>        , dcc.Location(id='create_user', refresh=True)<br/>        , dcc.Input(id="username"<br/>            , type="text"<br/>            , placeholder="user name"<br/>            , maxLength =15)<br/>        , dcc.Input(id="password"<br/>            , type="password"<br/>            , placeholder="password")<br/>        , dcc.Input(id="email"<br/>            , type="email"<br/>            , placeholder="email"<br/>            , maxLength = 50)<br/>        , html.Button('Create User', id='submit-val', n_clicks=0)<br/>        , html.Div(id='container-button-basic')<br/>    ])#end div</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qk"><img src="../Images/be1d89142c28887474429348cbc5f5ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*ocXANRGWsXPsS7xKckmNiA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">创建布局</figcaption></figure><h2 id="088b" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">创建回拨</h2><p id="df0c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用回调，输入被写入数据库。使用破折号依赖状态存储输入。<strong class="lt iu">状态</strong>允许在不触发回调的情况下输入值，直到按下<strong class="lt iu">创建用户</strong>按钮。</p><p id="eb10" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意回调中的一些事情:</p><ul class=""><li id="878e" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ql nf ng nh bi translated">我使用SQLAlchemy来插入值，而不是原始SQL。</li></ul><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="22b2" class="ox la it ot b gy oy oz l pa pb">ins = Users_tbl.insert().values(username=un,  password=hashed_password, email=em,)</span></pre><ul class=""><li id="59c8" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ql nf ng nh bi translated">使用<a class="ae ky" href="https://werkzeug.palletsprojects.com/en/1.0.x/" rel="noopener ugc nofollow" target="_blank"> Werkzeug库</a>中的<a class="ae ky" href="https://werkzeug.palletsprojects.com/en/1.0.x/utils/?highlight=check_password_hash#werkzeug.security.generate_password_hash" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">generate _ password _ hash</strong></a>函数对用户密码进行哈希运算。</li></ul><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="c697" class="ox la it ot b gy oy oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>   [Output('container-button-basic', "children")]<br/>    , [Input('submit-val', 'n_clicks')]<br/>    , [State('username', 'value'), State('password', 'value'), State('email', 'value')])<br/>def insert_users(n_clicks, un, pw, em):<br/>    hashed_password = generate_password_hash(pw, method='sha256')<br/>    if un is not None and pw is not None and em is not None:<br/>        ins = Users_tbl.insert().values(username=un,  password=hashed_password, email=em,)<br/>        conn = engine.connect()<br/>        conn.execute(ins)<br/>        conn.close()<br/>        return [login]<br/>    else:<br/>        return [html.Div([html.H2('Already have a user account?'), dcc.Link('Click here to Log In', href='/login')])]</span></pre><p id="8e9f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，请注意，在创建用户帐户时会返回登录布局，以便用户轻松登录。</p><h2 id="b9ea" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">登录布局</h2><p id="f774" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">登录布局用于让用户在创建其用户帐户后登录。它使用<strong class="lt iu">输入</strong>字段和一个<strong class="lt iu">按钮</strong>，就像<em class="mv">创建</em>布局一样。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="ddc6" class="ox la it ot b gy oy oz l pa pb">login =  html.Div([dcc.Location(id='url_login', refresh=True)<br/>            , html.H2('''Please log in to continue:''', id='h1')<br/>            , dcc.Input(placeholder='Enter your username',<br/>                    type='text',<br/>                    id='uname-box')<br/>            , dcc.Input(placeholder='Enter your password',<br/>                    type='password',<br/>                    id='pwd-box')<br/>            , html.Button(children='Login',<br/>                    n_clicks=0,<br/>                    type='submit',<br/>                    id='login-button')<br/>            , html.Div(children='', id='output-state')<br/>        ]) #end div</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qm"><img src="../Images/5a327beeda30ab7e3ad4a51d499848c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*UklRjoi9rl-wFcqh5f6Pqg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">登录布局</figcaption></figure><h2 id="7bb8" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">登录回调</h2><p id="40f3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">登录时有两个回调函数。第一个将用户传递到成功页面。第二个回调告诉用户，如果他们的信息是错误的或者在数据库中找不到，他们的用户名或密码是不正确的。</p><p id="5d8b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">回调使用Werkzeug库中的函数<a class="ae ky" href="https://werkzeug.palletsprojects.com/en/1.0.x/utils/?highlight=check_password_hash#werkzeug.security.check_password_hash" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">check _ password _ hash</strong></a>。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="f86d" class="ox la it ot b gy oy oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_login', 'pathname')<br/>    , [Input('login-button', 'n_clicks')]<br/>    , [State('uname-box', 'value'), State('pwd-box', 'value')])<br/>def successful(n_clicks, input1, input2):<br/>    user = Users.query.filter_by(username=input1).first()<br/>    if user:<br/>        if check_password_hash(user.password, input2):<br/>            login_user(user)<br/>            return '/success'<br/>        else:<br/>            pass<br/>    else:<br/>        pass</span><span id="3f7f" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('output-state', 'children')<br/>    , [Input('login-button', 'n_clicks')]<br/>    , [State('uname-box', 'value'), State('pwd-box', 'value')])<br/>def update_output(n_clicks, input1, input2):<br/>    if n_clicks &gt; 0:<br/>        user = Users.query.filter_by(username=input1).first()<br/>        if user:<br/>            if check_password_hash(user.password, input2):<br/>                return ''<br/>            else:<br/>                return 'Incorrect username or password'<br/>        else:<br/>            return 'Incorrect username or password'<br/>    else:<br/>        return ''</span></pre><p id="d224" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意回调使用SQLAlchemy通过用户名查询Users表。下面的代码描述了SQLAlchemy如何取回用户数据，以便验证密码。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="8771" class="ox la it ot b gy oy oz l pa pb">Users.query.filter_by(username=input1).first()</span></pre><h2 id="1f7f" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">成功布局</h2><p id="50ef" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">成功布局显示了用户在身份验证后可以访问的可用数据集。应用程序中唯一可用的数据集是我在第一个示例中为图表创建的数据集。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="1792" class="ox la it ot b gy oy oz l pa pb">success = html.Div([dcc.Location(id='url_login_success', refresh=True)<br/>            , html.Div([html.H2('Login successful.')<br/>                    , html.Br()<br/>                    , html.P('Select a Dataset')<br/>                    , dcc.Link('Data', href = '/data')<br/>                ]) #end div<br/>            , html.Div([html.Br()<br/>                    , html.Button(id='back-button', children='Go back', n_clicks=0)<br/>                ]) #end div<br/>        ]) #end div</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qn"><img src="../Images/4baac62f74ada0606c4fcf51af82f83b.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*7nmgFko1s42kCdP5T2pZmw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">成功布局</figcaption></figure><h2 id="aa75" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">失败的布局</h2><p id="7b28" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当用户登录失败时，将显示失败的布局。注意<strong class="lt iu">登录</strong>布局嵌入在<strong class="lt iu">失败</strong>布局中，允许用户重新输入他们的凭证。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="8197" class="ox la it ot b gy oy oz l pa pb">failed = html.Div([ dcc.Location(id='url_login_df', refresh=True)<br/>            , html.Div([html.H2('Log in Failed. Please try again.')<br/>                    , html.Br()<br/>                    , html.Div([login])<br/>                    , html.Br()<br/>                    , html.Button(id='back-button', children='Go back', n_clicks=0)<br/>                ]) #end div<br/>        ]) #end div</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/8eda0ec9c0a3d3c75447bbb1e5c6d533.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*nRhDv6H2EJGvYKBPY2f8wA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">失败的布局</figcaption></figure><h2 id="5ad2" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">注销布局</h2><p id="378f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">用户注销后，将显示注销布局。与失败的布局一样，<strong class="lt iu">登录</strong>布局是嵌入式的，因此用户可以轻松地再次登录。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="a12f" class="ox la it ot b gy oy oz l pa pb">logout = html.Div([dcc.Location(id='logout', refresh=True)<br/>        , html.Br()<br/>        , html.Div(html.H2('You have been logged out - Please login'))<br/>        , html.Br()<br/>        , html.Div([login])<br/>        , html.Button(id='back-button', children='Go back', n_clicks=0)<br/>    ])#end div</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/50d8c6060eabf31a54f259f7ddedf972.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*vm6ia7ohG01lcccr64aGnQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">注销布局</figcaption></figure><h2 id="98e7" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">数据打印格式</h2><p id="00c8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该布局显示了在第一个示例中设置的图表。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="30bb" class="ox la it ot b gy oy oz l pa pb">data = html.Div([dcc.Dropdown(<br/>                    id='dropdown',<br/>                    options=[{'label': i, 'value': i} for i in ['Day 1', 'Day 2']],<br/>                    value='Day 1')<br/>                , html.Br()<br/>                , html.Div([dcc.Graph(id='graph')])<br/>            ]) #end div</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qq"><img src="../Images/b9e394930450e0e46ee078e58acfe190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9K_1fE_rZf-KVHcW7dslhA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">数据打印格式</figcaption></figure><h2 id="43af" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">数据回调</h2><p id="1fc0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据回调根据在下拉菜单中选择的选项输出图形。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="d5e1" class="ox la it ot b gy oy oz l pa pb">#set the callback for the dropdown interactivity<br/><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    [Output('graph', 'figure')]<br/>    , [Input('dropdown', 'value')])<br/>def update_graph(dropdown_value):<br/>    if dropdown_value == 'Day 1':<br/>        return [{'layout': {'title': 'Graph of Day 1'}<br/>                , 'data': [{'x': [1, 2, 3, 4]<br/>                    , 'y': [4, 1, 2, 1]}]}]<br/>    else:<br/>        return [{'layout': {'title': 'Graph of Day 2'}<br/>                ,'data': [{'x': [1, 2, 3, 4]<br/>                    , 'y': [2, 3, 2, 4]}]}]</span></pre><h2 id="a6bf" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">后退按钮回调</h2><p id="257f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">每个页面都有一个返回按钮，让用户返回到登录屏幕。这些回调更新适当的布局并将用户返回到登录屏幕。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="74e5" class="ox la it ot b gy oy oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_login_success', 'pathname')<br/>    , [Input('back-button', 'n_clicks')])<br/>def logout_dashboard(n_clicks):<br/>    if n_clicks &gt; 0:<br/>        return '/'</span><span id="0f26" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_login_df', 'pathname')<br/>    , [Input('back-button', 'n_clicks')])<br/>def logout_dashboard(n_clicks):<br/>    if n_clicks &gt; 0:<br/>        return '/'</span><span id="68fa" class="ox la it ot b gy qb oz l pa pb"># Create callbacks<br/><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_logout', 'pathname')<br/>    , [Input('back-button', 'n_clicks')])<br/>def logout_dashboard(n_clicks):<br/>    if n_clicks &gt; 0:<br/>        return '/'</span></pre></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="bd1c" class="kz la it bd lb lc pl le lf lg pm li lj jz pn ka ll kc po kd ln kf pp kg lp lq bi translated">显示布局</h1><p id="bda1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在布局已经创建好了，我将设计<strong class="lt iu"> app.layout </strong>来使用一个<strong class="lt iu"> html。Div </strong>，它可以显示相应步骤的适当布局，作为<strong class="lt iu"> html的子元素。Div </strong>。回调用于控制哪个布局作为<strong class="lt iu"> html的子元素返回。ID为<em class="mv">的Div </em></strong>组件页面内容。</p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="a298" class="ox la it ot b gy oy oz l pa pb">app.layout= html.Div([<br/>            html.Div(id='page-content', className='content')<br/>            ,  dcc.Location(id='url', refresh=False)<br/>        ])</span><span id="4a35" class="ox la it ot b gy qb oz l pa pb"><br/><strong class="ot iu"><em class="mv">#callback to determine layout to return</em></strong><br/><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('page-content', 'children')<br/>    , [Input('url', 'pathname')])<br/>def display_page(pathname):<br/>    if pathname == '/':<br/>        return create<br/>    elif pathname == '/login':<br/>        return login<br/>    elif pathname == '/success':<br/>        if current_user.is_authenticated:<br/>            return success<br/>        else:<br/>            return failed<br/>    elif pathname =='/data':<br/>        if current_user.is_authenticated:<br/>            return data<br/>    elif pathname == '/logout':<br/>        if current_user.is_authenticated:<br/>            logout_user()<br/>            return logout<br/>        else:<br/>            return logout<br/>    else:<br/>        return '404'</span></pre><p id="5a77" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">代码现在已经完成了！当把它们放在一起时，从配置代码开始，然后添加布局，最后是回调。下面是高级示例的完整代码。</p></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><h1 id="1065" class="kz la it bd lb lc pl le lf lg pm li lj jz pn ka ll kc po kd ln kf pp kg lp lq bi translated">最终想法和完整的Dash应用程序</h1><p id="03aa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">保护用户数据比以往任何时候都重要，现在您可以使用<a class="ae ky" href="https://dash.plotly.com/authentication" rel="noopener ugc nofollow" target="_blank"> Dash-Auth </a>和<a class="ae ky" href="https://flask-login.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Flask-Login </a>为您的Dash应用程序设置安全性和用户验证。这两种工具各有利弊。Dash-Auth非常适合简单的HTTP基本认证，而Flask-Login提供了控制认证和用户会话的高级特性。</p><h2 id="1894" class="ox la it bd lb pq pr dn lf ps pt dp lj ma pu pv ll me pw px ln mi py pz lp qa bi translated">完全码</h2><p id="eb9c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">编码好所有单独的部分后，是时候展示完整的Dash应用程序了！我决定将配置、布局和回调整理到一个文件中。然而，将布局分割到它们自己的文件中以使事情更有组织性是非常好的。如果你喜欢这个教程，并想学习更多的Dash，看看我的其他Dash教程！</p><p id="f5e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://medium.com/swlh/dashboards-in-python-3-advanced-examples-for-dash-beginners-and-everyone-else-b1daf4e2ec0a" rel="noopener"><strong class="lt iu">Dash初学者的3个高级示例</strong> </a> <strong class="lt iu"> <br/> </strong> <a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/dashboards-in-python-for-beginners-using-dash-live-updates-and-streaming-data-into-a-dashboard-37660c1ba661"> <strong class="lt iu">实时更新并将数据流式传输到仪表板</strong></a><strong class="lt iu"><br/></strong><a class="ae ky" href="https://medium.com/swlh/dashboards-in-python-for-beginners-using-dash-responsive-mobile-dashboards-with-bootstrap-css-2a0d05a53cf6" rel="noopener"><strong class="lt iu">响应式移动仪表板带有引导CSS组件</strong></a><strong class="lt iu"><br/></strong><a class="ae ky" href="https://medium.com/swlh/dashboards-in-python-using-dash-creating-a-data-table-using-data-from-reddit-1d6c0cecb4bd" rel="noopener"><strong class="lt iu">使用来自Reddit的数据创建数据表</strong></a><strong class="lt iu"><br/></strong><a class="ae ky" href="https://medium.com/swlh/dashboards-in-python-for-beginners-using-dash-exporting-data-from-a-dashboard-fe0c5dec3ddb" rel="noopener"><strong class="lt iu">从仪表板导出数据</strong></a></p><pre class="kj kk kl km gt os ot ou ov aw ow bi"><span id="1169" class="ox la it ot b gy oy oz l pa pb">import dash_core_components as dcc<br/>import dash_html_components as html<br/>import dash<br/>from dash.dependencies import Input, Output, State</span><span id="4b0b" class="ox la it ot b gy qb oz l pa pb">from sqlalchemy import Table, create_engine<br/>from sqlalchemy.sql import select<br/>from flask_sqlalchemy import SQLAlchemy</span><span id="fd31" class="ox la it ot b gy qb oz l pa pb">from werkzeug.security import generate_password_hash, check_password_hash</span><span id="ee1f" class="ox la it ot b gy qb oz l pa pb">import sqlite3<br/>import warnings</span><span id="043b" class="ox la it ot b gy qb oz l pa pb">import os<br/>from flask_login import login_user, logout_user, current_user, LoginManager, UserMixin<br/>import configparser</span><span id="7fbc" class="ox la it ot b gy qb oz l pa pb">warnings.filterwarnings("ignore")<br/>conn = sqlite3.connect('data.sqlite')<br/>engine = create_engine('sqlite:///data.sqlite')<br/>db = SQLAlchemy()<br/>config = configparser.ConfigParser()</span><span id="d4fb" class="ox la it ot b gy qb oz l pa pb">class Users(db.Model):<br/>    id = db.Column(db.Integer, primary_key=True)<br/>    username = db.Column(db.String(15), unique=True, nullable = False)<br/>    email = db.Column(db.String(50), unique=True)<br/>    password = db.Column(db.String(80))</span><span id="9fce" class="ox la it ot b gy qb oz l pa pb">Users_tbl = Table('users', Users.metadata)</span><span id="e1e3" class="ox la it ot b gy qb oz l pa pb">app = dash.Dash(__name__)<br/>server = app.server<br/>app.config.suppress_callback_exceptions = True</span><span id="c7f6" class="ox la it ot b gy qb oz l pa pb"># config<br/>server.config.update(<br/>    SECRET_KEY=os.urandom(12),<br/>    SQLALCHEMY_DATABASE_URI='sqlite:///data.sqlite',<br/>    SQLALCHEMY_TRACK_MODIFICATIONS=False<br/>)</span><span id="15bd" class="ox la it ot b gy qb oz l pa pb">db.init_app(server)</span><span id="9681" class="ox la it ot b gy qb oz l pa pb"># Setup the LoginManager for the server<br/>login_manager = LoginManager()<br/>login_manager.init_app(server)<br/>login_manager.login_view = '/login'</span><span id="9868" class="ox la it ot b gy qb oz l pa pb">#User as base<br/># Create User class with UserMixin<br/>class Users(UserMixin, Users):<br/>    pass</span><span id="8a03" class="ox la it ot b gy qb oz l pa pb">create = html.Div([ html.H1('Create User Account')<br/>        , dcc.Location(id='create_user', refresh=True)<br/>        , dcc.Input(id="username"<br/>            , type="text"<br/>            , placeholder="user name"<br/>            , maxLength =15)<br/>        , dcc.Input(id="password"<br/>            , type="password"<br/>            , placeholder="password")<br/>        , dcc.Input(id="email"<br/>            , type="email"<br/>            , placeholder="email"<br/>            , maxLength = 50)<br/>        , html.Button('Create User', id='submit-val', n_clicks=0)<br/>        , html.Div(id='container-button-basic')<br/>    ])#end div</span><span id="bc48" class="ox la it ot b gy qb oz l pa pb">login =  html.Div([dcc.Location(id='url_login', refresh=True)<br/>            , html.H2('''Please log in to continue:''', id='h1')<br/>            , dcc.Input(placeholder='Enter your username',<br/>                    type='text',<br/>                    id='uname-box')<br/>            , dcc.Input(placeholder='Enter your password',<br/>                    type='password',<br/>                    id='pwd-box')<br/>            , html.Button(children='Login',<br/>                    n_clicks=0,<br/>                    type='submit',<br/>                    id='login-button')<br/>            , html.Div(children='', id='output-state')<br/>        ]) #end div</span><span id="227a" class="ox la it ot b gy qb oz l pa pb">success = html.Div([dcc.Location(id='url_login_success', refresh=True)<br/>            , html.Div([html.H2('Login successful.')<br/>                    , html.Br()<br/>                    , html.P('Select a Dataset')<br/>                    , dcc.Link('Data', href = '/data')<br/>                ]) #end div<br/>            , html.Div([html.Br()<br/>                    , html.Button(id='back-button', children='Go back', n_clicks=0)<br/>                ]) #end div<br/>        ]) #end div</span><span id="7a81" class="ox la it ot b gy qb oz l pa pb">data = html.Div([dcc.Dropdown(<br/>                    id='dropdown',<br/>                    options=[{'label': i, 'value': i} for i in ['Day 1', 'Day 2']],<br/>                    value='Day 1')<br/>                , html.Br()<br/>                , html.Div([dcc.Graph(id='graph')])<br/>            ]) #end div</span><span id="477f" class="ox la it ot b gy qb oz l pa pb">failed = html.Div([ dcc.Location(id='url_login_df', refresh=True)<br/>            , html.Div([html.H2('Log in Failed. Please try again.')<br/>                    , html.Br()<br/>                    , html.Div([login])<br/>                    , html.Br()<br/>                    , html.Button(id='back-button', children='Go back', n_clicks=0)<br/>                ]) #end div<br/>        ]) #end div</span><span id="0f25" class="ox la it ot b gy qb oz l pa pb">logout = html.Div([dcc.Location(id='logout', refresh=True)<br/>        , html.Br()<br/>        , html.Div(html.H2('You have been logged out - Please login'))<br/>        , html.Br()<br/>        , html.Div([login])<br/>        , html.Button(id='back-button', children='Go back', n_clicks=0)<br/>    ])#end div</span><span id="348a" class="ox la it ot b gy qb oz l pa pb">app.layout= html.Div([<br/>            html.Div(id='page-content', className='content')<br/>            ,  dcc.Location(id='url', refresh=False)<br/>        ])</span><span id="3e64" class="ox la it ot b gy qb oz l pa pb"># callback to reload the user object<br/><a class="ae ky" href="http://twitter.com/login_manager" rel="noopener ugc nofollow" target="_blank">@login_manager</a>.user_loader<br/>def load_user(user_id):<br/>    return Users.query.get(int(user_id))</span><span id="7e41" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('page-content', 'children')<br/>    , [Input('url', 'pathname')])<br/>def display_page(pathname):<br/>    if pathname == '/':<br/>        return create<br/>    elif pathname == '/login':<br/>        return login<br/>    elif pathname == '/success':<br/>        if current_user.is_authenticated:<br/>            return success<br/>        else:<br/>            return failed<br/>    elif pathname =='/data':<br/>        if current_user.is_authenticated:<br/>            return data<br/>    elif pathname == '/logout':<br/>        if current_user.is_authenticated:<br/>            logout_user()<br/>            return logout<br/>        else:<br/>            return logout<br/>    else:<br/>        return '404'</span><span id="bd5c" class="ox la it ot b gy qb oz l pa pb">#set the callback for the dropdown interactivity<br/><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    [Output('graph', 'figure')]<br/>    , [Input('dropdown', 'value')])<br/>def update_graph(dropdown_value):<br/>    if dropdown_value == 'Day 1':<br/>        return [{'layout': {'title': 'Graph of Day 1'}<br/>                , 'data': [{'x': [1, 2, 3, 4]<br/>                    , 'y': [4, 1, 2, 1]}]}]<br/>    else:<br/>        return [{'layout': {'title': 'Graph of Day 2'}<br/>                ,'data': [{'x': [1, 2, 3, 4]<br/>                    , 'y': [2, 3, 2, 4]}]}]</span><span id="9195" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>   [Output('container-button-basic', "children")]<br/>    , [Input('submit-val', 'n_clicks')]<br/>    , [State('username', 'value'), State('password', 'value'), State('email', 'value')])<br/>def insert_users(n_clicks, un, pw, em):<br/>    hashed_password = generate_password_hash(pw, method='sha256')<br/>    if un is not None and pw is not None and em is not None:<br/>        ins = Users_tbl.insert().values(username=un,  password=hashed_password, email=em,)<br/>        conn = engine.connect()<br/>        conn.execute(ins)<br/>        conn.close()<br/>        return [login]<br/>    else:<br/>        return [html.Div([html.H2('Already have a user account?'), dcc.Link('Click here to Log In', href='/login')])]</span><span id="8983" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_login', 'pathname')<br/>    , [Input('login-button', 'n_clicks')]<br/>    , [State('uname-box', 'value'), State('pwd-box', 'value')])<br/>def successful(n_clicks, input1, input2):<br/>    user = Users.query.filter_by(username=input1).first()<br/>    if user:<br/>        if check_password_hash(user.password, input2):<br/>            login_user(user)<br/>            return '/success'<br/>        else:<br/>            pass<br/>    else:<br/>        pass</span><span id="55f1" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('output-state', 'children')<br/>    , [Input('login-button', 'n_clicks')]<br/>    , [State('uname-box', 'value'), State('pwd-box', 'value')])<br/>def update_output(n_clicks, input1, input2):<br/>    if n_clicks &gt; 0:<br/>        user = Users.query.filter_by(username=input1).first()<br/>        if user:<br/>            if check_password_hash(user.password, input2):<br/>                return ''<br/>            else:<br/>                return 'Incorrect username or password'<br/>        else:<br/>            return 'Incorrect username or password'<br/>    else:<br/>        return ''</span><span id="422d" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_login_success', 'pathname')<br/>    , [Input('back-button', 'n_clicks')])<br/>def logout_dashboard(n_clicks):<br/>    if n_clicks &gt; 0:<br/>        return '/'</span><span id="7198" class="ox la it ot b gy qb oz l pa pb"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_login_df', 'pathname')<br/>    , [Input('back-button', 'n_clicks')])<br/>def logout_dashboard(n_clicks):<br/>    if n_clicks &gt; 0:<br/>        return '/'</span><span id="1084" class="ox la it ot b gy qb oz l pa pb"># Create callbacks<br/><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('url_logout', 'pathname')<br/>    , [Input('back-button', 'n_clicks')])<br/>def logout_dashboard(n_clicks):<br/>    if n_clicks &gt; 0:<br/>        return '/'</span><span id="1c0a" class="ox la it ot b gy qb oz l pa pb">if __name__ == '__main__':<br/>    app.run_server(debug=True)</span></pre><h1 id="4393" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">谢谢大家！</h1><ul class=""><li id="9f8b" class="mz na it lt b lu lv lx ly ma qr me qs mi qt mm ql nf ng nh bi translated"><em class="mv">如果你喜欢我的作品，</em> <a class="ae ky" href="https://medium.com/@erickleppen" rel="noopener"> <em class="mv">在Medium上关注我</em> </a> <em class="mv">了解更多！</em></li><li id="d9b0" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ql nf ng nh bi translated"><a class="ae ky" href="https://erickleppen.medium.com/membership" rel="noopener"> <em class="mv">通过订阅</em> </a>获得对我的内容的完全访问和帮助支持！</li><li id="75c5" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ql nf ng nh bi translated"><em class="mv">我们来连线上</em><a class="ae ky" href="https://www.linkedin.com/in/erickleppen01/" rel="noopener ugc nofollow" target="_blank"><em class="mv">LinkedIn</em></a></li><li id="8488" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ql nf ng nh bi translated"><em class="mv">用Python分析数据？查看我的</em> <a class="ae ky" href="https://pythondashboards.com/" rel="noopener ugc nofollow" target="_blank"> <em class="mv">网站</em> </a>！</li></ul><p id="0c04" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="http://pythondashboards.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> —埃里克·克莱本</strong> </a></p><div class="oa ob gp gr oc od"><a href="https://erickleppen.medium.com/the-ultimate-guide-to-erics-articles-d32df8241353" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">埃里克文章的终极指南</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">我的所有内容按主题组织…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">erickleppen.medium.com</p></div></div><div class="om l"><div class="qu l oo op oq om or ks od"/></div></div></a></div></div></div>    
</body>
</html>