<html>
<head>
<title>Writing a simple blockchain oracle contract, oracle server, and client in under 5 mins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在5分钟内编写一份简单的区块链oracle合同、oracle服务器和客户端</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/writing-a-simple-blockchain-oracle-contract-oracle-server-and-client-in-under-5-mins-7ec8ee33df91?source=collection_archive---------11-----------------------#2022-01-17">https://levelup.gitconnected.com/writing-a-simple-blockchain-oracle-contract-oracle-server-and-client-in-under-5-mins-7ec8ee33df91?source=collection_archive---------11-----------------------#2022-01-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b6c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">建立一个区块链甲骨文网络是很容易的。是的，它是。但是什么是甲骨文网络呢？让我们来分解一下，了解一下甲骨文网络为何如此重要，以及它是如何为区块链网络增添超能力的。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="36c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简而言之，oracle网络是一个基本的web服务器，它允许信息从internet传输到区块链层。但是怎么做呢？让我们来看看这个架构。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/9379bc9742c9553ad0cb82bf6c24a526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsrfZQ-TEqlzukxvBIYQCA.png"/></div></div></figure><ol class=""><li id="070b" class="le lf iq jp b jq jr ju jv jy lg kc lh kg li kk lj lk ll lm bi translated">Oracle客户端是请求的发起者。客户端调用智能协定上的一个函数，该函数发出一个事件。</li><li id="6812" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">Oracle服务器监听事件并通过互联网执行外部定义的请求或操作。</li><li id="b08d" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">然后，Oracle server通过调用合同更新功能将信息传递给Oracle合同来更新信息。</li></ol><p id="8e10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看Oracle契约的代码:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ls"><img src="../Images/dde84b73960979792cb5c1d81a746356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VeZu1zoWH4XM_-_1u60uYw.png"/></div></div></figure><ol class=""><li id="1889" class="le lf iq jp b jq jr ju jv jy lg kc lh kg li kk lj lk ll lm bi translated">客户端调用updateBTCCap()函数，该函数为服务器发出一个internet请求来获取BTCCap。</li><li id="751d" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">一旦服务器完成请求并获得BTC上限，它就调用setBTCCap函数，并以<code class="fe lt lu lv lw b">cap</code>作为参数。</li><li id="b7a1" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">一旦完成，客户端就可以调用getBTCCap函数来获取由服务器更新的最新BTCCap。</li></ol><p id="3204" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的部分服务器代码:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lx"><img src="../Images/49dfbb1b07a11d93a2074dbce701130c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBoSUtODlKFIuhHD1nMOIw.png"/></div></div></figure><ol class=""><li id="241a" class="le lf iq jp b jq jr ju jv jy lg kc lh kg li kk lj lk ll lm bi translated">oracle契约有两个实例。一个是基于Websocket的连接<code class="fe lt lu lv lw b">oracleContractWss</code>，另一个是带有HTTPS提供者<code class="fe lt lu lv lw b">oracleInstance</code>的简单实例。</li><li id="92de" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">web socket实例可以监听事件，我们从最新的块中获取事件。这意味着它将只考虑即将发生的事件。如果指定任何旧块，将获取从该块开始的事件。</li><li id="f31f" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">根据来自事件的数据，我们请求一个API来获取BTC Cap。并使用契约的HTTPS实例调用<code class="fe lt lu lv lw b">setBTCCap</code>函数。</li></ol><p id="9c27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该项目的完整源代码在下面的Github库中。</p><div class="ly lz gp gr ma mb"><a href="https://github.com/adityak74/blockchain-eth-simple-oracle" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd ir gy z fp mg fr fs mh fu fw ip bi translated">GitHub-adityak 74/区块链-eth-simple-oracle:一个简单的基于以太坊的oracle网络，合同…</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp lc mb"/></div></div></a></div><p id="797e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关注我，了解更多区块链内容。如果这些内容对你有帮助👏 👏</p></div></div>    
</body>
</html>