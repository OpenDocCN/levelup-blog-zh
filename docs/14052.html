<html>
<head>
<title>Dynamic Angular Microfrontends</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动态角度微前端</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/dynamic-angular-microfrontends-7de8f2634f0a?source=collection_archive---------2-----------------------#2022-10-28">https://levelup.gitconnected.com/dynamic-angular-microfrontends-7de8f2634f0a?source=collection_archive---------2-----------------------#2022-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5bd6b1ac696a04398321e80ebed42a56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6UK-jZlcJX64sUkducPQLA.png"/></div></div></figure><h1 id="71c3" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">在我的博客上阅读这个故事:</h1><div class="kw kx gp gr ky kz"><a href="https://ng-journal.com/blog/2022-11-06-dynamic-angular-microfrontends/" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">动态角度微前端</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">微前端背后的关键思想是在运行时延迟加载代码，这样Angular编译器就不需要…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">ng-journal.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><h1 id="6d08" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="caba" class="pw-post-body-paragraph lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">微前端背后的关键思想是在运行时延迟加载代码，这样Angular编译器不需要知道运行时延迟加载的功能模块。当多个团队在一个项目上工作，并且独立的部署对于生产力是必要的时候，这是特别有用的。</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="4bb6" class="mv jz iq mr b gy mw mx l my mz">await import('http://localhost:4200').then(m =&gt; m.ROUTES)</span></pre><p id="d9ec" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">尽管这是一个关键的想法，但这并不像开箱即用那样有效，因为Angular不能在编译时解决依赖性。Webpack可以用来做一些不可思议的事情，例如在模块联合插件的帮助下，惰性加载可以工作。</p><p id="e33e" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">如果你不熟悉基本概念，我建议你先看看这篇文章:</p><div class="kw kx gp gr ky kz"><a rel="noopener  ugc nofollow" target="_blank" href="/your-first-angular-microfrontend-58950768a465"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">你的第一个角形微前端</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">这是关于如何创建一个简单的angular应用程序来使用另一个应用程序的模块的分步指南…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="li l"><div class="nf l lk ll lm li ln jw kz"/></div></div></a></div><p id="49ba" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">在下一部分中，我将假设您已经知道如何使用模块联邦来静态延迟加载带有硬编码URL的微前端。显然，使用硬编码的URL并不好，因为我们可能希望实现一些逻辑，根据用户权限或者只是部署阶段(dev、staging、prod)来决定应该加载哪些微前端。</p><h1 id="4835" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">辅导的</h1><p id="2ca3" class="pw-post-body-paragraph lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">我创建了一个包含两个<strong class="lq ir">远程</strong> (remote1，remote2)和一个<strong class="lq ir">外壳</strong>的monorepository。remote1和remote2都在webpack配置中公开了一个路由配置，这样路由配置就可以被shell延迟加载。外壳只包含一个用于显示遥控器的router-outlet，还包含一个navbar，每个遥控器都有一个router-link。这基本上是演示所需的所有代码。棘手的部分是基于清单文件的动态路由。</p><p id="491e" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">清单文件至少应该实现来自<a class="ae ng" href="https://www.npmjs.com/package/@angular-architects/module-federation" rel="noopener ugc nofollow" target="_blank">@ angular-architects/module-Federation</a>包的RemoteConfig，并且可以扩展您的应用程序所需的更多自定义属性。例如，我的清单对其进行了如下扩展:</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f231" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">这个清单文件应该存储在assets文件夹中，然后我们可以确保在引导时远程是可加载的。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="7128" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">现在，路由是主要问题，因为我们不能只编码静态路由配置。相反，我们可以使用来自angular-router的低级依赖注入令牌，这样我们就可以使用<strong class="lq ir"> useFactory </strong>属性。重要的是提供一个空的路由配置，然后我们可以访问<strong class="lq ir">路由</strong>注入令牌。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="6bc3" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated"><strong class="lq ir"> createRoutes </strong>函数是一个基于清单文件返回Routes对象的实用函数。基本上，清单被迭代并使用清单的值映射到路由配置。为了加载清单，可以使用<strong class="lq ir"> getManifest </strong>函数。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="a061" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">差不多就是这样了。剩下的唯一一件事就是动态地添加路由器链接到导航栏。该组件还使用getManifest函数，在模板中，我们可以简单地迭代ngFor中的条目。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h2 id="dc32" class="mv jz iq bd ka nj nk dn ke nl nm dp ki lz nn no km md np nq kq mh nr ns ku nt bi translated">结果是:</h2><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/3eaa67fe728b6cfdea4eeb45acab81f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HyYacsrxSGVDLvhmjAD4yQ.png"/></div></div><figcaption class="nv nw gj gh gi nx ny bd b be z dk translated"><strong class="bd ka">遥控器2 </strong>，端口4202</figcaption></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/f18b4c962927ffbe9e3be836ad6a0ca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9cqGWBGg7grtSju_qIQS2w.png"/></div></div><figcaption class="nv nw gj gh gi nx ny bd b be z dk translated"><strong class="bd ka">外壳</strong>，端口4200</figcaption></figure><h1 id="1e5c" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">解决</h1><p id="bf72" class="pw-post-body-paragraph lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">这种动态方法可以用于多种有趣的情况。代码是静态的，但是逻辑包含在清单文件中，因此CI/CD管道可以根据阶段交换文件。否则，根据登录用户的权限，清单可以完全从后端加载。或者它可以用于A/B测试</p><ul class=""><li id="a831" class="oa ob iq lq b lr na lv nb lz oc md od mh oe ml of og oh oi bi translated"><strong class="lq ir">部署阶段</strong></li><li id="9eb9" class="oa ob iq lq b lr oj lv ok lz ol md om mh on ml of og oh oi bi translated"><strong class="lq ir"> A/B测试</strong></li><li id="4c25" class="oa ob iq lq b lr oj lv ok lz ol md om mh on ml of og oh oi bi translated"><strong class="lq ir">仪表盘</strong></li><li id="c627" class="oa ob iq lq b lr oj lv ok lz ol md om mh on ml of og oh oi bi translated"><strong class="lq ir">基于权限的条件渲染</strong></li><li id="c6a7" class="oa ob iq lq b lr oj lv ok lz ol md om mh on ml of og oh oi bi translated"><strong class="lq ir">插件架构</strong></li></ul><p id="f0f2" class="pw-post-body-paragraph lo lp iq lq b lr na lt lu lv nb lx ly lz nc mb mc md nd mf mg mh ne mj mk ml ij bi translated">总之，这种动态加载使公司能够为他们的微前端架构提供更多的控制和可伸缩性。</p><h2 id="1491" class="mv jz iq bd ka nj nk dn ke nl nm dp ki lz nn no km md np nq kq mh nr ns ku nt bi translated">GitHub回购</h2><div class="kw kx gp gr ky kz"><a href="https://github.com/HaasStefan/dynamic-module-federation" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">GitHub-HaasStefan/动态模块联盟</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">github.com</p></div></div><div class="li l"><div class="oo l lk ll lm li ln jw kz"/></div></div></a></div><h2 id="ce24" class="mv jz iq bd ka nj nk dn ke nl nm dp ki lz nn no km md np nq kq mh nr ns ku nt bi translated">加入介质</h2><div class="kw kx gp gr ky kz"><a href="https://medium.com/@stefan.haas.privat/membership" rel="noopener follow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">通过我的推荐链接-斯特凡·哈斯加入媒体</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">阅读斯特凡·哈斯的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">medium.com</p></div></div><div class="li l"><div class="op l lk ll lm li ln jw kz"/></div></div></a></div><h2 id="e807" class="mv jz iq bd ka nj nk dn ke nl nm dp ki lz nn no km md np nq kq mh nr ns ku nt bi translated">阅读更多</h2><div class="kw kx gp gr ky kz"><a rel="noopener  ugc nofollow" target="_blank" href="/breaking-the-frontend-monoltih-b1837f8ed2e5"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">打破前端巨石</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">在本文中，您将了解将典型的前端整体迁移到…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="li l"><div class="oq l lk ll lm li ln jw kz"/></div></div></a></div><div class="kw kx gp gr ky kz"><a rel="noopener  ugc nofollow" target="_blank" href="/moduliths-in-angular-with-nx-b8b0076794fb"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">以Nx为单位的角度模数</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">使用DDD和Monorepos创建可持续应用</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="li l"><div class="or l lk ll lm li ln jw kz"/></div></div></a></div><div class="kw kx gp gr ky kz"><a rel="noopener  ugc nofollow" target="_blank" href="/secure-frontend-authorization-67ae11953723"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">停止在前端进行令牌认证</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">为单页应用程序构建安全认证过程的现代方法。</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="li l"><div class="os l lk ll lm li ln jw kz"/></div></div></a></div></div></div>    
</body>
</html>