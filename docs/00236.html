<html>
<head>
<title>IBM Cloud Kubernetes Service; Deployment Patterns for Maximizing Throughput and Availability</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IBM Cloud Kubernetes服务；最大化吞吐量和可用性的部署模式</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ibm-cloud-kubernetes-service-deployment-patterns-for-maximizing-throughput-and-availability-88a23a99437f?source=collection_archive---------1-----------------------#2018-10-16">https://levelup.gitconnected.com/ibm-cloud-kubernetes-service-deployment-patterns-for-maximizing-throughput-and-availability-88a23a99437f?source=collection_archive---------1-----------------------#2018-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="08c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我应该如何使用负载平衡器服务和ALB在集群中部署我的应用程序？什么时候应该使用负载平衡器，什么时候应该使用ALB？<br/>如何有效利用我的能力？</p><p id="4b39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着即将在<a class="ae kl" href="https://www.ibm.com/cloud/container-service" rel="noopener ugc nofollow" target="_blank">IBM Cloud Kubernetes Service</a>上发布的Kubernetes 1.12版本，我们将发布新的IKS负载平衡器2.0公测版，以便客户进行测试。本文讨论了这个负载平衡器服务的功能以及围绕它的一些部署模式，并提供了一些示例。</p><p id="6a2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">你也可以在IBM博客上阅读</em> <a class="ae kl" href="https://www.ibm.com/blogs/bluemix/2018/10/ibm-cloud-kubernetes-service-deployment-patterns-for-maximizing-throughput-and-availability/" rel="noopener ugc nofollow" target="_blank"> <em class="km">原文。</em>T9】</a></p><h1 id="b7ae" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">效率和可用性</h1><p id="62d5" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">在IBM，您可以从效率和可用性两方面最大限度地利用您在IKS集群中的投资，这对我们来说非常重要。根据应用程序的需求，有多种方法可以部署IKS集群和其中的应用程序。在本文中，我们将介绍一些部署模式，并包含一些示例，以便您可以选择最接近您需求的模式，并进一步完善它们。</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="f0aa" class="kn ko iq bd kp kq lx ks kt ku ly kw kx ky lz la lb lc ma le lf lg mb li lj lk bi translated">负载平衡类型</h1><p id="1cfc" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">在我们进入部署模式之前，让我们快速浏览一些不同的负载平衡类型，因为我将在后面提到这些概念。如果您熟悉DNS RR、ALB、NLB和DSR概念，可以跳过这一步。</p><h2 id="b45d" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">基于DNS的负载平衡(循环)</h2><p id="5062" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">DNS循环法是在IP地址各不相同的服务器之间分配流量的最简单方法之一。通过为同一个主机名注册多个A(或AAAA)记录，DNS解析器将返回所有记录—通常是每个查询的置换列表。客户端通常连接到列表中的第一个。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mo"><img src="../Images/1a51cada1e6c7f139c8c10e271411aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MVSt2fjt8iNpGjXe31WpVw.png"/></div></div></figure><p id="15aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种技术有很多限制和缺点，我不会在本文中讨论。它完全依赖于客户端实现的事实既是优点也是缺点。<em class="km">(注意:有一些DNS提供商实现了一些功能来减少一些缺点，这是值得研究的。)</em></p><h2 id="bbc4" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">应用负载平衡(ALB)</h2><p id="332b" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">ALB概念通常是一种类似代理的操作，其中客户端连接到后端服务，并且必须通过反向代理，反向代理了解协议、应用程序并能够基于内容做出明智的决策。对于微服务之间的通信，我们一般使用HTTP因此，中的HTTP反向代理可以方便地根据HTTP位置、头、cookies、参数等做出决策。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi na"><img src="../Images/004cbc1e8438b7988942abbecb59ea8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_7rmDZnKscIYDzCuZVBiw.png"/></div></div></figure><p id="da45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">客户端打开到ALB的TCP连接，ALB打开到后端的另一个TCP连接，并根据负载平衡策略、调度程序和设置，在可用后端之间路由请求。请注意，DNS响应中只有一个IP地址ALB处理来自客户端的所有传入请求。</p><h2 id="2707" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">网络负载平衡(NLB)</h2><p id="8744" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">NLB概念通常用于第4层(OSI层)的水平扩展。这通常意味着TCP和UDP应用程序可以存在于多个服务器(物理或虚拟)上，并且仍然共享同一个IP地址。NLB通常不会终止TCP连接它只是作为一个“转发器”的数据包，而坐在中间。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi na"><img src="../Images/d9a089112e6fc8ebf18de04a624b6fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OkMdAsQ1wCwv_wtq2VPd3A.png"/></div></div></figure><p id="f3df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过NLB，我们还可以启用直接服务器返回(DSR)概念，这意味着NLB不在数据包的返回路径中。后端服务器看到客户端的原始源IP地址和端口，并直接响应，而不经过NLB。实际上是后端服务器终止TCP连接，并将NLB (MUX)的源IP直接返回给客户端。对一些人来说，这听起来像是巫术，但从根本上来说，这很简单。下图解释了这个概念(跟随来自客户端的数据包):</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nb"><img src="../Images/29b276bc0ebf5ee678f879b460e8a482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ATuEi0Mzr0CZhq2tr17UbQ.png"/></div></div></figure><p id="8783" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">NLB (MUX)将数据包封装成IPIP隧道数据包，并将原始数据包发送到后端服务器。后端服务器将其解封装，并以公共IP作为源直接响应客户端IP(在我的例子中是169.61.23.130)。</p><p id="c426" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这使我们能够在无法在报头中传递的协议(如HTTP can)上保留原始客户端IP，并在相同的IP地址后进行水平扩展。典型的例子是二进制协议，如MQTT、RTMP、MySQL、PostgreSQL等，但并不仅限于此。</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="ff3b" class="kn ko iq bd kp kq lx ks kt ku ly kw kx ky lz la lb lc ma le lf lg mb li lj lk bi translated">IKS集群部署模式</h1><p id="48ea" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">部署IKS集群有多种方式，没有灵丹妙药。你必须了解以下因素:</p><ul class=""><li id="5fff" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">您正在运行的应用程序的要求(包括规模)；</li><li id="11fa" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">SLA目标；</li><li id="9e49" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">预算。</li></ul><p id="ede8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有这些都会影响你最终选择的模式。</p><p id="1ea8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Zone </strong> =一个大都市区域中的故障域，如数据中心(例如，德克萨斯州达拉斯:DAL10)。<br/> <strong class="jp ir">区域</strong> =同一大都市区内多个区域的组合。例如，德克萨斯州达拉斯:美国南部可视为DAL10、DAL12和DAL3的组合，它们分别是独立的数据中心/故障域。</p><h2 id="d750" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">单区集群</h2><p id="e05c" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">最简单的模式是在一个区域内的单个区域中部署IKS集群。<a class="ae kl" href="https://medium.com/@ArpadKun/iks-deployment-patterns-1-single-zone-cluster-app-exposed-via-loadbalancer-nlb-and-alb-6370560307e4" rel="noopener">部署单区域集群模式的分步示例</a>。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nq"><img src="../Images/8f50b3405055bd4687438c79457453fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yrc2jmYATT1lZNUa5vqJUg.png"/></div></div></figure><p id="af51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一个A记录与我的ALB的主机名称相关联，它是通过负载平衡器服务(NLB)公开的。在单区域群集设置中，默认情况下，IKS不会为ALBs配置运行状况检查。</p><p id="3a07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个视图中，您可以看到一个通过IKS ALB公开的HTTP(S)应用程序和一个二进制协议(MQTT)应用程序，后者也通过负载均衡器服务直接公开。请注意DSR操作ALB和MQTT应用程序都直接返回给客户端。</p><h2 id="1498" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">多区域群集—仅限ALB</h2><p id="53f0" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">在此模式中，可以观察多区域IKS群集和ALB的默认行为。在我的示例中，我运行在美国南部的三个区域(DAL10、DAL12和DAL13)。<a class="ae kl" href="https://medium.com/@ArpadKun/iks-deployment-patterns-2-multi-zone-cluster-app-exposed-via-alb-ingress-controller-415908418abd" rel="noopener">逐步示例部署多区域，ALB仅使用模式</a>。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nq"><img src="../Images/2e0d37ad4b2d4636bdbcc85fe8a4182f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jBcmoofF8tmFZInXWsJDQ.png"/></div></div></figure><p id="9c7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有三个A记录与我的ALB的主机名称相关联，它是通过一个负载均衡器服务公开的(因此，流量是通过NLB流动的)。每个区域都为ALBs配置了<strong class="jp ir">运行状况检查</strong>。如果出现区域故障，ALB的IP地址将在大约60秒内从DNS响应中自动删除。</p><p id="b618" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意ALB的DSR行为。</p><p id="0f8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，在ALBs之后，后端pod将被同等对待，无论它们是在本地区域还是在远程区域运行。通过这种方式，该区域的计算能力被合并。</p><p id="c715" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果发生区域故障，有两个位置的一些请求将丢失:</p><ol class=""><li id="1d46" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nr ni nj nk bi translated">通过运行状况检查，本地ALBs将在约60秒内从DNS中删除。其他(仍在运行的)区域中的其余ALBs将尝试连接到已配置的终结点。连接到关闭的IP的客户端将经历TCP超时，并重新连接到列表中的后续IP(特定于客户端实现)。</li><li id="f2a7" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nr ni nj nk bi translated">一旦故障区域中的工作节点变为“未就绪”，将在40秒内从仍在运行的ALB配置中删除终结点。在这40秒内，健康区域中的ALBs仍将尝试向失败区域的端点发送请求，但一旦它们遇到失败(例如端点没有响应，这将导致502响应)，它将在10秒内阻止向同一端点发送另一个请求。根据您在失败区域中有多少个端点，以及您正在运行多少个ALB pods，会有不同数量的请求失败。根据经验，可以使用以下计算方法:[失败区域中的终结点数量]*[ALB pod的数量] * 4。</li></ol><h2 id="0f52" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">多区域集群——NLB</h2><p id="1698" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">通过NLB公开应用程序有两种主要方式:</p><ul class=""><li id="bb54" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">将NLB向其发送请求的应用程序的目标终结点保留在同一区域内。</li><li id="80cf" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">通过允许NLBs将流量分配给区域内的所有区域，合计整个区域的容量。</li></ul><p id="8574" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们仔细看看每一个。</p><p id="fa1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">保持区域内的本地流量— </strong> <a class="ae kl" href="https://medium.com/@ArpadKun/iks-deployment-patterns-3-multi-zone-cluster-app-exposed-via-loadbalancer-using-in-zone-34bd2c43db79" rel="noopener">部署多区域、仅本地端点模式的分步示例</a>。<strong class="jp ir"> <br/> </strong>有三个A记录与每个区域中的每个负载平衡器服务相关联。NLB的传入流量仅发送到区域内的本地端点，返回流量通过IKS工作节点的本地默认网关离开。这不是默认行为。为了实现这一点，您必须使用节点选择器和注释来准备您的应用程序部署。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nq"><img src="../Images/10a0d63d334e55cddb053698f31ff107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rcm3EX44fkgos8TnLTPsCQ.png"/></div></div></figure><p id="9538" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">聚集区域(所有区域)的容量<br/> </strong>有三个A记录与每个区域中的每个负载平衡器服务相关联。到NLB的传入流量通过群集中的所有服务端点发送，无论这些端点是位于同一区域还是该区域内的另一个区域。<a class="ae kl" href="https://medium.com/@ArpadKun/iks-deployment-patterns-4-multi-zone-cluster-app-exposed-via-loadbalancer-aggregating-whole-ffc8613e0787" rel="noopener">部署聚合区域容量模式的逐步示例</a>。</p><p id="10b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">重要提示:</strong>不幸的是，这需要手动操作。你必须<a class="ae kl" href="https://control.bluemix.net/support/unifiedConsole/tickets/add" rel="noopener ugc nofollow" target="_blank">在门户</a> ( <em class="km">技术&gt;基础设施&gt;公网提问)</em>上开一张票，并在请求中添加以下内容:</p><blockquote class="ns nt nu"><p id="c934" class="jn jo km jp b jq jr js jt ju jv jw jx nv jz ka kb nw kd ke kf nx kh ki kj kk ij bi translated">“请将网络设置为允许与我的帐户相关联的公共VLANs上的容量聚合。{如果您列出您的公共VLANs就更好了。}这个请求的参考票是:<a class="ae kl" href="https://control.softlayer.com/support/tickets/63859145" rel="noopener ugc nofollow" target="_blank">https://control.softlayer.com/support/tickets/63859145</a>”</p></blockquote><p id="4330" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果在您的帐户下创建了新的VLAN，您必须重复此操作(就像在以前没有VLAN的不同地区订购新的IKS集群)。我们完全理解这是一个次优的用户体验，并努力尽快改善它。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nq"><img src="../Images/212c522b1c68ce0a053e9d9572fbb2df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cntX6LsdFX86wEDJZ1xCaA.png"/></div></div></figure><p id="d554" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这对于聚合返回路径上的可用传出带宽(每个工作节点)来说非常强大。此外，这也是一个很好的技术来聚合整个地区的计算能力。例如，如果您运行一些CPU密集型任务，导致单个工作节点非常繁忙，并且您希望横向扩展到同一IP地址后面的多个工作节点。比如运行复杂的Lua代码，或者通过重新渲染剪辑来颠倒简短的猫视频。</p><h2 id="e553" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">在一个区域部署多个单区域</h2><p id="eb8f" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">如果您希望每个区域运行一个IKS集群，从而在一个区域中运行多个集群，这也是一个完全有效的部署模式。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nq"><img src="../Images/7910fe17e92410ac1374119b06b60ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bvepKhLXNZvuq-nh7ZV_wg.png"/></div></div></figure><p id="9b78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此模式中，您可以看到有两个分区(DAL10和DAL12)，每个分区都有一个单分区IKS群集。使用此设置，您将失去IKS提供的自动运行状况检查和跨区域DNS故障转移等功能。此外，ALB主机名将会不同，并且由IKS自动生成的SSL证书不会跨集群分发，它们将成为自己的小型容错域。</p><p id="bc7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，通过IaaS仪表板上的CIS(云互联网服务),您可以构建自己的运行状况检查，并使用GLB功能来配置与IKS多区域集群自动提供的行为非常相似的行为。CIS由Cloudflare提供支持，支持权威DNS服务器、全球和本地负载平衡、web应用防火墙(WAF)、DDoS保护、缓存和页面规则等服务。您可以<a class="ae kl" href="https://console.bluemix.net/catalog/services/internet-services" rel="noopener ugc nofollow" target="_blank">通过此链接</a>订购配置项。有关CIS的更多<a class="ae kl" href="https://console.bluemix.net/docs/infrastructure/cis/getting-started.html#getting-started-with-ibm-cloud-internet-services-cis-" rel="noopener ugc nofollow" target="_blank">文档，请参见本页</a>。</p><h1 id="8844" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">全球视野— GLB已启用</h1><p id="4baa" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">将应用程序部署到全球多个IKS集群后，您可以使用CIS来实现全局负载平衡，并实现以下目标:</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ny"><img src="../Images/a36c57901ef089f41d653807c71f4329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Yp23iMJFWU4EalkWR5VsQ.png"/></div></div></figure><p id="58d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本例中，理论上的网站<code class="fe nz oa ob oc b"><a class="ae kl" href="http://www.arpadkun.com" rel="noopener ugc nofollow" target="_blank">www.arpadkun.com</a></code>被CNAME到ALB的主机名，它已经为所有三个区域启用了运行状况检查。</p><p id="f152" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过GLB，可以设置将来自欧洲的最终用户发送到当地的EU-德IKS集群，而来自北美的最终用户将被定向到美国南部地区的IKS集群。当您使用仅DNS模式(将您的终端用户直接发送到IKS群集)或使用代理模式(通过Cloudflare代理流量)时，这适用于两种使用情形。</p><h1 id="28be" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">摘要</h1><p id="34e9" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">随着您对工作负载的了解越来越多，您可以根据需要调整甚至切换模式。不同的应用需要不同的模式；请让我们帮助你的模式！</p><h1 id="250d" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">联系我们</h1><p id="76d1" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">如果您有任何问题，请通过Slack加入我们的团队，在这里注册<a class="ae kl" href="https://bxcs-slack-invite.mybluemix.net/" rel="noopener ugc nofollow" target="_blank">，并在我们的公共IBM Cloud Kubernetes服务Slack上的#general channel </a>中加入讨论。</p><p id="5490" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多有用的文章:<br/>-<a class="ae kl" href="https://medium.com/@ArpadKun/ibm-cloud-kubernetes-service-ingress-alb-cheat-sheet-1-basics-4fbc1c86b886" rel="noopener">IKS入口/ALB备忘单</a>上的有用命令。<br/> - <a class="ae kl" href="https://medium.com/@ArpadKun/iks-alb-ingress-controller-timeouts-dropped-websocket-connections-ibm-iks-cheat-sheet-3-f82da6a8aeec" rel="noopener"> IKS ALB/Ingress控制器超时，Websocket连接掉线</a> <br/> - <a class="ae kl" href="https://medium.com/@ArpadKun/how-can-i-isolate-do-maintenance-and-debug-an-alb-ingress-controller-ibm-iks-cheat-sheet-2-29dab86b9c7d" rel="noopener">如何隔离、维护和调试ALB/Ingress控制器</a></p></div></div>    
</body>
</html>