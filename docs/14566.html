<html>
<head>
<title>Benefits Of Angular Universal + Installation Guide And How To Avoid Common Pitfalls</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular Universal +安装指南的优点以及如何避免常见缺陷</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/all-the-benefits-angular-universal-offers-installation-and-common-pitfalls-angular-universal-46b11887250a?source=collection_archive---------5-----------------------#2022-12-08">https://levelup.gitconnected.com/all-the-benefits-angular-universal-offers-installation-and-common-pitfalls-angular-universal-46b11887250a?source=collection_archive---------5-----------------------#2022-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="38c9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Angular Universal是一种允许开发人员在服务器上运行Angular应用程序的技术，支持服务器端渲染和改进的性能、SEO、安全性和服务器端功能。</h2></div><h2 id="a947" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">什么是角通用</strong></h2><p id="4f6c" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">Angular Universal是一个工具，它允许Angular开发人员对他们的应用程序进行服务器渲染，从而提高性能并提供更好的用户体验。服务器端呈现包括在服务器上呈现应用程序的初始视图，而不是在浏览器中。这可以提供几个好处，包括提高性能、更好的搜索引擎优化和更流畅的用户体验，尤其是在较慢的设备或低质量的网络上。</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lu"><img src="../Images/9258a87bb77584e5a2736a5ff2971b4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WmEbZvs_10-Awd71"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">斯蒂芬·菲利普斯-Hostreviews.co.uk在<a class="ae mk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片<a class="ae mk" href="https://unsplash.com/@hostreviews?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="a095" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">Angular Universal使Angular开发人员可以轻松地将服务器端渲染添加到他们的应用程序中。它提供了一组API和模块，可用于在服务器上呈现Angular应用程序，并自动处理服务器端呈现的细节，如处理请求、呈现视图以及在服务器和客户端之间传输状态。</p><p id="658f" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">总的来说，Angular Universal对于希望提高应用程序性能和用户体验的Angular开发者来说是一个有用而强大的工具。通过使用Angular Universal添加服务器端渲染，开发人员可以创建更快、更高效、更具吸引力的应用程序，从而提供更好的用户体验。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="0d1d" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Angular Universal提供哪些好处？</h2><p id="179a" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">Angular Universal提供了几个好处，包括:</p><ol class=""><li id="30af" class="mx my iq ld b le ml lh mm ko mz ks na kw nb lt nc nd ne nf bi translated">改进的性能和用户体验:服务器端渲染允许您的应用程序在服务器上渲染初始视图，这可以改善初始加载时间，并提供更好的用户体验。</li><li id="6af7" class="mx my iq ld b le ng lh nh ko ni ks nj kw nk lt nc nd ne nf bi translated">改进的SEO:服务器端渲染允许搜索引擎索引你的应用程序的内容，这可以提高你的应用程序在搜索结果中的可见性。</li><li id="47c6" class="mx my iq ld b le ng lh nh ko ni ks nj kw nk lt nc nd ne nf bi translated">增强的安全性:服务器端呈现通过在将用户生成的内容发送到客户端之前在服务器上呈现这些内容，有助于抵御某些类型的攻击，如跨站点脚本(XSS)。</li><li id="26e9" class="mx my iq ld b le ng lh nh ko ni ks nj kw nk lt nc nd ne nf bi translated">改进的服务器端功能:Angular Universal允许您在服务器上使用Angular应用程序，这为服务器端处理和渲染开辟了新的可能性。</li><li id="de7b" class="mx my iq ld b le ng lh nh ko ni ks nj kw nk lt nc nd ne nf bi translated">改进的代码共享和可移植性:Angular Universal允许您在服务器和客户端之间共享应用程序的代码，这可以提高代码的可维护性和可移植性。</li></ol></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="5010" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">如何安装Angular Universal？</h2><ol class=""><li id="44d6" class="mx my iq ld b le lf lh li ko nl ks nm kw nn lt nc nd ne nf bi translated">要安装Angular Universal，您应该在系统上安装最新版本的Angular和Angular CLI。您可以通过运行以下命令来检查您的当前版本:</li></ol><pre class="lv lw lx ly gt no np nq bn nr ns bi"><span id="6305" class="nt kg iq np b be nu nv l nw nx">ng --version</span></pre><p id="72ec" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">2.如果您没有最新版本，可以通过运行以下命令来更新Angular和Angular CLI:</p><pre class="lv lw lx ly gt no np nq bn nr ns bi"><span id="8c1b" class="nt kg iq np b be nu nv l nw nx">npm install -g @angular/cli@latest<br/>npm install -g @angular/core@latest</span></pre><p id="0fb6" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">3.一旦安装了Angular和Angular CLI的最新版本，就可以安装Angular Universal了。为此，您需要使用Angular CLI创建一个新的服务器端应用程序。这可以通过运行以下命令来完成:</p><pre class="lv lw lx ly gt no np nq bn nr ns bi"><span id="2deb" class="nt kg iq np b be nu nv l nw nx">ng generate universal &lt;app-name&gt;</span></pre><p id="6e7d" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">4.将<code class="fe ny nz oa np b">&lt;app-name&gt;</code>替换为您的角度应用的名称。该命令将基于您现有的Angular应用程序创建一个新的服务器端应用程序，并将自动配置和安装Angular Universal的必要依赖项。</p><p id="f720" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">5.创建服务器端应用程序后，您需要更新现有的Angular应用程序，以使用Angular Universal提供的服务器端渲染。为此，您需要更新您的Angular应用程序的<code class="fe ny nz oa np b">AppModule</code>,以便从<code class="fe ny nz oa np b">@angular/platform-server</code>包中导入<code class="fe ny nz oa np b">ServerModule</code>和<code class="fe ny nz oa np b">ServerTransferStateModule</code>。</p><p id="f259" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">以下是为Angular Universal添加必要的导入后，您的<code class="fe ny nz oa np b">AppModule</code>应该是什么样子的示例:</p><pre class="lv lw lx ly gt no np nq bn nr ns bi"><span id="1bb2" class="nt kg iq np b be nu nv l nw nx">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>import { ServerModule } from '@angular/platform-server';<br/>import { ServerTransferStateModule } from '@angular/platform-server';<br/><br/>import { AppComponent } from './app.component';<br/><br/>@NgModule({<br/>  declarations: [<br/>    AppComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule.withServerTransition({ appId: '&lt;app-id&gt;' }),<br/>    ServerModule,<br/>    ServerTransferStateModule<br/>  ],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule</span></pre></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="4858" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">我如何检查angular是否在服务器上而不是在客户端上渲染我的应用程序？</h2><p id="b983" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">要检查Angular是否在服务器而不是客户端上渲染你的应用，你可以使用<code class="fe ny nz oa np b">@angular/common</code>包提供的<code class="fe ny nz oa np b">isPlatformServer</code>函数。此函数返回一个布尔值，表明您的应用程序是在服务器上运行还是在客户端上运行。</p><p id="d97d" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">以下是如何使用<code class="fe ny nz oa np b">isPlatformServer</code>功能检查您的应用程序是否正在服务器上运行的示例:</p><pre class="lv lw lx ly gt no np nq bn nr ns bi"><span id="cd21" class="nt kg iq np b be nu nv l nw nx">import { Component, Inject, PLATFORM_ID } from '@angular/core';<br/>import { isPlatformServer } from '@angular/common';<br/><br/>@Component({<br/>  selector: 'app-root',<br/>  templateUrl: './app.component.html',<br/>  styleUrls: ['./app.component.css']<br/>})<br/>export class AppComponent {<br/>  constructor(@Inject(PLATFORM_ID) private platformId: Object) {<br/>    if (isPlatformServer(this.platformId)) {<br/>      console.log('App is running on the server');<br/>    } else {<br/>      console.log('App is running on the client');<br/>    }<br/>  }<br/>}</span></pre><p id="3054" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">在这个例子中，<code class="fe ny nz oa np b">AppComponent</code>类注入了<code class="fe ny nz oa np b">PLATFORM_ID</code>令牌，并使用它来检查应用程序是运行在服务器上还是客户端上。如果应用程序正在服务器上运行，控制台会记录一条消息来表明这一点。否则，会记录一条不同的消息，指示该应用程序正在客户端上运行。</p><p id="e989" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">通过使用<code class="fe ny nz oa np b">isPlatformServer</code>功能，您可以检查您的Angular应用程序是否在服务器上而不是在客户端上进行渲染，并且您可以根据这些信息采取适当的措施。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="6899" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">安装angular universal有哪些常见的错误？</h2><p id="6335" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">安装Angular Universal时的一些常见错误包括:</p><ol class=""><li id="d39f" class="mx my iq ld b le ml lh mm ko mz ks na kw nb lt nc nd ne nf bi translated">未使用最新版本的Angular and Angular CLI:Angular Universal需要最新版本的Angular and Angular CLI才能正常工作。如果您使用的不是最新版本，在安装或使用Angular Universal时可能会遇到问题。</li><li id="65b1" class="mx my iq ld b le ng lh nh ko ni ks nj kw nk lt nc nd ne nf bi translated">没有正确配置你的应用程序:Angular Universal使用一个基于你现有Angular应用程序的服务器端应用程序。如果这个服务器端应用程序配置不正确，Angular Universal可能无法按预期工作，或者根本无法工作。</li><li id="2025" class="mx my iq ld b le ng lh nh ko ni ks nj kw nk lt nc nd ne nf bi translated">不更新Angular应用程序的<code class="fe ny nz oa np b">AppModule</code>:为了使用Angular Universal提供的服务器端渲染，你需要更新Angular应用程序的<code class="fe ny nz oa np b">AppModule</code>,以便从<code class="fe ny nz oa np b">@angular/platform-server</code>包中导入必要的模块和组件。如果忘记这样做，Angular Universal可能无法按预期工作。</li><li id="5e6d" class="mx my iq ld b le ng lh nh ko ni ks nj kw nk lt nc nd ne nf bi translated">安装Angular Universal后不测试您的应用程序:安装Angular Universal后，测试您的应用程序以确保它按预期工作是很重要的。这可能包括在不同的设备和浏览器上测试应用程序，并检查可能出现的任何错误或问题。通过彻底测试您的应用程序，您可以确保Angular Universal正常工作，并提供您期望的好处。</li></ol><p id="56c0" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">综上所述，安装Angular Universal有几个常见的错误是你可以避免的，包括没有使用Angular的最新版本，没有正确配置你的应用，没有更新你的Angular app的<code class="fe ny nz oa np b">AppModule</code>，安装Angular Universal后没有测试你的app。</p><h2 id="69d2" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">其他一些常见的窍门让棱角变得万能</strong></h2><ol class=""><li id="d391" class="mx my iq ld b le lf lh li ko nl ks nm kw nn lt nc nd ne nf bi translated"><strong class="ld ir">通过使用为常见任务提供抽象的内置角度服务，避免引用窗口、文档和其他特定于DOM的全局变量</strong>，例如使用DOM的Renderer2服务。您可以将Renderer2服务注入到组件中，并使用它的方法与DOM交互，而不是直接访问窗口或文档对象。否则，您的应用程序可能无法在服务器上正确呈现。</li></ol><p id="08e7" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">下面是一个如何使用Renderer2服务向DOM中的元素添加类的示例:</p><pre class="lv lw lx ly gt no np nq bn nr ns bi"><span id="744d" class="nt kg iq np b be nu nv l nw nx">import { Component, OnInit, Renderer2 } from '@angular/core';<br/><br/>@Component({<br/>  selector: 'app-my-component',<br/>  templateUrl: './my-component.component.html',<br/>  styleUrls: ['./my-component.component.css']<br/>})<br/>export class MyComponent implements OnInit {<br/><br/>  constructor(private renderer: Renderer2) { }<br/><br/>  ngOnInit() {<br/>    // Get the element with the id 'my-element'<br/>    const el = this.renderer.selectRootElement('#my-element');<br/><br/>    // Add the class 'my-class' to the element<br/>    this.renderer.addClass(el, 'my-class');<br/>  }<br/><br/>}</span></pre><p id="bf3a" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">通过使用Renderer2服务和其他Angular服务，您可以避免引用窗口、文档和其他DOM特定的全局变量，并使您的代码更加模块化、可移植和适合SSR。</p><p id="e97b" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">2.<strong class="ld ir">检查你的一些包是否引用了特定于DOM的全局变量，如窗口或文档</strong></p><p id="8376" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">在Angular中，您可以使用Augury Chrome扩展来检查模块的依赖关系，并检查它们是否引用了窗口、文档或其他特定于DOM的全局变量。</p><p id="147c" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">要使用Augury，首先从Chrome网络商店安装:<a class="ae mk" href="https://chrome.google.com/webstore/detail/augury/elgalmkoelokbchhkhacckoklkejnhcd" rel="noopener ugc nofollow" target="_blank">https://Chrome . Google . com/Web Store/detail/Augury/elgalmkoelokbchhkhackoklkejnhcd</a></p><p id="f8cb" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">一旦安装了占卜，在谷歌浏览器中打开你的Angular应用，点击工具栏中的占卜图标，打开占卜面板。在占卜面板中，单击依赖关系图选项卡，查看应用程序模块之间的依赖关系图。</p><p id="3d8a" class="pw-post-body-paragraph lb lc iq ld b le ml jr lg lh mm ju lj ko mn ll lm ks mo lo lp kw mp lr ls lt ij bi translated">要检查某个特定的模块，请在图中单击它的节点，并查找引用窗口、文档或其他DOM特定全局变量的依赖项。如果您看到任何这样的依赖，这意味着模块正在使用这些全局变量，您可能要考虑使用角度服务来代替。</p></div></div>    
</body>
</html>