<html>
<head>
<title>Master InfluxDB: Setting Up A Plugin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">主InfluxDB:设置插件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/master-influxdb-setting-up-a-plugin-dfb58adcbd15?source=collection_archive---------2-----------------------#2021-02-20">https://levelup.gitconnected.com/master-influxdb-setting-up-a-plugin-dfb58adcbd15?source=collection_archive---------2-----------------------#2021-02-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d441" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你还没有读过我介绍时间序列和InfluxDB的博客，这里是为了让你更好地了解我们将在本文中讨论的内容:</p><div class="kl km gp gr kn ko"><a href="https://fathimamaha25.medium.com/visualising-your-real-life-experiences-with-time-series-data-9641c3f7bfbd" rel="noopener follow" target="_blank"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">用时间序列数据形象化你的现实生活经历</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">初学者的时间序列</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">fathimamaha25.medium.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div><p id="080c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为初学者，在本文结束时，您将完成在您的系统上设置Influxdb的目标，成功运行一个插件来生成三角函数并在Chronograf上查看它，就像您在纸上绘制正弦或余弦波与时间的关系一样。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/0a3ae733b2925b0d29853e5ed53a3eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MKAUwnxHOrhE5JJv8V1BrQ.gif"/></div></div></figure></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h2 id="421a" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">安装InfluxDB:</h2><p id="31ff" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">前往<a class="ae mu" href="https://portal.influxdata.com/downloads/" rel="noopener ugc nofollow" target="_blank"> influxdb downloads </a>，选择您的机器并进入您的终端执行命令。我在我的Ubuntu 20.04机器上安装了最新版本的v2.0.4，默认情况下有Chronograf和Telegraf。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="e8f4" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$ </strong><a class="ae mu" href="https://dl.influxdata.com/influxdb/releases/influxdb2-2.0.4-amd64.deb" rel="noopener ugc nofollow" target="_blank">https://dl.influxdata.com/influxdb/releases/influxdb2-2.0.4-amd64.deb</a><br/><strong class="mw ir">$</strong> sudo dpkg -i influxdb2-2.0.4-amd64.deb</span></pre><p id="4991" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设置完成后，执行此命令检查Influxd的状态。如果显示激活，我们就可以开始了！</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="7647" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> sudo service influxd status</span></pre><p id="9a2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在终端上输入这个命令，启动你的流入服务，在你的机器浏览器上进入http://localhost:8086/</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="4f78" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> influxd</span></pre><p id="3b85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你需要停止服务，你可以使用这个命令或者用<em class="ne">重启</em>代替<em class="ne">停止</em>来完成后者。</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="8f24" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> sudo service influxd stop</span></pre><h2 id="f0a2" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">安装Telegraf:</h2><p id="6e1d" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">前往<a class="ae mu" href="https://portal.influxdata.com/downloads/" rel="noopener ugc nofollow" target="_blank">https://portal.influxdata.com/downloads/</a>，选择你的机器并在你的机器上下载最新版本的telegraf。</p><p id="7eb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于Linux二进制文件，我执行了:</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="63f9" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> wget https://dl.influxdata.com/telegraf/releases/telegraf-1.17.3_linux_amd64.tar.gz<br/><strong class="mw ir">$</strong> tar xf telegraf-1.17.3_linux_amd64.tar.gz</span></pre><p id="c09f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在这些步骤中遇到任何错误，帮助是无处不在的，我相信这不会花太多时间。</p><p id="1905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Telegraf在一个插件系统上工作，我们有输入插件来收集数据，输出插件将数据发送到目的地。Telegraf就像一个信使，将你送到最终目的地，也就是InfluxDB。Telegraf社区已经建立了大约100多个插件供我们使用。对这些插件稍加修改，我们就可以在Influxdb上查看很多信息。</p><p id="13cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将首先看看如何获得这些插件，然后用三角函数插件绘制一个给定振幅的正切余弦波。</p><h2 id="67b3" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">获取插件:</h2><p id="1a2a" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">在你得到插件之前，确保你已经在你的系统中安装了Golang 来编写所有的插件。</p><p id="ec5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您只需要在您的shell上简单地执行这些命令，您将拥有一个目录，其中包含telegraf提供的所有插件:</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="811c" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> go get github.com/influxdata/telegraf<br/><strong class="mw ir">$</strong> cd &lt;Path-to-go-directory&gt;/github.com/influxdata/telegraf<br/><strong class="mw ir">$</strong> make</span></pre><p id="a89d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这应该会返回:</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="de03" class="lw lx iq mw b gy na nb l nc nd">go mod download<br/>go build -ldflags “ -X main.commit=9814d3d8 -X main.branch=random -X main.goos=linux -X main.goarch=amd64” ./cmd/telegraf</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/d41e0caa14a63dbfb81626c6a1853c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*aLUizludfN4HbCGY.gif"/></div></figure><p id="e8cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧！你终于准备好了所有的插件。要列出/查看所有插件，您可以使用telegraf -h探索命令。</p><p id="9875" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经有了所有的要素，是时候最终即插即用telegraf并在Chronograf上查看酷炫的可视化效果了。</p><h2 id="dedd" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">编辑触发器插件:</h2><p id="2423" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">打开<strong class="jp ir">Go _ directory&gt;guthub.com&gt;influx data&gt;telegraf</strong>中的文件插件，选择inputs查看所有输入插件的Go文件。打开<strong class="jp ir">trig&gt;trig _ original . go</strong>。如果您想用任何其他函数替换正弦函数，您可以这样做。我会用谭代替辛。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ng"><img src="../Images/a26cd0af28cd0eac03980d9d16b5b5da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QJcQZ-E2IODD1eTDv__Ug.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">trig_original.go文件</figcaption></figure><p id="8f31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还可以看到一个示例配置格式，这是将数据推入流中所必需的。这个插件允许用户改变函数的振幅。现在将示例配置复制到您的剪贴板上。</p><p id="bae3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您对插件进行任何更改时，要使其生效，您应该执行:</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="dd27" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> cd &lt;Path-to-go-directory&gt;/github.com/influxdata/telegraf<br/><strong class="mw ir">$</strong> make</span></pre><p id="f5c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，Chronograf:</p><p id="9a90" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开从第一步开始运行的influxdb服务器，通过转到<strong class="jp ir">数据&gt;桶&gt;创建桶，创建一个桶来刷新数据。</strong></p><p id="f841" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将把我的命名为“三角”。接下来转到<strong class="jp ir">数据&gt; Telegraf &gt;创建配置。</strong>将配置命名为简单的名称(trig)，确保选择您创建的bucket并选择插件“system”进行配置。我们将对其进行编辑，以使用trig插件来收集指标。单击完成。</p><p id="ae22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择您创建的配置旁边的设置说明，并生成令牌。令牌允许您通过插件将数据发送到桶中。转到一个新的shell，粘贴您使用以下命令创建的令牌:</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="ecdf" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> export INFLUX_TOKEN=&lt;TOKEN&gt;</span></pre><p id="6a61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以点击配置文件并下载它。下载完成后，用文本编辑器打开文件，从trig插件中粘贴示例配置，同时删除所有其他输入。要添加任何输入，我们应该指定[[inputs。<inputname> ]，本例中为[[inputs.trig]]。</inputname></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ng"><img src="../Images/83bc8ff3053525a060cc04f4f36227e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R39mhPtnkbjj3DN7BPbUlQ.png"/></div></div></figure><p id="c074" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">保存文件，现在你可以开始了。打开我们之前导出令牌的shell，并键入:</p><pre class="lf lg lh li gt mv mw mx my aw mz bi"><span id="10e0" class="lw lx iq mw b gy na nb l nc nd"><strong class="mw ir">$</strong> <!-- -->telegraf --config '&lt;path to config file&gt;/trig.conf' --debug</span></pre><p id="355d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果没有错误，您就可以让它在您的shell上成功运行了。打开<strong class="jp ir"> Chronograf &gt;探索&gt;选择你的桶&gt;点击测量&gt;提交</strong>。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nl"><img src="../Images/f9c3a87b67902c433d011fbaf1647f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yUAoVx3r7IhNT4iI1n-a0g.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">相对于时间振幅值为10的正切和余弦波</figcaption></figure><p id="ea07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就对了。你会在Chronograf仪表盘上看到波浪相对于时间的曲线。</p><p id="d75e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这篇文章能指导你顺利完成任务。更多关于TICK Stack的学习，敬请关注！</p></div></div>    
</body>
</html>