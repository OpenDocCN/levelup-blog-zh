<html>
<head>
<title>Migrating from Heroku to Render</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Heroku迁徙到Render</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/migrating-from-heroku-to-render-ea4e3bd709a5?source=collection_archive---------17-----------------------#2022-05-10">https://levelup.gitconnected.com/migrating-from-heroku-to-render-ea4e3bd709a5?source=collection_archive---------17-----------------------#2022-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/294ecb916ed4ca394e3decb6219096fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qqJXk-Q61hibwDj0KPSGig.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">弗雷德里克·索利·万登在<a class="ae jd" href="https://unsplash.com/s/photos/migrating-birds?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="0f56" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">时不时地，我会听到一些单词或短语被重复出现，以至于我最终会想，“嗯，我应该看看这个。”渲染是其中一个词。</p><p id="54ee" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Twitter上，我看到了各种各样的对话，人们希望从Heroku迁移到另一个服务。人们提出的一些问题包括:</p><ul class=""><li id="ddf4" class="lb lc jg kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">费用</li><li id="c84d" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">缺少持久存储选项</li><li id="8cd1" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">不适合托管静态网站</li><li id="4c85" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">最近产品开发的放缓</li></ul><p id="cc8d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在其中的一些对话中，我看到过这样的问题:“渲染怎么样？”</p><p id="29f2" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，渲染呢？从Heroku转移到Render有多难？我想弄清楚。我从一个简单的web应用程序开始，我已经将它部署到Heroku，并完成了将它迁移到Render的过程。总之，我花了大约10分钟。在这篇文章中，我将回顾我所采取的步骤。</p><p id="60c4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你需要的只是一个GitHub账户。</p><h1 id="e78b" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">我的Node.js应用程序的简要概述</h1><p id="362b" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">目前，我在Heroku上运行了一个简单的Node.js应用程序。我还安装了Heroku Postgres和Heroku Redis作为这个应用程序的附加组件。</p><p id="a6b9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个应用程序很简单。当我向/countries发送“GET”请求时，我得到一个响应体，它1)告诉我数据的来源(数据库或缓存), 2)给我一个国家列表。</p><p id="5ec8" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一个端点(/clear_cache ),我可以用“POST”请求点击它来清除Redis缓存。</p><h1 id="255b" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">步骤1:在Render中设置我们的应用程序</h1><p id="b0e1" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">首先，去render.com的<a class="ae jd" href="https://render.com/" rel="noopener ugc nofollow" target="_blank">登录或者注册GitHub。登录后，点击你的账户头像旁边顶部栏中的<strong class="kf jh">新</strong>按钮。然后，选择<strong class="kf jh"> Web服务</strong>。</a></p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ms"><img src="../Images/414b353c6e6c9b6a690c50e76a59617c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gsvOoJEBk0mkcsMZ0XhE5g.png"/></div></div></figure><p id="c585" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，选择您想要部署的GitHub存储库。为您的应用程序提供一个名称，并给出适当的启动命令。对于这个演示——因为这是一个Node.js项目——我的应用程序设置为运行npm install和npm start。</p><p id="c438" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也在这里选择免费计划。目前，这足以满足我们的演示需求。随着应用的扩展，您可以随时升级您的计划。</p><h1 id="88b5" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">步骤2:在渲染时设置Postgres</h1><p id="2f90" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">在Render上设置Postgres很简单。同样，在顶部菜单栏中，您所要做的就是点击<strong class="kf jh"> New </strong>，然后点击<strong class="kf jh"> PostgreSQL </strong>。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/16f4b3cad139e704e772756f826f1779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNlyeimSJXTDaVPbYxI2ag.png"/></div></div></figure><p id="9725" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，为您的<a class="ae jd" href="https://render.com/docs/databases" rel="noopener ugc nofollow" target="_blank"> Postgres数据库</a>提供一个名称。对于这个演示，我保留了其余的默认值，并使用了免费计划。</p><p id="ab0c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，点击<strong class="kf jh">创建数据库</strong>。</p><p id="24d9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你会在下面看到一个<strong class="kf jh">配置环境变量</strong>的步骤，但是我们一会儿再回来。现在，我们将继续设置Redis。</p><h1 id="0f91" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">步骤3:在渲染时设置Redis</h1><p id="5e86" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">Redis是一个快速灵活的键值存储，我们将在演示应用程序中使用它进行缓存。不断地查询数据库会变得很昂贵，尤其是当您的应用程序扩展时。当后续查询返回相同的结果时，缓存这些结果以防止对数据库的不必要的访问是有意义的。Redis让我们这样做。</p><p id="fa86" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">直到最近，Render还没有提供托管Redis服务。你不得不在别的地方主持Redis。但是好消息！在几个月的早期访问之后，Render最近发布了其<a class="ae jd" href="https://render.com/docs/redis" rel="noopener ugc nofollow" target="_blank">托管Redis服务</a>，其中包括一个免费层！</p><p id="ac20" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，就像之前一样，点击<strong class="kf jh"> New </strong>并从下拉列表中选择<strong class="kf jh"> Redis </strong>。确保命名您的Redis实例，选择免费计划，然后点击<strong class="kf jh"> Create Redis </strong>。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi my"><img src="../Images/f23a8e396e7295e9bd923fc6bd136a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DbrLiAwBY0hP8Yj-fTw7Fg.png"/></div></div></figure><p id="86cd" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然Redis和Postgres都已经设置好了，我们可以继续设置我们的环境变量了。</p><h1 id="b16a" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">步骤4:配置环境变量</h1><p id="d499" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">我们的web应用程序依赖于某些环境变量。特别是，我们希望能够灵活地动态指定Postgres数据库位置和Redis位置，而不是将这些位置硬连接到代码中。让我们来看看如何在Render中指定这些环境变量。</p><p id="eccd" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">转到您的仪表板，单击您在第一步中创建的Web服务。</p><p id="703e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击页面子导航菜单中的<strong class="kf jh">环境</strong>。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/020019b357aaf56f77ccd2e464029540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3LbbTFgZFEjfOBb497CBgQ.png"/></div></div></figure><p id="6169" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您可以选择创建附加到web服务的单个环境变量，也可以创建一个环境组并将其附加到您的web服务。对于我们的应用程序来说，这两种方法都可以很好地工作。</p><p id="1fe7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要创建三个环境变量:</p><p id="5f9b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">- DATABASE_URL:将其设置为您在步骤2中设置的Postgres实例的配置页面中的内部连接字符串值。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/2be043ca92eaf3e134cb2f196c4246aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UqN7Va0sn5OoSgt96pEJiQ.png"/></div></div></figure><p id="00cb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">- REDIS_URL:将其设置为您在步骤3中设置的REDIS实例的配置页面中的内部连接字符串值。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/241d7d464ab2c2aac5133204ca869909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nllbxoHQU9dXrnF14srfQQ.png"/></div></div></figure><p id="0d9c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">- NODE_ENV:将其设置为“生产”。</p><p id="9c80" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您的Web服务的环境变量应该如下所示:</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/c8beb82b0c92d1aeb59a6fb4f74c1821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ja-uMY6Z_VQyHg4jidQ9rg.png"/></div></div></figure><h1 id="6ba8" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">测试我们的应用</h1><p id="25b4" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">设置好环境变量后，我们就可以测试我们的应用程序了。我使用“curl”命令向我的渲染应用程序发送请求。</p><p id="cada" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们向<a class="ae jd" href="https://redis-postgres-demo.onrender.com/countries`" rel="noopener ugc nofollow" target="_blank">https://redis-postgres-demo.onrender.com/countries</a>发送一个“GET”请求。在我的终端窗口中，命令如下所示:</p><pre class="mt mu mv mw gt na nb nc nd aw ne bi"><span id="83bf" class="nf lq jg nb b gy ng nh l ni nj">curl -X GET <a class="ae jd" href="https://redis-postgres-demo.onrender.com/countries`" rel="noopener ugc nofollow" target="_blank">https://redis-postgres-demo.onrender.com/countries</a></span></pre><p id="c650" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是我收到的回复:</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/5e6d0ef0aee268366e4659c868cf351e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cta4FzxkYjg348E7EBmqug.png"/></div></div></figure><p id="32a4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来源描述了我们从哪里获取数据，而数据只是所有国家的数据。从上面的响应中我们可以看到，对于第一个请求，数据的来源是数据库。</p><p id="c96e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们向同一个端点发送第二个“GET”请求。回应如下:</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/2aac2fe4fdaed78946160e939d2e9614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZPEbLl1XNsmGu33l5TrJQ.png"/></div></div></figure><p id="078e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如所料，第二个请求的数据源是Redis缓存，而不是数据库。</p><p id="4225" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们发送一个“POST”请求来清除缓存:</p><pre class="mt mu mv mw gt na nb nc nd aw ne bi"><span id="e98e" class="nf lq jg nb b gy ng nh l ni nj">curl -X POST <a class="ae jd" href="https://redis-postgres-demo.onrender.com/clear_cache`" rel="noopener ugc nofollow" target="_blank">https://redis-postgres-demo.onrender.com/clear_cache</a></span></pre><p id="a26c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">清空缓存后，我们发送另一个“GET”请求来检索我们的国家列表。正如所料，由于没有缓存可供使用，返回数据的来源是数据库。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/5e6d0ef0aee268366e4659c868cf351e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cta4FzxkYjg348E7EBmqug.png"/></div></div></figure><p id="d74c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们的小应用程序已经无缝迁移到渲染。Render使得设置Postgres和Redis变得轻而易举！</p><h1 id="c2e9" class="lp lq jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">结论</h1><p id="40ae" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">总之，我们在Heroku上运行了一个使用Postgres和Redis的应用程序。只需将GitHub帐户连接到Render，我们就可以使用Render来:</p><ul class=""><li id="e3ca" class="lb lc jg kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">部署我们的Web服务</li><li id="f049" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">设置Postgres和Redis</li><li id="956e" class="lb lc jg kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">设置环境变量，将我们的Web服务指向我们的Postgres数据库和Redis实例。</li></ul><p id="5f10" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需点击几下鼠标，就能完成这一切，大概只需要煮一壶咖啡的时间。</p><p id="18d7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，让我们回到原来的问题。如果你想离开Heroku，你可能会问，“Render怎么样？”我得说这绝对值得考虑。</p><p id="701d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个视频，走过我的整个过程:【https://youtu.be/dambnfHv6fU】<a class="ae jd" href="https://youtu.be/dambnfHv6fU" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>