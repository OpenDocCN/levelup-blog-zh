<html>
<head>
<title>Can it be done in React Native? Revolut chart using D3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React Native中可以做到吗？使用D3的旋转图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/can-it-be-done-in-react-native-revolut-chart-using-d3-52cecfe93639?source=collection_archive---------1-----------------------#2018-10-03">https://levelup.gitconnected.com/can-it-be-done-in-react-native-revolut-chart-using-d3-52cecfe93639?source=collection_archive---------1-----------------------#2018-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bca8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本周的视频中，我们试图复制打开<a class="ae kl" href="https://www.revolut.com/" rel="noopener ugc nofollow" target="_blank"> Revolut app </a>时向你问候的美丽图表。</p><p id="2fb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你有应用程序动画和效果的例子，你想知道:“它能在React Native中完成吗？🤔“，请<a class="ae kl" href="mailto:wcandillon@gmail.com" rel="noopener ugc nofollow" target="_blank">给我发投稿</a>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="9c17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个例子的全部点心在<a class="ae kl" href="https://snack.expo.io/@wcandillon/revolut-chart" rel="noopener ugc nofollow" target="_blank">这里</a>都有。我们用的是D3.js和React原生SVG。下面是我们将使用的数据。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi kt"><img src="../Images/d51d3a78fb6edde49074d51707f08792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h65R6ALoGyJMYul-GfCHQQ.png"/></div></div></figure><p id="1520" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将使用D3来构建图形。我们需要将x和y值缩放到图表的宽度和高度。最后，我们使用curve()函数在点之间进行平滑处理。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi la"><img src="../Images/f8084ae5fb68db45b4533e76a9101f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5NIYUqmXipCYv2LVEEKcKA.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">我们使用D3来构建图形线</figcaption></figure><p id="d1ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在SVG中使用了这一行两次。一次显示蓝色笔划。然后，我们可以添加直线(图形容器的右侧和底部)到路径，并用线性渐变填充它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lf"><img src="../Images/f4cf54abc5f7093f72b72541261804f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gs8I-6C1Qetjhxb31-9dsg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">我们用来显示图形的SVG</figcaption></figure><p id="533b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们在图表顶部有一个<a class="ae kl" href="https://facebook.github.io/react-native/docs/scrollview" rel="noopener ugc nofollow" target="_blank"> ScrollView </a>组件，这样我们就可以在该行上滑动光标。为此，我们需要获得路径的长度。为此，我们可以使用<a class="ae kl" href="https://www.npmjs.com/package/svg-path-properties" rel="noopener ugc nofollow" target="_blank"> svg-path-properties </a>。为了在图形线上准确地从一端滑动到另一端，所以ScrollView的大小需要是路径长度的两倍。当然，我们需要收听<em class="lg"> onScroll </em>事件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lh"><img src="../Images/95b434a76b724eb267f73043a62dd766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*czpDcZm520skJBD5mp9-_Q.png"/></div></div></figure><p id="d38b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以监听滚动值，获得<em class="lg"> x </em>和<em class="lg"> y </em>坐标(再次使用svg-path-properties)，并沿着图形移动光标。我们使用<a class="ae kl" href="https://facebook.github.io/react-native/docs/direct-manipulation" rel="noopener ugc nofollow" target="_blank"> setNativeProps </a>来移动它，而不会在React端触发新的渲染。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi li"><img src="../Images/b7be3cfe981fa902088c31424176b71b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xxy9SrPkqp89lcVjt7mb_Q.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">我们将光标移过图表的线条</figcaption></figure><p id="620b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一步，我们需要滑动光标上方的标签，如下所示。为了能够使用<em class="lg"> setNativeProps </em>更新标签值，我们使用了一个<em class="lg">文本输入</em>组件，而不是<em class="lg">文本</em>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lj"><img src="../Images/0aef4278faad659029bc226c4e5ffc92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eeP4v5myQ5kgCrcQGOgszA.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">当scroll为0时，标签位于屏幕右侧。当值为线长度时，转换为0。</figcaption></figure><p id="8e8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了显示正确的标签值，我们需要使用D3的<code class="fe lk ll lm ln b">scale.invert</code>从<code class="fe lk ll lm ln b">y</code>值返回到原始值(例如300)。反转会给我们一个连续值，我们可以通过使用新的标度将它们转换成离散值。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lo"><img src="../Images/aff79d3caa2e98358695d60dee1f4a16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fboupToNAmvjbIoC7i_3Dg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">我们使用scale.invert()以及带有离散值的新刻度来显示标签。</figcaption></figure><h1 id="c4a7" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">那都是乡亲们！</h1><p id="2d66" class="pw-post-body-paragraph jn jo iq jp b jq mn js jt ju mo jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">希望你喜欢这个故事。期待阅读您对此的看法。如果你想开始一个很酷的React原生项目，别忘了看看最全面的React原生初学者工具包<a class="ae kl" href="https://react-native.shop/elements" rel="noopener ugc nofollow" target="_blank"> React原生草图元素</a>。</p><div class="ms mt gp gr mu mv"><a href="https://hackernoon.com/react-native-sketch-elements-889f010f9626" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd ir gy z fp na fr fs nb fu fw ip bi translated">反应原生草图元素</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">经过两个月的制作，React本地草图元素终于出现了。反应原生元素涵盖了广泛的…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">hackernoon.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ky mv"/></div></div></a></div></div></div>    
</body>
</html>