<html>
<head>
<title>Deploying Spring Boot application to Heroku with PostgreSql</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PostgreSql将Spring Boot应用程序部署到Heroku</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploying-spring-boot-application-to-heroku-with-postgresql-dc94f193464c?source=collection_archive---------4-----------------------#2022-01-03">https://levelup.gitconnected.com/deploying-spring-boot-application-to-heroku-with-postgresql-dc94f193464c?source=collection_archive---------4-----------------------#2022-01-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="619c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将讨论如何轻松地将连接到PostgreSql的Spring Boot应用程序部署到Heroku。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/242a47f21691c061e5d2516f2756f657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*KKE5Q9rMoQOQrnoCE12t_A.png"/></div></figure><h1 id="44df" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">单纯的Heroku </strong></h1><p id="dd54" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Heroku是一家云计算应用基础设施服务提供商。它是一个平台，允许您快速部署以Node.js、Ruby、Python、Java、PHP、Go、Scala、Clojure等语言部署的基于web的应用程序，并且不需要技术服务器设置知识。</p><h1 id="437c" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">创建应用</strong></h1><p id="54b1" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">将有一个应用程序使用Http Post类型REST服务将记录保存到PostgreSql。</p><p id="4682" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过Spring Initializr，我们创建了一个使用以下依赖项和设置的应用程序，然后在IDE中打开这个应用程序。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lw"><img src="../Images/d786dcbe0e92cffbcb90702547caa2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fAFgdRfvtNVm-HmnhoN4XA.png"/></div></div></figure><p id="36dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为应用程序在本地环境和Heroku环境中有不同的设置，所以我添加了一个名为application-default.properties的文件，并将其定义如下。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="c680" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了让应用程序动态地读取属性文件，我将应用程序类设置如下。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="73e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我简单地添加了在<strong class="jp ir">实体、控制器、服务</strong>和<strong class="jp ir">存储库</strong>模块下执行必要操作的类。为了不使文章太长，我在这里不包括它们，你可以从文章末尾的GitHub链接看一下这个项目。</p><p id="fddb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我通过postman在本地环境中测试了该应用程序，并获得了成功的结果。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi md"><img src="../Images/756b59b75dd8e0c3e6c18bc271a919a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WdAnUBq9CiLQlGivrksxHQ.png"/></div></div></figure><p id="a72a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用程序现在可以部署到Heroku了。</p><p id="9bf2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们向应用程序添加一个名为<strong class="jp ir"> app.json </strong>的文件。</p><blockquote class="me mf mg"><p id="a03c" class="jn jo mh jp b jq jr js jt ju jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj kk ij bi translated">app.json是描述web应用的清单格式。它声明了在Heroku上运行应用程序所需的环境变量、附加组件和其他信息。</p></blockquote><p id="f139" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们如下创建app.json文件。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="38e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将应用程序部署到Heroku环境后，我们创建application-prod.properties文件来设置不同的配置并添加以下内容。</p><p id="2196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mh">spring . data source . URL = DATABASE _ URL，＄{ DATABASE _ URL }字段中的</em>将作为heroku环境中的值给出</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="8138" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，通过在Gradle选项卡中说buildJar，我们在应用程序文件夹的构建路径中创建一个名为libs的文件，并在那里添加应用程序的Jar。</p><p id="64e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将<strong class="jp ir"> Procfile </strong>文件添加到应用程序中。</p><p id="9e97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Procfile文件，我们可以显示应用程序的目标jar文件，并根据heroku环境的application-prod.properties配置创建它。</p><p id="6485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Procfile文件设置如下。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="3f08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们在应用程序路径上创建一个名为<strong class="jp ir"> system.properties </strong>的文件，并在那里指定我们的java版本。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="2696" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们将通过GitHub将我们的应用程序部署到Heroku环境，所以我们将应用程序推送到GitHub。</p><p id="a1c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在<a class="ae ml" href="https://www.heroku.com/home" rel="noopener ugc nofollow" target="_blank"> Heroku </a>免费注册应用程序，并继续使用免费部署方法。</p><p id="9149" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个像下面这样的仪表板屏幕将会向你问候，因为我有旧的项目，仪表板区域已经满了。</p><p id="78a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们继续按下“New”按钮，然后选择“Create new app”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mm"><img src="../Images/6ed9a07a16da5eeba3c6746c502a6f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zZYgVgn54-5bQGk4WDrhbw.png"/></div></div></figure><p id="bfa4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们继续从下面的屏幕中给我们的应用程序一个唯一的名称。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mn"><img src="../Images/e6c1271d2e0693ac8b09cd7fe64204c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebyQ3yGlbcXEcDdwDYFMSw.png"/></div></div></figure><p id="4a16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们转到Resources选项卡，选择Heroku Postgres并将其添加到我们的应用程序中。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mo"><img src="../Images/7f265bb22f6553f11afa206697db6da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a8impXk2JzkEP8KVSO6fOQ.png"/></div></div></figure><p id="647b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们转到Settings选项卡并查看配置时，我们看到刚刚在Heroku环境中创建的PostgreSql数据库的连接字符串被添加到DATABASE_URL键中。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mp"><img src="../Images/ac0975a0cbadad7d21cddc43b31031b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8CNoKBtU9kh2tLqgnm_7Q.png"/></div></div></figure><p id="d264" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们将转到Deploy选项卡，进行部署设置。通过点击Connect to GitHub选项，我们表明我们将通过GitHub部署应用程序。将Heroku与GitHub配对后，我们选择我们的回购如下。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mq"><img src="../Images/2e7e3870b61a257bee155e70bb587575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XGi9EzRgvH8dZP28_z0muQ.png"/></div></div></figure><p id="4c7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们希望在主分支中进行的每个更改中都自动部署，我们必须按下Enable Automatic deployments按钮。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mr"><img src="../Images/2b061df36c41cfbace7fee123f39eeba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3f7YMgjtOVQPr-dyFX7c7w.png"/></div></div></figure><p id="4a04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们希望在主分支中进行的每个更改中都自动部署，我们必须按下Enable Automatic deployments按钮。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi ms"><img src="../Images/d064df111e3a5685aa8510b0231162eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r9-0W8e0mx3zxtMasi1Vew.png"/></div></div></figure><p id="d199" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">部署完成后，我们从Settings选项卡中获取应用程序的url，并通过Postman发送请求。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mt"><img src="../Images/da8f22c88503607cf0a3cd610e190350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lI1oZvdb6fzx1vJzFG4zyA.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mu"><img src="../Images/9e33e6e3703926799dd868ee4588136b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pg5Z9-XZ5XTz4GkMk7if-A.png"/></div></div></figure><p id="ecd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到我们的虚拟记录已成功添加。</p><h1 id="dad5" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">结论</strong></h1><p id="df84" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">在本文中，我们看到了如何轻松地将Spring Boot应用程序部署到Heroku环境中，如何将PostgreSql添加到Heroku环境中并将其连接到应用程序。</p><p id="d7e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里找到应用程序<a class="ae ml" href="https://github.com/aenesgur/springboot-heroku-simple-app" rel="noopener ugc nofollow" target="_blank">的源代码</a>。</p><p id="c020" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一篇文章再见。</p></div></div>    
</body>
</html>