<html>
<head>
<title>How to deploy Angular app to an IIS Web server — Complete Setup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Angular app部署到IIS Web服务器—完整设置</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-deploy-angular-app-to-an-iis-web-server-complete-setup-337997486423?source=collection_archive---------0-----------------------#2021-03-26">https://levelup.gitconnected.com/how-to-deploy-angular-app-to-an-iis-web-server-complete-setup-337997486423?source=collection_archive---------0-----------------------#2021-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8fd6c8d84ef5ffac2d524d5bb3a9aa06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09u_9YpDdTA_SyZHFQYMaQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@stadsa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">塔达斯·萨尔</a>在<a class="ae kf" href="/s/photos/microsoft?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2bb1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有一个Angular应用程序，你需要把它部署到一个IIS服务器上，你可以这样做。</p><p id="d223" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文包含了完整的设置，但是如果您已经配置了一些东西，并且您只对某些特定的信息感兴趣，这里是我们将在本文中讨论的内容。</p><h2 id="b33c" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">目录:</h2><ol class=""><li id="75ba" class="lx ly it ki b kj lz kn ma kr mb kv mc kz md ld me mf mg mh bi translated">我们想要达到的目标</li><li id="fd9d" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">启用IIS并安装URL重写</li><li id="1e2b" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">将Angular配置为在开发版本中输出文件</li><li id="2021" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">在IIS中添加新的应用程序</li><li id="26f1" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">IIS权限</li><li id="67f2" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">配置<code class="fe mn mo mp mq b">deploy-url</code>和<code class="fe mn mo mp mq b">base-href</code></li><li id="22df" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">IIS配置文件</li></ol><h1 id="c671" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">1.我们想要达到的目标</h1><p id="2cb2" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">我们有一个基于Angular的应用程序，其中包含我们在本地系统上使用命令<code class="fe mn mo mp mq b">npm run start</code>开发的路线，这将为我们创建一个开发服务器，并在端口<code class="fe mn mo mp mq b">localhost:4200</code>为应用程序提供服务。</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/6eca0c232d7a56f7de7e3e9b69945043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*p8WRb1hZ-s0ulUO6PnOg9w.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">带开发服务器的Angular应用程序(npm运行开始)</figcaption></figure><p id="6c48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要求是我们现在需要从IIS web服务器而不是本地虚拟开发服务器运行这个应用程序。</p><blockquote class="nq nr ns"><p id="c00d" class="kg kh nt ki b kj kk kl km kn ko kp kq nu ks kt ku nv kw kx ky nw la lb lc ld im bi translated">这只是一个简单的场景。以下配置也可以应用于生产版本。</p></blockquote><h1 id="33c3" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">2.启用IIS</h1><p id="e726" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">默认情况下，IIS web服务器是不启用的，因此我们需要手动启用。</p><ol class=""><li id="a32d" class="lx ly it ki b kj kk kn ko kr nx kv ny kz nz ld me mf mg mh bi translated">在Windows中，导航到<strong class="ki iu">控制面板</strong> &gt; <strong class="ki iu">程序</strong> &gt; <strong class="ki iu">程序和功能</strong> &gt; <strong class="ki iu">打开或关闭Windows功能</strong>(屏幕左侧)。</li><li id="2a8c" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">选择<strong class="ki iu">互联网信息服务</strong>复选框。选择确定。</li></ol><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/b2646a2c1dc4ba0a20c201ed081b0a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OKIXqaX0uUs1xbLbN7FekQ.gif"/></div></div></figure><blockquote class="nq nr ns"><p id="7d49" class="kg kh nt ki b kj kk kl km kn ko kp kq nu ks kt ku nv kw kx ky nw la lb lc ld im bi translated">IIS安装可能需要重新启动系统。</p></blockquote><p id="236e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后打开它，只需在搜索栏中搜索<strong class="ki iu"> IIS管理器</strong>。</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/45de5aed284501719b4d212f1d968262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GG9nz-mJnNCqWnVJHeNcrw.png"/></div></div></figure><p id="a901" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还需要IIS URL重写模块。你可以在他们的<a class="ae kf" href="https://www.iis.net/downloads/microsoft/url-rewrite" rel="noopener ugc nofollow" target="_blank">官方页面</a>上找到。</p><h1 id="c7fd" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">3.将Angular配置为在开发版本中输出文件</h1><p id="724e" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">将Angular与默认的开发服务器<code class="fe mn mo mp mq b">ng serve</code>一起使用时，输出在内存中，不会写入磁盘。</p><p id="2a1b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要使用我们自己的服务器，我们需要使用<code class="fe mn mo mp mq b">ng build --watch</code>，它会像<code class="fe mn mo mp mq b">ng serve</code>一样监视文件，但会将它们写入磁盘，而不会运行服务器。</p><p id="0afb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，更新<code class="fe mn mo mp mq b">package.json</code>文件并在<code class="fe mn mo mp mq b">scripts</code>中再添加一个命令，它将执行这个命令。</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/cb7fc3f16a2f7850377731907861085b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpWzdlEeKrXf3iaBRoZRAw.png"/></div></div></figure><p id="a348" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们运行这个命令，我们将在<code class="fe mn mo mp mq b">dist</code>文件夹中看到我们应用程序的开发版本。</p><h1 id="0cd8" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">4.在IIS中添加新的应用程序</h1><p id="cbd4" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">现在，我们已经配置了Angular以在监视模式下构建文件，并将它们写入磁盘，我们需要进入IIS管理器并添加一个新的应用程序。</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/4ed1cfa0da55f43c27ce6b354b680e83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1CcfUT3wiHkptwMxUVj8ng.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在IIS中添加新的应用程序</figcaption></figure><p id="53ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">工作流程如下:</p><ul class=""><li id="253d" class="lx ly it ki b kj kk kn ko kr nx kv ny kz nz ld od mf mg mh bi translated">复制输出文件的文件路径，在我们的例子中是来自<code class="fe mn mo mp mq b">dist/my-app</code>的文件</li><li id="4dc7" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld od mf mg mh bi translated"><strong class="ki iu">在<strong class="ki iu">默认网站&gt; </strong> <strong class="ki iu">上右键</strong>添加应用</strong></li><li id="d6da" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld od mf mg mh bi translated">在<strong class="ki iu">别名</strong>字段中填入您希望为申请提供服务的路线(<code class="fe mn mo mp mq b">localhost/my-app</code></li></ul><blockquote class="nq nr ns"><p id="ec1c" class="kg kh nt ki b kj kk kl km kn ko kp kq nu ks kt ku nv kw kx ky nw la lb lc ld im bi translated">可能需要重新启动IIS。</p></blockquote><h1 id="2b32" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">5.IIS权限</h1><p id="269a" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">此时，如果我们打开浏览器并尝试访问应用程序<code class="fe mn mo mp mq b">localhost/my-app</code>，我们将看到如下内容:</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oe"><img src="../Images/b3375df17bf462b5701a2eeaa93abd33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wuOM_qxjs0IlUKsaIq_DOw.png"/></div></div></figure><p id="3306" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">发生这种情况是因为IIS服务器无法访问我们的文件夹。</p><p id="60e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">IIS还创建了<strong class="ki iu"> IUSR </strong>作为通过IIS访问文件的默认用户。因此，我们需要确保<strong class="ki iu"> IUSR </strong>和<strong class="ki iu"> IIS_USRS </strong>拥有文件/文件夹的读取权限。</p><p id="c924" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，<strong class="ki iu">右击文件夹</strong>-&gt;-<strong class="ki iu">属性</strong>-&gt;-<strong class="ki iu">安全选项卡&gt;-</strong>查看IUSR和IIS_USRS是否在组或用户名列表中，如果没有，</p><p id="f975" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">点击编辑</strong>-&gt;-<strong class="ki iu">添加</strong>-&gt;-<strong class="ki iu">高级</strong>-&gt;-<strong class="ki iu">立即查找</strong> - &gt;选择<strong class="ki iu"> IUSR </strong>点击确定</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/5112821d95e0c1e09e17cedcaf1f9cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pqs-BMrgls069ZKAeTtR2g.gif"/></div></div></figure><h1 id="1ce4" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">6.配置<code class="fe mn mo mp mq b">deploy-url</code>和<code class="fe mn mo mp mq b">base-href</code></h1><p id="8505" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">一旦我们的文件的权限被授予IIS，我们就可以重新打开应用程序。<br/>然而，我们实际看到的是一个空白页和几个控制台错误。</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/bedadd9e99252e86d4f82c1f11bff814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WS69HTgvcz6dhAtFefWJsQ.png"/></div></div></figure><p id="b94a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的Angular应用程序是在<code class="fe mn mo mp mq b">localhost/my-app</code>下提供的，但是如果我们看一下开发者的工具，我们可以看到应用程序的文件是直接从<code class="fe mn mo mp mq b">localhost</code>请求的。</p><p id="5eb6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用<code class="fe mn mo mp mq b">http://localhost/styles.css</code>代替<code class="fe mn mo mp mq b">http://localhost/my-app/styles.css</code>，其余的文件也是如此。</p><p id="2c48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">问题是Angular已经构建了我们的应用程序，假设文件将从主路径<code class="fe mn mo mp mq b">/</code>加载。</p><p id="bdcb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了解决这个问题，我们需要在构建应用程序时指定<code class="fe mn mo mp mq b">deploy-url</code>和<code class="fe mn mo mp mq b">base-href</code>值。</p><p id="0105" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mn mo mp mq b">base-href</code>由路由使用，<code class="fe mn mo mp mq b">deploy-url</code>用于资产。</p><p id="02fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe mn mo mp mq b">package.json</code>中，用以下命令更新<code class="fe mn mo mp mq b">build:dev</code>脚本</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi og"><img src="../Images/88d1e10c4138f9ac1e8dd22b9c494f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aA3h4gg2-GTBrBI10EvDAw.png"/></div></div></figure><h1 id="22a9" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">7.IIS配置文件</h1><p id="adc3" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">让我们再次构建应用程序，看看我们有什么。</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/c11fa0107cbdfa7bc25a8427545bf6c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yHjE7HG3Sm2xH9nf1cq68w.gif"/></div></div></figure><p id="d50b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，工作流程应该是这样的。应用程序应该按预期工作，但是路由应该只在应用程序内部工作。</p><p id="5a00" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们访问一个像<code class="fe mn mo mp mq b">localhost/my-app/two</code>这样的路由并在那里刷新页面，或者如果我们在浏览器中输入这个URL，我们将会在一个404 IIS页面上结束。</p><p id="02cf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之所以会出现这种情况，是因为IIS只被配置为理解<code class="fe mn mo mp mq b">localhost/my-app</code>并将这个URL映射到<code class="fe mn mo mp mq b">our_app_path/dist/my-app</code>。</p><p id="44c2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它不知道<code class="fe mn mo mp mq b">localhost/my-app/two</code>或我们申请的任何其他途径。</p><p id="b5ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了解决最后一个问题，我们需要配置IIS将所有来自<code class="fe mn mo mp mq b">localhost/my-app/*</code>的请求重定向到我们的应用程序。</p><p id="3bf3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">必要的配置也记录在角度部署页面的<a class="ae kf" href="https://angular.io/guide/deployment#server-configuration" rel="noopener ugc nofollow" target="_blank">服务器配置</a>部分。</p><p id="db61" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于IIS，我们需要创建一个名为<code class="fe mn mo mp mq b">web.config</code>的新配置文件，内容如下:</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oh"><img src="../Images/7ef40f9dec6d5dc2cf630929baf97cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6VDsPWkp71H5bzuQ7hBJmQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&amp;t=seti&amp;wt=none&amp;l=htmlmixed&amp;ds=true&amp;dsyoff=20px&amp;dsblur=68px&amp;wc=true&amp;wa=true&amp;pv=56px&amp;ph=56px&amp;ln=false&amp;fl=1&amp;fm=Hack&amp;fs=14px&amp;lh=133%25&amp;si=false&amp;es=2x&amp;wm=false&amp;code=%253C%253Fxml%2520version%253D%25221.0%2522%2520encoding%253D%2522utf-8%2522%253F%253E%250A%253Cconfiguration%253E%250A%250A%253Csystem.webServer%253E%250A%2520%2520%253Crewrite%253E%250A%2520%2520%2520%2520%253Crules%253E%250A%2520%2520%2520%2520%2520%2520%253Crule%2520name%253D%2522Angular%2520Routes%2522%2520stopProcessing%253D%2522true%2522%253E%250A%2520%2520%2520%2520%2520%2520%2520%2520%253Cmatch%2520url%253D%2522.*%2522%2520%252F%253E%250A%2520%2520%2520%2520%2520%2520%2520%2520%253Cconditions%2520logicalGrouping%253D%2522MatchAll%2522%253E%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%253Cadd%2520input%253D%2522%257BREQUEST_FILENAME%257D%2522%2520matchType%253D%2522IsFile%2522%2520negate%253D%2522true%2522%2520%252F%253E%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%253Cadd%2520input%253D%2522%257BREQUEST_FILENAME%257D%2522%2520matchType%253D%2522IsDirectory%2522%2520negate%253D%2522true%2522%2520%252F%253E%250A%2520%2520%2520%2520%2520%2520%2520%2520%253C%252Fconditions%253E%250A%2520%2520%2520%2520%2520%2520%2520%2520%253Caction%2520type%253D%2522Rewrite%2522%2520url%253D%2522.%252Findex.html%2522%2520%252F%253E%250A%2520%2520%2520%2520%2520%2520%253C%252Frule%253E%250A%2520%2520%2520%2520%253C%252Frules%253E%250A%2520%2520%253C%252Frewrite%253E%250A%253C%252Fsystem.webServer%253E%250A%250A%253C%252Fconfiguration%253E" rel="noopener ugc nofollow" target="_blank">原始</a></figcaption></figure><p id="0828" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个<code class="fe mn mo mp mq b">web.config</code>文件必须包含在我们的构建中，所以它必须放在<code class="fe mn mo mp mq b">dist/my-app</code>中。</p><p id="58ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了自动完成这项工作，让我们将这个文件放在<code class="fe mn mo mp mq b">src</code>文件夹中，并更新<code class="fe mn mo mp mq b">angular-cli.json</code>文件，如下所示:</p><figure class="nm nn no np gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oi"><img src="../Images/278aa5909386a0ba42d9b4cc5157db42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIGb6rG4cpzYX5kFINKurQ.png"/></div></div></figure><p id="7527" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将<code class="fe mn mo mp mq b">assets</code>从<code class="fe mn mo mp mq b">arhitect.build</code>上取下，放入<code class="fe mn mo mp mq b">configuration.development</code>和<code class="fe mn mo mp mq b">configuration.production</code>中。</p><p id="02f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样，我们可以在开发版本中加载<code class="fe mn mo mp mq b">web.config</code>文件，并从生产版本中跳过它。</p><p id="b7cf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您的用例在开发和生产构建中都有它，那么在<code class="fe mn mo mp mq b">architect.build</code>中保留原始资产并附加<code class="fe mn mo mp mq b">src/web.config</code>。</p><p id="7c69" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，由于我们引入了新的配置选项，让我们最后一次更新<code class="fe mn mo mp mq b">build:dev</code>脚本:</p><pre class="nm nn no np gt oj mq ok ol aw om bi"><span id="2069" class="le lf it mq b gy on oo l op oq">"build:dev": "ng build --watch --deploy-url /my-app/ --base-href /my-app/ --configuration=development"</span></pre><p id="0b3d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们在开发模式下再次构建应用程序，我们应该看到文件<code class="fe mn mo mp mq b">web.config</code>在我们的发行版中被复制，现在应用程序完全按照预期工作。</p><h1 id="6dd4" class="mr lf it bd lg ms mt mu lj mv mw mx lm my mz na lp nb nc nd ls ne nf ng lv nh bi translated">结论</h1><p id="a017" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">部署Angular应用程序的过程与任何其他基于框架的应用程序没有太大的不同。同样的步骤需要重复，不同的只是你做的方式。</p><p id="3bda" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想了解更多，那么看看这篇<a class="ae kf" href="https://itnext.io/how-to-deploy-angular-app-in-production-cpas-2-affb711d18fc" rel="noopener ugc nofollow" target="_blank">相关文章</a>。</p></div></div>    
</body>
</html>