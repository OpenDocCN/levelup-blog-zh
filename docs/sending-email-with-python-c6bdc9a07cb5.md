# 使用 Python 发送电子邮件

> 原文：<https://levelup.gitconnected.com/sending-email-with-python-c6bdc9a07cb5>

![](img/7591b223e9923a8320df4002749625f8.png)

Solen Feyissa 在 [Unsplash](https://unsplash.com/s/photos/email?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

在本文中，我们将使用 SMTP 和 IMAP 用 Python 开发一个电子邮件机器人。

# 简单邮件传输协议

SMTP(简单邮件传输协议)是用于发送和接收电子邮件的 TCP/IP 协议。但是，由于它在接收端对消息进行排队的能力有限，所以它通常与其他两种协议(POP3(邮局协议)或 IMAP(互联网消息访问协议))一起使用，这两种协议允许用户将消息保存在服务器邮箱中，并定期从服务器下载它们。换句话说，用户通常使用 SMTP 发送电子邮件，POP3 或 IMAP 接收电子邮件的程序。

# SMTP 如何工作？

SMTP 使用客户机/服务器模型，分为三个步骤。首先，电子邮件服务器使用 SMTP 将邮件从电子邮件客户端(如 Outlook 或 Gmail)发送到电子邮件服务器。第二，电子邮件服务器使用 SMTP 作为中继服务将电子邮件发送到接收电子邮件的服务器。第三，接收服务器使用电子邮件客户端通过 IMAP 下载收到的邮件，并将其放入收件人的收件箱。

# 代码时间

我们将使用 python 来开发我们的电子邮件机器人，如果您没有，请从官方 Python 网站下载最新版本并安装。成功安装 Python 后，安装以下模块。

*pip 安装 smtp*

*pip 安装邮件*

在编码的第一步，我们在 python 文件中加载电子邮件和 SMTP 模块。只需创建您的 py 文件，复制并粘贴向上的代码。

接下来，我们添加想要发送给某人的内容或消息，在代码编辑器的第 6 行到第 8 行，我们添加用户详细信息，即我们帐户的电子邮件和密码，以及收件人电子邮件。我们的 SMTP 模块将使用电子邮件和密码连接到我们的邮件服务，并将相应的邮件发送到收件人邮箱。

现在，我们在电子邮件中设置了 MIME，MIME 代表**多用途互联网邮件扩展，** its 一种互联网标准，它扩展了电子邮件的格式，以支持 ASCII 以外的字符集的文本，以及音频、视频、图像和应用程序的附件。

在最后一个会话中，我们创建了一个用于发送邮件的 SMTP 会话，正如您在 smtplib 中看到的那样。SMTP()我们使用端口 587 的 gmail.com，因为在本文中，我们向 g mail 用户个人发送邮件，您可以添加 smtp.yahoo.mail.com 或 smtp.outlook.com 或任何其他电子邮件服务主机名，session.starttls()将启动安全检查，session.login()函数将使用邮件和密码登录到一个受尊敬的电子邮件，我们将该邮件和密码添加为用户详细信息。session.send email 函数使用 SMTP 发送邮件到收件人地址，最后，我们使用 session.quite 来关闭我们的 SMTP 会话。

# 带文件附件的电子邮件

我们的下一个挑战是发送带有文件附件的电子邮件，它可以是应用程序、zip 文件、视频、音频或任何内容，而不是文本。我们将再次使用 MIME，因为它将以二进制形式获取我们的文件，并通过 SMTP 模块将其发送给相应的接收者。

像往常一样，第一步我们将模块加载到。py 文件，但这次我们添加了一些额外函数和模块，来自电子邮件的正确的编码器函数、SSL 库和 MIME 库，我将在本文的后面解释每个函数库使用的功能。

下一部分，我们将再次添加用户详细信息和收件人电子邮件信息，主题，密件抄送等。如果您不想添加主题或密件抄送，就不要在代码中添加这些行。MIMEText()在这个函数中，我们传递包含消息或内容的主体，如果您不想发送任何文本消息，也可以将其留空。从第 14 行到第 18 行，我们正在读取我们需要作为附件发送的文件，使用 python 内置的 open()函数，我们逐字节读取文件内容，并使用函数 MIMEBase 将其加载到应用程序表单中，encode_base64 函数对文件进行编码(字节形式)。我们不能只是读取和发送文件，我们需要把它转换成字节形式，并把它发送到 SMTP。

在最后一部分，我们使用 ssl.create_default_context()函数告诉 SMTP 服务器我们正在将内容作为附件发送。正如你注意到的，我在这段代码中使用了 465 端口。login()函数将登录到电子邮件站点，sendmail()将把带有附件的邮件发送给收件人。

所以我们用 Python 创建了一个完整的电子邮件机器人，你可以根据需要修改代码。

**如果您觉得这篇文章有帮助，请点击👏拍手表情符号**