<html>
<head>
<title>Error Handling Functions in Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Golang中的错误处理函数</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/error-handling-functions-in-golang-159ae73164b3?source=collection_archive---------6-----------------------#2022-06-15">https://levelup.gitconnected.com/error-handling-functions-in-golang-159ae73164b3?source=collection_archive---------6-----------------------#2022-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7b5c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将演示在Go中处理错误函数的基础知识以及如何使用它们。</p><h1 id="2171" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">错误类型是什么？</h1><p id="bd79" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">Go中的错误类型是接口类型。</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="7fff" class="ma kp it lw b gy mb mc l md me"><strong class="lw iu">type</strong> error <strong class="lw iu">interface</strong> {<br/>    Error() string<br/>}</span></pre><p id="48f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以基本上，错误类型是任何实现了<code class="fe mf mg mh lw b">Error()</code>方法的东西。</p><h1 id="17ed" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">构建错误</h1><p id="b361" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">有两种方法可以创建错误值。</p><ul class=""><li id="1c3a" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated"><code class="fe mf mg mh lw b"><strong class="js iu">error.New</strong></code>功能</li><li id="2d23" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><code class="fe mf mg mh lw b"><strong class="js iu">fmt.Errorf</strong></code>功能</li></ul><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="cb90" class="ma kp it lw b gy mb mc l md me">func bar() error {<br/>    return errors.New("error: an error occurred")<br/>}</span><span id="f98c" class="ma kp it lw b gy mw mc l md me">func foo() error {<br/>    return fmt.Errorf("error: %s", "an error occurred")<br/>}</span></pre><p id="2960" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对这两个函数<strong class="js iu"> </strong>的每次调用都会返回不同的错误值，即使文本是相同的。</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="e36a" class="ma kp it lw b gy mb mc l md me">fmt.Println(bar()==bar())   # false</span></pre><h1 id="4dc9" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">定义预期误差</h1><p id="80d7" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">定义预期错误是Go中的一项基本技术，因为它可以帮助我们识别特定的错误并以不同的方式处理它们。</p><figure class="lr ls lt lu gt mx"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="221e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里有一个例子:</p><ul class=""><li id="6d2b" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">我们首先定义一个称为<code class="fe mf mg mh lw b">ErrDivideByZero</code>的标记错误。</li><li id="526c" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">然后我们定义一个函数<code class="fe mf mg mh lw b">Divide</code>，当第二个参数为零时，它返回这个错误。</li><li id="2931" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">稍后，我们使用<code class="fe mf mg mh lw b"><strong class="js iu">errors.Is</strong></code>来检查返回的错误是否为<code class="fe mf mg mh lw b">ErrDivideByZero</code>，并相应地采取一些措施。</li></ul><h1 id="af12" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">包装错误</h1><p id="af8c" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">包装错误意味着将一个错误值放入另一个错误值，就像包装好的礼物一样。</p><figure class="lr ls lt lu gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/7478d35354995ea5fe1dc11772298dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YQJR6sIr6V1uO7HeM28MUA.png"/></div></div></figure><p id="9c55" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您希望在遇到特定错误时返回特定的错误消息时，这很有用。</p><p id="f646" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里有一个例子。</p><figure class="lr ls lt lu gt mx"><div class="bz fp l di"><div class="my mz l"/></div></figure><ul class=""><li id="b226" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">首先，当第二个参数为零时，<code class="fe mf mg mh lw b">Divide</code>函数返回一个<code class="fe mf mg mh lw b">ErrDivideByZero</code></li><li id="52b8" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">然后<code class="fe mf mg mh lw b">doDivide</code>函数用自定义错误消息包装<code class="fe mf mg mh lw b">ErrDivideByZero</code>错误，并返回一个<strong class="js iu">新错误</strong>。</li><li id="dc1d" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">最后，在主函数中，我们使用<code class="fe mf mg mh lw b">errors.Is</code>函数来检查错误在其包装链中是否有<code class="fe mf mg mh lw b">ErrDivideByZero</code>类型。</li></ul><h1 id="ae41" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">结论</h1><p id="4452" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">这里有三个要点</p><ul class=""><li id="dcbc" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">Go中的错误类型是接口类型。</li><li id="ce4a" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">预定义的错误将允许我们检查稍后发生的错误。</li><li id="f044" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">包装错误将上下文添加到函数调用中(类似于堆栈跟踪)</li></ul></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="3798" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">发现这篇文章很有用👏？看看我下面的其他文章吧！</p><ul class=""><li id="dd3f" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated"><a class="ae no" rel="noopener ugc nofollow" target="_blank" href="/circuit-breaker-example-in-golang-e6459c87eaeb">戈朗的断路器示例</a></li><li id="eae0" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><a class="ae no" rel="noopener ugc nofollow" target="_blank" href="/how-does-golang-channel-works-6d66acd54753">戈朗水道是如何工作的</a></li><li id="f7a6" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><a class="ae no" rel="noopener ugc nofollow" target="_blank" href="/observer-design-pattern-in-golang-with-an-example-6c24898059b1">观察者设计模式在Golang的一个例子</a></li></ul></div></div>    
</body>
</html>