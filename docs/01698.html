<html>
<head>
<title>Tutorial: Intro to Terraform and Pulumi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:Terraform和Pulumi简介</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tutorial-intro-to-terraform-and-pulumi-b0d4843038e5?source=collection_archive---------16-----------------------#2020-01-22">https://levelup.gitconnected.com/tutorial-intro-to-terraform-and-pulumi-b0d4843038e5?source=collection_archive---------16-----------------------#2020-01-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="819e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">作者</em> <a class="ae kp" href="https://www.linkedin.com/in/kevin-tinn/" rel="noopener ugc nofollow" target="_blank"> <em class="ko">凯文·汀</em></a><em class="ko">&amp;</em><a class="ae kp" href="https://www.linkedin.com/in/austin-loveless/" rel="noopener ugc nofollow" target="_blank"><em class="ko">奥斯汀·洛夫莱斯</em></a><em class="ko">—2019年1月22日</em></p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/e5c051bfad1582400ebedcaa345c2ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*RO6uWx-y0sRiPcql0HzPag.jpeg"/></div></figure><p id="b436" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">【https://www.youtube.com/channel/UCG3Si_vP2tijvvyE5xr7lbg】订阅AWSMeetupGroup YouTube频道:<a class="ae kp" href="https://www.youtube.com/channel/UCG3Si_vP2tijvvyE5xr7lbg" rel="noopener ugc nofollow" target="_blank"/></p><p id="1581" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">加入Meetup.com上的AWSMeetupGroup:<br/><a class="ae kp" href="https://www.meetup.com/AWSMeetupGroup/" rel="noopener ugc nofollow" target="_blank">https://www.meetup.com/AWSMeetupGroup/</a></strong></p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="53e4" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak">资源</strong></h1><ul class=""><li id="be92" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated">这里的代码<a class="ae kp" href="https://github.com/kevasync/aws-meetup-group-terraform" rel="noopener ugc nofollow" target="_blank">是</a>。</li><li id="a614" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">点击跟随<a class="ae kp" href="https://www.youtube.com/watch?v=VrAKeXbAaRw" rel="noopener ugc nofollow" target="_blank">观看YouTube直播。</a></li></ul><p id="4fdf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，我们将使用<a class="ae kp" href="https://www.terraform.io/" rel="noopener ugc nofollow" target="_blank"> Terraform </a>构建一个Hello World应用程序。然后，我们将进行更深入的研究，用一个RDS实例和一个承载基本web应用程序的EC2实例构建一个VPC。我们也将为<a class="ae kp" href="https://www.pulumi.com/" rel="noopener ugc nofollow" target="_blank">普鲁米</a>重复这一步骤。</p><h1 id="0077" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">入门指南</h1><ul class=""><li id="280f" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated">在AWS控制台中创建EC2密钥对</li><li id="8312" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">下载并设置ssh pem文件的权限</li><li id="4a7e" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">安装Terraform并创建第一个部署</li><li id="925e" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">创建AWS CLI帐户</li><li id="da0c" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">使用EC2和RDS部署IaaS托管堆栈</li><li id="9726" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">安装Pulumi并部署IaaS托管堆栈</li></ul><h1 id="c932" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">创建密钥对:</h1><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi my"><img src="../Images/b4566ca6e9225898a90c646129eb1088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oQW-HSkLoOk2-AEW.png"/></div></div></figure><h1 id="3565" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">下载ssh pem文件并设置权限:</h1><ul class=""><li id="6888" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">mv ~/Downloads/aws-meetup-group-key.pem ~/.ssh/</code></li><li id="7744" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">chmod 400 ~/.ssh/aws-meetup-group-key.pem</code></li></ul><h1 id="99f3" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">创建AWS CLI帐户</h1><p id="fa77" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb nh kd ke kf ni kh ki kj nj kl km kn im bi translated">IAM &gt;用户&gt;新用户</p><ul class=""><li id="28f8" class="md me it js b jt ju jx jy kb nk kf nl kj nm kn mk ml mm mn bi translated">名称用户</li></ul><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nn"><img src="../Images/1b8a73dfd685afa9d3f5bf840a286b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m6U9cUto_4bGvnz1.png"/></div></div></figure><ul class=""><li id="d435" class="md me it js b jt ju jx jy kb nk kf nl kj nm kn mk ml mm mn bi translated">添加到具有管理权限的组或角色</li></ul><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi no"><img src="../Images/7d16e3cd14e5070f42cac612d4aab7ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*T6tlZ9WwhMSSp3gv.png"/></div></div></figure><ul class=""><li id="a710" class="md me it js b jt ju jx jy kb nk kf nl kj nm kn mk ml mm mn bi translated">配置访问凭据</li></ul><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi np"><img src="../Images/1b5ad1d6c6024b384fe356244d796dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kxDdoRueE94Wlc7B.png"/></div></div></figure><h1 id="3a10" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">安装AWS CLI</h1><ul class=""><li id="1591" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated">Mac:</li><li id="5cb2" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">自制软件:<code class="fe nd ne nf ng b">brew install awscli</code></li><li id="3995" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">捆绑安装:<code class="fe nd ne nf ng b">curl "https://s3.amazonaws.com/aws-cli/awscli-bundle.zip" -o "awscli-bundle.zip"</code> <code class="fe nd ne nf ng b">unzip awscli-bundle.zip</code> <code class="fe nd ne nf ng b">sudo ./awscli-bundle/install -i /usr/local/aws -b /usr/local/bin/aws</code></li><li id="8efb" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">窗口:</li><li id="3db6" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><a class="ae kp" href="https://docs.aws.amazon.com/cli/latest/userguide/install-windows.html#install-msi-on-windows" rel="noopener ugc nofollow" target="_blank"> Windows: MSI安装程序</a></li></ul><h1 id="308f" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">在本地配置AWS CLI访问</h1><ul class=""><li id="5475" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">aws configure</code></li></ul><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nq"><img src="../Images/58097c0b6bd08abf8ebbc76f8e6f38ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oYZMMTh9xv8UNS1e.png"/></div></div></figure><ul class=""><li id="0b65" class="md me it js b jt ju jx jy kb nk kf nl kj nm kn mk ml mm mn bi translated">通过查看<code class="fe nd ne nf ng b">~/.aws/credentials</code>或<code class="fe nd ne nf ng b">%UserProfile%\.aws\credentials</code>的内容进行配置</li></ul><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nr"><img src="../Images/a98d6b31e64c7a439b6c7db1c8e22f96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qHYlfPY7iWq2xFnE.png"/></div></div></figure><h1 id="f9f2" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">安装地形</h1><ul class=""><li id="493d" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated">家酿(Mac): <code class="fe nd ne nf ng b">brew install terraform</code></li><li id="22f8" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">巧克力糖(Windows): <code class="fe nd ne nf ng b">choco install terraform</code></li><li id="84ef" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">手动下载:<a class="ae kp" href="https://www.terraform.io/downloads.html" rel="noopener ugc nofollow" target="_blank"> Terraform。IO </a></li></ul><h1 id="2c57" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">TF Hello World文件</h1><pre class="kr ks kt ku gt ns ng nt nu aw nv bi"><span id="b7f7" class="nw lg it ng b gy nx ny l nz oa">provider "aws" {<br/>  version = "~&gt; 2.0"<br/>  region  = "us-east-1"<br/>}<br/>resource "aws_vpc" "main" {<br/>  cidr_block = "192.168.225.0/24"<br/>  enable_dns_support = true<br/>  enable_dns_hostnames = true<br/>  tags = {<br/>    CostCenter = "tf-helloworld"<br/>  }<br/>}<br/>resource "aws_subnet" "main-subnet" {<br/>  vpc_id     = "${aws_vpc.main.id}"<br/>  cidr_block = "192.168.225.0/25"<br/>  availability_zone = "us-east-1a"<br/>  tags = {<br/>    CostCenter = "tf-helloworld"<br/>  }<br/>}</span></pre><h1 id="e899" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">计划、应用、展示和销毁</h1><ul class=""><li id="f315" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">terraform plan</code></li><li id="5ad7" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">terraform apply</code></li><li id="6e08" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">terraform show</code></li><li id="bcdc" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">terraform destroy</code></li></ul><h1 id="d0e1" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">创建Pulumi帐户并创建访问密钥</h1><ul class=""><li id="af4a" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated">获得普鲁米访问令牌</li></ul><h1 id="5704" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">安装Pulumi并安装AWS插件</h1><ul class=""><li id="401f" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated">Mac: <code class="fe nd ne nf ng b">brew install pulumi</code></li><li id="8cf7" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">Windows操作系统</li><li id="2f52" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">choco install pulumi</code></li><li id="e4bd" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">@"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; iex ((New-Object System.Net.WebClient).DownloadString('https://get.pulumi.com/install.ps1'))" &amp;&amp; SET "PATH=%PATH%;%USERPROFILE%\.pulumi\bin"</code></li><li id="711f" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">pulumi plugin install resource aws 1.18.0</code></li></ul><h1 id="b979" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">初始化Pulumi堆栈并部署</h1><ul class=""><li id="ffa0" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">cd pulumi-iaas-hosting-stack</code></li><li id="9aac" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">pulumi stack init</code></li><li id="173d" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">您需要输入之前在Pulumi门户中创建的访问令牌</li><li id="1118" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">安装Pulumi <code class="fe nd ne nf ng b">npm install @pulumi/aws</code></li><li id="5015" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">pulumi up</code></li></ul><h1 id="bf1b" class="lf lg it bd lh li mt lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly mx ma mb mc bi translated">销毁资源并删除堆栈</h1><ul class=""><li id="ba1b" class="md me it js b jt mf jx mg kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">pulumi destroy</code></li><li id="3cef" class="md me it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated"><code class="fe nd ne nf ng b">pulumi stack rm &lt;account&gt;/&lt;stack&gt;/&lt;env&gt; --force</code></li></ul></div></div>    
</body>
</html>