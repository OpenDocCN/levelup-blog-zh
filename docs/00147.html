<html>
<head>
<title>Upload an Image Directly from a React App to Amazon S3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">直接从React应用程序上传图片到亚马逊S3</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/upload-image-directly-from-react-app-to-amazon-s3-856280c62e45?source=collection_archive---------0-----------------------#2018-06-01">https://levelup.gitconnected.com/upload-image-directly-from-react-app-to-amazon-s3-856280c62e45?source=collection_archive---------0-----------------------#2018-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f98b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文将详细介绍如何从客户端亚马逊S3直接发送图像的方法。</p><h2 id="6287" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">上传图像的问题:</h2><ol class=""><li id="a645" class="le lf iq jp b jq lg ju lh jy li kc lj kg lk kk ll lm ln lo bi translated">图像物理存储在哪里？</li><li id="d932" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">图像如何到达它们应该被存储的地方？</li><li id="9b37" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">我们如何联系图像？</li></ol><h2 id="42f3" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">解决方案1:在MongoDB中</h2><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lu"><img src="../Images/9eccd530e0d1c4b056ee1166ff8ae00f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qUVsmXc8jcXDn21e6e98Mg.png"/></div></div></figure><p id="1752" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个糟糕的方法，因为我们要为使用的每GB mongo存储付费。例如，mlab每月每GB收费15美元。也就是大约330张3mb大小的图片。</p><h2 id="e189" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">解决方案2:外部数据存储，如亚马逊S3</h2><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mg"><img src="../Images/653ac9f787a0005bd4d4ecf0ee265801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ayvazen3BJzS5Ed-Mmsh-w.png"/></div></div></figure><p id="3243" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个很好的方法，因为它的存储非常便宜，易于备份，而且从来不用担心大小。</p><h1 id="1c07" class="mh km iq bd kn mi mj mk kq ml mm mn kt mo mp mq kw mr ms mt kz mu mv mw lc mx bi translated">通过服务器向S3发送图像</h1><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi my"><img src="../Images/2465278653c176c55cd73b2576095293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-Hc0KYfJ8z2-85M6-CbGw.png"/></div></div></figure><p id="e5e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我们使用Express API将一个图像从React应用程序(或任何客户端应用程序)发送到服务器，然后服务器将这个图像发送到S3桶。</p><p id="cdd1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个Express API已经参与了图像上传，这意味着我们的服务器将使用一些资源，如<strong class="jp ir"> CPU和RAM </strong>来处理图像。这一点都不理想。</p><p id="ddfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我自己记录了上传小文件需要多少CPU和RAM:</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mz"><img src="../Images/9bf204f37fc6e3b98d2d146beffc170f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8diWjyDosam2XxXXstuEJg.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">当文件未上传时</figcaption></figure><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi ne"><img src="../Images/c98bd0925a1ac76e34e70b479215c1af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GTCGLcpKMx7t7J6avtK5Mw.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">当我上传单个文件时</figcaption></figure><p id="746c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看到区别了吗——这只是来自单个用户的一个小文件。</p><p id="bd03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过你的服务器传送图片会让处理图片更容易<strong class="jp ir">但是</strong>这也意味着我们要花更多的钱来处理图片上传。我不知道你怎么想，但是我绝对不想在我的服务器上花任何多余的钱。我需要确保我的节点服务器只负责处理JSON数据，不负责其他事情。</p><p id="3841" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法一次又一次地被社区所接受，但它不是最好的解决方案。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="6bfe" class="mh km iq bd kn mi nm mk kq ml nn mn kt mo no mq kw mr np mt kz mu nq mw lc mx bi translated"><strong class="ak">直接从客户端向S3发送图像</strong></h1><ol class=""><li id="4a4b" class="le lf iq jp b jq lg ju lh jy li kc lj kg lk kk ll lm ln lo bi translated">客户端告诉服务器它需要上传一个文件到S3，包括文件名和文件类型</li><li id="cc3f" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">服务器要求S3提供一个预签名的URL</li><li id="24a8" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">S3给服务器一个预先指定的URL，它只适用于与原始文件名匹配的文件</li><li id="8b04" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">服务器将URL发送给React客户端</li><li id="63a3" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">React客户端将图像文件直接上传到S3服务器</li><li id="8cfd" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">React客户机告诉服务器上传成功，服务器保存新图像的URL。</li></ol><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nr"><img src="../Images/07637d5c6a18628cb47d5e1150f8e22b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kDxz0d5j7ovNbHPrRWO0A.png"/></div></div></figure><p id="97da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，是的，我认为这是最好的方法，显然越来越多的社区接受它。</p><p id="9317" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读:)</p></div></div>    
</body>
</html>