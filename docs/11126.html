<html>
<head>
<title>Creating a Secure Wordle using Serverless Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用无服务器功能创建安全的Wordle</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-a-secure-wordle-using-serverless-functions-6a5e6f280d40?source=collection_archive---------28-----------------------#2022-02-16">https://levelup.gitconnected.com/creating-a-secure-wordle-using-serverless-functions-6a5e6f280d40?source=collection_archive---------28-----------------------#2022-02-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5fe7cb0e828fdc609d9244aa25983106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTw7SyyVrlB6EE5um1gctA.jpeg"/></div></div></figure><h1 id="13d7" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="1765" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">过去几周，Wordle 已经在Twitter上疯传。这是一个非常简单的游戏，而且非常成功。但是，<a class="ae lu" href="https://reichel.dev/blog/reverse-engineering-wordle.html" rel="noopener ugc nofollow" target="_blank">人们能够对它进行逆向工程</a>，找出未来的单词。我想试着做一个不能这样逆向工程的东西。我确实制作了一个，但是由于有数百个“如何制作Wordle”的教程，我将只关注“如何使它更安全”的部分。我将为它使用无服务器功能。</p><p id="b6ec" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated"><em class="ma">注意:如果你的博客病毒式传播，无服务器功能可能会有点贵。</em></p><h1 id="5eb2" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">沃尔多怎么了？</h1><p id="42a0" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我不会说<a class="ae lu" href="https://www.powerlanguage.co.uk/wordle/" rel="noopener ugc nofollow" target="_blank"> Wordle </a>有什么问题。只是它的开发者做的一个选择。我确信如果乔希·沃德尔想要的话，他会让它变得更安全，如果我处在他的位置，我也会像他一样成功。</p><p id="4640" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">为什么？因为如果流量太大，使用无服务器功能的成本很高。</p><p id="3dc5" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated"><a class="ae lu" href="https://reichel.dev/" rel="noopener ugc nofollow" target="_blank"> Robert Reichel </a>写了一篇关于逆向工程word的好文章，解释了<a class="ae lu" href="https://powerlanguage.co.uk/wordle/" rel="noopener ugc nofollow" target="_blank"> Josh Wardle的word</a>如何在客户端确定单词。</p><blockquote class="mb mc md"><p id="d904" class="kw kx ma ky b kz lv lb lc ld lw lf lg me lx lj lk mf ly ln lo mg lz lr ls lt ij bi translated">至此，我们已经做了足够的挖掘来了解Wordle是如何选择每日一词的。我们知道，Wordle使用客户端基于日期的算法来确定从静态单词列表中使用哪个单词。只要我们把所有的代码拼凑在一起，每一天都是可以预测的</p><p id="e269" class="kw kx ma ky b kz lv lb lc ld lw lf lg me lx lj lk mf ly ln lo mg lz lr ls lt ij bi translated"><em class="iq"> — </em> <a class="ae lu" href="https://reichel.dev/blog/reverse-engineering-wordle.html" rel="noopener ugc nofollow" target="_blank"> <em class="iq">逆向工程</em></a></p></blockquote><h1 id="cc82" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">我说的安全是什么意思？</h1><p id="005c" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">所谓“安全”，我的意思是没有人能够知道明天(或后天，或未来的任何一天)的单词是什么。玩一次游戏，看到单词，然后在不同的浏览器中再玩一次，就可以知道今天的单词是什么。或者如果你知道怎么做，你可以向API发送一个请求，它会告诉你今天的单词。这有什么用？这将防止像"<a class="ae lu" href="https://www.thegamer.com/wordle-twitter-bot-the-wordlinator-spoler/" rel="noopener ugc nofollow" target="_blank">Wordlinator</a>"这样的机器人破坏其他人的游戏。</p><p id="91e0" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">此外，使用这种方法的另一个优点是。无论你在世界的哪个地方玩，每个人都将同时获得新单词，因为选择将基于服务器的时钟，而不是客户端的时钟。许多Wordle游戏都有这个问题，有些人比世界上其他人更早开始学习新单词，因为对他们来说这是新的一天的12:00，而世界上其他人仍然是前一天。</p><h1 id="bf33" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">怎么做？</h1><p id="3ae2" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我不会写如何制作整个Wordle游戏，只写API /无服务器功能部分。它可以部署在您喜欢的任何平台上。我在<a class="ae lu" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>和<a class="ae lu" href="https://vercel.com/" rel="noopener ugc nofollow" target="_blank"> Vercel </a>上部署了地雷。</p><h1 id="6f2b" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">要求:</h1><ul class=""><li id="70c5" class="mh mi iq ky b kz la ld le lh mj ll mk lp ml lt mm mn mo mp bi translated">每天要选择的单词列表。如果这是一个更大的单词列表的子集，决定哪个单词被接受，哪个不被接受，那就更好了。单词接受逻辑和大列表可以是客户端的。(这样会更好，因为这样可以减少API的负载，还可以省钱)。较小的单词列表永远不会加载到客户端。</li></ul><h1 id="7c16" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">逻辑:</h1><p id="4b55" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">它的逻辑非常简单。我们将制定一条API路线:</p><ol class=""><li id="f5d5" class="mh mi iq ky b kz lv ld lw lh mq ll mr lp ms lt mt mn mo mp bi translated">加载单词列表，我们每天从中选择一个单词</li><li id="d7d7" class="mh mi iq ky b kz mu ld mv lh mw ll mx lp my lt mt mn mo mp bi translated">计算自某些固定数据以来的天数(例如，应用程序/游戏启动的日期)。</li><li id="5a30" class="mh mi iq ky b kz mu ld mv lh mw ll mx lp my lt mt mn mo mp bi translated">使用所计算的差异从单词列表中选择单词并作出响应。</li></ol><h1 id="49ca" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">代码:</h1><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="cd41" class="ni jz iq ne b gy nj nk l nl nm">// Next.js API route support: https://nextjs.org/docs/api-routes/introduction  <br/>import { DateTime } from 'luxon';  <br/>import type { NextApiRequest, NextApiResponse } from 'next'  <br/>import { GameData } from '../../lib/interfaces';  <br/>import gameWords from "../../data/selected.json"; // The list of words</span><span id="868b" class="ni jz iq ne b gy nn nk l nl nm">// Function to calculate the difference between today and and a fixed date  <br/>function getIndex():number {  <br/>    let start = DateTime.fromFormat("31/01/2022","dd/mm/yyyy").setZone("UTC+5:30").startOf("day")  <br/>    let today = DateTime.now().setZone("UTC+5:30").startOf("day")  <br/>    return today.diff(start,'days').get('days');  <br/>}</span><span id="a932" class="ni jz iq ne b gy nn nk l nl nm">export default function handler(req: NextApiRequest,res: NextApiResponse&lt;GameData&gt;) {  <br/>    let id = getIndex();  <br/>    res.status(200).json({  <br/>        id: id,  <br/>        word: gameWords\[id\]  <br/>    });  <br/>}</span></pre><p id="a12b" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">此外，如果您愿意，可以创建另一个API端点来返回下一个单词的剩余时间。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="996d" class="ni jz iq ne b gy nj nk l nl nm">import { NextApiRequest, NextApiResponse } from "next/types";  <br/>import {DateTime} from "luxon";</span><span id="83ce" class="ni jz iq ne b gy nn nk l nl nm">export default function handler(  <br/>    req: NextApiRequest,  <br/>    res: NextApiResponse&lt;number&gt;  <br/>  ) {  <br/>    let t = DateTime.now().setZone("UTC+5:30").startOf('day').plus({days:1}).valueOf()  <br/>    res.status(200).send(t)  <br/>  }</span></pre><p id="a1fa" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">有了这两个API，你可以制作一个更加安全的Wordle游戏。</p><h1 id="2d68" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">参考资料:</h1><ul class=""><li id="ed3a" class="mh mi iq ky b kz la ld le lh mj ll mk lp ml lt mm mn mo mp bi translated">乔希·沃德尔的文字</li><li id="8a7c" class="mh mi iq ky b kz mu ld mv lh mw ll mx lp my lt mm mn mo mp bi translated"><a class="ae lu" href="https://reichel.dev/blog/reverse-engineering-wordle.html" rel="noopener ugc nofollow" target="_blank">逆向工程Wordle — Robert Reichel </a></li><li id="d46a" class="mh mi iq ky b kz mu ld mv lh mw ll mx lp my lt mm mn mo mp bi translated"><a class="ae lu" href="https://nextjs.org/docs/api-routes/introduction" rel="noopener ugc nofollow" target="_blank"> Next.js API路由</a></li></ul><h1 id="df84" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">也</h1><ul class=""><li id="e078" class="mh mi iq ky b kz la ld le lh mj ll mk lp ml lt mm mn mo mp bi translated"><a class="ae lu" href="https://blog.haideralipunjabi.com/posts/creating-a-secure-wordle-using-next.js-api-routes-and-vercel-serverless-functions/" rel="noopener ugc nofollow" target="_blank">在我的博客上读吧</a></li><li id="ef93" class="mh mi iq ky b kz mu ld mv lh mw ll mx lp my lt mm mn mo mp bi translated"><a class="ae lu" href="https://www.buymeacoffee.com/HAliPunjabi" rel="noopener ugc nofollow" target="_blank">请我喝杯咖啡</a></li></ul></div></div>    
</body>
</html>