# ç†ŠçŒ«çš„å®ç”¨æ•°æ®åˆ†æ

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/practical-data-analysis-with-pandas-c40fbd2955fa>

## ä½¿ç”¨ Pandas å’ŒçœŸå®æ•°æ®é›†è¿›è¡ŒåŠ¨æ‰‹æ•°æ®åˆ†æã€‚

![](img/088901fd742c15d9d5139c6a5aeb0332.png)

å°¼å…‹Â·è«é‡Œæ£®åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

çœŸå®ä¸–ç•Œçš„æ•°æ®æ˜¯è‚®è„çš„ã€‚åœ¨åˆ†ææ•°æ®ä¹‹å‰ï¼Œæ‚¨éœ€è¦æ¸…ç†è¿™äº›æ•°æ®ã€‚Pandas æ˜¯æ¸…ç†æ•°æ®ä½¿ç”¨æœ€å¤šçš„ Python åº“ã€‚Pandas ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ•°æ®åˆ†æåº“ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨çœŸå®æ•°æ®é›†åˆ†æç†ŠçŒ«çš„æ•°æ®ã€‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œä¸è¦å¿˜è®°å…³æ³¨[æˆ‘çš„ youtube é¢‘é“](https://youtube.com/c/tirendazacademy)ï¼Œåœ¨é‚£é‡Œæˆ‘åˆ›å»ºäº†å…³äºäººå·¥æ™ºèƒ½ã€æ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„å†…å®¹ã€‚

è®©æˆ‘ä»¬å¼€å§‹å§ï¼

# åŠ è½½æ•°æ®é›†

é¦–å…ˆï¼Œè®©æˆ‘ä»¬è¿›å£ç†ŠçŒ«ã€‚

![](img/1752032087c65d2647eb879ce26ef341.png)

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä½¿ç”¨ read_csv æ–¹æ³•å¯¼å…¥æ•°æ®é›†ã€‚

![](img/91710c519be96c2ddd7a022905fff4bf.png)

# äº†è§£æ•°æ®é›†

ä½ å¯ä»¥ä»[è¿™é‡Œ](http://Real world data is dirty. You need to clear this data before analyzing it. Pandas is the most used Python library to clean data. With Pandas, you can both clean and analyze data. In this article, I will show you how to analyze data with Pandas using a real dataset.)ä¸‹è½½è¿™ä¸ªæ•°æ®é›†ã€‚æ•°æ®é›†æ˜¯å…³äºåŠ å·åœ£è¿ªäºšæˆˆå¸‚è­¦å¯Ÿåœ¨è·¯ä¸Šæ‹¦ä¸‹çš„è½¦è¾†ã€‚è¯¥æ•°æ®é›†åŒ…æ‹¬åœè½¦æ—¶é—´ã€é©¾é©¶å‘˜å¹´é¾„ã€åœè½¦åŸå› å’Œé€®æ•çŠ¶æ€ç­‰æ•°æ®ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæ•°æ®é›†çš„å‰ 5 è¡Œã€‚

![](img/c4e3059b37d450c6950384722afda6db.png)

è®©æˆ‘ä»¬çœ‹çœ‹æœ€å 3 è¡Œã€‚

![](img/916dbd63426a6d543805879fb34e0c5b.png)

è®©æˆ‘å‘ä½ å±•ç¤ºæ•°æ®é›†çš„å½¢çŠ¶ã€‚

![](img/a24f2df6ed04fe14397c35a86115e3b0.png)

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æ•°æ®é›†ä¸­åˆ—çš„æ•°æ®ç±»å‹ã€‚

![](img/17412ce4fe31be0e7bae0995df989548.png)

æ‚¨å¯ä»¥ä½¿ç”¨ isnull æ–¹æ³•æ¥æŸ¥çœ‹æ•°æ®é›†ä¸­ç¼ºå°‘çš„æ•°æ®ã€‚æ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚False è¡¨ç¤ºæ²¡æœ‰ç¼ºå¤±æ•°æ®ï¼Œtrue è¡¨ç¤ºæœ‰ç¼ºå¤±æ•°æ®ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ¯ä¸€åˆ—ä¸­ç¼ºå¤±æ•°æ®çš„æ€»æ•°ã€‚

![](img/c366deb2979fdde1dd9a72a4e965b2a9.png)

Pandas ä¸­æœ‰ä¸‰ä¸ªé‡è¦çš„æ•°æ®ç»“æ„ï¼›ç³»åˆ—ã€æ•°æ®æ¡†å’Œç´¢å¼•ã€‚è¯¥æ•°æ®é›†æ˜¯ä¸€ä¸ªæ•°æ®æ¡†ã€‚æ•°æ®æ¡†çš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªç³»åˆ—ã€‚è®©æˆ‘åœ¨è¿™ä¸ªæ•°æ®æ¡†ä¸­æ˜¾ç¤ºä¸€åˆ—ã€‚

![](img/4c7f5c247e95c11b6d73aad24d53d6bc.png)

æ‚¨å¯ä»¥ä½¿ç”¨ columns å±æ€§æŸ¥çœ‹æ•°æ®é›†ä¸­çš„åˆ—ã€‚

![](img/2d63d9c3b3cd66254561f4391f769cb7.png)

# é€‰æ‹©ç†ŠçŒ«

æ‚¨å¯ä»¥åœ¨æ•°æ®é›†ä¸­é€‰æ‹©ä¸€åˆ—ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬é€‰æ‹©åˆ—æ—¥æœŸã€‚

![](img/4aa53e23b9b0532f4dcec7deedb49e2a.png)

æ‚¨å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ–¹æ‹¬å·æ¥é€‰æ‹©å¤šåˆ—ã€‚

![](img/e175e9948812996ed50ce251cb0f2747.png)

æ‚¨å¯ä»¥ä½¿ç”¨ rename æ–¹æ³•æ›´æ”¹åˆ—çš„åç§°ã€‚

![](img/cdadb6855e6fb0fd2c13f86ba7e4cbb3.png)

è¿˜å¯ä»¥ä½¿ç”¨ loc æˆ– iloc æ–¹æ³•æ¥é€‰æ‹©åˆ—æˆ–è¡Œã€‚å¯¹äº iloc æ–¹æ³•ï¼Œæ‚¨éœ€è¦åˆ©ç”¨è¡Œå’Œåˆ—åï¼Œè€Œå¯¹äº loc æ–¹æ³•ï¼Œæ‚¨éœ€è¦ä¼ é€’è¡Œå’Œåˆ—ç´¢å¼•ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€è¡Œ:

![](img/c778c428237fa8be1f3a5ae50fc731e5.png)

è®©æˆ‘é€‰æ‹©ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—çš„å€¼ã€‚

![](img/90973a28f34d3ba4ad79207ea9775003.png)

æ‚¨å¯ä»¥é€‰æ‹©å¤šä¸ªåˆ—ã€‚

![](img/5d0fabcb149219eacc9c22cdee9ec390.png)

æ‚¨å¯ä»¥å°†è¡Œåˆ‡ç‰‡ã€‚

![](img/04949a68665279e92293e3e72437f02a.png)

æ‚¨å¯ä»¥å¯¹è¡Œå’Œåˆ—è¿›è¡Œåˆ‡ç‰‡ã€‚

![](img/cca788e4c59256f8dece3f9901e97254.png)

æ‚¨éœ€è¦åœ¨ loc æ–¹æ³•ä¸­ä½¿ç”¨è¯¥åç§°ã€‚è®©æˆ‘ç»™ä½ çœ‹çœ‹è¿™ä¸ªã€‚

![](img/d201c4a13bfecaf2cefc19169bdc99d6.png)

æ‚¨è¿˜å¯ä»¥å¯¹åˆ—è¿›è¡Œåˆ‡ç‰‡ã€‚

![](img/bfd0fd646de3deb9e9cccf2e1192fd6f.png)

# å¤„ç†ç†ŠçŒ«ä¸¢å¤±çš„æ•°æ®

æ‚¨å¯ä»¥ä½¿ç”¨ dropna æ–¹æ³•æ¥å¤„ç†ç¼ºå¤±æ•°æ®ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å†æ¬¡çœ‹çœ‹æ•°æ®é›†çš„å½¢çŠ¶ã€‚

![](img/3ee5531e8d46e60030bb13eb596552e8.png)

æ‚¨å¯ä»¥ä½¿ç”¨ how = "all "åˆ é™¤æ‰€æœ‰åªåŒ…å«ç¼ºå¤±å€¼çš„åˆ—ï¼Œ

![](img/f7551df20f5aa993ebb02e5f03081cbb.png)

æ‚¨å¯ä»¥ä½¿ç”¨ how = "any "åˆ é™¤åŒ…å«ä»»ä½•ç¼ºå¤±å€¼çš„æ‰€æœ‰åˆ—ï¼Œ

![](img/f821c17c4c06347547405edaa14e1693.png)

# ä»¥ç†ŠçŒ«ä¸ºä¾‹çš„ç®€å•åˆ†æ

æˆ‘è¦æ£€æŸ¥ç”·æ€§æˆ–å¥³æ€§æ˜¯å¦å› ä¸ºæ›´å¤šçš„è¿è§„è¡Œä¸ºè€Œè¢«æ‹¦ä¸‹ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åœé©¶è½¦è¾†çš„åŸå› å’Œæ•°é‡ã€‚

![](img/eddad93ce0bc5c0a2045fda774c18693.png)

è½¦è¾†è¢«æ‹¦ä¸‹ä¸»è¦æ˜¯å› ä¸ºè¶…é€Ÿã€‚è®©æˆ‘ä»¬çœ‹çœ‹å› è¶…é€Ÿè€Œè¢«æ‹¦ä¸‹çš„ç”·å¥³äººæ•°ã€‚é¦–å…ˆï¼Œæˆ‘å°†æ ¹æ®ç§»åŠ¨è¿ä¾‹å€¼è¿›è¡Œè¿‡æ»¤ã€‚ä¹‹åï¼Œè®©æˆ‘é€‰æ‹© subject_sex åˆ—ï¼Œå¹¶ä½¿ç”¨ value_counts å‡½æ•°æ¥æŸ¥æ‰¾æ€»æ•°ã€‚

![](img/cb7441cd971822eb54db0a273f5485f5.png)

å¯ä»¥ç”¨ normalized = True æ¥çœ‹ç”·å¥³æ¯”ä¾‹ã€‚

![](img/3c9b7e07a55bfa37529b0da83ffdbfba.png)

æˆ‘ä»¬æ¥çœ‹çœ‹è®©å¥³æ€§æ­¢æ­¥çš„ç†ç”±å ç™¾åˆ†æ¯”ã€‚ä¸ºæ­¤ï¼Œæˆ‘å°†æŒ‰å¥³æ€§ç­›é€‰æ€§åˆ«åˆ—ã€‚

![](img/fa3921834840c7fd766a644ed19b2737.png)

77%çš„å¥³æ€§å› è¿åäº¤é€šè§„åˆ™è€Œè¢«æ‹¦ä¸‹ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åœæ­¢ä½¿ç”¨ groupby æ–¹æ³•çš„åŸå› ã€‚

![](img/72e686d2c0fc8017a2dbb719ad5c68e5.png)

è®©æˆ‘ä»¬æŠŠè¿™äº›æ•°æ®è½¬æ¢æˆè¡¨æ ¼ã€‚

![](img/762b39d1d906e52ca984157beff617fe.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ€§åˆ«å¯¹è¢«æ•æƒ…å†µçš„å½±å“ã€‚é¦–å…ˆï¼Œè®©æˆ‘æ‰¾åˆ°è¢«æ•äººæ•°ã€‚

![](img/19c45ff7e3f8640f22ccac445ffb0342.png)

ä¹‹åè®©æˆ‘ä»¬çœ‹çœ‹è¢«æ•äººæ•°çš„ç™¾åˆ†æ¯”ã€‚

![](img/6189a4e88c64d5ad9839844c04dd05b1.png)

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æŒ‰æ€§åˆ«åˆ†åˆ—çš„è¢«æ•ç™¾åˆ†æ¯”ã€‚

![](img/dbb5b0cce0c67b7c47d910360656b2c1.png)

ç”·æ€§è¢«æ•äººæ•°æ˜¯å¥³æ€§çš„ä¸¤å€ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æŒ‰ç§æ—å’Œæ€§åˆ«åˆ†åˆ—çš„è¢«æ•ç™¾åˆ†æ¯”ã€‚

![](img/27aaba996e80007d2d829ece64b78011.png)

è¯·æ³¨æ„ï¼Œé»‘äººç”·æ€§å’Œå¥³æ€§æ¯”å…¶ä»–äººè¢«æ•æ›´å¤šã€‚è®©æˆ‘ä»¬æ‰¾å‡ºå“ªä¸€å¹´åœçš„æ¬¡æ•°å°‘ã€‚ä¸ºæ­¤ï¼Œè®©æˆ‘æ‰¾åˆ°æ—¥æœŸåˆ—çš„å‰ 4 å¹´çš„å€¼ã€‚

![](img/815fb59b5057a17f9c5bf89eafec6097.png)

è®©æˆ‘ä»¬å°†æ—¥æœŸå’Œæ—¶é—´å˜é‡ç»“åˆèµ·æ¥ï¼Œå¹¶æŠŠå®ƒä»¬æ”¾åˆ° datetime ç»“æ„ä¸­ã€‚é¦–å…ˆï¼Œæˆ‘è¦ç»“åˆæ—¥æœŸå’Œæ—¶é—´å˜é‡ã€‚

![](img/f11c2a1b1b73f02788c7edb5a93308c4.png)

ç°åœ¨è®©æˆ‘ä»¬å°†è¿™ä¸ªæ—¥æœŸå˜é‡è½¬æ¢æˆ Pandas ä¸­çš„ datetime ç»“æ„ï¼Œå¹¶å°†è¿™ä¸ªå˜é‡æ·»åŠ åˆ°æ•°æ®é›†ã€‚

![](img/5a7609458418233f4a0db678542ee8a2.png)

è®©æˆ‘ä»¬çœ‹çœ‹æ•°æ®é›†ä¸­å˜é‡çš„ç»“æ„ã€‚

![](img/378d1a3becc4b1d0ff31b3f25211b42b.png)

é…·æ¯™äº†ã€‚æˆ‘ä»¬åˆ›å»ºäº† stop_datetime åˆ—ã€‚è®©æˆ‘ä»¬ä»¥æœˆä»½ä¸ºä¾‹æ¥çœ‹çœ‹ã€‚

![](img/3b7f558165c75b9c5a31601597928bf5.png)

è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ä¸€å¤©ä¸­é€®æ•æƒ…å†µçš„å˜åŒ–ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ã€Šé€®æ• _ åˆ¶é€ ã€‹ä¸“æ ã€‚

![](img/ea8d2d421b7c45eddc387f4fea27888d.png)

è®©æˆ‘å°†è¿™ä¸ª arrest_made åˆ—è½¬æ¢æˆå¸ƒå°”æ•°æ®ç»“æ„ã€‚

![](img/2987290d77e4c295b7a21c4cf056a357.png)

è®©æˆ‘ä»¬çœ‹çœ‹é€®æ•çš„äººæ•°ã€‚

![](img/a1e75c41c59ee42d35c8ff1a74a852d5.png)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹é€®æ•çš„ç™¾åˆ†æ¯”ã€‚

![](img/95ef703cf3821ac4829e5e943db08a6a.png)

å¤§çº¦ 1%çš„äººè¢«æ•ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ä¸€å¤©ä¸­çš„å¹³å‡é€®æ•äººæ•°ã€‚

![](img/92874e4618fd2a8103698175bae90c10.png)

è®©æˆ‘ä»¬ç»˜åˆ¶è¿™äº›æ•°æ®ã€‚è¦å†…è”æŸ¥çœ‹å›¾å½¢ï¼Œè®©æˆ‘ä½¿ç”¨% Matplotlib inline å‘½ä»¤ã€‚

![](img/175f1854278cf01ac467e066ee785ef8.png)

è®©æˆ‘ä»¬ç»˜åˆ¶å›¾è¡¨ã€‚

![](img/2f4844969318c4b432ff4ce7c1f1bd5d.png)

è®©æˆ‘ä»¬çœ‹çœ‹åœæ­¢æ—¶é—´ã€‚

![](img/f0b1955a15adf736f7dac7606107ac4f.png)

è®©æˆ‘æ•´ç†ä¸€ä¸‹è¿™äº›æ•°æ®ã€‚

![](img/5d3092ce522c81d609d8709c064d2303.png)

è®©æˆ‘ä»¬ç°åœ¨ç»˜åˆ¶å›¾è¡¨ã€‚

![](img/ab5f55960415475473fe95e94ce2ac3f.png)

æˆ‘å¯ä»¥è¯´ä¸Šåˆåç‚¹åœçš„æ¯”è¾ƒå¤šã€‚

å°±æ˜¯è¿™æ ·ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢å®ƒã€‚ä½ å¯ä»¥åœ¨ [***æˆ‘ä»¬çš„ GitHub é¡µé¢***](https://github.com/TirendazAcademy/PANDAS-TUTORIAL) æ‰¾åˆ°ç¬”è®°æœ¬ã€‚

å¦‚æœä½ è¿˜æ²¡çœ‹è¿‡ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ çœ‹ä¸‹é¢è¿™äº›å…³äºç†ŠçŒ«çš„æ–‡ç« ã€‚ğŸ‘‡ğŸ‘‡ğŸ‘‡

*   [ç†ŠçŒ«ç®€ä»‹](https://ai.plainenglish.io/introduction-to-the-pandas-library-a3a557c8d094?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„ç´¢å¼•-é€‰æ‹©-è¿‡æ»¤](https://ai.plainenglish.io/indexing-selection-filtering-in-pandas-library-20d3fe4a6d71?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„é‡è¦æ–¹æ³•](https://ai.plainenglish.io/important-methods-in-pandas-2d4c774fcac9?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„ç®—æœ¯è¿ç®—](https://ai.plainenglish.io/arithmetic-operations-in-pandas-7ef32226e41c?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„æ’åºå’Œæ’å](https://ai.plainenglish.io/sorting-and-ranking-in-pandas-701f99aa918e?source=your_stories_page-------------------------------------)
*   [æ±‡æ€»å’Œè®¡ç®—å¤§ç†ŠçŒ«çš„æè¿°æ€§ç»Ÿè®¡æ•°æ®](https://medium.com/nerd-for-tech/summarizing-and-computing-descriptive-statistics-in-pandas-7320a1fec371?source=your_stories_page-------------------------------------)
*   [åœ¨ç†ŠçŒ«ä¸­è¯»å†™æ•°æ®](https://ai.plainenglish.io/reading-and-writing-in-pandas-2d83dc538aff?source=your_stories_page-------------------------------------)
*   å¦‚ä½•ä¿®å¤ç†ŠçŒ«ä¸¢å¤±çš„æ•°æ®
*   [ç†ŠçŒ«çš„æ•°æ®è½¬æ¢](https://ai.plainenglish.io/data-transformation-in-pandas-29b2b3c61b34?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„å±‚æ¬¡ç´¢å¼•](/hierarchical-indexing-in-pandas-94ff198b7f35?source=your_stories_page-------------------------------------)
*   [åˆå¹¶ç†ŠçŒ«æ•°æ®é›†](https://tirendazacademy.medium.com/combining-and-merging-datasets-in-pandas-8e71e11b76fa?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„é‡å¡‘å’Œæ—‹è½¬](https://tirendazacademy.medium.com/reshaping-and-pivoting-in-pandas-a41678e72d68?source=your_stories_page-------------------------------------)
*   [å¤§ç†ŠçŒ«ç¾¤](https://medium.com/star-gazers/groupby-in-pandas-5df348e293f8?source=your_stories_page-------------------------------------)
*   [ä¸ã€Šç†ŠçŒ«ã€‹ä¸­çš„ Groupby åˆä½œ](/working-with-groupby-in-pandas-7e7823414537?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„æ•°æ®é€è§†è¡¨](/pivot-tables-in-pandas-7b672e6d8f47?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«çš„åˆ†ç±»æ•°æ®](https://tirendazacademy.medium.com/categorical-data-in-pandas-9eaaff71e6f3?source=your_stories_page-------------------------------------)
*   [åœ¨ Pandas ä¸­å¤„ç†æ–‡æœ¬æ•°æ®](https://tirendazacademy.medium.com/working-with-text-data-in-pandas-f78aa368e1a?source=your_stories_page-------------------------------------)
*   [ç†ŠçŒ«å®ç”¨æ•°æ®åˆ†æ](/practical-data-analysis-with-pandas-c40fbd2955fa?source=your_stories_page-------------------------------------)
*   [å¤§ç†ŠçŒ«å¤šé‡é€‰æ‹©-ç­›é€‰](https://tirendazacademy.medium.com/multiple-selecting-filtering-in-pandas-68d710087a22?source=your_stories_page-------------------------------------)

è¯·é¼“æŒğŸ‘å¦‚æœä½ å–œæ¬¢è¿™ç¯‡åšæ–‡ã€‚å¦å¤–ï¼Œåˆ«å¿˜äº†å…³æ³¨æˆ‘ä»¬çš„ [*è’‚ä¼¦è¾¾å…¹å­¦é™¢ YouTube*](https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw) ğŸ“ºï¼Œ [*ç¢ç¢å¿µ*](https://twitter.com/TirendazAcademy) ğŸ˜*[*ä¸­ç­‰*](https://tirendazacademy.medium.com/) ğŸ“šï¼Œ[*LinkedIn*](https://www.linkedin.com/in/tirendaz-academy)*ğŸ‘**

**ä¸‹ä¸€ç¯‡æ–‡ç« å†è§â€¦**