<html>
<head>
<title>Diving into Scala Cats — Monoids</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">潜入Scala猫——幺半群</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/diving-into-scala-cats-monoids-82e744b9e518?source=collection_archive---------10-----------------------#2020-11-25">https://levelup.gitconnected.com/diving-into-scala-cats-monoids-82e744b9e518?source=collection_archive---------10-----------------------#2020-11-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1da08a2a639c498cc48a5c24f20f3e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mUTDIZiwkXmZ6bHN"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@cbarbalis?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·巴尔巴利斯</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="2d7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天我们将再次深入Scala Cats来发现幺半群。如果你还没有读过我关于<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/diving-into-scala-cats-semigroups-732ef2432042">陷入Scala猫-半群</a>的帖子，我建议你现在就去读。</p><h1 id="2c21" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">什么是幺半群？</h1><p id="66da" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><em class="me">幺半群</em>扩展了<em class="me">半群</em>，并为给定类型添加了一个默认值或回退值。<code class="fe mf mg mh mi b">Monoid</code>类型类有两种方法——一种是半群的<code class="fe mf mg mh mi b">combine</code>方法，另一种是执行恒等运算的<code class="fe mf mg mh mi b">empty</code>方法。</p><p id="6441" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在关于<a class="ae kc" href="https://blog.knoldus.com/diving-into-scala-cats-semigroups/" rel="noopener ugc nofollow" target="_blank">半群</a>的帖子中，我们看到了一个使用半群和Scala的<code class="fe mf mg mh mi b">fold()</code>对一组值进行运算的例子:</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="73e3" class="mr lc iq mi b gy ms mt l mu mv">def combineStrings(collection: Seq[String]): String = {<br/>  collection.foldLeft("")(Semigroup[String].combine)<br/>}</span></pre><p id="ef3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们讨论了半群的限制，其中我们不能为上面的表达式编写一个通用方法<code class="fe mf mg mh mi b">combineAll(collection: Seq[A]): [A]</code>，因为回退值将取决于<code class="fe mf mg mh mi b">A </code>的类型(对于<code class="fe mf mg mh mi b">String</code>，<code class="fe mf mg mh mi b"> 0</code>对于<code class="fe mf mg mh mi b">Int</code>，等等)。</p><p id="2ae7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">幺半群通过引入一个单位/空元素提出了一个解决这个缺点的方法。</p><p id="2b9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mf mg mh mi b">Monoid</code>的签名可以指定为:</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="a4bb" class="mr lc iq mi b gy ms mt l mu mv">trait Monoid[A] extends Semigroup[A] {   <br/>  def empty: A <br/>}</span></pre><h1 id="2622" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">单位元如何解决半群的局限性？</h1><p id="9b75" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们在<code class="fe mf mg mh mi b">combineStrings</code>中传递的空<code class="fe mf mg mh mi b">String </code>称为标识或空值，我们可以将其视为后备值或默认值。它解决了半群的缺点。</p><p id="0ff9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以使用幺半群轻松地提供泛型方法<em class="me">combineAll(collection:Seq[A]):[A]</em>的实现:</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="6f55" class="mr lc iq mi b gy ms mt l mu mv">def combineAll[A](collection: Seq[A])(implicit ev: Monoid[A]): A = {<br/>  val monoid = Monoid[A]<br/>  collection.foldLeft(monoid.empty)(monoid.combine)<br/>}</span></pre><h1 id="21e0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">幺半群保持结合律和同一律</h1><p id="bdf5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">由于半群遵循结合律，同样的规则加上一些附加物也适用于幺半群。</p><p id="e133" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mf mg mh mi b">combine </code>操作必须是关联的，并且<code class="fe mf mg mh mi b">empty</code>值应该是<code class="fe mf mg mh mi b">combine</code>操作的标识:</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="64fa" class="mr lc iq mi b gy ms mt l mu mv">combine(x, empty) = combine(empty, x) = x</span></pre><p id="f9e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="0557" class="mr lc iq mi b gy ms mt l mu mv">// Integer addition using 0 as an identity (Rules valid)<br/>1 + 0 == 0 + 1 == 1</span><span id="8da9" class="mr lc iq mi b gy mw mt l mu mv">// Integer multiplication using 1 as an identity (Rules valid)<br/>2 * 1 == 1 * 2 == 2</span><span id="8a38" class="mr lc iq mi b gy mw mt l mu mv">// Integer multiplication using 0 as an identity (Rules invalid)<br/>2 * 0 == 0 * 2 != 2</span></pre><p id="a3f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以很明显<code class="fe mf mg mh mi b">empty</code> /identity元素依赖于上下文，而不仅仅是类型。这就是为什么<code class="fe mf mg mh mi b">Monoid </code>(和<code class="fe mf mg mh mi b">Semigroup</code>)实现不仅特定于类型，而且特定于<code class="fe mf mg mh mi b">combine </code>操作。</p><p id="be9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Cats允许将幺半群组合在一起以形成更大的幺半群，并编写更一般化的函数，这些函数将采用可组合的东西而不是一些具体的类型。</p><p id="76fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在接下来的文章中，我们将了解更多关于猫的核心概念。<br/>敬请期待！！！</p><h1 id="8a41" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">参考</h1><p id="5a91" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我所知道的最好的两个Scala Cats资源在这里:</p><ul class=""><li id="3539" class="mx my iq kf b kg kh kk kl ko mz ks na kw nb la nc nd ne nf bi translated">猫库可以在<a class="ae kc" href="https://github.com/typelevel/cats" rel="noopener ugc nofollow" target="_blank"> GitHub </a>获得</li><li id="af11" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated">本书，<a class="ae kc" href="https://underscore.io/books/advanced-scala/" rel="noopener ugc nofollow" target="_blank"> <em class="me">高级Scala与猫</em> </a></li></ul></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="b6b9" class="lb lc iq bd ld le ns lg lh li nt lk ll lm nu lo lp lq nv ls lt lu nw lw lx ly bi translated">类似文章-</h1><p id="1527" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你也可以看看我在Scala Cats系列的其他文章——</p><ul class=""><li id="cf8f" class="mx my iq kf b kg kh kk kl ko mz ks na kw nb la nc nd ne nf bi translated">【Scala猫入门</li><li id="a29f" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated"><a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/diving-into-scala-cats-semigroups-732ef2432042">潜入标量猫—半群</a></li><li id="6e04" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated"><a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/diving-into-scala-cats-functors-c957285d7009">深入Scala猫——函子</a></li><li id="545a" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated"><a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/functors-in-functional-programming-dfaba4cfb2ed">函数编程中的函子</a></li></ul></div></div>    
</body>
</html>