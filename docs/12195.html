<html>
<head>
<title>Running Kafka on Docker container</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Docker容器上运行Kafka</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/running-kafka-on-docker-container-1a15b8d0b77c?source=collection_archive---------2-----------------------#2022-05-23">https://levelup.gitconnected.com/running-kafka-on-docker-container-1a15b8d0b77c?source=collection_archive---------2-----------------------#2022-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f186fccc06c1a6d175fadbd939601018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJQ3cMoNA75bM8aCvixqiA.png"/></div></div></figure><p id="8735" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Kafka是一个分布式提交日志。<em class="kw">我在之前的文章中已经讨论过卡夫卡:</em><a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/apache-kafka-architecture-and-how-does-it-work-54e99f72b9be"><em class="kw">https://level up . git connected . com/Apache-Kafka-architecture-and-how-it-work-54 e 99 f 72 B9 be</em></a></p><p id="79f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我们将<strong class="ka ir">在docker容器</strong>上部署Kafka。这将是一个快速入门卡夫卡的方法。</p><p id="62a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">如果你更喜欢视频而不是文字，你可以在Youtube上找到相同的视频:</em><a class="ae kx" href="https://www.youtube.com/watch?v=Xo21T7fdykg" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="kw">https://www.youtube.com/watch?v=Xo21T7fdykg</em></strong></a></p><p id="7f47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以为了在Docker容器上安装Kafka，我们需要两样东西:我们需要一个zookeeper的实例和一个Kafka的实例。因此，我们将创建一个<em class="kw"> docker-compose.yaml </em>文件，我们将有两个服务，一个是zookeeper服务，另一个是Kafka服务。卡夫卡使用zookeeper来恢复关于各个分区和每个分区的领导者的信息。所以让我们来看看docker-compose文件:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="3a70" class="lh li iq ld b gy lj lk l ll lm">version: '3'<br/><br/>services:<br/>  zookeeper:<br/>    image: wurstmeister/zookeeper<br/>    container_name: zookeeper<br/>    ports:<br/>      - "2181:2181"<br/>  kafka:<br/>    image: wurstmeister/kafka<br/>    container_name: kafka<br/>    ports:<br/>      - "9092:9092"<br/>    environment:<br/>      KAFKA_ADVERTISED_HOST_NAME: localhost<br/>      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181</span></pre><p id="95d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦我们创建了docker-compose文件，我们就可以使用以下命令来执行它:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="20fe" class="lh li iq ld b gy lj lk l ll lm">docker-compose up</span></pre><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9e3ad325f30ae674743101f9cc7542fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nHGVhaQcubYX7WHgUz2q9A.png"/></div></div></figure><p id="5754" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦我们的docker-compose成功执行，我们将打开一个新的终端并查看docker容器的状态。我们将执行<em class="kw"> docker ps </em>命令，这将给出我们机器上运行的所有doctor容器的列表。如果我们看一下docker ps的内容，我们会看到我们有两个服务:zookeeper服务和Kafka服务。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/fdcfdc56999e3354a0a8d8270804e54f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yEqKi7XZ2plAsbfK-b751A.png"/></div></div></figure><p id="559a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们继续前进，在我们的Kafka容器中执行一些命令。为此，我们将获取Kafka容器的容器ID，并运行以下命令:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="9187" class="lh li iq ld b gy lj lk l ll lm">docker exec -it &lt;kafka_conatiner_id&gt; sh</span></pre><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/6cbb02fdcb3758afb4251eec05aa100b.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*ee1fHUtGZWbEPRXW3QwO5Q.png"/></div></figure><p id="37ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们在Docker容器中。我们将移动到所有主管所在的文件夹。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4dfb" class="lh li iq ld b gy lj lk l ll lm">cd /opt/kafka_&lt;version&gt;/bin</span></pre><p id="22d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们将使用以下命令创建一个Kafka主题:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="51c6" class="lh li iq ld b gy lj lk l ll lm">kafka-topics.sh --create --zookeeper zookeeper:2181 --replication-factor 1 --partitions 1 --topic quickstart</span></pre><p id="c5d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦我们创建了Kafka主题，我们将获得特定主题的发布者和订阅者。为了创建Kafka的生产者，我们将使用Kaka控制台生产者。因此，我们将运行以下命令来创建一个Kafka生成器。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="e7c3" class="lh li iq ld b gy lj lk l ll lm">kafka-console-producer.sh --topic quickstart --bootstrap-server localhost:9092</span></pre><p id="df58" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦我们创造了一个卡夫卡生产者，现在是时候转向创造一个卡夫卡消费者了。我们将运行Kafka控制台消费程序来消费消息。为了运行Kafka consumer的实例，我们将运行以下命令。<strong class="ka ir"> <em class="kw">我们将运行Kafka控制台，在docker容器内消费一个，因此我们将再次在docker容器内移动</em> </strong>并执行以下命令:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a992" class="lh li iq ld b gy lj lk l ll lm">kafka-console-consumer.sh --topic quickstart --from-beginning --bootstrap-server localhost:9092</span></pre><p id="84e2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦完成这些，我们的设置就完全准备好了。现在，如果我们在运行Kafka producer实例的终端上编写一些消息，这些消息将被运行在另一个终端上的Kafka控制台消费者实例使用。所以信息流是这样的，生产者将他的信息推送到一个卡夫卡主题，消费者从终端消费这些信息。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/703e7e8423a9554b48d89167e6752a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKeRaxg3AgHgwSEkHJlbLw.png"/></div></div></figure><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lq lr l"/></div></figure></div></div>    
</body>
</html>