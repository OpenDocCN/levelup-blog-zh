<html>
<head>
<title>useStatus: A Custom React Hook for Managing UI States</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">useStatus:用于管理UI状态的自定义React挂钩</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/usestatus-a-custom-react-hook-for-managing-ui-states-a5b1bc6555bf?source=collection_archive---------1-----------------------#2020-04-26">https://levelup.gitconnected.com/usestatus-a-custom-react-hook-for-managing-ui-states-a5b1bc6555bf?source=collection_archive---------1-----------------------#2020-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="14c0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">因为没有人喜欢凌乱的模板</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2b04a60ccfbc4f4a637cb069d6e638e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VJZ4B4XBI1ejaMjE"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Artem Sapegin 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="9faf" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">为什么使用状态？</h1><p id="3e76" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">处理UI状态可能会让你的模板变得拥挤不堪，充满变数。我最近听到的一个关于<a class="ae ky" href="https://www.smashingmagazine.com/2018/01/rise-state-machines/" rel="noopener ugc nofollow" target="_blank">状态机</a>的演讲启发我创建了一个钩子，帮助我处理一些我经常遇到的问题。请记住，这个实现只是由状态机松散地启发的。</p><h1 id="6eca" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">状态机和用户界面有什么关系？</h1><p id="523b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">开发人员在获取数据时实现的一个常见模式如下:</p><p id="0104" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">步骤1 </strong>:当组件挂载时，显示一个加载的微调器或骨骼组件，在那里将显示数据。</p><p id="169e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">步骤:2 </strong>:检索到数据后，关闭加载微调器，用保存数据的组件替换它。</p><p id="3fd9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">步骤3 </strong>(可选):如果响应中没有要显示的数据，则显示一个组件或文本，让用户知道没有什么可显示的。</p><p id="762f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">步骤4 </strong>:如果出现错误，显示另一个组件或按钮，让用户知道发生了什么，并可能让他们尝试重新提取数据，而不必刷新页面。</p><p id="2db3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们遵循状态机的范例，那么在进行这些操作时，UI应该只处于一种状态。</p><ul class=""><li id="1b96" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><strong class="lt iu">加载</strong>(请求当前正在进行)</li><li id="c917" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">成功</strong>(返回结果)</li><li id="7825" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">空</strong>(请求成功但没有结果显示)</li><li id="21b5" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">错误</strong>(请求不成功)</li></ul><h1 id="c0b4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">使用状态挂钩:</h1><p id="c24c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设我们有一个在许多页面上呈现相似组件的应用程序。我们可以使用<strong class="lt iu"> useStatus </strong>钩子来重用逻辑，并通过<a class="ae ky" href="https://daveceddia.com/pluggable-slots-in-react-components/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">插槽</strong> </a>为那些视图呈现适当的组件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="ak">使用状态</strong>挂钩</figcaption></figure><p id="3c61" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">钩子将接受任何组件作为您想要为特定状态显示的道具。您可能希望传入的一些组件是:</p><ul class=""><li id="f891" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><strong class="lt iu"> &lt;【装载状态】/ &gt; </strong></li><li id="fb9b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">&lt;&gt;/</strong></li><li id="706f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> &lt;错误状态/ &gt; </strong></li><li id="064f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> &lt;结果/ &gt; </strong></li></ul><p id="33f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，您可以像这样将组件传递到状态组件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用<strong class="ak">使用状态</strong>的应用示例</figcaption></figure><p id="8732" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当我们开始实现异步逻辑时，我们调用<strong class="lt iu"> setState </strong>方法并传入所需的状态来更新<strong class="lt iu"> Status </strong>组件并呈现正确的视图。这些电话包括:</p><ul class=""><li id="e47b" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">setState({ status: ' <strong class="lt iu">正在加载</strong> ' })</li><li id="90b1" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">setState({状态:'<strong class="lt iu">错误</strong>，错误})</li><li id="197c" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">setState({ status:'<strong class="lt iu">empty</strong>' })</li><li id="8ff5" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">setState({状态:'<strong class="lt iu">成功</strong>，结果})</li></ul><p id="79c5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，我们的<strong class="lt iu">错误</strong>和<strong class="lt iu">成功</strong>的插槽都接受回调，而不仅仅是组件。像这样构造插槽允许我们进一步抽象处理错误和成功状态，允许我们的钩子传递这些信息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用<strong class="ak">设置状态</strong>更新<strong class="ak">状态</strong>的异步调用</figcaption></figure><p id="cc12" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们可以考虑给定组件的所有不同UI状态，并在必要时将它们放在一个文件夹中。这种模式的一个常见用例可能包括一个显示表格的界面。这些组成部分可以是:</p><ul class=""><li id="de0b" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><strong class="lt iu">&lt;/&gt;</strong></li><li id="646a" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> &lt; TableEmpty / &gt; </strong></li><li id="f6e7" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> &lt;表错误/ &gt; </strong></li><li id="476c" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> &lt;表/ &gt; </strong></li></ul><p id="a676" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以通过<strong class="lt iu">使用状态</strong>轻松实现这一点。</p><p id="cec6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是一个钩子的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nh l"/></div></figure></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="9588" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">希望这个钩子能够帮助您减轻在异步操作期间管理组件状态的一些痛苦。下面有什么改进请告诉我！</p></div></div>    
</body>
</html>