<html>
<head>
<title>MongoDB with NodeJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有NodeJS的MongoDB</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/mongodb-with-nodejs-b4b01d6c725c?source=collection_archive---------22-----------------------#2022-01-10">https://levelup.gitconnected.com/mongodb-with-nodejs-b4b01d6c725c?source=collection_archive---------22-----------------------#2022-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f18e907b4a0d2abc1995bbc736cd5870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUi3vkj06Vqp_sXeiI-UbQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@jstrippa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">詹姆斯·哈里森</a>在<a class="ae kc" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="b53c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MongoDB是NoSQL世界中非常流行的面向文档的数据库。它利用集合和文档，而不是关系数据库的表和行。集合由一组文档组成。数据将存储在文档中的键值对中。</p><p id="13c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们将研究如何将MongoDB与NodeJS应用程序集成，并使用它进行基本的CRUD操作。让我们直接开始工作吧，不要谈太多的细节。</p><p id="0a80" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，您需要设置MongoDB。在这个实现中，使用了MongoDB Atlas，这是一个云数据库。如果需要，我们也可以在本地安装MongoDB。</p><p id="b1c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在这里找到设置MongoDB Atlas <a class="ae kc" href="https://www.mongodb.com/basics/mongodb-atlas-tutorial" rel="noopener ugc nofollow" target="_blank">的细节。</a></p><h2 id="a4a6" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">设置NodeJS项目</h2><ol class=""><li id="44e9" class="lu lv iq kf b kg lw kk lx ko ly ks lz kw ma la mb mc md me bi translated">在您的计算机上创建一个文件夹，并在其中打开命令。用<strong class="kf ir"> <em class="mf"> npm init -y </em> </strong>命令初始化项目。</li></ol><p id="08da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NodeJS应用程序中使用了以下依赖项。</p><ul class=""><li id="67fb" class="lu lv iq kf b kg kh kk kl ko mg ks mh kw mi la mj mc md me bi translated"><code class="fe mk ml mm mn b">express</code></li><li id="598d" class="lu lv iq kf b kg mo kk mp ko mq ks mr kw ms la mj mc md me bi translated"><code class="fe mk ml mm mn b">mongoose</code></li><li id="ad10" class="lu lv iq kf b kg mo kk mp ko mq ks mr kw ms la mj mc md me bi translated"><code class="fe mk ml mm mn b">nodemon</code></li><li id="585c" class="lu lv iq kf b kg mo kk mp ko mq ks mr kw ms la mj mc md me bi translated"><code class="fe mk ml mm mn b">dotenv</code></li></ul><p id="ead2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.安装上述依赖项。</p><pre class="mt mu mv mw gt mx mn my mz aw na bi"><span id="e1d2" class="lb lc iq mn b gy nb nc l nd ne">npm i express mongoose nodemon dotenv</span></pre><p id="ad22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.如下所示在package.json上添加启动脚本。</p><pre class="mt mu mv mw gt mx mn my mz aw na bi"><span id="dd0d" class="lb lc iq mn b gy nb nc l nd ne">"scripts": {   <br/>   "start": "nodemon app.js"  <br/>}</span></pre><p id="8011" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">项目结构</strong></p><p id="19ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">项目的文件夹结构</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/ea325102d11f4069eb8d73976e6de980.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*6VkBTIZzhBeA2Im6EJFStA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">项目结构</figcaption></figure><h2 id="47c9" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated"><strong class="ak">实施</strong></h2><p id="199d" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">与MongoDB的连接在db.js中形成。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">db.js</figcaption></figure><p id="188c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以在中提供连接字符串。这是它看起来的样子。</p><pre class="mt mu mv mw gt mx mn my mz aw na bi"><span id="0ca1" class="lb lc iq mn b gy nb nc l nd ne"><em class="mf">DB_CONNECTION = mongodb+srv://&lt;username&gt;:&lt;password&gt;@cluster0.z4xzn.mongodb.net/&lt;dbname&gt;?retryWrites=true&amp;w=majority</em></span></pre><p id="14fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在MongoDB cloud里找到这个。</p><p id="4311" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是app.js文件的外观。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">app.js</figcaption></figure><p id="f7c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在命令提示符下键入<strong class="kf ir"><em class="mf">node mon app . js</em></strong>启动项目。如果一切正常，您将看到日志“连接”(如果数据库连接成功)和“监听端口3000”。那你就可以走了。</p><p id="79b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们需要为应用程序创建模式。已创建以下内容来保存客户详细信息。它在customer_model.js中。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户_模型. js</figcaption></figure><p id="209e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"><em class="mf">customer schema</em></strong>是父模式，<strong class="kf ir"> <em class="mf"> ordersSchema </em> </strong>是子模式。因为订单是一个包含订单细节的对象。</p><p id="0378" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以通过应用程序执行数据库操作。为了测试端点，我使用了Postman。所有端点都在customer_routes.js中定义。</p><p id="d6ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">保存数据</strong></p><p id="f7ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要将数据保存到数据库中，我们可以执行以下操作。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户_路线. js</figcaption></figure><p id="102a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们用Postman测试一下这个API。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/c9e0c9c45a71574df2bc22856b4a1c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*On81BGHG4h0E6R5OU5FGIA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">添加客户</figcaption></figure><p id="d54c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到了如上的回应。现在让我们检查数据库。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/0f1d0e43418feedd4166cae5c92df649.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EEU0QeWJWHz5sSnqHIj2g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Mongo云数据库</figcaption></figure><p id="53cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">成功了！。数据已经保存在mongo云数据库中。我们可以根据需要添加任意多的数据。我已经添加了另一个这样的对象。</p><pre class="mt mu mv mw gt mx mn my mz aw na bi"><span id="2320" class="lb lc iq mn b gy nb nc l nd ne">{<br/> "name": "Anna Faris",<br/> "email":"<a class="ae kc" href="mailto:annafaris@y.com" rel="noopener ugc nofollow" target="_blank">annafaris@y.com</a>",<br/> "order": {<br/>  "orderId": ["ord002", "ord003"],<br/>  "title": ["OnePlus 9RT", "Realme Bluetooth Speaker"],<br/>  "price": ["$1065","$40"]<br/> }<br/>}</span></pre><p id="d4d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是现在的数据库。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/f9898c0045e7019423dd9dcfaefdaf2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5vBwh749RDzR59u7k-J-A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Mongo云数据库</figcaption></figure><p id="e9e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">读取数据</strong></p><p id="63ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们尝试从数据库中检索所有记录。代码如下。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户_路线. js</figcaption></figure><p id="8355" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是邮递员的回复。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/b11173472fe0f72a463c445c6129b751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1FEIz648K1gd6uQCATUMbA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">开张</figcaption></figure><p id="67b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以检索我们需要的特定对象。例如，这里我通过id获取安娜的记录。</p><p id="676d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代码如下所示。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户_路线. js</figcaption></figure><p id="1a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是结果。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/65c62d18df440b237ca2137cd8362c00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_jytxQ6-eVbbvda3o3TaA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">按Id获取客户</figcaption></figure><p id="7b18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">更新数据</strong></p><p id="3150" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是我们如何更新数据库中的文档。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户_路线. js</figcaption></figure><p id="6f33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我试图更新从annafaris@y.com的<a class="ae kc" href="mailto:annafaris@z.com" rel="noopener ugc nofollow" target="_blank">到annafaris@z.com的</a><a class="ae kc" href="mailto:annafaris@z.com" rel="noopener ugc nofollow" target="_blank"/>的电子邮件，安娜·法瑞丝。因为这是一个更新，我已经在邮递员使用补丁。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/75da5d8e4471a36c2bcb014119e11ec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ihIKvauXDGEi6523BEI1Rw.png"/></div></div></figure><p id="93a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们检查一下数据库，看看它是否更新了。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/08c9c83c76855089a11c777d842fb9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZ7kyNG3hG0FeqIaxef2CQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Mongo云数据库</figcaption></figure><p id="5793" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们所看到的，annafaris@z.com的电子邮件地址“安娜·法瑞丝”已经更改为“T8”。</p><p id="b187" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们进入删除操作。</p><p id="e3ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">删除数据</strong></p><p id="69ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要删除数据，我们可以编写如下代码片段。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户_路线. js</figcaption></figure><p id="0b6a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我已经添加了另一个记录作为詹姆斯·安德森。让我们试着删除它。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/48c2e9bc4a7e952cec3f2598e3c1c1b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZA8VWumdUS1SaRKPrsm2GA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Mongo云数据库</figcaption></figure><p id="d933" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而这将是Postman中的一个删除操作。删除将按id进行。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/985c58058817691db7125effada6c68e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40oNhDnSZWJuvoFLBqXi3g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">删除客户</figcaption></figure><p id="d554" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到了预期的回应。数据库里已经没有詹姆斯·安德森的记录了。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/08c9c83c76855089a11c777d842fb9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZ7kyNG3hG0FeqIaxef2CQ.png"/></div></div></figure><p id="364a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以执行任何CRUD操作。</p><p id="f331" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Github链接:<a class="ae kc" href="https://github.com/Kanchana46/NodeWithMongoDB.git" rel="noopener ugc nofollow" target="_blank">GitHub—kanchana 46/NodeWithMongoDB</a></p><p id="e031" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望这对您有所帮助。编码快乐！</p></div></div>    
</body>
</html>