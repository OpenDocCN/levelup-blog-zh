<html>
<head>
<title>Please, Refactor These Blocks of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">请重构这些代码块</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/please-refactor-these-blocks-of-code-c7d2b6f2e4ce?source=collection_archive---------2-----------------------#2021-04-21">https://levelup.gitconnected.com/please-refactor-these-blocks-of-code-c7d2b6f2e4ce?source=collection_archive---------2-----------------------#2021-04-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ac4f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我知道它们有用，但是请让我们去掉这些代码的味道</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fb855009c7258d8608b682a6b93e80f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UV6lmYquXIyAYfszxXuS4A.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@luis-gomes-166706?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">路易斯·戈麦斯</a>从<a class="ae ky" href="https://www.pexels.com/photo/black-and-gray-laptop-computer-546819/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>拍摄</figcaption></figure><p id="83bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我和我的团队目前正在将我们的Odoo ERP从12.0版本升级到14.0版本。该练习还包括升级我们的定制模块，确保与14.0版兼容。</p><p id="0595" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正在升级的一些模块是六年前开发的。因此，偶然发现让我汗毛直竖的代码块并不奇怪。</p><p id="62a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样的代码块通常暗示着代码的味道。这么多年过去了，我忍不住把它们清理干净，让它们看起来焕然一新。</p><p id="e2b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这篇文章，我相信你也可以用你自己的代码库做同样的事情。<br/>如果你遇到了代码的味道，偿还他们创造的一些技术债务就成了你的责任。</p><p id="590b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的口头禅是，如果你遇到代码味道，那么你有责任确保它被清除。消除代码味道可能是一个简单而独立的活动，或者如果您对代码块的功能及其影响范围没有足够的了解，您可能需要与其他开发人员和利益相关者协作。</p><p id="3e30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我分享了一些你必须立刻重构的代码块。这种重构不需要任何深刻的见解或背景，因此您引入潜在错误或副作用的可能性很小甚至没有。</p><p id="07d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重构这些代码块给你和其他开发人员带来了回报</p><ol class=""><li id="db06" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">提高了代码库的可读性</li><li id="d0e0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">增强了对代码库的理解</li><li id="cec0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">降低代码库的认知复杂性</li><li id="f97b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">减少代码行数</li><li id="a4c6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">提高代码库的可维护性</li></ol></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="e140" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi">#1</h1><h2 id="1209" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">严重的</h2><p id="ddbd" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="3862" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使用<code class="fe nz oa ob oc b">+</code>来实现名称的连接，代码冗长而混乱</li><li id="cada" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用可避免的<code class="fe nz oa ob oc b">Str.rstrip()</code>方法，在将名称与<code class="fe nz oa ob oc b">,</code>分隔符拼接在一起后，清除尾部空格</li><li id="825b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们用太多的代码行实现了一个简单的解决方案</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="9219" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">较好的</h2><p id="e2b3" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="5c5d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">代码简单、干净、全面</li><li id="0f79" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代码不需要像<code class="fe nz oa ob oc b">Str.rstrip()</code>那样移除尾部空格</li><li id="9a04" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用Python的<code class="fe nz oa ob oc b">Str.join()</code>连接起来很好也很简单，不需要<code class="fe nz oa ob oc b">+</code>操作符</li><li id="f866" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们用3行代码实现了一个更简单的解决方案。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="963f" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi">#2</h1><h2 id="0a75" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">严重的</h2><p id="261a" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="6b7e" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们通过过于明确地使用我们的<code class="fe nz oa ob oc b">if invoice.is_due is True</code>检查来执行多余的检查</li><li id="0aa2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nz oa ob oc b">is True</code>没有必要考虑简单使用<code class="fe nz oa ob oc b">if invoice.is_due</code>就可以完成隐含真值评估</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="84d2" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">较好的</h2><p id="e0ba" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="0ba4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">代码简单明了</li><li id="09a5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">通过添加<code class="fe nz oa ob oc b">is True</code>充分利用了<code class="fe nz oa ob oc b">invoice.is_due</code>的真实性，而不是显而易见和冗长</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d95e" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi">#3</h1><h2 id="38de" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">严重的</h2><p id="e6ff" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="0ce4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe nz oa ob oc b">else</code>考虑到所有<code class="fe nz oa ob oc b">Exception</code>的提出都将终止程序，所以没有必要阻塞</li><li id="c876" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代码比需要的多了一行</li><li id="a5aa" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">遵循和理解程序的控制流增加了代码的复杂性和认知负荷</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="950e" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">较好的</h2><p id="0413" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="48f6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们在程序的预期流程之前检查并提高所有的<code class="fe nz oa ob oc b">Exception</code></li><li id="7f4d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">通过移除<code class="fe nz oa ob oc b">else</code>条件块，降低了代码复杂性和认知过载</li><li id="74e0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">更少的代码行和更简单的控制流</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a75c" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi">#4</h1><h2 id="fdc1" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">严重的</h2><p id="6505" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="dd95" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">代码冗长，不简单，也不直接全面</li><li id="4c66" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代码有太多代码行</li><li id="b830" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用可避免的<code class="fe nz oa ob oc b">total_allocation</code>变量作为聚合器</li><li id="daac" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代码行太多，无法实现简单的求和</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="fbce" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">较好的</h2><p id="a57b" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="04e9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">代码简单、直接且全面</li><li id="08e5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">不使用迭代来实现求和</li><li id="ec8f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">利用Python内置的<code class="fe nz oa ob oc b">sum()</code>函数实现求和</li><li id="d3f4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">相比之下只有几行代码</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="bcd1" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi">#5</h1><h2 id="0a92" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">严重的</h2><p id="40b3" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="9a1a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">代码冗长，不简单，而且简单易懂</li><li id="e2d8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代码有太多代码行</li><li id="24bd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用可避免的<code class="fe nz oa ob oc b">total_allocation</code>变量作为聚合器</li><li id="6a8f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代码行太多，无法实现简单的求和</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="b9e1" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">较好的</h2><p id="a250" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="1e37" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">代码简单、直接且全面</li><li id="2dc8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">不使用迭代来实现求和</li><li id="8dde" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">利用Python内置的<code class="fe nz oa ob oc b">sum()</code>函数实现求和</li><li id="b749" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">利用Python的<a class="ae ky" href="https://docs.python.org/3/tutorial/datastructures.html" rel="noopener ugc nofollow" target="_blank">列表理解</a>，而不是冗长的<code class="fe nz oa ob oc b">for</code>循环</li><li id="9ae2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">相比之下只有几行代码</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="2ead" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi">#6</h1><h2 id="ceeb" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">严重的</h2><p id="4480" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="c2d8" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">太啰嗦了</li><li id="1e1b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">由于在<code class="fe nz oa ob oc b">if</code>块中嵌套了<code class="fe nz oa ob oc b">for</code>循环，增加了代码的复杂性和认知负荷</li><li id="2307" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">因为<code class="fe nz oa ob oc b">for</code>循环间接兼作<code class="fe nz oa ob oc b">if</code>程序块，所以<code class="fe nz oa ob oc b">if</code>程序块是不必要且可避免的。如果列表中至少有一个元素，它将遍历列表</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="4687" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">较好的</h2><p id="a6fb" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu">因为:</strong></p><ol class=""><li id="c722" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">一行更简单，可读和全面</li><li id="df67" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">删除多余的<code class="fe nz oa ob oc b">if</code>条款；利用<code class="fe nz oa ob oc b">for</code>循环的真实评估机制</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="046f" class="ni mr it bd ms nj nk dn mw nl nm dp na li nn no nc lm np nq ne lq nr ns ng nt bi translated">你可能也会喜欢这些</h2><div class="of og gp gr oh oi"><a rel="noopener  ugc nofollow" target="_blank" href="/the-5-habits-every-junior-developer-must-have-to-become-a-better-developer-639374a12e77"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">每个初级开发人员成为更好的开发人员必须具备的5个习惯</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">是时候重拾曾经富有感染力的激情和热情，成为一名更好的开发人员了</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow ks oi"/></div></div></a></div><div class="of og gp gr oh oi"><a rel="noopener  ugc nofollow" target="_blank" href="/im-finally-giving-functional-css-a-chance-a9ab284dde12"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">我终于给了函数式CSS一个机会</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">我正在用顺风CSS做这件事</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="or l"><div class="ox l ot ou ov or ow ks oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://medium.com/analytics-vidhya/13-git-commands-i-use-daily-14e3ad562068" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">我每天使用的13个Git命令</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">您需要知道这些命令</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">medium.com</p></div></div><div class="or l"><div class="oy l ot ou ov or ow ks oi"/></div></div></a></div></div></div>    
</body>
</html>