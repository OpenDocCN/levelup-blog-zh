<html>
<head>
<title>How to Transform an Unbalanced Dataset to a Balanced</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将不平衡的数据集转换为平衡的数据集</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-transform-an-unbalanced-dataset-to-a-balanced-cd361842eb11?source=collection_archive---------7-----------------------#2021-07-27">https://levelup.gitconnected.com/how-to-transform-an-unbalanced-dataset-to-a-balanced-cd361842eb11?source=collection_archive---------7-----------------------#2021-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6de7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python创建平衡数据集的有效方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d0a3ce9baf26222c3293daae378ffefc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oHFRp0hNOemzsRP8.jpg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Unsplash上的图像</figcaption></figure><div class="ky kz gp gr la lb"><a href="https://jorgepit-14189.medium.com/membership" rel="noopener follow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd iu gy z fp lg fr fs lh fu fw is bi translated">用我的推荐链接加入媒体-乔治皮皮斯</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">阅读乔治·皮皮斯(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">jorgepit-14189.medium.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp ks lb"/></div></div></a></div><p id="14e2" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们提供了一些例子，说明如何在Python中按组对数据进行重采样，以及如何在R中按组进行T2欠采样。在本帖中，我们将为您提供一种高效的方法，通过考虑多个变量来创建平衡的数据集。让我们从创建具有以下特征的“不平衡”数据集开始:</p><ul class=""><li id="78ed" class="mn mo it ls b lt lu lw lx lz mp md mq mh mr ml ms mt mu mv bi translated">1000次观察</li><li id="7999" class="mn mo it ls b lt mw lw mx lz my md mz mh na ml ms mt mu mv bi translated"><strong class="ls iu">类别</strong>栏为“A”、“B”、“C”等3个级别，分别为30%、50%和20%。</li><li id="65e4" class="mn mo it ls b lt mw lw mx lz my md mz mh na ml ms mt mu mv bi translated"><strong class="ls iu">情绪</strong>栏的2个级别如“0”和“1”分别占35%和65%。</li><li id="7410" class="mn mo it ls b lt mw lw mx lz my md mz mh na ml ms mt mu mv bi translated"><strong class="ls iu">性别</strong>栏中的2级如“M”和“F”分别占70%和30%。</li></ul><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="0470" class="ng nh it nc b gy ni nj l nk nl">df = pd.DataFrame({'Category': np.random.choice(['A','B','C'], size=1000, replace=True, p=[0.3, 0.5, 0.2]),<br/>                   'Sentiment': np.random.choice([0,1], size=1000, replace=True, p=[0.35, 0.65]),<br/>                   'Gender': np.random.choice(['M','F'], size=1000, replace=True, p=[0.70, 0.30])})</span><span id="d761" class="ng nh it nc b gy nm nj l nk nl">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/9a948a96860dc451b957315073601daf.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/0*_k8ecRweWWYIPDAZ.png"/></div></figure><h1 id="8ae2" class="no nh it bd np nq nr ns nt nu nv nw nx jz ny ka nz kc oa kd ob kf oc kg od oe bi translated">基于情感创建一个平衡的数据集</h1><p id="a494" class="pw-post-body-paragraph lq lr it ls b lt of ju lv lw og jx ly lz oh mb mc md oi mf mg mh oj mj mk ml im bi translated">假设我们想要一个积极情绪和消极情绪一样多的新数据集。让我们看看如何轻松实现这一点。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="5d7f" class="ng nh it nc b gy ni nj l nk nl">df_grouped_by = df.groupby(['Sentiment'])</span><span id="7fe5" class="ng nh it nc b gy nm nj l nk nl">df_balanced = df_grouped_by.apply(lambda x: x.sample(df_grouped_by.size().min()).reset_index(drop=True))</span><span id="4126" class="ng nh it nc b gy nm nj l nk nl">df_balanced = df_balanced.droplevel(['Sentiment'])<br/>df_balanced</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/0940468520bd99d41100914d319749dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/0*64r-zQ5TT_BuW19v.png"/></div></figure><p id="e581" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们验证数据集是平衡的。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="1c63" class="ng nh it nc b gy ni nj l nk nl">df_balanced.groupby(['Sentiment']).size()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/1c7c3c2ca1d0cbfac7cf8bd876955cc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/0*2kkpzRLpl4ujK3sj.png"/></div></figure><h1 id="56b6" class="no nh it bd np nq nr ns nt nu nv nw nx jz ny ka nz kc oa kd ob kf oc kg od oe bi translated">基于类别和情感创建一个平衡的数据集</h1><p id="b0d6" class="pw-post-body-paragraph lq lr it ls b lt of ju lv lw og jx ly lz oh mb mc md oi mf mg mh oj mj mk ml im bi translated">假设我们想通过考虑类别和情感来创建一个平衡的数据集。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="cc8d" class="ng nh it nc b gy ni nj l nk nl">df_grouped_by = df.groupby(['Category', 'Sentiment'])</span><span id="8d6c" class="ng nh it nc b gy nm nj l nk nl">df_balanced = df_grouped_by.apply(lambda x: x.sample(df_grouped_by.size().min()).reset_index(drop=True))</span><span id="ab34" class="ng nh it nc b gy nm nj l nk nl">df_balanced = df_balanced.droplevel(['Category', 'Sentiment'])<br/>df_balanced</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/5607e10d5bc9a75b353c8b3981c6f148.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/0*ZjnEqpffujA-QnBc.png"/></div></figure><p id="430b" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们验证数据集是平衡的。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="6293" class="ng nh it nc b gy ni nj l nk nl">df_balanced.groupby(['Category', 'Sentiment']).size()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/c7bdfe3eeb06d7fe7eb1c1847794c717.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/0*u7TiEM6ZmbfwkIKB.png"/></div></figure><h1 id="8e60" class="no nh it bd np nq nr ns nt nu nv nw nx jz ny ka nz kc oa kd ob kf oc kg od oe bi translated">基于每个类别中的情感创建一个平衡的数据集</h1><p id="bb54" class="pw-post-body-paragraph lq lr it ls b lt of ju lv lw og jx ly lz oh mb mc md oi mf mg mh oj mj mk ml im bi translated">让我们说，我们希望在每个类别中，情感类是平衡的。我们可以这样做:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="f40c" class="ng nh it nc b gy ni nj l nk nl">df_balanced = pd.DataFrame()</span><span id="3499" class="ng nh it nc b gy nm nj l nk nl">for i in df.Category.unique():<br/>    df_grouped_by = df.loc[df.Category==i].groupby(['Sentiment'])<br/>    tmp = df_grouped_by.apply(lambda x: x.sample(df_grouped_by.size().min()).reset_index(drop=True))<br/>    df_balanced = pd.concat([df_balanced, tmp])<br/>    <br/>df_balanced = df_balanced.droplevel(['Sentiment'])</span><span id="9734" class="ng nh it nc b gy nm nj l nk nl">df_balanced</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/89c615243b61fdd2834200c60c0496a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/0*7LbFQISTS3qRYjeU.png"/></div></figure><p id="c979" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们确认一下，我们在每个类别中都得到了一个平衡的情感数据集。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="5e98" class="ng nh it nc b gy ni nj l nk nl">df_balanced.groupby(['Category', 'Sentiment']).size()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/0a0744c17ef0675d8385dabf969dd384.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/0*QdqbO0qlTwTEL0pd.png"/></div></figure><h1 id="59bf" class="no nh it bd np nq nr ns nt nu nv nw nx jz ny ka nz kc oa kd ob kf oc kg od oe bi translated">外卖</h1><p id="fafd" class="pw-post-body-paragraph lq lr it ls b lt of ju lv lw og jx ly lz oh mb mc md oi mf mg mh oj mj mk ml im bi translated">在许多数据科学管道中，需要应用欠采样技术，以处理不平衡类和特征的偏差。在本教程中，我们为您提供了一种高效的方法，让您可以用几行代码创建平衡的数据集。</p></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="a564" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">最初发布于<a class="ae mm" href="https://predictivehacks.com/how-to-transform-an-unbalanced-dataset-to-a-balanced/" rel="noopener ugc nofollow" target="_blank">预测黑客</a></p></div></div>    
</body>
</html>