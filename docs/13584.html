<html>
<head>
<title>Networking Between Multiple Docker-Compose Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多个Docker-Compose项目之间的联网</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/networking-between-multiple-docker-compose-projects-317922eb85d2?source=collection_archive---------7-----------------------#2022-09-18">https://levelup.gitconnected.com/networking-between-multiple-docker-compose-projects-317922eb85d2?source=collection_archive---------7-----------------------#2022-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e4be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当你想在本地运行项目时，一个跨repos和docker-compose文件的微服务应用程序可能会变得混乱。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/6564712707d7a02c86c9d027b371993c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prebnuCCtMYUqsiVyuyXIw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">多个Docker-Compose项目之间的联网</figcaption></figure><p id="5f5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">设置开发环境总是具有挑战性，尤其是微服务架构。在我的上一个项目中，我将一个大型的monolith分割成跨不同代码库的微服务，最后得到了几个独立的docker-compose文件。</p><p id="3714" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想通过路由docker网络中的所有内容，在我的本地机器上测试完整的应用程序。我怎样才能让不同的服务在docker中连接起来，但是运行在它们单独的docker-compose项目目录中？</p><p id="31e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我不是专家，但是我通过使用docker-compose文件和服务发现了一些有趣的概念。</p><h1 id="c35a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Docker网络公司</h1><p id="7b20" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">Docker有它的<a class="ae mh" href="https://docs.docker.com/network/" rel="noopener ugc nofollow" target="_blank">网络</a>子系统。当启动Docker时，它创建了一个<strong class="js iu">桥</strong>网络。该网络连接了所有服务，但除非指定，否则不直接连接容器。您也可以创建和指定自己的桥接网络。</p><p id="6f3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<strong class="js iu"> <em class="mi">相同的YAML文件中概述的Docker-compose服务将总是在相同的桥接网络</em> </strong>上，通过它们的服务名创建并可到达。我想使用它，这样我在多个docker-compose文件中的不同服务就可以通过它们的服务名互相访问。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/80d9e3f67ee750d2bb6067630a4cdb51.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*QUm0uEdBwrefthCPyNVMOA.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">我的测试目录。每个项目都在自己的目录中，以确保创建了不同的网络。</figcaption></figure><h2 id="0bbb" class="mk lf it bd lg ml mm dn lk mn mo dp lo kb mp mq ls kf mr ms lw kj mt mu ma mv bi translated">手动创建Docker网络</h2><p id="554c" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">我们可以建立我们的docker网络，并指导docker-compose服务使用我们创建的网络。</p><p id="f04f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们这样做:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mw"><img src="../Images/d9af3cc939990f946fb408e25e52abe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2sO_zh-FZnJPxKkn0RGTIg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">创建网络并检查它是否存在</figcaption></figure><p id="1b1e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在告诉他们使用这个docker网络</p><p id="1e9a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们通过在docker-compose文件中将网络声明为<strong class="js iu"> <em class="mi">外部</em> </strong>来实现这一点</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/299c3d1c5a95ce901f86457f89c4d4d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*ioxvPVRY5xtWG2wQamz6aA.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">将网络声明为外部网络</figcaption></figure><p id="9a6d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这告诉docker-compose不要创建默认网络，而是使用我们预先存在的网络。让我们ping另一个项目的IP地址——我们可以使用<code class="fe my mz na nb b">docker inspect [container]</code>来检索它。然后，让我们使用IP地址和服务名向它发送一个请求，以证明Docker仍然在同一个网络上解析它。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nc"><img src="../Images/fabd144f50bbe8fb4b0f1c236d8e5710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lyZcwCOsMJsn-SW-CX679Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">向另一个docker-compose项目发送请求</figcaption></figure><h2 id="4802" class="mk lf it bd lg ml mm dn lk mn mo dp lo kb mp mq ls kf mr ms lw kj mt mu ma mv bi translated">让它变得更容易</h2><p id="a0c7" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">Docker通常使用目录和<code class="fe my mz na nb b">_default</code>的命名方案来制作默认网络。我们可以在第二个项目中将其声明为外部的，而不接触第一个项目的docker-compose文件。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/402433b7b5baad8a5b952eb76e6d8c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*3LRd6QP7DCsAk6XTPE6Bbw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">只需使用第一个项目中默认网络的名称</figcaption></figure><p id="04fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是帮助很大的StackOverflow帖子！</p><div class="ne nf gp gr ng nh"><a href="https://stackoverflow.com/questions/38088279/communication-between-multiple-docker-compose-projects" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">多个docker-compose项目之间的通信</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">如果你试图在来自不同docker-compose项目的两个容器之间进行通信，并且不想使用…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">stackoverflow.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ky nh"/></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://stackoverflow.com/questions/52010778/docker-compose-make-requests-between-containers" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">docker-编写容器之间的请求</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">我对docker-compose有点陌生，所以我甚至不确定我在寻找什么。我创建了两个图像，我正在运行…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">stackoverflow.com</p></div></div><div class="nq l"><div class="nw l ns nt nu nq nv ky nh"/></div></div></a></div><h1 id="8069" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">帮助工具</h1><ul class=""><li id="5a74" class="nx ny it js b jt mc jx md kb nz kf oa kj ob kn oc od oe of bi translated"><code class="fe my mz na nb b">docker network create</code></li><li id="e6ed" class="nx ny it js b jt og jx oh kb oi kf oj kj ok kn oc od oe of bi translated"><code class="fe my mz na nb b">docker network ls</code></li><li id="de67" class="nx ny it js b jt og jx oh kb oi kf oj kj ok kn oc od oe of bi translated"><code class="fe my mz na nb b">docker inspect [container name]</code></li><li id="483e" class="nx ny it js b jt og jx oh kb oi kf oj kj ok kn oc od oe of bi translated"><code class="fe my mz na nb b">netcat</code></li></ul><h1 id="ed95" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">TL；速度三角形定位法(dead reckoning)</h1><ul class=""><li id="9c5b" class="nx ny it js b jt mc jx md kb nz kf oa kj ob kn oc od oe of bi translated">连接多个docker网络可能会变得棘手</li><li id="6a99" class="nx ny it js b jt og jx oh kb oi kf oj kj ok kn oc od oe of bi translated">通过创建一个网络或者使用创建的默认网络，我们可以在文件名中使用<code class="fe my mz na nb b">external</code>来连接它们</li></ul><p id="406c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢你读到的内容，请在LinkedIn<a class="ae mh" href="https://www.linkedin.com/in/stcalica/" rel="noopener ugc nofollow" target="_blank">或Medium上关注我:)</a></p></div><div class="ab cl ol om hx on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="im in io ip iq"><h1 id="de84" class="le lf it bd lg lh os lj lk ll ot ln lo lp ou lr ls lt ov lv lw lx ow lz ma mb bi translated">分级编码</h1><p id="0540" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="008d" class="nx ny it js b jt ju jx jy kb ox kf oy kj oz kn oc od oe of bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="0c48" class="nx ny it js b jt og jx oh kb oi kf oj kj ok kn oc od oe of bi translated">📰查看<a class="ae mh" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="742a" class="nx ny it js b jt og jx oh kb oi kf oj kj ok kn oc od oe of bi translated">🔔关注我们:<a class="ae mh" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae mh" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae mh" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="f9ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🚀👉<a class="ae mh" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>