<html>
<head>
<title>React Portals: What are they and why should we use them?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React门户:它们是什么，我们为什么要使用它们？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/react-portals-what-are-they-and-why-should-we-use-them-7c082a62e8fa?source=collection_archive---------0-----------------------#2019-08-21">https://levelup.gitconnected.com/react-portals-what-are-they-and-why-should-we-use-them-7c082a62e8fa?source=collection_archive---------0-----------------------#2019-08-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/48f8181ec7fce72733d8c0c08b1a76d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*lbXO8XxpjHkNTnyifqk-TA.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">克里斯托弗·伯恩斯在<a class="ae kb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="fec5" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">众所周知，开发者喜欢在他们的web应用上使用React。它快速、可扩展且简单，允许开发人员创建大规模的应用程序，而无需重新加载页面。作为构建这个大型web应用程序的一部分，在很多情况下，您希望在应用程序中的某个位置呈现一个组件，而这个位置可能与原始组件所在的位置完全不同。</p><p id="851e" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">让我们以一个在线购物网站为例。你正在浏览衬衫，决定将两件放入购物车。当你点击“添加到购物车”时，你会看到衬衫呈现在你的应用程序的右侧，远离你选择它们的中心容器。看起来是这样的:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi la"><img src="../Images/5999086735eefdeeb0cb5c6dca5066e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*3zJcswHbo1n84RsbLcwTaQ.gif"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">您添加的衬衫出现在另一个组件中。</figcaption></figure><p id="9c09" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这些信息是如何独立于我们的主页弹出的？有几种方法可以实现这一点。一种方法是将选定的信息从一个组件向上传递到父容器，然后再向下传递到props中的目标组件，告诉它呈现我们传递给它的某些信息。对于较小的应用程序来说，这相对简单，但对于像Zara、脸书或Instagram这样的大规模网络应用程序来说，这可能会变得相当复杂！进入<a class="ae kb" href="https://reactjs.org/docs/portals.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ke iu">门户</strong> </a>。</p><h1 id="8e6c" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是门户网站？</h1><p id="4154" class="pw-post-body-paragraph kc kd it ke b kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz im bi translated">门户提供了一种快速无缝的方式来"<em class="mi">将子组件呈现到父组件的DOM层次结构之外的DOM节点中，</em> " ( <a class="ae kb" href="https://reactjs.org/docs/portals.html" rel="noopener ugc nofollow" target="_blank"> React文档</a>)。</p><p id="5612" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这是什么意思？在React中，默认行为是在单个DOM节点下呈现整个应用程序——应用程序<code class="fe mj mk ml mm b">root</code>。通常，在单个节点下渲染我们的应用程序是可以的。但是如果您想在<code class="fe mj mk ml mm b">root</code> DOM节点之外呈现子节点呢？这样做的两个常见例子是，当父元素有样式时(比如一个<code class="fe mj mk ml mm b">z-index</code>把它推到页面的前面，或者一个<code class="fe mj mk ml mm b">overflow: hidden</code>)，但是你希望子元素在视觉上出现在它的容器的顶部。</p><p id="c240" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">让我们来分析一下这是如何工作的。</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="mn mo l"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">GIF来自giphy.com</figcaption></figure><h1 id="7ace" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">它们是如何工作的？</h1><h2 id="284c" class="mp lg it bd lh mq mr dn ll ms mt dp lp kn mu mv lt kr mw mx lx kv my mz mb na bi translated">设置门户</h2><p id="2ca1" class="pw-post-body-paragraph kc kd it ke b kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz im bi translated">当你使用<code class="fe mj mk ml mm b">create-react-app</code>启动一个React应用程序时，你的<code class="fe mj mk ml mm b">index.js</code>文件将会有一行类似这样的代码:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/1be9430c43aaafb0901ea34e563145c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*8I_-7XF9xVjyp6bX-4yBMw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">当您创建一个新的React应用程序时，index.js文件中包含什么。</figcaption></figure><p id="c97c" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这意味着我们的应用程序组件呈现在主<code class="fe mj mk ml mm b">root</code> div中的DOM上，这是在我们的<code class="fe mj mk ml mm b">index.html</code>文件中制作应用程序时为我们创建的。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/161abfb04e642cd3d6af413cda4e4a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*2Zr7S7qpH8YQ-nPfJXInMg.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">在我们index.html档案的主体里。</figcaption></figure><p id="7306" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">因为我们的目标是在应用程序<code class="fe mj mk ml mm b">root</code>的之外呈现一个元素<em class="mi">，我们想在HTML文件中创建一个<em class="mi">单独的</em> <code class="fe mj mk ml mm b">div</code>。为了清楚起见，我将把这个<code class="fe mj mk ml mm b">div</code> <strong class="ke iu">门户称为</strong>。现在我们的<code class="fe mj mk ml mm b">index.html</code>应该是这样的:</em></p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/18ba6a180a94e972633e05237e42d819.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*m3s0gyGfemkNbYa6q34ITg.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">我们的index.html文件与新创建的门户网站。</figcaption></figure><p id="29c4" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">太好了！现在，我们要确保我们的<code class="fe mj mk ml mm b">index.js</code>文件知道在哪里可以找到<code class="fe mj mk ml mm b">div</code>，这样我们就可以使用我们将要创建的门户组件:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/f7f25470babb83c64658e8b61189601e.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*kfObw76cJL9lHlqlK0xzlQ.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">我们的index.js文件带有一个指向门户div的变量。</figcaption></figure><p id="bba1" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">类似于<code class="fe mj mk ml mm b">index.js</code>如何呈现<code class="fe mj mk ml mm b">App</code>组件中的内容，我们需要创建一个<code class="fe mj mk ml mm b">Portal</code>组件来设置门户，并允许我们添加子组件来呈现门户。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/273ee623afbac5d1dc7ff7504c54807d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*AV7yI1FbmMuQ0wwD7ZiDxA.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">新的门户组件！</figcaption></figure><p id="a295" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">下面我们来分解一下<code class="fe mj mk ml mm b">createPortal</code>在做什么。它有两个参数:第一个(<code class="fe mj mk ml mm b">child</code>)是任何<a class="ae kb" href="https://reactjs.org/docs/react-component.html#render" rel="noopener ugc nofollow" target="_blank">可渲染的React子节点</a>，比如元素、字符串或片段。第二个参数(<code class="fe mj mk ml mm b">container</code>)是一个DOM元素。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/8fb5ab631b633220f23fab439c2507e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*3gzjnxbm7ik8hzsn_OTZVA.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">React门户的基本设置。</figcaption></figure><p id="087f" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">在我们上面的例子中，<code class="fe mj mk ml mm b">child</code>是门户元素的道具。容器是我们创建的div <code class="fe mj mk ml mm b">newElement</code>。当组件挂载时，DOM树将看起来像这样:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ng"><img src="../Images/d414f20de2d8cd150f7f536cecc33e49.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*Sdnb52Xdav6kqCaD7Idh8A.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">门户组件挂载时的DOM树。</figcaption></figure><p id="97bb" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">现在，无论何时呈现<code class="fe mj mk ml mm b">Portal</code>组件，它(及其所有子组件)都会在<code class="fe mj mk ml mm b">portalRoot</code>上呈现。</p><h2 id="c89a" class="mp lg it bd lh mq mr dn ll ms mt dp lp kn mu mv lt kr mw mx lx kv my mz mb na bi translated">实施门户网站</h2><p id="9cf7" class="pw-post-body-paragraph kc kd it ke b kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz im bi translated">是时候测试我们的门户是否有效了！假设我们希望我们的应用程序在加载时显示一些文本和一个按钮。该按钮将允许我们显示或隐藏<code class="fe mj mk ml mm b">Portal</code>组件。由于我们的<code class="fe mj mk ml mm b">App</code>组件控制了我们应用程序的其余部分，我们需要给它一些方法，并告诉它呈现<code class="fe mj mk ml mm b">Portal</code>组件！让我们在<code class="fe mj mk ml mm b">App</code>实现我们想要的:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/e7ad59ce38526aa84368b5c2663b5929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*le8EMN9pMn3se8Dm1tHadw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">我们设置状态的切换函数。</figcaption></figure><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/9fdf2cf081089fc9eafae9c22f3ead6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*0gJ6DnknKhSXTvjrBvmWaw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">为门户组件提供子组件，并创建安装/卸载门户的按钮。</figcaption></figure><p id="95e9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这是当<code class="fe mj mk ml mm b">on</code>状态被设置为<code class="fe mj mk ml mm b">true</code>时的DOM。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nn"><img src="../Images/41a18bfca6a24128cb26f457596ae945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*asNogK6rGuAUrQXkbQKM5Q.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">image:<a class="ae kb" href="https://css-tricks.com/using-react-portals-to-render-children-outside-the-dom-hierarchy/" rel="noopener ugc nofollow" target="_blank">https://CSS-tricks . com/using-react-portals-to-render-children-outside-the-DOM-hierarchy/</a></figcaption></figure><p id="5a5f" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">当<code class="fe mj mk ml mm b">on</code>为<code class="fe mj mk ml mm b">false</code>时，门户组件不被渲染。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi no"><img src="../Images/ca19a45607694cb1d651ba13bb80c19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKcfKtTvZ6_nSTfQFYja-Q.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">image:<a class="ae kb" href="https://css-tricks.com/using-react-portals-to-render-children-outside-the-dom-hierarchy/" rel="noopener ugc nofollow" target="_blank">https://CSS-tricks . com/using-react-portals-to-render-children-outside-the-DOM-hierarchy/</a></figcaption></figure><p id="e2d5" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">就是这样！当点击按钮时，我们的门户和<code class="fe mj mk ml mm b">&lt;h1&gt;</code>标签呈现在我们的<code class="fe mj mk ml mm b">App</code>组件之外，当再次点击按钮时，它们消失。请通过<a class="ae kb" href="https://codepen.io/gaearon/pen/yzMaBd/" rel="noopener ugc nofollow" target="_blank"> Codepen </a>查看门户网站运行的实例:</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="np mo l"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">Dan Abramaov/React的门户示例。</figcaption></figure><p id="3b22" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我们做到了！要了解更多关于门户网站的信息，请点击<a class="ae kb" href="https://reactjs.org/docs/portals.html" rel="noopener ugc nofollow" target="_blank">此处</a>。感谢阅读！</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="nq mo l"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">GIF来自giphy.com</figcaption></figure></div></div>    
</body>
</html>