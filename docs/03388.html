<html>
<head>
<title>More Easy Things to Refactor in JavaScript Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript代码中更容易重构的东西</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/more-easy-things-to-refactor-in-javascript-code-bc0f4c93407?source=collection_archive---------14-----------------------#2020-05-05">https://levelup.gitconnected.com/more-easy-things-to-refactor-in-javascript-code-bc0f4c93407?source=collection_archive---------14-----------------------#2020-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/10ea0b1320df82c65bbbc47425fbb2c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wyKFaS43oYDdjs0R"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@davidclode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> David Clode </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="18fd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">JavaScript是一种简单易学的编程语言。编写运行并执行某些操作的程序很容易。然而，很难写出一段干净的JavaScript代码。</p><p id="1f2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将会看到更多重构的快速胜利。它们大多是语法上的东西，很容易改变。</p><h1 id="3fe0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">条件句应该各占一行</h1><p id="16c2" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">每个条件语句都应该在自己的行中。例如，我们不应该有如下所示的代码:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="a173" class="mq lf it mm b gy mr ms l mt mu">if (foo){</span><span id="4986" class="mq lf it mm b gy mv ms l mt mu">} if (bar){</span><span id="7eb5" class="mq lf it mm b gy mv ms l mt mu">}</span></pre><p id="73e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的代码使2个<code class="fe mw mx my mm b">if</code>语句看起来相互关联。因此，应该用一条新的线将它们彼此分开。</p><p id="3f0d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个<code class="fe mw mx my mm b">if</code>语句前没有<code class="fe mw mx my mm b">else</code>，所以它们彼此没有关联。</p><p id="f32a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们应该将其重写如下:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5683" class="mq lf it mm b gy mr ms l mt mu">if (foo) {</span><span id="5f8b" class="mq lf it mm b gy mv ms l mt mu">}</span><span id="358a" class="mq lf it mm b gy mv ms l mt mu">if (bar) {</span><span id="b525" class="mq lf it mm b gy mv ms l mt mu">}</span></pre><h1 id="d9f9" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">正确注释可选成员和参数</h1><p id="5dc5" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们使用TypeScript，我们可以用<code class="fe mw mx my mm b">?</code>符号注释可选的参数和成员。</p><p id="2c0b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们使用TypeScript，我们应该编写以下代码:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="34a1" class="mq lf it mm b gy mr ms l mt mu">interface Person {<br/>    firstName: string;<br/>    lastName: string;<br/>    age?: number;<br/>}</span></pre><p id="9e04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们有一个TypeScript接口，它将<code class="fe mw mx my mm b">age</code>作为接口的可选成员。</p><p id="c8f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们在声明一个类型为<code class="fe mw mx my mm b">Person</code>的对象时，就不必在对象中包含<code class="fe mw mx my mm b">age</code>。</p><p id="959c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这也适用于函数参数。例如，如果我们有:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="a1e0" class="mq lf it mm b gy mr ms l mt mu">const getPerson = (firstName: string, lastName: string, age?: number) =&gt; {<br/>    return {<br/>        firstName, lastName, age<br/>    }<br/>}</span></pre><p id="1a96" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们调用<code class="fe mw mx my mm b">getPerson</code>函数的时候，不一定要用<code class="fe mw mx my mm b">age</code>来调用。</p><h1 id="5c04" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">移除废弃商店</h1><p id="3767" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">死存储是已经被赋值的变量值，但在将它们重新赋值给不同的值之前从未被使用过。</p><p id="7ccb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有以下代码:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="6cb6" class="mq lf it mm b gy mr ms l mt mu">const getTotal = (arr) =&gt; {<br/>  let total = 0;<br/>  total = arr.reduce((a, b) =&gt; a + b);<br/>  return total;<br/>}</span></pre><p id="db9e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么<code class="fe mw mx my mm b">let total = 0;</code>是一个无用的赋值，因为0从未被使用过。</p><p id="a438" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是令人困惑的，因为它在那里，但它不用于任何事情。因此，我们应该从代码中删除任何死存储，因为它在任何地方都没有被使用。</p><p id="fb75" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以删除<code class="fe mw mx my mm b">let total = 0;</code>，该函数将做同样的事情。例如，我们可以改为写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5d18" class="mq lf it mm b gy mr ms l mt mu">const getTotal = (arr) =&gt; {<br/>  let total = arr.reduce((a, b) =&gt; a + b);<br/>  return total;<br/>}</span></pre><p id="6724" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它做同样的事情，但是少了一行。现在我们看到这一行是无用的代码，不做任何事情。</p><p id="2f27" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">删除它可以节省页面空间，在阅读时使用更少的大脑资源，并且少运行一行代码。</p><h1 id="efd4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">不要反转布尔值</h1><p id="bb22" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">当我们的比较表达式使用了像<code class="fe mw mx my mm b">===</code>、<code class="fe mw mx my mm b">!==</code>、<code class="fe mw mx my mm b">&lt;</code>、<code class="fe mw mx my mm b">&gt;</code>、<code class="fe mw mx my mm b">&gt;=</code>、<code class="fe mw mx my mm b">&lt;=</code>、<code class="fe mw mx my mm b">!=</code>或<code class="fe mw mx my mm b">==</code>这样的运算符时，我们不应该颠倒整个表达式。</p><p id="9e29" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有这样的代码:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="ee0f" class="mq lf it mm b gy mr ms l mt mu">if (!(1 &lt;= total)) {<br/>  //...<br/>}</span></pre><p id="60c2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该改为写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5c64" class="mq lf it mm b gy mr ms l mt mu">if (1 &gt; total) {<br/>  //...<br/>}</span></pre><p id="4144" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个例子有较少的字符，我们也没有解释双重否定的认知负担。</p><p id="8fb2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">双重否定对我们的大脑不好，所以我们不应该有。双重否定更长，所以我们绝对不应该在代码中使用它们。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/e8c5014f93b1da39f18818439a8217a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yIP0bPvPkjIGoh1V"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@redcherry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> suzie maclean </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="12a7" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">不再连接字符串</h1><p id="f40f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在JavaScript有模板字符串之前，我们只能连接字符串。这并不好，因为当我们必须构造长的动态字符串时，这变得非常混乱。</p><p id="9b0b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，模板字符串是ES2015中设想的JavaScript的最佳特性之一。</p><p id="5d2a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该尽可能多地使用模板字符串。例如，不写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="8463" class="mq lf it mm b gy mr ms l mt mu">const getDescription = (firstName, lastName, age) =&gt; 'Your name is ' + firstName + ' ' + lastName + 'Your age is ' + age.</span></pre><p id="85d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该改为写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="bfb2" class="mq lf it mm b gy mr ms l mt mu">const getDescription = (firstName, lastName, age) =&gt; `Your name is ${firstName} ${lastName}. Your age is ${age}`</span></pre><p id="33de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所看到的，我们将变量直接嵌入到模板字符串中。我们不必用<code class="fe mw mx my mm b">+</code>操作符将多个字符串连接在一起。</p><p id="50ef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">模板字符串也与模板标签一起工作，模板标签是只能用模板字符串调用的函数。</p><p id="6de1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们不能对普通字符串使用模板标签。这是我们不应该使用它们的另一个原因。</p><p id="3ae4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">模板字符串要干净得多，我们可以用它们创建多行字符串。此外，我们可以在分隔符<code class="fe mw mx my mm b">${}</code>中嵌入任何表达式。</p><h1 id="5160" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="f327" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">不相关的<code class="fe mw mx my mm b">if</code>语句应该从自己的行开始，这样它们看起来就不像是相关的。</p><p id="16ee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们不应该在代码中有死存储，在那里我们的代码中有从未使用过的赋值。</p><p id="857f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">整个布尔表达式不应该倒置。</p><p id="ca58" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">应该始终使用模板字符串，而不是串联字符串。</p></div></div>    
</body>
</html>