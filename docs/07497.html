<html>
<head>
<title>What is the Specification Pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是规格模式</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-a-specification-pattern-460b32bfbf7b?source=collection_archive---------11-----------------------#2021-02-22">https://levelup.gitconnected.com/what-is-a-specification-pattern-460b32bfbf7b?source=collection_archive---------11-----------------------#2021-02-22</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5371" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">用规格模式解开代码</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/25e218cff2741ebd7ece6c6692500d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Eus7BzZDjwVnoyCZ"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">谢尔盖·佐尔金在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="de25" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您需要选择、验证或向您的域添加约束。规范模式以一种清晰的面向对象的方式完成了前面提到的工作。</p><p id="cd75" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们来详细说说。接下来，Java中的规范模式。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="3ec7" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">问题</h1><blockquote class="mv"><p id="34ff" class="mw mx iu bd my mz na nb nc nd ne lv dk translated">选择:您需要根据某些标准选择对象的子集，并在不同的时间刷新选择</p><p id="eac5" class="mw mx iu bd my mz na nb nc nd ne lv dk translated">验证:您需要检查只有合适的对象被用于特定的目的</p><p id="8a7b" class="mw mx iu bd my mz na nb nc nd ne lv dk translated">按单生产:你需要描述一个对象可能会做什么，而不需要解释这个对象如何做的细节，但是要以这样一种方式，一个候选对象可能会被制造出来以满足需求——<a class="ae kz" href="https://www.martinfowler.com/apsupp/spec.pdf" rel="noopener ugc nofollow" target="_blank">埃里克·艾文斯</a></p></blockquote></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="1e34" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">规格版本</h1><h2 id="ede8" class="nf me iu bd mf ng nh dn mj ni nj dp mn lj nk nl mp ln nm nn mr lr no np mt nq bi translated">硬编码规范</h2><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nr"><img src="../Images/2fb579d5175bcce71ffe03e0b72a5a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_yquYRMKbt-Jixrqc9OCZQ.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">被污染的代码—作者编写的代码</figcaption></figure><p id="0137" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你已经看过这段代码了。您需要根据参数选择数据。这是你在大多数代码库中看到的。调试是痛苦的，测试是困难的，重复的代码是非常多的。</p><blockquote class="ns nt nu"><p id="4463" class="la lb nv lc b ld le jv lf lg lh jy li nw lk ll lm nx lo lp lq ny ls lt lu lv in bi translated">你能在这里改进什么？</p></blockquote><p id="4ec2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个班知道的比它应该知道的多。你应该始终遵循最小惊讶原则。你可以看到，验证规则污染了代码，所以你需要提取它们。</p><p id="b304" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用规范模式提取它们。让我们来看看规范的方法来分离前面的代码。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nz"><img src="../Images/99a7ab126192c0f979de9475d81ab07e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wTPhQn5VH-xdTvE5qeyaZw.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">规范模式代码—作者代码</figcaption></figure><p id="9928" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">显示文档(<a class="ae kz" href="https://www.martinfowler.com/apsupp/spec.pdf" rel="noopener ugc nofollow" target="_blank">第2页。</a>)上的规格图样。这就是<em class="nv">“硬编码规范”</em>。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="0d68" class="nf me iu bd mf ng nh dn mj ni nj dp mn lj nk nl mp ln nm nn mr lr no np mt nq bi translated">参数化规格</h2><p id="b071" class="pw-post-body-paragraph la lb iu lc b ld oa jv lf lg ob jy li lj oc ll lm ln od lp lq lr oe lt lu lv in bi translated">我们也可以将参数放入我们的规范中。这些规格是<em class="nv">“参数化规格”</em>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj of"><img src="../Images/b735a7f33149a5509a29c5e861d43670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aI6LrFWqBtatYb5jeMbbhA.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://matt.berther.io/2005/03/25/the-specification-pattern-a-primer/" rel="noopener ugc nofollow" target="_blank">参数化规范—污染代码— Matt Berther </a></figcaption></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="1f72" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你现在也有类似的情况。这一次我们需要检查动态条件。然后我们也传入用户。客户端代码需要传入用户，选择规则在规范中。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj og"><img src="../Images/7cea4d7063c405afab4775260312f084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dlQ4nuIIdYrU69qOtQjzzg.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://matt.berther.io/2005/03/25/the-specification-pattern-a-primer/" rel="noopener ugc nofollow" target="_blank">参数化规范—干净代码— Matt Berther </a></figcaption></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="2c36" class="nf me iu bd mf ng nh dn mj ni nj dp mn lj nk nl mp ln nm nn mr lr no np mt nq bi translated">复合规格</h2><p id="67e0" class="pw-post-body-paragraph la lb iu lc b ld oa jv lf lg ob jy li lj oc ll lm ln od lp lq lr oe lt lu lv in bi translated">复合规范在一系列规范中非常有用。客户端代码可以链接规范，并基于布尔条件进行评估。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oh"><img src="../Images/8dcfc47616a292820574307c7e04587f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2W4itYfkDknO-2kj3qPwPw.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者的Java复合规范模式</figcaption></figure><p id="de4a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">假设我们需要根据几个条件来选择数据。我们可以用它来链接条件，包装成规范。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="9bd5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">举个例子，我们使用游戏中的物体。我们有生物，我们需要根据三个要求来选择它们:</p><ul class=""><li id="5043" class="oi oj iu lc b ld le lg lh lj ok ln ol lr om lv on oo op oq bi translated">寻找红色生物</li><li id="71bf" class="oi oj iu lc b ld or lg os lj ot ln ou lr ov lv on oo op oq bi translated">寻找体重超过9公斤的生物</li><li id="fe58" class="oi oj iu lc b ld or lg os lj ot ln ou lr ov lv on oo op oq bi translated">寻找生命值低的生物——低于30点</li></ul><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ow"><img src="../Images/acc72a3facc835d71c7d41c048c7d581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4eHt79pIFiLGUnCOwlFUg.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">Java中的复合规范模式——作者实现</figcaption></figure><p id="c627" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">从代码中可以看出，<code class="fe ox oy oz pa b">findDyingCreatures</code>方法没有污染。人们可以使用这种方法来提取所有的验证逻辑。</p><p id="1044" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">添加新的规范，但不要修改现有的代码。我们保留了<a class="ae kz" href="https://stackify.com/solid-design-open-closed-principle/" rel="noopener ugc nofollow" target="_blank">开闭原则</a>，获得了更清晰的代码，并且测试起来更加容易。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="0306" class="nf me iu bd mf ng nh dn mj ni nj dp mn lj nk nl mp ln nm nn mr lr no np mt nq bi translated">今天就加入Medium！</h2><p id="7689" class="pw-post-body-paragraph la lb iu lc b ld oa jv lf lg ob jy li lj oc ll lm ln od lp lq lr oe lt lu lv in bi translated">这篇文章是中等冰山的<a class="ae kz" href="https://zivce.medium.com/membership" rel="noopener">一角。</a><a class="ae kz" href="https://zivce.medium.com/membership" rel="noopener">订阅Medium </a>提高你的生产力，成为更好的开发者，获得实用的小技巧。</p><p id="5fce" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="nv">免责声明:5$中的2$将直接支持我和我的文章。</em></p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="ae45" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">结论</h1><p id="ef89" class="pw-post-body-paragraph la lb iu lc b ld oa jv lf lg ob jy li lj oc ll lm ln od lp lq lr oe lt lu lv in bi translated">我希望你在开发这个模式的过程中获得了乐趣。到目前为止，我还没有使用过这种模式，但是我将使用这个文档作为参考。如果你喜欢，你也可以把它作为参考。</p><p id="afdd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">任何项目都有这个问题。条件和逻辑交织在一起。每次更改条件，都会破坏测试或特性。</p><p id="cb08" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该规范有几个好处。您可以添加新的规格。让现有代码像以前一样工作。以简洁的OOP方式满足业务需求。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="1850" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">资源:</h1><p id="f970" class="pw-post-body-paragraph la lb iu lc b ld oa jv lf lg ob jy li lj oc ll lm ln od lp lq lr oe lt lu lv in bi translated"><a class="ae kz" href="https://www.martinfowler.com/apsupp/spec.pdf" rel="noopener ugc nofollow" target="_blank">埃里克·埃文斯—规格</a></p><p id="8ba5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Matt Berther的S <a class="ae kz" href="https://matt.berther.io/2005/03/25/the-specification-pattern-a-primer/" rel="noopener ugc nofollow" target="_blank">规格模式</a></p><div class="pb pc gq gs pd pe"><a href="https://en.wikipedia.org/wiki/Specification_pattern" rel="noopener  ugc nofollow" target="_blank"><div class="pf ab fp"><div class="pg ab ph cl cj pi"><h2 class="bd iv gz z fq pj fs ft pk fv fx it bi translated">规格模式</h2><div class="pl l"><h3 class="bd b gz z fq pj fs ft pk fv fx dk translated">在计算机编程中，规范模式是一种特殊的软件设计模式，业务规则可以通过它来设计软件</h3></div><div class="pm l"><p class="bd b dl z fq pj fs ft pk fv fx dk translated">en.wikipedia.org</p></div></div><div class="pn l"><div class="po l pp pq pr pn ps kt pe"/></div></div></a></div><p id="7d97" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://softwareengineering.stackexchange.com/questions/148849/style-for-control-flow-with-validation-checks" rel="noopener ugc nofollow" target="_blank">堆叠交换相关问题</a></p></div></div>    
</body>
</html>