<html>
<head>
<title>Block Ads for Your Entire Home Network with a Raspberry Pi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用树莓皮为你的整个家庭网络屏蔽广告</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/block-ads-for-your-entire-home-network-with-a-raspberry-pi-ff861eaee630?source=collection_archive---------1-----------------------#2020-01-20">https://levelup.gitconnected.com/block-ads-for-your-entire-home-network-with-a-raspberry-pi-ff861eaee630?source=collection_archive---------1-----------------------#2020-01-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c2ae" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我如何使用树莓Pi为我的整个网络创建一个DNS sinkhole</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0ca4e4cc211b14bbc5b984b27aae1e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TCrEJluo7rbs8Gh0"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">哈里森·布罗德本特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="efd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">去年我生日的时候得到了一个树莓派，并且一直<em class="lv">遭受分析麻痹</em>，试图弄清楚我想用它做什么。</p><p id="74d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近遇到了一些叫做Pi-hole的开源软件，号称有能力为你的整个网络屏蔽广告。不知所措的是，我不得不看看这是如何工作的，所以下面是我如何设置我的树莓Pi来充当所有与广告相关的事情的黑洞。你不仅会体验到一个(大多数情况下)无广告的互联网，而且像智能电视和其他“粗略的”分析工具也不能把它们的数据发送回家。<strong class="lb iu">万岁隐私！</strong></p><p id="1b01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有任何问题，请在下面留下您的回复，或者随时给我发<a class="ae ky" href="http://twitter.com/jeffmorhous" rel="noopener ugc nofollow" target="_blank">推文！</a></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2160" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">第一步:收购🖥硬件公司</h1><p id="4391" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">Raspberry Pi是一台非常便宜的电脑，这使得它成为完成这一特定任务的绝佳选择。为了您的方便，我将在下面列出我购买的每件商品的附属链接。</p><p id="4792" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我有<a class="ae ky" href="https://www.amazon.com/gp/product/B01LPLPBS8/ref=as_li_tl?ie=UTF8&amp;tag=jeffmorhous-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=B01LPLPBS8&amp;linkId=f500311a42eb9157e8bb09d28fbbdb0d" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">树莓Pi Model 3 Model B </strong> </a>，大概50美元。事实上，我买了一套有电源和盒子的工具，你可能也想这样做。这是无线的，所以我不需要适配器。然而，如果你买一个没有WiFi的型号，你需要用以太网电缆将其连接到你的路由器上，或者买一个WiFi适配器。</p><p id="9e24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你还需要一张<a class="ae ky" href="https://www.amazon.com/gp/product/B073JYVKNX/ref=as_li_tl?ie=UTF8&amp;tag=jeffmorhous-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=B073JYVKNX&amp;linkId=df3f3cfdac52cbe11f25e46a1c32d62e" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> microSD卡</strong> </a>来存储操作系统(稍后会有更多介绍)。如果你的电脑没有SD读卡器，你需要一个<a class="ae ky" href="https://www.amazon.com/gp/product/B00W02VHM6/ref=as_li_tl?ie=UTF8&amp;tag=jeffmorhous-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=B00W02VHM6&amp;linkId=68cd82405719a6437a054f482d20e3ed" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> SD读卡器</strong> </a>。</p><p id="771f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你还没有，你需要一个简单的键盘。我假设你有某种HDMI显示器，比如相对现代的电视，但如果你没有，你也需要它。<em class="lv">(有一种方法可以不用键盘，鼠标，甚至是屏幕来设置Pi。这就是所谓的无头设置，如果你这样做了，那么你可以直接跳到步骤4) </em></p><h1 id="46ee" class="md me it bd mf mg na mi mj mk nb mm mn jz nc ka mp kc nd kd mr kf ne kg mt mu bi translated"><strong class="ak">第二步:安装操作系统👨‍💻</strong></h1><p id="56b2" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">树莓酱非常简单。你可以选择你的操作系统，我用的是Linux操作系统的开源端口<strong class="lb iu"> Raspbian </strong>。<a class="ae ky" href="https://www.raspberrypi.org/downloads/raspbian/" rel="noopener ugc nofollow" target="_blank">你可以在这里找到下载的内容</a>——这需要一点时间，所以请点击下载并随意阅读。</p><p id="feba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将您的microSD卡直接或通过任何必要的适配器放入计算机。重要的一点是，我用的是mac，所以我在这里的说明也是如此。如果你使用的是Windows，这里有一些更通用的说明。</p><p id="ea4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.balena.io/etcher/" rel="noopener ugc nofollow" target="_blank">下载balenaEtcher帮助我们在SD卡上安装Raspbian。</a>运行。dmg安装并启动它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/bed8230b06c3f0738cfc0da9e0de88df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zckppIkSuGw56jJ-w1IOqg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">我机器上的balenaEtcher</figcaption></figure><p id="c116" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击蓝色的“选择图像”，并找到。你下载的Raspbian的iso文件。确保中心选择设置为您的SD卡，并点击闪存！同样，这可能需要一分钟⏰</p><p id="5167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，弹出您的SD卡，并将其放入您的Pi。插入显示器/电视、键盘和鼠标</p><h1 id="fa40" class="md me it bd mf mg na mi mj mk nb mm mn jz nc ka mp kc nd kd mr kf ne kg mt mu bi translated">步骤3:自定义一些Pi设置</h1><p id="253f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">Pi将询问您的国家和时区，然后更改默认密码——出于安全原因，您肯定希望这样做。接下来，您的Pi可能想要更新。同样，为了安全起见，让它这样做吧。这可能是最长的一次等待。</p><h2 id="498d" class="ng me it bd mf nh ni dn mj nj nk dp mn li nl nm mp lm nn no mr lq np nq mt nr bi translated">您还需要启用SSH，这样就可以远程控制Pi😃</h2><p id="afd8" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">为此，单击左上角的图标打开饼图中的终端。运行以下命令来访问ssh(所有这些都应该在您的pi终端上运行，而不是在您的主计算机上)</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="76a4" class="ng me it nt b gy nx ny l nz oa">sudo apt get install ssh</span></pre><p id="131c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">启用它</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="3d43" class="ng me it nt b gy nx ny l nz oa">sudo /etc/init.d/ssh start</span></pre><p id="7ca2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将它设置为每次使用启动时启用ssh</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ad34" class="ng me it nt b gy nx ny l nz oa">sudo update-rc.d ssh defaults</span></pre><p id="1459" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得您的Pi的IP地址，运行</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="62b8" class="ng me it nt b gy nx ny l nz oa">hostname -I</span></pre><h2 id="604e" class="ng me it bd mf nh ni dn mj nj nk dp mn li nl nm mp lm nn no mr lq np nq mt nr bi translated">现在，我们切换回您的mac终端，在那里运行以下命令</h2><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="7910" class="ng me it nt b gy nx ny l nz oa">ssh pi@YOUR.PI.IP.ADDRESS</span></pre><p id="541b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答对了，输入你的密码，你就可以远程访问你的树莓派了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="cf17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:更改您的默认SSH端口也是一个好主意，但是我们不会在这里讨论它。</p><h1 id="ed22" class="md me it bd mf mg na mi mj mk nb mm mn jz nc ka mp kc nd kd mr kf ne kg mt mu bi translated">步骤4:安装墩孔</h1><p id="2adb" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在您的Pi终端或通过SSH连接到Pi的计算机终端中，从Pi-hole的网站运行以下命令来安装它:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="9221" class="ng me it nt b gy nx ny l nz oa">curl -sSL https://install.pi-hole.net | bash</span></pre><p id="38a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装程序将运行并询问一堆问题。选择默认值是可以的，但是可以像我一样随意定制。</p><p id="aa84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当安装程序完成时，它会显示您选择的密码。记下并复制它，然后通过执行以下命令更改web dashboard密码:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="b9d7" class="ng me it nt b gy nx ny l nz oa">pihole -a -p</span></pre><h1 id="c522" class="md me it bd mf mg na mi mj mk nb mm mn jz nc ka mp kc nd kd mr kf ne kg mt mu bi translated">步骤5:配置设备或路由器</h1><p id="be7b" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">现在你的Pi-hole作为一个DNS服务器，我们需要确保你的设备使用它，而不是你的ISP。您可以在每个设备的基础上这样做，但我建议在您的路由器上更改它。这样，每次网络上的设备发出DNS请求时，它都会首先通过这个孔。</p><p id="b4b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一步很具体到路由器的品牌，就不赘述了。本质上，你需要告诉你的路由器把你的端口当作一个DNS服务器，而不是你的ISP。您还应该为您的Pi保留一个静态IP地址，以确保它的IP不会改变，因为这会破坏您的设置。</p><p id="fef3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧，享受你的无广告互联网吧！🙌</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="3fd0" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">可选:Pi-hole如何工作🎓</h1><p id="d1b9" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">普通的广告拦截器允许加载广告，只是将它们隐藏起来。一旦你打开并运行了Pio-hole，广告将会在它们开始下载之前就停止不动了。</p><p id="48ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pi-hole是一个非常特殊的<a class="ae ky" href="https://en.wikipedia.org/wiki/DNS_sinkhole" rel="noopener ugc nofollow" target="_blank"> DNS天坑</a>。DNS代表域名系统，它是将名称(如medium.com)连接到IP地址(<a class="ae ky" href="https://myip.ms/info/whois/104.16.120.127" rel="noopener ugc nofollow" target="_blank">104.16.120.127</a>)的协议，这是网站/服务器在互联网上真正生存的地方。</p><p id="47d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">DNS sinkhole代替您通常的DNS提供商提供错误的结果。这几乎破坏了你的互联网——太棒了！有了Pi-hole，所有不是广告的东西都会被转发给你的DNS提供商，<em class="lv">但是</em>如果域名在Pi-hole的黑名单上(这是为你们当中最书呆子定制的)，那么Pi-hole就会发回一个假的IP地址。</p><p id="77ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以你访问一个网站，它加载。接下来，网站向其广告提供商索要广告，Pi-hole说“什么广告提供商？那是不存在的。”然后你的广告就没了。这实际上可以加快你的网络，因为你不会使用太多的带宽。</p><p id="2564" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个有趣的注意是Pi-hole不会杀死youtube广告，因为youtube从相同的DNS提供其内容和广告，所以杀死youtube广告也会杀死youtube。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="e5ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这个，请通过鼓掌、关注我这里、<a class="ae ky" href="http://twitter.com/jeffmorhous" rel="noopener ugc nofollow" target="_blank">或在twitter上</a>告诉我😎</p><p id="2033" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你发现了一些看起来不对劲的地方，请在评论中告诉我！</p></div></div>    
</body>
</html>