<html>
<head>
<title>Flutter Authentication with Firebase.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Firebase的Flutter认证。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/flutter-authentication-with-firebase-b00084e2c0a3?source=collection_archive---------15-----------------------#2022-05-06">https://levelup.gitconnected.com/flutter-authentication-with-firebase-b00084e2c0a3?source=collection_archive---------15-----------------------#2022-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3f0f45b0b4cf993c0443b7e14d4bf398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jzy_Uj-uwIU148aN"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Artur Shamsutdinov 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="125d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在过去的一个月里，我一直在玩旋舞和火焰基地，我不得不同意你们所有人的观点，旋舞和火焰基地是这里最好的组合。我将向您介绍如何在您的下一个项目中使用firebase身份验证的所有步骤。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="4462" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">设置firebase</h1><p id="ce10" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">为了使用身份验证服务，您必须首先设置firebase。首次登录或注册您的<a class="ae kc" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> firebase账户</a>。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/c2bfdc01e101949aefed46192ca049f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*Sh6Dr8DFcQsDRo1GpLg2OA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Firebase新项目</figcaption></figure><p id="8057" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后转到firebase控制台，创建一个新项目。按照提示操作，您就已经创建了新的firebase项目。</p><p id="1511" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在您的新项目中，单击authentication选项卡。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/876055fefeda84c987b927a622fb0e19.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*SM7cwIWzU54SjMcUgufZ0Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Firebase选项卡</figcaption></figure><p id="1ce6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Firebase支持许多身份验证方法和提供商，但此时我们将使用电子邮件和密码方法。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/8bb52e6bb31923455e8f16f13beac5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwc1iHiuqM8Z0HMykjEEnw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">身份验证提供商</figcaption></figure><p id="80cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">单击电子邮件和密码提供商并启用它。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/114870e17092af17fa274acb321f0fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tocccaHBbyxh5vNdgsopg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">电子邮件和密码提供商。</figcaption></figure><p id="c5b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是您现在设置身份验证所需做的全部工作。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="8cb5" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">安装Firebase CLI</h1><p id="dc16" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">为了配置firebase项目供flutter使用。您需要安装flutter cli。</p><p id="62ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装cli，您的计算机上需要有node.js，因为cli是使用npm安装的。</p><pre class="mm mn mo mp gt mt mu mv mw aw mx bi"><span id="d39d" class="my lj iq mu b gy mz na l nb nc">npm install -g firebase-tools</span></pre><p id="e9a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你在linux上遇到权限问题，记得使用sudo</p><p id="3ff5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来安装flutterfire cli，使用</p><pre class="mm mn mo mp gt mt mu mv mw aw mx bi"><span id="b347" class="my lj iq mu b gy mz na l nb nc">dart pub global activate flutterfire_cli</span></pre><p id="6ce8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FlutterFire CLI从Firebase项目和选定的项目应用程序中提取信息，以生成特定平台的所有配置。</p><p id="56bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在应用程序的根目录下运行configure命令，用flutter配置firebase</p><pre class="mm mn mo mp gt mt mu mv mw aw mx bi"><span id="5580" class="my lj iq mu b gy mz na l nb nc">flutterfire configure</span></pre><p id="5224" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Flutterfire configure命令将引导您选择想要使用的平台，并允许您选择firebase项目。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="0efd" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">向Flutter添加Firebase依赖项</h1><p id="47be" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">要在firebase项目中使用flutter，您需要在您的<em class="nd"> pubsec.yaml </em>文件中添加以下依赖项。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">pubsec.yaml</figcaption></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="405c" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">设置main.dart</h1><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="a2c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您必须将主函数改为异步函数，并初始化firebase。要了解widgetsfutterbinding . ensure initialized()是什么，您可以从<a class="ae kc" href="https://stackoverflow.com/questions/63873338/what-does-widgetsflutterbinding-ensureinitialized-do" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>或<a class="ae kc" href="https://api.flutter.dev/flutter/widgets/WidgetsFlutterBinding/ensureInitialized.html" rel="noopener ugc nofollow" target="_blank"> flutter文档</a>中阅读这个答案。</p><p id="c394" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nd"> main.dart </em>文件的完整外观</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">主.镖</figcaption></figure><p id="a100" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们导入了<em class="nd"> firebase_auth </em>包，并创建了一个User类型的变量<em class="nd"> result </em>，它通过调用当前用户属性来检查是否有用户。在的home参数中，有一个已登录的用户，如果有，他将被定向到主页，如果没有，他将被定向到注册屏幕。</p><p id="6037" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">向主页传递一个name参数，该参数将包含用户显示名称，这是firebase_auth中的一个属性。</p><h1 id="5dde" class="li lj iq bd lk ll ng ln lo lp nh lr ls lt ni lv lw lx nj lz ma mb nk md me mf bi translated">创建主屏幕</h1><p id="9018" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">我们创建了一个简单的主屏幕，只通过名字来问候用户。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="a40b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在主页中，我们希望传递一个用户参数，以便在文本中显示它。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="2c38" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建注册屏幕</h1><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="8742" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nl nm nn mu b">GlobalKey</code>用于标识该表单，我们还创建了一个对子表单<code class="fe nl nm nn mu b">Users</code>的引用，并创建了将被附加到<code class="fe nl nm nn mu b">textformfield.</code>的<code class="fe nl nm nn mu b">TextEditingController</code></p><p id="19a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了四个<code class="fe nl nm nn mu b">textformfields</code>,每个字段都包含自己的验证。之后，我们创建一个<code class="fe nl nm nn mu b">ElevatedButton</code>小部件，作为提交按钮:</p><p id="0c7d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">方法<code class="fe nl nm nn mu b">validate()</code>将检查是否所有字段都被验证，然后在方法<code class="fe nl nm nn mu b">registerToDb()</code>中，我们将数据添加到Firebase身份验证中。这是最重要的部分:</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="15f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，首先我们调用方法<code class="fe nl nm nn mu b">createUserWithEmailAndPassword</code>，它将在firebase身份验证中创建用户，我们还将电子邮件和密码传递给这个方法。要访问电子邮件的值和密码，我们需要使用<code class="fe nl nm nn mu b">TextEditingController</code>上的属性<code class="fe nl nm nn mu b">text</code>。由于<code class="fe nl nm nn mu b">createUserWithEmailAndPassword</code>返回一个<code class="fe nl nm nn mu b">Future&lt;AuthResult&gt;</code>，那么我们将使用方法<code class="fe nl nm nn mu b">then()</code>，该方法将接受一个回调，该回调将包含一个类型为<code class="fe nl nm nn mu b">AuthResult</code>的变量，并且由于类<code class="fe nl nm nn mu b">AuthResult</code>包含类型为<code class="fe nl nm nn mu b">FirebaseUser</code>的变量<code class="fe nl nm nn mu b">user</code>，那么我们可以通过执行<code class="fe nl nm nn mu b">result.user.displayname.</code>来检索显示名称</p><blockquote class="no np nq"><p id="d35e" class="kd ke nd kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">注意:不要忘记处理文本编辑控制器</p></blockquote></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="c827" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建登录屏幕</h1><p id="ed5a" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">我们创建了一个简单的登录屏幕，只有电子邮件和密码字段以及一个登录按钮。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="9328" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在提升的按钮内部，在验证之后，我们调用方法<code class="fe nl nm nn mu b">loginToDb()</code></p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="db3b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以这里我们使用方法<code class="fe nl nm nn mu b">signInWithEmailAndPassword</code>来登录用户，并且我们也将<code class="fe nl nm nn mu b">email</code>和<code class="fe nl nm nn mu b">password</code>作为参数传递。在这个异步方法完成后，我们导航到<code class="fe nl nm nn mu b">home</code>页面，如果这个方法抛出任何错误，那么它将被<code class="fe nl nm nn mu b">catchError</code>捕获，并由<code class="fe nl nm nn mu b">alertdialog</code>显示在屏幕上。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="61a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢这篇文章。</p><p id="3e96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">快乐编码。🎉🎉</p></div></div>    
</body>
</html>