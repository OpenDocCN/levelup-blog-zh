<html>
<head>
<title>Create a Controlled Radio Group in React, Formik, Material UI, and TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React、Formik、Material UI和TypeScript中创建受控单选按钮组</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-a-controlled-radio-group-in-react-formik-material-ui-and-typescript-7ed314081a0e?source=collection_archive---------0-----------------------#2021-04-25">https://levelup.gitconnected.com/create-a-controlled-radio-group-in-react-formik-material-ui-and-typescript-7ed314081a0e?source=collection_archive---------0-----------------------#2021-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5915" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">或者:如何在朝九晚五的工作时间里不浪费五个小时</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/954a8cba862f2dc48e0734eca56fe614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cYCdl0Z44-tcEuHA"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">奥斯卡·伊尔迪兹在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="65cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我最近找到了一份工作！我是做前端开发的。我被分配到一个写得很完美的项目。它很干净，代码架构也很简洁。实际上，这意味着它利用了十几个库，正如您对维护良好的代码库的期望一样。很高兴能有所贡献。我在保持它的示范性方面做得很好，偶尔会在一些看似简单的事情上挣扎，比如创建受控的表单。</p><p id="e032" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用Formik和Material UI制作受控表单非常简单。基本上，你所要做的就是用<code class="fe ls lt lu lv b">&lt;Formik&gt;</code> <em class="lw">标签</em>包装你的表单组件，并附加一两个属性。或者，您可以使用一个<code class="fe ls lt lu lv b">useFormik()</code>钩子，尽管我不打算在本教程中讨论它。我要解释的是创建一个受控的电台组，因为我觉得有点复杂。</p><p id="aff0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们走吧！</p><h1 id="ef7d" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">设置东西</h1><p id="c761" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">为了这个教程，我将尽可能地简化这个过程，因此我想到了使用<code class="fe ls lt lu lv b">create-react-app</code>命令:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="f5b1" class="my ly iq lv b gy mz na l nb nc">npx create-react-app .</span></pre><p id="5510" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，您可以安装依赖项:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="6413" class="my ly iq lv b gy mz na l nb nc">npm install typescript formik @material-ui/core</span></pre><p id="bbe2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一步中，剩下要做的最后一件事就是将<code class="fe ls lt lu lv b">App</code>文件的扩展名从<code class="fe ls lt lu lv b">.js</code>改为<code class="fe ls lt lu lv b">.tsx</code>。</p><h1 id="243f" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">密码</h1><p id="1bcb" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">清除<code class="fe ls lt lu lv b">App.tsx</code>文件，如下所示:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="d23e" class="my ly iq lv b gy mz na l nb nc">import React from 'react'</span><span id="e3d8" class="my ly iq lv b gy nd na l nb nc">import { Form, Formik } from 'formik'<br/>import {<br/>  Radio,<br/>  RadioGroup,<br/>  FormControlLabel,<br/>  FormControl,<br/>  FormLabel<br/>} from '@material-ui/core'</span><span id="6149" class="my ly iq lv b gy nd na l nb nc">const App: React.FC = () =&gt; {</span><span id="c0fa" class="my ly iq lv b gy nd na l nb nc">}</span><span id="196c" class="my ly iq lv b gy nd na l nb nc">export default App</span></pre><p id="f642" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">App</code>函数之外，定义单选按钮值的<a class="ae kv" href="https://www.typescriptlang.org/docs/handbook/enums.html" rel="noopener ugc nofollow" target="_blank">枚举</a>:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="9647" class="my ly iq lv b gy mz na l nb nc">enum Options {<br/>  Option1,<br/>  Option2,<br/>  Option3,<br/>}</span></pre><p id="8a18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过添加一条<code class="fe ls lt lu lv b">return</code>语句使该函数成为一个组件:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="db22" class="my ly iq lv b gy mz na l nb nc">const App: React.FC = () =&gt; {<br/>  return ()<br/>}</span></pre><p id="d18e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您应该得到一个TypeScript错误。这完全没问题——您需要先<a class="ae kv" href="https://reactjs.org/docs/components-and-props.html#function-and-class-components" rel="noopener ugc nofollow" target="_blank">返回</a>一个实际的元素。首先要添加的是一个<code class="fe ls lt lu lv b">Formik</code> <a class="ae kv" href="https://formik.org/docs/api/formik" rel="noopener ugc nofollow" target="_blank">元素</a>——一个包装器，它将使你的小表单成为一个受控表单:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="8ce2" class="my ly iq lv b gy mz na l nb nc">return (<br/>  &lt;Formik<br/>    initialValues={{<br/>      selectedOption: Options.Option1.toString()<br/>    }}<br/>      onSubmit={() =&gt; {}}<br/>  &gt;<br/>  &lt;/Formik&gt;<br/>)</span></pre><p id="2159" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些需要注意的事项:</p><ul class=""><li id="2ee1" class="ne nf iq ky b kz la lc ld lf ng lj nh ln ni lr nj nk nl nm bi translated"><code class="fe ls lt lu lv b">initialValues</code> —接受声明表单字段并定义其默认值的对象的属性。</li><li id="a73b" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><code class="fe ls lt lu lv b">Options.Option1.toString()</code>—<strong class="ky ir"/><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/radio" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">单选</strong> </a> <strong class="ky ir">按钮的值必须是</strong> <a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/DOMString" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">字符串</strong> </a> <strong class="ky ir">。</strong>否则<code class="fe ls lt lu lv b"><a class="ae kv" href="https://material-ui.com/api/radio-group/" rel="noopener ugc nofollow" target="_blank">&lt;RadioGroup&gt;</a></code>不起作用。</li><li id="1674" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><code class="fe ls lt lu lv b">onSubmit</code>—这是必须的，尽管你不会去实现它。一个<em class="lw">空函数</em>就可以了。</li></ul><p id="725b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，你需要向福米克要一些把手。<code class="fe ls lt lu lv b"><a class="ae kv" href="https://formik.org/docs/api/formik" rel="noopener ugc nofollow" target="_blank">&lt;Formik&gt;</a></code>渲染功能提供了丰富的<a class="ae kv" href="https://formik.org/docs/api/formik#props-1" rel="noopener ugc nofollow" target="_blank">道具</a>。既然要自己控制底层形态，就需要<code class="fe ls lt lu lv b"><a class="ae kv" href="https://formik.org/docs/api/formik#values--field-string-any-" rel="noopener ugc nofollow" target="_blank">values</a></code>和<code class="fe ls lt lu lv b"><a class="ae kv" href="https://formik.org/docs/api/formik#setfieldvalue-field-string-value-any-shouldvalidate-boolean--void" rel="noopener ugc nofollow" target="_blank">setFieldValue</a>:</code></p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="62e8" class="my ly iq lv b gy mz na l nb nc">&lt;Formik<br/>  initialValues={{<br/>    selectedOption: Options.Option1.toString()<br/>  }}<br/>  onSubmit={() =&gt; {}}<br/>&gt;<br/>  {({ values, setFieldValue }) =&gt; (<br/> <br/>  )}<br/>&lt;/Formik&gt;</span></pre><p id="1455" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您的表单需要驻留在<code class="fe ls lt lu lv b"><a class="ae kv" href="https://formik.org/docs/api/form" rel="noopener ugc nofollow" target="_blank">&lt;Form&gt;</a></code>元素中。这确保了<code class="fe ls lt lu lv b">handleSubmit</code>回调会被触发，即使你明确声明它不应该做任何事情。以下代码:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="9420" class="my ly iq lv b gy mz na l nb nc">{({ values, setFieldValue }) =&gt; (<br/>  &lt;Form&gt;<br/>  <br/>  &lt;/Form&gt;<br/>)}</span></pre><p id="9720" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们添加实际的表单:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="8456" class="my ly iq lv b gy mz na l nb nc">&lt;Form&gt;<br/>  &lt;FormControl component="fieldset"&gt;<br/>    &lt;FormLabel component="legend"&gt;Selected Option&lt;/FormLabel&gt;<br/>    &lt;RadioGroup&gt;<br/>      &lt;FormControlLabel control={&lt;Radio /&gt;} label="Option 1" /&gt;<br/>      &lt;FormControlLabel control={&lt;Radio /&gt;} label="Option 2" /&gt;<br/>      &lt;FormControlLabel control={&lt;Radio /&gt;} label="Option 3" /&gt;<br/>    &lt;/RadioGroup&gt;<br/>  &lt;/FormControl&gt;<br/>&lt;/Form&gt;</span></pre><ul class=""><li id="729d" class="ne nf iq ky b kz la lc ld lf ng lj nh ln ni lr nj nk nl nm bi translated">带有底层<code class="fe ls lt lu lv b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/fieldset" rel="noopener ugc nofollow" target="_blank">&lt;fieldset&gt;</a></code>元素的<code class="fe ls lt lu lv b">&lt;FormControl&gt;</code>充当我们表单的<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/fieldset" rel="noopener ugc nofollow" target="_blank">包装器</a>。根据<a class="ae kv" href="https://material-ui.com/api/form-control/" rel="noopener ugc nofollow" target="_blank">材料文件</a>:</li></ul><blockquote class="ns nt nu"><p id="9598" class="kw kx lw ky b kz la jr lb lc ld ju le nv lg lh li nw lk ll lm nx lo lp lq lr ij bi translated">为表单输入提供诸如填充/聚焦/错误/必需的上下文。依赖上下文提供了高度的灵活性，并确保状态在<code class="fe ls lt lu lv b">FormControl</code>的所有子节点中始终保持一致。</p></blockquote><ul class=""><li id="2afe" class="ne nf iq ky b kz la lc ld lf ng lj nh ln ni lr nj nk nl nm bi translated"><code class="fe ls lt lu lv b"><a class="ae kv" href="https://material-ui.com/api/form-label/#formlabel-api" rel="noopener ugc nofollow" target="_blank">&lt;FormLabel&gt;</a></code> —描述父<code class="fe ls lt lu lv b">&lt;fieldset&gt;</code>元素的<code class="fe ls lt lu lv b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/legend" rel="noopener ugc nofollow" target="_blank">&lt;legend&gt;</a></code>的包装器。</li><li id="83b0" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><code class="fe ls lt lu lv b"><a class="ae kv" href="https://material-ui.com/api/radio-group/" rel="noopener ugc nofollow" target="_blank">&lt;RadioGroup&gt;</a></code> —无线电输入及其相应标签的包装。</li><li id="09d9" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><code class="fe ls lt lu lv b"><a class="ae kv" href="https://material-ui.com/api/form-control-label/#formcontrollabel-api" rel="noopener ugc nofollow" target="_blank">&lt;FormControlLabel&gt;</a></code> —一个Material元素，同时呈现<code class="fe ls lt lu lv b"><a class="ae kv" href="https://material-ui.com/api/radio/" rel="noopener ugc nofollow" target="_blank">&lt;Radio&gt;</a> </code>元素(通过<code class="fe ls lt lu lv b">control</code>道具传递)和由适当道具描述的标签。</li></ul><h1 id="5b3f" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">把所有的放在一起</h1><p id="a842" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">现在，您需要用Formik控制表单。从<code class="fe ls lt lu lv b">&lt;RadioGroup&gt;</code>元素开始。首先，您需要将表单<code class="fe ls lt lu lv b">name</code>传递给它:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="e680" class="my ly iq lv b gy mz na l nb nc">&lt;RadioGroup <strong class="lv ir">name={name}</strong>&gt;</span></pre><p id="e39e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，分配<code class="fe ls lt lu lv b">selectedOption</code>值。请记住，您需要将值表示为字符串。这就是问题所在——没有这一点，表单就不会运行:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="4e2f" class="my ly iq lv b gy mz na l nb nc">&lt;RadioGroup name={name} <strong class="lv ir">value={values.selectedOption.toString()}</strong>&gt;</span></pre><p id="a129" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，提供一个<code class="fe ls lt lu lv b">onChange</code>回调。通常，为了便于使用，Formik会自己处理这些。不幸的是，这次没有。据我所知，这是整合素材的罪魁祸首之一:你需要通过调用<code class="fe ls lt lu lv b">setFieldValue</code>方法来手动完成:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="c684" class="my ly iq lv b gy mz na l nb nc">&lt;RadioGroup name={name} value={values.selectedOption.toString()} <strong class="lv ir">onChange={(event) =&gt; {<br/>  setFieldValue(name, event.currentTarget.value)<br/>}}</strong>&gt;</span></pre><p id="6b3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">至于<code class="fe ls lt lu lv b">&lt;FormControlLabel&gt;</code>，你需要传递<code class="fe ls lt lu lv b">Options</code>枚举值中的一个:</p><pre class="kg kh ki kj gt mu lv mv mw aw mx bi"><span id="2bc8" class="my ly iq lv b gy mz na l nb nc">&lt;FormControlLabel <strong class="lv ir">value={Options.Option1.toString()}</strong> control={&lt;Radio /&gt;} label="Option 1" /&gt;<br/>&lt;FormControlLabel <strong class="lv ir">value={Options.Option2.toString()}</strong> control={&lt;Radio /&gt;} label="Option 2" /&gt;<br/>&lt;FormControlLabel <strong class="lv ir">value={Options.Option3.toString()}</strong> control={&lt;Radio /&gt;} label="Option 3" /&gt;</span></pre><p id="ba25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">调用<code class="fe ls lt lu lv b">npm start</code>后，您应该会看到以下输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/f0d45b0a3dcb288e2eb90efa2afd3ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*qJPT7QN0atu2qMXUJYqDew.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">成品形状</figcaption></figure><p id="670c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。为了同样的完整性，我提供了你到目前为止写的所有东西:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h1 id="0a8a" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">最后的话</h1><p id="b7fd" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">即使本教程对于如此简单的问题来说相当冗长，但是将Material与Formik结合起来的想法一点也不复杂，您可能已经注意到了。这是一件好事——一旦你掌握了这个方法，它就会自然而然地出现在你面前。</p><p id="0798" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">坚持学习！</p></div></div>    
</body>
</html>