<html>
<head>
<title>What Happens When Katy Perry Meets TensorFlow? Let Machine Write New Songs for Us!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">凯蒂·佩里遇到TensorFlow会怎样？让机器为我们写新歌！</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-happens-when-katy-perry-meets-tensorflow-let-machine-write-new-songs-for-us-bf63d2e86a43?source=collection_archive---------3-----------------------#2021-05-17">https://levelup.gitconnected.com/what-happens-when-katy-perry-meets-tensorflow-let-machine-write-new-songs-for-us-bf63d2e86a43?source=collection_archive---------3-----------------------#2021-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="04b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">凯蒂·佩里(Katy Perry)是美国歌手兼词曲作者，TensorFlow是谷歌开发的机器学习库。如果我们把凯蒂·佩里的歌<a class="ae ko" href="https://www.youtube.com/watch?v=CevxZvSJLk8" rel="noopener ugc nofollow" target="_blank"> <em class="kp">吼</em> </a> <em class="kp"> ( </em>歌词<em class="kp"> ) </em>输入TensorFlow的NLP人工神经网络引擎会发生什么？AI写的歌比人类好吗？</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/bf3ff501d702ed3e8753fc2ca28f162b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6l9WYnGJwxtn9WBAZ-eDtg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated"><a class="ae ko" href="https://variety.com/wp-content/uploads/2013/09/katyperry_roar.jpg?w=640" rel="noopener ugc nofollow" target="_blank">https://variety . com/WP-content/uploads/2013/09/Katy Perry _ roar . jpg？w = 640</a>&amp;<a class="ae ko" href="https://en.wikipedia.org/wiki/TensorFlow" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/TensorFlow</a></figcaption></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="8488" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们先来看看输入的歌词:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ln"><img src="../Images/c0a2d9f75e3134fc09e9780d940038ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*MRf2AdtRnfAfXFVJOi8pQA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated"><a class="ae ko" href="https://www.youtube.com/watch?v=CevxZvSJLk8" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=CevxZvSJLk8</a></figcaption></figure><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/534b4156f968e3616e45784ade751835.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*zETO4nNGBKDM-u6xuK-Tnw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated"><a class="ae ko" href="https://www.youtube.com/watch?v=CevxZvSJLk8" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=CevxZvSJLk8</a></figcaption></figure><p id="d2ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们会把上面的歌词输入到TensorFlow。然后我们会看到机器为我们写的新歌。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="7050" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下所有代码都保存在<a class="ae ko" href="https://colab.research.google.com/drive/1MmNrehDHk_4qmsZbuypX2aNnVUp7zSu4?usp=sharing" rel="noopener ugc nofollow" target="_blank">这个Google Colab笔记本</a>中。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lp"><img src="../Images/850d84a754f854425fa365656579e9cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQQqVth72lodSxZLnHw8gg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">输入TF NLP库</figcaption></figure><p id="b94c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们先输入所有必要的TensorFlow库。</p><p id="9c48" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后我们将输入数据:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lq"><img src="../Images/8671f9543600d23f79165178ecbcf8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i03faRyzrOCu1i01CawDTw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">输入歌词数据</figcaption></figure><p id="fea6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有歌词数据都由“数据”变量保存，然后转换成小写字母。数据由换行符“\n”分割，然后生成包含语料库的Python列表:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/6545c9ec690d271afe01d31e5c29d132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*uLvPujWUpzjTYZdF0y4DDQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">歌词语料库</figcaption></figure><blockquote class="ls"><p id="cd95" class="lt lu it bd lv lw lx ly lz ma mb kn dk translated">" tokenizer.fit_on_texts(语料库)"</p></blockquote><p id="5ba7" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">该命令创建一个Python目录，关键字是单词，值是单词的标记(语料库标记化):</p><blockquote class="mh mi mj"><p id="f3d3" class="jq jr kp js b jt ju jv jw jx jy jz ka mk kc kd ke ml kg kh ki mm kk kl km kn im bi translated">{ '我':1，' the': 2，' a': 3，' you': 4，' me': 5，' hear': 6，' my': 7，' got': 8，' goto ':9，' and': 10，' hold ':11，' down': 12，' but': 13，' up': 14，' like': 15，' see': 16，' it': 17，' you ' s ':18，' roar': 19，' to': 20，' that': 21，' had': 22，' now': 23，' cause': 24，' am': 25，'冠军':26，' so 我有:41，“够了”:42，“所有”:43，“眼睛”:44，“of”:45，“老虎”:46，“斗士”:47，“跳舞”:48，“穿越”:49，“开火”:50，“大声”:51，“使用”:52，“咬”:53，“舌头”:54，“保持”:55，“呼吸”:56，“害怕”:57，“摇滚”:58，“船”:59，“制造”:60，“狼狈”:61，“坐下”:62，“安静”:63，“同意”:64，“礼貌”:65 '浮动':81，'蝴蝶':82，'蛰':83，'蜜蜂':84，'挣':85，'条纹':86，'去':87，'从':88，'零':89，'自己':90，'英雄':91}</p></blockquote><p id="4122" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总共有91个标记，然后我们给它加一个“1”来考虑词汇之外的单词。</p><blockquote class="ls"><p id="8d56" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">" total _ words = len(tokenizer . word _ index)+1 "</p></blockquote></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ms"><img src="../Images/bd7322fc01fc46210c465c2376a56199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cdTivKcGgc5nL2HJJQY-vQ.png"/></div></div></figure><p id="ddc8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们将把这个转化为训练数据。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mt"><img src="../Images/bfb97a6e65bb843aa269e5b0cbb83a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RkUct3yjcdGwFzywgKzJkQ.png"/></div></div></figure><blockquote class="ls"><p id="d561" class="lt lu it bd lv lw lx ly lz ma mb kn dk translated">" token _ list = tokenizer . texts _ to _ sequences([line])[0]"</p></blockquote><p id="5182" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">我们首先通过texts_to_sequences函数将每个句子转换成一个标记列表。(由我们之前看到的python字典翻译)</p><blockquote class="mh mi mj"><p id="3a13" class="jq jr kp js b jt ju jv jw jx jy jz ka mk kc kd ke ml kg kh ki mm kk kl km kn im bi translated">例如转换“我曾经咬着舌头屏住呼吸”=&gt; [1，52，20，53，7，54，10，55，7，56]</p></blockquote><p id="8ad6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(到第二个For循环)对于每个标记化列表，我们创建n元语法序列，n的范围从1到句子中标记的总数。</p><p id="8bc2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，将[1，52，20，53，7，54，10，55，7，56]转换为:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/1ac86bf7253d5dc7b1af1fbd3ec5270d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*LEzd9ycjR9IUnXQVgXJdMA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">n _ gram _序列</figcaption></figure><p id="cd76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就把句子分成了几个短语。</p><p id="d711" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们在所有n _ gram _序列的前面填充零。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mv"><img src="../Images/d02404fa17479f302a64d2ebd9fbc758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3A3r7UGibIrJWv0Y3vdww.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">填充序列</figcaption></figure><p id="a04a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们将最后一列标记为y，所有其他列标记为Xs。我们将使用x来预测y。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mw"><img src="../Images/634f64d65bfbe8aa0828f39a8e967c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4mDoOjak-cifhysWINkJTQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">标记</figcaption></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mx"><img src="../Images/633c79270668b91cc40c3bc4897d4caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NctMOEivaoLnMkSo"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">胡尔基·奥莰·塔巴克在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="7244" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，数据工作已经完成。让我们和模型一起工作吧！</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi my"><img src="../Images/930b55b1d201a51c1cb1d82319f53cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3GBVIYHBOwnCtVOewHO_A.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">TensorFlow中的一个简单NLP模型</figcaption></figure><p id="4777" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是一个简单的顺序模型:</p><p id="04ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们放置一个嵌入层，并向嵌入层提供单词总数(唯一的标记)，并将每个标记映射到64个维度。</p><p id="3266" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://www.coursera.org/lecture/customising-models-tensorflow2/the-embedding-layer-GBg9t" rel="noopener ugc nofollow" target="_blank">如果你需要更多的信息，这个</a>视频很好地解释了嵌入层。</p><p id="e6a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其次，我们然后把一个简单的长短期记忆LSTM双向层与20个单位。在进行预测时，LSTM双向层允许信息向前和向后移动。</p><p id="7e13" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在双向层中有两种类型的连接:前向连接(用于过去的信息)和后向连接(用于未来的信息)。</p><blockquote class="ls"><p id="7a2c" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">所以当预测现在的Y时，除了现在的信息，我们还使用了过去的信息和未来的信息。听起来像科幻电影，不是吗？《回到未来》呃？</p></blockquote><figure class="na nb nc nd ne kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mz"><img src="../Images/2192a2e997ff05785a38faaf86bbb562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EBq4ITy0H0L36bsriOA8nA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">把“我曾经咬着舌头屏住呼吸”这句话放到LSTM双向层上</figcaption></figure><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nf"><img src="../Images/6ce446d2ba7962e57cd84f7aacf6550b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4i8pQ85NMQQM5vYrpKbPA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">来自Coursera课程“序列模型”的双向RNN文章</figcaption></figure><p id="1579" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">吴恩达有一个关于双向RNN的很棒的简短解释<a class="ae ko" href="https://www.coursera.org/lecture/nlp-sequence-models/bidirectional-rnn-fyXnn" rel="noopener ugc nofollow" target="_blank">视频</a>。</p><p id="28b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第三，我们为单词总数放置一个密集层，并应用一个softmax激活函数。</p><p id="e741" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将记号的数量作为节点的数量，使得该分类预测可以预测从输入的唯一记号中选择的任何单词，即，为了写一首新歌，机器可以从它已经学习的歌词中选择任何单词。</p><p id="b79b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">softmax激活功能的应用是将预测转化为概率。将选择具有最高预测概率的令牌。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ng"><img src="../Images/934fce2cc1216a1e864f8a15e49bfb38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jgdIQMe6DP9Icfpf.jpeg"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">Softmax激活函数将输出转化为概率:<a class="ae ko" href="https://miro.medium.com/max/3000/1*ReYpdIZ3ZSAPb2W8cJpkBg.jpeg" rel="noopener">https://miro . medium . com/max/3000/1 * reypdiz 3 zsapb 2 w 8 cjpkbg . JPEG</a></figcaption></figure><p id="67cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们使用分类交叉熵损失函数(因为这是一个分类预测)和adam优化器来编译该模型。</p><p id="d1ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">adam优化器(讲座视频<a class="ae ko" href="https://www.youtube.com/watch?v=JXQT_vxqwIs&amp;t=146s" rel="noopener ugc nofollow" target="_blank">此处</a>)结合了动量梯度下降(讲座视频<a class="ae ko" href="https://www.youtube.com/watch?v=k8fTYJPd3_I" rel="noopener ugc nofollow" target="_blank">此处</a>)和均方根传播(RMSProp)的优点(讲座视频<a class="ae ko" href="https://www.youtube.com/watch?v=_e-LFe_igno&amp;t=21s" rel="noopener ugc nofollow" target="_blank">此处</a>)。Adam optimizer是深度学习应用中最常用的优化器之一。</p><p id="f815" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们最终完成了这个简单但设计良好的神经网络架构。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nh"><img src="../Images/cad6a4f81c913c9fa74c5784b9871a37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3BpjJkmHljoVTpYX0Pkqg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">神经网络模型架构</figcaption></figure><p id="0f40" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为没有太多的数据，我们用500个时期训练模型(即，模型将根据数据训练500次。)</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9320d7506f39bee39ce5a46ff08c690a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*_COG2mH4V7bMZAw3MfKz7A.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">具有500个纪元的训练模型</figcaption></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nj"><img src="../Images/3c6379968b9090dcf9f64a488716c5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SaxV3Ix-16GD-0G6"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">照片由<a class="ae ko" href="https://unsplash.com/@pccharles?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">帕拉德普·查理斯</a>在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="be45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看模型对数据的训练有多好:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nk"><img src="../Images/e2caf4429313de33c983c3f4c581f08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJ4tT0kR70mjWdVr9tVM_g.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">培训结果</figcaption></figure><p id="181a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当训练接近500个历元时，准确度保持接近0.95。这表明模型已经从最后的数据中学习得很好。</p><p id="add9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">事实上，即使在150个时期之后，该模型也从数据集得到了良好的训练:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nl"><img src="../Images/27cb7ce7c6e0b2fb919b44d90eeeb2a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4yedCPVNcxLR3Gv8mGmdyg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">培训结果</figcaption></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nm"><img src="../Images/af15e17ea41232665a1a32ead1025a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3nrfxjTVPFuPNVhI"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">由<a class="ae ko" href="https://unsplash.com/@tobiastu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托拜厄斯·图利乌斯</a>在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="ce27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，表演时间到了！</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nn"><img src="../Images/8ae572ea12c2abe77ab782fabd06f4bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z6e5XFCszM0hLuwNVLvRQw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">让张量流写新歌</figcaption></figure><p id="950d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们给模型输入一个种子文本:“你会听到姚的怒吼”，然后让模型为我们写下接下来的100个单词。</p><p id="8012" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">for循环的用途是允许模型对预测进行预测。所以新歌时间越长，歌词质量就会下降。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi no"><img src="../Images/aa415f17fa1e89e8c6cc3dbfedadf04e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*89YNqWAxuDVS1Sem"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">照片由<a class="ae ko" href="https://unsplash.com/@alireza_attari?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alireza Attari </a>在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="c7bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们听/读这首新歌吧！🎵</p><blockquote class="ls"><p id="517e" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">你会听到姚的怒吼</p><p id="14f0" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">起床了</p><p id="c943" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">起床起床</p><p id="000a" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">起床</p><p id="18d7" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">向上通过点</p><p id="89af" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">点战斗机战斗机战斗机战斗机战斗机战斗机战斗机</p><p id="bac4" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">乱点乱点乱点乱点乱点</p><p id="b3d3" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">我是零乱乱乱</p><p id="dda0" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">我是英雄乱乱乱乱偏离主题</p><p id="999f" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">点点战斗机</p><p id="ab86" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">乱七八糟一点</p><p id="ef86" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">乱七八糟的选择</p><p id="d5d7" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">我是零乱乱乱</p><p id="5663" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">我是英雄狼狈狼狈狼狈</p><p id="a303" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">偏离主题</p><p id="3da3" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">点点战斗机</p><p id="d315" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">乱七八糟一点</p><p id="1fa5" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">乱七八糟的选择</p><p id="6b73" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">我是零乱乱乱</p><p id="d4a6" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">我是英雄狼狈狼狈狼狈</p><p id="ef7e" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">偏离主题</p><p id="7e37" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">点点点</p><p id="e10b" class="lt lu it bd lv lw mn mo mp mq mr kn dk translated">战斗机食堂食堂</p></blockquote><p id="1344" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">我不知道你是怎么想的，但至少，我得到了一个很好的笑XD。</p><p id="9b57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">生成的歌词质量不高，是因为这个输入语料库规模太小，机器在预测上做预测。这个模型和数据还有很大的改进空间，本文只是提供一个起点！</p><p id="406a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创意AI？创意AI！</p></div></div>    
</body>
</html>