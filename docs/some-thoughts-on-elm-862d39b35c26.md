# 榆树:成功与失败

> 原文：<https://levelup.gitconnected.com/some-thoughts-on-elm-862d39b35c26>

## 对榆树利弊的解释

![](img/4963d9f1f5819d759f39f5cb116acc12.png)

我从 2017 年年中开始玩 Elm 分分合合。总之，榆树和我的关系很复杂。我**喜欢** Elm 作为一门语言——它的语法有点脱离你的方式，让你专注于你实际写的东西。编译器是一位严格但充满爱心的老师。此外，确信编译的*代码不会抛出运行时异常*，这是一个巨大的安慰。

与此同时，前端生态系统的其余部分正在向前冲刺(在许多方面！)，而且我在工作中使用 React，所以很难在我的空闲时间中投入任何重要的部分来学习 Elm。

对于那些不太熟悉 Elm 的人来说，它是一种功能性的*编译成 JavaScript 的*语言，主要用于构建健壮的、抗 bug 的 ui。虽然它是一种与 JavaScript 完全不同的语言，但它的预期用例使它成为其他 JavaScript 框架的直接竞争对手，如 React、Angular 和 Vue。然而，差异是巨大的(不管是好是坏)——Elm 真的是一种完全不同的语言！

选择任何一种语言都是选择随之而来的权衡。这里有几个方面我觉得 Elm 非常可爱，也有几个方面我不太喜欢。

# Make-Its:为什么我喜欢 Elm 作为一种语言

# 1.强力打字

Elm 是一种*强类型*语言，与 JavaScript 的*弱类型*相反。这意味着你声明的所有函数都有一个*类型签名*。

例如，如果我写了一个名为`add`的函数，它采用两个数字&返回相加的结果，它看起来就像这样。

## Java Script 语言

```
const add = (a, b) => a + b
```

## 榆树

```
add: Number -> Number -> Number 
add a b = 
    a + b
```

当我想调用函数时，强类型的关键很重要。如果我忘记传递一个数字，而是传递字符串作为我的参数，会发生什么？

## Java Script 语言

```
const sum = add('a', 'b') // returns the string "ab" 🤔
```

## 榆树

```
sum = add "a" "b" -- throws a compiler error that's helpful! 🎉
```

Elm 中函数的定义包括一个*类型签名*——表明`add`函数接受 2 个数字作为参数&返回一个数字作为结果。由于 Elm 编译器通常足够智能，能够为您推断出您的类型签名，因此您实际上不必键入这个签名来获得所有强类型的东西。然而，我发现随着我玩 Elm 玩得越来越多，我发现自己在思考我正在编写的函数的类型签名。

虽然 JavaScript 曾几次尝试引入类型(特别是[Flow](https://flow.org/)&[TypeScript](https://www.typescriptlang.org/))，但它们都远远达不到 Elm 的类型语法&静态类型检查功能。在 Elm 中，类型声明更像是一等公民，鼓励开发人员更多地考虑类型。

# 2.强制错误处理

在 Elm 中，如果您不处理应用程序代码中的潜在故障点，编译器会非常生气。

例如，假设您对某个 JSON 发出网络请求。您将对这个 JSON blob 进行操作，以呈现一篇博客文章(就像您正在阅读的这篇文章。谢谢😜)你期望 JSON 是这样的。

```
{ 
  "title": "Some cool stuff about Elm", 
  "body": "It's fun!", 
  "author": "Benjamin Johnson", 
  "dateCreated": "2018-01-25" 
}
```

很简单，对吧？您只需获得 JSON，并使用适当的键来呈现您的博客文章。

**没那么快。**

如果在用户加载您的 web 页面和发出请求的过程中网络中断了，会发生什么呢？如果 JSON 返回一个作者数组而不是一个字符串，会发生什么？如果`dateCreated`是`null`会怎么样？

所有这些都是可能的，特别是如果你依赖第三方 API 来交付你的内容或者你正在与其他开发者合作。尽管你可能想说“那不应该发生。后端工程师会让我知道他们何时改变了有效负载”——事实是，即使在最好的组织中，有时也会发生这种问题。

在 JavaScript 中，您*可以*(不是说您总是这样做，也绝对不是说您应该这样做)编写代码，假设 JSON 响应每次都能完美加载。你可能不会发现你的应用失败了，直到你得到一个错误提示`Cannot read property `body` of `undefined``。现在你必须通过调试器爬行。或者你不小心把`null`这个词渲染到你的屏幕上。远远不是最好的 UX。

Elm 强迫你为任何可能导致*失败*的操作编写错误处理代码。比如网络请求、浏览器中的地理定位或基于时间的操作(例如，将字符串转换为时间戳)。它能够做到这一点的主要原因是静态类型系统。当编译器发现这些没有错误处理代码的“潜在失败”操作时，它会拒绝编译，直到您编写一些代码来处理您的错误。

正如我所说的，可以编写 JavaScript 来处理这些潜在的错误，但是当您忘记编写错误处理程序时，有编译器在身边真的很有帮助。我见过很多因为开发人员忘记处理边缘情况或编写防御所有故障点的代码而发生的错误。

# 3.纯功能性的

虽然纯粹的函数式语言很棒，但是没有某种形式的状态管理的纯粹性对于 ui 来说并不好用(我们需要能够响应用户输入和状态变化😜).Elm 通过管理 Elm 运行时内部的状态突变来保持语言的纯净。这种管理状态更新的方法，通常被称为“[Elm 架构](https://guide.elm-lang.org/architecture/)”，在 Elm 社区之外也很常见(React + Redux 就是一个典型的例子)。

用这种范式编程使你的 UI 成为应用程序状态的纯函数，这意味着推理你的应用程序的各个部分变得非常简单。*Elm 中的所有东西都只是一个函数*，这往往会产生可读性很强、容易理解的代码(这是一个全方位的胜利！).

# 反驳:为什么我不是 100%喜欢榆树

# 1.很难打败 JavaScript 生态系统

说说你对“JavaScript 疲劳”的看法，每周都有一个新的框架出现:在前端 JS 世界中有一个*吨*的竞争，这导致最好的解决方案上升到顶端(通常)。

此外，如果你正在使用一个新的 JS 框架，将它与你喜欢的前端堆栈的其他部分(CSS/SCSS/LESS/CSS-in-JS，实用程序库等)集成起来通常不会太困难。).

与 JavaScript 代码的混合使得 Elm 更难进行类型检查并实现其“无运行时异常”的承诺，因此有一个通过“端口”与 JavaScript 包通信的过程。然而，与 JS 端口进行通信可能会相当乏味，我发现自己编写了很多自己的逻辑，如果我是用 JS 工作的话，我可能会使用实用程序。

我非常喜欢保持最小化&只在你需要的时候使用第三方依赖，但是 JS 生态系统的一个美丽的部分是，当你需要快速移动或者当你想要隔离你正在学习的特定概念时，你可以在 NPM 上使用这些包(也就是说，你只想学习 Vue 作为一个框架，所以你使用 Vue 材料或 Bootstrap，这样你就不会把所有宝贵的时间都花在设计你的组件上)。

# 2.HTML 模板有点奇怪

Elm 社区声称，随着时间的推移，您会习惯 HTML 语法，但它从未真正吸引我。这里有一个 Elm“模板”(或“视图”功能)的简单例子。

```
view model = 
    div [] [ 
        button [ onClick Decrement ] [ text " - " ] 
        , div [] [ text (toString model) ] 
        , button [ onClick Increment ] [ text " + " ] 
    ]
```

在上面的例子中，每个 HTML 元素都是一个带有两个参数的函数，并以其对应的 HTML 标签命名。第一个参数包含一个应用于标签的所有 HTML 属性的`List`(数组)。第二个参数包含元素的所有子元素的数组。以这种方式做 HTML 模板背后的理论是，Elm 中的所有东西都是简单的函数，但是在实践中，我觉得有点笨拙。

相比之下，像 JSX，感觉更接近原始 HTML。

```
const view = model => ( 
  <div> 
    <button onClick={Decrement}> - </button> 
    <div>{model}</div> 
    <button onClick={Increment}> + </button> 
  </div> 
)
```

或者类似 Vue 的模板语法，它只是建立在 HTML 之上

```
<div> 
  <button v-on:click="Decrement"> - </button> 
  <div>{{model}}</div> 
  <button v-on:click="Increment"> + </button> 
</div>
```

在我看来，React & Vue 模板语法更容易快速阅读，尽管它们可能不像 Elm 的 HTML 函数那样灵活和可组合。

# 3.缺乏大公司的支持

一方面，我甚至不愿意将此作为反对 Elm 作为一种语言的理由。语言的好坏取决于它孤立运作的方式(在一个完美的世界中……)。

然而，我在与同事交谈时发现，关于 Elm 的主要问题是它没有得到任何大公司的支持。我敢说，我没有看到太多公司采用它的原因是，如果没有大公司的大笔资金，这种语言的发展和支持可能会突然结束。

前端环境变化很快，保持语言的更新是一项全职工作(支持 Elm 的人)。此外，编译目标(JavaScript)并不是静止不动的——事实上，JavaScript 正在以极快的速度发展，每年都在获得新的特性和浏览器 API。希望我们能看到 Elm 继续存在并保持更新，因为它是一种非常令人愉快的语言。

# 结论

我仍然认为 Elm 100%值得学习——如果你有时间的话。它的价值在于它迫使你思考编程。如果您从服务器收到的 JSON 没有您期望的密钥，会发生什么？如果用户的浏览器不能给你地理位置数据怎么办？(这两者都是我在过去一年左右从事的 JS 中特别棘手的错误的来源)。

Elm 强迫你处理所有的错误，点上所有的“我”，划掉所有的“t”。即使你没有开始在工作场所使用它，扩展你的思维和尝试新范式的好处是巨大的。

但是，我也知道和感受到开发商对 Elm 持保留态度的情绪。对于在前端生态系统中工作的许多人来说，它是一种不同的、不熟悉的语言，如果您试图快速移动或集成前端生态系统的其他部分，它在类型安全和运行时安全之间做出的权衡确实会增加一点复杂性。

喜欢你读的吗？不同意？请随意给我发推特或在 T2 的 LinkedIn 上联系我。感谢阅读！

*原载于*[*www . Benjamin Johnson . me*](https://www.benjaminjohnson.me/blog/thoughts-on-elm/)*。*