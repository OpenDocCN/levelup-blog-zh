<html>
<head>
<title>Feature Engineering for Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的特征工程</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/feature-engineering-for-machine-learning-algorithms-7f1c98d98d93?source=collection_archive---------18-----------------------#2020-03-28">https://levelup.gitconnected.com/feature-engineering-for-machine-learning-algorithms-7f1c98d98d93?source=collection_archive---------18-----------------------#2020-03-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a2de" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我一直在写关于韩国仁荷大学提供的研究生课程“机器学习和数据分析”的文章。这将是它的第7部分，您可以跟随其他部分:<a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-1-be288b619fb5?source=friends_link&amp;sk=583ba29a0766ad36bc993cddc642b11f" rel="noopener" target="_blank">第1部分</a>、<a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-2-3fb599732021?source=friends_link&amp;sk=80523165c66560e46f907da4c8af0d95" rel="noopener" target="_blank">第2部分</a>、<a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-3-51cb64c10901?source=friends_link&amp;sk=a735571ab8f7bc418703fc3147eb6ecb" rel="noopener" target="_blank">第3部分</a>、<a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-4-67aa1aa9c95d?source=friends_link&amp;sk=9f1a2d1a77df1e9019cfea70b9de7edb" rel="noopener" target="_blank">第4部分</a>、<a class="ae ko" href="https://towardsdatascience.com/python-oop-corey-schafer-datacamp-be6b0b3cafc6" rel="noopener" target="_blank">第5部分</a>和<a class="ae ko" href="https://medium.com/datadriveninvestor/the-types-and-procedure-of-machine-learning-8ba691c3ddf" rel="noopener">第6部分</a>。</p><p id="3db1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个故事中，我将尝试演示处理机器学习算法的数据特征过程。从原始数据中提取特征的过程可以增强机器学习(ML)算法的性能，这一过程被称为<strong class="js iu">特征工程</strong>。它有助于数据集与特定的ML算法兼容，提高对未知数据的准确性，使算法能够更快地训练，并降低模型的复杂性。</p><p id="e627" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">据《福布斯》报道，数据科学家大约80%的时间用于数据准备，其中60%用于数据清理和组织。在Elite Data science的另一项研究中，他们提到，预计一个项目大约45%的时间将花费在数据清理和功能工程上。所以很明显，数据特征或特征工程是任何基于机器学习和人工智能的项目中最重要的部分。</p><div class="kp kq kr ks gt ab cb"><figure class="kt ku kv kw kx ky kz paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><img src="../Images/6ce9c135e59421eb1bde82beab91500c.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*wn0Zk5-y43ZuE2Oj-tOPGQ.png"/></div></figure><figure class="kt ku lg kw kx ky kz paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><img src="../Images/2c90b5f94d595d3d3684efee62cd1d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/0*31405iCmM5uqC8T5.jpg"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk ll di lm ln translated">基于ML和AI的成功项目的时间安排(来源:<a class="ae ko" href="https://elitedatascience.com/wp-content/uploads/2018/05/What-Goes-Into-a-Successful-Model.jpg" rel="noopener ugc nofollow" target="_blank">EDS</a>&amp;<a class="ae ko" href="https://thumbor.forbes.com/thumbor/960x0/https%3A%2F%2Fblogs-images.forbes.com%2Fgilpress%2Ffiles%2F2016%2F03%2FTime-1200x511.jpg" rel="noopener ugc nofollow" target="_blank">Forbes</a>)</figcaption></figure></div><p id="2b2a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不再拖延，让我们深入了解数据特征流程。该过程由如下所示的五个步骤组成。从下载数据集到在特定的ML算法中训练数据集，特征选择过程应该继续。让我们分别演示这些过程。</p><figure class="kp kq kr ks gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi lo"><img src="../Images/dfd9f070cf1d60a49538be79674a369d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uH_Hj_0xZOD0SooItLpVNA.png"/></div></div><figcaption class="lh li gj gh gi lj lk bd b be z dk translated">数据表征过程</figcaption></figure><h2 id="a518" class="lp lq it bd lr ls lt dn lu lv lw dp lx kb ly lz ma kf mb mc md kj me mf mg mh bi translated">1.下载和加载数据</h2><p id="c784" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">机器学习算法有大量的免费资源。以下是一些公开可用的数据集资源:</p><ul class=""><li id="0cdb" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated"><strong class="js iu">开放数据存储</strong>T2】▹<a class="ae ko" href="http://archive.ics.uci.edu/ml/" rel="noopener ugc nofollow" target="_blank">加州大学欧文分校</a>t5】▹<a class="ae ko" href="http://www.kaggle.com/datasets" rel="noopener ugc nofollow" target="_blank">kaggle数据集</a>t8】▹<a class="ae ko" href="http://aws.amazon.com/ko/datasets" rel="noopener ugc nofollow" target="_blank">亚马逊AWS数据集</a></li><li id="1999" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated"><strong class="js iu">元门户(数据门户列表)<br/></strong>http://dataportals.org/<a class="ae ko" href="http://dataportals.org/" rel="noopener ugc nofollow" target="_blank">▹</a><br/>http://opendatamonitor.eu/<a class="ae ko" href="http://opendatamonitor.eu/" rel="noopener ugc nofollow" target="_blank"><br/>▹</a><a class="ae ko" href="http://quandl.com" rel="noopener ugc nofollow" target="_blank">http://quandl.com</a></li><li id="4816" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated"><strong class="js iu">数据门户列表<br/> </strong> ▹ <a class="ae ko" href="https://goo.gl/SJHN2k" rel="noopener ugc nofollow" target="_blank">维基百科</a><br/>▹<a class="ae ko" href="http://goo.gl/zDR78y" rel="noopener ugc nofollow" target="_blank">quora</a><br/>▹<a class="ae ko" href="http://www.reddit.com/r/datasets" rel="noopener ugc nofollow" target="_blank">subreddit</a></li></ul><p id="5312" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个数据集中可能有几种类型的数据。以下是从机器学习角度来看的<strong class="js iu">数据类型</strong>:</p><p id="cdf4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">数字数据</strong>:连续型(身高、体重、工资等)。)或离散数据(售出的单位、学生人数、使用的语言数量)<br/><strong class="js iu">分类数据</strong>:定性数据(种族、性别、年龄组和教育水平)。您可以为分类数据分配一些数字，但它们没有任何数学意义<br/><strong class="js iu">时间序列数据</strong>:一系列数据点，测量同一时间的同一事物，按时间顺序存储。<br/><strong class="js iu">Text</strong>:words<br/><strong class="js iu">Image，Stream </strong>:图像存储在较大的二进制数据块中。数据集中单元的数据类型是二进制大型对象(BLOB)。流是一段时间内可用的数据元素序列。<br/><strong class="js iu">互联网(网址)</strong>:网址的域名和后缀是唯一需要的元素(如example.com)。</p><p id="276a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">数据结构:</strong></p><ul class=""><li id="0660" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated"><strong class="js iu">数据<br/></strong><strong class="js iu">结构化数据</strong>:表格、CSV<br/><strong class="js iu">非结构化数据</strong>:视频、语音、文本、流等。</li><li id="2021" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated"><strong class="js iu">带SQL </strong> <br/>的数据库基于表格<br/>RDB:Oracle，SQL <br/>文件:CSV，Excel</li><li id="3862" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ms mt mu mv bi translated"><strong class="js iu">无SQL的数据库</strong><br/>MongoDB、Amazon DynamoDB、MS CosmosDB <br/>基于文档:图形、文档</li></ul><pre class="kp kq kr ks gt nb nc nd ne aw nf bi"><span id="f25f" class="lp lq it nc b gy ng nh l ni nj">import pandas as pd</span><span id="197e" class="lp lq it nc b gy nk nh l ni nj">df = pd.read_csv('datasets/housing/housing.csv')<br/>df1 = pd.read_excel("/filepath/filename.xlsx", sheetname="Invoice")</span><span id="d7b3" class="lp lq it nc b gy nk nh l ni nj">from scipy import misc<br/>import matplotlib.pyplot as plt<br/>f = misc.face()<br/>Misc.imsave('image_name.png', f)<br/>Plt.imshow(f)<br/>Plt.show()</span></pre><p id="b78d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">按照代码，我们可以加载CSV、excel和图像文件，以推进特征工程过程。</p><h2 id="9228" class="lp lq it bd lr ls lt dn lu lv lw dp lx kb ly lz ma kf mb mc md kj me mf mg mh bi translated">2.快速浏览数据结构</h2><p id="5d18" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">为了快速查看数据结构，我们可以遵循以下命令:</p><pre class="kp kq kr ks gt nb nc nd ne aw nf bi"><span id="9930" class="lp lq it nc b gy ng nh l ni nj"><strong class="nc iu">df.head()            </strong># <!-- -->look at the top five rows<strong class="nc iu"><br/></strong><strong class="nc iu">df.info()            </strong># <!-- -->quick description of the data<strong class="nc iu"> <br/>df.describe()        </strong># summary of the numerical attributes<strong class="nc iu"><br/>df.hist()            </strong># <!-- -->plot a histogram for each numerical attribute</span></pre><h2 id="c05a" class="lp lq it bd lr ls lt dn lu lv lw dp lx kb ly lz ma kf mb mc md kj me mf mg mh bi translated">3.创建测试集</h2><p id="2bf8" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">在您进一步查看数据之前，您需要创建一个测试集并将其放在一边(大约20%)。您可以随机选取一些实例，通常是数据集的20%，然后将它们放在一边。我们可以使用scikit学习库(随机地)进行训练、测试分割。如以下命令所示，测试大小为0.2，这意味着如果我们有一个10行的数据集，那么8行将用于训练，2行用于测试。将随机做出选择。</p><pre class="kp kq kr ks gt nb nc nd ne aw nf bi"><span id="1ccd" class="lp lq it nc b gy ng nh l ni nj">from sklearn.model_selection import train_test_split</span><span id="6c7c" class="lp lq it nc b gy nk nh l ni nj">train_set, test_set = train_test_split(housing, test_size=0.2, random_state=43)</span></pre><h2 id="09f0" class="lp lq it bd lr ls lt dn lu lv lw dp lx kb ly lz ma kf mb mc md kj me mf mg mh bi translated">4.发现数据</h2><p id="009e" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">现在，我们需要发现和可视化数据，以获得洞察力。您将只探索训练集。我们可以利用数据可视化库<em class="nl"> seaborn </em>将数据可视化，生成几个图(<em class="nl">散点图</em>、<em class="nl">条形图</em>、<em class="nl">对线图</em>、<em class="nl">箱线图</em>、<em class="nl">热图</em>、<em class="nl">联合图</em>、<em class="nl">猫线图</em>等。).利用彼此对应的特征绘制大量图形，我们可以确定最有价值的特征，这些特征可以使数据集与特定的ML算法更加兼容，并提高算法的准确性。我们需要找出特征之间的相关性，这可以通过计算标准相关系数和开发几个数据可视化库来获得。</p><h2 id="bb94" class="lp lq it bd lr ls lt dn lu lv lw dp lx kb ly lz ma kf mb mc md kj me mf mg mh bi translated">5.为机器学习准备数据</h2><p id="5a32" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">为了准备ML算法的数据，我们需要遵循三个准备步骤。它们描述如下:</p><ul class=""><li id="f94c" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated"><strong class="js iu">数据清理</strong>:对于任何一种缺失、损坏或不准确的数据，我们都可以利用<code class="fe nm nn no nc b">dropna()</code>、<code class="fe nm nn no nc b">drop()</code>、<code class="fe nm nn no nc b">fillna()</code>的方法进行替换。例如下面是泰坦尼克号数据集的<code class="fe nm nn no nc b">tail()</code>。这里我们可以看到<strong class="js iu"> <em class="nl">年龄</em> </strong>和<strong class="js iu"> <em class="nl">舱室</em> </strong>栏有缺失信息。这里我们可以用几种方法来处理它。我们可以避开整列，或者我们可以删除缺少值的行，或者我们可以用列的平均值填充NaN值，如果它有数值的话。比如我们可以用<strong class="js iu"> <em class="nl">列的平均值来填充</em> </strong>列的缺失值。</li></ul><figure class="kp kq kr ks gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi np"><img src="../Images/75c633192b36e56a24b965bfa3b2f41f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLT4Xobb5YCzGLZ4r1gTog.png"/></div></div><figcaption class="lh li gj gh gi lj lk bd b be z dk translated">泰坦尼克号数据集训练集的尾部</figcaption></figure><ul class=""><li id="a7ea" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated"><strong class="js iu">处理文本和分类属性</strong>:无论如何，大多数机器学习算法更喜欢处理数字，所以我们需要将文本和分类属性转换为数字。例如，我们可以通过将<em class="nl">男性</em> = 0和<em class="nl">女性</em> = 1来将Titanic数据集的<strong class="js iu"> <em class="nl">性别</em> </strong>列转换为数值，或者我们可以将两个列<em class="nl">男性</em>和<em class="nl">女性</em>设置为0/1。这些过程被称为<em class="nl">顺序编码器</em>和<em class="nl">一个热编码器</em>。<em class="nl">顺序编码器</em>将分类特征编码为一个整数数组，而<em class="nl">一个热编码器</em>将分类特征编码为一个热数值数组。这个概念在下图中会更加清晰。</li></ul><div class="kp kq kr ks gt ab cb"><figure class="kt ku nq kw kx ky kz paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><img src="../Images/a7ca1ae7ed30eb229ceaded035e29e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*8l6uYkpTTKLzN3Jl5OAIdw.png"/></div></figure><figure class="kt ku nr kw kx ky kz paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><img src="../Images/3f9540a122911a9f18d835a3fa1ac68c.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*ZAOpkbxSDTchMq-zupeCZA.png"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk ns di nt ln translated">一个热编码器和顺序编码器的例子。(<a class="ae ko" href="http://www.renom.jp/notebooks/tutorial/preprocessing/category_encoding/notebook.html" rel="noopener ugc nofollow" target="_blank">来源</a>)</figcaption></figure></div><ul class=""><li id="0cbb" class="mn mo it js b jt ju jx jy kb mp kf mq kj mr kn ms mt mu mv bi translated"><strong class="js iu">特征缩放</strong>:当输入的数字属性具有非常不同的缩放比例时，机器学习算法表现不佳。我们可以遵循最小-最大缩放或标准化过程来缩放或属性。特征缩放可以在弱机器学习模型和强机器学习模型之间产生差异。</li></ul><figure class="kp kq kr ks gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi nu"><img src="../Images/154cb928553cccd5a2f06c70d4172693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMpQQ2wM3K9icxahduQSlQ.png"/></div></div><figcaption class="lh li gj gh gi lj lk bd b be z dk translated">最小-最大特征缩放</figcaption></figure><p id="4bf4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我的下一篇文章中，我将用分类数据、图像数据和时态数据来演示整个过程。非常感谢您的关注。我希望这能帮助你对ML算法中的特征工程有一个更清晰的认识。我仍然在学习走向数据科学和人工智能的每一步。如果有任何错误或任何类型的建议和批评是高度赞赏。你可以跟踪与这个故事相关的前几个故事。</p><p id="93e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以前的故事:</p><p id="2c73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-1-be288b619fb5?source=friends_link&amp;sk=583ba29a0766ad36bc993cddc642b11f" rel="noopener" target="_blank"><strong class="js iu">Part-1</strong></a><strong class="js iu">:</strong>python基础及安装<br/><a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-2-3fb599732021?source=friends_link&amp;sk=80523165c66560e46f907da4c8af0d95" rel="noopener" target="_blank"><strong class="js iu">Part-2</strong></a><strong class="js iu">:</strong>第二章:Python数据结构—数据类型<br/><a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-3-51cb64c10901?source=friends_link&amp;sk=a735571ab8f7bc418703fc3147eb6ecb" rel="noopener" target="_blank"><strong class="js iu">Part-3</strong></a><strong class="js iu">:</strong>Python中的控制语句(循环)<br/><a class="ae ko" href="https://towardsdatascience.com/machine-learning-and-data-analysis-inha-university-part-4-67aa1aa9c95d?source=friends_link&amp;sk=9f1a2d1a77df1e9019cfea70b9de7edb" rel="noopener" target="_blank"><strong class="js iu">Part:4</strong></a><strong class="js iu">:</strong>Python函数【T49<br/><a class="ae ko" href="https://medium.com/datadriveninvestor/the-types-and-procedure-of-machine-learning-8ba691c3ddf" rel="noopener"><strong class="js iu">Part-6</strong></a><strong class="js iu">:</strong>机器学习的类型&amp;程序</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="3e1b" class="oc lq it bd lr od oe of lu og oh oi lx oj ok ol ma om on oo md op oq or mg os bi translated">参考链接:</h1><ol class=""><li id="840f" class="mn mo it js b jt mi jx mj kb ot kf ou kj ov kn ow mt mu mv bi translated"><a class="ae ko" href="https://elitedatascience.com/feature-engineering" rel="noopener ugc nofollow" target="_blank">https://elitedatascience.com/feature-engineering</a></li><li id="7609" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ow mt mu mv bi translated"><a class="ae ko" href="https://developers.google.com/machine-learning/crash-course/representation/feature-engineering" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/machine-learning/crash-course/re presentation/feature-engineering</a></li><li id="dca5" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ow mt mu mv bi translated"><a class="ae ko" href="https://www.kdnuggets.com/2018/12/feature-engineering-explained.html" rel="noopener ugc nofollow" target="_blank">https://www . kdnugges . com/2018/12/feature-engineering-explained . html</a></li><li id="fcab" class="mn mo it js b jt mw jx mx kb my kf mz kj na kn ow mt mu mv bi translated"><a class="ae ko" href="https://heartbeat.fritz.ai/a-practical-guide-to-feature-engineering-in-python-8326e40747c8" rel="noopener ugc nofollow" target="_blank">https://heart beat . fritz . ai/a-practical-guide-to-feature-engineering-in-python-8326 e 40747 c8</a></li></ol></div></div>    
</body>
</html>