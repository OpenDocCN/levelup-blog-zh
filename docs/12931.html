<html>
<head>
<title>How to Generate UUID in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在JavaScript中生成UUID</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-generate-uuid-in-javascript-279048d9089f?source=collection_archive---------2-----------------------#2022-07-24">https://levelup.gitconnected.com/how-to-generate-uuid-in-javascript-279048d9089f?source=collection_archive---------2-----------------------#2022-07-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e54d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">什么是UUID</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4d33b83428c014f63009e45c407529b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dEKCk6O61UY_reau"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="8e49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">通用唯一标识符(UUID) </strong>是一个128位的标签，用于计算机系统中的信息。UUID是唯一的，根据开放软件基金会(OSF)建立的标准计算，它使用纳秒时间、MAC地址、随机数等。以生成空间和时间上的所有“唯一”标识符。虽然它的重复概观不为零，但它足够接近，可以忽略不计。这样我们每个人都可以创建不与他人冲突的UUIDs。这广泛应用于各种场景，如文件系统、数据库等。</p><p id="4888" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么如何用JavaScript生成UUID呢？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="09cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们可以用<code class="fe mc md me mf b">Math.random</code>生成一个随机数。它的范围大于或等于0但小于1，它将大致均匀地分布在该范围内。然后可以通过<code class="fe mc md me mf b">Number.prototype.toString(radix)</code>转换成<code class="fe mc md me mf b">radix</code>基地:</p><pre class="kj kk kl km gt mg mf mh mi aw mj bi"><span id="f96e" class="mk ml it mf b gy mm mn l mo mp">const random = Math.random();</span><span id="d67f" class="mk ml it mf b gy mq mn l mo mp">// 0.5924748832860516<br/>console.log('random: ', random);</span><span id="44ea" class="mk ml it mf b gy mq mn l mo mp">// 0.97ac6f176a3e<br/>console.log(Number(random).toString(16));</span><span id="6db8" class="mk ml it mf b gy mq mn l mo mp">// 0.ium6u5ra7o<br/>console.log(Number(random).toString(32));</span></pre><p id="7b94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是它不提供密码安全的随机数，不要把它用于任何与安全相关的事情。</p><p id="feda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么回到主题，如何生成UUID呢？</p><p id="351e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，介绍一个简单的方法，那就是使用Blob:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="9e4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来不错，但这是一个黑客，不建议生产使用。</p><p id="beb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对Blob感兴趣，欢迎查看这篇文章:</p><div class="mt mu gp gr mv mw"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-use-blob-in-browser-to-cache-ee9577b77daa"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">如何在浏览器中使用Blob对象进行缓存</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">缓存可以大大提高应用程序的性能</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk ks mw"/></div></div></a></div><p id="0f6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么浏览器和Node.js有没有提供生成UUIDs的API呢？答案是肯定的，我们可以调用<code class="fe mc md me mf b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">crypto.randomUUID()</strong></a></code>生成一个UUID。其兼容性如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/fa9881b9ad5bbcea9c1653970ef8826a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nk5uD1MmlQfyZ2kYJebo3g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID" rel="noopener ugc nofollow" target="_blank"> MDN </a></figcaption></figure><p id="1b3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可见其兼容性还是不错的。但该功能仅在<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts" rel="noopener ugc nofollow" target="_blank">安全环境</a> (HTTPS)下可用。但是我们的应用程序没有启用HTTPS，还是我们坚持要兼容低版本的浏览器？</p><p id="9e1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码片段可以帮助您:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="8f00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们主要使用<code class="fe mc md me mf b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues" rel="noopener ugc nofollow" target="_blank">window.crypto.getRandomValues()</a></code>来获得一个加密的强随机值，它是<code class="fe mc md me mf b">Crypto</code>在不安全的上下文中唯一可以使用的接口成员。</p><p id="9fc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Node.js中我们可以用<code class="fe mc md me mf b">crypto.randomBytes(1)[0]</code>代替<code class="fe mc md me mf b">crypto.getRandomValues(new Uint8Array(1))[0]</code>。看起来是这样的:</p><pre class="kj kk kl km gt mg mf mh mi aw mj bi"><span id="97d6" class="mk ml it mf b gy mm mn l mo mp">const crypto = require('crypto');</span><span id="ff71" class="mk ml it mf b gy mq mn l mo mp">const getUUID = () =&gt;<br/>  (String(1e7) + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =&gt;<br/>    (Number(c) ^ (crypto.randomBytes(1)[0] &amp; (15 &gt;&gt; (Number(c) / 4)))).toString(16),<br/>  );</span><span id="6c1b" class="mk ml it mf b gy mq mn l mo mp">console.log(getUUID());</span></pre><p id="8ab9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，NPM还有一个知名的第三方库<a class="ae ky" href="https://www.npmjs.com/package/uuid" rel="noopener ugc nofollow" target="_blank"> uuid </a>。引擎盖下也是先用<code class="fe mc md me mf b">crypto.randomUUID()</code>，再用性能优化的算法，可以优先用于生产。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="baf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">感谢阅读。如果你喜欢这样的故事，想支持我，请考虑成为</em> <a class="ae ky" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="nm">中会员</em> </a> <em class="nm">。每月5美元，你可以无限制地访问媒体内容。如果你通过</em> <a class="ae ky" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="nm">我的链接</em> </a> <em class="nm">报名，我会得到一点佣金。</em></p><p id="46f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">你的支持对我来说非常重要——谢谢你。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="25ba" class="nn ml it bd no np nq nr ns nt nu nv nw jz nx ka ny kc nz kd oa kf ob kg oc od bi translated">分级编码</h1><p id="989f" class="pw-post-body-paragraph kz la it lb b lc oe ju le lf of jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="e4c0" class="oj ok it lb b lc ld lf lg li ol lm om lq on lu oo op oq or bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="ed50" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="6d42" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li><li id="5036" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/jobs?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">软件工程师的顶级工作</strong> </a></li></ul></div></div>    
</body>
</html>