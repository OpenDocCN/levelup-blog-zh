<html>
<head>
<title>How to Clean Data With Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用熊猫清理数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-clean-data-with-pandas-e8960e4330c5?source=collection_archive---------11-----------------------#2022-11-28">https://levelup.gitconnected.com/how-to-clean-data-with-pandas-e8960e4330c5?source=collection_archive---------11-----------------------#2022-11-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0820" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Python处理缺失值、异常值和日期</h2></div><p id="6475" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">一旦你收集了数据，每个数据(科学)项目最耗时的任务就开始了:清理数据。</p><p id="456b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据总是杂乱无章:从人为错误(有意或无意)导致的错误数据到缺失值(由空值或null填充),有时您必须管理无法正确解释的格式错误的日期字段…</p><p id="8905" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">幸运的是，本文将解释如何清理数据集，并为探索和数据可视化做好准备！</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/5cd55dac5e18d81aa6a6d63ae611ff43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GLixw7kGH2U8QSmJ"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">如何用熊猫清理数据，由<a class="ae md" href="https://unsplash.com/es/@theluki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Lukas W. </a>拍摄</figcaption></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><blockquote class="ml mm mn"><p id="bb14" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated"><strong class="kk iu">本文是用Python和Pandas教授数据分析和可视化系列文章的第三篇。</strong> <br/>没有先决条件也可以读，但是如果你想读前两个，它们在这里！</p></blockquote><div class="ms mt gp gr mu mv"><a rel="noopener  ugc nofollow" target="_blank" href="/the-basics-of-python-for-data-science-7f9662e921d1"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">数据科学的Python基础</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">Python的安装和主要概念</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj lx mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-collect-data-with-pandas-5fbff0a9cbf4"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">如何用熊猫收集数据</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">TLDR:使用Python从文件和网站中提取数据</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj lx mv"/></div></div></a></div></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="ff99" class="nl nm it bd nn no np nq nr ns nt nu nv jz nw ka nx kc ny kd nz kf oa kg ob oc bi translated">如何查找和管理丢失的数据</h1><blockquote class="od"><p id="ef67" class="oe of it bd og oh oi oj ok ol om ld dk translated"><strong class="ak">数据集不完整时该怎么办？</strong></p></blockquote><p id="a518" class="pw-post-body-paragraph ki kj it kk b kl on ju kn ko oo jx kq kr op kt ku kv oq kx ky kz or lb lc ld im bi translated">在现实世界中，由于各种原因，数据集包含缺失值:</p><ul class=""><li id="329e" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">负责收集的人不在；</li><li id="5f52" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">有一个计算机错误导致了信息的丢失；</li><li id="2df9" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">输入的值无效，已被空数据替换；</li><li id="acce" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi">…</li></ul><p id="9d59" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了进行严格的数据分析，您必须评估缺失值的数量，并决定采取什么措施:</p><ul class=""><li id="7d9f" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">删除它们？</li><li id="a86d" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">修改它们？</li></ul><blockquote class="ml mm mn"><p id="2a51" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated">你可以使用提供的数据集来练习你的批判性思维。</p></blockquote><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="pg ph l"/></div></figure><h2 id="f327" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">选项1:删除缺少值的数据</h2><p id="130a" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">许多初级数据分析师选择删除缺少变量的条目，因为他们不知道如何考虑数据。</p><p id="0560" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在考虑删除之前，问自己以下问题:</p><ul class=""><li id="606b" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated"><strong class="kk iu">缺失值</strong>的比例是多少？是0.1%，1%，还是10%？</li><li id="1a1c" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">删除前后，经典统计指标<strong class="kk iu">是否发生了剧烈变化</strong>？均值、中值、方差、标准差…</li><li id="c69b" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">“无价值”本身能被认为是一种价值吗？</li></ul><p id="60cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要评估数据帧中缺失值的数量，可以使用<a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> describe() </strong>函数</a>:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="pz ph l"/></div></figure><p id="80f0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您会注意到变量“邮政编码”只有9983个条目，而所有其他变量都有9994个。<em class="mo">这关系到9994中的11个条目，所以</em><strong class="kk iu"><em class="mo"/></strong><em class="mo">的样本占0.1%。</em></p><blockquote class="ml mm mn"><p id="e250" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated">在这种情况下，您可以考虑删除，但是根据城市查找邮政编码不是可能吗？</p></blockquote><p id="9313" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经使用我们将在“邮政编码”列中使用的<a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isna.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> isna() </strong>函数</a>检索了11行相关的“城市”变量:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qa ph l"/></div></figure><p id="0a07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您根据城市找到邮政编码，但是设想您将删除这些行。</p><p id="0128" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以通过创建或重新分配另一个变量并使用<a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.notna.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> notna() </strong>函数</a>来实现这一点:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qb ph l"/></div></figure><h2 id="f360" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">选项2:用默认值填充缺少的值</h2><p id="39bb" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">当您阅读这11行时，您意识到这些行都对应于美国佛蒙特州伯灵顿市:为什么不简单地用这个城市的邮政编码(05401)替换空值呢</p><p id="d4f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将变量分配给字典时，您可以使用<a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> loc() </strong>函数</a>更改<strong class="kk iu">数据框</strong>条目中变量的值:</p><ul class=""><li id="acd5" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">第一个参数包含行选择条件；</li><li id="0c6a" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">第二个参数有列(或变量)选择条件；</li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qc ph l"/></div></figure><p id="9b5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以这一次,“邮政编码”变量有9994个值，但是替换成功了吗？</p><p id="fc4e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看邮政编码“05401”的主要条目。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qd ph l"/></div></figure><p id="53d5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">宾果，您找到了我们之前识别的条目:所做的更改已经被应用！</p><h2 id="288a" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">选项3:用计算值填充缺失值</h2><p id="728f" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">有时可以从现有数据中重建缺失的值。例如，既然变量“City”似乎总是存在，难道不可能从数据库中具有相同城市的其他条目中计算出缺失的邮政编码吗？</p><p id="6f1e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">选择城市为Burlington的所有行:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qe ph l"/></div></figure><p id="e84a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些结果会让你大吃一惊:为什么同一个城市有好几个可能的邮政编码？</p><p id="e202" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在互联网上做一点研究，或者添加“州”和“地区”这两个栏目，你就会找到答案:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qe ph l"/></div></figure><p id="676b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在更明显了，你的选择是——一个快乐的巧合！—右图:只有美国东部佛蒙特州的伯灵顿市缺少购物的邮政编码。</p><p id="1ae7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一次使用现有的值是不合适的！</p><h1 id="5da6" class="nl nm it bd nn no qf nq nr ns qg nu nv jz qh ka nx kc qi kd nz kf qj kg ob oc bi translated">如何清理不一致的数据</h1><p id="0069" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">完成数据集后，清理工作将继续进行。</p><p id="40ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为虽然存在可能导致零值的输入错误，但大多数情况下，数据集将包含完全无意义的值！</p><p id="d757" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了进行严格的数据分析，您必须评估和检测尽可能多的不一致值，并决定采取什么措施:</p><ul class=""><li id="4613" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">删除它们？</li><li id="206b" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">修改它们？</li></ul><blockquote class="ml mm mn"><p id="5b9a" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated">你将继续使用<a class="ae md" href="https://drive.google.com/file/d/1rkaD15RvKJxCjh7pqVlFh45eS2z74aer/view?usp=share_link" rel="noopener ugc nofollow" target="_blank">提供的数据集</a>来练习你的批判性思维。</p></blockquote><h2 id="b814" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">如何删除低值和不一致的数据</h2><p id="6ed0" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">简单的选择仍然是删除这些不一致的值，但是在考虑删除之前，问自己以下问题:</p><ul class=""><li id="5799" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">价值观冲突的<strong class="kk iu">比例</strong>是多少？是0.1%，1%，还是10%？</li><li id="321c" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">删除前后，是否剧烈改变了经典统计指标？均值、中值、方差、标准差…</li><li id="1bbc" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated"><strong class="kk iu">相反，这难道不是一种“有趣”的见解吗？</strong></li></ul><p id="9e20" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要评估数据帧中不一致值的数量，您将再次使用<a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> describe() </strong> </a>函数:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="pz ph l"/></div></figure><p id="cd2c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果查看变量“<em class="mo">记录数</em>”:</p><ul class=""><li id="210a" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">9994个条目，但是…</li><li id="e34e" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">平均为1</li><li id="7fb0" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">标准偏差为0(因此所有值都等于1)</li><li id="d7d2" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">…由最小值和最大值1确认</li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qk ph l"/></div></figure><blockquote class="od"><p id="4260" class="oe of it bd og oh ql qm qn qo qp ld dk translated">保留一个只包含1的列真的有用吗？</p></blockquote><p id="dc73" class="pw-post-body-paragraph ki kj it kk b kl on ju kn ko oo jx kq kr op kt ku kv oq kx ky kz or lb lc ld im bi translated">在这种情况下，您可以使用DataFrame <a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> drop() </strong>函数</a>删除该列，因为它不提供任何信息:</p><ul class=""><li id="0d2e" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">第一个参数是字符串列表；</li><li id="eb2a" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">第二个参数<strong class="kk iu">轴</strong>根据删除方向取值<em class="mo">列</em>或<em class="mo">索引</em>；</li><li id="23d5" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">值为<em class="mo">真</em>的<strong class="kk iu">原位</strong>参数将修改应用于操作的数据帧；</li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qa ph l"/></div></figure><blockquote class="ml mm mn"><p id="03c1" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated">通过应用相同的推理，您还可以删除“Country”变量，它只包含一个值:<strong class="kk iu"> United States </strong>。</p></blockquote><h2 id="283d" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">评估数据一致性的最佳实践</h2><p id="ec42" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">大多数测试都是逻辑测试，由回答常识问题的T2组成。例如:</p><ul class=""><li id="8947" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">销售额可以是负数吗？</li><li id="094e" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">产品销售数量可以是负数吗？</li><li id="b15a" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">存储人的性别的变量可以是“男性、女性或非二元”以外的东西吗？</li><li id="515f" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">一个人的年龄有效吗？(年龄和出生日期列的比较)</li><li id="d289" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">出生日期有效吗？(未来出生或超过130岁的客户)</li><li id="0bf6" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">为一个“价格”变量找一个字符串符合逻辑吗？</li></ul><blockquote class="od"><p id="7729" class="oe of it bd og oh ql qm qn qo qp ld dk translated">您无法自动查找或消除不一致的值</p></blockquote><p id="3cf8" class="pw-post-body-paragraph ki kj it kk b kl on ju kn ko oo jx kq kr op kt ku kv oq kx ky kz or lb lc ld im bi translated">这里有两个功能可以帮助您完成调查工作:</p><ul class=""><li id="3875" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated"><a class="ae md" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.unique.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> unique() </strong>函数</a>列出变量的不同值；</li><li id="7735" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated"><a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dtypes.html?highlight=dtypes#pandas.DataFrame.dtypes" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> dtypes </strong> </a>参数给出了数据帧变量包含的数据类型:</li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qq ph l"/></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">超级商店区域:目前有4个区域。</figcaption></figure><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qq ph l"/></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">超级商店产品类别:目前为止有3个类别。</figcaption></figure><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qr ph l"/></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">一个<strong class="ak">对象</strong>、<strong class="ak"> int64、</strong>和<strong class="ak"> float64 </strong>列的混合</figcaption></figure><p id="0665" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于<strong class="kk iu"> dtypes </strong>参数，包含字符串的每一列都将被标识为一个<strong class="kk iu">对象</strong>。</p><p id="af91" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">另一方面，令人惊讶的是邮政编码被标识为一个浮点值(即带逗号)</strong>。</p><blockquote class="ml mm mn"><p id="b9b7" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated"><em class="it">另一个不一致将是下面和最后一节的主题:日期被认为是字符串而不是</em> <a class="ae md" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" rel="noopener ugc nofollow" target="_blank"> <em class="it"> Python日期时间对象</em> </a> <em class="it">。</em></p></blockquote><p id="0f2d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以使用<a class="ae md" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> astype() </strong>函数</a>更改数据帧中变量的数据类型:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qs ph l"/></div></figure><p id="95ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">有时该操作不起作用，因为并不总是能够在两种数据类型之间转换！</strong></p><p id="40ea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这对邮政编码的显示有影响:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qt ph l"/></div></figure><h1 id="e145" class="nl nm it bd nn no qf nq nr ns qg nu nv jz qh ka nx kc qi kd nz kf qj kg ob oc bi translated">如何管理畸形日期？</h1><p id="e17f" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">控制和操作日期对于数据分析师来说是至关重要的，尤其是在销售分析中检查客户购买的季节性时。</p><p id="4a57" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">必须将所有日期字段转换成日期时间对象，而不是字符串。</p><p id="aa0b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一操作将允许您比较它们的日期并提取有价值的信息。</p><h2 id="89b5" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">如何将字符串转换成日期时间对象</h2><p id="6660" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">当加载DataFrame时，您可以使用parse_dates参数告诉pandas自动转换日期，该参数接受一组用于转换的变量作为参数。</p><p id="faf7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，如果到目前为止，您已经使用以下指令加载了我们的数据集:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qu ph l"/></div></figure><p id="3cb9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是如果你这样做是最好的:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qu ph l"/></div></figure><p id="a96f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这对所选列的类型有直接影响，以前它们是<strong class="kk iu">对象</strong>，但现在它们是<strong class="kk iu">日期时间64【ns】</strong>对象:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qv ph l"/></div></figure><blockquote class="ml mm mn"><p id="15a0" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated">正如您所料，这不是一个原生的<strong class="kk iu"> datetime </strong> Python对象，但是Numpy Python库使用了datetime对象。</p></blockquote><h2 id="76ae" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">如何从日期中提取信息</h2><p id="2a6e" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">一旦相关变量是“日期时间”类型的对象，我们就可以提取以下信息:</p><ul class=""><li id="1e3c" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">年</li><li id="3965" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">月</li><li id="0c79" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">星期几</li></ul><p id="354f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以及可用时:小时、分钟、秒</p><p id="d835" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在检查不一致的日期值时，所有这些数据都很有用！</p><p id="7924" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，您将使用<a class="ae md" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DatetimeIndex.html?highlight=datetimeindex#pandas.DatetimeIndex" rel="noopener ugc nofollow" target="_blank"> dt参数</a>，后跟必要的参数:</p><ul class=""><li id="b766" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated"><strong class="kk iu"> dt.year </strong>为年份；</li><li id="1622" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated"><strong class="kk iu"> dt.month </strong>为当月；</li><li id="d4da" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">和<strong class="kk iu"> dt.dayofweek </strong>表示一周中的某一天…；</li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="qw ph l"/></div></figure><blockquote class="ml mm mn"><p id="4e2a" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated">访问这些新变量的另一个优势是可以按年、月、星期几对销售额进行分组<strong class="kk iu">以了解季节性</strong>。</p></blockquote><h2 id="23ad" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">如何处理时区</h2><p id="b313" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">日期的问题——尤其是对美国来说——在于时间和日期是与时区相关的。</p><p id="8683" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当分析美国和世界各地城市中不同开始时间的特定日子(节假日、黑色星期五)时，这对于销售分析可能是有问题的。</p><p id="82ad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您的数据没有考虑时区，那么对于像美国这样的国家，您通常没有很好的解决方案来纠正这种错误。</p><p id="7781" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是如果数据来自一个单一时区的国家，您应该能够添加这些信息。</p><p id="0814" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们将使用<a class="ae md" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.tz_localize.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> tz_localize() </strong>函数</a>:</p><ul class=""><li id="e04d" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">第一个参数是时区的名称；</li><li id="ba9b" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">第二个参数将责任委托给pandas，以便在发生冲突时选择应用哪个日期(例如，时间变更管理)；</li></ul><pre class="lo lp lq lr gt qx qy qz bn ra rb bi"><span id="011f" class="rc nm it qy b be rd re l rf rg">super_store['Order Date'].dt.tz_localize('CET', ambiguous='infer')</span></pre><p id="652f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">知道我们可以访问美国地区，是否可以近似地添加这些信息？</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="rh ph l"/></div></figure><h2 id="66dc" class="pi nm it bd nn pj pk dn nr pl pm dp nv kr pn po nx kv pp pq nz kz pr ps ob pt bi translated">奖励:季节性介绍</h2><p id="1625" class="pw-post-body-paragraph ki kj it kk b kl pu ju kn ko pv jx kq kr pw kt ku kv px kx ky kz py lb lc ld im bi translated">特定的列允许新的聚合:</p><ul class=""><li id="8a16" class="os ot it kk b kl km ko kp kr ou kv ov kz ow ld ox oy oz pa bi translated">每年的销售额是多少？</li><li id="b162" class="os ot it kk b kl pb ko pc kr pd kv pe kz pf ld ox oy oz pa bi translated">利润按照一年中的月份是怎样演变的？</li></ul><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="ri ph l"/></div></figure><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="rj ph l"/></div></figure><p id="4fce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是将这些数据“绘制”(显示)成图表:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="rk ph l"/></div></figure><blockquote class="ml mm mn"><p id="4832" class="ki kj mo kk b kl km ju kn ko kp jx kq mp ks kt ku mq kw kx ky mr la lb lc ld im bi translated">这将是我下一篇文章的主题，<a class="ae md" href="https://medium.com/@dataforeveryone" rel="noopener"> <strong class="kk iu">关注我</strong> </a>，当它发表时我会让你知道！</p></blockquote><p id="a479" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而这第三篇就结束了。感谢您的阅读！</p><p id="b490" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您需要提高您的Python知识，请关注我的3个月免费计划:</p><div class="ms mt gp gr mu mv"><a rel="noopener  ugc nofollow" target="_blank" href="/master-python-10-minutes-a-day-5aeab489e227"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">如何学习Python，每天10分钟</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">这就是我作为数据/人工智能顾问如何跟上时代的方法</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ne l"><div class="rl l ng nh ni ne nj lx mv"/></div></div></a></div></div></div>    
</body>
</html>