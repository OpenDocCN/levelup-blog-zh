<html>
<head>
<title>Go Go Release!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">去释放吧！</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/go-go-release-3f326921bc71?source=collection_archive---------3-----------------------#2020-09-15">https://levelup.gitconnected.com/go-go-release-3f326921bc71?source=collection_archive---------3-----------------------#2020-09-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/fb1c5e1e3c380d79903c12f03e482a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*8rIgBJLKdeqocOWBUg-XJA.jpeg"/></div></figure><h1 id="50c2" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">TLDR；只是想要一个Go发布工具？</h1><p id="058d" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">使用下面的键跳到<strong class="kx iu"> <em class="lt">。</em></strong></p><h1 id="1dcc" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">全文阅读</h1><p id="759a" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">说到围棋和它的生态系统，我既不是爱好者也不是憎恨者。总的来说，一切都有点简陋，但是非常开放和容易理解。你可能不得不自己做一些工作，但你将能够得到结果。</p><h1 id="c2fa" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">发布通用软件</h1><p id="02cf" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">无论使用何种语言或工具，都有一些简单的关于软件版本和发布的最佳实践:</p><ul class=""><li id="8db5" class="lu lv it kx b ky lw lc lx lg ly lk lz lo ma ls mb mc md me bi translated">使用<a class="ae mf" href="https://en.wikipedia.org/wiki/Software_versioning" rel="noopener ugc nofollow" target="_blank">语义版本号</a>表示版本。</li><li id="fc22" class="lu lv it kx b ky mg lc mh lg mi lk mj lo mk ls mb mc md me bi translated">确保发布版本号持续地标记在源代码和工件上。</li></ul><p id="c79a" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">做到这两点，你就得到一个有序的、可识别的、可复制的产品。</p><h1 id="503e" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在Go中发布软件</h1><p id="1bb0" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">那么，Go对新版本有什么期待呢？如果你认为<em class="lt">完全是最小的最佳实践</em>，那你就对了:-)对于Go，你需要使用<a class="ae mf" href="https://pkg.go.dev/golang.org/x/mod/semver?tab=doc" rel="noopener ugc nofollow" target="_blank">语义版本号</a>，并标记你的源代码。这样做，你的东西就会在Go模块系统中正常工作。</p><h1 id="6f7d" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在Go中使用版本</h1><p id="f721" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">在Go中，释放机制是<a class="ae mf" href="https://blog.golang.org/using-go-modules" rel="noopener ugc nofollow" target="_blank">模块</a>系统的一部分。让我们看看模块和版本的一些基本操作:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="3fcd" class="mx jy it mt b gy my mz l na nb"># What releases are associated with the current project?<br/><strong class="mt iu">go list -m all</strong><br/>github.com/nwillc/snipgo<br/>github.com/DATA-DOG/go-sqlmock v1.3.3<br/>github.com/alcortesm/tgz v0.0.0-20161220082320-9c5fe88206d7<br/>github.com/anmitsu/go-shlex v0.0.0-20161002113705-648efa622239<br/>github.com/armon/go-socks5 v0.0.0-20160902184237-e75332964ef5<br/>github.com/atotto/clipboard v0.1.2<br/>...<br/># What versions are available for a specific module?<br/><strong class="mt iu">go list -m -versions github.com/nwillc/gorelease</strong><br/>github.com/nwillc/gorelease v0.1.1 v0.1.2 v0.2.0 v0.3.0 v0.4.0<br/># Getting a module<br/><strong class="mt iu">go get github.com/nwillc/gorelease</strong><br/># Getting a module with a specified version<br/><strong class="mt iu">go get github.com/nwillc/gorelease@v0.4.0</strong></span></pre><h1 id="cf4b" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">管理Go中的模块</h1><p id="d048" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">在Go中管理模块非常简单，请阅读上面的链接或直接查找。但最少如下。首先，您将启动模块支持。让我们假设我们将把这个项目保存在<em class="lt"> GitHub </em>中，并且库将是<em class="lt"> nwillc/demo </em>:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="3a8d" class="mx jy it mt b gy my mz l na nb">go mod init github.com/nwillc/demo</span></pre><p id="f48f" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">这会将模块管道添加到您的当前项目中:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="514b" class="mx jy it mt b gy my mz l na nb">ls -1 go.*<br/>go.mod<br/>go.sum</span></pre><p id="5251" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">有了这些，您可以根据需要向项目中添加模块，例如:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="0d48" class="mx jy it mt b gy my mz l na nb">go get golang.org/x/mod/semver</span></pre><p id="e0f1" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">并将该模块引用为代码中的<em class="lt">导入</em>。</p><h1 id="11ed" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">所以是时候发布你的代码了</h1><p id="2c61" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">你是做什么的？</p><ul class=""><li id="608f" class="lu lv it kx b ky lw lc lx lg ly lk lz lo ma ls mb mc md me bi translated">提交所有代码</li><li id="6312" class="lu lv it kx b ky mg lc mh lg mi lk mj lo mk ls mb mc md me bi translated">设置一个合适的git标签，比如v0.1.0</li><li id="c534" class="lu lv it kx b ky mg lc mh lg mi lk mj lo mk ls mb mc md me bi translated">将标签和代码推送到github</li></ul><p id="8517" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">这就够了。这些步骤可能如下所示:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="4348" class="mx jy it mt b gy my mz l na nb"># Make sure the current code is all checked in<br/>git commit -am 'Ready for release v0.1.0'<br/># Now tag it<br/>git tag v0.1.0<br/># Push the tag<br/>git push origin v0.1.0<br/># Push the code <br/>git push</span></pre><p id="0c38" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">几个样板步骤，它做的工作，但缺乏一些优雅。请继续阅读。</p><h1 id="7f26" class="jx jy it bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">Go中的一个发布助手</h1><p id="6819" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我想简化上面的步骤，并实现一个额外的东西，我想在包含字符串标记的代码中有一个可用的常量。对于第二个目标，有不同的方法，一个流行的方法是使用编译时标志<em class="lt"> -ldflags -X </em>，但是我希望它成为代码的一部分，因为我希望所有标准的构建方法，从源代码开始，做正确的事情。</p><p id="db13" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">为了这些目的，我写了一个Go程序，<a class="ae mf" href="https://github.com/nwillc/gorelease" rel="noopener ugc nofollow" target="_blank"> gorelease </a>，来自动化这个过程。我在Go中写这篇文章是基于这样的假设:如果你在Go中工作，你的环境将被设置为运行Go。</p><h2 id="20db" class="mx jy it bd jz nc nd dn kd ne nf dp kh lg ng nh kl lk ni nj kp lo nk nl kt nm bi translated">使用gorelease</h2><p id="0533" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">要使用<em class="lt">gore release</em>，你需要一份承诺回购协议，并具备以下条件:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="3fb8" class="mx jy it mt b gy my mz l na nb"># Get gorelease - only need to do this once<br/>go get github.com/nwillc/gorelease<br/># Indicate the version to release...<br/>echo v0.1.0 &gt; .version<br/># Run gorelease<br/>gorelease</span></pre><p id="d0e4" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">这将生成一个包含版本的<code class="fe nn no np mt b">version.go</code>文件，标记repo，并推送标记和repo。</p><p id="8aad" class="pw-post-body-paragraph kv kw it kx b ky lw la lb lc lx le lf lg ml li lj lk mm lm ln lo mn lq lr ls im bi translated">要了解更多关于<em class="lt"> gorelease </em>的信息，请前往<a class="ae mf" href="https://github.com/nwillc/gorelease" rel="noopener ugc nofollow" target="_blank"> github </a>。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h2 id="6505" class="mx jy it bd jz nc nd dn kd ne nf dp kh lg ng nh kl lk ni nj kp lo nk nl kt nm bi translated">注意:v2</h2><p id="0335" class="pw-post-body-paragraph kv kw it kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">Go的模块版本控制在v2.0.0+ 上来了一个<a class="ae mf" href="https://blog.golang.org/v2-go-modules" rel="noopener ugc nofollow" target="_blank">急转弯，进入了一片疯狂的土地，要么研究它，要么保持低于那个版本号。在gorelease中还没有解决<em class="lt">这个问题，但是很快就会增加支持。</em></a></p></div></div>    
</body>
</html>