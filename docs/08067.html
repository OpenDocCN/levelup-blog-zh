<html>
<head>
<title>10 Mistakes When Sizing Cloud Resources</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">确定云资源规模时的10个错误</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/10-mistakes-when-sizing-cloud-resources-707a4dbc92ea?source=collection_archive---------7-----------------------#2021-03-31">https://levelup.gitconnected.com/10-mistakes-when-sizing-cloud-resources-707a4dbc92ea?source=collection_archive---------7-----------------------#2021-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e17c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">避免那些为了优化成本和性能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/40c77038cffddc8faae1b14d216365fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l8lw5gblqAVgKfqy"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@siora18?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Siora摄影</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a> | <a class="ae kv" href="https://www.annageller.com/disclosure" rel="noopener ugc nofollow" target="_blank">品牌内容披露</a></figcaption></figure><p id="aff3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated">迁移到云最常见的问题之一是成本。鉴于云允许您将IT成本从资本支出(<em class="mb">长期投资，例如。在将硬件设备和软件许可</em>)引入OPEX ( <em class="mb">日常运营费用</em>)时，选择正确的服务并恰当地确定其规模至关重要。在本文中，我们将看看常见的陷阱，并讨论如何避免它们，以真正受益于云的弹性。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="a295" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">#1遵循提升和移位方法</h1><p id="8acf" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">提升和转移方法意味着将您的工作负载的<strong class="ky ir">精确副本</strong>移动到云中，并且<strong class="ky ir">尽可能少的更改</strong>。尽管如果您想快速迁移到云，这种模式可能是有用的，但它可能会导致资源的次优使用。AWS承认这是一个难题，通过创建服务使这种迁移变得更容易(<a class="ae kv" href="https://aws.amazon.com/cloudendure-migration/" rel="noopener ugc nofollow" target="_blank"><em class="mb">cloud忍让迁移</em> </a> <em class="mb">和</em> <a class="ae kv" href="https://aws.amazon.com/server-migration-service/" rel="noopener ugc nofollow" target="_blank"> <em class="mb"> AWS服务器迁移服务</em> </a>)。尽管如此，为了尽可能提高资源利用率，最好考虑为云重新构建您的解决方案。</p><p id="99e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了lift和shift，从长远来看，你可能会在桌面上留下很多钱。您还会错过您的云提供商可以提供的许多好处。例如，当选择完全管理的AWS Aurora而不是传统的Postgres实例时，您可以获得(<em class="mb">和其他</em>)3倍的吞吐量、存储自动扩展和低延迟读取副本。这可能是为什么Aurora目前是AWS上最受欢迎和增长最快的服务之一。</p><h1 id="0df2" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#2不标记您的资源</h1><p id="049c" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">如果你没有足够的数据来做出明智的决定，那么改进是很有挑战性的。如果您无法跟踪您的云资源的表现以及它们产生的成本，就很难优化它们的利用率。</p><p id="0577" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据项目或<strong class="ky ir">组织单位</strong>来标记您的资源被认为是一种最佳实践，以便将成本正确地分配给相应的服务。</p><h1 id="d335" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#3未能监控资源使用情况</h1><p id="1026" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">管理云架构不是一次性的过程。这是一个持续的监控和评估你用什么，你怎么用，为什么用的实践。也许您最初对特定应用程序增长的假设并不完全正确，做出改变可以显著降低成本。</p><p id="02f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，考虑一个<strong class="ky ir">过度配置的Kubernetes集群</strong>,它的节点比需要的多得多。也许在这种情况下，转移到无服务器版本(<em class="mb">法盖特</em>上的EKS)更有意义。关于无服务器Kubernetes集群的更多信息，请参见<a class="ae kv" href="https://betterprogramming.pub/serverless-kubernetes-cluster-on-aws-with-eks-on-fargate-a7545cf179be" rel="noopener ugc nofollow" target="_blank">我以前的文章</a>。</p><p id="09eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让<strong class="ky ir">“僵尸”资源</strong>不受监控地运行并不像你想象的那样罕见。一些项目可能会被放弃，而相应的资源由于未完成的移交过程而保持活跃。</p><h1 id="b92a" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#4总是从头开始做每件事</h1><p id="1b8d" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">作为软件工程师，我们有时可能会被诱惑为每件事构建我们自己的定制解决方案和服务。一个潜在的更好的方法是首先对现有的资料进行适当的研究。示例:</p><ul class=""><li id="6561" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">也许您不需要EC2上的这个<strong class="ky ir">自托管数据库，</strong>您可以使用完全托管的RDS来帮助您更轻松地扩展和操作实例？</li><li id="7590" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">或者也许你不需要这个<strong class="ky ir">自管理RabbitMQ </strong>实例，你可以采用久经考验的无服务器消息队列SQS？</li></ul><p id="af1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一般来说，如果有一个无服务器或完全托管的解决方案，至少在投入太多时间和精力到您自己的解决方案之前考虑它是有意义的，因为您必须完全由自己来维护。</p><h1 id="e7ac" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#5仅使用您熟悉的工具</h1><p id="be1b" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">在阅读一些Reddit或博客帖子时，我看到许多工程师不愿意使用无服务器或容器编排平台，只是因为他们更了解EC2和手动管理的服务器。他们认为这只是一种会“来来去去”的<em class="mb">新技术</em>，因此，没有必要改变你的方式。这意味着迁移到容器编排平台、无服务器和其他云服务没有好处。这似乎是一种小心眼的做法。</p><p id="575b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最好挑战我们的假设，用清晰的事实、成本和性能基准来判断新技术，而不是对新事物持怀疑态度。</p><h1 id="0f7b" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#6不利用无服务器和容器编排平台</h1><p id="e8a9" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">如果您为您管理的每个服务和工具创建一个EC2实例，您可能会陷入维护的噩梦。但是，如果您将您的每个服务部署到一个部署到Kubernetes (EKS)或Fargate (ECS)集群的容器中，由于动态端口映射和更紧凑的容器资源利用，您可以<strong class="ky ir">将更多的资源分配到单个服务器实例</strong>。共享层。</p><p id="98ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">容器编排平台将帮助您确保在实例之间平衡负载，并且您的工作负载将保持健康。在某种程度上，他们排除了对容量的猜测。您可以指定有多少容器实例应该一直运行，控制平面将确保它按照您定义的那样运行。</p><blockquote class="nz oa ob"><p id="5152" class="kw kx mb ky b kz la jr lb lc ld ju le oc lg lh li od lk ll lm oe lo lp lq lr ij bi translated">如果您可以轻松地在许多容器或无服务器资源之间平衡您的工作负载，那么您不必再猜测哪个EC2或RDS实例大小适合您的用例。</p></blockquote><h1 id="bb9c" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#7不考虑总体拥有成本</h1><p id="a1a0" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">如果您只考虑硬件或服务成本，您可能最终会认为许多资源在本地更具成本效益。但如果你把额外的维护、升级和管理这些服务器的员工的成本加起来，那就完全是另一回事了。</p><h1 id="42bf" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#8短期思考</h1><p id="d852" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">如果你纯粹基于你当前的情况来衡量你的资源，你可能没有考虑到你的需求在未来会如何变化。如果您的业务和数据增长得更快，该怎么办？如果结果是相反的呢？您的应用程序是否仍然易于更改和适应未知的未来场景？最后，你能找到并留住足够的员工来长期运营吗？</p><h1 id="dca0" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#9过度配置一切“以防万一”</h1><p id="6e17" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">在另一个极端，如果您想要谨慎，您可能会试图过度配置一切以确保您为使用高峰做好准备。这是一个很好的策略，前提是你能根据过去的使用模式证明峰值的合理性。但如果你是出于直觉，这可能是一个糟糕的策略。</p><p id="8b93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">云提供了灵活性，您可以向集群添加节点，跨更多容器对工作负载进行负载平衡，或者在需要时增加vCPUs的数量或内存大小。如果配置和监控得当，就不需要过度配置任何东西。我并不是说调整规模很容易(<em class="mb">远非如此</em>，但是有了<strong class="ky ir">良好的流程</strong>和<strong class="ky ir">自动化</strong>，这是可行的。它可以显著节约成本，尤其是在大规模运营众多资源时。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/236beb3e8415e4fa53b5dfc590658b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VpBLmvRiCYLm5W-bs4U5Kg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">过度配置的生产资源—图片由<a class="ae kv" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank"> Dashbird </a>提供</figcaption></figure><h1 id="fc42" class="mj mk iq bd ml mm ng mo mp mq nh ms mt jw ni jx mv jz nj ka mx kc nk kd mz na bi translated">#10选择错误的数据存储</h1><p id="2c6c" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">有时，瓶颈不是计算资源，而是选择不当的数据存储。最好考虑一下:</p><ul class=""><li id="1eb9" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">无论您是需要丰富的查询语言(SQL)还是您的应用程序使用简单的键值存储(例如DynamoDB)，</li><li id="5a0d" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">首先你是否需要一个数据库；也许简单的S3数据转储就足够了。</li></ul><p id="8f7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它自然依赖于用例，但是数据库经常构成任何可伸缩架构的主要瓶颈。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="805f" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">如何缓解规模合适的问题？</h1><p id="e68f" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">优化云资源利用率的一个可能的解决方案是利用自动化。例如，使用<a class="ae kv" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank"> Dashbird </a>，您可以跟踪供应不足和过度供应的资源，并获得相关通知。例如，当使用<strong class="ky ir">架构良好的lens dashboard </strong>时，我们可以发现我们的ECS集群使用EC2实例类型(<em class="mb">非无服务器数据平面</em>)在过去一个小时内的CPU利用率超过了90%。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/5f3546d1a927fe4accfcec75f6a1fad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MmNlrbLFP4zTjBhUshDg0Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">精心设计的镜头仪表盘——图片由<a class="ae kv" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank">仪表板</a>提供</figcaption></figure><p id="1001" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们可以深入到特定的时间间隔，并进一步检查为什么会出现这个峰值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/4629f4cfbf02d9ba1eac56a479d47729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rrnq2guVgoBc7Aa3aqO85w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">资源调配不足的ECS群集达到CPU容量限制—图片由<a class="ae kv" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank"> Dashbird </a>提供</figcaption></figure><p id="1638" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与此同时，另一种容器化的服务可能会被过度供应，从而可能会把钱留在桌面上。有了这些信息，您就可以根据实际的使用模式优化您的资源配置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/9576d45acfabe3292d27d50cab05a920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQTj3O4Vqn5IDYazKd7-1A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">过度调配的ECS服务—图片由<a class="ae kv" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank"> Dashbird </a>提供</figcaption></figure></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="f72a" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">结论</h1><p id="33f8" class="pw-post-body-paragraph kw kx iq ky b kz nb jr lb lc nc ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">本文研究了调整云资源时的常见陷阱，并讨论了如何避免这些陷阱，以真正受益于云的弹性。通过利用容器编排平台、无服务器和完全托管的解决方案，并通过持续监控您的使用模式，您可以针对性能和成本优化您的架构。</p><p id="f694" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">感谢您的阅读！如果这篇文章对你有用，请</strong> <a class="ae kv" href="https://medium.com/@anna.anisienia" rel="noopener"> <strong class="ky ir">关注我的</strong> </a> <strong class="ky ir">来看看我的下一篇文章。</strong></p><p id="e287" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考资料&amp;其他资源:</strong></p><p id="60d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[1]资本支出与OPEX: <a class="ae kv" href="https://www.investopedia.com/ask/answers/112814/whats-difference-between-capital-expenditures-capex-and-operational-expenditures-opex.asp" rel="noopener ugc nofollow" target="_blank">投资支出</a></p><p id="7c40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://aws.amazon.com/rds/aurora/postgresql-features/" rel="noopener ugc nofollow" target="_blank"> AWS极光</a></p></div></div>    
</body>
</html>