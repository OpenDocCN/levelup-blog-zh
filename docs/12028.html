<html>
<head>
<title>A dev environment that won’t ruin your entire day.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不会毁了你一整天的开发环境。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-dev-environment-that-wont-ruin-your-entire-day-cad4e268eaa3?source=collection_archive---------16-----------------------#2022-05-08">https://levelup.gitconnected.com/a-dev-environment-that-wont-ruin-your-entire-day-cad4e268eaa3?source=collection_archive---------16-----------------------#2022-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4eb676cd0d27393cc6d1d26de5f4f20b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2C6d-_SZL3hNqQPa8utSCg.jpeg"/></div></div></figure><p id="5a19" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你在这里，你就会知道建立一个本地开发环境是多么的痛苦。我已经尝试了许多解决方案，但是没有一个比我在这里提出的方法更快或更容易。</p><h2 id="53c9" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">我们将开展的工作:</h2><p id="5ac9" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">docker/docker-compose <br/>一些前端框架(React、Angular、Vue等)<br/>一些后端服务(Golang、Python、Node等)<br/>一些数据库(postgres、mysql等)</p><h1 id="68df" class="lu kx iq bd ky lv lw lx lb ly lz ma le mb mc md lh me mf mg lk mh mi mj ln mk bi translated">启动你的引擎</h1><p id="20c1" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">从运行您的服务开始。下面是一个给出上下文的例子。</p><h2 id="136f" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">前端[示例]</h2><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="d462" class="kw kx iq mq b gy mu mv l mw mx">$ cd some-frontend<br/>$ npm start <br/>&gt; serving localhost:3000</span></pre><h2 id="ae44" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">后端[示例]</h2><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="d549" class="kw kx iq mq b gy mu mv l mw mx">$ cd some-backend<br/>$ go run server.go<br/>&gt; serving localhost:8080</span></pre><h2 id="f408" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">数据库(带docker)[示例]</h2><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="e769" class="kw kx iq mq b gy mu mv l mw mx">$ cat docker-compose.yaml<br/>version: '3.8'<br/>services:<br/>  backend-db:<em class="my"><br/>    </em>image: postgres:14<br/>    restart: always<br/>    ports:<br/>      - '5432:5432'<br/>    environment:<br/>      POSTGRES_USER: guest<br/>      POSTGRES_PASSWORD: guest<br/>      POSTGRES_DB: postgres<br/>    volumes:<br/>      - backend-db-data:/var/lib/postgresql/data<br/>volumes:<br/>  backend-db-data:<br/>    driver: local</span><span id="ab1f" class="kw kx iq mq b gy mz mv l mw mx">$ docker-compose up -d<br/>&gt; backend-db <em class="my">running</em></span></pre><h2 id="639d" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">问题是</h2><p id="f1dc" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">这就是我们的问题所在:前端和后端在不同的域上。(就您的浏览器而言，localhost:3000和localhost:8080是不同的域)如果您想调用不同的域，您必须处理CORS或相同站点配置。</p><p id="a364" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，当您有多个后端服务时会发生什么？你如何选择不同的路径？你真的想深入一些nginx配置吗？呀。不用了，谢谢。</p><h2 id="62c0" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">解决方案</h2><p id="9fab" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">有一个鲜为人知的docker容器叫做<a class="ae na" href="https://github.com/nhumrich/small-prox" rel="noopener ugc nofollow" target="_blank">小代理</a>。这是我经常使用的反向代理！(充分披露，我认识作者，我对项目有贡献)</p><p id="8b88" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Small-prox非常易于使用，并且支持基于主机和基于路径的路由。您还可以在容器中的服务中路由到本地端口。它也完全是用Python写的。</p><h2 id="0891" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">更新你的docker-compose.yaml</h2><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="8e56" class="kw kx iq mq b gy mu mv l mw mx">version: '3.8'<br/>services:<br/>  smallprox:<br/>    image: nhumrich/small-prox<br/>    ports:<br/>      - "80:80"<br/>    volumes:<br/>      - /var/run/docker.sock:/var/run/docker.sock<br/>    environment:<br/>      DEBUG: "False"<br/>      LOCAL_PORTS: "mysite.localhost=3000,mysite.localhost/api=8080"<br/>... <br/>  backend-db: <em class="my"># Local database instance<br/>...    </em></span></pre><p id="62b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可能需要重新启动docker-compose:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="3301" class="kw kx iq mq b gy mu mv l mw mx">$ docker-compose up -d<br/>&gt; backend-db <em class="my">running<br/> </em> smallprox  <em class="my">running</em></span></pre><p id="dba3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后导航到<a class="ae na" href="http://mysite.localhost/" rel="noopener ugc nofollow" target="_blank">http://mysite.localhost/</a>，瞧！你可以开始工作了！</p><h2 id="5162" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">结论</h2><p id="7c60" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">我希望你能从这种模式中得到一些用处。当然还有其他方法可以做到这一点，但在我看来，没有一种方法是如此优雅。</p><p id="56f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你准备好的时候，Small-prox可以做更多的事情，包括SSL和连接你的其他容器到子域。也许我会做一个跟进，如果有人想要的话。<a class="ae na" href="https://twitter.com/alairock" rel="noopener ugc nofollow" target="_blank">让我知道</a>！</p><p id="873a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你这样做时，给回购一颗星和一个追随者！</p></div></div>    
</body>
</html>