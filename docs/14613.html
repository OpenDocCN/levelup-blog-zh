<html>
<head>
<title>How to Configure Multiple Databases with Spring Boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨Spring Booté…ç½®å¤šä¸ªæ•°æ®åº“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/how-to-configure-multiple-databases-with-spring-boot-81414cf4506d?source=collection_archive---------7-----------------------#2022-12-12">https://levelup.gitconnected.com/how-to-configure-multiple-databases-with-spring-boot-81414cf4506d?source=collection_archive---------7-----------------------#2022-12-12</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/d59ae5e4a95210ba5754e9fd185c808c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-LnEZIbywYJN4yuCgKjw2Q.png"/></div></div><figcaption class="kc kd gk gi gj ke kf bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae kg" href="https://www.pexels.com/@tima-miroshnichenko?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">é©¬ä½“Â·ç±³ç½—ä»€å°¼ç´ç§‘</a>ä»<a class="ae kg" href="https://www.pexels.com/photo/man-in-red-and-blue-plaid-button-up-shirt-using-silver-macbook-5702300/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">æ´¾å…‹æ–¯</a>æ‹æ‘„</figcaption></figure><p id="7c22" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv"> <em class="lf">æ‚¨éœ€è¦é…ç½®Spring Bootåº”ç”¨ç¨‹åºæ¥å¤„ç†å¤šä¸ªæ•°æ®æºå—ï¼Ÿ</em>T9ã€‘</strong></p><p id="8dcb" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">è¿™ä¸ªSOé—®é¢˜çš„å¤§å¤šæ•°è§£å†³æ–¹æ¡ˆéƒ½æœ‰<code class="fe lg lh li lj b">@Primary</code>æ¥æ ‡è®°ä¸»æ•°æ®æºã€‚è¿™ä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›æœ‰å¹³ç­‰çš„å¤šä¸ªæ•°æ®åº“ã€‚</p><p id="d9e9" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv"> <em class="lf">ä¸æƒ³è¦ä¸»æ•°æ®åº“æ€ä¹ˆåŠï¼Ÿå¦‚æœæ‚¨æƒ³å°†è¿ç§»åº”ç”¨åˆ°å¤šä¸ªæ•°æ®æºï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</em>T15ã€‘</strong></p><p id="c288" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">æˆ‘ä»¬å°†ä»è¿™ä¸ªPOC repoå¼€å§‹ï¼Œå®ƒå¯ä»¥åœ¨<a class="ae kg" href="https://github.com/kimhrac/poc_springboot_3_multi_databases" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªGitHubé“¾æ¥</a>ä¸Šæ‰¾åˆ°ã€‚</p><p id="4977" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºSpring Bootåº”ç”¨ç¨‹åºé…ç½®å¤šä¸ªæ•°æ®åº“éœ€è¦ä»€ä¹ˆã€‚</p><h1 id="20b5" class="lk ll iu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">æ‚¨å°†éœ€è¦å•ç‹¬çš„å®ä½“ç®¡ç†å™¨</h1><p id="24af" class="pw-post-body-paragraph kh ki iu kj b kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le in bi translated">å¯¹äºæ¯ä¸ªæ•°æ®åº“ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®å®ä½“ç®¡ç†å™¨å·¥å‚å¹¶å¡«å……æ•°æ®æºæ•°æ®ã€‚</p><p id="a3e2" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">è¿™å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥å®Œæˆã€‚</p><pre class="mn mo mp mq gu mr lj ms bn mt mu bi"><span id="3c6e" class="mv ll iu lj b be mw mx l my mz">@Configuration  <br/>@EnableTransactionManagement  <br/>@EnableJpaRepositories(  <br/>        basePackages = "com.acme.poc.springboot.backend.database.h2.repository",  <br/>        entityManagerFactoryRef = "h2EntityManagerFactory",  <br/>        transactionManagerRef = "h2UserTransactionManager"  <br/>)  <br/>@EntityScan(basePackages = {  <br/>        "com.acme.poc.springboot.backend.database.h2.entity"  <br/>})  <br/>public class H2SQLPersistence {  <br/>private final Environment env;  <br/>public H2SQLPersistence(Environment env) {  <br/>        this.env = env;  <br/>    }  <br/><br/>    @Autowired  <br/>    @Bean("h2EntityManager")  <br/>    public EntityManager h2EntityManager(@Qualifier("h2EntityManagerFactory")  <br/>                                       LocalContainerEntityManagerFactoryBean factoryBean) {  <br/>        return factoryBean.getObject().createEntityManager();  <br/>    }  <br/>    @Autowired  <br/>    @Bean("h2UserTransactionManager")  <br/>    public PlatformTransactionManager h2UserTransactionManager(@Qualifier("h2EntityManagerFactory")  <br/>                                                                       LocalContainerEntityManagerFactoryBean factoryBean) {  <br/>        return new JpaTransactionManager() {{  <br/>            setEntityManagerFactory(factoryBean.getObject());  <br/>        }};  <br/>    }  <br/>    @Autowired  <br/>    @Bean("h2EntityManagerFactory")  <br/>    public LocalContainerEntityManagerFactoryBean h2UserEntityManagerFactory(@Qualifier("h2UserDataSource")  <br/>                                                                                     DataSource h2UserDataSource) {  <br/>        HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter() {{  <br/>            setGenerateDdl(true);  <br/>        }};  <br/>        HashMap&lt;String, Object&gt; properties = new HashMap&lt;&gt;() {{  <br/>            put("hibernate.hbm2ddl.auto", env.getProperty("hibernate.hbm2ddl.auto"));  <br/>            put("hibernate.dialect", env.getProperty("application.database.h2.hibernate.dialect"));  <br/>        }};  <br/>        PersistenceProvider provider = new HibernatePersistenceProvider();  <br/>        return new LocalContainerEntityManagerFactoryBean() {{  <br/>            setDataSource(h2UserDataSource);  <br/>            setPackagesToScan("com.acme.poc.springboot.backend.database.h2");  <br/>            setJpaVendorAdapter(vendorAdapter);  <br/>            setJpaPropertyMap(properties);  <br/>            setPersistenceProvider(provider);  <br/>        }};  <br/>    }  <br/>    @Bean("h2UserDataSource")  <br/>    public DataSource h2UserDataSource() {  <br/>        return new DriverManagerDataSource() {{  <br/>            setDriverClassName(env.getProperty("application.database.h2.driverClassName"));  <br/>            setUrl(env.getProperty("application.database.h2.url"));  <br/>            setUsername(env.getProperty("application.database.h2.username"));  <br/>            setPassword(env.getProperty("application.database.h2.password"));  <br/>        }};  <br/>    }  <br/>}</span></pre><p id="c45e" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">æˆ‘ä»¬å°†è¯»å‡ºå±æ€§å¹¶åˆ›å»ºæ•°æ®æºã€‚ä¹‹åï¼Œæˆ‘ä»¬åˆ›å»ºå®ä½“ç®¡ç†å™¨å·¥å‚ã€‚å·¥å‚beanç”¨äºè®¾ç½®äº‹åŠ¡ç®¡ç†å™¨å’Œå®ä½“ç®¡ç†å™¨ã€‚</p><p id="f8e7" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">åœ¨å®ä½“æœåŠ¡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç›¸å…³çš„äº‹åŠ¡ç®¡ç†å™¨:</p><pre class="mn mo mp mq gu mr lj ms bn mt mu bi"><span id="cf75" class="mv ll iu lj b be mw mx l my mz">@Transactional(transactionManager = "postgresqlUserTransactionManager")</span></pre></div><div class="ab cl na nb hy nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="in io ip iq ir"><h1 id="8d9a" class="lk ll iu bd lm ln nh lp lq lr ni lt lu lv nj lx ly lz nk mb mc md nl mf mg mh bi translated">Flywayæ€ä¹ˆæ ·ï¼Ÿ</h1><p id="0600" class="pw-post-body-paragraph kh ki iu kj b kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le in bi translated"><strong class="kj iv"> <em class="lf">æ‚¨å¦‚ä½•å°†æ•°æ®è¿ç§»åˆ°è¿™äº›æ•°æ®åº“ä¸­ï¼Ÿ</em> </strong></p><p id="be8c" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">æ­¤è§£å†³æ–¹æ¡ˆä¸­ç¼ºå°‘çš„éƒ¨åˆ†æ˜¯Flywayè¿ç§»ã€‚æˆ‘ä¼šæŠŠè¿™éƒ¨åˆ†ç•™ç»™ä½ å»æƒ³ã€‚</p><p id="3d56" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">æˆ‘ä¼šæŠŠéœ€è¦çš„æ­¥éª¤å†™åœ¨è¿™é‡Œã€‚T25ã€‘</p><p id="51a1" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">æ‚¨éœ€è¦è·å–æ•°æ®æºå±æ€§ï¼Œå¹¶å°†å®ƒä»¬åŠ è½½åˆ°è¿ç§»å™¨ç±»ä¸­ã€‚ç„¶åéå†å®ƒä»¬ï¼Œè¿è¡Œåˆ°ç‰¹å®šæ•°æ®åº“çš„è¿ç§»ã€‚</p><p id="fbe2" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv"> <em class="lf">å¦‚æœä½ éœ€è¦è¿™ä¸ªé¡¹ç›®ä¸Flywayä½ å¯ä»¥æ”¯æŒæˆ‘çš„å·¥ä½œï¼Œå¹¶åœ¨è¿™é‡Œæ‰¾åˆ°æºä»£ç :</em> </strong> <a class="ae kg" href="https://zivce.gumroad.com/l/svvxep" rel="noopener ugc nofollow" target="_blank">å¤šæ•°æ®æº/æ•°æ®åº“çš„Spring Bootåº”ç”¨</a></p></div><div class="ab cl na nb hy nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="in io ip iq ir"><h1 id="1150" class="lk ll iu bd lm ln nh lp lq lr ni lt lu lv nj lx ly lz nk mb mc md nl mf mg mh bi translated">äº†è§£è¯¥è§£å†³æ–¹æ¡ˆæœ‰ä»€ä¹ˆé‡è¦çš„ï¼Ÿ</h1><p id="f240" class="pw-post-body-paragraph kh ki iu kj b kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le in bi translated"><em class="lf">æˆ‘ä»¬æ ¹æœ¬æ²¡æœ‰ä½¿ç”¨</em> <code class="fe lg lh li lj b"><em class="lf">@Primary</em></code> <em class="lf">æ ‡æ³¨ã€‚</em></p><p id="efd2" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">è¿™æ„å‘³ç€è¿™æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¤šæ•°æ®åº“é¡¹ç›®ã€‚æ‚¨å¯ä»¥æ‹¥æœ‰ä¸åŒçš„æ•°æ®åº“ï¼Œå¹¶ä¸”å¯ä»¥é’ˆå¯¹æ‰€æœ‰è¿™äº›æ•°æ®åº“ã€‚æ­¤å¤–ï¼Œæ‚¨å¯ä»¥å…³é—­æŸä¸ªæ•°æ®åº“ï¼Œè½¬åˆ°å¦ä¸€ä¸ªæ•°æ®åº“ã€‚</p><p id="6dd4" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><em class="lf"> Flywayå¯ä»¥è¿è¡Œåˆ°æ¯ä¸ªæ•°æ®åº“çš„è¿ç§»ã€‚</em></p><p id="c82f" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">å¦‚æœæ‚¨å·²ç»å®Œæˆäº†ä¸Šé¢çš„æ­¥éª¤æˆ–è€…æ‰¾åˆ°äº†æˆ‘çš„è§£å†³æ–¹æ¡ˆï¼Œæ‚¨å¯ä»¥è¿ç§»åˆ°æ¯ä¸ªæ•°æ®åº“ã€‚ä½¿ç”¨ç°æˆçš„flywayï¼Œæ‚¨åªèƒ½è¿ç§»åˆ°ä¸»æ•°æ®æºã€‚</p><p id="93b8" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">ä»¥ä¸‹æ˜¯å‘H2å’ŒPostgreSQLçš„è¿ç§»:</p><figure class="mn mo mp mq gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj nm"><img src="../Images/e958dd2ce71e65822c6433d9bda51df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zsxMhcFKM5xAvO7_ywlrpg.png"/></div></div></figure><p id="c087" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><em class="lf"> Flywayé»˜è®¤</em> <a class="ae kg" href="https://stackoverflow.com/questions/37281229/multiple-datasources-migrations-using-flyway-in-a-spring-boot-application" rel="noopener ugc nofollow" target="_blank"> <em class="lf">æŒ‘é€‰ä¸»æ•°æ®æºï¼Œåªå‘ä¸»æ•°æ®æºè¿ç§»</em> </a> <em class="lf">ã€‚</em></p><p id="e7e1" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">å¦‚æœéœ€è¦ï¼Œæ‚¨è¿˜å¯ä»¥æ’å…¥ä»»ä½•æ•°æ®åº“ã€‚æŒ‰ç…§æœ€åˆçš„è¯·æ±‚ï¼Œæ‚¨å¯ä»¥æŒ‰éœ€åˆ é™¤æ•°æ®åº“ã€‚é¡¹ç›®å°†ç»§ç»­ä½¿ç”¨é…ç½®å¥½çš„æ•°æ®åº“ã€‚</p><p id="02d8" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv"> <em class="lf">æ¯”æ©æ²¡æœ‰å¿…è¦å‹å€’ä¸€åˆ‡ã€‚</em> </strong></p><p id="f728" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">ç”¨<code class="fe lg lh li lj b">@Primary</code>ä½ å°†éœ€è¦ä¸€ä¸ªè¦†ç›–ç‰¹æ€§ã€‚æœ‰äº†è¿™ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°±æ²¡æœ‰è¿™ä¸ªå¿…è¦äº†ã€‚</p></div><div class="ab cl na nb hy nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="in io ip iq ir"><h1 id="c36e" class="lk ll iu bd lm ln nh lp lq lr ni lt lu lv nj lx ly lz nk mb mc md nl mf mg mh bi translated">åˆ†çº§ç¼–ç </h1><p id="0f52" class="pw-post-body-paragraph kh ki iu kj b kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le in bi translated">æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼åœ¨ä½ ç¦»å¼€ä¹‹å‰:</p><ul class=""><li id="3b55" class="nn no iu kj b kk kl ko kp ks np kw nq la nr le ns nt nu nv bi translated">ğŸ‘ä¸ºæ•…äº‹é¼“æŒï¼Œè·Ÿç€ä½œè€…èµ°ğŸ‘‰</li><li id="1d7b" class="nn no iu kj b kk nw ko nx ks ny kw nz la oa le ns nt nu nv bi translated">ğŸ“°æŸ¥çœ‹<a class="ae kg" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">å‡çº§ç¼–ç å‡ºç‰ˆç‰©</a>ä¸­çš„æ›´å¤šå†…å®¹</li><li id="1f31" class="nn no iu kj b kk nw ko nx ks ny kw nz la oa le ns nt nu nv bi translated">ğŸ””å…³æ³¨æˆ‘ä»¬:<a class="ae kg" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kg" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae kg" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">æ—¶äº‹é€šè®¯</a></li></ul><p id="eabe" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">ğŸš€ğŸ‘‰<a class="ae kg" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kj iv">åŠ å…¥å‡çº§äººæ‰é›†ä½“ï¼Œæ‰¾åˆ°ä¸€ä»½æƒŠè‰³çš„å·¥ä½œ</strong> </a></p></div></div>    
</body>
</html>