<html>
<head>
<title>How to recreate the GitHub contribution graph with Node.js and Google Sheets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js和Google Sheets重新创建GitHub贡献图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-create-a-tracker-like-the-github-contribution-graph-with-node-js-and-google-sheets-5e915c668c1?source=collection_archive---------1-----------------------#2019-07-06">https://levelup.gitconnected.com/how-to-create-a-tracker-like-the-github-contribution-graph-with-node-js-and-google-sheets-5e915c668c1?source=collection_archive---------1-----------------------#2019-07-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8f3b06f806e5f7e1d341b515953e3589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZskprROxeng7urZd6WpGiw.png"/></div></div></figure><p id="3909" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">今年，我决定专注于个人成长(T2)，面临两个主要挑战:学习如何编码，以及变得更好。两者都包括创造日常习惯。自一月份以来，我一直用电子表格来追踪这两方面的情况。</p><p id="5c29" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是我注意到了一种我非常喜欢的格式，有几个产品都在使用这种格式:GitHub的彩色方格网格因其贡献图而流行起来。</p><p id="84e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kw" href="https://getmakerlog.com/" rel="noopener ugc nofollow" target="_blank"> Makerlog </a>上看到它用于跟踪日常任务，Puregym用于跟踪健身课程，而<a class="ae kw" href="https://twitter.com/stephsmithio" rel="noopener ugc nofollow" target="_blank"> Steph Smith </a>最近创建了<a class="ae kw" href="https://progression.page/" rel="noopener ugc nofollow" target="_blank">一个web应用</a>使用这个图表来跟踪编码课程。</p><p id="c857" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我想挑战自己，看看我是否可以基于我的电子表格构建这样一个动态图表。</p><p id="b236" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本教程使用Node.js、Express、Google Sheets API和Bootstrap。我将介绍从从电子表格中提取数据到样式化数据的每个步骤。你可以在这里看到一个演示<a class="ae kw" href="https://pixel-progress.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">，最终文件在这里</a><a class="ae kw" href="https://github.com/anthilemoon/pixel-progress" rel="noopener ugc nofollow" target="_blank"/>。你可以随意使用它们。</p><h1 id="648c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">1)创建谷歌表单</h1><p id="9a29" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我已经有一个电子表格，但创建了一个副本，以一个干净的文件开始。如果您想跳过这一部分，您可以复制一份<a class="ae kw" href="https://docs.google.com/spreadsheets/d/1JnMcbcxlaX4ARvTM1ek8I4wcd4NXL_8pl3yDQvdEsKE/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">电子表格</a>。如果你对我的编码之旅感兴趣的话，这是来自我实际的跟踪器的数据😊</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/bac07ac7d5f6281be2c0e90442a44de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V7YbNBsMISbbP-DuJDxAYA.png"/></div></div></figure><p id="551b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想跟着，让我们一起完成每一步。</p><p id="9402" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，添加以下标题:</p><ul class=""><li id="b22e" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">日期</li><li id="5bc2" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">主题</li><li id="38e0" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">时间</li><li id="4d15" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">水平</li><li id="d871" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">注释(可选)</li></ul><p id="b468" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们不会从web应用程序的“笔记”栏中提取数据，这只是一个让您可以轻松写下任何值得记住的特定日子的地方。</p><p id="ed64" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，点击<code class="fe mt mu mv mw b">View &gt; Freeze &gt; 1 Row</code>冻结标题。</p><p id="7881" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用当年1月1日到12月31日的日期填写第一列。</p><p id="03ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第二列和第三列中添加一些虚拟数据。例如，在“主题”栏中添加“jQuery”作为您学习的主题，在“时间”栏中添加“120”作为您学习的分钟数。这样做几天，这样我们就可以看到事情是否正常工作。</p><p id="19c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，在“级别”列中添加以下公式，从单元格D2开始:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="e12c" class="nb ky iq mw b gy nc nd l ne nf">=IF(C2=0,"0",IF(C2&lt;=60,"1",IF(C2&lt;=120,"2","3")))</span></pre><p id="82ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个公式的作用是根据“时间”栏的输入计算你的活动水平。</p><ul class=""><li id="58a3" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">如果时间= 0，级别= 0</li><li id="a5b6" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">如果时间&lt;= 60 minutes, level = 1</li><li id="59d3" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">If time &lt;= 120 minutes, level =2</li><li id="e414" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">Else level = 3</li></ul><p id="7bce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">These will be helpful to allow us to pick a different colour for the squares based on how much time we dedicated to the chosen activity, in this case, learning how to code. You can edit the formula above to make the levels correspond to different times that make more sense for you and your chosen activity.</p><p id="67cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">That’s it! Our spreadsheet is ready. And no, we don’t need to publish it.</p><h1 id="9abb" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">2) Build your application</h1><p id="857a" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">You can skip the first steps of this section if you’re comfortable with Node.js already. I want to write this part as I often struggle with tutorials that skip on some parts the author deems obvious.</p><p id="2c60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">If it’s your first time using Node.js, we’ll first need to install it. <a class="ae kw" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">到了，下载</a>安装程序并按照说明操作。</p><p id="e3e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，打开你的终端。我强烈推荐安装<a class="ae kw" href="https://hyper.is/" rel="noopener ugc nofollow" target="_blank"> Hyper </a>，但是这个教程绝对不需要。如果你想坚持默认的终端，在Windows上按WinKey+R，然后输入<code class="fe mt mu mv mw b">cmd</code>并回车，或者在Mac上搜索“终端”即可。</p><p id="f12a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们为我们的应用程序创建一个目录。键入<code class="fe mt mu mv mw b">mkdir pixel-progress</code>并按回车键。<code class="fe mt mu mv mw b">mkdir</code>代表“制作目录”,该命令创建一个名为“像素进度”的目录。</p><p id="0784" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们进入这个目录。键入<code class="fe mt mu mv mw b">cd pixel-progress</code> ( <code class="fe mt mu mv mw b">cd</code>代表“更改目录”)并按回车键，这样我们现在就在我们的目录中了。</p><p id="890a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在这个目录中创建两个文件夹。键入<code class="fe mt mu mv mw b">mkdir public views</code>，将创建两个目录，分别名为“public”和“views”。稍后我会解释这些是做什么用的，但是它们基本上包含了我们应用程序的所有前端部分。</p><p id="505d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在输入<code class="fe mt mu mv mw b">touch app.js</code>——<code class="fe mt mu mv mw b">mkdir</code>是创建文件夹，<code class="fe mt mu mv mw b">touch</code>是创建文件，所以这个命令将创建一个名为“app.js”的文件，它将是我们应用程序的主干。</p><p id="fcb5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好了，我们已经有了所有必要的文件可以开始了！现在，让我们让它们更聪明一点。</p><p id="f123" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Node.js打包了一个叫做<a class="ae kw" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>的东西，这基本上是一种重用其他JavaScript开发人员代码的超级简单的方法，所以你不必总是从头开始。</p><p id="ebb0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于本教程，我们将使用一些npm包(即由其他优秀的开发人员编写的代码)，它们将使我们的生活变得更加轻松。</p><p id="c65a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们在目录中初始化npm，这样我们就可以使用它了。在终端中键入<code class="fe mt mu mv mw b">npm init</code>并按enter键。你将会看到一系列的提示，询问你一些问题，比如你的应用程序的许可，作者等等。只要不断地按enter键直到它停止询问任何东西，就可以让一切都保持默认状态。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/6b9d0caf53ce6c2480856b9c52918e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xTYkBhiITUHRQ7XPlAiR5g.png"/></div></div></figure><p id="8794" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，让我们安装我们的应用程序中需要的那些包。在终端中键入以下内容，然后按enter键:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="c66a" class="nb ky iq mw b gy nc nd l ne nf">npm install express request ejs googleapis@39 — save</span></pre><p id="a146" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们打开这个。</p><p id="91b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们要求npm安装以下软件包:</p><ul class=""><li id="3840" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated"><strong class="ka ir">Express:</strong>node . js的框架，它将帮助我们创建动态页面</li><li id="1bac" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated"><strong class="ka ir">请求:</strong>这样客户端可以向服务器请求信息</li><li id="dacd" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated"><strong class="ka ir"> EJS: </strong>一种模板语言，它将让我们用JavaScript生成HTML</li><li id="20cd" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated"><strong class="ka ir">Google API @ 39:</strong>Google Sheets API</li></ul><p id="ef26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">前三个是基本包，通常在创建新的Node.js应用程序时安装。我在<a class="ae kw" href="https://developers.google.com/sheets/api/quickstart/nodejs" rel="noopener ugc nofollow" target="_blank"> Google Sheets API文档</a>中找到了最后一个，我们将在后面更深入地回顾它。</p><p id="d2fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">唷。这是一个很大的开始。现在让我们开始吧。</p><p id="b21e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在终端中，键入<code class="fe mt mu mv mw b">{name of your programming text editor} .</code>，包括句号。如果你用VS代码，那就是<code class="fe mt mu mv mw b">code .</code>，对于Atom是<code class="fe mt mu mv mw b">atom .</code>，对于Sublime是<code class="fe mt mu mv mw b">sublime .</code>—<code class="fe mt mu mv mw b">.</code>告诉终端打开这个文件夹。</p><p id="14eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe mt mu mv mw b">app.js</code>中键入以下内容并保存更改:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="d155" class="nb ky iq mw b gy nc nd l ne nf">const express = require('express');</span><span id="32cc" class="nb ky iq mw b gy nh nd l ne nf">const request = require('request');<br/></span><span id="93c9" class="nb ky iq mw b gy nh nd l ne nf">app = express();<br/></span><span id="4343" class="nb ky iq mw b gy nh nd l ne nf">app.set('view engine', 'ejs');<br/></span><span id="a219" class="nb ky iq mw b gy nh nd l ne nf">app.use(express.static('public'));<br/></span><span id="4290" class="nb ky iq mw b gy nh nd l ne nf">app.listen(process.env.PORT || 3000, function() {</span><span id="0e6d" class="nb ky iq mw b gy nh nd l ne nf">console.log('Server running on port 3000.');</span><span id="9a4d" class="nb ky iq mw b gy nh nd l ne nf">});</span></pre><p id="96a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">前两行告诉我们的应用程序需要我们之前安装的“Express”和“Request”模块。然后，我们创建一个新的Express实例，将模板引擎设置为EJS，并告诉Express从我们之前创建的“公共”目录中提供静态文件。</p><p id="0529" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们告诉服务器监听哪个端口。由于我们还没有部署我们的应用程序，我们将使用端口3000，但是<code class="fe mt mu mv mw b">process.env.PORT</code>位将让我们的环境(例如Heroku)稍后为我们设置变量。</p><p id="4692" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们通过创建第一条路线来检查一切是否正常。在<code class="fe mt mu mv mw b">app.use</code>和<code class="fe mt mu mv mw b">app.listen</code>部件之间，键入以下内容:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="ee1c" class="nb ky iq mw b gy nc nd l ne nf">app.get("/", function(req, res){</span><span id="72ea" class="nb ky iq mw b gy nh nd l ne nf">console.log("Hello!");</span><span id="bd10" class="nb ky iq mw b gy nh nd l ne nf">}</span></pre><p id="4d54" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在打开你的浏览器，在地址栏输入<code class="fe mt mu mv mw b">localhost:3000</code>。然后，打开你的终端。如果到目前为止一切顺利，您应该会看到“你好！”打印在终端中。</p><h1 id="b113" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">3)连接Google Sheet和Node.js应用程序</h1><p id="d77b" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">对于这一部分，我们将简单地遵循<a class="ae kw" href="https://developers.google.com/sheets/api/quickstart/nodejs" rel="noopener ugc nofollow" target="_blank"> Google Sheets API文档</a>。您应该确保使用您的Google帐户登录。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/70d7a80b49feb11cac2755b8420faf2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNMDqXUp-DWqS1ZjjaZyoQ.png"/></div></div></figure><p id="ff95" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，点击“启用Google Sheets API”。在出现的弹出窗口中，单击“下载客户端配置”。将您刚刚下载的<code class="fe mt mu mv mw b">credentials.json</code>文件放在您的工作目录中，与您的<code class="fe mt mu mv mw b">app.js</code>文件所在的目录相同。</p><p id="e56c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为我们已经安装了这个库，所以我们可以直接将文档中提供的代码样本复制并粘贴到我们的<code class="fe mt mu mv mw b">app.js</code>文件中。</p><p id="c066" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，将这一部分添加到文件顶部其他必需包的下面:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="519a" class="nb ky iq mw b gy nc nd l ne nf">const fs = require('fs');</span><span id="a6db" class="nb ky iq mw b gy nh nd l ne nf">const readline = require('readline');</span><span id="2a63" class="nb ky iq mw b gy nh nd l ne nf">const {google} = require('googleapis');</span></pre><p id="25ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，用该零件替换用于测试目的的<code class="fe mt mu mv mw b">console.log("Hello!")</code>线:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="6932" class="nb ky iq mw b gy nc nd l ne nf">// Load client secrets from a local file.</span><span id="28c8" class="nb ky iq mw b gy nh nd l ne nf">fs.readFile('credentials.json', (err, content) =&gt; {</span><span id="c545" class="nb ky iq mw b gy nh nd l ne nf">if (err) return console.log('Error loading client secret file:', err);</span><span id="6fef" class="nb ky iq mw b gy nh nd l ne nf">// Authorize a client with credentials, then call the Google Sheets API.</span><span id="c298" class="nb ky iq mw b gy nh nd l ne nf">authorize(JSON.parse(content), listMajors);</span><span id="7f6c" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="69fe" class="nb ky iq mw b gy nh nd l ne nf">/**</span><span id="083e" class="nb ky iq mw b gy nh nd l ne nf">* Prints the names and majors of students in a sample spreadsheet:</span><span id="865b" class="nb ky iq mw b gy nh nd l ne nf">* @see <a class="ae kw" href="https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit</a></span><span id="921a" class="nb ky iq mw b gy nh nd l ne nf">* @param {google.auth.OAuth2} auth The authenticated Google OAuth client.</span><span id="a72d" class="nb ky iq mw b gy nh nd l ne nf">*/</span><span id="4805" class="nb ky iq mw b gy nh nd l ne nf">function listMajors(auth) {</span><span id="312f" class="nb ky iq mw b gy nh nd l ne nf">const sheets = google.sheets({version: 'v4', auth});</span><span id="c462" class="nb ky iq mw b gy nh nd l ne nf">sheets.spreadsheets.values.get({</span><span id="372e" class="nb ky iq mw b gy nh nd l ne nf">spreadsheetId: '1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms',</span><span id="ca0c" class="nb ky iq mw b gy nh nd l ne nf">range: 'Class Data!A2:E',</span><span id="18cb" class="nb ky iq mw b gy nh nd l ne nf">}, (err, res) =&gt; {</span><span id="ea7f" class="nb ky iq mw b gy nh nd l ne nf">if (err) return console.log('The API returned an error: ' + err);</span><span id="1377" class="nb ky iq mw b gy nh nd l ne nf">const rows = res.data.values;</span><span id="3480" class="nb ky iq mw b gy nh nd l ne nf">if (rows.length) {</span><span id="78b8" class="nb ky iq mw b gy nh nd l ne nf">console.log('Name, Major:');</span><span id="11d1" class="nb ky iq mw b gy nh nd l ne nf">// Print columns A and E, which correspond to indices 0 and 4.</span><span id="937a" class="nb ky iq mw b gy nh nd l ne nf">rows.map((row) =&gt; {</span><span id="e177" class="nb ky iq mw b gy nh nd l ne nf">console.log(`${row[0]}, ${row[4]}`);</span><span id="46e3" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="4a7f" class="nb ky iq mw b gy nh nd l ne nf">} else {</span><span id="7263" class="nb ky iq mw b gy nh nd l ne nf">console.log('No data found.');</span><span id="cbe5" class="nb ky iq mw b gy nh nd l ne nf">}</span><span id="2bb5" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="7dd7" class="nb ky iq mw b gy nh nd l ne nf">}</span></pre><p id="8eed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，将所有这些复制并粘贴到<code class="fe mt mu mv mw b">app.listen</code>部分之前:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="3641" class="nb ky iq mw b gy nc nd l ne nf">// If modifying these scopes, delete token.json.</span><span id="454a" class="nb ky iq mw b gy nh nd l ne nf">const SCOPES = [‘https://www.googleapis.com/auth/spreadsheets.readonly'];</span><span id="fda2" class="nb ky iq mw b gy nh nd l ne nf">// The file token.json stores the user’s access and refresh tokens, and is</span><span id="c64f" class="nb ky iq mw b gy nh nd l ne nf">// created automatically when the authorization flow completes for the first</span><span id="957f" class="nb ky iq mw b gy nh nd l ne nf">// time.</span><span id="04e5" class="nb ky iq mw b gy nh nd l ne nf">const TOKEN_PATH = 'token.json';</span><span id="1caa" class="nb ky iq mw b gy nh nd l ne nf">/**</span><span id="0bc1" class="nb ky iq mw b gy nh nd l ne nf">* Create an OAuth2 client with the given credentials, and then execute the</span><span id="6528" class="nb ky iq mw b gy nh nd l ne nf">* given callback function.</span><span id="7e10" class="nb ky iq mw b gy nh nd l ne nf">* @param {Object} credentials The authorization client credentials.</span><span id="bb87" class="nb ky iq mw b gy nh nd l ne nf">* @param {function} callback The callback to call with the authorized client.</span><span id="ca21" class="nb ky iq mw b gy nh nd l ne nf">*/</span><span id="cddf" class="nb ky iq mw b gy nh nd l ne nf">function authorize(credentials, callback) {</span><span id="89ea" class="nb ky iq mw b gy nh nd l ne nf">const {client_secret, client_id, redirect_uris} = credentials.installed;</span><span id="33ed" class="nb ky iq mw b gy nh nd l ne nf">const oAuth2Client = new google.auth.OAuth2(</span><span id="e98a" class="nb ky iq mw b gy nh nd l ne nf">client_id, client_secret, redirect_uris[0]);</span><span id="f4be" class="nb ky iq mw b gy nh nd l ne nf">// Check if we have previously stored a token.</span><span id="0bf5" class="nb ky iq mw b gy nh nd l ne nf">fs.readFile(TOKEN_PATH, (err, token) =&gt; {</span><span id="d8bb" class="nb ky iq mw b gy nh nd l ne nf">if (err) return getNewToken(oAuth2Client, callback);</span><span id="e120" class="nb ky iq mw b gy nh nd l ne nf">oAuth2Client.setCredentials(JSON.parse(token));</span><span id="014d" class="nb ky iq mw b gy nh nd l ne nf">callback(oAuth2Client);</span><span id="5be5" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="f7cf" class="nb ky iq mw b gy nh nd l ne nf">}</span><span id="59f8" class="nb ky iq mw b gy nh nd l ne nf">/**</span><span id="3206" class="nb ky iq mw b gy nh nd l ne nf">* Get and store new token after prompting for user authorization, and then</span><span id="52ce" class="nb ky iq mw b gy nh nd l ne nf">* execute the given callback with the authorized OAuth2 client.</span><span id="5146" class="nb ky iq mw b gy nh nd l ne nf">* @param {google.auth.OAuth2} oAuth2Client The OAuth2 client to get token for.</span><span id="30c7" class="nb ky iq mw b gy nh nd l ne nf">* @param {getEventsCallback} callback The callback for the authorized client.</span><span id="0141" class="nb ky iq mw b gy nh nd l ne nf">*/</span><span id="163e" class="nb ky iq mw b gy nh nd l ne nf">function getNewToken(oAuth2Client, callback) {</span><span id="ba92" class="nb ky iq mw b gy nh nd l ne nf">const authUrl = oAuth2Client.generateAuthUrl({</span><span id="c06d" class="nb ky iq mw b gy nh nd l ne nf">access_type: 'offline',</span><span id="c69f" class="nb ky iq mw b gy nh nd l ne nf">scope: SCOPES,</span><span id="c7f1" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="0b9e" class="nb ky iq mw b gy nh nd l ne nf">console.log('Authorize this app by visiting this url:', authUrl);</span><span id="d57a" class="nb ky iq mw b gy nh nd l ne nf">const rl = readline.createInterface({</span><span id="e0f3" class="nb ky iq mw b gy nh nd l ne nf">input: process.stdin,</span><span id="b776" class="nb ky iq mw b gy nh nd l ne nf">output: process.stdout,</span><span id="960b" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="db4e" class="nb ky iq mw b gy nh nd l ne nf">rl.question('Enter the code from that page here: ', (code) =&gt; {</span><span id="b34c" class="nb ky iq mw b gy nh nd l ne nf">rl.close();</span><span id="0fc2" class="nb ky iq mw b gy nh nd l ne nf">oAuth2Client.getToken(code, (err, token) =&gt; {</span><span id="b0fd" class="nb ky iq mw b gy nh nd l ne nf">if (err) return console.error('Error while trying to retrieve access token', err);</span><span id="c2de" class="nb ky iq mw b gy nh nd l ne nf">oAuth2Client.setCredentials(token);</span><span id="2733" class="nb ky iq mw b gy nh nd l ne nf">// Store the token to disk for later program executions</span><span id="9d4e" class="nb ky iq mw b gy nh nd l ne nf">fs.writeFile(TOKEN_PATH, JSON.stringify(token), (err) =&gt; {</span><span id="aa49" class="nb ky iq mw b gy nh nd l ne nf">if (err) return console.error(err);</span><span id="1cdd" class="nb ky iq mw b gy nh nd l ne nf">console.log('Token stored to', TOKEN_PATH);</span><span id="d17c" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="69a0" class="nb ky iq mw b gy nh nd l ne nf">callback(oAuth2Client);</span><span id="a948" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="6379" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="f27a" class="nb ky iq mw b gy nh nd l ne nf">}</span></pre><p id="35f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过在终端中键入<code class="fe mt mu mv mw b">node .</code>来运行示例，并按照说明进行身份验证。您将获得一个授权码，您需要将它粘贴到终端上。这一步很重要，因为这是允许你的应用程序访问你的电子表格，即使你没有公开它。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/11a6b406091fc3b3be66f50f1120da16.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*Ke4AkfGI9IO-SGXcpyJnmg.png"/></div></figure><p id="2e4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在一切都正常了，让我们修改代码，这样我们实际上使用的是我们自己的电子表格，而不是示例电子表格。</p><ul class=""><li id="29b1" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">将该功能从<code class="fe mt mu mv mw b">listMajors</code>重命名为<code class="fe mt mu mv mw b">pullData</code> —小心它在<code class="fe mt mu mv mw b">app.js</code>中出现两次，第一次是授权访问我们的电子表格，然后实际运行该功能。</li><li id="4e3a" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">用您的ID替换电子表格ID—您可以在电子表格的URL中找到它。</li></ul><p id="062a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">current函数只从一个区域提取数据。我们想从电子表格的几个区域中提取数据。幸运的是，Google Sheets API提供了一个名为<a class="ae kw" href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/batchGet" rel="noopener ugc nofollow" target="_blank"> batchGet </a>的方法，它允许我们<em class="nk">“从电子表格中返回一个或多个数值范围。”</em></p><p id="ca6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们用<code class="fe mt mu mv mw b">sheets.spreadsheets.values.batchGet</code>代替<code class="fe mt mu mv mw b">sheets.spreadsheets.values.get</code>来使用这个方法。</p><p id="0430" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，用<code class="fe mt mu mv mw b">ranges</code>替换<code class="fe mt mu mv mw b">range</code>，并输入我们希望从电子表格中访问的范围:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="0c7e" class="nb ky iq mw b gy nc nd l ne nf">ranges: ['2019!A2:A366', '2019!B2:B366', '2019!C2:C366', '2019!D2:D366']</span></pre><p id="65df" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，“2019”是电子表格中特定工作表的名称，您可以在底部的选项卡上看到该名称。</p><p id="3075" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们为它们创建变量，这样我们就可以访问它们并使用它们做一些事情。用以下内容替换行<code class="fe mt mu mv mw b">const rows = res.data.values</code>:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="ee39" class="nb ky iq mw b gy nc nd l ne nf">const date = response.data.valueRanges[0].values;</span><span id="e87d" class="nb ky iq mw b gy nh nd l ne nf">const topic = response.data.valueRanges[1].values;</span><span id="2353" class="nb ky iq mw b gy nh nd l ne nf">const time = response.data.valueRanges[2].values;</span><span id="6633" class="nb ky iq mw b gy nh nd l ne nf">const level = response.data.valueRanges[3].values;<br/></span><span id="a7de" class="nb ky iq mw b gy nh nd l ne nf">const data = [date, topic, time, level];</span></pre><p id="07cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这创建了四个变量来存储我们的数据——日期、主题、时间和级别——然后将它们放在一个<code class="fe mt mu mv mw b">data</code>数组中，这将使它们更容易操作。您可以通过控制台以与文档中所示相同的方式记录结果数据来测试一切是否正常:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="be89" class="nb ky iq mw b gy nc nd l ne nf">if (data.length) {</span><span id="912c" class="nb ky iq mw b gy nh nd l ne nf">console.log('Data:');</span><span id="953a" class="nb ky iq mw b gy nh nd l ne nf">// Print columns A to C, which correspond to indices 0 to 2.</span><span id="23f3" class="nb ky iq mw b gy nh nd l ne nf">data.map((row) =&gt; {</span><span id="b0ee" class="nb ky iq mw b gy nh nd l ne nf">console.log(`${row[0]}, ${row[1]}, ${row[2]}`);</span><span id="ddb9" class="nb ky iq mw b gy nh nd l ne nf">});</span><span id="894f" class="nb ky iq mw b gy nh nd l ne nf">} else {</span><span id="f152" class="nb ky iq mw b gy nh nd l ne nf">console.log('No data found.');</span><span id="e59e" class="nb ky iq mw b gy nh nd l ne nf">}</span></pre><p id="5b09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这应该会在终端中打印出电子表格中的数据。</p><p id="4568" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就是这样！我们现在连接上了，并从我们的电子表格中提取数据。现在，让我们在我们的应用程序中显示它。</p><h1 id="a95b" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">4)在应用程序中显示来自谷歌工作表的数据</h1><p id="d9bc" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">现在是时候使用我们选择的模板引擎<a class="ae kw" href="https://ejs.co/" rel="noopener ugc nofollow" target="_blank"> EJS </a>了。模板允许我们在HTML标记中使用特殊的标签来插入变量或运行编程逻辑。</p><p id="f9b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用以下内容替换我们刚刚用来测试一切正常的控制台日志位:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="45cd" class="nb ky iq mw b gy nc nd l ne nf">res.render('home', {data: data});</span></pre><p id="d9b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们后退一步，看看我们的代码，我们告诉我们的应用程序的是<em class="nk">“如果有人访问/ route，运行所有访问我的Google电子表格的代码，并呈现主页，同时包含结果数据。”</em></p><p id="792b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好的，但是我们没有主页，所以让我们创建它。在你的<code class="fe mt mu mv mw b">views</code>文件夹中，创建一个<code class="fe mt mu mv mw b">home.ejs</code>文件。用常规的HTML样板文件填充它。</p><p id="c87e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在div中，添加以下内容:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="b76d" class="nb ky iq mw b gy nc nd l ne nf">&lt;%= data %&gt;</span></pre><p id="2d79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这告诉文件显示我们之前传递的数据。现在，在<code class="fe mt mu mv mw b">localhost:3000</code>刷新你的浏览器页面，看看是否一切正常。在本教程开始时，您应该看到包含在电子表格中的所有占位符数据非常难看。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/acdee6af63e40d4cc742abfec7ff38fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*ICGxGTk93j1RobvDKuoqGg.png"/></div></figure><p id="da57" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">厉害！现在，让我们做得漂亮点。</p><h1 id="b5d0" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">5)将数据样式化，使其看起来像GitHub贡献图</h1><p id="2e66" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">我不擅长CSS，也不想在这里多此一举，所以我用了<a class="ae kw" href="https://bitsofco.de/github-contribution-graph-css-grid/" rel="noopener ugc nofollow" target="_blank">Ire Aderinokun</a>的这个很酷的教程。可能有更好的方法，这不是最容易使用的方法(表格会更好)，但它确实起了作用。如果你想换一种方式，请分享！</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/9583764a4cab6de19e736f182fa6ae7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vv8wMyjY2jdK7nJknGopJA.png"/></div></div></figure><p id="fbb6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://codepen.io/ire/pen/Legmwo/" rel="noopener ugc nofollow" target="_blank">这里的</a>是代码笔，你可以在这里复制HTML和CSS。</p><p id="4208" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，将这一部分粘贴到您的<code class="fe mt mu mv mw b">home.ejs</code>文件中:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="e003" class="nb ky iq mw b gy nc nd l ne nf">&lt;div class="graph"&gt;</span><span id="a096" class="nb ky iq mw b gy nh nd l ne nf">&lt;ul class="months"&gt;</span><span id="b3ad" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Jan&lt;/li&gt;</span><span id="36f8" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Feb&lt;/li&gt;</span><span id="b465" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Mar&lt;/li&gt;</span><span id="be44" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Apr&lt;/li&gt;</span><span id="12f4" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;May&lt;/li&gt;</span><span id="b1dd" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Jun&lt;/li&gt;</span><span id="1228" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Jul&lt;/li&gt;</span><span id="24fd" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Aug&lt;/li&gt;</span><span id="75b2" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Sep&lt;/li&gt;</span><span id="ab80" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Oct&lt;/li&gt;</span><span id="1fcd" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Nov&lt;/li&gt;</span><span id="f41c" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Dec&lt;/li&gt;</span><span id="d7f0" class="nb ky iq mw b gy nh nd l ne nf">&lt;/ul&gt;</span><span id="fedf" class="nb ky iq mw b gy nh nd l ne nf">&lt;ul class="days"&gt;</span><span id="2d9f" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Sun&lt;/li&gt;</span><span id="b320" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Mon&lt;/li&gt;</span><span id="471e" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Tue&lt;/li&gt;</span><span id="f8d5" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Wed&lt;/li&gt;</span><span id="be7a" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Thu&lt;/li&gt;</span><span id="aad1" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Fri&lt;/li&gt;</span><span id="1510" class="nb ky iq mw b gy nh nd l ne nf">&lt;li&gt;Sat&lt;/li&gt;</span><span id="f403" class="nb ky iq mw b gy nh nd l ne nf">&lt;/ul&gt;</span><span id="bcfa" class="nb ky iq mw b gy nh nd l ne nf">&lt;ul class="squares"&gt;</span><span id="5bdd" class="nb ky iq mw b gy nh nd l ne nf">&lt;! -- added via javascript --&gt;</span><span id="1a71" class="nb ky iq mw b gy nh nd l ne nf">&lt;/ul&gt;</span><span id="6fb8" class="nb ky iq mw b gy nh nd l ne nf">&lt;/div&gt;</span></pre><p id="5a15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，转到你的<code class="fe mt mu mv mw b">public</code>文件夹，创建一个<code class="fe mt mu mv mw b">css</code>文件夹，然后在这个文件夹中创建一个<code class="fe mt mu mv mw b">styles.css</code>文件来粘贴上面代码笔中提供的CSS。</p><p id="ffb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的<code class="fe mt mu mv mw b">home.ejs</code>文件的<code class="fe mt mu mv mw b">&lt;head&gt;</code>标签中，添加以下链接到电子表格:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="4719" class="nb ky iq mw b gy nc nd l ne nf">&lt;link href="css/styles.css" rel="stylesheet"&gt;</span></pre><p id="79c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们忽略代码笔中的JavaScript，因为它生成随机值来填充网格，让我们编写自己的代码。用以下内容替换<code class="fe mt mu mv mw b">&lt;! -- added via javascript --&gt;</code>:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="4f12" class="nb ky iq mw b gy nc nd l ne nf">&lt;% for (var i = 0; i &lt; 364; i++) { %&gt;</span><span id="1871" class="nb ky iq mw b gy nh nd l ne nf">&lt;li data-level="&lt;%= data[3][i] %&gt;"&gt;&lt;/li&gt;</span><span id="284e" class="nb ky iq mw b gy nh nd l ne nf">&lt;% } %&gt;</span></pre><p id="2946" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将从我们的<code class="fe mt mu mv mw b">data</code>数组中的第四个位置(我们的<code class="fe mt mu mv mw b">app.js</code>文件中的<code class="fe mt mu mv mw b">const data = [date, topic, time, level]</code>位)提取数据，这对应于我们之前定义的活动级别。我们从一年的第1天循环到第365天。</p><p id="68e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">刷新您的页面，现在应该显示图表，以及您用占位符数据填充的日期的彩色方块！</p><p id="e7f4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个很好显示的数据是你那天实际做了什么，比如体育课或你学习的特定主题。让我们使用Bootstrap中的<a class="ae kw" href="https://getbootstrap.com/docs/4.0/components/tooltips/" rel="noopener ugc nofollow" target="_blank">工具提示</a>组件。</p><p id="a267" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们将它添加到我们的<code class="fe mt mu mv mw b">home.ejs</code>文件的<code class="fe mt mu mv mw b">&lt;head&gt;</code>标签中:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="cbee" class="nb ky iq mw b gy nc nd l ne nf">&lt;link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet”&gt;</span></pre><p id="08ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个在文件的底部，就在结束的<code class="fe mt mu mv mw b">&lt;/body&gt;</code>标记之前:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="2b25" class="nb ky iq mw b gy nc nd l ne nf">&lt;script src="https://code.jquery.com/jquery-3.4.1.min.js"&gt;&lt;/script&gt;</span><span id="f4ff" class="nb ky iq mw b gy nh nd l ne nf">&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"&gt;&lt;/script&gt;</span><span id="c217" class="nb ky iq mw b gy nh nd l ne nf">&lt;script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;</span></pre><p id="4b3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些脚本只是jQuery，以及基本的Bootstrap脚本和<a class="ae kw" href="https://popper.js.org/" rel="noopener ugc nofollow" target="_blank">popper . js</a>,<a class="ae kw" href="https://getbootstrap.com/docs/4.0/components/tooltips/" rel="noopener ugc nofollow" target="_blank">工具提示文档</a>要求我们包含它们以显示工具提示。</p><p id="502a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">文档还告诉我们用下面的方法初始化工具提示:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="25b2" class="nb ky iq mw b gy nc nd l ne nf">$(function () {</span><span id="763c" class="nb ky iq mw b gy nh nd l ne nf">$('[data-toggle="tooltip"]').tooltip()</span><span id="eaca" class="nb ky iq mw b gy nh nd l ne nf">})</span></pre><p id="f3b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们在包含上述代码的<code class="fe mt mu mv mw b">public/js</code>文件夹中创建一个<code class="fe mt mu mv mw b">tooltips.js</code>文件，并像这样将其包含在home.ejs文件夹中的引导脚本之前:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="0103" class="nb ky iq mw b gy nc nd l ne nf">&lt;script src="js/tooltips.js"&gt;&lt;/script&gt;</span></pre><p id="1ac6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，让我们用电子表格中的“主题”数据实际显示悬停工具提示。</p><p id="0325" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用以下内容替换<code class="fe mt mu mv mw b">&lt;li data-level="&lt;%= data[3][i] %&gt;"&gt;&lt;/li&gt;</code>:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="1055" class="nb ky iq mw b gy nc nd l ne nf">&lt;li data-toggle=<!-- -->"<!-- -->tooltip<!-- -->"<!-- --> data-placement=<!-- -->"<!-- -->bottom<!-- -->"<!-- --> data-animation=<!-- -->"<!-- -->false<!-- -->"<!-- --> delay=<!-- -->"<!-- -->0<!-- -->"<!-- --> title=<!-- -->"<!-- -->&lt;%= data[1][i] %&gt;<!-- -->"<!-- --> data-level=<!-- -->"<!-- -->&lt;%= data[3][i] %&gt;<!-- -->"<!-- -->&gt;&lt;/li&gt;</span></pre><p id="b9b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这告诉我们的应用程序:</p><ul class=""><li id="5f92" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">悬停时切换工具提示</li><li id="7e04" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">在方块底部显示工具提示</li><li id="1192" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">当它们出现时不要激活它们</li><li id="b02d" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">使它们延迟0出现</li></ul><p id="99f4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">工具提示的内容通过<code class="fe mt mu mv mw b">&lt;%= data[1][i] %&gt;</code>提取，这是我们电子表格的第二列。</p><p id="f050" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">刷新你的页面，将鼠标悬停在一些彩色方块上，看看它是否有效。你可以使用CSS来设计工具提示的样式或者改变方块的颜色。</p><p id="c42e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这一点特别允许你改变方块的颜色:</p><pre class="mb mc md me gt mx mw my mz aw na bi"><span id="ed26" class="nb ky iq mw b gy nc nd l ne nf">.squares li {</span><span id="6064" class="nb ky iq mw b gy nh nd l ne nf">background-color: #D7DDF2;</span><span id="71c6" class="nb ky iq mw b gy nh nd l ne nf">}</span><span id="9ff8" class="nb ky iq mw b gy nh nd l ne nf">.squares li[data-level="1"] {</span><span id="8f38" class="nb ky iq mw b gy nh nd l ne nf">background-color: #577AF9;</span><span id="bfc2" class="nb ky iq mw b gy nh nd l ne nf">}</span><span id="c0c0" class="nb ky iq mw b gy nh nd l ne nf">.squares li[data-level="2"] {</span><span id="280e" class="nb ky iq mw b gy nh nd l ne nf">background-color: #3960EF;</span><span id="ba25" class="nb ky iq mw b gy nh nd l ne nf">}</span><span id="2214" class="nb ky iq mw b gy nh nd l ne nf">.squares li[data-level="3"] {</span><span id="09f1" class="nb ky iq mw b gy nh nd l ne nf">background-color: #1B3699;</span><span id="0bff" class="nb ky iq mw b gy nh nd l ne nf">}</span></pre><p id="fe67" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，我决定使用蓝色的变体来代替绿色。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/40a9cfb98bfd64f3c67053e5afa73dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SERprdYmHJS-bVS3z9SnHQ.png"/></div></div></figure><p id="446d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">瞧啊。我希望你觉得这很有趣。你可以在这里找到最终文件<a class="ae kw" href="https://github.com/anthilemoon/pixel-progress" rel="noopener ugc nofollow" target="_blank">，在这里</a>找到演示<a class="ae kw" href="https://pixel-progress.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="3c74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">附注:我通常不写教程，但如果你对我其他关于生产力、创造力和产品设计的文章感兴趣，你可以<a class="ae kw" href="https://nesslabs.com/newsletter/" rel="noopener ugc nofollow" target="_blank">订阅我的简讯</a>。</p></div></div>    
</body>
</html>