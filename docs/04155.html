<html>
<head>
<title>Don’t Pollute Your Team Project With Bad Comments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要用不好的评论污染你的团队项目</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/dont-pollute-your-team-project-with-bad-comments-1dbe58bbed01?source=collection_archive---------25-----------------------#2020-06-11">https://levelup.gitconnected.com/dont-pollute-your-team-project-with-bad-comments-1dbe58bbed01?source=collection_archive---------25-----------------------#2020-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="9bdc" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">提高您的编程技能</h2><div class=""/><div class=""><h2 id="ed3a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">承担保持代码库整洁的责任——尤其是对于团队项目</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/164063a8f8b3a6bdc8f60e01f927fa02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Iu09bVPVRX3DTciJ"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">雷纳多·凯文在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="a86b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我们学习编码时，许多经验丰富的程序员喜欢告诉我们应该很好地记录代码。我们中的许多人遵循这个建议，在编写任何代码时都写注释。有时，当我们在几个月或几年后重访我们的代码时，我们确实发现一些注释很方便。毕竟，你知道你的评论风格是什么，你自己的评论或多或少可以提醒你自己，你做了什么。</p><p id="7d90" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然而，有一个问题—当您编写代码时，您必须首先精确地注释您的代码。有多少次你发现你的一些评论令人困惑，并且没有与代码完全一致的正确信息？通过对新程序员的适当教育和培训，我已经看到了许多项目在编写注释方面实施更严格的团队规则的趋势，总的来说，这是一件好事。</p><p id="a649" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然而，它在另一个极端引起了一个尖锐的问题。多余的教条式注释占据了整个代码库的每一个地方——太多的注释。如果您曾经参与过团队项目，您是否会发现代码很少被文档化？相反，它经常被过度记录。</p><p id="6f96" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们不应该低估代码中良好注释的必要性。例如，一些评论是关于知识产权保护的法律声明。一些评论清楚地解释了选择某些操作而不是其他看起来更常见的操作的目的。其他一些注释在文档的顶部提供了模块的高级概述。</p><p id="4fe3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以上是一些必要的和信息丰富的评论的例子，我们应该欣赏并乐于在我们的项目中写这种评论。然而，另一方面，我们应该避免写，可能永远不应该，用不必要的和误导性的评论污染你自己的或共享的代码库，我统称之为不好的评论。本文旨在讨论不良评论的种类以及如何消除它们并给出一些建议。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="4200" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">分散注意力和吵闹的评论</h2><p id="8e70" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">最重要的不良注释形式是那些多余的，它们通过简单地制造不必要的障碍来阻止我们连续阅读代码，从而导致注意力分散。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="e400" class="ml mm it nj b gy nn no l np nq">class Coordinate:<br/>    # The latitude of the coordinate<br/>    latitude = 0<br/>    # The longitude of the coordinate<br/>    longitude = 0</span><span id="938a" class="ml mm it nj b gy nr no l np nq"># the chosen user<br/>chosen_user = ...<br/># the current user<br/>current_user = ...</span></pre><p id="f9df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它们并不完全是虚构的例子。我在不止一个场合见过类似的。你觉得这些评论很让人分心吗？只需将它们与清理后的版本进行比较。我怀疑下面这段没有这些多余注释的代码会影响你对代码的理解。恰恰相反，我认为它有更好的可读性。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="e69e" class="ml mm it nj b gy nn no l np nq">class Coordinate:<br/>    latitude = 0<br/>    longitude = 0</span><span id="0573" class="ml mm it nj b gy nr no l np nq">chosen_user = ...<br/>current_user = ...</span></pre><blockquote class="ns"><p id="1c56" class="nt nu it bd nv nw nx ny nz oa ob md dk translated"><strong class="ak">提示1。</strong>删除嘈杂的注释，否则它们只会成为损害代码可读性的障碍。</p></blockquote></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="44e0" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">重复信息</h2><p id="3515" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">还有另一种形式的多余注释。当你没有写出一个好的函数，并且试图用注释来解释你的代码时，这种情况经常发生。我们来看一个微不足道的例子。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="7fb5" class="ml mm it nj b gy nn no l np nq"># Calculate the total amount that a customer needs to pay<br/># t is the initial subtotal<br/># r is the sales tax rate, by default it's 8%<br/># c is the coupon, which will take x dollars from the price<br/># Important: to use the coupon, we need to validate it<br/>def total(sub, r=0.08, c=None):<br/>    if not c:<br/>        return sub*(1+r)<br/>    else:<br/>        if validate(c):<br/>            return (sub-c)*(1+r)<br/>        else:<br/>            raise ValueError("Invalid or Expired Coupon")</span></pre><p id="1f4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面代码片段中的函数简单地计算客户需要支付的总金额，将销售税和使用的优惠券考虑在内。函数上面有几行注释。但是，大部分都是多余的。和下面的比较一下。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="ea1a" class="ml mm it nj b gy nn no l np nq"># Calculate the total amount that a custom needs to pay<br/>def calculate_total_amount(subtotal, tax_rate=0.08, coupon=None):<br/>    tax_adjusted_factor = 1+tax_rate  <br/>    if not coupon:<br/>        return subtotal*tax_adjusted_factor<br/>    else:<br/>        if check_coupon_validity(coupon):<br/>            return (subtotal-coupon)*tax_adjusted_factor<br/>        else:<br/>            raise ValueError("Invalid or Expired Coupon")</span></pre><p id="2bb2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将更新后的版本与之前的版本进行比较，有两点需要强调。</p><ul class=""><li id="8bf3" class="oc od it lk b ll lm lo lp lr oe lv of lz og md oh oi oj ok bi translated"><strong class="lk jd">我们去掉了重复的信息</strong>，它们仅仅描述了函数执行的相同操作。是违反干原则的(即不重复自己)。有些人可能认为DRY只适用于你写的代码，这是不正确的。这也适用于评论。在这种情况下，无论何时你需要改变你的函数，你也需要改变你的注释。例如，如果当地政府改变了销售税率，该怎么办？</li><li id="04b1" class="oc od it lk b ll ol lo om lr on lv oo lz op md oh oi oj ok bi translated"><strong class="lk jd">我们改变函数和相关变量的名称。</strong>这些名字更合理，因此能清楚地反映他们持有什么数据或他们做什么工作。我们并没有实质性地改变函数的操作，但是有了这些更新的名字，你会发现它更容易阅读。对于以前的版本，您可能必须回过头来强行弄清楚这些变量是什么。</li></ul><blockquote class="ns"><p id="de14" class="nt nu it bd nv nw nx ny nz oa ob md dk translated">秘诀2。修正你的代码，删除违反DRY原则的重复注释。</p></blockquote><p id="9857" class="pw-post-body-paragraph li lj it lk b ll oq kd ln lo or kg lq lr os lt lu lv ot lx ly lz ou mb mc md im bi translated">一个简单的注意事项是，如果你的函数是供外部使用的公共API，你可能想要实现更多的官方文档(例如，Python的docstrings)。正如我前面指出的，对多余注释的讨论不适用于这些合法的注释。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="78d2" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">注释掉的代码</h2><p id="248d" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">注释掉的代码也是一个严重的污染，您可以在代码库中找到它。它本身的存在并不一定是一件坏事，因为它反映了代码编写人员在他/她最终找到最佳解决方案之前可能已经仔细考虑了这个问题。因此，旧代码被注释掉了。</p><p id="6557" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是注释掉的代码就像我们在开始时讨论的令人分心的注释一样嘈杂。它损害了代码的可读性。我们必须停下来一会儿，出于好奇或其他原因，我们想读一下被注释掉的代码。难道不会浪费一方的时间，给另一方造成混乱吗？</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">注释掉的代码示例</figcaption></figure><p id="e9cf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于注释掉的代码来说，更糟糕的是不确定我们是否可以删除这些代码行。有没有可能编码者会回来激活这些线路？或者，更新的代码是最终版本，我们可以安全地删除这些注释行。无论如何，这种不确定性是适得其反的。</p><p id="7caf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们都知道诸如GitHub这样的版本控制工具已经变得非常方便，允许我们比以前更详细地跟踪变更。因此，没有什么理由可以证明我们在代码库中保留注释掉的代码是正确的。每当您完成一个带有注释掉的代码的代码块时，您应该考虑尽快删除这些行。即使你可能会容忍自己说，也许以后当我回来的时候。但是，你知道吗，很多时候，后来就意味着再也没有了？</p><blockquote class="ns"><p id="ce2f" class="nt nu it bd nv nw ox oy oz pa pb md dk translated">秘诀三。不要把注释掉的代码留在你的代码库中。</p></blockquote></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="d099" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">含糊不清的评论</h2><p id="0f15" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">含糊不清的评论是那些包含不清楚，不一致，误导，甚至错误信息的评论。它们会对代码库造成最大的破坏。我们都同意我们评论的目的是帮助我们理解代码。但是，当注释和代码出现不匹配的时候，你能相信哪一个？</p><p id="8347" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当然，我们应该更加重视代码，因为代码是我们软件的血肉。但是有没有可能注释实际上是期望的功能，而代码还没有执行工作呢？考虑下面这个微不足道的例子。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="050a" class="ml mm it nj b gy nn no l np nq"># This function check the validity of the coupon.<br/># returns 0 when we find no problems<br/>def check_coupon_validity(coupon):<br/>    # search the database<br/>    if valid_coupon:<br/>        return 1<br/>    else:<br/>        return 0</span></pre><p id="0859" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面的代码中，注释说当我们发现优惠券没有问题时，我们应该期望函数返回0。然而，代码似乎讲述了一个不同的故事。当发现优惠券有效时，该函数返回1。注释和代码哪个是正确的？我们无法知道答案，除非我们阅读其他相关函数来调查返回值是如何使用的。最后，我们最多可以<strong class="lk jd">推断</strong>注释或代码是正确的。或者，我们必须与了解数据的人交谈，然后才能确定哪个是正确的。</p><p id="56aa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，我们在编写任何注释时都应该非常谨慎，我们需要确保注释准确地描述了相关的代码，没有任何歧义。此外，要做到专业，每当我们在代码库中看到任何不清楚或不正确的注释时，就更进一步，通过解决不一致来解决问题。因为如果代码库中存在一个不好的注释，当它离问题的根源更远时，将来会引起更多的混乱。所以在最早的时间点解决它。</p><blockquote class="ns"><p id="734a" class="nt nu it bd nv nw ox oy oz pa pb md dk translated">秘诀4。不要在你的代码库中留下模糊的注释。看到了吗？解决它。</p></blockquote></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="cfb0" class="pc mm it bd mn pd pe pf mq pg ph pi mt ki pj kj mw kl pk km mz ko pl kp nc pm bi translated">结论</h1><p id="4ac8" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">注释在任何代码库中都是必要的罪恶。当我们有最少数量的好注释时，我们的代码就容易阅读和维护。然而，当我们的代码被不好的注释污染时，尤其是那些不清楚的和误导的注释，我们的生产力将会大大降低，因为我们将不得不花费大量的时间来解决这些不一致。因此，我们应该持续关注我们在代码库中写的任何注释，并考虑它们是否属于上面讨论的不好的注释类别之一。如果所有的队友都能承担这样的责任，我们的代码库将会变得强大，同时保持干净。</p></div></div>    
</body>
</html>