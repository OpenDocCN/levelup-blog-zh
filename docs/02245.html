<html>
<head>
<title>Differentiate UITextField delegate and .editingChange usage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">区分UITextField委托和。编辑更改用法</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/differentiate-uitextfield-delegate-and-editingchange-usage-c7abe7439faa?source=collection_archive---------1-----------------------#2020-02-29">https://levelup.gitconnected.com/differentiate-uitextfield-delegate-and-editingchange-usage-c7abe7439faa?source=collection_archive---------1-----------------------#2020-02-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b800d30203442f4a45e180fe91cc64e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r3Ko918KNiZCnjWf"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图片由<a class="ae kf" href="https://unsplash.com/@franckinjapan" rel="noopener ugc nofollow" target="_blank"> Franck V. </a>在<a class="ae kf" href="https://unsplash.com/photos/miWGZ02CLKI" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8c2c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在一个iOS <code class="fe le lf lg lh b">UITextField</code>中，如果我们想要控制和修改输入到其中的文本——使其成为数字文本字段(如下所示，例如没有双0，如下所示),我们有两种方法。</p><figure class="lj lk ll lm gt ju gh gi paragraph-image"><div class="gh gi li"><img src="../Images/a28a788dd5ff8e90781c9f361875f67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*zZrL8laOQNObO8r8uICMJw.gif"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">我们不仅仅使用数字键盘来演示控制输入</figcaption></figure><p id="baae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如下面的博客所分享的，有两种可能的方法</p><div class="ln lo gp gr lp lq"><a href="https://medium.com/@elye.project/making-ios-uitextfield-accept-number-only-4e9f569ae0c6" rel="noopener follow" target="_blank"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd iu gy z fp lv fr fs lw fu fw is bi translated">使iOS UITextField仅接受数字</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">并通过探索一种将输入限制为实际数字的方法来了解UITextField处理的许多方式</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jz lq"/></div></div></a></div><ol class=""><li id="100b" class="mf mg it ki b kj kk kn ko kr mh kv mi kz mj ld mk ml mm mn bi translated">指派代表<code class="fe le lf lg lh b">textField.delegate = self</code></li><li id="f7d5" class="mf mg it ki b kj mo kn mp kr mq kv mr kz ms ld mk ml mm mn bi translated">添加一个目标<code class="fe le lf lg lh b">.editingChange</code></li></ol><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="486e" class="mx my it lh b gy mz na l nb nc">textField.addTarget(<strong class="lh iu"><em class="nd">self</em></strong>, action: <strong class="lh iu">#selector</strong>(<strong class="lh iu">self</strong>.joinChange), for: .editingChanged)</span></pre><h2 id="ee80" class="mx my it bd ne nf ng dn nh ni nj dp nk kr nl nm nn kv no np nq kz nr ns nt nu bi translated">我应该在什么时候使用这些方法？</h2><p id="b159" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">为了理解这一点，让我们看看下面的图表，说明每个调用的时间。</p><figure class="lj lk ll lm gt ju gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/60ccd86cf696172a7bbf500dc3f6d7e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*7G_GcqvF4mxC_8HcLJ0oYQ.png"/></div></figure><p id="47fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当一个字母被键入时，在它与文本字段中前面的字母合并之前，它将被发送到<code class="fe le lf lg lh b">delegate</code>函数。合并之后，然后调用<code class="fe le lf lg lh b">.editingChanged</code>目标函数。</p><p id="e125" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有了上面显示的图表，我们现在对每个函数何时被调用有了一些了解。</p><h1 id="04ab" class="ob my it bd ne oc od oe nh of og oh nk oi oj ok nn ol om on nq oo op oq nt or bi translated">应用程序</h1><p id="368e" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">为了更好地理解每个用户，让我们举一个例子，用下面的规则来制作我们的textField:</p><ul class=""><li id="4faa" class="mf mg it ki b kj kk kn ko kr mh kv mi kz mj ld os ml mm mn bi translated">仅接受数字，即仅0-9</li><li id="5f15" class="mf mg it ki b kj mo kn mp kr mq kv mr kz ms ld os ml mm mn bi translated">可以是18位数以内的任意数字组合。</li><li id="8e87" class="mf mg it ki b kj mo kn mp kr mq kv mr kz ms ld os ml mm mn bi translated">对于0，可以有一个单独的数字0，但后面不能有其他数字(例如，不接受0123)。</li></ul><h2 id="ac9b" class="mx my it bd ne nf ng dn nh ni nj dp nk kr nl nm nn kv no np nq kz nr ns nt nu bi translated">使用委托方法</h2><p id="8dc7" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">当我们使用<code class="fe le lf lg lh b">delegate</code>方法时，我们的代码如下所示。</p><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="e10e" class="mx my it lh b gy mz na l nb nc">textField.delegate = self</span></pre><p id="2d74" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">委托函数如下所示。</p><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="163e" class="mx my it lh b gy mz na l nb nc">func textField(_ textField: UITextField, <br/>               shouldChangeCharactersIn range: NSRange, <br/>               replacementString string: String) -&gt; Bool {</span><span id="f145" class="mx my it lh b gy ot na l nb nc">    if (<strong class="lh iu">textField.text!.count &gt;= ViewController.maxDigit <br/>        &amp;&amp; !string.isEmpty</strong>) {<br/>        return false<br/>    }<br/>    let invalidCharacters <br/>        = CharacterSet(charactersIn: "0123456789").inverted<br/>    if (<strong class="lh iu">string.rangeOfCharacter(from: invalidCharacters) == nil</strong>) {<br/>        let <strong class="lh iu">mergedString = (textField.text! as NSString)<br/>            .replacingCharacters(in: range, with: string)</strong><br/>        if let number = Decimal(string: mergedString) {<br/>            textField.text = "\(number)"<br/>            return false<br/>        }<br/>        return true<br/>    }<br/>    return false<br/>}</span></pre><p id="d129" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用这种方法，它将:</p><ol class=""><li id="ccaa" class="mf mg it ki b kj kk kn ko kr mh kv mi kz mj ld mk ml mm mn bi translated">首先检查以确保它在允许的位数范围内。否则返回false表示我们不接受输入。在这里，它还检查新的输入字符串是否为空，因为我们希望它在enter键被退格删除的情况下继续。</li><li id="34c3" class="mf mg it ki b kj mo kn mp kr mq kv mr kz ms ld mk ml mm mn bi translated">然后，它检查以确保输入的字母是0–9。否则返回false表示不接受输入。</li><li id="7f6c" class="mf mg it ki b kj mo kn mp kr mq kv mr kz ms ld mk ml mm mn bi translated">然后，它将最新的输入与字符串合并在一起，并使其成为一个数字(这确保了<code class="fe le lf lg lh b">0</code>键与任何数字合并，然后它自己产生数字，即<code class="fe le lf lg lh b">2</code>而不是<code class="fe le lf lg lh b">02</code>)。之后，它会更改文本字段。</li></ol><figure class="lj lk ll lm gt ju gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a579c50222423e46c7cb9ff9d962612e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*_-nqbMbVQ0xnqVHMO-x2_g.png"/></div></figure><h2 id="ffe5" class="mx my it bd ne nf ng dn nh ni nj dp nk kr nl nm nn kv no np nq kz nr ns nt nu bi translated"><strong class="ak">这种方法的问题</strong></h2><p id="4ceb" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">它自己执行最新字母的合并，如果系统不合并字母，则返回false。这可能被认为是对<code class="fe le lf lg lh b">UITextField</code>流程不必要的入侵。</p><p id="0c0e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看另一种方法…</p><h2 id="0470" class="mx my it bd ne nf ng dn nh ni nj dp nk kr nl nm nn kv no np nq kz nr ns nt nu bi translated">使用添加目标<code class="fe le lf lg lh b">.editingChange</code>的方法</h2><p id="cf4a" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">当我们使用<code class="fe le lf lg lh b">.editingChange</code>方法时，我们的代码如下所示。</p><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="e7e9" class="mx my it lh b gy mz na l nb nc">textField.addTarget(<strong class="lh iu">self</strong>, action: <strong class="lh iu">#selector</strong>(<strong class="lh iu">self</strong>.editingChanged), for: .editingChanged)</span></pre><p id="2340" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">和委托函数，我们写如下</p><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="d3ac" class="mx my it lh b gy mz na l nb nc">private var lastValue = ""<br/><a class="ae kf" href="http://twitter.com/objc" rel="noopener ugc nofollow" target="_blank">@objc</a> private func editingChanged(_ textField: UITextField) {<br/>    if let number = <br/>      <strong class="lh iu">Decimal(string: textField.text!.filter { $0.isWholeNumber }</strong>) {<br/>        if (<strong class="lh iu">number &lt;= Decimal(ViewController.maxValue)</strong>) {<br/>            lastValue = "\(number)"<br/>        }<br/>        textField.text = lastValue<br/>    } else {<br/>        testField.text = ""<br/>    }<br/>}</span></pre><p id="19ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个阶段，它已经接收了整个合并的文本输入。输入可以由字母或数字组成。因此，它执行以下操作</p><ol class=""><li id="c5cd" class="mf mg it ki b kj kk kn ko kr mh kv mi kz mj ld mk ml mm mn bi translated">为了删除字母，它使用<code class="fe le lf lg lh b">Decimal(string: text.filter { $0.isWholeNumber })</code>来过滤并保留那些数字。在这个过程中，它还试图将其转换成一个数字(例如，<code class="fe le lf lg lh b">02</code>将是<code class="fe le lf lg lh b">2</code>)</li><li id="e694" class="mf mg it ki b kj mo kn mp kr mq kv mr kz ms ld mk ml mm mn bi translated">之后，进行比较以确保其不超过<code class="fe le lf lg lh b">maxValue</code>。如果它超过了最大值，那么它必须检索以前的值并设置为文本，因为在这个阶段文本已经被更改。</li></ol><figure class="lj lk ll lm gt ju gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/057ebd458eac2af48eaaaffb5dffb2d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*v8TpUQ7E3LfUMxbRekHQbg.png"/></div></figure><h2 id="cfe9" class="mx my it bd ne nf ng dn nh ni nj dp nk kr nl nm nn kv no np nq kz nr ns nt nu bi translated"><strong class="ak">这种方法的问题</strong></h2><ol class=""><li id="61d5" class="mf mg it ki b kj nv kn nw kr ov kv ow kz ox ld mk ml mm mn bi translated">它必须重新查找文本中的每个字母，并逐个过滤</li><li id="3ef2" class="mf mg it ki b kj mo kn mp kr mq kv mr kz ms ld mk ml mm mn bi translated">它必须记住以前存储的数字，如果新的数字超过限制，就将其重置。</li></ol><p id="751b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述问题的原因是他们每个人都做了他们应该做的事情。<code class="fe le lf lg lh b">delegate</code>应该只是合并前的滤波，<code class="fe le lf lg lh b">.editingChange</code>应该是合并后的变换。</p><p id="e95b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了正确使用它们，让我们看看下面的内容。</p><h1 id="7a4b" class="ob my it bd ne oc od oe nh of og oh nk oi oj ok nn ol om on nq oo op oq nt or bi translated">使用委托和<code class="fe le lf lg lh b">.editingChange</code>方法</h1><p id="61a2" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">为此，我们需要分配委托和。editing将函数更改为文本字段，如下所示</p><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="ac85" class="mx my it lh b gy mz na l nb nc">textField.delegate = self<br/>textField.addTarget(<strong class="lh iu">self</strong>, action: <strong class="lh iu">#selector</strong>(<strong class="lh iu">self</strong>.editingChanged), for: .editingChanged)</span></pre><p id="84d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在<code class="fe le lf lg lh b">delegate</code>代码中:</p><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="2814" class="mx my it lh b gy mz na l nb nc">func textField(_ textField: UITextField, <br/>               shouldChangeCharactersIn range: NSRange, <br/>               replacementString string: String) -&gt; Bool {</span><span id="051a" class="mx my it lh b gy ot na l nb nc">if (<strong class="lh iu">textField.text!.count &gt;= ViewController.maxDigit <br/>        &amp;&amp; !string.isEmpty</strong>) {<br/>        return false<br/>    }<br/>    let invalidCharacters <br/>        = CharacterSet(charactersIn: "0123456789").inverted<br/>    return (<strong class="lh iu">string.rangeOfCharacter(from: invalidCharacters) == nil</strong>) }</span></pre><p id="35ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，它只是做预合并所需的过程，即过滤掉不需要的字符或当它已经达到最大位数时阻止继续</p><p id="4cd7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在<code class="fe le lf lg lh b">.editingChange</code>代码中:</p><pre class="lj lk ll lm gt mt lh mu mv aw mw bi"><span id="f8da" class="mx my it lh b gy mz na l nb nc">private var lastValue = ""<br/><a class="ae kf" href="http://twitter.com/objc" rel="noopener ugc nofollow" target="_blank">@objc</a> private func editingChanged(_ textField: UITextField) {<br/>    <strong class="lh iu">if</strong> <strong class="lh iu">let</strong> num = Int(textField.text!) {<br/>        textField.text = "\(num)"<br/>    } <strong class="lh iu">else</strong> {<br/>        textField.text = ""<br/>    }<br/>}</span></pre><p id="2681" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只需将合并后的字母转换成数字，即处理例如<code class="fe le lf lg lh b">02</code>将成为<code class="fe le lf lg lh b">2</code>的情况</p><p id="a40f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，它不需要像在<code class="fe le lf lg lh b">delegate</code>中那样检查合法性。它也不需要担心存储要恢复的最后一个值。</p><figure class="lj lk ll lm gt ju gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/25e11578df0fa5c292df8e0a246b1ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*lkwATMQGw0Pcvrj6i_144g.png"/></div></figure></div><div class="ab cl oy oz hx pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="im in io ip iq"><p id="4bfd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以在以下位置获得上述3种方法的代码演示:</p><div class="ln lo gp gr lp lq"><a href="https://github.com/elye/demo_ios_uitextfiled_number_delegate_editingchange" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd iu gy z fp lv fr fs lw fu fw is bi translated">elye/demo _ IOs _ ui text filed _ number _ delegate _ editing change</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">显示对UITextField的数值条目正确使用委托和编辑更改…</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">github.com</p></div></div><div class="lz l"><div class="pf l mb mc md lz me jz lq"/></div></div></a></div><p id="2024" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读。你可以在这里查看我的其他话题<a class="ae kf" href="https://medium.com/@elye.project/" rel="noopener">。</a></p><p id="84e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关注我的<a class="ae kf" href="https://medium.com/@elye.project" rel="noopener"><em class="nd"/></a><em class="nd"/><a class="ae kf" href="https://twitter.com/elye_project" rel="noopener ugc nofollow" target="_blank"><em class="nd">Twitter</em></a><em class="nd"/><a class="ae kf" href="https://www.facebook.com/elyeproj/" rel="noopener ugc nofollow" target="_blank"><em class="nd">脸书</em> </a>或<a class="ae kf" href="https://www.reddit.com/user/elyeproj/" rel="noopener ugc nofollow" target="_blank"> <em class="nd"> Reddit </em> </a>获取移动开发等相关话题的小技巧和学习。~Elye~</p><figure class="lj lk ll lm gt ju"><div class="bz fp l di"><div class="pg ph l"/></div></figure></div></div>    
</body>
</html>