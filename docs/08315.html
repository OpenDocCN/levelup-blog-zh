<html>
<head>
<title>Handy Tricks in JavaScript Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript测试中的便利技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/handy-tricks-in-javascript-testing-36c119f8c208?source=collection_archive---------11-----------------------#2021-04-20">https://levelup.gitconnected.com/handy-tricks-in-javascript-testing-36c119f8c208?source=collection_archive---------11-----------------------#2021-04-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5d6036fe90a3dcedf5b10fc470355750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4KhNr_63DG3sE5Blc1dcg.png"/></div></div></figure><p id="021e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">随着JavaScript库、框架和人们学习这种语言的热潮，每当有人决定用JavaScript编写一些测试时，我都会发现一些常见的问题。以下是我在测试中需要做的一些最常见的事情，以及如何在三个主要工具上做这些事情:Jasmine、Mocha和Jest。</p><h1 id="7e24" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">运行单个测试或一组测试</h1><p id="ca35" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">场景:我正在编写测试，不想在整个项目中运行我的整个测试套件。做这件事最快的方法是什么？</p><p id="d12c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">摩卡</strong></p><p id="ab73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe lz ma mb mc b">only()</code> —</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="9bd9" class="ml kx iq mc b gy mm mn l mo mp">describe.only('This describe block will run by itself on test run'...</span><span id="0987" class="ml kx iq mc b gy mq mn l mo mp">// Or a single test</span><span id="58af" class="ml kx iq mc b gy mq mn l mo mp">it.only('This it block will run by itself on test run'...</span></pre><p id="4325" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">笑话</strong></p><p id="897a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe lz ma mb mc b">only()</code>或<code class="fe lz ma mb mc b">f</code>—“f”表示<em class="mr">焦点</em></p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="1f6a" class="ml kx iq mc b gy mm mn l mo mp">// Synonymous<br/>describe.only('Your test suite'...<br/>fdescribe('Your test suite'...</span><span id="195c" class="ml kx iq mc b gy mq mn l mo mp">// Or a single test</span><span id="3b7c" class="ml kx iq mc b gy mq mn l mo mp">// Synonymous<br/>it.only('...<br/>fit('...</span></pre><p id="73a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">茉莉</strong></p><p id="66f4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe lz ma mb mc b">fdescribe</code>或<code class="fe lz ma mb mc b">fit</code></p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="1021" class="ml kx iq mc b gy mm mn l mo mp">fdescribe('Your tests...'</span><span id="d690" class="ml kx iq mc b gy mq mn l mo mp">// Or a single test</span><span id="9b8e" class="ml kx iq mc b gy mq mn l mo mp">fit('Your single test...'</span></pre><p id="75cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mr">注意:如果你正在使用Karma，你可能会将它与上面的一个选项结合使用。他们都应该和所写的业力一起工作。</em></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="6cc8" class="kw kx iq bd ky kz mz lb lc ld na lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt bi translated">测试异步代码</h1><p id="dcac" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果你有异步代码，比如查询一个数据库或者调用一个服务器，你需要确保你的测试运行没有停顿。</p><p id="1db0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">茉莉/Jest/摩卡</strong></p><p id="0a69" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">意外的惊喜…大多数流行的JS测试框架都以同样的方式处理异步代码。</p><p id="ad7a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mr">注意:使用以下图案之一，不要在同一个测试中混搭！</em></p><p id="f50c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe lz ma mb mc b">done</code> —在异步调用返回后调用这个方法，让Mocha知道测试已经完成。</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="d5b8" class="ml kx iq mc b gy mm mn l mo mp">it('will test async code', (done) =&gt; {<br/>  myAsyncCall().then((result) =&gt; {<br/>    expect(result).toBeDefined();<br/>    done();<br/>  });<br/>});</span></pre><p id="839d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">兑现承诺</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="2b21" class="ml kx iq mc b gy mm mn l mo mp">it('will test async code', () =&gt; {<br/>  return myAsyncCall().then((result) =&gt; {<br/>    expect(result).toBeDefined();<br/>  });<br/>});</span></pre><p id="9e0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意:不要对承诺做出回应。</p><p id="7959" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用异步/等待</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="5b7a" class="ml kx iq mc b gy mm mn l mo mp">it('will test async code', async () =&gt; {<br/>  const result = await myAsyncCall();<br/>  expect(result).toBeDefined();<br/>});</span></pre><p id="9461" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">参考资料:</p><p id="4c7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">笑话:<a class="ae ne" href="https://jestjs.io/docs/asynchronous" rel="noopener ugc nofollow" target="_blank">https://jestjs.io/docs/asynchronous</a></p><p id="9a0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">摩卡:<a class="ae ne" href="https://mochajs.org/#asynchronous-code" rel="noopener ugc nofollow" target="_blank">https://mochajs.org/#asynchronous-code</a></p><p id="cbc0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">茉莉:<a class="ae ne" href="https://jasmine.github.io/tutorials/async" rel="noopener ugc nofollow" target="_blank">https://jasmine.github.io/tutorials/async</a></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="a282" class="kw kx iq bd ky kz mz lb lc ld na lf lg lh nb lj lk ll nc ln lo lp nd lr ls lt bi translated">数据驱动测试</h1><p id="f8dd" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">当您想要使用多个参数测试某些功能时，测试运行程序允许您编写一个测试，该测试将基于您传入的数据运行多次。</p><p id="0191" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">贾米内/摩卡</strong></p><p id="4e39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe lz ma mb mc b">forEach</code>或任何其他形式的普通JS循环。</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="3f41" class="ml kx iq mc b gy mm mn l mo mp">const testCases = [<br/>  {<br/>    one: 1,<br/>    two: 5,<br/>    result: 6<br/>  },<br/>  {<br/>    one: 1,<br/>    two: 5,<br/>    result: 6<br/>  },<br/>  {<br/>    one: 1,<br/>    two: 5,<br/>    result: 6<br/>  },<br/>];<br/><br/>testCases.forEach((testCase) =&gt; {<br/>  <strong class="mc ir"><em class="mr">it</em></strong>('should add two numbers', () =&gt; {<br/>    const result = add(testCase.one, testCase.two);<br/>    expect(result).toEqual(testCase.result);<br/>  });<br/>});</span></pre><p id="5c7c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">摩卡参考:<a class="ae ne" href="https://mochajs.org/#dynamically-generating-tests" rel="noopener ugc nofollow" target="_blank">https://mochajs.org/#dynamically-generating-tests</a></p><p id="81f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">笑话</strong></p><p id="8868" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Jest提供了一个<code class="fe lz ma mb mc b">test.each</code>助手，让您将数据作为参数传递给测试，并以稍微不同的方式运行它。</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="236c" class="ml kx iq mc b gy mm mn l mo mp"><strong class="mc ir"><em class="mr">test</em></strong>.each([<br/>  {<br/>    one: 1,<br/>    two: 5,<br/>    result: 6<br/>  },<br/>  {<br/>    one: 1,<br/>    two: 5,<br/>    result: 6<br/>  },<br/>  {<br/>    one: 1,<br/>    two: 5,<br/>    result: 6<br/>  },<br/>])('should add two numbers', (testCase) =&gt; {<br/>  const result = add(testCase.one, testCase.two);<br/>  expect(result).toEqual(testCase.result);<br/>});</span></pre><p id="282c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">参考:<a class="ae ne" href="https://jestjs.io/docs/api#testeachtablename-fn-timeout" rel="noopener ugc nofollow" target="_blank">https://jestjs.io/docs/api#testeachtablename-fn-timeout</a></p></div></div>    
</body>
</html>