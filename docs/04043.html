<html>
<head>
<title>How To Send An SQS Message With Node</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用节点发送SQS消息</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-send-an-sqs-message-with-node-7b0817345174?source=collection_archive---------6-----------------------#2020-06-07">https://levelup.gitconnected.com/how-to-send-an-sqs-message-with-node-7b0817345174?source=collection_archive---------6-----------------------#2020-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/91844cb578e54a49e66bfe6a9bb38f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gUqjmNACbxGhy6PaWTFYHQ.png"/></div></div></figure><div class=""/><div class=""><h2 id="122a" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">本文假设您熟悉Node和AWS。</h2></div><p id="d6eb" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">所有对发送SQS信息的特定代码的搜索要么靠不住，要么已经过时。所以这就是你需要的，简短而甜蜜。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="365c" class="ly lz je lu b gy ma mb l mc md">import AWS from 'aws-sdk'<br/>AWS.config.<strong class="lu jf">update</strong>({region: 'us-east-1'})<br/>const SQS = new AWS.SQS({apiVersion: '2012-11-05'})<br/><br/><br/>const <strong class="lu jf">sendSQS </strong>= (params1, param2) =&gt; {</span><span id="e200" class="ly lz je lu b gy me mb l mc md">  const params = {<br/>    MessageBody: JSON.<strong class="lu jf">stringify</strong>({ param1, param2 }),<br/>    QueueUrl: &lt;<em class="mf">QUEUE_URL</em>&gt;,<br/>    MessageAttributes: {<br/>      SomeAttr: {<br/>        DataType: 'String',<br/>        StringValue: 'cool beans'<br/>      },<br/>      OtherAttr: {<br/>        DataType: 'String',<br/>        StringValue: 'hey there good lookin'<br/>      }<br/>    }<br/>  }<br/><em class="mf"><br/>  </em>SQS.sendMessage(params, (err,result) =&gt; {<br/>    if (err) {<br/>      console.log(err)<br/>      return<br/>    }<br/>    console.log(result)<br/>  })</span><span id="718f" class="ly lz je lu b gy me mb l mc md">}</span></pre><p id="891f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">你可以完全不考虑<strong class="kv jf">消息属性</strong>。但是如果你想要它们，上面的格式不是可选的。您必须为每个属性指定<strong class="kv jf">数据类型</strong>和<strong class="kv jf">字符串值</strong>。</p><p id="d5a0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于FIFO队列，您必须指定一个<strong class="kv jf"> MessageGroupId </strong>属性。这允许消息被分组到队列的不同部分，比方说100条消息从</p><p id="b673" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">同样对于FIFO队列，<a class="ae mg" href="https://medium.com/@PhilipAndrews/how-to-create-an-aws-sqs-queue-with-serverless-2a538fe2413a" rel="noopener">队列</a>必须设置<strong class="kv jf">ContentBasedDeduplication</strong>或者必须在params对象上设置<strong class="kv jf"> MessageDeduplicationId </strong>。</p><blockquote class="mh mi mj"><p id="481b" class="kt ku mf kv b kw kx kf ky kz la ki lb mk ld le lf ml lh li lj mm ll lm ln lo im bi translated"><strong class="kv jf">ContentBasedDeduplication</strong>:当<code class="fe mn mo mp lu b">ContentBasedDeduplication</code>生效时，在重复数据删除间隔内发送的内容相同的消息被视为重复消息，只发送一份消息</p><p id="627e" class="kt ku mf kv b kw kx kf ky kz la ki lb mk ld le lf ml lh li lj mm ll lm ln lo im bi translated"><strong class="kv jf"> MessageDeduplicationId </strong>:用于已发送消息去重的令牌。如果带有特定<code class="fe mn mo mp lu b">MessageDeduplicationId</code>的消息发送成功，则带有相同<code class="fe mn mo mp lu b">MessageDeduplicationId</code>的任何消息都会被成功接受，但不会在5分钟的重复数据删除间隔内发送。</p></blockquote><p id="a694" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><a class="ae mg" href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_SendMessage.html" rel="noopener ugc nofollow" target="_blank"> AWS属性文档</a></p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="ac38" class="mx lz je bd my mz na nb nc nd ne nf ng kk nh kl ni kn nj ko nk kq nl kr nm nn bi translated">开发无服务器时，希望恢复您的控制台日志吗？签出树枝…</h1><figure class="lp lq lr ls gt iv gh gi paragraph-image"><a href="https://www.twig.im/"><div class="gh gi no"><img src="../Images/36a4b9f9e789e19a238bbaa9a45b7975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zOVO7JmICUotRiX95LCOKA.jpeg"/></div></a></figure></div></div>    
</body>
</html>