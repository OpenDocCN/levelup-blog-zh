<html>
<head>
<title>Build a Responsive Animated Header with React and GSAP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React和GSAP创建一个响应动画标题</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-a-responsive-animated-header-with-react-and-gsap-b154e0a26100?source=collection_archive---------4-----------------------#2020-04-30">https://levelup.gitconnected.com/build-a-responsive-animated-header-with-react-and-gsap-b154e0a26100?source=collection_archive---------4-----------------------#2020-04-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6e0ca9fe0e3083ebd9d37fd3580e927d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZOkkJZuJAizIGUal5FhcA.jpeg"/></div></div></figure><p id="03c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我最近设计的一个项目中，我计划了一个简单的标题。对于桌面屏幕，设计要求在左边有一个标志，导航居中。在手机屏幕上，这个设计要求在左边有一个标志，在右边有一个汉堡图标，并且在激活时有完整的覆盖导航。设计如下:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/91f7ef3877a1f3c18c18c8240affaa59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OU-PdVsPXaffn-53D6l6zg.jpeg"/></div></div></figure><p id="901e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如您所见，这不是一个过于复杂的设计。然而，我希望手机导航上的动画比简单的淡入或滑入更有趣。为此，我决定使用GSAP建立一个时间线，将动画的元素都在和。</p><p id="fa2f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在继续之前有一个小提示，我在本教程中使用了CodeSandbox，可以在这里找到<a class="ae la" href="https://codesandbox.io/s/responsive-react-header-with-animated-navigation-6123i" rel="noopener ugc nofollow" target="_blank"/>。我尽最大努力复制我的正常项目结构，这意味着我使用CSS模块、一些SCSS、CSS自定义属性和我习惯的项目结构。虽然本教程不是关于这些事情，但我会尽力指出一些事情。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="4108" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">在我看来</h1><p id="b920" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">当我看着这个设计(我知道，我设计了它，但我仍然会以同样的方式来看待它)，我看到了一个父组件——标题——和一些子组件——徽标、汉堡、导航。</p><p id="09e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然这是一个简单的设计，但它也是非常标准的，所以我会以一种我可以在其他项目中重用它的方式来构建它。这意味着我将拥有一个包含索引文件的标题文件夹——我们的<code class="fe ml mm mn mo b">Header</code>组件——然后其他组件也将在该文件夹中。这样我可以很容易地将它打包并在其他项目中实现。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="d047" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第一步:组件和样式</h1><p id="361a" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我喜欢做的第一件事是构建每个组件的结构并设计它们的样式。让我们首先构建<code class="fe ml mm mn mo b">Header</code>组件。最终，这是我们所有的状态、函数等存在的地方，但是现在，它只是标记和一些类。</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/85ad1a6e3e730a85839f07ca8b4dccd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*plQm55DMdtI2vaVDIwn6DQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">标题标记</figcaption></figure><ul class=""><li id="6695" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">如果你不熟悉CSS模块，你可能想知道类名是怎么回事。CSS模块是这样工作的:你导入一个文件到一个组件中(随便你给它起什么名字，我选择了<code class="fe ml mm mn mo b">s</code>，然后把这些名字放到你的组件中需要的地方。</li><li id="ad11" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">您可以使用通用名称，坚持BEM架构，或者任何您喜欢的名称。我个人倾向于BEM风格，因为我喜欢嵌套在我的<code class="fe ml mm mn mo b">scss</code>文件中以及它的样子。</li></ul><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/f1edab9a0eb03e148af671a3d01c8f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8rWAxaqhkACPYyC3cJl5QA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">标题SCSS</figcaption></figure><ul class=""><li id="5bb5" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">这里没发生什么疯狂的事。我会注意到我正在导入我的<code class="fe ml mm mn mo b">config.scss</code>文件，所以我可以使用我的mixins和变量。</li></ul><p id="5ee3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，让我们构建<code class="fe ml mm mn mo b">HeaderLogo</code>组件。我为我构建的站点上的几乎所有徽标使用SVG，所以我最终会将一个SVG传递给这个组件来呈现:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/be939c4e902d681f3428d72904427bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uP9odhpOdAr7hVBTsLrSeQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">HeaderLogo标记</figcaption></figure><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/0b9fd157ebd5d564ef7d1dc7b2f4710d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJUeJ1ZNPXDa5wbVNjEnkA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">海德洛戈SCSS</figcaption></figure><p id="18bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来是<code class="fe ml mm mn mo b">HeaderNav</code>组件。现在，让我们在那里硬编码一些链接，这样我们就可以得到正确的样式。最后，我们将把项目传递给这个组件，并动态地呈现它们:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/2c686b6118ced182f9fa259bdd25d797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C82UWczC7ublJQMJ2HkhKw.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">HeaderNav标记</figcaption></figure><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/fe957141f49860456167c0f199511437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xz-Kwko52UN23FKdsPMzQQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">海德纳夫·SCSS</figcaption></figure><p id="87d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来是<code class="fe ml mm mn mo b">HeaderBurger</code>组件。我们将使用HTML和CSS来构建它:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/dc3ea408c3da07cd875ca9bc175ba4f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H6OLCzuA8OrbsrHvahRzXQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">标题标记</figcaption></figure><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/885d8c6f4c9ac1ef8a2e5e28c72cc95c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rLjBh0yl9IcoCIbPMYoJ0g.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">海德伯格·SCSS</figcaption></figure><ul class=""><li id="8dc9" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">最终，当导航打开时，我们将把它从一个标准的三行汉堡图标变成一个“X”。为此，我们最终将向我们的<code class="fe ml mm mn mo b">burger</code>元素添加一个open类。</li><li id="d88f" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">正如你所看到的，我已经添加了CSS，当我们这样做的时候，它会适当的动画化。</li></ul><p id="a453" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">既然已经处理好了，让我们开始添加功能。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="add0" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第二步:初始功能</h1><p id="76f5" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我们知道我们需要的两样东西是导航项目和徽标。因为这只是一个教程，所以我用我们将传递给<code class="fe ml mm mn mo b">HeaderNav</code>组件的导航项设置了一个数组。您会注意到的另一件事是，我将SVG徽标作为React组件导入，然后将其传递给<code class="fe ml mm mn mo b">ReactLogo</code>组件:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/f3e4b14261a487152fcd25aa0c91238e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kR5RnuXBI_gUCA4H5JaItg.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">App.js</figcaption></figure><p id="2aa6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们来看看<code class="fe ml mm mn mo b">Header</code>组件。我们需要做的第一件事是导入子组件，并将数据放到它应该去的地方。一旦我们设置好，我们将在<code class="fe ml mm mn mo b">HeaderNav</code>组件中映射我们的导航项目:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/28d2e57c19620a20a1eda64952a5546f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XoaJKCZEsm-HUL9PT7XrfA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">带有所有子组件的标题组件</figcaption></figure><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/276b76b5dc7dc8e6f895c89e107ccbc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SoVWoGiTsZiCRPe9y6baew.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">带有导航项目的HeaderNav组件</figcaption></figure><p id="83f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，我们能够通过<code class="fe ml mm mn mo b">Header</code>组件将数据向下传递到正确的子组件。现在，我们需要开始构建功能，让我们能够动画。</p><h1 id="9768" class="li lj iq bd lk ll ni ln lo lp nj lr ls lt nk lv lw lx nl lz ma mb nm md me mf bi translated">第三步:制作汉堡动画</h1><p id="b280" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">首先，我们需要使用钩子<code class="fe ml mm mn mo b">useState</code>设置一些状态。然后我们需要创建一个可以调用<code class="fe ml mm mn mo b">onClick</code>的函数来切换状态。一旦这些就绪，我们将需要将<code class="fe ml mm mn mo b">isMenuOpen</code>状态传递给<code class="fe ml mm mn mo b">HeaderNav</code>和<code class="fe ml mm mn mo b">HeaderBurger</code>组件，并将<code class="fe ml mm mn mo b">toggleNav</code>功能传递给<code class="fe ml mm mn mo b">HeaderBurger</code>。在<code class="fe ml mm mn mo b">Header</code>组件内部:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/c6199c397f33ca67dab2127464c39c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19qJ3oiXLauG1PRmotwaYQ.png"/></div></div></figure><ul class=""><li id="ef6e" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">我们用<code class="fe ml mm mn mo b">useState</code>设置初始状态。如果你不熟悉<code class="fe ml mm mn mo b">useState</code>，那么<strong class="ka ir">第一个元素</strong>是<strong class="ka ir">状态值</strong>，它将被设置为<code class="fe ml mm mn mo b">false</code>，而<strong class="ka ir">第二个元素</strong>是它的<strong class="ka ir">更新函数</strong>。</li><li id="4209" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">我们的<code class="fe ml mm mn mo b">toggleNav</code>函数将简单地切换我们的<code class="fe ml mm mn mo b">isMenuOpen</code>状态。</li><li id="feb1" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">在我们的<code class="fe ml mm mn mo b">HeaderNav</code>和<code class="fe ml mm mn mo b">HeaderBurger</code>组件中，我们将使用<code class="fe ml mm mn mo b">isMenuOpen</code>状态来添加或删除类<code class="fe ml mm mn mo b">open</code>。对于我们的<code class="fe ml mm mn mo b">HeaderNav</code>组件，该类只是切换指针事件。对于我们的<code class="fe ml mm mn mo b">HeaderBurger</code>，该类将在<code class="fe ml mm mn mo b">.burger__lines</code>上启动一个转换来创建一个<code class="fe ml mm mn mo b">close</code>图标。</li></ul><p id="38f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这一点上，我们有一些状态和一个函数，每次它被调用时切换状态。您的菜单图标应该如下所示:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/6d286afcf1d2bdeb3380270e00b3ae5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/1*BqQMKWE67f-yGoOFjUWPTA.gif"/></div></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="4e43" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第四步:制作导航动画</h1><p id="9dc0" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我要做的动画是一个简单的<code class="fe ml mm mn mo b">nav</code>元素的淡入淡出，然后是导航项目的交错淡入淡出。为了做到这一点，我们需要为这些元素设置一些<code class="fe ml mm mn mo b">refs</code>。在<code class="fe ml mm mn mo b">Header</code>组件内部:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/c4516faba81c55dcb0f9be8c5eba4855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L4sANrCJCSbJCynFVPlDQg.png"/></div></div></figure><ul class=""><li id="913f" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">对于<code class="fe ml mm mn mo b">navRef</code>，我们将使用<code class="fe ml mm mn mo b">useRef</code>钩子并将其传递给<code class="fe ml mm mn mo b">HeaderNav</code>。为了做到这一点，我们需要重构组件，这样我们就可以适当地转发<code class="fe ml mm mn mo b">ref</code>。我们一会儿就来看看。</li><li id="3e16" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">为了创建nav项的ref，我们将创建一个名为<code class="fe ml mm mn mo b">navItems</code>的新状态，方法是通过映射这些项，扩展我们已经有的内容，然后使用<code class="fe ml mm mn mo b">createRef</code>添加一个<code class="fe ml mm mn mo b">ref</code>。</li><li id="0344" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">首先，我们在这里使用<code class="fe ml mm mn mo b">createRef</code>是因为我们不能在地图内部调用钩子。</li><li id="bc5b" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">第二，我们现在为每个物品设置了自己的<code class="fe ml mm mn mo b">ref</code>,这样我们就可以在动画中错开它们。</li><li id="8c23" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">我们还必须将我们新创建的状态<code class="fe ml mm mn mo b">navItems</code>传递给<code class="fe ml mm mn mo b">HeaderNav</code>。</li></ul><p id="263b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们来看看<code class="fe ml mm mn mo b">HeaderNav</code>:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/e28c7ac3870df7b59d420dee6424c1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fi9MtmTqtfZfnofWRkCNgA.png"/></div></div></figure><ul class=""><li id="8c58" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">为了将<code class="fe ml mm mn mo b">ref</code>传递给子组件，我们需要用<code class="fe ml mm mn mo b">React.forwardRef</code>包装之前的组件。这需要两个论据。在我们的例子中，我们利用ES6并析构<code class="fe ml mm mn mo b">props</code>和传递<code class="fe ml mm mn mo b">ref</code>。</li><li id="9673" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">接下来，我们需要给每个<code class="fe ml mm mn mo b">item</code>添加一个引用。</li></ul><p id="5683" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们已经设置了refs，我们需要设置我们的时间表。为此，我们首先将<code class="fe ml mm mn mo b">gsap</code>导入到我们的<code class="fe ml mm mn mo b">Header</code>组件中。接下来，我们需要在我们的<code class="fe ml mm mn mo b">Header</code>中初始化一个时间线:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/2ecadac4a30b852b8b0f843310cf5f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oyCS1umrLAB5SIjGnDCXcA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">GSAP时间表</figcaption></figure><ul class=""><li id="e29c" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">我们在这里所做的就是使用<code class="fe ml mm mn mo b">useState</code>建立一个GSAP时间轴。</li><li id="0a5f" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">重要的部分是我们传递到时间线中的选项。</li><li id="2c74" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">首先，我们告诉时间轴从暂停状态开始。</li><li id="3ac2" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">第二，我们传递一些默认参数，这样我们就不必每次都重新输入它们。如果你知道你会一遍又一遍地使用某些值，这是非常好的。这些也可以在你需要的时候被覆盖。</li></ul><p id="2a2a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ml mm mn mo b">Refs</code>被设定。时间线被启动。现在让我们建立时间线。再次，在<code class="fe ml mm mn mo b">Header</code>里面:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/f641d43d8ef5e3cf1fc4300a2da61058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wYoxbv8AFp_QE2ZY4e65w.png"/></div></div></figure><ul class=""><li id="bc00" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">这里，我们将在<code class="fe ml mm mn mo b">useEffect</code>钩子内部构建时间轴。如果你不熟悉的话，它基本上是所有生命周期方法的集合。</li><li id="305b" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">此时，忽略关于调整事件大小的注释。我们很快会谈到这一点，但是现在，让我们传递一个空数组作为<code class="fe ml mm mn mo b">useEffect</code>的第二个参数。这只是告诉React在组件挂载时运行一次。</li><li id="0008" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">首先，让我们创建一个仅包含<code class="fe ml mm mn mo b">navItems refs</code>的数组。这非常简单，只是不要忘记添加<code class="fe ml mm mn mo b">.current</code>。我总是忘记！</li><li id="e61c" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">接下来，我们开始将时间线事件链接在一起。记住，我们已经为这个时间线设置了默认的<code class="fe ml mm mn mo b">duration</code>和<code class="fe ml mm mn mo b">ease</code>，所以我们不必担心这些，除非我们想覆盖它们。最后，我们立即反转时间线。</li><li id="c96f" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">我们要做的下一件事是设置一种方法来以正确的方向(向内或向外)播放动画。再次使用<code class="fe ml mm mn mo b">useEffect</code>。这一次，我们将把<code class="fe ml mm mn mo b">isMenuOpen</code>状态作为第二个参数传入。这将告诉React在状态改变时运行代码。</li><li id="f1a9" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">这句台词<code class="fe ml mm mn mo b">menuTL.reversed(!isMenuOpen)</code>等于说:</li></ul><pre class="kw kx ky kz gt no mo np nq aw nr bi"><span id="2d2f" class="ns lj iq mo b gy nt nu l nv nw">if (tl.reversed()) {<br/>    tl.play();<br/>} else {<br/>    tl.reverse();<br/>}</span></pre><p id="ad01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，您应该有一个如下所示的动画:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/0055ef69b01bebf508df70c39bfb917e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/1*qMb61odu6_hgtWV81po8Ag.gif"/></div></figure><p id="fdd9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，您可能注意到桌面上的导航不再可见。这是因为无论屏幕大小如何，我们都是在组件安装时设置时间线。这意味着我们将0的不透明度应用到<code class="fe ml mm mn mo b">nav</code>和<code class="fe ml mm mn mo b">nav__items</code>。因此，让我们把时间线值设置为仅当我们在移动设备上时应用。当我们在那里时，我们也将考虑调整大小事件。</p><p id="59e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了检查屏幕大小，让我们构建一个自定义钩子。听起来很有趣。在我们的<code class="fe ml mm mn mo b">hooks</code>文件夹中，让我们创建一个<code class="fe ml mm mn mo b">index.js</code>文件和一个<code class="fe ml mm mn mo b">useMediaQuery.js</code>文件。我们可能不需要这样设置，因为我们只有一个钩子，但是我喜欢我所有的钩子都在它们自己的文件中。在我们的<code class="fe ml mm mn mo b">useMediaQuery.js</code>文件中:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/97b0ae66dd232f28587d487d738b3a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z59AolYOI_1VKy5Z14ZopA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">使用MediaQuery挂钩</figcaption></figure><ul class=""><li id="d2fb" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">在我们的钩子内部，我们使用了<code class="fe ml mm mn mo b">windows</code>T5方法。该方法接受任何传统的CSS媒体查询作为参数。</li><li id="78ca" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">如果你不熟悉<code class="fe ml mm mn mo b">useEffect</code>，这里需要注意的另一件事是内部的<code class="fe ml mm mn mo b">return</code>。一旦组件被卸载，这是我们清理任何需要的东西的一种方法。在我们的例子中，我们正在删除侦听器。</li></ul><p id="fe3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们将这个挂钩导入到我们的<code class="fe ml mm mn mo b">Header</code>组件中，并在构建时间轴的地方重构代码:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/b3b0402ab276504bd513010cfe816b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68L5Au1UMEMTPXy2xjrhjg.png"/></div></div></figure><ul class=""><li id="403f" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">首先，我们需要调用新的<code class="fe ml mm mn mo b">useMediaQuery</code>钩子，并向它传递我们想要观看的媒体查询。</li><li id="95c2" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">接下来，我们将告诉<code class="fe ml mm mn mo b">useEffect</code>注意<code class="fe ml mm mn mo b">isSmallScreen</code>的任何变化。如果是，它将重新运行代码。</li><li id="beb9" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">接下来，如果<code class="fe ml mm mn mo b">isSmallScreen</code>为真，我们将使用一个简单的if语句来构建时间轴。如果它是假的，我们将告诉<code class="fe ml mm mn mo b">menuTL</code>回到开始，清除所有补间，然后将其设置为暂停。</li><li id="d16f" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">最后，我们需要确保我们清理了任何可能已经通过<code class="fe ml mm mn mo b">menuTL</code>设置的内联样式。这将有助于如果有任何调整事件正在进行。我们将利用<code class="fe ml mm mn mo b">set</code>方法，传入<code class="fe ml mm mn mo b">navRef</code>和<code class="fe ml mm mn mo b">itemsRefs</code>，并使用<code class="fe ml mm mn mo b">clearProps</code>来清理这些内联样式。</li></ul><p id="a2c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，导航应该有相应的响应和动画。如果这是一个有真实页面的真实网站，你会想把<code class="fe ml mm mn mo b">toggleNav</code>函数传递给每个导航项。这样，导航在页面切换时也会显示动画。</p><p id="2ac2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然这对于我正在进行的项目来说已经足够了，但是我想让它变得更加便携。为了做到这一点，我们需要允许更多的参数，更新一些CSS，并重构一些代码。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="1409" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第五步:让它更便携</h1><p id="fc73" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我在想我们应该设置一个叫做<code class="fe ml mm mn mo b">navPosition</code>的道具，接受三个选择中的一个:<code class="fe ml mm mn mo b">right</code>、<code class="fe ml mm mn mo b">center</code>或者<code class="fe ml mm mn mo b">overlay</code>。这些选项仅适用于桌面及更高版本。<code class="fe ml mm mn mo b">Center</code>将它保持在当前的位置(这将是我们的默认设置)，<code class="fe ml mm mn mo b">right</code>将导航推到右边，<code class="fe ml mm mn mo b">overlay</code>将保持它是一个完整的覆盖菜单。</p><p id="c833" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们安装并导入<code class="fe ml mm mn mo b">PropTypes</code>到我们的<code class="fe ml mm mn mo b">Header</code>组件中。这将允许我们设置一些关于传递给组件的道具的参数。就在我们的<code class="fe ml mm mn mo b">export</code>之后:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/30fc778436a1e8947a6d63c20260dd2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4UgvLDdAkPPriKlZnqL4Wg.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">添加一些PropTypes</figcaption></figure><ul class=""><li id="1890" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">这里我们说<code class="fe ml mm mn mo b">items</code>属性是必需的并且必须是一个数组，<code class="fe ml mm mn mo b">logo</code>属性是必需的并且必须是一个有效的React元素，<code class="fe ml mm mn mo b">navPosition</code>属性只能是三个属性中的一个——中心、右侧、覆盖。</li><li id="b94e" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">我们还为<code class="fe ml mm mn mo b">navPosition</code>元素设置了一个默认值“中心”。</li></ul><p id="3b0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了这些，我们可以开始进一步建设。让我们首先进行必要的CSS修改。为此，我们将在<code class="fe ml mm mn mo b">header__wrapper</code>上添加一个<code class="fe ml mm mn mo b">data-nav-position</code>属性，并将其值设置为<code class="fe ml mm mn mo b">navPosition</code>:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/a710fb40a9cf2fe40ea47f260b47c73a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLwSVEkyvTerJwfVHtzJmg.png"/></div></div></figure><p id="3c50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们可以将CSS中的特定数据值作为目标:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/5dcb3ddcb19de7f76a120c1e1f5a339a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jz1P65WTqZ14gg_QGyAzQw.png"/></div></div></figure><ul class=""><li id="f934" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">这里没什么特别的。我们只是针对特定的<code class="fe ml mm mn mo b">data-nav-position</code>值，并相应地设计它们的样式。</li><li id="5adc" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">需要注意的一点是，我们将<code class="fe ml mm mn mo b">backdrop-filter</code>移到了<code class="fe ml mm mn mo b">@supports</code>规则中。还不是每个浏览器都接受这一点，所以我们需要把它当作一个渐进的增强。</li><li id="22b6" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">我们需要做的最后一个CSS修改是对<code class="fe ml mm mn mo b">HeaderBurger</code>组件的修改。如果<code class="fe ml mm mn mo b">navPosition</code>是<code class="fe ml mm mn mo b">right</code>或<code class="fe ml mm mn mo b">center</code>，我们只需要告诉汉堡藏在<code class="fe ml mm mn mo b">desktop</code>上。</li></ul><p id="6c50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">既然我们的样式已经设置好了，我们需要做的最后一件事就是根据<code class="fe ml mm mn mo b">navPosition</code>值为时间轴添加一些逻辑。在我们的<code class="fe ml mm mn mo b">Header</code>组件内部:</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/e230824904c4db9fe1cfaae05797be64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IfhUucFGjwmxIbhYOPHqgg.png"/></div></div></figure><ul class=""><li id="764e" class="mu mv iq ka b kb kc kf kg kj mw kn mx kr my kv mz na nb nc bi translated">在我们已经有的<code class="fe ml mm mn mo b">useEffect</code>内部，我们只需要检查<code class="fe ml mm mn mo b">navPosition</code>是否等于右或左。如果是，我们可以运行代码。</li><li id="b6b3" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">接下来，我们需要再次使用<code class="fe ml mm mn mo b">useEffect</code>钩子，这次检查<code class="fe ml mm mn mo b">navPosition</code>是否等于overlay。如果是真的，我们将只设置时间线，就是这样。</li><li id="ef2c" class="mu mv iq ka b kb nd kf ne kj nf kn ng kr nh kv mz na nb nc bi translated">你可能会问为什么不先运行<code class="fe ml mm mn mo b">navPosition</code>检查，如果是真的话再运行<code class="fe ml mm mn mo b">useEffect</code>钩子。我也是这么想的，但是钩子的一个规则是永远不要有条件地渲染一个钩子。相反，在钩子内部运行条件。</li></ul></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="6232" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">就是这样！</h1><p id="b17d" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">我们现在有一个完全响应的标题，在移动设备上有动画导航。我们还可以将一些值传递到组件中，以改变桌面屏幕上的导航位置。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="fadd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望你在这个过程中学到了一些东西，这篇文章将成为你下一个项目的资源/灵感。</p></div></div>    
</body>
</html>