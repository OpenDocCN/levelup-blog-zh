<html>
<head>
<title>Full-text operators and basic search</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">全文运算符和基本搜索</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/full-text-operators-and-basic-search-4a07f386b0fb?source=collection_archive---------22-----------------------#2020-10-05">https://levelup.gitconnected.com/full-text-operators-and-basic-search-4a07f386b0fb?source=collection_archive---------22-----------------------#2020-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d890" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">权威指南</h2><div class=""/><div class=""><h2 id="6df9" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">在本教程中，我们将探索蝎狮搜索中可用的全文搜索操作符。</h2></div><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/ec57eb1c5e96435602806c98575c3dc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BU6JYmscG73qezi08eEVTA.jpeg"/></div></div></figure><h1 id="18d8" class="lb lc iq bd ld le lf lg lh li lj lk ll kf lm kg ln ki lo kj lp kl lq km lr ls bi translated">全文运算符和基本搜索简介</h1><p id="0ea5" class="pw-post-body-paragraph lt lu iq lv b lw lx ka ly lz ma kd mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">蝎狮搜索中的所有搜索操作都基于标准布尔运算符(AND、OR、NOT ),这些运算符可以组合使用，也可以按任意顺序组合或排除搜索中的关键字，以获得更相关的结果。</p><p id="25d7" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">默认且最简单的全文运算符是and，这是在搜索中仅枚举几个单词时假定的。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/3f188266d0a2c904a4ad108e68e03dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/0*FRpVUGO8vzwGXaQX"/></div></figure><p id="2a52" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated"><strong class="lv ja">和</strong>是一个默认操作符，使用该操作符，<strong class="lv ja">‘fast slow’</strong>查询将返回同时包含术语‘fast’和‘slow’的文档。如果一个术语在文档中，而另一个不在，则该文档不会包含在结果列表中。默认情况下，将在所有可用的全文字段中搜索单词。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="1e0b" class="na lc iq mw b gy nb nc l nd ne">SELECT * FROM testrt WHERE MATCH('fast slow');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/757a04b160f20893c7d0740e3a4805b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/0*YPnJw5e1ltnuz8r1"/></div></figure><p id="f34f" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated"><strong class="lv ja">或</strong>用于匹配任何术语(或两者都匹配)。术语之间用竖线隔开，例如<strong class="lv ja">‘快|慢’</strong>。它将查找带有“快”或“慢”的文档。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="1768" class="na lc iq mw b gy nb nc l nd ne">SELECT * FROM testrt WHERE MATCH('fast | slow');</span></pre><p id="b527" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">he OR运算符的优先级高于AND，因此查询<strong class="lv ja">‘find me fast | slow’</strong>可以解释为‘find me(fast | slow)’:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="ca22" class="na lc iq mw b gy nb nc l nd ne">SELECT * FROM testrt WHERE MATCH('find me fast | slow');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/20e404d583e8920d282c5737ed4df90e.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/0*GhbOV9qxldknCxYa"/></div></figure><p id="4e8f" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated"><strong class="lv ja"> NOT </strong>确定标有“-”或“！”的术语不在结果里。任何包含此类术语的文档都将被排除在外。例如<strong class="lv ja">‘快！“慢速”</strong>将查找带有“快速”的文档，只要其中没有“慢速”即可。使用它时要小心，尽量减少搜索，因为它可能会变得过于具体，可能会排除好的文档。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="e0c6" class="na lc iq mw b gy nb nc l nd ne">SELECT * FROM testrt WHERE MATCH('find !slow');<br/>SELECT * FROM testrt WHERE MATCH('find -slow');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/019b66789fae00b469d1f93351a9824f.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/0*rSV-Ha96U3PsapR7"/></div></figure><p id="d84b" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated"><strong class="lv ja">也许</strong>是一个特殊的操作符，它的工作方式类似于‘OR’，但是要求左边的项总是出现在结果中，而右边的项是可选的。但是当两者都满足时，文档将获得更高的搜索等级。例如<strong class="lv ja">‘fast MAYBE slow’</strong>将查找带有‘fast’或‘slow’的文档，但是包括这两个术语的文档将具有更高的分数。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="f234" class="na lc iq mw b gy nb nc l nd ne">SELECT * FROM testrt WHERE MATCH('find MAYBE slow');</span></pre><h1 id="0902" class="lb lc iq bd ld le lf lg lh li lj lk ll kf lm kg ln ki lo kj lp kl lq km lr ls bi translated">用法示例</h1><p id="5715" class="pw-post-body-paragraph lt lu iq lv b lw lx ka ly lz ma kd mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">让我们使用mysql客户端连接到蝎狮:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="abc5" class="na lc iq mw b gy nb nc l nd ne"># mysql -P9306 -h0</span></pre><p id="af12" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">对于布尔搜索，可以使用OR ( '| '):</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="a1dd" class="na lc iq mw b gy nb nc l nd ne">MySQL [(none)]&gt; select * from testrt where match('find | me fast');<br/>+------+------+------------------------+----------------+<br/>| id   | gid  | title                  | content        |<br/>+------+------+------------------------+----------------+<br/>|    1 |    1 | find me                |  fast and quick|<br/>|    2 |    1 | find me fast           |  quick         |<br/>|    6 |    1 | find me fast now       |  quick         |<br/>|    5 |    1 | find me quick and fast |  quick         |<br/>+------+------+------------------------+----------------+<br/>4 rows in set (0.00 sec)</span></pre><p id="a847" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">OR运算符具有比AND更高的优先级，查询“find me fast|slow”被解释为“find me (fast|slow)”。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="f5b4" class="na lc iq mw b gy nb nc l nd ne">MySQL [(none)]&gt; SELECT * FROM testrt WHERE MATCH('find me fast|slow');<br/>+------+------+------------------------+----------------+<br/>| id   | gid  | title                  | content        |<br/>+------+------+------------------------+----------------+<br/>|    1 |    1 | find me                |  fast and quick|<br/>|    2 |    1 | find me fast           |  quick         |<br/>|    6 |    1 | find me fast now       |  quick         |<br/>|    3 |    1 | find me slow           |  quick         |<br/>|    5 |    1 | find me quick and fast |  quick         |<br/>+------+------+------------------------+----------------+<br/>5 rows in set (0.00 sec)</span></pre><p id="7cd9" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">对于求反，运算符NOT可以指定为“-”或“！”：</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="99f8" class="na lc iq mw b gy nb nc l nd ne">MySQL [(none)]&gt; select * from testrt where match('find me -fast');<br/>+------+------+--------------+---------+<br/>| id   | gid  | title        | content |<br/>+------+------+--------------+---------+<br/>|    3 |    1 | find me slow |  quick  |<br/>+------+------+--------------+---------+<br/>1 row in set (0.00 sec)</span></pre><p id="e186" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">必须注意的是，默认情况下，蝎狮不支持完全否定查询，并且不可能只运行'-fast '(从3.5.2版开始将成为可能)。</p><p id="31bc" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">另一个基本运算符是MAYBE。这个由MAYBE定义的术语在文档中可能存在也可能不存在。如果它存在，它将影响排名，拥有它的文档将排名更高。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="8ddb" class="na lc iq mw b gy nb nc l nd ne">MySQL [(none)]&gt; select * from testrt where match('find me MAYBE slow');<br/>+------+------+------------------------+----------------+<br/>| id   | gid  | title                  | content        |<br/>+------+------+------------------------+----------------+<br/>|    3 |    1 | find me slow           |  quick         |<br/>|    1 |    1 | find me                |  fast and quick|<br/>|    2 |    1 | find me fast           |  quick         |<br/>|    5 |    1 | find me quick and fast |  quick         |<br/>|    6 |    1 | find me fast now       |  quick         |<br/>+------+------+------------------------+----------------+<br/>5 rows in set (0.00 sec)</span></pre><h1 id="24f6" class="lb lc iq bd ld le lf lg lh li lj lk ll kf lm kg ln ki lo kj lp kl lq km lr ls bi translated">现场操作员</h1><p id="8739" class="pw-post-body-paragraph lt lu iq lv b lw lx ka ly lz ma kd mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果我们想将搜索限制在特定的字段，可以使用运算符“@”:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="aa25" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('@title find me fast');<br/>+------+------+------------------------+---------+<br/>| id   | gid  | title                  | content |<br/>+------+------+------------------------+---------+<br/>|    2 |    1 | find me fast           |  quick  |<br/>|    6 |    1 | find me fast now       |  quick  |<br/>|    5 |    1 | find me quick and fast |  quick  |<br/>+------+------+------------------------+---------+<br/>3 rows in set (0.00 sec)</span></pre><p id="69e0" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">我们还可以指定多个字段来限制搜索:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="02d4" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('@(title,content) find me fast');<br/>+------+------+------------------------+----------------+<br/>| id   | gid  | title                  | content        |<br/>+------+------+------------------------+----------------+<br/>| 1    |    1 | find me                | fast and quick |<br/>| 2    |    1 | find me fast           | quick          |<br/>| 6    |    1 | find me fast now       | quick          |<br/>| 5    |    1 | find me quick and fast | quick          |<br/>+------+------+------------------------+----------------+<br/>4 rows in set (0.00 sec)</span></pre><p id="a1f3" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">字段操作符也可以用来限制只在前x个单词中进行搜索。例如:</p><p id="f0a0" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated"><code class="fe nf ng nh mw b">mysql&gt; select * from testrt where match(‘<a class="ae ni" href="http://twitter.com/title" rel="noopener ugc nofollow" target="_blank">@title</a> lazy dog’);</code></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nj"><img src="../Images/a223dc7533ecf1d13534aa792a5593d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TjJZqmb2cAr-4JJpu8ADQ.png"/></div></div></figure><p id="c4b8" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">然而，如果我们只搜索前5个单词，我们将一无所获:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="4584" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('@title[5] lazy dog');<br/>Empty set (0.00 sec)</span></pre><p id="e2cc" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">在某些情况下，可以对可能没有相同全文字段的多个索引执行搜索。<br/>默认情况下，指定索引中不存在的字段将导致查询错误。为了克服这个问题，可以使用特殊运算符“@@relaxed ”:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="74e7" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match(‘@(title,keywords) lazy dog’);<br/>ERROR 1064 (42000): index testrt: query error: no field ‘keywords’ found in schema</span><span id="8e86" class="na lc iq mw b gy nk nc l nd ne">mysql&gt; select * from testrt where match('@@relaxed @(title,keywords) lazy dog');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nl"><img src="../Images/3f36aa7cd3a69c057f387a9fd8ec493e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OFbeK-ZDqACSh54bS-NwBw.png"/></div></div></figure><h1 id="e42d" class="lb lc iq bd ld le lf lg lh li lj lk ll kf lm kg ln ki lo kj lp kl lq km lr ls bi translated">模糊搜索</h1><p id="a4bc" class="pw-post-body-paragraph lt lu iq lv b lw lx ka ly lz ma kd mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">模糊匹配允许只匹配查询字符串中的某些词，例如:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="94ca" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('"fox bird lazy dog"/3');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nm"><img src="../Images/1640dd9d5336c2ca4572d54e5a8451a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOdw8zan6LNeOVBKOAw_aw.png"/></div></div></figure><p id="76a2" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">在这种情况下，我们使用QUORUM运算符，并指定只匹配3个单词即可。使用“/1”的搜索等效于OR布尔搜索，而使用“/N”的搜索(其中N是输入单词的数量)等效于AND搜索。</p><p id="e3eb" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">除了绝对数字，您还可以指定一个介于0.0和1.0之间的数字(代表0%和100%)，蝎狮将只匹配至少具有给定单词的指定百分比的文档。上面同样的例子也可以写成“fox bird lazy dog”/0.3，它将匹配4个单词中至少30%的文档。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="db31" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('"fox bird lazy dog"/0.3')</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nm"><img src="../Images/2458bccec0f957ce37c150c84e9dd77f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B5TjL908axWopdSx8ID9NA.png"/></div></div></figure><h1 id="c920" class="lb lc iq bd ld le lf lg lh li lj lk ll kf lm kg ln ki lo kj lp kl lq km lr ls bi translated">高级运算符</h1><p id="88ab" class="pw-post-body-paragraph lt lu iq lv b lw lx ka ly lz ma kd mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">除了简单的操作符之外，还有许多高级操作符很少使用，但在某些情况下是绝对必要的。</p><p id="68a8" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">最常用的高级运算符之一是短语运算符。<br/>短语操作符只有在给定的单词按指定的顺序找到时才会匹配。这也将限制在同一字段中找到的单词:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="4642" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('"quick brown fox"');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nn"><img src="../Images/714daf40e42f46de4e996e3efcbf12f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zTgFcvA9cDuPKwVmKK1a2g.png"/></div></div></figure><p id="ee0d" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">短语运算符的一个更宽松的版本是严格顺序运算符。<br/>顺序操作符要求单词按照指定的完全相同的顺序查找，但其他单词也可以出现在:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="4055" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('find &lt;&lt; me &lt;&lt; fast');<br/>+------+------+------------------------+---------+<br/>| id   | gid  | title                  | content |<br/>+------+------+------------------------+---------+<br/>|    2 |    1 | find me fast           |  quick  |<br/>|    6 |    1 | find me fast now       |  quick  |<br/>|    5 |    1 | find me quick and fast |  quick  |<br/>+------+------+------------------------+---------+<br/>3 rows in set (0.00 sec)</span></pre><p id="772c" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">另一对处理单词位置的操作符是开始/结束字段操作符。<br/>这些将限制一个单词出现在一个字段的开头或结尾。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="dc42" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('^find me fast$');<br/>+------+------+------------------------+---------+<br/>| id   | gid  | title                  | content |<br/>+------+------+------------------------+---------+<br/>|    2 |    1 | find me fast           |  quick  |<br/>|    5 |    1 | find me quick and fast |  quick  |<br/>+------+------+------------------------+---------+<br/>2 rows in set (0.00 sec)</span></pre><p id="62ae" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">邻近运算符类似于AND运算符，但是增加了单词之间的最大距离，因此它们仍然可以被视为匹配。让我们以这个只有AND运算符的例子为例:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="ab6e" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('brown fox jumps');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi no"><img src="../Images/a59c7f5409ac9a9e465ac58c652123f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ysz3GtyPAUxgZEEuVm017A.png"/></div></div></figure><p id="4ffb" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">我们的查询返回两个结果:一个是所有的单词都彼此靠近，第二个是其中一个单词更远。<br/>如果我们只想匹配一定距离内的单词，我们可以使用邻近运算符进行限制:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="098f" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('"brown fox jumps"~5');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi np"><img src="../Images/587886e2f605c88d7d94ce303aa1f52d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M-JnJqBx-E4ZtEKMVH4YWQ.png"/></div></div></figure><p id="e35f" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">近似运算符的一个更一般化的版本是NEAR运算符。在邻近的情况下，在一个单词包中指定一个单一的距离，而邻近操作符使用两个操作数，可以是单个单词或表达式。</p><p id="accb" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">在下面的示例中，“brown”和“fox”必须在2的距离内，“fox”和“jumps”必须在6的距离内:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="e717" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('brown NEAR/2 fox NEAR/6 jumps');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nq"><img src="../Images/82bd6295c0b3dc5178b0a467517bc668.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8boEkSR29yKimqchxn9jQ.png"/></div></div></figure><p id="83f7" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">该查询遗漏了一个与第一个NEAR条件(这里是最后一个)不匹配的文档:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="080c" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('brown NEAR/3 fox NEAR/6 jumps');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nr"><img src="../Images/453f3df9b31ba9d3ec47ec557bde7233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TvGIUg6feh84AOnus9oNIg.png"/></div></div></figure><p id="b1dd" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">NEAR运算符的一个变体是NOTNEAR，它仅在操作数之间有最小距离时才匹配。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="227f" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; SELECT * FROM testrt WHERE MATCH('"brown fox" NOTNEAR/5 jumps');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ns"><img src="../Images/fb99552767c66d314ad95c5fbe7e0dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vhOGvBKapnXPZINF6RUEBw.png"/></div></div></figure><p id="5f2b" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">蝎狮还可以检测纯文本中的句子和HTML内容中的段落。<br/>对于索引句子，需要启用<a class="ae ni" href="http://mnt.cr/index_sp" rel="noopener ugc nofollow" target="_blank"> <strong class="lv ja"> index_sp </strong> </a>选项，而段落也需要<a class="ae ni" href="http://mnt.cr/html_strip" rel="noopener ugc nofollow" target="_blank"><strong class="lv ja">html _ strip</strong></a><strong class="lv ja">= 1</strong></p><p id="4186" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">让我们举下面的例子:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="bdf9" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('"the brown fox" jumps')\G<br/>*************************** 1. row ***************************<br/>id: 15<br/>gid: 2<br/>title: The brown fox takes a step back. Then it jumps over the lazydog<br/>content:<br/>1 row in set (0.00 sec)</span></pre><p id="2264" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">该文档包含两个句子，而第一个句子中的短语“jumps”仅出现在第二个句子中。</p><p id="a9d8" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">使用句子运算符，我们可以将搜索限制为仅当操作数在同一个句子中时才进行匹配:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="cead" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('"the brown fox" SENTENCE jumps')\G<br/>Empty set (0.00 sec)</span></pre><p id="f209" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">我们可以看到该文档不再匹配。如果我们更正搜索查询，使所有单词都来自同一个句子，我们将看到一个匹配:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="09fc" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('"the brown fox" SENTENCE back')\G<br/>*************************** 1. row ***************************<br/>id: 15<br/>gid: 2<br/>title: The brown fox takes a step back. Then it jumps over the lazydog<br/>content:<br/>1 row in set (0.00 sec)</span></pre><p id="c523" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">为了演示该段落，让我们使用以下搜索:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="66fc" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('Samsung  Galaxy');</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nt"><img src="../Images/db11b70aed444be91b152ff772b8b943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D5phDAJvVdJ8Po7g_sRW6A.png"/></div></div></figure><p id="4d29" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">这两个文档有不同的HTML标签</p><p id="5131" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">如果我们添加段落，那么只有在单个标签中找到搜索词的文档会保留下来。</p><p id="15b5" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">更一般的运算符是ZONE及其变体ZONESPAN。“区域”是HTML或XML标签中的文本。</p><p id="29fe" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">区域要考虑的标签需要在“index_zones”设置中声明，如“index_zones = h*，th，title”。<br/>例如:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="d27e" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('hello world');<br/>+------+------+-------------------------------+---------+<br/>| id   | gid  | title                         | content |<br/>+------+------+-------------------------------+---------+<br/>|   12 |    2 | Hello world                   |         |<br/>|   14 |    2 | &lt;h1&gt;Hello world&lt;/h1&gt;          |         |<br/>|   13 |    2 | &lt;h1&gt;Hello&lt;/h1&gt; &lt;h1&gt;world&lt;/h1&gt; |         |<br/>+------+------+-------------------------------+---------+<br/>3 rows in set (0.00 sec)</span></pre><p id="7965" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">我们有3个文档，其中“hello”和“world”是在纯文本中找到的，在同一类型的不同区域或在单个区域中。</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="9feb" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('ZONE:h1 hello world');<br/>+------+------+-------------------------------+---------+<br/>| id   | gid  | title                         | content |<br/>+------+------+-------------------------------+---------+<br/>|   14 |    2 | &lt;h1&gt;Hello world&lt;/h1&gt;          |         |<br/>|   13 |    2 | &lt;h1&gt;Hello&lt;/h1&gt; &lt;h1&gt;world&lt;/h1&gt; |         |<br/>+------+------+-------------------------------+---------+<br/>2 rows in set (0.00 sec)</span></pre><p id="eb67" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">在这种情况下，单词出现在H1区域中，但不要求它们在同一个区域中。如果我们想将匹配限制在单个区域，我们可以使用ZONESPAN:</p><pre class="kq kr ks kt gt mv mw mx my aw mz bi"><span id="3ae5" class="na lc iq mw b gy nb nc l nd ne">mysql&gt; select * from testrt where match('ZONESPAN:h1 hello world');<br/>+------+------+----------------------+---------+<br/>| id   | gid  | title                | content |<br/>+------+------+----------------------+---------+<br/>|   14 |    2 | &lt;h1&gt;Hello world&lt;/h1&gt; |         |<br/>+------+------+----------------------+---------+<br/>1 row in set (0.00 sec)</span></pre><p id="04be" class="pw-post-body-paragraph lt lu iq lv b lw mp ka ly lz mq kd mb mc mr me mf mg ms mi mj mk mt mm mn mo ij bi translated">希望通过这篇文章，您已经了解了<a class="ae ni" href="https://docs.manticoresearch.com/latest/html/searching/boolean_query_syntax.html" rel="noopener ugc nofollow" target="_blank">全文搜索操作符</a>在蝎狮是如何工作的。如果您正在寻找一种实践体验来更好地学习它，您可以<a class="ae ni" href="https://play.manticoresearch.com/fulltextintro/" rel="noopener ugc nofollow" target="_blank">现在就在您的浏览器中尝试我们的互动课程</a>。</p></div></div>    
</body>
</html>