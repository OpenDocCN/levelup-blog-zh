<html>
<head>
<title>How Can You Build an AI tale generator for your kids?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你如何为你的孩子建造一个人工智能故事发生器？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-build-an-ai-tale-generator-for-your-kids-34b8db153054?source=collection_archive---------9-----------------------#2022-09-13">https://levelup.gitconnected.com/how-to-build-an-ai-tale-generator-for-your-kids-34b8db153054?source=collection_archive---------9-----------------------#2022-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/cbfc3b6ac0a647fc64363ad5019973cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lNFx7mPGVIGILfah"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@hrustall?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">дмитиийхрусталев-григорьев</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="1ef0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你好，读者，正如你从我的个人资料中看到的，我通常写网络安全的东西。虽然看起来不像，但我喜欢编程的每个方面。在这篇文章中，我很乐意展示如何编写一个故事生成器。<br/>老实说，最终的结果是一个文本生成器，它将完成你的incipit，不管它是什么。<br/>顺便说一句“<strong class="ki iu"> AI tale generator </strong>”是我最终脚本的主要用途。</p><h1 id="6915" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">我们要学什么？</h1><p id="a8e0" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">整个项目只是磨练我们技能的一个借口。<br/>详细来说，我们将看到:</p><ul class=""><li id="961b" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">使用<a class="ae kf" href="https://en.wikipedia.org/wiki/ASCII_art" rel="noopener ugc nofollow" target="_blank"> ASCII艺术图</a>打印漂亮的横幅</li><li id="fa85" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">管理CLI参数</li><li id="2260" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">使用来自<a class="ae kf" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank">拥抱面</a>的预训练模型</li></ul><p id="6bbd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我猜你已经等不及要动手了，那就开始吧！</p><h1 id="0c87" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">先决条件</h1><p id="e123" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我假设您的系统上已经安装了Python 3，因此我们需要安装一些库:</p><ul class=""><li id="7dee" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated"><a class="ae kf" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank">张量流</a></li><li id="133b" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated"><a class="ae kf" href="https://github.com/huggingface/transformers" rel="noopener ugc nofollow" target="_blank">变形金刚</a></li><li id="e6bf" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">pyfiglet </li><li id="251b" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated"><a class="ae kf" href="https://palletsprojects.com/p/click/" rel="noopener ugc nofollow" target="_blank">点击</a></li></ul><p id="d2a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以在终端上用一行代码做任何事情:</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="4b78" class="ne lf it na b gy nf ng l nh ni">pip install tensorflow transformers pyfiglet click</span></pre><p id="c04a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">可能需要一段时间，休息一下，也许喝杯咖啡！<br/>完成后，我们就准备编码了！</p><h1 id="fa22" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">热身和准备进口和全球的东西！</h1><p id="0878" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">像往常一样，我们要写的第一行是导入。然而，它们并不是我们要写的唯一的几行。事实上，我们将要使用的库对我们的口味来说有点冗长！<br/>你可以看到<a class="ae kf" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> tensorflow </a>和<a class="ae kf" href="https://github.com/huggingface/transformers" rel="noopener ugc nofollow" target="_blank">变压器</a>的所有警告都是关闭的(2、7线)。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="fe1b" class="ne lf it na b gy nf ng l nh ni">import os<br/>os.environ["TF_CPP_MIN_LOG_LEVEL"] = "2"<br/>import transformers<br/>import click<br/>from pyfiglet import Figlet<br/><br/>transformers.utils.logging.set_verbosity(transformers.logging.FATAL)<br/><br/>MAX_LENGTH = 250</span></pre><p id="ed29" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nj nk nl na b">MAX_LENGTH</code>只是一个全局变量，表示生成文本的最大长度的默认值。</p><h1 id="d748" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">竖起我们精彩的旗帜</h1><p id="a667" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">每个命令行应用程序都需要一个精彩的横幅。<br/>让我们看看如何通过使用<a class="ae kf" href="https://github.com/pwaller/pyfiglet" rel="noopener ugc nofollow" target="_blank"> pyfiglet </a>和ASCII Art用几行代码就能做到</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="d78c" class="ne lf it na b gy nf ng l nh ni">def print_banner(text, font='graffiti'):<br/>    <br/>    figlet = Figlet(font=font)<br/>    print(figlet.renderText(text))</span></pre><p id="750e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们刚刚定义的函数将很快帮助我们，但是现在，让我们继续我们的代码！</p><h1 id="12f7" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">GPT-2如何使用预训练的变压器模型</h1><p id="91a3" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">虽然这不是一篇关于神经网络的具体文章，但我想向您展示如何使用来自<a class="ae kf" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank"> HuggingFace的预训练模型。</a> <br/>在本教程中，我们将使用一个相对较旧的模型，然而在许多情况下结果会令人满意。</p><p id="c9d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感兴趣的模型是<a class="ae kf" href="https://en.wikipedia.org/wiki/GPT-2" rel="noopener ugc nofollow" target="_blank"> GPT-2 </a>(生成式预训练变压器)，它是2019年的最先进水平。<br/>它是一个深度神经网络，使用<a class="ae kf" href="https://en.wikipedia.org/wiki/Attention_(machine_learning)" rel="noopener ugc nofollow" target="_blank">注意力</a>机制生成文本。</p><p id="75e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过阅读文档<a class="ae kf" href="https://huggingface.co/gpt2" rel="noopener ugc nofollow" target="_blank">这里</a>很明显我们可以多么容易地使用一个如此复杂的模型！<br/>变形金刚<a class="ae kf" href="https://github.com/huggingface/transformers" rel="noopener ugc nofollow" target="_blank">库提供的高级接口允许我们只关注最终结果。</a></p><p id="e529" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是如何创建模型的代码，然后用给定的incipit生成文本！</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="7439" class="ne lf it na b gy nf ng l nh ni">generator = transformers.pipeline('text-generation', model='gpt2')<br/>out = generator(beginning, <br/>                max_length=max_length, <br/>                num_return_sequences=1)</span></pre><p id="8bba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">结果是一个字典列表(在这种情况下，我们将<code class="fe nj nk nl na b">num_return</code>设置为1)。<br/>每个字典包含不同的文本补全，生成的文本存储在键<code class="fe nj nk nl na b">generated_text</code>下。</p><p id="3475" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">参数<code class="fe nj nk nl na b">max_length</code>表示输出的最大可能长度。</p><h1 id="2be8" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">如何从命令行获取参数</h1><p id="e7b0" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在这一步中，我们希望以两种方式传递变量:</p><ul class=""><li id="7a8a" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">长度应该来自终端</li><li id="9deb" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">开始应该来自启动应用程序后的用户输入</li></ul><p id="157e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要做到这一点，我们可以依靠<a class="ae kf" href="https://palletsprojects.com/p/click/" rel="noopener ugc nofollow" target="_blank"> click </a>库，它允许我们只用几个装饰者就能做到。</p><p id="f9ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些是我们将要使用的:</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="9c1f" class="ne lf it na b gy nf ng l nh ni">@click.command()<br/>@click.option("--beginning", prompt="Incipit", help="The incipit of your story")<br/>@click.option("--length", default=MAX_LENGTH, help="The max length of the story", type=click.INT)</span></pre><p id="af83" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一个选项从带有选项“<em class="nm">——从</em>开始”的终端或从用户输入获取变量。</p><p id="887b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个选项的值“— length”设置为int，来自终端。</p><p id="eb81" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很简单，不是吗？</p><p id="e047" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在是时候创建主要的和辅助的方法来生成故事了。</p><h1 id="fb1b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">最新功能main和generate_story</h1><p id="9f76" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在把所有东西组装起来之前，我们还需要两次操作。</p><p id="6a32" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们需要一个方法，用给定的生成器返回生成的文本。</p><p id="0d44" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是完成这项任务的两行代码</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="e58b" class="ne lf it na b gy nf ng l nh ni">def get_story(generator, beginning, max_length):<br/><br/>    out = generator(beginning, max_length=max_length, num_return_sequences=1)<br/>    return out[0]['generated_text']</span></pre><p id="7fa0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，我们需要定义main方法。这样做更好，这样使用装饰器会更容易、更干净。正如我们之前看到的，main应该通过从终端获取参数来生成并打印故事。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="7b98" class="ne lf it na b gy nf ng l nh ni">def main(beginning, length):    <br/>    <br/>    story = get_story(generator, beginning, length)<br/>    print(story)</span></pre><h1 id="8cf1" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">把所有的放在一起</h1><p id="2b50" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">最后一步是整理所有东西，并以正确的顺序调用函数，让我们看看如何进行:</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="ca29" class="ne lf it na b gy nf ng l nh ni">if __name__=="__main__":<br/>    print_banner("Welcome on AI Story Generator!\n\n\n")<br/>    main()</span></pre><p id="edf5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一切似乎都很简单，但对于最懒的人来说，让我们看看完整的代码。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="a9d0" class="ne lf it na b gy nf ng l nh ni">import os<br/>os.environ["TF_CPP_MIN_LOG_LEVEL"] = "2"<br/>import transformers<br/>import click<br/>from pyfiglet import Figlet<br/><br/>transformers.utils.logging.set_verbosity(transformers.logging.FATAL)<br/>generator = transformers.pipeline('text-generation', model='gpt2')<br/>MAX_LENGTH = 250<br/><br/><br/>def get_story(generator, beginning, max_length=MAX_LENGTH):<br/><br/>    out = generator(beginning, max_length=max_length, num_return_sequences=1)<br/>    return out[0]['generated_text']<br/><br/>def print_banner(text, font='graffiti'):<br/>    <br/>    figlet = Figlet(font=font)<br/>    print(figlet.renderText(text))<br/><br/>@click.command()<br/>@click.option("--beginning", prompt="Incipit", help="The incipit of your story")<br/>@click.option("--length", default=MAX_LENGTH, help="The max length of the story", type=click.INT)<br/>def main(beginning, length):<br/>    <br/>    <br/>    story = get_story(generator, beginning, length)<br/>    print(story)<br/><br/><br/><br/>if __name__=="__main__":<br/>    print_banner("Welcome on AI Story Generator!\n\n\n")<br/>    main()</span></pre><p id="81f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好了，现在我们可以尝试运行max_length为150的脚本(在名为“main.py”的文件中)并查看结果:</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="19a9" class="ne lf it na b gy nf ng l nh ni">python main.py --length 150</span></pre><p id="b9bb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我的结果！</p><figure class="mv mw mx my gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/b5a220c7dd32c92c83e515f79d2a6356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwxpyLoK-kmnQ8JWqujYzw.jpeg"/></div></div></figure><p id="0209" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有许多可能的改进:</p><ul class=""><li id="eb0e" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">提供通过循环继续生成的可能性</li><li id="5a50" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">使用更先进的型号，如GPT-3</li><li id="3b7f" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">微调模型以产生更好的故事</li><li id="0542" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">在生成故事时插入一个加载动画</li></ul><p id="6c56" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">等等…</p><p id="32e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你喜欢这篇文章，如果你喜欢我的作品，你可以在medium上关注我，或者访问<a class="ae kf" href="https://www.stackzero.net/" rel="noopener ugc nofollow" target="_blank"> StackZero </a>。</p></div></div>    
</body>
</html>