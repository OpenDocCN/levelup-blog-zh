<html>
<head>
<title>Fastest PostgreSQL Client Library for Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向Go的最快PostgreSQL客户端库</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/fastest-postgresql-client-library-for-go-579fa97909fb?source=collection_archive---------2-----------------------#2021-07-19">https://levelup.gitconnected.com/fastest-postgresql-client-library-for-go-579fa97909fb?source=collection_archive---------2-----------------------#2021-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5a8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对一些流行的PostgreSQL客户端库进行基准测试，以找到最快的一个。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/cfe5bc1f9183d00b9e7306b31fa10ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oOe_1UWdexLScu1L.png"/></div></div></figure><h1 id="f8b3" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">动机</h1><p id="bd6b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">提高RPS(每秒请求数)不是一件容易的事情。更改代码以提高性能更具挑战性。有几个流行的库，几乎每一个都声称是最快的。当基准测试结果过时时，问题就出现了。更糟糕的是，进行基准测试的人以非通用的方式调优库。因此，对于普通用户来说，达到同样的性能几乎是不可能的。</p><p id="3510" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基准测试的目的是在一个受控的环境中找到最快的PostgreSQL客户端库，并且不需要任何<em class="ma">魔法来调整任何库。</em></p><h1 id="9138" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">环境</h1><p id="aa57" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">使用的Go客户端库:</p><ul class=""><li id="6fc9" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/jackc/pgx" rel="noopener ugc nofollow" target="_blank"> jackc/pgx </a> v4.12.0</li><li id="b1f0" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated">gorm.io/gormv 1 . 21 . 12<a class="ae mk" href="https://github.com/go-gorm/gorm" rel="noopener ugc nofollow" target="_blank"/></li><li id="175c" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/lib/pq" rel="noopener ugc nofollow" target="_blank"> lib/pq </a> v1.10.2</li><li id="c9a6" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated">jmoiron/sqlx  v1.3.4</li><li id="b4cd" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/go-pg/pg" rel="noopener ugc nofollow" target="_blank"> go-pg/pg </a> v10.10.2</li><li id="8a36" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/upper/db" rel="noopener ugc nofollow" target="_blank"> upper/db </a> v4.2.1</li><li id="2bad" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/uptrace/bun" rel="noopener ugc nofollow" target="_blank">上升/下降</a> v0.3.3</li></ul><p id="75c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">规格:</p><ul class=""><li id="9877" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated">使用PostgreSQL v13.3.0</li><li id="db5c" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated">实例大小为4核8 GB</li><li id="1257" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated">使用连接池，其中最大连接池大小为16</li></ul><h1 id="5b4e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">基准测试结果</h1><p id="802e" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">下面的结果是运行基准测试25次后的平均结果。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h1 id="9a7c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">了解结果</h1><p id="68d0" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在每个SQL操作的右边有四列，比如上面结果中的CREATE。它们中每一个的含义是:</p><ul class=""><li id="68aa" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated"><strong class="jp ir">迭代</strong> = &gt;运算运行的迭代次数，<strong class="jp ir"/><strong class="jp ir">值越高越好</strong>。</li><li id="7ea7" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><strong class="jp ir"> ns/op </strong> = &gt;这是每个函数调用完成的平均时间，<strong class="jp ir">一个</strong> <strong class="jp ir">越小的值越好</strong>。</li><li id="68eb" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><strong class="jp ir"> B/op </strong> = &gt;这是每个函数调用使用的平均内存，<strong class="jp ir">值越小越好。</strong></li><li id="cbd1" class="mb mc iq jp b jq ml ju mm jy mn kc mo kg mp kk mg mh mi mj bi translated"><strong class="jp ir"> allocs/o </strong> = &gt;这是每个函数调用的平均内存分配，<strong class="jp ir">值越小越好。</strong></li></ul><p id="5aae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到<strong class="jp ir"> <em class="ma"> jackc/pgx </em> </strong>几乎在所有的运行基准<em class="ma">上都优于其他库。</em>不包括<em class="ma">更新</em>操作，其中<strong class="jp ir"> <em class="ma"> uptrace/bun </em> </strong>实际上胜过它。</p><h1 id="153d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="5ad4" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">通过查看上面的结果，我们可以得出结论，<strong class="jp ir"> <em class="ma"> jackc/pgx </em> </strong>是总体上最快的PostgreSQL客户端库。建议根据您自己的环境使用专用的最大连接池大小。根据您最繁重的操作，需要进行一些测试来找到平衡最大连接池大小。</p></div></div>    
</body>
</html>