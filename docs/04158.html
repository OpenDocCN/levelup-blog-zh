<html>
<head>
<title>Use JavaScript to Make an Element Follow The Cursor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JavaScript使元素跟随光标</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/use-javascript-to-make-an-element-follow-the-cursor-3872307778b4?source=collection_archive---------0-----------------------#2020-06-12">https://levelup.gitconnected.com/use-javascript-to-make-an-element-follow-the-cursor-3872307778b4?source=collection_archive---------0-----------------------#2020-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0e0c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">event.pageY和event.offsetY的区别</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/03912c72e798a2ca5badf1a16cedcde4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wsaKpuCFfjMG_s3iIilWsg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">亚辛·哈桑在Unsplash上的照片</figcaption></figure><p id="fb7a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我最近回答了一个关于堆栈溢出的问题，OP想要一个HTML元素跟随用户的光标。OP给HTML元素(一个<code class="fe lv lw lx ly b">div</code>)绝对定位，并使用<code class="fe lv lw lx ly b">event.offsetY</code>和<code class="fe lv lw lx ly b">event.offsetX</code>来确定<code class="fe lv lw lx ly b">top</code>和<code class="fe lv lw lx ly b">left</code> CSS值。最终的结果是一个跟随光标的“故障”圆圈，但会跳回到文档的左上角。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lz"><img src="../Images/185a2e8b496bcedcd71250b991fe0c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hWR3Yaz4s_u4l1rll-VOMw.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">很抱歉质量不好。实际上，圆圈会更靠近光标，但最终会跳回左上角。</figcaption></figure><p id="db0f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是HTML…</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="0a04" class="me mf it ly b gy mg mh l mi mj">&lt;html&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="circle"&gt;&lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="a7d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">…CSS…</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="a445" class="me mf it ly b gy mg mh l mi mj">body{<br/>  margin:0;<br/>  padding:0;<br/>  overflow:hidden;<br/>  background-color:#77dd77;<br/>}<br/>div{<br/>  position:absolute;<br/>  transform:translate(-50%,-50%);<br/>  height:35px;<br/>  width:35px;<br/>  border-radius:50%;<br/>  border:2px solid black;<br/>}</span></pre><p id="3119" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">…最后是JavaScript。</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="cbb2" class="me mf it ly b gy mg mh l mi mj">document.addEventListener('mousemove', function(e) {<br/>  let body = document.querySelector('body');<br/>  let circle = document.getElementById('circle');<br/>  let left = e.offsetX;<br/>  let top = e.offsetY;<br/>  circle.style.left = left + 'px';<br/>  circle.style.top = top + 'px';<br/>});</span></pre><p id="328a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么是哪里出了问题呢？简而言之，问题在于OP在试图设置<code class="fe lv lw lx ly b">top</code>和<code class="fe lv lw lx ly b">left</code> CSS值时使用了错误的事件属性。他们应该用<code class="fe lv lw lx ly b">event.pageY</code>和<code class="fe lv lw lx ly b">event.pageX</code>来代替。</p><p id="ad30" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lv lw lx ly b">offset...</code>参照<strong class="la iu">父容器</strong>工作，这里是<code class="fe lv lw lx ly b">body</code>元素。除非OP设置了<code class="fe lv lw lx ly b">body</code>标签的高度(他们没有设置)，否则<code class="fe lv lw lx ly b">body</code>不会有任何高度。这是因为绝对定位的元素已从父流中移除。在这种情况下，<code class="fe lv lw lx ly b">div</code>是<code class="fe lv lw lx ly b">body</code>的唯一子代。由于flow中没有子元素，所以它不需要更新它的高度来适应它的内容，从而产生一个基本上为<code class="fe lv lw lx ly b">0px</code>的高度。</p><p id="3c0c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于没有高度，鼠标事件很难保持对<code class="fe lv lw lx ly b">offsetY</code>和<code class="fe lv lw lx ly b">offsetX</code>的一致跟踪。当您记录结果时，您会看到奇怪的情况，无论鼠标的实际位置在哪里，<code class="fe lv lw lx ly b">offset</code>值都会回落到类似于<code class="fe lv lw lx ly b">10</code>或<code class="fe lv lw lx ly b">15</code>的值。由于对父容器的引用不准确，<code class="fe lv lw lx ly b">div</code>的赋值<code class="fe lv lw lx ly b">left</code>和<code class="fe lv lw lx ly b">top</code>是……嗯……不准确的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/077d3df7bfb36bbe19a9384ec1bb2bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*ZKVn1HfQRKiC_FokBnnIlw.gif"/></div></figure><p id="be18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lv lw lx ly b">page...</code>另一方面，与文档整体相关地工作。这样，唯一的高度限制就是网页的高度。</p><p id="9667" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">鉴于<code class="fe lv lw lx ly b">onmousemove</code>事件处理程序仅应用于文档，网页中的高度变化是不相关的，因为<code class="fe lv lw lx ly b">onmousemove</code>事件仅在网页上被拾取。这将为我们提供更一致的鼠标位置参考，从而为<code class="fe lv lw lx ly b">left</code>和<code class="fe lv lw lx ly b">right</code>提供更准确的值。</p><blockquote class="ml mm mn"><p id="aaa3" class="ky kz mo la b lb lc ju ld le lf jx lg mp li lj lk mq lm ln lo mr lq lr ls lt im bi translated">通过创建一个<a class="ae lu" href="https://matt-croak.medium.com/membership" rel="noopener">中型合作伙伴计划账户</a>和<a class="ae lu" href="https://matt-croak.medium.com/subscribe" rel="noopener">订阅我的电子邮件</a>，获取我所有的最新内容。:)</p></blockquote><p id="769a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看更新后的JavaScript。</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="062f" class="me mf it ly b gy mg mh l mi mj">let circle = document.getElementById('circle');</span><span id="9942" class="me mf it ly b gy ms mh l mi mj">const onMouseMove = (e) =&gt;{<br/>  circle.style.left = e.pageX + 'px';<br/>  circle.style.top = e.pageY + 'px';<br/>}</span><span id="8141" class="me mf it ly b gy ms mh l mi mj">document.addEventListener('mousemove', onMouseMove);</span></pre><p id="863f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我决定将<code class="fe lv lw lx ly b">div</code>存储在函数外部的变量中，这样它只需声明一次。我删除了<code class="fe lv lw lx ly b">body</code>的变量，因为它没有被使用。最后，我没有将<code class="fe lv lw lx ly b">e.pageX</code>和<code class="fe lv lw lx ly b">e.pageY</code>存储在变量中，而是直接将这些值连接起来。更新后的代码给出了下面的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/d655870a977d25f7b1d77a160b90dfd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IKw3QJCLE1xMhrO3qy-myA.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">比如buttah</figcaption></figure><p id="bcaa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这篇文章最重要的一点是<code class="fe lv lw lx ly b">pageY</code>和<code class="fe lv lw lx ly b">pageX</code>是由鼠标相对于整个文档的位置决定的值，而<code class="fe lv lw lx ly b">offsetY</code>和<code class="fe lv lw lx ly b">offsetX</code>是相对于父容器的。如果您想根据鼠标相对于容器的位置来填充容器，后者会很有用。见下文。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/405c138a658718c083e5de8827ba3ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/1*8I2IUSiyYUtXDmLmkWvcqA.gif"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">上述示例的代码可以在这个codesandbox中找到。</figcaption></figure></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><p id="e0a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://matt-croak.medium.com/membership" rel="noopener"> <em class="mo">在这里将你的免费媒体会员升级为付费会员</em> </a> <em class="mo">每月只需5美元，你就可以获得数以千计作家的无限量、无广告的故事。这是一个附属链接，你的会员资格的一部分帮助我为我创造的内容获得奖励。谢谢大家！</em></p><h1 id="ed23" class="nc mf it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">参考</h1><div class="nt nu gp gr nv nw"><a href="https://stackoverflow.com/questions/62347848/im-trying-to-get-a-div-element-to-follow-my-mouse-javascript-but-it-keeps-gl/62347962#62347962" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">我试图让一个div元素跟随我的鼠标(javascript ),但是它总是出错</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">stackoverflow.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="0c30" class="nc mf it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">分级编码</h1><p id="9489" class="pw-post-body-paragraph ky kz it la b lb os ju ld le ot jx lg lh ou lj lk ll ov ln lo lp ow lr ls lt im bi translated">感谢您成为我们社区的一员！升级正在改变技术招聘。在最好的公司找到你最理想的工作。</p><div class="nt nu gp gr nv nw"><a href="https://jobs.levelup.dev/talent" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">提升——改变招聘流程</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">🔥让软件工程师找到他们热爱的完美角色🧠寻找人才是最痛苦的部分…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">作业. levelup.dev</p></div></div><div class="of l"><div class="ox l oh oi oj of ok ks nw"/></div></div></a></div></div></div>    
</body>
</html>