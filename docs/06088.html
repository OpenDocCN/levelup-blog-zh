<html>
<head>
<title>Create Your Own Quantum Mechanics Simulation (With Python)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建自己的量子力学模拟(使用Python)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-your-own-quantum-mechanics-simulation-with-python-51e215346798?source=collection_archive---------2-----------------------#2020-10-26">https://levelup.gitconnected.com/create-your-own-quantum-mechanics-simulation-with-python-51e215346798?source=collection_archive---------2-----------------------#2020-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="421b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天的娱乐编码练习，我们将看看<strong class="js iu">量子力学系统</strong>，特别是<em class="ko">薛定谔-泊松</em>方程。我们将建立一个波函数在自然势下演化的模拟。这样的系统可能描述某些超流体/玻色-爱因斯坦凝聚体或奇异的暗物质。</p><p id="d3d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在github上找到附带的<a class="ae kp" href="https://github.com/pmocz/quantumspectral-python" rel="noopener ugc nofollow" target="_blank"> Python代码。</a></p><p id="597b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在开始之前，下面是运行我们的模拟看起来像什么的gif:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/75b2d627184983eb3616a186b52d5eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*vGYrEvn8eDTW_4Vuf6xUIg.gif"/></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h2 id="d569" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">薛定谔-泊松方程</h2><p id="0cb3" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">我们将考虑薛定谔方程下波函数<em class="ko">ψ(</em><strong class="js iu"><em class="ko">x</em></strong><em class="ko">)</em>的演化:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/200f074f7b42b3906df84047654771ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*I0Ht_HZoO2QUxGxbuWSABA.png"/></div></figure><p id="8942" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">波函数<em class="ko"> ψ </em>用空间坐标<strong class="js iu"> <em class="ko"> x </em> </strong>描述域中的量子场。对其进行归一化，使其空间平均值为1:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/456c037b9a0c3bf4331b1618706d2160.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*4ntmyrN1qaYX4A742k7wtw.png"/></div></figure><p id="d473" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在方程式中，<em class="ko"> m </em>是粒子质量，h-bar (ℏ)是简化的普朗克常数。</p><p id="8a6b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">波函数感受到电势<em class="ko"> V，</em>的影响，在我们的例子中，我们假设它是由泊松方程给出的自然电势:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/de8336286a892188f2a7b8a1a65119ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*uXs6eOrYocA81nr_U25fRg.png"/></div></figure><p id="d3dd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中<em class="ko"> G </em>为牛顿引力常数。这种方程组与量子波暗物质(也称为模糊暗物质)的研究相关。很容易实现各种其他势来研究不同的量子系统。例如，实现静态势，如<a class="ae kp" href="https://en.wikipedia.org/wiki/Electric_potential#Electric_potential_due_to_a_point_charge" rel="noopener ugc nofollow" target="_blank">库仑势</a>模拟氢原子。另一个例子是<a class="ae kp" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator" rel="noopener ugc nofollow" target="_blank">量子谐振子</a>。</p><p id="e5ca" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下面的讨论中，我们将通过假设一个具有以下单位的系统来保持符号的简单:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/adf17c92ad2422a5787eda34289576e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*6NoTEGNrKusob5tzKMgoxg.png"/></div></figure><h2 id="01ec" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">谱方法</h2><p id="4fad" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated"><em class="ko">谱方法</em>使用快速傅立叶变换(FFT)算法将物理域<strong class="js iu"> <em class="ko"> x </em> </strong>上的解转换成波的叠加，每个波由波数<strong class="js iu"> <em class="ko"> k </em> </strong>描述。这种方法被证明对发展薛定谔方程和求解泊松方程特别有用。<a class="ae kp" href="https://en.wikipedia.org/wiki/Fast_Fourier_transform" rel="noopener ugc nofollow" target="_blank"> FFT </a>的细节超出了我们今天的练习范围，但是该算法是一个常用工具，在许多编程语言中都有有效的实现，我们提供了一个关于它如何以及为什么有用的高级讨论。</p><p id="54e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">FFT变换波函数:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/3e5b59bfbaf4a6b4bb72fc4401da41e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*36RDK0DfnzwNFgWtt0pvgg.png"/></div></figure><p id="940a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，将傅立叶变换应用于薛定谔方程将取代:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/997ca654e58e3700e869cdd1aadd5483.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*FY06_yUSFPsu0JdGxyKptA.png"/></div></figure><p id="97a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，它将改变梯度<strong class="js iu"> ∇ </strong>为:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/e436b077f02d23bfe59c4e811efd0aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*BkGkoLa7wpnn5x92VivOXg.png"/></div></figure><p id="2d44" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这也是这个方法如此强大的部分原因。在傅立叶空间，求导变成了简单的向量乘法。多重数字很容易。</p><p id="d502" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">薛定谔方程中的拉普拉斯算子将因此转换为:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/c4878fefbadaf0bb3db620b13b61490a.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*nTFmuKIQEBGbFv5ia9a3rg.png"/></div></figure><p id="5d39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">暂时忽略薛定谔方程中的势项，应用傅里叶变换，我们得到方程:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/ccd7ecc7d6ffa76132973994836c9ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*DrfcZApiMFj8ALo_RY7Wgg.png"/></div></figure><p id="790c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们将时间离散成步长<em class="ko"/>δ<em class="ko">t</em>，那么，波函数的傅立叶变换可以用所谓的<strong class="js iu">漂移</strong>算子从一个时间步长更新到下一个时间步长:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/ccbd3f1b9744b78272f12adf42eedd5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*ujYRTT6uMdiltafer62iCA.png"/></div></figure><p id="d10d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们可以使用逆FFT来恢复实空间中的波函数。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/cc073748cc9748db8a3a84898b04c05e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*RbRVe4BriywsGCqul246jQ.png"/></div></figure><p id="d4f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们如何应用势的效应呢？让我们考虑一下，这是薛定谔方程中唯一的一项:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/571989fdd4befd7564b09347e4cd4749.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*63hiM3bL92tObxPeUhjwew.png"/></div></figure><p id="0064" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个方程中没有空间梯度。在这种情况下，我们不需要变换到傅立叶空间。我们可以雇佣所谓的<strong class="js iu"> kick </strong>操作员。要通过<em class="ko">半个</em>时间步长δ<em class="ko">t</em>/2来更新解决方案，我们可以执行以下操作:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/92780f0587feae75ee0450040bee7852.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*aWY85ihS7SyQeYymtRbHcg.png"/></div></figure><p id="d616" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将用来完全演化波函数的完整方案将是<strong class="js iu">反冲-漂移-反冲</strong>方案，它包括应用半步反冲，接着是全步漂移，接着是另一个半步反冲。这只是kick和drift运算符的一种可能组合，它提供了二阶精度。让人联想到我们<a class="ae kp" href="https://medium.com/swlh/create-your-own-n-body-simulation-with-python-f417234885e9" rel="noopener"> <em class="ko"> N体教程</em> </a>中使用的kick-drift-kick算法。操作符的其他组合也是可能的，具有不同的精度水平。</p><p id="d97c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了能够应用“踢”，需要解决的是势的泊松方程。幸运的是，我们可以再次使用傅立叶变换方法来求解这个方程。应用傅立叶变换，泊松方程变为:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/23035fc61a3bc095a4c73d984f5cfcd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*ID3I9lnovKetJswFwv9Aaw.png"/></div></figure><p id="125c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">给定波函数<em class="ko"> ψ </em>和<em class="ko"> </em>波矢<strong class="js iu"> <em class="ko"> k </em> </strong> <em class="ko">，这很容易解决。</em>我会注意到我们之前已经求解过泊松方程，在我们的<a class="ae kp" href="https://medium.com/swlh/create-your-own-plasma-pic-simulation-with-python-39145c66578b" rel="noopener"> PIC等离子体模拟教程</a>中。然而，在这个例子中，我们采用了二阶有限差分法。谱方法是优越的，因为它具有指数精度，只要周期域上的所有相关波数都是可分辨的。</p><p id="e004" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在需要将上述所有内容付诸实践。在我们的例子中，我们将考虑一个周期域上的2D系统。修改1D或3D应用程序的代码非常简单。</p><p id="edd8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Python中，我们可以为波向量<strong class="js iu"><em class="ko">【k=(kₓ,kᵧ】</em></strong>构造一个矩阵，如下所示:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="3a73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，可以如下实施“反冲-漂移-反冲”方案，在需要时应用FFT。请注意，在反冲步骤之后，需要重新计算电位，以便进行下一次“反冲”。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="b5fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最终结果非常简单和简短。这个算法背后有很多理论，我们还没有详细介绍。但我希望这展示了使用FFT求解微分方程的能力。FFT的一个限制是它假设了一个周期域，其他边界条件将需要对该方法进行进一步的修改。</p><h2 id="f9b7" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">输入条件</h2><p id="37cc" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">我们的模拟只是将一些随机的高斯形状的超密度放在一个周期性的2D盒中，让它在自引力下演化。这些结构通过重力相互吸引，并表现出波状波动。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="6253" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行该代码可让您实时可视化模拟，并生成波函数的振幅和相位图:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mg"><img src="../Images/720ceba771113817d67441841847f600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lzAfm8b67ITjbF-iKFVLCw.png"/></div></div></figure><p id="2522" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">计算天体物理学家使用这种类型的模拟来模拟被称为“模糊暗物质”的奇异物质，这是一种假设，即宇宙中神秘的暗物质粒子是超轻的(即质量比电子小得多)。</p><p id="d59b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于模糊暗物质晕的3D模拟可视化，请查看以下视频:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="ml mf l"/></div></figure><p id="137b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">天文学家和物理学家还不知道暗物质是什么，但他们可以用不同的模型模拟宇宙，并与观测结果进行比较。下图显示了在<a class="ae kp" href="https://www.nature.com/articles/s41550-019-0947-0?error=cookies_not_supported&amp;code=8c081490-d3e7-449e-ac06-e1e1ab685b31" rel="noopener ugc nofollow" target="_blank">冷暗物质(CDM)模型下演化的年轻宇宙与暖暗物质(WDM)和模糊暗物质</a> (FDM)的对比:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mm"><img src="../Images/673c325f96d3eb6c9810044fa07ef7d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5--q3eV4U5Nq6mLVOz7wBw.png"/></div></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="636d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为我们的薛定谔-泊松解算器下载github 上的<a class="ae kp" href="https://github.com/pmocz/quantumspectral-python" rel="noopener ugc nofollow" target="_blank"> Python代码，以实时可视化模拟并处理初始条件。尽情享受吧！</a></p></div></div>    
</body>
</html>