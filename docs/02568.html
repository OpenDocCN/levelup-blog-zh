<html>
<head>
<title>How to Read an Excel File Using an ASP.NET Core MVC Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用ASP.NET核心MVC应用程序读取Excel文件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/reading-an-excel-file-using-an-asp-net-core-mvc-application-2693545577db?source=collection_archive---------0-----------------------#2020-03-23">https://levelup.gitconnected.com/reading-an-excel-file-using-an-asp-net-core-mvc-application-2693545577db?source=collection_archive---------0-----------------------#2020-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3f8e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">文件阅读技巧</h2><div class=""/><p id="fe12" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用ExcelDataReader</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/5594869f472c8963fa9bea59857b8390.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*sToEh-u8xAhmVc1B9X2NQw.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">资料来源:shutterstock.com</figcaption></figure><p id="c88a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi lj translated"><span class="l lk ll lm bm ln lo lp lq lr di">在</span>这篇文章中，我们将重点介绍如何使用<a class="ae ls" href="https://visualstudio.microsoft.com/free-developer-offers/" rel="noopener ugc nofollow" target="_blank"> Visual Studio 2019 </a>创建一个ASP.NET核心MVC应用程序来读取和显示Excel工作表中的数据。为了帮助实现这一点，我们将使用NuGet包ExcelDataReader。</p><p id="2525" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">本教程不仅让我们了解如何读取Excel文件，还让我们了解:</p><ul class=""><li id="39e0" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw ly lz ma mb bi translated"><a class="ae ls" href="https://www.geeksforgeeks.org/mvc-design-pattern/" rel="noopener ugc nofollow" target="_blank"> MVC </a>(模型-视图-控制器)如何工作</li><li id="21e9" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw ly lz ma mb bi translated"><a class="ae ls" href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/razor?view=aspnetcore-3.1" rel="noopener ugc nofollow" target="_blank">剃刀语法</a></li><li id="cefc" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw ly lz ma mb bi translated"><a class="ae ls" href="https://www.diffen.com/difference/GET-vs-POST-HTTP-Requests" rel="noopener ugc nofollow" target="_blank"> HTTP Get与POST </a></li></ul><p id="9583" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你已经熟悉这些话题，你可能想浏览一下其中的一些解释。</p><h1 id="5219" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">工具</h1><p id="3ea4" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated">对于本教程，您将需要Microsoft Visual Studio ( <strong class="kb jd">而不是</strong> Visual Studio代码)。推荐免费的<a class="ae ls" href="https://visualstudio.microsoft.com/downloads/" rel="noopener ugc nofollow" target="_blank"> Visual Studio 2019社区版</a>。</p><h1 id="fa4c" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">创建我们的应用程序</h1><h2 id="8377" class="nl mj it bd mk nm nn dn mo no np dp ms kk nq nr mw ko ns nt na ks nu nv ne iz bi translated">创建ASP.NET核心MVC Web应用程序</h2><ol class=""><li id="df36" class="lt lu it kb b kc ng kg nh kk nw ko nx ks ny kw nz lz ma mb bi translated">启动Visual Studio并点击<strong class="kb jd">创建一个新项目</strong></li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/7e71859b3b7720707ce2944b3f673f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*5YruKg3rAvhHrhxKrqKgvA.jpeg"/></div></figure><p id="dba2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.接下来，我们将在左侧和右侧选择项目类型。我们想要的是一个<strong class="kb jd">ASP.NET核心网络应用</strong>。在右侧，选择<strong class="kb jd">ASP.NET核心网络应用</strong>。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/81f3b576c541a443dc2ab73da35a9ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*jbPw6U41pct8KQGyJi6p9A.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">屏幕的左侧</figcaption></figure><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/eb9fbe313646f9e0a432a17666b60363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*gLbBUPqEWviQc4WJw7QFcg.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">屏幕右侧</figcaption></figure><p id="178b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.点击旁边的<strong class="kb jd">，输入项目的<strong class="kb jd">名称</strong>和项目所在的<strong class="kb jd">位置</strong>。我给自己起的名字是<strong class="kb jd"> ReadExcel </strong>。完成后点击<strong class="kb jd">创建</strong>。</strong></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi od"><img src="../Images/0004572ccaad0f4ba1859a4cb1c70645.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*Qc2Vo619dEzjwAlwYjgrIA.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">项目名称和地点</figcaption></figure><p id="4446" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.最后，我们选择我们想要的Web应用程序的类型。在我们的例子中，我们想要<strong class="kb jd"> Web应用程序(模型-视图-控制器)。</strong>然后点击<strong class="kb jd">创建</strong>。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oe"><img src="../Images/6c86310caf24c0306dea8179f58ad982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ob3RvP-nGuo7Y8WHOS-fkg.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">MVC应用程序</figcaption></figure><p id="d695" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在一个<a class="ae ls" href="https://www.geeksforgeeks.org/mvc-design-pattern/" rel="noopener ugc nofollow" target="_blank"> MVC </a>应用程序中，我们使用<strong class="kb jd">模型</strong>来描述我们的数据。<strong class="kb jd">控制器</strong>获取我们的数据(并且通常操纵数据。)的<strong class="kb jd">视图</strong>来显示我们的数据。</p><p id="cebf" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们的数据将是一个Excel文件中的用户列表。我们希望在控制器中读取Excel文件，并在网页视图中显示用户。</p><h1 id="d79b" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">创建Excel文件</h1><p id="b695" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated">首先创建一个包含以下(或类似)数据的excel文件，并在应用程序的根目录下保存为<strong class="kb jd"> Users.xlsx </strong>。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/cad8e47524f1319041714220a2f295f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*p-1Frp-4s_ycvsaVydpvaw.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Users.xlsx</figcaption></figure><p id="d05f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">查看解决方案资源管理器，您的文件结构应该如下所示，</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/6cece393ed304ff7c01f4cb5ae027449.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*YsIDmyBXZ96RcLfd74QzbQ.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">根目录中的Users.xlsx</figcaption></figure><p id="66bc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将首先创建一个控制器，稍后将对其进行修改。我们的模型和视图，后面也会修改。</p><h2 id="0c5b" class="nl mj it bd mk nm nn dn mo no np dp ms kk nq nr mw ko ns nt na ks nu nv ne iz bi translated">创建控制器</h2><p id="9ee7" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated">Excel文件的读取将在控制器文件中完成。我们可以使用现有的HomeController.cs，但是让我们创建自己的<strong class="kb jd"> UserController </strong>。</p><ol class=""><li id="f236" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw nz lz ma mb bi translated">在解决方案浏览器中，右击控制器文件夹并选择<strong class="kb jd">添加</strong>，然后选择<strong class="kb jd">控制器</strong>。现在选择如下所示的控制器类型，并点击<strong class="kb jd">添加</strong>。根据您的使用情况，这些控制器类型中的每一种都用有用的方法填充控制器。</li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/031d676909c9a79dfbcb0fdc52349ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*nxqTE7PBfGqgf9Gpc_6PDQ.jpeg"/></div></figure><p id="005a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.然后键入单词<strong class="kb jd"> User </strong>代替<strong class="kb jd"> Default </strong>，保留单词Controller。点击<strong class="kb jd">添加</strong>。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi om"><img src="../Images/207a73b3130b255b07a4cf4cdff13cb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*vcgCBnnP23L3gSA0aB-r4A.jpeg"/></div></figure><p id="7d7d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在解决方案资源管理器中，打开<strong class="kb jd">user controller . cs</strong>。注意它只有一个方法。这是默认的HTTP GET方法。换句话说，当用户运行我们的应用程序时，这是默认运行的方法，并提供给我们的页面。</p><p id="5571" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们的页面将是简单的，只包含一个从Excel文件获取数据的按钮。然而，在点击按钮之后，我们已经启动了一个HTTP POST。因此，我们稍后需要创建一个HTTP POST方法来读取Excel文件，并将数据发送到视图进行显示。</p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="d6af" class="nl mj it oo b gy os ot l ou ov">using System;<br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using System.Threading.Tasks;<br/>using Microsoft.AspNetCore.Mvc;</span><span id="4283" class="nl mj it oo b gy ow ot l ou ov">namespace ReadExcel.Controllers<br/>{<br/>    public class UserController : Controller<br/>    {<br/>        // Default GET method<br/>        public IActionResult Index()<br/>        {<br/>            return View();<br/>        }<br/>    }<br/>}</span></pre><h2 id="f249" class="nl mj it bd mk nm nn dn mo no np dp ms kk nq nr mw ko ns nt na ks nu nv ne iz bi translated">创建我们的模型</h2><p id="9be5" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated">接下来，我们将创建我们的模型。这是Users.xlsx中包含我们每个用户的内容。</p><ol class=""><li id="d727" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw nz lz ma mb bi translated">右键单击<strong class="kb jd">型号</strong>文件夹。选择<strong class="kb jd">添加</strong>然后<strong class="kb jd">新增物品… </strong>选择<strong class="kb jd">类别。</strong>在<strong class="kb jd">底部</strong>输入名称<strong class="kb jd"> UserModel.cs </strong>，点击<strong class="kb jd">添加</strong>。</li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/9c95587b6348cfd8fd152e93b478a7a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*92FZM8g3T6O2VYFpoixXBA.jpeg"/></div></figure><p id="df14" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.修改<strong class="kb jd">用户模型. cs </strong>来包含我们的用户模型。</p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="237d" class="nl mj it oo b gy os ot l ou ov">using System;<br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using System.Threading.Tasks;</span><span id="4693" class="nl mj it oo b gy ow ot l ou ov">namespace ReadExcel.Models<br/>{<br/>   <strong class="oo jd"> public class UserModel<br/>    {<br/>        public string Name { get; set; }<br/>        public string Email { get; set; }<br/>        public string Phone { get; set; }</strong></span><span id="ebce" class="nl mj it oo b gy ow ot l ou ov"><strong class="oo jd">    }</strong><br/>}</span></pre><p id="f39b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="mh">当我们读取文件时，我们将为Users.xlsx中的每个用户创建一个该类的实例。</em></p><h2 id="ace0" class="nl mj it bd mk nm nn dn mo no np dp ms kk nq nr mw ko ns nt na ks nu nv ne iz bi translated">创建视图</h2><p id="4182" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated">我们将创建我们的视图，在一个<strong class="kb jd">用户</strong>文件夹中命名为<strong class="kb jd"> Index.cshtml </strong>。</p><p id="4424" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="mh">如果您现在运行您的应用程序，您将获得包含在Views/Home文件夹的Index.cshtml中的标记。</em></p><ol class=""><li id="7c2a" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw nz lz ma mb bi translated">右键点击<strong class="kb jd">视图</strong>，选择<strong class="kb jd">添加</strong>，然后选择<strong class="kb jd">新建文件夹</strong>。将其命名为<strong class="kb jd">用户。</strong></li><li id="7169" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw nz lz ma mb bi translated">右击<strong class="kb jd">用户</strong>文件夹选择<strong class="kb jd">添加</strong>然后<strong class="kb jd">查看</strong>。使用下面的选项。</li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/4f4f6ebfad2ff180e0bb35a950628ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*-n8hzIFFnffdmixddcVO8g.jpeg"/></div></figure><p id="d9f4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们想修改这个以适应我们的目的。这将包含一些HTML标记以及Razor语法。</p><ol class=""><li id="86c2" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw nz lz ma mb bi translated">打开<strong class="kb jd">用户</strong>文件夹中的<strong class="kb jd"> Index.cshtml </strong>。用下面的HTML和Razor替换任何现有的标记。</li></ol><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="b279" class="nl mj it oo b gy os ot l ou ov"><a class="ae ls" href="http://twitter.com/using" rel="noopener ugc nofollow" target="_blank">@using</a> ReadExcel.Models<br/><a class="ae ls" href="http://twitter.com/model" rel="noopener ugc nofollow" target="_blank">@model</a> IEnumerable&lt;<strong class="oo jd">UserModel</strong>&gt;<br/>@{<br/>    Layout = null;<br/>}</span><span id="8269" class="nl mj it oo b gy ow ot l ou ov">&lt;!DOCTYPE html&gt;</span><span id="f99e" class="nl mj it oo b gy ow ot l ou ov">&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;meta name="viewport" content="width=device-width" /&gt;<br/>    &lt;title&gt;Users&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>  <strong class="oo jd">  </strong><a class="ae ls" href="http://twitter.com/using" rel="noopener ugc nofollow" target="_blank"><strong class="oo jd">@using</strong></a><strong class="oo jd"> (Html.BeginForm("Index", "User", FormMethod.Post))</strong></span><span id="a4a8" class="nl mj it oo b gy ow ot l ou ov">    {<br/>      <strong class="oo jd">&lt;input type="submit" value="Get Users" /&gt;</strong><br/>    }<br/>   <strong class="oo jd"> </strong><a class="ae ls" href="http://twitter.com/if" rel="noopener ugc nofollow" target="_blank"><strong class="oo jd">@if</strong></a><strong class="oo jd"> (Model.Count() &gt; 0)</strong><br/>    {<br/>        &lt;hr /&gt;<br/>        &lt;table cellpadding="0" cellspacing="0" border="1"&gt;<br/>            &lt;tr&gt;<br/>                &lt;th&gt;Name&lt;/th&gt;<br/>                &lt;th&gt;Phone&lt;/th&gt;<br/>                &lt;th&gt;Email&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>           <strong class="oo jd"> </strong><a class="ae ls" href="http://twitter.com/foreach" rel="noopener ugc nofollow" target="_blank"><strong class="oo jd">@foreach</strong></a><strong class="oo jd"> (UserModel user in Model)</strong><br/>            {<br/>                &lt;tr&gt;<br/>                    &lt;td&gt;<a class="ae ls" href="http://twitter.com/user" rel="noopener ugc nofollow" target="_blank">@user</a>.Name&lt;/td&gt;<br/>                    &lt;td&gt;<a class="ae ls" href="http://twitter.com/user" rel="noopener ugc nofollow" target="_blank">@user</a>.Email&lt;/td&gt;<br/>                    &lt;td&gt;<a class="ae ls" href="http://twitter.com/user" rel="noopener ugc nofollow" target="_blank">@user</a>.Phone&lt;/td&gt;<br/>                &lt;/tr&gt;<br/>            }<br/>        &lt;/table&gt;<br/>    }</span><span id="f56a" class="nl mj it oo b gy ow ot l ou ov">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3340" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">以下注意事项。</p><p id="501e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在顶部，我们告诉它预期的模型，UserModel。</p><p id="19a1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">当应用程序第一次运行时，它将调用UserController中的当前索引方法。这是一个GET方法，它将提供视图，该视图只包含一个按钮。我们将不得不编写另一个方法来处理由单击按钮触发的POST，这也将是索引，但将被标记为POST，并能够接受表单数据。</p><p id="8055" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">此外，当最初访问该页面时，它将期待模型数据。这个看剃刀标记就知道了，<strong class="kb jd"> @if(型号。Count() &gt; 0)。</strong>我们希望确保它在首次加载时不会试图显示任何数据。只有表单按钮。</p><p id="a5dc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">此页面需要用户模型数据。然而，现在我们的用户(控制器)索引方法没有向视图传递任何用户模型数据。为了解决这个问题，我们将传递一个空列表。</p><p id="0182" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">打开<strong class="kb jd"> UserController </strong>，修改默认的GET <strong class="kb jd"> Index </strong>方法如下。注意新的using语句。没有这个，它就不知道什么是用户模型。我还添加了[HttpGet]来更清楚地说明这个方法的作用。注意return语句现在返回一个空的UserModel列表(空的用户列表。)所以第一次访问时，只会显示“获取用户”提交按钮，因为<strong class="kb jd"> @if (Model。Count() &gt; 0) </strong>将为假。</p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="303a" class="nl mj it oo b gy os ot l ou ov">using System;<br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using System.Threading.Tasks;<br/>using Microsoft.AspNetCore.Mvc;<br/><strong class="oo jd">using ReadExcel.Models;</strong></span><span id="ea6c" class="nl mj it oo b gy ow ot l ou ov">namespace ReadExcel.Controllers<br/>{<br/>    public class UserController : Controller<br/>    {<br/>        [HttpGet]<br/>        public IActionResult Index()<br/>        {<br/>           <strong class="oo jd"> return View(new List&lt;UserModel&gt;());</strong><br/>        }</span><span id="e869" class="nl mj it oo b gy ow ot l ou ov">}<br/>}</span></pre><p id="0f21" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">再改一下，我们就可以试运行了。我希望这是默认路由，而不是HomeController。</p><p id="de56" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在解决方案资源管理器的底部，打开Startup.cs底部的<strong class="kb jd"> Startup.cs. </strong>我们会告诉它默认使用User(Controller)和GET Index方法。</p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="2541" class="nl mj it oo b gy os ot l ou ov">app.UseMvc(routes =&gt;<br/>  {<br/>      routes.MapRoute(<br/>          name: "default",<br/>          template: "{<strong class="oo jd">controller=User</strong>}/{action=Index}/{id?}");<br/>  });</span></pre><p id="9de2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">运行您的解决方案。虽然不够优雅，但它应该显示一个“获取用户”按钮。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oz"><img src="../Images/a30ace0bdc41d8712cb29cde4ff74157.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*RagR3UzbSlAnJz19enMsHA.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">在<a class="ae ls" href="http://twitter.com/using" rel="noopener ugc nofollow" target="_blank">里面@使用</a> (Html。BeginForm("Index "，" User "，FormMethod。Post))</figcaption></figure><h2 id="7d82" class="nl mj it bd mk nm nn dn mo no np dp ms kk nq nr mw ko ns nt na ks nu nv ne iz bi translated">读取和显示Excel数据</h2><p id="2392" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated">此时，我们需要安装两个<strong class="kb jd"> NuGet </strong>包。</p><ul class=""><li id="6836" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw ly lz ma mb bi translated">ExcelDataReader将允许我们读取数据。</li><li id="082a" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw ly lz ma mb bi translated">系统。文本.编码.代码页</li></ul><p id="4c16" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">第二个是一个不幸的副作用。net core默认不包括正确的编码，如. NET. </p><p id="70a0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">转到项目并选择<strong class="kb jd">管理NuGet包</strong>。分别浏览和安装。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi pa"><img src="../Images/4e5b3d83d0842c863176778e8bd8fd43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0L-4Mfbz34FwCPbewfuBw.jpeg"/></div></div></figure><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi pb"><img src="../Images/c9b76c941f37bf210f05a7bed3042b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jvXv6BNLT9Du3tOqI2BaeQ.jpeg"/></div></div></figure><p id="9793" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">修改UserController读取Users.xlsx </strong></p><p id="1369" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">打开<strong class="kb jd">用户控制器</strong>。我们需要编写当点击“获取用户”按钮时将被访问的POST方法。在这里，我们将读取Users.xlsx并向视图返回一个用户模型数据列表。</p><p id="1e28" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在现有的GET Index方法下添加以下代码。</p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="2b23" class="nl mj it oo b gy os ot l ou ov">[HttpPost]<br/>public IActionResult Index(IFormCollection form)<br/>{<br/>    List&lt;UserModel&gt; users = new List&lt;UserModel&gt;();</span><span id="0167" class="nl mj it oo b gy ow ot l ou ov">    var fileName = "./Users.xlsx";</span><span id="2b75" class="nl mj it oo b gy ow ot l ou ov">// For .net core, the next line requires the NuGet package, <br/>// System.Text.Encoding.CodePages<br/>    System.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);</span><span id="4e0b" class="nl mj it oo b gy ow ot l ou ov">using (var stream = System.IO.File.Open(fileName, FileMode.Open, FileAccess.Read))<br/>    {<br/>        using (var reader = ExcelReaderFactory.CreateReader(stream))<br/>        {<br/>                    <br/>            while (reader.Read()) //Each row of the file<br/>            {<br/>                users.Add(new UserModel<br/>                {<br/>                    Name = reader.GetValue(0).ToString(),<br/>                    Email = reader.GetValue(1).ToString(),<br/>                    Phone = reader.GetValue(2).ToString()</span><span id="fc3c" class="nl mj it oo b gy ow ot l ou ov">});</span><span id="9e87" class="nl mj it oo b gy ow ot l ou ov">}</span><span id="9ab7" class="nl mj it oo b gy ow ot l ou ov">}<br/>}</span><span id="8401" class="nl mj it oo b gy ow ot l ou ov">return View(users);</span><span id="9cb8" class="nl mj it oo b gy ow ot l ou ov">}</span></pre><p id="9178" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">这段代码接受表单数据(这只是一个按钮)，然后打开一个指向Users.xlsx文件的流。</p><p id="8d57" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">对于每一行，用户模型的一个实例被填充并添加到用户模型列表中。</p><p id="1b11" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">最后，在return语句中将users传递给视图Index.cshtml。从模特开始。Count()&gt;0，数据显示在表格中。</p><p id="9676" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">运行您的解决方案，然后单击“获取用户”按钮。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oz"><img src="../Images/a30ace0bdc41d8712cb29cde4ff74157.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*RagR3UzbSlAnJz19enMsHA.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">初始获取</figcaption></figure><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/570f07eaf1fa1e803eed1cc01c8b2e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*4pEcEYs86T5LZD3JfJ1vLg.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">发布结果</figcaption></figure><p id="2d14" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">完整的代码如下。</p><h1 id="ede6" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">结论</h1><p id="c595" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated">在本教程中，我们学习了如何创建一个ASP.NET核心MVC Web应用程序。这允许我们探索模型、视图和控制器的概念。当然，作为我们的主要目标，我们学习了如何从Excel文件中读取数据。</p><p id="43f6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我会鼓励你用以下方式拓展和探索。</p><ul class=""><li id="6226" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw ly lz ma mb bi translated">更改Excel文件中的数据。</li><li id="a2f1" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw ly lz ma mb bi translated">更改模型以符合Excel文件。</li><li id="ad96" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw ly lz ma mb bi translated">提高。cshtml文件并更详细地研究Razor标记。</li><li id="598b" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw ly lz ma mb bi translated">提高代码的模块化。</li></ul><p id="fd58" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">感谢阅读，继续学习！</strong></p><p id="77ad" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在Medium上阅读所有你想要的文章，并通过成为Medium会员来帮助我继续写作，每月只需5美元。</p><div class="pd pe gp gr pf pg"><a href="https://bobtomlin-70659.medium.com/membership" rel="noopener follow" target="_blank"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd jd gy z fp pl fr fs pm fu fw jc bi translated">通过我的推荐链接加入灵媒——重力井(罗伯·汤姆林)</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">bobtomlin-70659.medium.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu ld pg"/></div></div></a></div><p id="a717" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">额外资源</p><ul class=""><li id="13fb" class="lt lu it kb b kc kd kg kh kk lv ko lw ks lx kw ly lz ma mb bi translated"><a class="ae ls" href="https://www.geeksforgeeks.org/mvc-design-pattern/" rel="noopener ugc nofollow" target="_blank">模型视图控制器</a></li><li id="d4a6" class="lt lu it kb b kc mc kg md kk me ko mf ks mg kw ly lz ma mb bi translated"><a class="ae ls" href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/razor?view=aspnetcore-3.1" rel="noopener ugc nofollow" target="_blank">ASP.NET核心的Razor语法</a></li></ul><p id="1be4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">你也可以享受，</p><div class="pd pe gp gr pf pg"><a href="https://medium.com/javascript-in-plain-english/how-to-read-an-excel-file-in-node-js-6e669e9a3ce1" rel="noopener follow" target="_blank"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd jd gy z fp pl fr fs pm fu fw jc bi translated">如何在Node.js中读取Excel文件</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">这再简单不过了</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">medium.com</p></div></div><div class="pp l"><div class="pv l pr ps pt pp pu ld pg"/></div></div></a></div><div class="pd pe gp gr pf pg"><a rel="noopener  ugc nofollow" target="_blank" href="/creating-an-asp-net-core-restful-web-api-62b3a5a90ba5"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd jd gy z fp pl fr fs pm fu fw jc bi translated">创建ASP.NET核心(RESTful) Web API</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">探索HTTP动词并执行CRUD操作</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pp l"><div class="pw l pr ps pt pp pu ld pg"/></div></div></a></div><h1 id="879c" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">完全码</h1><p id="e57f" class="pw-post-body-paragraph jz ka it kb b kc ng ke kf kg nh ki kj kk ni km kn ko nj kq kr ks nk ku kv kw im bi translated"><strong class="kb jd">型号(用户型号)</strong></p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="ba97" class="nl mj it oo b gy os ot l ou ov">using System;<br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using System.Threading.Tasks;</span><span id="d15b" class="nl mj it oo b gy ow ot l ou ov">namespace ReadExcel.Models<br/>{<br/>    public class UserModel<br/>    {<br/>        public string Name { get; set; }<br/>        public string Email { get; set; }<br/>        public string Phone { get; set; }</span><span id="99f5" class="nl mj it oo b gy ow ot l ou ov">}<br/>}</span></pre><p id="a86f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">视图(User/Index.cshtml) </strong></p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="3e4d" class="nl mj it oo b gy os ot l ou ov"><a class="ae ls" href="http://twitter.com/using" rel="noopener ugc nofollow" target="_blank">@using</a> ReadExcel.Models<br/><a class="ae ls" href="http://twitter.com/model" rel="noopener ugc nofollow" target="_blank">@model</a> IEnumerable&lt;UserModel&gt;</span><span id="afd2" class="nl mj it oo b gy ow ot l ou ov">@{<br/>    Layout = null;<br/>}</span><span id="e130" class="nl mj it oo b gy ow ot l ou ov">&lt;!DOCTYPE html&gt;</span><span id="8845" class="nl mj it oo b gy ow ot l ou ov">&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;meta name="viewport" content="width=device-width" /&gt;<br/>    &lt;title&gt;Users&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    <a class="ae ls" href="http://twitter.com/using" rel="noopener ugc nofollow" target="_blank">@using</a> (Html.BeginForm("Index", "User", FormMethod.Post))</span><span id="4d67" class="nl mj it oo b gy ow ot l ou ov">{</span><span id="b5be" class="nl mj it oo b gy ow ot l ou ov">&lt;input type="submit" value="Get Users" /&gt;<br/>    }<br/>    <a class="ae ls" href="http://twitter.com/if" rel="noopener ugc nofollow" target="_blank">@if</a> (Model.Count() &gt; 0)<br/>    {<br/>        &lt;hr /&gt;<br/>        &lt;table cellpadding="0" cellspacing="0" border="1"&gt;<br/>            &lt;tr&gt;<br/>                &lt;th&gt;Name&lt;/th&gt;<br/>                &lt;th&gt;Phone&lt;/th&gt;<br/>                &lt;th&gt;Email&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>            <a class="ae ls" href="http://twitter.com/foreach" rel="noopener ugc nofollow" target="_blank">@foreach</a> (UserModel user in Model)<br/>            {<br/>                &lt;tr&gt;<br/>                    &lt;td&gt;<a class="ae ls" href="http://twitter.com/user" rel="noopener ugc nofollow" target="_blank">@user</a>.Name&lt;/td&gt;<br/>                    &lt;td&gt;<a class="ae ls" href="http://twitter.com/user" rel="noopener ugc nofollow" target="_blank">@user</a>.Email&lt;/td&gt;<br/>                    &lt;td&gt;<a class="ae ls" href="http://twitter.com/user" rel="noopener ugc nofollow" target="_blank">@user</a>.Phone&lt;/td&gt;<br/>                &lt;/tr&gt;<br/>            }<br/>        &lt;/table&gt;<br/>    }</span><span id="ae4e" class="nl mj it oo b gy ow ot l ou ov">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="fc3d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">控制器(用户控制器)</strong></p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="bd2f" class="nl mj it oo b gy os ot l ou ov">using System;<br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using System.Threading.Tasks;<br/>using Microsoft.AspNetCore.Mvc;<br/>using ReadExcel.Models;<br/>using Microsoft.AspNetCore.Http;<br/>using ExcelDataReader;<br/>using System.Data;<br/>using System.IO;</span><span id="619f" class="nl mj it oo b gy ow ot l ou ov">namespace ReadExcel.Controllers<br/>{<br/>public class UserController : Controller<br/>{<br/>    [HttpGet]<br/>    public IActionResult Index()<br/>    {<br/>        return View(new List&lt;UserModel&gt;());<br/>    }</span><span id="0902" class="nl mj it oo b gy ow ot l ou ov">[HttpPost]<br/>    public IActionResult Index(IFormCollection form)<br/>    {<br/>        List&lt;UserModel&gt; users = new List&lt;UserModel&gt;();</span><span id="5bbb" class="nl mj it oo b gy ow ot l ou ov">var fileName = "./Users.xlsx";</span><span id="6095" class="nl mj it oo b gy ow ot l ou ov">// For .net core, the next line requires NuGet package, <br/>        // System.Text.Encoding.CodePages<br/>        System.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);<br/>        using (var stream = System.IO.File.Open(fileName, FileMode.Open, FileAccess.Read))<br/>        {<br/>            using (var reader = ExcelReaderFactory.CreateReader(stream))<br/>            {<br/>                    <br/>                while (reader.Read()) //Each ROW<br/>                {<br/>                    users.Add(new UserModel<br/>                    {<br/>                        Name = reader.GetValue(0).ToString(),<br/>                        Email = reader.GetValue(1).ToString(),<br/>                        Phone = reader.GetValue(2).ToString()</span><span id="9f09" class="nl mj it oo b gy ow ot l ou ov">});</span><span id="804b" class="nl mj it oo b gy ow ot l ou ov">}</span><span id="946f" class="nl mj it oo b gy ow ot l ou ov">}<br/>}</span><span id="7893" class="nl mj it oo b gy ow ot l ou ov">return View(users);</span><span id="5b24" class="nl mj it oo b gy ow ot l ou ov">}</span><span id="1cb9" class="nl mj it oo b gy ow ot l ou ov">}<br/>}</span></pre><p id="a8c6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">更改Startup.cs路线</strong></p><pre class="ky kz la lb gt on oo op oq aw or bi"><span id="4ed1" class="nl mj it oo b gy os ot l ou ov">app.UseMvc(routes =&gt;<br/>  {<br/>      routes.MapRoute(<br/>          name: "default",<br/>          template: "{<strong class="oo jd">controller=User</strong>}/{action=Index}/{id?}");<br/>  });</span></pre></div></div>    
</body>
</html>