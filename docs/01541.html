<html>
<head>
<title>Creating a Swiping Button in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter中创建滑动按钮</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-a-swiping-button-in-flutter-35106e38034b?source=collection_archive---------8-----------------------#2020-01-11">https://levelup.gitconnected.com/creating-a-swiping-button-in-flutter-35106e38034b?source=collection_archive---------8-----------------------#2020-01-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0bfd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">嗨伙计们！我已经有一段时间没有写一篇激动人心的文章了。事实上，我现在缺少关于Flutter的话题，所以如果你对我应该写什么有建议，请随意在下面的评论区添加建议。</p><p id="a4d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将介绍如何在Flutter中制作滑动按钮。下面这个视频上看起来像这个优步司机app的那个(7点58分，会刷按钮):</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="kt ku l"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">优步司机应用程序中的滑动按钮示例</figcaption></figure><p id="5de6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文中教程的最终结果将是这样的。它所做的是用户滑动按钮部件到足够滑动的宽度的某个百分比。如果滑动的时间不够长，按钮会回到原来的状态。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/00f63c7726a65e3a2de232ab6b00e1ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*N4KBdZhsT28s6d8tdruqWg.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">本教程的最终结果</figcaption></figure><p id="be1f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，如果您喜欢直接查看代码，可以在我的GitHub知识库中找到。</p><div class="lc ld gp gr le lf"><a href="https://github.com/blackmenthor/flutter-swiping-button-sample" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd iu gy z fp lk fr fs ll fu fw is bi translated">黑色/颤动-滑动-按钮-样本</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">一个新的带有滑动按钮的颤振应用程序。这个项目是颤振应用的起点。几个…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">github.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt la lf"/></div></div></a></div></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="510c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好吧，首先。我还没有发现一个可以自己检测滑动的Flutter小部件，所以我们必须创建一个。</p><p id="0a6a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，创建一个名为<code class="fe mb mc md me b">SwipeableWidget</code>的<code class="fe mb mc md me b">StatefulWidget</code>。然后，为这个小部件创建4个变量。</p><ul class=""><li id="46c8" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated">一个<code class="fe mb mc md me b">Widget</code>，我们姑且称之为孩子。这个小部件将是这个<code class="fe mb mc md me b">SwipeableWidget</code>的子部件，并且将是用户在其上滑动的小部件。例如，在滑动按钮中，按钮将是子按钮。</li></ul><pre class="ko kp kq kr gt mo me mp mq aw mr bi"><span id="0065" class="ms mt it me b gy mu mv l mw mx">final Widget child</span></pre><ul class=""><li id="3dc4" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated">一个<code class="fe mb mc md me b">double</code>，我们姑且称之为高度。这个小部件需要知道它应该画多少高度，否则它将是不可见的</li></ul><pre class="ko kp kq kr gt mo me mp mq aw mr bi"><span id="932a" class="ms mt it me b gy mu mv l mw mx">final double height</span></pre><ul class=""><li id="aa6b" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated">一个<code class="fe mb mc md me b">VoidCallback</code>，我们就叫它一个<code class="fe mb mc md me b">onSwipeCallback</code>。一旦用户在这个小部件上充分滑动，这个回调将被调用。</li></ul><pre class="ko kp kq kr gt mo me mp mq aw mr bi"><span id="775a" class="ms mt it me b gy mu mv l mw mx">final VoidCallback onSwipeCallback</span></pre><ul class=""><li id="f02f" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated">一个<code class="fe mb mc md me b">double</code>，我们就叫它一个<code class="fe mb mc md me b">swipePercentageNeeded</code>。这将是用户应该刷卡的百分比，因此回调会被调用，如果用户刷卡低于这个数字，回调不会被调用。该值默认为小部件总宽度的0.75%。</li></ul><pre class="ko kp kq kr gt mo me mp mq aw mr bi"><span id="1201" class="ms mt it me b gy mu mv l mw mx">final double swipePercentageNeeded</span></pre><p id="639b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们需要添加一个<code class="fe mb mc md me b">SingleTickerProviderMixin</code>到这个部件的状态，因为我们需要动画这个部件来模拟滑动。</p><p id="34f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，我们需要为状态创建三个变量，分别是标记滑动开始的<code class="fe mb mc md me b">AnimationController</code>、<code class="fe mb mc md me b">_dxStartPosition</code>和标记滑动结束的最后一个<code class="fe mb mc md me b">_dxEndPosition</code>。</p><p id="4b0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们需要初始化控制器，并将其初始值设置为<code class="fe mb mc md me b">1.0</code>。所以现在，我们的代码应该是这样的。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="my ku l"/></div></figure><p id="9083" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，我们应该在小部件本身上实现小部件的逻辑。主要我们将为此使用一个<code class="fe mb mc md me b">GestureDetector</code>，并且我们将通过使用<code class="fe mb mc md me b">onPanStart</code>、<code class="fe mb mc md me b">onPanUpdate</code>、<code class="fe mb mc md me b">onPanEnd</code>来利用其检测滑动的能力。它看起来会像这样。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="my ku l"/></div></figure><p id="f38e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我会试着解释它的作用。</p><ul class=""><li id="d49c" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe mb mc md me b">onPanStart</code></li></ul><p id="141a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将把<code class="fe mb mc md me b">_dxStartPosition</code>设置到用户开始滑动的位置。我们将它设置为<code class="fe mb mc md me b">details.localPosition.dx</code></p><ul class=""><li id="f5f7" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe mb mc md me b">onPanUpdate</code></li></ul><p id="9297" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，我们将只计算用户在小部件的开始部分之间的滑动，在这种情况下，它将是小部件宽度的0–0.25%开始部分。</p><p id="053a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们还将更新<code class="fe mb mc md me b">_dxEndsPosition</code>，并且我们还将更新控制器的值来激活小部件。</p><ul class=""><li id="c86b" class="mf mg it js b jt ju jx jy kb mh kf mi kj mj kn mk ml mm mn bi translated"><code class="fe mb mc md me b">onPanEnd</code></li></ul><p id="9b1a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要检查用户完成的滑动是否足够。如果是这样，我们将动画这个部件，这样它将被隐藏。如果没有，我们会让它回到初始值。</p><p id="5192" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在此之后，我们将添加一个小部件，将滑动动画。在本例中，我们将使用一个<code class="fe mb mc md me b">FractionallySizedBox</code>。它所做的，基本上是通过我们想要的宽度因子来显示部件的一部分。比如我们之前根据用户滑动设置的控制器值。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="my ku l"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="6cf6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，我们将创建<code class="fe mb mc md me b">SwipingButton</code>小部件。这个小部件非常简单，因为它将实现我们在<code class="fe mb mc md me b">SwipeableWidget</code>中所做的事情。它将有一个<code class="fe mb mc md me b">SwipeableWidget</code>和一个背景小部件，它们将被放在一个<code class="fe mb mc md me b">Stack</code>中。我们需要一个背景部件，以便当刷卡完成时，将有一个背景颜色。它看起来会像这样。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/c5a270aa10cee45aeed948d267d98040.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*uhHdyn1P0J3dWZoBi69XYg.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">滑动按钮的背景</figcaption></figure><p id="311e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们将定义所需的变量。它会有一个<code class="fe mb mc md me b">Text</code>和一个<code class="fe mb mc md me b">onSwipeCallback</code>。它看起来会像这样。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="my ku l"/></div></figure><p id="50e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，我们将创建一个宽度与设备宽度相同的<code class="fe mb mc md me b">Container</code>,因为我们希望它是一个全屏小部件。如果您有不同的要求，您也可以将宽度定义为参数之一。</p><p id="64fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将创建一个高度为<code class="fe mb mc md me b">80.0</code>和<code class="fe mb mc md me b">Colors.greenAccent</code>的<code class="fe mb mc md me b">Container</code>作为背景。</p><pre class="ko kp kq kr gt mo me mp mq aw mr bi"><span id="d410" class="ms mt it me b gy mu mv l mw mx">Container(<br/>  height: 80.0,<br/>  decoration: BoxDecoration(<br/>      color: Colors.<em class="mz">greenAccent</em>,<br/>      borderRadius: BorderRadius.circular(4.0)<br/>  ),<br/>)</span></pre><p id="3c39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我们将在它的上面放一个<code class="fe mb mc md me b">SwipeableWidget</code>,背景是一个容器<code class="fe mb mc md me b">Colors.green</code>。</p><pre class="ko kp kq kr gt mo me mp mq aw mr bi"><span id="3c2e" class="ms mt it me b gy mu mv l mw mx">SwipeableWidget(<br/>  height: 80.0,<br/>  child: Container(<br/>    child: Padding(<br/>      padding: const EdgeInsets.fromLTRB(16, 0, 16, 0),<br/>      child: _buildContent(),<br/>    ),<br/>    height: 80.0,<br/>    decoration: BoxDecoration(<br/>        color: Colors.<em class="mz">green</em>,<br/>        borderRadius: BorderRadius.circular(4.0)<br/>    ),<br/>  ),<br/>  onSwipeCallback: onSwipeCallback,<br/>)</span></pre><p id="9fe6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，它会变成这样。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="my ku l"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="4075" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">瞧啊。既然已经完成了。如果我们想要包含这个小部件，我们需要做的就是在下面插入这段代码。</p><pre class="ko kp kq kr gt mo me mp mq aw mr bi"><span id="a040" class="ms mt it me b gy mu mv l mw mx">@override<br/>Widget build(BuildContext context) {<br/>  return Scaffold(<br/>    appBar: AppBar(<br/>      title: Text(title),<br/>    ),<br/>    body: Center(<br/>      child: Column(<br/>        mainAxisAlignment: MainAxisAlignment.center,<br/>        children: &lt;Widget&gt;[<br/>          SwipingButton(<br/>            text: "SWIPE ME!",<br/>            onSwipeCallback: () =&gt; print("I'M SWIPED!"),<br/>          ),<br/>        ],<br/>      ),<br/>    ),<br/>  );<br/>}</span></pre><p id="5ad0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们都完成了。</p><p id="8b16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我希望这篇文章对那些试图在你的应用中实现这种小部件的人有用。</p><p id="7d22" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您有任何意见、建议或问题。请在下面随意评论，我会尽力回答。</p><p id="ca2e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一篇文章再见！</p><p id="3eb3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">祝你今天开心！玩的开心！</p></div></div>    
</body>
</html>