<html>
<head>
<title>Stop repeating code across functions by using wrappers.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过使用包装器停止跨函数重复代码。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/i-taught-myself-how-to-implement-dry-in-a-dream-1f70507102e2?source=collection_archive---------4-----------------------#2022-07-17">https://levelup.gitconnected.com/i-taught-myself-how-to-implement-dry-in-a-dream-1f70507102e2?source=collection_archive---------4-----------------------#2022-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a86ae8e6f4c84cacbe01784e1bf9d0b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XiXAQdLFUxeTdyOg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">卡罗琳·克里斯汀在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0274" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated">对我来说，梦见编码并不罕见。我经常醒来，对前一天还在纠结的事情有了新的想法。今天早上我从一个类似的梦里醒来；然而，它所引发的顿悟比平常要大得多。</p><h1 id="2a79" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">在顿悟之前</h1><p id="5567" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">随着时间的推移，我已经开始用自己的标准方式编写函数。典型的函数如下所示:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/2a8774aab32e757aeb079e0e0350be86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2dwx1_HsCxnsL7ZWi5ibQ.png"/></div></div></figure><p id="58c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个例子只是给你一个结构的概念。现在，当我创建额外的函数如<code class="fe ms mt mu mv b">getRecords</code>、<code class="fe ms mt mu mv b">addRecord</code>、<code class="fe ms mt mu mv b">updateRecord</code>、<code class="fe ms mt mu mv b">deleteRecord</code>等时，我清洗并重复这个过程。</p><p id="03ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">仅仅使用我的基本例子，<strong class="kf ir">我最终在这些函数中重复了超过90%的代码</strong>。每个函数都有一个<code class="fe ms mt mu mv b">try/catch</code>块。每个函数都有多个<code class="fe ms mt mu mv b">console</code>调用。我知道这并不理想。就是不知道怎么改进。</p><p id="df09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更糟糕的是，我倾向于改变我的标准。这可能像把<code class="fe ms mt mu mv b">catch (error)</code>改成<code class="fe ms mt mu mv b">catch (e)</code>一样愚蠢。然后我的强迫症发作了，接下来的事情你知道，<strong class="kf ir">我花了一个小时到处检查并做这个改变。</strong></p><h1 id="721d" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">顿悟之后</h1><p id="5c81" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">我总是在学习新的概念，最近开始投入大量精力去理解最佳实践，比如一般的坚实原则和设计模式。我认为通过这些概念的例子是点燃我顿悟的火花。</p><p id="c8e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们开始吧…</p><p id="a9bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我想到了这样一个事实，你可以将一个函数作为另一个函数的参数来传递。所以我想看看能不能标准化我的<code class="fe ms mt mu mv b">try/catch</code>块方法。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/402de48f6dc2f9de5f535af359b231de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqV6mjkQKDsJJTsv-cAIYA.png"/></div></div></figure><p id="2bda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，任何时候我想在我的标准<code class="fe ms mt mu mv b">try/catch</code>块中“包装”一个函数，我只需将该函数传递给我的<code class="fe ms mt mu mv b">tryWrapper</code>函数。这种方法的主要优点是:</p><ul class=""><li id="59e7" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated">我的<strong class="kf ir">不再在每个功能中重复</strong> <code class="fe ms mt mu mv b"><strong class="kf ir">try/catch</strong></code> <strong class="kf ir">代码</strong></li><li id="dd22" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">我可以在任何时候改变<code class="fe ms mt mu mv b">tryWrapper</code>并且<strong class="kf ir">这种改变会在任何使用</strong>的地方反映出来</li></ul><p id="d0cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我需要添加记录消息的标准。这里唯一棘手的是，我希望在日志消息中显示主函数的名称。为此，我创建了一个包含我所有“主要功能”的对象。然后，我以类似于我的<code class="fe ms mt mu mv b">tryWrapper</code>的方式创建了一个<code class="fe ms mt mu mv b">logWrapper</code>。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/ed8f61ed14ad121636db6bd8ef04ea20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IoOrJe6vHjQo5aFvwKPajQ.png"/></div></div></figure><h1 id="8321" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">结论</h1><p id="28a1" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">哇！这给这句话带来了一个全新的含义，“我在睡觉的时候也能做到！”</p><p id="be39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这正是我所梦想的！这种方法有很多好处:</p><ul class=""><li id="fbe4" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated">减少代码量</li><li id="e65a" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">减少开发时间</li><li id="0838" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">简化故障排除</li><li id="a4e5" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">提供一个可扩展的框架(例如，我可以添加一个<code class="fe ms mt mu mv b">tryAsyncWrapper()</code>)</li><li id="5959" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">实现几个坚实的原则</li></ul><p id="f9b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的宝贵时间！我总是感谢任何反馈！</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="4273" class="lk ll iq bd lm ln ns lp lq lr nt lt lu lv nu lx ly lz nv mb mc md nw mf mg mh bi translated">分级编码</h1><p id="bd4f" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="e86c" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="3206" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">📰查看<a class="ae kc" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">升级编码</a>中的更多内容</li><li id="d3bb" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">🔔关注我们:<a class="ae kc" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank"> Twitter </a> | <a class="ae kc" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></li><li id="f139" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">🚀👉<a class="ae kc" href="https://jobs.levelup.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">软件工程师的顶级工作</strong> </a></li></ul></div></div>    
</body>
</html>