<html>
<head>
<title>Everything You Should Know About Binding in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于Android绑定你应该知道的一切</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/everything-you-should-know-about-binding-in-android-a8a70bc882f0?source=collection_archive---------9-----------------------#2020-10-03">https://levelup.gitconnected.com/everything-you-should-know-about-binding-in-android-a8a70bc882f0?source=collection_archive---------9-----------------------#2020-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/ffd63ae572bcaf9fbc3198b9e8287f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MFUaRoi9OtxuOYgslUN6g.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Aleks Dorohovich 在<a class="ae jd" href="https://unsplash.com/s/photos/data-binding?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="894a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你好朋友们。我希望你喜欢我的写作，如果你有任何建议让我知道。所以本周，我们将讨论绑定，包括视图和数据绑定。为什么要用，怎么用？<strong class="kf jh"> Empecemos！</strong></p><h1 id="d4cd" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">视图绑定</h1><p id="e478" class="pw-post-body-paragraph kd ke jg kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">视图绑定基本上是一个Jetpack组件。它帮助您简化XML文件和java或kotlin文件之间的关系。</p><p id="7a84" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以不再使用<code class="fe me mf mg mh b">findViewById.</code></p><p id="69cf" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">这是怎么回事？</strong></p><p id="3d5e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤1:在模块中启用viewBinding。</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="893a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，IDE将为您编写的每个XML文件自动创建一个绑定文件。嘣！</p><p id="d2fe" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，给定一个名为<code class="fe me mf mg mh b">result_profile.xml</code>的布局文件:</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="90fd" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">生成的绑定类名将是<code class="fe me mf mg mh b">ResultProfileBinding.</code>,因此命名工作就像，它转换骆驼大小写的文件名，然后添加绑定作为后缀。</p><p id="2e3f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您可以直接访问所有视图id，而无需使用findViewById。</p><p id="3b28" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤2:在活动中使用ViewBinding:</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="102d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在您需要做的就是访问视图:</p><p id="78a7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">binding.name.text = “BOOM”<br/>binding.button.setOnClickListener{<br/>………..<br/>}</code></p><p id="f7ce" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">但是</strong> <code class="fe me mf mg mh b"><strong class="kf jh">viewBinding</strong></code> <strong class="kf jh">和</strong> <code class="fe me mf mg mh b"><strong class="kf jh">dataBinding</strong></code> <strong class="kf jh">有什么不同呢？</strong></p><p id="2b88" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">视图绑定和<a class="ae jd" href="https://developer.android.com/topic/libraries/data-binding" rel="noopener ugc nofollow" target="_blank">数据绑定</a>都生成绑定类，您可以使用它们直接引用视图。但是，视图绑定旨在处理更简单的用例，并提供了优于数据绑定的以下优势:</p><ul class=""><li id="a6b5" class="mo mp jg kf b kg kh kk kl ko mq ks mr kw ms la mt mu mv mw bi translated">更快的编译</li><li id="77ea" class="mo mp jg kf b kg mx kk my ko mz ks na kw nb la mt mu mv mw bi translated">使用方便</li></ul><p id="febd" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相反，与数据绑定相比，视图绑定有以下限制:</p><ul class=""><li id="cbf8" class="mo mp jg kf b kg kh kk kl ko mq ks mr kw ms la mt mu mv mw bi translated">视图绑定不支持布局变量或布局表达式，因此不能用于直接从XML布局文件中声明动态UI内容。</li><li id="6488" class="mo mp jg kf b kg mx kk my ko mz ks na kw nb la mt mu mv mw bi translated">视图绑定不支持双向数据绑定。</li></ul><p id="10b8" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我知道你不熟悉这些术语，继续吧，我会帮助你理解的。</p><h1 id="f373" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据绑定</h1><p id="b833" class="pw-post-body-paragraph kd ke jg kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Android数据绑定提供了一种将UI与业务逻辑联系起来的方法，允许UI值自动更新，无需人工干预。这将从您的文件中删除大量的锅炉板代码，使其更加整洁。</p><p id="d331" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它是如何工作的？</p><p id="24de" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤1:在build.gradle文件中启用数据绑定。</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="dedb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤2:布局和绑定表达式。如何编写支持数据绑定的布局文件？</p><p id="47b8" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据文件略有不同，它开始将布局标签和一些数据变量，您可以使用这些变量来配置您的视图对象中的值。</p><p id="641d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个例子:</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="b64e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里user是一个变量名，它是用户类的类型。</p><p id="fc6c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要在视图中访问这些数据，我们需要使用@ following，后跟花括号和里面的值。例如，在文本视图中，为了显示用户的名字，我们在属性文本中使用了<code class="fe me mf mg mh b">@{user.firstName} </code>。</p><pre class="mi mj mk ml gt nc mh nd ne aw nf bi"><span id="64d2" class="ng lc jg mh b gy nh ni l nj nk">data class User(val firstName: String, val lastName: String)</span></pre><p id="6a77" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">其他变量:</strong></p><pre class="mi mj mk ml gt nc mh nd ne aw nf bi"><span id="194c" class="ng lc jg mh b gy nh ni l nj nk">&lt;data&gt;<br/>    &lt;variable name="user" type="com.example.User"/&gt;<br/>    &lt;variable name="image" type="Drawable"/&gt;<br/>    &lt;variable name="note" type="String"/&gt;<br/>    &lt;variable name="selected" type="Boolean"/&gt;<br/>    &lt;variable name="age" type="int"/&gt;<br/>    &lt;variable name="list" type="List&amp;lt;String&gt;"/&gt;<br/>    &lt;variable name="sparse" type="SparseArray&amp;lt;String&gt;"/&gt;<br/>    &lt;variable name="map" type="Map&amp;lt;String, String&gt;"/&gt;<br/>&lt;/data&gt;</span></pre><p id="3de0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以访问XML中的任何类型的数据，并使用@{}在布局属性中访问它们。</p><p id="32ea" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">导入:</strong> <br/>导入允许我们访问布局文件中的类。例如，在条件的基础上利用视图的可见性。我们将fo这样:<br/> <code class="fe me mf mg mh b">android:visibility="@{age &gt; 13 ? View.GONE : View.VISIBLE}"</code></p><p id="b464" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果年龄大于13，隐藏视图，否则显示它。要访问这个视图类，我们需要将它导入到数据中。</p><pre class="mi mj mk ml gt nc mh nd ne aw nf bi"><span id="a31b" class="ng lc jg mh b gy nh ni l nj nk">&lt;data&gt;<br/>    &lt;import type="android.view.View"/&gt;<br/>&lt;/data&gt;</span></pre><p id="d61b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你也可以导入你的其他类，例如，不要通过完整的路径访问它们，首先导入它们。</p><pre class="mi mj mk ml gt nc mh nd ne aw nf bi"><span id="e35f" class="ng lc jg mh b gy nh ni l nj nk">&lt;data&gt;<br/>    &lt;import type="com.example.User"/&gt;<br/>    &lt;import type="java.util.List"/&gt;<br/>    &lt;variable name="user" type="User"/&gt;<br/>    &lt;variable name="userList" type="List&amp;lt;User&gt;"/&gt;<br/>&lt;/data&gt;</span></pre><p id="5d98" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想访问任何类的方法，在方法中传递一些变量，并在文本视图中显示结果。您也可以通过导入该类来实现这一点。</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="fb4e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">{MyStringUtils.capitalize(user.lastName)}”</code>是大写的字符串和设置内部视图。</p><p id="e6fb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">零合并运算符<br/> </strong>零合并运算符(<code class="fe me mf mg mh b">??</code>)选择左操作数(如果它不是<code class="fe me mf mg mh b">null</code>)或右操作数(如果前者是<code class="fe me mf mg mh b">null</code>)。</p><pre class="mi mj mk ml gt nc mh nd ne aw nf bi"><span id="c10d" class="ng lc jg mh b gy nh ni l nj nk">android:text="@{user.displayName ?? user.lastName}"</span></pre><p id="b9c8" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这在功能上相当于:</p><pre class="mi mj mk ml gt nc mh nd ne aw nf bi"><span id="ae8b" class="ng lc jg mh b gy nh ni l nj nk">android:text="@{user.displayName != null ? user.displayName : user.lastName}"</span></pre><h1 id="8b91" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在活动或片段中绑定数据</h1><p id="3f6d" class="pw-post-body-paragraph kd ke jg kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">一旦在XML文件中添加布局标记，就会为每个布局生成一个绑定类。命名约定就像骆驼大小写字母后跟绑定后缀。</p><p id="cd3f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">activity _ main . XML-&gt; ActivityMainBinding</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="840f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有另一种定义bindind的方法，您可以使用</p><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="2f5f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><variable name="“isUserAvailable”" type="“Boolean”"/></p><p id="ffb1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要从活动中设置XML文件的数据值，请调用<code class="fe me mf mg mh b">binding.setIsUserAvailable(true)</code>。它将设置您的变量值。</p><h1 id="4dff" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">事件处理</strong></h1><ul class=""><li id="cb3c" class="mo mp jg kf b kg lz kk ma ko nl ks nm kw nn la mt mu mv mw bi translated"><strong class="kf jh"> Methopd参考</strong></li></ul><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="314d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了少数例外，事件属性名由侦听器方法的名称决定。</p><p id="c91c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:<code class="fe me mf mg mh b">View.OnClickListener</code>有一个方法<code class="fe me mf mg mh b">onClick()</code>，所以这个事件的属性是<code class="fe me mf mg mh b">android:onClick</code>。</p><figure class="mi mj mk ml gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi no"><img src="../Images/2be499fd697d95752b8e1c937e88e3f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Le3-FmpCo6oVQ2h-W9FZ9g.png"/></div></div></figure><p id="6c59" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">侦听器绑定将在@{handlers::onClickFriend}中完成，其中handlers是一个带有onClickFriend方法的类对象。记住名字应该是相同的。</p><blockquote class="np nq nr"><p id="006d" class="kd ke ns kf b kg kh ki kj kk kl km kn nt kp kq kr nu kt ku kv nv kx ky kz la ij bi translated">如果listener方法不存在，它将给出一个编译时错误。</p></blockquote><ul class=""><li id="bc48" class="mo mp jg kf b kg kh kk kl ko mq ks mr kw ms la mt mu mv mw bi translated"><strong class="kf jh">监听器绑定</strong></li></ul><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><pre class="mi mj mk ml gt nc mh nd ne aw nf bi"><span id="ea38" class="ng lc jg mh b gy nh ni l nj nk">android:onClick="@{(view) -&gt; presenter.onSaveClick(task)}"</span></pre><h1 id="536c" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">示例代码:</h1><figure class="mi mj mk ml gt is"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="a095" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，我们已经了解了如何启用视图绑定和数据绑定。两者是如何相互有利和相互比较的。如何创建支持数据绑定的XML文件？如何导入类以及如何创建数据变量。</p><p id="15f0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">绑定通过去除模板代码，减少活动和片段中的数据表示部分，使布局文件与活动绑定变得容易。</p><p id="6589" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢这篇文章。在下一篇文章中，我们将深入讨论数据绑定。</p><p id="1d36" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">再见了，朋友们！</strong></p></div></div>    
</body>
</html>