<html>
<head>
<title>Prevent CSRF Attacks in Node.JS application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">防止节点中的CSRF攻击。JS应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/prevent-csrf-attacks-in-node-js-application-d71df3704944?source=collection_archive---------0-----------------------#2021-09-30">https://levelup.gitconnected.com/prevent-csrf-attacks-in-node-js-application-d71df3704944?source=collection_archive---------0-----------------------#2021-09-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="97f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将了解为什么我们应该了解这种攻击，这种攻击到底是什么，执行一个简单的CSRF攻击来了解它是如何工作的，最后我们如何保护我们的应用程序免受CSRF攻击。</p><h1 id="29b5" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">为什么我们应该知道CSRF袭击事件？</h1><p id="0f4f" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在开始了解这种攻击是什么之前，我们应该知道这种攻击有多危险。</p><p id="686f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果有人对一个普通用户(没有管理权限)成功执行了<strong class="jp ir"> CSRF攻击</strong>，这个人就能够执行状态更改请求，比如删除账户、转移资金和更改电子邮件地址。</p><p id="8161" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果用户拥有管理权限，攻击者就可以危害整个web应用程序。</p><p id="f383" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我认为我们有足够的线索来挖掘更多关于这次袭击的信息。让我们来看看什么是CSRF攻击。</p><h1 id="630a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">什么是跨站点请求伪造(CSRF)？</h1><blockquote class="lo lp lq"><p id="ef98" class="jn jo lr jp b jq jr js jt ju jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj kk ij bi translated">基于OWASP:跨站点请求伪造(CSRF)是一种攻击，它迫使最终用户在他们当前已通过身份验证的web应用程序上执行不需要的操作。</p></blockquote><p id="20ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种攻击也被称为<strong class="jp ir">一键式攻击</strong>或<strong class="jp ir">会话骑</strong></p><p id="3cbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常这些攻击与<a class="ae lv" href="https://en.wikipedia.org/wiki/Social_engineering_(security)" rel="noopener ugc nofollow" target="_blank">社会工程攻击</a>相结合。例如，他们给我发了一封电子邮件，其中包含一个链接，说你在一次彩票中赢得了10000美元(你知道你没有参与:)，我们需要获得你的信息，请点击下面的链接。该链接将与另一个网站(即您的网站，这里特指Node.js应用程序)进行交互。</p><p id="893c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是CSRF攻击的过程:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi lw"><img src="../Images/088d895df12a7bb08f12b6ae2657d14b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tcXGtN8eeDcFueDX.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">CSRF的进攻是如何完成的</figcaption></figure><p id="c749" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">理解这种攻击的最好方法是执行一个简单的CSRF攻击。</p><h1 id="8789" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">简单的CSRF攻击</h1><p id="e596" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们有一个节点。JS应用程序，它有两个途径让用户通过post请求转账:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">节点。易受CSRF攻击的JS应用程序</figcaption></figure><p id="ee2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有两条路线。第一个是<code class="fe mo mp mq mr b">GET /transfer</code>,这是一个让我们转账的表单，第二个是<code class="fe mo mp mq mr b">POST /transfer</code>,它通过一个名为<code class="fe mo mp mq mr b">isAuthenticated</code>的简单函数验证用户身份，并将钱转账到目的地。</p><p id="cd35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">isAuthenticated</code>功能只是检查一个名为<code class="fe mo mp mq mr b">session</code>的cookie是否与标题一起发送，以及会话是否是“有效用户”。(这不是我们在产品中所做的，但是你可以在一些库中很容易地找到，比如<a class="ae lv" href="https://www.passportjs.org/" rel="noopener ugc nofollow" target="_blank"> passportjs </a>)</p><p id="02c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果用户通过身份验证，我们可以执行传输操作，如果用户没有通过身份验证，我们会收到一个错误的请求作为响应。</p><h2 id="ff82" class="ms km iq bd kn mt mu dn kr mv mw dp kv jy mx my kz kc mz na ld kg nb nc lh nd bi translated">创建一个Cookie作为经过身份验证的用户</h2><p id="151d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">这里我们没有实现登录过程，相反，我们可以手动生成一个cookie来完成这项工作:</p><p id="f185" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行您的节点。使用此命令的JS应用程序:</p><pre class="lx ly lz ma gt ne mr nf ng aw nh bi"><span id="ffac" class="ms km iq mr b gy ni nj l nk nl">node server.js</span></pre><p id="ebd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，应用程序正在端口<code class="fe mo mp mq mr b">4002</code>中运行</p><p id="c486" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要去这条路线:<code class="fe mo mp mq mr b">http://localhost:4002/transfer</code>查app。</p><p id="4548" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在添加任何cookie之前，如果我们尝试发布此表单:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nm"><img src="../Images/57e3f98e7aff89540b535d8a802b98bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XdyrYoEAFDY2MtOBNOltYA.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">没有CSRF令牌的HTML表单</figcaption></figure><p id="fab2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到这样的结果:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nm"><img src="../Images/3a8545e45ae6ee8af069f5aa4c419b58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HVkCVFNzy5uGNwqlQ1cO4w.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">未经验证的用户的结果</figcaption></figure><p id="832f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了手动生成cookie，您需要打开您的浏览器开发工具，右击并点击<code class="fe mo mp mq mr b">inspect</code>，然后打开<code class="fe mo mp mq mr b">console</code>选项卡并运行这行Javascript代码:</p><pre class="lx ly lz ma gt ne mr nf ng aw nh bi"><span id="3f21" class="ms km iq mr b gy ni nj l nk nl">document.cookie="session=valid_user";</span></pre><p id="65b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这之后，我们在<code class="fe mo mp mq mr b">localhost</code>域中有一个cookie，后端认为我们的用户通过了验证，如果我们再次发布该表单，我们会得到以下结果:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nm"><img src="../Images/4fe57d55213f3b534c04d2e75c8c92ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znXGL25Bm-WZtw0T4WtYIQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">认证用户的结果</figcaption></figure><p id="7a1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，在这一点上，我们是一个经过身份验证的用户，我们能够通过将一个表单发送到这个路径来转移资金:<code class="fe mo mp mq mr b">POST /transfer</code></p><h2 id="97f3" class="ms km iq bd kn mt mu dn kr mv mw dp kv jy mx my kz kc mz na ld kg nb nc lh nd bi translated">创建包含表单的电子邮件</h2><p id="3200" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">发送带有所需HTML的电子邮件的简单方法我们可以打开Gmail网站，然后我们需要右键单击电子邮件正文并单击<code class="fe mo mp mq mr b">inspect</code>现在我们可以通过右键单击元素并选择<code class="fe mo mp mq mr b">edit as HTML</code>来编辑电子邮件正文。在这里我们可以输入我们的HTML元素。</p><p id="ff24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们要发送给受害者的电子邮件正文:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">包含隐藏表单的电子邮件正文</figcaption></figure><p id="ceaa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你可能注意到的，我们有两个<strong class="jp ir">隐藏输入和一个</strong>按钮来发布表单。同样在名称为<code class="fe mo mp mq mr b">account</code>的输入中我们可以看到我们输入了<code class="fe mo mp mq mr b">attacker_wallet</code>。</p><p id="dfb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是编辑电子邮件正文的方法:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nn"><img src="../Images/2e3c9a87846280970201da238833af0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dZzVcqODDaAJprcVODo_XA.gif"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">向电子邮件正文添加HTML元素</figcaption></figure><p id="189a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后这是受害者收到的电子邮件。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi no"><img src="../Images/0efe97e7d8ff3fe6d48caf49bab764df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EET4ze-MNRlwkXRjvQSQNA.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">引发CSRF攻击的电子邮件</figcaption></figure><p id="bc8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果我(作为一个经过身份验证的用户)单击该按钮，它会将我重定向到浏览器中的一个新选项卡，并将钱转移到攻击者的钱包中:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi np"><img src="../Images/def2fc169f711449c8f89c74ec0bdce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3XrYQjYqFjGGq7mWailjWQ.gif"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">受害者点击邮件正文中的按钮</figcaption></figure><p id="735a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你知道了CSRF攻击是如何工作的，是时候看看我们如何阻止它了</p><h1 id="69c6" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">通过基于令牌的缓解来防止CSRF攻击</h1><p id="3e76" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">这是我们可以用来防止CSRF袭击的最流行和推荐的方法之一。</p><p id="7212" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将在服务器端生成一个令牌，可以为每个用户会话或每个请求生成一次。每请求令牌比每会话令牌更安全，因为攻击者利用被盗令牌的时间范围是最小的。</p><p id="11c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如<strong class="jp ir"> OWASP </strong>文件所述:</p><p id="e54d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CSRF代币应该是:</p><ul class=""><li id="865a" class="nq nr iq jp b jq jr ju jv jy ns kc nt kg nu kk nv nw nx ny bi translated"><em class="lr">每个用户会话都是唯一的。</em></li><li id="e38d" class="nq nr iq jp b jq nz ju oa jy ob kc oc kg od kk nv nw nx ny bi translated"><em class="lr">秘密</em></li><li id="1a83" class="nq nr iq jp b jq nz ju oa jy ob kc oc kg od kk nv nw nx ny bi translated"><em class="lr">不可预测(由</em> <a class="ae lv" href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#rule---use-cryptographically-secure-pseudo-random-number-generators-csprng" rel="noopener ugc nofollow" target="_blank"> <em class="lr">安全方法</em> </a> <em class="lr">产生的大随机值)。</em></li></ul><p id="d8d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们不打算实现一个CSRF保护库。我们使用<code class="fe mo mp mq mr b">csurf</code>包来生成CSRF令牌，并在后端验证它们。</p><p id="eb78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个库不再被维护了，但幸运的是在撰写本文时它没有任何漏洞。</p><p id="f6aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将像这样改变我们的后端:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">CSRF保护节点。JS应用程序</figcaption></figure><p id="066f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你在第6行看到的，我们添加了<code class="fe mo mp mq mr b">csrfProtection</code>，这里cookie是<code class="fe mo mp mq mr b">true</code>，它也在cookie中传输csrf令牌。</p><p id="0381" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第12行，我们添加了<code class="fe mo mp mq mr b">csrfProtection</code>作为中间件，之后我们能够为表单生成一个CSRF令牌。</p><p id="9ab8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要在<code class="fe mo mp mq mr b">_csrf</code>输入中传递CSRF令牌。</p><p id="97a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们可以通过使用<code class="fe mo mp mq mr b">csrfProtection</code>中间件在第26行验证这个令牌。</p><p id="13ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，如果您将用户会话存储在<code class="fe mo mp mq mr b">session</code> cookie中，CSRF保护会将其令牌与用户会话绑定，从而使您的应用更加安全。</p><p id="7a2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看新的表格和CSRF令牌:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi oe"><img src="../Images/256a030fabcc45e3b0ca965026cfaec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8-35PQUmnk4NR5-cMQGj8w.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">CSRF代币</figcaption></figure><p id="d004" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在是时候再次点击链接了，点击后我们会看到:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi of"><img src="../Images/ad35791d31621e4e7ed1d56fe39a2585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PBzptOLktDWTdzuZQX_h3A.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">无效的CSRF令牌</figcaption></figure><h1 id="945c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">CSRF令牌实现中的弱点</h1><p id="4080" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><strong class="jp ir">验证取决于令牌的存在</strong></p><p id="b05a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在某些应用中，如果令牌不存在，则跳过验证过程。</p><p id="bc86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> CSRF令牌未与用户会话关联</strong></p><p id="2e2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您没有将CSRF令牌与用户会话绑定，某人可以使用另一个人的CSRF令牌来执行恶意操作。在我们使用的库中，如果将cookies中的会话作为<code class="fe mo mp mq mr b">session</code>传递，库会将其绑定到CSRF令牌。如果您使用不同的名称存储会话，您需要在CSRF保护的配置中设置<code class="fe mo mp mq mr b">sessionKey</code>。</p><p id="6fa1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">令牌验证随HTTP方法变化</strong></p><p id="ad4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该检查您令牌验证是否适用于所有HTTP方法。</p><p id="383a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> CSRF令牌被复制到cookie中</strong></p><p id="434e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您必须记录已经使用的令牌。相反，攻击者可以将与每个令牌相关联的请求参数复制到用户的cookie中。在这种设置中，攻击者可以使用应用程序的预期格式创建一个包含令牌的cookie，将其放在用户的浏览器中，然后执行CSRF攻击</p><h1 id="e380" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">结论</h1><p id="d284" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">CSRF攻击是可以通过发送电子邮件和执行社会工程技术来影响许多用户的攻击之一，因此了解这种攻击并通过简单地使用CSRF令牌来防止它是至关重要的。如果您想让它更安全，您需要使用生成此令牌的最佳实践。</p><div class="og oh gp gr oi oj"><a href="https://www.neuralegion.com/blog/cross-site-request-forgery-csrf/" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">跨站点请求伪造(CSRF):影响、实例和预防</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">跨站点请求伪造(CSRF/XSRF)，也称为海上冲浪或会话骑是一个web安全漏洞，它…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">www.neuralegion.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox mg oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://owasp.org/www-community/attacks/csrf" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">跨站点请求伪造(CSRF)</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">作者:KirstenS供稿人:戴夫·威彻斯，戴维斯纽，保罗·皮特菲什，阿达尔·魏德曼，迈克尔·布鲁克斯，阿赫桑·米尔，Dc…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">owasp.org</p></div></div><div class="os l"><div class="oy l ou ov ow os ox mg oj"/></div></div></a></div></div></div>    
</body>
</html>