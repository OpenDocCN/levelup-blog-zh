<html>
<head>
<title>System Design Fundamentals: Load Balancers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">系统设计基础:负载平衡器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/system-design-fundamentals-load-balancers-e608d30afa65?source=collection_archive---------2-----------------------#2022-04-09">https://levelup.gitconnected.com/system-design-fundamentals-load-balancers-e608d30afa65?source=collection_archive---------2-----------------------#2022-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/a06cf7b7f1e1403b2e1a73a365401668.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KyLSNiO7Ud9nkJVr"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">勒内·迪安达在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><p id="852c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">负载平衡是在多台服务器之间分配网络流量的过程。</p><p id="df8d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们是大规模系统中的关键组件。当我们想要扩展系统以处理增加的需求时，负载平衡器通过将负载平衡器放置在客户端和服务器之间来帮助确定和分配应该在不同服务器之间转发流量的位置。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi le"><img src="../Images/44d9fed3cef264d83ba5384fd0f6e25c.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*6GDFRV_mVgbnyac_8Ac4mg.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">负载平衡器将流量分配给两台服务器</figcaption></figure><p id="d09a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当客户端发出请求时，它会转到负载均衡器。然后，负载平衡器将其路由到下一个可用的服务器，以分配负载。这样，就不会有单个服务器因请求而过载，这有助于避免故障或增加系统延迟。</p><p id="ddd3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">负载平衡器还可以在服务器上执行健康检查。如果服务器关闭，负载平衡器将停止向其发送请求，而是将请求分发到其他服务器。这可以防止服务器成为单点故障，从而提高整个系统的可用性和响应能力。</p><p id="d7e4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以在系统的其他地方添加负载平衡器:</p><ul class=""><li id="932d" class="lj lk jj ki b kj kk kn ko kr ll kv lm kz ln ld lo lp lq lr bi translated">在服务器和数据库之间。</li><li id="03bb" class="lj lk jj ki b kj ls kn lt kr lu kv lv kz lw ld lo lp lq lr bi translated">在web服务器和应用服务器之间。</li><li id="d1b3" class="lj lk jj ki b kj ls kn lt kr lu kv lv kz lw ld lo lp lq lr bi translated">在DNS层(单个域名获得多个IP地址，当进行DNS查询以获得IP时，以负载平衡的方式返回IP地址)。</li></ul><h1 id="2ce9" class="lx ly jj bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">负载平衡器如何分配负载？</h1><p id="5b7c" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">负载平衡器使用服务器选择策略来选择将流量分配给哪个服务器。一些常用的策略是:</p><h2 id="37fa" class="na ly jj bd lz nb nc dn md nd ne dp mh kr nf ng ml kv nh ni mp kz nj nk mt nl bi translated">随机位</h2><p id="8e06" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">负载平衡器可以配置为以完全随机的顺序向服务器分发流量。这可能会导致问题，因为如果随机选择某个服务器的频率高于其他服务器，该服务器仍可能会过载。</p><h2 id="47a2" class="na ly jj bd lz nb nc dn md nd ne dp mh kr nf ng ml kv nh ni mp kz nj nk mt nl bi translated">一系列</h2><p id="4874" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">该方法按顺序遍历所有服务器，并将每个新请求发送到下一个服务器。一旦到达列表的末尾，下一个请求将被路由回顶部，并再次沿列表向下重复。这样，所有的请求在服务器之间平均分配。</p><h2 id="2942" class="na ly jj bd lz nb nc dn md nd ne dp mh kr nf ng ml kv nh ni mp kz nj nk mt nl bi translated">加权循环赛</h2><p id="2c06" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">类似于循环调度，除了您可以为某些服务器指定一个权重，以指示应该将更多的负载分配给它们(例如因为它们可以处理更多量)。这样，请求仍然会按顺序分布，但是当轮到一个加权服务器时，在负载平衡器移动到下一个服务器之前，会有更多的请求到达它那里。</p><h2 id="022d" class="na ly jj bd lz nb nc dn md nd ne dp mh kr nf ng ml kv nh ni mp kz nj nk mt nl bi translated">基于IP的策略</h2><p id="5827" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">客户端的IP地址经过哈希处理，根据哈希值，负载平衡器将重定向到相应的服务器。这在服务器兑现响应时非常有用。如果服务器A缓存了特定请求的响应，IP哈希可以确保如果同一客户端再次发出相同的请求，它们可以从服务器A获得缓存的响应，从而缩短响应时间并提高缓存命中率。如果该请求被路由到另一个服务器，即服务器B，那么将响应保存在服务器A的缓存中并不能改善系统。</p><h2 id="6085" class="na ly jj bd lz nb nc dn md nd ne dp mh kr nf ng ml kv nh ni mp kz nj nk mt nl bi translated"><strong class="ak">最小响应时间法</strong></h2><p id="e331" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">负载平衡器将选择具有最少活动连接和最低平均响应时间的服务器。</p><h2 id="8fa5" class="na ly jj bd lz nb nc dn md nd ne dp mh kr nf ng ml kv nh ni mp kz nj nk mt nl bi translated"><strong class="ak">最小带宽法</strong></h2><p id="ec0f" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">负载平衡器将选择当前服务最少流量的服务器。</p><h1 id="2109" class="lx ly jj bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">负载平衡器作为单点故障</h1><p id="334c" class="pw-post-body-paragraph kg kh jj ki b kj mv kl km kn mw kp kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">如果负载平衡器出现故障，会发生什么情况？如果我们只有一个负载均衡器，那么我们所有的服务器扩展都是无用的，因为请求不再到达它们。</p><p id="f1f5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">引入冗余负载平衡器有助于避免这种情况，因为它可以在负载平衡器本身过载或出现故障时保持备用状态。两个负载平衡器相互监控对方的健康状况，并在对方出现故障时接管对方。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi le"><img src="../Images/e7ff9338ab179d18e0d6d3fe26b84244.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*MIDBYldg9sNuuwgVDoSJyw.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">使用冗余负载平衡器来避免单点故障</figcaption></figure><h1 id="60ff" class="lx ly jj bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">参考</h1><figure class="lf lg lh li gt iv"><div class="bz fp l di"><div class="nm nn l"/></div></figure><div class="is it gp gr iu no"><a href="https://en.wikipedia.org/wiki/Load_balancing_%28computing%29" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd jk gy z fp nt fr fs nu fu fw ji bi translated">负载平衡(计算)-维基百科</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">在计算中，负载平衡指的是在一组资源上分配一组任务的过程(计算…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">en.wikipedia.org</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc ja no"/></div></div></a></div></div></div>    
</body>
</html>