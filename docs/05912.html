<html>
<head>
<title>Simple Image Classification with CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于CNN的简单图像分类</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/simple-image-classification-with-cnn-dd5ee3b725?source=collection_archive---------4-----------------------#2020-10-12">https://levelup.gitconnected.com/simple-image-classification-with-cnn-dd5ee3b725?source=collection_archive---------4-----------------------#2020-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="eaa7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python代码来收集照片，并训练CNN对它们进行分类。</h2></div><p id="a1ab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将向您展示如何构建一个卷积神经网络来执行二值图像分类的简单任务<em class="lb"> </em>。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/6bc79dbde38532e548325fd7b9b81648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H5ooB3yiK33dQ5Ax"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated"><a class="ae ls" href="https://unsplash.com/@alinnnaaaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿丽娜·格鲁布尼亚</a>在<a class="ae ls" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="828f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还将编写代码，使用<strong class="kh ir"> Flickr API </strong>和<a class="ae ls" href="https://pypi.org/project/urllib3/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> urllib </strong> </a>库下载照片进行抓取。</p><p id="da9e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过在终端/命令提示符下运行以下命令，下载这两个库。此外，确保您的计算机上安装了Keras和TensorFlow库，或者使用以下命令来安装它们。</p><pre class="ld le lf lg gt lt lu lv lw aw lx bi"><span id="580e" class="ly lz iq lu b gy ma mb l mc md">pip install flickrapi</span><span id="9352" class="ly lz iq lu b gy me mb l mc md">pip install urllib3</span><span id="32d9" class="ly lz iq lu b gy me mb l mc md">pip install keras</span><span id="3140" class="ly lz iq lu b gy me mb l mc md">pip install tensorflow</span></pre><p id="5881" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有趣的是，我们将训练CNN区分猫和猫头鹰。为什么是猫和猫头鹰？它们是我最喜欢的动物，所以我选择了它们。</p><p id="64ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我觉得猫头鹰相当于鸟类中的猫，鉴于它们都拥有巨大而圆的<em class="lb">(放大时)</em>眼睛，这给CNN带来了一些挑战。</p><p id="cc35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，猫头鹰和猫有一些相似之处和不同之处，这将为我们的CNN学习和区分提供良好的特征。</p><p id="4cf7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以查看全部代码，托管在我的GitHub repo里，<a class="ae ls" href="https://github.com/shraddha-an/cnns/blob/master/image_classification.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lb">这里</em> </strong> </a>。</p><p id="1064" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在开始之前，您需要在项目目录中创建两个文件夹，分别名为<strong class="kh ir"> <em class="lb"> train </em> </strong>和<strong class="kh ir"> <em class="lb"> test </em>。</strong>在每个文件夹里面，再创建两个文件夹，分别命名为<strong class="kh ir"> <em class="lb">猫</em> </strong>和<strong class="kh ir"> <em class="lb">猫头鹰</em> </strong> <em class="lb">、</em>来分别存放猫和猫头鹰的照片。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="2c52" class="mm lz iq bd mn mo mp mq mr ms mt mu mv jw mw jx mx jz my ka mz kc na kd nb nc bi translated">1)数据收集—</h1><p id="b19f" class="pw-post-body-paragraph kf kg iq kh b ki nd jr kk kl ne ju kn ko nf kq kr ks ng ku kv kw nh ky kz la ij bi translated">您将需要来自Flickr的API认证密钥来通过HTTP请求访问他们的服务。</p><p id="4d6d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在这里  申请一个非商业的<a class="ae ls" href="https://www.flickr.com/services/api/misc.api_keys.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lb">。</em></strong></a></p><p id="d9ee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦你有了API密匙和密码，你就可以从Flickr网站访问照片并下载它们了。</p><p id="bc73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个FlickrAPI对象，将API密钥作为第一个参数插入，将密码作为第二个参数插入，以进行身份验证。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="efd6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是提取存储在“url_c”中的url。我们将为每个类下载大约960张图片，并将10张<em class="lb">(随机)</em>图片从每个类移动到各自的文件夹中，<em class="lb">，即10张猫图片到test/cat文件夹，10张owl图片到test/owl文件夹。</em></p><p id="7d5d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们还将使用时间模块中的睡眠功能暂停一会儿，从Flickr下载照片。这样做是为了尊重Flickr，而不是垄断它的资源。</p><p id="bde0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还因为我注意到在连续下载了大约494张图片后，Flickr服务会抛出超时错误，所以我将任务分成多个块，中间有100秒的延迟。</p><p id="2353" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb"> urlretrieve </em> </strong>方法要求您指定存放图像的URL以及<strong class="kh ir"> <em class="lb">完整的目标路径</em> </strong>和文件名。由于我们有很多文件，我决定用前缀和计数来命名图像文件。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="81c7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不要忘记将猫和猫头鹰各10张图片移动到测试目录中它们各自的文件夹中，这样我们可以稍后评估CNN的性能。</p><h1 id="3bb6" class="mm lz iq bd mn mo nk mq mr ms nl mu mv jw nm jx mx jz nn ka mz kc no kd nb nc bi translated">2) CNN架构—</h1><p id="1866" class="pw-post-body-paragraph kf kg iq kh b ki nd jr kk kl ne ju kn ko nf kq kr ks ng ku kv kw nh ky kz la ij bi translated">我们将使用Keras库和Tensorflow后端来实现我们的CNN。如果你是卷积神经网络的新手，我强烈建议你阅读本教程中的解释。</p><div class="np nq gp gr nr ns"><a href="https://adventuresinmachinelearning.com/convolutional-neural-networks-tutorial-tensorflow/" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">TensorFlow中的卷积神经网络教程-机器学习中的冒险</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">在之前的两篇教程文章中，神经网络介绍和张量流介绍，三层…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">adventuresinmachinelearning.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og lm ns"/></div></div></a></div><p id="0528" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CNN的架构与人工神经网络的架构有很大的不同，如果你是初学者，一开始可能会觉得很复杂。</p><blockquote class="oh oi oj"><p id="2bf5" class="kf kg lb kh b ki kj jr kk kl km ju kn ok kp kq kr ol kt ku kv om kx ky kz la ij bi translated">CNN通常用于的一些任务包括图像分类、图像分割、计算机视觉，甚至应用于其他领域，如NLP、时间序列和推荐系统。</p><p id="f715" class="kf kg lb kh b ki kj jr kk kl km ju kn ok kp kq kr ol kt ku kv om kx ky kz la ij bi translated">它有助于记住我们的CNN将不得不执行的任务和它必须处理的数据类型，同时试图理解它是如何工作的。</p></blockquote><p id="1272" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图像和照片的结构不同于存储在CSV中的普通数据，如果它们是彩色的，则包含更多的信息。这意味着我们必须首先将照片转换成网络能够理解的数字阵列。</p><blockquote class="on"><p id="6412" class="oo op iq bd oq or os ot ou ov ow la dk translated">灰度图像将由单通道数字输入组成，指示一个像素有多暗。类似地，对于彩色图像，将有3个通道(R、G、B)的数字向网络传递颜色、色调和饱和度等信息。</p></blockquote><p id="b4a1" class="pw-post-body-paragraph kf kg iq kh b ki ox jr kk kl oy ju kn ko oz kq kr ks pa ku kv kw pb ky kz la ij bi translated">CNN由连接到全连接层的隐藏层组成，该全连接层基于流经先前层的像素信息来处理分类决策。我们将在下面更详细地定义每一层。</p><p id="318f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的CNN架构将由多层组成:</p><h2 id="dcb4" class="ly lz iq bd mn pc pd dn mr pe pf dp mv ko pg ph mx ks pi pj mz kw pk pl nb pm bi translated">1)卷积层:</h2><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi pn"><img src="../Images/fff293357945e7f1d58d1fca7db08cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3BRLw4lsANPEfGgimG3YVQ.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">CNN架构。图片来自维基百科。</figcaption></figure><p id="af35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一层首先通过在图像上移动，一次移动几个像素，并应用卷积运算，从图像中提取信息。这些像素的输出将是过滤器值和像素值的点积。对其余的像素继续这一过程，最后我们将整个图像卷积成一个特征图。</p><p id="e56b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，卷积层通过连续放置和移动滤波器来检测图像的特征/信息。</p><h2 id="90c8" class="ly lz iq bd mn pc pd dn mr pe pf dp mv ko pg ph mx ks pi pj mz kw pk pl nb pm bi translated">2)最大池化:</h2><p id="bb7d" class="pw-post-body-paragraph kf kg iq kh b ki nd jr kk kl ne ju kn ko nf kq kr ks ng ku kv kw nh ky kz la ij bi translated">汇集层减小了该特征图的大小，以仅保留重要信息，并使训练过程更加容易和快速。在我们的CNN中，我们将使用一个最大池层，它将以类似于前一个过滤器的方式在特征图上移动，并且只取它所聚焦的聚类的最大值。</p><h2 id="51e1" class="ly lz iq bd mn pc pd dn mr pe pf dp mv ko pg ph mx ks pi pj mz kw pk pl nb pm bi translated">3)全连接层:</h2><p id="b9d6" class="pw-post-body-paragraph kf kg iq kh b ki nd jr kk kl ne ju kn ko nf kq kr ks ng ku kv kw nh ky kz la ij bi translated">全连接层是通常的神经网络，在我们的情况下，它由2层组成；一个具有64个节点，最后一个具有用于二进制分类的单个输出节点。</p><p id="e72a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个简单的概述，解释了我们模型中所有不同的层。实际模型实际上是由一系列连接到2层神经网络的卷积层和最大池层组成的。</p><p id="5a39" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是构建CNN的代码。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="67b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们的任务是对图像进行分类，我们将损失设置为<strong class="kh ir"> <em class="lb">【二元交叉熵】</em> </strong> <em class="lb">(对于2类)</em> &amp;度量为<strong class="kh ir"> <em class="lb">【准确度】</em> </strong>。</p><h1 id="5cae" class="mm lz iq bd mn mo nk mq mr ms nl mu mv jw nm jx mx jz nn ka mz kc no kd nb nc bi translated">3)图像增强—</h1><p id="5f7b" class="pw-post-body-paragraph kf kg iq kh b ki nd jr kk kl ne ju kn ko nf kq kr ks ng ku kv kw nh ky kz la ij bi translated">为了达到实用的精确度，CNN在数百万张图片上被训练。我们既没有如此庞大的数据集，也不具备这种训练过程所需的计算资源。</p><p id="b885" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图像增强帮助我们扩大非常有限的数据集的范围。已经存在的照片可以通过诸如剪切、旋转、缩放、翻转等技术进行处理。，生成新样本并扩展我们的数据集，而无需下载更多图像。</p><p id="e909" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面，我们将定义ImageDataGenerator类的两个对象来扩充我们现有的图像集。</p><p id="0130" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过重新缩放、剪切、缩放和水平翻转，训练数据集将进一步增加新的样本，我们还将调整所有图像的大小，使其高度和宽度为300。</p><p id="4f35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于测试数据集，我们将只重新调整照片的大小。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="ebfa" class="mm lz iq bd mn mo nk mq mr ms nl mu mv jw nm jx mx jz nn ka mz kc no kd nb nc bi translated">4)培训和评估—</h1><p id="55ee" class="pw-post-body-paragraph kf kg iq kh b ki nd jr kk kl ne ju kn ko nf kq kr ks ng ku kv kw nh ky kz la ij bi translated">现在剩下的就是训练模型，评估它在测试照片上的表现。</p><p id="c78c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">训练过程将花费相当多的时间，一旦完成，对模型运行评估方法以获得模型的损失和准确性分数。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="bfc4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们的模型的结果，在测试集上实现了85%的准确率和2.18的损失。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi po"><img src="../Images/5b621fef313e8f4a2659389559651a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*kCYn05DOhmj_i78TXT6DcA.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">CNN的性能指标。</figcaption></figure><p id="8500" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请记住，根据您为测试数据集选择的10个图像，这些指标可能会有所不同。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi pp"><img src="../Images/e939a6c67a53f2512cf4ba704ed0460d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UiPni4HnfBITA9uK"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">蒂莫·沃尔茨在<a class="ae ls" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="f853" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就完成了这个非常长的教程。希望你发现它是有帮助的，并且能够理解卷积神经网络中的不同层。</p><p id="00e6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">欢迎你在不同类别的图像上训练/测试模型，玩得开心！</p><p id="82d6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">页（page的缩写）作为坚持到最后的奖励，这里有一只可爱的猫代表你伸懒腰。</p><p id="7e0e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读，我们将在下一篇文章中再见。</p><p id="d54b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你决定跟随我。</p></div></div>    
</body>
</html>