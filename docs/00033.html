<html>
<head>
<title>Upgrading React &amp; React Native to Flow 0.53.0 and Beyond</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将React &amp; React Native升级到Flow 0.53.0及更高版本</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/upgrading-to-flow-0-53-0-and-beyond-e8ce2e6e16b8?source=collection_archive---------0-----------------------#2017-11-05">https://levelup.gitconnected.com/upgrading-to-flow-0-53-0-and-beyond-e8ce2e6e16b8?source=collection_archive---------0-----------------------#2017-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/50b0a4e233724fba991075d63b57de9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BFxbrQKo9PhBIHYc4Acuxw.png"/></div></div></figure><div class=""/><p id="d1d6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在过去的24小时里，我对<a class="ae kw" href="https://flow.org/" rel="noopener ugc nofollow" target="_blank">流</a>的感情从沮丧到喜欢。显然，我并不孤单。如果你正经历着和我们一样的过山车，下面的几点可能会对你有所帮助。</p><p id="c0cd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我开始<a class="ae kw" href="https://react-native.shop" rel="noopener ugc nofollow" target="_blank">为React Native </a>构建一个新的高级入门套件。当我使用<code class="fe kx ky kz la b">$Diff</code>偶然发现一个bug时，这个项目最初是基于Flow 0.49.0的。多亏了Flow sandbox，可以很容易地确认在最新版本的Flow中修复了这个bug。所以我决定升级。会有多难呢？</p><h2 id="9629" class="lb lc jb bd ld le lf dn lg lh li dp lj kj lk ll lm kn ln lo lp kr lq lr ls lt bi translated">第一步:流量升级</h2><p id="b5f3" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">Flow 0.53.0中的React支持有了显著的改进，正如在<a class="ae kw" href="https://medium.com/flow-type/even-better-support-for-react-in-flow-25b0a3485627" rel="noopener"> Flow团队的文章</a>中所描述的，有一个实用工具可以自动迁移您的代码库:<code class="fe kx ky kz la b">flow-upgrade</code>。</p><pre class="lz ma mb mc gt md la me mf aw mg bi"><span id="d1b4" class="lb lc jb la b gy mh mi l mj mk">yarn create flow-upgrade</span></pre><p id="6364" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个命令负责自动升级我的代码库。之后，需要进行一些小的手工修改。<a class="ae kw" href="https://flow.org/en/docs/react" rel="noopener ugc nofollow" target="_blank">关于其对React </a>的支持的流文档是一个必须阅读的资源。例如，为了访问<a class="ae kw" href="https://flow.org/en/docs/react/types" rel="noopener ugc nofollow" target="_blank">新的实用程序类型</a>，比如<code class="fe kx ky kz la b">React.Node</code>，以<code class="fe kx ky kz la b">import React from "react"</code>的形式编写的导入需要重写到<code class="fe kx ky kz la b">import * as React from "react"</code>。还需要使用类型为的接口而不是来迁移定义为<a class="ae kw" href="https://github.com/facebook/flow/issues/5267" rel="noopener ugc nofollow" target="_blank">的组件属性。</a></p><h2 id="435e" class="lb lc jb bd ld le lf dn lg lh li dp lj kj lk ll lm kn ln lo lp kr lq lr ls lt bi translated">第二步:流程结果检查器</h2><p id="502b" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">当运行0.53.0及以上版本的flow时，您会注意到很多节点模块会抛出类型错误。它们没有通过类型检查器的原因有很多。例如，它们可能是使用您正在使用的旧版本的flow编写的。您不必对这些错误负责，但是您不能在您的流配置文件中简单地忽略它们。</p><figure class="lz ma mb mc gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/d4356c931793e74d59a71e447eaaf7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BbjQn4cBnlDDtIDpi1YzPg.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">你不负责的打字错误</figcaption></figure><p id="beac" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有两个软件包可以过滤来自<code class="fe kx ky kz la b">node_modules</code> : <a class="ae kw" href="https://github.com/jbreckel/flow-result-checker" rel="noopener ugc nofollow" target="_blank">流结果检查器</a>和<a class="ae kw" href="https://github.com/Palisand/flow-error-suppressor" rel="noopener ugc nofollow" target="_blank">流错误抑制器</a>的流错误。虽然后来的包稍微轻量级一些，但我最终还是使用了<code class="fe kx ky kz la b">flow-result-checker</code>,因为用于运行<code class="fe kx ky kz la b">flow-error-suppressor</code>的命令只能在MacOSX上运行。</p><figure class="lz ma mb mc gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/b206846eef50fa365e86942ed3e0c92f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ptTitF7abvhudPAFoO7vVg.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">使用流结果检查器进行类型检查</figcaption></figure></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="2b45" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我的项目中升级flow时，我相当沮丧。但是现在我非常喜欢心流。升级带来的好处超出了我的预期。</p><p id="29db" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我是TypeScript的狂热用户，我在React web项目中使用它，这要感谢它在<a class="ae kw" href="https://github.com/wmonk/create-react-app-typescript" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>中的巨大支持。对于React Native，我使用flow，因为在<a class="ae kw" href="https://github.com/react-community/create-react-native-app" rel="noopener ugc nofollow" target="_blank"> create-react-native-app </a>中没有很好的TypeScript集成。现在，我也在认真考虑将flow用于React web项目。我还迁移到了Atom IDE，发现它对的支持相当不错。看起来心流的未来非常光明。</p><p id="7f2a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你也开始喜欢“心流”了吗？你还相当怀疑吗？让我知道你的想法。</p><p id="667e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对使用Flow构建的高级React本地初学者工具包感兴趣吗？结账<a class="ae kw" href="https://react-native.shop/" rel="noopener ugc nofollow" target="_blank">这个环节</a>。</p></div></div>    
</body>
</html>