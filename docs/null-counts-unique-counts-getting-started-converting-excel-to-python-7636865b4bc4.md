# 空计数、唯一计数&开始将 Excel 转换为 Python

> 原文：<https://levelup.gitconnected.com/null-counts-unique-counts-getting-started-converting-excel-to-python-7636865b4bc4>

月复一月地运行相同的过程来清理、合并和提取数据。

听起来像是几行基本代码就能完成的任务，对吗？

![](img/9e0e8ea5dc17d1fcedc241cb22e971b6.png)

用 Python 深入研究数据预处理

如果你是团队中第一个从 Excel 转换到 Python 的人，你希望你的队友对你正在做的事情感兴趣，而不是被吓倒。创建一个对你来说太有挑战性而无法解释，或者你的老板无法理解的过程会导致很多工作永远无法实施。我正在和我的一个同事一起改造他的流程。我和我的分析师同事每周有半小时的通话。我们花了大约 20 分钟的时间复习视频，另外几分钟交流狗的故事。

我喜欢向他提供一些更新和讨论点，让他能够在 Excel 中进行自己的数据检查，这里有一些确实帮助我们双方更好地理解数据。

**查看所有列名以及有多少空值**

当您处理大数据集时，verbose=True 将允许您查看所有列名，而不会截断它们。一旦你加载了数据集，这是很好的第一步。它可以快速帮助识别任何可能给你带来麻烦的列名，比如带有额外空格的列名。它还向您的同事确认所有列都已正确加载，并且您的值计数与他们的值计数相匹配。

在我们最初的一次会面中，我的同事打开了他的 Excel 程序，讲述他是如何识别唯一条目的。为此，他会将几个专栏组合在一起，运行一个冗长的 VLOOKUP。

他仍然想要一个惟一的标识符，但是我想整理一下冗长的 VLOOKUP。

1.**组合值以创建唯一标识符**

首先，我们将必须唯一的列连接成一个新列。

我们在上面的代码行中所做的是创建一个名为“合并”的新列然后，该函数获取数据集中所有列中最唯一的一个，在本例中是“主关键字”，并使用。猫功能。在上面的例子中，和许多情况一样，您将多种类型的列组合在一起。在这种情况下，您可以看到有一个“姓名”、“日期”和“号码”，它们可以被忽略并使用“.”组合在一起。astype(str)"。最后，set="_ "为最终用户在查看这些唯一值的 Excel 文件时提供了一个更清晰的视图。我的同事不会看到数字和日期在一起，而是用下划线分开。

2.**统计数据集中的唯一条目**

下面几行代码将我新创建的“组合”列转换成一个序列，可以有效地计算我们拥有唯一条目的次数。

对我来说，这表明我的合并列比我的同事的 Excel 版本有更多的值。这引出了我的下一步，也是我的下一篇更新，将围绕比较 VLOOKUPS 和合并数据集展开。