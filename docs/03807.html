<html>
<head>
<title>JavaScript Best Practices — Variable Scopes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript最佳实践—可变范围</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-best-practices-variable-scopes-76b4dbf2d963?source=collection_archive---------16-----------------------#2020-05-27">https://levelup.gitconnected.com/javascript-best-practices-variable-scopes-76b4dbf2d963?source=collection_archive---------16-----------------------#2020-05-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/38c9b24502f9de360cf4d3b9d0177b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xc1e_BDlI8dwaaed"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@marliesebrandsma?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">mar liese stree land</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="7bfc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">JavaScript是一种非常宽容的语言。编写可以运行但存在问题的代码很容易。</p><p id="959d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将研究声明变量和使用JavaScript变量范围的最佳实践。</p><h1 id="702e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">范围</h1><p id="1d5e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">作用域是我们可以访问变量的地方。</p><p id="a756" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">JavaScript有几种作用域。用<code class="fe mh mi mj mk b">var</code>声明的变量有函数作用域，用<code class="fe mh mi mj mk b">let</code>或<code class="fe mh mi mj mk b">const</code>声明的变量有块作用域。</p><p id="02dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">var</code>变量也可以被提升，这样变量在定义之前就可以被访问。</p><p id="99ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">let</code>和<code class="fe mh mi mj mk b">const</code>变量和常量不吊。</p><h1 id="f80a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">本地化对变量的引用</h1><p id="2340" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果变量是用关键字声明的，那么它们在JavaScript中都是局部的。</p><p id="ef96" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果不是，那么它们是全球性的。全局变量只能在严格模式下声明。</p><p id="4e01" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果它是开着的，那么我们就不能声明它们。</p><p id="01a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">声明全局变量时没有使用关键字。</p><p id="38f3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们应该坚持使用<code class="fe mh mi mj mk b">let</code>和<code class="fe mh mi mj mk b">const</code>来声明变量和常量。</p><h1 id="8282" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">让变量在尽可能短的时间内“存活”</h1><p id="9722" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们应该在尽可能短的时间内保持它们可用。这意味着可供变量引用的代码行应该很少。</p><p id="44d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样，我们就不会轻易地意外地给它们赋值，从而减少出错的机会。</p><p id="21db" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一个变量只在块内可用，那么这比在块外可用要好。</p><p id="67d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是使用<code class="fe mh mi mj mk b">let</code>和<code class="fe mh mi mj mk b">const</code>的另一个好处，因为它们是块范围的，我们可以确保在它们被定义之前不能被引用。</p><p id="2bb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，它们对块外的任何代码都不可用。</p><p id="6ba8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">短暂的生存时间使我们的代码更具可读性，因为我们不必在头脑中保留太多东西。</p><p id="1e36" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">初始化错误的机会将会减少。</p><p id="e69e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以很容易地将块范围的变量分割成更小的函数。</p><h1 id="7210" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">最小化范围的一般准则</h1><p id="382f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以很容易地最小化变量的范围。</p><p id="309a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是一些最小化范围的指导方针。</p><h2 id="0fe0" class="ml lf it bd lg mm mn dn lk mo mp dp lo kr mq mr ls kv ms mt lw kz mu mv ma mw bi translated">在循环之前初始化循环中使用的变量</h2><p id="1d39" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们应该在循环之前声明循环中使用的变量，这样我们就可以马上看到它们被用在了哪里。</p><p id="815f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们修改循环，我们会记住变量被使用，我们不会犯错误。</p><p id="c268" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mx my mz na gt nb mk nc nd aw ne bi"><span id="c35f" class="ml lf it mk b gy nf ng l nh ni">let done = false;<br/>while (!done) {<br/>  //...<br/>}</span></pre><p id="f3e5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在<code class="fe mh mi mj mk b">while</code>循环之前有<code class="fe mh mi mj mk b">done</code>变量，所以当我们在循环中工作时不会忘记它。</p><h2 id="6a96" class="ml lf it bd lg mm mn dn lk mo mp dp lo kr mq mr ls kv ms mt lw kz mu mv ma mw bi translated">不要给变量赋值，直到值被使用之前</h2><p id="870e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">变量值不应该被赋值，直到值被使用之前。</p><p id="6e3f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这种方式，可以清楚地知道变量首先在哪里获得它的值，从而最大限度地减少混淆。</p><h2 id="97b5" class="ml lf it bd lg mm mn dn lk mo mp dp lo kr mq mr ls kv ms mt lw kz mu mv ma mw bi translated">集团相关报表</h2><p id="fcf7" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们有相关的陈述，那么我们应该把它们组合在一起。</p><p id="098e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样，当我们准备好代码来获得整个工作流时，我们就不必来回跳转了。</p><h2 id="d8c1" class="ml lf it bd lg mm mn dn lk mo mp dp lo kr mq mr ls kv ms mt lw kz mu mv ma mw bi translated">将相关语句组分解成独立的函数</h2><p id="056e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">较短的函数具有较短的变量跨度，这有利于可读性。</p><p id="5830" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">变量的范围缩小了，这样我们就不必滚动阅读所有访问变量的地方。</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/e8e7cb90530fe2e56fb6593dd7da7b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f6LCxaphMC4iExQN"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@rpnickson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">罗伯特·尼克森</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h2 id="ecfe" class="ml lf it bd lg mm mn dn lk mo mp dp lo kr mq mr ls kv ms mt lw kz mu mv ma mw bi translated">从最受限的可见性开始，仅在必要时扩展变量的范围</h2><p id="2fd8" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">块范围的变量有利于限制可见性。它将变量限制在块内。</p><p id="31cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该只在需要的时候扩大范围，因为我们不想扩大“活动”时间，以减少意外分配它们的机会，使它们更难阅读。</p><h1 id="c95a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">最小化范围</h1><p id="53ee" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">通过扩展变量作用域来最大化作用域可能会使它们更容易编写，但是程序更容易理解，因为这些变量可能在任何地方被引用。</p><p id="ff1b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这不好，因为我们不想那样做。</p><p id="6bd2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们必须查看所有地方的所有变量，以便理解一个变量是如何使用的，这对可读性非常不利。</p><p id="49c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，缩小范围绝对是我们应该做的事情。</p><h1 id="c533" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="9b30" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们应该最小化变量的范围，使它们更容易阅读。</p><p id="1252" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">范围更小的变量也可以更容易地移动，这样我们在所有使用它们的地方查看它们就不会有困难。</p><p id="cff5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，块范围变量和常量是好的。我们可以分别用<code class="fe mh mi mj mk b">let</code>和<code class="fe mh mi mj mk b">const</code>来声明。</p></div></div>    
</body>
</html>