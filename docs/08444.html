<html>
<head>
<title>Get Started with OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">OpenCV入门</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/get-started-with-opencv-3c973215f849?source=collection_archive---------8-----------------------#2021-05-03">https://levelup.gitconnected.com/get-started-with-opencv-3c973215f849?source=collection_archive---------8-----------------------#2021-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="53be" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python中的OpenCV入门</h2></div><p id="c493" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本帖中，我们将提供一些使用OpenCV可以做什么的例子。</p><div class="le lf gp gr lg lh"><a href="https://jorgepit-14189.medium.com/membership" rel="noopener follow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">用我的推荐链接加入媒体-乔治皮皮斯</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">阅读乔治·皮皮斯(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">jorgepit-14189.medium.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv lw lh"/></div></div></a></div><h1 id="fe97" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">在OpenCV中混合图像</h1><p id="0c98" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们将给出一个例子，演示如何使用<a class="ae mu" href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_tutorials.html" rel="noopener ugc nofollow" target="_blank"> Python OpenCV </a>混合图像。下面我们代表目标和过滤器的图像。</p><p id="388f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">目标图像</strong></p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/383d9d631640873f86b6a0ec67e778a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*TOkncuPU5wccytk6.jpg"/></div></div></figure><p id="044e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">过滤图像</strong></p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/c85b2bd05e4859d6626cbbfc73315097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z21teWMsmYVCzQhG.png"/></div></div></figure><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="70af" class="nm ly it ni b gy nn no l np nq">import cv2<br/> <br/># Two images<br/>img1 = cv2.imread('target.jpg')<br/>img2 = cv2.imread('filter.png')<br/> <br/># OpenCV expects to get BGR images, so we will convert from BGR to RGB<br/> <br/>img1 = cv2.cvtColor(img1, cv2.COLOR_BGR2RGB)<br/>img2 = cv2.cvtColor(img2, cv2.COLOR_BGR2RGB)<br/> <br/># Resize the Images. In order to blend them, the two images<br/># must be of the same shape<br/> <br/>img1 =cv2.resize(img1,(620,350))<br/>img2 =cv2.resize(img2,(620,350))<br/> <br/> <br/># Now, we can blend them, we need to define the weight (alpha) of the target image<br/># as well as the weight of the filter image<br/># in our case we choose 80% target and 20% filter<br/>blended = cv2.addWeighted(src1=img1,alpha=0.8,src2=img2,beta=0.2,gamma=0)<br/> <br/># finally we can save the image. Now we need to convert it from RGB to BGR<br/> <br/>cv2.imwrite('Blending.png',cv2.cvtColor(blended, cv2.COLOR_RGB2BGR))</span></pre><p id="4fbf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">瞧！</strong></p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mv"><img src="../Images/19449a66b4a58b784701209c0bee06b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*V_Sdm1Zaj9RxnpLS.png"/></div></div></figure><h1 id="c8f1" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">在OpenCV中处理图像</h1><p id="21a4" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们将展示如何在Python中使用OpenCV应用图像处理。我们将使用从Unsplash获得的这张<a class="ae mu" href="https://images.unsplash.com/photo-1566487097168-e91a4f38bee2?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1050&amp;q=80" rel="noopener ugc nofollow" target="_blank">图像</a>。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/4413bb87257b0a7dae5a0aad7b303f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XbGCxc0wRF7mpc0r.jpeg"/></div></div></figure><h1 id="8805" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">如何模糊图像</h1><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="7d32" class="nm ly it ni b gy nn no l np nq">import cv2<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline<br/> <br/>img = cv2.imread('panda.jpeg')<br/>img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)<br/>blurred_img = cv2.blur(img,ksize=(20,20))<br/>cv2.imwrite("blurredpanda.jpg", blurred_img)</span></pre><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/95e941bab64da51f2b47fe17ef022d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*it_lW3dffLdyrKLK.jpg"/></div></div></figure><h1 id="0c6b" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">如何应用索贝尔算子</h1><p id="1817" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">你可以在维基百科上看一下<a class="ae mu" href="https://en.wikipedia.org/wiki/Sobel_operator" rel="noopener ugc nofollow" target="_blank"> Sobel算子</a>，你也可以开始用一些滤镜<a class="ae mu" href="https://setosa.io/ev/image-kernels/" rel="noopener ugc nofollow" target="_blank">做实验</a>。让我们应用水平和垂直Sobel算子。</p><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="bf19" class="nm ly it ni b gy nn no l np nq">img = cv2.imread('panda.jpeg',0)<br/>sobelx = cv2.Sobel(img,cv2.CV_64F,1,0,ksize=5)<br/>sobely = cv2.Sobel(img,cv2.CV_64F,0,1,ksize=5)<br/> <br/>cv2.imwrite("sobelx_panda.jpg", sobelx) <br/>cv2.imwrite("sobely_panda.jpg", sobely)</span></pre><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/52a48d471bbde7a268b01cf488693d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bvMc5pr_66MkyUNX.jpg"/></div></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/02c6332027906690bcb4063e98537434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*v0_ElRpHecknrd1Q.jpg"/></div></div></figure><h1 id="8795" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">如何对图像应用阈值</h1><p id="6103" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们也可以将图像二值化。</p><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="d436" class="nm ly it ni b gy nn no l np nq">img = cv2.imread('panda.jpeg',0)<br/>ret,th1 = cv2.threshold(img,100,255,cv2.THRESH_BINARY)<br/>fig = plt.figure(figsize=(12,10))<br/>plt.imshow(th1,cmap='gray')</span></pre><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nr"><img src="../Images/170ce0fb7c4023ab6272677bf92d0a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e_xuC1yKogyPAocz.png"/></div></div></figure><h1 id="093e" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">OpenCV中的人脸检测</h1><p id="ba42" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们将讨论如何使用<a class="ae mu" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>应用人脸检测。我们用一个可重复的实际例子来说明。</p><p id="7e16" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">逻辑如下:我们从URL(或从硬盘)获取图像。我们将其转换为<code class="fe ns nt nu ni b">numpy array</code>，然后转换为灰度。然后通过应用适当的<strong class="kk iu">级联分类器</strong>我们得到人脸的边界框。最后，使用<a class="ae mu" href="https://pillow.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> PIllow </a>(甚至OpenCV)我们可以在初始图像上画出盒子。</p><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="e5ea" class="nm ly it ni b gy nn no l np nq">import cv2 as cv<br/>import numpy as np<br/>import PIL<br/>from PIL import Image<br/>import requests<br/>from io import BytesIO<br/>from PIL import ImageDraw<br/> <br/> <br/># I have commented out the cat and eye cascade. Notice that the xml files are in the opencv folder that you have downloaded and installed<br/># so it is good a idea to write the whole path<br/>face_cascade = cv.CascadeClassifier('C:\\opencv\\build\\etc\\haarcascades\\haarcascade_frontalface_default.xml')<br/>#cat_cascade = cv.CascadeClassifier('C:\\opencv\\build\\etc\\haarcascades\\haarcascade_frontalcatface.xml')<br/>#eye_cascade = cv.CascadeClassifier('C:\\opencv\\build\\etc\\haarcascades\\haarcascade_eye.xml')<br/> <br/> <br/>URL = "<a class="ae mu" href="https://images.unsplash.com/photo-1525267219888-bb077b8792cc?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1050&amp;q=80" rel="noopener ugc nofollow" target="_blank">https://images.unsplash.com/photo-1525267219888-bb077b8792cc?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1050&amp;q=80</a>"<br/>response = requests.get(URL)<br/>img = Image.open(BytesIO(response.content))<br/>img_initial = img.copy()<br/> <br/># convert it to np array<br/>img = np.asarray(img)<br/> <br/>gray = cv.cvtColor(img, cv.COLOR_BGR2GRAY)<br/> <br/>faces = face_cascade.detectMultiScale(gray)<br/># And lets just print those faces out to the screen<br/>#print(faces)<br/> <br/>drawing=ImageDraw.Draw(img_initial)<br/> <br/># For each item in faces, lets surround it with a red box<br/>for x,y,w,h in faces:<br/>    # That might be new syntax for you! Recall that faces is a list of rectangles in (x,y,w,h)<br/>    # format, that is, a list of lists. Instead of having to do an iteration and then manually<br/>    # pull out each item, we can use tuple unpacking to pull out individual items in the sublist<br/>    # directly to variables. A really nice python feature<br/>    #<br/>    # Now we just need to draw our box<br/>    drawing.rectangle((x,y,x+w,y+h), outline="red")<br/>display(img_initial)</span></pre><p id="c0b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最初的图像是这样的:</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/465516bbdba611b8ca87cdc12370f4d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xX4bVGvhE-S8ylUL.jpg"/></div></div></figure><p id="a1dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">画完边界框后，我们得到了:</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/e2e2c39fef139d402e82dfd1451620d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OpTwKR1SU2qu5gq8.png"/></div></div></figure><p id="b863" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所看到的，我们设法正确地得到了四张脸，但是我们也发现了窗户后面的一个“鬼”</p><h2 id="391a" class="nm ly it bd lz nv nw dn md nx ny dp mh kr nz oa mj kv ob oc ml kz od oe mn of bi translated">裁剪面部以分离图像</h2><p id="196b" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们也可以裁剪面部来分离图像</p><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="8308" class="nm ly it ni b gy nn no l np nq">for x,y,w,h in faces:<br/> <br/>    img_initial.crop((x,y,x+w,y+h))<br/>    display(img_initial.crop((x,y,x+w,y+h)))</span></pre><p id="9e80" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们看到的第一张脸是:</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi og"><img src="../Images/bcce03ccbe077462f3a622db82de0d74.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/0*CYzhqc7kWnQ2wGbK.png"/></div></figure><p id="2908" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意:如果您想从硬盘中读取图像，您可以简单地键入以下三行:</p><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="fdae" class="nm ly it ni b gy nn no l np nq"># read image from the PC</span><span id="6e2a" class="nm ly it ni b gy oh no l np nq">initial_img=Image.open('my_image.jpg')<br/>img = cv.imread('my_image.jpg')<br/>gray = cv.cvtColor(img, cv.COLOR_BGR2GRAY)</span></pre><h1 id="02af" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">OpenCV中的人脸检测视频</h1><p id="6cb1" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">这篇文章是一个实际的例子，展示了我们如何使用<a class="ae mu" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>和Python来检测视频中的人脸。在之前的帖子中，我们解释了如何在Tensorflow 中应用<a class="ae mu" href="https://predictivehacks.com/example-of-object-detection-in-tensorflow/" rel="noopener ugc nofollow" target="_blank">对象检测，以及在OpenCV </a>中应用<a class="ae mu" href="https://predictivehacks.com/face-detection-in-opencv/" rel="noopener ugc nofollow" target="_blank">人脸检测。一般来说，计算机视觉和目标检测是人工智能领域的一个热门话题。想象一下</a><a class="ae mu" href="https://en.wikipedia.org/wiki/Self-driving_car" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">自动驾驶汽车</strong> </a>，它必须连续检测周围许多不同的物体(行人、其他车辆、标志等)。</p><h2 id="a1af" class="nm ly it bd lz nv nw dn md nx ny dp mh kr nz oa mj kv ob oc ml kz od oe mn of bi translated">如何录制人脸检测视频</h2><p id="5d28" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">在下面的例子中，我们使用USB摄像头进行人脸检测，并将视频写入一个<code class="fe ns nt nu ni b">.mp4</code>文件。正如你所看到的，OpenCV能够检测人脸，当它藏在手后面时，OpenCV就会丢失它。</p><pre class="mw mx my mz gt nh ni nj nk aw nl bi"><span id="3d5e" class="nm ly it ni b gy nn no l np nq">import cv2<br/># change your path to the one where the haarcascades/haarcascade_frontalface_default.xml is<br/>face_cascade = cv2.CascadeClassifier('../DATA/haarcascades/haarcascade_frontalface_default.xml')<br/> <br/>cap = cv2.VideoCapture(0) <br/> <br/>width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))<br/>height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))<br/> <br/># MACOS AND LINUX: *'XVID' (MacOS users may want to try VIDX as well just in case)<br/># WINDOWS *'VIDX'<br/>writer = cv2.VideoWriter('myface.mp4', cv2.VideoWriter_fourcc(*'XVID'),25, (width, height))<br/> <br/> <br/>while True: <br/>     <br/>    ret, frame = cap.read(0) <br/>      <br/>    frame = detect_face(frame)<br/>    writer.write(frame)<br/>  <br/>    cv2.imshow('Video Face Detection', frame) <br/>    # escape button to close it<br/>    c = cv2.waitKey(1) <br/>    if c == 27: <br/>        break<br/>         <br/>cap.release() <br/>writer.release()<br/>cv2.destroyAllWindows()</span></pre><h2 id="55bf" class="nm ly it bd lz nv nw dn md nx ny dp mh kr nz oa mj kv ob oc ml kz od oe mn of bi translated">计算机视觉代码的输出</h2><p id="7d3e" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">用动态人脸检测录制这个视频只需要几行代码。如果你运行上面的代码块，你会得到一个类似的视频(当然是不同的面孔</p><figure class="mw mx my mz gt na"><div class="bz fp l di"><div class="oi oj l"/></div></figure></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><p id="03c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="or">原载于</em><a class="ae mu" href="https://predictivehacks.com/get-started-with-opencv/" rel="noopener ugc nofollow" target="_blank"><em class="or">https://predictivehacks.com</em></a><em class="or">。</em></p></div></div>    
</body>
</html>