<html>
<head>
<title>Tutorial: Build an Interactive Virtual Globe with Three.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:用Three.js构建交互式虚拟地球</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tutorial-build-an-interactive-virtual-globe-with-three-js-33cf7c2090cb?source=collection_archive---------1-----------------------#2017-10-25">https://levelup.gitconnected.com/tutorial-build-an-interactive-virtual-globe-with-three-js-33cf7c2090cb?source=collection_archive---------1-----------------------#2017-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5a0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过构建一个互动的、旋转的地球开始体验VR/3D！</p><p id="0a15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae km" href="https://globedemo.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">演示</a> | <a class="ae km" href="https://github.com/jocaron27/threejs-tutorial/blob/master/app/components/Root.jsx" rel="noopener ugc nofollow" target="_blank">代号</a></p><p id="599b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">TL；博士:</strong>我最近开始意识到虚拟现实的力量，从它创造有趣的、身临其境的体验的能力到它对精神健康领域的影响。我进入了<strong class="jp ir"> three.js </strong>，这是一个在浏览器中渲染3D的流行库，学习如何用JavaScript构建交互式的三维体验。这篇文章包括一个介绍性的教程，它将向你展示这个库，并教你如何制作一个交互式旋转地球仪。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><a href="https://globedemo.herokuapp.com/"><div class="gh gi kn"><img src="../Images/30fe56b57ad8dad92c8aa340d5c9f63e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iIVtb4_D5UVsQ_oKtHxUbQ.png"/></div></a><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">单击图像打开演示(在台式计算机上效果最佳)</figcaption></figure><h1 id="dee7" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">我的VR之路</strong></h1><p id="5f4d" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">虚拟现实刚成为一个东西的时候，我并没有感觉到炒作。我的印象是它只是为游戏玩家准备的，我想，那不适合我。</p><p id="1c3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我得到了谷歌Pixel，这是我的第一部真正的智能手机。有了它，我开始拍摄360张我想重游的地方的照片(比如风景、难忘的聚会、我长大的房子...).我还见证了朋友和家人通过我的谷歌Cardboard在谷歌地图上访问他们多年未去的家乡时的兴奋和怀旧情绪。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mc md l"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">我用谷歌像素在犹他州峡谷地国家公园拍摄的360度照片</figcaption></figure><p id="ae5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一名以前在心理健康领域工作的程序员，我开始考虑虚拟现实如何改善残疾人、特殊需求者和精神疾病患者的生活，特别是通过提供用户可能无法获得的治疗体验。不用说，我开始对虚拟现实的世界产生了兴趣。</p><blockquote class="me"><p id="b5d7" class="mf mg iq bd mh mi mj mk ml mm mn kk dk translated">这项技术不可思议的地方在于，你会觉得自己真的和其他人在另一个地方。尝试过的人说，这与他们一生中经历过的任何事情都不一样。”</p><p id="c359" class="mf mg iq bd mh mi mj mk ml mm mn kk dk translated"><a class="ae km" href="https://www.facebook.com/zuck/posts/10101319050523971" rel="noopener ugc nofollow" target="_blank"><strong class="ak">——马克·扎克伯格</strong> </a></p></blockquote><p id="3efc" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">我和虚拟现实之间的下一个障碍实际上是弄脏我的手。这对我来说就像火箭科学，我无法理解用<em class="kl">代码构建一个三维的、沉浸式的、互动的世界的复杂性。</em>然而，随着我开发更多的二维应用程序，增加另一个维度的想法逐渐不再觉得遥不可及。</p><p id="047b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对虚拟现实还是完全陌生，但我想带你一起踏上我的探索之旅。</p><h2 id="7cd6" class="mu la iq bd lb mv mw dn lf mx my dp lj jy mz na ln kc nb nc lr kg nd ne lv nf bi translated">今天我将教你如何用JavaScript构建一个简单的交互式3D应用。如果你和我一样，想进入VR的世界，希望这篇教程能给你起步的信心。</h2></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="1644" class="kz la iq bd lb lc nn le lf lg no li lj lk np lm ln lo nq lq lr ls nr lu lv lw bi translated"><strong class="ak">我们要建什么</strong></h1><p id="ce40" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">在这个演练中，我们将使用<a class="ae km" href="https://threejs.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> three.js </strong> </a> <strong class="jp ir">，</strong>构建一个3D场景，这是一个在浏览器中渲染3D的流行库。</p><p id="add8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">目标是创建一个球体(也许是地球？)当您按下键盘上的←→↓按钮时，它会旋转(移动鼠标时也是如此)。</strong>虽然我们没有创造沉浸式虚拟现实体验，但它<em class="kl">是3D的</em>和它<em class="kl">是互动的</em>，所以我们有了一个良好的开端！</p><p id="b716" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae km" href="https://globedemo.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">这就是它的样子*。</a></p><p id="132a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">*最适合台式电脑/笔记本电脑</p><h1 id="e525" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">入门</strong></h1><p id="5d11" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">注意:如果你没有使用Node的<em class="kl"/>，参考three.js文档中的<a class="ae km" href="https://threejs.org/docs/index.html#manual/introduction/Creating-a-scene" rel="noopener ugc nofollow" target="_blank">启动代码，而不是执行下面的步骤1 &amp; 2。</a></p><p id="8d76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 1。</strong> <strong class="jp ir">建立你的档案</strong></p><p id="1728" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你看我的<a class="ae km" href="https://github.com/jocaron27/threejs-tutorial" rel="noopener ugc nofollow" target="_blank">代码</a>，你会看到一个Express app在前端使用React将3D组件注入到我的HTML文件中。这与本教程无关，所以您的文件结构可以只包含一个. html和一个. js文件。确保已经创建了package.json文件(可以运行<strong class="jp ir"> npm init - y) </strong>。您还需要安装<a class="ae km" href="http://webpack.github.io/docs/tutorials/getting-started/" rel="noopener ugc nofollow" target="_blank"> webpack </a>来捆绑您的。js文件带有三个<em class="kl">模块</em>。</p><p id="b63f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您的HTML文件可能如下所示:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="7bda" class="mu la iq nt b gy nx ny l nz oa">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/> &lt;head&gt;<br/> &lt;/head&gt;<br/> &lt;body&gt;<br/>     &lt;div id="container" width="100vw" height="100vh" /&gt;<br/>     &lt;script src="bundle.js"&gt;&lt;/script&gt;<br/> &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3e38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。安装并添加three.js </strong></p><p id="085d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过运行<strong class="jp ir"> npm安装three </strong>来安装three.js，然后导入到你的主。js文件。</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="6c4f" class="mu la iq nt b gy nx ny l nz oa">const THREE = require('three');</span></pre><p id="577d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。</strong> <strong class="jp ir">获取你想要附加场景的DOM元素</strong></p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="ed99" class="mu la iq nt b gy nx ny l nz oa">const container = document.querySelector('#container');</span></pre><p id="9fc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们很快就会将我们的3D渲染器添加到<em class="kl">容器</em> div中。</p><h1 id="adcb" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">创建3D渲染器</h1><blockquote class="ob oc od"><p id="7171" class="jn jo kl jp b jq jr js jt ju jv jw jx oe jz ka kb of kd ke kf og kh ki kj kk ij bi translated">为了能够用three.js显示任何东西，我们需要三样东西:一个<strong class="jp ir">场景</strong>、一个<strong class="jp ir">相机</strong>和一个<strong class="jp ir">渲染器</strong>，这样我们就可以用相机渲染场景。<a class="ae km" href="https://threejs.org/docs/#manual/introduction/Creating-a-scene" rel="noopener ugc nofollow" target="_blank"> (three.js文档)</a></p></blockquote><p id="57d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。创建WebGL渲染器</strong></p><p id="2e0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae km" href="https://threejs.org/docs/#api/renderers/WebGLRenderer" rel="noopener ugc nofollow" target="_blank"> WebGL(网络图形库)</a>在浏览器中渲染交互式二维和三维图形。这就是我们马上要创建并附加到我们的HTML <em class="kl">容器</em> div <em class="kl"> </em>中的内容(在我们创建了将进入渲染器的所有组件之后)。</p><p id="a2f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要实例化它:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="8be2" class="mu la iq nt b gy nx ny l nz oa">const renderer = new THREE.WebGLRenderer();</span></pre><p id="199b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你还需要设置渲染器的大小。我已经设置了窗口的宽度和高度:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="de6e" class="mu la iq nt b gy nx ny l nz oa">const WIDTH = window.innerWidth;</span><span id="cf3b" class="mu la iq nt b gy oh ny l nz oa">const HEIGHT = window.innerHeight;</span><span id="cb4b" class="mu la iq nt b gy oh ny l nz oa">renderer.setSize(WIDTH, HEIGHT);</span></pre><p id="ae27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5。创建一个摄像机</strong></p><p id="b44e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Three.js有一个<a class="ae km" href="https://threejs.org/docs/#api/cameras/Camera" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="kl">Camera</em></strong></a>类，由它的各个子类继承，如<a class="ae km" href="https://threejs.org/docs/#api/cameras/PerspectiveCamera" rel="noopener ugc nofollow" target="_blank"> PerspectiveCamera </a>(我们将使用的那个)或<a class="ae km" href="https://threejs.org/docs/#api/cameras/OrthographicCamera" rel="noopener ugc nofollow" target="_blank"> OrthographicCamera </a>。透视相机最常用于3D场景，因为它模拟了人眼的视觉方式。</p><p id="672c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将设置相机属性:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="1f5c" class="mu la iq nt b gy nx ny l nz oa">const VIEW_ANGLE = 45;</span><span id="3c78" class="mu la iq nt b gy oh ny l nz oa">const ASPECT = WIDTH / HEIGHT;</span><span id="9fd1" class="mu la iq nt b gy oh ny l nz oa">const NEAR = 0.1;</span><span id="d604" class="mu la iq nt b gy oh ny l nz oa">const FAR = 10000;</span></pre><p id="6f7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后实例化摄像机:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="a118" class="mu la iq nt b gy nx ny l nz oa">const camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR);</span></pre><p id="7263" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还将设置摄像机在x、y和z轴上的位置:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="f50e" class="mu la iq nt b gy nx ny l nz oa">camera.position.set( 0, 0, 500 );</span></pre><p id="2412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6。创建一个场景</p><p id="1801" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装快完成了！现在我们创建一个<strong class="jp ir"> <em class="kl">场景</em> </strong>:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="268a" class="mu la iq nt b gy nx ny l nz oa">const scene = new THREE.Scene();</span></pre><p id="2a87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并添加黑色背景:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="457b" class="mu la iq nt b gy nx ny l nz oa">scene.background = new THREE.Color( 0x000 );</span></pre><p id="98fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 7。将摄像机添加到场景中</strong></p><p id="821a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了一个场景，我们可以给它添加摄像机:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="fc13" class="mu la iq nt b gy nx ny l nz oa">scene.add(camera);</span></pre><p id="3cf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 8。将渲染器附加到DOM元素。</strong></p><p id="2566" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，正如承诺的那样，我们将渲染器添加到容器中。</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="4a8f" class="mu la iq nt b gy nx ny l nz oa">container.appendChild(renderer.domElement);</span></pre><h1 id="0108" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">创造地球</h1><p id="8463" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">现在我们可以继续我们的地球了！</p><p id="962a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 9。创建一个球体</strong></p><p id="77a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Three.js使用几何网格创建原始的3D形状，如球体、立方体、圆柱体等。因为我要做一个行星地球的外观，我将使用一个球体。</p><p id="c9b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将从定义球体的属性开始:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="7ffa" class="mu la iq nt b gy nx ny l nz oa">const RADIUS = 200;</span><span id="2733" class="mu la iq nt b gy oh ny l nz oa">const SEGMENTS = 50;</span><span id="9b2f" class="mu la iq nt b gy oh ny l nz oa">const RINGS = 50;</span></pre><p id="7bc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，因为我们想用地球的图像纹理球体，我们将创建一个<strong class="jp ir"> <em class="kl">组</em> </strong>，它将保持我们的球体和它的纹理网格在一起:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="aa8c" class="mu la iq nt b gy nx ny l nz oa">const globe = new THREE.Group();</span><span id="35ad" class="mu la iq nt b gy oh ny l nz oa">scene.add(globe);</span></pre><p id="3587" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们将创建我们的球体及其纹理，并使用three.js的<strong class="jp ir"><em class="kl">texture loader</em></strong>将它们网格化在一起:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="62a6" class="mu la iq nt b gy nx ny l nz oa">var loader = new THREE.TextureLoader();</span></pre><p id="3833" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们调用<strong class="jp ir"> <em class="kl"> load </em> </strong>方法，该方法将我们的图像url ( <a class="ae km" href="https://eoimages.gsfc.nasa.gov/images/imagerecords/57000/57735/land_ocean_ice_cloud_2048.jpg" rel="noopener ugc nofollow" target="_blank">这里是我使用的图像</a>)作为第一个参数，以及一个函数:1)创建一个具有预定义属性的球体，2)将<strong class="jp ir"> <em class="kl">纹理</em> </strong>映射到<strong class="jp ir"> <em class="kl">材质</em> </strong>(在此阅读更多<a class="ae km" href="https://threejs.org/docs/#api/constants/Materials" rel="noopener ugc nofollow" target="_blank">关于three.js文档中的</a>)，3)创建一个<a class="ae km" href="https://threejs.org/docs/#api/materials/MeshBasicMaterial" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl"/></strong></a></p><p id="0ae7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">注意:如果你遇到关于图片链接的错误，使用这个:</em><a class="ae km" href="https://eoimages.gsfc.nasa.gov/images/imagerecords/57000/57735/land_ocean_ice_cloud_2048.jpg" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://EO images . gsfc . NASA . gov/images/image records/57000/57735/land _ ocean _ ice _ cloud _ 2048 . jpg</em></a></p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="a225" class="mu la iq nt b gy nx ny l nz oa">loader.load( 'land_ocean_ice_cloud_2048.jpg', function ( texture ) {</span><span id="1d6e" class="mu la iq nt b gy oh ny l nz oa"><br/>  // Create the sphere</span><span id="e469" class="mu la iq nt b gy oh ny l nz oa">  var sphere = new THREE.SphereGeometry( RADIUS, SEGMENTS, RINGS );<br/></span><span id="339f" class="mu la iq nt b gy oh ny l nz oa">  // Map the texture to the material. </span><span id="0f31" class="mu la iq nt b gy oh ny l nz oa">  var material = new THREE.MeshBasicMaterial( { map: texture, overdraw: 0.5 } );<br/></span><span id="13a0" class="mu la iq nt b gy oh ny l nz oa">  // Create a new mesh with sphere geometry.</span><span id="15a5" class="mu la iq nt b gy oh ny l nz oa">  var mesh = new THREE.Mesh( sphere, material );</span><span id="3589" class="mu la iq nt b gy oh ny l nz oa"><br/>  // Add mesh to globe</span><span id="7577" class="mu la iq nt b gy oh ny l nz oa">  globe.add(mesh);</span><span id="6034" class="mu la iq nt b gy oh ny l nz oa">} );</span></pre><p id="a8da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了球体，让我们将它向后(沿z轴)放置，这样我们就可以看到它:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="36a0" class="mu la iq nt b gy nx ny l nz oa">globe.position.z = -300;</span></pre><p id="d37a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 10。添加照明</strong></p><p id="2cba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我们在上一步中使用了MeshBasicMaterial(一种不受光照影响的材质)，下一步是可有可无的，但我想在本教程中包括它，因为它通常是3D场景的重要组成部分。</p><p id="89d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先我们将创建一个<strong class="jp ir"> <em class="kl">点光源</em> </strong>(该库中有其他几种类型的<a class="ae km" href="https://threejs.org/docs/#api/lights/Light" rel="noopener ugc nofollow" target="_blank">光源</a>):</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="ceb9" class="mu la iq nt b gy nx ny l nz oa">const pointLight = new THREE.PointLight(0xFFFFFF);</span></pre><p id="786d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们设置灯光的位置:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="b7c2" class="mu la iq nt b gy nx ny l nz oa">pointLight.position.x = 10;</span><span id="2f7a" class="mu la iq nt b gy oh ny l nz oa">pointLight.position.y = 50;</span><span id="a7d1" class="mu la iq nt b gy oh ny l nz oa">pointLight.position.z = 400;</span></pre><p id="96be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们将它添加到场景中:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="0709" class="mu la iq nt b gy nx ny l nz oa">scene.add(pointLight);</span></pre><p id="348b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，如果您在浏览器中打开HTML文件，您应该会看到一个静态的地球仪。让我们开始制作动画吧！</p><h1 id="3af3" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">创建动画</h1><p id="dc20" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">我将创建两组函数:一组用于用箭头键旋转地球仪(步骤12)，另一组用于在鼠标移动时旋转地球仪(步骤13)。<em class="kl">注意:我在这里主要使用我自己的代码。Three.js确实提供了</em> <a class="ae km" href="https://threejs.org/docs/index.html#manual/introduction/Animation-system" rel="noopener ugc nofollow" target="_blank"> <em class="kl">动画系统</em> </a> <em class="kl">和</em> <a class="ae km" href="https://videlais.com/2017/01/15/learning-three-js-part-5-controls/" rel="noopener ugc nofollow" target="_blank"> <em class="kl">控件</em> </a> <em class="kl">，但是我自己还没有成功实现这个内置功能。</em></p><p id="2be6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 11。设置</strong></p><p id="b9bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将为内置的<strong class="jp ir"><em class="kl">request animation frame</em></strong>设置<strong class="jp ir"> <em class="kl"> update </em> </strong> <em class="kl"> </em>函数来初始渲染我们的场景，并在更改后重新渲染我们的场景:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="c0ba" class="mu la iq nt b gy nx ny l nz oa">function update () {</span><span id="72f5" class="mu la iq nt b gy oh ny l nz oa"><br/>  //Render:</span><span id="a1d3" class="mu la iq nt b gy oh ny l nz oa">  renderer.render(scene, camera);<br/></span><span id="1c22" class="mu la iq nt b gy oh ny l nz oa">  // Schedule the next frame:</span><span id="0c6e" class="mu la iq nt b gy oh ny l nz oa">  requestAnimationFrame(update);  </span><span id="b2e6" class="mu la iq nt b gy oh ny l nz oa">}<br/></span><span id="b01d" class="mu la iq nt b gy oh ny l nz oa">// Schedule the first frame:</span><span id="8c9b" class="mu la iq nt b gy oh ny l nz oa">requestAnimationFrame(update);</span></pre><p id="07b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 12。按下</strong>箭头键旋转</p><p id="a2a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了让我们的地球仪基于箭头键旋转，首先我们将定义一个函数，它接受一个方向并相应地旋转地球仪(基于方向，旋转+-x或+-y):</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="f446" class="mu la iq nt b gy nx ny l nz oa">function animationBuilder(direction) {</span><span id="fada" class="mu la iq nt b gy oh ny l nz oa">  return function animateRotate() {</span><span id="20f6" class="mu la iq nt b gy oh ny l nz oa">    switch (direction) {</span><span id="7af5" class="mu la iq nt b gy oh ny l nz oa">      case 'up':</span><span id="7d05" class="mu la iq nt b gy oh ny l nz oa">        globe.rotation.x -= 0.2;</span><span id="f63e" class="mu la iq nt b gy oh ny l nz oa">        break;</span><span id="0993" class="mu la iq nt b gy oh ny l nz oa">      case 'down':</span><span id="db63" class="mu la iq nt b gy oh ny l nz oa">        globe.rotation.x += 0.2;</span><span id="796c" class="mu la iq nt b gy oh ny l nz oa">        break;</span><span id="5655" class="mu la iq nt b gy oh ny l nz oa">      case 'left':</span><span id="78d0" class="mu la iq nt b gy oh ny l nz oa">        globe.rotation.y -= 0.2;</span><span id="d492" class="mu la iq nt b gy oh ny l nz oa">        break;</span><span id="b88b" class="mu la iq nt b gy oh ny l nz oa">      case 'right':</span><span id="dc7d" class="mu la iq nt b gy oh ny l nz oa">        globe.rotation.y += 0.2;</span><span id="d2e7" class="mu la iq nt b gy oh ny l nz oa">        break;</span><span id="db75" class="mu la iq nt b gy oh ny l nz oa">      default:</span><span id="de30" class="mu la iq nt b gy oh ny l nz oa">        break;</span><span id="d5dd" class="mu la iq nt b gy oh ny l nz oa">    }</span><span id="cac8" class="mu la iq nt b gy oh ny l nz oa">  }</span><span id="2bc4" class="mu la iq nt b gy oh ny l nz oa">}</span></pre><p id="6e9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将创建一个directions对象，在其中存储每个方向的适当动画调用:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="c3cb" class="mu la iq nt b gy nx ny l nz oa">var animateDirection = {</span><span id="0a18" class="mu la iq nt b gy oh ny l nz oa">  up: animationBuilder('up'),</span><span id="c80f" class="mu la iq nt b gy oh ny l nz oa">  down: animationBuilder('down'),</span><span id="7f53" class="mu la iq nt b gy oh ny l nz oa">  left: animationBuilder('left'),</span><span id="50fb" class="mu la iq nt b gy oh ny l nz oa">  right: animationBuilder('right')</span><span id="bc4a" class="mu la iq nt b gy oh ny l nz oa">}</span></pre><p id="b991" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们将定义我们希望在按键后发生的监听器函数:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="d41c" class="mu la iq nt b gy nx ny l nz oa">function checkKey(e) {</span><span id="d276" class="mu la iq nt b gy oh ny l nz oa">  e = e || window.event;</span><span id="5a22" class="mu la iq nt b gy oh ny l nz oa">  e.preventDefault();</span><span id="a528" class="mu la iq nt b gy oh ny l nz oa"> <br/>  //based on keycode, trigger appropriate animation:</span><span id="1857" class="mu la iq nt b gy oh ny l nz oa">  if (e.keyCode == '38') {</span><span id="f314" class="mu la iq nt b gy oh ny l nz oa">    animateDirection.up();</span><span id="acec" class="mu la iq nt b gy oh ny l nz oa">  } else if (e.keyCode == '40') {</span><span id="ced6" class="mu la iq nt b gy oh ny l nz oa">    animateDirection.down();</span><span id="c9bd" class="mu la iq nt b gy oh ny l nz oa">  } else if (e.keyCode == '37') {</span><span id="e31b" class="mu la iq nt b gy oh ny l nz oa">    animateDirection.left();</span><span id="e155" class="mu la iq nt b gy oh ny l nz oa">  } else if (e.keyCode == '39') {</span><span id="0d63" class="mu la iq nt b gy oh ny l nz oa">    animateDirection.right();</span><span id="38e2" class="mu la iq nt b gy oh ny l nz oa">  }</span><span id="cc3e" class="mu la iq nt b gy oh ny l nz oa">}</span></pre><p id="d830" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，按键时，我们将调用上面的监听器函数:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="3697" class="mu la iq nt b gy nx ny l nz oa">document.onkeydown = checkKey;</span></pre><p id="2d17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，您应该能够使用箭头键来控制地球的旋转。</p><p id="200a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 13。鼠标移动时旋转</strong></p><p id="5011" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我最喜欢的部分，因为当你用鼠标或触控板控制地球时，几乎感觉像是用自己的手在旋转地球。</p><p id="48c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将设置一个数组来存储我们以前的鼠标位置，其起始值位于页面的中心:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="4f5e" class="mu la iq nt b gy nx ny l nz oa">var lastMove = [window.innerWidth/2, window.innerHeight/2];</span></pre><p id="46d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将定义一个在鼠标移动时触发的侦听器函数:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="cb85" class="mu la iq nt b gy nx ny l nz oa">function rotateOnMouseMove(e) {</span><span id="c898" class="mu la iq nt b gy oh ny l nz oa">  e = e || window.event;</span><span id="6000" class="mu la iq nt b gy oh ny l nz oa"><br/>  //calculate difference between current and last mouse position</span><span id="03d5" class="mu la iq nt b gy oh ny l nz oa">  const moveX = ( e.clientX - lastMove[0]);</span><span id="4faf" class="mu la iq nt b gy oh ny l nz oa">  const moveY = ( e.clientY - lastMove[1]);</span><span id="759b" class="mu la iq nt b gy oh ny l nz oa">  //rotate the globe based on distance of mouse moves (x and y) </span><span id="aa81" class="mu la iq nt b gy oh ny l nz oa">  globe.rotation.y += ( moveX * .005);</span><span id="ed54" class="mu la iq nt b gy oh ny l nz oa">  globe.rotation.x += ( moveY * .005);</span><span id="5777" class="mu la iq nt b gy oh ny l nz oa"><br/>  //store new position in lastMove</span><span id="2fc5" class="mu la iq nt b gy oh ny l nz oa">  lastMove[0] = e.clientX;</span><span id="c6b4" class="mu la iq nt b gy oh ny l nz oa">  lastMove[1] = e.clientY;</span><span id="e97e" class="mu la iq nt b gy oh ny l nz oa">}</span></pre><p id="9fe2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们定义我们的事件监听器:</p><pre class="ko kp kq kr gt ns nt nu nv aw nw bi"><span id="4dd5" class="mu la iq nt b gy nx ny l nz oa">document.addEventListener('mousemove', rotateOnMouseMove);</span></pre><p id="f627" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你知道了！</p><p id="996b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随意试验球体的纹理/图像(其他星球？)，背景(加明星？)、动画(缩放、调整大小……)等等。还有其他三个. js地球仪<a class="ae km" href="http://learningthreejs.com/blog/2013/09/16/how-to-make-the-earth-in-webgl/" rel="noopener ugc nofollow" target="_blank">在那里，我很想在评论中看到你自己的变化！</a></p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="fa77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你喜欢这个入门练习。一旦你习惯使用这个库，一定要尝试一些<a class="ae km" href="https://www.sitepoint.com/bringing-vr-to-web-google-cardboard-three-js/" rel="noopener ugc nofollow" target="_blank">更复杂的教程</a>，这将真正让你建立一个交互式的虚拟现实体验。(虽然我自己要完全了解这个库还有很长的路要走，但我很高兴知道像<a class="ae km" href="http://www.ashortjourney.com/" rel="noopener ugc nofollow" target="_blank">短途旅行</a>和<a class="ae km" href="https://paperplanes.world/" rel="noopener ugc nofollow" target="_blank">纸飞机</a>这样的应用程序就是用它创建的。)</p><p id="2901" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能也有兴趣看看脸书的<a class="ae km" href="https://facebook.github.io/react-vr/" rel="noopener ugc nofollow" target="_blank">React VR</a>…我知道我是！</p></div></div>    
</body>
</html>