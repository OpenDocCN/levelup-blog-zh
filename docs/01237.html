<html>
<head>
<title>Reactive Form Validation with Smooth Scrolling to Errors in Angular 8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应式表单验证，平滑滚动到角度8中的错误</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/reactive-form-validation-with-smooth-scrolling-to-errors-in-angular-8-57fa63b2689d?source=collection_archive---------1-----------------------#2019-12-03">https://levelup.gitconnected.com/reactive-form-validation-with-smooth-scrolling-to-errors-in-angular-8-57fa63b2689d?source=collection_archive---------1-----------------------#2019-12-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7814" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过平滑滚动到无效元素来聚焦表单错误</h2></div><p id="4fcf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我首先向您展示最终的结果:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/1614615e64c6c8e003f0384f78aacae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*CohzNFlH5HzL7_Fub0jyiw.gif"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">最后结局</figcaption></figure><p id="c8bc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的动画显示，在您单击提交按钮后，您的屏幕将关注第一个验证错误，因为字段没有填写(无效表单)。因此，用户知道在提交表单之前需要检查哪些字段。</p><p id="3e7e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您有一个包含多个输入字段的长表单，这样您可以看到从底部到特定验证错误的平滑滚动，这是合适的，并且更具交互性。</p><p id="3f23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们进行第一步。</p><h1 id="29b3" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">用Bootstrap构建角度工程</h1><p id="cc58" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">这里我使用Angular 8和Bootstrap来设置这个项目。你可以点击<a class="ae mr" href="https://medium.com/javascript-in-plain-english/build-angular-8-project-with-bootstrap-7b89775e5764" rel="noopener">这里</a>，查看我之前写的关于如何逐步建立Angular 8项目的文章。</p><p id="f8ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在Angular中只使用了<code class="fe ms mt mu mv b">app</code>组件，没有创建任何其他组件，因为它只涉及一个页面，下面是文件夹的结构。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/0339318cd25c7c4b65d80253c3f9e2de.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*vEPcMKOtkXEjpliZOTl1Qg.png"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">文件夹结构</figcaption></figure><p id="782b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于我们将使用反应式表单而不是模板驱动表单(我更熟悉)，我们需要将反应式表单模块导入到<code class="fe ms mt mu mv b">app.module.ts</code>中。</p><p id="40a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">应用模块ts </strong></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mx"><img src="../Images/0952994e97f47d86cad221b624083cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BsibDK93YGUVeWMkJSQEnQ.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">应用程序模块</figcaption></figure><p id="4272" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者你可以在这里查看我的代码<a class="ae mr" href="https://gist.github.com/aimanrahmattt/bcd8e8ac095ab237f8e9bad01baeb608" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="02d0" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">用验证器创建一个基本的注册表单</h1><p id="66e7" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">接下来，我们将创建一个基本的注册表单，其中包括输入字段，如名字、姓氏、用户名、电子邮件、密码和确认密码。您可以根据需要添加更多字段，以便在最后可以清楚地看到平滑滚动。</p><blockquote class="my mz na"><p id="675c" class="ki kj nb kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated">下面是我的<a class="ae mr" href="https://gist.github.com/aimanrahmattt/e616a0e640082a13b826e4b83832dd1f" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"/></a><strong class="kk iu"/>和<a class="ae mr" href="https://gist.github.com/aimanrahmattt/b4b5df9da5c95d857e1ee684582bd1ae" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">app . component . ts</strong></a><strong class="kk iu">。</strong>这些文件包括我们在本文结束之前将要创建的所有函数和视图。</p></blockquote><p id="bcd1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们添加了<code class="fe ms mt mu mv b">Validators.required</code>来确保在提交表单之前需要填写所有的字段。使用<code class="fe ms mt mu mv b">Validators.pattern</code>而不是<code class="fe ms mt mu mv b">Validators.email</code>来检查邮件有效性，因为我发现使用<code class="fe ms mt mu mv b">Validators.email</code>时<strong class="kk iu"> abc@gmail </strong>被认为是有效的。这就是为什么<code class="fe ms mt mu mv b">Validators.pattern</code>在这里更受欢迎。模式如下:</p><pre class="lf lg lh li gt nf mv ng nh aw ni bi"><span id="7006" class="nj lv it mv b gy nk nl l nm nn">Validators.pattern('[a-zA-Z0-9.-]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{3,}')</span></pre><p id="4381" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用以下方法将密码的最小长度设置为6个字符:</p><pre class="lf lg lh li gt nf mv ng nh aw ni bi"><span id="77aa" class="nj lv it mv b gy nk nl l nm nn">Validators.minLength(6)</span></pre><p id="6e98" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了确保确认密码与输入的密码匹配，创建了一个新的名为<code class="fe ms mt mu mv b"><strong class="kk iu">mustMatch</strong></code>的自定义验证函数，如下所示:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi no"><img src="../Images/ad25e23ef2791d3f743dba360c11912f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uZYgLFR9F8JEIF2NjIOfwQ.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">mustMatch函数</figcaption></figure><p id="3e6e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们已经成功构建了表单，请尝试单击submit按钮，不要在表单中添加任何详细信息，验证错误应该会弹出，如下所示:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/119ed91e6206b4b9ae6f94685744ddb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SUDPbdtXAeoItTj3oGMzBw.gif"/></div></div></figure><p id="716e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还没有滚动到第一个验证错误。接下来，我们将实现平滑滚动效果。</p><h1 id="5cb3" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">创建平滑滚动</h1><p id="914d" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">为了实现平滑滚动，我们将使用JavaScript中的<code class="fe ms mt mu mv b">scrollIntoView()</code>函数。</p><p id="4a0f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建下面这两个函数，它们将完成工作。</p><pre class="lf lg lh li gt nf mv ng nh aw ni bi"><span id="76e1" class="nj lv it mv b gy nk nl l nm nn">scrollTo(el: Element): void {<br/>   if (el) {<br/>      el.scrollIntoView({ behavior: 'smooth', block: 'center' });<br/>   }<br/>}</span><span id="1531" class="nj lv it mv b gy np nl l nm nn">scrollToError(): void {<br/>   const firstElementWithError = document.querySelector('.ng-  invalid[formControlName]');<br/>   this.scrollTo(firstElementWithError);<br/>}</span></pre><p id="1e23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ms mt mu mv b">scrollIntoView</code>中的<strong class="kk iu">行为</strong>属性有2个值。默认情况下，它将设置为<code class="fe ms mt mu mv b">auto</code>。您也可以设置<strong class="kk iu">块</strong>属性的值。我更喜欢把它设置为<code class="fe ms mt mu mv b">center</code>，因为它会聚焦在你屏幕的中央。点击<a class="ae mr" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView" rel="noopener ugc nofollow" target="_blank">此处</a>查看关于<code class="fe ms mt mu mv b">scrollIntoView</code>的详细说明。</p><p id="fec0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ms mt mu mv b">querySelector()</code>用于查找和选择页面上你想要关注的元素。这里我们将找到属性为<code class="fe ms mt mu mv b">formControlName</code>的<code class="fe ms mt mu mv b">ng-invalid</code>类。</p><p id="eace" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里再次是<a class="ae mr" href="https://gist.github.com/aimanrahmattt/e616a0e640082a13b826e4b83832dd1f" rel="noopener ugc nofollow" target="_blank">app.component.html</a>和<a class="ae mr" href="https://gist.github.com/aimanrahmattt/b4b5df9da5c95d857e1ee684582bd1ae" rel="noopener ugc nofollow" target="_blank"> app.component.ts </a>你可以参考完成本教程。</p><h1 id="93f2" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><p id="6904" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">在本文中，我们学习了如何创建一个完整的带有多重验证的反应式表单。</p><p id="2759" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还实现了平滑滚动，以关注验证错误，为用户提供更好的交互。</p><p id="ca16" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你认为这篇文章是有帮助的，不要忘记与你的朋友分享。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="96d4" class="lu lv it bd lw lx nx lz ma mb ny md me jz nz ka mg kc oa kd mi kf ob kg mk ml bi translated">资源</h1><ol class=""><li id="6900" class="oc od it kk b kl mm ko mn kr oe kv of kz og ld oh oi oj ok bi translated"><a class="ae mr" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/Element/scrollIntoView</a></li></ol></div></div>    
</body>
</html>