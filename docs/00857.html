<html>
<head>
<title>Laying the Groundwork for Custom Player Development with Deezer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Deezer为定制播放器开发奠定基础</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/laying-the-groundwork-for-custom-player-development-with-deezer-11f44a3f3006?source=collection_archive---------2-----------------------#2019-08-26">https://levelup.gitconnected.com/laying-the-groundwork-for-custom-player-development-with-deezer-11f44a3f3006?source=collection_archive---------2-----------------------#2019-08-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f72f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Deezer Javascript SDK简介</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bc85d1bae3c9f0dc03ab341df82cebe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fd9T39SlOJtwdPL9vquLhg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">新的Deezer标志</figcaption></figure><p id="8375" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我最近的很多工作都围绕着使用苹果音乐和Spotify提供给开发者的平台，为我的客户和他们的粉丝建立独特的体验。这些体验可能包括自定义播放器、播放列表生成或音频特征分析。最近，我收到一个额外的请求:<em class="lt">你能集成Deezer吗？</em>我不是全球市场份额方面的专家，但我可以有把握地说，总部位于巴黎的<a class="ae lu" href="https://en.wikipedia.org/wiki/Deezer" rel="noopener ugc nofollow" target="_blank"> Deezer </a>对国际营销战略非常重要。</p><p id="a920" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">直到最近，我才知道Deezer为开发者提供的平台，但应我客户的要求，我花了很长时间查看了他们的<a class="ae lu" href="https://developers.deezer.com/api" rel="noopener ugc nofollow" target="_blank"> API </a>和<a class="ae lu" href="https://developers.deezer.com/sdk/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript SDK </a>。它实际上是相当广泛的，API覆盖了他们产品的所有对象(使用一个没有虚饰的url结构)和一个文档良好的Javascript库，使他们的服务集成到客户端应用程序变得容易。本质上，我应该能够在未来将Deezer集成到类似于<a class="ae lu" href="https://medium.com/@leemartin/turning-weather-into-music-with-dark-sky-and-spotify-for-tycho-f4f40aef97ed?source=friends_link&amp;sk=ea8afe07bd998dc93739a5f53f1cb8fa" rel="noopener"> Tycho </a>和<a class="ae lu" href="https://medium.com/@leemartin/broadcasting-a-dynamic-youtube-video-for-slipknot-8ca018fb7775?source=friends_link&amp;sk=3e7659fd8ea50f12e280cd6c838bf68d" rel="noopener"> Slipknot </a>的项目中。</p><p id="f94b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我想分享你将如何着手创建一个新的Deezer应用程序和开发一个非常简单的自定义音频播放器。作为一个额外的奖励，我包括一个链接到<a class="ae lu" href="https://glitch.com/~deezer-player" rel="noopener ugc nofollow" target="_blank">小故障</a>以便于重新混合。🎤</p><h2 id="755b" class="lv lw iq bd lx ly lz dn ma mb mc dp md le me mf mg li mh mi mj lm mk ml mm mn bi translated">创建Deezer应用程序</h2><p id="a139" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">请确保您已在Deezer注册，并访问其平台网站的“我的应用”部分<a class="ae lu" href="https://developers.deezer.com/myapps" rel="noopener ugc nofollow" target="_blank"/>。在这里你会发现一个“创建一个新的应用程序”链接。单击它开始创建您的新应用程序。此时，您需要为您的应用程序命名，说明它将从哪个域提供服务，告诉身份验证重定向到哪里(稍后将详细介绍)，提供一个指向您的术语将出现的位置的链接，最后描述您的应用程序。假设这个玩家生活在Glitch上，我是这样填写这个表格的:</p><ul class=""><li id="d467" class="mt mu iq kx b ky kz lb lc le mv li mw lm mx lq my mz na nb bi translated">名称:故障播放器</li><li id="1e11" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">域:<a class="ae lu" href="https://deezer-player.glitch.me" rel="noopener ugc nofollow" target="_blank">https://deezer-player . glitch . me</a></li><li id="71f7" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">重定向URL:<a class="ae lu" href="https://deezer-player.glitch.me" rel="noopener ugc nofollow" target="_blank">https://deezer-player . glitch . me</a>/callback</li><li id="2ab0" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">条款链接:<a class="ae lu" href="https://deezer-player.glitch.me" rel="noopener ugc nofollow" target="_blank">https://deezer-player . glitch . me</a></li><li id="3b9d" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">描述:一个简单的自定义Deezer播放器建立在Glitch上</li></ul><p id="b7dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同意Deezer平台政策，点击“创建”，您将成功创建一个新的Deezer应用程序。您将立即被重定向到应用程序摘要页面。请记下应用程序ID，因为我们很快就会用到它。</p><h2 id="64fb" class="lv lw iq bd lx ly lz dn ma mb mc dp md le me mf mg li mh mi mj lm mk ml mm mn bi translated">初始化JavaScript SDK和播放器</h2><p id="9ab1" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">回到Glitch，首先创建通道URL，Deezer将使用它进行跨域通信。你可以通过点击“新建文件”并将其命名为<code class="fe nh ni nj nk b">callback/index.html</code>来实现。在这个文件中，您只需要包含Deezer SDK:</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="ee19" class="lv lw iq nk b gy np nq l nr ns">&lt;script src="<a class="ae lu" href="https://e-cdns-files.dzcdn.net/js/min/dz.js" rel="noopener ugc nofollow" target="_blank">https://e-cdns-files.dzcdn.net/js/min/dz.js</a>"&gt;&lt;/script&gt;</span></pre><p id="c79b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">像任何web应用程序一样，我们将有一个包含我们的播放器元素的<code class="fe nh ni nj nk b">index.html</code>文件和一个包含让它做一些事情所需的所有逻辑的JavaScript文件。HTML文件可以非常简单地开始。Deezer只是要求我们包含他们的JavaScript SDK和id为“dz-root”的<code class="fe nh ni nj nk b">div</code>我们还将包含一个到脚本文件的链接，一个用于登录的<code class="fe nh ni nj nk b">button</code>，以及另一个用于切换播放的<code class="fe nh ni nj nk b">button</code>。让我们隐藏切换按钮，直到我们的用户成功登录。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="5761" class="lv lw iq nk b gy np nq l nr ns">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Deezer Player&lt;/title&gt;<br/>    &lt;script src="/script.js"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;button id="login"&gt;Login to Deezer&lt;/button&gt;<br/>    &lt;button id="toggle" style="display:none"&gt;Toggle Playback&lt;/button&gt;<br/>    &lt;div id="dz-root"&gt;&lt;/div&gt;<br/>    &lt;script src="<a class="ae lu" href="https://e-cdns-files.dzcdn.net/js/min/dz.js" rel="noopener ugc nofollow" target="_blank">https://e-cdns-files.dzcdn.net/js/min/dz.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3601" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们关于Glitch的<code class="fe nh ni nj nk b">script.js</code>文件中，我们将初始化Deezer SDK，加载一个播放器，并使用<code class="fe nh ni nj nk b">DZ.player.playTracks</code>方法加载新的Lower Dens曲目<a class="ae lu" href="https://www.deezer.com/track/654870372?utm_source=deezer&amp;utm_content=track-654870372&amp;utm_term=1394785248_1566832171&amp;utm_medium=web" rel="noopener ugc nofollow" target="_blank">“Galapagos”</a>，将autoplay设置为<code class="fe nh ni nj nk b">false</code>。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="bb27" class="lv lw iq nk b gy np nq l nr ns">DZ.init({<br/>  appId: 'YOUR_APP_ID',<br/>  channelUrl: '<a class="ae lu" href="https://deezer-player.glitch.me/callback" rel="noopener ugc nofollow" target="_blank">https://deezer-player.glitch.me/callback</a>',<br/>  player: {<br/>    onload: function() {<br/>      DZ.player.playTracks([654870372], false)<br/>    }<br/>  }<br/>})</span></pre><p id="8663" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">随着SDK的初始化和我们的播放器准备就绪，让我们登录用户并开始播放曲目。</p><h2 id="9f99" class="lv lw iq bd lx ly lz dn ma mb mc dp md le me mf mg li mh mi mj lm mk ml mm mn bi translated">认证和回放</h2><p id="1d52" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">让我们连接登录按钮来调用<code class="fe nh ni nj nk b">DZ.login</code>方法，并允许我们的用户连接到Deezer。这将允许Deezer用户通过您的自定义播放器完整播放曲目。一旦用户成功登录，我们将隐藏登录按钮，显示切换按钮，并使用<code class="fe nh ni nj nk b">DZ.player.play</code>方法开始回放。很简单。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="2624" class="lv lw iq nk b gy np nq l nr ns">let login  = document.getElementById('login')<br/>let toggle = document.getElementById('toggle')</span><span id="c561" class="lv lw iq nk b gy nt nq l nr ns">login.onclick = function() {<br/>  DZ.login(function(response) {<br/>    if (response.authResponse) {<br/>      toggle.style.display = "block"<br/>      login.style.display  = "none"            </span><span id="4d7d" class="lv lw iq nk b gy nt nq l nr ns">      DZ.player.play()<br/>    } else {<br/>      // login failed<br/>    }<br/>  })<br/>}</span></pre><p id="245b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，在我们登录之前，让我们将切换按钮连接到<em class="lt">来切换</em>当前播放曲目的回放。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="cacf" class="lv lw iq nk b gy np nq l nr ns">toggle.onclick = function() {<br/>  if (DZ.player.isPlaying()) {<br/>    DZ.player.pause()<br/>  } else {<br/>    DZ.player.play()<br/>  }<br/>}</span></pre><p id="9430" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，您可以单击登录按钮登录Deezer，并通过切换按钮控制曲目的播放。</p><h2 id="82d4" class="lv lw iq bd lx ly lz dn ma mb mc dp md le me mf mg li mh mi mj lm mk ml mm mn bi translated">后续步骤</h2><p id="0183" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">我知道你在想什么。真的吗李？一个切换按钮！？嗯，我相信这让你在一个伟大的地方，建立更多的功能，并开始定制你的播放器。你可能想看看Deezer提供的其他控制播放器的<a class="ae lu" href="https://developers.deezer.com/sdk/javascript/controls" rel="noopener ugc nofollow" target="_blank">方法</a>和构建播放器UI时可能需要的<a class="ae lu" href="https://developers.deezer.com/sdk/javascript/player_object" rel="noopener ugc nofollow" target="_blank">属性</a>。同样重要的是你可以订阅的所有玩家事件，以确保你的用户界面对正在发生的事情做出反应。</p><h2 id="e54e" class="lv lw iq bd lx ly lz dn ma mb mc dp md le me mf mg li mh mi mj lm mk ml mm mn bi translated">Deezer的反馈</h2><p id="d827" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">总的来说，我真的很喜欢我从Deezer平台上看到的东西，并期待将其集成到未来的项目中。不过，我确实有一些重要的反馈:</p><ul class=""><li id="2376" class="mt mu iq kx b ky kz lb lc le mv li mw lm mx lq my mz na nb bi translated">我对频道文件和重定向url的互换使用有点困惑。我会简单地调用这个回调url，这似乎是大多数auth文档中的标准。</li><li id="a4f0" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">我无法在本地主机上让回放工作，必须部署(或在Glitch这样的网站上开发)才能让它工作。</li><li id="a639" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">能够为开发和生产环境提供多个回调URL将会很有帮助。与此同时，开发人员可以设置一个用于本地开发的应用程序<em class="lt">和用于已部署产品的各种生产应用程序。</em></li></ul><p id="5df3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦这个平台进入我的工作，我会分享更多关于它的信息。如果您有任何问题，请告诉我，祝您好运！</p></div></div>    
</body>
</html>