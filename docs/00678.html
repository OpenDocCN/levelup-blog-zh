<html>
<head>
<title>How to Build a Custom Discord Bot with Discord.js and Node</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Discord.js和Node构建自定义的Discord Bot</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/making-a-custom-discord-bot-in-discord-js-1e17f2090919?source=collection_archive---------0-----------------------#2019-06-26">https://levelup.gitconnected.com/making-a-custom-discord-bot-in-discord-js-1e17f2090919?source=collection_archive---------0-----------------------#2019-06-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d365" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">制作一个不和谐机器人从来没有这么容易过，尤其是如果你有一些编程经验的话。在本文中，我将带你使用Discord.js创建你自己的不和谐机器人。</p><p id="3fdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在我们开始之前，我想提一下，如果你技术不太熟练，你可以看看</strong><a class="ae kl" href="https://discordbotstudio.org" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">Discord Bot Studio</strong></a><strong class="jp ir">，这是我创建的一个应用程序，允许你不用编码就可以定制机器人(现在免费！).现在让我们开始编码。</strong></p><p id="c24a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将:</p><ol class=""><li id="10ff" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">安装Node.js和discord.js。</li><li id="675c" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">从Discord获取我们机器人的证书。</li><li id="f23e" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">编写带有消息响应的命令。</li><li id="f6fe" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">编写带有图像响应的命令。</li></ol><p id="9d00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们首先需要的是Node，我们将用它来安装discord.js NPM模块。你可以在这里下载节点<a class="ae kl" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">。您可以通过在命令提示符或终端中键入<strong class="jp ir"> node </strong>进行测试，以确保安装了node。然后，您应该能够在那里开始编写Javascript语句。</a></p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/b9921088f605c6579b2aaddd1edeb485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XeYiAYNo_Mlwn4DZepQ47g.png"/></div></div></figure><p id="8df9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里有一个终端中的node的例子，计算语句1 + 1，得到2作为输出。您可以在这里尝试运行任何其他Javascript语句。</p><p id="c7eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经有了节点，我们可以继续安装discord.js了。</p><p id="bf15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在终端中运行以下命令:</p><pre class="lb lc ld le gt lm ln lo lp aw lq bi"><span id="fa6f" class="lr ls iq ln b gy lt lu l lv lw">npm install discord.js</span></pre><p id="7f97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经安装好了，打开一个文本编辑器并创建一个名为<code class="fe lx ly lz ln b">index.js</code>的新文件。然后在创建index.js的文件夹中运行以下命令:</p><pre class="lb lc ld le gt lm ln lo lp aw lq bi"><span id="d3e7" class="lr ls iq ln b gy lt lu l lv lw">npm init</span></pre><p id="a3ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将创建一个<code class="fe lx ly lz ln b">package.json</code>文件，供您的项目稍后使用。</p><p id="d95a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在将从不和谐中获得我们的机器人令牌。可以在这里找到:<a class="ae kl" href="https://discordapp.com/developers/applications/" rel="noopener ugc nofollow" target="_blank">https://discordapp.com/developers/applications/</a></p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi ma"><img src="../Images/d889249e2b6f66d04f95c21a54aabd17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6UFfuDLXEwtjcOYYfRo8ww.png"/></div></div></figure><p id="347d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击您的应用程序，或者创建一个新的应用程序(如果您还没有)。然后，您可以导航到“bot”选项卡来检索您的令牌。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi mb"><img src="../Images/f06247b2adcf50304df71feb5ad60c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Id2VFBfnolNGlEbwkDUdww.png"/></div></div></figure><p id="4753" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以将令牌粘贴到<code class="fe lx ly lz ln b">index.js </code>中的以下代码中(用我们上面复制的令牌替换<code class="fe lx ly lz ln b">‘token’</code>):</p><pre class="lb lc ld le gt lm ln lo lp aw lq bi"><span id="1812" class="lr ls iq ln b gy lt lu l lv lw">const Discord = require('discord.js'); <br/>const client = new Discord.Client();  <br/>client.on('ready', () =&gt; {   <br/>    console.log(`Logged in as ${client.user.tag}!`); <br/>});</span><span id="e6e2" class="lr ls iq ln b gy mc lu l lv lw">client.on('message', msg =&gt; {  <br/>    if(message.author.bot) return;<br/>    if (msg.content === 'ping') {     <br/>        msg.reply('Pong!');   <br/>    } <br/>});</span><span id="9633" class="lr ls iq ln b gy mc lu l lv lw">client.login('token');</span></pre><p id="54b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看上面的代码，它直接来自discord.js站点。</p><ul class=""><li id="b2e9" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk md ks kt ku bi translated">第一行需要discord.js模块，以便我们可以在项目中使用它。</li><li id="aaf8" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk md ks kt ku bi translated">第二行是实例化一个名为<code class="fe lx ly lz ln b">client</code>的<code class="fe lx ly lz ln b">new Discord.Client()</code>对象，这个对象会被频繁使用。</li><li id="c450" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk md ks kt ku bi translated">然后有两个事件处理程序，一个用于客户端准备好的时候，另一个用于客户端从服务器收到消息的时候。我们在消息处理程序中检查写消息的人是否是机器人，如果是，我们忽略它。</li></ul><p id="4386" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以看到，当收到文本为“ping”的消息时，我们调用<code class="fe lx ly lz ln b">msg.reply(‘Pong!’)</code>。这意味着我们的机器人将写回‘Pong！’当它接收到命令“ping”时。</p><p id="16b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来测试一下。在包含index.js和package.json文件的文件夹中打开命令提示符或终端，并在CLI中运行以下命令:</p><pre class="lb lc ld le gt lm ln lo lp aw lq bi"><span id="e788" class="lr ls iq ln b gy lt lu l lv lw">node index.js</span></pre><p id="dc97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这告诉我们的应用程序开始，如果一切设置正确，您将收到一条消息，说明机器人已经登录。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi me"><img src="../Images/a7430aa063f48172dd4047954426fe49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avMwE4Hi0bUyFEFEzebMxg.png"/></div></div></figure><p id="0c8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们邀请机器人加入服务器。返回到Discord开发人员网站，并导航到OAuth2选项卡:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi mf"><img src="../Images/d87c12e991d28c197a171f1a319a9559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vDkNnnsGbwkny3nG5teagw.png"/></div></div></figure><p id="5ba7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，您将选中bot复选框，然后向下滚动以设置您希望bot拥有的权限。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi mg"><img src="../Images/a5d8247a76982995476ac9d35554d9e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bsAZPAm4Ybh5uhhkAvmYZQ.png"/></div></div></figure><p id="1fdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，您可以单击复制按钮获取您的邀请链接。只需在浏览器中粘贴邀请链接，就会提示您将机器人添加到服务器。</p><p id="01db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以跳到Discord，看到我们的机器人被添加到选定的服务器。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/68f9ebda5071a7121dd915a0c12b77e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*FN75AIDe1FOXPrzfylM83g.png"/></div></figure><p id="a795" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以在聊天中写下我们的命令“ping ”,并查看我们的机器人的响应。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi mi"><img src="../Images/6f99ba2911264ee7f08190e91f254125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kx96vtDk9GT_YQVxZHzwoA.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">机器人回应了我们的命令，并标记了我们。</figcaption></figure><p id="f919" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">恭喜你。你有一个可以工作的机器人！那太好了，但是增加一些更有用的功能呢？</p><p id="e871" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">加个图片回应怎么样？让我们从上面扩展我们的代码:</p><pre class="lb lc ld le gt lm ln lo lp aw lq bi"><span id="ed89" class="lr ls iq ln b gy lt lu l lv lw">client.on('message', msg =&gt; {  <br/>    if(message.author.bot) return;</span><span id="a12d" class="lr ls iq ln b gy mc lu l lv lw">    if (msg.content === 'ping') {     <br/>        msg.reply('Pong!');   <br/>    } </span><span id="76b5" class="lr ls iq ln b gy mc lu l lv lw">   if (msg.content === 'koala') {<br/>        msg.reply('This is a koala!', {files:       ['<a class="ae kl" href="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Koala_climbing_tree.jpg/480px-Koala_climbing_tree.jpg" rel="noopener ugc nofollow" target="_blank">https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Koala_climbing_tree.jpg/480px-Koala_climbing_tree.jpg</a>']});</span><span id="ade9" class="lr ls iq ln b gy mc lu l lv lw">    }<br/>});</span></pre><p id="1ecb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我增加了一个新的条件来检查命令“考拉”。如果我们得到这个命令，我们将回复文本‘这是一只考拉！’以及一个图像URL。</p><p id="7a5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们再次启动我们的机器人并进行测试。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi mn"><img src="../Images/c5ad111eb3f27f83bedb1f68628fcfc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6QGigYMbAJ4p87KvLyEqg.png"/></div></div></figure><p id="dd83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">成功！我们使用相同的命令从机器人那里得到了文本和图像响应。</p><p id="4084" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以想象如何扩展这些原则来制作一个更复杂的机器人，有更多的功能。</p><p id="2045" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一篇文章中，我将讨论使用discord.js进行更高级的botting，包括以下主题:</p><ul class=""><li id="7af7" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk md ks kt ku bi translated">将命令存储在文件中，以便以编程方式读取。</li><li id="9616" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk md ks kt ku bi translated">处理服务器事件，比如用户加入通道，并对其进行操作。</li><li id="ca7a" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk md ks kt ku bi translated">命令前缀。</li><li id="bd7a" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk md ks kt ku bi translated">表情符号</li></ul><p id="6d61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，请随时查看<a class="ae kl" href="https://discordbotstudio.org" rel="noopener ugc nofollow" target="_blank">不和谐机器人工作室</a>，这是我做的一个应用程序，允许你不用编码就能创建机器人！你可以在那个链接注册成为测试用户(完全免费)。</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><div class="lb lc ld le gt mv"><a href="https://gitconnected.com/learn/node-js" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd ir gy z fp na fr fs nb fu fw ip bi translated">学习Node.js -最佳Node.js教程(2019) | gitconnected</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">排名前44的Node.js教程-免费学习Node.js。课程由开发人员提交和投票，使您能够…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">gitconnected.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj lk mv"/></div></div></a></div></div></div>    
</body>
</html>