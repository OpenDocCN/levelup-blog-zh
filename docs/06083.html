<html>
<head>
<title>Learn to properly define your own exceptions when built-in exceptions in python are insufficient</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当python中的内置异常不足时，要学会正确定义自己的异常</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/learn-to-properly-define-your-own-exceptions-when-built-in-exceptions-in-python-are-insufficient-3ff6a737d75a?source=collection_archive---------4-----------------------#2020-10-24">https://levelup.gitconnected.com/learn-to-properly-define-your-own-exceptions-when-built-in-exceptions-in-python-are-insufficient-3ff6a737d75a?source=collection_archive---------4-----------------------#2020-10-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9c16" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">pythons内置的异常很棒，但还不够好…</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0216fc94f1e359eb56667f75d4fe0e96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ityrZlPBlr060TBU2lRsSw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/photos/Vy2cHqm0mCs" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@woodies11" rel="noopener ugc nofollow" target="_blank">罗姆森·普里查维特</a>拍摄</figcaption></figure><p id="bd6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated"><span class="l lt lu lv bm lw lx ly lz ma di"> N </span> ew程序员经常对<a class="ae kv" href="https://docs.python.org/3/tutorial/errors.html" rel="noopener ugc nofollow" target="_blank">异常处理</a>的主题感到困惑，并寻找在他们现有的代码中采用异常处理的最佳实践，但是如果没有关于异常处理如何工作的正确知识，它可能会导致他们的程序行为异常。</p><p id="062e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将给出一个简单的用例，在这个用例中，使用内置python异常是不够的，并导致一个模糊的错误消息，我将解决这个问题，并尝试从最初使用内置异常开始进行改进，然后逐渐定义我们自己的自定义异常，以演示程序员在编写程序时的一个有点现实的思考过程</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="b79b" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">让我们从例子开始</h1><p id="ca09" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">这个程序试图计算一个三角形的面积。如果你还记得中学几何课上的话，如果三角形的任意两条边之和小于第三条边之和，那么这个三角形就是无效的。</p><p id="c680" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是这个函数的实现</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="273c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您在终端中运行两次，首先使用有效的边三角形(3，4，5)，然后使用无效的边三角形(3，4，10)</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ng l"/></div></figure><p id="34f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您得到一个<strong class="ky ir"> ValueError </strong>内置异常，带有一个消息有效负载“<strong class="ky ir">数学域错误”</strong>。如果我是这个程序的用户，我不知道这个错误意味着什么，也不知道如何纠正我的输入</p><p id="786f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们修改这个程序，并尝试在这里提出一个更具体的异常，在它的有效载荷中携带更多有用的信息来帮助我们的程序用户。定义一个继承自<strong class="ky ir"> Exception </strong>类的<strong class="ky ir"> TriangleError </strong>异常是一个好的开始。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="b376" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这看起来是一个非常简单的定义，确实足够了，因为它从基类<strong class="ky ir">异常继承了<em class="ni"> __init__ </em>、<em class="ni"> __str__ </em>和<em class="ni"> __repr__ </em>的实现。</strong></p><blockquote class="nj"><p id="7fd3" class="nk nl iq bd nm nn no np nq nr ns lr dk translated">如果我们只是想要一个独特的异常类，它有一些基本的功能，并且可以与其他异常类型分开处理和引发，那么这个定义就足够了，而且功能齐全</p></blockquote><p id="3d16" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">现在让我们修改我们的triangle_area函数来抛出这个异常</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="8f94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用同样的输入再次运行程序，我们得到</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ng l"/></div></figure><p id="a5da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该输出更好，因为用户可以清楚地识别出错误<strong class="ky ir"> TriangleError </strong>与三角形几何有关，并且我们正在创建无效的三角形。但是请注意，有效载荷信息没有提供任何关于侧面的信息，所以让我们继续努力</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="fc24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们重写了基类<em class="ni"> __init_ </em> _、<em class="ni"> __str__ </em>和<em class="ni"> __repr_的所有关键方法。</em> <strong class="ky ir"> </strong> <em class="ni">超级()。__init__(text) </em>将有效载荷消息存储到基类<strong class="ky ir">异常</strong>中。在<em class="ni"> __str__ </em>和<em class="ni"> __repr__ </em>中，我们通过<em class="ni"> self.args[0]检索来使用存储在基类中的有效负载消息。sides </em>被定义为一个属性，所以我们的实例变量可以像公共属性一样被访问。在这里使用属性<a class="ae kv" href="https://www.freecodecamp.org/news/python-property-decorator/" rel="noopener ugc nofollow" target="_blank">的更多优势</a></p><p id="bb67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们修改我们的<em class="ni"> triangle_area </em>函数来使用这个改进的错误类</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="f92e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们所要做的就是将<em class="ni"> sides </em>参数添加到<strong class="ky ir"> TriangleError </strong>类中。现在让我们运行这个例子</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ng l"/></div></figure><p id="0639" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看错误报告。看起来棒极了…不是吗？不仅用户得到了正确的错误类型，而且有效载荷信息也清楚地表明双方的输入是错误的。不仅如此，我们现在还可以在程序中处理这个异常，并检查它的有效载荷，以获得错误的边长。另外，请注意我们是如何访问sides属性的。这可以通过将边定义为属性来实现</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ng l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="8e06" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">结论</h1><p id="5592" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">内置异常有时不如自定义异常有用。您可以让您的程序传达与领域相关的信息，这在大型库或程序中非常有用</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="5ceb" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">快速链接</h1><blockquote class="ny nz oa"><p id="5606" class="kw kx ni ky b kz la jr lb lc ld ju le ob lg lh li oc lk ll lm od lo lp lq lr ij bi translated"><em class="iq"> P </em> <a class="ae kv" href="https://www.freecodecamp.org/news/python-property-decorator/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">属性装饰器使用</em> </a></p><p id="e1e2" class="kw kx ni ky b kz la jr lb lc ld ju le ob lg lh li oc lk ll lm od lo lp lq lr ij bi translated"><a class="ae kv" href="https://docs.python.org/3/tutorial/errors.html" rel="noopener ugc nofollow" target="_blank"><em class="iq">python中的异常处理</em> </a></p><p id="7bc4" class="kw kx ni ky b kz la jr lb lc ld ju le ob lg lh li oc lk ll lm od lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.geeksforgeeks.org/check-whether-triangle-valid-not-sides-given/#:~:text=Approach:%20A%20triangle%20is%20valid,three%20conditions%20should%20be%20met." rel="noopener ugc nofollow" target="_blank"> <em class="iq">无效三角形</em> </a></p></blockquote></div></div>    
</body>
</html>