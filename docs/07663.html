<html>
<head>
<title>Analytics vs Transactional Processing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析与交易处理</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/analytics-vs-transactional-processing-1118915a0ea7?source=collection_archive---------11-----------------------#2021-03-03">https://levelup.gitconnected.com/analytics-vs-transactional-processing-1118915a0ea7?source=collection_archive---------11-----------------------#2021-03-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="af9c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">OLTP、OLAP、星星和雪花</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7f5d3909bd4935f05a7125f65f52d18f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7uJyOAz_TH0zIWa-tO5WfQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/s/photos/snowflake-star?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@zmachacek?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">zdenk macha ek</a>拍摄的照片</figcaption></figure><p id="4058" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在商业数据处理的早期，对数据库的写操作通常对应于发生的商业交易:销售、向供应商下订单、支付员工工资等。事务不涉及货币交换，但术语事务是停滞的，指的是构成逻辑单元的一组读取和写入。</p><p id="dbf1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即使数据库开始用于许多不同类型的数据注释，例如博客帖子、游戏中的动作、地址簿中的联系人等。，基本的访问模式仍然类似于处理业务事务。应用程序通常使用索引通过某些键来查找少量记录。根据用户输入插入或更新记录。由于这些应用是交互式的，所以访问模式被称为<strong class="ky ir"> <em class="ls">在线事务处理</em> </strong> (OLTP)。</p><p id="d631" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，数据库也开始越来越多地用于数据分析，其访问模式非常不同。通常，分析查询需要扫描大量记录，只读取每条记录的几列，然后计算汇总统计数据(如计数、求和或平均)，而不是将原始数据返回给用户。例如，如果您的数据是销售交易表，则分析查询可能是:</p><ul class=""><li id="8df7" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">我们每个商店二月份的总收入是多少？</li><li id="3e0f" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">在最近的促销活动中，我们比平时多卖了多少苹果？</li><li id="ef75" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">哪个品牌的食物最常与芥末一起购买？</li></ul><p id="a916" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些查询通常由业务分析师编写，并输入到帮助公司管理层做出更好决策的报告中(商业智能)。为了将这种使用数据库的模式与事务处理区分开来，它被称为<strong class="ky ir"><em class="ls"/></strong>(OLAP)</p><p id="1003" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">起初，相同的数据库用于事务处理和分析查询。事实证明，SQL在这方面非常灵活:它既适用于OLTP类型的查询，也适用于OLAP类型的查询。然而，在20世纪80年代末和90年代初，有一种趋势是公司不再使用他们的OLTP系统进行分析，而是在单独的数据库上运行分析。这个独立的数据库称为数据仓库。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="75f0" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">数据仓库</strong></h2><p id="efd5" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">公司可能有几十种不同的交易处理系统:支持面向客户的网站的系统、实体店的销售点(结账)系统、仓库的库存跟踪、车辆的路线规划、供应商、员工的管理等。这些系统都很复杂，需要一组人来维护，所以这些系统最终基本上都是彼此独立运行的。</p><p id="30e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些OLTP系统通常被期望具有高可用性，并且能够以低延迟处理事务，因为它们通常对业务运营至关重要。因此，数据库管理员密切保护他们的OLTP数据库。他们通常不愿意让业务分析师在OLTP数据库上运行专门的分析查询，因为这些查询通常很昂贵，并且会扫描大部分数据集，这可能会损害并发执行事务的性能。</p><p id="61e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">相比之下，<strong class="ky ir"> <em class="ls">数据仓库</em> </strong>是一个独立的数据库，分析师可以在不影响OLTP操作的情况下查询其内部内容。数据仓库包含公司各种OLTP系统中数据的只读副本。从OLTP数据库中提取数据(使用定期数据转储或连续更新流)，将其转换为易于分析的模式，清理它，然后将其加载到数据仓库中。将数据放入仓库的过程称为<strong class="ky ir"> <em class="ls">提取-转换-加载</em> </strong> (ETL)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/40062e1a295ad455806c3335c774636a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NJzLr0DcOp3Lu1yNR76F5g.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自维基百科</figcaption></figure><p id="667e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，几乎所有的大型企业都有数据仓库，但在小型企业中，几乎闻所未闻。这可能是因为大多数小公司没有很多不同的OLTP系统，大多数小公司的数据量都很小。小到可以在常规SQL数据库中查询，甚至可以在电子表格中分析。在大公司，做一些在小公司很简单的事情，需要做很多繁重的工作。</p><p id="6665" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用单独的数据仓库而不是直接查询OLTP系统进行分析的一个很大的优点是，数据仓库可以针对分析访问模式进行优化。</p><h2 id="5610" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">OLTP数据库和数据仓库的区别</h2><p id="2a03" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">数据仓库的数据模型通常是关系型的，因为SQL通常非常适合分析查询。有许多图形数据分析工具可以生成SQL查询、可视化结果并允许分析师浏览数据(通过钻取、切片和切割等操作)。</p><p id="7e4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从表面上看，数据仓库和关系型OLTP数据库看起来很相似，因为它们都有SQL查询接口。然而，系统的内部可能看起来完全不同，因为它们针对非常不同的查询模式进行了优化。许多数据库供应商现在专注于支持事务处理或分析工作负载，但他们无法同时支持这两者。</p><p id="e5b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">某些数据库(如Microsoft SQL Server和SAP HANA)在同一产品中支持事务处理和数据仓库。然而，它们越来越成为两个独立的存储和查询引擎，恰好可以通过一个公共SQL接口访问。</p><p id="2f2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据仓库供应商(如Teradata、Vertica、SAP HANA和ParAccel)通常在昂贵的商业许可下销售他们的系统。亚马逊红移是ParAccel的托管版。最近有很多开源的基于SQL的Hadoop项目。他们很年轻，但目标是与商业数据仓库系统竞争。其中包括Apache Hive、Spark SQL、Cloudera Impala、脸书Presto、Apache Tajo和Apache Drill。其中一些是基于谷歌Dremel的想法。</p><h2 id="913a" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">星星和雪花图式</h2><p id="c410" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">许多数据仓库以一种相当公式化的方式使用，称为<strong class="ky ir"><em class="ls"/></strong>(也称为维度建模)。</p><p id="2d66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的示例模式是使用start模式模式建模的。该模式的中心是所谓的<em class="ls">事实表</em>。事实表的每一行代表在特定时间发生的事件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/03372bcc847cd1ba8c66d8585af18e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/0*jND8rwhngtv2_21s.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自guru99.com</figcaption></figure><p id="31cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常，这些事实是作为单个事件捕获的，因为这为以后的分析提供了最大的灵活性。然而，这意味着事实表会变得非常大。像苹果、沃尔玛或易贝这样的大公司的数据仓库中可能有几十Pb的交易历史，其中大部分实际上都是表。</p><p id="3897" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事实表中的一些列是属性，例如产品的销售量和收入。事实表中的其他列是对其他表(称为维度表)的外键引用。因为事实表中的每一行都代表一个事件，所以维度代表事件的人员、事件、位置、时间、方法和原因。</p><p id="ce3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">甚至日期和时间通常也由维度表表示，因为这可以对有关日期的其他信息(如公共假日)进行编码，以便查询可以区分假日和非假日期间的销售。</p><p id="f596" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“星型模式”这个名字来源于这样一个事实:当可视化表关系时，事实表位于中间，并被它的维度表所包围；与这些表的联系就像星星的光。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/7b3a1f21953c7b6aad9b30772d278b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J4ewDDOLiJps-20N.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自guru99.com</figcaption></figure><p id="10ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种模板的一种变体被称为<strong class="ky ir"> <em class="ls">雪花</em> </strong>图案，其中大小被进一步细分为多个子维度。例如，品牌和产品类别可能有单独的表，维度产品表中的每一行都可以将品牌和类别作为外键引用，而不是将它们作为字符串存储在表中。雪花模式比星型模式更规范化，但是星型模式通常更受欢迎，因为它们更便于分析师使用。</p><p id="a477" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在一个典型的数据仓库中，表通常非常宽:事实表通常有100多列，有时有数百列。维度表也可能非常宽，因为它们包含可能与分析相关的所有元数据。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="e9c5" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">最后的想法</h2><p id="2523" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">OLTP系统通常是面向用户的，这意味着它们可能会看到大量的请求。为了处理负载，应用程序通常只处理每个查询中的一些记录。应用程序使用某个键来请求记录，存储引擎使用索引来查找所请求键的数据。磁盘寻道时间通常是这里的瓶颈。</p><p id="488d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据仓库和类似的分析系统鲜为人知，因为它们主要由业务分析师而不是最终用户使用。与OLTP系统相比，它们处理的查询要少得多，但对每个查询的要求通常很高，需要在短时间内扫描数百万条记录。磁盘带宽(而不是寻道时间)通常是这里的瓶颈。</p></div></div>    
</body>
</html>