<html>
<head>
<title>Serverless vs CDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无服务器vs CDK</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/serverless-vs-cdk-a7f3ee391f24?source=collection_archive---------12-----------------------#2022-10-17">https://levelup.gitconnected.com/serverless-vs-cdk-a7f3ee391f24?source=collection_archive---------12-----------------------#2022-10-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1d22" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">选择在AWS上创建无服务器基础架构资源的策略</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/105f17e0b8d3255772c0a82327507326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L356HMp3jt5MicZx0gnovA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Josue Isai Ramos Figueroa 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="7f5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在AWS上创建无服务器基础架构有几种方法。你可以通过AWS控制台创建它，使用AWS CLI，或使用一个框架，如<a class="ae ky" href="https://www.serverless.com" rel="noopener ugc nofollow" target="_blank">无服务器</a>或<a class="ae ky" href="https://aws.amazon.com/cdk" rel="noopener ugc nofollow" target="_blank"> AWS云开发工具包</a>(肯定不会问阿米什人😁).</p><p id="e9a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我是自动化一切的大力支持者，所以让一段代码来做繁重的工作而不是点击控制台窗口对我来说非常有吸引力。在我使用无服务器技术的过程中，我了解到你可以使用无服务器框架和AWS CDK。在这篇文章和接下来的文章中，我想向你展示我对如何结合这两种技术来创建无服务器基础设施的认识。</p><h2 id="d4cb" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">使用案例</h2><p id="eacf" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">为了保持真实而不是抽象，我将详细说明如何为REST API Lambda设置infra，该API连接到DynamoDB进行存储，如前面的<a class="ae ky" href="https://medium.com/dev-genius/how-to-build-a-serverless-rest-api-with-nestjs-and-dynamodb-7b58b5b59bf6" rel="noopener">故事</a>中所述。该架构如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/3ba73def0d760e5c65c6cc31c5597ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*A1AsV-so48hbm93G.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">无服务器架构图</figcaption></figure><p id="e321" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在基础设施级别，需要配置以下资源:</p><ul class=""><li id="6194" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">API网关</li><li id="c87a" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">AWS函数</li><li id="3cda" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">DynamoDB表</li><li id="4e6b" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">访问管理(AWS上的IAM)</li></ul><blockquote class="ni nj nk"><p id="3266" class="kz la nl lb b lc ld ju le lf lg jx lh nm lj lk ll nn ln lo lp no lr ls lt lu im bi translated">重要的是要知道，CDK和无服务器框架最终都转化为一个<a class="ae ky" href="https://aws.amazon.com/cloudformation/" rel="noopener ugc nofollow" target="_blank"> AWS Cloudformation </a>堆栈。AWS Cloudformation是AWS上的基础设施即代码服务。</p></blockquote><p id="dbdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看无服务器和CDK有哪些选项。</p><h2 id="f915" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">无服务器</h2><p id="1807" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><a class="ae ky" href="https://www.serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器框架</a>允许你以一种非常简洁的方式定义你的AWS Lambda。查看我的前一篇关于用Typescript创建REST API的文章中的无服务器YAML文件，你会看到该文件描述了Lambda函数的特征。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">无服务器. yml</figcaption></figure><p id="06cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“提供商”部分说明了使用哪个云供应商以及地区和运行时间。您甚至可以通过添加AWS IAM语句来配置访问管理。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/cb829f1c179cfe12049c96b77e203f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*wpEB9eLBhY1lOt_pmXpSWw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS IAM角色声明</figcaption></figure><p id="6d21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无服务器框架的这种配置已经涵盖了API网关、AWS Lambda功能和用于访问管理的IAM。</p><p id="742c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无服务器框架还允许您在“资源”部分下的serverless.yml文件中配置其他AWS资源。以下代码片段显示了如何在serverless.yml文件中配置DynamoDB表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="35ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无服务器框架实际上遵循纯AWS Cloudformation语法。因此，如果您知道如何在AWS Cloudformation中定义它，您可以很容易地将其添加到serverless.yml配置文件中。</p><h2 id="647d" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">云开发套件(CDK)</h2><p id="a154" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">让我们看看云开发工具包，或简称CDK，在基础设施层面上能为你做些什么。</p><blockquote class="ni nj nk"><p id="dc00" class="kz la nl lb b lc ld ju le lf lg jx lh nm lj lk ll nn ln lo lp no lr ls lt lu im bi translated">CDK到底是什么？</p><p id="24ce" class="kz la nl lb b lc ld ju le lf lg jx lh nm lj lk ll nn ln lo lp no lr ls lt lu im bi translated">CDK是一个基础设施作为代码的解决方案，它允许你用你最喜欢的编程语言以声明的方式为你的基础设施建模。它支持TypeScript、JavaScript、Java、C#、Python和Go。</p></blockquote><p id="3d03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CDK为每一种支持的编程语言都提供了一个SDK，其中包含了构建基础设施的基本构件。在这个故事中，我将使用Java，这是最常用的编程语言之一。</p><p id="3ffe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的Java伪代码部署了一个用Java编写的Lambda函数，并在API网关中定义了一个端点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Java中Lambda的cdk代码</figcaption></figure><p id="ef90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">比无服务器多一点冗长。而且更加灵活，允许进行更多的配置，正如您在日志保留期配置中看到的那样。</p><p id="5d96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看如何定义对DynamoDB表的访问。我们将创建一个具有必要策略的角色来查询和更新DynamoDB表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">用于访问管理的cdk代码</figcaption></figure><p id="df7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码非常简单明了，可读性比AWS Cloudformation格式好得多。最后，让我们看看如何用CDK定义一个DynamoDB表。代码也是用Java编写的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d63b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常简单明了，也很容易做到。使用像Java这样的静态语言的好处是，编写代码非常容易，因为IDE会为您建议选项。更重要的是，Java SDK大量使用了<a class="ae ky" href="https://medium.com/@andreaspoyias/design-patterns-a-quick-guide-to-builder-pattern-a834d7cacead" rel="noopener">构建器模式</a>，并帮助您轻松找到所有选项。</p><h2 id="ff57" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">战略</h2><p id="0242" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">那么，有两个很好的选择来提升你在AWS中的基础设施，最好的策略是什么？我真的很喜欢无服务器的简洁，但也知道CDK提供了更多的灵活性来调整基础架构解决方案。CDK真的布置得很好，和他一起工作很愉快。我确实觉得CDK值得你花时间去了解它。</p><p id="cd69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的策略是两者并用。我使用无服务器框架来设置与Lambda本身、API网关和关于Lambda函数的访问策略相关的一切。无服务器的简洁让我更有效率。</p><p id="6357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我的架构中的其他基础设施资源，我使用CDK，因为它允许我调整关于基础设施资源的一切，而CDK代码对我来说就像一个文档工件。</p><p id="45b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在知道了无服务器和CDK的优点，你打算用什么呢？很高兴收到你的来信。</p><p id="089b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><h1 id="6279" class="ns lw it bd lx nt nu nv ma nw nx ny md jz nz ka mg kc oa kd mj kf ob kg mm oc bi translated">海科·范德沙夫</h1><ul class=""><li id="6fc7" class="mu mv it lb b lc mo lf mp li od lm oe lq of lu mz na nb nc bi translated"><strong class="lb iu"> <em class="nl">如果你喜欢这个，请</em> </strong> <a class="ae ky" href="https://serverlesscorner.com/about" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nl">跟随Serverlesscorner.com上中</em> </strong> </a> <strong class="lb iu"> <em class="nl">。</em>T13】</strong></li><li id="79ad" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><strong class="lb iu"> <em class="nl">爱情</em> </strong> ❤️ <strong class="lb iu"> <em class="nl">阅读</em> </strong> <strong class="lb iu"> <em class="nl">我的故事和其他关于媒？</em> </strong> <a class="ae ky" href="https://serverlesscorner.com/membership" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nl">成为会员</em> </strong> </a> <strong class="lb iu"> <em class="nl">如果你还不是会员的话。</em> </strong></li><li id="1047" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><strong class="lb iu"> <em class="nl">想阅读更多无服务器？报名参加我的</em> </strong> <a class="ae ky" href="https://serverlessconsulting.org/newsletter" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nl">月刊</em> </strong> </a> <strong class="lb iu"> <em class="nl">📬关于无服务器技术和使用案例的启发性和深刻的故事。</em>T49】</strong></li></ul></div></div>    
</body>
</html>