<html>
<head>
<title>If Web Apps Could Talk — Intro to the Web Speech API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如果网络应用可以说话——网络语音API简介</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/if-web-apps-could-talk-intro-to-the-web-speech-api-c9f7e0e83aff?source=collection_archive---------6-----------------------#2020-02-01">https://levelup.gitconnected.com/if-web-apps-could-talk-intro-to-the-web-speech-api-c9f7e0e83aff?source=collection_archive---------6-----------------------#2020-02-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/0503997981672358cc8b548c41a9c94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A3YALmlD-nRcBjoY"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">由<a class="ae jd" href="https://unsplash.com/@jasonrosewell?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰森·罗斯韦尔</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="74b8" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">建立一个时髦的发音检查器，使用简单的JavaScript来判断你的语言技能</em></p><p id="4491" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果在您的web应用程序中添加语音到文本和文本到语音的功能很容易，会怎么样？不要害怕，有一个API可以做到这一点。HTML5的本机<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API" rel="noopener ugc nofollow" target="_blank"> Web语音API </a>提供了两个接口来轻松处理语音数据:<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis" rel="noopener ugc nofollow" target="_blank">语音合成</a>用于将文本转换为声音，而<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition" rel="noopener ugc nofollow" target="_blank">语音识别</a>用于相反的操作。</p><p id="ea4b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尝试一下Web Speech API，你会发现很多关于使用<code class="fe lc ld le lf b">SpeechSynthesis</code>或<code class="fe lc ld le lf b">SpeechRecognition</code>的教程，但是这个教程将会让你用一个不超过HTML/CSS/JavaScript的应用程序一举两得。你的最终目标是:</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lg"><img src="../Images/78d4daaa66fb148a5ccb8d911ec08cd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gVHI-9i3qPCQojxQivi8w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">你能说出来吗？</figcaption></figure><p id="2790" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里尝试一下<a class="ae jd" href="https://clairefro.github.io/am-i-saying-it-right/" rel="noopener ugc nofollow" target="_blank"/>。用户选择一种语言，输入想要说的短语，然后按“听”来听到它被大声说出来。接下来，他们按“说”来激活麦克风并记录他们的最佳尝试。最后，应用程序向用户显示它听到了什么，并让他们知道他们的话语是否符合他们的目标。</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h2 id="eac1" class="ls lt jg bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated"><strong class="ak">免责声明！</strong></h2><p id="888f" class="pw-post-body-paragraph kd ke jg kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">在你开始计划你的百万美元的应用程序，完全运行在声音命令上，就像星际迷航一样，注意警告。</p><ul class=""><li id="0ba5" class="mq mr jg kf b kg kh kk kl ko ms ks mt kw mu la mv mw mx my bi translated"><strong class="kf jh">网络语音API是实验性的</strong>。虽然原生于HTML5，但它还不是佳能，规格可能会改变。</li><li id="c35e" class="mq mr jg kf b kg mz kk na ko nb ks nc kw nd la mv mw mx my bi translated">浏览器兼容性有限。总而言之，90%的用户可以使用语音合成，而只有68%的用户可以使用语音识别。为了简单起见，我们将为Chrome浏览器设计这个应用程序。 <em class="lb">(注:移动端，SpeechRecognition只兼容安卓版Chrome和安卓浏览器。)</em></li></ul><p id="1f26" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个是为了好玩！</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="9f92" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然已经解决了，我们就开始吧。</p><h1 id="3aed" class="ne lt jg bd lu nf ng nh lx ni nj nk ma nl nm nn md no np nq mg nr ns nt mj nu bi translated">入门指南</h1><p id="114b" class="pw-post-body-paragraph kd ke jg kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">创建一个名为<code class="fe lc ld le lf b">am-i-saying-it-right</code>的空项目目录。在里面，添加一个名为<code class="fe lc ld le lf b">index.html</code>的文件，并为您的应用程序结构粘贴以下代码。</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">index.html</figcaption></figure><p id="b744" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">兴趣点:</p><ul class=""><li id="a3e9" class="mq mr jg kf b kg kh kk kl ko ms ks mt kw mu la mv mw mx my bi translated"><a class="ae jd" href="https://github.com/daneden/animate.css/" rel="noopener ugc nofollow" target="_blank">动画。CSS </a>被导入到&lt;头部&gt;中，以便稍后为我们的麦克风按钮制作动画</li><li id="a101" class="mq mr jg kf b kg mz kk na ko nb ks nc kw nd la mv mw mx my bi translated">语言的&lt;选项&gt;标签中的<code class="fe lc ld le lf b">value</code>属性保存了网络语音API识别的语言代码(参见此处的非官方列表<a class="ae jd" href="https://github.com/TalAter/annyang/blob/master/docs/FAQ.md#what-languages-are-supported" rel="noopener ugc nofollow" target="_blank">)。例如，我们稍后将使用它们来告诉引擎“听中文”或“说法语”。</a></li><li id="dadb" class="mq mr jg kf b kg mz kk na ko nb ks nc kw nd la mv mw mx my bi translated">空的<code class="fe lc ld le lf b">#result-message</code> &lt; div &gt;会用来告诉用户他们的发音是好还是烂。</li><li id="994c" class="mq mr jg kf b kg mz kk na ko nb ks nc kw nd la mv mw mx my bi translated"><code class="fe lc ld le lf b">main.js</code>是用&lt;脚本&gt;标签中的<code class="fe lc ld le lf b">type="module"</code>导入的，因此我们可以通过关注点组织我们的脚本，并在<code class="fe lc ld le lf b">main.js</code>中将其作为模块导入</li></ul><p id="8d77" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，通过创建一个文件<code class="fe lc ld le lf b">style.css</code>并粘贴<a class="ae jd" href="https://github.com/clairefro/am-i-saying-it-right/blob/master/style.css" rel="noopener ugc nofollow" target="_blank">这段代码</a>来引导你的风格。</p><p id="5986" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您的文件树现在应该如下所示:</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/fb7df0dde1416eba23d7f753861081f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*jpPHYVOj0zaYsbxm1vRRlw.png"/></div></figure><p id="1a63" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Chrome浏览器中加载index.html应该会得到这个结果:</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/4d8ace13d8b43f7e19872377f339d506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*2g_ID-Ml0kBayz8VsnEZ1w.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">沉默的美丽。</figcaption></figure><p id="7193" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您会注意到它还没有做任何事情。让我们开始让应用说话吧。</p><h1 id="56fa" class="ne lt jg bd lu nf ng nh lx ni nj nk ma nl nm nn md no np nq mg nr ns nt mj nu bi translated">让语言存在！</h1><p id="fe0c" class="pw-post-body-paragraph kd ke jg kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">语音合成的基本语法非常简单:</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">基本语音合成语法</figcaption></figure><p id="75ae" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lc ld le lf b">speechSynthesis</code>接口只“朗读”<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance" rel="noopener ugc nofollow" target="_blank">speechsynthesisatinterance</a>s。要让浏览器朗读，首先创建一个<code class="fe lc ld le lf b">SpeechSynthesisUtterance</code>并将您想要朗读的字符串赋给它的<code class="fe lc ld le lf b">text</code>属性。所说的语言将默认为应用程序的<code class="fe lc ld le lf b">&lt;html lang="..." &gt;</code>值，除非使用话语的<code class="fe lc ld le lf b">.lang</code>属性指定了语言代码。</p><p id="6071" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基于此，让我们创建一个名为<code class="fe lc ld le lf b">speakText()</code>的函数，它用给定的语言朗读给定的字符串。在应用程序的根目录下，创建一个名为<code class="fe lc ld le lf b">textToSpeech.js</code>的模块文件，并插入以下代码:</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">textToSpeech.js</figcaption></figure><p id="161a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第3–5行检查用户的浏览器是否支持<code class="fe lc ld le lf b">speechSynthesis</code>，如果不支持，则提示他们使用Chrome。</p><p id="e67f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">剩下的已经很熟悉了——我们创建一个新的<code class="fe lc ld le lf b"><a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance" rel="noopener ugc nofollow" target="_blank">SpeechSynthesisUtterance</a></code>,并用给定的<code class="fe lc ld le lf b">text</code>(字符串)和<code class="fe lc ld le lf b">lang</code>(也是一个字符串)参数对其进行配置。最后，我们导出模块，在一个名为<code class="fe lc ld le lf b">main.js</code>的新文件中使用它。</p><p id="676f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建新文件<code class="fe lc ld le lf b">main.js</code>。也许你已经意识到项目中的所有文件都在根目录下:</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/ef33e061ca02e38d248d31aab6483e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*hflxMT-wMa8UUkzurZdrsw.png"/></div></figure><p id="a889" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是放入<code class="fe lc ld le lf b">main.js</code>的代码:</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">主页. js</figcaption></figure><p id="bd65" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在顶部，您导入刚刚创建并导出的<code class="fe lc ld le lf b">speakText()</code>函数。然后从DOM中抓取“听”按钮、文本输入字段和语言选择器。最后，向“Hear it”按钮添加一个点击事件监听器，以触发我们的<code class="fe lc ld le lf b">speakText()</code>方法，在点击时大声读出输入文本。</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oa"><img src="../Images/87b33ae341b3699d254bfeb85fafa01f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zcZuk7GgGX4NHTMKIf6YvA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">听起来容易说起来难</figcaption></figure><p id="3564" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您很高兴听到您的浏览器说法语，但当您尝试“听”它时，您可能会在控制台中看到这样的错误:</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/960116d5a785504e916db99e14c34a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*QUdVoIQwOVY7FoE8DnadzA.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">什么？</figcaption></figure><p id="9329" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我的错，因为我让你使用JavaScript ES6模块，出于安全原因，需要你的代码来满足脚本引用。如果你愿意，你可以在这里阅读。</p><p id="af06" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你还没有在<code class="fe lc ld le lf b">localhost</code>上发布你的代码进行测试，那么<strong class="kf jh">现在是时候发布你的服务器了</strong>。如果你不确定该怎么做，一个简单的解决方案是按照这些快速说明在你的项目文件夹<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/set_up_a_local_testing_server" rel="noopener ugc nofollow" target="_blank">中运行Python的<code class="fe lc ld le lf b">SimpleHTTPServer</code>。一旦你的服务器打开，你就可以从URL <code class="fe lc ld le lf b">http://localhost:&lt;PORT NUMBER HERE&gt;/</code>访问你的应用程序，并听到它对你说法语。以我为例:</a></p><figure class="lh li lj lk gt is gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/f6171d3eb79bed9788de15d81c22702c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*6-GMvJMhYOpcZzWM1S9APg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">在你喊“虫子”之前确保您的音量已打开。</figcaption></figure><p id="2f33" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事实上，它现在可以说你选择的任何语言。继续听日本或德国风味的omellete au fromage。</p><h1 id="03d9" class="ne lt jg bd lu nf ng nh lx ni nj nk ma nl nm nn md no np nq mg nr ns nt mj nu bi translated">介绍演讲识别</h1><p id="ac6e" class="pw-post-body-paragraph kd ke jg kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">到目前为止，这款应用已经很有趣了。也许你想今天就到此为止，用它来揭开你橱柜里所有法国葡萄酒名字的神秘面纱，或者让你妈妈知道这些年来她一直把藜麦的发音念错了。</p><p id="fa3d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我们还没有看到最精彩的部分——评判因素！</p><p id="cebb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lc ld le lf b">SpeechSynthesis</code>和<code class="fe lc ld le lf b">SpeechRecognition</code>是本教程的重点。我们已经做了肉——下面是土豆的基本语法:</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">基本语音识别语法</figcaption></figure><p id="c5f5" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，使用Chrome 的<code class="fe lc ld le lf b"><a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition#Browser_compatibility" rel="noopener ugc nofollow" target="_blank">webkit</a></code> <a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition#Browser_compatibility" rel="noopener ugc nofollow" target="_blank">前缀创建一个<code class="fe lc ld le lf b"><a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition" rel="noopener ugc nofollow" target="_blank">SpeechRecognition</a></code>的实例。在用<code class="fe lc ld le lf b">.lang</code>属性配置了识别器的语言后，您告诉它启动麦克风并开始监听语音。</a></p><p id="241a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于识别器来说，有一些事件<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition#Events" rel="noopener ugc nofollow" target="_blank">可用，但是我们主要感兴趣的是<code class="fe lc ld le lf b">'result'</code>，一旦单词或短语被正确识别，它就会触发。该事件的<code class="fe lc ld le lf b">results</code>属性返回一个<code class="fe lc ld le lf b"><a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognitionResult#Examples" rel="noopener ugc nofollow" target="_blank">SpeechRecognitionResultList</a></code>对象，我们可以钻取该对象以获得已识别文本的副本。上面我们在控制台的第7行显示了文字记录，如果文字确实被识别的话。如果你对<code class="fe lc ld le lf b"><a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognitionResult#Examples" rel="noopener ugc nofollow" target="_blank">SpeechRecognitionResultList</a></code>物体的样子感到好奇，这里有一个我用英语说“我有两条眉毛”的例子:</a></p><figure class="lh li lj lk gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/5bece95da66a126b9b0f890a61791758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BcUA-GLffgOiWeQqPNjqBA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">“结果”事件返回的SpeechRecognitionResultList示例</figcaption></figure><p id="8faa" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里要注意两件事:</p><ol class=""><li id="0248" class="mq mr jg kf b kg kh kk kl ko ms ks mt kw mu la oe mw mx my bi translated"><strong class="kf jh">你需要通过网络服务器提供你的代码，以便在Chrome中进行识别</strong>。不要担心——我们已经用前面的<code class="fe lc ld le lf b">localhost</code>设置好了。</li><li id="dad2" class="mq mr jg kf b kg mz kk na ko nb ks nc kw nd la oe mw mx my bi translated">在会话中第一次对<code class="fe lc ld le lf b">SpeechRecognition</code>对象调用<code class="fe lc ld le lf b">.start()</code>时，用户将被<strong class="kf jh">提示麦克风访问</strong>。你不能回避这个问题。是为了防止在人们不知情的情况下刺探他们的言论。</li></ol><figure class="lh li lj lk gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/c02b045a12c4388898667c895c56cbce.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*DGw0UPX2ezGKJ066ippe7A.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">令人讨厌的必需品。</figcaption></figure><h1 id="dba9" class="ne lt jg bd lu nf ng nh lx ni nj nk ma nl nm nn md no np nq mg nr ns nt mj nu bi translated">向我们的应用添加语音识别</h1><p id="8717" class="pw-post-body-paragraph kd ke jg kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">在app的根目录下做一个模块，名为<code class="fe lc ld le lf b">speechToText.js</code>。您将创建一个名为<code class="fe lc ld le lf b">recognizeSpeech()</code>的函数，它接受一种语言，启动该语言的识别器，并在完成监听后返回一个包含识别器结果的<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener ugc nofollow" target="_blank">承诺</a>。</p><p id="e153" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，所有这些识别魔法都发生在云中的一个黑盒中，这使得它成为一个异步操作。我们将使用<code class="fe lc ld le lf b">async</code>和<code class="fe lc ld le lf b">await</code>关键字来告诉JavaScript，“嘿，这是一个异步调用，在对它做一些事情之前，等待从云中听到包含我们的脚本的已履行承诺的回复！”</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">speechToText.js</figcaption></figure><p id="dd42" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不要忘记导出这个模块，这样我们就可以在<code class="fe lc ld le lf b">main.js</code>中使用它。</p><p id="9f6e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们需要在用户点击“说出来”按钮时触发我们的<code class="fe lc ld le lf b">recognizeSpeech()</code>。切换到<code class="fe lc ld le lf b">main.js</code>并导入你刚刚做的<code class="fe lc ld le lf b">recognizeSpeech</code>函数，就在你导入的<code class="fe lc ld le lf b">speakText</code>的正下方。我们将抓取并添加一个事件监听器到<code class="fe lc ld le lf b">recognizeButton</code>，在<code class="fe lc ld le lf b">speakButton</code>事件监听器下面(省略):</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="dd71" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是怎么回事？从下拉列表值中获取用户选择的语言后，我们将其传递给<code class="fe lc ld le lf b">recognizeSpeech()</code>函数。一旦用户结束讲话，该函数将返回一个包含识别记录的承诺。我们将这个实现的承诺的结果显示为第二个输入框的文本值，这样用户就可以看到他们说了什么。最后，<code class="fe lc ld le lf b">.catch</code>将拦截该承诺链中可能出现的任何错误，并将其显示在控制台上。</p><p id="f692" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们来试试吧！确保你的服务器是开着的，点击“说出来”，允许麦克风，你应该会在你的标签上看到某种图标，表明麦克风正在监听。</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/21045a79cf0d514affc0fc9a22dbace6.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*-BPANJTdTX2CJ0hW1Iia7g.png"/></div></div></figure><p id="f68f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">试一试:</p><figure class="lh li lj lk gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/bcfd6a41383f720410486ac836c0ce9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*REyDCV0PSzMXmaBHbMVbsQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">我小时候看了太多德克斯特的实验室。</figcaption></figure><p id="3f80" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你现在已经掌握了多种语言的<strong class="kf jh">语音合成</strong>和<strong class="kf jh">语音识别</strong>！但是有一个问题——当你发错音的时候，怎么能无礼呢？</p><h1 id="4d9d" class="ne lt jg bd lu nf ng nh lx ni nj nk ma nl nm nn md no np nq mg nr ns nt mj nu bi translated">最后润色</h1><p id="b7f4" class="pw-post-body-paragraph kd ke jg kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated"><strong class="kf jh">通过显示信息判断用户的发音</strong></p><p id="3381" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还记得HTML中的空div <code class="fe lc ld le lf b">#result-message</code>吗？在这里，我们将向用户显示一条消息，让他们知道他们是否成功地说出了这个单词。创建一个名为<code class="fe lc ld le lf b">compare.js</code>的新模块文件，并添加以下代码。</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">compare.js</figcaption></figure><p id="b71f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个<code class="fe lc ld le lf b">compare()</code>函数比较目标字符串和用户的尝试，然后在div中显示成功或失败的消息，并在两秒钟后重置为正常之前将背景颜色更改为绿色或红色。一定要将这个函数<code class="fe lc ld le lf b">export</code>、<code class="fe lc ld le lf b">import</code>到main.js中，然后在异步<code class="fe lc ld le lf b">recognizeSpeech()</code>上的<code class="fe lc ld le lf b">.then</code>的链中作为附加动作调用它。以下是反映这些新增内容的完整的<code class="fe lc ld le lf b">.main.js</code>文件:</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">main.js(增加了第3行，第29–31行)</figcaption></figure><figure class="lh li lj lk gt is gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/c81d6d3149cdb2d574f8e2944498b8eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*PLXaSeasClmVh3YPvRgi1A.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">我相信你能想到更时髦的东西。</figcaption></figure><p id="e410" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">激活时激活“说出来”按钮</strong></p><p id="41ce" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当话筒处于活动状态时，让用户更容易看到。我用了<a class="ae jd" href="https://github.com/daneden/animate.css/" rel="noopener ugc nofollow" target="_blank">动画。CSS </a>通过添加类名来激活元素。我用<a class="ae jd" href="https://github.com/clairefro/am-i-saying-it-right/blob/master/animate_button.js" rel="noopener ugc nofollow" target="_blank">这个辅助函数来切换动画类</a>，然后在识别器的‘开始’和‘结束’事件的<code class="fe lc ld le lf b">speechToText.js </code>中调用它。</p><figure class="lh li lj lk gt is"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">speechToText.js中的inside recognizeSpeech()</figcaption></figure><figure class="lh li lj lk gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oi"><img src="../Images/d9f1d4e9b47e38298d2579a3614f8d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JKnKs0QcbiA2KBQp7CMdaw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">现在，当麦克风处于活动状态时，按钮会跳动——相信我。</figcaption></figure><h1 id="f6aa" class="ne lt jg bd lu nf ng nh lx ni nj nk ma nl nm nn md no np nq mg nr ns nt mj nu bi translated">结论</h1><p id="2e6d" class="pw-post-body-paragraph kd ke jg kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">鉴于其有限的浏览器兼容性，使用Web Speech API为您的应用程序添加语音可能是一个不错的额外功能。使用Web Speech API，只需3-5行普通的JavaScript代码，您就可以让您的浏览器说话或收听。你甚至知道如何用承诺来处理成绩单的结果，让你有能力用声音导航一连串的事件。声乐世界是你的牡蛎，去坚果。但是要理智——你可能不希望用户在火车上大喊他们的密码或社会安全号码。</p><p id="3754" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参见本教程的完整代码<a class="ae jd" href="https://github.com/clairefro/am-i-saying-it-right" rel="noopener ugc nofollow" target="_blank">此处</a>，试用app <a class="ae jd" href="https://clairefro.github.io/am-i-saying-it-right/" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></div></div>    
</body>
</html>