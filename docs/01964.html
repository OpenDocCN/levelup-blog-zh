<html>
<head>
<title>Create an API on the edge using TypeScript and Cloudflare Workers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TypeScript和Cloudflare Workers在边缘创建API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-a-api-on-the-edge-using-typescript-and-cloudflare-workers-e71fea7fc1b6?source=collection_archive---------6-----------------------#2020-02-09">https://levelup.gitconnected.com/create-a-api-on-the-edge-using-typescript-and-cloudflare-workers-e71fea7fc1b6?source=collection_archive---------6-----------------------#2020-02-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c5a15c98f64938291963d16dede0a262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adygvryIBTuJtog9wyN3Wg.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片来自<a class="ae kf" href="https://www.pexels.com/photo/opened-white-duct-with-wires-inside-1583656/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kf" href="https://www.pexels.com/@daria?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Daria Shevtsova </a></figcaption></figure><p id="4476" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我之前的帖子中，我们描述了如何使用Cloudflare Workers将静态生成的网站直接部署到边缘。我们还描述了一种更快部署和回滚的方法，该方法使用提交散列来决定我们将向用户提供什么版本的应用程序。</p><div class="le lf gp gr lg lh"><a rel="noopener  ugc nofollow" target="_blank" href="/use-cloudflare-javascript-workers-to-deploy-you-static-generated-site-ssg-1c518e078646"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">使用Cloudflare JavaScript Workers部署静态生成的站点(SSG)</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">静态站点生成器正在成为构建和部署不需要服务器的web应用程序的事实上的方法…</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv jz lh"/></div></div></a></div><p id="9d16" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将继续在此基础上添加我们应用程序的另一个难题，一个API。我们将在Cloudflare Workers on the edge上构建它，并将Workers KV用作数据存储。</p><p id="6416" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上一篇文章中，我们获得了一个名为<code class="fe lw lx ly lz b">wrangler</code>的Cloudflare Workers CLI工具的句柄，让我们从安装和配置它开始。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="b8af" class="mi mj it lz b gy mk ml l mm mn">$ npm install -g @cloudflare/wrangler<br/>$ wrangler config</span></pre><h2 id="7ff7" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">引导TypeScript项目。</h2><p id="b700" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">因为我们将使用TypeScript，所以我们需要建立一个构建管道。我个人更喜欢使用汇总(<a class="ae kf" href="https://rollupjs.org/guide/en/" rel="noopener ugc nofollow" target="_blank">https://rollupjs.org/guide/en/</a>)和从另一个职位，我们已经有一个模板回购。</p><div class="le lf gp gr lg lh"><a href="https://github.com/outsrc/my-module" rel="noopener  ugc nofollow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">outsrc/我的模块</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">在GitHub上创建一个帐户，为outsrc/my-module开发做贡献。</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">github.com</p></div></div><div class="lq l"><div class="nk l ls lt lu lq lv jz lh"/></div></div></a></div><p id="41d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用这个repo作为模板，我们可以引导我们的TypeScript代码库，但是首先，我们需要在构建过程中修改一些东西。</p><p id="df9c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们修改汇总配置文件:</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">rollup .配置. js</figcaption></figure><p id="6e1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里最重要的是，我们不需要<code class="fe lw lx ly lz b">sourcemaps</code>，只需要一个<code class="fe lw lx ly lz b">es</code>格式的输出文件。</p><p id="4a9c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，让我们修改一下我们的<code class="fe lw lx ly lz b">tsconfig.json</code>文件，也修改一下TypeScript编译器选项。</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">tsconfig.json</figcaption></figure><p id="63dc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里最重要的是使用<code class="fe lw lx ly lz b">esnext</code>的<code class="fe lw lx ly lz b">module</code>和<code class="fe lw lx ly lz b">target</code>设置，因为Cloudflare Worker运行时对大多数现代JS特性都有很好的支持。</p><p id="8a05" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，在代码方面，让我们编写一个初始Hello Worker(在TypeScript上)并配置wrangler工具，以将我们的代码部署到Cloudflare。</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/索引. ts</figcaption></figure><p id="67f6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">至此，我们已经准备好构建它了。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="76e9" class="mi mj it lz b gy mk ml l mm mn">$ yarn build</span></pre><p id="99ec" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查build文件夹，我们可以看到我们的build/index.js。这是我们将使用wrangler部署到Cloudflare的文件。</p><h2 id="0790" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">配置Cloudflare的Wrangler CLI工具</h2><p id="02d3" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">我们可以使用<code class="fe lw lx ly lz b">wrangler</code>作为全局安装包，但我们也可以作为开发依赖项添加到项目中。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="72de" class="mi mj it lz b gy mk ml l mm mn">$ yarn add --dev @cloudflare/wrangler</span></pre><p id="8e63" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要为名为<code class="fe lw lx ly lz b">wrangler.toml</code>的<code class="fe lw lx ly lz b">wrangler</code>添加一个配置文件</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="b87e" class="mi mj it lz b gy mk ml l mm mn">name = "<strong class="lz iu">my-cf-api</strong>"<br/>type = "javascript"<br/>account_id = "<strong class="lz iu">&lt;ACCOUNT-ID&gt;</strong>"<br/>entry-point = "build"<br/>workers_dev = true</span></pre><p id="4eba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更改您的Cloudflare帐户ID的<code class="fe lw lx ly lz b"><strong class="ki iu">ACCOUNT_ID</strong></code>(您可以在控制面板上找到它),并执行以下操作:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="721b" class="mi mj it lz b gy mk ml l mm mn">$ wrangler publish<br/>💁  JavaScript project found. Skipping unnecessary build!<br/>✨  Successfully published your script to <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev</a></span></pre><p id="c6f6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦部署了我们的工作人员，我们就可以使用提供的URL访问它:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="857e" class="mi mj it lz b gy mk ml l mm mn">$ http <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev</a><br/>HTTP/1.1 200 OK<br/>CF-RAY: 56200b5f38d3f369-ATL<br/>Connection: keep-alive<br/>Content-Length: 18<br/>Content-Type: text/plain;charset=UTF-8<br/>Date: Sat, 08 Feb 2020 19:35:02 GMT<br/>Expect-CT: max-age=604800, report-uri="<a class="ae kf" href="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct" rel="noopener ugc nofollow" target="_blank">https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct</a>"<br/>Server: cloudflare<br/>Set-Cookie: __cfduid=d2e97f0dc5b08e83ae7074d5118fdd94b1581190502; expires=Mon, 09-Mar-20 19:35:02 GMT; path=/; domain=.outsrc.workers.dev; HttpOnly; SameSite=Lax<br/>Vary: Accept-Encoding</span><span id="7d85" class="mi mj it lz b gy nn ml l mm mn">{<br/>    "hello": "worker"<br/>}</span></pre><h2 id="edca" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">工人预览</h2><p id="0765" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">持续培养和部署我们的员工可能会很快变成一项单调乏味的任务。</p><p id="06f3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">牧马人来准备解决这个问题。我们可以在预览模式下运行。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="ff36" class="mi mj it lz b gy mk ml l mm mn">$ wrangler preview</span></pre><p id="4928" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将把我们的工作人员部署到一个开发环境中，并打开一个带有工作台的浏览器，在那里我们可以测试我们的端点。</p><figure class="ma mb mc md gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/f787f5db8a9c472bb9114485fb9b582c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PywEY84upTcw8gYzI7dtOQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">牧马人预览</figcaption></figure><p id="e5ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">测试和文档包括:</p><figure class="ma mb mc md gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/2a523fabc59d5a97b63defedd8fde974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2hOucNIjcJKClIxDWPvhg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">测试看起来像一个HTTP客户端</figcaption></figure><figure class="ma mb mc md gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/f3b39a5f144dff5cafa01a09824a6047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIy6lNZjBFT8fwkXJR5meg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">手头的文件</figcaption></figure><p id="7b19" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个额外的参数<code class="fe lw lx ly lz b">--watch</code>将使它监视文件的变化，以重新部署和更新我们的测试环境。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="4544" class="mi mj it lz b gy mk ml l mm mn">wrangler preview --watch<br/>💁  JavaScript project found. Skipping unnecessary build!<br/>💁  watching "./"<br/>🌀  Detected changes...<br/>💁  JavaScript project found. Skipping unnecessary build!<br/>👷  Updated preview with changes</span></pre><p id="6f27" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，这本身是不够的，因为我们还需要在每次更改后重新构建我们的TypeScript应用程序。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="08ef" class="mi mj it lz b gy mk ml l mm mn">$ yarn build --watch</span></pre><p id="f2e5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在单个yarn脚本中组合这两个命令</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="d907" class="mi mj it lz b gy mk ml l mm mn">{<br/>  "name": "my-cf-api",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "build/index.js",<br/>  "scripts": {<br/>    "build": "rollup -c",<br/>    "lint": "standard",<br/>    "format": "prettier-standard --format",<br/>    "test": "jest --coverage",<br/>    "publish:api": "wrangler publish",<br/>    <strong class="lz iu">"dev": "yarn build --watch &amp; wrangler preview --watch"</strong><br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "@types/jest": "^24.0.24",<br/>    "jest": "^24.9.0",<br/>    "rollup": "^1.27.13",<br/>    "rollup-plugin-commonjs": "^10.1.0",<br/>    "rollup-plugin-node-resolve": "^5.2.0",<br/>    "rollup-plugin-peer-deps-external": "^2.2.0",<br/>    "rollup-plugin-typescript2": "^0.25.3",<br/>    "standard": "^14.3.1",<br/>    "standard-prettier": "^1.0.1",<br/>    "ts-jest": "^24.2.0",<br/>    "typescript": "^3.7.3"<br/>  },<br/>  "jest": {<br/>    "preset": "ts-jest",<br/>    "testEnvironment": "node"<br/>  },<br/>  "standard": {<br/>    "ignore": [<br/>      "node_modules/",<br/>      "build/"<br/>    ]<br/>  }<br/>}</span></pre><p id="db03" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，只需一个命令，我们就可以在观察模式下旋转构建和部署流程。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="af6f" class="mi mj it lz b gy mk ml l mm mn">$ yarn dev</span></pre><h2 id="605b" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">将API部署到不同的环境中。</h2><p id="f707" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">默认情况下，wrangler CLI工具会将我们的工作人员部署到一个开发环境中，该环境由我们生成的端点发出信号。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="9843" class="mi mj it lz b gy mk ml l mm mn">$ wrangler publish<br/>💁  JavaScript project found. Skipping unnecessary build!<br/>✨  Successfully published your script to <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev" rel="noopener ugc nofollow" target="_blank"><strong class="lz iu">https://my-cf-api.outsrc.workers.dev</strong></a></span></pre><p id="0742" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，如果我们还想部署到我们的生产环境中，我们需要在<code class="fe lw lx ly lz b">wrangler.toml</code>文件中添加一个<code class="fe lw lx ly lz b">production</code>部分。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="cb47" class="mi mj it lz b gy mk ml l mm mn">name = "my-cf-api"<br/>type = "javascript"<br/>account_id = "<strong class="lz iu">&lt;ACCOUNT-ID&gt;</strong>"<br/>entry-point = "build"<br/>workers_dev = true<br/><br/>[env.production]<br/>zone_id = "<strong class="lz iu">&lt;ZONE-ID&gt;</strong>"<br/>route = "<strong class="lz iu">api.outsrc.dev/*</strong>"</span></pre><p id="4967" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于您添加到帐户的每个域，您可以在Cloudflare控制面板上找到<code class="fe lw lx ly lz b">zone_id</code>属性。</p><p id="813b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="np">(注意:</em> <code class="fe lw lx ly lz b"><em class="np">api.outsrc.dev</em></code> <em class="np">子域必须添加到指向不可访问IP的域的DNS区域，如</em> <code class="fe lw lx ly lz b"><em class="np">192.2.0.1</em></code> <em class="np"> ) </em></p><p id="4de6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lw lx ly lz b">route</code>参数指示您的工人应该响应哪些路线。</p><p id="b147" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了立即部署到生产环境，我们做到了:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="2c95" class="mi mj it lz b gy mk ml l mm mn">$ wrangler publish --env production<br/>💁  JavaScript project found. Skipping unnecessary build!<br/>✨  Successfully published your script to api.outsrc.dev/*</span></pre><h2 id="9f1d" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">使用KV商店</h2><p id="2208" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">KV Store是一项令人惊叹的技术。用Cloudflare自己的话说:</p><blockquote class="nq nr ns"><p id="fe3f" class="kg kh np ki b kj kk kl km kn ko kp kq nt ks kt ku nu kw kx ky nv la lb lc ld im bi translated">Workers KV是一个全球性的低延迟、键值数据存储。它支持异常高的读取量和低延迟，使构建高度动态的API和网站成为可能，这些API和网站的响应速度与缓存的静态文件一样快。</p></blockquote><p id="0280" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用Worker KV的第一步是创建一个名称空间，为此我们使用了<code class="fe lw lx ly lz b">wrangler</code>工具。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="a748" class="mi mj it lz b gy mk ml l mm mn">$ wrangler kv:namespace create "TODOS"               <br/>🌀  Creating namespace with title "my-cf-api-TODOS"<br/>✨  Success: WorkersKvNamespace {<br/>    id: "a9f969275ba24647b3319531531952df",<br/>    title: "my-cf-api-TODOS",<br/>}<br/>✨  Add the following to your wrangler.toml:<br/>kv-namespaces = [ <br/>  { binding = "TODOS", id = "a9f969275ba24647b3319531531952df" } <br/>]</span></pre><p id="640c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并修改我们的<code class="fe lw lx ly lz b">wrangler.toml</code>文件以包含kv-namespaces设置。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="1f67" class="mi mj it lz b gy mk ml l mm mn">name = "my-cf-api"<br/>type = "javascript"<br/>account_id = "&lt;ACCOUNT-ID&gt;"<br/>entry-point = "build"<br/>workers_dev = true<br/><br/><strong class="lz iu">kv-namespaces = [<br/>  { binding = "TODOS", id = "a9f969275ba24647b3319531531952df" }<br/>]</strong><br/><br/>[env.production]<br/>zone_id = "&lt;ZONE-ID&gt;"<br/>route = "api.outsrc.dev/*"</span></pre><p id="cdd2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，由于我们也有一个生产环境，让我们为它创建另一个名称空间。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="e76b" class="mi mj it lz b gy mk ml l mm mn">$ wrangler kv:namespace create "TODOS_PRODUCTION"<br/>🌀  Creating namespace with title "my-cf-api-TODOS_PRODUCTION"<br/>✨  Success: WorkersKvNamespace {<br/>    id: "97cdbbe92ebd4e349d73dd129067bb53",<br/>    title: "my-cf-api-TODOS_PRODUCTION",<br/>}<br/>✨  Add the following to your wrangler.toml's "kv-namespaces" array:<br/>{ binding = "TODOS_PRODUCTION", id = "97cdbbe92ebd4e349d73dd129067bb53" }</span></pre><p id="26b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并将kv-namespaces设置粘贴到我们的<code class="fe lw lx ly lz b">wrangler.toml</code>文件的production部分。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="354a" class="mi mj it lz b gy mk ml l mm mn">name = "my-cf-api"<br/>type = "javascript"<br/>account_id = "&lt;ACCOUNT-ID&gt;"<br/>entry-point = "build"<br/>workers_dev = true<br/><br/>kv-namespaces = [<br/>  { binding = "TODOS", id = "a9f969275ba24647b3319531531952df" }<br/>]<br/><br/>[env.production]<br/>zone_id = "&lt;ZONE-ID&gt;"<br/>route = "api.outsrc.dev/*"</span><span id="50e2" class="mi mj it lz b gy nn ml l mm mn"><strong class="lz iu">kv-namespaces = [<br/>  { binding = "TODOS", id = "97cdbbe92ebd4e349d73dd129067bb53" }<br/>]</strong></span></pre><p id="9a8e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="np">(注意，我在两个名称空间</em> <code class="fe lw lx ly lz b"><em class="np">TODOS</em></code> <em class="np">上使用了相同的绑定值，即使一个名称空间被创建为</em> <code class="fe lw lx ly lz b"><em class="np">TODOS</em></code> <em class="np">，另一个名称空间被创建为</em> <code class="fe lw lx ly lz b"><em class="np">TODOS_PRODUCTION</em></code> <em class="np">。)</em></p><p id="d74b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">绑定将在worker上下文中创建一个全局变量<code class="fe lw lx ly lz b"><strong class="ki iu">TODOS</strong></code>。所以我们可以直接在代码中使用它。现在，这将导致TypeScript抱怨一个没有找到的全局对象<code class="fe lw lx ly lz b"><strong class="ki iu">TODOS</strong></code>。</p><p id="56da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了避免这个问题，我们需要安装模块<code class="fe lw lx ly lz b">@cloudflare/workers-types</code>并将主<code class="fe lw lx ly lz b">index.ts</code>文件顶部的<code class="fe lw lx ly lz b"><strong class="ki iu">TODOS</strong></code>对象声明为:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="1c95" class="mi mj it lz b gy mk ml l mm mn">import { KVNamespace } from '@cloudflare/workers-types'<br/><br/>declare const TODOS: KVNamespace</span></pre><p id="87ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Todo应用程序并不完全是最适合员工KV存储的应用程序类型。因为写操作是有限的，而读操作更快且不受限制。但是，这是一个简单的概念，通过在我们的基本Hello Worker上添加几个函数，现在我们可以向我们的API添加几个操作。</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/index.ts(现在带有/todos端点)</figcaption></figure><p id="e07d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更新、构建和部署后</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="70be" class="mi mj it lz b gy mk ml l mm mn">$ curl <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos?user=ernesto" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos?user=ernesto</a><br/>[]</span></pre><p id="9174" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为单个用户添加待办事项:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="cbd5" class="mi mj it lz b gy mk ml l mm mn">$ curl -X POST -d '{"user":"ernesto","todo":"Read that book you bought"}' https://my-cf-api.outsrc.workers.dev/todos</span></pre><p id="0256" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正在为用户重新查询待办事项:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="8f2f" class="mi mj it lz b gy mk ml l mm mn">$ curl <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos\?user\=ernesto" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos\?user\=ernesto</a><br/>["Read that book you bought"]</span></pre><p id="b1d2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们添加更多待办事项:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="6b8c" class="mi mj it lz b gy mk ml l mm mn">$ curl -X POST -d '{"user":"ernesto","todo":"Buy propane for grill"}' <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos</a><br/>$ curl <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos\?user\=ernesto" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos\?user\=ernesto</a><br/>["Read that book you bought","Buy propane for grill"]</span></pre><p id="c774" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同时删除待办事项</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="ae1c" class="mi mj it lz b gy mk ml l mm mn">$ curl -X DELETE -d '{"user":"ernesto","index":0}' <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos</a><br/>$ curl <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos\?user\=ernesto" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos\?user\=ernesto</a><br/>["Buy propane for grill"]</span></pre><p id="b2aa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的API正在工作…但是，它安全吗？没有那么多。任何人都可以从任何用户那里添加、查询甚至删除数据。</p><h2 id="2239" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">保护API</h2><p id="5e87" class="pw-post-body-paragraph kg kh it ki b kj nf kl km kn ng kp kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">有几种方法可以保护API。我们在这里使用的是JWT访问令牌。发送带有不记名令牌的授权头是很常见的。也很容易与认证提供者集成，如auth 0(<a class="ae kf" href="https://auth0.com/" rel="noopener ugc nofollow" target="_blank">https://auth0.com/</a>)或Okta(<a class="ae kf" href="https://www.okta.com/" rel="noopener ugc nofollow" target="_blank">https://www.okta.com/</a>)</p><p id="6e01" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们需要能够从授权头中获取令牌，解码并验证它。感谢开源社区和本·查特兰(【https://github.com/bcnzer】T21)的这个惊人的主旨</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://gist.github.com/bcnzer/e6a7265fd368fa22ef960b17b9a76488#file-cloudflareworker-verifyjwt-js" rel="noopener ugc nofollow" target="_blank">cloudflareworker-verify jwt . js</a></figcaption></figure><p id="54bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我只是稍微重构了一下，把它转换成一个我们可以在任何地方重用的函数。</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/jwt.ts</figcaption></figure><p id="33b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，为了保护我们的端点，我们重用了这个函数。</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/索引. ts</figcaption></figure><p id="c263" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里的重要变化是:</p><ul class=""><li id="d072" class="nw nx it ki b kj kk kn ko kr ny kv nz kz oa ld ob oc od oe bi translated">我们可以从其他模块导入，本地或通过node_modules。如果可能的话，Rollup将从这些模块中移除未使用的代码。</li><li id="2f4a" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">我们修改了main函数来验证令牌，并将令牌有效负载传递给所有方法函数</li><li id="770b" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">方法函数现在使用令牌有效负载上的<code class="fe lw lx ly lz b">sub</code>属性来标识用户。</li></ul><p id="8862" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">构建和发布后，我们有:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="bef4" class="mi mj it lz b gy mk ml l mm mn">$ http <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos</a><br/>HTTP/1.1 403 Forbidden<br/>CF-RAY: 56213e8bada4f1c6-ATL<br/>Connection: keep-alive<br/>Content-Length: 0<br/>Date: Sat, 08 Feb 2020 23:04:44 GMT<br/>Expect-CT: max-age=604800, report-uri="<a class="ae kf" href="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct" rel="noopener ugc nofollow" target="_blank">https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct</a>"<br/>Server: cloudflare<br/>Set-Cookie: __cfduid=db91d31a35776ef201afbea47415e76a11581203084; expires=Mon, 09-Mar-20 23:04:44 GMT; path=/; domain=.outsrc.workers.dev; HttpOnly; SameSite=Lax<br/>Vary: Accept-Encoding</span></pre><p id="a1ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要传递一个带有不记名令牌的授权头，该令牌将包含一个标识我们用户的<code class="fe lw lx ly lz b">sub</code>属性。</p><p id="511a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="np">(幸运的是，在另一篇文章中，我有一个Auth0的例子。因此很容易提取访问令牌来进行一些测试)</em></p><div class="le lf gp gr lg lh"><a rel="noopener  ugc nofollow" target="_blank" href="/secure-nextjs-app-users-with-auth0-and-typescript-3b0a6ac3a163"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">使用Auth0和TypeScript验证和保护Next.js应用程序用户</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">React和Next.js应用程序中的用户身份验证</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="lq l"><div class="ok l ls lt lu lq lv jz lh"/></div></div></a></div><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="b932" class="mi mj it lz b gy mk ml l mm mn">$ curl https://my-cf-api.outsrc.workers.dev/todos \<br/>-H 'Authorization: Bearer eyJhbGciOi...'<br/>[]</span></pre><p id="ac5e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">添加todos变得更加容易，因为我们现在不需要指定用户。</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="f3d0" class="mi mj it lz b gy mk ml l mm mn">$ curl -X POST -d '{"todo":"Clean the backyard"}' <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos</a> \<br/>-H 'Authorization: Bearer eyJhbGciOi...'</span><span id="9123" class="mi mj it lz b gy nn ml l mm mn">$ curl https://my-cf-api.outsrc.workers.dev/todos \<br/>-H 'Authorization: Bearer eyJhbGciOi...'<br/>["Clean the backyard"]</span></pre><h2 id="e117" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">克-奥二氏分级量表</h2><blockquote class="nq nr ns"><p id="98fe" class="kg kh np ki b kj kk kl km kn ko kp kq nt ks kt ku nu kw kx ky nv la lb lc ld im bi translated">跨源资源共享是一种机制，它允许从提供第一资源的域之外的另一个域请求网页上的受限资源。一个网页可以自由地嵌入跨源图像、样式表、脚本、iframes和视频。(维基百科)</p></blockquote><p id="913b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不幸的是，当我们的API在<code class="fe lw lx ly lz b">api.outsrc.dev/*</code>路线上部署到生产环境中，并从主web域<code class="fe lw lx ly lz b">www.outsrc.dev</code>访问时，将会遇到CORS“墙”。这是所有的请求都会被阻止。</p><p id="9b36" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">打开浏览器JavaScript控制台并键入:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="634f" class="mi mj it lz b gy mk ml l mm mn">&gt; fetch('<a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos'" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos'</a>, { headers: { 'Authorization': 'Bearer eyJhbGciOi...'}})<br/>  .then(res =&gt; console.log(res))<br/>  .catch(err =&gt; console.log(err))</span><span id="99ab" class="mi mj it lz b gy nn ml l mm mn">Access to fetch at '<a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos'" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos'</a> from origin 'chrome-search://local-ntp' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource. If an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled.<br/>GET <a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos</a> net::ERR_FAILED<br/>(anonymous)<br/>TypeError: Failed to fetch</span></pre><p id="bcd2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要打开CORS头来允许这种行为，因为我们的API是由JWT访问令牌保护的。</p><p id="3f6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="np">(根据您的特定用例，您需要了解如何在您的应用程序上配置CORS)</em></p><p id="a7e7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于我们的演示，我们将开放，允许所有来自任何来源。</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/cors.ts</figcaption></figure><p id="dc6f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并且重构了我们的工人API</p><figure class="ma mb mc md gt ju"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">src/索引. ts</figcaption></figure><p id="ab04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们补充道:</p><ul class=""><li id="d581" class="nw nx it ki b kj kk kn ko kr ny kv nz kz oa ld ob oc od oe bi translated">默认CORS标题对象</li><li id="ebd8" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated"><code class="fe lw lx ly lz b">withStatus</code>允许传递HTTP状态和其他报头并注入默认CORS报头的函数</li><li id="1884" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">检查选项方法</li></ul><p id="a534" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从浏览器中再次尝试我们的获取操作:</p><pre class="ma mb mc md gt me lz mf mg aw mh bi"><span id="3006" class="mi mj it lz b gy mk ml l mm mn">&gt; fetch(<br/>  '<a class="ae kf" href="https://my-cf-api.outsrc.workers.dev/todos'" rel="noopener ugc nofollow" target="_blank">https://my-cf-api.outsrc.workers.dev/todos'</a>, <br/>  { headers: { 'Authorization': 'Bearer eyJhbGciOiJSUzI1Ni...'}}<br/>)<br/>  .then(res =&gt; res.json())<br/>  .then(res =&gt; console.log(res))<br/>  .catch(err =&gt; console.log(err))<br/>Promise {&lt;pending&gt;}<br/>["Buy propane for grill"]</span></pre><p id="61ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">瞧，成功了！</p><h2 id="7c2d" class="mi mj it bd mo mp mq dn mr ms mt dp mu kr mv mw mx kv my mz na kz nb nc nd ne bi translated">结论</h2><ul class=""><li id="5b25" class="nw nx it ki b kj nf kn ng kr ol kv om kz on ld ob oc od oe bi translated">Worker KV Store是一个很好的快速替代方案，可以存储在边缘、最接近用户并且读写比率很高的数据。</li><li id="4005" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">工具就在那里。我们可以用TypeScript和牧马人预览观看模式做热重装。</li><li id="30c8" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">如有必要，用JWT访问令牌保护我们的工人API。</li><li id="42ef" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">CORS很重要，必须妥善处理。</li><li id="c913" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">开箱即用也支持多种环境。</li><li id="d104" class="nw nx it ki b kj of kn og kr oh kv oi kz oj ld ob oc od oe bi translated">牧马人CLI工具对于管理工人KV商店非常有用。</li></ul><p id="9573" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章的最终代码可以在以下网址找到:</p><div class="le lf gp gr lg lh"><a href="https://github.com/outsrc/my-cf-api" rel="noopener  ugc nofollow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">outsrc/my-cf-api</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">来自Cloudflare Workers API post的代码。在GitHub上创建一个帐户，为outsrc/my-cf-api开发做出贡献。</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">github.com</p></div></div><div class="lq l"><div class="oo l ls lt lu lq lv jz lh"/></div></div></a></div><p id="80ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">黑客快乐…</p></div></div>    
</body>
</html>