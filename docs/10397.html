<html>
<head>
<title>How to Transcribe Audio Files to Text</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将音频文件转录为文本</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-transcribe-audio-files-to-text-1ed7cf6d8c08?source=collection_archive---------16-----------------------#2021-11-30">https://levelup.gitconnected.com/how-to-transcribe-audio-files-to-text-1ed7cf6d8c08?source=collection_archive---------16-----------------------#2021-11-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0cea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用于语音识别的替代API</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/64db857e52235b4bf233ceda2cc26318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_yrRdTW774cKaFUQryTLw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@kellysikkema?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae le" href="https://unsplash.com/s/photos/music-wave?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2bf3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天的主题是关于以编程的方式将录音转录成文本。随着机器学习的进步，现在可以处理人类的语音并将其转换为文本。因此，自动语音识别(ASR)领域已经成为近年来最热门的话题之一，并且日益呈指数级增长。</p><p id="25e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://www.assemblyai.com/blog/what-is-asr/" rel="noopener ugc nofollow" target="_blank"> ASR </a>通常被公司用于以下下游任务:</p><ul class=""><li id="573c" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><strong class="js iu">虚拟会议</strong> —转录演讲者的讲话，以更好地传达信息</li><li id="2fa2" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><strong class="js iu">电话</strong> —转录来自电信服务的音频记录，以自动响应或更好地了解潜在的对话</li><li id="5452" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><strong class="js iu">视频平台</strong> —为视频生成字幕</li></ul><p id="c056" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，您将学习使用AssemblyAI 提供的<a class="ae le" href="https://www.assemblyai.com/" rel="noopener ugc nofollow" target="_blank">语音转文本API转录本地音频文件。我特意选择了这个API，原因如下:</a></p><ul class=""><li id="e7e2" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">已经有很多关于谷歌语音转文本和AWS转录的文章。</li><li id="858e" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">它提供了许多非常有用的特性。例如，说话人二进制化、自定义词汇和话题检测。</li><li id="97d1" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">官方文档包含Node.js、Python、PHP、Ruby和C#的示例代码。本教程重点介绍Python编程语言。</li></ul><p id="9ec7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们继续下一部分，开始安装必要的模块。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="eef4" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">设置</h1><p id="20e4" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">强烈建议您在继续之前创建一个新的虚拟环境。默认情况下，您应该已经安装了<code class="fe nd ne nf ng b">requests</code>包。如果不是这样，请运行以下命令进行安装:</p><pre class="kp kq kr ks gt nh ng ni nj aw nk bi"><span id="280e" class="nl mb it ng b gy nm nn l no np">pip install requests</span></pre><p id="75d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在此注册一个<a class="ae le" href="https://app.assemblyai.com/signup" rel="noopener ugc nofollow" target="_blank">新的免费试用账户，并获得相应的API密钥。试用帐户每月有3小时的转录。</a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/84629a80d8d1559a9235429a39907892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*q35tYuEI75f0jYik"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><p id="806b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">复制API键，因为稍后调用API时会用到它。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="627f" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">履行</h1><p id="6a35" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">通常，整个转录过程分为3个部分:</p><ul class=""><li id="f360" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">将本地音频文件上传到服务器，以便可以通过URL访问。</li><li id="c6ea" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">调用转录API (POST call)开始处理文件。</li><li id="fdff" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">调用脚本API (GET call)来获取状态。一旦完成，它将包含转录文本。</li></ul><h2 id="d822" class="nl mb it bd mc nr ns dn mg nt nu dp mk kb nv nw mo kf nx ny ms kj nz oa mw ob bi translated">上传本地文件(可选)</h2><p id="bf38" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">如果您的音频文件位于可以通过URL访问的任何存储位置(S3桶、服务器上的静态文件等)，您可以跳过这一步。此步骤的目的是将您的本地录音上传到AssemblyAI提供的存储空间。请放心，所有上传的文件转录后会立即删除。</p><p id="ca52" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建一个名为<code class="fe nd ne nf ng b">upload_file.py</code>的新Python文件，并添加以下代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="7c7e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">相应地更换<code class="fe nd ne nf ng b">filename</code>和<code class="fe nd ne nf ng b">api_key</code>变量。另外，请注意，我已经创建了一个生成器函数来分块读取数据。这主要是因为您需要通过分块传输编码将数据传输到API。</p><p id="4128" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在终端上通过以下命令运行该文件:</p><pre class="kp kq kr ks gt nh ng ni nj aw nk bi"><span id="d94e" class="nl mb it ng b gy nm nn l no np">python upload_file.py</span></pre><p id="8e92" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，简单地用requests.post函数正常调用API。您应该获得如下JSON响应:</p><pre class="kp kq kr ks gt nh ng ni nj aw nk bi"><span id="d65c" class="nl mb it ng b gy nm nn l no np">{“upload_url”: “https://cdn.assemblyai.com/upload/ccbbbfaf-f319-4455-9556-272d48faaf7f"}</span></pre><p id="c1c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe nd ne nf ng b">upload_url</code>的值代表你的音频文件的URL。</p><h2 id="238f" class="nl mb it bd mc nr ns dn mg nt nu dp mk kb nv nw mo kf nx ny ms kj nz oa mw ob bi translated">转录(后期)</h2><p id="1aad" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">完成后，让我们创建另一个名为<code class="fe nd ne nf ng b">transcribe.py</code>的Python文件。在实际用例中，您可以将所有代码组合在一个文件中。</p><p id="a436" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在其中追加以下代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="6d1d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其结构与上一节类似，但是这次我们将json数据发送到脚本API。它接受几个参数，但最重要的是<code class="fe nd ne nf ng b">audio_url</code>。欲了解更多信息，请查看<a class="ae le" href="https://docs.assemblyai.com/api-ref/v2-transcript" rel="noopener ugc nofollow" target="_blank">官方API文档</a>。</p><p id="7127" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在终端上运行以下命令:</p><pre class="kp kq kr ks gt nh ng ni nj aw nk bi"><span id="185f" class="nl mb it ng b gy nm nn l no np">python transcribe_file.py</span></pre><p id="acdb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该得到以下输出:</p><pre class="kp kq kr ks gt nh ng ni nj aw nk bi"><span id="6a72" class="nl mb it ng b gy nm nn l no np">{“id”: “ccbbbfaf-f319–4455–9556–272d48faaf7f”, “language_model”: “assemblyai_default”, “acoustic_model”: “assemblyai_default”, “language_code”: “en_us”, “status”: “queued”, “audio_url”: “https://cdn.assemblyai.com/upload/968fe71b-0bba-45bd-aa7a-7084f5c1fadd", “text”: null, “words”: null, “utterances”: null, “confidence”: null, “audio_duration”: null, “punctuate”: true, “format_text”: true, “dual_channel”: null, “webhook_url”: null, “webhook_status_code”: null, “speed_boost”: false, “auto_highlights_result”: null, “auto_highlights”: false, “audio_start_from”: null, “audio_end_at”: null, “word_boost”: [], “boost_param”: null, “filter_profanity”: false, “redact_pii”: false, “redact_pii_audio”: false, “redact_pii_audio_quality”: null, “redact_pii_policies”: null, “redact_pii_sub”: null, “speaker_labels”: false, “content_safety”: false, “iab_categories”: false, “content_safety_labels”: {}, “iab_categories_result”: {}, “disfluencies”: false, “sentiment_analysis”: false, “sentiment_analysis_results”: null, “auto_chapters”: false, “chapters”: null, “entity_detection”: false, “entities”: null}</span></pre><p id="5652" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不要被返回的JSON中的键的数量吓到。这些仅仅是与API相关的信息，因为它支持相当多的特性。你应该得到</p><pre class="kp kq kr ks gt nh ng ni nj aw nk bi"><span id="1aa8" class="nl mb it ng b gy nm nn l no np">status: “queued”</span></pre><p id="246a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果遇到错误，I表示转录由于以下原因之一而失败:</p><ul class=""><li id="4130" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">不支持的音频文件格式</li><li id="bc57" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">音频文件不包含音频数据</li><li id="5a27" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">音频文件太短(&lt; 200毫秒)</li><li id="19fa" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">无法访问音频文件的URL</li><li id="3ab1" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">API端的错误</li></ul><h2 id="4de0" class="nl mb it bd mc nr ns dn mg nt nu dp mk kb nv nw mo kf nx ny ms kj nz oa mw ob bi translated">转录(获取)</h2><p id="8862" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">现在，您需要再次调用GET API来检查该过程是否已经完成。创建另一个名为<code class="fe nd ne nf ng b">result.py</code>的文件，并添加以下代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="8bed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在终端上运行以下命令:</p><pre class="kp kq kr ks gt nh ng ni nj aw nk bi"><span id="4ed0" class="nl mb it ng b gy nm nn l no np">python result.py</span></pre><p id="04d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦转录完成，它将返回比POST API更多的输出。通常，最重要的结果是状态键，它是下列值之一:</p><ul class=""><li id="0048" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><code class="fe nd ne nf ng b">queued</code>:音频文件正在后台排队，即将处理。</li><li id="343d" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe nd ne nf ng b">processing</code>:系统正在转录音频文件</li><li id="d70e" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe nd ne nf ng b">completed</code>:转录已完成</li><li id="b33c" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe nd ne nf ng b">error</code>:转录音频文件时出错</li></ul><p id="f6cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据音频的长度，转录可能需要几秒到10分钟的时间。一旦转录完成，您应该得到以下附加输出:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="39b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到目前为止，您应该已经掌握了根据您的用例在应用程序中使用语音到文本输出的基本概念。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="4add" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">结论</h1><p id="9231" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">让我们回顾一下你今天所学的内容。</p><p id="3015" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文首先简要介绍了自动语音识别及其使用案例。</p><p id="9d8d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，介绍了在本地录音中使用AssemblyAI提供的语音到文本API所需的步骤。首先，您需要上传文件以获得可访问的URL。随后，调用脚本API (POST)并等待一段时间。最后，调用脚本API (GET)来获得结果。</p><p id="91e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢你阅读这篇文章。祝你有美好的一天！</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="aeec" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">参考</h1><ol class=""><li id="8f67" class="lf lg it js b jt my jx mz kb oe kf of kj og kn oh ll lm ln bi translated"><a class="ae le" href="https://www.assemblyai.com/blog/what-is-asr/" rel="noopener ugc nofollow" target="_blank">什么是ASR？</a></li><li id="3d0a" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn oh ll lm ln bi translated"><a class="ae le" href="https://www.assemblyai.com/blog/how-to-choose-the-best-speech-to-text-api-for-your-product/" rel="noopener ugc nofollow" target="_blank">如何选择语音转文本API </a></li><li id="a293" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn oh ll lm ln bi translated"><a class="ae le" href="https://docs.assemblyai.com/overview/uploading-audio-files-for-transcription" rel="noopener ugc nofollow" target="_blank"> AssemblyAI —上传文件进行转录</a></li></ol></div></div>    
</body>
</html>