<html>
<head>
<title>Mocking data — How to do it with Postman Workflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟数据—如何使用邮递员工作流</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/mocking-data-how-to-do-it-with-postman-workflow-ae51390133f5?source=collection_archive---------12-----------------------#2021-02-28">https://levelup.gitconnected.com/mocking-data-how-to-do-it-with-postman-workflow-ae51390133f5?source=collection_archive---------12-----------------------#2021-02-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c965ba438689697058a692c18bef0030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9w3G9V6626ATypyDzKcyJA.png"/></div></div></figure><p id="a62c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">ostman是一个API测试工具，可以与CI/CD管道集成。</p><p id="fb74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它有各种有用的功能，如</p><ul class=""><li id="fdf4" class="lf lg iq ka b kb kc kf kg kj lh kn li kr lj kv lk ll lm ln bi translated">自动化测试</li><li id="22ad" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">设计和模仿API</li><li id="4775" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">API文档</li><li id="f2a0" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">API的监控</li><li id="d063" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">与不同的团队协作API，等等…</li></ul><blockquote class="lt"><p id="2407" class="lu lv iq bd lw lx ly lz ma mb mc kv dk translated">工作流就是这样一个特性。在这里，我们将更多地讨论什么是工作流，如何使用它，以及它的用例。</p></blockquote><p id="d43d" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi kw translated"><span class="l kx ky kz bm la lb lc ld le di"> P </span> ostman Workflow是一个API集合，允许我们对API的执行顺序进行排序和指定。这是邮差提供的另一个非常有用的功能。</p><h2 id="2264" class="mi mj iq bd mk ml mm dn mn mo mp dp mq kj mr ms mt kn mu mv mw kr mx my mz na bi translated">借助工作流功能，我们可以</h2><ul class=""><li id="659b" class="lf lg iq ka b kb nb kf nc kj nd kn ne kr nf kv lk ll lm ln bi translated">编写指定API执行顺序的脚本</li><li id="8951" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">调用特定API的次数(有助于创建模拟数据)</li><li id="625f" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">通过将值存储在postman提供的变量(全局和环境)中，将值从一个API响应传递到下一个API响应</li></ul><p id="a110" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">指定执行顺序的脚本被添加到请求前和请求后(测试脚本部分)脚本的组合中。</p><blockquote class="ng nh ni"><p id="aa55" class="jy jz nj ka b kb kc kd ke kf kg kh ki nk kk kl km nl ko kp kq nm ks kt ku kv ij bi translated"><strong class="ka ir">请求前脚本</strong>将在API调用之前执行，可用于填充请求体中的值。<strong class="ka ir"> <em class="iq">图1 </em> </strong>显示了postman UI上的预请求选项卡</p><p id="cb55" class="jy jz nj ka b kb kc kd ke kf kg kh ki nk kk kl km nl ko kp kq nm ks kt ku kv ij bi translated"><strong class="ka ir">请求后或测试脚本</strong>在API返回响应后执行，可以验证、解析响应体，如果需要，可以将值存储在环境变量中。<strong class="ka ir">图2 </strong>显示了postman UI上的post-request或test script选项卡</p></blockquote><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/173d05378e70152cd1b101c3b45e9441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GrNumPUYHmBBzasSwAIe9g.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图1 —显示了“预先请求”选项卡</figcaption></figure><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/372aae8470c2f1ddfa32b16de662bcb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-BVDWoqcS2NdNivV686ovg.jpeg"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图2——显示了测试脚本部分以及响应体的解析和环境变量中的值设置</figcaption></figure><blockquote class="lt"><p id="0785" class="lu lv iq bd lw lx ly lz ma mb mc kv dk translated"><strong class="ak"> JavaScript用于编写邮递员脚本</strong></p></blockquote><p id="cd4d" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">那么……用例是什么，这对开发团队和产品本身有什么帮助？</p><ul class=""><li id="c88c" class="lf lg iq ka b kb kc kf kg kj lh kn li kr lj kv lk ll lm ln bi translated">工作流帮助我们通过应用程序接口验证应用程序流</li><li id="3c2e" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">当应用程序处于开发阶段时，这个自动化过程可以生成大型数据集</li><li id="f8e2" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">数据的生成将有助于我们以有效的方式执行负载测试</li></ul><p id="0456" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好的……让我们看看这是怎么做到的</p><p id="a8d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">在演示应用程序中，我们有4个端点:</strong></p><ol class=""><li id="70a7" class="lf lg iq ka b kb kc kf kg kj lh kn li kr lj kv nx ll lm ln bi translated">创建新的员工记录</li><li id="f359" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv nx ll lm ln bi translated">检索所有员工记录</li><li id="913b" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv nx ll lm ln bi translated">让60岁以上的员工退休</li><li id="7322" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv nx ll lm ln bi translated">获取退休员工的记录</li></ol><blockquote class="lt"><p id="7fae" class="lu lv iq bd lw lx ly lz ma mb mc kv dk translated">演示应用程序基于带有PostgreSQL的Spring boot</p></blockquote></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><h2 id="93b5" class="mi mj iq bd mk ml mm dn mn mo mp dp mq kj mr ms mt kn mu mv mw kr mx my mz na bi translated"><strong class="ak"> API #1 —添加员工</strong></h2><p id="bac5" class="pw-post-body-paragraph jy jz iq ka b kb nb kd ke kf nc kh ki kj of kl km kn og kp kq kr oh kt ku kv ij bi translated">我们添加在请求体中看到的雇员信息(图3)，值将从环境变量中选取。</p><p id="4e73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请求体的值是通过预请求脚本自动生成的(图4)，并将它们存储在一个环境变量中(图5)</p><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/871783d12b25f6a41e874e430fb11c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B249-PJuWAl3HhOvS1bSug.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图3 —添加员工API的请求体，将获取值</figcaption></figure><figure class="no np nq nr gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/bc81c2f29c39a1b64c62cce1bdeeaef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*xh52nP4B9DaaLsdBnocEZw.png"/></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图4 —随机生成值并将其存储在环境变量中的请求前脚本</figcaption></figure><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/bdaae3c72e4a3d574dd099b8483a0ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0NAb709jnzlZB4BJzSj04Q.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图5 —执行预请求脚本后的值</figcaption></figure><p id="a4cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">显示从环境变量中提取并存储在数据库中的值的响应主体(图6)</p><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/28b96bfb4930ff32cfb7fb9bccbf3005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2QScB8yi_JbfaYTFbZ3HOA.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图6 —来自添加员工API调用的响应</figcaption></figure><p id="f059" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">添加雇员API循环100次，以创建100条雇员记录。达到期望的数量后，下一个API请求被设置为获取所有雇员记录(图7)</p><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/af06323d79fe6604746c6030ba7e955a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14BiOZ-qrOYOJnawNbQB7Q.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图7 — Post请求脚本处理调用循环并将调用重定向到下一个API</figcaption></figure><blockquote class="ng nh ni"><p id="55a4" class="jy jz nj ka b kb kc kd ke kf kg kh ki nk kk kl km nl ko kp kq nm ks kt ku kv ij bi translated">命名每个API调用非常重要，因为这将作为值传递给下一个请求，如<strong class="ka ir"> postman.setNextRequest("获取所有雇员")。</strong></p></blockquote></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><h2 id="e56b" class="mi mj iq bd mk ml mm dn mn mo mp dp mq kj mr ms mt kn mu mv mw kr mx my mz na bi translated">API #2 —获取所有员工的记录</h2><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/3477b0123f88c921baf08357f9850e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1SJzHZ-rONYy9FzIB5_q2g.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图8 —员工列表</figcaption></figure><p id="47c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">API将只被调用一次，在调用成功后，API将请求退休员工(图9)</p><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/5669703fc02e0b9522289e03716d5539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SOtBahTI6siOFQ3aLVn13g.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图9 —下一个请求设置为让员工退休</figcaption></figure></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><h2 id="4440" class="mi mj iq bd mk ml mm dn mn mo mp dp mq kj mr ms mt kn mu mv mw kr mx my mz na bi translated">API # 3—60岁以上的退休员工</h2><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi op"><img src="../Images/7ee6f07571e15f4ea5d3c2d7aa7682cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eYjMOd5-N6-VxZVuRT5AHA.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图10 —显示退休员工列表的回复</figcaption></figure><p id="54a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样，这个API只被调用一次，下一个请求在测试后脚本中设置(图11)</p><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oq"><img src="../Images/8eccbc42648a05a51706d751b8aafc02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ud80VYLHEzU0A4rBauZrhg.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图11 —设置下一个获取所有退休员工记录的请求</figcaption></figure></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><h2 id="aaaf" class="mi mj iq bd mk ml mm dn mn mo mp dp mq kj mr ms mt kn mu mv mw kr mx my mz na bi translated">API #4 —获取所有退休员工记录</h2><figure class="no np nq nr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/0e64b53652d8663d5fd24d790602fc5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vcZ-PhaN0US5a00HonPGIw.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图12 —所有退休员工列表</figcaption></figure><p id="bd3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦所有的API请求完成，环境变量的值在最后一个API调用的post请求脚本中被重置(图13)。</p><figure class="no np nq nr gt jr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/73d7aff032af187d067cd58980132727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*vi962DES0EKLfNSEmTvvRw.png"/></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图13 —重置值</figcaption></figure></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><blockquote class="ng nh ni"><p id="2183" class="jy jz nj ka b kb kc kd ke kf kg kh ki nk kk kl km nl ko kp kq nm ks kt ku kv ij bi translated">【https://github.com/raghavendra-hegde/postman-workflow-demo】源代码可以在这里找到——<a class="ae ot" href="https://github.com/raghavendra-hegde/postman-workflow-demo" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"/></a></p></blockquote><h2 id="674d" class="mi mj iq bd mk ml mm dn mn mo mp dp mq kj mr ms mt kn mu mv mw kr mx my mz na bi translated">自动化API调用非常有帮助</h2><ul class=""><li id="cca2" class="lf lg iq ka b kb nb kf nc kj nd kn ne kr nf kv lk ll lm ln bi translated">为应用程序负载测试生成大型数据集——当应用程序仍处于开发阶段时，通过手动过程创建数据既繁琐又耗时(通常如此)</li><li id="5b38" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">验证应用程序流</li><li id="57db" class="lf lg iq ka b kb lo kf lp kj lq kn lr kr ls kv lk ll lm ln bi translated">与CI/CD集成并验证所有API</li></ul><p id="cc10" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当在大型迭代中运行这个工作流时，使用<strong class="ka ir"> Newman </strong>，因为我不得不面对大量API调用的Postman UI问题，然而，为了验证脚本，你可以继续使用Postman UI。</p><blockquote class="lt"><p id="9470" class="lu lv iq bd lw lx ou ov ow ox oy kv dk translated"><strong class="ak"> <em class="oz">纽曼</em>是邮递员</strong>的命令行收集运行器</p></blockquote><p id="311a" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">谢谢你…！</p></div></div>    
</body>
</html>