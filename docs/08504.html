<html>
<head>
<title>Server side paginated data table in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Flutter中的服务器端分页数据表</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/server-side-paginated-data-table-in-flutter-d01b16f30f3?source=collection_archive---------1-----------------------#2021-05-07">https://levelup.gitconnected.com/server-side-paginated-data-table-in-flutter-d01b16f30f3?source=collection_archive---------1-----------------------#2021-05-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/188e54a69d2943052f459671005b40e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTwZq7ceSHClNuAconBNig.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">米卡·鲍梅斯特在<a class="ae jg" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><p id="82c1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Flutter非常棒，它为移动开发者和任何对用单一代码库完成项目感兴趣的人提供了广泛的可能性。但是默认控件集合中缺少一些控件和公共工作流。这篇文章是关于大型数据集的数据表以及如何在所有的Flutter平台上正确处理它。</p><h1 id="efef" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">前言—高级数据表</h1><p id="03d1" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我这里说的控件是我自己做的，可以在我的GitHub账号上找到。我意识到我在做一个需要显示大量数据的项目时需要它们。<br/>我确实重用了直接来自颤振控件的代码，你会在这种情况下的代码中找到相关注释。该软件包也可以通过pub.dev获得:</p><div class="is it gp gr iu mh"><a href="https://pub.dev/packages/advanced_datatable" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">高级_数据表| Flutter包</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">高级数据表使用Flutter PaginatedDataTable小部件，并向其添加了一些功能。不要添加…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">公共开发</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ja mh"/></div></div></a></div><p id="dd01" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">顺便说一下，除了pub.dev页面之外，还有其他使用包的方法，如这里描述的<a class="ae jg" href="https://flutter.dev/docs/development/packages-and-plugins/using-packages" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="21a4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想观看现场演示，请使用下面的链接。请记住，魔术是在后台发生的。使用浏览器和网络监视器的开发工具，您将看到您的客户端只获得当前页面的数据。</p><div class="is it gp gr iu mh"><a href="https://dev-owl.github.io/advanced_datatable/#/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">示例_高级_数据表</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">一个新的颤振项目。</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">dev-猫头鹰. github.io</p></div></div></div></a></div><h1 id="97ef" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">服务器端分页数据表</h1><p id="aacc" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">这是一个标题…</p><figure class="mx my mz na gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/0406f2d551aac87ca42fc07c3c6f113a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRMPny9g9mP9ADSvaYzung.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@swimstaralex?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Alexander Sinn </a>在<a class="ae jg" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="27ba" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简单一点说:Flutter已经提供了一个数据表和分页表。这些小部件都不支持这样的用例，即您的服务器/远程端进行分页，并且只向您的客户机发送当前页面。这样做的原因很简单:减少内存消耗，处理慢速连接。<br/>得益于<strong class="ki jk"> advanced_datatable </strong>，您现在可以在服务器上处理庞大的数据集，只需将一个页面所需的数据渲染到您的应用程序或网站。基本概念和功能与<a class="ae jg" href="https://api.flutter.dev/flutter/material/PaginatedDataTable-class.html" rel="noopener ugc nofollow" target="_blank">分页数据表</a>相同。</p><h1 id="26a7" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">如何使用它</h1><p id="111a" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">让我们从小部件本身开始，我建议将它添加到一个可滚动的父控件中。一个表可以增长并需要空间，最简单的设置是:</p><figure class="mx my mz na gt iv"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="549f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您需要定义想要显示的列和数据源。这些列使用了现有的来自flutter的<em class="nd"> DataColumn </em>类，请在这里找到文档<a class="ae jg" href="https://api.flutter.dev/flutter/material/DataColumn-class.html" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="f069" class="ne lf jj bd lg nf ng dn lk nh ni dp lo kr nj nk ls kv nl nm lw kz nn no ma np bi translated">您的数据源</h2><p id="b3b0" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">数据源是连接您的表和远程后端的关键元素(顺便说一下，数据也可以从文件或数据库中读取，它不一定是服务器)。<br/>你需要扩展<em class="nd">AdvancedDataTableSource&lt;T&gt;</em>类，并为你的数据指定一个类型。在<a class="ae jg" href="https://dev-owl.github.io/advanced_datatable/" rel="noopener ugc nofollow" target="_blank">实时示例</a>中，该类被称为<em class="nd"> CompanyContact </em>并存储从我的数据源返回的数据(事实上，示例中用作后端的示例web服务器是用纯dart编写的，<a class="ae jg" href="https://github.com/Dev-Owl/advanced_datatable/blob/main/example/webserver/bin/serveTestData.dart" rel="noopener ugc nofollow" target="_blank">在这里查看代码</a>)。完整的数据源如下所示。</p><figure class="mx my mz na gt iv"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="26ab" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">必须实现以下功能:</p><ul class=""><li id="2f30" class="nq nr jj ki b kj kk kn ko kr ns kv nt kz nu ld nv nw nx ny bi translated">getRow</li><li id="13c6" class="nq nr jj ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated">获取下一页</li><li id="fbbb" class="nq nr jj ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><em class="nd"> selectRowCount </em>(不是函数，还需要到位)</li></ul><p id="fb3d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有的函数都会在需要的时候被advanced_datatable调用，你只需要做到以下几点:</p><ol class=""><li id="a5e0" class="nq nr jj ki b kj kk kn ko kr ns kv nt kz nu ld oe nw nx ny bi translated">在<em class="nd"> getNextPage </em>中，您必须将您的数据作为<em class="nd">RemoteDataSourceDetails</em>对象提供。您需要设置当前页面的总行数和行数据。Advanced_datatable将为您提供加载数据的所有信息(页面大小、偏移量、排序细节)。</li><li id="3819" class="nq nr jj ki b kj nz kn oa kr ob kv oc kz od ld oe nw nx ny bi translated"><em class="nd"> getRow </em>将请求一个<a class="ae jg" href="https://api.flutter.dev/flutter/material/DataRow-class.html" rel="noopener ugc nofollow" target="_blank"><em class="nd">DataRow</em></a><em class="nd"/>通过传递一个索引给你。您可以确保索引存在于当前加载的页面中。使用<em class="nd"> lastDetails可以访问最后加载的细节。</em>在上面的例子中，模型类(<em class="nd"> CompanyContact </em>)实现了一个<a class="ae jg" href="https://github.com/Dev-Owl/advanced_datatable/blob/main/example/lib/company_contact.dart#L18" rel="noopener ugc nofollow" target="_blank">函数来返回<em class="nd"> DataRow </em> </a></li></ol><p id="661f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是你在flutter中拥有一个远程端分页的<em class="nd">异步</em>数据表所需要做的一切，简而言之:</p><ol class=""><li id="b143" class="nq nr jj ki b kj kk kn ko kr ns kv nt kz nu ld oe nw nx ny bi translated">创建行模型</li><li id="c322" class="nq nr jj ki b kj nz kn oa kr ob kv oc kz od ld oe nw nx ny bi translated">定义列列表</li><li id="121f" class="nq nr jj ki b kj nz kn oa kr ob kv oc kz od ld oe nw nx ny bi translated">用getRow和<em class="nd"> getNextPage </em>实现<em class="nd"> DataSource </em>类</li></ol><h1 id="e4b9" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">一些简洁的额外内容</h1><figure class="mx my mz na gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi of"><img src="../Images/6df1f5b77b20040a1a0d25be55c23fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_sydRtY-DM559T3L5cpyKg.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">迈克尔·泽兹奇在<a class="ae jg" href="https://unsplash.com/s/photos/excel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="e794" class="ne lf jj bd lg nf ng dn lk nh ni dp lo kr nj nk ls kv nl nm lw kz nn no ma np bi translated">空行</h2><p id="57ea" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">原始数据表不断用空行填充页面，以确保您的页面上始终有固定数量的行(即使没有足够的数据)。要禁用此默认行为，只需设置:</p><pre class="mx my mz na gt og oh oi oj aw ok bi"><span id="ce15" class="ne lf jj oh b gy ol om l on oo">addEmptyRows: false</span></pre><h2 id="ae09" class="ne lf jj bd lg nf ng dn lk nh ni dp lo kr nj nk ls kv nl nm lw kz nn no ma np bi translated">装货</h2><p id="cac2" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在加载数据时，您可能希望以自己的方式通知用户。将回调传递给以下参数:</p><pre class="mx my mz na gt og oh oi oj aw ok bi"><span id="e809" class="ne lf jj oh b gy ol om l on oo">loadingWidget: () =&gt; Text('Loading...')</span></pre><p id="68eb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果不设置回调，advanced_datatable会显示进度指示器。</p><h2 id="874d" class="ne lf jj bd lg nf ng dn lk nh ni dp lo kr nj nk ls kv nl nm lw kz nn no ma np bi translated">错误状态</h2><p id="6fa4" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">您的数据可能是通过互联网下载的，这可能会因为各种各样的原因而失败。像加载小部件一样，您可以通过设置以下参数向用户传达此状态:</p><pre class="mx my mz na gt og oh oi oj aw ok bi"><span id="9ad8" class="ne lf jj oh b gy ol om l on oo">errorWidget: () =&gt; Text('Error unable to load data...')</span></pre><p id="032c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果没有设置上述内容，并且出现错误，advanced_datatable将呈现一个包含(如果可能的话)错误信息的文本。</p><h1 id="b40d" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="08b6" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">随着Flutter在越来越多的平台上可用，允许在更大的数据集上工作的灵活小部件的需求将变得越来越重要。我在这里创建的东西相当简单，我只是刚刚开始，任何反馈或你错过的功能都是非常欢迎的<a class="ae jg" href="https://github.com/Dev-Owl/advanced_datatable/issues/new" rel="noopener ugc nofollow" target="_blank">只要在GitHub </a>上开一张票。</p></div></div>    
</body>
</html>