<html>
<head>
<title>Rent price prediction using PyTorch — Part1: Data Cleaning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于PyTorch的租金价格预测第一部分:数据清理</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/rent-price-prediction-using-pytorch-part1-data-cleaning-d4481fb07670?source=collection_archive---------27-----------------------#2020-06-04">https://levelup.gitconnected.com/rent-price-prediction-using-pytorch-part1-data-cleaning-d4481fb07670?source=collection_archive---------27-----------------------#2020-06-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="dbcb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是PyTorch入门系列教程的第一部分。除了这些教程，我们还试图熟悉一些基本的深度学习建模。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/ad5ccdc665ae1acf177489ab9b355bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T2VpHvukTUP1Xy71"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@serjosoza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> sergio souza </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="b5c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于第一部分，我们将准备好我们的数据来应用模型。我们使用巴西房屋租金价格的数据集。</p><p id="92bc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那么，我们开始吧。首先将数据读入熊猫数据帧:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="b8c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">查看dataframe的前五行，我们可以发现我们的一些特性需要转换成数值。列<code class="fe lh li lj lk b">city</code>、<code class="fe lh li lj lk b">animal</code>、<code class="fe lh li lj lk b">furniture</code>是分类的，所以它们是需要转换的列。</p><p id="4b22" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看dataframe info来检查每一列的数据类型:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="d9e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">嗯，看上面的输出，<code class="fe lh li lj lk b">floor</code>也需要转换成数值数据类型。</p><p id="50b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是在此之前，让我们将列的名称重命名为更方便的名称:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><h1 id="64f0" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">转换城市值</h1><p id="1625" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">准备好列名后，让我们将分类数据转换成数字。为此，我们将使用sklearn的标签编码器:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="d357" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如上所示，我们创建了一个名为<code class="fe lh li lj lk b">cityLE</code>的标签编码器，并通过使用<code class="fe lh li lj lk b">fit_transform()</code>函数将城市名转换成整数:0、1、2、3和4。然后，在<code class="fe lh li lj lk b">inverse_transform()</code>的帮助下，我们可以从这些关键数字中取回城市名称。这很像python中的字典，每个键(整数)都映射到一个城市名。</p></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><h1 id="1c83" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">数据探索性分析</h1><p id="2d66" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">到目前为止，我们已经将城市名称转换为数值。接下来，在转换其他列之前，我们将进行一些探索性的数据分析。简单来说，让我们看看每个城市有多少条记录:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="9a5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意<code class="fe lh li lj lk b">list(cityLE.classes_)</code>给出了所有城市名称的列表(以便映射到它们相应的数字)。显然我们大部分的记录都来自贝洛奥里藏特市。</p><p id="ffb4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们更深入地研究探索性数据分析。我们将根据房屋面积和总价来绘制每个租金价格。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="46b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可能已经注意到了，这个散点图向我们展示了大部分区域的价值低于1000-2000，价格也低于40000。当然，我用这些值来限制面积和总量的范围。(在本教程的下一部分中，我们将删除超出此范围的行)<br/>我的目的是删除将来可能对我们的模型产生干扰的记录。此外，在绘制数据时要有一个更合适的数字。然而，在现实世界的项目中，这可能不是一件好事，但在这里，我们只想清理数据，以便更好地进行学习。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="6946" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于每五个城市，我们绘制了成本/面积散点图(第六个数字是空的)。现在可以认识到，随着每栋房子面积的增加，租金价格也会上涨。我想现在够了EDA。让我们继续将分类数据转换成数字。</p></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><h1 id="6f35" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">转换家具价值</h1><p id="894c" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">类似于我们将城市名转换为数字，我们将把家具列值转换为数字。之后，我们要检查这一列的值是多少。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="4b67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据图表显示的情况，大多数房子都配有家具。在数据转换之后，这一列的值将是0和1。</p></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><h1 id="7ca6" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">转换动物价值观</h1><p id="36be" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">类似于我们将城市名称和家具值转换为数字，我们将把动物列值转换为数字。之后，我们要检查这一列的值是多少。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="a0c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据图表显示，大多数房子允许带动物。在数据转换之后，这一列的值将是0和1。</p></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><h1 id="3c79" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">转换地板值</h1><p id="879a" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">正如我们前面看到的，floor的值不是int64类型。所以，让我们弄清楚为什么。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="ba10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">事实证明，对于该列中的空值，他们使用了破折号字符。所以，我们需要把这个值改成数字。因为我们的数据集中没有0层，所以我们用' 0 '代替'-'。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="0ea6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，该列的每个值都是一个字符串数字，让我们将其数据类型转换为Int64。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="7156" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为将对象直接转换为Int64是不可能的，所以先转换为float，然后再转换为Int64。</p><p id="7142" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看我们的数据框架信息。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="ac11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到目前为止，一切顺利。我想我们已经达到了这部分教程的目标。我们的数据框架的每一列都有数值，这是我们的模型所需要的。因此，让我们将数据帧保存到CSV文件中。在接下来的部分中，我们将使用这个版本的数据集。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="c7e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在接下来的部分，我们将使用PyTorch创建一些模型来预测房屋的租金价格。</p><p id="4a43" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在<a class="ae le" href="https://jovian.ml/khatami7596/01-renting-price-data-cleaning" rel="noopener ugc nofollow" target="_blank">Jovian</a>T3】找到与这篇文章相关的笔记本，这里是Kaggle上数据集的链接:<a class="ae le" href="https://www.kaggle.com/rubenssjr/brasilian-houses-to-rent" rel="noopener ugc nofollow" target="_blank">数据集</a></p></div><div class="ab cl ll lm hx ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="im in io ip iq"><p id="b69f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mv">原载于2020年6月4日</em><a class="ae le" href="https://akhatami.com/rent-price-prediction-using-pytorch-part1-data-cleaning/" rel="noopener ugc nofollow" target="_blank"><em class="mv">【https://akhatami.com】</em></a><em class="mv">。</em></p></div></div>    
</body>
</html>