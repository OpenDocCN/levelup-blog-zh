<html>
<head>
<title>Multiple Face Recognition Models in Under 15 Lines of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不到15行代码中的多个人脸识别模型</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/multiple-face-recognition-models-under-15-lines-of-code-e505e89a97ae?source=collection_archive---------7-----------------------#2020-03-25">https://levelup.gitconnected.com/multiple-face-recognition-models-under-15-lines-of-code-e505e89a97ae?source=collection_archive---------7-----------------------#2020-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1aeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以脸书的“DeepFace”或谷歌的“OpenFace”为例——它们都是开源的，预测也非常准确。事实上，这些算法中的一些应该比人更准确！在这篇短文中，我们将首先了解人脸检测和人脸识别之间的区别，然后继续编写用于人脸识别的python代码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/fd72f262097d03b8ca331eb07b3b00b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yOAuTyO0Tpxrbn2F"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">萨曼莎·亨托什在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="5950" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak">人脸检测vs人脸识别</strong></h1><p id="8eb6" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">人脸检测和人脸识别在业内可以互换使用，但它们之间有很大的区别。<br/> <em class="mm">人脸检测</em> —这是一种确定静止图像或视频帧中人脸的存在和位置的机制。<br/><br/>简单来说，人脸检测是人脸识别技术的一个子集。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="650b" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak">让我们开始编码</strong></h1><p id="4345" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">只需不到15行代码，你就可以使用各种算法——deep Face、OpenFace、FaceNet、VGG-Face来识别两幅图像是否属于同一个人。为此，我们将使用一个名为“DeepFace”的库。</p><pre class="km kn ko kp gt mn mo mp mq aw mr bi"><span id="5c40" class="ms lk iq mo b gy mt mu l mv mw">!pip install DeepFace<br/>from deepface import DeepFace</span><span id="a5dd" class="ms lk iq mo b gy mx mu l mv mw">search_photo_path = "/Users/shirishgupta/Documents/DeepFace/images/"</span><span id="afa7" class="ms lk iq mo b gy mx mu l mv mw">def verification(img1, img2, model_name = "VGG-Face", <br/>distance_metric = "cosine"):<br/>    start = time.time()    <br/>    result = DeepFace.verify(search_photo_path + img1,search_photo_path + img2, model_name = model_name,<br/>                             distance_metric = distance_metric)<br/>    print(result) <br/>    demography = DeepFace.analyze(search_photo_path + img1,['age', 'gender', 'Emotion'])<br/>    print("Age :", demography["age"])<br/>    print("Gender :", demography["gender"])<br/>    print("Emotion :", demography["emotion"])<br/>    end = time.time()<br/>    print("Total Time Taken :", end - start)</span></pre><p id="5047" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你仔细阅读代码，它不仅会'<em class="mm">验证</em>两幅图像是否相同，还会使用'<em class="mm">分析</em>功能来识别<em class="mm">年龄、性别、种族、情感</em>。哇哦。</p><blockquote class="my"><p id="e4f3" class="mz na iq bd nb nc nd ne nf ng nh kk dk translated">默认模型是“VGG面”，但你也可以使用“开放面”、“面网”或“深度面”<br/>。同样，对于距离度量，默认是“余弦”相似度，但你也可以使用“欧几里德”或“欧几里德_l2”</p></blockquote><h1 id="5dd5" class="lj lk iq bd ll lm ni lo lp lq nj ls lt lu nk lw lx ly nl ma mb mc nm me mf mg bi translated">让我们测试一些样品</h1><h1 id="fe0e" class="lj lk iq bd ll lm ni lo lp lq nj ls lt lu nn lw lx ly no ma mb mc np me mf mg bi translated"><strong class="ak"> <em class="nq">同一个人</em> </strong></h1><div class="km kn ko kp gt ab cb"><figure class="nr kq ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/7d1c0f5d3a6bc0d4f5f8b42e2dfb849f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*Fm645diiRwzTcp1dpWMhXQ.jpeg"/></div></figure><figure class="nr kq nx nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/78fd53e9749eba5c023bef1fdc25edc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*d2x5SasHUr5XkNQoEvm9zw.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk ny di nz oa translated">比较索菲亚·维加拉(又名《摩登家庭》中的格洛丽亚)的两张照片</figcaption></figure></div><pre class="km kn ko kp gt mn mo mp mq aw mr bi"><span id="b475" class="ms lk iq mo b gy mt mu l mv mw"><strong class="mo ir">Call the verification function</strong><br/>verification(img1 = "Gloria1.jpg", img2 = "Gloria2.jpg")</span><span id="2d9b" class="ms lk iq mo b gy mx mu l mv mw"><strong class="mo ir">Result </strong><br/>{‘verified’: <strong class="mo ir">True</strong>, ‘distance’: 0.29478079080581665, ‘max_threshold_to_verify’: 0.4, ‘model’: ‘VGG-Face’, ‘similarity_metric’: ‘cosine’}<br/>Age : 30.826963232265545<br/>Gender : <strong class="mo ir">Woman</strong><br/>Emotion : {‘angry’: 1.1257877896953225e-10, ‘disgust’: 2.3604164951090527e-28, ‘fear’: 2.051567015188407e-17, ‘happy’: 99.99970793722319, ‘sad’: 3.787624262327966e-12, ‘surprise’: 6.746326677509912e-08, ‘<strong class="mo ir">neutral</strong>’: 0.0002937411129556654}<br/>Total Time Taken : 22.704721927642822</span></pre><h1 id="4a5d" class="lj lk iq bd ll lm ni lo lp lq nj ls lt lu nn lw lx ly no ma mb mc np me mf mg bi translated">不同的人</h1><div class="km kn ko kp gt ab cb"><figure class="nr kq ob nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/fa1fabbbc6a09db5d6adfdddb4c27df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*d2x5SasHUr5XkNQoEvm9zw.jpeg"/></div></figure><figure class="nr kq oc nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/22f74dfafca4c2b679674c408ec6f7f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*21swFP6hBf290U851m22qQ.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk od di oe oa translated">比较索菲亚·维加拉(又名《摩登家庭》中的格洛丽亚)和朱丽·鲍温(又名《摩登家庭》中的克莱尔)</figcaption></figure></div><pre class="km kn ko kp gt mn mo mp mq aw mr bi"><span id="d0f2" class="ms lk iq mo b gy mt mu l mv mw"><strong class="mo ir">Call the verification function</strong><br/>verification(img1 = "Gloria2.jpg", img2 = "Claire1.jpg")</span><span id="1286" class="ms lk iq mo b gy mx mu l mv mw"><strong class="mo ir">Result</strong><br/>{‘verified’: <strong class="mo ir">False</strong>, ‘distance’: 0.760310709476471, ‘max_threshold_to_verify’: 0.4, ‘model’: ‘VGG-Face’, ‘similarity_metric’: ‘cosine’}<br/>Age : 24.55772955064261<br/>Gender : <strong class="mo ir">Woman</strong><br/>Emotion : {‘angry’: 0.028805792680941522, ‘disgust’: 4.2523261356564035e-06, ‘fear’: 5.214745178818703, ‘happy’: 0.01625357399461791, ‘sad’: 0.5649986676871777, ‘surprise’: 0.09074355475604534, ‘<strong class="mo ir">neutral</strong>’: 94.0844476222992}<br/>Total Time Taken : 24.77853012084961</span></pre><p id="3c9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">显然，在这两种情况下，算法都能够验证照片是否属于同一个人。</p><h1 id="2073" class="lj lk iq bd ll lm ni lo lp lq nj ls lt lu nn lw lx ly no ma mb mc np me mf mg bi translated">结束语</h1><p id="85dc" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">我没有深究这背后的数学，而是专注于实际应用。这篇文章的灵感来自于Sefik Ilkin Serengil<em class="mm">的一篇文章。希望你喜欢这篇短文！</em></p></div></div>    
</body>
</html>