<html>
<head>
<title>Infrastructure as Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基础设施作为代码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/infrastructure-as-code-3f6187678e6a?source=collection_archive---------7-----------------------#2021-01-10">https://levelup.gitconnected.com/infrastructure-as-code-3f6187678e6a?source=collection_archive---------7-----------------------#2021-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8bef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是什么？你为什么要用它？怎么才能入门？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/91b4c1273f04feb4d00144a9103c14a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d7aiX1pO3DEYN8o4"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">泰勒·维克在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="93c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文解释了什么是“作为代码的基础设施”(通常称为IaC)，以及它为什么如此有用。它还包括一个工具列表，可以帮助您使用IaC构建和部署下一个应用程序。</p><h1 id="7375" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak">什么是‘基础设施即代码’？</strong></h1><p id="4f6c" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">IaC就像它在tin上所说的那样，将您的基础设施定义为代码。为了帮助我们更好地理解它，让我们后退一步。</p><p id="f299" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">什么是“基础设施”？软件工程中的基础设施通常是指应用程序或服务的骨骼，通常是运行应用程序或服务所需的硬件。例如，一个网站的基础设施是它运行的服务器和它使用的任何数据库。谈到基础设施时，一些主要的例子是:服务器、数据库、API网关、身份和访问管理服务以及数据存储。</p><p id="0f2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们知道了什么是基础设施，我们可以更深入地回答这个问题。<strong class="jp ir">基础设施即代码是一个定义应用或服务基础设施(如服务器、数据库、数据存储等)的过程。)代码中。通过编辑代码和部署更改，可以创建、更改或破坏基础结构。</strong></p><h1 id="6aeb" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">“基础设施即代码”为什么有用？</h1><p id="4958" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">因此，IaC是一个让我们用代码定义我们的基础设施<em class="mf">的过程，但是为什么这是一件好事呢？</em></p><p id="6a88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常，在过去，如果您的应用程序或服务的基础架构需要一些硬件，例如服务器或数据库，您可以创建自己的基础架构(购买一些物理硬件并对其进行配置以完成您想要的功能)，或者从云提供商(例如AWS、Google Cloud、MongoDB等)购买一些预配置的硬件。).出于本文的目的，我们将主要讨论从云提供商处购买的服务/硬件。为了创建您的基础架构，您需要访问您的云提供商的网站/控制台，并点击许多按钮。好吧，为什么这不好？<strong class="jp ir">点击网站/控制台中的按钮是一个手动过程；这需要时间，容易出错，并且不容易重现</strong>。</p><h2 id="ab81" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak">最新文件</strong></h2><p id="2e9d" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">当您用代码编写基础设施时，您也在创建文档。您使得任何人(有权访问您的代码的人)都很容易理解您的应用程序或服务使用了哪些资源。这对不了解这个系统的人理解它是如何工作的非常有用。您可以保证代码的最新版本反映了基础设施的当前状态，这意味着您的代码是基础设施的最新文档。</p><p id="9011" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果没有IaC，您将需要浏览云服务网站/控制台，并尝试拼凑哪些资源存在以及它们是如何连接的，以便为整个系统构建基础架构。应用程序或服务可能有书面文档，但很容易忘记更新它，并且可能不容易让每个人都理解。</p><h2 id="a662" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak">变化日志</strong></h2><p id="6cf2" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">使用IaC，对基础设施的更改就像任何其他代码更改一样。您可以编写测试来断言某些资源存在，您可以提交您的更改，您可以创建一个包含更改的代码审查，供您的团队审查。这是有价值的，原因有很多，首先，它要求你团队中的其他人看到你的变更并批准它们。其次，如果您因为应用程序或服务中断而在半夜被吵醒，您可以查看最近的提交，以查明基础架构的更改中断了什么。</p><p id="435c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果没有IaC，就很难发现对系统的基础设施做了什么更改。这也意味着对运行应用程序或服务的基础设施所做的更改暴露得更少。如果你是团队的一员，或者有第三方贡献者，让他们知道这些变化是很重要的。</p><h2 id="9136" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak">可重复使用的基础设施组件</strong></h2><p id="f22e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我们都知道重用代码节省了时间和资源，同时也减少了技术债务。对于用代码编写的基础设施也是如此。假设您已经创建了一组资源来管理用户身份验证和授权，这组资源有；身份和访问管理服务、数据库和无服务器功能(例如AWS Lambda)。这些资源配置了正确的权限，可以相互通信。这组资源解决了一个常见的问题，一个您可能希望在多个不同的应用程序或服务中使用的问题。通过在代码中定义您的基础设施，您可以非常容易地为不同的应用程序或服务构建这些资源的新版本。</p><h2 id="2693" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak">每个阶段相同的环境</strong></h2><p id="c894" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">一个应用程序或服务的常见最佳实践是拥有该应用程序或服务的多个阶段。最常见的设置是有一个测试和生产阶段，但是有一个测试，伽玛和生产阶段也很常见。当您想要创建多个阶段时，您需要在每个环境中复制相同的手动过程来创建基础结构。有了IaC，这就容易多了，您可以定义想要创建的资源，并将其部署到每个阶段。这样做的另一个好处是，它使所有阶段保持同步。</p><p id="4af9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果没有IaC，很容易改变一个阶段，而忘记其他阶段。这很糟糕，因为这意味着您的测试阶段不能准确地代表您的生产阶段。</p><h1 id="041d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">怎么才能入门？</h1><p id="991f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">现在我们知道了什么是IaC，为什么它有用，有什么工具可以帮助我们用代码编写和部署我们的基础设施？</p><h2 id="0266" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak">地形</strong></h2><p id="f74f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><a class="ae lb" href="https://www.terraform.io/" rel="noopener ugc nofollow" target="_blank"> Terraform </a>是一款开源工具，用于以代码形式编写和部署基础设施。它有与许多云提供商(例如AWS、Google Cloud、Azure等)合作的优势。).Terraform的缺点是，你用Terraform的定制语言编写你的基础设施，这是你必须学习的。</p><h2 id="c2ee" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak">自动气象站云形成</strong></h2><p id="205f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><a class="ae lb" href="https://aws.amazon.com/cloudformation/" rel="noopener ugc nofollow" target="_blank"> AWS CloudFormation </a>是AWS提供的一项服务，它让您可以用代码定义AWS资源的基础设施。CloudFormation由一组资源“堆栈”组成。AWS CloudFormation的缺点是它有自己的语法，是用JSON或YAML编写的，所以你要花很多时间看CloudFormation文档。</p><h2 id="0111" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak">谷歌云部署管理器</strong></h2><p id="1dbc" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><a class="ae lb" href="https://cloud.google.com/deployment-manager" rel="noopener ugc nofollow" target="_blank">Google Cloud Deployment Manager</a>是来自Google Cloud的一项服务，它让您可以用代码定义Google Cloud服务的基础设施。部署管理器允许您用YAML、Python或Jinja2以声明格式定义您的资源。</p><h2 id="4905" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">Azure资源管理器</h2><p id="7e3e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><a class="ae lb" href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/overview" rel="noopener ugc nofollow" target="_blank"> Azure资源管理器</a>是微软Azure的一项服务，它让你用代码定义Azure服务的基础设施。</p><h2 id="ef82" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated"><strong class="ak"> AWS CDK(推荐)</strong></h2><p id="8b11" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><a class="ae lb" href="https://aws.amazon.com/cdk/" rel="noopener ugc nofollow" target="_blank"> AWS CDK </a>是一个开源框架，允许你用它支持的语言之一(TypeScript、JavaScript、Python、Java和C#/)编写AWS资源的基础设施。网)。CDK的好处是你可以用一种熟悉的语言来编写你的基础设施，并且可以从你的IDE中获得帮助(比如智能感知)。您使用AWS CDK编写的代码会创建AWS CloudFormation模板，然后用于部署您的基础架构。</p><p id="9f6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是如何使用AWS CDK在Typescript中定义AWS DynamoDB表的示例:</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="9eea" class="mg ld iq mt b gy mx my l mz na">const table = new dynamodb.Table(this, 'Table', {<br/>    partitionKey: {<br/>        name: 'id',<br/>        type: dynamodb.AttributeType.STRING <br/>    }<br/>});</span></pre><h1 id="659c" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="9e58" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">基础设施作为代码是为应用程序或服务的基础设施创建或编辑资源的一个很好的过程。通过减少创建和维护基础设施所需的手动过程，它可以帮助您的开发更上一层楼。</p><p id="a354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">想试试吗？我建议从<a class="ae lb" href="https://cdkworkshop.com/" rel="noopener ugc nofollow" target="_blank"> AWS CDK工作室</a>开始。该研讨会将引导您创建一个“hello world”HTTP API，并包含在<a class="ae lb" href="https://aws.amazon.com/free" rel="noopener ugc nofollow" target="_blank"> AWS免费层</a>中。</p></div></div>    
</body>
</html>