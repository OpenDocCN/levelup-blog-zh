<html>
<head>
<title>Just-in-Time (JIT) and Ahead-of-Time (AOT) Compilation in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular中的实时(JIT)和提前(AOT)编译</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/just-in-time-jit-and-ahead-of-time-aot-compilation-in-angular-8529f1d6fa9d?source=collection_archive---------0-----------------------#2019-09-02">https://levelup.gitconnected.com/just-in-time-jit-and-ahead-of-time-aot-compilation-in-angular-8529f1d6fa9d?source=collection_archive---------0-----------------------#2019-09-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e637" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解JIT和AOT，它们是如何工作的，以及JIT和AOT的比较。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/15697bc6cfad7096110c0f22b02bb675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXa0JX5AUHFXOqm4fNhABA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@brookelark?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">布鲁克·拉克</a>在<a class="ae ky" href="https://unsplash.com/search/photos/coffee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="d89a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论即时和提前编译。我们将在Angular项目的上下文中查看它，但是这些原则可以应用于任何前端框架。</p><ol class=""><li id="ddc7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">什么是JIT</li><li id="6d6a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">JIT是如何工作的</li><li id="1431" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">什么是AOT</li><li id="2ca6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">AOT是如何运作的</li><li id="aecd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">JIT和AOT比较</li></ol><p id="fc13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mj">更多类似内容，请查看</em><a class="ae ky" href="https://betterfullstack.com/stories/" rel="noopener ugc nofollow" target="_blank"><em class="mj">https://betterfullstack.com</em></a></p><h1 id="37bd" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">什么是JIT</h1><p id="e2a3" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">根据<a class="ae ky" href="https://en.wikipedia.org/wiki/Just-in-time_compilation" rel="noopener ugc nofollow" target="_blank">维基百科</a>:</p><blockquote class="nh ni nj"><p id="74ca" class="kz la mj lb b lc ld ju le lf lg jx lh nk lj lk ll nl ln lo lp nm lr ls lt lu im bi translated">在<a class="ae ky" href="https://en.wikipedia.org/wiki/Computing" rel="noopener ugc nofollow" target="_blank">计算</a>中，<strong class="lb iu">实时</strong> ( <strong class="lb iu"> JIT </strong> ) <strong class="lb iu">编译</strong>(也称<strong class="lb iu">动态翻译</strong>或<strong class="lb iu">运行时编译</strong>)是一种执行<a class="ae ky" href="https://en.wikipedia.org/wiki/Computer_code" rel="noopener ugc nofollow" target="_blank">计算机代码</a>的方式，它涉及在程序执行期间<a class="ae ky" href="https://en.wikipedia.org/wiki/Compiler" rel="noopener ugc nofollow" target="_blank">编译</a>——在<a class="ae ky" href="https://en.wikipedia.org/wiki/Run_time_(program_lifecycle_phase)" rel="noopener ugc nofollow" target="_blank">运行时间</a>——而不是在执行之前。</p></blockquote><p id="5e72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者更简单地说，就是代码在需要的时候被编译，而不是在运行之前。</p><h1 id="fb8e" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">JIT是如何工作的</h1><p id="3729" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">最初，编译器负责将高级语言转换成目标代码(机器指令)，然后将目标代码链接成可执行文件。</p><p id="6db8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实时(JIT)编译器是运行时解释器的一个特性，它不是每次调用一个方法就解释字节码，而是将字节码编译成运行机器的机器代码指令，然后调用这个目标代码。</p><p id="069d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">角度项目中的流程:</p><ol class=""><li id="2f7c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使用Typescript、HTML、CSS (SCSS或SASS)开发一个Angular应用程序。</li><li id="59d0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用<code class="fe nn no np nq b">ng build</code>将源代码构建成包。这包括资产、js文件(惰性加载和JS映射中的模块、供应商和polyfill)、index.html和CSS。</li><li id="b0aa" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">然后我们将它构建到一个war文件中，由jboss部署，或者使用heroku或其他支持Node的主机直接部署。然后，我们通过CNAME将该主机映射到我们的域。</li><li id="9be4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">最终用户通过域访问我们的web应用程序。浏览器将下载所有资源，包括默认视图所需的HTML、CSS和JavaScript。</li><li id="e8e7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">角形引导应用程序</li><li id="61bd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">Angular将对应用程序中的每个组件进行JIT编译。然后应用程序被渲染。</li></ol><p id="7630" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:</p><ol class=""><li id="b265" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">在JIT中，最初并不是所有的代码都被转换成机器码。只有必要的(立即使用的)代码才会被转换成机器码。然后，如果一个方法或功能被调用并且不在机器代码中，那么它也将被转换成机器代码。这减轻了CPU的负担，并使应用程序渲染更快，因为它只使用需要的东西。</li><li id="6829" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">您可以在实现过程中在浏览器中进行调试，因为代码是用映射文件在JIT模式下编译的。这有助于您在inspector上直接查看和链接源代码。</li></ol><h1 id="49db" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">什么是AOT</h1><p id="c504" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">根据<a class="ae ky" href="https://en.wikipedia.org/wiki/Ahead-of-time_compilation" rel="noopener ugc nofollow" target="_blank">维基百科</a>。</p><blockquote class="nh ni nj"><p id="104f" class="kz la mj lb b lc ld ju le lf lg jx lh nk lj lk ll nl ln lo lp nm lr ls lt lu im bi translated">在计算机科学中，<strong class="lb iu">提前编译</strong> ( <strong class="lb iu"> AOT编译</strong>)是<a class="ae ky" href="https://en.wikipedia.org/wiki/Compiler" rel="noopener ugc nofollow" target="_blank">编译</a>更高级的<a class="ae ky" href="https://en.wikipedia.org/wiki/Programming_language" rel="noopener ugc nofollow" target="_blank">编程语言</a>如<a class="ae ky" href="https://en.wikipedia.org/wiki/C_(programming_language)" rel="noopener ugc nofollow" target="_blank"> C </a>或<a class="ae ky" href="https://en.wikipedia.org/wiki/C%2B%2B" rel="noopener ugc nofollow" target="_blank"> C++ </a>，或<a class="ae ky" href="https://en.wikipedia.org/wiki/Intermediate_representation" rel="noopener ugc nofollow" target="_blank">中间表示</a>如<a class="ae ky" href="https://en.wikipedia.org/wiki/Java_bytecode" rel="noopener ugc nofollow" target="_blank"> Java字节码</a>或<a class="ae ky" href="https://en.wikipedia.org/wiki/.NET_Framework" rel="noopener ugc nofollow" target="_blank">的行为。NET框架</a> <a class="ae ky" href="https://en.wikipedia.org/wiki/Common_Intermediate_Language" rel="noopener ugc nofollow" target="_blank">通用中间语言</a> (CIL)代码，转换成本机(系统相关)<a class="ae ky" href="https://en.wikipedia.org/wiki/Machine_code" rel="noopener ugc nofollow" target="_blank">机器码</a>以便生成的二进制文件可以本机执行。</p></blockquote><p id="f87d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这似乎很复杂，很难理解。他是怎么想的呢:</p><p id="e010" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在浏览器下载并运行代码之前，提前(AOT)编译器会在编译期间转换你的代码。在构建过程中编译应用程序可以更快地在浏览器中呈现。</p><p id="e598" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是好处[2]:</p><ul class=""><li id="eab7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nr mb mc md bi translated"><em class="mj">更快的渲染</em> —通过AOT，浏览器下载应用程序的预编译版本。浏览器加载可执行代码，因此它可以立即呈现应用程序，而无需等待先编译应用程序。</li><li id="4232" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nr mb mc md bi translated"><em class="mj">更少的异步请求— </em>编译器<em class="mj">在应用程序JavaScript内内嵌</em>外部HTML模板和CSS样式表，消除了对这些源文件的单独AJAX请求。</li><li id="9f4e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nr mb mc md bi translated"><em class="mj">更小的Angular框架下载大小</em> —如果app已经编译好了，就不需要下载Angular编译器了。编译器大约是Angular本身的一半，所以省略它会大大减少应用程序的负载。</li><li id="ef87" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nr mb mc md bi translated"><em class="mj">更早地检测模板错误</em>—AOT编译器在构建步骤中检测并报告模板绑定错误，然后用户才能看到它们。</li><li id="1a9e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nr mb mc md bi translated"><em class="mj">更好的安全性</em> —在HTML模板和组件提供给客户端之前，AOT就已经将它们编译成JavaScript文件。由于没有需要读取的模板，也没有危险的客户端HTML或JavaScript评估，注入攻击的机会就更少了。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Tobias Bosch的角度汇编解释</figcaption></figure><h1 id="dc38" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">AOT是如何运作的</h1><p id="031f" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">你可以在<a class="ae ky" href="https://angular.io/guide/aot-compiler#how-aot-works" rel="noopener ugc nofollow" target="_blank"> Angular documentation </a>阅读更多信息，了解AOT是如何工作的。但是，我有一个简单的解释:</p><ol class=""><li id="be2a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使用Typescript、HTML、CSS (SCSS或SASS)开发一个Angular应用程序。</li><li id="ef16" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用<code class="fe nn no np nq b">ng build --prod</code>构建源代码包，其中包括资产、JS文件(主文件、供应商文件和多填充文件)、index.html和CSS。在这一步中，Angular使用<a class="ae ky" href="https://www.npmjs.com/package/@angular/compiler-cli" rel="noopener ugc nofollow" target="_blank"> Angular编译器</a>来构建源代码，他们在<a class="ae ky" href="https://angular.io/guide/aot-compiler#compilation-phases" rel="noopener ugc nofollow" target="_blank">三个阶段</a>中完成，这三个阶段是<em class="mj">代码分析、</em>和<em class="mj">模板类型检查。</em>在这一步中，捆绑包的大小将小于我们以JIT模式构建时的捆绑包大小。</li><li id="802a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">然后，我们将它构建到war文件中，由jboss进行部署，或者使用heroku或其他托管支持节点的工具直接进行部署。然后，我们使用CNAME将该主机映射到我们的域。</li><li id="c83c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">最终用户通过域访问我们的web应用程序。浏览器将下载默认视图所需的所有资源，包括HTML、CSS和JavaScript。</li><li id="de45" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">有角度的引导和应用程序得到渲染。</li></ol><h1 id="6d33" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">JIT和AOT比较</h1><p id="e808" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">JIT和AOT在角度上的主要区别是:</p><ul class=""><li id="5c0a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nr mb mc md bi translated"><em class="mj">实时</em> (JIT)，运行时在浏览器中编译你的应用。</li><li id="6a4b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nr mb mc md bi translated"><em class="mj">提前</em> (AOT)，在服务器上编译你的应用。</li></ul><p id="5fc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您运行<code class="fe nn no np nq b"><a class="ae ky" href="https://angular.io/cli/build" rel="noopener ugc nofollow" target="_blank">ng build</a></code>(仅构建)或<code class="fe nn no np nq b"><a class="ae ky" href="https://angular.io/cli/serve" rel="noopener ugc nofollow" target="_blank">ng serve</a></code>(本地构建和服务)CLI命令时，JIT编译是默认的。这是为了发展。</p><p id="3314" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于AOT编译，包括带有<code class="fe nn no np nq b">ng build</code>或<code class="fe nn no np nq b">ng serve</code>命令的<code class="fe nn no np nq b">--aot</code>选项。另一种方法是使用<code class="fe nn no np nq b">--prod</code>，默认生产模式在<code class="fe nn no np nq b">Angular.json</code>中配置，AOT设置为<code class="fe nn no np nq b">true</code>。</p><p id="33b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是另一个对比:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/25ab7659b747526f0275996cd18485bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a15BveUQ7cFyV0P8CwLUCg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">JIT和AOT比较</figcaption></figure><h1 id="3c28" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">摘要</h1><p id="7778" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">JIT和AOT是Angular项目中编译代码的两种方式。我们在开发模式中使用JIT，而AOT用于生产模式。</p><p id="2f97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以很容易地在JIT模式下实现功能和调试，因为我们有映射文件，而AOT没有。然而，当我们将AOT用于生产时，最大的好处是减少了包的大小，从而加快了渲染速度。</p><p id="b65d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对你有用！可以跟着我上<a class="ae ky" href="https://medium.com/@transonhoang" rel="noopener">媒</a>。我也在推特上。欢迎在下面的评论中留下任何问题。我很乐意帮忙！</p><h1 id="cfde" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">资源/参考资料</h1><p id="58b5" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">[1]:JIT<a class="ae ky" href="https://guide.freecodecamp.org/computer-science/just-in-time-compilation/" rel="noopener ugc nofollow" target="_blank">https://guide . freecodecamp . org/computer-science/just-in-time-compilation/</a></p><p id="9b67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]:https://angular.io/guide/aot-compilerAOT<a class="ae ky" href="https://angular.io/guide/aot-compiler" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><div class="kj kk kl km gt oc"><a href="https://betterfullstack.com/stories/" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">故事-更好的全栈</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">关于JavaScript、Python和Wordpress的有用文章，有助于开发人员减少开发时间并提高…</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">betterfullstack.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq ks oc"/></div></div></a></div></div></div>    
</body>
</html>