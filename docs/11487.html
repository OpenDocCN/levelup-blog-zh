<html>
<head>
<title>Checking reboot requirements when using the RHEL SELinux system role</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RHEL SELinux系统角色时检查重新启动要求</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/checking-reboot-requirements-when-using-the-rhel-selinux-system-role-9062727eebf0?source=collection_archive---------20-----------------------#2022-03-20">https://levelup.gitconnected.com/checking-reboot-requirements-when-using-the-rhel-selinux-system-role-9062727eebf0?source=collection_archive---------20-----------------------#2022-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e4be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">SELinux RHEL系统角色可用于各种SELinux管理任务。一些最常见和最有用的是:</p><ul class=""><li id="98a7" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">设置“强制”或“允许”模式</li><li id="c3a4" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">设置SELinux用户映射</li><li id="a5f1" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">设置SELinux文件上下文</li><li id="771e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">设置SELinux布尔值</li><li id="3b89" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">在文件系统上运行<em class="kz"> restorecon </em></li></ul><p id="dcca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了开始使用RHEL系统角色，您必须安装它们。这可以通过运行以下命令来完成—“<em class="kz">yum install rhel-system-roles</em>”。默认情况下，角色安装在“/usr/share/ansible/roles”中。selinux系统角色可以在“/usr/share/ansi ble/roles/rhel-system-roles . selinux/”中找到。</p><p id="6ab0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦安装了RHEL系统角色，我们就可以创建一个剧本来利用SELinux系统角色。SELinux角色有时必须重新启动受管主机才能完成其预期功能。该角色通过将名为“<strong class="jp ir"> selinux_reboot_required </strong>”的变量设置为布尔值<em class="kz">真</em>或<em class="kz">假，来指示受管主机是否需要重启。</em>因为可能需要重新启动主机，所以使用block语句调用角色是个好主意。我们可以创建我们的block语句，这样，如果角色在执行过程中失败，可以使用rescue语句来继续执行该剧。在rescue语句中，我们可以首先使用条件来检查角色是否由于受管主机需要重新启动而失败。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi la"><img src="../Images/d7cda730ec3aa88aff78476aeead61d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*Wuu6NRIMboqrGqcQI3bVYQ.png"/></div></figure><p id="c987" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在前面的例子中，如果变量<strong class="jp ir">selinux _ reboot _ required</strong>被设置为<em class="kz"> false，</em>那么我们知道该角色的执行一定是由于需要重新启动之外的原因而失败的。如果是这种情况，条件“when”检查将评估为true，这将导致失败模块执行。从这里开始，我们的剧本执行将会停止，我们可以执行进一步的调试来找出导致我们的角色失败的确切原因。</p><p id="caac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，如果变量<strong class="jp ir">selinux _ reboot _ required</strong>被设置为<em class="kz"> true，</em>那么我们知道角色的执行失败是因为被管理的主机上需要重新启动。如果是这种情况，条件“when”检查将评估为false，这将导致跳过失败模块。rescue语句中使用的下一个模块将执行——在这种情况下，这将是<strong class="jp ir"> reboot </strong>模块，因为我们知道，由于角色<em class="kz">将<strong class="jp ir">selinux _ reboot _ required</strong>变量设置为<em class="kz"> true </em>，我们的托管主机需要重新启动。</em>一旦重启完成，该角色将再次被<strong class="jp ir"> include_role </strong>语句调用。既然已经满足了重新启动的要求，我们的角色应该会成功完成—排除本演练范围之外的任何其他问题。</p></div></div>    
</body>
</html>