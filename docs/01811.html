<html>
<head>
<title>File Processing Go vs. Rust</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文件处理Go vs. Rust</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/file-processing-go-vs-rust-6e210a3168fd?source=collection_archive---------10-----------------------#2020-01-30">https://levelup.gitconnected.com/file-processing-go-vs-rust-6e210a3168fd?source=collection_archive---------10-----------------------#2020-01-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d74d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">周末学习和建设</h2></div><p id="2b8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为我2020年新年决心的一部分:<strong class="kk iu"> <em class="le">“走”够了2019，再来点“锈”，2020。</em> </strong>我开始重温一些现实世界的例子来比较Go和Rust。</p><p id="a9c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请不要在这里误解我，我不喜欢谁是最好的谈话或辩论。对我来说，我的一个编程或解决原则是:</p><blockquote class="lf"><p id="9259" class="lg lh it bd li lj lk ll lm ln lo ld dk translated">在现实生活中，没有最好的编程语言/解决方案，最好的，只是基于特定的上下文&amp;时间戳。</p></blockquote><p id="c6e9" class="pw-post-body-paragraph ki kj it kk b kl lp ju kn ko lq jx kq kr lr kt ku kv ls kx ky kz lt lb lc ld im bi translated">Go和Rust都是很棒的编程语言；当你开始工作时，你会发现如此多的乐趣和生产力；然而，在这里我不喜欢做任何理论解释或比较。相反，我将在Go和Rust中构建两次真实世界的csv处理管道。</p><h1 id="16cb" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">用例</h1><p id="c306" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">让我们从数据库中提取一个csv文件。csv文件中的内联文本如下所示:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mr"><img src="../Images/fde2a49b24d7d341e4e2b4d64af7cc4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IC9MDrp_wpPnVTdv26UWmA.png"/></div></div></figure><h2 id="3b21" class="nd lv it bd lw ne nf dn ma ng nh dp me kr ni nj mg kv nk nl mi kz nm nn mk no bi translated">这是交易数据，包括每一行</h2><ol class=""><li id="0205" class="np nq it kk b kl mm ko mn kr nr kv ns kz nt ld nu nv nw nx bi translated">第11栏中的借方账号(如BD001002001)。</li><li id="2171" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated">第12列中的借方增量(如100)。</li><li id="b609" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated">第13栏中的贷记账号(如CD001002002)。</li><li id="9bf9" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated">第14列是贷记的增量(例如-100)。</li></ol><h2 id="5c76" class="nd lv it bd lw ne nf dn ma ng nh dp me kr ni nj mg kv nk nl mi kz nm nn mk no bi translated">这些要求是:</h2><ol class=""><li id="3548" class="np nq it kk b kl mm ko mn kr nr kv ns kz nt ld nu nv nw nx bi translated">阅读文件。</li><li id="1802" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated">统计借方账户合计增量</li><li id="e1e9" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated">计算贷方帐户的总增量。</li></ol><h2 id="5116" class="nd lv it bd lw ne nf dn ma ng nh dp me kr ni nj mg kv nk nl mi kz nm nn mk no bi translated">常见的解决方案是:并发处理文件。</h2><blockquote class="lf"><p id="896c" class="lg lh it bd li lj lk ll lm ln lo ld dk translated">让我们编码</p></blockquote><h1 id="19a1" class="lu lv it bd lw lx ly lz ma mb mc md me jz od ka mg kc oe kd mi kf of kg mk ml bi translated">Go版本</h1><p id="689e" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">Go最好的特性之一是并发性，它基于绿色线程处理并行性。这就是我们将要处理的并发需求。</p><h2 id="5d20" class="nd lv it bd lw ne nf dn ma ng nh dp me kr ni nj mg kv nk nl mi kz nm nn mk no bi translated">步骤1-读取文件。</h2><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi og"><img src="../Images/aab9348fca36b50ddece9c3b937b9bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*odDEvhYo5oDiCs8vnDvcqQ.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk translated">打开文件并在完成处理后关闭它</figcaption></figure><h2 id="7e71" class="nd lv it bd lw ne nf dn ma ng nh dp me kr ni nj mg kv nk nl mi kz nm nn mk no bi translated">步骤2 —映射</h2><p id="5f91" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">映射到返回格式。</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ol"><img src="../Images/8f9a017fa5aa5b2cd20c3ff4f789e865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adxo3KnT3OZSoIXv97rbpA.png"/></div></div></figure><h2 id="74be" class="nd lv it bd lw ne nf dn ma ng nh dp me kr ni nj mg kv nk nl mi kz nm nn mk no bi translated">第三步——还原剂</h2><p id="1a32" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">用总和减少输出。</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi om"><img src="../Images/46124015feb90860bc9dfc1e4b43e71b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJWTmv28xV3ZaFmv5bhkeg.png"/></div></div></figure><h2 id="d10f" class="nd lv it bd lw ne nf dn ma ng nh dp me kr ni nj mg kv nk nl mi kz nm nn mk no bi translated">第四步——一起</h2><p id="b02a" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">创建通道，初始化等待组，读取行，用goroutine处理，一旦所有处理完成，打印结果</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi on"><img src="../Images/e49ae5f5fdc0596043a4c1c6824e2041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9eda49KPxScOZbyMEQJEfg.png"/></div></div></figure><p id="ddbd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">1000行文件需要<strong class="kk iu">3.742808毫秒</strong></p><h1 id="6972" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">铁锈版本</h1><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oo"><img src="../Images/d0ef9a0d8c3492bd9c32f1a65fe35487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3pMwzJihWahgurloBr4Rw.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk translated">铁锈打开CSV</figcaption></figure><p id="6cf6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用Rust原生迭代器来处理用例。</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi op"><img src="../Images/3199cdadf3b5ab7570fa7c6b7fe09c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VUJKnuwXum12lqfa-oXlMw.png"/></div></div></figure><p id="605c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Sum实现。</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oq"><img src="../Images/3033cbd9bd00ea8d2b6c8323c82259a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VWhUogs0AcfnumbHAMjPqg.png"/></div></div></figure><p id="a093" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样的1000行，只用了~ 1.09ms。</p><h1 id="38e5" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><p id="a543" class="pw-post-body-paragraph ki kj it kk b kl mm ju kn ko mn jx kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">当我们谈论文件处理、原创时，我无疑会加入进去；然而，一旦我开始围绕Rust工作和测试。为了速度和安全，我肯定会用Rust。</p></div></div>    
</body>
</html>