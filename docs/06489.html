<html>
<head>
<title>Scrape Image URLs in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Power BI中抓取图像URL</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/scrape-image-urls-in-power-bi-cc24abc5b89?source=collection_archive---------8-----------------------#2020-11-30">https://levelup.gitconnected.com/scrape-image-urls-in-power-bi-cc24abc5b89?source=collection_archive---------8-----------------------#2020-11-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8830dbfbde2bde74eda75aacd5800b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rlK56uabpxxUpF5Y"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/photos/tI_DEyjWOkY" rel="noopener ugc nofollow" target="_blank">封面图片</a></figcaption></figure><p id="4637" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Power BI提供的许多强大的连接器中，如果您希望在报表中集成web抓取，Web连接器是一个很好的选择。虽然它有一些限制，比如只能抓取HTML表，但它仍然是Power BI中ETL功能的强大补充。</p><p id="663a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本教程中，我将带你从<a class="ae kc" href="https://www.countries-ofthe-world.com/flags-of-the-world.html" rel="noopener ugc nofollow" target="_blank">这里</a>刮国旗图像。我们将首先连接到网站以提取国家的表格，然后在Power Query中编写一些M代码来创建每个国家国旗图像的URL(是的，我们将弄脏自己的手来编写M)。最后，我们将加载该查询，并用多行卡片可视化来可视化图像。</p><p id="5730" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总之，这些将是涵盖的关键主题:</p><ul class=""><li id="50c1" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">用Web连接器抓取HTML表格；</li><li id="b6f0" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">追加查询；</li><li id="149d" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">在Power Query中创建新列和筛选行；</li><li id="51a0" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">在Power查询中对文本数据应用各种变换；和</li><li id="70cb" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">使用多行卡片视觉效果在报表中呈现图像。</li></ul><p id="deaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">说到实际效果，我们将接受国家名称，并为其国旗图像创建URL。这里有几个例子:</p><ul class=""><li id="80fd" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">阿富汗:【https://www.countries-ofthe-world.com/flags-normal/flag-of-】T4<strong class="kf ir">阿富汗</strong>。png</li><li id="bcf9" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">安提瓜和巴布达:<a class="ae kc" href="https://www.countries-ofthe-world.com/flags-normal/flag-of-Antigua.png;" rel="noopener ugc nofollow" target="_blank">https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">安提瓜</strong>png</a></li><li id="11d3" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">北马其顿(原马其顿):<a class="ae kc" href="https://www.countries-ofthe-world.com/flags-normal/flag-of-North-Macedonia.png." rel="noopener ugc nofollow" target="_blank">https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">北马其顿</strong> .png. </a></li></ul><p id="6076" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在演示结束时，您应该在Power BI报告中看到类似的结果:一个下拉切片器和一个显示图像的多行卡片。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/4eb093c87f5b672e82e87561f4bafa8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*vCJRO-aJ6UVcKp1SzZ5g8w.png"/></div></figure><p id="36a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为未来找到这篇文章的读者的注意事项，所描述的屏幕截图和功能将根据Power BI 2020年11月更新中提供的内容。</p><p id="377f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，这是一篇对初学者友好的文章，但是如果您已经体验过Power BI，并且只是想看看解决方案，您可能会很快看完它。</p><p id="3304" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，请理解有更好的工具和技术来执行web抓取，然后将这些数据提供给Power BI。本教程的目的是展示Web连接器，以及在没有其他选择的情况下，如何将抓取集成到Power BI中。</p><h1 id="c1ad" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">第1部分:加载HTML表格</h1><p id="07aa" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">与任何报表一样，要做的第一件事是连接到数据源。为了获取HTML表格，我们将使用Web连接器。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/e1d4e11bb8e35f5c130abe128db9a75c.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*jQndbEtowZqU0Bp3b70pJA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">选择Web数据源</figcaption></figure><p id="96ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该连接器将要求您通过几个对话框，您可以按如下方式填写它们:</p><pre class="lq lr ls lt gt my mz na nb aw nc bi"><span id="063e" class="nd lv iq mz b gy ne nf l ng nh">https://www.countries-ofthe-world.com/flags-of-the-world.html</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/b315113a5e88a4ae285261b8dc67b5b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*klYVDXHw1381Pwqfz3ADtw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">指定源URL</figcaption></figure><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/3ff4adb6e1d91fb745578aadc0cb7db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMVGnoqkBsVCX_6LUJa75Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">指定访问web内容的授权</figcaption></figure><p id="6032" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与其他连接器一样，您需要告诉Power BI您将使用哪种身份验证来访问web页面。由于这个数据源是公开的，我们可以继续匿名访问。请注意，这些设置将由Power BI作为全局数据源设置保存，但可以在Transform Data菜单下进行更改。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1f9470041b17ab22f2d15933904f3799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*PVTZq5Z9ZVg-JMpVhXPB8w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">访问数据源设置</figcaption></figure><p id="f01e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Power BI连接到web页面后，我们会看到通常的数据预览对话框。我们可以看到检索到了两个表，这正是我们要找的。第一个表包括从A到L的国家，第二个表包括从M到z的国家。我们将选择这两个表并开始转换数据。我们需要执行一些转换来获得最终结果。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/48f38170a6527a062d8c57f82a0bce01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XhOYdJUWL2B39kqG-ac3Cg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">加载HTML表以支持查询</figcaption></figure><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/a0d3f4789b762cae6f4db1b5dc92dee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x4FK5O9DSZ9E2Syf1gTZlQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">加载的查询</figcaption></figure><p id="a21f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果上面的截屏显示了与您的计算机相同的东西，那么您已经成功地将这两个表加载到您的Power查询中，并且到达了本教程第1部分的末尾。</p><p id="60d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">哦，如果您在超级查询窗口中看不到列质量和统计数据或公式栏，您可以在功能区菜单的视图选项卡中轻松自定义这些选项。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/f863af3473545c3a62c98e6780af46a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*480NyOK84qVl_F_RkFtI6g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">自定义视图选项</figcaption></figure><h1 id="198c" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">第2部分:追加表格</h1><p id="2cfe" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在这一点上，我们有所有国家的权力查询。但是，我们不需要也不想将它们分开放在两个表中。我们应该<em class="no">追加</em>它们，也就是说，将第二个表中的行放在第一个表的末尾，这样我们就有了一个包含所有国家的表。</p><p id="f2d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为两个表有相同的结构，两列有完全相同的数据，所以这个追加操作很简单。为此，导航到表1查询并从主页功能区菜单中选择追加查询选项。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/5c3e437cbfcecad08cbd5059725b73c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J6GpKk1eebCgH-qX9alAdA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">选择附加查询操作</figcaption></figure><p id="7cec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将打开另一个对话框，在该对话框中，您可以选择操作中涉及多少个表以及哪些表。我们正在做一个涉及两个表的基本追加，因此我们只需要选择哪个表是追加目标。如果您想从SQL合并的角度来考虑，那么在单击Append Queries之前选择的查询就是源。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/fa79a2c6135c4bb246d96f70fe9ebfcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQzhoS09aqsf_R-ukPCsMw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">追加查询选项</figcaption></figure><p id="6448" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在此之后，Power Query窗口的页脚应该显示Table 1查询中有2列223行，除非网站中的HTML表发生了变化。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/4099e749d567220bd81cbea1f3f64191.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*WzYNpzBHEGvro6I_wtVcyQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">表1查询形状</figcaption></figure><p id="1b04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在完成第2部分之前，我们应该禁用表2查询的加载，重命名查询，并过滤掉一些行。由于表2已经达到了它的目的，即加载从M到Z的国家并将该数据附加到表1，所以它不需要加载到报告中。此外，重命名查询是一个最佳实践，因为名称Table 1和Table 2没有多大意义。</p><p id="ef15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要禁止将查询加载到报告中，只需右键单击它并取消选中“启用加载”。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b5018f10668e0f104ff931f927271892.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*LgzhJ-vQM6mgWuM3uwN8JA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">禁用查询加载</figcaption></figure><p id="467f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">重命名查询有多种方法，但由于“rename”选项包含在前面屏幕截图的上下文菜单中，因此只需使用该选项来重命名两个查询。将表2重新命名为“M-Z国家”，将表1重新命名为“国家”。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/49bd80b34cff4fa185afb5d9dda286e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*L2OcihUPiXPb_8TeleNZoQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">重命名的查询</figcaption></figure><p id="11d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意被禁用的查询的名称是如何以斜体显示的，以表示其加载被禁用。</p><p id="00b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要为国家M-Z做的最后一件事是过滤掉带有单词“Country”的行。在Countries查询中需要该行，但在Countries M-Z中不需要。我们可以在append之前这样做，但这样您可以看到append是动态工作的，并且会在运行查询时检测到该更改，即在没有该行的情况下执行append。在这之后，国家应该有222行，而不是我们之前看到的223行。</p><p id="3f94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">只需导航到国家M-Z，并从下拉列表中取消选择值为“国家”的行。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/2e2f0d1dcf122459743b8862850f7e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*gbTaJP7Jc5s-YfnpbyoD3g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">过滤掉“国家”</figcaption></figure><p id="5d32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">至此，我们已经到达了第2部分的末尾。从数据源的提取已经完成，现在是时候将它转换成合适的格式了。</p><h1 id="9af4" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">第3部分:只保留国家名称</h1><p id="94ce" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在演示的这个阶段，我们的国家查询有两列:“列1”和“列2”。前者有一个单独的行，上面有单词<em class="no"> Flag </em>，而后者有单词<em class="no"> Country </em>在第一行，一些行中的字母表字母通过起始字母和实际的国家名称来分隔国家名称。为了只保留名字，我们必须经历几次不同的转换。</p><p id="ba72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从删除列1开始，因为它的内容是不相关的。右键单击列名，然后选择“删除”。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/361c39d0ca9955f90e9eb229a41fcfdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*C_lzpPne5zcFc3aLwfQTvQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">删除列1</figcaption></figure><p id="ed03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们应该使用第一行作为标题。有时，Power BI在加载时不能正确识别列标题，而是以第一行数据结束。这很容易通过使用首行作为标题选项来纠正。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/1903d445318c871bc9b7ff5e97a8e761.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*26-jRvzQ_NGHsJWNY-_PYg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用第一行作为标题</figcaption></figure><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/9b900a0b7374d1f07a4caee423d760da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DR_8mBZjw3Be_yrYljzwcA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用第一行作为标题结果</figcaption></figure><p id="d06c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还记得我们从国家M-Z查询中过滤出国家为<em class="no">的行吗？如果我们以前没有这样做，我们现在会这样做，因为我们只需要将那个<em class="no"> Country </em>值用作列标题，而不是列的值。</em></p><p id="c653" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是删除有字母表字母而没有国家名称的行。由于这些行包含单个字母/字符，而国家名称包含多个字符，因此我们可以编写一个条件，只保留包含多个字符的行。</p><p id="cdb8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，我们对所有操作都使用了GUI，但在这种情况下，我们需要自己编写M代码(您在Country列上方的公式栏中看到的代码)。</p><p id="3aba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开高级编辑器窗口</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/47f0cf97b8a3c8bc3308db29ac9574ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*GNUUiJjxGY7sp3ESW7s0Dw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">打开高级编辑器窗口</figcaption></figure><p id="99fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看看通过与GUI交互生成的M代码。试着通读代码，了解到目前为止的转换是如何转换成m的。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/cc796d466def0270a3087920e24d3f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQZ4zZ61fVFgKPeOCmtURg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">高级编辑器窗口</figcaption></figure><p id="aaf9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您所看到的，每个单独的操作/步骤都被赋予了一个名称，就像在其他编程语言中声明变量一样，而且这些都是按顺序编写的，因为每个步骤都接收前一个步骤的结果作为输入。最后一步在最后返回，即查询的最后一个状态。我们现在的目标是在“Changed Type1”之后添加一个新步骤，以过滤掉只有一个字母的行。</p><p id="de34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第8行末尾添加一个逗号(<code class="fe nz oa ob mz b">,</code>)，并将以下代码粘贴到下一行:</p><pre class="lq lr ls lt gt my mz na nb aw nc bi"><span id="1a77" class="nd lv iq mz b gy ne nf l ng nh">#"Kept Country Names Only" = Table.SelectRows(#"Changed Type1", each Text.Length([Country]) &gt; 1)</span></pre><p id="3861" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe nz oa ob mz b">in</code>后的最后一行代码中，将<code class="fe nz oa ob mz b">#”Changed Type1"</code>改为<code class="fe nz oa ob mz b">#"Kept Country Names Only"</code>，刚刚添加的新步骤。</p><p id="afdd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个新步骤中，我们告诉Power Query根据“Country”列中每行的字符数来选择Countries查询的行。条件是检查文本的长度是否大于1，以保留条件为真的行，即带有国家名称的行。完成后，单击“完成”按钮，您的国家/地区查询应该如下所示:</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/1942c9a76a25627dd8b050897dc30ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FA6_8dkWnbglEUK_LnNV0A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">最终“国家”栏</figcaption></figure><p id="af1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">带有单个字母的行消失了，右侧的查询设置窗格显示了“仅保留国家名称”步骤，在页脚中，您可以看到我们只有1列和197行。现在我们有了一个适当的国家名称列，可以继续下一部分了:格式化图片URL中包含的名称。</p><h1 id="afd0" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">第4部分:格式化国家名称</h1><p id="504e" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">我们已经完成了“Country”列的工作，但是接下来我们需要创建临时列。这些列将保存转换后的国家名称，这些名称将用于创建图像URL。</p><p id="36d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要应用的转换以获得最终格式化的国家名称是:</p><ul class=""><li id="f4d6" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">根据分隔符提取文本；</li><li id="8edb" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">创建条件列；</li><li id="4c48" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">使用条件和查找来更改值；和</li><li id="8549" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">替换字符。</li></ul><p id="2a60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将逐一介绍每个步骤，以理解为什么每个操作都是必要的。当然，你可能会想到其他方法来达到相同的解决方案，所以非常欢迎你回复你自己的发现！</p><p id="7973" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为背景，让我们看看几个国家国旗的图片网址。</p><ul class=""><li id="6523" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">阿富汗:https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">阿富汗</strong>。png</li><li id="1c1a" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">安提瓜和巴布达:https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">安提瓜</strong>。png</li><li id="640c" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">刚果民主共和国:https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">刚果民主共和国</strong>。png</li><li id="b399" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">刚果共和国:https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">刚果</strong>。png</li><li id="1a87" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">科特迪瓦:https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">科特迪瓦</strong>。png</li><li id="c162" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">北马其顿(原马其顿):https://www.countries-ofthe-world.com/flags-normal/flag-of-<strong class="kf ir">北马其顿</strong> .png</li></ul><p id="9a78" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的例子显然是精心挑选的，展示了我们在创建格式化的国家名称和相应的URL时应该遵循的一些模式和规则:</p><ul class=""><li id="b427" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">这些URL中唯一变化的部分是国家名称(在示例中以粗体显示)；</li><li id="0695" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">由多个单词组成的国家名称由连字符(-)分隔；</li><li id="79bb" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">包含逗号或括号的国家名称只保留该标点符号的名称；和</li><li id="9ad4" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">有些国家不遵循这些规则，而是使用“唯一”格式的名称(如刚果民主共和国)。</li></ul><p id="ae8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望在这一点上，您已经对在哪里使用每个数据转换有了一些想法。如果没有，请不要担心，我们将一起浏览它们。</p><p id="93e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">前两步是使用分隔符提取文本，即提取逗号或左括号之前的文本。为了实现这一点，我们可以编写M代码或使用GUI。为了简单起见，我们这次使用GUI。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ab17ff00600ed7c871f5bda307fecb29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*0q6-yT7fQ6N5zdg1QXEhjw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">提取分隔符前的文本</figcaption></figure><p id="f325" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并在下面的对话框中输入单个逗号字符(<code class="fe nz oa ob mz b">,</code>)。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/d0c169a9427ed5b9f3c863017a037a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eD5pvKENGKpss_kKNff5tw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">分隔符选项前的第一个文本</figcaption></figure><p id="3ccc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对新创建的列重复提取分隔符前的文本步骤，但是这次在对话框中输入一个空格和一个左括号(<code class="fe nz oa ob mz b">(</code>)。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/897b50b530bfa11e8e30c874c0064e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mjlnzIDoF0MAcNZsrToWzA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">分隔符选项前的第二个文本</figcaption></figure><p id="c5cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了说明我们到目前为止所取得的成就，您应该在查询中看到类似的结果。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/653a8fdc14f4c66dae49d3d65893c9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*7Kv7rOe_aETqqR07hBLyDA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">国家查询后提取分隔符前的文本操作</figcaption></figure><p id="dc32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">至此，我们已经创建了我们需要的临时列。双击列标题，将“Delimiter.1前的文本”重命名为“临时国家”。在创建URL之前，这将是保存格式化国家的事实上的列。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e09a21ecaa21ba804fb1239060803829.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*pe3zyQfKNwE3SyIh5eRXyQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">重命名“临时国家”</figcaption></figure><p id="2627" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有几个国家没有遵循之前讨论过的格式规则。我们将使用一个临时查找表作为查询步骤，而不是创建多个规则来转换这些规则。这样，我们可以分别查找这些国家的转变情况。</p><p id="017d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要创建此查找表，请在高级编辑器中添加以下代码作为下一步:</p><pre class="lq lr ls lt gt my mz na nb aw nc bi"><span id="558c" class="nd lv iq mz b gy ne nf l ng nh">Mapping = #table({"Name", "Formatted Name"}, {{"Antigua and Barbuda", "Antigua"}, {"Bosnia and Herzegovina", "Bosnia Herzegovina"}, {"Congo, Democratic Republic of the", "Congo Democratic Republic of"}, {"Cote d'Ivoire", "Cote d Ivoire"}, {"Czechia","Czech Republic"}, {"North Korea", "Korea North"}, {"Saint Kitts and Nevis", "St Kitts Nevis"}, {"Saint Lucia", "St Lucia"}, {"Saint Vincent and the Grenadines", "St Vincent the Grenadines"}, {"South Korea", "Korea South"}})</span></pre><p id="9ff4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您随后预览该步骤，它将如下所示。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/139b0cc1c13ce616136eced0c7c46377.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*1uHqYPo-Q_fXE03aXSaPzw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">查找表</figcaption></figure><p id="05b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以告诉Power Query将“名称”列中的国家值更改为“格式化名称”列中的值。在高级编辑器中添加另一个步骤。</p><pre class="lq lr ls lt gt my mz na nb aw nc bi"><span id="89f3" class="nd lv iq mz b gy ne nf l ng nh">#"Fix Special Countries" = Table.ReplaceValue(#"Renamed Columns", each [Temp Countries], each if Mapping{[Name = [Country]]}[Formatted Name] &lt;&gt; null then Mapping{[Name = [Country]]}[Formatted Name] else [Temp Countries], Replacer.ReplaceText,{"Temp Countries"})</span></pre><p id="c1c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意该步骤如何替换来自<code class="fe nz oa ob mz b">#"Renamed Columns"</code>步骤的值，而不是<code class="fe nz oa ob mz b">Mapping</code>步骤的值。第一个选项在我们一直使用的表中执行替换，第二个选项在查找表中执行替换。然而，我们仍然能够在<code class="fe nz oa ob mz b">Mapping</code>表中引用和查找数据。</p><p id="15c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个if/else条件，如果查找表中存在“Temp Countries”中的国家，则用另一个格式化的名称替换该国家，否则保留名称。不要忘记将<code class="fe nz oa ob mz b">in</code>后返回的步骤改为这个新步骤；)</p><p id="42c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在得出最终的国家名称之前，我们需要做的最后两件事是用连字符替换空格。这可以通过GUI轻松完成。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/4e6ecf9128083eea4a5102ae9e1b7d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*s2ymscHeOfeZ4g8PYhyJjw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">替换值</figcaption></figure><p id="9be8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在要查找的值中输入一个空格，并在替换为中输入一个连字符(<code class="fe nz oa ob mz b">-</code>)。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/81b0e41dd836f27b6f3aeb8133a990b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nfUW8dKByvhGX0KqixrTZg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">用连字符替换空格</figcaption></figure><p id="91fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">至此，我们已经完成了“临时国家”和本教程的第4部分。接下来，我们需要在另一列中创建URL，并删除临时列！</p><p id="55bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回顾一下，您查询应该是这样的:</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/d12ccd24928e750152bfe307eb2927f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2yadTtlMFnJtf3R3VahjlQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">第4部分结果</figcaption></figure><h1 id="f953" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">第5部分:创建图像URL</h1><p id="1fce" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">至此，我们已经完成了创建图像URL所需的所有转换。剩下的唯一事情就是实际创建URL。这是通过将URL的公共部分与我们刚刚创建的格式化国家名称连接起来实现的。</p><p id="4da8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建这个新的URL列，我们需要编写M，但是我们可以通过GUI来完成。</p><pre class="lq lr ls lt gt my mz na nb aw nc bi"><span id="8c33" class="nd lv iq mz b gy ne nf l ng nh">"<a class="ae kc" href="https://www.countries-ofthe-world.com/flags-normal/flag-of-" rel="noopener ugc nofollow" target="_blank">https://www.countries-ofthe-world.com/flags-normal/flag-of-</a>" &amp; [Temp Countries] &amp; ".png"</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3d44c88ae9466864f39a21e58071e5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*h-moMT0NjzPAWqVZzF9Udg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">添加自定义列</figcaption></figure><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/8224c6067e63831ea005807af4ab0cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z8sejJ3jqlnGFCpSf1iaMA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建“标志URL”自定义栏</figcaption></figure><p id="f0ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">字符串之间的&amp;符号(<code class="fe nz oa ob mz b">&amp;</code>)是用于连接的运算符。换句话说，对于“Temp Countries”的每一行，Power Query获取该行的值并将其放在URL的中间。您的结果应该是这样的。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/76d5c7815a0c94fa3be16d1bd59fc8ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hOS4KKk4y6ZQJF_jf7oAiQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">“标记URL”栏预览</figcaption></figure><p id="c345" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在将表加载到报表中之前，我们在Power Query中只需要做两件事:更改“Flag URL”的数据类型并删除临时列。</p><p id="ed6c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“标志URL”包含文本数据，因此它应该是文本类型。我们可以通过单击列名旁边的ABC123图标来进行更改。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/badc994c521570a736e970f1d0de5ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*TFc0N1uY34QqSkFrfTsLtw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">更改“标志URL”数据类型</figcaption></figure><p id="7eeb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要删除临时列“分隔符前的文本”和“临时国家”，只需在按住Ctrl键的同时删除这两列。选中它们后，按Delete键，国家查询就完成了。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/75cc64b1236e4956f5db44c2fc5843f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XslQVO3DPZ2rib0b3ZoSw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">国家查询</figcaption></figure><p id="385b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">按下Home选项卡中的Close &amp; Apply按钮，将查询加载到报告中，然后我们可以进入本教程的最后一部分:创建显示旗帜图像的报告视觉效果。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e76700fa931983ab6a6c2fa013482706.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*uGkOKJjILWpswjbm_aq7uQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">关闭并应用</figcaption></figure><h1 id="823a" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">第6部分:在报告中显示标志</h1><p id="3374" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在这一点上是一帆风顺的。我们只需要告诉Power BI“Flag URL”列实际上包含图像URL，并创建两个视觉效果:一个按单个国家过滤的切片器和一个能够加载和呈现图像的多行卡。</p><p id="1371" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要更改“标志URL”的数据类别，请转到数据视图，选择该列，然后从下拉列表中选择正确的类别，如下图所示。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/563120997416af17323b16e590db21e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2PrWWzRo3vUM3zGGbL0ww.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">更改“标志URL”数据类别</figcaption></figure><p id="308d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">视觉上，这并不能改变什么。然而，Power BI将以稍微不同的方式阅读这个专栏，当我们试图加载图像时，它会理解这些确实是URL而不是纯文本。</p><p id="ceb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回到报告视图中，添加一个切片器和一个多行卡片视觉效果。然后，您可以拖放/选择每个视图的列。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/d3cf5d1ef16874c2c0d9d9190aa39613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d421zvtGj1-vLHLZ1dB5uA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">向报告添加视觉效果</figcaption></figure><p id="f8e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将向您展示的最后一件事是更改切片器类型。点击出现在切片器右上角的小箭头，把它变成一个下拉切片器。请注意，当您将鼠标悬停在画面上时，会出现箭头。</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/f7f4a0514184378d3a810b9aeb387980.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*uugz5fu0JA_T_niRfvlBXw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">将切片器类型更改为下拉列表</figcaption></figure><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/61fb418add6338698f84fb0a0a0b8d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*B-x-TOv5V0HCwOku1kgItw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">下拉切片器</figcaption></figure><p id="a9d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">瞧，我们已经到了教程的结尾！现在，您可以随意调整格式，让这两种视觉效果看起来像您想要的那样。</p><h1 id="d4b1" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">结论</h1><p id="eba2" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">作为回顾，本教程经历了以下几点:</p><ul class=""><li id="39c8" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">用Web连接器抓取HTML表格；</li><li id="bfe2" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">追加查询；</li><li id="9382" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">在Power Query中创建新列和筛选行；</li><li id="edf4" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">在Power查询中对文本数据应用各种变换；和</li><li id="d49e" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">使用多行卡片视觉效果在报表中呈现图像。</li></ul><p id="eb33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">换句话说，本教程介绍了使用Web source执行ETL的过程，以创建几个Power BI视觉效果，所有这些都在Power BI中。</p><p id="5bcb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，Power BI的这个抓取特性非常强大，这里展示的只是让您入门的冰山一角。现在疯狂一下，看看你能把Web连接器带多远。</p><p id="159f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想给你指出我的GitHub库的方向。<a class="ae kc" href="https://github.com/Ze1598/medium-articles/tree/master/Scrape%20image%20URLs%20in%20Power%C2%A0BI" rel="noopener ugc nofollow" target="_blank">这个目录</a>有一个. pbix文件，是按照本教程的结果，还有另一个。pbix具有稍微更格式化的视觉效果和更简洁的电源查询步骤。</p><p id="2fc6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，<a class="ae kc" href="https://www.linkedin.com/in/jos%C3%A9-fernando-costa-397137153/" rel="noopener ugc nofollow" target="_blank">在LinkedIn </a>上与我联系，我经常在那里发布关于数据科学的新闻和资源。</p></div></div>    
</body>
</html>