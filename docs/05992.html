<html>
<head>
<title>Postman Serverless Bots: HelloSign &amp; Dropbox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">邮递员无服务器机器人:HelloSign &amp; Dropbox</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/hellosign-dropbox-postman-bot-9605694314b2?source=collection_archive---------12-----------------------#2020-10-16">https://levelup.gitconnected.com/hellosign-dropbox-postman-bot-9605694314b2?source=collection_archive---------12-----------------------#2020-10-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="04c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Postman集合连接两个API并发送Dropbox文件夹成员列表提醒签名文档</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/cb75263a95969521bdc89d2a72c325a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MI8ND6C7cZIaZvTfbJv8Tg.jpeg"/></div></div></figure><p id="47c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不久前，我和Dropbox的Marcel Ribas一起成为了“邮差网”的嘉宾。我们的任务是使用Dropbox和HelloSign APIs实时构建一些东西。所以很明显，我就是我，我们开始创造一个机器人。</p><p id="d2b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Dropbox收购了HelloSign，但他们的产品和API还没有相互集成，所以我们想创造的功能受到了限制。</p><p id="802f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我喜欢从高层次的用户角度来思考，所以在我的脑海中:</p><blockquote class="la lb lc"><p id="4ed0" class="jq jr ld js b jt ju jv jw jx jy jz ka le kc kd ke lf kg kh ki lg kk kl km kn im bi translated">“一位招聘经理想提醒新员工签署存储在Dropbox中的重要文件。他们需要做的只是将新员工添加到共享的Dropbox文件夹中，并添加他们想要签名的文档。该机器人将在每天早上8点发送HelloSign签名请求电子邮件。他们可以签署文件，招聘经理可以从HelloSign下载签署的文件。”</p></blockquote><p id="e8be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然这看起来很简单，但是在这个工作流集合中有一些事情需要考虑:</p><ol class=""><li id="052a" class="lh li it js b jt ju jx jy kb lj kf lk kj ll kn lm ln lo lp bi translated">我们将对文件夹中的每个文件进行递归循环，并对每个文件的每个文件夹成员进行循环。</li><li id="42c3" class="lh li it js b jt lq jx lr kb ls kf lt kj lu kn lm ln lo lp bi translated">我们需要访问一个帐户上的任何文件夹，因此令牌将链接到一个用户，并使用Dropbox的完全帐户访问权限</li><li id="4d48" class="lh li it js b jt lq jx lr kb ls kf lt kj lu kn lm ln lo lp bi translated">HelloSign可以使用Dropbox共享链接，并将可下载标志设置为true</li></ol><p id="bd88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">理解了这一点，这个系列就更容易理解了。</p><p id="0383" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将掩饰Dropbox和HelloSign应用程序的创作。前者是最难的，但是通过阅读Dropbox文档或响应错误，你会知道你需要添加什么权限。您确实需要确保提供对<code class="fe lv lw lx ly b">Full Dropbox Access</code>的访问，并创建一个<code class="fe lv lw lx ly b">non-expire access token</code>来传递给Dropbox请求的授权头。对于HelloSign，生成一个用户令牌是非常容易的，但是您需要在Postman中将它添加为基本身份验证，并将访问令牌作为<code class="fe lv lw lx ly b">user</code>给出，并将<code class="fe lv lw lx ly b">password</code>留空。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lz"><img src="../Images/9754c00f20be910e06dc53378fd70ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CctZujDr65EjNLAWgKUjUQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">HelloSign需要在Auth选项卡中将令牌作为用户名，密码为空</figcaption></figure><p id="0500" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们将获取文件夹内容的文件路径和父文件夹的共享ID。我们将保存将要循环的文件路径数组和共享ID作为环境变量。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi me"><img src="../Images/c9591637f558fa3155f1e31133e527a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVq4flwaw-ktwINTobw_IA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">获取我们将要循环的文件路径和共享文件夹ID作为环境变量</figcaption></figure><p id="df25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这下一个花絮开始进入邮递员工作流的内容，我们将<strong class="js iu">有条件地选择</strong>在当前请求的结果之后运行集合中的哪个邮递员请求！</p><p id="91c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其次，我们要去获取Dropbox共享链接。每当您想要在用户之间共享文件时，就会生成这些链接。Dropbox共享链接可以在UI中生成，所以它们可能存在。我们将检查该文件是否已经有我们可以使用的公共共享链接。</p><p id="2bd7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Postman收集总是按顺序运行，但是通过使用<strong class="js iu"><em class="ld">postman . set next request</em></strong>我们实际上可以改变在当前请求执行之后运行哪个请求。在这种情况下，如果我们有一个链接，那么让我们跳过<strong class="js iu"> <em class="ld">创建共享链接</em> </strong>并使用<strong class="js iu"> <em class="ld">列出文件夹成员</em> </strong>来代替。<strong class="js iu"> OMG！分支请求</strong>！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mf"><img src="../Images/157f3c906184da6a6ed9ba0132c4bdf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qI2qo7-IqmSUTXFFlVM1Q.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">检查是否有链接，然后创建如果有，然后抓取成员，跳过下一个请求</figcaption></figure><p id="45ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">注意我们需要传入带有空格的请求名称。</strong></p><p id="0758" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，在<strong class="js iu"> <em class="ld">列出文件夹成员</em> </strong>中，我们只需收集所有共享文件夹成员。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mg"><img src="../Images/990da56fff2d77240307eb86a5d7aa6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVb7O_T1Hu1KbOVGThPYxQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">获取文件夹成员并弹出第一个用户</figcaption></figure><p id="f292" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在最后弹出一个用户，这样我就可以从第一个用户开始下一个请求，然后在<strong class="js iu">测试选项卡</strong>中弹出下一个循环。这是我的循环索引的开始。</p><p id="b219" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们正在处理一个递归的工作流。我们将检查是否有当前用户，然后在HelloSign的端点<em class="ld">上循环发送签名请求</em>，直到不再有用户。然后检查是否有更多的文件路径，如果有，我们将获取文件路径的下一个共享链接。再次获取所有协作者，然后在<strong class="js iu"> <em class="ld">上循环，再次发送签名请求</em> </strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mh"><img src="../Images/c4f5807647b9c81fbc5ae44367a3ea37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*padqPqlhRDERzquMMEqRYA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">postman.setNextRequest设置为循环处理此请求、返回共享链接或结束收集</figcaption></figure><p id="aaa6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">剩下的就是在Collection Runner中测试它，如果看起来不错，那么我们可以把它扔进监视器:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mi"><img src="../Images/a6867d536f7f75921530d0ad52e53dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iC-j-eJBfIU-q14Gfe_-kQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">在这里，我们为每天早上8点创建提醒</figcaption></figure><p id="2256" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是我们系列的主要分支和循环:</p><blockquote class="la lb lc"><p id="dc4e" class="jq jr ld js b jt ju jv jw jx jy jz ka le kc kd ke lf kg kh ki lg kk kl km kn im bi translated"><strong class="js iu">共享文件链接→ … → </strong></p><p id="3a37" class="jq jr ld js b jt ju jv jw jx jy jz ka le kc kd ke lf kg kh ki lg kk kl km kn im bi translated"><strong class="js iu">获取文件夹成员→发送签名请求</strong></p><p id="7257" class="jq jr ld js b jt ju jv jw jx jy jz ka le kc kd ke lf kg kh ki lg kk kl km kn im bi translated"><strong class="js iu"> →发送签名请求/共享文件链接/结束</strong></p></blockquote><p id="588e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们的新员工可以打开他们的电子邮件来签署文件，我们的招聘经理可以在HelloSign中查看和下载签署的文件。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mj"><img src="../Images/ac6dce02cb0d7db97740c2a661848c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YluVj3mFbNnq3oUFOXuGXQ.png"/></div></div></figure><p id="0e4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">找到了。</p><h1 id="8578" class="mk ml it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">TL；速度三角形定位法(dead reckoning)</h1><ul class=""><li id="9d3c" class="lh li it js b jt ni jx nj kb nk kf nl kj nm kn nn ln lo lp bi translated">Dropbox对HelloSign的最新收购开辟了一个领域，我们可以使用Postman collections在它们之间创建一个集成</li><li id="6c8a" class="lh li it js b jt lq jx lr kb ls kf lt kj lu kn nn ln lo lp bi translated">使用Dropbox，我们可以为一个无服务器机器人创建一个存储项目的地方</li><li id="e5fe" class="lh li it js b jt lq jx lr kb ls kf lt kj lu kn nn ln lo lp bi translated"><strong class="js iu"><em class="ld">postman . setnextrequest()</em></strong>允许我们在单个集合中进行分支或递归调用和循环</li><li id="71a8" class="lh li it js b jt lq jx lr kb ls kf lt kj lu kn nn ln lo lp bi translated">当一个API不存在时，API之间的简单和容易的业务解决方案</li><li id="bd6a" class="lh li it js b jt lq jx lr kb ls kf lt kj lu kn nn ln lo lp bi translated">看看上面的视频，看看它是如何现场完成的</li><li id="2740" class="lh li it js b jt lq jx lr kb ls kf lt kj lu kn nn ln lo lp bi translated">这里有一个集合和环境的链接:<a class="ae no" href="https://documenter.getpostman.com/view/1034536/TVRrUPuJ" rel="noopener ugc nofollow" target="_blank">https://documenter.getpostman.com/view/1034536/TVRrUPuJ</a></li></ul></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="f9aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢你读到的内容，请在<a class="ae no" href="https://twitter.com/bass2neck" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae no" href="https://www.linkedin.com/in/stcalica/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或媒体上关注我:)</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="5028" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想看这个编码的现场观看下面的Twitch或Youtube视频！</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ny nx l"/></div></figure></div></div>    
</body>
</html>