<html>
<head>
<title>Android Button Morphing Animation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android按钮变形动画</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/android-button-morphing-animation-bc3bed740501?source=collection_archive---------11-----------------------#2021-07-14">https://levelup.gitconnected.com/android-button-morphing-animation-bc3bed740501?source=collection_archive---------11-----------------------#2021-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7b1a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如何创建一个按钮变形动画</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/c7fee094c4b0a9684196572f5241f90a.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/1*XafgEFgLsD8X9I2jfvAhEg.gif"/></div></figure><h1 id="0ebd" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">介绍</h1><p id="8e30" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">ProgressDialog已被否决。备用的是什么？</p><p id="795c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ProgressDialog是一个模型对话框，它阻止用户与应用程序进行交互。不要使用这个类，你应该使用一个进度指示器，它可以嵌入到你的应用程序的用户界面中。在这篇文章中，我将向你展示如何制作一个加载动画。</p><p id="ac54" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">动画是向用户展示变化的最佳方式。有些动画就是很神奇。你打开应用程序，触摸屏幕。动画过渡引导您流畅友好地完成流程。你理解下一个动作，甚至对装载栏也感到高兴。</p><h1 id="88bf" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">编码部分</h1><p id="2aed" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">我将编码部分分为7个步骤，如下所示。</p><ul class=""><li id="3ea4" class="lz ma it js b jt ju jx jy kb mb kf mc kj md kn me mf mg mh bi translated"><a class="ae mi" href="#986a" rel="noopener ugc nofollow">创建自定义视图。</a></li><li id="ee39" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><a class="ae mi" href="#32b1" rel="noopener ugc nofollow">检查动画。</a></li><li id="49ff" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><a class="ae mi" href="#e22b" rel="noopener ugc nofollow">将背景颜色和文本颜色从灰色变为绿色。</a></li><li id="b4b4" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><a class="ae mi" href="#39de" rel="noopener ugc nofollow">缩小文本，将圆形矩形变形为圆形。</a></li><li id="6736" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><a class="ae mi" href="#a785" rel="noopener ugc nofollow">放大图标并逆时针旋转。</a></li><li id="a49a" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><a class="ae mi" href="#2d9f" rel="noopener ugc nofollow">调用setUIState()来运行动画。</a></li><li id="b46a" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><a class="ae mi" href="#8131" rel="noopener ugc nofollow">调用runAnimation()来设置动画。</a></li></ul><h1 id="986a" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">步骤1:创建自定义视图</h1><p id="b493" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">您可以通过扩展<code class="fe mo mp mq mr b">View</code>类来创建您的自定义视图，并且<em class="ms">覆盖一些函数</em>以使其具有一个大小并出现在屏幕上:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="82e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请注意以下事项:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/76a1b55372f0ad0c9246c78108223f81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__tocqQuy6PZ2K42dRj7SA.png"/></div></div></figure><ul class=""><li id="a661" class="lz ma it js b jt ju jx jy kb mb kf mc kj md kn me mf mg mh bi translated"><code class="fe mo mp mq mr b">MorphButton</code> <strong class="js iu"> </strong>的大小是图片中灰色矩形的大小，也是用户可以触摸的区域。灰色的矩形会变成绿色的椭圆形，比它还大。要允许子视图超过其界限，请在父视图上使用<code class="fe mo mp mq mr b">setClipChildren</code> <strong class="js iu"> </strong>。</li><li id="4e47" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated">要绘制图标，必须先设置绑定。将该代码放入<code class="fe mo mp mq mr b">onSizeChanged</code> <strong class="js iu"> </strong>方法中。将<em class="ms">放在那里会比<code class="fe mo mp mq mr b">onMeasure</code>或<code class="fe mo mp mq mr b">onLayout</code> <strong class="js iu">更优化。</strong> <code class="fe mo mp mq mr b">onSizeChanged</code>仅在该视图尺寸改变时触发。另一方面，当您使用<code class="fe mo mp mq mr b">requestLayout()</code>方法时，<code class="fe mo mp mq mr b">onMeasure</code>或<code class="fe mo mp mq mr b">onLayout</code>会被更频繁地调用。</em></li></ul><h1 id="32b1" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">步骤2:检查动画</h1><p id="7289" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">让我们放慢动画速度，看看如何让困难的事情变得简单:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi na"><img src="../Images/6bdd325c8537f8b76f655b94698d5ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/1*7D870y2uoM7qEBj0VCrwTQ.gif"/></div></figure><p id="4c46" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">动画分为3个部分:</p><ol class=""><li id="8aac" class="lz ma it js b jt ju jx jy kb mb kf mc kj md kn nb mf mg mh bi translated">将背景颜色和文本颜色从灰色变为绿色。</li><li id="13c7" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn nb mf mg mh bi translated">缩小文本并将圆形矩形变形为圆形。</li><li id="d1d7" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn nb mf mg mh bi translated">放大图标并逆时针旋转<strong class="js iu">。</strong></li></ol><p id="19c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">复杂的动画现在变成了3个小的连续步骤。</p><h1 id="e22b" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">步骤3:将背景颜色和文本颜色从灰色变为绿色。</h1><p id="7980" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">创建一个<code class="fe mo mp mq mr b">ValueAnimator</code>来获得背景颜色和文本颜色的分数。按照惯例，在这个例子中，我们对所有的动画师使用0f和1f的值:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="a586" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过<code class="fe mo mp mq mr b"><a class="ae mi" href="https://developer.android.com/reference/android/animation/ArgbEvaluator" rel="noopener ugc nofollow" target="_blank">ArgbEvaluator</a></code>获取取决于分数的颜色，并保存到<code class="fe mo mp mq mr b">paint</code>:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="33e0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe mo mp mq mr b">onDraw</code>方法中，使用<code class="fe mo mp mq mr b">paint</code>绘制背景色，填充包含视图的最大尺寸:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="6baf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样在<code class="fe mo mp mq mr b">onDraw</code>方法中，在画布中央绘制文本:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="39de" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">步骤4:缩小文本，将圆角矩形变形为圆形</h1><p id="e3e9" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">创建第二个<code class="fe mo mp mq mr b">ValueAnimator</code>来获得缩放文本和变形形状的分数:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="91c4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后在<code class="fe mo mp mq mr b">onDraw</code>方法中，使用<code class="fe mo mp mq mr b">scaleTextFraction</code>借助<code class="fe mo mp mq mr b"><a class="ae mi" href="https://developer.android.com/reference/com/google/android/material/math/MathUtils#lerp(float,%20float,%20float)" rel="noopener ugc nofollow" target="_blank">lerp()</a></code>方法以特定比例绘制文本:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5162" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后使用<code class="fe mo mp mq mr b">morphFraction</code>绘制背景:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9bb5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面的图片将使描述上面的代码更加清晰:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nc"><img src="../Images/643fb4abe7637166e4da880c629b6e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FjKoa6qQAa5-FnIVJm8jlw.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">开始和停止标签表示传入<code class="fe mo mp mq mr b">lerp()</code>方法的值</figcaption></figure><h1 id="a785" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">步骤5:放大图标并逆时针旋转</h1><p id="ce6f" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">创建第三个<code class="fe mo mp mq mr b">ValueAnimator</code>来获取缩放图标的分数:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="207f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe mo mp mq mr b">onDraw</code>方法中，使用<code class="fe mo mp mq mr b">scaleIconFraction</code>借助<code class="fe mo mp mq mr b"><a class="ae mi" href="https://developer.android.com/reference/com/google/android/material/math/MathUtils#lerp(float,%20float,%20float)" rel="noopener ugc nofollow" target="_blank">lerp()</a></code>方法以特定比例绘制图标并旋转。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="2d9f" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">步骤6:调用setUIState()来运行动画</h1><p id="c664" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">此视图中有3种状态:</p><ul class=""><li id="0f82" class="lz ma it js b jt ju jx jy kb mb kf mc kj md kn me mf mg mh bi translated"><code class="fe mo mp mq mr b">Button</code>:指示按钮。</li><li id="f909" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><code class="fe mo mp mq mr b">Loading</code>:指示装载旋转器。</li><li id="30d2" class="lz ma it js b jt mj jx mk kb ml kf mm kj mn kn me mf mg mh bi translated"><code class="fe mo mp mq mr b">Animating</code>:表示动画正在运行，以从按钮变形到加载微调器。这是用来防止快速点击。</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1831" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在转到第7步，检查<code class="fe mo mp mq mr b">runAnimation()</code>方法</p><h1 id="8131" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">第七步:打电话给<code class="fe mo mp mq mr b">runAnimation() to set up the animation</code></h1><p id="464d" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">这个方法只是把上面的3个动画包在一个<code class="fe mo mp mq mr b">AnimatorSet</code>中，每个动画将在250毫秒的时间内连续运行。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="8aeb" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">这是一个总结</h1><p id="ad3a" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">以下是描述MorphButton的完整代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="0948" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您在执行代码片段时发现问题，请查看GitHub repo以获取帮助:</p><div class="nh ni gp gr nj nk"><a href="https://github.com/PhongHuynh93/Morph-Button" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">phonghuynh 93/变形按钮</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">在GitHub上创建一个帐户，为PhongHuynh93/Morph-Button开发做贡献。</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">github.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ku nk"/></div></div></a></div></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="5237" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如你所看到的，创建一个复杂的动画并不难。您应该将它分成更小的步骤，以便于实现和维护。非常感谢你阅读我的文章。<em class="ms">如果你喜欢这个故事，请</em> <strong class="js iu"> <em class="ms">点击</em> </strong>👏<strong class="js iu"> <em class="ms">按钮和</em> </strong> <em class="ms">分享它来帮助别人！</em>关注我<a class="ae mi" href="https://mr-umbrella.medium.com/" rel="noopener">中</a>T18】获取更多牛逼安卓小技巧。你也可以在LinkedIn 上找到我。祝您愉快！😄</p><h1 id="54a3" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">继续读Android的东西</h1><p id="cbe0" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated"><a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/shared-element-using-materialcontainertransform-in-android-6d420e74b122">Android中使用MaterialContainerTransform的共享元素</a></p><p id="3ca4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/how-to-create-like-button-animation-in-android-part-1-f99e2792143d">如何在Android中创建like按钮动画</a></p><p id="0144" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/motionlayout-collapsing-toolbar-d0ce8dd874b6">运动布局——折叠工具栏</a></p><h1 id="d7dc" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">Jetpack撰写</h1><p id="9911" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated"><a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/implement-android-snackbar-in-jetpack-compose-d83df5ff5b47">在Jetpack Compose中实现snack bar</a></p><p id="94ff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/implement-android-tablayout-in-jetpack-compose-e61c113add79">在Jetpack Compose中实现tab layout</a></p><p id="ae01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/implement-tablayout-with-viewpager-in-android-jetpack-compose-d509fc6e2d8e">在Jetpack Compose中用ViewPager实现talayout</a></p><p id="fe57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mi" rel="noopener ugc nofollow" target="_blank" href="/create-an-auto-scroll-viewpager-with-transformation-and-ken-burns-effect-in-android-jetpack-compose-efdf46f2e8ed">在Jetpack Compose中创建一个带有变形和ken burns效果的自动滚动浏览器</a></p></div></div>    
</body>
</html>