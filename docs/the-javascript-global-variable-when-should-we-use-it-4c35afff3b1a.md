# JavaScript 全局对象变量——我们应该什么时候使用它？

> 原文：<https://levelup.gitconnected.com/the-javascript-global-variable-when-should-we-use-it-4c35afff3b1a>

![](img/9f2b26f5484969fb10cfb98b9dd23460.png)

照片由[凯尔·格伦](https://unsplash.com/@kylejglenn?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

在 JavaScript 中，有一个取决于环境的全局变量。在浏览器中，有一个`window`对象。worker 上下文将`self`对象作为全局对象。Node.js 拥有`global`对象。

在本文中，我们将看看全局对象，它做什么，以及如何和何时使用它。

# 全局对象的范围

全局对象总是在最顶层的范围内。上面没别的了。因此，任何东西都可以访问它。考虑名字，这个有道理。

在 JavaScript 中，作用域在运行时不会改变，所以我们可以从它们在代码中的位置得到它们的作用域。

因为全局对象在最顶层的作用域中，所以它可以被任何东西访问。例如，我们可以从任何地方`console.log`这个`window`对象，我们可以得到它的值。

# 全局对象

全局对象是其属性是全局变量的对象。它在浏览器中被称为`window`对象，在 web workers 中被称为`self`，在 Node.js 中被称为`global`

还有一个提议是拥有一个在所有上下文中都可用的`globalThis`全局对象。

全局对象包含所有内置的全局变量。

# 创建全局变量

我们可以通过创建全局对象的属性来创建全局变量。在浏览器上下文中，这意味着我们将其创建为`window`对象的属性。

有几种方法可以做到这一点。一种方法是定义为`window`对象的属性，如下所示:

```
window.foo = 1;
```

然后我们可以在代码中的任何地方引用`foo`或`window.foo`。

另一种方法是在我们代码的顶层使用`var`关键字。也就是说，它没有嵌套在任何块中。我们可以这样定义它:

```
var foo = 1;
```

# 获取或设置变量

我们可以获取和设置全局变量，就像我们声明它一样。例如，如果我们声明:

```
window.foo = 1;
```

然后我们可以引用`window.foo`并给它们赋值。如果在顶层用`var`声明，如下所示:

```
var foo = 1;
```

那么我们可以写:

```
foo = 1;
```

或者:

```
window.foo = 1;
```

# 组件

每个模块都有自己的环境，除非明确导出某些内容，否则不会暴露给外界。然而，我们仍然可以像在任何其他环境中一样从那里访问全局变量。

![](img/8f6f7a4599c7b8f3cdc38d2878462d3d.png)

马库斯·斯皮斯克在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 警告

全局对象被认为是一个错误。很容易创建与其他变量名称冲突的全局变量。

此外，我们可以很容易地改变现有的内置全局变量或我们定义的变量。通过使用像`let`和`const`这样的新构造来声明变量和常量，并使用模块来保护私有数据和命名空间，这样我们就不会意外地修改任何东西，从而避免了这个问题。

它只是为了让浏览器上的简单脚本变得简单。既然我们正在用 JavaScript 构建成熟的应用程序，那么过多地使用全局对象将会像我们之前描述的那样产生很多问题。

然而，浏览器环境中的全局对象有很多属性，我们可以用它们来为我们的应用程序添加特性，比如用于加密的`window.SubtleCrypto`、用于声明 Web 组件的`customElements`变量以及更多的属性。`location`也是`window`对象的属性。

同样，Node.js' `global`对象也有类似`__dirname`和`__filename`的属性，这对于访问我们当前代码的数据很方便。`console`对象对于调试很有用，而`Process`对于获取当前运行进程的数据很有用。

`setTimeout`、`setInterval`也是 Node.js `global`对象的一部分。

完整的属性列表在 Mozilla 开发者网络上。

在 JavaScript 有模块之前，它也用于从外部脚本访问变量。但是现在我们有了模块，我们肯定不需要为此使用全局对象。

此外，测试要困难得多，因为全局变量会被任何东西改变。所以，很难解释他们到底怎么了。

# 结论

现在，我们只是使用像`window`对象这样的全局变量，主要是因为它们的内置属性。

在我们自己的代码中，我们使用由全局对象提供的东西，但是没有任何好的用例可以向全局对象添加任何属性。追踪问题既麻烦又困难，因为所有东西都会修改全局变量，因为所有东西都可以访问它。

更好的方法是将所有东西模块化，然后通过导出来公开我们需要的东西。

然而，`window`对象确实有很多我们可以使用的有用属性。Node.js' `global`对象也是如此。