<html>
<head>
<title>How fast is PHP-8 going to be?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PHP-8会有多快？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-fast-is-php-8-going-to-be-f7fdc111cd6?source=collection_archive---------0-----------------------#2020-02-09">https://levelup.gitconnected.com/how-fast-is-php-8-going-to-be-f7fdc111cd6?source=collection_archive---------0-----------------------#2020-02-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8aa9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">PHP-8将于今年年底发布，它最令人兴奋的特性之一就是JIT编译。让我们看看它如何提高PHP脚本的速度。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/47e838bdb87d6a77c0a698ca6b64d227.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*heRVdA5U2kRRAqHt"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Marc-Olivier Jodoin 在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="e8c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今年年底，PHP-8将成为现实。虽然这个主要版本带来了许多新特性，如联合类型、静态返回和弱映射，但最令人期待的改进是JIT编译器。</p><p id="649d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">理论上，由于JIT处理PHP脚本编译的方式，它将提高应用程序的速度(我过于简化了)。但是让我们看看这种方法是否符合我们的期望</p><blockquote class="lf lg lh"><p id="2588" class="jq jr li js b jt ju jv jw jx jy jz ka lj kc kd ke lk kg kh ki ll kk kl km kn im bi translated">注意，我将要使用的PHP-8版本不是最终版本。</p></blockquote><p id="4501" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们来定义要运行的代码。我选择冒泡排序是因为它是最差的排序方法，我只能在这样的练习中使用它。</p><p id="60b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://gist.github.com/PedroEscudero/b64ea7409c0cc483c44f0773b6aebbdb" rel="noopener ugc nofollow" target="_blank">中的源代码https://gist . github . com/PedroEscudero/b 64 ea 7409 c 0 cc 483 c 44 f 0773 b 6 aebbdb</a></p><p id="d56c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我意识到中间那个讨厌的数组并不好看。我知道我可以生成一个随机数组。我也知道我可以从文件中读取它。然而，我只是想要一个与其他考虑无关的缓慢的泡沫。我不希望在这个基准测试中有任何额外的噪声。</p><div class="lm ln gp gr lo lp"><a rel="noopener  ugc nofollow" target="_blank" href="/php-8-first-release-candidate-performance-a4bb02dff6f4"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd iu gy z fp lu fr fs lv fu fw is bi translated">PHP 8首次发布候选性能</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">让我们继续关注PHP 8第一个候选版本的速度</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md ky lp"/></div></div></a></div><p id="4617" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，让我们在the 7.4的当前版本中运行脚本it</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="8e6d" class="mj mk it mf b gy ml mm l mn mo">docker container run --rm -v $(pwd):/script/ php:7.4 php /script/bubble.php</span></pre><p id="65a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行100次后，我的平均时间是0.10253500938416秒。还不错。</p><p id="8793" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们用PHP-8 <strong class="js iu">而不用JIT </strong> <strong class="js iu">激活</strong>。</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="18aa" class="mj mk it mf b gy ml mm l mn mo">docker container run --rm -v $(pwd):/script/ martinpham/php8:fpm-extra-alpine php /script/bubble.php</span></pre><p id="cfbe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，在100次跑步后，我的平均时间是0.098223924636841秒。老实说，改进并不十分显著。</p><p id="8697" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但我们是来测试明星特性的，闪亮而神奇的JIT:</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="1e6e" class="mj mk it mf b gy ml mm l mn mo">docker container run --rm -v $(pwd):/script/ keinos/php8-jit php /script/bubble.php</span></pre><p id="c3c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">平均时间为0.053637981414795秒！的确JIT它是闪亮和惊人的！对于像我一样需要担心执行时间的人来说，这是一个巨大的祝福。虽然这个数字看起来不太相关(只有0.04458594322秒的改善)，但如果我们用百分比来看，我们可以更好地理解好处:45.39%。</p><p id="8c01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想要更多的视角，所以我用2009年史前时期的PHP-5.3版本运行它。</p><pre class="kp kq kr ks gt me mf mg mh aw mi bi"><span id="9ee8" class="mj mk it mf b gy ml mm l mn mo">docker container run --rm -v $(pwd):/script/ php:5.3 php /script/bubble.php</span></pre><p id="f132" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用了0.64574003219604秒。比使用PHP-8和JIT激活时慢0.5921020508(-差1103.88%！).天哪，2009年我们是怎么做到的？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mp"><img src="../Images/5cc935ffdae8758834d2ef7193069e48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sO5csMmfrh0hF5y4FqTgwQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">脚本运行100次的平均性能比较</figcaption></figure><h2 id="8a12" class="mj mk it bd mq mr ms dn mt mu mv dp mw kb mx my mz kf na nb nc kj nd ne nf ng bi translated">注释和注意事项</h2><ul class=""><li id="56ef" class="nh ni it js b jt nj jx nk kb nl kf nm kj nn kn no np nq nr bi translated">我选择了一个纯心血来潮的带有气泡排序的脚本。你可以尝试其他选项，比如推销员问题或二叉树。结果应该遵循相同的模式。</li><li id="bce6" class="nh ni it js b jt ns jx nt kb nu kf nv kj nw kn no np nq nr bi translated">正如我提到的，在这个基准测试中运行的PHP-8版本不是最终版本，所以在最后一个版本发布之前可以添加额外的改进。</li><li id="576b" class="nh ni it js b jt ns jx nt kb nu kf nv kj nw kn no np nq nr bi translated">我决定保留有很多小数的浮点数，即使它并不漂亮。我想尽可能精确。</li><li id="8b90" class="nh ni it js b jt ns jx nt kb nu kf nv kj nw kn no np nq nr bi translated">我使用了<a class="ae le" href="https://hub.docker.com/r/keinos/php8-jit" rel="noopener ugc nofollow" target="_blank"> keinos </a>和<a class="ae le" href="https://hub.docker.com/r/martinpham/php8" rel="noopener ugc nofollow" target="_blank"> martinpham </a> docker图像作为基准。<a class="ae le" href="https://hub.docker.com/search?q=php8&amp;type=image&amp;sort=updated_at&amp;order=desc" rel="noopener ugc nofollow" target="_blank">但是还有其他的</a>。如果你喜欢玩一会儿，你可以试试。</li><li id="3cd3" class="nh ni it js b jt ns jx nt kb nu kf nv kj nw kn no np nq nr bi translated">我是在一台装有Linux Manjaro的笔记本电脑上进行这些测试的，这台笔记本电脑配有3 GHz英特尔酷睿i5处理器和32 GB内存。对于其他配置，这些数字可能会有所不同，但我确信改进是相似的。</li></ul><p id="6871" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你对近几年来PHP、Python和Ruby的性能如何提高感兴趣，你可以看看这篇文章:</p><div class="lm ln gp gr lo lp"><a rel="noopener  ugc nofollow" target="_blank" href="/how-has-the-performance-of-php-python-and-ruby-improved-in-recent-years-1768fd5b6df9"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd iu gy z fp lu fr fs lv fu fw is bi translated">PHP、Python和Ruby的性能近年来有了怎样的提升？</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">让我们回顾一下3种主要编程语言的性能改进，以便更好地理解…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ly l"><div class="nx l ma mb mc ly md ky lp"/></div></div></a></div></div></div>    
</body>
</html>