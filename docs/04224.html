<html>
<head>
<title>SMS Spam Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">垃圾短信检测</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/sms-spam-detection-dbb494c3a5ac?source=collection_archive---------18-----------------------#2020-06-15">https://levelup.gitconnected.com/sms-spam-detection-dbb494c3a5ac?source=collection_archive---------18-----------------------#2020-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6c6ae5eff987967872af7a54622e8712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CS-OYdiRLCBMBiOpEURy0g.png"/></div></div></figure><h1 id="7851" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">肯定</h1><p id="9f8e" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">几乎每天都有数千甚至数百万条信息和电子邮件被发送出去。其中有多少是垃圾邮件？有没有办法在第一眼就把它们分类？我们在垃圾短信中最常看到的词是什么？我们可以建立一个分类器来很好地分类一个消息是不是垃圾邮件吗？</p><h1 id="33ce" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">介绍</h1><p id="4598" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我们处理了<a class="ae lx" href="http://www.dt.fee.unicamp.br/~tiago/smsspamcollection/" rel="noopener ugc nofollow" target="_blank">垃圾短信收集</a>数据集。它由5574条消息组成，其中只有747条是垃圾消息。这意味着这个数据集是不平衡的，我们的最终模型可能有一些偏差。</p><h1 id="5e9c" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">探索性数据分析</h1><p id="2ada" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">数据集只有两列，“标签”和“文本”。通过创建名为“text_length”的新列，我们可以使用它来可视化两个类别的分布:“ham”和“spam”。</p><blockquote class="ly lz ma"><p id="0a14" class="kz la mb lb b lc mc le lf lg md li lj me mf lm ln mg mh lq lr mi mj lu lv lw im bi translated">“ham”子集的最大长度为910个字符。下面我们引用了有和没有这个值的两个分布图。</p></blockquote><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mk"><img src="../Images/fcc00de909265cf7722b300ecbdf82c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKTrlx-7DM4RQGG5Gvgi7w.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">有了极值</figcaption></figure><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/5ce6221a9dcb4b3d83ff9ef956bda2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nBTQ67PyoKVDa3JGNMW0tA.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">如果没有极值</figcaption></figure><p id="c4b8" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated">分布和统计分析的见解:</p><ul class=""><li id="4b93" class="mu mv it lb b lc mc lg md lk mw lo mx ls my lw mz na nb nc bi translated">垃圾消息的分布具有较小的标准偏差，并且其平均值远高于垃圾消息的平均值，</li><li id="b3f6" class="mu mv it lb b lc nd lg ne lk nf lo ng ls nh lw mz na nb nc bi translated">几乎50%的垃圾消息具有从133到157的长度，另一方面，75%的垃圾消息具有小于或等于93的长度</li></ul><p id="7ecc" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated">这些见解可以帮助我们回答第一个问题。我们可以说，有一种隐藏模式可以根据消息的长度将其分类为垃圾邮件或垃圾邮件。我们不能100%肯定，但有很大的机会将其归类为垃圾邮件，是正确的。</p><h1 id="da69" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">自然语言过程</h1><p id="2458" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">使用NLP，我们要做的第一件事就是查看每个消息类别中最常见和最重要的单词。下面我们提到了我们用于NLP的工具。</p><p id="b263" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated">我们还创建了一个新的助手函数来标记每个文本。使用正则表达式，我们清除每个消息中最不重要的信息。</p><h2 id="90ce" class="ni kc it bd kd nj nk dn kh nl nm dp kl lk nn no kp lo np nq kt ls nr ns kx nt bi translated">词汇袋模型</h2><p id="b833" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">机器学习模型需要以结构化的形式摄取数据，即矩阵，其中行代表观察值，列是特征/属性。当处理文本数据时，我们需要一种方法来将这种非结构化数据转换为机器学习模型可以处理的形式。将文本数据转换成矩阵的一种技术是计算每个单词在每个文档中出现的次数。这种技术被称为<strong class="lb iu">词汇袋模型</strong>。这个模型之所以得名，是因为每个文档都被看作是一个包含所有单词的袋子，不考虑词序、上下文和语法。在将单词袋模型应用于语料库之后，得到的矩阵将展示机器学习模型可以利用的模式。</p><h2 id="f9b5" class="ni kc it bd kd nj nk dn kh nl nm dp kl lk nn no kp lo np nq kt ls nr ns kx nt bi translated">计数向量转换器</h2><p id="eb62" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">单词袋模型可以在scikit-learn中用<em class="mb">计数矢量器</em>转换器找到。注意，scikit-learn使用单词<strong class="lb iu">矢量器</strong>来指代将数据结构(如字典)转换为NumPy数组的转换器。既然是transformer，我们需要先拟合对象，然后调用transform。</p><h2 id="4097" class="ni kc it bd kd nj nk dn kh nl nm dp kl lk nn no kp lo np nq kt ls nr ns kx nt bi translated">词干化和词汇化</h2><p id="8d24" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="lb iu">词干化</strong>是将一个单词缩减为其词干的过程。注意，词干化过程并不是100%有效的，有时产生的词干并不是一个真正的单词。例如，应用于“arguments”和“arguments”的流行波特词干算法返回<code class="fe nu nv nw nx b">"argu"</code>。</p><p id="493a" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated"><strong class="lb iu">词条化</strong>是将一个单词简化为其词条，或者该单词的字典形式的过程。这是一个比词干提取更复杂的过程，因为它考虑了上下文和词性。此外，得到的引理是一个实际的单词。</p><h2 id="16a3" class="ni kc it bd kd nj nk dn kh nl nm dp kl lk nn no kp lo np nq kt ls nr ns kx nt bi translated">术语频率-逆文档频率</h2><p id="c8d2" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><code class="fe nu nv nw nx b">CountVectorizer</code>创建原始计数的特征矩阵。使用原始计数有两个问题，文档的长度变化很大，对于常见的单词，如“the”和“is ”,计数会很大。我们需要使用考虑上述属性的加权方案。术语频率-逆文档频率，简称为<strong class="lb iu"> tf-idf </strong>是一种流行的加权方案，用于改进单词袋模型中简单的基于计数的数据。它是两个值的乘积，术语频率和逆文档频率。有几个变种，但最流行的定义如下。</p><p id="6bff" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated">以下是每个类别中最重要的单词。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/3d673f53e427105264ed1c412e527658.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*pLTBDV5wu01ZqQOSSfgnAw.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">火腿信息最重要的词</figcaption></figure><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f8e389444912c58e65f5c8bdfb1a86a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*tpvEii2iLb3wkQN8E3aRYQ.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">垃圾邮件最重要的词</figcaption></figure><h1 id="4abe" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">构建我们的分类器</h1><p id="bf30" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">对于这一部分，我们使用两种不同的模型，并比较它们的结果。第一个是<code class="fe nu nv nw nx b">RandomForestClassifier</code>，第二个是<code class="fe nu nv nw nx b">SGDClassifier</code>。</p><p id="2c93" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated">为了调整每个分类器的超参数，我们创建了管道来描述工程和<code class="fe nu nv nw nx b">GridSearchCv</code>。我们的模型似乎在预测方面做得很好，只要两者的准确度都高于0.97。</p><h1 id="c10d" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h1><p id="e781" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">即使我们的模型足够好，我们也必须记住，我们的数据集是不平衡的，这会影响我们的预测。改进我们模型的一个方法是找到更多的信息，并创建一个更平衡的数据集。</p><p id="d620" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated">我们还可以在正则表达式中使用不同的模式来清除每条消息的文本。</p><p id="043b" class="pw-post-body-paragraph kz la it lb b lc mc le lf lg md li lj lk mf lm ln lo mh lq lr ls mj lu lv lw im bi translated">你可以在Github 中看到这个项目的完整代码。</p></div></div>    
</body>
</html>