<html>
<head>
<title>Example vs. Reality. How can I train a Quantum Machine Learning model using data from a CSV?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">例子与现实。如何使用CSV中的数据训练量子机器学习模型？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/example-vs-reality-how-can-i-start-a-quantum-machine-learning-model-from-a-csv-389f98d3ad36?source=collection_archive---------12-----------------------#2022-03-18">https://levelup.gitconnected.com/example-vs-reality-how-can-i-start-a-quantum-machine-learning-model-from-a-csv-389f98d3ad36?source=collection_archive---------12-----------------------#2022-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/344f43b80486142f2258b53e5454f167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ks441ivkmE0X48QNmqZpLQ.jpeg"/></div></figure><p id="68dd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果你已经决定从Qiskit开始，并一头扎进量子领域的机器学习应用的探索中，你可能很快就会碰壁。你可能浏览了所有的Qiskit教科书示例、GitHub中的一些存储库以及其他一些来源，如Kaggle、YouTube教程或量子计算堆栈交换，试图对你的数据做些什么。</p><p id="e33a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在分析了QSVM、VQC和/或QSVC的一些初步演示后，你会发现几乎所有的都使用了特定的“演示”阵列、内置数据帧或专门准备的虚拟“量子就绪”变量。一个典型的例子是“葡萄酒”数据集。在代码中，您会看到类似这样的内容:</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="ec44" class="lb lc iq kx b gy ld le l lf lg"><strong class="kx ir">from</strong> qiskit.ml.datasets <strong class="kx ir">import</strong> wine</span></pre><p id="eb20" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">虽然这对于初始测试和熟悉代码很有用，但它缺少所有数据编码、准备(EDA)、降维以及其他几个必要步骤，以便能够在量子电路中使用真实数据。</p><p id="87ea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">另一个挑战是使用更多的维度和数据点。几乎所有官方和非官方的Qiskit公共代码都使用最小数量的维度和样本进行训练和测试。例如:</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="97a2" class="lb lc iq kx b gy ld le l lf lg">n <strong class="kx ir">=</strong> 2  <em class="lh"># dimension of each data point</em><br/>sample_Total, training_input, test_input, class_labels <strong class="kx ir">=</strong> wine(training_size<strong class="kx ir">=</strong>24,                                                         test_size<strong class="kx ir">=</strong>6, n<strong class="kx ir">=</strong>n, plot_data<strong class="kx ir">=True</strong>)</span></pre><p id="2c1a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里的问题是，我们在没有任何深入的“数据工作”的情况下，使用一种非常简单的方法，使用已经准备好作为“好例子”的数据框架，快速地进入特征图、后端、实例和模型定义。然后，过一会儿，当你看到这样的结果时，你会说“找到了”:</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="2b09" class="lb lc iq kx b gy ld le l lf lg">testing_accuracy : 1.0<br/>test_success_ratio : 1.0<br/>predicted_labels : [0 1 2 2 2 2]<br/>predicted_classes : ['A', 'B', 'C', 'C', 'C', 'C']</span></pre><p id="0514" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我很抱歉地通知你，这不是真实世界的结果，但你可能已经知道了。那么我们能做些什么来继续探索但现在使用数据呢？以下是一些步骤和建议:</p><p id="359d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以使用与金融、零售、医疗保健或任何对您有意义的主题相关的Kaggle数据集。</p><figure class="ks kt ku kv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi li"><img src="../Images/d01680c18c3b4b5d8ca8a868702aea39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RiRy8jkQ6dmKPdTNhTrl2Q.jpeg"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">要探索的公共数据集</figcaption></figure><p id="543b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们假设您有一个带有基本EDA、编码和整数目标变量的数据帧。在这种情况下，您可以进行两个简单但重要的步骤:标准化(StandardScaler)，去除平均值并缩放到单位方差，以及降维(PCA)。</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="79b4" class="lb lc iq kx b gy ld le l lf lg">scaler = StandardScaler()<br/>scaler.fit(df)<br/>df_scaler = scaler.transform(df)</span><span id="1925" class="lb lc iq kx b gy lr le l lf lg">n_dim = 3<br/>pca = PCA(n_dim)<br/>pca.fit(df)<br/>df_pca = pca.transform(df_scaler)</span></pre><p id="481e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">PCA中使用的维数必须等于你以后要用来运行量子模型的量子位。</p><p id="1d9d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，您可以拆分数据集，为quantum或混合quantum模型创建训练和测试输入，并为算法、特征映射、后端和其他几个需要选择的变量设置您的配置。在这个例子中，你可以看到一个VQC(变分量子分类器):</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="8a82" class="lb lc iq kx b gy ld le l lf lg">feature_map = ZZFeatureMap(feature_dimension=feature_dim, reps=2)</span><span id="7fbd" class="lb lc iq kx b gy lr le l lf lg">optimizer = SPSA(maxiter=40, c0=4.0, skip_calibration=True)</span><span id="76f7" class="lb lc iq kx b gy lr le l lf lg">var_form = TwoLocal(feature_dim, ['ry', 'rz'], 'cz', reps=3)</span><span id="624e" class="lb lc iq kx b gy lr le l lf lg">vqc = VQC(optimizer, feature_map, var_form, training_input, test_input, datapoints[0])</span><span id="85f7" class="lb lc iq kx b gy lr le l lf lg">backend = BasicAer.get_backend('qasm_simulator')</span><span id="76f3" class="lb lc iq kx b gy lr le l lf lg">quantum_instance = QuantumInstance(backend, shots=1024, seed_simulator=seed, seed_transpiler=seed)</span><span id="f082" class="lb lc iq kx b gy lr le l lf lg">result = vqc.run(quantum_instance)</span></pre><p id="46dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">关于您将获得的结果，以及使用更多量子位/维度生成这些结果所需的时间，以及使用模拟器和真实量子机器的更多数量的数据点，还有很多问题需要讨论。此外，你将需要经历许多不同的设置和执行几个测试，直到你可以证明一些优势。为此，您有两种选择。</p><ol class=""><li id="8e7b" class="ls lt iq jw b jx jy kb kc kf lu kj lv kn lw kr lx ly lz ma bi translated">只要跳进Jupyter笔记本，开始您的探索。</li><li id="c746" class="ls lt iq jw b jx mb kb mc kf md kj me kn mf kr lx ly lz ma bi translated">尝试与Qiskit社区和他们的倡导者建立更深入的联系，以增加您的知识并找到一些答案。</li><li id="2b69" class="ls lt iq jw b jx mb kb mc kf md kj me kn mf kr lx ly lz ma bi translated">联系一些QML的专家来指导你完成这个过程，或者向像Quanvia这样的公司寻求培训或咨询。</li></ol><p id="0e6a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果你想阅读更多类似的建议和内容，你可以在Linkedin上关注我<a class="ae mg" href="https://www.linkedin.com/in/mancillamontero/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="c88e" class="mo lc iq bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">分级编码</h1><p id="9fef" class="pw-post-body-paragraph ju jv iq jw b jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn np kp kq kr ij bi translated">感谢您成为我们社区的一员！更多内容请参见<a class="ae mg" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>。<br/>跟随:<a class="ae mg" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae mg" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>，<a class="ae mg" href="https://newsletter.levelup.dev/" rel="noopener ugc nofollow" target="_blank">时事通讯</a> <br/> <strong class="jw ir">升一级就是转型科技招聘</strong>👉<a class="ae mg" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">加入我们的人才集体</strong> </a></p></div></div>    
</body>
</html>