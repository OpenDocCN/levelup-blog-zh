<html>
<head>
<title>Make a Rust API that Insults Me</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">做一个侮辱我的Rust API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/make-a-rust-api-that-insults-me-3cac9db8c2bd?source=collection_archive---------10-----------------------#2020-07-05">https://levelup.gitconnected.com/make-a-rust-api-that-insults-me-3cac9db8c2bd?source=collection_archive---------10-----------------------#2020-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="15be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">开发日志</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4e90bb6bcdfda770ff44623336814701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P3lJfPiDYQu89zG40ymBHA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">这只猫看起来像我</figcaption></figure><p id="bc5c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是一个伟大节日的前夕。整个美洲的所有人和儿童刚刚醒来，看到了灰色的天空和过敏。</p><p id="9cd4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我醒来发现我女朋友的小狗(维奥莱塔)舔着我的鼻子在我床上打滚。这只狗喜欢在床上，因为她不应该在那里，她舔我的鼻子，因为她想在早上吃东西。还有，她讨厌我。</p><p id="9fb5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们是死敌。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi le"><img src="../Images/0407424cc86f29d27d3e832c7eaa640c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pihcmIhzEh0BzfW-8kddZQ.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">如果你仔细看，你可以看到她眼中的地狱之火</figcaption></figure><p id="b2b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我给自己倒了杯咖啡，心想…</p><blockquote class="lf"><p id="12ad" class="lg lh it bd li lj lk ll lm ln lo kn dk translated">哎呀，我没有未来，我是一个没有计划的失败者。我的银行账户也是负数(非常重要的细节。)我还不如做一个没有任何用处的Rust API，因为对这个世界来说最好的事情就是再多一个不知道自己在做什么的程序员。</p></blockquote><p id="d48e" class="pw-post-body-paragraph jq jr it js b jt lp jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn im bi translated">为什么要用铁锈？因为，我为什么要使用一个以易用和可靠著称的工具(比如ruby on rails或。当我可以用一些愚蠢的困难和高尚的东西来满足我的自我时，比如我在《铁锈》中找到的任何未完成的箱子？我想我们有答案了。让我们用我们能想到的最难的工具来增加印象分。</p><p id="62e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，在6个月后的某个午餐时间，我可以夸耀这个烦人的项目，而我的同事们则翻着白眼，忍受着我难以忍受的废话。一年后我会喝着啤酒问自己为什么没有朋友。</p><h1 id="978b" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">第一步——试着找出这不可能的原因</h1><p id="a9d0" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">还不如在我们开始前碰壁。逃避工作最简单的方法就是…逃避工作。有一次一个聪明人告诉我，图灵完备性意味着这个工具可以做任何事情。(这是经过数学证明的。)但是，我经常忽略聪明人，并试图欺骗自己，认为自己可能知道得更多。</p><p id="c66a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Rust是一门非常年轻的语言，它肯定缺少一些关键的特性，对吗？</p><p id="a912" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好吧，那我们就用谷歌吧。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mx"><img src="../Images/66de14a1a4bc90a9d0e125f5dab4d6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0khvVBNJ7wkEsWFtV47Utw.jpeg"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi my"><img src="../Images/4614fb97463e65ab99f7bce5ac7aa23a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w3ykR0oEKLXBtB4Hv0RN0Q.jpeg"/></div></div></figure><p id="1689" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">嗯嗯嗯。</p><p id="906f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看起来……有可能，但我并不完全相信。让我们点击其中一个链接，然后滚动到文章的底部，看看我们是否能找到更多确凿的证据。</p><p id="d861" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第二个链接有一个工作演示。废话。看起来我不能告诉我的老板这是不可能的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/d7d68484c44941649f52b8f3a3084812.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*2agizAqXY0eMEt1oSSNIfQ.jpeg"/></div></figure></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="988d" class="lu lv it bd lw lx nh lz ma mb ni md me mf nj mh mi mj nk ml mm mn nl mp mq mr bi translated">第二步——用铁锈做hello world</h1><p id="6489" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">我很肯定Rust已经安装在我的电脑上了，因为我在6个月前用它做了一些事情，但我不记得任何命令或我妈妈的电话号码，所以我要去谷歌“rust lang”</p><div class="nm nn gp gr no np"><a href="https://www.rust-lang.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">锈</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">Rust速度惊人，内存效率高:没有运行时或垃圾收集器，它可以支持关键性能…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.rust-lang.org</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od ky np"/></div></div></a></div><p id="8ecc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将单击黄色的“开始”按钮。我很高兴它又大又黄，否则我就找不到它了。</p><blockquote class="lf"><p id="88ba" class="lg lh it bd li lj lk ll lm ln lo kn dk translated">我的简历生锈了</p></blockquote><p id="9958" class="pw-post-body-paragraph jq jr it js b jt lp jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn im bi translated">然后，导航到我桌面上的某个名为rust的目录。我在操作系统的其他地方有rust项目，但是我不记得它们在哪里了。</p><p id="babc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据rust-lang网站，如果我已经安装了rust，我可以运行…</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="def6" class="oj lv it of b gy ok ol l om on"><strong class="of iu">rustup update</strong></span></pre><p id="cc83" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我的命令行上。我这样做了，绿色文本出现在我的屏幕上，这很好，因为绿色意味着好。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/9af7e53ca86f2df735c21a78fc726127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjUCzhc7dJoiVF3tRTT_GQ.jpeg"/></div></div></figure><p id="a351" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，绿色文本还写着“等等，等等，等等，稳定，等等，等等。”所以，我猜我的锈版可以养马。我感觉好极了。我们在这里做得很棒。</p><p id="42a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据我10秒前浏览的网站上的rust文档,“cargo”是大多数rust项目的构建工具。为了使用它，您运行这三个命令。</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="a6c8" class="oj lv it of b gy ok ol l om on"><strong class="of iu">cargo new [project-name]</strong> =&gt; generate new project</span><span id="407e" class="oj lv it of b gy op ol l om on"><strong class="of iu">cargo build</strong> =&gt; compile the project</span><span id="cc4e" class="oj lv it of b gy op ol l om on"><strong class="of iu">cargo run</strong> =&gt; run the project</span></pre><p id="8a0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以我做了一个…</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="c315" class="oj lv it of b gy ok ol l om on"><strong class="of iu">cargo new insult-taylor</strong></span></pre><p id="621d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更多绿色文本</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/29b727914ed9349178e1fc8f0f83ce45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*36Duaqwum9Z2uaRu1rxOZA.jpeg"/></div></figure><p id="1e51" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后…</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="99b1" class="oj lv it of b gy ok ol l om on"><strong class="of iu">cd insult-taylor </strong>=&gt; navigate into insult-taylor repo</span><span id="735d" class="oj lv it of b gy op ol l om on"><strong class="of iu">code . </strong>=&gt;<strong class="of iu"> </strong>vscode initializer</span></pre><p id="4b99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">生成的回购看起来是这样的…</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi or"><img src="../Images/5f2d6334d3433705e6beac7d877aa27c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*x8MBx15a3u89sGocw7F4Mw.jpeg"/></div></figure><p id="aec7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它已经有“hello world”了，所以我要构建并运行它。</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="2a3f" class="oj lv it of b gy ok ol l om on"><strong class="of iu">cargo build</strong></span><span id="7e3c" class="oj lv it of b gy op ol l om on"><strong class="of iu">cargo run</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/10960df7cf526fcddb1fd244bcfd2d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*RN3sjp4zFx51wkub6PQUUg.jpeg"/></div></div></figure><p id="e04f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">甜蜜的现在我们都是乡巴佬。当我开始用rust编程时，我所有的问题都神奇地消失了。从现在开始，我将试图违背我的经理和上帝的良好愿望，将rust潜入我公司的代码库。</p><p id="c5c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我被抓住了，我会在说出一些著名程序员的名字之前说一些类似“类型理论就是生命”的话，以试图迷惑我的仲裁者。</p><blockquote class="lf"><p id="49fa" class="lg lh it bd li lj lk ll lm ln lo kn dk translated">亲爱的谷歌，请雇用我</p></blockquote></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="c5bd" class="lu lv it bd lw lx nh lz ma mb ni md me mf nj mh mi mj nk ml mm mn nl mp mq mr bi translated">第三步——找别人帮我做大部分工作</h1><p id="cfd2" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">因为我不是一个父亲，我不能让我的孩子编码这个。所以，我将退而求其次，搜索crates.io。如果你不知道，许多编程语言使用某种模块管理系统，允许用户上传和下载社区制作的东西。</p><p id="4beb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这真是太棒了，因为聪明人可以帮助很多人，像我这样的笨蛋可以利用聪明人的成果。</p><p id="a7ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，由于rust最初是在10年前发布的，我们正处于一个甜蜜点，聪明人有时间来制作大多数重要的东西。这样我们就可以完全减少我们必须做的实际工作。</p><p id="063c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我要做的是去crates.io，在搜索栏里输入“ORM”。</p><p id="d511" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我将使用过滤器来过滤“有史以来最多的下载”</p><p id="f149" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于那些不知道的人。大多数应用程序都有一些前端客户端来与人类进行交互。然后，他们有一些后端API，有一个ORM和一个数据库。</p><p id="27a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">随着应用程序变得更好，编码人员可以构建额外的前端或API来嵌入他们想要的任何功能。这就是他们所说的微服务。侮辱-泰勒API将会很小，所以这些都不重要。</p><p id="ea4b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ORM代表对象关系映射器，但是我们可以忽略行话，只称它为“让编程语言容易和安全地与数据库通信的东西”此外，许多ORM都带有开箱即用的SQL注入保护，这有点不错。</p><p id="e042" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我试图避免的聪明人的东西。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/82fcc2e44040828d349232b9a072d16e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X36RA6EgGZQHh2xdVq8eXA.jpeg"/></div></div></figure><p id="ac4b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看起来diesel是rust最流行的查询生成器和ORM。最上面的orm的东西写着未完成，所以我要避开它，就像我父亲和我父亲的父亲避开他们的孩子一样。</p><p id="ee47" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我点击Diesel链接时，它说他们的网站上有大量的“入门”教程。这太棒了。网站增加可信度。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="266c" class="lu lv it bd lw lx nh lz ma mb ni md me mf nj mh mi mj nk ml mm mn nl mp mq mr bi translated">第四步——实际建造这个该死的东西</h1><p id="d911" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">diesel的默认文档使用PostgreSQL。我喜欢Postgres，因为我聪明的朋友告诉我它比MYSQL好。多年来，我一直在夸夸其谈SQL数据库。</p><p id="357a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将直接从官方文档中复制并粘贴一些内容，除了它将与官方文档有所不同，因为文档告诉我们如何管理博客。我的API要管理人身侮辱。</p><p id="a450" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">进入你的。toml文件，并使您的依赖项如下所示。</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="e625" class="oj lv it of b gy ok ol l om on"><strong class="of iu">[dependencies] <br/>diesel = { version = "1.4.4", features = ["postgres"] } <br/>dotenv = "0.15.0"</strong></span></pre><p id="f980" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">安装diesel CLI工具。</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="c1bb" class="oj lv it of b gy ok ol l om on"><strong class="of iu">cargo install diesel_cli</strong></span></pre><p id="cd64" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在过去的4个月里，我一直在我的公司使用MongoDB。在这个过程中的某个地方，我搞砸了我的postgres环境，所以它不能工作，cargo在错误语音中说“帮助我，我不能连接到Postgres数据库”。</p><p id="8970" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">实际错误是这样的:</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="9d85" class="oj lv it of b gy ok ol l om on"><strong class="of iu">FATAL:  role "taylor" does not exist</strong></span></pre><p id="034c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有这些糟糕的话让我感到难过，所以我把这条错误信息复制到谷歌，发现了一个堆栈溢出的帖子，说我要么没有安装Postgres，要么我的环境在某种程度上被搞糟了，最好的解决方案是重新安装应用程序。</p><p id="b874" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果是我在这个问题上更愚蠢，因为我没有安装Postgres。不知何故，我完全忽略了那个细节。如果你遇到同样的问题，这里有一个链接。</p><div class="nm nn gp gr no np"><a href="https://postgresapp.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">postgres . app——在Mac上开始使用PostgreSQL的最简单方法</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">Postgres.app是打包为标准Mac应用程序的全功能PostgreSQL安装。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">postgresapp.com</p></div></div><div class="ny l"><div class="ou l oa ob oc ny od ky np"/></div></div></a></div><blockquote class="lf"><p id="5d03" class="lg lh it bd li lj ov ow ox oy oz kn dk translated">我甚至没有安装postgres</p></blockquote><p id="40c4" class="pw-post-body-paragraph jq jr it js b jt lp jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn im bi translated">一旦我安装了Postgres，喝了一杯伏特加来缓解情绪上的痛苦，我就运行diesel setup命令。</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="30ca" class="oj lv it of b gy ok ol l om on"><strong class="of iu">diesel setup</strong></span></pre><p id="d5e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我迁移的发电机</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="8cef" class="oj lv it of b gy ok ol l om on"><strong class="of iu">diesel migration generate create-insults</strong></span></pre><p id="a2fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于那些不熟悉数据库/API的人。整个迁移约定之所以存在，是因为人们希望能够跟踪数据库随时间的变化。通过这种方式，您可以添加新的表，或者更改现有的表，或者以递增的方式进行更改。</p><p id="d3a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果发生了可怕的事情，您可以恢复到以前的迁移。我将我生成的迁移称为create-limits，因为这是迁移的名称，而不是表，这意味着它应该描述我们要对数据库做什么。</p><p id="7f3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看起来diesel的惯例是我们将使用普通SQL进行迁移。每次迁移都有一个上行文件和一个下行文件。up文件将包含进行我们的更改的SQL。down文件将包含根据迁移恢复我们的变更<strong class="js iu">的SQL。</strong></p><p id="e75c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这对我来说是令人愉快的。首先，编写普通的SQL让我觉得一年前阅读SQL教科书时没有浪费时间，而且这种迁移比我想象的要容易得多。</p><p id="0e18" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就是我如何更改我的迁移文件。</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="f89d" class="oj lv it of b gy ok ol l om on">// up.sql</span><span id="50d3" class="oj lv it of b gy op ol l om on"><strong class="of iu">CREATE TABLE insults (</strong></span><span id="15df" class="oj lv it of b gy op ol l om on"><strong class="of iu">id SERIAL PRIMARY KEY,</strong></span><span id="e951" class="oj lv it of b gy op ol l om on"><strong class="of iu">body TEXT NOT NULL</strong></span><span id="7414" class="oj lv it of b gy op ol l om on"><strong class="of iu">)</strong></span><span id="fe24" class="oj lv it of b gy op ol l om on"><br/>// down.sql</span><span id="f08e" class="oj lv it of b gy op ol l om on"><strong class="of iu">DROP TABLE insults</strong></span></pre><p id="d12d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你根本不懂SQL。这很好。这是你在大学里将要上的课中的一个内容，你可能再也用不到了(比如艺术史。)即使你确实需要使用，语言也并不复杂。大概一周就能学会。</p><p id="6046" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">迁移完成后，我运行了迁移</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="868e" class="oj lv it of b gy ok ol l om on"><strong class="of iu">diesel migration run</strong></span></pre><p id="37d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我要给你讲很多东西，但是我会解释它在高层次上做什么。你不需要知道每一个细节，因为这不是我们从零开始做的，所以我们不需要知道。</p><p id="f405" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我做了另外4个。rs文件，然后在里面放一些代码。官方文件让我们制作一个博客文章数据库，但是由于这个项目是一个侮辱数据库，我只是删除了所有我能找到的臃肿的软件，并且把所有的变量名改为“侮辱”而不是“文章”我保留了我所看到的多元化惯例，因为ORM非常重视他们的多元化(相信我。)</p><p id="517b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">大约有100行代码，所以这里有一个要点。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="d3b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">简而言之，我制作了一个模型文件，它模拟了数据库中的侮辱表。</p><p id="ad72" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在查询构建器中添加了一个名为write _ limits的方法，用于向Postgres数据库提交新信息。</p><p id="9d9b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在有一个控制write _ limits过程的write _ limits文件。</p><p id="215e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有一个show _ limits文件控制侮辱的显示。</p><p id="521f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这一切都是从diesel网站上的官方文档中获得的。</p><div class="nm nn gp gr no np"><a href="https://diesel.rs/guides/getting-started/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">内燃机</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">在本指南中，我们将通过一些简单的例子来了解CRUD的每一部分，它代表…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">柴油. rs</p></div></div></div></a></div><p id="4506" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种建模数据库和编写模块化控制器的惯例在API的世界中很常见，在任何其他语言中都可以看到。(迁移也是如此。)</p><p id="4ba1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一路上，我遇到了许多问题。我懒得实际阅读代码，所以在几分钟内，我漫无目的地更改内容，并反复保存和运行它，试图绕过错误。在这段时间里，我向上帝祈祷，并在我的公寓里点燃了一些熏香，试图驱散那些不好的情绪。</p><p id="1f26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我拿出薰衣草在屏幕前挥舞时，我真的期待一些结果。但是唉，什么都没有。</p><p id="0a2c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我放弃了这种方法，实际上是阅读代码。在那一点上，我意识到我不小心在文档中留下了一段代码，其中有一点点关于博文是否已经发表的验证。由于我所有的文件都被转换成处理未经证实的侮辱，这违反了我的代码。我删了它，嘣！</p><h2 id="2e8a" class="oj lv it bd lw pc pd dn ma pe pf dp me kb pg ph mi kf pi pj mm kj pk pl mq pm bi translated">神化</h2><blockquote class="lf"><p id="8f0c" class="lg lh it bd li lj lk ll lm ln lo kn dk translated">谷歌不可能再忽视我的简历了</p><p id="cf8a" class="lg lh it bd li lj lk ll lm ln lo kn dk translated">我是活着的最好的程序员</p></blockquote><p id="a868" class="pw-post-body-paragraph jq jr it js b jt lp jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn im bi translated">现在我们可以通过跑步来写侮辱</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="8c5d" class="oj lv it of b gy ok ol l om on"><strong class="of iu">cargo run --bin write_insult</strong></span></pre><p id="8c21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以通过跑步来阅读侮辱</p><pre class="kp kq kr ks gt oe of og oh aw oi bi"><span id="0ea8" class="oj lv it of b gy ok ol l om on"><strong class="of iu">cargo run --bin show_insults</strong></span></pre><p id="d2a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是它工作的视频。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pn pb l"/></div></figure></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="2a09" class="lu lv it bd lw lx nh lz ma mb ni md me mf nj mh mi mj nk ml mm mn nl mp mq mr bi translated">第五步——让scope creep粉碎我的梦想，重新开始</h1><p id="dc3f" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">有一个问题。我这个项目的目标是制作一个可以用于网页的API，这样我就可以链接到网页，我的读者可以去链接，并在博客的结尾提交他们自己的侮辱。</p><p id="b960" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，diesel并没有自带HTTP功能。它只是一个查询生成器和ORM。</p><p id="934b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">rust中有大量的HTTP库，但是我必须以某种方式将它们集成到diesel中，对于像我这样懒惰的人来说，这是一件非常繁重的工作。</p><p id="898f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我在谷歌上搜索如何制作自己的HTTP请求和响应以便从我的数据库中提交JSON时，我发现有一个名为rocket.rs的新兴rust框架。它附带了一个ORM，query builder和HTTP功能，这些功能都捆绑在一起，这正是我想要的这个项目。</p><div class="nm nn gp gr no np"><a href="https://rocket.rs/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">Rocket -简单、快速、类型安全的Rust Web框架</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">Rocket对JSON有一流的支持，开箱即用。简单地派生反序列化或序列化来接收或…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">火箭. rs</p></div></div></div></a></div><p id="4c70" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我可以粉碎我的梦想，用新的东西重新开始时，我为什么要自己建造项目的最后一部分呢？自己做任何东西都是不可能的，因为我没有能力。</p><blockquote class="lf"><p id="aa8b" class="lg lh it bd li lj lk ll lm ln lo kn dk translated">完全忽略这样一个事实，即编写一些http请求和响应函数可能更容易，因为我们的数据库已经设置好并正在工作</p></blockquote><p id="18c4" class="pw-post-body-paragraph jq jr it js b jt lp jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn im bi translated">如果我在开始的时候多花5分钟来计划，我就可以从火箭开始了。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="7545" class="lu lv it bd lw lx nh lz ma mb ni md me mf nj mh mi mj nk ml mm mn nl mp mq mr bi translated">第六步——把我所有的错误(和放屁)都归咎于狗</h1><p id="2f64" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">维奥莱塔，你这个魔鬼！！！！！你怎么能让我不计划我的项目？！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi po"><img src="../Images/6bc0ecd62f53aa8c3dcbdfcc44adef5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1LDcspmBSvvm0SrbuNsBA.jpeg"/></div></div></figure></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="8767" class="lu lv it bd lw lx nh lz ma mb ni md me mf nj mh mi mj nk ml mm mn nl mp mq mr bi translated">结论</h1><p id="678b" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">柴油发动机。我真的很喜欢这个项目。Diesel实现了简单性和功能性的完美平衡。它是典型的准系统ORM和查询生成器，非常适合个人项目。组装它非常容易。我的错误很容易导航，这是类型安全的副产品。整个过程让我惊喜不已。</p><p id="e119" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下一篇博客中，我将把整个应用程序重构为rocket.rs。一旦API最终设置了HTTP请求和响应功能，我将制作一个小的react前端，并发布一个到完成项目的链接。</p><p id="2832" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">届时，我将带您了解react前端。</p><p id="aba5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下次见。</p></div></div>    
</body>
</html>