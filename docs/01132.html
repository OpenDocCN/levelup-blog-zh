<html>
<head>
<title>Using Redux with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Redux与React一起使用</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-redux-with-react-cb4414f53fd9?source=collection_archive---------3-----------------------#2019-11-13">https://levelup.gitconnected.com/using-redux-with-react-cb4414f53fd9?source=collection_archive---------3-----------------------#2019-11-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="972a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">或者说我是如何学会不再烦恼，热爱中央州的。</h2></div><p id="abac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Redux是集成到React中的一个非常棒的工具，因为它可以帮助简化组件并保持应用程序状态有组织。起初，这看起来有点吓人，但是一旦你理解了它的活动部分，在你的代码中应用和扩展它就成了一种条件反射。</p><p id="ad7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从复习Redux的基础知识开始。Redux不是React的一部分，它是一个可以集成到大多数现代JavaScript框架中的库。它通常与React一起使用，因为React基于状态和属性的层次结构。Redux仅仅是一种集中管理应用程序状态的方式，换句话说- <strong class="kk iu">单一的事实来源。</strong></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/29aae37cd04fb422b8430ee5c741164f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*XEVxovodur9doQW-GJ6MLA.gif"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">Redux活动部件的演示。</figcaption></figure><p id="1479" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Redux功能可以分为3个步骤(本例中的所有代码都是普通的Redux和JavaScript)</p><p id="8b5b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第一步:调度一个动作</strong> <br/>一个动作是一个<strong class="kk iu"> <em class="lu">对象</em> </strong>被调度到Redux的商店。该动作包含将在商店中更改的<strong class="kk iu"> <em class="lu">数据</em> </strong>，以及告知商店将该数据放在哪里的<strong class="kk iu"> <em class="lu">类型</em> </strong>。如上所示，调度一个提取$10的操作如下所示:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="1901" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第二步:还原状态<br/>Redux中的</strong>动作被分派到<strong class="kk iu">存储</strong>的一部分，称为<strong class="kk iu">减速器</strong>。减速器决定了<strong class="kk iu">商店的哪个部分</strong>需要更换。这基本上是一个巨大的<code class="fe lx ly lz ma b">if</code> / <code class="fe lx ly lz ma b">else</code>或<code class="fe lx ly lz ma b">switch</code>声明。减速器检查的关键是调度动作的<strong class="kk iu">型</strong>:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="9dc4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">步骤3:返回状态<br/> </strong>在上面的代码示例中，我已经将更改状态和返回状态合并到同一个步骤中。Redux的一个关键规则是<strong class="kk iu">状态永远不会被直接操作</strong>，所以reducer实际上会复制状态并改变它。这就是为什么我们将状态作为参数和动作一起传递给reducer。应用程序的缩减器、调度器和状态都存储在一个叫做<strong class="kk iu">的存储中。当我们启动Redux时，我们需要用我们的reducer作为参数来创建我们的存储，所以我们运行这行代码:</strong></p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><h1 id="667f" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">实现到React</h1><p id="7e79" class="pw-post-body-paragraph ki kj it kk b kl mt ju kn ko mu jx kq kr mv kt ku kv mw kx ky kz mx lb lc ld im bi translated">现在我们已经了解了Redux的基本工作原理，我们可以开始在React中实现它了。第一步是将redux和react-redux库安装到react应用程序中。运行这两个命令:</p><pre class="lf lg lh li gt my ma mz na aw nb bi"><span id="3d0d" class="nc mc it ma b gy nd ne l nf ng">npm i --save react-redux<br/>npm i --save redux</span></pre><p id="bc31" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">安装完这两个包之后，我们就可以开始设置我们的商店了。让我们把上面的例子转换成React。首先，让我们从最高级的组件开始(这意味着组件层次结构中最高的组件)。我们将把我们的<strong class="kk iu"> <em class="lu">缩减器</em> </strong>文件放在React目录中并导入它，还有Redux包中的<code class="fe lx ly lz ma b">createStore</code>函数。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="a812" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还需要从React-Redux包中导入<strong class="kk iu"> <em class="lu"> Provider </em> </strong>组件，并用我们创建的存储提供它的prop“store”。provider组件使我们的存储对包装在其中的所有组件可用，所以最容易放置它的地方是在我们的最高级组件周围。</p><p id="4d48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经成功了一半！现在我们的存储已经设置好了，我们可以将一个组件连接到存储，并开始向它分派操作。我已经创建了一个组件，包含2个按钮和一个平衡显示来模仿上面的gif。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="4ebc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我们的基本组件在没有Redux的情况下的草图。让我们开始适应Redux范式。从技术上来说，由于提供者的父组件，这个组件已经连接到商店了——但是，这个组件不知道商店中的任何事情。为了连接它，我们从一个叫做<code class="fe lx ly lz ma b">mapStateToProps</code> <strong class="kk iu">的函数开始。</strong></p><p id="6646" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">函数<code class="fe lx ly lz ma b">mapStateToProps</code>确实像它听起来的那样，<strong class="kk iu">它将我们状态的片段映射到组件的道具</strong>。我们将在我们的状态中获取平衡的值，并将其应用到我们的道具中。看起来是这样的:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="b247" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看起来很简单，对吧？如果你想知道“state”和“props”参数从何而来，或者我们为什么返回对象，我会马上解释。只需知道我们的余额现在可以通过“this.props.balance”在组件中访问。为了改变我们的商店，我们需要一种方法来<strong class="kk iu">分派动作</strong>。我们将编写一个名为<code class="fe lx ly lz ma b">mapDispatchToProps</code> <strong class="kk iu">的函数。</strong></p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="f67a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该函数返回一个对象，该对象的键对应于调用<strong class="kk iu">调度函数</strong>的函数。在dispatch函数内部，我们将放置我们的<strong class="kk iu">动作，</strong>动作也是以对象的形式出现的。与上面非常相似，现在可以分别通过“this . props . retract”和“this.props.deposit”使用分派功能。</p><p id="c03e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们<strong class="kk iu">使用react-redux: <code class="fe lx ly lz ma b">connect()</code> <strong class="kk iu">提供的另一个函数将</strong>连接在一起。</strong>我们将它导入到文件的顶部，然后将它放在我们的类的底部，<strong class="kk iu"> <em class="lu">传入</em> </strong> <code class="fe lx ly lz ma b"><strong class="kk iu"><em class="lu">mapStateToProps</em></strong></code> <strong class="kk iu"> <em class="lu">和</em> </strong> <code class="fe lx ly lz ma b"><strong class="kk iu"><em class="lu">mapDispatchToProps</em></strong></code> <strong class="kk iu"> <em class="lu">作为参数</em> </strong>。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="652f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我知道，这看起来很奇怪——我会解释的。connect函数需要两个参数，两个返回对象的函数，它返回一个<em class="lu">包装函数。</em>然后，这个包装函数接受我们的组件类<em class="lu">作为参数</em>，并使用我们在mapStateToProps和mapDispatchToProps中设置的参数返回一个与我们的存储连接的<em class="lu">组件。<strong class="kk iu"> <em class="lu"> </em> </strong>基本上，它创建了与我们的存储一起工作的组件的克隆。该克隆是被导出的克隆。理解这一点对于理解如何设置Redux来说并不重要，但是对于某些人来说，它确实解开了奇怪的语法之谜。</em></p><p id="869b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您会注意到，我还将我们的道具添加到了组件返回的JSX中。你可以在这里克隆我为这个博客<a class="ae nh" href="https://github.com/Giagnus64/Redux-Fun" rel="noopener ugc nofollow" target="_blank">创建的回购。一旦您在浏览器中旋转它，您将得到如下所示的内容:</a></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/dd85a0e10bd6ee71ea1925a1731c2509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/1*mXJ5rt66DOHRx9S5iNz5sQ.gif"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">我们的redux代码有效！</figcaption></figure><p id="323d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以将Redux集成到任何其他组件中，只需建立我们的“map”函数，并连接到商店。一旦你掌握了使用redux的诀窍，你就可以开始组织你的代码，为你的动作、<a class="ae nh" href="https://redux.js.org/api/combinereducers" rel="noopener ugc nofollow" target="_blank">创建单独的文件，有多个reducer</a>，或者<a class="ae nh" href="https://medium.com/@stowball/a-dummys-guide-to-redux-and-thunk-in-react-d8904a7005d3" rel="noopener">实现中间件</a>，以便使用Redux范例异步查询你的API。</p><p id="2eaf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读！</p><h1 id="afe5" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated"><strong class="ak">来源:</strong></h1><div class="nj nk gp gr nl nm"><a href="https://react-redux.js.org/introduction/quick-start" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">快速启动反应还原</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">React Redux是Redux的官方React绑定。它让您的React组件从Redux存储中读取数据，并且…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">react-redux.js.org</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa lo nm"/></div></div></a></div><div class="nj nk gp gr nl nm"><a href="https://redux.js.org/basics/basic-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">基础教程:Intro Redux</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">不要被所有关于reducers、中间件、存储增强器的花哨说法所迷惑——Redux非常简单。如果你已经…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">redux.js.org</p></div></div><div class="nv l"><div class="ob l nx ny nz nv oa lo nm"/></div></div></a></div></div></div>    
</body>
</html>