<html>
<head>
<title>Running a Python Web Application in Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Docker中运行Python Web应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/running-a-python-web-application-in-docker-791b1a0dbd5b?source=collection_archive---------4-----------------------#2022-07-21">https://levelup.gitconnected.com/running-a-python-web-application-in-docker-791b1a0dbd5b?source=collection_archive---------4-----------------------#2022-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f3d4986ebfbc1bca1cdad3574b5f0488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8-rCvfbz9kXTCxNM8YgjVQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">docker + python</figcaption></figure><p id="5342" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这篇文章演示了一个由docker部署的简单python web应用程序。它的目的是向您展示如何dockerize一个连接到本地服务的python应用程序，例如<strong class="kh iu"> MongoDB </strong>和<strong class="kh iu"> Redis </strong>。</p><p id="07e0" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">完整的代码是<a class="ae ld" href="https://github.com/jerryan999/python-application-docker" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><h1 id="60aa" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">先决条件</strong></h1><ul class=""><li id="fa22" class="mc md it kh b ki me km mf kq mg ku mh ky mi lc mj mk ml mm bi translated">安装了MongoDB和Redis的主机</li><li id="8388" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">码头工人</li><li id="81e5" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">Python 3.9或更高版本</li></ul><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ms"><img src="../Images/daeff216e2a0974785c550e1c2645e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQkx3CrEZkx0t2KfkaX7OQ.png"/></div></div></figure><h1 id="b967" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Web应用程序</h1><p id="227e" class="pw-post-body-paragraph kf kg it kh b ki me kk kl km mf ko kp kq mx ks kt ku my kw kx ky mz la lb lc im bi translated">这里，我们使用流行的python <strong class="kh iu"> Flask </strong>框架来构建一个web应用程序。它是一个web框架，可以帮助您快速创建简单和复杂的web应用程序。</p><p id="e258" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">有四条主要路线，其目的如下。</p><ul class=""><li id="801b" class="mc md it kh b ki kj km kn kq na ku nb ky nc lc mj mk ml mm bi translated"><code class="fe nd ne nf ng b">/</code>:索引路线，显示欢迎信息。</li><li id="6096" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated"><code class="fe nd ne nf ng b">/mongo_health</code>:检查MongoDB的健康状况。</li><li id="5ba4" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated"><code class="fe nd ne nf ng b">/redis_health</code>:检查雷迪斯的健康状况。</li><li id="2532" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated"><code class="fe nd ne nf ng b">/send_mail</code>:发送异步作业。</li></ul><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="1366" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">异步任务</h1><p id="00e8" class="pw-post-body-paragraph kf kg it kh b ki me kk kl km mf ko kp kq mx ks kt ku my kw kx ky mz la lb lc im bi translated">有时，我们使用异步工作者来处理繁重的任务，例如发送电子邮件。</p><p id="c790" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这些工人只是python脚本，它们不断地监视Redis队列，并在消息可用时发送电子邮件。</p><p id="71a4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这里有一个简单的例子:我们可以使用这个框架创建更复杂的任务。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="d13b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">启动脚本</h1><p id="d1a2" class="pw-post-body-paragraph kf kg it kh b ki me kk kl km mf ko kp kq mx ks kt ku my kw kx ky mz la lb lc im bi translated">在这一部分，我们首先创建必要的文件夹和文件。然后我们通过使用<code class="fe nd ne nf ng b">supervisord</code>来启动这个工人。最后，我们使用<code class="fe nd ne nf ng b">gunicorn</code>服务器网关启动服务器。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="c6c1" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Dockerfile文件</h1><p id="fbcf" class="pw-post-body-paragraph kf kg it kh b ki me kk kl km mf ko kp kq mx ks kt ku my kw kx ky mz la lb lc im bi translated">最后但同样重要的是，<code class="fe nd ne nf ng b">dockerfile</code>如此重要，我们需要更多的解释。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><ul class=""><li id="dbb5" class="mc md it kh b ki kj km kn kq na ku nb ky nc lc mj mk ml mm bi translated">第1行:提取官方的python基础映像</li><li id="ef8e" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">第3–10行:安装必要的编译器和开发需求</li><li id="73a0" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">第13–23行:我们使用<a class="ae ld" href="https://docs.docker.com/develop/develop-images/multistage-build/" rel="noopener ugc nofollow" target="_blank">多阶段构建</a>策略来减小图像尺寸。所以这里我们再次使用<code class="fe nd ne nf ng b">python:3.9.13-slim</code>作为应用程序代码的基础映像。然后，我们设置用户帐户和环境变量。</li><li id="fce8" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">第25行:复制启动worker时使用的<code class="fe nd ne nf ng b">supervisors</code>配置文件</li><li id="50ae" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">第27–28行:将python包从第一个映像复制到这个应用程序映像中。</li><li id="b853" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">第33行:设置当前用户</li><li id="da50" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">第35行:定义容器启动时运行的脚本。</li></ul></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="a7f9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我希望你喜欢读这篇文章。如果你愿意支持我成为一名作家，可以考虑注册<a class="ae ld" href="https://jerryan.medium.com/membership" rel="noopener">成为一名媒体成员</a>。你还可以无限制地访问媒体上的每个故事。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h1 id="59eb" class="le lf it bd lg lh nq lj lk ll nr ln lo lp ns lr ls lt nt lv lw lx nu lz ma mb bi translated">分级编码</h1><p id="7688" class="pw-post-body-paragraph kf kg it kh b ki me kk kl km mf ko kp kq mx ks kt ku my kw kx ky mz la lb lc im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="7f9c" class="mc md it kh b ki kj km kn kq na ku nb ky nc lc mj mk ml mm bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="77a2" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">📰查看<a class="ae ld" href="https://levelup.gitconnected.com/" rel="noopener ugc nofollow" target="_blank">级编码出版物</a>中的更多内容</li><li id="27ae" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">🔔关注我们:<a class="ae ld" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae ld" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae ld" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li><li id="fa9a" class="mc md it kh b ki mn km mo kq mp ku mq ky mr lc mj mk ml mm bi translated">🚀👉<a class="ae ld" href="https://jobs.levelup.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh iu">软件工程师的顶级工作</strong> </a></li></ul></div></div>    
</body>
</html>