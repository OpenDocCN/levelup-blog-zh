<html>
<head>
<title>Portfolio Rebalancing with Decision Optimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">决策优化下的投资组合再平衡</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/portfolio-rebalancing-with-decision-optimization-c86798c87ac4?source=collection_archive---------18-----------------------#2021-03-23">https://levelup.gitconnected.com/portfolio-rebalancing-with-decision-optimization-c86798c87ac4?source=collection_archive---------18-----------------------#2021-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="98e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章介绍了另一个决策优化的商业应用示例，并提供了在<a class="ae kl" href="https://dataplatform.cloud.ibm.com/" rel="noopener ugc nofollow" target="_blank">云包数据</a>上复制该示例所需的所有资产和模型。</p><h2 id="54d9" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">问题。</h2><p id="117d" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">考虑的问题是<strong class="jp ir">投资组合的再平衡。</strong>投资组合由一组自有资产组成，每项资产都有价格和数量。也可能有一些现金。在本例中，不同类型的资产被视为使用不同的货币，因此必须管理汇率。</p><p id="2f2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不同的资产对应不同的公司。他们可能会根据不同的货币报价，并有不同的分析师建议说明。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/2a9d5f0b47ef7a9146a282c94a0fe039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDMkX2Hk-BidZrX1yuO_MA.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">示例中使用的资产</figcaption></figure><p id="8094" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">投资组合再平衡的目标是出售和购买一些资产，以便新的投资组合具有更好的平均推荐值，并遵守每个行业或类型的资产分布以及每种货币的剩余现金分布的一些安全限制。再平衡的成本也必须考虑。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ma"><img src="../Images/a33cadfce0687ba3f13e929a188184b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABq1SOrU4UBgXX21ABZsgg.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">每个行业的百分比限制示例</figcaption></figure><h2 id="0099" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">模型</h2><p id="ccad" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">该模型已使用<strong class="jp ir"> OPL </strong>(优化编程语言)，一种优化建模专用语言，公式化。选择使用OPL这样的专用语言还是Python这样的通用语言是个人偏好问题，参见<a class="ae kl" href="https://medium.com/@AlainChabrier/opl-vs-python-docplex-2d7b28814740" rel="noopener">这篇关于利弊的文章</a>。</p><p id="557d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模型是使用<strong class="jp ir">实验用户界面</strong>开发的，可作为Cloud Pak for Data的一部分。它支持多种场景和简单的可视化，从而加快了优化模型的开发和调试过程。<a class="ae kl" href="https://medium.com/ibm-watson/decision-optimization-model-builder-now-in-open-beta-on-watson-studio-public-45db16628e5b" rel="noopener">详见本帖</a>。</p><p id="aa23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模型是一个<strong class="jp ir">混合整数规划</strong>，将由CPLEX引擎求解。下面列出了决策变量。例如，<code class="fe mb mc md me b">finalQuantities</code>是一个整数决策变量数组，由资产索引，代表每种资产在最终投资组合中所占的比例。</p><pre class="ll lm ln lo gt mf me mg mh aw mi bi"><span id="b3da" class="km kn iq me b gy mj mk l ml mm">dvar int deltaQuantity [Assets];<br/>dvar int deltaBuyQuantity [Assets];<br/>dvar int deltaSellQuantity [Assets];<br/>dvar boolean changed [Assets];<br/>dvar float finalCash [Currencies];<br/>dvar boolean ownedCompany [Companies];<br/>dvar int finalQuantities [Assets];</span></pre><p id="dc45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有3种不同的表述被认为是目标的一部分:</p><ul class=""><li id="2b01" class="mn mo iq jp b jq jr ju jv jy mp kc mq kg mr kk ms mt mu mv bi translated">基于推荐票据的总投资组合符号，</li><li id="62f9" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated">交易的固定成本，</li><li id="50a1" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated">交易的可变成本。</li></ul><p id="95ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中的每一个都被定义为输入数据和决策变量的决策表达式(<code class="fe mb mc md me b">dexpr</code>)，目标是在最小化成本的同时最大化符号。</p><pre class="ll lm ln lo gt mf me mg mh aw mi bi"><span id="3a3e" class="km kn iq me b gy mj mk l ml mm">dexpr float Notation = sum(a in Assets) (a.price * finalQuantities[a] * exchangeRates[&lt;a.currency&gt;] * a.recomNote);</span><span id="9b2a" class="km kn iq me b gy nb mk l ml mm">dexpr float TransactionFixedCost = <br/>  sum(a in Assets) changed[a] * parameters["FixedFee"];</span><span id="3bfe" class="km kn iq me b gy nb mk l ml mm">dexpr float TransactionVariableCost =<br/>  sum(a in Assets) (deltaBuyQuantity[a] + deltaSellQuantity[a]) * parameters["TransactionCostPercentage"] / 100.;</span><span id="ffaa" class="km kn iq me b gy nb mk l ml mm">maximize Notation - TransactionFixedCost - TransactionVariableCost;</span></pre><p id="1891" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，在这种情况下，对每个目标元素赋予相同的权重。如果不同的目标元素不是直接等价的，有几种技术是可用的。最简单的方法是引入这些元素的一些<strong class="jp ir">加权和</strong>，为每个元素提供或多或少的值。当元素不可直接比较时，CPLEX和OPL还提供了对字典顺序目标的简单支持，有些应该首先考虑。</p><p id="b104" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你在<a class="ae kl" href="https://github.com/achabrier/assets/blob/master/PortfolioRebalancing/model.mod" rel="noopener ugc nofollow" target="_blank">完整的OPL模型</a>中看到的，有多个约束条件。</p><p id="20ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模型中一些有趣的约束是逻辑<strong class="jp ir"> if-then </strong>约束，用于链接布尔变量<code class="fe mb mc md me b">ownedCompany</code>和整数变量<code class="fe mb mc md me b">finalQuantitites</code>。这些逻辑约束被CPLEX自动线性化。</p><pre class="ll lm ln lo gt mf me mg mh aw mi bi"><span id="74f3" class="km kn iq me b gy mj mk l ml mm">// Owning assets or not <br/> forall(c in Companies) <br/>    ownedCompany[c] == 1 =&gt; sum(a in AssetsC[c]) finalQuantities[a] &gt;= 1;<br/>    <br/> forall(a in Assets) <br/>    ownedCompany[&lt;a.company_name&gt;] == 0 =&gt; finalQuantities[a] == 0;</span></pre><p id="7715" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本着同样的精神，添加了一些逻辑约束，以排除同时购买和出售某些给定资产的决策。这些也将被自动线性化，并由CPLEX引擎求解。</p><pre class="ll lm ln lo gt mf me mg mh aw mi bi"><span id="627c" class="km kn iq me b gy mj mk l ml mm">// cannot sell and buy of the same<br/> forall(a in Assets)<br/>  (deltaBuyQuantity[a] == 0) || (deltaSellQuantity[a] == 0);</span></pre><p id="e716" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其他几个更简单的约束正在实施一些需要遵守的限制。例如，以下约束确保对于每个给定的公司，<code class="fe mb mc md me b">LowerLimit</code>全局参数被用作与该公司对应的所有资产的最终头寸的下限:</p><pre class="ll lm ln lo gt mf me mg mh aw mi bi"><span id="7835" class="km kn iq me b gy mj mk l ml mm">forall(c in Companies)<br/>    LowLimitCompanyPercent:<br/>       parameters["LowerLimit"] * portfolioAssetsValue / 100 <br/>       &lt;= <br/>       sum(a in AssetsC[c])<br/>        a.price * finalQuantities[a] * exchangeRates[&lt;a.currency&gt;] + maxint * (1 - ownedCompany[c]);</span></pre><p id="0a09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在目标和约束公式化之后，定义一些KPI，这些KPI将在实验中报告并在WML上求解时导出。</p><pre class="ll lm ln lo gt mf me mg mh aw mi bi"><span id="be3d" class="km kn iq me b gy mj mk l ml mm">// KPIs for business display</span><span id="06aa" class="km kn iq me b gy nb mk l ml mm">dexpr float portfolioAssetsValueKPI = portfolioAssetsValue;<br/>dexpr float portfolioFitnessKPI = sum(a in Assets) ((a.price * initialQuantities[a] * exchangeRates[&lt;a.currency&gt;] / portfolioValue) * a.recomNote);<br/>dexpr float portfolioTotalValueKPI = portfolioValue;<br/>dexpr float transactionFixedCostKPI = TransactionFixedCost;<br/>dexpr float transactionVariableCostKPI = TransactionVariableCost;<br/>dexpr float cashKPI = sum(m in Currencies) finalCash[m] * exchangeRates[m];<br/>dexpr float numChangesKPI = sum (a in Assets) changed[a];</span></pre><p id="1633" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，输出以易于使用的表格组织。</p><h2 id="e429" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">结果。</h2><p id="5ecc" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">在实验UI中解决了给定的场景之后，用户可以浏览KPI和解决方案。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nc"><img src="../Images/6459cdcda4f62dfbaff6e93dcf109030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V3UXVeKFpnh1Rck0-AylAA.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">总体综合目标和关键绩效指标</figcaption></figure><p id="6212" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mb mc md me b">AssetResults</code>输出表如下所示:</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nc"><img src="../Images/48c92a2e6aad4223d6169b79226ebc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aY8v3YEsSBQkYgBMntu7sg.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">资产结果</figcaption></figure><p id="76e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个更好的理解和解释结果的方法，从而能够验证当前的模型或找出一些缺失的约束，是使用实验可视化。</p><p id="3c8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，可以创建一些图表来表示重新平衡前后每个资产或每个行业的分布情况，如下所示。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nc"><img src="../Images/ea76b28efa7b23619ed55ed709d78039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xw9Q0MOoNxHzWmYy_EOvgw.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">最终投资组合分布</figcaption></figure><p id="d65c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一些图表还可以比较再平衡前后的投资组合资产数量:</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nd"><img src="../Images/b4c8ed705e1606aeaa7d3692a8411d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSLfp0iuPzgqYI3CsEZBqw.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">之前与之后</figcaption></figure><p id="2e5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的仪表板配置<a class="ae kl" href="https://github.com/achabrier/assets/blob/master/PortfolioRebalancing/dashboard.json" rel="noopener ugc nofollow" target="_blank">可在此处</a>获得。</p><p id="671f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">重现这个例子的所有元素都可以在<a class="ae kl" href="https://github.com/achabrier/assets/tree/master/PortfolioRebalancing" rel="noopener ugc nofollow" target="_blank">这个github库</a>中找到。</p><h2 id="235f" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">结论</h2><p id="5896" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">这个应用决策优化的例子增加了一个不断增长的可重用例子列表:</p><ul class=""><li id="58ed" class="mn mo iq jp b jq jr ju jv jy mp kc mq kg mr kk ms mt mu mv bi translated"><a class="ae kl" href="https://towardsdatascience.com/network-design-with-decision-optimization-3c7fcade523" rel="noopener" target="_blank">网络设计</a></li><li id="1b58" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated"><a class="ae kl" href="https://medium.com/swlh/call-centers-staff-planning-bda6ed1c5518" rel="noopener">呼叫中心员工规划</a></li><li id="4286" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated"><a class="ae kl" href="https://medium.com/@AlainChabrier/prototype-decision-optimization-usage-for-covid-19-decision-making-26794a17b5f0" rel="noopener">病人转院</a></li><li id="9bcc" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated"><a class="ae kl" href="https://medium.com/@AlainChabrier/decision-optimization-covid-19-prototype-two-bb69d16ad228" rel="noopener">口罩供应链管理</a></li><li id="c99f" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated"><a class="ae kl" href="https://towardsdatascience.com/predictive-maintenance-scheduling-with-ibm-data-science-experience-and-decision-optimization-25bc5f1b1b99" rel="noopener" target="_blank">预测性维护计划</a></li></ul><p id="5a60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多关于AI和DO的故事，请关注我的<a class="ae kl" href="https://medium.com/@AlainChabrier" rel="noopener"> Medium </a>、<a class="ae kl" href="https://twitter.com/AlainChabrier" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae kl" href="https://www.linkedin.com/in/alain-chabrier-5430656/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>。</p><div class="ne nf gp gr ng nh"><a href="https://www.linkedin.com/in/alain-chabrier-5430656/" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">Alain Chabrier-IBM决策优化高级技术人员(STSM)</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">我的专长是管理软件开发以做出更好的决策。我一直在推动……的重新设计</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">www.linkedin.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv lu nh"/></div></div></a></div></div></div>    
</body>
</html>