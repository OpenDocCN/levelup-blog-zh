<html>
<head>
<title>Turn Raspberry Pi into Server and Implement CI/CD pipeline in AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Raspberry Pi转化为服务器并在AWS中实现CI/CD管道</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/turn-raspberry-pi-into-server-and-implement-ci-cd-pipeline-in-aws-752c5321dfe4?source=collection_archive---------5-----------------------#2020-05-29">https://levelup.gitconnected.com/turn-raspberry-pi-into-server-and-implement-ci-cd-pipeline-in-aws-752c5321dfe4?source=collection_archive---------5-----------------------#2020-05-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="ac3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我一直致力于自我发展和学习新技术。所以，我问我的大脑，为什么不利用这些有趣的隔离时间来刺激它。不到一毫秒，我的大脑回答道:“见鬼，是啊”。那是所有行动开始的地方！</p><p id="1343" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我被邀请加入一个名为“Pi的一片”的小型社区团体，寻找希望通过项目推动他们对树莓Pi的理解的爱好者。</p><p id="acae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过小组的推荐，我点了一杯树莓派零度。几个小时后，我想起我已经有一个前阵子别人借给我的没用过的树莓Pi 3了。一个巨大的微笑浮现在我的脸上，因为我不必等待新邮件的到来。该小组的想法是在家里安装一台服务器，“只是因为”这是一种学习体验。</p><p id="28ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该小组的想法是在家里安装一台服务器，作为一种学习体验。(过度缩放)</p><p id="dc68" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最终，我们的架构会是这样的。这包括您托管在Raspberry Pi上的网站，可通过公共互联网访问。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b292adc54e54e1ce95d440582e559a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ooBa_F3ff0TUHvryhDOBgQ.png"/></div></div></figure><p id="fe30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们一起去执行任务吧。</p><p id="6f50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">获得装备:</strong></p><p id="f770" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您将需要以下内容:</p><ul class=""><li id="87f6" class="la lb it js b jt ju jx jy kb lc kf ld kj le kn lf lg lh li bi translated">微型USB</li><li id="21d6" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">电力电缆</li><li id="24a1" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">HDMI电缆</li><li id="5ede" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">微型SD卡(建议32GB)</li><li id="500c" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">键盘</li><li id="0cb3" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">树莓派</li><li id="f694" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">带HDMI输入的监视器</li><li id="8a1e" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">路由器连接到WiFi</li><li id="1d30" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">老鼠</li><li id="4afe" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">SD卡适配器</li></ul><p id="f7eb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">准备SD卡</strong></p><p id="3e0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">希望你有SD卡读卡器。</p><p id="a6de" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将microSD卡插入适配器，然后插入您的笔记本电脑/PC，并完全格式化。</p><p id="2bdb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们在这里为来自<a class="ae lo" href="https://www.balena.io/etcher/" rel="noopener ugc nofollow" target="_blank">的树莓Pi安装操作系统(OS)。完成后，用你最喜欢的工具将它刻录在你的microSD卡上(我的工具是</a><a class="ae lo" href="https://www.balena.io/etcher/" rel="noopener ugc nofollow" target="_blank"> BalenaEtche </a>)。如果不知道怎么刻录，就按照<em class="lp">_将OS镜像刻录到microSD卡_ </em>一节。</p><p id="1af2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您现有的SD卡中有您不使用的数据，您也可以按照以下说明对其进行格式化</p><p id="48c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Linux操作系统GUI: </strong></p><ol class=""><li id="e5a1" class="la lb it js b jt ju jx jy kb lc kf ld kj le kn lq lg lh li bi translated">将microSD卡插入SD适配器</li></ol><p id="5d2d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.右键单击SD卡，然后单击<em class="lp">_属性_ </em></p><p id="4152" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.点击<em class="lp">打开磁盘</em></p><p id="b809" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.选择要格式化的分区。</p><p id="9190" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.点击<em class="lp">设置</em>图标(两个轮子)</p><p id="c12b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.选择<em class="lp">格式化分区</em></p><p id="7772" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">7.选择<em class="lp">擦除</em></p><p id="37d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">8.使用为所有设备选择<em class="lp"/></p><p id="154f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">格式化所花的时间会因数据量的不同而不同。同时，喝杯咖啡。</p><p id="87b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">将操作系统映像刻录到microSD卡</strong></p><p id="023b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.解压缩您下载的压缩Raspbian操作系统映像。</p><p id="5a89" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.打开BalenaEtcher。</p><p id="805a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.选择要刻录到SD卡上的操作系统映像</p><p id="5805" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.选择目标为SD卡。</p><p id="e9e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.点击<em class="lp">闪光灯</em></p><p id="54f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">在microSD卡上安装操作系统</strong></p><p id="646d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将microSD卡插入Pi并打开Pi。它自己引导和安装操作系统。</p><p id="0e23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="lp">错误提示——如果您插入SD卡，显示器屏幕保持黑屏。</em></p><p id="e195" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.把SD卡拿出来，</p><p id="947b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.轻轻地向上拉黑色部分(如下所示),直到它自己停止</p><p id="b4b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.把它推回去。</p><p id="9bb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.将SD卡插入</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/871b1e3d9c8437b1d612bbd3968a46b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*JleIiMsywWr0C7pMGoYmgQ.jpeg"/></div></figure><p id="5647" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">将Pi连接到互联网</strong></p><p id="ac06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">按打开端子。CTRL + ALT + T并通过运行以下命令切换到root用户</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="8329" class="lx ly it lt b gy lz ma l mb mc">sudo su</span></pre><p id="f824" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在哪里</p><p id="2378" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">su —代表超级用户</p><p id="7cd5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，跑</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="8cdf" class="lx ly it lt b gy lz ma l mb mc">raspi-config</span></pre><p id="6e53" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将打开Raspberry Pi配置工具</p><p id="7fc2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">进入<strong class="js iu">网络选项</strong>&gt;<strong class="js iu">WiFi</strong>&gt;<strong class="js iu">【输入你的网络名称】</strong> &gt;点击<strong class="js iu">确定</strong> &gt; <strong class="js iu">【输入你的网络密码】</strong> &gt;点击<strong class="js iu">确定</strong></p><p id="7ae3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在在GUI中使用您的网络名称连接到互联网。</p><p id="d54a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> SSH进入Pi </strong></p><p id="2149" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以从Linux、Mac或其他Pi连接到该Pi。我将从Mac上演示。</p><p id="52ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们需要知道Pi的IP地址。要找到它，请在您的Pi终端上键入hostname -I。如果您正在运行Pi headless(没有监视器)，您可以从路由器上的设备列表中找到IP地址。</p><p id="757c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要从rasp-config中启用SSH。打开终端，通过以下方式切换到超级用户:</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="4eee" class="lx ly it lt b gy lz ma l mb mc">sudo su</span></pre><p id="ea95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，跑</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="5640" class="lx ly it lt b gy lz ma l mb mc">raspi-config</span></pre><p id="7650" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">进入<strong class="js iu">界面选项</strong>，启用<strong class="js iu"> SSH </strong>。</p><p id="2d72" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在转到SSH，在您的客户机上打开终端并键入</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="7159" class="lx ly it lt b gy lz ma l mb mc">ssh [piUser]@[Pi_IP_ADDRESS]</span></pre><p id="772b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="lp">安全提示:为了安全起见，请务必更改默认密码。</em></p><p id="eb0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">代码解释:</strong></p><p id="6493" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">ssh</code>:用于ssh-ing的关键字</p><p id="0e2d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">[piUser]</code>:无论你的用户名是什么(不要包括方括号)</p><p id="d7e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">[Pi_IP_ADDRESS]</code>:您的Pi的IP地址(不包括方括号)</p><p id="8219" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如:</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="5df0" class="lx ly it lt b gy lz ma l mb mc">ssh pi@111.111.1.1</span></pre><p id="fe31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">按下回车键后，系统会提示您输入密码，就这样，您就成功了。</p><p id="c0d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">将Nginx安装到码头上</strong></p><p id="06e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，确保所有的包都通过运行</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="7112" class="lx ly it lt b gy lz ma l mb mc">sudo apt update</span></pre><p id="eb8b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，通过运行以下命令安装nginx:</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="8744" class="lx ly it lt b gy lz ma l mb mc">sudo apt install nginx</span></pre><p id="f0f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">代码解释:</strong></p><p id="2ca1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">sudo</code>:获得管理权限</p><p id="9e58" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">apt</code>:Ubuntu的打包系统</p><p id="92c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">install</code>:安装关键字</p><p id="f3ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">nginx</code>:要安装的包</p><p id="4475" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">测试网络服务器</strong></p><p id="d5b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，web服务器应该已经启动并运行了。要检查运行:</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="7e90" class="lx ly it lt b gy lz ma l mb mc">sudo systemctl status nginx</span></pre><p id="af5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出应以绿色显示<em class="lp">活动(运行)</em></p><p id="4f3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">也就是说，最好的测试方法是通过以下方式请求页面:</p><p id="25ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.<code class="fe md me mf lt b">cd /var/www/html</code>:导航到html文件夹</p><p id="3a1f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.<code class="fe md me mf lt b">touch index.html</code>:创建一个名为index.html的文件</p><p id="d79d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.<code class="fe md me mf lt b">vim index.html</code>:打开文件(如果<code class="fe md me mf lt b">vim</code>不工作，安装它)</p><p id="10c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.插入基本的html来测试服务器工作</p><p id="5cb9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.转到您的浏览器</p><p id="75c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.键入pi的IP地址(<code class="fe md me mf lt b"><a class="ae lo" href="http://111.111.1.1" rel="noopener ugc nofollow" target="_blank">http://111.111.1.1</a></code>)</p><p id="a16d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果一切顺利，你在家里有自己的服务器来显示你创建的页面。您的Pi已准备好托管。</p><p id="1fa0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">通过CI/CD管道上传至Pi</strong></p><p id="cf18" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们将在AWS中创建一个CI/CD管道，使用Github作为源代码和CodeBuild来构建项目。因此，当Github被提交时，就会自动触发管道。</p><p id="5a3a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第一步:</strong></p><p id="3a23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">登录<strong class="js iu"> AWS </strong> &gt; <strong class="js iu">服务</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/80c879c0dd0168840cf1606beceac2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*TYJnd42Nwx_QkEo91ZBMvw.png"/></div></figure><p id="7f25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第二步:</strong></p><p id="9f57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">转到<strong class="js iu"> AWS代码管道</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/790f38820fb898290deee0657f38bb5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*nJ2qGU2V92FsHBAS7Q0rew.png"/></div></figure><p id="ffa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第三步:</strong></p><p id="a104" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建管道</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mi"><img src="../Images/c830cf8a20c34efb6b022e69265209a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*53f8M8NW5aJQSTtQl7B9Vg.png"/></div></div></figure><p id="6744" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第四步:</strong></p><p id="e57c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">填写细节</p><p id="c04e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">出于以下原因，请确保该角色拥有对S3、KMS和SSM的读取权限:</p><ul class=""><li id="fff2" class="la lb it js b jt ju jx jy kb lc kf ld kj le kn lf lg lh li bi translated">S3将存储我们加密的SSH私有密钥，我们需要从S3那里获得私有密钥</li><li id="028e" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">KMS将解密从S3获取的ssh密钥</li><li id="068f" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">SSM将存储我们的域名</li></ul><p id="71ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">点击<strong class="js iu">下一步</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mj"><img src="../Images/f0549d370e1c6d0ebc9f35346a44a8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjcIrwTv2t67Lg4pVS-nkg.png"/></div></div></figure><p id="8044" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第五步:</strong></p><p id="917b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">选择<strong class="js iu"> Github </strong>作为<strong class="js iu">源级</strong>。一旦选中，点击按钮，say的<strong class="js iu">连接到Github </strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mk"><img src="../Images/c0d440b3d51aa43e44ae7c40cfb62168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*McPlTx9zRZvk7JyyFl64uA.png"/></div></div></figure><p id="2de0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">连接后，填写存储库详细信息</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ml"><img src="../Images/082f1c67db9275e01f36b1685928c7de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJqKV0h76NHyr9CXiuBiXQ.png"/></div></div></figure><p id="0508" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">点击<strong class="js iu">下一个</strong>。</p><p id="0702" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第六步:</strong></p><p id="58f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从下拉列表中选择AWS CodeBuild作为构建提供者，并填写详细信息。如果您还没有创建一个构建项目，请单击创建项目(按照6.1中的步骤)。如果已经有了(跳到第7步)，它应该在<strong class="js iu">项目名称</strong>的下拉列表中。</p><p id="abbe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完成后，点击<strong class="js iu">下一步</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mm"><img src="../Images/8fe7f60050eb0d14472a812a74af5648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ewIg59anSI4igO1KshCq_g.png"/></div></div></figure><p id="990e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">步骤6.1 </strong></p><p id="b1ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">单击构建项目:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mn"><img src="../Images/582eeb2e6d1154c5cba62baabd34d9e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_23b-hGAdbRAX1miPoFIsA.png"/></div></div></figure><p id="5744" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第6.2步</strong></p><p id="7a31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">命名项目并向下滚动</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mo"><img src="../Images/5aa66def8b43ba6eea1fe7df91915070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2AEtXL_JuLwpbE1iuPzNA.png"/></div></div></figure><p id="3d4c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第6.3步:</strong></p><p id="f548" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从下拉列表中选择一个<strong class="js iu">源提供商</strong>作为<strong class="js iu"> Github </strong>，然后<strong class="js iu">连接到你的Github账户</strong>。选择您连接的回购是公开的还是您自己的。然后向下滚动。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mp"><img src="../Images/aebecf365ec66ed1a722dea5c6a1a367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SoHa8UWL7HLX-eTSpaxvqA.png"/></div></div></figure><p id="ae23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">步骤6.4: </strong></p><p id="540f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">填写环境详细信息并向下滚动</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mq"><img src="../Images/2006a7095f5933944d1184277f056560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CwtVEAmODwL6GI_nNCrZuA.png"/></div></div></figure><p id="ba4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第6.5步</strong></p><p id="f167" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">添加一个<strong class="js iu">服务角色</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mr"><img src="../Images/982319aa762a8ab429c6338ab0a87ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ayhwT1VF0skdYf6hqnDXwA.png"/></div></div></figure><p id="1e9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">步骤6.6 </strong></p><p id="1308" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">选择<strong class="js iu"> <em class="lp">使用一个buildspec文件</em> </strong>(见下图后的代码为您的buildspec文件)。这个buildspec文件必须位于项目目录的根目录下</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ms"><img src="../Images/d9e972f1308ec41078f06abbf3180271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otsyJB1qlKC5PZN9Iqo4Vg.png"/></div></div></figure><p id="4599" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是代码是<code class="fe md me mf lt b">buildspec.yml</code></p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="7ec5" class="lx ly it lt b gy lz ma l mb mc">version: 0.1</span><span id="51cf" class="lx ly it lt b gy mt ma l mb mc">env:</span><span id="0949" class="lx ly it lt b gy mt ma l mb mc">parameter-store:</span><span id="ac5c" class="lx ly it lt b gy mt ma l mb mc">PI_DNS: /codebuild/piRoarcoder</span><span id="d51c" class="lx ly it lt b gy mt ma l mb mc">phases:</span><span id="6040" class="lx ly it lt b gy mt ma l mb mc">install:</span><span id="3768" class="lx ly it lt b gy mt ma l mb mc">commands:</span><span id="9f71" class="lx ly it lt b gy mt ma l mb mc">   - gem install jekyll bundler jekyll-paginate jekyll-sitemap jekyll-gist</span><span id="3b31" class="lx ly it lt b gy mt ma l mb mc">build:</span><span id="0909" class="lx ly it lt b gy mt ma l mb mc">commands:</span><span id="a79b" class="lx ly it lt b gy mt ma l mb mc">   - echo “******** Building Jekyll site ********”</span><span id="bc6e" class="lx ly it lt b gy mt ma l mb mc">   - jekyll build</span><span id="d3c8" class="lx ly it lt b gy mt ma l mb mc">   - echo “******** Get ssh key from S3 ********”</span><span id="273f" class="lx ly it lt b gy mt ma l mb mc">   - aws s3 cp s3://ssh-keys-zain/encrypted_id_rsa $HOME/encrypted_id_rsa</span><span id="e038" class="lx ly it lt b gy mt ma l mb mc">   - aws kms decrypt — ciphertext-blob fileb://$HOME/encrypted_id_rsa — output text — query Plaintext | base64 — decode &gt; $HOME/decrypted_id_rsa</span><span id="3e47" class="lx ly it lt b gy mt ma l mb mc">  - chmod 400 $HOME/decrypted_id_rsa</span><span id="77e5" class="lx ly it lt b gy mt ma l mb mc">  - echo “******** Upload to Raspberry Pi ********”</span><span id="c5df" class="lx ly it lt b gy mt ma l mb mc">  - scp -r -oStrictHostKeyChecking=no -i $HOME/decrypted_id_rsa ./* pi@$PI_DNS:/var/www/roarcoder.dev/html/</span><span id="6d51" class="lx ly it lt b gy mt ma l mb mc">  - rm $HOME/decrypted_id_rsa</span><span id="c7d2" class="lx ly it lt b gy mt ma l mb mc">  - rm $HOME/encrypted_id_rsa`</span></pre><p id="2f51" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">代码解释:</strong></p><p id="7ceb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">version: 0.1</code>:表示正在使用的buildspec版本。</p><p id="8785" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">env</code>:表示自定义环境变量的信息</p><p id="ba61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">parameter-store</code>:从AWS系统管理器参数存储(SSM)中检索自定义环境变量。将值存储为键:值对</p><p id="0f60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">BUCKET</code>:表示使用S3桶</p><p id="7024" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">/codebuild/piRoarcoder</code>:SSM参数命名约定，如<code class="fe md me mf lt b">/{serviceName}/{parameterName}</code></p><p id="bbe3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">代码构建有不同的阶段，但是我们只使用安装和构建。每个阶段都包含各自要运行的命令。</p><p id="236b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">install</code> : Sections运行命令来安装构建项目所需的所有必要工具</p><p id="73ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">安装Jekyll及其所有依赖项，因为我正在使用Jekyll静态网站生成器</p><p id="003d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">build</code>:运行构建项目所需命令的部分</p><p id="5092" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">jekyll build</code>:在不包含源代码的单独的folder _site中输出应用程序的生产就绪版本。</p><p id="9f00" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">aws s3 cp s3://ssh-keys-zain/encrypted_id_rsa $HOME/encrypted_id_rsa</code> —从我的S3桶中获取我的加密私有ssh密钥，并将其存储在容器中</p><p id="c4c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">aws kms decrypt — ciphertext-blob fileb://$HOME/encrypted_id_rsa — output text — query Plaintext | base64 — decode &gt; $HOME/decrypted_id_rsa</code>:解密加密密钥使用</p><p id="706f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">chmod 400 $HOME/decrypted_id_rsa</code>:授予密钥只读权限</p><p id="78ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">scp -r -oStrictHostKeyChecking=no -i $HOME/decrypted_id_rsa ./* pi@$PI_DNS:/var/www/roarcoder.dev/html/</code>:将当前目录下的所有内容安全地直接复制到我的虚拟主机Pi的html中。</p><p id="a38c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">rm $HOME/decrypted_id_rsa</code>:从容器中取出解密的密钥私钥</p><p id="1e82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">rm $HOME/encrypted_id_rsa</code>:从容器中取出加密密钥私钥</p><p id="b710" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第6.7步</strong></p><p id="e9c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从下拉菜单中选择<strong class="js iu">无工件</strong>。</p><p id="3565" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">工件是构建产生的输出。我们不想在AWS中保存它们，因此我们选择<strong class="js iu">无工件</strong>。buildspec文件中的命令行会将文件直接传输到Pi上。</p><p id="4d4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">向下滚动</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mr"><img src="../Images/697b429f0cf0df1d8ee62861c6a1678c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N1YpvvGylHIBGsaw6-aKjg.png"/></div></div></figure><p id="0b0a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">步骤6.8: </strong></p><p id="2b53" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">保留所有默认设置，并点击<strong class="js iu">创建构建项目</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ms"><img src="../Images/7e5bcd574356f7966e6fc4f5e09f7955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dnEq32eAODyu8wXHSVrD1A.png"/></div></div></figure><p id="5fbf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第七步:</strong></p><p id="27fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们不会在部署阶段使用任何东西，所以单击<strong class="js iu">跳过部署阶段。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mu"><img src="../Images/f81e9be25eae764d1668ecf17d642959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FiykzpQ29nmZNZ8VvM-Huw.png"/></div></div></figure><p id="3a5b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您将被要求确认，点击<strong class="js iu">跳过</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mv"><img src="../Images/60fb13a15fef3922f2234a66dd585763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85l_Ho5Nl8n3DXF6gCnZcQ.png"/></div></div></figure><p id="430c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第八步:</strong></p><p id="8258" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">查看管道，滚动到页面底部，点击<strong class="js iu">创建管道</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mw"><img src="../Images/bfdb9c13e8053a853d44e27a4d4a0d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSx0kktOdcX4ptc9L_BQKw.png"/></div></div></figure><p id="2096" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第九步:</strong></p><p id="44c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您的管道将被构建，执行将自动开始。我不得不停止执行死刑，因为我只是想让你看看。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mx"><img src="../Images/114765afe6a72168e9ba63e8ba912d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FP8laiXemnByWdfVU7k2Rg.png"/></div></div></figure><p id="9c99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，只要您提交对Github存储库的更改，这个管道就会自动触发。</p><p id="698a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过从您的私钥位置运行，将目录文件从您的计算机(客户端)安全地复制(<code class="fe md me mf lt b">scp</code>)到您的pi(主机):</p><p id="26d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设:您已经知道如何在客户机和主机之间设置ssh密钥</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="a436" class="lx ly it lt b gy lz ma l mb mc">scp -i your-private-key /path/to/website/folder/* pi@111.111.1.1:/var/www/html</span></pre><p id="93e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中:</p><p id="8f6c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">scp</code>:安全复印</p><p id="be69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">-i</code>:指定私钥</p><p id="2240" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">your-private-key</code>:您的私钥名称</p><p id="f04e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">/path/to/website/folder</code>:你网站的文件夹路径</p><p id="ecbd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">*</code> —文件夹内的所有文件</p><p id="a16e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">pi@111.111.1.1</code>:Pi的用户和Ip地址</p><p id="493d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">:</code> : ip地址和路径分隔符</p><p id="71c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">`<code class="fe md me mf lt b">/var/www/html</code> ` —内容将上传到的HTML目录的路径</p><p id="53ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果一切顺利，你应该看到你的网站上的ip地址111.111.1.1(这将是你自己的IP地址)</p><p id="a28f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">在Pi中设置SSL证书</strong></p><p id="947c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用Certbot来获取我们的SSL证书。如果您不熟悉Certbot:</p><blockquote class="my mz na"><p id="40a1" class="jq jr lp js b jt ju jv jw jx jy jz ka nb kc kd ke nc kg kh ki nd kk kl km kn im bi translated">Certbot是一个免费的开源软件工具，可以自动使用Let's加密手动管理的网站上的证书来启用HTTPS。</p></blockquote><p id="2b33" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.嘘进入你的pi</p><p id="3df1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.通过运行以下命令安装certbot</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="455d" class="lx ly it lt b gy lz ma l mb mc">apt-get install certbot</span></pre><p id="0cb1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.获得证书</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="db87" class="lx ly it lt b gy lz ma l mb mc">certbot certonly — standalone -d [your-domain-name]</span></pre><p id="6d5c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">代码解释:</strong></p><p id="2995" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">certbot</code>:生成证书的服务</p><p id="f66c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">certonly</code>:只领证，其他不领。因为certbot可以自己安装证书，但我不希望它对我的配置文件进行更改以启用SSL。我想自己进行配置更改。</p><p id="b399" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">— standalone</code> : Certbot将使用自己的web服务器来通过域的验证过程</p><p id="2146" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">-d</code>:指定域名的参数</p><p id="5d87" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">[your-domain-name]</code>:指定你的域名。例如:不带方括号的<code class="fe md me mf lt b">example.com </code>或<code class="fe md me mf lt b"><a class="ae lo" href="http://www.example.com" rel="noopener ugc nofollow" target="_blank">www.example.com</a></code></p><p id="da89" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.回答所有被问到的问题</p><p id="378d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.一旦生成，它将显示一段<strong class="js iu">重要提示</strong>并按它说的做。</p><p id="50e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.复制粘贴<code class="fe md me mf lt b">fullchain.pem</code>和<code class="fe md me mf lt b">privkey.pem</code>的路径。你很快就会需要它。</p><p id="88ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">7.转到<code class="fe md me mf lt b">/etc/nginx/sites-available</code>复制默认页面并将其重命名为您的域名</p><p id="7c83" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">8.转到站点-可用文件夹</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="f157" class="lx ly it lt b gy lz ma l mb mc">cd /etc/nginx/sites-available</span></pre><p id="8fff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">9.创建另一个页面</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="00a3" class="lx ly it lt b gy lz ma l mb mc">touch [your-domain-name]</span></pre><p id="8031" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">10.将<strong class="js iu">默认</strong>页面的内容复制到您新创建的页面</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="d9f6" class="lx ly it lt b gy lz ma l mb mc">cp default [your-domain-name]</span></pre><p id="452e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">11.找`<strong class="js iu">听80；</strong>`和`<strong class="js iu">server _ name[some-domain]</strong>`及其下输入:</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="c368" class="lx ly it lt b gy lz ma l mb mc">listen 443 ssl default_server;</span><span id="38ec" class="lx ly it lt b gy mt ma l mb mc">ssl_certificate [copy and past the line from step 6 that has fullchain.pem at the end]</span><span id="c3ff" class="lx ly it lt b gy mt ma l mb mc">ssl_certificate_key [copy and past the line from step 6 that has privkey.pem at the end]</span><span id="1178" class="lx ly it lt b gy mt ma l mb mc">root /var/www/[folder-where-you-uploaded-your-site]</span></pre><p id="42a2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">12.通过按下<strong class="js iu"> ESC </strong>并键入<code class="fe md me mf lt b">:wq</code>保存并退出文件</p><p id="46cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">13.运行以下命令，检查配置文件中是否有语法错误</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="76a8" class="lx ly it lt b gy lz ma l mb mc">sudo nginx -t</span></pre><p id="b30d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">代码解释</strong></p><p id="4781" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">nginx</code>:服务器</p><p id="215b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">-t</code>:测试</p><p id="e632" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你不应该收到任何错误</p><p id="0c13" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">14.重新加载Nginx</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="6b4f" class="lx ly it lt b gy lz ma l mb mc">sudo systemctl reload nginx</span></pre><p id="e1e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在哪里</p><p id="8d01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">systemctl</code>:控制服务管理器和systemd系统</p><p id="72f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">reload</code>:不停止服务器(用于避免停机)</p><p id="5822" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">nginx</code>:服务器名称</p><p id="259f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">15.通过运行以下命令在Pi上启用HTTPS(端口443 ):</p><pre class="kp kq kr ks gt ls lt lu lv aw lw bi"><span id="602a" class="lx ly it lt b gy lz ma l mb mc">sudo ufw allow 443</span></pre><p id="715f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">通过公共互联网访问Pi</strong></p><p id="662e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于您的Pi位于您的专用网络中，您无法使用当前配置从公共互联网连接到它。为此，路由器必须配置端口转发。</p><p id="1714" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">端口转发允许您在特定端口上将入站流量转发到您的专用网络，将它们连接到您的Pi的本地IP地址。每个路由器都不一样。</p><p id="1018" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.转到您的路由器IP地址</p><p id="9091" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.使用管理员凭据登录</p><p id="1bfb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.转到您的<strong class="js iu">动态域名服务器(DDNS) </strong>设置并启用它。对我来说，那是在互联网服务中</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ne"><img src="../Images/7f5b12faaf6b55fd39975a25dd8553a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FwrhfYGGtFw8-9J5rJEbfw.png"/></div></div></figure><p id="463b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.根据您的路由器，您将有一个提供商。我有DynDns.org和No-IP.com。我选择了DynDns.org，因为No-IP.com不支持我的路由器</p><p id="b9d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.注册服务并在DDNS设置中输入详细信息，如上图所示。</p><p id="87a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.点击<strong class="js iu">保存</strong>。</p><p id="2c71" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">7.转到端口转发并启用以下端口</p><ul class=""><li id="6fec" class="la lb it js b jt ju jx jy kb lc kf ld kj le kn lf lg lh li bi translated">SSH的端口22</li><li id="9966" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">HTTP的端口80</li><li id="a12b" class="la lb it js b jt lj jx lk kb ll kf lm kj ln kn lf lg lh li bi translated">HTTPS的443端口</li></ul><p id="c4b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是如何转发端口22，其他类似</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nf"><img src="../Images/a677bb0c3f2e1f048260786c2421cd10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-oIP6tzRTTqXZq7ldRgLew.png"/></div></div></figure><p id="768d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">Mapping Name</code>:给你的端口起个名字</p><p id="57f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">Application</code>:协议名(SSH为SecureShellServer，HTTPS为SecureWebServer，HTTP为WebServer)</p><p id="d106" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe md me mf lt b">Internal Host</code>:设备名称(您的Pi)</p><p id="f10c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，点击<strong class="js iu">保存</strong>。</p><p id="8cab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，您的端口映射部分应该如下所示</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/924c5a8d99050b77cfdcb9bf02f52436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lCrU-gQr8ce0MlH6OBAyLw.png"/></div></div></figure><p id="c552" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就是这样。现在你可以通过公共互联网访问你的网站/博客。</p><p id="9484" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了测试它，连接到您的<strong class="js iu">家庭网络WIFI </strong>，并在浏览器中输入您的<strong class="js iu"> Pi的私有IP </strong>地址。</p><p id="2f0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要从公共互联网进行测试，请断开您家中的WIFI，并在URL中输入<code class="fe md me mf lt b">[hostname].[domainName]</code>，您应该会看到您上传到Pi的<code class="fe md me mf lt b">index.html</code>。</p><p id="42c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">结论</strong></p><p id="6492" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然网络不是我的强项，但这个项目给了我更多的理解和信心。</p><p id="c2ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果它对你不起作用，或者你正面临任何问题，请随时联系我，我会帮助你。</p></div></div>    
</body>
</html>