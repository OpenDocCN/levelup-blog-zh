<html>
<head>
<title>Analyzing Donald Trump and Joe Biden Tweets using Natural Language Processing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自然语言处理分析唐纳德·特朗普和乔·拜登的推文</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/analyzing-donald-trump-and-joe-biden-tweets-using-natural-language-processing-c6a357b11d68?source=collection_archive---------12-----------------------#2020-06-23">https://levelup.gitconnected.com/analyzing-donald-trump-and-joe-biden-tweets-using-natural-language-processing-c6a357b11d68?source=collection_archive---------12-----------------------#2020-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f3f0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5个月后，美国选民将前往投票站，选择他们的下一任总统。推定提名人——唐纳德·特朗普(Donald Trump)和乔·拜登(Joe Biden)一直在与公众接触，在Twitter等社交媒体平台上宣传他们的政治议程，以赢得选票。这篇文章将使用一种叫做自然语言处理的机器学习技术来分析特朗普和拜登的推文。</p><p id="277e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在文章中使用的python代码笔记本可以在这里<a class="ae ko" href="https://github.com/ocesteban/gomachinelearning/blob/master/DonaldTrump_JoeBiden_Tweets.ipynb" rel="noopener ugc nofollow" target="_blank">找到</a>，在这里找到<a class="ae ko" href="https://github.com/gomachinelearning/Blogs/blob/master/Natural_Language_Processing_Trump_and_Biden_Tweets.ipynb" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="deef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">只要你有必要的安全密钥，你就可以从Twitter APIs下载推文。你可以在https://developer.twitter.com/en/apply-for-access<a class="ae ko" href="https://developer.twitter.com/en/apply-for-access" rel="noopener ugc nofollow" target="_blank">的推特上申请自己的钥匙。一旦你收到了密钥，在这个</a><a class="ae ko" href="https://github.com/ocesteban/gomachinelearning/blob/master/DonaldTrump_JoeBiden_Tweets.ipynb" rel="noopener ugc nofollow" target="_blank">代码</a>中键入它们，并在Python中运行它来下载唐纳德·特朗普和乔·拜登的推文。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="1139" class="ky kz it ku b gy la lb l lc ld">import twitter<br/>import json</span><span id="7194" class="ky kz it ku b gy le lb l lc ld"># Note: Go to <a class="ae ko" href="https://developer.twitter.com/en/apply-for-access" rel="noopener ugc nofollow" target="_blank">https://developer.twitter.com/en/apply-for-access</a> to get your own secret keys.</span><span id="7e35" class="ky kz it ku b gy le lb l lc ld">api = twitter.Api(consumer_key = '---',<br/>                      consumer_secret = '---',<br/>                      access_token_key = '---',<br/>                      access_token_secret = '---',cache=None, tweet_mode='extended')</span></pre><p id="d8f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在2020年6月19日运行了代码，能够检索到唐纳德·特朗普和乔·拜登发布的大约3200条推文。我上传了他们的推文<a class="ae ko" href="https://github.com/gomachinelearning/Blogs/blob/master/DonaldTrumpTweets.txt" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae ko" href="https://github.com/gomachinelearning/Blogs/blob/master/JoeBidenTweets.txt" rel="noopener ugc nofollow" target="_blank">这里</a>和他们的Python列表对象pickles <a class="ae ko" href="https://github.com/gomachinelearning/Blogs/blob/master/DonaldTrumpTweets.pickle" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae ko" href="https://github.com/gomachinelearning/Blogs/blob/master/JoeBidenTweets.pickle" rel="noopener ugc nofollow" target="_blank">这里</a></p><p id="6d85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们加载他们的推文并显示前500个字符:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="0d9f" class="ky kz it ku b gy la lb l lc ld">import requests<br/>candidates = ['DonaldTrump', 'JoeBiden']<br/>data = {}<br/>for i, c in enumerate(candidates):<br/>    url = "<a class="ae ko" href="https://raw.githubusercontent.com/gomachinelearning/Blogs/master/" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/gomachinelearning/Blogs/master/</a>" + c + "Tweets.txt"<br/>    req = requests.get(url)<br/>    data[c] = req.text</span><span id="9539" class="ky kz it ku b gy le lb l lc ld"># check the sizes: Count the number of characters<br/>print("Verify the dictionary variables are not empty. Print total number of characters in the variables:\n")<br/>print("Donald Trump: {} , Joe Biden: {}".format(len(data['DonaldTrump']) ,len(data['JoeBiden'])))</span><span id="1d16" class="ky kz it ku b gy le lb l lc ld">def print_first_n_characters(n):<br/>  if n == -1:<br/>    print('Printing full tweets of each candidate \n'.format(n) )<br/>  else:<br/>    print('\n\nPrinting the first {} characters of tweets of each candidate \n'.format(n) )<br/>    <br/>  print('DONALD TRUMP: \n ' + data['DonaldTrump'][0:n])  <br/>  print('\n\nJOE BIDEN: \n ' + data['JoeBiden'][0:n])</span><span id="47bb" class="ky kz it ku b gy le lb l lc ld">print_first_n_characters(500)</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/19aa34a3bc3c69e2a83f5b529f736e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XIDVsoPewXiOPkb7NHQsnw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图1:打印特朗普和拜登的样本推文</figcaption></figure><p id="4e06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个有趣的观察是，总体而言，乔·拜登的推特比特朗普的长。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="a462" class="ky kz it ku b gy la lb l lc ld">import pickle<br/>import cloudpickle as cp<br/>lst_donald_trump_tweets=[]<br/>lst_joe_biden_tweets=[]</span><span id="94fb" class="ky kz it ku b gy le lb l lc ld">from urllib.request import urlopen<br/>lst_donald_trump_tweets = cp.load(urlopen("<a class="ae ko" href="https://raw.githubusercontent.com/gomachinelearning/Blogs/master/DonaldTrumpTweets.pickle" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/gomachinelearning/Blogs/master/DonaldTrumpTweets.pickle</a>"))<br/>lst_joe_biden_tweets = cp.load(urlopen("<a class="ae ko" href="https://raw.githubusercontent.com/gomachinelearning/Blogs/master/JoeBidenTweets.pickle" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/gomachinelearning/Blogs/master/JoeBidenTweets.pickle</a>"))<br/>print("AVerage Number of characters per tweet:\n")<br/>print("Donald Trump: {} , Joe Biden: {}".format(round(len(data['DonaldTrump'])/len(lst_donald_trump_tweets)) , round(len(data['JoeBiden'])/len(lst_joe_biden_tweets))))</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/b099ae43cdb0f0ac63ec02e6fb351d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*A4sgZ_fSIC9FHc0vRQWNNQ.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图2:平均而言，拜登的每条推文比特朗普的长</figcaption></figure><h1 id="a052" class="ls kz it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">可视化数据</strong></h1><p id="5aa6" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated"><strong class="js iu"> Wordle </strong>又称词云或标签云，是以标签的形式对文本数据的可视化表示。标签通常是数据中的一个单词，其重要性以字体大小和颜色来表示。</p><p id="d0a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Wordle有自己的优势和劣势，我也听到了一些关于它的批评。但是现在让我们使用它来快速浏览一下，了解一下我们正在处理的是什么类型的数据。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="3670" class="ky kz it ku b gy la lb l lc ld">from wordcloud import WordCloud<br/>import matplotlib.pyplot as plt<br/>wc = WordCloud( background_color="white", colormap="Dark2", max_font_size=150, random_state=42)</span><span id="5283" class="ky kz it ku b gy le lb l lc ld">def show_word_cloud(data, candidate):<br/>  text = data[candidate]<br/>  wordcloud = WordCloud().generate(text)<br/>  plt.imshow(wordcloud, interpolation='bilinear')<br/>  plt.axis("off")<br/>  plt.show()<br/>show_word_cloud(data,'DonaldTrump')<br/>show_word_cloud(data,'JoeBiden')</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/3270913993caf5e4b34d8ec02e628289.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*zujTKMUCSP851W3RxyxpBg.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图3:特朗普的原始推文</figcaption></figure><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e35d5033eb7abec6d9564a49e45c6732.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*YdEg-mRvDAQViBfgarz_gQ.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图4:拜登的原始推文</figcaption></figure><p id="8b94" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">哦，我们显然需要清理数据。例如，“https”在图中非常突出，但在我们的分析中实际上并不重要。</p><h1 id="57c8" class="ls kz it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">停止字</strong></h1><p id="c27f" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated"><strong class="js iu"> <em class="mw">停用词</em> </strong>指的是一种语言中的常用词——这里指的是英语——比如<em class="mw"> a、the、is、at、on </em>等。通常情况下，它们不能提供额外的数据洞察力，因此在我们开始分析之前必须从数据中删除。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="ae05" class="ky kz it ku b gy la lb l lc ld">from sklearn.feature_extraction.text import CountVectorizer<br/>cv = CountVectorizer(stop_words='english')</span></pre><h1 id="eeb4" class="ls kz it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">最常用的词</h1><p id="830e" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">一旦<em class="mw">停用词</em>被过滤掉，我们可以使用几个NLP工具来统计最常用的词——其中之一是Python中的文档术语矩阵(DLM)对象。</p><p id="429d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">DLM是一个数学矩阵，它描述了文本文档中单词出现的频率。我们将把矩阵中的行显示为tweets的集合，列将显示单词。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="5129" class="ky kz it ku b gy la lb l lc ld">import pandas as pd</span><span id="a46e" class="ky kz it ku b gy le lb l lc ld">from sklearn.feature_extraction.text import CountVectorizer<br/>cv = CountVectorizer(stop_words='english')</span><span id="ee12" class="ky kz it ku b gy le lb l lc ld">dict_dtm={}<br/>  <br/>def document_term_matrix(strTweets):  <br/>  data_cv = cv.fit_transform([strTweets]) <br/>  return pd.DataFrame(data_cv.toarray(), columns=cv.get_feature_names())<br/>  <br/>dict_dtm['DonaldTrump'] = document_term_matrix(data['DonaldTrump'])<br/>dict_dtm['JoeBiden'] = document_term_matrix(data['JoeBiden'])<br/>print('Donald Trump Tweets Document Term Matrix:\n')<br/>print(dict_dtm['DonaldTrump'])<br/>print('\n\n')<br/>print('Joe Biden Tweets Document Term Matrix:\n')<br/>print(dict_dtm['JoeBiden'])</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/7a366c82da49959b991baa4829c34785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*1jC5C2jHAC3IoqyjRjxjrg.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图5:文档术语矩阵</figcaption></figure><p id="f75a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们去掉了<em class="mw">停用词</em>，但是DTM仍然是乱码。我们仍然需要做大量的清理工作。</p><p id="1af7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们打印每个候选人的前20个单词:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="62a5" class="ky kz it ku b gy la lb l lc ld">def top_n_words(candidate,n):</span><span id="5b77" class="ky kz it ku b gy le lb l lc ld">top_dict = {}<br/>  data = dict_dtm[candidate]<br/>  for c in data.columns:<br/>    top_dict[c]=data[c][0]<br/>  sort_orders = sorted(top_dict.items(), key=lambda x: x[1], reverse=True)<br/>  for i in sort_orders[0:n]:<br/>    print(i[0], i[1])</span><span id="cdea" class="ky kz it ku b gy le lb l lc ld">print('Donald Trump:\n')<br/>top_n_words('DonaldTrump',20)<br/>print('\n\nJoe Biden:\n')<br/>top_n_words('JoeBiden',20)</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi my"><img src="../Images/f95714ce92697777cfdcd1726d206a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h5IhpGyUAjbRBZj_SOIp_g.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图6:最常用的单词</figcaption></figure><p id="4c7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些话非常有希望，我们实际上可以得到一些分析，并得出一些有意义的见解。尽管如此，我们还是需要清理一下。</p><h1 id="13e5" class="ls kz it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">数据清理</h1><p id="58d0" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">这里有一些我们可以在推特上完成的数据清理任务。我们可以删除:网址，数字，标点符号，一些文本像<em class="mw"> amp </em>和<em class="mw"> rt </em>，换行符等等。</p><p id="a827" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，我们可以将分析限制在候选人最近推文的前10万个字符。我们希望分析与当前事件相关的推文。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="b307" class="ky kz it ku b gy la lb l lc ld">import re<br/>import string</span><span id="e53c" class="ky kz it ku b gy le lb l lc ld">def clean_tweets(tweets):<br/>    '''Make tweetslowercase, remove tweetsin square brackets, remove punctuation and remove words containing numbers.'''<br/>    tweets= tweets.lower()<br/>    tweets= re.sub('\[.*?\]', '', tweets)<br/>    tweets= re.sub('[%s]' % re.escape(string.punctuation), '', tweets)<br/>    tweets= re.sub('\w*\d\w*', '', tweets)<br/>    tweets= re.sub('[‘’“”…]', '', tweets)<br/>    tweets= re.sub('\n', '', tweets)<br/>    tweets= re.sub('\r', ' ', tweets)    <br/>    tweets = re.sub(r'^https?:\/\/.*[\r\n]*', '', tweets, flags=re.MULTILINE)<br/>    tweets = re.sub(r'http\S+', '', tweets)<br/>    tweets = tweets.replace(' amp ','')<br/>    tweets = tweets.replace(' rt ','')<br/>    tweets = tweets.replace('realdonaldtrump','')<br/>    return tweets</span><span id="a3f9" class="ky kz it ku b gy le lb l lc ld">clean_data={}<br/>clean_data['DonaldTrump'] = clean_tweets(data['DonaldTrump'])[0:100000]<br/>clean_data['JoeBiden'] = clean_tweets(data['JoeBiden'])[0:100000]</span><span id="4955" class="ky kz it ku b gy le lb l lc ld">len(clean_data['DonaldTrump']) ,len(clean_data['JoeBiden'])</span><span id="d3f6" class="ky kz it ku b gy le lb l lc ld">#(100000, 100000)</span></pre><p id="6a6c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们比较一个原始数据和干净数据的样本。以下是特朗普在数据清理前后的样本数据:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="8bb3" class="ky kz it ku b gy la lb l lc ld">print('Print 200 characters only:\n')<br/>print('Donald Trump raw data:\n')<br/>print(data['DonaldTrump'][0:200])<br/>print('\n\nDonald Trump clean data:\n')<br/>print(clean_data['DonaldTrump'][0:200])</span><span id="b89f" class="ky kz it ku b gy le lb l lc ld">print('\n\n')</span><span id="5a14" class="ky kz it ku b gy le lb l lc ld">print('Joe Biden raw data:\n')<br/>print(data['JoeBiden'][0:200])<br/>print('\n\nJoe Biden clean data:\n')<br/>print(clean_data['JoeBiden'][0:200])</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mz"><img src="../Images/e35d30fff921639257d4e61cd7d9b58c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*apD_9kKDhFBm2IIaCn9I8w.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图7:数据清理前后的Donald Trump样本数据</figcaption></figure><p id="7e90" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">拜登数据清洗前后的样本数据:</p><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi na"><img src="../Images/22503b9e1a27edd896ac5ea08bfa3372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tju6I6XvYVXZX5p6KdMAtA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图8:数据清理前后的Joe Biden样本数据</figcaption></figure><p id="6eb8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们用干净的数据展示这个世界</p><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/9da6986ae8f389f74db134547a6c7951.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*QbFeTD9Yg-9U_Y4dPErs-A.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图9:唐纳德·特朗普使用干净的数据</figcaption></figure><p id="3c20" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最前面和中间是“棒”字。这很可能是因为特朗普的竞选口号<em class="mw">让美国再次伟大</em>或<em class="mw">让美国保持伟大</em>。特朗普似乎没有经常在他的推文中提到乔·拜登。</p><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/760c8c66e6087d5d12aa7209483b2bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*mRgzE_p5436A_yWoz3H_bA.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图10: Joe Binden Worlde使用干净的数据</figcaption></figure><p id="656f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">乔·拜登在他的推文中似乎更经常提到唐纳德·特朗普，这可以在wordle中看到。拜登经常在他的推文中使用危机这个词，这很可能与疫情冠状病毒有关。</p><p id="3c6f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们用干净的数据再次打印最常用的单词。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="4d69" class="ky kz it ku b gy la lb l lc ld">dict_dtm['DonaldTrump'] = document_term_matrix(clean_data['DonaldTrump'])<br/>dict_dtm['JoeBiden'] = document_term_matrix(clean_data['JoeBiden'])</span><span id="7c13" class="ky kz it ku b gy le lb l lc ld">print('Donald Trump:\n')<br/>top_n_words(dict_dtm['DonaldTrump'],20)<br/>print('\n\nJoe Biden:\n')<br/>top_n_words(dict_dtm['JoeBiden'],20)</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nc"><img src="../Images/2175eec7cab112e37270e97ed62a9e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8yZtcNdE7Q_d5BvC1aLnA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图11:使用干净数据的最常用单词</figcaption></figure><p id="220d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与我们的第一次运行相比，这显然要好得多。我们可以在这里看到很多与这个国家目前发生的事情相关的词汇。</p><h1 id="256b" class="ls kz it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">情感分析</h1><p id="7393" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">情绪分析的目标之一是开发能够解释人类情绪的机器——模仿人类体验和回应他人情绪的方式。</p><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b21236a8ea14dca6257c52b78715327b.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*8OQu8LOrVTi3OVp93AGJ7w.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">注:图片复制自<a class="ae ko" href="https://blogeduonix-2f3a.kxcdn.com/wp-content/uploads/2018/12/44ceff.jpg" rel="noopener ugc nofollow" target="_blank">https://blogeduonix-2f3a . kx cdn . com/WP-content/uploads/2018/12/44 ceff . jpg</a></figcaption></figure><p id="3a76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用<a class="ae ko" href="https://textblob.readthedocs.io/en/dev/quickstart.html" rel="noopener ugc nofollow" target="_blank"> TextBlob </a>来预测推文中的情绪。TextBlob是一个用于处理文本数据的Python库，它提供了一个用于情感分析的API。根据TextBlob文档，给定一个文本数据，情感API返回两个属性- <strong class="js iu"> <em class="mw">极性</em> </strong>和<strong class="js iu"> <em class="mw">主观性</em> </strong>。<em class="mw">极性</em>告知文本是正还是负。其值范围从-1.0(非常负)到1.0(非常正)。<em class="mw">主观性</em>讲述文字是客观的还是主观的。其值从0(非常客观)到1.0(非常主观)。首先，让我们测试TextBlob在给定这些示例语句集的情况下将如何执行:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="4734" class="ky kz it ku b gy la lb l lc ld">statements=[]<br/>statements.append("I will vote for that mayor again")<br/>statements.append("The senator is the worst politician ever!")<br/>statements.append("Make America Great Again")<br/>statements.append("Keep America Great")<br/>statements.append("OUR BEST DAYS STILL LIE AHEAD")<br/>statements.append("The earth revolves around the sun")<br/>statements.append("The sun revolves around the earth")<br/>statements.append("The sun revolves around the earth")<br/></span><span id="7353" class="ky kz it ku b gy le lb l lc ld">lst_sentiment_analysis=[]<br/>for statement in statements:<br/>  blob = TextBlob(statement)<br/>  print(statement + ' ' + str(blob.sentiment))</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ne"><img src="../Images/3a7475293a81267e0726002d5840d788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wys-S6dzhSye4iP1xpIvDw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图12: TextBlob评估这些样本文本的情感</figcaption></figure><p id="9ec8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意第一个和第二个例子之间的区别。在第二句话中加上“好”这个词使这句话变得肯定，也变得主观。第三个例子非常消极，也非常主观。</p><p id="be87" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">唐纳德·特朗普的竞选口号:<em class="mw">让美国再次伟大</em>和<em class="mw">保持美国伟大</em>与乔·拜登的<em class="mw">相比，不那么积极，更主观</em>。(注:我不能100%确定这是不是拜登的口号，但这是我在他的竞选网站上看到的)。</p><p id="ca2d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">“<em class="mw">地球绕太阳转</em>这个例子是中性的，非常客观。但是，TextBlob不能告诉我们一个语句是否为真，请看最后一个例子。</p><p id="6c8c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们对特朗普和拜登最近的200条推文进行情感分析，因为它们更多地涉及当前事件。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="ea09" class="ky kz it ku b gy la lb l lc ld">import pickle<br/>import cloudpickle as cp<br/>lst_donald_trump_tweets=[]<br/>lst_joe_biden_tweets=[]</span><span id="611b" class="ky kz it ku b gy le lb l lc ld">from urllib.request import urlopen<br/>lst_donald_trump_tweets = cp.load(urlopen("<a class="ae ko" href="https://raw.githubusercontent.com/gomachinelearning/Blogs/master/DonaldTrumpTweets.pickle" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/gomachinelearning/Blogs/master/DonaldTrumpTweets.pickle</a>"))<br/>lst_joe_biden_tweets = cp.load(urlopen("<a class="ae ko" href="https://raw.githubusercontent.com/gomachinelearning/Blogs/master/JoeBidenTweets.pickle" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/gomachinelearning/Blogs/master/JoeBidenTweets.pickle</a>"))<br/>len(lst_donald_trump_tweets), len(lst_joe_biden_tweets)</span><span id="f38f" class="ky kz it ku b gy le lb l lc ld">lst_donald_trump_polarity = []<br/>lst_donald_trump_subjectivity  = []</span><span id="f300" class="ky kz it ku b gy le lb l lc ld">lst_joe_biden_polarity = []<br/>lst_joe_biden_subjectivity  = []</span><span id="4248" class="ky kz it ku b gy le lb l lc ld">#number of tweets to analyze<br/>n=200</span><span id="a46c" class="ky kz it ku b gy le lb l lc ld">def sentiment_analysis(lst_tweets,lst_polarity, lst_subjectivity):<br/>  for tweet in lst_tweets[0:n]:<br/>    blob = TextBlob(clean_tweets(tweet))<br/>    lst_polarity.append(blob.polarity)<br/>    lst_subjectivity.append(blob.subjectivity)</span><span id="445d" class="ky kz it ku b gy le lb l lc ld">sentiment_analysis(lst_donald_trump_tweets,lst_donald_trump_polarity,lst_donald_trump_subjectivity) <br/>sentiment_analysis(lst_joe_biden_tweets,lst_joe_biden_polarity,lst_joe_biden_subjectivity)</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nf"><img src="../Images/4fc2e8b06133fb25ef7f5bcd67282ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HGUSfOA_VhLiWoafDlXI5w.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图13:特朗普和拜登最近的200条推文</figcaption></figure><p id="5219" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">唐纳德·特朗普最近的推文聚集在图表的右侧，实证主义和主观性越来越强。而乔·拜登的推文排名垫底。他们更加中立和客观。</p><p id="3bdf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们用方框图对比一下他们推文的极性和主观性。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="b4e1" class="ky kz it ku b gy la lb l lc ld">import pandas as pd<br/>import numpy as np</span><span id="c9d9" class="ky kz it ku b gy le lb l lc ld">df = pd.DataFrame(np.c_[np.array(lst_donald_trump_polarity),np.array(lst_joe_biden_polarity)], columns=['Donald Trump','Joe Biden'])<br/>df.plot.box(grid='True', title='Polarity of Trump and Biden Tweets')</span><span id="6cbe" class="ky kz it ku b gy le lb l lc ld">df = pd.DataFrame(np.c_[np.array(lst_donald_trump_subjectivity),np.array(lst_joe_biden_subjectivity)], columns=['Donald Trump','Joe Biden'])</span><span id="70f5" class="ky kz it ku b gy le lb l lc ld">df.plot.box(grid='True', title='Subjectivity of Trump and Biden Tweets')</span></pre><p id="a1f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">相比拜登，特朗普一直在发布更多积极的推文。但拜登倾向于发布更极端的极性推文。这意味着拜登倾向于发布更多非常积极和非常消极的帖子。</p><p id="385a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与拜登相比，特朗普也表现出了更广泛的主观性。</p><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ng"><img src="../Images/d844d6fcd38134eff4ccf1c8ca2e71fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2jTDr52tAvcZI_2s04J-w.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图14:唐纳德·特拉姆和乔·拜登最近的推文</figcaption></figure><p id="bf7b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与拜登相比，特朗普最近的帖子更积极，也更主观。</p><h1 id="e974" class="ls kz it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">基于潜在狄利克雷分配的主题建模</h1><p id="8c4d" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">在这一部分，我们将从每位候选人的一组推文中发现抽象主题。我会将他们的推文分成3组，每组1000个字符，并使用LDA来预测主题。我们将看到候选人如何随着时间的推移改变他们推文的主题。</p><p id="5868" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">词汇化</strong>是将单词形式的变化组合在一起的过程，这样它们就可以作为单个单词进行分析。例如，<strong class="js iu"> <em class="mw">行走</em> </strong>，<strong class="js iu"> <em class="mw">行走</em> </strong>，<strong class="js iu"> <em class="mw">行走</em> </strong>将组合为一个，分析为<strong class="js iu"> <em class="mw">行走。</em> </strong>我们将使用名为<strong class="js iu"> WordNetLemmatizer </strong>的Python自然语言工具包(ntlk)包对tweets进行预处理和lemmatize。</p><p id="8811" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">LDA主题建模中另一个有用的技术是在文档中省去除名词和形容词之外的要处理的单词。在下面的代码中，<em class="mw"> NN </em>是名词的约定，<em class="mw"> JJ </em>是形容词的约定。下面一行代码标识了推文中的名词和形容词。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="efb9" class="ky kz it ku b gy la lb l lc ld">pos[:2] = ‘NN’ or pos[:2] == ‘JJ’</span></pre><p id="493e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是处理数据和生成主题的代码。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="af48" class="ky kz it ku b gy la lb l lc ld">#install gensim as needed<br/>#!pip install gensim<br/>from gensim import matutils, models<br/>import scipy.sparse</span><span id="1c47" class="ky kz it ku b gy le lb l lc ld">from nltk.stem.porter import PorterStemmer<br/>from nltk.stem import WordNetLemmatizer <br/>lemmatizer = WordNetLemmatizer()<br/>porter = PorterStemmer()<br/>from nltk import word_tokenize, pos_tag</span><span id="3829" class="ky kz it ku b gy le lb l lc ld">def get_corpus(dtm):  <br/>  sparse_counts = scipy.sparse.csr_matrix(dtm)<br/>  corpus = matutils.Sparse2Corpus(sparse_counts)<br/>  return corpus</span><span id="fc00" class="ky kz it ku b gy le lb l lc ld"># tokenize nouns and adjectives only<br/>def nouns_adjectives(text):<br/>    is_noun_adj = lambda pos: pos[:2] == 'NN' or pos[:2] == 'JJ'<br/>    tokenized = word_tokenize(text)<br/>    nouns_adj = [lemmatizer.lemmatize(word) for (word, pos) in pos_tag(tokenized) if is_noun_adj(pos)]     <br/>    return ' '.join(nouns_adj)</span><span id="f861" class="ky kz it ku b gy le lb l lc ld">def generate_topics(str_tweets):<br/>  dtm = document_term_matrix(str_tweets)<br/>  corpus = get_corpus(dtm)  <br/>  id2word = dict((v, k) for k, v in cv.vocabulary_.items())<br/>  lda = models.LdaModel(corpus=corpus, id2word=id2word, num_topics=1, passes=100,minimum_probability =0.5)<br/>  return lda</span></pre><p id="e7db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们将推文分成3组，每组1000个字符，并打印组内的主题。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="e5fa" class="ky kz it ku b gy la lb l lc ld">import matplotlib.gridspec as gridspec<br/>import math<br/>import nltk<br/>nltk.download('wordnet')<br/>from nltk.stem import WordNetLemmatizer <br/>lemmatizer = WordNetLemmatizer()<br/>def print_topics(candidate,index_from,index_to): <br/>  n_topics = 1<br/>  dtm = document_term_matrix(nouns_adjectives(clean_data[candidate][index_from:index_to]))<br/>  corpus =get_corpus(dtm)<br/>  id2word = dict((v, k) for k, v in cv.vocabulary_.items())</span><span id="f95e" class="ky kz it ku b gy le lb l lc ld">lda = models.LdaModel(corpus, num_topics = n_topics, id2word = id2word, passes=50)<br/>  topics  = [[topic for topic,_ in lda.show_topic(topic_id, topn=5)] for topic_id in range(lda.num_topics)]<br/>  top_betas = [[beta for _,beta in lda.show_topic(topic_id, topn=5)] for topic_id in range(lda.num_topics)]<br/>  print(topics)       <br/>  <br/>print_topics('DonaldTrump',0,1000)<br/>print_topics('JoeBiden',0,1000)</span><span id="7471" class="ky kz it ku b gy le lb l lc ld">print_topics('DonaldTrump',1000,2000)<br/>print_topics('JoeBiden',1000,2000)</span><span id="00e9" class="ky kz it ku b gy le lb l lc ld">print_topics('DonaldTrump',2000,3000)<br/>print_topics('JoeBiden',2000,3000)</span></pre><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nh"><img src="../Images/9291c4b44615cc3d677374e5e03c8124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3BwKFL1sXUmWxGh4bGo6IA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图15:随着时间的推移改变主题。组1是最新的。第三组是最老的。</figcaption></figure><h1 id="52a2" class="ls kz it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">结论</strong></h1><p id="1409" class="pw-post-body-paragraph jq jr it js b jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn im bi translated">这篇文章的目的是展示唐纳德·特朗普总统和前副总统乔·拜登在使用机器学习的推文中的差异。我故意推迟对结果做出自己的解释，因为我希望尽可能客观。我将让读者自己做出解释。</p></div></div>    
</body>
</html>