<html>
<head>
<title>How to keep your build pipeline from breaking using Git-Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Git-Hooks防止构建管道中断</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-keep-your-build-pipeline-from-breaking-using-git-hooks-f30c1d7086cc?source=collection_archive---------14-----------------------#2020-01-27">https://levelup.gitconnected.com/how-to-keep-your-build-pipeline-from-breaking-using-git-hooks-f30c1d7086cc?source=collection_archive---------14-----------------------#2020-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ff6030259416cbe63c58f1f19b26b6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BUHbumkl2CgNblt1"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@jjying?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> JJ英</a>在<a class="ae kf" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="5791" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在持续集成和部署的世界中，理想的情况是软件可以在任何时候部署到生产环境中，供用户查看。</p><p id="ee1f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，如果你的管道破裂，这是不可能实现的。</p><p id="1253" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">管道破裂有许多不同的原因。这可能是在检查Kubernetes Pod准备情况的冒烟测试期间的超时。由于REST端点返回了错误的响应代码，用另一个团队的服务对您的服务进行端到端测试可能会失败。甚至有可能是有人故意中止了构建。然而，正如大多数开发人员所知，管道中断的主要原因是因为测试中断。</p><p id="c708" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这可以通过采取一些预防措施来补救，例如进行测试驱动的开发，并在推送任何代码之前运行测试套件，以确保更改没有任何破坏性的副作用，并且所有测试都是绿色的…即使更改只是文本更改，您也不会知道。</p><p id="137f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不幸的是，我们都是人，我们认为我们知道什么时候我们的改变会导致任何事情发生。我们有时会在没有运行测试的情况下进行回购，或者更可能的是，我们忘记了运行测试。</p><p id="b6df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输入<a class="ae kf" href="https://githooks.com/" rel="noopener ugc nofollow" target="_blank"> Git-hooks </a></p><p id="b9ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Git Hooks是一个工具，允许您在Git工作流的各个步骤之前自动运行某些命令或任务。可用的选项有提交前、推送前、拉取前、提交后、拉取后等等。</p><p id="79f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我和我的团队使用这个工具来确保我们不会在推送之前，通过在本地运行我们的两个主要管道任务(运行测试套件和林挺代码)而意外地破坏构建。</p><p id="863b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它的工作方式是每个Git存储库都有一个. git/hooks目录。默认情况下，此目录中有多个。您可以编写的各种钩子的示例文件。您只需要创建您的文件，添加正确的执行权限，并将您的文件以正确的名称放入这个目录。</p><p id="ff11" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是一个在Django项目中运行单元测试的预推送git挂钩示例:</p><figure class="le lf lg lh gt ju"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="38bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Kotlin-Spring服务运行测试和lints代码的另一个例子:</p><figure class="le lf lg lh gt ju"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="e10b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在您的测试套件运行和您的林挺运行并通过几分钟后，您的代码将被推送。</p><p id="6fc1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">万一失败，您的代码将不会被推送，您将能够修复您的代码并重试。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lk"><img src="../Images/83d977d27e49da19dc7371f1cc19a2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hmFC-5w7DjRQdXE4"/></div></div></figure><p id="7c7a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你真的真的真的真的确定你的代码很好，不会破坏任何东西，因为你做了测试驱动开发，并且在提交前1分钟刚刚运行了测试套件，你总是可以做一个<code class="fe ll lm ln lo b"><strong class="ki iu">git push --no-verify</strong></code>，git钩子将被跳过。</p><p id="4fae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读，并享受永远不再打破构建！</p></div></div>    
</body>
</html>