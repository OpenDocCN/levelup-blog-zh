# Python ä¸­çš„è®¾è®¡æ¨¡å¼:å•ä¾‹æ¨¡å¼

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/design-patterns-in-python-singleton-pattern-f76dc26281f8>

## Python ä¸­ Singleton è®¾è®¡æ¨¡å¼çš„å®ç°

å•ä½“è®¾è®¡æ¨¡å¼æ˜¯åˆ›é€ æ€§è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚ä»å•ä¾‹ç±»ä¸­åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚è¿™æ˜¯è¿™ç§è®¾è®¡æ¨¡å¼æœ€æ˜¾è‘—çš„ç‰¹ç‚¹ã€‚

![](img/3afed31abe2512b97ac58c826fdad45f.png)

ç…§ç‰‡ç”±[åœ¨](https://unsplash.com/@callmehangry?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šå«æˆ‘ hangry ğŸ‡«ğŸ‡·

## åˆ›é€ æ€§çš„è®¾è®¡æ¨¡å¼

å¯¹è±¡åˆ›å»ºæ˜¯åŸºäº OOP çš„ç³»ç»Ÿä¸­æœ€å¸¸è§çš„ä»»åŠ¡ä¹‹ä¸€ã€‚è¿™æ˜¯ä¸€ä¸ªæ˜‚è´µçš„è¿‡ç¨‹ã€‚ä¸€ä¸ªå¯¹è±¡ä¸å…¶ä»–å¯¹è±¡çš„å…³ç³»ã€å¯¹è±¡çš„ä»»åŠ¡ã€è€ƒè™‘å¯é‡ç”¨æ€§çš„å› ç´ ã€å¯¹è±¡æ‰€å¤„çš„çŠ¶æ€åŠå…¶å¯¹è¿™äº›çŠ¶æ€çš„ååº”ç­‰ç­‰ã€‚ï¼Œä½¿è¯¥å¯¹è±¡çš„ç»“æ„å˜å¾—å¤æ‚ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°æ—¶å€™ï¼Œå¯¹è±¡åˆ›å»ºè¿‡ç¨‹æ˜¯**è€Œä¸æ˜¯**ä¸€ä¸ªåªèƒ½ç•™ç»™æ„é€ å‡½æ•°çš„è¿‡ç¨‹ã€‚

åˆ›é€ è®¾è®¡æ¨¡å¼è§£å†³äº†ä¸¤ä¸ªé—®é¢˜:**åœ¨å“ªé‡Œ**åˆ›å»ºå¯¹è±¡å’Œ**å¦‚ä½•**åˆ›å»ºå¯¹è±¡ã€‚å¯¹è±¡åˆ›å»ºæ˜¯æŠ½è±¡çš„ï¼Œå®ƒä»¬ä½¿è¿‡ç¨‹æ›´ç®€å•ã€‚

å•ä¾‹æ¨¡å¼åŒ…å«åœ¨åˆ›é€ æ€§æ¨¡å¼ä¸­ã€‚ç„¶è€Œï¼Œå®ƒå…·æœ‰ä¸åŒäºå…¶ä»–åˆ›ä½œæ¨¡å¼çš„ç»“æ„ï¼Œåœ¨æŸäº›æ–¹é¢ä¸åŒäºå…¶ä»–æ¨¡å¼ã€‚æ ¹æ®ä¸€äº›å¤§å¸ˆçš„è¯´æ³•ï¼Œå®ƒè¢«è®¤ä¸ºæ˜¯ä¸€ç§åæ¨¡å¼ã€‚

# ä¸€ä¸ª

å•ä¾‹ç±»åªç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯å…¨å±€è®¿é—®ç‚¹ã€‚åªèƒ½æ´¾ç”Ÿä¸€ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªçº¦æŸï¼Œå®ƒé˜»æ­¢äº†ç±»åœ¨å…¶ä»–åœ°æ–¹è¢«éšæœºç”Ÿæˆã€‚è¿™æ ·å°±ä¸ä¼šäº§ç”Ÿå…¶ä»–å¯¹è±¡ï¼Œæ‰€æœ‰ç³»ç»Ÿéƒ¨ä»¶éƒ½è®¿é—®å¹¶ä½¿ç”¨å”¯ä¸€çš„ç°æœ‰å¯¹è±¡ã€‚

æ–‡çŒ®ä¸­å¤§é‡é‡åˆ°çš„ä¸€ä¸ªç±»æ¯”å°†è¿™ç§è®¾è®¡æ¨¡å¼æ¯”ä½œä¸€ä¸ªå›½å®¶çš„æ”¿åºœã€‚ä¸€ä¸ªå›½å®¶åªæœ‰ä¸€ä¸ªæ”¿åºœï¼Œè¿™ä¸ªæ”¿åºœå¯ä»¥è¢«è¿™ä¸ªå›½å®¶çš„æ‰€æœ‰è®¾å¤‡æ¥å…¥ï¼Œè€Œä¸”è¿™ä¸ªæ¥å…¥è‚¯å®šæ˜¯å¯¹çœŸæ­£çš„æ”¿åºœã€‚å› æ­¤ï¼Œæ— è®ºä½•æ—¶æˆ‘ä»¬æƒ³ä¸æ”¿åºœè”ç³»ï¼Œæˆ‘ä»¬éƒ½èƒ½ç¡®ä¿ä¸çœŸæ­£çš„ã€å”¯ä¸€çš„æ”¿åºœè”ç³»ã€‚

å•ä¾‹è®¾è®¡æ¨¡å¼è¿èƒŒäº†å•ä¸€è´£ä»»åŸåˆ™ã€‚å› æ­¤ï¼Œåœ¨å†³å®šå…¶ç”¨é€”æ—¶ï¼Œåº”è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ã€‚

[](https://towardsdev.com/solid-principles-explained-635ad3608b20) [## è§£é‡Šäº†åšå®çš„åŸåˆ™

### ç”¨ Python è¯­è¨€ä¸¾ä¾‹è¯´æ˜åšå®çš„åŸç†

towardsdev.com](https://towardsdev.com/solid-principles-explained-635ad3608b20) 

## ç”¨ä¾‹

è¿™ç§æ¨¡å¼é€šå¸¸å¯ä»¥ç”¨åœ¨ç®¡ç†ç³»ç»Ÿçš„å¯¹è±¡ä¸Šã€‚æ–‡ä»¶ç³»ç»Ÿæˆ–çª—å£ç®¡ç†å™¨ã€ç¼“å­˜ç³»ç»Ÿæˆ–ç®¡ç†æ•°æ®åº“è¿æ¥çš„å•ä¸ªæ•°æ®åº“å¯¹è±¡ã€‚

å®ƒä¹Ÿå¯ä»¥ç”¨äºâ€œåŠ©æ‰‹â€ç±»ã€‚å®ƒæ˜¯è®¸å¤šä¸åŒå·¥ä½œçš„é™æ€ä¸­å¿ƒã€‚åŒæ ·ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨ä½œæ—¥å¿—è®°å½•å™¨(æœ€å¸¸è§çš„ä¾‹å­)ã€‚

è®°ä½ï¼Œå•ä¾‹å¯¹è±¡æ˜¯å…¨å±€å¯è®¿é—®çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ Singleton æ¥ä»£æ›¿å®šä¹‰å…¨å±€å˜é‡ã€‚

# ç¼–ç 

æœ‰å¤šç§æ–¹æ³•å¯ä»¥åœ¨ Python ä¸­å®ç°å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚è¿™é‡Œå°±ä¸ä¸€ä¸€æåŠäº†ï¼Œåªå±•ç¤ºæˆ‘å–œæ¬¢å’Œä½¿ç”¨çš„æ–¹æ³•ã€‚

ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥è¿™ä¸ªç±»å®ç°çš„é€è¡Œç»“æ„ã€‚

é¦–å…ˆï¼Œæˆ‘ä½¿ç”¨å‰ç¼€ä¸‹åˆ’çº¿æ¥å‘½åè¯¥ç±»ï¼Œä»¥è¡¨æ˜å®ƒæ˜¯ç‰¹æ®Šçš„: *_Singleton* ã€‚

*__instance* æ˜¯ä¸€ä¸ªä¸ç±»æœ¬èº«ç›¸å…³è”çš„ç±»å˜é‡ã€‚å®ƒè·Ÿè¸ªè¯¥ç±»æ˜¯å¦å·²ç»è¢«åˆ›å»ºã€‚

*__inited* ç”¨äºæ¶ˆé™¤ Python ä¸­ç”±äº *__init__* æ„é€ å‡½æ•°å¸¦æ¥çš„ç±»åˆå§‹åŒ–å‰¯ä½œç”¨ã€‚ *__init__* åœ¨ *__new__* æ„é€ å‡½æ•°è¿è¡Œåé‡æ–°è¿è¡Œã€‚å› æ­¤ï¼Œå³ä½¿æˆ‘ä»¬å¾—åˆ°äº†ç›¸åŒçš„å¯¹è±¡ï¼Œå› ä¸ºå®ƒè¢«é‡æ–°åˆå§‹åŒ–ï¼Œæ¯æ¬¡æˆ‘ä»¬è°ƒç”¨è¿™ä¸ªå•ä¾‹ç±»æ—¶ï¼Œ *self.value* å‚æ•°å°†ç­‰äº 10ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æŠŠ *self.value* å‚æ•°æ“çºµæˆåˆ«çš„ä¸œè¥¿ï¼Œç”±äº *__init__* å‰¯ä½œç”¨ï¼Œä½ æ¯æ¬¡è°ƒç”¨ class éƒ½ä¼šæŠŠå®ƒçš„å€¼é‡æ–°è®¾ç½®æˆ 10ã€‚é€šè¿‡æ£€æŸ¥å®ƒçš„åˆå§‹åŒ–ï¼Œæˆ‘ä»¬æ¶ˆé™¤äº†è¿™ä¸ªå‰¯ä½œç”¨ã€‚æ‰€ä»¥ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªæ–¹æ³•æ¥æ“ä½œè¯¥å€¼ï¼Œå¹¶ç§»é™¤äº† *__inited* æ¥æ¼”ç¤ºè¿™ä¸ªå‰¯ä½œç”¨ã€‚

![](img/382facfeb1d486327a5eb340a2ddaffb.png)

å›¾ç‰‡ä½œè€…ã€‚

```
s1 = _Singleton()
print(s1.value) **#10**
s1.manipulate_value()
print(s1.value) **#20**
s2 = _Singleton()
print(s1 == s2) **#True --> same object**
print(s1.value) **#10 --> it is reset to 10**
print(s2.value) **#10**
```

*__new__* æ–¹æ³•æ˜¯å¦ä¸€ç§ Pythonic å¼çš„æ„é€ å‡½æ•°ã€‚æ¯å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶éƒ½ä¼šè°ƒç”¨å®ƒã€‚åœ¨ *__init__* æ–¹æ³•ä¹‹å‰è°ƒç”¨ã€‚è¿™ä¸ªç±»ç»™è‡ªå·±ä½œä¸ºä¸€ä¸ªå¼•ç”¨ *(cls)* ã€‚

![](img/0086ac0fff371b48d7634b3d1a66af46.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¦‚æœå®ä¾‹ä»ç„¶æ˜¯ *None* è¿™æ„å‘³ç€å®ƒä»ç„¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†é€šè¿‡è°ƒç”¨åŸºç±»æ¥åˆ›å»ºå®ƒã€‚å®ƒä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå•ä¾‹ï¼Œå¹¶è¿”å›å®é™…çš„å®ä¾‹ã€‚

åœ¨ *__init__* æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥ Singleton ä¹‹å‰æ˜¯å¦åˆå§‹åŒ–è¿‡ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬è¿”å›å®ƒï¼Œå› æ­¤ï¼Œå®ƒä¸æ“çºµå±æ€§ï¼Œå¹¶ä¿æŒå®ƒä»¬ä¸å˜ã€‚

![](img/4638dc26d7e80fc2cb2e336889db8dad.png)

å›¾ç‰‡ä½œè€…ã€‚

```
s1 = _Singleton()
print(s1) #<__main__._Singleton object at 0x7fcea840efd0>
s2 = _Singleton()
print(s2) #<__main__._Singleton object at 0x7fcea840efd0>
```

æ„Ÿè°¢é˜…è¯»ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–æ„è§ï¼Œè¯·éšæ—¶å†™ä¿¡ç»™æˆ‘ï¼

# ä¸‹ä¸€é›†:

[](https://medium.com/@okanyenigun/design-patterns-in-python-factory-pattern-beea1da31c17) [## Python ä¸­çš„è®¾è®¡æ¨¡å¼:å·¥å‚æ¨¡å¼

### å·¥å‚æ¨¡å¼åœ¨ Python ä¸­çš„å®ç°

medium.com](https://medium.com/@okanyenigun/design-patterns-in-python-factory-pattern-beea1da31c17) 

# é˜…è¯»æ›´å¤šå†…å®¹â€¦

[](https://towardsdev.com/solid-principles-explained-635ad3608b20) [## è§£é‡Šäº†åšå®çš„åŸåˆ™

### ç”¨ Python è¯­è¨€ä¸¾ä¾‹è¯´æ˜åšå®çš„åŸç†

towardsdev.com](https://towardsdev.com/solid-principles-explained-635ad3608b20) [](https://python.plainenglish.io/data-classes-abstraction-interfaces-in-python-ea107d235d3e) [## Python ä¸­çš„æ•°æ®ç±»ã€æŠ½è±¡å’Œæ¥å£

### Python ä¸­çš„æŠ½è±¡ã€æ¥å£å’Œå…¶ä»–ç±»æ¦‚å¿µ

python .å¹³åŸè‹±è¯­. io](https://python.plainenglish.io/data-classes-abstraction-interfaces-in-python-ea107d235d3e)