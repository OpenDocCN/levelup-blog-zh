<html>
<head>
<title>What is Docker Series: Part 3 — Composing and Sharing the Music</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是Docker系列:第3部分-创作和分享音乐</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-docker-series-part-3-composing-and-sharing-the-music-e0a9e71ad221?source=collection_archive---------12-----------------------#2020-07-06">https://levelup.gitconnected.com/what-is-docker-series-part-3-composing-and-sharing-the-music-e0a9e71ad221?source=collection_archive---------12-----------------------#2020-07-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="0113" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">既然我们能创造，我们就能创作并最终分享。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/c4f7bf62a9621139b523d9509c0238f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kHZ-bVe_DRxLZOY0Dvmbwg.jpeg"/></div></div></figure><p id="eea5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们已经讨论了Docker在开发周期中的位置。我们已经讨论了Docker如何运行以及Docker运行什么。我们甚至已经启动并运行了一个Ubuntu实例。现在我们已经有了一些基本的东西，我们可以开始创建多个容器实例了。</p><h1 id="0650" class="lr ls iu bd lt lu lv lw lx ly lz ma mb ka mc kb md kd me ke mf kg mg kh mh mi bi translated">Docker撰写</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mj"><img src="../Images/7356fba7c8dde51ec261efcb56b7125a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mFZMy4Y_mnsyYolk"/></div></div><figcaption class="mk ml gk gi gj mm mn bd b be z dk translated">Samuel Sianipar 在<a class="ae mo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4702" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Docker Compose是另一个命令，它让开发人员有机会在任何给定的时间构建/运行多个Docker容器。这允许开发人员编排运行应用程序所需的所有服务(数据库、后端、前端、消息服务器等),并使用一个命令运行它们。对于开发人员来说，这是一个强大的工具，因为在运行组合之间对图像的任何更改都会自动构建图像的新版本，并将其集成到服务设置中。</p><p id="9430" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">您只需定义该文件一次，然后继续使用相同的命令，而不是记住需要首先启动哪些服务:</p><p id="2f86" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe mp mq mr ms b">docker-compose up .</code></p><blockquote class="mt mu mv"><p id="7411" class="kv kw mw kx b ky kz jv la lb lc jy ld mx lf lg lh my lj lk ll mz ln lo lp lq in bi translated">假设<code class="fe mp mq mr ms b">docker-compose.yaml</code>文件在<code class="fe mp mq mr ms b">.</code>的目录中。</p></blockquote><p id="e11e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">运行多个Docker容器最简单的方法是使用一个<code class="fe mp mq mr ms b">docker-compose.yaml</code>文件。一个<code class="fe mp mq mr ms b">docker-compose.yaml</code>文件的例子是:</p><pre class="kk kl km kn gu na ms nb nc aw nd bi"><span id="d84e" class="ne ls iu ms b gz nf ng l nh ni">version: '2.0'<br/>services:<br/>  web:<br/>    build: .<br/>    ports:<br/>    - "5000:5000"<br/>    volumes:<br/>    - .:/code<br/>    - logvolume01:/var/log<br/>    links:<br/>    - redis<br/>  redis:<br/>    image: redis<br/>volumes:<br/>  logvolume01: {}</span></pre><p id="ef15" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这里发生了很多事情。让我们慢慢打开这个文件。</p><p id="d565" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe mp mq mr ms b">version</code>是要使用的docker-compose类型。最常见的是2.0，但撰写本文时的最新版本是3.8。大部分还是用2.0。</p><p id="f185" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe mp mq mr ms b">services</code>是要构建的服务类型。您可以在这里定义要使用的图像以及这些图像需要哪些属性。服务下的值是添加到<code class="fe mp mq mr ms b">Dockerfiles</code>中描述的设置之上的值。</p><ul class=""><li id="4e05" class="nj nk iu kx b ky kz lb lc le nl li nm lm nn lq no np nq nr bi translated"><code class="fe mp mq mr ms b">build</code>是在构建时应用的设置。可以指定构建一个<code class="fe mp mq mr ms b">Dockerfile</code>路径</li><li id="cb56" class="nj nk iu kx b ky ns lb nt le nu li nv lm nw lq no np nq nr bi translated"><code class="fe mp mq mr ms b">ports</code>是在主机上打开的端口，以<code class="fe mp mq mr ms b">{host:container}</code>的格式连接到Docker容器。</li><li id="d69d" class="nj nk iu kx b ky ns lb nt le nu li nv lm nw lq no np nq nr bi translated"><code class="fe mp mq mr ms b">volumes</code>用于写入持久数据。可以添加容器的一次性卷，而无需顶级密钥。跨容器使用相同的卷应该会将名称添加到顶级卷密钥中(如上面的示例所示)。</li><li id="f5c8" class="nj nk iu kx b ky ns lb nt le nu li nv lm nw lq no np nq nr bi translated"><code class="fe mp mq mr ms b">links</code>用于链接彼此之间的服务——带有WordPress实例的数据库——但这是一个遗留特性，应该改为通过网络链接容器。</li><li id="85a9" class="nj nk iu kx b ky ns lb nt le nu li nv lm nw lq no np nq nr bi translated"><code class="fe mp mq mr ms b">redis</code>是另一个使用<code class="fe mp mq mr ms b">redis</code>映像的服务(如果在主机上找不到，则从Docker Hub获取)。也是用<code class="fe mp mq mr ms b">link</code>在<code class="fe mp mq mr ms b">web</code>服务中定义的服务。</li></ul><blockquote class="mt mu mv"><p id="13be" class="kv kw mw kx b ky kz jv la lb lc jy ld mx lf lg lh my lj lk ll mz ln lo lp lq in bi translated">有关所有可用选项的参考，请查看Docker网站上的<a class="ae mo" href="https://docs.docker.com/compose/compose-file/" rel="noopener ugc nofollow" target="_blank">合成文件文档</a>。</p></blockquote><p id="a2d3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">你可以启动多个服务，使用<a class="ae mo" href="https://docs.docker.com/compose/compose-file/#networks" rel="noopener ugc nofollow" target="_blank">网络</a>连接它们，并通过一个命令<code class="fe mp mq mr ms b">docker-compose up .</code>开始部署完整的应用程序。要停止，只需运行<code class="fe mp mq mr ms b">docker-compose down</code>，它将停止文件中包含的所有正在运行的容器。</p><p id="ec5e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这是将Docker容器组合在一起的开始。关于这个主题的更广泛的想法，请查看我在AWS EC2实例上的Docker容器中做的关于<a class="ae mo" href="https://medium.com/@srepollock/wordpress-in-a-docker-container-on-an-aws-ec2-instance-acb9b2243040" rel="noopener"> WordPress的教程。看一下这篇文章，你也可以拥有自己的WordPress，在AWS上运行Nginx的反向代理。它也适用于免费层！</a></p><h1 id="2159" class="lr ls iu bd lt lu lv lw lx ly lz ma mb ka mc kb md kd me ke mf kg mg kh mh mi bi translated">码头枢纽</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nx"><img src="../Images/23813231fe516a4209ca0b8fcd99824a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*saH3h73rYUef9keP"/></div></div><figcaption class="mk ml gk gi gj mm mn bd b be z dk translated">照片由<a class="ae mo" href="https://unsplash.com/@kadh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kira auf der Heide </a>在<a class="ae mo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d594" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Docker Hub 是Docker的包注册表。用户可以随时将他们创建的图像上传到存储库，并将其更新为新版本供其他用户获取。</p><p id="0a2a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">看看注册表中您可能想要使用的实例，或者您可能想要扩展和构建的实例。有如此多的图片提供了无限的潜力，开始做一些伟大的事情的最好方法就是开始实验。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ny"><img src="../Images/3444a17ed194f9d5171a7f43cc660e7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*77-ECOMI7-kt6j6h"/></div></div><figcaption class="mk ml gk gi gj mm mn bd b be z dk translated">照片由<a class="ae mo" href="https://unsplash.com/@rizmooney?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Riz Mooney </a>在<a class="ae mo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="a40a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">另外，现在您已经看到了Docker的功能，您已经有机会运行一些自己的测试，并且您已经想出了一些您可能想要共享的图像；在那里，你可以通过Docker Hub传递你的知识。其他人可能正面临着和你一样的挑战。为什么不分享知识，让其他人继续他们的热情呢？</p></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><h1 id="8697" class="lr ls iu bd lt lu og lw lx ly oh ma mb ka oi kb md kd oj ke mf kg ok kh mh mi bi translated">最后</h1><p id="5864" class="pw-post-body-paragraph kv kw iu kx b ky ol jv la lb om jy ld le on lg lh li oo lk ll lm op lo lp lq in bi translated">Docker是一个不可思议的平台。这是一种创建程序的方法，这些程序每次启动时都能以相同的方式在多个平台上运行。</p><p id="ab1d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Docker解决了“它在我的机器上工作”的问题，因为它每次都使用相同的资源为客户端运行产品。它可以让您使用集群组织工具(如<a class="ae mo" href="https://docs.docker.com/engine/swarm/" rel="noopener ugc nofollow" target="_blank"> Swarm </a>或<a class="ae mo" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>)来扩展您的应用程序(稍后将讨论)，并为开发人员提供工具来将问题隔离到单个环境，而不是跨环境的所有问题。</p></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><p id="6353" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这是一个小系列，讨论我从Docker学到的东西。我在这里和那里有更多的花絮要添加，我将继续写关于Docker的文章，并在我进行的过程中把它们添加到列表中。</p><p id="256f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我希望你能从这些文章中获得一些知识。我真的希望你渴望更多，并继续学习下去。请随时联系我，讨论我发表的任何文章。如果能听到一些关于你从阅读中学到了什么的反馈，那就太好了。</p></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><h1 id="5a54" class="lr ls iu bd lt lu og lw lx ly oh ma mb ka oi kb md kd oj ke mf kg ok kh mh mi bi translated">什么是Docker系列:</h1><ul class=""><li id="8010" class="nj nk iu kx b ky ol lb om le oq li or lm os lq no np nq nr bi translated"><a class="ae mo" rel="noopener ugc nofollow" target="_blank" href="/what-is-docker-series-part-1-1e419c28f951">第一部</a></li><li id="ff89" class="nj nk iu kx b ky ns lb nt le nu li nv lm nw lq no np nq nr bi translated"><a class="ae mo" href="https://medium.com/@srepollock/what-is-docker-series-part-2-images-and-dockerfiles-141c15eaca0f" rel="noopener">第二部分</a></li></ul></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><p id="45d3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">感谢您抽出时间阅读。祝一切顺利，最重要的是，保持安全——斯潘塞</p></div></div>    
</body>
</html>