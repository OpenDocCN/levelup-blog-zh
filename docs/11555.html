<html>
<head>
<title>End To End Machine Learning Extraction To Deployment.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">端到端机器学习提取到部署。</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/loading-and-extraction-83fedad258f0?source=collection_archive---------0-----------------------#2022-03-26">https://levelup.gitconnected.com/loading-and-extraction-83fedad258f0?source=collection_archive---------0-----------------------#2022-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2645" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我将演示一个端到端的机器学习项目，从从SQL数据库提取数据开始，到部署为web应用程序或Web仪表板结束</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fb55fa17b4a1beef7e5063e06ff49d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M_xDb-agT-zMIZqL"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">维克多·黑塞在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a6ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">应用程序最终会是什么样子</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl lu"><img src="../Images/48e707c6b32b2e4bdfb1a306fd3e9a3f.png" data-original-src="https://miro.medium.com/v2/1*cnvAGNwiYbji2bJG4u0ZRw.gif"/></div></figure><p id="21a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文的代码位于:</p><p id="9223" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/kshirsagarsiddharth/machine_learning_model_for_car_prediction/tree/master" rel="noopener ugc nofollow" target="_blank">kshiragarsiddharth/machine _ learning _ model _ for _ car _ prediction(github.com)</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lv"><img src="../Images/acff627301a31c32f39266f69b127e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xEkdtGD-K45k6telnX9TQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">项目流程</figcaption></figure><h2 id="4c4c" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">问题陈述</h2><ol class=""><li id="e9e6" class="mp mq iq ky b kz mr lc ms lf mt lj mu ln mv lr mw mx my mz bi translated">我们是一家名为二手车的公司的一部分，我们出售二手车。</li><li id="31c6" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">在最近的一次公司调查中，发现销售者对属于“雪佛兰”的汽车定价不正确。一些汽车价格过高，一些汽车价格过低，导致上一季度亏损严重。</li><li id="a712" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">为了补救这一点，高级管理层要求我们创建一个模型，以最小的误差有效地预测汽车的价格。以便有助于销售人员对汽车进行正确定价。</li><li id="a163" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">他们还要求我们为那些也想将自己的直觉与模型结合起来使用的卖家准备一个决策树。</li><li id="4f04" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">他们要求我们为没有技术背景的卖家创建交互式仪表盘。</li><li id="e39d" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">他们还要求我们创建一个RESTful API，供我们其他客户的IT部门通过编程来获取价格。</li></ol><h2 id="07d5" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">目标</h2><ol class=""><li id="cc27" class="mp mq iq ky b kz mr lc ms lf mt lj mu ln mv lr mw mx my mz bi translated">公司数据在SQLite数据库中。所以我们需要提取只属于' Chevrolet '的行。</li><li id="a472" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">将数据转换成熊猫数据框架。</li><li id="c530" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">训练机器学习模型并保存机器学习模型。</li><li id="af1b" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">创建一个RESTful API并部署在heroku中。</li><li id="e56d" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">创建一个Plotly Dash仪表板作为前端，让卖家找到价格也部署在heroku。</li></ol><h2 id="6a2a" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">第1部分:将数据从SQL数据库加载到pandas</h2><p id="aecc" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated"><strong class="ky ir"> 1.1:将数据从数据库加载到数据框架的方法1:</strong>安装ipython-sql以直接在jupyter单元中运行查询</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="1c20" class="lw lx iq nj b gy nn no l np nq"><strong class="nj ir">pip install ipython-sql</strong></span></pre><p id="64eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">连接到数据库</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="49da" class="lw lx iq nj b gy nn no l np nq"># in my case the data is at the same location where my notebook is located hence I have given that location<br/><strong class="nj ir">%load_ext sql<br/>%sql sqlite:///car_prediction_dataset.sqlite3</strong></span></pre><p id="1e1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">了解数据库结构</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl lu"><img src="../Images/5ff539e80b5faa7c51925cd144b2a03d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*zMzZG0IdIDS3bcfVXSmFIw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd ly">表1 </strong></figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl lu"><img src="../Images/c1270b13a67efd5ae9794684634a2248.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ns5nEcNxq77g37j6TVYShQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd ly">表2 </strong></figcaption></figure><ol class=""><li id="7c70" class="mp mq iq ky b kz la lc ld lf nr lj ns ln nt lr mw mx my mz bi translated">有两个表格包含了我们需要的数据。</li><li id="63e4" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><code class="fe nu nv nw nj b">model_info</code>中的索引列实际上是来自<code class="fe nu nv nw nj b">model_with_companies.</code>的<code class="fe nu nv nw nj b">model_id</code></li><li id="1bd5" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">换句话说，<code class="fe nu nv nw nj b">model_with_companies</code>中的<code class="fe nu nv nw nj b">model_id</code>是<code class="fe nu nv nw nj b">model_info.</code>的外键</li><li id="f070" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">我们将对<code class="fe nu nv nw nj b">model_info</code>中的<code class="fe nu nv nw nj b">index</code>和<code class="fe nu nv nw nj b">model_with_companies</code>中的<code class="fe nu nv nw nj b">model_id</code>执行内部连接，并只选择建模所需的行。</li></ol><p id="8141" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">根据问题陈述，我只选择属于“Cheverolet”的公司</strong></p><p id="59bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注:在mc.model_id = mi上。这里的“index”是在双引号中，因为index是SQLite中的一个标准函数，所以它在双引号中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl lu"><img src="../Images/80d35b75c74a88afec4e49fd98458e08.png" data-original-src="https://miro.medium.com/v2/format:webp/1*G0ZZXOaoCc59gtGLif7XUA.png"/></div></figure><p id="ab57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.1.2方法2使用pandas的read_sql_query方法将数据加载到pandas DataFrame中</p><p id="450a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装所需模块:<code class="fe nu nv nw nj b"><strong class="ky ir">pip install SQLAlchemy</strong></code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="9c75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.1训练机器学习模型</p><p id="12ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导入必要的库</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="042a" class="lw lx iq nj b gy nn no l np nq"><strong class="nj ir">import numpy as np <br/>import pandas as pd <br/>from sklearn.model_selection import train_test_split <br/>from sklearn.linear_model import LinearRegression<br/>from sklearn.metrics import mean_absolute_error, mean_squared_error <br/>from sklearn.preprocessing import StandardScaler<br/>from sklearn.preprocessing import OneHotEncoder <br/>from sklearn.model_selection import GridSearchCV<br/>from sklearn.preprocessing import OrdinalEncoder<br/>from sklearn.compose import ColumnTransformer <br/>from sklearn.pipeline import Pipeline</strong></span></pre><p id="4a2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.2检查空值</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="c9c0" class="lw lx iq nj b gy nn no l np nq">df.isnull().sum()</span><span id="008b" class="lw lx iq nj b gy ny no l np nq">year             0<br/>price            0<br/>km_traveled      0<br/>tax              0<br/>engineSize       0<br/>km_per_liters    0<br/>model            0<br/>transmission     0<br/>fuel_type        0<br/>dtype: int64</span></pre><p id="b5d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.3将数据集分为依赖和独立数据集</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="5036" class="lw lx iq nj b gy nn no l np nq">y = df['price']<br/>X = df.drop('price', axis = 1)</span><span id="182b" class="lw lx iq nj b gy ny no l np nq">df['model']</span><span id="1ca2" class="lw lx iq nj b gy ny no l np nq">0                               Camaro<br/>1                          TrailBlazer<br/>2          Silverado 2500 Extended Cab<br/>3                          Astro Cargo<br/>4                     S10 Extended Cab<br/>                     ...              <br/>5096                Express 1500 Cargo<br/>5097     Silverado 2500 HD Regular Cab<br/>5098                          Cavalier<br/>5099                       Monte Carlo<br/>5100    Silverado 2500 HD Extended Cab<br/>Name: model, Length: 5101, dtype: object</span></pre><p id="8d80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.4将数据集分为训练、测试和有效三部分</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="15cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nz">注意:我们可以简单地将整个数据集应用于无序列上的pd.dummies，并将有序分类列转换为整数，但是我没有这样做，因为这是非常糟糕的做法。</em></p><ol class=""><li id="da04" class="mp mq iq ky b kz la lc ld lf nr lj ns ln nt lr mw mx my mz bi translated">我们希望将培训、测试和验证数据集分开</li><li id="1d2f" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">如果新的数据来了，我们不能使用pd.dummies方法来转换新的数据集。</li><li id="219e" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">使用pd.dummies方法是不可扩展的，并且妨碍了新模型和测试的快速开发</li></ol><p id="f6d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.5 </strong>提取数值和分类列的名称</p><p id="5109" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注:年份<em class="nz">栏、型号</em>栏为标签编码，传输<em class="nz">栏、燃料类型</em>栏为热编码。</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="bb4c" class="lw lx iq nj b gy nn no l np nq"><strong class="nj ir">numeric_columns = X.select_dtypes(exclude='object').columns<br/>unordered_columns =['transmission', 'fuel_type']</strong><br/># I am not one hot encoding year and model because there are too many values <br/><strong class="nj ir">ordered_columns = ['year', 'model']</strong></span><span id="dc85" class="lw lx iq nj b gy ny no l np nq">print(numeric_columns)<br/>print(unordered_columns)<br/>print(ordered_columns)</span><span id="fb7f" class="lw lx iq nj b gy ny no l np nq">Index(['km_traveled', 'tax', 'engineSize', 'km_per_liters'], dtype='object')<br/>['transmission', 'fuel_type']<br/>['year', 'model']</span></pre><p id="22e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.6 </strong>一个热编码分类列</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="1e3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.7 </strong>标签编码有序分类列</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="0a6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.8 </strong>缩放数值栏</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="af49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.9 </strong>组合数字和分类列</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl lu"><img src="../Images/b63fbd331f70dd070cc19d2c912103b1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xCRyvBk9DZqVJ7tie0w1Dw.png"/></div></figure><p id="faee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.10 </strong>将上述任务转换为一个函数，而不是分别对各个列进行编码。换句话说，使上述编码过程自动化。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="085c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.11 </strong>使用不同的模型来检查哪种模型能给出最好的结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="afc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.12因此，性能最好的模型是ElasticNet和RandomForest，因此让我们在ElasticNet算法上进行网格搜索</p><p id="89ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">弹性网上的网格搜索</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><p id="b65c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2.13 </strong>因此，我们简化了预处理，但仍然有太多的代码，因此，有另一种方法可以使整个过程自动化，我们将使用列转换器</p><ol class=""><li id="06dc" class="mp mq iq ky b kz la lc ld lf nr lj ns ln nt lr mw mx my mz bi translated">上述方法还有另一个缺点，首先是我们需要保存所有3个变压器和模型，以便以后加载。换句话说，我们需要挑选三个转换器，建模并在稍后的部署代码中加载4个文件来进行预测。</li><li id="9d6d" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">这种方法不适合快速训练。</li></ol><div class="oa ob gp gr oc od"><a href="https://scikit-learn.org/stable/auto_examples/compose/plot_column_transformer_mixed_types.html" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">混合型柱式变压器</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">这个例子说明了如何应用不同的预处理和特征提取管道到不同的子集…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">scikit-learn.org</p></div></div><div class="om l"><div class="on l oo op oq om or kp od"/></div></div></a></div><p id="ad90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.14使用柱式变压器</p><p id="046d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将转换器应用于数组或pandas数据框架的列。</p><p id="24ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该估计器允许输入的不同列或列子集被分别变换，并且由每个变换器生成的特征将被连接以形成单个特征空间。这对于异构数据或列数据很有用，可以将几个特征提取机制或转换组合到单个转换器中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/5e4face3033ac50d0b1dcde8b3ee4473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-1woIUn7WV0aAji0Uq7Ag.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">培训模型管道</figcaption></figure><p id="3326" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，这条管道做得很好，为了改善结果，我们还可以在这条管道上执行网格搜索。有关更多信息，请参考ColumnTransformer指南。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/3eefbc235370d2fc77ec82fcb8ba316d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4f2MhCGMY01Zkt99QrVczQ.png"/></div></div></figure><p id="091b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">保存模型</strong></p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="6276" class="lw lx iq nj b gy nn no l np nq"><strong class="nj ir">import joblib</strong><br/># saving the model <br/><strong class="nj ir">joblib.dump(grid_search.best_estimator_,'final_car_prediction_model.pkl')</strong><br/># saving the column names <br/><strong class="nj ir">joblib.dump(list(X.columns),'column_names.pkl')</strong></span><span id="dad6" class="lw lx iq nj b gy ny no l np nq">['column_names.pkl']</span></pre><p id="11b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">加载保存的模型</strong></p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="b3c7" class="lw lx iq nj b gy nn no l np nq"><strong class="nj ir">loaded_model = joblib.load('final_car_prediction_model.pkl')</strong></span></pre><p id="21c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">对加载的模型进行预测</strong></p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="1b17" class="lw lx iq nj b gy nn no l np nq"><strong class="nj ir">joblib.load('column_names.pkl')))</strong></span><span id="cab4" class="lw lx iq nj b gy ny no l np nq"><strong class="nj ir">loaded_model.predict(pd.DataFrame(data = [['2018', 39842.43038, 0, 1.5, 20.3643976, 'Camaro', 'Manual','Petrol']],<br/>                                  columns = </strong></span><span id="7468" class="lw lx iq nj b gy ny no l np nq">array([12693.99485813])</span></pre><p id="2271" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在是时候按照要求创建仪表板了。请在</p><p id="a3f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://siddharth1.medium.com/deploy-ml-project-as-dashboard-with-google-authentication-14fee8c6988c" rel="noopener">https://siddharth 1 . medium . com/deploy-ml-project-as-dashboard-with-Google-authentic ation-14 fee 8 c 6988 c</a></p></div></div>    
</body>
</html>