# ä½¿ç”¨ ESLintã€Prettierã€Lint-Staged å’Œ Husky è‡ªåŠ¨åŒ–å¹¶ä¿æŒä»£ç çš„ä¸€è‡´æ€§

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/automate-and-keep-your-code-consistent-using-eslint-prettier-lint-staged-and-husky-3e186977d7eb>

## ä½ çš„ä»£ç åœ¨ä¸åŒçš„å¼€å‘è€…ä¹‹é—´æ˜¯ä¸€è‡´çš„å—ï¼Ÿæ‚¨æ€»æ˜¯åœ¨æäº¤ä¹‹å‰æ‰‹åŠ¨ä¿®å¤ lint é”™è¯¯å’Œæ ¼å¼é—®é¢˜å—ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯ç»™ä½ çš„

![](img/7406d3be48fe0e0e49ed9825efecc46b.png)

å¸ƒè±å…‹Â·åº·çº³åˆ©åœ¨ [Unsplash](https://unsplash.com/s/photos/code-formatting?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„ç…§ç‰‡

å½“ä¸å‡ ä¸ªç¨‹åºå‘˜ä¸€èµ·å·¥ä½œæ—¶ï¼Œä»£ç é£æ ¼ä»ä¸ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”æ€»æ˜¯å¾ˆéš¾ä¿æŒä¸€è‡´çš„å¯è¯»å’Œå¯ç»´æŠ¤çš„ä»£ç ã€‚

å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•å¯ä»¥é€šè¿‡ä½¿ç”¨ linter æ¥æ”¹è¿›æ‚¨çš„ä»£ç åº“ï¼Œå®ƒä¸ä»…å¯ä»¥æ”¹è¿›ä»£ç ï¼Œè¿˜å¯ä»¥ä½¿æ•´ä¸ªå›¢é˜Ÿçš„ä»£ç ç»Ÿä¸€èµ·æ¥ã€‚åœ¨ linter çš„å¸®åŠ©ä¸‹ï¼Œæ¥è‡ªå¤šä¸ªå¼€å‘äººå‘˜çš„ä¸åŒç¼–ç é£æ ¼èåˆåœ¨ä¸€èµ·ï¼Œæœ€ç»ˆçš„ä»£ç å˜å¾—å¯è¯»å’Œå¯ç»´æŠ¤ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [**ESLint**](https://eslint.org/) ã€[**appetter**](https://prettier.io/)ã€ [**Husky**](https://typicode.github.io/husky/#/) å’Œ [**Lint-Staged**](https://github.com/okonet/lint-staged) æ¥è‡ªåŠ¨åŒ–è¯¥è¿‡ç¨‹ï¼Œä»¥ç¡®ä¿ä»£ç è¢«æ ¼å¼åŒ–å¹¶ä¿®å¤è¯¸å¦‚è¯­æ³•é”™è¯¯ä¹‹ç±»çš„ç¼–ç¨‹é”™è¯¯ã€‚

> **æ³¨:**æˆ‘åœ¨ä¸€ä¸ªåä¸ºâ€œ [**Commitzen**](https://commitizen-tools.github.io/commitizen/) â€çš„å›¢é˜Ÿå·¥ä½œæ—¶ï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ªå·¥å…·å¾ˆæœ‰ç”¨ï¼Œå®ƒç”¨äºå®šä¹‰ä¸€ç§ä¸ºæäº¤æ¶ˆæ¯è®¾ç½®è§„åˆ™çš„æ ‡å‡†åŒ–æ–¹å¼ï¼Œä½†è¿™ä¸ªå·¥å…·æ˜¯å¦ä¸€å¤©ç”¨çš„ã€‚

æ˜¯æ—¶å€™æ·±å…¥ç ”ç©¶åœ¨æ‚¨çš„ä¸‹ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­å®‰è£…å’Œä½¿ç”¨å®ƒä»¬æ‰€éœ€çš„åŒ…äº†ã€‚

## 1.å¿…éœ€çš„è½¯ä»¶åŒ…å®‰è£…

é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…æ‰€æœ‰éœ€è¦çš„è½¯ä»¶åŒ…ï¼Œå®ƒä»¬æ˜¯:

*   **ESLint â€”** æ˜¯ä¸€ä¸ªè§£æå™¨ï¼Œç”¨äºæ£€æŸ¥ä»£ç å¹¶æŠ¥å‘Š bugã€ç¼–ç é”™è¯¯æˆ–æ‰“å­—é”™è¯¯ã€‚
*   **æ›´æ¼‚äº®â€”** æ˜¯ä¸€ä¸ªæ ¹æ®é…ç½®æ ¼å¼åŒ–ä»£ç çš„å·¥å…·ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°ã€‚
*   **Lint-Staged â€”** ç”¨äºè¿è¡Œ linter åˆ° staged git æ–‡ä»¶ï¼Œé˜²æ­¢æäº¤é”™è¯¯ä»£ç ã€‚
*   **Husky â€”** æ˜¯ä¸€ä¸ªä¸ Git æŒ‚é’©(å¦‚é¢„æäº¤ã€æäº¤æ¶ˆæ¯ã€åæäº¤ç­‰)ååŒå·¥ä½œçš„å·¥å…·ã€‚

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯`npm`åŒ…ç®¡ç†å™¨ï¼Œå®‰è£…æ‰€æœ‰å››ä¸ªåŒ…éœ€è¦è¿è¡Œçš„å‘½ä»¤åº”è¯¥æ˜¯è¿™æ ·çš„:

```
npm install --save-dev eslint prettier lint-staged husky
```

## 2. **ESLint é…ç½®**

ç°åœ¨è®©æˆ‘ä»¬é…ç½®å·²å®‰è£…çš„åŒ…ï¼Œä» ESLint å¼€å§‹ã€‚ç”¨äºåˆå§‹åŒ– ESLint çš„å‘½ä»¤å°†æ˜¯:

```
npx eslint --init
```

å°†å‡ºç°ä¸‹é¢çš„å±å¹•ï¼Œæ‚¨éœ€è¦æ ¹æ®è‡ªå·±çš„éœ€è¦å›ç­”å‡ ä¸ªé—®é¢˜ï¼Œé…ç½®å°†è¢«ç›¸åº”åœ°ä¿å­˜ã€‚

![](img/d30d573e40b1603e75ccb03a59137a70.png)

é…ç½®æ–‡ä»¶ç±»ä¼¼äºä¸‹é¢çš„å†…å®¹:

```
{
    "env": {
        "browser": true,
        "es2021": true
    },
    "extends": [
        "plugin:react/recommended",
        "standard"
    ],
    "parserOptions": {
        "ecmaFeatures": {
            "jsx": true
        },
        "ecmaVersion": "latest"
    },
    "plugins": [
        "react"
    ],
    "rules": {
    }
}
```

æ‚¨è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º`.eslintrc.json`çš„æ–‡ä»¶ï¼Œç²˜è´´ä¸Šé¢çš„é…ç½®ï¼Œè€Œä¸æ˜¯è¿è¡Œ`npx`å‘½ä»¤ï¼Œå¹¶æ£€æŸ¥æ•´ä¸ªé—®é¢˜åˆ—è¡¨ã€‚

è¯¦ç»†é˜…è¯»å…³äº ESLint è§„åˆ™çš„æ›´å¤šä¿¡æ¯ï¼Œç„¶åæŸ¥çœ‹ [**ESLint è§„åˆ™æ–‡æ¡£**](https://eslint.org/docs/latest/rules/) **ã€‚**

## 3.æ¼‚äº®çš„é…ç½®

ä¸ºäº†é…ç½®å¾—æ›´æ¼‚äº®ï¼Œæ‚¨éœ€è¦åœ¨åº”ç”¨ç¨‹åºçš„æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª`.prettierrc.json`æ–‡ä»¶ï¼Œå¹¶ç²˜è´´ä»¥ä¸‹é…ç½®:

```
{
  "bracketSpacing": true,
  "semi": true,
  "singleQuote": true,
  "trailingComma": "all",
  "printWidth": 80,
  "tabWidth": 2
}
```

æ›´æ¼‚äº®çš„é…ç½®æœ‰å¤šç§é€‰æ‹©ï¼Œçœ‹çœ‹[æ›´æ¼‚äº®çš„æ–‡æ¡£](https://prettier.io/docs/en/options.html)ã€‚

å¦‚æœä½ æƒ³å¿½ç•¥ä¸€äº›æ–‡ä»¶æ ¼å¼ä½¿ç”¨æ¼‚äº®ï¼Œæ·»åŠ ä¸€ä¸ª`.prettierignore`æ–‡ä»¶åœ¨æ ¹åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹å’Œæ·»åŠ æ–‡ä»¶åœ¨é‚£é‡Œã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å°†ä»¥ä¸‹æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ·»åŠ åˆ°`.prettierignore`æ–‡ä»¶ä¸­ï¼Œå› ä¸ºæ ¼å¼åŒ–æ—¶ä¸éœ€è¦å®ƒä»¬:

```
package-lock.json
node_modules
```

## **4ã€‚æ£‰ç»’åˆ†çº§é…ç½®**

Lint-Staged çš„é…ç½®å¹¶ä¸å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œæ‰€ä»¥æ‰“å¼€`package.json`æ–‡ä»¶ï¼Œæœ€åï¼Œåœ¨å…¶ä»–é…ç½®ä¹‹åï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®éƒ¨åˆ†:

```
{
  *...
  ...* "lint-staged": {
    "**/*.{js,jsx}": ["eslint . --fix", "prettier --write ."]
  }
}
```

"`**/*.{js,jsx}`"è¿™ä¸ªè„šæœ¬å°†åœ¨æ‚¨çš„æ•´ä¸ªåº”ç”¨ç¨‹åºä¸Šè¿è¡Œï¼Œè¿™æ„å‘³ç€æ‰€æœ‰å¸¦æœ‰`js`å’Œ`jsx`æ‰©å±•åçš„æ–‡ä»¶ï¼Œä½†æ˜¯å¦‚æœæ‚¨æƒ³åªåœ¨ src æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶ä¸Šæ‰§è¡Œ`lint-staged`ï¼Œé‚£ä¹ˆå°±æ”¹ä¸ºç¼–å†™è¿™ä¸ªè„šæœ¬:

```
"src/*.{js,jsx}": ["eslint . --fix", "prettier --write ."]
```

åœ¨ä¸Šè¿°é…ç½®ä¸­ï¼Œâ€œâ€¦â€è¡¨ç¤ºå…¶ä»–é…ç½®ï¼Œæ‚¨ä¸éœ€è¦åœ¨æ‚¨çš„`package.json`æ–‡ä»¶ä¸­æ·»åŠ è¿™äº›ç‚¹ã€‚

## 5.é…ç½® Husky

æˆ‘ä»¬æ•´ä¸ªé…ç½®çš„æœ€åä¸€èŠ‚æ˜¯ Huskyï¼Œé…ç½® Husky æœ‰å‡ ç§æ–¹å¼ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œä¼šå°½é‡ä¿æŒç®€å•ã€‚åŒæ ·ï¼Œæ‚¨éœ€è¦æ‰“å¼€ package.json æ–‡ä»¶ï¼Œå¹¶åœ¨æ‰€æœ‰å…¶ä»–é…ç½®ä¹‹åæ·»åŠ ä»¥ä¸‹è„šæœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
{
  *...
  ...* "scripts": {
    *< ---- other scripts remains here ---- >* "execute-husky": "npx husky install && npx husky add .husky/pre-commit \"npx --no-install lint-staged\""
  },
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged"
    }
  }
}
```

ç°åœ¨æ‚¨å·²ç»åœ¨`package.json`æ–‡ä»¶ä¸­æ·»åŠ äº†ä¸Šè¿°é…ç½®ï¼Œæ‰§è¡Œå°†å®‰è£… Husky çš„â€œ`execute-husky`â€è„šæœ¬ï¼ŒåŒæ—¶ä¹Ÿå°†è§¦å‘`pre-commit`é’©å­ã€‚æ‚¨å¯ä»¥ä½¿ç”¨`npm`å‘½ä»¤è¿è¡Œ`execute-husky`å‘½ä»¤ï¼Œä¾‹å¦‚:

```
npm run execute-husky
```

**æ‚¨å·²ç»å®Œæˆäº†è¿™é‡Œçš„æ‰€æœ‰é…ç½®ï¼Œç°åœ¨å°è¯•æäº¤æ‚¨çš„æ›´æ”¹å¹¶æŸ¥çœ‹ç»“æœã€‚ğŸ‰**

*åœ¨â€¦*[*Twitter*](https://twitter.com/m_adeel91)*ï¼Œ*[*LinkedIn*](https://www.linkedin.com/in/muhammad-adeel-9ba19951/)*ï¼Œæˆ–è€…* [*GitHub*](https://github.com/Adeel91)

å¦‚æœä½ å–œæ¬¢é˜…è¯»è¿™æ ·çš„æ•…äº‹ï¼Œå¹¶æƒ³æ”¯æŒæˆ‘æˆä¸ºä¸€åä½œå®¶ï¼Œå¯ä»¥è€ƒè™‘[æŠ¥åæˆä¸ºä¸€ååª’ä½“æˆå‘˜](https://medium.com/@muhammad-adeel-91/membership)ã€‚æ¯æœˆ 5 ç¾å…ƒï¼Œä½ å¯ä»¥æ— é™åˆ¶åœ°é˜…è¯»åª’ä½“ä¸Šçš„æ•…äº‹ã€‚å¦‚æœä½ æ³¨å†Œä½¿ç”¨æˆ‘çš„é“¾æ¥ï¼Œæˆ‘ä¼šèµšä¸€å°ç¬”ä½£é‡‘ã€‚

[](https://medium.com/@muhammad-adeel-91/membership) [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥åª’ä½“-ç©†ç½•é»˜å¾·Â·é˜¿å¾·å‹’

### é˜…è¯»é»˜ç½•é»˜å¾·Â·é˜¿å¾·å‹’(ä»¥åŠåª’ä½“ä¸Šæˆåƒä¸Šä¸‡çš„å…¶ä»–ä½œå®¶)çš„æ¯ä¸€ä¸ªæ•…äº‹ã€‚æ‚¨çš„ä¼šå‘˜è´¹ç›´æ¥æ”¯æŒâ€¦

medium.com](https://medium.com/@muhammad-adeel-91/membership) 

[***ç»™æˆ‘ä¹°æ¯å’–å•¡***](https://www.buymeacoffee.com/muhammadadeel)***â˜•***