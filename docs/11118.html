<html>
<head>
<title>GitHub Packages: Publish and Consume Artifacts of a Spring Gradle Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GitHub包:发布和消费Spring Gradle项目的工件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/github-packages-publish-and-consume-artifacts-of-a-spring-gradle-project-e91d86a5ea1e?source=collection_archive---------20-----------------------#2022-02-16">https://levelup.gitconnected.com/github-packages-publish-and-consume-artifacts-of-a-spring-gradle-project-e91d86a5ea1e?source=collection_archive---------20-----------------------#2022-02-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2cf8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从分叉的存储库中创建依赖项</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/f3508c4ed11a3f7bc961bdba6fa44a33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4-1Yu8ZVYyb1eFbN"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">由<a class="ae lb" href="https://unsplash.com/@synkevych?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Roman Synkevych </a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="387a" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">简介</strong></h2><p id="f9b9" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在本教程中，我们将看到如何使用Gradle将工件发布到GitHub包中。之后，我们将尝试把它作为一个依赖项使用——在一个Maven项目上。</p><p id="6905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是我们将经历的主要事情:</p><ul class=""><li id="3b1b" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated">在Gradle项目上使用<code class="fe mj mk ml mm b">maven-publish</code></li><li id="46ac" class="ma mb iq jp b jq mn ju mo jy mp kc mq kg mr kk mf mg mh mi bi translated">创建GitHub动作工作流来对事件做出反应并触发工件的发布</li><li id="8e45" class="ma mb iq jp b jq mn ju mo jy mp kc mq kg mr kk mf mg mh mi bi translated">使用发布的工件作为Maven项目的依赖项</li></ul><p id="8f9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于上下文，我们将使用spring-authorization-server的分叉版本(spring官方项目之一)。好奇为什么？故事时间到了。最近，我正在进行OAuth的动态客户端注册，我需要创建公共客户端(用于spa)。不幸的是，在撰写本文时，它似乎还不被支持(除非我遗漏了什么)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/1f09c5f35f7f68236308ede650ff96bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G5-j0F3Tcds9aPRo4YLE1g.png"/></div></div></figure><p id="f04f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上是我创作的问题。这里有一个<a class="ae lb" href="https://github.com/spring-projects/spring-authorization-server/issues/625" rel="noopener ugc nofollow" target="_blank">参考链接</a>。不管怎样，这就是为什么——所以，把它放在一边，让我们继续这个教程。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="d9e1" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">在Gradle项目上使用maven-publish</strong></h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi na"><img src="../Images/efa0ee0e96bd104b385c744bf50bd5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*ejl8tHYw5J9Vueo4Crno-g.png"/></div></figure><p id="ffb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们所见，<code class="fe mj mk ml mm b">spring-authorization-server</code>有一个名为<code class="fe mj mk ml mm b">spring-security-oauth2-authorization-server</code>的子项目，它包含自己的Gradle文件。由于这个项目包含源文件，让我们将<code class="fe mj mk ml mm b">maven-publish</code>应用到它的Gradle文件中:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="a3fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只包括了要点的相关部分；但是，作为参考，我们可以在这里找到实际的Gradle文件<a class="ae lb" href="https://github.com/emyasa/spring-authorization-server/blob/experimental/github-packages/oauth2-authorization-server/spring-security-oauth2-authorization-server.gradle" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="bca1" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">创建GitHub操作工作流程</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/3cb1adc01eb92c074fb5a51c6352016d.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*GoIVOMRwcfAgipAC8Gy98g.png"/></div></figure><p id="2987" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们通过创建一个yml文件来定义工作流。在我们的例子中，我们将其命名为gradle-publish-workflow.yml:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="ffb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于一个简单的演示，我们已经配置了触发器，在每次推送到<code class="fe mj mk ml mm b">experimental/github-packages</code>分支时发布工件；然而，也可以在每个版本中限制这一点。</p><p id="3d2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，让我们尝试模拟并观察它的运行。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ne"><img src="../Images/dda1563b68bbedeca4ae1bdcb4e342a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8Yna9AzQNCEHgWiQ_T7QA.png"/></div></div></figure><p id="5510" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太好了！既然我们已经成功地发布了工件——让我们检查一下我们的包:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nf"><img src="../Images/75fcbc7e2a58db6efbb74639f7019b65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2KJRycYSjTzCe3ZvM3L7w.png"/></div></div></figure><p id="40c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，之前在我们的Gradle文件中，我们已经为版本添加了一个唯一的字符串标识符(“emyasa”)，以便稍后我们在测试它时能够区分我们的依赖项。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="f0ca" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">使用发布的工件作为Maven项目的依赖项</strong></h2><p id="8b28" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">首先，像往常一样，让我们复制pom.xml上的依赖关系:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="8fc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，由于GitHub不允许对包进行未经认证的访问(即使项目本身是一个公共repo)，我们必须生成一个个人访问令牌(PAT)。然后，让我们将它与GitHub包的存储库配置一起包含在我们的maven settings.xml中:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="4223" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">剩下唯一要做的事情就是运行maven install，现在我们已经完成了！</p><p id="0025" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和往常一样，源代码可以从<a class="ae lb" href="https://github.com/emyasa/spring-authorization-server/tree/experimental/github-packages" rel="noopener ugc nofollow" target="_blank"> GitHub </a>获得。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="1ca9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">寻找更多相关文章？你不妨看看这些:</strong></p><div class="ng nh gp gr ni nj"><a href="https://medium.com/javarevisited/oauth-2-0-authorization-code-flow-in-spring-boot-d8ff393f316d" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">OAuth 2.0:Spring Boot的授权代码流</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">学习什么，什么时候，如何。</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx kv nj"/></div></div></a></div><div class="ng nh gp gr ni nj"><a rel="noopener  ugc nofollow" target="_blank" href="/aws-run-an-s3-triggered-lambda-locally-using-localstack-ac05f03dc896"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">AWS:使用LocalStack在本地运行S3触发的Lambda</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">在不离开本地环境的情况下测试您的代码</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ns l"><div class="ny l nu nv nw ns nx kv nj"/></div></div></a></div></div></div>    
</body>
</html>