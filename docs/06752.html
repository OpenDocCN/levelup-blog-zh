<html>
<head>
<title>Angular Route Guards for Authentication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于认证的角形路由保护</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/angular-route-guards-for-authentication-d77fb01f04ae?source=collection_archive---------0-----------------------#2020-12-28">https://levelup.gitconnected.com/angular-route-guards-for-authentication-d77fb01f04ae?source=collection_archive---------0-----------------------#2020-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0db5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何限制应用内导航？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/527d7888a10bd92da3e8371e2a9e2e85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mSdAWJ4H6N-OmLnfec7_MQ.jpeg"/></div></div></figure><p id="d5dd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在您的angular web应用程序中，您可能需要限制某些用户对某些页面的访问，或者换句话说，您可能正在寻找一种方法来验证来自客户端的应用程序内导航。这就是棱角分明的路线警卫会让你的生活变得轻松。<strong class="kw iu">角度路线守卫是一个接口，可以执行该接口来决定是否可以激活路线。那么，事不宜迟，让我们开始吧！</strong></p><p id="522f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Angular中有5种类型的防护，即<strong class="kw iu"> CanActivate、CanActivateChild、CanDeactivate、Resolve </strong>和<strong class="kw iu"> CanLoad。</strong>让我们来看看<strong class="kw iu">可以激活的防护装置</strong>，它是常用的防护装置之一，它会让您更好地了解如何在Angular中使用防护装置。</p><p id="2e00" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq">只需3步！</em> </strong></p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="1377" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">步骤1:创建认证服务</h2><p id="1044" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">在这个例子中，我将使用<a class="ae mw" href="https://jwt.io/" rel="noopener ugc nofollow" target="_blank"> JSON Web令牌(JWT) </a>，这是最流行的认证用户的方法之一。首先，让我们创建<em class="lq"> auth.service.ts </em>来处理认证。<code class="fe mx my mz na b">ng g service auth</code>将帮助您生成认证服务。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="2d3e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> isLoggedIn() </strong>函数将从本地存储中获取令牌，并根据到期时间检查令牌有效负载的有效性。</p><h2 id="aac1" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">步骤2:创建路线守卫</h2><p id="5bd6" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">使用以下命令生成保护。</p><p id="cfb6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mx my mz na b">ng g guard auth</code></p><p id="5907" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将创建实现CanActivate接口的<em class="lq"> auth.guard.ts </em>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="87c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq"> canActivate() </em>方法将使用认证服务的实例，并返回用户是否登录。如果未登录，用户将被重定向至<code class="fe mx my mz na b">/login</code>路线。</p><h2 id="45f8" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">第三步:使用路线内的警卫</h2><p id="2910" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">角度路由有一个名为<strong class="kw iu"> canActivate </strong>的属性，该属性接受一个防护阵列，在路由到特定路由之前会对其进行检查。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="c252" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，如果令牌过期，用户将无法访问<code class="fe mx my mz na b">/home</code>路线，他将被重定向到<code class="fe mx my mz na b">/login</code>路线。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="9e32" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很明显，路由守卫不仅对基于令牌的路由认证有用。如果购物车中没有商品，您可以在电子商务网站中使用route guards来限制用户访问结帐页面。</p><p id="427e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，我必须说，有经验的开发人员可以绕过路由防护。与用作安全功能相比，它在提供更好的用户体验方面更有用。</p><p id="237a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">希望在另一篇文章中再见到你。在那之前，编码快乐！💻</p></div></div>    
</body>
</html>