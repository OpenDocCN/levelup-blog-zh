<html>
<head>
<title>Setting Up A Raspberry Pi Home Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设置Raspberry Pi家庭服务器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setting-up-a-raspberry-pi-home-server-ec7e11ee64e0?source=collection_archive---------0-----------------------#2022-09-04">https://levelup.gitconnected.com/setting-up-a-raspberry-pi-home-server-ec7e11ee64e0?source=collection_archive---------0-----------------------#2022-09-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/241a5c0560499a6187f40f38ef786e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-wnAdklIug7QDIsJOVDUQ.png"/></div></div></figure><p id="7655" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你想建立一个家庭实验室，Raspberry Pi电脑是一个很好的选择，因为它噪音低，功耗低，如果你需要新的存储或其他功能，如连接摄像头或显示器，可以很容易地扩展更多模块。作为一个家庭实验室设备，这是一个很好的方式来开始建立一个实验室，并在一个更便宜和更小的外形尺寸上工作。或者，如果你想要挑战，你可以试着尽可能多地跑步，以充分利用这个小设备。</p><p id="1fc6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我们将介绍如何安装Rasbian操作系统，如何配置对新设置设备的远程访问，以及如何开始使用Ansible等代码工具来轻松管理设备上运行的内容。</p><p id="6214" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这篇文章中的任何代码片段都可以在Raspberry Pi操作系统上运行，但是应该可以在类似Debian的Linux系统上运行。</p><h1 id="87bf" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">安装和设置操作系统</h1><p id="9832" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">要开始将应用程序部署到您的Raspberry Pi并使用它，您需要安装一个操作系统。您应该根据您希望使用这台机器的目的来选择这个操作系统；是运行服务的基本机器，还是拥有类似<a class="ae mc" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>的完全虚拟化机器。</p><p id="bb6e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一些常见的操作系统包括:<a class="ae mc" href="https://www.raspberrypi.com/software/operating-systems/" rel="noopener ugc nofollow" target="_blank">树莓Pi OS </a>和<a class="ae mc" href="https://ubuntu.com/download/raspberry-pi" rel="noopener ugc nofollow" target="_blank"> Ubuntu </a>。对于任何操作系统，你选择尝试和选择一个最小的安装，以保持操作系统的规模小，并使运行的东西更容易在功能不太强大的设备上。您可以在以下链接中找到如何将Raspberry Pi操作系统安装到您的Raspberry Pi的分步指南:</p><div class="md me gp gr mf mg"><a href="https://www.raspberrypi.com/software/operating-systems/" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">操作系统映像- Raspberry Pi</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">许多操作系统可用于Raspberry Pi，包括Raspberry Pi OS，我们官方支持的操作系统…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">www.raspberrypi.com</p></div></div></div></a></div><p id="a0dc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当在Raspberry Pi上运行操作系统并使用SD卡插槽时，您需要注意的一点是，SD卡内存确实会出现故障，因此要做好准备。由于Raspberry Pi循环供电的方式以及SD卡的低写入容量，随着时间的推移，SD卡的内存可能会损坏。</p><div class="md me gp gr mf mg"><a href="https://raspberrypi.stackexchange.com/questions/7978/how-can-i-prevent-my-pis-sd-card-from-getting-corrupted-so-often" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">怎么才能防止我Pi的SD卡这么频繁的被损坏？</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">我不打算写关于检查你的硬件和兼容的SD卡列表，因为你很可能已经…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">raspberrypi.stackexchange.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu jz mg"/></div></div></a></div><p id="4a99" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以采取一些缓解措施，例如将SD卡挂载切换为只读，或者为您的操作系统使用更稳定的存储，如附加SSD或HDD，如下所示:</p><div class="md me gp gr mf mg"><a href="https://www.amazon.com.au/StarTech-Converter-Raspberry-Development-Boards/dp/B01MQE6P9P" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">用于Raspberry Pi和开发板的StarTech.com USB转SATA转换器- USB转SATA适配器…</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">增加您的Raspberry Pi或其他开发板的数据存储容量，方法是将其直接连接到…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">www.amazon.com.au</p></div></div><div class="mp l"><div class="mv l mr ms mt mp mu jz mg"/></div></div></a></div><h1 id="4718" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">配置远程访问</h1><p id="67da" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">对于您的操作系统，我们需要对其进行配置，以便可以通过SSH从另一台机器上访问它。默认情况下，您的操作系统将通过DHCP自动从您的路由器获取IP地址，但我们希望配置一个静态地址，以便我们可以始终连接到同一个地址来访问我们的Raspberry Pi，它将在重启之间持续存在。</p><p id="ee4d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要更新网络接口以使用静态IP地址，请编辑<code class="fe mw mx my mz b">/etc/dhcpcd.conf</code>文件的内容。只需将<code class="fe mw mx my mz b">RASPBERRY_PI_IP</code>和<code class="fe mw mx my mz b">GATWAY_IP</code>分别切换为您希望Raspberry Pi使用的IP地址和您路由器的IP地址。</p><pre class="na nb nc nd gt ne mz nf ng aw nh bi"><span id="bdd9" class="ni la it mz b gy nj nk l nl nm">interface eth0<br/>static ip_address=RASPBERRY_PI_IP/24<br/>static routers=GATWAY_IP<br/>static domain_name_servers=1.1.1.1</span></pre><p id="a195" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在可以通过静态IP地址访问您的Raspberry Pi，我们需要在Raspberry Pi操作系统上启用SSH，这样我们就可以远程访问它。在使用命令行的Raspbian OS上，您可以使用以下命令轻松启用SSH服务。</p><pre class="na nb nc nd gt ne mz nf ng aw nh bi"><span id="10e1" class="ni la it mz b gy nj nk l nl nm"># Set the ssh service to start on boot<br/>sudo systemctl enable ssh</span><span id="a7c4" class="ni la it mz b gy nn nk l nl nm"># Start the ssh service immediately without a reboot<br/>sudo systemctl start ssh</span></pre><p id="8549" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有了运行在raspberry pi上的ssh服务，您现在可以从另一台机器上SSH到raspberry pi。使用另一台机器上的ssh客户端运行以下命令，替换您的raspberry pi的静态IP地址。</p><pre class="na nb nc nd gt ne mz nf ng aw nh bi"><span id="3e03" class="ni la it mz b gy nj nk l nl nm">ssh pi@RASPBERRY_PI_IP</span></pre><p id="d0b7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">系统会提示您输入Raspberry Pi的密码，一旦登录，您就可以作为Pi用户在Raspberry Pi机器上运行命令。对于通过其他工具访问机器来说，这是一种非常有用的模式，并且比必须设置另一组IO设备来使用它要方便得多。在下一节中，我们将介绍如何使用一些配置作为代码工具，以简单方便的方式管理raspberry pi上的服务和配置。</p><h1 id="cffd" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">以配置为代码运行服务</h1><p id="a57c" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">您的Raspberry Pi现已设置为远程访问，您可以开始在上面运行一些您自己的服务，或者根据您家庭实验室的需要进一步配置它。为了使这个过程更容易，更重要的是，如果您想在另一个Raspberry Pi上运行相同的配置步骤，我们可以使用接受配置作为代码的工具，这是一个概念，表明我们可以通过使用简单的配置来定义我们的计算机配置和服务，这些配置编写为代码，可以重复运行，每次都可以获得相同的结果。这样可以对您的计算机进行更加可预测的管理，并允许针对一台或多台主机多次运行相同的配置设置。</p><p id="c751" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这一节中，我们将提供一个示例，说明如何使用<a class="ae mc" href="https://www.ansible.com/resources/get-started" rel="noopener ugc nofollow" target="_blank"> ansible </a>编写简单的“行动手册”,定义您希望在目标主机上运行的顺序任务。对于示例ansible剧本，我们将在主机上安装一些包，并在主机上创建另一个用户。</p><pre class="na nb nc nd gt ne mz nf ng aw nh bi"><span id="eaa3" class="ni la it mz b gy nj nk l nl nm"># example-playbook.yaml</span><span id="edb7" class="ni la it mz b gy nn nk l nl nm">- name: Configure the raspberry pi<br/>  hosts: RASPBERRY_PI_IP</span><span id="8460" class="ni la it mz b gy nn nk l nl nm">tasks:<br/>  - name: "Update Apt Cache"<br/>    apt: <br/>      update_cache: yes<br/>    tags: installation</span><span id="4b09" class="ni la it mz b gy nn nk l nl nm">- name: "Install Common packages"<br/>    apt:<br/>      name: ['runc', 'python-pip', 'docker.io', 'python3-venv', 'docker-compose']<br/>      state: latest<br/>    tags: installation, packages<br/>  <br/>  - name: "Python Docker"<br/>    pip:<br/>      name: <br/>        - docker<br/>    tags: python<br/>  <br/>  - name: "Install Minikube"<br/>    shell: <br/>      cmd: curl -Lo ~/minikube <a class="ae mc" href="https://storage.googleapis.com/minikube/releases/latest/minikube-linux-arm" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/minikube/releases/latest/minikube-linux-arm</a> &amp;&amp; chmod +x ~/minikube &amp;&amp; mkdir -p /usr/local/bin/ &amp;&amp; install ~/minikube /usr/local/bin/<br/>    tags: installation, minikube</span></pre><p id="75b0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如您在行动手册中看到的，我们配置了主机的IP地址以及我们希望ansible使用的登录凭据，例如ssh用户名和密码，以及ansible在需要对主机执行某些操作时可以用来提升权限的sudo密码。Ansible有许多模块可用于常见的Linux系统功能，还有更多模块可用于您可能希望与之交互的其他服务或应用程序，如AWS、其他操作系统或Docker等。</p><p id="5bad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，您可以使用下面的脚本针对配置的目标主机运行创建的行动手册。</p><pre class="na nb nc nd gt ne mz nf ng aw nh bi"><span id="1098" class="ni la it mz b gy nj nk l nl nm">ansible-playbook example-playbook.yaml</span></pre><p id="2397" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您将看到每个任务在您的raspberry pi上运行时的输出。正如您所看到的，这种配置作为一种代码工具，可以非常容易地在机器上配置和运行一组命令，以产生所需的结果。这将为您节省更多的调试时间，因为每个命令的结果都更容易预测。最坏的情况是，如果一切都坏了，就用一个全新的操作系统重新开始，重新运行你的剧本。</p><p id="6145" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你想在你的堆栈上运行更多的服务，看看下面的文章，看看你能运行的10个最受欢迎的自托管应用。</p><div class="md me gp gr mf mg"><a href="https://aaron-kt-berry.medium.com/top-10-software-for-your-homelab-in-2021-98137a7de051" rel="noopener follow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">2021年家庭实验室的十大软件</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">你可能有很多理由来运行你的实验室，但是在你的实验室里总会有越来越多的新东西可以尝试…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">aaron-kt-berry.medium.com</p></div></div><div class="mp l"><div class="no l mr ms mt mp mu jz mg"/></div></div></a></div><h1 id="8d66" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">包扎</h1><p id="ba17" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">Raspberry Pi平台非常易于使用，为您提供了出色的可定制性，无论您想在其上学习或运行什么。现在，您应该对设置pi时要考虑的一些好的事项有了更好的了解，您可以如何配置它以便更容易地进行远程访问，以及如何使用配置作为代码来更容易地管理您的pi和它上面的软件。我建议一旦你有了你的raspberry pi设置，就在机器上设置一些重要的服务，比如备份你需要从raspberry pi保存的重要配置和文件，以及设置重要服务或日志的警报。</p><h1 id="41c1" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">进一步连接</h1><ul class=""><li id="ee40" class="np nq it kd b ke lx ki ly km nr kq ns ku nt ky nu nv nw nx bi translated">如果你正在考虑获得一个中等订阅，你可以通过使用我的<a class="ae mc" href="https://aaron-kt-berry.medium.com/membership" rel="noopener">推荐链接</a>来帮助我。</li><li id="1f06" class="np nq it kd b ke ny ki nz km oa kq ob ku oc ky nu nv nw nx bi translated">查看我在<a class="ae mc" href="https://medium.com/@aaron-kt-berry" rel="noopener">媒体</a>上的其他文章，如果你想了解最新消息，请通过<a class="ae mc" href="https://aaron-kt-berry.medium.com/subscribe" rel="noopener">电子邮件</a>订阅。</li><li id="4ed8" class="np nq it kd b ke ny ki nz km oa kq ob ku oc ky nu nv nw nx bi translated">如果你想聊天，在推特上联系我，或者在T2的LinkedIn上联系我，如果你想雇佣我，我在T4的Codementor上。</li></ul></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><h1 id="9933" class="kz la it bd lb lc ok le lf lg ol li lj lk om lm ln lo on lq lr ls oo lu lv lw bi translated">分级编码</h1><p id="08ec" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="134b" class="np nq it kd b ke kf ki kj km op kq oq ku or ky nu nv nw nx bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="e1df" class="np nq it kd b ke ny ki nz km oa kq ob ku oc ky nu nv nw nx bi translated">📰查看<a class="ae mc" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="277c" class="np nq it kd b ke ny ki nz km oa kq ob ku oc ky nu nv nw nx bi translated">🔔关注我们:<a class="ae mc" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae mc" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae mc" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="69b1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">🚀👉<a class="ae mc" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>