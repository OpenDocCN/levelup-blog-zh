<html>
<head>
<title>JavaScript Clean Code — Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript干净代码—函数</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-clean-code-functions-f719c326d624?source=collection_archive---------7-----------------------#2020-02-20">https://levelup.gitconnected.com/javascript-clean-code-functions-f719c326d624?source=collection_archive---------7-----------------------#2020-02-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/bf55cd349bc796881a5071d33a1f00d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rNTM1LFizPnClKpu"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kf" href="https://unsplash.com/@honest?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">诚信公司</a>的照片</figcaption></figure><p id="1d6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">函数是JavaScript程序的重要组成部分。它们用于将代码分割成可重用的块，这些块只做一件事。</p><p id="6b4a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，为了拥有清晰的JavaScript代码，我们必须拥有易于理解的函数。</p><p id="19af" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将看看如何编写干净、易于阅读和修改的函数。最重要的是写小函数。</p><h1 id="e3b3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">小功能</h1><p id="b6f2" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">功能应该很小。更小的函数做得更少，也更容易阅读。函数中的每一行应该在100个字符左右，这样它们就可以在任何屏幕上显示。</p><p id="67da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">做得越少意味着代码越少，意味着更容易阅读。如果一个功能不止做几件事，那么它应该被分成更小的功能。</p><p id="5041" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在旧的JavaScript代码中制作小函数是非常困难的，因为函数被用于许多它们不应该用于的事情，比如创建块和命名空间代码。</p><p id="12a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，现在我们有了JavaScript模块作为标准，我们可以逐步将函数转换为做函数应该做的事情，也就是做一件事情。</p><p id="dcad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，不是创建具有如下功能的块:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="5239" class="mq lf it mm b gy mr ms l mt mu">(function() {<br/>  var numFruits = 1;<br/>})();</span></pre><p id="140c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以改为写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="8e5c" class="mq lf it mm b gy mr ms l mt mu">{<br/>  let numFruits = 1;<br/>};</span></pre><p id="7385" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们都创建了隔离，但是我们没有滥用函数，相反，我们只有一个隔离的代码块。我们可以在ES6或更高版本中实现这一点。</p><p id="4c9e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">let</code>和<code class="fe mv mw mx mm b">const</code>应该分别用于创建块级变量和常量。</p><p id="48b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，如果我们想把相关的代码放入一个组中，我们可以使用模块。它们可以通过导入另一个模块的导出成员来使用。</p><p id="19a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以创建一个名为<code class="fe mv mw mx mm b">fruit.js</code>的文件，如下所示导出一个成员:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="f98a" class="mq lf it mm b gy mr ms l mt mu">export color = 'red';</span></pre><p id="cd8a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以将它导入到另一个名为<code class="fe mv mw mx mm b">main.js</code>的模块中，假设它们在同一个文件夹中，如下所示:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9b87" class="mq lf it mm b gy mr ms l mt mu">import { color } from './fruit'<br/>console.log(color);</span></pre><p id="5f35" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们不用函数就能得到代码隔离。</p><h1 id="6aaa" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">区块和缩进</h1><p id="2d0f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">缩进应该由代码格式化程序自动完成。我们应该有缩进两个空格的条件语句和循环。</p><p id="43ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">空格比制表符好，因为它们不会产生不同操作系统的问题。在某些系统中，选项卡可能看起来很混乱。</p><p id="5bdf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们不使用自动格式化JavaScript代码的文本编辑器，我们可以使用ESLine、JSLint或其他linters来处理缩进。</p><h1 id="0857" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">尽可能少做</h1><p id="3967" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">通常，好的函数应该只做一件事。长函数很难阅读，如果它们有很多内容，那么会让代码的读者感到困惑。</p><p id="f3b7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有一件事可能很难知道。如果它做的动作不止一个，那么很可能就太多了。</p><p id="d853" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，向用户呈现简单HTML的代码可以是一个函数，因为这就是它的全部功能。</p><p id="53d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，如果HTML中有许多部分，比如在多个地方循环从API中检索到的项目，以及if语句等等，那么它们就应该分成自己的函数。</p><p id="bc49" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一个函数有很多条件和循环，那么它们可以被拆分成各自的函数。</p><p id="ae28" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一种知道我们是否可以将某个东西移动到它自己的函数中的方法是，我们可以描述这段代码，而不必重述函数的实现。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/f2eb10c30d43b7213cfa2a5aa0f5fd04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ri6XhhnxaNMOiIKi"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">蒂娜·道森在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="f7ae" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">一个抽象层次</h1><p id="536f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">每个功能应该只有一个抽象层次。这意味着如果一个函数做一些高度抽象的事情，那么它应该只做这些事情。</p><p id="b240" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们想写一个函数，循环遍历一个数组的元素，并将其添加到一个列表中，那么它应该只做这一步。</p><p id="cb18" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是根据抽象级别将代码划分为功能的示例:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="8789" class="mq lf it mm b gy mr ms l mt mu">const addFruitLis = (fruits, ul) =&gt; {<br/>  for (const f of fruits) {<br/>    const li = document.createElement('li');<br/>    li.innerHTML = f;<br/>    ul.appendChild(li);<br/>  };<br/>}</span><span id="21ef" class="mq lf it mm b gy mz ms l mt mu">const addFruitUl = (fruits) =&gt; {<br/>  const ul = document.createElement('ul');<br/>  addFruitLis(fruits, ul);<br/>  document.body.appendChild(ul);  <br/>}</span><span id="c040" class="mq lf it mm b gy mz ms l mt mu">const fruits = ['apple', 'orange', 'grape'];<br/>addFruitUl(fruits);</span></pre><p id="e5c3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们有一个函数<code class="fe mv mw mx mm b">addFruitLis</code>，它创建了<code class="fe mv mw mx mm b">li</code>元素，并将其附加到参数中的<code class="fe mv mw mx mm b">ul</code>元素。</p><p id="7745" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个抽象层次，因为我们在生成<code class="fe mv mw mx mm b">ul</code>元素之后添加了<code class="fe mv mw mx mm b">li</code>元素。从等级上来说比<code class="fe mv mw mx mm b">ul</code>低一级。</p><p id="b8ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们定义了<code class="fe mv mw mx mm b">addFruitUl</code>函数来创建<code class="fe mv mw mx mm b">ul</code>元素，并将<code class="fe mv mw mx mm b">li</code>元素的添加委托给<code class="fe mv mw mx mm b">addFruitLis</code>函数。然后将<code class="fe mv mw mx mm b">ul</code>追加到文档的主体。这样每个函数只做尽可能少的事。</p><p id="ab00" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们通过传入一个数组来调用<code class="fe mv mw mx mm b">addFruitUl</code>函数，然后获取页面上的元素。</p><p id="a35a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个函数只处理一个抽象层次，因为<code class="fe mv mw mx mm b">addFruitLis</code>只处理<code class="fe mv mw mx mm b">ul</code>元素中的<code class="fe mv mw mx mm b">li</code>元素，而<code class="fe mv mw mx mm b">addFruitUl</code>只处理<code class="fe mv mw mx mm b">ul</code>元素。</p><p id="148c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">编写上述代码的错误方法是将所有内容都合并到一个函数中。这使得函数的代码变得复杂和混乱。</p><h1 id="d232" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="9b20" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">函数应该做一点可能的。我们可以通过将它们隔离在块和模块中来做到这一点。使用函数来做这件事的旧代码应该被淘汰。</p><p id="8ed4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，每个功能应该尽可能地少做，并且只处理一个抽象层次。否则，函数的代码会变得冗长而混乱。</p></div></div>    
</body>
</html>