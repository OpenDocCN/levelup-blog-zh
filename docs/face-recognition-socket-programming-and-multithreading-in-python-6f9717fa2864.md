# Python ä¸­çš„äººè„¸è¯†åˆ«ã€å¥—æ¥å­—ç¼–ç¨‹å’Œå¤šçº¿ç¨‹

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/face-recognition-socket-programming-and-multithreading-in-python-6f9717fa2864>

## â³åœ¨ä¸‹é¢çš„ææ–™ä¸­ï¼Œæˆ‘ä»¬å°†è¯´æ˜ç½‘ç»œå¥—æ¥å­—(ç‰¹åˆ«æ˜¯ TCP)çš„æœºåˆ¶ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ„å»ºä¸€ä¸ªå…·æœ‰å¤šçº¿ç¨‹æœåŠ¡å™¨çš„äººè„¸è¯†åˆ«åº”ç”¨ç¨‹åºã€‚

![](img/e8c28cfe513a5aad6a3620e2829331b1.png)

åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šç”± [Neven Krcmarek](https://unsplash.com/@nevenkrcmarek?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„ç…§ç‰‡

# ğŸ‘‰å¥—æ¥å­—é€šä¿¡

[**å¥—æ¥å­—**](https://en.wikipedia.org/wiki/Network_socket) æ˜¯è¿›ç¨‹é—´çš„ä¸€ç§é€šä¿¡æ–¹å¼ã€‚å®ƒä¸å…¶ä»–è¿›ç¨‹çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œå®ƒå¯ä»¥å®ç°ä¸¤ä¸ªæˆ–å¤šä¸ªä¸åŒä¸»æœºã€æœºå™¨ã€èŠ‚ç‚¹â€¦â€¦(ä¸åŒ IP åœ°å€)ä¹‹é—´çš„ [**è¿›ç¨‹é—´é€šä¿¡**](https://en.wikipedia.org/wiki/Inter-process_communication) ã€‚ä¸ºäº†å®Œæˆé€šä¿¡ï¼Œå¥—æ¥å­—æ€»æ˜¯å­˜åœ¨äºæˆ‘ä»¬çš„ç½‘ç»œä¸­ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬æ¯å¤©ä¸Šç½‘ã€æµå¼ä¼ è¾“ã€å‘é€å’Œæ¥æ”¶ç”µå­é‚®ä»¶ç­‰ã€‚

å…³äºè¿›ç¨‹é€šä¿¡æœ€é‡è¦çš„äº‹æƒ…æ˜¯æ¯ä¸ªè¿›ç¨‹å¿…é¡»è¢«å”¯ä¸€åœ°æ ‡è¯†ã€‚ä¾‹å¦‚ï¼Œåœ¨ TCP/IP ç½‘ç»œåè®®ä¸­ï¼Œè¿›ç¨‹ç”±(IP åœ°å€ã€åè®®(TCP æˆ– UDP)ã€ç«¯å£å·)ä¸‰å…ƒç»„æ¥æ ‡è¯†ã€‚

# ğŸ‘‰TCP åè®®

TCP æ˜¯é¢å‘è¿æ¥çš„ [**ä¼ è¾“å±‚**](https://en.wikipedia.org/wiki/Transport_layer) åè®®ã€‚TCP Socket åŸºäºä¸€ç§[](https://en.wikipedia.org/wiki/Client%E2%80%93server_model)****çš„å®¢æˆ·-æœåŠ¡å™¨æ¨¡å‹(æˆ–è€…æ›´ä¸€èˆ¬åœ°è¯´æ˜¯**ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹**)ã€‚æœåŠ¡å™¨å¤„ç†å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œå¹¶åœ¨è¿æ¥å»ºç«‹åä¼ è¾“æ•°æ®(**ä¸‰æ¬¡æ¡æ‰‹):******

****![](img/04affec28229aaa9e6dabdb15d2e6492.png)****

****Wireshark æ•è·çš„å›¾åƒ:id = 443 å’Œ id =47976 çš„ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„ 3 æ¬¡æ¡æ‰‹****

****![](img/7e54db74a8272d832fdf50c231a4f3a7.png)****

****æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„ 3 æ¬¡æ¡æ‰‹****

# ****ğŸ‘‰python ä¸­çš„å¥—æ¥å­—****

****ä¸ºäº†ä½¿ç”¨å¥—æ¥å­—ï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥ç›¸åº”çš„å†…ç½®æ¨¡å—ã€‚****

```
**import socket**
```

****ç°åœ¨æ‚¨éœ€è¦åˆ›å»º socket å¯¹è±¡çš„ä¸€ä¸ªå®ä¾‹:****

```
**server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)**
```

****å¯è°ƒç”¨å‡½æ•°å¥—æ¥å­—æ¥å—ä¸¤ä¸ªå‚æ•°ä½œä¸ºè¾“å…¥:****

> ******åœ°å€æ—**:ä¸‰ä¸ªä¸»è¦å€¼ä¹‹ä¸€:****

```
**+-------------------+--------------------+
| **Address family**  |   ** Explanation **    |
+-------------------+--------------------+
|  socket.AF_INET   |    IPv4 socket     | 
|  socket.AF_INET6  |    IPv6 socket     |
|  socket.AF_UNIX   |  IPC(local socket) | 
+-------------------+--------------------+
IPC : Inter-Process Communication**
```

> ******æ’åº§ç±»å‹:**å››ä¸ªå€¼ä¹‹ä¸€:****

```
**+---------------------+--------------------+
| **Socket type**    |   ** Explanation **    |
+---------------------+--------------------+
|  socket.SOCK_STREAM |    TCP  socket     | 
|  socket.SOCK_DGRAM  |    UDP  socket     |
|socket.SOCK_SEQPACKET|  sequenced packet  | 
|  socket.SOCK_RAW    |   raw protocols    |
+---------------------+--------------------+**
```

****è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªè¡¨ç¤ºå¥—æ¥å­— id çš„æ•´æ•°ï¼Œå¦åˆ™è¿”å›-1ï¼Œè¡¨ç¤ºå‘ç”Ÿäº†é”™è¯¯ã€‚****

****é€šä¿¡æ˜¯é€šè¿‡è¿™ç§å¥—æ¥å­—ç±»å‹å’Œåœ°å€æ—çš„ç»„åˆæ¥å»ºç«‹çš„ã€‚****

****ä¾‹å¦‚ï¼Œ**æ’åº§ã€‚AF_INET** å’Œ**æ’åº§ã€‚SOCK_STREAM** å¯ç”¨ **IPv4** åœ°å€å’Œ **TCP** é€šä¿¡ã€‚****

****ç°åœ¨æˆ‘ä»¬åœ¨**å¥—æ¥å­—** **å˜é‡**ä¸­æœ‰äº†ä¸€ä¸ª**å¥—æ¥å­—**ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åšè¿›ä¸€æ­¥çš„å·¥ä½œã€‚****

# ****ğŸ‘‰TCP å¥—æ¥å­—æœåŠ¡å™¨****

****TCP åè®®èƒŒåçš„ä¸»è¦æ€æƒ³æ˜¯ä¸€ä¸ªç¨‹åºä¸å¦ä¸€ä¸ªç¨‹åºå»ºç«‹è¿æ¥ï¼Œå®ƒä»¬äº¤æ¢æ•°æ®ï¼Œæ²¡æœ‰ä¸¢å¤±ã€‚å®Œæˆåï¼Œåº”è¯¥å…³é—­è¿æ¥ã€‚****

****![](img/19a18782e6f0419b197f5a4737a2de14.png)****

****ä¼šè®®é—­å¹•****

****åœ¨ TCP ä¸­ï¼Œæ•°æ®ä»¥å­—èŠ‚ä¸ºå•ä½è¿›è¡Œäº¤æ¢ã€‚ç¨‹åºåº”è¯¥æŠŠå®ƒåˆ†æˆå•ç‹¬çš„æ¶ˆæ¯ã€‚****

****ä¸ºäº†åˆ›å»ºæœåŠ¡å™¨ï¼Œæ‚¨éœ€è¦å°†ä¸€ä¸ªå¥—æ¥å­—ä¸è®¡ç®—æœºä¸Šçš„ä¸€ä¸ªæˆ–æ‰€æœ‰ä¸»æœº(IP åœ°å€)å’Œä¸€äº›ç©ºé—²ç«¯å£å·([å·²åˆ†é…ç«¯å£åˆ—è¡¨](https://www.webopedia.com/quick_ref/portnumbers.asp#:~:text=Port%20numbers%20range%20from%200,process%20as%20its%20contact%20port.))ç›¸å…³è”ã€‚Ip åœ°å€â€œ0.0.0.0â€è¡¨ç¤º*æœ¬åœ°æœºå™¨ä¸Šçš„æ‰€æœ‰ IPv4 åœ°å€*ã€‚å¦‚æœæŒ‡å®šâ€œ127.0.0.1â€æˆ–â€œlocalhostâ€(ç¯å›åœ°å€)ï¼Œåˆ™åªèƒ½ä»åŒä¸€å°è®¡ç®—æœºè¿æ¥ã€‚****

****ç°åœ¨ä½ éœ€è¦å°† IP åœ°å€ç»‘å®šåˆ°å¥—æ¥å­—ä¸Šã€‚è¿™ä¸ªæ–¹æ³•é‡‡ç”¨ 2 å…ƒç»„ä½œä¸ºå‚æ•°:IP åœ°å€æˆ–ä¸»æœºåï¼Œä»¥åŠç«¯å£å·ã€‚è¿™å°±æ˜¯ä¼ ç»Ÿä¸Šæ‰€è¯´çš„[](https://linux.die.net/man/2/bind)****

```
****HOST = "localhost"
PORT = 5555 
server_socket.bind((HOST, PORT))****
```

******æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨ **accept** æ–¹æ³•ä¹‹å‰æŒ‡å‡ºè¿æ¥é˜Ÿåˆ—ä¸­å¯ç”¨çš„æœ€å¤§è¿æ¥æ•°ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨**ç›‘å¬**åŠŸèƒ½æ¥å®Œæˆ:******

```
**server_socket.listen(5) # 5 connections can only be available in the queue**
```

****åœ¨**æˆåŠŸ**æ—¶ï¼Œå®ƒå°†è¿”å›**é›¶**ã€‚å¦åˆ™ï¼Œè¿”å› **-1** ã€‚****

****ç°åœ¨ä½¿ç”¨ accept å‡½æ•°æ¥å—è¿æ¥ã€‚è¿™ä¸ªå‡½æ•°é˜»å¡æœåŠ¡å™¨ï¼Œç›´åˆ°å‡ºç°ä¸€ä¸ªä¼ å…¥çš„è¿æ¥ï¼Œå¹¶è¿”å›ä¸ä¹‹ç›¸å…³è”çš„å¥—æ¥å­—å¯¹è±¡å’Œæ‰€è¿æ¥ä¸»æœºçš„åœ°å€ã€‚**åœ°å€**æ˜¯ç”± **IP åœ°å€**å’Œ**ç«¯å£å·**ç»„æˆçš„æ•°ç»„ã€‚****

```
**client_socket, addr = server_socket.accept()# addr is an array
print('\n[*] Connected from ip: {} and port : {} '.format(addr[0],addr[1]))**
```

****ä½¿ç”¨ client_socket å¯¹è±¡ï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨å¯ä»¥ä¸å®¢æˆ·æœºäº¤æ¢æ•°æ®ã€‚****

> ******addr [0]** :è¿æ¥å®¢æˆ·ç«¯çš„ IP åœ°å€ã€‚****
> 
> ******addr[1]** :å¥—æ¥å­—çš„ç«¯å£å·ï¼Œå¯ä»¥åœ¨å…¶ä¸­ä¸è¿æ¥çš„å®¢æˆ·ç«¯äº¤æ¢æ•°æ®ã€‚(æœåŠ¡å™¨ç«¯ç«¯å£)****

****è¦å»ºç«‹ä¸æ–°å®¢æˆ·æœºçš„æ–°è¿æ¥ï¼Œæ‚¨éœ€è¦è°ƒç”¨ accept å‡½æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¾ªç¯æ¥æ¥å—æ— é™æ•°é‡çš„è¿æ¥ã€‚****

```
**while True:
  print('\n[*] Waiting for client...')
  # Wait to accept a connection - blocking call
  client_socket, addr = server_socket.accept()**
```

****åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨çœ‹èµ·æ¥å¾ˆæ£’ã€‚****

****ç°åœ¨è¦ä»å®¢æˆ·ç«¯è¯»å–ä¼ å…¥çš„æ•°æ®ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ **recv()** æ–¹æ³•ã€‚****

```
**Bytes_Number = 8 * 1024 # Number of bytes to receive, 8 kilo-bytes
# 1 byte is equivalent to 8 bits
data = client_socket.recv(Bytes_Number)** 
```

****æ¢å¥è¯è¯´ï¼Œâ€œå­—èŠ‚æ•°â€æ˜¯ç½‘ç»œç¼“å†²åŒºçš„å¤§å°ã€‚****

****ä»å¥—æ¥å­—æ¥æ”¶çš„æ•°æ®ç±»å‹æ˜¯å­—èŠ‚ï¼Œå¦‚ä¸‹æ‰€ç¤º:****

```
**data = bâ€™\xed0\x00\x00\x00\x00\x00\x00'# byte array of hex values
data = data.hex()# convert to **hexadecimal** values.**
```

****ç°åœ¨æ•°æ®çš„å€¼å˜æˆäº†åå…­è¿›åˆ¶è¡¨ç¤ºçš„â€œd02900000000000â€ã€‚æ³¨æ„ï¼Œè¿™ä¸ªè¡¨ç¤ºæ˜¯ä»¥**å¤§ç«¯**æ ¼å¼ã€‚æ‰€ä»¥ä¸ºäº†æ‰¾åˆ°è¿™ä¸ªæ•°çš„åè¿›åˆ¶å€¼ï¼Œä½ éœ€è¦ä»¥è¿™æ ·çš„æ–¹å¼äº¤æ¢å­—èŠ‚ï¼Œæœ€é«˜æœ‰æ•ˆä½å˜æˆæœ€ä½æœ‰æ•ˆä½ã€‚****

```
**data = 00000000000029d0 # equivalent to 10704 in decimal**
```

****åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œè¿™ä¸ªæ•°å­—è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€çš„å›¾åƒçš„å¤§å°ã€‚è¯·ç»§ç»­é˜…è¯»ï¼Œäº†è§£æ›´å¤šå…³äºè¿™ä¸ªæ•°å­—çš„ä¿¡æ¯ã€‚****

****ä½¿ç”¨ **send()** å‡½æ•°ï¼Œå¯ä»¥å‘ socket å‘é€æ•°æ®ã€‚å®ƒä¹Ÿæ¥å—å­—èŠ‚ï¼Œæ‰€ä»¥è¦å‘é€ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½ å¿…é¡»å¯¹å®ƒè¿›è¡Œç¼–ç ã€‚****

```
**str = "Hi"
client_socket.send (b "Hello From Server" ) 
client_socket.send (b "Your data:"  + str.encode ( "utf-8" ))**
```

****å¦‚æ‚¨æ‰€è§ï¼Œåœ¨è¿™ä¸¤ä¸ªå‡½æ•° **send** å’Œ **recv çš„å¸®åŠ©ä¸‹ï¼Œæ•°æ®å¯ä»¥åœ¨æ•´ä¸ª TCP è¿æ¥ä¸­è¿›è¡Œäº¤æ¢ã€‚******

****æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ **sendall()** æ–¹æ³•æ¥å‘é€æ‚¨ä½œä¸ºå‚æ•°ä¼ é€’çš„æ•´ä¸ªç¼“å†²åŒºã€‚äº‹å®ä¸Šï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ **send()** æ–¹æ³•é‡æ–°å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤º:****

```
**def sendall(socket, data):
    ret = socket.send(data) # return the nb of bytes sent
    while ret > 0:
        ret = socket.send(data[ret:])
    return None**
```

# ****ğŸ‘‰TCP å¥—æ¥å­—å®¢æˆ·ç«¯****

****åœ¨å®¢æˆ·ç«¯ï¼Œåˆ›å»ºå¥—æ¥å­—çš„æ–¹å¼ä¸åœ¨æœåŠ¡å™¨ç«¯å®Œå…¨ç›¸åŒ:****

```
**client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)**
```

****ç°åœ¨ï¼ŒåŒºåˆ«å­˜åœ¨äºå®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥åˆ°æœåŠ¡å™¨å·²ç»æ‰“å¼€çš„å¥—æ¥å­—ï¼Œè€Œä¸æ˜¯ç›‘å¬å¥—æ¥å­—ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨**è¿æ¥**æ–¹æ³•:****

```
**HOST = 'localhost' 
TCP_PORT = 5555 # the port number that is opened by the server
Client_Socket.connect((HOST, TCP_PORT))**
```

****åœ¨æœåŠ¡å™¨ç«¯ï¼Œ **accept** æ–¹æ³•å°†æ‰“å¼€ä¸ä¹‹å‰è¿æ¥çš„å®¢æˆ·ç«¯çš„è¿æ¥ã€‚****

```
**client_socket, addr = server_socket.accept() #server side connection**
```

****![](img/4ebd58e2eb9198cda58d5740f145dcc2.png)****

****å®¢æˆ·ç«¯-æœåŠ¡å™¨å·¥ä½œæµ****

****ç„¶åä¸€åˆ‡å¦‚å¸¸ã€‚****

****ç°åœ¨å›åˆ°æˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿå‘é€å›¾åƒå’Œæ¥æ”¶å¯è¯†åˆ«å›¾åƒçš„å®¢æˆ·ç«¯ã€‚æ ¹æ®æˆ‘çš„ç»éªŒï¼Œè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ‰ä¸¤ç§å‘é€å›¾åƒçš„æ–¹æ³•ã€‚****

******1-å°†å›¾åƒä½œä¸ºäºŒè¿›åˆ¶æ–‡ä»¶åŠ è½½ï¼Œå¹¶ä»¥å­—èŠ‚å—çš„å½¢å¼å‘é€ï¼Œå¦‚ä¸‹æ‰€ç¤º:******

******ç¨‹åºçš„å·¥ä½œæµç¨‹:******

```
**CLIENT                                             SERVER
                   Send chunks of Image
load image   ---------------------------------->  Read Bytes
                        Send b'0' 
as binary    ---------------------------------->  End of Image
                  Send the received image
Read Bytes   <----------------------------------  Read and Save
                        Send b'0'
End of Image <----------------------------------

Read + Save  ---------------------------------->  Closing the socket
                   Client Closes Socket**
```

******server.py******

******client.py******

****è¿è¡ŒæœåŠ¡å™¨å°†ç”Ÿæˆä»¥ä¸‹è¾“å‡º:****

```
 **(base) harmouch@kali:~/Desktop$ python3 server.py[*] Socket successfully created[*] Socket is now listening[*] Connected from ip: 127.0.0.1 and port : 51126 
Image received and recreated
Sending image data...
Length Data sent:4096
Length Data sent:4096
Length Data sent:2270
Length Data sent:0----------------Connection Closed-------------------**
```

****ç°åœ¨ï¼Œè¿è¡Œå®¢æˆ·ç«¯å°†æç¤ºä»¥ä¸‹å†…å®¹:****

```
**(base) harmouch@kali:~/Desktop$ python3 client.py[*] Socket successfully created[*] Connecting to server @ ip = localhost and port = 3333[*] Sending image as bytes...
1
4096
4096
2269[*] Finish sending the image...----------------------------------------------------------------Receving data-------------------------------------------------------------------[*] Length of Data received: 4096[*] Length of Data received: 4096[*] Length of Data received: 2270[*] Length of Data received: 1**
```

******2-ç¬¬äºŒç§æ–¹æ³•:******

****å°†å›¾åƒä½œä¸ºä¸‰ç»´æ•°ç»„(RGB)è¯»å–ï¼Œå¹¶ä½¿ç”¨ cv2.imencode å°†å…¶ç¼–ç ä¸ºæŸç§æ ¼å¼(jpegã€jpgã€pngâ€¦)ã€‚****

```
**image = cv2.imread("img.jpg")
encode_param = [int(cv2.IMWRITE_JPEG_QUALITY), 90]
result, frame = cv2.imencode('.jpeg', image, encode_param)**
```

****åœ¨æœ¬ä¾‹ä¸­ï¼Œ **cv2.imencode()** å‡½æ•°å°†ç”¨ jpeg å‹ç¼©å°†å›¾åƒæ ¼å¼è½¬æ¢æˆå­—èŠ‚ï¼Œå¹¶å°†å…¶åˆ†é…ç»™æŸä¸ªå†…å­˜ç¼“å­˜ã€‚****

****ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å‘é€å‹ç¼©å›¾åƒçš„å¤§å°åŠå…¶å­—èŠ‚è¡¨ç¤ºï¼Œä»¥è®©ç½‘ç»œçš„å¦ä¸€ç«¯(æœåŠ¡å™¨)çŸ¥é“ä»–éœ€è¦æ¥æ”¶å¤šå°‘å­—èŠ‚ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨ **struct.pack** å‡½æ•°æ¥å®Œæˆ:****

```
**Client_Socket.sendall(struct.pack("l",size) + data)**
```

******struct.pack r** è¿”å›ä¸€ä¸ªåŒ…å«å€¼ **size** çš„ bytes å¯¹è±¡ï¼Œç”¨ **long** æ ¼å¼æ‰“åŒ…ï¼Œå‘é€å›¾åƒçš„æ‰€æœ‰å­—èŠ‚åŠå…¶å¤§å°ã€‚****

****æ­¤æ—¶ï¼ŒæœåŠ¡å™¨å¯ä»¥æ£€ç´¢å¥—æ¥å­—ç¼“å†²åŒºä¸­å­˜åœ¨çš„å­—èŠ‚ï¼Œå¦‚ä¸‹æ‰€ç¤º:****

```
**CHUNK_SIZE = 4 * 1024 # 4 kB
encode_param = [int(cv2.IMWRITE_JPEG_QUALITY), 90]
# struct_size is 8 bytes
struct_size = struct.calcsize("l")
img_size= client_socket.recv(struct_size) # reads 8 bytes to store #the size of the image 
# struct.unpack retrun a tuple 
img_size = struct.unpack("l", img_size)[0] # 8 bytes
# read 4 kB from the buffer each time untill img_size
while len(data) < img_size:
  data += client_socket.recv(CHUNK_SIZE)
  print("\n[*] Receiving ",len(data))
frame_data = data[:img_size]
data = data[img_size:]
frame=pickle.loads(frame_data)
frame = cv2.imdecode(frame, cv2.IMREAD_COLOR)**
```

******ä»£ç ******

******Server.py******

******Client.py******

******ç¨‹åºçš„å·¥ä½œæµç¨‹:******

```
**CLIENT                                             SERVER

Read frame     Encode,Send The Image with size
of the video ---------------------------------->  Read Bytes,decode         

Read Bytes                                        predict the label
              Encode,Send The Recognized Image 
End of Image <----------------------------------** 
```

****ç¨‹åºçš„è¾“å‡ºçœ‹èµ·æ¥ä¼šåƒè¿™æ ·:****

****![](img/1720b0113a0ddb7ce3be78e4865454fd.png)****

****æˆ‘ä»¬çš„æœåŠ¡å™¨åªèƒ½å¤„ç†ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œæ‰€ä»¥è¦å¤„ç†ä¸‹ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå®ƒåº”è¯¥ç­‰åˆ°ä¸Šä¸€ä¸ªå®¢æˆ·ç«¯æœåŠ¡å®Œæˆä¹‹åã€‚æˆ‘ä»¬èƒ½æ”¹è¿›å®ƒå—ï¼Ÿï¼Ÿ****

****ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé€šè¿‡åˆ©ç”¨ç‰©ç†èµ„æº(CPU çº¿ç¨‹)ã€‚****

> ****è¯¥è¯†åˆ«ç®—æ³•å…ˆå‰åœ¨æœ¬æ–‡ **çš„ [**ä¸­è®¨è®ºè¿‡ã€‚**](https://medium.com/dev-genius/face-recognition-based-on-lbph-algorithm-17acd65ca5f7)******

# **ğŸ‘‰**å¤šçº¿ç¨‹****

**å¤šçº¿ç¨‹æ˜¯ä¸€ä¸ªä½çº§ç¼–ç¨‹æ¦‚å¿µï¼Œæ‰€æœ‰é«˜çº§ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒå®ƒã€‚**

**![](img/c570f44d240813b26a814d129ec85ff2.png)**

## **ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ**

**å¤„ç†å™¨æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå†…æ ¸ï¼Œæ¯ä¸ªå†…æ ¸æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹æ˜¯å…·æœ‰ç‹¬ç«‹æŒ‡ä»¤é›†çš„æœ€å°æ‰§è¡Œå•å…ƒã€‚å®ƒæ˜¯è¿›ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œè¿è¡Œåœ¨ä¸å†…å­˜ç›¸åŒçš„ä¸Šä¸‹æ–‡å…±äº«ç¨‹åºçš„å¯æ‰§è¡Œèµ„æºä¸Šã€‚**

## ****å¤šçº¿ç¨‹**çš„ä¼˜ç‚¹:**

**1-å®ƒæé«˜äº†å¤šæ ¸ç³»ç»Ÿçš„è®¡ç®—é€Ÿåº¦**

**2-æ‰€æœ‰è¿›ç¨‹çº¿ç¨‹å¯ä»¥å…±äº«å…¨å±€å˜é‡ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªå…¨å±€å˜é‡åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å‘ç”Ÿå˜åŒ–ï¼Œå®ƒä¼šå½±å“å…¶ä»–çº¿ç¨‹ã€‚**

**3-å®ƒå…è®¸ç¨‹åºåœ¨å•ç‹¬å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹æ—¶ä¿æŒå“åº”ã€‚**

## ****å¤šçº¿ç¨‹**çš„ç¼ºç‚¹:**

**1-åœ¨å•å¤„ç†å™¨ä¸­ï¼Œç³»ç»Ÿæ€§èƒ½å¯èƒ½ä¼šä¸‹é™ã€‚**

**2-å¢åŠ å†…å­˜å’Œå¤„ç†å™¨çš„ä½¿ç”¨ã€‚**

**3-å¢åŠ äº†ç¨‹åºçš„å¤æ‚æ€§ã€‚**

**åœ¨ python ä¸­ï¼Œæœ‰ä¸¤ä¸ªå…è®¸å¤šçº¿ç¨‹çš„æ¨¡å—:**

*   *****èºçº¹*****
*   *****ç©¿çº¿*****

**è¦åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ®µä»£ç :**

```
t = threading.Thread(target=function, args=(arg1,arg2 ...))
t.start()
```

**å› æ­¤å°†åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ç›®æ ‡**å‡½æ•°**ä»¥åŠè¯¥å‡½æ•°çš„**å‚æ•°** arg1ï¼Œarg2â€¦å‚æ•°ã€‚**

**ç°åœ¨ï¼Œæ‚¨å¯ä»¥è¿è¡Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œäººè„¸è¯†åˆ«:**

**![](img/8a872262ed8a83246bd204501fe13bc8.png)**

**ç°åœ¨ä½ å¯èƒ½ä¼šé—®:æˆ‘ä»¬å¯ä»¥è¿è¡Œå¤šå°‘ä¸ªçº¿ç¨‹ï¼Ÿ**

**ç­”æ¡ˆå–å†³äºæ‚¨çš„ CPU èƒ½åŠ›:å¤„ç†å™¨æœ‰å¤šå°‘ä¸ªå†…æ ¸æˆ–çº¿ç¨‹ï¼Œå°±æœ‰å¤šå°‘ä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¿è¡Œã€‚**

# **ğŸ‘‰ç»“è®º**

**æˆ‘å¸Œæœ›è¿™ä¸ªåŸºæœ¬çš„ Python ç½‘ç»œ/å¤šçº¿ç¨‹å¸–å­éå¸¸æœ‰è¶£å’Œç›´è§‚ã€‚æ­¤å¤–ï¼Œæˆ‘åœ¨æœ¬æ–‡ä¸­æ·»åŠ äº†å‡ ä¸ªæ’å›¾ï¼Œè¿™äº›æ’å›¾æ— ç–‘ä¼šå¸®åŠ©æ‚¨æé«˜ Python æŠ€èƒ½ã€‚**

**ä½ å¯ä»¥éšæ—¶åœ¨ GitHub ä¸ŠæŸ¥çœ‹æˆ‘çš„é¡¹ç›®ä»£ç ã€‚è¯·éšæ„å‰æˆ‘çš„å›è´­ï¼Œå¹¶ä¸ºè¿™ä¸ªé¡¹ç›®ä½œå‡ºè´¡çŒ®ï¼Œä»¥ä¾¿æ”¹å–„å®ƒï¼Œå¦‚æœä½ æƒ³ã€‚**

**[](https://github.com/Harmouch101/Face-Recogntion-Detection) [## harmouch 101/äººè„¸è¯†åˆ«æ£€æµ‹

### è¿™ä¸ªé¡¹ç›®å®ç°äº†ä¸€ä¸ªäººè„¸æ£€æµ‹ç®—æ³•ï¼Œä½¿ç”¨çš®è‚¤åˆ†å‰² RGB-YCrCb-HSVï¼Œviola jones å’Œäººè„¸â€¦

github.com](https://github.com/Harmouch101/Face-Recogntion-Detection) 

> å¯“æ„:â€œä¸€ä¸ªä»£ç å¯ä»¥å»ºç«‹ä¸€ä¸ªå®Œæ•´çš„ä¸–ç•Œï¼Œå¦ä¸€ä¸ªå¯ä»¥æ‘§æ¯ä¸€ä¸ªï¼Œè€Œä½ å°±æ˜¯é‚£ä¸ªå†³å®šçš„äººâ€¦â€¦â€**