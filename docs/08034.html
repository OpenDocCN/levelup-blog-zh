<html>
<head>
<title>Building a Google Assistant with Interactive Canvas and ReactJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用交互式画布和ReactJS构建谷歌助手</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-2-3aa88584d4cd?source=collection_archive---------13-----------------------#2021-03-29">https://levelup.gitconnected.com/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-2-3aa88584d4cd?source=collection_archive---------13-----------------------#2021-03-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7acb4a1a367b1f0a1c988bf56ebfa4ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byvYks2XhTssieyClMDngg.png"/></div></div></figure><p id="2148" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上一部分中，我介绍了一些事情，比如您需要的工具的基本设置，以及通过控制台在Google project上的操作。</p><p id="ed43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你错过了，这里是:</p><div class="kw kx gp gr ky kz"><a href="https://celiaongsl.medium.com/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-1-5e290eccfdbd" rel="noopener follow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">用交互式画布和ReactJS构建谷歌助手——第1部分</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">如果你一直在探索谷歌助手及其产品，你应该见过谷歌巢枢纽，并可能阅读其…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">celiaongsl.medium.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><p id="a4e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这一部分中，我们将介绍如何设置我们的ReactJS，Firebase主机和在本地Google上拉动我们的操作，以便我们可以将所有这些连接在一起，并充分利用交互式画布！</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="7899" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">设置您的创建-反应-应用程序和Firebase</h1><p id="ea8e" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">首先，进入您希望项目所在的文件夹。例如，我的文件夹是<code class="fe my mz na nb b">Documents/Google Actions Projects</code>，所以我将<code class="fe my mz na nb b">cd</code>到那个文件夹中。</p><p id="252b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你在那个文件夹中时，像你每次做的那样创建你的react应用。为了让生活更容易，我将只使用<code class="fe my mz na nb b">create-react-app</code>。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="b007" class="nk lw iq nb b gy nl nm l nn no">npx create-react-app new-york-times-bestseller</span></pre><p id="b32e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，将cd放入您的项目文件夹:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="9f54" class="nk lw iq nb b gy nl nm l nn no">cd new-york-times-bestseller</span></pre><p id="26a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">初始化你的firebase:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="ab36" class="nk lw iq nb b gy nl nm l nn no">firebase init</span></pre><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/3d99e8db964bcba90fc38a0602bce532.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZIAdRgJBnPHrICcEmrP_Q.png"/></div></div></figure><p id="d190" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为您的Firebase特性选择“<strong class="ka ir">主机</strong>和“<strong class="ka ir">功能</strong>”。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/d1479caf1baa43389190612d01812bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMQJSMat1YK-UQi1J0Cibw.png"/></div></div></figure><p id="beb0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保在“<strong class="ka ir">为这个目录</strong>选择一个默认的Firebase项目”下，您选择了您在上一部分中创建的对Google project的操作！</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/147847a083a0907fd8109fa65984fdcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FS6vpgBGVeXcd_1E5wZBtg.png"/></div></div></figure><p id="6a96" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后继续回答上面图片中的几个问题。</p><p id="6356" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完成后，在任何你喜欢的IDE中打开你的React应用。</p><p id="80ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">打开<code class="fe my mz na nb b">public</code>文件夹，打开<code class="fe my mz na nb b">index.html</code>。</p><p id="6673" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将这一行添加到您的<code class="fe my mz na nb b">&lt;head&gt;</code>标签中:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="cdb1" class="nk lw iq nb b gy nl nm l nn no">&lt;!-- Load Interactive Canvas JavaScript --&gt;<br/>&lt;script src="https://www.gstatic.com/assistant/conversational/df-asdk/interactivecanvas/api/interactive_canvas.min.js"&gt;&lt;/script&gt;</span></pre><p id="0adc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是加载交互式Canvas JavaScript库所必需的，它支持web应用程序和对话动作之间的通信。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/3072bcced0aa83eeeddb5b4921ad5a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dgeYFB4vhQizR7MSk8R8zA.png"/></div></div></figure><p id="fd0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在我们接触React应用程序之前，让我们确保我们可以构建和部署网站！</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/0b30f914697539ae4cc803c739742b6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cK1uycJtYq-jjq8Vs6yiHw.png"/></div></div></figure><p id="8857" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的终端中，确保您位于项目文件夹的<strong class="ka ir">根目录</strong>，运行:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="f602" class="nk lw iq nb b gy nl nm l nn no">yarn build &amp;&amp; firebase deploy</span></pre><p id="1e9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要运行<code class="fe my mz na nb b">firebase deploy</code>来部署您的<code class="fe my mz na nb b">functions</code>和<code class="fe my mz na nb b">hosting</code>。</p><p id="892a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nu">注意:</em> <code class="fe my mz na nb b"><em class="nu">yarn build</em></code> <em class="nu">对你来说可能是不同的——确保你知道如何运行你的构建，如果你所做的与我的不同的话！</em></p><p id="6a06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果一切顺利，你应该会在底部看到<code class="fe my mz na nb b">Hosting URL</code>。打开它，您应该会看到类似这样的内容:</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/35554675f515a3069fdd7b13a9e522e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjC3vj5mowGkvCGTNgA1fA.png"/></div></div></figure><p id="e807" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这表明你已经成功地部署了你的网站！</p><h1 id="9c02" class="lv lw iq bd lx ly nw ma mb mc nx me mf mg ny mi mj mk nz mm mn mo oa mq mr ms bi translated">将您部署的网站连接到Google上的操作</h1><p id="513d" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">现在您已经部署了网站和AoG设置，我们需要在您的AoG中打开交互式画布。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/7a5696b677312a4d8fc2a78032cd955c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-IXtSXOmdkcLByGq-ZMCNQ.png"/></div></div></figure><p id="2dcc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">只需回到您的控制台，转到“<strong class="ka ir">开发</strong>”选项卡。打开左侧的<strong class="ka ir">交互画布</strong>。</p><p id="1c35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击“<strong class="ka ir">是</strong>”进入“<strong class="ka ir">你的动作是否使用互动画布？</strong>”</p><p id="22a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保将您的<code class="fe my mz na nb b">Hosting URL</code>添加到“<strong class="ka ir">设置您的默认web应用程序URL </strong>”部分。</p><p id="b14c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，打开左侧“<strong class="ka ir">调用</strong>页签下的“<strong class="ka ir">主调用</strong>”。</p><p id="3a76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">确保在<strong class="ka ir">发送提示</strong>下，你有<code class="fe my mz na nb b">canvas</code>和<code class="fe my mz na nb b">url</code>，应该和你的<code class="fe my mz na nb b">Hosting URL</code>匹配。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/b327fd7d8982876ede58274579f7bf0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vscksh_Z-ERQ3JYTKyVtdA.png"/></div></div></figure><p id="8faa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们需要将我们的webhooks连接到我们的前端。</p><h1 id="aeff" class="lv lw iq bd lx ly nw ma mb mc nx me mf mg ny mi mj mk nz mm mn mo oa mq mr ms bi translated">将Webhooks链接到ReactJS应用程序</h1><h2 id="6e6d" class="nk lw iq bd lx od oe dn mb of og dp mf kj oh oi mj kn oj ok mn kr ol om mr on bi translated">将Google Builder上的操作与您的项目文件夹同步</h2><p id="90cf" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">还记得你在AoG的控制台上看到的所有YAML吗？是的，他们都是YAML的档案。</p><p id="2c0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从技术上讲，你可以获得所有这些文件，查看代码，重写/添加更多逻辑，并将其推回到控制台。</p><p id="a4a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要做到这一点，让我们首先同步你在你的控制台上所做的到你的本地项目文件夹。</p><p id="7959" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您的终端中，确保您位于根文件夹。</p><p id="51c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">制作一个名为<code class="fe my mz na nb b">sdk</code>的新目录。然后移入该文件夹。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="bf87" class="nk lw iq nb b gy nl nm l nn no">mkdir sdk<br/>cd sdk</span></pre><p id="ef6a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，我们要将<strong class="ka ir">初始化</strong> <code class="fe my mz na nb b">gactions</code>在文件夹的这一部分。我们通过以下方式做到这一点:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="9458" class="nk lw iq nb b gy nl nm l nn no">gactions pull --project-id ${your project id}</span></pre><p id="6f0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要获得您的项目id，只需进入您的控制台，单击右上角堆叠的三个点，然后单击“<strong class="ka ir">项目设置</strong>，复制您的项目ID。</p><p id="5d8f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，我的看起来像:</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/b5b8623a6ba6233b5f132230fdef2d78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxdPfr8lQLAvCpCM9qDkfA.png"/></div></div></figure><p id="9e99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要知道你做到了，你的<code class="fe my mz na nb b">sdk</code>文件夹里应该塞满了<code class="fe my mz na nb b">actions</code>、<code class="fe my mz na nb b">custom</code>、<code class="fe my mz na nb b">settings</code>这样的文件夹，最重要的是<code class="fe my mz na nb b"><strong class="ka ir">webhooks</strong></code>。</p><p id="69cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将需要它来连接我们的交互式画布和ReactJS应用程序。</p><h2 id="f69d" class="nk lw iq bd lx od oe dn mb of og dp mf kj oh oi mj kn oj ok mn kr ol om mr on bi translated">连接网钩</h2><p id="96b0" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">为了让我们的AoG控制台知道触发哪个场景，我们通过webhooks连接它。</p><p id="cd0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为此，打开您的代码并打开<code class="fe my mz na nb b">sdk</code>&gt;<code class="fe my mz na nb b">webhooks</code>&gt;<code class="fe my mz na nb b">ActionsOnGoogleFulfillment</code>&gt;<code class="fe my mz na nb b">index.js</code></p><p id="2d1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请随意将下面的代码复制并粘贴到您的<code class="fe my mz na nb b">index.js</code>中。</p><figure class="nc nd ne nf gt jr"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="a70a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在index.js中有3个要点需要注意:</p><ol class=""><li id="945e" class="or os iq ka b kb kc kf kg kj ot kn ou kr ov kv ow ox oy oz bi translated">无论何时你想调用你的网页钩子，你都需要做<code class="fe my mz na nb b">app.handle("${webhook name}"...</code></li><li id="e099" class="or os iq ka b kb pa kf pb kj pc kn pd kr pe kv ow ox oy oz bi translated">当我们使用交互式画布时，我们需要调用:</li></ol><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="b81b" class="nk lw iq nb b gy nl nm l nn no">conv.add(    <br/>   new Canvas({      <br/>      data: {        <br/>         scene: "CATEGORY_BESTSELLERS",      <br/>      },    <br/>   })  <br/>);</span></pre><p id="0db8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.每当我们想要将数据从我们的机器人传递到我们的前端时，我们通过<code class="fe my mz na nb b">data</code>对象传递它。你甚至可以在<code class="fe my mz na nb b">scene</code>旁边加上<code class="fe my mz na nb b">params</code>以及任何你需要的东西。</p><p id="54c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦你设置好了你的webhook处理程序，请确保通过以下操作将更改推送到你的控制台:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="2797" class="nk lw iq nb b gy nl nm l nn no">cd sdk<br/>gactions push</span></pre><p id="051b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们开始构建ReactJS方面的东西，因为在您的前端启动交互画布还有一个关键部分，我们仍然缺少。</p><h1 id="0c89" class="lv lw iq bd lx ly nw ma mb mc nx me mf mg ny mi mj mk nz mm mn mo oa mq mr ms bi translated">开发ReactJS组件</h1><p id="81ed" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">在你的<code class="fe my mz na nb b">src</code>文件夹中，你可以随意组织它。但是我们主要关注的是连接你的前端和你的机器人。</p><p id="9a66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">需要注意的关键是<strong class="ka ir">你需要在前端</strong>初始化InteractiveCanvas。</p><p id="858d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还记得你在<code class="fe my mz na nb b">public</code> &gt; <code class="fe my mz na nb b">index.html</code>里加的<code class="fe my mz na nb b">&lt;script&gt;</code>吗？现在我们需要在组件中初始化它。</p><p id="7d71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nu">(在</em> <code class="fe my mz na nb b"><em class="nu">App.js</em></code> <em class="nu">或</em> <code class="fe my mz na nb b"><em class="nu">Canvas.js</em></code> <em class="nu">中随意这样做就像我做的那样。为了简单起见我决定把它拔出来)</em></p><p id="4bc6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了设置和启动交互式画布，我们需要创建一个<code class="fe my mz na nb b">Canvas.js</code>文件。这个文件实际上是将所有状态、页面和数据从您的操作链接到您的ReactJS页面的文件。</p><p id="525e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请随意将这段代码复制并粘贴到您的<code class="fe my mz na nb b">Canvas.js</code>中。</p><figure class="nc nd ne nf gt jr"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="88e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里你需要注意的3个关键点是:</p><ol class=""><li id="7f2f" class="or os iq ka b kb kc kf kg kj ot kn ou kr ov kv ow ox oy oz bi translated">确保在代码的开头，您调用了:<code class="fe my mz na nb b">this.interactiveCanvas = window.interactiveCanvas;</code></li><li id="aee3" class="or os iq ka b kb pa kf pb kj pc kn pd kr pe kv ow ox oy oz bi translated">然后，当组件被安装时，我们做两件事:<br/> (1)通过从<code class="fe my mz na nb b">this.interactiveCanvas.getHeaderHeightPx().then...<br/></code>获取来设置边距上限(2)调用<code class="fe my mz na nb b">setCallbacks</code></li><li id="ca44" class="or os iq ka b kb pa kf pb kj pc kn pd kr pe kv ow ox oy oz bi translated"><code class="fe my mz na nb b">setCallbacks</code>基本上确保:<br/> (1)我们的场景和参数是从前面讨论的<br/>部分的<code class="fe my mz na nb b">ActionsOnGoogleFulfillment</code> &gt; <code class="fe my mz na nb b">index.js</code>中传递的(2)我们通过做<code class="fe my mz na nb b">this.interactiveCanvas.ready(callbacks);</code>来注册回调</li></ol><p id="07ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基本上遵循交互画布API <a class="ae pf" href="https://developers.google.com/assistant/interactivecanvas/reference" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="309c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nu">我们将跳过其余ReactJS组件和页面的构建。你可以得到我的存储库，然后自己使用。</em></p><p id="9a46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当您构建完剩余的组件并根据<code class="fe my mz na nb b">if</code>语句更改页面后，请记住通过运行以下命令来部署您的构建文件:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="342c" class="nk lw iq nb b gy nl nm l nn no">yarn build &amp;&amp; firebase deploy --only hosting</span></pre><p id="578f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是第2部分！你应该能够成功地将一切联系在一起。你的机器人应该能够根据触发的webhook改变页面和视图。</p><p id="d5ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第三部分也是最后一部分，我们将探索应用的复杂性，例如:</p><ol class=""><li id="2adc" class="or os iq ka b kb kc kf kg kj ot kn ou kr ov kv ow ox oy oz bi translated">添加模拟数据</li><li id="d7a4" class="or os iq ka b kb pa kf pb kj pc kn pd kr pe kv ow ox oy oz bi translated">传递参数并利用页面中的会话来跟踪用户正在做什么</li><li id="0c11" class="or os iq ka b kb pa kf pb kj pc kn pd kr pe kv ow ox oy oz bi translated">通过Nest Hub触发onClicks</li></ol><p id="5c94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下一期<strong class="ka ir">最后部分</strong>见！</p><div class="kw kx gp gr ky kz"><a href="https://celiaongsl.medium.com/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-3-5eaa14f48b6c" rel="noopener follow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">用交互式画布和ReactJS构建谷歌助手——第3部分</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">欢迎来到本教程的最后阶段。</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">celiaongsl.medium.com</p></div></div><div class="li l"><div class="pg l lk ll lm li ln jw kz"/></div></div></a></div></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="922e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">额外备注:</strong></p><blockquote class="ph pi pj"><p id="cad9" class="jy jz nu ka b kb kc kd ke kf kg kh ki pk kk kl km pl ko kp kq pm ks kt ku kv ij bi translated">注意:确保在开发完React应用程序后，运行<code class="fe my mz na nb b">yarn build &amp;&amp; firebase deploy --only hosting</code>。</p><p id="dc02" class="jy jz nu ka b kb kc kd ke kf kg kh ki pk kk kl km pl ko kp kq pm ks kt ku kv ij bi translated">如果你触摸了<code class="fe my mz na nb b">sdk</code>文件夹中的<strong class="ka ir">任何东西，你需要<code class="fe my mz na nb b">cd</code>进入<code class="fe my mz na nb b">sdk</code>文件夹并运行<code class="fe my mz na nb b">gactions push</code>来保持你的AoG控制台根据你的本地变化进行更新。(您不需要在这里运行yarn build和firebase deploy！)</strong></p></blockquote><p id="360d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">这里是第二部分的存储库:</strong></p><div class="kw kx gp gr ky kz"><a href="https://github.com/celiaongsl/new-york-times-bestseller/tree/version2" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">celiaongsl/纽约时报-畅销书</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">这个项目是用Create React App引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">github.com</p></div></div><div class="li l"><div class="pn l lk ll lm li ln jw kz"/></div></div></a></div></div></div>    
</body>
</html>