# TypeScript 4.4 ä¸­çš„æ–°åŠŸèƒ½å’Œçªç ´æ€§å˜åŒ–

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/features-in-the-new-typescript-release-e5ef6ebba750>

## [ç½‘é¡µå¼€å‘](https://rakiabensassi.medium.com/list/software-engineering-7a179a23ebfd)

## æ§åˆ¶æµåˆ†æã€ä½œä¸ºç´¢å¼•ç­¾åçš„ç¬¦å·ã€æ‹¼å†™å»ºè®®ç­‰ç­‰

![](img/02402a4b1164fbe1d61cc6e49f93346c.png)

æ¥è‡ª [Pixabay](https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=879461) çš„ [Heiko Stein](https://pixabay.com/users/nidan-455298/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=879461) çš„åŸå§‹å›¾ç‰‡(ç”±ä½œè€…ç¼–è¾‘)

2021 å¹´ 8 æœˆ 24 æ—¥ï¼Œæ˜¯å¾®è½¯æ–°å‘å¸ƒçš„ç±»å‹åŒ– JavaScript çš„æ—¥æœŸã€‚è¿™ä¸ªç‰ˆæœ¬ä¸­æœ‰ä¸€äº›ä»¤äººå…´å¥‹çš„ç‰¹æ€§ï¼Œæ¯”å¦‚æ‰©å±•äº†å¯¹ç´¢å¼•ç­¾åçš„è®¿é—®ï¼Œæ”¹è¿›äº†å¯¹ç±»å‹åˆ†é…çš„æ§åˆ¶æµåˆ†æã€‚

å¦‚æœæ‚¨è¿˜æ²¡æœ‰æ¥è§¦è¿‡ TypeScript 4.4ï¼Œé‚£ä¹ˆæ‚¨æ¥å¯¹åœ°æ–¹äº†ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»‹ç»æ–°çš„ç‰¹æ€§å’Œçªç ´æ€§çš„å˜åŒ–ï¼Œå¹¶å±•ç¤ºå®ƒä»¬å°†å¦‚ä½•å½±å“æˆ‘ä»¬çš„å¼€å‘ä½“éªŒã€‚

```
**Table of Contents**[Control Flow Analysis & Type Guard Detection](#3d60)
[Versatile Index Signatures](#816f)
[New Flags](#a6ee)
[Static Blocks Inside Classes](#f89d)
[Better Intellisense](#854b)
[Performance Boost](#bbce)
[Breaking Changes](#10e5)
```

# æ§åˆ¶æµåˆ†æå’Œç±»å‹ä¿æŠ¤æ£€æµ‹

ä½¿ç”¨æ‰€è°“çš„ç±»å‹ä¿æŠ¤æ¦‚å¿µï¼ŒTypeScript [ç¼–è¯‘å™¨](https://betterprogramming.pub/compiler-vs-interpreter-d0a12ca1c1b6)åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ç¡®å®š`if`å—ä¸­çš„å˜é‡`arg`å¿…é¡»å…·æœ‰ç±»å‹`string`:

TypeScript 4.4 ä¸­çš„æœªçŸ¥ç±»å‹

ä½†æ˜¯é€šè¿‡å¸¸é‡è¿›è¡Œçš„ç±»å‹æ£€æŸ¥ä¼šè¿”å›é”™è¯¯æ¶ˆæ¯`*Property 'toUpperCase' does not exist on type 'string* | number*'*`ï¼Œå› ä¸º TypeScript 4.3 ä¸è®°å¾—ï¼Œåœ¨ä»¥ä¸‹ç¤ºä¾‹çš„ç¬¬ 5 è¡Œä¸­ï¼Œ`argIsString`è¡¨ç¤ºä»`string | number`åˆ°`string`çš„`arg`ç±»å‹æ”¶ç¼©:

æ£€æŸ¥ TypeScript ä¸­çš„å¸¸é‡

å‡ºäºåŒæ ·çš„åŸå› ï¼Œæˆ‘ä»¬é¢å¯¹ç¬¬ 8 è¡Œä¸­çš„é”™è¯¯`Operator '+=' cannot be applied to types 'number' and 'string | number'`ã€‚è¿™å¾ˆç³Ÿç³•ï¼Œå› ä¸ºå®ƒé˜»æ­¢æˆ‘ä»¬ç¼–å†™æ›´å…·è¡¨è¾¾åŠ›çš„ä»£ç ã€‚

éšç€å¯¹ç±»å‹ Guard çš„æ§åˆ¶æµåˆ†æçš„æ”¹è¿›ï¼ŒTS 4.4 ç°åœ¨å¯¹`const`å’Œ`readonly`å±æ€§ä»¥åŠæœªæ›´æ”¹çš„å‚æ•°æ‰§è¡Œæ­£ç¡®çš„åˆ†æã€‚

é™¤äº†ä½¿ç”¨`typeof`è¿›è¡Œæ£€æŸ¥ä¹‹å¤–ï¼Œæ–°ç‰ˆæœ¬åœ¨å¤„ç†è¢«åŒºåˆ†çš„è”åˆä»¥åŠå¯¹å•ä¸ªè”åˆå…ƒç´ çš„æˆå‘˜æµ‹è¯•æ—¶ï¼Œè¿˜ä¼šæ£€æµ‹æ­£ç¡®çš„ç±»å‹:

æ‰“å­—ç¨¿åŒºåˆ«è”åˆ

å¯¹äº[ç¤¾åŒº](/learning-velocity-and-coding-standards-10952f6c9640)æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªæƒŠäººçš„æ–°ç‰¹æ€§ï¼Œå› ä¸ºå®ƒå¢å¼ºäº†ä»£ç çš„å¯è¯»æ€§ï¼Œå¹¶å…è®¸æˆ‘ä»¬æ³¨é‡Šå¤æ‚çš„æ¡ä»¶ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨ç›´æ¥çš„ç±»å‹æ–­è¨€æˆ–å°†æ‰€æœ‰å†…å®¹éƒ½æ”¾åœ¨`if`è¯­å¥ä¸­ã€‚

# å¤šåŠŸèƒ½ç´¢å¼•ç­¾å

ç¬¬äºŒä¸ªé‡è¦ç‰¹æ€§æ˜¯é€šè¿‡ç´¢å¼•ç­¾åè®¿é—®å…ƒç´ ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªé€šè¿‡ç•Œé¢æ˜¾ç¤ºç±»ä¼¼`Map`çš„ç»“æ„çš„ä¾‹å­:

TypeScript 4.4:å­—ç¬¦ä¸²ä½œä¸ºç´¢å¼•

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œé€šè¿‡ç´¢å¼•ç­¾åè®¿é—®çš„å¯†é’¥ç±»å‹åªèƒ½æ˜¯`number`æˆ–`string`ã€‚ä½†æ˜¯åœ¨æ–°ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`symbol`:

Typescript 4.4:ç¬¦å·ä½œä¸ºç´¢å¼•

ä»¥åŠ[æ¨¡æ¿å­—ç¬¦ä¸²æ¨¡å¼](https://betterprogramming.pub/typescript-new-release-19f1238c6a68#5ab8)ï¼Œå¦‚`type-${string}`ï¼Œè¿™éå¸¸æœ‰è¶£ï¼Œå› ä¸ºå®ƒå…è®¸å¤æ‚çš„ç±»å‹å®šä¹‰ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤º:

TypeScript 4.4:ä½¿ç”¨å­—ç¬¦ä¸²æ¨¡å¼ä½œä¸ºç´¢å¼•

# `New Flags`

å½“ä½¿ç”¨æ ‡å¿—`--useUnknownInCatchVariables`æ—¶ï¼Œ`try-catch`å—ä¸­çš„é»˜è®¤å˜é‡ç±»å‹å°†ä»`any`å˜ä¸º`unknown`ã€‚

å½“æ ‡å¿—`--exactOptionalPropertyTypes`æ‰“å¼€æ—¶ï¼Œæ‚¨ä¸èƒ½å†ç”¨`undefined`åˆå§‹åŒ–å¯é€‰å±æ€§ï¼Œç›´åˆ°æ‚¨åœ¨è”åˆç±»å‹`age?: number | undefined`ä¸­æ˜¾å¼åŒ…å«`undefined`:

TypeScript 4.4 èµ‹å€¼

ä¸ºäº†é¿å…ä¸å…¼å®¹æˆ–åœ¨æ‚¨çš„é¡¹ç›®æˆ–ç¬¬ä¸‰æ–¹å®šä¹‰ä¸­å¼•èµ·é—®é¢˜(ä¾‹å¦‚ï¼Œæ¥è‡ª DefinitelyTyped)ï¼Œ`--exactOptionalPropertyTypes`æ˜¯å¯é€‰çš„ï¼Œä¸åŒ…å«åœ¨`--strict`ä¸­ã€‚

# ç±»å†…éƒ¨çš„é™æ€å—

å¯¹äºä»¥å‰çš„ TypeScript ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å·²ç»åœ¨ç±»å®šä¹‰ä¹‹å¤–åˆå§‹åŒ–äº†é™æ€å—ï¼Œè¿™ä½¿å®ƒçœ‹èµ·æ¥æ˜¯ç‹¬ç«‹çš„:

TypeScript 4.3:é™æ€å—å¯åŠ¨

TS 4.4 ä½¿è¿™ç§é€»è¾‘æ›´ç®€å•ï¼Œå› ä¸ºå®ƒå…è®¸åˆå§‹åŒ–è¿‡ç¨‹ç›´æ¥åœ¨ç±»å®šä¹‰ä¸­è¿›è¡Œ:

TypeScript 4.4:ç±»å†…éƒ¨çš„é™æ€å—åˆå§‹åŒ–

# æ›´å¥½çš„æ™ºèƒ½æ„ŸçŸ¥

æˆ‘ä»¬å–œæ¬¢ TypeScript çš„è‡ªåŠ¨å®Œæˆå’Œç¼–è¾‘å™¨æ”¯æŒâ€”â€”ä¹Ÿç§°ä¸º**æ™ºèƒ½æ„ŸçŸ¥**ã€‚åœ¨ 4.4 ç‰ˆæœ¬ä¸­ï¼Œè¯¥åŠŸèƒ½æœ‰äº†ä¸€äº›æ”¹è¿›ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†æ›´æœ‰ä¿¡å¿ƒçš„å»ºè®®:

*   å¦‚æœæ‚¨åœ¨æ²¡æœ‰æ‰“å¼€`checkJs`æˆ–`@ts-check`çš„æƒ…å†µä¸‹å¤„ç†*çº¯*[*JavaScript*](https://betterprogramming.pub/javascript-history-and-future-71b0ceb737aa)æ–‡ä»¶ï¼Œæ‚¨ä¼šè‡ªåŠ¨å¾—åˆ°é€šçŸ¥ã€‚
*   æ‚¨è¿˜ä¼šçœ‹åˆ°**å†…è”æç¤º**â€”â€”ä¸€ç§å‹å¥½çš„â€œå¹½çµæ–‡æœ¬â€â€”â€”æ˜¾ç¤ºå…³äºå‚æ•°åç§°ã€æ¨æ–­çš„è¿”å›ç±»å‹å’Œä»£ç å…¶ä»–åŒºåŸŸçš„æœ‰ç”¨ä¿¡æ¯:

![](img/0151a9e82e220180e748ce7bf65fbd92.png)

*ç”¨ TypeScript 4.4 æ”¯æŒé•¶åµŒæç¤º(* [*)å›¾ç‰‡æ¥æº*](https://devblogs.microsoft.com/typescript/announcing-typescript-4-4-rc/) *)*

*   TS 4.4 é™„å¸¦äº†æ”¹è¿›çš„**å»ºè®®å¯¼å…¥è·¯å¾„**ï¼Œå®ƒå°†æ˜¾ç¤ºç±»ä¼¼`@angular`çš„è·¯å¾„ï¼Œè€Œä¸æ˜¯ç±»ä¼¼`node_modules/@angular/..`çš„ç›¸å¯¹è·¯å¾„:

![](img/da6ff7c590127b6766065a0a3f01c511.png)

è‡ªåŠ¨å¯¼å…¥åœ¨å®Œæˆåˆ—è¡¨ä¸­æ˜¾ç¤ºçœŸå®è·¯å¾„([æ¥æº](https://devblogs.microsoft.com/typescript/announcing-typescript-4-4-rc/#perf-improvements))

# æ€§èƒ½æå‡

*   åœ¨æ–°ç‰ˆæœ¬ä¸­ï¼Œæœ‰ä¸€ä¸ªå†…éƒ¨ç¬¦å·åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­æ˜¯å¦å¯è®¿é—®çš„ç¼“å­˜ï¼Œä»¥åŠå¦‚ä½•æ‰“å°ç‰¹å®šç±»å‹ã€‚è¿™ä½¿å¾—**æ›´å¿«åœ°å‘å‡ºå£°æ˜ï¼Œ**å°¤å…¶æ˜¯åœ¨å…·æœ‰å¤æ‚ç±»å‹çš„æºä»£ç ä¸­ã€‚
*   è¿˜æœ‰æ¡ä»¶è·¯å¾„è§„èŒƒåŒ–ï¼Œå®ƒå‡å°‘äº†ç¼–è¯‘å™¨è§„èŒƒåŒ–å®ƒæ­£åœ¨å¤„ç†çš„è·¯å¾„æ‰€éœ€çš„æ—¶é—´ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ç°åœ¨æœ‰äº†æ›´å¿«è£…è½½çš„[](https://betterprogramming.pub/web-vitals-guide-b56e28798e7f)**ã€‚**
*   **é¢å¤–çš„ç¼“å­˜ä¸ºæˆ‘ä»¬åœ¨`tsconfig.json`ä¸­`paths`æä¾›äº†**æ›´å¿«çš„è·¯å¾„æ˜ å°„**ã€‚**
*   **åœ¨ä¿®å¤äº†ä¸€ä¸ªå¯¼è‡´æ¯æ¬¡åç»­æ„å»ºéƒ½è¿›è¡Œä¸å¿…è¦çš„ç±»å‹æ£€æŸ¥çš„é”™è¯¯åï¼ŒTS 4.4 æœ‰äº†**æ›´å¿«çš„å¢é‡æ„å»º**å’Œ`--strict`ã€‚**
*   ****æºæ˜ å°„ç”Ÿæˆ**å·²ç»è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå‡å°‘äº†å¤§è¾“å‡ºæ–‡ä»¶æ‰€éœ€çš„æ—¶é—´ã€‚**
*   **å‡å°‘ä¸å¿…è¦çš„æ£€æŸ¥ç°åœ¨æä¾›äº†æ›´å¿«çš„**`**--force**`**æ„å»º**ã€‚****

# ****é‡å¤§å˜åŒ–****

****å³ä½¿ä»–ä»¬ä¸æ˜¯ä¸“ä¸šäººå‘˜ï¼Œè¿™ä¸ªç‰ˆæœ¬ä¹Ÿæœ‰ä¸€äº›çªç ´æ€§çš„å˜åŒ–ï¼Œå¯èƒ½ä¼šç ´åæ‚¨çš„ä»£ç :****

*   ****å¦‚æœæ‚¨æœ‰`abstract`ç±»ï¼Œæ‚¨ä¸èƒ½å†åˆå§‹åŒ–å®ƒä»¬å†…éƒ¨çš„`abstract`å±æ€§ï¼Œä½†æ˜¯æ‚¨å¯ä»¥å®šä¹‰å®ƒä»¬çš„ç±»å‹ã€‚****
*   ****ä¸ºäº†é˜²æ­¢æ€»æ˜¯çœŸå®çš„æ£€æŸ¥ï¼Œå½“æ‚¨åœ¨ä¸€ä¸ª`if`å­å¥ä¸­æ£€æŸ¥ä¸€ä¸ª`Promise`ç»“æœæ—¶ï¼ŒTypeScript ä¼šæé†’æ‚¨åŒ…å«`await`ã€‚****
*   ****æ–°çš„ TS ç‰ˆæœ¬åœ¨è°ƒç”¨å¯¼å…¥çš„å‡½æ•°æ—¶ä¸¢å¼ƒäº†`this`å€¼ï¼Œä»¥ä¾¿åœ¨æ‰€æœ‰å¯ç”¨çš„æ¨¡å—ç³»ç»Ÿ(ESMã€CommonJSã€AMDã€...).****
*   ****`lib.d.ts`æ›´æ”¹ä¸ºæœ€æ–°çš„å½“å‰ TypeScript è§„èŒƒ(æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°`[lib.dom.d.ts](https://github.com/microsoft/TypeScript-DOM-lib-generator/issues/1029#issuecomment-869224737)`[æ›´æ”¹åˆ—è¡¨](https://github.com/microsoft/TypeScript-DOM-lib-generator/issues/1029#issuecomment-869224737))****

****å¦‚æœæ‚¨ç°åœ¨æƒ³å°è¯• TypeScript 4.4 å‘å¸ƒå€™é€‰ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥ä» [npm](http://npmjs.com/package/typescript) è·å¾—å®ƒ:****

```
**npm install -g typescript**
```

****æ„Ÿè°¢é˜…è¯»ï¼æˆ‘å¸Œæœ›è¿™äº›è§è§£æ˜¯æœ‰å¸®åŠ©çš„ã€‚****

# ****æƒ³è¦æ›´å¤šå—ï¼Ÿ****

****ğŸ§ ğŸ’¡æˆ‘ä¸ºä¸€ç¾¤èªæ˜ã€å¥½å¥‡çš„äººå†™å…³äºå·¥ç¨‹ã€æŠ€æœ¯å’Œé¢†å¯¼åŠ›çš„æ–‡ç« ã€‚ [**åŠ å…¥æˆ‘çš„å…è´¹ç”µå­é‚®ä»¶ç®€è®¯ï¼Œç‹¬å®¶è·å–**](https://rakiabensassi.substack.com/) æˆ–åœ¨æ­¤æ³¨å†Œåª’ä½“[ã€‚](https://rakiabensassi.medium.com/membership)****

*****ä½ å¯ä»¥åœ¨ Udemy ä¸ŠæŸ¥çœ‹æˆ‘çš„* ***è§†é¢‘è¯¾ç¨‹****:*[*å¦‚ä½•è¯†åˆ«ã€è¯Šæ–­ã€ä¿®å¤ Web Apps ä¸­çš„å†…å­˜æ³„æ¼*](https://www.udemy.com/course/identify-and-fix-javascript-memory-leaks/) *ã€‚*****

****[](/how-to-become-a-legitimate-system-architect-3ccf686e9712) [## å¦‚ä½•ä»ä¸€ä¸ªä»£ç çŒ´å­å˜æˆä¸€ä¸ªåˆæ³•çš„ç³»ç»Ÿæ¶æ„å¸ˆ

### å¦‚ä½•è¿›å…¥è½¯ä»¶å·¥ç¨‹å¸ˆçš„ä¸‹ä¸€é˜¶æ®µçš„ 6 ä¸ªæŠ€å·§

levelup.gitconnected.com](/how-to-become-a-legitimate-system-architect-3ccf686e9712) [](https://betterprogramming.pub/compiler-vs-interpreter-d0a12ca1c1b6) [## ç¼–è¯‘å™¨ä¸è§£é‡Šå™¨:äº†è§£å®ƒä»¬çš„åŒºåˆ«ä»¥åŠä½•æ—¶ä½¿ç”¨å®ƒä»¬

### ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨çš„ç±»å‹å’Œç”¨ä¾‹

better ç¼–ç¨‹. pub](https://betterprogramming.pub/compiler-vs-interpreter-d0a12ca1c1b6) 

## å‚è€ƒ

[å¾®è½¯ TypeScript å¼€å‘åšå®¢](https://devblogs.microsoft.com/typescript/announcing-typescript-4-4-rc/)****