<html>
<head>
<title>Real-Time mode — index administration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实时模式—索引管理</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/real-time-mode-index-administration-937ee6655300?source=collection_archive---------21-----------------------#2020-10-13">https://levelup.gitconnected.com/real-time-mode-index-administration-937ee6655300?source=collection_archive---------21-----------------------#2020-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="0af4" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">权威指南</h2><div class=""/><div class=""><h2 id="bd23" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">在这篇文章中，我们将详细了解蝎狮搜索实时模式是如何工作的，以及你如何自己使用它。我们将学习如何使用SQL语句在蝎狮搜索中操作索引。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/50b9bc6baff15cb47ed0d0cec7403bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4nNuCJtRI-eKX6MN.png"/></div></div></figure><h1 id="1a68" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">索引创建</h1><p id="7bfe" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">让我们首先通过SQL连接到蝎狮:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="36da" class="mt lb iq mp b gy mu mv l mw mx">root@rtmode-79f9d6d867-fptcc:/# mysql -P9306 -h0<br/>Welcome to the MariaDB monitor.  Commands end with ; or \g.<br/>Your MySQL connection id is 1<br/>Server version: 3.5.2 0686d9f0@200326 release</span><span id="0df7" class="mt lb iq mp b gy my mv l mw mx">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><span id="f3a2" class="mt lb iq mp b gy my mv l mw mx">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span></pre><p id="2e66" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">一个简单的表创建语句如下所示:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="aa3a" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; CREATE TABLE testrt1 (title TEXT, category INT);</span></pre><p id="82e9" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">这将创建一个包含文档id(不需要声明)、文本字段和整数属性的索引。</p><p id="5848" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">索引支持一系列可以在声明时传递的选项:</p><p id="6201" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">例如:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="0ec2" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; CREATE TABLE testrt2 (title TEXT, category INT)  html_strip='1' docstore_compression_level = '12';</span></pre><p id="e5d2" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">在这个索引中，文本将被剥离HTML，文档存储的压缩级别被设置为最高级别。</p><p id="7845" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">如果未指定类型，默认情况下，索引将是实时的。如果我们想创建一个分布式索引，我们需要传递类型:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="ddd5" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; CREATE TABLE testrtdist type='distributed' local='testrt1' local='testrt2';</span></pre><p id="94ac" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">如果我们不确定表格是否已经制作好，可以使用“IF NOT EXISTS”子句来避免错误:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="8a3a" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; CREATE TABLE IF NOT EXISTS testrt1 (title TEXT, category INT);</span></pre><p id="8ebb" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">也可以使用现有索引的设置和模式创建索引:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="72d1" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; CREATE TABLE testrt3 LIKE testrt2;</span></pre><h1 id="3149" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">更多表格操作</h1><p id="1106" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">要删除索引，请使用DROP TABLE:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="336f" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; DROP TABLE testrt3;</span></pre><p id="7125" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">要清空索引:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="b10b" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; TRUNCATE TABLE testrt2;</span></pre><p id="9903" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">要添加或删除列:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="32e6" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; ALTER TABLE testrt2 ADD COLUMN tagId INT;</span><span id="a8a9" class="mt lb iq mp b gy my mv l mw mx">MySQL [(none)]&gt; ALTER TABLE testrt2 DROP COLUMN tagId;</span></pre><p id="8b2c" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">请注意，当前不能添加或删除文本字段。如果需要修改文本字段，您需要重新创建表格。</p><p id="dc63" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">也可以更改索引设置:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="de80" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; ALTER TABLE testrt2 ignore_chars='.';</span></pre><p id="8f66" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">请注意，标记化设置不会应用于全文组件中的现有数据，只有在更改后添加的新文档才会受到影响。<br/>如果您需要更新整个集合，必须使用所需的设置重新创建索引。</p><h1 id="c516" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">表格信息</h1><p id="d355" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">有几个语句提供了关于索引的信息。</p><p id="377c" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">要获取索引模式:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="2b44" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; DESCRIBE testrt2;<br/>+----------+--------+----------------+<br/>| Field    | Type   | Properties     |<br/>+----------+--------+----------------+<br/>| id       | bigint |                |<br/>| title    | field  | indexed stored |<br/>| category | uint   |                |<br/>+----------+--------+----------------+</span></pre><p id="90ca" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">有关文档数量、大小和性能指标的信息可以通过显示索引状态来查看:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="01d0" class="mt lb iq mp b gy mu mv l mw mx">mysql&gt; SHOW INDEX testrt2 STATUS;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ne"><img src="../Images/ae3c706edbaff55ada561b923bdbc630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qS2feTfzK6fsHNUt3oxc8g.png"/></div></div></figure><p id="8630" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">显示索引设置还可以提供索引设置列表:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="16f5" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; SHOW INDEX testrt2 SETTINGS;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nf"><img src="../Images/dab8909a5c8ca7bc6bb8edca605b3c6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PDj5ACZJ6Uf0EWMUCRMtg.png"/></div></div></figure><p id="8d39" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">如果需要导出完整的索引声明，请使用SHOW CREATE TABLE:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="3e69" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; SHOW CREATE TABLE testrt2;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/e0fc1c77857d1b6e9dfc94aedd9dab91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZcRR0hf4TKAOSGRaqiOxw.png"/></div></div></figure><h1 id="83ae" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">导入索引</h1><p id="0db1" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">RT索引可以使用IMPORT TABLE语句导入。<br/>索引文件将被复制到您在配置中指定的data_dir。</p><p id="2f6e" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">示例:</p><pre class="kp kq kr ks gt mo mp mq mr aw ms bi"><span id="1e69" class="mt lb iq mp b gy mu mv l mw mx">MySQL [(none)]&gt; IMPORT TABLE movies FROM '/index/movies_rt';</span><span id="6890" class="mt lb iq mp b gy my mv l mw mx">MySQL [(none)]&gt; SELECT * FROM movies\G<br/>*************************** 1. row ***************************<br/>id: 1<br/>num_critic_for_reviews: 4<br/>duration: 96<br/>director_facebook_likes: 0<br/>actor_3_facebook_likes: 460<br/>actor_1_facebook_likes: 708<br/>gross: 0<br/>num_voted_users: 961<br/>cast_total_facebook_likes: 2307<br/>facenumber_in_poster: 0<br/>num_user_for_reviews: 12<br/>budget: 3500000<br/>title_year: 2009<br/>actor_2_facebook_likes: 574<br/>movie_facebook_likes: 211<br/>imdb_score: 4.800000<br/>aspect_ration: 2.350000<br/>color: Color<br/>movie_imdb_link: <a class="ae nh" href="http://www.imdb.com/title/tt1002561/?ref_=fn_tt_tt_1" rel="noopener ugc nofollow" target="_blank">http://www.imdb.com/title/tt1002561/?ref_=fn_tt_tt_1</a><br/>language: English<br/>country: USA<br/>content_rating:<br/>director_name: Charles Adelman<br/>actor_2_name: Kevin Pollak<br/>actor_1_name: Teri Polo<br/>movie_title: 02:13<br/>actor_3_name: Jere Burns<br/>plot_keywords: death|forensic|murder|profiler|serial killer<br/>...<br/>*************************** 20. row ***************************<br/>id: 20<br/>num_critic_for_reviews: 1<br/>duration: 111<br/>director_facebook_likes: 0<br/>actor_3_facebook_likes: 247<br/>actor_1_facebook_likes: 1000<br/>gross: 14616<br/>num_voted_users: 314<br/>cast_total_facebook_likes: 2059<br/>facenumber_in_poster: 1<br/>num_user_for_reviews: 10<br/>budget: 12000000<br/>title_year: 2015<br/>actor_2_facebook_likes: 445<br/>movie_facebook_likes: 26000<br/>imdb_score: 7.500000<br/>aspect_ration: 1.850000<br/>color: Color<br/>movie_imdb_link: <a class="ae nh" href="http://www.imdb.com/title/tt3453052/?ref_=fn_tt_tt_1" rel="noopener ugc nofollow" target="_blank">http://www.imdb.com/title/tt3453052/?ref_=fn_tt_tt_1</a><br/>language: English<br/>country: USA<br/>content_rating: R<br/>director_name: Timothy Hines<br/>actor_2_name: Kelly LeBrock<br/>actor_1_name: Christopher Lambert<br/>movie_title: 10 Days in a Madhouse<br/>actor_3_name: Alexandra Callas<br/>plot_keywords:</span></pre><p id="9ba1" class="pw-post-body-paragraph ls lt iq lu b lv mz ka lx ly na kd ma mb nb md me mf nc mh mi mj nd ml mm mn ij bi translated">RT模式是一种新的默认模式，在大多数情况下，它将使在蝎狮搜索中维护索引变得更加容易。至于其他方面，仍然支持普通模式。你可以从<a class="ae nh" href="https://manual.manticoresearch.com/Read_this_first#Real-time-mode-vs-plain-mode" rel="noopener ugc nofollow" target="_blank">蝎狮的搜索文档中了解到不同之处。</a></p></div></div>    
</body>
</html>