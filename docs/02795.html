<html>
<head>
<title>How to Implement “Login with GitHub” in a React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React App中实现“用GitHub登录”</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-implement-login-with-github-in-a-react-app-bd3d704c64fc?source=collection_archive---------0-----------------------#2020-04-05">https://levelup.gitconnected.com/how-to-implement-login-with-github-in-a-react-app-bd3d704c64fc?source=collection_archive---------0-----------------------#2020-04-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/b1f4c861be62dd58432a1c0a419c7849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*Ms4z8nK_xHcyWsqv3d24xA.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">登录屏幕</figcaption></figure><p id="464c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我遇到过一个场景，我需要使用Create React App在React应用中实现“使用Github登录”功能。虽然这听起来很简单，但在尝试做这件事时，你可能会遇到一些麻烦。所以这篇文章的目的是提供一个指南来帮助你在你的应用中实现这样一个特性。让我们现在就开始吧！</p><h1 id="0c3c" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">第一步:在Github上创建OAuth应用</strong></h1><p id="5297" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">登录你的Github账户，按照<a class="ae mc" href="https://developer.github.com/apps/building-oauth-apps/creating-an-oauth-app/" rel="noopener ugc nofollow" target="_blank">这里</a>提供的步骤创建一个OAuth应用。<strong class="kd iu">注意:</strong>对于这个例子，在创建OAuth应用程序时，如果您在本地运行您的应用程序，您可以将您的<strong class="kd iu">主页URL </strong>设置为<a class="ae mc" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>并将<strong class="kd iu">授权回调URL </strong>设置为<a class="ae mc" href="http://localhost:3000/login" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/log in</a>。创建一个<strong class="kd iu">。env </strong>文件并设置这些变量:</p><p id="3598" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">REACT _ APP _ CLIENT _ ID =您的客户端ID<br/>REACT _ APP _ CLIENT _ SECRET =您的客户端机密<br/>REACT _ APP _ REDIRECT _ URI =<a class="ae mc" href="http://localhost:3000/login" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/log in</a></p><p id="15d7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">注意:</strong>在制作app时，请确保将您的客户端ID和客户端机密放在更安全的地方。您可以将它们放在服务器端应用程序中，并在后端进行整个身份验证，以防止伪造您的身份验证密钥。</p><h1 id="1e5b" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">第二步:创建React应用</strong></h1><p id="cd7a" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">继续使用您的首选创建您的react应用程序，在本例中，我们将使用<a class="ae mc" href="https://reactjs.org/docs/create-a-new-react-app.html" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">Create-React-App</strong></a><strong class="kd iu">。如果你使用这种模式，你必须删除index.css、App.css、App.test.js和serviceWorker.js等文件，编辑index.js并确保它看起来像<a class="ae mc" href="https://github.com/PrincewillIroka/login-with-github/blob/master/src/index.js" rel="noopener ugc nofollow" target="_blank">这个</a>。另外，编辑App.js，使其看起来像<a class="ae mc" href="https://github.com/PrincewillIroka/login-with-github/blob/master/src/App.js" rel="noopener ugc nofollow" target="_blank">这个</a>。</strong></p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="3fec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在App.js文件中，导入2个组件(<strong class="kd iu"> Home.js </strong>和<strong class="kd iu"> Login.js </strong>)。要创建这两个组件，请转到<strong class="kd iu"> src </strong>文件夹，创建一个名为<strong class="kd iu"> components </strong>的文件夹，其中包含两个文件(Home.js和Login.js)。从根文件夹中，您可以运行下面的命令来创建它们。</p><pre class="md me mf mg gt mj mk ml mm aw mn bi"><span id="34e9" class="mo la it mk b gy mp mq l mr ms">mkdir -p src/components &amp;&amp; cd src/components &amp;&amp; touch Home.js Login.js</span></pre><p id="23c8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，您将看到我们从存储中导入了状态和reducer。继续设置一个简单的存储来保存应用程序的状态。为此，导航到src文件夹，创建一个名为<strong class="kd iu"> store </strong>的文件夹，在其中创建一个名为<strong class="kd iu"> reducer </strong>的子文件夹，并在reducer文件夹中创建一个<strong class="kd iu"> index.js </strong>文件。从根文件夹中，您可以运行下面的命令来创建它们。</p><pre class="md me mf mg gt mj mk ml mm aw mn bi"><span id="658c" class="mo la it mk b gy mp mq l mr ms">mkdir -p src/store/reducer &amp;&amp; cd src/store/reducer &amp;&amp; touch index.js</span></pre><p id="175d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">商店中index.js文件的内容应该是这样的。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="dd97" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它包含<strong class="kd iu"> initialState </strong>对象和一个<strong class="kd iu"> reducer </strong>函数，该函数包含被调度来改变状态的动作。</p><p id="5b93" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这一点上，这将是很好的工作对我们的组件。让我们来研究一下<a class="ae mc" href="https://github.com/PrincewillIroka/login-with-github/blob/master/src/components/Login.js" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu"> Login.js </strong> </a>，这将是一个简单的组件，它有一个按钮来触发对Github API的登录请求。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="4c5c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<strong class="kd iu"> Login.js </strong>组件中，请注意以下重要事项:</p><ol class=""><li id="c4bb" class="mt mu it kd b ke kf ki kj km mv kq mw ku mx ky my mz na nb bi translated">我们导入并利用了<strong class="kd iu"> AuthContext </strong>来使我们的商店中的全局状态和动作在这个组件中可用。</li><li id="f8e8" class="mt mu it kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">当用户点击<em class="nh">“使用Github登录”</em>按钮时，会向Github API请求授权我们的应用程序。如果成功，Github将重定向回我们的应用程序(授权回调URL <strong class="kd iu"> ) </strong>，URL中带有<em class="nh"> "code" </em>。</li><li id="9496" class="mt mu it kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">我们利用useEffect钩子来监听这个<em class="nh">【代码】</em>何时可用。然后，我们从url收集它，使用代码和其他数据，如:client_id、redirect_uri、client_secret，通过我们的<a class="ae mc" href="https://github.com/PrincewillIroka/login-with-github/blob/master/server/index.js" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">代理服务器</strong> </a>(一个简单的快速应用程序，帮助我们绕过CORS错误)继续向Github APIs发出请求。我将在下一步中详细讨论代理服务器。</li><li id="260d" class="mt mu it kd b ke nc ki nd km ne kq nf ku ng ky my mz na nb bi translated">如果通过代理服务器的身份验证返回一个有效的响应，我们将调度“LOGIN”事件来设置存储中的用户数据和isLoggedIn有效负载。</li></ol><p id="004d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们更新<a class="ae mc" href="https://github.com/PrincewillIroka/login-with-github/blob/master/src/components/Home.js" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu"> Home.js </strong> </a>组件，以显示一些用户数据，如(头像、姓名、追随者数量等)</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h1 id="5476" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">步骤3:创建代理服务器</h1><p id="9f50" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">最后一步是创建一个代理服务器来帮助我们绕过CORS错误。这将是一个简单的快速应用程序，我们将启用标题中的<em class="nh">“访问控制-允许-起源”</em>。我们将利用它来转发请求和接收来自Github API的响应，并将所需的响应发送回客户端(我们的React应用程序)。将这些变量添加到<strong class="kd iu">中。env </strong>文件:</p><p id="ced2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">REACT _ APP _ PROXY _ URL =<a class="ae mc" href="http://localhost:5000/authenticate" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/authenticate</a>T10】SERVER _ PORT = 5000</p><p id="dd3d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在根文件夹中，创建一个名为<strong class="kd iu"> server </strong>的文件夹，并在其中创建一个<a class="ae mc" href="https://github.com/PrincewillIroka/login-with-github/blob/master/server/index.js" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu"> index.js </strong> </a>文件。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="f4fa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">其他链接:</p><p id="0e5e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae mc" href="https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/" rel="noopener ugc nofollow" target="_blank"><em class="nh">https://developer . github . com/apps/building-oauth-apps/authoring-oauth-apps/</em></a></p><p id="7c0e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae mc" href="https://www.graphql.college/implementing-github-oauth-flow/" rel="noopener ugc nofollow" target="_blank"><em class="nh">https://www . graph QL . college/implementing-github-oauth-flow/</em></a></p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="fe50" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">结论</strong></p><p id="8400" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你遵循上面列出的几个步骤，你将能够在你的应用中无缝集成<em class="nh">“使用Github登录”</em>功能。</p><p id="9606" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这里获取源代码:<a class="ae mc" href="https://github.com/PrincewillIroka/login-with-github" rel="noopener ugc nofollow" target="_blank"> Github </a></p><p id="9e58" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">谢谢大家！</p><p id="511b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你也可以在推特上关注我。</p></div></div>    
</body>
</html>