<html>
<head>
<title>Building an e-fax solution in 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在2021年构建电子传真解决方案</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-an-e-fax-solution-in-2021-fb57f4dc7114?source=collection_archive---------26-----------------------#2021-01-11">https://levelup.gitconnected.com/building-an-e-fax-solution-in-2021-fb57f4dc7114?source=collection_archive---------26-----------------------#2021-01-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a8a3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Twilio +无服务器+亚马逊S3</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/944b3b0702127b27c4c9b78be2719127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zgDnP2iSAGKEF_KxhyaGpA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@sigmund?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae kv" href="https://unsplash.com/s/photos/fax?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d288" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">都2021年了你还想讨论怎么发传真？嗯，像房地产、医疗保健和银行这样的行业仍然严重依赖传真。</p><p id="5e7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将构建一个简单的服务，它将允许我们在没有传真机的情况下发送传真。</p><h2 id="3873" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">技术</h2><ul class=""><li id="b41b" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated">Twilio:我们将使用Twilio可编程传真API。<strong class="ky ir">你需要有一个Twilio账户和一个带传真功能的Twilio电话号码。</strong></li><li id="ebda" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">无服务器框架:我们将使用这个框架来构建一个可以快速部署的快速解决方案。</li><li id="bd68" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">亚马逊S3:我们将需要一个亚马逊S3桶来存储我们需要发送的文件。</li></ul><h2 id="03d0" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">创建项目</h2><p id="8528" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">为了构建服务，我们将使用<a class="ae kv" href="https://www.serverless.com/framework/docs/providers/aws/guide/installation/" rel="noopener ugc nofollow" target="_blank">无服务器框架</a>。让我们创建一个新项目。在要存储项目的目录中运行以下命令:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="9206" class="ls lt iq nf b gy nj nk l nl nm">serverless create --template aws-nodejs --path eFaxService</span></pre><p id="e369" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成后，我们将拥有服务的样板代码。</p><h2 id="c6c4" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">安装所需的依赖项</h2><p id="cf71" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">这项服务将使用Twilio发送传真。为了能够从Node.js使用Twilio客户端，请转到服务根目录并运行</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="1a3b" class="ls lt iq nf b gy nj nk l nl nm">npm install twilio</span></pre><p id="bd39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要一个库来实现调用AWS函数时的承诺。为此，请安装以下依赖项</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3648" class="ls lt iq nf b gy nj nk l nl nm">npm install bluebird</span></pre><h2 id="8ada" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">正在初始化Twilio客户端</h2><p id="acda" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">要使用Twilio客户机，我们需要用Twilio帐户SID和Twilio Auth令牌对它进行初始化。</p><ul class=""><li id="7360" class="ml mm iq ky b kz la lc ld lf nn lj no ln np lr ms mt mu mv bi translated">登录您的<a class="ae kv" href="https://www.twilio.com/console" rel="noopener ugc nofollow" target="_blank"> Twilio账户</a></li><li id="6815" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">在您的project Twilio仪表板上，您可以找到帐户SID和Auth Token。您也可以进入<strong class="ky ir">设置</strong>、<strong class="ky ir">常规</strong>，定位您的<strong class="ky ir">账户SID </strong>。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/c40eda6c05eede753f10bf1284aa2691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dD57G_eUKbGQGvyQLnoQvA.png"/></div></div></figure><p id="bc39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">初始化客户端</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="91c4" class="ls lt iq nf b gy nj nk l nl nm">const accountSid = '<strong class="nf ir"><em class="nr">&lt;account_sid&gt;</em></strong>';<br/>const authToken = '<strong class="nf ir"><em class="nr">&lt;account_token&gt;'</em></strong>;<br/>const twilioClient = require('twilio')(accountSid, authToken);</span></pre><p id="0211" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能会想，将帐户id和令牌放在代码中并不是一个好的做法。没错，为了安全加密地存储这些值，我们将使用AWS SSM。</p><h2 id="567b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">在AWS中创建加密参数</h2><ol class=""><li id="8f5e" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ns mt mu mv bi translated">在<a class="ae kv" href="https://console.aws.amazon.com/systems-manager/" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/systems-manager/</a>打开AWS系统管理器控制台。</li><li id="716e" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ns mt mu mv bi translated">在导航窗格中，选择<strong class="ky ir">参数存储</strong>。</li><li id="c7d6" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ns mt mu mv bi translated">选择<strong class="ky ir">创建参数</strong>选项。</li><li id="9fe1" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ns mt mu mv bi translated">在<strong class="ky ir">名称</strong>框中，输入TWILIO_ACCOUNT_SID。</li><li id="8893" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ns mt mu mv bi translated">在<strong class="ky ir">描述</strong>框中，输入<code class="fe nt nu nv nf b">Twilio account SID</code></li><li id="6655" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ns mt mu mv bi translated">对于<strong class="ky ir">类型</strong>，选择<strong class="ky ir">固定</strong>。</li><li id="c3e7" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ns mt mu mv bi translated">在<strong class="ky ir">值</strong>框中，输入从Twilio控制台获得的帐户SID值</li><li id="a927" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ns mt mu mv bi translated">最后，点击<strong class="ky ir">创建参数按钮</strong>。</li></ol><p id="7063" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对Twilio帐户令牌执行相同的操作。</p><h2 id="92b0" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">在无服务器功能中使用AWS参数</h2><p id="a7a7" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">要使用我们的无服务器函数中的两个新参数，请将以下内容添加到<code class="fe nt nu nv nf b">serverless.yml</code></p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="33df" class="ls lt iq nf b gy nj nk l nl nm">functions:<br/>  hello:<br/>    handler: handler.hello<br/>    environment:    <br/>      TWILIO_ACCOUNT_SID: ${ssm:TWILIO_ACCOUNT_SID~true}<br/>      TWILIO_AUTH_TOKEN: ${ssm:TWILIO_AUTH_TOKEN~true}</span></pre><p id="93cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无服务器框架将使用AWS SSM来检索值，解密它，并存储解密后的值。</p><p id="4375" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在我们的代码中使用它</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="d4f2" class="ls lt iq nf b gy nj nk l nl nm">const accountSid = <strong class="nf ir"><em class="nr">process</em></strong>.env.TWILIO_ACCOUNT_SID;<br/>const authToken = <strong class="nf ir"><em class="nr">process</em></strong>.env.TWILIO_AUTH_TOKEN;<br/>const twilioClient = require('twilio')(accountSid, authToken);</span></pre><h2 id="e5aa" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">发送测试传真</h2><p id="a35d" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">既然我们已经初始化了客户端，我们将发送一份传真来测试Twilio是如何工作的。让我们在<code class="fe nt nu nv nf b">handler.js</code>中创建新函数</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="8f8b" class="ls lt iq nf b gy nj nk l nl nm">const sendFax = async () =&gt;{<br/><br/>    let faxId;<br/>    await twilioClient.fax.faxes<br/>        .create({<br/>            from: &lt;YOUR_TWILIO_PHONE_NUMBER&gt;,<br/>            to: &lt;FAX_NUMBER_YOU_WANT_TO_SEND_TO&gt;,<br/>            mediaUrl: 'http://www.orimi.com/pdf-test.pdf',<br/>            storeMedia: false<br/>        })<br/>        .then(fax =&gt; {<br/>            <strong class="nf ir"><em class="nr">console</em></strong>.log(fax);<br/>            faxId = fax.sid;<br/>        });<br/>    return faxId;<br/>}</span></pre><p id="d8e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Twilio传真解决方案名为<a class="ae kv" href="https://www.twilio.com/fax" rel="noopener ugc nofollow" target="_blank"> Twilio可编程传真</a>。您需要将电话号码替换为您想要使用的号码。让我们回顾一下其他参数的平均值</p><ul class=""><li id="e2a2" class="ml mm iq ky b kz la lc ld lf nn lj no ln np lr ms mt mu mv bi translated"><code class="fe nt nu nv nf b">mediaUrl</code>:将要通过传真发送的PDF。它需要在网上提供。</li><li id="f382" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated"><code class="fe nt nu nv nf b">storeMedia</code>:是一个布尔值，它决定我们是否要在Twilio基础结构中存储已发送传真的副本。</li><li id="85fb" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated"><code class="fe nt nu nv nf b">faxId</code>:每次Twilio发送传真，都会生成一个FaxId。</li></ul><p id="6a75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行测试，您可以将这个函数添加到<code class="fe nt nu nv nf b">hello</code>函数中，如下所示</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="2557" class="ls lt iq nf b gy nj nk l nl nm">await sendFax();</span></pre><p id="9bfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后<a class="ae kv" href="https://www.serverless.com/framework/docs/providers/aws/cli-reference/invoke-local/" rel="noopener ugc nofollow" target="_blank">在本地调用该功能</a></p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3786" class="ls lt iq nf b gy nj nk l nl nm">serverless invoke local --function hello</span></pre><h2 id="0816" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">正在检索传真状态</h2><p id="3d9d" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">好了，我们的测试运行成功，我们有了<code class="fe nt nu nv nf b">faxId</code>。如何才能知道传真状态？Twilio提供了一个URL，我们可以点击它来验证传真的状态</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="497f" class="ls lt iq nf b gy nj nk l nl nm"><a class="ae kv" href="https://fax.twilio.com/v1/Faxes/FXace0348c775599fb7aa38c513335bc8c" rel="noopener ugc nofollow" target="_blank">https://fax.twilio.com/v1/Faxes/&lt;</a>faxId&gt;</span></pre><p id="3b32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">系统将提示我们输入用户名和密码。我们需要使用帐户SID作为用户，使用帐户令牌作为密码。</p><p id="521f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以定义一个<a class="ae kv" href="https://www.twilio.com/docs/fax/api/fax-resource#fax-status-callback" rel="noopener ugc nofollow" target="_blank">回调函数</a>，当传真的状态改变时，Twilio将调用这个函数。</p><p id="1ad3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们给我们的<code class="fe nt nu nv nf b">serverless.yml</code>添加一个新函数</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="fd1e" class="ls lt iq nf b gy nj nk l nl nm">faxCallback:<br/>  handler: handler.faxCallback<br/>  memorySize: 128<br/>  timeout: 40<br/>  description: Receives fax callback status<br/>  environment:<br/>    TWILIO_ACCOUNT_SID: ${ssm:TWILIO_ACCOUNT_SID~true}<br/>    TWILIO_AUTH_TOKEN: ${ssm:TWILIO_AUTH_TOKEN~true}<br/>  events:<br/>    - http:<br/>        path: callback<br/>        method: post</span></pre><p id="f5bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并将代码添加到<code class="fe nt nu nv nf b">handler.js</code></p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="83c0" class="ls lt iq nf b gy nj nk l nl nm">const Busboy = require('busboy');</span><span id="6cff" class="ls lt iq nf b gy nw nk l nl nm">module.exports.faxCallback = (event, context, callback) =&gt; {<br/><br/>    parserFormData(event).then(result =&gt; processFaxStatus(result));<br/><br/>    let response = {<br/>        statusCode: 200,<br/>        body: JSON.stringify({message: "Notification received"})<br/>    };<br/><br/>    callback(null, response);<br/>};<br/><br/>const getContentType = (event) =&gt; {<br/>    const contentType = event.headers['content-type']<br/>    if (!contentType) {<br/>        return event.headers['Content-Type'];<br/>    }<br/>    return contentType;<br/>};<br/><br/>const parserFormData = (event) =&gt; new <strong class="nf ir"><em class="nr">Promise</em></strong>( (resolve, reject) =&gt; {<br/>    const busboy = new Busboy({<br/>        headers: {<br/>            'content-type': getContentType(event)<br/>        }<br/>    });<br/><br/>    const result = {};<br/><br/>    busboy.on('field', (fieldname, value) =&gt; {<br/><br/>        result[fieldname] = value;<br/>    });<br/><br/>    busboy.on('error', error =&gt; reject(error));<br/>    busboy.on('finish', () =&gt; {<br/>        event.body = result;<br/>        resolve(event.body);<br/>    });<br/><br/>    busboy.write(event.body, event.isBase64Encoded ? 'base64' : 'binary');<br/>    busboy.end();<br/>});</span><span id="982e" class="ls lt iq nf b gy nw nk l nl nm">const processFaxStatus = (fax) =&gt; {<br/>    const TWILIO_STATUS_PENDING = ["queued", "processing", "sending"];<br/><br/>    if (TWILIO_STATUS_PENDING.indexOf(fax.Status) === -1){</span><span id="47d0" class="ls lt iq nf b gy nw nk l nl nm">        console.log(`Fax SID ${fax.FaxSid} - Status ${fax.Status}`);<br/>    }<br/>};</span></pre><p id="6aa8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该函数接收来自Twilio的传真状态响应并对其进行处理。它使用<code class="fe nt nu nv nf b">busboy</code>库来处理响应，因为它以<code class="fe nt nu nv nf b">Form data</code>的形式到来。最后，如果状态与Twilio未决状态不同，则打印状态。</p><p id="0baa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要获得回调URL，您需要将解决方案部署到AWS。这将生成一个API网关URL</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="bbe5" class="ls lt iq nf b gy nj nk l nl nm">sls deploy</span></pre><p id="442e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从部署结果中选择API网关URL，并将其添加到发送传真功能，如下所示</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="d4ef" class="ls lt iq nf b gy nj nk l nl nm">const sendFax = async () =&gt;{<br/><br/>    let faxId;<br/>    await twilioClient.fax.faxes<br/>        .create({<br/>            from: &lt;YOUR_TWILIO_PHONE_NUMBER&gt;,<br/>            to: &lt;FAX_NUMBER_YOU_WANT_TO_SEND_TO&gt;,<br/>            mediaUrl: 'http://www.orimi.com/pdf-test.pdf',<br/>            storeMedia: false,<br/>            statusCallback: &lt;YOUR_CALLBACK_URL&gt;<br/>        })<br/>        .then(fax =&gt; {<br/>            <strong class="nf ir"><em class="nr">console</em></strong>.log(fax);<br/>            faxId = fax.sid;<br/>        });<br/>    return faxId;<br/>}</span></pre><h2 id="eade" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">从S3检索PDF文件</h2><p id="9acb" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">此时，我们可以发送传真并检索其状态。但是我们怎样才能发送我们自己的文件而不公开它们呢？</p><p id="10df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">AWS S3拥有<a class="ae kv" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/ShareObjectPreSignedURL.html" rel="noopener ugc nofollow" target="_blank">预签名网址</a>。这将允许我们在确定的时间内暴露一个文件。让我们创建一个新函数</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="28e7" class="ls lt iq nf b gy nj nk l nl nm">const AWS = require('aws-sdk');<br/>AWS.config.setPromisesDependency(require('bluebird'));<br/><br/>const s3 = new AWS.S3();</span><span id="8005" class="ls lt iq nf b gy nw nk l nl nm">const getPdfUrl = async () =&gt; {<br/>    const signedUrlExpireSeconds = 15 * 60;<br/><br/>    return await s3.getSignedUrlPromise('getObject', {<br/>        Bucket: &lt;YOUR_BUCKET_NAME&gt;,<br/>        Key: `&lt;YOUR_FILE_NAME&gt;`,<br/>        Expires: signedUrlExpireSeconds<br/>    });<br/>}</span></pre><p id="c1fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将<code class="fe nt nu nv nf b">hello</code>功能修改为</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="03b1" class="ls lt iq nf b gy nj nk l nl nm">const pdfUrl = await getPdfUrl();<br/>await sendFax(pdfUrl);</span></pre><p id="a887" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和<code class="fe nt nu nv nf b">sendFax</code>功能</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="0078" class="ls lt iq nf b gy nj nk l nl nm">const sendFax = async pdfUrl =&gt;{<br/><br/>    let faxId;<br/>    await twilioClient.fax.faxes<br/>        .create({<br/>            from: &lt;YOUR_TWILIO_PHONE_NUMBER&gt;,<br/>            to: &lt;FAX_NUMBER_YOU_WANT_TO_SEND_TO&gt;,<br/>            mediaUrl: pdfUrl,<br/>            storeMedia: false,<br/>            statusCallback: &lt;YOUR_CALLBACK_URL&gt;<br/>        })<br/>        .then(fax =&gt; {<br/>            <strong class="nf ir"><em class="nr">console</em></strong>.log(fax);<br/>            faxId = fax.sid;<br/>        });<br/>    return faxId;<br/>}</span></pre><p id="6419" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，部署解决方案</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="4a04" class="ls lt iq nf b gy nj nk l nl nm">sls deploy</span></pre><h2 id="33b7" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><p id="da90" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">传真技术的使用仍然比你想象的要多。如果您需要快速、经济的解决方案，我们在本文中讨论的技术可以作为创建简单的电子传真解决方案的起点。</p><p id="91d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在某些情况下，您可能希望在发送之前合并几个PDF文件。发送过程将是相同的。要合并pdf文件，你可以按照我以前的文章。</p><div class="nx ny gp gr nz oa"><a href="https://medium.com/javascript-in-plain-english/how-to-merge-pdf-files-with-serverless-functions-7b7e8e4d770a" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">如何用无服务器功能合并PDF文件</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">使用Ghostscript形成AWS Lambda函数</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo kp oa"/></div></div></a></div></div></div>    
</body>
</html>