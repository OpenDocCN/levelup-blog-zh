<html>
<head>
<title>Decoding the RSA algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解密RSA算法</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/decoding-the-rsa-algorithm-ecc5caca1392?source=collection_archive---------10-----------------------#2021-06-12">https://levelup.gitconnected.com/decoding-the-rsa-algorithm-ecc5caca1392?source=collection_archive---------10-----------------------#2021-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="31f6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">密码术系列III —如何手动生成RSA密钥对？</h2></div><p id="6af8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我相信你听说过RSA。如果你没听说，我可以告诉你，你今天已经在电脑上用RSA了！RSA是关于什么的？数字签名！RSA加密几乎无处不在，包括比特币和大多数区块链！</p><p id="3f40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本密码学系列的前两篇文章中，我已经谈到了:</p><ul class=""><li id="1cc6" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">随机数:区块链最重要的东西！和</li><li id="9305" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld lj lk ll lm bi translated"><a class="ae ln" href="https://henriquecentieiro.medium.com/prime-numbers-and-why-blockchains-cant-exist-without-them-f629bdc54bb3" rel="noopener">质数——以及为什么区块链不能没有质数！</a></li></ul><p id="ee02" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想了解关于强私钥的更多信息，也请阅读那些文章！</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lt"><img src="../Images/1e8634b9bd795eadba6612844db0bae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqLc5xFypMZkX0CgXWPRtg.jpeg"/></div></div></figure><p id="16af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RSA被用作加密方案和数字签名，用于电子邮件、网站消息、聊天应用程序和许多其他类型的通信中，以保护消息。当然，这在区块链世界也很重要。</p><p id="dac4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RSA加密算法是由罗恩·里弗斯、阿迪·萨莫尔和伦纳德·阿德曼于1978年发明的。RSA使用公钥基础架构和数字签名实施非对称加密。RSA是全球最常用的公钥算法，也是人类历史上被复制最多的软件。每个互联网用户每次进行在线交易或支付时都会使用RSA，我们每次签署区块链交易或向某人发送比特币时也会使用它。</p><p id="2095" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在公钥加密中，生成两种密钥:可以与任何人共享的公钥和只有其所有者知道的私钥。公钥用于加密数据，私钥可以解密数据，这意味着只有拥有相应私钥的用户才能解密数据或签署交易。在交易交换中，两个用户都生成用作数字签名的公钥/私钥对。</p><p id="378f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以从下面的方式看到这个加密系统:</p><ol class=""><li id="ba62" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld mf lk ll lm bi translated">爱丽丝有一把锁和相应的钥匙(公钥是锁，私钥是锁的钥匙)</li><li id="f32d" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">她给鲍勃发了一把打开的锁</li><li id="c6f9" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">鲍勃把信息放进锁里，然后把它送回给爱丽丝</li><li id="2c1b" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">爱丽丝可以用她的私人钥匙打开锁。</li></ol><p id="076c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种公钥基础设施中，用户的数字签名用于验证交易签名的真实性，从而提供了一种安全的方式来检查用户的交易是否由其拥有的私钥签名。任何人都可以使用收件人的公钥发送消息，只有收件人才能用他的私钥打开消息。</p><p id="7685" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是<a class="ae ln" href="https://henriquecentieiro.medium.com/prime-numbers-and-why-blockchains-cant-exist-without-them-f629bdc54bb3" rel="noopener"> <strong class="kk iu">质数</strong> </a>和<a class="ae ln" rel="noopener ugc nofollow" target="_blank" href="/random-numbers-the-single-most-important-thing-in-blockchain-e850d4e23a51"> <strong class="kk iu">随机数</strong> </a>发挥作用的地方。</p><p id="839d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RSA签名是非常安全的，因为它们是由很难分解的大素数的乘法运算生成的。RSA概念由4个步骤组成:生成密钥、分发密钥、加密数据和解密数据。</p><p id="803e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为什么随机数很重要？我们看到的随机数将帮助我们选择大素数，我们将使用这些大素数来生成RSA密钥。在得到随机数(一个巨大的数)后，如果这个随机数不是一个质数，函数将搜索下一个最接近的质数。</p><p id="dad8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看生成RSA密钥对的步骤:</p><ol class=""><li id="146e" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld mf lk ll lm bi translated">生成一个随机数。尝试使用随机数生成器。这个数字需要很大，比如154位数或者10个⁵⁴</li><li id="3597" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">如果随机数不是质数，使用函数<em class="mg"> nextprime() </em>选择最接近的质数。另选一个质数。让我们称这两个质数为<strong class="kk iu"> p1 </strong>和<strong class="kk iu"> p2 </strong></li><li id="ee5b" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">得到p1和p2的乘积，即N = p1 x p2，如你所见，这个合数N将超过300位数，因为你要乘以2个大质数</li><li id="f130" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">得到φ或φ:φ(N)(欧拉定理)，用P1–1和p2–1代替素数，并相乘:φ(N)=(P1–1)x(p2–1)。注意φ是一个数的“可破性”。给定n，φ测量有多少小于或等于n的整数不与n共享任何公因数。例如φ8 = 4。计算φ在一种情况下很难预料。任何素数的φ总是P1–1。一旦有了φ(N)=(P1–1)x(p2–1)，如果有了N的因式分解，那么求φ(N)就很容易了。比如77 =7x11的质因数分解。</li><li id="5566" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">选择一个指数。选e:1 &lt; e &lt; Phi(N)</li><li id="a616" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">Lock: Lock (N,e)</li><li id="466a" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">Chose private key: choose d:d x e mod Phi(N) = 1</li><li id="23c3" class="le lf it kk b kl lo ko lp kr lq kv lr kz ls ld mf lk ll lm bi translated">Key: your key result is (d, N), where d is the private key and N is the public key</li></ol><p id="7890" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">In step 5, we connect the phi (Φ) function to modular exponentiation, exploring <a class="ae ln" href="https://en.wikipedia.org/wiki/Euler's_theorem" rel="noopener ugc nofollow" target="_blank">欧拉定理</a>phi函数与模幂运算的关系:<em class="mg">m^φ(n)≡1 mod n</em>。</p><p id="7802" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着我们可以选择任意两个没有公因数的数字，比如5和8，并替换等式中的m和n:</p><p id="365e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mg">5^φ(8)≡1 mod 8</em></p><p id="a290" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也就是625 1 mod 8</p><p id="ee3d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以稍微改变一下，我们得到</p><p id="42cc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mg">m^k*φ(n)+1≡m mod n或m^e*d ≡ m mod n也就是e * d = k *φ(n)+1</em></p><p id="0662" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在很容易计算d，只要知道n的因式分解:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/96c13b3212ac106852d13d0dbc5253ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*4lqTQ2-LdYW0GbyRd7uKkw.png"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">我们需要这个来签字！</figcaption></figure><p id="81d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">意味着d是私钥！</p><p id="b98f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们做一个简单的例子来看看Alice和Bob之间的关键点。</p><p id="f71e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Alice将生成两个素数，p1和p2(为了便于举例，让我们挑选两个小素数)并将它们相乘得到n。</p><p id="966e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如你在下面的例子中看到的，我们“随机选择”的素数是53和59。我们将它们相乘，得到n=3127。这个n是爱丽丝的公钥。</p><p id="47ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，Alice很容易计算，因为她知道n的因式分解，结果是3016。然后，她选择了一个“公共”指数，这个指数必须是奇数，而且不能与本例中的3相同。最后，她找到了自己的私钥值<em class="mg"> d </em>。如你所见，爱丽丝的私钥是2011年。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/87efd382abfb4177d6e4d46d566f763d.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*UYk9IUacRMHoRlnU-e7khQ.png"/></div></figure><p id="7714" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在她有了<em class="mg"> d </em>，私钥和<em class="mg"> n </em>和<em class="mg"> e </em>是公钥。<em class="mg"> n </em>和<em class="mg"> e </em>就像一把打开的锁，她可以送给Bob！在这个例子中，Bob的消息只是数字89。所以我们有m=89。现在，Bob可以发送一条消息<em class="mg"> m </em>，通过计算m的e次方mod n，在数学上锁定该消息。这里，m是Bob的消息，让我们将这个新的“c”称为Bob的加密消息。这样，Bob就用Alice的公钥n和e加密了他的消息！</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/7c99fe9791ad3b5d2962394fb784521c.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*oJS27vUeMZ65kWNXZxw2pQ.png"/></div></figure><p id="68fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在Bob将c(加密的消息)发送回Alice，Alice将使用她的私钥d解密该消息。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/02b78fc5c24c08ba808b052864f8b73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*gAXCxeJg6pk4UcnUaYrMRQ.png"/></div></figure><p id="f8b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，其他任何人最终都可以听到他们交换的消息(中间人攻击)。然而，如果没有c、n或e，他们就找不到指数d，而指数d是解密消息所必需的私钥。这是加密消息的聪明方法。</p><p id="4039" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如你所看到的，还需要很多很多年才能发现相乘得到n的两个质数。要发现如此大的数的因式分解(RSA至少有200个十进制数字(663位)长)，需要花费10000000长的时间，这在计算上是不可行的。即使是量子计算机也可能需要很长时间才能破解1024位RSA密钥。</p><p id="25c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我有一个挑战给你:按照RSA算法，手动签名一个解密一个消息自己！</p><p id="7f8e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">🚀跟着我，也请查看我的🧱区块链课程:</strong></p><p id="0157" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">🐶</strong> <a class="ae ln" href="https://www.udemy.com/course/-dogecoin-course-the-first-complete-dogecoin-course/?referralCode=9416B1408224CE309DD8" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">有史以来第一个Dogecoin课程</strong> </a></p><p id="1a27" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">👨‍🎓</strong> <a class="ae ln" href="https://www.udemy.com/course/fintech-technologies-cloud-and-cybersecurity/?referralCode=F1D4EA005A2881735A36" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> Fintech、云和网络安全课程</strong> </a></p><p id="62f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">📖</strong> <a class="ae ln" href="https://www.amazon.com/dp/B091CYTX37/ref=sr_1_1?dchild=1&amp;keywords=unblockchain&amp;qid=1617186443&amp;s=digital-text&amp;sr=1-1" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> </strong> </a> <a class="ae ln" href="https://www.udemy.com/course/the-complete-nft-course-learn-everything-about-nfts/?referralCode=AAEE908D13D0E2276B19" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">完整的NFTs教程</strong> </a></p><p id="475d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">👨‍🎓</strong> <a class="ae ln" href="https://www.udemy.com/course/blockchain-deep-dive-from-bitcoin-to-ethereum-to-crypto/?referralCode=B8463EE382E6D313304B" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> Unblockchain课程</strong> </a> <strong class="kk iu"> —脑洞大开的区块链课程</strong></p></div></div>    
</body>
</html>