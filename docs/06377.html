<html>
<head>
<title>StencilJS &amp; Web Worker: A Fairy Tale</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">StencilJS &amp; Web Worker:一个童话</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/stenciljs-web-worker-a-fairy-tale-ec48343fce17?source=collection_archive---------9-----------------------#2020-11-19">https://levelup.gitconnected.com/stenciljs-web-worker-a-fairy-tale-ec48343fce17?source=collection_archive---------9-----------------------#2020-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0a6e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">模板编译器的故事和它对Web Worker API的神奇集成。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/de0c68c17704c24d9ac9f62be5bd8832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXwuHYRWLLamBbB5zg6gtg.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="0799" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">从前，有一个生成web组件并构建高性能Web应用的编译器，叫做<a class="ae lx" href="https://stenciljs.com" rel="noopener ugc nofollow" target="_blank"> StencilJS </a>。在所有创建的构建时工具中，它的目标是构建更快、更强大的组件，这些组件可以跨所有主要框架工作。</p><p id="ef71" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在隔壁的互联网上，住着一个男孩(我😉).男孩看着编译器变得越来越有效，越来越对开发者友好。</p><p id="9bfc" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">一天，当他在他心爱的项目<a class="ae lx" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>中开发新的东西时，这个男孩有了一个想法，要试验一个他至今从未尝试过的编译器特性，集成<a class="ae lx" href="https://stenciljs.com/docs/web-workers" rel="noopener ugc nofollow" target="_blank"> Web Workers </a>。</p><p id="fd41" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">他被结果震惊了，不得不分享那次神奇的遭遇。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="7917" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">第一章:胡言乱语</h1><p id="5fba" class="pw-post-body-paragraph lb lc it ld b le mq ju lg lh mr jx lj lk ms lm ln lo mt lq lr ls mu lu lv lw im bi translated">一个男孩发表了一篇博文，但不愿透露任何未知的秘密咒语。同时，没有神奇的词语就没有好的童话。</p><p id="8360" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">幸运的是，编译器在一本名为“<a class="ae lx" href="https://stenciljs.com/docs/web-workers" rel="noopener ugc nofollow" target="_blank"> documentation </a>”的记录良好的魔法书中向任何人公开分享了它的魔法。</p><p id="fa44" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">勇敢的骑士们寻求在技术上击败这样的实现，让我建议你看看这些法术，但是，如果相反，你是来这里寻找一个任务，留在我身边，让我告诉你剩下的故事。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="e7b1" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">第二章:初始化卡梅洛特</h1><p id="761e" class="pw-post-body-paragraph lb lc it ld b le mq ju lg lh mr jx lj lk ms lm ln lo mt lq lr ls mu lu lv lw im bi translated">亚瑟王和圆桌有卡梅洛特，我们，开发者，有Web组件和影子DOM，可以比喻成城堡。这就是为什么我们在尝试新的魔术之前要初始化一个新的模板操场。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="8b2f" class="na lz it mw b gy nb nc l nd ne">npm init stencil</span></pre><p id="d7c1" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">此外，为了复制男孩尝试过的精确公式，我们使用了<a class="ae lx" href="https://marked.js.org/" rel="noopener ugc nofollow" target="_blank"> Marked.js </a>来增强我们的防御工事，以便我们给组件一个目标，从Markdown到HTML呈现一个神奇的句子。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="c134" class="na lz it mw b gy nb nc l nd ne">npm i marked @types/marked</span></pre><p id="8cd6" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">已经找到了一些迫击炮，我们正在创建一个组件，旨在通过在生命周期<code class="fe nf ng nh mw b">componentWillLoad</code>时将markdown转换为HTML，并通过使用本地状态来应用它，从而再现渲染咒语。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="3465" class="na lz it mw b gy nb nc l nd ne">import { Component, h, State } from '@stencil/core';<br/><br/>import { parseMarkdown } from './markdow';<br/><br/>@Component({<br/>  tag: 'my-camelot',<br/>  shadow: true,<br/>})<br/>export class MyCamelot {<br/><br/>  @State()<br/>  private markdownHtml: string;<br/><br/>  async componentWillLoad() {<br/>    this.markdownHtml = await parseMarkdown(`# Choose wisely<br/><br/>For while the true Grail will **bring you life**, the false Grail will take it from you.`<br/>    );<br/>  }<br/><br/>  render() {<br/>    return &lt;div innerHTML={this.markdownHtml}&gt;&lt;/div&gt;;<br/>  }<br/>}</span></pre><p id="c1d4" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">此外，我们将这个神奇的功能外化到一个单独的文件中，我们可以称之为<code class="fe nf ng nh mw b">markdown.ts</code>。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="5f83" class="na lz it mw b gy nb nc l nd ne">import marked from 'marked';<br/><br/>export const parseMarkdown = async (text: string) =&gt; {<br/>  const renderer = new marked.Renderer();<br/><br/>  return marked(text, {<br/>    renderer,<br/>    xhtml: true,<br/>  });<br/>};</span></pre><p id="3d21" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">有些人可能什么都不怕，可能在他们的本地计算机<code class="fe nf ng nh mw b">npm run start</code>上运行上面的代码，他们可能会观察到下面的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/5ae4ab52192491c7bdff41cb49288529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ube4TfnIPeJrXX0vD0wRDA.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="b913" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">第三章:咒语召唤</h1><p id="a0d6" class="pw-post-body-paragraph lb lc it ld b le mq ju lg lh mr jx lj lk ms lm ln lo mt lq lr ls mu lu lv lw im bi translated">这个男孩已经发表了关于Web Workers的文章，一篇是关于他们在React 应用中的原生<a class="ae lx" rel="noopener ugc nofollow" target="_blank" href="/react-and-web-workers-c9b60b4b6ae8"> JavaScript集成，另一篇展示了他们与Angular </a>的<a class="ae lx" href="https://medium.com/swlh/angular-and-web-workers-17cd3bf9acca" rel="noopener">集成。</a></p><p id="07ee" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">从在Javascript版本中为工作人员提供可用的库，到在这两个版本中使用侦听器和创建对象来加载这些库，即使从某个角度来看需要很少的工作，但仍然需要更多的工作和代码。</p><p id="747e" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">与此相反，让这个男孩惊奇的是，Stencil通过简单地调用一个独特的咒语使所有这些步骤变得神奇:<code class="fe nf ng nh mw b">mv markdown.ts markdown.worker.ts</code></p><p id="c4e7" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">事实上，正如你在下面的截图中注意到的，任何在以<code class="fe nf ng nh mw b">.worker.ts</code>结尾的<code class="fe nf ng nh mw b">src</code>目录中的TypeScript文件都将自动使用模板编译器的一个worker，据这个男孩所知，这是他尝试过的最神奇的Web Worker配方🔥。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/74bf086d0514f51b719773cf7d483d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WjLbi1ajmi4H0rlACo4dPA.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="5322" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">收场白</h1><p id="4c2e" class="pw-post-body-paragraph lb lc it ld b le mq ju lg lh mr jx lj lk ms lm ln lo mt lq lr ls mu lu lv lw im bi translated">简化了这种集成的<a class="ae lx" href="https://stenciljs.com" rel="noopener ugc nofollow" target="_blank"> Stencil的</a>编译器再次展示了它的全部潜力。和网络工作者一起，他们有希望会有许多孩子，许多令人惊奇的网络组件和应用程序。</p><p id="37c5" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">到无限和更远的地方！</p><p id="e146" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">大卫</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="802f" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">你可以在推特上联系我，为什么不试着在<a class="ae lx" href="https://deckdeckgo.com/" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>上发表你的下一次演讲。</p></div></div>    
</body>
</html>