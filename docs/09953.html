<html>
<head>
<title>Cool stuff you can do with Python, SQLite, and typer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python、SQLite和typer可以做的很酷的事情</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/cool-stuff-you-can-do-with-python-sqlite-and-typer-8d998b69476d?source=collection_archive---------2-----------------------#2021-10-08">https://levelup.gitconnected.com/cool-stuff-you-can-do-with-python-sqlite-and-typer-8d998b69476d?source=collection_archive---------2-----------------------#2021-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ba87d92ee1f86ac36600fd2b8c004e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fAqZnHor1sYkJJPtF0pXNg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">来造点东西吧(图片由作者提供)。</figcaption></figure><h1 id="f933" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak">简介</strong></h1><p id="4a6e" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在这个故事中，我将演示如何使用SQLite作为底层数据存储来构建一个简单的CLI(命令行界面)应用程序。我将尝试做一个简单的任务管理应用程序，并演示其背后的基本概念。为了证明我的选择是正确的，我会说这样的应用程序<em class="mb">业务</em> <em class="mb">逻辑</em>可以被已经熟悉任何任务管理应用程序的人理解，所以我们可以把注意力集中在技术细节上。</p><h1 id="96dc" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak">堆栈</strong></h1><ul class=""><li id="1db5" class="mc md it lf b lg lh lk ll lo me ls mf lw mg ma mh mi mj mk bi translated">typer  —用于在python中构建CLI应用程序的库；</li><li id="5331" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><a class="ae ml" href="https://www.sqlite.org/index.html" rel="noopener ugc nofollow" target="_blank"> SQLite </a> —小型、快速、独立的SQL数据库引擎(这听起来很酷，不是吗？)</li><li id="757c" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">和一点python 3</li></ul><h1 id="8567" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">准备</h1><ol class=""><li id="fc53" class="mc md it lf b lg lh lk ll lo me ls mf lw mg ma mr mi mj mk bi translated">你需要在你的虚拟机中安装<em class="mb">类型器</em></li><li id="00b0" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mr mi mj mk bi translated">SQLite支持内置于python中，因此我们在这里是安全的</li><li id="0bee" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mr mi mj mk bi translated">在您的工作目录中创建您的第一个文件:<em class="mb"> main.py </em></li></ol><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="cd46" class="ne kg it mv b gy nf ng l nh ni">.<br/>└── main.py</span></pre><h1 id="e657" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">入门指南</h1><p id="db33" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们从CLI的基本框架开始。我们需要的是项目实例和任务实例。对于这两个实例，我们需要列表和创建操作，对于任务，我们假设只有两种状态:打开和关闭，我们需要关闭任务并重新打开它的能力。</p><p id="3ac7" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated"><strong class="lf iu">项目实体</strong></p><ul class=""><li id="0a2f" class="mc md it lf b lg nj lk nk lo no ls np lw nq ma mh mi mj mk bi translated"><em class="mb">名称</em> —项目名称(必填)</li><li id="a511" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><em class="mb">描述</em> —项目描述(可选)</li></ul><p id="64e6" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated"><strong class="lf iu">任务实体</strong></p><ul class=""><li id="35e0" class="mc md it lf b lg nj lk nk lo no ls np lw nq ma mh mi mj mk bi translated"><em class="mb">标题</em> —任务标题</li><li id="2d9d" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><em class="mb">描述</em> —详细描述</li><li id="0fee" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><em class="mb">状态</em> —打开/关闭之一</li><li id="2e91" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><em class="mb"> project_id </em> —这样我们就知道任务分配给了哪些项目</li></ul><p id="08d6" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">CLI界面应该大致如下所示:</p><ul class=""><li id="c0dc" class="mc md it lf b lg nj lk nk lo no ls np lw nq ma mh mi mj mk bi translated"><code class="fe ms mt mu mv b">projects list</code> —将列出可用的项目</li><li id="5d34" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><code class="fe ms mt mu mv b">projects create &lt;name&gt; --description "Some desc"</code> —将创建新的项目实体</li><li id="4a7b" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><code class="fe ms mt mu mv b">projects tasks list &lt;project_name&gt;</code>将列出项目中的任务，这里我们可能还需要一些像<code class="fe ms mt mu mv b">--status OPEN</code>这样的参数来过滤任务</li><li id="0a0b" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><code class="fe ms mt mu mv b">projects tasks create &lt;project_name&gt; &lt;title&gt; --description "Some desc"</code> —允许我们创建新任务</li><li id="caf6" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><code class="fe ms mt mu mv b">projects tasks show &lt;task_id&gt;</code> —将显示任务详细信息</li><li id="607a" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><code class="fe ms mt mu mv b">projects tasks open &lt;task_id&gt;</code> —将打开任务</li><li id="dc84" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated"><code class="fe ms mt mu mv b">projects tasks close &lt;task_id&gt;</code> —将使任务关闭</li></ul><p id="bcb7" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">CLI框架:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="7739" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">现在我们可以进入命令行，看看它是如何工作的:</p><ol class=""><li id="0f26" class="mc md it lf b lg nj lk nk lo no ls np lw nq ma mr mi mj mk bi translated">主命令处理程序的帮助</li></ol><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="56a0" class="ne kg it mv b gy nf ng l nh ni">todolist  python3 main.py --help<br/>Usage: main.py [OPTIONS] COMMAND [ARGS]...</span><span id="e78f" class="ne kg it mv b gy nt ng l nh ni">Options:<br/>  --install-completion [bash|zsh|fish|powershell|pwsh]<br/>                                  Install completion for the specified shell.<br/>  --show-completion [bash|zsh|fish|powershell|pwsh]<br/>                                  Show completion for the specified shell, to<br/>                                  copy it or customize the installation.<br/>  --help                          Show this message and exit.</span><span id="3d2c" class="ne kg it mv b gy nt ng l nh ni">Commands:<br/>  projects</span></pre><p id="f67e" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">2.项目命令的帮助</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="07b2" class="ne kg it mv b gy nf ng l nh ni">todolist  python3 main.py projects --help<br/>Usage: main.py projects [OPTIONS] COMMAND [ARGS]...</span><span id="f197" class="ne kg it mv b gy nt ng l nh ni">Options:<br/>  --help  Show this message and exit.</span><span id="e117" class="ne kg it mv b gy nt ng l nh ni">Commands:<br/>  create  Create the new project.<br/>  list    List of the available projects.<br/>  tasks</span></pre><p id="d866" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">3.项目创建命令</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="e3e1" class="ne kg it mv b gy nf ng l nh ni">todolist  python3 main.py projects create --help<br/>Usage: main.py projects create [OPTIONS] PROJECT_NAME</span><span id="c9f1" class="ne kg it mv b gy nt ng l nh ni">Create the new project.</span><span id="6e7e" class="ne kg it mv b gy nt ng l nh ni">Arguments:<br/>  PROJECT_NAME  [required]</span><span id="b7df" class="ne kg it mv b gy nt ng l nh ni">Options:<br/>  --description TEXT<br/>  --help              Show this message and exit.</span><span id="7b68" class="ne kg it mv b gy nt ng l nh ni">todolist  python3 main.py projects create TEST<br/>Create new project: TEST, None</span></pre><blockquote class="nu nv nw"><p id="c263" class="ld le mb lf b lg nj li lj lk nk lm ln nx nl lq lr ny nm lu lv nz nn ly lz ma im bi translated">注意这里的<code class="fe ms mt mu mv b">--description</code>选项。</p></blockquote><p id="c92c" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">4.任务创建命令</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="32de" class="ne kg it mv b gy nf ng l nh ni">todolist  python3 main.py projects tasks create TEST "This is first task" --description "And this is task description"<br/>Creating the new task: TEST, This is first task, And this is task description</span></pre><h1 id="043f" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">数据库层</h1><p id="b75c" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">为了存储数据，我们需要首先初始化数据库，这有点棘手，因为它只需要发生一次。我可以为数据库初始化创建特殊的命令，或者对用户隐藏它，并在第一次运行CLI时执行。我倾向于第二种选择。让我们开始吧。</p><p id="eb65" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">让我们首先更新工作目录结构:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="3e2f" class="ne kg it mv b gy nf ng l nh ni">.<br/>├── __init__.py<br/>├── database.py<br/>└── main.py</span></pre><p id="d100" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated"><code class="fe ms mt mu mv b">database.py</code>文件内容是:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><blockquote class="nu nv nw"><p id="2916" class="ld le mb lf b lg nj li lj lk nk lm ln nx nl lq lr ny nm lu lv nz nn ly lz ma im bi translated">注意检查数据库是否已经初始化的非常简单的方法，即<code class="fe ms mt mu mv b">_db_exists</code>方法。这很简单，但能完成任务。</p></blockquote><p id="e82e" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">现在，对于<code class="fe ms mt mu mv b">main.py</code>，我们需要添加:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="7cf6" class="ne kg it mv b gy nf ng l nh ni">from database import Database</span><span id="9288" class="ne kg it mv b gy nt ng l nh ni"># ...</span><span id="2712" class="ne kg it mv b gy nt ng l nh ni">if __name__ == "__main__":<br/>    database = Database()<br/>    database.initialize()<br/>    app()</span></pre><p id="55c9" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">通过这种方式，我们将始终拥有一个可以与之对话的数据库。</p><p id="967b" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">如果您现在从<code class="fe ms mt mu mv b">main.py</code>运行任何命令，数据库将被创建，您应该能够在文件结构中看到:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="409f" class="ne kg it mv b gy nf ng l nh ni">.<br/>├── database.py<br/>├── __init__.py<br/>├── main.py<br/>└── todos.db</span></pre><p id="1f63" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">现在，在<code class="fe ms mt mu mv b">Database</code>类上，我们需要实现简单的处理程序来完成:</p><ul class=""><li id="8f5d" class="mc md it lf b lg nj lk nk lo no ls np lw nq ma mh mi mj mk bi translated">列出项目</li><li id="b8a0" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">列出任务</li><li id="7c4e" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">创建项目</li><li id="61f9" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">创建任务</li><li id="0c18" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">更改任务状态</li><li id="d47c" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">获取任务详细信息</li></ul><p id="2c3d" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">让我们实现它们，使这个练习更容易——您可以使用一些开源的<a class="ae ml" href="https://sqlitebrowser.org/" rel="noopener ugc nofollow" target="_blank"> SQLite阅读器在<code class="fe ms mt mu mv b">todos.db</code>中手动创建条目。</a></p><p id="1980" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">向<code class="fe ms mt mu mv b">Database</code>类添加以下方法和属性:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="1ca6" class="ne kg it mv b gy nf ng l nh ni">class Database:<br/>    # ...<br/>    PROJECT_LIST_SQL = """SELECT * FROM project;"""</span><span id="6d41" class="ne kg it mv b gy nt ng l nh ni">    def run_sql(self, query, args=None, commit=False, fetch=False):<br/>        args = args or ()<br/>        data = None<br/>        with sqlite3.connect("todos.db") as connection:<br/>            cursor = connection.cursor()<br/>            cursor.execute(query, args)<br/>            if commit:<br/>                connection.commit()<br/>            if fetch:<br/>                data = cursor.fetchall()<br/>        return data</span><span id="0ad3" class="ne kg it mv b gy nt ng l nh ni">    def get_project_list(self):<br/>        return self.run_sql(query=self.PROJECT_LIST_SQL, fetch=True)</span></pre><p id="5bfe" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">修改<code class="fe ms mt mu mv b">main.py</code>文件，找到项目列表处理程序并执行以下操作:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="122d" class="ne kg it mv b gy nf ng l nh ni"># move the database = Database() to the top of the file</span><span id="a13f" class="ne kg it mv b gy nt ng l nh ni">@project_app.command("list")<br/>def project_list():<br/>    <em class="mb">"""List of the available projects."""<br/>    </em>print(database.get_project_list())<br/>    typer.echo("List of projects")</span></pre><p id="7c08" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">现在，如果您手动将一些项目添加到SQLlite数据库，您应该会得到:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="68b8" class="ne kg it mv b gy nf ng l nh ni">todolist  python3 main.py projects list<br/>[(1, 'TEST', 'Some test project')]<br/>List of projects</span></pre><p id="4880" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">正如您看到的原始SQL响应，我们也应该通过引入能够处理项目和任务实体的<code class="fe ms mt mu mv b">dataclasses</code>来解决这个问题，让我们开始吧。</p><p id="5e03" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">创建新文件<code class="fe ms mt mu mv b">data.py</code>:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="cea7" class="ne kg it mv b gy nf ng l nh ni">.<br/>├── constants.py<br/>├── database.py<br/>├── data.py<br/>├── __init__.py<br/>├── main.py<br/>└── todos.db</span></pre><blockquote class="nu nv nw"><p id="e67d" class="ld le mb lf b lg nj li lj lk nk lm ln nx nl lq lr ny nm lu lv nz nn ly lz ma im bi translated">这里注意:在<code class="fe ms mt mu mv b">constants.py</code> <em class="it">中，我有</em></p></blockquote><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="c04a" class="ne kg it mv b gy nf ng l nh ni">from enum import IntEnum<br/><br/><br/>class TaskStatusE(IntEnum):<br/>    OPEN = 1<br/>    CLOSED = 2</span></pre><p id="922a" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">并粘贴以下行:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="9283" class="ne kg it mv b gy nf ng l nh ni">from dataclasses import dataclass<br/>from typing import Union<br/><br/><br/>@dataclass<br/>class Project:<br/>    id: Union[int, None]  # when creating ID can be empty<br/>    name: str<br/>    description: Union[str, None]  # description is optional<br/><br/><br/>@dataclass<br/>class Task:<br/>    id: Union[int, None]  # when creating ID can be empty<br/>    title: str<br/>    description: Union[str, None]  # description is optional<br/>    status: int<br/>    project_id: int</span></pre><p id="3f0f" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">修改<code class="fe ms mt mu mv b">main.py</code>文件:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="d67b" class="ne kg it mv b gy nf ng l nh ni">@project_app.command("list")<br/>def project_list():<br/>    <em class="mb">"""List of the available projects."""<br/>    </em>projects = [Project(id=row[0], name=row[1], description=row[2]) for row in database.get_project_list()]<br/>    for project in projects:<br/>        typer.echo(f"Project: {project.name}, description: {project.description}, ID: {project.id}")</span></pre><p id="d421" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">运行列出项目的命令后:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="c882" class="ne kg it mv b gy nf ng l nh ni">todolist  python3 main.py projects list<br/>Project: TEST, description: Some test project, ID: 1</span></pre><p id="e990" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">我们就快到了，我现在将创建从命令行创建项目的可能性。</p><p id="9ab5" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">要创建项目，我们需要修改<code class="fe ms mt mu mv b">main.py</code>文件中的<code class="fe ms mt mu mv b">project_create</code>处理程序:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="abeb" class="ne kg it mv b gy nf ng l nh ni">@project_app.command("create")<br/>def project_create(project_name: str, description: str = None):<br/>    <em class="mb">"""Create the new project."""<br/>    </em>project = Project(id=None, name=project_name, description=description)<br/>    database.create_project(project)<br/>    typer.echo(f"Project `{project_name}` created.")</span></pre><p id="934d" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">在<code class="fe ms mt mu mv b">Database</code>类中我们需要添加一个新方法:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="b4d0" class="ne kg it mv b gy nf ng l nh ni">def create_project(self, project):<br/>    return self.run_sql(query=self.CREATE_PROJECT, args=(project.name, project.description or ""),<br/>                        commit=True)</span></pre><blockquote class="nu nv nw"><p id="ac23" class="ld le mb lf b lg nj li lj lk nk lm ln nx nl lq lr ny nm lu lv nz nn ly lz ma im bi translated">注意这里，我是如何使用这里刚刚定义的<code class="fe ms mt mu mv b">Project</code>数据类的。</p></blockquote><p id="ac03" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">测试运行:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="f862" class="ne kg it mv b gy nf ng l nh ni">todolist  python3 main.py projects create TEST01 --description "First one created by CLI"<br/>Project `TEST01` created.</span><span id="260c" class="ne kg it mv b gy nt ng l nh ni">todolist  python3 main.py projects list<br/>Project: TEST, description: Some test project, ID: 1<br/>Project: TEST01, description: First one created by CLI, ID: 2</span><span id="ea8c" class="ne kg it mv b gy nt ng l nh ni">todolist  python3 main.py projects create TEST02<br/>Project `TEST02` created.</span><span id="441f" class="ne kg it mv b gy nt ng l nh ni">todolist  python3 main.py projects list<br/>Project: TEST, description: Some test project, ID: 1<br/>Project: TEST01, description: First one created by CLI, ID: 2<br/>Project: TEST02, description: , ID: 3</span></pre><p id="2bbc" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated">现在，使用相同的模式，让我们处理任务处理程序(我将在文章的最后发布文件的最终版本)，现在让我们看看CLI的运行情况:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/c8329304e4a70fb6797f1bdaa6db64ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BPwiCwq4kM7RU41HlXuebg.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">CLI在发挥作用。</figcaption></figure><h1 id="e919" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">可能的改进和练习</h1><ul class=""><li id="d4d3" class="mc md it lf b lg lh lk ll lo me ls mf lw mg ma mh mi mj mk bi translated">请注意，在文件中复制了大量代码——在多个地方做了相同的事情(主要与SQL数据库和数据类之间的转换相关)——您可以做得更好。</li><li id="3d2a" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">错误处理——现在，如果我们在一个不存在的项目中询问任务列表，CLI将会失败，你也可以让它变得更好。</li><li id="5efa" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">输出显示格式不太好，<em class="mb"> typer </em>允许使用颜色，并做一些非常好看的CLI应用程序，如果你对应用程序的视觉方面感兴趣，你可以这样做。</li><li id="1e0c" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">请注意，目前我们是通过<code class="fe ms mt mu mv b">python3 main.py</code>来使用这个应用程序的，这并不太好，因为我们可以创建<code class="fe ms mt mu mv b">setup.py</code>文件并安装包，并且有一个很好的<a class="ae ml" href="https://packaging.python.org/specifications/entry-points/" rel="noopener ugc nofollow" target="_blank">命令入口点</a>，就像<code class="fe ms mt mu mv b">mytasks projects list</code></li><li id="1cc7" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">如果您不喜欢在SQL级别工作——您可以用一些ORM替换当前的<code class="fe ms mt mu mv b">Database</code>类，比如<a class="ae ml" href="https://github.com/coleifer/peewee" rel="noopener ugc nofollow" target="_blank"> pewee </a></li><li id="513f" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">也是最具挑战性的一个——为自己创建一个CLI应用程序，选择一个能为自己带来一些价值的用例。</li><li id="d0ca" class="mc md it lf b lg mm lk mn lo mo ls mp lw mq ma mh mi mj mk bi translated">CLI仍然不支持按状态对任务列表进行过滤——实现起来很有趣。</li></ul><h1 id="3862" class="kf kg it bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">文件</h1><p id="e7e6" class="pw-post-body-paragraph ld le it lf b lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><code class="fe ms mt mu mv b">main.py</code></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="abbe" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated"><code class="fe ms mt mu mv b">database.py</code></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="884d" class="pw-post-body-paragraph ld le it lf b lg nj li lj lk nk lm ln lo nl lq lr ls nm lu lv lw nn ly lz ma im bi translated"><code class="fe ms mt mu mv b">data.py</code></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div></div>    
</body>
</html>