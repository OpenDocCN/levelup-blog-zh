<html>
<head>
<title>Elliptic curves and ECDSA: everything to know to sign a transaction in Bitcoin from scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">椭圆曲线和ECDSA:从头开始用比特币签署交易的所有知识</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/elliptic-curves-and-ecdsa-from-understanding-the-concept-to-signing-a-transaction-in-bitcoin-dd07851fe0a8?source=collection_archive---------5-----------------------#2022-10-06">https://levelup.gitconnected.com/elliptic-curves-and-ecdsa-from-understanding-the-concept-to-signing-a-transaction-in-bitcoin-dd07851fe0a8?source=collection_archive---------5-----------------------#2022-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3e110445bd9e02caece388eccecdf162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TxpvNFysXCiTdPL1vYlOOQ.jpeg"/></div></div></figure><p id="3d72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">椭圆曲线非常简单。在其属性之上工作的椭圆曲线数字签名算法(ECDSA)在大多数区块链中使用，如比特币、以太坊等。，而且更简单。但是在互联网上找到一个好的解释并把所有的部分组合在一起是很有挑战性的。但是在这里！在本文中，我们将。</p><p id="1d14" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将逐一介绍理解和实现该算法所需的所有概念。到本文结束时，我们将从零开始拥有一个功能完整的演示程序<strong class="ka ir"/>，它可以从<strong class="ka ir">私钥</strong>中提取<strong class="ka ir">公钥</strong>，<strong class="ka ir">对</strong>消息进行签名，<strong class="ka ir">验证</strong>签名是否正确。这个实现将<strong class="ka ir">仅</strong>使用本文中描述的概念。此外，它只需要不到100行代码。</p><p id="12d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇文章主要针对像我这样的开发人员，他们希望最终理解ECDSA，但是它对其他人也非常有用。它只需要知道中学数学。</p><p id="5a49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我强烈建议一步一步来。如果你愿意，你可以拿起一张纸和一支笔，重复本文中的所有步骤。那就更好了！如果你不是程序员，你可以忽略一些代码。如果你是，我建议你自己重新写代码，练习！</p><p id="b9f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">文章由6个部分组成；每一部分都使用了前几部分的概念(第2部分除外):</p><ul class=""><li id="770d" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">I:椭圆曲线的本质</li><li id="356b" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">II:有限域的本质</li><li id="0800" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">III:有限域上的椭圆曲线</li><li id="6b7a" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">四:信息技术的实际应用:ECDSA</li><li id="5bd4" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">五.实施</li><li id="ab1c" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">VI:现场演示</li></ul><p id="d2e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从这里开始吧！</p><h1 id="a17c" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">第一部分:椭圆曲线的本质</h1><p id="6809" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">我们可能都很熟悉坐标网格上的那些图，其中<strong class="ka ir"> y </strong>变量以某种方式依赖于<strong class="ka ir"> x </strong>。比如<strong class="ka ir"> y = x </strong>、<strong class="ka ir"> y = x </strong>等等。最有可能的是，我们都有一些这方面的经验。让我们来看看它们:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/8e19dfea645684a679c56c7d747bce4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NI-gHSKBgFwE1NIoDyi10w.png"/></div></div></figure><p id="cc42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">椭圆曲线的方程没有太大的不同！它的形式为<strong class="ka ir"> y = x + a*x + b </strong>。什么是<strong class="ka ir"> a </strong>和<strong class="ka ir"> b </strong>？只是一些任意的常数。我们来看看用<strong class="ka ir"> a = 0 </strong>，<strong class="ka ir"> b = 7 </strong>是什么样子，就像比特币曲线里一样:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/a8bf96df5b119e11f67d6451c22bb691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_wn1fm_xFIt9hPH722NkQ.png"/></div></div></figure><h1 id="c550" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">它有以下三个非常重要的特性，所有的东西都是基于这三个特性工作的:</h1><blockquote class="mt mu mv"><p id="4ac1" class="jy jz mw ka b kb kc kd ke kf kg kh ki mx kk kl km my ko kp kq mz ks kt ku kv ij bi translated">这就是为什么很难理解<a class="ae na" href="https://www.youtube.com/watch?v=6eZQu120A80" rel="noopener ugc nofollow" target="_blank"><em class="iq"/></a><em class="iq">的原因。你甚至会觉得这是一些语无伦次，不着边际的东西。但是请相信我。这些性质将导致我们一个非常惊人的结果！但是现在让我们假装我们只是在没有目的地玩。</em></p></blockquote><ol class=""><li id="10c2" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv nb lc ld le bi translated">椭圆曲线沿着<strong class="ka ir"> x轴对称。意思是对于曲线A上的任意一点，我们可以通过简单的镜像它的y坐标得到它的镜像点，叫做-A:</strong></li></ol><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/eb1a261bd43305a9ecf8fb80a876eea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sfRGteB7QmAgOJOko3ogjQ.png"/></div></div></figure><p id="a821" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.如果我们通过<strong class="ka ir">不在垂直线</strong>上的任意两点画一条线，它将<a class="ae na" href="https://www.youtube.com/watch?v=6eZQu120A80" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">与</strong> </a>曲线恰好在多一点相交！<br/>通过<strong class="ka ir"> A </strong>和<strong class="ka ir"> B </strong>点画一条线，称第三点为<strong class="ka ir"> — C </strong>。那么，我们来反映一下得到要点<strong class="ka ir"> C </strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/6a4c70822744e989e7bececa819618dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7zuoG6SXk6KwdMwUmL3z1A.png"/></div></div></figure><p id="95cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个例子:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/65b2526de402fb09babedeee5351dff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lN8c5M18B67dmWHX5ReG1Q.png"/></div></div></figure><p id="f44f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">这个C点叫做A和B的和，所以A+B = C</strong></p><p id="0635" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.如果我们通过曲线上的任意点<strong class="ka ir">和</strong>画一条<strong class="ka ir">切线</strong> <strong class="ka ir">线</strong>，它将与曲线在<strong class="ka ir">恰好相交一点</strong>。我们将称这个点为<strong class="ka ir">——2A。</strong>我们已经知道如何得到<strong class="ka ir"> 2A </strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/e8b88a8d22e6251418f510c090a90dae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XLG6uVUu_Pk871rorKXCmw.png"/></div></div></figure><p id="cfcf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">思考切线最简单的方法是想象它与一个点相交两次。好像它不是在两点而是在三点与曲线相交:A，A，-2A。</p><h2 id="b92f" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">就是这样！我们在椭圆曲线上定义了三种数学运算:将一个点乘以-1，将两个点相加，以及将一个点加倍。</h2><h2 id="8994" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">这里是椭圆曲线代数开始工作的地方。</h2><p id="6654" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">现在我们有了下图，图中有点<strong class="ka ir"> A </strong>、<strong class="ka ir"> 2A </strong>、<strong class="ka ir"> -2A </strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/ae7eeb6eed53b75738c4d55efbccdcbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDhiFSK-IROq8hiaU6fpbA.png"/></div></div></figure><p id="abe8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们通过<strong class="ka ir"> A </strong>和<strong class="ka ir"> 2A </strong>画一条线。我们将得到的第三个点是<strong class="ka ir"> -3A </strong>。然后只要反映出来就可以得到<strong class="ka ir"> 3A </strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/f5cb9b419d601e82438d98acf249dc8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HTEJm-3s3Rdxw9LipT_cbw.png"/></div></div></figure><p id="6db5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可能还不明白我们为什么要做这一切。再看一步就好了。如果我们试着在<strong class="ka ir"> 3A </strong>和<strong class="ka ir"> -2A </strong>之间画一条线会怎么样？</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/eed7fe6bf55808173eb91ece24a631c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5vA1G9Q50EmN_Cnv3TJF8Q.png"/></div></div></figure><p id="3912" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">你看到魔法了吗？</strong>通过在<strong class="ka ir"> 3A </strong>和<strong class="ka ir"> -2A </strong>之间画一条线，我们得到了<strong class="ka ir"> -A </strong>点，它是我们最初的<strong class="ka ir"> A </strong>点沿x轴的反射！</p><h2 id="b870" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">我们刚刚在上面三个子句中定义的是椭圆曲线代数。</h2><p id="c239" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">试着理解这三种运算的威力:本质上，现在我们可以对曲线上的点进行运算，就好像它们不是点，而是数字一样！</p><p id="3664" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们<strong class="ka ir">能用曲线上的点做什么:</strong></p><ul class=""><li id="b3bf" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">加两分<strong class="ka ir"> (A + B) </strong></li><li id="8335" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">两点相减<strong class="ka ir"> A — B </strong> = <strong class="ka ir"> (A + (-B)) </strong></li><li id="5446" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">一个点的加倍(乘以二)<strong class="ka ir"> 2*A </strong></li><li id="404a" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><strong class="ka ir">乘以任意整数(将前面的运算组合在一起，可以得到任意整数*点)</strong></li></ul><p id="dcad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们<strong class="ka ir">不能</strong>做的事情:</p><ul class=""><li id="b7a3" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">两点的乘法</li><li id="59d7" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">一点除以另一点</li><li id="de17" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><strong class="ka ir">点除以标量值</strong></li></ul><p id="527a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">比如得到<strong class="ka ir">10A</strong>:<br/>T21】2A = A+A<br/>4A = 2A+2A<br/>8A = 4A+4A<br/>10A = 8A+2A</p><p id="2ba5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">值得注意的是，计算可能需要对数数量的运算。所以计算<strong class="ka ir">n *点</strong>所需的大概运算量是<strong class="ka ir"> O(log2(n)) </strong>！</p><h2 id="577c" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">最终我们可以把一个点乘以任意一个整数，但是没有办法把整数取回来！这是它的要旨！这就是椭圆曲线非常适合密码学的原因。它适用于无限大的数字。</h2><h2 id="6853" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">目前唯一的缺点是需要画出来。但是当然，有一些数学公式可以用来反映一个点，用于加法，以及用于将一个点加倍:</h2><ol class=""><li id="aef1" class="kw kx iq ka b kb mi kf mj kj nv kn nw kr nx kv nb lc ld le bi translated"><strong class="ka ir">将一个点乘以-1 </strong>。如果我们有一个点<strong class="ka ir"> A(x，y)，</strong>我们可以很容易地通过把它的<strong class="ka ir"> y </strong>坐标乘以<strong class="ka ir"> -1得到<br/> - <strong class="ka ir"> A </strong>。</strong> -A(x，-y)。<strong class="ka ir">举例:<br/> -1 * A(2，2) → -A(2，-2) <br/> -1 * A(1，-1) → -A(1，1) <br/> -1 * A(5，8) → -A(5，-8) <br/> -1 * A(5，-8) → -A(5，8) </strong></li></ol><p id="b050" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 2。把两点加在一起。</strong>我们可以把两个点加在一起，但有一个条件:它们不应该位于一条垂直线上(它们的x坐标不应该相等)。这是<strong class="ka ir"> A </strong>和<strong class="ka ir"> B (A + B = C) </strong>相加的公式:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/5d6dd6e9e3fa9ef475f876d6d93b177a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CYGT_nR9hhdbBcXanWLhaQ.png"/></div></div></figure><p id="1ed4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 3。自身加一个点</strong>(一个点乘以2)。这与添加两个点的操作非常相似，但略有不同:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/073015865d034ee5c46b1ac491c6f160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BJS2Y6KdqHCuBvpgkwzIDg.png"/></div></div></figure><h2 id="8d92" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">就是这样！该练习了！</h2><p id="bc12" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">让我们尝试在这里添加A和B(让我们在逗号后使用3点的近似值):</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/38599b930c5fa9c76920fd72d515668e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q1z_yt2lmP8I-TIHKT6l3A.png"/></div></div></figure><p id="9ef3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据上面定义的用于添加两个点的公式，</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/cc26b0d4d23d05f5fa01e3427ea2aedd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N7r_9nkrPzdqX16oqmcT1g.png"/></div></div></figure><p id="4b1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们用图解法找到我们的点:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/4e89b5fb52b9c1faa44defdd653868b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1gTeffSaN_YO095Fr-eYw.png"/></div></div></figure><p id="8c63" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">管用！</strong>是的，有一个小的邻近问题，因为四舍五入。但是很管用！<br/>为了更好地理解，我建议您尝试自己执行所有这些操作。</p><h2 id="1048" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">这就是我们需要知道的关于椭圆曲线和我们需要能够在其上执行的操作的全部内容！</h2><p id="d273" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">一切都很好，但是我们还需要几个属性来构建一个加密系统。</p><h1 id="fd25" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">第二部分:有限域</h1><p id="1459" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">我们不需要研究关于<a class="ae na" href="http://web.stanford.edu/~marykw/classes/CS250_W19/readings/Forney_Introduction_to_Finite_Fields.pdf" rel="noopener ugc nofollow" target="_blank">有限域</a>的一切。这里我们所需要的是理解几个基本的性质来继续前进，并且能够在有限域的某个“代数”上操作。</p><p id="1f37" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">听说过<strong class="ka ir">模数</strong>运算吗？如果你是一名程序员，你可能会这样做。这只是对除法的<strong class="ka ir">提醒，在编程语言中，通常表示为<strong class="ka ir"> % </strong>(或<strong class="ka ir"> mod </strong>)运算符。例如:</strong></p><p id="1f7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">2 mod 11 = 2<br/>10 mod 11 = 10<br/>11 mod 11 = 0<br/>13 mod 11 = 2<br/>14 mod 11 = 3</strong></p><p id="684d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们尝试从<strong class="ka ir"> 0 </strong>到<strong class="ka ir"> 33 mod 11 </strong>的数字，我们会得到这些数字:<br/>0，1，2，3，4，5，6，7，8，9，10，0，1，2，3，4，5，6，7，8，9，10，0 </p><p id="59df" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它像时钟一样工作。<code class="fe od oe of og b">We can call it a finite field of order 11</code>。</p><h2 id="9c6d" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">我们只需要知道四个属性:</h2><ol class=""><li id="ad50" class="kw kx iq ka b kb mi kf mj kj nv kn nw kr nx kv nb lc ld le bi translated">乘法的顺序并不重要。<br/><strong class="ka ir">a *<em class="mw">b *</em>c</strong>mod n<strong class="ka ir">与</strong>(<strong class="ka ir">a</strong>mod n)*(<strong class="ka ir">b</strong>mod n)*(<strong class="ka ir">c</strong>mod n)<strong class="ka ir">与</strong>(<strong class="ka ir">a * b</strong>mod n)*<strong class="ka ir">c</strong>mod n .<br/>相同 <br/>同:(<strong class="ka ir">6 * 7</strong>mod 11)*<strong class="ka ir">8</strong>mod 11 =(<strong class="ka ir">42</strong>mod 11)*<strong class="ka ir">9</strong>mod 11 =<strong class="ka ir">9 * 8</strong>mod 11 =<strong class="ka ir">72</strong>mod 11 =<strong class="ka ir">6</strong></li><li id="92df" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv nb lc ld le bi translated"><strong class="ka ir">负数</strong> <strong class="ka ir"> mod n是与n-(|负数| mod n </strong>)相同的 <strong class="ka ir">。示例:<br/>1)<strong class="ka ir">-4 mod 11</strong>= 11-(4 mod 11)=<strong class="ka ir">11–4 = 7<br/>2)-7 mod 11</strong>= 11—(7 mod 11)=<strong class="ka ir">11–7 = 4<br/></strong>3)<strong class="ka ir">-9 mod 11</strong>= 11—(9 mod 11)=<strong class="ka ir">11–9 = 2</strong><br/>4)【T20</strong></li><li id="b837" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv nb lc ld le bi translated"><strong class="ka ir"/><a class="ae na" href="https://en.wikipedia.org/wiki/Multiplicative_inverse" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">乘法逆</strong> </a> <strong class="ka ir">】:对于任意一个a，都有一个数b，如a*b mod n = 1。<br/>若a * b mod 11 = 1，</strong> <strong class="ka ir"> a </strong>称为b  <strong class="ka ir">模</strong> <strong class="ka ir"> n </strong>的<strong class="ka ir">乘逆，反之亦然</strong> : <strong class="ka ir"> b </strong>称为<strong class="ka ir"> a </strong>模n的乘逆<br/>例子:<br/> 1) <strong class="ka ir"> 5 * x mod 11 </strong> = 1。让我们逐个尝试x的值，我们会发现<strong class="ka ir"> x = 9，</strong>因为5 * 9 = 45，45 mod 11 = 1。所以<strong class="ka ir"> 9 </strong>是5模11 的<strong class="ka ir">乘法逆。<br/> 2) <strong class="ka ir"> 7 * x mod 11 = 1 </strong>。再来试试我们的蛮力，就知道了<strong class="ka ir"> x = 8 </strong>。8是7模11的乘法倒数。<br/> 3) <strong class="ka ir"> 10 * x mod 11 = 1。x = 10。</strong>所以10是10模11的乘法逆。</strong></li></ol><p id="0054" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通常，乘法逆运算是通过<a class="ae na" href="https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm" rel="noopener ugc nofollow" target="_blank">扩展欧几里德算法</a>找到的，但这是另一篇文章的问题。所以，现在，我们就用蛮力吧。还有，<strong class="ka ir"> n </strong>一定是质数！</p><p id="d223" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.<strong class="ka ir">除法运算与乘法逆运算的乘法运算相同！</strong>最后也是最重要的属性:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/6158909a42f1d2e325c01264ffc03b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RL7gDpIUjrGUgWm8vYr6aA.png"/></div></div></figure><p id="1582" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，当我们需要处理除法mod n时，我们可以很容易地计算出来。<br/>我们来看一个例子:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/e04dc5c3738d54c8397051027fa0b351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4Cq2HKrikLMhwAcSfY17w.png"/></div></div></figure><p id="142f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">就是这样！现在我们知道如何在有限域上操作“代数”。</strong></p><h1 id="f8c0" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">第三部分:有限域上的椭圆曲线</h1><p id="3abf" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">在这里，它变得不那么明显，有点难以理解。但是这正是椭圆曲线在密码学中的应用。我们要做的正是题目中所说的:把我们的椭圆曲线放在有限域上。</p><p id="a794" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，我们的公式是这样变化的:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/ad810159cc74045b1fbb93ec067f5f60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BH9QyMg7VVJwGuF5eih63Q.png"/></div></div></figure><p id="740d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一切都和原来的公式一样，但是现在等式的两部分都在<strong class="ka ir">模p </strong>下。</p><p id="b859" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于我们的示例，让我们使用具有以下配置的椭圆曲线:</p><ul class=""><li id="dae2" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">a = 0</li><li id="6e13" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">b = 7</li><li id="4d60" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">p = 11</li></ul><p id="d43a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们找出运行这段代码的曲线上的所有点:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="fdf2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它是<strong class="ka ir"> javascript </strong>，所以你甚至可以在浏览器中运行它。</p><p id="4847" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是结果:<br/> <strong class="ka ir"> (2，2)，(2，9)，(3，1)，(3，10)，(4，4)，(4，7)，(5，0)，(5，11)，(6，5)，(6，6)，(7，3)，(7，8) </strong></p><p id="0677" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看看它在坐标网格上的样子:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/c8f246418d0f9277fc28c82d8fdcc3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzDlzO6E9-vFgu1jxpiomw.png"/></div></div></figure><p id="a803" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们试试a=0，b=7，p=23:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/166d3d52946308190c0c1c846c190d26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tBVIsKdKIJmvxMBn9A20RQ.png"/></div></div></figure><p id="8389" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">什么都不像是吧？没有明显的形状。</strong></p><h2 id="c20d" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">但是！结果是，它保留了“原始”椭圆曲线的所有性质和公式！</h2><p id="3cde" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">所以现在我们有了一条椭圆曲线，它看起来不像椭圆曲线。但是！它有一个有限的点集，最重要的是，<strong class="ka ir">像椭圆曲线</strong>一样工作。</p><h2 id="bed7" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">我们需要稍微修改一下第一部分中关于mod p的公式:</h2><ol class=""><li id="5fd3" class="kw kx iq ka b kb mi kf mj kj nv kn nw kr nx kv nb lc ld le bi translated"><strong class="ka ir">将一个点乘以-1 </strong> : <br/>如果我们有一个点<strong class="ka ir"> A(x，y)，</strong>我们可以很容易地通过将它的<strong class="ka ir"> y </strong>坐标乘以<strong class="ka ir"> -1模p </strong>得到<strong class="ka ir"> -A </strong>。<br/> <strong class="ka ir">举例:<br/> </strong> 1) <strong class="ka ir"> -1 * A(2，2) → -A(2，-2 mod 11) = -A(2，9) <br/> </strong> 2) <strong class="ka ir"> -1 * A(2，9) → -A(2，-9 mod 11) = -A(2，2) <br/> </strong> 3) <strong class="ka ir"> -1 * A(6，5) → -A(6，-5 mod 11) = -A(6</strong></li><li id="c54a" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv nb lc ld le bi translated"><strong class="ka ir">两点相加</strong>:</li></ol><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/6a06083df886a0ab3d41cb7026b2698b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*noK4AT9wQMNYxmTuJ5XFuQ.png"/></div></div></figure><p id="7171" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> 3。为自己加分</strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi op"><img src="../Images/470136bca287cb4d919f5973ca3d1b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Plf7i_AP4vu6UuLoxsH7gw.png"/></div></div></figure><p id="61e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你还不明白乘法逆运算的概念，请回到第二部分再检查一遍。</p><h2 id="5995" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">就是这样！该练习了！</h2><p id="06f9" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">对于我们的例子，我们将使用椭圆曲线，其中<strong class="ka ir"> a=0，b=7，阶数p=11 </strong>。<br/>让我们挑选一个点<strong class="ka ir"> C(7，8) </strong>并计算<strong class="ka ir"> 2C </strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oq"><img src="../Images/6ee965c4108a7193b569dfa245d128a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Y-x-89ztsYlNu62dbI4xQ.png"/></div></div></figure><p id="7792" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在可以很容易地计算4C:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/838f665a649eaffa8d920dac956a7c31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1zHBw4WWpqrzOjRr-11SQ.png"/></div></div></figure><p id="8af1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们来计算一下<strong class="ka ir"> 4C — C </strong>，本质上就是<strong class="ka ir"> 3C = 4C + (-C) </strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi os"><img src="../Images/f8006a65202c37c73a5edb39d95189d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IEyeed4bgnTO-pTr8-HgrA.png"/></div></div></figure><p id="b7fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那我们再加上<strong class="ka ir"> 3C = C + 2C </strong>看看结果是不是一样:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ot"><img src="../Images/5d131b8c99f45cc0a3130eb0f2d76aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bHcgjtumMYIWPcE0Ne--hg.png"/></div></div></figure><h2 id="dc61" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">数学在这里完美地工作！</h2><p id="51d6" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated"><strong class="ka ir">一个超级重要的性质</strong>:曲线上的每一点都有自己的<strong class="ka ir">阶n </strong>！它像模一样工作。例如，如果点<strong class="ka ir"> C </strong>的<strong class="ka ir">顺序n </strong>为<strong class="ka ir"> 12 </strong>，则表示<strong class="ka ir"> 12C <em class="mw"> = 0 </em> </strong> <em class="mw">(该点不存在)，</em> <strong class="ka ir"> 13 <em class="mw"> * </em> C = C </strong>，<strong class="ka ir"> 16*C = 4C </strong>，<strong class="ka ir"> 27*C = 3C </strong>。这个属性是<strong class="ka ir">为一个点预定义的</strong>。</p><p id="9d76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以练习一下，确保有效。</p><p id="ef15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">我们C点的顺序其实是12。</strong>我给你建议一个任务:试试把<strong class="ka ir"> 4C + 4C </strong>相加算出<strong class="ka ir"> 8C </strong>。然后试着加上<strong class="ka ir"> 8C + 8C </strong>。你会得到<strong class="ka ir"> 16C </strong>，和<strong class="ka ir"> 4C </strong>是同一个点。</p><p id="4ab7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它像时钟一样工作:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ou"><img src="../Images/15656cdbdb46c233d04f6465df54e8d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d6NqpF0Nzh7r-063ouzIow.png"/></div></div></figure><p id="5dcc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们知道了在密码学中使用椭圆曲线的所有基本知识。</p><h1 id="7dde" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">概括一下</h1><ul class=""><li id="dcb5" class="kw kx iq ka b kb mi kf mj kj nv kn nw kr nx kv lb lc ld le bi translated">所有公式都工作正常。我们还是可以计算<strong class="ka ir">任意整数x *点</strong>。我们仍然需要大约log2(x)次运算！</li><li id="c1a6" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">椭圆曲线现在有一个有限的点集。</li><li id="24bf" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">点现在有了自己的<strong class="ka ir">顺序，所以它们会像时钟一样重复出现。</strong></li><li id="91f5" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">为了定义一条椭圆曲线，我们现在需要三个变量:<strong class="ka ir"> a </strong>、<strong class="ka ir"> b </strong>和<strong class="ka ir"> p </strong>。<strong class="ka ir"> p </strong>称为椭圆曲线的阶。</li></ul><p id="0cdb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们如何知道使用哪一个<strong class="ka ir"> a </strong>、<strong class="ka ir"> b </strong>和<strong class="ka ir"> p </strong>？这是标准化的！有许多标准。</p><h2 id="0972" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">比特币和以太坊用什么？</h2><p id="d4ae" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">他们使用的<strong class="ka ir">标准化椭圆曲线</strong>称为<strong class="ka ir"> secp256k1 </strong>。它有以下变量:</p><ul class=""><li id="93a4" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">a= <strong class="ka ir"> 0 </strong></li><li id="511b" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">b= <strong class="ka ir"> 7 </strong></li><li id="e482" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">11579208923731619542357098500868790785326998465640564039457584007908834671663</li></ul><p id="a1c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">相当大的一个数字！我想你已经开始猜测为什么椭圆曲线对密码学如此有用了。</p><p id="3e3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们知道了所有重要的东西，让我们把它应用到某个地方吧！</p><h1 id="0bd6" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">第四部分:信息技术的实际应用</h1><p id="979f" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated"><a class="ae na" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">椭圆曲线数字签名算法</strong> </a>完全适用于我们刚刚在前面部分中发现的代数。</p><p id="e240" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种算法允许一个人使用他们的<strong class="ka ir">私钥</strong>对一条<strong class="ka ir">消息</strong>进行<strong class="ka ir">签名，这样任何其他人都可以<strong class="ka ir">验证</strong>这个<strong class="ka ir">签名</strong>实际上<strong class="ka ir">属于那个人</strong>，并且知道他们的<strong class="ka ir">公钥</strong>。</strong></p><h2 id="cf8c" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">在区块链，当你签署一条信息时，这就是实际发生的事情:</h2><p id="50d9" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">您只需生成一些<strong class="ka ir">消息</strong>，如“<strong class="ka ir">我想发送X数量的加密到地址Y </strong>”，然后您<strong class="ka ir">签署</strong>该消息(完全使用本文中发现的算法)。其他方可以<strong class="ka ir">向</strong>核实<strong class="ka ir">消息</strong>实际上是由你<strong class="ka ir">签署的</strong>。</p><h2 id="834a" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">它是如何工作的</h2><p id="9e1d" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">一切都围绕着一个确定的<strong class="ka ir">预定义的</strong> <strong class="ka ir">点</strong> <strong class="ka ir"> G </strong>，躺在一条<strong class="ka ir">预定义的</strong> <strong class="ka ir">椭圆曲线</strong>上。</p><p id="6914" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以生成任意一个<strong class="ka ir">随机整数</strong>，并将其称为我们的<strong class="ka ir"> PrivateKey。如果我们将这个私钥乘以g点，我们将得到公钥。所以PublicKey = PrivateKey * G: </strong></p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ov"><img src="../Images/c0ae559da1723676beb6b1691edf1940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXOMtehsgKse5jIAOleF7g.png"/></div></div></figure><p id="9c12" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，<strong class="ka ir"> PublicKey </strong>只是曲线上的一点。</p><p id="3d99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经知道，我们不能用一个标量值来逐点或逐点划分。所有可能的操作都列在第一部分的末尾。</p><p id="8d64" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，没有<strong class="ka ir"/><strong class="ka ir">有效的方法</strong>从<strong class="ka ir">公钥</strong>中提取<strong class="ka ir">私钥</strong>，即使我们知道点<strong class="ka ir"> G </strong>。</p><p id="244a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们不能用<strong class="ka ir"> PublicKey </strong>除以<strong class="ka ir"> G </strong>。此<strong class="ka ir">操作不存在</strong>。蛮力可能会起作用，但是当真的有大量可能的点时，例如，那个巨人:<br/>11579208923731619542357098500868790782837564279074904382605163141518161494337</p><h2 id="c211" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">即使有人使用了世界上所有现有的计算能力，也要花费数十亿数十亿…数年才能找到私钥。</h2><p id="a1e2" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">在ECDSA中，我们有这组“全局”公共变量。<strong class="ka ir">它们由标准</strong>规定:</p><ul class=""><li id="958d" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">带有某些配置的椭圆曲线(<strong class="ka ir"> a </strong>、<strong class="ka ir"> b </strong>、<strong class="ka ir"> p </strong>)</li><li id="4748" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">位于曲线上的点<strong class="ka ir"> G </strong>(其<strong class="ka ir"> x </strong>和<strong class="ka ir"> y </strong>坐标)。这被称为<strong class="ka ir">发电机点</strong>。这一点是标准化的。</li><li id="d657" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">点<strong class="ka ir"> G </strong>的顺序<strong class="ka ir"> n </strong>。我们知道，阶<strong class="ka ir"> n </strong>是点<strong class="ka ir"> G </strong>的性质，比如<strong class="ka ir"> </strong>为G*(n+1) = G，G*(n+2) = 2G，等等。</li></ul><p id="bc0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是属于某个所有者的变量:</p><ul class=""><li id="f393" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated"><strong class="ka ir">私钥</strong> —由所有者保密</li><li id="8295" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><strong class="ka ir">公钥</strong> —与公众共享</li></ul><p id="d8ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以及特定于一个<strong class="ka ir">签名</strong>操作的变量:</p><ul class=""><li id="2bd7" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated"><strong class="ka ir">消息</strong>本身:任何不大于顺序<strong class="ka ir"> n </strong>的整数。<strong class="ka ir">通常是</strong>，一个<strong class="ka ir">散列</strong>的字符串被使用。但是为了简单起见，我们将使用纯整数。</li><li id="c119" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><strong class="ka ir"> K </strong> —签名消息时生成的随机整数，完全针对该签名。这个是保密的，没有办法被第三方发现。</li></ul><p id="1f92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里是完整的图片。绿色贴纸表示变量与公众共享，红色贴纸表示变量保密:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ow"><img src="../Images/df65e2aaf6c829c5f021c5e31430b68c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RhDwxGNRVx-iIk4fpWVpJg.png"/></div></div></figure><p id="7bf6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">太多变数了！以下是<strong class="ka ir">签名</strong>和<strong class="ka ir">验证</strong>消息的算法:</p><h2 id="aa1c" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">签署消息的算法:</h2><p id="e54f" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">我们有自己的<strong class="ka ir">私钥</strong>和<strong class="ka ir">消息</strong>。要签署邮件，我们应该:</p><ol class=""><li id="3f00" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv nb lc ld le bi translated">生成一个随机整数<strong class="ka ir"> k </strong>。应该是个不小的数字。[1，<strong class="ka ir"> n </strong> -1]</li><li id="9d95" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv nb lc ld le bi translated">计算点<strong class="ka ir"> R = G * k </strong></li><li id="099b" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv nb lc ld le bi translated">计算<strong class="ka ir"> r </strong>:</li></ol><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ox"><img src="../Images/8b2617bea64871ae269f396d838be36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z2OtwoM_feK_s3wuKLU2Ew.png"/></div></div></figure><p id="0dba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.计算<strong class="ka ir"> s: </strong></p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oy"><img src="../Images/64d830ea521bac9d3b0ef694eac7b8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oqrInkIokOoYlSJyHT2VSw.png"/></div></div></figure><p id="c469" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就是这样。<strong class="ka ir">签名是一对整数(r，s)。</strong></p><p id="cb69" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是该算法的可视化表示:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oz"><img src="../Images/4ec5c8cd65c0282f2fa5177af747c80c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYVxNyCrnxr2ENxC2fakVg.png"/></div></div></figure><h2 id="3337" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">验证签名的算法</h2><p id="a270" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">我们有签名者的<strong class="ka ir">公钥</strong>、<strong class="ka ir">消息</strong>和<strong class="ka ir">签名(r，s)。</strong></p><ol class=""><li id="aff8" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv nb lc ld le bi translated">计算<strong class="ka ir"> U </strong>:</li></ol><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pa"><img src="../Images/43a94ca693514a35b3249b427273856e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7vlUBv-5zW4zAz-BPAz45Q.png"/></div></div></figure><p id="b508" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.计算<strong class="ka ir"> V </strong>:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pb"><img src="../Images/2eff7ce61ace498d8a340dd0b1c7c220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sXG2k7GVVgiEIoF-GdgcRA.png"/></div></div></figure><p id="229b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.计算点<strong class="ka ir">C</strong>=<strong class="ka ir">U</strong>*<strong class="ka ir">G</strong>+<strong class="ka ir">V</strong>*<strong class="ka ir">public key</strong></p><p id="85d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.如果<strong class="ka ir"> C </strong>。x mod <strong class="ka ir"> n </strong> = <strong class="ka ir"> r </strong>，则签名有效。否则无效。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pc"><img src="../Images/9b52eaa131cbca03c28eaaf3c89f0fc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nab_efeYgowJJs8dLKKJkA.png"/></div></div></figure><p id="756d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一点都不明显！</p><p id="9178" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其实这只是一个数学上的小把戏。</p><h2 id="a2fc" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">让我们来玩我们的公式，并证明它是可行的！</h2><p id="e769" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">在我们的<strong class="ka ir">验证</strong>算法的步骤3中，我们有一个点<br/><strong class="ka ir">C = U * G+V * public key:</strong></p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pd"><img src="../Images/15f9b1bdf8180a0dfa0115c415754dce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9bPvPox_h76FYTdZ7m8IRg.png"/></div></div></figure><p id="c513" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们用变量<strong class="ka ir"> U、V和PublicKey </strong>的定义来代替它们:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pe"><img src="../Images/fd288ed25c27ca2b73355045fdc1dc11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Fq9u-KIoezPBAtjkTxK7w.png"/></div></div></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pf"><img src="../Images/c88058d4555b21c5bc5032591b24c476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JiJYdQrbZFV5WlCgurinuw.png"/></div></div></figure><p id="c2e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，G * s^-1是重复的。让我们简化公式:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pg"><img src="../Images/91f2d4d4bc0b716b18a3dc1d95753ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sRDlE9lqD44nRnIn1Xo_WQ.png"/></div></div></figure><p id="6fe0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们来看看<strong class="ka ir">签名</strong>算法的步骤<strong class="ka ir"> 4 </strong>中<strong class="ka ir"> s </strong>的定义:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ph"><img src="../Images/e5f605509fb37808ae3ca425ef72f808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pNBtA7jIHwD4405fDMB1KQ.png"/></div></div></figure><p id="05ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们在公式中替换s^-1:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pi"><img src="../Images/467c4f7a056e27fd3feecf10dd2f0085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvV-SyyGOuU313BVe2j5Ig.png"/></div></div></figure><p id="1f84" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们简化这一部分:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pj"><img src="../Images/9d70736177c333586c2d4974506674bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ES4pNa9rvYPPgHIFysNgXw.png"/></div></div></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pk"><img src="../Images/046d39e8787a4db41b7a5a49434258df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFyv4SDLI7dpte7EiEo9jw.png"/></div></div></figure><p id="3838" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，如果签名是正确的，则<strong class="ka ir"> C mod n </strong>的<strong class="ka ir"> x </strong>坐标等于<strong class="ka ir"> r </strong>(根据其定义，其与<strong class="ka ir"> G * k </strong>的<strong class="ka ir"> x </strong>坐标相同)。</p><h1 id="748c" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">Secp256k1标准化变量:</h1><p id="9c53" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">对于椭圆曲线:</p><ul class=""><li id="2d30" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">a=0</li><li id="a5b4" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">b=7</li><li id="dd07" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">p= <code class="fe od oe of og b">115792089237316195423570985008687907853269984665640564039457584007908834671663</code></li></ul><p id="6403" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于g点:</p><ul class=""><li id="6286" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">x坐标= <code class="fe od oe of og b">55066263022277343669578718895168534326250603453777594175500187360389116729240</code></li><li id="c345" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">y坐标= <code class="fe od oe of og b">32670510020758816978083085130507043184471273380659243275938904335757337482424</code></li><li id="630c" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">订单编号= <code class="fe od oe of og b">115792089237316195423570985008687907852837564279074904382605163141518161494337</code></li></ul><h2 id="62f6" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">搞定了。现在我们完全知道了所有重要的事情！</h2><p id="9daf" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">下一部分对程序员来说将是最容易的部分。对于其他人来说，没必要跟随。只需进行现场演示。</p><h1 id="7b40" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">第五部分:实施</h1><blockquote class="mt mu mv"><p id="0701" class="jy jz mw ka b kb kc kd ke kf kg kh ki mx kk kl km my ko kp kq mz ks kt ku kv ij bi translated">这一部分是为程序员准备的。</p></blockquote><p id="e262" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">瓶颈是:</p><ul class=""><li id="17b6" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">我们需要能够对非常大的数字进行基本的算术运算。在编程中，我们可以使用<a class="ae na" href="https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic" rel="noopener ugc nofollow" target="_blank"> bignum算法</a>轻松操作大数。所以我们的编程语言必须支持它，或者我们应该使用一些外部包来处理它。在这部分的例子中，我将使用<strong class="ka ir"> Python </strong>，其中<strong class="ka ir">支持开箱即用的bignum算法</strong>。对于现场演示(下一部分)，我将使用JavaScript，在那里我们将需要<a class="ae na" href="https://www.npmjs.com/package/bignumber.js" rel="noopener ugc nofollow" target="_blank">bignome . js包</a>。</li><li id="9274" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">我们将遇到的另一个瓶颈是<strong class="ka ir">寻找一个大数的乘法逆运算</strong>。<br/>显然，蛮力是不行的。乘法逆可以用<a class="ae na" href="https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">扩展欧几里德算法</strong> </a> <strong class="ka ir">求，复杂度为O(log(n)) </strong>。</li></ul><p id="f26b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Python (3.8+)可以通过其内置的<strong class="ka ir"> pow </strong>函数找到开箱即用的乘法逆运算:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="b346" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如果需要扩展欧几里德算法的实际实现，可以查看我现场演示的代码！</strong></p><h2 id="1de1" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">让我们开始写代码吧！</h2><p id="67a2" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">我们需要一个与椭圆曲线相关的简单东西:<strong class="ka ir">点</strong>。让我们定义一个类<strong class="ka ir">点</strong>。在其构造函数中，我们应该检查该点是否位于曲线上:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="c91c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要能够<strong class="ka ir">比较两个点</strong>、<strong class="ka ir">将它们加在一起</strong>，然后<strong class="ka ir">将它们乘以一个整数。</strong></p><p id="b438" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们添加一个方法来检查两个点是否相等:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="0e07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们实现<strong class="ka ir"> add </strong>方法，它返回一个新的点作为加法的结果:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="739a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第三部分列出了所有公式。</p><p id="3889" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们实现<strong class="ka ir">乘</strong>方法。<br/>最简单的实现是这样的:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="8471" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是假设我们需要把我们的观点乘以一个大数字:115792089237316195。即使我们有每秒10亿次加法运算的速度，这也需要<strong class="ka ir"> 3.6年来计算这个点</strong>！</p><p id="f24b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">这对我们来说甚至不是一个大数字！</strong>这里有一个大数字:<br/>115792089237316195423570985008687907852837564279074904382605163141518161494337</p><p id="1102" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以这种方式计算这一点将花费数十亿数十亿…数十亿年的时间！</p><p id="1f36" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以定义上述算法的效率为O(n)，这对我们的目的没有任何用处。如果你还记得的话，有一个简单的方法可以通过不断地将我们的观点翻倍来实现复杂度:</p><p id="6d35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2P = P+P<br/>4P = 2P+2P<br/>8P = 4P+4P<br/>16P = 8P+8P<br/>32P = 16P+16P<br/>64P = 32P+32P</p><p id="7423" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">和<strong class="ka ir">log2(115792089237316195)=</strong><strong class="ka ir">56</strong></p><p id="8b18" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">log2(115792089237316195423570985008687907852837564279074904382605163141518161494337)</strong>=<strong class="ka ir">256</strong></p><p id="3de2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我们不需要几十亿几十亿……几年。<strong class="ka ir">我们只需要256次运算就可以到达这个大点</strong>！</p><p id="87b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">稍等一下</strong>:为了有效地乘以不是2次的值，合理的做法是存储所有以前的值，然后将结果组合在一起。</p><p id="5450" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，如果我们需要获得100P，我们就不能再加倍64P。我们也不能一个点一个点的增加:潜在的，这将花费数十亿数十亿年在更大的数字上。合理的做法反而是:<br/>96P = 64P+32P<br/>100P = 96P+4P</p><p id="dae4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，为了这个目的，我们需要存储所有以前的P，然后有效地使用它们。</p><p id="5327" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个有效的实现:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="fcea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们得到了一个超级高效的实现！现在，我们可以在椭圆曲线上执行所有需要的操作。</p><p id="b2c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们定义一下secp256k1:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="7bfa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在我们的例子中只使用十进制数字，因为它们对人们来说很直观。</p><h2 id="922e" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">到目前为止，我们已经实现了在第四部分之前讨论的所有内容。现在让我们实现第四部分中描述的实际数字签名算法。</h2><p id="7f58" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">ECDSA的签名方法:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="a57c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ECDSA的验证方法:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="df94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们选择一些数字作为我们的私钥，例如，<strong class="ka ir"> 123456789012345 </strong>。<br/>让我们的消息成为<strong class="ka ir"> 12345 </strong>。<br/>你还记得如何从<strong class="ka ir">私钥</strong>中获取<strong class="ka ir">公钥</strong>吗？</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="4afb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们签字并试着确认:</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="0977" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有用！您可以尝试破坏签名或原始消息，并确保我们的算法正常工作。</p><h2 id="d452" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">以下是完整的代码:</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="9406" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">所以整个ECDSA算法的实现只用了100行代码！它运行得非常好。这和比特币用的算法绝对一样！</h2><h1 id="8791" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">第六部分:现场演示</h1><p id="d282" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">正如我在本文开始时所承诺的，这里是仅使用了文章中描述的概念和公式的现场演示。只有几个提示:</p><ul class=""><li id="b60e" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">最初，我们只能对整数消息进行签名。但是在演示中，你可以<strong class="ka ir">选择</strong>对你的消息应用一个<strong class="ka ir">哈希</strong>函数(<a class="ae na" href="https://en.wikipedia.org/wiki/SHA-2" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> sha256 </strong> </a>)。多亏了它，消息可以是字符串。</li><li id="2cdb" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">比特币使用的<a class="ae na" href="https://river.com/learn/terms/s/sec-format/" rel="noopener ugc nofollow" target="_blank">公钥</a>和<a class="ae na" href="https://river.com/learn/terms/d/der/" rel="noopener ugc nofollow" target="_blank">签名</a>的格式略有不同。</li><li id="70f2" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">不要在生产环境中使用它的任何部分！<strong class="ka ir">不安全</strong>。对于生产，您必须<strong class="ka ir">仅</strong>使用<a class="ae na" href="https://www.openssl.org/" rel="noopener ugc nofollow" target="_blank">久经考验的解决方案</a>。</li></ul><h2 id="51dd" class="ng ll iq bd lm nh ni dn lq nj nk dp lu kj nl nm ly kn nn no mc kr np nq mg nr bi translated">这是演示:</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="pl ol l"/></div></figure><p id="062b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望这篇文章对你很有用。至少，我尽力让它有用。请随意与朋友分享或在任何地方使用它的任何部分。请留下原文链接。</p><p id="8a6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">随时联系我，提出问题！</p><p id="dd71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae na" href="https://t.me/exemak" rel="noopener ugc nofollow" target="_blank">https://t.me/exemak</a><a class="ae na" href="mailto:exemak@gmail.com" rel="noopener ugc nofollow" target="_blank"><br/>exemak@gmail.com</a><br/>卡拉瓦耶夫</p></div></div>    
</body>
</html>