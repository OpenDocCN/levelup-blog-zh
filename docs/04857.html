<html>
<head>
<title>The Easiest Docker &amp; Docker-compose Setup on Compute Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算引擎上最简单的Docker &amp; Docker-compose设置</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-easiest-docker-docker-compose-setup-on-compute-engine-ec171c09a29a?source=collection_archive---------4-----------------------#2020-07-20">https://levelup.gitconnected.com/the-easiest-docker-docker-compose-setup-on-compute-engine-ec171c09a29a?source=collection_archive---------4-----------------------#2020-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0276" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">2020年如何在计算引擎上轻松安装Docker &amp; docker-compose</h2></div><h1 id="6c4d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">作者说明</h1><p id="b76e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">问候读者，</p><p id="0fed" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">本文是“<strong class="lc iu"> <em class="mb">我与创业公司一起成长”</em></strong>系列的一部分，该系列由各种软件开发的<em class="mb">技术教程、新闻和技巧</em>组成。以下是该系列中排名前五的帖子，你可以在这里阅读更多<a class="ae mc" href="https://medium.com/@calvinqc" rel="noopener"/>:</p><ol class=""><li id="5e3e" class="md me it lc b ld lw lg lx lj mf ln mg lr mh lv mi mj mk ml bi translated"><a class="ae mc" href="https://medium.com/swlh/webrtc-the-technology-that-powers-google-meet-hangout-facebook-messenger-and-discord-cb926973d786" rel="noopener">WebRTC——支持Google Meet、Facebook Messenger的技术</a></li><li id="51d7" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><a class="ae mc" href="https://medium.com/swlh/i-built-a-m-e-r-n-codebase-in-an-hour-742acd71ed7e" rel="noopener">我在一个小时内构建了一个M.E.R.N .代码库</a>(第2部分)</li><li id="968c" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><a class="ae mc" href="https://blog.usejournal.com/we-cut-down-45-of-our-budget-by-switching-to-google-cloud-storage-7e5a6a10542?source=your_stories_page---------------------------" rel="noopener ugc nofollow" target="_blank">通过将我们的客户端托管到云存储，我们节省了45%的总成本</a></li><li id="42d6" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><a class="ae mc" href="https://medium.com/@calvinqc/say-hello-to-the-new-github-clis-7e2612fb3918" rel="noopener">向新的Github CLIs问好</a></li><li id="96a4" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><a class="ae mc" href="https://medium.com/swlh/perfect-structure-to-authenticate-authorize-api-with-node-js-and-passport-jwt-d529b1a618ba" rel="noopener">认证的完美结构&amp;用Node.js授权你的API</a></li></ol><p id="f99e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">感谢访问这个系列，并享受阅读！</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi my"><img src="../Images/1f66aa43fcb8844c77f59c3a96fa5d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sHuTUAgXa-JJQqyK"/></div></div></figure><h1 id="8dce" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">灵感</h1><p id="8ca5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">每当我创建一个新的计算引擎并不得不再次设置Docker时，我通常会去<em class="mb">多个网页</em>找到正确的命令来安装Docker和Docker-compose。</p><p id="3ef5" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我通常要花5分钟以上的时间来找到命令行并进行设置。有时一些网站可能没有你想要的。所以我创建了这个博客来帮助我，也许你也可以在不到一分钟的时间内设置Docker和Docker-compose。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="6386" class="ki kj it bd kk kl nk kn ko kp nl kr ks jz nm ka ku kc nn kd kw kf no kg ky kz bi translated">要求</h1><ol class=""><li id="3b54" class="md me it lc b ld le lg lh lj np ln nq lr nr lv mi mj mk ml bi translated">在本教程中，我假设你已经有了一个新的运行Debian 的<strong class="lc iu">计算引擎(因为这是默认的)，并准备好用Docker运行你的应用程序。</strong></li><li id="9b95" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">你有关于<strong class="lc iu"> Docker </strong>的知识，最好你的服务器有<code class="fe ns nt nu nv b"><strong class="lc iu">Dockerfile</strong></code>和/或<code class="fe ns nt nu nv b"><strong class="lc iu">docker-compose.yml</strong></code></li></ol></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="accd" class="ki kj it bd kk kl nk kn ko kp nl kr ks jz nm ka ku kc nn kd kw kf no kg ky kz bi translated">入门指南</h1><ol class=""><li id="5c1b" class="md me it lc b ld le lg lh lj np ln nq lr nr lv mi mj mk ml bi translated">通过命令行或云控制台ssh到您的虚拟机。</li><li id="5db6" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><strong class="lc iu">以管理员身份登录:</strong> <code class="fe ns nt nu nv b"><strong class="lc iu">$ sudo -s</strong></code></li></ol><blockquote class="nw nx ny"><p id="2f49" class="la lb mb lc b ld lw ju lf lg lx jx li nz ly ll lm oa lz lp lq ob ma lt lu lv im bi translated">注意:如果你不先做<code class="fe ns nt nu nv b">sudo -s</code>，你需要在每个命令中都有<code class="fe ns nt nu nv b">sudo</code></p></blockquote><h1 id="eb64" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">1行命令</h1><p id="d596" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你已经知道你在做什么，但是还没有什么进展，这里有一行命令可以让你为计算引擎设置Docker &amp; Docker-compose。</p><p id="42a4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我还在下面做了命令，让你看看是怎么回事。</p><figure class="mz na nb nc gt nd"><div class="bz fp l di"><div class="oc od l"/></div></figure></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="9cc5" class="ki kj it bd kk kl nk kn ko kp nl kr ks jz nm ka ku kc nn kd kw kf no kg ky kz bi translated">码头工人</h1><p id="66af" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果您喜欢分别执行，请执行以下命令</p><pre class="mz na nb nc gt oe nv of og aw oh bi"><span id="1857" class="oi kj it nv b gy oj ok l ol om">$ apt update<br/>$ apt install --yes apt-transport-https ca-certificates curl gnupg2 software-properties-common<br/>$ curl -fsSL https://download.docker.com/linux/debian/gpg <strong class="nv iu">|</strong> sudo apt-key add -<br/>$ add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/debian <strong class="nv iu">$(</strong>lsb_release -cs<strong class="nv iu">)</strong> stable"<br/>$ apt update<br/>$ apt install --yes docker-ce</span></pre><p id="1d57" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">测试</strong></p><pre class="mz na nb nc gt oe nv of og aw oh bi"><span id="1dc5" class="oi kj it nv b gy oj ok l ol om">$ docker<br/>$ docker info</span></pre><p id="5499" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">在没有</strong>T0的情况下执行Docker命令</p><ul class=""><li id="e72e" class="md me it lc b ld lw lg lx lj mf ln mg lr mh lv on mj mk ml bi translated">无论何时运行docker，你要么必须添加<code class="fe ns nt nu nv b">sudo</code>要么必须运行<code class="fe ns nt nu nv b">sudo -s</code>，这有时让我很恼火。</li><li id="494e" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv on mj mk ml bi translated">运行下面的命令:<code class="fe ns nt nu nv b">$ sudo usermod -aG docker $USER</code></li><li id="8e06" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv on mj mk ml bi translated">然后再次登录，你将能够运行docker没有sudo</li></ul></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="6f60" class="ki kj it bd kk kl nk kn ko kp nl kr ks jz nm ka ku kc nn kd kw kf no kg ky kz bi translated">docker-撰写</h1><h2 id="9002" class="oi kj it bd kk oo op dn ko oq or dp ks lj os ot ku ln ou ov kw lr ow ox ky oy bi translated">为什么我们需要docker-compose</h2><p id="37e3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">当你运行<code class="fe ns nt nu nv b">docker run ...</code>时，你的应用会一直运行，直到你关闭浏览器。这是低效的，因为你不想让你的标签永远开着。所以我们将使用<a class="ae mc" href="https://docs.docker.com/compose/" rel="noopener ugc nofollow" target="_blank"><strong class="lc iu">docker-compose</strong></a><strong class="lc iu">，</strong>，它将在后台运行你的应用<em class="mb"/></p><h2 id="c429" class="oi kj it bd kk oo op dn ko oq or dp ks lj os ot ku ln ou ov kw lr ow ox ky oy bi translated">安装</h2><ol class=""><li id="1d2d" class="md me it lc b ld le lg lh lj np ln nq lr nr lv mi mj mk ml bi translated"><code class="fe ns nt nu nv b">curl -L "https://github.com/docker/compose/releases/download/1.26.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose</code></li><li id="849a" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><code class="fe ns nt nu nv b">chmod +x /usr/local/bin/docker-compose</code></li></ol><h2 id="cb8d" class="oi kj it bd kk oo op dn ko oq or dp ks lj os ot ku ln ou ov kw lr ow ox ky oy bi translated">测试</h2><ul class=""><li id="36b9" class="md me it lc b ld le lg lh lj np ln nq lr nr lv on mj mk ml bi translated"><code class="fe ns nt nu nv b">docker-compose --version</code></li></ul><h2 id="945c" class="oi kj it bd kk oo op dn ko oq or dp ks lj os ot ku ln ou ov kw lr ow ox ky oy bi translated">使用</h2><ol class=""><li id="6fcb" class="md me it lc b ld le lg lh lj np ln nq lr nr lv mi mj mk ml bi translated">确保您的目录中有一个<code class="fe ns nt nu nv b">docker-compose.yml</code></li><li id="f02d" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">运行<code class="fe ns nt nu nv b">docker-compose up --build</code></li><li id="80fc" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">成功启动应用程序后，运行<code class="fe ns nt nu nv b">docker-compose up -d</code></li><li id="290c" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">否则，检查错误并修复bug</li></ol><h1 id="bb65" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">恭喜</h1><p id="565b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，您可以在后台运行您的应用程序，并通过公共IPv4使用它！</p></div></div>    
</body>
</html>