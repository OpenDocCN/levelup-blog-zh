<html>
<head>
<title>Setting up Rails 6 with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React设置轨道6</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/setting-up-rails-6-with-react-4b4d3076545?source=collection_archive---------15-----------------------#2020-04-19">https://levelup.gitconnected.com/setting-up-rails-6-with-react-4b4d3076545?source=collection_archive---------15-----------------------#2020-04-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4f0cd7f562d9d1ebe389d77e234c58ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HTsUd6ilCQ0nGDM7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@seanlimm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">肖恩·林</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="130b" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">简介</strong></h1><p id="8687" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">有许多方法可以将React用作web应用程序的前端。有了Rails，就有了一些可以在Rails代码中嵌入React的gem，本质上创建了一个内置React的Rails应用程序。</p><p id="25e1" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">但是，如果您想完全分离关注点，或者换句话说，不想混合React和Rails代码，该怎么办呢？</p><p id="41f4" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">使用Rails 6可以很容易地做到这一点，这也将是今天的主题。</p><h1 id="af0e" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">设置轨道</h1><p id="393a" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">从概念上讲，我们正在做的是将Rails设置为一个API。这意味着，从面向客户端的应用程序，我们将对Rails后端进行API调用，以检索和存储我们的数据。</p><p id="9fa8" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">Rails自带的视图、控制器和测试对于完整的Rails应用程序来说很棒，但对于Rails API来说却不是必需的。相反，我们将只需要最基本的东西，为我们的后端节省了一大块空间。</p><p id="914d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">首先，我们将创建一个新文件夹来存放我们的Rails和React应用程序，并通过在安装过程中包含API标志来将Rails设置为方便的“API模式”。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2c5d" class="mn ke iq mj b gy mo mp l mq mr">$ mkdir app &amp;&amp; cd app<br/>$ rails new server --api</span></pre><p id="4bad" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">Rails现在将创建一个只支持API的应用程序，它将排除所有不必要的文件。</p><p id="6242" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在Rails完成安装之后，我们将在一个新的端口上运行服务器，因为我们的React应用程序将使用正常的端口3000。为了方便起见，我使用了3001端口。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1ce3" class="mn ke iq mj b gy mo mp l mq mr">$ cd server<br/>$ rails server -p 3001</span></pre><p id="a6d3" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">一旦应用程序启动并运行，我们将通过在浏览器中导航到我们的本地主机来检查一切是否按预期工作。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="bcd1" class="mn ke iq mj b gy mo mp l mq mr"><a class="ae kc" href="https://localhost:" rel="noopener ugc nofollow" target="_blank">https://localhost:3001</a></span></pre><p id="fbdd" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">如果一切顺利，您应该会在浏览器中看到Rails欢迎屏幕。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/f2da040f130940089c92aedf4143a3a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQnNIpv8ZLRfu8wS7shgvQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Rails欢迎屏幕</figcaption></figure><h1 id="9bf5" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">API版本控制</h1><p id="d052" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">尽管不是必需的，但强烈建议通过为所有当前和未来版本创建一个自定义名称空间来跟踪API版本。</p><p id="af51" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这可以通过在您的<code class="fe mt mu mv mj b">routes.rb</code>文件中创建一个新的名称空间来完成。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="297b" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这里我们将空间命名为API及其当前版本，以免混淆任何未来版本和实现。</p><p id="60e5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">现在，我们通过创建一个类似于命名空间API的文件夹结构来访问我们的控制器。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ffc4" class="mn ke iq mj b gy mo mp l mq mr">app &gt; controllers &gt; api &gt; v1 &gt; your_model</span></pre><p id="10a9" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">应用程序的文件夹结构与我们创建的名称间距相匹配非常重要，否则它将无法正常工作。</p><h1 id="182f" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">设置React</h1><p id="7b1c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">既然我们已经正确地设置了Rails API，我们就可以用React包含应用程序的面向客户端部分了。</p><p id="f9f2" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我们将把目录改回我们的app文件夹，并创建一个新的React应用程序。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="495d" class="mn ke iq mj b gy mo mp l mq mr">$ cd ..<br/>$ npx create-react-app client</span></pre><p id="6d9b" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">安装完成后，我们通过将目录更改到新的客户端文件夹并启动React开发服务器来检查一切是否顺利。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d58c" class="mn ke iq mj b gy mo mp l mq mr">$ cd client<br/>$ npm start</span></pre><p id="af41" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">接下来，我们前往我们的浏览器，以确保React正在工作。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6182" class="mn ke iq mj b gy mo mp l mq mr">https://localhost:3000</span></pre><p id="e0ed" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">如果一切正常，我们应该会在屏幕上看到这个。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/e4bfe41cacb520411a15d4f7e190fdeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHuwk7JGt4ZKiunyYSuy1Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">反应开始屏幕</figcaption></figure><h1 id="0e9f" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">把所有的放在一起</h1><p id="a868" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在，我们应该已经准备好了两个应用程序，Rails后端和React前端。在这一步中，我们将把两个独立的应用程序链接在一起，成功地允许前端应用程序React从后端Rails存储和检索数据。</p><p id="f5c3" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">为了做到这一点，我们需要使用一个接口来进行API调用。我们可以使用<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank">获取</a> API来发出我们的API请求，但是我倾向于选择<a class="ae kc" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> Axios </a>。两者都可以。</p><p id="304e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">首先，我们需要在我们的客户端目录中安装Axios。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4f17" class="mn ke iq mj b gy mo mp l mq mr">$ npm install axios</span></pre><p id="7fcb" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">安装完成后，我们就可以开始从前端向后端进行API调用了。</p><p id="b757" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">本质上，我们将把我们的Rails服务器放在端口3001和它的名称空间API上，并把这个信息和相关路径一起传递给Axios。</p><p id="f7c8" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">例如，如果我们想为假设的用户页面调用一个GET请求，我们的请求应该是这样的。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mw mx l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">获取请求示例</figcaption></figure><p id="a86f" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在上面的例子中，我们调用Rails服务器<code class="fe mt mu mv mj b">https://localhost:3001</code>，我们使用的名称空间<code class="fe mt mu mv mj b">/api/v1</code>，最后是我们想要的路径<code class="fe mt mu mv mj b">/users</code>。显然，您自己的应用程序会有所不同。</p><p id="459d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在任何情况下，我们都将这些信息传递给“get”函数，该函数调用Rails API，并处理“then”函数中返回的内容，最后，如果有任何错误，我们会在“catch”函数中捕获它们。查看<a class="ae kc" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> Axios </a>文档了解更多信息。</p><p id="2255" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">此外，请注意这里使用了名称spaced API:<code class="fe mt mu mv mj b"><strong class="ld ir">/api/v1/</strong>some_path</code></p><p id="378f" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我们在Rails-API中对名称空间所做的任何更改也将反映在我们的API请求中。我知道这可能是显而易见的，但我想我会提到它。</p><h1 id="7ce2" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">最后的想法</h1><p id="8d62" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">好了，我们已经成功地设置了Rails API，React前端，并且我们已经将它们与Axios连接在一起。如果我们想要一个全栈应用程序，但希望将前端与后端分开，这将使我们能够正常运行。</p><p id="14c5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">然而，在这样的系统中，可以进行一些生活质量的改变来简化工作流程，但这是另一个话题了。</p></div></div>    
</body>
</html>