<html>
<head>
<title>Learning Go: Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习围棋:功能</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/learning-go-functions-b3b917cd98ae?source=collection_archive---------9-----------------------#2020-03-20">https://levelup.gitconnected.com/learning-go-functions-b3b917cd98ae?source=collection_archive---------9-----------------------#2020-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6fc6e405e56132d16edd0580214a4d08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9HD5iqF32-rQ6CBh"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@templecerulean?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">寺鹂</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="6e7e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我将演示如何在Go中编写和使用函数。我将讨论返回值函数和仅仅为了它们的效果而使用的函数(在一些编程语言中称为void函数)。</p><h1 id="c222" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">函数定义和函数调用语法模板</h1><p id="7682" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">与您可能熟悉的大多数编程语言相比，Go具有不同的语法模板来定义函数。以下是模板:</p><p id="3059" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mh"> func函数名(参数列表)(结果列表){ <br/>函数体<br/> } </em></p><p id="99ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有的函数定义都以关键字<code class="fe mi mj mk ml b">func</code>开始。接下来是函数名和参数列表。参数按名称列出，然后用逗号分隔数据类型和多个参数。</p><p id="aa72" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">参数列表之后是结果列表。结果列表当然会包括函数的返回数据类型，但它也可以包括函数返回的结果类型的名称。如果你留心的话，你会注意到我说的是“返回类型”是的，Go函数可以返回多个值。我将在本文后面演示这是如何工作的。</p><p id="46b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一个函数定义没有结果列表，那么这个函数将被用于它的效果(就像一个void函数或者一个子程序)。</p><p id="eb6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">函数调用语法模板更简单:</p><p id="c3ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mh"> func-name(参数列表)</em></p><p id="aa48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">函数调用可以在任何需要表达式的地方进行，函数调用最重要的规则是参数列表必须与形参列表匹配。</p><h1 id="ef9f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Go函数参数是按值传递的参数</h1><p id="8b3c" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">默认情况下，传递给Go函数的参数是按值传递的参数。这意味着编译器在函数体中使用参数时会复制参数，这样函数就不能对参数进行永久更改。</p><p id="8e38" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以通过使用带有参数的引用操作符(<code class="fe mi mj mk ml b">&amp;</code>)将函数的参数转换为按引用传递的参数。我们将在本文后面讨论按值传递和按引用传递参数。</p><h1 id="672f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Go函数示例</h1><p id="bc77" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">让我们从一个类函数的例子开始。写一个函数，把摄氏温度转换成华氏温度。在循环中使用函数，将20摄氏度的温度从-10摄氏度转换为+10摄氏度。</p><p id="04e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是函数定义和使用该函数的程序:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="d15e" class="mu lf it ml b gy mv mw l mx my">func ctof(temp float64) float64 {<br/>  return (9.0/5.0) * temp + 32.0<br/>}</span><span id="6d13" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  for c:=-10; c&lt;=10; c++ {<br/>  fmt.Printf("%d Celsius is %.2f Fahrenheit.\n", c,<br/>             ctof(float64(c)))<br/>  }<br/>}</span></pre><p id="da6c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是另一个有两个参数的例子:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="0902" class="mu lf it ml b gy mv mw l mx my">func maximum(val1 int, val2 int) int {<br/>  if val1 &gt; val2 {<br/>    return val1<br/>  } else {<br/>    return val2<br/>  }<br/>}</span><span id="c365" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  var num1, num2 int<br/>  fmt.Print("Enter first number: ")<br/>  fmt.Scan(&amp;num1)<br/>  fmt.Print("Enter second number: ")<br/>  fmt.Scan(&amp;num2)<br/>  larger := maximum(num1, num2)<br/>  fmt.Printf("%d is larger of the values %d and %d.\n", larger,<br/>             num1, num2)<br/>}</span></pre><h1 id="03cc" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">不返回值的Go函数</h1><p id="3480" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">下面是一个仅用于其效果的函数示例:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="00b4" class="mu lf it ml b gy mv mw l mx my">func greeting(name string) {<br/>  fmt.Printf("Hello, %s!\n", name)<br/>}</span><span id="cea7" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  var name string<br/>  fmt.Print("What's your name? ")<br/>  fmt.Scan(&amp;name)<br/>  greeting(name)<br/>}</span></pre><p id="0409" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不返回值的函数的一个经典例子是在C++等语言中为交换变量而编写的函数。在C++中，这个函数必须用指针编写，这样swap函数才能永久地交换它的参数值。</p><p id="9b21" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是这个交换函数在Go中的样子(以及一个演示它如何工作的程序):</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="839b" class="mu lf it ml b gy mv mw l mx my">func swap(val1 *int, val2 *int) {<br/>  temp := *val1<br/>  *val1 = *val2<br/>  *val2 = temp<br/>}</span><span id="852a" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  num1 := 1<br/>  num2 := 2<br/>  fmt.Printf("num1: %d, num2: %d\n", num1, num2)<br/>  swap(&amp;num1, &amp;num2)<br/>  fmt.Printf("num1: %d, num2: %d\n", num1, num2)<br/>}</span></pre><p id="38e6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个例子中，我们使用指针作为两个函数参数，然后使用address-of操作符(<code class="fe mi mj mk ml b">&amp;</code>)作为函数的参数。我将在另一篇文章中讨论Go指针。</p><h1 id="a19c" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从函数中返回多个值</h1><p id="a11e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">上面的<code class="fe mi mj mk ml b">swap</code>函数示例要求我们使用指针来修改函数参数。这是你在不允许函数返回多个值的传统语言中要做的事情，但在Go中却不是这样。</p><p id="12e1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我在函数定义模板一节中提到的，一个函数可以返回多个值，而不是一个。为了演示这是如何工作的，下面是重新编写的交换函数，它返回传递给它的两个变量值:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="3d8d" class="mu lf it ml b gy mv mw l mx my">func swap(val1, val2 int) (int, int) {<br/>  return val2, val1<br/>}</span><span id="1a27" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  num1 := 1<br/>  num2 := 2<br/>  fmt.Printf("num1: %d, num2: %d\n", num1, num2)<br/>  num1, num2 = swap(num1, num2)<br/>  fmt.Printf("num1: %d, num2: %d\n", num1, num2)<br/>}</span></pre><p id="0b26" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经在Go中看到了返回多个值的函数。我在几个地方使用的<code class="fe mi mj mk ml b">range for</code>循环实际上是一个函数，其中调用<code class="fe mi mj mk ml b">range</code>函数时使用一个数组或片作为参数，该函数返回数据结构中的元素和存储该元素的索引:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="f4e3" class="mu lf it ml b gy mv mw l mx my">func main() {<br/>  numbers := []int{1,2,3,4,5}<br/>  for index, number := range numbers {<br/>    fmt.Println(index,":",number)<br/>  }<br/>}</span></pre><p id="57f9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">允许一个函数有多个返回值为函数提供了很多新的功能，其重要性不言而喻。</p><h1 id="d94b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">围棋中的递归</h1><p id="39e8" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Go函数可以是递归的；换句话说，Go函数可以从函数体内调用自己。这里我没有空间来教你递归，所以我只演示一个典型的递归函数来计算一个数的阶乘。</p><p id="07b1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是函数定义和一个测试程序:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="dc8d" class="mu lf it ml b gy mv mw l mx my">func factorial(number int) int {<br/>  if number == 1 {<br/>    return number<br/>  } else {<br/>    return number * factorial(number-1)<br/>  }<br/>}</span><span id="0157" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  var num int<br/>  fmt.Print("Enter number: ")<br/>  fmt.Scan(&amp;num)<br/>  fmt.Printf("%d factorial is %d.\n", num, factorial(num))<br/>}</span></pre><p id="ff11" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">递归是所有现代编程语言都必须实现的一项必要技术，因为你需要递归来处理递归数据结构。</p><h1 id="35c5" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">可变函数</h1><p id="8488" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">可变函数是一个可以接受未知数量参数的函数。变量函数的一个明显例子是<code class="fe mi mj mk ml b">sum</code>函数，它可以对传递给函数的任意数量的数值参数求和。</p><p id="1d50" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">内置变量函数的一个例子是<code class="fe mi mj mk ml b">Printf</code>函数。这个函数可以接受任意数量的参数，因为您可以提供一个文本字符串，其中嵌入任意数量的变量。</p><p id="bb56" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">可变函数的函数定义语法模板如下所示:</p><p id="d4f6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mh"> func函数名(参数…数据类型)(结果列表){ <br/>体<br/> } </em></p><p id="026e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">省略号表示可以使用不同数量的参数，它们的数据类型列在参数列表的末尾。</p><p id="df8a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是如何定义一个变量<code class="fe mi mj mk ml b">sum</code>函数，以及使用该函数的程序:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="b593" class="mu lf it ml b gy mv mw l mx my">func sum(numbers...int) int {<br/>  total := 0<br/>  for _, number := range numbers {<br/>    total += number<br/>  }<br/>  return total<br/>}</span><span id="43de" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  total := sum(1,2,3,4,5)<br/>  fmt.Print(total)<br/>}</span></pre><p id="46e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个变量函数也可以包含不变的参数。在这种情况下，可变参数必须是参数列表中的最后一个。</p><p id="ef72" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面的程序演示了一个简单的函数，它向不同数量的人显示问候语:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="4b83" class="mu lf it ml b gy mv mw l mx my">func greet(greeting string, names...string) string {<br/>  g := greeting + " "<br/>  for index, name := range names {<br/>    if (index == len(names)-1) {<br/>      g += "and " + name<br/>    } else {<br/>      g += name + ", "<br/>    }<br/>  }<br/>  return g + "!"<br/>}</span><span id="e914" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  fmt.Println(greet("Hello", "Mike", "Terri", "Meredith",<br/>              "Allison", "Mason"))<br/>  fmt.Println(greet("Goodbye", "Cynthia", "Danny", "Jonathan"))<br/>}</span></pre><h1 id="00fb" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">一级函数</h1><p id="81d8" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Go中的函数是第一类，这意味着它们可以用作函数参数、函数的返回值，以及在表达式中赋给变量。Go函数也可以是匿名的，这意味着你可以定义一个没有名字的函数，并在任何需要表达式的地方使用它。</p><p id="b09c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们看看如何将函数赋给变量:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="4428" class="mu lf it ml b gy mv mw l mx my">func square(number int) int {<br/>  return number * number;<br/>}</span><span id="8706" class="mu lf it ml b gy mz mw l mx my">func main() {<br/>  num := 2<br/>  sq := square<br/>  fmt.Printf("The square of %d is %d.\n", num, sq(num))<br/>}</span></pre><p id="a69a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们在表达式中使用匿名函数:</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="ec9a" class="mu lf it ml b gy mv mw l mx my">func main() {<br/>  num := 2<br/>  sq := func(num int) int { return num * num }<br/>  fmt.Printf("The square of %d is %d.\n", num, sq(num))<br/>}</span></pre><p id="7cbe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个例子中，一个匿名函数被分配给变量<code class="fe mi mj mk ml b">sq</code>。您可以看到，除了缺少函数名之外，匿名函数定义看起来像常规函数定义。</p><p id="f55f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当您需要一个函数进行一次性计算时，匿名函数非常有用。匿名函数也可以让你的程序更具可读性。</p><h1 id="ceaa" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">更多即将推出的Go功能</h1><p id="8a08" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我只是开始介绍所有需要介绍的关于Go中函数的内容。我省略了关于错误处理、延迟函数调用以及处理恐慌和恢复的内容。我将在一篇高级文章中回到这些主题。</p><p id="fd86" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读，请给我发电子邮件提出意见和建议。</p></div></div>    
</body>
</html>