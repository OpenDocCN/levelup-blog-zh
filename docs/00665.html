<html>
<head>
<title>Learn Hooks in Just 5 Steps with Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过例子只需5步就能学会钩子</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/learn-hooks-in-just-5-steps-with-examples-44436e825f01?source=collection_archive---------0-----------------------#2019-06-22">https://levelup.gitconnected.com/learn-hooks-in-just-5-steps-with-examples-44436e825f01?source=collection_archive---------0-----------------------#2019-06-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="beed" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">直到你使用它们，你才真正知道你需要它们</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/ccefc21a283a856db0e19b9e2500b9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kE3eBZcYIHTx5uR2YoI4_A.png"/></div></div></figure><p id="8a66" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在本文中，我们将通过构建一个Todo MVC应用程序来学习在React应用程序中使用钩子。</p><p id="f844" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我会在每一步之后分享一个Codesandbox链接，其中包含完整的代码，这样你就可以自己玩了，看看事情是如何实时工作的。</p><p id="47a2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">本文假设您了解ReactJS和ES6语法的基础。如果没有，那么我在需求部分列出了一些资源来帮助你快速了解。</p><h1 id="cdb1" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">TLDR；</h1><p id="91c8" class="pw-post-body-paragraph ks kt iq ku b kv mg jr kx ky mh ju la lb mi ld le lf mj lh li lj mk ll lm ln ij bi translated">如果你想直接跳到代码，那么这里有<a class="ae ml" href="https://github.com/prateek3255/todo-with-hooks" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>以及最终代码和沙箱。</p><div class="mm mn gp gr mo mp"><a href="https://codesandbox.io/s/todo-with-hooks-final-jwimr" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">todo-with-hooks-final-code sandbox</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">为web应用程序定制的在线代码编辑器</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">codesandbox.io</p></div></div><div class="my l"><div class="mz l na nb nc my nd kq mp"/></div></div></a></div><h1 id="dbd7" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">要求</h1><ul class=""><li id="33f1" class="ne nf iq ku b kv mg ky mh lb ng lf nh lj ni ln nj nk nl nm bi translated">JavaScript中的基本<a class="ae ml" href="https://medium.com/jsguru/javascript-functional-programming-map-filter-and-reduce-846ff9ba492d" rel="noopener">数组方法</a></li><li id="26b0" class="ne nf iq ku b kv nn ky no lb np lf nq lj nr ln nj nk nl nm bi translated">像<a class="ae ml" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" rel="noopener ugc nofollow" target="_blank">箭头功能</a>、<a class="ae ml" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax" rel="noopener ugc nofollow" target="_blank">展开语法</a>等ES6概念。</li><li id="6e02" class="ne nf iq ku b kv nn ky no lb np lf nq lj nr ln nj nk nl nm bi translated">基本<a class="ae ml" href="https://reactjs.org/docs/getting-started.html" rel="noopener ugc nofollow" target="_blank">反应</a>和状态<a class="ae ml" rel="noopener ugc nofollow" target="_blank" href="/componentdidmakesense-react-lifecycle-explanation-393dcb19e459">生命周期</a>。</li></ul><p id="86da" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这就是你学习钩子所需要知道的。如果你对自己的ReactJS技能有所怀疑，那么你可以阅读React官方文档提供的这个令人敬畏的教程。</p><h1 id="1df1" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">前言</h1><blockquote class="ns"><p id="c987" class="nt nu iq bd nv nw nx ny nz oa ob ln dk translated">挂钩是React提供的一个函数，它允许您从函数组件中挂钩React特性。</p></blockquote><p id="a936" class="pw-post-body-paragraph ks kt iq ku b kv oc jr kx ky od ju la lb oe ld le lf of lh li lj og ll lm ln ij bi translated">在React 16.8.0之前，功能组件被称为表示性组件或哑组件，因为它们只用于表示一些可以使用props操作的UI。它们不能维护自己的状态，所以我们需要类来创建有意义的应用程序。</p><p id="f21d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在，随着钩子的引入，事情发生了变化，允许功能组件维护状态和处理副作用。使用hooks，您可以构建成熟的react应用程序，而无需创建单独的类。</p><h1 id="dfa5" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">1.初始设置</h1><p id="4db9" class="pw-post-body-paragraph ks kt iq ku b kv mg jr kx ky mh ju la lb mi ld le lf mj lh li lj mk ll lm ln ij bi translated">我刚刚使用<code class="fe oh oi oj ok b">create-react-app</code>创建了一个简单的React应用程序，它有一个简单的函数组件和带有样式的UI。</p><p id="ac30" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我已经事先整合了所有的风格，所以我们可以只关注功能部分。</p><p id="e505" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是初始设置的沙盒:</p><div class="mm mn gp gr mo mp"><a href="https://codesandbox.io/s/todo-with-hooks-initial-ui-gxeue" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">初始设置</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">为web应用程序定制的在线代码编辑器</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">codesandbox.io</p></div></div><div class="my l"><div class="ol l na nb nc my nd kq mp"/></div></div></a></div><h1 id="4d03" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">2.加载数据</h1><p id="6f41" class="pw-post-body-paragraph ks kt iq ku b kv mg jr kx ky mh ju la lb mi ld le lf mj lh li lj mk ll lm ln ij bi translated">正如你所看到的，这个应用程序中的数据目前是静态的，所以我们需要做的第一件事是为to do创建一个结构，并将它们加载到相应的部分中。</p><p id="78bc" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们将创建一个代表任务的对象数组，其中每个对象代表一个任务。现在，由于我们只需要任务的名称及其状态(无论是否完成)，我们的任务对象将有两个键:</p><pre class="kh ki kj kk gt om ok on oo aw op bi"><span id="fbfe" class="oq lp iq ok b gy or os l ot ou">{<br/>    name: 'Do pushups',  // Name of the task</span><span id="ac19" class="oq lp iq ok b gy ov os l ot ou">    status: true        // Completion status where true represents   }                       //  complete and false represents pending</span></pre><p id="33b1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在，如果它是一个类组件，我们将创建一个状态变量，并将该数组赋值如下:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="f253" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">但是因为我们这里没有任何类组件，我们将使用<code class="fe oh oi oj ok b"><a class="ae ml" href="https://reactjs.org/docs/hooks-state.html" rel="noopener ugc nofollow" target="_blank">useState</a></code>钩子创建一个名为<code class="fe oh oi oj ok b">todos</code>的变量，并用一个数组初始化它，就像这样:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="e4b9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><code class="fe oh oi oj ok b">useState</code>钩子将变量的初始值作为输入，并返回一个由两个元素组成的数组，第一个元素表示变量的值，第二个元素是更新该值的方法。如果上面的实现让你感到困惑，那么你可以这样写:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="4ab1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在，我们已经有了可用的任务阵列，我们将根据它们的状态对它们进行筛选，并将它们映射到各自的部分:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="123b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是到目前为止完整代码的沙盒。</p><div class="mm mn gp gr mo mp"><a href="https://codesandbox.io/s/todo-with-hooks-loaded-data-26r72" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">已加载数据-代码沙盒</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">为web应用程序定制的在线代码编辑器</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">codesandbox.io</p></div></div><div class="my l"><div class="oy l na nb nc my nd kq mp"/></div></div></a></div><h1 id="69e4" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">3.添加任务</h1><p id="5a02" class="pw-post-body-paragraph ks kt iq ku b kv mg jr kx ky mh ju la lb mi ld le lf mj lh li lj mk ll lm ln ij bi translated">既然我们已经准备好了todos数组，现在我们可以开始添加任务了。</p><p id="a5c4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我已经创建了一个输入字段，但是我们还需要一个状态字段来维护它的值。</p><p id="3c04" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因此，我们将创建另一个<code class="fe oh oi oj ok b">useState</code>钩子来维护输入字段的值，并用一个空字符串初始化它:</p><pre class="kh ki kj kk gt om ok on oo aw op bi"><span id="f843" class="oq lp iq ok b gy or os l ot ou">const [value, setValue] = useState("");</span></pre><p id="49aa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我希望你能够看到钩子和类组件中的状态有什么不同。如果它是一个类组件，我们的状态应该是这样的:</p><pre class="kh ki kj kk gt om ok on oo aw op bi"><span id="198b" class="oq lp iq ok b gy or os l ot ou">this.state = {<br/>    todos: [....],<br/>    value: ""<br/>};</span></pre><p id="4d17" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">它将只为我们提供一个单一的<code class="fe oh oi oj ok b">this.setState()</code>函数来更新两个变量的值。但是有了钩子，我们现在有了单独的函数来更新两个变量的值。</p><p id="56e1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">让我们将它集成到我们的应用程序中:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="3339" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">输入字段现在可以工作了，但是我们仍然没有任何东西来创建任务。因此，让我们创建一个函数，使用我们在上一步中创建的<code class="fe oh oi oj ok b">setTodos</code>方法来添加任务。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="05fc" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">该方法使用数组析构将输入字段的值附加到新任务中。创建任务后，我们还需要清除字段中的值，因为现在已经添加了任务，所以我们使用<code class="fe oh oi oj ok b">setValue("")</code>清除输入字段。</p><p id="2bcb" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然后我们将这个函数添加到“添加”按钮的<code class="fe oh oi oj ok b">onClick</code>处理程序中。现在，我们可以将任务添加到待办事项列表中。</p><p id="b35f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我想介绍的最后一个修饰是当用户在输入字段中输入任务后按“enter”时添加一个任务。</p><p id="8a80" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因此，我们将使用输入的<code class="fe oh oi oj ok b">onKeyDown</code>事件处理程序来检测“enter”键的按下。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="8ed4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是到目前为止完整代码的沙盒:</p><div class="mm mn gp gr mo mp"><a href="https://codesandbox.io/s/todo-with-hooks-add-task-g9h1g" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">添加任务- CodeSandbox</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">为web应用程序定制的在线代码编辑器</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">codesandbox.io</p></div></div><div class="my l"><div class="oz l na nb nc my nd kq mp"/></div></div></a></div><h1 id="8458" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">4.更新和删除任务</h1><p id="e32f" class="pw-post-body-paragraph ks kt iq ku b kv mg jr kx ky mh ju la lb mi ld le lf mj lh li lj mk ll lm ln ij bi translated">在这一步中，我们将使状态复选框和删除按钮起作用，以便我们可以将任务标记为已完成或待定。</p><p id="831b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">由于我们对已完成和未完成的任务有不同的部分，如果想要扩展我们的应用程序，只使用索引来跟踪正在执行的操作将是困难和不正确的。</p><p id="6f17" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因此，我们现在将向task对象添加一个id属性，这将有助于唯一地标识单个任务和。出于本教程的考虑，我们将把ID指定为<code class="fe oh oi oj ok b">Date.now()</code>和<code class="fe oh oi oj ok b">Math.random()</code>的组合，以确保它们是唯一的。我们的<code class="fe oh oi oj ok b">addTodo</code>函数现在看起来像这样:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="dbbf" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在，为了更新任务的状态，我们只需传递正在更新的任务的id，并在数组中相应地切换该任务的状态。所以我们将创建一个函数，并在复选框的<code class="fe oh oi oj ok b">onChange</code>事件上调用它。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="fbf5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">类似地，对于delete，我们只需从数组中过滤出具有给定ID的任务。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="c215" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在，我们的todo应用程序几乎完成了所有功能，除了一旦我们点击刷新或重新打开标签，所有内容都会丢失。</p><p id="eafa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是到目前为止完整代码的沙盒:</p><div class="mm mn gp gr mo mp"><a href="https://codesandbox.io/s/todo-with-hooks-update-delete-p5iw0" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">更新和删除任务- CodeSandbox</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">为web应用程序定制的在线代码编辑器</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">codesandbox.io</p></div></div><div class="my l"><div class="pa l na nb nc my nd kq mp"/></div></div></a></div><h1 id="43a0" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">5.维护数据</h1><p id="d121" class="pw-post-body-paragraph ks kt iq ku b kv mg jr kx ky mh ju la lb mi ld le lf mj lh li lj mk ll lm ln ij bi translated">在这一步中，我们将学习如何存储任务，以便当用户关闭选项卡或刷新页面时，任务不会丢失。</p><p id="2797" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">您可以使用任何东西来存储数据，比如Firebase、MongoDB或任何其他数据库。</p><p id="7aac" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">为了简化我们的应用程序，我将使用浏览器的<code class="fe oh oi oj ok b">localStorage</code>，使用一个名为<a class="ae ml" href="https://github.com/localForage/localForage" rel="noopener ugc nofollow" target="_blank">local feed</a>的库，该库使用localStorge API。</p><p id="3d13" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果它是一个类组件，那么我们会创建一个函数，在每次更新todos数组时保存数据，我们会调用这个函数作为对<code class="fe oh oi oj ok b">addTodo()</code>、<code class="fe oh oi oj ok b">deleteTodo()</code>和<code class="fe oh oi oj ok b">handleCheckboxChange()</code>方法中<code class="fe oh oi oj ok b">setState()</code>的回调，就像这样:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="8883" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">但是你猜怎么着，钩子没有回调。</p><p id="37ed" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">他们有更好的东西来代替生命周期方法，比如<code class="fe oh oi oj ok b">componentDidMount()</code>、<code class="fe oh oi oj ok b">componentDidUpdate()</code>和<code class="fe oh oi oj ok b">setState</code>回调。</p><p id="ecb2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">向<code class="fe oh oi oj ok b"><a class="ae ml" href="https://reactjs.org/docs/hooks-effect.html" rel="noopener ugc nofollow" target="_blank">useEffect</a></code>钩问好。</p><pre class="kh ki kj kk gt om ok on oo aw op bi"><span id="5e43" class="oq lp iq ok b gy or os l ot ou">import React, { useState, useEffect } from "react";</span><span id="2618" class="oq lp iq ok b gy ov os l ot ou">...</span><span id="02a5" class="oq lp iq ok b gy ov os l ot ou">useEffect (() =&gt; {<br/>    // Anything you want to do when the component rerenders<br/>})</span></pre><p id="8687" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">每次我们的组件重新渲染时，即状态或道具改变时，都会调用<code class="fe oh oi oj ok b">useEffect</code>。</p><p id="265e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">但是如果我们在每次状态更新时都保存数据，那么我们的效率会很低，因为当我们在输入字段中输入内容时,<code class="fe oh oi oj ok b">value</code>状态也会更新。</p><p id="ac00" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">为了解决这个问题,<code class="fe oh oi oj ok b">useEffect</code> hook将另一个参数作为一个数组，该数组包含需要被监控以进行更新的状态变量。所以有了这个特性，我们只需要这样写:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="f96f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">每次数组更新时保存todos。简单不是吗？</p><p id="733e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在，每次更新您的任务时，您都可以进入inspect窗口中的application选项卡，查看保存的数据。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/8217047e6da4730429137fa3b4e47f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJzXLlRqSE2XFxzMOETEWw.png"/></div></div></figure><p id="3ed2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">剩下的最后一件事是当页面刷新或者标签页关闭再打开时获取这个数组。</p><p id="ccb3" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">同样，如果它是一个类组件，我们应该在这里使用<code class="fe oh oi oj ok b">componentDidMount()</code>，但是因为我们使用了<code class="fe oh oi oj ok b">useEffect</code>钩子，它有一个特性，如果我们传递一个空数组作为第二个参数，它的行为就像<code class="fe oh oi oj ok b">componentDidMount()</code>。</p><p id="b5bd" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">所以我们将创建另一个<code class="fe oh oi oj ok b">useEffect</code>钩子，它将一个空数组作为第二个参数，然后从<code class="fe oh oi oj ok b">localStorage</code>中获取<code class="fe oh oi oj ok b">todos</code>数组，并使用<code class="fe oh oi oj ok b">setTodos</code>更新<code class="fe oh oi oj ok b">todos</code>状态变量的值。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="57e6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">最后，现在我们已经准备好了全功能的Todo应用程序。</p><p id="dce8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是到目前为止完整代码的沙盒。我还对代码进行了一点重构，为任务创建了一个单独的组件:</p><div class="mm mn gp gr mo mp"><a href="https://codesandbox.io/s/todo-with-hooks-final-jwimr" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">最终代码沙盒</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">为web应用程序定制的在线代码编辑器</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">codesandbox.io</p></div></div><div class="my l"><div class="pb l na nb nc my nd kq mp"/></div></div></a></div><h1 id="e04d" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">进一步阅读</h1><ul class=""><li id="beb2" class="ne nf iq ku b kv mg ky mh lb ng lf nh lj ni ln nj nk nl nm bi translated">我强烈建议你浏览一下关于钩子的<a class="ae ml" href="https://reactjs.org/docs/hooks-overview.html" rel="noopener ugc nofollow" target="_blank"> React文档。</a></li><li id="b640" class="ne nf iq ku b kv nn ky no lb np lf nq lj nr ln nj nk nl nm bi translated">这个<a class="ae ml" href="https://youtu.be/dpw9EHDh2bM" rel="noopener ugc nofollow" target="_blank">视频</a>中，丹·阿布拉莫夫在React大会上释放钩子。</li><li id="07d6" class="ne nf iq ku b kv nn ky no lb np lf nq lj nr ln nj nk nl nm bi translated">通过添加编辑任务或重新定位任务等功能来测试您对这个概念的理解，并在<a class="ae ml" href="https://github.com/prateek3255/todo-with-hooks" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中打开一个拉请求。我会合并公关，如果我发现它是准确的，并会提到的变化，如果有任何在公关本身。</li></ul></div><div class="ab cl pc pd hu pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="ij ik il im in"><p id="5ebb" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">请👏如果你喜欢这篇文章，它真的激励我这样的人继续写这样的文章。你可以在<a class="ae ml" href="https://github.com/prateek3255" rel="noopener ugc nofollow" target="_blank"> Github </a>、<a class="ae ml" href="https://twitter.com/psuranas" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae ml" href="https://linkedin.com/in/psuranas" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>或<a class="ae ml" href="http://prateeksurana.me" rel="noopener ugc nofollow" target="_blank">我的网站</a>上联系我或了解我的更多信息。</p><p id="8fa4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><em class="pj">感谢阅读:)</em></p></div><div class="ab cl pc pd hu pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="ij ik il im in"><div class="kh ki kj kk gt mp"><a href="https://gitconnected.com/learn/react" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">学习React -最佳React教程(2019) | gitconnected</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">React是一个现代JavaScript库，前端web开发人员使用它来构建用户界面(UI)。它用于…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">gitconnected.com</p></div></div><div class="my l"><div class="pk l na nb nc my nd kq mp"/></div></div></a></div></div></div>    
</body>
</html>