<html>
<head>
<title>AWS S3M Pattern: Terraform &amp; DevOps for a 10 Years Child</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS S3M模式:适用于10岁儿童的Terraform和DevOps</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/aws-s3m-pattern-terraform-devops-for-a-10-years-child-dac4610017ff?source=collection_archive---------24-----------------------#2021-02-22">https://levelup.gitconnected.com/aws-s3m-pattern-terraform-devops-for-a-10-years-child-dac4610017ff?source=collection_archive---------24-----------------------#2021-02-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cc59" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第2部分:地形和开发</h2></div><h1 id="a553" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">“技巧让您节省时间，轻松编码和部署您的Terraform配置文件”</h1><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/4a9c0e1d588728431d9c61cdcb52149e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0ypnDIQokQeK98Emvc86Q.png"/></div></div></figure><p id="d733" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">作为一名软件架构师或FullStack开发人员(有开发背景的人)，我总是对Terraform配置的语法感到恐惧(HashiCorp配置语言:HCL)。</p><p id="d987" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">每次我读一个使用这种语法的文件的例子时，我什么也看不懂，也不知道为什么。</p><p id="209d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">然而，我找出了原因:“这是因为我的大脑被格式化或编程为如何设计软件，如何制作算法来解决问题，等等…而不是其他”，所以我试图以这种心态理解Terraform配置文件，我将我对简单配置语言(HCL)的理解复杂化了，</p><p id="6ab9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">所以我写了这个故事来与你分享技巧和诀窍，通过实现我以前写的S3M模式来更好地理解和部署Terraform。</p><blockquote class="mf mg mh"><p id="06ba" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">为了更好地理解实现的例子，请参考我以前的故事</p></blockquote><div class="mm mn gp gr mo mp"><a href="https://naoufal-gafa.medium.com/aws-when-serverless-and-microservice-get-married-securely-6585f7856a0f" rel="noopener follow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">AWS S3M模式:安全结合无服务器和微服务的5个步骤</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">“使用这种抽象模式来构建复杂的云架构，可以节省您的时间”</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">naoufal-gafa.medium.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd lh mp"/></div></div></a></div><p id="073a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">所以，我们走吧😉</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><blockquote class="mf mg mh"><p id="a10c" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated"><em class="iq">先决条件:</em></p><p id="ad05" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">→ AWS账户</p><p id="b500" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">→ <a class="ae nl" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html" rel="noopener ugc nofollow" target="_blank"> AWS编程帐户</a>，具有编程访问和管理权限</p><p id="5da5" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">→ <a class="ae nl" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" rel="noopener ugc nofollow" target="_blank">笔记本电脑中配置的AWS CLI</a>(如果您想从笔记本电脑运行infra。AWS/配置)</p><p id="03ac" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">→更好地理解S3M模式</p></blockquote></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="75c9" class="kf kg iq bd kh ki nm kk kl km nn ko kp jw no jx kr jz np ka kt kc nq kd kv kw bi translated">Terraform:什么？为什么？怎么会？</h1><h2 id="268f" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">什么是Terraform？</h2><p id="7497" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">是一个IaC软件工具😲→下文作为代码软件工具😳→允许我们对基础设施进行编码的软件😜。</p><p id="a6c9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">编码infra可以用两种方法来完成:命令式(How)或声明式(What)或两者结合。</p><p id="04c5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi">祈使:</em> </strong></p><ul class=""><li id="db48" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">关注基础设施必须如何完成</li><li id="19a2" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">定义需要以适当的顺序执行的特定命令，以便以期望的结论结束</li></ul><p id="ce05" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi">说明性</em> </strong>:</p><ul class=""><li id="0e28" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">关注最终的目标配置应该是什么</li><li id="fb1b" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">定义期望的状态，系统执行需要发生的事情以达到期望的状态</li></ul><p id="889d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">Terraform是声明性的，所以现在你知道为什么作为一个软件架构师，我把事情复杂化，我的思想总是集中在如何(总是设计如何)上，但是如果你需要容易地理解Terraform，你应该把你的思想转向什么，这样一切都会变得太容易😉</p><h2 id="bc07" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">为什么要用？</h2><p id="15f3" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">谈到开发和移植，Terraform是一个很好的工具。有理由考虑将Terraform作为IaC工具之一:</p><ul class=""><li id="5bba" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">可移植性:这是Terraform解决的大问题:它使得在同一云提供商的不同环境(开发、前期、生产)中复制基础架构变得容易。此外，因为Terraform完全不受平台限制，所以如果公司决定更换云提供商，它可以为新的云提供商提供编码资源。</li><li id="bf12" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">Terraform允许您在一个配置文件中定义基础设施，并通过将您的代码放在源代码控制(Git)中，构建并部署它，使您能够轻松地跟踪基础设施的变化。</li><li id="aaa7" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">Terraform有一个活跃的社区，并且是开源的，有一个巨大的社区正在围绕这个工具发展。很多人已经在用了，更容易找到知道怎么用的人，插件，扩展，专业支持等等。这也意味着地球正在以更快的速度进化。他们经常发布。</li><li id="23b8" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">Terraform的速度和操作都非常出色。Terraform的一个很酷的地方是，它的plan命令可以让你在应用之前看到你将要应用的改变。</li></ul><h2 id="67d4" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">怎么用？</h2><ul class=""><li id="4780" class="oi oj iq ll b lm od lp oe ls ow lw ox ma oy me on oo op oq bi translated"><a class="ae nl" href="https://www.terraform.io/downloads.html" rel="noopener ugc nofollow" target="_blank">下载最新版本并安装</a></li><li id="53fd" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">选择一个文件夹并创建一个文件。tf扩展并编写这个简单的例子:</li></ul><pre class="ky kz la lb gt oz pa pb pc aw pd bi"><span id="6107" class="nr kg iq pa b gy pe pf l pg ph"># Declare wish provider you want to use<br/>provider "aws" {<br/>   region = "us-east-2"<br/>}</span><span id="2395" class="nr kg iq pa b gy pi pf l pg ph"># Declare a VPC<br/>resource "aws_vpc" "s3m-vpc" {<br/>    cidr_block = "10.0.0.0/16"<br/>    enable_dns_hostnames = true<br/>     tags = {<br/>    "project" = "S3M"<br/>    "tuto"="medium"<br/>  }<br/>}</span></pre><ul class=""><li id="9427" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">在同一个文件夹中，打开一个终端并运行以下命令</li></ul><pre class="ky kz la lb gt oz pa pb pc aw pd bi"><span id="dbbb" class="nr kg iq pa b gy pe pf l pg ph">terraform init</span></pre><blockquote class="mf mg mh"><p id="350c" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">这个命令是为你的云提供商下载所有的依赖项(比如npm install或者开发者的dotnet restore for)</p></blockquote><pre class="ky kz la lb gt oz pa pb pc aw pd bi"><span id="e76c" class="nr kg iq pa b gy pe pf l pg ph">terraform plan </span></pre><blockquote class="mf mg mh"><p id="c1cb" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">该命令用于创建执行计划。除非明确禁用，否则Terraform会执行刷新，然后确定需要执行哪些操作才能达到配置文件中指定的所需状态。</p><p id="747f" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">您可以跳过此命令，直接应用IaC，但是建议您在应用infra之前，先看看您的计划中有什么，并修复错误或缺陷</p></blockquote><pre class="ky kz la lb gt oz pa pb pc aw pd bi"><span id="bf34" class="nr kg iq pa b gy pe pf l pg ph">terraform apply</span></pre><blockquote class="mf mg mh"><p id="6f78" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated"><!-- --><code class="fe pj pk pl pa b">terraform apply</code>命令用于应用所需的更改，以达到所需的配置状态，或者由<code class="fe pj pk pl pa b">terraform plan</code>执行计划生成的一组预先确定的动作。</p></blockquote><ul class=""><li id="430f" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">您现在可以进入您的帐户，验证VPC是否是在<strong class="ll ir">美国东部-2地区</strong>创建的</li><li id="fcbf" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">最后，要销毁您创建的内容，您可以运行以下命令:</li></ul><pre class="ky kz la lb gt oz pa pb pc aw pd bi"><span id="5910" class="nr kg iq pa b gy pe pf l pg ph">terraform destroy</span></pre></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="0487" class="kf kg iq bd kh ki nm kk kl km nn ko kp jw no jx kr jz np ka kt kc nq kd kv kw bi translated">在复杂架构上实现Terraform的技巧</h1><p id="20ee" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">在这一节中，我会给你一些<strong class="ll ir">技巧&amp;窍门</strong>来节省你编写<strong class="ll ir">复杂架构</strong>的时间。</p><p id="f363" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们就拿我之前写的<a class="ae nl" href="https://naoufal-gafa.medium.com/aws-when-serverless-and-microservice-get-married-securely-6585f7856a0f" rel="noopener"> <strong class="ll ir"> S3M模式</strong> </a>来举例。提醒一下这个架构:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi pm"><img src="../Images/69b06d7935f22ca08b35ba37572076bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRuttnmEGGww1pyAZhgXoQ.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">S3M模式</figcaption></figure><div class="mm mn gp gr mo mp"><a href="https://naoufal-gafa.medium.com/aws-when-serverless-and-microservice-get-married-securely-6585f7856a0f" rel="noopener follow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">AWS S3M模式:安全结合无服务器和微服务的5个步骤</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">“使用这种抽象模式来构建复杂的云架构，可以节省您的时间”</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">naoufal-gafa.medium.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd lh mp"/></div></div></a></div><h2 id="9d8d" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated"><strong class="ak"> <em class="pr">提示1:待办事项</em> </strong> <em class="pr">列表</em> <strong class="ak"> <em class="pr">什么</em> </strong> <em class="pr">我们想要的</em>😜：</h2><p id="3280" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">如你所见，对于这个<strong class="ll ir">模式</strong>，我们需要这些<strong class="ll ir">模块</strong>:</p><ol class=""><li id="d1de" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me ps oo op oq bi translated"><strong class="ll ir"> VPC </strong>有三个<strong class="ll ir">子网</strong>(两个<strong class="ll ir">私有</strong>和一个<strong class="ll ir">公有</strong>)</li><li id="4e7f" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated"><strong class="ll ir"> APIGateway </strong>与VPC <strong class="ll ir">链接</strong></li><li id="941b" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated"><strong class="ll ir">授权人</strong>(<strong class="ll ir">λ</strong>和<strong class="ll ir"> API网关</strong>)</li><li id="3d09" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated"><strong class="ll ir"> ECS集群Fargat </strong>带有<strong class="ll ir">任务定义</strong>和<strong class="ll ir">服务</strong></li><li id="3872" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated"><strong class="ll ir"> NLB </strong>(带有<strong class="ll ir">目标组</strong>的网络负载平衡器)</li><li id="61f0" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated"><strong class="ll ir"> S3 </strong>为静态网站托管</li></ol><h2 id="8506" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated"><em class="pr">技巧二:创建一个</em> <strong class="ak"> <em class="pr"> *。tf </em> </strong> <em class="pr">文件用于每个</em> <strong class="ak"> <em class="pr">块</em>😄:</strong></h2><ol class=""><li id="dbd0" class="oi oj iq ll b lm od lp oe ls ow lw ox ma oy me ps oo op oq bi translated">vpc.tf</li><li id="99dd" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">api-gateway.tf</li><li id="138a" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">授权人. tf</li><li id="6a93" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">cluster.tf</li><li id="a0ad" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">负载平衡器. tf</li><li id="7ef6" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">s3.tf</li><li id="1251" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">为了正确地组织我们的代码，我们还可以为不同的策略创建一个文件夹(JSON文件)</li></ol><h2 id="2913" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated"><em class="pr">提示三:将</em> <strong class="ak"> <em class="pr">魔法</em></strong><em class="pr"/><strong class="ak"><em class="pr">复制过去</em>😅</strong></h2><ol class=""><li id="ae63" class="oi oj iq ll b lm od lp oe ls ow lw ox ma oy me ps oo op oq bi translated">O <a class="ae nl" href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="mi">打开AWS </em> </strong> </a>的Terraform文档</li><li id="c823" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">对于每个文件:<strong class="ll ir">复制并粘贴</strong>配置，如下图所示:</li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi pt"><img src="../Images/a0e15f5f6f45c40120891d2479be4233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nNqrxbKK6VHXGezRifwYWg.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">在地形上过滤</figcaption></figure><p id="a6e3" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">因此，举例来说，如果我们用<strong class="ll ir"> S3M模式</strong>来实现文件<strong class="ll ir"> vpc.tf </strong>，它看起来会像这样:</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="pu pv l"/></div></figure><blockquote class="mf mg mh"><p id="be45" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">Y <!-- --> ou可以从<a class="ae nl" href="https://github.com/ngaffa/S3M_IAC" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="iq">这里</em></strong></a><strong class="ll ir"><em class="iq"/></strong>克隆完整的例子，并遵循之前解释的“<strong class="ll ir">如何使用它</strong>”。</p></blockquote><blockquote class="pw"><p id="3081" class="px py iq bd pz qa qb qc qd qe qf me dk translated">如果你在问:<strong class="ak"/>履行订单怎么办？<strong class="ak">！我们应该从VPC、ECS、APIGateway还是……开始？</strong></p><p id="f40e" class="px py iq bd pz qa qg qh qi qj qk me dk translated">答:不是你的问题😝，你不需要关心这个😃，你的工作是描述，而Terraform的工作是定义执行你的员工的最佳方式😉</p></blockquote></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="1d2f" class="kf kg iq bd kh ki nm kk kl km nn ko kp jw no jx kr jz np ka kt kc nq kd kv kw bi translated">DevOps哲学</h1><h2 id="c96b" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">定义</h2><p id="48d9" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">什么是真正的DevOps？<strong class="ll ir"> DevOps不是职称</strong>😠，其实就是一套结合了软件开发(<em class="mi"> Dev </em>)和it运营(<em class="mi"> Ops </em>)的实践。</p><p id="fedf" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">DevOps计划可以通过以下方式为公司带来文化变革:</p><ul class=""><li id="b65d" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">转变运营、开发人员和测试人员在开发和<strong class="ll ir">交付过程中的合作方式</strong>😃。</li><li id="7928" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">让这些团队紧密合作是企业采用DevOps的一个关键挑战😃。</li><li id="db67" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">DevOps不仅关乎工具链，也关乎文化。</li></ul><p id="0979" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir">因此，当一些公司在他们的工作流程中寻找DevOps工程师时，这意味着他们没有准备好改变他们的理念和文化，这可能只会加深开发人员和运营团队之间的脱节</strong>😅<strong class="ll ir">。</strong></p><h2 id="5002" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">工具链</h2><p id="9983" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">DevOps工具适合一个或多个活动，这些活动支持特定的<strong class="ll ir"> DevOps计划</strong>:计划、创建、验证、打包、发布、配置、监控和版本控制。更多信息请点击<a class="ae nl" href="https://en.wikipedia.org/wiki/DevOps_toolchain#Plan" rel="noopener ugc nofollow" target="_blank">此处</a></p><blockquote class="mf mg mh"><p id="e6dc" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">在这个故事中，我将把重点放在这些工具上，以保持简单:<strong class="ll ir">创建(代码)</strong>，<strong class="ll ir">打包(工件)</strong>，<strong class="ll ir">发布(部署)</strong>，<strong class="ll ir">配置(IaC)，版本控制。</strong></p></blockquote></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="4e39" class="kf kg iq bd kh ki nm kk kl km nn ko kp jw no jx kr jz np ka kt kc nq kd kv kw bi translated">使用GitHub动作自动化所有操作:(弄脏你的手)</h1><p id="faf2" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">既然你已经知道了<strong class="ll ir">terra form</strong>&amp;<strong class="ll ir">devo PS</strong>是关于什么的，那么让我们用<strong class="ll ir"> GitHub动作</strong>对<strong class="ll ir">打包</strong>、<strong class="ll ir">发布</strong>、<strong class="ll ir">配置</strong>后端、前端的<strong class="ll ir">交付过程以及IaC (Config) </strong>进行一些自动化吧</p><p id="d940" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> GitHub Actions </strong>通过<strong class="ll ir"> CI/CD </strong>使我们所有软件工作流程的自动化变得更加容易。我们将用它从<strong class="ll ir"> GitHub </strong>中<strong class="ll ir">打包</strong>、<strong class="ll ir">发布、</strong>和<strong class="ll ir">配置</strong>我们的代码。</p><blockquote class="mf mg mh"><p id="cffb" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated"><em class="iq">先决条件</em>:</p><p id="6705" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">→ GitHub账户:你需要一个GitHub账户来克隆我的回购例子，以自动化和建立管道</p><p id="f69e" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">→ Terraform免费帐户:在下面的IAC存储库中解释</p></blockquote><p id="a82b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">对于自动化，我制作了3个管道，每个仓库一个:</p><ol class=""><li id="9847" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me ps oo op oq bi translated"><a class="ae nl" href="https://github.com/ngaffa/S3M_IAC" rel="noopener ugc nofollow" target="_blank"> IaC库</a></li><li id="763d" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated"><a class="ae nl" href="https://github.com/ngaffa/S3M-BackEnd" rel="noopener ugc nofollow" target="_blank"> API存储库</a></li><li id="7a0d" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated"><a class="ae nl" href="https://github.com/ngaffa/S3M-FrontEnd" rel="noopener ugc nofollow" target="_blank">静态网站知识库</a></li></ol><p id="8bb8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如你所见，对于每个回购，我都有一个位于<strong class="ll ir">的<strong class="ll ir"> Yaml </strong>文件。github/工作流</strong>。该文件将由GitHub 的<strong class="ll ir">动作工作流解释，以运行构建和部署的管道。</strong></p><p id="1e6e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">为了更好的理解，所有的Yaml文件都有很好的注释😃</p><ol class=""><li id="6588" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me ps oo op oq bi translated">对于IaC:管道将简单地应用我们的基础设施</li><li id="f710" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">对于API:管道将<strong class="ll ir">在<strong class="ll ir"> docker映像</strong>中封装</strong>我们的包，并将其推送到<strong class="ll ir"> Ecr Repo </strong></li><li id="0d9c" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me ps oo op oq bi translated">对于静态网站；管道将<strong class="ll ir">构建</strong>我们的<strong class="ll ir"> Angular </strong>项目；并<strong class="ll ir">将其部署</strong>到<strong class="ll ir"> S3静态网站托管</strong></li></ol></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h2 id="10de" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">IaC知识库:</h2><p id="ad35" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">要自动部署Terraform IaC代码，您有两种选择:</p><ul class=""><li id="c06e" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">只需使用Github Action:<a class="ae nl" href="https://acloudguru.com/blog/engineering/how-to-use-github-actions-to-automate-terraform" rel="noopener ugc nofollow" target="_blank">https://acloudguru . com/blog/engineering/how-to-use-Github-actions-to-automate-terraform</a></li><li id="7422" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">通过使用Terraform Cloud Api(如下例):<a class="ae nl" href="https://learn.hashicorp.com/tutorials/terraform/github-actions" rel="noopener ugc nofollow" target="_blank">https://learn . hashi corp . com/tutorials/terra form/github-actions</a></li></ul><p id="8e42" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在我们的案例中，我选择使用Terraform Cloud来管理terraform cloud workspace上的所有Terraform员工和工作流，这样团队就可以轻松地管理和批准架构，并且它与terraform的工作流和数据深度集成，这使terraform变得更加方便和强大。</p><p id="4bee" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">因此，首先你应该用Terraform创建一个免费帐户，并遵循以下步骤。</p><p id="58f6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi"> 1-创建你的组织</em> </strong></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ql"><img src="../Images/b7a01fff347734b534afae350c6d41d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZOMx6S8Nyax_c1BC-k_DQ.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">平台组织</figcaption></figure><p id="c8c5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">一旦创建了组织，就该创建工作流了</p><p id="c52d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi"> 2-创建工作流</em> </strong></p><p id="788b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">为此，点击API驱动的工作流，如下图所示，并创建您的工作流</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qm"><img src="../Images/37bbfbb5bf639235a2f6c907b50e4597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLlg00_iE0nv-YHaOnurtw.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">Terraform工作流程</figcaption></figure><p id="2968" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">命名您的工作空间并创建它</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qn"><img src="../Images/c15029a5ff429b58b98ba3bbdf6c7706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v17EBC10ZMfJjmp3_uQSQA.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">地形工作空间</figcaption></figure><p id="14cb" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">创建工作空间后，terraform将为您生成这段代码，以便在您的存储库中的主配置文件(<strong class="ll ir"> main.tf) </strong>中使用。</p><p id="ad75" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">所以，复制粘贴这段代码(完整的例子可以在我的报告中找到<a class="ae nl" href="https://github.com/ngaffa/S3M_IAC" rel="noopener ugc nofollow" target="_blank"/></p><pre class="ky kz la lb gt oz pa pb pc aw pd bi"><span id="dfe8" class="nr kg iq pa b gy pe pf l pg ph">terraform {<br/>  backend "remote" {<br/>    organization = "your organization name"</span><span id="7673" class="nr kg iq pa b gy pi pf l pg ph">workspaces {<br/>      name = "your workspace name"<br/>    }<br/>  }<br/>}</span></pre><p id="e3dc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi"> 3-生成Terraform云用户API令牌:</em> </strong></p><ul class=""><li id="2f23" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">转到:<a class="ae nl" href="https://app.terraform.io/app/settings/tokens" rel="noopener ugc nofollow" target="_blank">https://app.terraform.io/app/settings/tokens</a>并点击<strong class="ll ir">“创建API令牌”</strong></li></ul><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qo"><img src="../Images/d0fbfe34f17d43ed417af2d5efb66d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wZHZSH8BDFZ9xXMsypFChQ.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">Terraform用户API令牌</figcaption></figure><ul class=""><li id="8ff0" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">给它一个描述以帮助您稍后识别这个令牌，然后单击<strong class="ll ir">“创建API令牌”</strong></li></ul><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/8cee64573e537f20def3b297b2831045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*uKrOKCfSIU8HFAKlR5WH9g.png"/></div></figure><ul class=""><li id="3889" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">复制生成的令牌</li></ul><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi qq"><img src="../Images/878bfd07516c956a6eef8b5cfcca7ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*uIgG071gxjqWPUs20XXP3w.png"/></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">地形生成的令牌</figcaption></figure><p id="344a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi"> 4-将生成的令牌作为GitHub秘密存储在IaC存储库:</em> </strong></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qr"><img src="../Images/0ac265ca3ab9cf184d3bcb42b1371de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w88mmV0mdWCaBdFqH22b3w.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">回购秘密</figcaption></figure><p id="a4fa" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">你可以点击查看<a class="ae nl" href="https://docs.github.com/en/actions/reference/encrypted-secrets#creating-encrypted-secrets-for-a-repository" rel="noopener ugc nofollow" target="_blank"> GitHub文档。</a></p><p id="b3be" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi"> 5-在Terraform Cloud环境变量上存储AWS键:</em> </strong></p><p id="da30" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们需要将我们的<strong class="ll ir"> AWS访问密钥</strong>和<strong class="ll ir">秘密密钥</strong>保存在T <strong class="ll ir"> erraform环境变量</strong>上，因此当Github管道运行时，它将使用这些凭证来<strong class="ll ir">计划</strong>和<strong class="ll ir">将我们的</strong>应用到下面的<strong class="ll ir"> AWS帐户</strong>。</p><p id="d872" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">为此，请访问<a class="ae nl" href="https://learn.hashicorp.com/tutorials/terraform/cloud-workspace-configure" rel="noopener ugc nofollow" target="_blank">https://learn . hashi corp . com/tutorials/terra form/cloud-workspace-configure</a>并遵循以下步骤</p><ul class=""><li id="6a53" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">添加环境变量</li></ul><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qs"><img src="../Images/dedd55102d109529f8d71e843b406192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9veCwKXqQZDlGfP1HdQTg.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">创建Terraform环境变量</figcaption></figure><ul class=""><li id="094e" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">创建这两个环境变量，并使它们对<strong class="ll ir">敏感</strong>:</li></ul><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qt"><img src="../Images/9e9a3ccf0f7bbfb0f57ea5f47556f1c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtoRfvx7AU-4hv2H5un5Rg.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">地球秘密</figcaption></figure><p id="51f1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">想了解更多关于在Terraform上管理秘密的信息，你可以关注这个<a class="ae nl" href="https://blog.gruntwork.io/a-comprehensive-guide-to-managing-secrets-in-your-terraform-code-1d586955ace1" rel="noopener ugc nofollow" target="_blank">博客</a></p><p id="cc0c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> <em class="mi"> 6-在GitHub上运行您的管道</em> </strong></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qu"><img src="../Images/bfc3224906e75e3160b6a208e8878696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zul6f4vfq2plY6Szm9uvWQ.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">GitHub管道</figcaption></figure><h2 id="2206" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">API存储库:</h2><p id="eda9" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">在部署了我们的基础设施之后，现在是时候部署我们的API了，否则，管道将简单地将一个docker映像推入ECR(仅此而已😄)</p><p id="8782" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">不要忘记在您的<strong class="ll ir"> API库</strong>的秘密中添加<strong class="ll ir"> AWS_ACCESS_KEY_ID </strong>和<strong class="ll ir"> AWS_SECRET_ACCESS_KEY </strong>，并通过<strong class="ll ir"> GitHub Action选项卡</strong>运行管道</p><p id="db46" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">完整的例子可以在<a class="ae nl" href="https://github.com/ngaffa/S3M-BackEnd" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">这里找到</strong> </a></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qv"><img src="../Images/549038f5d73e5d39599f65cf455e2ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O_-uFuJ2UxnjkCo2pjxAMQ.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">API秘密</figcaption></figure><h2 id="18b2" class="nr kg iq bd kh ns nt dn kl nu nv dp kp ls nw nx kr lw ny nz kt ma oa ob kv oc bi translated">静态网站存储库:</h2><p id="a0aa" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">因为我们没有将自定义域名附加到我们的<strong class="ll ir"> API网关</strong>上，所以我们应该复制由IaC部署生成的<strong class="ll ir">端点</strong>，并将其传递到<strong class="ll ir">静态网站</strong>的环境变量中</p><blockquote class="mf mg mh"><p id="6bfc" class="lj lk mi ll b lm ln jr lo lp lq ju lr mj lt lu lv mk lx ly lz ml mb mc md me ij bi translated">另一个更复杂的选择是将环境变量存储在配置管理器中，如(AWS secrets manager)或使用云不可知工具，如<a class="ae nl" href="https://github.com/mozilla/sops" rel="noopener ugc nofollow" target="_blank"> SOPS </a></p></blockquote><p id="5e4b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">1-转到您的<strong class="ll ir"> APIGateway仪表板</strong>，点击创建的<strong class="ll ir"> API </strong>，转到<strong class="ll ir">阶段</strong>和<strong class="ll ir">复制</strong>端点</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qw"><img src="../Images/238dd9e3af70e27c54c95211ee78e834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pMtY6dZ_vMzyxckd2ll5gw.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">API网关端点</figcaption></figure><p id="ec0e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">2-转到您的<strong class="ll ir">静态网站库</strong>，更新环境文件并提交</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qx"><img src="../Images/ea56c09919f75f20e03965eb71210259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gnUCJyi4X_pCOyzvRxFAcg.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">静态网站环境</figcaption></figure><p id="c0e7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">3-运行您的管道(不要忘记在您的API存储库的秘密中添加<strong class="ll ir"> AWS_ACCESS_KEY_ID </strong>和<strong class="ll ir"> AWS_SECRET_ACCESS_KEY </strong>，并通过<strong class="ll ir"> GitHub Action选项卡运行管道)</strong></p><p id="29d6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">4-通过进入你的<strong class="ll ir"> s3静态网站端点</strong>，复制链接，粘贴到你的浏览器，点击<strong class="ll ir">“获取天气”</strong>按钮，检查是否一切正常</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qy"><img src="../Images/f3e5f2ef1e35bd22d9cecf191540769f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6FDVWNwXZ46PA6G9Ee7GJw.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">S3链接</figcaption></figure><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi qz"><img src="../Images/9e3a5accf486cd8b9b5bb0a1ed3b3893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGJcf-74jCf4XeH9JANDWQ.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">最后检查</figcaption></figure><p id="d0fd" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">Greaaaaaaaaaat，一切都自动化了，像魔法一样工作😄</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="98c8" class="kf kg iq bd kh ki nm kk kl km nn ko kp jw no jx kr jz np ka kt kc nq kd kv kw bi translated">结论</h1><p id="2878" class="pw-post-body-paragraph lj lk iq ll b lm od jr lo lp oe ju lr ls of lu lv lw og ly lz ma oh mc md me ij bi translated">在现实生活中，<strong class="ll ir">编码</strong>和<strong class="ll ir">管理</strong>基础架构的源代码是一件很棒的事情，因为它允许<strong class="ll ir">公司架构师</strong>遵循所有的<strong class="ll ir">变更集</strong>，并且只应用变更，而不会破坏所有的基础架构。</p><p id="03e1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在现实生活中，<strong class="ll ir">编码</strong>和<strong class="ll ir">管理</strong>下面的<strong class="ll ir">源代码是一件很棒的事情，因为它允许<strong class="ll ir">公司架构师</strong>跟上所有的变化，并且只应用<strong class="ll ir">必要的更新</strong>而不破坏整个系统。</strong></p><p id="572b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> IaC理念</strong>也促进了<strong class="ll ir">基础设施</strong>的<strong class="ll ir">可移植性</strong></p><ul class=""><li id="e7a6" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated"><strong class="ll ir">不同云提供商之间</strong></li><li id="9b76" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">不同<strong class="ll ir">环境</strong>的<strong class="ll ir">同一个</strong>云提供商之间</li></ul><p id="a116" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当我们将IaC与<strong class="ll ir"> real DevOps哲学</strong>捆绑在一起时，我们节省了更多的流程<strong class="ll ir">交付</strong>的时间，同时<strong class="ll ir">保持了</strong>更好的<strong class="ll ir">质量<strong class="ll ir">代码</strong>。</strong></p><p id="26dd" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果你是这些技术的新手<strong class="ll ir"> (AWS，IaC，DevOps) </strong>，这个博客将帮助你理解不同砖块<strong class="ll ir"> (AWS，IaC，DevOps) </strong>的顺序，并且将阻止你跟随许多教程和去各个方向。</p><p id="3818" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我想顺便感谢Soufian Belehrache的技术建议。</p><p id="9423" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果您有任何意见，或者有什么不清楚的地方，请在我的<a class="ae nl" href="https://www.facebook.com/neogafa" rel="noopener ugc nofollow" target="_blank"> Fb页面</a>、<a class="ae nl" href="https://twitter.com/NaoufalGafa" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或通过<a class="ae nl" href="https://www.elgafa.com/" rel="noopener ugc nofollow" target="_blank">我的网站</a>发表评论或联系我</p><p id="7c0e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">最后，我有一个挑战给你:</p><ul class=""><li id="27b9" class="oi oj iq ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">如果您还没有GitHub帐户，请创建一个</li><li id="7c16" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">创建一个Terraform免费帐户</li><li id="960b" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">运用你在这个故事中学到的东西<strong class="ll ir"> <em class="mi">“用GitHub动作自动化所有的部分:(弄脏你的手)</em> </strong></li><li id="a4a7" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated">祝您好运</li></ul><p id="0083" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">下一个故事再见，✌️.</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="31d0" class="kf kg iq bd kh ki nm kk kl km nn ko kp jw no jx kr jz np ka kt kc nq kd kv kw bi translated">参考</h1><ul class=""><li id="bc5e" class="oi oj iq ll b lm od lp oe ls ow lw ox ma oy me on oo op oq bi translated"><a class="ae nl" href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs" rel="noopener ugc nofollow" target="_blank">AWS提供商的Terraform文档</a></li><li id="cf5a" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated"><a class="ae nl" href="https://en.wikipedia.org/wiki/Terraform_(software)" rel="noopener ugc nofollow" target="_blank">地形定义</a></li><li id="7851" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated"><a class="ae nl" href="https://blog.gruntwork.io/an-introduction-to-terraform-f17df9c6d180" rel="noopener ugc nofollow" target="_blank">地形介绍</a></li><li id="70ee" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated"><a class="ae nl" href="https://www.chakray.com/creating-fargate-ecs-task-aws-using-terraform/" rel="noopener ugc nofollow" target="_blank">创建Fargate ECS任务</a></li><li id="9ddb" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated"><a class="ae nl" href="https://github.com/alex/ecs-terraform/blob/master/services.tf" rel="noopener ugc nofollow" target="_blank">带地形的ECS</a></li><li id="7ef0" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated"><a class="ae nl" href="https://gist.github.com/mendhak/8303d60cbfe8c9bf1905def3ccdb2176" rel="noopener ugc nofollow" target="_blank">带地形的授权人</a></li><li id="e481" class="oi oj iq ll b lm or lp os ls ot lw ou ma ov me on oo op oq bi translated"><a class="ae nl" href="https://en.wikipedia.org/wiki/DevOps#:~:text=DevOps%20is%20a%20set%20of,delivery%20with%20high%20software%20quality." rel="noopener ugc nofollow" target="_blank"> DevOps </a></li></ul></div></div>    
</body>
</html>