<html>
<head>
<title>Wrapping Your Head Around Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">把你的头缠在Docker身上</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/wrapping-your-head-around-docker-27b94deadfc8?source=collection_archive---------1-----------------------#2019-08-10">https://levelup.gitconnected.com/wrapping-your-head-around-docker-27b94deadfc8?source=collection_archive---------1-----------------------#2019-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1240c6e9b36219735f9c22d6b2a3546f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8gaauCIDfhu0YrgB6vzm7A.jpeg"/></div></div></figure><p id="47b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我经常发现软件工程师(包括我自己)在一项技术的兴奋中有点迷失，而没有给予它实际解决的问题足够的关注。几年前，当我第一次接触Docker时，它正处于热潮之中，很难浏览并将其作为解决方案。</p><p id="7e25" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我的意图不是把它作为一个银弹呈现给每一个用例，而是试图帮助您理解它所解决的问题，让您对容器技术及其工作原理有一点熟悉。</p><h1 id="0d0a" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">从顶部的Docker</h1><p id="22f8" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">首先，Docker通过提供<strong class="kd iu">一致性</strong>来提供帮助。当您将代码部署到产品中时，您不必担心不同的环境。这是一种容器技术，它本质上允许您构建这个环境，并将其打包到一个盒子中，然后运送到某个地方。多棒啊。</p><p id="eb8c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个包装盒中有您成功运行软件所需的一切。它为软件正确运行提供了必要的隔离。这就产生了<strong class="kd iu">一致性</strong>，因为机器拥有运行所需的一切。</p><p id="f4b3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，Docker是一个围绕创建和运行容器的平台或生态系统。</p><p id="51d2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可能听说过一些类似于<em class="mc"> Docker镜像、Docker客户端、Docker服务器、Docker Hub </em>和<em class="mc"> Docker容器</em>的术语。让我们来探索这些，因为它们是掌握这项技术的基础。</p><h1 id="35ba" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">什么是Docker图像？</h1><p id="38e0" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">它是一个文件，包含运行程序所需的所有依赖项和配置。</p><p id="aafe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，通过运行命令<code class="fe md me mf mg b">docker run -it redis</code>,<a class="ae mh" href="https://docs.docker.com/docker-for-windows/install/" rel="noopener ugc nofollow" target="_blank">Docker CLI</a>到达<a class="ae mh" href="https://docs.docker.com/docker-hub/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>并下载一个名为映像的文件，该文件包含运行一个特定程序所需的所有依赖项和配置。这个单独的文件(图像)存储在硬盘上，用于创建一个容器。容器是图像的一个实例，可以看作是一个运行的程序。</p><p id="b1dc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如该网站所述，<a class="ae mh" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>是Docker提供的一项服务，用于查找和共享容器图像。</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mi"><img src="../Images/0e0eb58cda0295bfa3991ecdbc394b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DFTcJUnoqMITQzs_NwrJ6w.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">码头枢纽</figcaption></figure><h1 id="d67c" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">什么是Docker容器？</h1><p id="377a" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">它是映像的一个实例，使用自己的一组独立硬件资源运行特定的程序。它有自己的一套内存，自己的一套联网技术，自己的一套硬盘空间。</p><h1 id="c239" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">为什么要用Docker？</h1><p id="a1b2" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">Docker让安装和运行软件变得非常容易，而不用担心安装和依赖。</p><p id="bbce" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">运行<code class="fe md me mf mg b">docker run</code>命令启动Docker客户端或CLI，它负责从用户那里获取命令并对它们进行处理，然后与Docker服务器进行通信。docker服务器负责繁重的工作。</p><p id="f808" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">通过给Docker客户端命令<code class="fe md me mf mg b">docker run hello-world</code>，它将被发布到Docker服务器，一系列的动作将在后台发生。Docker服务器将会看到我们正在尝试使用一个名为<em class="mc"> hello-world </em>的映像启动一个新容器。Docker服务器要做的第一件事是检查它是否在你的机器上有一个<em class="mc"> hello-world </em>图像的本地副本。docker服务器向docker集线器寻求特定的图像。</p><p id="46a8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果Docker Hub有映像的副本，Docker服务器会下载该文件，并将其存储在您的个人计算机上的Docker映像缓存中，以后可以非常快速地重新运行该文件，而不必从Docker Hub重新下载。</p><p id="47ca" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Docker服务器然后使用图像缓存中下载的图像创建一个容器实例，方法是将它加载到计算机的内存中<br/>，并在其中运行一个程序。对于<em class="mc"> hello-world </em>程序，它的唯一目的是在终端中打印一条消息。</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mr"><img src="../Images/ab454ef8e9c01534445c0c1ae7de9d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cg_wdzpS-Me6_CQyL1pHiA.jpeg"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">蓝色容器</figcaption></figure><h1 id="4cf8" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">关于什么是容器的更多细节</h1><p id="5273" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">大多数操作系统都有内核。内核是一个正在运行的软件进程，它管理计算机上运行的所有程序与计算机的所有物理硬件组件(CPU、内存、硬盘)之间的访问。内核是控制机器上运行的所有程序和机器的物理组件之间的访问的中间层。正在运行的程序通过系统调用与内核交互。这些就像函数调用。</p><p id="30e7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">假设您想要运行两个独立的程序，每个程序都有不同的依赖关系，不能作为硬盘上的安装程序共存。我们如何解决这个问题？有一个操作系统特性叫做<em class="mc">命名空间</em>。使用<em class="mc">命名空间</em>，我们可以查看连接到我们计算机的所有其他不同的<br/>硬件资源，并且我们可以分割出这些资源的一部分。因此，我们可以将硬盘的一部分分割成一个特定的依赖项，另一部分用来存放另一个依赖项。</p><p id="00cd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">每当一个程序需要通过发出一个系统调用从硬盘上读取信息来访问硬盘上的依赖关系<br/>时，内核就会查看这个系统调用，并判断出它来自哪个进程。因此，如果一个特定的程序试图访问硬盘上的一个资源，内核会计算出来，它会将调用指向相关的硬盘段。通过利用这种<em class="mc">命名空间</em>或分段特性，我们能够确保具有不同依赖关系的程序能够在同一台机器上运行。</p><p id="96e7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据请求硬件资源的进程分割硬件资源的整个过程被称为<em class="mc">命名空间</em>。</p><p id="b1ec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">命名空间</strong> —隔离每个进程的资源，包括硬件进程、硬盘、网络、用户、主机名和进程间通信。因此，每当一个进程请求一个特定的资源时，它将被定向到给定硬件的一个特定段。<br/>命名空间不仅限于硬件组件，也可用于软件元素。另一个与命名空间相关的概念是控制组。</p><p id="64b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">控制组(cgroups) </strong> —控制组用于限制进程可以使用的资源量。</p><p id="55c4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">简而言之，命名空间用于说明这个特定的资源或硬盘驱动器的一部分是用于这个进程的，控制组用于限制一个进程可以使用的内存量、CPU使用量、网络带宽量和硬盘驱动器I/O量。</p><p id="47d4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这两个特性结合在一起，允许我们隔离单个进程，并限制它可以对话的资源量和它使用的带宽量。</p><figure class="mj mk ml mm gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="df7a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正在运行的进程的整个组件以及它可以与之对话的资源段就是我们所说的<strong class="kd iu">容器</strong>。</p><p id="7bfb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它不是一个物理结构。它是一个容器，是一个进程或一组进程，有一组专门分配给它的资源。</p><p id="d8df" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="mc">容器</em>是一个正在运行的进程，它对内核进行系统调用，内核查看传入的系统调用，并将其定向到硬盘、RAM、网络和/或CPU的特定部分，或者它可能需要的任何其他部分。<br/>这些资源的一部分可用于该进程。</p><p id="b91e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="mc">映像</em>是文件系统快照。它是一组非常特定的目录或文件的副本。一个映像还将包含一个非常具体的启动命令。</p><h1 id="c51a" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">幕后:将图像变成容器</h1><p id="d36a" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">内核隔离硬盘驱动器的一部分，并使其仅可用于容器，映像内的文件系统快照被获取并放置在硬盘驱动器的专用(或隔离)部分。</p><p id="2ed8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后执行启动命令，创建流程的实例，然后将创建的流程隔离到容器内的这组资源。</p><p id="e19b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">容器是一个正在运行的进程，以及机器上专门分配给该进程的物理资源的子集。</p><p id="3590" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">图像就是这样变成一个运行的容器的。</p><figure class="mj mk ml mm gt ju"><div class="bz fp l di"><div class="mu mt l"/></div></figure><p id="494d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">命名空间和控制组的这些特性是特定于Linux操作系统的。那么，如果这些都是Linux的特性，那么这种神奇是如何在Mac或Windows机器上发生的呢？</p><p id="1620" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当您安装Docker for Windows或Mac时，您会安装一个Linux虚拟机。在虚拟机内部，是创建和托管容器的地方。Linux VM有一个在容器内部运行进程的Linux内核。</p><p id="a788" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">同一个Linux内核负责限制或约束对机器上不同硬件资源的访问。</p><p id="44e7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你喜欢这篇文章，请在这里给我买杯咖啡<a class="ae mh" href="https://www.buymeacoffee.com/lukemwila" rel="noopener ugc nofollow" target="_blank">☕️</a>😃。</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><p id="14f5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">docker还有很多值得学习和探索的地方，<a class="ae mh" href="https://docs.docker.com/" rel="noopener ugc nofollow" target="_blank">文档</a>非常优秀，所以我强烈建议你尝试创建Docker图像和容器。不要害怕犯错误，这是学习的最好方法之一😉。</p><p id="8a71" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里有一些有用的docker命令的链接。</p><p id="fdaf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">参考资料:</p><div class="nc nd gp gr ne nf"><a href="https://docs.docker.com/" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">码头文件</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">预计阅读时间:2分钟尝试我们的多部分演练，包括编写您的第一个应用程序、数据存储…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">docs.docker.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt jz nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a href="https://geekflare.com/understanding-docker-for-beginner/" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">初学者了解Docker容器技术</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">了解Docker容器Docker是一个使用容器来创建、部署和运行…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">geekflare.com</p></div></div><div class="no l"><div class="nu l nq nr ns no nt jz nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a href="https://www.tutorialspoint.com/docker/docker_architecture" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">码头建筑</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">下图显示了虚拟化的标准和传统架构。服务器是物理的…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">www.tutorialspoint.com</p></div></div><div class="no l"><div class="nv l nq nr ns no nt jz nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a href="https://www.udemy.com/docker-and-kubernetes-the-complete-guide/" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">Docker和Kubernetes:完全指南</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">如果你厌倦了学习如何部署web应用程序，那么这就是适合你的课程。CI+CD…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">www.udemy.com</p></div></div><div class="no l"><div class="nw l nq nr ns no nt jz nf"/></div></div></a></div></div></div>    
</body>
</html>