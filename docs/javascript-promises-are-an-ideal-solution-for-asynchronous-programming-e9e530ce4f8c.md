# JavaScript 承诺:异步编程的理想解决方案

> 原文：<https://levelup.gitconnected.com/javascript-promises-are-an-ideal-solution-for-asynchronous-programming-e9e530ce4f8c>

## 保证！！！这都是关于承诺

> 最好的程序员并不比优秀的程序员强多少。无论用什么标准来衡量，他们都要好得多:概念、创造力、速度、设计的独创性或解决问题的能力。—兰德尔-斯特罗斯公司

![](img/0d5dcd74b75332f1296d716b1bbbb5d4.png)

图片由 [katrina holmgren](https://unsplash.com/@kmholmgren92?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 在 [Unsplash](https://unsplash.com/s/photos/promise?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄

让我们假设一对夫妇正计划去度假，这是两个人之间的对话。

> 艾玛:嘿！你能找到最优惠的价格并预订机票吗？
> 
> 无极先生:当然！
> 
> 艾玛:同时，我会准备行李，但是一定要让我知道你是否找到机票。
> 
> 诺言先生:如果我没有找到任何票呢？
> 
> 艾玛:如果你找到票，给我发信息说预订成功(成功回拨)。如果你没有找到他们，给我发消息说假期推迟了(失败的回电)。

听起来很有趣，对吗？在本文中，我将讨论:

1.  什么是承诺？
2.  如何使用它们？
3.  使用承诺的利弊。

Javascript 是单线程脚本语言。正如所写的那样，每件事都按照**顺序**一行一行地发生。但是异步操作按照它们完成的顺序发生。承诺是处理异步代码的标准方式。

假设您试图使用 web API 调用来检索数据，您可能会得到无效数据或检索数据时出错。但是您的工作是只显示有效的数据。这里，web API 调用是一个异步操作。在这个场景中，Promise 通过两个参数 resolve 和 reject 来帮助您，这两个参数分别由成功和失败操作填充。

承诺有三种状态:

1.  待定:等待回应
2.  解决:成功发生
3.  拒绝:出现故障

让我们用一个例子来深入研究一下承诺。假设你今年对自己有三个承诺，分别是购买手机、自行车和汽车。

# 创造承诺

从你的第一个承诺开始，你去一个陈列室购买手机，你可能会用几个手机来探索决定。探索手机需要时间，并且是异步操作。搜索后，您可能会得到一部手机(解决承诺)或没有购买手机(拒绝承诺)。

移动承诺创建

这里我们创建了一个 JavaScript promise 对象，它有两个参数，称为 resolve 和 reject。在消费一个承诺的过程中，如果承诺被解析，我们就使用 then()函数获取值。如果承诺被拒绝，那么我们会在 catch()函数中得到一条错误消息。

## 履行诺言

您最终找到了您想要的手机，这意味着解决了 promise，promise 将向 then()函数发送一条消息。

消费移动承诺

# 承诺。所有

到目前为止，我们处理了一个购买手机的承诺，但是您还有两个承诺，对吗？？购买自行车和汽车。我们可以使用 Promise.all 一次运行多个 promise

1.  all 再次成为一个承诺，并等待所有的承诺被解决或一个被拒绝。
2.  如果所有的承诺都被解析，那么 Promise.all 将通过来自已解析承诺(输入承诺)的一组消息来解析。
3.  如果只有一个承诺被拒绝，那么 Promise.all 将被拒绝，原因来自 iterable 中第一个被拒绝的承诺。

创造其他承诺以及类似的移动。

自行车和汽车承诺创造

我们创造了手机、自行车和汽车的所有承诺。我们的下一步是一次性运行所有的承诺以节省时间。

承诺。所有

如果您的任何一个移动/自行车/汽车承诺被拒绝，则上述承诺将被拒绝；如果数组中的所有承诺都被解析，则 Promise.all 被解析。

# 承诺链

假设你想先买自行车后买车，移动后买自行车。这意味着您的购买依赖于其他购买，因为我们希望按顺序进行。我们称之为承诺链。

承诺链

这里，我们在另一个承诺的 then/catch 块中返回承诺对象。当且仅当当前承诺被解决或拒绝时，运行其他承诺。

如果任何一个承诺被拒绝，我们将进入 catch()块。当您希望仅在从 web 服务接收数据后刷新网格时，可以使用这种方法。

# 承诺的缺点

是的，承诺用于异步操作，但也有一些缺点。

1.  需要写很多代码，我们必须写。然后，创建一个匿名函数来处理响应或给出响应名称。对于链接，我们必须嵌套代码。
2.  如果我们在回调函数中得到任何错误，我们需要做显式的错误处理。
3.  在一个链条中管理多个承诺是非常困难的。当一个链中有 10 个承诺时，从承诺链返回的错误没有给出错误发生在哪里的线索。

> 为了克服承诺，JavaScript 引入了异步/等待选项。Async/await 允许您构建清晰易读的代码来处理异步操作。

您可以查看下面的文章，了解 Async/Await 以及它们如何兑现承诺的清晰图片。

[](/asynchronous-programming-in-javascript-9fff87cb7df1) [## JavaScript 中的异步编程

### 异步/等待的最佳用途

levelup.gitconnected.com](/asynchronous-programming-in-javascript-9fff87cb7df1) 

> 希望你喜欢它！在下一篇文章中，我将介绍 async/await 操作，并让它变得更有趣。