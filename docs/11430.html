<html>
<head>
<title>Convert Percentage String to Numeric (and Vice Versa) in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Pandas中将百分比字符串转换为数字(反之亦然)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/convert-percentage-string-to-numeric-and-vice-versa-in-pandas-18a3d66e2853?source=collection_archive---------0-----------------------#2022-03-16">https://levelup.gitconnected.com/convert-percentage-string-to-numeric-and-vice-versa-in-pandas-18a3d66e2853?source=collection_archive---------0-----------------------#2022-03-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f2a6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫初学者的数据清理和格式化技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6530a17b4fa96bda31257ce1f707ff22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCyp5HmeFwjbG2PG_0WGMg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/illustrations/panda-clipart-face-animal-sticker-2308269/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>(作者修改)</figcaption></figure><p id="22d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在数据世界中，原始数据很少以现成的格式出现在我们面前。在我们进入数据分析或建模阶段之前，几乎总是需要某种程度的数据清理、争论和格式化。</p><p id="e9e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上周我在博客中写了几篇文章，旨在帮助初学者节省一些时间，了解如何在熊猫中完成一些非常常见但有点棘手的数据争论任务。我希望这些简短的教程和代码片段对您有所帮助，并且非常方便(本文末尾提供了链接)。在这篇文章中，我将继续与您分享另一段代码，它处理一个非常常见的数据争论任务:将百分比字符串列转换为数字，反之亦然。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="63af" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">将百分比字符串转换为数字</h2><p id="a69a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">让我们来看一个简单的例子，使用我从Realtor.com的开放数据集中创建的样本数据框架。原始数据可以从<a class="ae ky" href="https://www.realtor.com/research/data/" rel="noopener ugc nofollow" target="_blank">这里</a>免费下载。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/fa2ab46888a2a5f8348d3f28312dda88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqpSCFYf6UG97iWsxdpyIg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="e7df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此示例数据框架中，我们可以看到median_listing_price_yy和active_listing_count_yy显示为百分比，并被视为字符串。这在以报告形式呈现表格时可能没问题，但对我们来说不可能对它们执行任何有意义的数学运算或分析，因为它们不是数字变量。我们如何将这些百分比字符串转换成数字数据类型？</p><p id="1a08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的解决方案是先用<code class="fe nb nc nd ne b">pandas.Series.str.rstrip()</code>方法去掉尾部的“%”字符，然后用<code class="fe nb nc nd ne b">astype(float)</code>把它转换成数字。您也可以使用<code class="fe nb nc nd ne b"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.lstrip.html#pandas.Series.str.lstrip" rel="noopener ugc nofollow" target="_blank">Series.str.lstrip</a>()</code>删除序列中的前导字符，使用<code class="fe nb nc nd ne b"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.lstrip.html#pandas.Series.str.lstrip" rel="noopener ugc nofollow" target="_blank">Series.str.strip</a>()</code>删除序列中的前导字符和尾随字符。</p><p id="9da8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是使用我们的示例将百分比字符串转换为数字的代码片段:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="8681" class="mc md it ne b gy nj nk l nl nm">df['median_listing_price_yy'] = df['median_listing_price_yy'].str.rstrip("%").astype(float)/100</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/81b49ba277e845562a265fd4859eb79e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3XNu3ak7ugZ68JhGyexDA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="0d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想改变小数位数，比如说2个小数点，你可以用下面的代码来实现:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="b087" class="mc md it ne b gy nj nk l nl nm">pd.options.display.float_format = '{:,.2f}'.format</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/96bd8058e49ab803fb1770d71a74d7f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mcw14ZGdv4vk9mwt6ofFLA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="c332" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">将数字转换成百分比字符串</h2><p id="9d3a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">现在，如何反过来将数字转换回百分比字符串呢？要将其转换回百分比字符串，我们需要使用python的字符串格式语法<code class="fe nb nc nd ne b">'{:.2%}’.format </code>来添加“%”符号。然后，我们使用python的<code class="fe nb nc nd ne b">map()</code>函数进行迭代，并将格式应用于“median_listing_price_yy”列中的所有行。</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="6641" class="mc md it ne b gy nj nk l nl nm">df.loc[:, "median_listing_price_yy"] =df["median_listing_price_yy"].map('{:.2%}'.format)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/7a1e3fb4b157cc8aae1c8f5799f0c0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkjFmxqJ09POKDOUppwJ4Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="1116" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，如果您的Pandas数据帧中有一个百分比字符串列，并希望将其转换为数字/浮点数，请使用以下代码:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="ba14" class="mc md it ne b gy nj nk l nl nm">df[column] = df[column].str.rstrip("%").astype(float)/100</span></pre><p id="245a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有一个数字列，并希望将其转换为百分比字符串，请使用以下代码:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="9dee" class="mc md it ne b gy nj nk l nl nm">df.loc[:, column] = df[column].map('{:.2%}'.format)</span></pre><p id="6a72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！我希望这篇简短的教程对你有所帮助。如果你感兴趣的话，这里有更多关于数据清理和格式化的熊猫初学者教程。</p><div class="nq nr gp gr ns nt"><a href="https://towardsdatascience.com/clean-a-numeric-id-column-in-pandas-dataframe-fbe03c11e330" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">清理熊猫数据框中的“数字”ID列</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">熊猫初学者的一段方便的代码</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">towardsdatascience.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh ks nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a href="https://towardsdatascience.com/apply-thousand-separator-and-other-formatting-to-pandas-dataframe-45f2f4c7ab01" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">对熊猫数据帧应用千位分隔符(和其他格式)</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">通过学习这些有用的熊猫格式技巧，为自己节省一些谷歌搜索时间</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">towardsdatascience.com</p></div></div><div class="oc l"><div class="oi l oe of og oc oh ks nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a href="https://towardsdatascience.com/why-and-how-to-reshape-a-pandas-dataframe-from-wide-to-long-ca90c89156b9" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">为什么以及如何将熊猫数据框由宽变长</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">一段简单的代码就完成了这个任务</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">towardsdatascience.com</p></div></div><div class="oc l"><div class="oj l oe of og oc oh ks nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a href="https://medium.com/codex/how-to-batch-rename-columns-in-pandas-based-on-patterns-7d2382b5fc9a" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">如何基于模式批量重命名Pandas中的列</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">分享一段简单的代码，希望对你有所帮助！</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="ok l oe of og oc oh ks nt"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="72e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以通过这个<a class="ae ky" href="https://medium.com/@insightsbees/membership" rel="noopener">推荐链接</a>注册Medium会员(每月5美元)来获得我的作品和Medium的其他内容。通过这个链接注册，我将收到你的会员费的一部分，不需要你额外付费。谢谢大家！</p></div></div>    
</body>
</html>