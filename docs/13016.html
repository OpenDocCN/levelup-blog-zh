<html>
<head>
<title>Speed up your Website by Converting your Images to WebP using the Terminal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用终端将您的图像转换为WebP，加速您的网站</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/speed-up-your-website-by-converting-your-images-to-webp-from-terminal-3bbeb118dd1?source=collection_archive---------13-----------------------#2022-07-31">https://levelup.gitconnected.com/speed-up-your-website-by-converting-your-images-to-webp-from-terminal-3bbeb118dd1?source=collection_archive---------13-----------------------#2022-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/48a6fb93002bc44da02356c74b4102d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RKQ6jWsAS8P_ps80WGp1LQ.png"/></div></div></figure><p id="cd94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">.webp</code>格式是一种被广泛支持的压缩图像格式，在网络上越来越普遍。将您的图像存储为<code class="fe kw kx ky kz b">.webp</code>可以减小您的网页大小，同时仍然保持您需要的图像质量。图像大小的节省可能非常显著，这意味着您的页面将加载得更快。</p><p id="58bc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想把一张图片转换成<code class="fe kw kx ky kz b">.webp</code>，你可以在很多应用程序中完成，比如Photoshop——但是更快的方法是直接在终端上完成。让我们看看它是如何工作的。</p><h1 id="bf5c" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">支持。webp文件</h1><p id="7b7e" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated"><code class="fe kw kx ky kz b">.webp</code>广泛支持除Internet Explorer之外的所有浏览器。你可以在下面看到完整的支持:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/0bbbcaac06f5268d4e56fcb562100636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dVOecrxBuD4Zi8QA.png"/></div></div></figure><h1 id="d3a5" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">安装WebP和cwebp</h1><p id="d83f" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated">要开始将文件转换为<code class="fe kw kx ky kz b">.webp</code>，我们需要做的第一件事是安装一个名为<code class="fe kw kx ky kz b">cwebp</code>的工具，它是Google提供的<code class="fe kw kx ky kz b">webp</code>包的一部分。如果你已经安装了<strong class="ka ir">自制软件</strong>，这很容易，可以从终端安装，如下所示:</p><pre class="me mf mg mh gt mi kz mj mk aw ml bi"><span id="4a12" class="mm lb iq kz b gy mn mo l mp mq">brew install webp</span></pre><p id="0d50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你没有，你可以通过Google 找到更多关于<a class="ae mr" href="https://developers.google.com/speed/webp/download" rel="noopener ugc nofollow" target="_blank">安装这个包的说明。安装后，我们可以从终端运行命令<code class="fe kw kx ky kz b">cwebp</code>来获得以下输出:</a></p><pre class="me mf mg mh gt mi kz mj mk aw ml bi"><span id="045d" class="mm lb iq kz b gy mn mo l mp mq">~ % cwebp<br/>Usage:<br/>    cwebp [options] -q quality input.png -o output.webp</span></pre><p id="14d8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以现在，如果我们想将一个<code class="fe kw kx ky kz b">.png</code>文件更改为<code class="fe kw kx ky kz b">.webp</code>，质量为60，我们可以运行以下命令:</p><pre class="me mf mg mh gt mi kz mj mk aw ml bi"><span id="61b7" class="mm lb iq kz b gy mn mo l mp mq">cwebp -q 60 image.png -o image.webp</span></pre><p id="10ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将把<code class="fe kw kx ky kz b">image.png</code>转换成质量为60%的文件<code class="fe kw kx ky kz b">image.webp</code>。改变这个质量值将会改变输出的大小——质量越低，文件越小——但是平衡它，使图像看起来还可以也很重要。<strong class="ka ir">原始图像仍然会被保留，所以我们会有两个版本的文件。</strong></p><p id="8a23" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于一些老的浏览器如Internet Explorer不支持<code class="fe kw kx ky kz b">.webp</code>，拥有两个版本实际上是有用的。在HTML中，我们可以使用我们的<code class="fe kw kx ky kz b">.webp</code>文件，通过使用<code class="fe kw kx ky kz b">&lt;picture&gt;</code>标签回退到原始的<code class="fe kw kx ky kz b">.png</code>文件:</p><pre class="me mf mg mh gt mi kz mj mk aw ml bi"><span id="8cbf" class="mm lb iq kz b gy mn mo l mp mq">&lt;picture&gt;<br/>    &lt;source srcset="image.webp" type="image/webp"&gt;<br/>    &lt;img src="image.png" alt="Image for Article" /&gt;<br/>&lt;/picture&gt;</span></pre><p id="e188" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这意味着对于使用更现代浏览器的用户来说，他们将获得更快加载时间的额外好处——而那些使用旧浏览器的用户仍然可以看到图像，如果他们的浏览器不支持<code class="fe kw kx ky kz b">.webp</code>。</p><h1 id="8c6e" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">将您的所有图像转换为。webp</h1><p id="e1ae" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv ij bi translated"><code class="fe kw kx ky kz b">.webp</code>是如此之快，有必要将你所有的图片制作成<code class="fe kw kx ky kz b">.webp</code>的副本，这样你就可以随时使用它们。因为<code class="fe kw kx ky kz b">cwebp</code>也保留原始文件，所以没有丢失图像原始副本的风险。由于大多数服务器都有大量的图像，这可能非常耗时。</p><p id="da97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">幸运的是，我们可以使用<code class="fe kw kx ky kz b">cwebp</code>通过一个<code class="fe kw kx ky kz b">for</code>循环将所有的<code class="fe kw kx ky kz b">.png</code>、<code class="fe kw kx ky kz b">.jpg</code>和<code class="fe kw kx ky kz b">.jpeg</code>文件转换成<code class="fe kw kx ky kz b">.webp</code>。下面的代码将找到运行它的目录中的所有图像，并为每个图像创建<code class="fe kw kx ky kz b">.webp</code>版本。因为它递归地工作，它将转换你的服务器上找到的任何图像。这意味着有时运行它会很耗时，这取决于你有多少图像。<a class="ae mr" href="https://fjolt.com/article/linux-find-command" rel="noopener ugc nofollow" target="_blank">你可以在这里了解更多关于find命令的信息</a>。</p><pre class="me mf mg mh gt mi kz mj mk aw ml bi"><span id="3517" class="mm lb iq kz b gy mn mo l mp mq">echo 'Converting all .png, .jpg, and .jpeg files to .webp...'<br/>for f in $(find . -name '*.png' -or -name '*.jpg' -or -name '*.jpeg'); do <br/>    if [ ! -f "${f%.*}.webp" ]; then<br/>        cwebp -q 60 $f -o ${f%.*}.webp<br/>    fi<br/>done</span></pre></div></div>    
</body>
</html>