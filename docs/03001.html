<html>
<head>
<title>Customizing Rails Routes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">定制铁路路线</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/customizing-rails-routes-6be0d627b7bc?source=collection_archive---------17-----------------------#2020-04-14">https://levelup.gitconnected.com/customizing-rails-routes-6be0d627b7bc?source=collection_archive---------17-----------------------#2020-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="53df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在熨斗学校的第二个模块中，我有幸与一名团队成员一起工作，他愿意集成人类可读的slugs，最终使我们的项目看起来更干净/更像样。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/b6ffc6b838bf4f23eae841f27e8f30f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/1*MkYbalKxa3t0sz24H38zuw.gif"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">蛞蝓舞</figcaption></figure><p id="4f90" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是的，鼻涕虫。起初，我对鼻涕虫到底是什么感到困惑。他们指的是一种“无壳陆地腹足类软体动物”，还是有更多的含义？</p><p id="e662" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以将slug定义为URL的一部分，它通过人类可读的关键字来标识用户所在的页面。虽然并不总是如此，但它通常位于URL的末尾。有时是当前正在访问的文件名或资源名。</p><p id="f2d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个例子就是<a class="ae la" href="https://www.facebook.com/CowsArePro" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/</a>(你的名字)。在rails中，用户的显示页面通常以他们的userID结束，但是在这个例子中，用户将被标识，但是是他们自己设置的自定义标识符，或者可以通过创建用户时使用的不同属性自定义生成。</p><p id="bc17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将slugs集成到你的next Rail项目中的一个方法是通过一个名为“FriendlyID”的gem<br/>friendly id将自己定义为slugng和ActiveRecord的permalink插件的“瑞士军队推土机”。</p><p id="5d24" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">FriendlyID可以为您做的是将链接变成:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/60ab59ba8326210428851e2019b910d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*eNEigfcLj10Oun1mKOPs6Q.png"/></div></figure><p id="5cc8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">变成这样一个链接:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/af7c9b42aedf469cfbe2afffd9ef20ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*OQ2fo6zlB8UfdmWnPlIY8A.png"/></div></figure><p id="6964" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">FriendlyID非常容易设置，下面是让你的URL更加友好的简单步骤。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><p id="b5f0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保您的Gem文件中包含了Gem Friendly_ID，注意，如果您运行的是rails 4.0+版本，那么Friendly_ID的版本至少必须是5.0.0！</p><pre class="kp kq kr ks gt lk ll lm ln aw lo bi"><span id="f11a" class="lp lq it ll b gy lr ls l lt lu">gem 'friendly_id', '~&gt; 5.2.4'</span></pre><p id="9cd2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们可以继续向项目中任何需要的模型添加slugs！</p><pre class="kp kq kr ks gt lk ll lm ln aw lo bi"><span id="35ac" class="lp lq it ll b gy lr ls l lt lu">rails g migration AddSlugToUsers slug:uniq</span></pre><p id="f4c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就像我之前说过的，slugs可以添加到任何现有的模型中！</p><pre class="kp kq kr ks gt lk ll lm ln aw lo bi"><span id="15cc" class="lp lq it ll b gy lr ls l lt lu">rails generate friendly_id</span></pre><p id="8f0c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将创建一个新文件，该文件本质上包含FriendlyID的配置设置(我们在这里不会涉及它！)</p><p id="5f70" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完成迁移后，还有几个步骤！</p><pre class="kp kq kr ks gt lk ll lm ln aw lo bi"><span id="a8b1" class="lp lq it ll b gy lr ls l lt lu">class User &lt; ApplicationRecord<br/>  extend FriendlyId<br/>  friendly_id :name, use: :slugged<br/>end</span><span id="d948" class="lp lq it ll b gy lv ls l lt lu">class UserController &lt; ApplicationController<br/>  def show<br/>    @user = User.friendly.find(params[:id])<br/>  end<br/>end</span><span id="ce78" class="lp lq it ll b gy lv ls l lt lu">User.find_each(&amp;:save)</span></pre><p id="3e45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们在这里做的是告诉用户类这里是自定义的URL段，我们希望显示的是用户名！</p><p id="f226" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在必须使用User.friendly.find(params[:id])来搜索我们的用户，而不是。查找以返回正确的用户。</p><p id="45e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">最重要的最后一步是find_each( &amp; :save) </strong>。任何新创建的用户都将自动拥有该唯一的slug属性，并自动拥有其新的自定义路线，但是任何先前存在的用户则不会。通过这个方法重新保存它们将会给它们分配自定义的slug！</p><p id="db8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">等等，还有更多！</p><pre class="kp kq kr ks gt lk ll lm ln aw lo bi"><span id="a06e" class="lp lq it ll b gy lr ls l lt lu">resources :users, param: :slug</span></pre><p id="73b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以这种方式编辑您的路线完全消除了使用号码搜索用户的能力！</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="7d2d" class="lw lq it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">定制鼻涕虫！</h1><p id="f1bb" class="pw-post-body-paragraph jq jr it js b jt mt jv jw jx mu jz ka kb mv kd ke kf mw kh ki kj mx kl km kn im bi translated">拥有真正定制鼻涕虫的最后一个技巧是自己制作！</p><pre class="kp kq kr ks gt lk ll lm ln aw lo bi"><span id="2ca3" class="lp lq it ll b gy lr ls l lt lu">friendly_id :slug_candidates, use: :slugged</span></pre><p id="31f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以在模型中创建一个自定义的getter函数，并使用它的值来创建我们的slug，而不是使用对象的单个属性。</p><pre class="kp kq kr ks gt lk ll lm ln aw lo bi"><span id="eaa8" class="lp lq it ll b gy lr ls l lt lu">def slug_candidates <br/> ["#{self.name}-#{self.age}-#{self.bio}"] <br/>end</span></pre><p id="e57a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将它添加到我们的用户模型中会生成一个链接，看起来像</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi my"><img src="../Images/957ce582dddd03ee1ad48d77721b44c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*FvnLhlAOYP4bjdeunzAILw.png"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><p id="b2d8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">FriendlyID是一个非常强大和方便的方法来为您的用户创建更多的人可读的页面！它根本不需要花很长时间来实现，它也有助于确保用户不能从一个资源跳到另一个资源！(在正确执行auth之前)</p><p id="d118" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在出去开始制作你自己的定制鼻涕虫吧！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/9feada40619758f9f09993c01e1f367f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*Yh-F_hI6ly5Y-E1c.gif"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">兔子鼻涕虫</figcaption></figure><p id="150e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">参考资料:</p><p id="ce0a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae la" href="https://github.com/norman/friendly_id" rel="noopener ugc nofollow" target="_blank">https://github.com/norman/friendly_id</a></p></div></div>    
</body>
</html>