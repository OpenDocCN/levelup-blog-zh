<html>
<head>
<title>Deploy a Flask App in Kubernetes 🕸</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在kubernetes部署一个Flask应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploy-a-flask-app-in-kubernetes-f3e12100de9a?source=collection_archive---------3-----------------------#2021-10-14">https://levelup.gitconnected.com/deploy-a-flask-app-in-kubernetes-f3e12100de9a?source=collection_archive---------3-----------------------#2021-10-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d0e33741ff644b37a524b12dec198d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6sIHgq-YOWhhO9wN.png"/></div></div></figure><p id="8a6e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一个<a class="ae kz" href="https://kubernetes.io/docs/concepts/services-networking/ingress/" rel="noopener ugc nofollow" target="_blank">入口</a>是一个API对象，它定义了允许外部访问集群中服务的规则。一个<a class="ae kz" href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/" rel="noopener ugc nofollow" target="_blank">入口控制器</a>实现入口中设置的规则。</p><h1 id="7118" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">启动minikube</h1><p id="34ef" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">如果您在本地安装了Minikube，请运行以下命令:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="2c3b" class="mm lb it mi b gy mn mo l mp mq">minikube start</span></pre><h1 id="60ac" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">启用入口控制器</h1><p id="a2b5" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">要启用NGINX入口控制器，请运行以下命令:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="e132" class="mm lb it mi b gy mn mo l mp mq">minikube addons enable ingress</span></pre><p id="bafb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">克隆我的GitHub项目来跟进</p><div class="mr ms gp gr mt mu"><a href="https://github.com/alvisf/kubernetes-flask-poc" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">alvisf/Kubernetes-flask-POC</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">在GitHub上创建一个帐户，为alvisf/Kubernetes-flask-poc的开发做出贡献。</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">github.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni jz mu"/></div></div></a></div><h1 id="a012" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">创建Dockerfile文件</h1><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="497c" class="mm lb it mi b gy mn mo l mp mq">FROM alpine:latest<br/>RUN apk add --no-cache python3-dev \&amp;&amp; apk add --no-cache py-pip<br/>WORKDIR /appCOPY . /app<br/>RUN pip3 --no-cache install Flask<br/>EXPOSE 5002<br/>ENTRYPOINT ["python3"]CMD ["main.py"]</span></pre><p id="9fa0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这只是一个简单的docker文件，它将创建一个docker化的flask应用程序。</p><p id="ddc7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">建立docker形象</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="f818" class="mm lb it mi b gy mn mo l mp mq">docker build -t frontendvm .</span></pre><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/e5768286a7eb827e2e7bf0e6ea3a9b31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LppxlSQ3k3sDLtKD.png"/></div></div></figure><p id="b631" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在docker映像已经创建好了，我们可以继续创建Kubernetes文件了</p><h1 id="8255" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">创建K8s部署文件</h1><p id="3691" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">要创建部署，请使用命令</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="a5da" class="mm lb it mi b gy mn mo l mp mq">kubectl apply -f hello-deployment.yaml</span></pre><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8cffb4979a168f57e42c05b30053b9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:60/0*TLSsHK1v8vxqCF99"/></div></figure><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/7de95feea974e50da6e24c071b794e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ePvQsX1geztqWYfL.png"/></div></div></figure><p id="1b06" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要查看这个打开的minikube仪表板</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="8fa6" class="mm lb it mi b gy mn mo l mp mq">minikube dashboard</span></pre><p id="f0be" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们需要创建一个服务来连接到我们部署的pod</p><p id="0a2b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用命令创建服务</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="37a8" class="mm lb it mi b gy mn mo l mp mq">kubectl apply -f hello-service.yaml</span></pre><p id="035f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在完成了，我们将有一个运行的应用程序到一个随机的URL</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="fbdd" class="mm lb it mi b gy mn mo l mp mq">minikube service flask-service --url</span></pre><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/569f55312404f15d6b5023f1f5ff6f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R63fQ0UliyKX6UAF.png"/></div></div></figure><p id="c07e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">输出:-</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/46fa72a876d6775b415e5f8f66657fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/0*UeUg2n71n0tmMdE5.png"/></div></figure><p id="49fd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们需要创建一个入口规则来在我们的服务器上托管应用程序</p><h1 id="4716" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">为K8s创建入口</h1><p id="e968" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">使用命令创建服务</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="c84a" class="mm lb it mi b gy mn mo l mp mq">kubectl apply -f hello-nginx-service.yaml</span></pre><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi no"><img src="../Images/51ab35ea46b90ae6c11b7e40eba18bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/0*jOISsewi-jeZa0XV.png"/></div></figure><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/01e4ec23cccbf21554ece985207f25f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*V0xPWC0n4mMG2Rqd.png"/></div></div></figure><p id="9cbd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们需要对我们的<strong class="kd iu"> /etc/hosts </strong>文件做一个小小的改动</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/d7d5d68f4549710615f757096919991d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SZyb7EzuVVwhLjQP.png"/></div></div></figure><p id="617f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">像这样把上面得到的值相加</p><p id="13bb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所有这些都将成为你的输出</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/97fe734f50853a2d54ad204326c80375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/0*lZGljpkd92Fykkk1.png"/></div></figure><p id="6a82" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请随时联系我</p><div class="mr ms gp gr mt mu"><a href="https://linkedin.com/in/alvisf" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">阿尔维斯F -实习生- EY | LinkedIn</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">在全球最大的职业社区LinkedIn上查看Alvis F的个人资料。阿尔维斯有4个工作列在他们的…</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">linkedin.com</p></div></div><div class="nd l"><div class="nq l nf ng nh nd ni jz mu"/></div></div></a></div></div></div>    
</body>
</html>