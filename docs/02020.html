<html>
<head>
<title>The JavaScript Global Object Variable — When Should We Use It?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript全局对象变量——我们应该什么时候使用它？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-javascript-global-variable-when-should-we-use-it-4c35afff3b1a?source=collection_archive---------11-----------------------#2020-02-12">https://levelup.gitconnected.com/the-javascript-global-variable-when-should-we-use-it-4c35afff3b1a?source=collection_archive---------11-----------------------#2020-02-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9f2b26f5484969fb10cfb98b9dd23460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ivISjZdEIPXQgpIX"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@kylejglenn?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯尔·格伦</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="5fb9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在JavaScript中，有一个取决于环境的全局变量。在浏览器中，有一个<code class="fe le lf lg lh b">window</code>对象。worker上下文将<code class="fe le lf lg lh b">self</code>对象作为全局对象。Node.js拥有<code class="fe le lf lg lh b">global</code>对象。</p><p id="8504" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将看看全局对象，它做什么，以及如何和何时使用它。</p><h1 id="bc93" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">全局对象的范围</h1><p id="06e8" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">全局对象总是在最顶层的范围内。上面没别的了。因此，任何东西都可以访问它。考虑名字，这个有道理。</p><p id="c8b5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在JavaScript中，作用域在运行时不会改变，所以我们可以从它们在代码中的位置得到它们的作用域。</p><p id="fe5f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为全局对象在最顶层的作用域中，所以它可以被任何东西访问。例如，我们可以从任何地方<code class="fe le lf lg lh b">console.log</code>这个<code class="fe le lf lg lh b">window</code>对象，我们可以得到它的值。</p><h1 id="673b" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">全局对象</h1><p id="c5b1" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">全局对象是其属性是全局变量的对象。它在浏览器中被称为<code class="fe le lf lg lh b">window</code>对象，在web workers中被称为<code class="fe le lf lg lh b">self</code>，在Node.js中被称为<code class="fe le lf lg lh b">global</code></p><p id="2674" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还有一个提议是拥有一个在所有上下文中都可用的<code class="fe le lf lg lh b">globalThis</code>全局对象。</p><p id="2c32" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">全局对象包含所有内置的全局变量。</p><h1 id="9ed4" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建全局变量</h1><p id="508e" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">我们可以通过创建全局对象的属性来创建全局变量。在浏览器上下文中，这意味着我们将其创建为<code class="fe le lf lg lh b">window</code>对象的属性。</p><p id="485f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有几种方法可以做到这一点。一种方法是定义为<code class="fe le lf lg lh b">window</code>对象的属性，如下所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="5b6f" class="mt lj it lh b gy mu mv l mw mx">window.foo = 1;</span></pre><p id="5c2f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以在代码中的任何地方引用<code class="fe le lf lg lh b">foo</code>或<code class="fe le lf lg lh b">window.foo</code>。</p><p id="1bdb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一种方法是在我们代码的顶层使用<code class="fe le lf lg lh b">var</code>关键字。也就是说，它没有嵌套在任何块中。我们可以这样定义它:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="cf72" class="mt lj it lh b gy mu mv l mw mx">var foo = 1;</span></pre><h1 id="c8de" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">获取或设置变量</h1><p id="59e0" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">我们可以获取和设置全局变量，就像我们声明它一样。例如，如果我们声明:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="da32" class="mt lj it lh b gy mu mv l mw mx">window.foo = 1;</span></pre><p id="964b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以引用<code class="fe le lf lg lh b">window.foo</code>并给它们赋值。如果在顶层用<code class="fe le lf lg lh b">var</code>声明，如下所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="17a4" class="mt lj it lh b gy mu mv l mw mx">var foo = 1;</span></pre><p id="e8fd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们可以写:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="c32c" class="mt lj it lh b gy mu mv l mw mx">foo = 1;</span></pre><p id="565c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="02f4" class="mt lj it lh b gy mu mv l mw mx">window.foo = 1;</span></pre><h1 id="2a3e" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">组件</h1><p id="1a69" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">每个模块都有自己的环境，除非明确导出某些内容，否则不会暴露给外界。然而，我们仍然可以像在任何其他环境中一样从那里访问全局变量。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/8f6f7a4599c7b8f3cdc38d2878462d3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gl-GoEbvXpyQCmu0"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="8f4a" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">警告</h1><p id="0ee4" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">全局对象被认为是一个错误。很容易创建与其他变量名称冲突的全局变量。</p><p id="a921" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们可以很容易地改变现有的内置全局变量或我们定义的变量。通过使用像<code class="fe le lf lg lh b">let</code>和<code class="fe le lf lg lh b">const</code>这样的新构造来声明变量和常量，并使用模块来保护私有数据和命名空间，这样我们就不会意外地修改任何东西，从而避免了这个问题。</p><p id="dc1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它只是为了让浏览器上的简单脚本变得简单。既然我们正在用JavaScript构建成熟的应用程序，那么过多地使用全局对象将会像我们之前描述的那样产生很多问题。</p><p id="d2a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，浏览器环境中的全局对象有很多属性，我们可以用它们来为我们的应用程序添加特性，比如用于加密的<code class="fe le lf lg lh b">window.SubtleCrypto</code>、用于声明Web组件的<code class="fe le lf lg lh b">customElements</code>变量以及更多的属性。<code class="fe le lf lg lh b">location</code>也是<code class="fe le lf lg lh b">window</code>对象的属性。</p><p id="0e4b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，Node.js' <code class="fe le lf lg lh b">global</code>对象也有类似<code class="fe le lf lg lh b">__dirname</code>和<code class="fe le lf lg lh b">__filename</code>的属性，这对于访问我们当前代码的数据很方便。<code class="fe le lf lg lh b">console</code>对象对于调试很有用，而<code class="fe le lf lg lh b">Process</code>对于获取当前运行进程的数据很有用。</p><p id="855c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">setTimeout</code>、<code class="fe le lf lg lh b">setInterval</code>也是Node.js <code class="fe le lf lg lh b">global</code>对象的一部分。</p><p id="6fbf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完整的属性列表在Mozilla开发者网络上。</p><p id="b155" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在JavaScript有模块之前，它也用于从外部脚本访问变量。但是现在我们有了模块，我们肯定不需要为此使用全局对象。</p><p id="33e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，测试要困难得多，因为全局变量会被任何东西改变。所以，很难解释他们到底怎么了。</p><h1 id="6169" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">结论</h1><p id="6ab9" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">现在，我们只是使用像<code class="fe le lf lg lh b">window</code>对象这样的全局变量，主要是因为它们的内置属性。</p><p id="09ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们自己的代码中，我们使用由全局对象提供的东西，但是没有任何好的用例可以向全局对象添加任何属性。追踪问题既麻烦又困难，因为所有东西都会修改全局变量，因为所有东西都可以访问它。</p><p id="5b7b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更好的方法是将所有东西模块化，然后通过导出来公开我们需要的东西。</p><p id="9723" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，<code class="fe le lf lg lh b">window</code>对象确实有很多我们可以使用的有用属性。Node.js' <code class="fe le lf lg lh b">global</code>对象也是如此。</p></div></div>    
</body>
</html>