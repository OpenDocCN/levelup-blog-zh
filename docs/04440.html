<html>
<head>
<title>Make Your Own Helm Chart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åˆ¶ä½œä½ è‡ªå·±çš„èˆµå›¾</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/make-your-own-helm-chart-590622a50c14?source=collection_archive---------2-----------------------#2020-06-27">https://levelup.gitconnected.com/make-your-own-helm-chart-590622a50c14?source=collection_archive---------2-----------------------#2020-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="02a9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ç¬¬ä¸‰éƒ¨åˆ†:ä½¿ç”¨HelmåŒ…ç®¡ç†å™¨è¿›è¡Œéƒ¨ç½²</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/07ae204d28b8666b4e52794b4c86a4ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GsiqzTGSowO01w-Nnahmfg.png"/></div></div></figure><p id="995f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦‚æœä½ æ˜¯è¿™ä¸ªç³»åˆ—çš„æ–°æ‰‹ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘ä¹‹å‰çš„å¸–å­ï¼Œå…³äº<a class="ae lq" href="https://medium.com/@almas.hilman/simple-kubernetes-deployment-using-kops-273fc7990006" rel="noopener">åˆ›å»ºkubernetesé›†ç¾¤</a>å’Œ<a class="ae lq" href="https://medium.com/@almas.hilman/deploying-simple-golang-webapp-to-kubernetes-25dc1736dcc4" rel="noopener">ä½¿ç”¨yamlé…ç½®æ–‡ä»¶åœ¨Kubernetesé›†ç¾¤ä¸­éƒ¨ç½²webåº”ç”¨</a>ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨èˆµå›¾éƒ¨ç½²webåº”ç”¨ç¨‹åºã€‚</p><p id="3810" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Helmæ˜¯Kubernetesçš„ä¸€ä¸ªåŒ…ç®¡ç†å™¨ã€‚ä½¿ç”¨helmï¼Œæ‚¨å¯ä»¥ä½¿ç”¨é¢„å®šä¹‰çš„é…ç½®æ–‡ä»¶æ¨¡æ¿è½»æ¾å®‰è£…åº”ç”¨ç¨‹åºã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åœ¨é›†ç¾¤ä¸­å®‰è£…ä¸€äº›åº”ç”¨ç¨‹åºï¼Œå¦‚nginxã€redisã€mysqlæˆ–prometheusã€‚æ‰‹åŠ¨æ“ä½œä¼šè€—è´¹æ‚¨çš„æ—¶é—´ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é”™è¯¯çš„é…ç½®ï¼Œä»è€Œå¯¼è‡´ä»¥åçš„ä¸€äº›é—®é¢˜ã€‚æ‚¨å¯ä»¥ä½¿ç”¨é¢„å®šä¹‰çš„å›¾è¡¨ï¼Œå¹¶ä½¿ç”¨helmè½»æ¾å®‰è£…å®ƒã€‚æˆ–è€…æ‚¨å¸Œæœ›æ ¹æ®æ‚¨çš„æ ‡å‡†åˆ›å»ºä¸€ä¸ªç”¨äºéƒ¨ç½²åº”ç”¨ç¨‹åºçš„æ¨¡æ¿ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥åˆ›å»ºè‡ªå·±çš„helm chartå¹¶ä½¿ç”¨å®ƒæ¥éƒ¨ç½²æ‚¨çš„åº”ç”¨ç¨‹åºã€‚è¿™å°†é¿å…æ‚¨å¤šæ¬¡å¤åˆ¶ç²˜è´´æ¥åˆ›å»ºè®¸å¤šç›¸ä¼¼çš„yamlæ–‡ä»¶ã€‚</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="d933" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">æ‰‹åœ¨ä¸Šé¢</h1><p id="3c8a" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">è®©æˆ‘ä»¬ä»å®‰è£…helm CLIå¼€å§‹ã€‚æ‚¨å¯ä»¥åœ¨æ‚¨çš„æœ¬åœ°æœºå™¨æˆ–ä»»ä½•ä¸€ä¸ªè¿æ¥åˆ°é›†ç¾¤çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="5e57" class="na lz it mw b gy nb nc l nd ne">$ curl -fsSL -o get_helm.sh <a class="ae lq" href="https://raw.githubusercontent.com\" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com\</a><br/>  /helm/helm/master/scripts/get-helm-3<br/>$ chmod 700 get_helm.sh<br/>$ ./get_helm.sh</span></pre><p id="77b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å®‰è£…åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªå›¾è¡¨ï¼Œ</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="73d5" class="na lz it mw b gy nb nc l nd ne">$ helm create simpleapp </span></pre><p id="ecce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼šä¸ºéƒ¨ç½²nginxæœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªå›¾è¡¨ã€‚å®‰è£…åº”ç”¨ç¨‹åºå°±åƒè¿è¡Œè¿™äº›å‘½ä»¤ä¸€æ ·ç®€å•ï¼Œ</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="65d5" class="na lz it mw b gy nb nc l nd ne">$ helm install simpleapp ./simpleapp</span></pre><p id="0634" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç§ï¼Œä½ å·²ç»åœ¨kubernetesé›†ç¾¤ä¸­å®‰è£…å¹¶è¿è¡Œäº†ä¸€ä¸ªnginxæœåŠ¡å™¨ã€‚çœ‹çœ‹è¿™ä¸ªï¼Œ</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="985e" class="na lz it mw b gy nb nc l nd ne">$ helm ls<br/>$ kubectl get all</span></pre><p id="a861" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¥½äº†ï¼Œæ‚¨å·²ç»çœ‹åˆ°äº†ä»é¢„å®šä¹‰çš„å›¾è¡¨å®‰è£…åº”ç”¨ç¨‹åºæ˜¯å¤šä¹ˆå®¹æ˜“ã€‚å®‰è£…æˆ‘ä»¬è‡ªå·±çš„åº”ç”¨ç¨‹åºæ€ä¹ˆæ ·ï¼Ÿè¿™éœ€è¦ä½ å¯¹ç°æœ‰çš„æ¨¡æ¿åšä¸€äº›ä¿®æ”¹ã€‚ä½†æ˜¯ä¸€æ—¦å®Œæˆï¼Œæ‚¨å°±å¯ä»¥å¤šæ¬¡ä½¿ç”¨å®ƒæ¥éƒ¨ç½²æ»¡è¶³éœ€æ±‚çš„è®¸å¤šä¸åŒçš„åº”ç”¨ç¨‹åºã€‚</p><p id="41a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ¸…ç†ä»¥å‰çš„å®‰è£…ï¼Œ</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="5321" class="na lz it mw b gy nb nc l nd ne">$ helm uninstall simpleapp </span></pre><p id="334f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸‹ä¸€éƒ¨åˆ†æ˜¯å…³äºå›¾è¡¨ä¸­å¯ç”¨çš„yamlæ–‡ä»¶æ¨¡æ¿ï¼Œä»¥åŠæˆ‘ä»¬å¯ä»¥ç”¨å®ƒåšä»€ä¹ˆã€‚è¿™å¯èƒ½æœ‰ç‚¹ä»¤äººå›°æƒ‘ã€‚ä¸ºäº†ä¸è¿·è·¯ï¼Œè¯·è®°ä½æˆ‘ä»¬ä¿®æ”¹çš„yamlæ–‡ä»¶æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œç¨åæ‚¨å°†æ¸²æŸ“å®ƒä»¥åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºæˆ‘ä»¬åœ¨<a class="ae lq" href="https://medium.com/@almas.hilman/deploying-simple-golang-webapp-to-kubernetes-25dc1736dcc4" rel="noopener">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­åˆ›å»ºçš„yamlæ–‡ä»¶(æ‚¨å¯èƒ½æƒ³è¦å¹¶æ’æ¯”è¾ƒå®ƒä»¬)ã€‚</p><p id="09e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç¬¬ä¸€ä¸ªæ˜¯<code class="fe nf ng nh mw b">Chart.yaml</code>æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ç”¨äºå­˜å‚¨è®¸å¤šä¸åº”ç”¨ç¨‹åºæœ¬èº«ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åç§°ã€æè¿°ã€ç»´æŠ¤è€…ã€ç‰ˆæœ¬ã€ç±»å‹æˆ–å›¾æ ‡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå…³äºæˆ‘å¦‚ä½•å»ºç«‹ä¸€ä¸ª<code class="fe nf ng nh mw b">Chart.yaml</code>æ–‡ä»¶çš„éå¸¸åŸºæœ¬çš„ä¾‹å­ã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="a5f0" class="na lz it mw b gy nb nc l nd ne">apiVersion: v2<br/>name: simpleapp<br/>description: A very simple helloworld application</span><span id="2be1" class="na lz it mw b gy ni nc l nd ne">type: application</span><span id="6511" class="na lz it mw b gy ni nc l nd ne"><em class="nj"># This is the chart version. This version number should be <br/># incremented each time you make changes<br/># to the chart and its templates, including the app version.<br/></em>version: 1.0.0</span><span id="8389" class="na lz it mw b gy ni nc l nd ne"><em class="nj"># This is the version number of the application being deployed. <br/># This version number should be<br/># incremented each time you make changes to the application.<br/></em>appVersion: 1.0.0</span></pre><p id="2042" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ¥ä¸‹æ¥æ˜¯<code class="fe nf ng nh mw b">value.yaml</code>æ–‡ä»¶ã€‚å¦‚æœæ‚¨ç¨åç­¾å‡ºï¼ŒYAMLæ¨¡æ¿æ–‡ä»¶ä¸­ä¼šæœ‰è®¸å¤šéƒ¨åˆ†ä½¿ç”¨å¼•ç”¨è¯¥æ–‡ä»¶ä¸­æ‰€è¿°å€¼çš„å˜é‡ã€‚ç¨åï¼Œå½“æˆ‘ä»¬æ¸²æŸ“YAMLæ¨¡æ¿æ—¶ï¼Œå®ƒå°†ç”Ÿæˆä¸€ä¸ªYAMLé…ç½®æ–‡ä»¶ã€‚æˆ‘å»ºè®®æŠŠæ‰€æœ‰å¯é…ç½®çš„ä¸œè¥¿éƒ½æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæ›´æ–°åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯èƒ½ä¼šæ›´æ”¹æ‰€æœ‰å†…å®¹ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä¸ºåç«¯å’Œå‰ç«¯ä»¥åŠå®¹å™¨ç«¯å£æ”¾ç½®äº†å›¾åƒå­˜å‚¨åº“ï¼Œå› ä¸ºæˆ‘æƒ³ç¨åä½¿ç”¨è¯¥å›¾è¡¨æ¥éƒ¨ç½²ä¸åŒçš„åº”ç”¨ç¨‹åºå›¾åƒï¼Œå¹¶å¯èƒ½åœ¨ä¸åŒçš„ç«¯å£å‘å¸ƒå®ƒã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="cfe1" class="na lz it mw b gy nb nc l nd ne"><em class="nj"># Default values for simpleapp.<br/># This is a YAML-formatted file.<br/># Declare variables to be passed into your templates.</em></span><span id="5ce0" class="na lz it mw b gy ni nc l nd ne">fullnameOverride: ""<br/>nameOverride: ""<br/>serviceAccount:<br/>  <em class="nj"># Specifies whether a service account should be created<br/>  </em>create: true<br/>  <em class="nj"># Annotations to add to the service account<br/>  </em>annotations: {}<br/>  <em class="nj"># The name of the service account to use.<br/>  # If not set and create is true, <br/>  # a name is generated using the fullname template<br/>  </em>name:</span><span id="94e2" class="na lz it mw b gy ni nc l nd ne">frontend:<br/>  enabled: true<br/>  replicaCount: 1<br/>  image:<br/>    repository: lmnzr/simplefrontend<br/>    pullPolicy: Always<br/>    ports:<br/>      containerPort: 80<br/>  env:<br/>    backend: ""<br/>  service:<br/>    type: NodePort<br/>    port: 80<br/>  ingress:<br/>    enabled: false<br/>    annotations:<br/>      kubernetes.io/ingress.class: nginx<br/>    hosts:<br/>      - host: chart-example.local<br/>        paths:<br/>          - /<br/>    tls: []<br/>    <em class="nj">#  - secretName: chart-example-tls<br/>    #    hosts:<br/>    #      - chart-example.local<br/>  </em>resources: {}</span><span id="9700" class="na lz it mw b gy ni nc l nd ne">backend:<br/>  enabled: true<br/>  replicaCount: 1<br/>  image:<br/>    repository: lmnzr/simplebackend<br/>    pullPolicy: Always<br/>  resources: {}</span></pre><p id="dc48" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ¥ä¸‹æ¥æˆ‘ä»¬æœ‰<code class="fe nf ng nh mw b">templates/</code>æ–‡ä»¶å¤¹ã€‚è¯¥æ–‡ä»¶å¤¹ä¸­çš„æ¯ä¸ªæ–‡ä»¶éƒ½å°†è¢«æ¸²æŸ“ä»¥åˆ›å»ºkubernetes YAMLé…ç½®æ–‡ä»¶ï¼Œä½†å‰é¢å¸¦æœ‰ä¸‹åˆ’çº¿(_)çš„æ–‡ä»¶é™¤å¤–ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œæˆ‘ä»¬æœ‰<code class="fe nf ng nh mw b">templates/_helpers.tpl</code>æ–‡ä»¶ã€‚æˆ‘å–œæ¬¢æŠŠè¿™ä¸ªæ–‡ä»¶è§£é‡Šä¸ºå­˜å‚¨æ‰€æœ‰å¯é‡ç”¨éƒ¨åˆ†çš„åœ°æ–¹ã€‚é€šå¸¸æ˜¯åº”ç”¨ç¨‹åºåã€éƒ¨ç½²åã€æœåŠ¡åç­‰ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå®šä¹‰çš„éƒ¨åˆ†å¯ä»¥ä½¿ç”¨æ¥è‡ª<code class="fe nf ng nh mw b">value.yaml</code>å’Œ<code class="fe nf ng nh mw b">Chart.yaml</code>çš„å€¼ç”Ÿæˆã€‚åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ¨¡æ¿åŠŸèƒ½ã€‚Helmæœ‰å…³äºå®ƒçš„å¾ˆå¥½çš„æ–‡æ¡£ï¼Œé˜…è¯»å®ƒ<a class="ae lq" href="https://helm.sh/docs/chart_template_guide/functions_and_pipelines/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>äº†è§£æ›´å¤šã€‚ä¾‹å¦‚ï¼Œæˆ‘ç”¨ä»å‘å¸ƒä¸­è·å–çš„å€¼æ¥å®šä¹‰<code class="fe nf ng nh mw b">simplebackend.fullname</code>ã€‚åç§°å’Œå›¾è¡¨ã€‚åç§°ä»¥â€œåç«¯â€ç»“å°¾ã€‚ç¨åï¼Œæ‚¨å°†çœ‹åˆ°æˆ‘å°†å®ƒåŒ…å«åœ¨åç«¯éƒ¨ç½²æ¨¡æ¿ä¸­ã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="0b7a" class="na lz it mw b gy nb nc l nd ne">{{/* vim: set filetype=mustache: */}}<br/>{{/* Expand the name of the chart. */}}</span><span id="cb5d" class="na lz it mw b gy ni nc l nd ne">{{/* <br/>Create a default fully qualified app name.<br/>We truncate at 63 chars because some Kubernetes name fields are limited to this (by the DNS naming spec).<br/>If release name contains chart name it will be used as a full name.<br/>*/}}</span><span id="0de9" class="na lz it mw b gy ni nc l nd ne">{{- define "simpleapp.name" -}}<br/>{{- default .Chart.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="0572" class="na lz it mw b gy ni nc l nd ne">{{- define "simpleapp.fullname" -}}<br/>{{- if .Values.fullnameOverride -}}<br/>{{- .Values.fullnameOverride | trunc 63 | trimSuffix "-" -}}<br/>{{- else -}}<br/>{{- $name := default .Chart.Name .Values.nameOverride -}}<br/>{{- if contains $name .Release.Name -}}<br/>{{- .Release.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- else -}}<br/>{{- printf "%s-%s" .Release.Name $name | trunc 63 |        trimSuffix "-" -}}<br/>{{- end -}}<br/>{{- end -}}<br/>{{- end -}}</span><span id="78af" class="na lz it mw b gy ni nc l nd ne">{{- define "simplebackend.fullname" -}}<br/>{{- printf "%s-%s-backend" .Release.Name .Chart.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="62a1" class="na lz it mw b gy ni nc l nd ne">{{- define "simplefrontend.fullname" -}}<br/>{{- printf "%s-%s-frontend" .Release.Name .Chart.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="62b9" class="na lz it mw b gy ni nc l nd ne">{{- define "simplebackend-deployment.fullname" -}}<br/>{{- printf "%s-%s-backend-dpl" .Release.Name .Chart.Name|       trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="6970" class="na lz it mw b gy ni nc l nd ne">{{- define "simplebackend-service.url" -}}<br/>{{- if .Values.frontend.env.backend -}}<br/>{{- .Values.frontend.env.backend | trunc 63 | trimSuffix "-" -}}<br/>{{- else -}}<br/>{{- printf "http://%s-%s-backend-svc:8080" .Release.Name .Chart.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}<br/>{{- end -}}</span><span id="839b" class="na lz it mw b gy ni nc l nd ne">{{- define "simplefrontend-deployment.fullname" -}}<br/>{{- printf "%s-%s-frontend-dpl" .Release.Name .Chart.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="3a1b" class="na lz it mw b gy ni nc l nd ne">{{- define "simplebackend-service.fullname" -}}<br/>{{- printf "%s-%s-backend-svc" .Release.Name .Chart.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="7a67" class="na lz it mw b gy ni nc l nd ne">{{- define "simplefrontend-service.fullname" -}}<br/>{{- printf "%s-%s-frontend-svc" .Release.Name .Chart.Name | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="6d60" class="na lz it mw b gy ni nc l nd ne">{{/* Create chart name and version as used by the chart label. */}}</span><span id="0b70" class="na lz it mw b gy ni nc l nd ne">{{- define "simpleapp.chart" -}}<br/>{{- printf "%s-%s" .Chart.Name .Chart.Version | replace "+" "_" | trunc 63 | trimSuffix "-" -}}<br/>{{- end -}}</span><span id="a01b" class="na lz it mw b gy ni nc l nd ne">{{/* Common labels */}}</span><span id="0df6" class="na lz it mw b gy ni nc l nd ne">{{- define "simpleapp.labels" -}}<br/>helm.sh/chart: {{ include "simpleapp.chart" . }}<br/>{{ include "simpleapp.selectorLabels" . }}<br/>{{- if .Chart.AppVersion }}<br/>app.kubernetes.io/version: {{ .Chart.AppVersion | quote }}<br/>{{- end }}<br/>app.kubernetes.io/managed-by: {{ .Release.Service }}<br/>{{- end -}}</span><span id="1407" class="na lz it mw b gy ni nc l nd ne">{{/* Selector labels */}}</span><span id="40b0" class="na lz it mw b gy ni nc l nd ne">{{- define "simpleapp.selectorLabels" -}}<br/>app.kubernetes.io/name: {{ include "simpleapp.name" . }}<br/>app.kubernetes.io/instance: {{ .Release.Name }}<br/>{{- end -}}</span><span id="2a7b" class="na lz it mw b gy ni nc l nd ne">{{/* Create the name of the service account to use */}}</span><span id="66e0" class="na lz it mw b gy ni nc l nd ne">{{- define "simpleapp.serviceAccountName" -}}<br/>{{- if .Values.serviceAccount.create -}}<br/>    {{ default (include "simpleapp.fullname" .)    <br/>      .Values.serviceAccount.name }}<br/>{{- else -}}<br/>{{ default "default" .Values.serviceAccount.name }}<br/>{{- end -}}<br/>{{- end -}}</span></pre><p id="a250" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨<code class="fe nf ng nh mw b">templates/ deployment.yaml</code>ä¸­åˆ›å»ºéƒ¨ç½²æ¨¡æ¿äº†ã€‚è¯¥æ¨¡æ¿å°†ç”¨äºç”Ÿæˆ<code class="fe nf ng nh mw b">backend-deployment.yaml</code>å’Œ<code class="fe nf ng nh mw b">frontend-deployment.yaml</code>ï¼Œç±»ä¼¼äºæˆ‘ä»¬åœ¨<a class="ae lq" href="https://medium.com/@almas.hilman/deploying-simple-golang-webapp-to-kubernetes-25dc1736dcc4" rel="noopener">ç¬¬2éƒ¨åˆ†</a>ä¸­åˆ›å»ºçš„æ¨¡æ¿ã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="004a" class="na lz it mw b gy nb nc l nd ne">{{- if .Values.backend.enabled -}}<br/>apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: {{ include "simplebackend-deployment.fullname" . }}<br/>  labels:<br/>    app.kubernetes.io/stack: <br/>      {{ include "simplebackend.fullname" . }}<br/>    {{- include "simpleapp.labels" . | nindent 4 }}</span><span id="d381" class="na lz it mw b gy ni nc l nd ne">spec:<br/>  replicas: {{ .Values.backend.replicaCount }}<br/>  selector:<br/>    matchLabels:<br/>      app: {{ include "simplebackend.fullname" . }}<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: {{ include "simplebackend.fullname" . }}<br/>    spec:<br/>      serviceAccountName: <br/>        {{ include "simpleapp.serviceAccountName" . }}<br/>      containers:<br/>        - name: {{ include "simplebackend.fullname" . }}<br/>          image: <br/>            "{{ .Values.backend.image.repository }}:<br/>            {{ .Values.backend.image.tag | default "latest" }}"<br/>          imagePullPolicy: {{ .Values.backend.image.pullPolicy }}<br/>          ports:<br/>            - name: http<br/>              containerPort: 8080<br/>              protocol: TCP<br/>          livenessProbe:<br/>            httpGet:<br/>              path: /<br/>              port: 8080<br/>          readinessProbe:<br/>            httpGet:<br/>              path: /<br/>              port: 8080<br/>          resources:<br/>            {{- toYaml .Values.backend.resources | nindent 12 }}<br/>{{- end }}</span><span id="cc63" class="na lz it mw b gy ni nc l nd ne">---</span><span id="d921" class="na lz it mw b gy ni nc l nd ne">{{- if .Values.frontend.enabled -}}<br/>apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: {{ include "simplefrontend-deployment.fullname" . }}<br/>  labels:<br/>    app.kubernetes.io/stack: <br/>      {{ include "simplefrontend.fullname" . }}<br/>    {{- include "simpleapp.labels" . | nindent 4 }}<br/>spec:<br/>  replicas: {{ .Values.frontend.replicaCount }}<br/>  selector:<br/>    matchLabels:<br/>      app: {{ include "simplefrontend.fullname" . }}<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: {{ include "simplefrontend.fullname" . }}<br/>    spec:<br/>      serviceAccountName: <br/>        {{ include "simpleapp.serviceAccountName" . }}<br/>      containers:<br/>        - name: {{ include "simplefrontend.fullname" . }}<br/>          image: <br/>            "{{ .Values.frontend.image.repository }}:<br/>            {{ .Values.frontend.image.tag | default "latest" }}"<br/>          imagePullPolicy: {{ .Values.frontend.image.pullPolicy }}<br/>          env:<br/>            - name: BACKEND_URL<br/>              value:  {{ include "simplebackend-service.url" .}}<br/>          ports:<br/>            - name: http<br/>              containerPort: <br/>                {{ .Values.frontend.image.ports.containerPort }}<br/>              protocol: TCP<br/>          livenessProbe:<br/>            httpGet:<br/>              path: /<br/>              port: {{ .Values.frontend.image.ports.containerPort }}<br/>          readinessProbe:<br/>            httpGet:<br/>              path: /<br/>              port: {{ .Values.frontend.image.ports.containerPort }}<br/>          resources:<br/>            {{- toYaml .Values.frontend.resources | nindent 12 }}<br/>{{- end }}</span></pre><p id="5b40" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ¥ä¸‹æ¥åœ¨<code class="fe nf ng nh mw b">templates/service.yaml</code>ä¸­ä¸ºæœåŠ¡åˆ›å»ºæ¨¡æ¿ã€‚è¯¥æ¨¡æ¿å°†ç”¨äºç”Ÿæˆ<code class="fe nf ng nh mw b">backend-service.yaml</code>å’Œ<code class="fe nf ng nh mw b">frontend-service.yaml</code>ï¼Œä¹Ÿç±»ä¼¼äºæˆ‘ä»¬åœ¨<a class="ae lq" href="https://medium.com/@almas.hilman/deploying-simple-golang-webapp-to-kubernetes-25dc1736dcc4" rel="noopener">ç¬¬2éƒ¨åˆ†</a>ä¸­åˆ›å»ºçš„æ¨¡æ¿ã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="63b4" class="na lz it mw b gy nb nc l nd ne">{{- if .Values.backend.enabled -}}<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: {{ include "simplebackend-service.fullname" . }}<br/>  labels:<br/>    app.kubernetes.io/stack: <br/>      {{ include "simplebackend.fullname" . }}<br/>    {{- include "simpleapp.labels" . | nindent 4 }}<br/>spec:<br/>  type: ClusterIP<br/>  ports:<br/>    - port: 8080<br/>      targetPort: http<br/>      protocol: TCP <br/>      name: http<br/>  selector:<br/>    app: {{ include "simplebackend.fullname" . }}<br/>{{- end }}</span><span id="dec7" class="na lz it mw b gy ni nc l nd ne">---</span><span id="037d" class="na lz it mw b gy ni nc l nd ne">{{- if .Values.frontend.enabled -}}<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: {{ include "simplefrontend-service.fullname" . }}<br/>  labels:<br/>    app.kubernetes.io/stack: <br/>      {{ include "simplefrontend.fullname" . }}<br/>    {{- include "simpleapp.labels" . | nindent 4 }}<br/>spec:<br/>  type: {{ .Values.frontend.service.type }}<br/>  ports:<br/>    - port: {{ .Values.frontend.service.port }}<br/>      targetPort: http<br/>      protocol: TCP<br/>      name: http<br/>  selector:<br/>    app: {{ include "simplefrontend.fullname" . }}<br/>{{- end }}</span></pre><p id="b5b7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†ä¸€åˆ‡ï¼Œè¿˜æœ‰æœ€åä¸€ä»¶äº‹è¦åˆ›å»º<code class="fe nf ng nh mw b">NOTES.txt</code>ã€‚è¿™æœ‰åŠ©äºä¸ºå®‰è£…æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„ä»»ä½•äººç”Ÿæˆæœ‰ç”¨çš„è¯´æ˜ã€‚é€šå¸¸ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ç»™å‡ºå…³äºå¦‚ä½•è®¿é—®åº”ç”¨ç¨‹åºæˆ–æ£€æŸ¥ä»€ä¹ˆä»¥éªŒè¯åº”ç”¨ç¨‹åºå®‰è£…æ­£ç¡®çš„è¯´æ˜ã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="aedd" class="na lz it mw b gy nb nc l nd ne">{{- if .Values.frontend.enabled }}<br/>  Get the Frontend application URL by running these commands:<br/>{{- if .Values.frontend.ingress.enabled }}<br/>{{- range $host := .Values.frontend.ingress.hosts }}<br/>  {{- range .paths }}<br/>  http{{ if $.Values.frontend.ingress.tls }}s{{ end }}://<br/>  {{ $host.host }}{{ . }}<br/>  {{- end }}<br/>{{- end }}<br/>{{- else if contains "NodePort" .Values.frontend.service.type }}<br/>  export NODE_PORT=$(kubectl get <br/>  --namespace {{ .Release.Namespace }} -o jsonpath="  <br/>  {.spec.ports[0].nodePort}" services <br/>  {{ include "simplefrontend-service.fullname" . }})</span><span id="c86b" class="na lz it mw b gy ni nc l nd ne">  export NODE_IP=$(kubectl get nodes --namespace <br/>  {{ .Release.Namespace }} -o <br/>  jsonpath="{.items[0].status.addresses[0].address}")</span><span id="76c8" class="na lz it mw b gy ni nc l nd ne">  echo <a class="ae lq" rel="noopener ugc nofollow" target="_blank" href="/$NODE_IP:$NODE_PORT">http://$NODE_IP:$NODE_PORT</a><br/>{{- else if contains "LoadBalancer" .Values.frontend.service.type }}<br/>  NOTE: It may take a few minutes for the LoadBalancer IP to be  <br/>  available.<br/>  You can watch the status of by running <br/>  'kubectl get --namespace {{ .Release.Namespace }} svc -w <br/>  {{ include "simplefrontend-service.fullname" . }}'</span><span id="ccf5" class="na lz it mw b gy ni nc l nd ne">  export SERVICE_IP=$(kubectl get svc --namespace <br/>  {{ .Release.Namespace }} <br/>  {{ include "simplefrontend-service.fullname" . }} <br/>  --template "{{"{{ range (index .status.loadBalancer.ingress 0) }}<br/>  {{.}}{{ end }}"}}")<br/>  <br/>  echo http://$SERVICE_IP:{{ .Values.frontend.service.port }}<br/>{{- else if contains "ClusterIP" .Values.frontend.service.type }}<br/>  export POD_NAME=$(kubectl get pods --namespace <br/>  {{ .Release.Namespace }} -l <br/>  app={{ include "simplefrontend.fullname" . }} <br/>  -o jsonpath="{.items[0].metadata.name}")</span><span id="f0a4" class="na lz it mw b gy ni nc l nd ne">  echo "Visit http://127.0.0.1:80 to use your application"</span><span id="20a9" class="na lz it mw b gy ni nc l nd ne">  kubectl --namespace {{ .Release.Namespace }} <br/>  port-forward $POD_NAME 80:80<br/>{{- end }}<br/>{{- end }}</span><span id="289b" class="na lz it mw b gy ni nc l nd ne">{{- if .Values.backend.enabled }}<br/>  Get the application Backend URL by running these commands:</span><span id="b75a" class="na lz it mw b gy ni nc l nd ne">  export POD_NAME=$(kubectl get pods --namespace <br/>  {{ .Release.Namespace }} <br/>  -l app={{ include "simplebackend.fullname" . }} <br/>  -o jsonpath="{.items[0].metadata.name}")<br/>  <br/>  echo "Visit http://127.0.0.1:8080 to use your application"<br/>  <br/>  kubectl --namespace {{ .Release.Namespace }} <br/>  port-forward $POD_NAME 80:8080<br/>{{- end }}</span></pre><p id="6ad0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å®Œæˆäº†ã€‚æˆ‘ä»¬ä¸€åˆ‡éƒ½å‡†å¤‡å¥½äº†ã€‚</p><p id="c5f8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¦æ£€æŸ¥æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚å¦‚æœæœ‰é—®é¢˜ï¼Œé€šå¸¸ä½ åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­åšä¸€äº›æ‰“å­—é”™è¯¯ã€‚æˆ‘å‘ç°å¯¹æˆ‘æœ‰ç”¨çš„ä¸€ä¸ªæŠ€å·§æ˜¯ï¼Œè¯•ç€ä¸€æ¬¡æ„å»ºä¸€ä¸ªæ¨¡æ¿çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½éªŒè¯å®ƒã€‚è¿™æ ·æ›´å®¹æ˜“å‘ç°é”™è¯¯ã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="833d" class="na lz it mw b gy nb nc l nd ne">$ helm lint ./simpleapp<br/>$ helm install --dry-run --debug simpleapp ./simpleapp</span></pre><p id="aaf1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦‚æœä¸€åˆ‡è¿è¡Œæ­£å¸¸ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ¸²æŸ“çš„YAMLé…ç½®æ–‡ä»¶ã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œè¿™ä¸ªå‘½ä»¤æ¥å®‰è£…æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œ</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="76ca" class="na lz it mw b gy nb nc l nd ne">$ helm install simpleapp ./simpleapp</span></pre><p id="3f32" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦‚æœæ‚¨æœ‰æœ‰æ•ˆçš„YAMLé…ç½®æ–‡ä»¶ï¼Œè¯¥é…ç½®åº”è¯¥å¯ä»¥æ­£ç¡®è¿è¡Œã€‚ç„¶åï¼Œæ‚¨åº”è¯¥ç«‹å³çœ‹åˆ°æ‚¨åœ¨<code class="fe nf ng nh mw b">NOTES.txt</code>ä¸­åˆ›å»ºçš„ç¬”è®°ã€‚å®ƒä¸ºæ‚¨æä¾›äº†å¦‚ä½•è®¿é—®webåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚è¯•è¯•çœ‹ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°è¿™ä¸ªï¼Œ</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/9491bffb08b5995b8a543f071eff0188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GOMRAOTOqMCtPB9IJ0UKg.png"/></div></figure><p id="341a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦‚æœæ‚¨æƒ³è¦æ›´æ”¹åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚æ›´æ”¹æ˜ åƒæˆ–æœåŠ¡ç±»å‹ï¼Œæˆ–è€…æ›´æ”¹å¤åˆ¶è®¡æ•°ã€‚ç»§ç»­ä¿®æ”¹<code class="fe nf ng nh mw b">values.yaml</code>æ–‡ä»¶ã€‚ç„¶åä½¿ç”¨æ­¤å‘½ä»¤åº”ç”¨å®ƒã€‚</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="7de9" class="na lz it mw b gy nb nc l nd ne">$ helm upgrade simpleapp ./simpleapp</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="db7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä¸æ–‡ç« <a class="ae lq" href="https://github.com/lmnzr/simpleapp" rel="noopener ugc nofollow" target="_blank">ç›¸å…³çš„æ‰€æœ‰ä»£ç ã€‚</a></p><p id="0e78" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åœ¨æ•´ä¸ªç³»åˆ—ä¸­ï¼Œæˆ‘å·²ç»å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•å¼€å§‹ä½¿ç”¨kuber netesã€‚å…³äºkubernetesé›†ç¾¤éƒ¨ç½²ã€åº”ç”¨ç¨‹åºéƒ¨ç½²å’Œhelm chartï¼Œè¿˜æœ‰å¾ˆå¤šä¸œè¥¿éœ€è¦å­¦ä¹ ã€‚æˆ‘ç»™ä½ å±•ç¤ºçš„åªæ˜¯ä¸€ä¸ªå¼€å§‹ã€‚æˆ‘é¼“åŠ±æ‚¨æ·±å…¥ç ”ç©¶ï¼Œä»¥ä¾¿èƒ½å¤Ÿå°†å…¶ç”¨äºç”Ÿäº§ã€‚</p><p id="7075" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">éå¸¸æ„Ÿè°¢æ‚¨çš„å…³æ³¨ğŸ‘‹ã€‚</p></div></div>    
</body>
</html>