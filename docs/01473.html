<html>
<head>
<title>Considering Javascript and A11y: The Accordion Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">考虑Javascript和A11y:手风琴组件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/considering-javascript-and-a11y-the-accordion-component-2ab8c752cac6?source=collection_archive---------11-----------------------#2020-01-05">https://levelup.gitconnected.com/considering-javascript-and-a11y-the-accordion-component-2ab8c752cac6?source=collection_archive---------11-----------------------#2020-01-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4f5d975b60e1ac3a23c057100bfa7f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8-s_EVA55MOIFbQu8Fu0w.jpeg"/></div></div></figure><p id="8aa7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最近，一位同事给了我一个挑战，让我依靠HTML、CSS和普通的Javascript编写一个手风琴组件。我决定把这个任务变成一个研究项目，因为我不仅想了解如何为视觉用户创建一个手风琴，还想了解如何为依赖屏幕阅读器等辅助技术的用户创建一个手风琴。</p><p id="f7b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">基本上，我想在构建这个组件时考虑可访问性或“A11y”。</p><p id="5074" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我是这样分解我的研究方法的:</p><ol class=""><li id="6358" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated"><strong class="kd iu">CRAFT A DEFINITION:</strong>accordion组件对于用户和开发者的目的和作用是什么？手风琴是如何为依赖辅助技术的用户制造痛点的？开发人员在编写accordion组件时忽略了哪些易访问性问题？</li><li id="011a" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated"><strong class="kd iu">构建语义HTML结构:</strong>良好的可访问性要求尽可能依赖语义HTML。那会是什么样子？</li><li id="2c99" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated"><strong class="kd iu">合并WAI-ARIA: </strong>我想我需要合并WAI-ARIA属性来使我的手风琴能被屏幕阅读器访问，但是我不确定我需要添加什么。知道WAI-ARIA的基本规则是<em class="ln">而不是</em>如果你没有必要就使用它，我想以一种非常简洁的方式制作一个依赖它的手风琴。</li><li id="10c0" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated"><strong class="kd iu">应用JAVASCRIPT: </strong>到目前为止，我接触过的Accordions都使用JAVASCRIPT来神奇地显示和隐藏DOM中的内容。我假设我会使用Javascript，但不确定这是否是实现可访问性的最佳方法？由于一些残疾用户在浏览器中关闭了Javascript，所以只有CSS的手风琴会更好吗？</li><li id="1bfe" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated"><strong class="kd iu">用VOICEOVER测试:</strong>我想确保我测试了我用Voiceover构建的任何示例，voice over是我的首选屏幕阅读器，因为它是免费的，已经安装在我的Mac上了。</li></ol><h1 id="5c15" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">什么是手风琴部件？</h1><p id="8914" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">accordion组件以垂直方式组织内容的多个部分。每个部分都有一个折叠标题，它是一个标题或问题，引用相应折叠面板中嵌入的内容。accordion让用户可以自由决定想要显示或隐藏内容的哪些部分。</p><p id="d73d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从UX的角度来看，accordion的功能特别有用，因为它通过允许在小区域中嵌入更多内容来解决屏幕空间有限的问题。例如，折叠经常被选为FAQ部分的设计模式。想象一下，移动用户不得不无休止地滚动，或者屏幕阅读器用户不得不无休止地浏览一长串问题和答案，以便找到页面上的其他内容，这是多么令人沮丧？</p><p id="17c6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">手风琴为视觉用户提供了一个干净简洁的界面，手风琴式的标题作为隐藏内容的交互轮廓。隐藏内容对屏幕阅读器用户也有好处，因为它是不可聚焦的，并且不会迫使用户为了到达网页的其他区域而切换内容。</p><h1 id="4689" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">如何构建手风琴的语义结构？</h1><blockquote class="mr ms mt"><p id="5edd" class="kb kc ln kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated">语义HTML是真正可访问网络的基础。</p><p id="e756" class="kb kc ln kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated"><em class="it"> Sara Soueidan，</em>开发人员和教师</p></blockquote><p id="4141" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在一篇名为<a class="ae mx" href="https://www.24a11y.com/2019/what-a-year-of-learning-and-teaching-accessibility-taught-me/" rel="noopener ugc nofollow" target="_blank">“一年的学习和教学可访问性教会了我什么”的精彩博文中，</a>开发者Sara Soueidan强调了依赖语义HTML的基础重要性。语义HTML为什么重要？HTML元素描述了它们所呈现的内容，并且“通过使用正确的元素，你的文档内容将具有可传达的结构和意义。”</p><p id="be19" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当使用本地HTML元素时，DOM能够将这些元素的结构转换成可访问性树，从而为辅助技术提供信息。屏幕阅读器将宣布元素的角色、名称、状态和值，因为本地元素已经内置了可访问性信息，所以尽可能依赖它们的语义是很重要的。<a class="ae mx" href="https://developers.google.com/web/fundamentals/accessibility/semantics-builtin/the-accessibility-tree" rel="noopener ugc nofollow" target="_blank">来源</a></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/2921a34a640b4e7efa01bdb46c334b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8pEqOY7Uifgfx9Fb.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">请注意可访问性树(在右边)中的所有可用信息:可访问性树结构、aria属性和计算属性。</figcaption></figure><p id="94c3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我知道我需要一个容器来包装折叠标题的各个部分和相应的折叠面板内容。我还认为我需要一个容器来包装内容，为将来可能出现的复杂内容需求做准备。</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/a422ddaab39535c75a7a1c91853e9e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k70fyfSf9slCz1Bn.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">基本折叠式HTML结构</figcaption></figure><p id="1383" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">上面代码的问题是标题没有被设计成交互式的。最初，它们对我很有意义，因为我知道屏幕阅读器可以帮助用户根据标题浏览网页。<a class="ae mx" href="https://usability.yale.edu/web-accessibility/articles/headings" rel="noopener ugc nofollow" target="_blank">来源</a></p><p id="9a83" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在调查了关于accordion最佳实践的多种资源之后，建议将<button>标签作为<h3>标签的子标签，允许按钮文本替换标题文本。您不希望替换按钮的标题，因为这将限制屏幕阅读器与折叠标题内容的交互能力。</h3></button></p><p id="21fd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">开发人员还应该避免使用带有role="button "属性的<div>标记，因为这种方法会从本地HTML按钮提供的可访问性树中删除信息。可以使<div>标签可访问，但是需要额外的自定义代码。为什么不使用已经可用并经过测试的产品呢？<a class="ae mx" href="https://www.hassellinclusion.com/blog/accessible-accordion-pattern/" rel="noopener ugc nofollow" target="_blank">来源</a></div></div></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/441acfeeb08b36153dd5f06e934dfcf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dO0L6DsRa0FADSY9.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">使折叠标题具有交互性。</figcaption></figure><p id="fa69" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个<button>标签可以通过继承父标题的样式来轻松设置样式。我喜欢Heydon Pickering的这项技术，因为它避免了在撤销所有原生按钮样式时增加代码量。一个重要的注意事项:确保将焦点样式添加回按钮中，以便用户仍然可以在视觉上看到它。下面是这些技术的代码:</button></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/98aae5bba9abcc49a93d6c1912906a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DmbCdRnNtOOEL3bG.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">把对焦环放回去！</figcaption></figure><h1 id="0842" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">如何指示状态的变化？</h1><p id="3e5f" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">因为accordion组件可以展开和折叠内容，所以有必要以可视化和编程的方式演示状态的变化。当内容在可用和隐藏之间切换时，必须通知用户。隐藏内容对任何用户都不可用，除非它处于展开状态。</p><p id="a3c9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了使用视觉提示演示这种切换，当单击accordion标题时，accordion将显示和隐藏一部分内容。通常，这由指示内容是打开还是关闭的图标动画来表示。</p><p id="e54d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">虽然只有CSS的手风琴可以传达内容的展开和折叠，但它们不能向屏幕阅读器用户传达状态的变化。这就是Javascript成为使accordion组件可访问的有用工具的原因，因为它可以切换向屏幕阅读器指示内容是展开还是折叠的属性。</p><h2 id="3df5" class="ni lp it bd lq nj nk dn lu nl nm dp ly km nn no mc kq np nq mg ku nr ns mk nt bi translated">WAI-ARIA</h2><p id="4f41" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">为了向屏幕阅读器用户传达状态的变化，可以使用WAI-ARIA属性的组合。aria代表可访问的富互联网应用程序，ARIA属性的范围有助于使web内容和web应用程序更易于访问。</p><p id="3fea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">按钮上的aria-expanded属性告诉我们内容是展开还是折叠。<a class="ae mx" href="https://www.a11ywithlindsey.com/blog/javascript-accessibility-accordions" rel="noopener ugc nofollow" target="_blank"> SOURCE </a>需要注意的是，开发人员经常会犯将aria-expanded属性放在内容本身的错误，然而<em class="ln">状态的改变应该总是放在控件上。</em> <a class="ae mx" href="http://provide.smashingmagazine.com/eBooks/inclusive-components-free-chapter.pdf?_ga=2.134554546.2102480741.1577471058-1521707248.1577363110" rel="noopener ugc nofollow" target="_blank">来源</a></p><p id="1a13" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">W3C的ARIA资源详细介绍了aria-expanded属性的重要信息。本质上，aria-expanded状态“指示该元素或它控制的另一个分组元素当前是展开的还是折叠的。”</p><p id="0645" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，如果aria展开状态为<strong class="kd iu"> false </strong>，则该元素或它控制的另一个分组元素将被折叠。如果aria-expanded状态为<strong class="kd iu"> true </strong>，那么这个元素或者它控制的另一个分组元素将被展开如果aria展开的状态是<strong class="kd iu">未定义的</strong>，那么这个元素，或者它控制的另一个分组元素，既不可展开也不可折叠；显示其所有子元素，或者没有子元素。<a class="ae mx" href="https://www.w3.org/TR/wai-aria-1.1/#aria-expanded" rel="noopener ugc nofollow" target="_blank">来源</a></p><h2 id="293b" class="ni lp it bd lq nj nk dn lu nl nm dp ly km nn no mc kq np nq mg ku nr ns mk nt bi translated">隐藏属性</h2><p id="ed98" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">aria-hidden属性通常用于定义折叠内容的状态。但是，当设置为false时，该属性在浏览器中会有一些问题，建议不要在生产应用程序中依赖该属性。<a class="ae mx" href="https://www.w3.org/TR/wai-aria-1.1/#aria-hidden" rel="noopener ugc nofollow" target="_blank">来源</a></p><p id="c033" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">幸运的是，一个本地的替代方法，隐藏的全局HTML属性，现在可以在所有浏览器上成功实现。这个属性是一个布尔值，它决定了一个元素是否与网页相关。如果一个元素具有hidden属性，浏览器将不会呈现该元素，内容将对所有用户隐藏。<a class="ae mx" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/hidden" rel="noopener ugc nofollow" target="_blank">来源</a></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/76ec76ee885c083ec6082df40c46d62b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dSAWHuD7FfTjwnMr.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">为可访问性添加WAI-ARIA和HTML全局属性。</figcaption></figure><h2 id="f55f" class="ni lp it bd lq nj nk dn lu nl nm dp ly km nn no mc kq np nq mg ku nr ns mk nt bi translated">视觉用户的SVG图标</h2><p id="3d22" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">内容的打开和关闭通常通过加号和减号图标的切换来说明。对于视觉用户，加号图标表示有一些可以打开的附加内容。减号图标表示内容的相关部分可以隐藏。</p><p id="5590" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于我的例子，我依赖Heydon Pickering建议的svg图标。这是他的图标:</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/237ad6a174e640304ecb605fcf982e13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6H7AoKQKexLw2-0W.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">Heydon Pickering加减svg图标</figcaption></figure><p id="cee0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">他非常深入地研究了这个图标的可访问实现。例如，Pickering添加了属性focusable="false ",因为我们不需要图标是交互式的。我们只希望父按钮具有这种焦点交互。</p><p id="056a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我非常欣赏的其他技巧包括如何设计按钮的样式。使用下面的代码，svg icon元素将自动继承其父元素的所有样式，在本例中是标题。</p><blockquote class="mr ms mt"><p id="b58e" class="kb kc ln kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated">我们可以确保元素尊重高对比度主题。通过对元素应用currentColor填充，当受主题更改影响时，它们会随着周围的文本改变颜色。</p><p id="d62f" class="kb kc ln kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated"><em class="it">海登·皮克林，</em> <a class="ae mx" href="https://www.smashingmagazine.com/2019/11/inclusive-components-prerelease/" rel="noopener ugc nofollow" target="_blank">包容成分</a></p></blockquote><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/cb8ce0183ce24a9202084745762bffa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/0*Nu_-ramX5b-6Cvwp.png"/></div></figure><p id="1992" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有关其他样式选择和深入解释，请参考Pickering关于可折叠内容的章节。</p><h1 id="2a17" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">如何为我的手风琴组件选择Javascript？</h1><p id="62de" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">我想说明的是，为了创建一个可访问的组件，我消化了很多资源。接下来的文章非常透彻，帮助我掌握了重要的概念，并演示了如何编写一个可访问的手风琴。我读了林赛的博客<em class="ln"> A11y中的<a class="ae mx" href="https://www.a11ywithlindsey.com/blog/javascript-accessibility-accordions" rel="noopener ugc nofollow" target="_blank">“Javascript和可访问性:手风琴”</a>，格雷厄姆·阿姆菲尔德的<a class="ae mx" href="https://www.hassellinclusion.com/blog/accessible-accordion-pattern/" rel="noopener ugc nofollow" target="_blank">“我最喜欢的可访问手风琴模式”</a>，以及匹兹堡卡耐基博物馆创新工作室的<a class="ae mx" href="http://web-accessibility.carnegiemuseums.org/code/accordions/" rel="noopener ugc nofollow" target="_blank">“网络可访问性指南:手风琴”</a>。</em></p><p id="4785" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，我登陆的地方主要受Heydon Pickering最近出版的书<a class="ae mx" href="https://www.smashingmagazine.com/2019/11/inclusive-components-prerelease/" rel="noopener ugc nofollow" target="_blank">中关于可折叠部分的章节的影响。然而，所有的作者都做了出色的工作，为易访问开发提出了非常相似的论点和方法。我强烈推荐阅读所有的资源来形成你自己关于发展选择的观点。</a></p><p id="4b1b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">以下是我更喜欢用于我的无障碍手风琴:</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/0874d1f0d949ebf94002e75e69fe6c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pbgSAYW-108xVka-.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">添加Javascript功能。</figcaption></figure><p id="f927" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我喜欢这种方法的什么？我喜欢ES6在非常枯燥的演示中的使用效果。基本上，我们用。accordion__header类，然后切换aria扩展的属性和内容面板。call方法让我们显式地指定当遍历数组中的所有内容时，<strong class="kd iu"> <em class="ln"> this </em> </strong>等于的值。</p><h1 id="472d" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">在Voiceover上测试它</h1><p id="6bbe" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">是时候在画外音上测试我的手风琴了。首先，作为一个比较点，我想看看在没有任何考虑的情况下，一个基本的手风琴是什么样子的。以下是W3学校手风琴示例的短片:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">W3学校示例</figcaption></figure><p id="40be" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里最大的问题是没有内容状态的指示。您无法判断按钮触发的是面板内容的展开状态还是折叠状态。</p><p id="617a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，让我们看看我在这篇文章中整理的手风琴:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">我的无障碍手风琴的例子。</figcaption></figure><p id="83bf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当使用Voiceover时，很明显关注手风琴的状态对屏幕阅读器用户有什么影响。虽然这个手风琴在视觉上与W3 Schools手风琴相同，但它更易于使用，因为它可以显示内容的折叠和展开状态。</p><p id="fc60" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">听完这个手风琴我要改变的一件事就是我的html设置。让我感到困扰的是，用户不知道手风琴里有多少面板。如果有30个呢？这是我一开始就想知道的信息。所以我将把我的手风琴包装在一个<ul>标签中，而不是一个<div>标签中。我将把手风琴头和面板放到一个<li>标签中。这种方法是由格雷厄姆·阿姆菲尔德和莎拉·苏伊丹提出的。</li></div></ul></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/8c78aaa1799b6ab0e058ebb19e1e5291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JFxf5pJhkr4BpRMm.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">在无序列表中包装手风琴。</figcaption></figure><p id="3bf3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">找到了。现在，当屏幕阅读器访问组件时，它会读出列表中的项目数。听下面:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">无序列表中的可访问组件。</figcaption></figure><h1 id="a4f7" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">如何通过事件委托解决性能问题？</h1><p id="921b" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">当我向我团队的FED(前端)领导展示这篇文章的初稿时，他建议我应该通过考虑事件委托来解决性能问题。为什么事件委托有助于性能？事件委托允许我们设置一个事件处理程序，而不是多个。因为我们只有一个事件，而不是多个事件，所以对内存的压力较小，这导致了更好的性能。</p><p id="3b20" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">本质上，上面的代码在每个元素上附加了一个事件侦听器。accordion__header类。我们实际上可以重构这个accordion，这样在父元素上只有一个事件监听器，即<ul>标签本身。为什么这是可能的，事件委托是如何工作的？为了理解这一点，我们需要首先概念化以下Javascript特性:事件冒泡和目标事件。</ul></p><h2 id="1a5d" class="ni lp it bd lq nj nk dn lu nl nm dp ly km nn no mc kq np nq mg ku nr ns mk nt bi translated">事件冒泡</h2><p id="bc09" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">事件冒泡是一个过程，它说明了在父子关系中触发事件的顺序。</p><blockquote class="mr ms mt"><p id="1c69" class="kb kc ln kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated">当一个事件在一个元素上被触发时，例如鼠标点击一个按钮，同样的事件也会在该元素的所有祖先上被触发。这个过程被称为事件冒泡；事件从原始元素冒泡到DOM树的顶端。<em class="it"> </em> <a class="ae mx" href="https://www.sitepoint.com/javascript-event-delegation-is-easier-than-you-think/" rel="noopener ugc nofollow" target="_blank"> <em class="it">来源</em> </a></p><p id="3f45" class="kb kc ln kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated">安德鲁·泰特劳</p></blockquote><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/a0bcd8b5fcdc6659a0260f43c49a4268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*z5RmEeEQoWpT8FHn.png"/></div></figure><h2 id="fd29" class="ni lp it bd lq nj nk dn lu nl nm dp ly km nn no mc kq np nq mg ku nr ns mk nt bi translated">目标元素</h2><p id="1a7d" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">事件委托的另一个方面涉及Javascript的目标元素特性。什么是目标元素？目标元素是启动事件的原始元素。对于我们的手风琴来说，重要的是要认识到目标元素也可以是javascript事件的祖先，在我们的例子中是包装手风琴头部和面板的<ul>标签。</ul></p><h2 id="2cd3" class="ni lp it bd lq nj nk dn lu nl nm dp ly km nn no mc kq np nq mg ku nr ns mk nt bi translated">事件委托</h2><p id="db72" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">使用事件冒泡和目标元素，我们现在可以为accordion组件集成一种利用事件委托的javascript方法。基本上，当<button>元素上的click事件冒泡到accordion的父<ul>标签时，“您检查事件对象的target属性以获得对实际被单击节点的引用。”<a class="ae mx" href="https://davidwalsh.name/event-delegate" rel="noopener ugc nofollow" target="_blank">来源</a></ul></button></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/aca15a59310b75cbfd6efdd3689c739b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rapg0RfTm51cLRjz.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">重构的accordion javascript实现事件委托。</figcaption></figure><p id="f590" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">上面的代码在accordion <ul>元素上设置了一个事件监听器。当有一个点击事件时，它将运行我们的折叠功能。accordion函数使用获取具有accordion-trigger属性的元素的最近方法来标识目标元素。我将这个属性放在所有的<button>元素上，如下所示。</button></ul></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/686c53274fb8a92d34f002590252b05b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YkZLuMQETAcs25RK.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">向<button>标签添加accordion-trigger属性。</button></figcaption></figure><p id="2360" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当处理多个事件侦听器的用例时，正如accordion组件所要求的，一个好的经验法则是使用事件委托，即在父元素上附加一个事件侦听器。这将防止出现耗尽内存从而导致性能下降的情况。</p><p id="de63" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，为我们的accordion组件选择事件委托还解决了有关数据驱动方法的动态方面的问题。为什么？因为我们的事件侦听器只检查我们的。click事件触发时的accordion__header选择器。以前没有。这允许我们动态地将accordion内容添加到DOM中，而不用担心我们的事件监听器无法捕捉到它们，因为页面已经加载了。<a class="ae mx" href="https://gomakethings.com/why-is-javascript-event-delegation-better-than-attaching-events-to-each-element/" rel="noopener ugc nofollow" target="_blank">来源</a></p><p id="473d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里有一个链接指向<a class="ae mx" href="https://codepen.io/lclark070607/pen/mdyXBBL" rel="noopener ugc nofollow" target="_blank">我的代码笔</a>和这个最终迭代(今天)。</p><h1 id="926a" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">最后的想法</h1><p id="faf4" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">我发现这个研究和写作练习对于将手风琴组件的可访问结构和功能映射到我的大脑中是非常宝贵的。我总是渴望同时学习和教学。这不仅对我自己来说是一个很好的学习过程，而且可能会帮助其他人综合丰富的信息。</p><p id="695b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我在这里完成的这个手风琴还没有逐步增强。如果某人的浏览器关闭了Javascript，隐藏的内容将保持隐藏。这是我会继续研究的问题。Heydon Pickering和来自A11y with Lindsey的作者都采用了不同的方法来使内容在这个场景中可用。我的一个同事建议使用<datails>和<summary>元素，并从那里向后工作。我会调查此事，稍后会更新这篇文章。</summary></datails></p><h1 id="e04a" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">资源</h1><p id="3697" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">这篇博客综合了这些了不起的开发者的大量信息。为了你自己的利益，我建议你也读一读他们的作品。</p><ul class=""><li id="6900" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky ny lf lg lh bi translated"><a class="ae mx" href="https://www.a11ywithlindsey.com/blog/javascript-accessibility-accordions" rel="noopener ugc nofollow" target="_blank"> A11yWithLindsey，“Javascript和可访问性:手风琴”</a></li><li id="ae4e" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="https://gomakethings.com/why-is-javascript-event-delegation-better-than-attaching-events-to-each-element/" rel="noopener ugc nofollow" target="_blank"> Chris Ferdinandi，“为什么JavaScript事件委托比将事件附加到每个元素要好？”</a></li><li id="a032" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="https://www.hassellinclusion.com/blog/accessible-accordion-pattern/" rel="noopener ugc nofollow" target="_blank"> Graham Armfield，“我最喜欢的无障碍手风琴模式”</a></li><li id="6e2f" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="https://www.heydonworks.com/article/aria-controls-is-poop" rel="noopener ugc nofollow" target="_blank">海登·皮克林，“咏叹调控制是便便”</a></li><li id="36e2" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="http://provide.smashingmagazine.com/eBooks/inclusive-components-free-chapter.pdf?_ga=2.134554546.2102480741.1577471058-1521707248.1577363110" rel="noopener ugc nofollow" target="_blank"> Heydon Pickering，<em class="ln">中的“可折叠内容”包含组件</em> </a></li><li id="aa08" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="http://web-accessibility.carnegiemuseums.org/code/accordions/" rel="noopener ugc nofollow" target="_blank">创新工作室，《网页无障碍指南:手风琴》</a></li><li id="98b8" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="https://www.w3.org/TR/wai-aria-1.1/#aria-expanded" rel="noopener ugc nofollow" target="_blank">关于aria-expand属性的W3C官方文档</a></li><li id="e38b" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated">莎拉·苏伊丹，“你怎么给手风琴做标记？”</li><li id="b2d6" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="https://www.24a11y.com/2019/what-a-year-of-learning-and-teaching-accessibility-taught-me/" rel="noopener ugc nofollow" target="_blank"> Sara Soueidan，“一年的教学和学习可及性教会了我什么”</a></li><li id="6dd7" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="https://www.sitepoint.com/javascript-event-delegation-is-easier-than-you-think/" rel="noopener ugc nofollow" target="_blank"> Andrew Tetlaw，“事件委派比你想象的容易”</a></li><li id="2696" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky ny lf lg lh bi translated"><a class="ae mx" href="https://davidwalsh.name/event-delegate" rel="noopener ugc nofollow" target="_blank"> David Walsh，“Javascript事件委托如何工作”</a></li></ul></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="2f90" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="ln">原载于2020年1月5日</em><a class="ae mx" href="https://louiseclark.tech/postings/a11y-accordion-component" rel="noopener ugc nofollow" target="_blank"><em class="ln">https://Louise Clark . tech</em></a><em class="ln">。</em></p></div></div>    
</body>
</html>