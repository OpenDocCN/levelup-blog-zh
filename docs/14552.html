<html>
<head>
<title>Media Queries in JS/TS Done Right</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JS/TSä¸­çš„åª’ä½“æŸ¥è¯¢å®Œæˆæ­£ç¡®</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/media-queries-in-js-ts-done-right-3bd598dca9df?source=collection_archive---------18-----------------------#2022-12-06">https://levelup.gitconnected.com/media-queries-in-js-ts-done-right-3bd598dca9df?source=collection_archive---------18-----------------------#2022-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/abd413b449b5f33531336e6951c6f984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KwjULomPLiCDJT1fDy9epg.png"/></div></div></figure><p id="0dd5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æœ€è¿‘ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªæƒ…å†µï¼Œæ¶‰åŠåˆ°ç›‘å¬ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„å±å¹•å®½åº¦ã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½†æˆ‘æƒ³è¦ä¸€äº›ç®€å•çš„ã€å¯é‡ç”¨çš„ã€ä¸ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå¤ªå¤§å½±å“çš„é€šç”¨æ–¹æ³•ã€‚</p><p id="4f58" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘è®¤ä¸ºåœ¨<code class="fe kw kx ky kz b">window</code>ä¸Šç›‘å¬<code class="fe kw kx ky kz b">resize</code>äº‹ä»¶å¹¶æ£€æŸ¥<code class="fe kw kx ky kz b">innerWidth</code>å¤ªæ…¢äº†ï¼Œå°¤å…¶æ˜¯å› ä¸ºæ‰€æœ‰ä¸å¸ƒå±€ç›¸å…³çš„äº‹æƒ…éƒ½è¿«ä½¿<a class="ae la" href="https://gist.github.com/paulirish/5d52fb081b3570c81e3a" rel="noopener ugc nofollow" target="_blank">å›æµ</a>ã€‚</p><p id="f8d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨æœç´¢è§£å†³æ–¹æ¡ˆæ—¶ï¼Œæˆ‘å¾ˆå¿«å‘ç°äº†<a class="ae la" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia" rel="noopener ugc nofollow" target="_blank">window . match media()</a>APIï¼Œè¿™ä¼¼ä¹æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆ(æ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒå®ƒ)ã€‚</p><p id="cefd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å‰©ä¸‹å”¯ä¸€è¦åšçš„å°±æ˜¯å®ç°ä¸€ä¸ªç®€å•çš„å¯é‡ç”¨çš„é€šç”¨è§£å†³æ–¹æ¡ˆï¼Œåœ¨åº•å±‚ä½¿ç”¨å®ƒã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå¸®åŠ©æˆ‘èµ·æ­¥çš„<a class="ae la" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Testing_media_queries" rel="noopener ugc nofollow" target="_blank"> MDNé“¾æ¥</a>ã€‚</p><p id="7328" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘æƒ³è¦çš„æ˜¯èƒ½å¤Ÿ<code class="fe kw kx ky kz b">subscribe</code>å“åº”æ¥è‡ªåº”ç”¨ç¨‹åºä¸åŒç»„ä»¶çš„ä¸åŒåª’ä½“æŸ¥è¯¢ï¼Œè€Œä¸éœ€è¦åˆ›å»ºæ–°çš„ç›‘å¬å™¨ã€‚</p><p id="6eb5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯åˆ›å»ºä¸€ä¸ª<code class="fe kw kx ky kz b">static class</code>(å—¯ï¼Œä¸€ä¸ªå¸¦æœ‰<code class="fe kw kx ky kz b">static</code>æ–¹æ³•å’Œå˜é‡çš„<code class="fe kw kx ky kz b">class</code>ï¼Œå®ƒå°†ä¿å­˜ä¸€ä¸ªæŸ¥è¯¢åˆ—è¡¨å’Œè¿™äº›æŸ¥è¯¢çš„è®¢é˜…åˆ—è¡¨(ä»¥åŠä¸€ä¸ªä¾¦å¬å™¨å¼•ç”¨åˆ—è¡¨ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°æ¸…ç†å®ƒ)ã€‚</p><pre class="lb lc ld le gt lf kz lg bn lh li bi"><span id="a2a0" class="lj lk iq kz b be ll lm l ln lo">export interface IQueryList {<br/>    [key: string]: {<br/>        query: MediaQueryList;<br/>        subscribers: Array&lt;(matchesQuery: boolean) =&gt; void&gt;;<br/>    };<br/>}<br/><br/>interface IEventListener {<br/>    [key: string]: (event: MediaQueryListEvent) =&gt; void;<br/>}<br/><br/>export class MediaQueryListener {<br/>    private static _subscribers: IQueryList = {};<br/>    private static _eventListenersRefs: IEventListener = {};<br/><br/>    static subscribe() {<br/>        //...<br/>    }<br/>    static unsubscribe() {<br/>        //...<br/>    }<br/>}</span></pre><p id="fe9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™ä¸ªç±»å°†å…¬å¼€ä¸¤ä¸ªå…¬å…±æ–¹æ³•:<code class="fe kw kx ky kz b">subscribe</code>å’Œ<code class="fe kw kx ky kz b">unsubscribe</code>ã€‚</p><p id="7369" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">subscribe</code>æ–¹æ³•æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªè¡¨ç¤ºæŸ¥è¯¢æ˜¯å¦åŒ¹é…çš„<code class="fe kw kx ky kz b">boolean</code>å‚æ•°ï¼Œä»¥åŠä¸€ä¸ªå­—ç¬¦ä¸²æ ¼å¼çš„å®é™…æŸ¥è¯¢(ä¾‹å¦‚:<code class="fe kw kx ky kz b">'(max-width: 768px)'</code>)ã€‚<br/>ç„¶åï¼Œå®ƒæ£€æŸ¥æ˜¯å¦å·²ç»ä»æŸä¸ªå…¶ä»–åœ°æ–¹å¯¹æ­¤æŸ¥è¯¢è¿›è¡Œäº†è®¢é˜…:</p><ul class=""><li id="19c1" class="lp lq iq ka b kb kc kf kg kj lr kn ls kr lt kv lu lv lw lx bi translated">å¦‚æœæ˜¯ï¼Œå®ƒåªå°†å›è°ƒæ·»åŠ åˆ°è¯¥æŸ¥è¯¢çš„è®¢é˜…è€…åˆ—è¡¨ä¸­ã€‚</li><li id="ca35" class="lp lq iq ka b kb ly kf lz kj ma kn mb kr mc kv lu lv lw lx bi translated">å¦‚æœä¸æ˜¯ï¼Œå®ƒå°†æŸ¥è¯¢æ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼Œå”¯ä¸€çš„è®¢é˜…è€…æ˜¯ä¼ é€’çš„å›è°ƒï¼Œç„¶åå®ƒå¼€å§‹ç›‘å¬æ–°åˆ›å»ºçš„æŸ¥è¯¢çš„æ›´æ”¹ã€‚</li></ul><p id="ed15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ— è®ºé‡‡ç”¨å“ªç§æ–¹å¼ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨å½“å‰çš„æŸ¥è¯¢åŒ¹é…ç«‹å³è°ƒç”¨å›è°ƒã€‚</p><pre class="lb lc ld le gt lf kz lg bn lh li bi"><span id="20ce" class="lj lk iq kz b be ll lm l ln lo">static subscribe = (cb: (matchesQuery: boolean) =&gt; void, query: string) =&gt; {<br/>    if (!this._subscribers[query]) {<br/>        this._subscribers[query] = {<br/>            query: window.matchMedia(query),<br/>            subscribers: [ cb ],<br/>        };<br/><br/>        // keep the refs so we can remove the listeners in unsubscribe<br/>        this._eventListenersRefs[query] = event =&gt; {<br/>            this._subscribers[query]<br/>                .subscribers<br/>                .forEach(subscriber =&gt; subscriber(event.matches));<br/>        };<br/><br/>        // create the listener only on first subscription for the query<br/>        this._subscribers[query]<br/>            .query<br/>            .addEventListener('change', this._eventListenersRefs[query]);<br/>    } else {<br/>        this._subscribers[query].subscribers.push(cb);<br/>    }<br/><br/>    // Call the callback with the current value of the media query<br/>    cb(window.matchMedia(query).matches);<br/>};</span></pre><p id="8777" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">unsubscribe</code>æ–¹æ³•æ¥æ”¶ç›¸åŒçš„å›è°ƒå‡½æ•°å’Œå­—ç¬¦ä¸²æ ¼å¼çš„æŸ¥è¯¢ï¼Œå¹¶ä»è¯¥æŸ¥è¯¢çš„è®¢é˜…è€…ä¸­ç§»é™¤å›è°ƒã€‚å®ƒè¿˜æ£€æŸ¥æ˜¯å¦æ²¡æœ‰å‰©ä½™çš„è®¢é˜…è€…ï¼Œå¹¶åˆ é™¤åª’ä½“æŸ¥è¯¢ä¾¦å¬å™¨ï¼Œä»¥ä¾¿æ²¡æœ‰å‰©ä½™çš„æŒ‚èµ·ä¾¦å¬å™¨ã€‚</p><pre class="lb lc ld le gt lf kz lg bn lh li bi"><span id="f9b7" class="lj lk iq kz b be ll lm l ln lo">static unsubscribe = (cb: (matchesQuery: boolean) =&gt; void, query: string) =&gt; {<br/>    if (!this._subscribers[query]) {<br/>        return;<br/>    }<br/><br/>    this._subscribers[query].subscribers = this._subscribers[query].subscribers.filter(subscriber =&gt; subscriber !== cb);<br/>    <br/>    if (this._subscribers[query].subscribers.length === 0) {<br/>        this._subscribers[query].query.removeEventListener('change', this._eventListenersRefs[query]);<br/>        <br/>        delete this._subscribers[query];<br/>        delete this._eventListenersRefs[query];<br/>    }<br/>};</span></pre><p id="376d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ­£å¦‚æˆ‘æ‰€è¯´çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªåœ¨<code class="fe kw kx ky kz b">matchMedia</code> APIä¹‹ä¸Šçš„åŸºæœ¬åŒ…è£…å™¨ã€‚å¯èƒ½æœ‰å¤šä¸ªåŒ…ä»¥è¿™æ ·æˆ–é‚£æ ·çš„æ–¹å¼å®ç°äº†åŒæ ·çš„äº‹æƒ…ï¼Œåœ¨åˆ›å»ºæˆ‘çš„è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘æ²¡æœ‰ä¸“é—¨ç ”ç©¶è¿™äº›åŒ…ï¼Œå› ä¸ºæˆ‘å–œæ¬¢ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆçš„æƒ³æ³•ã€‚</p><p id="ce5c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ„Ÿè°¢æ‚¨é˜…è¯»æ–‡ç« ï¼</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><h1 id="b2d1" class="mk lk iq bd ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bi translated">åˆ†çº§ç¼–ç </h1><p id="71c2" class="pw-post-body-paragraph jy jz iq ka b kb nh kd ke kf ni kh ki kj nj kl km kn nk kp kq kr nl kt ku kv ij bi translated">æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼åœ¨ä½ ç¦»å¼€ä¹‹å‰:</p><ul class=""><li id="8f50" class="lp lq iq ka b kb kc kf kg kj lr kn ls kr lt kv lu lv lw lx bi translated">ğŸ‘ä¸ºæ•…äº‹é¼“æŒï¼Œè·Ÿç€ä½œè€…èµ°ğŸ‘‰</li><li id="0309" class="lp lq iq ka b kb ly kf lz kj ma kn mb kr mc kv lu lv lw lx bi translated">ğŸ“°æ›´å¤šå†…å®¹è¯·æŸ¥çœ‹<a class="ae la" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">å‡çº§ç¼–ç åˆŠç‰©</a></li><li id="d7b3" class="lp lq iq ka b kb ly kf lz kj ma kn mb kr mc kv lu lv lw lx bi translated">ğŸ””å…³æ³¨æˆ‘ä»¬:<a class="ae la" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">æ¨ç‰¹</a> | <a class="ae la" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae la" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">æ—¶äº‹é€šè®¯</a></li></ul><p id="8a15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ğŸš€ğŸ‘‰<a class="ae la" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">åŠ å…¥å‡çº§äººæ‰é›†ä½“ï¼Œæ‰¾åˆ°ä¸€ä»½ç¥å¥‡çš„å·¥ä½œ</strong> </a></p></div></div>    
</body>
</html>