<html>
<head>
<title>How to Select Rows Between Two Dates in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在熊猫中选择两个日期之间的行</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-select-rows-between-two-dates-in-pandas-c6dd6d33ef8?source=collection_archive---------2-----------------------#2022-03-04">https://levelup.gitconnected.com/how-to-select-rows-between-two-dates-in-pandas-c6dd6d33ef8?source=collection_archive---------2-----------------------#2022-03-04</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="cbc6" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">熊猫中日期之间的行选择</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/ac8f3a5a352efa3a9a038495425f375b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7VPnWXcqP9KGxmj7NoZWA.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@jn1434?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Jerin J </a>在<a class="ae kz" href="https://unsplash.com/s/photos/select?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h2 id="3d62" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当处理时间序列数据或任何涉及日期(时间)的数据集时，我们通常需要根据某些特定条件过滤掉行。在今天的简短教程中，我们将展示如何选择特定日期范围内的行。</p><p id="1b98" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">更具体地说，我们将展示如何使用:</p><ul class=""><li id="f6cc" class="mu mv iu ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated">布尔掩码和<code class="fe nd ne nf ng b">loc</code></li><li id="dfb2" class="mu mv iu ly b lz nh mc ni lj nj ln nk lr nl mo mz na nb nc bi translated"><code class="fe nd ne nf ng b">DatetimeIndex</code>和<code class="fe nd ne nf ng b">loc</code></li><li id="0881" class="mu mv iu ly b lz nh mc ni lj nj ln nk lr nl mo mz na nb nc bi translated"><code class="fe nd ne nf ng b">pandas.Series.between</code>方法</li><li id="1358" class="mu mv iu ly b lz nh mc ni lj nj ln nk lr nl mo mz na nb nc bi translated">还有<code class="fe nd ne nf ng b">query</code>法</li></ul></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="2148" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们创建一个示例数据框架，我们将在本教程中使用它来演示一些概念。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="f66a" class="la lb iu ng b gz nx ny l nz oa">import pandas as pd<br/></span><span id="a6dc" class="la lb iu ng b gz ob ny l nz oa">df = pd.DataFrame(<br/>    [<br/>        (1, 'A', <!-- -->'28-02-2020', '30-01-2021', False<!-- -->),<br/>        (2, 'B', '27-01-2019', '21-02-2020', True),<br/>        (3, 'A', '05-02-2021', '01-01-2022', False),<br/>        (4, 'D', '04-01-2019', '02-02-2021', False),<br/>        (5, 'B', '15-12-2021', '25-12-2021', False),<br/>        (6, 'C', '16-03-2021', '10-01-2022', True),<br/>        (7, 'D', '21-05-2018', '01-03-2020', True),<br/>        (8, 'A', '21-05-2019', '20-03-2021', False),<br/>    ],<br/>    columns=['colA', 'colB', 'colC', 'colD', 'colE']<br/>)</span><span id="21b9" class="la lb iu ng b gz ob ny l nz oa"><br/>df[['<!-- -->colC<!-- -->', '<!-- -->colD<!-- -->']] = df[['<!-- -->colC<!-- -->', '<!-- -->colD<!-- -->']].apply(pd.to_datetime)</span><span id="5c0b" class="la lb iu ng b gz ob ny l nz oa">print(df)<br/><strong class="ng iv"><em class="oc">   colA colB       colC       colD   colE<br/>0     1    A 2020-02-28 2021-01-30  False<br/>1     2    B 2019-01-27 2020-02-21   True<br/>2     3    A 2021-05-02 2022-01-01  False<br/>3     4    D 2019-04-01 2021-02-02  False<br/>4     5    B 2021-12-15 2021-12-25  False<br/>5     6    C 2021-03-16 2022-10-01   True<br/>6     7    D 2018-05-21 2020-01-03   True<br/>7     8    A 2019-05-21 2021-03-20  False</em></strong></span></pre><p id="a51b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">注意列<code class="fe nd ne nf ng b">colC</code>和<code class="fe nd ne nf ng b">colD</code>包含<code class="fe nd ne nf ng b">datetime</code>对象:</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="6a9d" class="la lb iu ng b gz nx ny l nz oa">print(df.dtypes)<br/>colA             int64<br/>colB            object<br/><strong class="ng iv">colC    datetime64[ns]<br/>colD    datetime64[ns]</strong><br/>colE              bool<br/>dtype: object</span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="cbd2" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">选择两个日期列之间的行</h2><p id="c32f" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在让我们假设我们想要过滤我们的示例数据帧，以便它只包含列<code class="fe nd ne nf ng b">colC</code>下的日期在<code class="fe nd ne nf ng b">02–02–2019</code>和<code class="fe nd ne nf ng b">02–02–2021</code>之间的行。</p><p id="4b64" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">第一个选项是使用一个<strong class="ly iv">布尔掩码和</strong> <code class="fe nd ne nf ng b"><strong class="ly iv">loc</strong></code> <strong class="ly iv">属性。</strong></p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="9ff3" class="la lb iu ng b gz nx ny l nz oa">mask = (df['colC'] &gt; '2019-2-2') &amp; (df['colC'] &lt;= '2021-2-2')<br/>df_filtered = df.loc[mask]</span><span id="fa9b" class="la lb iu ng b gz ob ny l nz oa">print(df_filtered)<br/><strong class="ng iv"><em class="oc">   colA colB       colC       colD   colE<br/>0     1    A 2020-02-28 2021-01-30  False<br/>3     4    D 2019-04-01 2021-02-02  False<br/>7     8    A 2019-05-21 2021-03-20  False</em></strong></span></pre><p id="1da2" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">请注意，以上内容几乎适用于任何类型的日期列<code class="fe nd ne nf ng b">pd.Timestamp</code>、<code class="fe nd ne nf ng b">datetime.datetime</code>和<code class="fe nd ne nf ng b">np.datetime64</code>。</p><p id="4344" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">或者，您可以使用<code class="fe nd ne nf ng b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.between.html" rel="noopener ugc nofollow" target="_blank">pandas.Series.between</a></code>方法，该方法将返回一个布尔向量，其中包含满足指定范围的行的<code class="fe nd ne nf ng b">True</code>值，否则返回<code class="fe nd ne nf ng b">False</code>。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="ef09" class="la lb iu ng b gz nx ny l nz oa">df_filtered = df[df.colC.between('2019-2-2', '2021-2-2')]</span><span id="cf97" class="la lb iu ng b gz ob ny l nz oa">print(df_filtered)<br/><strong class="ng iv"><em class="oc">   colA colB       colC       colD   colE<br/>0     1    A 2020-02-28 2021-01-30  False<br/>3     4    D 2019-04-01 2021-02-02  False<br/>7     8    A 2019-05-21 2021-03-20  False</em></strong></span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="7ca5" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用索引选择两个日期之间的行</h2><p id="18ac" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">如果您计划频繁应用日期过滤器，那么更改dataframe的索引并将其设置为日期列可能会更明智。然后，您可以使用<code class="fe nd ne nf ng b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.DatetimeIndex.html" rel="noopener ugc nofollow" target="_blank">DatetimeIndex</a></code>来选择那些索引落在使用<code class="fe nd ne nf ng b">loc</code>属性指定的范围内的行。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="79ff" class="la lb iu ng b gz nx ny l nz oa">df = df.set_index(['colC'])<br/>df_filtered = df.loc['2019-2-2':'2021-2-2']</span><span id="8b4b" class="la lb iu ng b gz ob ny l nz oa">print(df_filtered)<br/><strong class="ng iv"><em class="oc">            colA colB       colD   colE<br/>colC<br/>2020-02-28     1    A 2021-01-30  False<br/>2019-04-01     4    D 2021-02-02  False<br/>2019-05-21     8    A 2021-03-20  False</em></strong></span></pre><h2 id="2bbf" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">查询日期列</h2><p id="244a" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">最后，另一个选择是使用类似SQL表达式的<code class="fe nd ne nf ng b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html" rel="noopener ugc nofollow" target="_blank">query</a></code>方法，如下所示:</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="f430" class="la lb iu ng b gz nx ny l nz oa">start_date = '2019-02-02'<br/>end_date = '2021-02-02'<br/>df_filtered = <!-- -->df.query('colC &gt;= @start_date and colC &lt;= @end_date')</span><span id="a289" class="la lb iu ng b gz ob ny l nz oa">print(df_filtered)<br/><strong class="ng iv"><em class="oc">   colA colB       colC       colD   colE<br/>0     1    A 2020-02-28 2021-01-30  False<br/>3     4    D 2019-04-01 2021-02-02  False<br/>7     8    A 2019-05-21 2021-03-20  False</em></strong></span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短教程中，我们展示了如何在日期列上过滤熊猫数据帧，并选择特定日期范围内的行。更具体地说，我们讨论了如何使用布尔掩码和带有<code class="fe nd ne nf ng b">loc</code>属性的<code class="fe nd ne nf ng b">DatetimeIndex</code>或者专门为此设计的名为<code class="fe nd ne nf ng b">between</code>的特殊熊猫方法来实现这一点。最后，我们还展示了如何通过使用类似SQL的表达式查询数据帧来获得等效的结果。</p></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="od oe gq gs of og"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="op l"><div class="oq l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="od oe gq gs of og"><a href="https://towardsdatascience.com/save-trained-models-python-22a11376d975" rel="noopener follow" target="_blank"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">如何用Python在磁盘上保存训练好的模型</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">用scikit探索模型持久性——在Python中学习</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ov l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu og"><a href="https://towardsdatascience.com/pycache-python-991424aabad8" rel="noopener follow" target="_blank"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">Python中__pycache__是什么？</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">了解运行Python代码时创建的__pycache__文件夹</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ow l or os ot op ou kt og"/></div></div></a></div></div></div>    
</body>
</html>