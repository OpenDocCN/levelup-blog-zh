<html>
<head>
<title>When You Should Not Use f-Strings In Python And What You Should Use Instead</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中什么时候不应该使用f字符串，而应该使用什么</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/when-you-should-not-use-f-strings-in-python-and-what-you-should-use-instead-3b89718757bd?source=collection_archive---------0-----------------------#2022-11-12">https://levelup.gitconnected.com/when-you-should-not-use-f-strings-in-python-and-what-you-should-use-instead-3b89718757bd?source=collection_archive---------0-----------------------#2022-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="cd04" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">计算机编程语言</h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/4e10c9f2c8bd6e7d42d905b265d10d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0HwJBEluxu16ZUkyEH_B-Q.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">由<a class="ae ko" href="https://medium.com/@dreamferus" rel="noopener"> Jacob Ferus </a>使用Midjourney生成的图像。</figcaption></figure><p id="4c0d" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">自从在Python 3.6中引入f字符串以来，f字符串变得非常流行，这是有原因的。既简单又简洁。这可以在与Python中的其他方法进行比较时显示出来:</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="be5f" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在大多数情况下，使用f字符串是最干净的选择。也就是说，有些情况下使用<code class="fe lt lu lv lw b">.format()</code>有好处。什么原因？简而言之<strong class="kr jd"> : </strong> <code class="fe lt lu lv lw b"><strong class="kr jd">.format()</strong></code> <strong class="kr jd">可以与字符串解耦。</strong></p><p id="a2f5" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">让我举个例子来说明这一点。假设您有一个应用程序，其中模板用于各种类型的电子邮件、简历等。例如，其中一个模板可能如下所示:</p><blockquote class="lx"><p id="4f72" class="ly lz it bd ma mb mc md me mf mg lm dk translated">亲爱的<receiver_name>，</receiver_name></p><p id="aa04" class="ly lz it bd ma mb mc md me mf mg lm dk translated">我们感谢您对<company_name>的捐赠。我们将努力工作来完成…</company_name></p><p id="cc30" class="ly lz it bd ma mb mc md me mf mg lm dk translated">最诚挚的问候，<br/> &lt;公司名称&gt;</p></blockquote><p id="8f91" class="pw-post-body-paragraph kp kq it kr b ks mh ku kv kw mi ky kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">在这里，我们在&lt;&gt;中有占位符，在每种特定情况下，这些占位符必须由公司和接收方名称来替换。现在，如果您想用Python构建这样一个应用程序，您会怎么做呢？</p><p id="555a" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在括号中使用变量占位符是有意义的，例如<code class="fe lt lu lv lw b">{variable_name}</code>，因为它用在f弦和<code class="fe lt lu lv lw b">.format()</code>中。使用f-string的问题是变量会立即被当前作用域中的变量替换，因此存储模板变得更加复杂。</p><p id="0eab" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">另一方面，使用<code class="fe lt lu lv lw b">.format()</code>效果很好。让我们看一个例子:</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="3ce4" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">可以看出，我们可以很容易地重用带有不同变量的模板，只需将它们添加到<code class="fe lt lu lv lw b">.format()</code>中。还要注意的是，模板并不是某种内部带有占位符的特殊对象，<strong class="kr jd">它只是一个普通的字符串。</strong>这意味着无需额外工作即可轻松将其存储在任何持久存储中。例如:</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="593c" class="mm mn it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">的脆弱性。格式()</h1><p id="12e0" class="pw-post-body-paragraph kp kq it kr b ks nk ku kv kw nl ky kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">综上所述，<code class="fe lt lu lv lw b">.format()</code>的一个问题是它不应该直接<em class="np">应用于从<em class="np">用户输入创建的模板</em>。例如，如果你有一个接受用户模板的API。相反，您必须净化输入以确保没有漏洞。</em></p><p id="40f6" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">以下是这种滥用的一个例子:</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="b128" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因此，虽然它在开发人员创建模板或非用户交互应用程序时很有用，但在用户输入中使用它时必须小心。对于这些情况，有更好的选择吗？</p><h1 id="87c5" class="mm mn it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">用模板类处理用户模板</h1><p id="7406" class="pw-post-body-paragraph kp kq it kr b ks nk ku kv kw nl ky kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">幸运的是，在您确实需要包含来自用户的模板的能力的情况下，并且不必经历额外的清理工作，可以使用<strong class="kr jd">模板类</strong>。它没有<code class="fe lt lu lv lw b">.format()</code>灵活，但避免了注射。见下文:</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="3927" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">和以前一样，这个类只需要一个可以存储在任何地方的普通字符串。</p><h1 id="0f2a" class="mm mn it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">其他应用的例子</h1><p id="c2a6" class="pw-post-body-paragraph kp kq it kr b ks nk ku kv kw nl ky kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">在前面的示例中，电子邮件被替换为适当的详细信息。以下是其他一些可以应用的例子:</p><ul class=""><li id="aca5" class="nq nr it kr b ks kt kw kx la ns le nt li nu lm nv nw nx ny bi translated">格式化聊天机器人的答案</li><li id="cd23" class="nq nr it kr b ks nz kw oa la ob le oc li od lm nv nw nx ny bi translated">语言模型的格式化提示模板(例如GPT-3)</li><li id="80f3" class="nq nr it kr b ks nz kw oa la ob le oc li od lm nv nw nx ny bi translated">按一天中的时间格式化邮件</li></ul><p id="3fc5" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">感谢阅读！</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><p id="4e63" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果您有兴趣阅读更多关于Python的文章，请查看我下面的阅读列表:</p><div class="ol om gp gr on"><div role="button" tabindex="0" class="ab bv gv cb fp oo op bn oq ki ex"><div class="or l"><div class="ab q"><div class="l di"><img alt="Jacob Ferus" class="l de bw os ot fe" src="../Images/3fe8a4152942d124e84f4370bdeaa704.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*kBjZOzA4VnMIigyfQz5-KQ.png"/><div class="fb bw l os ot fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated">雅各布·费罗斯</p></div></div><div class="ow ox gw l"><h2 class="bd jd uh nq fp ui fr fs uj fu fw jc bi translated">计算机编程语言</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi uk au ul um un qr uo an eh ei up uq ur el em eo de bk ep" href="https://medium.com/@dreamferus/list/python-c8e4719d93da?source=post_page-----3b89718757bd--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="us l fo"><span class="bd b dl z dk">32 stories</span></div></div></div><div class="pj dh pk fp ab pl fo di"><div class="di pb bv pc pd"><div class="dh l"><img alt="" class="dh" src="../Images/04c5beba0e198bb074b51dab1e99cea5.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*NDYYDnoigpuPoAeetcRcFg.png"/></div></div><div class="di pb bv pe pf pg"><div class="dh l"><img alt="" class="dh" src="../Images/ddc10e2a657adb0dca6dc40fbab3ef74.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*s5kLvTIF2VvEEahx_OJaXA.png"/></div></div><div class="di bv ph pi pg"><div class="dh l"><img alt="" class="dh" src="../Images/c0376aaf2f82f915fbbb9e6f86a2c621.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*m7BwF83vfu-cfexGQ8px0w.png"/></div></div></div></div></div><p id="9d57" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果你想成为中级会员，你可以使用我的<a class="ae ko" href="https://medium.com/@dreamferus/membership" rel="noopener">推荐链接</a>。祝你有愉快的一天。</p></div></div>    
</body>
</html>