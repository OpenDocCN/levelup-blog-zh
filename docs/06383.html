<html>
<head>
<title>Deep Linking on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android上的深度链接</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deep-linking-on-android-302fd4ddc67d?source=collection_archive---------3-----------------------#2020-11-20">https://levelup.gitconnected.com/deep-linking-on-android-302fd4ddc67d?source=collection_archive---------3-----------------------#2020-11-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="f5f5" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">什么是深度链接？</h1><p id="4bdd" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">深度链接是一个帮助用户在<strong class="kn ir">网络</strong>和<strong class="kn ir">应用之间导航的概念。</strong>它们基本上是将用户直接导航到<strong class="kn ir">应用程序中特定内容的URL。</strong></p><p id="71cc" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">有时你想让用户容易地到达你的应用程序流程中的一个特定部分，而不必从开始屏幕<em class="lo">点击-点击-点击</em>到达那里。例如，也许你想在一个聊天应用程序中显示正在进行的对话，或者在一个购物应用程序中显示用户的购物车。你可以使用深层链接来做到这一点，在应用程序之外，在快捷方式和通知中显示这些链接，允许用户从这些其他位置单击并到达应用程序的更深层部分。</p><h1 id="33bd" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">深度链接和app链接有什么区别？</h1><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/2dfdc5aa6103e159781ac97f607dde24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*oP4m1EzGW_SHGm_r.png"/></div></figure><p id="d0bd" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">一个<strong class="kn ir">深度链接</strong>是一个意图过滤系统，允许用户在Android应用程序中直接输入特定活动。然而，这个过程有一个<strong class="kn ir">问题</strong>。当用户点击一个URL时，它可能会打开一个对话框，要求用户从处理给定URL的多个应用程序中选择一个。</p><p id="d66f" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">另一方面，<strong class="kn ir">一个Android应用程序链接</strong>是一个基于你的网站URL的深度链接，已经被验证属于你的网站。当用户点击该网址时，它会打开你的应用程序。</p><h1 id="b77d" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">如何创造深度链接？</h1><p id="3e05" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">当用户单击URL时，Android系统会按顺序尝试以下每个操作，直到请求成功:</p><ol class=""><li id="8e79" class="lx ly iq kn b ko lj ks lk kw lz la ma le mb li mc md me mf bi translated">打开可以处理URI的用户首选应用程序(如果已指定)。</li><li id="1ed5" class="lx ly iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">打开唯一可用的可以处理URI的应用程序。</li><li id="0eea" class="lx ly iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">允许用户从对话框中选择应用程序。</li></ol><h1 id="997c" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">为传入链接添加意图过滤器</h1><p id="5e1a" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">要创建应用程序内容的链接，请在清单中添加包含这些元素和属性值的意图过滤器:</p><blockquote class="ml mm mn"><p id="69af" class="kl km lo kn b ko lj kq kr ks lk ku kv mo ll ky kz mp lm lc ld mq ln lg lh li ij bi translated"><code class="fe mr ms mt mu b"><strong class="kn ir">&lt;action&gt;</strong><br/></code> <em class="iq">指定</em> <code class="fe mr ms mt mu b"><em class="iq">ACTION_VIEW</em></code> <em class="iq">意图动作，以便可以从Google搜索到达意图过滤器。</em></p></blockquote><pre class="lq lr ls lt gt mv mu mw mx aw my bi"><span id="d7f4" class="mz jo iq mu b gy na nb l nc nd">&lt;action android:name=”android.intent.action.VIEW” /&gt;</span></pre><blockquote class="ml mm mn"><p id="1a67" class="kl km lo kn b ko lj kq kr ks lk ku kv mo ll ky kz mp lm lc ld mq ln lg lh li ij bi translated"><code class="fe mr ms mt mu b"><strong class="kn ir">&lt;category&gt;</strong><br/></code> <code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/content/Intent#CATEGORY_BROWSABLE" rel="noopener ugc nofollow" target="_blank"><em class="iq">BROWSABLE</em></a></code> <em class="iq"> —这是从web浏览器访问意图过滤器所必需的。如果没有它，在浏览器中单击链接将无法解析到您的应用程序。<br/> </em> <code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/content/Intent#CATEGORY_DEFAULT" rel="noopener ugc nofollow" target="_blank"><em class="iq">DEFAULT</em></a></code> <em class="iq"> —这允许你的应用程序响应隐含的意图。否则，只有在意向指定了您的应用程序组件名称时，活动才能开始。</em></p></blockquote><pre class="lq lr ls lt gt mv mu mw mx aw my bi"><span id="f320" class="mz jo iq mu b gy na nb l nc nd">&lt;category android:name="android.intent.category.DEFAULT" /&gt;        &lt;category android:name="android.intent.category.BROWSABLE" /&gt;</span></pre><blockquote class="ml mm mn"><p id="a8b0" class="kl km lo kn b ko lj kq kr ks lk ku kv mo ll ky kz mp lm lc ld mq ln lg lh li ij bi translated"><code class="fe mr ms mt mu b"><strong class="kn ir">&lt;data&gt;</strong></code> <strong class="kn ir"> </strong> <br/>数据标签表示解析为活动的URI格式。<br/>至少，<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/guide/topics/manifest/data-element" rel="noopener ugc nofollow" target="_blank">&lt;data&gt;</a></code>标签必须包含<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/guide/topics/manifest/data-element#scheme" rel="noopener ugc nofollow" target="_blank">android:scheme</a></code>属性。</p></blockquote><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6a18d2abd79a0a1c72268bb1052e5f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JtSeWEMBk73Hs4lMu8vxA.png"/></div></figure><p id="503c" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">您可以添加更多的属性来进一步细化活动接受的URI的类型。例如，您可能有多个接受相似URIs的活动，但它们的区别仅在于路径名。在这种情况下，使用<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/guide/topics/manifest/data-element#path" rel="noopener ugc nofollow" target="_blank">android:path</a></code>属性或其<code class="fe mr ms mt mu b">pathPattern</code>或<code class="fe mr ms mt mu b">pathPrefix</code>变量来区分系统应该为不同的URI路径打开哪个活动。</p><p id="ede0" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">请参见下面完整的xml。</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="5cd4" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">现在URL“<strong class="kn ir">http://Medium.com/activity</strong>”和“<strong class="kn ir">样本://活动</strong>”将做同样的工作。他们都将解决相同的活动。<br/>对于多条路径，主机和方案将是相同的，您可以用“路径前缀”、“路径模式”来表示路径。</p><p id="6ad7" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">现在注意一件事，你可以在一个意图过滤器中有多个<code class="fe mr ms mt mu b">data</code>点，就像上面的例子一样。他们将支持<a class="ae ne" href="http://Medium.com/activity" rel="noopener"><strong class="kn ir"/></a><strong class="kn ir"/><strong class="kn ir"/><a class="ae ne" href="http://Medium.com/activity" rel="noopener"><strong class="kn ir">https://www.Medium.com/activity</strong></a><strong class="kn ir"/>而且还有<a class="ae ne" href="http://Medium.com/activity" rel="noopener"><strong class="kn ir"/></a><strong class="kn ir"/><a class="ae ne" href="http://Medium.com/activity" rel="noopener"><strong class="kn ir">【http://www.Medium.com/】</strong></a><strong class="kn ir"/>意思是所有方案和主机的组合。</p><p id="079d" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">例子:<a class="ae ne" href="http://Medium.com/activity" rel="noopener"><strong class="kn ir">https://www.Medium.com/activity</strong></a><strong class="kn ir">/故事</strong></p><p id="ab14" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">从应用程序内部或外部的任何地方点击此链接后，您将直接进入故事页面，无需通过点击导航。</p><h1 id="bba6" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">从传入意向中读取数据</h1><p id="2f87" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">一旦系统通过意图过滤器启动您的活动，您就可以使用由<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/content/Intent" rel="noopener ugc nofollow" target="_blank">Intent</a></code>提供的数据来确定您需要呈现什么。调用<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/content/Intent#getData()" rel="noopener ugc nofollow" target="_blank">getData()</a></code>和<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/content/Intent#getAction()" rel="noopener ugc nofollow" target="_blank">getAction()</a></code>方法来检索与传入的<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/content/Intent" rel="noopener ugc nofollow" target="_blank">Intent</a></code>相关联的数据和动作。您可以在活动生命周期中的任何时候调用这些方法，但是您通常应该在早期回调时这样做，例如<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/app/Activity#onCreate(android.os.Bundle)" rel="noopener ugc nofollow" target="_blank">onCreate()</a></code>或<code class="fe mr ms mt mu b"><a class="ae ne" href="https://developer.android.com/reference/android/app/Activity#onStart()" rel="noopener ugc nofollow" target="_blank">onStart()</a></code>。</p><pre class="lq lr ls lt gt mv mu mw mx aw my bi"><span id="269e" class="mz jo iq mu b gy na nb l nc nd">override fun onCreate(savedInstanceState: Bundle?) {<br/>    super.onCreate(savedInstanceState)<br/>    setContentView(R.layout.main)<br/><br/>    val action: String? = intent?.action<br/>    val data: Uri? = intent?.data<br/>}</span></pre><p id="d789" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">最佳实践:</strong></p><ul class=""><li id="f7bf" class="lx ly iq kn b ko lj ks lk kw lz la ma le mb li ni md me mf bi translated">处理空数据</li><li id="30a8" class="lx ly iq kn b ko mg ks mh kw mi la mj le mk li ni md me mf bi translated">您需要有一个<strong class="kn ir">单独的深度链接活动</strong>来处理所有需要登录、完成入职等情况。隔离入口点将提供处理事情的灵活性，并提供更干净的代码来维护。</li><li id="e472" class="lx ly iq kn b ko mg ks mh kw mi la mj le mk li ni md me mf bi translated">最好用<strong class="kn ir">验证并呈现</strong>页面内容，因为目的页面是隐藏的，可能会有安全问题。最好在呈现页面之前进行验证</li><li id="6ff2" class="lx ly iq kn b ko mg ks mh kw mi la mj le mk li ni md me mf bi translated">保持后退动作。遵循<a class="ae ne" href="https://developer.android.com/design/patterns/navigation" rel="noopener ugc nofollow" target="_blank">中描述的设计指南，让用户通过深层链接进入你的应用后，你的应用能满足他们对反向导航的期望。</a></li></ul><h1 id="68b9" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">测试你的深层链接:</h1><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi nj"><img src="../Images/d0cc723280079e946519889a8c26a2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QHJfn5ZCk7Udix_j11_m8w.png"/></div></div></figure><p id="a58a" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">方法一</strong>:安装深度链接测试仪应用:<br/><a class="ae ne" href="https://play.google.com/store/apps/details?id=org.thewheatfield.android.deeplinks&amp;hl=en&amp;gl=US" rel="noopener ugc nofollow" target="_blank">https://play.google.com/store/apps/details?id = org . thewheatfield . Android . deep links&amp;HL = en&amp;GL = US</a></p><p id="26e5" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">当你打开应用程序时，你会看到一个这样的页面，粘贴你的网址，看看它是否会从你的应用程序打开所需的页面。</p><p id="c7a8" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">方法2: </strong>您可以使用<a class="ae ne" href="https://developer.android.com/tools/help/adb" rel="noopener ugc nofollow" target="_blank"> Android调试桥</a>和活动管理器(am)工具来测试您为深度链接指定的意图过滤器URIs是否解析到正确的应用活动。您可以针对设备或模拟器运行adb命令。<br/>用adb测试意图过滤器URI的一般语法是:</p><pre class="lq lr ls lt gt mv mu mw mx aw my bi"><span id="5b42" class="mz jo iq mu b gy na nb l nc nd">$ adb shell am start<br/>        -W -a android.intent.action.VIEW<br/>        -d &lt;URI&gt; &lt;PACKAGE&gt;</span></pre><p id="b169" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">对于我们的例子，它将是这样的</p><p id="1f5b" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><a class="ae ne" href="http://Medium.com/activity" rel="noopener"><strong class="kn ir">https://www.Medium.com/activity</strong></a><strong class="kn ir">/故事会</strong></p><pre class="lq lr ls lt gt mv mu mw mx aw my bi"><span id="f038" class="mz jo iq mu b gy na nb l nc nd">$ adb shell am start<br/>        -W -a android.intent.action.VIEW<br/>        -d "https://www.Medium.com/activity/stories" com.example.android</span></pre><p id="ac17" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">上面设置的清单声明和意图处理程序定义了应用程序和网站之间的连接，以及如何处理传入的链接。</p><p id="5476" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">我在下面添加了一些关于深层链接开发者面临的常见问题的链接:</strong></p><ul class=""><li id="d243" class="lx ly iq kn b ko lj ks lk kw lz la ma le mb li ni md me mf bi translated"><a class="ae ne" href="https://medium.com/mobile-app-development-publication/breaking-deep-link-unknowing-by-adding-another-deep-link-14773fea1de" rel="noopener">https://medium . com/mobile-app-development-publication/breaking-deep-link-unknown-by-adding-another-deep-link-14773 fea1de</a></li><li id="0e02" class="lx ly iq kn b ko mg ks mh kw mi la mj le mk li ni md me mf bi translated"><a class="ae ne" rel="noopener ugc nofollow" target="_blank" href="/the-wrong-hacked-and-correct-way-of-android-deep-linking-for-redirected-multisite-with-autoverify-5c72fb1f8053">https://level up . git connected . com/the-wrong-hacked-and-correct-way-of-Android-deep-linking-for-redirected-multisite-with-auto verify-5c 72 FB 1 f 8053</a></li><li id="df53" class="lx ly iq kn b ko mg ks mh kw mi la mj le mk li ni md me mf bi translated"><a class="ae ne" href="https://medium.com/mobile-app-development-publication/unrealized-deeplink-bug-on-many-apps-6ac78a557702" rel="noopener">https://medium . com/mobile-app-development-publication/unrealized-deep link-bug-on-many-apps-6a c78 a 557702</a></li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="9a18" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">感谢您的阅读。👏我真的希望这篇文章对你有所帮助。非常感谢你的鼓掌帮助其他人找到这篇文章😃。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/5ca8d627247d1b87ba83b4a9c6be1b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*7uvl6PNPQF7MelPG.gif"/></div></figure></div></div>    
</body>
</html>