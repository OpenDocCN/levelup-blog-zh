<html>
<head>
<title>Web Scraping With R (Part 2 — Dynamic Webpages)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R进行网页抓取(第二部分——动态网页)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/web-scraping-with-r-part-2-dynamic-webpages-de620a161671?source=collection_archive---------3-----------------------#2020-06-28">https://levelup.gitconnected.com/web-scraping-with-r-part-2-dynamic-webpages-de620a161671?source=collection_archive---------3-----------------------#2020-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/917e9a2c5696d5ab7a2c78626255d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4TLlisFk7XvtREAsS7C7Q.jpeg"/></div></div></figure><p id="41a5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我之前的文章中，我写了关于静态网页抓取的内容。</p><div class="kz la gp gr lb lc"><a rel="noopener  ugc nofollow" target="_blank" href="/web-scraping-with-r-part-1-static-webpages-37e6d4f11d07"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">使用R进行网页抓取(第1部分—静态网页)</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">有一段时间了，我很高兴回来了！在这整个期间，我花了很多时间在网上冲浪，我…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq jz lc"/></div></div></a></div><p id="581f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本教程中，我们将看看如何抓取动态网页。与静态网页相比，动态网页是使用Javascript从数据库中提取数据的页面，并且信息变化频繁。</p><p id="c52f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果您尝试使用Rvest抓取静态网页，您可能无法在网站上获得通过Javascript创建的动态信息。因此，我们可以使用额外的库硒元素来解决这个问题。</p><p id="f3d7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，我们可以安装并加载RSelenium库以及之前用于静态网页的其他库。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lr"><img src="../Images/29842c945ded0d3e827dd7864fd1f75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h0vfyIGvTgIzfttSQKX8zQ.png"/></div></div></figure><p id="4bf4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">RSelenium库允许我们打开一个浏览器来传递命令以获得所需的信息。在这个例子中，我会使用谷歌浏览器。</p><p id="94b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将首先通过<strong class="kd iu"> rsDriver() </strong>函数启动Selenium服务器和浏览器。然后，我们将继续使用我们选择运行的端口号来设置浏览器类型。</p><p id="d23a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如需了解更多信息，请查看CRAN软件包:<a class="ae lw" href="https://cran.r-project.org/web/packages/RSelenium/RSelenium.pdf" rel="noopener ugc nofollow" target="_blank">https://CRAN . r-project . org/web/packages/RSelenium/RSelenium . pdf</a>。</p><p id="7d2f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有时，由于谷歌Chrome版本的原因，加载Selenium服务器和浏览器可能会出现问题。因此，找到可用的Selenium版本的一个很好的方法是首先使用<strong class="kd iu">binman::list _ versions(" chrome driver ")</strong>函数检查当前获得的版本。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/1699a0a8c072fc4e288caccb22d57c2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*Nb73_1ypQtKFUl-90j_gYQ.png"/></div></figure><p id="bcba" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我从读者那里收到了一些消息，表明在运行上面的代码binman::list_versions()时出现了一个错误。</p><h2 id="4bb6" class="ly lz it bd ma mb mc dn md me mf dp mg km mh mi mj kq mk ml mm ku mn mo mp mq bi translated">编辑:变通解决方案</h2><p id="f6cc" class="pw-post-body-paragraph kb kc it kd b ke mr kg kh ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky im bi translated">这可能是用户的浏览器不匹配，例如Chrome版本和Selenium的网络驱动程序。不要烦恼；这有一个简单的解决方法。</p><ol class=""><li id="d179" class="mw mx it kd b ke kf ki kj km my kq mz ku na ky nb nc nd ne bi translated">删除binman::list_versions()代码</li><li id="1c93" class="mw mx it kd b ke nf ki ng km nh kq ni ku nj ky nb nc nd ne bi translated">根据您的浏览器类型，首先，检查您的浏览器运行的版本。对于Chrome，点击顶部的三个点&gt;帮助&gt;关于谷歌Chrome，查看您当前使用的版本。</li></ol><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/aef10d881446a8708dc0999a859cb4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEfJv8qEw_3Rl5gyfpM8Gw.png"/></div></div></figure><p id="72fc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我写这篇文章的时候，Chrome的运行版本是87.0.4280.141。(第87版)</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/d4f57a1f6f8922afe407c6ecc86d6384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jf0wZ0jwabJ9nfPmzkKk9w.png"/></div></div></figure><p id="be58" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">4.接下来，通过下面的链接查看不同Chrome版本的Selenium web驱动程序。<a class="ae lw" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank">https://chromedriver.chromium.org/downloads</a></p><p id="c519" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以看到，它建议我使用ChromeDriver 87.0.4280.88，因为我的Chrome运行的是87版。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/3f2fe7af9da4a684d701632f0228a670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cuue2pxRloZ98yNfndfcjQ.png"/></div></div></figure><p id="d346" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">5.从那里，我们将在这个实例中输入ChromeDriver版本:87.0.4280.88到我们的代码中，它应该允许我们启动一个远程浏览器。</p><p id="1464" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">完成后，您可以继续遵循下面的指南。如果您遇到任何问题，请随时联系我们，我会尽全力尽快解决。谢谢大家！</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/6a0e8eac07789e74fd5a56cac6df2203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzmBDJTIFTe3MGIKHwWbeg.png"/></div></div></figure></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="e400" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦我们获得了chrome的当前版本，我们就可以在我们的<strong class="kd iu"> rsDriver() </strong>函数中输入版本。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/e63438eb538af92d022fe95dd33a986a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qzrAB-Co8CLWHcLfCRS7CA.png"/></div></div></figure><p id="d4a7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当该函数成功连接到远程服务器并打开新的Google Chrome浏览器来传递我们的参数时，您就会知道它成功了。</p><p id="ae0d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这个例子中，假设我正在购买乐高玩具作为给朋友的生日礼物，我想获得在我国一个流行的购物平台上的各种乐高玩具的产品名称和价格。</p><p id="445d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，我会检查抓取权限，以避免违反网站的任何服务条款。如果您还没有阅读本教程的第1部分，我们可以通过在网站域名末尾添加/robots.txt来快速检查一下。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/8001a62749f548dac1f6b0573165a34b.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*HcPm-yKwpranKtFWk8ETgQ.png"/></div></figure><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/5393f458308bdeae56319ac8492810b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*6s3AJEswJq662gCjEpN9Eg.png"/></div></figure><p id="9128" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">太好了！看来我们要刮的网站不在禁止列表下。然后，我们可以使用<strong class="kd iu"> $navigate() </strong>函数导航我们的远程驱动程序。然后我们将使用<strong class="kd iu"> remDr$getPageSource() </strong>来读取HTML数据。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ny"><img src="../Images/4710c7604156fe51d47e634129d5f68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CGfXVQxFNN5ut_A_T3T2Q.png"/></div></div></figure><p id="f452" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦我们到达这个阶段，我们就可以通过Selenium浏览器抓取动态网页。然后，我们将使用Rvest中的函数，就像我们在本指南的第1部分中所做的那样。</p><p id="829c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将使用方便的SelectorGadget工具来突出显示包含我们想要抓取的信息的节点。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/a554069a2cd19a38ffcbf23341d0c32b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Az8hC1lHDLGvL6S8jqbiQ.png"/></div></div></figure><p id="3c29" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们还使用了<strong class="kd iu"> str() </strong>函数来确保获得正确的产品数量和价格，以防止在选择要抓取的节点时遗漏值。从我们的抓取输出来看似乎不错，似乎这个特定的页面包含30个产品。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/64f18311ca15da398106a450d6c8d3d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xRGVzikh8d4X8Ea4uG2kw.png"/></div></div></figure><p id="a323" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们可以使用<strong class="kd iu"> data.frame() </strong>函数将两个对象合并成一个数据框，或者将其导出为CSV文件。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/18383da57a17432d8ed8a144410d8c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TjRdK1pmL1v97bVy8eKuA.png"/></div></div></figure><p id="1cc7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">输出</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/6d815a7d334d1600cb4b9eed9367aa52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*rR2LQBiCaFhtWVemYSQU6w.png"/></div></figure><p id="af40" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">导出为CSV文件</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/3a36f931a206cc0cb39de283e5744151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8GVJSZbDaK4P_XHW-BxUVw.png"/></div></div></figure><p id="52b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">页（page的缩写）记住使用<strong class="kd iu"> setwd() </strong>函数设置您的工作目录，以便于定位您导出的文件！</p><p id="b5d0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我们完成本教程之前的最后一步，因为我们知道通过启动Selenium，我们在远程服务器上运行它，它必须被关闭才能在未来的应用程序中访问相同的端口号。</p><p id="e945" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，当我们完成时，我们应该总是记得关闭我们的服务器和远程驱动程序。</p><figure class="ls lt lu lv gt ju gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/427ecafa4dc5f51d4fc7322fa66a92c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*pRNuIGhDWcT5xwzsI3ov7w.png"/></div></figure><p id="0426" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是关于静态和动态网页抓取的快速2部分系列。我希望你已经学到了一些新的东西，并尝试抓取静态和动态网页。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="cc16" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">好奇的学习者？释放你在媒体上学习的全部潜力，用不到一杯咖啡的钱支持像我这样的作家。</p><div class="kz la gp gr lb lc"><a href="https://lzpdatascience.medium.com/membership" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">通过我的推荐链接加入媒体——杰森·LZP</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">lzpdatascience.medium.com</p></div></div><div class="ll l"><div class="of l ln lo lp ll lq jz lc"/></div></div></a></div><p id="19a6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">刚接触R编程，不知道从哪里开始？看看我的电子书一步一步的指南！</p><div class="kz la gp gr lb lc"><a href="https://link.medium.com/KoWL3MZMZbb" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">数据科学入门指南(PDF /电子书</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">有一段时间了，我希望每个人都保持安全和健康。本月初，由于封锁，我刚刚…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">link.medium.com</p></div></div><div class="ll l"><div class="og l ln lo lp ll lq jz lc"/></div></div></a></div></div></div>    
</body>
</html>