<html>
<head>
<title>How to install an Nvidia GPU driver on an AWS EC2 instance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在AWS EC2实例上安装Nvidia GPU驱动程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-install-an-nvidia-gpu-driver-on-an-aws-ec2-instance-20185c1c578c?source=collection_archive---------3-----------------------#2022-09-08">https://levelup.gitconnected.com/how-to-install-an-nvidia-gpu-driver-on-an-aws-ec2-instance-20185c1c578c?source=collection_archive---------3-----------------------#2022-09-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5a9e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">AWS提供的AMI映像并不支持所有AWS EC2实例类型，但幸运的是，您可以通过不到10个简单的步骤自己安装一个GPU驱动程序。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/00cdb5a13ef99d00818559b1b557f4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R7CAIrGscn2tOeHF"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@christianw?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯蒂安·威迪格</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="edbc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您已经使用<em class="ls">深度学习AMI GPU py torch 1 . 11 . 0(Ubuntu 20.04)20220824</em>映像启动了一个AWS EC2 <em class="ls"> p2.xlarge </em>实例，现在您想要运行一些GPU密集型Python脚本，例如为时间序列预测训练一个<a class="ae kv" href="https://towardsdatascience.com/how-to-make-a-pytorch-transformer-for-time-series-forecasting-69e073d4061e" rel="noopener" target="_blank">转换器。</a></p><p id="1610" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将失败。它会告诉你这个实例没有GPU。</p><p id="1515" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你<a class="ae kv" href="https://repost.aws/questions/QUQOTlY57YQ7q2H0XxSoZboA/why-is-the-gpu-not-working-out-of-the-box-for-deep-learning-ami-ec-2-instance" rel="noopener ugc nofollow" target="_blank">想知道</a>为什么GPU不能使用深度学习AMI为你的AWS EC2 p2实例开箱即用，那是因为这些深度学习AMI<a class="ae kv" href="https://aws.amazon.com/releasenotes/aws-deep-learning-ami-gpu-pytorch-1-11-ubuntu-20-04/" rel="noopener ugc nofollow" target="_blank">只在特定实例类型上受支持</a>，如G3、P3、P3dn、P4d、G5、G4dn。</p><p id="cd2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是有一个解决方法，允许您在AWS EC2 p2实例上安装Nvidia GPU驱动程序，并使该实例识别GPU，以便您的Python / PyTorch脚本可以使用它。</p><p id="532f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我花了几个小时试图找出如何在我的EC2实例上正确安装Nvidia GPU，在AWS wizard同事的帮助下，终于成功了。为了省去你的麻烦，我发了这个帖子。一旦知道怎么做，真的很简单。</p><p id="25c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是如何在AWS EC2实例上安装Nvidia GPU驱动程序，如与深度学习AMI一起启动的p2.xlarge:</p><ol class=""><li id="34af" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated"><a class="ae kv" href="https://awstip.com/how-to-launch-an-aws-ec2-instance-upload-and-run-a-python-file-from-it-5eef1e1fdc04" rel="noopener ugc nofollow" target="_blank">启动实例并通过ssh连接</a>，例如使用Putty。在Amazon Linux AMI上，你必须用来连接的用户名是“ec2-user ”,但是在Ubuntu AMI上，用户名是“Ubuntu”</li><li id="c486" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">运行<code class="fe mh mi mj mk b">sudo apt-get update</code></li><li id="87ae" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">运行<code class="fe mh mi mj mk b">sudo apt-get upgrade</code>(注意2和3的区别)</li><li id="cc2a" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">通过运行<code class="fe mh mi mj mk b">sudo reboot</code>重新启动实例—当实例重新启动时，putty会话将变为非活动状态。可能需要几分钟才能通过新会话进行连接。</li><li id="dac3" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">运行<code class="fe mh mi mj mk b">sudo apt-get install xorg</code></li><li id="dbdc" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">运行<code class="fe mh mi mj mk b">sudo apt-get install nvidia-driver-460</code></li><li id="310f" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">再次重启:<code class="fe mh mi mj mk b">sudo reboot</code></li><li id="bc91" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">运行<code class="fe mh mi mj mk b">nvidia-smi</code>以验证GPU现已安装。</li><li id="5fe7" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">要测试PyTorch是否能够访问和使用GPU，您可以运行命令<code class="fe mh mi mj mk b">pip install torch</code>，然后上传包含以下代码的文件，并从Putty命令行运行该文件，如下所示<code class="fe mh mi mj mk b">python3 get_gpu_devices.py</code>，输出应该是“真”和“0”(假设您在AWS EC2 p2.xlarge实例上)</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ml mm l"/></div></figure></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="e065" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！我希望你喜欢这篇文章🤞</p><p id="73df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请随意关注。我有时会写一些关于<a class="ae kv" href="https://awstip.com/how-to-launch-an-aws-ec2-instance-upload-and-run-a-python-file-from-it-5eef1e1fdc04" rel="noopener ugc nofollow" target="_blank"> AWS的技巧</a>。我也写关于<a class="ae kv" href="https://towardsdatascience.com/how-to-make-a-pytorch-transformer-for-time-series-forecasting-69e073d4061e" rel="noopener" target="_blank">时间序列预测</a>、<a class="ae kv" href="https://kaspergroesludvigsen.medium.com/the-10-most-energy-efficient-programming-languages-6a4165126670" rel="noopener">绿色软件工程</a>和<a class="ae kv" href="https://towardsdatascience.com/8-podcast-episodes-on-the-climate-impact-of-machine-learning-54f1c19f52d" rel="noopener" target="_blank">数据科学的环境影响</a>🍀</p><p id="10f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请随时在LinkedIn上与我联系。</p></div></div>    
</body>
</html>