<html>
<head>
<title>Use React refs for individual field validation with auto-focused inputs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React refs通过自动聚焦输入进行单个字段验证</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/add-individual-field-validation-with-auto-focused-input-to-login-form-3267bd27d67c?source=collection_archive---------1-----------------------#2020-03-21">https://levelup.gitconnected.com/add-individual-field-validation-with-auto-focused-input-to-login-form-3267bd27d67c?source=collection_archive---------1-----------------------#2020-03-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7c49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">了解如何使用多个引用并管理输入焦点</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/dc419e97e633558152411dfe239767ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MlWQO-6Kczot-hru"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@chaseelliottclark?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">蔡斯·克拉克</a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="d62a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将探讨如何在页面加载时自动将焦点添加到输入字段，并显示单个输入字段验证错误，相应的输入字段会自动聚焦到验证错误上。这避免了用户聚焦输入元素来输入值的需要。</p><p id="dd65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以让我们开始吧。</p><p id="8d93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用<code class="fe lc ld le lf b">create-react-app</code>来初始化项目。</p><p id="735b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过运行以下命令创建一个新项目</p><pre class="km kn ko kp gt lg lf lh li aw lj bi"><span id="7c9e" class="lk ll iq lf b gy lm ln l lo lp">create-react-app login-validation-focus</span></pre><p id="a480" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">项目创建完成后，删除<code class="fe lc ld le lf b">src</code>文件夹中的所有文件，在<code class="fe lc ld le lf b">src</code>文件夹中创建<code class="fe lc ld le lf b">index.js</code>、<code class="fe lc ld le lf b">App.js</code>、<code class="fe lc ld le lf b">styles.css</code>文件。</p><p id="dd6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，您的文件夹结构将如下所示</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lq"><img src="../Images/1ee02549a0388abb93dbaede637a7e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1tpBkEj8DKani3SBybP2Rw.png"/></div></div></figure><p id="93ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用<code class="fe lc ld le lf b">react-bootstrap</code>和<code class="fe lc ld le lf b">bootstrap</code>使应用程序响应迅速，因此安装时使用:</p><pre class="km kn ko kp gt lg lf lh li aw lj bi"><span id="e041" class="lk ll iq lf b gy lm ln l lo lp">npm install react-bootstrap@1.0.0-beta.16 bootstrap@4.4.1</span></pre><p id="7eca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开index.js并添加以下代码:</p><pre class="km kn ko kp gt lg lf lh li aw lj bi"><span id="355c" class="lk ll iq lf b gy lm ln l lo lp">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import App from './App';<br/>import 'bootstrap/dist/css/bootstrap.min.css';<br/>import './styles.css';</span><span id="8e55" class="lk ll iq lf b gy lr ln l lo lp">const rootElement = document.getElementById('root');<br/>ReactDOM.render(&lt;App /&gt;, rootElement);</span></pre><p id="611d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开styles.css并添加以下代码:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="bd74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开App.js并添加以下代码:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="abb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好，现在让我们来理解这个代码。</p><p id="9569" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.我们在这里使用<code class="fe lc ld le lf b">useState</code>钩子来处理状态。如果你是React钩子的新手，看看这篇文章了解钩子的基础知识</p><p id="efe7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.此外，我们还添加了<code class="fe lc ld le lf b">email</code>和<code class="fe lc ld le lf b">password</code>输入字段以及它们的<code class="fe lc ld le lf b">onChange</code>处理程序</p><p id="5886" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.每个输入字段都有一个与状态属性完全匹配的名称，因此我们可以在表单提交处理程序中轻松设置状态。</p><p id="4801" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.我们使用单个事件处理器<code class="fe lc ld le lf b">handleInputChange</code>来处理电子邮件和密码输入字段的更改</p><p id="538c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.我们已经使用<code class="fe lc ld le lf b">useRef</code>钩子创建了两个独立的引用<code class="fe lc ld le lf b">emailRef</code>和<code class="fe lc ld le lf b">passwordRef</code>，并使用<code class="fe lc ld le lf b">ref={emailRef}</code>和<code class="fe lc ld le lf b">ref={passwordRef}</code>将引用分配给各自的输入字段，因此我们可以管理输入字段的焦点</p><p id="f591" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果您根据您的<code class="fe lc ld le lf b">create-react-app</code>版本使用<code class="fe lc ld le lf b">yarn start</code>或<code class="fe lc ld le lf b">npm start</code>运行应用程序，您将看到初始登录屏幕</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lu"><img src="../Images/f36796ac4706f6f94e0e035e2eaa5373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F6wWI--wluCiJH6pd18KRg.png"/></div></div></figure><p id="6406" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加两个新的状态值，用于处理成功和错误消息。</p><pre class="km kn ko kp gt lg lf lh li aw lj bi"><span id="b936" class="lk ll iq lf b gy lm ln l lo lp">const [errorMsg, setErrorMsg] = useState('');</span><span id="8a76" class="lk ll iq lf b gy lr ln l lo lp">const [successMsg, setSuccessMsg] = useState('');</span></pre><p id="4565" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们添加一些验证代码。</p><p id="a73f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将<code class="fe lc ld le lf b">onSubmit={handleOnSubmit}</code>添加到<code class="fe lc ld le lf b">Form</code>标签中，并添加以下两个用于管理验证的方法。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="bec7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，添加下面的代码，在<code class="fe lc ld le lf b">Form</code>标签上方显示错误和成功消息。</p><pre class="km kn ko kp gt lg lf lh li aw lj bi"><span id="3919" class="lk ll iq lf b gy lm ln l lo lp">{successMsg &amp;&amp; &lt;p className="successMsg"&gt;{successMsg}&lt;/p&gt;}</span><span id="263f" class="lk ll iq lf b gy lr ln l lo lp">{errorMsg &amp;&amp; &lt;p className="errorMsg"&gt;{errorMsg}&lt;/p&gt;}</span></pre><p id="d7e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您的App.js现在将如下所示:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="75f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您现在检查应用程序，您可以看到，如果您直接点击<code class="fe lc ld le lf b">Login</code>按钮而不输入任何值，会显示错误消息，并且第一个空输入会自动聚焦。</p><p id="e4b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们了解一下我们在验证方法中做了什么。</p><ol class=""><li id="5a66" class="lv lw iq jp b jq jr ju jv jy lx kc ly kg lz kk ma mb mc md bi translated">在<code class="fe lc ld le lf b">validateInput</code>方法中，我们用与表单的每个输入字段相关的<code class="fe lc ld le lf b">name</code>、<code class="fe lc ld le lf b">value</code>和<code class="fe lc ld le lf b">message</code>属性声明了<code class="fe lc ld le lf b">fields</code>数组。</li><li id="df8e" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">然后我们调用数组<code class="fe lc ld le lf b">some</code>方法。一旦函数中提供的条件得到满足，array <code class="fe lc ld le lf b">some</code>方法允许我们停止对数组的循环，如果任何数组元素的条件得到满足，它将返回true。</li><li id="ec9c" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">在这里，如果有任何输入值为空，我们将退出循环。</li><li id="551b" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated"><code class="fe lc ld le lf b">some</code>在我们的例子中，一旦找到第一个值为空的输入元素，方法就会停止。</li><li id="630b" class="lv lw iq jp b jq me ju mf jy mg kc mh kg mi kk ma mb mc md bi translated">如果条件匹配，我们设置与该输入字段相关的错误消息，并使用<code class="fe lc ld le lf b">emailRef.current.focus()</code>或<code class="fe lc ld le lf b">passwordRef.current.focus()</code>聚焦该输入字段</li></ol><p id="2377" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们添加一些代码，以便在页面加载时自动聚焦电子邮件输入字段。</p><pre class="km kn ko kp gt lg lf lh li aw lj bi"><span id="756b" class="lk ll iq lf b gy lm ln l lo lp">useEffect(() =&gt; {<br/> emailRef.current.focus();<br/>}, []);</span></pre><p id="3d9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们已经提供了空数组<code class="fe lc ld le lf b">[]</code>作为<code class="fe lc ld le lf b">useEffect</code>的第二个参数，所以当组件被挂载时<code class="fe lc ld le lf b">useEffect</code>中的代码将只被执行一次。</p><p id="d3d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你最终的App.js现在会是这个样子。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mj"><img src="../Images/f25990213413a38a676ae0f101f8e62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EfpoiJptBlxzwJ1llyN7CQ.gif"/></div></div></figure><p id="49d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整源代码:<br/>【https://github.com/myogeshchavan97/login-validation-focus T21】</p><p id="7828" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现场演示:<a class="ae lb" href="https://login-validation-focus.now.sh/" rel="noopener ugc nofollow" target="_blank">https://login-validation-focus.now.sh/</a></p><p id="22d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天就到这里。希望你今天学到了新东西。</p><p id="7b6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">别忘了订阅我的每周简讯，里面有惊人的技巧、诀窍和文章，直接在你的收件箱</strong> <a class="ae lb" href="https://yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">这里。</strong> </a></p></div></div>    
</body>
</html>