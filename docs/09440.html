<html>
<head>
<title>Joins with Pandas Dataframes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与熊猫数据框架连接</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/joins-with-pandas-dataframes-bd077a6ec20d?source=collection_archive---------17-----------------------#2021-08-10">https://levelup.gitconnected.com/joins-with-pandas-dataframes-bd077a6ec20d?source=collection_archive---------17-----------------------#2021-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9edf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">连接</strong>是数据科学家应该知道的关键概念之一。当数据科学家工作时，他主要是收集和组织数据。组织是按要求做的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/b3be09ea1dc5d503a0eec2ece764ae8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VObg28550k0B1EFdTGdyiw.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@romankraft?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">罗马卡夫</a>在<a class="ae lb" href="https://unsplash.com/s/photos/join?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="25fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">联接有助于组织数据和使用数据。在这篇博客中，我将告诉你如何对数据执行连接，你只需要了解熊猫就能理解。没有SQL，只有熊猫。</p><p id="25b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用函数<strong class="jp ir"> <em class="lc">。</em>合并()</strong>的熊猫库。它具有以下语法。</p><p id="8971" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">的语法。合并()</p><p id="f457" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ld le lf lg b">df1.merge(df2, on=“the column on which you want to join”)</code></p><p id="1f25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这需要更多的参数，我会在连接中讲到。</p><p id="eb3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">说到连接，有4种类型的连接。它们是:</p><ol class=""><li id="3462" class="lh li iq jp b jq jr ju jv jy lj kc lk kg ll kk lm ln lo lp bi translated">内部连接</li><li id="e05a" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">左连接</li><li id="9b64" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">右连接</li><li id="6424" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">外部连接</li></ol><h1 id="8e4b" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">内部连接</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/814af0397ee1237416f26a62e05bc95b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*by1qdf4X_9o7Y0FPHTQoaA.png"/></div></div></figure><p id="4dfa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">内部联接返回两个表中的行。这意味着如果它们不在两个表中，数据就会丢失。</p><p id="8979" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果多个列具有相同的名称，那么它们会被赋予后缀。我们可以通过给出<strong class="jp ir"> <em class="lc">来实现。merge() </em> </strong>函数参数后缀我们要给的名字作为后缀。</p><p id="cb95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">比如说我有下面的anime.csv文件，里面有下面的数据。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/c268a99047549db27270cd6f701cf857.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*xhMA3wQnMhmIN9sEaociSw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="b424" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经将这些数据读入一个名为anime的变量中。</p><p id="518f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ld le lf lg b">anime = pd.read_csv(“anime.csv”)</code></p><p id="823d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们希望将此数据与另一个名为anime_info.csv的文件连接起来，该文件包含有关动画的id、名称、状态和类型(季节性或长期播放)的数据</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/da16be9dc93fee88b40fc0167a6fb984.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*ct_gkLSmWaY8PHzpgf850g.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="d1a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将这些数据读入名为anime_info的变量中。</p><p id="e3e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ld le lf lg b">anime_info = pd.read_csv(“anime_info.csv”)</code></p><blockquote class="mw mx my"><p id="3906" class="jn jo lc jp b jq jr js jt ju jv jw jx mz jz ka kb na kd ke kf nb kh ki kj kk ij bi translated">声明:我使用的数据是我为了更好地解释而编造的。在现实中，它们是巨大的。</p></blockquote><p id="57a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们执行内部连接时，你认为哪些行将保留？我们将对name列执行连接。</p><blockquote class="nc"><p id="428b" class="nd ne iq bd nf ng nh ni nj nk nl kk dk translated">common _ anime = anime . merge(anime _ info，on="name ")</p></blockquote><p id="c1b1" class="pw-post-body-paragraph jn jo iq jp b jq nm js jt ju nn jw jx jy no ka kb kc np ke kf kg nq ki kj kk ij bi translated">两个表中的公共行是在内部连接中唯一被选中的行。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nr"><img src="../Images/63b137d7c0de082b9a5084401f8f5f70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YgzQBZBDzATrucGfzdLeYw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="f683" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个连接中，如果两个表中都没有数据，数据就会丢失。</p><h1 id="6f60" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">左连接:</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/d38a46a43d86c1784c2a3083e26aaf1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2qAhO_4jWjwxce4QbpwHoQ.png"/></div></div></figure><p id="fb67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它返回左表中的所有行，并且只返回右表中匹配的行。</p><p id="52e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了执行左连接，我们将使用“how”参数。</p><h2 id="782a" class="nt lw iq bd lx nu nv dn mb nw nx dp mf jy ny nz mj kc oa ob mn kg oc od mr oe bi translated">示例:</h2><p id="859b" class="pw-post-body-paragraph jn jo iq jp b jq of js jt ju og jw jx jy oh ka kb kc oi ke kf kg oj ki kj kk ij bi translated"><code class="fe ld le lf lg b">left = anime.merge(anime_info, on=“name”, how=“left”)</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/8415211f1d4cff6b6016ab716018af8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*1WBXTD3uiYWDyZBcyBGa0w.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="5bbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您所看到的，左侧表格(anime.csv)中的所有数据都包含在内，只有匹配的数据包含在右侧表格(anim_info.csv)中。缺失的数据表示为NaN(不是数字)</p><p id="9398" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样可以保留大部分数据，不像内部连接会丢失大部分数据。</p><h1 id="80fe" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">右连接:</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/8bf77325de76e486bc0a25539c9d399b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YoLCe3SQPPor5dlEEo1oYQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="8e77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是左连接的镜像副本。在这个连接中，所有右表数据都被保留，只有匹配的数据被保留在左表中。这也是通过使用<strong class="jp ir"> <em class="lc">的“如何”论证来实现的。合并(</em> </strong>)。</p><h2 id="7923" class="nt lw iq bd lx nu nv dn mb nw nx dp mf jy ny nz mj kc oa ob mn kg oc od mr oe bi translated">示例:</h2><p id="609d" class="pw-post-body-paragraph jn jo iq jp b jq of js jt ju og jw jx jy oh ka kb kc oi ke kf kg oj ki kj kk ij bi translated"><code class="fe ld le lf lg b">right = anime.merge(anime_info, on=“name”, how=“right”)</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/70f67c71895e1ef36bde7e696b630ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*JrUIq0stWhFw2qmTm5KVlQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="9bae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，右侧表中的所有数据都被保留，左侧表中匹配的数据也被保留。缺失值由NaN表示。</p><h1 id="2005" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">外部联接:</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/e514735b484733e47863efc62f03a2bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GTkquiLwoqh0uVMVg3Rb9Q.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="59e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个连接中，每个数据都被保留。没有例外。在这个连接中，没有观察到数据丢失。</p><p id="5c16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">示例:</p><p id="dfe6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ld le lf lg b">all_anime = anime.merge(anime_info, on=“name”, how=“outer”)</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi om"><img src="../Images/ff4f19a9b1807b74e4d403d63d0a7bbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*ryWeL1ZK7LPtYCaYWwRmjQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</figcaption></figure><p id="1321" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您在上面的图像中看到的，所有的数据都被合并，缺少的值用NaN填充。</p><p id="06db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认加入的是这个<strong class="jp ir"> <em class="lc">。merge() </em> </strong>方法做的是“<strong class="jp ir">内部连接</strong>”。</p><h1 id="a97c" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">将表格合并到自身</h1><p id="483a" class="pw-post-body-paragraph jn jo iq jp b jq of js jt ju og jw jx jy oh ka kb kc oi ke kf kg oj ki kj kk ij bi translated">如果你想知道我们什么时候将一个表合并到它自己，不要担心，我马上就会讲到。但是如果你想知道是否有新的语法，那么不要担心。它类似于你到目前为止看到的那些。</p><p id="1dec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">示例:</p><p id="cf4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ld le lf lg b">anime.merge(anime, on=“id”)</code></p><p id="ace3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上只是给大家展示一下它的工作原理。</p><h2 id="86ed" class="nt lw iq bd lx nu nv dn mb nw nx dp mf jy ny nz mj kc oa ob mn kg oc od mr oe bi translated">何时将表格合并到自身？</h2><ul class=""><li id="d261" class="lh li iq jp b jq of ju og jy on kc oo kg op kk oq ln lo lp bi translated">当你有等级关系时</li><li id="1b12" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk oq ln lo lp bi translated">当你有连续的关系时</li></ul></div><div class="ab cl or os hu ot" role="separator"><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow"/></div><div class="ij ik il im in"><h1 id="6db3" class="lv lw iq bd lx ly oy ma mb mc oz me mf mg pa mi mj mk pb mm mn mo pc mq mr ms bi translated">结论</h1><p id="0fe7" class="pw-post-body-paragraph jn jo iq jp b jq of js jt ju og jw jx jy oh ka kb kc oi ke kf kg oj ki kj kk ij bi translated">上面提到的联接只是基本的联接。还有其他连接数据的方法。</p><p id="4728" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关键要点是:</p><ul class=""><li id="0432" class="lh li iq jp b jq jr ju jv jy lj kc lk kg ll kk oq ln lo lp bi translated">什么是连接</li><li id="cec1" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk oq ln lo lp bi translated">如何使用它们</li><li id="ce3d" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk oq ln lo lp bi translated">不同类型的联接</li><li id="bca5" class="lh li iq jp b jq lq ju lr jy ls kc lt kg lu kk oq ln lo lp bi translated">何时使用它们</li></ul><p id="0ff3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望这篇博客对你有所帮助。如果你喜欢这个博客，那么我建议你在<a class="ae lb" href="https://karthikbhandary2.medium.com/" rel="noopener"> Medium </a>和<a class="ae lb" href="https://www.youtube.com/channel/UCKplT0-YqAQdCq6Xajcq5Tw" rel="noopener ugc nofollow" target="_blank"> YouTube </a>上关注我，了解更多关于生产力、自我提升、编码和技术的内容。</p><p id="61e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同时，你为什么不看看我最近的作品:</p><div class="pd pe gp gr pf pg"><a href="https://pub.towardsai.net/soar-your-bet-in-data-science-using-unix-cmds-607bc34d7f70" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd ir gy z fp pl fr fs pm fu fw ip bi translated">使用Unix Cmds在数据科学上大展身手</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">让你成为一个厉害的数据科学家</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">pub.towardsai.net</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu kv pg"/></div></div></a></div><div class="pd pe gp gr pf pg"><a href="https://medium.datadriveninvestor.com/testing-can-skyrocket-your-data-science-game-c193ac3e39e6" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd ir gy z fp pl fr fs pm fu fw ip bi translated">测试可以让你的数据科学游戏一飞冲天</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">使调试变得轻而易举</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">medium.datadriveninvestor.com</p></div></div><div class="pp l"><div class="pv l pr ps pt pp pu kv pg"/></div></div></a></div></div></div>    
</body>
</html>