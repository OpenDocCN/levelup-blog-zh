<html>
<head>
<title>An Accessible Modal Dialog with HTML, CSS, and JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有HTML、CSS和JavaScript的可访问模式对话框</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/an-accessible-modal-dialog-with-html-css-and-javascript-d885004d0b3a?source=collection_archive---------9-----------------------#2021-08-24">https://levelup.gitconnected.com/an-accessible-modal-dialog-with-html-css-and-javascript-d885004d0b3a?source=collection_archive---------9-----------------------#2021-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6c6a4cabe023ea880fdd8648de1676e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GYIerS1Q6vlvD84reSN1gw.jpeg"/></div></div></figure><p id="60bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我想与社区分享一个我用HTML、CSS和JavaScript实现的模态对话框，它满足了由W3C WCAG工作组设置的测试:</p><ol class=""><li id="5a27" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">检查role=dialog是否是用作自定义对话框的容器(如div)的属性。</li><li id="c36b" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">检查容器是否在用户交互或其他事件之后通过JavaScript被插入(或可见)。</li><li id="fdbc" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">当对话框被激活时，检查焦点是否被设置到容器中的一个元素。</li><li id="04d8" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">当对话框处于活动状态时，检查焦点是否从未设置到不在容器中的元素。</li><li id="59fd" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">当对话框被停用时，检查焦点是否设置到最初激活该对话框的控件上。</li></ol><p id="6942" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">除了这五点，我还希望模式对话框满足以下要求:</p><ul class=""><li id="87ca" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv ll ld le lf bi translated">当用户单击Escape时，模式对话框关闭。</li><li id="77f9" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv ll ld le lf bi translated">当用户在其可见部分之外单击时，模式对话框关闭。</li></ul></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="e899" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">HTML代码</h1><figure class="mr ms mt mu gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="74c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的HTML代码中，最相关的行是:</p><p id="c4d8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第12行</strong>:我们在body标签中将<a class="ae kw" href="https://www.w3.org/TR/wai-aria-1.1/#aria-haspopup" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> aria-haspopup </strong> </a>属性设置为“<a class="ae kw" href="https://www.w3.org/TR/wai-aria-1.1/#dialog" rel="noopener ugc nofollow" target="_blank">对话框</a>”。我也考虑过将它设置为“<a class="ae kw" href="https://www.w3.org/TR/wai-aria-1.1/#alertdialog" rel="noopener ugc nofollow" target="_blank"> alertdialog </a>”，但是我认为这个弹出窗口并不意味着警告用户，所以“alert”角色似乎不太适合这种情况。我们设置这个属性来告诉屏幕阅读器body元素有一个弹出窗口。</p><p id="5979" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第15–16行</strong>:这是模态的外部div，这里:<br/>——我们给<strong class="ka ir">角色</strong>属性“对话框”(本来可以是“alertdialog”)。<br/> -我们将<a class="ae kw" href="https://www.w3.org/TR/wai-aria-1.1/#aria-modal" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> aria-modal </strong> </a>设置为true，以便向屏幕读者表明这是一个模态元素。<br/> -我们根据对话角色的需要指定<a class="ae kw" href="https://www.w3.org/TR/wai-aria-1.1/#aria-label" rel="noopener ugc nofollow" target="_blank"> aria-label </a>。<br/> -我们将<a class="ae kw" href="https://www.w3.org/TR/wai-aria-1.1/#aria-label" rel="noopener ugc nofollow" target="_blank"> aria-live </a>设置为“assertive”，这样当对话框更新(出现)时，屏幕阅读器会立即宣布。</p><p id="c19b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第45–46行</strong>:导入必要的脚本:<br/>——模态的JavaScript代码(见下文)。<br/>—<a class="ae kw" href="https://github.com/WICG/inert" rel="noopener ugc nofollow" target="_blank">—<strong class="ka ir">惰性polyfill </strong> </a>，将模态后面的所有内容设置为<a class="ae kw" href="https://html.spec.whatwg.org/multipage/interaction.html#inert" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">惰性</strong> </a>，这样不仅屏幕阅读器无法访问，键盘导航也无法访问。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="6225" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">JavaScript代码</h1><figure class="mr ms mt mu gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="1e6f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我试图以一种不言自明的方式编写代码，但是有些部分可能需要一点解释:</p><p id="5372" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第3行</strong>:我们保存当模式打开时有焦点的元素。一旦用户关闭模态(第25行)，这对于将焦点放回原来的位置是必要的。</p><p id="7de5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第9行</strong>:我们想在用户点击模态框周围的“灰色”不透明部分(覆盖层)时关闭模态。</p><p id="cfd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第45行</strong>:对于这个特殊的例子，我们可以只寻找按钮。为了提高代码的可重用性，我们还会寻找其他可以获得焦点的元素，这些元素可能位于模式对话框中。我们把焦点放在找到的第一个元素上。</p><p id="33f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第50行</strong>:这是我们需要惰性聚合填充物的部分。</p><h1 id="8676" class="lt lu iq bd lv lw mx ly lz ma my mc md me mz mg mh mi na mk ml mm nb mo mp mq bi translated">CSS样式表</h1><figure class="mr ms mt mu gt jr"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="1901" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我认为CSS不需要太多的解释，但是我觉得应该选择<a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/CSS/display" rel="noopener ugc nofollow" target="_blank"> CSS显示属性</a>，而不是<a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/CSS/visibility" rel="noopener ugc nofollow" target="_blank"> CSS可见属性</a>，或者<a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/hidden" rel="noopener ugc nofollow" target="_blank">隐藏属性</a>。</p><p id="d68c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在覆盖图中使用<em class="nc">可见性</em>，将需要(为了安全起见)设置<em class="nc">可见性</em>来“继承”子元素，因为如果元素的后代将<em class="nc">可见性</em>设置为<em class="nc">可见性</em>，那么它们将可见。另外，如果位置未设置为<em class="nc">固定</em>或<em class="nc">绝对</em>，即使不可见，元素仍会占用空间。所以使用<em class="nc">显示</em>属性感觉更安全，并且节省了一行代码。</p><p id="b868" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<em class="nc">隐藏</em>属性的风险在于，在具有<em class="nc">隐藏</em>属性的元素上更改CSS <em class="nc">显示</em>属性的值会覆盖<em class="nc">隐藏</em>属性的行为。所以我觉得使用CSS <em class="nc"> display </em>属性会更安全。</p><p id="4195" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在使用<em class="nc">显示:【无】</em>作为默认显示时，iOS Safari + VoiceOver中的<a class="ae kw" href="https://www.tpgi.com/the-current-state-of-modal-dialog-accessibility/" rel="noopener ugc nofollow" target="_blank">似乎有一个bug </a>，但提到它的帖子已经超过两年了，我无法找到更多关于它的信息，在测试它时，我没有遇到提到的bug。</p><p id="5b02" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在GitHub  上看到<a class="ae kw" href="https://github.com/MarianiGiacomo/accessible-modal" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">完整项目或者在这里</strong> </a>看到<a class="ae kw" href="https://marianigiacomo.github.io/accessible-modal/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">。如果您发现了错误或改进方法，请发表评论，或者提交一个<a class="ae kw" href="https://github.com/MarianiGiacomo/accessible-modal/issues" rel="noopener ugc nofollow" target="_blank">问题</a>。</strong></a></p><p id="82f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你觉得这篇文章有用，想感谢我，你可以<a class="ae kw" href="http://buymeacoff.ee/jamomani" rel="noopener ugc nofollow" target="_blank">请我喝杯咖啡</a>。</p></div></div>    
</body>
</html>