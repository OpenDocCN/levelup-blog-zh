<html>
<head>
<title>Lessons learned building multiple apps with Expo and React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Expo和React Native构建多个应用程序的经验教训</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/lessons-learned-building-multiple-apps-with-expo-and-react-native-28bd43b72b84?source=collection_archive---------4-----------------------#2020-05-15">https://levelup.gitconnected.com/lessons-learned-building-multiple-apps-with-expo-and-react-native-28bd43b72b84?source=collection_archive---------4-----------------------#2020-05-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ee6c1130cd83d2a50f5e9b582eb4476d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OxL24JTbhcKaLSCkHpaKg.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">使用我们的应用程序创建技术构建的应用程序之一— <a class="ae jg" href="https://nutridi.app.audio/" rel="noopener ugc nofollow" target="_blank"> Nutridi </a></figcaption></figure><div class=""/><p id="69df" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由<a class="ae jg" href="http://www.peadarcoyle.com" rel="noopener ugc nofollow" target="_blank">皮达尔·科伊尔</a>和<a class="ae jg" href="https://www.linkedin.com/in/salihkasimbenli/" rel="noopener ugc nofollow" target="_blank">萨利赫·卡斯姆·李奔</a></p><p id="3ff7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用了<a class="ae jg" href="http://www.expo.io" rel="noopener ugc nofollow" target="_blank"> Expo </a> <strong class="ki jk"> managed flow </strong>一年。以下是我们在过去18个月里从一个小型开发团队中学到的一些东西。</p><p id="5e28" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">afriothmic Labs(<a class="ae jg" href="http://www.aflorithmic.ai" rel="noopener ugc nofollow" target="_blank">www . afriothmic . ai</a>)是一家专注于高科技的初创公司，为品牌打造个性化音频体验的平台。我们的客户和用户经常寻找应用程序作为交付机制，因此我们构建了一些<strong class="ki jk">工具来简化应用程序的创建</strong>，在后端连接到我们的API。</p><p id="b141" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们大约18个月前开始我们的旅程时，我们的创始人Peadar评估了React-Native、native code和flutter。</p><p id="cdf3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在构建应用程序时的核心理念是，我们希望将我们能做的抽象到我们的后端API中，我们希望尽可能地简化应用程序生成过程。</p><h1 id="5bba" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">我们的移动应用技术堆栈</h1><ul class=""><li id="1713" class="mc md jj ki b kj me kn mf kr mg kv mh kz mi ld mj mk ml mm bi translated"><a class="ae jg" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">打字稿</a></li><li id="30f1" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated"><a class="ae jg" href="https://reactnative.dev/" rel="noopener ugc nofollow" target="_blank">用<a class="ae jg" href="http://www.expo.io/" rel="noopener ugc nofollow" target="_blank">博览会</a> *反应本土</a></li><li id="c702" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated"><a class="ae jg" href="https://reactnavigation.org/" rel="noopener ugc nofollow" target="_blank">反应-导航</a></li><li id="3540" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated"><a class="ae jg" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a></li><li id="7b0d" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated"><a class="ae jg" href="https://docs.amplify.aws/" rel="noopener ugc nofollow" target="_blank">放大</a></li></ul><p id="69bc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">* <em class="ms">我们受益于令人惊叹的Expo团队在生态系统方面所做的所有工作，但自从我们一年多前开始(特别是在Expo推出</em> <a class="ae jg" href="https://dev.to/evanbacon/getting-started-with-expo-web-168g" rel="noopener ugc nofollow" target="_blank"> <em class="ms"> web支持</em> </a> <em class="ms">)以来，因为我们有许多原生组件，特别是专注于音频的组件，我们基本上是在进行</em> <a class="ae jg" href="https://docs.expo.io/versions/latest/introduction/managed-vs-bare/#workflow-comparison" rel="noopener ugc nofollow" target="_blank"> <em class="ms">裸工作流</em> </a> <em class="ms">。</em></p><p id="e571" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">历史</strong></p><p id="d4c9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们选择React-Native是因为它是当时最成熟的社区，我们希望在iOS和Android上共享一个代码库。特别是，我们选择了react-native之上的SDK Expo。我们最终退出了Expo，进入了裸露的工作流程。然而，在我们开发的头一年里，诸如<a class="ae jg" href="http://www.withhislight.app" rel="noopener ugc nofollow" target="_blank"> www.withhislight.app </a>(一款使用我们的个性化音频API构建的应用)</p><p id="25fe" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">哲学</strong></p><p id="dc98" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有的应用程序背后都应该有一个理念。</p><p id="a9b3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对我们来说，在用户体验和我们选择的工具方面，我们有一些指导原则。</p><ul class=""><li id="dc75" class="mc md jj ki b kj kk kn ko kr mt kv mu kz mv ld mj mk ml mm bi translated">应该可以在两个平台上运行(Android和iOS)</li><li id="7abc" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">我们应该尽量保持代码重叠——尽管我们的代码库中确实有一些特定于平台的代码。</li><li id="de09" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">如果我们可以购买第三方服务，我们应该购买——因此我们选择了AWS Amplify来进行身份验证和早期分析，以及其他工具，如AWS Lambdas。</li><li id="643b" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">我们试图让前端尽可能的不可知，所以在可能的情况下，我们把东西放到我们的API中。这为我们的代码决策提供了很多信息。</li><li id="4de5" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">我们想要一个世界级的UX。我们的软件工程师花了很多时间来简化我们在UX的体验。我们仍然没有达到我们想要的目标，但我们对自己的经历感到非常自豪。</li><li id="c59d" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">Velocity，因为我们仍在试图找出产品与市场的契合度，所以我们希望尽可能平稳地部署新功能。</li></ul><div class="mw mx my mz gt ab cb"><figure class="na iv nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/40a55ab70d8ad4ef704acb153fdb79d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*FQBihfWvjcEEB0FC9nbCxA.png"/></div></figure><figure class="na iv nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/d2d29d97fa7601339d84bc8923582448.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*nTgS0Vkceqk-olv8lh0qoA.png"/></div></figure><figure class="na iv nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/458a3b4a1167ae8547c457ce3a58d3a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*CMIAYYCOOE4nZbr5CfAL6A.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk ng di nh ni translated">我们在IPad上的一个应用的一些截图。Expo使得跨平台变得很容易。</figcaption></figure></div><p id="192b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">React-native还允许您使用React.js分享一些知识，因此尽管web和移动应用程序之间存在差异，但对于对react.js有初步了解的人来说，通常很容易学会native。学习Java和Objective C要困难得多。</p><p id="3e75" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实上，我们的一个创始人仍然不太懂javascript，他能够从头开始编写MVP。他有python背景，所以如果他能开发出任何开发者都能开发的应用程序！</p><p id="d3ec" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们深入研究Expo和React原生组件之间的一些权衡。这些是音频播放器，但即使你的应用程序是一个不同的应用程序，你可能会有所收获。</p><p id="ddbb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">世博音频播放器</strong></p><p id="1f04" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Expo AV是Expo的音频和视频播放器，它的设计就是为了工作。你可以在不到两周的时间内开发出一个音频或视频应用。因为它是由Expo团队打造的，所以它被打造得易于使用且有主见。固执意味着做某些事情只有一种方法(所以API有些限制性)，所以这加速了产品开发。然而，固执己见也意味着最终，我们与它达成了一些问题。Expo团队开发速度很快，所以有时我们可以等待SDK升级——例如，它一度不允许在后台播放音频，这在SDK升级中得到了解决。</p><p id="760d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有哪些缺点——感觉不太自然。它没有锁屏和通知控件，没有稳定的后台模式，在iOS上换曲目时会停止。尽管如此，对于一个MVP来说，这已经很不错了。</p><p id="2a2b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们注意到，当我们转向“反应-本地-轨道-播放器”时，它并不能在应用范围内工作。这意味着当组件卸载时它会停止，它也有一些全局状态的问题，增加了音乐相关屏幕的代码库，因为我们必须在那里培养声音相关的逻辑。因为所有的逻辑都是围绕“playbackObject”构建的，所以不可能到达该组件之外的音频相关数据。在使用了“<a class="ae jg" href="https://github.com/react-native-kit/react-native-track-player" rel="noopener ugc nofollow" target="_blank">react-native-track-player”</a>之后，我们实现了一个“useTrackPlayer”自定义钩子，可以在应用程序中的任何地方使用，以获得百分比、剩余时长、状态等等。</p><p id="b63e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Expo AV的设计只是像前面提到的那样“工作”，所以如果一个人想拥有一个以声音为中心的app，像播客或广播app，在某个点之后就不符合要求了。不过，它是多功能的，Expo AV也支持播放视频。因此，对于一个MVP来说，推荐使用它。然而，要获得像Spotify一样的改进UX，原生模块更好。这方面的经验是，要走得快，你需要放弃一些控制。这就是框架的力量。</p><p id="c258" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">推送通知</strong></p><p id="da9a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">推送通知是Expo在创建MVP时帮助很大的另一个主题。它易于使用和测试，处理证书和凭证是留给博览会服务器和一个简单的后端，它可能只是工作。</p><p id="7729" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管这在开发的最初阶段非常有用，但是随着产品的发展，将会需要使用更复杂和更强大的服务。OneSignal 、react-native-push-notification和wix/react-native-notifications是这些服务/包的例子。此外，如果世博会的通知服务器使用，任何其他工具都不能使用。例如，你不能把Expo处理推送通知的方式和MixPanel结合起来。世博会团队在文档和支持社区方面做得很好，有很多例子可以设计一个后端与世博会的服务器对话来发送通知，更多细节请参见<a class="ae jg" href="https://docs.expo.io/guides/push-notifications/#2-call-expos-push-api-with-the" rel="noopener ugc nofollow" target="_blank">https://docs . Expo . io/guides/push-notifications/# 2-call-expos-push-API-with-the</a>。</p><p id="df38" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">使用原生模块</strong></p><p id="fa6c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在开发react原生应用时，可能需要使用原生模块。本机模块可以简单解释为使用本机代码完成某种任务并与react native通信的包。它们通常是用Java、Obj-C或Swift编写的。如果使用Expo，没有原生包可以使用(除了Expo团队已经提供的那些)，所以，这就是为什么“react-native-track-player”，“react-native-iap”或“react-native-wheel-picker-Android”和许多其他伟大的包不能与Expo一起使用。然而，世博会团队总是试图为共同的问题提出解决方案，例如<a class="ae jg" href="https://docs.expo.io/versions/latest/sdk/in-app-purchases/" rel="noopener ugc nofollow" target="_blank">https://docs.expo.io/versions/latest/sdk/in-app-purchases/</a></p><p id="e980" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">世博CLI—</strong><a class="ae jg" href="https://github.com/expo/expo-cli" rel="noopener ugc nofollow" target="_blank"><strong class="ki jk">https://github.com/expo/expo-cli</strong></a></p><p id="c98a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到今天为止，我已经使用expo-cli两年了。变化很大，变得更好了。“世博安装”或“世博升级”就是这种实质性改进的例子。此外，这个非常棒的cli对于自动化发布和测试非常有用。使用expo-cli可以方便快捷地构建CI/CD系统。</p><p id="6716" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">裸工作流程</strong></p><p id="8f9d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Expo给了开发者一个弹出的选项。弹出意味着从“受管工作流”进入“裸工作流”。更多细节可以在他们的网站上找到。作为算法实验室，经过一年的开发，我们最终选择了这个选项，特别是，有一些我们想使用的本机模块。弹出不是免费的。所以有必要指出这一点。弹出后遇到了一些问题:</p><ul class=""><li id="bebb" class="mc md jj ki b kj kk kn ko kr mt kv mu kz mv ld mj mk ml mm bi translated">CI/CD设置需要更新—特别是我们损失了一周时间来处理构建错误</li><li id="ce6c" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">管理证书/凭证变得更加困难</li><li id="436f" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">本机模块设置可能比仅仅运行“expo install”更难</li><li id="dfcb" class="mc md jj ki b kj mn kn mo kr mp kv mq kz mr ld mj mk ml mm bi translated">配置难度大了很多。应该编辑大量的原生目录和文件，而不是仅仅更改app.json。</li></ul><p id="6a92" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">最终想法</strong></p><p id="dddf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Expo是一个真正伟大的包，由一个伟大的团队和最好的社区之一开发。所有的react-native项目都可以在不接触设备的情况下进行测试，只要写在<a class="ae jg" href="https://snack.expo.io/" rel="noopener ugc nofollow" target="_blank">小吃</a>上，这也是由<a class="ae jg" href="http://www.expo.io" rel="noopener ugc nofollow" target="_blank">博览会</a>团队开发的。然而，正如生活中的任何地方一样，它也有一些缺点，这是我们上面提到的。</p><p id="7700" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一个人是一个新的创业公司，试图说服客户或决定创造一个关于一些新主题的新产品，那么他应该默认使用Expo(如果没有已知的<a class="ae jg" href="https://docs.expo.io/introduction/why-not-expo/" rel="noopener ugc nofollow" target="_blank">限制</a>)。我们(Aflorithmic Labs)使用Expo一年时间来制作音频应用程序，并在App Store和Play Store上提供。</p><p id="6bd5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，人们不应该认为世博会只是一个开始。可能真的没有理由不使用它。</p><p id="ad5a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们构建的任何附带项目中，我们都会立即转向Expo和现有的工具包，如Firebase和Amplify。这大大减少了构建和部署应用程序的时间，虽然我们起初对此表示怀疑。我们惊讶于自己在世博会上取得的成就。感谢世博团队所做的一切。</p><p id="863f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想尝试用我们的平台构建的一些应用程序，你可以在<a class="ae jg" href="https://apps.apple.com/us/app/with-his-light/id1460383692?ls=1" rel="noopener ugc nofollow" target="_blank"> iPhone </a>和<a class="ae jg" href="https://play.google.com/store/apps/details?id=com.aflorithmic.withhislight4" rel="noopener ugc nofollow" target="_blank"> Google Play </a>上用hi light查看</p></div></div>    
</body>
</html>