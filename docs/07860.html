<html>
<head>
<title>How to Add Code Samples to ReDoc in FastAPI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在FastAPI中向ReDoc添加代码示例</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-add-code-samples-to-redoc-in-fastapi-1e7af847c4ef?source=collection_archive---------4-----------------------#2021-03-16">https://levelup.gitconnected.com/how-to-add-code-samples-to-redoc-in-fastapi-1e7af847c4ef?source=collection_archive---------4-----------------------#2021-03-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="221f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">扩展OpenAPI模式以获得更好的文档</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/643e43fc3796a7fc729adeaaf6b647fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sqd1i2ZJnWmFabfwKNdkLQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><p id="81bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过阅读本文，您将了解如何更改生成的OpenAPI模式，并在FastAPI应用程序中向<code class="fe le lf lg lh b">ReDoc</code>端点添加代码示例。本教程还包括从文本文件中动态添加代码示例，而不是在FastAPI脚本中定义代码。</p><p id="e3d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从2.0版本开始，ReDoc通过<a class="ae li" href="https://github.com/Redocly/redoc/blob/master/docs/redoc-vendor-extensions.md" rel="noopener ugc nofollow" target="_blank">供应商扩展</a>为代码样本提供了强大的支持。您所需要做的就是为您拥有的每条路由声明一个名为<code class="fe le lf lg lh b">x-codeSamples</code>的新条目。<code class="fe le lf lg lh b">x-codeSamples</code>应该包含一个代码示例对象列表，可以表示如下:</p><ul class=""><li id="6b88" class="lj lk it js b jt ju jx jy kb ll kf lm kj ln kn lo lp lq lr bi translated">语言</li><li id="3ac2" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">标签</li><li id="f78e" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">来源</li></ul><h2 id="953f" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">语言</h2><p id="c8e2" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">表示代码示例语言的字符串。它会影响代码示例的渲染和颜色。该值必须是下列之一的<a class="ae li" href="https://github.com/github/linguist/blob/master/lib/linguist/popular.yml" rel="noopener ugc nofollow" target="_blank">:</a></p><ul class=""><li id="b365" class="lj lk it js b jt ju jx jy kb ll kf lm kj ln kn lo lp lq lr bi translated">C</li><li id="a2a6" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">C#</li><li id="46ad" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">C++</li><li id="1334" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">咖啡脚本</li><li id="3e4b" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">半铸钢ˌ钢性铸铁(Cast Semi-Steel)</li><li id="85c5" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">镖</li><li id="7ebe" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">分米</li><li id="708d" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">长生不老药</li><li id="7879" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">去</li><li id="fb32" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">绝妙的</li><li id="0f2f" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">超文本标记语言</li><li id="e74d" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">Java 语言(一种计算机语言，尤用于创建网站)</li><li id="fa16" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">Java Script语言</li><li id="f90c" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">科特林</li><li id="dd9a" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">目标-C</li><li id="9c29" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">Perl语言</li><li id="8690" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">服务器端编程语言（Professional Hypertext Preprocessor的缩写）</li><li id="1bb5" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">PowerShell</li><li id="10d6" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">计算机编程语言</li><li id="0ef9" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">红宝石</li><li id="9f78" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">锈</li><li id="4107" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">斯卡拉</li><li id="54bb" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">壳</li><li id="e3df" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">迅速发生的</li><li id="37a0" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">以打字打的文件</li></ul><h2 id="22df" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">标签</h2><p id="b7ed" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">代码示例的可选字符串<code class="fe le lf lg lh b">label</code>。该标签将显示在文档上。如果标签不存在，它将使用<code class="fe le lf lg lh b">lang</code>作为默认值。</p><h2 id="e3c2" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">来源</h2><p id="ab51" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">您的代码示例的源代码。它被表示为单个字符串。请注意，不会对语法进行任何检查。您有责任确保代码运行无误。</p><p id="a0ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们继续下一部分，开始安装必要的模块。</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="134c" class="nc ly it bd lz nd ne nf mc ng nh ni mf nj nk nl mi nm nn no ml np nq nr mo ns bi translated">设置</h1><p id="b3ad" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">强烈建议您在继续安装之前创建一个新的虚拟环境。</p><h2 id="37de" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">FastAPI</h2><p id="fe3b" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">激活它并运行以下命令来安装FastAPI:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="2b80" class="lx ly it lh b gy nx ny l nz oa">pip install fastapi</span></pre><h2 id="34e9" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">紫玉米</h2><p id="c9ae" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">为了服务FastAPI服务器，需要一个ASGI服务器。您可以选择通过以下方式安装最低限度依赖项:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="c060" class="lx ly it lh b gy nx ny l nz oa">pip install uvicorn</span></pre><p id="1092" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者标准安装，其中包含附加的有用包，如WebSockets支持。</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="e98d" class="lx ly it lh b gy nx ny l nz oa">pip install uvicorn[standard]</span></pre><h2 id="659a" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">需求文件</h2><p id="605c" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">或者，您可以通过以下需求文件安装所有必需的软件包:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="2c0b" class="lx ly it lh b gy nx ny l nz oa">click             7.1.2<br/>dataclasses       0.8<br/>fastapi           0.63.0<br/>h11               0.12.0<br/>httptools         0.1.1<br/>pip               21.0.1<br/>pkg-resources     0.0.0<br/>pydantic          1.8.1<br/>python-dotenv     0.15.0<br/>PyYAML            5.4.1<br/>setuptools        54.1.1<br/>starlette         0.13.6<br/>typing-extensions 3.7.4.3<br/>uvicorn           0.13.4<br/>uvloop            0.14.0<br/>watchgod          0.7<br/>websockets        8.1</span></pre><p id="a3fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将其保存在与<code class="fe le lf lg lh b">requirements.txt</code>相同的工作目录中并运行:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="dc9d" class="lx ly it lh b gy nx ny l nz oa">pip install -r requirements.txt</span></pre></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="ff89" class="nc ly it bd lz nd ne nf mc ng nh ni mf nj nk nl mi nm nn no ml np nq nr mo ns bi translated">用徽标自定义文档</h1><p id="d9fc" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">在本节中，您将实现FastAPI服务器脚本并扩展底层OpenAPI规范。让我们从测试带有徽标的定制文档开始。创建一个名为<code class="fe le lf lg lh b">myapp.py</code>的新Python文件。</p><h2 id="2887" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">导入</h2><p id="025e" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">在文件顶部添加以下导入语句。</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="12f7" class="lx ly it lh b gy nx ny l nz oa">from fastapi import FastAPI<br/>from fastapi.openapi.utils import get_openapi</span></pre><h2 id="afa2" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">路线</h2><p id="b152" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">初始化FastAPI实例，并向其中添加两条新路由。</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="cd68" class="lx ly it lh b gy nx ny l nz oa">app = FastAPI()</span><span id="6f47" class="lx ly it lh b gy ob ny l nz oa">@app.get("/hello")<br/>async def hello():<br/>    return [{"message": "hello"}]</span><span id="b8b0" class="lx ly it lh b gy ob ny l nz oa">@app.get("/world")<br/>async def world():<br/>    return [{"message": "world"}]</span></pre><h2 id="5db7" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">自定义OpenAPI</h2><p id="59ea" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">接下来，声明一个覆盖默认OpenAPI模式的新函数。它将缓存生成的模式，并在下一个请求中重用它。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="09c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另一方面，您需要确保</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="74fe" class="lx ly it lh b gy nx ny l nz oa">app.openapi = custom_openapi</span></pre><p id="92ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在指定了所有路由后调用，以防止在修改架构时因缺少键而出错。</p><h2 id="b2ba" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">运行服务器</h2><p id="b0d8" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">保存Python文件，并在终端中运行以下命令:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="91e4" class="lx ly it lh b gy nx ny l nz oa">uvicorn myapp:app</span></pre><p id="231e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开浏览器，转到以下URL:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="f940" class="lx ly it lh b gy nx ny l nz oa">http://localhost:8000/redoc</span></pre><p id="082c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该会看到以下用户界面:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/90e2d09018d283da2515eec2d786c1af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3QqZw_m-ygKotZplWOBsSQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="2b47" class="nc ly it bd lz nd ne nf mc ng nh ni mf nj nk nl mi nm nn no ml np nq nr mo ns bi translated">使用代码示例自定义文档</h1><p id="2d95" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">您应该注意到，添加徽标就像更改模式内容一样简单:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="54bd" class="lx ly it lh b gy nx ny l nz oa">openapi_schema["info"]["x-logo"] = {                                 "url": "https://fastapi.tiangolo.com/img/logo-margin/logo-teal.png"                           }</span></pre><h2 id="91a7" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">添加单一代码示例</h2><p id="1177" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">为了将代码示例添加到<code class="fe le lf lg lh b">hello</code>端点，您应该修改模式，如下所示:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="369f" class="lx ly it lh b gy nx ny l nz oa">openapi_schema["paths"]["/hello"]["get"]["x-codeSamples"] = [{<br/>    'lang': 'JavaScript',<br/>    'source': 'console.log("hello");',<br/>    'label': 'Plain JS'<br/>}]</span></pre><p id="21b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在路由前面加上<code class="fe le lf lg lh b">/</code>符号并指定正确的HTTP方法(get、post等)非常重要。).如果您在运行服务器时遇到了<code class="fe le lf lg lh b">KeyError</code>，请仔细检查脚本中使用的路线和方法。</p><h2 id="b949" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">添加多个代码示例</h2><p id="b81c" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">假设您想要支持几种不同编程语言的代码示例。只需将更多项目添加到列表中，如下所示:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="c4bf" class="lx ly it lh b gy nx ny l nz oa">openapi_schema["paths"]["/hello"]["get"]["x-codeSamples"] = [<br/>    {<br/>        'lang': 'JavaScript',<br/>        'source': 'console.log("hello");',<br/>        'label': 'Plain JS'<br/>    },<br/>    {<br/>        'lang': 'JavaScript',<br/>        'source': 'console.log("hello node");',<br/>        'label': 'NodeJS'<br/>    },<br/>]</span></pre><p id="3875" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">重新运行FastAPI服务器，您应该会看到下面的代码示例</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1af5a5442c4440d84ffbdf3ebe632922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*fsuIpyxKpRTK0ITjSZQLrA.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><h2 id="e603" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">从文本文件中动态加载代码示例</h2><p id="2171" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">在Python文件中直接添加代码样本的过程非常繁琐，尤其是当您打算为多条路线支持不同的编程语言时。</p><h2 id="3430" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">创建文件夹</h2><p id="d3c6" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">让我们更进一步，实现一个新函数，它加载all文件并动态地将其添加到模式中。创建一个名为docs的新文件夹。在文件夹内，添加两个文件夹，如下所示:</p><ul class=""><li id="96bb" class="lj lk it js b jt ju jx jy kb ll kf lm kj ln kn lo lp lq lr bi translated">普通JS</li><li id="edcf" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">NodeJS</li></ul><h2 id="2fa1" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">创建文本文件</h2><p id="9b99" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">请注意，文件夹的名称将用作显示在文档中的标签。在每个文件夹中，创建两个新的文本文件:</p><ul class=""><li id="05d4" class="lj lk it js b jt ju jx jy kb ll kf lm kj ln kn lo lp lq lr bi translated">hello-get.js</li><li id="94cd" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn lo lp lq lr bi translated">world-get.js</li></ul><p id="ce42" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">命名约定受<a class="ae li" href="https://github.com/tiangolo/fastapi/issues/2111" rel="noopener ugc nofollow" target="_blank">后面的代码片段</a>的启发，该代码片段使用由连字符分隔的路由和HTTP方法的名称。如果您有如下GET路线:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="bd03" class="lx ly it lh b gy nx ny l nz oa">v1/hello</span></pre><p id="4ff4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该按如下方式命名该文件:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="d00a" class="lx ly it lh b gy nx ny l nz oa">v1-hello-get.js</span></pre><p id="26ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">文件扩展名并不重要，您可以使用您喜欢的任何文件(例如txt)。建议使用正确的文件扩展名，因为您可以立即测试它来验证代码是否正常工作。</p><p id="fad6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完成后，让我们在Python文件中实现剩余的代码。</p><h2 id="134f" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">导入</h2><p id="c4d0" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">添加以下导入和映射字典</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="99da" class="lx ly it lh b gy nx ny l nz oa">...<br/>import os</span><span id="e64f" class="lx ly it lh b gy ob ny l nz oa">lable_lang_mapping = {"Plain JS": "JavaScript", "NodeJS": "JavaScript"}<br/>...</span></pre><h2 id="70b2" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">实现自定义功能</h2><p id="7b47" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">创建一个名为<code class="fe le lf lg lh b">add_examples</code>的新函数，它搜索<code class="fe le lf lg lh b">docs</code>文件夹，并将文本文件的内容作为代码样本加载到OpenAPI模式中。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="7f28" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，修改下面一行:</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="0fb5" class="lx ly it lh b gy nx ny l nz oa">app.openapi_schema = openapi_schema</span></pre><p id="b4f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到</p><pre class="kp kq kr ks gt nt lh nu nv aw nw bi"><span id="9baf" class="lx ly it lh b gy nx ny l nz oa">app.openapi_schema = add_examples(openapi_schema, 'docs')</span></pre><h2 id="4bbe" class="lx ly it bd lz ma mb dn mc md me dp mf kb mg mh mi kf mj mk ml kj mm mn mo mp bi translated">证明文件</h2><p id="780e" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">保存文件并重新运行服务器。您应该会看到以下用户界面</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f4d6e6ee82d881265378062b6809aefd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*ybMucgf63Osk5c6kSWxjCw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><p id="685f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在要点后面的<a class="ae li" href="https://gist.github.com/wfng92/8d459df8d60fe72c3e2b21a3458defa1" rel="noopener ugc nofollow" target="_blank">找到完整的代码。</a></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="0032" class="nc ly it bd lz nd ne nf mc ng nh ni mf nj nk nl mi nm nn no ml np nq nr mo ns bi translated">结论</h1><p id="75e6" class="pw-post-body-paragraph jq jr it js b jt mq jv jw jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn im bi translated">让我们回顾一下你今天所学的内容。</p><p id="a024" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本教程首先简要解释了通过供应商扩展对ReDoc的代码示例支持。</p><p id="7c9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，它涵盖了通过直接pip安装或需求文件的安装过程。</p><p id="824d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，它专注于定制OpenAPI模式，以便在文档中包含定制的徽标。随后，它解释了如何在Python文件中直接向文档添加定制代码示例。</p><p id="913a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后但并非最不重要的一点是，本文最后介绍了如何从文本文件中动态添加代码示例。</p><p id="9efb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢你阅读这篇文章。希望你回来看下一篇文章！</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="3fe9" class="nc ly it bd lz nd ne nf mc ng nh ni mf nj nk nl mi nm nn no ml np nq nr mo ns bi translated">参考</h1><ol class=""><li id="2c2f" class="lj lk it js b jt mq jx mr kb og kf oh kj oi kn oj lp lq lr bi translated"><a class="ae li" href="https://fastapi.tiangolo.com/advanced/extending-openapi/" rel="noopener ugc nofollow" target="_blank"> FastAPI —扩展OpenAPI </a></li><li id="5933" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn oj lp lq lr bi translated"><a class="ae li" href="https://github.com/tiangolo/fastapi/issues/2111" rel="noopener ugc nofollow" target="_blank"> FastAPI Github问题—支持x-codeSamples </a></li><li id="6c22" class="lj lk it js b jt ls jx lt kb lu kf lv kj lw kn oj lp lq lr bi translated"><a class="ae li" href="https://github.com/Redocly/redoc/blob/master/docs/redoc-vendor-extensions.md" rel="noopener ugc nofollow" target="_blank"> ReDoc —供应商扩展</a></li></ol></div></div>    
</body>
</html>