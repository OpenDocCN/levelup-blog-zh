# ä½¿ç”¨ Babel åœ¨è¿è¡Œæ—¶â€œè¦æ±‚â€ES æ¨¡å—å¯¼å‡ºæ–‡ä»¶

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/require-an-es-module-exported-file-at-runtime-using-babel-c872d376a59c>

å¦‚ä½•å¿«é€Ÿæ¶ˆé™¤"*æ„å¤–ä»¤ç‰Œå¯¼å‡º* " woeğŸ˜

![](img/d62ede63a17d21f63e6ed0a7f7c847e5.png)

æœ‰æ—¶å€™ï¼Œå½“ä½ ç¼–å†™ä¸€ä¸ªç”¨ Node æ‰§è¡Œçš„ CommonJS ç¨‹åºæ—¶ï¼Œä½ éœ€è¦å¯¹ä¸€ä¸ªç”¨ es æ¨¡å—`export { â€¦ }`æˆ–`export default ...`å¯¼å‡ºçš„æ–‡ä»¶ä½¿ç”¨ CommonJS çš„`require`ã€‚å½“ä½ çš„ç¨‹åºå¼€å§‹å–Š`Unexpected token export`æ»¥ç”¨ä¸ºæ§åˆ¶å°é”™è¯¯æ—¶ï¼Œä½ å°±ä¼šçŸ¥é“è¿™ç§æŒ«è´¥æ„Ÿã€‚

å¯¹æˆ‘æ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯åœ¨æˆ‘ä¸º React web åº”ç”¨ç¨‹åºç¼–å†™æ–‡æ¡£å·¥å…·æ—¶å‡ºç°çš„ã€‚è¯¥ç¨‹åºä¸ web åº”ç”¨ç¨‹åºçš„è¿è¡Œæ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œè€Œæ˜¯æ—¨åœ¨å¸®åŠ©å†…éƒ¨å¼€å‘äººå‘˜æŒæ¡æˆ‘ä»¬æ„å»ºçš„ web åº”ç”¨ç¨‹åºã€‚

æˆ‘åœ¨`require`ç¨‹åºä¸­éœ€è¦çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ JSON å¯¼å‡ºå¯¹è±¡ã€‚

åœ¨æˆ‘çš„æ–‡æ¡£å·¥å…·çš„ä¸€ä¸ªå­åŠŸèƒ½ä¸­ï¼Œæˆ‘éœ€è¦åšçš„å°±æ˜¯`require('this/is/pathfile.js')`å¹¶å¼€å§‹ä½¿ç”¨ JSON å±æ€§ã€‚åº”è¯¥å¾ˆå®¹æ˜“å§ï¼Ÿæ²¡æœ‰ã€‚ä¸€ç‚¹ä¹Ÿä¸ã€‚

![](img/43fbd94cc000dade07e9b0b28d1bd12b.png)

ğŸ¤¬ä¸ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸ºä»€ä¹ˆï¼ŸğŸ¤¬

å¦‚æœä½ é‡åˆ°äº†`Unexpected token export`ï¼Œæ¯«æ— ç–‘é—®ä½ ä¼šåœ¨è°·æ­Œä¸Šæœç´¢å„ç§å…³äº CommonJS å’Œ es æ¨¡å—å¯¼å…¥/å¯¼å‡ºã€å®éªŒæ¨¡å—å’Œ JS æ–‡ä»¶å®Œå…¨ä¼ è¾“ä¹‹é—´çš„å·®å¼‚çš„æ–‡ç« ã€‚

é‚£ä¹ˆä½ æ˜¯åšä»€ä¹ˆçš„â€¦ï¼Ÿ

æˆ‘ä»¬ä¸­æœ€èªæ˜çš„äººå¯èƒ½ä¼šå»ºè®®æ˜¾è€Œæ˜“è§çš„(æ­£ç¡®çš„)è§£å†³æ–¹æ¡ˆæ˜¯é‡æ„æºæ–‡ä»¶ã€‚ä¸ºä»€ä¹ˆæœ‰ä¸€ä¸ª JS æ–‡ä»¶åªå¯¼å‡ºä¸€ä¸ª JSON å¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä¸åªæ˜¯ä¸€ä¸ª JSON æ–‡ä»¶ï¼Ÿæ‰€æœ‰è¿™äº›éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯åœ¨æˆ‘çš„ç¯å¢ƒä¸­ï¼Œæœ‰ä¸€äº›åŸå› ä½¿æˆ‘æ— æ³•å°† *AppPaths.js* æ–‡ä»¶æ›´æ”¹ä¸º *AppPaths.json* ã€‚æŠŠæ–‡ä»¶æœ¬èº«æ”¾åœ¨ä¸€è¾¹ï¼Œè€ƒè™‘é—®é¢˜æ˜¯å¯¼å‡º/è¯·æ±‚ï¼Œæœ‰äº›æƒ…å†µä¸‹ä½ çš„ä¾‹å­ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚

æ‰€ä»¥æˆ‘æ˜¯è¿™ä¹ˆåšçš„ã€‚

æˆ‘ç”¨çš„æ˜¯[å·´åˆ«å¡”](https://babeljs.io/)ã€‚Babel å¯ä»¥å°† ES æ¨¡å—æ–‡ä»¶è½¬æ¢æˆå¹¿æ³›å…¼å®¹çš„ JavaScriptï¼Œç”šè‡³å¯ä»¥ä¸ CommonJS å…¼å®¹ã€‚è¦å®‰è£…ï¼Œè¯·å‚è§ä»–ä»¬çš„[ä½¿ç”¨è¯´æ˜](https://babeljs.io/docs/en/usage)ã€‚

æ‰€ä»¥è¿™å¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„æƒŠå–œå› ç´ ï¼Œå¯¹å—ï¼Ÿæ¯ä¸ªäººå’Œä»–ä»¬çš„ç¥–æ¯éƒ½çŸ¥é“å·´åˆ«å¡”ã€‚é‚£åˆæ€æ ·ï¼Ÿè¿™æ˜¯ä¸€ç§å¯ä»¥ç†è§£çš„ååº”ã€‚

ç„¶è€Œï¼Œå¦‚æœä½ ä¸€ç›´åœ¨è°·æ­Œæœç´¢è¿™ä¸ªç­”æ¡ˆï¼Œä½ ä¼šæ³¨æ„åˆ°å¤§å¤šæ•°ç­”æ¡ˆæ˜¯ä½¿ç”¨å‘½ä»¤è¡Œ/ç»ˆç«¯æ“ä½œå°†æºä»£ç è½¬æ¢æˆ CommonJS æ ¼å¼ï¼Œé€šå¸¸ä¼šç”Ÿæˆæ„å»ºæ–‡ä»¶å¤¹ã€‚æˆ‘ä¸éœ€è¦æ‰€æœ‰è¿™äº›ï¼Œæˆ‘åªéœ€è¦è§£æè¿™ä¸ªæ–‡ä»¶æ¥å¾—åˆ°ä¸€ä¸ªç®€å•çš„ JSON å¯¹è±¡ã€‚èµ°å§ã€‚

å·´åˆ«å¡”æ¥æ•‘æ´äº†ã€‚æœ‰å„ç§å„æ ·çš„`@babel/core` [è½¬æ¢å‡½æ•°](https://babeljs.io/docs/en/babel-core)å…è®¸ä½ è½¬æ¢ä»£ç ã€‚æˆ‘æ„Ÿå…´è¶£çš„æ˜¯ [transformFileSync](https://babeljs.io/docs/en/babel-core#transformfilesync) ã€‚å°†æ­¤ä¸[babel-plugin-transform-es 2015-modules-commonjs](https://babeljs.io/docs/en/babel-plugin-transform-es2015-modules-commonjs)ç»“åˆä½¿ç”¨ï¼Œæˆ‘æœ‰äº†ä¸€ä¸ªåœ¨è¿è¡Œæ—¶è½¬æ¢æ¼äººæ–‡ä»¶çš„è§£å†³æ–¹æ¡ˆã€‚

ä½†æˆ‘ä»¬è¿˜æ²¡åˆ°é‚£ä¸€æ­¥ã€‚æˆ‘æœ‰äº†è¿™ä¸ª`babelTransformedFile`å˜é‡ï¼Œæœç„¶ï¼Œå®ƒæœ‰ä¸€ä¸ª`code`å±æ€§æ˜¾ç¤ºè½¬æ¢åçš„ä»£ç ã€‚ä¸è¿‡è¿™å·²ç»è¶³å¤Ÿç”¨äº†ã€‚å‰©ä¸‹è¦åšçš„å°±æ˜¯`writeFile`åˆ°ä¸€ä¸ªç›®å½•ï¼Œç„¶å`require`ç°åœ¨å…¼å®¹çš„æ–‡ä»¶ã€‚

æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨`default`æ˜¯å› ä¸ºæˆ‘ä»¬çš„ ES æ¨¡å—æ–‡ä»¶æ˜¯ç”¨`export default`ç¼–è¾‘çš„ã€‚

å°±æ˜¯è¿™æ ·ï¼

## æ‘˜è¦

è¿™æ˜¯å®Œæ•´çš„ä»£ç è§£å†³æ–¹æ¡ˆï¼Œç”¨äºæ£€ç´¢ ES æ¨¡å—æ–‡ä»¶ï¼Œä½¿ç”¨ Babel è¿›è¡Œè½¬æ¢ï¼Œå†™å…¥ä¸´æ—¶ä½ç½®ï¼Œæœ€åä½¿ç”¨`require`ã€‚æœ‰æ”¹è¿›å’ŒæŠ½è±¡å¯ä»¥åšï¼Œä½†å¯¹æˆ‘æ¥è¯´é‚£æ˜¯ YAGNI çš„äº‹ã€‚

> è¿™æ˜¯æˆ‘çš„è§£å†³æ–¹æ¡ˆã€‚æœ‰è®¸å¤šåƒå®ƒä¸€æ ·çš„ï¼Œä½†æ˜¯è¿™ä¸€ä¸ªæ˜¯æˆ‘çš„ã€‚

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å†…å®¹ä¸°å¯Œï¼Œå¯¹æ‚¨æœªæ¥çš„ç¼–ç å†’é™©æœ‰æ‰€å¸®åŠ©ã€‚

> å¦‚æœä½ å–œæ¬¢è¿™ç¯‡é«˜äºå¹³å‡æ°´å¹³çš„æ–‡ç« ï¼Œè¯·ç”¨å‹å¥½çš„æŒå£°åˆ†äº«ä½ çš„å–œçˆ±ğŸ‘ã€‚
> 
> å¦‚æœä½ ä¸å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œæƒ³è¦è¡¨è¾¾ä½ å¯¹å®ƒçš„ä¸æ»¡ï¼Œä½ å¯ä»¥ç»™å®ƒä¸€ä¸ªå¯æ¶çš„æŒå£°ğŸ‘

> æœ¬å‡ºç‰ˆç‰©ä¸­è¡¨è¾¾çš„**è§‚ç‚¹æ˜¯ä½œè€…çš„è§‚ç‚¹ã€‚å®ƒä»¬æ— æ„åæ˜ ä½œè€…å¯èƒ½æ¶‰åŠçš„ä»»ä½•ç»„ç»‡æˆ–ä¼ä¸šçš„è§‚ç‚¹ã€‚**

[](https://gitconnected.com/learn/node-js) [## å­¦ä¹  Node.js -æœ€ä½³ Node.js æ•™ç¨‹(2019) | gitconnected

### å‰ 33 ä¸ª Node.js æ•™ç¨‹-å…è´¹å­¦ä¹  Node.jsã€‚è¯¾ç¨‹ç”±å¼€å‘äººå‘˜æäº¤å’ŒæŠ•ç¥¨ï¼Œä½¿æ‚¨èƒ½å¤Ÿâ€¦

gitconnected.com](https://gitconnected.com/learn/node-js)