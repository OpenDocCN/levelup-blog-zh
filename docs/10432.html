<html>
<head>
<title>Create Interactive HTML Tables Populated With API Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建用应用编程接口数据填充的交互式超文本标记语言表</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/create-interactive-html-tables-populated-with-api-data-dd5c467b0851?source=collection_archive---------3-----------------------#2021-12-06">https://levelup.gitconnected.com/create-interactive-html-tables-populated-with-api-data-dd5c467b0851?source=collection_archive---------3-----------------------#2021-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/55f808ca58c418d82820c34d6a682040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lb4c-sjNnJENnZCT7rkXQQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/photos/GVZZSxjblsY" rel="noopener ugc nofollow" target="_blank"> Quaid Lagan </a>在<a class="ae kc" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的图像</figcaption></figure><h2 id="4b43" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">概观</h2><p id="dfba" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">我最近建立的一个网站需要一个动态表，其中填充了来自API调用的实时数据。简单的超文本标记语言是<em class="lu">而不是</em>来切割它。</p><p id="31fe" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">所以我转向了<a class="ae kc" href="https://datatables.net/" rel="noopener ugc nofollow" target="_blank"> jQuery DataTables </a>，这是一个免费的库，可以很容易地为任何HTML表添加用户友好的特性。</p><p id="72c7" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">我的表格显示了新泽西州几十个热门海滩的天气预报(以及驾驶距离)。这是最后的结果。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/8190c28c7bfdd27b445299965f44108c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-0jJbOnHslKA6IiuDjkzkg.gif"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者的GIF。在<a class="ae kc" href="https://github.com/misha345a/NJ_Beach_Tracker" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上查看整个项目</figcaption></figure><p id="8862" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">然而，要做到这一点相当令人头痛——尤其是对于那些在服务器端使用JavaScript的人来说，可用的文档数量很少。</p><p id="9ad6" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated"><strong class="lb ir">在本文中，我将介绍将HTML表的数据馈送连接到JS服务器端脚本所需的基本结构。</strong></p><h2 id="07d3" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">计划</h2><p id="4d15" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">让我们从一个示例项目开始。</p><p id="14d7" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">通常，我们的数据不会被硬编码。它很可能是从API中检索到的。我们的目标是用来自这个<a class="ae kc" href="https://jsonplaceholder.typicode.com/" rel="noopener ugc nofollow" target="_blank">在线REST API </a>的假数据填充目录(这是免费的，不需要API密钥)。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/c2e1511cbb6fc74851a2417e3cc7ce8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*DLYVadYxpirl85gRjFabWg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者的形象。来自<a class="ae kc" href="https://jsonplaceholder.typicode.com/todos/" rel="noopener ugc nofollow" target="_blank">的样本数据，此处为</a></figcaption></figure><h2 id="0fa8" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">项目文件夹</h2><p id="d798" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">在根项目文件夹中保持适当的文件结构很重要。</p><p id="cc5a" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">我的是这样的:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/9865ecfdc77636af3ca0ca6fb2f2d0f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PdIpwNyXzHRJPDzlTST_7A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者的形象</figcaption></figure><p id="8976" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">为了测试，我将使用Node.js在本地启动web服务器。示例项目文件和所需的包可以在GitHub <a class="ae kc" href="https://github.com/misha345a/DataTables_Sample_Project" rel="noopener ugc nofollow" target="_blank">上找到，这里是</a>。</p><h2 id="c46e" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">表格HTML</h2><p id="ae07" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">首先，我们需要包含必要的源文件。将此代码块复制并粘贴到您的HTML文件中。它将导入JQuery库、DataTables Javascript以及CSS文件，我个人更喜欢这些文件，而不是默认的表格样式。</p><pre class="mb mc md me gt mh mi mj mk aw ml bi"><span id="4028" class="kd ke iq mi b gy mm mn l mo mp">&lt;link rel="stylesheet" type="text/css" href="<a class="ae kc" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css</a>"&gt;</span><span id="d7e0" class="kd ke iq mi b gy mq mn l mo mp">&lt;link rel="stylesheet" type="text/css" href="<a class="ae kc" href="https://cdn.datatables.net/1.11.1/css/dataTables.bootstrap5.min.css" rel="noopener ugc nofollow" target="_blank">https://cdn.datatables.net/1.11.1/css/dataTables.bootstrap5.min.css</a>"&gt;</span><span id="6c42" class="kd ke iq mi b gy mq mn l mo mp">&lt;script type="text/javascript" language="javascript" src="<a class="ae kc" href="https://code.jquery.com/jquery-3.5.1.js" rel="noopener ugc nofollow" target="_blank">https://code.jquery.com/jquery-3.5.1.js</a>"&gt;&lt;/script&gt;</span><span id="7eab" class="kd ke iq mi b gy mq mn l mo mp">&lt;script type="text/javascript" language="javascript" <br/>src="<a class="ae kc" href="https://cdn.datatables.net/1.11.1/js/jquery.dataTables.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.datatables.net/1.11.1/js/jquery.dataTables.min.js</a>"&gt;&lt;/script&gt;</span><span id="160e" class="kd ke iq mi b gy mq mn l mo mp">&lt;script type="text/javascript" language="javascript" src="<a class="ae kc" href="https://cdn.datatables.net/1.11.1/js/dataTables.bootstrap5.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.datatables.net/1.11.1/js/dataTables.bootstrap5.min.js</a>"&gt;&lt;/script&gt;</span></pre><p id="52b3" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">然后，创建一个HTML表，并给它适当的列名。</p><blockquote class="mr ms mt"><p id="5fe7" class="kz la lu lb b lc lv le lf lg lw li lj mu lx ll lm mv ly lo lp mw lz lr ls lt ij bi translated">为了使数据表能够增强HTML表，该表必须是有效的、格式良好的HTML，具有一个标题(<strong class="lb ir"> thead </strong>)和一个正文(<strong class="lb ir"> tbody </strong>)。也可以使用可选的页脚(<strong class="lb ir"> tfoot </strong>)。<br/> - <a class="ae kc" href="https://datatables.net/manual/installation" rel="noopener ugc nofollow" target="_blank">数据表文档</a></p></blockquote><pre class="mb mc md me gt mh mi mj mk aw ml bi"><span id="d64a" class="kd ke iq mi b gy mm mn l mo mp">&lt;div class="container" style="width:60%;"&gt;<br/>  &lt;table id="example"&gt;<br/>      &lt;thead&gt;<br/>          &lt;tr&gt;<br/>              &lt;th scope="col"&gt;USER ID&lt;/th&gt;<br/>              &lt;th scope="col"&gt;ID&lt;/th&gt;<br/>              &lt;th scope="col"&gt;TITLE&lt;/th&gt;<br/>              &lt;th scope="col"&gt;COMPLETED&lt;/th&gt;<br/>          &lt;/tr&gt;<br/>      &lt;/thead&gt;<br/>  &lt;/table&gt;<br/>&lt;/div&gt;</span></pre><h2 id="441e" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">正在初始化数据表</h2><p id="4565" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">现在，让我们初始化HTML文件中的数据表。在这个代码块中，我们告诉DataTables用<em class="lu"> id="example" </em>选择我们的HTML表，并在文档完全准备好之后加载数据。</p><pre class="mb mc md me gt mh mi mj mk aw ml bi"><span id="3161" class="kd ke iq mi b gy mm mn l mo mp">&lt;script type="text/javascript" class="init"&gt;</span><span id="77dc" class="kd ke iq mi b gy mq mn l mo mp">$(document).ready(function() {<br/>  // Create a new DataTable object<br/>  table = $('#example').DataTable({<br/>       ajax: {<br/>         url: '/exampleData',<br/>       },<br/>       columns: [<br/>           { data: 'userId' },<br/>           { data: 'id' },<br/>           { data: 'title' },<br/>           { data: 'completed' }<br/>         ]<br/>       })<br/>});</span><span id="1eed" class="kd ke iq mi b gy mq mn l mo mp">&lt;/script&gt;</span></pre><p id="c431" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">ajax。URL()方法用于定义表格的Ajax数据源。在这种情况下，数据表将试图从<em class="lu"> /exampleData </em>获取数据；我们将在下一步实现一个app.get()请求函数来处理这个问题。</p><p id="285f" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated"><strong class="lb ir">本质上，DataTables通过Ajax向服务器端发送GET请求，同时期待JSON数据的返回。</strong></p><p id="7f8b" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">在加载表之前，有许多方法可以处理和操纵JSON响应。请参考文档的第页。</p><p id="2853" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">在我们的例子中，JSON响应是一个伪todo项的数组，其中每个项都是表中的一行。<em class="lu"> columns </em>参数提供了关于项目的每个数据点在表格上的位置的更多细节。例如，响应数组中的第一项是:</p><pre class="mb mc md me gt mh mi mj mk aw ml bi"><span id="7001" class="kd ke iq mi b gy mm mn l mo mp">[ {<br/> “userId”: 1,<br/> “id”: 1,<br/> “title”: “delectus aut autem”,<br/> “completed”: false<br/> },<br/>…<br/>]</span></pre><p id="7b17" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">因此<em class="lu"> { data: 'userId' } </em>指定表的第一列将接收与“userId”键配对的数据。如果你有嵌套数据，那么<em class="lu">列</em>方法将帮助你通过使用点对象符号来访问它。</p><h2 id="074b" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">服务器端API请求</h2><p id="670f" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">在服务器端，我们可以使用Express包为HTTP GET请求定义一个路由处理程序。</p><pre class="mb mc md me gt mh mi mj mk aw ml bi"><span id="2889" class="kd ke iq mi b gy mm mn l mo mp">app.get("/exampleData", function (req, res) {</span><span id="7728" class="kd ke iq mi b gy mq mn l mo mp">const url = '<a class="ae kc" href="https://jsonplaceholder.typicode.com/todos'" rel="noopener ugc nofollow" target="_blank">https://jsonplaceholder.typicode.com/todos'</a>;</span><span id="6ca6" class="kd ke iq mi b gy mq mn l mo mp">// Make a request<br/>  axios.get(url)<br/>    .then(response =&gt; {<br/>      // send the collected data back to the client-side DataTable<br/>      res.json({<br/>        "data": response.data<br/>      })<br/>    })<br/>    .catch(function (error) {<br/>       // handle error<br/>       res.json({"error": error});<br/>    })<br/>});</span></pre><p id="f33e" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">所以现在，每次DataTables向url <em class="lu"> exampleData </em>发送GET请求，都会在这里收到。一旦发生这种情况，我们从API中检索数据，然后将其发送到客户端的数据表。发送到数据表的数据是以JSON有效负载的形式，随后填充到表中。</p><p id="12f9" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated"><em class="lu">数据</em>参数在响应中是必需的，表示数据表要使用的数据。当触发时，<em class="lu">错误</em>参数可用于在用户页面上显示错误消息。</p><p id="5d24" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">此时，每次加载或刷新页面时，该表都会填充数据。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/ebac2320421db6e7512d8d1d305c2e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HBKbFElJ54wW35wExLnJSQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图片由作者提供。来自本地主机的快照:3000</figcaption></figure><h2 id="eba8" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">定制选项</h2><p id="8629" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">初始化数据表后，库自动为我们的表添加了响应搜索、排序和分页功能！但是我通常喜欢包括几个其他的配置参数。它们在DataTable()函数中指定。</p><pre class="mb mc md me gt mh mi mj mk aw ml bi"><span id="010e" class="kd ke iq mi b gy mm mn l mo mp">table = $('#example').DataTable({<br/>       "lengthMenu": [ [15, 50, 100, -1], [15, 50, 100, "All"] ],<br/>       "pagingType": "simple",<br/>       scrollY: 400,<br/>       scrollCollapse: true,<br/>       order: [[ 0, 'asc' ], [3, 'desc' ]],</span><span id="cc7e" class="kd ke iq mi b gy mq mn l mo mp">ajax{...},<br/>       columns: ...<br/>})</span></pre><p id="98db" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">概括地说，我定制了表可以显示多少条目的选项，以及分页特性的样式。我还添加了<em class="lu"> scrollY </em>,这样表格将有一个固定标题的可滚动主体。最后，我定义了数据加载后用户ID和完成列的顺序。</p><p id="b40f" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">这是桌子现在的样子。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/89546ac53018cd61e29b33dc32da84ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*UZiAfQGSsaO51DKqyE7Zzw.gif"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者GIF。示例项目表</figcaption></figure><h2 id="4497" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h2><p id="6b28" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">我们已经成功地实现了使我们的HTML表具有响应性、交互性和链接到服务器的核心元素。然而，这只是一个基础，更多的复杂性现在可以叠加在上面。</p><p id="c06a" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">感谢您的阅读！</p><p id="ba83" class="pw-post-body-paragraph kz la iq lb b lc lv le lf lg lw li lj km lx ll lm kq ly lo lp ku lz lr ls lt ij bi translated">同样，样本项目文件在<a class="ae kc" href="https://github.com/misha345a/DataTables_Sample_Project" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上。</p></div></div>    
</body>
</html>