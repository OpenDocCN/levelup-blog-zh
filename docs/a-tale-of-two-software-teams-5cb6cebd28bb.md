# 两个软件团队的故事

> 原文：<https://levelup.gitconnected.com/a-tale-of-two-software-teams-5cb6cebd28bb>

![](img/6a53938e095b390c3454a311095661f5.png)

乔纳斯·雅各布森在 [Unsplash](https://unsplash.com/s/photos/nba?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

*这是我的现代软件开发实践系列* [*中的第四部分*](https://medium.com/@tylor.borgeson/my-series-on-modern-software-development-practices-372c65a2837e?source=friends_link&sk=3b037795f393df5554502e2c65365d0d) *。在这个系列中，我涵盖了我认为软件工程师可以通过改进他们的过程和实践来改进他们的软件的多种方法，所有这些都是我在 ThoughtWorks 担任软件顾问期间学到并经历过的，也是我目前在德国一家大型零售公司工作的经历。*

我参加过很多团队。足球、棒球、摔跤、篮球、橄榄球、田径……我基本上参加了所有的团队运动。

有趣的是，这感觉就像我已经在几乎相同数量的不同软件团队中工作过。

我注意到的一件事是，不管是什么样的团队，天赋都是团队成功的重要因素(在体育比赛中获胜，在软件中快速交付功能性的无 bug 特性)，但这不是唯一真正重要的事情。

练习很重要。但不是任何练习…真正重要的练习是感觉不像练习的练习。当感觉像真实生活场景时，练习总是最好的…在体育中，这意味着像游戏一样练习，在软件中，这意味着像生产一样测试。

这让我想到了本文的观点，像生产一样进行开发和测试。我想通过描述两个团队来说明这一点，在我作为软件工程师的职业生涯中，我是这两个团队中的一员。

# **更加努力工作公司—团队 1**

*很明显公司名称是虚构的，但团队情况却如描述的那样。*

我们是一个开发应用程序的团队，其中多个团队正在构建服务，这些服务都由一个前端应用程序访问，并且这些服务经常相互交互。

在团队的第一天，我必须设置我的电脑才能开发。这不仅包括安装我的团队的服务需要的大量依赖项，还包括其他团队拥有的任何依赖项，这样我就可以在本地运行整个应用程序。

花了两天时间才得到一个本地运行的实例…我知道其他一些开发人员从来没有真正做到这一点，而是试图与他人配对编程，以至于不必使用他们的计算机。

一些开发人员甚至无法在本地测试他们的更改，这意味着他们必须将他们的更改发布到测试环境中，以查看他们的更改如何与所有其他服务交互，更不用说代码如何独立工作了。

这是具有挑战性的，因为实际上相当多的其他团队拥有不经常部署到所有环境中的管道。这经常导致测试环境中的测试结果与生产环境中实际发生的结果不同。

有一次，一个开发人员对一个函数进行了修改，这个函数的目的是与另一个团队的服务交换数据，她在测试环境中测试了这个函数。在测试环境中，变更完全破坏了方法的功能，但是当变更被发送到生产环境中时，它按照预期工作，因为其他团队在各自的环境中有不同版本的代码，很明显，生产环境的版本(5.0.2)比测试环境的版本(5.0.1)更新。

有趣的是，测试环境当然只是其他虚拟机，当我们需要用新代码更新它们时，需要开发人员远程登录到机器上并运行脚本，该脚本从数据库中提取最新代码，并使用新代码重新启动应用程序。此外，可供开发人员用作测试的虚拟机数量有限。

这也使得从部署到生产成为一个漫长而微妙的过程。每两周一次，我们使用用于更新测试机器的相同过程进行部署。这当然是一个时间消耗者，在最坏的情况下，每次需要将某些东西推向生产时(特性、错误修复，等等)，都必须重复这个过程。

# **更聪明地工作公司—团队 2**

*显然公司名称是虚构的，但团队情况却如描述的那样。*

就我们所构建的东西而言，这个团队几乎和第一个团队是完全一样的。我们是一个致力于多项[微服务](https://microservices.io/)的团队，并与做同样事情的多个其他团队互动。我们的服务经常向其他团队的服务接收或发送数据，并依赖来自他们的 REST 调用。

在团队的第一天，我不得不再次设置我的计算机以便能够开发。README.md 中定义的用于设置我的计算机的设置说明只提到了几件事:

1.  [安装对接器](https://www.docker.com/)
2.  如何从团队图像库中提取和推送 docker 图像
3.  如何在本地运行容器
4.  如何将本地更改挂载到容器中

半小时后，在获得正确的回购凭证后，我让第一个服务在本地运行，并包含我想做的任何更改。

这个团队也有一些像第一个团队一样的环境。他们有测试、试运行和生产。一旦变更提交到主分支，[持续集成/持续部署管道](/heres-why-continuous-integration-and-deployment-is-so-important-to-the-software-development-c0caeead5881?source=friends_link&sk=82592dcef8b9de843ed7192555c4f000)将代码构建为 docker 映像，运行测试套件，用版本号标记映像，将映像推送到 repo，然后用最新版本自动替换测试和试运行环境中的 docker 容器。生产部署在必要时手动触发，但遵循相同的流程。

在糟糕的一天，整个过程只花了 10 分钟。

聪明工作公司的所有团队都有类似的设置。

这两种环境的区别在于，测试环境有“测试”数据，所有第三方服务都被嘲笑或忽略，而登台环境也有“测试”数据，但完全与所有其他服务集成在一起。

# **主要区别:**

这两种团队设置的主要区别，我已经见过很多次了，很容易发现，我想当被问到他们想加入哪一个团队时，大多数开发人员都会选择同一个团队。

## **集装箱化应用**

第二个团队将他们的服务容器化，这有很多好处。

容器提供的灵活性不仅在设置新机器时很普遍，因为所有需要的依赖项在容器中都可用，而且在部署过程中也很普遍。

容器充当了能够被轻松快速替换的模块 [(re:四个关键指标。部署频率上升)](https://medium.com/swlh/software-development-practices-as-recommended-by-gene-kim-c6f6e952309f?source=friends_link&sk=6765b03e3a62f0988652971f46c3120a)

集装箱化也有助于确保跨环境的标准化。

## **标准化/一致性**

在第一个团队中，主要的挑战来自于环境没有标准化的事实。

每台虚拟机都必须使用正确的软件包版本单独更新到正确的代码版本，当一台虚拟机被遗忘时，它通常会导致问题，如果不是功能问题，则是安全问题。

环境的不一致性也阻碍了有效测试变更的能力。没有人知道测试或试运行中的功能是否等同于生产中的功能。错误通常是由不同环境之间的差异引起的。

在第二个团队中，容器化与 CD 管道相结合，使得从生产一直到本地环境，保持所有环境尽可能相似变得容易。当然，仍然有 bug，但它们肯定是我们不必担心的事情。[(回复:四个关键指标。](https://medium.com/swlh/software-development-practices-as-recommended-by-gene-kim-c6f6e952309f?source=friends_link&sk=6765b03e3a62f0988652971f46c3120a)更改故障率下降)

这个故事的寓意用一句话来说:

> *标准化的开发、测试、试运行和生产环境，通过容器化和持续集成和部署变得更加容易，对于团队测试和确保质量的能力是无价的。*

更聪明地工作，而不是更努力地工作，我的朋友。

[*我的现代软件开发实践系列中的其他文章可以在这里找到*](https://medium.com/@tylor.borgeson/my-series-on-modern-software-development-practices-372c65a2837e?source=friends_link&sk=3b037795f393df5554502e2c65365d0d)