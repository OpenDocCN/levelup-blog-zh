<html>
<head>
<title>JavaScript Problems — Clear Cookies, Run Function Periodically, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript问题——清除Cookies、定期运行函数等等</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-problems-clear-cookies-run-function-periodically-and-more-7ef1d5ff137a?source=collection_archive---------14-----------------------#2020-07-01">https://levelup.gitconnected.com/javascript-problems-clear-cookies-run-function-periodically-and-more-7ef1d5ff137a?source=collection_archive---------14-----------------------#2020-07-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d8b1133c9eda417890904b4c0aabd628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GjXNKHHoH4Q3x3G9"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@__elisa__?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Elisa Kerschbaumer </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="c016" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="b708" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">清除Cookies</h1><p id="5ef6" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过将cookie的<code class="fe mh mi mj mk b">Max-Age</code>设置为过去的时间戳来清除cookie。</p><p id="13e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="f9f5" class="mt lf it mk b gy mu mv l mw mx">document.cookie = `${name}; Max-Age=-99999999;`;</span></pre><p id="78a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将带有给定键的cookie设置为过去的时间戳以立即删除它。</p><h1 id="f23d" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">异步和延迟脚本标记</h1><p id="9129" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated"><code class="fe mh mi mj mk b">async</code>对于异步加载脚本很有用。具有<code class="fe mh mi mj mk b">async</code>属性的脚本可以以任何顺序加载。</p><p id="e261" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们想异步加载脚本，并按照脚本标签列出的顺序加载，我们可以使用<code class="fe mh mi mj mk b">defer</code>属性。</p><h1 id="f1fd" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">将基数添加到parseInt</h1><p id="6d5d" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们应该将基数传递给<code class="fe mh mi mj mk b">parseInt</code>的第二个参数，这样它将总是按照我们想要的大小写将数字字符串解析成整数。</p><p id="cf10" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="6832" class="mt lf it mk b gy mu mv l mw mx">parseInt('100', 10);</span></pre><p id="93f7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么字符串<code class="fe mh mi mj mk b">'100'</code>将被解析为一个基数为10的数字，而不是它想要的任何数字。如果我们省略基数，数字以<code class="fe mh mi mj mk b">'0x'</code>开始，那么基数自动设置为16。如果字符串以<code class="fe mh mi mj mk b">'0'</code>开头，那么在旧版本的浏览器中，该数字可能会被解析为八进制数。</p><p id="4c28" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一个字符串以任何其他值开始，那么它被解析为一个十进制数。</p><h1 id="a83e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">用<br/>元素替换所有换行符</h1><p id="12cf" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以搜索所有换行符，并用<code class="fe mh mi mj mk b">replace</code>替换<code class="fe mh mi mj mk b">'&lt;br&gt;'</code>。</p><p id="fc74" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="b3a4" class="mt lf it mk b gy mu mv l mw mx">str = str.replace(/(?:\r\n|\r|\n)/g, '&lt;br&gt;');</span></pre><p id="12f2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<code class="fe mh mi mj mk b">/(?:\r\n|\r|\n)/g</code>搜索字符串中的所有换行符。</p><p id="4e5c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们传入<code class="fe mh mi mj mk b">'&lt;br&gt;'</code>来替换它们。</p><h1 id="d741" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从不使用eval</h1><p id="6145" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">使用<code class="fe mh mi mj mk b">eval</code>通常不是个好主意。我们可能会向代码注入攻击开放我们的应用程序。</p><p id="90a5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">调试更具挑战性，因为运行的代码是在字符串中，所以没有语法高亮、自动完成、行号等。</p><p id="f04d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用<code class="fe mh mi mj mk b">eval</code>运行的代码也更慢，因为代码在字符串中，所以没有机会编译或缓存代码。</p><h1 id="7cbb" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">如何并行运行多个NPM脚本？</h1><p id="7e21" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以使用<code class="fe mh mi mj mk b">concurrently</code>包来并行运行脚本。</p><p id="464f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们只是写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="987d" class="mt lf it mk b gy mu mv l mw mx">"dev": "concurrently --kill-others \"npm run start-watch\" \"npm run serve\""</span></pre><p id="0690" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们只是使用带有<code class="fe mh mi mj mk b">--kill-others</code>开关的包和它后面的脚本。</p><p id="3a52" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">--kill-others</code>死一个就杀所有命令。</p><h1 id="e7c1" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">初始化数组的长度</h1><p id="8516" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们不需要将数组初始化为给定的长度，因为JavaScript数组是动态长度的。</p><p id="4ed4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们可以将事物放入任何索引中。</p><h1 id="7e03" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">选中或取消选中JavaScript复选框</h1><p id="6651" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以将<code class="fe mh mi mj mk b">checked</code>属性设置为<code class="fe mh mi mj mk b">true</code>或<code class="fe mh mi mj mk b">false</code>，分别使复选框被选中或取消选中。</p><p id="8b42" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="9f0c" class="mt lf it mk b gy mu mv l mw mx">document.getElementById("checkbox").checked = true;</span></pre><p id="fc1b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要选中复选框并:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="dbdb" class="mt lf it mk b gy mu mv l mw mx">document.getElementById("checkbox").checked = false;</span></pre><p id="7c5c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">取消选中它。</p><p id="3365" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用jQuery，我们可以使用<code class="fe mh mi mj mk b">prop</code>方法将<code class="fe mh mi mj mk b">'checked'</code>属性设置为<code class="fe mh mi mj mk b">true</code>或<code class="fe mh mi mj mk b">false</code>来做同样的事情。</p><p id="e602" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="7d85" class="mt lf it mk b gy mu mv l mw mx">$("#checkbox").prop("checked", true);</span></pre><p id="e598" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要选中复选框并:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="0215" class="mt lf it mk b gy mu mv l mw mx">$("#checkbox").prop("checked", false);</span></pre><p id="d828" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">取消选中它。</p><h1 id="3a08" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">每5秒钟调用一次函数</h1><p id="27ff" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要调用一个函数everything 5秒，我们可以使用<code class="fe mh mi mj mk b">setInterval</code>函数。</p><p id="359c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="2941" class="mt lf it mk b gy mu mv l mw mx">setInterval(() =&gt; { <br/>  // ...<br/>}, 5000);</span></pre><p id="84bb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在回调中，我们可以每隔5秒运行一段我们想运行的代码。</p><p id="0c0f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个参数以毫秒为单位，因此5000是5秒。</p><h1 id="b1bd" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">检查函数是否存在</h1><p id="07a4" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了检查函数是否存在，我们可以使用<code class="fe mh mi mj mk b">typeof</code>操作符。</p><p id="6fb3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过编写以下代码来检查函数是否存在:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="21d4" class="mt lf it mk b gy mu mv l mw mx">if (typeof me.foo !== "undefined") { <br/>  // ...<br/>}</span></pre><p id="c390" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用前检查<code class="fe mh mi mj mk b">foo</code>方法是否为<code class="fe mh mi mj mk b">undefined</code>。</p><p id="cf1b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以写一个更精确的检查:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="78a6" class="mt lf it mk b gy mu mv l mw mx">if (typeof me.foo === "function") { <br/>  // ...<br/>}</span></pre><p id="2f5e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查<code class="fe mh mi mj mk b">foo</code>是否确实是一个函数值属性。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/c706f17f2039ce0201b2bee558d296fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V_v3bLxVPloWarVd"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">兹登尼克·马赫亚克在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="ab51" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="b732" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用<code class="fe mh mi mj mk b">typeof</code>操作符检查某个东西是否是一个函数。为了清除cookies，我们可以将<code class="fe mh mi mj mk b">Max-Age</code>设置为过去的时间戳。</p><p id="7a04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们定期运行代码。我们永远不应该使用<code class="fe mh mi mj mk b">eval</code>。</p><p id="b463" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基数参数应传入<code class="fe mh mi mj mk b">parseInt</code>。</p></div></div>    
</body>
</html>