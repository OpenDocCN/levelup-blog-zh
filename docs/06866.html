<html>
<head>
<title>Document Our Express API with the Swagger UI Express Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Swagger UI Express库记录我们的Express API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/document-our-express-api-with-the-swagger-ui-express-library-dde110363209?source=collection_archive---------6-----------------------#2021-01-09">https://levelup.gitconnected.com/document-our-express-api-with-the-swagger-ui-express-library-dde110363209?source=collection_archive---------6-----------------------#2021-01-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/3b644bc384aaec53335df31834e690b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iqds7sS1AL9J7OKm"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@karsten116?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡斯滕·怀恩吉尔特</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="1fc5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">编写API文档既痛苦又乏味。然而，如果我们使用Express，我们可以通过Swagger UI Express库使我们的生活变得更容易。在本文中，我们将看看如何使用这个库来记录我们的Express API。</p><h1 id="41eb" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">装置</h1><p id="e7d3" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过运行以下命令来安装该软件包:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="02d2" class="mq lf it mm b gy mr ms l mt mu">npm i swagger-ui-express</span></pre><h1 id="2740" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">记录我们的终点</h1><p id="7de2" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过编写一些代码来记录我们的端点。</p><p id="2a1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们通过编写以下内容来添加我们的<code class="fe mv mw mx mm b">swagger.json</code>文件:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="e33f" class="mq lf it mm b gy mr ms l mt mu">{  <br/>  "swagger": "2.0",<br/>  "info": {<br/>    "title": "some-app",<br/>    "version": "Unknown"<br/>  },<br/>  "consumes": [<br/>    "application/json"<br/>  ],<br/>  "produces": [<br/>    "application/json"<br/>  ],<br/>  "paths": {<br/>    "/{id}": {<br/>      "parameters": [<br/>        {<br/>          "name": "id",<br/>          "required": true,<br/>          "in": "path",<br/>          "type": "string",<br/>          "description": "some id"<br/>        }<br/>      ],<br/>      "get": {<br/>        "operationId": "routeWithId",<br/>        "summary": "some route",<br/>        "description": "some route",<br/>        "produces": [<br/>          "application/json"<br/>        ],<br/>        "responses": {<br/>          "200": {<br/>            "description": "200 response",<br/>            "examples": {<br/>              "application/json": "{ foo: 1 }"<br/>            }<br/>          }<br/>        }<br/>      }<br/>    },<br/>    "/": {<br/>      "parameters": [],<br/>      "get": {<br/>        "operationId": "anotherRoute",<br/>        "summary": "another route",<br/>        "description": "another route",<br/>        "produces": [<br/>          "application/json"<br/>        ],<br/>        "responses": {<br/>          "202": {<br/>            "description": "202 response",<br/>            "examples": {<br/>              "application/json": "{ foo: 'bar' }"<br/>            }<br/>          }<br/>        }<br/>      }      <br/>    }<br/>  }<br/>}</span></pre><p id="0081" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它包含了我们应用程序中端点的所有信息。数据包括所需的参数和响应。<code class="fe mv mw mx mm b">parameters</code>具有参数，<code class="fe mv mw mx mm b">responses</code>具有来自端点的可能响应。</p><p id="e39e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的应用程序文件中，我们写道:</p><p id="cb8b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">index.js</code></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="fd9f" class="mq lf it mm b gy mr ms l mt mu">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const swaggerUi = require('swagger-ui-express');<br/>const swaggerDocument = require('./swagger.json');<br/>const swaggerOptions = {<br/>  swaggerOptions: {<br/>    validatorUrl: null<br/>  }<br/>};</span><span id="ec54" class="mq lf it mm b gy my ms l mt mu">const app = express();</span><span id="7c62" class="mq lf it mm b gy my ms l mt mu">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));</span><span id="0c1a" class="mq lf it mm b gy my ms l mt mu">app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerDocument, swaggerOptions));</span><span id="ab1e" class="mq lf it mm b gy my ms l mt mu">app.get('/', (req, res) =&gt; {<br/>  res.json({ foo: 'bar' });<br/>});</span><span id="e92f" class="mq lf it mm b gy my ms l mt mu">app.get('/:id', (req, res) =&gt; {<br/>  res.json({ foo: req.params.id });<br/>});</span><span id="fe46" class="mq lf it mm b gy my ms l mt mu">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="7b61" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要我们的<code class="fe mv mw mx mm b">swagger.json</code>文件并添加<code class="fe mv mw mx mm b">api-docs</code>端点来显示文档。</p><p id="5b05" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有Swagger的验证器的URL，用于验证我们的文档。</p><p id="0fa8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们只是补充:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="bfd8" class="mq lf it mm b gy mr ms l mt mu">app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerDocument, swaggerOptions));</span></pre><p id="89ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">添加端点并传入显示文档的选项。</p><p id="bb91" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">swaggerUi.setup</code>方法将文档和选项作为参数。</p><p id="47ef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们转到<code class="fe mv mw mx mm b">/api-docs</code>端点时，我们应该看到Swagger接口，并用我们的应用程序尝试请求。</p><p id="e809" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以输入<code class="fe mv mw mx mm b">/{id}</code>端点的ID，并在单击Execute后查看响应。</p><h1 id="97bb" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">自定义CSS样式</h1><p id="4975" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用<code class="fe mv mw mx mm b">customCss</code>属性添加自定义CSS:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="784a" class="mq lf it mm b gy mr ms l mt mu">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const swaggerUi = require('swagger-ui-express');<br/>const swaggerDocument = require('./swagger.json');<br/>const swaggerOptions = {<br/>  swaggerOptions: {<br/>    validatorUrl: null,  <br/>  },<br/>  customCss: '.swagger-ui .topbar { display: none }'<br/>};</span><span id="d541" class="mq lf it mm b gy my ms l mt mu">const app = express();</span><span id="b0e4" class="mq lf it mm b gy my ms l mt mu">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));</span><span id="b083" class="mq lf it mm b gy my ms l mt mu">app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerDocument, swaggerOptions));</span><span id="d076" class="mq lf it mm b gy my ms l mt mu">app.get('/', (req, res) =&gt; {<br/>  res.json({ foo: 'bar' });<br/>});</span><span id="333f" class="mq lf it mm b gy my ms l mt mu">app.get('/:id', (req, res) =&gt; {<br/>  res.json({ foo: req.params.id });<br/>});</span><span id="cac4" class="mq lf it mm b gy my ms l mt mu">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="821e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们把顶栏藏了起来:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="012f" class="mq lf it mm b gy mr ms l mt mu">customCss: '.swagger-ui .topbar { display: none }'</span></pre><h1 id="7a20" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从URL加载Swagger</h1><p id="2e8b" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以使用<code class="fe mv mw mx mm b">url</code>选项从URL加载Swagger文件:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="30ae" class="mq lf it mm b gy mr ms l mt mu">const express = require('express');<br/>const app = express();<br/>const swaggerUi = require('swagger-ui-express');<br/> <br/>const options = {<br/>  swaggerOptions: {<br/>    url: 'http://petstore.swagger.io/v2/swagger.json'<br/>  }<br/>}<br/> <br/>app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(null, options));</span></pre><p id="8146" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以加载多个文件:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="e16b" class="mq lf it mm b gy mr ms l mt mu">const express = require('express');<br/>const app = express();<br/>const swaggerUi = require('swagger-ui-express');<br/> <br/>const options = {<br/>  explorer: true,<br/>  swaggerOptions: {<br/>    urls: [<br/>      {<br/>        url: 'http://petstore.swagger.io/v2/swagger.json',<br/>        name: 'Spec1'<br/>      },<br/>      {<br/>        url: 'http://petstore.swagger.io/v2/swagger.json',<br/>        name: 'Spec2'<br/>      }<br/>    ]<br/>  }<br/>}<br/> <br/>app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(null, options));</span></pre><h1 id="89be" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="d0e3" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用Swagger UI Express库轻松地记录我们的Express API。</p></div></div>    
</body>
</html>