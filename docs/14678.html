<html>
<head>
<title>VeeValidate 4: How to Disable the Submit Button</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VeeValidate 4:如何禁用提交按钮</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/veevalidate-4-how-to-disable-the-submit-button-2c893c437021?source=collection_archive---------6-----------------------#2022-12-16">https://levelup.gitconnected.com/veevalidate-4-how-to-disable-the-submit-button-2c893c437021?source=collection_archive---------6-----------------------#2022-12-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/dbdf739cd58ee999c14038e9b479ae91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l93Ay_tGXTRvwS7ofgt5og.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@florianolv?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Florian Olivo </a>在<a class="ae kf" href="https://unsplash.com/s/photos/programming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="9f02" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="3467" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><a class="ae kf" href="https://vee-validate.logaretm.com/v4/" rel="noopener ugc nofollow" target="_blank"> VeeValidate </a>是最流行的<a class="ae kf" href="https://vuejs.org" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>表单库之一，可以帮助你验证表单输入——目前在版本4中可用。该库使得在提交表单时验证表单输入字段变得很容易。但是，有时您希望通过禁用submit按钮来通知用户表单尚未完全填写和验证。</p><h1 id="cc10" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">在本指南中</h1><p id="bae8" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在安装VeeValidate 4之前，用<a class="ae kf" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank"> Vite </a>设置一个Vue 3项目。虽然带有<code class="fe mc md me mf b">&lt;script setup&gt;</code>语法的组合API用于应用程序本身，但基本表单是用VeeValidate的<code class="fe mc md me mf b">&lt;Form /</code>和<code class="fe mc md me mf b">&lt;Field /&gt;</code>组件构建的，而不是用<code class="fe mc md me mf b">useForm()</code>和<code class="fe mc md me mf b">useField()</code>组合函数构建的。最终的表单将包含一个定制的提交按钮组件，只要没有使用<code class="fe mc md me mf b">useIsFormValid()</code>和<code class="fe mc md me mf b">useIsFormDirty()</code>组合函数完全填充和验证表单，该组件就会被禁用。</p><p id="0773" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated"><strong class="lg iu">注意，这个解决方案只是众多解决方案中的一个！</strong></p><h1 id="6286" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">先决条件</h1><ul class=""><li id="82f4" class="ml mm it lg b lh li ll lm lp mn lt mo lx mp mb mq mr ms mt bi translated">对如何使用Vue 3 + Vite、组合API和<code class="fe mc md me mf b">&lt;script setup&gt;</code>语法有基本的了解</li><li id="fe1b" class="ml mm it lg b lh mu ll mv lp mw lt mx lx my mb mq mr ms mt bi translated">基本了解如何使用VeeValidate 4，如<code class="fe mc md me mf b">&lt;Form /&gt;</code>、<code class="fe mc md me mf b">&lt;Field /&gt;</code>和<code class="fe mc md me mf b">&lt;ErrorMessage /&gt;</code>组件。</li><li id="a116" class="ml mm it lg b lh mu ll mv lp mw lt mx lx my mb mq mr ms mt bi translated">你的机器上已经安装了node.js </li></ul><h1 id="bd38" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">安装Vue 3和VeeValidate 4</h1><p id="1288" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在所需的工作目录下打开您的终端，通过执行<a class="ae kf" href="https://vuejs.org/guide/quick-start.html#with-build-tools" rel="noopener ugc nofollow" target="_blank">文档</a>中描述的以下命令，用Vite初始化一个新的Vue 3应用程序:</p><pre class="mz na nb nc gt nd mf ne bn nf ng bi"><span id="cd19" class="nh kh it mf b be ni nj l nk nl">npm init vue@latest</span></pre><p id="f76b" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">你可能会被要求安装官方的Vue项目搭建工具<code class="fe mc md me mf b">create-vue@latest</code>。通过键入<code class="fe mc md me mf b">y</code>确认安装，并点击<em class="nm">进入</em>。接下来，您可以键入一个项目名称并选择可选功能，这在本指南的上下文中是不需要的。因此，用<code class="fe mc md me mf b">No</code>来回答所有的问题。</p><p id="6a23" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">现在导航到项目根文件夹，添加VeeValidate并安装所有依赖项:</p><pre class="mz na nb nc gt nd mf ne bn nf ng bi"><span id="57cd" class="nh kh it mf b be ni nj l nk nl">cd vue3_vite_i18n<br/>npm add vee-validate<br/>npm install</span></pre><p id="fd13" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated"><em class="nm">为避免混淆，请注意:</em><code class="fe mc md me mf b"><em class="nm">src/components/</em></code><em class="nm"/><code class="fe mc md me mf b"><em class="nm">src/assets/</em></code><em class="nm">目录中的</em> <code class="fe mc md me mf b"><em class="nm">create-vue@latest</em></code> <em class="nm">创建的组件和CSS文件在本指南的上下文中是不需要的，可以删除。</em></p><h1 id="3166" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">基本形式</h1><p id="bb62" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出于演示目的，我们用以下内容替换<code class="fe mc md me mf b">App.vue</code>组件的内容:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nn no l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">App.vue</figcaption></figure><p id="4139" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated"><code class="fe mc md me mf b">&lt;template&gt;</code>包含一个带有两个输入字段的表单，两个错误消息字段和一个提交表单的按钮组件。我们使用VeeValidate的<code class="fe mc md me mf b">&lt;Field /&gt;</code>组件，而不是为输入字段<code class="fe mc md me mf b">firstName</code>和<code class="fe mc md me mf b">lastName</code>使用HTML5 <code class="fe mc md me mf b">&lt;input&gt;</code>元素。两者都将被呈现为由<code class="fe mc md me mf b">type </code>属性指定的文本输入字段。</p><p id="331f" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">VeeValidate使用用<code class="fe mc md me mf b">:rules</code>属性定义的规则来验证输入。在上面的例子中，我们只检查字段是否包含任何值(第9行到第11行)。如果没有，我们返回一个错误消息。然后错误信息显示在相应的<code class="fe mc md me mf b">&lt;ErrorMessage /&gt;</code>组件中。为了正确工作，<code class="fe mc md me mf b">&lt;Field /&gt;</code>和相应的<code class="fe mc md me mf b">&lt;ErrorMessage /&gt;</code>组件的<code class="fe mc md me mf b">name</code>属性值必须相同。</p><p id="3d8b" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">我们没有使用HTML5 <code class="fe mc md me mf b">&lt;button&gt;</code>元素来提交表单，而是使用了一个<code class="fe mc md me mf b">&lt;CustomButton /&gt;</code>组件，这个组件将在下一步中创建和解释。</p><p id="1a1e" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">表单的元素用VeeValidate <code class="fe mc md me mf b">&lt;Form /&gt;</code>组件包装，而不是标准的HTML5 <code class="fe mc md me mf b">&lt;form&gt;</code>元素。提交时，VeeValidate根据定义的规则验证表单的输入字段，然后调用开始标记(第15行)中定义的<code class="fe mc md me mf b">onSubmit()</code>函数处理函数(第5到7行)。处理函数只是在控制台中记录表单值。</p><h1 id="07f0" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">提交按钮</h1><p id="fabe" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在<code class="fe mc md me mf b">src/components/</code>中创建一个新文件<code class="fe mc md me mf b">CustomButton.vue</code>，内容如下:</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nn no l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><CustomButton/>组件</figcaption></figure><p id="541a" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">模板包含一个<code class="fe mc md me mf b">&lt;button&gt;</code>元素，其<code class="fe mc md me mf b">:disabled</code>属性通过计算属性<code class="fe mc md me mf b">isDisabled</code>绑定到VeeValidate中的<code class="fe mc md me mf b">useIsFormValid()</code>和<code class="fe mc md me mf b">useIsformDirty()</code>辅助函数(第8到9行)。两个助手函数都从表单的<code class="fe mc md me mf b">meta</code>状态返回计算的refs到<code class="fe mc md me mf b">valid</code>和<code class="fe mc md me mf b">dirty</code>属性的值，这可以分别用<code class="fe mc md me mf b">valid.value</code>和<code class="fe mc md me mf b">dirty.value</code>检索。当表单被成功验证时，<code class="fe mc md me mf b">valid</code>变为<code class="fe mc md me mf b">true</code>，否则变为<code class="fe mc md me mf b">false</code>。<code class="fe mc md me mf b">dirty</code>如果至少一个字段的值已被更改，则变为真。因此，只有当<code class="fe mc md me mf b">isDirty</code>和<code class="fe mc md me mf b">isValid</code>的值都为<code class="fe mc md me mf b">true</code>时，<code class="fe mc md me mf b">isDisabled</code>才会返回<code class="fe mc md me mf b">false</code>。此时，表单被完全填充和验证，并且可以启用提交按钮。</p><p id="23b4" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">使用<code class="fe mc md me mf b">valid</code>和<code class="fe mc md me mf b">dirty</code>属性而不仅仅是<code class="fe mc md me mf b">valid</code>的原因是在表单还没有被验证的情况下<code class="fe mc md me mf b">valid</code>可能是<code class="fe mc md me mf b">true</code>。</p><p id="0a5c" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">来自<code class="fe mc md me mf b">useIsFormValid()</code>上的<a class="ae kf" href="https://vee-validate.logaretm.com/v4/api/composition-helpers#api-reference" rel="noopener ugc nofollow" target="_blank">文档</a>:</p><blockquote class="np nq nr"><p id="0e49" class="le lf nm lg b lh mg lj lk ll mh ln lo ns mi lr ls nt mj lv lw nu mk lz ma mb im bi translated">基于<code class="fe mc md me mf b">valid</code>属性创建被禁用的按钮是不准确的，因为如果表单还没有被验证，那么<code class="fe mc md me mf b">valid</code>属性将是<code class="fe mc md me mf b">true</code>，这是不准确的。您应该将<code class="fe mc md me mf b">valid</code>检查与<code class="fe mc md me mf b">dirty</code>状态结合起来，以获得最大的准确性。</p></blockquote><p id="f4b2" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">需要指出的另一件事是<code class="fe mc md me mf b">useIsFormValid()</code>和<code class="fe mc md me mf b">useIsFormDirty()</code>助手函数可用于<code class="fe mc md me mf b">&lt;Form /&gt;</code>组件的子组件。这就是为什么提交按钮没有在<code class="fe mc md me mf b">App.vue</code>中实现，而是在一个单独的组件中实现，而这个单独的组件又被用作<code class="fe mc md me mf b">&lt;Form /&gt;</code>组件的子组件。</p><p id="9850" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">来自<a class="ae kf" href="https://vee-validate.logaretm.com/v4/api/composition-helpers" rel="noopener ugc nofollow" target="_blank">文档</a>:</p><blockquote class="np nq nr"><p id="f1ff" class="le lf nm lg b lh mg lj lk ll mh ln lo ns mi lr ls nt mj lv lw nu mk lz ma mb im bi translated">这些函数向子组件公开验证状态，大多数函数公开每个状态的两个变量。在表单级别和字段级别。</p></blockquote><h1 id="ce55" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结果</h1><p id="01ac" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用重新生成项目</p><pre class="mz na nb nc gt nd mf ne bn nf ng bi"><span id="3ae6" class="nh kh it mf b be ni nj l nk nl">npm run dev</span></pre><p id="d5e6" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">并浏览至<code class="fe mc md me mf b"><a class="ae kf" href="http://127.0.0.1:5173." rel="noopener ugc nofollow" target="_blank">http://localhost1:5173</a></code> <a class="ae kf" href="http://127.0.0.1:5173." rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/584816f445ae84d2073f64a8b1e93856.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*P484tP8HRyW0DMuiCvdLdQ.gif"/></div></div></figure><p id="8e8f" class="pw-post-body-paragraph le lf it lg b lh mg lj lk ll mh ln lo lp mi lr ls lt mj lv lw lx mk lz ma mb im bi translated">如您所见，只要两个输入字段都无效，submit按钮就会被禁用。</p><h1 id="e630" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">摘要</h1><p id="b313" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用VeeValidate 4进行表单验证时，可以通过不同方式禁用无效表单的提交按钮。在本指南中，我们使用了VeeValidate <code class="fe mc md me mf b">useIsFormDirty()</code>和<code class="fe mc md me mf b">useIsFormValid()</code>助手函数来启用/禁用提交按钮。由于助手函数将验证状态暴露给<code class="fe mc md me mf b">&lt;Form /&gt;</code>子组件，提交按钮被实现为一个单独的组件，该组件又被用作<code class="fe mc md me mf b">&lt;Form /&gt;</code>的子组件。</p><h1 id="af00" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">源代码</h1><p id="f887" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><a class="ae kf" href="https://gist.github.com/robinkloeckner/8538a3528039fc08955b22fc8c6e3ed4?file=CustomButton.vue" rel="noopener ugc nofollow" target="_blank">要旨</a></p></div></div>    
</body>
</html>