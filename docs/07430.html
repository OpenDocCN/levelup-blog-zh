<html>
<head>
<title>How to Create a Jest Snapshot Test in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中创建Jest快照测试</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-create-a-jest-snapshot-test-in-react-6fd2f755a568?source=collection_archive---------2-----------------------#2021-02-17">https://levelup.gitconnected.com/how-to-create-a-jest-snapshot-test-in-react-6fd2f755a568?source=collection_archive---------2-----------------------#2021-02-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="004c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">测试对于维护任何应用程序都是至关重要的！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cd311c54ef41f59c9b43c6af7adaf15d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A6jjh8_QPbuM3I0SB3ZyNg.png"/></div></div></figure><p id="04a0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">亲爱的读者们，你们好，</p><p id="14fc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我带回了一篇关于测试ヾ(⌐■_■)ノ♪的热门文章</p><p id="bd7c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在构建应用程序时，测试是一个至关重要的支柱。知道如何编码是重要的，知道如何有效地测试你编码的东西是至关重要的。你想知道为什么吗？如今，计算机科学几乎应用于各个领域。构建一个应用程序需要许多团队和协作，许多阶段(开发阶段，集成，生产…等等。)很多资源。因此很多钱。今天，如果你正在寻找一个开发者的帖子，你会注意到他们也会问你关于你的测试工具和技能的问题。</p><p id="a11a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">测试是确保我们不会破坏我们迄今为止所构建的东西的唯一方法，同时也是确保整个应用程序足够强大以向世界或其真实用户传播的唯一方法。</p><p id="f3b1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">废话说够了，让我们按照这个计划开始吧:</p><ul class=""><li id="c2b4" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">什么是玩笑？</li><li id="fdee" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><strong class="kw iu">笑话测试示例</strong></li><li id="df88" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><strong class="kw iu">如何写一个Jest快照测试？</strong></li><li id="759f" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><strong class="kw iu">外卖</strong></li></ul></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="2551" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">什么是玩笑？</h1><p id="26b0" class="pw-post-body-paragraph ku kv it kw b kx nd ju kz la ne jx lc ld nf lf lg lh ng lj lk ll nh ln lo lp im bi translated">你可能已经听说过Jest，它在市场上占据越来越多的位置。Jest最初由脸书制造，用于测试React组件。该工具基本上是一个测试运行器，它的+在于它比Karma高效得多。现在，甚至一些有角度的应用程序也变成了笑话。</p><h2 id="37ec" class="ni mm it bd mn nj nk dn mr nl nm dp mv ld nn no mx lh np nq mz ll nr ns nb nt bi translated">想知道因果报应和笑话◉_◉之间的区别？</h2><p id="7ed8" class="pw-post-body-paragraph ku kv it kw b kx nd ju kz la ne jx lc ld nf lf lg lh ng lj lk ll nh ln lo lp im bi translated">我两个都用过。我喜欢Karma，因为它与浏览器相连，我们可以运行特定的测试，并在浏览器上看到可读和可见的结果。这也是它的限制，因为它必须使用浏览器实例。而Jest是独立的，它不需要浏览器。因此，如果你习惯了因果报应，你会失望的。您必须在命令行上读取结果。这还不是全部。Jest可以通过指定在启动测试运行器时要使用多少线程来并行运行测试。这就是Jest如此受欢迎的原因，因为我们看到了它在时间上的真正差异。当然，没有完美的解决方案。使用Jest，您不能马上直接运行特定的测试。由于Jest不知道如何做，它将跳过所有其他测试，直到到达您想要运行的特定测试。当在开发阶段调试一个测试时，这是非常令人厌烦和耗时的。</p><p id="f631" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，Karama运行测试的方式对于开发人员来说在编写应用程序时是高效的，但它需要更多的时间，这并不好，尤其是当您有一个企业或大型应用程序时。在这种情况下，Jest会更有效。</p><h1 id="c0c3" class="ml mm it bd mn mo nu mq mr ms nv mu mv jz nw ka mx kc nx kd mz kf ny kg nb nc bi translated">Jest测试示例</h1><p id="08b4" class="pw-post-body-paragraph ku kv it kw b kx nd ju kz la ne jx lc ld nf lf lg lh ng lj lk ll nh ln lo lp im bi translated">如果你已经知道Jest并使用过它，你可以跳过这一节直接看‿。如果这是你第一次发现Jest，那么，对你来说好消息是，它几乎以同样的方式用<code class="fe nz oa ob oc b">describe</code>和<code class="fe nz oa ob oc b">it</code>编写测试。区别取决于我们如何运行测试和调试它们。顺便说一下，这里有一个例子，也可以应用于角度应用。</p><p id="7d70" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是一个显示文章列表的简单文章组件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="3b6f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">物品测试:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="f494" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以在<code class="fe nz oa ob oc b">it</code>部分测试我们想要的任何东西。现在，让我们转到快照测试。</p><h1 id="5dab" class="ml mm it bd mn mo nu mq mr ms nv mu mv jz nw ka mx kc nx kd mz kf ny kg nb nc bi translated">如何写一个Jest快照测试？</h1><p id="3f9b" class="pw-post-body-paragraph ku kv it kw b kx nd ju kz la ne jx lc ld nf lf lg lh ng lj lk ll nh ln lo lp im bi translated">在回答<em class="of">如何</em>之前，我们需要先了解一下<em class="of">什么</em>，对吗？</p><p id="715c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="of">那么，什么是Jest快照测试呢？</em>T15】</strong></p><p id="3441" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">快照基本上是给定时间的组件树。当您更新组件树时，您也更新了快照，以便您的测试通过。</p><p id="c70f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="of">需要一个例子，Nah？</em>T19】</strong></p><p id="c4bb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是一个简单的<em class="of"> Hello World </em>的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="bdf7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> #1:我们需要安装一个快照反应库:</strong></p><p id="cd6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为此，我使用了<code class="fe nz oa ob oc b">react-test-renderer</code>库。你所需要的就是安装NPM或纱线。</p><pre class="kj kk kl km gt og oc oh oi aw oj bi"><span id="0200" class="ni mm it oc b gy ok ol l om on">yarn add --dev <strong class="oc iu">react-test-renderer<br/>// Or<br/></strong>npm add --dev <strong class="oc iu">react-test-renderer</strong></span></pre><p id="bd38" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> #2:导入库依赖项，以便我们可以创建快照:</strong></p><pre class="kj kk kl km gt og oc oh oi aw oj bi"><span id="c1c9" class="ni mm it oc b gy ok ol l om on">import <strong class="oc iu">renderer</strong> from <strong class="oc iu">'react-test-renderer';</strong></span></pre><p id="af15" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> #3:创建快照</strong></p><pre class="kj kk kl km gt og oc oh oi aw oj bi"><span id="a977" class="ni mm it oc b gy ok ol l om on"><strong class="oc iu">renderer</strong>.create(&lt;div&gt;Hello world&lt;/div&gt;);</span></pre><p id="23d7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们保存这一行代码，我们将会看到很多关于元素树的不必要的信息。这就是为什么我们将使用<code class="fe nz oa ob oc b">toJSON()</code>功能，以便我们只看到重要的信息。下面是我们上面例子的结果:</p><pre class="kj kk kl km gt og oc oh oi aw oj bi"><span id="98e3" class="ni mm it oc b gy ok ol l om on">const <strong class="oc iu">element</strong>= renderer.<strong class="oc iu">create</strong>(&lt;div&gt;Hello world&lt;/div&gt;).<strong class="oc iu">toJSON</strong>();<br/>console.log(<strong class="oc iu">element</strong>);</span><span id="3943" class="ni mm it oc b gy oo ol l om on">// ==&gt; printed result<br/>{type: '<strong class="oc iu">div</strong>', props:{}, children:['<strong class="oc iu">Hello world</strong>']}</span></pre><p id="a69c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> #4:检查快照</strong></p><pre class="kj kk kl km gt og oc oh oi aw oj bi"><span id="d663" class="ni mm it oc b gy ok ol l om on">expect(element).<strong class="oc iu">toMatchSnapshot</strong>();</span></pre><p id="9163" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们为文章测试创建一个快照:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="e090" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们打印出<code class="fe nz oa ob oc b">articlesTree</code>将会看到下面的结果:</p><pre class="kj kk kl km gt og oc oh oi aw oj bi"><span id="7284" class="ni mm it oc b gy ok ol l om on">{ <br/>  type: 'div',<br/>  props: {},<br/>  children: [<br/>     {type: 'div', props: [Object], children: [Object]},<br/>     {type: 'div', props: [Object], children: [Object]},<br/>     {type: 'div', props: [Object], children: [Object]},  ]  <br/>}</span></pre><p id="74e4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们还会注意到一个名为<code class="fe nz oa ob oc b">ArticlesTest.js.snap</code>的新生成文件。这个文件包含了我们组件的所有信息，甚至是样式细节。一切！这就像我们组件的DNA，任何变化都会导致测试失败。</p><p id="0151" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们改变或重构我们的组件会发生什么？每当我们对需要更新快照的组件进行所需的更改时，测试都会失败。超级实用的是Jest会给出两个版本的差异，这也是我们测试失败的原因。Jest也会问你这是不是想要的；因此，我们需要更新快照:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/58c2205f8959d49b300da957eff90fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*clvLaQgWFE7T4qPisBxsJw.png"/></div></figure><p id="e890" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过点击<code class="fe nz oa ob oc b">u</code>，我们更新了快照，测试将再次通过。</p><p id="51c8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就这样？不要。</p><p id="5afb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以检查快照是否与组件树匹配，但是您也可以测试其他东西，因为在我们的例子中，我们传递了一个文章列表。我们可以检查渲染的文章是否与我们的道具中传递的文章数量相匹配。</p><p id="443d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以下是方法:</p><pre class="kj kk kl km gt og oc oh oi aw oj bi"><span id="5bf5" class="ni mm it oc b gy ok ol l om on"><strong class="oc iu">expect</strong>(articlesTree.children.length).toBe(3)</span></pre><p id="4b78" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为我们的testProps对象中有3篇文章。</p><p id="2857" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">诸如此类！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="621d" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">外卖</h1><ul class=""><li id="8efe" class="lq lr it kw b kx nd la ne ld oq lh or ll os lp lv lw lx ly bi translated">快照就像一个组件的树形表示。它反映了它的结构和风格。</li><li id="7ef5" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nz oa ob oc b">toJson()</code>功能很实用，可以看到关于你的组件树的重要东西。</li><li id="3b51" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">您可以使用snapshot json对象作为工具来测试其他东西。</li><li id="d907" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">每当组件表示或样式改变时，您需要在运行相应的测试后点击<code class="fe nz oa ob oc b">u</code>来更新快照。</li></ul></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="a140" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你喜欢这篇文章，请让我为更多的文章鼓掌或评论。</p><p id="caf0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">无论你在哪里，我都希望你和你的家人平安！ </p><p id="7b35" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="of">坚持住。明天会更好！</em>T9】</strong></p><p id="3511" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> FAM </strong></p><p id="7006" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">关注我上</strong> <a class="ae ot" href="https://medium.com/@famzil/" rel="noopener"> <strong class="kw iu">中</strong> </a> <strong class="kw iu">，</strong> <a class="ae ot" href="https://www.linkedin.com/in/fatima-amzil-9031ba95/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">领英</strong> </a> <strong class="kw iu">，</strong> <a class="ae ot" href="https://www.facebook.com/The-Front-End-World" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">脸书</strong> </a> <strong class="kw iu">，以及</strong> <a class="ae ot" href="https://twitter.com/FatimaAMZIL9" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">推特</strong> </a> <strong class="kw iu">查看更多文章。</strong></p></div></div>    
</body>
</html>