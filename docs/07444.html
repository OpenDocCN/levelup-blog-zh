<html>
<head>
<title>Refactoring: Looking past the surface</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重构:透过表面看</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/refactoring-looking-past-the-surface-6383a91d0ba?source=collection_archive---------12-----------------------#2021-02-18">https://levelup.gitconnected.com/refactoring-looking-past-the-surface-6383a91d0ba?source=collection_archive---------12-----------------------#2021-02-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c34b1dc8f4043f22e777bb635320d35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JejBbpgjRr-lSLmc"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kc" href="https://unsplash.com/@wonderlane?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Wonderlane </a>拍摄的照片</figcaption></figure><h1 id="37db" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">常见的误解</h1><p id="5083" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我对重构有一个很大的误解，那就是只有当你的代码不好的时候，你才会去重构。如果你不得不重构，这意味着你第一次写代码的时候就搞砸了，现在你不得不修复你的错误。</p><p id="affc" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">因此，当我不得不告诉我的经理我必须花一些时间重构时，这就像是我承认自己不够好，第一次写“好代码”时，所以现在我必须修复我的错误。我没有把时间花在给项目添加新功能上，而是“<em class="me">浪费”</em>在修复我的错误上。</p><p id="f445" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这让我害怕重构。</p><p id="62e1" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">尽管在这种情况下使用了重构，但是重构的原因远不止于此。其中大多数都是积极的原因，为您的代码增加了真正的价值。重构不仅仅是糟糕的代码或技术债务。</p><p id="4daa" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">当你写代码的时候，你应该一直重构。你应该学会热爱它，并且擅长它。这会让你的生活轻松很多。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="2c7d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">重构一段代码有很多原因。以下是其中的一些:</p><h1 id="684b" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">简单的改变</h1><p id="9347" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我读过的关于重构的最好的名言是:</p><blockquote class="mm mn mo"><p id="1b67" class="lb lc me ld b le lz lg lh li ma lk ll mp mb lo lp mq mc ls lt mr md lw lx ly ij bi translated">“让改变变得容易，然后让改变变得容易”</p><p id="a4fd" class="lb lc me ld b le lz lg lh li ma lk ll mp mb lo lp mq mc ls lt mr md lw lx ly ij bi translated">—肯特·贝克</p></blockquote><p id="11fa" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这是一个简单而有力的声明，在许多层面上都有效。就重构而言，它是这样工作的:由于新的需求，你经常需要扩展或改变一段代码。有时候，这种改变看起来并不容易。</p><p id="a40f" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">因此，在您开始编写新的需求之前，您需要后退一步，考虑一下您现有的代码。你如何改变它(<em class="me">使改变变得容易</em>)，以使实现新的需求变得非常简单(<em class="me">‘使改变变得容易’</em>)。</p><p id="bde5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这就是重构最强大的地方。使用重构技术，您可以更改现有代码，同时确保行为保持不变。当你确定没有更多的重构要做时(你使改变变得容易)，你就可以继续<em class="me">‘使改变变得容易’</em>并实现你的新需求。</p><p id="d4a0" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在这种情况下，您重构了现有的代码并改变了它的设计，但不是因为它是一个糟糕的设计，而是因为它不再是该代码需求的正确设计。通过重构，你改进了它，增加了它的价值。</p><h1 id="f6f3" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">现有功能的需求变更</h1><p id="f911" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">当需求改变时，代码设计也必须改变，以便能够反映这些变化。</p><p id="2423" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">功能的每次改变都是重新评估当前设计的机会，看看是否有可以改进的地方。</p><p id="b8fb" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">因此，在您根据新的需求进行了功能更改之后，是时候进行重构了。也许现在应该将一个方法提取到一个新的类中。或者这里使用的设计模式，看起来不再是正确的解决方案。</p><p id="4e95" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">但是在为当前需求设计解决方案时，不要担心预测未来的需求变化。你不需要。确保您当前的设计最适合当前的需求。你从重构技巧中获得的自信应该让你不再害怕任何未来的需求变化。如果发生了，你知道该怎么做。</p><h1 id="3bea" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">功能第一，重构第二</h1><p id="2611" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="me"> ' </em> <strong class="ld ir"> <em class="me">什么</em> </strong> <em class="me"> ' </em>代码做的事情和<em class="me"> ' </em> <strong class="ld ir"> <em class="me">代码怎么做</em> </strong> <em class="me"> ' </em>代码做的事情常常可以被看作是两个不同的问题，可以分别处理。<em class="me"> ' </em> <strong class="ld ir"> <em class="me">什么</em> </strong> <em class="me"> ' </em>为代码的功能，而<em class="me"> ' </em> <strong class="ld ir"> <em class="me">如何</em> </strong> <em class="me"> ' </em>为代码的设计。</p><p id="55e6" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">首先将所有精力集中在获得正确的功能上通常非常有帮助。一开始你并不关心设计，因为你相信你的重构技巧会帮助你得到最好的设计。当“你的代码<em class="me">做什么”</em>(功能性)已经处理好的时候，你就可以自由地思考<em class="me">如何</em>(设计)<em class="me">。</em></p><h1 id="4bae" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">前期设计</h1><p id="d4d8" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">重构减轻了第一次就必须把一切都做好的焦虑。您不必担心，也不必花太多时间试图马上为您的解决方案找到完美的设计。</p><p id="d617" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">你可以暂时把它做得足够好，用它工作一会儿，这样你就可以对它有一个好的感觉，然后回来重构它。</p><p id="cb26" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">如果有反馈，每个解决方案都可以变得更好。对你来说，这种情况下的反馈是你自己处理代码的经验。每次你不得不使用它的时候，你重构并使它变得更好一点。</p><p id="8087" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这并不意味着你第一次就失败了。你现在有更多的信息来使它变得更好。</p><h1 id="83d5" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">可读性</h1><p id="c023" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">你正在处理别人的代码，你注意到如果你对它进行一些重构，它的一部分可以变得更容易理解。如果你重命名一个方法，或者你提取一段代码到一个新的方法中，这将使它对将来从事这个工作的人来说更具可读性和可理解性。因此，您重构它以提高其可读性，从而增加其整体价值。你应该永远试着让它比你发现它时更好。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="826c" class="kd ke iq bd kf kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la bi translated">结论</h1><p id="6505" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">重构不仅仅是关于糟糕的代码——它远不止于此。重构也有许多积极的理由。如果你想成为一名更好的开发人员，认识重构的原因和重构技术是你应该掌握和每天做的事情。</p><p id="d142" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">一本帮助你提高重构技巧的有用的书是马丁·福勒的《重构》。</p></div></div>    
</body>
</html>