<html>
<head>
<title>Is 100% Test Code Coverage our True Aim as Engineers?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">100%的测试代码覆盖率是我们作为工程师的真正目标吗？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/is-100-test-code-coverage-our-true-aim-as-engineers-d1e7ca580293?source=collection_archive---------12-----------------------#2022-01-27">https://levelup.gitconnected.com/is-100-test-code-coverage-our-true-aim-as-engineers-d1e7ca580293?source=collection_archive---------12-----------------------#2022-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8f90" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单元测试代码覆盖率:软件行业中每个人都在追求的黄金百分比。但是为什么它如此重要呢？</p><p id="9895" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有些人认为覆盖率越高，越接近<strong class="jp ir"> 100% </strong>，代码就越无bug、可维护、灵活重构。</p><p id="8823" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，这是所有代码都不容易出错的基本标准吗？像生活中的大多数答案一样，这是一个很难的<em class="kl">也许是</em>。</p><p id="6d1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们需要理解什么是单元测试覆盖率:<em class="kl">一种度量，它告诉我们单元测试运行的代码行数除以应用程序中的代码总数</em>。</p><p id="bd9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我们有这个方法(顺便说一下，它不是一个<a class="ae km" rel="noopener ugc nofollow" target="_blank" href="/pure-functions-in-software-development-d315a4520da1">纯函数</a>):</p><pre class="kn ko kp kq gt kr ks kt ku aw kv bi"><span id="e352" class="kw kx iq ks b gy ky kz l la lb">1 int retrieveCurrentYear() {<br/>2   final nowDate = DateTime.now();<br/>3   return nowDate.year;<br/>4 }</span></pre><p id="ae57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像这样对它运行单元测试:</p><pre class="kn ko kp kq gt kr ks kt ku aw kv bi"><span id="980c" class="kw kx iq ks b gy ky kz l la lb">expect(retrieveCurrentYear(), 2022); // 2022 is the time of writing this article</span></pre><p id="aa78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将导致<strong class="jp ir"> 100%的代码覆盖率</strong>，因为所有四行代码都在运行单元测试时被执行。</p><figure class="kn ko kp kq gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi lc"><img src="../Images/c09eee904f90ddb807c6066324ba1b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9yUkza4pWHJkBUi4"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">布鲁斯·马尔斯在<a class="ae km" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="3985" class="lo kx iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">我们成功了！我们在世界之巅…不到一年👏</h1><p id="027b" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">假设我们明年(2023年)运行这个单元测试，<strong class="jp ir">它会失败</strong>，即使我们的代码覆盖率是100%😥</p><h1 id="ea52" class="lo kx iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">那么我的观点是什么？</h1><p id="d9a8" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">代码覆盖率是必不可少的，它应该相对尽可能高，但追求尽可能高的百分比和尽可能少的测试来“通过”那些代码行不应该是我们的目标(就像不恰当地使用测试的金字塔，不是严重依赖单元测试，而是依赖快照测试、集成测试或其他方法)。</p><p id="3829" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">相反，我们应该看到什么对我们的团队和我们有意义；也许70%-80%就足够给我们前进的信心了。</p><p id="7929" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于其他团队，更低或更高的值可能更有意义。最重要的部分是要达到100%的确定性，一旦一行代码被覆盖，我们在将来不会有任何意外/副作用:<strong class="jp ir">质量对数量</strong>(如何进行单元测试的完整例子可以在这个故事中找到<a class="ae km" href="https://medium.com/@catalin.patrascu/what-is-unit-testing-and-why-we-should-use-it-2cf8ed65eca7" rel="noopener">)。</a></p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="62ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢你花时间阅读以上所有内容，我希望这个故事能帮助你提高一点点水平。此外，请不要犹豫将知识传播给其他开发人员。</p><div class="mx my gp gr mz na"><a href="https://medium.com/@catalin.patrascu/membership" rel="noopener follow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd ir gy z fp nf fr fs ng fu fw ip bi translated">用我的推荐链接加入媒体- Catalin Patrascu</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">阅读Catalin Patrascu的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">medium.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no li na"/></div></div></a></div></div></div>    
</body>
</html>