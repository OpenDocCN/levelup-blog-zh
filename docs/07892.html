<html>
<head>
<title>Customise your classes with decorators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用装饰者定制你的类</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/customise-your-classes-with-decorators-11de52225505?source=collection_archive---------10-----------------------#2021-03-18">https://levelup.gitconnected.com/customise-your-classes-with-decorators-11de52225505?source=collection_archive---------10-----------------------#2021-03-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b19b88b5b9f0e6e885c7ee829fcc27c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zmd0RSHU7MxLepJABKnn9w.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由来自<a class="ae kf" href="https://www.pexels.com/photo/computer-with-code-4218883/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kf" href="https://www.pexels.com/@paras?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Paras Katwal </a>拍摄</figcaption></figure><p id="b6e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我喜欢装修工。即使这个特性仍然没有得到官方支持，它们已经非常有用了！如果你不知道什么是装修工，我强烈建议你先准备好我的文章！</p><p id="f19b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/understanding-decorators-in-javascript-912a05d7a537">https://level up . git connected . com/understanding-decorators-in-JavaScript-912 a05d 7a 537</a></p><p id="43bc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">decorators的用途之一就是给你的类注入方法和属性！这基本上意味着给定一个类，您可以使用生成器在实例化或运行时操作该类中的方法和属性(取决于您是将装饰器放在方法/属性上还是放在类的顶部)</p><h1 id="7141" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">为什么我要这样做，而不是从一个类扩展？</h1><p id="d0cb" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">好问题！有时候，从一个类中扩展出更多的方法可能会矫枉过正。我们可能想走另一条路，但也要保持最大的通用性。这就是装修工有用的地方！根据定义，装饰器是一个函数。所以你可能不想把它弄得太大或者过多的操作这个类，否则，继承会更好。</p><h1 id="861a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">让我们准备实验吧！</h1><blockquote class="mh mi mj"><p id="17ba" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">在这里，我们要准备好所有的文件来和装饰者一起玩。</p></blockquote><p id="81cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在开始之前，您可以访问<a class="ae kf" href="https://github.com/psyycker/decorators-class-custom" rel="noopener ugc nofollow" target="_blank">本报告</a>中文章的每一步，检查分支以到达您想要去的地方</p><p id="7280" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们首先要设置我们的项目。此外，由于装饰器在Typescript和Javascript之间是不同的(就像在Babel parsed code中一样)，我们在这里将使用Javascript。</p><p id="31e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用一个空文件夹和命令<code class="fe mo mp mq mr b">npm init -y</code>创建一个新项目</p><p id="8874" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在package.json中，确保devDependencies如下所示:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ms"><img src="../Images/f71d3fa57924d940848eb39528d400bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54jSKZV_AjyOwFyqPA4ofA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">package.json</figcaption></figure><p id="12c2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行<code class="fe mo mp mq mr b">npm install</code>来安装所有这些依赖项。</p><p id="6356" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，您可以将此命令添加到脚本部分的package.json中，以运行您的应用程序:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mx"><img src="../Images/702d74afa8c9e79a9b25e76cda0a6173.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_ORHPllR_LvUkPIGMhkag.png"/></div></div></figure><p id="20d2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着您的主js文件位于src下</p><p id="3462" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们必须设置我们的。babelrc允许babel解析我们的自定义代码。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/cee97fa9c3f8d486c5cfb47cd4f20174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CbXP1QxoRMaEpd-RkKfYlw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">。巴伯尔克</figcaption></figure><p id="28ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该文件中的两个澄清。首先，关于插件提议装饰者。我们必须给它传递一个参数，否则，Babel不会接受编译。我选择不把它放在出口之前，但那是个人的选择。我们还包含了@ babel/plugin-proposal-class-properties，允许我们在类中放置属性而不使用构造函数。</p><p id="7a38" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，为了完成所有准备工作，在src文件夹中创建一个index.js文件，其内容如下:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/43800b74a1117b8c45314a3c706e950e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1G_2aZSs_LfZTpLtoAKjGg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">我们工作的良好开端！</figcaption></figure><h1 id="20f7" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">装饰师如何与我们的班级互动</h1><blockquote class="mh mi mj"><p id="5a31" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">让我们理解装饰者如何与我们的类交互</p></blockquote><p id="8eea" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如我所说，装饰器是一个函数。所以让我们创建我们的函数。我们称它为<code class="fe mo mp mq mr b">injectHelloWorld</code>，目前，我们将打印第一个(也是唯一的)参数</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/38e77e62afa8a03c3ffc2a3971b2065a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-5eUXu6_2rguTrRryCQqQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">你的室内设计师</figcaption></figure><p id="9052" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要忘记在你的类中使用你的装饰器，并且使用它！</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/6104fe995542529b7dd40b78656ff90b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Ngk1iC9phanFGbY_McC_w.png"/></div></div></figure><p id="b009" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<code class="fe mo mp mq mr b">npm run dev</code>运行您的应用程序，并查看您的控制台。您应该会看到以下输出:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/f67f06dd0732d4c0394790ae2daad37a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-KOK2HW4jeVrpArMqOrzA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在装饰器中打印类时的控制台输出</figcaption></figure><p id="f444" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们有两个输入。最后一个是酒吧(没有什么大的事情发生)，但第一个是我们的装饰工作！</p><p id="dcda" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们仔细看看，我们有种类(在我关于装饰者的文章中解释得更多)和元素，它们是类的不同元素。有一种新的我从来没有谈到过的是<code class="fe mo mp mq mr b">field</code>，这是只有当你启用了巴别塔插件“@巴别塔/插件-建议-类-属性”。这意味着元素是一个类属性。</p><p id="13fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，如果我们决定调整这个属性呢？没有值栏，我们决定给它赋值<code class="fe mo mp mq mr b">toto</code>？</p><p id="fe8c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们需要覆盖初始值。初始化器是赋予属性初始值的函数。如果我们现在想把它打印成一个toString，我们将得到这样的输出:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7c7ef2880be6cec56ef3cda437ad626e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*n2_MDmHwOdOk7Ara1CvhZg.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">初始值设定项的toString()值</figcaption></figure><p id="e511" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以如果我们想返回<code class="fe mo mp mq mr b">toto</code>(这里作为一个例子)我们必须把初始化函数改成这样:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/771b9d7fee6d18824c0f567f50e081cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*SIWXueCd3lRwhOvSzr-lcg.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">初始化函数应该是怎样的</figcaption></figure><p id="b6d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，这样做的方法基本上是改变元素0的初始化项。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/21ec19f0eaf2392dafe90ae039ded80c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4bnoCfaA71Q1H04nkXaog.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">更改该值以返回“toto”</figcaption></figure><p id="5c6b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您现在检查您的日志，您将会看到<code class="fe mo mp mq mr b">bar</code>消失了，现在显示的是<code class="fe mo mp mq mr b">toto</code>！</p><h1 id="e419" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">具体例子</h1><blockquote class="mh mi mj"><p id="9eed" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">这在现实生活中怎么用</p></blockquote><p id="b102" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们树立一个榜样。您是一个使用微服务的节点应用程序，您有一个特定的类来对其他服务进行API调用。让我们称这个类为<code class="fe mo mp mq mr b">APIClient</code>，你希望这个客户端在你的每个类中自动初始化。</p><p id="dd43" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们创建APIClient类，并在其上添加一个简单的方法。无需创建新文件！</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/f71d09431b66abfd873af9a6e16bd9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ty8MwOMjwafy-OsVUO19Xg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">我们的新APIClient类</figcaption></figure><p id="52c0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，我们不能创建一个更简单的类。这里的目标是看看如何集成它。没必要让一切变得更复杂。</p><p id="029e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了使我们的生活更容易，我们还将创建一个函数，在我们的元素列表中注入一个字段。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/1580e3606feaa43ea6a1e5f5ea18219a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AxGawReKZwYNBWj7vRdq5Q.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">我们的助手功能</figcaption></figure><p id="0222" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果没有这些数据，您的应用程序很可能会崩溃。我们必须创建这个对象，然后添加我们的键和值。</p><p id="71c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，让我们创建我们的新装饰。我们称之为<code class="fe mo mp mq mr b">useAPIClient</code> (React开发者会喜欢这个语法的！)</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/ae0706bcaf6219b32cb57a930acdd0be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfmxBtfqloOlWphBGsVYhw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">我们的新装潢师</figcaption></figure><p id="fe85" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我们的新装潢师。它的目标是添加一个名为apiClient的新字段，其值是APIClient类的实例。</p><p id="f3a3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">别忘了把装饰器应用到你的课堂上！</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9743204abf5ea62feadea077538b7ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*8kX4gKGmCCgSSHr4-lTkhA.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">useAPIClient应用于我们的类</figcaption></figure><p id="e248" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">向我们的类添加一个名为<code class="fe mo mp mq mr b">printUsers</code>的新方法，该方法将使用APIClient来获取用户并打印他们。</p><p id="6879" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从类中删除不需要的代码后，它应该如下所示:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/65bf96cf33092d750613a189f6e222cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19aPPE8J7Fg7zp0kVqJJYw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">我们与printUsers的新类</figcaption></figure><p id="13d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你现在可以执行你的程序了，不要忘记调用<code class="fe mo mp mq mr b">printUsers</code>而不是<code class="fe mo mp mq mr b">printFoo</code>，你的输出应该是用户列表！</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="f5a6" class="le lf it bd lg lh nr lj lk ll ns ln lo lp nt lr ls lt nu lv lw lx nv lz ma mb bi translated">结论</h1><p id="936f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在本文中，我们可以看到装饰者的多种可能用法之一。还有很多！此外，我决定在这个例子中使用OOP。但是函数式编程的用法也是多种多样的！</p><p id="1826" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你喜欢这篇文章！感谢您的阅读:)</p><p id="47bc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">雷米</p></div></div>    
</body>
</html>