<html>
<head>
<title>How to Slice a DataFrame in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何分割熊猫的数据帧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-slice-a-dataframe-in-pandas-884bd8b298a6?source=collection_archive---------0-----------------------#2020-12-22">https://levelup.gitconnected.com/how-to-slice-a-dataframe-in-pandas-884bd8b298a6?source=collection_archive---------0-----------------------#2020-12-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/07c70ffe60b084f5e8e3f38f8a44f7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*6_Hp9-hbz1sucuDixfb1-g.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">如何分割熊猫的数据帧</figcaption></figure><p id="11fa" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在Pandas中，数据通常以行和列的形式排列。数据帧是索引和类型化的二维数据结构。在Pandas中，您可以使用一种称为数据帧切片的技术从大型或小型数据集中提取您需要的数据。</p><p id="2af1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本指南中，我们将使用Numpy为我们创建一个数据集，然后使用Pandas对数据帧进行切片。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi la"><img src="../Images/59f9ede3a7b426da700be8f7e2457dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cSoeLTsj5WYfYlrz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在<a class="ae lf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae lf" href="https://unsplash.com/@neryfabiola_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Nery黑山</a>拍摄的照片</figcaption></figure><h1 id="f51b" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">使用NumPy创建数据集</h1><p id="365f" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">在分割数据帧之前，我们首先需要创建一个二维数据数组。二维数组是垂直和水平的表示形式，例如包含行和列的表格。我们将使用另一个流行的Python库NumPy及其arrange()和shape()函数来创建我们的表。</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="b991" class="mo lh iq mk b gy mp mq l mr ms">import numPy as np</span><span id="0938" class="mo lh iq mk b gy mt mq l mr ms">import pandas as pd</span><span id="d387" class="mo lh iq mk b gy mt mq l mr ms">df = pd.DataFrame(np.arange(20).reshape(5,4), columns=[“A”, “B”, “C”, “D”])</span><span id="fcaf" class="mo lh iq mk b gy mt mq l mr ms">This line tells NumPy to create a list of integers from 0 to 19 values in the “shape” of 5 rows x 4 columns and to label the columns A through D.</span><span id="1bac" class="mo lh iq mk b gy mt mq l mr ms">print(df)</span></pre><p id="596e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">输出:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="75dd" class="mo lh iq mk b gy mp mq l mr ms"><strong class="mk ir">A B C D</strong></span><span id="0c38" class="mo lh iq mk b gy mt mq l mr ms">0 0 1 2 3</span><span id="df73" class="mo lh iq mk b gy mt mq l mr ms">1 4 5 6 7</span><span id="8481" class="mo lh iq mk b gy mt mq l mr ms">2 8 9 10 11</span><span id="198f" class="mo lh iq mk b gy mt mq l mr ms">3 12 13 14 15</span><span id="e8d6" class="mo lh iq mk b gy mt mq l mr ms">4 16 17 18 19</span></pre><p id="7452" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们有了数据集，我们可以用多种方式对它进行切片。</p><p id="5406" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">注意</strong>:Pandas data frame语法采用操作符中的第一组索引进行行切片，第二组索引进行列切片。以下是一般规则:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="22cb" class="mo lh iq mk b gy mp mq l mr ms"><strong class="mk ir"><br/></strong>df.loc[row slicing, column slicing]</span></pre><p id="9778" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">或</strong></p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="8312" class="mo lh iq mk b gy mp mq l mr ms"><br/>df.iloc[startrow:endrow, startcolumn:endcolumn]</span></pre><p id="6eda" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当使用标签或整数对数据进行索引时，最好的方法通常是使用<strong class="ke ir"> loc </strong>函数。</p><p id="127c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当数据仅使用整数进行索引时，最好的方法通常是使用<strong class="ke ir"> iloc </strong>函数。</p><p id="b195" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们有了数据集和提取数据的方法，让我们通过一些例子来看看Pandas数据帧切片是如何工作的。</p><h1 id="1fef" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">按标签分割行和列</h1><p id="2a89" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">以下是如何使用loc函数按标签对行和列进行切片的示例:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="0715" class="mo lh iq mk b gy mp mq l mr ms">df.loc[:, “B”:”D”]</span></pre><p id="309f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这一行使用切片操作符按标签获取DataFrame项。第一片<strong class="ke ir"> [:] </strong>表示返回所有行。第二个片段指定只返回列<strong class="ke ir"> B、C、</strong>和<strong class="ke ir"> D </strong>。结果如下所示。</p><p id="efea" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">输出:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="4f57" class="mo lh iq mk b gy mp mq l mr ms"><strong class="mk ir">B C D</strong></span><span id="26a8" class="mo lh iq mk b gy mt mq l mr ms">0 1 2 3</span><span id="1e27" class="mo lh iq mk b gy mt mq l mr ms">1 5 6 7</span><span id="ad04" class="mo lh iq mk b gy mt mq l mr ms">2 9 10 11</span><span id="1c19" class="mo lh iq mk b gy mt mq l mr ms">3 13 14 15</span><span id="c5be" class="mo lh iq mk b gy mt mq l mr ms">4 17 18 19</span></pre><h1 id="4bb2" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">按索引位置对行和列进行切片</h1><p id="0d2c" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">以下是如何使用<strong class="ke ir"> iloc </strong>属性按索引位置对行和列进行切片的示例，重点是行切片:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="b9dd" class="mo lh iq mk b gy mp mq l mr ms">df.iloc[0:2, :]</span></pre><p id="2397" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用iloc函数，您可以在对列和行进行切片时指定范围甚至步骤。</p><p id="c674" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这种情况下，第一个片<strong class="ke ir">【0:2】</strong>只请求数据帧的第0到第1行。当在Pandas中按索引位置切片时，开始索引包括在输出中，但是停止索引超出了您想要选择的行一步。因此，切片返回第0行和第1行，但不返回第2行。</p><p id="443a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第二个片段<strong class="ke ir"> [:] </strong>表示所有列都是必需的。结果如下所示。</p><p id="0401" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">输出:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="ecd0" class="mo lh iq mk b gy mp mq l mr ms"><strong class="mk ir">A B C D</strong></span><span id="1f61" class="mo lh iq mk b gy mt mq l mr ms">0 0 1 2 3</span><span id="b682" class="mo lh iq mk b gy mt mq l mr ms">1 4 5 6 7</span></pre><h1 id="1f6c" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">使用iloc属性对列进行切片</h1><p id="9872" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">以下是如何使用<strong class="ke ir"> iloc </strong>属性进行切片的另一个示例，重点是列切片:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="56da" class="mo lh iq mk b gy mp mq l mr ms">df.iloc[:, 1:3]</span></pre><p id="2bf9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这种情况下，第一个运算符[:]要求返回所有行。</p><p id="2f1c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第二个操作符<strong class="ke ir">【1:3】</strong>只产生列<strong class="ke ir"> B </strong>和<strong class="ke ir"> C </strong>。这是因为我们的数据帧包含列<strong class="ke ir"> A </strong>(索引0)到列<strong class="ke ir"> D </strong>(索引3)。回想一下，当通过索引对数据帧进行切片时，我们指定了超出我们想要的一列的停止边界。在这种情况下，我们告诉pandas从索引1 <strong class="ke ir"> (B) </strong>到索引3 <strong class="ke ir"> (D) </strong>的列进行切片，但不包括索引3 <strong class="ke ir"> (D) </strong>。这将只返回索引为1和2的列。结果如下所示。</p><p id="58a8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">输出:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="0a3a" class="mo lh iq mk b gy mp mq l mr ms"><strong class="mk ir">B C</strong></span><span id="6db1" class="mo lh iq mk b gy mt mq l mr ms">0 1 2</span><span id="74e4" class="mo lh iq mk b gy mt mq l mr ms">1 5 6</span><span id="6e77" class="mo lh iq mk b gy mt mq l mr ms">2 9 10</span><span id="8936" class="mo lh iq mk b gy mt mq l mr ms">3 13 14</span><span id="387e" class="mo lh iq mk b gy mt mq l mr ms">4 17 18</span></pre><h1 id="6320" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">使用iloc属性对特定行和列进行切片</h1><p id="a6bd" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">下一个示例显示了如何使用<strong class="ke ir"> iloc </strong>属性对一组特定的行和列进行切片:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="c728" class="mo lh iq mk b gy mp mq l mr ms">df.iloc[1:2, 1:3]</span></pre><p id="925a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第一个操作员<strong class="ke ir">【1:2】</strong>只请求第1行到第2行。这仅产生1行，因为您实际上是告诉pandas从索引1开始并选择索引2，但是排除2，因为它是最后一个索引。</p><p id="e70a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第二个操作符<strong class="ke ir">【1:3】</strong>只生成了列<strong class="ke ir"> B </strong>到<strong class="ke ir"> C </strong>。记住我们的数据帧有列<strong class="ke ir"> A </strong>(索引0)到列<strong class="ke ir"> D </strong>(索引3)。我们得到这些结果是因为我们告诉pandas从索引1到3的列中切片，排除索引3。这将只生成索引为1和2的列。结果如下所示。</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="6ba5" class="mo lh iq mk b gy mp mq l mr ms">Output:</span><span id="9ffa" class="mo lh iq mk b gy mt mq l mr ms">B C</span><span id="aaff" class="mo lh iq mk b gy mt mq l mr ms">1 5 6</span></pre><h1 id="ddfe" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">使用iloc属性对特定行和列进行切片的替代方法</h1><p id="a060" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">最后，如何使用<strong class="ke ir"> iloc </strong>属性分割一组特定的行和列的另一个示例:</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="9817" class="mo lh iq mk b gy mp mq l mr ms">df.iloc[:2, :2]</span></pre><p id="fb3e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第一个操作符<strong class="ke ir"> [:2] </strong>需要从行开始到第二行<strong class="ke ir">(即第0行和第1行)</strong>的数据。第二个运算符<strong class="ke ir"> [:2] </strong>需要从列开始到第2列<strong class="ke ir">(即A和B) </strong>的数据。输出如下所示。</p><pre class="lb lc ld le gt mj mk ml mm aw mn bi"><span id="aa9d" class="mo lh iq mk b gy mp mq l mr ms">Output:</span><span id="bfc6" class="mo lh iq mk b gy mt mq l mr ms">A B</span><span id="df2b" class="mo lh iq mk b gy mt mq l mr ms">0 0 1</span><span id="c8d1" class="mo lh iq mk b gy mt mq l mr ms">1 4 5</span></pre><p id="a5ab" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">谢谢大家，好好享受吧！</p></div></div>    
</body>
</html>