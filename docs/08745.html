<html>
<head>
<title>Extract Tables and Text from PDF Files in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在R中从PDF文件中提取表格和文本</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/extract-tables-and-text-from-pdf-files-in-r-3b7a07d2f5b6?source=collection_archive---------2-----------------------#2021-06-01">https://levelup.gitconnected.com/extract-tables-and-text-from-pdf-files-in-r-3b7a07d2f5b6?source=collection_archive---------2-----------------------#2021-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f4a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">介绍Tabulizer:用于处理PDF文件的R库。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/45aa2fac922fbb13a481727ccc490515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zKKB975-5a10RIf2Z4C51g.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">比阿特丽斯·佩雷斯·莫亚在<a class="ae ky" href="https://unsplash.com/s/photos/documents?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="2cd9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">动机</h1><p id="cc97" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设你有一个进行数据分析的想法。但是当您搜索数据时，您会发现这些数据不是CSV或电子表格格式。数据是PDF格式的。</p><p id="cce8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果数据是那种格式，你打算怎么办？您可能会在电子表格应用程序中手动从头开始输入数据，或者您会完全复制数据，然后将它们复制到电子表格中进行清理。</p><p id="f59f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些过程会花费很多时间，更糟糕的是，你可能会出现人为错误。例如，您可能会输入错误的数据。</p><p id="6d31" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">幸运的是，有一个叫做tabulizer的R库可以帮助你在短时间内自动从PDF文件中提取表格或文本。</p><p id="d188" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我将使用R库向您介绍tabulizer库。此外，我还想向您展示这个库还能做些什么。没有进一步，让我们开始吧！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="984a" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">履行</h1><h2 id="d92a" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">安装并加载库</h2><p id="709b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们要做的第一件事是安装软件包。我们可以使用install.packages函数来安装这个库。之后，我们可以使用库函数加载库。下面是代码的样子，</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="9c7c" class="ne la it nr b gy nv nw l nx ny">install.packages('tabulizer')<br/>library(tabulizer)</span></pre><blockquote class="nz oa ob"><p id="6ec4" class="lr ls oc lt b lu mn ju lw lx mo jx lz od mp mc md oe mq mg mh of mr mk ml mm im bi translated">请注意:在我们使用这个库之前，请确保您已经在计算机上安装了java。这是因为该库是一个名为tabula java的java库的绑定。你可以从<a class="ae ky" href="https://www.java.com/en/download/" rel="noopener ugc nofollow" target="_blank">这里</a>下载java。</p></blockquote><h2 id="baa2" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">数据</h2><p id="083f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于本文，我将使用Badan Pusat Statistik (BPS)的一个PDF文件，名为“Luas潘恩和Produksi Padi di Provinsi Riau 2019”。</p><p id="26d6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">PDF文件包含廖内省2019年水稻产量的数据。这些数据也按地区和月份分类。你可以在这里访问PDF文件<a class="ae ky" href="https://riau.bps.go.id/publication/download.html?nrbvfeve=ZGZhODVlNTVjMjNiMTUzODdlMmE5OTNi&amp;xzmn=aHR0cHM6Ly9yaWF1LmJwcy5nby5pZC9wdWJsaWNhdGlvbi8yMDIwLzEyLzMwL2RmYTg1ZTU1YzIzYjE1Mzg3ZTJhOTkzYi9sdWFzLXBhbmVuLWRhbi1wcm9kdWtzaS1wYWRpLWRpLXByb3ZpbnNpLXJpYXUtMjAxOS5odG1s&amp;twoadfnoarfeauf=MjAyMS0wNS0yMyAwOTo1MToyNQ%3D%3D" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="539f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下一节中，我将把该文件称为“file.pdf”。</p><h2 id="1ed0" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">提取表格</h2><p id="0e0f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在让我们用tabulizer库来处理PDF文件。我们可以做的第一件事是从PDF文件中提取表格。例如，我们将从第60页提取表格。</p><p id="877b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要提取表，我们可以使用extract_tables函数。该函数将返回一个包含一个或多个表的列表。代码看起来像这样，</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="0748" class="ne la it nr b gy nv nw l nx ny"><strong class="nr iu"># Extract the table</strong><br/>tabel &lt;- extract_tables('file.pdf', pages = 60)<br/><strong class="nr iu"># Extract the first element of the variable</strong><br/>View(tabel[[1]])</span></pre><p id="6430" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是结果的预览，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/0833d3869ae0cc7c52fc0c44446a7578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RUFaZHoxsW6WaP4V"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者捕捉到的</figcaption></figure><p id="ea52" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来我们还可以交互提取表格。为此，我们可以使用extract_areas函数以交互方式提取表。下面是命令的样子，</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="ab57" class="ne la it nr b gy nv nw l nx ny">extract_areas('file.pdf', pages=60)</span></pre><p id="22fe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是过程和结果，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/2bc361b14ceea32db6fdcf06a94b7e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qrUeqXkiCsuLTcJbmXKD5Q.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者捕捉到的</figcaption></figure><h2 id="a53b" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">提取文本</h2><p id="d57f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">除了提取表格，我们还可以从PDF文件中提取文本。我们可以使用extract_text函数来收集文本数据。下面是命令的样子，</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="e394" class="ne la it nr b gy nv nw l nx ny">cat(extract_text('file.pdf', pages=6), sep="\n")</span></pre><p id="0bd8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">左边是PDF文件的预览，右边是代码结果，</p><div class="kj kk kl km gt ab cb"><figure class="oi kn oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/45bc70a669e5cd27636e49143096de58.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/0*UmL1VrBSGhmtLnw_"/></div></figure><figure class="oi kn oo ok ol om on paragraph-image"><img src="../Images/2238f905a6934c9f7810bfa18688718d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/0*8J0l36-5bzolzJNA"/><figcaption class="ku kv gj gh gi kw kx bd b be z dk op di oq or translated">左:PDF文件页面，右:提取结果(作者捕获)</figcaption></figure></div><h2 id="d706" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">其他功能</h2><p id="a758" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个库还有其他功能。第一个特征是提取页数。您可以使用get_n_pages函数来提取它。下面是命令的样子，</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="52ef" class="ne la it nr b gy nv nw l nx ny">get_n_pages("file.pdf")</span></pre><p id="bf5f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是结果的预览，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/7d298af7a15d5c3a9d8bfcaeecd40d50.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/0*7IXJSVjf0yFTvBrl"/></div></figure><p id="17cc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第二个功能是提取PDF文件的大小尺寸。您可以使用get_page_dims函数来检索尺寸。下面是命令的样子，</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="e4a6" class="ne la it nr b gy nv nw l nx ny">get_page_dims("file.pdf", pages=1)</span></pre><p id="c467" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是结果的预览，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/becfc4d9417da3fa769617721cf713d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/0*hrH_ceZVXHqB9j0s"/></div></figure><p id="f478" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以使用该库的最后一个功能是将PDF文件的页面转换为图像。您可以使用make_thumbnails功能来更改格式。下面是命令的样子，</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="f026" class="ne la it nr b gy nv nw l nx ny">make_thumbnails("file.pdf", "&lt;FILE_PATH&gt;", pages=60)</span><span id="b90d" class="ne la it nr b gy ou nw l nx ny"><strong class="nr iu">OUTPUT:<br/>&gt;&gt; "&lt;FILE_PATH&gt;/file60.png"</strong></span></pre><p id="4b61" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是预览的样子，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/105ffd7ac7d575011fc58ddced779030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p7nvgaTi-cZCJMyr"/></div></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="0c70" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">结束语</h1><p id="5513" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">恭喜你！您已经学习了如何使用tabulizer库从PDF文件中提取表格和文本。我希望这对您有用，并且您可以将它用于其他情况。</p><p id="d927" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你对我的帖子感兴趣，你可以在Medium上关注我，或者如果你想就数据科学或类似的问题与我交谈，你可以在LinkedIn上与我联系。</p><p id="0104" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">谢谢你看我的文章！</p></div></div>    
</body>
</html>