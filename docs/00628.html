<html>
<head>
<title>How to publish a python command line application to pip (PyPI)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将python命令行应用程序发布到pip (PyPI)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-publish-a-python-command-line-application-to-pypi-5b97a6d586f1?source=collection_archive---------2-----------------------#2019-06-11">https://levelup.gitconnected.com/how-to-publish-a-python-command-line-application-to-pypi-5b97a6d586f1?source=collection_archive---------2-----------------------#2019-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/092bdae8211ea7902b36c381a9d1b6e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Zh-mzLnVMDsbvXdKsU4lw.png"/></div></div></figure><p id="5aa8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在花了一些时间开发一个cli项目后，您想在pip (PyPI)上发布它。毕竟，哪个安装程序能胜过简单的<em class="kw"> pip安装</em>？在互联网上搜索了一番后，你可能已经看到了<a class="ae kx" href="https://gehrcke.de/2014/02/distributing-a-python-command-line-application/" rel="noopener ugc nofollow" target="_blank">关于这个话题的唯一一个帖子，我找到了</a>，它来自2014年，要求你创建一堆文件夹和文件来做一些并不真正需要的事情。</p><p id="b09e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇博文可能也会让你想知道，在2019年，是否有更好的方式来做事情，而不需要那么多样板文件。我也是这么想的，所以，在阅读了大量关于包装的文档后，我在这里浓缩了这些信息，这样你就不需要再去读了。以下是逐步说明:</p><ol class=""><li id="d105" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">在PyPI ( <a class="ae kx" href="https://pypi.org/account/register/" rel="noopener ugc nofollow" target="_blank">注册链接</a>)上创建账户</li><li id="c3e4" class="ky kz iq ka b kb lh kf li kj lj kn lk kr ll kv ld le lf lg bi translated">创建应用程序的入口点(将以下代码放入<em class="kw"> entry.py </em>)</li></ol><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="b62d" class="lv lw iq lr b gy lx ly l lz ma">def main():<br/>    print("It's alive!")</span></pre><p id="5cc9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.装诗</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="429d" class="lv lw iq lr b gy lx ly l lz ma">curl -sSL https://raw.githubusercontent.com/sdispater/poetry/master/get-poetry.py | python<br/>source $HOME/.poetry/env</span></pre><p id="169f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.设置诗歌</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="6467" class="lv lw iq lr b gy lx ly l lz ma">cd myproject #Navigate to your project's directory<br/>poetry init</span></pre><p id="f595" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.设置cli命令(将以下行添加到<em class="kw"> pyproject.toml </em>)</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="5211" class="lv lw iq lr b gy lx ly l lz ma">[tool.poetry.scripts]<br/>APPLICATION-NAME = 'entry:main'</span></pre><p id="9a16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以将<em class="kw">应用程序名称</em>替换为您希望的任何主cli命令。</p><p id="1ff3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">6.发布吧！(替换为您在步骤1中使用的用户名和密码)</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="aa3c" class="lv lw iq lr b gy lx ly l lz ma">poetry publish --username PYPI_USERNAME --password PYPI_PASS --build</span></pre><p id="edf6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它还活着！现在，您的用户只需下面两行代码就可以安装和使用您的应用程序:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="1b86" class="lv lw iq lr b gy lx ly l lz ma">$ sudo pip install PROJECT-NAME<br/>$ APPLICATION-NAME</span></pre><p id="1678" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中<em class="kw">项目名称</em>是您在步骤4(诗歌初始化)中为项目指定的名称，而<em class="kw">应用程序名称</em>是步骤5中的cli命令名称。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="c3c3" class="lv lw iq bd mi mj mk dn ml mm mn dp mo kj mp mq mr kn ms mt mu kr mv mw mx my bi translated"><strong class="ak">更新</strong></h2><p id="89a2" class="pw-post-body-paragraph jy jz iq ka b kb mz kd ke kf na kh ki kj nb kl km kn nc kp kq kr nd kt ku kv ij bi translated">每当你想更新你的包时，只需改变<em class="kw"> pyproject.toml，</em>中的版本号，它在下面的<em class="kw">行中定义:</em></p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="2992" class="lv lw iq lr b gy lx ly l lz ma">version = "0.1.0"</span></pre><p id="bce2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并重新运行步骤6:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="2250" class="lv lw iq lr b gy lx ly l lz ma">poetry publish --username PYPI_USERNAME --password PYPI_PASS --build</span></pre></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="8b64" class="lv lw iq bd mi mj mk dn ml mm mn dp mo kj mp mq mr kn ms mt mu kr mv mw mx my bi translated">额外收获:Travis为自动出版而构建</h2><p id="834a" class="pw-post-body-paragraph jy jz iq ka b kb mz kd ke kf na kh ki kj nb kl km kn nc kp kq kr nd kt ku kv ij bi translated">将以下几行添加到您的<em class="kw"> .travis.yml: </em></p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="462b" class="lv lw iq lr b gy lx ly l lz ma">language: python<br/>dist: xenial</span><span id="3b39" class="lv lw iq lr b gy ne ly l lz ma">before_install:<br/>  - curl -sSL <a class="ae kx" href="https://raw.githubusercontent.com/sdispater/poetry/master/get-poetry.py" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/sdispater/poetry/master/get-poetry.py</a> | python<br/>  - source $HOME/.poetry/env</span><span id="8de9" class="lv lw iq lr b gy ne ly l lz ma">install:<br/>  - poetry install</span><span id="1a11" class="lv lw iq lr b gy ne ly l lz ma">script:<br/>  - poetry build</span><span id="5a6d" class="lv lw iq lr b gy ne ly l lz ma">deploy:<br/>  - provider: script<br/>    skip_cleanup: true<br/>    script: poetry publish --username $PYPI_USER --password $PYPI_PASS<br/>    on:<br/>      branch: master<br/>      python: '3.7'<br/>      tags: true</span></pre><p id="4658" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并将PYPI_USER和PYPI_PASS设置为<a class="ae kx" href="https://travis-ci.com/" rel="noopener ugc nofollow" target="_blank">travis-ci.com</a>中的travis环境变量。之后，您可以使用以下命令发布您的包:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="9808" class="lv lw iq lr b gy lx ly l lz ma">git tag -a v1.2 # Replace version number with yours<br/>git push --tags</span></pre></div></div>    
</body>
</html>