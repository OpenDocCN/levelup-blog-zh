<html>
<head>
<title>Dart backend by example — REST API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Dart后端示例— REST API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/dart-backend-by-example-rest-api-a8a1004dc705?source=collection_archive---------1-----------------------#2021-05-16">https://levelup.gitconnected.com/dart-backend-by-example-rest-api-a8a1004dc705?source=collection_archive---------1-----------------------#2021-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f4844787f4ba1b613fa29426f7f087c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LpofnCw46zZIuJ-ex0FILg.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@kelvin1987?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Kelvin Ang </a>在<a class="ae jg" href="https://unsplash.com/s/photos/server?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="944f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想知道是否可以在后端使用Dart代码吗？重用代码是最佳实践，允许相同的代码在多个平台上运行将减少维护、上市时间和压力。</p><p id="c649" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本教程中，我们将使用Dart中的REST API构建一个web服务器，允许调用者从您的服务器获取JSON数据。我们的Dart后端REST API将支持以下功能:</p><ul class=""><li id="bc14" class="le lf jj ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">CORS构型</li><li id="8dcb" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">服务器端排序</li><li id="2621" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">服务器端分页</li><li id="a897" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">通过Nginx托管(作为反向代理)</li></ul><h1 id="c9d1" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">前言</h1><h2 id="c32e" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">Dart SDK已安装</h2><p id="5e22" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">按照下面显示的步骤安装Dart SDK。如果您安装了Flutter 1.21或更新版本，您不必安装Dart SDK，因为它包含在Flutter中。</p><div class="is it gp gr iu nh"><a href="https://dart.dev/get-dart" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd jk gy z fp nm fr fs nn fu fw ji bi translated">获取Dart SDK</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">本页描述如何下载Dart SDK。Dart SDK拥有您需要的库和命令行工具…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">dart.dev</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ja nh"/></div></div></a></div><h2 id="4e4e" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">任何你喜欢的想法</h2><p id="7370" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">我将使用Visual Studio代码(在Linux上工作)，任何IDE都可以工作，因为你只需编辑文本(当然，如果你想调试，你需要一些与Dart兼容的东西)。可以在这里找到可能选项的列表。</p><div class="is it gp gr iu nh"><a href="https://dart.dev/tools#ides-and-editors" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd jk gy z fp nm fr fs nn fu fw ji bi translated">工具</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">支持Dart语言的工具。</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">dart.dev</p></div></div><div class="nq l"><div class="nw l ns nt nu nq nv ja nh"/></div></div></a></div><h1 id="0286" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">准备好你的项目</h1><p id="228e" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">为了让你有一个良好的开端，从我的GitHub页面下载下面的项目，我们将在本教程中使用它。你可以使用GitHub上的下载按钮，或者在shell/命令窗口中运行下面的命令(你需要安装<a class="ae jg" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">Git</a>):</p><pre class="nx ny nz oa gt ob oc od oe aw of bi"><span id="6931" class="mq lt jj oc b gy og oh l oi oj">git clone <a class="ae jg" href="https://github.com/Dev-Owl/dart_backend_example.git" rel="noopener ugc nofollow" target="_blank">https://github.com/Dev-Owl/dart_backend_example.git</a></span></pre><figure class="nx ny nz oa gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/670049c2a09c8e261cd64f13ef7c9136.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XaTlYb_Sx5WAl73hexhG9A.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">运行git clone命令</figcaption></figure><h2 id="4a2f" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">如何创建dart项目？</h2><p id="3b02" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">我们将在本教程中使用上面提到的存储库，但是您可能会问自己:“我如何才能获得一个新的项目模板？”</p><p id="b213" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">像Flutter一样，Dart提供了一个命令行界面来生成项目模板:</p><pre class="nx ny nz oa gt ob oc od oe aw of bi"><span id="b6ec" class="mq lt jj oc b gy og oh l oi oj">dart create -t [PROJECT_TYPE] [PROJECT_NAME]</span></pre><figure class="nx ny nz oa gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ol"><img src="../Images/b73f6e78291c3fce11dbe2be48a97790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SdkLo-tnhwpZffV7xnm5ig.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">创建dart的帮助文本</figcaption></figure><p id="38c9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想创建一个Dart控制台应用程序，并将其命名为helloWorld，命令如下:</p><pre class="nx ny nz oa gt ob oc od oe aw of bi"><span id="8685" class="mq lt jj oc b gy og oh l oi oj">dart create -t console-full helloWorld</span></pre><p id="de31" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Dart.dev有一些进一步的细节和关于这个主题的<a class="ae jg" href="https://dart.dev/tutorials/server/get-started" rel="noopener ugc nofollow" target="_blank">分步指南。</a></p><h1 id="648f" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">项目的结构</h1><p id="e1c8" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">让我们看看您从GitHub下载的项目，我们将从项目根文件夹中的文件开始:</p><h2 id="b254" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">pubspec.yaml</h2><p id="bc39" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">像扑，飞镖使用。yaml文件来跟踪和配置依赖项和项目细节。示例项目有两个依赖项:path和pedantic。第一个是从文件中读取数据。<br/> Pedantic是一种开发依赖，这意味着它在开发过程中使用，但在最终应用中并不需要。<br/>由Pedantic支持，如果你的代码违反了任何风格指南或有其他缺点，你会得到通知，simple说它支持你编写干净的代码。</p><h2 id="c3ba" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">分析_选项. yaml</h2><p id="9363" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">Pedantic(代码分析开发依赖)使用这个文件来知道您想要应用什么样的规则。该文件被配置为使用默认规则。<a class="ae jg" href="https://github.com/google/pedantic#enabled-lints" rel="noopener ugc nofollow" target="_blank">如果需要可以调整配置</a>。</p><h2 id="744a" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">LICENSE &amp; README.md &amp;。gitignore</h2><p id="7714" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">GitHub/Git相关文件，我们的Dart后端项目不需要。</p><h2 id="75e8" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">bin文件夹</h2><p id="2fb3" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">在bin文件夹中，你会找到应用程序的完整代码。本教程将涵盖以下细节，快速概述:</p><ul class=""><li id="1e46" class="le lf jj ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">serveTestData.dart —主dart文件，包括REST API的代码</li><li id="7563" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">data . JSON——我们的数据存储，里面的数据将用于回答请求</li><li id="c907" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">company_contact.dart —将用于读取JSON数据的模型类</li></ul><h1 id="d277" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">让我们建立一个网络服务器</h1><p id="0014" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">对于从Git中签出的任何Dart或Flutter应用程序，第一步都应该是恢复包(包不在Git存储库中)。在项目的根文件夹中运行以下命令:</p><pre class="nx ny nz oa gt ob oc od oe aw of bi"><span id="a8d2" class="mq lt jj oc b gy og oh l oi oj">dart pub get</span></pre><p id="b95d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下载完依赖项后，可以使用IDE或通过以下命令直接启动项目:</p><pre class="nx ny nz oa gt ob oc od oe aw of bi"><span id="563e" class="mq lt jj oc b gy og oh l oi oj">dart run</span></pre><p id="340a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一切正常，您将在控制台/IDE输出窗口中看到两个提示:</p><figure class="nx ny nz oa gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a2868fdce59799caa578a46baa8bb8fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*y0neVSqjzs6WcXoFYa8CRg.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">web服务器已经启动，找到了数据文件，正在等待请求</figcaption></figure><p id="a456" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在打开您选择的浏览器，打开输出中显示的URL，或者复制下面的URL:</p><p id="f7a4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae jg" href="http://127.0.0.1:4044" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:4044 </a></p><figure class="nx ny nz oa gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/9f055e167560450be737854a8e2dda09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-sXGy1eJ3_mH1XFHceWGA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">在浏览器中请求数据的结果</figcaption></figure><p id="447e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">请注意:</strong>web服务器将开始在端口4044上列出仅来自您的计算机(本地主机)的请求。如果这个端口已经被使用，应用程序将打印一个错误并退出。</p><h2 id="2a9b" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">代码</h2><p id="4369" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">太好了，项目正在运行！现在，让我们确保详细了解它是如何工作的。打开serveTestData.dart文件。在该文件中，您会发现四个部分(标有注释):</p><figure class="nx ny nz oa gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/a35cc36ae9bbc3569f24d954bbccad1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wSKKOQE2nmRtcDdX3sN0g.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">serveTestData.dart文件中的四个部分</figcaption></figure><h2 id="fe6c" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">第一节</h2><p id="e691" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">在开始时，我提到过我们希望从JSON文件中传输数据。当Dart web服务器启动时，此部分会自动构建该文件的路径。</p><p id="6ce2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">来自pub.dev 的<a class="ae jg" href="https://pub.dev/packages/path" rel="noopener ugc nofollow" target="_blank">路径包使您能够与文件路径进行交互，并为您正在使用的操作系统创建匹配的路径。查看第5行，这是我导入包并将其重命名为path的地方。</a></p><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><h2 id="465c" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">第二节</h2><p id="53fa" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">我们的REST API需要响应客户端——为了完成这个任务，使用了类ResponseModel。该类始终包含整数形式的总行数和CompanyContact对象列表。</p><p id="17a0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CompanyContact是一个位于company_contact.dart文件中的自定义类，在我们的Dart REST API中用作<a class="ae jg" href="https://en.wikipedia.org/wiki/Data_transfer_object" rel="noopener ugc nofollow" target="_blank"> DTO(数据传输对象)</a>。</p><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><h2 id="1485" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">第三节</h2><p id="c49d" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">REST API应该支持服务器端的排序和分页、待办事项，所以它需要知道如何根据客户端的请求对数据进行排序。<br/>为了保持代码简单，REST API使用一个数字索引来决定数据的什么属性应该被排序。Dart提供了一个名为<a class="ae jg" href="https://api.dart.dev/stable/1.10.1/dart-core/String/compareTo.html" rel="noopener ugc nofollow" target="_blank"> compareTo </a>的便利函数，为我们进行排序。代码中的所有决策都是由一条<a class="ae jg" href="https://dart.dev/guides/language/language-tour#switch-and-case" rel="noopener ugc nofollow" target="_blank"> Dart switch case </a>语句完成的。</p><p id="1108" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了确保REST API在没有特定排序的情况下也能工作，代码使用ID属性作为后备，以防客户端没有请求任何东西。<br/>为了使客户端能够决定数据最后应该是升序还是降序，compareTo的结果需要乘以-1，以将默认的升序方法变为降序。</p><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="0f42" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简要解释比较(来自Dart文档):</p><blockquote class="or os ot"><p id="acc1" class="kg kh ou ki b kj kk kl km kn ko kp kq ov ks kt ku ow kw kx ky ox la lb lc ld im bi translated">如果<code class="fe oy oz pa oc b">this</code>在<code class="fe oy oz pa oc b">other</code>之前排序，则compareTo(this，other)返回一个负整数，如果<code class="fe oy oz pa oc b">this</code>在<code class="fe oy oz pa oc b">other</code>之后排序，则返回一个正整数，如果<code class="fe oy oz pa oc b">this</code>和<code class="fe oy oz pa oc b">other</code>一起排序，则返回零。</p></blockquote><h2 id="050d" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">第四节</h2><p id="37b0" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">在第4部分你会发现主要的功能，应用程序的开始。Dart后端项目将总是在这个函数中启动。</p><h2 id="18a0" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">准备好数据</h2><p id="f7da" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">首先要做的事情之一是，我们的web服务器将把包含示例数据的完整文件读入内存。现在使用在第1部分中构建的路径。这种情况在启动时只发生一次，如果文件丢失，将会打印一个错误，应用程序将停止工作。</p><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><h2 id="341f" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">绑定web服务器</h2><p id="2b20" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">下一步将配置并启动web服务器。服务器在端口4044上连接到您的本地环回IPV4地址(对于localhost或127.0.0.1来说很有趣)。这一切都发生在第16行对HttpServer.bind的调用中。如果端口4044已经在使用中(或者出现其他问题)，我们的Dart后端代码将打印一个错误并停止应用程序。如果一切正常，您将会看到代码现在为传入请求列出的消息。</p><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><h2 id="1751" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">处理传入请求</h2><p id="5cec" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">从这一点上，web服务器正在运行并等待传入的连接。感谢Dart 中<a class="ae jg" href="https://dart.dev/tutorials/language/streams" rel="noopener ugc nofollow" target="_blank">流的工作方式，你所需要做的就是用一个</a><a class="ae jg" href="https://dart.dev/codelabs/async-await" rel="noopener ugc nofollow" target="_blank">异步For循环</a>来获取新的请求。</p><h2 id="59c5" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">收到了新的请求</h2><p id="20e6" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">一旦你打开URL(长版本，如果你发送一个<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET" rel="noopener ugc nofollow" target="_blank"> HTTP GET </a>请求到我们的Dart后端REST API的URL)代码将进入for循环。<br/>发生的第一件事是设置JSON响应的contentType。这样做是为了通知客户我们将和他谈JSON。<br/>后面跟着另一个<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" rel="noopener ugc nofollow" target="_blank"> HTTP头来设置CORS </a>规则，快速版本这允许浏览器使用API，即使它托管在不同的URL上(我在下面的文章中有所涉及):</p><div class="is it gp gr iu nh"><a href="https://medium.com/flutter-community/seven-things-you-should-know-before-starting-with-flutter-web-8e48555d819e" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd jk gy z fp nm fr fs nn fu fw ji bi translated">开始使用Flutter Web之前你应该知道的七件事</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">获得一个良好的开端与颤振网页，点，我希望我会有一个挂在我开始之前。URL路由…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">medium.com</p></div></div><div class="nq l"><div class="pb l ns nt nu nq nv ja nh"/></div></div></a></div><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="bc95" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在所有的<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" rel="noopener ugc nofollow" target="_blank"> HTTP头</a>就位后，代码将检查请求<a class="ae jg" href="https://en.wikipedia.org/wiki/Query_string" rel="noopener ugc nofollow" target="_blank">查询参数</a>。我们的后端服务器支持四个参数:</p><ul class=""><li id="9a6b" class="le lf jj ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki jk">偏移量</strong> —应该跳过的数据条目数量</li><li id="8302" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki jk"> pageSize </strong> —客户端想要获取的元素数量</li><li id="bf90" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki jk"> sortIndex </strong> —对数据进行排序的列的数字索引(参见第2节)</li><li id="47c9" class="le lf jj ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki jk"> sortAsc </strong> —对数据进行排序的顺序(见第2节)</li></ul><p id="9baf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以上所有查询参数都是可选的，如果缺少它们，将使用默认值。如果请求包含某个参数的错误值，例如文本而不是数字，请求将失败，并出现500服务器错误。当然，这部分可以通过适当的错误消息和正确的<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400" rel="noopener ugc nofollow" target="_blank"> HTTP代码400 </a>来通知调用者他犯了一个错误。</p><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><h2 id="8ca7" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">将数据发送给客户端</h2><p id="b2de" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">一旦检查了请求参数，就该在应用偏移量和页面大小之前对数据进行排序了。这是确保我们获得正确数据的第一步，如果您按姓名对数据进行排序，然后取前50行，您将获得不同的结果，就像您按电话号码对数据进行排序一样。<br/>一旦数据被排序，代码就将响应“写”给客户机。<br/>由于内置了<a class="ae jg" href="https://api.dart.dev/stable/2.13.0/dart-core/Iterable/skip.html" rel="noopener ugc nofollow" target="_blank">跳过</a>和<a class="ae jg" href="https://api.dart.dev/stable/2.13.0/dart-core/Iterable/take.html" rel="noopener ugc nofollow" target="_blank">采取</a>列表的方法，分页很快就完成了。最后一步是将响应包装在我们的DTO中(第2节)，并用<a class="ae jg" href="https://api.dart.dev/stable/2.12.2/dart-convert/jsonEncode.html" rel="noopener ugc nofollow" target="_blank"> jsonEncode </a>将其编码为JSON。Dart内置了一个<a class="ae jg" href="https://dart.dev/guides/json" rel="noopener ugc nofollow" target="_blank">到JSON的转换</a>，JSON数据被处理为一个<a class="ae jg" href="https://api.dart.dev/stable/2.13.0/dart-core/Map-class.html" rel="noopener ugc nofollow" target="_blank">映射&lt;字符串，动态&gt;T13】。<br/>for循环的最后一行是关闭响应，最后将数据发送给客户端。</a></p><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><h2 id="beee" class="mq lt jj bd lu mr ms dn ly mt mu dp mc kr mv mw mg kv mx my mk kz mz na mo nb bi translated">完成第4部分代码</h2><figure class="nx ny nz oa gt iv"><div class="bz fp l di"><div class="op oq l"/></div></figure><h1 id="0371" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">活生生的例子</h1><p id="a646" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">完整的代码在线运行，试一试，看看几个例子:</p><p id="bbc9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae jg" href="https://example.devowl.de" rel="noopener ugc nofollow" target="_blank">https://example . devo wl . de</a></p><p id="f7c1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将给出按ID属性升序排序的前10行。</p><p id="40f8" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae jg" href="https://example.devowl.de/?sortIndex=2&amp;sortAsc=0&amp;offset=100&amp;pageSize=50" rel="noopener ugc nofollow" target="_blank">https://example.devowl.de/?sortIndex=2&amp;sortAsc = 0&amp;offset = 100&amp;pageSize = 50</a></p><p id="bf51" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行上述请求将按照CompanyName属性对数据进行降序排序。将跳过前100条记录，并返回50条记录。<br/>如果您尝试下面的URL，您将得到一个HTTP 500错误，值“foobar”不是pageSize的有效数字:</p><p id="b51b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae jg" href="https://example.devowl.de/?sortIndex=2&amp;sortAsc=0&amp;offset=100&amp;pageSize=foobar" rel="noopener ugc nofollow" target="_blank">https://example.devowl.de/?sortIndex=2&amp;sortAsc = 0&amp;offset = 100&amp;pageSize = foobar</a></p><p id="34d7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要查看作为应用程序后端使用的系统，请查看我在Flutter中关于服务器端数据表的帖子:</p><div class="is it gp gr iu nh"><a rel="noopener  ugc nofollow" target="_blank" href="/server-side-paginated-data-table-in-flutter-d01b16f30f3"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd jk gy z fp nm fr fs nn fu fw ji bi translated">Flutter中的服务器端分页数据表</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">您需要处理一大组数据，并希望以表格的形式呈现出来？高级数据表已涵盖你。了解如何…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nq l"><div class="pc l ns nt nu nq nv ja nh"/></div></div></a></div><p id="0ad5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者直接进入正在运行的Flutter Web应用程序:</p><div class="is it gp gr iu nh"><a href="https://dev-owl.github.io/advanced_datatable/#/" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd jk gy z fp nm fr fs nn fu fw ji bi translated">示例_高级_数据表</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">一个新的颤振项目。</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">dev-猫头鹰. github.io</p></div></div></div></a></div><h1 id="6eda" class="ls lt jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">下一步是什么？</h1><p id="2322" class="pw-post-body-paragraph kg kh jj ki b kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ng lb lc ld im bi translated">摆弄一下代码，你可以交换状态文件后端，用SQLite替换它，如果你想这样做的话，可以使用checkout Moor。</p><div class="is it gp gr iu nh"><a href="https://medium.com/@c.muehle18/flutter-package-at-a-glance-local-storage-with-moor-c4736d92850a" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd jk gy z fp nm fr fs nn fu fw ji bi translated">Flutter package一览Moor本地存储</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">欢迎收看第一集名为“扑包一瞥”的帖子！这次是关于离线存储…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">medium.com</p></div></div><div class="nq l"><div class="pd l ns nt nu nq nv ja nh"/></div></div></a></div><p id="5cf2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码的另一个变化可能是API内部的错误处理。web API的最佳实践是向客户端返回正确的错误代码。<br/>排序和分页很好，但是服务器端过滤器呢？更改代码，只返回以A开头的公司或德国(+49)的电话号码。</p><p id="afb7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">希望我能向你展示如何在后端使用Dart并创建一个简单的REST API。随意评论，为☺鼓掌</p></div></div>    
</body>
</html>