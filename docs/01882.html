<html>
<head>
<title>UI Testing a React App Using Cypress</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Cypress测试React应用程序的UI</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ui-testing-a-react-app-using-cypress-247c3bc4cd94?source=collection_archive---------8-----------------------#2020-02-04">https://levelup.gitconnected.com/ui-testing-a-react-app-using-cypress-247c3bc4cd94?source=collection_archive---------8-----------------------#2020-02-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/aa09269197ba1a65a097636837153d1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NgBRl1-qlXI4QK10sLcxHA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Mick Haupt 在<a class="ae kc" href="https://unsplash.com/s/photos/cypress?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="b8b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> Cypress </a>是一款用于现代web应用的自动化UI和端到端测试的工具。我以前使用过其他测试工具，比如Selenium，在我看来，Cypress更快更容易安装。将它与现有的前端应用程序集成起来非常简单。本教程将着重于测试React应用程序，但是您也可以将Cypress用于用另一种技术编写的其他应用程序。它应该让您知道开始用Cypress编写测试是多么容易。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="bce5" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">React应用程序示例</h1><p id="594d" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">我将使用这个简单的react应用程序，所以如果您想按照教程学习，请随意克隆它。</p><div class="ml mm gp gr mn mo"><a href="https://github.com/randalvance/react-cypress-starter" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">Randal vance/react-cypress-starter</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">这个项目是用Create React App引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">github.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc jw mo"/></div></div></a></div><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/bfb04eb64736593077852ffd6546e087.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/1*DQ2xPsdWZKrnu3f9Li2m5Q.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">用于Cypress测试的简单React应用程序</figcaption></figure><p id="da55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个简单的react应用程序，只有一个表单，单击submit后可以导航到另一个页面。</p><p id="a754" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想在完成本教程后看到最终的代码，那么您可以检查这个Git存储库的<code class="fe ni nj nk nl b">final</code>分支。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="5414" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">安装Cypress</h1><p id="4402" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">从Github克隆了示例react应用程序repo之后，在终端中导航到它的根文件夹，并安装Cypress。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="e89e" class="nq lj iq nl b gy nr ns l nt nu">npm install cypress --save-dev</span></pre><p id="b435" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个npm脚本来启动cypress。我们这样做是为了不需要在全球范围内安装cypress，可以简单地将它作为npm脚本运行。在您的<code class="fe ni nj nk nl b">package.json</code>文件中，找到<code class="fe ni nj nk nl b">scripts</code>部分并添加一个新条目。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="790b" class="nq lj iq nl b gy nr ns l nt nu">"scripts": {<br/>    "cypress:open": "cypress open",<br/>    ...<br/>},</span></pre><p id="4580" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们现在可以通过执行以下命令来打开Cypress测试运行程序:</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="47a6" class="nq lj iq nl b gy nr ns l nt nu">npm run cypress:open</span></pre><p id="ec96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Cypress test runner将会打开，它会建议创建一些示例测试来帮助您开始。点击“好的，知道了！”按钮。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/8915b69fb59d3165535db2ca7e92f34a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jh8UcLs9yASw8J7O7P55vw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Cypress将创建必要的文件夹和示例文件。</figcaption></figure><p id="51c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个<code class="fe ni nj nk nl b">cypress</code>文件夹将被创建在你的项目的根目录下，还有一个<code class="fe ni nj nk nl b">cypress.json</code>文件。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/9c277ebd5c6ecd9111c132792b8f633d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*yr1025FGtboxaZullKqXeA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">这是Cypress创建的文件夹和文件。</figcaption></figure><p id="e660" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ni nj nk nl b">cypress/integration/examples</code>下，您将看到一些可作为有用参考的示例测试。我已经在本教程中删除了它们。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="d7fe" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">为Cypress启用类型脚本</h1><p id="27e7" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在您的<code class="fe ni nj nk nl b">cypress</code>文件夹中，创建一个<code class="fe ni nj nk nl b">tsconfig.json</code>文件并使用以下配置:</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="4e3b" class="nq lj iq nl b gy nr ns l nt nu">{<br/>    "compilerOptions": {<br/>        "baseUrl": "../node_modules",<br/>        "types": [<br/>            "cypress"<br/>        ]<br/>    },<br/>    "include": [<br/>        "**/*.*"<br/>    ]<br/>}</span></pre></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="4ebc" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建一个简单的测试</h1><p id="7a1e" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在<code class="fe ni nj nk nl b">cypress/integration</code>文件夹中，创建一个名为<code class="fe ni nj nk nl b">sample_spec.ts</code>的新文件。使用以下内容。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="f974" class="nq lj iq nl b gy nr ns l nt nu">describe('My First Test', function() {<br/>    it('Should pass!', function() {<br/>        expect(true).to.equal(true);<br/>    });<br/>});</span></pre><p id="4286" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Cypress使用的是<a class="ae kc" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank"> Mocha测试框架</a>，所以测试的结构是相似的。我们首先通过调用<code class="fe ni nj nk nl b">describe</code>函数来定义测试套件的名称。它接受测试套件的名称，后跟一个回调函数。这个回调函数将包含单独的测试以及设置和拆卸逻辑。</p><p id="d8e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过调用<code class="fe ni nj nk nl b">it</code>函数来定义单个测试。第一个参数是测试的描述。第二个参数是一个包含测试将要执行的步骤的函数。</p><p id="dcba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面一行是断言。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="e7ab" class="nq lj iq nl b gy nr ns l nt nu">expect(true).to.equal(true);</span></pre><p id="d173" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将在本文的后面讨论断言，但是现在，这个断言基本上检查<code class="fe ni nj nk nl b">true</code>是否是<code class="fe ni nj nk nl b">true</code>，这确保了测试将总是通过(只是为了给你一个通过的测试)。</p><p id="f973" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">返回赛普拉斯测试赛。请注意，您创建的文件现在出现了。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/c04ff6925af76b59373f4b638e50de60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwiSzx2uv74gN6Pa_iuiMQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">测试文件出现在Cypress Test Runner中。</figcaption></figure><p id="ac49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意右上角(在“登录”按钮的正下方)所选的浏览器。您可以通过简单地点击文件来运行测试，它将使用您指定的浏览器来运行所选择的测试。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/bf04f40f2201d447c5789c03a88b97e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ymbo0bxOebeUqi9NDm0bOw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">测试将在浏览器中运行。</figcaption></figure><p id="b198" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你应该看到你的测试通过了。</p><p id="84c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要测试测试失败后会发生什么，请将代码更改为以下内容。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="fadf" class="nq lj iq nl b gy nr ns l nt nu">describe('My First Test', function() {<br/>    it('Should pass!', function() {<br/>        expect(false).to.equal(true);<br/>    });<br/>});</span></pre><p id="b9a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">保存文件后，测试应该会自动重新运行，您将会看到失败的测试。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/947fec324258809a4aebc04ab885178c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jYnF1k6WKsE9raTNCiWNXQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">考试失败</figcaption></figure><p id="99ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在Cypress测试运行器上点击“stop”来停止测试。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/8e09add4828ced32bf31a61ca2ba7476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6OrgOtNc8WKBy3mjJY4uQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">停止Cypress测试运行程序中的测试运行。</figcaption></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="69b5" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">柏树指挥部</h1><p id="1c92" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在创建第一个真正的测试之前，您需要熟悉Cypress的命令。有些命令可以选择UI中的元素并与之交互，访问网页，清除本地存储，等等。它们可以通过测试中的<code class="fe ni nj nk nl b">cy</code>全局变量来访问。在Typescript的帮助下，VS代码可以建议所有可用的命令。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/17b7350087ee090303ff59fa738b2977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-a17p-p6A1DcluWI6kkxKg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">建议所有可用Cypress命令的Visual Studio代码</figcaption></figure><p id="f730" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在Cypress的API文档中了解所有可用的命令:</p><p id="ba17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://docs.cypress.io/api/api/table-of-contents.html" rel="noopener ugc nofollow" target="_blank">https://docs.cypress.io/api/api/table-of-contents.html</a></p><h2 id="ab14" class="nq lj iq bd lk oa ob dn lo oc od dp ls ko oe of lw ks og oh ma kw oi oj me ok bi translated">访问要测试的页面</h2><p id="284f" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在我们测试一个网页之前，我们需要导航到那个页面。我们可以使用<code class="fe ni nj nk nl b">visit</code>命令来这样做。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="c376" class="nq lj iq nl b gy nr ns l nt nu">cy.visit('http://localhost:3000');</span></pre><p id="1090" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">visit命令接受一个URL，这是我们希望浏览器导航的URL。通常，这是你在测试中要做的第一件事。</p><h2 id="40f1" class="nq lj iq bd lk oa ob dn lo oc od dp ls ko oe of lw ks og oh ma kw oi oj me ok bi translated">查询UI元素</h2><p id="8a7f" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">一旦网页被加载，我们需要找到需要测试的元素。我们使用<code class="fe ni nj nk nl b">get</code>命令来完成这项工作。该命令接受选择器字符串。这个字符串类似于您在CSS和<code class="fe ni nj nk nl b">getQuerySelector</code>函数中用来选择元素的字符串。例如，如果我们想选择一个类别为<code class="fe ni nj nk nl b">.submit-button</code>的按钮，那么我们这样写:</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="70df" class="nq lj iq nl b gy nr ns l nt nu">cy.get('button.submit-button')</span></pre><p id="219e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您还可以在刚刚选择的元素中查找子元素。为此，我们使用了<code class="fe ni nj nk nl b">find</code>命令。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="7038" class="nq lj iq nl b gy nr ns l nt nu">cy.get('.parent').find('.child')</span></pre><h2 id="ab15" class="nq lj iq bd lk oa ob dn lo oc od dp ls ko oe of lw ks og oh ma kw oi oj me ok bi translated">别名元素</h2><p id="e174" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">如果要重复使用刚刚选择的元素。我们可以使用<code class="fe ni nj nk nl b">as</code>命令指定一个别名。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="143e" class="nq lj iq nl b gy nr ns l nt nu">cy.get('button.submit-button').as('submitButton');</span></pre><p id="53d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每当我们想要引用同一个元素时，我们可以简单地使用别名。您应该在别名前面加上<code class="fe ni nj nk nl b">@</code>符号。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="f88c" class="nq lj iq nl b gy nr ns l nt nu">cy.get('@submitButton')</span></pre><h2 id="b1e2" class="nq lj iq bd lk oa ob dn lo oc od dp ls ko oe of lw ks og oh ma kw oi oj me ok bi translated">与UI元素交互</h2><p id="9dcb" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">一旦您选择了一个UI元素，我们就可以使用许多命令中的一个来进行UI交互。例如，如果我们想要点击我们在上一节中选择的按钮，我们调用<code class="fe ni nj nk nl b">click</code>命令。你可以用前面的<code class="fe ni nj nk nl b">get</code>命令来链接它。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="6b8e" class="nq lj iq nl b gy nr ns l nt nu">cy.get('button.submit-button').click();</span></pre><p id="4cdb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要在输入文本框中输入一些文本，我们可以使用<code class="fe ni nj nk nl b">type</code>命令:</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="0bfb" class="nq lj iq nl b gy nr ns l nt nu">cy.get('.my-text-box').type('Hello World!');</span></pre><p id="2c76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有更多的命令与所选的UI元素交互，比如<code class="fe ni nj nk nl b">focus</code>聚焦一个元素，<code class="fe ni nj nk nl b">check</code>选中一个复选框或单选按钮，<code class="fe ni nj nk nl b">select</code>选择一个选项。同样，如果你想寻找一个特定的命令，你可以检查一下<a class="ae kc" href="https://docs.cypress.io/api/api/table-of-contents.html" rel="noopener ugc nofollow" target="_blank"> Cypress API文档</a>的命令部分。</p><h1 id="b365" class="li lj iq bd lk ll ol ln lo lp om lr ls lt on lv lw lx oo lz ma mb op md me mf bi translated">断言</h1><p id="3d76" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">断言检查被测试的对象是否处于预期状态。例如，我们可以使用断言来检查文本输入是否包含我们期望的某个文本。如果断言失败，将导致测试失败。</p><p id="c8db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Cypress已经对它的一些命令做了一些默认断言。例如，<code class="fe ni nj nk nl b">get</code>命令断言被选择的元素存在，并且在DOM中可见。对于大多数测试，您可能仍然希望确保UI处于特定的状态。Cypress允许我们使用<code class="fe ni nj nk nl b">should</code>命令定义显式断言。下面是我们如何测试一个文本输入是否包含文本<code class="fe ni nj nk nl b">"Hello World"</code>。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="da73" class="nq lj iq nl b gy nr ns l nt nu">cy.get('.my-text-input').should('have.value', 'Hello World');</span></pre><p id="af42" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们首先选择想要验证的元素，然后链接对<code class="fe ni nj nk nl b">should</code>函数的调用。第一个参数称为链接器，第二个参数是要测试的值。</p><p id="8d00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">链接器基本上从源组件中提取一个值，我们可以用它来进行比较。Cypress使用<a class="ae kc" href="https://github.com/chaijs/chai" rel="noopener ugc nofollow" target="_blank"> Chai框架</a>来利用它的几十个链接器。</p><p id="5cc5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一些检查所选元素各种属性的断言的例子。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="7716" class="nq lj iq nl b gy nr ns l nt nu">// Checks that the div element<br/>// is visible<br/>cy.get('div').should('be.visible');</span><span id="a641" class="nq lj iq nl b gy oq ns l nt nu">// Checks that the div element<br/>// is not visible<br/>cy.get('div').should('not.be.visible');</span><span id="4caa" class="nq lj iq nl b gy oq ns l nt nu">// Checks whether the button element<br/>// has a class named "primary"<br/>cy.get('button').should('have.class', 'primary');</span><span id="bf02" class="nq lj iq nl b gy oq ns l nt nu">// Checks whether the button element<br/>// does not have a class named "primary"<br/>cy.get('button').should('not.have.class', 'primary');</span><span id="8b46" class="nq lj iq nl b gy oq ns l nt nu">// Checks whether the h1 element<br/>// has an inner text of "Foo"<br/>cy.get('h1').should('have.text', 'Foo');</span><span id="27f8" class="nq lj iq nl b gy oq ns l nt nu">// Checks whether the span element<br/>// has a data attribute<br/>cy.get('span').should('have.attr', 'data');</span></pre><p id="adfa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要获得可用链接器的列表，可以参考Cypress的断言文档页面。</p><div class="ml mm gp gr mn mo"><a href="https://docs.cypress.io/guides/references/assertions.html" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">断言</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">Cypress捆绑了流行的Chai断言库，以及对Sinon和jQuery有用的扩展，为您带来…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">docs.cypress.io</p></div></div><div class="mx l"><div class="or l mz na nb mx nc jw mo"/></div></div></a></div><p id="26aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">VS代码还会建议你可以使用的链接器。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi os"><img src="../Images/9178ee4a249470dc9e1d2edfea28c574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GqS2DaL-_1TXvm1j4y8K0w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">VS代码可以给出一个你可以使用的链接列表</figcaption></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="2d6d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建实际的测试</h1><p id="1692" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">既然我们已经学习了测试示例React应用程序所需的基本命令，让我们继续编写它。我们可以在<code class="fe ni nj nk nl b">cypress/integration</code>中创建一个新的测试文件。</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="e4c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们测试的第一行是调用<code class="fe ni nj nk nl b">visit</code>命令，将我们导航到我们正在测试的react应用程序。下一个代码块选择我们将与之交互的UI元素。注意，我使用了属性选择器来选择具有特定名称的输入元素。您还可以向React组件中的单个元素添加一个类，以便更容易地选择元素。我们使用<code class="fe ni nj nk nl b">as</code>命令给每个元素分配一个别名，这样我们以后就可以引用它们了。</p><p id="067d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的代码块通过为每个UI元素使用相应的交互命令来为每个输入赋值。我们使用在前一个块中创建的别名来引用每个元素。</p><p id="8f5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过点击<code class="fe ni nj nk nl b">@submitButton</code>，我们将被重定向到第二个页面，并显示一条成功消息。我们首先验证当前URL是否在第二个页面中，然后测试成功消息是否存在。</p><p id="be1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在运行这个测试之前，我们首先需要运行React应用程序。</p><pre class="ne nf ng nh gt nm nl nn no aw np bi"><span id="2adb" class="nq lj iq nl b gy nr ns l nt nu">npm start</span></pre><p id="c53f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦应用程序运行，我们就可以运行我们的测试。单击您在Cypress测试运行器中创建的文件来触发测试运行。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ov"><img src="../Images/58b400c1bcfb0562aae8b53191e2cf8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4wrOyC65vYyL6Si6ScKdZw.gif"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Cypress UI测试正在进行</figcaption></figure><p id="aeb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Cypress现在应该执行所有的命令。一旦最后一个命令成功，测试就通过了。</p><h1 id="bf9f" class="li lj iq bd lk ll ol ln lo lp om lr ls lt on lv lw lx oo lz ma mb op md me mf bi translated">结论</h1><p id="805d" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在本教程中，我们学习了如何通过将Cypress安装到现有的React应用程序中来执行UI测试。我们研究了Cypress Test Runner，它是查看和运行项目所有可用测试的主要应用程序。我介绍了如何编写一个基本的Cypress测试。您已经熟悉了大量可以用来查询和交互元素的命令。向您介绍了在Cypress中定义断言。最后，我们运行了基本的Cypress UI测试，并看到了它的运行。感谢阅读。</p></div></div>    
</body>
</html>