<html>
<head>
<title>Exploring Go Packages: Docopt</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索Go包:Docopt</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/go-libraries-docopt-9205414e75e9?source=collection_archive---------10-----------------------#2020-11-10">https://levelup.gitconnected.com/go-libraries-docopt-9205414e75e9?source=collection_archive---------10-----------------------#2020-11-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0cdf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在本教程中，我们将介绍Docopt中的基本概念和帮助消息。您将了解一个您现在就可以编写代码的实际用例。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/271f6f89b489d7fa85d247d00f6c9cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*041L53Z0r1wkCk1Dx5MPaA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">我的一张照片</figcaption></figure><h1 id="8959" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">简要介绍Docopt</h1><p id="1d8d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mj" href="http://docopt.org/" rel="noopener ugc nofollow" target="_blank"> Docopt </a>是一种命令行界面描述语言。它有许多不同编程语言的实现。在本教程中，我们将讨论Go版本:<a class="ae mj" href="https://github.com/docopt/docopt.go" rel="noopener ugc nofollow" target="_blank"> Docopt Go </a>。</p><p id="84ba" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">这个库使程序员能够用结构良好的帮助消息来描述程序接口。</p><h1 id="99d8" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">开始之前</h1><p id="a8a6" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">使用以下命令在您的计算机上安装Docopt:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="68c2" class="mu kw iq mq b gy mv mw l mx my">$ go get -u -v github.com/docopt/docopt.go</span></pre><p id="03ce" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><em class="mz">-u标志指示go get使用网络来更新已命名的包及其依赖项。默认情况下，get使用网络来检查丢失的包，但不使用它来查找现有包的更新。</em></p><p id="22cd" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><em class="mz">-v标志启用详细进度和调试输出。</em></p><p id="ccba" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><em class="mz">参见本</em> <a class="ae mj" href="https://golang.org/pkg/cmd/go/internal/get/" rel="noopener ugc nofollow" target="_blank"> <em class="mz">资源</em> </a> <em class="mz">了解更多关于go get命令的信息。</em></p><p id="a070" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">将库导入您的*。按如下方式转到文件:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="3b8a" class="mu kw iq mq b gy mv mw l mx my">import docopt “github.com/docopt/docopt-go”</span></pre><h1 id="1caa" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">撰写帮助信息</h1><p id="aa5c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">帮助消息(或<em class="mz">用法消息</em>，或<em class="mz">文档</em>)是用户在</p><ul class=""><li id="62d1" class="na nb iq lp b lq mk lt ml lw nc ma nd me ne mi nf ng nh ni bi translated">调用程序，</li><li id="f3e8" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated">键入类似于<code class="fe no np nq mq b">--h</code>或<code class="fe no np nq mq b">-h</code>的标志，</li><li id="8703" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated">键入无效的参数。</li></ul><p id="e0c0" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">该消息包括程序的名称、用途和选项。如果您使用命令行，您已经熟悉帮助消息或用法消息。在Linux中，你通常可以输入<code class="fe no np nq mq b">program --help</code>来获得程序可接受的参数列表。</p><p id="c1b0" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">在本教程中，我们为一个程序编写了一条帮助消息，它输出:</p><ul class=""><li id="fb3b" class="na nb iq lp b lq mk lt ml lw nc ma nd me ne mi nf ng nh ni bi translated">指定数量和范围的随机数列表，或</li><li id="8ad1" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated">特定数量和语言的随机字母列表。</li></ul><p id="3f63" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">这是我们的使用信息:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="6547" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">让我们分析前面消息中的命令numbers:</p><p id="56c5" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><code class="fe no np nq mq b">randx numbers --count &lt;count&gt; [--range &lt;range&gt;...]</code></p><ul class=""><li id="c6cf" class="na nb iq lp b lq mk lt ml lw nc ma nd me ne mi nf ng nh ni bi translated"><code class="fe no np nq mq b">randx </code> —一个程序的名字，</li><li id="e353" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated"><code class="fe no np nq mq b">numbers</code> —一个命令，</li><li id="c706" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated"><code class="fe no np nq mq b">--count</code> —该命令的一个选项，</li><li id="175c" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated"><code class="fe no np nq mq b">&lt;count&gt;</code> —选项的一个值—计数，</li><li id="79f9" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated"><code class="fe no np nq mq b">[--range &lt;range&gt;…]</code> <strong class="lp ir"> </strong> —需要一个或多个值的可选参数。</li><li id="5e1a" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated"><code class="fe no np nq mq b">[--verbose]</code> —可选标志。</li></ul><p id="2d22" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">我们有两个命令，<code class="fe no np nq mq b">numbers</code> <em class="mz"> </em>和<code class="fe no np nq mq b">letters</code> ( <em class="mz">布尔</em>)，分别启用数字或字母模式。如果其中一个是<em class="mz">真</em>，另一个是<em class="mz">假</em>。</p><p id="cc8a" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><code class="fe no np nq mq b">numbers</code>和<code class="fe no np nq mq b">letters</code>命令都需要<code class="fe no np nq mq b">— count</code> <em class="mz"> (int) </em>选项。该程序输出一个指定计数的数字或字母列表。</p><p id="29af" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><code class="fe no np nq mq b">$ randx numbers --count 1</code></p><p id="adb2" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><code class="fe no np nq mq b">$ randx letters --count 1</code></p><p id="2dc6" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">声明可选参数<code class="fe no np nq mq b">--range</code> <em class="mz">(【字符串】)</em>我们用方括号。方括号中的三个点表示您可以向命令提示符传递几个参数。举个例子，</p><p id="3e50" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><code class="fe no np nq mq b">- — range 1,10 --range 1,11</code>或<br/>或<code class="fe no np nq mq b">--range 1-10 --range 1-11</code>或<br/>或<code class="fe no np nq mq b">--range 1:10 --range 1:11</code></p><p id="d0f9" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">此选项设置随机数的范围。如果有两个参数，程序将输出两个具有指定范围的列表。</p><p id="a7ec" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">可选参数，<code class="fe no np nq mq b">--lang </code>、<em class="mz">(字符串)、</em>也在方括号<em class="mz">中。</em>选项<em class="mz"> </em>接受一种语言。因此，程序输出指定语言的字母。</p><p id="8758" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">当未设置必需选项和/或参数无效时，程序必须返回帮助消息。<em class="mz"> </em> <code class="fe no np nq mq b">--range</code>和<code class="fe no np nq mq b">--lang</code>选项都可以省略。</p><p id="af24" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">同样，我们有三个选项(或者只有<em class="mz">标志</em>)在用法信息中没有操作数:</p><ul class=""><li id="5c1e" class="na nb iq lp b lq mk lt ml lw nc ma nd me ne mi nf ng nh ni bi translated"><code class="fe no np nq mq b">-h / --help</code> —输出使用信息，</li><li id="e43b" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated"><code class="fe no np nq mq b">--verbose</code> <em class="mz"> — </em>输出一个程序做什么的细节；该标志用于通知用户程序实际做了什么，包括执行所需操作时的错误。这有助于解决问题。</li><li id="55f8" class="na nb iq lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated"><code class="fe no np nq mq b">--version</code> —输出您使用的程序版本。</li></ul><h1 id="e1d3" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">编写代码</h1><p id="9dfb" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Docopt可以解析结构中的所有命令行参数。为了实现这一点，创建一个新的结构，将其命名为config，并根据前面讨论的文档定义所有字段:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="6762" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">在这个结构中，我们指定了每个命令、标志和选项。如果您想声明短选项名和长选项名，请键入<br/> <code class="fe no np nq mq b">docopt:"-short_name,--long_name".</code>例如:<code class="fe no np nq mq b">docopt:"-c,--count".</code></p><p id="2f9d" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">在var()部分声明您的帮助消息:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="319a" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">用<code class="fe no np nq mq b">docopt.ParseArgs()</code>方法解析参数。返回值是一个包含所有参数的映射。然后，将映射绑定到给定的结构。当程序初始化时，我们需要解析所有的参数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="fe95" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">我们将程序的版本指定为<code class="fe no np nq mq b">docopt.ParseArgs(usage, nil, "version_is_here")</code>方法中的最后一个参数。当选项<code class="fe no np nq mq b">--version</code>被调用时，程序打印版本。</p><p id="c0f5" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">若要访问结构字段，请使用点:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h1 id="8f85" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">用法</h1><p id="d6f7" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在本节中，您可以找到在命令行中使用Docopt的几种情况。</p><h2 id="6bf0" class="mu kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">字母模式</h2><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="cba6" class="mu kw iq mq b gy mv mw l mx my">$ go run main.go letters --count 9<!-- --> <br/>$ go run main.go letters -c 9</span><span id="5b56" class="mu kw iq mq b gy oe mw l mx my">letters: true<br/>--<!-- -->count: 9<br/>--<!-- -->lang:<br/>--<!-- -->verbose: false</span><span id="58f8" class="mu kw iq mq b gy oe mw l mx my">$ go run main.go letters --count 9 --lang en<!-- --> <br/>$ go run main.go letters -c 9 -l en</span><span id="72bd" class="mu kw iq mq b gy oe mw l mx my">letters: true<br/>--count: 9<br/>--lang: en<br/>--verbose: false</span></pre><h2 id="7cf8" class="mu kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">数字模式</h2><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="43f0" class="mu kw iq mq b gy mv mw l mx my">$ go run main.go numbers --count 9<!-- --> <br/>$ go run main.go numbers -c 9</span><span id="f9b1" class="mu kw iq mq b gy oe mw l mx my">numbers: true<br/>--count: 9<br/>--range: []<br/>--verbose: false</span><span id="e6c7" class="mu kw iq mq b gy oe mw l mx my">$ go run main.go numbers --count 10 --range 9,10<!-- --> <br/>$ go run main.go numbers -c 10 -r 9,10</span><span id="2606" class="mu kw iq mq b gy oe mw l mx my">numbers: true<br/>--count: 10<br/>--range: [9,10]<br/>--verbose: false</span><span id="ffc6" class="mu kw iq mq b gy oe mw l mx my">$ go run main.go numbers --count 10 --range 9,10 --range 0,15</span><span id="a9b3" class="mu kw iq mq b gy oe mw l mx my">numbers: true<br/>--count: 10<br/>--range: [9,10 0,15]<br/>--verbose: false</span></pre><h2 id="a1ce" class="mu kw iq bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">冗长</h2><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="1cb0" class="mu kw iq mq b gy mv mw l mx my">$ go run main.go numbers --count 18 --range 9,19 --verbose <br/>$ go run main.go numbers -c 18 -r 9,19 --verbose</span><span id="3c70" class="mu kw iq mq b gy oe mw l mx my">numbers: true<br/>--count: 18<br/>--range: [9,19]<br/>--verbose: true</span></pre></div><div class="ab cl of og hu oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ij ik il im in"><h1 id="8909" class="kv kw iq bd kx ky om la lb lc on le lf jw oo jx lh jz op ka lj kc oq kd ll lm bi translated">关于作者</h1><p id="73ff" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Jane是一名围棋程序员和软件工程方面的技术作家。她已经用英语和俄语写了5年的技术资料。她从新西伯利亚国立技术大学获得了信息安全专业学位，专攻自动化系统的信息安全。你可以在 <a class="ae mj" href="https://twitter.com/enthusiastic_io" rel="noopener ugc nofollow" target="_blank"> <em class="mz"> Twitter </em> </a> <em class="mz">上关注她，在</em><a class="ae mj" href="https://publications.enthusiastic.io/" rel="noopener ugc nofollow" target="_blank"><em class="mz">publications . excellent . io</em></a><em class="mz">上看她的其他文字作品。</em></p></div></div>    
</body>
</html>