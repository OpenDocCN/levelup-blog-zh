<html>
<head>
<title>How to Improve the Style of Your Codebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何改进代码库的风格</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-improve-the-style-of-your-codebase-e5f2c8fa00fc?source=collection_archive---------7-----------------------#2022-02-28">https://levelup.gitconnected.com/how-to-improve-the-style-of-your-codebase-e5f2c8fa00fc?source=collection_archive---------7-----------------------#2022-02-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="faa6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你的生活更快乐更轻松。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/54fd85746d0ac670ec4cfee74815330b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ifYb3jjDhDWXvfDS5zO5AQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">约书亚·阿拉贡在<a class="ae ky" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="5b6f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="30bc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我来描述一个常见的场景:假设你是一家知名公司开发团队的新软件工程师。当你到达那里时，你会看到许多正在进行的项目。像往常一样，有些是新的，有些是遗留系统，每个人都不敢碰。</p><p id="dec1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，您的第一个任务是熟悉代码库，您意识到甚至没有关于如何设置开发环境的自述文件。创建项目的人已经不在公司了，经过几天和一些黑客攻击，你可以让项目在你的电脑上运行，你也可以放心地从待办事项中取出一张bug修复单。</p><p id="529f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你读的代码越多，你就越想把自己的眼睛挖出来。可能这不是因为有不好的实践(希望如此)，但问题是这个项目已经被分发了很多次，每个人都留下了不一致的风格。</p><p id="5c9c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文将帮助您解决这个问题，我们首先列出一些重要的定义，然后探索格式化代码的工作流程，最后给出一些建议和结论。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="2990" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">定义</h1><h2 id="da47" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">代码风格指南</h2><p id="5506" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">风格指南是一套关于如何用特定的编程语言编写代码的固执己见的规则和约定。尽管遵循一个风格指南并不是你的代码工作的强制要求，但这确实是一个改善团队对项目感觉的好方法。</p><h2 id="3cb4" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">代码样式检查器</h2><p id="ac94" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设你和你的团队同意遵循一个风格指南，但是我们是人，尽管我们有意识地想要遵循所有的规则。他们有很多，很难将他们纳入我们的工作流程。因此，样式检查器是一种工具，它会在您的代码遵循特定的样式指南时通知您，这将使在项目中包含样式指南变得更加容易。</p><p id="9b85" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">样式检查器可以是IDE插件的形式，也可以是您的构建系统的插件。确保一旦选择了新工具，所有团队都同意使用新工具，并且有一些文档可供新团队成员使用。</p><p id="ecce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为构建系统选择插件时，确保您可以配置它，这样如果代码没有遵循样式指南，构建就会失败。这将防止向产品中添加不符合的代码。</p><h2 id="a775" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">代码格式化程序</h2><p id="6ebb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">代码格式化程序是一种使用样式指南自动格式化代码的工具。这些格式化程序可以以多种形式出现，比如IDE格式化程序的配置、插件，甚至是集成到构建系统中的工具。</p><p id="9c7c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一些样式的改变不是侵入性的，比如一些间距或者导入的组织顺序。但是要考虑到一些变化更加激进，比如重命名一个类或者一个变量。</p><p id="7adf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">不幸的是，对于像前面提到的那些侵入性的改变，你需要自己介入并做出那些改变。确保有一些自动化的测试，这样你就有信心那些变化不会破坏你的系统。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="8e3c" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">工作流程</h1><p id="28d4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">定义出来之后，让我们定义一组步骤，通过所有代码库合并一个风格指南。</p><ol class=""><li id="92ab" class="nq nr it lt b lu mn lx mo ma ns me nt mi nu mm nv nw nx ny bi translated">选择一个风格指南，并确保你的团队参与其中。开始寻找的一个好地方是<a class="ae ky" href="https://github.com/google/styleguide" rel="noopener ugc nofollow" target="_blank">谷歌风格指南</a>，在那里你可以找到谷歌为不同编程语言提供的所有风格指南。如果你的编程语言不在那里，或者你喜欢另一种风格指南，网上有大量关于它的信息。只要确保样式指南支持您正在使用的语言版本。还要检查它是否是最新的，是否得到了积极的维护。</li><li id="53b2" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">为您的生成系统选择一个样式检查器，它支持在上一步中选取的所选样式指南。这里的要求是，在某种程度上，您可以防止在违反样式的情况下构建项目的工件。</li><li id="056c" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">在您的IDE上配置一个样式检查器，这很重要，当您编码时，您可以收到关于样式的反馈，这样您就可以当场进行更改。</li><li id="cfa8" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">为您的构建系统选择一个格式化程序，这样代码就可以自动格式化，而不依赖于任何特定的IDE。</li><li id="5f59" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">按照样式指南配置IDE的格式化程序。如果这是不可能的，尝试寻找一个插件。尽管由于编译系统中的格式化程序，这一步不是强制性的，但有时在您的IDE中使用它会更方便。</li><li id="67f2" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">用选择的样式检查器扫描你的代码，可能会有很多错误。不要惊慌。</li><li id="61fa" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">应用格式化程序，然后用样式检查器再次检查。我确信以前的大部分错误都会得到解决。但是，对于格式化程序来说，自动完成其他的修改太困难或太麻烦了，所以在这种情况下，您需要自己进行这些修改。</li><li id="60ad" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">执行自动化测试，这样你就能确保一切都按预期运行。</li><li id="f2a2" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">一旦所有代码都格式化了，就在构建过程中强制使用样式指南。将样式检查器配置为如果新代码不符合样式指南，则不允许成功生成，这将防止将来将不符合的代码添加到项目中。</li></ol></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="f1ef" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">推荐</h1><ul class=""><li id="719f" class="nq nr it lt b lu lv lx ly ma oe me of mi og mm oh nw nx ny bi translated">我再强调这一点也不为过，确保你的团队在船上。就此展开讨论，并尝试就风格指南达成一致意见。</li><li id="8356" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm oh nw nx ny bi translated">确保样式指南得到有效维护，并且支持您的编程语言版本。</li><li id="eb4a" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm oh nw nx ny bi translated">一致的风格带来了许多好处，其中之一是新团队成员很容易接手项目。确保所有过程都有记录。</li><li id="1311" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm oh nw nx ny bi translated">将所有代码格式化为兼容的可能被视为浪费时间，但是要保持一致。最终这将是值得的。</li><li id="2a7d" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm oh nw nx ny bi translated">如果没有任何形式的自动化测试，在格式化所有代码之前先添加一些可能是个好主意。可以是一种集成测试的形式，因此您可以有一个额外的保护屏障，即系统在格式化后的行为符合预期。</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="6c4e" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated"><strong class="ak">结论</strong></h1><p id="70c1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有时候继承项目很糟糕，我的意思是有时候项目没有遵循任何风格，没有文档，或者语言的版本过时了，你不能使用美妙的新特性。但是现实是，继承项目是很常见的，我希望有了这个指南，你可以使从事这类项目变得更加愉快。</p><p id="6e76" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe oi oj ok ol b"><strong class="lt iu">Whant articles like this for specific programming languages? </strong>Follow me so you could be notified when I am posting new content.</code></p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="6613" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">资源</h1><ul class=""><li id="c711" class="nq nr it lt b lu lv lx ly ma oe me of mi og mm oh nw nx ny bi translated"><a class="ae ky" href="https://github.com/google/styleguide" rel="noopener ugc nofollow" target="_blank">谷歌风格指南</a></li><li id="ea1f" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm oh nw nx ny bi translated"><a class="ae ky" href="https://github.com/diffplug/spotless" rel="noopener ugc nofollow" target="_blank">一尘不染</a></li><li id="fa98" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm oh nw nx ny bi translated"><a class="ae ky" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank">更漂亮</a></li></ul></div></div>    
</body>
</html>