<html>
<head>
<title>How to Scrape Your Statistics from Quora using Python 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python 3从Quora中抓取统计数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/scraping-your-statistics-from-quora-using-python-3-74d33413cae6?source=collection_archive---------8-----------------------#2020-07-23">https://levelup.gitconnected.com/scraping-your-statistics-from-quora-using-python-3-74d33413cae6?source=collection_archive---------8-----------------------#2020-07-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/fbb70f25670e04162eb59302b4a12f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*JhJ3WYFLfwXqa0BD8BLsXg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">图片取自<a class="ae jy" href="https://blog.swiftype.com/2017/08/03/top-site-search-questions-on-quora/" rel="noopener ugc nofollow" target="_blank">此处</a></figcaption></figure><p id="0814" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">拥有超过<a class="ae jy" href="https://expandedramblings.com/index.php/quora-statistics/" rel="noopener ugc nofollow" target="_blank"> 3亿月活跃用户</a>，Quora是一个非常重要的平台。你不能从你的社交媒体策略上忽视它。我是说，你可以，只是这不明智。你可以了解人们在问什么，并思考你或你的品牌。或许，也有你的社交媒体团队在那里代表你。在这个平台上，情感分析和线索挖掘有很大的空间。</p><p id="e53d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">作为我正在进行的一个项目的一部分，来自Quora和其他社交媒体的统计数据需要被提取出来，以便在一个集成的仪表板上进行分析。而且有点痛苦。与脸书、Instagram和谷歌My Business不同，Quora不为我们提供任何API。从网站上抓取数据是唯一的选择。但是我们系紧鞋带，啜饮能量饮料。枪响了，我们出发了，搜集与我们有关的问题和答案。一切都很顺利，直到我们点击Quora统计页面。(查看你在quora.com/stats<a class="ae jy" href="http://quora.com/stats" rel="noopener ugc nofollow" target="_blank">的统计数据)</a></p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kx"><img src="../Images/ede5ee7474837d5ddae13b35a5d09c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JdOclo6Ikl8Jrs5ypp0XBA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">Quora统计页面</figcaption></figure><p id="86dd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">你可能会问，这有什么大不了的？将页面拖入BeautifulSoup，美化它，研究代码，然后回到这里。我会等着的。</p><p id="c719" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果你在这里，我猜你同意代码是一团乱麻(从刮擦的角度来看)。任何地方都没有直接的值(我们必须处理高度)和出于某种原因的大量重复代码。经过深思熟虑、谷歌搜索和阅读Quora答案后，我得出的结论是，除了对图表中的数据进行逆向工程(具有讽刺意味的是，在集成仪表板上构建其他图表)，没有其他办法。</p><p id="17ed" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我很惊讶地发现没有人已经这样做了，并与社区分享他们的工作。我不是说没人做过，只是我找不到做过的人。所以决定分享一下，希望对某个人有帮助。</p><p id="a1c1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这篇文章将有希望给你如何去做的逻辑，你可以用你自己的方式实现它。如果你需要具体的帮助，我的GitHub在最后有链接。所以，让我们一步一步来。</p><ol class=""><li id="8fc3" class="lg lh iq kb b kc kd kg kh kk li ko lj ks lk kw ll lm ln lo bi translated"><strong class="kb ir">获取所需时间段</strong></li></ol><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lp"><img src="../Images/5dfb7ed2b4221b07a463201820ced8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLSO04iW9S-73M03-HimaA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">选择“过去7天”选项</figcaption></figure><p id="c31b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">默认情况下，下拉列表中选择的选项是“过去30天”。对我们来说，抓取脚本将每天运行，因此尽可能缩短持续时间是有意义的。</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="ca74" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">账户是一个链接到我们数据库的sqlalchemy对象。<strong class="kb ir">驱动</strong>是一个selenium webdriver。<strong class="kb ir"> login_to_account </strong>是我们定义的一个函数，让我们的<strong class="kb ir">驱动程序</strong>根据其凭证登录到<strong class="kb ir">帐户</strong>。<strong class="kb ir"> LOAD_TIME </strong>是为我们这些<em class="ls">有</em>担心网速的人准备的。3对我来说很好。页面被捕获在<strong class="kb ir">汤</strong>中。</p><p id="e627" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">2.<strong class="kb ir">从X轴获取日期</strong></p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lp"><img src="../Images/f29ab6adaccb995ca0aaf80ea1a5ec5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eI1WEhg-P2HCosFyHBHNKw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">X轴上的日期</figcaption></figure><p id="b8fd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">下面的代码只需要运行一次，因为所有3个图形在X轴上都有相同的日期。</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="98db" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> datetime </strong>取自python中的datetime模块。<strong class="kb ir"> strip() </strong>函数去除字符串前后的空格。</p><p id="49da" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在上面的代码中有两点需要注意。首先，X轴日期的代码在页面上重复了多次，因此需要检查日期是否重复。遇到重复的日期时，搜索<strong class="kb ir"> last_tick </strong>类以获得最后的日期，然后退出循环。其次，因为图中只提到了月和日，所以如果年份在一周之间变化，就需要检查。您不希望一周中从12月30日开始到1月5日结束的所有日子都是同一年。</p><p id="f9f1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">3.<strong class="kb ir">获取图形数据</strong></p><p id="1d1e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">对于3个图表中的每一个，Y轴上的单位可以不同。此外，X轴上的条形没有与之关联的固定值，它们使用高度变量进行渲染。因此，我们需要计算Y轴上1个单位的高度，然后使用每个日期的条形高度，以数学方式计算每个日期的值。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lp"><img src="../Images/15d7ffe18de6d4f8dcae75ed20181564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xwmb8cGGbhU9ImGXrAo8hg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">y轴值</figcaption></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lp"><img src="../Images/cf840c92c97727ebb6e3c201da413472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOrBlIAdSrm1Kjre8UhFWQ.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">酒吧的高度</figcaption></figure><p id="cbf9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">下面的代码可以在所有3个图形中循环运行</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="6f40" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们通过搜索类别中有<strong class="kb ir"> stats_graph </strong>但没有<strong class="kb ir">隐藏</strong>的<strong class="kb ir"> g </strong>标签来搜索未隐藏的图形。<strong class="kb ir"> replace_all(string，dictionary) </strong>是我们定义的一个函数，它将通过用所提供的字典中的相应值替换键来返回所提供的字符串。</p><p id="5bc9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在函数的前半部分，我们得到一个单位在Y轴上的高度。一个等级可以代表1或5或100或任何其他数字，这取决于规模。由于该账户在任何一天的最大浏览量是4，Quora统计页面选择每一级显示1个单位。比较两个水平，用一点数学，我们得到一个单位的高度。然后我们用更多的数学计算每个矩形条代表多少单位。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/6714cbb4d8ec0c53c4c8e21df5ec7c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*uJ90HwUaxpn0eXaEG4ifTA.png"/></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="4730" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">差不多就是这样！我还没有详细介绍如何循环这些图，以及如何将数据保存在数据存储中，因为这不是本文的目的。希望您能了解如何在自己的项目中执行这一点！</p><p id="3bab" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在我的<a class="ae jy" href="https://github.com/jas-haria/VOID_0.1" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到上面的代码和项目其余部分的代码。您也可以通过我的<a class="ae jy" href="https://www.linkedin.com/in/jas-haria/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系。</p><p id="9c03" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果你喜欢这篇文章，请考虑留下掌声。或者二十。</p><p id="41e1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">查看我的一些其他文章:</p><p id="6afe" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae jy" href="https://link.medium.com/euDXN12Be9" rel="noopener">如何为你的应用实现用户友好的分页</a></p></div></div>    
</body>
</html>