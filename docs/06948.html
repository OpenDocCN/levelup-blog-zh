<html>
<head>
<title>The Dangerous Myth of 100% Code Coverage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">100%代码覆盖率的危险神话</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-dangerous-myth-of-100-code-coverage-42d0e3ad83f3?source=collection_archive---------2-----------------------#2021-01-13">https://levelup.gitconnected.com/the-dangerous-myth-of-100-code-coverage-42d0e3ad83f3?source=collection_archive---------2-----------------------#2021-01-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/50b71724be60d32999dfe9fb775f7c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YtCkrjrzIcvsYCJ6"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@siora18?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Siora摄影</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="c516" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你听到单元测试人群的命令了吗？我们必须开悟。我们必须实现100%的代码覆盖率！任何没有达到100%代码覆盖率的项目都是<em class="le">垃圾！</em></p><p id="53ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个吸引人的论点。如果我们接受测试对代码有益这一逻辑论点，那么似乎可以得出这样的结论:覆盖100%代码的更多测试会更好，对吗？</p><h1 id="0fed" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">代码覆盖率很高</h1><p id="b0cb" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">这是真的，代码覆盖率很高。这绝对是我们应该努力争取的事情。这是一个足够简单的论点，而且在大多数情况下都成立——铺垫！</p><p id="cec1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从长远来看，被好的测试100%覆盖的好代码只会让你的项目更加强大。这就是我们一直在寻找的乌托邦，天啊，这是我们应得的，不是吗？</p><h1 id="200b" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">TDD可以帮助我们达到100%的覆盖率</h1><p id="3197" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">当然，测试驱动开发要求你写的任何一行代码都要被相应的测试覆盖。如果你正确地进行TDD，你将会达到100%的代码覆盖率。</p><p id="d9a7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就这么简单。</p><p id="96b5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以答案是TDD，我们到此为止，对吗？</p><p id="a2d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你为什么还在读书？</p><p id="fa07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">哦，对了，我忘了:<em class="le">神话！</em></p><h1 id="f52b" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">100%的覆盖率并不能解决糟糕代码的问题</h1><p id="c32b" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">不管是否被测试覆盖，坏代码就是坏代码。但是我所说的“糟糕的代码”是什么意思呢这只是我主观和判断吗？我认为任何不使用类型声明或者保护子句的代码都是糟糕的代码吗？</p><p id="b0d4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嗯，是的，但这不是我在这里说的。</p><p id="2019" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我在这里对坏代码的定义更深入。坏代码是任何看起来只做了它应该做的事情的代码。</p><p id="9102" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是100%代码覆盖率的神话。</p><h1 id="4280" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">编程从解决问题开始</h1><p id="675b" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">在我的职业生涯中，我有不止一个项目保持了100%的代码覆盖率，被移交给客户，只是被返回给我，并声明“这不是我们所要求的。”</p><p id="c1b5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们只关注我们的测试覆盖了多少代码，我们可以忽略关注我们的代码覆盖了多少问题。</p><h1 id="eea3" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">覆盖的代码仍然可能有错误</h1><p id="ce3a" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">我们不能让自己被欺骗，把代码覆盖率等同于无bug。我们在初始TDD期间创建的测试与我们在修复bug时创建的测试是不同的。</p><p id="d40d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在第一次构建的路径中覆盖了所有的代码，但这并不意味着我们是正确的，或者那些相同的路径不能以我们没有想到的其他方式使用。</p><p id="af50" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">覆盖代码只证明它已经被测试证明的东西。</p><p id="1756" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">任何未测试的——但是被覆盖的——最终都需要回归测试。</p><h1 id="8b2f" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">未写的代码不会降低覆盖率</h1><p id="ed37" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">如果你需要更多的证据来证明代码覆盖率不等于高质量的代码，只要看看我刚刚写的这个社交网络代码就知道了:</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="3b70" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个完美的，100%代码覆盖的社交网络。</p><p id="a0be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是你认为它作为一个社交网络有多好呢？不太可能。那是因为不成文的代码不会降低覆盖率。没有一个快速的标准来衡量我们有多少问题没有解决。</p><p id="0f46" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们只有需求文档和经验。</p><h1 id="5fba" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">所以，我不应该担心代码覆盖率？</h1><p id="f2d4" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">我根本不是这个意思。你应该担心它，但它不应该是你的第一个或最大的担心。</p><p id="3485" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你的第一个，也是最大的关注点应该是解决你所面临的问题。这是我们工作的一部分。</p><p id="3924" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您的第二个关注点应该是确保该问题的需求已经以可重复和自动化的方式被规划出来，并被单元、特性、集成和/或验收测试所覆盖。</p><p id="f88e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦覆盖了前两件事，<em class="le">然后</em>我们可以担心100%的代码覆盖率。</p><p id="fdf1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我敢说，100%覆盖但在需求中什么都不做的代码比0%覆盖但在需求中做了所有事情的代码更糟糕。</p><p id="c7c1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我们可以随时回溯并添加测试。100%覆盖的不做任何事情的代码只是一个你没有完成的项目。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><p id="73f7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">如果你对这篇文章感兴趣，你会爱上我的Twitter上的技术意识流。</em> <a class="ae kf" href="https://twitter.com/n00bJackleCity" rel="noopener ugc nofollow" target="_blank"> <em class="le">头那边，给我跟着</em> </a> <em class="le">。你不会失望的。</em></p></div></div>    
</body>
</html>