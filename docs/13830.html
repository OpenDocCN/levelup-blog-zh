<html>
<head>
<title>How to Manage Code Quality With Git</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Git管理代码质量</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-automate-code-quality-checks-with-git-hooks-8cf3e3ef383e?source=collection_archive---------13-----------------------#2022-10-10">https://levelup.gitconnected.com/how-to-automate-code-quality-checks-with-git-hooks-8cf3e3ef383e?source=collection_archive---------13-----------------------#2022-10-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="158e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在提交或推动工作之前，学习如何自动化工具的执行</h2></div><blockquote class="ki kj kk"><p id="d198" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在本文中，我假设您有一个用Git版本控制的项目。我将提醒你<strong class="ko iu">提交</strong>、<strong class="ko iu">发布</strong>和<strong class="ko iu">拉动</strong>一个分支的历史的概念。</p></blockquote><p id="6456" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">为了控制软件项目的质量，您应该使用工具来检查语法或运行测试。</p><p id="b029" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">在PHP生态系统中，除了<a class="ae ll" href="https://phpunit.de/documentation.html" rel="noopener ugc nofollow" target="_blank"> PHPUnit </a>之外，你还可以使用类似<a class="ae ll" href="https://phpstan.org/user-guide/getting-started" rel="noopener ugc nofollow" target="_blank"> PHPStan </a>的工具来检查你的代码质量。和其他同等的工具。</p><p id="3aca" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">通过<strong class="ko iu">配置Git </strong>，您将永远提高项目的质量。</p><p id="4fb9" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">您将学习如何<strong class="ko iu">防止提交质量差的代码</strong>。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/2b07c00b0d4f04d6ed2eda65a2b4345d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FVR-1VCfdkXyhh0O"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">Git历史由<a class="ae ll" href="https://unsplash.com/@yancymin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Yancy Min </a></figcaption></figure><h2 id="4114" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lj mo mp mq lk mr ms mt mu bi translated">两分钟后出发</h2><p id="ec78" class="pw-post-body-paragraph kl km it ko b kp mv ju kr ks mw jx ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">Git是一个允许将一组修改关联到消息的系统。Git将所有这些操作——或者说<strong class="ko iu">提交</strong>——保存在历史中。我们可以把它想象成一本记录一个软件项目运作的账本。</p><p id="1c80" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">然后，一个git <strong class="ko iu">分支</strong>对应于主项目的一个替代版本。开发人员可以在不干扰其他团队成员工作的情况下开发新功能。</p><p id="31cb" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">然后，他们将把项目的两个版本合并成一个。</p><p id="f7db" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">然后，他们在Git服务器上部署(或<strong class="ko iu">推送</strong>)新的项目版本。此时，每个人都可以检索到最新的可用版本。</p><p id="3829" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">当您请求Git服务器上的最新更改时，您正在执行<strong class="ko iu">拉</strong>操作。</p><blockquote class="ki kj kk"><p id="1aaf" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">换句话说，您检索的是最新版本的图书帐户。</p></blockquote><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi na"><img src="../Images/8e94e45db80096a5e0c812e615b21555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFa58ZRX_H-9dayW_RPfXw.jpeg"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">演职员表:<a class="ae ll" href="https://medium.com/@mickael-andrieu/" rel="noopener">米凯尔·安德烈</a></figcaption></figure><p id="1d05" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">您可能不知道<strong class="ko iu">可以在它们之间执行操作</strong>。</p><blockquote class="nb"><p id="81ce" class="nc nd it bd ne nf ng nh ni nj nk lh dk translated">您可以挂接到这些Git操作之一，并触发您的操作。</p></blockquote><ul class=""><li id="87de" class="nl nm it ko b kp nn ks no li np lj nq lk nr lh ns nt nu nv bi translated">如果你在Git操作的之前挂接<strong class="ko iu">，这是一个<strong class="ko iu"> pre </strong>挂接。</strong></li><li id="5328" class="nl nm it ko b kp nw ks nx li ny lj nz lk oa lh ns nt nu nv bi translated">如果你在Git操作的之后挂钩<strong class="ko iu">，这是一个<strong class="ko iu"> post </strong>挂钩。</strong></li></ul><h2 id="144c" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lj mo mp mq lk mr ms mt mu bi translated">什么是Git Hook？</h2><p id="7b9a" class="pw-post-body-paragraph kl km it ko b kp mv ju kr ks mw jx ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">假设你来自WordPress或者PrestaShop生态系统。</p><p id="16db" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">在这种情况下，这个概念已经和你说话了。</p><blockquote class="nb"><p id="9642" class="nc nd it bd ne nf ng nh ni nj nk lh dk translated">Git挂钩<strong class="ak">是贯穿每个可能的动作</strong>的生命周期“传播”的事件。</p></blockquote><p id="7d21" class="pw-post-body-paragraph kl km it ko b kp nn ju kr ks no jx ku li ob kx ky lj oc lb lc lk od lf lg lh im bi translated">如果您是前端开发人员，您的web页面的DOM中也有类似的事件系统！</p><p id="0562" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">考虑一个经典的操作:您想要进行更改并部署到Git服务器。下面是一个总结了可用挂钩的模式:</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi oe"><img src="../Images/462e0a7a81b436ba256f6a8d98fc4a89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LkuhvzpIrfbs3EZp4VWsGw.jpeg"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">图式由<a class="ae ll" href="https://medium.com/@mickael-andrieu/" rel="noopener">作者</a>创建</figcaption></figure><p id="60f2" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">当您执行一条指令时，Git将分派钩子并执行指令(如果有的话)。</p><p id="13fa" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><strong class="ko iu">当你完成一个动作时，Git分派钩子并执行指令。</strong></p><p id="4a41" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">你感兴趣的是有钩子挡住了(黄色和红色)。如果指令返回错误代码:</p><ul class=""><li id="202a" class="nl nm it ko b kp kq ks kt li of lj og lk oh lh ns nt nu nv bi translated"><strong class="ko iu">预提交</strong>钩子将停止提交的创建；</li><li id="6fb3" class="nl nm it ko b kp nw ks nx li ny lj nz lk oa lh ns nt nu nv bi translated"><strong class="ko iu">预推</strong>钩子将阻止在Git服务器上部署分支；</li></ul><blockquote class="nb"><p id="0041" class="nc nd it bd ne nf oi oj ok ol om lh dk translated">这对你来说是个好消息！现在，如果您在项目中引入了一个bug，就会有返回错误代码的指令！</p></blockquote><p id="534c" class="pw-post-body-paragraph kl km it ko b kp nn ju kr ks no jx ku li ob kx ky lj oc lb lc lk od lf lg lh im bi translated">最后，选择是否拒绝提交，在这种情况下，每次提交都是有质量的。</p><p id="3f51" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">换句话说:</p><ul class=""><li id="7f93" class="nl nm it ko b kp kq ks kt li of lj og lk oh lh ns nt nu nv bi translated">您应该在每次创建提交时测试质量吗？</li><li id="2e81" class="nl nm it ko b kp nw ks nx li ny lj nz lk oa lh ns nt nu nv bi translated">或者当你推你的树枝的时候？</li></ul><p id="7daf" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">第一种解决方案有时<strong class="ko iu">很痛苦，但会形成</strong>，而第二种是<strong class="ko iu">在你的日常事务中更加宽容</strong>。如果您使用<a class="ae ll" href="https://dev.to/cbillowes/why-i-create-atomic-commits-in-git-kfi" rel="noopener ugc nofollow" target="_blank">原子提交</a>，我推荐第二种方法。</p><h2 id="620a" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lj mo mp mq lk mr ms mt mu bi translated">如何触发Git挂钩</h2><p id="f102" class="pw-post-body-paragraph kl km it ko b kp mv ju kr ks mw jx ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">您的项目包含一个名为<strong class="ko iu">的文件夹。在你的代码编辑器或操作系统可能隐藏的根目录下。你会在<strong class="ko iu">中找到。git/hooks </strong>子文件夹每个git挂钩的示例脚本列表:</strong></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi oo"><img src="../Images/a3335a2a5a1b25fe04b65b6ea6ed971d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ItfaL_Lq5PNKqvfhgku7cw.jpeg"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">所有示例文件都有扩展名。样品</figcaption></figure><p id="f0ee" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">只需<strong class="ko iu">删除文件扩展名</strong>或复制文件并重命名即可:</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="1ad0" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">该文件包含一个您可以删除的示例。</p><p id="e176" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">然后，您使用操作<strong class="ko iu">修改创建的文件，以运行您的“测试套件”</strong>。假设您正在使用PHPUnit:</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="007e" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">你可以用一个<strong class="ko iu">钩子让反馈</strong>结果更加明显和有用。</p><p id="0987" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">有关启用颜色的预提交操作，请参见以下脚本:</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="op oq l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">您需要Bash的基础知识来改进这个脚本。</figcaption></figure><p id="d404" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">你必须修改文件，添加修改，并提交一些东西来触发脚本。</p><p id="372c" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">这是我的一个项目的例子(gif格式):</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi or"><img src="../Images/ac2c144808f49822eba7a8dc6e84accc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*cpJMDEupk85KWNcbs85Qqg.gif"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">哎呀！我必须先解决这些问题，然后才能“提交”我的工作⛔</figcaption></figure><h2 id="1936" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lj mo mp mq lk mr ms mt mu bi translated">如果我需要提交怎么办？🤔</h2><p id="de37" class="pw-post-body-paragraph kl km it ko b kp mv ju kr ks mw jx ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">虽然我<strong class="ko iu">劝阻</strong>你不要违反你制定的规则，但你可以<strong class="ko iu">阻止钩子的传播。</strong></p><p id="a74a" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">您需要在git命令的参数列表中添加“<strong class="ko iu"> no-verify </strong>”:</p><pre class="ln lo lp lq gt os ot ou ov aw ow bi"><span id="f5c3" class="mc md it ot b gy ox oy l oz pa">git commit . -m 'Will ignore pre-commit hook' --no-verify</span></pre><p id="f9d9" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">这篇文章现在完成了！我希望它对你有帮助🙏</p><blockquote class="ki kj kk"><p id="16bd" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">您可以重用我在文章中分享的脚本，并根据您的需要进行修改。</p></blockquote><p id="3b8a" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">最后，如果你有任何问题或者改进的建议，不要犹豫，在评论区告诉我。</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><p id="00b3" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">如果你喜欢这篇文章，<a class="ae ll" href="https://medium.com/@mickael-andrieu/" rel="noopener">关注我</a>，我会在发布以后的文章时通知你！</p><div class="pi pj gp gr pk pl"><a href="https://medium.com/@mickael-andrieu/membership" rel="noopener follow" target="_blank"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">通过我的推荐链接加入Medium-mickal Andrieu</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">medium.com</p></div></div><div class="pu l"><div class="pv l pw px py pu pz lw pl"/></div></div></a></div></div></div>    
</body>
</html>