<html>
<head>
<title>Hilt — The Future of Dependency Injection in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">hilt——Android中依赖注入的未来</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/hilt-the-future-of-dependency-injection-in-android-e9a919c0993d?source=collection_archive---------7-----------------------#2020-06-27">https://levelup.gitconnected.com/hilt-the-future-of-dependency-injection-in-android-e9a919c0993d?source=collection_archive---------7-----------------------#2020-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6c99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Android上使用DI的标准方式</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b6b762d4b2fa03119e32b76fd2388909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yt4FDwUrJ2PD0d7f"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h1 id="58a1" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">依赖注入</h1><p id="1e60" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">依赖注入(DI)是任何编程语言的关键原则之一。DI是一种用于向依赖类提供依赖关系或对象的技术。也就是说，一个类可能需要其他类对象来做一些工作，所以我们提供这些对象的方式就是DI。DI主要以三种不同的方式实现</p><ul class=""><li id="31e0" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">一个类可以在其内部创建其他类的对象(依赖关系)。</li><li id="6674" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">使用其他来源的对象。就像这样，我们在应用程序中使用上下文。</li><li id="e444" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">将对象作为参数提供给所需的类。</li></ul></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="ed8c" class="lf lg it bd lh li nd lk ll lm ne lo lp lq nf ls lt lu ng lw lx ly nh ma mb mc bi translated">ANDROID中DI的历史</h1><p id="b41b" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">来到Android中的DI，我们大多数人都使用Dagger作为DI，因为它是Google维护的官方DI框架。但是对于从最初版本开始使用Dagger的人来说，他们会知道用Dagger管理事情有多难。从我的亲身经历来看，我会说从零开始学习匕首到高级水平需要时间和努力。许多开发人员对Dagger的复杂性给出了反馈。不仅如此，任何DI库都会生成大量样板代码，并且需要手工管理所有的依赖关系。所以为了帮助开发者克服这些问题，Andriod开发了Hilt。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="331b" class="lf lg it bd lh li nd lk ll lm ne lo lp lq nf ls lt lu ng lw lx ly nh ma mb mc bi translated">刀柄简介</h1><p id="1335" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">刀柄是匕首的简化版。Hilt提供了一种在Android中实现DI的标准方法。刀柄是Jetpack推荐给Android中DI的库。刀柄是匕首上的一个抽象层，有更多的好处。它减少了在应用程序中手工DI的工作量。Hilt的目标是:</p><ul class=""><li id="a309" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">简化Android应用程序的Dagger相关基础设施。</li><li id="7a37" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">创建一组标准的组件和范围，以简化设置、可读性/理解以及应用程序之间的代码共享。</li><li id="3693" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">提供一种简单的方法来为各种构建类型提供不同的绑定(例如，测试、调试或发布)。</li></ul></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="042c" class="lf lg it bd lh li nd lk ll lm ne lo lp lq nf ls lt lu ng lw lx ly nh ma mb mc bi translated">为什么是刀柄</h1><p id="2f7e" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">Hilt的好处是:</p><ul class=""><li id="9271" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">简化样板文件</li><li id="7036" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">分离的构建依赖项</li><li id="f2f2" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">简化配置</li><li id="6a55" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">改进的测试</li><li id="0a81" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">标准化组件</li></ul><p id="5ac2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">想知道更多关于好处检查<a class="ae le" href="https://dagger.dev/hilt/benefits" rel="noopener ugc nofollow" target="_blank">为什么匕首开发</a>上的刀柄</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="7aac" class="lf lg it bd lh li nd lk ll lm ne lo lp lq nf ls lt lu ng lw lx ly nh ma mb mc bi translated">刀柄设置</h1><p id="08cb" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">最初，将<code class="fe ni nj nk nl b">hilt-android-gradle-plugin</code>插件添加到项目的根级<code class="fe ni nj nk nl b">build.gradle</code>文件中:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="5fbe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，应用Gradle插件并在<code class="fe ni nj nk nl b">app/build.gradle</code>文件中添加依赖关系:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="a341" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Hilt使用Java 8特性，所以确保你已经在应用级build.gradle文件中启用了它:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3f2a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们完成了设置。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="947e" class="lf lg it bd lh li nd lk ll lm ne lo lp lq nf ls lt lu ng lw lx ly nh ma mb mc bi translated">刀柄实现</h1><p id="3816" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">刀柄是类似Dagger的基于注释的框架。让我们一步一步地检查实现，以便更好地理解。</p><h2 id="0beb" class="no lg it bd lh np nq dn ll nr ns dp lp kb nt nu lt kf nv nw lx kj nx ny mb nz bi translated">第一步:@注射</h2><p id="f6e2" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">让我们创建一些类，我们可以在任何需要的地方注入它</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3964" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了告诉Hilt提供的是哪种类型的实例，在你想要注入的类的构造函数中添加<strong class="js iu"> @Inject </strong>注释。Hilt拥有的关于如何提供不同类型实例的信息被称为<strong class="js iu">绑定</strong>。</p><h2 id="eb1b" class="no lg it bd lh np nq dn ll nr ns dp lp kb nt nu lt kf nv nw lx kj nx ny mb nz bi translated">第二步:<code class="fe ni nj nk nl b"><strong class="ak">@HiltAndroidApp</strong></code></h2><p id="7f84" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">现在，让我们设置应用程序类。<code class="fe ni nj nk nl b"><strong class="js iu">@HiltAndroidApp</strong></code>需要将注释应用到应用程序类，以便生成组件。不需要编写额外的代码来创建组件。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="dc4e" class="no lg it bd lh np nq dn ll nr ns dp lp kb nt nu lt kf nv nw lx kj nx ny mb nz bi translated">第三步:@ AndroidEntryPoint</h2><p id="2b6e" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">只需在Android组件类上添加<strong class="js iu">@ androdidentrypoint</strong>就可以完成对这些组件的注入。让我们看看如何将这个SampleClass注入到活动中</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="d500" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Hilt目前支持以下Android组件:</p><ul class=""><li id="3e97" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated"><code class="fe ni nj nk nl b">Activity</code></li><li id="b215" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><code class="fe ni nj nk nl b">Fragment</code></li><li id="5ff0" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><code class="fe ni nj nk nl b">View</code></li><li id="f0ca" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><code class="fe ni nj nk nl b">Service</code></li><li id="ce9a" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><code class="fe ni nj nk nl b">BroadcastReceiver</code></li></ul><h2 id="9907" class="no lg it bd lh np nq dn ll nr ns dp lp kb nt nu lt kf nv nw lx kj nx ny mb nz bi translated">第四步:</h2><p id="f762" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">@Module 注释用在我们提供依赖关系的类上面。</p><p id="25a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">@提供了</strong>注释，用在我们创建对象的模块和方法之上，将它们作为依赖项传递。</p><p id="4fa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> @InstallIn </strong>注释用于指定与@ <strong class="js iu">模块</strong>一起指定的模块范围。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="a709" class="lf lg it bd lh li nd lk ll lm ne lo lp lq nf ls lt lu ng lw lx ly nh ma mb mc bi translated">喷气背包的手柄支架</h1><p id="bdbf" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">Hilt目前支持跟随者Jetpack组件:</p><ul class=""><li id="1b31" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated"><code class="fe ni nj nk nl b">ViewModel</code></li><li id="0056" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated"><code class="fe ni nj nk nl b">WorkManage</code></li></ul><p id="2709" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是要使用Jetpack的Hilt，我们需要添加一些额外的依赖项。</p><h2 id="fee3" class="no lg it bd lh np nq dn ll nr ns dp lp kb nt nu lt kf nv nw lx kj nx ny mb nz bi translated">用Hilt注入视图模型对象</h2><p id="6dab" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">将以下依赖项添加到app/build.gradle</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="a6ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> @ViewModelInject </strong>是<strong class="js iu"> </strong>在<code class="fe ni nj nk nl b">ViewModel</code>对象的构造函数中使用的注释。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="19f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，要在活动或片段中获得ViewModel实例，我们需要使用<code class="fe ni nj nk nl b">ViewModelProvider</code>或<code class="fe ni nj nk nl b">by viewModels()</code> KTX扩展。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1998" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了获得活动级ViewModel实例，我们需要使用<code class="fe ni nj nk nl b"><strong class="js iu">activityViewModels</strong>()</code>委托函数来代替<code class="fe ni nj nk nl b"><strong class="js iu">viewModels</strong>()</code>。</p><p id="ef1b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">探索更多关于Jetpack手柄支持的信息。</p><p id="d11c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我觉得实现剑柄比匕首容易。所以我想你也有同感，所以开始探索剑柄吧。在你的下一个项目中尝试一下Hilt，你将永远不会再回到Dagge，然而，它是Dagge上的抽象层，就像Sqlite上的房间一样。但是由于Hilt还处于alpha阶段，所以在产品应用中试用时要小心。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="d525" class="lf lg it bd lh li nd lk ll lm ne lo lp lq nf ls lt lu ng lw lx ly nh ma mb mc bi translated">参考</h1><p id="3e4a" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated"><a class="ae le" href="https://developer.android.com/training/dependency-injection/hilt-android#setup" rel="noopener ugc nofollow" target="_blank">探索更多关于剑柄的信息</a></p><p id="5ad4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://dagger.dev/hilt/" rel="noopener ugc nofollow" target="_blank"> dagger.dev docs </a></p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="6da7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请让我知道你的建议和意见。</p><p id="9f98" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在<a class="ae le" href="https://medium.com/@pavan.careers5208" rel="noopener"> <strong class="js iu">中</strong> </a>和<a class="ae le" href="https://www.linkedin.com/in/satya-pavan-kumar-kantamani-61770a9b/" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">LinkedIn</strong></a>……</p><p id="9c17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读…</p></div></div>    
</body>
</html>