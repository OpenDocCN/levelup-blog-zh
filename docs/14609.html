<html>
<head>
<title>Design Patterns: State Pattern in TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计模式:类型脚本中的状态模式</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/design-patterns-state-pattern-in-typescript-32120b9a759f?source=collection_archive---------3-----------------------#2022-12-12">https://levelup.gitconnected.com/design-patterns-state-pattern-in-typescript-32120b9a759f?source=collection_archive---------3-----------------------#2022-12-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c93f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">去掉太多If-Else分支，尝试State模式！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8b94bc07bda6b49da3ae78041f6eb66e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ON4y4JFwoeQHoPIc"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·克什在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="6f6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">欢迎来到TypeScript 系列的<strong class="lb iu">设计模式，该系列介绍了一些使用TypeScript进行web开发时有用的设计模式。</strong></p><div class="lv lw gp gr lx ly"><a href="https://medium.com/frontend-canteen/9-design-patterns-every-engineer-should-know-f2423d36d468" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">每个工程师都应该知道的9种设计模式</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">掌握这9种设计模式，写出更好的代码</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="55b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设计模式对于web开发人员来说非常重要，通过掌握它们我们可以写出更好的代码。在本文中，我将使用<strong class="lb iu">类型脚本</strong>来介绍<strong class="lb iu">状态模式。</strong></p><p id="dda8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">状态模式和<a class="ae ky" href="https://javascript.plainenglish.io/design-patterns-strategy-pattern-in-typescript-54eda9b40f09" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">策略模式</strong> </a>在结构上非常相似，都属于行为模式，也可以用来优化<code class="fe mn mo mp mq b">if…else</code>分支过多的问题。下面我就举一个吹风机的例子，带大家先学习一下状态模式，然后介绍一下它和<a class="ae ky" href="https://javascript.plainenglish.io/design-patterns-strategy-pattern-in-typescript-54eda9b40f09" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">策略模式</strong> </a>的区别。</p><p id="8ee4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">吹风机是一种非常常用的小家电。普通吹风机只有两种模式:<strong class="lb iu">关和吹热风</strong>。你可以通过吹风机上的开关在不同模式之间切换。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/a7c16fd2de40eb997bb647ff8de41a15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNrV7AJBi4QBIKa5pjgjBg.jpeg"/></div></div></figure><p id="55a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于上图中的描述信息，我们使用TypeScript <code class="fe mn mo mp mq b">class</code>的语法来定义一个<code class="fe mn mo mp mq b">HairDryerV1</code>类:</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="cb02" class="mw mx it mq b be my mz l na nb">enum HairDryerMode {<br/>  Off,<br/>  On,<br/>}<br/><br/>class HairDryerV1 {<br/>  mode: HairDryerMode = HairDryerMode.Off;<br/><br/>  constructor(mode: HairDryerMode = HairDryerMode.Off) {<br/>    this.mode = mode;<br/>  }<br/><br/>  switchMode() {<br/>    if (this.mode === HairDryerMode.Off) {<br/>      console.log("Turn on the hair dryer");<br/>      this.mode = HairDryerMode.On;<br/>      console.log("Blowing hot air ~~~");<br/>    } else if (this.mode === HairDryerMode.On) {<br/>      console.log("Turn off the hair dryer");<br/>      this.mode = HairDryerMode.Off;<br/>    }<br/>  }<br/>}</span></pre><p id="059e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，<code class="fe mn mo mp mq b">HairDryerV1</code>类包含了一个用于指示吹风机当前模式的<code class="fe mn mo mp mq b">mode</code>属性和一个用于切换吹风机工作模式的<code class="fe mn mo mp mq b">switchMode</code>方法。现在我们有了第一代吹风机类别<code class="fe mn mo mp mq b">HairDryerV1</code>，让我们测试它的功能:</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="d618" class="mw mx it mq b be my mz l na nb">const hairDryerV1 = new HairDryerV1();<br/>hairDryerV1.switchMode(); // Blowing hot air<br/>hairDryerV1.switchMode(); // Turn off<br/>hairDryerV1.switchMode(); // Blowing hot air</span></pre><p id="952e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成功运行上述代码后，相应的输出如下:</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="abdb" class="mw mx it mq b be my mz l na nb">Turn on the hair dryer<br/>Blowing hot air ~~~<br/>Turn off the hair dryer<br/>Turn on the hair dryer<br/>Blowing hot air ~~~</span></pre><p id="c085" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">冬天打开吹风机后只有热风模式，可以满足大部分用户的需求。但是夏天天气比较热，用户会希望吹风机也支持冷风模式。相应的要求如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/2c7a184da8efe6bd5934e4cef4aa63cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H-KDrhSubfq2ucTD-ZwtTg.jpeg"/></div></div></figure><p id="6c39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了满足以上需求，我们来升级一下第一代吹风机(<code class="fe mn mo mp mq b">HairDryerV1</code>)。</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="1eeb" class="mw mx it mq b be my mz l na nb">enum HairDryerMode {<br/>  Off,<br/>  HotAir,<br/>  ColdAir,<br/>}<br/><br/>class HairDryerV2 {<br/>  mode: HairDryerMode = HairDryerMode.Off;<br/><br/>  constructor(mode: HairDryerMode = HairDryerMode.Off) {<br/>    this.mode = mode;<br/>  }<br/><br/>  switchMode() {<br/>    if (this.mode === HairDryerMode.Off) {<br/>      console.log("Start to enter hot air mode");<br/>      this.mode = HairDryerMode.HotAir;<br/>      console.log("Blowing hot air ~~~");<br/>    } else if (this.mode === HairDryerMode.HotAir) {<br/>      console.log("Start to enter cold air mode");<br/>      this.mode = HairDryerMode.ColdAir;<br/>      console.log("Blowing cold air ~~~");<br/>    } else if (this.mode === HairDryerMode.ColdAir) {<br/>      console.log("Turn off the hair dryer");<br/>      this.mode = HairDryerMode.Off;<br/>    }<br/>  }<br/>}</span></pre><p id="a738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们首先更新了<code class="fe mn mo mp mq b">HairDryerMode</code>枚举类型，定义了关、热风、冷风三种不同的模式，并根据<strong class="lb iu">关- &gt;热风- &gt;冷风</strong>切换过程更新了<code class="fe mn mo mp mq b">switchMode</code>方法。有了第二代吹风机类— <code class="fe mn mo mp mq b">HairDryerV2</code>，我们来测试一下它的功能性。</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="8972" class="mw mx it mq b be my mz l na nb">const hairDryerV2 = new HairDryerV2();<br/>hairDryerV2.switchMode(); // Blowing hot air<br/>hairDryerV2.switchMode(); // Blowing cold air<br/>hairDryerV2.switchMode(); // Turn off</span></pre><p id="378e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成功运行上述代码后，相应的输出如下:</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="5b80" class="mw mx it mq b be my mz l na nb">Start to enter hot air mode<br/>Blowing hot air ~~~<br/>Start to enter cold air mode<br/>Blowing cold air ~~~<br/>Turn off the hair dryer</span></pre><p id="ec2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然第二代吹风机已经支持冷风和热风模式，但是仍然不能满足某些场景的需求。例如，有些用户会希望在热风模式的风速和温度较高时开始吹头发(吹强烈的热风)，但在头发几乎干燥时，热风模式的风速和温度可以较低(吹热风)。</p><p id="4b13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相应的要求如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/e653015a9f350c2633121a9b52c5307e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AnTCCuZL71IK1A0ci_2bwQ.jpeg"/></div></div></figure><p id="71af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了满足以上需求，我们需要继续升级第二代吹风机(<code class="fe mn mo mp mq b">HairDryerV2</code>)。</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="1482" class="mw mx it mq b be my mz l na nb">enum HairDryerMode {<br/>  Off,<br/>  StrongHotAir,<br/>  HotAir,<br/>  StrongColdAir,<br/>  ColdAir,<br/>}<br/><br/>class HairDryerV3 {<br/>  mode: HairDryerMode = HairDryerMode.Off;<br/><br/>  constructor(mode: HairDryerMode = HairDryerMode.Off) {<br/>    this.mode = mode;<br/>  }<br/><br/>  switchMode() {<br/>    if (this.mode === HairDryerMode.Off) {<br/>      console.log("Start to enter strong hot air mode");<br/>      this.mode = HairDryerMode.StrongHotAir;<br/>      console.log("Blowing strong hot air ~~~");<br/>    } else if (this.mode === HairDryerMode.StrongHotAir) {<br/>      console.log("Start to enter hot air mode");<br/>      this.mode = HairDryerMode.HotAir;<br/>      console.log("Blowing hot air ~~~");<br/>    } else if (this.mode === HairDryerMode.HotAir) {<br/>      console.log("Start to enter strong cold air mode");<br/>      this.mode = HairDryerMode.StrongColdAir;<br/>      console.log("Blowing strong cold air ~~~");<br/>    } else if (this.mode === HairDryerMode.StrongColdAir) {<br/>      console.log("Start to enter cold air mode");<br/>      this.mode = HairDryerMode.ColdAir;<br/>      console.log("Blowing cold air ~~~");<br/>    } else if (this.mode === HairDryerMode.ColdAir) {<br/>      console.log("Turn off the hair dryer");<br/>      this.mode = HairDryerMode.Off;<br/>    }<br/>  }<br/>}</span></pre><p id="d37c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们更新了<code class="fe mn mo mp mq b">HairDryerMode</code>枚举类型，增加了<strong class="lb iu">吹强热风和吹强冷风</strong>两种新模式，并按照<strong class="lb iu">关- &gt;吹强热风- &gt;吹热风- &gt;吹强冷风- &gt;吹冷风</strong>的切换流程更新了<code class="fe mn mo mp mq b">switchMode</code>方法。同样，用第三代吹风机类— <code class="fe mn mo mp mq b">HairDryerV3</code>，我们来测试一下它的功能。</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="6f39" class="mw mx it mq b be my mz l na nb">const hairDryerV3 = new HairDryerV3();<br/>hairDryerV3.switchMode(); // Blowing strong hot air<br/>hairDryerV3.switchMode(); // Blowing hot air<br/>hairDryerV3.switchMode(); // Blowing strong cold air<br/>hairDryerV3.switchMode(); // Blowing cold air<br/>hairDryerV3.switchMode(); // Turn off</span></pre><p id="c786" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成功运行上述代码后，相应的输出如下:</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="d6bb" class="mw mx it mq b be my mz l na nb">Start to enter strong hot air mode<br/>Blowing strong hot air ~~~<br/>Start to enter hot air mode<br/>Blowing hot air ~~~<br/>Start to enter strong cold air mode<br/>Blowing strong cold air ~~~<br/>Start to enter cold air mode<br/>Blowing cold air ~~~<br/>Turn off the hair dryer</span></pre><p id="c697" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过不断升级，第三代吹风机(<code class="fe mn mo mp mq b">HairDryerV3</code>)的功能已经很强大了。但此时<code class="fe mn mo mp mq b">HairDryerV3</code>类中的<code class="fe mn mo mp mq b">switchMode</code>方法包含了大量的<code class="fe mn mo mp mq b">if…else</code>语句。这不仅不利于后期的维护，而且如果以后要添加其他模式，还需要添加相应的条件分支。</p><p id="172b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于上述问题，我们可以用<strong class="lb iu">状态模式</strong>将吹风机的不同工作模式封装成不同的工作状态。接下来，我将描述如何使用<strong class="lb iu">状态模式</strong>来解决上述问题。状态模式由三个主要角色组成:</p><ul class=""><li id="7c82" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated"><strong class="lb iu">上下文</strong>:保存对当前状态的引用，支持更新当前状态；</li><li id="8cc0" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><strong class="lb iu">状态</strong>:抽象状态类，用于定义上下文中状态的公共接口；</li><li id="cfcb" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><strong class="lb iu">具体状态</strong>:特定状态，包含该状态下的处理逻辑，控制向其他状态的切换。</li></ul><p id="e047" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于前面的吹风机示例，我将定义一个<code class="fe mn mo mp mq b">HairDryer</code>类来保存和管理不同的状态，它对应于状态模式中的<code class="fe mn mo mp mq b">Context</code>角色。然后用<code class="fe mn mo mp mq b">interface</code>定义一个<code class="fe mn mo mp mq b">HairDryerState</code>接口，然后基于这个接口实现五种不同的吹风机工作状态。</p><p id="df9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更好地理解下面的代码，我们先来看看相应的UML图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/0a5c392fd0e6db216b0c46f1074c38c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SLQUWMiuCTwEr0yw.png"/></div></div></figure><p id="5ed2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">吹风机状态界面</strong></p><p id="8260" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该接口包含一个<code class="fe mn mo mp mq b">doAction</code>方法，用于封装吹风机在不同工作状态下的处理逻辑。</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="e00e" class="mw mx it mq b be my mz l na nb">interface HairDryerState {<br/>  doAction(context: HairDryer): void;<br/>}</span></pre><p id="041b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">关闭状态(混凝土状态)</strong></p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="8bc2" class="mw mx it mq b be my mz l na nb">class TurnOffState implements HairDryerState {<br/>  doAction(context: HairDryer): void {<br/>    console.log("Start to enter strong hot air state");<br/>    context.setState(new StrongHotAirState());<br/>    console.log("Blowing strong hot air ~~~");<br/>  }<br/>}</span></pre><p id="f587" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">🔥🔥🔥strong hotairstate(concrete state)</strong></p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="66e7" class="mw mx it mq b be my mz l na nb">class StrongHotAirState implements HairDryerState {<br/>  doAction(context: HairDryer): void {<br/>    console.log("Start to enter hot air state");<br/>    context.setState(new HotAirState());<br/>    console.log("Blowing hot air ~~~");<br/>  }<br/>}</span></pre><p id="f7e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">🔥HotAirState(混凝土状态)</strong></p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="2740" class="mw mx it mq b be my mz l na nb">class HotAirState implements HairDryerState {<br/>  doAction(context: HairDryer): void {<br/>    console.log("Start to enter strong cold air state");<br/>    context.setState(new StrongColdAirState());<br/>    console.log("Blowing strong cold air ~~~");<br/>  }<br/>}</span></pre><p id="668c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 🧊🧊🧊强冷状态(混凝土状态)</strong></p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="82f4" class="mw mx it mq b be my mz l na nb">class StrongColdAirState implements HairDryerState {<br/>  doAction(context: HairDryer): void {<br/>    console.log("Start to enter cold air state");<br/>    context.setState(new ColdAirState());<br/>    console.log("Blowing cold air ~~~");<br/>  }<br/>}</span></pre><p id="f36b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🧊冷空气状态(混凝土状态)</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="ecaa" class="mw mx it mq b be my mz l na nb">class ColdAirState implements HairDryerState {<br/>  doAction(context: HairDryer): void {<br/>    console.log("Turn off the hair dryer");<br/>    context.setState(new TurnOffState());<br/>  }<br/>}</span></pre><p id="7f09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">吹风机类(上下文)</strong></p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="505a" class="mw mx it mq b be my mz l na nb">class HairDryer {<br/>  constructor(private state: HairDryerState) {}<br/><br/>  getState(): HairDryerState {<br/>    return this.state;<br/>  }<br/><br/>  setState(state: HairDryerState) {<br/>    this.state = state;<br/>  }<br/><br/>  switchState() {<br/>    this.state.doAction(this);<br/>  }<br/>}</span></pre><p id="8ce8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们定义了一个<code class="fe mn mo mp mq b">HairDryer</code>类。这个类包含一个私有的<code class="fe mn mo mp mq b">state</code>属性来表示吹风机的当前状态，并提供相应的<code class="fe mn mo mp mq b">getState</code>和<code class="fe mn mo mp mq b">setState</code>方法来管理这个状态。切换状态的能力在<code class="fe mn mo mp mq b">switchState</code>方法中定义。使用新的<code class="fe mn mo mp mq b">HairDryer</code>吹风机类和五个不同的状态类，让我们验证它的功能。</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="0cff" class="mw mx it mq b be my mz l na nb">const hairDryer = new HairDryer(new TurnOffState());<br/>hairDryer.switchState(); // Blowing strong hot air<br/>hairDryer.switchState(); // Blowing hot air<br/>hairDryer.switchState(); // Blowing strong cold air<br/>hairDryer.switchState(); // Blowing cold air<br/>hairDryer.switchState(); // Turn off</span></pre><p id="3136" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成功运行上述代码后，相应的输出如下:</p><pre class="kj kk kl km gt ms mq mt bn mu mv bi"><span id="3693" class="mw mx it mq b be my mz l na nb">Start to enter strong hot air state<br/>Blowing strong hot air ~~~<br/>Start to enter hot air state<br/>Blowing hot air ~~~<br/>Start to enter strong cold air state<br/>Blowing strong cold air ~~~<br/>Start to enter cold air state<br/>Blowing cold air ~~~<br/>Turn off the hair dryer</span></pre><p id="fb81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来我们来比较一下不使用状态模式实现吹风机的状态/模式切换和使用状态模式后的区别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/7659d7be895adb196d2e02f3a23b0253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVx3M2or9pERyEGrTslOAw.jpeg"/></div></div></figure><p id="69a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们总结一下策略模式和状态模式的区别:</p><ul class=""><li id="3bab" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">策略模式是在不同的策略中选择一种策略来完成同一件事。状态模式更侧重于不同状态之间的切换，每个状态完成不同的事情。</li><li id="1de6" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><strong class="lb iu">封装在策略模式中的算法都完成同样的事情。</strong>比如在登录场景中，用户名/密码、邮箱、手机号，或者第三方账号登录，虽然用户可以使用不同的登录策略，但最终目的都是完成登录操作，也就是说，这些策略之间是可替换的。<strong class="lb iu">但是，对于状态模式来说，不同的状态对应不同的行为，不能随意替换。</strong></li><li id="5e83" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">在策略模式中，每个策略对象不包含对<code class="fe mn mo mp mq b">Context</code>对象的引用，但是<code class="fe mn mo mp mq b">Context</code>对象包含对所有策略对象的引用。在状态模式中，每个状态通过持有对<code class="fe mn mo mp mq b">Context</code>对象的引用来实现状态切换。</li></ul><p id="4793" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，状态模式到此结束。建议您回顾一下之前的业务场景，思考一下是否有适合使用状态模式的场景。如果你有任何问题，请随时给我留言。</p><p id="ca72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">后面我会继续介绍其他模式，如果有兴趣可以关注我的<a class="ae ky" href="https://medium.com/@bytefer" rel="noopener">中</a>或者<a class="ae ky" href="https://twitter.com/Tbytefer" rel="noopener ugc nofollow" target="_blank">推特</a>。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="bbec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想学习打字稿，千万不要错过<strong class="lb iu">掌握打字稿</strong>系列。</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/frontend-canteen/with-these-articles-you-will-not-be-confused-when-learning-typescript-d96a5c99e229" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">有了40+篇文章，学习TypeScript就不会迷茫了</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">通过生动的动画，让你轻松了解TypeScript的难点和核心知识！不断地…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="ny l mj mk ml mh mm ks ly"/></div></div></a></div></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h1 id="444f" class="nz mx it bd oa ob oc od oe of og oh oi jz oj ka ok kc ol kd om kf on kg oo op bi translated">分级编码</h1><p id="2fa8" class="pw-post-body-paragraph kz la it lb b lc oq ju le lf or jx lh li os lk ll lm ot lo lp lq ou ls lt lu im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="ffdc" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="3c60" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">📰查看<a class="ae ky" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="5a11" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">🔔关注我们:<a class="ae ky" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ky" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="afc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🚀👉<a class="ae ky" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>