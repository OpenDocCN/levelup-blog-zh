# 如何构建优秀的命令行界面(CLI)

> 原文：<https://levelup.gitconnected.com/how-to-build-great-command-line-interfaces-clis-5d387bb51d55>

关注用户体验

![](img/d6a1cdeb64a9585f9ee7d007655e6d41.png)

谢尔盖·佐尔金在 [Unsplash](https://unsplash.com/s/photos/typing-on-keyboard?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

*命令行界面* (CLIs)是自动化任务的绝佳工具。CLI 在开发人员的生活中非常常见，可以节省日常任务的时间和精力:例如，GitHub CLI、Docker CLI、Kubernetes CLI 等。

CLI 易于在命令行中从终端直接使用，而且——这些工具在脚本编写方面为用户提供了巨大的价值。

设计、构建和实现 CLI 的主要目标应该是为用户创建一个易于使用的工具。以下几点旨在作为开始创建 CLI 的指南。第一步主要是覆盖基础，而最后一步更关注用户体验。

1.  **范围**

此 CLI 旨在向用户提供什么？用尽可能多的细节来回答这个问题，可以在过程中节省很多时间。从一开始就对 CLI 应该支持什么有一个清晰的了解，它可以在项目的架构和结构方面有所帮助，提高模块性和长期的易维护性。

*明确列出您希望 CLI 支持的任务。*这涵盖了基础知识，即您希望实现自动化的流程。

*明确列出您希望 CLI 支持的* ***用户体验*** *任务。*这是指应该改善用户体验的任务。

2.**姓名**

在制作命令行界面中定义范围后，为其选择一个名称。通常，cli 名称带有后缀 *ctl* 、control 的别名(例如:kubectl)或后缀- *cli* 。虽然这只是一个建议，但是有很多很棒的地方都有一个提示性的词。

想一个有暗示性的，好用，好记，易写的名字。CLI it 的名称将是根命令，所有子命令都将连接到它。

3.**命令结构**

列表中的下一步是命令的**结构。重要的是将这一步与第一步和项目的大局相匹配。**

在这一步中，决定一个命令结构，并在整个项目中遵循这个结构。保持一致。使用动词(例如:创建、列出、获取、显示、显示、更新、删除、移除等。)，名词和决定结构。有的 CLI 有: *<根命令> <名词> <动词>* 结构，有的则有: *<根命令> <动词> <名词>* 。

可能会考虑目标用户，这取决于 CLI 的范围—最终，他们将是使用 CLI 的人。例如，如果他们将使用与 Kubernetes CLI 关联的 CLI，并且让**熟悉的东西**与*kubectl get<resource>*命令同步对他们来说更有意义。

CLI 应根据最小意外原则工作。

4.**名称空间**

这是一个可选步骤，由 CLI 的范围和它应该涵盖的任务决定，可能只是一些小任务，可以包含在子命令的第一个“级别”中。

名称空间根据标准对多个子命令进行分组。名称空间可以改进模块性、命令结构，并且如果用户想要使用一组特定的命令，它可以更加直观。

从一开始就记住清晰的画面，关注目标(例如，能够容易地维护、集成新功能)和用户体验。

5.**易于安装，易于更新**

这是更加关注*用户体验的第一步。*

CLI 应该易于安装，易于更新到最新版本。

软件包管理器在这个等式中起了很大的作用，并且无疑改善了用户在安装和更新 CLI 时的体验。考虑软件包管理器的支持，比如 Aptitude(针对 Ubuntu)、Homebrew(针对 MacOS)或 Chocolatey(针对 Windows)。

6.**自动完成**

支持为 CLI 完成是一个很大的优势，它使它更容易使用，并节省时间。

您可以为命令、标志和标志值添加补全。

7.**命令和标志别名**

为了更容易使用，CLIs 命令的一个很酷的东西是命令的别名和标志的缩写。使用直观的别名和提示性的简写字符(小写或大写)作为标志。

8.**全局标志**

CLI 的所有命令都支持全局选项。

例如，您可能希望支持一个*输出*选项(text、json、yaml)，一个*宽的*选项来显示输出中的多列——但不是默认情况下，一个*列*选项来只显示输出中的特定列。

9.**环境变量**

环境变量很容易在终端和工作流中使用(通过 secrets)。

例如，如果 CLI 是工具组合的一部分，您可能希望在用户身份验证方面提供一致性，从环境变量中获取凭据可能是一种方法。

10.**用户友好输出**

为了改善用户与 CLI 的交互，您可以关注自定义输出。使用不同的颜色；红色—错误，黄色—警告，等等。在等待命令时使用装载杆。你可以使用表情符号，如果你考虑适当的话，例如:感叹号，支票，问号。(注意检查输出是否正确显示在多个终端上。)

使工具具有交互性和趣味性。享受这个过程，发挥创造力。

11.**脚本支持**

可以在脚本中使用命令行界面，以便自动化工作流和管道中的任务。如果这是 CLI 范围的一部分，请考虑在脚本中提供选项和标志，以便于集成和使用。

例如，如果 CLI 向用户显示问题以确认继续进行—考虑添加一个*强制*标志以在脚本中使用。这样，命令将继续执行，无需用户确认。此外，您可以考虑使用 *no-headers* 选项来更容易地管理脚本中的输出。

12.**调试**

像 *debug* 这样的全局选项可以为用户显示调试中的重要信息。它可以通过标志或环境变量来设置。

13.**文档**

为你的项目准备好文档，包括目的、安装步骤、用法、例子、测试、发布等。使用 CLI 时，您可以将集成到记录的终端的文档中；对于用户来说，看到一个可视的例子可能是更动态的。

最后，记得要开心，要有创意。

*CLI 应该有趣、简单且易于使用，让用户的生活更轻松，而不是更困难。在构建 CLI 时，请始终牢记这一点。假装你是这个工具的使用者。你会用它吗？*

注意:这些是基于我在 Go 中使用 [Cobra](https://github.com/spf13/cobra) 和 [Viper](https://github.com/spf13/viper) 编写的 CLIs 经验的提示和技巧。如果你有什么建议，如果你想分享你建设 CLI 的经验，请在下面留下评论。干杯！