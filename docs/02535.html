<html>
<head>
<title>How to run multiple Node and Angular versions simultaneously</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何同时运行多个节点和角度版本</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-run-multiple-node-and-angular-versions-simultaneously-1f58e6d150de?source=collection_archive---------1-----------------------#2020-03-20">https://levelup.gitconnected.com/how-to-run-multiple-node-and-angular-versions-simultaneously-1f58e6d150de?source=collection_archive---------1-----------------------#2020-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/faee1799402f8add9d9d379d8732090f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2XK0d0T-M-6s8lHskFGNg.png"/></div></div></figure><p id="03e9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我作为一名网络工程师的工作中，我在不太长的时间内完成了大量的项目。不仅如此，所有这些项目都有至少一个基于<a class="ae kz" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank">节点</a>的组件，并且其中很大一部分还使用<a class="ae kz" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular </a>作为他们的前端框架。因此，我最终来到了一个点，我需要积极地工作在我当前的项目上，但能够迅速切换回任何其他项目。</p><p id="6367" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我必须承认，第一次需要这个开关时，我天真地将Node和<a class="ae kz" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>都降级了……结果当我回到我当前的项目时，又将它们升级了。这不仅是一个浪费时间的过程，而且很容易因为缺少信息而出错。一个Angular项目的CLI版本在<code class="fe la lb lc ld b">package.json</code>文件里，但是节点版本呢？这是一条必须记录在案的信息，众所周知，记录几乎总是被遗忘。</p><blockquote class="le lf lg"><p id="8315" class="kb kc lh kd b ke kf kg kh ki kj kk kl li kn ko kp lj kr ks kt lk kv kw kx ky im bi translated"><strong class="kd iu">每个角度版本都与一系列节点版本兼容。</strong>降级/升级Angular CLI时，您还需要确保正在使用的节点版本是兼容的。此外，在开发过程中维护版本是一个很好的实践，除非明确地想要改变它们。</p></blockquote><p id="d880" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就在那一刻，我开始寻找一个可能的解决方案来管理不同项目的不同节点和角度版本。我发现了两个似乎有希望一起使用的概念:</p><ul class=""><li id="69e4" class="ll lm it kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated"><a class="ae kz" href="https://github.com/nvm-sh/nvm" rel="noopener ugc nofollow" target="_blank"> nvm </a>，节点版本管理器</li><li id="c0b6" class="ll lm it kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">局部角度CLI</li></ul><h1 id="0d91" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">nvm</h1><p id="bf39" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">nvm是一个节点版本管理器命令行工具。它允许用户在其机器上安装多个节点版本，然后在不同的shells中同时使用不同的版本。</p><blockquote class="le lf lg"><p id="816d" class="kb kc lh kd b ke kf kg kh ki kj kk kl li kn ko kp lj kr ks kt lk kv kw kx ky im bi translated">如果你不熟悉nvm命令，请记住:<br/> - <code class="fe la lb lc ld b"><em class="it">nvm run [arguments]</em></code>相当于<code class="fe la lb lc ld b"><em class="it">node [arguments]</em></code> <br/> - <code class="fe la lb lc ld b"><em class="it">nvm exec [command] [arguments]</em></code>相当于<code class="fe la lb lc ld b"><em class="it">[command] [arguments]</em></code></p></blockquote><p id="1beb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一个正常的nvm使用工作流程(以及我们将要用来管理不同项目的节点版本的工作流程)将是<strong class="kd iu">安装每个项目的节点版本，然后在一个独立的项目专用外壳</strong>中执行它。节点可以本地安装在机器上，也可以不安装在机器上，这对于这个用例没有影响。</p><p id="80c1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">出于演示目的，假设我们有以下项目:</p><ul class=""><li id="653a" class="ll lm it kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated">项目XPTO，节点版本8.17.0</li><li id="5813" class="ll lm it kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">项目EPIC，节点版本12.16.1</li></ul><p id="e0c9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了能够在不需要降级/升级节点版本的情况下执行这两个项目，您必须:</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="f6c9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi nj translated"><span class="l nk nl nm bm nn no np nq nr di"> 1。</span>使用nvm安装两个节点版本:</p><pre class="ns nt nu nv gt nw ld nx ny aw nz bi"><span id="e709" class="oa ma it ld b gy ob oc l od oe"><strong class="ld iu">$</strong> nvm install 8.17.0<br/><strong class="ld iu">$</strong> nvm install 12.16.1</span></pre><p id="dd27" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi nj translated"><span class="l nk nl nm bm nn no np nq nr di"> 2。</span>转到XPTO项目目录，设置nvm使用正确的节点版本:</p><pre class="ns nt nu nv gt nw ld nx ny aw nz bi"><span id="6ae8" class="oa ma it ld b gy ob oc l od oe"><strong class="ld iu">$</strong> nvm use 8.17.0</span><span id="6a4a" class="oa ma it ld b gy of oc l od oe"><em class="lh"># check Node version being used</em><br/><strong class="ld iu">$</strong> nvm run -v<br/>&gt; Running node v8.17.0<br/>&gt; v8.17.0</span><span id="20cd" class="oa ma it ld b gy of oc l od oe"># start project XPTO<br/><strong class="ld iu">$</strong> nvm run npm start</span></pre><blockquote class="le lf lg"><p id="f9d1" class="kb kc lh kd b ke kf kg kh ki kj kk kl li kn ko kp lj kr ks kt lk kv kw kx ky im bi translated">通过执行<code class="fe la lb lc ld b">nvm use</code>,您定义了nvm将在该shell中运行的节点版本，而不仅仅是在您执行命令的目录中。</p></blockquote><p id="594e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi nj translated"><span class="l nk nl nm bm nn no np nq nr di"> 3。</span>打开一个新的shell，转到项目EPIC的目录，对该项目的节点版本执行相同的操作。</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="f5b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在有两个不同的项目由两个不同的节点版本执行！<em class="lh">少了什么？</em>嗯，<code class="fe la lb lc ld b">nvm use</code>动作是<strong class="kd iu"> shell会话作用域</strong>，这意味着新的shell将以默认的nvm版本的Node开始。因此，当您明天回来工作并打开一个shell来启动您的任一项目时，nvm将不再指向它们正确的节点版本。</p><p id="46b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">幸运的是，nvm有<code class="fe la lb lc ld b"><a class="ae kz" href="https://github.com/nvm-sh/nvm#nvmrc" rel="noopener ugc nofollow" target="_blank">.nvmrc</a></code>文件，它允许用户在目录及其所有子目录中指定nvm使用的<strong class="kd iu">节点版本。使用正确的节点版本在项目的根目录下创建此文件:</strong></p><pre class="ns nt nu nv gt nw ld nx ny aw nz bi"><span id="8173" class="oa ma it ld b gy ob oc l od oe"><em class="lh"># in project root directory<br/></em><strong class="ld iu">$</strong> echo "8.17.0" &gt; .nvmrc</span></pre><p id="f647" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">确保您总是使用nvm命令来执行Node或npm，因为这些是搜索和使用<code class="fe la lb lc ld b">.nvmrc</code>文件的命令:</p><pre class="ns nt nu nv gt nw ld nx ny aw nz bi"><span id="c3d1" class="oa ma it ld b gy ob oc l od oe"><em class="lh"># "node server.js" with Node version from .nvmrc</em><br/><strong class="ld iu">$</strong> nvm run server.js</span><span id="f4dd" class="oa ma it ld b gy of oc l od oe"><em class="lh"># "npm start" with Node version from .nvmrc</em><br/><strong class="ld iu">$</strong> nvm exec npm start</span></pre><p id="22ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，nvm将始终为您的项目运行正确的节点版本！</p><h1 id="1ba0" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">局部角度CLI</h1><p id="c7c1" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">如果你正在做一个Angular项目，除了保证正确的节点版本，你还需要确保在运行<code class="fe la lb lc ld b">ng</code>命令时使用正确的Angular CLI版本。</p><p id="7a1e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当您创建一个Angular项目时，<strong class="kd iu"> Angular CLI作为一个开发依赖项</strong>被添加到您的项目的<code class="fe la lb lc ld b">package.json</code>:</p><pre class="ns nt nu nv gt nw ld nx ny aw nz bi"><span id="6c87" class="oa ma it ld b gy ob oc l od oe">{<br/>  ...<br/>  "devDependencies": {<br/>    "@angular/cli": "9.0.5",<br/>    ...<br/>  }<br/>}</span></pre><p id="29c8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这意味着，在安装完项目的依赖项后，在 <code class="fe la lb lc ld b"><strong class="kd iu">node_modules</strong></code>文件夹中会有一个<strong class="kd iu">本地安装的Angular CLI，与您在机器中全局安装的Angular CLI版本无关。您需要做的是确保执行这个本地安装的版本，而不是全局版本。您可以执行下列操作之一:</strong></p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><ul class=""><li id="00e8" class="ll lm it kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated"><strong class="kd iu">使用</strong> <code class="fe la lb lc ld b"><strong class="kd iu">package.json</strong></code> <strong class="kd iu">脚本</strong></li></ul><p id="7f76" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe la lb lc ld b">npm run-script</code>命令将<code class="fe la lb lc ld b">node_modules/.bin</code>二进制文件添加到预先存在的shell路径中，然后提供给脚本。这意味着<code class="fe la lb lc ld b">package.json</code>中执行<code class="fe la lb lc ld b">ng</code>的脚本将运行本地安装的Angular CLI。如果您也想使用这种方法在shell中直接执行<code class="fe la lb lc ld b">ng</code>，您可以在<code class="fe la lb lc ld b">package.json</code>中添加<code class="fe la lb lc ld b">"ng": "ng"</code>作为脚本。</p><pre class="ns nt nu nv gt nw ld nx ny aw nz bi"><span id="a8e0" class="oa ma it ld b gy ob oc l od oe">{<br/>  ...<br/>  "scripts": {<br/>    "ng": "ng",<br/>    "start": "ng serve",<br/>    ...<br/>  }<br/>}</span><span id="61cf" class="oa ma it ld b gy of oc l od oe"><em class="lh"># serve your application with nvm and local Angular CLI</em><br/><strong class="ld iu">$</strong> nvm exec npm start</span><span id="9067" class="oa ma it ld b gy of oc l od oe"><em class="lh"># create an Angular component using local Angular CLI</em><br/><strong class="ld iu">$ </strong>nvm exec npm run ng g component my-cool-component</span></pre></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><ul class=""><li id="cf26" class="ll lm it kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated"><strong class="kd iu">使用</strong> <code class="fe la lb lc ld b"><strong class="kd iu">node_modules/.bin/ng</strong></code></li></ul><p id="94a2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">通过在shell中直接执行<code class="fe la lb lc ld b">node_modules/.bin</code>文件夹中的二进制文件来运行本地Angular CLI。</p><pre class="ns nt nu nv gt nw ld nx ny aw nz bi"><span id="f908" class="oa ma it ld b gy ob oc l od oe"><em class="lh"># create an Angular component using local Angular CLI</em><br/><strong class="ld iu">$</strong> nvm exec ./node_modules/.bin/ng g component my-cool-component</span></pre></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h1 id="82fa" class="lz ma it bd mb mc og me mf mg oh mi mj mk oi mm mn mo oj mq mr ms ok mu mv mw bi translated">结论</h1><p id="6aec" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">通过利用<strong class="kd iu"> nvm和本地Angular CLI二进制文件</strong>，不仅可以管理不同的节点和Angular版本化项目，还可以以简单直接的方式完成。</p><p id="8ecf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用这种方法，重要的是<strong class="kd iu">永远不要忘记使用nvm命令</strong>！的确，一个简单的命令(例如启动一个项目)会变得有点冗长，但是能够无缝地处理和执行多个项目的好处是巨大的。</p><p id="8fa9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="lh">希望这对外面的人有帮助！</em>💡<br/> <em class="lh">当然还有感谢阅读。</em>🤓<br/> <em class="lh">如果您有任何问题/建议/反馈，欢迎留下评论。</em>📝</p><p id="49dc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://twitter.com/PatricePeartree" rel="noopener ugc nofollow" target="_blank"><em class="lh">Patrice pear tree</em></a><em class="lh">@ Twitter</em></p></div></div>    
</body>
</html>