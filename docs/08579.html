<html>
<head>
<title>Creating Awesome TypeScript NPM Packages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建令人惊叹的打字稿NPM软件包</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-awesome-typescript-npm-packages-5d97ac342361?source=collection_archive---------3-----------------------#2021-05-14">https://levelup.gitconnected.com/creating-awesome-typescript-npm-packages-5d97ac342361?source=collection_archive---------3-----------------------#2021-05-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b651976acf460555d87ccacfe4a0bcb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7EEykys5IgK98sCL"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="138a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="lb">更新:自从这篇文章发布以来，我现在推荐使用Vite——请看这里的更新示例:</em></strong><a class="ae kc" href="https://github.com/jasonsturges/vite-typescript-npm-package" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="lb">https://github.com/jasonsturges/vite-typescript-npm-package</em></strong></a></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="81de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建、测试、记录和发布TypeScript包到NPM注册中心的综合指南。</p><p id="66f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建库有多种方式，比如使用<a class="ae kc" href="https://github.com/formium/tsdx" rel="noopener ugc nofollow" target="_blank"> TSDX </a>，一个用于TypeScript包开发的零配置CLI或者，使用具有<a class="ae kc" href="https://github.com/rollup/rollup-starter-lib/tree/typescript" rel="noopener ugc nofollow" target="_blank">类型脚本分支</a>的<a class="ae kc" href="https://github.com/rollup/rollup-starter-lib" rel="noopener ugc nofollow" target="_blank">汇总启动库</a>库。</p><p id="9f46" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那里也有很多样板项目，我们可以使用<a class="ae kc" href="https://github.com/Rich-Harris/degit" rel="noopener ugc nofollow" target="_blank"> degit </a>或<a class="ae kc" href="https://cli.github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub CLI </a> to <code class="fe lj lk ll lm b">gh repo create &lt;name&gt; --template="&lt;repo-path&gt;"</code>，但是我们将从头开始引导我们最初的脚手架。</p><p id="ec7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在GitHub查看最终创建的项目:</p><div class="ln lo gp gr lp lq"><a href="https://github.com/jasonsturges/typescript-npm-package" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd ir gy z fp lv fr fs lw fu fw ip bi translated">jasonsturges/typescript-NPM-package</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">类型脚本库npm包样板文件。通过创建……为jasonsturges/typescript-NPM-package开发做出贡献</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">github.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jw lq"/></div></div></a></div></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="acd4" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">入门指南</h2><p id="27ed" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">在努力创建您的包之前，最好考虑一下它的用法——特性、API、可用性以及与现有库的重叠。</p><p id="ec53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当发布一个包时，npm在名称上强制一个唯一性，这在你创建了你的GitHub repo、相应的文档和网站之后可能会令人沮丧。</p><p id="96b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在进行任何开发之前，使用<code class="fe lj lk ll lm b">npm search</code>命令，它会告诉您是否已经创建了类似的库，以及您选择的名称是否已经被占用。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/36d8fb50b82e2df10150c613d4f05b95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYTZ_dRC1VGWjJm89neQvQ.png"/></div></div></figure><p id="868a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果没有显示结果，您的库名应该可以发布，而不用担心与另一个包名冲突。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="cb69" class="mf mg iq lm b gy nm nn l no np">$ npm search something-really-unique<br/>No matches found for "something-really-unique"</span></pre><h2 id="c713" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">搭建项目</h2><p id="3fb6" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">使用所需的npm软件包名称创建一个新文件夹。在本例中，我们将使用“my-lib”作为包名:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="c749" class="mf mg iq lm b gy nm nn l no np">mkdir my-lib &amp;&amp; cd my-lib</span></pre><p id="a844" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当现在提示时，初始化一个新的npm包，采用默认值—我们稍后将配置package.json。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="02be" class="mf mg iq lm b gy nm nn l no np">npm init</span></pre><p id="b0ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个”。gitignore”文件来排除对节点模块、构建、可分发版本和文档的跟踪:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="0a9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">初始化新的git存储库:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="d772" class="mf mg iq lm b gy nm nn l no np">git init</span></pre><p id="a95f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加所有现有文件:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="eb17" class="mf mg iq lm b gy nm nn l no np">git add -A</span></pre><p id="2fc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在存储库中创建我们的第一个提交:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="5597" class="mf mg iq lm b gy nm nn l no np">git commit -m "Initial commit"</span></pre><p id="3ca6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以添加我们的遥控器并推送到GitHub。</p><p id="4405" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您还没有这样做，请在GitHub上创建一个新的存储库，不要选中所有初始化——没有README、gitignore或license:</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/c76449b62cc8c804177f47e2de14dbea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R8_bWsl0X9S0Tk09Ax1rjg.png"/></div></div></figure><p id="9881" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，从快速设置中复制URL:</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/2bbba9683e7cf3618870311436dae213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f1-0AMMBmGMwboP6B5wJaA.png"/></div></div></figure><p id="1e4f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用该URL添加遥控器并推送:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="ec09" class="mf mg iq lm b gy nm nn l no np">git remote add origin <a class="ae kc" href="https://github.com/jasonsturges/my-lib.git" rel="noopener ugc nofollow" target="_blank">https://github.com/&lt;username&gt;/my-lib.git</a><br/>git push</span></pre><h2 id="a341" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">程序包设置</h2><p id="288f" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">让我们从更新包的一些属性开始。打开package.json文件，并设置以下值:</p><ul class=""><li id="caed" class="nu nv iq kf b kg kh kk kl ko nw ks nx kw ny la nz oa ob oc bi translated">名称:新包的名称</li><li id="ea19" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">版本:您将要发布的初始版本，可能是1.0.0，除非您从测试版开始</li><li id="9aa6" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">描述:概述您的包将做什么</li><li id="77af" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">作者:您的姓名、网站和(可选)电子邮件</li><li id="8742" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">主页:你的软件包的网站——一旦我们在GitHub上建立并托管了gh-pages，我们将会更新它</li><li id="0b11" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">关键词:用户可能通过npm搜索或浏览的术语</li></ul><p id="1554" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，安装最新的ESLint、TypeScript、Rollup和插件作为开发依赖项。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="fdf2" class="mf mg iq lm b gy nm nn l no np">npm install --save-dev \<br/>            eslint \<br/>            typescript \<br/>            tslib \<br/>            ts-node \<br/>            rollup \<br/>            @rollup/plugin-commonjs \<br/>            @rollup/plugin-node-resolve \<br/>            @rollup/plugin-typescript</span></pre><p id="2784" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我们的脚本，我们想要添加开发和构建:</p><ul class=""><li id="b6c5" class="nu nv iq kf b kg kh kk kl ko nw ks nx kw ny la nz oa ob oc bi translated">dev:在监视模式(<code class="fe lj lk ll lm b">-w</code>)下运行Rollup，以检测开发期间对文件的更改</li><li id="4b7d" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">构建:运行Rollup来构建可分发的产品版本</li></ul><p id="a985" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两个脚本都将使用<code class="fe lj lk ll lm b">-c</code>配置标志来加载一个汇总配置文件，我们将在后面介绍。</p><p id="b8ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我们的可分发文件，我们需要定义我们的输出文件:</p><ul class=""><li id="9e88" class="nu nv iq kf b kg kh kk kl ko nw ks nx kw ny la nz oa ob oc bi translated">main: CommonJS (CJS)输出文件</li><li id="717d" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">模块:ES模块(ESM)输出文件</li><li id="5487" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">浏览器:通用模块定义(UMD)输出文件</li><li id="d762" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">文件:我们的文件将被建立到一个“dist”文件夹中</li></ul><p id="2ec7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该以这样的方式结束:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h2 id="fdeb" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">类型脚本配置</h2><p id="d438" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">我们需要通过创建一个包含以下内容的“tsconfig.json”文件来配置我们的TypeScript编译器:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h2 id="744c" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">汇总配置</h2><p id="00df" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">我们的汇总配置将构建CJS、ESM和UMD版本的库。创建一个包含以下内容的“rollup.config.js”文件，并确保输入一个<code class="fe lj lk ll lm b">name</code>和条目<code class="fe lj lk ll lm b">input</code>:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="2fe6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，在“src”文件夹中创建一个“index.ts”文件作为我们的主入口点。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/c835b9d581739e992273e4de1a33bd52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kl7-79TznbzFgLNO7wcKtQ.png"/></div></div></figure><p id="53ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的设置已经完成，现在我们可以开始开发我们的库了。</p><h2 id="6923" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">设置开发环境</h2><p id="144a" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">几乎立刻你就需要一种方法来试验你的库。虽然测试驱动开发(TDD)是一个好方法，但是让我们看看在实际的应用程序中使用<code class="fe lj lk ll lm b">npm link</code>从我们的库中调用函数。</p><p id="c1c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这个例子，我假设我们有两个项目:</p><ul class=""><li id="cebb" class="nu nv iq kf b kg kh kk kl ko nw ks nx kw ny la nz oa ob oc bi translated">“我的图书馆”——我们正在开发的图书馆</li><li id="2749" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">“我的应用”——从库中调用函数的原型应用</li></ul><p id="1bdf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">从“my-lib”库项目</strong>中，发出<code class="fe lj lk ll lm b">npm link</code>命令:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="dea2" class="mf mg iq lm b gy nm nn l no np">npm link</span></pre><p id="1bad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在监视模式下开始汇总:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="fd1f" class="mf mg iq lm b gy nm nn l no np">npm run dev</span></pre><p id="d2fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们创建一个原型应用程序。</p><p id="c6e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">创建一个新的“我的应用程序”应用程序项目—</strong>在终端中，将cd放入您要创建应用程序的文件夹，并执行<code class="fe lj lk ll lm b">npm init</code>来初始化我们的新应用程序:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="897d" class="mf mg iq lm b gy nm nn l no np">mkdir my-app &amp;&amp; cd my-app<br/>npm init</span></pre><p id="83ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe lj lk ll lm b">npm init</code>中的所有默认值来创建我们简单的原型应用程序。</p><p id="0757" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成后，我们应该有两个文件夹:一个用于库项目，一个用于应用程序项目。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/c4f87bdc7f8ad4c229539cfda8f71dce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ESbBPHkcp2ZwhCrEuYDYw.png"/></div></div></figure><p id="cb3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们的应用程序也是打字稿，我们需要设置一些东西。</p><p id="1da0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过执行以下命令在我们的应用程序中安装TypeScript:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="f905" class="mf mg iq lm b gy nm nn l no np">npm install typescript --save-dev</span></pre><p id="c4e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在“package.json”中，我们需要添加两件东西:</p><ul class=""><li id="bca3" class="nu nv iq kf b kg kh kk kl ko nw ks nx kw ny la nz oa ob oc bi translated">将我们包的<code class="fe lj lk ll lm b">type</code>设置为<code class="fe lj lk ll lm b">module</code></li><li id="2539" class="nu nv iq kf b kg od kk oe ko of ks og kw oh la nz oa ob oc bi translated">添加一个<code class="fe lj lk ll lm b">start</code>脚本来执行我们的应用程序</li></ul><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="6d07" class="mf mg iq lm b gy nm nn l no np">"type": "module",<br/>"scripts": {<br/>  "start": "tsc &amp;&amp; node index.js"<br/>},</span></pre><p id="f26d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过添加库的package.json中的名称来链接要包含的库(我们的示例是:“my-lib”):</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="7445" class="mf mg iq lm b gy nm nn l no np">npm link my-lib</span></pre><p id="4e54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，在我们的应用程序的package.json中，我们应该链接到我们正在开发的库:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="6b0d" class="mf mg iq lm b gy nm nn l no np">"dependencies": {<br/>  "my-lib": "file:../my-lib"<br/>}</span></pre><p id="4329" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将“tsconfig.json”文件从库复制到应用程序，并为应用程序添加以下编译器选项以引用库源代码:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="9fd0" class="mf mg iq lm b gy nm nn l no np">"baseUrl": ".",<br/>"paths": {<br/>  "my-lib": ["node_modules/my-lib/src"],<br/>  "my-lib/*": ["node_modules/my-lib/src/*"]<br/>}</span></pre><p id="5e30" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们通过<code class="fe lj lk ll lm b">npm run start</code>运行应用程序时，我们可以从我们的库项目中调用函数。让我们试一试。</p><p id="d65a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在my-lib库项目中，将以下代码添加到“index.ts”中:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="0280" class="mf mg iq lm b gy nm nn l no np">export const sayHi = () =&gt; {<br/>  console.log("Hi");<br/>};</span></pre><p id="72eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在my-app项目中，导入并调用函数:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="e0e3" class="mf mg iq lm b gy nm nn l no np">import { sayHi } from "my-lib";<br/><br/>sayHi();</span></pre><p id="017a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过执行以下命令运行我的应用程序:</p><p id="a531" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lj lk ll lm b">npm run start</code></p><p id="f1a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在控制台中，您应该看到控制台日志输出“Hi”。</p><h2 id="8214" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">通过API提取器的类型</h2><p id="a41e" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">微软的<a class="ae kc" href="https://api-extractor.com/" rel="noopener ugc nofollow" target="_blank"> API提取器</a>使我们能够将类型声明汇总到一个文件中，我们可以用我们的库来分发这个文件。</p><p id="f2dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将以下npm软件包添加到库中:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="2165" class="mf mg iq lm b gy nm nn l no np">npm install @microsoft/api-extractor</span></pre><p id="b2f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个“api-extractor.json”配置文件，其中包含:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="cc93" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的package.json脚本中创建一个新任务来生成声明:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="f58c" class="mf mg iq lm b gy nm nn l no np">"scripts": {<br/>  "build:types": "tsc -p ./tsconfig.json --outDir build --declaration true &amp;&amp; api-extractor run",</span></pre><p id="117e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在执行<code class="fe lj lk ll lm b">build:types</code>任务，在可分发的“dist”文件夹中生成一个“index.d.ts ”:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="0a12" class="mf mg iq lm b gy nm nn l no np">npm run build:types</span></pre><h2 id="3f9f" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">证明文件</h2><p id="87ee" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">为了让用户理解这个库的API，最好创建和托管文档。类似于JSDoc，我们将利用<a class="ae kc" href="https://typedoc.org/" rel="noopener ugc nofollow" target="_blank"> TypeDoc </a>来创建文档。</p><p id="3b16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过执行以下命令将<code class="fe lj lk ll lm b">typedoc</code>添加到我们的package.json中:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="e32c" class="mf mg iq lm b gy nm nn l no np">npm install typedoc</span></pre><p id="92b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的package.json脚本中创建一个新任务来生成文档:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="081a" class="mf mg iq lm b gy nm nn l no np">"scripts": {<br/>  "docs": "typedoc src --out docs",</span></pre><p id="ae7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在执行<code class="fe lj lk ll lm b">docs</code>任务，在“docs”文件夹下生成文档:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="28da" class="mf mg iq lm b gy nm nn l no np">npm run docs</span></pre><p id="e584" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要托管文档，您可以将“docs”文件夹的内容推送到“gh-pages”分支，然后推送到GitHub托管；或者，从主分支的文件夹中提交用于将GitHub设置为主机的“docs”文件夹:</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/9f76e9c374f1186bda0eb5a2f9630262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ok78tMfBTTzs3dUv2UVyvQ.png"/></div></div></figure><h2 id="8261" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">最终考虑</h2><p id="23f8" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">最后，有一个好的自述文件，许可证，或任何其他信息和宣传网站将有助于促进你的图书馆和相应的财产。</p><h2 id="0de6" class="mf mg iq bd mh mi mj dn mk ml mm dp mn ko mo mp mq ks mr ms mt kw mu mv mw mx bi translated">出版</h2><p id="024d" class="pw-post-body-paragraph kd ke iq kf b kg my ki kj kk mz km kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">时间终于到了！</p><p id="0f94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，确保您登录到正确的npm帐户:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="21f9" class="mf mg iq lm b gy nm nn l no np">npm login</span></pre><p id="f067" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过以下方式向npm提交您的包裹:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="2d1b" class="mf mg iq lm b gy nm nn l no np">npm publish --access public</span></pre></div></div>    
</body>
</html>