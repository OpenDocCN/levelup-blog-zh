<html>
<head>
<title>Our Journey With Flutter and Dart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们的飞镖之旅</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/flutter-how-it-got-right-4865de34852?source=collection_archive---------0-----------------------#2018-05-26">https://levelup.gitconnected.com/flutter-how-it-got-right-4865de34852?source=collection_archive---------0-----------------------#2018-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d1de" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Flutter允许我们关注最重要的事情</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/462ef38fcd93bec414fa5d233eabd7e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VB0rBJul0wK2c0-oo3v3Jw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">颤振应用展示</figcaption></figure><p id="eb00" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我是<a class="ae lr" href="http://tanibox.com" rel="noopener ugc nofollow" target="_blank"> Tanibox </a>的创始人之一，还有<a class="ls lt ep" href="https://medium.com/u/ad05684425cf?source=post_page-----4865de34852--------------------------------" rel="noopener" target="_blank"> Asep </a>和他的妻子。作为董事会成员，我的职责通常是提供建议和指导。有一段时间，我们改变了我们的商业模式，需要创建一个可以在Android和iOS上运行的应用程序。当我们试图找出如何做到这一点时，我参与了进来。</p><p id="a301" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">起初，我们认为我们应该为每个平台单独创建一个本地应用程序。两个星期后，它没有工作。迭代对我们来说太慢了，我们知道我们真的需要在内部构建它。唯一可行的选择是使用React Native。但是我们不喜欢将<em class="lu">回归到Javascript的想法。</em></p><h1 id="6bf0" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">颤动是我们的救命稻草</h1><p id="40bb" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">我和Asep过去已经编写了许多原生iOS和Android应用程序。我们一致认为，最昂贵的投资是在用户界面和互动，因为它通常变化很快，所以我们想优化这一部分。我们最终聘请了一位经验丰富的移动工程师来编写我们的应用程序，并向他提出了探索Flutter的挑战。这一直很有效。这是我们到目前为止学到的:</p><h2 id="5239" class="ms lw iq bd lx mt mu dn mb mv mw dp mf le mx my mh li mz na mj lm nb nc ml nd bi translated">一种编写用户界面的敏捷方法</h2><p id="5a42" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">在两个平台上各自的UI框架中编写应用程序的问题是需要时间、金钱和专业知识。每个平台都有自己的行为，每个公司都有自己的品牌和用户界面指南，这些指南可能与平台所有者提出的指南一致，也可能不一致。这也花费了<strong class="kx ir">大部分</strong>的开发时间。我们只是一个小公司，我们想快速测试我们的产品。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/76333d8bf3166a190b346f09ecd11945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Pyl25hRb9PmY11xCtBYY2Q.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">颤振建筑</figcaption></figure><p id="40b0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">颤振框架是在颤振引擎之上编写的。该引擎负责三个平台渲染器的抽象:Android、iOS和Fuchsia。该框架专注于UI小部件呈现。它基于Skia实现了自己的渲染栈。它不使用iOS的<code class="fe nf ng nh ni b">UIView</code>或者Android的<code class="fe nf ng nh ni b">View</code>类。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/b5de126a1639f02a03cc9190dd58c111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P_2I6p77rcfmBCvJzrx_ug.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">糖果粉碎传奇vs愤怒的小鸟:爆炸</figcaption></figure><p id="abe7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">游戏引擎这么做已经很久了。每个游戏引擎都有自己的UI渲染库，这使得游戏开发者能够在所有平台上使用自己的品牌、风格和交互来构建UI。游戏甚至不遵守“UI准则”，因为它们需要脱颖而出。</p><p id="f473" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在的应用程序倾向于围绕品牌而不是平台来设计。如果人们已经熟悉了一个平台上的应用程序，他们希望它在另一个平台上表现相同。品牌一致性很重要。这是我们想要达到的目标。</p><p id="3b31" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Flutter还处理自己的动画和手势。这使得Flutter在UI小部件如何组成以及用户如何以类似的方式与它们交互方面拥有完全的自由。Flutter使我们能够基于我们的品牌来编写我们的UI。颤振的制作方式符合我们的要求。</p><p id="5d70" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">事实证明，在集成到后端之前，我们花了大量的时间来构建和调整UI。总有一些“东西”需要快速调整。Flutter支持调试构建期间的热重载。这意味着开发人员可以调整和运行，并看到结果。这使得我们能够快速迭代两个平台的UI。在释放模式下，flutter会吐出<a class="ae lr" href="https://en.wikipedia.org/wiki/Ahead-of-time_compilation" rel="noopener ugc nofollow" target="_blank"> AOT编译的代码</a>。</p><h2 id="048a" class="ms lw iq bd lx mt mu dn mb mv mw dp mf le mx my mh li mz na mj lm nb nc ml nd bi translated">与后端保持一致的通信方式</h2><p id="6560" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">我们的后端是用Go编写的，它公开了一个RESTful API。为了让它有效地工作，我们创建了SDK来无缝地访问服务器端点。如果我们要在Android和iOS中分别实现它们，我们将需要创建两个不同的库，因为它们对HTTP和JSON进行不同的编组和解组。</p><p id="9241" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢Dart的<a class="ae lr" href="https://pub.dartlang.org/packages/http" rel="noopener ugc nofollow" target="_blank"> HTTP </a>包、<a class="ae lr" href="https://pub.dartlang.org/packages/built_value" rel="noopener ugc nofollow" target="_blank">build _ value</a>和<a class="ae lr" href="https://pub.dartlang.org/packages/built_collection" rel="noopener ugc nofollow" target="_blank">build _ collection</a>，我们能够编写具有不可变数据结构的异步客户端SDK。Android和iOS应用程序以及web应用程序都使用这个SDK，因为后来我们决定使用Angular Dart编写我们的仪表板，以便能够进一步利用我们共享的Dart SDK。</p><p id="8793" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就在最近，dart团队甚至<a class="ae lr" href="https://medium.com/dartlang/announcing-official-grpc-support-for-dart-6c9b50357af6" rel="noopener">宣布gRPC支持Dart </a>。这太棒了，因为这将实现更好的集成，因为我们计划在不久的将来在我们的服务中使用gRPC。</p><h2 id="204f" class="ms lw iq bd lx mt mu dn mb mv mw dp mf le mx my mh li mz na mj lm nb nc ml nd bi translated">静态类型语言</h2><p id="1650" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">我们强烈主张尽可能使用静态类型语言。我们喜欢用事物的类型来表达它。这就是我们最初决定不使用React Native的原因。</p><p id="cb58" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Dart并不完美，但它有我们需要的东西:一种结合了编译时类型检查和运行时类型检查的静态类型语言。它内置了异步使用future和<code class="fe nf ng nh ni b">async-await</code>的机制。它在处理事件和网络数据包方面帮助巨大。</p><p id="6b5b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Dart类似于Java。我们的Dart API SDK是由我们的后端工程师编写的。我们并没有真正按照层来分隔工程师，拥有Dart这样的语言使我们的后端工程师可以在纯Dart中为所有三个平台创建一个SDK。这种语言很容易掌握，为我们节省了大量时间。</p><h1 id="cd47" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">但是颤动也让我们痛苦</h1><p id="42e2" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">而Flutter节省了我们的时间和金钱投资。这也是一种风险。这条推文显示了我在帮助亚马逊Cognito团队工作时的沮丧。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/21b3983c3096d56bb320c04e35686bc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*4-5SRYNrrkdCS9dRwOCY1g.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">我心慌意乱</figcaption></figure><h2 id="912d" class="ms lw iq bd lx mt mu dn mb mv mw dp mf le mx my mh li mz na mj lm nb nc ml nd bi translated">Dart标准库中可能的错误</h2><p id="e87a" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated"><em class="lu">编辑:这个已经搞定了。<br/> </em>我们当时没有使用稳定通道，因为从Dart 1到Dart 2的变化很大，我们<strong class="kx ir">确实</strong>需要Dart 2的特性。有一个特别让我恼火的bug是dart dev频道在0.54版本之前的<code class="fe nf ng nh ni b">modpow(x^y mod N)</code> bug。Amazon Cognito正在利用SRP和RSA来认证和验证令牌，我需要正确的<code class="fe nf ng nh ni b">modpow</code>实现的<code class="fe nf ng nh ni b">BigInt</code>。我从其他人那里收集代码。谢天谢地，Google有dart代码处理简单的RSA。我看着它们，发现我的代码是正确的，但是Dart实现有问题。</p><h2 id="202f" class="ms lw iq bd lx mt mu dn mb mv mw dp mf le mx my mh li mz na mj lm nb nc ml nd bi translated">文献稀缺</h2><p id="c411" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated"><em class="lu">编辑:这是在进步，但还是有欠缺。<br/> </em>当我第一次使用谷歌自己创建的库时，比如<code class="fe nf ng nh ni b">built_value</code>和<code class="fe nf ng nh ni b">built_collections</code>，文档几乎为零。在许多场合，我需要偷看GitHub上的源代码，以了解发生了什么以及如何使用它。谢天谢地，谷歌发布源代码的标准中有很多例子。</p><h2 id="c05e" class="ms lw iq bd lx mt mu dn mb mv mw dp mf le mx my mh li mz na mj lm nb nc ml nd bi translated">需要自己动手建造东西</h2><p id="f9b1" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">在我编写这个应用的时候，还没有针对Dart的Amazon Cognito SDK，所以我需要遵循他们的文档，使用raw <code class="fe nf ng nh ni b">curl</code>进行测试，查看用其他语言编写的源代码，然后在Dart中重新实现它。</p><p id="1eaa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们不能依赖为Dart编写的库的可用性。Cognito就是一个例子。对我来说，这是有趣的部分。但是对其他人来说，这可能是不可行的。我花了很多时间和咖啡来弄清楚Dart中这些东西是如何工作的，一旦我能弄清楚它们，我就得到回报。只需很小的改动，它就可以在所有三个平台上使用。</p><h1 id="0dcb" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">结论</h1><p id="ad5d" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">使用前沿技术会有风险，但是使用Flutter和Dart的风险是值得投资的。事实上，我们使用dev频道只是让我们觉得我们在与谷歌的Flutter和Dart团队一起工作，并始终跟踪问题。</p><p id="341d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们设法用一个客户端开发人员和一个后端开发人员在3周内构建了我们的第一个原型。如果我们用它们各自的IDE和语言编写它们，这是不可能的。</p><p id="e4cc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想知道我们正在制作什么样的应用程序，我们的首席执行官将在未来几个月我们的产品准备就绪时宣布。敬请关注。</p></div></div>    
</body>
</html>