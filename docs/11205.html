<html>
<head>
<title>How to Monitor On-chain Events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何监控连锁事件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-monitor-on-chain-events-dc56a501b173?source=collection_archive---------1-----------------------#2022-02-25">https://levelup.gitconnected.com/how-to-monitor-on-chain-events-dc56a501b173?source=collection_archive---------1-----------------------#2022-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ba1f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">区块链开发教程03</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/25818c0097c98fdddb7c03761de330d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p3SMI2GHkmQpi0No7A_S-g.png"/></div></div></figure><p id="7e03" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">获取链上操作的状态对于各种应用程序都很重要。当用户使用您的dApp(标记令牌、铸造NFT等)时，为了提供交互式用户体验，您需要监控链上事件。</p><p id="abff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，我将介绍如何收听链上事件。你可能会对它的简单程度感到惊讶。总的来说，只有两步<strong class="kt ir">来设置显示器:</strong></p><ol class=""><li id="5332" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">在<strong class="kt ir">智能契约</strong>中定义并发出事件。</li><li id="e35e" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">在您的<strong class="kt ir">前端</strong>中定义并注册事件监听器。</li></ol><h2 id="b78b" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated">第一步。在智能协定中定义和发出事件。</h2><p id="aaee" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">让我们假设我们正在构建一个NFT项目。您想知道何时铸造NFT，并获取用户的地址和相应的NFT令牌id。下面是如何定义这样的事件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="5653" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，您可以通过以下代码在智能协定中发出事件。您可以根据智能合约的上下文来更改变量。这里我使用<code class="fe nb nc nd ne b">msg.sender</code>和<code class="fe nb nc nd ne b">nftTokenId</code>只是为了说明的目的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><h2 id="b5fd" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated">第二步。在前端定义和注册事件监听器。</h2><p id="a876" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">我的web开发首选框架是Vue。JS (Vue 3)，所以我将在本教程中使用它。但是这个概念是通用的，JavaScript代码应该非常相似。</p><p id="b44e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是在您的前端设置事件监听器的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><ul class=""><li id="2283" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm nf lt lu lv bi translated">在第3行，它调用返回一个<code class="fe nb nc nd ne b">ethers.contract</code>对象的<code class="fe nb nc nd ne b">getContract</code>函数(在代码的其他地方定义，参见下面的<strong class="kt ir">附录</strong>),它的<a class="ae ng" href="https://docs.ethers.io/v5/api/contract/contract/" rel="noopener ugc nofollow" target="_blank">文档在这里</a>。</li><li id="2186" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nf lt lu lv bi translated">在第5行，我们使用<code class="fe nb nc nd ne b">ethers.contract</code>对象的<code class="fe nb nc nd ne b">on</code>方法在事件发生时订阅事件调用监听器。这里我们为这个方法提供两个输入:(1)事件名称<code class="fe nb nc nd ne b">NFTMinted</code>，与智能契约中定义的相同。(2)一个回调函数，在这个函数中你可以指定当事件发生时你的前端逻辑将被触发。</li></ul><p id="aa7a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们有了事件监听器函数，最后要做的就是当用户连接到他们的钱包时实际调用这个函数。</p><h2 id="345c" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated">附录</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="9606" class="nh mc iq bd md ni nj nk mg nl nm nn mj jw no jx mm jz np ka mp kc nq kd ms nr bi translated">离别赠言</h1><p id="d1e6" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">你有它！我希望这篇教程能帮助你理解网站如何收听链上事件。如果您有任何问题或建议，请随时发表评论。如果你想让我写其他关于区块链发展的话题，也请告诉我！</p><pre class="kg kh ki kj gt ns ne nt nu aw nv bi"><span id="4a4b" class="mb mc iq ne b gy nw nx l ny nz"><strong class="ne ir">Want to Connect?</strong>Please feel free to reach out (<a class="ae ng" href="https://www.linkedin.com/in/zhaosicong/" rel="noopener ugc nofollow" target="_blank">my LinkedIn</a>).</span></pre></div></div>    
</body>
</html>