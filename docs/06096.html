<html>
<head>
<title>Struct Field Tags in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Go中的结构字段标记</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/struct-field-tags-in-go-fcc2428a1f91?source=collection_archive---------10-----------------------#2020-10-26">https://levelup.gitconnected.com/struct-field-tags-in-go-fcc2428a1f91?source=collection_archive---------10-----------------------#2020-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5a2f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">向数据中添加元信息。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4cbef98ae903480d03f3844af6434975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7XmP1oQslKIIDst0V0gXyg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">安妮·斯普拉特在<a class="ae ky" href="https://unsplash.com/s/photos/tags?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</figcaption></figure><p id="67dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Go不是纯粹的面向对象编程语言。它不提供类，但是它提供了<a class="ae ky" href="https://golang.org/ref/spec#Struct_types" rel="noopener ugc nofollow" target="_blank">结构</a>。</p><p id="6774" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如<a class="ae ky" href="https://golang.org/ref/spec#Struct_types" rel="noopener ugc nofollow" target="_blank">语言规范</a>所述:</p><blockquote class="lv lw lx"><p id="d67b" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">结构是一系列命名元素，称为字段，每个字段都有一个名称和一个类型。</p></blockquote><p id="7ae1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您想要为数据定义一个由不同属性(字段)组成的模式时，可以使用struct。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="fecb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以识别一个字段:</p><ul class=""><li id="c512" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">显式:和上面的<code class="fe mn mo mp mq b">Person</code>结构一样，所有的字段都在同一个结构中声明。</li><li id="1813" class="me mf it lb b lc mr lf ms li mt lm mu lq mv lu mj mk ml mm bi translated">隐式:和在<code class="fe mn mo mp mq b">User</code>结构中一样，它嵌入了来自<code class="fe mn mo mp mq b">Person</code>结构的字段。它也称为嵌入字段。您可以像在结构本身内部声明一样访问它们。</li></ul><h1 id="6026" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">标签</h1><p id="3a83" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">每个字段后面可以跟一个可选的字符串文字，称为<em class="ly">标签</em>。该标签将成为该字段的属性。</p><p id="8213" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是为结构添加元信息的一种方式。您的包或外部包可以使用这些信息，以便它们知道如何执行给定的操作或正确处理数据。</p><p id="13ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个元数据使用格式为<code class="fe mn mo mp mq b">key:"value"</code>的字符串来声明，并由空格分隔。也就是说，在同一个字段中可以有多个标签，服务于不同的目的和库。</p><pre class="kj kk kl km gt nt mq nu nv aw nw bi"><span id="b7cb" class="nx mx it mq b gy ny nz l oa ob">type T struct {<br/>  Field fieldtype `key1:"value1" key2:"value2"`<br/>}</span></pre><p id="c418" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个包都有自己的<code class="fe mn mo mp mq b">key</code>名称，通常是包本身的名称。</p><p id="99d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些使用示例:</p><ul class=""><li id="27be" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">编码/解码目的(如<code class="fe mn mo mp mq b"><a class="ae ky" href="https://golang.org/pkg/encoding/json/" rel="noopener ugc nofollow" target="_blank">json</a></code>和<code class="fe mn mo mp mq b"><a class="ae ky" href="https://golang.org/pkg/encoding/xml/" rel="noopener ugc nofollow" target="_blank">xml</a></code>包)；</li><li id="20a6" class="me mf it lb b lc mr lf ms li mt lm mu lq mv lu mj mk ml mm bi translated">ORM(像<a class="ae ky" href="https://godoc.org/github.com/astaxie/beego/orm" rel="noopener ugc nofollow" target="_blank"> Beego </a>和<a class="ae ky" href="https://github.com/jinzhu/gorm" rel="noopener ugc nofollow" target="_blank">Gorm</a>)；</li><li id="2558" class="me mf it lb b lc mr lf ms li mt lm mu lq mv lu mj mk ml mm bi translated">验证(像这里的<a class="ae ky" href="https://github.com/asaskevich/govalidator" rel="noopener ugc nofollow" target="_blank"/>)；</li><li id="1de4" class="me mf it lb b lc mr lf ms li mt lm mu lq mv lu mj mk ml mm bi translated">配置管理；</li><li id="00f5" class="me mf it lb b lc mr lf ms li mt lm mu lq mv lu mj mk ml mm bi translated">结构的默认值。</li></ul><h1 id="cfb7" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">反射</h1><p id="e9b9" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">为了实际访问标签并使用它们，您必须使用<code class="fe mn mo mp mq b"><a class="ae ky" href="https://golang.org/pkg/reflect/" rel="noopener ugc nofollow" target="_blank">reflect</a></code>包。</p><p id="75b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果使用常规格式，我们可以使用两种方法<code class="fe mn mo mp mq b"><a class="ae ky" href="https://golang.org/pkg/reflect/#StructTag" rel="noopener ugc nofollow" target="_blank">StructTag</a></code>来检索关于标签的信息，<code class="fe mn mo mp mq b">Get</code>和<code class="fe mn mo mp mq b">Lookup</code>。</p><blockquote class="lv lw lx"><p id="717e" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">注意</strong>:<code class="fe mn mo mp mq b">Lookup</code>方法返回一个额外的值<code class="fe mn mo mp mq b">ok</code>，指示标签是否在字段中被找到。</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><h1 id="a865" class="mw mx it bd my mz oj nb nc nd ok nf ng jz ol ka ni kc om kd nk kf on kg nm nn bi translated">例子</h1><p id="7991" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">让我们创建一个如何使用它的例子。</p><p id="37f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，让我们创建一个名为<code class="fe mn mo mp mq b">color</code>的标签，它将指示我们要打印字段的颜色。为了简单起见，唯一可用的颜色是<code class="fe mn mo mp mq b">blue</code>、<code class="fe mn mo mp mq b">red</code>和<code class="fe mn mo mp mq b">yellow</code>。</p><blockquote class="lv lw lx"><p id="ce61" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">注意</strong>:对于这个例子，我使用的是包<code class="fe mn mo mp mq b"><a class="ae ky" href="https://github.com/fatih/color" rel="noopener ugc nofollow" target="_blank">color</a></code>。</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="963f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数<code class="fe mn mo mp mq b">PrintWithColor</code>将为我们完成这项工作。它接收一个对象并检查标签<code class="fe mn mo mp mq b">color</code>的所有字段。如果找到它，它将为控制台设置适当的颜色并打印该值。如果没有，它只是打印值。</p><p id="41ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果运行它，您可能会得到如下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/5de81820b010c135956b6d5832bcfda6.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*6dgZYzg51cAdTKpRr5XhiQ.png"/></div></figure><p id="6279" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这个例子很简单，但是你可以得到在结构中使用标签的想法。更高级的使用，可以查看<code class="fe mn mo mp mq b"><a class="ae ky" href="https://golang.org/pkg/encoding/json/" rel="noopener ugc nofollow" target="_blank">json</a></code>包。</p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><h1 id="4e33" class="mw mx it bd my mz oj nb nc nd ok nf ng jz ol ka ni kc om kd nk kf on kg nm nn bi translated">结论</h1><p id="1910" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">结构是Go语言的重要组成部分，也是表示数据的强大方法。</p><p id="59b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用字段标签，您可以向字段添加功能，或者将它们配置为您想要的行为。</p><p id="af7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将使你的代码更整洁，可读性更强。</p></div></div>    
</body>
</html>