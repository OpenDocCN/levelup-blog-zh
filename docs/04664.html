<html>
<head>
<title>I Changed the Value of 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我改变了1的值</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/i-changed-the-value-of-1-eb3a90529648?source=collection_archive---------13-----------------------#2020-07-08">https://levelup.gitconnected.com/i-changed-the-value-of-1-eb3a90529648?source=collection_archive---------13-----------------------#2020-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6b88" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">打破Python</h2><div class=""/><div class=""><h2 id="f105" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">彻底摧毁Python的最有趣的方法</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/5b8403c88bb4e8edfdc7450107b7fa1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qA_m1EPjfjjS6PmE_K3P6g.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@coopery?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">穆罕默德·诺哈西</a>在<a class="ae lh" href="https://unsplash.com/s/photos/fire?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8ee6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我在为上一篇文章做研究时，看到了Python文档中一段非常有趣的引文:</p><blockquote class="me mf mg"><p id="67ba" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">当前的实现为<code class="fe ml mm mn mo b">-5</code>和<code class="fe ml mm mn mo b">256</code>之间的所有整数保留了一个integer对象数组，当你在这个范围内创建一个int时，你实际上只是得到了一个对现有对象的引用。所以应该可以改变<code class="fe ml mm mn mo b">1</code>的值。我怀疑Python在这种情况下的行为是不确定的。:-)</p></blockquote><p id="94ce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python中的一切都是对象——包括数字。这很重要，因为数字<code class="fe ml mm mn mo b">-5...256</code>是在运行时分配的，访问它们会返回对对象的引用，因此允许您永久更改这些数字的值(在Python实例中)。现在这有多少实际用途，我真的不知道，但它肯定是有趣的。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="b6e2" class="mw mx it bd my mz na nb nc nd ne nf ng ki nh kj ni kl nj km nk ko nl kp nm nn bi translated">热身</h1><p id="55b9" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">你需要一些基本的C语言知识和<code class="fe ml mm mn mo b">ctypes</code>库。让我们从改变一个相对不用的数字的值开始，比如说31:</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="56ba" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; import ctypes<br/>&gt;&gt;&gt; def changeNum(oldNum, newNum):<br/>...     ctypes.cast(id(oldNum), ctypes.POINTER(ctypes.c_int))[6] = newNum<br/><br/>&gt;&gt;&gt; changeNum(31, 100) # changes 31 to 100<br/>&gt;&gt;&gt; 31<br/>100</span></pre><p id="55fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们尝试一些基本的算术:</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="5c9c" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; 31 + 31<br/>200<br/>&gt;&gt;&gt; 31 ** 0.5<br/>10.0<br/>&gt;&gt;&gt; 31 ** 2<br/>10000</span></pre><p id="fabe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种输出让我存在不舒服，如果你也有这种感觉，我对即将发生的事情感到抱歉。让我们现在真正挑战一下:</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="b07f" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; 31 == 100<br/>True<br/>&gt;&gt;&gt; changeNum(100, 200)<br/>&gt;&gt;&gt; 31<br/>100<br/>&gt;&gt;&gt; 100<br/>200<br/>&gt;&gt;&gt; 31 == 100<br/>False<br/>&gt;&gt;&gt; 31 == 200<br/>False<br/>&gt;&gt;&gt; 31 * 2 == 200<br/>True<br/>&gt;&gt;&gt; 31 * 2 == 100<br/>True</span></pre><p id="ee8e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦你改变了价值，它就没了。您可以尝试恢复原始值，但您已经删除了它。</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="efde" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; changeNum(100, 500 // 5)<br/>&gt;&gt;&gt; 100<br/>200<br/>&gt;&gt;&gt; changeNum(100, 50 * 2)<br/>&gt;&gt;&gt; 100<br/>200</span></pre></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="277b" class="mw mx it bd my mz na nb nc nd ne nf ng ki nh kj ni kl nj km nk ko nl kp nm nn bi translated">绝对的混乱</h1><p id="4d0f" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">如果你还没有意识到，对象本身是全局改变的。这意味着任何与该数字的交互都是“未定义的”。让我们看看<code class="fe ml mm mn mo b">for</code>循环中的行为是如何“定义”的:</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="58dd" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; changeNum(5, 100)<br/>&gt;&gt;&gt; for i in range(5):<br/>...     print(i)<br/>...<br/>0<br/>1<br/>2<br/>...<br/>99</span></pre><p id="e1f0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">挺标准的；这是一个不一致的数字系统所能达到的标准。更奇怪的是:如果我改变<code class="fe ml mm mn mo b">5</code>的值，<code class="fe ml mm mn mo b">5</code>在技术上不再存在。这可能导致基本操作中非常奇怪的交互:</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="e266" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; changeNum(5, 20)<br/>&gt;&gt;&gt; 5 - 7 == 13<br/>True<br/>&gt;&gt;&gt; 5 - 7 - 8 == 5<br/>True</span></pre><p id="06fc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你真的想伤害你的大脑，那就再弄乱几个数字，做些数学计算:</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="01d4" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; changeNum(29, 100)<br/>&gt;&gt;&gt; changeNum(5, 20)<br/>&gt;&gt;&gt; changeNum(120, 200)<br/>&gt;&gt;&gt; 5 + 9<br/>100<br/>&gt;&gt;&gt; 5 + 9 + 5<br/>200<br/>&gt;&gt;&gt; 5 + 9 + 5 + 5<br/>220<br/>&gt;&gt;&gt; (5 + 9) * 5<br/>2000<br/></span></pre><p id="20ea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你也可以做一个非常混乱的无限循环:</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="8cc0" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; while 5 // 4 == 5:<br/>...     pass<br/>...     # Do loop stuff</span></pre></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="2542" class="mw mx it bd my mz na nb nc nd ne nf ng ki nh kj ni kl nj km nk ko nl kp nm nn bi translated">崩溃的Python</h1><p id="863f" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">现在让我们去抓大鱼；我们已经处理了其他不太重要的数字，但是如果我们改变<code class="fe ml mm mn mo b">1</code>会发生什么？</p><pre class="ks kt ku kv gt nt mo nu nv aw nw bi"><span id="5819" class="nx mx it mo b gy ny nz l oa ob">&gt;&gt;&gt; changeNum(1, 2)<br/>&gt;&gt;&gt; 1<br/>Segmentation fault (core dumped)</span></pre><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oc od l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">至少可以说，不为所动</figcaption></figure><p id="2190" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它崩溃了。这并不奇怪，因为在非常重要的计算中,<code class="fe ml mm mn mo b">1</code>是一个非常重要的数字。我不确定改变<code class="fe ml mm mn mo b">1</code>是否会影响<code class="fe ml mm mn mo b">True</code>，但如果会，我不敢想象后果。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="e0d3" class="mw mx it bd my mz na nb nc nd ne nf ng ki nh kj ni kl nj km nk ko nl kp nm nn bi translated">最后的话</h1><p id="b13a" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">Python很神奇，即使这些交互看起来很痛苦，我仍然觉得它们很酷，我希望你也一样。你可以用这个来捉弄朋友或同事，让他们发疯，因为他们试图找出为什么<code class="fe ml mm mn mo b">5</code>不是<code class="fe ml mm mn mo b">5</code>。</p><p id="66cc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果没有这篇<a class="ae lh" href="https://www.reddit.com/r/Python/comments/2441cv/can_you_change_the_value_of_1/" rel="noopener ugc nofollow" target="_blank"> Reddit帖子</a>和令人惊叹的<a class="ae lh" href="https://github.com/satwikkansal/wtfpython" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>，这篇文章是不可能完成的，我强烈建议去看看它们。</p><p id="912f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">谢谢你陪我度过这段时间。</p></div></div>    
</body>
</html>