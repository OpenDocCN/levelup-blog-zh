# å¤§å°å¾ˆé‡è¦â€”â€”é¢¤æŒ¯ä¾èµ–æ€§ç®¡ç†

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/size-does-matter-flutter-dependency-management-162cb16acb62>

![](img/321179d7b5e6ea1697b1ff8459b1bf10.png)

ä½ å¥½ğŸ‘‹æˆ‘å« Lukeï¼Œæ˜¯ä¸€åè½¯ä»¶å¼€å‘äººå‘˜ã€‚åœ¨æˆ‘ä¸ JS åŒ…ç®¡ç†äººå‘˜ä¸€èµ·å·¥ä½œçš„è¿™äº›å¹´é‡Œï¼Œæˆ‘ä»æ¥æ²¡æœ‰æƒ³è¿‡äº‹æƒ…å¯ä»¥ç”¨ä¸åŒçš„æ–¹å¼æ¥å®Œæˆã€‚æˆ‘åªæ˜¯æ¥å—äº†å®ƒçš„å·¥ä½œæ–¹å¼ã€‚ç›´åˆ°æˆ‘å¼€å§‹å’Œ Flutter åˆä½œã€‚æœ‰ä¸œè¥¿å‘å‡ºäº†å£°éŸ³ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„æƒ³æ³•ğŸ‘‡

> æˆ‘å°†ä¸»è¦æ¯”è¾ƒ Flutter package/dependency management solution å’Œ npmï¼Œå› ä¸ºå¤§å¤šæ•°ä¸»è¦çš„å‰ç«¯æ¡†æ¶éƒ½å†…ç½®äº†å®ƒã€‚

# 1.æˆ‘ä»¬éƒ½ä¹ æƒ¯äº†ä»€ä¹ˆï¼Œå®ƒæ˜¯å¦‚ä½•é£˜åŠ¨çš„

å¤§å¤šæ•°å‰ç«¯æ¡†æ¶éƒ½æ˜¯å›´ç»•åƒ npm è¿™æ ·çš„åŒ…ç®¡ç†å™¨æ„å»ºçš„ï¼Œè¿™äº›åŒ…ç®¡ç†å™¨ä¸‹è½½å¹¶å­˜å‚¨æ¯ä¸ªé¡¹ç›®ç›®å½•ä¸‹çš„ä¾èµ–é¡¹ï¼Œè¿™äº›ç›®å½•éƒ½æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€é»‘æš—çš„æ•´ä½“å¤§å°çš„ç›®å½•`node_modules.`

![](img/197ce123b267c90b60578777c4e59b68.png)

å› æ­¤ï¼Œå¦‚æœä½ æ˜¯ä¸€ä¸ªåœ¨å¤šä¸ªå‰ç«¯é¡¹ç›®ä¸Šå·¥ä½œçš„å¼€å‘äººå‘˜ï¼Œä½ è‚¯å®šæœ‰å‡ ä¸ª node_modules ç›®å½•ã€‚äº‹æƒ…æ˜¯è¿™æ ·çš„â€”â€”å¼€å‘è€…æ˜¯ä¹ æƒ¯æ€§çš„ç”Ÿç‰©ï¼Œå½“æ¶‰åŠåˆ°æˆ‘ä»¬ä½¿ç”¨çš„è½¯ä»¶åŒ…æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸æœ‰è‡ªå·±çš„é€‰æ‹©ã€‚å¯ä»¥è‚¯å®šåœ°è¯´ï¼Œè¿™äº› node_modulse ä¸­çš„æ¯ä¸€ä¸ªéƒ½æœ‰ç›¸ä¼¼çš„(å¦‚æœä¸æ˜¯ç›¸åŒçš„)ä¾èµ–å…³ç³»ã€‚å¦‚æœ node_modules ä¸æ˜¯æ¯æ¬¡éƒ½é‚£ä¹ˆå¤§å°±ä¸æ˜¯é—®é¢˜äº†ã€‚

ä¾‹å¦‚:

æ‚¨ä»äº‹ä¸‰ä¸ªå¸¸è§„çš„ã€éæŠ–åŠ¨çš„å‰ç«¯é¡¹ç›®ï¼Œå…¶ä¸­ node_module å¹³å‡é‡é‡çº¦ä¸º 600 MBï¼Œå¤§çº¦ä¸ºè¿™äº›ä¾èµ–é¡¹åˆ†é…äº† 1.8 GB çš„å†…å­˜ã€‚

è¿™å°±æ˜¯ Flutter ä¹‹å‰çš„ä¸€åˆ‡ã€‚

## Flutter å¦‚ä½•å¤„ç†ä¾èµ–æ€§

Flutter ä¸åƒ npm é‚£æ ·ä¸ºæ¯ä¸ªé¡¹ç›®å•ç‹¬ä¸‹è½½ä¾èµ–é¡¹ï¼Œè€Œæ˜¯å°†å®ƒä»¬ä¸‹è½½åˆ°ä¸€ä¸ªç›®å½•ä¸­:

```
~/.pub-cache
```

è¿™ä¸ªç›®å½•åœ¨ä½ æ‰€æœ‰çš„ Flutter åº”ç”¨ä¹‹é—´å…±äº«ã€‚

è¿™ç§å¾®å¦™å˜åŒ–çš„ç»“æœæ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…åœ¨æ¯ä¸ªé¡¹ç›®ä¸­å­˜å‚¨ç›¸åŒä¾èµ–é¡¹çš„å‰¯æœ¬ã€‚

ç»™ä½ ä¸€äº›æ•°å­—â€”â€”æˆ‘æœ€è¿‘åšäº†å¤§çº¦ 12 ä¸ªé¢¤æŒ¯é¡¹ç›®ã€‚è¿™äº›é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–é¡¹éƒ½ä½¿ç”¨ä¸è¿™ä¸‰ä¸ª node_module é¡¹ç›®å¤§çº¦ç›¸åŒçš„å­˜å‚¨é‡â€” **1.8GBï¼Œ**ã€‚

åœ¨æˆ‘çœ‹æ¥ï¼ŒFlutter åšå¾—æ›´å¥½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°ºå¯¸ç¡®å®å¾ˆé‡è¦ã€‚

## JS ä¾èµ–ç®¡ç†å™¨è¿˜æœ‰å¸Œæœ›å—ï¼Ÿ

å½“ç„¶æœ‰ï¼ä¸ä»…ä»…æ˜¯å› ä¸ºè¿™ç¯‡æ–‡ç« æ›´å¤šçš„æ˜¯å±•ç¤º npm å’Œ Flutter åœ¨å¤„ç†ä¾èµ–å…³ç³»ä¸Šçš„ä¸åŒã€‚Npm å®Œæˆäº†å·¥ä½œï¼Œå¹¶ä¸”å·²ç»ä¸ºå®ƒçš„ç›®çš„æœåŠ¡äº†å¾ˆé•¿æ—¶é—´â€”â€”è¿™æ‰æ˜¯æœ€é‡è¦çš„ï¼

å½“æˆ‘å¯¹ç»ç†ä»¬åšäº†ä¸€äº›è°ƒæŸ¥æ—¶ï¼Œæˆ‘å’Œæˆ‘çš„æœ‹å‹èŠå¾—å¾ˆå¼€å¿ƒï¼Œä»–å‘Šè¯‰æˆ‘å…³äº [yarn workspaces](https://classic.yarnpkg.com/en/docs/workspaces/) çš„äº‹æƒ…ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ç±»ä¼¼äº Flutter åœ¨ä¸€ä¸ªåœ°æ–¹å­˜å‚¨åŒ…çš„æ–¹å¼ï¼Œä½†ä¸æ˜¯å¼€ç®±å³ç”¨ã€‚è¿™æ›´åƒæ˜¯ç»´æŠ¤ monorepo åŒ…çš„ä¸€ç§æ–¹å¼ï¼Œè€Œä¸æ˜¯é©»ç•™åœ¨ä¸»æœºä¸Šçš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚æˆ‘å¯èƒ½é”™äº†ï¼Œè¯·åœ¨è¿™é‡Œ[ç¡®è®¤ä¸€ä¸‹](https://classic.yarnpkg.com/en/docs/workspaces/)ã€‚

åœ¨è¿™ä¸ªå¿«é€Ÿç ”ç©¶ä¸­å‡ºç°çš„å¦ä¸€ä¸ªå·¥å…·æ˜¯ [lerna](https://lerna.js.org) ï¼Œå®ƒä¼¼ä¹æ˜¯ yarn workspaces æä¾›çš„æ›´é«˜çº§ç‰ˆæœ¬ã€‚

å¦‚æœä½ æ˜¯ä¸€ä¸ª JS å¼€å‘äººå‘˜ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ çœ‹çœ‹è¿™ä¸¤ä¸ªå·¥å…·ï¼

çœ‹çœ‹æˆ‘æ‰€å‘ç°çš„ï¼Œæˆ‘ç¡®ä¿¡å…¶ä»–çš„ä¾èµ–ç®¡ç†å™¨å°†ä¼šå‡ºç°ï¼Œä»–ä»¬è‚¯å®šä¼šå¸¦æ¥æ–°çš„ä¸œè¥¿ã€‚è‚¯å®šæœ‰å¸Œæœ›ï¼

# ä¸ä»…å¦‚æ­¤ï¼Œæ–‡æ¡£å‘¢ï¼Ÿ

æˆ‘æ›¾ç»è¯•å›¾åˆ›å»ºä¸€ä¸ª npm åŒ…ã€‚æˆ‘å¤±è´¥äº†ï¼Œä½†é‚£æ˜¯å¾ˆä¹…ä»¥å‰çš„äº‹äº†ï¼Œæ‰€ä»¥æˆ‘åˆè¯•äº†ä¸€æ¬¡ã€‚è®©æˆ‘å‘Šè¯‰ä½ æ²¡é‚£ä¹ˆç³Ÿç³•â€¦

ä¸è¿‡ï¼Œæˆ‘è§‰å¾— Flutter åšå¾—æ›´å¥½ã€‚æˆ‘æƒ³æå‡æˆ‘çš„è‡ªå°Šï¼Œå¹¶è®¤ä¸ºæˆ‘ä½¿ç”¨ä¸åŒçš„å·¥å…·å˜å¾—æ›´æœ‰æ•ˆç‡äº†ğŸ˜‰

é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»ç„¶è®¤ä¸º npm æ–‡æ¡£ä¸ Flutter çš„ç›¸æ¯”æœ‰æ‰€æ¬ ç¼ºã€‚å¦‚æœä½ ä¸ç›¸ä¿¡æˆ‘ï¼Œè‡ªå·±çœ‹çœ‹ [npm æ–‡æ¡£](https://docs.npmjs.com/getting-started)å’Œ[é¢¤æŒ¯æ–‡æ¡£](https://flutter.dev/docs/development/packages-and-plugins)ã€‚

åœ¨æˆ‘çœ‹æ¥ï¼Œé¦–å…ˆè°ˆè®ºä»˜è´¹è´¦æˆ·ç„¶åè°ˆè®ºç‰¹æ€§çš„æ–‡æ¡£ä»ä¸€å¼€å§‹å°±æ³¨å®šè¦å¤±è´¥ã€‚

æˆ‘é—®äº†ä¸€äº›æˆ‘çš„å¼€å‘æœ‹å‹å…³äº npm å’Œä»–ä»¬æ­£åœ¨ä½¿ç”¨çš„ç‰¹æ€§ã€‚æˆ‘ç‰¹åˆ«è¯¢é—®äº†ä»–ä»¬å…³äºæˆ‘åœ¨ Flutter ä¸­ä½¿ç”¨çš„ç‰¹æ€§ï¼Œæˆ‘çŸ¥é“è¿™äº›ç‰¹æ€§åœ¨ npm ä¸­æ˜¯å¯ç”¨çš„ã€‚ä»–ä»¬çš„å›ç­”ï¼Ÿä»–ä»¬ä¸çŸ¥é“ã€‚ä¸ºä»€ä¹ˆï¼Ÿä»–ä»¬è¦ä¹ˆä»æœªçœ‹è¿‡ npm æ–‡æ¡£ï¼Œè¦ä¹ˆå¾ˆä¹…ä»¥å‰å°±çœ‹è¿‡ã€‚

æ‰€ä»¥ä¸‰é¡µçš„ Flutter æ–‡æ¡£åœ¨è¿™æ–¹é¢æ›´èƒœä¸€ç­¹ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨äº†å®ƒæè¿°çš„å‡ ä¹æ‰€æœ‰å†…å®¹ã€‚å‘é¢¤åŠ¨é˜Ÿè‡´æ•¬ğŸ’™

æˆ‘å–œæ¬¢ä¸ºæˆ‘çš„æ’ä»¶å’ŒåŒ…ä½¿ç”¨ monorepo æ¥ä¿æŒä¸€åˆ‡æ•´æ´å’Œæ„‰å¿«ğŸ™‚

# æ‘˜è¦

2021 å¹´ Npm å²äº†ã€‚å¦‚æœä½ è§‰å¾—è‡ªå·±è€äº†ï¼Œä½ æ˜¯å¯¹çš„ï¼æ˜¯ä¸æ˜¯è¯´æ˜ npm ä¸å¥½ï¼Ÿä¸€ç‚¹ä¹Ÿä¸ã€‚å¦‚æœä½ æœ‰è¿™ç§æ„Ÿè§‰ï¼Œè¯·è®°ä½ï¼Œé€šå¸¸æ–°äº‹ç‰©æ„Ÿè§‰æ›´å¥½ï¼Œä½†åªæ˜¯å› ä¸ºä»–ä»¬ä»å“¥å“¥é‚£é‡Œè·å¾—äº†çŸ¥è¯†å’Œç»éªŒâ€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œnpmï¼Œç„¶åå¤åˆ¶äº†å¥½çš„ï¼Œå¿½ç•¥äº†åçš„ã€‚

ç°åœ¨æ˜¯æ—¶å€™è®©å¹´é•¿çš„åŒ…ç®¡ç†äººå‘˜å¸å– Flutter çš„ä¼˜ç‚¹å¹¶å®ç°å®ƒäº†ï¼è¿™å°±æ˜¯å¼€æºçš„æ„ä¹‰æ‰€åœ¨ã€‚è®©äº‹æƒ…å˜å¾—æ›´å¥½ï¼

Flutter çš„åšæ³•å¾ˆæ£’ï¼Œå¸Œæœ› JS åŒ…ä¹Ÿæœ‰ç±»ä¼¼çš„è§£å†³æ–¹æ¡ˆã€‚æˆ–è€…å®ƒå·²ç»åœ¨é‚£é‡Œäº†ï¼Ÿå¦‚æœæ‚¨çŸ¥é“è¿™æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œè¯·ä¸ç­ä¸Šçš„å…¶ä»–äººåˆ†äº«ï¼å†™è¯„è®ºï¼

> è¿™ç¯‡æ–‡ç« çš„åŸæ ‡é¢˜æ˜¯:â€œä¸ºä»€ä¹ˆä¾èµ–ç®¡ç†åœ¨ Flutter ä¸­æ¯”å…¶ä»–å‰ç«¯æ¡†æ¶æ›´å¥½ã€‚â€â€”â€”æˆ‘ç®€å•åœ°æŠ›å¼ƒäº†å®ƒï¼Œå› ä¸ºæˆ‘ä¸å†é‚£æ ·æƒ³äº†ã€‚æˆ‘çš„ç ”ç©¶ä¸ä»…æ”¹å˜äº†æˆ‘çš„è§‚ç‚¹ï¼Œè¿˜è®©æˆ‘å­¦åˆ°äº†è¶…å‡ºæˆ‘é¢„æœŸçš„ä¸œè¥¿ã€‚ğŸ˜‚

å†æ¬¡æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·åœ¨ [Twitter](https://twitter.com/ThatLukeUrban) ä¸Šé—®æˆ‘ï¼Œæˆ‘çš„ DMs æ˜¯å¼€æ”¾çš„ã€‚ä½ å¯ä»¥è·Ÿç€æˆ‘å»é‚£é‡Œå’Œè¿™é‡Œï¼Œåœ¨åª’ä½“ä¸Šï¼

æˆ‘å…³äºé¢¤æŒ¯çš„å…¶ä»–æ–‡ç« :

*   [ä¸ºä»€ä¹ˆæˆ‘ä¸åœ¨ Flutter ä¸­ä½¿ç”¨ Navigator 2.0 æˆ‘çš„æ¨¡å¼](https://itnext.io/why-i-m-not-using-navigator-2-0-in-flutter-my-pattern-6a88a8625f6c)
*   [Flutter ä¸å†æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„æ¡†æ¶â€”â€”å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå¹³å°ã€‚](https://itnext.io/flutter-is-no-longer-a-cross-platform-framework-b53c87b14c39)
*   [DoYouEvenFlutter [EP.4]åœ¨ 2021 å¹´ä½¿ç”¨è¿™ä¸ª Flutter VSCode è®¾ç½®æé«˜æ‚¨çš„ç¼–ç æ•ˆç‡](https://luke-urban.medium.com/doyouevenflutter-ep-4-boost-your-coding-productivity-with-this-flutter-vscode-setup-in-2021-60637f05a5c2)

æˆ‘è¿˜ä¸ºé‚£äº›å¤„ç†å¤šä¸ªä¸åŒç‰ˆæœ¬çš„ Flutter é¡¹ç›®çš„äººåˆ›å»ºäº†ä¸€ä¸ª Flutter ç‰ˆæœ¬ç®¡ç†å™¨ã€‚

[https://github.com/lukeurban/flenv](https://github.com/lukeurban/flenv)ğŸ‘ˆ

*è®©ä»£ç ä¸ä½ åŒåœ¨ï¼*

å¢å…‹(ç”·å­å)