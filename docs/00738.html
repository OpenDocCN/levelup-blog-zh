<html>
<head>
<title>Localizing your React-Redux Application with React-Intl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React-Intl本地化React-Redux应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/localizing-your-react-redux-application-with-react-intl-2c4fb60311e1?source=collection_archive---------1-----------------------#2019-07-14">https://levelup.gitconnected.com/localizing-your-react-redux-application-with-react-intl-2c4fb60311e1?source=collection_archive---------1-----------------------#2019-07-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/14535d8750f794c20fc7da6c54016232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ulbnepjlv9f8_UawKM61_A.jpeg"/></div></div></figure><p id="ba79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个主题在教程中并不经常出现，也不总是你在开始一个新项目时要做的事情，如果你作为一名开发人员在你的职业生涯中足够幸运，能够在一个新项目的开始阶段就在那里。但是本地化一个应用程序，让用户可以用他们的母语阅读文本，这是我曾经参与过两次的事情。</p><p id="3ac8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一次是本地化遗留的Winforms应用程序，我将在以后的文章中讨论。第二个是用它最喜欢的合作伙伴Redux本地化新的React应用程序。</p><p id="b92e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">(<a class="ae la" href="https://github.com/yahoo/react-intl" rel="noopener ugc nofollow" target="_blank">https://github.com/yahoo/react-intl</a>)是一个帮助你完成大量繁重的翻译和数字格式化工作的库。在这篇文章中，我将重点介绍翻译以及如何更新Redux store，以便根据用户交互来改变UI文本语言。</p><p id="500b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我假设您知道如何设置React和Redux，并且您知道什么是reducers和action creators。</p><p id="9b76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要做的第一件事是安装<code class="fe kw kx ky kz b">react-intl</code>,使用npm可以做到这一点:</p><pre class="lb lc ld le gt lf kz lg lh aw li bi"><span id="7e94" class="lj lk iq kz b gy ll lm l ln lo">npm i react-intl</span></pre><h1 id="27fd" class="lp lk iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">多余的部分</h1><p id="2643" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">有几个来自<code class="fe kw kx ky kz b">react-intl</code>的移动部件帮助完成所有这些工作:</p><p id="f92c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">IntlProvider  —它位于应用程序JSX的根，在组件树中将有翻译的文本。本质上，可以认为它类似于react-redux提供程序或React-Router路由器对象。</p><p id="99f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> addLocaleData </strong> —添加在应用程序初始化期间设置的语言环境数据的函数。</p><p id="c723" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个普通的旧JSON对象(稍后将详细介绍)，但本质上它将保存基于地区代码的键，例如英语的“en”或日语的“ja”，然后保存翻译的值。</p><p id="d332" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> FormattedMessage </strong> —这个对象是我们将用来包装翻译的对象。它有两个属性，第一个<code class="fe kw kx ky kz b">id</code>是JSON对象中包含的翻译的关键字，第二个是<code class="fe kw kx ky kz b">defaultMessage</code>，如果在显示翻译时出现问题。</p><h1 id="498f" class="lp lk iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">给我看看代码</h1><p id="bda9" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">让我们从应用程序的根开始，通常您会看到这样的内容:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="e0bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">ApplicationTree</code>在这种情况下，是应用程序的其余部分，无论它被Redux提供者包装成什么样。</p><p id="3897" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了继续使用<code class="fe kw kx ky kz b">ApplicationTree</code>，它看起来应该是这样的:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="5fb6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里有几件事情正在进行，首先是我们引入了我们希望稍后在我们的JSX中使用的组件(<code class="fe kw kx ky kz b">IntlProvider</code>和<code class="fe kw kx ky kz b">addLocalData</code>)，然后我们导入了我们的<code class="fe kw kx ky kz b">LanguageObject</code>(我们的JSON翻译数据)并引入了我们的<code class="fe kw kx ky kz b">HomeComponent</code>，这将是一个连接到react-redux的页面组件，并将包含一些文本，这些文本将以我们选择的语言在页面上更新。</p><p id="1e7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们在第9–10行引入我们的语言环境，然后将这些数据添加到第12–13行的<code class="fe kw kx ky kz b">IntlProvider</code>的上下文中。</p><p id="5115" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还有<code class="fe kw kx ky kz b">mapStateToProps</code>,它设置组件的<code class="fe kw kx ky kz b">props.locale</code>属性，并在选择不同的语言环境时更新应用程序<code class="fe kw kx ky kz b">IntlProvider</code>。</p><p id="cafb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">IntlProvider</code>需要知道区域设置是什么，这是通过它的“区域设置”属性来完成的，我们已经将它设置为组件的<code class="fe kw kx ky kz b">props.locale</code>，最后，它使用它的“消息”属性来获取一个消息对象，该属性也是根据props.locale来设置的。</p><p id="0685" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面提到的messages对象是一个JSON对象，它包含将在整个应用程序中使用的关键字和翻译，这可以根据您的需要分解为单独的文件，我们的示例在一个文件中，如下所示:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="8e76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">props.locale</code>将是一个字符串,‘en’或‘ja ’,并将被用作选择包含翻译的内部对象的键。</p><p id="0324" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的<code class="fe kw kx ky kz b">HomeComponent</code>连接到react-redux，包含<code class="fe kw kx ky kz b">FormattedMessage</code>组件，如下所示:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="5e96" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了简单起见，我直接从<code class="fe kw kx ky kz b">props.dispatch</code>导入了动作创建器和直接调度。有三个<code class="fe kw kx ky kz b">FormattedMessage</code>组件，一个包含标题和两个按钮，这两个按钮将执行一个action creator函数，每个按钮接受一个区域设置字符串(' en '或' ja ')并将它们发送到reducer。</p><p id="1bd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如您所看到的，如果更新中有任何错误，或者错误的密钥被发送到一个组件，那么将会显示默认消息。</p><p id="634d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">动作类型和动作创建者非常简单，如下所示:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="0001" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当然，最后一部分是我们的区域设置缩减器，它将包含一个动作类型并创建一个新状态，该状态在更新时将更新<code class="fe kw kx ky kz b">ApplicationTree</code>组件，该组件将向下过滤并更新包含<code class="fe kw kx ky kz b">FormattedMessage</code>组件的其他组件，缩减器的代码如下所示:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="1a10" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当然，在创建您的商店时，您一定不要忘记将reducer添加到<code class="fe kw kx ky kz b">combineReducers</code> Redux方法中。</p><h1 id="4cd5" class="lp lk iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">包扎</h1><p id="8717" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">这就是为react Redux应用程序添加基本本地化的基本内容，在您可能添加到应用程序的任何新功能中，您都可以找到基本的活动部分，即reducers、action creators和组件，它们都与应用程序的流程一起工作。</p><p id="f0fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您碰巧安装了Redux chrome扩展并将其安装到您的应用程序中，您可以看到应用程序更改状态，并看到Redux存储中的区域设置是什么。</p><p id="8000" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望本指南提供了一个很好的介绍，并让您开始使用react-intl。</p></div></div>    
</body>
</html>