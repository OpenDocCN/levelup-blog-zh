<html>
<head>
<title>Representing Data Structures with First Class Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用一级函数表示数据结构</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/representing-data-structures-with-first-class-functions-bbf6d6bb3165?source=collection_archive---------19-----------------------#2021-10-11">https://levelup.gitconnected.com/representing-data-structures-with-first-class-functions-bbf6d6bb3165?source=collection_archive---------19-----------------------#2021-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8022ca0c5209a194520dec6ea6adbb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LXzHa3av45vuMhA2RXM2Sw.png"/></div></div></figure><p id="fe0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有一天，我和我的室友谈论如何通过函数组合来模拟所有的数据结构，所以我想我应该证明一下。</p><p id="34e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最通用的数据结构之一是地图，地图实际上已经是一个函数了。有时，当我们谈论函数时，我们谈论它们如何将定义域映射到值域。</p><p id="a6b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是一个简单的函数地图:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="f70c" class="lf lg iq lb b gy lh li l lj lk">map = {'a': 1, 'b': 2, 'c': 3}<br/>f('a') = 1<br/>f('b') = 2<br/>f('c') = 3</span></pre><p id="ef30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这在数学符号中非常简单，但显然这不是真正的代码。</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="3307" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我先从Python说起。空地图很容易表示为Python函数:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="8073" class="lf lg iq lb b gy lh li l lj lk">empty_map = lambda _: None</span></pre><p id="4111" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它只是一个函数，接受任何值，不返回任何值。</p><p id="3bd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将一元地图创建为Python函数也很容易:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="7989" class="lf lg iq lb b gy lh li l lj lk">simple_map = lambda x: 1 if x == 'a' else None</span></pre><p id="2389" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是我们如何着手在这张地图上添加变量呢？很简单，只需添加一个if语句:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="c4fb" class="lf lg iq lb b gy lh li l lj lk">new_map = lambda x: 2 if x == 'b' else simple_map(x)</span></pre><p id="bd08" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们取<code class="fe ls lt lu lb b">new_map('b')</code>，它的值就是2。如果我们取<code class="fe ls lt lu lb b">new_map('a')</code>，它计算<code class="fe ls lt lu lb b">simple_map('a')</code>，正好是1。</p><p id="6f9c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以画出猫头鹰的其余部分:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="48a9" class="lf lg iq lb b gy lh li l lj lk">empty_map = lambda _: None<br/><br/>def insert(m, k, v):<br/>    return lambda fetched_key: v if fetched_key == k else m(fetched_key)<br/><br/>def remove(m, k):<br/>    return lambda fetched_key: None if fetched_key == k else m(fetched_key)</span></pre><p id="54bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要在现有的map函数中插入一个键，我们只需在递归堆栈中添加一个新的if语句。我觉得是通过代码比英语更容易理解的东西。图表可能会有帮助，但我不擅长画画。</p><p id="c205" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用这段代码非常简单:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="4a7d" class="lf lg iq lb b gy lh li l lj lk">m = empty_map<br/>m = insert(m, 1, "a")<br/>print(m(1)) # a<br/><br/>m = insert(m, 2, "b")<br/>m = insert(m, 3, "a")<br/>m = insert(m, 1, "c")<br/>print(m(1), m(2), m(3)) # c b a<br/><br/>m = remove(m, 2)<br/>print(m(1), m(2), m(3)) # c None a</span></pre><p id="35da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果Python有管道操作符，这看起来会好很多。</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="5de6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅仅用函数来制作地图是相当容易的。我认为很明显，除了性能特征之外，任何其他数据结构都可以用映射来模拟。当然，性能是选择数据结构的最大因素之一(人机工程学/概念模型更重要<em class="lv">有时</em>)，否则我们只会编写花哨的接口而不是数组。然而，虽然这不是直接有用的，但它有一些很酷的含义。</p><p id="c84c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本质上，这是使用调用堆栈来存储数据，这在递归算法中并不罕见，尽管这是它的一个极端版本。如果你只是不断地添加和删除相同的元素，你可能会有一个“空”的地图，使用这种方法会占用很多空间。</p><p id="476c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个有趣的想法是，虽然“调用栈”的概念是一个计算机科学术语，但它也“存在”于任何标准的代数符号中，只是我们不这样称呼它。</p><p id="c528" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个重要的含义是，函数的使用有时可以被不同的数据结构所代替。例如，递归算法通常可以通过使用堆栈在没有尾调用优化的语言中进行优化。</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="6969" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你学到了什么，考虑雇用我。我是普渡大学的大二学生，想找一份2022年夏/秋季的实习。我通常对函数式编程、编程语言、编译器、系统开发、图形和模拟器感兴趣。在https://mikail-khan.com<a class="ae lw" href="https://mikail-khan.com" rel="noopener ugc nofollow" target="_blank"><em class="lv"/></a><em class="lv">找到我的简历和作品集。在</em><a class="ae lw" href="http://mikail-khan.com/signup" rel="noopener ugc nofollow" target="_blank"><em class="lv">mikail-khan.com/signup</em></a>订阅我的邮件列表</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="9a83" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lv">原载于2021年10月11日</em><a class="ae lw" href="https://mkhan45.github.io/2021/10/11/fmap.html" rel="noopener ugc nofollow" target="_blank"><em class="lv">https://mkhan 45 . github . io</em></a><em class="lv">。</em></p></div></div>    
</body>
</html>