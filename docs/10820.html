<html>
<head>
<title>DNSSEC Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DNSSEC解释道</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-dnssec-90b89671c1dd?source=collection_archive---------2-----------------------#2022-01-14">https://levelup.gitconnected.com/what-is-dnssec-90b89671c1dd?source=collection_archive---------2-----------------------#2022-01-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9f32" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">什么是DNSSEC，什么不是？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4e166290631dc60faa7700dcdf85b5a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*73ahdznC-sYVT3c1"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布雷特·乔丹</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">号航天飞机</a>上拍摄的照片</figcaption></figure><p id="5e25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">DNSSEC代表域名系统安全扩展。通过在响应中添加一些附加记录，DNSSEC可以保证DNS查询由经过身份验证的来源回答，从而保护DNS的数据完整性。在详细介绍DNSSEC之前，我们先来了解一下为什么需要对DNS进行“安全扩展”。</p><h1 id="17fb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">为什么我们需要DNSSEC？</h1><p id="1832" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">要解释我们为什么需要DNSSEC，我们可以从DNS是如何工作的开始。</p><p id="b1f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们查询域名的地址时，我们通常会与递归DNS解析器对话。递归解析器将递归地查询多个名称服务器，从上到下遵循委托链的层次结构。下面的GIF说明了这个过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/25508c13946b7ec0d28483a2e8384295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Pk4lgMDkQropmFpSKkoBVg.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">DNS如何工作(GIF)</figcaption></figure><p id="e7ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为最古老的网络协议之一，DNS存在许多问题。例如，域名系统查询和响应没有加密，并且响应没有携带足够的信息来表明它来自应该回答查询的人。</p><p id="c04c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这些问题，坏的参与者可以利用解析器和名称服务器之间的对话，并向解析器发送伪造的答案。伪造的答案会将客户引向恶意目的地。这被称为“中间人”(MITM)攻击。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/b62ca7211eb551e4caced43ed3edf555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*KQo1M9s8htAuRk2OszIJ5Q.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">中间人攻击危及DNS进程</figcaption></figure><p id="023b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">DNSSEC协议可以抵御这种攻击。</p><h1 id="edf9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">DNSSEC是如何运作的？</h1><p id="d581" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">DNSSEC引入了以下几种新类型的DNS记录:</p><ul class=""><li id="68cf" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">RRSIG</li><li id="b86c" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">DNSKEY</li><li id="3ee5" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">鐽</li><li id="781d" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">(我跳过了NSEC和所有类型的负面回应，它们值得一篇独立的博客文章)</li></ul><p id="58e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">RRSIG记录本质上包含另一个DNS记录的加密签名。并且DNSKEY记录包含公钥的信息。(如果您不熟悉密码签名或数字签名，请在<a class="ae ky" href="https://en.wikipedia.org/wiki/Digital_signature" rel="noopener ugc nofollow" target="_blank">维基</a>上阅读更多)</p><p id="7380" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过RRSIG记录和DNSKEY记录，解析器可以验证RRSIG覆盖的DNS记录没有被其他DNS记录更改。但是这里又出现了另一个问题，解析器如何知道DNSKEY记录是可信的？</p><p id="4bb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在RFC“认证链”中输入“信任链”或其正式名称</p><p id="7a26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之前，我提到过DS记录。DS(委托签名者)记录包含公钥(DNSKEY)的哈希摘要。当DNSKEY记录在一个区域中时，其相应的DS记录应该在父区域中。对于DS记录，解析器可以验证它是否可以信任DNSKEY记录。我认为下面的图片可以说明“信任链”的概念</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6ef511ac427621ed2e89adfb7e4b390c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eABQcocPnirfWuF3quDspg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">信任链</figcaption></figure><p id="c801" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，为了让DNSSEC完全发挥作用，一个区域需要发布DNSKEY记录(让我们在另一篇博客文章中讨论KSK和ZSK)，并用RRSIG记录签署该区域中的所有记录。此外，父区域需要有ds记录。</p><p id="24a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">综上所述，下面的GIF展示了DNS如何在解析器上启用DNSSEC验证，并在授权链的所有区域中启用DNSSEC签名的情况下工作:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/1c566dfe0e4bb2996feb5fbb3562617e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*QwOQC5VBknbrO8bUpH_ceQ.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">启用DNSSEC签名和验证后，DNS如何工作</figcaption></figure><h1 id="7692" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">DNSSEC不是什么？</h1><p id="7323" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">DNSSEC可以防止MITM袭击的风险，但它不是包治百病的灵丹妙药。这里有两个DNSSEC无法解决的例子。</p><h2 id="c667" class="ni lw it bd lx nj nk dn mb nl nm dp mf li nn no mh lm np nq mj lq nr ns ml nt bi translated">1.DNSSEC不保护DNS的隐私</h2><p id="0749" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">尽管DNSSEC涉及加密密钥，但它不加密任何DNS查询或响应信息。有了DNSSEC，DNS流量的内容对于一些想要从中窃取信息的攻击者来说仍然是可见的。</p><p id="7394" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一些其他协议，如TLS上的DNS(DoT)和HTTPS上的DNS(DoH)，它们可以使DNS流量更加安全，因为内容将被加密。但是DNSSEC不能保护你。</p><h2 id="0ccc" class="ni lw it bd lx nj nk dn mb nl nm dp mf li nn no mh lm np nq mj lq nr ns ml nt bi translated">2.DNSSEC的“最后一公里”安全问题</h2><p id="d0ef" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在上面的GIF图片中，我们可以看到解析器用DNSSEC验证了响应后，它会将响应发送给客户端。但是如果在客户端和解析器之间有一个攻击者呢？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/a7c0b5be3e29632563f7b9c1c5eefbcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Sb5p7V6mJHYEThKbgN7r0A.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">“最后一英里”安全问题</figcaption></figure><p id="e776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果客户机和解析器是同一台机器上的两个应用程序，或者是同一防火墙内的两台机器，那么这个“最后一英里”问题就不是问题了。然而，对于互联网上的大多数客户来说，DNSSEC本身并不防范这个问题。有一些提议，比如使用TSIG记录在客户端和解析器之间进行认证，但是这通常仍然是一个公开的问题。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="da91" class="lv lw it bd lx ly ob ma mb mc oc me mf jz od ka mh kc oe kd mj kf of kg ml mm bi translated">我现在可以开始用DNSSEC了吗？</h1><p id="78d1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个问题没有简单的答案。</p><p id="04b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管DNSSEC提供了各种保护，但它也带来了一些运营负担。虽然大多数大型DNS提供商，如AWS、Google、Cloudflare，将承担大部分运营负担，但仍有许多事情需要注意。我想用另一篇博文来讨论运营负担的细节。所以，让我在这里给出一些快速的答案。</p><p id="7049" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你在做一些需要符合政府标准的生意，比如FedRamp，那么答案肯定是肯定的。</p><p id="9056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你正在创建一个新网站，答案可能是肯定的。</p><p id="ae59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你的网站已经有成千上万甚至上百万的用户，不。你需要阅读的不仅仅是这篇博文。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="f344" class="lv lw it bd lx ly ob ma mb mc oc me mf jz od ka mh kc oe kd mj kf of kg ml mm bi translated">结论</h1><p id="3319" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">DNSSEC是一种可以将DNS安全性提升到更高水平的协议。启用DNSSEC签名后，具有安全意识的解析器可以验证响应来自经过身份验证的来源。</p><p id="f4cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，DNSSEC不能保护DNS流量的隐私。还有“最后一英里”的安全问题，这需要进一步的工作。</p><p id="c19f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于我们是否应该开始使用DNSSEC，我没有想出一个答案。我打算多写几篇关于DNSSEC的文章，希望它们能回答你可能有的更多问题。感谢您的阅读！</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h2 id="75d3" class="ni lw it bd lx nj nk dn mb nl nm dp mf li nn no mh lm np nq mj lq nr ns ml nt bi translated">资源</h2><ul class=""><li id="8aae" class="mt mu it lb b lc mn lf mo li og lm oh lq oi lu my mz na nb bi translated"><a class="ae ky" href="https://datatracker.ietf.org/doc/html/rfc4033" rel="noopener ugc nofollow" target="_blank"> RFC4033 DNS安全介绍和要求</a></li><li id="854f" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><a class="ae ky" href="https://datatracker.ietf.org/doc/html/rfc4034" rel="noopener ugc nofollow" target="_blank">DNS安全扩展的RFC4034资源记录</a></li><li id="db23" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><a class="ae ky" href="https://datatracker.ietf.org/doc/html/rfc4035" rel="noopener ugc nofollow" target="_blank">针对DNS安全扩展的RFC4035协议修改</a></li></ul></div></div>    
</body>
</html>