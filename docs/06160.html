<html>
<head>
<title>Big 5 Personality of Donald Trump: Analyze 50000 Tweets with Watson Personality Insights API and Visualize with Radar Chart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">唐纳德·特朗普的五大个性:用沃森个性洞察API分析50000条推文，并用雷达图可视化</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/analyse-over-50000-tweets-of-trump-with-watson-personality-insights-visualise-with-seaborn-1f25b050905f?source=collection_archive---------16-----------------------#2020-10-30">https://levelup.gitconnected.com/analyse-over-50000-tweets-of-trump-with-watson-personality-insights-visualise-with-seaborn-1f25b050905f?source=collection_archive---------16-----------------------#2020-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="11ed" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">介绍</h2></div><p id="8e07" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文将分析唐纳德·特朗普的五大人格特质，并发现他在总统选举前、从选举到就职以及就职后三个时期的人格变化。</p><p id="0e59" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该分析基于<a class="ae lb" href="https://twitter.com/realDonaldTrump" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lc">realDonaldTrump</em></strong></a>截至2020/08/09的所有公开推文，从2009/05/04的第一条推文开始。我们将使用<strong class="kh ir"> <em class="lc">熊猫</em> </strong>读取数据，<a class="ae lb" href="https://github.com/laxmimerit/preprocess_kgptalkie" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lc">预处理_ kgptalkie</em></strong></a><strong class="kh ir"><em class="lc"/></strong>进行数据预处理，<a class="ae lb" href="https://www.ibm.com/watson/services/personality-insights/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lc">沃森个性洞察API </em> </strong> </a>进行个性分析，<strong class="kh ir"> <em class="lc"> Seaborn </em> </strong>和<a class="ae lb" href="https://github.com/niloch/iplotter" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lc">I lotter</em></strong></a></p><p id="cb64" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最终输出:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/aa588ed2b1d91adc644f67d403791226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5vJyS8nlcd0oMuu3mBLg5Q.jpeg"/></div></div></figure><p id="d420" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们开始吧！</p><h2 id="23fe" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">第一步:获取特朗普推文的完整档案</h2><p id="1c95" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">如果你已经申请了一个开发者账户来访问Twitter APIs，那么<strong class="kh ir">搜索API</strong>可以用来<strong class="kh ir"> </strong>浏览用户的推文。然而，一个标准的搜索API只能让我们检索过去七天的推文。</p><p id="227d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Tweepy也是一样。Tweepy是一个用于访问Twitter API的Python库，<code class="fe mn mo mp mq b"><strong class="kh ir">API.search_full_archive</strong></code>也需要一个高级环境。</p><p id="eac9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的情况下，我们需要特朗普推特上的所有公开推文。感谢<a class="ae lb" href="http://www.trumptwitterarchive.com/archive" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lc">特朗普推特存档</em> </strong> </a>，我们可以免费获得特朗普推特的完整存档！</p><div class="mr ms gp gr mt mu"><a href="http://www.trumptwitterarchive.com/archive" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd ir gy z fp mz fr fs na fu fw ip bi translated">特朗普推特档案</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">特朗普的所有30，000多条推文都可以立即搜索到</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">www.trumptwitterarchive.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni ln mu"/></div></div></a></div><p id="ce13" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2015年6月16日，特朗普宣布参选总统。2017年1月20日，特朗普就任美国第45任总统。基于这两个关键节点，我们可以将完整归档分为三个时期:</p><ul class=""><li id="1d0e" class="nj nk iq kh b ki kj kl km ko nl ks nm kw nn la no np nq nr bi translated">2009/05/04–2015/06/15:在特朗普宣布参选之前</li><li id="b457" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">2015/06/16–2017/01/19:在特朗普就职典礼之前</li><li id="659a" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">2017/01/20–2020/08/09:特朗普就职后</li></ul><p id="101b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae lb" href="http://www.trumptwitterarchive.com/archive" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lc">川普推特存档</em> </strong> </a>中，我会导出三个CSV文件，分别保存为“<em class="lc">before _ candidate . CSV</em>”、“<em class="lc">before _就职典礼. csv </em>”、“<em class="lc">after _就职典礼. csv </em>”</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nx"><img src="../Images/4262aedcf0934bb03e94e5fb43fc1834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKhRisayhCF5sxQvASKsJQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">分三个时段导出数据</figcaption></figure><h2 id="b448" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">步骤2:读取CSV文件</h2><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="1562" class="lp lq iq mq b gy og oh l oi oj">import pandas as pd<br/>df = pd.read_csv ('/Users/tianlu/Downloads/before_candidacy.csv')<br/>df.shape<br/>df.head()</span></pre><p id="d7b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> pandas.read_csv </strong>可以将逗号分隔值(csv)文件读入DataFrame。Pandas有三种主要的数据结构:序列、数据帧和索引。DataFrame是一种二维数据结构。</p><p id="660b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> DataFrame.shape </strong>返回形状的元组(行，列)。第一个文件中有30344条tweet记录，DataFrame中有68列。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ok"><img src="../Images/b6a199e83e7da710bbfd1c7134f03aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mW18nYrcweE_m4_-Qb-ypg.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">df.shape的输出</figcaption></figure><p id="08aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> DataFrame.head() </strong>返回DataFrame的前五行。我们可以看到，我们需要分析的推文存储在<strong class="kh ir"><em class="lc">‘文本’</em></strong>列中。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ol"><img src="../Images/694a6b0eeb2f3ab32a7642980ca7f992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NE2G-yIkDyloSVI2Tv8MTA.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">df.head()的输出</figcaption></figure><p id="d26d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在做同样的事情来读取另外两个文件:</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="d68b" class="lp lq iq mq b gy og oh l oi oj">import pandas as pd</span><span id="90a3" class="lp lq iq mq b gy om oh l oi oj">df2 = pd.read_csv ('/Users/tianlu/Downloads/before_inaguration.csv')</span><span id="59a8" class="lp lq iq mq b gy om oh l oi oj">df3 = pd.read_csv ('/Users/tianlu/Downloads/after_inauguration.csv')</span></pre><p id="34cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将获得以下输出:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi on"><img src="../Images/6b1f155cece887cab762ee7fe436232e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rclf4N3-R6uSfMkpC_Sttg.png"/></div></div></figure><p id="fae8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们已经将三个时期的数据读入DataFrame，特朗普参选前共有30344条推文进入total，参选期有8188条推文，特朗普就职后有20880条推文。</p><p id="358a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步，我们将删除转发，并获得干净的推文。</p><h2 id="d8a8" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">第二步:数据处理</h2><p id="1a90" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated"><strong class="kh ir"> 2.1从数据帧中删除转发</strong></p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="89c7" class="lp lq iq mq b gy og oh l oi oj">df.is_retweet.value_counts()<br/>df2.is_retweet.value_counts()<br/>df3.is_retweet.value_counts()</span></pre><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi oo"><img src="../Images/f44faaf1904ebc82ba27d8c4f76b5a0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bnxg5GDdWqHaiN7y4woexA.png"/></div></div></figure><p id="1072" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<strong class="kh ir"> <em class="lc"> df访问一个列。[column_label]，value_counts() </em> </strong>返回包含数据帧中唯一行的计数的序列。这里我们得到了当<em class="lc">为_retweet </em>为False <em class="lc">，</em>第一周期有<em class="lc"> 2 </em> 2156条原始推文时的行数。</p><p id="901e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以从DataFrame中删除转发:</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="14ec" class="lp lq iq mq b gy og oh l oi oj">df_retweets = df.loc[df.is_retweet == True]<br/>df_retweets = df_retweets.drop(columns=['is_retweet'])<br/>df = df.loc[df.is_retweet == False]<br/>df = df.drop(columns=['is_retweet'])<br/>df.info()</span></pre><p id="0234" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lc"> df.loc </em> </strong>可以通过标签或布尔数组访问一组行和列。首先，当<em class="lc"> is_retweet </em>为真时，我们获取这些行，然后删除这些行，现在我们可以删除<em class="lc"> is_retweet </em>列。</p><p id="a0aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对df2和df3重复相同的步骤。</p><p id="0ba3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2.2用<em class="lc">预处理_kgptalkie </em> </strong>清理Tweet文本</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="32cb" class="lp lq iq mq b gy og oh l oi oj">import preprocess_kgptalkie as pp<br/>import re</span><span id="e378" class="lp lq iq mq b gy om oh l oi oj">x = ['x']<br/>df['text']=df['text'].apply(lambda x:x.lower())<br/>df['text']=df['text'].apply(lambda x:pp.cont_exp(x))<br/>df['text']=df['text'].apply(lambda x:pp.remove_emails(x))<br/>df['text']=df['text'].apply(lambda x:pp.remove_urls(x))<br/>df['text']=df['text'].apply(lambda x:pp.remove_rt(x))<br/>df['text']=df['text'].apply(lambda x:pp.remove_html_tags(x))<br/>df['text']=df['text'].apply(lambda x:pp.remove_special_chars(x))</span></pre><p id="0832" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lc">预处理_kgptalkie </em> </strong> python包由<code class="fe mn mo mp mq b"><a class="ae lb" href="https://github.com/laxmimerit/preprocess_kgptalkie" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lc">Kgptalkie</em></strong></a></code>准备。按照<a class="ae lb" href="https://github.com/laxmimerit/preprocess_kgptalkie/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lc">自述</em> </strong> </a>安装包，导入<strong class="kh ir"> <em class="lc">预处理_kgptalkie </em> </strong>，还有<strong class="kh ir"> <em class="lc"> re </em> </strong>(正则表达式)。</p><p id="3f86" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lc"> df['text'] </em> </strong>是DataFrame中的文本列，我们可以应用lambda函数删除邮件、URL等。从推文文本中进行数据清理。</p><p id="7992" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对df2和df3重复相同的步骤。</p><p id="5c90" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2.3获得清洁文本</strong></p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="5dd9" class="lp lq iq mq b gy og oh l oi oj">text = "\n".join(tweet for tweet in df.text)</span><span id="7cfa" class="lp lq iq mq b gy om oh l oi oj">print ("There are {} words in the combination of all tweet in  the first period.".format(len(text)))<br/></span></pre><p id="2ed6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lc"> df.text </em> </strong>是一个Pandas系列数据类型，我们现在可以使用<strong class="kh ir"><em class="lc">' for tweet in df . text’</em></strong>来迭代该系列，以获得每个tweet，最后，将每个tweet连接成一个<strong class="kh ir"><em class="lc">【text’</em></strong>。我们将使用<strong class="kh ir"> <em class="lc">【正文】</em> </strong>作为步骤3中的性格分析材料。</p><p id="6aa3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对df2和df3重复上述步骤。您将获得以下输出:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi op"><img src="../Images/f8edc6cfd091bfeed43bf8aaa69dd182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bg9mkpIX5gayesoaDRQ5-Q.png"/></div></div></figure><p id="68a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们得到了三块干净的文本用于人格分析。</p><h2 id="0b6c" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">步骤3:使用个性洞察API进行数据分析</h2><p id="1949" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated"><strong class="kh ir"> 3.1设置环境</strong></p><p id="b96e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用个性洞察的第一步是使用<a class="ae lb" href="https://cloud.ibm.com/" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lc">IBM Cloud</em></strong></a>创建一个帐户。这允许您访问个性洞察API。</p><p id="76ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要创建一个服务，直接进入<a class="ae lb" href="https://cloud.ibm.com/catalog" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lc"> IBM云目录</em> </strong> </a>。搜索并激活沃森人格洞察服务。</p><p id="ef02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在转到您的资源列表，您将获得<strong class="kh ir"> <em class="lc"> API密钥</em> </strong>和<strong class="kh ir"> <em class="lc"> URL </em> </strong>，我们将使用这些值对服务实例进行认证。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi oq"><img src="../Images/25e3d33e60895127a5b95693c72665de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Et_SP20EDiMbWLo3otnjfw.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">资源列表</figcaption></figure><p id="b1d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后的设置步骤是用<strong class="kh ir"><em class="lc">pip install IBM _ Watson</em></strong>安装Watson开发者云。</p><p id="1728" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 3.2创建个性档案</strong></p><p id="3f1d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们已经创建了API凭证，安装了watson-developer云模块，并获得了要分析的文本块(来自步骤2)。这些都是我们创建个性档案所需要的。</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="66a0" class="lp lq iq mq b gy og oh l oi oj">from ibm_watson import PersonalityInsightsV3<br/>from ibm_cloud_sdk_core.authenticators import IAMAuthenticator</span><span id="2250" class="lp lq iq mq b gy om oh l oi oj">apikey = 'PUT YOUR API KEY HERE'<br/>url = '<a class="ae lb" href="https://api.au-syd.personality-insights.watson.cloud.ibm.com/instances/41e696fb-34c6-4a2c-9f07-0150c045a9c7'" rel="noopener ugc nofollow" target="_blank">PUT YOUR URL HERE'</a></span><span id="bfc5" class="lp lq iq mq b gy om oh l oi oj">authenticator = IAMAuthenticator(apikey)</span><span id="32bd" class="lp lq iq mq b gy om oh l oi oj">personality_insights = PersonalityInsightsV3(version='2017-10-13',authenticator=authenticator)</span><span id="ba38" class="lp lq iq mq b gy om oh l oi oj">personality_insights.set_service_url(url)</span><span id="017a" class="lp lq iq mq b gy om oh l oi oj">profile = personality_insights.profile(text,accept='application/json').get_result()</span><span id="0f60" class="lp lq iq mq b gy om oh l oi oj">profile2 = personality_insights.profile(text2,accept='application/json').get_result()</span><span id="94cf" class="lp lq iq mq b gy om oh l oi oj">profile3 = personality_insights.profile(text3,accept='application/json').get_result()</span></pre><p id="8316" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，用API键和URL实例化一个Personality Insights服务实例。然后我们可以将<strong class="kh ir"> <em class="lc">【文本】</em> </strong>发送给服务。这将处理文本文件中的数据，并生成新的个性档案。</p><p id="9d7c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"><em class="lc">‘廓’</em></strong>是字典。<strong class="kh ir"><em class="lc">profile[' word _ count ']</em></strong>的输出是42976，也就是说即使我们发送200多万字，服务也只需要42976。</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="3672" class="lp lq iq mq b gy og oh l oi oj">type(profile)<br/>profile.keys()<br/>profile['word_count']</span></pre><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi or"><img src="../Images/71b7fb4587e5f151c4f0b7eaa456045a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZsjkPfik0_bp6BuOMGh7A.png"/></div></div></figure><p id="4982" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据IBM Cloud的说法，我们可以向服务发送高达20 MB的输入内容。在某种程度上，更多的单词可能会产生更好的结果，通过减少预测结果和作者实际得分之间的偏差来提高服务的精确度。但是准确性在大约3000个单词的输入时稳定下来，更多的内容不会有助于概况的准确性。因此，该服务只从大型请求中提取和使用前250 KB的内容，不包括任何HTML或JSON标记。</p><p id="6dbb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们已经为唐纳德·特朗普在三个时期创建了三个性格特征，接下来我们将可视化并比较这三个特征。</p><h2 id="d3bb" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">步骤4:数据可视化</h2><p id="93b3" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">首先，我们将通过条形图快速浏览一下性格特征。然后我们将深入探讨big5人格特质，并用雷达图对这三个时期进行比较。</p><p id="759f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">4.1 Seaborn快速条形图</strong></p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="0373" class="lp lq iq mq b gy og oh l oi oj">needs = profile['needs']</span><span id="e73d" class="lp lq iq mq b gy om oh l oi oj">result = {need['name']:need['percentile'] for need in needs}</span><span id="6851" class="lp lq iq mq b gy om oh l oi oj">df = pd.DataFrame.from_dict(result,orient='index')<br/>df.reset_index(inplace=True)</span><span id="ae63" class="lp lq iq mq b gy om oh l oi oj">df.columns = ['need','percentile']<br/>df['period'] = 'period1'</span><span id="180d" class="lp lq iq mq b gy om oh l oi oj">df.head()</span></pre><p id="e9e9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将获得以下输出:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi os"><img src="../Images/d7e1fd3af5ad835d7bacd342e3385941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a7gSnLfjqJArsjZU7msSxQ.png"/></div></div></figure><p id="77a8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对profile2/profile3重复相同的步骤，以获得df2/df3。现在我们可以将这三个数据帧连接成一个，并用<strong class="kh ir"> <em class="lc"> Seaborn </em> </strong>可视化:</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="f782" class="lp lq iq mq b gy og oh l oi oj">result2 = pd.concat([df,df2,df3])</span><span id="f05c" class="lp lq iq mq b gy om oh l oi oj">import seaborn as sns<br/>plt.figure(figsize=(15,5))<br/>sns.barplot(x='need',y='percentile',hue='period',data=result).set_title('Needs of Donald Trump')</span></pre><p id="73a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> Seaborn </strong>是一个基于matplotlib的Python数据可视化库。函数有四个变量:x，y，色调和数据。<strong class="kh ir"> <em class="lc">数据</em> </strong>是绘图的数据帧，<strong class="kh ir"> <em class="lc"> x </em> </strong>和<strong class="kh ir"> <em class="lc"> y </em> </strong>是指定x轴和y轴位置的变量，<strong class="kh ir"> <em class="lc">色相</em> </strong>是一个分组变量，会产生不同颜色的点。</p><p id="4fcf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将获得以下输出:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ot"><img src="../Images/b7abf771cffb6c1ef27ae5d5fb4bffe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_bOEikSZTyEJAYOzav7Pcw.png"/></div></div></figure><p id="8f42" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在对人格做同样的事情:</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="8f24" class="lp lq iq mq b gy og oh l oi oj">personalities = profile['personality']</span><span id="c729" class="lp lq iq mq b gy om oh l oi oj">result = {personality['name']:personality['percentile'] for personality in personalities}</span><span id="e076" class="lp lq iq mq b gy om oh l oi oj">df = pd.DataFrame.from_dict(result,orient='index')<br/>df.reset_index(inplace=True)<br/>df.columns = ['trait','percentile']<br/>df['period']='period1'</span><span id="6712" class="lp lq iq mq b gy om oh l oi oj">df.head()</span></pre><p id="db52" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对profile2和profile3重复相同的步骤。连接三个数据框架，想象五大人格:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ot"><img src="../Images/1c8b66d122d6ec5f22397fa45b426c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vIKFjIZi9ouOCCR2FxHk4A.png"/></div></div></figure><p id="3c9d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们对唐纳德·特朗普在三个时期的需求和五大性格有了一个基本的形象化，接下来我们将使用雷达图来形象化每个性格的特征。</p><p id="7bff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 4.2使用iPlotter进行大五人格可视化的雷达图</strong></p><p id="6009" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Jupyter笔记本中创建JavaScript图表，我们将使用<a class="ae lb" href="https://github.com/niloch/iplotter" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lc">I lotter</em></strong></a><strong class="kh ir"><em class="lc">。</em></strong><a class="ae lb" href="https://github.com/niloch/iplotter" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lc">I lotter</em></strong></a>使用原生python数据结构将最新的D3.js和canvas制图库带到Jupyter笔记本中。iPlotter集成了C3.js、plotly.js、Chart.js、Chartist.js和Google Charts。</p><p id="3251" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我们将使用Chart.js创建雷达图，以可视化和比较唐纳德·特朗普在三个时期的个性。</p><p id="5e4e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，导入<strong class="kh ir"> <em class="lc"> iplotter </em> </strong>包和<strong class="kh ir">【IPython.core.display.HTML】</strong><strong class="kh ir"><em class="lc">【IPython.core.display.HTML】</em></strong>可以将<strong class="kh ir"> <em class="lc"> </em> </strong>渲染的HTML输出嵌入到IPython输出中。</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="15bf" class="lp lq iq mq b gy og oh l oi oj">import iplotter<br/>from IPython.core.display import HTML</span><span id="8d61" class="lp lq iq mq b gy om oh l oi oj"># remove iFrame border for cleaner chart rendering<br/># increase size of text explanations<br/>HTML("""<br/>&lt;style&gt;<br/>iframe {border:0;}<br/>&lt;/style&gt;<br/>""")</span></pre><p id="15a3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，为图表准备数据，我们需要得到每种性格中每种特征的百分比。</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="741d" class="lp lq iq mq b gy og oh l oi oj">def get_data(profile_name):<br/>    personalities = profile_name['personality']<br/>    data = {}<br/>    for personality in personalities:<br/>        trait_dic = {}<br/>        personality_name = personality['name']<br/>        personality_traits = personality['children']<br/>        for trait in personality_traits:<br/>            trait_dic[trait['name']] = trait['percentile']<br/>            data[personality_name] = trait_dic<br/>    return data</span></pre><p id="2cd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">返回的数据是一个嵌套的字典，关键字是大5人格的名称(开放性/责任心/外向性/宜人性/情感范围)，值是每个人格的儿童人格特征及其相应的百分位数。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ou"><img src="../Images/dc89bc2fbe8345ab0703f846455d9fe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XU1jaOKFlxaLzTgyVBFBmA.png"/></div></div></figure><p id="cc4b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以用雷达图把川普三个不同时期的每个人格形象化。</p><p id="fe3d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从第一个人格“开放性”开始，图表的<strong class="kh ir"> <em class="lc">标签</em> </strong>是“开放性”人格的特质名称，<strong class="kh ir"> <em class="lc">数据</em> </strong>是特质的百分位值。数据集里的<strong class="kh ir"> <em class="lc">标签</em></strong><strong class="kh ir"><em class="lc">数据</em> </strong>必须是JSON可序列化的，所以我们要用<strong class="kh ir"><em class="lc">list(my _ dict . values())</em></strong>来得到一个列表。</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="b717" class="lp lq iq mq b gy og oh l oi oj">labels = list(get_data(profile)['Openness'].keys())<br/>data1 = list(get_data(profile)['Openness'].values())<br/>data2 = list(get_data(profile2)['Openness'].values())<br/>data3 = list(get_data(profile3)['Openness'].values())</span></pre><p id="7a72" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以使用<strong class="kh ir"> <em class="lc">标签、数据1、数据2和数据3 </em> </strong>来创建图表数据。</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="4979" class="lp lq iq mq b gy og oh l oi oj">data = {    <br/>        "labels": labels,<br/>        "datasets": [<br/>            {<br/>                "label": "Before Candidacy",<br/>                "backgroundColor": "rgba(179,181,198,0.2)",<br/>                "borderColor": "rgba(179,181,198,1)",<br/>                "pointBackgroundColor": "rgba(179,181,198,1)",<br/>                "pointBorderColor": "#fff",<br/>                "pointHoverBackgroundColor": "#fff",<br/>                "pointHoverBorderColor": "rgba(179,181,198,1)",<br/>                "data": data1,<br/>            },<br/>            {<br/>                "label": "Before inauguration",<br/>                "backgroundColor": "rgba(255,99,132,0.2)",<br/>                "borderColor": "rgba(255,99,132,1)",<br/>                "pointBackgroundColor": "rgba(255,99,132,1)",<br/>                "pointBorderColor": "#fff",<br/>                "pointHoverBackgroundColor": "#fff",<br/>                "pointHoverBorderColor": "rgba(255,99,132,1)",<br/>                "data": data2,<br/>            }<br/>            ,<br/>            {<br/>                "label": "After inauguration",<br/>                "backgroundColor": "rgba(0,191,255,0.2)",<br/>                "borderColor": "rgba(0,191,255,0.2)",<br/>                "pointBackgroundColor": "rgba(0,191,255,1)",<br/>                "pointBorderColor": "#fff",<br/>                "pointHoverBackgroundColor": "#fff",<br/>                "pointHoverBorderColor": "rgba(0,191,255,1)",<br/>                "data": data3,<br/>            }<br/>        ]<br/>    }</span><span id="17d5" class="lp lq iq mq b gy om oh l oi oj">options = {<br/>            "title": {<br/>                "display": True,<br/>                "text": 'Big5 Personalities of Trump - Openness'<br/>            }<br/>        }</span></pre><p id="cca4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后一步是实例化<strong class="kh ir"><em class="lc">ChartJSPlotter</em></strong>并绘制图表。绘图函数有五个变量，我们上一步创建的<strong class="kh ir"> <em class="lc">数据</em> </strong>，图表类型，图表图形的宽度和高度，以及选项配置。</p><pre class="le lf lg lh gt oc mq od oe aw of bi"><span id="0b48" class="lp lq iq mq b gy og oh l oi oj">chart_js = iplotter.ChartJSPlotter()</span><span id="ae61" class="lp lq iq mq b gy om oh l oi oj">chart_js.plot(data, chart_type="radar", w=600, h=600,options=options)</span></pre><p id="9e15" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们将得到以下输出:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ov"><img src="../Images/bb59da1baa95a01bbe194a7fd24d2645.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-X-_3qtY0w6Qpb2ssDPT-A.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">开放的雷达图</figcaption></figure><p id="6963" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将“开放性”这一名称改为Big 5中的其他四种人格，我们将另外四个雷达图:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ov"><img src="../Images/65e18249ab32621d2732f8997d2e8673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eVOZPVP-6pYxaMcvox0STA.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">责任心的雷达图</figcaption></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ov"><img src="../Images/b2344d2a7695816c817d5a1b45f1a5f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*To3tSTcGXP4V_1jrAvEelg.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">外向性的雷达图</figcaption></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ov"><img src="../Images/7daca2d64a6433becd5bc53457e96d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJ8fAvBO5koFnrUXpxlqjw.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">宜人性的雷达图</figcaption></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ov"><img src="../Images/6cee5dd4d33e8fa51833aa0503f5802b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BJQGXPMNkxM1BI_JrRQ-og.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">情绪范围的雷达图</figcaption></figure></div></div>    
</body>
</html>