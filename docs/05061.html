<html>
<head>
<title>Back of the envelope estimation hacks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">信封背面的估算技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/back-of-the-envelope-estimation-hacks-4de943cb939d?source=collection_archive---------2-----------------------#2020-08-01">https://levelup.gitconnected.com/back-of-the-envelope-estimation-hacks-4de943cb939d?source=collection_archive---------2-----------------------#2020-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ac75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两种类型的工程师，一种可以快速地做估算，另一种不能。这些人只是更聪明，还是另有隐情？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/25a0c656e93fc106a3ab9503a2b6657e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*ylH3YcvxebW6sWsU.jpg"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated"><a class="ae kx" href="https://en.wikipedia.org/wiki/Fermi_problem" rel="noopener ugc nofollow" target="_blank"><em class="ky"/></a><em class="ky">估计是个高手</em></figcaption></figure><p id="3254" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">信封背面的估计是一项可以通过实践学习的技能。一旦你熟悉了这个行业的一些窍门，事情就变得容易多了。</p><h1 id="caaa" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">了解你的数字</h1><p id="06d9" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">你从磁盘上读取数据的速度有多快？多快脱离网络？您应该熟悉您的组件的大致性能数据。重要的不是确切的数字本身，而是它们在数量级上的相对差异。</p><h1 id="427d" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">接近幂</h1><p id="2dbb" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">评估的目标不是得到一个正确的答案，而是得到一个正确的范围。使用2或10的幂使得乘法非常容易，因为在对数空间中，乘法变成加法。</p><p id="976f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，假设你有80万用户在UHD以12 Mbps的速度观看视频。您的内容交付网络中的机器可以1 Gbps的速率输出。你需要多少台机器？</p><p id="3a1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用10⁶大约800K，使用10⁷ Mbps大约12 Mbps，产量:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mc"><img src="../Images/8a2515fa4618b56323b83db2fb2e150b.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*-vstTE3GGejGOh0Wug-rMg.png"/></div></div></figure><p id="963d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将6和7相加，然后从中减去9，这比试图得到准确的答案要容易得多:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/da85444fcaf3046a6e2307a446eeac25.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*lwmSaz6GauI0YVj_oU0n3g.png"/></div></figure><p id="8c84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">区别真的重要吗？不尽然；确切的答案反正也不确切。用户随时间变化，网络带宽不是恒定的，等等。</p><h1 id="5847" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">72法则</h1><p id="9fc2" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated"><a class="ae kx" href="https://web.stanford.edu/class/ee204/TheRuleof72.html" rel="noopener ugc nofollow" target="_blank">72</a>法则是一种估算一个量如果以一定的百分比率增长需要多长时间才能翻倍的方法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/e6523aff2b1d4908f485600a15fbc638.png" data-original-src="https://miro.medium.com/v2/resize:fit:224/format:webp/1*GyXPDg-5QVmFeqCUEPpkzg.png"/></div></figure><p id="749b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，假设您的web服务的流量以大约每周10%的速度增长，需要多长时间才能翻倍？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mj"><img src="../Images/60296ecb70db4981ae00d63631d3c635.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*mR1mzVsC165TYZc_W5wS9Q.png"/></div></div></figure><p id="120b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">流量翻倍大约需要7周时间。</p><p id="ba01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果把72的法则和2的幂结合起来，那么就可以很快算出一个量增加几个数量级需要多长时间。</p><h1 id="14fe" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">利特尔定律</h1><p id="f318" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">队列可以用三个参数来建模:</p><ul class=""><li id="016b" class="mk ml iq jp b jq jr ju jv jy mm kc mn kg mo kk mp mq mr ms bi translated">新项目到达的平均速率，<em class="mt"> λ </em>，</li><li id="6102" class="mk ml iq jp b jq mu ju mv jy mw kc mx kg my kk mp mq mr ms bi translated">项目在队列中花费的平均时间，</li><li id="c274" class="mk ml iq jp b jq mu ju mv jy mw kc mx kg my kk mp mq mr ms bi translated">以及队列中的平均项目数，<em class="mt"> L </em>。</li></ul><p id="76e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">许多事情可以被建模为队列。例如，web服务可以被视为一个队列。请求速率是新项目到达的速率。处理一个请求所花费的时间就是一个项目在队列中花费的时间。最后，并发处理的请求数就是队列中的项目数。</p><p id="1e4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果能从另外两个参数中推导出三个参数中的一个，岂不是很棒？原来这三个量之间有一个相互联系的定律！它叫做<a class="ae kx" href="https://en.wikipedia.org/wiki/Little%27s_law" rel="noopener ugc nofollow" target="_blank">利特尔定律</a>:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/cf3e6b9668de9f9c744ab308e0127395.png" data-original-src="https://miro.medium.com/v2/resize:fit:190/format:webp/1*mcLdWUHUgVBWvbesmbLefQ.png"/></div></figure><p id="a493" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它说的是队列中的平均项目数等于新项目到达的平均速率乘以项目在队列中花费的平均时间。</p><p id="636b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们试一试。假设您有一个平均需要100毫秒来处理请求的服务。它目前每秒接收大约200万个请求。同时处理多少个请求？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0b2d948f2e58780fc6ca00f34c6eb99e.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*JSLrcsY96IlCe2e2E5gsOg.png"/></div></figure><p id="5099" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该服务同时处理20万个请求。如果每个请求都是CPU密集型的，并且需要一个线程，那么我们将需要大约20万个线程。如果我们使用8个核心机器，那么要跟上，我们将需要大约25K台机器。</p><h1 id="108f" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">记住这个</h1><p id="f5b0" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">评估是工程师的一项重要技能。通过练习和使用我在这篇文章中介绍的技巧，你可以做得更好:</p><ul class=""><li id="bd7c" class="mk ml iq jp b jq jr ju jv jy mm kc mn kg mo kk mp mq mr ms bi translated">熟悉您的组件的性能数据。</li><li id="54c0" class="mk ml iq jp b jq mu ju mv jy mw kc mx kg my kk mp mq mr ms bi translated">用2或10的幂近似，将乘法转换成加法。</li><li id="4a26" class="mk ml iq jp b jq mu ju mv jy mw kc mx kg my kk mp mq mr ms bi translated">使用72法则，找出给定增长率下一个量翻倍需要多长时间。</li><li id="9dca" class="mk ml iq jp b jq mu ju mv jy mw kc mx kg my kk mp mq mr ms bi translated">将您的系统建模为队列，并利用利特尔法则。</li></ul><p id="6800" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想了解更多关于设计大规模系统的知识，请查阅我的<a class="ae kx" href="http://understandingdistributed.systems/" rel="noopener ugc nofollow" target="_blank">分布式系统书</a>。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="676c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://robertovitillo.com】最初发表于<a class="ae kx" href="https://robertovitillo.com/back-of-the-envelope-estimation-hacks/" rel="noopener ugc nofollow" target="_blank"><em class="mt"/></a><em class="mt">。</em></p></div></div>    
</body>
</html>