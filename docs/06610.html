<html>
<head>
<title>Using Python for geographical plotting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行地理绘图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-python-for-geographical-plotting-d9328fb8cfab?source=collection_archive---------0-----------------------#2020-12-12">https://levelup.gitconnected.com/using-python-for-geographical-plotting-d9328fb8cfab?source=collection_archive---------0-----------------------#2020-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="566e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解和创建用于数据分析的地理图的指南。</h2></div><h1 id="ad59" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">什么是地理标图？</h1><p id="8ba9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">地理绘图用于世界地图，也用于不同国家。当需要分析基于地图的数据并从中获得深刻见解时，该工具非常有用。它的一个应用领域是货物的可视化输出和输入数据。</p><h1 id="3872" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">用什么来创作地理图？</h1><p id="8cf9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Plotly将用于绘图。原因是它创造了互动的情节。</p><blockquote class="lt lu lv"><p id="7099" class="kx ky lw kz b la lx jr lc ld ly ju lf lz ma li lj mb mc lm ln md me lq lr ls ij bi translated">要详细了解Plotly，查看我的文章<a class="ae mf" href="https://jayashree8.medium.com/interactive-data-visualization-using-plotly-and-cufflinks-228bfbe8773f" rel="noopener">这里</a>。</p></blockquote><h1 id="339c" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">如何导入包？</h1><p id="4ab6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">plotly包被导入。随着这几个模块从plotly离线也被导入，因为我们是在离线模式下使用。Pandas包是为处理数据帧而导入的。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="ae7e" class="mp kg iq ml b gy mq mr l ms mt"><strong class="ml ir">&gt;&gt;&gt; import</strong> pandas <strong class="ml ir">as</strong> pd<br/><strong class="ml ir">&gt;&gt;&gt; import</strong> plotly <strong class="ml ir">as</strong> py<br/><strong class="ml ir">&gt;&gt;&gt; from</strong> plotly.offline <strong class="ml ir">import </strong>download_plotlyjs,init_notebook_mode,plot,iplot</span></pre><p id="4332" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">然后，为了确保这些图显示在笔记本中，编写下面的代码。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="35f7" class="mp kg iq ml b gy mq mr l ms mt">&gt;&gt;&gt; init_notebook_mode(connected<strong class="ml ir">=True</strong>)</span></pre><h1 id="c110" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Choropleth地图</h1><p id="b18e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Choropleth地图是一种包含彩色多边形的地图。它有助于直观地了解一个变量在一个地理区域内是如何变化的。</p><p id="f274" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">为了创建choropleth映射，我们需要使用dict()方法创建一个数据字典。该字典包含类型、位置(本质上是作为数组传递的州或国家)和位置模式。然后定义色标。不同的预定义色阶是:“对”、“灰色”、“绿色”、“蓝红色”、“热”、“野餐”、“波特兰”、“喷气式”、“RdBu”、“黑体”、“地球”、“电力”、“YIOrRd”、“YIGnBu”。然后给出文本值。这些值只是悬停在该位置时出现的名称。然后传递一个数组作为z的参数。数组中的值是与颜色对应的数字。最后一个参数是colorbar，它以一个字典作为值。对于关键字“标题”,我们可以提到颜色条的标题应该是什么。</p><p id="3da4" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">在这里，亚洲大陆的国家将被认为是阴谋。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="e84d" class="mp kg iq ml b gy mq mr l ms mt">&gt;&gt;&gt; data <strong class="ml ir">=</strong> dict(type <strong class="ml ir">=</strong> 'choropleth',<br/>locations <strong class="ml ir">=</strong>['india','srilanka','nepal','Bangladesh','china','pakistan','bhutan','myanmar'],<br/>locationmode <strong class="ml ir">=</strong> 'country names',<br/>colorscale<strong class="ml ir">=</strong> 'Picnic',<br/>text<strong class="ml ir">=</strong> ['IND','SLK','NEP','BAN','CHI','PAK','BHU', 'MYN'],<br/>z<strong class="ml ir">=</strong>[1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0],<br/>colorbar <strong class="ml ir">=</strong> {'title':'Country Colours'})</span></pre><p id="b9bc" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">现在创建了一个布局对象。此布局是一个嵌套字典。这里提到了范围。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="1b98" class="mp kg iq ml b gy mq mr l ms mt">&gt;&gt;&gt; layout <strong class="ml ir">=</strong> dict(geo<strong class="ml ir">=</strong>{'scope':'asia'})</span></pre><p id="b772" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">现在使用go创建了一个对象。Figure()函数，以便可以将它传递给iplot()方法。为此，必须从plotly导入另一个图形对象。导入后，在进行中。Figure()方法，传递数据和布局。它是使用iplot()方法绘制的。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="e7a2" class="mp kg iq ml b gy mq mr l ms mt"><strong class="ml ir">&gt;&gt;&gt; import</strong> plotly.graph_objs <strong class="ml ir">as</strong> go</span><span id="023c" class="mp kg iq ml b gy mu mr l ms mt">&gt;&gt;&gt; chmap <strong class="ml ir">=</strong> go.Figure(data<strong class="ml ir">=</strong>[data],layout<strong class="ml ir">=</strong>layout)<br/>&gt;&gt;&gt; iplot(chmap)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d45f6b701a558defd6da0f373d5fb976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*jnSG1_MIURE9BQfc09I11w.png"/></div></figure><h1 id="41fa" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">使用真实数据进行国家绘图</h1><p id="71f9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">选举数据用于理解如何为真实数据创建choropleth图。使用的数据是美国的选举数据。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="922d" class="mp kg iq ml b gy mq mr l ms mt">df <strong class="ml ir">=</strong> pd.read_csv('election_data.csv')<br/>df.head()</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/51038970018c9dbb4e9af490c64b9d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fz_Z9psXJ_5LXWx8yaRJyw.png"/></div></div></figure><p id="db63" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">现在我们将创建数据字典。这里不写状态名和文本值，而是直接调用dataframe列。因此，对于位置，将传递“Sate Abv”列，位置模式将是美国各州，因为数据集只处理美国各州。接下来，z值将获得投票年龄人口的列，以根据相应的颜色显示这些细节。文本值也将获得数据帧的“状态”列。然后彩条标题作为投票年龄人口给出，因为这就是它所描述的。</p><p id="a6bf" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">增加了一个额外的参数作为标记。它是一个嵌套的字典，定义了标记的形式。颜色和宽度已定义。标记只是定义边界如何连接到不同的位置。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="1fd6" class="mp kg iq ml b gy mq mr l ms mt">&gt;&gt;&gt; data <strong class="ml ir">=</strong> dict(type<strong class="ml ir">=</strong>'choropleth',<br/>colorscale <strong class="ml ir">=</strong> 'Earth',<br/>locations <strong class="ml ir">=</strong> df['State Abv'],<br/>locationmode <strong class="ml ir">=</strong> 'USA-states',<br/>z <strong class="ml ir">=</strong> df['Voting-Age Population (VAP)'],<br/>text <strong class="ml ir">=</strong> df['State'],<br/>marker <strong class="ml ir">=</strong> dict(line <strong class="ml ir">=</strong> dict(color <strong class="ml ir">=</strong> 'rgb(255,255,255)',width <strong class="ml ir">=</strong> 1)),<br/>colorbar <strong class="ml ir">=</strong> {'title':"Voting Age Population (VAP)"})</span></pre><p id="4120" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">现在创建了布局词典。情节的标题与范围一起传递。范围是“美国”。此外，另一个论点是' showlakes '。它显示了湖泊，也提到了湖的颜色是蓝色的(写为rgb值)。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="cacf" class="mp kg iq ml b gy mq mr l ms mt">&gt;&gt;&gt; layout <strong class="ml ir">=</strong> dict(title <strong class="ml ir">=</strong> 'Election Voting Data',<br/>geo <strong class="ml ir">=</strong> dict(scope<strong class="ml ir">=</strong>'usa',<br/>showlakes <strong class="ml ir">=</strong> <strong class="ml ir">True</strong>,<br/>lakecolor <strong class="ml ir">=</strong> 'rgb(85,173,240)')<br/>)</span><span id="6fc1" class="mp kg iq ml b gy mu mr l ms mt">&gt;&gt;&gt; chmap <strong class="ml ir">=</strong> go.Figure(data <strong class="ml ir">=</strong> [data],layout <strong class="ml ir">=</strong> layout)<br/>&gt;&gt;&gt; iplot(chmap)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/dded8c438df55a0d601ebba930caf84c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*dGW2XkeAfCIqn8tLJVDSzg.png"/></div></figure><h1 id="0d03" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">使用真实数据进行世界绘图</h1><p id="ca41" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，一个真实的数据集被用于世界电力消耗，以便理解当考虑整个世界时，绘图是如何发生的。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="5109" class="mp kg iq ml b gy mq mr l ms mt">&gt;&gt;&gt; df2 <strong class="ml ir">=</strong> pd.read_csv('world_power.csv')<br/>&gt;&gt;&gt; df2.head()</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/091d8616909e4115cde9a59d30815256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*XeYLG8qI4lRoPGRiLlK0Ww.png"/></div></figure><p id="e42a" class="pw-post-body-paragraph kx ky iq kz b la lx jr lc ld ly ju lf lg ma li lj lk mc lm ln lo me lq lr ls ij bi translated">如前所述，创建了数据字典和布局字典。在布局中，提到了一个额外的参数投影类型。它决定了这些地点的外观。各种选项可以在官方文档中找到。文章末尾提供了链接。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="911a" class="mp kg iq ml b gy mq mr l ms mt">&gt;&gt;&gt; data <strong class="ml ir">=</strong> dict(<br/>type <strong class="ml ir">=</strong> 'choropleth',<br/>colorscale <strong class="ml ir">=</strong> 'Jet',<br/>locations <strong class="ml ir">=</strong> df2['Country'],<br/>locationmode <strong class="ml ir">=</strong> "country names",<br/>z <strong class="ml ir">=</strong> df2['Power Consumption KWH'],<br/>text <strong class="ml ir">=</strong> df2['Country'],<br/>colorbar <strong class="ml ir">=</strong> {'title' : 'Power Consumption'},<br/>)</span><span id="0a4c" class="mp kg iq ml b gy mu mr l ms mt">&gt;&gt;&gt; layout <strong class="ml ir">=</strong> dict(title <strong class="ml ir">=</strong> 'Power Consumption',geo <strong class="ml ir">=</strong> dict(showframe <strong class="ml ir">=</strong> <strong class="ml ir">False</strong>,projection <strong class="ml ir">=</strong> {'type':'mercator'})<br/>)</span><span id="8283" class="mp kg iq ml b gy mu mr l ms mt">&gt;&gt;&gt; chmap <strong class="ml ir">=</strong> go.Figure(data <strong class="ml ir">=</strong> [data],layout <strong class="ml ir">=</strong> layout)<br/>&gt;&gt;&gt; iplot(chmap)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d0ca852a9e449dd104f68d40415175ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CAdstrnK0ZgN_aXBZycA8A.png"/></div></figure><blockquote class="nh"><p id="514b" class="ni nj iq bd nk nl nm nn no np nq ls dk translated"><em class="nr">更多关于Choropleth地图的详细信息，查看官方文档</em> <a class="ae mf" href="https://plotly.com/python/reference/#choropleth" rel="noopener ugc nofollow" target="_blank"> <em class="nr">这里</em> </a> <em class="nr">。</em></p><p id="5b84" class="ni nj iq bd nk nl ns nt nu nv nw ls dk translated"><em class="nr">此处</em>  <em class="nr">代码请参考笔记本。</em></p></blockquote><blockquote class="lt lu lv"><p id="4f30" class="kx ky lw kz b la nx jr lc ld ny ju lf lz nz li lj mb oa lm ln md ob lq lr ls ij bi translated"><em class="iq">联系我:</em> <a class="ae mf" href="https://www.linkedin.com/in/jayashree-domala8/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">领英</em> </a></p><p id="854a" class="kx ky lw kz b la lx jr lc ld ly ju lf lz ma li lj mb mc lm ln md me lq lr ls ij bi translated"><em class="iq">查看我的其他作品:</em> <a class="ae mf" href="https://github.com/jayashree8" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> GitHub </em> </a></p></blockquote></div></div>    
</body>
</html>