<html>
<head>
<title>Automate Angular SPA application deployment to Amazon S3 using GitHub Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GitHub Actions将Angular SPA应用程序自动部署到亚马逊S3</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/automate-angular-spa-application-deployment-to-amazon-s3-using-github-actions-eca72bdd6dda?source=collection_archive---------12-----------------------#2022-05-23">https://levelup.gitconnected.com/automate-angular-spa-application-deployment-to-amazon-s3-using-github-actions-eca72bdd6dda?source=collection_archive---------12-----------------------#2022-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1fd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个故事中，我们将展示如何使用GitHub Actions将Angular SPA应用程序配置和部署到亚马逊S3。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/df573549e6bed67733b8182798eb296e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dD-0MW2XAFbEkH-dq9CswQ.png"/></div></div></figure><h1 id="5e4f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">先决条件</h1><p id="4fcf" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">这是追踪这个故事的所有先决条件的列表:</p><ul class=""><li id="b1e5" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated">结节</li><li id="1542" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">角度CLI</li><li id="45f7" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">有效的AWS帐户</li><li id="dfd1" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">GitHub知识库</li><li id="75ea" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">饭桶</li></ul><h1 id="908f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是亚马逊S3？</h1><p id="dca3" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">亚马逊S3是一个简单的存储服务，帮助开发人员和IT团队存储、备份、存档和检索网络上任何地方的数据。它允许管理员按类别存储数据，为对象添加标签，为多个客户端配置访问控制，执行大容量数据分析，深入了解存储使用情况，并根据活动衡量趋势。</p><blockquote class="mo mp mq"><p id="5d14" class="jn jo mr jp b jq jr js jt ju jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj kk ij bi translated"><a class="ae mv" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/s3/</a></p></blockquote><h1 id="77f1" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">在AWS控制台中设置<strong class="ak"> S3桶</strong></h1><h2 id="55ff" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated"><strong class="ak">创建s3桶</strong></h2><p id="2783" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">登录AWS管理控制台(https://Console . AWS . Amazon . com/Console/home)后，</p><p id="a9d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="mr">转至服务- &gt;存储- &gt; S3 </em> </strong></p><p id="e825" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后按下<strong class="jp ir">* *创建桶** </strong>按钮。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ni"><img src="../Images/45b385ddd1aa3448194114e25ec48ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IuN78hNBbKlxkQkxhDSS0g.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/2003f2126a1bb3f1fbe8d545facb19a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*75n-xGMsuLuuMjHcRapuKw.png"/></div></div></figure><h2 id="975c" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated">添加存储桶策略</h2><p id="109f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">转到存储桶&gt;权限选项卡&gt;存储桶策略</p><p id="1e60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加用JSON编写的存储桶策略</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="ad7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要修复“<strong class="jp ir"> <em class="mr">调用PutObject操作时出错(AccessControlListNotSupported):bucket不允许ACL</em></strong>”，我们需要启用bucket ACLs</p><p id="417e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">转到存储桶&gt;权限选项卡&gt;对象所有权</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nm"><img src="../Images/05a8be73aab8775e612d7097a56333d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2eIg67TXBn22CoJnUK7D1Q.png"/></div></div></figure><h2 id="566e" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated"><strong class="ak">为Github创建一个IAM用户</strong></h2><p id="4b2c" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">前往<a class="ae mv" href="https://console.aws.amazon.com/iam/" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/iam/</a>。在导航窗格中，选择用户，然后选择<strong class="jp ir">* *添加用户** </strong>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nn"><img src="../Images/c01e3c83cebd59944c7cbae821827ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pZla4O6bAfpTLNt6LUwJUg.png"/></div></div></figure><p id="bc42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按下一步:权限按钮-&gt;转到为我们的新用户设置权限。</p><p id="bf59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，选择直接附加现有策略-&gt;过滤策略类型s3，然后选中<strong class="jp ir"> **AmazonS3FullAccess** </strong>。然后点击“下一篇评论”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi no"><img src="../Images/72b5a7207b3e5513df9908e30af0a83d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YayrqTnyDpERRQtk3s4YbQ.png"/></div></div></figure><p id="b068" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">成功创建用户后，下载。用于下载凭据的csv。{访问密钥ID，秘密访问密钥}。</p><h1 id="8fc2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">GitHub存储库设置</h1><h2 id="8bba" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated">创建项目存储库</h2><p id="4051" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在您的Github帐户中，创建一个公共存储库</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi np"><img src="../Images/3c38b9f8b1a9ec55b100b6f1e699499d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYaxfs5W1ObSjaSS_zMY7w.png"/></div></div></figure><h2 id="900d" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated">添加动作秘密</h2><p id="9d84" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">点选选单设定&gt;机密&gt;动作</p><p id="ed0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用访问密钥ID和秘密访问密钥填充密钥/值。例如:对于“访问密钥ID ”,我们将密钥命名为<strong class="jp ir"> AWS_ACCESS_KEY_ID </strong>,这些值是从AWS获得的。我们将对秘密访问密钥(<strong class="jp ir"> AWS_SECRET_ACCESS_KEY </strong>)做同样的事情</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nq"><img src="../Images/f253ff3dce94f611f5fef8c03a7a9f36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M3rE2MMY-b3F13VrDVL63Q.png"/></div></div></figure><h1 id="281c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">创建和配置角度应用程序</h1><p id="4355" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">现在，让我们创建角度项目。</p><ul class=""><li id="4d35" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><strong class="jp ir">克隆项目</strong></li></ul><p id="7774" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mr">git clone</em><a class="ae mv" href="https://github.com/anicetkeric/angular-app-github-actions-s3.git" rel="noopener ugc nofollow" target="_blank"><em class="mr">https://github . com/anicetkeric/angular-app-github-actions-S3 . git</em></a></p><ul class=""><li id="c95a" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><strong class="jp ir">创建一个新的工作空间和一个初始应用</strong></li></ul><p id="f994" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nr ns nt nu b">ng new angular-app-github-actions-s3</code></p><ul class=""><li id="9015" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><strong class="jp ir">服务应用</strong></li></ul><p id="ddac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nr ns nt nu b">ng serve --open</code></p><p id="58c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nr ns nt nu b">--open</code>(或者只是<code class="fe nr ns nt nu b">-o</code>)选项会自动打开你的浏览器到<code class="fe nr ns nt nu b"><a class="ae mv" href="http://localhost:4200/." rel="noopener ugc nofollow" target="_blank">http://localhost:4200/</a></code> <a class="ae mv" href="http://localhost:4200/." rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/e71cf4f801d9f0f97b5f7088c7f5b222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n4OzaOz1MSTS7qa4GH16Ww.png"/></div></div></figure><ul class=""><li id="2680" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated">创建。<strong class="jp ir">项目目录中的github/workflows/main-deploy . yml</strong>文件</li></ul><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nk nl l"/></div></figure><ul class=""><li id="8e74" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><strong class="jp ir"> AWS_ACCESS_KEY_ID </strong> : AWS访问密钥</li><li id="8e5a" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated"><strong class="jp ir">AWS _ SECRET _ ACCESS _ KEY</strong>:AWS秘密访问密钥</li><li id="47ee" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated"><strong class="jp ir">AWS _ S3 _桶</strong>:我们正在同步的桶的名称。</li><li id="e0d5" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated"><strong class="jp ir"> AWS_REGION </strong>:创建桶的区域。</li></ul><p id="cc5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，把代码发送到主分支。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nw"><img src="../Images/40d31bf635943f814cb1a96e7411a0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nceg1aRQQmp0iIBdsa_S6Q.png"/></div></div></figure><p id="3b0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如上图所示，我们创建的所有步骤都已成功执行。</p><p id="fab2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的应用程序在AWS S3 bucket中可用，可以通过bucket网站端点访问。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nx"><img src="../Images/d24e24aae7d2741053fb0fcd7ac621fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kfj7_JG7oSk6g7gUron_iA.png"/></div></div></figure><p id="8d4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成了。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ny nl l"/></div></figure><p id="b69e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的源代码可以在<a class="ae mv" href="https://github.com/anicetkeric/angular-app-github-actions-s3" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h1 id="1b05" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">参考</h1><ul class=""><li id="2161" class="ma mb iq jp b jq lv ju lw jy nz kc oa kg ob kk mf mg mh mi bi translated"><a class="ae mv" href="https://docs.github.com/en/actions/learn-github-actions" rel="noopener ugc nofollow" target="_blank">https://docs.github.com/en/actions/learn-github-actions</a></li><li id="3da6" class="ma mb iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated"><a class="ae mv" href="https://github.com/jakejarvis/s3-sync-action" rel="noopener ugc nofollow" target="_blank">https://github.com/jakejarvis/s3-sync-action</a></li></ul></div></div>    
</body>
</html>