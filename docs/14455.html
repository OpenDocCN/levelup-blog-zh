<html>
<head>
<title>Extract Images from PDF using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从PDF中提取图像</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/extract-images-from-pdf-using-python-97e2ad31c7f1?source=collection_archive---------31-----------------------#2022-11-28">https://levelup.gitconnected.com/extract-images-from-pdf-using-python-97e2ad31c7f1?source=collection_archive---------31-----------------------#2022-11-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5bca" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在本教程中，我们将探索如何使用Python从PDF文件中提取图像。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/73bfd116f31a7c5c34b40a8c31b1b6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7WINTchc3T0rfvmyP1Mwg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@invictar1997?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Soragrit Wongsa </a>在<a class="ae ky" href="https://unsplash.com/s/photos/pictures?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="eba0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">目录</strong></p><ul class=""><li id="2b06" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">介绍</li><li id="c62a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">示例PDF文件</li><li id="92a8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用Python从PDF中提取图像</li><li id="7791" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">完全码</li><li id="8273" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">结论</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mq mr l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="cc2b" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">介绍</h1><p id="a0a6" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">从PDF文件中提取图像是一项非常常见的任务，在处理不同的报告时经常会执行这项任务。</p><p id="cb1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您使用可用的软件和在线工具对每个文件进行手动操作，这将是一项繁琐的任务。</p><p id="b998" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将探索如何使用Python从PDF文件中提取图像。</p><p id="f599" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要继续学习本教程，我们需要以下Python库:PyMuPDF和Pillow。</p><p id="067f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您没有安装它们，请打开“命令提示符”(在Windows上)并使用以下代码安装它们:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="b1a1" class="nu mt it nq b be nv nw l nx ny">pip install PyMuPDF<br/>pip install Pillow</span></pre><h1 id="d4b3" class="ms mt it bd mu mv nz mx my mz oa nb nc jz ob ka ne kc oc kd ng kf od kg ni nj bi translated">示例PDF文件</h1><p id="b969" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">以下是我们将在本教程中使用的PDF文件:</p><p id="24ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://pyshark.com/wp-content/uploads/2022/11/sample_file.pdf" rel="noopener ugc nofollow" target="_blank">https://pyshark . com/WP-content/uploads/2022/11/sample _ file . pdf</a></p><p id="0358" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个PDF文件将与我们的代码一起存放在与<strong class="lb iu"> main.py </strong>相同的文件夹中。</p><p id="970d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还需要创建一个空文件夹<strong class="lb iu"> images </strong>来保存提取的图像，因此文件夹结构应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/fd976b0aef6cb5bae15284e163b01231.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/0*zfuBLaaUQR1mObuJ"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><h1 id="7580" class="ms mt it bd mu mv nz mx my mz oa nb nc jz ob ka ne kc oc kd ng kf od kg ni nj bi translated">使用Python从PDF中提取图像</h1><p id="583f" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">让我们从导入所需的依赖项开始:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="3fa2" class="nu mt it nq b be nv nw l nx ny">#Import required dependencies<br/>import fitz<br/>import os<br/>from PIL import Image</span></pre><p id="b4cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">定义PDF文件的路径:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="2699" class="nu mt it nq b be nv nw l nx ny">#Define path to PDF file<br/>file_path = 'sample_file.pdf'</span></pre><p id="5991" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用fitz模块打开文件并提取所有图像信息:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="c9cb" class="nu mt it nq b be nv nw l nx ny">#Open PDF file<br/>pdf_file = fitz.open(file_path)<br/><br/>#Calculate number of pages in PDF file<br/>page_nums = len(pdf_file)<br/><br/>#Create empty list to store images information<br/>images_list = []<br/><br/>#Extract all images information from each page<br/>for page_num in range(page_nums):<br/>    page_content = pdf_file[page_num]<br/>    images_list.extend(page_content.get_images())</span></pre><p id="8ea1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们来看看我们提取的图像信息:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="fed3" class="nu mt it nq b be nv nw l nx ny">print(images_list)</span></pre><p id="9d09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该得到:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="a707" class="nu mt it nq b be nv nw l of ny">[(9, 0, 640, 491, 8, 'DeviceRGB', '', 'Image9', 'DCTDecode'),<br/>(10, 0, 640, 427, 8, 'DeviceRGB', '', 'Image10', 'DCTDecode'),<br/>(13, 0, 640, 427, 8, 'DeviceRGB', '', 'Image13', 'DCTDecode')]</span></pre><p id="83cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中每个元组表示以下内容:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="4e7a" class="nu mt it nq b be nv nw l of ny">(xref, smask, width, height, bpc, colorspace, alt. colorspace, name, filter)</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="cda6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们添加一些错误处理代码，以防我们处理的PDF文件没有图像:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="9a56" class="nu mt it nq b be nv nw l nx ny">#Raise error if PDF has no images<br/>if len(images_list)==0:<br/>    raise ValueError(f'No images found in {file_path}')</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="8e31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从PDF文件中提取图像信息后，我们可以提取实际图像并将其保存在计算机上:</p><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="6fc0" class="nu mt it nq b be nv nw l nx ny">#Save all the extracted images<br/>for i, image in enumerate(images_list, start=1):<br/>    #Extract the image object number<br/>    xref = image[0]<br/>    #Extract image<br/>    base_image = pdf_file.extract_image(xref)<br/>    #Store image bytes<br/>    image_bytes = base_image['image']<br/>    #Store image extension<br/>    image_ext = base_image['ext']<br/>    #Generate image file name<br/>    image_name = str(i) + '.' + image_ext<br/>    #Save image<br/>    with open(os.path.join(images_path, image_name) , 'wb') as image_file:<br/>        image_file.write(image_bytes)<br/>        image_file.close()</span></pre><p id="d215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码后，您应该看到提取的图像出现在<strong class="lb iu">图像</strong>文件夹中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/d5d126dbad5673b8e550f9232bedd5ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/0*YYTLWy3H6BftX4jf"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="5bea" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">完全码</h1><pre class="kj kk kl km gt np nq nr bn ns nt bi"><span id="b988" class="nu mt it nq b be nv nw l nx ny">#Import required dependencies<br/>import fitz<br/>import os<br/>from PIL import Image<br/><br/>#Define path to PDF file<br/>file_path = 'sample_file.pdf'<br/><br/>#Define path for saved images<br/>images_path = 'images/'<br/><br/>#Open PDF file<br/>pdf_file = fitz.open(file_path)<br/><br/>#Get the number of pages in PDF file<br/>page_nums = len(pdf_file)<br/><br/>#Create empty list to store images information<br/>images_list = []<br/><br/>#Extract all images information from each page<br/>for page_num in range(page_nums):<br/>    page_content = pdf_file[page_num]<br/>    images_list.extend(page_content.get_images())<br/><br/>#Raise error if PDF has no images<br/>if len(images_list)==0:<br/>    raise ValueError(f'No images found in {file_path}')<br/><br/>#Save all the extracted images<br/>for i, img in enumerate(images_list, start=1):<br/>    #Extract the image object number<br/>    xref = img[0]<br/>    #Extract image<br/>    base_image = pdf_file.extract_image(xref)<br/>    #Store image bytes<br/>    image_bytes = base_image['image']<br/>    #Store image extension<br/>    image_ext = base_image['ext']<br/>    #Generate image file name<br/>    image_name = str(i) + '.' + image_ext<br/>    #Save image<br/>    with open(os.path.join(images_path, image_name) , 'wb') as image_file:<br/>        image_file.write(image_bytes)<br/>        image_file.close()</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="67e8" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">结论</h1><p id="44a0" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在本文中，我们探索了如何使用Python和<a class="ae ky" href="https://pymupdf.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> PyMuPDF </a>从PDF文件中提取图像。</p><p id="bfb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有任何问题或对编辑有任何建议，请随时在下面留下评论，并查看我的更多<a class="ae ky" href="https://pyshark.com/category/python-programming/" rel="noopener ugc nofollow" target="_blank"> Python编程</a>教程。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="d8db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oh">原载于2022年11月28日</em><a class="ae ky" href="https://pyshark.com/extract-images-from-pdf-using-python/" rel="noopener ugc nofollow" target="_blank"><em class="oh">【https://pyshark.com】</em></a><em class="oh">。</em></p></div></div>    
</body>
</html>