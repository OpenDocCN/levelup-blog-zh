<html>
<head>
<title>How to Decode Ethereum Transactions in Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•è§£ç Golangä¸­çš„ä»¥å¤ªåŠäº¤æ˜“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/how-to-decode-ethereum-transactions-in-golang-659de0249a7d?source=collection_archive---------1-----------------------#2022-11-21">https://levelup.gitconnected.com/how-to-decode-ethereum-transactions-in-golang-659de0249a7d?source=collection_archive---------1-----------------------#2022-11-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="1429" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¿™ä¸ªå¸–å­æ˜¯å…³äºè§£ç ä»¥å¤ªåŠäº¤æ˜“ï¼Œè¾“å…¥æ•°æ®ï¼Œäº¤æ˜“æ”¶æ®æ—¥å¿—ã€‚</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/f08f173b5e277872bbe5e4146d2b81d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RwLpp4q845GzmmJu"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">æ— èŠçŒ¿æ¸¸è‰‡ä¿±ä¹éƒ¨</figcaption></figure><p id="c398" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä»£ç æ˜¯ç”¨Golangç¼–å†™çš„ï¼Œå¯ä»¥åœ¨<a class="ae le" href="https://gist.github.com/jerryan999/fb784e668e3f140619d22eaa391c3dd5" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ä¸Šè·å¾—ã€‚</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="cc93" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">äº¤æ˜“</h1><p id="2234" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">äº¤æ˜“æ˜¯ä»ä»¥å¤ªåŠå¸æˆ·å‘é€çš„ç­¾åæ¶ˆæ¯ã€‚å®ƒä»¬ç”¨äºè§¦å‘åŒºå—é“¾ä¸Šçš„çŠ¶æ€å˜åŒ–ã€‚</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mp"><img src="../Images/0bf78584f6fedb615950dd39a7252b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNTcbAVlXjb0a4etfTarKA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">äº¤æ˜“ç¤ºä¾‹</figcaption></figure><p id="719b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªäº‹åŠ¡çš„åŸºæœ¬ç»“æ„ã€‚</p><h2 id="b39d" class="mq ln it bd lo mr ms dn ls mt mu dp lw kb mv mw ma kf mx my me kj mz na mi nb bi translated"><em class="nc">æ¥è‡ª</em></h2><p id="e758" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">å‘èµ·è€…çš„ä»¥å¤ªåŠåœ°å€</p><h2 id="f34c" class="mq ln it bd lo mr ms dn ls mt mu dp lw kb mv mw ma kf mx my me kj mz na mi nb bi translated"><em class="nc">æ”¶ä»¶äºº</em></h2><p id="dd27" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">ç›®çš„åœ°ä»¥å¤ªåŠåœ°å€</p><h2 id="cc5e" class="mq ln it bd lo mr ms dn ls mt mu dp lw kb mv mw ma kf mx my me kj mz na mi nb bi translated"><em class="nc">å€¼</em></h2><p id="1d62" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">å‘é€åˆ°ç›®çš„åœ°çš„ä¹™é†šé‡</p><h2 id="cac3" class="mq ln it bd lo mr ms dn ls mt mu dp lw kb mv mw ma kf mx my me kj mz na mi nb bi translated"><em class="nc">æ•°æ®</em></h2><p id="5c7e" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">å¯å˜é•¿åº¦äºŒè¿›åˆ¶æ•°æ®æœ‰æ•ˆè´Ÿè½½</p><h2 id="0e0d" class="mq ln it bd lo mr ms dn ls mt mu dp lw kb mv mw ma kf mx my me kj mz na mi nb bi translated"><em class="nc">æ°”ä»·</em></h2><p id="ccf6" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">æ°”çš„ä»·æ ¼(ä»¥é­ä¸ºå•ä½)å‘èµ·äººæ„¿æ„æ”¯ä»˜ã€‚</p><h2 id="1f1c" class="mq ln it bd lo mr ms dn ls mt mu dp lw kb mv mw ma kf mx my me kj mz na mi nb bi translated"><em class="nc">æ°”ä½“æé™</em></h2><p id="bb2c" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">å‘èµ·è€…æ„¿æ„ä¸ºæ­¤äº¤æ˜“è´­ä¹°çš„æœ€å¤§å¤©ç„¶æ°”é‡</p><h2 id="2e35" class="mq ln it bd lo mr ms dn ls mt mu dp lw kb mv mw ma kf mx my me kj mz na mi nb bi translated"><em class="nc">éšæœºæ•°</em></h2><p id="6eee" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">ç”±èµ·å§‹åœ°å€å‘å¸ƒçš„åºåˆ—å·ç”¨äºé˜²æ­¢æ¶ˆæ¯é‡æ”¾ã€‚</p><h1 id="36c6" class="lm ln it bd lo lp nd lr ls lt ne lv lw lx nf lz ma mb ng md me mf nh mh mi mj bi translated">è§£ç äº¤æ˜“åŸºç¡€ä¿¡æ¯</h1><p id="b8d4" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">æ­¥éª¤1:è¿æ¥ä»¥å¤ªåŠèŠ‚ç‚¹</p><pre class="kp kq kr ks gt ni nj nk bn nl nm bi"><span id="3301" class="nn ln it nj b be no np l nq nr">import  (<br/>    ...<br/>    "github.com/ethereum/go-ethereum/ethclient"<br/>)<br/>    <br/>const PROVIDER_URL = "https://ethereum.publicnode.com"<br/><br/><br/>func main() {<br/>    client, err := ethclient.Dial(PROVIDER_URL)<br/>    if err != nil {<br/>        log.Fatal(err)<br/>    }<br/>    //...<br/>}</span></pre><p id="317b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­¥éª¤2:é€šè¿‡æ•£åˆ—è·å–äº‹åŠ¡</p><pre class="kp kq kr ks gt ni nj nk bn nl nm bi"><span id="7c0e" class="nn ln it nj b be no np l nq nr">import (<br/>   ...<br/>   "github.com/ethereum/go-ethereum/common"<br/>)<br/><br/>func main() {<br/>    // ...<br/>    txHashStr := "0x3e4acda755e036f62c8893ea15d7c587a272252944b0433db4ea5464f235f379"<br/>    txHash := common.HexToHash(txHashStr)<br/>    <br/>    var tx *types.Transaction<br/>    tx, _, err := client.TransactionByHash(context.Background(), txHash)<br/>    if err != nil {<br/>        log.Fatal(err)<br/>    }<br/>    // ...<br/>}</span></pre><p id="59c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­¥éª¤3:è§£æäº¤æ˜“åŸºç¡€ä¿¡æ¯</p><pre class="kp kq kr ks gt ni nj nk bn nl nm bi"><span id="1079" class="nn ln it nj b be no np l nq nr">import (<br/>  ...<br/>  "encoding/hex"<br/><br/>   "github.com/ethereum/go-ethereum/core/types"<br/><br/>)<br/><br/>func ParseTransactionBaseInfo(tx *types.Transaction) {<br/>    fmt.Printf("Hash: %s\n", tx.Hash().Hex())<br/>    fmt.Printf("ChainId: %d\n", tx.ChainId())<br/>    fmt.Printf("Value: %s\n", tx.Value().String())<br/>    fmt.Printf("From: %s\n", GetTransactionMessage(tx).From().Hex()) // from field is not inside of transation<br/>    fmt.Printf("To: %s\n", tx.To().Hex())<br/>    fmt.Printf("Gas: %d\n", tx.Gas())<br/>    fmt.Printf("Gas Price: %d\n", tx.GasPrice().Uint64())<br/>    fmt.Printf("Nonce: %d\n", tx.Nonce())<br/>    fmt.Printf("Transaction Data in hex: %s\n", hex.EncodeToString(tx.Data()))<br/>    fmt.Print("\n")<br/>}<br/><br/><br/>func GetTransactionMessage(tx *types.Transaction) types.Message {<br/>   msg, err := tx.AsMessage(types.LatestSignerForChainID(tx.ChainId()), nil)<br/>   if err != nil {<br/>    log.Fatal(err)<br/>   }<br/>   return msg<br/>}<br/><br/>func main() {<br/>    // ...<br/>    <br/>    ParseTransactionBaseInfo(tx)<br/>    // ...<br/>}</span></pre><h1 id="2893" class="lm ln it bd lo lp nd lr ls lt ne lv lw lx nf lz ma mb ng md me mf nh mh mi mj bi translated">è§£ç äº¤æ˜“è¾“å…¥æ•°æ®</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/7eb6a40a27acf37df0117d722adebd22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDSdFYPdDVcY3ArkBTVIrQ.png"/></div></div></figure><p id="cda2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¾“å…¥æ•°æ®æ˜¯äº‹åŠ¡å¯¹è±¡ä¸­çš„æ•°æ®å­—æ®µï¼Œå®ƒæ˜¯æ–¹æ³•åå’Œå‚æ•°çš„ç¼–ç æ•°æ®ã€‚å®ƒæ˜¯äº¤æ˜“ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå°¤å…¶æ˜¯å¯¹äºåˆåŒäº¤æ˜“ã€‚</p><p id="075a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç¬¬ä¸€æ­¥:æ„é€ å¥‘çº¦<strong class="js iu"> abi </strong>(å¥‘çº¦çš„æ¥å£)</p><pre class="kp kq kr ks gt ni nj nk bn nl nm bi"><span id="d214" class="nn ln it nj b be no np l nq nr">import (<br/>    ...<br/>    "github.com/ethereum/go-ethereum/accounts/abi"<br/>)<br/><br/>func GetLocalABI(path string) string {<br/>   abiFile, err := os.Open(path)<br/>   if err != nil {<br/>      log.Fatal(err)<br/>   }<br/>   defer abiFile.Close()<br/>  <br/>   result, err := io.ReadAll(abiFile)<br/>   if err != nil {<br/>      log.Fatal(err)<br/>   }<br/>   return string(result)<br/>}<br/><br/>func main() {<br/>    // ...<br/>    contractABI, err := abi.JSON(<br/>                          strings.NewReader(GetLocalABI("abis/boredape.json"))<br/>                        )<br/>    if err != nil {<br/>        log.Fatal(err)<br/>    }<br/><br/>}</span></pre><p id="ecf9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­¥éª¤2:è§£ç äº¤æ˜“è¾“å…¥æ•°æ®</p><pre class="kp kq kr ks gt ni nj nk bn nl nm bi"><span id="2ffc" class="nn ln it nj b be no np l nq nr">func DecodeTransactionInputData(contractABI *abi.ABI, data []byte) {<br/>   // The first 4 bytes of the t represent the ID of the method in the ABI<br/>   // https://docs.soliditylang.org/en/v0.5.3/abi-spec.html#function-selector<br/>   methodSigData := data[:4]<br/>   method, err := contractABI.MethodById(methodSigData)<br/>   if err != nil {<br/>      log.Fatal(err)<br/>   }<br/><br/>   inputsSigData := data[4:]<br/>   inputsMap := make(map[string]interface{})<br/>   if err := method.Inputs.UnpackIntoMap(inputsMap, inputsSigData); err != nil {<br/>       log.Fatal(err)<br/>   }<br/> <br/>   fmt.Printf("Method Name: %s\n", method.Name)<br/>   fmt.Printf("Method inputs: %v\n", MapToJson(inputsMap))<br/>}<br/><br/><br/>func main() {<br/>    //...<br/>    DecodeTransactionInputData(&amp;contractABI, tx.Data())<br/>    //...<br/>}</span></pre><h1 id="36a8" class="lm ln it bd lo lp nd lr ls lt ne lv lw lx nf lz ma mb ng md me mf nh mh mi mj bi translated">è§£ç äº¤æ˜“æ”¶æ®</h1><p id="484c" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">äº¤æ˜“å›å•æ˜¯äº¤æ˜“æ‰§è¡Œçš„ç»“æœï¼ŒåŒ…å«äº†åˆåŒæ‰§è¡Œçš„æ—¥å¿—ã€‚</p><p id="0da7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç¬¬ä¸€æ­¥:è·å–äº¤æ˜“æ”¶æ®</p><pre class="kp kq kr ks gt ni nj nk bn nl nm bi"><span id="984b" class="nn ln it nj b be no np l nq nr"><br/>func GetTransactionReceipt(client *ethclient.Client, txHash common.Hash) *types.Receipt {<br/>   receipt, err := client.TransactionReceipt(context.Background(), txHash)<br/>   if err != nil {<br/>      log.Fatal(err)<br/>   }<br/> <br/>   return receipt<br/>}</span></pre><p id="e4b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç¬¬äºŒæ­¥:è§£ç æ”¶æ®</p><pre class="kp kq kr ks gt ni nj nk bn nl nm bi"><span id="b7da" class="nn ln it nj b be no np l nq nr"><br/>func DecodeTransactionLogs(receipt *types.Receipt, contractABI *abi.ABI) {<br/> for _, vLog := range receipt.Logs {<br/>    // topic[0] is the event name<br/>    event, err := contractABI.EventByID(vLog.Topics[0])<br/>    if err != nil {<br/>       log.Fatal(err)<br/>    }<br/>    <br/>    fmt.Printf("Event Name: %s\n", event.Name)<br/>    // topic[1:] is other indexed params in event<br/>    if len(vLog.Topics) &gt; 1 {<br/>       for i, param := range vLog.Topics[1:] {<br/>          fmt.Printf("Indexed params %d in hex: %s\n", i, param)<br/>          fmt.Printf("Indexed params %d decoded %s\n", i, common.HexToAddress(param.Hex()))<br/>     }<br/>    }<br/><br/>    if len(vLog.Data) &gt; 0 {<br/>       fmt.Printf("Log Data in Hex: %s\n", hex.EncodeToString(vLog.Data))<br/>       outputDataMap := make(map[string]interface{})<br/>       err = contractABI.UnpackIntoMap(outputDataMap, event.Name, vLog.Data)<br/>       if err != nil {<br/>          log.Fatal(err)<br/>       }<br/>      fmt.Printf("Event outputs: %v\n", outputDataMap)<br/>    }<br/><br/>   }<br/>}<br/><br/><br/>func main() {<br/>  //...<br/>  DecodeTransactionLogs(receipt, &amp;contractABI)<br/>  //...<br/>}</span></pre></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="8b4c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œ<strong class="js iu">è¯·é¼“æŒ</strong>è®©å…¶ä»–äººä¹Ÿèƒ½çœ‹åˆ°ã€‚ğŸ’š</p></div></div>    
</body>
</html>