<html>
<head>
<title>Forget VLOOKUP(), Use INDEX(MATCH()) Instead</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">忘记VLOOKUP()，改用INDEX(MATCH())</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/forget-vlookup-use-index-match-instead-ba02f6a30c38?source=collection_archive---------18-----------------------#2020-10-30">https://levelup.gitconnected.com/forget-vlookup-use-index-match-instead-ba02f6a30c38?source=collection_archive---------18-----------------------#2020-10-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/58d11f45f384cd84fe0af85d23a1999e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmczB97bncJnqXWqwOlhMA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">由作者提供</figcaption></figure><div class=""/><div class=""><h2 id="6b6a" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">为您的Excel数据分析使用更快、更灵活、更高效的替代方法</h2></div><p id="03f2" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">如果您曾经使用Excel进行过数据分析，您一定遇到过以下问题:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lt"><img src="../Images/383ccb5dc6cb93eb89ef0e2c5005100a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQTxDdWqOJEShOQF41KoZA.png"/></div></div></figure><blockquote class="ly lz ma"><p id="b8e4" class="kx ky mb kz b la lb kj lc ld le km lf mc lh li lj md ll lm ln me lp lq lr ls im bi translated">如何自动获得John或“North”地区一月份的销售额？</p></blockquote><p id="ae3d" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">既然您正在<strong class="kz jj"> <em class="mb">查找</em> </strong>特定值，那么您自然会使用Excel预编程的函数<strong class="kz jj"> VLOOKUP() </strong>。毕竟，这就是它在这里的目的，不是吗？</p><p id="f9d3" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">为了你自己的利益和工作表的优化，不要这样做。</p><p id="eb2a" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">有一个更好的选择，将另外两个Excel函数合并成一个强大的搜索工具，使用起来更灵活，对资源的要求更低(也就是更快)。</p><p id="d6ce" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">这个替代品就是<strong class="kz jj"> INDEX(MATCH()) </strong>组合，它会让你的生活轻松很多！</p><h1 id="f729" class="mf mg ji bd mh mi mj mk ml mm mn mo mp ko mq kp mr kr ms ks mt ku mu kv mv mw bi translated">比较两种方法</h1><p id="f2dc" class="pw-post-body-paragraph kx ky ji kz b la mx kj lc ld my km lf lg mz li lj lk na lm ln lo nb lq lr ls im bi translated">让我们考虑一下可供我们使用的两种方法:</p><p id="c547" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe nc nd ne nf b">+VLOOKUP(<em class="mb">lookup_value;table_array;column_number;match_type</em>)</code></p><p id="4c65" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe nc nd ne nf b">+INDEX(<em class="mb">array;row_number;column_number</em>)</code></p><p id="280f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe nc nd ne nf b">+MATCH(<em class="mb">lookup_value;lookup_array;match_type</em>)</code></p><p id="eaf9" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><strong class="kz jj"> VLOOKUP()有一个主要的缺点</strong>:它只考虑在你的数据范围的<strong class="kz jj">第一列</strong>中的<em class="mb"> lookup_values </em>。在上面的例子中，您可以按人员搜索销售额，但不能按地区搜索。你必须移动你的数据，这是你不应该做的。</p><p id="9aa8" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><strong class="kz jj"> INDEX(MATCH())立刻显得更加灵活，</strong>因为你可以向它传递任何行号或列号。此外，您可以拆分公式(MATCH()在一个单元格中，INDEX()在另一个单元格中)，这进一步提高了速度。</p><p id="6b61" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">让我们比较以下搜索和两种方法返回的结果:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/9a9b0f9b86fa8c330f258de59561c17c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jrsmfltzxwEafG5RLaotQ.png"/></div></div></figure><p id="a8ed" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们看到两种方法返回相同的结果。两者都找不到“Jane ”,因为它不在数据表中。</p><p id="a35b" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">INDEX(MATCH())的明显优势在于它接受另一列中的搜索词(即查找值)，您只需要稍微调整一下公式，而VLOOKUP()根本无法处理请求。</p><h1 id="2a3f" class="mf mg ji bd mh mi mj mk ml mm mn mo mp ko mq kp mr kr ms ks mt ku mu kv mv mw bi translated">如何使用INDEX(MATCH())？</h1><p id="68f3" class="pw-post-body-paragraph kx ky ji kz b la mx kj lc ld my km lf lg mz li lj lk na lm ln lo nb lq lr ls im bi translated">在上面的示例中，如果我们想要查找John一月份的销售额，您应该运行以下函数:</p><p id="420b" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe nc nd ne nf b">+INDEX($B$2:$G$6;MATCH("John";$B$2:$B$6;0);MATCH("January";$B$2:$G$2;0))</code></p><p id="f2bd" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">如果您有数千行和数千列的数据，为了不加快搜索速度，您还可以:</p><pre class="lu lv lw lx gt nh nf ni nj aw nk bi"><span id="faaa" class="nl mg ji nf b gy nm nn l no np">B15 = MATCH("John";$B$2:$B$6;0)<br/>B16 = MATCH("January";$B$2:$G$2;0)<br/>B17 = INDEX($B$2:$G$6;B15;B16)</span></pre><p id="0d69" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">现在，假设您想要搜索东部地区二月份的销售额，您只需要更改一些参数，瞧:</p><pre class="lu lv lw lx gt nh nf ni nj aw nk bi"><span id="c894" class="nl mg ji nf b gy nm nn l no np">B15 = MATCH("East";$C$2:$C$6;0)<br/>B16 = MATCH("February";$B$2:$G$2;0)<br/>B17 = INDEX($B$2:$G$6;B15;B16)</span></pre></div></div>    
</body>
</html>