<html>
<head>
<title>Configuring Logstash to send MongoDB data into Elasticsearch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">配置Logstash以将MongoDB数据发送到Elasticsearch</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/configure-logstash-to-send-mongodb-data-into-elasticsearch-49cc0e9c2a8d?source=collection_archive---------2-----------------------#2019-06-21">https://levelup.gitconnected.com/configure-logstash-to-send-mongodb-data-into-elasticsearch-49cc0e9c2a8d?source=collection_archive---------2-----------------------#2019-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/06fa34a0f494ff698c0310596ac45d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JJY1Uno1tAaGDrlfP17GA.png"/></div></div></figure><p id="3530" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇博客中，我将解释如何将MongoDB数据导入Elasticsearch。您可能会想，将MongoDB数据发送到Elasticsearch有什么好处，那么让我向您解释一下您可能希望将MongoDB数据推送到Elasticsearch的场景。</p><ul class=""><li id="5fca" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">如果您想对数据进行可靠的搜索。</li><li id="73d5" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">您希望在一个中央Elasticsearch集群上收集数据以进行分析和可视化。</li></ul><p id="2e63" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，为了将数据推入Elasticsearch，我们需要logstash的"<em class="lk"> logstash-input-mongodb </em>"输入插件。因此，让我们看看如何安装这个输入插件并配置Logstash，以便将MongoDB数据推入Elasticsearch。</p><p id="1b2f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想知道Logstash的基础知识，那么请参考<em class="lk"/><a class="ae ll" href="https://bqstack.com/b/detail/102/Introduction-to-Logstash" rel="noopener ugc nofollow" target="_blank"><em class="lk">Logstash简介</em></a><em class="lk"/>博客，在那里我解释了Logstash的基础知识。</p><p id="0474" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们必须以root用户身份登录:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="8027" class="lv lw iq lr b gy lx ly l lz ma">sudo su</span></pre><p id="35a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我们可以转到Logstash安装目录(基于您的操作系统):</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="fc2a" class="lv lw iq lr b gy lx ly l lz ma">cd /usr/share/logstash</span></pre><p id="a2c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以执行以下命令:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="3562" class="lv lw iq lr b gy lx ly l lz ma">bin/logstash-plugin install logstash-input-mongodb</span></pre><p id="9900" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将得到以下回应:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="ba35" class="lv lw iq lr b gy lx ly l lz ma">Validating logstash-input-mongodb<br/>Installing logstash-input-mongodb<br/>Installation successful</span></pre><p id="5d0e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们需要创建一个配置文件，将MongoDB数据作为输入:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="6fe4" class="lv lw iq lr b gy lx ly l lz ma">input {<br/>        uri =&gt; 'mongodb://usernam:password@anurag-00-00-no6gn.mongodb.net:27017/anurag?ssl=true'<br/>        placeholder_db_dir =&gt; '/opt/logstash-mongodb/'<br/>        placeholder_db_name =&gt; 'logstash_sqlite.db'<br/>        collection =&gt; 'users'<br/>        batch_size =&gt; 5000<br/>}<br/>filter {</span><span id="c3bb" class="lv lw iq lr b gy mb ly l lz ma">}<br/>output {<br/>        stdout {<br/>                codec =&gt; rubydebug<br/>        }<br/>        elasticsearch {<br/>                action =&gt; "index"<br/>                index =&gt; "mongo_log_data"<br/>                hosts =&gt; ["localhost:9200"]<br/>        }<br/>}</span></pre><p id="d392" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建配置文件后，我们可以执行以下命令来获取数据</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="2d09" class="lv lw iq lr b gy lx ly l lz ma">bin/logstash -f /etc/logstash/conf.d/mongodata.conf</span></pre><p id="f3d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个命令将开始从用户集合中获取数据，因为我们已经在配置文件中提到了集合的名称。这还将创建一个名为“mongo_log_data”的Elasticsearch索引，并将推送MongoDB数据。</p><p id="3545" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还可以在终端上获得输出，因为我们已经给出了两个输出块，第一个用于使用stdout的终端输出，而另一个用于Elasticsearch输出。该命令将提取MongoDB数据供用户收集，并将数据推入Elasticsearch的“<em class="lk"> mongo_log_data </em>”索引中。通过这种方式，我们可以从MongoDB的任何集合中提取数据，并通过在Logstash配置中定义索引名称将其推送到Elasticsearch。</p><p id="d208" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lk">如果你觉得这篇文章很有意思，那么你可以探索“</em> <a class="ae ll" href="https://www.amazon.com/Mastering-Kibana-6-x-Visualize-histograms/dp/1788831039/ref=olp_product_details?_encoding=UTF8&amp;me=" rel="noopener ugc nofollow" target="_blank"> <em class="lk">【掌握基巴纳6.0】</em></a><em class="lk">”、“</em> <a class="ae ll" href="https://www.amazon.com/Kibana-Quick-Start-Guide-Elasticsearch/dp/1789804035" rel="noopener ugc nofollow" target="_blank"> <em class="lk">基巴纳7快速入门指南</em> </a> <em class="lk">”、“</em> <a class="ae ll" href="https://www.amazon.com/Learning-Kibana-dashboards-visualization-capabilities-ebook/dp/B07V4SQR6T" rel="noopener ugc nofollow" target="_blank"> <em class="lk">学习基巴纳7 </em> </a> <em class="lk">”、“</em> <a class="ae ll" href="https://www.amazon.com/gp/product/1789803322?pf_rd_p=2d1ab404-3b11-4c97-b3db-48081e145e35" rel="noopener ugc nofollow" target="_blank"> <em class="lk"> Elasticsearch 7快速入门指南</em> </a> <em class="lk">”等书籍，了解更多</em></p><p id="6658" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如有任何疑问，请留下您的意见。你也可以在推特上关注我:<a class="ae ll" href="https://twitter.com/anu4udilse" rel="noopener ugc nofollow" target="_blank">https://twitter.com/anu4udilse</a></p><p id="8008" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其他博客:</p><p id="ed81" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" href="https://faun.pub/introduction-to-logstash-afe109b886f0" rel="noopener ugc nofollow" target="_blank">Logstash简介</a></p><p id="50b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" rel="noopener ugc nofollow" target="_blank" href="/introduction-to-kibana-5ce16ae7244b">基巴纳简介</a></p><p id="ff3a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" href="https://faun.pub/log-analysis-with-elastic-stack-2a493c113084" rel="noopener ugc nofollow" target="_blank">弹性叠加测井分析</a></p><p id="1dd8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" href="https://medium.com/swlh/introduction-to-openapi-specification-10c9d6fb0c8a" rel="noopener">open API规范介绍</a></p><p id="90fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" rel="noopener ugc nofollow" target="_blank" href="/geo-distance-search-using-elasticsearch-7e2e69d76343">使用弹性搜索进行地理距离搜索</a></p><p id="7390" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" rel="noopener ugc nofollow" target="_blank" href="/load-csv-data-into-elasticsearch-fdb562a7abd9">将CSV数据加载到Elasticsearch </a></p><p id="a5d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" href="https://faun.pub/configure-sonarqube-scanner-with-jenkins-27c23e7758fd" rel="noopener ugc nofollow" target="_blank">用Jenkins配置SonarQube扫描仪</a></p><p id="1a47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ll" rel="noopener ugc nofollow" target="_blank" href="/configure-logstash-to-send-mongodb-data-into-elasticsearch-49cc0e9c2a8d">配置Logstash将MongoDB数据发送到Elasticsearch </a></p></div></div>    
</body>
</html>