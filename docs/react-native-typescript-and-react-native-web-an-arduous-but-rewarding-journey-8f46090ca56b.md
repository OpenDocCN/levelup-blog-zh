# React Nativeã€TypeScript å’Œ React Native Webâ€”â€”è¿™æ˜¯ä¸€ä¸ªè‰°éš¾ä½†å€¼å¾—çš„æ—…ç¨‹

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/react-native-typescript-and-react-native-web-an-arduous-but-rewarding-journey-8f46090ca56b>

åœ¨å‘ç°æœ‰çš„ React Native/Typescript åº”ç”¨ç¨‹åºæ·»åŠ  web éƒ¨åˆ†æ—¶ï¼Œæˆ‘å¶ç„¶å‘ç°äº† [react-native-web](https://github.com/necolas/react-native-web) ã€‚è¿™å¯èƒ½æ˜¯ä¸€è§é’Ÿæƒ…å—â€”â€”ç®€å•åœ°æ·»åŠ  npm åŒ…ã€react-scriptsï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå¯ä»¥å·¥ä½œçš„ç½‘ç»œï¼Ÿæˆ‘è¿«ä¸åŠå¾…åœ°æŠŠå®ƒå®‰è£…å¥½ï¼Œå¹¶å¯åŠ¨äº†æˆ‘çš„æ–°çš„â€”â€”å¯èƒ½æœ‰é—®é¢˜çš„â€”â€”ç½‘ç»œåº”ç”¨ç¨‹åº...è‡³å°‘æˆ‘æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„ã€‚**æ²¡æœ‰**ï¼Œæ„å»º*æ‹’ç»*ç¼–è¯‘ï¼Œå¤§å¤šæ•°æ„å»ºé—®é¢˜éƒ½å­˜åœ¨äºå¤–éƒ¨ä¾èµ–ä¸­ï¼Œè¿™æ˜¯æˆ‘åœ¨åˆ°è¾¾åº”è®¸ä¹‹åœ°ä¹‹å‰ç»å†çš„ä¸€ç³»åˆ—é—®é¢˜ä¸­çš„ç¬¬ä¸€ä¸ªã€‚ä»Šå¤©ï¼Œæˆ‘å°†åˆ†äº«è¿™æ®µæ—…ç¨‹ï¼Œå¼ºè°ƒä¸»è¦é—®é¢˜å’Œæ¯ä¸ªéšœç¢çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬å¼€å§‹å§ï¼

![](img/a82f69fae0d01e4b8a1fd1c08ff00cf5.png)

å¥½çš„ï¼Œæˆ‘ä»¬å°†ä»è¿™ä¸ª[ç®€å•çš„å›è´­å¼€å§‹](https://github.com/jgking2/react-native-web-demo)ï¼Œæˆ‘ä»¬å¸Œæœ›ç»™å®ƒæ·»åŠ ç½‘ç»œåŠŸèƒ½ï¼é™¤äº†ä½¿ç”¨[ååº”å¯¼èˆª](https://github.com/react-navigation/react-navigation)çš„åŸºæœ¬å¯¼èˆªå¤–ï¼Œå®ƒä¸€æ— æ‰€æœ‰ã€‚

è®©æˆ‘ä»¬è®¾ç½®å®ƒï¼Œä½¿å…¶è¡Œä¸ºç±»ä¼¼äºæ ‡å‡†çš„ create-react-appï¼Œå¦‚ react-native-web çš„[æ–‡æ¡£ä¸­æ‰€è¿°ã€‚æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªæ¨¡æ¿ï¼Œä½†æˆ‘ä»¬å¯ä»¥åœ¨äº‹åæ·»åŠ å®ƒï¼Œè®©æˆ‘ä»¬å®‰è£…æˆ‘ä»¬ä¸ºæ­¤éœ€è¦çš„ä¾èµ–å…³ç³»ã€‚](https://necolas.github.io/react-native-web/docs/?path=/docs/overview-getting-started--page)

![](img/1d627048d600d3e633a39ae079ebe52f.png)

å¤ªæ£’äº†ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ›´æ–°æˆ‘ä»¬çš„è„šæœ¬ï¼Œè®©æˆ‘ä»¬åƒè¿™æ ·è¿è¡Œ webã€‚

![](img/20aed7d0e3fe78df42a6dbc9d2201d6d.png)

è®©æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ä½œä¸º web åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹:

![](img/8b6c4b869337597b8a50e41191d4c124.png)

[src/index.tsx](https://github.com/jgking2/react-native-web-demo/blob/initial-approach/src/index.tsx)

![](img/9c7b49767f6bcb00617e9094419aba5a.png)

[public/index.html](https://github.com/jgking2/react-native-web-demo/blob/initial-approach/public/index.html)

å¥½çš„ï¼Œè®©æˆ‘ä»¬ç”¨ **npm run web** å¼€å§‹å§ã€‚

æˆ‘ä»¬æœ‰ä¸€ä¸ªæƒ…å†µâ€¦ğŸš‘ ğŸš’ ğŸš“

![](img/c600ab34503e73066c131283e569d745.png)

å¯æ€•çš„å°è¯•å¯¼å…¥é”™è¯¯:â€œDrawerActionTypeâ€æœªä»å¯¼å‡ºã€‚/DrawerRouter '

è¿™æ˜¯ä¸€ä¸ª[å·²çŸ¥é—®é¢˜](https://github.com/react-navigation/react-navigation/issues/6757#issuecomment-577636392)ï¼Œå¦‚æœä½ æ‰“å¼€æ§åˆ¶å°ï¼Œä½ ä¼šæ³¨æ„åˆ°è¿™æ˜¯ 20 å¤šä¸ªé”™è¯¯ä¹‹ä¸€ï¼Œéƒ½ä¸æ„å»ºæœ‰å…³ã€‚è¿™æœ‰ç‚¹è®©äººä¸çŸ¥æ‰€æªï¼Œè™½ç„¶å‘ç°è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œä½†åœ¨æ²¡æœ‰*å¤ªå¤šæ”»å‡»çš„æƒ…å†µä¸‹è§£å†³è¿™ä¸ªé—®é¢˜æ¯”æˆ‘æƒ³è±¡çš„è¦å›°éš¾ã€‚åœ¨æœç´¢äº†è°·æ­Œï¼Œå¹¶æŸ¥é˜…äº†ä¸€äº›æœ‰ç”¨çš„[å®‰è£…æŒ‡å—](https://react-native-elements.github.io/react-native-elements/docs/web_usage.html)ä¹‹åï¼Œå®ƒç»ˆäºç‚¹å‡»äº†â€”â€”æˆ‘ä»¬èƒ½ä¸èƒ½åªè¦†ç›– react-scripts æ„å»ºçš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä½¿ç”¨ react-native ä½¿ç”¨çš„ç›¸åŒçš„ babel æ„å»ºï¼Ÿ*

æ’å…¥ [react-app-rewired](https://github.com/timarney/react-app-rewired) â€”è¿™ä¸ªå·¥å…·å¸¦æˆ‘ä»¬å‘æ­£ç¡®çš„æ–¹å‘è¿ˆè¿›äº†ä¸€æ­¥ã€‚å®ƒå…è®¸æˆ‘ä»¬å°†é…ç½®è¦†ç›–æ³¨å…¥åˆ° react-scripts æ„å»ºè¿‡ç¨‹ä¸­ã€‚è¿™çœ‹èµ·æ¥å¾ˆæœ‰å¸Œæœ›ï¼Œæˆ‘ä»¬å¯ä»¥ä¿ç•™ react-scripts çš„ä¾¿åˆ©æ€§ï¼Œä½†æ˜¯è¦†ç›–æ„å»ºä»¥ä½¿ç”¨æˆ‘ä»¬çš„ babel.config.jsï¼è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ï¼

![](img/5d2f8851d0b1d0deb6fdf6b5edc6bc3e.png)

npm i -D react-app-rewired

è®©æˆ‘ä»¬ä¿®æ”¹æˆ‘ä»¬çš„è„šæœ¬ï¼Œè°ƒç”¨è¿™ä¸ªè€Œä¸æ˜¯ react-scriptsã€‚

![](img/d3d970b214a324ea62df233a7b4a9051.png)

æœ€åï¼Œè®©æˆ‘ä»¬åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶`config-overrides.js`ï¼Œå¹¶ä½¿ç”¨ä¸‹é¢çš„è¦†ç›–ã€‚

![](img/982222e7e130df31a8c1cd24a042e611.png)

æ’é™¤å¯èƒ½æœ‰åŠ©äºæ²¡æœ‰å‡ºç°çš„åŸå› ï¼Œæˆ‘ä¸æ˜¯ç½‘ç»œåŒ…ä¸“å®¶ï¼

æˆ‘ä»¬æ­£åœ¨æ¨è¡Œä¸€ä¸ªæ–°è§„åˆ™ï¼Œè·å–ä»»ä½• jsã€ts æˆ– tsx æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ babel-loader è¿›è¡Œæ„å»ºã€‚è¿™å¾ˆè‡ªç„¶åœ°åœ¨é¡¹ç›®çš„æ ¹å¤„æ‹¾å–äº†æˆ‘ä»¬çš„ react-native babel.config.jsï¼è®©æˆ‘ä»¬è¯•ç€å†æ¬¡å¯åŠ¨ç½‘ç»œï¼æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæˆåŠŸçš„æ„å»ºğŸŠğŸŠğŸŠâ€¦ *ä½†æ˜¯ç­‰ä¸€ä¸‹* â€¦

![](img/39ee9c52f6cfcaf12761576c1aed5986.png)

`ReferenceError: __DEV__ is not defined`

å¥½å§ï¼Œå¥½æ¶ˆæ¯æ˜¯ [webpack æä¾›äº†ä¸€ä¸ªæ’ä»¶](https://webpack.js.org/plugins/define-plugin/)æ¥æ³¨å…¥éšæœºå…¨å±€å˜é‡ï¼Œå°±åƒè¿™æ ·ï¼è®©æˆ‘ä»¬ä¿®æ”¹ config-overrides.js æ¥ç»•è¿‡å®ƒï¼

![](img/0e878dd204ebfe838cd2ccb3db455125.png)

[config-overrides.js](https://github.com/jgking2/react-native-web-demo/blob/successful-build/config-overrides.js)

å†æ¬¡å°è¯•ï¼Œ **npm è¿è¡Œ web** â€¦ã€‚æ²¡æœ‰é”™è¯¯ï¼Ÿâ€¦ç©ºç™½é¡µï¼Ÿå“¦ï¼Œå¦‚æœæˆ‘ä»¬æ·±å…¥ç»“æ„ï¼Œå°±æœ‰å¸Œæœ›äº†ï¼æœ‰äº›ä¸œè¥¿åœ¨#root å…ƒç´ ä¸‹è¢«æ¸²æŸ“ï¼Œä½†æ˜¯é«˜åº¦ä¸ºé›¶ï¼

![](img/e763b1d722227a64eef385f9571619af.png)

å¥½äº†ï¼Œè®©æˆ‘ä»¬æ›´æ–° public/index.html æ¥å®é™…æ˜¾ç¤ºå†…å®¹ã€‚è¿™å°±æ˜¯è¿™é‡Œä½¿ç”¨çš„æŠ€æœ¯ã€‚

![](img/0386a9b448466129210aaacaaa8c94d7.png)

ç¬¬ä¸€åƒæ¬¡ï¼Œè®©æˆ‘ä»¬ç”¨ **npm è·‘ç½‘**å‘åŠ¨å®ƒï¼Œçœ‹çœ‹è¿™ä¸€æ¬¡å‡ºäº†ä»€ä¹ˆé—®é¢˜â€¦

![](img/b636ed36594f05040dd0527444df05ef.png)

å“‡â€¦å®ƒ**èµ·ä½œç”¨äº†**ï¼ï¼ï¼ç°åœ¨æˆ‘ä»¬*ç»ˆäº*æœ‰äº†ä¸€ä¸ªå¯ä»¥è·¨ç½‘ç»œã€ios å’Œ android å·¥ä½œçš„åº”ç”¨ç¨‹åºï¼ğŸ‘ğŸ‘ğŸ‘

ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªè·¨å¹³å°çš„å·¥ä½œåº”ç”¨ç¨‹åºï¼Œä½†ä»ç„¶æœ‰ä¸€äº›åœ°é›·å¯èƒ½ä¼šçªç„¶å‡ºç°ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç»§ç»­å‘å‰æ¨è¿›ï¼Œå¹¶æ·»åŠ  [react-native-elements](https://react-native-elements.github.io/react-native-elements/docs/web_usage.html) è¿›è¡Œé€ å‹ï¼Œæ·»åŠ  [react-vector-icons](https://github.com/oblador/react-native-vector-icons) è¿›è¡Œä¸€äº›å›¾æ ‡ç¾åŒ–ï¼

![](img/bc2ccd8d1329410f78622253b9df22ac.png)

å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬æ›´æ–°æˆ‘ä»¬çš„ LoginScreen.tsxï¼Œä½¿ç”¨ä¸€äº›æ–°çš„è¡¨å•å…ƒç´ å’Œå›¾æ ‡ã€‚

![](img/511a7e9c7af0d89a68d2c94788c45431.png)

è®©æˆ‘ä»¬ **npm å†æ¬¡è¿è¡Œ web**â€¦â€¦*æ˜¯çš„ï¼Œå®ƒç°åœ¨æ˜¯ä¸€ä¸ªåŠ¨è¯ã€‚*

![](img/751f6da9490ce621099d366ca2b613a9.png)

å°è¯•å¯¼å…¥é”™è¯¯:â€œViewPropTypesâ€ä¸æ˜¯ä»â€œreact-nativeâ€å¯¼å‡ºçš„

åˆæ¥äº†ï¼Œä¸è¿‡è¿˜æ˜¯å¾€å‰æ¨å§ï¼è¿™ä¸ªé”™è¯¯æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå®ƒä¸å†ç”± react-native-web å¯¼å‡ºï¼Œç»è¿‡ä¸€ç‚¹æŒ–æ˜ï¼Œå®ƒåªç”¨äº react-native-elements ä¸­çš„ prop-typeã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æŠŠå®ƒå¯¼å‡º**å°±å¤Ÿäº†ï¼**

**è®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªåˆ«åï¼Œå¹¶æœ‰æ•ˆåœ°å‰”é™¤è¿™äº›é¡¹ç›®ã€‚React-scripts å·²ç»é»˜è®¤æ†ç»‘äº†å‡ ä¸ªåˆ«åï¼ŒåŒ…æ‹¬ç°æˆçš„åˆ«å react-native â†’ react-native-webã€‚æˆ‘ä»¬éœ€è¦åšçš„æ˜¯è°ƒæ•´åˆ«åï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‰”é™¤å¤±è´¥çš„å¯¼å‡ºã€‚**

**é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥å¤„ç†å¯¹å¯¼å…¥ react-native çš„è°ƒç”¨ï¼Œåœ¨ src ä¸­åˆ›å»ºä»¥ä¸‹æ–‡ä»¶å¤¹ã€‚*æ³¨æ„:åŠ è½½æºæ–‡ä»¶å¤¹å¤–çš„æ–‡ä»¶æ—¶å‡ºç°é—®é¢˜ï¼Œæˆ‘åªæ˜¯ç…§åŠäº†ã€‚***

**![](img/27f545a276ccbbab61480df4c444ffea.png)**

**å‘½åæƒ¯ä¾‹ç”±ä½ å†³å®šï¼Œè¿™æ­£æ˜¯æˆ‘æƒ³è¦çš„**

**![](img/ead6fe7bc1e5741d54dbc8b8cbc59f1b.png)**

**src/ã€‚we B- aliases/react-native/index . jsâ€”â€”ä¸çŸ¥ä½•æ•…è¿™å°±å®Œæˆäº†ä»»åŠ¡ï¼**

**å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦è®©æˆ‘ä»¬çš„ web æ„å»ºçŸ¥é“ä½¿ç”¨è¿™ä¸ªåˆ«åã€‚è®©æˆ‘ä»¬ä¿®æ”¹ config-overrides.js æ¥æ‰©å±•å½“å‰çš„æ„å»ºåˆ«åã€‚**

**![](img/c29b3a9256c809d204316aedb5dfa77d.png)**

**[config-overrides.js](https://github.com/jgking2/react-native-web-demo/blob/full-showcase/config-overrides.js)**

**ä½ çŒœå¯¹äº†ï¼å†æ¥ä¸€æ¬¡ **npm è·‘ web** ï¼**

**![](img/9c573defb3c86680e062aafdeb619eaa.png)**

**å¾ˆç¡®å®š github çš„æ ‡å¿—ä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„æ­£æ–¹å½¢â€¦**

**å¥½å§ï¼Œæ‰€ä»¥å®ƒåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šèµ·äº†ä½œç”¨ï¼Œä½†æ˜¾ç„¶æˆ‘ä»¬çš„æ ‡å¿—ä¸èµ·ä½œç”¨ã€‚æ‰€ä»¥è®©æˆ‘ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè°¢å¤©è°¢åœ°è¿™æ˜¯[è®°å½•çš„](https://react-native-elements.github.io/react-native-elements/docs/web_usage.html)ï¼è®©æˆ‘ä»¬ç®€å•åœ°æ›´æ–°ä¸€ä¸‹æˆ‘ä»¬çš„ src/index.tsxï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ web ä¸Šä½¿ç”¨è¿™äº›å­—ä½“äº†ã€‚**

**![](img/1204e3920f0a45ee37ebb575f473fdbd.png)**

**[src/index.tsx](https://github.com/jgking2/react-native-web-demo/blob/full-showcase/src/index.tsx)**

**å¥½äº†ï¼Œæœ€åä¸€æ¬¡ï¼Œ **npm è·‘ç½‘**ï¼**

**ä½ æœ‰å®ƒï¼æˆ‘å¸Œæœ›è¯»åˆ°è¿™é‡Œï¼Œä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•è§£å†³åœ¨ react-native ä¸­æ·»åŠ  web æ—¶å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼Œå¹¶ä¸”åªç”¨äº†æˆ‘æˆ˜æ–—çš„ä¸€å°éƒ¨åˆ†æ—¶é—´ã€‚ä»è¿™é‡Œå¼€å§‹ï¼Œæœ‰äº†ä¸€ä¸ªå·¥ä½œæ„å»ºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[ç›¸åŒçš„å¤šå¹³å°æŠ€æœ¯](https://reactnative.dev/docs/platform-specific-code)ï¼Œå¹¶ä¸”[å°†å®ƒæ‰©å±•åˆ° web](https://necolas.github.io/react-native-web/docs/?path=/docs/guides-multi-platform--page#web-specific-code) ç”¨äºæ‚¨å¯èƒ½é‡åˆ°çš„è®¸å¤šå…¶ä»–æƒ…å†µï¼åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘è¿˜æ²¡æœ‰é‡åˆ°ä»»ä½•æˆ‘æ— æ³•ç”¨è¿™äº›è§£å†³æ–¹æ¡ˆè§£å†³çš„åº“æˆ–æƒ…å†µã€‚å®Œæ•´çš„ä»£ç åº“[åœ¨è¿™é‡Œ](https://github.com/jgking2/react-native-web-demo/tree/full-showcase)ï¼Œè¿˜æœ‰ä¸€äº›å¤šå¹³å°æŠ€æœ¯çš„ä¾‹å­ï¼è¯·åˆ†äº«ä½ å¯èƒ½å‘ç°çš„ä»»ä½•æœ‰æ•ˆçš„æŠ€æœ¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸€èµ·å­¦ä¹ äº†ï¼**