<html>
<head>
<title>3 Python-to-Excel Actions Every Data Analyst Should Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个数据分析师都应该知道的3个Python到Excel的操作</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/3-python-to-excel-actions-every-data-analyst-should-know-8e03de18729a?source=collection_archive---------5-----------------------#2021-11-02">https://levelup.gitconnected.com/3-python-to-excel-actions-every-data-analyst-should-know-8e03de18729a?source=collection_archive---------5-----------------------#2021-11-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/37de00e7ccfdda495e5e4840ab2bcac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7MeZy82Z-FIW-UOT"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">肖恩·罗伯森在<a class="ae kc" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的图片</figcaption></figure><p id="8539" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然Python是一个令人惊叹的工具，但是绝大多数工作场所(尤其是金融行业)仍然使用Excel来显示和报告他们的数据。在本文中，我们将介绍如何优雅地将熊猫数据帧和图形与现有的<em class="lb">Excel文件集成。</em></p><ol class=""><li id="7ed8" class="lc ld iq kf b kg kh kk kl ko le ks lf kw lg la lh li lj lk bi translated">在不干扰其他内容的情况下写入Excel</li><li id="9029" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">样式(格式字体、边框、对齐等等！)</li><li id="efa3" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">将Python图表作为图像插入</li></ol></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h2 id="3475" class="lx ly iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">1)在不干扰其他内容的情况下写入Excel</h2><p id="d38e" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">在处理熊猫时，这是我们习惯看到的数据帧导出:</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="cfe1" class="lx ly iq na b gy ne nf l ng nh">df.to_excel(filepath)</span></pre><p id="98ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，这种写入Excel的方法<strong class="kf ir">不适合</strong>添加到现有报告中。它实际上创建了一个新的工作簿，这意味着所有原始的工作表和数据都将丢失。注意这一点！</p><p id="6d4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们能做些什么呢？</p><p id="186d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设这是我们当前的Excel工作簿。它有一些已经在报告选项卡中设置的标题，以及其他数据表。我们将使用Openpyxl来覆盖报表选项卡中的特定单元格区域，而不会删除任何其他内容。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/4c727c4fd2f628c6591c6663d60c375d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tw2ceOijDbT-HzeonAA26A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">当前Excel文件，然后再写入它。作者图片</figcaption></figure><p id="9993" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Openpyxl是最动态和最流行的Python库之一，用于编写和读取Excel文件。在这些例子中，我将使用3.0.9版本的Openpyxl。它是Excel 2010的理想选择，但是正如你所看到的，它在我的Excel 2007上也运行得很好。</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="eafd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在使用Openpyxl时，我们可以将工作表读入pandas Excel writer的内存中。这将允许您使用任何预先存在的工作表并保存所有原始内容。</p><p id="2f0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，请考虑将数据帧导出修改为以下代码:</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="3227" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本例中的数据框架包含几个国家的近期通货膨胀数据。请注意，我们已经成功地插入了数据，同时保留了工作簿中的所有其他信息和工作表。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/c798aecdaa33160dfd66ae4f72b31460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBaMELov4PyeEp07B90bpg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">插入数据帧后的快照。作者图片</figcaption></figure><h2 id="7d26" class="lx ly iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">2)样式(格式字体、边框、对齐等等！)</h2><p id="09df" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">没有任何调整，DataFrames总是以同样枯燥的格式写入Excel:Calibri，字体大小11。如果您每天或每周运行一次报告，那么自己手动重新格式化会很乏味。</p><p id="23c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们通过让Openpyxl样式进行定制来增加趣味。这是可以在保存writer对象之前运行df.to_excel(…)和<em class="lb">的</em>之后添加的代码。</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="87ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">概括地说，我调整了字体设置、背景颜色、边框和单元格对齐，并将单元格类型从自定义日期时间更改为简单的MM-DD-YY格式。</p><p id="a84f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更多是可能的！您可以在文档中找到其他样式功能:<a class="ae kc" href="https://openpyxl.readthedocs.io/en/stable/styles.html" rel="noopener ugc nofollow" target="_blank">https://openpyxl.readthedocs.io/en/stable/styles.html</a></p><p id="08ad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我决定只对日期列应用格式。下面是Excel中的变化。</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/f45b47d87934f9c4a2c09824c972ee84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXxpw3_qnye9FMN8CplRaQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">实现Openpyxl样式后的结果。作者图片</figcaption></figure><h2 id="69c3" class="lx ly iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">3)将Python图形作为图像插入</h2><p id="df07" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">通常，我们可以使用Python丰富的图表库创建更高级的图形。假设我们有一个使用seaborn库创建的线图，并希望将其插入到我们的Excel表中。</p><p id="57f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是如何使用Openpyxl实现的。首先，将您的图表保存到您的本地文件中，保存为PNG或JPG文件。然后包含以下代码:</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/d39f7f024be45fc034ab19e69badf103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZCn1qOgjnv95_jgw4njhUA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在工作表中添加图表后。作者图片</figcaption></figure><p id="7764" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图表图形在锁定到单元格G4后已成功粘贴到工作表中。</p><p id="0cf2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> </strong>瞧Excel报表现在看起来很吸引人，而且很大程度上是自动化的。</p><h2 id="e0da" class="lx ly iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">示例笔记本</h2><p id="34d1" class="pw-post-body-paragraph kd ke iq kf b kg mq ki kj kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">我希望这有所帮助。点击查看完整的Juypter笔记本<a class="ae kc" href="https://github.com/misha345a/MEDIUM_DataFrames_to_Excel/blob/main/Pandas_to_Excel.ipynb" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="1bd4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>