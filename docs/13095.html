<html>
<head>
<title>Reading the Medium RSS Feed with GraphQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GraphQL读取媒体RSS提要</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/reading-the-medium-rss-feed-with-graphql-cdd25b8ee634?source=collection_archive---------6-----------------------#2022-08-06">https://levelup.gitconnected.com/reading-the-medium-rss-feed-with-graphql-cdd25b8ee634?source=collection_archive---------6-----------------------#2022-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/415848e509b4088c66802805cba87a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_36yWwiTHPzOPmGs.png"/></div></div></figure><p id="5a43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">RSS源作为一种从网站获取更新的流行方式，自90年代以来就一直存在。许多网站广泛使用它，今天它正成为播客在不同流媒体平台上分发内容的主要方式。在本文中，我们将从Medium获取RSS提要并使用GraphQL阅读它。</p><blockquote class="kw kx ky"><p id="5e72" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">你可以在我们的<a class="ae ld" href="https://github.com/stepzen-dev/examples/tree/main/with-rss" rel="noopener ugc nofollow" target="_blank"> Github示例库</a>中找到本文的完整代码，或者在我们的<a class="ae ld" href="https://www.youtube.com/watch?v=aGS-pB28TSk" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>上观看视频演示。</p></blockquote><p id="3e68" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">RSS提要到底是什么？RSS代表真正简单的联合组织，是一种用于传递频繁更新的内容(通常是新闻标题)的格式。这是一种基于XML的格式，允许您订阅网站的提要，并在有新帖子或播客时接收更新。RSS提要是网站保持其内容与读者设备同步的标准方式。让我们更深入地研究一下中型RSS提要。</p><h2 id="e1ae" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">探索中型RSS提要</h2><p id="9440" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">RSS提要是阅读媒体的最佳方式。它简单快捷，只要你喜欢的媒体出版物上有新文章发表，它就会更新你的信息。每个媒体用户都有自己的RSS提要，如下所示:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="53aa" class="le lf iq mh b gy ml mm l mn mo"><a class="ae ld" href="https://medium.com/feed/@username" rel="noopener">https://medium.com/feed/@username</a></span></pre><p id="406d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它包含关于提要所有者的信息，在这个例子中是作者，以及这个作者发布到Medium的所有帖子。关于媒体RSS的文档可以在<a class="ae ld" href="https://help.medium.com/hc/en-us/articles/214874118-Using-RSS-feeds-of-profiles-publications-and-topics" rel="noopener">这里</a>找到，其中也包括关于获取媒体出版物或标签的RSS提要的信息。</p><p id="24fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你没有中等帐户，你可以在这个浏览器中打开下面的RSS源:<a class="ae ld" href="https://medium.com/feed/@roy-derks" rel="noopener">https://medium.com/feed/@roy-derks</a>。此订阅源包含我在Medium上发布的所有博客帖子，当您在浏览器中打开它时，它看起来如下:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/80ecf7cdd8c711bd4c960e668d504449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q0o78HZkdQVFajHy.png"/></div></div></figure><p id="e202" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">响应是XML格式的，文章可以在开始和结束标签之间的元素中找到。在这个元素中，可以找到HTML格式的标题、作者、类别、URL和文章内容。这个提要可以通过浏览器、RSS提要阅读器或HTTP请求来阅读。但是在本文中，我们将使用GraphQL！</p><h2 id="0f46" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">连接到RSS源</h2><p id="9184" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">我们将使用StepZen来使使用GraphQL连接到中型RSS提要成为可能。使用StepZen，您可以为所有现有数据源创建一个GraphQL API，包括REST或SOAP APIs。RSS提要非常类似于SOAP API，因为两者都以XML格式返回响应。</p><p id="07c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要使用StepZen创建新的GraphQL API，可以使用CLI导入数据源，或者使用GraphQL SDL来配置GraphQL模式。我们将进行第二步，这意味着您需要在您的机器上创建一个新目录，并将两个文件放在那里:<code class="fe mq mr ms mh b">index.graphql</code>和<code class="fe mq mr ms mh b">rss.graphql</code>。第一个是链接到<code class="fe mq mr ms mh b">rss.graphql</code>的配置文件，它包含到RSS提要的连接。</p><ul class=""><li id="141d" class="mt mu iq ka b kb kc kf kg kj mv kn mw kr mx kv my mz na nb bi translated"><code class="fe mq mr ms mh b">index.graphql</code></li></ul><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="0cd9" class="le lf iq mh b gy ml mm l mn mo">schema @sdl(files: ["rss.graphql"]) {<br/>  query: Query<br/>}</span></pre><ul class=""><li id="9845" class="mt mu iq ka b kb kc kf kg kj mv kn mw kr mx kv my mz na nb bi translated"><code class="fe mq mr ms mh b">rss.graphql</code></li></ul><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="3577" class="le lf iq mh b gy ml mm l mn mo">type Query {<br/>  getPosts(username: String!): JSON<br/>    @rest(<br/>      endpoint: "https://medium.com/feed/$username"<br/>      headers: [<br/>        { name: "Content-Type", value: "text/xml" }<br/>      ]<br/>      transforms: [{ pathpattern: "[]", editor: "xml2json" }]<br/>    )<br/>}</span></pre><p id="9ca0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要基于该模式创建GraphQL API，必须安装StepZen CLI。安装CLI后，从终端或命令行运行命令:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="5214" class="le lf iq mh b gy ml mm l mn mo">stepzen start</span></pre><p id="5d0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">CLI询问您希望如何调用GraphQL API的端点(在示例<code class="fe mq mr ms mh b">api/with-rss</code>中)。然后，它根据您的身份验证状态，将端点部署到公共或私有端点。如果你还没有注册StepZen账户，GraphQL API将永远是公开的。当你注册后，它将是一个受StepZen API密钥保护的私有端点。</p><p id="399f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下一节中，我们将使用GraphQL查询中型RSS提要。</p><h2 id="4779" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">使用GraphQL查询RSS提要</h2><p id="acd6" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">在上一节中，我们已经创建了GraphQL模式并部署了它。运行<code class="fe mq mr ms mh b">stepzen start</code>之后，GraphQL API在终端或命令行中显示的端点上可用。如果你还没有注册StepZen，它看起来是这样的:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="ac34" class="le lf iq mh b gy ml mm l mn mo"><a class="ae ld" href="https://public3b47822a17c9dda6.stepzen.net/api/with-rss/__graphql" rel="noopener ugc nofollow" target="_blank">https://public3b47822a17c9dda6.stepzen.net/api/with-rss/__graphql</a></span></pre><p id="a680" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当您注册StepZen时，有两个端点可用:一个包含GraphiQL IDE的<code class="fe mq mr ms mh b">localhost</code>端点和一个可以通过提供StepZen API密钥来访问的生产就绪端点。在文档中了解有关不同端点的更多信息。</p><p id="cc41" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用公共端点来探索使用GraphQL的GraphQL API，如果您有StepZen帐户，也可以使用<code class="fe mq mr ms mh b">localhost</code>端点。在GraphiQL IDE中，您可以粘贴以下查询以从中型RSS提要中获取信息:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="f188" class="le lf iq mh b gy ml mm l mn mo">query {<br/>  getPosts(username: "@roy-derks")<br/>}</span></pre><p id="80a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以更改<code class="fe mq mr ms mh b">username</code>值并添加自己的介质用户名。</p><p id="cba5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从GraphiQL中，您可以看到类似的结果，如下所示:</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/bb40d249a26ebf07afb02937bcfdb641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jnH96-lsxoGSV_le.png"/></div></div></figure><p id="8e61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">响应是JSON格式的，而不是RSS提要先前返回的XML响应。在GraphQL模式中，我们已经配置了<code class="fe mq mr ms mh b">@rest</code>自定义指令来将XML转换成JSON。该配置在<code class="fe mq mr ms mh b">transforms: [{ pathpattern: "[]", editor: "xml2json" }]</code>中完成，其中<code class="fe mq mr ms mh b">xml2json</code>用于转换。</p><p id="9314" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了动态选择GraphQL API返回的字段，我们需要为<code class="fe mq mr ms mh b">getPosts</code>查询设置一个定制的响应类型。在最后一节中，我们将使用一个名为JSON2SDL的工具来生成响应类型。</p><h2 id="177a" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">创建自定义响应类型</h2><p id="8b06" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">查询<code class="fe mq mr ms mh b">getPosts</code>现在返回响应类型为<code class="fe mq mr ms mh b">JSON</code>的RSS提要的响应。我们希望创建一个定制的响应类型，这样我们就可以动态地选择返回的字段。首先，我们将限制返回的字段，因为我们只需要位于RSS提要的<code class="fe mq mr ms mh b">channel</code>元素中的作者信息和文章。</p><p id="5db4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<code class="fe mq mr ms mh b">@rest</code>配置中，您可以添加一个<code class="fe mq mr ms mh b">resultroot</code>字段来返回频道信息:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="9f3d" class="le lf iq mh b gy ml mm l mn mo">type Query {<br/>  getPosts(username: String!): JSON<br/>    @rest(<br/>      endpoint: "https://medium.com/feed/$username"<br/>      headers: [<br/>        { name: "Content-Type", value: "text/xml" }<br/>      ]<br/>      transforms: [{ pathpattern: "[]", editor: "xml2json" }]<br/>      resultroot: "rss.channel"<br/>    )<br/>}</span></pre><p id="8d1f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当您再次运行上一节中的查询时，您可以看到GraphQL API只返回来自中型RSS提要的频道信息。我们可以使用GraphQL API的响应为<code class="fe mq mr ms mh b">getPosts</code>查询创建定制的响应类型。</p><p id="540e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">转到<a class="ae ld" href="https://www.json2sdl.com/" rel="noopener ugc nofollow" target="_blank"> JSON2SDL </a>，您可以在页面左侧复制粘贴完整的JSON响应。按下<strong class="ka ir"> Convert </strong>，JSON2SDL为响应生成GraphQL类型。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/8cafdcf71baa5e1e8a18d47571ba394e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4eC81da8pCwUDlzN.png"/></div></div></figure><p id="3643" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以将生成的GraphQL类型复制到您的<code class="fe mq mr ms mh b">rss.graphql</code>文件的顶部。</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="184e" class="le lf iq mh b gy ml mm l mn mo">type Image {<br/>  link: String<br/>  title: String<br/>  url: String<br/>}<br/><br/>type OneItem {<br/>  category: [String]<br/>  creator: String<br/>  encoded: String<br/>  guid: JSON<br/>  link: String<br/>  pubDate: String<br/>  title: String<br/>  updated: DateTime<br/>}<br/><br/>type GetPosts {<br/>  description: String<br/>  generator: String<br/>  image: Image<br/>  item: [OneItem]<br/>  lastBuildDate: String<br/>  link: JSON<br/>  title: String<br/>  webMaster: String<br/>}</span></pre><p id="ed4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并将类型<code class="fe mq mr ms mh b">GetPosts</code>链接到查询，以检索帖子作为其响应类型。</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="963c" class="le lf iq mh b gy ml mm l mn mo">type Query {<br/>  getPosts(username: String!): GetPosts<br/>}</span></pre><p id="9533" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这告诉StepZen GraphQL引擎可以从RSS提要中查询哪些字段。现在，您可以动态地选择返回哪些字段，而不是一次从Medium RSS提要中获取所有数据。例如，如果您只想获取文章的标题和类别，下面的查询就可以做到这一点:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="36c0" class="le lf iq mh b gy ml mm l mn mo">query {<br/>  getPosts(username: "@roy-derks") {<br/>    item {<br/>      title<br/>      creator<br/>    }<br/>  }<br/>}</span></pre><p id="0b41" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从GraphQL模式或GraphiQL IDE中，您可以看到还可以返回哪些字段。通过这些步骤，您已经创建了一个连接到中等RSS提要的GraphQL API。</p><h2 id="da6b" class="le lf iq bd lg lh li dn lj lk ll dp lm kj ln lo lp kn lq lr ls kr lt lu lv lw bi translated">结论</h2><p id="959b" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">本文向您介绍了如何将中型RSS提要转换成GraphQL API。当然，您可以对其进行修改，使其适用于任何其他RSS提要。你可以在我们的<a class="ae ld" href="https://github.com/stepzen-dev/examples/tree/main/with-rss" rel="noopener ugc nofollow" target="_blank"> Github范例库</a>中找到完整的代码，或者在我们的<a class="ae ld" href="https://www.youtube.com/watch?v=aGS-pB28TSk" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>上观看视频。我们很想知道你尝试转换了什么RSS提要(或SOAP API)。加入我们的<a class="ae ld" href="https://discord.com/invite/9k2VdPn2FR" rel="noopener ugc nofollow" target="_blank"> Discord </a>来了解我们社区的最新动态。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="2b2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇文章最初发表于<a class="ae ld" href="https://stepzen.com/blog/reading-medium-rss-feed-with-graphql" rel="noopener ugc nofollow" target="_blank">stepzen.com</a>。用<a class="ae ld" href="https://reposted.io" rel="noopener ugc nofollow" target="_blank">自动转贴。</a></p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="5cc1" class="nk lf iq bd lg nl nm nn lj no np nq lm nr ns nt lp nu nv nw ls nx ny nz lv oa bi translated">分级编码</h1><p id="614a" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="0d0c" class="mt mu iq ka b kb kc kf kg kj mv kn mw kr mx kv my mz na nb bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="b6e2" class="mt mu iq ka b kb ob kf oc kj od kn oe kr of kv my mz na nb bi translated">📰查看更多内容请参见<a class="ae ld" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码刊物</a></li><li id="2c8d" class="mt mu iq ka b kb ob kf oc kj od kn oe kr of kv my mz na nb bi translated">🔔关注我们:<a class="ae ld" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ld" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae ld" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="edb6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">🚀👉<a class="ae ld" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">加入升级人才集体，找到一份神奇的工作</strong> </a></p></div></div>    
</body>
</html>