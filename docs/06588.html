<html>
<head>
<title>Never Leave the Terminal with These Git Log Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">千万不要带着这些Git日志特性离开终端</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/never-leave-the-terminal-with-these-git-log-features-e6a4334c4bcf?source=collection_archive---------12-----------------------#2020-12-09">https://levelup.gitconnected.com/never-leave-the-terminal-with-these-git-log-features-e6a4334c4bcf?source=collection_archive---------12-----------------------#2020-12-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c41a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让您的本地代码评审更有效的简单技巧。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/54e06eedc43d9ef1659ef287fbd53d00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d_nccm1VvLdqKPiS"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Maksym Kaharlytskyi 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="3524" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码被阅读的次数比它被编写的次数多得多。但是提交消息呢？</p><blockquote class="ls"><p id="3b98" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">提交消息只写一次，可以无限多次读取。</p></blockquote><p id="c2cf" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">您永远不会返回并更改您的<code class="fe mh mi mj mk b">master</code>分支中的提交消息，理想情况下，您甚至没有这个选项。然而，Git提交历史是项目中最重要的事情之一。</p><p id="4f85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您的提交历史记录是您可以随时转向的地方:</p><ul class=""><li id="297d" class="ml mm iq ky b kz la lc ld lf mn lj mo ln mp lr mq mr ms mt bi translated">了解您正在更改的代码的原始需求</li><li id="7f66" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated">检查文件最近被更改的原因</li><li id="bb2f" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated">哪一次合并破坏了你的主分支</li></ul><p id="dddf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，你可以随时访问你的在线库管理器，比如<a class="ae kv" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>或者<a class="ae kv" href="https://about.gitlab.com/" rel="noopener ugc nofollow" target="_blank"> GitLab </a>。然而，这些工具使得检查分支结构或浏览分支或文件的发展变得很麻烦。</p><p id="f31d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面我解释一下<code class="fe mh mi mj mk b">git log.</code>的一些有用的特性，这些特性可以让你在挖掘提交、解开分支或者本地审查代码时更加轻松。</p><p id="ee0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mz">所有的例子都显示在开源的</em> <a class="ae kv" href="https://github.com/Pylons/pyramid" rel="noopener ugc nofollow" target="_blank"> <em class="mz">金字塔</em> </a> <em class="mz">项目上，一个针对Python的web框架。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/b2ca4b94c2bef145491bb1a30386b49d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UMMdrd5UxWlvLAAq"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">乔纳森·肯珀在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="2574" class="nb nc iq bd nd ne nf ng nh ni nj nk nl jw nm jx nn jz no ka np kc nq kd nr ns bi translated">裸git日志</h1><p id="1898" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">普通的<code class="fe mh mi mj mk b">git log</code>显示了你提交历史的线性概览。这很有用，但是默认情况下，您对分支是如何发展的以及每个提交包含的变更种类没有一个总体的了解。更不用说它有点冗长，而且你经常想要更密集的信息显示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/8ddbdec3d2e1e1dd89e77fd3dba9e3b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*51Cnyde-EyCHpr86mfSZOA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">线性提交历史</figcaption></figure><h1 id="187f" class="nb nc iq bd nd ne nf ng nh ni nj nk nl jw nm jx nn jz no ka np kc nq kd nr ns bi translated">分支历史图</h1><p id="bc8f" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">为了查看分支结构，<code class="fe mh mi mj mk b">git log</code>有一个<code class="fe mh mi mj mk b">--graph</code>标志，通过巧妙的格式化选项，我们可以看到关于每个提交的最少信息。例如散列、日期、单行消息和作者。</p><p id="3492" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mh mi mj mk b">git log --graph --pretty=format:”%h %ad | %s%d [%an]” --date=short</code>产生以下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/78c7b43627c99a4c81e285b785d14333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMvzuge7_RVC-K_8f5SKrw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图表上的提交和分支历史记录</figcaption></figure><p id="34ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来分析一下这是怎么回事:</p><ul class=""><li id="d84e" class="ml mm iq ky b kz la lc ld lf mn lj mo ln mp lr mq mr ms mt bi translated"><code class="fe mh mi mj mk b">--graph</code>标志显示了分支和提交的ASCII图形</li><li id="6033" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated"><code class="fe mh mi mj mk b">--pretty=format:”%h %ad | %s%d [%an]</code>确保在图中我们只获得关于每次提交的期望信息:短散列<code class="fe mh mi mj mk b">%h</code>，日期<code class="fe mh mi mj mk b">%ad</code>，提交消息的第一行<code class="fe mh mi mj mk b">%s</code>，引用名(如果有的话)<code class="fe mh mi mj mk b">%d</code>，以及作者名<code class="fe mh mi mj mk b">%an</code></li><li id="892a" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated"><code class="fe mh mi mj mk b">--date=short</code>告诉Git如何<a class="ae kv" href="https://git-scm.com/docs/git-log#Documentation/git-log.txt---dateltformatgt" rel="noopener ugc nofollow" target="_blank">呈现格式字符串中指定的日期</a> ( <code class="fe mh mi mj mk b">%ad</code>)，在本例中是<a class="ae kv" href="https://en.wikipedia.org/wiki/ISO_8601" rel="noopener ugc nofollow" target="_blank"> ISO8601 </a> <code class="fe mh mi mj mk b">YYYY-MM-DD</code>版本</li></ul><p id="0efe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更多格式选项，请查看<a class="ae kv" href="https://git-scm.com/docs/git-log#_pretty_formats" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h2 id="a42e" class="oa nc iq bd nd ob oc dn nh od oe dp nl lf of og nn lj oh oi np ln oj ok nr ol bi translated">别名</h2><p id="034f" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">您很可能不记得也不想多次输入。幸运的是，Git为此提供了别名。</p><p id="1641" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在终端中运行<code class="fe mh mi mj mk b">git config --global alias.hist "log --graph -- pretty=format:\”%h %ad | %s%d [%an]\” --date=short"</code> <em class="mz">一次</em>，设置<code class="fe mh mi mj mk b">git hist</code>别名以立即访问您的库的分支图。</p><p id="64b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者，您可以直接编辑您的<code class="fe mh mi mj mk b">.gitconfig</code>文件并将新的命令定义放入<code class="fe mh mi mj mk b">[alias]</code>部分:</p><pre class="kg kh ki kj gt om mk on oo aw op bi"><span id="1ade" class="oa nc iq mk b gy oq or l os ot">[alias]<br/>hist = log --graph --pretty=format:\”%h %ad | %s%d [%an]\” --date=short</span></pre><p id="41e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mz">注意在格式字符串的引号前的定义中使用反斜杠，这是别名工作所必需的。</em></p><p id="cd3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">现在你可以运行</strong> <code class="fe mh mi mj mk b"><strong class="ky ir">git hist</strong></code> <strong class="ky ir">得到同样的结果。当执行此操作时，您仍然可以传递任何额外的参数和参数，如文件路径或修订范围，如</strong> <a class="ae kv" href="https://git-scm.com/docs/git-log" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">文档</strong> </a> <strong class="ky ir">中所述。</strong></p><h1 id="8aa1" class="nb nc iq bd nd ne nf ng nh ni nj nk nl jw nm jx nn jz no ka np kc nq kd nr ns bi translated">有差异的历史</h1><p id="905f" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated"><code class="fe mh mi mj mk b">git log</code>的<code class="fe mh mi mj mk b">-p</code>标志会将相关的差异添加到日志中显示的每个提交中。这使得对正在进行的工作分支和变更进展的本地审查变得容易。或者像我一样，您有时会使用git-crypt加密的文件，在这种情况下，修改在拉请求中是不可见的。</p><p id="04f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此时<code class="fe mh mi mj mk b">git log -p -w -M -M</code>可以提供帮助，除了提交消息，还会显示相关的差异:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/fda8b89acaa798f0fbabfa0bd4e630b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HNf3rrJo2h05B5MXOCb-OA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">有差异的线性提交历史</figcaption></figure><p id="68be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它是这样工作的:</p><ul class=""><li id="400f" class="ml mm iq ky b kz la lc ld lf mn lj mo ln mp lr mq mr ms mt bi translated"><code class="fe mh mi mj mk b">-p</code>将差异添加到<code class="fe mh mi mj mk b">git log</code>的默认输出中</li><li id="4804" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated"><code class="fe mh mi mj mk b">-w</code>隐藏一行中的空白变化，所以diff只显示真正重要的内容</li><li id="6cbf" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated">确保文件重命名和重写的组合显示为可读的差异，而不是完全删除一个文件并添加另一个文件</li></ul><p id="9704" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加<code class="fe mh mi mj mk b">--reverse</code>标志和提交范围可以让您按照从旧到新的顺序关注历史的给定部分，这与“最新的在顶部”的默认行为相反。</p><p id="4d82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，<code class="fe mh mi mj mk b">git log -p -w -M -M --reverse HEAD~2..HEAD</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/62dda85c915ea8f59b00d9cd11d1caa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1AnumY627XWw-FzWNX7RsQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">最近两次更改的反向提交历史记录，有所不同</figcaption></figure><h2 id="77be" class="oa nc iq bd nd ob oc dn nh od oe dp nl lf of og nn lj oh oi np ln oj ok nr ol bi translated">别名</h2><p id="9d35" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">要设置别名，运行<code class="fe mh mi mj mk b">git config --global alias.difflog "log -p -w -M -M"</code>或编辑您的<code class="fe mh mi mj mk b">.gitconfig</code>，如前一示例所述:</p><pre class="kg kh ki kj gt om mk on oo aw op bi"><span id="5b54" class="oa nc iq mk b gy oq or l os ot">[alias]<br/>difflog = log -p -w -M -M</span></pre><p id="fd18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要按时间顺序查看变更的进度，运行<code class="fe mh mi mj mk b">git difflog --reverse &lt;from commit&gt;..&lt;to commit&gt;</code>并在给定的提交范围内滚动后续补丁。</p><h1 id="3e75" class="nb nc iq bd nd ne nf ng nh ni nj nk nl jw nm jx nn jz no ka np kc nq kd nr ns bi translated">摘要</h1><p id="9b18" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">浏览Git日志是软件开发人员的第二天性。<code class="fe mh mi mj mk b">git log</code>子命令提供了许多惊人的可能性，可以加速您在终端中的工作。在图形上显示您的提交历史或者回顾分支的发展都可以在命令行中访问。而不需要借助额外的可视化工具或在线存储库管理器。</p><p id="5343" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然这些命令通常很长并且很难记住，但是使用简单的名称设置别名可以使它们成为您日常工作流程的一部分。</p></div><div class="ab cl ow ox hu oy" role="separator"><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb"/></div><div class="ij ik il im in"><h1 id="df58" class="nb nc iq bd nd ne pd ng nh ni pe nk nl jw pf jx nn jz pg ka np kc ph kd nr ns bi translated">资料来源和额外阅读</h1><ul class=""><li id="274e" class="ml mm iq ky b kz nt lc nu lf pi lj pj ln pk lr mq mr ms mt bi translated"><a class="ae kv" href="https://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds" rel="noopener ugc nofollow" target="_blank"> Python PEP8指南</a></li><li id="0b12" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated"><a class="ae kv" href="https://git-scm.com/docs/git-log" rel="noopener ugc nofollow" target="_blank"> Git日志文档</a></li><li id="5244" class="ml mm iq ky b kz mu lc mv lf mw lj mx ln my lr mq mr ms mt bi translated"><a class="ae kv" href="https://git-scm.com/book/en/v2/Git-Basics-Git-Aliases" rel="noopener ugc nofollow" target="_blank"> Git别名</a></li></ul></div></div>    
</body>
</html>