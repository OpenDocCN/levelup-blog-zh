<html>
<head>
<title>Prevent Brute Force Attacks in Node.JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">防止节点中的暴力攻击。射流研究…</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/prevent-brute-force-attacks-in-node-js-419367ae35e6?source=collection_archive---------0-----------------------#2022-03-20">https://levelup.gitconnected.com/prevent-brute-force-attacks-in-node-js-419367ae35e6?source=collection_archive---------0-----------------------#2022-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c46b67b29c1516beae10ee1aec55bf57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yaTYhmeCgtx9H4sailcmmA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">暴力攻击</figcaption></figure><h1 id="4c78" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是暴力攻击？</h1><p id="144f" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">当你有一个需要用户认证的应用程序时，有人可以尝试所有可能的字母、数字和符号的组合，然后一个接一个地发送它们，找出特定用户的密码。简单来说这就是暴力攻击。</p><h1 id="6fc7" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是字典攻击或者混合蛮力攻击？</h1><p id="2434" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">通常尝试所有可能的字母、数字、符号组合并不是获取用户密码的快速方法。为了提高速度，攻击者通常使用字典中的单词，大多数时候人们选择容易回忆的密码，因此大多数密码是有效单词和简单数字的组合。还有一些常见的密码数据库被攻击者用作字典。</p><p id="e2d8" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">为了感受这个问题，让我们用一些从网络新闻中提取的有用数据来谈谈。</p><h2 id="ad9e" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">十大最常见的密码:</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="7d85" class="md kd iq mu b gy my mz l na nb">123456<br/>123456789<br/>qwerty<br/>password<br/>12345<br/>qwerty123<br/>1q2w3e<br/>12345678<br/>111111<br/>1234567890</span></pre><h2 id="889e" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">密码中最常用的年份:</h2><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/cfba587562809777938b3033abe72ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZAda9ArZw4s4rbNjg084Zw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">密码中最常用的年份</figcaption></figure><h2 id="24fd" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">在哪里可以找到用于测试的密码字典？</h2><p id="aefb" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">在<a class="ae nd" href="https://web.archive.org/web/20120207113205/http://www.insidepro.com/eng/download.shtml" rel="noopener ugc nofollow" target="_blank">这个网站</a>，你可以找到字典列表。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="9c42" class="kc kd iq bd ke kf nl kh ki kj nm kl km kn nn kp kq kr no kt ku kv np kx ky kz bi translated">暴力攻击的不同情况以及我们可以预防的方法</h1><h2 id="44c9" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">1.从一个IP强制一个特定的用户</h2><p id="0202" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">在这种情况下，攻击者只从一个特定的IP尝试特定用户的可能密码。防止这种暴力很容易。我们可以简单地通过基于IP的速率限制器来防止这种情况:</p><p id="0a86" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">如果你使用express，有各种各样的软件包可以做到这一点，其中之一就是<a class="ae nd" href="https://github.com/nfriedly/express-rate-limit" rel="noopener ugc nofollow" target="_blank"> express-rate-limit </a></p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nq nr l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">快速速率限制</figcaption></figure><p id="bd8e" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">正如我们在limiter配置中看到的，每个IP每10分钟只能发送5个。</p><p id="06e0" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">它仍然不完美，我们将在接下来的步骤中改进它。</p><h2 id="9c72" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">2.从不同的IP强制一个特定的用户</h2><p id="7260" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">在这种情况下，攻击者有许多僵尸，他试图通过从这些僵尸发送请求来暴力破解用户的密码，或者攻击者可以访问不同的代理，因此我们无法通过仅关注IP来识别这种暴力破解。</p><p id="afa3" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">解决方案是限制登录尝试的次数。让我们实现最简单的方法，我们可以存储这些登录尝试，并根据情况采取行动，在这之后，我们将看到一个奇特的包。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="cbce" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">逻辑非常简单，如果用户登录失败，我们将在<strong class="lc ir"> Redis </strong>中存储一个密钥，每次用户尝试登录失败时，我都会增加这个数字。如果这个数字大于“<strong class="lc ir">maxnumberofiledlogins</strong>”，我不会让用户尝试登录。同样，每次我将Redis密钥的到期时间设置为<strong class="lc ir">1小时</strong>，所以如果攻击者想要再次发送登录请求，他/她应该等待一个小时。</p><p id="970a" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">另一个深思熟虑的方法是用<strong class="lc ir">动态持续时间</strong>来阻止用户的登录尝试，这样即使机器人有麻烦，但也可能让你的用户感到不安。</p><p id="5262" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><em class="ns">根据您的应用和业务，向用户发送电子邮件</em>或<em class="ns">禁用账户</em>是另一个不错的选择。</p><p id="1c68" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我们看到的实现很简单，肯定有一些缺陷，因此更好的处理方式是使用灵活的<a class="ae nd" href="https://github.com/animir/node-rate-limiter-flexible/wiki/Overall-example#minimal-protection-against-password-brute-force" rel="noopener ugc nofollow" target="_blank">节点速率限制器</a>。</p><h2 id="7ffc" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">3.大规模暴力攻击</h2><p id="6cfa" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">此方法试图绕过帐户锁定。通过这种方法，攻击者发送来自僵尸的请求，并尝试不同的用户和密码。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/c94733c6195f3733e8b5305b5140760c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4BPoCmpE9kguKcPcey37A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">僵尸发送请求</figcaption></figure><p id="21ce" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">您的应用会发生什么情况？</strong>如果你的应用经常受到攻击，数百个用户账户可能会被锁定或无法登录。</p><p id="0890" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">这是一种拒绝服务，因为找到用户密码的概率不高(他们既没有用户名也没有密码)。我们可以尝试<a class="ae nd" href="https://phoenixnap.com/blog/prevent-ddos-attacks" rel="noopener ugc nofollow" target="_blank"> DDoS防范技术</a>。</p><p id="2cb0" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">防止这些请求的另一个有效方法是拥有一个<strong class="lc ir">验证码。</strong></p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nu nr l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">你是机器人吗？:)</figcaption></figure><p id="5ec4" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">有了验证码，您就可以防止这些登录尝试，因此，您的用户能够正常登录您的服务并做出反应，即使在攻击期间也是如此。</p><p id="9b7f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">如果你想在Nodejs上实现谷歌验证码，看看这篇文章。</p><h2 id="2e95" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">让暴力攻击者日子更难过的其他方法</h2><p id="6550" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="lc ir">要求使用强密码</strong></p><p id="7173" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">强制用户使用数字、符号、大写字母，并防止用户在密码中使用2或3个以上的连续数字或字符。</p><p id="67fc" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><a class="ae nd" href="https://www.npmjs.com/package/check-password-strength" rel="noopener ugc nofollow" target="_blank">check-password-strength</a>包可以帮你。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nq nr l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">检查密码强度</figcaption></figure><p id="b6ca" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">使用双因素认证</strong></p><p id="19f4" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">通过在电子邮件或短信中发送密码旁边的代码，你就很难进入用户的账户。即使您没有对所有用户都这样做，也应该考虑对具有特殊权限的用户进行双因素身份验证。</p><p id="3334" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">不同的登录网址</strong></p><p id="74d8" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">这不是防止暴力攻击的好方法，但是大多数自动化工具都不是为处理这种设计而设计的。在Nodejs中，您可以很容易地实现这一点:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="2dd5" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">为高级用户使用允许的IP地址</strong></p><p id="34e7" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">让具有特殊访问权限的高级用户设置一些允许的IP，并且只让他们从这些特定的IP登录。</p><p id="2d75" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">使用cookies检测未知浏览器和设备</strong></p><p id="04c8" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">防止用户试图从未知设备和浏览器登录，或者像谷歌一样让他们知道有人试图从未知设备登录。您可以使用express <a class="ae nd" href="https://www.npmjs.com/package/express-device" rel="noopener ugc nofollow" target="_blank">设备捕获</a>来捕获设备信息。</p><p id="6568" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">未给出登录失败的额外信息</strong></p><p id="0047" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">如果登录尝试失败，不要让他们知道用户是否存在。大多数网站告诉你<strong class="lc ir">密码或用户不正确。</strong></p><p id="d761" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">如果您让攻击者知道该用户是否存在，那么他们就可以收集您的用户列表以进行进一步的攻击。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="e5c7" class="kc kd iq bd ke kf nl kh ki kj nm kl km kn nn kp kq kr no kt ku kv np kx ky kz bi translated">防止对您的应用程序进行暴力攻击的操作摘要</h1><ul class=""><li id="5b5e" class="nv nw iq lc b ld le lh li ll nx lp ny lt nz lx oa ob oc od bi translated">有限次失败的登录尝试</li><li id="5115" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">限制从指定的IP地址登录</li><li id="da8a" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">双因素认证</li><li id="52c8" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">强密码</li><li id="3e93" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">验证码</li><li id="0f34" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">不同的登录URL</li><li id="a44f" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">为特殊用户使用允许的IP</li><li id="1e17" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">检测来自未知浏览器和设备的登录尝试</li><li id="a57c" class="nv nw iq lc b ld oe lh of ll og lp oh lt oi lx oa ob oc od bi translated">没有给出登录失败的额外信息</li></ul><div class="oj ok gp gr ol om"><a href="https://cybernews.com/best-password-managers/most-common-passwords/" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">最常见的密码2022 -你的在名单上吗？网络新闻</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">数据泄露和网络攻击变得越来越普遍。为了保持您的在线身份和隐私…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">cybernews.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa jw om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">阻挡暴力攻击</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">作者:Esheridan供稿人:KirstenS，Paul McMillan，Raesene，Adedov，Dinis。克鲁兹、乔、丹尼尔·沃勒、金索林……</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">owasp.org</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa jw om"/></div></div></a></div></div></div>    
</body>
</html>