<html>
<head>
<title>What is OAuth and How does OAuth work</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是OAuth，OAuth是如何工作的</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-oauth-and-how-does-oauth-work-742bb923c91f?source=collection_archive---------7-----------------------#2020-10-29">https://levelup.gitconnected.com/what-is-oauth-and-how-does-oauth-work-742bb923c91f?source=collection_archive---------7-----------------------#2020-10-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="691b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">OAuth 2.0的解释</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5a48aa3bd02b97482f65fcc89691d0d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SRIS1RpM6paJSqSU"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·沙孔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="2109" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">正常登录流程</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/bac4bec80b7798c09e608eff1cd72e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3lsAgCpIpM-nd5tPHRYGCg.png"/></div></div></figure><p id="e427" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">登录网站最简单的方法是输入帐户名和相应的密码。然后，服务器获取这些信息，并在数据库中查找与给定ID和PW匹配的信息。如果所有给定的信息都与数据库中的凭证信息匹配，服务器将返回200，即4xx，5xx。很简单也很容易。因为连接是在最终用户和服务器之间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/0614965d4d98e27df255b9c31dee43c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ljnu2pPOrbge6CdKaz2G5A.png"/></div></div></figure><p id="8505" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">然而，你应该怎么做才能让用户阅读并带来他们的Google日历日程呢？当然，最简单的方法是询问他们的谷歌登录信息。但这是一种非常危险的方式，也不推荐使用。</p><p id="9ae9" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">这是OAuth进来的时候。</p><h1 id="e80d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">OAuth是什么？</h1><p id="e02a" class="pw-post-body-paragraph ls lt it lu b lv mp ju lx ly mq jx ma mb mr md me mf ms mh mi mj mt ml mm mn im bi translated">根据<a class="ae ky" href="https://searchapparchitecture.techtarget.com/definition/OAuth#:~:text=OAuth%20(Open%20Authorization)%20is%20an,based%20authorization%20on%20the%20internet.&amp;text=It%20acts%20as%20an%20intermediary,account%20information%20to%20be%20shared." rel="noopener ugc nofollow" target="_blank">搜索架构</a>，他们对OAuth的描述如下。</p><blockquote class="mu mv mw"><p id="4ec4" class="ls lt mx lu b lv lw ju lx ly lz jx ma my mc md me mz mg mh mi na mk ml mm mn im bi translated">OAuth(开放授权)是一个开放的标准授权框架，用于互联网上基于令牌的授权。OAuth发音为“oh-auth”，它允许第三方服务(如脸书和谷歌)使用最终用户的帐户信息，而不会将用户的帐户凭据暴露给第三方。</p></blockquote><p id="475b" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">简单地说，OAuth使用户可以使用第三方服务的功能成为可能。例如，当用户登录到Medium并试图带来在Google Calander中注册的事件时，用户被要求登录到Google，而不是在Medium中。登录成功后，用户现在就可以获得时间表。这就是OAuth。</p><h1 id="da58" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">条款</h1><p id="7f69" class="pw-post-body-paragraph ls lt it lu b lv mp ju lx ly mq jx ma mb mr md me mf ms mh mi mj mt ml mm mn im bi translated">由于OAuth的术语和概念在任何服务中都是相同的，为了支持OAuth 2.0，我们需要检查在OAuth 2.0规范<a class="ae ky" href="https://tools.ietf.org/html/rfc6749#section-1.1" rel="noopener ugc nofollow" target="_blank"> RFC-6749 </a>中使用的正确术语。</p><p id="8310" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">👇下面的特性显示了我将在这篇文章中解释OAuth如何工作时使用的图标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/1184f6df7d2afc701b5eabc17fe00a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5z9Zqs3vdZWXLt64wKW3dA.png"/></div></div></figure><ul class=""><li id="920e" class="nc nd it lu b lv lw ly lz mb ne mf nf mj ng mn nh ni nj nk bi translated">资源所有者:通常是拥有使用所提供的服务所需的信息(包括登录信息)的人，例如使用该服务的任何用户。</li><li id="b62c" class="nc nd it lu b lv nl ly nm mb nn mf no mj np mn nh ni nj nk bi translated">客户端:提供受保护资源的应用程序，例如图像、内容或类似的东西，例如，在前面的示例中，Medium是客户端。</li><li id="cd56" class="nc nd it lu b lv nl ly nm mb nn mf no mj np mn nh ni nj nk bi translated">资源服务器:托管资源的服务器。它可能是给你日历资源的谷歌服务器。</li><li id="948b" class="nc nd it lu b lv nl ly nm mb nn mf no mj np mn nh ni nj nk bi translated">授权服务器:服务器为客户机提供一个访问令牌，这是使用更多API所必需的。</li></ul><h1 id="f2a1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">OAuth如何工作</h1><p id="0f7e" class="pw-post-body-paragraph ls lt it lu b lv mp ju lx ly mq jx ma mb mr md me mf ms mh mi mj mt ml mm mn im bi translated">你想用你的Twitter ID登录到Medium，但是你并不真的想创建一个新账户。工作太多了，不是吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/0dcbd13c1b89307a7ba72d5bf647a2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n6K2MqPNEjLDHR0L8Bskdg.png"/></div></div></figure><p id="6962" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">假设用户，即资源所有者，想要通过Twitter登录。然后大图会被视为上图。客户机，即您的应用程序，向资源所有者显示一个登录按钮。然后，资源所有者可以在单击该按钮后看到登录页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/c26ff236a39a05d95743ac8ce1c0ac32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9lGRcWTEOPM565xo3k8qQQ.png"/></div></div></figure><p id="e7da" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">当资源所有者试图登录时，客户端必须询问资源所有者是否授权第三方服务可以访问照片、个人资料或类似的内容。如果资源所有者同意这一点，授权服务器会要求他们提供凭证，比如他们的帐户名和密码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/ca5fa1ea6457bb2240aeca40def1cb21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DeazhaCr6CCeeD3MMtv8Nw.png"/></div></div></figure><p id="3be1" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">一旦资源所有者成功登录，授权服务器就向客户机返回一个访问令牌。这是获取Twitter中其他API所必需的(例如)。</p><p id="2913" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">大多数情况下，访问令牌都有一个过期时间(也许我可以称之为TTL？)通常少于60分钟。一旦过期，客户端可以使用另一个名为刷新令牌的令牌获得新的访问令牌。当然，这个刷新令牌也有一天会过期，然后客户端必须采取相同的步骤，向资源所有者询问登录信息等等，以获得新的访问令牌。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/6c253f67171f526f5549a1328810f844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V9iMEzyqYFccNyTBNRt_OQ.png"/></div></div></figure><p id="4e57" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">有了给定的访问令牌，客户机通过在头中发送访问令牌来获取Twitter的API。然后，资源服务器要求授权服务器检查该访问令牌对于该用户是否有效。一旦授权服务器对资源服务器说“是的，没问题”，它就将请求的数据返回给客户机。</p><h1 id="0b8f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">稍微深入一点</h1><p id="c867" class="pw-post-body-paragraph ls lt it lu b lv mp ju lx ly mq jx ma mb mr md me mf ms mh mi mj mt ml mm mn im bi translated">让我们深入了解这种流动是如何工作的。要获取访问令牌，您应该提前在第三方服务中注册您想要使用的应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/5e886df7a59e836413530933f66061a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OkNtTykanIePtptzNvR61A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">谷歌应用控制台</figcaption></figure><p id="b479" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">例如，当您在Google APIs中创建一个项目时，您可以获得两个凭证，客户端ID和客户端机密。请注意，在您的实际项目中，无论如何都不能泄露这些密钥，尤其是要非常小心保密密钥。</p><p id="c067" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">还有一些需要知道的事情，那就是授权服务器在授权访问后将页面发送到的重定向URL和作用域。OAuth上下文中的范围指的是客户端想要访问多少功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/5eb38c9c0b261efc2692cc47ce5f8135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ap0hOMpnu2SqwIuHaHe4EQ.png"/></div></div></figure><p id="9d20" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">客户端通过发送客户端ID、范围信息和回调URL(重定向URL)请求从授权服务器获取授权代码。授权服务器检查它接收的每个信息是否与它保存的信息相同。如果有任何不同，就不会返回授权码。</p><p id="5ded" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">假设Twitter APIs包括个人资料、发布、消息和喜欢。如果您的客户端范围只包含个人资料和喜好，那么授权服务器会给您一个授权码，只允许您访问个人资料和喜好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/029aa462326adbd32a212cc4e6bb9317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c5ha2WI6Ze4-radJgPc5Qg.png"/></div></div></figure><p id="6bd8" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">然后，客户端通过发送授权类型、客户端ID、客户端秘密、授权代码和重定向URL，最终请求授权服务器获得访问令牌。授权类型是“授权码”、“隐式”、“资源所有者密码凭证”和“客户端凭证”中的一种。客户端机密是在创建项目时返回的密钥。</p><p id="6854" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">授权服务器检查给定的授权码是否与其拥有的授权码匹配。如果匹配，则授权服务器用存储授权码的相同的两个密钥检查客户秘密和客户ID。</p><p id="87d9" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果所有信息都正确匹配，授权服务器将向客户端返回一个访问令牌。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/b9bf140a73e7c568150e701b9077ab1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CKNEFMFokwZxXGpBIfLYQ.png"/></div></div></figure><p id="3b40" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">客户端可以用访问令牌获取Twitter APIs。</p><h1 id="db50" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="bb6b" class="pw-post-body-paragraph ls lt it lu b lv mp ju lx ly mq jx ma mb mr md me mf ms mh mi mj mt ml mm mn im bi translated">OAuth认证比有状态服务器中使用的认证更强大。因为在有状态服务器中，他们必须在内存中保存关于登录的会话，所以如果用户数量很大，不仅会很繁重，而且当有多个服务器时，与其他服务器进行通信也会更加困难。</p><p id="8d34" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">然而，使用OAuth，服务器不必担心与其他服务器就认证问题进行通信。嗯，仍然需要在某个地方保存访问令牌的信息。</p><p id="da4e" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">因此，还有另一种身份认证方式，称为JWT。我以后会试着写一篇关于它的文章。</p><p id="66d5" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">无论您使用何种支持OAuth的服务，OAuth的流程和概念几乎总是相同的。因此，一旦你理解了整个流程，你就不会再困惑了。</p><h1 id="e4fb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">资源</h1><ul class=""><li id="4cb7" class="nc nd it lu b lv mp ly mq mb nx mf ny mj nz mn nh ni nj nk bi translated"><a class="ae ky" href="https://tools.ietf.org/html/rfc6749" rel="noopener ugc nofollow" target="_blank">https://tools.ietf.org/html/rfc6749</a></li><li id="e6bd" class="nc nd it lu b lv nl ly nm mb nn mf no mj np mn nh ni nj nk bi translated">【https://tools.ietf.org/html/rfc6750#section-6.1.1 T2】号</li><li id="b300" class="nc nd it lu b lv nl ly nm mb nn mf no mj np mn nh ni nj nk bi translated"><a class="ae ky" href="https://searchapparchitecture.techtarget.com/definition/OAuth#:~:text=OAuth%20(Open%20Authorization)%20is%20an,based%20authorization%20on%20the%20internet.&amp;text=It%20acts%20as%20an%20intermediary,account%20information%20to%20be%20shared." rel="noopener ugc nofollow" target="_blank">什么是OAuth-search apparchitecture</a></li></ul></div></div>    
</body>
</html>