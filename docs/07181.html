<html>
<head>
<title>Statsmodels for time series data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时序数据的统计模型</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/statsmodels-for-time-series-data-72ddab409fdc?source=collection_archive---------11-----------------------#2021-01-29">https://levelup.gitconnected.com/statsmodels-for-time-series-data-72ddab409fdc?source=collection_archive---------11-----------------------#2021-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c78a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">简要介绍有助于处理时间序列数据的statsmodel。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/964047a9429d804acc98e919880f2cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ifB5qdurZclS2EP_"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">卢卡斯·布拉塞克的照片</figcaption></figure><p id="25f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在python中，在处理时序数据时会用到一个非常广泛使用的名为statsmodel的库。它基于统计编程语言r。该模块有助于分析数据、执行统计功能以及创建统计模型。它还具有绘图功能。</p><p id="01c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，让我们开始吧！</p><h1 id="6c6c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">→安装</h1><p id="c5be" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">statsmodel已经包含在python环境文件中。如果使用不同的环境，如Anaconda，则使用下面的命令进行安装:</p><blockquote class="mp"><p id="0243" class="mq mr iq bd ms mt mu mv mw mx my lr dk translated">康达安装统计模型</p></blockquote><h1 id="456f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw mz jx me jz na ka mg kc nb kd mi mj bi translated">→导入包</h1><p id="ca2d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">像NumPy和pandas这样用来帮助处理数据的基本包是和matplotlib一起导入的，用来帮助绘图。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="9cc1" class="nh lt iq nd b gy ni nj l nk nl"><strong class="nd ir">&gt;&gt;&gt; import</strong> pandas <strong class="nd ir">as</strong> pd<br/><strong class="nd ir">&gt;&gt;&gt; import</strong> numpy <strong class="nd ir">as</strong> np<br/><strong class="nd ir">&gt;&gt;&gt; import</strong> matplotlib.pyplot <strong class="nd ir">as</strong> plt<br/><strong class="nd ir">&gt;&gt;&gt; %</strong>matplotlib inline</span></pre><p id="8e17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后也导入statsmodel。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="c43e" class="nh lt iq nd b gy ni nj l nk nl"><strong class="nd ir">&gt;&gt;&gt; import</strong> statsmodels.api <strong class="nd ir">as</strong> sm</span></pre><h1 id="88db" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">→获取数据</h1><p id="c46e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">statsmodels提供了获取数据集的方法。有如下所示的各种数据集:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7a37b7440ecdd58541909f54be7c00d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*2xf3VZ0rRGd6hHmCZOp6xA.png"/></div></figure><p id="ef72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将使用的是宏数据，因为它是时间序列数据。使用load_pandas()方法，数据将被加载。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="c1e0" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; data <strong class="nd ir">=</strong> sm.datasets.macrodata.load_pandas().data<br/>&gt;&gt;&gt; data.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/a19a8f033dfc3e08dabc9bb7c288bc50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Om9_RkDxMNliti7YOMVbSQ.png"/></div></div></figure><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="84ec" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; data.tail()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/9248ff15c03820cef6ca9350255d3831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*icLhOIn5_rWxQeGiO3MOTQ.png"/></div></div></figure><p id="fec4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了理解列标题的含义，我们可以使用NOTE属性打印详细信息。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="301e" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; print(sm.datasets.macrodata.NOTE)<br/>::<br/>    Number of Observations - 203</span><span id="7c4f" class="nh lt iq nd b gy np nj l nk nl">    Number of Variables - 14</span><span id="f7de" class="nh lt iq nd b gy np nj l nk nl">    Variable name definitions::</span><span id="efc7" class="nh lt iq nd b gy np nj l nk nl">        year      - 1959q1 - 2009q3<br/>        quarter   - 1-4<br/>        realgdp   - Real gross domestic product (Bil. of chained 2005 US$,<br/>                    seasonally adjusted annual rate)<br/>        realcons  - Real personal consumption expenditures (Bil. of chained<br/>                    2005 US$, seasonally adjusted annual rate)<br/>        realinv   - Real gross private domestic investment (Bil. of chained<br/>                    2005 US$, seasonally adjusted annual rate)<br/>        realgovt  - Real federal consumption expenditures &amp; gross investment<br/>                    (Bil. of chained 2005 US$, seasonally adjusted annual rate)<br/>        realdpi   - Real private disposable income (Bil. of chained 2005<br/>                    US$, seasonally adjusted annual rate)<br/>        cpi       - End of the quarter consumer price index for all urban<br/>                    consumers: all items (1982-84 = 100, seasonally adjusted).<br/>        m1        - End of the quarter M1 nominal money stock (Seasonally<br/>                    adjusted)<br/>        tbilrate  - Quarterly monthly average of the monthly 3-month<br/>                    treasury bill: secondary market rate<br/>        unemp     - Seasonally adjusted unemployment rate (%)<br/>        pop       - End of the quarter total population: all ages incl. armed<br/>                    forces over seas<br/>        infl      - Inflation rate (ln(cpi_{t}/cpi_{t-1}) * 400)<br/>        realint   - Real interest rate (tbilrate - infl)</span></pre><p id="c11f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在要处理时间序列，将year列作为索引是很重要的。因此，可以使用statsmodels的时间序列分析(tsa)模块对其进行相应的更改。它有一个名为dates_from_range的方法，其中可以提到范围。我们以1959年第一季度(Q1)为起点，以2009年第三季度(Q3)为终点。使用熊猫将为此创建一个索引。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="4531" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; idx <strong class="nd ir">=</strong> pd.Index(sm.tsa.datetools.dates_from_range('1959Q1','2009Q3'))</span></pre><p id="7369" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然已经创建了索引，我们可以将它分配给数据帧。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="9e1a" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; data.index <strong class="nd ir">=</strong> idx<br/>&gt;&gt;&gt; data.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/14a0346261809f73d06258f1ffe86b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Z2Mz4fd9ecO1ZfNPJ_5Qw.png"/></div></div></figure><h1 id="8434" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">→可视化</h1><p id="e608" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">绘制DPI的线性图来观察趋势。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="04a8" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; data['realdpi'].plot()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/21034c00aea6226ad129ca4efb61d32f.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*ASJ5rlCqxPU1yR77jQ_uXw.png"/></div></figure><p id="2847" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">统计模型有助于获得估计的趋势。使用一种称为Hodrick-Prescott滤波器的滤波器。该过滤器将时间序列数据区分为趋势和周期成分。应用此过滤器时，它会返回一个由估计周期和趋势组成的元组。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="3797" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; dpi <strong class="nd ir">=</strong> sm.tsa.filters.hpfilter(data['realdpi'])<br/>&gt;&gt;&gt; dpi<br/>(1959-03-31     32.611738<br/> 1959-06-30     45.961546<br/> 1959-09-30     23.190972<br/> 1959-12-31     18.550907<br/> 1960-03-31     23.077748<br/>                  ...    <br/> 2008-09-30   -128.596455<br/> 2008-12-31    -87.557288<br/> 2009-03-31   -122.358968<br/> 2009-06-30    -11.941350<br/> 2009-09-30    -89.467814<br/> Name: realdpi_cycle, Length: 203, dtype: float64,<br/> 1959-03-31     1854.288262<br/> 1959-06-30     1873.738454<br/> 1959-09-30     1893.209028<br/> 1959-12-31     1912.749093<br/> 1960-03-31     1932.422252<br/>                   ...     <br/> 2008-09-30     9966.896455<br/> 2008-12-31    10007.957288<br/> 2009-03-31    10048.758968<br/> 2009-06-30    10089.441350<br/> 2009-09-30    10130.067814<br/> Name: realdpi_trend, Length: 203, dtype: float64)</span></pre><p id="a69f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在使用元组解包，趋势被提取，然后被绘制。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="4c6a" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; dpi_cycle,dpi_trend <strong class="nd ir">=</strong> sm.tsa.filters.hpfilter(data['realdpi'])<br/>&gt;&gt;&gt; data['trend'] <strong class="nd ir">=</strong> dpi_trend<br/>&gt;&gt;&gt; data[['realdpi','trend']].plot()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/6af0a0b7d37e199a4f7b52f410ac33eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*TkmalsIP028BEg9sHVYQ1g.png"/></div></figure><p id="e838" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们放大来更好地了解这个情节。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="536f" class="nh lt iq nd b gy ni nj l nk nl">&gt;&gt;&gt; data[['realdpi','trend']]['2005-01-01':].plot()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/b8c297abd6da6c0ef73fa5fcfc76ba03.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*UMLTxlqNrm-qzziLuMsLNw.png"/></div></figure><p id="1470" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">至此，您对使用statsmodels库有了基本的了解。有关更多详细信息，请查看下面的官方文档。</p><div class="nu nv gp gr nw nx"><a href="https://www.statsmodels.org/stable/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">简介-统计模型</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">statsmodels是一个Python模块，它为许多不同的统计数据的估计提供了类和函数</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">www.statsmodels.org</p></div></div></div></a></div><blockquote class="mp"><p id="cbb3" class="mq mr iq bd ms mt og oh oi oj ok lr dk translated"><em class="ol">参见笔记本此处代号</em><a class="ae kv" href="https://github.com/jayashree8/Finance_Trading_In_Python/blob/main/Statsmodels%20for%20time%20series%20data/Statsmodel%20for%20time%20series%20data.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="ol"/></a><em class="ol">。</em></p></blockquote><blockquote class="om on oo"><p id="7898" class="kw kx op ky b kz oq jr lb lc or ju le os ot lh li ou ov ll lm ow ox lp lq lr ij bi translated"><em class="iq">联系我:</em> <a class="ae kv" href="https://www.linkedin.com/in/jayashree-domala8/" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> LinkedIn </em> </a></p><p id="bd1a" class="kw kx op ky b kz la jr lb lc ld ju le os lg lh li ou lk ll lm ow lo lp lq lr ij bi translated"><em class="iq">查看我的其他作品:</em> <a class="ae kv" href="https://github.com/jayashree8" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> GitHub </em> </a></p></blockquote></div></div>    
</body>
</html>