<html>
<head>
<title>JavaScript Basics Series: Closure</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript基础系列:闭包</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-basics-series-closure-9caaf2a85487?source=collection_archive---------13-----------------------#2020-08-15">https://levelup.gitconnected.com/javascript-basics-series-closure-9caaf2a85487?source=collection_archive---------13-----------------------#2020-08-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="78a6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用简单明了的例子解释了一个重要的概念</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c483bc7742a8c77c2c4e53aabcfcd23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnqSYtvaDl9MrB0Jfb92oQ.jpeg"/></div></div></figure><blockquote class="ku kv kw"><p id="155e" class="kx ky kz la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">JavaScript基础是一个探索每个前端软件工程师都应该理解的一些核心概念的系列。这些概念不仅对工作面试的成功很重要，对开发人员的职业生涯也很重要。</p></blockquote><p id="a2fe" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi lx translated"><span class="l ly lz ma bm mb mc md me mf di">在【JavaScript基础系列的这一部分，我们将解释一个非常重要的概念，即闭包。这不仅是JavaScript本身的一个核心概念，而且很可能在与JavaScript相关的访谈中出现，这一点尤为重要。事不宜迟，让我们开始吧！😃</span></p><p id="9df3" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">什么是终结？</p><p id="48cc" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">一个更好的定义是由<a class="ae mg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures" rel="noopener ugc nofollow" target="_blank"> Mozilla的网络文档</a>提供的:</p><p id="9ed4" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated"><em class="kz">一个</em> <strong class="la iu"> <em class="kz">闭包</em> </strong> <em class="kz">是用对其周围状态的引用捆绑在一起(封闭)的一个函数的组合(即</em> <strong class="la iu"> <em class="kz">词法环境</em> </strong> <em class="kz">)。换句话说，闭包允许您从内部函数访问外部函数的范围。在JavaScript中，闭包是在每次创建函数时创建的。</em></p><p id="07b0" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">换句话说，这是将一个函数放在另一个函数内部的事实，这使得被封闭的函数可以访问外部的变量。术语“词汇环境”在这种情况下指的是外部函数的范围。让我们用一个例子说明这一点:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="2caf" class="mm mn it mi b gy mo mp l mq mr">function outer(){<br/>     let outerVar = "outside";</span><span id="b671" class="mm mn it mi b gy ms mp l mq mr">     function inner(){</span><span id="9f46" class="mm mn it mi b gy ms mp l mq mr">            let innerVar = "inside";<br/>            console.log("The outer variable is " + outerVar);</span><span id="6010" class="mm mn it mi b gy ms mp l mq mr">     }</span><span id="1f35" class="mm mn it mi b gy ms mp l mq mr"> return inner;<br/>}</span></pre><p id="d8c9" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">输出:<code class="fe mt mu mv mi b">[Function: inner]</code></p><blockquote class="ku kv kw"><p id="1da6" class="kx ky kz la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">在JavaScript中，默认情况下，任何被执行的函数都会创建一个闭包</strong></p></blockquote><p id="b414" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">内部函数可以访问外部函数的变量，因为它在其<em class="kz">局部</em>或词法范围内。更具体地说，我想指出以下几点:</p><ul class=""><li id="17f2" class="mw mx it la b lb lc le lf lu my lv mz lw na lt nb nc nd ne bi translated">inner可以访问outer函数的变量，而后者<strong class="la iu">不能访问<em class="kz"> innerVar </em>。词法范围是单行道，只有内部函数可以访问外部函数中的任何内容。</strong></li><li id="fd60" class="mw mx it la b lb nf le ng lu nh lv ni lw nj lt nb nc nd ne bi translated">外部函数只能通过返回内部函数来获得结果(返回值、控制台输出等)。</li><li id="f290" class="mw mx it la b lb nf le ng lu nh lv ni lw nj lt nb nc nd ne bi translated">只返回<strong class="la iu"> <em class="kz">函数定义</em> </strong>，不返回调用！不调用内部函数。</li><li id="dc2a" class="mw mx it la b lb nf le ng lu nh lv ni lw nj lt nb nc nd ne bi translated">内部函数在执行之前从外部函数<em class="kz">返回。</em></li></ul><p id="e93d" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">这意味着从技术上讲，它不应该能够访问外部函数的变量。在许多编程语言中，外部函数的所有变量都会被声明并一直存在，直到函数返回值为止(在本例中是内部函数)。当一个函数被调用时，它会创建一个<em class="kz">调用(或执行)栈，</em>，这只是专门分配的内存空间。每个调用都用一组局部变量创建自己的执行堆栈。例如，在C/C++这样的传统语言中，调用内部函数会创建自己的内存堆栈(见下图)。因此，<em class="kz">内部函数不能访问其自身作用域</em>之外的任何变量。然而，在JavaScript中，执行的每个函数都会创建一个<em class="kz">闭包</em>。换句话说，每一个函数都有能力<em class="kz">将函数封装在其中，这种封装让它们的内部函数可以访问它们内部的所有变量</em>。因此，闭包就是函数和它的词法范围的简单组合。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/507a4d1d9cd70502fdd020f86cc79279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*8ZY8CqPAEV3bg53osgpa6g.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">在其他语言中，调用一个函数会在内存中创建一个调用栈。在JS中，会创建一个闭包。</figcaption></figure><p id="524b" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">现在，假设我们想返回第二个函数中的实际值，而不是它的定义。为此，我们可以添加以下代码行:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="a623" class="mm mn it mi b gy mo mp l mq mr">let innerOutput = outer();  //Output: <!-- -->[Function: inner]<br/>/*<br/> Here's what happens behind the scenes after the code above runs:<br/> innerOutput = inner<br/>*/</span><span id="3f15" class="mm mn it mi b gy ms mp l mq mr">console.log(innerOutput())<br/>//Same as innerOutput = inner();</span></pre><p id="3ce0" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">输出:<code class="fe mt mu mv mi b">The outer variable is outside</code></p><p id="f72c" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">闭包之所以如此重要，是因为它使内部变量保持私有。封闭函数外部的任何东西都不能访问它的变量。这在使用事件处理程序、部分应用程序和回调函数时非常重要。目标是保持事情简单，因此我们可以在另一个博客中讨论这些概念。</p><p id="f6cb" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">目前，我们可以将上述内容总结如下:</p><ul class=""><li id="8841" class="mw mx it la b lb lc le lf lu my lv mz lw na lt nb nc nd ne bi translated">闭包是将一个函数封闭在另一个函数中的事实，这样被封闭的函数就可以访问其自身范围之外的变量。</li><li id="5fb6" class="mw mx it la b lb nf le ng lu nh lv ni lw nj lt nb nc nd ne bi translated">默认情况下，JavaScript会为创建的每个函数创建一个闭包。</li><li id="3935" class="mw mx it la b lb nf le ng lu nh lv ni lw nj lt nb nc nd ne bi translated">闭包允许被封闭函数的变量的私密性</li></ul><p id="97d8" class="pw-post-body-paragraph kx ky it la b lb lc ju ld le lf jx lg lu li lj lk lv lm ln lo lw lq lr ls lt im bi translated">感谢您的阅读！编码快乐！😃</p></div></div>    
</body>
</html>