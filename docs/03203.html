<html>
<head>
<title>RxJS Operators: throttleTime and debounceTime</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RxJS运算符:throttleTime和debounceTime</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/rxjs-operators-throttletime-and-debouncetime-b2ec49cbf1e7?source=collection_archive---------2-----------------------#2020-04-25">https://levelup.gitconnected.com/rxjs-operators-throttletime-and-debouncetime-b2ec49cbf1e7?source=collection_archive---------2-----------------------#2020-04-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/2a24fa21bce77c32bae95727a2788ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hqHCGQOlALNOyXTa4dboA.png"/></div></div></figure><p id="0479" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据官方文档——RxJS是一个库，用于通过使用可观察序列来编写异步和基于事件的程序。</p><p id="5989" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">执行搜索输入时最常用的操作符之一是去抖时间和节流时间，这两个操作符的用法有所不同。</p><p id="c076" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们深入研究一下这些操作符。</p><p id="db91" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据官方定义:</p><p id="214e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">反跳时间:仅在特定时间间隔过去后，在没有其他源发射的情况下，从源可观测值发射一个值。</strong></p><p id="888d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">去抖动时间的一个经典例子是<strong class="kd iu">提前键入/自动完成</strong>。</p><p id="1e76" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">去抖时间的大理石图如下所示:</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi kz"><img src="../Images/06d710dcb621c76a32e3e4a900c78128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LegfUn1G2594ENmxFHIlRw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来自RxJs文档</figcaption></figure><p id="e055" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们观察大理石图，去抖时间等待是20毫秒。如果用户在20毫秒内执行任何值搜索，只有在去抖时间过去后，才会捕获搜索值。如果我们观察，值“b”没有被搜索值捕获。</p><p id="97ad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们看一个去抖时间的实际例子。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi li"><img src="../Images/efb4682fbf9e1adf2977e996ce24e0a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EMWvy1e0eJnO1sJiGp7GaQ.png"/></div></div></figure><p id="67b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们已经使用ngmodel创建了一个html输入标签，因为上面的代码是不言自明的。</p><p id="3daa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们关注它的实现，如下所示:</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lj"><img src="../Images/77bea1e5c000090779f6ccb1262e37c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W7ByGoDtEdf6JehvKFfPzg.png"/></div></div></figure><p id="0cfa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据上面的信息，我们使用了wikipedia搜索API，并且在构造函数方法上，我们调用了fetchdata方法，将输入值搜索的参数传递给它。</p><p id="1837" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">不用担心图像中的其他操作符，如switchMap、distinctUntilChanged。我们主要关注去抖时间。</p><p id="af80" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们尝试运行上面的例子，我们会发现在4000毫秒过去后，将作为搜索参数传递的最新值。</p><p id="309f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">仅供参考，搜索值将如下所示:</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lk"><img src="../Images/af4b2d22b7214bcbdcb13557153be363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C1Co7Z4fRbVbDQzFa1wl-g.png"/></div></div></figure><p id="d8eb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请随意摆弄代码，以便更好地使用去抖时间操作符。</p><p id="bd87" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，让我们看看同一个例子中的第二个操作符throttleTime。我们只需将去抖时间更新为throttleTime来观察行为。</p><p id="c24d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据官方文件。</p><p id="557d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> throttleTime:从源可观测值发出一个值，然后忽略后续源值</strong> <code class="fe ll lm ln lo b"><strong class="kd iu">duration</strong></code> <strong class="kd iu">毫秒，然后重复这个过程。</strong></p><p id="c87d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们试图揭开上述定义的神秘面纱，我们将看到发出的值将被捕获，然后它会延迟已提供的时间量。一旦时间过去，它将再次开始捕获后续值，并且该过程继续。</p><p id="552b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，让我们根据RxJS文档观察throttleTime的大理石图。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lp"><img src="../Images/628218526eedba1069cf3f741de091b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oK7MjWVpDnpdo2M1pY6cqA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来自RxJS文档</figcaption></figure><p id="84af" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">尝试观察弹球图，首先发出的值是“a”，然后是throttleTime(假设20)，值“x”被忽略，一旦时间过去，下一个被捕获的值是“y”，类似地，该过程继续。</p><p id="58ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最可行的使用throttleTime的方法是<strong class="kd iu">按钮点击率或者双击，如果用户多次点击按钮的话。</strong></p><p id="0983" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">总的来说，当我们试图限制顺序发生的事件数量时，throttleTime更有意义。</p><p id="5b40" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们来看看它的实现。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lq"><img src="../Images/964fd522138cc2c4b87846a23007f569.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qY6qkcGq_hibIocxoKdx7g.png"/></div></div></figure><p id="39fc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如已经解释过的throttleTime，我们将在执行上面这段代码后观察到，我们将看到1个事件已经通过，<code class="fe ll lm ln lo b">throttleTime</code>将允许事件在4000ms后再次通过。但仅适用于4000毫秒后创建的事件。这意味着当用户在4000毫秒内输入<code class="fe ll lm ln lo b">ro</code>时，建议将只代表返回值<code class="fe ll lm ln lo b">r</code>。当用户键入<code class="fe ll lm ln lo b">m</code>时，它将搜索值<code class="fe ll lm ln lo b">rom</code>。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lr"><img src="../Images/c5b85b913df2ac7eacdd965ae87c5108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NODUfBw4XJBPKyIzi5T_BA.png"/></div></div></figure><p id="193d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们观察上面的图表，用户已经输入了搜索值“ro ”,但是传递的值只有“r ”,这意味着发生的第一个事件的值为“r ”,下一个事件将在4000毫秒后执行。因此，有4000毫秒的延迟，下一个事件中的值将被搜索为“rom”。请参见下图:</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ls"><img src="../Images/5172a76f72f215be373b82a7d6ef66b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BsW8g3xhtE45El-6ufNOCA.png"/></div></div></figure><p id="36c0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些操作符最常用的区域如下:</p><p id="6652" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">去抖时间:</strong></p><ol class=""><li id="ab11" class="lt lu it kd b ke kf ki kj km lv kq lw ku lx ky ly lz ma mb bi translated"><strong class="kd iu">自动完成</strong></li><li id="6ff9" class="lt lu it kd b ke mc ki md km me kq mf ku mg ky ly lz ma mb bi translated"><strong class="kd iu">提前打字</strong></li></ol><p id="f62d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">节流时间:</strong></p><ol class=""><li id="9df6" class="lt lu it kd b ke kf ki kj km lv kq lw ku lx ky ly lz ma mb bi translated"><strong class="kd iu">限制点击率</strong></li><li id="0480" class="lt lu it kd b ke mc ki md km me kq mf ku mg ky ly lz ma mb bi translated"><strong class="kd iu">双击</strong></li></ol><p id="6ccd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我希望这篇文章对RxJS操作符有所了解。</p><p id="52bc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">快乐编码。不断学习。继续探索。😊</p></div></div>    
</body>
</html>