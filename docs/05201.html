<html>
<head>
<title>Plotting USGS Earthquake Data with Folium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Folium绘制USGS地震数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/plotting-usgs-earthquake-data-with-folium-8f11ddc21950?source=collection_archive---------3-----------------------#2020-08-11">https://levelup.gitconnected.com/plotting-usgs-earthquake-data-with-folium-8f11ddc21950?source=collection_archive---------3-----------------------#2020-08-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="97b1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python中的叶数据绘图示例</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/af4280eb26976b5fc433596cf1ce1759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sw2GeIpAlA9iTCzSRaKmWQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">最终地图</figcaption></figure><p id="0dc6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">美国地质调查局(USGS)提供的众多服务之一是监测和跟踪世界范围内的地震事件。我最近偶然发现了他们在下面网站上提供的地震数据集。</p><div class="lr ls gp gr lt lu"><a href="https://earthquake.usgs.gov/earthquakes/feed/v1.0/csv.php" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">地震数据集</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">全球地震数据的CSV文件。提供从5分钟到上个月的实时更新数据。</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">earthquake.usgs.gov</p></div></div><div class="md l"><div class="me l mf mg mh md mi kp lu"/></div></div></a></div><p id="e73b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该网站有数据馈送，包含过去一小时、一天、一周或一个月内每一次重大地震的“实时”csv数据。数据每分钟更新一次，包含震级、纬度/经度、深度和其他地震描述符。</p><p id="eab9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然有很多地震可视化，我认为这将是一个有趣的练习，看看哪些可以很容易地从原始数据中创建出来。在这个项目中，我们将用熊猫和叶子来绘制世界范围内的每一次地震。我们还会用geoJSON添加一些板块边界，只是为了好玩。</p><h1 id="db1e" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">导入我们的数据</h1><p id="adea" class="pw-post-body-paragraph kv kw iq kx b ky nb jr la lb nc ju ld le nd lg lh li ne lk ll lm nf lo lp lq ij bi translated">我将使用位于以下URL的数据馈送。</p><p id="455d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae ng" href="https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_hour.csv" rel="noopener ugc nofollow" target="_blank">https://seismic . USGS . gov/seismics/feed/v 1.0/summary/2.5 _ month . CSV</a></p><p id="6ac9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是一个csv格式的文件的直接链接，其中包含了上个月世界范围内所有大于2.5级的地震。我鼓励你尝试其他的数据源，但是我发现当你包括较小的地震时，数据集的大小真的膨胀了。</p><p id="c45a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下面的代码中，我们导入我们的库，并使用pandas.read_csv()函数直接从URL创建DataFrame对象。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/f421ce6d8c387f6eef82bb241712584b.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*E2r4qcqxDAuz94L-IUn10w.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">地震数据框架中的可用列</figcaption></figure><p id="8919" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">美国地质勘探局网站上对数据列的描述有详细记录。我们的项目的<strong class="kx ir">相关列将是:纬度、经度和mag(地震的震级)。所有都存储为浮动对象，不需要预处理。感谢美国地质调查局保持这些数据集的干净和用户友好。</strong></p><h1 id="c23c" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">用叶子制作底图</h1><p id="8e66" class="pw-post-body-paragraph kv kw iq kx b ky nb jr la lb nc ju ld le nd lg lh li ne lk ll lm nf lo lp lq ij bi translated">我们将从使用下面的代码制作一个简单的地图开始。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="78e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们选择了一个lat/long值<strong class="kx ir"> (0，0) </strong>，因为我们正在绘制整个世界。缩放值为2对我在openstreetmap 中查看整个地球很有效。我得到的earthquakes.html文件看起来是这样的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/263b11dd43c5350b7e7737f29190d8ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Hfgb93FSd8BUyuaAVD5qQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">基本世界地图</figcaption></figure><h1 id="a91e" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">使用叶形圆添加地震数据</h1><p id="50ac" class="pw-post-body-paragraph kv kw iq kx b ky nb jr la lb nc ju ld le nd lg lh li ne lk ll lm nf lo lp lq ij bi translated">现在我们有了一个工作底图，让我们来绘制我们的地震。我们将使用叶的圆形物体来代表每一次地震。首先，我们将使所有的地震大小相同。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5780" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的代码中，我们遍历了数据帧中的每个地震，在那个位置创建了一个Circle对象，并使用add_to()方法将其添加到我的地图中。我们最终得到了一张已经令人印象深刻的地图，显示了过去一个月中所有重大地震。数据是不断变化的，所以你的尝试可能看起来不同。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/65049738f85a5cb45ecf2f60402b3a60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D07MgVi3keyC-kYxBFpeQ.png"/></div></div></figure><h1 id="ba19" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">可视化地震震级</h1><p id="772f" class="pw-post-body-paragraph kv kw iq kx b ky nb jr la lb nc ju ld le nd lg lh li ne lk ll lm nf lo lp lq ij bi translated">为了给我们一个快速直观的震级表示，我选择根据地震的大小改变每个圆圈的大小。(或者，您可以尝试色彩图或热图)</p><p id="0942" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在最后一张地图上，我用10作为每个圆圈的半径，我们看到每个地震用一个蓝点代表。圆形对象的半径在地图上以米为单位显示，因此当您在交互式地图上一直放大时，每个圆形标记都显示为一个10米的圆环。</p><p id="2c02" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将使半径成为地震震级的函数。大地震将由大半径的圆圈标记来表示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="2273" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我选择将我的半径设置为星等的50，000倍。一场4.0级的地震会在我的地图上显示为半径200，000米或200公里。这个值对我来说是正确的，但是您当然可以更改它，尤其是在绘制区域数据时。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/15afae06de828cb45b8c2e1f78686b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_BjSPXjYMhcO88wmtIKivw.png"/></div></div></figure><p id="8292" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们可以清楚地看到绘制的地震的相对大小，尽管我们在格式上还有一些工作要做。</p><h1 id="3492" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">让它变漂亮</h1><p id="14bd" class="pw-post-body-paragraph kv kw iq kx b ky nb jr la lb nc ju ld le nd lg lh li ne lk ll lm nf lo lp lq ij bi translated">现在，只需很少的编码，地图就可以正常工作了。我们现在可以使用Circle对象的关键字参数来使它们更有吸引力。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="d75d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这一次，我们在Circle对象中指定了五个新的关键字参数(weight、color、opacity、fill_color和fill_opacity)。我们现在看到多个地震一个接一个。除了代表震级的相对大小之外，暗红色现在代表热点(多个地震)，并给它一个热图效果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/8692d74d0f25d66afbc186e00caa91f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZPTL1JjqB4EDwhvqB_p8Sg.png"/></div></div></figure><h1 id="8955" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">使用GeoJSON添加构造板块</h1><p id="fa8f" class="pw-post-body-paragraph kv kw iq kx b ky nb jr la lb nc ju ld le nd lg lh li ne lk ll lm nf lo lp lq ij bi translated">当我们查看生成的地图时，我们看到了环太平洋“火环”的可视化。我立即想到将实际的板块边界作为地图的一部分。</p><p id="2c5f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在谷歌上快速搜索后，我找到了github上的这个文件，其中包含以geoJSON格式存储的构造边界多边形。</p><div class="lr ls gp gr lt lu"><a href="https://github.com/fraxen/tectonicplates/blob/master/GeoJSON/PB2002_boundaries.json" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">fraxen/构造板块</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">permalink dissolve GitHub是超过5000万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">github.com</p></div></div><div class="md l"><div class="np l mf mg mh md mi kp lu"/></div></div></a></div><p id="c42f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">GeoJSON是我个人最喜欢的形状文件类型，但你也可以使用其他形状文件。geoJSON格式具有作为JSON文件工作的优势，如果需要，可以像Python中的字典一样处理。</p><p id="f3ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面的代码显示了follow如何轻松地处理GeoJson文件来添加地图覆盖。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="9e76" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">GeoJson对象被直接添加到我们刚刚创建的地图中。重新保存地图会产生以下结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/af4280eb26976b5fc433596cf1ce1759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sw2GeIpAlA9iTCzSRaKmWQ.png"/></div></div></figure><p id="8c58" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">地图结果与您预期的完全一样。地震被整齐地放置在我们构造板块的边界上，就像我中学科学课本上的一样。</p><h1 id="859b" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">更进一步</h1><p id="ec1e" class="pw-post-body-paragraph kv kw iq kx b ky nb jr la lb nc ju ld le nd lg lh li ne lk ll lm nf lo lp lq ij bi translated">现在我们已经有了一个吸引人的地震地图，你可能想做一些额外的工作来创造一些更令人惊奇的东西。</p><p id="21e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">考虑制作一个带有震级、时间范围和位置控件的web应用程序。在下面的照片中，我们看到了过去七天旧金山发生的所有地震。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9ed84580c3d02e09d96070794c56bce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*bG7DDuViLNaB8eK86OLV3g.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">思科7天地图</figcaption></figure><p id="cf45" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">考虑一下follow Circle类的重要格式选项。通过弹出的kwarg，你可以为每一次地震插入html标签。然后你可以添加世界范围内每一次地震的震级和描述。下图是显示'<strong class="kx ir"> place </strong>'列中的字符串的弹出窗口示例</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/7608749f54ca6e952337fcb7bc47ec5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*di-ZPO94Hdi7aEQDvPDktQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">弹出窗口的示例</figcaption></figure><p id="5623" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">看看你能用这些神奇的数据集创造出什么。如果你做了漂亮的东西，让我知道。祝你好运！</p></div></div>    
</body>
</html>