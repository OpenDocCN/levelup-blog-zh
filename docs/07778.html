<html>
<head>
<title>Untangling the service mesh</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解开服务网格</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/untangling-the-service-mesh-24797e29eb92?source=collection_archive---------3-----------------------#2021-03-09">https://levelup.gitconnected.com/untangling-the-service-mesh-24797e29eb92?source=collection_archive---------3-----------------------#2021-03-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="eba7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">服务网格在社区中已经存在很长时间了，许多开发人员已经采用了它。如果你是那些希望使用它的人之一，并且想知道到底什么是服务网格，哪个是适合你的环境的正确选择，那么这个博客就是为你准备的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/757a85e6a2cd09b5368aaed82a719bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kh5k8LKLoGsuHUsj5B7abQ.jpeg"/></div></div></figure><p id="ca24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">服务网格管理应用程序不同组件之间的网络流量。它是一个专用的基础设施层，构建的唯一目的是将服务到服务的通信逻辑从应用程序中分离出来并进行抽象。这提供了单点访问、管理和治理的便利性。</p><h1 id="47cf" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">它实际上做什么？</h1><p id="1746" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">为了管理网络，每个通信都通过与应用微服务一起运行的侧车来代理。这将应用程序代码从网络逻辑中分离出来，并允许开发人员专注于他们的关键业务逻辑。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/4a0b3bdbfce13dd6bd8a62375ae453c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*GR5ZrDdSQ7rvbudmTuVKPg.png"/></div></figure><p id="1028" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如上所示，通信现在将被运行在同一pod中的sidecar代理容器截获，并将被另一端的类似sidecar接收。</p><h1 id="58e7" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">那我为什么要用一个呢？</h1><p id="e263" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">除了从网络代码中分离应用程序代码的明显好处之外，服务网格还解决了其他一些问题。随着服务数量的增长，网络会变得相当复杂。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mb"><img src="../Images/4caf072b17643d40a7fa34d8213486df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*_gtO1Scbxxy0tfrv5VI-KQ.png"/></div></div></figure><p id="6719" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，跟踪和调试任何失败都是痛苦的。服务网格通过<strong class="jp ir">跟踪和收集与服务间通信相关的指标</strong>来解决这个问题。此外，服务网格可以将失败的请求重新路由到可服务的容器。</p><p id="1d06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除此之外，服务网格是<strong class="jp ir">高度可伸缩的</strong>，且是可能随时间增长的应用程序的最佳选择。在不断增长的应用程序中，服务网格将消除为适应新服务而更改旧组件的业务代码的需要。旧组件将简单地发现新的加入者并开始路由。</p><p id="de59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，服务网格也满足安全性的要求。通过<strong class="jp ir">实现策略</strong>，服务网格可以允许和拒绝从一个服务到另一个服务的流量。此外，这些策略还可用于将部分或全部流量从一项服务转移到另一项服务，从而能够执行蓝绿色部署，或通过完全切断可服务服务器的部分流量来执行弹性测试。</p><h1 id="ec6c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">市场上有哪些选择？</h1><p id="6daa" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在Kubernetes市场，三个主要竞争者是<a class="ae mc" href="https://istio.io" rel="noopener ugc nofollow" target="_blank"> Istio </a>、<a class="ae mc" href="https://linkerd.io" rel="noopener ugc nofollow" target="_blank"> Linkerd </a>和<a class="ae mc" href="https://www.consul.io" rel="noopener ugc nofollow" target="_blank"> Consul </a>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi md"><img src="../Images/eebdb96b66d7b5b0152aa44a97e8b07f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NjvKHxJA_faJ3KImmaDCog.png"/></div></div></figure><p id="ac58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于运行代理服务和应用程序的核心概念保持不变，这些工具在架构上略有不同。这三者都支持主要的通信协议，包括TCP、HTTP和gRPC。它们还支持相互TLS，以便与本机证书管理进行安全通信。</p><p id="6bc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么这里到底有什么不同呢？</p><p id="170c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Consul要求在所有节点上安装一个节点代理，用于对节点和在该节点上运行的服务执行健康检查。Linkerd和Istio没有任何这样的要求。</p><p id="0cb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Linkerd是所有产品中最轻的，也是最容易安装的，但是它也有缺点，比如流量管理、弹性测试和分布式跟踪方面的功能更少。此外，它也不适用于多集群配置或虚拟机托管服务。因此，在使用Kubernetes专用的<strong class="jp ir">时，在一个简单的架构中使用Linkerd。</strong></p><p id="6303" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在来看另外两个竞争者，它们既可以在Kubernetes上工作，也可以在虚拟机上工作，还可以在多集群配置中工作。简单地说，如果你正在寻找功能，那么去Istio。它是最老的(也是最成熟的)一个，并且由于其<strong class="jp ir">过多的特性和不可否认的灵活性</strong>而在社区中被广泛接受。安装Istio的方法有很多种，你可以在他们的安装指南<a class="ae mc" href="https://istio.io/latest/docs/setup/install/" rel="noopener ugc nofollow" target="_blank">这里</a>找到它们。</p><p id="dac2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，如果你正在寻找<strong class="jp ir">设置和管理的简单性</strong>并且可以接受Consul的<strong class="jp ir">小一点的特性列表</strong>，那么这就是方法。要在您的环境中设置Consul，请参考此处的<a class="ae mc" href="https://www.consul.io/docs/install" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi me"><img src="../Images/1d36e54d7381ae2fe381f24602cfe6ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5AM7ECcTiePX2SKMQQ9c7g.png"/></div></div></figure><h1 id="6dac" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">离别赠言</h1><p id="916b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">希望本指南能帮助您在自己的环境中开始使用服务网格。请注意，服务网格是一个至关重要的组件，它将处理应用程序的一个非常动态的方面。这意味着您的需求会随着您的发展而变化，您的服务网格首选项也是如此。</p></div></div>    
</body>
</html>