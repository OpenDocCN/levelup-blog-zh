<html>
<head>
<title>How To Get All Stock Symbols</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何获取所有股票符号</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-get-all-stock-symbols-a73925c16a1b?source=collection_archive---------0-----------------------#2021-01-29">https://levelup.gitconnected.com/how-to-get-all-stock-symbols-a73925c16a1b?source=collection_archive---------0-----------------------#2021-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c38" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">没有真正尝试…</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0ea0d8334311ca8440fcfa8749dde6a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LWWB2JmAmtDQH3D8xwilIA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@m_b_m?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> M. B. M. </a>在<a class="ae kv" href="https://unsplash.com/s/photos/graphs?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="b4f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我退休了，我有很多空闲时间。对股票市场的兴趣现在占据了我的一些时间。学习股票的第一步是知道有哪些股票。股票代码列表在很多地方都可以以. csv格式下载，但我喜欢快速高效。我写这个脚本就是为了做到这一点。</p><p id="5306" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，导入语句。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="40dd" class="lx ly iq lt b gy lz ma l mb mc">import pandas as pd<br/>from yahoo_fin import stock_info as si</span></pre><p id="2d5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">美国有三大股票交易所。它们是道琼斯、纳斯达克和标准普尔500。还有第四类符号叫做“其他”。我们下载每一类列表来分离熊猫数据帧。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="b614" class="lx ly iq lt b gy lz ma l mb mc">df1 = pd.DataFrame<em class="md">( </em>si.tickers_sp500<em class="md">() )<br/></em>df2 = pd.DataFrame<em class="md">( </em>si.tickers_nasdaq<em class="md">() )<br/></em>df3 = pd.DataFrame<em class="md">( </em>si.tickers_dow<em class="md">() )<br/></em>df4 = pd.DataFrame<em class="md">( </em>si.tickers_other<em class="md">() )</em></span></pre><p id="3891" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们将每个数据帧转换成一个列表，然后转换成一个集合。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="f737" class="lx ly iq lt b gy lz ma l mb mc">sym1 = set<em class="md">( </em>symbol for symbol in df1<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )<br/></em>sym2 = set<em class="md">( </em>symbol for symbol in df2<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )<br/></em>sym3 = set<em class="md">( </em>symbol for symbol in df3<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )<br/></em>sym4 = set<em class="md">( </em>symbol for symbol in df4<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )</em></span></pre><p id="35be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">股票代码可以在多个交易所上市。我们把这四组合二为一。因为是集合，所以不会有重复的符号。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="0883" class="lx ly iq lt b gy lz ma l mb mc">symbols = set.union<em class="md">( </em>sym1, sym2, sym3, sym4 <em class="md">)</em></span></pre><p id="a09b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大多数符号的长度不超过四个字母，例如:MSFT代表微软。有些符号有第五个字母。一个<a class="ae kv" href="https://www.investopedia.com/ask/answers/06/nasdaqfifthletter.asp" rel="noopener ugc nofollow" target="_blank">第五个字母</a>大多被添加到在某些交易要求中拖欠的股票中。我们将确定删除其中的四个后缀。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="595a" class="lx ly iq lt b gy lz ma l mb mc">my_list = <em class="md">[</em>'W', 'R', 'P', 'Q'<em class="md">]</em></span></pre><p id="5633" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">w表示有未兑现的认股权证。我们不想要那些。</p><p id="0285" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">r表示存在某种“权利”问题。再说一遍，不被通缉。</p><p id="667d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">p表示“第一优先发行”。优先股是一个独立的实体。</p><p id="ca24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">q代表破产。我们也不想要这些。</p><p id="eafc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我想消除这些符号的原因是它们需要很长时间，然后在下载后续数据时返回错误。</p><p id="db9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要启动两套系统。存储集和删除集。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="187e" class="lx ly iq lt b gy lz ma l mb mc">del_set = set<em class="md">()<br/></em>sav_set = set<em class="md">()</em></span></pre><p id="ea6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们找到长度超过四个字符的符号，并将它们的最后一个字母放在<em class="md"> my_list </em>中。当找到时，它们被添加到<em class="md"> del_set </em>。所有其他符号被添加到<em class="md"> sav_set </em>中。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="8992" class="lx ly iq lt b gy lz ma l mb mc">for symbol in symbols:<br/>    if len<em class="md">( </em>symbol <em class="md">) </em>&gt; 4 and symbol<em class="md">[</em>-1<em class="md">] </em>in my_list:<br/>        del_set.add<em class="md">( </em>symbol <em class="md">)</em><br/>    else:<br/>        sav_set.add<em class="md">( </em>symbol <em class="md">)</em></span></pre><p id="a91d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们打印结果。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="bab0" class="lx ly iq lt b gy lz ma l mb mc">print<em class="md">( </em>f'Removed <em class="md">{</em>len<em class="md">( </em>del_set <em class="md">)}</em> unqualified stock symbols...' <em class="md">)<br/></em>print<em class="md">( </em>f'There are <em class="md">{</em>len<em class="md">( </em>sav_set <em class="md">)}</em> qualified stock symbols...' <em class="md">)</em></span></pre><p id="f360" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是输出。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="3b8e" class="lx ly iq lt b gy lz ma l mb mc">Removed 445 unqualified stock symbols…<br/>There are 9193 qualified stock symbols…</span><span id="de1d" class="lx ly iq lt b gy me ma l mb mc">Process finished with exit code 0</span></pre><p id="0950" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一个完整的股票代码列表，可以开始我们的数据处理之旅了。您可能希望将<em class="md"> sav_set </em>保存为您喜欢的数据库或存储格式。</p><p id="afaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑每月5美元订阅Medium。作为会员，你可以无限制地访问媒体上的故事。如果你用我的<a class="ae kv" href="https://zenndogg-52643-medium.com/membership" rel="noopener ugc nofollow">链接</a>注册，我会赚一小笔佣金。</p><p id="4ddf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面提供了整个脚本。愉快的探索。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="1df3" class="lx ly iq lt b gy lz ma l mb mc">import pandas as pd<br/>from yahoo_fin import stock_info as si<br/><br/><br/># gather stock symbols from major US exchanges<br/>df1 = pd.DataFrame<em class="md">( </em>si.tickers_sp500<em class="md">() )<br/></em>df2 = pd.DataFrame<em class="md">( </em>si.tickers_nasdaq<em class="md">() )<br/></em>df3 = pd.DataFrame<em class="md">( </em>si.tickers_dow<em class="md">() )<br/></em>df4 = pd.DataFrame<em class="md">( </em>si.tickers_other<em class="md">() )<br/><br/></em># convert DataFrame to list, then to sets<br/>sym1 = set<em class="md">( </em>symbol for symbol in df1<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )<br/></em>sym2 = set<em class="md">( </em>symbol for symbol in df2<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )<br/></em>sym3 = set<em class="md">( </em>symbol for symbol in df3<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )<br/></em>sym4 = set<em class="md">( </em>symbol for symbol in df4<em class="md">[</em>0<em class="md">]</em>.values.tolist<em class="md">() )<br/><br/></em># join the 4 sets into one. Because it's a set, there will be no duplicate symbols<br/>symbols = set.union<em class="md">( </em>sym1, sym2, sym3, sym4 <em class="md">)<br/><br/></em># Some stocks are 5 characters. Those stocks with the suffixes listed below are not of interest.<br/>my_list = <em class="md">[</em>'W', 'R', 'P', 'Q'<em class="md">]<br/></em>del_set = set<em class="md">()<br/></em>sav_set = set<em class="md">()<br/><br/></em>for symbol in symbols:<br/>    if len<em class="md">( </em>symbol <em class="md">) </em>&gt; 4 and symbol<em class="md">[</em>-1<em class="md">] </em>in my_list:<br/>        del_set.add<em class="md">( </em>symbol )<br/>    else:<br/>        sav_set.add<em class="md">( </em>symbol <em class="md">)</em><br/><br/>print<em class="md">( </em>f'Removed <em class="md">{</em>len<em class="md">( </em>del_set <em class="md">)}</em> unqualified stock symbols...' <em class="md">)<br/></em>print<em class="md">( </em>f'There are <em class="md">{</em>len<em class="md">( </em>sav_set <em class="md">)}</em> qualified stock symbols...' <em class="md">)</em></span></pre></div></div>    
</body>
</html>