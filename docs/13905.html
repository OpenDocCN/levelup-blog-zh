<html>
<head>
<title>Cracking Your Encryption Is Damn Simple</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">破解你的加密非常简单</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/cracking-your-encryption-is-damn-simple-e4b9ce89c142?source=collection_archive---------0-----------------------#2022-10-17">https://levelup.gitconnected.com/cracking-your-encryption-is-damn-simple-e4b9ce89c142?source=collection_archive---------0-----------------------#2022-10-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4e70" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">专业地加密您的数据。否则有人会偷走它。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ef3146e651f5376222df03fcff920d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3sGZ_agHQzh6nD6D3JjfjQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图片由作者生成，DALL-E .归作者所有。</figcaption></figure><p id="e392" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几天前，有人问我是否有可能解密CSV文件中一些加密列的内容。加密的字符串看起来有点像<code class="fe lu lv lw lx b">doPRULpnkoqjY5bKy1DBqI+AyLJOfYU=</code>。</p><p id="b222" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我的处置下，我有一堆加密样本。我还有一个纯文本样本，以及相应的加密结果。那是(相当于)<code class="fe lu lv lw lx b">please, hack me!</code>的东西。加密到<code class="fe lu lv lw lx b">ncjJkcysWDXLoZDHhJ2+aA==</code></p><p id="ed52" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我破解了。以下是方法。</p><h1 id="acb2" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">关心你的加密！</h1><p id="4453" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我不是安全或密码学专家。我用非常基本的密码学概念和一点运气制作了它。</p><p id="a132" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这篇文章应该提醒我们所有人，当我们的数据没有得到专业的保护时，有多少人可能会访问我们的数据。</p><h1 id="4440" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">什么算法？</h1><p id="bd78" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">重要的事情先来。我们需要确定使用了哪种加密算法。对于一个经验丰富的程序员来说，发现一个<a class="ae mv" href="https://www.techopedia.com/definition/27209/base64" rel="noopener ugc nofollow" target="_blank"> base64编码</a>是非常容易的。</p><h2 id="c9fc" class="mw lz it bd ma mx my dn me mz na dp mi lh nb nc mk ll nd ne mm lp nf ng mo nh bi translated">Base64</h2><p id="1b55" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">对于不太老练的人来说:字符串末尾的<code class="fe lu lv lw lx b">=</code>是base64编码字符串的典型标志。<a class="ae mv" href="https://www.baeldung.com/java-base64-encode-and-decode#2-java-8-base64-encoding-without-padding" rel="noopener ugc nofollow" target="_blank">是填充</a>，结尾可以有0、1或者2个<code class="fe lu lv lw lx b">=</code> <strong class="la iu">。</strong></p><p id="f6fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，即使有0个<code class="fe lu lv lw lx b">=</code>，你也可以发现一个base64，因为它们看起来像一个<a class="ae mv" href="https://en.wikipedia.org/wiki/Base64#Base64_table_from_RFC_4648" rel="noopener ugc nofollow" target="_blank">有限字符集</a>的随机布局。存在一些<a class="ae mv" href="https://en.wikipedia.org/wiki/Base64#Variants_summary_table" rel="noopener ugc nofollow" target="_blank">字符集变体</a>。老实说，12年来我从未遇到过变异的样本。</p><p id="1290" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后让我们使用<a class="ae mv" href="https://www.base64decode.org/" rel="noopener ugc nofollow" target="_blank">base64decode.org</a>来解码我们的字符串。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/87357f8d7938c9467a6f622373104146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RVF1Tjnfj3Vqi3r4I9AUYA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">从base64输入字符串解码(截图来自<a class="ae mv" href="https://www.base64decode.org/" rel="noopener ugc nofollow" target="_blank">base64decode.org</a>)</figcaption></figure><p id="4eae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">结果看起来很奇怪，原因有二。</p><p id="f891" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一:<strong class="la iu">不可读</strong>。但这并不奇怪。即使我的祖母看不懂，Base64也是一种编码，不是加密😅。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae mv" href="https://giphy.com/gifs/Originals-wtf-what-l0MYQ5jcwegmAtXuU" rel="noopener ugc nofollow" target="_blank"> Giphy </a></figcaption></figure><p id="0d24" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第二也是最重要的。<strong class="la iu">比输入</strong>短。base64编码的结果总是大于其输入。特别是:</p><pre class="kj kk kl km gt nl lx nm nn aw no bi"><span id="6cc5" class="mw lz it lx b gy np nq l nr ns">output_size=((input_size + padding) / 3) * 4</span></pre><p id="dd77" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这表明解码的内容是二进制的，而不是文本的。</p><p id="3a45" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要从整体上看待它。让我们试试<a class="ae mv" href="https://cryptii.com/" rel="noopener ugc nofollow" target="_blank">cryptii.com</a>，配置成以十六进制格式输出字节。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/2e862abb2f418d41c7ac444dc99f8500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sym2ooOL9M9eQXVFVPicXg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">输入字符串解码从base64到字节(截图来自<a class="ae mv" href="https://cryptii.com/" rel="noopener ugc nofollow" target="_blank">cryptii.com</a>)</figcaption></figure><p id="f290" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<a class="ae mv" href="https://en.wikipedia.org/wiki/Hexadecimal" rel="noopener ugc nofollow" target="_blank">十六进制基数</a>中，输出为<code class="fe lu lv lw lx b">9d c8 c9 91 cc ac 58 35 cb a1 90 c7 84 9d be 68</code>。它翻译成基数为10的<code class="fe lu lv lw lx b">157 200 201 145 204 172 88 53 203 161 144 199 132 157 190 104</code>。</p><p id="020b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们来分析一下。第一个观察结果是<strong class="la iu">与输入</strong>的长度相同:16个字节。这让我们排除了一些最常见的加密算法，如<a class="ae mv" href="https://stackoverflow.com/questions/3283787/size-of-data-after-aes-cbc-and-aes-ecb-encryption" rel="noopener ugc nofollow" target="_blank"> AES </a>或<a class="ae mv" href="https://stackoverflow.com/a/25699277/636400" rel="noopener ugc nofollow" target="_blank"> RSA </a>。在最常见的实现中，它们的输出与输入的长度不同。</p><p id="846d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也很有可能没有<a class="ae mv" href="https://crypto.stackexchange.com/questions/1776/what-is-a-cryptographic-salt" rel="noopener ugc nofollow" target="_blank">盐</a>，除非我们假设输出也是zipped。采用<a class="ae mv" href="https://en.wikipedia.org/wiki/Occam%27s_razor" rel="noopener ugc nofollow" target="_blank">奥卡姆剃刀</a>原理，让我们排除拉链。</p><p id="3c58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上述考虑似乎为我们指明了定制加密算法的方向。</p><h1 id="2f09" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">自定义加密算法</h1><p id="aa5d" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">让我们试着利用这个理论。探索新事物的好方法是从最简单的案例开始。最幼稚的加密是<a class="ae mv" href="https://www.dcode.fr/caesar-cipher" rel="noopener ugc nofollow" target="_blank">凯撒密码</a>。</p><p id="4351" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果采用凯撒密码，那么两个相同的字符将加密成相同的数字。在我们的<code class="fe lu lv lw lx b">ple<strong class="la iu">a</strong>se, h<strong class="la iu">a</strong>ck me!</code>中，我们可以观察到<code class="fe lu lv lw lx b">a</code>字符在位置3和9(基于0)的重复。</p><p id="ae32" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">157 200 201 <strong class="la iu">145 </strong>204 172 88 53 203 <strong class="la iu">161</strong> 144 199 132 157 190 104</code></p><p id="4051" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看来凯撒密码不是这样的。<code class="fe lu lv lw lx b">145</code>在位置3<code class="fe lu lv lw lx b">161</code>在位置9。从这里怎么走？</p><p id="7423" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它可能改变了字母的位置，也可能通过随机的方式移动了位置……也许两者都有。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7f2313e63f1838d1f905c7b33744c697.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*9f-NosGRL7Ce7sUqrTC5Vw.jpeg"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者用<a class="ae mv" href="https://imgflip.com/memegenerator" rel="noopener ugc nofollow" target="_blank"> Imgflip </a>生成的图片</figcaption></figure><p id="7774" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们想象我们所知道的，寻找建议。打开一个高级的文本编辑器(如Notepad++或Visual Studio Code ),绘制出我们所知道的内容。</p><pre class="kj kk kl km gt nl lx nm nn aw no bi"><span id="ab2a" class="mw lz it lx b gy np nq l nr ns">157 200 201 145 204 172  88  53 203 161 144 199 132 157 190 104</span><span id="5bd2" class="mw lz it lx b gy nv nq l nr ns">  p   l   e   a   s   e   ,       h   a   c   k       m   e   !</span><span id="6df2" class="mw lz it lx b gy nv nq l nr ns">112 108 101  97 115 101  44  32 104  97  99 107  32 109 101  33</span></pre><p id="4b12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按顺序:编码字符串字节、纯文本字符串和纯文本字符串字节。</p><p id="99b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这样做的目的是目视检查任何类型的图案。例如查看编码的字节是否遵循与纯文本相同的顺序。但还是没有运气。</p><h1 id="8453" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">是时候编码了！</h1><p id="ae04" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我们必须提高一点我们分析中所考虑的复杂性。下一步是检查加密和纯文本的字节值之间的差异。</p><p id="b9d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们写一个脚本来计算它。我将在Deepnote 中使用<a class="ae mv" href="https://deepnote.com/workspace/luca-piccinelli-37f2-d1557232-c701-4528-93e2-7d7a65936144/project/hack-the-string-e1395044-b879-430f-bca7-891f2a43f068" rel="noopener ugc nofollow" target="_blank"> Python笔记本</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nk l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx nk l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nk l"/></div></figure><p id="d76f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后将差异作为新的一行添加到我们的编辑器中。(我的是VsCode)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/cd79cb3507e03d5aacaee360640c5e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jc9X4oygghpzRmT5Cpwe7w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">将我们已知的信息绘制成VsCode</figcaption></figure><p id="1252" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用高级文本编辑器的意义在于，当你选择一个文本时，它会突出显示同一文本的其他出现。</p><p id="4ee6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看起来我们找到了些东西。差异中有一个重复的方案。</p><p id="90ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们找到了加密密钥！这是一个长度为10的移位表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/b831ffb42c98da93e3f0e64769d22072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*5gcF_HNiJYZrVOjN663JZg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">轮班表</figcaption></figure><p id="c623" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“长度为10的移位表”意味着每10个字符，我们在表的相同位置添加一个值。第一个字符加上45，第二个字符加上92，直到第九个。然后重启:到第十个45，到第十一个92，等等…</p><h1 id="d6f9" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">解码算法</h1><p id="36da" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我们现在可以编写函数来解码所有加密的列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx nk l"/></div></figure><p id="a267" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按顺序:</p><ol class=""><li id="4e86" class="ob oc it la b lb lc le lf lh od ll oe lp of lt og oh oi oj bi translated">从base64解码</li><li id="12e4" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">将输出转换为列表</li><li id="7174" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">从字节值中减去表中的相应值</li><li id="e5a9" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">将列表转换回字符串</li></ol><h1 id="74eb" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">结论</h1><p id="b7c7" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">“怎么会有人猜到这张随机加密表？他们甚至不知道我正在使用的算法。”</p><p id="49a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这应该是实现本文所破解的加密的人的想法。不幸的是，事实是，几乎任何人，只要有非常基本的知识和一点时间(我花了大约4个小时)，就可以破解你的加密。</p><p id="4624" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想象一下专家能做什么。</p><p id="c104" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在选择如何加密应用程序中的数据时，要格外小心。始终使用专业的加密方法，并避免自制的解决方案。</p><h2 id="2364" class="mw lz it bd ma mx my dn me mz na dp mi lh nb nc mk ll nd ne mm lp nf ng mo nh bi translated">本可以阻止我破解钥匙的预防措施</h2><p id="f0ef" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">如果不能避免使用自定义加密，至少要多加小心。不费吹灰之力，就能让我更难破解这个钥匙。示例:</p><ul class=""><li id="c63f" class="ob oc it la b lb lc le lf lh od ll oe lp of lt op oh oi oj bi translated">如果移动台的长度更大。假设是100。我不会注意到重复计划。</li><li id="2d35" class="ob oc it la b lb ok le ol lh om ll on lp oo lt op oh oi oj bi translated">如果使用一个以上的换档表。根据单词的第一个字母来改变它是很容易的</li></ul><p id="026c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些预防措施不会阻止专业人士。但至少可以阻止像我这样的新手。</p><p id="1d97" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，你能猜出本文第一个例子<code class="fe lu lv lw lx b">doPRULpnkoqjY5bKy1DBqI+AyLJOfYU=</code>中加密了什么吗？</p><p id="4331" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请在评论中告诉我！</p></div></div>    
</body>
</html>