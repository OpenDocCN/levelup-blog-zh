<html>
<head>
<title>Rust with Visual Studio Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visual Studio代码Rust</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/rust-with-visual-studio-code-46404befed8?source=collection_archive---------0-----------------------#2020-10-12">https://levelup.gitconnected.com/rust-with-visual-studio-code-46404befed8?source=collection_archive---------0-----------------------#2020-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e346" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">简单的操作方法</h2></div><p id="f430" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> R </span> ust越来越受欢迎，在开发人员中被大量采用。这篇文章将帮助任何想在2020年使用Visual Studio代码(VS代码)开发Rust应用程序的人。</p><p id="5c54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我不是VIM和basic编辑器的忠实粉丝。多年来，我开始接触基本的文本编辑器，并很快适应了各种ide，因为它们有助于加快工作流程。今天我的偏好是IntelliJ和VS代码。</p><p id="2511" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章是关于配置VS代码来编写、构建和调试Rust应用程序的。外面有很多信息，我不认为这是最好的或者唯一的方法，但是它是大量依赖于官方文档的各种文章的融合，对我来说很有用。</p><p id="9245" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用两种不同的环境进行开发，一种是Macbook Pro，我用它来做最初的脚手架、便笺簿和概念验证，因为我喜欢在工作时在家里四处走动——在室内和室外工作，试图捕捉大自然的一些治愈能力😄。对于较大的后端项目，通常是后端服务器或交叉开发项目，我更喜欢在我的Linux机器上开发。</p><blockquote class="lk ll lm"><p id="64ba" class="kf kg ln kh b ki kj jr kk kl km ju kn lo kp kq kr lp kt ku kv lq kx ky kz la ij bi translated">本文是关于在MacOS环境下设置Visual Studio代码的。</p></blockquote><h1 id="9d93" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">防锈装置</h1><p id="992e" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">我推荐安装<em class="ln"> rustup </em>，因为它允许在不同版本的rust之间切换——对我来说很重要，因为我想为ARM处理器进行交叉编译。</p><p id="86e1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">官方笔记可以在这里找到:<a class="ae mo" href="https://www.rust-lang.org/tools/install" rel="noopener ugc nofollow" target="_blank">https://www.rust-lang.org/tools/install</a></p><h2 id="e572" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">使用brew安装rust。</h2><p id="125e" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated"><em class="ln">如果你的Mac上没有安装家酿软件，那么我建议你犒劳一下自己，去安装它——查看</em> <a class="ae mo" href="https://brew.sh" rel="noopener ugc nofollow" target="_blank"> <em class="ln">家酿软件</em> </a></p><p id="e016" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在终端的命令行提示符下:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="5fde" class="mp ls iq ng b gy nk nl l nm nn">❯ brew install rustup</span></pre><p id="6f06" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="ln">注意:</em> </strong> <em class="ln">如果rust已经安装，可以使用</em> <strong class="kh ir"> <em class="ln"> rustup更新</em> </strong> <em class="ln">进行更新。</em></p><h2 id="bbc8" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">安装编译器和包管理器。</h2><p id="1c6f" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">在终端的命令行提示符下:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e78d" class="mp ls iq ng b gy nk nl l nm nn">❯ rustup-init</span></pre><p id="60a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ln">您可以使用rustup self uninstall随时卸载，这些更改将被恢复。</em></p><p id="c9cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行完<code class="fe no np nq ng b">rustup-init</code>后，你会看到不同的选项——继续使用默认选项——选项1</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="1ff2" class="mp ls iq ng b gy nk nl l nm nn">1) Proceed with installation (default)</span></pre><h2 id="90a9" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">验证安装</h2><p id="6e29" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">在终端的命令行提示符下:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="644d" class="mp ls iq ng b gy nk nl l nm nn">❯ rustc — version<br/>rustc 1.46.0 (04488afe3 2020-08-24)</span></pre><p id="40c6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它应该返回带有版本号的<code class="fe no np nq ng b">rustc</code>。</p><p id="8afe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="ln">注意:</em> </strong> <em class="ln">您可能需要退出并重新加载终端以使路径更新生效。</em></p><h1 id="21ad" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">第一个你好世界项目</h1><h2 id="728c" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">安装VS代码</h2><p id="1efb" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">如果还没有安装，那么前往<a class="ae mo" href="https://code.visualstudio.com" rel="noopener ugc nofollow" target="_blank">https://code.visualstudio.com</a>安装VS代码。</p><blockquote class="lk ll lm"><p id="9592" class="kf kg ln kh b ki kj jr kk kl km ju kn lo kp kq kr lp kt ku kv lq kx ky kz la ij bi translated">如果您想通过执行<strong class="kh ir">代码</strong>从命令行启动VS代码，安装VS代码后，在Mac上使用<em class="iq"> Shift+Command+p </em>或在Linux上使用<em class="iq"> Shift+Control+p </em>打开命令面板，并搜索<em class="iq"> Shell命令:在路径选项中安装‘Code’</em>命令。</p></blockquote><h2 id="a899" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">设置与代码</h2><p id="6de9" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">Rust对VS代码官方网站的支持可以在这里找到:<a class="ae mo" href="https://marketplace.visualstudio.com/items?itemName=rust-lang.rust" rel="noopener ugc nofollow" target="_blank">https://marketplace.visualstudio.com/items?itemName=rust-lang.rust </a></p><p id="6cf7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了在VS代码中启用rust支持，我们将使用rust语言服务器(RLS)。</p><ul class=""><li id="aced" class="nr ns iq kh b ki kj kl km ko nt ks nu kw nv la nw nx ny nz bi translated">使用<em class="ln"> Shift+Command+p </em> as(或者Linux/Windows上的<em class="ln"> Control+p </em>打开命令面板，输入<code class="fe no np nq ng b">ext install rust-lang.rust</code>，按<em class="ln">进入</em>。</li></ul><p id="9828" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你按照上述步骤安装rust，那么你应该可以访问cargo，Rust的软件包管理器。为了检查安装，你可以在命令提示符下执行<em class="ln">货物版本</em>。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="a930" class="mp ls iq ng b gy nk nl l nm nn">❯ cargo --version<br/>cargo 1.46.0 (149022b1d 2020-07-17)</span></pre><h2 id="6f93" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">使用Cargo创建一个新项目。</h2><p id="eef7" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">使用cargo，Rust的包管理器，我们将创建一个简单的HelloWorld项目。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="53b1" class="mp ls iq ng b gy nk nl l nm nn">❯ mkdir -p ~/coding/rust<br/>❯ cd ~/coding/rust<br/>❯ cargo new HelloWorld<br/>Created binary (application) `HelloWorld` package</span></pre><ul class=""><li id="bef1" class="nr ns iq kh b ki kj kl km ko nt ks nu kw nv la nw nx ny nz bi translated">转到目录HelloWorld <code class="fe no np nq ng b">cd HelloWorld</code></li><li id="eb16" class="nr ns iq kh b ki oa kl ob ko oc ks od kw oe la nw nx ny nz bi translated">通过执行<code class="fe no np nq ng b">code .</code>从命令行启动VS代码</li></ul><p id="94f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在项目文件夹中，您应该会看到<em class="ln"> src </em>和<em class="ln"> Cargo.toml </em>条目</p><p id="457f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开src文件夹下的rust文件<em class="ln"> main.rs </em>，系统会提示您安装rust extension——点击<strong class="kh ir"> Yes </strong>继续。</p><p id="c950" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成后，VS代码现在应该显示消息<br/>'<strong class="kh ir">Rust components successfully installed '</strong></p><p id="541d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果安装正确，RLS应自动分析源代码并显示以下警告消息:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="7642" class="mp ls iq ng b gy nk nl l nm nn">crate `HelloWorld` should have a snake case name<br/>note: `#[warn(non_snake_case)]` on by default<br/>help: convert the identifier to snake case: `hello_world`</span></pre><p id="a939" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要纠正这个问题，打开<em class="ln"> Cargo.toml </em>并将<em class="ln">名称</em>条目改为snake case</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="d8fa" class="mp ls iq ng b gy nk nl l nm nn">[package]<br/>name = “hello_world”<br/>....</span></pre><p id="31a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">警告现在应该会自动消失。</p><p id="76d5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编辑main.rs文件，添加要在输出字符串中显示的变量。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="25c5" class="mp ls iq ng b gy nk nl l nm nn">fn main() {<br/>  let somevalue = 123;<br/>  println!("Hello, world! {}", somevalue);<br/>}</span></pre><h1 id="fe5a" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">构建和执行项目。</h1><p id="1b02" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">根据您的喜好，您可以通过命令行或使用VS代码的任务特性来构建或执行。</p><h2 id="cb7e" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">通过命令行</h2><p id="a36c" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">通过菜单项“终端”或使用快捷键<em class="ln"> Cntrl+~ </em>打开终端</p><p id="5a0e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">构建项目并创建二进制文件</strong></p><p id="8a50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在命令行中，执行:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b0c6" class="mp ls iq ng b gy nk nl l nm nn">❯ cargo build<br/><strong class="ng ir">  Finished</strong> dev [unoptimized + debuginfo] target(s) in 0.02s</span></pre><p id="6257" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">执行二进制</strong></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="9485" class="mp ls iq ng b gy nk nl l nm nn"><strong class="ng ir">❯</strong> cargo run<br/><strong class="ng ir">Finished</strong> dev [unoptimized + debuginfo] target(s) in 0.00s<br/><strong class="ng ir">Running</strong> `target/debug/hello_world`</span><span id="afb9" class="mp ls iq ng b gy of nl l nm nn">Hello, world! 123</span></pre><h2 id="e9b9" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated">使用任务</h2><p id="bddb" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">要运行VS代码任务的特性，使用<em class="ln">命令+Shift+B </em>。</p><p id="5345" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参照https://code.visualstudio.com/docs/editor/tasks#vscode<a class="ae mo" href="https://code.visualstudio.com/docs/editor/tasks#vscode" rel="noopener ugc nofollow" target="_blank">的</a>来设置任务创建<em class="ln">。vscode/tasks.json </em>文件，并用下面提供构建和运行任务的文本填充。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="af93" class="mp ls iq ng b gy nk nl l nm nn">{<br/>    "version": "2.0.0",<br/>    "tasks": [{<br/>     "label": "cargo build",<br/>     "type": "shell",<br/>     "command": "cargo build",<br/>     "args": [],<br/>     "group": {<br/>       "kind": "build",<br/>       "isDefault": true<br/>     }<br/>    },<br/>    {<br/>        "label": "cargo run",<br/>        "type": "shell",<br/>        "command": "cargo",<br/>        "args": [<br/>          "run"<br/>          // "--release",<br/>          // "--",<br/>          // "arg1"<br/>        ],<br/>        "group": {<br/>          "kind": "build",<br/>          "isDefault": true<br/>        }<br/>       }]<br/>  }</span></pre><h1 id="0733" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated"><strong class="ak">调试项目</strong></h1><h2 id="3780" class="mp ls iq bd lt mq mr dn lx ms mt dp mb ko mu mv md ks mw mx mf kw my mz mh na bi translated"><strong class="ak">安装加长件</strong></h2><ul class=""><li id="425e" class="nr ns iq kh b ki mj kl mk ko og ks oh kw oi la nw nx ny nz bi translated">如果CodeLLDB(VS代码的一个<a class="ae mo" href="https://github.com/vadimcn/vscode-lldb" rel="noopener ugc nofollow" target="_blank">本机调试器扩展</a>)尚未安装，则使用上述<em class="ln"> Command+p </em> as(或<em class="ln"> Control+p </em>)通过打开的命令面板安装该扩展，并输入<br/> <code class="fe no np nq ng b">ext install vadimcn.vscode-lldb</code>和<em class="ln">输入</em>。</li><li id="6510" class="nr ns iq kh b ki oa kl ob ko oc ks od kw oe la nw nx ny nz bi translated">在MAC上按下功能F5或通过菜单使用<em class="ln">运行- &gt;开始调试</em>并选择<strong class="kh ir"> LLDB </strong>选项。<strong class="kh ir"> </strong> VS代码将显示一条消息，说明<strong class="kh ir">无法开始调试，因为没有提供启动配置。</strong>选择默认选项以生成启动文件。</li><li id="6932" class="nr ns iq kh b ki oa kl ob ko oc ks od kw oe la nw nx ny nz bi translated">打开<em class="ln"> src/main.rs </em>并将断点置于第3行<code class="fe no np nq ng b">println!(“Hello, world!”)</code>的左侧，按<em class="ln"> F5 </em>或<em class="ln">Run-&gt;Start Debugging</em>启动调试器。</li></ul><figure class="nb nc nd ne gt ok gh gi paragraph-image"><div role="button" tabindex="0" class="ol om di on bf oo"><div class="gh gi oj"><img src="../Images/b079a6d40c860ded429245a9c30ec44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h9f7F3NDaBx5Se1BiqeTtA.png"/></div></div><figcaption class="or os gj gh gi ot ou bd b be z dk translated">图片由BesterDesigns LLC提供</figcaption></figure><p id="4d47" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这样——享受吧！</p></div></div>    
</body>
</html>