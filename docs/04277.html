<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://levelup.gitconnected.com/flutter-custom-dynamic-theme-b3e9b70fcd71?source=collection_archive---------1-----------------------#2020-06-18">https://levelup.gitconnected.com/flutter-custom-dynamic-theme-b3e9b70fcd71?source=collection_archive---------1-----------------------#2020-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/3fa6ef91abc4e9c19643c0d07c47f8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tRmY1OtRKzIZbsAlvHBo8g.png"/></div></div></figure><p id="0cd4" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">应用定制有助于建立令人敬畏的用户体验，这是我们希望在所有应用中实现的。让用户随心所欲地改变颜色和风格。即使你没有为你的应用建立很多时髦的主题，一个黑色的主题几乎是必须的。许多知名的应用程序实现了黑暗主题，有些甚至推出了默认的黑暗主题。</p><blockquote class="jy jz ka"><p id="19de" class="iz ja kb jc b jd je jf jg jh ji jj jk kc jm jn jo kd jq jr js ke ju jv jw jx ij bi translated"><a class="ae kf" href="https://uxplanet.org/why-is-it-important-to-have-a-switch-to-dark-mode-feature-in-an-interface-522df677c3e3" rel="noopener ugc nofollow" target="_blank">阅读此处，了解拥有黑暗模式选项的重要性</a></p></blockquote><p id="ba90" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">本教程将创建一个简单的单页Flutter应用程序，用户可以选择预定义的主题或为自己的自定义主题选择颜色。</p><p id="3d29" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">选择权是他们的！他们现在必须做出决定…</p><figure class="kg kh ki kj gt is"><div class="bz fp l di"><div class="kk kl l"/></div></figure><h2 id="75ad" class="km kn jb bd ko kp kq dn kr ks kt dp ku jl kv kw kx jp ky kz la jt lb lc ld le bi translated">我用的是:</h2><ul class=""><li id="e8d0" class="lf lg jb jc b jd lh jh li jl lj jp lk jt ll jx lm ln lo lp bi translated">Android Studio 4.0</li><li id="e8de" class="lf lg jb jc b jd lq jh lr jl ls jp lt jt lu jx lm ln lo lp bi translated">颤振1.17.3(稳定通道)</li><li id="dc96" class="lf lg jb jc b jd lq jh lr jl ls jp lt jt lu jx lm ln lo lp bi translated">Dart 2.8.4(稳定通道)</li><li id="200c" class="lf lg jb jc b jd lq jh lr jl ls jp lt jt lu jx lm ln lo lp bi translated">包:提供商4.1.3</li><li id="386b" class="lf lg jb jc b jd lq jh lr jl ls jp lt jt lu jx lm ln lo lp bi translated">包装:飘动材质拾色器1.0.5</li></ul></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><h2 id="0ae6" class="km kn jb bd ko kp kq dn kr ks kt dp ku jl kv kw kx jp ky kz la jt lb lc ld le bi translated">让我们开始行动吧</h2><ol class=""><li id="18f7" class="lf lg jb jc b jd lh jh li jl lj jp lk jt ll jx mc ln lo lp bi translated"><strong class="jc md">首先是</strong>，继续创建一个新的Flutter项目，并将最新版本的<code class="fe me mf mg mh b"><a class="ae kf" href="https://pub.dev/packages/provider" rel="noopener ugc nofollow" target="_blank">provider</a></code>包添加到<code class="fe me mf mg mh b">pubspec.yaml</code>文件中的依赖项中。</li></ol><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="caef" class="km kn jb mh b gy mm mn l mo mp">dependencies:<br/>  flutter:<br/>    sdk: flutter<br/>  provider: ^4.1.3</span></pre><p id="2dc2" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">2.接下来，编写我们预定义的主题值。创建一个新的dart文件，命名为<code class="fe me mf mg mh b">theme_values.dart</code>。</p><p id="ef4b" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在为了简单起见，我们将只定义primaryColor、accentColor和backgroundColor来创建<code class="fe me mf mg mh b"><a class="ae kf" href="https://api.flutter.dev/flutter/material/ThemeData-class.html" rel="noopener ugc nofollow" target="_blank">ThemeData</a></code>。参见<code class="fe me mf mg mh b"><a class="ae kf" href="https://api.flutter.dev/flutter/material/ThemeData-class.html" rel="noopener ugc nofollow" target="_blank">ThemeData</a></code>文档，看看你还能配置什么。</p><p id="1f08" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">这个例子包含4个不同的预定义主题。</p><figure class="kg kh ki kj gt is"><div class="bz fp l di"><div class="mq kl l"/></div></figure><p id="9a45" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在，你可以创建尽可能多或尽可能少的主题，并继续学习本教程。</p><p id="90f1" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi">.</p><h2 id="c638" class="km kn jb bd ko kp kq dn kr ks kt dp ku jl kv kw kx jp ky kz la jt lb lc ld le bi translated">尽情享受色彩吧！</h2><p id="2860" class="pw-post-body-paragraph iz ja jb jc b jd lh jf jg jh li jj jk jl mr jn jo jp ms jr js jt mt jv jw jx ij bi translated">这些是我创作的主题。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="6487" class="km kn jb mh b gy mm mn l mo mp"><em class="kb">/// ----  Blue Theme  ----<br/></em>final bluePrimary         = Color(0xFF3F51B5);<br/>final blueAccent          = Color(0xFFFF9800);<br/>final blueBackground      = Color(0xFFFFFFFF);<br/>final blueTheme = ThemeData(<br/>    primaryColor: bluePrimary,<br/>    accentColor: blueAccent,<br/>    backgroundColor: blueBackground<br/>);<br/><br/><em class="kb">/// ----  Spooky Theme  ----<br/></em>final spookyPrimary       = Color(0xFF000000);<br/>final spookyAccent        = Color(0xFFBB86FC);<br/>final spookyBackground    = Color(0xFF4A4A4A);<br/>final spookyTheme = ThemeData(<br/>    primaryColor: spookyPrimary,<br/>    accentColor: spookyAccent,<br/>    backgroundColor: spookyBackground,<br/>);<br/><br/><em class="kb">/// ----  Green Theme  ----<br/></em>final greenPrimary        = Color(0xFF4CAF50);<br/>final greenAccent         = Color(0xFF631739);<br/>final greenBackground      = Color(0xFFFFFFFF);<br/>final greenTheme = ThemeData(<br/>    primaryColor: greenPrimary,<br/>    accentColor: greenAccent,<br/>    backgroundColor: greenBackground<br/>);<br/><br/><em class="kb">/// ----  Pink Theme  ----<br/></em>final pinkPrimary         = Color(0xFFE91E63);<br/>final pinkAccent          = Color(0xFF0C7D9C);<br/>final pinkBackground      = Color(0xFFFFFFFF);<br/>final pinkTheme = ThemeData(<br/>    primaryColor: pinkPrimary,<br/>    accentColor: pinkAccent,<br/>    backgroundColor: pinkBackground<br/>);</span></pre><p id="6c52" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">3.现在创建一个类<code class="fe me mf mg mh b">with ChangeNotifier</code>，并将其命名为<code class="fe me mf mg mh b">ThemeNotifier</code>。查看<a class="mu mv ep" href="https://medium.com/u/6c4de9aa3d69?source=post_page-----b3e9b70fcd71--------------------------------" rel="noopener" target="_blank"> Divyanshu Bhargava </a>的<a class="ae kf" href="https://medium.com/better-programming/how-to-create-a-dynamic-theme-in-flutter-using-provider-e6ad1f023899" rel="noopener"> Medium Story </a>来更详细地了解这是如何完成的。下面是供你使用的类。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="0a37" class="km kn jb mh b gy mm mn l mo mp">class ThemeNotifier with ChangeNotifier {<br/>  ThemeData _themeData = blueTheme;<br/><br/>  ThemeNotifier(this._themeData);<br/><br/>  getTheme() =&gt; _themeData;<br/><br/>  setTheme(ThemeData themeData) async {<br/>    _themeData = themeData;<br/>    notifyListeners();<br/>  }<br/>}</span></pre><p id="a53f" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">4.接下来，我们需要将整个应用程序封装在一个<code class="fe me mf mg mh b">ChangeNotifierProvider</code>中，为此我们将使用新创建的<code class="fe me mf mg mh b">ThemeNotifier</code>。转到<code class="fe me mf mg mh b">main.dart</code>文件，找到<code class="fe me mf mg mh b">void main()</code>方法。我们希望将<code class="fe me mf mg mh b">MyApp()</code>包装在提供者中。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="3d97" class="km kn jb mh b gy mm mn l mo mp">void main() {<br/>  runApp(<br/>      ChangeNotifierProvider&lt;ThemeNotifier&gt;(<br/>        create: (_) =&gt; ThemeNotifier(blueTheme), child: MyApp()<br/>      )<br/>  );<br/>}</span></pre><p id="6878" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">因此，我们现在可以在整个应用程序中访问我们的<code class="fe me mf mg mh b">ThemeNotifier</code>。使用这个命令。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="6ccc" class="km kn jb mh b gy mm mn l mo mp">Provider.<em class="kb">of</em>&lt;ThemeNotifier&gt;(context);</span></pre><p id="2082" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">5.用户界面的创建。</p><figure class="kg kh ki kj gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/473bf97ee073161bc8548d65b395c79b.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*BVQu_ieEQoFqasPU3Z7QIQ.png"/></div></figure><p id="a95c" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">左边是我们将要创建的内容。</p><p id="0eb3" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">顶部的两个容器显示了当前的主题颜色。</p><p id="b692" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">中间部分有4个圆形按钮，用于将主题更改为我们制作的<code class="fe me mf mg mh b">theme_values.dart </code>文件中的预定义主题。</p><p id="352a" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">底部是我们可以点击选择我们想要的原色和强调色的地方。</p><p id="9871" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">UI的代码变得相当长。因此，为了简化这里的事情，完整的代码将放在GitHub上供所有人查看:)现在，我们将详细介绍如何具体制作圆形按钮，当按下按钮时，这些按钮实际上会改变主题。</p><p id="c398" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><a class="ae kf" href="https://github.com/MichaelCodesThings/dynamic_theme_example/tree/master/lib" rel="noopener ugc nofollow" target="_blank">点击此处查看完整代码。</a></p><p id="bf1e" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">6.当一个新的Flutter项目启动时，它会创建一个<code class="fe me mf mg mh b">MyHomePage</code>有状态小部件。我们将使用它作为主页，用这些新的主题选项替换示例代码。</p><p id="aed1" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">在构建方法中，有一行4个定制的按钮，如下所示。现在，这些将被错误地突出显示，因为我们还没有创建这个小部件，忽略它，因为我们将在下一步创建它。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="ea93" class="km kn jb mh b gy mm mn l mo mp">Row(<br/>  mainAxisAlignment: MainAxisAlignment.center,<br/>  children: &lt;Widget&gt;[<br/>    ThemeButton(buttonThemeData: blueTheme),<br/>    ThemeButton(buttonThemeData: spookyTheme),<br/>    ThemeButton(buttonThemeData: greenTheme),<br/>    ThemeButton(buttonThemeData: pinkTheme),<br/>  ],<br/>),</span></pre><figure class="kg kh ki kj gt is"><div class="bz fp l di"><div class="mx kl l"/></div></figure><p id="e47c" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">当按下这些彩色按钮中的一个时，按钮上的图标会变成一个勾号，应用程序的主题会自动变为所述的彩色主题。</p><p id="1f3a" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">7.我们来做这些纽扣吧！首先创建一个名为<code class="fe me mf mg mh b">theme_button.dart</code>的新文件。在这个文件中创建一个名为<code class="fe me mf mg mh b">ThemeButton</code>的无状态小部件。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="e1a5" class="km kn jb mh b gy mm mn l mo mp">class ThemeButton extends StatelessWidget {</span><span id="c278" class="km kn jb mh b gy my mn l mo mp"><a class="ae kf" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/> Widget build(BuildContext context) {<br/>  return Container();<br/> }<br/>}</span></pre><p id="291b" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">我们想给这个小部件传递一个参数<code class="fe me mf mg mh b">ThemeData</code>，这样我们就可以告诉每个按钮它是什么主题。将以下代码片段添加到<code class="fe me mf mg mh b">ThemeButton</code>小部件中。像这样添加意味着小部件需要<code class="fe me mf mg mh b">buttonThemeData</code>才能工作。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="8c79" class="km kn jb mh b gy mm mn l mo mp">final ThemeData buttonThemeData;<br/><br/>ThemeButton({this.buttonThemeData});</span></pre><p id="2e6d" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">在构建方法内部，我们可以访问我们使用<code class="fe me mf mg mh b">provider</code>创建的<code class="fe me mf mg mh b">ThemeNotifier</code>。通过访问它，我们可以发现当前的主题是什么，并在这个按钮小部件中设置一个新的主题。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="69a1" class="km kn jb mh b gy mm mn l mo mp">@override<br/>Widget build(BuildContext context) {<br/>  final themeNotifier = Provider.<em class="kb">of</em>&lt;ThemeNotifier&gt;(context);</span><span id="1e0e" class="km kn jb mh b gy my mn l mo mp">  return Container();<br/> }</span></pre><p id="eb5f" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">这样我们就可以添加按钮布局了，我选择用一个形状为<code class="fe me mf mg mh b">CircleBorder()</code>的<code class="fe me mf mg mh b">RawMaterialButton</code>来添加。确保将<code class="fe me mf mg mh b">fillColor</code>设置为<code class="fe me mf mg mh b">buttonThemeData.primaryColor</code>，这样我们就知道这个按钮代表什么主题。</p><p id="2024" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><code class="fe me mf mg mh b">onPressed</code>方法是我们告诉<code class="fe me mf mg mh b">ThemeNotifier</code>新主题是什么的地方。取<code class="fe me mf mg mh b">buttonThemeData</code>的<code class="fe me mf mg mh b">ThemeButton</code>参数。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="82c5" class="km kn jb mh b gy mm mn l mo mp">@override<br/>Widget build(BuildContext context) {<br/>  final themeNotifier = Provider.<em class="kb">of</em>&lt;ThemeNotifier&gt;(context);<br/><br/>  return RawMaterialButton(<br/>    onPressed: () {<br/>      themeNotifier.setTheme(buttonThemeData);<br/>    },<br/>    child: AnimatedSwitcher(<br/>      duration: Duration(milliseconds: 400),<br/>      transitionBuilder: (Widget child, Animation&lt;double&gt; animation) =&gt;<br/>          ScaleTransition(<br/>        child: child,<br/>        scale: animation,<br/>      ),<br/>      child: _getIcon(themeNotifier),<br/>    ),<br/>    shape: CircleBorder(),<br/>    elevation: 2.0,<br/>    fillColor: buttonThemeData.primaryColor,<br/>    padding: const EdgeInsets.all(15.0),<br/>  );<br/>}</span></pre><p id="1a57" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">你可能已经注意到了，<code class="fe me mf mg mh b">RawMaterialButton </code>的孩子不是一个简单的<code class="fe me mf mg mh b">Icon</code>。我加了一个带<code class="fe me mf mg mh b">ScaleTransition</code>的<code class="fe me mf mg mh b">AnimatedSwitcher</code>。这意味着当按下按钮时，会有一个很酷的小缩放的进出动画在刻度图标和十字图标之间切换。</p><p id="655a" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">根据<code class="fe me mf mg mh b">buttonThemeData</code>是否与<code class="fe me mf mg mh b">themeNotifier</code>中的当前主题相同，<code class="fe me mf mg mh b">getIcon()</code>方法将返回一个勾号或十字图标。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="9d2f" class="km kn jb mh b gy mm mn l mo mp">bool selected = (themeNotifier.getTheme() == buttonThemeData);</span></pre><p id="1b12" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">使用这个bool，我们可以返回包装在带有密钥的<code class="fe me mf mg mh b">Container</code>中的<code class="fe me mf mg mh b">Icon</code>。密钥在那里，所以<code class="fe me mf mg mh b">AnimatedSwitcher</code>可以识别孩子何时改变。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="3d5c" class="km kn jb mh b gy mm mn l mo mp">Widget _getIcon(ThemeNotifier themeNotifier) {<br/>    bool selected = (themeNotifier.getTheme() == buttonThemeData);<br/><br/>    return Container(<br/>      key: Key((selected) ? "ON" : "OFF"),<br/>      child: Icon(<br/>        (selected) ? Icons.<em class="kb">done </em>: Icons.<em class="kb">close</em>,<br/>        color: buttonThemeData.accentColor,<br/>        size: 20.0,<br/>      ),<br/>    );<br/>  }<br/>}</span></pre><p id="2ee5" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">至此，<code class="fe me mf mg mh b">ThemeButton</code>完成。恭喜你成功了！您现在可以添加任意数量的按钮，将主题设置为您喜欢的任何内容。</p><p id="449d" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">但是等等…不是这个。</p><figure class="kg kh ki kj gt is"><div class="bz fp l di"><div class="mz kl l"/></div></figure><p id="e5fc" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">但是我听到你说允许用户从更多的颜色中选择呢？</p><p id="06e7" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">放心吧！我将在下一部分介绍您:)</p><p id="57f0" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">8.现在向主<code class="fe me mf mg mh b">MyHomePage</code>小部件添加一个<code class="fe me mf mg mh b">_customTheme </code>变量。我们已经设置了这个主题的主色、强调色和背景色。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="6134" class="km kn jb mh b gy mm mn l mo mp">class _MyHomePageState extends State&lt;MyHomePage&gt; {<br/>  ThemeData _customTheme = ThemeData(<br/>      primaryColor: Colors.blue,<br/>      accentColor: Colors.white,<br/>      backgroundColor: Colors.white);<br/>.<br/>.<br/>...</span></pre><p id="8cce" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">如果你想让事情变得更有趣。你可以使用下面的片段来代替特定的颜色，从而随机选择自定义主题中使用的颜色。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="333b" class="km kn jb mh b gy mm mn l mo mp">Color((Random().nextDouble() * 0xFFFFFF).toInt()).withOpacity(1.0))</span></pre><p id="8378" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">将另一个<code class="fe me mf mg mh b">ThemeButton()</code>添加到主页面，这次使用我们的<code class="fe me mf mg mh b">_customTheme</code>作为参数。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="c1f9" class="km kn jb mh b gy mm mn l mo mp">ThemeButton(buttonThemeData: _customTheme)</span></pre><p id="9256" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在，我们所需要的是让用户选择他们想要的自定义主题的颜色。为此，我们将使用包<code class="fe me mf mg mh b"><a class="ae kf" href="https://pub.dev/packages/flutter_material_color_picker" rel="noopener ugc nofollow" target="_blank">flutter_material_color_picker</a></code>。继续将这个包添加到<code class="fe me mf mg mh b">pubspec.yaml</code>文件的依赖项中。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="08aa" class="km kn jb mh b gy mm mn l mo mp">dependencies:<br/>  flutter:<br/>    sdk: flutter<br/>  provider: ^4.1.3<br/>  flutter_material_color_picker: ^1.0.5</span></pre><p id="3741" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">添加后，让我们制作一个按钮，用户可以点击它来改变主题的颜色。我们将有一个按钮来选择每一个原色和强调色。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="c1c0" class="km kn jb mh b gy mm mn l mo mp">FlatButton(<br/>    onPressed: () {},<br/>    color: _customTheme.primaryColor,<br/>    child: Text("Choose Primary Color",<br/>        textAlign: TextAlign.center,<br/>        style:<br/>            _customTheme.primaryTextTheme.button)),</span><span id="836c" class="km kn jb mh b gy my mn l mo mp">FlatButton(<br/>    onPressed: () {},<br/>    color: _customTheme.accentColor,<br/>    child: Text("Choose Accent Color",<br/>        textAlign: TextAlign.center,<br/>        style:<br/>            _customTheme.primaryTextTheme.button)),</span></pre><p id="db1b" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">9.接下来创建颜色选择对话框。使用我们添加的包，我们可以创建一个包含小部件<code class="fe me mf mg mh b">MaterialColorPicker</code>的简单警告对话框。当创建这个对话框时，我们想给<code class="fe me mf mg mh b">_openDialog()</code>方法参数，这样我们就知道标题是什么；目前使用什么颜色，我们是选择原色还是强调色。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="bad9" class="km kn jb mh b gy mm mn l mo mp">// Dialog to select colors for theme.<br/>void _openDialog(String title, Color currentColor, bool primaryColor) {<br/>  showDialog(<br/>    context: context,<br/>    builder: (_) {<br/>      return AlertDialog(<br/>        contentPadding: const EdgeInsets.all(6.0),<br/>        title: Text(title),<br/>        content: Container(<br/>          height: 250,<br/>          child: MaterialColorPicker(<br/>            selectedColor: currentColor,<br/>            onColorChange: (color) =&gt; setState(() =&gt; _customTheme =<br/>                (primaryColor)<br/>                    ? _customTheme.copyWith(primaryColor: color)<br/>                    : _customTheme.copyWith(accentColor: color)),<br/>            onMainColorChange: (color) =&gt; setState(() =&gt; _customTheme =<br/>                (primaryColor)<br/>                    ? _customTheme.copyWith(primaryColor: color)<br/>                    : _customTheme.copyWith(accentColor: color)),<br/>          ),<br/>        ),<br/>        actions: &lt;Widget&gt;[<br/>          FlatButton(<br/>            onPressed: () {<br/>              Navigator.<em class="kb">of</em>(context).pop();<br/>            },<br/>            child: Text(<br/>              "Done",<br/>              style: Theme.<em class="kb">of</em>(context).textTheme.button,<br/>            ),<br/>          )<br/>        ],<br/>      );<br/>    },<br/>  );<br/>}</span></pre><p id="f216" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">当选择一种颜色时，我们想在我们的主<code class="fe me mf mg mh b">MyHomePage</code>小部件上设置状态，以更新<code class="fe me mf mg mh b">_customTheme</code>变量的状态。这随后将自定义主题圆形按钮更新为所选择的内容。</p><p id="aa3e" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">注意我们使用<code class="fe me mf mg mh b">primaryColor</code>布尔变量来告诉picker小部件是否将所选颜色保存为<code class="fe me mf mg mh b">_customeTheme</code>变量中的主色或强调色。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="22e0" class="km kn jb mh b gy mm mn l mo mp">_customTheme =<br/>                (primaryColor)<br/>                    ? _customTheme.copyWith(primaryColor: color)<br/>                    : _customTheme.copyWith(accentColor: color)),</span></pre><p id="ffe7" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">创建好对话框后，我们可以将其添加到<code class="fe me mf mg mh b">FlatButton</code>小部件的<code class="fe me mf mg mh b">onPressed</code>方法中进行颜色选择。给出每个按钮的正确参数。</p><pre class="kg kh ki kj gt mi mh mj mk aw ml bi"><span id="4d02" class="km kn jb mh b gy mm mn l mo mp">FlatButton(<br/>    onPressed: () =&gt; _openDialog("Primary Color",<br/>        _customTheme.primaryColor, true),<br/>    color: _customTheme.primaryColor,<br/>    child: Text("Choose Primary Color",<br/>        textAlign: TextAlign.center,<br/>        style:<br/>            _customTheme.primaryTextTheme.button)),</span><span id="a558" class="km kn jb mh b gy my mn l mo mp">FlatButton(<br/>    onPressed: () =&gt; _openDialog("Accent Color",<br/>        _customTheme.accentColor, false),<br/>    color: _customTheme.accentColor,<br/>    child: Text("Choose Accent Color",<br/>        textAlign: TextAlign.center,<br/>        style:<br/>            _customTheme.primaryTextTheme.button))<br/></span></pre><figure class="kg kh ki kj gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/f804fec1ede934c98717a552050d74d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*3MMBv2es_3zmHmSyrwpG5A.png"/></div></figure><p id="2f76" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">随着这些按钮的更新，我们现在有一个可供用户选择颜色的工作选项，然后按下自定义主题按钮。这样做会立即改变应用程序的主题。</p><p id="8dd5" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">哇哦！你做到了！</p><p id="4616" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">您已经创建了一个页面，用户可以在其中选择预定义的主题或自己选择他们想要的主题。</p><figure class="kg kh ki kj gt is"><div class="bz fp l di"><div class="na kl l"/></div></figure><p id="5906" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><a class="ae kf" href="https://github.com/MichaelCodesThings/dynamic_theme_example/tree/master/lib" rel="noopener ugc nofollow" target="_blank">点击此处查看完整代码。</a></p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="ff42" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">[1]为什么界面中的切换到黑暗模式功能很重要？|<a class="ae kf" href="https://uxplanet.org/@eckyalimansyah?source=post_page-----522df677c3e3----------------------" rel="noopener ugc nofollow" target="_blank">Ecky Alimansyah</a>| 2020年6月13日|<a class="ae kf" href="https://uxplanet.org/why-is-it-important-to-have-a-switch-to-dark-mode-feature-in-an-interface-522df677c3e3" rel="noopener ugc nofollow" target="_blank">https://UX planet . org/why-it-the-important-to-have-a-switch-a-dark-mode-feature-in-a-an-interface-522 df 677 C3 E3</a></p><p id="ad36" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">[2]如何使用Provider在Flutter中创建动态主题|<a class="ae kf" href="https://medium.com/@divyanshub024?source=post_page-----e6ad1f023899----------------------" rel="noopener">Divyanshu Bhargava</a>| 2019年9月30日|<a class="ae kf" href="https://medium.com/better-programming/how-to-create-a-dynamic-theme-in-flutter-using-provider-e6ad1f023899" rel="noopener">https://medium . com/better-programming/How-To-Create-a-Dynamic-Theme-in-Flutter-Using-Provider-e6ad 1 f 023899</a></p></div></div>    
</body>
</html>