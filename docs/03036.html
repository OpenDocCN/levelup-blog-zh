<html>
<head>
<title>Getting Started with Sequelize CLI using Faker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Faker开始Sequelize CLI</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/getting-started-with-sequelize-cli-using-faker-824b3f4c4cfe?source=collection_archive---------10-----------------------#2020-04-16">https://levelup.gitconnected.com/getting-started-with-sequelize-cli-using-faker-824b3f4c4cfe?source=collection_archive---------10-----------------------#2020-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/021463944331716371fec71e4ce6afef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fygqfizATFjt6ALek2W1jg.png"/></div></div></figure><p id="3fb6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您最近<a class="ae kw" href="https://medium.com/@brunopgalvao/getting-started-with-sequelize-cli-c33c797f05c6" rel="noopener">开始使用Sequelize命令行界面(CLI) </a>来使用Sequelize，您可能已经注意到，如果您没有任何数据，您就无法对您的数据库做太多事情。</p><p id="3b79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">幸运的是，一个名为<a class="ae kw" href="https://www.npmjs.com/package/faker" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Faker </strong> </a>的npm包可以帮助填补这个空白。在本演练中，我们将使用<a class="ae kw" href="https://github.com/sequelize/cli" rel="noopener ugc nofollow" target="_blank"> Sequelize CLI </a>创建一个简单的项目，然后使用Faker为一组相当可信的虚拟用户生成合理可信的虚假信息。</p><p id="de4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从安装Postgres、Sequelize和<a class="ae kw" href="https://github.com/sequelize/cli" rel="noopener ugc nofollow" target="_blank"> Sequelize CLI </a>开始，在一个新的项目文件夹中，我们称之为<code class="fe kx ky kz la b">sequelize-practice</code>:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="34d2" class="lj lk iq la b gy ll lm l ln lo">mkdir sequelize-practice<br/>cd sequelize-practice<br/>npm init -y<br/>npm install sequelize pg<br/>npm install --save-dev sequelize-cli</span></pre><p id="4bb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，让我们初始化一个Sequelize项目，然后在代码编辑器中打开目录:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="6f3a" class="lj lk iq la b gy ll lm l ln lo">npx sequelize-cli init<br/>code .</span></pre><blockquote class="lp lq lr"><p id="25df" class="jy jz ls ka b kb kc kd ke kf kg kh ki lt kk kl km lu ko kp kq lv ks kt ku kv ij bi translated">要了解有关以下任何顺序化CLI命令的更多信息，请参见:<br/> <a class="ae kw" href="https://medium.com/@brunopgalvao/getting-started-with-sequelize-cli-c33c797f05c6" rel="noopener"> <strong class="ka ir">顺序化CLI入门</strong> </a></p></blockquote><p id="de1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们配置我们的Sequelize项目来使用Postgres。在<code class="fe kx ky kz la b">/config</code>目录中找到<code class="fe kx ky kz la b">config.json</code>，并用以下代码替换那里的内容:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="d38f" class="lj lk iq la b gy ll lm l ln lo">{<br/>  "development": {<br/>    "database": "sequelize_practice_development",<br/>    "host": "127.0.0.1",<br/>    "dialect": "postgres"<br/>  },<br/>  "test": {<br/>    "database": "sequelize_practice_test",<br/>    "host": "127.0.0.1",<br/>    "dialect": "postgres"<br/>  },<br/>  "production": {<br/>    "database": "sequelize_practice_production",<br/>    "host": "127.0.0.1",<br/>    "dialect": "postgres"<br/>  }<br/>}</span></pre><p id="0a1d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">酷，现在我们可以告诉Sequelize创建数据库:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="5fc8" class="lj lk iq la b gy ll lm l ln lo">npx sequelize-cli db:create</span></pre><p id="96c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们将从命令行创建一个<code class="fe kx ky kz la b">User</code>模型:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="3255" class="lj lk iq la b gy ll lm l ln lo">npx sequelize-cli model:generate --name User --attributes firstName:string,lastName:string,email:string,userName:string,password:string,jobTitle:string</span></pre><p id="2c30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行<code class="fe kx ky kz la b">model:generate</code>会自动创建一个模型文件和一个带有我们指定属性的迁移。现在，为了使用Faker生成种子数据，您不需要担心(或编辑)这些。</p><p id="1f50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们将执行迁移，在数据库中创建<code class="fe kx ky kz la b">Users</code>表:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="41ea" class="lj lk iq la b gy ll lm l ln lo">npx sequelize-cli db:migrate</span></pre><h1 id="63bb" class="lw lk iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">用Faker播种</h1><p id="cf9e" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">既然我们的Sequelize项目已经建立，乐趣可以开始了！我们可以要求Faker创建各种看似真实的信息，从普通的lorem ipsum到虚构的电子邮件地址和电话号码。</p><p id="c9a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这不仅有趣——它还使开发人员能够测试一旦输入真正的数据，他们的模型、关联和查询将如何表现。</p><p id="2f3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们安装Faker:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="4890" class="lj lk iq la b gy ll lm l ln lo">npm install faker</span></pre><p id="752a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们将告诉Sequelize CLI生成一个种子文件:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="9b0e" class="lj lk iq la b gy ll lm l ln lo">npx sequelize-cli seed:generate --name users</span></pre><p id="9567" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在<code class="fe kx ky kz la b">/seeders</code>子目录中生成一个文件名类似于<code class="fe kx ky kz la b">20190904165805-users.js</code>的文件。(数字将基于当前日期和时间。)</p><p id="2eb6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用下面的代码替换该文件中的样板代码:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="080b" class="lj lk iq la b gy ll lm l ln lo">const faker = require('faker');</span><span id="5bc3" class="lj lk iq la b gy my lm l ln lo">const users = [...Array(100)].map((user) =&gt; (<br/>  {<br/>    firstName: faker.name.firstName(),<br/>    lastName: faker.name.lastName(),<br/>    email: faker.internet.email(),<br/>    userName: faker.internet.userName(),<br/>    password: faker.internet.password(8),<br/>    jobTitle: faker.name.jobTitle(),<br/>    createdAt: new Date(),<br/>    updatedAt: new Date()<br/>  }<br/>))</span><span id="5f09" class="lj lk iq la b gy my lm l ln lo">module.exports = {<br/>  up: (queryInterface, Sequelize) =&gt; {<br/>    return queryInterface.bulkInsert('Users', users, {});<br/>  },</span><span id="ddae" class="lj lk iq la b gy my lm l ln lo">  down: (queryInterface, Sequelize) =&gt; {<br/>    return queryInterface.bulkDelete('Users', null, {});<br/>  }<br/>};</span></pre><p id="3e11" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们生成一个100个对象的数组——对于每个对象，Faker将使用类似<code class="fe kx ky kz la b">faker.name.lastName()</code>和<code class="fe kx ky kz la b">faker.internet.email()</code>的方法填充细节。然后，我们只需执行批量插入，将这些条目添加到数据库中。就这么简单！</p><p id="c203" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保存文件后，执行它:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="476b" class="lj lk iq la b gy ll lm l ln lo">npx sequelize-cli db:seed:all</span></pre><p id="f90a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">进入<code class="fe kx ky kz la b">psql</code>并查询数据库，找出Faker制造了什么:</p><pre class="lb lc ld le gt lf la lg lh aw li bi"><span id="edd7" class="lj lk iq la b gy ll lm l ln lo">psql sequelize_practice_development<br/>SELECT * FROM "Users";</span></pre><blockquote class="lp lq lr"><p id="ef20" class="jy jz ls ka b kb kc kd ke kf kg kh ki lt kk kl km lu ko kp kq lv ks kt ku kv ij bi translated">播种错误？您可以随时撤销:<code class="fe kx ky kz la b"><em class="iq">npx sequelize-cli db:seed:undo</em></code></p></blockquote><p id="4d88" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在你有一个Sequelize项目和一个有100个假用户的数据库！你最后和谁在一起了？莫尼克·麦克塔维什？诺姆·西波维茨？汉瑟·拉米雷斯？无名女尸？让·吕克·周？没关系！重要的是，现在你有了可以用来<a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/using-the-sequelize-cli-and-querying-4ba8d0ac4314">在你的项目成形时试验你的顺序查询</a>的数据。</p><p id="e264" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="http://marak.github.io/faker.js/#toc9__anchor" rel="noopener ugc nofollow" target="_blank"> Faker的可用虚假数据列表</a>可以帮助您定制种子数据，以满足您的项目需求。在<a class="ae kw" href="https://medium.com/@brunopgalvao/creating-sequelize-associations-with-the-sequelize-cli-tool-d83caa902233" rel="noopener"> <strong class="ka ir">创建一个顺序关联</strong> </a>之后，尝试播种两个或更多不同的表！</p><blockquote class="lp lq lr"><p id="e70a" class="jy jz ls ka b kb kc kd ke kf kg kh ki lt kk kl km lu ko kp kq lv ks kt ku kv ij bi translated">本文是与纽约市的软件工程师、编辑和作家杰里米·罗斯(Jeremy Rose)合著的。</p></blockquote><h1 id="f977" class="lw lk iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">有关Sequelize CLI的更多信息:</h1><ul class=""><li id="829e" class="mz na iq ka b kb mt kf mu kj nb kn nc kr nd kv ne nf ng nh bi translated">【Sequelize CLI入门</li><li id="20d5" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated"><a class="ae kw" href="https://medium.com/@brunopgalvao/using-the-sequelize-cli-and-querying-4ba8d0ac4314" rel="noopener">使用顺序CLI并查询</a></li><li id="daeb" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated"><a class="ae kw" href="https://medium.com/@brunopgalvao/creating-sequelize-associations-with-the-sequelize-cli-tool-d83caa902233" rel="noopener">使用序列CLI创建序列关联</a></li><li id="e0cf" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated">将CLI和Express排序</li><li id="aa30" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated"><a class="ae kw" href="https://medium.com/@brunopgalvao/build-an-express-api-with-sequelize-cli-and-express-router-963b6e274561" rel="noopener">使用序列CLI和快速路由器构建快速API</a></li><li id="8ef5" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated">使用序列CLI和单元测试构建Express API！</li></ul></div></div>    
</body>
</html>