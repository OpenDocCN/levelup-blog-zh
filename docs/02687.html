<html>
<head>
<title>Creating GraphQL Input Types with Express-GraphQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Express-GraphQL创建GraphQL输入类型</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-graphql-input-types-with-express-graphql-6d402351b326?source=collection_archive---------15-----------------------#2020-03-29">https://levelup.gitconnected.com/creating-graphql-input-types-with-express-graphql-6d402351b326?source=collection_archive---------15-----------------------#2020-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/83485f6620c11ae6964da615507d4072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wvc0z1EC8PAXIyA3"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@snowjam?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">伊森·麦克阿瑟</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9e14" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用GraphQL，我们可以像创建对象类型和其他复合数据类型一样创建标量类型。</p><p id="6fb2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将看看如何用<code class="fe le lf lg lh b">GraphQLInputObjectType</code>构造函数创建GraphQL输入类型。</p><h1 id="16c1" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">GraphQLInputObjectType构造函数</h1><p id="5c0e" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">我们可以使用<code class="fe le lf lg lh b">GraphQLInputObjectType</code>构造函数来创建一个新的输入类型。</p><p id="08a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们向带有<code class="fe le lf lg lh b">name</code>属性的<code class="fe le lf lg lh b">GraphQLInputObjectType</code>构造函数传递一个对象来设置输入类型的名称，然后传递一个带有字段名作为键和值的<code class="fe le lf lg lh b">fields</code>对象，这些对象带有<code class="fe le lf lg lh b">type</code>属性来指定字段的类型。</p><p id="c831" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了指定一个必填字段，我们使用了<code class="fe le lf lg lh b">GraphQLNonNull</code>构造函数。此外，我们可以通过为<code class="fe le lf lg lh b">defaultValue</code>属性指定一个值来指定一个默认值。</p><p id="2219" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以如下指定一个突变:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="8afd" class="mt lj it lh b gy mu mv l mw mx">const express = require('express');<br/>const graphqlHTTP = require('express-graphql');<br/>const graphql = require('graphql');</span><span id="2db1" class="mt lj it lh b gy my mv l mw mx">class Person {<br/>  constructor(firstName, lastName) {<br/>    this.firstName = firstName;<br/>    this.lastName = lastName;<br/>  }<br/>}</span><span id="5987" class="mt lj it lh b gy my mv l mw mx">const PersonInputType = new graphql.GraphQLInputObjectType({<br/>  name: 'PersonInput',<br/>  fields: {<br/>    firstName: { type: new graphql.GraphQLNonNull(graphql.GraphQLString) },<br/>    lastName: { type: new graphql.GraphQLNonNull(graphql.GraphQLString) },<br/>  }<br/>});</span><span id="e26c" class="mt lj it lh b gy my mv l mw mx">const PersonType = new graphql.GraphQLObjectType({<br/>  name: 'Person',<br/>  fields: {<br/>    firstName: { type: graphql.GraphQLString },<br/>    lastName: { type: graphql.GraphQLString },<br/>  }<br/>});</span><span id="7ad4" class="mt lj it lh b gy my mv l mw mx">let person = new Person('Jane', 'Smith');</span><span id="b6e0" class="mt lj it lh b gy my mv l mw mx">const mutationType = new graphql.GraphQLObjectType({<br/>  name: 'Mutation',<br/>  fields: {<br/>    createPerson: {<br/>      type: PersonType,<br/>      args: {<br/>        person: {<br/>          type: new graphql.GraphQLNonNull(PersonInputType),<br/>        },<br/>      },<br/>      resolve: (_, { person: { firstName, lastName } }) =&gt; {<br/>        person = new Person(firstName, lastName);<br/>        return person;<br/>      }<br/>    }<br/>  }<br/>});</span><span id="460d" class="mt lj it lh b gy my mv l mw mx">const queryType = new graphql.GraphQLObjectType({<br/>  name: 'Query',<br/>  fields: {<br/>    person: {<br/>      type: PersonType,<br/>      resolve: () =&gt; {<br/>        return person;<br/>      }<br/>    }<br/>  }<br/>});</span><span id="5a64" class="mt lj it lh b gy my mv l mw mx">const schema = new graphql.GraphQLSchema({ query: queryType, mutation: mutationType });</span><span id="4e0a" class="mt lj it lh b gy my mv l mw mx">const app = express();<br/>app.use('/graphql', graphqlHTTP({<br/>  schema: schema,<br/>  graphiql: true,<br/>}));</span><span id="b88d" class="mt lj it lh b gy my mv l mw mx">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="0263" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们创建了如下的<code class="fe le lf lg lh b">PersonInputType</code>输入类型:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="2a98" class="mt lj it lh b gy mu mv l mw mx">const PersonInputType = new graphql.GraphQLInputObjectType({<br/>  name: 'PersonInput',<br/>  fields: {<br/>    firstName: { type: new graphql.GraphQLNonNull(graphql.GraphQLString) },<br/>    lastName: { type: new graphql.GraphQLNonNull(graphql.GraphQLString) },<br/>  }<br/>});</span></pre><p id="0e08" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用了<code class="fe le lf lg lh b">GraphQLInputObjectType</code>构造函数，并传入一个带有值为<code class="fe le lf lg lh b">'PersonInput'</code>的<code class="fe le lf lg lh b">name</code>字段的对象来指定类型的名称。</p><p id="ac6a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在<code class="fe le lf lg lh b">fields</code>属性中，我们指定该类型有一个<code class="fe le lf lg lh b">firstName</code>和<code class="fe le lf lg lh b">lastName</code>字段，这两个字段都是必需的，因为我们使用了传递了<code class="fe le lf lg lh b">GraphQLString</code>类型的<code class="fe le lf lg lh b">GraphQLNonNull</code>构造函数。</p><p id="d7ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输入类型只能用于突变。</p><p id="f7f2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们创建一个采用如下<code class="fe le lf lg lh b">PersonInputType</code>参数的变异:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="de35" class="mt lj it lh b gy mu mv l mw mx">const mutationType = new graphql.GraphQLObjectType({<br/>  name: 'Mutation',<br/>  fields: {<br/>    createPerson: {<br/>      type: PersonType,<br/>      args: {<br/>        person: {<br/>          type: new graphql.GraphQLNonNull(PersonInputType),<br/>        },<br/>      },<br/>      resolve: (_, { person: { firstName, lastName } }) =&gt; {<br/>        person = new Person(firstName, lastName);<br/>        return person;<br/>      }<br/>    }<br/>  }<br/>});</span></pre><p id="f889" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们用指定输出类型的<code class="fe le lf lg lh b">type</code>创建了一个<code class="fe le lf lg lh b">createPerson</code>变异，也就是我们在代码中指定的<code class="fe le lf lg lh b">PersonType</code>。</p><p id="9391" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe le lf lg lh b">args</code>属性中，我们指定了<code class="fe le lf lg lh b">person</code>参数，并将<code class="fe le lf lg lh b">type</code>设置为<code class="fe le lf lg lh b">PersonInputType</code>。这指定out变异接受<code class="fe le lf lg lh b">PersonInuptType</code>输入类型对象。</p><p id="91a8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的<code class="fe le lf lg lh b">resolve</code>函数中，我们从第二个参数中的<code class="fe le lf lg lh b">args</code>参数获取<code class="fe le lf lg lh b">firstName</code>和<code class="fe le lf lg lh b">lastName</code>，并创建一个新的<code class="fe le lf lg lh b">Person</code>对象，将其设置为<code class="fe le lf lg lh b">person</code>并返回它。</p><p id="315f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有GraphQL服务器应用程序都必须有一个根查询类型，所以我们还指定了一个<code class="fe le lf lg lh b">queryType</code>,如下所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="0c56" class="mt lj it lh b gy mu mv l mw mx">const queryType = new graphql.GraphQLObjectType({<br/>  name: 'Query',<br/>  fields: {<br/>    person: {<br/>      type: PersonType,<br/>      resolve: () =&gt; {<br/>        return person;<br/>      }<br/>    }<br/>  }<br/>});</span></pre><p id="790d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们返回一个<code class="fe le lf lg lh b">Person</code>对象并返回<code class="fe le lf lg lh b">person</code>变量。</p><p id="c0b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么当我们进行如下突变时:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="e896" class="mt lj it lh b gy mu mv l mw mx">mutation {<br/>  createPerson(person: {firstName: "John", lastName: "Doe"}){<br/>    firstName<br/>    lastName<br/>  }<br/>}</span></pre><p id="c728" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们得到:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="10b3" class="mt lj it lh b gy mu mv l mw mx">{<br/>  "data": {<br/>    "createPerson": {<br/>      "firstName": "John",<br/>      "lastName": "Doe"<br/>    }<br/>  }<br/>}</span></pre><p id="8b06" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为回应。</p><p id="3c06" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们进行如下查询时:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="24f5" class="mt lj it lh b gy mu mv l mw mx">{<br/>  person {<br/>    firstName<br/>    lastName<br/>  }<br/>}</span></pre><p id="ce56" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们回来了:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="321f" class="mt lj it lh b gy mu mv l mw mx">{<br/>  "data": {<br/>    "person": {<br/>      "firstName": "John",<br/>      "lastName": "Doe"<br/>    }<br/>  }<br/>}</span></pre><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/20c122ae233323833a15937cd045e43d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*clttAomCWAv3V7Qb"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@joanna_nix?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔安娜·尼克斯</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="f206" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">结论</h1><p id="ba93" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">我们可以用<code class="fe le lf lg lh b">GraphQLInputObjectType</code>构造函数创建一个GraphQL输入类型，其中<code class="fe le lf lg lh b">name</code>和<code class="fe le lf lg lh b">fields</code>属性在一个对象中一起传递给构造函数。</p><p id="7af3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">name</code>字段具有名称，而<code class="fe le lf lg lh b">fields</code>对象具有字段和类型。</p><p id="89f4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用<code class="fe le lf lg lh b">GraphQLNonNull</code>来指定一个字段是必需的。</p><p id="f35b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的变异中，我们在<code class="fe le lf lg lh b">args</code>属性中指定输入数据类型。</p></div></div>    
</body>
</html>