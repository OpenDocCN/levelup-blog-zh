<html>
<head>
<title>Sending Email with .docx Attachment using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用发送电子邮件。使用Python的docx附件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/sending-email-with-docx-attachment-using-python-3819259aefba?source=collection_archive---------15-----------------------#2020-06-28">https://levelup.gitconnected.com/sending-email-with-docx-attachment-using-python-3819259aefba?source=collection_archive---------15-----------------------#2020-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/03ddaf7acfcba44618511b698b832a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Nzmi3ryQspalTU_m"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">Solen Feyissa 在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1efc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文将探讨如何用Python发送带附件的电子邮件，以及如何将其集成到您现有的数据科学项目中。</p><p id="a21f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文中使用的技术假设读者已经基本理解了用Python 发送基本电子邮件的<a class="ae kf" href="https://pyshark.com/sending-email-using-python/" rel="noopener ugc nofollow" target="_blank">的结构。</a></p><p id="8bd9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">目录</strong></p><ul class=""><li id="76e5" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">介绍</li><li id="1b7e" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">创建多部分消息</li><li id="da7b" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">补充。docx附件</li><li id="5c9e" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">发送电子邮件</li><li id="7f90" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">结论</li></ul></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="06cf" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">介绍</h1><p id="eaf1" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">发送带有附件的电子邮件对生产中的项目有很大的帮助。例如，它可以集成为在每次成功运行程序后发送详细的日志(等等)。</p><p id="52e0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，使用Python发送带附件的电子邮件需要什么呢？实际上没有那么多:一些Python编程技巧和所需库的知识。</p><p id="df4d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如在关于使用Python 的<a class="ae kf" href="https://pyshark.com/sending-email-using-python/" rel="noopener ugc nofollow" target="_blank">基本电子邮件的教程中一样，我们将使用Gmail地址(但是您可以将其扩展到任何其他电子邮件服务提供商。</a></p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="ba4f" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">用Python创建多部分消息</h1><p id="8e9b" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">要继续本文，请导入所需的库:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="f4bb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与Python 中的<a class="ae kf" href="https://pyshark.com/sending-email-using-python/" rel="noopener ugc nofollow" target="_blank">基本文本邮件发送者不同，我们需要分别构建消息的各个部分。这意味着我们将分别制作每个部分，然后将其组装成一个消息对象。</a></p><p id="63df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们将定义我们的发件人和收件人地址:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="c157" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们制作一个<strong class="ki iu"> MIMEMultipart() </strong>类的实例。这是一个MIME消息类，它包含多个部分，然后这些部分被合并成一条我们将要发送的消息:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="aade" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步，我们要指定我们的<strong class="ki iu"> msg </strong>对象的具体部分。我们将在其中添加发件人和收件人的电子邮件地址，以及主题:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="14ef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将处理电子邮件的正文。到目前为止，这里的事情需要比前一部分多注意一点。让我们看一下代码并进一步讨论它:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="073f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们首先创建一个字符串，其中包含我们希望在您的电子邮件中使用的文本内容，并将其存储为<strong class="ki iu"> body </strong>。然后，我们使用<strong class="ki iu"> msg </strong>对象的<strong class="ki iu"> attach() </strong>方法(它是MIMEMultipart()类的一个实例)将它添加到我们的电子邮件中。<br/>一个重要的注意事项，当我们将它添加到我们的<strong class="ki iu"> msg </strong>对象时，我们需要使用<strong class="ki iu"> MIMEText() </strong>，它用于创建text (string)类型的MIME对象。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="8dad" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">补充。使用Python将docx附件添加到电子邮件</h1><p id="fcfd" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">在文章的这一部分，我们将学习如何将文件作为附件添加到电子邮件中。与其他部分相比，本文的这一部分具有最复杂的代码。不过没什么好担心的，我们会详细讨论每一步。</p><p id="963e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们假设我们想要添加一个简单的word文档(<strong class="ki iu"> myfile.docx </strong>)。让我们首先定义我们想要用作附件的文件的路径，并将其保存为一个名为<strong class="ki iu"> files </strong>的列表:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="c607" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将以读/写模式打开该文件，并对其进行一些操作:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><ul class=""><li id="2270" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">最初，我们以读/写模式将Word文件作为附件<strong class="ki iu">读取。</strong></li><li id="6188" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">然后我们用“application”和“octet-stream”作为参数创建一个<strong class="ki iu"> MIMEBase() </strong>类的实例，并将其存储为<strong class="ki iu">部分</strong>。它的作用是指定内容类型，在这个例子中是一个二进制文件。我们这样做的原因是因为我们希望在电子邮件应用程序(如Gmail、Outlook等)中打开该文件。</li><li id="451a" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">现在，我们需要使用MIMEBase()类的<strong class="ki iu"> set_payload() </strong>方法将有效载荷转换为编码形式，并将读取的文件作为参数传递给它。</li><li id="2d3e" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">一旦我们有了编码的表单，我们将使用<strong class="ki iu">将编码器设置为Base64。encode_base64(部分)</strong>。在计算机科学中，Base64是一种二进制到文本的编码。</li><li id="78c2" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">正如您可以跟踪代码一样，<strong class="ki iu">部分</strong>变量是我们对其应用了一些修改的MIMEBase()类的一个实例。现在我们要做的是使用<strong class="ki iu">。add_header() </strong>方法，带有特定的<a class="ae kf" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition" rel="noopener ugc nofollow" target="_blank">“Content-Disposition”</a>参数。</li><li id="acad" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">最后，我们将使用<strong class="ki iu">将其添加到输出<strong class="ki iu">消息</strong>中。attach() </strong>方法并将其转换为字符串格式。</li></ul><p id="8dfe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">精彩！我们的电子邮件是以正确的格式构建的。我们准备发送了！</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="5743" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">使用Python发送电子邮件</h1><p id="0837" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">我们剩下要做的就是登录到我们的电子邮件服务器，发送以<strong class="ki iu"> msg </strong>为内容的电子邮件。</p><p id="1cdb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将使用Gmail电子邮件地址发送邮件:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="ffc2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于这个代码块的详细解释，请参考我之前关于使用Python 发送基本电子邮件的文章。</p><h1 id="a754" class="lz ma it bd mb mc ni me mf mg nj mi mj mk nk mm mn mo nl mq mr ms nm mu mv mw bi translated">结论</h1><p id="6fb2" class="pw-post-body-paragraph kg kh it ki b kj mx kl km kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">这段代码的完整版本应该如下所示:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b0a8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文主要探讨如何使用发送电子邮件的过程。<a class="ae kf" href="https://pyshark.com/" rel="noopener ugc nofollow" target="_blank"> Python </a>中的docx附件。这应该是理解该过程并具有将其集成到现有数据科学项目中的知识的良好基础。</p><p id="6f42" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有任何问题或者对编辑有任何建议，请在下面留下你的评论。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="5078" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nn">原载于2020年6月28日https://pyshark.com</em><a class="ae kf" href="https://pyshark.com/sending-email-with-docx-attachment-using-python/" rel="noopener ugc nofollow" target="_blank"><em class="nn"/></a><em class="nn">。</em></p></div></div>    
</body>
</html>