<html>
<head>
<title>Your Infrastructure as Code 🌩 CloudFormation vs Terraform?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">作为代码的基础设施🌩CloudFormation vs Terraform？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/your-infrastructure-as-code-cloudformation-vs-terraform-34ec5fb5f044?source=collection_archive---------0-----------------------#2018-06-25">https://levelup.gitconnected.com/your-infrastructure-as-code-cloudformation-vs-terraform-34ec5fb5f044?source=collection_archive---------0-----------------------#2018-06-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6922e99dc296555e17dd5811583eb58f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5s33tSdH0P2fra5DU96DVw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/photos/_uAVHAMjGYA?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">埃伯哈德·格罗斯加斯泰格</a>在<a class="ae kc" href="https://unsplash.com/search/photos/cloud?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="f8a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">想象一下，如果你从AWS、Azure或Google获得的所有基础设施配置都可以比你点击更快更准确地复制<strong class="kf ir">。这是作为代码的基础设施。</strong></p><p id="b778" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用基础设施作为代码的疯狂好处有:</p><ul class=""><li id="738c" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><strong class="kf ir">晚上能够入睡</strong>，知道自己可以安全地重新部署到给定的状态。如果上帝禁止你的基础设施消失</li><li id="4f14" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir">遵循编码最佳实践</strong>，签入变更，代码评审，并作为一个团队构建您的基础设施</li></ul><p id="1946" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将看一看地形和云的形成。我在Localz广泛地使用了Terraform，但是为了学习，我决定尝试一下CloudFormation。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/ae6ea1984e6c85766d74174e0fbd6f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dnH0Nke1qhA-COTc5cBVoA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">两个竞争者</figcaption></figure><p id="d527" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Terraform是社区对基础设施代码的回应。它是开源的，拥有超过12k颗恒星，是云不可知的，支持数百家供应商。它通常没有CloudFormation那么冗长&amp;有一个很棒的模块系统。</p><p id="6e47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> CloudFormation </strong>由AWS开发维护，集成非常紧密，只支持AWS。这种紧密的集成有助于拥有一个很棒的UI，能够查看给定帐户的所有堆栈是很棒的。它使跨栈引用变得容易，这也是模块化和打破这种垄断的一个巨大胜利。</p><h2 id="7f56" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">命令行界面和工作流程</h2><p id="09b3" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">Terraform最常用的命令特性<code class="fe mu mv mw mx b"><a class="ae kc" href="https://www.terraform.io/docs/commands/init.html" rel="noopener ugc nofollow" target="_blank">init</a></code>和<code class="fe mu mv mw mx b"><a class="ae kc" href="https://www.terraform.io/docs/commands/plan.html" rel="noopener ugc nofollow" target="_blank">plan</a></code>。由于Terraform是云不可知的，你需要明确地说明你将在哪里存储你的状态文件，这是<code class="fe mu mv mw mx b">init</code>命令的一部分。运行一个Terraform <code class="fe mu mv mw mx b">plan</code>用于根据您的状态文件和现有基础设施创建一个执行计划。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/3dbf26434baea23ac803b7f776252273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*JUPokeE4L5NDIksiG_RHAg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">一个简单的地形执行计划</figcaption></figure><p id="49c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CloudFormation有一个类似的过程，您可以在其中创建和执行变更集。你将使用<code class="fe mu mv mw mx b"><a class="ae kc" href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/create-change-set.html" rel="noopener ugc nofollow" target="_blank">create-change-set</a></code>、<code class="fe mu mv mw mx b"><a class="ae kc" href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/execute-change-set.html" rel="noopener ugc nofollow" target="_blank">execute-change-set</a></code>和<code class="fe mu mv mw mx b"><a class="ae kc" href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/deploy/index.html" rel="noopener ugc nofollow" target="_blank">deploy</a></code>的组合。<code class="fe mu mv mw mx b">create-change-set</code>类似于Terraform的<code class="fe mu mv mw mx b">plan</code>，而<code class="fe mu mv mw mx b">execute-change-set</code>是Terraform的<code class="fe mu mv mw mx b">apply</code> &amp; <code class="fe mu mv mw mx b">deploy</code>将两个命令合二为一。</p><p id="daeb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">主要的区别是你将通过CloudFormation的UI来查看和解决问题，这很容易使用，甚至对我来说也是如此😃。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/03fee00b2346bad48d5f1fb5ef7fae20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7NwcaWIyPSxM8Oxbe0sbw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">云形成的变化集</figcaption></figure><p id="7500" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Terraform的<code class="fe mu mv mw mx b">plan</code> &amp; CloudFormation的<code class="fe mu mv mw mx b">create-change-set</code>都是在您的持续集成管道中进行手动检查的好地方。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/5c9e5f1bcdad0787fcf8a631a4cb0ca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdEr3NcoOVgDe6jWjhOJqA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用<a class="ae kc" href="https://gitlab.com/" rel="noopener ugc nofollow" target="_blank"> Gitlab </a>等待变更集的手动检查</figcaption></figure><p id="a4ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">我发现CloudFormations API有点混乱。我相信<code class="fe mu mv mw mx b">create-change-set</code>后面跟一个<code class="fe mu mv mw mx b">execute-change-set</code>曾经是事实上的，但现在<code class="fe mu mv mw mx b">deploy</code>的存在取代了它们两个。但是在某些情况下，尤其是部署到生产环境时，您可能希望遵循良好的实践，并在执行之前检查执行计划。</strong></p><p id="c330" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我认为在这种情况下，你应该使用一个<code class="fe mu mv mw mx b">create-change-set</code>后跟一个<code class="fe mu mv mw mx b">execute-change-set</code>，但是这很烦人，因为<code class="fe mu mv mw mx b">create-change-set</code>明确地需要知道你是在创建还是更新栈。因此，这将在您的持续集成管道中引起心痛。但是经过进一步的检查，我相信你运行一个带<code class="fe mu mv mw mx b">--no-execute-change-set</code>标志的<code class="fe mu mv mw mx b">deploy</code>，然后重新运行不带标志的<code class="fe mu mv mw mx b">deploy</code>。我仍然不确定推荐的方法。</p><h2 id="b1ec" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated"><strong class="ak">错位状态</strong></h2><p id="7cd0" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我运行了一个简单的实验，两个工具都创建了一个简单的EC2实例。我删除了这两个实例，并尝试再次运行这两个部署步骤。</p><p id="a42f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">隐藏在Terraform的<code class="fe mu mv mw mx b">plan</code>中的是一个<code class="fe mu mv mw mx b"><a class="ae kc" href="https://www.terraform.io/docs/commands/refresh.html" rel="noopener ugc nofollow" target="_blank">refresh</a></code>,用于将您的状态文件与现实世界的基础设施相协调。这意味着Terraform能够检测到删除&amp;启动一个新的实例。CloudFormation没有这样的协调，它依赖于现有的堆栈。因此，它坚称一切都没有改变。解决CloudFormation的唯一方法是重命名EC2资源。</p><p id="0bfb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我不会依赖这个作为和解的银弹，也不会建议手动使用任何工具管理的堆栈。这只会导致心碎💔。</p><h2 id="a0c2" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated"><strong class="ak">功能&amp;插补</strong></h2><p id="5309" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">内在功能是<strong class="kf ir">我最喜欢的cloud formation</strong>部分之一。Terraform确实有比CloudFormation多得多的功能，但我更喜欢CloudFormation使用的语法，没有引号，花括号可以让代码更易读。</p><p id="0b1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我也发现了Terraform的插值在<a class="ae kc" href="https://github.com/hashicorp/terraform/issues/3116" rel="noopener ugc nofollow" target="_blank">某些情况下</a>偶尔的缺点。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/24cdc04d42692c912f77a902199ef0bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Ze6beyYG3cQKaU-qBojkQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">简单的引用比较</figcaption></figure><h2 id="c148" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">有条件部署</h2><p id="e3c2" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">条件部署是任何部署的重要组成部分，无论是生产还是开发，您都希望从同一个堆栈进行部署。但有时生产只是需要额外的资源，反之亦然。</p><p id="e1d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">只有CloudFormation显式支持条件，可以用条件标志标记每个资源。其中as Terraform要求你使用它们的(awesome) <a class="ae kc" href="https://www.terraform.io/intro/examples/count.html" rel="noopener ugc nofollow" target="_blank">计数参数</a>和<a class="ae kc" href="https://www.terraform.io/docs/configuration/interpolation.html" rel="noopener ugc nofollow" target="_blank">三元条件</a>。</p><p id="938f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">count参数是Terraform </strong>独有的，因此CloudFormation需要更多的重复代码。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/b7eb771acfec72e2efc196b785839e3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gU45RsMtoH183ePXDEinIg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">条件句示例</figcaption></figure><h2 id="220b" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">交叉堆栈引用</h2><p id="46a9" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">CloudFormations最强大的特性之一是能够轻松地交叉堆栈引用。这使得打破基础设施的垄断变得极其容易！</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/d4fdf5d9d63a7a7dcd005d033a8e31b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DXVzUb3gqMw79AVfnPRnsg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">跨堆栈引用轻而易举</figcaption></figure><p id="d4eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的例子中，网络堆栈将其<code class="fe mu mv mw mx b">DbSubnet1</code>导出为<code class="fe mu mv mw mx b">${branch}-DbSubnet1</code>。在我的EC2堆栈中，我只是使用<code class="fe mu mv mw mx b">Fn::ImportValue: !Sub ${branch}-DbSubnet1</code>来引用那个子网。CloudFormation也足够聪明，知道EC2栈依赖于网络栈，并且<strong class="kf ir">将拒绝删除它，直到它的依赖性消失。</strong></p><h2 id="0ed7" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">模块</h2><p id="9aa5" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">Terraform独有的<strong class="kf ir">模块是分解您的Terraform部署的非常强大的</strong>方式。Terraform模块本质上是定义一组基础设施的Terraform文件&amp;资源的集合。它允许输入&amp;输出。要使用该模块，您只需将您的输入作为变量传入，Terraform会像往常一样拉入该模块并执行Terraform代码。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/3ca37ec681a3c0e66cc7b681d6cc6dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*Zx0MF6c_V9-l7L1uICHp2g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">重复使用地形模块</figcaption></figure><p id="cc63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面是一个例子，我通过简单地使用一个可重用模块在任何区域定义了许多实例。如果没有这个模块，我将需要定义每个实例和相关的Terraform代码，以便在一个新的区域中设置一个实例。</p><p id="9729" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这与CloudFormation堆栈交叉引用不同的原因是，Terraform状态文件仍将包含所有状态。与CloudFormation一样，状态文件将在每个堆栈之间拆分，使其更易于管理。</p><p id="7369" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> CloudFormation使用嵌套栈</strong>来完成同样的任务。嵌套堆栈的问题是，如果一个子堆栈失败，整个堆栈都会失败。这使得部署痛苦成为噩梦。使用<a class="ae kc" href="http://awsadvent.tumblr.com/post/38685647817/strategies-reusable-cfn-templates" rel="noopener ugc nofollow" target="_blank">分层蛋糕方法</a>和交叉堆栈参考来处理云形成是一条可行之路。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/f8e68dcb85aff67663bce80cce4ad23f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jqEpubHRzojDr-txYSlJsw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">具有嵌套堆栈的云形成</figcaption></figure><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/6d18ef3faad131f4b83961ec92ed3b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpGGI88uwnkfOHW3CuvDhw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">CloudFormation嵌套堆栈web用户界面</figcaption></figure><h2 id="280e" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated"><strong class="ak">用户数据&amp;云形成初始化</strong></h2><p id="bb84" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">CloudFormation还具有<a class="ae kc" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-init.html" rel="noopener ugc nofollow" target="_blank"> CloudFormation init </a>，这是AWS获取您的<a class="ae kc" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html" rel="noopener ugc nofollow" target="_blank">用户数据脚本</a>并将其转换为基于状态的配置的方式。它非常强大，不容忽视。它允许您对实例运行堆栈更新并协调状态。而以前使用用户数据时，您必须终止并创建一个新的实例。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/3b9f9571976a236f941266b38df5232f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*Xb0djOpXjLpyXrQobFwWfQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">一片云开始形成</figcaption></figure><h2 id="ce86" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">错误处理</h2><p id="c888" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">也许我从来都不擅长地形，但我更喜欢CloudFormations处理错误的方式。CloudFormation用户界面非常好，可以很好地概述您的堆栈。我发现在Terraform错误中，虽然他们给你指出了正确的方向，但仍然很难对发生的事情有一个全面的了解。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/44905be7d887e16265d1203445dd953c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gUqPgiekopS8mDc_zCByA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">CloudFormation Events UI跟踪您的堆栈部署，因此您可以很容易地看到出现了什么错误。</figcaption></figure><h2 id="ed35" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated"><strong class="ak">支持</strong></h2><p id="a680" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">你可能会认为CloudFormation会支持现有的所有AWS特性，但是<strong class="kf ir">不幸的是，你错了</strong>。因为开源是最好的，所以Terraform似乎有更多的AWS特性。</p><p id="d6c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">举个例子，<a class="ae kc" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.html" rel="noopener ugc nofollow" target="_blank"> RDS with IAM auth </a>，这个特性已经<strong class="kf ir">发布一年多了</strong>，仍然在CloudFormation backlog中。因为Terraform有一个贡献者<a class="ae kc" href="https://github.com/gazoakley" rel="noopener ugc nofollow" target="_blank">gazo kley</a>,<a class="ae kc" href="https://github.com/hashicorp/terraform/issues/14069" rel="noopener ugc nofollow" target="_blank">做一个简单的PR </a>并且Terraform在云形成之前很好地支持RDS IAM auth。</p><p id="83f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个更重要的例子，没有<a class="ae kc" href="https://aws.amazon.com/secrets-manager/" rel="noopener ugc nofollow" target="_blank">Key Secrets Manager</a>cloud formation支持。从四月开始，terraform拥有自己的<a class="ae kc" href="https://www.terraform.io/docs/providers/aws/r/secretsmanager_secret.html" rel="noopener ugc nofollow" target="_blank">秘密经理</a> <a class="ae kc" href="https://github.com/terraform-providers/terraform-provider-aws/issues/4060" rel="noopener ugc nofollow" target="_blank">资源。</a></p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/e5c1932e682b1621e35132761a4263fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8iF-T5KidPQdlDbxnmFKQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">开源软件是我的最爱</figcaption></figure><p id="319a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不能忘记，Terraform是云不可知的，这是一个巨大的胜利。但我不会把它看得太重，因为据我所见，云提供商非常擅长通过功能或特定代码(如ARNs)来吸引你。</p><p id="6c85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是因为Terraform是云不可知的，它真的可以应用于任何有状态和API的东西。例如<a class="ae kc" href="https://konghq.com/kong-community-edition/" rel="noopener ugc nofollow" target="_blank">孔API网关</a>可以<a class="ae kc" href="https://github.com/WeKnowSports/terraform-provider-kong" rel="noopener ugc nofollow" target="_blank">用Terraform </a>管理。因此，您可以在堆栈中的其他地方应用您所学的技能！</p><h2 id="0877" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">摘要</h2><p id="8f5f" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我喜欢地形和云层，因为它们都是朝着正确方向迈出的一大步。</p><figure class="ls lt lu lv gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/12c69cfa8a4d320fd308f789bfa9deff.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*lKwR1Zha7ocPFzUu3mIf6w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">我的优点和缺点</figcaption></figure><p id="85f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CloudFormation 有一个很棒的用户界面，用于调试和概述正在发生的一切。交叉引用是强大的&amp;使得分离堆栈变得容易，同时我个人非常喜欢它的语法。缺乏支持是我真正的抱怨，因为它不是开源的，不得不使用自定义资源或shell脚本来获得某些功能的想法让我畏缩。😢</p><p id="f403" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> Terraform </strong>很棒，因为它充满活力的开源社区，它简单的模块范式&amp;它是云不可知的。Terraform可能很难通过cli进行调试，通常您最终会得到一个包含所有基础架构的大型整体式repo。你可以把它分解成模块，但是它不像CloudFormation那样具有相同的关注点分离。</p><p id="35b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">感谢阅读！如果你喜欢它，一定要为它鼓掌，并检查一下<strong class="kf ir"/><a class="ae kc" href="https://www.terraform.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">terra form</strong></a><strong class="kf ir">&amp;</strong><a class="ae kc" href="https://aws.amazon.com/cloudformation" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">cloud formation</strong></a><strong class="kf ir">！</strong></strong></p></div></div>    
</body>
</html>