# 对跨平台圣杯的追求。第一部分:离子

> 原文：<https://levelup.gitconnected.com/the-pursuit-of-the-cross-platform-holy-grail-part-1-ionic-2d56b640a6b3>

![](img/0717b0769485e6847149a4280b2cdfd9.png)

Ionic capital |照片由 Yusuf Dündar 在 Unsplash 上拍摄

这是寻找最佳跨平台应用开发框架系列文章的第一部分。传说中的圣杯，你可以倒一次酒，然后在任何地方喝。今天我来讨论一下**离子**的利弊。我会尽量做到客观，但是这个框架浪费了我大量的时间，这让我很难做到。

# 关于我

我从 2012 年开始开发原生 Android 应用。直到 2017 年在爪哇，从 2017 年在科特林。作为我兼职项目的一部分，我还编写 Python 脚本和网站，主要是在 React with TypeScript 中。几年来，我一直在测试各种跨平台技术，这些技术可以节省我的时间，同时让我进入一个新的市场。虽然我很了解 Swift 语言，**但我不想创建两个本地应用** …

# 关于这个系列

![](img/9d6a374e9516429629346eb3bc5ea8fa.png)

詹姆斯·科尔曼在 Unsplash 上拍摄的照片

在注意到许多多平台框架实验的想法和经验后，我产生了这个系列的想法。我注意到有几点通常不会被讨论。营销人员和开发人员不会分享的秘密，但这些秘密非常重要，足以让你重新考虑在项目中使用哪种技术。因为在一个地方收集它们需要很长时间，所以我决定分享它们，希望能节省你的时间并帮助你做决定。

**标题追踪的目标是找到一个首先能在 Android 和 iOS 上运行的框架。支持桌面软件和网站将是一个额外的优势。**

每个跨平台框架在所有声明的平台上都能很好地工作……在会议上。这可能也是你意识到的最大问题。显示“你好，来自 X 平台的世界”没什么大不了的。而且我觉得再也不会有人上当了。我认为即使用汇编语言也可以创建这样一个跨平台的程序。当我们想在工作中，在一个真实的项目中，在生产中使用这样一个框架时，问题就出现了。对本地函数的访问是一个问题。API、数据库、存储访问、摄像头、麦克风、对视图的良好控制、性能。这些才是这个软件面临的真正挑战。

因此，在测试各种框架时，我决定编写真实的、相对复杂的应用程序，这些应用程序将使用一些特定于平台的功能。**让我们一起踏上寻找跨平台圣杯的旅程。**

# 甜蜜的开始

![](img/1ceb4fd7ab292102a4b0f1f6cf0b9fd8.png)

paweczerwiński 在 Unsplash 上拍摄的照片

我使用了**离子**与**反应**和**打字稿**的变体。我主要在安卓系统上测试了原生版本。后来证明，**这可能是最糟糕的组合**。但没有剧透。

与爱奥尼亚的开始非常愉快。我很快构建了一个示例应用程序，并在网站和 Android 上启动了它。一切看起来都很漂亮，看起来像一个现代的本地应用程序。除了 Android 应用程序的几个方面之外，我稍后会回来讨论。

至于性能，它是令人满意的，尽管在工作的后期，当连接到数据库，动态加载内容，最重要的是，打开软键盘时，应用程序开始运行得相当慢。毕竟只是个网站和 JavaScript。我没想到它会快得惊人。

**Ionic 有很多现成的，好看的，一致的组件。有了 CSS 和/或 SCSS，设计也变得容易多了。这绝对是一大利好。不幸的是，**有时事情会因为影子 DOM** 而变得有问题。**

相对于本地编程的一个优势是字体管理和创建视觉主题的简易性。其他优点是**热重装**和强大的`chrome://inspect`，它提供了比原生应用调试器更多的可能性。通常，这些是任何基于 web 技术的框架的特性。

至于语言(我的情况是 TypeScript)，和 Kotlin、Swift 差别不大，所以用它写还是挺友好的。我经历的唯一缺点(与原生开发相比)是重构的问题和其他智能工具的缺乏。但是我意识到这是一个 IDE (Visual Studio 代码)问题，所以我只把它作为一个提示留给那些考虑从 IntelliJ IDEA/Android Studio 转换的人。然而，我认为这一点并不适用于 WebStorm。

# 宽容的中间派

![](img/31ddfba6260ac6847d104b216b997617.png)

照片由 Lenny Miles 在 Unsplash 上拍摄

这项工作快如闪电，令人愉快。直到我开始实现特定于平台的特性。我可以就此写一整篇文章。`if…else`阻止检查应用程序运行的平台可能不是“一次编写，随处运行”的想法。但是我原谅了爱奥尼亚。我节省了很多创建布局的时间。那要花很多时间。更长的时间才能完成。此外，如果我想支持 iOS，我会花两次时间；如果我还想拥有一个网站，我会花三次时间。我心想:“作为回报，我可以在其他事情上多花一点时间。”

所以我专注于网站的原型制作，**希望添加 Android 和 iOS 支持最多需要几个工作日**。毕竟，添加正确的插件和实现简单的接口需要多长时间，对吗？嗯，**那是我的一个巨大的错误**。

当我几乎完成了我在 Ionic 中的漂亮应用程序时，是时候回到它在 Android 平台上的实现这个话题了。小菜一碟。连接适当的数据库管理系统、外部存储处理和其他基本功能。

此外，还有一些事情需要纠正。它们从一开始就不太管用，但我把它们看得很轻。

我忽略了在 Ionic 中生成的应用程序使用 Java 的事实。那是 2019 年，所以在 Kotlin 被宣布为官方语言两年后，尽管如此，我完全明白迁移可能是无利可图的。另一方面，转换主要归结为在 IDE 中单击一个按钮。没关系。

**首先要解决的是安卓系统，或者说是它的缺失。**就我对 Java 的了解，我不明白为什么 Ionic 团队没有放弃已经废弃的支持库。与移植到 Kotlin 类似，这也需要在 IDE 中只选择一个选项。

应用程序要修复的第二个特性是……黑色导航和状态栏。太多了…我想起了我在 2012 年开始写的第一个 Android 应用程序。自那时以来，这方面发生了很大变化。首先，你可以设置自己的颜色，现在你可以让它完全透明。

**最后一件事是彻头彻尾的离奇。默认的 Ionic 应用程序…不能用后退按钮关闭。我不是在开玩笑。你必须按下 home 键才能退出用 Ionic 编写的应用程序。我不知道 Ionic 的 Android 团队怎么会忽略这一点。顺便提一下，在基于 WebView 的应用程序中管理后退按钮的代码如下所示:**

```
override fun onBackPressed() {
    if (webView.canGoBack()) {
        webView.goBack()
    } else {
        super.onBackPressed()
    }
}
```

在 Java 中:

```
@Override
public void onBackPressed() {
    if (webView.canGoBack()) {
        webView.goBack();
     } else {
        super.onBackPressed();
     }
}
```

在我看来，这不需要专业知识或大量的时间。如果不是 bug 而是特性，有人可以开导一下。

根据[这个线程](https://forum.ionicframework.com/t/v4-back-button-doesnt-exit-app-solved-tutorial/149994)，2020 年底他们还有这个问题。

# 痛苦的结局

![](img/84adedc8de739f4d5e41255a0797e2fc.png)

丹-克里斯蒂安·pădureț在 Unsplash 上拍摄的照片

## 几周后…

**用于从 SD 卡读写文件的插件。它有毛病。它在一个未知的位置创建文件，并且完全没有控制权。新机器人的权限问题。几天的搜索未能找到解决办法。大概[这个线程](https://forum.ionicframework.com/t/how-to-read-file-as-array-from-sd-card-with-cordova-plugin-file/133783)是相关的。**

**我也没能在 Android 上完全连接数据库。但是那已经是绝望的阶段了，所以也许再花几天时间，它最终会解决。**

最后，让我总结一下**离子**的三个最重要的问题。

**Android 应用程序生成。**虽然这对 web 开发人员来说可能是一个优势，但是**有本地开发经验的程序员会觉得他们的手被束缚了**。意味着你连我之前说的几个基本功能都不能轻易搞定。迟早你将不得不同步项目，它将删除手动输入的更改。据我所知，唯一的解决办法是编写自己的插件。关闭应用程序的插件？使状态栏着色或透明的插件？让我们尊重彼此的时间，好吗？

**暗影 DOM。整个 DOM 隐藏在 Ionic 抽象之后。也许这没什么不对。如果这个抽象层能够正常工作并允许对 DOM、HTML 和 CSS 进行完全控制(如果你愿意的话，也可以进行监督)就好了。然而，事实并非如此。例如，当我在处理应用程序时，不可能以编程方式将页面滚动到给定的元素。**Ionic 接口有问题，直接访问被阻止。对于一个开发人员来说，没有什么比无法控制自己的程序更糟糕的了。尤其是以一些不起作用的东西的名义。**你可以在这里看看别人对 Ionic [引入 shadow DOM 的看法。](https://ionicframework.com/blog/shadow-dom-in-ionic-and-why-its-awesome/#disqus_thread)**

在介绍中，我写道，React、TypeScript 和 Android 是与 Ionic 一起工作的最差组合。现在我来解释一下原因。一开始，Ionic 只支持 Angular。因此，大多数文档都是为此框架编写的。**而且，还有 Angular 专属的插件。别无选择。**我写应用的时候，对 React 的支持很差。安卓也是如此。你一眼就能看出，iOS 是 Ionic 团队的优先选择。【React 支持差 Android 支持差=开发者自行开发。

# 愤怒戒了

不。太多了。我在一个框架上浪费了几个月的时间，**结果证明根本不是跨平台的**。唯一管用的是网站。最糟糕的是，**Ionic 的开发者控制了项目**的程序员，把他们当成孩子，这导致了“要么全有，要么全无”的方法。如果不是这些荒谬的错误，**我的应用可能已经在 Google Play 和苹果商店**上发布了。但是在这种情况下…我选择了“什么都不做”这个选项。我开始从这个 React 项目中移除 Ionic。我甚至为此写了一个 Python 脚本。顺便说一下，它可以在 GitHub 上找到。

[](https://github.com/KajetanSuchanski/Ionic-Remover) [## KajetanSuchanski/离子去除剂

### 这个 Python 脚本将帮助你从 React 应用中去掉 Ionic 和 Capacitor。成功删除后，它…

github.com](https://github.com/KajetanSuchanski/Ionic-Remover) 

我决定保留 ReactJS(这是一个很棒的库)，添加 Material-UI(这是另一个很棒的库)并手动编写 Android 和 iOS 应用程序来显示这个网站。

在追求跨平台圣杯系列的下一部分中，我将写独立的 **ReactJS** 以及 **React Native** 作为跨平台技术**。**

# 结论

每当不好的事情发生在我身上，或者我浪费了太多的时间，我会对自己说“至少我有了新的体验。”这次也没什么不同。**我很感激 Ionic 改变了我的应用程序开发方法以及框架、库等的实现。现在我更加怀疑，不再相信、假设和“一切都会好的”态度。在使用其他框架时，我首先创建了所有函数的最简单的原型(尤其是原生函数)。只是在那之后，我继续在细节上努力。**

# 诚实的笔记

正如我在开头所说，我在 2019 年正在开发应用程序。也许到那时，一些事情已经被修复了(尽管前面提到的论坛帖子指出了一些别的事情)。还值得强调的是，其中一些问题属于科尔多瓦/电容器。但是 Ionic 没有电容是不行的，自然要把它们放在一起。科尔多瓦本身不会包含在这个系列的文章中。恕我直言，尽管这项技术可能是其他框架的有趣基础，但它本身用处不大。

# 编后记

如果你觉得这篇文章有趣并且有帮助，请留下👏并考虑在评论中分享你的想法。**欢迎任何形式的反馈**。

# 下一步是什么

[](/what-is-the-context-in-object-oriented-programming-9dda02d3328d) [## 面向对象编程中的上下文是什么？

### 这个问题永远改变了我对面向对象编程的看法。那是几年前，我偶然发现…

levelup.gitconnected.com](/what-is-the-context-in-object-oriented-programming-9dda02d3328d) [](/strongly-flavored-android-application-for-3-huge-corporations-a1dd07ebc6ad) [## 为 3 家大公司开发的味道浓郁的 Android 应用程序

### 这篇文章的灵感来自真实事件。一些人物，名字，商业，事件和某些地点和…

levelup.gitconnected.com](/strongly-flavored-android-application-for-3-huge-corporations-a1dd07ebc6ad)