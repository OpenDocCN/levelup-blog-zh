<html>
<head>
<title>Create tooling to understand AppleScript better— Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建工具以更好地理解AppleScript第3部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tooling-to-explore-applescript-part-3-4da8f82fbfa5?source=collection_archive---------6-----------------------#2021-12-07">https://levelup.gitconnected.com/tooling-to-explore-applescript-part-3-4da8f82fbfa5?source=collection_archive---------6-----------------------#2021-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="0657" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://gentille.us/applescript-articles-7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank"> AppleScript课程</a></h2><div class=""/><div class=""><h2 id="9cdd" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">是时候“嵌套和讲述”了，探索系统事件应用程序，并使用辅助功能导航器</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/dd2ccbaa7530bc32c90ff1e9537a44be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1UzzvUo5owZoTnDa8RLcJA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">浏览AppleScript的更多技巧</figcaption></figure><p id="f30b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">本文显示的所有代码都可以通过</em> <a class="ae mb" href="https://github.com/Rolias/discover-applescript/tree/main/03-Tooling" rel="noopener ugc nofollow" target="_blank"> <em class="ma">关联GitHub repo </em> </a> <em class="ma">获得。</em></p><h1 id="3c72" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">前情提要…</h1><p id="1f56" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">在<a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/create-tooling-to-understand-applescript-better-part-1-2727d6dbac83">第1部分</a>和<a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/tooling-to-explore-applescript-part-2-ed44f511fcb5?sk=1b840e74bae523c82d07c893f9513bcb">第2部分</a>中，我们构建了许多脚本，我们知道如何找到窗口、窗格、锚点和显示信息。现在是时候进行交互了，深入到层次结构中去找到我们需要控制的确切项目。</p><h1 id="639c" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">相互作用</h1><p id="2195" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">我们已经做了一些小的互动，比如让想要的锚出现。当我们想要更进一步，开始输入文本和点击按钮时，我们将想要再次使用字典并打开<code class="fe mz na nb nc b">System Events </code>应用程序。我们要做的第一件事是学会将我们未来所有的命令指向正确的过程。</p><h1 id="c3e8" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">流程套件</h1><p id="b2e6" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">我们可以看到系统事件应用程序有一个带有<code class="fe mz na nb nc b">processes</code>集合的<code class="fe mz na nb nc b">Processes Suite</code>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nd"><img src="../Images/b659b48683d8e1b8bfb0453d0dde9f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aj5rz5jOXN559ZgL3TAi6w.png"/></div></div></figure><p id="ac9e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们可以用这个脚本在结果窗口中列出所有可用的进程。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/5f450feb461bdacfb397ef9143f344a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*zSTv9yicbuHmKkLcD8YsUg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">获取系统事件流程</figcaption></figure><p id="b7f5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们想要的过程就在那里，方便地命名为“系统偏好”。</p><h1 id="476d" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">嵌套Tell块</h1><p id="7bb5" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">我们可以通过嵌套两个tell语句将命令指向<code class="fe mz na nb nc b"> System Events</code>应用程序的<code class="fe mz na nb nc b">System Preferences</code>进程，如下面脚本的第二块所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6e14ae59d02f647ddf572fc183c531cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*BMjDdQkczoUs587TbgpB7w.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">两个街区的故事</figcaption></figure><p id="4cab" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们的第一个tell块和之前几乎一样，只是使用了窗格的id<code class="fe mz na nb nc b">com.apple.preference.displays</code>而不是名称<code class="fe mz na nb nc b">"Displays".</code></p><p id="16ff" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">第二个tell块有嵌套。有一个外部的<code class="fe mz na nb nc b">tell</code>将我们的代码指向<code class="fe mz na nb nc b">System Events</code>应用程序。在里面我们有第二个嵌套的tell，进一步将我们的命令指向<code class="fe mz na nb nc b">System Events.</code>的<code class="fe mz na nb nc b">System Preferences</code>进程，然后我们请求所有的<code class="fe mz na nb nc b">UI elements of window 1.</code></p><p id="40ac" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">不需要嵌套tell块，我们可以很容易地为<code class="fe mz na nb nc b">System Events</code>使用一个tell块，然后使用一个长行<code class="fe mz na nb nc b">get UI elements of window 1 of process “System Preferences”.</code>。你可以想象，如果我们需要针对流程执行一些任务，我们会厌倦向我重复短语<code class="fe mz na nb nc b">of process "System Preferences.</code>,嵌套方法也更具可读性。</p><h1 id="043e" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">UI元素</h1><p id="fe54" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">UI元素记录在系统事件字典中。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/df67757577fa3bca648f28adcd1d9176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*sDOUttl_DfuJRoF35ssgBA.png"/></div></figure><p id="5667" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">获取UI元素列表通常是我们构造脚本所需要的。有些项目是不言自明的，如<code class="fe mz na nb nc b">button "Gather Windows",</code>，但其他如<code class="fe mz na nb nc b">button 3</code>或<code class="fe mz na nb nc b">tab group 1</code>呈现出更多的神秘。</p><h1 id="6ead" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">解开谜团</h1><p id="791d" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated"><code class="fe mz na nb nc b">Accessibility Inspector</code>可以帮助我们揭开一般命名的UI元素的神秘面纱。安装XCode后，您可以使用Spotlight并按名称搜索来启动它。或者，您可以启动XCode并使用<code class="fe mz na nb nc b">XCode→Open Developer Tool ›</code>菜单，然后选择辅助功能检查器菜单项。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/74dfa6aace7b660864133d883b3a07ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*6reUeDqzkF3svpms3FWuuw.png"/></div></figure><h1 id="b68f" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">授权吧</h1><p id="c9ef" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">打开系统偏好设置，在<code class="fe mz na nb nc b">Security &amp; Privacy</code>窗格中点击<code class="fe mz na nb nc b">Privacy </code>选项卡，然后点击左侧表格的<code class="fe mz na nb nc b">Accessibility</code>行。点按锁图标，并使用您的密码来解锁面板的右侧。然后使用+按钮添加<code class="fe mz na nb nc b">Accessibility Inspector </code>应用程序。</p><h1 id="ab39" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">使用它</h1><p id="e43c" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">在辅助功能检查器中，点击下图中蓝色的目标图标。然后将光标移动到您想要与之交互的应用程序，并选择一个项目。在下图中，我点击了<code class="fe mz na nb nc b">Scaled</code>按钮。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ni"><img src="../Images/e397fed07d3c0a134ba18d09b1707fa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*afHkZ2dUot9Bq__F2HMsBQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">使用辅助功能检查器定位用户界面元素</figcaption></figure><p id="809f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">辅助功能检查器的层次结构部分将填充我们需要的所有信息以及更多信息。上图读起来有点吃力。下面我只添加了层次结构。请注意，目标图标(由添加的橙色箭头指向)显示了层次结构中所选的特定项目。在层次结构中的同一级别还有许多其他项目。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/99e42011999662d5972a38b27614a1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*zCeHSC6LA70tHeWshTMLHg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">瞄准缩放的单选按钮</figcaption></figure><h1 id="d201" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">点击按钮</h1><p id="0bbc" class="pw-post-body-paragraph le lf iq lg b lh mu ka lj lk mv kd lm ln mw lp lq lr mx lt lu lv my lx ly lz ij bi translated">现在我们已经获得了点击<code class="fe mz na nb nc b">Scaled</code>按钮所需的所有信息。我们可以看到它是<code class="fe mz na nb nc b">tab group 1</code>的一部分，而<code class="fe mz na nb nc b">tab group 1</code>又是<code class="fe mz na nb nc b">window "ASUS PB278 (1)"</code>的一部分(至少现在是索引1)。下面是点击按钮的完整脚本。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/d540038023004192fac9f85cc922a94e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*B6Fb2YqxzCpLG6xd6nozwQ.png"/></div></figure><p id="adfb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">看起来我花了很长时间来向你展示如何点击一个按钮。我同意这一点，但我希望<strong class="lg ja">你</strong>会同意你已经积累了一套工具，可以让你自己点击按钮和更多。</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="80f7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这不是我们学习旅程的终点。让脚本可重复可靠地运行仍然有一些关键的概念，我们将在以后的文章中探索这些想法，因为我们将增强我们的系统偏好脚本，使其变得更加有用。参见本系列(目前)所有文章的<a class="ae mb" href="https://gentille.us/7f82c319d46?sk=0ad4bf43fb9356f9e647c970cb12c31f" rel="noopener ugc nofollow" target="_blank">概述。</a></p></div></div>    
</body>
</html>