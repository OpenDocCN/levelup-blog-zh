<html>
<head>
<title>Tutorial: Generate Swagger Specification and SwaggerUI for Gin Go Web Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:为Gin Go Web框架生成Swagger规范和SwaggerUI</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tutorial-generate-swagger-specification-and-swaggerui-for-gin-go-web-framework-9f0c038483b5?source=collection_archive---------2-----------------------#2021-04-15">https://levelup.gitconnected.com/tutorial-generate-swagger-specification-and-swaggerui-for-gin-go-web-framework-9f0c038483b5?source=collection_archive---------2-----------------------#2021-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="2969" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">为什么选择Gin Web Framework？</h1><p id="75ab" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Gin是最流行的围棋框架之一。用起来很简单。</p><h1 id="a5c6" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">为什么要Swagger规范？</h1><p id="721e" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">编写规格说明书是软件工程中一个细致的过程。不管怎样，如果我们想让其他人使用我们的API，这是必要的。它帮助其他人更轻松地集成没有API的组件。文档越好，其他人就越容易将它集成到他们的系统中。为了解决这个问题，我们应该遵循行业内创建API文档的标准化方式，<strong class="kn ir"> </strong> <em class="lj"> OpenAPI规范或</em>原名Swagger规范。</p><blockquote class="lk ll lm"><p id="7c13" class="kl km lj kn b ko ln kq kr ks lo ku kv lp lq ky kz lr ls lc ld lt lu lg lh li ij bi translated">OpenAPI规范，以前被称为Swagger规范，是定义RESTful接口的世界标准。OAS使开发人员能够设计一个技术不可知的API接口，该接口构成了他们的API开发和消费的基础。</p></blockquote></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><h1 id="30c8" class="jn jo iq bd jp jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk bi translated">先决条件</h1><p id="9de0" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">你需要在你的机器上安装Go版本≥1.14。</p><h1 id="0875" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">步伐</h1><ol class=""><li id="5a0c" class="mh mi iq kn b ko kp ks kt kw mj la mk le ml li mm mn mo mp bi translated">创建文件夹进行开发，我们将调用app <em class="lj"> ginsimple </em>。</li></ol><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="890d" class="mz jo iq mv b gy na nb l nc nd">$ mkdir ginsimple<br/>$ mkdir docs<br/>$ mkdir docs/ginsimple</span></pre><p id="cb0b" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">2.为go供应商系统初始化go模式。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="b0be" class="mz jo iq mv b gy na nb l nc nd">$ go mod init</span></pre><p id="ebc1" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">3.拉<em class="lj">轧棉</em>库。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="8537" class="mz jo iq mv b gy na nb l nc nd">$ go get -u github.com/gin-gonic/gin</span></pre><p id="7dd2" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">4.在<em class="lj"> ginsimple </em>文件夹中，创建一个新文件<em class="lj"> main.go </em>并复制<em class="lj">下面的代码。</em></p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="6dda" class="mz jo iq mv b gy na nb l nc nd"><strong class="mv ir">package </strong>main<br/><br/><strong class="mv ir">import </strong>(<br/>   "log"<br/>   "net/http"<br/><br/>   "github.com/gin-gonic/gin"<br/>)<br/><br/><strong class="mv ir">func </strong>main() {<br/>   // Gin instance<br/>   <em class="lj">r </em>:= gin.New()<br/><br/>   // Routes<br/>   <em class="lj">r</em>.GET("/", HealthCheck)<br/><br/>   // Start server<br/>   <strong class="mv ir">if </strong><em class="lj">err </em>:= <em class="lj">r</em>.Run(":3000"); <em class="lj">err </em>!= <strong class="mv ir">nil </strong>{<br/>      log.Fatal(<em class="lj">err</em>)<br/>   }<br/>}<br/><br/><strong class="mv ir">func </strong>HealthCheck(<em class="lj">c </em>*gin.Context) {<br/>   <em class="lj">res </em>:= <strong class="mv ir">map</strong>[string]<strong class="mv ir">interface</strong>{}{<br/>      "data": "Server is up and running",<br/>   }<br/><br/>   <em class="lj">c</em>.JSON(http.<em class="lj">StatusOK</em>, <em class="lj">res</em>)<br/>}</span></pre><p id="7501" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">5.运行应用程序。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="ac70" class="mz jo iq mv b gy na nb l nc nd">$ go run ginsimple/main.go</span></pre><p id="1d71" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">您应该会看到如下所示的输出。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="98ef" class="mz jo iq mv b gy na nb l nc nd">[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production. <br/> - using env:   export GIN_MODE=release <br/> - using code:  gin.SetMode(gin.ReleaseMode) <br/> <br/>[GIN-debug] GET / --&gt; main.HealthCheck (1 handlers) <br/>[GIN-debug] Listening and serving HTTP on :3000</span></pre><p id="7d18" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">这意味着我们的服务器在端口3000上启动并运行。</p><p id="46e0" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">6.通过添加<em class="lj">声明性注释格式</em>来更新我们的<em class="lj"> main.go </em>。这些注释将在后面被用来自动生成<em class="lj"> Swagger规格说明</em>。您可以使用参考资料中的链接了解更多关于<em class="lj">声明性注释格式</em>的信息。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="6fad" class="mz jo iq mv b gy na nb l nc nd"><strong class="mv ir">package </strong>main<br/><br/><strong class="mv ir">import </strong>(<br/>   "log"<br/>   "net/http"<br/><br/>   "github.com/gin-gonic/gin"<br/>)</span><span id="9a6f" class="mz jo iq mv b gy ne nb l nc nd">// @title Gin Swagger Example API<br/>// @version 1.0<br/>// @description This is a sample server server.<br/>// @termsOfService http://swagger.io/terms/<br/><br/>// @contact.name API Support<br/>// @contact.url http://www.swagger.io/support<br/>// @contact.email support@swagger.io<br/><br/>// @license.name Apache 2.0<br/>// @license.url http://www.apache.org/licenses/LICENSE-2.0.html<br/><br/>// @host localhost:3000<br/>// @BasePath /<br/>// @schemes http<br/><strong class="mv ir">func </strong>main() {<br/>   // Gin instance<br/>   <em class="lj">r </em>:= gin.New()<br/><br/>   // Routes<br/>   <em class="lj">r</em>.GET("/", HealthCheck)<br/><br/>   // Start server<br/>   <strong class="mv ir">if </strong><em class="lj">err </em>:= <em class="lj">r</em>.Run(":3000"); <em class="lj">err </em>!= <strong class="mv ir">nil </strong>{<br/>      log.Fatal(<em class="lj">err</em>)<br/>   }<br/>}</span><span id="59ae" class="mz jo iq mv b gy ne nb l nc nd">// HealthCheck godoc<br/>// @Summary Show the status of server.<br/>// @Description get the status of server.<br/>// @Tags root<br/>// @Accept */*<br/>// @Produce json<br/>// @Success 200 {object} map[string]interface{}<br/>// @Router / [get]<br/><strong class="mv ir">func </strong>HealthCheck(<em class="lj">c </em>*gin.Context) {<br/>   <em class="lj">res </em>:= <strong class="mv ir">map</strong>[string]<strong class="mv ir">interface</strong>{}{<br/>      "data": "Server is up and running",<br/>   }<br/><br/>   <em class="lj">c</em>.JSON(http.<em class="lj">StatusOK</em>, <em class="lj">res</em>)<br/>}</span></pre><p id="5c0a" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">7.拉招摇图书馆。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="1e5b" class="mz jo iq mv b gy na nb l nc nd">$ go get -v github.com/swaggo/swag/cmd/swag<br/>$ go get -v github.com/swaggo/gin-swagger<br/>$ go get -v github.com/swaggo/files</span></pre><p id="336f" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">8.生成<em class="lj">摆动规格</em>。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="7052" class="mz jo iq mv b gy na nb l nc nd">$ swag init -g ginsimple/main.go --output docs/ginsimple</span></pre><p id="5f64" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">如果操作成功，您应该会在文件夹<em class="lj"> docs/ginsimple中看到3个新文件。这些文件是:</em></p><ul class=""><li id="eaaa" class="mh mi iq kn b ko ln ks lo kw nf la ng le nh li ni mn mo mp bi translated"><em class="lj"> docs.go </em> = &gt;需要生成<em class="lj">swaggeri</em>。</li><li id="f99e" class="mh mi iq kn b ko nj ks nk kw nl la nm le nn li ni mn mo mp bi translated"><em class="lj">Swagger . JSON</em>=&gt;<em class="lj">Swagger规范</em>中的<em class="lj"> json </em>文件格式。</li><li id="ad03" class="mh mi iq kn b ko nj ks nk kw nl la nm le nn li ni mn mo mp bi translated"><em class="lj">Swagger . YAML</em>=&gt;<em class="lj">中的</em>Swagger规范<em class="lj"> yaml </em>文件格式。</li></ul><p id="f2ae" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">如果您使用<a class="ae no" href="https://www.atlassian.com/software/confluence" rel="noopener ugc nofollow" target="_blank"><em class="lj">Confluence</em></a><em class="lj"/>来分发您的文档，您可以在<a class="ae no" href="https://www.atlassian.com/software/confluence" rel="noopener ugc nofollow" target="_blank"><em class="lj">Confluence</em></a><em class="lj"/>中创建一个新文件，并选择添加OpenAPI规范。然后复制粘贴<em class="lj"> swagger.yaml </em>内容在里面。</p><p id="b64a" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">9.更新<em class="lj">main . go to</em>add<em class="lj">swaggeri。</em></p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="ae00" class="mz jo iq mv b gy na nb l nc nd"><strong class="mv ir">package </strong>main<br/><br/><strong class="mv ir">import </strong>(<br/>   "log"<br/>   "net/http"<br/><br/>   "github.com/gin-gonic/gin"<br/>   _ "github.com/rizalgowandy/go-swag-sample/docs/ginsimple" <strong class="mv ir">// you need to update github.com/rizalgowandy/go-swag-sample with your own project path</strong><br/>   swaggerFiles "github.com/swaggo/files"<br/>   ginSwagger "github.com/swaggo/gin-swagger"<br/>)<br/><br/>// @title Gin Swagger Example API<br/>// @version 2.0<br/>// @description This is a sample server server.<br/>// @termsOfService http://swagger.io/terms/<br/><br/>// @contact.name API Support<br/>// @contact.url http://www.swagger.io/support<br/>// @contact.email support@swagger.io<br/><br/>// @license.name Apache 2.0<br/>// @license.url http://www.apache.org/licenses/LICENSE-2.0.html<br/><br/>// @host localhost:3000<br/>// @BasePath /<br/>// @schemes http<br/><strong class="mv ir">func </strong>main() {<br/>   // Gin instance<br/>   <em class="lj">r </em>:= gin.New()<br/><br/>   // Routes<br/>   <em class="lj">r</em>.GET("/", HealthCheck)<br/><br/>   <em class="lj">url </em>:= ginSwagger.URL("http://localhost:3000/swagger/doc.json") // The url pointing to API definition<br/>   <em class="lj">r</em>.GET("/swagger/*any", ginSwagger.WrapHandler(swaggerFiles.<strong class="mv ir">Handler</strong>, <em class="lj">url</em>))<br/><br/>   // Start server<br/>   <strong class="mv ir">if </strong><em class="lj">err </em>:= <em class="lj">r</em>.Run(":3000"); <em class="lj">err </em>!= <strong class="mv ir">nil </strong>{<br/>      log.Fatal(<em class="lj">err</em>)<br/>   }<br/>}<br/><br/>// HealthCheck godoc<br/>// @Summary Show the status of server.<br/>// @Description get the status of server.<br/>// @Tags root<br/>// @Accept */*<br/>// @Produce json<br/>// @Success 200 {object} map[string]interface{}<br/>// @Router / [get]<br/><strong class="mv ir">func </strong>HealthCheck(<em class="lj">c </em>*gin.Context) {<br/>   <em class="lj">res </em>:= <strong class="mv ir">map</strong>[string]<strong class="mv ir">interface</strong>{}{<br/>      "data": "Server is up and running",<br/>   }<br/><br/>   <em class="lj">c</em>.JSON(http.<em class="lj">StatusOK</em>, <em class="lj">res</em>)<br/>}</span></pre><p id="beaa" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">如你所见，我们在<em class="lj"> main.go. </em>上添加了两个重要的东西</p><ul class=""><li id="5637" class="mh mi iq kn b ko ln ks lo kw nf la ng le nh li ni mn mo mp bi translated"><em class="lj">swaggeri</em>的新路线。</li></ul><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="c229" class="mz jo iq mv b gy na nb l nc nd"><em class="lj">url </em>:= ginSwagger.URL("http://localhost:3000/swagger/doc.json") // The url pointing to API definition<br/><em class="lj">r</em>.GET("/swagger/*any", ginSwagger.WrapHandler(swaggerFiles.<strong class="mv ir">Handler</strong>, <em class="lj">url</em>))</span></pre><ul class=""><li id="a497" class="mh mi iq kn b ko ln ks lo kw nf la ng le nh li ni mn mo mp bi translated">新导入为生成的<em class="lj"> docs.go </em>和<em class="lj"> swag </em>库。不要忘记用你的项目路径替换github.com/rizalgowandy/go-swag-sample路径。</li></ul><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="d5ea" class="mz jo iq mv b gy na nb l nc nd">import (<br/>   ...<br/>   _ "github.com/rizalgowandy/go-swag-sample/docs/ginsimple" <strong class="mv ir">// you need to update github.com/rizalgowandy/go-swag-sample with your own project path</strong><br/>   swaggerFiles "github.com/swaggo/files"<br/>   ginSwagger "github.com/swaggo/gin-swagger"<br/>   ...<br/>)</span></pre><p id="7b42" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">10.最后，再次运行app。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="2247" class="mz jo iq mv b gy na nb l nc nd">$ go run ginsimple/main.go</span></pre><p id="aef6" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">11.现在尝试，调用新添加的路由。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="d547" class="mz jo iq mv b gy na nb l nc nd">$ curl localhost:3000/swagger/doc.json</span></pre><p id="992b" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">您应该会看到如下输出。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="e8f2" class="mz jo iq mv b gy na nb l nc nd">// 20210415135919<br/>// <a class="ae no" href="http://localhost:3000/swagger/doc.json" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/swagger/doc.json</a></span><span id="451a" class="mz jo iq mv b gy ne nb l nc nd">{<br/>  "schemes": [<br/>    "http"<br/>  ],<br/>  "swagger": "2.0",<br/>  "info": {<br/>    "description": "This is a sample server server.",<br/>    "title": "Gin Swagger Example API",<br/>    "termsOfService": "<a class="ae no" href="http://swagger.io/terms/" rel="noopener ugc nofollow" target="_blank">http://swagger.io/terms/</a>",<br/>    "contact": {<br/>      "name": "API Support",<br/>      "url": "<a class="ae no" href="http://www.swagger.io/support" rel="noopener ugc nofollow" target="_blank">http://www.swagger.io/support</a>",<br/>      "email": "<a class="ae no" href="mailto:support@swagger.io" rel="noopener ugc nofollow" target="_blank">support@swagger.io</a>"<br/>    },<br/>    "license": {<br/>      "name": "Apache 2.0",<br/>      "url": "<a class="ae no" href="http://www.apache.org/licenses/LICENSE-2.0.html" rel="noopener ugc nofollow" target="_blank">http://www.apache.org/licenses/LICENSE-2.0.html</a>"<br/>    },<br/>    "version": "2.0"<br/>  },<br/>  "host": "localhost:3000",<br/>  "basePath": "/",<br/>  "paths": {<br/>    "/": {<br/>      "get": {<br/>        "description": "get the status of server.",<br/>        "consumes": [<br/>          "*/*"<br/>        ],<br/>        "produces": [<br/>          "application/json"<br/>        ],<br/>        "tags": [<br/>          "root"<br/>        ],<br/>        "summary": "Show the status of server.",<br/>        "responses": {<br/>          "200": {<br/>            "description": "OK",<br/>            "schema": {<br/>              "type": "object",<br/>              "additionalProperties": true<br/>            }<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</span></pre><p id="590d" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">12.使用此URL在浏览器中打开SwaggerUI。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="b872" class="mz jo iq mv b gy na nb l nc nd"><a class="ae no" href="http://localhost:3000/swagger/index.html" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/swagger/index.html</a></span></pre><p id="a190" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">您应该会看到如下输出。</p><figure class="mq mr ms mt gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi np"><img src="../Images/f46e8d5d05c048a9a0edfd821bf9c42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cxgihTKKB3J1R34pcL7Mzg.png"/></div></div><figcaption class="nx ny gj gh gi nz oa bd b be z dk translated">OpenAPI规范用户界面</figcaption></figure><p id="8305" class="pw-post-body-paragraph kl km iq kn b ko ln kq kr ks lo ku kv kw lq ky kz la ls lc ld le lu lg lh li ij bi translated">瞧，我们完成了。我们使用<em class="lj"> Gin </em>框架成功创建了一个简单的Go web服务器，并生成了<strong class="kn ir"><em class="lj"/></strong><em class="lj">Swagger规范</em>和<em class="lj"> SwaggerUI </em>。</p><h1 id="cbba" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">参考</h1><ul class=""><li id="15f5" class="mh mi iq kn b ko kp ks kt kw mj la mk le ml li ni mn mo mp bi translated"><strong class="kn ir">来源:【https://github.com/rizalgowandy/go-swag-sample】T22</strong></li><li id="7ec8" class="mh mi iq kn b ko nj ks nk kw nl la nm le nn li ni mn mo mp bi translated"><strong class="kn ir">声明式评论格式:</strong><a class="ae no" href="https://github.com/swaggo/swag#declarative-comments-format" rel="noopener ugc nofollow" target="_blank">https://github.com/swaggo/swag#declarative-comments-format</a></li></ul></div></div>    
</body>
</html>