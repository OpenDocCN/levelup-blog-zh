<html>
<head>
<title>How To Undo ‘git add’ Before a Commit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在提交前撤消“git add”</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/undo-git-add-before-commit-2c80e2434688?source=collection_archive---------6-----------------------#2022-05-03">https://levelup.gitconnected.com/undo-git-add-before-commit-2c80e2434688?source=collection_archive---------6-----------------------#2022-05-03</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="45e6" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">在git中执行提交之前，撤消Git添加</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e134dcec15f020709b827e2c776ca60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*poVqhn3nbvTSeNlajRO8yw.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@synkevych?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Roman Synkevych </a>在<a class="ae kz" href="https://unsplash.com/s/photos/git?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="ac7e" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">我们经常错误地使用<code class="fe mp mq mr ms b">git add</code>将文件添加到下一次提交中。该命令将使用工作树中的内容更新索引，并为即将到来的提交准备暂存的内容。在提交之前可以多次执行<code class="fe mp mq mr ms b">git add</code>命令，它只添加指定文件的内容(或者您可以使用<code class="fe mp mq mr ms b">.</code>符号添加自上次提交以来更新的所有跟踪文件)。</p><p id="8723" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">在今天的简短教程中，我们将展示如何在执行<code class="fe mp mq mr ms b">git commit</code>之前撤销一个<code class="fe mp mq mr ms b">git add</code>命令，以防你错误地包含了一个或多个文件。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="bdbf" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">首先，让我们假设我们目前正在处理一个Git分支，它包含以下跟踪和未跟踪的文件，其中的更改尚未提交:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="9722" class="la lb iu ms b gz nj nk l nl nm">$ git status<br/>Your branch is up to date with 'origin/feature/example-branch'.</span><span id="baa8" class="la lb iu ms b gz nn nk l nl nm">Changes not staged for commit:<br/>  (use "git add &lt;file&gt;..." to update what will be committed)<br/>  (use "git restore &lt;file&gt;..." to discard changes in working directory)<br/>        modified:   mypackage/module_1.py<br/>        modified:   mypackage/module_2.py<br/>        modified:   mypackage/module_3.py<br/>        modified:   mypackage/mysubpackage/another_module.py</span><span id="a3e6" class="la lb iu ms b gz nn nk l nl nm">Untracked files:<br/>  (use "git add &lt;file&gt;..." to include in what will be committed)<br/>        data/my_data_file.txt</span><span id="967b" class="la lb iu ms b gz nn nk l nl nm">no changes added to commit (use "git add" and/or "git commit -a")</span></pre><p id="b040" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">现在假设我们想要将三个文件<code class="fe mp mq mr ms b">mypackage/module_1.py</code>、<code class="fe mp mq mr ms b">mypackage/module_3.py</code>和<code class="fe mp mq mr ms b">mypackage/mysubpackage/another_module.py</code>添加到下一个提交中:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="6f65" class="la lb iu ms b gz nj nk l nl nm">$ git add \ <br/>    mypackage/module_1.py \<br/>    mypackage/module_3.py \<br/>    mypackage/mysubpackage/another_module.py</span></pre><p id="43c6" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">现在，如果我们检查状态，我们可以看到文件包含在要提交的更改中:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="5dde" class="la lb iu ms b gz nj nk l nl nm">$ git status<br/>Your branch is up to date with 'origin/feature/example-branch'.</span><span id="5f46" class="la lb iu ms b gz nn nk l nl nm">Changes to be committed:<br/>  (use "git restore --staged &lt;file&gt;..." to unstage)<br/>        modified:   mypackage/module_1.py<br/>        modified:   mypackage/module_3.py<br/>        modified:   mypackage/mysubpackage/another_module.py</span><span id="46c9" class="la lb iu ms b gz nn nk l nl nm">Changes not staged for commit:<br/>  (use "git add &lt;file&gt;..." to update what will be committed)<br/>  (use "git restore &lt;file&gt;..." to discard changes in working directory)<br/>        modified:   mypackage/module_2.py</span><span id="32d3" class="la lb iu ms b gz nn nk l nl nm">Untracked files:<br/>  (use "git add &lt;file&gt;..." to include in what will be committed)<br/>        data/my_data_file.txt</span><span id="6267" class="la lb iu ms b gz nn nk l nl nm">no changes added to commit (use "git add" and/or "git commit -a")</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="deed" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">撤消git提交</h2><p id="d133" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在，撤销<code class="fe mp mq mr ms b">git add</code>的第一个选项是<code class="fe mp mq mr ms b">git reset</code>命令。现在让我们假设我们不小心存放了<code class="fe mp mq mr ms b">myapckage/module_3.py</code>文件，我们想恢复这个操作。我们可以使用以下命令来实现这一点:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="aac0" class="la lb iu ms b gz nj nk l nl nm">$ git reset mypackage/module_3.py</span></pre><p id="b7b6" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">执行上述命令后将报告的消息将通知我们，一旦进行了重置，哪些文件现在未转移:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="43a6" class="la lb iu ms b gz nj nk l nl nm">Unstaged changes after reset:<br/>M       mypackage/module_3.py</span></pre><p id="46a6" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">或者，如果您想要<strong class="ly iv">取消之前添加到下一个提交</strong>中的所有文件，您可以简单地运行</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="ec07" class="la lb iu ms b gz nj nk l nl nm">$ git reset</span></pre><p id="6eb2" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">现在，如果您没有在您的存储库中进行任何提交，那么上面的命令将会失败，因为<code class="fe mp mq mr ms b">HEAD</code>是未定义的:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="d886" class="la lb iu ms b gz nj nk l nl nm">fatal: Failed to resolve 'HEAD' as a valid ref.<br/>(use "git rm --cached &lt;file&gt;..." to unstage</span></pre><p id="163b" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">如果是这种情况，那么你应该使用<code class="fe mp mq mr ms b">git rm</code>命令，而不是<code class="fe mp mq mr ms b">git reset</code>命令。</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="e805" class="la lb iu ms b gz nj nk l nl nm">$ <!-- -->git rm --cached <!-- -->mypackage/module_3.py</span></pre><p id="c7d0" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">同样地，如果您想要卸载所有文件，您将需要<code class="fe mp mq mr ms b">-r</code>标志来递归:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="818a" class="la lb iu ms b gz nj nk l nl nm">$ <!-- -->git rm -r --cached .</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的短文中，我们讨论了用于将当前工作树中的内容添加到下一次提交的<code class="fe mp mq mr ms b">git add</code>命令，以及在错误地包含一个或多个文件的情况下，如何最终撤销该命令。</p><p id="283c" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">更具体地说，我们展示了如何使用大多数情况下都有效的<code class="fe mp mq mr ms b">git reset</code>命令撤销暂存文件，假设您已经对存储库进行了至少一次提交。或者，您应该使用<code class="fe mp mq mr ms b">git rm</code>命令从下一次提交中删除文件。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读媒体上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="no np gq gs nq nr"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kt nr"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated"><strong class="ly iv">相关文章你可能也喜欢</strong></p><div class="no np gq gs nq nr"><a href="https://betterprogramming.pub/common-git-errors-2e379516dc65" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">6个常见的Git错误以及如何避免它们</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">探究Git中一些最常见的错误</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">better编程. pub</p></div></div><div class="oa l"><div class="og l oc od oe oa of kt nr"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu nr"><a rel="noopener  ugc nofollow" target="_blank" href="/delete-local-remote-git-branch-1d8c0870eebc"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">如何在本地和远程删除Git分支</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">展示如何在Git中删除本地和远程分支</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="oa l"><div class="oh l oc od oe oa of kt nr"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu nr"><a href="https://betterprogramming.pub/kafka-cli-commands-1a135a4ae1bd" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">用于日常编程的15个Kafka CLI命令</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">演示最常用的Kafka命令行界面命令的使用</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">better编程. pub</p></div></div><div class="oa l"><div class="oi l oc od oe oa of kt nr"/></div></div></a></div></div></div>    
</body>
</html>