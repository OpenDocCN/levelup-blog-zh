<html>
<head>
<title>Java List Constructor Tips You Should Know Today</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">今天你应该知道的Java列表构造器技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/hows-whens-and-whys-of-java-list-constructors-d622011573e0?source=collection_archive---------6-----------------------#2021-04-30">https://levelup.gitconnected.com/hows-whens-and-whys-of-java-list-constructors-d622011573e0?source=collection_archive---------6-----------------------#2021-04-30</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="a464" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">应如何使用List::of、Arrays::asList、Collections::unmodifieablelist、Collections::singletonList和new ArrayList</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/6ada1844fcab539de7f0efd92895e65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IL3PP4rpTEro-8BH"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">列表<person> —来自<a class="ae kz" href="https://www.pexels.com/photo/group-of-people-sitting-on-concrete-bench-4880395/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">像素</a>的<a class="ae kz" href="https://www.pexels.com/@cottonbro?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> cottonbro </a>拍摄的照片</person></figcaption></figure><p id="257a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建列表有几种方法。</p><ul class=""><li id="90ea" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated"><code class="fe mf mg mh mi b"><em class="mj">Arrays.asList(…)</em></code></li><li id="fc69" class="lw lx iu lc b ld mk lg ml lj mm ln mn lr mo lv mb mc md me bi translated"><code class="fe mf mg mh mi b"><em class="mj">List.of(…)</em></code></li><li id="0494" class="lw lx iu lc b ld mk lg ml lj mm ln mn lr mo lv mb mc md me bi translated"><code class="fe mf mg mh mi b"><em class="mj">Collections.unmodifiableList(…)</em></code></li><li id="edc8" class="lw lx iu lc b ld mk lg ml lj mm ln mn lr mo lv mb mc md me bi translated"><code class="fe mf mg mh mi b"><em class="mj">Collections.singletonList(..)</em></code></li><li id="ae8c" class="lw lx iu lc b ld mk lg ml lj mm ln mn lr mo lv mb mc md me bi translated"><code class="fe mf mg mh mi b"><em class="mj">new ArrayList(…)</em></code></li></ul><p id="96aa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mj">挑哪个？为什么你应该选择</em> <code class="fe mf mg mh mi b"><em class="mj">List.of</em></code> <em class="mj">而不是</em> <code class="fe mf mg mh mi b"><em class="mj">Arrays.asList</em></code> <em class="mj">？各带来什么好处？</em>让我们来回答这些问题。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><p id="1db2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了完成整篇文章，我们需要运行代码。测试将显示有效的操作，以及抛出异常的操作。代码本身并不干净，但能完成工作。</p><h2 id="86e5" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated">Arrays::asList</h2><blockquote class="np nq nr"><p id="8c69" class="la lb mj lc b ld le jv lf lg lh jy li ns lk ll lm nt lo lp lq nu ls lt lu lv in bi translated">返回由指定数组支持的固定大小的列表。(对返回列表的更改“直写”到数组。)这个方法与<code class="fe mf mg mh mi b"><a class="ae kz" href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html#toArray()" rel="noopener ugc nofollow" target="_blank">Collection.toArray()</a></code>相结合，充当基于数组和基于集合的API之间的桥梁。返回的列表是可序列化的，并实现了<code class="fe mf mg mh mi b"><a class="ae kz" href="https://docs.oracle.com/javase/7/docs/api/java/util/RandomAccess.html" rel="noopener ugc nofollow" target="_blank">RandomAccess</a></code>。— <a class="ae kz" href="https://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#asList(T...)" rel="noopener ugc nofollow" target="_blank"> asList docs </a></p></blockquote><p id="ab72" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">先说<code class="fe mf mg mh mi b">asList</code>操作。这是一个固定数组，值为“A”和“V”。在下一个例子中，我们还将看到<em class="mj">“直写”</em>选项。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="ebc5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">运行<code class="fe mf mg mh mi b">asList</code>操作的结果，用JDK 11:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="a929" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">从日志中我们能看到什么？我们看到字符的数量没有变化。然而，我们可以看到一些方法没有抛出异常。<em class="mj">为什么？他们没有在列表中添加或删除字符。</em></p><p id="c1e0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">靠近点看。不会导致异常的方法有<code class="fe mf mg mh mi b">retainAll, removeAll, sort</code>。保留所有元素不会导致大小变化，因此不会发生异常。</p><p id="ab6d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mj">什么原因导致异常？</em>用空列表调用<code class="fe mf mg mh mi b">retainAll</code>。用同样的名单打电话给<code class="fe mf mg mh mi b">removeAll</code>。此行为会改变列表的大小。</p><p id="243e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mj"/><code class="fe mf mg mh mi b"><em class="mj">set</em></code><em class="mj"/><code class="fe mf mg mh mi b"><em class="mj">replaceAll</em></code><em class="mj">为什么不抛出异常？</em>因为<em class="mj">“直写”</em>属性。<code class="fe mf mg mh mi b">asList</code>中使用的阵列可以改变。<code class="fe mf mg mh mi b">set</code>是做改变的操作。</p><p id="40d9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe mf mg mh mi b">asList</code>创建固定大小的集合。价值观会变。你不能减少实际的数组。</p><p id="6bdf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mj"/><code class="fe mf mg mh mi b"><em class="mj">asList</em></code><em class="mj">还支持什么？</em>将<code class="fe mf mg mh mi b">nulls</code>添加到列表中。其他集合方法中的无效行为。<em class="mj">为什么？</em> <code class="fe mf mg mh mi b">nulls</code>在集合中制造歧义。假设我们在地图中得到一个键<code class="fe mf mg mh mi b">x</code>的<code class="fe mf mg mh mi b">null</code>。这是否意味着我们在地图上没有 <code class="fe mf mg mh mi b"><em class="mj">x</em></code> <em class="mj">的钥匙？这是否意味着键</em> <code class="fe mf mg mh mi b"><em class="mj">x</em></code> <em class="mj">的值丢失？</em></p><p id="cdba" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mj">避开</em> <code class="fe mf mg mh mi b"><em class="mj">null</em></code> <em class="mj">检查会带来什么？更好的性能。</em> <code class="fe mf mg mh mi b">asList</code>，正如这个<a class="ae kz" href="https://dzone.com/articles/singleton-list-showdown-collectionssingletonlist-v" rel="noopener ugc nofollow" target="_blank">研究探索的</a>，比不可变的同行表现更好。</p><p id="3e0a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">什么时候可以使用这种创建列表的方法？当尺寸不变，但数值会变。我会把它用在固定大小的游戏板上。每个元素都可能改变，但大小不应该改变。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="4a61" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated">列表::共个</h2><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="4bff" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe mf mg mh mi b">List::of </code>是完全不可改变的。无论是大小还是实际价值。不管参数是什么，每个方法都会抛出<code class="fe mf mg mh mi b">UnsupportedOperationException</code>。</p><p id="254d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Stuart Marks <a class="ae kz" href="https://www.youtube.com/watch?v=ogRVWXuuAU4&amp;ab_channel=Java" rel="noopener ugc nofollow" target="_blank">声明</a>说<code class="fe mf mg mh mi b">List::of</code>提供了不可变的集合。元素本身并不是不可变的。原始值被包装，因此是不可变的。</p><p id="d3cd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用<code class="fe mf mg mh mi b">List::of</code>创建配置列表。当你需要在石头上设定价值时。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="61de" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated">Collections::singletonList</h2><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="ecb0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这种行为类似于<code class="fe mf mg mh mi b">List::of</code>。我们不能改变大小，价值观必须保持不变。</p><p id="becc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">例外情况是<code class="fe mf mg mh mi b">retainAll, removeAll, sort</code>。它们不改变包装列表，因此不会抛出异常。</p><p id="f410" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe mf mg mh mi b">singletonList</code>的一个怪异行为。可以把<code class="fe mf mg mh mi b">null</code>放到<code class="fe mf mg mh mi b">singletonList</code>里。<em class="mj">为什么很奇怪？</em> <code class="fe mf mg mh mi b">null</code>避免用于所有收藏。即便如此，<code class="fe mf mg mh mi b">singletonList</code>也能顶得住<code class="fe mf mg mh mi b">null</code>。</p><p id="4ad3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">根据<a class="ae kz" href="https://dzone.com/articles/singleton-list-showdown-collectionssingletonlist-v" rel="noopener ugc nofollow" target="_blank">到</a>的实验，<code class="fe mf mg mh mi b">singletonList</code>比<code class="fe mf mg mh mi b">List::of</code>快。这并不意味着我们不对单例列表使用<code class="fe mf mg mh mi b">List::of</code>。<em class="mj">我们什么时候需要</em> <code class="fe mf mg mh mi b"><em class="mj">List::of</em></code> <em class="mj">进行单体列表？</em>创建动态列表时。当你需要确保单例列表包含<code class="fe mf mg mh mi b">nonNull</code>元素时，应用<code class="fe mf mg mh mi b">List::of</code>。</p><p id="8bd4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mj">什么时候可以用</em> <code class="fe mf mg mh mi b"><em class="mj">null</em></code> <em class="mj">的</em> <code class="fe mf mg mh mi b"><em class="mj">singletonList</em></code> <em class="mj">？</em>从列表中删除<code class="fe mf mg mh mi b">nulls</code>。这里有一个例子:</p><pre class="kk kl km kn gu nx mi ny nz aw oa bi"><span id="6d5f" class="mw mx iu mi b gz ob oc l od oe">List&lt;String&gt; list = Arrays.asList("abc", null, "def", null);<br/>list.removeAll(Collections.singletonList(null));</span></pre><p id="c5c4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">也可以是<code class="fe mf mg mh mi b">retainAll</code> <code class="fe mf mg mh mi b">nulls</code>，尽管我没有看到这种行为的用例。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="afb5" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated">使用新数组列表</h2><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="6224" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你看我们最后得到了一个空列表。当您需要改变列表或从不可变列表创建可变列表时，请使用new ArrayList。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="c005" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated">集合::不可修改列表</h2><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="c261" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用<code class="fe mf mg mh mi b">Collections::unmodifiableList</code>或<code class="fe mf mg mh mi b">List::of</code>，因为它们有相同的行为。当您需要更多详细信息时，使用<code class="fe mf mg mh mi b">Collections::unmodifiableList</code>。</p><p id="6136" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe mf mg mh mi b">Collections::unmodifiableList</code>创建<strong class="lc iv">不可修改的视图</strong>。<em class="mj">什么是不可修改视图？</em>列表内容可以更改。名单不能变。包装原始值，使它们不可变。这里有一个<strong class="lc iv">不可修改视图</strong>的例子。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><pre class="kk kl km kn gu nx mi ny nz aw oa bi"><span id="d3e6" class="mw mx iu mi b gz ob oc l od oe">### TESTING unmodifiableList with mutable content ###<br/>a123</span></pre><p id="ef66" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mj">那</em> <code class="fe mf mg mh mi b"><em class="mj">List::of</em></code> <em class="mj">呢？</em></p><p id="c6c8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们得到了同样的经历，就像对待<code class="fe mf mg mh mi b">Collections::unmodifiableList</code>一样。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div></figure><pre class="kk kl km kn gu nx mi ny nz aw oa bi"><span id="bd61" class="mw mx iu mi b gz ob oc l od oe">### TESTING listOF with mutable content ###<br/>a123</span></pre></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h1 id="a900" class="of mx iu bd my og oh oi nb oj ok ol ne ka om kb nh kd on ke nk kg oo kh nn op bi translated">摘要</h1><p id="ad93" class="pw-post-body-paragraph la lb iu lc b ld oq jv lf lg or jy li lj os ll lm ln ot lp lq lr ou lt lu lv in bi translated">不要得出永恒不变的结论。你可能错了。我得出了错误的结论，这浪费了开发人员的时间。</p><p id="c03d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe mf mg mh mi b">unmodifiableList</code>，表示内容可以改变，收藏不能。做出这种改变，远离讨厌的虫子。</p><p id="b122" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe mf mg mh mi b">singletonList</code>允许<code class="fe mf mg mh mi b">nulls</code>。不想要<code class="fe mf mg mh mi b">nulls</code>的时候用<code class="fe mf mg mh mi b">List::of</code>。<code class="fe mf mg mh mi b">List::of</code>性能更差，但不允许<code class="fe mf mg mh mi b">List</code>中的<code class="fe mf mg mh mi b">nulls</code>。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h1 id="0253" class="of mx iu bd my og oh oi nb oj ok ol ne ka om kb nh kd on ke nk kg oo kh nn op bi translated">你可能会喜欢这些文章</h1><div class="ov ow gq gs ox oy"><a href="https://medium.com/dev-genius/9-bad-java-snippets-to-make-you-laugh-82f5018e06e5" rel="noopener follow" target="_blank"><div class="oz ab fp"><div class="pa ab pb cl cj pc"><h2 class="bd iv gz z fq pd fs ft pe fv fx it bi translated">让你发笑的9个糟糕的Java片段</h2><div class="pf l"><h3 class="bd b gz z fq pd fs ft pe fv fx dk translated">糟糕的Java代码让你感觉更好</h3></div><div class="pg l"><p class="bd b dl z fq pd fs ft pe fv fx dk translated">medium.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm kt oy"/></div></div></a></div><div class="ov ow gq gs ox oy"><a href="https://medium.com/javarevisited/linked-list-analysis-java-developers-should-know-121ed803bee1" rel="noopener follow" target="_blank"><div class="oz ab fp"><div class="pa ab pb cl cj pc"><h2 class="bd iv gz z fq pd fs ft pe fv fx it bi translated">Java开发人员应该知道的链表分析</h2><div class="pf l"><h3 class="bd b gz z fq pd fs ft pe fv fx dk translated">LinkedList如何击败ArrayList和ArrayDeque</h3></div><div class="pg l"><p class="bd b dl z fq pd fs ft pe fv fx dk translated">medium.com</p></div></div><div class="ph l"><div class="pn l pj pk pl ph pm kt oy"/></div></div></a></div><div class="ov ow gq gs ox oy"><a href="https://medium.com/javarevisited/7-practical-java-tips-you-should-know-92654313eb4" rel="noopener follow" target="_blank"><div class="oz ab fp"><div class="pa ab pb cl cj pc"><h2 class="bd iv gz z fq pd fs ft pe fv fx it bi translated">你应该知道的7个实用Java技巧</h2><div class="pf l"><h3 class="bd b gz z fq pd fs ft pe fv fx dk translated">Java的注意事项可选</h3></div><div class="pg l"><p class="bd b dl z fq pd fs ft pe fv fx dk translated">medium.com</p></div></div><div class="ph l"><div class="po l pj pk pl ph pm kt oy"/></div></div></a></div></div></div>    
</body>
</html>