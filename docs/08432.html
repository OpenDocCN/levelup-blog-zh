<html>
<head>
<title>How to Get the Power of Test in Hypothesis Testing with Binomial Distribution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">二项分布假设检验中检验功效的计算</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-get-the-power-of-test-in-hypothesis-testing-with-binomial-distribution-c70e7f1309c6?source=collection_archive---------8-----------------------#2021-05-02">https://levelup.gitconnected.com/how-to-get-the-power-of-test-in-hypothesis-testing-with-binomial-distribution-c70e7f1309c6?source=collection_archive---------8-----------------------#2021-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="46e2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">R中二项分布的单边和双边假设检验中检验功效的计算实例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6287d9d2baa853005af5a3550d068957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hDKJnfbJW-2DjRKx.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/ROC_curves.svg/2560px-ROC_curves.svg.png" rel="noopener ugc nofollow" target="_blank">维基百科</a></figcaption></figure><div class="kz la gp gr lb lc"><a href="https://jorgepit-14189.medium.com/membership" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">用我的推荐链接加入媒体-乔治皮皮斯</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">阅读乔治·皮皮斯(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">jorgepit-14189.medium.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq ks lc"/></div></div></a></div><p id="5fc1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本教程中，我们将展示如何在应用二项分布假设检验时获得检验的功效。在提供示例之前，让我们回忆一下第一类和第二类错误。</p><p id="0ebb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">第一类错误</strong></p><p id="fe47" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是拒绝零假设的概率，假设零假设为真。这是显著性水平α，在统计学中通常设定为5%</p><p id="1612" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">第二类错误</strong></p><p id="153b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是接受零假设的概率，假设零假设是假的。在统计学中，第二类误差是<strong class="lt iu"> β </strong>，通常在20%左右。</p><p id="ab90" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">测试功率</strong></p><p id="95a4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是拒绝零假设的概率，假设零假设是假的。在统计学中，我们称之为γ的幂，它等于1-β，通常取80%左右的值。</p><p id="ac23" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下表总结了我们上面所说的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/2d7f8dbc28cc5aba3970bed35414497e.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/0*ytP6v109J1G1avYC.png"/></div></figure><h1 id="2db2" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">检验的势</h1><p id="4270" class="pw-post-body-paragraph lr ls it lt b lu ng ju lw lx nh jx lz ma ni mc md me nj mg mh mi nk mk ml mm im bi translated">幂表示避免第二类错误的概率，可以写成:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/148f567a23ad39b2a509fdcdc68341aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*7UitycxIMPwck_rbmtezDg.png"/></div></figure><p id="2634" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">功效分析可用于计算在假设检验中检测统计显著性所需的最小样本量。影响功率的因素有:</p><ul class=""><li id="5415" class="nm nn it lt b lu lv lx ly ma no me np mi nq mm nr ns nt nu bi translated">显著性水平α，称为I型误差。</li><li id="519d" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">假设检验中总体的观察值与理论值的差异。</li><li id="40dd" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">样本量。</li></ul><h1 id="8914" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">检验的功效:二项分布的单侧假设检验</h1><p id="c7e8" class="pw-post-body-paragraph lr ls it lt b lu ng ju lw lx nh jx lz ma ni mc md me nj mg mh mi nk mk ml mm im bi translated"><strong class="lt iu">问题</strong>:我们对<strong class="lt iu"> 24 </strong>人进行了抽样调查，发现其中<strong class="lt iu"> 13 </strong>人是吸烟者。我们能声称吸烟者在人口中的比例在5%的显著性水平上至少是35%吗？测试的力量是什么？</p><p id="d455" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">解决方案</strong>:</p><p id="e838" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个问题可以表述如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/ee8996fc3b6f70e01d70451464dce1de.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*KXnu6M-FolJBoFbMGWH9Lg.png"/></div></figure><p id="a350" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们应该做的第一件事是找到临界值。对于每一个等于或大于临界值的值，我们都拒绝零假设。我们可以用不同的方法找到它。让我们通过使用<code class="fe ob oc od oe b">binom.test</code>函数的for循环找到临界值。</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="9d76" class="oj mp it oe b gy ok ol l om on">x&lt;-13<br/>n&lt;-24<br/>p_test&lt;-0.35<br/>alpha&lt;-0.05</span><span id="e3a4" class="oj mp it oe b gy oo ol l om on">critical&lt;-NULL<br/>for (i in c(0:n)) {</span><span id="d45b" class="oj mp it oe b gy oo ol l om on">if (binom.test(i, n, p=p_test, "greater")$p.value&lt;alpha) {<br/>    critical&lt;-i<br/>    break<br/>  }<br/>  <br/>}<br/>critical</span></pre><p id="900f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">输出:</strong></p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="697b" class="oj mp it oe b gy ok ol l om on">[1] 13</span></pre><p id="a783" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">或者</strong>，我们可以通过计算分位数函数来求解，分位数函数是CDF的逆函数，如下所示:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="c98e" class="oj mp it oe b gy ok ol l om on">qbinom(0.95, 24, 0.35)</span></pre><p id="e45d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">输出:</strong></p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="8e23" class="oj mp it oe b gy ok ol l om on">[1] 12</span></pre><p id="7f9d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">但是由于二项式分布的离散性，我们希望临界值大于反CDF的值。所以临界值是<strong class="lt iu"> 13 </strong>。我们可以通过使用如下PDF对概率求和来确认它:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="e754" class="oj mp it oe b gy ok ol l om on">sum(dbinom(13:24, 24, 0.35))</span></pre><p id="2bca" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">输出:</strong></p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="fb33" class="oj mp it oe b gy ok ol l om on">[1] 0.04225307</span></pre><p id="48d7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">注意<code class="fe ob oc od oe b">sum(dbinom(12:24, 24, 0.35))</code>是大于0.05的<code class="fe ob oc od oe b">0.09422976</code>。</p><h2 id="baa3" class="oj mp it bd mq op oq dn mu or os dp my ma ot ou na me ov ow nc mi ox oy ne oz bi translated">计算检验的功效</h2><p id="131b" class="pw-post-body-paragraph lr ls it lt b lu ng ju lw lx nh jx lz ma ni mc md me nj mg mh mi nk mk ml mm im bi translated">既然我们已经找到了临界值13，让我们试着计算一下检验γ的功效。所以我们想计算概率:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/31c92d3fd91d964357391416644f4bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tGytE8e4brCqQ6xNa8i2yw.png"/></div></div></figure><p id="cd57" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">其中<strong class="lt iu"> X </strong>遵循二项式分布，<strong class="lt iu"> c </strong>为临界值，<strong class="lt iu"> p=13/24 </strong>为观察概率。我们可以很容易地计算R中的检验功效，如下所示:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="c53b" class="oj mp it oe b gy ok ol l om on">1 - pbinom(critical-1, n, x/n)</span></pre><p id="289b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">输出</strong>:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="2fe2" class="oj mp it oe b gy ok ol l om on">[1] 0.5830354</span></pre><p id="0fb6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">因此，测试的功效为58.30% </strong></p><h1 id="2be2" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">检验的功效:二项分布的双边假设检验</h1><p id="87d0" class="pw-post-body-paragraph lr ls it lt b lu ng ju lw lx nh jx lz ma ni mc md me nj mg mh mi nk mk ml mm im bi translated">问题:我们抽取了24个人的样本，发现其中有13个人是吸烟者。我们能在5%的显著性水平上声称吸烟者在人口中的比例是35%吗？测试的力量是什么？</p><p id="b975" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">解决方案</strong>:</p><p id="e008" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个问题可以表述如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/42d5ac75924b93c86cf85256f39d5439.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*wBteEYmkrOJ58mTzOTQoFw.png"/></div></figure><p id="d012" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们应该做的第一件事是找到临界值。由于测试是双边的，我们需要找到两个临界值。<code class="fe ob oc od oe b">critacal_minus</code>和<code class="fe ob oc od oe b">critical_plus</code>。同样，我们可以使用<code class="fe ob oc od oe b">binom.test</code>函数。我们将做两个单侧测试。一个“较大”和一个“较小”如下:</p><p id="7cf7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">请注意，α为0.05/2，因为我们正在进行双边测试。</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="a523" class="oj mp it oe b gy ok ol l om on"># two sided</span><span id="e840" class="oj mp it oe b gy oo ol l om on">x&lt;-13<br/>n&lt;-24<br/>p_test&lt;-0.35<br/>alpha&lt;-0.05</span><span id="8ef8" class="oj mp it oe b gy oo ol l om on">critical_plus&lt;-NULL<br/>for (i in c(0:n)) {<br/>  <br/>  if (binom.test(i, n, p=p_test, "greater")$p.value&lt;alpha/2) {<br/>    critical_plus&lt;-i<br/>    break<br/>  }<br/>  <br/>}<br/>critical_plus</span><span id="0720" class="oj mp it oe b gy oo ol l om on">critical_minus&lt;-NULL<br/>for (i in c(n:0)) {<br/>  <br/>  if (binom.test(i, n, p=p_test, "less")$p.value&lt;alpha/2) {<br/>    critical_minus&lt;-i<br/>    break<br/>  }<br/>  <br/>}<br/>critical_minus</span></pre><p id="9d37" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">和</strong> <code class="fe ob oc od oe b"><strong class="lt iu">critical_minus</strong></code> <strong class="lt iu">和</strong> <code class="fe ob oc od oe b"><strong class="lt iu">critical_plus</strong></code> <strong class="lt iu">分别得到值3和14</strong>。或者，我们可以使用如下的反向PDF:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="6a61" class="oj mp it oe b gy ok ol l om on"># critical minus<br/>qbinom(0.025, 24, 0.35)-1<br/>[1] 3</span><span id="d4df" class="oj mp it oe b gy oo ol l om on"># critical plus<br/>qbinom(0.975, 24, 0.35)+1<br/>[1] 14</span></pre><p id="4dcb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您可以确认临界值是正确的，因为超过临界值的概率不超过0.05:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="e66a" class="oj mp it oe b gy ok ol l om on">sum(dbinom(0:critical_minus, n, p_test))+sum(dbinom(critical_plus:n, n, p_test))</span><span id="eeba" class="oj mp it oe b gy oo ol l om on">[1] 0.02968141</span></pre><h2 id="11f3" class="oj mp it bd mq op oq dn mu or os dp my ma ot ou na me ov ow nc mi ox oy ne oz bi translated">计算检验的功效</h2><p id="bf96" class="pw-post-body-paragraph lr ls it lt b lu ng ju lw lx nh jx lz ma ni mc md me nj mg mh mi nk mk ml mm im bi translated">现在我们准备计算测试的功效。我们会计算这两个临界值，然后我们会把概率加起来。</p><p id="d925" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">临界减</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/6d590b754708c4df42a87e752ace6fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-mUtaRxzdTUWIProblsOQ.png"/></div></div></figure><p id="a8aa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用R，我们得到:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="6d82" class="oj mp it oe b gy ok ol l om on">power_minus&lt;-pbinom(critical_minus, n, x/n) <br/>power_minus <br/>[1] 2.773643e-05</span></pre><p id="d4d6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">暴加</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/44b9903cd4f98020429b3c874b973b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m9FHfcOhCH2l5Mh1UwLsFA.png"/></div></div></figure><p id="b764" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用R，我们得到:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="701e" class="oj mp it oe b gy ok ol l om on">power_plus&lt;-1-pbinom(critical_plus-1, n, x/n) <br/>power_plus [1] <br/>0.4213083</span></pre><h2 id="e440" class="oj mp it bd mq op oq dn mu or os dp my ma ot ou na me ov ow nc mi ox oy ne oz bi translated">测试的功效</h2><p id="fb9a" class="pw-post-body-paragraph lr ls it lt b lu ng ju lw lx nh jx lz ma ni mc md me nj mg mh mi nk mk ml mm im bi translated">现在，通过将<code class="fe ob oc od oe b">power_minus</code>和<code class="fe ob oc od oe b">power_plus</code>相加，我们得到了二项分布双边检验的功效，即<strong class="lt iu"> 42.13% </strong>:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="088a" class="oj mp it oe b gy ok ol l om on">power_minus+power_plus <br/>[1] 0.421336</span></pre></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><p id="cc48" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><em class="pl">最初发表于</em><a class="ae ky" href="https://predictivehacks.com/how-to-get-the-power-of-test-in-hypothesis-testing-with-binomial-distribution/" rel="noopener ugc nofollow" target="_blank"><em class="pl">【https://predictivehacks.com】</em></a><em class="pl">。</em></p></div></div>    
</body>
</html>