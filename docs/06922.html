<html>
<head>
<title>Steal User Information - Chaining XSS &amp; Http Parameter Pollution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">çªƒå–ç”¨æˆ·ä¿¡æ¯-é“¾æ¥XSSå’ŒHttpå‚æ•°æ±¡æŸ“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/stealing-user-information-via-xss-via-parameter-pollution-7d99b3379e7d?source=collection_archive---------9-----------------------#2021-01-12">https://levelup.gitconnected.com/stealing-user-information-via-xss-via-parameter-pollution-7d99b3379e7d?source=collection_archive---------9-----------------------#2021-01-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="30ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æ­£åœ¨é—²é€›ï¼Œçªç„¶è¿™æ¡æ¨ç‰¹å‡ºç°åœ¨æˆ‘çš„æ–°é—»è®¢é˜…é‡Œã€‚</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/daa10d6d7a71f6c7c10863f62df6d8b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pVjzAlHIMiyDhUMw.jpg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="http://twitter.com/zseano" rel="noopener ugc nofollow" target="_blank"> @zseano </a>åŠ±å¿—æ¨æ–‡ğŸ˜è®©æˆ‘çƒ­æ³ªç›ˆçœ¶</figcaption></figure><p id="6aad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç„¶åï¼Œæˆ‘å†³å®šç»™è‡ªå·±ä¸€ä¸ªæ–°çš„å¼€å§‹ï¼Œå› ä¸ºç°åœ¨æ˜¯2021å¹´ğŸ‰ã€‚æˆ‘ç™»å½•äº†æˆ‘çš„<a class="ae lb" href="https://bugcrowd.com" rel="noopener ugc nofollow" target="_blank"> bugcrowd </a>è´¦å·ï¼Œæ ¹æ®æˆ‘çš„æŠ€èƒ½æŒ‘é€‰äº†ä¸€ä¸ªåˆé€‚çš„ç›®æ ‡(åœ¨è¿™ä¸ªç›®æ ‡ä¸Šæˆ‘æ›¾ç»å‘ç°è¿‡bug)ã€‚</p><p id="19d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»æºä»£ç å®¡æŸ¥å¼€å§‹ï¼Œå®¡æŸ¥äº†ä»–ä»¬çš„ä¸€å †javascriptæ–‡ä»¶ï¼Œæœ€ç»ˆå‘ç°ä¸¤ä¸ªç«¯ç‚¹ä¼¼ä¹å®¹æ˜“å—åˆ°<strong class="jp ir">å¼€æ”¾é‡å®šå‘+ XSS </strong>çš„æ”»å‡»ï¼Œå› ä¸ºå¼€å‘äººå‘˜å…è®¸åº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œç‰¹å®šæ“ä½œåé‡å®šå‘ç”¨æˆ·ï¼Œè€Œä¸æ˜¯æœåŠ¡å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="km kn ko kp gt lc ld le lf aw lg bi"><span id="78c8" class="lh li iq ld b gy lj lk l ll lm">function get_param(param) {<br/>    var params = {};<br/>    var url = window.location.href;<br/>    var start = url.indexOf('?');<br/>    start = start &lt; 0 ? url.length : start + 1;<br/>    var end = url.indexOf('#');<br/>    end = end &lt; 0 ? url.length : end;<br/>    var parameters = url.slice(start,end).split('&amp;');</span><span id="0929" class="lh li iq ld b gy ln lk l ll lm">for ( var i = 0; i &lt; parameters.length; i++) {<br/>        var parameter = parameters[i].split('=');<br/>        params[parameter[0]] = parameter[1];<br/>    }</span><span id="d461" class="lh li iq ld b gy ln lk l ll lm">    return params[param];<br/>}</span><span id="a968" class="lh li iq ld b gy ln lk l ll lm">// redirect from application<br/>window.location.href = get_param("continue_url"); </span></pre><h1 id="83a1" class="lo li iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">æµ‹è¯•</h1><p id="439e" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">æˆ‘é¦–å…ˆè¯•å›¾è·å¾—ä¸€ä¸ªå¼€æ”¾çš„é‡å®šå‘ï¼Œä½†æ˜¯æœåŠ¡å™¨åœ¨å‘ç°ä»»ä½•å…¶ä»–åŸŸæˆ–åœ¨<code class="fe mq mr ms ld b">continue_url</code>å‚æ•°ä¸­çš„æœ‰æ•ˆè´Ÿè½½æ—¶é‡å®šå‘åˆ°ä¸€ä¸ª<code class="fe mq mr ms ld b">404</code>é¡µé¢ã€‚å› ä¸ºæˆ‘å·²ç»æ„è¯†åˆ°æœåŠ¡å™¨çš„ç¯å¢ƒæ˜¯Javaçš„ï¼Œå¹¶ä¸”å®ƒçš„æµè¡Œæ˜¯å› ä¸ºå‚æ•°æ±¡æŸ“ã€‚å› æ­¤ï¼Œæˆ‘å°è¯•ä¸¤æ¬¡æ·»åŠ ç›¸åŒçš„å‚æ•°<code class="fe mq mr ms ld b">?continue_url=redacted.com&amp;continue_url=attacker.com</code>æ¥éªŒè¯å®ƒï¼Œä»¤æˆ‘æƒŠè®¶çš„æ˜¯ï¼ŒæœåŠ¡å™¨åªæ£€æŸ¥äº†Uriä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œå¿½ç•¥äº†å—æˆ‘çš„æœ‰æ•ˆè´Ÿè½½å½±å“çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™åªæ˜¯ç»•è¿‡äº†æœåŠ¡å™¨çš„é™åˆ¶ï¼Œå¯¼è‡´é‡å®šå‘åˆ°<code class="fe mq mr ms ld b">attacker.com</code>ï¼Œä½†è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬å€’å›å»ã€‚</p><p id="1d29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨é‚£ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä¹Ÿæœ‰ç‚¹å›°æƒ‘ï¼Œä½†æ˜¯å¦‚æœä½ å’Œjavascriptæ›¾ç»æœ‰è¿‡äº¤é›†ï¼Œé‚£ä¹ˆä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†<code class="fe mq mr ms ld b">get_param(param)</code>å‡½æ•°æœ‰é—®é¢˜ã€‚å¾ˆè€äººå¯»å‘³ï¼Œä¸æ˜¯å—ï¼Ÿä½ ä¹Ÿåº”è¯¥è¯•ä¸€è¯•ã€‚æˆ‘åªèƒ½è¯´ï¼Œè¦ä¹ˆæ˜¯å¼€å‘äººå‘˜æ²¡æœ‰å®Œå…¨æ„è¯†åˆ°Javaå¤„ç†å¤šä¸ªåŒåå‚æ•°çš„è¡Œä¸ºï¼Œè¦ä¹ˆæ˜¯ä»–ä»¬åœ¨ç¼–å†™å‡½æ•°æ—¶æ²¡æœ‰è€ƒè™‘åˆ°è¿™ä¸ªé—®é¢˜ã€‚å› æ­¤ï¼Œè¯¥å‡½æ•°åªæ˜¯ç”¨é‡å¤çš„æ¡ç›®è¦†ç›–å‚æ•°(ä»…)çš„å€¼ã€‚</p><pre class="km kn ko kp gt lc ld le lf aw lg bi"><span id="93d4" class="lh li iq ld b gy lj lk l ll lm">params[parameter[0]] = parameter[1];</span></pre><p id="7f0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæœ‰å¤šä¸ªç›¸åŒå‚æ•°çš„æ¡ç›®ï¼Œä¸Šé¢çš„ä»£ç å°†ç®€å•åœ°ç”¨æ–°å€¼é‡å†™é”®<code class="fe mq mr ms ld b">continue_url</code>çš„æ—§å€¼ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ç”¨æˆ‘ä»¬æä¾›çš„å‚æ•°è°ƒè¯•ä¸Šé¢çš„ä»£ç è¡Œï¼Œå®ƒçœ‹èµ·æ¥ä¼šåƒè¿™æ ·:</p><pre class="km kn ko kp gt lc ld le lf aw lg bi"><span id="7c59" class="lh li iq ld b gy lj lk l ll lm">// setting value to continue_url<br/>params["continue_url"] = "redacted.com"; </span><span id="8130" class="lh li iq ld b gy ln lk l ll lm">// overwriting continue_url using parameter pollution<br/>params["continue_url"] = "attacker.com";</span></pre><p id="6c48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œparamså¯¹è±¡æœ€ç»ˆå°†åŒ…å«ä»¥ä¸‹é”®/å€¼:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/2b9018efdcb6545b8d4192b32692f2fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-4RJIaYHFdBYUkkXksYwUw.png"/></div></div></figure><h1 id="afc6" class="lo li iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">è·å–XSSå¹¶çªƒå–ç”¨æˆ·ä¿¡æ¯</h1><p id="0f3b" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">åœ¨æŒæ¡äº†æœåŠ¡å™¨æ•…éšœçš„è¯€çªåï¼Œæˆ‘æœ€ç»ˆè¯•å›¾å°†è¿™ä¸ªé—®é¢˜å‡çº§åˆ°XSSï¼Œå¹¶ç”¨javascriptæœ‰æ•ˆè½½è·<code class="fe mq mr ms ld b">?continue_url=redacted.com&amp;continue_url=javascript:alert(1)</code>æ›¿æ¢å®ƒçš„å€¼ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼ŒæœåŠ¡å™¨è¿”å›äº†<strong class="jp ir"> 400é”™è¯¯è¯·æ±‚</strong>é”™è¯¯ï¼Œæˆ‘å°±åƒè¿™æ ·:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/02677581ce86b4e37634ee4b23576ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*UodO_iqwv2hBCsNYl8UsSg.gif"/></div></figure><p id="1cb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œåœ¨ä½¿ç”¨<code class="fe mq mr ms ld b">continue_url</code>å‚æ•°åï¼Œæˆ‘ä»¬å‘ç°å³ä½¿é€šè¿‡å‚æ•°æ±¡æŸ“ç»•è¿‡404é”™è¯¯ï¼ŒæœåŠ¡å™¨ä»ç„¶æœ‰ä¸€ç‚¹å®‰å…¨ï¼Œå®ƒä¼šæ£€æŸ¥ä¸<code class="fe mq mr ms ld b"><strong class="jp ir">javascript</strong></code>ç›¸å…³çš„å…³é”®å­—ï¼Œå¹¶é™åˆ¶å¸¦æœ‰<strong class="jp ir"> 400 </strong>é”™è¯¯çš„å“åº”ã€‚</p><p id="c824" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥ï¼Œæˆ‘æƒ³å‡ºäº†ä»¥ä¸‹æµ‹è¯•æ¡ˆä¾‹:</p><pre class="km kn ko kp gt lc ld le lf aw lg bi"><span id="5b35" class="lh li iq ld b gy lj lk l ll lm"><strong class="ld ir">x</strong>javascript:alert(1)  // 400 Bad Request<br/>javaScript<strong class="ld ir">x</strong>:alert(1)  // 400 Bad Request<br/><strong class="ld ir">x</strong>javascript<strong class="ld ir">x</strong>:alert(1) // 400 Bad Request<br/>java<strong class="ld ir">x</strong>script:alert(1)  // 200 OK (Breaking javascript)</span></pre><p id="c56e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æ£€æŸ¥äº†è¿™äº›æµ‹è¯•æ¡ˆä¾‹åï¼Œæˆ‘å¾—å‡ºç»“è®ºï¼ŒæœåŠ¡å™¨è¦ä¹ˆä½¿ç”¨regexä»å‚æ•°å­—ç¬¦ä¸²ä¸­æå–å¹¶åŒ¹é…å¯èƒ½çš„<strong class="jp ir"> javascript </strong>å…³é”®å­—ï¼Œä»¥é˜²æ­¢å…¶å—åˆ°XSSæ”»å‡»ã€‚ä½†æ˜¯æœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•å¯ä»¥ç»•è¿‡è¿™ç§é™åˆ¶ï¼Œé‚£å°±æ˜¯åœ¨æœ‰æ•ˆè½½è·ä¸­æ”¾å…¥ä¸€ä¸ªurlencodedåˆ¶è¡¨ç¬¦<code class="fe mq mr ms ld b"><strong class="jp ir">%09</strong></code>ï¼Œå®ƒå¯ä»¥ç®€å•åœ°ç ´åæœåŠ¡å™¨çš„éªŒè¯ï¼Œè€Œjavascriptå®Œå…¨å¿½ç•¥åˆ¶è¡¨ç¬¦ï¼Œè¿™ä¼šå¯¼è‡´å¼¹å‡ºä¸€ä¸ªè­¦å‘Šã€‚æ‰€ä»¥æˆ‘ä½¿ç”¨çš„æœ€ç»ˆæœ‰æ•ˆè½½è·æ˜¯:</p><pre class="km kn ko kp gt lc ld le lf aw lg bi"><span id="44a3" class="lh li iq ld b gy lj lk l ll lm">javas<strong class="ld ir">%09</strong>cript:alert(1) // 200 OK</span></pre><p id="b477" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨åˆ›å»ºPOCçš„åŒæ—¶ï¼Œæˆ‘æƒ³ä¸ºä»€ä¹ˆä¸åƒæˆ‘ä»¬ä¸€ç›´åšçš„é‚£æ ·ï¼Œé€šè¿‡çªƒå–ç”¨æˆ·ä¿¡æ¯æ¥æé«˜ä¸¥é‡æ€§ï¼Œå¹¶ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è„šæœ¬æ¥çªƒå–å½“å‰ç™»å½•çš„ç”¨æˆ·è¯¦ç»†ä¿¡æ¯:</p><pre class="km kn ko kp gt lc ld le lf aw lg bi"><span id="87d1" class="lh li iq ld b gy lj lk l ll lm"><strong class="ld ir">Script:</strong><br/>fetch("https://redacted.com/path/to/userinfo").then(a =&gt; a.json()).then(a =&gt; console.log(a.response)); // Instead of logging user info, an attacker may send it to his/her server</span><span id="b2cd" class="lh li iq ld b gy ln lk l ll lm"><strong class="ld ir">// final payload</strong><br/>https://redacted.com/endpoint?continue_url=redacted.com&amp;continue_url=java%09Script:fetch(%22https://redacted.com/path/to/userinfo%22).then(a%3D%3Ea.json()).then(a%3D%3Econsole.log(a.response));//</span></pre><h1 id="a6f3" class="lo li iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">æ§åˆ¶å°ä¸­è®°å½•çš„å—å®³è€…ä¿¡æ¯:</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mv"><img src="../Images/9ecf6210f36200fab6137bec58633631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdDWP_wEZNPEcZ01ePL24Q.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">æ”»å‡»è€…å¯èƒ½ä¼šå°†å…¶å‘é€åˆ°ä»–/å¥¹çš„æœåŠ¡å™¨ï¼Œä½†æˆ‘ä»¬åªæ˜¯ç™»å½•åˆ°æ§åˆ¶å°è¿›è¡Œæ¼”ç¤ºã€‚</figcaption></figure><p id="f758" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€ç»ˆï¼Œæˆ‘æŠŠå®ƒä¸ŠæŠ¥ç»™äº†è¿™ä¸ªé¡¹ç›®ï¼Œç»è¿‡å‡ å¤©çš„ç­›é€‰ï¼Œæˆ‘ç»ˆäºè·å¾—äº†ä¸€ä¸ªå¾ˆå¥½çš„å¥–åŠ±ğŸ’°é‚£æ˜¯æˆ‘2021å¹´çš„ç¬¬ä¸€ç¬”èµé‡‘ğŸ‰</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mw"><img src="../Images/3fdac005eb0c60b11d3332b45e7e327b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vMfmskcSMKbv87XhPSMbkw.png"/></div></div></figure><p id="946f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æ¨ç‰¹ä¸Šå…³æ³¨æˆ‘:<a class="ae lb" href="https://twitter.com/hamzaavvan" rel="noopener ugc nofollow" target="_blank">å“ˆå§†æ‰Â·é˜¿å¤«ä¸‡</a><a class="ae lb" href="https://twitter.com/hamzaavvan" rel="noopener ugc nofollow" target="_blank">@å“ˆå§†æ‰Â·é˜¿å¤«ä¸‡</a></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx my l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><a href="https://www.digitalocean.com/?refcode=7b5b6401934f&amp;utm_campaign=Referral_Invite&amp;utm_medium=Referral_Program&amp;utm_source=badge"><div class="gh gi mz"><img src="../Images/9283513f16bb07df227bc70559890a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*w2iZLqkP0A_TKHeTDiSGbw.png"/></div></a><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">é“å¾·é»‘å®¢çš„å¿«é€Ÿå¯é çš„VPS</figcaption></figure></div></div>    
</body>
</html>