# 我如何专业地使用 Python

> 原文：<https://levelup.gitconnected.com/how-i-have-used-python-professionally-e3f0849be824>

## 尽管我基本上是一个 C#的人，但它总是派上用场。

![](img/02da797a1c1dc1023bfbe8e5019809af.png)

安东尼·里埃拉在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

我是一名全职后端开发人员，我的主要工作通常是 C#和 Oracle——但我仍然有机会一直使用 Python。虽然我更喜欢 C#的结构元素和可靠的类型执行和调试，但每当我需要一个可能会出现也可能不会出现的自动化工作流，但创建一个完整的解决方案似乎有些多余时，Python 就派上了用场。

编写一个 Python 脚本可能只需要五分钟，而且这些任务经常涉及文件系统访问，在我看来 Python 非常可爱和方便。因此，让我谈一谈我在专业环境中发现的 Python 应用程序的用例。

另一个小好处是 Python 可以很好地处理 VS 代码，不像 C#那样，你会错过 ReSharper 和全套 Visual Studio 的其他细节。只需打开一个新文档，写几行代码，然后直接从 VS 代码中的调试器运行它，就可以做你想要做的事情了。

# 解析文件名并提取 id

在我以前的工作中，我们经常不得不处理大量导出的文档，这些文档最终会保存在文件夹、网络驱动器、这样或那样的文件夹中。这常常令人困惑，经常会有最后一分钟的更改或简单的错误，导致正确的文件出现在错误的文件夹中。

手动搜索和找到这些文件中的任何一个都要花上 5 到 10 分钟，而且 Windows search 也不是微软操作系统的典范。所以很自然地，每个人都讨厌这些任务，足以让我坐下来写一点 Python 脚本。它需要一个输入路径列表和一个目标目录，一个包含在文件名中的 id 列表。然后，它将遍历所有文件夹，如果找到文件，它将把它复制到目标目录。

这仍然需要一些手动设置工作，但是正如您所料，查找和复制这些文件只需要几分钟，而不是几个小时。

# 解析 PDF 文件并提取 id

简单的事情有时会变得复杂，在前面的例子中，我们最终得到的不只是一两个文件，而是成千上万个大规模导出文件。然后，在手动检查过程中，我们在生成的实际文本中发现了一些错误，这些错误是基于错误的输入数据，在这些错误出现在最终报告中之前，我们无从得知。

所以现在，我们必须在修复 bug 后重新生成所有受影响的文件，但是如何找出这些文件中哪些需要重新生成呢？我们有受影响的客户 id，但这次没有附加到文件名上，因为它们是按日期和邮政编码分组的。

然而，重新生成所有的文件需要一周的时间，而我们只有不到一天的时间。因此，我们聚在一起，我写了一个小 Python 脚本，打开实际的 PDF 文件，搜索文本，看看它是否包括有问题的部分，然后将这些文件复制到“to_regenerate”文件夹中。与简单地解析文件名相比，这个过程很慢，但是我们聚在一起，在我们可以访问的每台计算机和服务器上运行这个脚本，设法在合理的时间内解析所有这些文件，以重新生成受影响的文件。

这件事能以不同的方式处理吗？当然，本地分布的 Python 文件可能不是这项工作的最佳工具。但是我们有几个小时的空闲时间，实际的剧本可能花了一个小时来写，我处于一种既累又慌的奇怪状态——结果很好。

# 批量重命名文件

当您需要对所有文件应用相同的模式时，重命名文件通常很简单。我经常使用一个名为 batch renamer 的 Windows 工具，它非常强大，支持各种前缀、后缀甚至正则表达式——但它不是很灵活。

如果您需要这个重命名过程的动态组件以及一些 If 条件和分组能力，那么 Python 是您最好的朋友。您只需编写类似“遍历该文件夹中的所有文件”这样的内容，然后编写一系列条件来确定该特定文件是否需要重命名以及如何重命名。

与 RegEx magic 相结合，这允许一些非常详细的规则集，全部在几分钟内完成。

# 批量删除文件

这里，我们将 powershell 和 Python 分开，作为我最喜欢的处理批量删除的方法。Powershell 通常做得很好，也很快——我只是讨厌处理它的语法。Powershell 几乎和 PHP 一模一样，上帝知道，每当我看到变量声明前面的$符号时，我仍然会有战时倒叙。此外，Powershell 有一种令人讨厌的方式，使用模糊的标志和语法，你需要谷歌来理解事情——而 Python 不是这样的。

很像重命名，你可以很容易地做一些像“循环文件，检查条件是否满足，删除文件”。当你的同事手动查看你试图删除的文件时，尽管你的电子邮件不要碰那个文件夹，添加一个 try-catch，然后你可以为自己节省一些白发，并可以在那天晚上他们关闭计算机时解决问题。

# 订购和压缩文件

如果你不得不做不止一次或两次，压缩文件是非常痛苦的。这要花很长时间，仍然是一个重复的过程，当我不得不做得太多的时候，我会痛哭流涕，但这不足以保证真正的自动化。

但有时，你需要一次压缩数百个文件，然后写一点“if file . endswith(file extension):zip . add(file)”就开始有意义了——我的理智得救了。

# 外卖:Python 为我提供了千载难逢的好服务

虽然复杂的东西可以用 Python 来构建，简单的东西可以用 C#来自动化，但我只是喜欢它们都倾向于某个特定方向的方式，并且将它们用于它们的主要优势，这给了我在一个冷酷、艰难的现实中温暖模糊的感觉。