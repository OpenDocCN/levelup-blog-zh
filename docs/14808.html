<html>
<head>
<title>Rust: Option Type Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生锈:选项类型说明</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/rust-option-type-explained-23fe4ccb841b?source=collection_archive---------9-----------------------#2022-12-26">https://levelup.gitconnected.com/rust-option-type-explained-23fe4ccb841b?source=collection_archive---------9-----------------------#2022-12-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a995" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">了解Rust的<code class="fe ko kp kq kr b">Option</code>类型，它表示值的存在或不存在，以及如何使用它来处理可能存在或可能不存在的值。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/27f985263bba3747eabc6a34e4ea75cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uJB2qBaaGR1biF82CBOgw.jpeg"/></div></div></figure><p id="fdd8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">Option</code>类型是Rust编程语言中的一种类型，表示值的存在或不存在。它是一种枚举类型，这意味着它有一组可以接受的固定值。<code class="fe ko kp kq kr b">Option</code>的两个变种是<code class="fe ko kp kq kr b">Some</code>和<code class="fe ko kp kq kr b">None</code>。</p><p id="1228" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是使用<code class="fe ko kp kq kr b">Option</code>的一般语法:</p><pre class="kt ku kv kw gt le kr lf bn lg lh bi"><span id="f430" class="li lj it kr b be lk ll l lm ln">let option: Option&lt;T&gt; = some_function_that_returns_an_option();</span></pre><p id="fd9a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">Option</code>类型有一个类型参数:<code class="fe ko kp kq kr b">T</code>。<code class="fe ko kp kq kr b">T</code>表示可能存在也可能不存在的值的类型。</p><p id="3a47" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是一个例子，说明如何使用<code class="fe ko kp kq kr b">Option</code>来处理一个函数的结果，这个函数可能返回值，也可能不返回值:</p><pre class="kt ku kv kw gt le kr lf bn lg lh bi"><span id="597d" class="li lj it kr b be lk ll l lm ln">fn find(haystack: &amp;str, needle: char) -&gt; Option&lt;usize&gt; {<br/>    for (index, c) in haystack.char_indices() {<br/>        if c == needle {<br/>            return Some(index);<br/>        }<br/>    }<br/>    None<br/>}<br/><br/>fn main() {<br/>    let result = find("hello", 'l');<br/>    match result {<br/>        Some(index) =&gt; println!("Found at index {}", index),<br/>        None =&gt; println!("Not found"),<br/>    }<br/>}</span></pre><p id="6425" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本例中，<code class="fe ko kp kq kr b">find</code>函数接受一个字符串和一个字符，并返回该字符在字符串中第一次出现的索引(如果存在)。如果在字符串中没有找到该字符，则返回<code class="fe ko kp kq kr b">None</code>。</p><p id="b585" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe ko kp kq kr b">main</code>函数中，我们使用一个<code class="fe ko kp kq kr b">match</code>表达式来处理<code class="fe ko kp kq kr b">find</code>函数返回的<code class="fe ko kp kq kr b">Option</code>值。如果值是<code class="fe ko kp kq kr b">Some</code>，我们打印字符的索引。如果值是<code class="fe ko kp kq kr b">None</code>，我们打印一条消息，指出没有找到该字符。</p><p id="952c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您还可以使用<code class="fe ko kp kq kr b">map</code>和<code class="fe ko kp kq kr b">map_or</code>分别转换<code class="fe ko kp kq kr b">Some</code>变量中的值或为<code class="fe ko kp kq kr b">None</code>提供默认值。下面是一个使用这些方法的示例:</p><pre class="kt ku kv kw gt le kr lf bn lg lh bi"><span id="9df2" class="li lj it kr b be lk ll l lm ln">fn find(haystack: &amp;str, needle: char) -&gt; Option&lt;usize&gt; {<br/>    for (index, c) in haystack.char_indices() {<br/>        if c == needle {<br/>            return Some(index);<br/>        }<br/>    }<br/>    None<br/>}<br/><br/>fn main() {<br/>    let result = find("hello", 'l').map(|index| index + 1);<br/>    let index = result.map_or(0, |index| index);<br/>    println!("Index: {}", index);<br/>}</span></pre><p id="ceb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个例子中，我们使用<code class="fe ko kp kq kr b">map</code>方法将<code class="fe ko kp kq kr b">find</code>函数返回的<code class="fe ko kp kq kr b">Option</code>值的<code class="fe ko kp kq kr b">Some</code>变量中的值加1。然后，如果<code class="fe ko kp kq kr b">Option</code>值为<code class="fe ko kp kq kr b">None</code>，我们使用<code class="fe ko kp kq kr b">map_or</code>方法提供默认值0。<code class="fe ko kp kq kr b">index</code>的最终值将是<code class="fe ko kp kq kr b">Some</code>变量内的转换值或默认值0。</p><p id="d53c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">也可以使用<code class="fe ko kp kq kr b">and_then</code>将<code class="fe ko kp kq kr b">Option</code>值链接在一起。下面是一个使用<code class="fe ko kp kq kr b">and_then</code>的例子:</p><pre class="kt ku kv kw gt le kr lf bn lg lh bi"><span id="4663" class="li lj it kr b be lk ll l lm ln">fn parse_int(input: &amp;str) -&gt; Option&lt;i32&gt; {<br/>    match input.parse() {<br/>        Ok(number) =&gt; Some(number),<br/>        Err(_) =&gt; None,<br/>    }<br/>}<br/><br/>fn divide(numerator: i32, denominator: i32) -&gt; Option&lt;i32&gt; {<br/>    if denominator == 0 {<br/>        None<br/>    } else {<br/>        Some(numerator / denominator)<br/>    }<br/>}<br/><br/>fn main() {<br/>    let result = parse_int("10").and_then(|numerator| {<br/>        parse_int("0").and_then(|denominator| {<br/>            divide(numerator, denominator)<br/>        })<br/>    });<br/>    match result {<br/>        Some(result) =&gt; println!("Result: {}", result),<br/>        None =&gt; println!("Error"),<br/>    }<br/>}</span></pre><p id="1405" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个例子中，我们有三个函数:<code class="fe ko kp kq kr b">parse_int</code>，它将一个字符串解析成一个<code class="fe ko kp kq kr b">i32</code>值，并返回一个<code class="fe ko kp kq kr b">Option</code>；<code class="fe ko kp kq kr b">divide</code>，将一个<code class="fe ko kp kq kr b">i32</code>值除以另一个值，返回一个<code class="fe ko kp kq kr b">Option</code>；和<code class="fe ko kp kq kr b">main</code>，它使用<code class="fe ko kp kq kr b">and_then</code>将这两个函数链接在一起。</p><p id="3097" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">parse_int</code>函数接受一个字符串作为输入，并将其解析为一个<code class="fe ko kp kq kr b">i32</code>值。如果解析成功，它将返回一个包含<code class="fe ko kp kq kr b">i32</code>值的<code class="fe ko kp kq kr b">Some</code>变量。如果解析失败，它返回一个<code class="fe ko kp kq kr b">None</code>变量。</p><p id="6bcf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ko kp kq kr b">divide</code>函数将两个<code class="fe ko kp kq kr b">i32</code>值作为输入，如果分母不为零，则返回一个包含除法结果的<code class="fe ko kp kq kr b">Some</code>变量。如果分母为零，则返回一个<code class="fe ko kp kq kr b">None</code>变量。</p><p id="a0a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<code class="fe ko kp kq kr b">main</code>函数中，我们使用<code class="fe ko kp kq kr b">and_then</code>将<code class="fe ko kp kq kr b">parse_int</code>和<code class="fe ko kp kq kr b">divide</code>函数的结果链接在一起。如果这些函数中的任何一个返回一个<code class="fe ko kp kq kr b">None</code>变量，整个链将短路并返回一个<code class="fe ko kp kq kr b">None</code>变量。如果两个函数都返回一个<code class="fe ko kp kq kr b">Some</code>变量，最终结果将是由<code class="fe ko kp kq kr b">divide</code>函数返回的<code class="fe ko kp kq kr b">Some</code>变量。</p><h2 id="e576" class="lo lj it bd lp lq lr dn ls lt lu dp lv kb lw lx ly kf lz ma mb kj mc md me mf bi translated">你想联系吗？</h2><p id="6350" class="pw-post-body-paragraph jq jr it js b jt mg jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj mk kl km kn im bi translated">如果你想联系我，请在LinkedIn上给我打电话。</p><p id="c598" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另外，请随意查看<a class="ae ml" href="https://medium.com/@mr-pascal/my-book-recommendations-4b9f73bf961b" rel="noopener">我的书籍推荐</a>📚。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><div class="kt ku kv kw gt mt"><a href="https://mr-pascal.medium.com/my-book-recommendations-4b9f73bf961b" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">我的书籍推荐</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">在接下来的章节中，你可以找到我对所有日常生活话题的书籍推荐，它们对我帮助很大。</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh lc mt"/></div></div></a></div><div class="ni nj gp gr nk mt"><a href="https://mr-pascal.medium.com/membership" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">通过我的推荐链接加入Medium—Pascal Zwikirsch</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="nc l"><div class="nl l ne nf ng nc nh lc mt"/></div></div></a></div></div></div>    
</body>
</html>