<html>
<head>
<title>JavaScript Tips — Jest Mocks, React Background, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript技巧——笑话模仿、反应背景等等</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-tips-jest-mocks-react-background-and-more-bfd5590e80f7?source=collection_archive---------20-----------------------#2020-07-16">https://levelup.gitconnected.com/javascript-tips-jest-mocks-react-background-and-more-bfd5590e80f7?source=collection_archive---------20-----------------------#2020-07-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/91c2fb499c583f144d9381c706ca47a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KyisqboNzr0IjsFp"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@imperiumnordique?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">海伦娜·赫兹</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="ed78" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="ac59" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Regex来检查字符串是否只包含数字</h1><p id="8090" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以使用正则表达式来检查一个字符串是否只有数字。</p><p id="ab8f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="0c79" class="mq lf it mm b gy mr ms l mt mu">const reg = /^\d+$/;</span></pre><p id="91f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">^</code>从开始匹配字符串，<code class="fe mv mw mx mm b">\d</code>是数字。</p><h1 id="738f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Javascript文件名命名约定</h1><p id="1d62" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">JavaScript文件名应该遵循一些常见的约定。</p><p id="4b01" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该使用全部小写的文件名。</p><p id="f6f3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们不想在文件名中使用空格。</p><p id="63a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以选择使用连字符作为单词分隔符。</p><p id="252b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果有的话，我们还可以在文件名中添加一个版本号。</p><p id="934a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过更新文件名中的版本号，我们总是在旧版本旁边提供带有CDN的最新版本。</p><h1 id="aaa3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从iframe调用父窗口函数</h1><p id="2755" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用<code class="fe mv mw mx mm b">window.parent</code>属性访问父窗口。</p><p id="4aef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，如果我们想从iframe调用父窗口中的函数，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="26db" class="mq lf it mm b gy mr ms l mt mu">&lt;a onclick="parent.foo();" href="#" &gt;click me&lt;/a&gt;</span></pre><p id="4d85" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">foo</code>是父窗口中的顶层函数。</p><h1 id="1453" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">将弹出窗口置于屏幕中央</h1><p id="7518" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了使弹出窗口在屏幕上居中，我们可以做一些计算来使窗口居中，并将其传递给规范字符串。</p><p id="cb81" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="b25c" class="mq lf it mm b gy mr ms l mt mu">const openPopup = (url, title, w, h) =&gt; {<br/>  const left = (screen.width / 2) - (w / 2);<br/>  const top = (screen.height / 2) - (h / 2);<br/>  return window.open(url, title, `width=${w}, height=${h}, top=${top}, left=${top}`);<br/>}</span></pre><p id="6831" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通过用宽度除以2减去宽度除以2得到左上角的x坐标来得到左坐标。</p><p id="dc12" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，我们做同样的事情，但用高度替换宽度，以获得左上角的y坐标。</p><p id="61ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们将它们传递给规范字符串，并对宽度和高度进行同样的处理。</p><h1 id="9b75" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用React内联样式设置背景图像</h1><p id="db73" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要用React内联样式设置背景图像，我们可以将图像作为模块导入。</p><p id="3321" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以把它插入到CSS字符串中来设置背景图片。</p><p id="c45e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="a146" class="mq lf it mm b gy mr ms l mt mu">import Background from '../images/background.png';</span><span id="26e6" class="mq lf it mm b gy my ms l mt mu">const styles = {<br/>  backgroundImage: `url(${Background})`<br/>}</span></pre><p id="7ffb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用带有我们导入的<code class="fe mv mw mx mm b">Background</code>图像的<code class="fe mv mw mx mm b">url</code>字符串来设置<code class="fe mv mw mx mm b">backgroundImage</code>属性。</p><h1 id="5b18" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">删除给定字符后的所有内容</h1><p id="47c4" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要删除字符串中给定字符之后的部分，我们可以使用<code class="fe mv mw mx mm b">split</code>方法。</p><p id="acd6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="fe74" class="mq lf it mm b gy mr ms l mt mu">url.split('?')[0]</span></pre><p id="170c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们在<code class="fe mv mw mx mm b">?</code>之前得到<code class="fe mv mw mx mm b">url</code>字符串的一部分。</p><h1 id="2826" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">JavaScript中闭包的实际用途</h1><p id="9161" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">闭包非常适合隐藏私有的东西，比如我们不想暴露给外界的变量和函数。</p><p id="f612" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="d6d8" class="mq lf it mm b gy mr ms l mt mu">const obj = (() =&gt; {<br/>  const private = () =&gt; {<br/>    console.log('hello');<br/>  }</span><span id="1292" class="mq lf it mm b gy my ms l mt mu">  return {<br/>    public() {<br/>      private();<br/>    }<br/>  }<br/>})();</span></pre><p id="b8c8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">private</code>是私有函数。</p><p id="94a7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而<code class="fe mv mw mx mm b">public</code>是<code class="fe mv mw mx mm b">obj</code>中的一个函数，所以它可以在外部编码。</p><h1 id="8d56" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">获取图像的实际宽度和高度</h1><p id="28ef" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要获得图像的实际宽度和高度，我们可以使用<code class="fe mv mw mx mm b">naturalHeight</code>属性获得实际高度，使用<code class="fe mv mw mx mm b">naturalWidth</code>获得实际宽度。</p><p id="c5b4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="4978" class="mq lf it mm b gy mr ms l mt mu">const height = document.querySelector('img').naturalHeight;</span></pre><p id="0a47" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并且:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="374d" class="mq lf it mm b gy mr ms l mt mu">const width = document.querySelector('img').naturalWidth;</span></pre><p id="ec2a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个从HTML5开始就有了。</p><h1 id="e981" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用Jest模拟ES6模块导入</h1><p id="560a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要使用Jest模拟ES6模块导入，我们可以使用<code class="fe mv mw mx mm b">jest.fn()</code>函数来模拟函数。</p><p id="cba5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><p id="9715" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">logger.js</code></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="087c" class="mq lf it mm b gy mr ms l mt mu">export const log = (y) =&gt; console.log(y)</span></pre><p id="e0d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">module.js</code></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="b1cd" class="mq lf it mm b gy mr ms l mt mu">import { log } from './logger';</span><span id="97fc" class="mq lf it mm b gy my ms l mt mu">export default (x) =&gt; {<br/>  doSomething(x * 2);<br/>}</span></pre><p id="6bf0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx mm b">module.test.js</code></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9586" class="mq lf it mm b gy mr ms l mt mu">import module from '../module';<br/>import * as <!-- -->logger <!-- -->from '../<!-- -->logger<!-- -->';</span><span id="04c1" class="mq lf it mm b gy my ms l mt mu">describe('module test', () =&gt; {<br/>  it('logs the double the input', () =&gt; {<br/>    dependency.<!-- -->log <!-- -->= jest.fn(); <br/>    module(2);<br/>    expect(dependency.<!-- -->log<!-- -->).toBeCalledWith(4);<br/>  });<br/>});</span></pre><p id="e800" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们所要做的就是调用<code class="fe mv mw mx mm b">jest.fn</code>来创建一个模拟函数。</p><p id="23dc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们导入了整个模块，所以成员不是只读的。</p><p id="762b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们可以给它分配我们自己的模拟函数。</p><p id="820e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们调用我们的<code class="fe mv mw mx mm b">module</code>函数来测试我们的函数并检查我们的结果。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/ada2df47dead6241e4275d85142c3460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tpOwvoAEnKUwW76z"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@ttsergey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> TS谢尔盖</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="2e8b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="df63" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们应该遵循一些常见的文件命名惯例来命名JavaScript文件。</p><p id="ca58" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，我们可以用<code class="fe mv mw mx mm b">jest.fn()</code>方法模仿函数。</p><p id="e9b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">弹出窗口可以位于屏幕中央。</p><p id="714d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过导入背景图像并将其插入React组件中的CSS字符串来设置背景图像。</p></div></div>    
</body>
</html>