<html>
<head>
<title>Angular — optimize *ngFor with a custom directive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular使用自定义指令优化*ngFor</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/angular-optimize-ngfor-with-a-custom-directive-3e39504000cd?source=collection_archive---------3-----------------------#2022-05-17">https://levelup.gitconnected.com/angular-optimize-ngfor-with-a-custom-directive-3e39504000cd?source=collection_archive---------3-----------------------#2022-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/75a2e66330e3256b0c8d0fac49988ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*0KcOrOHgYUt4YvkiDI7eBw.png"/></div></figure><p id="9669" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这是一篇关于如何增强Angular内置<a class="ae kv" href="https://angular.io/api/common/NgForOf" rel="noopener ugc nofollow" target="_blank"> *ngFor </a> -directive的短文。<code class="fe kw kx ky kz b">*ngFor</code>是一个广泛使用的角度指令，通过迭代来呈现列表或集合。一个缺点是这会影响应用程序的性能。让我们探究一下原因:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="b347" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们迭代这个团队并输出一个球员列表。现在，如果我们的集合的数据改变了(例如，通过API请求)，Angular不知道哪个项目被添加或删除了。因此，Angular将重新呈现完整的列表。随着列表变得越来越大，这会降低我们的应用程序的速度。</p><p id="3e5b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">为了解决这个问题，我们可以添加一个<code class="fe kw kx ky kz b">trackBy</code>函数。<code class="fe kw kx ky kz b">trackBy</code>函数将索引和当前条目作为参数，并返回一个唯一的标识符。</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="7b10" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">为了避免给每个组件添加一个<code class="fe kw kx ky kz b">trackBy</code>函数，我们可以实现一个自定义指令，只对整个应用程序执行一次:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="5979" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">由于<code class="fe kw kx ky kz b">*ngFor</code>只是该指令的速记语法，它将扩展为长格式(参见<a class="ae kv" href="https://angular.io/api/common/NgForOf#description" rel="noopener ugc nofollow" target="_blank">正式文档</a>，我们可以使用<code class="fe kw kx ky kz b">ngForTrackById</code>作为选择器来选择app中的所有<code class="fe kw kx ky kz b">*ngFor</code>指令。该指令有一个通用类型<code class="fe kw kx ky kz b">T</code>,它扩展了一个自定义的<code class="fe kw kx ky kz b">Item</code>,可以用于所有具有<code class="fe kw kx ky kz b">id</code>属性的集合。</p><p id="a5c2" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在只需在<code class="fe kw kx ky kz b">*ngFor</code>上添加一个<code class="fe kw kx ky kz b">trackById</code>，我们的指令就会被添加:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="0454" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们可以通过添加一个定制属性来代替<code class="fe kw kx ky kz b">id</code>来进一步增强该指令</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="6f8a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">然后我们可以跟踪玩家，例如，通过<code class="fe kw kx ky kz b">name</code></p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="ee85" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在<a class="ae kv" href="https://saackef.com/" rel="noopener ugc nofollow" target="_blank"> Medium </a>或<a class="ae kv" href="https://twitter.com/sw3eks" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，阅读更多关于Angular的内容！</p></div></div>    
</body>
</html>