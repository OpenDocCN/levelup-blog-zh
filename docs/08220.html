<html>
<head>
<title>Deploy Your React Application to AWS Using a Single Command</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用一个命令将React应用程序部署到AWS</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploy-your-react-application-to-aws-in-a-single-command-9b8d960f83df?source=collection_archive---------2-----------------------#2021-04-12">https://levelup.gitconnected.com/deploy-your-react-application-to-aws-in-a-single-command-9b8d960f83df?source=collection_archive---------2-----------------------#2021-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8c8b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将使用一条命令将React应用程序部署到Amazon Web Services Ubuntu机器上。为此，我们将编写一个shell脚本，通过SSH连接到远程主机，并将React应用程序的构建版本复制到远程主机上运行的服务器的www目录中。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/8f6a40767cf3bea1220f3b54093f5247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3abEOdWfkaTLE07mqOnPQ.png"/></div></div></figure><p id="2e61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在AWS上部署可能是一项非常艰巨的任务，尤其是在初级开发人员职业生涯的开始阶段。AWS web界面起初并不是很直观，包含了太多的配置选项，这可能会让任何初学者在它的复杂性面前变得笨拙。本文的目的是向您展示在AWS上配置和启动EC2机器是多么简单，并向您介绍如何通过SSH将文件传输到远程主机。最后，我们将构建一个简单的shell脚本，允许您通过一个命令部署到AWS。这将使你缩短开发和生产之间的时间。在更复杂的应用程序中，您将需要研究更先进的DevOps技术来通过CI/CD管道进行部署，但这将在您的职业生涯中自然而然地实现。</p><p id="b1f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了能够从本文中获得最大收益，您需要满足几个要求:</p><ul class=""><li id="0995" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn lg lh li lj bi translated">AWS帐户</li><li id="bde0" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">简单(或复杂)的React项目</li><li id="86a2" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">私有-公共SSH密钥对:当您创建AWS帐户时，他们会要求您提供SSH密钥。如果你没有，亚马逊会在你注册的时候帮你在线创建。如果你不熟悉SSH，那么值得阅读一下<a class="ae lp" href="https://www.ssh.com/ssh/keygen/" rel="noopener ugc nofollow" target="_blank">这篇文档</a>。</li></ul><p id="7f2e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">注册AWS </strong></p><p id="dad7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，为了能够使用亚马逊云，你需要登录亚马逊网络服务平台。可以在这里报名<a class="ae lp" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank">。您将被要求提供您的信用卡号码。但是不用担心，你不会在没有被通知的情况下被计费。我们在这篇文章中要做的是非常基本的，所以你可以免费建立并运行你的网站！</a></p><p id="f0b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">推出亚马逊虚拟机</strong></p><p id="f4e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了能够启动虚拟机，您需要在注册并验证您的帐户后访问<a class="ae lp" href="https://us-east-2.console.aws.amazon.com/console/home?region=us-east-2#" rel="noopener ugc nofollow" target="_blank"> AWS管理控制台</a>。</p><p id="1525" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">选择启动一个亚马逊虚拟机(EC2)，选择你想要的口味。对于本教程，我们将使用Ubuntu服务器，但是这个选择是完全随意的。你可以选择亚马逊Linux，MacOs甚至Windows Server。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lq"><img src="../Images/437940b069cd0d193d8a06fe6eec29a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0etPMNYVW8gIW5GODJCF5w.png"/></div></div></figure><p id="eed7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在之后的窗口中，您必须选择机器的类型，这将影响机器的性能。对于像本文中这样的简单应用程序，我们不需要太多的计算能力，所以我们将使用t2.micro机器。然而，如果您想要执行非常苛刻的操作，如图像和视频处理、机器学习模型训练甚至简单的游戏服务器，您将需要选择更高性能的基础架构。</p><p id="7592" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您选择一台机器时，AWS为您提供了向虚拟机添加特殊配置甚至添加额外存储的可能性。这在某些应用中可能很有趣。我们不会在此深入探讨更多细节，但如果您想探索这些选项，可以单击“下一步”按钮。因此，在选择机器类型后，我们将选择“查看并启动”选项，这是让我们的虚拟机运行的最快方式。</p><p id="071b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后一部分是配置安全组。这对于能够以安全的方式访问机器至关重要。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lq"><img src="../Images/d1532732e0b7843b12c1740bd1cf3160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TRkmYM9jxRCIlPwYy9lW4g.png"/></div></div></figure><p id="49c4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">安全组充当EC2实例的虚拟防火墙，控制传入和传出流量。入站规则控制您的实例的传入流量，出站规则控制您的实例的传出流量。启动实例时，可以指定一个或多个安全组。如果没有指定安全组，Amazon EC2会使用默认的安全组。您可以向每个安全组添加规则，以允许流量进出其关联的实例。您可以随时修改安全组的规则。新的和修改后的规则会自动应用到与该安全组关联的所有实例。当Amazon EC2决定是否允许流量到达某个实例时，它会评估与该实例相关联的所有安全组的所有规则。</p><p id="567d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在“Security Groups”菜单下，您可以看到目前我们正在创建的虚拟机只能使用SSH进行访问，SSH构建在TCP协议之上，运行在虚拟机的端口22上。来源表示应该从哪里访问机器的IP。因此，从逻辑上讲，这应该只包括您的外部IP，以避免虚拟机被其他人访问。当前值为0.0.0.0/0，表示无处不在。默认情况下，AWS VM被配置为任何人都可以访问。为了本教程的缘故，我们将保留这个选项，但我们必须记住，这对安全性至关重要。</p><p id="8a68" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们希望在虚拟机上运行一个HTTP服务器，以便能够访问我们的网站。该服务器将在端口80上运行，因此我们需要添加一个新的安全组。因此，单击“编辑安全组”并添加在端口80上运行的HTTP，使它可以从任何地方访问。</p><p id="0442" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完成此配置后，您就可以启动虚拟机了。</p><p id="cd5a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">在EC2实例上安装Nginx</strong></p><p id="c511" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">既然我们已经启动并运行了我们的VM，我们将需要在它上面安装一个web服务器，允许我们远程访问我们的React应用程序。</p><p id="03d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为此，您有两个选择:</p><ul class=""><li id="c844" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn lg lh li lj bi translated">要么使用SSH直接访问您的虚拟机，然后手动安装Nginx服务器</li><li id="72ae" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">或者进入自动配置，尝试使用Ansible自动安装Nginx</li></ul><p id="982b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">出于教育目的，我个人强烈建议你尝试第二种选择。在这种情况下，手动安装Nginx可能更容易，但是当您处理需要在不同虚拟机而不是一个虚拟机上进一步配置的大型应用程序时，您会发现自动配置过程至关重要。</p><p id="88c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有关使用Ansible进行供应的简单教程，您可以查看这篇文章:</p><div class="lr ls gp gr lt lu"><a href="https://salibas.medium.com/an-introduction-to-web-server-provisioning-configure-and-set-up-your-aws-vm-automatically-using-b0fe8e334424" rel="noopener follow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">Web服务器配置简介:使用…自动配置和设置AWS VM</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">在本文中，我们将探讨如何自动配置我们的云虚拟机。在云中设置我们的机器…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">salibas.medium.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi kz lu"/></div></div></a></div><p id="aaf0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想使用第一个选项，您可以使用SSH手动连接到您的AWS，方法是转到实例详细信息并单击“连接到实例”。选择SSH选项并按照步骤操作。</p><p id="6ec9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您连接到虚拟机时，执行以下命令来安装nginx:</p><pre class="kq kr ks kt gt mj mk ml mm aw mn bi"><span id="e199" class="mo mp it mk b gy mq mr l ms mt">sudo apt update<br/>sudo apt install nginx</span></pre><p id="04ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">将您的本地React构建转移到您的EC2实例</strong></p><p id="9110" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在React项目目录中，创建一个名为<code class="fe mu mv mw mk b">deploy.sh</code>的文件。在此文件中，我们将编写shell脚本来自动构建文件并将其传输到虚拟机:</p><pre class="kq kr ks kt gt mj mk ml mm aw mn bi"><span id="6ede" class="mo mp it mk b gy mq mr l ms mt">#!/bin/sh </span><span id="4c76" class="mo mp it mk b gy mx mr l ms mt">cd /Users/[path/to/your/react/project/root/directory] </span><span id="1c2e" class="mo mp it mk b gy mx mr l ms mt">echo “Building React Project …” <br/>npm run build </span><span id="a8d1" class="mo mp it mk b gy mx mr l ms mt">echo “Copying html file …” <br/>cp -r build html </span><span id="f4bc" class="mo mp it mk b gy mx mr l ms mt">echo “Connecting to AWS VM and copying file to /var/www/html/ …” sudo scp -i [/path/to/your/registered/private/key] -r html [<a class="ae lp" href="mailto:ubuntu@ec2-18-216-216-23.us-east-2.compute.amazonaws.com" rel="noopener ugc nofollow" target="_blank">ubuntu@ec2–xx–xxx–xxx–xx.us-east-2.compute.amazonaws.com</a>]:/var/www </span><span id="334a" class="mo mp it mk b gy mx mr l ms mt">echo “Removing html file from local directory …” <br/>rm -r html</span></pre><p id="3a66" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mu mv mw mk b">scp</code>命令将使用SSH将文件传输到您的EC2。您需要拥有AWS注册的私有/公共密钥对。这些钥匙通常存放在<code class="fe mu mv mw mk b">/Users/yourusername/.ssh/</code>内。</p><p id="e8c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您需要将scp命令中的URL替换为虚拟机的公共IPv4 DNS。当您单击您的实例时，您可以在“实例详细信息”页面中找到它。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi my"><img src="../Images/a2864012651258f134154ec8073d813e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ti-Gxoz6YXAhGJmfzfHYzw.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">实例详细信息页面</figcaption></figure><p id="4417" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过在React项目主目录中执行<code class="fe mu mv mw mk b">./deploy.sh</code>来运行下面的脚本。</p><p id="a4f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从浏览器访问您机器的公共IPv4 DNS，并查看您的React页面！</p></div></div>    
</body>
</html>