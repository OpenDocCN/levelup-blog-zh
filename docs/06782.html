<html>
<head>
<title>Building a Website Starter with FastAPI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用FastAPI构建网站启动器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/building-a-website-starter-with-fastapi-92d077092864?source=collection_archive---------0-----------------------#2020-12-31">https://levelup.gitconnected.com/building-a-website-starter-with-fastapi-92d077092864?source=collection_archive---------0-----------------------#2020-12-31</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="6ee0" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">快速API入门</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/8bad48eb5cdf84197f5af4a4586e5934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wLIWOKyAsEp0tu1MfcN7yw.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=4890800" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae kz" href="https://pixabay.com/users/wikiimages-1897/" rel="noopener ugc nofollow" target="_blank">维基图片</a></figcaption></figure><p id="e8d1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[更新:2022–1–18 Python依赖项和引导5]</p><h1 id="f90f" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">介绍</h1><p id="399d" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">在本文中，我们将使用<a class="ae kz" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI </a>、<a class="ae kz" href="https://jinja.palletsprojects.com/en/2.11.x/templates/" rel="noopener ugc nofollow" target="_blank"> Jinja2Templates </a>和<a class="ae kz" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank"> Bootstrap </a>创建一个简单的静态网站启动器。您可以以此为基础，根据自己的需要填充特定于站点的路线和模板/视图。</p><p id="6728" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">FastAPI是一个现代、快速(高性能)的web框架，用于基于标准Python类型提示用Python 3.6+构建API。</p><p id="486a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以跟随本文一起编写代码，或者下载文件。</p><p id="d9cf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://fastapi-webstarter-demo.deta.dev/" rel="noopener ugc nofollow" target="_blank">演示</a></p><p id="886f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你想免费托管你的FastAPI app，请阅读Heroku的<a class="ae kz" href="https://medium.com/mkdir-awesome/from-heroku-to-deta-to-host-python-project-for-free-1e967139e234" rel="noopener"> <strong class="lc iv">到Deta免费托管Python项目</strong> </a> <strong class="lc iv"> <em class="mt">。</em> </strong></p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="ce43" class="mz lx iu mv b gz na nb l nc nd"><strong class="mv iv">Table of Contents</strong><br/>· <a class="ae kz" href="#16e4" rel="noopener ugc nofollow">Creating a Virtual Environment</a><br/>· <a class="ae kz" href="#9a58" rel="noopener ugc nofollow">Creating a GitHub Repository (Optional)</a><br/>· <a class="ae kz" href="#6052" rel="noopener ugc nofollow">Structure</a><br/>· <a class="ae kz" href="#2bac" rel="noopener ugc nofollow">How to Use requirements.txt</a><br/>· <a class="ae kz" href="#eb36" rel="noopener ugc nofollow">Creating app/main.py</a><br/>· <a class="ae kz" href="#499c" rel="noopener ugc nofollow">How to Add JinjaTemplates to FastAPI</a><br/>· <a class="ae kz" href="#ed7a" rel="noopener ugc nofollow">How to Add Static Files to FastAPI</a><br/>· <a class="ae kz" href="#78ed" rel="noopener ugc nofollow">How to Use Jinja Templates</a><br/>  ∘ <a class="ae kz" href="#54eb" rel="noopener ugc nofollow">Creating base.html and other HTML files</a><br/>· <a class="ae kz" href="#a31f" rel="noopener ugc nofollow">How to Add Markdown Pages to FastAPI</a><br/>· <a class="ae kz" href="#2024" rel="noopener ugc nofollow">How to Import Other Python Files in FastAPI</a><br/>· <a class="ae kz" href="#c05b" rel="noopener ugc nofollow">How to Add Routers to FastAPI</a><br/>· <a class="ae kz" href="#6a55" rel="noopener ugc nofollow">How to Add .env File</a><br/>· <a class="ae kz" href="#846c" rel="noopener ugc nofollow">How to Add Active Class to Menu</a><br/>· <a class="ae kz" href="#e696" rel="noopener ugc nofollow">Form: How to Add More Than One Form to FastAPI</a><br/>· <a class="ae kz" href="#0133" rel="noopener ugc nofollow">How to Add a Bootstrap Accordion Menu</a><br/>· <a class="ae kz" href="#69f2" rel="noopener ugc nofollow">Testing</a><br/>· <a class="ae kz" href="#7cf8" rel="noopener ugc nofollow">Conclusion</a><br/>· <a class="ae kz" href="#a3d9" rel="noopener ugc nofollow">Newsletter</a><br/>· <a class="ae kz" href="#427d" rel="noopener ugc nofollow">References</a></span></pre><h1 id="16e4" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">创建虚拟环境</h1><p id="0864" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">开始之前，让我们设置我们的虚拟环境。<br/>我将使用<a class="ae kz" href="https://towardsdatascience.com/python-environment-101-1d68bda3094d" rel="noopener" target="_blank"> pyenv + pyenv-vitualenv </a>，你可以找到关于<a class="ae kz" href="https://towardsdatascience.com/python-environment-101-1d68bda3094d#258a" rel="noopener" target="_blank"> pyenv和pyenv-virtualenv </a>的更多细节。</p><p id="9884" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">对于macOS用户:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="8a0e" class="mz lx iu mv b gz na nb l nc nd">$ brew install pyenv <br/>$ pyenv install 3.9.6<br/>$ brew pyenv-virtualenv<br/>$ pyenv virtualenv 3.9.6 py396<br/>$ mkdir my-fastapi-starter<br/>$ cd my-fastapi-starter</span></pre><h1 id="9a58" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">创建GitHub存储库(可选)</h1><p id="4e41" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">你可以使用<a class="ae kz" href="https://towardsdatascience.com/automate-creating-a-new-github-repository-with-gitstart-1ae961b99866" rel="noopener" target="_blank"> Gitstart </a>创建一个新的Github repo。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="dd22" class="mz lx iu mv b gz na nb l nc nd">$ gitstart -d . -l python</span></pre><p id="31eb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这将为Python添加run <code class="fe ne nf ng mv b">git init</code>，添加READM.md和<code class="fe ne nf ng mv b"><a class="ae kz" href="https://github.com/github/gitignore/blob/master/Python.gitignore" rel="noopener ugc nofollow" target="_blank">.gitignore</a></code>。它会推送至你的Github账户。</p><h1 id="6052" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">结构</h1><p id="dada" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">以下是项目结构。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="64e0" class="mz lx iu mv b gz na nb l nc nd">.<br/>├── README.md<br/>├── app<br/>│   ├── __init__.py<br/>│   ├── library<br/>│   │   ├── __init__.py<br/>│   │   └── helpers.py<br/>│   ├── main.py<br/>│   ├── pages<br/>│   │   ├── about.md<br/>│   │   ├── contact.md<br/>│   │   ├── home.md<br/>│   │   ├── info.md<br/>│   │   └── portfolio.md<br/>│   └── routers<br/>│       ├── __init.py<br/>│       ├── accordion.py<br/>│       ├── twoforms.py<br/>│       └── unsplash.py<br/>├── requirements.txt<br/>├── runtime.txt<br/>├── static<br/>│   ├── css<br/>│   │   ├── mystyle.css<br/>│   │   └── style3.css<br/>│   ├── images<br/>│   │   ├── favicon.ico<br/>│   │   └── logo.svg<br/>│   └── js<br/>│       └── index.js<br/>├── templates<br/>│   ├── accordion.html<br/>│   ├── base.html<br/>│   ├── include<br/>│   │   ├── sidebar.html<br/>│   │   └── topnav.html<br/>│   ├── page.html<br/>│   ├── twoforms.html<br/>│   └── unsplash.html<br/>└── tests<br/>    ├── __init__.py<br/>    └── test_main.py</span></pre><p id="0237" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们将为这个项目使用多个文件。在根目录下，我们创建了<code class="fe ne nf ng mv b">app</code>、<code class="fe ne nf ng mv b">static</code>、<code class="fe ne nf ng mv b">templates</code>和<code class="fe ne nf ng mv b">test</code>目录。因为它是一个Python包，我们在所有包含Python文件的目录中添加了一个空的<code class="fe ne nf ng mv b">__init__.py</code>文件。我们在<code class="fe ne nf ng mv b">app/library/helpers.py</code>中保留了所有的辅助函数。我们在<code class="fe ne nf ng mv b">app/pages</code>目录中为网页编写markdown文件。我们将所有静态文件保存在<code class="fe ne nf ng mv b">static</code>目录中，将所有模板保存在<code class="fe ne nf ng mv b">templates</code>目录中。</p><h1 id="2bac" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何使用requirements.txt</h1><p id="41d4" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">在根目录下创建<code class="fe ne nf ng mv b">requirements.txt</code>。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="c6b5" class="mz lx iu mv b gz na nb l nc nd">requests==2.26.0<br/>fastapi==0.70.0<br/>uvicorn==0.15.0<br/>python-dotenv==0.19.1<br/>aiofiles==0.7.0<br/>python-multipart==0.0.5<br/>jinja2==3.0.2<br/>Markdown==3.3.4<br/>pytest==6.2.5</span></pre><p id="404d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们需要<code class="fe ne nf ng mv b">fastapi</code>和<code class="fe ne nf ng mv b">uvicorn</code>来使用FastAPI。我们使用<code class="fe ne nf ng mv b">jinja2</code>作为模板引擎，<code class="fe ne nf ng mv b">aiofiles</code>作为静态文件，<code class="fe ne nf ng mv b">python-dotenv</code>作为环境变量。<code class="fe ne nf ng mv b">python-multipart</code>是为了一个表格。<code class="fe ne nf ng mv b">requests</code>是一个HTTP库。我们使用<code class="fe ne nf ng mv b">Markdown</code>来渲染降价文件。</p><p id="067a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们从这个rquirements.txt安装Python包。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="09ca" class="mz lx iu mv b gz na nb l nc nd">$ pip install -r requirements.txt</span></pre><h1 id="eb36" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">正在创建app/main.py</h1><p id="4aa3" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我们从<code class="fe ne nf ng mv b">app/main.py</code>开始。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="a4b8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后在您的终端上运行:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="0d8c" class="mz lx iu mv b gz na nb l nc nd">$ uvicorn app.main:app --reload --port 8080</span></pre><p id="d40b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在您的浏览器上访问<a class="ae kz" href="http://127.0.0.1:8080/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8080/ </a>和<a class="ae kz" href="http://127.0.0.1:8080/page/about" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8080/page/about</a>。你可以看到第一页。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nj"><img src="../Images/19d9d4cc190e7c0d92d0baca020aeac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*34rqFetBR19BmLJfJwljzA.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="http://127.0.0.1:8080/page/about" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8080/page/关于</a>图片作者</figcaption></figure><p id="210d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">注意:</strong>当你运行根目录下的<code class="fe ne nf ng mv b">main.py</code>时:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="7acc" class="mz lx iu mv b gz na nb l nc nd">$ uvicorn main:app --reload</span></pre><p id="22d5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为我们把<code class="fe ne nf ng mv b">main.py</code>移到了<code class="fe ne nf ng mv b">app/main.py</code>，所以我们需要换到<code class="fe ne nf ng mv b">uvicorn app.main:app</code>来运行这个应用程序。我们也可以将端口号设置为<code class="fe ne nf ng mv b">--port 8080</code>。</p><h1 id="499c" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何将JinjaTemplates添加到FastAPI</h1><p id="9964" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">Jinja是一种现代的、设计者友好的Python模板语言。</p><p id="4749" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们添加Jinja模板引擎并创建<code class="fe ne nf ng mv b">templates/page.html</code>。</p><p id="4d7e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在你的<code class="fe ne nf ng mv b">app/main.py</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="c3e9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第1行:从<code class="fe ne nf ng mv b">fastapi</code>导入<code class="fe ne nf ng mv b">Request</code>。<br/>第7行:导入<code class="fe ne nf ng mv b">Jinja2Templates</code>，设置模板目录<code class="fe ne nf ng mv b">templates</code>。<br/>第10行&amp; 18:追加<code class="fe ne nf ng mv b">request</code>作为参数。<br/>第14行&amp; 22:添加<code class="fe ne nf ng mv b">request</code>作为返回值。<br/>第9行&amp; 17:指定<code class="fe ne nf ng mv b">response_class</code>至<code class="fe ne nf ng mv b">HTMLResponse</code>。<br/>第14行&amp; 22:返回<code class="fe ne nf ng mv b">templates.TemplateResponse()</code>页面HTML和数据。</p><p id="8c09" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">更新<code class="fe ne nf ng mv b">template/page.html</code>:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="eed2" class="mz lx iu mv b gz na nb l nc nd">&lt;h1&gt;<br/>    Welcome to FastAPI Starter.<br/>&lt;/h1&gt;</span><span id="44cd" class="mz lx iu mv b gz nk nb l nc nd">{{data.page}}</span></pre><p id="f062" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用<code class="fe ne nf ng mv b">{{variable}}</code>来显示从<code class="fe ne nf ng mv b">app/main.py</code>文件发送的值。</p><p id="86e2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在您的浏览器上访问<a class="ae kz" href="http://127.0.0.1:8080/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8080/ </a>和<a class="ae kz" href="http://127.0.0.1:8080/page/about" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8080/page/about</a>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nl"><img src="../Images/43a4ddc9144606662db795be36809db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2URlfFHMhGtbj95wWNx1EA.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="http://127.0.0.1:8080/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8080/ </a>图片作者</figcaption></figure><h1 id="ed7a" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何向FastAPI添加静态文件</h1><p id="f016" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">通过添加以下内容更新<code class="fe ne nf ng mv b">app/main.py</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="79c4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第3行:从<code class="fe ne nf ng mv b">fastapi.staticfiles</code>导入<code class="fe ne nf ng mv b">StaticFiles</code>。<br/>亚麻9:挂载<code class="fe ne nf ng mv b">static</code>目录。</p><h1 id="78ed" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何使用Jinja模板</h1><h2 id="54eb" class="mz lx iu bd ly nm nn dn mc no np dp mg lj nq nr mi ln ns nt mk lr nu nv mm nw bi translated">创建base.html和其他HTML文件</h2><p id="c0d4" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我们将使用<a class="ae kz" href="https://bootstrapious.com/p/bootstrap-sidebar" rel="noopener ugc nofollow" target="_blank">引导工具条</a>。这将加载<a class="ae kz" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank">引导程序4 </a>和<a class="ae kz" href="https://fontawesome.com/" rel="noopener ugc nofollow" target="_blank">字体Awesome </a>。请找到<a class="ae kz" href="https://bootstrapious.com/tutorial/sidebar/index3.html" rel="noopener ugc nofollow" target="_blank">边栏演示</a>。我们将jQuery slim版本改为完整版本，这样<strong class="lc iv">我们就可以使用AJAX </strong>。</p><p id="a3d8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请使用自己的字体牛逼套件。你可以从Fontawesome网站免费注册。</p><p id="dc05" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建<code class="fe ne nf ng mv b">templates/base.html </code>和<code class="fe ne nf ng mv b">templates/include/sidebar.html</code>。</p><p id="bb02" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe ne nf ng mv b">base.html</code> <strong class="lc iv"> : </strong></p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="43c4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://jinja.palletsprojects.com/en/2.11.x/templates/#" rel="noopener ugc nofollow" target="_blank"> Jinja模板</a>使用<code class="fe ne nf ng mv b">{% block head %}{% end block %}</code>、<code class="fe ne nf ng mv b">{% block page_content %}{% endblock %}</code>和<code class="fe ne nf ng mv b">{% block scripts %}{% endblock %}</code>从子HTML中插入内容。<br/>使用<code class="fe ne nf ng mv b">{% include 'include/sidebar.html' %}</code>来包含另一个HTML文件。当你从<code class="fe ne nf ng mv b">static</code>目录加载文件时，像这样使用它们:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="bea7" class="mz lx iu mv b gz na nb l nc nd">{{ url_for('static', path='/images/favicon.png') }}</span></pre><p id="40b4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">修改</strong> <code class="fe ne nf ng mv b"><strong class="lc iv">templates/page.html</strong></code> <strong class="lc iv"> : </strong></p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="2f20" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe ne nf ng mv b">{% extends "base.html" %}</code>告诉模板引擎这个模板“扩展”了另一个模板<code class="fe ne nf ng mv b">base.html</code>。<code class="fe ne nf ng mv b">{{ super() }}</code>确保加载父内容。</p><p id="2a68" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe ne nf ng mv b"><strong class="lc iv">templates/include/sidebar.html</strong></code>T32:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="8e78" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">添加<code class="fe ne nf ng mv b">templates/include/topnav.html</code>并使用<a class="ae kz" href="https://gist.github.com/shinokada/a090746256cc2abbd45489040260e0c7" rel="noopener ugc nofollow" target="_blank">该代码</a>。<br/>使用此<a class="ae kz" href="https://gist.github.com/shinokada/0090654be57ca9d8a0001f7770a9171f" rel="noopener ugc nofollow" target="_blank">样式代码</a>添加<code class="fe ne nf ng mv b">static/css/style3.css</code>。</p><p id="0612" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">到目前为止，您应该已经有了一个工作模板。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nx"><img src="../Images/faca92585c6b0f919e52f16e2fbda963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*FERfT75vFl8ze5h61nujXQ.gif"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">带有侧边栏的模板。图片作者。</figcaption></figure><p id="eeca" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建<code class="fe ne nf ng mv b">static/css/mystyle.css</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="1812" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们在这个文件中添加我们的样式代码。</p><h1 id="a31f" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何向FastAPI添加降价页面</h1><p id="88be" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">使用Markdown比在Python文件中编写HTML容易得多。</p><p id="6788" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以在<code class="fe ne nf ng mv b">app/library</code>目录中添加您的所有助手代码。我们将创建<code class="fe ne nf ng mv b">app/library/helpers.py</code>文件。这里我们添加一个助手函数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="729b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该函数获取<code class="fe ne nf ng mv b">app/pages</code>中的markdown文件，将其转换为HTML并返回。</p><h1 id="2024" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何在FastAPI中导入其他Python文件</h1><p id="2e42" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">在我们的<code class="fe ne nf ng mv b">app/main.py</code>:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="ae1c" class="mz lx iu mv b gz na nb l nc nd">from .library.helpers import *</span></pre><p id="409d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这将从<code class="fe ne nf ng mv b">library/helpers.py</code>文件导入所有功能。现在我们可以使用<code class="fe ne nf ng mv b">app/main.py</code>中的<code class="fe ne nf ng mv b">openfile()</code>功能:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="02d3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们创建<code class="fe ne nf ng mv b">app/pages/home.md</code>、<code class="fe ne nf ng mv b">app/pages/about.md</code>和<code class="fe ne nf ng mv b">app/pages/info.md</code>。添加一些虚拟降价文本。</p><p id="e76d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe ne nf ng mv b">app/pages/home.md</code>:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="3551" class="mz lx iu mv b gz na nb l nc nd"># Welcome FastAPI Web Starter<br/>This project uses [FastAPI](<a class="ae kz" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank">https://fastapi.tiangolo.com/</a>), [Jinja2](<a class="ae kz" href="https://jinja.palletsprojects.com/en/2.11.x/" rel="noopener ugc nofollow" target="_blank">https://jinja.palletsprojects.com/en/2.11.x/</a>), and [Bootstrap4](<a class="ae kz" href="https://getbootstrap.com/docs/4.1/getting-started/introduction/" rel="noopener ugc nofollow" target="_blank">https://getbootstrap.com/docs/4.1/getting-started/introduction/</a>).</span></pre><p id="5ffa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个设置也允许我们使用普通的HTML标签。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="5ce7" class="mz lx iu mv b gz na nb l nc nd">&lt;div id="myarticle"&gt;<br/>&lt;h1&gt;Welcome to FastAPI Starter&lt;/h1&gt;<br/>&lt;p&gt;<br/>Please read &lt;a href="https://levelup.gitconnected.com/building-a-website-starter-with-fastapi-92d077092864"&gt;my Medium article.&lt;/a&gt;<br/>&lt;/p&gt;<br/>&lt;p&gt;<br/>This project uses &lt;a href="https://fastapi.tiangolo.com/"&gt;FastAPI&lt;/a&gt;, &lt;a href="https://jinja.palletsprojects.com/en/2.11.x/"&gt;Jinja2&lt;/a&gt;, and &lt;a href="https://getbootstrap.com/docs/4.1/getting-started/introduction/"&gt;Bootstrap4&lt;/a&gt;.<br/>&lt;/p&gt;<br/>&lt;/div&gt;</span></pre><p id="2e88" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe ne nf ng mv b">app/pages/about.md</code>:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="9173" class="mz lx iu mv b gz na nb l nc nd"># About</span><span id="5e89" class="mz lx iu mv b gz nk nb l nc nd">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse velit nunc, tincidunt sed tempus eget, luctus venenatis ex. Morbi et felis pharetra, rhoncus erat et, feugiat ipsum...</span></pre><p id="ca27" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe ne nf ng mv b">app/pages/info.md</code>:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="15d6" class="mz lx iu mv b gz na nb l nc nd"># Information</span><span id="6b23" class="mz lx iu mv b gz nk nb l nc nd">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse velit nunc, tincidunt sed tempus eget, luctus venenatis ex. Morbi et felis pharetra, rhoncus erat et, feugiat ipsum...</span></pre><p id="e4c3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们需要更新<code class="fe ne nf ng mv b">templates/page.html</code>:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="a0b6" class="mz lx iu mv b gz na nb l nc nd">&lt;main role="main" class="container"&gt;<br/>    &lt;div class="row"&gt;<br/>        &lt;div class="col"&gt;<br/>            {{data.text|safe}}<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/main&gt;&lt;!-- /.container --&gt;</span></pre><p id="2e4f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Jinja的内置过滤器，<code class="fe ne nf ng mv b"><a class="ae kz" href="https://jinja.palletsprojects.com/en/2.11.x/templates/?highlight=safe#safe" rel="noopener ugc nofollow" target="_blank">safe</a></code> <a class="ae kz" href="https://jinja.palletsprojects.com/en/2.11.x/templates/?highlight=safe#safe" rel="noopener ugc nofollow" target="_blank">允许我们使用变量而不用转义。</a></p><p id="6d9e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">访问<a class="ae kz" href="http://127.0.0.1:8080/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8080/ </a>:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ny"><img src="../Images/14a720d9de561366809bf93f10b38de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J7YK-WjxSGUnavDXhAnhPQ.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">对主页使用Markdown。图片作者。</figcaption></figure><p id="59c7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">访问<a class="ae kz" href="http://127.0.0.1:8080/page/info" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8080/page/info</a>:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nz"><img src="../Images/f935c97992443301b39da0c24e2ce446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPIgRq5ekH8UZtINkYJvww.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">对信息页面使用降价。图片作者。</figcaption></figure><p id="fb70" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">添加更多页面后，我们可以更新<code class="fe ne nf ng mv b">templates/include/sidebar</code>和<code class="fe ne nf ng mv b">templates/include/topnav</code>。</p><p id="0fb2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你添加一个链接<code class="fe ne nf ng mv b">/page/portfolio</code>，那么你需要创建一个页面<code class="fe ne nf ng mv b">app/pages/portfolio.md</code>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nx"><img src="../Images/fd22184c0429475d4437fd18f4a4c03a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vZEgY2ikW2nhCJioImyQ1A.gif"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">侧边栏正在运行。图片作者。</figcaption></figure><h1 id="c05b" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何向FastAPI添加路由器</h1><p id="ce44" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">当你的项目变大时，你需要组织你的文件。一种方法是使用路由器。</p><p id="a145" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在<code class="fe ne nf ng mv b">app/main.py</code>中，从<code class="fe ne nf ng mv b">routers</code>目录导入文件，使用<code class="fe ne nf ng mv b">include_router()</code>添加路径。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="90d2" class="mz lx iu mv b gz na nb l nc nd">from app.routers import unsplash</span><span id="a920" class="mz lx iu mv b gz nk nb l nc nd">app.include_router(unsplash.router)</span></pre><p id="9373" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建<code class="fe ne nf ng mv b">app/routers/unsplash.py</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="dcac" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第1行:从<code class="fe ne nf ng mv b">fastapi</code>导入<code class="fe ne nf ng mv b">APIRouter</code>。<br/>第7行:追加<code class="fe ne nf ng mv b">router = APIRouter()</code>。<br/>第9行:用<code class="fe ne nf ng mv b">@router</code>代替<code class="fe ne nf ng mv b">@app</code>。</p><p id="9e10" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以上路线使用<code class="fe ne nf ng mv b">templates/unsplash.html</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="9161" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这将从Unsplash中随机搜索图像。请在这里找到更多关于<a class="ae kz" href="https://unsplash.com/documentation" rel="noopener ugc nofollow" target="_blank"> Unsplash API的信息</a>。</p><p id="70ae" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们在顶部导航中有Unsplash菜单。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/cb4c1cd9c0ce98eb8cccd0156be83339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*UUnYmkwGawfooCTw_XxIWA.gif"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">顶部菜单中的取消飞溅。图片作者。</figcaption></figure><h1 id="6a55" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何添加。环境文件</h1><p id="2d67" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">当你想使用其他API或服务时，你需要存储像<code class="fe ne nf ng mv b">access</code>或<code class="fe ne nf ng mv b">secret</code>这样的外部设置。例如，<a class="ae kz" href="https://unsplash.com/documentation#creating-a-developer-account" rel="noopener ugc nofollow" target="_blank"> UnsplashAPI </a>提供访问密钥和秘密密钥。你不应该公开这些。通常，您将这些键保存在<code class="fe ne nf ng mv b">.env</code>或一个环境文件中。您的<code class="fe ne nf ng mv b">.gitignore</code>文件应该包含<a class="ae kz" href="https://gist.github.com/shinokada/9d10cea9b76c64487ebd7d2ac8a173dd" rel="noopener ugc nofollow" target="_blank">您的环境文件</a>。</p><p id="524d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当你运行<code class="fe ne nf ng mv b">pip install -r requirements.txt</code>时，我们已经安装了<a class="ae kz" href="https://pypi.org/project/python-dotenv/" rel="noopener ugc nofollow" target="_blank"> python-dotenv </a>。</p><p id="8fb4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在根目录下创建<code class="fe ne nf ng mv b">.env</code>文件。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="ebca" class="mz lx iu mv b gz na nb l nc nd">unsplash_key=12345<br/>unsplash_secret=67890</span></pre><p id="4a1d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">修改<code class="fe ne nf ng mv b">app/routers/unsplash.py</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="8cd2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第1行:导入os模块。<br/>第6–7行:导入<code class="fe ne nf ng mv b">load_dotenv</code>并初始化。第16行:使用<code class="fe ne nf ng mv b">os.getenv</code>返回环境变量的值。</p><p id="9f56" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，我们只是把它们打印到终端上。</p><p id="ccfe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">重启</strong>服务器:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="8b06" class="mz lx iu mv b gz na nb l nc nd">$ uvicorn app.main:app --reload --port 8080</span></pre><p id="713a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">并访问<a class="ae kz" href="http://127.0.0.1:8080/unsplash" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8080/unsplash</a>查看您的终端:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/49b608699f6f64e1f451ba1f57349630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9P813dg9G8zcfCr6lZQH0g.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">检查终端的环境变量输出。图片作者。</figcaption></figure><h1 id="846c" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何将活动类添加到菜单</h1><p id="9344" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">让我们给顶部的导航项目添加一个类<code class="fe ne nf ng mv b">active</code>，这样当你在那个页面上时，它会高亮显示导航项目。</p><p id="e5a2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">更新<code class="fe ne nf ng mv b">templates/include/topnav.html</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="4303" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第16、19、22行:我们为每个列表项添加了<code class="fe ne nf ng mv b">{{'active' if active_page == 'page_name' }}</code>。您需要相应地更改<code class="fe ne nf ng mv b">page_name</code>。</p><p id="cde0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过添加以下行来更新<code class="fe ne nf ng mv b">templates/unsplash.html</code>:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="eb0c" class="mz lx iu mv b gz na nb l nc nd">{% set active_page = "unsplash" %}</span></pre><p id="df11" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这将变量<code class="fe ne nf ng mv b">active_page</code>设置为<code class="fe ne nf ng mv b">unsplash</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="0d9b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们创建<code class="fe ne nf ng mv b">templates/twoforms.html</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="3e49" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第2行:我们将<code class="fe ne nf ng mv b">active_page</code>设置为<code class="fe ne nf ng mv b">twoforms</code>。</p><p id="9382" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe ne nf ng mv b">templates/accordion.html</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="3d19" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第2行:我们在上面的文件中将<code class="fe ne nf ng mv b">active_page</code>设置为<code class="fe ne nf ng mv b">accordion</code>。</p><p id="545a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Unsplash菜单应该显示活动类。我们将在下一节介绍两个表单和折叠页面。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oc"><img src="../Images/9106dc05e1544c6bc895f5b1fea250ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OGNMbbzkntLS_SeB0cpExA.gif"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">菜单项中的“活动”类。图片作者。</figcaption></figure><h1 id="e696" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">表单:如何向FastAPI添加多个表单</h1><p id="89ef" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">你可以找到关于如何定义文件和表单域的<a class="ae kz" href="https://fastapi.tiangolo.com/tutorial/request-forms-and-files/" rel="noopener ugc nofollow" target="_blank"> FastAPI文档。</a></p><p id="2954" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里，我们将添加两个表单。</p><p id="617e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过添加路由器更新<code class="fe ne nf ng mv b">app/main.py</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="e7a3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">FastAPI使用了<code class="fe ne nf ng mv b">python-multipart</code>，我们已经安装了它。(请参见requirements.txt。)</p><p id="6390" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">更新<code class="fe ne nf ng mv b">templates/twoforms.html</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="8288" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第18 &amp; 24行:我们添加了不同的动作链接。第14–16行:使用Jinja的if语句显示结果。</p><p id="f78e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建<code class="fe ne nf ng mv b">app/routers/twoforms.py</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="05e6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一行:我们从<code class="fe ne nf ng mv b">fastapi</code>进口<code class="fe ne nf ng mv b">Form</code>。<br/>第2行:添加<code class="fe ne nf ng mv b">HTMLResponse</code>渲染HTML。我们创建了两个不同的端点。<br/>第16行&amp; 22:我们指定<code class="fe ne nf ng mv b">number</code>参数。数字字段将作为表单数据上传，并在每个post函数中接收它。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj od"><img src="../Images/13ad56974cfdb31ca2150d04e56252f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PhjzV-WmIE9-6YlqfOyokw.gif"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">这两种形式在起作用。图片作者。</figcaption></figure><p id="9fa6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">手风琴占位符</strong></p><p id="5579" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为我们添加了<code class="fe ne nf ng mv b">accordion</code>路线，所以我们需要创建它。</p><p id="3dd4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建<code class="fe ne nf ng mv b">app/routers/accordion.py</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="e420" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建<code class="fe ne nf ng mv b">templates/accordion.html</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><h1 id="0133" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何添加一个自举折叠菜单</h1><p id="ea85" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">更新<code class="fe ne nf ng mv b">templates/accordion.html</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="befa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里我们使用了<a class="ae kz" href="https://getbootstrap.com/docs/4.0/components/collapse/#accordion-example" rel="noopener ugc nofollow" target="_blank">引导崩溃</a>。</p><p id="3b38" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">更新<code class="fe ne nf ng mv b">app/routers/accordion.py</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="4186" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">类似于前面的例子，两个表单，我们从<code class="fe ne nf ng mv b">fastapi</code>导入<code class="fe ne nf ng mv b">Form</code>，从<code class="fe ne nf ng mv b">fastapi.responses</code>导入<code class="fe ne nf ng mv b">HTMLResponse</code>。</p><p id="e490" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们创建一个post端点并返回所选择的标签。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj gk"><img src="../Images/fa0d3720b1542429aad3afc5b2f0c9ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mkPjyhmwIANdnwisJwMX-A.gif"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">手风琴菜单的作用。图片作者。</figcaption></figure><h1 id="69f2" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">测试</h1><p id="011f" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">FastAPI使用<a class="ae kz" href="https://fastapi.tiangolo.com/tutorial/testing/" rel="noopener ugc nofollow" target="_blank"> Starlette测试客户端</a>。对于我们的例子，我们需要使用<code class="fe ne nf ng mv b">from app.main</code>,因为在<code class="fe ne nf ng mv b">app</code>目录中有<code class="fe ne nf ng mv b">main.py</code>。以下是该项目的简单测试代码。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="7ae7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第1–2行:导入<code class="fe ne nf ng mv b">TestClient</code>和<code class="fe ne nf ng mv b">app</code>。<br/>第4行:创建<code class="fe ne nf ng mv b">TestClient</code>对象。<br/>第9行:追加<code class="fe ne nf ng mv b">headers</code>。<br/>第10行:断言HTTP状态代码200。<br/>第11行:断言<code class="fe ne nf ng mv b">response.content</code>中的句子。<br/>第12–13行:断言我们的样式表的状态代码是否为200。</p><p id="b698" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在根目录中，在终端中运行以下命令来运行测试:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="2976" class="mz lx iu mv b gz na nb l nc nd">$ pytest -v</span></pre><p id="2f5a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">标志<code class="fe ne nf ng mv b">-v</code>表示增加输出的详细程度。</p><p id="dff3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果要在测试运行开始时移除所有缓存内容:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="cd4a" class="mz lx iu mv b gz na nb l nc nd">$ pytest --cache-clear</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oe"><img src="../Images/e6337f68907df05238c3be6391402c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AtcE7yBPgbCt6jIX3J0q1A.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">pytest -v输出。作者图片</figcaption></figure><h1 id="7cf8" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">结论</h1><p id="22a4" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我们在本文中讨论了模板、静态文件、路由器、降价、导入其他python文件、环境变量、表单。在创建这个静态网站时，我发现不仅<a class="ae kz" href="https://fastapi.tiangolo.com/tutorial/" rel="noopener ugc nofollow" target="_blank"> FastAPI的文档</a>有用，而且<a class="ae kz" href="https://jinja.palletsprojects.com/en/2.11.x/templates/" rel="noopener ugc nofollow" target="_blank"> Jinja的文档</a>也有用。</p><p id="aada" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了创建这个简单的web starter，我们只涉及了一些FastAPI特性。您可以探索和添加更多功能。我希望本文为您的FastAPI项目提供了一个良好的开端。</p><h1 id="bf56" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">更新</h1><p id="6afe" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">[更新:2022–1–5 Bootstrap 5]<br/>[更新:2021–11–07 FastAPI&amp;依赖版本]<br/>[更新:2021–08–15，Python，FastAPI和依赖版本]</p></div><div class="ab cl of og hy oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="in io ip iq ir"><p id="dd55" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">通过</strong> <a class="ae kz" href="https://blog.codewithshin.com/membership" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv">成为</strong> </a> <strong class="lc iv">的会员，可以完全访问媒体上的每一个故事。</strong></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj om"><img src="../Images/0be3ee559fee844cb75615290e4a8b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*DjTM9iFtVc2wlcWcOms7VQ.png"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">请点击此链接订阅。</figcaption></figure></div><div class="ab cl of og hy oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="in io ip iq ir"><h1 id="427d" class="lw lx iu bd ly lz on mb mc md oo mf mg ka op kb mi kd oq ke mk kg or kh mm mn bi translated">参考</h1><ul class=""><li id="cf42" class="os ot iu lc b ld mo lg mp lj ou ln ov lr ow lv ox oy oz pa bi translated"><a class="ae kz" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI </a></li><li id="5473" class="os ot iu lc b ld pb lg pc lj pd ln pe lr pf lv ox oy oz pa bi translated"><a class="ae kz" href="https://jinja.palletsprojects.com/en/2.11.x/templates/" rel="noopener ugc nofollow" target="_blank">金佳</a></li><li id="4234" class="os ot iu lc b ld pb lg pc lj pd ln pe lr pf lv ox oy oz pa bi translated"><a class="ae kz" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank">自举4 </a></li><li id="eb22" class="os ot iu lc b ld pb lg pc lj pd ln pe lr pf lv ox oy oz pa bi translated"><a class="ae kz" href="https://fastapi.tiangolo.com/tutorial/testing/" rel="noopener ugc nofollow" target="_blank"> FastAPI测试</a></li></ul></div></div>    
</body>
</html>