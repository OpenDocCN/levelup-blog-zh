<html>
<head>
<title>React, Web Workers, and IndexedDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Reactã€Web Workerså’ŒIndexedDB</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/react-web-workers-and-indexeddb-a973797e771b?source=collection_archive---------8-----------------------#2020-04-09">https://levelup.gitconnected.com/react-web-workers-and-indexeddb-a973797e771b?source=collection_archive---------8-----------------------#2020-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dcf5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å¦‚ä½•åœ¨å¸¦æœ‰Web Workersçš„Reactåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨IndexedDB</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ba5dc11a44e828e46fce237b1a381f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ih6g24vTLWb_Zl-yiNOuNA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@pawankawan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">å¸•ä¸‡Â·å¡ä¸‡</a>åœ¨<a class="ae ky" href="https://unsplash.com/s/photos/free?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</figcaption></figure><p id="5484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘åˆ†äº«<a class="ae ky" href="https://medium.com/@david.dalbusco/one-trick-a-day-d-34-469a0336a07e" rel="noopener">ä¸€å¤©ä¸€æ‹›</a>ç›´åˆ°åŸå®šçš„2020å¹´4æœˆ19æ—¥ç‘å£«æ–°å† è‚ºç‚éš”ç¦»æœŸç»“æŸã€‚ç¦»ç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘è¿˜æœ‰10å¤©ã€‚å¸Œæœ›æ›´å¥½çš„æ—¥å­å°±åœ¨å‰é¢ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="deb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨æœ¬ç³»åˆ—çš„å‰ä¸€ç¯‡åšæ–‡<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/react-and-web-workers-c9b60b4b6ae8">ä¸­ï¼Œæˆ‘åˆ†äº«äº†æˆ‘è®©</a><a class="ae ky" href="https://reactjs.org" rel="noopener ugc nofollow" target="_blank"> React </a>å’Œ<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers" rel="noopener ugc nofollow" target="_blank"> Web Workers </a>äº¤äº’çš„è§£å†³æ–¹æ¡ˆã€‚è¿™æ˜¯æˆ‘åœ¨å¼€å‘<a class="ae ky" href="https://tietracker.app.link/" rel="noopener ugc nofollow" target="_blank">é¢†å¸¦è¿½è¸ªå™¨</a>æ—¶å°è¯•çš„ä¸€ä¸ªå°æŠ€å·§ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•ã€å¼€æºã€å…è´¹çš„æ—¶é—´è¿½è¸ªåº”ç”¨ç¨‹åºâ±ã€‚</p><p id="7bd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘å¸Œæœ›è¿™ç§ç»“æ„å’Œè¿™ä¸ªåº”ç”¨ç¨‹åºçš„å¦ä¸€ä¸ªæœ‰è¶£çš„ç‰¹æ€§æ˜¯ä½¿ç”¨<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API" rel="noopener ugc nofollow" target="_blank"> IndexedDB </a>åœ¨çº¿ç¨‹ä¸­å¤„ç†æ•°æ®çš„æƒ³æ³•ã€‚</p><p id="b990" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æƒ³æ³•å¾ˆç®€å•:è®©ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºç«¯(JavaScriptå•çº¿ç¨‹)è¾“å…¥å’Œä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå› ä¸ºè¿™æ ·çš„æ“ä½œèŠ±è´¹çš„æ—¶é—´æ›´å°‘ï¼Œä½†æ˜¯ä¸ºäº†ä¸é˜»å¡ç”¨æˆ·ç•Œé¢å’Œäº¤äº’ï¼Œè¦å°†æ¯ä¸€ä¸ªè®¡ç®—æˆ–ç»Ÿè®¡äº¤ç»™Webå·¥ä½œè€…ã€‚</p><p id="97a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘åœ¨è¿™ç¯‡åç»­æ–‡ç« ä¸­ä¸ä½ åˆ†äº«è¿™ä¸ªé£Ÿè°±ğŸ˜ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b34b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">idb-keyval</h1><p id="6817" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">å½“æ¶‰åŠåˆ°ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œæˆ‘æœ‰ç‚¹æŒ‘å‰”ï¼Œå› ä¸ºæˆ‘æœ‰ç‚¹â€œæ†ç»‘ææƒ§ç—‡â€ï¼Œä½†æ˜¯å½“æ¶‰åŠåˆ°ä¸ç´¢å¼•æ•°æ®åº“äº¤äº’æ—¶ï¼Œæˆ‘æ¯«ä¸çŠ¹è±«ï¼Œæ¥è‡ªæ°å…‹Â·é˜¿å¥‡åšå°”å¾·çš„<a class="ae ky" href="https://github.com/jakearchibald/idb-keyval" rel="noopener ugc nofollow" target="_blank"> idb-keyval </a>æ˜¯æˆ‘çš„é¦–é€‰åº“ã€‚</p><p id="9588" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å°‘äº600å­—èŠ‚ï¼Œæ ‘æ‘‡å‹å¥½ï¼Œæ‰¿è¯ºä¸ºåŸºç¡€â€¦åœåœ¨é‚£é‡Œï¼Œæˆ‘éƒ½åœ¨ï¼</p><p id="1f42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å› æ­¤ï¼Œåœ¨è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å½“ç„¶è¦ä½¿ç”¨å®ƒğŸ˜‰ã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="38f4" class="ne md it na b gy nf ng l nh ni">npm i idb-keyval --save</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="32fd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ç”¨æˆ·ç•Œé¢</h1><p id="b0c2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">åœ¨ä¹‹å‰çš„å¸–å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªâ€œTomateå’ŒAppleè®¡æ•°å™¨â€ã€‚æˆ‘å»ºè®®æˆ‘ä»¬ç°åœ¨æŠŠè‡ªå·±çš„æ³¨æ„åŠ›é›†ä¸­åœ¨â€œç•ªèŒ„â€ä¸Šï¼Œå¹¶æŠŠè®¡æ•°å™¨çš„æ€»å’Œçš„è®¡ç®—å·¥ä½œäº¤ç»™ç½‘ç»œå·¥ä½œè€…ã€‚</p><p id="4882" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨ä¸IndexedDBè¿›è¡Œä»»ä½•äº¤äº’ä¹‹å‰ï¼Œæˆ‘ä»¬ä¿®æ”¹åçš„ç»„ä»¶ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5014" class="ne md it na b gy nf ng l nh ni">import {<br/>    IonContent,<br/>    IonPage,<br/>    IonLabel,<br/>    IonButton<strong class="na iu"><em class="nj"><br/></em></strong>} from '@ionic/react';<br/>import React, {useEffect, useState} from 'react';<br/>import {RouteComponentProps} from 'react-router';<br/><br/>import './Page.css';<br/><br/>const Page: React.FC&lt;RouteComponentProps&lt;{ name: string; }&gt;&gt; = ({match}) =&gt; {<br/><br/>    const [countTomato, setCountTomato] = useState&lt;number&gt;(0);<br/>    const [sumTomato, setSumApple] = useState&lt;number&gt;(0);<br/><br/>    const tomatoWorker: Worker = new Worker('./workers/tomato.js');<br/><br/>    useEffect(() =&gt; {<br/>        tomatoWorker.onmessage = ($event: MessageEvent) =&gt; {<br/>            if ($event &amp;&amp; $event.data) {<br/>                setSumApple($event.data);<br/>            }<br/>        };<br/>    }, [tomatoWorker]);<br/><br/>    function doSumTomato() {<br/>        tomatoWorker<br/>         .postMessage({msg: 'sumTomato'});<br/>    }<br/><br/>    return (<br/>        &lt;IonPage&gt;<br/>            &lt;IonContent className="ion-padding"&gt;<br/>                &lt;IonLabel&gt;<br/>                   Tomato: {countTomato} | Sum: {sumTomato}<br/>                &lt;/IonLabel&gt;<br/><br/>                &lt;div className="ion-padding-top"&gt;<br/>                    &lt;IonButton<br/>                        onClick={() =&gt; <br/>                          setCountTomato(countTomato + 1)}<br/>                        color="primary"&gt;Tomato&lt;/IonButton&gt;<br/><br/>                    &lt;IonButton<br/>                        onClick={() =&gt; doSumTomato()}<br/>                        color="secondary"&gt;Sum now!&lt;/IonButton&gt;<br/>                &lt;/div&gt;<br/>            &lt;/IonContent&gt;<br/>        &lt;/IonPage&gt;<br/>    );<br/>};<br/><br/>export default Page;</span></pre><p id="3359" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å½“ç„¶ï¼Œç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰å®ç°suméƒ¨åˆ†ï¼Œå³Web Workerï¼Œå®ƒæ²¡æœ‰åšå¤ªå¤šå·¥ä½œã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/0feedb68b9dd2d4103e56e1dd3bf79ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*0Qz6Y3scEzimJ--S7TTNgA.gif"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="89e0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ç”¨æˆ·äº¤äº’</h1><p id="cb97" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨IndexDBä¸­å†™ä¸€ä¸ªå…³äºç”¨æˆ·äº¤äº’çš„æ•°æ®ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸ºäº†æ¼”ç¤ºå’Œå¥½ç©ï¼Œæˆ‘å»ºè®®æˆ‘ä»¬åœ¨æ¯æ¬¡ç•ªèŒ„è®¡æ•°å™¨é€’å¢æ—¶åœ¨æ•°æ®åº“ä¸­ç”Ÿæˆä¸€ä¸ªæ–°æ¡ç›®ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ³¨å†Œä¸€ä¸ªæ–°çš„<code class="fe nl nm nn na b">useEffect</code>åˆ°<code class="fe nl nm nn na b">set</code>æ¡ç›®ã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="3e31" class="ne md it na b gy nf ng l nh ni">import {set} from 'idb-keyval';</span><span id="0edc" class="ne md it na b gy no ng l nh ni">useEffect(() =&gt; {<br/>    incTomato();<br/>}, [countTomato]);<br/><br/>async function incTomato() {<br/>    if (countTomato &gt; 0) {<br/>        await set(`tomato${countTomato}`, countTomato);<br/>    }<br/>}</span></pre><p id="01c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å°±è¿™æ ·äº†ã€‚æ¯å½“è®¡æ•°å™¨é€’å¢æ—¶ï¼Œæ•ˆæœè¢«è§¦å‘ï¼Œå¹¶ä¸”åœ¨æ‰©å±•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨idb-keyvalåœ¨æ•°æ®åº“ä¸­æ·»åŠ ä¸€ä¸ªå€¼ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e42332529c348659fec8ea1cf5b83d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Upl2MW8HhjDarFAcOoOdUQ.gif"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6bc8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ç½‘ç»œå·¥ä½œè€…</h1><p id="5e75" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å·¥äººæ–‡ä»¶<code class="fe nl nm nn na b">./public/workers/tomato.js</code>ï¼Œå®ƒåœ¨ä»»ä½•IndexDBäº¤äº’ä¹‹å‰çœ‹èµ·æ¥å¦‚ä¸‹ã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="51b9" class="ne md it na b gy nf ng l nh ni">self.onmessage = async ($event) =&gt; {<br/>    if ($event &amp;&amp; $event.data &amp;&amp; $event.data.msg === 'sumTomato') {<br/>        const sum = await sumTomato();<br/>        self.postMessage(sum);<br/>    }<br/>};<br/><br/>async function sumTomato() {<br/>    // <em class="nj">TODO sum tomato<br/>    </em>return 0;<br/>}</span></pre><p id="0345" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬ç°åœ¨å¿…é¡»è®¿é—®IndexedDBä¸­çš„æ•°æ®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œè¦ä¹ˆç¼–ç ä¸€åˆ‡ï¼Œè¦ä¹ˆä½¿ç”¨ä¸€ä¸ªåº“ã€‚ä½œä¸ºidb-keyvalçš„å¿ å®ç²‰ä¸ï¼Œæˆ‘ä¹Ÿæƒ³åœ¨è¿™é‡Œä½¿ç”¨å®ƒã€‚</p><p id="9e3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬çš„Web Workersæ˜¯ä½œä¸ºèµ„äº§äº¤ä»˜çš„ï¼Œå› æ­¤æ— æ³•è®¿é—®æˆ‘ä»¬çš„åŒ…åŠå…¶ä¾èµ–é¡¹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»åœ¨<code class="fe nl nm nn na b">importScripts</code>çš„å¸®åŠ©ä¸‹åœ¨æˆ‘ä»¬çš„workersä¸­æ‰§è¡Œè®¾ç½®å’Œå¯¼å…¥è„šæœ¬ã€‚</p><p id="2e33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘çŒœä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•æ˜¯ç”¨Rollupæˆ–Webpackæ¥å¤„ç†è¿™ç§ä¾èµ–æ€§ï¼Œå¯èƒ½æ˜¯é€šè¿‡æ’ä»¶ï¼Œä½†æˆ‘ä¸å¾—ä¸è¯´æˆ‘æ²¡æœ‰éµå¾ªé‚£æ¡è·¯ã€‚</p><p id="d8c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜æœ‰ä¸¤ä¸ªé€‰æ‹©ã€‚é“¾æ¥ä¸€ä¸ªå¤–éƒ¨è„šæœ¬æˆ–ä¸‹è½½å®ƒï¼Œæ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­å¹¶åœ¨æœ¬åœ°å¼•ç”¨å®ƒã€‚</p><p id="f2bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœæ‚¨å¸Œæœ›éµå¾ªâ€œæœ¬åœ°æ–¹å¼â€ï¼Œæ‚¨çš„å¯¼å…¥å°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5559" class="ne md it na b gy nf ng l nh ni">importScripts('./idb-keyval-iife.min.js');</span></pre><p id="3154" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ–è€…ï¼Œæ­£å¦‚æˆ‘ä»¬å°†è¦åšçš„ï¼Œä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨<a class="ae ky" href="https://unpkg.com/" rel="noopener ugc nofollow" target="_blank"> Unpkg </a>å¯¼å…¥å®ƒã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="01b2" class="ne md it na b gy nf ng l nh ni">importScripts('https://unpkg.com/idb-keyval@latest/dist/idb-keyval-iife.min.js');</span></pre><p id="7770" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‰€æœ‰è®¾ç½®ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥äº«å—idb-keyvalï¼Œå¹¶ä»æˆ‘ä»¬çš„Web Workerè®¿é—®IndexedDBä¸­çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ—å‡ºæ•°æ®åº“ä¸­çš„<code class="fe nl nm nn na b">keys()</code>ï¼Œè¿­ä»£è¿™äº›åˆ°<code class="fe nl nm nn na b">get(key)</code>å®ƒä»¬çš„å€¼ï¼Œå¹¶è®¡ç®—ä¸€ä¸ªä¼ªå’Œã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="777f" class="ne md it na b gy nf ng l nh ni">importScripts('https://unpkg.com/idb-keyval@latest/dist/idb-keyval-iife.min.js');<br/><br/>self.onmessage = async ($event) =&gt; {<br/>    if ($event &amp;&amp; $event.data &amp;&amp; $event.data.msg === 'sumTomato') {<br/>        const sum = await sumTomato();<br/>        self.postMessage(sum);<br/>    }<br/>};<br/><br/>async function sumTomato() {<br/>    const keys = await idbKeyval.keys();<br/><br/>    let sum = 0;<br/>    for (const key of keys) {<br/>        const value = await idbKeyval.get(key);<br/>        sum += value;<br/>    }<br/><br/>    return sum;<br/>}</span></pre><p id="2f7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç§ğŸ‰ã€‚æˆ‘ä»¬åœ¨æ‰€æœ‰çº¿ç¨‹ä¸­éƒ½ä½¿ç”¨äº†IndexedDBğŸ˜ƒã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/cc689092cf9e323cf48cd148a0dacc84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*o4uSCTJUb9X253cdPmJJMA.gif"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4d3c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">æ‘˜è¦</h1><p id="84b4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">ç½‘ç»œå¤ªæœ‰è¶£äº†ã€‚</p><p id="be4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å‘†åœ¨å®¶é‡Œï¼Œæ³¨æ„å®‰å…¨ã€‚</p><p id="b23e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¤§å«</p></div></div>    
</body>
</html>