<html>
<head>
<title>Schedule your Node.js tasks with agenda.js 📔</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用agenda.js安排Node.js任务📔</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/schedule-your-node-js-task-with-agenda-js-3dc40aab3316?source=collection_archive---------1-----------------------#2020-12-14">https://levelup.gitconnected.com/schedule-your-node-js-task-with-agenda-js-3dc40aab3316?source=collection_archive---------1-----------------------#2020-12-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7fe1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">需要创建周期性任务？稍后执行任务？你可能需要议程。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/b894490de7b8cc028f9f3fa4cac512ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yZ4BDLhnctESXufCPcEmEA.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">扬森斯大学</figcaption></figure><h1 id="2959" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">介绍</h1><p id="be3e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">构建Node.js应用程序时，您可能需要执行重复性任务或稍后运行它们。⏰</p><p id="1218" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可能知道Linux系统上的CRON作业。CRON是一个基于时间的作业调度程序。它让我们每分钟、每一天、每一个月等等都能实现任务。</p><p id="0ed5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过我们的Node.js应用程序，我们希望运行类似CRON的东西。但是怎么做呢？希望存在多种在Node.js上调度任务的解决方案:</p><ul class=""><li id="2c3e" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">节点时间表</li><li id="2286" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">节点克隆</li><li id="fedf" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">公牛</li><li id="d702" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">议程</li></ul><p id="512b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，我们将看看议程。在<a class="ae lb" href="https://www.npmjs.com/package/agenda" rel="noopener ugc nofollow" target="_blank"> NPM </a>上，它被描述为“Node.js的轻量级作业调度库”。</p><p id="a4de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它提供了并发作业、延迟作业、可重复作业等功能。以MongoDB为动力。</p><p id="a571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将使用Node.js和Agenda创建一个示例应用程序。🗓</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="d8ce" class="lc ld iq bd le lf na lh li lj nb ll lm ln nc lp lq lr nd lt lu lv ne lx ly lz bi translated">设置</h1><p id="32cb" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在使用Agenda之前，我们需要一个Node.js应用程序和一个MongoDB数据库来存储我们的作业。</p><p id="6ce5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">让我们初始化应用:</strong></p><pre class="km kn ko kp gt nf ng nh ni aw nj bi"><span id="10dc" class="nk ld iq ng b gy nl nm l nn no">npm init &amp;&amp; touch app.js</span><span id="f6ed" class="nk ld iq ng b gy np nm l nn no">npm install agenda</span></pre><p id="dc75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">编写一点代码，并将其连接到MongoDB: </strong></p><p id="f3e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(如果没有Mongo数据库，可以创建一个Docker容器，如下所示)</p><pre class="km kn ko kp gt nf ng nh ni aw nj bi"><span id="3414" class="nk ld iq ng b gy nl nm l nn no">docker run -d -p 27017:27017 --name mongodb mongo</span></pre><ul class=""><li id="24e9" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">app.js:</li></ul><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nq nr l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">app.js</figcaption></figure><p id="1412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您只需要创建一个议程实例，传递db URL和集合名称。</p><p id="be09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将在您的数据库中创建一个新集合。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="64af" class="lc ld iq bd le lf na lh li lj nb ll lm ln nc lp lq lr nd lt lu lv ne lx ly lz bi translated">创造一份工作</h1><p id="db36" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">现在我们有了一个议程实例，我们可以创建我们的工作了。</p><p id="f4a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此示例中，我们将创建一个虚拟作业来记录“Hello ${name}”。所以在app.js中，我们可以添加:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nq nr l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">app . js-创建作业</figcaption></figure><p id="2308" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建作业时，可以在attrs变量中获取数据。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="a341" class="lc ld iq bd le lf na lh li lj nb ll lm ln nc lp lq lr nd lt lu lv ne lx ly lz bi translated">安排工作</h1><p id="af7e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">一旦我们有了工作，我们就可以运行它们。在这一部分，我们将计划作业在10分钟内运行，如下所示:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nq nr l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">app . js-计划作业</figcaption></figure><p id="d126" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将在我们的议程集合中创建一个文档:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/a51eed308ef4ea4b63c8a9d2cb1d9679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O_WTsKOLgdrfa8g9uxOS_A.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">MongoDB中的计划作业</figcaption></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="5303" class="lc ld iq bd le lf na lh li lj nb ll lm ln nc lp lq lr nd lt lu lv ne lx ly lz bi translated">重复运行作业</h1><p id="67c4" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">议程允许我们运行重复性作业。例如每年。我们将创建一个虚拟作业来祝新年快乐:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nq nr l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">app . js-重复作业</figcaption></figure><p id="e127" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个例子中，您可以观察到我正在使用CRON语法。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="ce59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">议程帮助您计划作业，稍后或重复运行它们。您可以在此找到更多信息和功能<a class="ae lb" href="https://www.npmjs.com/package/agenda" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="954c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">GitLab回购:<a class="ae lb" href="https://dmg.link/blog-agenda-repo" rel="noopener ugc nofollow" target="_blank">dmg.link/blog-agenda-repo</a></p><p id="bffb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">你可以在这里</strong>  <strong class="jp ir">找到我的其他文章并关注我</strong> <a class="ae lb" href="http://nicolas-dmg.medium.com" rel="noopener"> <strong class="jp ir">。感谢阅读，我希望你今天学到了一些新东西🚀</strong></a></p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><div class="km kn ko kp gt nt"><a rel="noopener  ugc nofollow" target="_blank" href="/automate-your-react-native-app-with-fastlane-ea516b4a893"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">使用浪子自动化您的React原生应用程序</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">简化截图、测试版部署、应用商店部署和React原生应用的登录🚀</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kv nt"/></div></div></a></div><div class="oi oj gp gr ok nt"><a rel="noopener  ugc nofollow" target="_blank" href="/build-your-standalone-expo-app-locally-with-turtle-cli-87de3a487704"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">使用Turtle CLI在本地构建您的独立Expo应用程序🐢</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">构建iOS。ipa和Android。使用Turtle CLI在本地使用apk expo应用程序</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oc l"><div class="ol l oe of og oc oh kv nt"/></div></div></a></div></div></div>    
</body>
</html>