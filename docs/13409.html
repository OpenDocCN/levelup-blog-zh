<html>
<head>
<title>Kubernetes Deployment with NodeJS Made Easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NodeJS简化Kubernetes部署</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/kubernetes-deployment-with-nodejs-made-easy-eaeec32b62e3?source=collection_archive---------8-----------------------#2022-09-02">https://levelup.gitconnected.com/kubernetes-deployment-with-nodejs-made-easy-eaeec32b62e3?source=collection_archive---------8-----------------------#2022-09-02</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="c778" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">让我们在Kubernetes集群上部署一个NodeJS应用程序，并进行现场测试！</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/ecaaf46155cc35678914a3cc5406e39a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2pYfe7UVTiG5u3yHtkWPaA.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">由亚历山大·德比夫在<a class="ae kz" href="https://unsplash.com/s/photos/technology?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="7a85" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在之前的一篇文章中，我们学习了Kubernetes的基本概念。</p><p id="8ff2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">今天我们将学习如何在Kubernetes集群上部署NodeJS应用程序。步骤如下。</p><ul class=""><li id="5704" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">为NodeJS应用程序创建Docker映像</li><li id="cab5" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">将图像发布到DockerHub</li><li id="5050" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">创建一个Linode Kubernetes集群</li><li id="8951" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">在我们的本地机器上安装Kubectl</li><li id="e032" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">将我们的应用部署到Kubernetes集群中</li></ul><h2 id="a230" class="mk ml iu bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">在我们开始之前…</h2><p id="3c5a" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">我用ExpressJS和Typescript 创建了一个<a class="ae kz" href="https://github.com/Mohammad-Faisal/professional-express-sequelize-docker-boilerplate" rel="noopener ugc nofollow" target="_blank">专业样板。本文是这个系列的一部分。你可以在下面找到所有的文章。</a></p><pre class="kk kl km kn gu ni nj nk bn nl nm bi"><span id="31b2" class="nn ml iu nj b be no np l nq nr"><strong class="nj iv">* </strong><a class="ae kz" href="https://javascript.plainenglish.io/create-an-express-boilerplate-with-typescript-810eb6c29196" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">Creating a ExpressJS + Typescript Boilerplate</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" href="https://javascript.plainenglish.io/how-to-set-up-linter-formatter-for-node-js-d6b34c0c8be5" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">How to setup Linter and Formatter for NodeJS</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" href="https://blog.devgenius.io/how-to-handle-multiple-environments-in-nodejs-7391d2db2abe" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">How to handle multiple environments in NodeJS</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" href="https://javascript.plainenglish.io/error-handling-in-node-js-like-a-pro-ed210baa0600" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">Error Handling in NodeJS</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" href="https://medium.com/p/c69f2494cf18" rel="noopener"><strong class="nj iv">Request validation in NodeJS</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/use-docker-with-nodejs-projects-like-a-pro-a9e7504e1308"><strong class="nj iv">Using Docker Professionally with NodeJS</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" href="https://javascript.plainenglish.io/node-js-database-with-docker-for-local-development-285212c5162f" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">Using Docker for Local Development in NodeJS</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" href="https://javascript.plainenglish.io/node-js-logging-for-professionals-6be07c003e7f" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">Logging in NodeJS</strong></a><strong class="nj iv"><br/><br/>* </strong><a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-deployment-with-nodejs-made-easy-eaeec32b62e3"><strong class="nj iv">Kubernetes with NodeJS</strong></a></span></pre><p id="1d9f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p><h1 id="2f72" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">创建Docker图像</h1><p id="48c4" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">在上一篇文章中，我们学习了如何对基本NodeJS应用程序进行dockerize。你可以在这里找到那篇文章:</p><p id="1c7a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该文章的存储库可以在<a class="ae kz" href="https://github.com/Mohammad-Faisal/express-typescript-docker" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p><p id="5b51" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以还是先克隆吧！</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="cd37" class="mk ml iu nj b gz og oh l nq nr">git clone https://github.com/Mohammad-Faisal/express-typescript-docker.git</span><span id="cbe6" class="mk ml iu nj b gz oi oh l nq nr">cd express-typescript-docker</span></pre><p id="1b0e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以我们现在有了一个已经Dockerized的NodeJS应用程序！</p><h1 id="e652" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">在Dockerhub上发布图像</h1><p id="ff6d" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">Dockerhub是一个可以发布存储库的地方。这是一种用于Docker图像的Github，可以免费使用！所以放心在这里开户<a class="ae kz" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="adc0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后，在我们可以发布图像之前，我们必须构建它。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="d550" class="mk ml iu nj b gz og oh l nq nr">docker image build -t 56faisal/learn-kubernetes:1.0 .</span></pre><p id="e568" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意这里，</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="fac0" class="mk ml iu nj b gz og oh l nq nr">56faisal -&gt; is the Dockerhub Username<br/>learn-kubernets -&gt; is the image name and<br/>1.0 -&gt; is the tag name</span></pre><p id="1b9e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果运行Mac，你默认的Docker系统会使用arm64架构。但是在Linode上，您的虚拟机很可能是使用amd64架构构建的。当您部署映像时，这种版本不匹配会导致问题。因此，如果您在Mac上，使用以下命令构建您的映像。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="83d5" class="mk ml iu nj b gz og oh l nq nr">docker image build  --platform=linux/amd64 -t 56faisal/learn-kubernetes:1.0 .</span></pre><p id="1fd0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后在本地看到列表上的图像。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="be18" class="mk ml iu nj b gz og oh l nq nr">docker image ls<br/></span><span id="5041" class="mk ml iu nj b gz oi oh l nq nr">REPOSITORY                                TAG                   IMAGE ID       CREATED        SIZE<br/>56faisal/learn-kubernetes                 1.0                   13a974972901   2 hours ago    263MB</span></pre><p id="5ee6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后登录Dockerhub。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="ce9f" class="mk ml iu nj b gz og oh l nq nr">docker login --username docker_hub_id # for me it's 56faisal</span></pre><p id="30fb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">它会询问你的密码。把那个给我，你就可以走了。</p><p id="928b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后把图片推送到Dockerhub。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="9440" class="mk ml iu nj b gz og oh l nq nr">docker image push 56faisal/learn-kubernetes:1.0</span></pre><p id="13f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以去Dockerhub验证你的图像在那里。对我来说，URL看起来像这样:</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="6a6e" class="mk ml iu nj b gz og oh l nq nr"><a class="ae kz" href="https://hub.docker.com/repository/docker/56faisal/learn-kubernetes" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/repository/docker/56faisal/learn-kubernetes</a></span></pre><h1 id="fabc" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">开始部署吧！</h1><p id="ea09" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">但在此之前，我们需要安装<code class="fe oj ok ol nj b">kubernetes-cli</code></p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="fff3" class="mk ml iu nj b gz og oh l nq nr">brew install kubernetes-cli</span></pre><p id="d788" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以在这里获得其他操作系统<a class="ae kz" href="https://kubernetes.io/docs/tasks/tools/" rel="noopener ugc nofollow" target="_blank">的安装说明</a></p><h1 id="1648" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">在Linode上创建Kubernetes集群</h1><p id="a289" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">Kubernetes有很多服务，但是Linode提供了最简单的管理方法。因此，我们将在Linode上创建一个带有两个worker节点的Kubernetes集群。</p><p id="8e30" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我不会谈论这方面的细节。你可以<a class="ae kz" href="https://www.linode.com/docs/guides/deploy-and-manage-a-cluster-with-linode-kubernetes-engine-a-tutorial/" rel="noopener ugc nofollow" target="_blank">跟随这个链接</a>去做。</p><h1 id="a868" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">获取Kubernetes集群配置。</h1><p id="9895" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">在Linode Kubernetes集群页面上，您会看到一个下载Kubernetes配置文件的按钮。</p><p id="2863" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下载并把它放到项目的根目录下。或者任何地方。这将允许我们稍后与Kubernetes集群进行交互。</p><p id="2420" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">打开一个终端并将kubeconfig的路径保存到<code class="fe oj ok ol nj b">$KUBECONFIG</code>环境变量中。</p><p id="3483" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以通过运行<code class="fe oj ok ol nj b">pwd</code>获得当前目录路径，并使用它来获得您的配置文件的路径。</p><p id="682e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在就给我们设定一下语境吧！</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="b029" class="mk ml iu nj b gz og oh l nq nr">export KUBECONFIG= /PATH_TO_FOLDER/learn-kubernetes-kubeconfig.yml</span></pre><p id="4ff4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后运行下面的命令来查看节点！节点是运行在云上的物理机器或虚拟机。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="1b43" class="mk ml iu nj b gz og oh l nq nr">kubectl get nodes</span></pre><p id="13e8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们在Linode集群上创建了两台服务器。所以我们会看到两个节点。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="9f95" class="mk ml iu nj b gz og oh l nq nr">NAME                          STATUS   ROLES    AGE   VERSION<br/>lke55618-87276-6237a2503845   Ready    &lt;none&gt;   33m   v1.22.6<br/>lke55618-87276-6237a2510769   Ready    &lt;none&gt;   33m   v1.22.6</span></pre><p id="c4d7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">节点已经准备好运行我们的应用程序。</p><h1 id="9ecc" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">创建部署</h1><p id="03d0" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">所以现在我们可以和我们的Kubernetes集群互动。但是现在我们需要实际部署一些东西来理解它的力量。Kubernetes有一个豆荚的概念。pod是在您的基础设施上运行的独立容器。</p><p id="f44a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以创建任意数量的pod，并且可以通过配置部署来实现。这意味着您的两台机器上可以有20个pod。一般来说，我们在一个舱里有一个集装箱。</p><p id="1203" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们创建一个名为<code class="fe oj ok ol nj b">deployment.yml</code>的部署配置，并粘贴以下配置。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="om on l"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">部署. yml</figcaption></figure><p id="53d8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以下是一些需要注意的重要事项:</p><p id="b38a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe oj ok ol nj b">selector</code>-&gt;-<code class="fe oj ok ol nj b">matchLabels</code>-&gt;-<code class="fe oj ok ol nj b">app</code>-&gt;-<code class="fe oj ok ol nj b">express-docker-kubernetes</code></p><p id="bf13" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个应用程序帮助我们命名我们的豆荚。稍后，它将帮助我们修改部署，并将它们与服务相关联。</p><h1 id="52b9" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">部署应用程序</h1><p id="84ce" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">然后使用以下命令进行部署。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="08e9" class="mk ml iu nj b gz og oh l nq nr">kubectl create -f deployment.yml</span></pre><p id="57f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们使用<code class="fe oj ok ol nj b">-f</code>配置传递<code class="fe oj ok ol nj b">deployment.yml</code>文件。这允许我们为不同的文件夹创建多个部署文件。</p><p id="3dd6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以通过运行以下命令来查看部署:</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="49c2" class="mk ml iu nj b gz og oh l nq nr">kubectl get deployments</span></pre><p id="556d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您想了解部署的详细信息:</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="c438" class="mk ml iu nj b gz og oh l nq nr">kubectl explain deployment</span></pre><p id="5a8c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这将给出这样的输出</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="1808" class="mk ml iu nj b gz og oh l nq nr">NAME                          READY   UP-TO-DATE   AVAILABLE   AGE<br/>learn-kubernetes-deployment   0/2     2            0           7s</span></pre><p id="e907" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果要删除部署，可以运行以下命令:</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="fbaf" class="mk ml iu nj b gz og oh l nq nr">kubectl delete deploy learn-kubernetes-deployment</span></pre><p id="32c2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里最后一部分是部署的名称。</p><h1 id="9980" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">看到豆荚了吗</h1><p id="88e9" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">您的部署已经创建了两个pod，因为我们为部署配置提供了选项replicas:2。</p><p id="9cc2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们看看那些豆荚！</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="3a94" class="mk ml iu nj b gz og oh l nq nr">kubectl get pods</span></pre><p id="a648" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">它会给出这样的输出。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="ea02" class="mk ml iu nj b gz og oh l nq nr">NAME                                          READY   STATUS    RESTARTS   AGE<br/>learn-kubernetes-deployment-6fdf4bf45-pglg8   1/1     Running   0          49m<br/>learn-kubernetes-deployment-6fdf4bf45-s9dsd   1/1     Running   0          49m</span></pre><p id="c972" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以我们两个都在运行！如果您需要扩展，可以将数量从2增加到您想要的数量，然后重新部署。就这么简单！</p><p id="c831" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">有时你需要看看你的舱里发生了什么。您可以使用以下命令从窗格中获得更多详细信息。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="3c02" class="mk ml iu nj b gz og oh l nq nr">kubectl describe pods</span></pre><p id="2b59" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">输出将包含您需要的所有信息，包括pod的IP地址。但是不幸的是，您还不能访问您的应用程序，因为您的应用程序没有公开！</p><p id="e3e3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们现在就做吧！</p><h1 id="f09e" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">向公众展示</h1><p id="4750" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">让我们使用下面的命令公开部署。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="12c5" class="mk ml iu nj b gz og oh l nq nr">kubectl expose deployment learn-kubernetes-deployment --type="LoadBalancer"</span></pre><p id="302e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">或者我们也可以为部署创建一个服务</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="om on l"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">service.yaml</figcaption></figure><p id="3638" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">那就跑</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="b1b2" class="mk ml iu nj b gz og oh l nq nr">kubectl apply -f service.yml</span></pre><p id="e18e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这将在Linode服务器上为我们的应用程序创建一个负载平衡器，我们将获得一个公共端点来调用我们的服务。</p><p id="a701" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">成功部署服务后，通过运行以下命令获取负载平衡器的详细信息:</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="fcd6" class="mk ml iu nj b gz og oh l nq nr">kubectl get services</span></pre><p id="9425" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您将看到以下输出:</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="387b" class="mk ml iu nj b gz og oh l nq nr">NAME                       TYPE           CLUSTER-IP       EXTERNAL-IP      PORT(S)          AGE<br/>kubernetes                 ClusterIP      10.128.0.1       &lt;none&gt;           443/TCP          4h58m<br/>learn-kubernetes-service   LoadBalancer   10.128.247.181   172.105.44.102   3000:31752/TCP   74s</span></pre><p id="cb4f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意<code class="fe oj ok ol nj b">EXTERNAL-IP</code>这一列给出了您的应用程序的公共IP地址。</p><p id="4415" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们打开你的浏览器，点击下面的网址</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="b13c" class="mk ml iu nj b gz og oh l nq nr"><a class="ae kz" href="http://172.105.44.102:3000/" rel="noopener ugc nofollow" target="_blank">http://172.105.44.102:3000/</a></span></pre><p id="daee" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您将看到以下输出。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="f6a2" class="mk ml iu nj b gz og oh l nq nr">{ "message": "Hello World!" }</span></pre><p id="26b6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们的应用程序现已上线！我们可以用它做任何我们想做的事！</p><p id="5223" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">祝贺您使用Kubernetes部署了第一个NodeJS应用程序。</p><pre class="kk kl km kn gu ni nj od oe aw of bi"><span id="7067" class="mk ml iu nj b gz og oh l nq nr"><strong class="nj iv">Want to Connect?</strong></span><span id="e216" class="mk ml iu nj b gz oi oh l nq nr">You can reach out to me via <a class="ae kz" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">LinkedIN</strong></a> or my <a class="ae kz" href="https://www.mohammadfaisal.dev/blog" rel="noopener ugc nofollow" target="_blank"><strong class="nj iv">Personal Website</strong></a></span></pre><h1 id="5641" class="ns ml iu bd mm nt nu nv mp nw nx ny ms ka nz kb mv kd oa ke my kg ob kh nb oc bi translated">Github回购:</h1><div class="oo op gq gs oq or"><a href="https://github.com/Mohammad-Faisal/nodejs-docker-kubernetes" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">GitHub-Mohammad-fais al/nodejs-docker-kubernetes:用于NodeJS应用程序的Kubernetes部署</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">Kubernetes是微服务的编排工具。它有助于根据需求扩展服务…</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">github.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf kt or"/></div></div></a></div></div></div>    
</body>
</html>