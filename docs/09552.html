<html>
<head>
<title>Impulse Response — data augmentation for audio deep learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">脉冲响应—用于音频深度学习的数据增强</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/impulse-response-data-augmentation-for-audio-deep-learning-728f9c4e04d0?source=collection_archive---------3-----------------------#2021-08-21">https://levelup.gitconnected.com/impulse-response-data-augmentation-for-audio-deep-learning-728f9c4e04d0?source=collection_archive---------3-----------------------#2021-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5879" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">本文定义了脉冲响应，如何估计房间/麦克风IR及其在深度学习数据增强中的使用。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2c6e5ae33fe8da5f9074ed0cab9b85db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbtRv3omOHw4r-7MUjC92g.png"/></div></div></figure><p id="473e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">近年来，音频的深度学习已经取得了很大进展，模型在许多下游任务中击败了传统的信号处理技术。然而，许多这样的解决方案是在“同质的”数据集上训练的——在这些数据集上，记录条件(噪声、口音、语言等)几乎没有可变性。).当在真实世界的“音频事件”中使用时，许多这样的模型不能很好地执行(尤其是音频转换/合成任务),真实世界的“音频事件”可能包含短脉冲串、环境噪声、背景扬声器、劣质麦克风等。虽然有许多技术可以解决这些问题，但在这里，我们关注的是利用脉冲响应进行数据增强，这有时会非常强大，因为它模拟了不同的记录环境。</p><h1 id="a355" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">声学和脉冲响应(IR)</h1><blockquote class="mf mg mh"><p id="efc5" class="kr ks mi kt b ku kv jr kw kx ky ju kz mj lb lc ld mk lf lg lh ml lj lk ll lm ij bi translated">动态系统的脉冲响应描述了它在受到一个称为脉冲的短暂输入信号时的反应。因此，如果你记录一个脉冲信号，你不仅会听到脉冲，还会听到它的反射，以及它们的反射。</p></blockquote><p id="a15d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">系统的反应会受到其周围环境的影响，例如物体或系统的几何形状。脉冲信号包含所有频率，因此系统的脉冲响应决定了所有频率的响应。然而在实践中，很难产生完美的脉冲响应。取而代之的是采用一个短脉冲作为近似值(假设它与理想脉冲相当，那么IR将接近真实IR)。</p><p id="148a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">IR的一个重要应用是确定房间(或任何位置)的声学特性。由于房间的几何形状或扬声器或麦克风的位置，可能会有很多混响。通过捕捉/计算房间的IR，混响可以应用于任何音频源。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/f23b17140b8a8d68ee7a047638c18ebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4viI9no1aEUMsWBCN0zYEQ.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">音频的Mel声谱图，LJ 001–0002 . wav，来自LJSpeech数据集。上面的声谱图显示了原始音频，而下面的声谱图显示了用房间脉冲响应增强的相同音频，来自EchoThief数据集的academic quadrangle . wav(x-xis表示时间)。由于混响的原因，增强的声谱图更长。</figcaption></figure><h2 id="f725" class="mr lo iq bd lp ms mt dn lt mu mv dp lx la mw mx lz le my mz mb li na nb md nc bi translated">为什么脉冲响应在深度学习中很重要？</h2><p id="6e4b" class="pw-post-body-paragraph kr ks iq kt b ku nd jr kw kx ne ju kz la nf lc ld le ng lg lh li nh lk ll lm ij bi translated">用同质音频数据集训练的深度学习模型可能会成为域外数据点的牺牲品，有时会导致严重的性能下降。房间几何形状和麦克风的传递函数等因素可能会在音频数据点中引入可变性(模型尚未发现)。缓解这一问题的一种方法是开发稳健的模型——例如，通过使用<em class="mi">消除混响</em>和<em class="mi">去噪</em>的方法。这里使用的一个强大工具是<strong class="kt ir">数据增强</strong>。使用脉冲响应(卷积混响)，我们可以模拟音频文件听起来好像是在各种真实/不真实的房间里录制的。</p><p id="36ee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在下图中，从LJSpeech数据集中随机抽取了100个音频文件。样本是在相对安静的环境中记录的。对于每个数据点，生成两个扩充:a)来自EchoThief数据集的学术四边形IR和b)使用下一节描述的方法生成的我的房间的IR。原始音频和增强音频中的每一个都作为输入提供给fairseq的<a class="ae ni" href="https://github.com/pytorch/fairseq/blob/master/examples/wav2vec/README.md" rel="noopener ugc nofollow" target="_blank"> wav2vec2 </a>预训练模型。从wav2vec2嵌入中生成tSNE图。我们可以看到原始音频和ir增强音频之间的清晰聚类。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/dc882c5dc5ad885ef8e2820a4ededd45.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*b2UJnFBbsh-WDelvbusL6w.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">原始音频和增强音频的tSNE图。颜色代表使用的脉冲响应。</figcaption></figure><h1 id="52cd" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">计算脉冲响应</h1><blockquote class="mf mg mh"><p id="8581" class="kr ks mi kt b ku kv jr kw kx ky ju kz mj lb lc ld mk lf lg lh ml lj lk ll lm ij bi translated">这部分内容(和代码)很大程度上受以下项目的启发:<a class="ae ni" href="http://tulrich.com/recording/ir_capture/#menu" rel="noopener ugc nofollow" target="_blank"> DIY房间脉冲响应捕捉</a>【1】。</p></blockquote><p id="4396" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">几个房间脉冲(真实的和模拟的)可以在以下资源库中找到:<a class="ae ni" href="https://github.com/microsoft/DNS-Challenge/tree/master/datasets/impulse_responses" rel="noopener ugc nofollow" target="_blank">微软DNS挑战赛</a>，<a class="ae ni" href="https://mcdermottlab.mit.edu/Reverb/IR_Survey.html" rel="noopener ugc nofollow" target="_blank">麻省理工麦克德莫特</a>，<a class="ae ni" href="http://www.echothief.com/" rel="noopener ugc nofollow" target="_blank"> EchoThief </a>。然而，在本节中，我们将研究如何计算房间的脉冲响应。实际上，所计算的脉冲响应将是一个复杂的动态系统，包括(房间、扬声器和麦克风)。通过<em class="mi">微调</em>它们，这些IRs可以用来使模型更加健壮:顶部的樱桃！</p><p id="9a39" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">虽然通过直接记录脉冲信号来捕捉IR的响应是直接的，但它可能会有噪声(环境噪声可能难以消除)并且单调乏味(由于脉冲信号非常短，混响尾部可能不够长)。</p><h2 id="39ce" class="mr lo iq bd lp ms mt dn lt mu mv dp lx la mw mx lz le my mz mb li na nb md nc bi translated">指数正弦扫描</h2><p id="a624" class="pw-post-body-paragraph kr ks iq kt b ku nd jr kw kx ne ju kz la nf lc ld le ng lg lh li nh lk ll lm ij bi translated">使用已知信号，我们可以使用卷积/去卷积计算IR(参见下面的等式):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/bf91a027e3affdf976ff4c7016d2b501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rxp9KBmZbekka1GqS7Aa8g.png"/></div></div></figure><p id="df3e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让<em class="mi"> yᵣ </em>代表记录的信号。它是房间脉冲响应、<em class="mi"> fₘ </em>和一个已知信号、<em class="mi"> z </em>的混合。在频域中，这是两个信号的卷积(用*表示)。然后，通过将记录的信号与已知信号的逆信号<em class="mi"> zᶦ </em>进行卷积，可以计算出房间脉冲响应。Farina，2000 [2]通过使用指数正弦信号解决了计算IR的问题。ESS信号的倒数可以很容易地计算出来(带音量斜坡的反向ESS，见[1])。</p><p id="a563" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面给出了计算房间的<strong class="kt ir">脉冲响应的步骤</strong></p><ol class=""><li id="8dfc" class="nl nm iq kt b ku kv kx ky la nn le no li np lm nq nr ns nt bi translated">产生ESS和反ESS信号</li><li id="45aa" class="nl nm iq kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated">在一个(相对)安静的房间里安装麦克风和扬声器。</li><li id="5fcd" class="nl nm iq kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated">在扬声器上播放ESS信号，同时在麦克风中录音(在ESS信号结束后继续录音几秒钟，以捕捉混响)</li><li id="7586" class="nl nm iq kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated">使用下面的脚本计算IR</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="a1e1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">合成生成的IR(参见<a class="ae ni" href="https://github.com/microsoft/DNS-Challenge/tree/master/datasets/impulse_responses" rel="noopener ugc nofollow" target="_blank">微软DNS挑战</a>库的合成房间IR数据集)和使用“真实世界”房间设置生成的IR之间的主要区别是:1)背景/环境噪声，2)由于扬声器和麦克风的限制，房间IR会被破坏。</p><blockquote class="mf mg mh"><p id="6d16" class="kr ks mi kt b ku kv jr kw kx ky ju kz mj lb lc ld mk lf lg lh ml lj lk ll lm ij bi translated"><strong class="kt ir">频率响应</strong>:麦克风的频率响应表示它能够再现的声音/频率范围，以及它对各种频率范围的敏感程度。</p></blockquote><p id="85d9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">麦克风将音频转换为电信号，可以通过响应其振膜上的声波来记录；本质上转换机械波能量。频率响应表示话筒重现音频的有效程度(比如，在20Hz至20kHz的可听范围内)。虽然平坦的响应(对所有频率范围同等敏感)是可取的，但它在人声上听起来不太好。因此，许多麦克风(如智能手机上的麦克风)可能具有整形响应，在非常高或非常低的频率下不太敏感。</p><p id="1cc9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在多个麦克风上录制的相同音频事件可能听起来不同(假设房间非常安静且位置相同)。如果一个模型只看到了一个设备的音频，那么当看到一个新设备的音频时，它的表现<em class="mi">可能会很差</em>。<strong class="kt ir">进入麦克风增强</strong>。</p><h2 id="7e30" class="mr lo iq bd lp ms mt dn lt mu mv dp lx la mw mx lz le my mz mb li na nb md nc bi translated">计算麦克风的红外辐射</h2><p id="a771" class="pw-post-body-paragraph kr ks iq kt b ku nd jr kw kx ne ju kz la nf lc ld le ng lg lh li nh lk ll lm ij bi translated">假设以下条件:一个<em class="mi">完全隔音的房间</em>(无背景噪音)<em class="mi">吸收</em>所有声波(无混响)和一个<em class="mi">平坦频率响应的扬声器</em>。现在，记录信号的任何变形都是由于麦克风对不同频率的灵敏度造成的。前面提到的使用ESS方法计算的脉冲响应条件将表示麦克风的频率响应。</p><p id="ef85" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，在实践中，上述条件很难/很难实现。麦克风脉冲响应项目(<a class="ae ni" href="http://micirp.blogspot.com/p/about-micirp.html" rel="noopener ugc nofollow" target="_blank"> MicIRP </a>)使用与上述类似的设置来获取几个麦克风的IR。在他们的网站上可以免费获得！</p><h1 id="7d89" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">数据增强—在现实世界中</h1><p id="ebfa" class="pw-post-body-paragraph kr ks iq kt b ku nd jr kw kx ne ju kz la nf lc ld le ng lg lh li nh lk ll lm ij bi translated">在真实环境中，录制的音频会被麦克风灵敏度、环境声学、背景噪声(白/粉红噪声、环境噪声)等破坏。虽然这取决于手头的任务，但为了建立一个健壮的模型，通常混合各种增强是有帮助的。给定语料库，通过1)添加具有各种SNR水平的白/粉红噪声，2)添加环境噪声，3)与随机选择的房间IR卷积，4)与随机选择的麦克风IR卷积，来生成并行语料库。</p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><h1 id="7cc5" class="ln lo iq bd lp lq oi ls lt lu oj lw lx jw ok jx lz jz ol ka mb kc om kd md me bi translated">参考</h1><ol class=""><li id="e3be" class="nl nm iq kt b ku nd kx ne la on le oo li op lm nq nr ns nt bi translated">DIY脉冲响应捕捉。<a class="ae ni" href="http://tulrich.com/recording/ir_capture/#menu" rel="noopener ugc nofollow" target="_blank">T3【http://tulrich.com/recording/ir_capture】T5</a></li><li id="0cb0" class="nl nm iq kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated">安杰洛·法里纳。“用正弦扫频技术同时测量脉冲响应和失真”。音频工程学会第108号会议。音频工程学会，2000年。</li></ol></div></div>    
</body>
</html>