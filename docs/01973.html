<html>
<head>
<title>Stop Using ‘var’ to Declare Variables in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止使用“var”在JavaScript中声明变量</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/stop-using-var-to-declare-variables-in-javascript-6c0caec16f43?source=collection_archive---------0-----------------------#2020-02-10">https://levelup.gitconnected.com/stop-using-var-to-declare-variables-in-javascript-6c0caec16f43?source=collection_archive---------0-----------------------#2020-02-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="36b7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">“const”和“let”的介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0c0fec49fe85b31915bda606fd8874d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBV-Mwzgk19GL36A1geEnA.jpeg"/></div></div></figure><p id="31d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们都从某处开始。我学习了用<code class="fe lq lr ls lt b">var</code>关键字声明变量的JavaScript。这很简单也很有效，但我已经改变了。</p><p id="ca74" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你写类似于<code class="fe lq lr ls lt b">var x = 5</code>的代码，你需要停下来。嗯，我就实话实说吧，你<strong class="kw iu">没有</strong>要，但是你<strong class="kw iu">应该</strong>要。</p><p id="214f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们通常认为编程语言是一套刻在石头上的规则。现实情况是，编程语言——像任何口语一样——是不断发展的。</p><p id="9612" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我现在使用关键字<code class="fe lq lr ls lt b">const</code>和<code class="fe lq lr ls lt b">let</code>在JavaScript中声明我的所有变量，你也应该这样做。</p><p id="eb94" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们学习<em class="lu">如何</em>和<em class="lu">为什么</em>。</p><h1 id="59d2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">声明真常数</h1><p id="ac63" class="pw-post-body-paragraph ku kv it kw b kx mn ju kz la mo jx lc ld mp lf lg lh mq lj lk ll mr ln lo lp im bi translated">从名字上看，变量意味着一个变化的值。虽然声明和不接触变量并不一定有什么错，但是如果我们试图编写有语义意义的代码，那么我们应该区分变量和常量。</p><p id="2981" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">常数与变量相反，是一个不变的声明值。历史上，我们用所有的大写字母来定义常数，就像有毒动物身上的亮色。</p><p id="3195" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不依赖于惯例，<code class="fe lq lr ls lt b">const</code>关键字的引入给了我们一个明确的选项来声明不变的内容。</p><p id="3048" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要使用<code class="fe lq lr ls lt b">const</code>关键字，只需用<code class="fe lq lr ls lt b">var</code>替换它，现在这个值就不能修改了。</p><pre class="kj kk kl km gt ms lt mt mu aw mv bi"><span id="0e91" class="mw lw it lt b gy mx my l mz na">// the old way<br/>// var sales_tax = 0.06;</span><span id="a55d" class="mw lw it lt b gy nb my l mz na">// the new way<br/>const sales_tax = 0.06;</span><span id="b0cc" class="mw lw it lt b gy nb my l mz na">sales_tax = 0.08; // "TypeError: Assignment to constant variable.</span></pre><p id="f3b7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">实现很简单，原理也很简单。使用<code class="fe lq lr ls lt b">const</code>是显而易见的。但是什么时候合适呢？</p><p id="e51f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">税率或单位之间的转换等数字比率很容易获取。另一个你会看到使用<code class="fe lq lr ls lt b">const</code>的地方是使用<a class="ae nc" href="https://medium.com/better-programming/learning-javascript-arrow-functions-36cce13351c2" rel="noopener">箭头符号</a>声明函数。</p><pre class="kj kk kl km gt ms lt mt mu aw mv bi"><span id="cb58" class="mw lw it lt b gy mx my l mz na">const myFunction = (x,y) =&gt; {<br/>  // Do stuff<br/>}</span><span id="09dd" class="mw lw it lt b gy nb my l mz na">myFunction(1,2)</span></pre><p id="9b99" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在你的功能不能被覆盖。</p><h1 id="aa52" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">修复JavaScript古怪的范围</h1><p id="5baa" class="pw-post-body-paragraph ku kv it kw b kx mn ju kz la mo jx lc ld mp lf lg lh mq lj lk ll mr ln lo lp im bi translated">JavaScript缺乏范围清晰度，这常常导致开发和故障排除的失败。以下是JS范围奇怪之处的总结:</p><ul class=""><li id="f855" class="nd ne it kw b kx ky la lb ld nf lh ng ll nh lp ni nj nk nl bi translated">一个变量可以使用<code class="fe lq lr ls lt b">var</code>两次(重新声明)</li><li id="dece" class="nd ne it kw b kx nm la nn ld no lh np ll nq lp ni nj nk nl bi translated">默认情况下，顶级变量是全局的(全局对象)</li><li id="24c1" class="nd ne it kw b kx nm la nn ld no lh np ll nq lp ni nj nk nl bi translated">变量可以在声明之前使用(提升)</li><li id="b814" class="nd ne it kw b kx nm la nn ld no lh np ll nq lp ni nj nk nl bi translated">循环中的变量重复使用相同的引用(闭包)</li></ul><p id="4f60" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe lq lr ls lt b">let</code>澄清并解决了这些奇怪的事情。让我们仔细看看。</p><h2 id="e159" class="mw lw it bd lx nr ns dn mb nt nu dp mf ld nv nw mh lh nx ny mj ll nz oa ml ob bi translated">重新申报</h2><p id="70eb" class="pw-post-body-paragraph ku kv it kw b kx mn ju kz la mo jx lc ld mp lf lg lh mq lj lk ll mr ln lo lp im bi translated">这个很简单，你不能用<code class="fe lq lr ls lt b">let</code>重新声明一个变量。</p><pre class="kj kk kl km gt ms lt mt mu aw mv bi"><span id="7f10" class="mw lw it lt b gy mx my l mz na">var x = 0;<br/>let y = 0;</span><span id="d056" class="mw lw it lt b gy nb my l mz na">var x = 1;<br/>let y = 1; // "SyntaxError: Identifier 'y' has already been declared</span></pre><h2 id="da1e" class="mw lw it bd lx nr ns dn mb nt nu dp mf ld nv nw mh lh nx ny mj ll nz oa ml ob bi translated">全局对象</h2><p id="e1d1" class="pw-post-body-paragraph ku kv it kw b kx mn ju kz la mo jx lc ld mp lf lg lh mq lj lk ll mr ln lo lp im bi translated">在顶层，用<code class="fe lq lr ls lt b">var</code>声明的变量作为属性添加到全局对象中，而<code class="fe lq lr ls lt b">let</code>变量不是。</p><pre class="kj kk kl km gt ms lt mt mu aw mv bi"><span id="8aaa" class="mw lw it lt b gy mx my l mz na">var x = 0;<br/>let y = 0;</span><span id="1314" class="mw lw it lt b gy nb my l mz na">console.log(window.x); // 0<br/>console.log(window.y); // undefined</span></pre><h2 id="ec09" class="mw lw it bd lx nr ns dn mb nt nu dp mf ld nv nw mh lh nx ny mj ll nz oa ml ob bi translated">提升</h2><p id="7886" class="pw-post-body-paragraph ku kv it kw b kx mn ju kz la mo jx lc ld mp lf lg lh mq lj lk ll mr ln lo lp im bi translated">用<code class="fe lq lr ls lt b">let</code>定义的变量只能在它们的块范围内访问，而<code class="fe lq lr ls lt b">var</code>变量被提升到函数级。</p><pre class="kj kk kl km gt ms lt mt mu aw mv bi"><span id="8d4b" class="mw lw it lt b gy mx my l mz na">// Using var<br/>console.log(i);  // undefined<br/>for(var i=0; i&lt;4; i++) {<br/>  console.log(i);<br/>}<br/>console.log(i); // 4</span><span id="c423" class="mw lw it lt b gy nb my l mz na">// Using let<br/>console.log(j); // "ReferenceError: j is not defined<br/>for(let j=0; j&lt;4; j++) {<br/>  console.log(j);<br/>}<br/>console.log(j); // "ReferenceError: j is not defined</span></pre><h2 id="c210" class="mw lw it bd lx nr ns dn mb nt nu dp mf ld nv nw mh lh nx ny mj ll nz oa ml ob bi translated">关闭</h2><p id="5625" class="pw-post-body-paragraph ku kv it kw b kx mn ju kz la mo jx lc ld mp lf lg lh mq lj lk ll mr ln lo lp im bi translated">如果这是一个新概念，那么很难理解，但是闭包是一个引用自由变量的<a class="ae nc" href="https://www.freecodecamp.org/news/lets-learn-javascript-closures-66feb44f6a44/" rel="noopener ugc nofollow" target="_blank">函数。</a></p><p id="8923" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我们有一个带有<code class="fe lq lr ls lt b">var</code>变量的闭包时，引用被记住了，这在变量改变的循环中会很麻烦。</p><pre class="kj kk kl km gt ms lt mt mu aw mv bi"><span id="4593" class="mw lw it lt b gy mx my l mz na">var functions = [];</span><span id="5b10" class="mw lw it lt b gy nb my l mz na">for (var i = 0; i &lt; 3; i++) {<br/>  functions[i] = () =&gt; { console.log(i); };<br/>}<br/>for (var j = 0; j &lt; 3; j++) {<br/>  functions[j]();<br/>}</span><span id="dff0" class="mw lw it lt b gy nb my l mz na">// 3 3 3</span></pre><p id="0573" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe lq lr ls lt b">let</code>，每次都会创建一个新的参考。</p><pre class="kj kk kl km gt ms lt mt mu aw mv bi"><span id="619f" class="mw lw it lt b gy mx my l mz na">var functions = [];<br/>for (let i = 0; i &lt; 3; i++) {<br/>  functions[i] = () =&gt; { console.log(i); };<br/>}<br/>for (var j = 0; j &lt; 3; j++) {<br/>  functions[j]();<br/>}</span><span id="f24a" class="mw lw it lt b gy nb my l mz na">// 0 1 2</span></pre><p id="ec05" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最终，即使你不是100%了解这些原因以及它们为什么以这种方式工作，切换到<code class="fe lq lr ls lt b">let</code>将会产生更明确的代码，这些代码行为一致，并且更容易排除故障/维护。</p><h1 id="6a35" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">提醒一句</h1><p id="bb1a" class="pw-post-body-paragraph ku kv it kw b kx mn ju kz la mo jx lc ld mp lf lg lh mq lj lk ll mr ln lo lp im bi translated">尽管<code class="fe lq lr ls lt b">let</code>和<code class="fe lq lr ls lt b">const</code>应该有效地取代<code class="fe lq lr ls lt b">var</code>关键词，但生活并不总是如此简单。由于这些关键字是在ECMAScript 2015 (ES6)中引入的，如果您工作的平台不允许，那么您就不走运了。此外，您还需要确保采取措施来确保您的代码能够跨目标受众的浏览器运行。</p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><p id="5d21" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lu">你还发现自己在用</em> <code class="fe lq lr ls lt b"><em class="lu">var</em></code> <em class="lu">吗？是什么阻止你切换到使用</em> <code class="fe lq lr ls lt b"><em class="lu">const</em></code> <em class="lu">和</em> <code class="fe lq lr ls lt b"><em class="lu">let</em></code> <em class="lu">？下面分享一下你的经历吧！</em></p></div></div>    
</body>
</html>