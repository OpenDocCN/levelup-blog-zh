<html>
<head>
<title>Beginner’s Guide to Simple and Multiple Linear Regression Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单和多元线性回归模型初学者指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/beginners-guide-to-simple-and-multiple-linear-regression-models-d2d5dbe9e704?source=collection_archive---------6-----------------------#2020-06-01">https://levelup.gitconnected.com/beginners-guide-to-simple-and-multiple-linear-regression-models-d2d5dbe9e704?source=collection_archive---------6-----------------------#2020-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0af0b6c03e84bd4dca5b8d42ed4e5c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAOdHbwIVp7PBOxiRzUvJQ.png"/></div></div></figure><p id="f030" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">回归是一种常见的机器学习技术，用于预测真实值，例如基于一组特征的房屋价格。在这篇文章中，我将指导你通过简单线性回归和多元线性回归，同时实际操作一个原始数据集。</p><h1 id="d04e" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">简单与多元线性回归</h1><p id="a77a" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">线性回归是一种捕捉两个(<em class="kz">简单</em>)或更多(<em class="kz">多重</em>)变量之间线性关系的模型，其中一个被标记为<em class="kz">因变量</em>，另一个被标记为<em class="kz">自变量</em>。当自变量的增加或减少导致因变量的相应增加或减少时，存在线性关系。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi md"><img src="../Images/13b99c9ed0bcef4574d4fe643b7688d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*6xUFJuJbkobpAoeIfvCvZw.png"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated"><em class="mm">简单线性回归</em></figcaption></figure><p id="7829" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<strong class="kd iu">简单线性回归(SLR) </strong>中，我们的目标是根据自变量<em class="kz"> x </em>预测因变量<em class="kz"> y </em>的值。我们只研究这两个变量之间的关系。例如，我们将利用SLR来预测仅基于居住面积的房价。</p><p id="23f5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">虽然<em class="kz"> x </em>和<em class="kz"> y </em>之间的关系不一定是线性的，但是SLR模型包括数据中的误差，或者称为<strong class="kd iu">残差</strong>。一个残差是<em class="kz"> y </em>(蓝点)的真实值和<em class="kz"> y </em>(红线)的预测值之差。我们可以通过找到“最佳拟合线”来最小化误差，或者称为<strong class="kd iu">普通最小二乘法</strong>。要得到这条线，必须取<em class="kz"> y </em>的真值和<em class="kz"> y </em>的预测值之差的和，求平方，取最小值。我们取最小值是因为我们试图最小化真实值和预测值之间的距离，在下面的可视化中用黑线测量。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/430822eb345ae327f2055e008a8ac720.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*_b0CUDX2_x8isA7CH7_C9g.png"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">红线是“最佳拟合线”</figcaption></figure><p id="f0b9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">创建回归模型时，您很可能会处理多个独立变量。在这些情况下，我们将使用<strong class="kd iu">多元线性回归</strong>。例如，我们可以利用这个模型根据居住面积和卧室数量来预测房价。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/cea56b69dd85e5f6fd719d70f7d39ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*3uXZmkae5iUGDBwRxjKsTQ.png"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">多元线性回归</figcaption></figure><h1 id="e3fd" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">让我们熟悉一下数据</h1><p id="5814" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">我从<a class="ae mp" href="https://www.kaggle.com/harlfoxem/housesalesprediction" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中提取了一个关于<strong class="kd iu">美国金县</strong>房屋销售的数据集。Kaggle是有抱负的数据科学家常用的平台，在这里你可以参加比赛，参加迷你课程，并获取原始数据集。在本教程中，我利用Jupyter笔记本来操作数据集。</p><p id="6b95" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了熟悉我们的数据集，让我们列出<a class="ae mp" href="https://storage.googleapis.com/kaggle-forum-message-attachments/479761/11440/Screenshot%202019-02-27%20at%205.26.24%20PM.png" rel="noopener ugc nofollow" target="_blank">列</a>并了解我们将使用哪些特性。在进行任何数据分析之前，这是一个非常重要的步骤。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/c405c4d5b43aa7d4b0147f909ceb6ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*2kh6-BgY33C6bcAI_ZcfhQ.png"/></div></figure><h1 id="7c1b" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">让我们开始编码吧！</h1><blockquote class="mr ms mt"><p id="a25e" class="kb kc kz kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated"><strong class="kd iu">步骤1:导入库和数据集</strong></p></blockquote><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/b6160c2d9506d39ebd53679d0c067b6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ewXbnEkgE3dkEMvUz8utzw.png"/></div></figure><ul class=""><li id="96d6" class="my mz it kd b ke kf ki kj km na kq nb ku nc ky nd ne nf ng bi translated"><strong class="kd iu"> <em class="kz"> Numpy </em> </strong>是一个包含Python库的包，支持数组和矩阵的创建和操作，以及对这些数组进行操作的数学函数。</li><li id="0a3c" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated"><strong class="kd iu"> <em class="kz"> Matplotlib </em> </strong>是用于创建可视化的Python的绘图库。</li><li id="7c74" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated"><strong class="kd iu"> <em class="kz"> Pandas </em> </strong>是一个软件库，包含用于数据操作和分析的Python编程语言。</li></ul><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/74861b4b80cc128b4dcb017b39798cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*e6LIegwB6zhumPiKw0boZg.png"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk translated">我们的数据集有21，613行和21列。</figcaption></figure><p id="70a8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的目标是<strong class="kd iu">根据提供的数据预测房价</strong>。当处理一个原始数据集时，我们必须处理空值并删除任何对实现目标似乎无关紧要的列。我们的数据集不包含空值，并且删除了列<em class="kz"> id、date、lat、</em>和<em class="kz"> long </em>。</p><blockquote class="mr ms mt"><p id="a24d" class="kb kc kz kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated"><strong class="kd iu">第二步:确定因变量和自变量(SLR) </strong></p></blockquote><p id="8120" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">虽然因变量是<em class="kz">价格</em>，但我们必须选择一个我们认为最能影响房价的特征。我选择了<em class="kz">sqft _ living；</em>然而，对于选择特征的更精确的方法，我们可以执行<a class="ae mp" href="https://towardsdatascience.com/feature-selection-techniques-in-regression-model-26878fe0e24e" rel="noopener" target="_blank">特征选择</a>，这种方法允许我们选择以高精度预测因变量的最佳特征。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/87038d03d3313bfa193e8aa68e114c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*nXcMYSkcXBprIS1L6faVMQ.png"/></div></figure><blockquote class="mr ms mt"><p id="5b9e" class="kb kc kz kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated"><strong class="kd iu">第三步:将数据集分为训练集和测试集(SLR) </strong></p></blockquote><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2bc581470eafba51f72628964ad41bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*K_Z28isbIcV6EW4pTvs09A.png"/></div></figure><p id="afa6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">训练和测试分割的重要性在于，训练集包含模型从中学习的已知输出。然后，测试集根据从训练集中获得的信息来测试模型的预测。让我们看看这是怎么回事！</p><p id="545a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> <em class="kz">第四步:在训练集上训练简单线性回归模型</em> </strong></p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/dece1aedf4abbe032035480c5e90376c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*JYPLs7EKcFOiAE0mHCujIw.png"/></div></figure><p id="c211" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从包含线性模型的sklearn包中，我们导入类<strong class="kd iu"> LinearRegression </strong>，创建它的一个实例，并将其赋给一个变量。的。<em class="kz"> fit() </em>函数允许我们训练模型，根据数据值调整权重以达到更好的精度。经过训练后，我们的模型就可以进行预测了，这是由<em class="kz">调用的。</em>方法预测()。</p><blockquote class="mr ms mt"><p id="77c0" class="kb kc kz kd b ke kf kg kh ki kj kk kl mu kn ko kp mv kr ks kt mw kv kw kx ky im bi translated"><strong class="kd iu">步骤5:评估模型性能(SLR) </strong></p></blockquote><p id="6ccb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">既然我们已经成功地创建了单反模型，我们必须评估它的性能。<strong class="kd iu">残差图</strong>是纵轴显示残差，横轴显示预测值的图表。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/bdbcd8264d9628d12776c882246c1efc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*DQwWmtBGTJ9BneabmYmiCg.png"/></div></figure><p id="2bc9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果一个模型在预测方面做得很好，它应该具有以下特征:</p><ul class=""><li id="a44e" class="my mz it kd b ke kf ki kj km na kq nb ku nc ky nd ne nf ng bi translated">剩余点对称分布，聚集在图的中间。</li><li id="36fa" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">它们倾向于聚集在y轴的较低的一位数周围，例如0.5到1.5范围内的任何整数。</li><li id="a00f" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">它们没有清晰的模式。如果检测到模式，则可以改进模型。</li></ul><p id="456e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在上面的残差图中，我们可以清楚地看到一个模式正在形成:这些点紧密聚集，并在预测的房价达到150万美元后开始进一步远离。</p><p id="5227" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以评估我们的模型表现如何的另一种方法是调用<a class="ae mp" href="https://scikit-learn.org/stable/modules/generated/sklearn.dummy.DummyRegressor.html#sklearn.dummy.DummyRegressor.score" rel="noopener ugc nofollow" target="_blank">T5。score()  </a>函数返回预测的系数R。可能的最高分是1.0。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ce8637bf01f67808b12eb2d4da649bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*bHOPRTM8w8TAHcMhXs6tIQ.png"/></div></figure><p id="16ed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的训练集获得了48.9%的准确率，而我们的测试集获得了50.3%的准确率。</p><h1 id="e8f2" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">提升空间！</strong></h1><p id="f86c" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">虽然SLR是描述两个变量之间关系的一种简单快捷的方法，但它不是最常用的，因为因变量通常由多个特征决定。让我们看看是否可以通过创建一个<strong class="kd iu">多元线性回归</strong>模型<strong class="kd iu">来提高我们的准确度。</strong></p><p id="e13b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将遵循上面相同的步骤，除了将我们的独立变量<em class="kz"> X </em>分配给多个特征的数据集，而不是一个。我将<em class="kz"> X </em>分配给数据集中的所有列，不包括<em class="kz">价格</em>，因为那是我们的因变量。<em class="kz">(注意—在MLR中，没有必要将所有列都包含在数据集中。这可能会导致我们的模型</em> <strong class="kd iu"> <em class="kz">过拟合</em> </strong> <em class="kz">，这发生在我们的模型对训练集调得太好，以至于它在新数据集上表现不佳的时候。为了避免这种情况，我们应该执行</em> <strong class="kd iu"> <em class="kz">特征选择</em> </strong> <em class="kz">(尽管那已经超出了本文的范围)。</em></p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/310a993b68575dda5cb16c51efc492b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*qTnRTo7gRDvPZhXIBSPAHw.png"/></div></figure><p id="0dec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了了解MLR模型的性能，让我们创建一个残差图，并获得训练集和测试集的准确度分数。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/bab9e1f52752c346e266f7fa86eacf49.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*uI8edFEhOhQxPDGKPC_ZVw.png"/></div></figure><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/eb81dfb5d0f72381f6d3d7e552a6800d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*OE17DNXQIq749QfQANiKuA.png"/></div></figure><p id="b978" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">请注意，通过向我们的模型中添加更多的特征，我们能够将训练集和测试集的准确度分数提高到大约65%，并且残差图没有展示出清晰的模式。</p><h1 id="d481" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结论</h1><p id="16d1" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">在本指南中，我们回顾了简单和多元线性回归模型的基础知识。我们了解到以下情况:</p><ul class=""><li id="7d5f" class="my mz it kd b ke kf ki kj km na kq nb ku nc ky nd ne nf ng bi translated">SLR考察的是因变量和单个自变量之间的关系。</li><li id="3a98" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">MLR考察因变量和多个自变量之间的关系。</li><li id="aaf2" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">训练/测试分割对于确保我们的模型不会过度拟合非常重要。</li><li id="7e1e" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">残差图是评估线性回归模型性能的一种方法。</li><li id="510f" class="my mz it kd b ke nh ki ni km nj kq nk ku nl ky nd ne nf ng bi translated">。score()是通过确定模型的R系数来评估模型性能的另一种方法。</li></ul><p id="dcff" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们使用单一特征来预测房价时，我们得到的准确率为50%，而当我们整合多个特征时，我们得到的准确率为65%。这个分数可以通过特征选择或通过结合不同的回归模型来提高，例如<em class="kz">随机森林</em>或<em class="kz">决策树</em>。这些都是重要的技巧，我将在我即将发布的帖子中讨论。</p><p id="635c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢您的阅读。非常感谢您的反馈！</p></div></div>    
</body>
</html>