<html>
<head>
<title>Develop Docker Remotely from your Mac like a Pro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像专业人士一样从Mac远程开发Docker</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/develop-docker-remotely-from-your-mac-like-a-pro-69dcf75219e?source=collection_archive---------2-----------------------#2021-03-10">https://levelup.gitconnected.com/develop-docker-remotely-from-your-mac-like-a-pro-69dcf75219e?source=collection_archive---------2-----------------------#2021-03-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/98e8eb7f35807cc2b515007c8ae00e1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQPERZi0pkVNPfblez0UFQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">来源:<a class="ae kf" href="https://thenucleargeeks.com/2020/06/02/docker-for-beginners-introduction-to-dockers/" rel="noopener ugc nofollow" target="_blank">初学者Docker</a></figcaption></figure><p id="ecbb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">发展在继续前进，你如何发展也应该随之改变。通常我们正在开发的东西变得如此庞大和复杂，以至于从我们的本地机器上运行它们是不切实际的。不过不用担心，有了这个指南，你可以连接到一个远程服务器，使用docker容器进行开发。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi le"><img src="../Images/c6fc45647bafca2a3963a3272d92a699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9kbG0tKVuSm5GC5yTl_suQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">获得<a class="ae kf" href="https://www.reddit.com/r/homelab/comments/gtjpl0/homelab_meets_battlestation/" rel="noopener ugc nofollow" target="_blank"> u/GBKPres </a>的许可</figcaption></figure><p id="1a31" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我的例子中，我的开发环境是一个旧的dell R620，有104 Gb的内存和16个内核。我设计处理日志的系统，用于搜索和可视化。我不想让我的笔记本电脑24/7全天候消耗这些日志，这样能够在我的家庭实验室上远程开发可以节省我大量的时间和精力。</p><h1 id="c72e" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">安装Ubuntu服务器</h1><p id="2c81" class="pw-post-body-paragraph kg kh it ki b kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ml lb lc ld im bi translated">首先是从他们的网站<a class="ae kf" href="https://ubuntu.com/download/server" rel="noopener ugc nofollow" target="_blank">下载最新的Ubuntu服务器镜像</a>安装到我们的远程机器上。选择选项2进行手动安装，以下载映像。接下来，您需要按照他们的指南(链接如下)进行安装。我不会在这里讨论这个，因为他们有一个很好的指南。</p><div class="mm mn gp gr mo mp"><a href="https://ubuntu.com/tutorials/install-ubuntu-server#1-overview" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd iu gy z fp mu fr fs mv fu fw is bi translated">安装Ubuntu服务器</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">Ubuntu Server是你已经知道的标准Ubuntu的变体，为网络和服务量身定制。就像…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">ubuntu.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jz mp"/></div></div></a></div><h1 id="8802" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">安装Docker</h1><p id="aa99" class="pw-post-body-paragraph kg kh it ki b kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ml lb lc ld im bi translated">要安装docker，我建议使用snap。在我看来这是最简单的方法。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="25f8" class="nj lk it nf b gy nk nl l nm nn">sudo snap install docker</span></pre><p id="930d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">安装docker snap后，将您的用户添加到docker组中也很重要。这样，您就可以运行docker命令，而无需成为sudo'er，并允许我们远程连接到docker守护进程。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="4346" class="nj lk it nf b gy nk nl l nm nn">sudo addgroup --system docker<br/>sudo adduser $USER docker<br/>newgrp docker<br/>sudo snap disable docker<br/>sudo snap enable docker</span></pre><p id="c22b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我建议编辑/etc/sysctl.conf并在最后添加下面一行。不是所有的容器都需要这个集合，但是如果你确实需要它，找出它的缺失可能会很棘手。它设置允许容器请求多少虚拟内存。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="2042" class="nj lk it nf b gy nk nl l nm nn">sudo nano /etc/sysctl.conf</span><span id="36f0" class="nj lk it nf b gy no nl l nm nn"># Add this line to the end<br/>vm.max_map_count=262144</span></pre><p id="ae5b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完成后，运行<code class="fe np nq nr nf b">sudo sysctl —-system</code>命令将使用我们所做的配置更改来重新加载您的shell。</p><h1 id="3383" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">从您的Mac配置SSH</h1><p id="8080" class="pw-post-body-paragraph kg kh it ki b kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ml lb lc ld im bi translated">设置ssh的第一步是生成一个ssh密钥。下面的命令将让您做到这一点。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="370b" class="nj lk it nf b gy nk nl l nm nn">ssh-keygen</span></pre><p id="9c26" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将密钥保存到/Users/ <yourusername> /中。ssh/ubuntu_rsa</yourusername></p><p id="2f48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在所有提示中按enter键跳过添加密码(除非您觉得必须为此设置密码)。然后，您需要使用ssh-copy-id命令将该密钥复制到远程ubuntu服务器。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="aaa5" class="nj lk it nf b gy nk nl l nm nn">ssh-copy-id -i /Users/&lt;YourUsername&gt;/.ssh/ubuntu_rsa &lt;ServerUsername&gt;@&lt;ServerIP&gt;</span></pre><p id="d1d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">编辑您的ssh hosts文件，并添加以下变量来代替它们的实际值。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="d454" class="nj lk it nf b gy nk nl l nm nn">sudo nano /Users/&lt;YourUsername&gt;/.ssh/config</span><span id="db4f" class="nj lk it nf b gy no nl l nm nn">Host ubuntu<br/> HostName &lt;ServerIP&gt;<br/> user &lt;ServerUsername&gt;<br/> IdentityFile ~/.ssh/ubuntu_rsa</span></pre><p id="59e0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是从终端看到的条目。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/218215adb202e86c57f6122bb71ab773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5UvwQF3dYbXjortRuxUPw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">这个文件看起来像什么</figcaption></figure><p id="876d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在你可以ssh而不需要输入密码。试一试！</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="7406" class="nj lk it nf b gy nk nl l nm nn">ssh ubuntu</span></pre><h1 id="949c" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">远程Git设置</h1><p id="9300" class="pw-post-body-paragraph kg kh it ki b kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ml lb lc ld im bi translated">在您的服务器上设置git就像设置下面的全局配置选项一样简单。我建议你首先检查一下你是否在GitHub中设置了电子邮件隐私。要检查这一点，你可以从你的账户右上角进入你的账户-&gt;设置。然后导航至左侧栏中的电子邮件，并向下滚动至主要电子邮件地址。如果你在那里看见这个，复制它并且使用它作为你的电子邮件。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/7bfc71247f800b8f474dce953b991fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8QsOqYLftQdJ-wgUVF4kOw.png"/></div></div></figure><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="d97f" class="nj lk it nf b gy nk nl l nm nn">git config --global user.name "David Tippett"<br/>git config --global user.email <a class="ae kf" href="mailto:17506770+dtaivpp@users.noreply.github.com" rel="noopener ugc nofollow" target="_blank">17506770+dtaivpp@users.noreply.github.com</a></span></pre><p id="a3cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你觉得自己很勇敢，你可以用SSH或GPG键来设置它。我通常这样做，但是为了节省时间，这篇文章我不打算涵盖这一点。</p><h1 id="494f" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">安装Visual Studio代码</h1><p id="157e" class="pw-post-body-paragraph kg kh it ki b kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ml lb lc ld im bi translated">在本节中，我假设您已经安装了VSCode。如果你安装完之后没有回到这里(<a class="ae kf" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">从这里安装</a>)。</p><p id="660e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来安装一些扩展！从左下角的小方块开始，它有一个奇怪的浮动方块。我们将搜索并安装Remote - SSH和Docker。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/99e6866ceb6db90ec666f59a8dfb6d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*_WEg46_xjEsUHZtme_bLow.png"/></div></figure><p id="6ad3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦你安装了这些，你应该会在左边的栏中看到它们。点击远程ssh扩展……你会看到吗！它已经知道你的服务器了！这是因为它读取了/Users/ <yourusername> /。ssh/config文件来提取您设置的任何服务器连接。</yourusername></p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/656fcac73737ea777260f2e378032fc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*F-KehxhK36yuMfF2MA_XlQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">远程SSH扩展</figcaption></figure><p id="2321" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">点击Ubuntu行右边的小窗口，打开一个新窗口，目标是远程服务器。这包括从终端到远程服务器上的文件系统的所有内容。</p><p id="6579" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦你连接上了，点击Ctrl + Shift + ~打开一个远程服务器的终端(或者如果你喜欢菜单，它是顶栏的终端和新终端)。现在，您可以将一个repo克隆到您的服务器上。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="4fbd" class="nj lk it nf b gy nk nl l nm nn">git clone <a class="ae kf" href="https://github.com/dtaivpp/enterprise-logging.git" rel="noopener ugc nofollow" target="_blank">https://github.com/dtaivpp/enterprise-logging.git</a></span></pre><p id="41ca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在从VSCode的左上角开始，你可以选择open folder，它会显示远程服务器的选项。图为我的企业日志项目文件夹。选择您想要的，然后从右边选择确定。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nw"><img src="../Images/94767cbebdd7e951c0df23c37955c3cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8l2nPApKuRh3aoAXCgQjA.png"/></div></div></figure><p id="1fb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有趣的事情来了。现在，您可以在远程服务器上构建和运行docker容器了。对于我的，我进入终端，输入<code class="fe np nq nr nf b">docker-compose up</code>来启动我的服务。现在，我可以进入docker扩展，查看正在运行的内容，连接到容器，查看网络等。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/9381dffff563fbc832b286a852411334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*2t8ZkfjK6Fp3Jo34QTKQrQ.png"/></div></figure><p id="a2ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出于好奇，我使用的样本库是我编写本指南的原因之一。它创建了4个容器，执行以下操作:</p><p id="986f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Fluentd容器接受netflow和syslogs，并将它们索引到<a class="ae kf" href="https://opendistro.github.io/for-elasticsearch/" rel="noopener ugc nofollow" target="_blank"> OpenDistro Elasticsearch </a>节点中。从这里可以看到基巴纳。将这些放在服务器上是很有用的，因为服务器上有真正的netflows和syslogs进入其中进行开发。这就是为什么在我的笔记本电脑上开发对我来说是不实际的。有了这个设置，我就可以部署到我的服务器上，然后用实验室环境中的真实数据进行测试。</p></div></div>    
</body>
</html>