<html>
<head>
<title>Raspberry PI3 — Modbus connection (RS232 to TTL — UART) 2023</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Raspberry PI3 — Modbus连接(RS232至TTL — UART) 2023</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/raspberry-pi3-setup-modbus-connection-rs232-to-ttl-uart-af366d4feaf8?source=collection_archive---------14-----------------------#2022-08-04">https://levelup.gitconnected.com/raspberry-pi3-setup-modbus-connection-rs232-to-ttl-uart-af366d4feaf8?source=collection_archive---------14-----------------------#2022-08-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7ffa4ff931cfc401fbded7785fac86e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M82DmuxqnS-DC1AdyyBSoQ.jpeg"/></div></div></figure><p id="9922" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本指南中，我将向您展示如何设置您的raspberry PI3通过TTL串行端口(和RS232通信模块)与Modbus通信</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="e556" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认情况下，在新的Raspberry Pi IOS安装上，<code class="fe ld le lf lg b">UART0</code> ( <em class="lh">异步串行通信协议</em>)是为“登录Shell”保留的。</p><p id="4cb1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要将<code class="fe ld le lf lg b">UART0</code>用于其他应用程序，您需要<strong class="ka ir">通过本地配置关闭</strong>到登录Shell的连接。所以，在你的覆盆子终端输入:</p><ul class=""><li id="d58c" class="li lj iq ka b kb kc kf kg kj lk kn ll kr lm kv ln lo lp lq bi translated"><code class="fe ld le lf lg b">sudo raspi-config</code></li></ul><p id="d76a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择<code class="fe ld le lf lg b">interfacing options</code>，选择<code class="fe ld le lf lg b">serial</code>，回答:</p><ul class=""><li id="2351" class="li lj iq ka b kb kc kf kg kj lk kn ll kr lm kv ln lo lp lq bi translated"><strong class="ka ir">否</strong>到"<em class="lh">您希望通过序列号</em>访问登录shell吗？"</li></ul><p id="789a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">和</p><ul class=""><li id="c352" class="li lj iq ka b kb kc kf kg kj lk kn ll kr lm kv ln lo lp lq bi translated"><strong class="ka ir"> YES </strong> to " <em class="lh">您想要启用串行端口硬件吗</em>？"</li></ul><p id="6dde" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择<code class="fe ld le lf lg b">finish</code>，然后用<code class="fe ld le lf lg b">sudo shutdown -r now</code>重启</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="0516" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在还有一个步骤来完成配置。设备启动后，使用shell命令编辑文件<code class="fe ld le lf lg b">config.txt</code>:</p><ul class=""><li id="7ce8" class="li lj iq ka b kb kc kf kg kj lk kn ll kr lm kv ln lo lp lq bi translated"><code class="fe ld le lf lg b">sudo nano /boot/config.txt</code></li></ul><p id="a5f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在文件的底部添加这两行:</p><p id="3d71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ld le lf lg b">enable_uart=1</code></p><p id="ad6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ld le lf lg b">dtoverlay=disable-bt</code></p><p id="7e01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仔细检查拼写，然后在退出时保存文件。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="ff56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，您需要编辑的第二个文件是文件<code class="fe ld le lf lg b">cmdline.txt</code>，因此使用命令:</p><ul class=""><li id="8ed3" class="li lj iq ka b kb kc kf kg kj lk kn ll kr lm kv ln lo lp lq bi translated"><code class="fe ld le lf lg b">sudo nano /boot/cmdline.txt</code></li></ul><p id="9ba1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它应该是这样的:</p><pre class="lr ls lt lu gt lv lg lw lx aw ly bi"><span id="02c9" class="lz ma iq lg b gy mb mc l md me">console=tty1 root=PARTUUID=ede33e1e-02 rootfstype=ext4 fsck.repair=yes rootwait</span></pre><p id="7a81" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果有<code class="fe ld le lf lg b">console=/dev/ttyAMA0,115200</code>,您应该移除它。</p><p id="c57f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仔细检查拼写，然后在退出时保存文件。然后用<code class="fe ld le lf lg b">sudo shutdown -r now</code>重启</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/346aa40ed3f157043f91659562fec8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*Shgb84rjudtMxRRlepe50Q.png"/></div></figure><p id="3956" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，你应该可以走了。可以从<code class="fe ld le lf lg b">dev/serial0</code>口读取数据！！</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/26d9026dcf98405e62154aec89a61fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*nGTALvocN7NZ0JcztNdweA.png"/></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">如果你得到许可错误尝试:sudo usermod -a -G tty pi</figcaption></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="5799" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了将树莓连接到Modbus，我使用了亚马逊上售价约10欧元的MAX3232 RS232转TTL转换器。</p><p id="289e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">开始接线之前，请确保知道在哪里连接引脚！在Raspberry PI3中，UART引脚是<code class="fe ld le lf lg b">GPIO14</code>和<code class="fe ld le lf lg b">GPIO15</code>。请务必仔细检查官方文档和数据表，以确保硬件布线的正确性！</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/aad32ad063421b498c37f93958630ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*sV7ee_y-bb9VDpzT20NBwQ.png"/></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">Raspberry PI3文档UART引脚</figcaption></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/4db12f943c283bd6a3acf029a38842c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xqnI-xX3KRjfryLUzvArrg.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">RS232至TTL接线</figcaption></figure><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/01a667616f360bb7ef5069505a812316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_I3HdFjcRud1l1kvmf3mA.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">树莓GPIO布线</figcaption></figure><p id="5fdf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">概括地说，这是我如何连续处理获得的数据的概要:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/2f6975375a2d927497d45d14171e245c.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*A0AstoRP8B3JOfOgNc7P4Q.png"/></div></figure><p id="6b15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">作为树莓上读取串口的库，我用的是<code class="fe ld le lf lg b">modbus-serial</code> (nodejs)。还有其他好的选择，比如<code class="fe ld le lf lg b">py-modbus</code>，或者在<code class="fe ld le lf lg b">C</code>处理通信。</p><p id="db86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用于通信的端口是<code class="fe ld le lf lg b">/dev/serial0</code>！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="5911" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢我的文章，请不要忘记点击👏👏👏推荐给其他人👏👏👏。</p><p id="07cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请随意提问、发表意见或提出更好的解决方案。别忘了在<a class="ae mp" href="https://twitter.com/fabchiarani" rel="noopener ugc nofollow" target="_blank">推特</a>和<a class="ae mp" href="https://github.com/Xiryl" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上关注我！</p></div></div>    
</body>
</html>