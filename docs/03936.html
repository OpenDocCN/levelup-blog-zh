<html>
<head>
<title>Performing Data Visualization using the Covid-19 Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用新冠肺炎数据集执行数据可视化</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/performing-data-visualization-using-the-covid-19-dataset-47c441747c43?source=collection_archive---------15-----------------------#2020-06-02">https://levelup.gitconnected.com/performing-data-visualization-using-the-covid-19-dataset-47c441747c43?source=collection_archive---------15-----------------------#2020-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d1fe7e311d9ffc8b41215fad54cd24d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bM8aH_yl7k3cwE2hA-8a2w.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">想象新冠肺炎在世界地图上的影响</figcaption></figure><p id="6b2b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi ld translated"><span class="l le lf lg bm lh li lj lk ll di">在</span>我的上一篇文章“<a class="ae lm" href="https://medium.com/@weimenglee/performing-data-analytics-on-the-covid-19-dataset-using-python-numpy-and-pandas-bdfc352c61e9" rel="noopener">使用Python、NumPy和Pandas </a>对新冠肺炎数据集执行数据分析”中，我向您介绍了在Convid-19数据集上执行数据分析的步骤。本文是那篇文章的延续，这一次您将学习如何创建漂亮的视觉效果来讲述您之前完成的结果。</p><blockquote class="ln lo lp"><p id="4719" class="kf kg lq kh b ki kj kk kl km kn ko kp lr kr ks kt ls kv kw kx lt kz la lb lc im bi translated">如果您还没有阅读上一篇文章，请现在阅读，因为本文中使用的一些数据框架是基于那篇文章的。</p></blockquote><h1 id="a880" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">显示每个国家确诊和死亡病例的条形图</h1><p id="2c20" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">您要绘制的第一个图形是一系列描绘每个国家确诊和死亡病例总数的条形图:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="232e" class="ng lv it nc b gy nh ni l nj nk">import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="f7bb" class="ng lv it nc b gy nl ni l nj nk">plt.style.use('ggplot')<br/>plt.rcParams["figure.figsize"] = (12,7)</span><span id="01f1" class="ng lv it nc b gy nl ni l nj nk">for country, df_country in df_daily.groupby(level=1):    <br/>    dates = list(df_country.index.get_level_values('Date'))<br/>    confirmed = list(df_country.Confirmed)<br/>    deaths = list(df_country.Deaths)</span><span id="3913" class="ng lv it nc b gy nl ni l nj nk">    plt.bar(dates, confirmed, color='lightblue', <br/>        label="Total Number of Confirmed Cases")<br/>    plt.bar(dates, deaths, color='red',<br/>        label="Total Number of Deaths Reported")<br/>    plt.xlabel("Dates")<br/>    plt.ylabel("Number of people")<br/>    plt.title(country)<br/>    plt.legend()<br/>    plt.show()</span></pre><blockquote class="ln lo lp"><p id="524d" class="kf kg lq kh b ki kj kk kl km kn ko kp lr kr ks kt ls kv kw kx lt kz la lb lc im bi translated">我在这里使用的绘图库是<strong class="kh iu"> matplotlib </strong>。</p></blockquote><p id="564e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">它将为所有不同的国家生成条形图。下面是第一个:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/a5199096534f938ed5cf9115bbc955fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHW5Fib7A3yBawT188wJMw.png"/></div></div></figure><p id="aa21" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">正如你所看到的，浅蓝色条代表每天确诊的病例数，而红色条代表死亡人数。这是我们的图表:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/97f9de99b9e63a84317e5b3cb6853168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_6K43v1g-eIWNdz_WdzKA.png"/></div></div></figure><blockquote class="ln lo lp"><p id="58df" class="kf kg lq kh b ki kj kk kl km kn ko kp lr kr ks kt ls kv kw kx lt kz la lb lc im bi translated">请注意，每天的病例数是累积的。所以你总是会看到趋势在上升(如果没有新的病例，顶多是持平)。</p></blockquote><p id="fc5f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">对于与确诊病例相比死亡人数较低的国家，您将真正看到非常微小的红色条(如果有的话)。新加坡就是这样一个例子:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/24b5650597371f00cfc0b047078856d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z3JlBZS0LhUQYmwUdvFoog.png"/></div></div></figure><p id="f685" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">另一方面，英国的死亡率相对较高:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/519329f3504d8b40cb318c46b1416ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VCaiFW2a-W-MVG4YRLf9JQ.png"/></div></div></figure><h1 id="8db3" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">创建饼图</h1><p id="fb8c" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">我想创建的下一个视觉效果是一个饼图。为此，我定义了一个名为<strong class="kh iu"> plot_pie(df，column，title) </strong>的函数。它接受3个参数—数据帧、数据帧中使用的列名和饼图的标题:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b667" class="ng lv it nc b gy nh ni l nj nk">def plot_pie(df, column, title):<br/>    labels = list(df.index)<br/>    sizes = list(df[column])<br/>    explode = [0 for n in range(10)]<br/>    <br/>    with plt.style.context(<br/>        { "axes.prop_cycle" : plt.cycler("color", <br/>        plt.cm.tab20c.colors)}):<br/>        fig1, ax1 = plt.subplots()</span><span id="0b5d" class="ng lv it nc b gy nl ni l nj nk">        ax1.pie(sizes, <br/>                explode=explode, <br/>                labels=labels, <br/>                autopct='%1.2f%%', <br/>                shadow=False, <br/>                startangle=0)<br/>        ax1.axis('equal')  # Equal aspect ratio ensures that pie is <br/>                           # drawn as a circle.</span><span id="5b3e" class="ng lv it nc b gy nl ni l nj nk">        plt.legend()<br/>        plt.title(title)<br/>    <br/>    centre_circle = plt.Circle((0,0),0.70,fc='white')<br/>    fig = plt.gcf()<br/>    fig.gca().add_artist(centre_circle)</span><span id="57c2" class="ng lv it nc b gy nl ni l nj nk">    plt.show()</span></pre><h1 id="4474" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">显示前10个确认国家的分布</h1><p id="0054" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">为了直观显示确诊病例最多的10个国家的分布情况，让我们绘制一个饼图:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="7ed7" class="ng lv it nc b gy nh ni l nj nk">top10_countries_confirmed = df_most_confirmed_recent_sorted.head(10)</span><span id="1bb6" class="ng lv it nc b gy nl ni l nj nk">plot_pie(top10_countries_confirmed, <br/>         "Confirmed", <br/>         "Top 10 Confirmed Countries")</span></pre><p id="7616" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">您将看到以下内容。你可以看到，在前10个国家中，美国有近一半的确诊病例。</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7913a295e899ae2baac8376fd0e77c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*7jsXYM3ngOftcRwu7BYy_Q.png"/></div></figure><h1 id="4591" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">中国确诊病例最多的10个省份</h1><p id="7458" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">现在让我们看看中国确诊病例最多的10个省份:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="cf1c" class="ng lv it nc b gy nh ni l nj nk">plot_pie(df_combined_china_most_recent_sorted, <br/>         "Confirmed", <br/>         "Top 10 provinces in China with confirmed cases")</span></pre><p id="24bb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">毫不奇怪，湖北是疫情爆发的中心:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/176abf28d69713859704eefffcc632e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*Oupyei-FSXIs6kbeOzqUlw.png"/></div></figure><h1 id="0e34" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">报告死亡人数最多的10个国家</h1><p id="4190" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">接下来，显示报告死亡人数最多的10个国家:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="28c5" class="ng lv it nc b gy nh ni l nj nk">df_most_deaths_recent_sorted = df_most_deaths_recent_sorted.head(10)<br/>plot_pie(df_most_deaths_recent_sorted, <br/>         "Deaths", <br/>         "Top 10 Countries with Deaths Reported")</span></pre><p id="feb9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">您应该看到以下内容:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/b10686c76365348903ec0d9db4117b74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGKNvGFQLwDnAbOhUmJVYA.png"/></div></div></figure><blockquote class="ln lo lp"><p id="3653" class="kf kg lq kh b ki kj kk kl km kn ko kp lr kr ks kt ls kv kw kx lt kz la lb lc im bi translated">虽然英国在确诊病例数量上排名第四，但在报告的死亡人数上排名第二。</p></blockquote><h1 id="8d33" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">拉平曲线</h1><p id="433b" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">还记得我之前提到过记录的数字(确诊和死亡)都是累积的吗？因为它们是累积的，所以很难知道一个国家的情况是在改善还是在恶化。因此，如果我们能够“展开”这些数字，以便能够获得每天新报告的数字，那将是非常有用的。所以这就是我们要做的:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4f2b" class="ng lv it nc b gy nh ni l nj nk">plt.rcParams["figure.figsize"] = (12,7)</span><span id="3584" class="ng lv it nc b gy nl ni l nj nk"># for each country<br/>for country, df_country in df_daily.groupby(level=1):    <br/>    # get the list of dates<br/>    dates = list(df_country.index.get_level_values('Date'))<br/>    <br/>    # get the confirmed numbers<br/>    confirmed = list(df_country.Confirmed)<br/>    <br/>    # get the deaths<br/>    deaths = list(df_country.Deaths)<br/>    <br/>    # form a new dataframe for the specific country<br/>    df = pd.DataFrame(dates)<br/>    df["Confirmed"] = confirmed<br/>    df["Deaths"] = deaths</span><span id="a41e" class="ng lv it nc b gy nl ni l nj nk">    # unroll (reverse cumsum) the columns - confirmed and deaths    <br/>    df_unrolled = df.diff().fillna(df)    <br/>    df_unrolled[0] = dates<br/>    <br/>    # plot the line charts<br/>    plt.plot(dates, df_unrolled["Confirmed"], color='blue', <br/>             label="Confirmed Cases Per Day")<br/>    plt.plot(dates, df_unrolled["Deaths"], color='red', <br/>             label="Deaths Per Day")<br/>    plt.xlabel("Dates")<br/>    plt.ylabel("Number of people")<br/>    plt.title(country)<br/>    plt.legend()</span><span id="775b" class="ng lv it nc b gy nl ni l nj nk">    plt.show()</span></pre><p id="de1d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在上面的代码片段中，我们提取了每个国家的每日数字，以形成一个新的数据帧。然后我们使用<strong class="kh iu"> diff() </strong>函数来展开累加的数字。一旦数字展开，我们将为每个国家绘制一个折线图。这里有一个例子:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/083dac2dc25f484139ff1db17c1ac280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NeS3qsvFI1eTTmPzBxZLkg.png"/></div></div></figure><p id="bb46" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如你所见，新西兰几乎打败了病毒:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/9460d3f2ce42e8c31c43ffe2f58de1a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*45rGMxb5AhmDWYjlnOPjLQ.png"/></div></div></figure><p id="1c08" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">而南非仍在打一场艰苦的战斗:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/9bca00be35ca033eedbc014081ff1fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LMhiVi_4BsMpYHicpOwMQg.png"/></div></div></figure><p id="c9da" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">您可能还会看到一些国家的“峰值”低于0:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/3d8804d1badf43d44ca7eefa9a2bac25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LRolK4MMHOm6T001Rmz8Fw.png"/></div></div></figure><p id="8d25" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这很可能是由于对数字进行了调整。例如，某一天记录的数字可能是5000，但第二天该数字(累计)可能向下调整到4000(可能是由于测试、记录等方面的错误)。</p><h1 id="9750" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">在地图上显示所有确诊病例</h1><p id="d124" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">最后，如果我们能在一张世界地图上显示所有案例，那不是很好吗？我们会在世界地图上画圆，用圆的半径来代表国家的严重程度。我们将使用绿色圆圈代表确诊病例，红色圆圈代表死亡病例:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="7c02" class="ng lv it nc b gy nh ni l nj nk">import folium</span><span id="5a04" class="ng lv it nc b gy nl ni l nj nk"># get the most recent date in the df<br/>most_recent_date = df_combined['Date'].max()</span><span id="8c24" class="ng lv it nc b gy nl ni l nj nk"># get all the data on this most recent date<br/>df_latest_day = df_combined[df_combined.Date==most_recent_date]</span><span id="d804" class="ng lv it nc b gy nl ni l nj nk"># create a map<br/>folium_map = folium.Map(location=[40.738, -73.98], zoom_start=4)</span><span id="712a" class="ng lv it nc b gy nl ni l nj nk">color="#E37222" # tangerine<br/>scale = 5000</span><span id="3807" class="ng lv it nc b gy nl ni l nj nk">for place in df_latest_day.index:<br/>    lat = df_latest_day.loc[place]["Lat"]<br/>    lng = df_latest_day.loc[place]["Long"]    <br/>    confirmed = df_latest_day.loc[place]["Confirmed"]<br/>    deaths    = df_latest_day.loc[place]["Deaths"]</span><span id="f22f" class="ng lv it nc b gy nl ni l nj nk">    # CONFIRMED cases<br/>    # draw a circle on the province/state/region/country<br/>    marker_confirmed = folium.CircleMarker(location=[lat, lng],<br/>                                 radius=confirmed/scale,<br/>                                 color="green",<br/>                                 fill=True)<br/>    marker_confirmed.add_to(folium_map)<br/>    <br/>    # DEATHS cases<br/>    # draw a circle on the province/state/region/country<br/>    radius = deaths/scale if deaths&gt;0 else 0.000000001<br/>    marker_deaths = folium.CircleMarker(location=[lat, lng],<br/>                                 radius=radius,<br/>                                 color="red",<br/>                                 fill=True)<br/>    marker_deaths.add_to(folium_map)</span><span id="25b1" class="ng lv it nc b gy nl ni l nj nk">folium_map.save("Covid-19 Map.html")</span></pre><blockquote class="ln lo lp"><p id="e277" class="kf kg lq kh b ki kj kk kl km kn ko kp lr kr ks kt ls kv kw kx lt kz la lb lc im bi translated">F <!-- -->或者地图，我用的是<strong class="kh iu">叶</strong>库。Folium是一个强大的Python库，可以帮助您创建多种类型的传单地图。传单是领先的移动友好的交互式地图的开源JavaScript库。</p><p id="02e2" class="kf kg lq kh b ki kj kk kl km kn ko kp lr kr ks kt ls kv kw kx lt kz la lb lc im bi translated">使用的地图是OpenStreetMap。要安装叶子，输入如下:<strong class="kh iu"> pip安装叶子</strong></p></blockquote><p id="23ee" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这是地图！您可以放大和缩小以查看各个国家的更多细节。</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d1fe7e311d9ffc8b41215fad54cd24d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bM8aH_yl7k3cwE2hA-8a2w.png"/></div></div></figure><h1 id="4434" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">摘要</h1><p id="cfa1" class="pw-post-body-paragraph kf kg it kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">数据可视化是一个非常强大的工具，可以让您的数据分析结果栩栩如生。不要看数字，使用图表和图形通常可以更容易地传达重要的数字。希望这篇文章对你有用！</p></div></div>    
</body>
</html>