<html>
<head>
<title>How to: Reset Badge Value of CloudKit Remote Notification on iOS/iPadOS 15</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何:在iOS/iPadOS 15上重置CloudKit远程通知的徽章值</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-reset-badge-value-of-cloudkit-remote-notification-on-ios-ipados-15-46726a435599?source=collection_archive---------4-----------------------#2021-06-18">https://levelup.gitconnected.com/how-to-reset-badge-value-of-cloudkit-remote-notification-on-ios-ipados-15-46726a435599?source=collection_archive---------4-----------------------#2021-06-18</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="b780" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">帮助解决徽章计数问题的简单易行的解决方案。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/d06dca60fa68f2440655bc470bc27efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TI33HEekgtNCrS3V_-s2_g.png"/></div></div></figure><p id="b1fc" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi lr translated">在WWDC21期间，我和苹果工程师讨论了CloudKit和通知相关的问题。</p><p id="fb1c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">问题</strong>:“当我们从CloudKit推送远程通知到设备时，工卡计数与“记录类型”中的行号相同。<br/>虽然我们可以在本地使用<br/> <code class="fe ma mb mc md b">UIApplication.shared.applicationIconBadgeNumber = 0</code>重置徽章号，但是再按一次后，徽章号就会大于1。例如:<br/>行为— —徽章号<br/>设备收到推送通知— — 1 <br/>用户打开应用/点击通知横幅— — 0 <br/>设备收到另一个通知— — 2(假设应该是1)”</p><p id="3679" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">问题</strong>:“那么，我们如何在本地和CloudKit中重置徽章号？”🧐</p><p id="b584" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">回答</strong>:苹果工程师告诉我这个问题和CKModifyBadgeOperation有关。但是，多年前就被弃用了。因此，我可能需要向反馈助理发送建议。🥲</p><p id="f241" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">打完</strong>电话后，我意识到<code class="fe ma mb mc md b">CKModifyBadgeOperation</code>仍然可以在iOS/iPadOS 15上工作。😆</p><h1 id="8606" class="me mf iu bd mg mh mi mj mk ml mm mn mo ka mp kb mq kd mr ke ms kg mt kh mu mv bi translated">编码教程</h1><h2 id="febe" class="mw mf iu bd mg mx my dn mk mz na dp mo le nb nc mq li nd ne ms lm nf ng mu nh bi translated">环境</h2><ul class=""><li id="e806" class="ni nj iu kx b ky nk lb nl le nm li nn lm no lq np nq nr ns bi translated">iOS / iPadOS 15</li><li id="4af5" class="ni nj iu kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated">Xcode 13</li></ul><p id="5daf" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在SwiftUI上测试和工作(如果您没有AppDelegate，请使用<em class="ny">UIApplicationDelegateAdaptor将其集成到您的应用程序中)。<br/></em><a class="ae nz" href="https://www.hackingwithswift.com/quick-start/swiftui/what-is-the-uiapplicationdelegateadaptor-property-wrapper" rel="noopener ugc nofollow" target="_blank"><em class="ny">https://www . hackingwithswith swift . com/quick-start/swift ui/what-is-the-uiapplicationdelegateadaptor-property-wrapper</em></a></p><p id="d572" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">让我们开始吧！</p><p id="44ea" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">第1步:将下面的代码放在“didFinishLaunchingWithOptions”或“applicationDidBecomeActive”下</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oa ob l"/></div></figure><p id="6f49" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">您可能会看到警告说，“CKModifyBadgeOperation”在iOS 11.0中已被否决:不再受支持，将在未来的某个时间点停止工作”。请忽略它并重新运行应用程序。</p><p id="8679" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">第二步:…不，第二步😇</p><p id="6a15" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在，您可以通过CloudKit仪表板再次推送通知，看看它是否对您有用。</p><div class="oc od gq gs oe of"><a href="https://icloud.developer.apple.com" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fp"><div class="oh ab oi cl cj oj"><h2 class="bd iv gz z fq ok fs ft ol fv fx it bi translated">使用您的Apple ID登录</h2><div class="om l"><h3 class="bd b gz z fq ok fs ft ol fv fx dk translated">使用您的Apple ID登录</h3></div><div class="on l"><p class="bd b dl z fq ok fs ft ol fv fx dk translated">使用您的Apple IDicloud.developer.apple.com登录</p></div></div></div></a></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oo"><img src="../Images/14ce8acc24ca7ddc5ff8350a8a2bf3e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*frnzjR3vNTf2jit0uwcBxg.png"/></div></div></figure><p id="e8a3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">更新(24/6/2021): <br/> </strong>我也问了API弃用日期，下面是苹果的回应。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj op"><img src="../Images/00841794859c9bcb82ef08cd68692585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zWunT9R1Atl5n4pVvqzbxw.png"/></div></div></figure></div><div class="ab cl oq or hy os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="in io ip iq ir"><p id="4d63" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">P.S .如果您想了解更多关于CloudKit及其用法的信息，您可以访问苹果的Github repo并查看示例项目:</p><div class="oc od gq gs oe of"><a href="https://github.com/apple?q=cloudkit-sample&amp;type=repository" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fp"><div class="oh ab oi cl cj oj"><h2 class="bd iv gz z fq ok fs ft ol fv fx it bi translated">苹果</h2><div class="om l"><h3 class="bd b gz z fq ok fs ft ol fv fx dk translated">Swift编程语言C++ 56.3k 9k这维护了对更改和用户可见增强的建议…</h3></div><div class="on l"><p class="bd b dl z fq ok fs ft ol fv fx dk translated">github.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc kt of"/></div></div></a></div></div><div class="ab cl oq or hy os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="in io ip iq ir"><h1 id="06ef" class="me mf iu bd mg mh pd mj mk ml pe mn mo ka pf kb mq kd pg ke ms kg ph kh mu mv bi translated">感谢阅读:)</h1></div><div class="ab cl oq or hy os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="in io ip iq ir"><p id="a95b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">关于作者:</strong> <br/>明— UI设计师&amp; App开发者<br/>奖项:苹果WWDC2021 Swift学生挑战赛冠军<br/>推特:<a class="ae nz" href="https://twitter.com/1998design" rel="noopener ugc nofollow" target="_blank">https://twitter.com/1998design</a><br/>雇佣我:<a class="ae nz" href="mailto:job@1998.media" rel="noopener ugc nofollow" target="_blank"> job@1998.media </a>(无垃圾广告或宣传片，谢谢)</p></div></div>    
</body>
</html>