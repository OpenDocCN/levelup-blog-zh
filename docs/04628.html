<html>
<head>
<title>Common Vue Problems — Removing Repeated Elements, Global Events, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">常见的Vue问题—删除重复元素、全局事件等等</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/common-vue-problems-removing-repeated-elements-global-events-and-more-d09be6474df1?source=collection_archive---------13-----------------------#2020-07-06">https://levelup.gitconnected.com/common-vue-problems-removing-repeated-elements-global-events-and-more-d09be6474df1?source=collection_archive---------13-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/7f56751e62f15c43763924bbcb75dc49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lsT4gL0mvaM7u8eg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@katekerdi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Katerina Kerdi </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="13fb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="d78e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在用v-for呈现列表之前删除重复的元素</h1><p id="f99d" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了在使用<code class="fe mh mi mj mk b">v-for</code>呈现列表之前删除重复的元素，我们可以使用Lodash方法创建一个没有重复的比较属性。</p><p id="b45d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="8182" class="mt lf it mk b gy mu mv l mw mx">import uniq from 'lodash/uniq'<br/>// ...</span><span id="5f28" class="mt lf it mk b gy my mv l mw mx">computed: {<br/>  uniqueCategories() {<br/>    return uniq(this.products.map(({ category }) =&gt; category))<br/>  }<br/>}</span></pre><p id="67be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们从每个类别中获得独特的项目。</p><p id="1c8e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以用<code class="fe mh mi mj mk b">v-for</code>和<code class="fe mh mi mj mk b">uniques</code>来代替<code class="fe mh mi mj mk b">products</code>数组，</p><p id="0e8c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="7a24" class="mt lf it mk b gy mu mv l mw mx">&lt;li v-for="category in uniqueCategories"&gt;<br/>  {{category}}<br/>&lt;/li&gt;</span></pre><h1 id="3d4f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">运行Jest测试时意外导入令牌</h1><p id="d83b" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们有这个错误，这意味着JavaScript解释器不能识别这个语法。</p><p id="85a5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了解决这个问题，我们可以给巴别塔添加<code class="fe mh mi mj mk b">transform-es2015-modiles-commonjs</code>插件。</p><p id="6b83" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以跑:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="d1bc" class="mt lf it mk b gy mu mv l mw mx">npm i -D babel-plugin-transform-es2015-modules-commonjs</span></pre><p id="8645" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">来安装它。</p><h1 id="8bff" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">组件通信</h1><p id="949b" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们的组件有父子关系，那么我们可以使用道具和事件。</p><p id="ac73" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者我们可以使用事件总线模式。</p><p id="f58f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了使用事件总线模式，我们可以创建一个新的Vue实例，并在其上调用<code class="fe mh mi mj mk b">$emit</code>来发出一个事件。</p><p id="5d69" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以用<code class="fe mh mi mj mk b">$on</code>方法监听发出的事件。</p><p id="1ce9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要创建事件总线，我们只需编写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="8367" class="mt lf it mk b gy mu mv l mw mx">import Vue from 'vue';<br/>export const EventBus = new Vue();</span></pre><p id="cd4b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe mh mi mj mk b">event-bus.js</code>里。</p><p id="fd6a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们可以在任何组件中使用它。</p><p id="04bc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="e247" class="mt lf it mk b gy mu mv l mw mx">import { EventBus } from './event-bus.js';</span><span id="ca3b" class="mt lf it mk b gy my mv l mw mx">// ...</span><span id="353c" class="mt lf it mk b gy my mv l mw mx">methods: {<br/>  emitGlobalClickEvent() {<br/>      EventBus.$emit('message', this.count);<br/>    }<br/>  }<br/>  ...<br/>}</span></pre><p id="b039" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在另一个组件中，我们可以通过编写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="e65a" class="mt lf it mk b gy mu mv l mw mx">import { EventBus } from './event-bus.js';</span><span id="45c8" class="mt lf it mk b gy my mv l mw mx">//...</span><span id="f52f" class="mt lf it mk b gy my mv l mw mx">EventBus.$on('message', count =&gt; {<br/>  //...<br/>});</span></pre><p id="f54c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">count</code>具有<code class="fe mh mi mj mk b">this.count</code>的发射值。</p><p id="eb14" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们在父母和孩子之间交流，那么我们可以从父母和孩子那里传递道具。</p><p id="0501" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="21f1" class="mt lf it mk b gy mu mv l mw mx">&lt;child :myProp='myProp'&gt;&lt;/child&gt;</span></pre><p id="b624" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">my-prop</code>是我们传递给<code class="fe mh mi mj mk b">child</code>的道具。</p><p id="e44c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe mh mi mj mk b">child</code>中，我们可以通过<code class="fe mh mi mj mk b">this.myProp</code>来访问它。</p><p id="4eab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们可以从子进程向父进程发出一个事件。</p><p id="0a4e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="9f9d" class="mt lf it mk b gy mu mv l mw mx">this.$emit('childToParent', data)</span></pre><p id="f0dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在子组件方法中。</p><p id="6eb8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以通过写来听:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="2650" class="mt lf it mk b gy mu mv l mw mx">&lt;child :myProp='myProp' @childToParent='val = $event'&gt;&lt;/child&gt;</span></pre><p id="ce8e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">$event</code>具有我们用<code class="fe mh mi mj mk b">childToParent</code>事件发出的<code class="fe mh mi mj mk b">data</code>的值。</p><p id="1513" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们把值赋给了<code class="fe mh mi mj mk b">val</code>。</p><h1 id="f825" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">生产中的分布式文件夹路径</h1><p id="6658" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以在生产中为我们的Vue应用提供不同的基础路径。</p><p id="a649" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="a75e" class="mt lf it mk b gy mu mv l mw mx">module.exports = {<br/>  publicPath: process.env.NODE_ENV === 'production'<br/>    ? '/path/to/dist/'<br/>    : '/'<br/>}</span></pre><p id="e8fb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe mh mi mj mk b">vue.config.js</code>中，将生产路径设置为<code class="fe mh mi mj mk b">/path/to/dist</code>。</p><p id="f268" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在其他环境中，我们从根为应用提供服务。</p><p id="9fa7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">process.env.NODE_ENV</code>拥有专为其打造的应用环境。</p><h1 id="0fb7" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用v-html的双向数据绑定</h1><p id="d9c7" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">当<code class="fe mh mi mj mk b">contenteditable</code>属性被添加到元素中时，我们可以监听输入事件来更新内容。</p><p id="7757" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="953c" class="mt lf it mk b gy mu mv l mw mx">&lt;div id='app'&gt;<br/>  &lt;div class="input" @input="onInput" @keyup.enter="submit" contenteditable&gt;&lt;/div&gt;<br/>  &lt;div class="output" v-html="msg"&gt;&lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="a504" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的组件代码中，我们写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="8def" class="mt lf it mk b gy mu mv l mw mx">new Vue({<br/>  el: '#app',<br/>  data: {<br/>    msg: ''<br/>  },<br/>  methods: {<br/>    typing(el) {<br/>      this.msg = el.target.innerHTML;<br/>    },<br/>    submit() {<br/>      console.log(this.msg);<br/>    }<br/>  }<br/>});</span></pre><p id="0cdc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将<code class="fe mh mi mj mk b">this.msg</code>设置为元素的<code class="fe mh mi mj mk b">innerHTML</code>属性，以将HTML内容设置为<code class="fe mh mi mj mk b">this.msg</code>。</p><p id="8e88" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以用<code class="fe mh mi mj mk b">v-html</code>按原样显示。</p><h1 id="be7c" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在Vue组件中使用全局变量</h1><p id="df74" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要在组件中使用全局变量，我们可以创建一个计算属性。</p><p id="c754" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="7b62" class="mt lf it mk b gy mu mv l mw mx">window.globalVar = 'global';</span></pre><p id="c8bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在我们的组件对象中，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="c310" class="mt lf it mk b gy mu mv l mw mx">computed: {<br/>  myGlobalVar() {<br/>     return window.globalVar;<br/>  },<br/>},</span></pre><p id="e7cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们获取<code class="fe mh mi mj mk b">globalVar</code>对象并返回它。</p><h1 id="bc01" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">这在Axios回调中未定义</h1><p id="1f80" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们应该为回调使用箭头函数，这样就不会创建新的函数作用域。</p><p id="e06f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们应该写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="c8f9" class="mt lf it mk b gy mu mv l mw mx">.catch((error) =&gt; {<br/>  console.error(error.response);<br/>  if ( error.message === "Network Error" ) {<br/>    this.show = true;<br/>    this.message = 'Please try again later';<br/>  }<br/>});</span></pre><p id="6b92" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">箭头函数不绑定到<code class="fe mh mi mj mk b">this</code>，所以<code class="fe mh mi mj mk b">this</code>将是组件。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/e0664d0ac2b85a8b92704e3ff9f23aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2DBBaNas6HKfGIh8"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@davidclode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> David Clode </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="07fc" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="ae50" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以更改提供构建文件的路径。</p><p id="0a02" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们可以创建计算的属性，并使用<code class="fe mh mi mj mk b">v-for</code>遍历条目。</p></div></div>    
</body>
</html>