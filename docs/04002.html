<html>
<head>
<title>Never Store Secrets in appsettings.json</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">永远不要在appsettings.json中存储机密</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/never-store-secrets-in-appsettings-json-3a7404ea50d0?source=collection_archive---------2-----------------------#2020-06-05">https://levelup.gitconnected.com/never-store-secrets-in-appsettings-json-3a7404ea50d0?source=collection_archive---------2-----------------------#2020-06-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9416" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">太多人误解了这一点。让我们来弥补吧。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bfd43ddbffd80e5ff8e0614448dd5832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2cF9KqowimewyBzrU8giCg.png"/></div></div></figure><p id="be54" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可能以前见过一些安全文盲这样做。</p><p id="6b4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你明白我的意思吗？第4行的秘密将提交给你的代码回购。</p><p id="6c70" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">做这件事的人基本上是ASP.NET核心的新成员。这样的事情为什么会发生，是可以理解的。很简单。它让你的开发体验变得愉快。</p><blockquote class="lq lr ls"><p id="aca4" class="ku kv lt kw b kx ky ju kz la lb jx lc lu le lf lg lv li lj lk lw lm ln lo lp im bi translated">然而，这是一个巨大的安全缺陷。永远不要在源代码中存储敏感数据。</p></blockquote><p id="5d8b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">稍微有经验的开发人员可能会做出<code class="fe lx ly lz ma b">appsettings.Development.json</code>。这并没有更好，除非你真的<code class="fe lx ly lz ma b">.gitignore</code>那个文件。</p><h2 id="cb04" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">隐藏你的秘密！</h2><p id="4290" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">幸运的是，这个问题有一个简单的解决方法。</p><p id="d7ed" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不要创建额外的appsettings . some environment . JSON，而是使用默认的appsettings.json作为应用程序运行所需的模板。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/d6490a9af9de78b0115c123e29cf3b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rope5FRuyw5HZbJ6ezhp1Q.png"/></div></div></figure><p id="7e4b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你看到了吗？第4行，未提供秘密。</p><h2 id="32b7" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">使用dotnet用户机密来保护您的敏感数据的安全</h2><p id="af74" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">好了，现在我们已经把这个问题从我们的文件中删除了。让我们弄清楚如何以安全的方式填充<code class="fe lx ly lz ma b">ConnectionStrings:default</code>。</p><p id="e9bb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在项目位置的终端中，写入<code class="fe lx ly lz ma b">dotnet user-secrets init</code>。UserSecretsId生成并存储在您的。csproj文件。</p><p id="f3b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，就像写<code class="fe lx ly lz ma b">dotnet user-secrets set "ConnectionStrings:default" "my_connectionstring”</code>一样简单</p><p id="9a5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就是这样。您不再错误地在源代码中包含敏感数据。</p><h2 id="69e7" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">你可能会问，生产中要做什么</h2><p id="b3b4" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">在生产中，您需要有一个包含所有敏感数据的appsettings.json或者，您可以将它们作为环境变量添加。</p><p id="5a0c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">更好的方法是使用密钥库，比如Azure KeyVault。很简单。很安全。没有理由不用它。但是设置KeyVault超出了本文的范围。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><pre class="kj kk kl km gt nh ma ni nj aw nk bi"><span id="5698" class="mb mc it ma b gy nl nm l nn no">Resources for the curious</span><span id="738e" class="mb mc it ma b gy np nm l nn no"><a class="ae nq" href="https://docs.microsoft.com/en-us/aspnet/core/security/app-secrets?view=aspnetcore-2.2&amp;tabs=windows" rel="noopener ugc nofollow" target="_blank">Microsoft documentation on Secrets Manager</a></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/351b3fba9bccebfbd7d4b79e8acbdd31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TMZihqPx2zFjYDyIZ5tKTQ.png"/></div></div></figure><div class="ns nt gp gr nu nv"><a href="https://medium.com/swlh/stop-checking-for-nulls-5f9f857ddf72" rel="noopener follow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">停止检查空值</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">空对象模式、工厂方法——让我们看看一些生产就绪代码！</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">medium.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a href="https://medium.com/swlh/dynamic-command-dispatching-in-c-d3abe21b3d1b" rel="noopener follow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">C#中的动态命令调度</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">让我们保持这一个简短和甜蜜</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">medium.com</p></div></div><div class="oe l"><div class="ok l og oh oi oe oj ks nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a href="https://medium.com/@nmillard/brief-overview-of-asp-net-core-authentication-451e630bc42d" rel="noopener follow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">ASP.NET核心认证简介</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">顾问指南aspnetcore身份验证的基本概念。</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">medium.com</p></div></div><div class="oe l"><div class="ol l og oh oi oe oj ks nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a href="https://medium.com/@nmillard/jwt-bearer-authentication-for-machine-to-machine-and-single-page-applications-1c8ba1211a90" rel="noopener follow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">在ASP.NET核心网建立JWT承载认证</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">快速简单的顾问指南</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">medium.com</p></div></div><div class="oe l"><div class="om l og oh oi oe oj ks nv"/></div></div></a></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/f70d5718c17adae23df1d2bf5338905b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MDwPKwBpzfsQJ9xn0ilZNQ.png"/></div></div></figure><p id="5bd9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Nicklas Millard 在丹麦四大咨询公司之一担任高级技术顾问。他主要担任客户项目的首席开发人员和解决方案架构师。</p><p id="5874" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">他一直在为商业客户和政府机构开发软件，如丹麦国防部、教育部、环境和食品部、国家警察局、丹麦劳动力市场和招聘机构以及rstad。</p><blockquote class="lq lr ls"><p id="1415" class="ku kv lt kw b kx ky ju kz la lb jx lc lu le lf lg lv li lj lk lw lm ln lo lp im bi translated">在<a class="ae nq" href="https://www.linkedin.com/in/nicklasmillard/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</p></blockquote></div></div>    
</body>
</html>