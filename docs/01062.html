<html>
<head>
<title>Publishing Typings to DefinitelyTyped</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将类型发布到明确的类型</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/publishing-typings-to-definitelytyped-d4e0777e40f5?source=collection_archive---------5-----------------------#2019-11-01">https://levelup.gitconnected.com/publishing-typings-to-definitelytyped-d4e0777e40f5?source=collection_archive---------5-----------------------#2019-11-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="3e5c" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">介绍</h1><p id="0b45" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Typescript是JavaScript的一大补充。不幸的是，并不是每个JS包都有TypeScript的定义。当然，您可以在您的项目中创建您的自定义定义，但是我相信共享这些定义对于社区来说会更容易:</p><ul class=""><li id="d6df" class="lj lk iq kn b ko ll ks lm kw ln la lo le lp li lq lr ls lt bi translated">一个大的社区维护着共享的类型</li><li id="b96b" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li lq lr ls lt bi translated">审查过程可以提供宝贵的见解</li><li id="8c2d" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li lq lr ls lt bi translated">这个定义有助于传播打字稿语言</li></ul><h1 id="0910" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">出版</h1><p id="f38e" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在开始之前，我假设您遇到了以下情况之一:</p><ul class=""><li id="2cf0" class="lj lk iq kn b ko ll ks lm kw ln la lo le lp li lq lr ls lt bi translated">默认类型和库不包含您要添加的@type</li><li id="ab64" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li lq lr ls lt bi translated">应该更新现有的类型</li><li id="9d36" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li lq lr ls lt bi translated">包提供了它的定义，您应该移除DefinitelyTyped定义</li></ul><h1 id="9c6f" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">准备</h1><ol class=""><li id="b78b" class="lj lk iq kn b ko kp ks kt kw lz la ma le mb li mc lr ls lt bi translated">派生明确类型的存储库</li><li id="c907" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">在本地克隆它，并为您的更改创建一个分支</li></ol><h1 id="1eb2" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">包装定义的实施</h1><p id="734f" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我将流程分为三种类型的活动:添加、更新或删除。</p><h2 id="1db6" class="md jo iq bd jp me mf dn jt mg mh dp jx kw mi mj kb la mk ml kf le mm mn kj mo bi translated"><strong class="ak">添加新包</strong></h2><ol class=""><li id="7bf2" class="lj lk iq kn b ko kp ks kt kw lz la ma le mb li mc lr ls lt bi translated">在<code class="fe mp mq mr ms b">types</code>目录— <code class="fe mp mq mr ms b">types/&lt;name_of_package&gt;</code>中为您要键入的库创建一个文件夹。</li><li id="2776" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">准备文件夹结构。最低要求:<code class="fe mp mq mr ms b">index.d.ts</code>、<code class="fe mp mq mr ms b">&lt;name_of_package&gt;-tests.ts</code>、<code class="fe mp mq mr ms b">tsconfig.json</code>、<code class="fe mp mq mr ms b">tslint.json </code>。你可以从另一个包中复制它们，但是不要忘记更新信息！</li><li id="a6e1" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">调查你想描述的是哪种类型的包装。您可以在这里研究包的类型:<a class="ae mt" href="https://www.typescriptlang.org/docs/handbook/declaration-files/templates.html" rel="noopener ugc nofollow" target="_blank">https://www . typescriptlang . org/docs/handbook/declaration-files/templates . html</a></li><li id="c568" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">从编写测试开始。它们为您的使用类型提供了一些保护。用这种方式描述打字更快，并且检查一切都好。对文件名的要求:<code class="fe mp mq mr ms b">&lt;name of package&gt;-tests.ts</code>。如果您想要提供几个测试文件，请将它们移动到tests文件夹中。</li><li id="5ef3" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">编写定义文件(<code class="fe mp mq mr ms b">index.d.ts</code>)。您可以使用<code class="fe mp mq mr ms b">dts-gen</code>创建草稿类型。</li><li id="ccd1" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">为您的键入添加描述。提供包装的名称和版本供您键入。它应该与<code class="fe mp mq mr ms b">npmjs.com</code>上的包装相匹配。Github上的包链接。列出贡献者。或者，您可以提供一个Typescript版本。</li><li id="187a" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">写入<code class="fe mp mq mr ms b">tslint</code>文件。默认情况下，该文件包含唯一链接到具有林挺规则<code class="fe mp mq mr ms b">dtslint</code> / <code class="fe mp mq mr ms b">dt.json</code>的父文件的链接。你不应该无缘无故地无视默认的林挺规则。</li><li id="7cef" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">写<code class="fe mp mq mr ms b">tsconfig.json</code>。将* ts文件包含到tsconfig的“文件”部分。</li></ol><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mu"><img src="../Images/49fa551dde599bb11edf8d9865309961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0de4AsaBJ2nHE8T2caxPLA.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">index.d.ts文件示例。</figcaption></figure><h2 id="f7bb" class="md jo iq bd jp me mf dn jt mg mh dp jx kw mi mj kb la mk ml kf le mm mn kj mo bi translated"><strong class="ak">编辑现有的包</strong></h2><p id="7ecb" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><em class="nk">非破坏性变化</em></p><ol class=""><li id="da82" class="lj lk iq kn b ko ll ks lm kw ln la lo le lp li mc lr ls lt bi translated">更新定义。检查测试是否涵盖您的软件包使用。如果您的更新提供了新的参数或方法，请添加新的测试。</li><li id="fd2e" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">更新定义。将自己添加为贡献者。如果需要，更新描述中的版本。次要包版本已更新。跳过“补丁”版本。</li></ol><p id="8876" class="pw-post-body-paragraph kl km iq kn b ko ll kq kr ks lm ku kv kw nl ky kz la nm lc ld le nn lg lh li ij bi translated"><em class="nk">突变变化</em></p><ol class=""><li id="288b" class="lj lk iq kn b ko ll ks lm kw ln la lo le lp li mc lr ls lt bi translated">阅读重大变更的说明:<a class="ae mt" href="https://github.com/DefinitelyTyped/DefinitelyTyped#if-a-library-is-updated-to-a-new-major-version-with-breaking-changes-how-should-i-update-its-type-declaration-package" rel="noopener ugc nofollow" target="_blank">(链接)</a></li><li id="1e12" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">为新版本提供测试。</li><li id="4944" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">将旧版本存储在文件夹中。文件夹的名称必须是:<code class="fe mp mq mr ms b">v&lt;its major version number&gt;</code>。</li><li id="b260" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">将该文件夹添加到<code class="fe mp mq mr ms b">tsconfig.json</code>的路径中。</li><li id="6a5f" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">更新定义。将自己添加为贡献者。如果需要，更新描述中的版本。次要包版本已更新。跳过“补丁”版本。</li></ol><h2 id="a22a" class="md jo iq bd jp me mf dn jt mg mh dp jx kw mi mj kb la mk ml kf le mm mn kj mo bi translated"><strong class="ak">移除现有包装:</strong></h2><ol class=""><li id="2b02" class="lj lk iq kn b ko kp ks kt kw lz la ma le mb li mc lr ls lt bi translated">从<code class="fe mp mq mr ms b">./types</code>中删除打字</li><li id="8753" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">将对象添加到根目录中的<code class="fe mp mq mr ms b">notNeededPackages.json</code>。</li><li id="574e" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">模板<a class="ae mt" href="https://github.com/sindresorhus/create-html-element" rel="noopener ugc nofollow" target="_blank">(链接)</a>:</li></ol><pre class="mv mw mx my gt no ms np nq aw nr bi"><span id="0750" class="md jo iq ms b gy ns nt l nu nv">{ <br/>  “libraryName”: “create-html-element”, <br/>  “typingsPackageName”: “create-html-element”, <br/>  “sourceRepoURL”: “sindresorhus/create-html-element”, <br/>  “asOfVersion”: “2.1.0” <br/>}</span></pre><h1 id="34fb" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">提交对DefinitelyTyped的更改</h1><ol class=""><li id="96f5" class="lj lk iq kn b ko kp ks kt kw lz la ma le mb li mc lr ls lt bi translated">提交更改</li><li id="5d5d" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">运行<code class="fe mp mq mr ms b">npm test</code>检查一切正常。</li><li id="c17d" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">用<code class="fe mp mq mr ms b">npm run lint &lt;name of package&gt;</code>检查林挺</li><li id="510c" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">修复错误</li><li id="3e57" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">推动变革</li><li id="8185" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">通过推送提交中的链接进入Github</li><li id="182a" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">创建拉式请求</li><li id="9bc4" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">通过核对表确认一切正常</li><li id="eb4d" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">选中常规复选框，并在适当的部分选中复选框</li><li id="03cf" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">等待审阅者的合并或注释</li></ol><h1 id="a918" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">建议:</h1><ol class=""><li id="6e7a" class="lj lk iq kn b ko kp ks kt kw lz la ma le mb li mc lr ls lt bi translated">@包。DTS-gen无法为子包(即@webpack-block/assets)创建正确的类型。这是一个已知的错误。作为一个解决方案，为父包创建类型，并将所有需要的内容复制到子包的类型中。</li><li id="0b12" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">如果可以的话，重复使用其他类型。</li><li id="3380" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">对于全局类型，您应该避免在测试中“导入”。这样，您可以检查一切工作正常。检查指南:<a class="ae mt" href="https://github.com/DefinitelyTyped/DefinitelyTyped#how-do-i-write-definitions-for-packages-that-can-be-used-globally-and-as-a-module" rel="noopener ugc nofollow" target="_blank">(链接)</a></li><li id="4419" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">Github提供了优秀的工具来处理合并。你可以通过github.com合并简单的冲突。</li></ol><h1 id="19c7" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">指导</h1><ol class=""><li id="4bcd" class="lj lk iq kn b ko kp ks kt kw lz la ma le mb li mc lr ls lt bi translated">最佳实践|明确分类的<a class="ae mt" href="http://definitelytyped.org/guides/best-practices.html" rel="noopener ugc nofollow" target="_blank">(链接)</a></li><li id="f283" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">投稿指南|确定类型<a class="ae mt" href="http://definitelytyped.org/guides/contributing.html" rel="noopener ugc nofollow" target="_blank">(链接)</a></li><li id="f184" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">简介打字稿<a class="ae mt" href="https://www.typescriptlang.org/docs/handbook/declaration-files/introduction.html" rel="noopener ugc nofollow" target="_blank">(链接)</a></li><li id="af26" class="lj lk iq kn b ko lu ks lv kw lw la lx le ly li mc lr ls lt bi translated">确定类型/确定类型<a class="ae mt" href="https://github.com/DefinitelyTyped/DefinitelyTyped" rel="noopener ugc nofollow" target="_blank">(链接)</a></li></ol></div></div>    
</body>
</html>