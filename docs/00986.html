<html>
<head>
<title>Communicate Between Angular Components Using RxJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RxJS在角度组件之间进行通信</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/communicate-between-angular-components-using-rxjs-7221e0468b2?source=collection_archive---------1-----------------------#2019-10-07">https://levelup.gitconnected.com/communicate-between-angular-components-using-rxjs-7221e0468b2?source=collection_archive---------1-----------------------#2019-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="5c64" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">有角的</h2><div class=""/><div class=""><h2 id="1d21" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">关于如何使用RxJS主题和行为主题在角度组件之间进行通信的指南</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/ef963bd62ae11b4ed1f0d82f63c7d170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-s5xe9rcsoXCMJ9f0zgxQ.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">安妮·斯普拉特在<a class="ae lh" href="https://unsplash.com/search/photos/coffee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b0d8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将使用RxJS展示当组件彼此不认识或者不共享直接的父/子关系时，它们是如何通信的。</p><p id="368c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">内容:</p><ol class=""><li id="92c3" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">问题</li><li id="6f19" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">事件总线解决方案</li><li id="aaa5" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">可观察服务解决方案</li><li id="682d" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">个案研究</li></ol><p id="8166" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="ms">更多类似的内容，请查看</em><a class="ae lh" href="https://betterfullstack.com" rel="noopener ugc nofollow" target="_blank">https://betterfullstack.com</a></p><h1 id="d908" class="mt mu it bd mv mw mx my mz na nb nc nd ki ne kj nf kl ng km nh ko ni kp nj nk bi translated">问题</h1><p id="064c" class="pw-post-body-paragraph li lj it lk b ll nl kd ln lo nm kg lq lr nn lt lu lv no lx ly lz np mb mc md im bi translated">在许多前端框架中，包括Angular，当我们将应用程序或页面分成许多小的UI组件并将事件绑定到祖父组件的父组件的父组件时，总会出现通信问题。</p><p id="d935" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在角度中，我们使用<code class="fe nq nr ns nt b">@Output(<strong class="lk jd">)</strong></code>和<code class="fe nq nr ns nt b">@Input()</code>。这在正常情况下工作得很好，但是当我们想要将传入的数据和传出的事件绑定到一个容器组件时，管理起来可能是一场噩梦。</p><p id="b383" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们需要在组件的许多层次上添加许多<code class="fe nq nr ns nt b">@Input()</code>和<code class="fe nq nr ns nt b">@Output()</code>，有时这是行不通的，但这需要更多的努力，而且有风险。</p><p id="206d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一种解决方案是使用状态管理，如<a class="ae lh" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>、<a class="ae lh" href="https://ngrx.io/" rel="noopener ugc nofollow" target="_blank"> NGRX </a>或<a class="ae lh" href="https://www.ngxs.io/" rel="noopener ugc nofollow" target="_blank"> NGXS </a>，以帮助未连接的组件能够进行通信。</p><p id="2d56" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将介绍两个额外的解决方案来处理这个问题，而不需要在代码中引入状态管理库。</p><ol class=""><li id="35f9" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">使用<code class="fe nq nr ns nt b">Subject</code>事件总线。</li><li id="5a6c" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">用<code class="fe nq nr ns nt b">Behavior Subject</code>可观察的服务。</li></ol><p id="40e2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了演示这个解决方案，我将创建<a class="ae lh" href="https://github.com/hoangtranson/sample-communication-subject" rel="noopener ugc nofollow" target="_blank">示例源代码</a>，它允许用户点击文章列表项，并在另一个组件中显示细节。</p><h1 id="7cd3" class="mt mu it bd mv mw mx my mz na nb nc nd ki ne kj nf kl ng km nh ko ni kp nj nk bi translated">事件总线解决方案</h1><p id="1d50" class="pw-post-body-paragraph li lj it lk b ll nl kd ln lo nm kg lq lr nn lt lu lv no lx ly lz np mb mc md im bi translated">事件总线的概念非常简单。您将创建一个全局可达的事件总线服务。</p><p id="3cdd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，您可以向总线发出事件，如果有任何侦听器注册到该事件名称，那么它将执行回调函数。</p><p id="94ff" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将使用<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/rxjs-subjects-explained-with-examples-78ae7b9edfc"> RsJS Subject </a>创建事件总线。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/b67e1608cab9452067aa04a9fa2285d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*VXpl7ib5xWBOdOAlyoC-8A.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">事件总线服务</figcaption></figure><p id="9fcd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在文章列表中，每当用户点击一个条目时，就会发出一个事件，并将文章数据传递给事件总线。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/333067a156a801d30f7f9cb46e613750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LIF-m398j6ba1ZmNrgOvhQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">从文章列表组件发出事件</figcaption></figure><p id="fea4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这段代码意味着我们将事件<code class="fe nq nr ns nt b">SelectArticleDetail</code>与文章信息一起发送。</p><p id="e1da" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，细节组件将监听该事件。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/b908c3a0b63d13f77c627dfdf3efe0be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oaI1u6GiYTs2fOSb8yI59Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">侦听SelectArticleDetail事件</figcaption></figure><p id="4bd4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">监听器将监听<code class="fe nq nr ns nt b">SelectArticleDetail</code> <strong class="lk jd"> </strong>并执行回调，将文章数据赋给一个局部变量并显示在UI上。</p><h1 id="5ba1" class="mt mu it bd mv mw mx my mz na nb nc nd ki ne kj nf kl ng km nh ko ni kp nj nk bi translated">可观察服务解决方案</h1><p id="a875" class="pw-post-body-paragraph li lj it lk b ll nl kd ln lo nm kg lq lr nn lt lu lv no lx ly lz np mb mc md im bi translated">这个想法简单来说就是创建一个清单来传递里面的值。所以每次库存发生变化时，观察者都会知道并执行回调。</p><p id="3e47" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们用名为<code class="fe nq nr ns nt b">inventorySubject$</code>的默认商品值创建了一个<code class="fe nq nr ns nt b">BehaviorSubject</code>，并用方法<code class="fe nq nr ns nt b">addToInventory()</code>将商品添加到库存中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/281d3b1ff9071b122673d8c80e7223dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTMgOwyoJahqFyQIg5NcQA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">将商品添加到库存的可观察服务</figcaption></figure><p id="ea32" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在商品列表中，用户每次点击商品，都会将商品添加到库存中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/8faab35ec2dd37163d663be7bf987aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*QpqP4j3cLRkPhu-UQ7zeqA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">将商品添加到库存</figcaption></figure><p id="018d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，在detail组件中，我们将订阅库存以获取新值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/741bd8e0b106b142d21377582b89ad96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*biXPHWczKKfzzPv078dYjw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">订阅库存更改以获取新值</figcaption></figure><h1 id="9c30" class="mt mu it bd mv mw mx my mz na nb nc nd ki ne kj nf kl ng km nh ko ni kp nj nk bi translated">个案研究</h1><p id="9f6b" class="pw-post-body-paragraph li lj it lk b ll nl kd ln lo nm kg lq lr nn lt lu lv no lx ly lz np mb mc md im bi translated">我已经将这些技术应用到许多项目中，下面是一些我认为有用的真实案例:</p><ol class=""><li id="9934" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">事件总线:我想将相同的模态或弹出窗口分组，以便在用户每次通过UI上的按钮与API交互时通知用户web应用程序的状态。</li><li id="3526" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">事件总线:在mono repo使用不同前端框架的情况下，我使用事件总线在不同框架之间分派事件并监听，或者从Angular分派并监听普通Javascript。</li><li id="3fd0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">嵌套组件的事件总线和可观察服务:当我们要绑定数据或事件进出组件D (UI组件)到C (UI组件)到B (UI组件)和A(容器组件)与API通信时，使用<code class="fe nq nr ns nt b">@Input()</code>和<code class="fe nq nr ns nt b">@Output()</code>会很复杂。</li></ol><p id="548c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你有更多的案例，我会很高兴听到他们。向他人学习是提高的好方法。</p><h1 id="002e" class="mt mu it bd mv mw mx my mz na nb nc nd ki ne kj nf kl ng km nh ko ni kp nj nk bi translated">摘要</h1><p id="0b51" class="pw-post-body-paragraph li lj it lk b ll nl kd ln lo nm kg lq lr nn lt lu lv no lx ly lz np mb mc md im bi translated">总而言之，本文介绍了两种在两个或多个互不了解的组件之间进行通信的方法。</p><p id="50f2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们使用可观察的服务来订阅简单情况下的数据，并使用事件总线将不同的事件名称分派给不同的侦听器。</p><p id="e22c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望这篇文章对你有用！你可以在<a class="ae lh" href="https://medium.com/@transonhoang?source=post_page---------------------------" rel="noopener">媒体</a>上关注我。我也在<a class="ae lh" href="https://twitter.com/transonhoang" rel="noopener ugc nofollow" target="_blank">推特</a>上。欢迎在下面的评论中留下任何问题。我很乐意帮忙！</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><div class="ks kt ku kv gt oh"><a href="https://gitconnected.com/learn/angular" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd jd gy z fp om fr fs on fu fw jc bi translated">学习角度-最佳角度教程(2019) | gitconnected</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">50大角度教程-免费学习角度。课程由开发人员提交和投票，使您能够…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">gitconnected.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov lb oh"/></div></div></a></div><div class="ow ox gp gr oy oh"><a href="https://betterfullstack.com/stories/" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd jd gy z fp om fr fs on fu fw jc bi translated">故事-更好的全栈</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">关于JavaScript、Python和Wordpress的有用文章，有助于开发人员减少开发时间并提高…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">betterfullstack.com</p></div></div><div class="oq l"><div class="oz l os ot ou oq ov lb oh"/></div></div></a></div></div></div>    
</body>
</html>