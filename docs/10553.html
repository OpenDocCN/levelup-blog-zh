<html>
<head>
<title>Generate Chapter Summary for Your Audio and Video Files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的音频和视频文件生成章节摘要</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/generate-chapter-summary-for-your-audio-and-video-files-3270c9311035?source=collection_archive---------20-----------------------#2021-12-19">https://levelup.gitconnected.com/generate-chapter-summary-for-your-audio-and-video-files-3270c9311035?source=collection_archive---------20-----------------------#2021-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f61f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一段时间内音频内容的摘要</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2b475d2a11950f9029db0f16789a84fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kZzZjtnrtSsh21fQp1dpaQ.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@timothyeberly?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">蒂莫西·埃伯利</a>在<a class="ae le" href="https://unsplash.com/s/photos/chapter?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0af8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之前，我已经介绍过如何使用AssemblyAI提供的外部<a class="ae le" href="https://www.assemblyai.com/" rel="noopener ugc nofollow" target="_blank">语音转文本API </a>将音频文件转录为文本。在本教程中，让我们深入探讨另一个称为自动章节的特性，它是转录API的一部分:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="92e0" class="lk ll it lg b gy lm ln l lo lp">https://api.assemblyai.com/v2/transcript</span></pre><p id="427d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">供您参考，它的工作方式如下:</p><ul class=""><li id="a6d8" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">根据谈话的主题将录音分成几个章节</li><li id="cee4" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">为每章生成摘要</li></ul><p id="c831" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请放心，您需要做的就是调用API并传入所需的参数。它将为您处理所有任务，并返回一个JSON结果，该结果可以直接在您的项目中使用。例如，您可以利用此功能为您的YouTube视频生成摘要或描述。</p><p id="d848" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，您将学习实现以下项目:</p><ul class=""><li id="b23f" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">将视频转换成音频文件</li><li id="c822" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">将音频文件上传到服务器</li><li id="308c" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">对脚本API进行POST调用</li><li id="3011" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">通过脚本get调用获取JSON结果</li></ul></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="52b3" class="ml ll it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">设置</h1><p id="e5dd" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">在此之前，请确保您已经创建了一个新的虚拟环境。</p><h2 id="e06f" class="lk ll it bd mm nn no dn mq np nq dp mu kb nr ns my kf nt nu nc kj nv nw ng nx bi translated">Pydub</h2><p id="7690" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">激活它并运行以下命令来安装<code class="fe ny nz oa lg b">pydub</code>包:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="a7dc" class="lk ll it lg b gy lm ln l lo lp">pip install pydub</span></pre><p id="91c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您将使用此包将视频文件导出到录音。</p><h2 id="e5f7" class="lk ll it bd mm nn no dn mq np nq dp mu kb nr ns my kf nt nu nc kj nv nw ng nx bi translated">要求</h2><p id="462f" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">默认情况下，<code class="fe ny nz oa lg b">requests</code>包应该已经安装在基础环境中。如果不是这样，请按如下方式安装:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="3ed9" class="lk ll it lg b gy lm ln l lo lp">pip install requests</span></pre><p id="5550" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您将利用这个包进行HTTP API调用。</p><h2 id="bcc6" class="lk ll it bd mm nn no dn mq np nq dp mu kb nr ns my kf nt nu nc kj nv nw ng nx bi translated">API密钥</h2><p id="09d1" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">注册一个<a class="ae le" href="https://app.assemblyai.com/signup" rel="noopener ugc nofollow" target="_blank">新的免费试用账户</a>，每月有3个小时的转录时间。对于本教程来说应该绰绰有余了。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/0d8c772d8ea12e789c35e3c05694ee9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yfkmmtrnZK8V_jDU"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><p id="24a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在主页的右侧，您应该会看到您的帐户对应的API密钥。记下它，因为我们将在后面的代码中使用它。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="e63d" class="ml ll it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">视频到音频文件</h1><p id="f89c" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">创建一个名为<code class="fe ny nz oa lg b">convert.py</code>的新Python脚本，并添加以下代码:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="c415" class="lk ll it lg b gy lm ln l lo lp">from pydub import AudioSegment</span><span id="7adc" class="lk ll it lg b gy oc ln l lo lp">audio = AudioSegment.from_file("test.mp4", "mp4")<br/>audio.export("test.mp3", format="mp3")</span></pre><p id="c622" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的代码将读取一个名为<code class="fe ny nz oa lg b">test.mp4</code>的视频文件，并将其转换为mp3。事实上，您也可以从不同的文件格式加载:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="1a11" class="lk ll it lg b gy lm ln l lo lp"># audio files<br/>audio = AudioSegment.from_wav("test.wav")<br/>audio = AudioSegment.from_mp3("test.mp3")</span><span id="b308" class="lk ll it lg b gy oc ln l lo lp"># ogg and flv<br/>audio = AudioSegment.from_ogg("test.ogg")<br/>audio = AudioSegment.from_flv("test.flv")</span><span id="2b03" class="lk ll it lg b gy oc ln l lo lp"># other formats<br/>audio = AudioSegment.from_file("test.mp4", "mp4")<br/>audio = AudioSegment.from_file("test.wma", "wma")<br/>audio = AudioSegment.from_file("test.aiff", "aac")</span></pre><p id="b663" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，您可以在加载音频文件时指定通道数和帧速率:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="4185" class="lk ll it lg b gy lm ln l lo lp">audio = AudioSegment.from_file("test.mp4", "mp4").<!-- -->set_channels(1).set_frame_rate(16000)</span></pre><p id="3a86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">保存文件并在终端上运行以下命令:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="0547" class="lk ll it lg b gy lm ln l lo lp">python convert.py</span></pre><p id="5287" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该在当前工作目录中获得一个名为test <code class="fe ny nz oa lg b">test.mp3</code>的新音频文件。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="9809" class="ml ll it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">将文件上传到服务器</h1><p id="a0da" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">如前所述，整个转录过程如下:</p><ul class=""><li id="b50f" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">将本地音频文件上传到服务器以获得可访问的URL</li><li id="1661" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">用<code class="fe ny nz oa lg b">audio_url</code>和<code class="fe ny nz oa lg b">auto_chapters</code>参数调用转录API (POST call)</li><li id="9689" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">调用转录API (GET call)来获得最终的转录结果</li></ul><p id="41ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在同一个目录中，用下面的代码创建一个名为<code class="fe ny nz oa lg b">upload_file.py</code>的新文件:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="03b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该根据自己的用例替换<code class="fe ny nz oa lg b">api_key</code>和<code class="fe ny nz oa lg b">filename</code>变量。</p><p id="2aae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">保存文件并按如下方式运行:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="e986" class="lk ll it lg b gy lm ln l lo lp">python upload_file.py</span></pre><p id="b251" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该得到以下输出，它代表了音频文件的可访问URL:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="cf6f" class="lk ll it lg b gy lm ln l lo lp">{“upload_url”: “https://cdn.assemblyai.com/upload/ccbbbfaf-f319-4455-9556-272d48faaf7f"}</span></pre></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="9f01" class="ml ll it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">对脚本API进行POST调用</h1><p id="dc94" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">让我们创建另一个名为<code class="fe ny nz oa lg b">transcribe.py</code>的文件，它将调用<a class="ae le" href="https://docs.assemblyai.com/api-ref/v2-transcript" rel="noopener ugc nofollow" target="_blank">官方脚本API </a>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="d633" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">记住将<code class="fe ny nz oa lg b">auto_chapters</code>变量设置为<code class="fe ny nz oa lg b">true</code>以启用汇总功能。</p><p id="5fa2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">保存文件并运行以下命令:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="0517" class="lk ll it lg b gy lm ln l lo lp">python transcribe.py</span></pre><p id="1186" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它将返回一个包含许多键的JSON。最重要的键是id和状态</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="95fb" class="lk ll it lg b gy lm ln l lo lp">{"id": "ccbbbfaf-f319–4455–9556–272d48faaf7f", ...<br/>"status": "queued" ...}</span></pre><p id="aa39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您收到的状态是<code class="fe ny nz oa lg b">error</code>，可能是以下原因之一:</p><ul class=""><li id="47a6" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated">不支持的音频文件格式</li><li id="7932" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">音频文件不包含音频数据</li><li id="2bc6" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">音频文件太短(&lt; 200毫秒)</li><li id="b986" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">无法访问音频文件的URL</li><li id="384f" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated">API端的错误</li></ul></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="bc70" class="ml ll it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">通过抄本获取调用获取结果</h1><p id="22b6" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">最后一步是对脚本API进行GET HTTP调用。根据音频文件的长度，转录可能需要10分钟。创建一个名为<code class="fe ny nz oa lg b">transcribe_file.py</code>的新Python文件，并在其中添加以下代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="8156" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">记住相应地更换<code class="fe ny nz oa lg b">api_key</code>和<code class="fe ny nz oa lg b">id</code>变量。在您的终端上运行以下命令:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="5607" class="lk ll it lg b gy lm ln l lo lp">python transcribe_file.py</span></pre><p id="3351" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">API将返回一个JSON响应，其中包含相当多的键值对。章节关键字代表包含以下项目的字典列表:</p><ul class=""><li id="f948" class="lq lr it js b jt ju jx jy kb ls kf lt kj lu kn lv lw lx ly bi translated"><code class="fe ny nz oa lg b">summary</code> —简要描述，代表录音中某一章节的概要</li><li id="5ee1" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated"><code class="fe ny nz oa lg b">headline</code> —与摘要相对应的标题。你可以把它看作是总结的总结</li><li id="5ff8" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated"><code class="fe ny nz oa lg b">start</code> —特定章节的开始时间戳</li><li id="82d3" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn lv lw lx ly bi translated"><code class="fe ny nz oa lg b">end</code> —特定章节的结束时间戳</li></ul><p id="7b40" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看看下面的输出示例作为参考:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="1f40" class="lk ll it lg b gy lm ln l lo lp">chapters: [<br/>    {<br/>        "start": 0,<br/>        "end": 20000,<br/>        "summary": "The American job plan is going to create millions of good paying jobs.  jobs created in an American jobs plan do not require a College degree. 75% don't require an associate's degree.",<br/>        "headline": "The American job plan is going to create millions of good paying jobs.",<br/>    }<br/>    ...<br/>]</span></pre></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="18ad" class="ml ll it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">结论</h1><p id="2fcd" class="pw-post-body-paragraph jq jr it js b jt ni jv jw jx nj jz ka kb nk kd ke kf nl kh ki kj nm kl km kn im bi translated">让我们回顾一下你今天所学的内容。</p><p id="9bf8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文首先简要介绍了AssemblyAI的语音转文本API的自动章节功能。接下来通过<code class="fe ny nz oa lg b">pip install</code>安装必要的Python包。</p><p id="1478" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，它介绍了如何将视频文件转换成音频文件。随后，在调用脚本API之前，文件被上传到服务器。它将返回一个可以在您的项目中使用的JSON结果。</p><p id="3bca" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢你阅读这篇文章。祝你有美好的一天！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="9b2b" class="ml ll it bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">参考</h1><ol class=""><li id="90cb" class="lq lr it js b jt ni jx nj kb of kf og kj oh kn oi lw lx ly bi translated"><a class="ae le" href="https://www.assemblyai.com/blog/introducing-assemblyai-auto-chapters-summarize-audio-and-video-files/" rel="noopener ugc nofollow" target="_blank">介绍汽车章节—总结音频和视频文件</a></li><li id="aec6" class="lq lr it js b jt lz jx ma kb mb kf mc kj md kn oi lw lx ly bi translated"><a class="ae le" href="https://docs.assemblyai.com/guides/auto-chapters" rel="noopener ugc nofollow" target="_blank">汽车章节—文档</a></li></ol></div></div>    
</body>
</html>