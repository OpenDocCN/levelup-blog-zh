<html>
<head>
<title>Step-by-Step Guide to Updating Your npm Dependencies with Yarn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Yarn更新npm依赖关系的分步指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/step-by-step-guide-to-updating-your-npm-dependencies-with-yarn-115dc7f5e4b7?source=collection_archive---------4-----------------------#2021-05-11">https://levelup.gitconnected.com/step-by-step-guide-to-updating-your-npm-dependencies-with-yarn-115dc7f5e4b7?source=collection_archive---------4-----------------------#2021-05-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1bc13025c8d092dc0c70a574ed4c326e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yZ9CV4qbrdgeqstM"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">菲利普·埃斯特拉达在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="da0a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于您维护的任何活动代码库，保持您的依赖关系最新是至关重要的。通过保持最新，您可以访问您使用的每个第三方软件包中的所有最新功能和错误修复。提前更新到一个主要版本(如从v2到v3)也比提前更新到几个版本(如从v2到v7)容易得多。掌握依赖项更新有助于避免同时处理几个重大变更的混乱局面。</p><p id="beb7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我倾向于每两周更新一次我所拥有的项目中的依赖项，也就是每个sprint更新一次。这看起来像是花了很多时间来更新依赖项，但事实是，如果你勤于掌控一切，这根本不需要很长时间。15-30分钟是你需要的全部时间。</p><p id="6fd9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是我使用的过程。这对你来说应该也不错。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="579f" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第一步</h1><p id="2991" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在您的终端中运行<code class="fe mo mp mq mr b">yarn upgrade-interactive --latest</code>。这将打开一个交互式CLI，允许您挑选此时要更新的软件包。选择所有次要版本和补丁版本更新，然后按回车键。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="f18e" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第二步</h1><p id="9945" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">再次在您的终端中运行<code class="fe mo mp mq mr b">yarn upgrade-interactive --latest</code>。这一次，选择你想要解决的任何主要版本更新。根据定义，主要版本意味着重大的变化，比如删除了代码可能正在使用的特性或API。这意味着您应该访问该包的GitHub repo，查看changelog或发行说明，然后根据需要更新您的代码。有时你可能很幸运，发现这个突破性的改变并不适用于你正在使用的任何功能，所以不需要额外的工作。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="e77c" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第三步</h1><p id="e4fe" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在您的终端中运行<code class="fe mo mp mq mr b">yarn outdated</code>，查看所有剩余的过期依赖项。为什么？因为有时<code class="fe mo mp mq mr b">yarn upgrade-interactive</code>不能正确处理更新，你必须自己手动更新。</p><p id="1c9d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，<code class="fe mo mp mq mr b">yarn upgrade-interactive</code>无法升级不在<a class="ae kf" href="https://github.com/lerna/lerna/issues/2477" rel="noopener ugc nofollow" target="_blank"> Lerna monorepo </a>内的根级<code class="fe mo mp mq mr b">package.json</code>文件中的依赖项。</p><p id="d52d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您使用<code class="fe mo mp mq mr b">package.json</code>文件中的<code class="fe mo mp mq mr b">resolutions</code>字段来使用任何给定包的特定版本，这个命令也不能正常工作。<a class="ae kf" href="https://github.com/yarnpkg/yarn/issues/5413" rel="noopener ugc nofollow" target="_blank">命令会无声的失败</a>并且不会更新包版本或者解析版本。</p><p id="c7a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，相反，您必须手动更改在<code class="fe mo mp mq mr b">package.json</code>文件中为您想要更新的任何剩余依赖项指定的版本，然后运行<code class="fe mo mp mq mr b">yarn install</code>来安装这些新版本。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="cc19" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第四步</h1><p id="21e3" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">既然您已经更新了您想要的所有依赖项，那么是时候验证您的代码库中的所有内容是否仍然正常工作了。如果您的repo中没有格式化程序、linters或测试，祝您好运！您将依靠对您的应用程序进行手动抽查来检查回归情况。</p><p id="9969" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您已经安装了有用的工具，现在是运行格式化程序、linters和测试的时候了。我用<a class="ae kf" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank">更漂亮的</a>进行格式化，用<a class="ae kf" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> ESLint </a>进行林挺，用<a class="ae kf" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>进行单元测试。如果发现任何错误，请继续解决这些问题。</p><p id="e1c1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意:虽然我把这个检查留在了步骤4中，但是您可能会发现在步骤1和2之后运行这些检查也很有用。这取决于你。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="262a" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第五步</h1><p id="b145" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">添加、提交和推送您的代码。审查并合并您的合并请求，然后您就可以开始了！</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="c847" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="2001" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">就是这样！我已经遵循这个过程很多年了，结果令人惊讶。不再陷入阻碍开发工作的旧版本的依赖关系中。只要花一点时间维护你的回购协议，你就可以把剩下的时间花在开发令人惊叹的新功能上。</p></div></div>    
</body>
</html>