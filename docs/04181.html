<html>
<head>
<title>Scraping websites for phone numbers and emails with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python抓取网站上的电话号码和电子邮件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/scraping-websites-for-phone-numbers-and-emails-with-python-5557fcfa1596?source=collection_archive---------2-----------------------#2020-06-13">https://levelup.gitconnected.com/scraping-websites-for-phone-numbers-and-emails-with-python-5557fcfa1596?source=collection_archive---------2-----------------------#2020-06-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3336" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据收集</h2><div class=""/><div class=""><h2 id="2a71" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated"><a class="ae kr" href="https://github.com/enjoys-sashimi/contact-scraper" rel="noopener ugc nofollow" target="_blank">轻量级工具</a>用于抓取、验证电子邮件和电话号码。</h2></div><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/47642d6b4e20b141c1b9408137b1d45d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L5mAY80-Y4iNX2Y6"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">照片由<a class="ae kr" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae kr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><p id="74b1" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">让我们直接开始吧。</p><p id="a6ae" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">首先确定你有Python 3，如果没有，<a class="ae kr" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">安装Python 3 </a>。</p><p id="7a21" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">与所有python项目一样，最好在虚拟环境中运行它们。如果您已经知道如何设置虚拟环境，请随意跳过前面的步骤。</p><ol class=""><li id="c7fe" class="ml mm it lr b ls lt lv lw ly mn mc mo mg mp mk mq mr ms mt bi translated">导航到您希望此项目驻留的父文件夹。</li></ol><blockquote class="mu mv mw"><p id="a393" class="lp lq mx lr b ls lt kd lu lv lw kg lx my lz ma mb mz md me mf na mh mi mj mk im bi translated">c:\项目</p></blockquote><p id="7a4c" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">2.打开cmd提示符并执行此脚本来创建一个新的虚拟环境。</p><pre class="kt ku kv kw gt nb nc nd ne aw nf bi"><span id="cf7f" class="ng nh it nc b gy ni nj l nk nl">py -m venv contact-scraper-venv</span></pre><ul class=""><li id="95d4" class="ml mm it lr b ls lt lv lw ly mn mc mo mg mp mk nm mr ms mt bi translated"><strong class="lr jd"> <em class="mx">注意:</em> </strong>如果您在Linux或MacOS上，该命令会有所不同，请参见关于<a class="ae kr" href="https://docs.python.org/3/library/venv.html" rel="noopener ugc nofollow" target="_blank">创建虚拟环境</a>的文档。</li></ul><p id="5929" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">3.如果您遵循我的命名约定，请导航到脚本目录，该目录位于:</p><pre class="kt ku kv kw gt nb nc nd ne aw nf bi"><span id="ad3b" class="ng nh it nc b gy ni nj l nk nl">C:\Projects\contact-scraper-venv\Scripts</span></pre><p id="12fe" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">4.一旦进入正确的目录，安装<a class="ae kr" href="https://github.com/enjoys-sashimi/contact-scraper" rel="noopener ugc nofollow" target="_blank">接触刮刀</a>。回购上有安装说明，但我会在这里添加。逐一执行以下命令。</p><pre class="kt ku kv kw gt nb nc nd ne aw nf bi"><span id="25d3" class="ng nh it nc b gy ni nj l nk nl">git clone git@github.com:enjoys-sashimi/contact-scraper.git<br/>cd contact-scraper<br/>pip install -r requirements.txt</span></pre><p id="f8c4" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">恭喜你。您已经设置好了，现在让我们修改当前目录中的example.py来进行抓取。</p><p id="acb5" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">本节将抓取一个域列表，并将结果JSON对象写入output.json。</p><pre class="kt ku kv kw gt nb nc nd ne aw nf bi"><span id="e6dc" class="ng nh it nc b gy ni nj l nk nl">from contactscraper.controller import Controller<br/><br/>instance = Controller(starting_urls=['https://www.python.org/'], <br/>                       scrape_numbers=True,<br/>                       scrape_emails=True,<br/>                       region="US",<br/>                       max_results=2)<br/><br/>instance.scrape()</span></pre><p id="7ed4" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">控制器接受几个参数，让我们看看它们各自的功能。</p><ul class=""><li id="b28a" class="ml mm it lr b ls lt lv lw ly mn mc mo mg mp mk nm mr ms mt bi translated">starting_urls:是你想开始递归抓取的URL列表。蜘蛛将被部署在每个网址上，它不会偏离到任何不包含根网址的链接。例如，传入<code class="fe nn no np nc b">['https://www.python.org/privacy/']</code>将允许抓取任何根域为<code class="fe nn no np nc b">python.org</code>的URL。</li><li id="d500" class="ml mm it lr b ls nq lv nr ly ns mc nt mg nu mk nm mr ms mt bi translated">scrape_numbers &amp; scrape_email:布尔型，分别描述您是否想要抓取电子邮件或电话号码。</li><li id="7f8a" class="ml mm it lr b ls nq lv nr ly ns mc nt mg nu mk nm mr ms mt bi translated">地区:用于验证电话号码的地区，大多数北美号码使用美国地区，但是，我们支持<a class="ae kr" href="https://github.com/daviddrysdale/python-phonenumbers/tree/dev/python/phonenumbers/shortdata" rel="noopener ugc nofollow" target="_blank">所有这些两位数字的地区代码</a>。</li><li id="eecf" class="ml mm it lr b ls nq lv nr ly ns mc nt mg nu mk nm mr ms mt bi translated">max_results:一个整数，表示在关闭之前应该存储的唯一结果的最大数量。唯一结果的特征在于包含一个或多个电子邮件或一个或多个电话号码的唯一URL。</li></ul><p id="f25e" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">完成修改后，继续运行example.py:</p><pre class="kt ku kv kw gt nb nc nd ne aw nf bi"><span id="ec86" class="ng nh it nc b gy ni nj l nk nl">C:\Projects\contact-scraper-venv\Scripts&gt; example.py</span></pre><p id="1960" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">很好，现在您已经找到了一个联系信息网站，让我们打印出存储在<code class="fe nn no np nc b">output.json</code>中的结果:</p><pre class="kt ku kv kw gt nb nc nd ne aw nf bi"><span id="c0c8" class="ng nh it nc b gy ni nj l nk nl">import json<br/><br/>with open('output.json', 'r') as raw_output:<br/>    data = raw_output.read()<br/>    output = json.loads(data)<br/><br/>print(json.dumps(output, indent=2))</span></pre><p id="85c4" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果您按照本指南进行测试，您应该会看到以下结果:</p><pre class="kt ku kv kw gt nb nc nd ne aw nf bi"><span id="68d9" class="ng nh it nc b gy ni nj l nk nl">[<br/>  {<br/>    "url": "https://www.python.org/privacy/",<br/>    "emails": [<br/>      "psf@python.org"<br/>    ],<br/>    "numbers": []<br/>  },<br/>  {<br/>    "url": "https://status.python.org/",<br/>    "emails": [],<br/>    "numbers": [<br/>      "+16505551234"<br/>    ]<br/>  }<br/> ]</span></pre><p id="50d8" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果你想投稿、提出改进建议或报告错误，你可以在<a class="ae kr" href="https://github.com/enjoys-sashimi/contact-scraper" rel="noopener ugc nofollow" target="_blank"> github repo </a>上这样做。</p></div></div>    
</body>
</html>