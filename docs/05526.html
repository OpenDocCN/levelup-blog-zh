<html>
<head>
<title>Add Dynamic Forms to your Vue App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向您的Vue应用添加动态表单</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/add-dynamic-forms-to-your-vue-app-609de4005a2b?source=collection_archive---------3-----------------------#2020-09-07">https://levelup.gitconnected.com/add-dynamic-forms-to-your-vue-app-609de4005a2b?source=collection_archive---------3-----------------------#2020-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2460" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">定义一次表单域，作为模式，并在任何地方呈现它们！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/a16b236bd16b89063554e069220e048d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nM6p_SCZ9quhRbyj"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">马库斯·斯皮斯克在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="0b6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呈现应用程序中的所有表单需要多少代码？您是否发现自己在多个表单中添加了相同的字段？根据表单改变UI框架对你来说有多难？</p><p id="b725" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些只是我决定花些时间为我的项目设计动态表单的一些原因。</p><p id="e59b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有许多软件包可以提供动态表单；然而，我无法找到一个满足我的需要。</p><h1 id="a367" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">问题</h1><p id="4364" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我现在已经使用<a class="ae lb" href="https://vuejs.org" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>和<a class="ae lb" href="https://quasar.dev" rel="noopener ugc nofollow" target="_blank">类星体框架</a>大约6个月了。我喜欢Quasar Framework，因为它提供了我需要的所有UI组件，它给了我一次编写代码并将其构建为web、桌面和/或移动应用程序的选项。我非常喜欢这个平台。😍</p><p id="a3dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我目前正在做一个相当大的项目，在这个项目中，我管理许多类型的集合(例如，用户、项目、任务等)。).我有几个表格来列出、创建、更新和删除不同的收藏项目。过了一段时间，我开始发现许多重复的代码。我发现重复的一个领域是我的表单及其组件。如果我想让一个表单添加一个用户，我会构建它并包含所有必要的UI组件。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="0a18" class="mk ld iq mg b gy ml mm l mn mo">&lt;q-form&gt;<br/>  &lt;q-input color='primary' label='First Name' v-model='fname' ... /&gt;<br/>  &lt;q-input color='primary' label='Last Name' v-model='lname' ... /&gt;&lt;/q-form&gt;</span></pre><p id="c0a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的小例子是构建一个表单来收集这个集合的名字和姓氏(假设它是一个“医生”的集合)。</p><p id="3877" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我需要一个表格来添加护士。我需要另一张表格来添加管理人员。等等。我最终得到了多个表单，所有表单都定义了名和姓字段。</p><p id="c775" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">过去，我会创建组件模板。我称它们为“模板”，因为当我导入它们时，我通过props提供它们的配置。这里有一个简单的例子来说明我的意思:</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="c2ec" class="mk ld iq mg b gy ml mm l mn mo">&lt;!-- components/MyInput.vue --&gt;<br/>&lt;template&gt;<br/>  &lt;q-input :class="class" :color="color" :label="label" :value="model" /&gt;<br/>&lt;/template&gt;</span><span id="e63a" class="mk ld iq mg b gy mp mm l mn mo">&lt;script&gt;<br/>export default {<br/>  props: ['class', 'color', 'label', 'value']<br/>}<br/>&lt;/script&gt;</span></pre><p id="e1dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我上面的表单看起来应该是这样的:</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="5bad" class="mk ld iq mg b gy ml mm l mn mo">&lt;q-form&gt;<br/>  &lt;my-input color='primary' label='First Name' value='fname' ... /&gt;<br/>  &lt;my-input color='primary' label='Last Name' value='lname' ... /&gt;&lt;/q-form&gt;</span></pre><p id="cc46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法真的没什么好处。事实上，我最终要支持比以前更多的代码行。</p><blockquote class="mq mr ms"><p id="73ec" class="jn jo mt jp b jq jr js jt ju jv jw jx mu jz ka kb mv kd ke kf mw kh ki kj kk ij bi translated">模板有一个用例。例如，当你在一个大型团队中，你想确保每个人都使用相同的组件。在这种情况下，您不会为这些组件公开太多选项，因为您有意希望它们的外观和行为总是相同的。</p></blockquote><p id="bf15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个过于简单的例子，但足以说明我的观点。如果我想填充class之外的属性(仅Quasar的<em class="mt"> QInput </em>组件就提供了几十个属性)，该怎么办？我必须将该属性添加到我的模板和道具中。</p><blockquote class="mq mr ms"><p id="bf3d" class="jn jo mt jp b jq jr js jt ju jv jw jx mu jz ka kb mv kd ke kf mw kh ki kj kk ij bi translated">另外，这也是为什么组织使用像<em class="iq">故事书</em>这样的工具。他们需要一种方法来记录他们的组件和他们暴露的所有道具。</p></blockquote><p id="d612" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在变好之前会变得更糟。我的输入组件模板很简单。为了演示另一个极端，这里有一个使用类星体框架组件的例子，<em class="mt"> QDate </em>。你<em class="mt">可以</em>单独使用这个组件，但是通常你会想把它和一个<em class="mt"> QInput </em>组件的弹出窗口一起使用。下面是Quasar文档，展示了如何定义这样一个组件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mx"><img src="../Images/5ce488854f1d8199dcc87a18580d6338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RHb8fKjcKo1TmbP6wwxb2A.png"/></div></div></figure><p id="6a5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除去外部的<code class="fe my mz na mg b">template</code>和<code class="fe my mz na mg b">div</code>元素，创建这个日期字段需要7个嵌套组件。要使它成为一个“模板化”的组件，需要为这个嵌套中的每个组件提供道具。我没有数过，但是这可以很容易地产生超过100个道具来支持所有可能的配置组合！</p><p id="024f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不想再管理组件模板了。我希望有一个模式定义，可以完全呈现我的组件，支持任何UI组件及其所有属性。</p><h1 id="8c08" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">研究</h1><p id="dd1a" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在我的研究中，我遇到了<a class="ae lb" href="https://vuejs.org/v2/guide/render-function.html" rel="noopener ugc nofollow" target="_blank"> Vue如何渲染</a>UI，以及作为一名开发人员，你如何在你的代码中使用相同的渲染功能。事实上，<code class="fe my mz na mg b">template</code>里面的一切都是这样在幕后渲染的。开始时，呈现语法可能有点难以理解。这里有一个小例子:</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="38cf" class="mk ld iq mg b gy ml mm l mn mo">&lt;script&gt;<br/>export default {<br/>  render(h) {<br/>    h('q-input', {<br/>      class: ['text-body1'],<br/>      props: {<br/>        color: 'primary',<br/>        label: 'First Name',<br/>        value: 'fname',<br/>      }<br/>    })<br/>  }<br/>}<br/>&lt;/script&gt;<br/></span></pre><blockquote class="mq mr ms"><p id="58d3" class="jn jo mt jp b jq jr js jt ju jv jw jx mu jz ka kb mv kd ke kf mw kh ki kj kk ij bi translated">注意:我特意省略了这个Vue组件的<code class="fe my mz na mg b">template</code>部分，因为它不能出现在文件中，所以渲染函数不能优先。我是吃了苦头才知道的！😵</p></blockquote><p id="34ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是“原始的”Vue渲染代码，使用Quasar Framework的<em class="mt"> QInput </em>组件来呈现我的名字字段。</p><p id="563c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我之前的嵌套例子呢？这也包含在渲染函数中！它不在上面的例子中，但是稍后你会看到每个渲染的组件都有一个可选的<code class="fe my mz na mg b">children</code>参数。你能有多少孩子深度是没有限制的。从Vue文档中，这里是渲染组件的实际语法。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="b8a0" class="mk ld iq mg b gy ml mm l mn mo">// @returns {VNode} <br/>createElement(   <br/>  // {String | Object | Function}   <br/>  // An HTML tag name, component options, or async   <br/>  // function resolving to one of these. Required.   <br/>  'div',</span><span id="c51a" class="mk ld iq mg b gy mp mm l mn mo">  // {Object}   <br/>  // A data object corresponding to the attributes   <br/>  // you would use in a template. Optional.   <br/>  {     <br/>    // (see details in the next section below)   <br/>  },    </span><span id="5a32" class="mk ld iq mg b gy mp mm l mn mo">  // {String | Array}   <br/>  // Children VNodes, built using `createElement()`,   <br/>  // or using strings to get 'text VNodes'. Optional.   <br/>  [     <br/>    'Some text comes first.',     <br/>    createElement('h1', 'A headline'),<br/>    createElement(MyComponent, {<br/>      props: {<br/>        someProp: 'foobar'<br/>      }<br/>    })<br/>  ]<br/>)</span></pre><h1 id="ff0a" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">原型</h1><p id="16ca" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">原型令人沮丧，但建造起来很有趣。让我们来看一个场景。</p><p id="fcbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当用户点击添加按钮时，我们知道他们的意图(“添加”)和上下文(例如，“医生”)。我们加载我们的<em class="mt">表单</em>组件。表单组件收集该上下文的模式。然后，<em class="mt">表单</em>组件使用一个<em class="mt">字段</em>组件，该组件根据提供的模式呈现字段UI。轻松点。😆</p><p id="95aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">倒过来看，这是我的原型。我们将从示例字段模式定义开始。</p><p id="1db4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mt"> fieldSchema.js </em></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="3508" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个特定的模式只定义了四个字段:姓名、生日、性别和手机号码。name组件是最简单的，因为它不包含子组件。生日组件是最复杂的，因为它处理八个嵌套组件。</p><p id="0a5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管这个文件可能会变得非常大，但我们只为整个应用程序定义了一次表单字段(如果我们选择在其他地方重用它，还包括所有其他项目)。</p><p id="8d31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模式包括UI组件定义的所有方面(组件名称、样式、属性、类、属性等)。).现在我正在使用类星体框架组件。如果我开始另一个需要另一个框架的项目，我只需修改这个文件，它就实现了(至少对于所有的表单域)。</p><p id="a5f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来让我们看看表单模式定义。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="0ee2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表单模式的目的是将我们需要的表单域映射到当前上下文。在这种情况下，上下文是集合和事件的组合。换句话说，如果我创建一个表单来添加用户，那么根据这个文件，我将有一个包含字段的表单:姓名、生日和性别。</p><p id="6c2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于spread操作符，实现继承也非常简单。如果我的上下文是添加一个人，那么呈现的字段将是姓名、出生日期、性别和手机号码。这可以形成非常有效的模式定义。</p><p id="9ae3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来是原型的工作马，字段呈现组件。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="4b71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的每个字段模式定义都作为<code class="fe my mz na mg b">field</code> prop传递到这个组件中。从这个模式中，组件被完整地呈现出来。</p><p id="fa59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有任何硬编码来呈现任何组件，不管它有多复杂。</p><p id="6313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个实现还支持每个组件和嵌套组件的所有可能的配置。</p><p id="7320" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让这件事过去一分钟。没有硬编码。所有属性，道具，职业等。，支持。</p><p id="63f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，让我们看看表单组件。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="4bec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表单组件是我们出色解决方案的指挥者。这是我们的应用程序中唯一需要的表单组件。它确定上下文(借助Vue路由器和一些简单的mixins来减少代码)，收集字段模式，呈现这些字段，并向用户返回一个完全呈现的表单。</p><h1 id="d0de" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="a984" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我想这对你们中的许多人来说是很难消化的。我建议你玩玩这个概念，充分掌握这种东西提供的灵活性。我希望它能大大减少我的开发时间，同时降低故障排除的复杂性。</p><p id="0993" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据这个解决方案，向表单添加新字段需要做什么？假设我们想要跟踪我们的个人上下文的电子邮件地址。</p><ol class=""><li id="1dc4" class="nd ne iq jp b jq jr ju jv jy nf kc ng kg nh kk ni nj nk nl bi translated">因为我们没有在字段模式中定义电子邮件地址，所以让我们从向模式对象的根添加一个新键开始。</li></ol><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="cff8" class="mk ld iq mg b gy ml mm l mn mo">{<br/>  ...</span><span id="226d" class="mk ld iq mg b gy mp mm l mn mo">  email: {<br/>    component: 'q-input',<br/>    label: 'Email Address',<br/>    model: 'email',<br/>    fieldOptions: {<br/>      class: [],<br/>      on: { input: true },<br/>      attrs: {<br/>        placeholder: 'Enter your email address',<br/>      },<br/>      props: {<br/>        filled: true,<br/>        rules: [<br/>          val =&gt; !!val || 'Field is required',<br/>          val =&gt; &lt;enter email validation regex&gt; || 'Must be valid <br/>              email address',<br/>        ],<br/>      },<br/>      style: {<br/>        width: '200px',<br/>      },<br/>    },<br/>  }<br/>  ...<br/>}</span></pre><p id="eb31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.然后我们需要将该字段添加到我们的add <code class="fe my mz na mg b">person</code>上下文中。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="5116" class="mk ld iq mg b gy ml mm l mn mo">export const person = {<br/>   ...users,<br/>   add: {<br/>      ...users.add,<br/>      mobile: {},<br/>+     email: {},<br/>   },<br/>   update: {<br/>      ...users.update,<br/>      mobile: {},<br/>+     email: {},<br/>    },<br/>}</span></pre><p id="0d85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！下次我们的add person表单显示我们的电子邮件地址字段时，将会呈现它，包括它的模型、组件、样式、验证等。</p><p id="364d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个实现有几个方面我没有介绍。如果有人对我深入研究这个实现感兴趣，请不要犹豫。</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="e32e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">特洛伊·莫兰的更多文章</p><div class="nv nw gp gr nx ny"><a href="https://graypes.medium.com" rel="noopener follow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">特洛伊·莫兰-中等</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">你在用Vue，Vuex，云Firestore吗？即使你不使用Firestore，你仍然应该阅读这篇文章，因为…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">graypes.medium.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om kv ny"/></div></div></a></div></div></div>    
</body>
</html>