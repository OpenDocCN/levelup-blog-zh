<html>
<head>
<title>What is Apache Zookeeper?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是阿帕奇动物园管理员？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-apache-zookeeper-540cdff6d45f?source=collection_archive---------2-----------------------#2021-10-23">https://levelup.gitconnected.com/what-is-apache-zookeeper-540cdff6d45f?source=collection_archive---------2-----------------------#2021-10-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="abaf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Apache Zookeeper简介，其背后的关键概念和用例</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ebe4210b095bf01994971cd40c93cd24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LZ9JGUoyOy4TwYjQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kr"><img src="../Images/d5acb06b568f69028ae7bb32cdf55f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/0*rARbzcjNPGxB_s7F.png"/></div></figure><blockquote class="ks"><p id="516b" class="kt ku iq bd kv kw kx ky kz la lb lc dk translated">Apache ZooKeeper致力于开发和维护一个开放源码服务器，它支持高度可靠的分布式协作。</p></blockquote><p id="8cf5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx lc ij bi translated">很久以后，我将在我的博客中加入我的一段经历，在这段经历中，我开始从事一些分布式计算的工作。这是我第一次使用分布式系统，并用Apache Zookeeper完成上个月做的一些有趣的任务。所以我想在Zookeeper上做一些挖掘，并认为这将对我和开始使用Apache Zookeeper的人有益，以某种记录的方式做出这些发现。</p><h1 id="6c40" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">介绍</h1><p id="001b" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">首先，我们简单看一下什么是动物园管理员。ZooKeeper是一个为分布式环境中的大量主机提供协调和管理的服务。ZooKeeper通过其简单的架构和API来完成这项任务。为了正确理解Apache Zookeeper的角色，最好对分布式应用程序有一些了解。</p><h2 id="a48f" class="mv lz iq bd ma mw mx dn me my mz dp mi lm na nb mk lq nc nd mm lu ne nf mo ng bi translated">什么是分布式应用？</h2><p id="6905" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">分布式应用程序是一种可以在网络中的多个系统上运行的应用程序，它通过在这些系统之间进行协调，以快速有效的方式完成一项任务。运行分布式应用程序的一组系统称为<strong class="lf ir">集群</strong>，集群中运行的每台机器称为<strong class="lf ir">节点</strong>。</p><p id="ae99" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated">一个分布式应用有两个部分，<strong class="lf ir">服务器</strong>和<strong class="lf ir">客户端</strong>。服务器应用程序有一个公共接口，这样客户端可以连接到集群中的任何服务器，并获得相同的结果。客户端应用程序是与分布式应用程序交互的工具。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/b5e63e3dca9b3e343725428f77c4970e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sUbTtb6Ybly2zPhc"/></div></div></figure><p id="0ce6" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated">分布式系统是<strong class="lf ir">可靠的</strong>，<strong class="lf ir">可扩展的</strong>并且隐藏了系统的复杂性，作为一个单一的实体(<strong class="lf ir">透明性)</strong>。分布式应用也有一些挑战。需要处理<strong class="lf ir">竞争情况</strong>两台或多台机器试图执行一项特定任务，而实际上在任何给定时间都只需要一台机器来完成。<strong class="lf ir">死锁</strong>是<strong class="lf ir"> </strong>在两个或多个操作无限期等待对方完成的情况下也是可能的。<strong class="lf ir">不一致</strong>是应该处理数据的局部失效的地方。</p><h2 id="1202" class="mv lz iq bd ma mw mx dn me my mz dp mi lm na nb mk lq nc nd mm lu ne nf mo ng bi translated">动物园管理员的角色</h2><p id="8bae" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">在这种情况下，Apache ZooKeeper是集群使用的一种服务，用于在集群之间进行协调，并使用健壮的同步技术维护共享数据。</p><h1 id="bf34" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">体系结构</h1><p id="d1f7" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">接下来，我们来讨论一下Zookeeper的<strong class="lf ir">客户端-服务器架构</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/c8ec8cb4a8440333558059974b44a2da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zThXmS62flwpQZlk"/></div></div></figure><p id="f581" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated"><strong class="lf ir">客户机</strong>是分布式应用集群中的节点，它从服务器访问信息。</p><p id="64f9" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated">每个客户端在特定的时间间隔向服务器发送一条消息，以告知客户端处于活动状态，当客户端连接时，服务器会发送一条确认消息。如果连接的服务器没有响应，客户端会自动将消息重定向到另一个服务器。</p><p id="2877" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated">一个<strong class="lf ir">群</strong>是一组动物园管理员服务器。它需要至少3个节点来形成集合。<strong class="lf ir">服务器</strong>是集群中的一个节点，为客户端提供服务。</p><p id="2b25" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated"><strong class="lf ir">领导者</strong>在服务启动时被选出，如果任何连接的节点失败，它将执行自动恢复。<strong class="lf ir">追随者</strong>听从领导者的指示。</p><h2 id="1e3b" class="mv lz iq bd ma mw mx dn me my mz dp mi lm na nb mk lq nc nd mm lu ne nf mo ng bi translated">动物园管理员数据模型</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/b14edc1a9a707d42fa18cda4596d1461.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/0*urI9Ocw7L-CJRlnz"/></div></figure><p id="c85b" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated">Zookeeper使用分层名称空间来表示其文件系统的内存。ZooKeeper节点简称<strong class="lf ir"> znode </strong>。每个znode都由一个名称标识，并用“/”分隔。名称空间看起来类似于Unix文件系统。ZooKeeper数据模型中的每个znode都维护一个<strong class="lf ir"> stat </strong>结构。</p><h2 id="7d19" class="mv lz iq bd ma mw mx dn me my mz dp mi lm na nb mk lq nc nd mm lu ne nf mo ng bi translated">锌电极的类型</h2><p id="9f86" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated"><strong class="lf ir">持续znode — </strong>即使在创建该特定znode的客户端断开连接后仍保持活动状态。默认情况下，除非指定，否则所有znodes都是持久的。</p><p id="9b4c" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated"><strong class="lf ir">短暂znode — </strong>活动，直到客户端存活。如果客户端与系综断开连接，则该系综会自动删除。由于这个原因，这些znodes不允许有孩子。一旦znode被删除，那么下一个合适的节点将填充它的位置。短暂的节点在领导人选举中很重要。</p><p id="9632" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated"><strong class="lf ir">顺序znode — </strong>可以是持久的，也可以是短暂的。当创建一个新的znode时，ZooKeeper通过在原始名称上附加一个10位数的序列号来设置路径。如果同时创建了两个连续的znode，那么ZooKeeper不会为每个znode使用相同的编号。顺序节点在<strong class="lf ir">锁定和同步</strong>中很重要。</p><h2 id="a446" class="mv lz iq bd ma mw mx dn me my mz dp mi lm na nb mk lq nc nd mm lu ne nf mo ng bi translated">会议</h2><p id="c6d8" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">一旦客户端连接到服务器，ZooKeeper就会创建一个ZooKeeper会话，并为客户端分配一个<strong class="lf ir">会话id </strong>。客户端以特定的时间间隔发送PING请求，以保持会话活动。如果ZooKeeper服务在超过服务启动时指定的会话超时时间内没有接收到来自客户端的PINGs，则会话将结束。那么在该会话期间创建的短暂节点也会被删除。</p><h2 id="edb6" class="mv lz iq bd ma mw mx dn me my mz dp mi lm na nb mk lq nc nd mm lu ne nf mo ng bi translated">手表</h2><p id="b0a8" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">手表是一种简单的机制，可以通知客户整体的变化。客户可以在读取znode时设置手表。Znode变更是指与znode相关的数据修改或znode子节点的变更。手表只触发一次。如果客户端再次需要通知，应该通过另一个读取操作来完成。当会话过期时，客户端将断开连接，相关的观察器将被删除。</p><h1 id="5dc5" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">动物园管理员—工作流程</h1><p id="a252" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">一旦动物园管理员合奏开始，它将等待客户端连接。客户端将连接到ZooKeeper集合中的一个节点。它可能是一个领导者或追随者节点。一旦客户端被连接，该节点向特定客户端分配会话ID，并向客户端发送确认。如果客户端没有得到确认，它会尝试连接ZooKeeper集合中的另一个节点。一旦连接到节点，它就可以根据需要执行读取、写入或存储数据等功能。客户端将定期PING该节点，以确保连接不会丢失。</p><h1 id="7f6a" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">用例</h1><p id="986b" class="pw-post-body-paragraph ld le iq lf b lg mq jr li lj mr ju ll lm ms lo lp lq mt ls lt lu mu lw lx lc ij bi translated">ZooKeeper提供的常见服务如下:</p><ul class=""><li id="876f" class="np nq iq lf b lg nh lj ni lm nr lq ns lu nt lc nu nv nw nx bi translated"><strong class="lf ir">命名服务</strong>—通过名称识别集群中的节点。</li><li id="e42e" class="np nq iq lf b lg ny lj nz lm oa lq ob lu oc lc nu nv nw nx bi translated"><strong class="lf ir">配置管理</strong>—加入节点的系统最新配置信息。</li><li id="753f" class="np nq iq lf b lg ny lj nz lm oa lq ob lu oc lc nu nv nw nx bi translated"><strong class="lf ir">集群管理</strong>—实时加入/离开集群中的节点和节点状态。</li><li id="fb19" class="np nq iq lf b lg ny lj nz lm oa lq ob lu oc lc nu nv nw nx bi translated"><strong class="lf ir">领导者选举</strong>—为协调目的选举一个节点作为领导者。</li><li id="1625" class="np nq iq lf b lg ny lj nz lm oa lq ob lu oc lc nu nv nw nx bi translated"><strong class="lf ir">锁定和同步服务</strong>—在修改数据时锁定数据。这用于连接其他分布式应用程序时的自动故障恢复。</li><li id="bab7" class="np nq iq lf b lg ny lj nz lm oa lq ob lu oc lc nu nv nw nx bi translated"><strong class="lf ir">高度可靠的数据注册</strong>—即使一个或几个节点出现故障，数据仍然可用。</li></ul><p id="83af" class="pw-post-body-paragraph ld le iq lf b lg nh jr li lj ni ju ll lm nj lo lp lq nk ls lt lu nl lw lx lc ij bi translated">我希望您对Apache Zookeeper及其在分布式应用程序、架构和用例中的作用有所了解。感谢您的阅读！</p><h2 id="35fd" class="mv lz iq bd ma mw mx dn me my mz dp mi lm na nb mk lq nc nd mm lu ne nf mo ng bi translated">参考</h2><ol class=""><li id="a412" class="np nq iq lf b lg mq lj mr lm od lq oe lu of lc og nv nw nx bi translated"><a class="ae oh" href="https://zookeeper.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇动物园管理员文档</a></li><li id="33bb" class="np nq iq lf b lg ny lj nz lm oa lq ob lu oc lc og nv nw nx bi translated">动物园管理员教程— <a class="ae oh" href="https://www.tutorialspoint.com/zookeeper/index.htm" rel="noopener ugc nofollow" target="_blank">教程要点</a></li></ol></div></div>    
</body>
</html>