<html>
<head>
<title>5 Components of Kubernetes You Need to Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你需要知道的Kubernetes的5个组成部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/5-components-of-kubernetes-you-need-to-know-dbedc81641f7?source=collection_archive---------11-----------------------#2021-02-11">https://levelup.gitconnected.com/5-components-of-kubernetes-you-need-to-know-dbedc81641f7?source=collection_archive---------11-----------------------#2021-02-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq"><p id="a1f9" class="jr js it bd jt ju jv jw jx jy jz ka dk translated"><em class="kb">加入Meetup.com上的AWSMeetupGroup:<br/></em><a class="ae kc" href="https://www.meetup.com/AWSMeetupGroup/" rel="noopener ugc nofollow" target="_blank">https://www.meetup.com/AWSMeetupGroup</a></p></blockquote><p id="ddaa" class="pw-post-body-paragraph kd ke it kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ka im bi translated">在设置K8s集群之前，理解Kubernetes (K8s)的一些基本组件和概念至关重要。本指南分解了Kubernetes的5个关键组件，帮助您为部署第一个集群做好准备。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/a78fcc51a00359048285de848e00fdfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xJM9MRwR6FwVAN6gdAzuQ.jpeg"/></div></div></figure></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="7ff6" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">什么是Kubernetes？</strong></h1><p id="40f3" class="pw-post-body-paragraph kd ke it kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz ka im bi translated">首先，我们需要定义什么是Kubernetes。Kubernetes是一个可移植的开源平台，用于管理和编排容器化的工作负载。Kubernetes的意思是舵手或领航员。</p><p id="11ca" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">这意味着，如果您有一个微服务应用程序，其中有许多Docker容器运行多个服务和工作负载，随着应用程序的增长，管理起来会变得很困难。Kubernetes通过提供一种管理所有容器的方法来帮助解决这个问题。因此，有了K8s，您仍然可以使用Docker，但不是管理正确的端口、服务之间的连接，以及确保可能有数百个服务的一切工作正常，您可以让Kubernetes承担负载并为您处理。</p><h1 id="3c5e" class="lt lu it bd lv lw nb ly lz ma nc mc md me nd mg mh mi ne mk ml mm nf mo mp mq bi translated"><strong class="ak">节点</strong>:</h1><p id="d504" class="pw-post-body-paragraph kd ke it kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz ka im bi translated">节点可以是安装Kubernetes的物理机或虚拟机。每个节点都由控制平面(管理容器生命周期的编排层)管理，并包含运行pod所需的服务，然后pod运行容器。</p><h1 id="a6e5" class="lt lu it bd lv lw nb ly lz ma nc mc md me nd mg mh mi ne mk ml mm nf mo mp mq bi translated"><strong class="ak">吊舱:</strong></h1><p id="5dc2" class="pw-post-body-paragraph kd ke it kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz ka im bi translated">Pod是一组容器，它们共享相同的存储、网络、资源以及如何执行容器的指令。pod存在于节点中，节点是更高级别的组件。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/8c05ccb8524bf5fafcd9c763ef18c415.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*LCxxB5Ow73mkeqeoUwWDcg.png"/></div></figure><p id="a5ee" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">如果在同一个Pod上运行多个容器，这些容器将通过localhost进行通信。这是由于Pod的共享上下文，它是一组Linux名称空间和组。就Docker概念而言，Pod类似于一组具有共享名称空间和共享文件系统卷的Docker容器。</p><h1 id="6138" class="lt lu it bd lv lw nb ly lz ma nc mc md me nd mg mh mi ne mk ml mm nf mo mp mq bi translated"><strong class="ak">集群:</strong></h1><p id="517f" class="pw-post-body-paragraph kd ke it kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz ka im bi translated">简单地说，集群是一组节点，它们一起运行来承载您的容器化工作负载。如果你使用AWS，它可以是一队EC2实例，或者是裸机上的一群Raspberry Pis。</p><p id="1c56" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">集群的挑战部分是集群管理。维护用于托管应用程序的活动节点和就绪节点。最近，我在一群树莓上创建了一个Kubernetes集群。建立自己的本地网络并正确安装和配置Kubernetes有许多挑战。当您使用云提供商时，所有这些挑战都会迎刃而解。</p><h1 id="9898" class="lt lu it bd lv lw nb ly lz ma nc mc md me nd mg mh mi ne mk ml mm nf mo mp mq bi translated"><strong class="ak">名称空间</strong>:</h1><p id="33ca" class="pw-post-body-paragraph kd ke it kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz ka im bi translated">我们刚刚谈到Kubernetes中的集群，它是一组一起运行的节点，用来托管您的工作负载。名称空间没有太大的不同。</p><p id="955e" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">名称空间是Kubernetes集群内部的一个虚拟集群。名称空间是在多个应用程序或用户之间划分集群资源的一种方式。您可以为应用程序创建多个自定义命名空间，也可以使用默认命名空间。名称空间不能相互嵌套，每个Kubernetes资源只能位于一个名称空间中。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/5bb53558a300382ad785782490c99812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*Olx-OE8kPowPYbKZcISlMw.png"/></div></figure><h1 id="0ec8" class="lt lu it bd lv lw nb ly lz ma nc mc md me nd mg mh mi ne mk ml mm nf mo mp mq bi translated"><strong class="ak">服务</strong>:</h1><p id="05c7" class="pw-post-body-paragraph kd ke it kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz ka im bi translated">服务是公开在一组pod上运行的应用程序的一种方式。服务是Kubernetes网络的核心。</p><p id="6b9c" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">Kubernetes会自动为您的pod分配一个IP地址。比方说，您有一个在端口3000上运行的带有容器的pod。Kubernetes将为您的Pod分配一个IP地址(10.0.0.1)。现在，您可以通过转到10.0.0.1:3000连接到容器。这很好，但是如果你的Pod改变了，这个IP地址也会改变。我们如何解决这个问题？</p><p id="84f4" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">服务还将分配一个单一的DNS名称，该名称不会因一组pod而改变，并将在它们之间起到负载平衡的作用。默认情况下，服务的DNS名称将遵循以下模式:</p><pre class="lb lc ld le gt ni nj nk nl aw nm bi"><span id="e6b1" class="nn lu it nj b gy no np l nq nr">http://&lt;Service Name&gt;.&lt;Namespace&gt;.svc.cluster.local</span></pre><p id="9b94" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">您可能想知道为什么在这个Url中没有定义端口，这是如何工作的。</p><p id="f207" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">下面是一个服务的代码片段:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d6fc25e8e7c1a0b02c1081a157d36f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*we6L6obx_LdSibH53gwQ9g.png"/></div></figure><p id="4532" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">该服务有两个端口。一个名为“port ”,监听端口80；另一个名为“targetPort ”,监听端口3000。“port”字段是服务在Kubernetes内部监听的内部端口。这就是为什么上面的域名不需要在末尾定义端口的原因。HTTP侦听端口80。</p><pre class="lb lc ld le gt ni nj nk nl aw nm bi"><span id="f08e" class="nn lu it nj b gy no np l nq nr">http://&lt;Service Name&gt;.&lt;Namespace&gt;.svc.cluster.local</span></pre><p id="8d4e" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">现在来看看使用上述服务的Pod的代码片段:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/4124522e0fc9c8d80b90ee73f636f88c.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*1B_8zbpaJO_oWpYt8tvaeA.png"/></div></figure><p id="e499" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">如果您查看这段代码，您会看到我们有一个名为“containerPort”的端口，它正在侦听端口3000。从上面可以看到服务上的“targetPort ”,您会看到它们都与端口3000对齐。这与Kubernetes DNS解析的工作方式有关。回到顶部，我们有“端口:80”，我们说过这是一个在Kubernetes内部开放的端口，“应用服务”正在侦听它。现在，服务能够处理对多个pod的请求(概述:pod包含容器)。</p><p id="ec9f" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">因此，如果我有一个应用程序需要与另一个应用程序通信，或者如果我有一个来自公共互联网的外部请求，它会通过端口80上的服务路由到端口3000，再到我的容器，并通过代码块“targetPort: 3000”。</p><p id="f431" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">从外部用户到端口3000上运行的容器进入集群的流量示例。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi nu"><img src="../Images/712b29046afa48e31ec467171c615174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1NhDo9BuwY6rHRThnqQLA.png"/></div></div></figure><p id="b5dd" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">用户点击端点“app-1-load balancer-1234567890 . us-west-2 . elb . amazonaws . com”，该端点解析为服务，然后是Pod，最后是端口3000上的容器。</p><p id="dbe9" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">下面是一个通过服务进行点对点通信的示例:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi nv"><img src="../Images/dc4d930431fea9d159bda0385b3b8b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1c9LhpKZ-ey8ZKCcY6Cqw.png"/></div></div></figure><p id="e48a" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">这个图表汇集了你需要了解的Kubernetes的5个组成部分。我们有一个包含1个节点的群集，在命名空间“app”中有2个单元。每个单元有一个容器。一个容器监听端口3000，另一个监听端口3001。然后我们有两个服务在端口80监听。</p><p id="aa02" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated">在图中，“app-2”正在向“app-1”发出HTTP请求。此流量通过端点为“http://app-1-Service . app . SVC . cluster . local”的服务进行路由。该服务解析为“targetPort: 3000 ”,并将流量从“app-2”路由到端口为3000的“app-1”。</p><h1 id="f31a" class="lt lu it bd lv lw nb ly lz ma nc mc md me nd mg mh mi ne mk ml mm nf mo mp mq bi translated"><strong class="ak">总结</strong>:</h1><p id="283c" class="pw-post-body-paragraph kd ke it kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz ka im bi translated">Kubernetes是一个野兽，需要相当长的时间来学习的互通。如果你学到了什么，请按拍手按钮！</p><p id="61fe" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated"><strong class="kf iu"> Kubernetes </strong>树莓Pis上的集群:<a class="ae kc" href="https://awsmeetupgroup.medium.com/build-a-kubernetes-cluster-on-raspberry-pis-e65e1e49634e" rel="noopener">https://awsmeetupgroup . medium . com/build-a-Kubernetes-Cluster-on-Raspberry-Pis-e 65 E1 e 49634 e</a></p><p id="8783" class="pw-post-body-paragraph kd ke it kf b kg mw ki kj kk mx km kn ko my kq kr ks mz ku kv kw na ky kz ka im bi translated"><strong class="kf iu">订阅</strong>AWSMeetupGroup YouTube频道:<a class="ae kc" href="https://www.youtube.com/channel/UCG3Si_vP2tijvvyE5xr7lbg" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/channel/UCG3Si_vP2tijvvyE5xr7lbg</a></p></div></div>    
</body>
</html>