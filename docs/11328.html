<html>
<head>
<title>Serverless DynamoDB Integration Tests with Jest 🚀</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Jest进行无服务器DynamoDB集成测试🚀</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/serverless-dynamodb-integration-tests-with-jest-cbb276aec84d?source=collection_archive---------2-----------------------#2022-03-08">https://levelup.gitconnected.com/serverless-dynamodb-integration-tests-with-jest-cbb276aec84d?source=collection_archive---------2-----------------------#2022-03-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/fb0038d6247658a5f00625d612359e5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MrjZVtk4Mv5HlyAMZsY0yQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Amy Shamblen 在<a class="ae jd" href="https://unsplash.com/collections/962378/life-in-color?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="a9e7" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">如何使用Jest在您的无服务器解决方案中集成测试DynamoDB服务层，以及用AWS CDK和TypeScript编写的视觉效果和代码示例。</h2></div><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi kv"><img src="../Images/8ab336e285009242027f7b7dfda4302c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IwTL3g3NAfxJT7cm58i8DQ.png"/></div></div></figure><h1 id="911d" class="la lb jg bd lc ld le lf lg lh li lj lk km ll kn lm kp ln kq lo ks lp kt lq lr bi translated">介绍</h1><p id="bbd3" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">上周，我和一位同事聊起了无服务器解决方案中的集成测试<a class="ae jd" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank"> DynamoDB </a>调用，以及它如何加速开发；并意识到这种方法有点难以大声描述。</p><blockquote class="mo"><p id="db22" class="mp mq jg bd mr ms mt mu mv mw mx mn dk translated">“上周，我和一位同事聊到在无服务器解决方案中集成测试DynamoDB调用，以及它如何加快开发速度；并意识到这种方法有点难以大声描述</p></blockquote><p id="db1e" class="pw-post-body-paragraph ls lt jg lu b lv my kh lx ly mz kk ma mb na md me mf nb mh mi mj nc ml mm mn ij bi translated">因此，我撰写了一篇相对较短的文章，通过一个简短的代码示例来讨论这种方法，展示如何实现这一点。</p><blockquote class="nd ne nf"><p id="9e15" class="ls lt ng lu b lv nh kh lx ly ni kk ma nj nk md me nl nm mh mi nn no ml mm mn ij bi translated"><em class="jg">💡</em> <strong class="lu jh"> <em class="jg">注意</em> </strong>:还有一个关联的<a class="ae jd" href="https://github.com/leegilmorecode/serverless-dynamodb-integration-tests" rel="noopener ugc nofollow" target="_blank">代码报告</a>，它展示了一种在开发过程中集成测试DynamoDB服务层的方法。</p></blockquote><h2 id="43f4" class="np lb jg bd lc nq nr dn lg ns nt dp lk mb nu nv lm mf nw nx lo mj ny nz lq oa bi translated">这如何加速开发并给max信心？✔️</h2><p id="5ed6" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">正如我们大多数人所知道的，无服务器的本地开发仍然处于起步阶段，并且仍然不完全有效。我们可以使用各种工具，如<a class="ae jd" href="https://www.serverless.com/plugins/serverless-offline" rel="noopener ugc nofollow" target="_blank">无服务器离线</a>和<a class="ae jd" href="https://github.com/localstack/localstack" rel="noopener ugc nofollow" target="_blank">本地堆栈</a>，但在我看来，其缺点远远大于本地开发的优点:</p><p id="cdee" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">域服务之间的❌配置可能成为一场噩梦。</p><p id="5445" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">❌当地的发展从来没有像云一样给人以同等程度的信心。</p><p id="26a2" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">❌本地仿真器几乎总是随着新服务和错误而过时(例如<em class="ng">local stack当前的344个已知问题</em>)</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="b894" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><strong class="lu jh">转向在云上工作！</strong> ☁️</p><p id="6540" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">这意味着大多数开发团队从短暂的环境开始，直接在云上部署和测试，这可能非常缓慢和乏味，每次部署更改时都要等待云形成完成。一些工具正在开始增强这一过程，如SAM Accelerate和T2的无服务器云，但在我看来，它仍处于起步阶段。(<em class="ng">围绕</em>以下短暂环境的讨论)</p><div class="ip iq gp gr ir od"><a href="https://medium.com/swlh/enterprise-serverless-architecture-39c4f4ae5aff" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jh gy z fp oi fr fs oj fu fw jf bi translated">企业无服务器🚀体系结构</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">企业无服务器系列中的这一部分专门介绍了一些高级体系结构和设计…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div><div class="om l"><div class="on l oo op oq om or ix od"/></div></div></a></div><p id="f128" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><strong class="lu jh">另一种方法</strong> ✔️</p><p id="1b2e" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">在开发我的无服务器解决方案时，我个人并不经常部署我的代码，而是使用TDD对组成解决方案的代码及其边界/接口进行全面的单元测试，并对我在云中部署和测试时可能会发现问题的任何领域进行集成测试(<strong class="lu jh">这是我希望加快过程的地方</strong>)，在实际部署和执行全面的e2e测试之前，给我充分的信心。</p><p id="40aa" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">容易出错并降低开发和部署周期的一个典型例子是在服务层中使用AWS DynamoDB SDK，并首次获得正确的参数(<em class="ng">Inc query等</em>)。</p><p id="5c7d" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">我们可以对DocumentDB、SNS、S3等使用相同的集成测试方法，并通过使用服务层包或在许多无服务器解决方案的monorepos中重用它们来充分实现这一点(t <em class="ng"> hink Lerna或Nx </em>)。</p><p id="a90c" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">这是相当常见的做法，最近的一项调查显示，大多数无服务器团队要么完全在云中工作，要么在本地和云的混合环境中工作，这样做是有意义的:</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi os"><img src="../Images/6869b4f1b879200638a446a0ee2f9dcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MORLM7NuZ5ifU5tXOVjLBg.png"/></div></div></figure><h1 id="d366" class="la lb jg bd lc ld le lf lg lh li lj lk km ll kn lm kp ln kq lo ks lp kt lq lr bi translated">让我们直观地看看这种方法👀</h1><p id="f882" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">好了，让我们来看看团队是如何随着时间的推移而工作的:</p><p id="f526" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><strong class="lu jh">新的无服务器团队尝试本地开发</strong>。<br/>当开始设置本地开发环境时，无服务器团队会很兴奋，开发人员会使用诸如<a class="ae jd" href="https://www.serverless.com/plugins/serverless-offline" rel="noopener ugc nofollow" target="_blank">无服务器-离线</a>、<a class="ae jd" href="https://github.com/localstack/localstack" rel="noopener ugc nofollow" target="_blank">本地堆栈</a>、<a class="ae jd" href="https://www.npmjs.com/package/serverless-dynamodb-local" rel="noopener ugc nofollow" target="_blank">无服务器-dynamo db-本地</a>、<a class="ae jd" href="https://www.serverless.com/plugins/serverless-appsync-offline" rel="noopener ugc nofollow" target="_blank">无服务器appsync插件</a>等服务进行测试..</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ot"><img src="../Images/a867d611f9c28d95d2e8adbf4d76d086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aEEIXPcuVf-t1hKEFMtLnw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">团队在基本解决方案上快乐起步——照片由<a class="ae jd" href="https://unsplash.com/@balazscsaba2006?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Csaba Balazs </a>在<a class="ae jd" href="https://unsplash.com/s/photos/office-sad?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="48c3" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><strong class="lu jh">随着时间的推移，团队意识到这是一场噩梦，于是转而使用短暂的环境(或者两种方法的混合)。<br/>随着时间的推移，随着组织的成长，无服务器团队需要集成越来越多的微服务和域服务(<em class="ng">以及额外的团队</em>)；并增加他们对其他自动气象站服务的使用；他们很快意识到，由于本地和云开发之间的额外配置，以及所需的大量模仿，整体本地开发变得缓慢而繁琐。转向短暂的云开发是必须的！</strong></p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ou"><img src="../Images/dd68c1ef45499eb127ed7ea7f8a58607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BLM1cvInaZ_iha38eLsnmg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">团队可能会对当地的发展感到非常沮丧——照片由<a class="ae jd" href="https://unsplash.com/@punttim?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Tim Gouw </a>在<a class="ae jd" href="https://unsplash.com/s/photos/office-sad?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="ee72" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><strong class="lu jh">现在团队的认知负荷减少了，但是向云的部署循环可能会很慢。</strong> <br/>现在，当直接在云上工作时，短暂环境的一个折衷是，变更的部署可能会很慢(<em class="ng">尤其是在云形成的情况下</em>),这种反馈循环真的会减慢团队的速度。该去喝杯咖啡了。)</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ov"><img src="../Images/2f0ee2c73aaa074aaf93ccc2d79334ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUEs_XKTb0NwEibqa5jdDw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">等待部署本地变更—照片由<a class="ae jd" href="https://unsplash.com/@lordmaui?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">克里斯·本森</a>在<a class="ae jd" href="https://unsplash.com/s/photos/office-sad?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="5db8" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">作为两种方法的混合，团队利用本地集成测试来加速无服务器开发。 <br/>根据我的经验，在有意义的地方利用本地开发，例如在使用Docker容器部署到云之前对服务层进行集成测试，确实可以加快开发速度。让我们看看下面的方法和代码示例。</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ow"><img src="../Images/a9c2b7db24393b914de62cdda54ada14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ReKHwj0pj6VwATJ--RLuVQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">好吧好吧，也许没这么开心！——照片由<a class="ae jd" href="https://unsplash.com/s/photos/office-happy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jd" href="https://unsplash.com/@windows?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">窗口</a>拍摄</figcaption></figure><p id="831d" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">从过程流的角度来看，我们可以看到将集成测试的信心添加到组合中所产生的差异(<em class="ng">部署后出现问题的机会减少，以及修复+部署+测试</em>的恒定周期):</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ox"><img src="../Images/17a5eec452f88d031030fc40081fdcc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oPZzcvwPM-4InQer14lnsw.png"/></div></div></figure><h1 id="4620" class="la lb jg bd lc ld le lf lg lh li lj lk km ll kn lm kp ln kq lo ks lp kt lq lr bi translated">入门！✔️</h1><p id="41ea" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">首先，使用以下git命令克隆以下repo:</p><pre class="kw kx ky kz gt oy oz pa pb aw pc bi"><span id="2fbf" class="np lb jg oz b gy pd pe l pf pg">git clone <a class="ae jd" href="https://github.com/leegilmorecode/serverless-dynamodb-integration-tests" rel="noopener ugc nofollow" target="_blank">https://github.com/leegilmorecode/serverless-dynamodb-integration-tests</a></span></pre><p id="38a8" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">这将把示例代码下载到您的本地机器上。</p></div><div class="ab cl ph pi hu pj" role="separator"><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm"/></div><div class="ij ik il im in"><h1 id="a1c1" class="la lb jg bd lc ld po lf lg lh pp lj lk km pq kn lm kp pr kq lo ks ps kt lq lr bi translated">测试解决方案🎯</h1><h2 id="dea4" class="np lb jg bd lc nq nr dn lg ns nt dp lk mb nu nv lm mf nw nx lo mj ny nz lq oa bi translated">单元和集成测试设置</h2><p id="91bb" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">让我们首先看看Jest的单元测试设置。我们专门为寻找<code class="fe pt pu pv oz b">*.spec.ts</code>文件的单元测试创建一个jest配置:</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pw oc l"/></div></figure><p id="b774" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">我们为集成测试添加了一个单独的文件来寻找<code class="fe pt pu pv oz b">*.int.ts</code>文件:</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pw oc l"/></div></figure><p id="709e" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">两者都是通过npm脚本获取的，如下所示(<em class="ng">通过不同的配置路径</em>):</p><pre class="kw kx ky kz gt oy oz pa pb aw pc bi"><span id="113f" class="np lb jg oz b gy pd pe l pf pg">"test": "jest --config jest.unit.config.js",<br/>"test:int": "LOCAL=true jest --config jest.int.config.js",</span></pre><p id="f66e" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">这意味着我们可以区分两组测试。</p><p id="a02c" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">💡<strong class="lu jh">注意</strong> : <em class="ng">对于集成测试，我们还传递一个名为LOCAL的环境变量，该变量被设置为true，这允许我们为本地或云配置DynamoDB。</em></p><h2 id="a650" class="np lb jg bd lc nq nr dn lg ns nt dp lk mb nu nv lm mf nw nx lo mj ny nz lq oa bi translated">针对本地DynamoDB的集成测试</h2><p id="32db" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">对于DynamoDB的本地集成测试，我们使用一个Docker容器，它通过一个<code class="fe pt pu pv oz b">docker-compose.yml</code>文件使用DynamoDB Local:</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pw oc l"/></div></figure><p id="610e" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">在我们的pre npm脚本中，我们使用以下内容启动容器:</p><pre class="kw kx ky kz gt oy oz pa pb aw pc bi"><span id="c0ca" class="np lb jg oz b gy pd pe l pf pg">"pretest:int": "docker-compose up -d dynamodb-local"</span></pre><p id="333e" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">这意味着当我们的集成测试开始使用Jest时，我们运行容器来处理本地DynamoDB实例。</p><p id="dbd3" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">💡<strong class="lu jh">注意</strong> : <em class="ng">一旦测试也运行了，我们就用一个post npm脚本来停止容器。</em></p><p id="754f" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">现在，当运行集成测试时，我们确保取消对<code class="fe pt pu pv oz b">aws-sdk</code> ( <em class="ng">，因为我们想要利用对本地实例</em>的实际DynamoDB调用，在<code class="fe pt pu pv oz b">beforeAll</code> Jest钩子中创建订单表来运行测试，并在测试运行后删除<code class="fe pt pu pv oz b">afterAll</code> Jest钩子中的本地表:</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pw oc l"/></div></figure><p id="5d3b" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">这意味着当我们在开发过程中运行集成测试时，我们有最大的信心在推进到云之前它会工作！</p><h2 id="bf72" class="np lb jg bd lc nq nr dn lg ns nt dp lk mb nu nv lm mf nw nx lo mj ny nz lq oa bi translated">模拟单元测试</h2><p id="0172" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">当我们运行单元测试时，我们希望确保模拟DynamoDB调用，因为我们不想集成任何实际的基础设施或数据库来进行单元测试。我们通过使用<code class="fe pt pu pv oz b">__mocks__</code>文件夹模仿<code class="fe pt pu pv oz b">aws-sdk</code>来模仿节点模块/包，如下所示，使用Jest模仿:</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pw oc l"/></div></figure><p id="e59d" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">现在，当我们运行单元测试时，我们可以模拟出实际的返回值，而不是命中实际的数据库(下面的所示的<em class="ng">示例)</em></p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pw oc l"/></div></figure><p id="2648" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">我们可以操纵响应值(<em class="ng">无论是拒绝还是解决</em>)，这样我们就可以全面测试我们的服务。</p><h1 id="550d" class="la lb jg bd lc ld le lf lg lh li lj lk km ll kn lm kp ln kq lo ks lp kt lq lr bi translated">结论</h1><p id="cf4f" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">我们可以将这种方法用于所有的集成测试，例如针对DocumentDB服务层的MongoDB容器，甚至在测试S3或SNS时完全针对云进行集成测试。如果我们将这些服务作为包发布，或者使用monorepos来利用和共享它们，我们完全有信心在为开发人员测试和e2e测试部署更改之前，它们会按预期工作。</p><p id="dfbe" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><strong class="lu jh">本文由</strong> <a class="ae jd" href="https://www.sedai.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lu jh"> Sedai.io </strong> </a>赞助</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi px"><img src="../Images/1cd71d5a60f667b3639d55cc7a550c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UCnsEvxMPNn_GC5n.png"/></div></div></figure><h1 id="bab4" class="la lb jg bd lc ld le lf lg lh li lj lk km ll kn lm kp ln kq lo ks lp kt lq lr bi translated">摘要</h1><p id="0ffb" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">我希望你觉得有用！</p><p id="8b27" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">请点击此处订阅我的企业无服务器新闻稿，了解更多相同的内容:</p><div class="ip iq gp gr ir od"><a href="https://www.linkedin.com/newsletters/enterprise-serverless-%F0%9F%9A%80-6875837779876605952/" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jh gy z fp oi fr fs oj fu fw jf bi translated">企业无服务器🚀LinkedIn</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">Lee Gilmore |面向AWS开发人员、DevOps工程师和云架构师的无服务器新闻和文章</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">www.linkedin.com</p></div></div><div class="om l"><div class="py l oo op oq om or ix od"/></div></div></a></div><h1 id="ed39" class="la lb jg bd lc ld le lf lg lh li lj lk km ll kn lm kp ln kq lo ks lp kt lq lr bi translated">包扎👋</h1><p id="a86d" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">请<a class="ae jd" href="https://www.youtube.com/channel/UC_Bi6eLsBXpLnNRNnxKQUsA" rel="noopener ugc nofollow" target="_blank">去我的YouTube频道</a>订阅类似内容！</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi px"><img src="../Images/0f91bfcf52a73d34c3a4bb10462e530e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6HSrLpkaDR7p3ccI.png"/></div></div></figure><p id="6b35" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">我很乐意就以下任何一个方面与您联系:</p><p id="2e79" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><a class="ae jd" href="https://www.linkedin.com/in/lee-james-gilmore/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/lee-james-gilmore/</a><br/>T17】https://twitter.com/LeeJamesGilmore</p><p id="61fd" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">如果你觉得这些文章鼓舞人心或有用，请随时用虚拟咖啡<a class="ae jd" href="https://www.buymeacoffee.com/leegilmore" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/leegilmore</a>来支持我，不管怎样，让我们联系和聊天吧！☕️</p><p id="0e6e" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">如果你喜欢这些帖子，请关注我的简介<a class="ae jd" href="https://medium.com/u/2906c6def240?source=post_page-----39c4f4ae5aff----------------------" rel="noopener">李·詹姆斯·吉尔摩</a>以获取更多的帖子/系列，不要忘记联系我并打招呼👋</p><p id="6f4e" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">如果你喜欢，也请使用帖子底部的“鼓掌”功能！(<em class="ng">可以不止一次鼓掌！！</em>)</p><h1 id="8b66" class="la lb jg bd lc ld le lf lg lh li lj lk km ll kn lm kp ln kq lo ks lp kt lq lr bi translated">关于我</h1><p id="0129" class="pw-post-body-paragraph ls lt jg lu b lv lw kh lx ly lz kk ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">"<em class="ng">大家好，我是Lee，英国的AWS社区构建者、博客作者、AWS认证云架构师和首席软件工程师；目前是一名全球无服务器架构师，过去6年主要从事AWS上的全栈JavaScript工作。</em></p><p id="5811" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><em class="ng">我认为自己是一个无服务器倡导者，热爱AWS、创新、软件架构和技术。</em></p><p id="be6b" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated"><strong class="lu jh"> ***所提供的信息是我个人的观点，我对信息的使用不承担任何责任。*** </strong></p><p id="aac2" class="pw-post-body-paragraph ls lt jg lu b lv nh kh lx ly ni kk ma mb nk md me mf nm mh mi mj no ml mm mn ij bi translated">您可能还对以下内容感兴趣:</p><div class="ip iq gp gr ir od"><a href="https://leejamesgilmore.medium.com/serverless-content-46ef5b562d8e" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jh gy z fp oi fr fs oj fu fw jf bi translated">无服务器内容🚀</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">我的所有无服务器内容的索引，可以在一个地方轻松浏览，包括视频、博客文章等..</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">leejamesgilmore.medium.com</p></div></div><div class="om l"><div class="pz l oo op oq om or ix od"/></div></div></a></div></div></div>    
</body>
</html>