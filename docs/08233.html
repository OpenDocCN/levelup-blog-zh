<html>
<head>
<title>MapReduce: Simplified Data Processing on Large Clusters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MapReduce:大型集群上的简化数据处理</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/paper-summary-mapreduce-simplified-data-processing-on-large-clusters-58dac068462e?source=collection_archive---------8-----------------------#2021-04-13">https://levelup.gitconnected.com/paper-summary-mapreduce-simplified-data-processing-on-large-clusters-58dac068462e?source=collection_archive---------8-----------------------#2021-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="43a4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从谷歌构建的分布式大规模计算管道中吸取的经验教训。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/00314e7793b9aab60dc3f3facdc0f3fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uY5diOv5UJIKuQg-"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@rajeshwerbatchu7?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拉杰什瓦尔·巴楚</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">号航天飞机</a>上拍摄的照片</figcaption></figure><h1 id="286a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么是MapReduce？</h1><p id="50c9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">MapReduce是一个支持大规模计算自动并行化和分布的界面，同时<strong class="lq ir">抽象出“并行化、容错、数据分布和负载平衡的混乱细节”</strong> [1]。</p><p id="6783" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">顾名思义，MapReduce的灵感来自于许多函数语言中的<em class="mp"> map </em>和<em class="mp"> reduce </em>函数。这些功能允许MapReduce轻松地并行化大型计算，并使用重新执行作为处理故障的关键机制。</p><h1 id="f937" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">MapReduce试图解决哪些问题？</h1><p id="a5b4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在MapReduce之前，谷歌已经进行了数百次计算，处理大量原始数据来计算各种派生数据。</p><p id="ed70" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">他们发现大多数计算在概念上很简单。然而，困难以大量输入数据的形式出现，其计算必须分布在数千台机器上才能在合理的时间内完成。分布式计算中出现的一些问题包括:</p><ol class=""><li id="52c0" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj mv mw mx my bi translated">如何并行化计算</li><li id="181b" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj mv mw mx my bi translated">如何分发大的输入/输出数据</li><li id="25ef" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj mv mw mx my bi translated">如何处理故障</li></ol><p id="1edc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">因此，MapReduce的主要目标是通过将并行化、容错、数据分布和负载平衡的所有细节都抽象出来，为没有分布式和并行系统经验的程序员提供一个易于使用的界面</strong>。</p><p id="1419" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">主要目标带来的一个好处是，通过简单地向集群中添加新机器，可以更容易地提高计算过程的性能，因为MapReduce会自动为程序员处理所有的抽象。</p><h1 id="f6e8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">MapReduce(架构)的全貌</h1><p id="9611" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们可以使用MapReduce以两个用户定义函数的形式来表示计算:Map和Reduce。</p><p id="35e9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">map := (k1，v1) → list(k2，v2)</p><p id="8d1b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">减少:= (k2，列表(v2)) →列表(v3)</p><p id="cedf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="mp">映射</em>:取一个数据输入(键，值)对，产生一组中间(键，值)对。MapReduce库将与同一个中间键I相关联的所有中间值分组在一起，并将它们传递给Reduce函数。</p><p id="cc66" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="mp">减少</em>:接受一个中间键和该键的一组值。它合并这些值，形成一个可能更小的值集。请注意，中间值通过迭代器提供给reduce函数。这使我们能够处理太大而不适合内存的值列表。</p><p id="3cf9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">请注意，在实际用例中，我们可以链接多个MapReduce作业Reduce操作的输出通常作为输入提供给另一个MapReduce作业，或者可能是另一个分布式应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/7fcb2653c96981e0b6bff7582541a396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*2nKeNIDzEhXopYLONXoFVw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图1:MapReduce作业执行的高级概述。改编自[1]。</figcaption></figure><p id="648f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">注意，输入数据被分成一组M个输入文件。这些较小的输入文件可以由不同的机器并行处理。使用用户定义的分区函数将每个Reduce调用的输入数据分成R个部分。M和R均由用户指定。</p><p id="c222" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">图1显示了MapReduce作业的整体流程。当用户调用MapReduce作业时，将发生以下一系列操作(图1中的编号标签对应于下面列表中的编号):</p><p id="7068" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">1.用户程序将输入文件分成M个部分，通常为16-64MB(Google使用GFS来自动划分输入数据)。然后，它在一组机器上启动程序的许多副本。</p><p id="950a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2.程序的一个副本是特殊的——母版。其余的是由主人分配工作的工人。有M个映射任务和R个归约任务要分配。主人挑选空闲的工人，给每个人分配一个地图任务或一个归约任务。</p><blockquote class="nf ng nh"><p id="890a" class="lo lp mp lq b lr mk jr lt lu ml ju lw ni mm lz ma nj mn md me nk mo mh mi mj ij bi translated">请注意，在2004年，网络带宽是一个巨大的瓶颈，作者希望尽量减少通过网络传递的数据。如局部性优化一节所述，主服务器倾向于将映射作业调度到已经包含输入数据的机器上。因此，地图作业通常在与输入数据相同的本地计算机上运行(无需通过网络传输输入文件)。</p></blockquote><p id="7141" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">3.被分配了地图任务的工作者读取相应输入文件的内容。它解析键/值对，并将每一对传递给用户定义的映射函数。Map函数产生的中间键/值对被缓冲在Map worker的内存中。</p><p id="816a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">4.缓冲对被周期性地写入映射工作器的本地磁盘，由Reduce分区函数分成R个区域。这些缓冲对在本地磁盘上的位置被传递回主设备，主设备负责将这些位置转发给Reduce工作器。</p><blockquote class="nf ng nh"><p id="d44f" class="lo lp mp lq b lr mk jr lt lu ml ju lw ni mm lz ma nj mn md me nk mo mh mi mj ij bi translated">请注意，减少作业仅在所有地图作业完成后开始(请参考常见问题部分)。</p></blockquote><p id="2e2f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">5.当主进程通知Reduce worker这些位置时，它使用远程过程调用从Map workers的本地磁盘读取缓冲数据。</p><p id="a907" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">当Reduce worker读取了所有的中间数据后，它会按照中间键对它们进行排序，以便将所有出现的相同键组合在一起。需要进行排序，因为通常许多不同的键映射到同一个reduce任务。如果中间数据量太大，不适合内存，就使用外部排序。</p><p id="8cc0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">6.reduce工作器遍历排序后的中间数据，对于遇到的每个唯一的中间键，它会将该键和相应的一组中间值传递给用户的Reduce函数。Reduce函数的输出被附加到最终的输出文件中。</p><p id="df92" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="mp">总结第5步和第6步，这是Reduce工人需要采取的步骤:</em></p><p id="2bf6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">A.所有地图作业完成后，Reduce workers将从所有地图工作者的本地磁盘中提取中间数据(从分区中)。</p><p id="f77c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">B.Reduce workers将按中间键对数据进行排序。</p><p id="2580" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">C.分类后，工人会传递中间键以减少功能。</p><p id="4000" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">D.Reduce函数的输出被附加到最终的输出文件中。</p><p id="5026" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">7.当所有的Map任务和Reduce任务完成后，主机唤醒用户程序。</p><h1 id="4df9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">MapReduce的主要经验是什么？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/b2e9b6c50e0c70e8f45de050b5d69a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hvbG5dCkGBOQyGiu"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a04c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">1.<strong class="lq ir">限制编程模型</strong>使得并行化和分布式计算变得更加容易，甚至使得这样的计算具有容错能力。</p><p id="9479" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">对于MapReduce，作者限制模型接受键/值对，输出也是键/值对。这样做允许他们将计算实现到Map和Reduce函数中，使并行计算更容易。</p><p id="3718" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2.<strong class="lq ir">冗余执行</strong>可用于减少慢速机器(掉队者)的影响，并处理机器故障和数据丢失。</p><p id="fa82" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果工作进程失败，MapReduce master只是重新执行无法联系到的工作进程所做的工作，并继续前进。</p><p id="ee5a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在出现“掉队者”的情况下(掉队者是一台花费异常长的时间来完成最后几个Map或Reduce任务之一的机器，因此延长了所需的总时间)，当MapReduce操作接近完成时，主服务器在剩余的进行中的任务上调度备份执行。这些冗余备份过程可以加快完成所有任务所需的总时间。</p><h1 id="7d00" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">MapReduce什么时候不适合？</h1><p id="0237" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">1.当你需要实时处理时，MapReduce可能不是最快的选择。</p><p id="c69a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2.将每件事都实现到一系列Map和Reduce函数中并不总是很容易。</p><p id="c381" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">3.当您的中间进程需要相互通信时(Map和Reduce作业是隔离运行的)。</p><p id="98a4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">4.当您需要处理流数据时。请注意，所有由MapReduce处理的输入数据首先由地图工作进程批量处理，然后由Reduce工作进程处理。</p><p id="9f3b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">5.当您可以在本地机器上获得想要的结果时。“显然，与分布式系统相比，配置和管理独立系统要容易得多。”[2]</p><h1 id="b7bd" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">常见问题解答</h1><ol class=""><li id="0186" class="mq mr iq lq b lr ls lu lv lx nm mb nn mf no mj mv mw mx my bi translated">Reduce workers中的混洗过程(从所有地图工作进程中提取中间数据)是否与Reduce操作同时发生？</li></ol><p id="54c9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">不，不是的。Reduce工作器将交替处理来自map工作器的数据，对中间数据进行排序，并将排序后的数据传递给Reduce函数。</p><p id="8623" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2.归约操作是否与映射操作同时发生？</p><p id="99d9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">不。您可以将Map和Reduce操作视为成批发生。Reduce工作器必须等待所有映射作业完成，才能开始对数据进行洗牌、排序和传递到Reduce函数中。</p><p id="fd1e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是因为MapReduce保证了排序，即在一个给定的分区内，中间的键/值对以递增的键顺序进行处理(参见[1]的第4.2节)。</p><p id="dd8c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">换句话说，为了让Reduce操作开始，在调用Reduce函数之前，必须先收集整个分区，然后进行排序。</p><p id="b708" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">确保我们拥有整个分区的唯一方法是等待所有映射操作完成，以便处理所有输入片。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><h1 id="eb40" class="kw kx iq bd ky kz nw lb lc ld nx lf lg jw ny jx li jz nz ka lk kc oa kd lm ln bi translated">参考</h1><p id="0033" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">[1]杰弗里·迪恩和桑杰·格玛瓦特(2004年)。MapReduce:大型集群上的简化数据处理。<a class="ae kv" href="https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf" rel="noopener ugc nofollow" target="_blank">https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf</a></p><p id="3693" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[2]堆栈溢出帖子<a class="ae kv" href="https://stackoverflow.com/questions/18585839/what-are-the-disadvantages-of-mapreduce" rel="noopener ugc nofollow" target="_blank">https://Stack Overflow . com/questions/18585839/what-is-the-families-of-MapReduce</a></p><p id="480e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[3]麻省理工学院6.824的2021年新加坡国立大学DYOM课程的常见问题部分。</p></div></div>    
</body>
</html>