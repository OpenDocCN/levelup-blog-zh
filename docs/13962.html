<html>
<head>
<title>I Re-Wrote These 10+ Single Lines of JavaScript Code, the Team Lead Praised the Code for Being Elegant</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我重写了这10多行JavaScript代码，团队领导称赞这些代码非常优雅</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/i-re-wrote-these-10-single-lines-of-javascript-code-the-team-lead-praised-the-code-for-being-668ade4fea71?source=collection_archive---------0-----------------------#2022-10-20">https://levelup.gitconnected.com/i-re-wrote-these-10-single-lines-of-javascript-code-the-team-lead-praised-the-code-for-being-668ade4fea71?source=collection_archive---------0-----------------------#2022-10-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6b3a6ef8ed1507f0ba55b850afa7ffe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*bjyhMSpV5nxkKCTBhLV1Jw.gif"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">这不是一个阶段，妈妈。</figcaption></figure><p id="5f92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我是团队领导，我称赞代码。/s</p><p id="e910" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇文章是对Zard-x在Medium上写的名为“<a class="ae kw" href="https://javascript.plainenglish.io/i-wrote-these-10-single-lines-of-javascript-code-the-team-lead-praised-the-code-for-being-elegant-6a9c471a9613" rel="noopener ugc nofollow" target="_blank">的博客文章的回应，但绝不是挖苦，我写了这10+行JavaScript代码；团队领导称赞代码优雅</a>。</p><p id="3844" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一行程序确实是很酷的挑战，而且制作起来非常有趣。我曾经花了很多时间在codewars.com的<a class="ae kw" href="http://codewars.com/" rel="noopener ugc nofollow" target="_blank">和codingame.com的</a>和<a class="ae kw" href="http://codingame.com/" rel="noopener ugc nofollow" target="_blank">这两个网站上，这两个网站促进了小的编码挑战，挑战你写短代码或快速写代码的能力。</a></p><p id="3bb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然code golf可以作为一种有趣的工程实践，但他们的经验应该很少在现实世界中使用——即使在现实世界中使用，工程经理也绝不应该鼓励开发人员在代码库中使用这种类型的代码。当你在一个协作的环境中，写好代码应该是优先考虑的事情。这意味着代码是可读的，可维护的，运行可靠的。</p><blockquote class="ky kz la"><p id="90dd" class="jy jz kx ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated"><em class="iq"> Code golf是一种娱乐性的计算机编程竞赛，参赛者努力获得解决某个问题的最短源代码。</em></p><p id="33e8" class="jy jz kx ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">—维基百科，代码高尔夫</p></blockquote><h1 id="44e8" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">阵列重复数据消除</h1><h2 id="7d7b" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">原始源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="3e66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我并不反对通过实例化和传播一个集合来从数组中删除重复项的常见技巧，但是由于索引数组的次数太多，这样做的性能会很差。</p><h2 id="043d" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">重写的源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="dd62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在由1-100之间的1，000，000个随机生成的数字组成的数组中，原始源代码的执行速度只有重写版本的12%。因为我们在第二个函数中使用了map，所以我们只需要在数组上迭代一次，这样检查是否已经看到了一个元素就需要O(1)时间。</p><p id="db6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码消除了“技巧”，取而代之的是哈希映射等众所周知的概念，这可能会减少其他开发人员对您代码的查询。代码也有很好命名的变量，用函数名<code class="fe mu mv mw mx b">removeDuplicateStrings</code>定义函数正在做的动作，而不是像<code class="fe mu mv mw mx b">uniqueArr</code>这样模棱两可的名字，它也没有使用过度缩写的单词，使代码更容易被非英语母语的人理解。</p><p id="85b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，该函数没有记录。过多的文档有时可能是一件坏事。如果您的变量名命名良好，您可能会发现您的注释是多余的，这是一件好事！如果发生这种情况，高兴地放弃他们，并运送它！</p><p id="8cd4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们绝对坚持使用spread操作符和集合，或者我们希望在不编写臃肿的功能的情况下删除不完全是字符串的值的重复，我们需要做的就是记录我们的代码，并确保我们的变量命名良好。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="b9ae" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">从URL获取参数并将它们转换为对象</h1><h2 id="fe56" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">原始源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1430" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果这段代码有问题，当你发现这就是你要做的函数时，你会有多兴奋？可能性不大。更不用说用字符串重新构建JSON对象是您希望尽可能避免的事情，在这种情况下，这很容易。</p><h2 id="c1dc" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">重写的源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="91ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在为这个函数重写的代码中，我们使用了方便的本地JavaScript URL API，它自动为我们调用URLSearchParams对象的一个实例，然后我们简单地对结果对象使用<code class="fe mu mv mw mx b">Object#fromEntries</code>函数！这使我们不必通过混合和混淆字符串来手动构造JSON对象。</p><p id="a899" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意，我们已经为这个函数提供了一个注释！尽管我已经在函数名<code class="fe mu mv mw mx b">getURLParameters</code>中包含了函数处理哪个<strong class="ka ir">类型</strong>参数的规范，但不一定清楚结果对象会是什么格式。</p><h1 id="ae18" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">检查对象是否为空</h1><h2 id="2cd5" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">原始源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="5a48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当检查对象是否为空时，使用ownKeys或Object.keys都不是很有效。</p><h2 id="ca31" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">重写的源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="51f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种重写的代码是一种古老的方法，人类已经通过了时间的考验！重写的源代码比原来的方法执行速度快20倍，而且这只是针对一个对象的两个属性。性能提升来自于您不再需要创建数组、复制值和索引键。你看到一个键，你已经逃离了功能！</p><p id="1606" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们迭代对象的键的原因可能不是很明显，所以我们在这里留了一个简短的注释，以确保其他开发人员知道发生了什么。</p><h1 id="b956" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">反转绳子</h1><h2 id="af0e" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">原始源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="605d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，我们没有一个坏的开始！我们<em class="kx">可以</em>使用for循环在短字符串上获得80%的性能提升，如果我们经常反转一些粗字符串，我们可能会考虑实现该方法，但在轻量级字符串上进行奇数反转的情况下，我们可能会更好地利用该功能。</p><h2 id="7e22" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">重写的源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="f97e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将链接的方法拆分成多行是我的个人偏好，因为它允许我扫描函数路径而不是跳过它们，但是如果有人要求我改变它，我不会大惊小怪。</p><p id="22f4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了好玩，这里有一个更高性能的版本。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="bc13" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">生成随机十六进制</h1><h2 id="52f0" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">原始源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="b02f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再说一次，开局不错！我特别喜欢我们直接引用非alpha颜色支持的最大十六进制值！稍微清理一下，我们就可以营业了！</p><h2 id="e897" class="mc lf iq bd lg md me dn lk mf mg dp lo kj mh mi ls kn mj mk lw kr ml mm ma mn bi translated">重写的源代码</h2><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="8143" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个例子中，我所做的唯一主要改变是将<code class="fe mu mv mw mx b">padEnd</code>改为<code class="fe mu mv mw mx b">padStart</code>。这个函数的工作方式是生成一个随机的24位整数，然后用它的十六进制格式表示。</p><p id="d3f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们能得到的最小值是0 <code class="fe mu mv mw mx b">0x000000</code>，最大值是16777215<code class="fe mu mv mw mx b">0xFFFFFF</code>。</p><p id="6488" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们的<code class="fe mu mv mw mx b">randomValue</code>最终是255。我们的<code class="fe mu mv mw mx b">hexValue</code>将会是<code class="fe mu mv mw mx b">ff</code>，如果我们填充了结尾，我们的返回值将会是<code class="fe mu mv mw mx b">#ff0000</code>，反之，如果我们填充了开头，返回值将会是<code class="fe mu mv mw mx b">#0000ff</code>。如果我们将这两个值都转换回整数，<code class="fe mu mv mw mx b">#ff0000</code>将实际表示值16，711，680，而<code class="fe mu mv mw mx b">#0000ff</code>将表示255。这意味着如果我们填充的是结尾而不是开头，我们实际上会得到错误的值。</p><p id="28c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">除此之外，使用第一种方法，通过填充结尾而不是开头，<code class="fe mu mv mw mx b">#0000ff</code>实际上不可能生成。这意味着有大量不可能生成的缺失值。具体来说，<code class="fe mu mv mw mx b">0x000001</code>和<code class="fe mu mv mw mx b">0x100000</code>之间的每个值。我们的函数中有1，048，576个缺失值，但也有利于所有以0结尾的值，有些值比其他值多。例如，<code class="fe mu mv mw mx b">#100000</code>将是来自<code class="fe mu mv mw mx b">0x1</code>、<code class="fe mu mv mw mx b">0x10</code>、<code class="fe mu mv mw mx b">0x100</code>、<code class="fe mu mv mw mx b">0x1000</code>、<code class="fe mu mv mw mx b">0x10000</code>的结果，当然还有<code class="fe mu mv mw mx b">0x100000</code>。</p><h1 id="a209" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="99ad" class="pw-post-body-paragraph jy jz iq ka b kb my kd ke kf mz kh ki kj na kl km kn nb kp kq kr nc kt ku kv ij bi translated">这花了比预期更长的时间，所以我会在晚些时候发布这篇博客的第二部分。我从重构这段代码中获得了很多乐趣。你会做些不同的事情吗？在<a class="ae kw" href="https://medium.com/@ridafkih/i-re-wrote-these-10-single-lines-of-javascript-code-the-team-lead-praised-the-code-for-being-668ade4fea71" rel="noopener">中</a>或<a class="ae kw" href="https://dev.to/rida/i-re-wrote-these-10-single-lines-of-javascript-code-the-team-lead-praised-the-code-for-being-elegant-ec" rel="noopener ugc nofollow" target="_blank"> dev.to </a>发表评论！我认为这对每个人来说都是一个很好的学习机会，我很重视所有的反馈！</p><p id="04b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">想看更多我的东西吗？你可以看看我的<a class="ae kw" href="https://rida.dev/" rel="noopener ugc nofollow" target="_blank">个人网站</a>。如果你想开始一段对话，请随意发微博给我。</p></div></div>    
</body>
</html>