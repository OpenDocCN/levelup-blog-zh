# 用 Python 进行 Reddit 情感分析

> 原文：<https://levelup.gitconnected.com/reddit-sentiment-analysis-with-python-c13062b862f6>

![](img/fafd55cfde6e908558ab10b284316b8c.png)

都说行动胜于言语，但有时言语也能掩盖行动察觉不到的情绪。在本指南中，我们将着眼于分析来自 Reddit 帖子的评论情绪。

Reddit 是一个社交新闻聚合、网络内容评级和讨论网站，提供了大量数据供我们探索。通过分析来自具体帖子的文字的情绪，我们可以确定一篇文章是积极的、消极的还是中性的。

情感分析是一个涉及自然语言处理(NLP)的研究领域，根据上下文，这种分析对于某些部门可能特别有用。例如，一家公司试图根据客户对其产品的评论来了解客户的情绪。利用这种情绪，企业可以了解客户对产品的反应，并制定未来的商业策略。

与分析前的大多数输入一样，需要进行清洗。在我们的例子中，由于我们处理的是定性数据，与定量数据清理相比，这个过程可能看起来有点不同。

## 让我们从该项目的流程概述开始:

1.  通过 API 建立一个 Reddit 实例
2.  从 Reddit 上的帖子获取评论
3.  预处理评论
4.  应用情感分析模型(VADER)
5.  获取情感结果并创建一些简单的可视化效果，例如单词云

## 1.用 Praw 建立 Reddit 实例

就像我之前的文章一样，我们将使用 Python API 包装器来获取注释形式的数据，以便进行分析。

[](/extracting-and-analysing-spotify-tracks-with-python-d1466fc1dfee) [## 用 Python 提取和分析 Spotify 曲目

### 除了 Spotify 上绝大多数图书馆的流媒体音乐，如果我们可以分析我们…

levelup.gitconnected.com](/extracting-and-analysing-spotify-tracks-with-python-d1466fc1dfee) 

对于 Reddit，我们将利用 PRAW API 包装器。使用 API 包装的先决条件包括:

*   **Python 知识**
*   **Reddit 知识(对 Reddit 如何工作的基本了解)**
*   **Reddit 账户(访问 Reddit 的 API)**
*   **客户端 ID &客户端机密(需要这两个值来作为脚本应用程序访问 Reddit 的 API)**
*   **用户代理(帮助 Reddit 确定网络请求来源的唯一标识符)**

如需了解更多信息，您可以访问 https://praw.readthedocs.io/en/latest/。

让我们通过[https://www.reddit.com/prefs/apps](https://www.reddit.com/prefs/apps)创建一个应用程序。

在页面底部，找到并选择“您是开发人员吗？创建应用程序…”框。填写您的 API 的名称，选择**脚本**选项，并用“【http://www.example.com/unused/redirect/uri】的[填充重定向 URL。然后继续创建你的应用程序。](http://www.example.com/unused/redirect/uri)

![](img/bd4873304f88534c40ed8117f13717ff.png)

由于 Reddit 的 API 使用 OAuth2，因此必须使用客户端 ID 和客户端密码建立 Reddit 连接。这些值可以在创建应用程序后找到。

对于我们的项目，我们将利用以下进口:

![](img/bba1d8488ab9c7ec61cb6a7979c89178.png)

如果您在导入上述库时遇到任何错误，请通过 pip 在您的终端上安装它们。

完成后，我们可以开始用我们的客户端 ID 和客户端密码建立 Reddit 连接。

![](img/619fb247c24a0807f9a6acdf2dca3353.png)

## 2.从帖子中获取评论

接下来，我们必须在从 Reddit subreddit 帖子中提取评论之前创建一个 submission 对象。

![](img/0ffd17fe9272a4d580a02924c78b4e5c.png)

提交 ID 包含整个 Reddit 中特定帖子的 ID。由于我们对从单个帖子的评论中获得观点感兴趣，我们选择了在 Reddit 上流行的前 5 个“热门”帖子。

你也可以选择显示特定子编辑中你想要的“热门”、“新”或“热门”文章的数量。

您还可以通过直接从地址栏中获取文章的提交 ID 来创建所需文章的提交对象。例如:

![](img/c04d6b1f5c3cd71b2631cafbbecb9d15.png)

在我们的例子中，让我们继续定义提交 ID 为 kp57s7 的提交对象

![](img/7c39942a6f60da3af95acc0f6a239575.png)

一旦我们有了 submission 对象，我们将获得帖子的所有评论，并将它们存储到一个列表中。这可能需要一段时间，取决于帖子包含的评论数量。

![](img/a9239ac026c7134dc39fb691bfcb4bcb.png)

我们的输出包含了从这篇文章中收集的 4033 条评论。

![](img/e4069d6549f1e9c81dbcb063cc79ae10.png)

如你所见，文本包含大量单词，可能包含不相关的信息，如链接、表情符号和我们在继续之前必须删除的单词。

## 3.预处理评论

当处理原始或未清理的数据时，我们首先必须在建模之前对其进行预处理或“清理”,或者在我们的情况下，应用情感分析。

在我们的实例中，我们将包括以下预处理步骤:

*   **移除表情符号**
*   **标记、移除链接等。**
*   **删除停用词**
*   **通过词汇化使单词规范化**

我们首先将列表转换成一个 string 对象，然后将它们传递给每个预处理过程。

![](img/b61d97977e042ad42d924ae7b8737051.png)

接下来，我们将删除字符串对象中的表情符号。

![](img/1d57b45a9c7ebf7ce31fdfa9f35867c5.png)

然后通过正则表达式标记器对字符串进行标记和清理。标记化将字符串中的每个单词分解成单独的单词，然后根据我们的情感分析器，这些单词将携带自己的“积极”或“消极”情感。

![](img/97d0774413701deec8e163295fbdaec0.png)

正如您所看到的，一些令牌是大写的，一些是小写的。为了标准化这一点，我们将把所有的记号都转换成小写，并存储到一个列表中。

![](img/43b41d2bc2472e66927c9486f6ec92f6.png)![](img/11128f6c86762f4099a2810c88354300.png)![](img/fecfd1c225f60663c286f0c2095ffdae.png)

接下来，我们将删除列表对象中的停用词。

![](img/bdb1beef12a4bf6f1791010c617c1550.png)

停用词是不会给句子增加太多信息的词。因此，可以安全地忽略它们，而不会牺牲句子的含义。en_core_web_sm 中包含的停用词示例如下:

![](img/51eb3d63e79e9d99a37bd4f302234c62.png)

这是删除停止字后的输出

![](img/ed2b898ba886b9e244c4e26a1536b7f4.png)

最后，我们将通过一个叫做词汇化或词干化的过程来规范化单词。

这两个过程都用来将单词精简到它们的词根。然而，词干化可能返回不是实际单词的词根，而词汇化返回是实际语言单词的词根。

因此，我们将只对列表对象应用词汇化过程。

![](img/b1b92f340a97d324092b0089ad0f30bc.png)

和输出

![](img/59fd5507e347bb0b3ebbc287e466ffe5.png)

为了便于比较，让我们在 list 对象上运行词干化过程，以了解输出结果。

![](img/5a16e8464f1089383f10d9e328fe646a.png)

我注意到，单词“rememb”和“corporation”在我们的词汇化令牌输出中变成了“rememb”或“corpor ”,这并不是一个实际的语言单词。

![](img/f30caf29dc6a51f9c618c7bf29e86a4c.png)

我们将继续把符号化的令牌存储到一个新的变量中。出于可视化的目的，我们可以看到预处理和后处理的字数大大减少了！

![](img/49291ba53f8df8e51d68e188c9b0234a.png)

## 4.应用情感分析器(VADER)

一旦我们获得了干净的输出，我们将使用 VADER(用于情感推理的配价感知词典)模型来计算每个标记化单词的极性得分。

极性得分衡量每个单词的积极性和消极性。我们最感兴趣的是**复合**得分，它被归一化为介于-1(最极端的负面情绪)和+1(最极端的正面情绪)之间。这为给定单词提供了单一的一维情感度量。

然后，我们将它存储为数据框对象。

![](img/bd68dc432cf3c04a8728551d97f72dea.png)

和输出

![](img/bf019df0a720554d7e240815842147d3.png)

接下来，我们将添加一个新的列“label ”,它根据复合得分和我们的分类标准来过滤单词。在我们的例子中，我们使用了一个+- 0.10 的复合分数来区分正面词、负面词和中性词。

![](img/38821771c465caac5abad8a20984b65b.png)

## 5.情感结果的表示

使用快速值计数，我们可以看到大多数单词的情感本质上是中性的；他们在情绪上也积极多于消极。

![](img/a138682941d692bc71aa5bc29ef6e97b.png)

因此，我们可以推断这个帖子的评论是中性偏正的。

![](img/084d3846517ce18be454c95392e16600.png)![](img/9a80184d3b66f5fa359a47aa84c24eb6.png)

除去中性词，我们可以看到剩余的词是正偏的。

![](img/af8665a7d11b8a465bfa4ac718a618d7.png)![](img/d450ecd869a3717bdcf4ec05329fb323.png)![](img/3224ed0445c077585d036add19b63583.png)

## 简单的可视化

最后，在结束这篇文章之前，我们可以进行一些简单的可视化，并探索积极和消极单词的词频。

20 个最常见的正面词汇的频率分布:

![](img/6b48328bb17d2e883906fed8d5d0dd6b.png)![](img/ddfc0278716f77759724ff9057ba5b89.png)

20 个最常见的否定词的频率分布:

![](img/d164ce16b510735d242c6fdc7a494586.png)![](img/1d12bef0787b086f740bec3497fd94ac.png)

我们也可以通过文字云将它们可视化。

![](img/b5adb9941ba7bdfce92a3e6ba7778693.png)

和输出

![](img/74b8ab5ba31962431e9cf82d03021249.png)

正面词的词云

![](img/701af4aa1a9b8ee8b67d6ca70096458f.png)

否定词的词云

最后，我们可以使用条形图直观显示字数:

按计数列出的 20 个最常见正面词的条形图

![](img/8dc57bb8b8ba9fb2d654cb1e4a5efa64.png)![](img/ce15487e315fef326c8bd7ed11582fc2.png)

按计数列出的 20 个最常见负面词汇的条形图

![](img/511bce1e7850aa0fff0e339c74aed4ff.png)![](img/f442d9ed42528c5931f7b6238fe4945c.png)

你有它！在本指南中，我们学习了如何建立一个 Reddit 实例，创建一个我们选择的提交对象，从一个特定的帖子中获得评论，并应用许多情感分析模型中的一个来获得一个帖子的总体情感。

我们还学习了如何生成简单的可视化效果，比如单词云和常用单词的条形图。我希望这个小项目对你有用。

干杯！

好奇的学习者？释放你在媒体上学习的全部潜力，用不到一杯咖啡的钱支持像我这样的作家。

[](https://lzpdatascience.medium.com/membership) [## 通过我的推荐链接加入媒体——杰森·LZP

### 作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…

lzpdatascience.medium.com](https://lzpdatascience.medium.com/membership) 

刚接触 R 编程，不知道从哪里开始？看看我的电子书一步一步的指南！

[](https://lzpdatascience.medium.com/r-for-data-science-a-beginners-guide-pdf-ebook-a5fe11009443) [## 数据科学入门指南(PDF /电子书

### 有一段时间了，我希望每个人都保持安全和健康。本月初，由于封锁，我…

lzpdatascience.medium.com](https://lzpdatascience.medium.com/r-for-data-science-a-beginners-guide-pdf-ebook-a5fe11009443)