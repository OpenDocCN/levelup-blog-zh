<html>
<head>
<title>What is CSRF? How does it work?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是CSRF？它是如何工作的？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-csrf-how-does-it-work-af1ae4c227a7?source=collection_archive---------2-----------------------#2020-09-12">https://levelup.gitconnected.com/what-is-csrf-how-does-it-work-af1ae4c227a7?source=collection_archive---------2-----------------------#2020-09-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0d27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你读过我以前的媒体故事，你可能已经知道这些天我们正在进行ScholarX项目。上周，我已经为后端创建了一些API端点和单元测试。在做这个的时候，我发现了一个我从未听过的词；<strong class="jp ir">谓CSRF。所以我决定对此做些研究，并与你们分享我的发现。</strong></p><h1 id="1573" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">这是什么？</h1><p id="016e" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">那么什么是CSRF呢？基本上它是“跨站请求伪造”的缩写。看起来像是非法的。是啊！举个例子，在CREF，有人可以在没有你确认的情况下通过发送请求从你的银行账户里偷钱。此外，有人甚至可以改变你的重要数据库中的数据。(不要试图做这些<strong class="jp ir">😆</strong>)</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/91ba463f849b013e058ee20240be9394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rlhq0ZBX6C5JAmRS9bKPHA.jpeg"/></div></div></figure><blockquote class="ma mb mc"><p id="958e" class="jn jo md jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated">在CSRF攻击中，一个无辜的最终用户被攻击者诱骗提交了一个他们不想要的web请求。这可能会导致在网站上执行操作，包括无意中泄露客户端或服务器数据、更改会话状态或操纵最终用户的帐户。— <a class="ae mh" href="https://en.wikipedia.org/wiki/Cross-site_request_forgery" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="30f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们必须防止这种情况。在spring boot中，CSRF保护自动附带spring-boot-starter-security包。默认情况下，它是启用的。因此，您只需创建一个<code class="fe mi mj mk ml b">SecurityConfig.java</code>文件并启用Web安全。</p><p id="0930" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在CSRF保护中，我们使用令牌来授权API请求。</p><blockquote class="ma mb mc"><p id="953b" class="jn jo md jp b jq jr js jt ju jv jw jx me jz ka kb mf kd ke kf mg kh ki kj kk ij bi translated">CSRF令牌是一个唯一的、秘密的、不可预测的值，它由服务器端应用程序生成，并以某种方式传输到客户端，以便包含在客户端发出的后续HTTP请求中。</p></blockquote><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/f79fcfb9cd49d7f4a2eaa690fbeba4e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*Xlf17tduqPYw3IQ0ZIzeLA.jpeg"/></div></figure><p id="fe6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们举一个例子。假设用户想使用表单向数据库添加一些数据。因此，用户登录到仪表板，有一个表单来添加数据。在这里，服务器发送一个秘密的csrf令牌，格式如下。并且它还发送另一个csrf令牌作为cookie。这两个都是随机生成的，所以没人能猜到。提交表单后，两个令牌都被再次发送到服务器。服务器检查令牌是否与先前的令牌匹配。如果它们不匹配，请求将被拒绝。事情就是这样发生的。</p><ol class=""><li id="752f" class="mn mo iq jp b jq jr ju jv jy mp kc mq kg mr kk ms mt mu mv bi translated">服务器发送两个令牌(形式为，cookie形式为)</li><li id="d38d" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated">用户提交表单并发送请求</li><li id="9598" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated">服务器检查两个令牌</li><li id="62ed" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated">服务器批准或拒绝请求</li></ol></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><h1 id="e7a5" class="kl km iq bd kn ko ni kq kr ks nj ku kv kw nk ky kz la nl lc ld le nm lg lh li bi translated">您想禁用它吗？</h1><p id="652d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">尽管有风险，但您可以出于测试目的或其他目的禁用csrf保护。您唯一需要做的就是像这样更新<code class="fe mi mj mk ml b">SecurityConfig.java</code>:</p><pre class="lp lq lr ls gt nn ml no np aw nq bi"><span id="dab5" class="nr km iq ml b gy ns nt l nu nv">@EnableWebSecurity<br/>public class SecurityConfig extends WebSecurityConfigurerAdapter{</span><span id="eadc" class="nr km iq ml b gy nw nt l nu nv">@Override<br/>    protected void configure(HttpSecurity http) throws Exception {<br/>        http.csrf().disable();<br/>    }<br/>}</span></pre></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="27d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前就这些。我仍在学习如何在spring-boot中使用csrf令牌。希望在以后的帖子里告诉你。直到那时…再见！感谢阅读！</p></div></div>    
</body>
</html>