<html>
<head>
<title>Kubernetes Angular ASP.NET Core Microservice Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">kubernetes Angular ASP.NET核心微服务架构</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/kubernetes-angular-asp-net-core-microservice-architecture-c46fc66ede44?source=collection_archive---------0-----------------------#2021-04-11">https://levelup.gitconnected.com/kubernetes-angular-asp-net-core-microservice-architecture-c46fc66ede44?source=collection_archive---------0-----------------------#2021-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="30de" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用ASP.NET核心C# REST API和Angular在Docker桌面上使用K8S和Ingress进行本地云开发。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/260ed1405d9838736023e0f641730810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*dJlOLcMqBQNCGqVdKLCslg.png"/></div></figure><blockquote class="kn ko kp"><p id="1649" class="kq kr ks kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Kubernetes <strong class="kt ir">使用docker桌面在本地环境</strong>中运行。它与云环境类似<strong class="kt ir">。你可以用它来开发和测试。没有<strong class="kt ir">额外费用</strong>。您可以随时<strong class="kt ir">轻松地将其部署到云</strong>。</strong></p></blockquote><p id="985d" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">在本指南中，您将创建一个<strong class="kt ir">基于原始微服务的云架构</strong>。它使用<strong class="kt ir">。NET核心，REST-API</strong>在后端服务中，而<strong class="kt ir"> Angular </strong>作为前端。所有的<strong class="kt ir">组件都被分类</strong>并且<strong class="kt ir"> Kubernetes编排</strong>容器。应用程序通过入口控制器公开<strong class="kt ir">。</strong></p><p id="a0a1" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="ks">部件概述图:</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lq"><img src="../Images/34781b0e5f2cb04250d40f39010e4b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpXKDFXrMWduTglmXWDFBg.png"/></div></div></figure><h1 id="ae9f" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">内容</h1><ol class=""><li id="37a7" class="mn mo iq kt b ku mp kx mq ln mr lo ms lp mt lm mu mv mw mx bi translated">构建ASP.NET核心REST-API后端</li><li id="9f32" class="mn mo iq kt b ku my kx mz ln na lo nb lp nc lm mu mv mw mx bi translated">创建角度前端应用程序</li><li id="3c73" class="mn mo iq kt b ku my kx mz ln na lo nb lp nc lm mu mv mw mx bi translated">将。NET Core API和Angular App</li><li id="dd01" class="mn mo iq kt b ku my kx mz ln na lo nb lp nc lm mu mv mw mx bi translated">将容器部署到Docker桌面上的Kubernetes</li><li id="c8e8" class="mn mo iq kt b ku my kx mz ln na lo nb lp nc lm mu mv mw mx bi translated">最后的想法和展望</li></ol></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="1adb" class="lv lw iq bd lx ly nk ma mb mc nl me mf jw nm jx mh jz nn ka mj kc no kd ml mm bi translated">1.构建ASP.NET核心REST-API后端</h1><p id="d489" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated"><strong class="kt ir">用ASP.NET和web开发工作量安装</strong> <a class="ae ns" href="https://visualstudio.microsoft.com/en/vs/community/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> Visual Studio社区</strong> </a>(免费)。</p><p id="9cff" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">创建一个ASP.NET核心5.0 Web API项目，并将其命名为“DemoApi”。激活Docker，使用“Linux”设置。禁用HTTPS:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi nt"><img src="../Images/f42deb99e603fca2d10b6a94850cb059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLDD1YGTeyM25sWWXuRxPg.png"/></div></div></figure><p id="3973" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">添加一个新的控制器“DemoController”。它只返回“Hello World”:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="5bca" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">在端口4200(开发)和80上为Angular应用程序启用CORS:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="64d6" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">编辑launchsettings.json并将“DemoApi”配置的URL更改为端口80。然后选择DemoApi配置并启动它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi nw"><img src="../Images/6d1b953135b03b3b35fa9f90c8e1a014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bpZ2rJnEGx8SeRxyTehTHQ.png"/></div></div></figure><p id="b132" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">在浏览器中测试它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/6047ec7c6d3802617967cc8c400890d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*DEKRomRgrH_guE1WjQ2JoA.png"/></div></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="cd50" class="lv lw iq bd lx ly nk ma mb mc nl me mf jw nm jx mh jz nn ka mj kc no kd ml mm bi translated">2.创建角度前端应用程序</h1><p id="6339" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated"><strong class="kt ir">下载安装</strong><a class="ae ns" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir">Node.js/NPM</strong></a><strong class="kt ir">。</strong></p><p id="91fa" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">创建文件夹</strong> <code class="fe ny nz oa ob b"><strong class="kt ir">C:\dev\demo</strong></code>并打开命令提示符。</p><p id="0e39" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">安装Angular </strong>(我在写这个指南的时候用了Angular 9):</p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="3109" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo&gt;npm install -g @angular/cli</span></pre><p id="150d" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">创建app: </strong></p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="b040" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo&gt;ng new DemoApp</span></pre><p id="a484" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="ks">延伸阅读:</em> <a class="ae ns" href="https://javascript.plainenglish.io/understanding-angular-and-creating-your-first-application-4b81b666f7b4" rel="noopener ugc nofollow" target="_blank"> <em class="ks">了解角度并创建您的第一个应用</em> </a> <em class="ks">由</em></p><p id="08ca" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><a class="ae ns" href="https://medium.com/u/4a1da74ae506?source=post_page-----6635719fb86c--------------------------------" rel="noopener"> <em class="ks">【重力井】(罗布·汤姆林)</em> </a></p><h2 id="4180" class="og lw iq bd lx ol om dn mb on oo dp mf ln op oq mh lo or os mj lp ot ou ml ov bi translated">调用REST-API</h2><p id="6ed2" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated">调整<code class="fe ny nz oa ob b">C:\dev\demo\DemoApp\src\app</code>中的代码</p><p id="e31d" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">将HttpClientModule添加到<strong class="kt ir"> app.module.ts </strong>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="248c" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">调用<strong class="kt ir"> app.component.ts </strong>中的REST-API:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="bb74" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">在<strong class="kt ir">app.component.html</strong>中显示加载的数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="f71e" class="og lw iq bd lx ol om dn mb on oo dp mf ln op oq mh lo or os mj lp ot ou ml ov bi translated">测试应用程序</h2><p id="cf9f" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated">确保。NET Core API正在运行。启动Angular应用程序，并在浏览器中打开它，看看是否一切正常:</p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="f18f" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo\DemoApp&gt;ng serve</span></pre><p id="b2fd" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">它应该加载并显示数据“Hello World”:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/8addb30ced885d474e4c7f95bae70d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*aDfnaJJr97GeWsJrGNCdNg.png"/></div></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="f2c0" class="lv lw iq bd lx ly nk ma mb mc nl me mf jw nm jx mh jz nn ka mj kc no kd ml mm bi translated">3.将。NET Core API和Angular App</h1><p id="4fe8" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated">我将向您展示创建和运行docker映像的两种不同方式。为了。NET核心API，您将使用UI。对于Angular应用程序，命令行。</p><p id="9e2e" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">为Windows安装<a class="ae ns" href="https://hub.docker.com/editions/community/docker-ce-desktop-windows" rel="noopener ugc nofollow" target="_blank"> Docker桌面</a></p><h2 id="5794" class="og lw iq bd lx ol om dn mb on oo dp mf ln op oq mh lo or os mj lp ot ou ml ov bi translated">将。网络核心API</h2><p id="c86c" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated">在Visual Studio DemoApi项目中，将项目资源管理器中的文件“Dockerfile”重命名为“dockerfile”(第一个字符小写)。然后右键单击Docker文件，选择“创建Docker映像”。</p><p id="41ee" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">如果一切正常，检查构建输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ox"><img src="../Images/b99873b3eaa208b4083080308012af73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQiT3Ze5QPoX-YrfEFHR7Q.png"/></div></div></figure><p id="2341" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">如果Visual Studio中的API项目仍在运行，请将其停止，因为docker和Visual Studio不能同时绑定到80端口。</p><p id="8e6c" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">在Docker桌面UI中运行“最新”的“demoapi”映像，并映射端口80:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oy"><img src="../Images/04526e8fdafe4a4b35c6a41e56369e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_q-lx_MU-M7foBOR51hYw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oz"><img src="../Images/453ffe8f74615ea73847c34204df8a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uqUAphA6n5hIPvLQwAqi8g.png"/></div></div></figure><p id="b6c0" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="ks">延伸阅读:</em> <a class="ae ns" href="https://faun.pub/how-to-deploy-a-net-5-api-in-a-kubernetes-cluster-53212af6a0e2" rel="noopener ugc nofollow" target="_blank"> <em class="ks">如何在Kubernetes集群中部署. NET 5 API</em></a><em class="ks">作者:</em> <a class="pa pb ep" href="https://medium.com/u/f58cb680fdbf?source=post_page-----c46fc66ede44--------------------------------" rel="noopener" target="_blank"> <em class="ks">伊万·波塔</em> </a></p><h2 id="8f3a" class="og lw iq bd lx ol om dn mb on oo dp mf ln op oq mh lo or os mj lp ot ou ml ov bi translated">将Angular应用程序归档</h2><p id="c337" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated"><strong class="kt ir">创建文件</strong> <code class="fe ny nz oa ob b"><strong class="kt ir">C:\dev\demo\DemoApp\dockerfile</strong></code></p><blockquote class="kn ko kp"><p id="9bd0" class="kq kr ks kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">确保文件“dockerfile”没有文件扩展名</p></blockquote><p id="338c" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">这将使用NGINX来服务应用程序:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="f968" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">创建文件”。dockerignore" </strong>(开头带点):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="0b22" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">打开命令提示符，构建docker镜像</strong>(末尾的点很重要):</p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="2024" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo\DemoApp&gt;docker build -t demoapp .</span></pre><p id="bcdd" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">如果Angular应用程序</strong>仍在运行，请将其停止。使用命令行(整个命令在一行中)启动容器中的app，并<strong class="kt ir">发布到端口4200 </strong>:</p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="cf59" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo\DemoApp&gt;docker run --publish 4200:80 --name demoappcontainer demoapp</span></pre><p id="656f" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="ks">延伸阅读:</em> <a class="ae ns" href="https://wkrzywiec.medium.com/build-and-run-angular-application-in-a-docker-container-b65dbbc50be8#" rel="noopener"> <em class="ks">在Docker容器中构建并运行Angular应用</em></a><em class="ks"/><a class="pa pb ep" href="https://medium.com/u/8fb6f1a94f5b?source=post_page-----c46fc66ede44--------------------------------" rel="noopener" target="_blank"><em class="ks">Wojciech Krzywiec</em></a></p><h2 id="b0f1" class="og lw iq bd lx ol om dn mb on oo dp mf ln op oq mh lo or os mj lp ot ou ml ov bi translated">测试两个容器</h2><p id="9391" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated">您可以列出您的容器(您的容器id和时间戳会有所不同):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi pc"><img src="../Images/0e9f1f461dd19603d04861d25615c5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R3iLOr2nwwZVOgMbZyBHLQ.png"/></div></div></figure><p id="26b4" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">在浏览器中启动应用</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/8addb30ced885d474e4c7f95bae70d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*aDfnaJJr97GeWsJrGNCdNg.png"/></div></figure><p id="60be" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">停止两个容器</strong>以便在本指南的下一步不会阻塞端口:</p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="6c6b" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo\DemoApp&gt;docker stop demoappcontainer<br/>C:\dev\demo\DemoApp&gt;docker stop demoapi</span></pre></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="cd15" class="lv lw iq bd lx ly nk ma mb mc nl me mf jw nm jx mh jz nn ka mj kc no kd ml mm bi translated">4.部署到Docker桌面上的Kubernetes</h1><p id="be7b" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated"><strong class="kt ir">在Docker桌面启用Kubernetes:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi pd"><img src="../Images/71296b0d54d64c7185670b55a8390438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IzjJfH56yoJGrxUQru1fSA.png"/></div></div></figure><p id="88c9" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">安装NGINX入口控制器</strong>(在命令行的一行中):</p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="e37d" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo&gt;kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v0.41.2/deploy/static/provider/cloud/deploy.yaml</span></pre><p id="b574" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="ks">详见</em> <a class="ae ns" href="https://kubernetes.github.io/ingress-nginx/deploy/" rel="noopener ugc nofollow" target="_blank"> <em class="ks"> NGINX入口安装指南</em></a><em class="ks"/></p><p id="d8cb" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">创建</strong>T0】</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="db9d" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">应用yaml: </strong></p><pre class="kg kh ki kj gt oc ob od oe aw of bi"><span id="7827" class="og lw iq ob b gy oh oi l oj ok">C:\dev\demo&gt;kubectl apply -f kubernetes.yaml</span></pre><p id="2b74" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">这将创建两个Kubernetes“部署”，并为每个部署创建一个“服务”。然后，这两种服务都通过端口80上的入口公开。</p><p id="e5f0" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="ks">详见</em> <a class="ae ns" href="https://kubernetes.io/docs/home/" rel="noopener ugc nofollow" target="_blank"> <em class="ks"> Kubernetes文档</em></a><em class="ks"/></p><p id="2834" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">第一个部署使用DemoAPI映像和两个副本来展示如何进行扩展。第二个部署使用DemoApp的单个副本。基于路径前缀的服务入口路由:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lq"><img src="../Images/7a8d2d1d9efd0dc1e296baa4a0beb4f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E5XwWdOIlvk2tm50Kmyf7Q.png"/></div></div></figure><h2 id="652a" class="og lw iq bd lx ol om dn mb on oo dp mf ln op oq mh lo or os mj lp ot ou ml ov bi translated">测试部署</h2><p id="7244" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated">“获取部署”显示部署和单元数量:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/035b5011146b38f95ea9d548ccdd7606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*60srpHN1Fee5vqkbgGVhUw.png"/></div></figure><p id="b969" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">在80端口上打开您的浏览器。)并测试您的Kubernetes部署:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/fe8431133eb19c4edcb2a1b7c8bb6293.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*wqEW7Mj7LtSvuG9ZDWq8UA.png"/></div></figure><p id="b939" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="ks">延伸阅读:</em> <a class="ae ns" href="https://faun.pub/how-to-deploy-a-net-5-api-in-a-kubernetes-cluster-53212af6a0e2" rel="noopener ugc nofollow" target="_blank"> <em class="ks">如何在Kubernetes集群中部署. NET 5 API</em></a><em class="ks">by</em><a class="pa pb ep" href="https://medium.com/u/f58cb680fdbf?source=post_page-----c46fc66ede44--------------------------------" rel="noopener" target="_blank"><em class="ks">Ivan Porta</em></a></p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="690f" class="lv lw iq bd lx ly nk ma mb mc nl me mf jw nm jx mh jz nn ka mj kc no kd ml mm bi translated">5.最后的想法和展望</h1><p id="1b0d" class="pw-post-body-paragraph kq kr iq kt b ku mp jr kw kx mq ju kz ln np lc ld lo nq lg lh lp nr lk ll lm ij bi translated">您为基于微服务的云架构创建了<strong class="kt ir">工作基础。但是<strong class="kt ir">还是少了很多</strong>。</strong></p><p id="dc8e" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">参见我的后续帖子<a class="ae ns" rel="noopener ugc nofollow" target="_blank" href="/databases-in-a-kubernetes-angular-net-core-microservice-arch-a0c0ae23dca9"> <strong class="kt ir">如何给你的架构添加一个MySql数据库和MongoDB副本集</strong> </a>和<a class="ae ns" href="https://itnext.io/how-to-build-an-event-driven-asp-net-core-microservice-architecture-e0ef2976f33f" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">如何使用事件进行微服务间的通信</strong> </a>。</p><p id="c5ce" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">我将在接下来的文章中向你展示更多的内容:Kubernetes的秘密，安全方面，如SSL、日志、调试、CI/CD、导航图、(代码)质量、(自动)伸缩和自我修复等。</p><p id="1888" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><strong class="kt ir">查看我的其他故事如何:</strong></p><ul class=""><li id="ea00" class="mn mo iq kt b ku kv kx ky ln pf lo pg lp ph lm pi mv mw mx bi translated"><a class="ae ns" rel="noopener ugc nofollow" target="_blank" href="/how-to-sign-in-with-google-in-angular-and-use-jwt-based-net-core-api-authentication-rsa-6635719fb86c">在Angular中登录Google并使用基于JWT的。使用非对称(RSA)签名令牌进行NET Core API认证</a></li><li id="79e8" class="mn mo iq kt b ku my kx mz ln na lo nb lp nc lm pi mv mw mx bi translated"><a class="ae ns" rel="noopener ugc nofollow" target="_blank" href="/how-to-jwt-authenticate-with-angular-to-an-asp-net-4cfab5298d08">使用NSwag自动生成TypeScript客户端访问. NET核心服务API，使用OpenAPI/Swagger描述API </a></li></ul><p id="f281" class="pw-post-body-paragraph kq kr iq kt b ku kv jr kw kx ky ju kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">如果您有任何问题、想法或建议，请联系我。</p></div></div>    
</body>
</html>