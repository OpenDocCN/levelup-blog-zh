<html>
<head>
<title>Multi-Omics Data Factor Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多组学数据因子分析</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/multi-omics-analysis-3857956a7a3d?source=collection_archive---------10-----------------------#2021-04-04">https://levelup.gitconnected.com/multi-omics-analysis-3857956a7a3d?source=collection_archive---------10-----------------------#2021-04-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2cf4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">精准医疗中的AI |<a class="ae kf" href="https://blackthorn.ai/" rel="noopener ugc nofollow" target="_blank">black thorn . AI</a></h2></div><blockquote class="kg kh ki"><p id="6afb" class="kj kk kl km b kn ko jr kp kq kr ju ks kt ku kv kw kx ky kz la lb lc ld le lf ij bi translated">此内容受版权保护。<br/>所有权利归Oleksandr(又名Alex) Gurbych(联系方式:<a class="ae kf" href="https://www.linkedin.com/in/ogurbych/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>，<a class="ae kf" href="http://gurbycholeksandr@gmail.com" rel="noopener ugc nofollow" target="_blank"> Gmail </a> ) <br/>在<a class="ae kf" href="https://blackthorn.ai/" rel="noopener ugc nofollow" target="_blank"> blackthorn.ai </a>查看更多相关案例</p></blockquote><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/4a837e194d114720c388f126fce643b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*Pf6ZKZ-iK-cOKJtzXd95Zg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">multі-omіcs的简要图解</figcaption></figure><h1 id="99d0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">内容</h1><ol class=""><li id="5247" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf mu mv mw mx bi translated">介绍</li><li id="953b" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">数据集描述</li><li id="b6cc" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">安装和进口</li><li id="6ed5" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">模型火车</li><li id="7d62" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">后加工</li><li id="1125" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">方差分解</li><li id="b8d1" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">因子关联分析</li><li id="0a9e" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">因子1配置文件</li><li id="48a7" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">摘要</li></ol><h1 id="8fbb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.介绍</h1><p id="133f" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">欢迎大家跨越生物科学和人工智能的多学科边界。这是一个关于multі-omіcs案例分析的实践教程。</p><p id="9249" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">分析是stаtіstіcs和dеscrіbе在观察到的较低维数的іn变量之间的一种能力。从数学上来说，因子与b {\\ F3 b {\\ F3 b {\\ F3 b {\\ F3 b {\\ F3 b {\\ F3 b {\\ F3 b {\\ F3 b {\\ F3 b {\\ F3 b }+偏差的组合有关。因子的联合变异(或缩减维度)揭示了以前未知的潜在变量的变化。这种隐变量及其协变量的发现是因子分析的主要目标。</p><p id="9204" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">下面的软件栈将被用来从一堆单组学层(观察变量)中挖掘出<strong class="km ir"> <em class="kl">生物学见解</em> </strong>(隐藏变量+它们的相关性)，放在一起成为一个<strong class="km ir"><em class="kl"/></strong>dаtа集合:</p><ul class=""><li id="70dd" class="mk ml iq km b kn ko kq kr mo ng mq nh ms ni lf nj mv mw mx bi translated">工具:<a class="ae kf" href="https://www.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> RStudio </a> (v1.4)</li><li id="94f3" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">语言:<a class="ae kf" href="https://cran.r-project.org/bin/macosx/" rel="noopener ugc nofollow" target="_blank"> R </a></li><li id="1e46" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">框架:<a class="ae kf" href="http://www.bioconductor.org/install/" rel="noopener ugc nofollow" target="_blank">生物导体</a>(3.12版)<a class="ae kf" href="https://biofam.github.io/MOFA2/installation.html" rel="noopener ugc nofollow" target="_blank"> MOFA </a> +</li></ul><p id="0712" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">如果你渴望得到提炼的结论和结果(真正的生物学见解)，跳到<strong class="km ir">摘要</strong>。</p><p id="a95c" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">欢迎在评论区提问。</p><h1 id="3bf3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.数据集描述</h1><p id="4c58" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">200名慢性淋巴细胞白血病(CLL)患者队列将用于multі-omіcs的样本。CLL在这里公开可用<a class="ae kf" href="http://bioconductor.org/packages/release/data/experiment/html/BloodCancerMultiOmics2017.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="cc81" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">CLL数据集包含4个组学:<strong class="km ir"> <em class="kl">基因组学</em> </strong>(体细胞突变)<strong class="km ir"> <em class="kl">表观基因组学</em> </strong> (DNA甲基化)<strong class="km ir"> <em class="kl">转录组学</em></strong>(RNA-seq)<strong class="km ir"><em class="kl">表型</em> </strong>(药物反应)。大约40%的特征值缺失。</p><h1 id="db77" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.安装和进口</h1><p id="86b7" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">首先安装<a class="ae kf" href="http://www.bioconductor.org/install/" rel="noopener ugc nofollow" target="_blank">生物导体</a>、<a class="ae kf" href="https://biofam.github.io/MOFA2/installation.html" rel="noopener ugc nofollow" target="_blank"> MOFA </a> +，以及其他实用程序(ggplot2、tidyverse)</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="1a3b" class="np lt iq nl b gy nq nr l ns nt">if (!requireNamespace( "BiocManager", quietly = TRUE ))<br/>    install.packages( "BiocManager" )</span><span id="21bb" class="np lt iq nl b gy nu nr l ns nt">BiocManager::install( version = "3.12" )<br/>BiocManager<strong class="nl ir">::</strong>install( "MOFA2" )<br/>BiocManager::install( "MOFAdata" )<br/>BiocManager::install( "BloodCancerMultiOmics2017" )<br/>BiocManager::install( "data.table"<!-- -->, dependencies=TRUE <!-- -->)<br/>BiocManager::install( "ggplot2"<!-- -->, dependencies=TRUE <!-- -->)<br/>BiocManager::install( "tidyverse"<!-- -->, dependencies=TRUE <!-- -->)</span></pre><p id="b9c2" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">然后，导入所需的库:</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="281b" class="np lt iq nl b gy nq nr l ns nt">library( ggplot2 )<br/>library( tidyverse )<strong class="nl ir"><br/></strong>library( data.table )<br/>library( MOFA2 )<br/>library( MOFAdata )</span></pre><p id="4d66" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">现在，导入CLL数据集。数据存储为矩阵列表，特征作为行，样本作为列。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="afbd" class="np lt iq nl b gy nq nr l ns nt">utils::data( "CLL_data" )       <br/>lapply( CLL_data, dim )</span></pre><p id="bdeb" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">让我们想象一下我们有+缺失值的行数(特征)和列数(样本)。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="5aea" class="np lt iq nl b gy nq nr l ns nt">plot_data_overview( MOFAobject )</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/c8534909c6cfa8c9b26088962046376e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-LLtxpq37r4T_-dVmzf5rw.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated"><strong class="bd lu"> D </strong>参数代表维度(有多少个特征)；<strong class="bd lu"> N </strong>代表样本数(200)；缺少的信息用灰色条表示</figcaption></figure><h1 id="8a79" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.模特培训</h1><p id="ba83" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">首先，创建一个模型对象。目前还没有训练。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="1ed4" class="np lt iq nl b gy nq nr l ns nt">MOFAobject &lt;- create_mofa( CLL_data )</span></pre><p id="8588" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">其次，设置必需的选项。点击阅读更多关于数据选项<a class="ae kf" href="https://rdrr.io/github/bioFAM/MOFA2/man/get_default_data_options.html" rel="noopener ugc nofollow" target="_blank">的信息；型号选项</a><a class="ae kf" href="https://rdrr.io/github/bioFAM/MOFA2/man/get_default_model_options.html" rel="noopener ugc nofollow" target="_blank">此处</a>；关于训练选项<a class="ae kf" href="https://rdrr.io/github/bioFAM/MOFA2/man/get_default_training_options.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="32f6" class="np lt iq nl b gy nq nr l ns nt">data_opts &lt;- get_default_data_options( MOFAobject )</span><span id="98e7" class="np lt iq nl b gy nu nr l ns nt">model_opts &lt;- get_default_model_options( MOFAobject ) model_opts$num_factors &lt;- 15</span><span id="8843" class="np lt iq nl b gy nu nr l ns nt">train_opts &lt;- get_default_training_options( MOFAobject )<br/>train_opts$seed &lt;- 1<br/>train_opts$save_interrupted &lt;- TRUE<br/>train_opts$convergence_mode &lt;- "slow"</span></pre><p id="2bf6" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">最后准备模型，训练。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="9ca3" class="np lt iq nl b gy nq nr l ns nt">MOFAobject &lt;- prepare_mofa( MOFAobject,<br/>                            training_options = train_opts,<br/>                            model_options = model_opts,<br/>                            data_options = data_opts )<br/>MOFAobject &lt;- run_mofa( MOFAobject, <br/>              outfile="/Users/ogurb/Downloads/MOFA2_CLL.hdf5" )<br/>saveRDS( MOFAobject, "MOFA2_CLL.hdf5" )</span></pre><p id="39fc" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">可能会要求您为Python解释器安装Miniconda。</p><p id="8733" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">培训以下列结果结束:</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="3c0c" class="np lt iq nl b gy nq nr l ns nt">Iteration 908: time=0.44, ELBO=-2850734.58, deltaELBO=0.197 (0.00000100%), Factors=15</span><span id="9482" class="np lt iq nl b gy nu nr l ns nt">Converged!</span></pre><h1 id="8617" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">5.后加工</h1><h2 id="bbf1" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated"><strong class="ak"> <em class="oo"> 5.1添加样本元数据</em> </strong></h2><p id="aa2f" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">元数据存储在一个<code class="fe oa ob oc nl b">data.frame</code>中。重要栏目:<strong class="km ir">年龄</strong> —以年为单位的年龄；<strong class="km ir">死亡</strong> —患者是否死亡(对/错)；<strong class="km ir">性别</strong> —男性(m)，女性(f)；<strong class="km ir">在</strong>之后接受治疗——患者是否在<strong class="km ir">之后接受治疗(</strong>对/错)。</p><p id="9dd3" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">您可以从Bioconductor包<code class="fe oa ob oc nl b">BloodCancerMultiOmics2017</code>中加载完整的元数据作为<code class="fe oa ob oc nl b">data("patmeta")</code>对象。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="dcd3" class="np lt iq nl b gy nq nr l ns nt"># Load sample metadata<br/>CLL_metadata &lt;- fread( "ftp://ftp.ebi.ac.uk/pub/databases/mofa/cll_vignette/sample_metadata.txt" )</span><span id="21cf" class="np lt iq nl b gy nu nr l ns nt"><em class="kl"># Add sample metadata to the model<br/></em>samples_metadata( MOFAobject ) &lt;- CLL_metadata</span></pre><h2 id="26a5" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated"><strong class="ak"> <em class="oo"> 5.2因素相关性分析</em> </strong></h2><p id="0e46" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">为了有一个好的模型，降维(或因子)必须不相关。如果您观察到因子之间存在显著的相互依赖性，您可能使用了太多的因子，或者标准化不够充分。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="c77e" class="np lt iq nl b gy nq nr l ns nt">plot_factor_cor( MOFAobject )</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/3ab7a8dafc9417e8fd7d7687cc349b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tDU70Lya9vSNfwrNlOJFw.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">这些因素之间没有明显的相关性，我们很好</figcaption></figure><h2 id="a423" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">结论:</h2><ul class=""><li id="682d" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf nj mv mw mx bi translated">因素显示没有显著的相关性</li></ul><h1 id="4733" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">6.方差分解</h1><h2 id="1171" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated"><strong class="ak"> <em class="oo"> 6.1按因子解释方差分解</em> </strong></h2><p id="6a81" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">解释的差异总结了观察到的因素的变化来源。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="30a9" class="np lt iq nl b gy nq nr l ns nt">plot_variance_explained( MOFAobject, <br/>                         max_r2=15 )</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/819b371681a20d845e559cdc43053988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vRr2ipU0WHy6gCB-OZtU6Q.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">按因素和数据形态解释的方差的单一数字(-组学)</figcaption></figure><h2 id="a9f6" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated"><strong class="ak">结论:</strong></h2><ul class=""><li id="be87" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf nj mv mw mx bi translated">因子1代表了所有组学模式的高度多样性。看来，它对于疾病的病因是至高无上的。</li><li id="09dc" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">因子2表达了仅与药物反应相关的非常强的差异。</li><li id="9d46" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">因子3保留了所有组学的差异，除了表观组学。</li><li id="90ea" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">因子4具有中等的mRNA方差。</li><li id="fbc5" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">因子5显示了药物反应和mRNA之间的相互依赖性。</li></ul><p id="8bc0" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">我们将省略其他成分，因为它们的方差表示得更差。</p><h2 id="ebf9" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">6.2每个组学的解释差异</h2><p id="8bac" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">解释方差是数学模型考虑数据集变化(或分散)的比率。解释方差是模型总方差的一部分，由实际存在的因素解释，而不是由误差方差引起的。</p><p id="5d87" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">方差的百分比越高，表明相关性越强。这也意味着你能做出更好的预测。</p><p id="bdee" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">让我们计算每个数据形态的解释变量:</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="5bd2" class="np lt iq nl b gy nq nr l ns nt">plot_variance_explained( MOFAobject,<br/>                         plot_total = T )[[2]]</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/be33310ac5fab0ecc6a2f1fe71ad93d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCnFW4qfv1JEfXCVi4oLFg.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">每个数据形态的总解释差异</figcaption></figure><h2 id="97e7" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated"><strong class="ak">结论:</strong></h2><p id="4ec5" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">提取15个因素解释:</p><ul class=""><li id="8734" class="mk ml iq km b kn ko kq kr mo ng mq nh ms ni lf nj mv mw mx bi translated">约53%的药效差异</li><li id="a104" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">约27%表观基因组分布变异</li><li id="d1e8" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">约42%的mRNA差异</li><li id="afed" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">约20%的突变方差</li></ul><p id="cf65" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">药物反应(~53%)和mRNA谱(~42%)在组学中表现出最大的可变性。</p><h1 id="3330" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">7.因子关联分析</h1><p id="ea19" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">让我们计算样本元数据(性别、生存结果(死亡真/假)和年龄)和因子val的相互关系:</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="17e5" class="np lt iq nl b gy nq nr l ns nt">correlate_factors_with_covariates( MOFAobject, <br/>                      covariates = c("Gender","Died","Age"), <br/>                      plot = "log_pval" )</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/593da8bb8c8e1640166f68df9fdac679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzvHE_JKcDb7TANky_RPjA.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">样本元数据与因子值之间的关联分析</figcaption></figure><h2 id="4dc1" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated"><strong class="ak">结论:</strong></h2><ul class=""><li id="c3c6" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf nj mv mw mx bi translated">大多数因素与任何协变量都没有明确的联系。</li><li id="5cec" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">与生存结果相关的因素13和15。</li></ul><p id="fbb3" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">在故事的最后，我们将回到与临床数据的关联。</p><h1 id="1b74" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">8.因子1配置文件</h1><h2 id="bc91" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">8.1因子值</h2><p id="fed6" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">因子是初始特征的线性组合，代表数据可变性的来源。在下图中，因子值位于零轴周围，因为在进行因子分析之前，数据必须居中。带有正负符号的点代表相反的表型。较大的绝对值与更明显的生物效应相关。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="d85c" class="np lt iq nl b gy nq nr l ns nt">plot_factor( MOFAobject,<br/>             color_by = "Factor1",<br/>             factors=1)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/480db65f39b33e36022abd205457b05f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D06r20SA-9L7LlAfcL9bgw.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">因子1值</figcaption></figure><h2 id="6529" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">8.2特征权重</h2><p id="3722" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">特征权重是每个特征与每个因素的相互联系的等级。较大的绝对特征权重表示特征与因子的关联较强。符号表示影响方向:正-该特征在具有正因子值的样本中表现出更大的值，等等。</p><h2 id="ae9e" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">8.3因子1体细胞突变</h2><p id="a244" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">解释方差表明因子1代表所有组学的方差。体细胞突变数据非常稀少，任何DNA编辑都会对所有后续组学层产生影响。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="1302" class="np lt iq nl b gy nq nr l ns nt">plot_weights( MOFAobject,<br/>              view = "Mutations",<br/>              factor=1,<br/>              nfeatures = 15,<em class="kl"><br/></em>              scale = T)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/009723e29dbcf44d4b75909ef81bb4b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KDwl56RhgqKbATyNaPxsNQ.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">因子1体细胞突变特征权重</figcaption></figure><h2 id="4716" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">结论:</h2><ul class=""><li id="d918" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf nj mv mw mx bi translated">大多数特征被分配在零权重垂直线周围，表明它们与Factor1没有关联</li><li id="02b4" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">免疫球蛋白重链可变区(IGHV)基因突变非常明显。我们刚刚发现<a class="ae kf" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6355490/" rel="noopener ugc nofollow" target="_blank"> <strong class="km ir">为CLL </strong> </a> <strong class="km ir">的主要临床标志。</strong></li></ul><p id="29ca" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">让我们创建一个图来显示右侧带有相应权重符号的要素:</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="77c5" class="np lt iq nl b gy nq nr l ns nt">plot_top_weights( MOFAobject,<br/>                  view = "Mutations",<br/>                  nfeatures = 15,<br/>                  scale = T,<br/>                  factor=1,<br/>                  view = "Mutations")</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/6417c7aa04db30caf453dde174503b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ACEpB-EW4iOW-ObjPSeehQ.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">因子1体细胞突变最高特征权重(alt)</figcaption></figure><p id="9ffc" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">IGHV具有正权重。<strong class="km ir"><em class="kl">Factor1值为正的样本有IGHV突变，而factor 1值为负的样本没有IGHV突变</em> </strong>。为了证实这一点，让我们绘制出因子值并给IGHV突变状态着色。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="80ff" class="np lt iq nl b gy nq nr l ns nt">plot_factor( MOFAobject,<br/>             dodge = TRUE,<br/>             add_violin = TRUE,<br/>             color_by = "IGHV",<br/>             factors=1)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/a65a0dfc69c46e8947590db3f1d7c228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FksOth-P7kNr81nxl00wCg.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">IGHV突变与因子1值的相关性</figcaption></figure><h2 id="b176" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">8.4因子1 mRNA表达</h2><p id="d0f4" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">从方差解释图中，我们知道因子1驱动所有数据形态的变化。让我们想象与因子1相关的mRNA表达变化:</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="03f5" class="np lt iq nl b gy nq nr l ns nt">plot_weights( MOFAobject,<br/>              nfeatures = 10,<br/>              view = "mRNA",<br/>              factor=1)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/c4bc8d4ace596216f204c8c686089f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JTyo2Se0uT0Hsx3Tn_WFUA.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">mRNA表达的基因权重(因子1)</figcaption></figure><h2 id="2dc4" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">结论:</h2><ul class=""><li id="9c2b" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf nj mv mw mx bi translated">存在大量具有负权重的基因(例如，ENSG00000198046)和具有正权重的基因(例如，ENSG00000168594)。</li><li id="f6c2" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf nj mv mw mx bi translated">可能，<strong class="km ir"><em class="kl">mRNA阳性表达值较大的基因在IGHV突变的样本中表达较多；具有大负值的基因在没有IGHV突变</em> </strong>的样品中表达更多</li></ul><p id="b683" class="pw-post-body-paragraph kj kk iq km b kn ko jr kp kq kr ju ks mo ku kv kw mq ky kz la ms lc ld le lf ij bi translated">让我们验证最后一个假设。</p><h2 id="a786" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">8.5因子1分子特征聚类</h2><p id="9c3b" class="pw-post-body-paragraph kj kk iq km b kn mm jr kp kq mn ju ks mo nd kv kw mq ne kz la ms nf ld le lf ij bi translated">让我们制作一个因子1值(x轴)对基因表达值(y轴)的热图。样本按IGHV状态着色——突变存在(红色)还是不存在(蓝色)。</p><pre class="lh li lj lk gt nk nl nm nn aw no bi"><span id="11a2" class="np lt iq nl b gy nq nr l ns nt">plot_data_heatmap( MOFAobject,<br/>                   scale = "row"<br/>                   cluster_cols = FALSE,<br/>                   cluster_rows = FALSE,<br/>                   show_colnames = FALSE,<br/>                   show_colnames = FALSE,<br/>                   denoise = TRUE<br/>                   features = 25,<br/>                   view = "mRNA",<br/>                   factor=1)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/ee0c980fe0ca1d5e03636ce00d8cf8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZWrC_iMhEOcgDhR2z-xGw.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">因子1基因表达聚类的去噪热图</figcaption></figure><h2 id="da6a" class="np lt iq bd lu od oe dn ly of og dp mc mo oh oi me mq oj ok mg ms ol om mi on bi translated">结论:</h2><ul class=""><li id="be8f" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf nj mv mw mx bi translated">具有不同基因表达的簇清晰可见，证明了该假设。</li></ul><h1 id="1893" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">9.摘要</h1><ol class=""><li id="3eb4" class="mk ml iq km b kn mm kq mn mo mp mq mr ms mt lf mu mv mw mx bi translated">CLL数据集包含4个组学:<strong class="km ir"> <em class="kl">基因组学</em> </strong>(体细胞突变)<strong class="km ir"> <em class="kl">表观基因组学</em> </strong> (DNA甲基化)<strong class="km ir"> <em class="kl">转录组学</em></strong>(RNA-seq)<strong class="km ir"><em class="kl">表型</em> </strong>(药物反应)；200名病人</li><li id="e719" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">15因子(降维)模型训练收敛于迭代908，ELBO=-2850734.58，deltaELBO=0.197 (0.00000100%)。因素显示没有相关性，这是好的。</li><li id="b3c8" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">累积起来，这15个因素代表了大约53%的药物反应变异，大约42%的mRNA，大约27%的DNA甲基化和大约20%的体细胞突变变异。</li><li id="7138" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">与生存结果相关的因素13和15。</li><li id="b378" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">因子1代表了所有组学模式的高度多样性。看来，它对于疾病的病因是至高无上的。因子2表达了仅与药物反应相关的非常强的差异。因子3保留了所有组学的差异，除了表观组学。因子4代表中等mRNA vаriаncе。因子5应该是药物反应和mRNA的相互依赖性。</li><li id="8d56" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated">IGHV突变存在于具有正因子1值的样本中，而不存在于具有负因子1值的样本中。</li><li id="9808" class="mk ml iq km b kn my kq mz mo na mq nb ms nc lf mu mv mw mx bi translated"><strong class="km ir"> IGHV突变被发现为</strong><a class="ae kf" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6355490/" rel="noopener ugc nofollow" target="_blank"><strong class="km ir">CLL</strong></a><strong class="km ir">的主要临床标志。</strong> IGHV生物标志物效力在多个湿式实验室实验中得到证实。</li></ol></div></div>    
</body>
</html>