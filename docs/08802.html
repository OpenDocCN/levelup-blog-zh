<html>
<head>
<title>Golang: Move The Configuration To An External File For Better Maintainability</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Golang:将配置移动到外部文件以获得更好的可维护性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/golang-move-the-configuration-to-an-external-file-for-better-maintainability-4dd258dc5612?source=collection_archive---------9-----------------------#2021-06-07">https://levelup.gitconnected.com/golang-move-the-configuration-to-an-external-file-for-better-maintainability-4dd258dc5612?source=collection_archive---------9-----------------------#2021-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5024" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">开发人员倾向于为不同的开发环境使用不同的可执行文件。这个方案将各种配置转移到一个YAML文件中，这使得维护各种环境的配置和拥有一个单独的构建变得容易。</h2></div><p id="38e1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果项目驻留在代码中，就很难管理项目的配置。在团队中工作时，开发人员会在项目中不断添加各种配置。</p><p id="aa9f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我总是把它移到一个外部文件中，以便把所有的配置保存在一个地方。这使得维护稍微容易一些，并且对于所有环境都有一个可执行文件。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/17ff1378e748a994d2af25ecf4e938d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WIG3YLCqlbLDVqdxRDtUgA.jpeg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">图片来自Pixabay</figcaption></figure><h2 id="5d42" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">在外部文件中配置的优势</h2><ul class=""><li id="a255" class="mn mo it kk b kl mp ko mq kr mr kv ms kz mt ld mu mv mw mx bi translated">可维护性</li><li id="8aec" class="mn mo it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">一个适用于所有环境的可执行文件</li><li id="f02e" class="mn mo it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">配置的改变不需要新的构建</li></ul><h2 id="7527" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">怎么会？</h2><p id="8637" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">我们将把配置转移到一个YAML文件中，用Revel和GORM构建Golang项目。</p><p id="e3f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该方案可应用于任何Golang项目。</p><p id="642e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Github项目链接:</p><div class="ng nh gp gr ni nj"><a href="https://github.com/amritsingh/golang_tutorials/tree/main/revel/config_to_yaml" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">amritsingh/golang _教程</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">在GitHub上创建一个帐户，为amritsingh/golang_tutorials开发做贡献。</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">github.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx lo nj"/></div></div></a></div><p id="7b98" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将把数据库连接字符串从<code class="fe ny nz oa ob b">conf/app.conf</code>文件移动到一个新文件<code class="fe ny nz oa ob b">config.yml</code></p><p id="03f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ny nz oa ob b">conf/app.conf</code>中的数据库连接字符串是这样的</p><pre class="lf lg lh li gt oc ob od oe aw of bi"><span id="ca2d" class="lu lv it ob b gy og oh l oi oj">...</span><span id="1d9f" class="lu lv it ob b gy ok oh l oi oj">[dev]<br/>db.info = user1:tmppwd@tcp(localhost:3306)/sampleapp?parseTime=True</span></pre><p id="09c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">删除上述两行，并将以下内容添加到<code class="fe ny nz oa ob b">config.yml</code></p><pre class="lf lg lh li gt oc ob od oe aw of bi"><span id="1b19" class="lu lv it ob b gy og oh l oi oj">db: user1:tmppwd@tcp(localhost:3306)/sampleapp?parseTime=True</span></pre><p id="4013" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们需要读取配置文件<code class="fe ny nz oa ob b">config.yml</code>。在<code class="fe ny nz oa ob b">app</code>文件夹中新建一个目录<code class="fe ny nz oa ob b">helpers</code>。在<code class="fe ny nz oa ob b">app/helpers</code>中创建一个新文件<code class="fe ny nz oa ob b">app_config.go</code></p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="c727" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的代码读取<code class="fe ny nz oa ob b">config.yml</code>文件并填充一个名为<code class="fe ny nz oa ob b">AppConfig</code>的变量。如果您希望在<code class="fe ny nz oa ob b">config.yml</code>中添加更多配置，您需要改变结构<code class="fe ny nz oa ob b">Cfg</code>。</p><p id="51f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要在项目初始化时读取配置，以便在您想要创建DB连接时可以使用配置。</p><p id="8243" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe ny nz oa ob b">app/init.go</code>中，在初始化方法中读取配置。创建数据库连接时，从<code class="fe ny nz oa ob b">AppConfig</code>中读取连接字符串。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ol om l"/></div></figure><h2 id="bff7" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">包装它</h2><p id="f7cd" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">根据我的经验，拥有一个单独的配置文件对可维护性总是有帮助的。这个概念可以应用于任何Golang项目，不管使用什么框架。最后，要看程序员更喜欢什么。</p></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><p id="df08" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ou">喜欢自己体验媒介？考虑通过注册会员</em>   <em class="ou">来支持我和其他作家</em> <a class="ae ov" href="https://singhamrit.medium.com/membership" rel="noopener"> <strong class="kk iu"> <em class="ou">。会员每月只需5美元，它支持我们，作家，没有额外的费用。如果你这样做，我会收到一部分费用，不会多花你多少钱。谢谢大家！</em></strong></a></p></div></div>    
</body>
</html>