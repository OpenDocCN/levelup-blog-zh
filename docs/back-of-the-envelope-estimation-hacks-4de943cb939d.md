# 信封背面的估算技巧

> 原文：<https://levelup.gitconnected.com/back-of-the-envelope-estimation-hacks-4de943cb939d>

有两种类型的工程师，一种可以快速地做估算，另一种不能。这些人只是更聪明，还是另有隐情？

![](img/25a0c656e93fc106a3ab9503a2b6657e.png)

[](https://en.wikipedia.org/wiki/Fermi_problem)**估计是个高手**

*信封背面的估计是一项可以通过实践学习的技能。一旦你熟悉了这个行业的一些窍门，事情就变得容易多了。*

# *了解你的数字*

*你从磁盘上读取数据的速度有多快？多快脱离网络？您应该熟悉您的组件的大致性能数据。重要的不是确切的数字本身，而是它们在数量级上的相对差异。*

# *接近幂*

*评估的目标不是得到一个正确的答案，而是得到一个正确的范围。使用 2 或 10 的幂使得乘法非常容易，因为在对数空间中，乘法变成加法。*

*例如，假设你有 80 万用户在 UHD 以 12 Mbps 的速度观看视频。您的内容交付网络中的机器可以 1 Gbps 的速率输出。你需要多少台机器？*

*使用 10⁶大约 800K，使用 10⁷ Mbps 大约 12 Mbps，产量:*

*![](img/8a2515fa4618b56323b83db2fb2e150b.png)*

*将 6 和 7 相加，然后从中减去 9，这比试图得到准确的答案要容易得多:*

*![](img/da85444fcaf3046a6e2307a446eeac25.png)*

*区别真的重要吗？不尽然；确切的答案反正也不确切。用户随时间变化，网络带宽不是恒定的，等等。*

# *72 法则*

*[72](https://web.stanford.edu/class/ee204/TheRuleof72.html)法则是一种估算一个量如果以一定的百分比率增长需要多长时间才能翻倍的方法。*

*![](img/e6523aff2b1d4908f485600a15fbc638.png)*

*例如，假设您的 web 服务的流量以大约每周 10%的速度增长，需要多长时间才能翻倍？*

*![](img/60296ecb70db4981ae00d63631d3c635.png)*

*流量翻倍大约需要 7 周时间。*

*如果把 72 的法则和 2 的幂结合起来，那么就可以很快算出一个量增加几个数量级需要多长时间。*

# *利特尔定律*

*队列可以用三个参数来建模:*

*   *新项目到达的平均速率， *λ* ，*
*   *项目在队列中花费的平均时间，*
*   *以及队列中的平均项目数， *L* 。*

*许多事情可以被建模为队列。例如，web 服务可以被视为一个队列。请求速率是新项目到达的速率。处理一个请求所花费的时间就是一个项目在队列中花费的时间。最后，并发处理的请求数就是队列中的项目数。*

*如果能从另外两个参数中推导出三个参数中的一个，岂不是很棒？原来这三个量之间有一个相互联系的定律！它叫做[利特尔定律](https://en.wikipedia.org/wiki/Little%27s_law):*

*![](img/cf3e6b9668de9f9c744ab308e0127395.png)*

*它说的是队列中的平均项目数等于新项目到达的平均速率乘以项目在队列中花费的平均时间。*

*让我们试一试。假设您有一个平均需要 100 毫秒来处理请求的服务。它目前每秒接收大约 200 万个请求。同时处理多少个请求？*

*![](img/0b2d948f2e58780fc6ca00f34c6eb99e.png)*

*该服务同时处理 20 万个请求。如果每个请求都是 CPU 密集型的，并且需要一个线程，那么我们将需要大约 20 万个线程。如果我们使用 8 个核心机器，那么要跟上，我们将需要大约 25K 台机器。*

# *记住这个*

*评估是工程师的一项重要技能。通过练习和使用我在这篇文章中介绍的技巧，你可以做得更好:*

*   *熟悉您的组件的性能数据。*
*   *用 2 或 10 的幂近似，将乘法转换成加法。*
*   *使用 72 法则，找出给定增长率下一个量翻倍需要多长时间。*
*   *将您的系统建模为队列，并利用利特尔法则。*

*如果你想了解更多关于设计大规模系统的知识，请查阅我的[分布式系统书](http://understandingdistributed.systems/)。*

*【https://robertovitillo.com】最初发表于[](https://robertovitillo.com/back-of-the-envelope-estimation-hacks/)**。***