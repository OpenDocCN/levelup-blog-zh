<html>
<head>
<title>Turn Your Google Sheet Into a Web Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">把你的谷歌表单变成一个网络应用</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/turn-your-google-sheet-into-a-web-application-f766f1ff8b98?source=collection_archive---------0-----------------------#2020-11-23">https://levelup.gitconnected.com/turn-your-google-sheet-into-a-web-application-f766f1ff8b98?source=collection_archive---------0-----------------------#2020-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3ea7d5504aea5c62bf4d9f469f824462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jl1KO15ITrR05EhdFboMEA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Samuel Sianipar 在<a class="ae kc" href="https://unsplash.com/s/photos/excel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="ceed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当与<a class="ae kc" href="https://developers.google.com/apps-script" rel="noopener ugc nofollow" target="_blank"> Apps脚本</a>结合使用时，Google Sheets会是一个非常强大的工具。应用程序脚本类似于MS Excel中的宏，但有更多的可扩展性。</p><p id="f4aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">想象一下，您有一个电子商务网站，您需要一个电子表格在下订单时更新。你可以使用API在固定的时间间隔提取数据，但是一个更简洁的方法是使用Google Sheets作为网络服务器或者一个<a class="ae kc" href="https://en.wikipedia.org/wiki/Webhook" rel="noopener ugc nofollow" target="_blank">网络钩子</a>。</p><p id="0d4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将向您展示如何将您的Google Sheet转换成一个web应用程序来捕获数据并填充表单。这是使用类似于<a class="ae kc" href="https://zapier.com/" rel="noopener ugc nofollow" target="_blank"> Zapier </a>的工具的免费替代品，但是需要一些编码经验。</p><h1 id="be42" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">先决条件</h1><ul class=""><li id="8689" class="lz ma iq kf b kg mb kk mc ko md ks me kw mf la mg mh mi mj bi translated">基本了解web服务(<code class="fe mk ml mm mn b">GET</code> &amp; <code class="fe mk ml mm mn b">POST</code>请求)。</li><li id="9138" class="lz ma iq kf b kg mo kk mp ko mq ks mr kw ms la mg mh mi mj bi translated">JSON的基础知识。</li><li id="b7d0" class="lz ma iq kf b kg mo kk mp ko mq ks mr kw ms la mg mh mi mj bi translated">最低限度的Javascript经验。</li></ul><h1 id="fe31" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">设置表单</h1><p id="ee57" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">我们需要设置的第一件事是我们将用来捕获数据的表。</p><p id="3418" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">导航到<em class="mw">工具- &gt;脚本编辑器</em>。这将为应用程序脚本编辑器打开一个新标签。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/e3a4e6d462b9466362d8173893430be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*M-bxXuhEn4U1tYbcT2aT7g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">脚本编辑器</figcaption></figure></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="6e63" class="lb lc iq bd ld le nj lg lh li nk lk ll lm nl lo lp lq nm ls lt lu nn lw lx ly bi translated">创建Web服务器</h1><p id="e9c6" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">为了收集数据，我们需要能够捕获数据源发送的<code class="fe mk ml mm mn b">GET</code>或<code class="fe mk ml mm mn b">POST</code>请求。为此，我们可以使用<code class="fe mk ml mm mn b">doGet</code>和<code class="fe mk ml mm mn b">doPost</code>功能。以下是包含这两个函数的示例代码:</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">样本函数</figcaption></figure><p id="b8c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在“应用程序脚本”选项卡中将代码添加到Code.js文件中。代码很简单。<code class="fe mk ml mm mn b">doGet</code>和<code class="fe mk ml mm mn b">doPost</code>函数分别用于处理<code class="fe mk ml mm mn b">GET</code>和<code class="fe mk ml mm mn b">POST</code>请求。</p><p id="b10d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大多数时候，数据是作为POST请求发送的，所以我将重点放在<code class="fe mk ml mm mn b">doPost</code>函数上。<code class="fe mk ml mm mn b">doPost</code>函数使用来自请求体(<code class="fe mk ml mm mn b">e.postData.contents</code>)的<code class="fe mk ml mm mn b">JSON.parse()</code>解析JSON数据，并将我需要的数据添加到工作表中。</p><blockquote class="nq nr ns"><p id="86f2" class="kd ke mw kf b kg kh ki kj kk kl km kn nt kp kq kr nu kt ku kv nv kx ky kz la ij bi translated">应用程序脚本也可以解析CSV和XML数据。</p></blockquote><p id="b262" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们需要一个URL来发送请求。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="774d" class="lb lc iq bd ld le nj lg lh li nk lk ll lm nl lo lp lq nm ls lt lu nn lw lx ly bi translated">部署Web应用程序</h1><p id="731b" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在应用程序脚本选项卡上导航到<em class="mw">发布- &gt;部署为web应用程序… </em>。</p><p id="3995" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">几秒钟后，会弹出一个菜单:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/7d454987fb448e3e1d7c388cdf2401d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*Mfay6ukjZ9xdprucREu4ng.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">部署为web应用程序屏幕</figcaption></figure><p id="13e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">web应用程序的URL将列在顶部。<strong class="kf ir">复制它</strong>。每个部署的URL将保持不变。</p><p id="764f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每当您更改代码并部署新版本时，将项目版本设置为<em class="mw"> New </em>。</p><p id="64ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设置<em class="mw">执行app为</em>到<em class="mw"> Me </em>。</p><p id="c9d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后一个字段是有权访问应用程序的<em class="mw">。将此设置为<em class="mw">任何人，甚至匿名</em>。</em></p><blockquote class="nq nr ns"><p id="7229" class="kd ke mw kf b kg kh ki kj kk kl km kn nt kp kq kr nu kt ku kv nv kx ky kz la ij bi translated">这将允许任何拥有web应用程序URL的人向其发送请求。你总是可以用<a class="ae kc" href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script#requiredparameters" rel="noopener ugc nofollow" target="_blank">令牌认证</a>来保护它。</p></blockquote><p id="0372" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成后，点击<em class="mw">更新</em>按钮。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="f0e3" class="lb lc iq bd ld le nj lg lh li nk lk ll lm nl lo lp lq nm ls lt lu nn lw lx ly bi translated">测试功能</h1><p id="98cb" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">要测试您是否正确设置了应用程序脚本，只需复制上一步生成的URL，并在浏览器中打开它。<code class="fe mk ml mm mn b">doGet</code>函数返回如下响应:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/7175d625f3b2cd99566547e1fdd02c5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*OInr5B16Pvn9BFL3HNXK5g.png"/></div></figure><blockquote class="nq nr ns"><p id="a6a3" class="kd ke mw kf b kg kh ki kj kk kl km kn nt kp kq kr nu kt ku kv nv kx ky kz la ij bi translated">如果页面没有打开或要求您登录，请确保您的代码是正确的，并且您已经使用上述配置部署了Apps脚本。</p></blockquote><p id="bc90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了测试<code class="fe mk ml mm mn b">doPost</code>函数，我将使用<a class="ae kc" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>向URL发送几个<code class="fe mk ml mm mn b">POST</code>请求。这是我将使用的样本数据:</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="154e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在下面的GIF中看到，当我发送<code class="fe mk ml mm mn b">POST</code>请求时，<em class="mw">实时订单</em>表会自动更新。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/b16c53aa8789400f95f179d44e40413f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SrfFQjnwQGxY4WWuyeo2gw.gif"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">实时订单</figcaption></figure><p id="f2cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我可以将URL作为webhook添加到我的电子商务网站，以便实时收集订单数据。</p><p id="571a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这方面的应用是无限的。这是我创建的另一个表，显示来自各种传感器的温度和湿度数据的实时图表。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/f266fb81f9f642057a5217785ea32317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*kbnH-eRyk6bzEUSp19zH1w.gif"/></div></div></figure><p id="c86e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用Google Sheets的最大优势是它的简单性，即使对于非技术用户来说也是如此。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="8963" class="lb lc iq bd ld le nj lg lh li nk lk ll lm nl lo lp lq nm ls lt lu nn lw lx ly bi translated">限制</h1><p id="a1eb" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">谷歌应用程序脚本有<a class="ae kc" href="https://developers.google.com/apps-script/guides/services/quotas" rel="noopener ugc nofollow" target="_blank">配额</a>取决于你的谷歌账户类型。(消费者(免费用户)、G套件、G套件业务)。</p><p id="ce8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Apps脚本的运行时间限制被设置为每次调用6分钟 &amp; <em class="mw"> 50 MB </em>数据<em class="mw">——这意味着你不能向它发送大数据块。</em></p><p id="f17b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于一个<strong class="kf ir">免费用户</strong>来说，请求的数量也被限制为每天<strong class="kf ir"> <em class="mw"> 20，000个</em> </strong>，对于一个<strong class="kf ir"> G套件用户</strong>来说，请求的数量被限制为每天<strong class="kf ir"> <em class="mw"> 100，000个</em> </strong>，这对于大多数用例来说已经足够了。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="5c4b" class="lb lc iq bd ld le nj lg lh li nk lk ll lm nl lo lp lq nm ls lt lu nn lw lx ly bi translated">结论</h1><p id="4b2b" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在本文中，我们看到了如何将Google Sheets用作简单的web服务器&amp;如何用POST请求数据填充表单。您也可以将此功能用于其他服务，如Google Docs、Slides等。</p><p id="0d46" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据您的用例，您可以使用Google Sheets创建一个带有可视化功能的全面的实时仪表板。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="0681" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">后续文章:<a class="ae kc" href="https://medium.com/gitconnected/how-to-call-apis-directly-from-google-sheets-6e3d25c42e09" rel="noopener">https://medium . com/git connected/how-to-call-APIs-direct-from-Google-sheets-6e 3d 25 c 42 e 09</a></p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="c197" class="lb lc iq bd ld le nj lg lh li nk lk ll lm nl lo lp lq nm ls lt lu nn lw lx ly bi translated">有用的链接</h1><div class="oa ob gp gr oc od"><a href="https://developers.google.com/apps-script/quickstart/fundamentals-codelabs" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">Codelabs:应用程序脚本基础| Google开发者</h2><div class="ok l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">developers.google.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq jw od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://developers.google.com/apps-script/guides/web" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">Web应用程序|应用程序脚本| Google开发者</h2><div class="or l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">如果您为脚本构建了用户界面，则可以将脚本发布为web应用程序。例如，一个脚本可以让…</h3></div><div class="ok l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">developers.google.com</p></div></div><div class="ol l"><div class="os l on oo op ol oq jw od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://github.com/tanaikech/taking-advantage-of-Web-Apps-with-google-apps-script#accesstokenforaccessingtowebapps" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">tanaikech/使用google-apps脚本利用Web-Apps</h2><div class="or l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">这是一份利用谷歌应用程序脚本(GAS)的网络应用程序的报告。有Web应用程序作为应用程序之一…</h3></div><div class="ok l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="ol l"><div class="ot l on oo op ol oq jw od"/></div></div></a></div></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="d783" class="lb lc iq bd ld le nj lg lh li nk lk ll lm nl lo lp lq nm ls lt lu nn lw lx ly bi translated">分级编码</h1><p id="e22f" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">感谢您成为我们社区的一员！<a class="ae kc" href="https://www.youtube.com/channel/UC3v9kBR_ab4UHXXdknz8Fbg?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a>或者加入<a class="ae kc" href="https://skilled.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> Skilled.dev编码面试课程</strong> </a>。</p><div class="oa ob gp gr oc od"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">编写面试问题+获得开发工作</h2><div class="or l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">掌握编码面试的过程</h3></div><div class="ok l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">技术开发</p></div></div><div class="ol l"><div class="ou l on oo op ol oq jw od"/></div></div></a></div></div></div>    
</body>
</html>