<html>
<head>
<title>Universally Unique Identifiers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通用唯一标识符</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/universally-unique-identifiers-f8c3956efed6?source=collection_archive---------10-----------------------#2021-12-29">https://levelup.gitconnected.com/universally-unique-identifiers-f8c3956efed6?source=collection_archive---------10-----------------------#2021-12-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/46ba42166b77fbac919ecd2a31d3bd87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OV_lXWEZnG1A-xfRF8KVgA.jpeg"/></div></div></figure><p id="caee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通用唯一标识符(UUIDs)是128位唯一标识符，用于在计算系统中标记信息。UUIDs不需要由中央系统生成，并且保持低冲突概率。这些特性使它们成为苹果、HubSpot和微软的数据库关键字、网络分析和硬件的有用标识符。本出版物涵盖了微软、<a class="ae kw" href="https://datatracker.ietf.org/doc/html/rfc4122" rel="noopener ugc nofollow" target="_blank"> Leach等人在RCF 4122中提出的规范。</a></p><p id="19b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">举例:</strong></p><p id="9363" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kx ky kz la b">787bce4a-6865-11ec-a24f-38f9d34e0805</code></p><p id="eb15" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最流行的UUID版本是使用伪随机数生成器生成的，而其他UUID版本通过在UUID中包含时间戳、节点或哈希网络信息来降低熵。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="3294" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">结构</h1><p id="14e3" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">UUIDs由16个八位字节组成，为<code class="fe kx ky kz la b">version</code>和<code class="fe kx ky kz la b">variant</code>保留了位。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h2 id="de8c" class="mr lj iq bd lk ms mt dn lo mu mv dp ls kj mw mx lw kn my mz ma kr na nb me nc bi translated">版本</h2><p id="a3bb" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">版本号位于<strong class="ka ir"> time_hi_version </strong>字段的最高4位。</p><p id="4eb8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">版本1和版本2 </strong></p><p id="4a14" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">版本1使用包含时间戳、时钟序列和系统节点的确定性过程来生成无冲突UUID。这是UUID最受欢迎的版本。版本2用本地域标识符替换了40位时间信息。</p><p id="30b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">版本3和版本5 </strong></p><p id="daa1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第3版和第5版通过分别使用MD5和SHA-1对名称空间进行哈希运算来生成UUID。</p><p id="6d77" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">版本4 </strong></p><p id="eb43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用122位生成随机UUID。其余6位保留给版本和变体。</p><p id="1502" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们的例子中，<code class="fe kx ky kz la b">[1]1ec</code>的msb 0–4是<code class="fe kx ky kz la b">0001</code>，所以它是版本1 UUID。</p><h2 id="c62f" class="mr lj iq bd lk ms mt dn lo mu mv dp ls kj mw mx lw kn my mz ma kr na nb me nc bi translated">不同的</h2><p id="c1a6" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">变量字段决定了UUID的布局。它是<strong class="ka ir"> clock_seq_hi_variant </strong>域的最高有效位3位。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="0438" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们的例子中，<code class="fe kx ky kz la b">[a]24f</code>的msb 0–3是<code class="fe kx ky kz la b">1010</code>，所以它是变体1 UUID。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="eb95" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是一个python脚本，它打印了任何UUID的版本和变体。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="08e6" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">冲突</h1><p id="a89b" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">当同一个UUID生成两次时，就会发生冲突。了解每个版本中的冲突概率可以决定最适合您的服务的版本。以docker容器使用内核熵生成版本4 UUIDs(伪随机数生成器)为例。版本4 UUIDs中的冲突概率是使用<a class="ae kw" href="https://en.wikipedia.org/wiki/Birthday_problem" rel="noopener ugc nofollow" target="_blank">生日问题</a>得出的。很有可能出现重复，或者更糟，耗尽熵。或者，第1版和第2版牺牲了48位熵，在UUID代中包含了主机的MAC地址。这种空间减少是否会影响UUID的生成，可能应该在更改任何代码之前进行测试。</p><p id="7847" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，如果在应用程序的生命周期中冲突的概率增加，那么UUID生成过程就有可能无法满足需求。如果冲突对应用程序至关重要，那么添加错误处理和指标以生成新的UUID并跟踪冲突计数也很重要。</p></div></div>    
</body>
</html>