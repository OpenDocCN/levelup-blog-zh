<html>
<head>
<title>A Table with Expandable and Collapsible Rows Using Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有可展开和可折叠行的表格，使用角</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-table-with-expandable-and-collapsible-rows-using-angular-59af3bdd8fd1?source=collection_archive---------0-----------------------#2022-05-23">https://levelup.gitconnected.com/a-table-with-expandable-and-collapsible-rows-using-angular-59af3bdd8fd1?source=collection_archive---------0-----------------------#2022-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/59535b75e9c830b59942a3aecdce7feb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*UjlzccJcz4TpVizoLtD5Qw.png"/></div></figure><p id="eee6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在本文中，我将向您介绍如何在Angular中创建了一个具有可展开和可折叠行的表。我写这篇文章的动机是基于我在尝试为一个项目创建这样一个表时的个人经历。我在Angular文档中找到了一些代码示例，但是没有很多关于事情如何工作的解释。因此，我发现自己在看这个例子时有点困惑，不确定如何将这些信息应用到我的用例中。</p><p id="3743" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">经过大量的实验、反复试验以及我能找到的其他一些例子，我找到了一个符合我需要的解决方案。我希望这篇文章能够很好地解释如何在Angular中构建一个包含可展开和可折叠行的表。</p><p id="e9fe" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">希望使用具有可扩展行的表的一个原因是，如果您想显示大量数据，但又不想一次显示所有数据而让人不知所措。表格行的外部可以作为标题，而可扩展部分在单击时可以作为包含您想要有条件显示的附加详细信息的部分。</p><p id="5719" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">对于这个演示，我决定使用开源的fan制造的Elden Ring API来填充我们将在示例中看到的表格(<a class="ae kv" href="https://eldenring.fanapis.com/" rel="noopener ugc nofollow" target="_blank">https://eldenring.fanapis.com/</a>)。这个例子的存储库可以在<a class="ae kv" href="https://github.com/mwiginton/angular-table-expand-collapse-example" rel="noopener ugc nofollow" target="_blank">这里</a>找到。现在让我们看看如何创建这样一个例子，以及它是如何工作的。</p><h2 id="64c1" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">新项目设置</h2><p id="d5cf" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">你要做的第一件事是创建一个新的角度项目。您可以通过运行下面的命令<code class="fe lu lv lw lx b">ng new angular-expand-collapse-example</code>来做到这一点。你可以给你的项目起任何你喜欢的名字。在我们的例子中，我们的项目名为<code class="fe lu lv lw lx b">angular-table-expand-collapse-example</code></p><p id="f56f" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">一旦您的项目被创建，通过执行命令<code class="fe lu lv lw lx b">cd angular-expand-collapse-example</code>导航到您的项目目录。在此目录中，您将需要安装Angular material和Angular animations依赖项，因为我们需要这两者来创建我们的表格以及用于展开和折叠行的动画。</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="529b" class="kw kx it lx b gy mg mh l mi mj">npm install --save @angular/material<br/>npm install --save @angular/animations</span></pre><p id="28e4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">一旦成功安装了这些依赖项，您就可以将<code class="fe lu lv lw lx b">BrowserAnimationModule</code>导入到您的<code class="fe lu lv lw lx b">app.module.ts</code>文件中。我们稍后将把<code class="fe lu lv lw lx b">MatTableModule</code>导入到我们将要创建的一个单独的模块中。</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="beac" class="kw kx it lx b gy mg mh l mi mj">import {BrowserAnimationsModule} from '@angular/platform-browser/animations';</span><span id="a261" class="kw kx it lx b gy mk mh l mi mj">@NgModule({<br/>...<br/>  imports: [BrowserAnimationsModule],<br/>...<br/>})<br/>export class AppModule { }</span></pre><h2 id="7041" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">设置我们的组件和模块</h2><p id="ddb5" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">我们项目的下一步将是创建组件，我们将在其中创建我们的表。我在子目录<code class="fe lu lv lw lx b">pages</code>中创建了我的组件，但是它可以创建在最适合你的任何结构中。我们通过执行下面的命令<code class="fe lu lv lw lx b">ng generate component pages/table-expand-collapse</code>生成一个组件</p><p id="4cb4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">创建组件后，我们将为该组件创建一个新模块。在这种情况下，模块名的标题是<code class="fe lu lv lw lx b">table-expand-collapse.module.ts</code>，它和组件一起位于我们的<code class="fe lu lv lw lx b">table-expand-collapse</code>目录中。在这个模块中我们还可以导入我们的<code class="fe lu lv lw lx b">MatTableModule</code>。新创建的模块将如下所示</p><figure class="ly lz ma mb gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h2 id="77d1" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">设置基本路由</h2><p id="acd9" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">现在我们已经为组件创建了一个模块，让我们来设置基本的路由功能。在我们的<code class="fe lu lv lw lx b">app</code>目录中，我们可以创建我们的<code class="fe lu lv lw lx b">app-routing.module.ts</code>文件，如下例所示。</p><figure class="ly lz ma mb gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="9cd5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">然后我们的<code class="fe lu lv lw lx b">AppRoutingModule</code>需要被导入到我们的<code class="fe lu lv lw lx b">app.module.ts</code>中</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="235a" class="kw kx it lx b gy mg mh l mi mj">import { AppRoutingModule } from './app-routing.module';</span><span id="4707" class="kw kx it lx b gy mk mh l mi mj">@NgModule({<br/>...<br/>  imports: [<!-- -->AppRoutingModule<!-- -->],<br/>...<br/>})<br/>export class AppModule { }</span></pre><p id="830c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们的下一步是为我们的<code class="fe lu lv lw lx b">TableExpandCollapseComponent</code>创建路由模块。本例中的文件名为<code class="fe lu lv lw lx b">table-expand-collapse-routing.module.ts</code>，如下所示</p><figure class="ly lz ma mb gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="c250" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">配置路由的最后步骤是将我们的<code class="fe lu lv lw lx b">TableExpandCollapseRoutingModule</code>导入到我们的<code class="fe lu lv lw lx b">TableExpandCollapseModule</code>中，如下所示</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="5955" class="kw kx it lx b gy mg mh l mi mj">import { TableExpandCollapseRoutingModule } from './table-expand-collapse-routing.module';</span><span id="b4bc" class="kw kx it lx b gy mk mh l mi mj">@NgModule({<br/>...<br/>  imports: [<!-- -->TableExpandCollapseRoutingModule<!-- -->],<br/>...<br/>})<br/>export class <!-- -->TableExpandCollapseModule<!-- -->{ }</span></pre><p id="24c4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">最后，在我们的<code class="fe lu lv lw lx b">app.component.html</code>文件中，删除所有的样板文件内容，只包含下面的<code class="fe lu lv lw lx b">&lt;router-outlet&gt;&lt;/router-outlet&gt;</code></p><h2 id="33db" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">创建我们的服务类</h2><p id="c00e" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">在开始设置我们的表之前，我们需要执行的最后一步是创建我们的服务类。我们的服务类是我们消费API的地方，API最终获取我们将用来填充表的数据。我们在这种情况下使用的API是前面提到的fan制造的开源Elden Ring API，我们将使用它来检索Elden Ring中的bosses列表，以显示在我们的表中。在我们的例子中，我们的服务类创建在子目录<code class="fe lu lv lw lx b">services</code>中。我们可以通过执行下面的命令<code class="fe lu lv lw lx b">ng generate service services/table</code>来生成一个新服务</p><p id="0eea" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在我们的<code class="fe lu lv lw lx b">TableService</code>类中，我们可以创建我们的函数<code class="fe lu lv lw lx b">getBosses()</code>，它将使用我们的API来检索Elden Ring bosses的列表。我们演示中的服务将如下所示</p><figure class="ly lz ma mb gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="6006" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">您会注意到，为了发出http请求，我们需要在服务文件中导入<code class="fe lu lv lw lx b">HttpClient</code>。我们还需要在我们的<code class="fe lu lv lw lx b">AppModule</code>中导入<code class="fe lu lv lw lx b">HttpClientModule </code></p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="7e8f" class="kw kx it lx b gy mg mh l mi mj">import { HttpClientModule } from '@angular/common/http';</span><span id="2dce" class="kw kx it lx b gy mk mh l mi mj">@NgModule({<br/>...<br/>  imports: [<!-- -->HttpClientModule<!-- -->],<br/>...<br/>})<br/>export class AppModule { }</span></pre><h2 id="2293" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">创建我们的表</h2><p id="7058" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">现在我们已经有了一个包含路由、组件和服务的基本项目，我们现在可以处理逻辑来创建我们的表。在我们的<code class="fe lu lv lw lx b">table-expand-collapse.component.html</code>文件中，我们可以看到负责在网页上呈现和显示表格的html代码。在文件的最上面，我们的表是用<code class="fe lu lv lw lx b">mat-table</code>定义的，让我们知道这是一个有角度的材料表。接下来我们可以看到我们的<code class="fe lu lv lw lx b">dataSource</code>，它包含了用来填充我们的表的数据。您将在我们的表定义顶部看到的最后一个关键字是<code class="fe lu lv lw lx b">multiTemplateDataRows</code>。这让我们知道，我们的表中将有一个可扩展行部分。全表定义:<code class="fe lu lv lw lx b">&lt;table mat-table [dataSource]=”bossesDataSource” multiTemplateDataRows&gt;&lt;/table&gt;</code></p><p id="8445" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">接下来让我们看看这个<code class="fe lu lv lw lx b">table table-expand-collapse-component.ts</code>的组件文件。在我们文件的第10行，我们定义了一个包含触发器定义<code class="fe lu lv lw lx b">detailExpand</code>的<code class="fe lu lv lw lx b">animations</code>属性。这个触发器负责跟踪一个元素是否被展开。</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="b2da" class="kw kx it lx b gy mg mh l mi mj">animations: [<br/>   trigger('detailExpand', [<br/>   state('collapsed', style({height: '0px', minHeight: '0'})),<br/>   state('expanded', style({height: '*'})),<br/>   transition('expanded &lt;=&gt; collapsed', animate('225ms cubic<br/>     bezier(0.4, 0.0, 0.2, 1)')),<br/>   ]),<br/>]</span></pre><p id="ceb4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">从这个文件的第20行开始，我们声明了一个数组<code class="fe lu lv lw lx b">bossColumns</code>。这是一个数组，包含我们的表的列定义。在我们的例子中，我们的表将有两列:一个<code class="fe lu lv lw lx b">name</code>列和一个<code class="fe lu lv lw lx b">region</code>列。接下来我们声明一个数组<code class="fe lu lv lw lx b">bosses</code>，它将负责存储API响应，我们将使用它来显示我们的表数据。我们最后的声明是我们的<code class="fe lu lv lw lx b">bossesDataSource</code>。这将负责存储我们的<code class="fe lu lv lw lx b">bosses</code>数组的内容，然后使这些信息在我们的表中可见。</p><p id="590d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在让我们看看我们的<code class="fe lu lv lw lx b">ngOnInit()</code>方法，一旦页面加载，这个方法就会被调用。你可以看到在这个函数中，我们调用了函数<code class="fe lu lv lw lx b">getBosses()</code>。这个函数负责调用我们的API，将我们的API调用的响应存储到我们的bosses数组中，然后初始化我们的<code class="fe lu lv lw lx b">bossesDataSource</code>以包含这个数组的内容。您会注意到，在我们的示例中，我们的API返回了106个结果，但是为了保持简单，我们只是过滤了我们的API响应，以包括5个适当名称的bosses。一旦我们有了包含5个元素的bosses数组，我们就可以使用<code class="fe lu lv lw lx b">map</code>函数为数组中的每个元素添加一个<code class="fe lu lv lw lx b">isExpanded</code>属性。这将用于跟踪一个元素是否被展开。</p><figure class="ly lz ma mb gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="039a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">既然我们已经检查完了我们的组件，让我们跳回到我们的html文件，看看表中的其余内容。您将看到，在定义了我们的表之后，我们接下来根据组件中定义的列名的字符串数组来定义表中的每一列。列定义的一个例子如下:</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="a49a" class="kw kx it lx b gy mg mh l mi mj">&lt;ng-container matColumnDef="name"&gt;<br/>   &lt;th mat-header-cell *matHeaderCellDef&gt;Name&lt;/th&gt;<br/>   &lt;td mat-cell *matCellDef="let boss"&gt;<br/>      &lt;span&gt;{{ boss.name }}&lt;/span&gt;<br/>   &lt;/td&gt;<br/>&lt;/ng-container&gt;</span></pre><p id="9f94" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在我们声明了每个表行之后，我们接着声明由<code class="fe lu lv lw lx b">expandedDetail</code>定义的扩展列。单击并展开该行后，将显示附加信息。您还会注意到，这是我们引用组件中定义的<code class="fe lu lv lw lx b">detailExpand</code>触发器的地方。</p><figure class="ly lz ma mb gt ju"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="a583" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">既然我们已经定义了列以及它们将包含的所有数据，现在我们可以定义将显示列标题的行:</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="3542" class="kw kx it lx b gy mg mh l mi mj">&lt;tr mat-header-row *matHeaderRowDef="bossColumns"&gt;&lt;/tr&gt;</span></pre><p id="0eac" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">然后我们可以定义显示所有实际数据的行。这还将包含我们的<code class="fe lu lv lw lx b">(click)</code>事件，该事件将根据当前状态展开或折叠行:</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="951f" class="kw kx it lx b gy mg mh l mi mj">&lt;tr mat-row *matRowDef="let boss; columns: bossColumns;"<br/>   class="example-element-row"<br/>   [class.example-expanded-row]="boss.isExpanded"<br/>   (click)="boss.isExpanded = !boss.isExpanded"&gt;<br/>&lt;/tr&gt;</span></pre><p id="b326" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">最后一个行定义将负责在我们的<code class="fe lu lv lw lx b">expandedDetail</code>中显示信息:</p><pre class="ly lz ma mb gt mc lx md me aw mf bi"><span id="4b5f" class="kw kx it lx b gy mg mh l mi mj">&lt;tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"&gt;&lt;/tr&gt;</span></pre><h2 id="d272" class="kw kx it bd ky kz la dn lb lc ld dp le ki lf lg lh km li lj lk kq ll lm ln lo bi translated">包扎</h2><p id="1a24" class="pw-post-body-paragraph jx jy it jz b ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq lt ks kt ku im bi translated">在本例中，创建包含可展开和可折叠行的表所需的步骤到此结束。页面第一次加载时，最终产品将如下所示:</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/dc2afcacdf5e459a7ab753dffd56828b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*i5k-joM5TPhdizGZz4x6yA.gif"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">带有可展开和可折叠行的表格的现场演示</figcaption></figure><p id="dd62" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我希望这个例子对任何在类似问题上需要帮助的人有所帮助。欢迎分享任何关于如何改进该示例的反馈。原始文件:<a class="ae kv" href="https://material.angular.io/components/table/examples" rel="noopener ugc nofollow" target="_blank">https://material.angular.io/components/table/examples</a></p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="fa9a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="mz">如果你喜欢阅读这篇文章，请考虑使用</em> <a class="ae kv" href="https://medium.com/@michelle.wiginton00/membership" rel="noopener"> <em class="mz">我的推荐链接</em> </a> <em class="mz">注册Medium。这种订阅保证了可以无限制地访问我的文章以及其他许多学科的数千名天才作家的文章。</em></p></div></div>    
</body>
</html>