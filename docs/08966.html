<html>
<head>
<title>A flexible open-source attack simulation framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个灵活的开源攻击模拟框架</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-flexible-open-source-attack-simulation-framework-e273dcd8de34?source=collection_archive---------19-----------------------#2021-06-22">https://levelup.gitconnected.com/a-flexible-open-source-attack-simulation-framework-e273dcd8de34?source=collection_archive---------19-----------------------#2021-06-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/91e1e86ea6dcd55bc0c4f768281c5abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9g77rqNq990XziNT4n8U4w.png"/></div></div></figure><p id="8817" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于应用程序<br/>开发和系统分析来说，威胁建模变得越来越普遍。然而，大多数威胁建模<br/>方法仍然是高度手动的。也就是说，你必须弄清楚<br/>你正在分析的系统是什么样的，以及哪些类型的威胁<br/>需要缓解。对于正在开发的小型应用程序来说，这可能是一项有用的活动，但是对于大型系统来说，这是不可伸缩的。</p><p id="d8aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了创建一个现有系统的模型，建议根据可用的数据源来做这件事<br/>，例如网络和漏洞<br/>扫描器、防火墙规则和资产清单。通过这样做，你得到了一个反映整个系统的精确模型，因为它实际上是被实现的，而不是建模者的梦幻视图。您可以持续更新您的模型。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/6fdab524b2eea29e7724c3655f4230f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/0*OXlASDyD4NorRt7A.png"/></div></div></figure><p id="c9ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了您系统的这个新的精确模型，现在是时候弄清楚<br/>它是否安全了。当你意识到有很多弱点会被攻击者利用时，你需要决定最好的缓解策略是什么。为此，威胁建模社区一直依赖于<br/>安全专家。然而，在一个平行宇宙中，其他人一直在使用<br/>攻击图来运行模拟回答这些类型的问题。攻击图社区的<br/>问题类似于<br/>图(模型)的创建。由于系统庞大而复杂，所以<br/>图也变得庞大而复杂。因此，创建一个是困难的、耗时的、容易出错的，并且结果不太可信。</p><p id="a438" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在这里提出的新想法是将威胁模型与<br/>攻击模拟结合起来。为此，我们开发了元攻击语言<br/> (MAL) [1]。这是一个开源框架[2]，可以用来创建特定于领域的(建模)语言(DSL)。使用MAL，您可以<br/>描述您对哪些资产感兴趣，例如计算机、网络、<br/>软件，这些资产可能会受到哪些攻击，以及可以减轻这些攻击的<br/>防御措施。有了MAL，你就可以完全自由地创建自己的威胁建模和攻击模拟语言。有趣的是，当你实例化你的资产时，例如<br/> Robert的MacBook Air运行macOS Big Sur v.11.2.3，你还会得到它的<br/>底层攻击和防御图。因此，当您有了<br/>威胁模型(资产以及这些资产是如何相互联系的)时，您可以<br/>自动运行一个模拟来指出您的弱点在哪里<br/>以及可以添加哪些缓解措施来降低风险的建议<br/>。</p><p id="2763" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是一个恶意代码的小例子，这是基于米特企业ATT &amp; CK矩阵<br/>的<br/>技术和缓解措施，摘自一篇研究论文【3】。</p><p id="d661" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个小例子中，我们可以看到两类资产，即:<br/>账户和软件。其中我们有用户帐户和<br/>管理员帐户，WindowsAdmin继承自一般的<br/>管理员帐户。对于软件类别，我们有窗口和服务。<br/>对于每项资产，都定义了攻击步骤。例如，如果攻击者<br/>获得了用户帐户的用户权限，这可能会导致Windows机器上的<br/>useraccestokenmanipulation攻击。资产<br/>也可以有相关的防御。对于用户权限攻击，一个可能的防御措施是拥有适当的用户帐户管理。资产之间的<br/>关联也被定义，例如一台Windows机器<br/>运行多个服务。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="51c4" class="lh li iq ld b gy lj lk l ll lm">category Account {<br/>        asset UserAccount {<br/>        | userRights<br/>                -&gt; windows.userAccessTokenManipulation<br/>        # userAccountManagement<br/>                -&gt; windows.userAccessTokenManipulation<br/>}<br/>asset AdminAccount {<br/>        | adminRights<br/>        # privilegedAccountManagement<br/>}<br/>asset WindowsAdmin extends AdminAccount {<br/>        | adminRights<br/>                +&gt; windows.adminAccessTokenManipulation<br/>        # privilegedAccountManagement<br/>                +&gt; windows.adminAccessTokenManipulation<br/>        }<br/>}<br/>category Software {<br/>        asset Windows {<br/>                &amp; userAccessTokenManipulation<br/>                info: "Adversaries may use access tokens to operate           under a different user or system security context to perform actions and evade detection."</span><span id="f2f0" class="lh li iq ld b gy ln lk l ll lm">                       -&gt; service.exploitationForPrivilegeEscalation<br/>                &amp; adminAccessTokenManipulation<br/>                       -&gt; service.exploitationForPrivilegeEscalation<br/>}<br/>        asset Service {<br/>                | exploitationForPrivilegeEscalation<br/>        }<br/>}<br/>associations {</span><span id="025e" class="lh li iq ld b gy ln lk l ll lm">UserAccount [userAccount] * &lt;--Accesses--&gt; 1 [windows] Windows</span><span id="c6a2" class="lh li iq ld b gy ln lk l ll lm">AdminAccount [adminAccount] * &lt;--Accesses--&gt; 1 [windows] Windows</span><span id="61ef" class="lh li iq ld b gy ln lk l ll lm">Windows [windows] 1 &lt;--Runs--&gt; * [service] Service</span><span id="42b4" class="lh li iq ld b gy ln lk l ll lm">}</span></pre><p id="ba36" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">任何基于MAL的DSL都可以使用foreseeti [4]的<a class="ae kw" href="http://foreseeti.com/foreseeti-overview" rel="noopener ugc nofollow" target="_blank"> securiCAD </a>工具运行。<br/>这将为您提供更高级的功能，例如漂亮的<br/>图形表示、多用户环境、用于数据导入的API、酷的<br/>指标和报告。Foreseeti拥有基于MAL和<br/>的DSL和产品，在更成熟和广泛使用的DSL中，您可以找到AWS <br/> (securiCAD Vanguard) [5]、Azure [6]和on-prem IT [7]的DSL。也有用于车辆系统[8]和电力系统[9]的DSL可用。如果你不想用这些现成的，你可以根据自己的需要定制，或者<br/>从头开始创建自己的。大多数DSL都是开源的，可以通过MAL GitHub库访问。<br/>想象一下，一个点击工具就能获得对您整个<br/>基础设施的网络安全分析。我们还没有完全做到这一点。然而，有了MAL我们<br/>不需要太多的点击就能意识到这一点。</p><p id="bbae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[1] <strong class="ka ir">马尔<br/></strong><a class="ae kw" href="https://doi.org/10.1145/3230833.3232799" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1145/3230833.3232799</a>彭图斯·约翰逊、罗伯特·拉格斯特伦和马蒂亚斯·埃克斯特特。2018.威胁建模和攻击模拟的元语言。《第十三届可用性、可靠性和安全性国际会议论文集》(ARES 2018)。</p><p id="4530" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">【2】<strong class="ka ir">MAL为开源<br/></strong><a class="ae kw" href="https://mal-lang.org" rel="noopener ugc nofollow" target="_blank">https://mal-lang.org</a><br/><strong class="ka ir">Foreseeti<br/></strong>【3】<a class="ae kw" href="https://foreseeti.com" rel="noopener ugc nofollow" target="_blank">https://foreseeti.com</a></p><p id="4863" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">DSLs<br/></strong>【4】AWS—<a class="ae kw" href="https://foreseeti.com/securicad-vanguard-for-aws/" rel="noopener ugc nofollow" target="_blank">https://foreseeti.com/securicad-vanguard-for-aws/</a><br/>【5】Azure—<a class="ae kw" href="https://foreseeti.com/securicad-enterprise/" rel="noopener ugc nofollow" target="_blank">https://foreseeti.com/securicad-enterprise/</a><br/>【6】coreLang—<a class="ae kw" href="https://doi.org/10.1007/978-3-030-62230-5_4" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1007/978-3-030-62230-5_4</a><br/>Katsikeas s .等人(2020)一种面向IT领域的攻击模拟语言。在安全的图形模型中。葛兰西2020。计算机科学讲义，第12419卷。斯普林格。<br/>【7】车郎—<a class="ae kw" href="https://www.scitepress.org/Link.aspx?doi=10.5220/0007247901750182" rel="noopener ugc nofollow" target="_blank">https://www.scitepress.org/Link.aspx?doi = 10.5220/0007247901750182</a><br/>Katsikeas，s；约翰逊，p。Hacks，s .和Lagerströ，R. (2019年)。车辆网络攻击的概率建模和模拟:元攻击语言的应用。第五届信息系统安全与隐私国际会议论文集。<br/>【8】powerLang——<a class="ae kw" href="https://doi.org/10.1186/s42162-020-00134-4" rel="noopener ugc nofollow" target="_blank"/><br/>Hacks，s，Katsikeas，s，Ling，e .等power lang:一种面向电源域的概率攻击模拟语言。能源信息3，30 (2020年)</p></div></div>    
</body>
</html>